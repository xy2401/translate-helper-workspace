<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>配置数据安全性</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Real Application Security Administrator&#39;s and Developer&#39;s Guide "></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Real Application Security Administrator&#39;s and Developer&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="real-application-security-administrators-and-developers-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-11T05:21:48-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2012, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E95725-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="configuring-application-privileges-and-access-contol-lists.html" title="Previous" type="text/html"></link>
      <link rel="next" href="using-real-application-security-in-java-applications.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Real Application Security Administrator&#39;s and Developer&#39;s Guide"></meta>
    <meta name="dcterms.isVersionOf" content="DBFSG"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="configuring-application-privileges-and-access-contol-lists.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="using-real-application-security-in-java-applications.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Real Application Security管理员和开发人员指南</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">配置数据安全性</li>
            </ol>
            <a id="GUID-ED34EBA9-8906-41A9-9491-B303DA4824E1" name="GUID-ED34EBA9-8906-41A9-9491-B303DA4824E1"></a><a id="DBFSG4000"></a>
            
            <h2 id="DBFSG-GUID-ED34EBA9-8906-41A9-9491-B303DA4824E1" class="sect2"><span class="enumeration_chapter">5</span>配置数据安全性</h2>
         </header>
         <div class="ind">
            <div>
               <div class="p">本章包含：<ul style="list-style-type:disc">
                     <li>
                        <p><a href="configuring-data-security.html#GUID-3059E7B0-F02B-48FE-89B1-1172CF031CFC">关于数据安全</a></p>
                     </li>
                     <li>
                        <p><a href="configuring-data-security.html#GUID-A33BDFB0-E8B1-46D2-9EB5-FAE392C18EBC">关于验证数据安全策略</a></p>
                     </li>
                     <li>
                        <p><a href="configuring-data-security.html#GUID-B6D452FA-CD3E-4909-8512-904C9EF684A5">了解数据安全策略的结构</a></p>
                     </li>
                     <li>
                        <p><a href="configuring-data-security.html#GUID-8765D94C-B658-4958-802B-621215F856F0">关于设计数据领域</a></p>
                     </li>
                     <li>
                        <p><a href="configuring-data-security.html#GUID-8282C70D-87F2-46D6-BDA5-53174EB0207C">将其他应用程序权限应用于列</a></p>
                     </li>
                     <li>
                        <p><a href="configuring-data-security.html#GUID-B7EA7D53-8573-4AAD-8EC7-F6DF7C0B3859">关于为数据库表或视图启用数据安全策略</a></p>
                     </li>
                     <li>
                        <p><a href="configuring-data-security.html#GUID-9B12C1F0-26D3-41AC-B9F7-2FA7D6B99135">关于在主 - 详细信息相关表上创建实际应用程序安全策略</a></p>
                     </li>
                     <li>
                        <p><a href="configuring-data-security.html#GUID-2F86855F-5039-4DC8-848B-8887357A3672">关于管理数据安全策略的应用程序权限</a></p>
                     </li>
                     <li>
                        <p><a href="configuring-data-security.html#GUID-81E7B4AE-B04F-415D-BC51-30097C0384A2">使用BEQUEATH CURRENT_USER视图</a></p>
                     </li>
                     <li>
                        <p><a href="configuring-data-security.html#GUID-C6EF75C9-C167-4482-828E-065BD552E0B7">真正的应用程序安全性：将它们放在一起</a></p>
                     </li>
                     <li>
                        <p><a href="configuring-data-security.html#GUID-F2B7BBD3-EACD-4D36-B8B5-CF7B7887335E" title="描述在同一模式中跨不同应用程序引入Real Application Security策略管理的模式级权限。">关于Schema Level Real Application Security Policy Administration</a></p>
                     </li>
                  </ul>
               </div>
            </div><a id="DBFSG99154"></a><div class="props_rev_3"><a id="GUID-3059E7B0-F02B-48FE-89B1-1172CF031CFC" name="GUID-3059E7B0-F02B-48FE-89B1-1172CF031CFC"></a><h3 id="DBFSG-GUID-3059E7B0-F02B-48FE-89B1-1172CF031CFC" class="sect3">关于数据安全</h3>
               <div>
                  <p>数据安全性是指使用统一的方法控制应用程序用户在Oracle Enterprise的所有组件中访问Oracle数据库中的数据的能力。在Oracle Database Real Application Security中，要保护数据库表或视图，必须通过创建数据域来指定要保护的行（另请参阅<a href="glossary.html#GUID-749D6B46-2F31-4C0D-BCF6-B2030352BA75"><span class="xrefglossterm">数据域</span></a> ）。
                  </p>
                  <p>要限制对数据领域的访问，请关联列出应用程序用户或应用程序角色的一个或多个访问控制列表（ <a href="glossary.html#GUID-BEF74ACD-C696-405B-BF57-C8DAA4C016BC"><span class="xrefglossterm">ACL</span></a> ）以及每个数据领域的应用程序特权。数据域与其关联的ACL一起被称为数据域约束。
                  </p>
                  <p>您可以通过对每个列应用一个或多个应用程序权限来进一步限制对特定列的访问。这在您只希望特权应用程序用户查看该列中的数据的情况下非常有用。</p>
                  <p>数据安全性是Oracle虚拟专用数据库（VPD）的扩展。每次应用程序用户选择或修改数据库表时，VPD都会添加一个<code class="codeph">WHERE</code>谓词来限制数据访问。有关VPD的详细信息，请参阅“ <a href="../dbseg/using-oracle-vpd-to-control-data-access.html#DBSEG007" target="_blank"><span><cite>Oracle数据库安全指南”</cite></span></a> 。Oracle Database Real Application Security通过实施授权模型进一步扩展了VPD概念，该模型可以通过将ACL与这些对象相关联来进一步限制行和列的访问。此外，应用程序会话和会话上下文（通过用户角色和会话命名空间）更加安全。此外，Real Application Security提供了自己的数据字典。
                  </p>
                  <p>要在Oracle Database Real Application Security中配置数据安全性，您必须执行以下步骤：</p>
                  <ol>
                     <li>
                        <p><span class="bold">创建数据安全策略。</span> 数据安全策略定义一个或多个数据域，并为每个数据域关联ACL以创建数据域约束。数据安全策略还可以包含特定于列的属性，以进一步控制数据访问。多个表或视图可以共享相同的数据安全策略。这使您可以创建可在一组表和视图中使用的统一安全策略。
                        </p>
                        <p><a href="configuring-data-security.html#GUID-B6D452FA-CD3E-4909-8512-904C9EF684A5__CDDEDIDF">例5-1</a> <a href="configuring-data-security.html#GUID-B6D452FA-CD3E-4909-8512-904C9EF684A5__CDDEDIDF">例5-1</a>显示了数据安全策略的结构。
                        </p>
                     </li>
                     <li>
                        <p><span class="bold">将数据安全策略与要保护的表或视图相关联。</span></p>
                        <p>您可以运行<code class="codeph">XS_DATA_SECURITY.APPLY_OBJECT_POLICY</code> PL / SQL过程来为包含要保护的数据域和列的表或视图启用数据安全策略。
                        </p>
                        <p>请注意，如果应用程序安全性要求更新表行并且还限制对同一表中某些列的读访问权限，则必须使用两个<code class="codeph">APPLY_OBJECT_POLICY</code>过程来强制执行这两个数据安全策略。例如，一个<code class="codeph">APPLY_OBJECT_POLICY</code>过程将强制更新表行所需的DML <code class="codeph">statement_types</code> （例如， <code class="codeph">INSERT</code> ， <code class="codeph">UPDATE</code> ， <code class="codeph">DELETE</code> ），而另一个<code class="codeph">APPLY_OBJECT_POLICY</code>过程将仅对列约束强制执行<code class="codeph">SELECT</code>的<code class="codeph">statement_types</code> 。
                        </p>
                        <p><a href="configuring-data-security.html#GUID-E388D927-4433-4B6C-8B10-93625EDF6FE6__CDDFGDEC">示例5-5</a> <a href="configuring-data-security.html#GUID-E388D927-4433-4B6C-8B10-93625EDF6FE6__CDDFGDEC">示例5-5</a>显示了如何使用APPLY_OBJECT_POLICY过程。有关更多信息，请参见<span class="q">“ <a href="XS_DATA_SECURITY-package.html#GUID-E0F31931-07F6-460F-9DE0-34AC681327EE">APPLY_OBJECT_POLICY过程</a> ”</span> 。
                        </p>
                     </li>
                     <li>
                        <p><span class="bold">验证数据安全策略。</span> 有关详细信息，请参阅<span class="q">“ <a href="configuring-data-security.html#GUID-A33BDFB0-E8B1-46D2-9EB5-FAE392C18EBC">关于验证数据安全策略</a> ”</span> 。
                        </p>
                     </li>
                  </ol>
               </div>
            </div><a id="DBFSG253"></a><div class="props_rev_3"><a id="GUID-A33BDFB0-E8B1-46D2-9EB5-FAE392C18EBC" name="GUID-A33BDFB0-E8B1-46D2-9EB5-FAE392C18EBC"></a><h3 id="DBFSG-GUID-A33BDFB0-E8B1-46D2-9EB5-FAE392C18EBC" class="sect3">关于验证数据安全策略</h3>
               <div>
                  <p>Oracle建议您在管理配置更改后始终应验证Real Application Security对象。<code class="codeph">XS_DIAG</code>包提供了一组验证API，以帮助确保Real Application Security对象之间的复杂关系不会被这些更改无意中损坏。
                  </p>
                  <p>有关验证数据安全策略的详细信息，请参阅<span class="q">“ <a href="XS_DIAG-package.html#GUID-39061A4F-C36E-410E-9944-D8A57E302853">VALIDATE_DATA_SECURITY函数</a> ”</span> 。
                  </p>
               </div>
            </div><a id="DBFSG390"></a><a id="DBFSG99156"></a><a id="DBFSG99155"></a><div class="props_rev_3"><a id="GUID-B6D452FA-CD3E-4909-8512-904C9EF684A5" name="GUID-B6D452FA-CD3E-4909-8512-904C9EF684A5"></a><h3 id="DBFSG-GUID-B6D452FA-CD3E-4909-8512-904C9EF684A5" class="sect3">了解数据安全策略的结构</h3>
               <div>
                  <p>您可以使用<code class="codeph">XS_DATA_SECURITY.CREATE_POLICY</code> PL / SQL过程创建数据安全策略。
                  </p>
                  <p><a href="configuring-data-security.html#GUID-B6D452FA-CD3E-4909-8512-904C9EF684A5__CDDJJFHJ">图5-1</a>显示了名为<code class="codeph">HR.EMPLOYEES_DS</code>的Real Application Security数据安全策略的结构，该策略是根据数据域约束和列约束创建的，这两个约束都应用于<code class="codeph">EMPLOYEES</code>表。数据领域约束定义应用数据安全策略的行（ <code class="codeph">DEPARTMENT_ID</code> ，值为60或100）以及与这些行关联的ACL（ <code class="codeph">HRACL</code> ）。列约束通过使用查看此敏感数据所需的<code class="codeph">VIEW_SENSITIVE_INFO</code>权限，为<code class="codeph">EMPLOYEES</code>表的<code class="codeph">SALARY</code>列中的敏感列数据定义约束。
                  </p>
                  <div class="figure" id="GUID-B6D452FA-CD3E-4909-8512-904C9EF684A5__CDDJJFHJ">
                     <p class="titleinfigure">图5-1在EMPLOYEES表上创建的实际应用程序安全数据安全策略</p><img src="img/dspolicy_emp.png" alt="下面是图5-1的描述" title="下面是图5-1的描述" longdesc="img_text/dspolicy_emp.html"><br><a href="img_text/dspolicy_emp.html">“图5-1在EMPLOYEES表上创建的实际应用程序安全数据安全策略”的描述</a></div>
                  <!-- class="figure" -->
                  <p><a href="configuring-data-security.html#GUID-B6D452FA-CD3E-4909-8512-904C9EF684A5__CDDEDIDF">例5-1</a>创建了<a href="configuring-data-security.html#GUID-B6D452FA-CD3E-4909-8512-904C9EF684A5__CDDJJFHJ">如图5-1</a>所示的数据安全策略。
                  </p>
                  <div class="infoboxnotealso" id="GUID-B6D452FA-CD3E-4909-8512-904C9EF684A5__GUID-2B3CF960-88AF-402E-B69D-BD93642E2CD9">
                     <p class="notep1">也可以看看：</p>
                     <p><span class="q">“ <a href="XS_DATA_SECURITY-package.html#GUID-BC06195D-9ED9-4095-942E-5651B543B11F">CREATE_POLICY程序</a> ”</span></p>
                  </div>
                  <p>您应该在创建数据安全策略后验证它。有关更多信息，请参见<span class="q">“ <a href="XS_DIAG-package.html#GUID-39061A4F-C36E-410E-9944-D8A57E302853">VALIDATE_DATA_SECURITY函数</a> ”</span> 。
                  </p>
                  <p>数据安全策略的主要参数如下：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><span class="bold">策略名称：</span>定义数据安全策略的名称。
                        </p>
                        <p><a href="configuring-data-security.html#GUID-B6D452FA-CD3E-4909-8512-904C9EF684A5__CDDEDIDF">示例5-1</a>使用名称<code class="codeph">EMPLOYEES_DS</code>作为其创建的数据安全策略。
                        </p>
                     </li>
                     <li>
                        <p><span class="bold">数据领域约束：</span>数据领域约束定义数据安全策略所适用的数据领域或行，以及与这些数据领域关联的ACL。
                        </p>
                        <p><a href="configuring-data-security.html#GUID-B6D452FA-CD3E-4909-8512-904C9EF684A5__CDDEDIDF">例5-1</a>使用<code class="codeph">realm_cons</code>列表来定义<code class="codeph">EMPLOYEES_DS</code>策略的数据域约束。 <code class="codeph">realm_cons</code>包含<code class="codeph">DEPARTMENT_ID</code>值为<code class="codeph">60</code>或<code class="codeph">100</code> 。这些行与<code class="codeph">HRACL</code>访问控制列表相关联。
                        </p>
                     </li>
                     <li>
                        <p><span class="bold">列约束：</span>列约束为数据域约束中的敏感列数据定义附加约束。
                        </p>
                        <p><a href="configuring-data-security.html#GUID-B6D452FA-CD3E-4909-8512-904C9EF684A5__CDDEDIDF">示例5-1</a>将column_cons列约束与<code class="codeph">EMPLOYEES_DS</code>策略相关联。 <code class="codeph">column_cons</code>使用<code class="codeph">VIEW_SENSITIVE_INFO</code>权限保护<code class="codeph">SALARY</code>列。
                        </p>
                     </li>
                  </ul>
                  <div class="example" id="GUID-B6D452FA-CD3E-4909-8512-904C9EF684A5__CDDEDIDF">
                     <p class="titleinexample">示例5-1数据安全策略的结构</p><pre class="oac_no_warn" dir="ltr">- 创建ACL HRACL。 DECLARE ace_list XS $ ACE_LIST; BEGIN ace_list：= XS $ ACE_LIST（XS $ ACE_TYPE（privilege_list =&gt; XS $ NAME_LIST（'SELECT'），授予=&gt; true，principal_name =&gt;'Employee_Role'），XS $ ACE_TYPE（privilege_list =&gt; XS $ NAME_LIST（'SELECT '，'VIEW_SENSITIVE_INFO'），grant =&gt; true，principal_name =&gt;'Manager_Role'））; sys.xs_acl.create_acl（name =&gt;'HRACL'，ace_list =&gt; ace_list，sec_class =&gt;'HR.EMPOLYEES_SC'）;结束; - 创建变量以存储数据领域约束和列约束。DECLARE realm_cons XS $ REALM_CONSTRAINT_LIST; BEGIN  - 创建包含数据域（规则）和 - 关联ACL的数据域约束。 realm_cons：= XS $ REALM_CONSTRAINT_LIST（XS $ REALM_CONSTRAINT_TYPE（realm =&gt;'DEPARTMENT_ID in（60,100）'，acl_list =&gt; XS $ NAME_LIST（'HRACL'）））; - 创建列约束。column_cons：= XS $ COLUMN_CONSTRAINT_LIST（XS $ COLUMN_CONSTRAINT_TYPE（column_list =&gt; XS $ LIST（'SALARY'），privilege =&gt;'VIEW_SENSITIVE_INFO'））; - 创建数据安全策略。
<span class="bold">SYS.XS_DATA_SECURITY.CREATE_POLICY（</span> <span class="bold">name =&gt;'HR.EMPLOYEES_DS'，</span> <span class="bold">realm_constraint_list =&gt; realm_cons，</span> <span class="bold">column_constraint_list =&gt; column_cons）;</span> - 实施数据安全策略以保护EMPLOYEES表的READ访问 - 并使用VIEW_SENSITIVE_INFO  - 权限限制对SALARY列的访问。sys.xs_data_security.apply_object_policy（policy =&gt;'HR.EMPLOYEES_DS'，schema =&gt;'HR'，object =&gt;'EMPLOYEES'，statement_types =&gt;'SELECT'，owner_bypass =&gt; true）;结束;</pre></div>
                  <!-- class="example" -->
               </div>
            </div><a id="DBFSG99157"></a><div class="props_rev_3"><a id="GUID-8765D94C-B658-4958-802B-621215F856F0" name="GUID-8765D94C-B658-4958-802B-621215F856F0"></a><h3 id="DBFSG-GUID-8765D94C-B658-4958-802B-621215F856F0" class="sect3">关于设计数据领域</h3>
               <div>
                  <div class="p">本节包括以下主题：<ul style="list-style-type:disc">
                        <li>
                           <p><a href="configuring-data-security.html#GUID-203EE648-B203-484A-BA93-3AA1D95ABA97">关于理解数据领域的结构</a></p>
                        </li>
                        <li>
                           <p><a href="configuring-data-security.html#GUID-0A027C06-5706-4A97-A852-B4BB36E4D57F">关于使用静态数据领域</a></p>
                        </li>
                        <li>
                           <p><a href="configuring-data-security.html#GUID-F3F8335C-320E-4689-A865-ED3CDB73A5E0">使用跟踪文件检查策略谓词错误</a></p>
                        </li>
                     </ul>
                  </div>
               </div><a id="DBFSG99159"></a><a id="DBFSG99158"></a><div class="props_rev_3"><a id="GUID-203EE648-B203-484A-BA93-3AA1D95ABA97" name="GUID-203EE648-B203-484A-BA93-3AA1D95ABA97"></a><h4 id="DBFSG-GUID-203EE648-B203-484A-BA93-3AA1D95ABA97" class="sect4">关于理解数据领域的结构</h4>
                  <div>
                     <p>数据领域是一个或多个对象实例的集合。对象实例与表或视图中的单个行相关联，并由对象的存储表中的行的主键值标识。表可以同时为其定义静态和动态数据域。如前所述，ACL定义了数据域的应用程序权限授予。</p>
                     <p>数据域约束用于将数据域与ACL相关联。 <a href="configuring-data-security.html#GUID-203EE648-B203-484A-BA93-3AA1D95ABA97__CDDBGBDJ">例5-2</a>创建了一个名为<code class="codeph">realm_cons</code>的数据域约束。数据领域约束包括用于创建数据领域的成员资格规则。数据域包括<code class="codeph">DEPARTMENT_ID</code>为60或100的行<code class="codeph">realm_cons</code>还声明一个名为<code class="codeph">HRACL</code>的ACL，用于与数据域相关联。
                     </p>
                     <p> </p>
                     <p>数据域中对象实例的成员资格由SQL谓词形式的规则确定，该规则必须适用于针对对象存储表的单表查询的<code class="codeph">WHERE</code>子句。<a href="configuring-data-security.html#GUID-203EE648-B203-484A-BA93-3AA1D95ABA97__CDDBGBDJ">例5-2中</a>的SQL谓词是（ <code class="codeph">DEPARTMENT_ID in (60, 100)</code> 。
                     </p>
                     <p>如果您编写的SQL导致错误，例如<code class="codeph">ORA-28113: policy predicate has error</code> ，那么您可以使用跟踪文件来查找错误原因。有关详细信息，请参阅<span class="q">“ <a href="configuring-data-security.html#GUID-F3F8335C-320E-4689-A865-ED3CDB73A5E0">使用跟踪文件检查策略谓词错误</a> ”</span> 。
                     </p>
                     <p><a href="configuring-data-security.html#GUID-203EE648-B203-484A-BA93-3AA1D95ABA97__CDDBGBDJ">例5-2</a>使用一个名为<code class="codeph">HRACL</code> ACL。数据域可以与多个ACL相关联，并且可以在多个数据域之间使用相同的ACL。
                     </p>
                     <p>请考虑<code class="codeph">OE</code>示例模式中<code class="codeph">ORDERS</code>采购订单表中的以下列：</p>
                     <div class="tblformal" id="GUID-203EE648-B203-484A-BA93-3AA1D95ABA97__GUID-16C8CF69-9EEF-4F87-BA25-1BB9122CD600">
                        <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="Shows the columns for the ORDERS purchase order table of the OE sample schema." frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="16%" id="d20696e1111">ORDER_ID</th>
                                 <th align="left" valign="bottom" width="20%" id="d20696e1114">顾客ID</th>
                                 <th align="left" valign="bottom" width="22%" id="d20696e1117">订单状态</th>
                                 <th align="left" valign="bottom" width="21%" id="d20696e1120">SALES_REP_ID</th>
                                 <th align="left" valign="bottom" width="21%" id="d20696e1123">合计订单</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="16%" id="d20696e1128" headers="d20696e1111 ">
                                    <p>2354</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d20696e1128 d20696e1114 ">
                                    <p>104</p>
                                 </td>
                                 <td align="left" valign="top" width="22%" headers="d20696e1128 d20696e1117 ">
                                    <p>0</p>
                                 </td>
                                 <td align="left" valign="top" width="21%" headers="d20696e1128 d20696e1120 ">
                                    <p>155</p>
                                 </td>
                                 <td align="left" valign="top" width="21%" headers="d20696e1128 d20696e1123 ">
                                    <p>46257</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="16%" id="d20696e1144" headers="d20696e1111 ">
                                    <p>2355</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d20696e1144 d20696e1114 ">
                                    <p>104</p>
                                 </td>
                                 <td align="left" valign="top" width="22%" headers="d20696e1144 d20696e1117 ">
                                    <p>8</p>
                                 </td>
                                 <td align="left" valign="top" width="21%" headers="d20696e1144 d20696e1120 ">
                                    <p>空值</p>
                                 </td>
                                 <td align="left" valign="top" width="21%" headers="d20696e1144 d20696e1123 ">
                                    <p>94513.5</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="16%" id="d20696e1160" headers="d20696e1111 ">
                                    <p>2356</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d20696e1160 d20696e1114 ">
                                    <p>105</p>
                                 </td>
                                 <td align="left" valign="top" width="22%" headers="d20696e1160 d20696e1117 ">
                                    <p>五</p>
                                 </td>
                                 <td align="left" valign="top" width="21%" headers="d20696e1160 d20696e1120 ">
                                    <p>空值</p>
                                 </td>
                                 <td align="left" valign="top" width="21%" headers="d20696e1160 d20696e1123 ">
                                    <p>29473.8</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="16%" id="d20696e1176" headers="d20696e1111 ">
                                    <p>2357</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d20696e1176 d20696e1114 ">
                                    <p>108</p>
                                 </td>
                                 <td align="left" valign="top" width="22%" headers="d20696e1176 d20696e1117 ">
                                    <p>五</p>
                                 </td>
                                 <td align="left" valign="top" width="21%" headers="d20696e1176 d20696e1120 ">
                                    <p>158</p>
                                 </td>
                                 <td align="left" valign="top" width="21%" headers="d20696e1176 d20696e1123 ">
                                    <p>59872.4</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="16%" id="d20696e1192" headers="d20696e1111 ">
                                    <p>2358</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d20696e1192 d20696e1114 ">
                                    <p>105</p>
                                 </td>
                                 <td align="left" valign="top" width="22%" headers="d20696e1192 d20696e1117 ">
                                    <p>2</p>
                                 </td>
                                 <td align="left" valign="top" width="21%" headers="d20696e1192 d20696e1120 ">
                                    <p>155</p>
                                 </td>
                                 <td align="left" valign="top" width="21%" headers="d20696e1192 d20696e1123 ">
                                    <p>7826</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p><code class="codeph">ORDERS</code>表中的每一行都是采购订单对象中的对象实例。<code class="codeph">ORDER_ID</code>列中列出的数字是用于唯一标识特定采购订单对象实例的主键。例如：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>由一个对象实例组成的数据域，即一行。例如，您可以使用<code class="codeph">ORDER_ID=2354</code>的<code class="codeph">WHERE</code>谓词。
                           </p>
                        </li>
                        <li>
                           <p>由多个对象实例组成的数据域。例如，您可以使用<code class="codeph">CUSTOMER_ID=104</code>的<code class="codeph">WHERE</code>谓词来拥有多行。
                           </p>
                        </li>
                        <li>
                           <p>由表的整个内容组成的数据域，由<code class="codeph">WHERE</code>谓词<code class="codeph">1=1</code> 。
                           </p>
                        </li>
                     </ul>
                     <p>定义数据域的方法示例如下：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><span class="bold">使用有效的SQL属性，例如表中的列。</span> 
                           </p>
                           <p>在这种情况下，您正在使用<code class="codeph">WHERE</code>谓词，如下所示：</p><pre class="oac_no_warn" dir="ltr">CUSTOMER_ID = 104</pre><p>对行和列中的数据所做的更改会自动反映在数据领域收集的数据中。</p>
                        </li>
                        <li>
                           <p><span class="bold">使用WHERE谓词中的参数。</span> 
                           </p>
                           <p>您可以参数化数据领域，例如：</p><pre class="oac_no_warn" dir="ltr">CUSTOMER_ID = PARAM</pre><p>此示例假定参数<code class="codeph">PARAM</code>已与不同的客户ID相关联。在这种情况下授予权限时，您需要授予特定参数值的权限。您必须在与包含此类<code class="codeph">WHERE</code>谓词的数据域相关联的ACL中指定参数的值。这使您可以基于客户ID创建授权，而无需创建许多特定于客户ID的数据域。
                           </p>
                        </li>
                        <li>
                           <p><span class="bold">使用基于运行时应用程序会话变量或子查询的成员资格规则。</span></p>
                           <p>此类会员规则的一个示例是：</p><pre class="oac_no_warn" dir="ltr">CUSTOMER_ID = XS_SYS_CONTEXT（'order'，'cust_id'）</pre><p>但是，请注意创建基于会话变量或子查询的成员资格规则。例如，假设你想使用会话变量<code class="codeph">USER</code> ，这反映了当前应用程序的用户，在会员规则<code class="codeph">col=USER</code> 。 Oracle数据库无法预先计算结果行集，因为结果不是确定性的。应用程序用户<code class="codeph">SCOTT</code>和应用程序用户<code class="codeph">JSMITH</code>可能对同一行有不同的结果。但是，成员资格规则<code class="codeph">col='SCOTT'</code>工作原理是因为规则总是被评估为任何给定行的相同结果。
                           </p>
                           <p>有关创建数据域的更多信息，请参阅<span class="q">“ <a href="configuring-data-security.html#GUID-0A027C06-5706-4A97-A852-B4BB36E4D57F">关于使用静态</a></span>数据域”。另请参见<span class="q">“ <a href="real-application-security-sql-functions.html#GUID-BC19F7BA-354D-49D2-B9E8-F47B68FCE921">XS_SYS_CONTEXT功能</a> ”，</span>了解有关详细信息， <code class="codeph">XS_SYS_CONTEXT</code> 。</p>
                        </li>
                     </ul>
                     <div class="example" id="GUID-203EE648-B203-484A-BA93-3AA1D95ABA97__CDDBGBDJ">
                        <p class="titleinexample">示例5-2数据领域约束的组件</p><pre class="oac_no_warn" dir="ltr"><code class="codeph">realm_cons</code> ：= XS $ REALM_CONSTRAINT_TYPE（realm =&gt;'DEPARTMENT_ID in（60,100）'，acl_list =&gt; XS $ NAME_LIST（'HRACL'））;</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="DBFSG99160"></a><div class="props_rev_3"><a id="GUID-0A027C06-5706-4A97-A852-B4BB36E4D57F" name="GUID-0A027C06-5706-4A97-A852-B4BB36E4D57F"></a><h4 id="DBFSG-GUID-0A027C06-5706-4A97-A852-B4BB36E4D57F" class="sect4">关于使用静态数据领域</h4>
                  <div>
                     <p>在<a id="d20696e1437" class="indexterm-anchor"></a><a id="d20696e1443" class="indexterm-anchor"></a>静态数据领域， <a id="d20696e1448" class="indexterm-anchor"></a> Oracle数据库会在数据更新时评估受数据域影响的数据更改。您可以将静态数据域与表一起使用，但不能与视图一起使用。
                     </p>
                     <p>要将数据域设置为静态，请将其<code class="codeph">is_static</code>属性设置为<code class="codeph">true</code> 。以下示例创建静态数据领域：</p><pre class="oac_no_warn" dir="ltr">realm_cons：= XS $ REALM_CONSTRAINT_TYPE（realm =&gt;'DEPARTMENT_ID in（60,100）'，acl_list =&gt; XS $ NAME_LIST（'HRACL'）， <span class="bold">is_static =&gt; TRUE</span> ）;</pre><p><a id="d20696e1467" class="indexterm-anchor"></a>物化视图（MV）将用于维护受保护表中的行与保护它们的ACL之间的绑定。只要数据安全策略中包含静态数据域，它们就会自动生成。这些MV将仅支持完全刷新，并允许最多125个ACL与任何单行相关联。
                     </p>
                     <p>生成的MV将采用<code class="codeph">mv(TABLEROWID, ACLIDLIST)</code>其中<code class="codeph">TABLEROWID</code>引用受保护表中的行，ACLIDLIST是存储在<code class="codeph">RAW</code>类型列中的ACLID值列表。各个16字节值将连接在一起形成列表。
                     </p>
                     <p>神谕<a id="d20696e1483" class="indexterm-anchor"></a><a id="d20696e1489" class="indexterm-anchor"></a>每次应用程序用户对数据领域数据执行查询时，数据库都会评估动态数据域。您可以使用动态数据域来保护表和视图的行。动态数据领域具有最大的灵活性，因为它不受静态数据领域所需的要求的约束。请注意，动态数据领域定义中过于复杂的规则可能会影响性能。
                     </p>
                     <p>如果基表更新不频繁或数据领域成员评估规则很复杂，那么您应该考虑使用静态数据域来保护基表。经常更新的基表可能经常与ACLIDS存储MV不同步，除非MV相应地刷新。管理员应根据系统的基表统计信息和性能要求做出决策。</p>
                     <p>要将数据域约束设置为动态，请将其<code class="codeph">is_static</code>属性设置为<code class="codeph">FALSE</code> ，或省略<code class="codeph">is_static</code>属性。以下示例创建动态数据领域：</p><pre class="oac_no_warn" dir="ltr">realm_cons：= XS $ REALM_CONSTRAINT_TYPE（realm =&gt;'DEPARTMENT_ID in（60,100）'，acl_list =&gt; XS $ NAME_LIST（'HRACL'）， <span class="bold">is_static =&gt; FALSE</span> ）;</pre></div>
               </div><a id="DBFSG99167"></a><div class="props_rev_3"><a id="GUID-F3F8335C-320E-4689-A865-ED3CDB73A5E0" name="GUID-F3F8335C-320E-4689-A865-ED3CDB73A5E0"></a><h4 id="DBFSG-GUID-F3F8335C-320E-4689-A865-ED3CDB73A5E0" class="sect4">使用跟踪文件检查策略谓词错误</h4>
                  <div>
                     <div class="section">
                        <p>如果在<code class="codeph">realm</code>元素中定义的SQL导致<code class="codeph">ORA-28113: policy predicate has error</code>或类似消息，那么您可以使用跟踪文件来查找错误原因。跟踪文件显示实际错误，以及显示问题原因的VPD视图。通常，视图的语法有一个简单的错误，您可以通过分析视图的SQL文本来解决。
                        </p>
                        <p>要启用跟踪，请以具有<code class="codeph">ALTER SESSION</code>权限的用户身份登录SQL * Plus。
                        </p>
                        <p>如果要将所有数据领域约束规则（已解析其参数值）转储到跟踪文件中，请输入以下语句：</p><pre class="oac_no_warn" dir="ltr">ALTER SESSION SET EVENTS'TRACE [XSXDS] disk = high';</pre><p>如果要在查询的初始（硬）解析期间转储启用XDS的表的VPD视图，请输入以下语句：</p><pre class="oac_no_warn" dir="ltr">ALTER SESSION SET EVENTS'TRACE [XSVPD] disk = high';</pre><p>或者，您可以通过将以下行添加到数据库实例的初始化文件来启用跟踪：</p><pre class="oac_no_warn" dir="ltr">event =“TRACE [XSXDS] disk = high”event =“TRACE [XSVPD] disk = high”</pre><p>您可以通过发出以下SQL命令来查找此跟踪文件的位置：</p><pre class="oac_no_warn" dir="ltr">SHOW PARAMETER USER_DUMP_DEST;</pre><p>如果需要禁用跟踪，请发出以下语句：</p><pre class="oac_no_warn" dir="ltr">ALTER SESSION SET EVENTS'TRACE [XSVPD] off'; ALTER SESSION SET EVENTS'TRACE [XSXDS] off';</pre><div class="infoboxnotealso" id="GUID-F3F8335C-320E-4689-A865-ED3CDB73A5E0__GUID-24293BFF-407B-48AF-BFA7-105B9371B1BE">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><span class="q">“ <a href="troubleshooting_real_application_security.html#GUID-1B37573C-FD97-48A4-99D0-2AEDAD471EC5">关于数据安全（XSXDS和XSVPD）基于事件的跟踪</a> ”</span></p>
                              </li>
                              <li>
                                 <p><a href="../admin/monitoring-the-database.html#ADMIN11243" target="_blank"><span><cite>“Oracle数据库管理员指南”</cite></span></a> ，了解有关使用跟踪文件的更多信息</p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="DBFSG99180"></a><a id="DBFSG99181"></a><a id="DBFSG99179"></a><div class="props_rev_3"><a id="GUID-8282C70D-87F2-46D6-BDA5-53174EB0207C" name="GUID-8282C70D-87F2-46D6-BDA5-53174EB0207C"></a><h3 id="DBFSG-GUID-8282C70D-87F2-46D6-BDA5-53174EB0207C" class="sect3">将其他应用程序权限应用于列</h3>
               <div>
                  <div class="section">
                     <p>默认情况下，对行的访问受与数据域关联的ACL的保护。此外，您可以使用自定义应用程序权限保护特定列。</p>
                     <p>要保护表<code class="codeph">T</code>的列，请将列约束列表添加到将应用于表<code class="codeph">T</code>的数据安全策略中。</p>
                     <div class="infoboxnote" id="GUID-8282C70D-87F2-46D6-BDA5-53174EB0207C__GUID-B421A8AF-1438-49F4-8CF7-9F2FE6A1B7B7">
                        <p class="notep1">注意：</p>
                        <p>对于接近1000列的表，由于Real Application Security使用内部虚拟列来计算和存储授权指示符，因此可以保护的列数存在限制。列数和受保护列数之和不应超过1000。（表列数+受保护表列数&lt;= 1000）。例如，如果一个表有998列，则允许包括2个受保护列;或者，如果一个表有990列，则允许包括10个受保护列，依此类推。如果要保护的列数超过允许的数量，则返回<code class="codeph">ORA-28113: policy predicate has error</code> 。
                        </p>
                     </div>
                     <p>例如， <code class="codeph">OE</code>模式中的<code class="codeph">PRODUCT_INFORMATION</code>表包含<code class="codeph">LIST_PRICE</code>列。如果要将产品价格的显示限制为特定类别，可以将其他应用程序权限应用于<code class="codeph">LIST_COLUMN</code>表，以便只有已登录的销售代表才能查看其管理的类别的产品列表价格。
                     </p>
                     <p><a href="configuring-data-security.html#GUID-8282C70D-87F2-46D6-BDA5-53174EB0207C__CDDGIIBF">示例5-3</a>显示了使用<code class="codeph">ACCESS_PRICE</code>应用程序特权保护<code class="codeph">LIST_PRICE</code>列的列约束。
                     </p>
                     <p>在添加列约束之前，对于类别13和14中的产品， <code class="codeph">OE.PRODUCT_INFORMATION</code>表中以下列的<code class="codeph">SELECT</code>语句显示以下输出：</p>
                     <div class="tblformal" id="GUID-8282C70D-87F2-46D6-BDA5-53174EB0207C__GUID-0B14DEA3-EBA8-4A44-A18E-C0D5F7773CE8">
                        <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="Shows the output from a SELECT statement on four columns of the OE.PRODUCT_INFORMATION table before the column constraint is applied.." frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="25%" id="d20696e1881">PRODUCT_ID</th>
                                 <th align="left" valign="bottom" width="25%" id="d20696e1884">产品名称</th>
                                 <th align="left" valign="bottom" width="25%" id="d20696e1887">CATEGORY_ID</th>
                                 <th align="left" valign="bottom" width="25%" id="d20696e1890">价格表</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="25%" id="d20696e1895" headers="d20696e1881 ">
                                    <p>3400</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e1895 d20696e1884 ">
                                    <p>高清8GB / SE</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e1895 d20696e1887 ">
                                    <p>13</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e1895 d20696e1890 ">
                                    <p>389</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="25%" id="d20696e1908" headers="d20696e1881 ">
                                    <p>3355</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e1908 d20696e1884 ">
                                    <p>高清8GB / SI</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e1908 d20696e1887 ">
                                    <p>13</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e1908 d20696e1890 ">
                                    <p>空值</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="25%" id="d20696e1921" headers="d20696e1881 ">
                                    <p>2395</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e1921 d20696e1884 ">
                                    <p>32MB Cache / M.</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e1921 d20696e1887 ">
                                    <p>14</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e1921 d20696e1890 ">
                                    <p>123</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="25%" id="d20696e1934" headers="d20696e1881 ">
                                    <p>1755</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e1934 d20696e1884 ">
                                    <p>32MB缓存/ NM</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e1934 d20696e1887 ">
                                    <p>14</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e1934 d20696e1890 ">
                                    <p>121</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="25%" id="d20696e1947" headers="d20696e1881 ">
                                    <p>...</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e1947 d20696e1884 ">
                                    <p>...</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e1947 d20696e1887 ">
                                    <p>...</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e1947 d20696e1890 ">
                                    <p>...</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p>应用列约束后，负责13类产品的销售代表将看到以下输出：</p>
                     <div class="tblformal" id="GUID-8282C70D-87F2-46D6-BDA5-53174EB0207C__GUID-3E76988F-3896-4334-A60D-580B9D0217A5">
                        <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="Shows the output from a SELECT statement on four columns of the OE.PRODUCT_INFORMATION table after the column constraint is applied that the sales rep for category 13 sees." frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="25%" id="d20696e1971">PRODUCT_ID</th>
                                 <th align="left" valign="bottom" width="25%" id="d20696e1974">产品名称</th>
                                 <th align="left" valign="bottom" width="25%" id="d20696e1977">CATEGORY_ID</th>
                                 <th align="left" valign="bottom" width="25%" id="d20696e1980">价格表</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="25%" id="d20696e1985" headers="d20696e1971 ">
                                    <p>3400</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e1985 d20696e1974 ">
                                    <p>高清8GB / SE</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e1985 d20696e1977 ">
                                    <p>13</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e1985 d20696e1980 ">
                                    <p>389</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="25%" id="d20696e1998" headers="d20696e1971 ">
                                    <p>3355</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e1998 d20696e1974 ">
                                    <p>高清8GB / SI</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e1998 d20696e1977 ">
                                    <p>13</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e1998 d20696e1980 ">
                                    <p>空值</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="25%" id="d20696e2011" headers="d20696e1971 ">
                                    <p>2395</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e2011 d20696e1974 ">
                                    <p>32MB Cache / M.</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e2011 d20696e1977 ">
                                    <p>14</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e2011 d20696e1980 ">
                                    <p>空值</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="25%" id="d20696e2024" headers="d20696e1971 ">
                                    <p>1755</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e2024 d20696e1974 ">
                                    <p>32MB缓存/ NM</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e2024 d20696e1977 ">
                                    <p>14</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e2024 d20696e1980 ">
                                    <p>空值</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="25%" id="d20696e2037" headers="d20696e1971 ">
                                    <p>...</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e2037 d20696e1974 ">
                                    <p>...</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e2037 d20696e1977 ">
                                    <p>...</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e2037 d20696e1980 ">
                                    <p>...</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p>相反，负责第14类产品的销售代表会看到此输出：</p>
                     <div class="tblformal" id="GUID-8282C70D-87F2-46D6-BDA5-53174EB0207C__GUID-9DEBA17B-D287-4C39-BA38-68774E41C737">
                        <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="Shows the output from a SELECT statement on four columns of the OE.PRODUCT_INFORMATION table after the column constraint is applied that the sales rep for category 14 sees." frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="25%" id="d20696e2061">PRODUCT_ID</th>
                                 <th align="left" valign="bottom" width="25%" id="d20696e2064">产品名称</th>
                                 <th align="left" valign="bottom" width="25%" id="d20696e2067">CATEGORY_ID</th>
                                 <th align="left" valign="bottom" width="25%" id="d20696e2070">价格表</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="25%" id="d20696e2075" headers="d20696e2061 ">
                                    <p>3400</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e2075 d20696e2064 ">
                                    <p>高清8GB / SE</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e2075 d20696e2067 ">
                                    <p>13</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e2075 d20696e2070 ">
                                    <p>空值</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="25%" id="d20696e2088" headers="d20696e2061 ">
                                    <p>3355</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e2088 d20696e2064 ">
                                    <p>高清8GB / SI</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e2088 d20696e2067 ">
                                    <p>13</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e2088 d20696e2070 ">
                                    <p>空值</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="25%" id="d20696e2101" headers="d20696e2061 ">
                                    <p>2395</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e2101 d20696e2064 ">
                                    <p>32MB Cache / M.</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e2101 d20696e2067 ">
                                    <p>14</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e2101 d20696e2070 ">
                                    <p>123</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="25%" id="d20696e2114" headers="d20696e2061 ">
                                    <p>1755</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e2114 d20696e2064 ">
                                    <p>32MB缓存/ NM</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e2114 d20696e2067 ">
                                    <p>14</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e2114 d20696e2070 ">
                                    <p>121</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="25%" id="d20696e2127" headers="d20696e2061 ">
                                    <p>...</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e2127 d20696e2064 ">
                                    <p>...</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e2127 d20696e2067 ">
                                    <p>...</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e2127 d20696e2070 ">
                                    <p>...</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p>在这些示例中，产品3355的清单价格为<code class="codeph">NULL</code> 。要使中间层应用程序能够区分可能包含<code class="codeph">NULL</code>的授权数据的真实值和始终为<code class="codeph">NULL</code>的未授权值，请使用<code class="codeph">COLUMN_AUTH_INDICATOR</code> SQL函数检查行中的列值是否已获得授权。通过修改<code class="codeph">SELECT</code>语句以包含包含<code class="codeph">COLUMN_AUTH_INDICATOR</code> SQL函数的<code class="codeph">DECODE</code>或<code class="codeph">CASE</code>函数，可以使用不同于<code class="codeph">NULL</code>的值来屏蔽未授权数据。
                     </p>
                     <p><a href="configuring-data-security.html#GUID-8282C70D-87F2-46D6-BDA5-53174EB0207C__CDDBECFA">实施例5-4</a>显示了一个<code class="codeph">SELECT</code>使用该语句<code class="codeph">COLUMN_AUTH_INDICATOR</code>函数来检查授权的数据和<code class="codeph">DECODE</code>函数来替换<code class="codeph">NULL</code>与值<code class="codeph">restricted</code> 。
                     </p>
                     <p>之后，屏蔽值将显示为<code class="codeph">NULL</code> 。例如，如果我们的13类销售代表登录并搜索产品清单价格，他或她会看到以下输出：</p>
                     <div class="tblformal" id="GUID-8282C70D-87F2-46D6-BDA5-53174EB0207C__GUID-764F2AED-526C-417F-975B-3517A5AE7397">
                        <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="Shows the same query but showing NULL data as being masked by the word " restricte="=" ="" frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="25%" id="d20696e2203">PRODUCT_ID</th>
                                 <th align="left" valign="bottom" width="25%" id="d20696e2206">产品名称</th>
                                 <th align="left" valign="bottom" width="25%" id="d20696e2209">CATEGORY_ID</th>
                                 <th align="left" valign="bottom" width="25%" id="d20696e2212">价格表</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="25%" id="d20696e2217" headers="d20696e2203 ">
                                    <p>3400</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e2217 d20696e2206 ">
                                    <p>高清8GB / SE</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e2217 d20696e2209 ">
                                    <p>13</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e2217 d20696e2212 ">
                                    <p>389</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="25%" id="d20696e2230" headers="d20696e2203 ">
                                    <p>3355</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e2230 d20696e2206 ">
                                    <p>高清8GB / SI</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e2230 d20696e2209 ">
                                    <p>13</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e2230 d20696e2212 ">
                                    <p>空值</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="25%" id="d20696e2243" headers="d20696e2203 ">
                                    <p>2395</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e2243 d20696e2206 ">
                                    <p>32MB Cache / M.</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e2243 d20696e2209 ">
                                    <p>14</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e2243 d20696e2212 ">
                                    <p>限制</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="25%" id="d20696e2256" headers="d20696e2203 ">
                                    <p>1755</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e2256 d20696e2206 ">
                                    <p>32MB缓存/ NM</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e2256 d20696e2209 ">
                                    <p>14</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e2256 d20696e2212 ">
                                    <p>限制</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="25%" id="d20696e2269" headers="d20696e2203 ">
                                    <p>...</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e2269 d20696e2206 ">
                                    <p>...</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e2269 d20696e2209 ">
                                    <p>...</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d20696e2269 d20696e2212 ">
                                    <p>...</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <div class="infoboxnotealso" id="GUID-8282C70D-87F2-46D6-BDA5-53174EB0207C__GUID-8051354E-4452-48E3-A6EB-DA9A239CF375">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="real-application-security-data-dictionary-views.html#GUID-1146556A-3BCB-467A-9DAB-1C0CDB3E0EBC">Oracle数据库实际应用程序安全数据字典视图，</a>用于获取有关列约束数据字典视图的信息，该视图列出了使用列级安全性的现有表</p>
                           </li>
                           <li>
                              <p><span class="q">“ <a href="real-application-security-sql-functions.html#GUID-D1D62656-1156-4D6E-A9EC-D3BED1CD4A7D">COLUMN_AUTH_INDICATOR函数</a> ”</span></p>
                           </li>
                           <li>
                              <p><a href="configuring-data-security.html#GUID-B6D452FA-CD3E-4909-8512-904C9EF684A5__CDDEDIDF">示例5-1</a>是数据安全策略中列约束元素的示例。
                              </p>
                           </li>
                           <li>
                              <p>如果应用程序使用Oracle调用接口（OCI）或JDBC， <a href="configuring-oci-and-jdbc-applications-for-column-authorization.html#GUID-07681DFA-7A8E-4F3C-B655-3C202882AC03">则为列授权配置OCI和JDBC应用</a>程序</p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-8282C70D-87F2-46D6-BDA5-53174EB0207C__CDDGIIBF">
                     <p class="titleinexample">示例5-3具有已应用的其他应用程序权限的列</p><pre class="oac_no_warn" dir="ltr">column_cons：= XS $ COLUMN_CONSTRAINT_LIST（XS $ COLUMN_CONSTRAINT_TYPE（column_list =&gt; XS $ LIST（'LIST_PRICE'），privilege =&gt;'ACCESS_PRICE'））;</pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-8282C70D-87F2-46D6-BDA5-53174EB0207C__CDDBECFA">
                     <p class="titleinexample">示例5-4检查授权数据和屏蔽NULL值</p><pre class="oac_no_warn" dir="ltr">SELECT PRODUCT_ID，PRODUCT_NAME，CATEGORY_ID DECODE（COLUMN_AUTH_INDICATOR（LIST_PRICE），0，'restricted'，1，LIST_PRICE）LIST_PRICE FROM PRODUCT_INFORMATION WHERE CATEGORY_ID = 13;</pre></div>
                  <!-- class="example" -->
               </div>
            </div><a id="DBFSG99187"></a><div class="props_rev_3"><a id="GUID-B7EA7D53-8573-4AAD-8EC7-F6DF7C0B3859" name="GUID-B7EA7D53-8573-4AAD-8EC7-F6DF7C0B3859"></a><h3 id="DBFSG-GUID-B7EA7D53-8573-4AAD-8EC7-F6DF7C0B3859" class="sect3">关于为数据库表或视图启用数据安全策略</h3>
               <div>
                  <p><code class="codeph">XS_DATA_SECURITY.APPLY_OBJECT_POLICY</code>过程在表或视图上应用数据安全策略。
                  </p>
                  <div class="p">本节包括以下主题：<ul style="list-style-type:disc">
                        <li>
                           <p><a href="configuring-data-security.html#GUID-E388D927-4433-4B6C-8B10-93625EDF6FE6">使用APPLY_OBJECT_POLICY过程启用Real Application Security</a></p>
                        </li>
                        <li>
                           <p><a href="configuring-data-security.html#GUID-65920F85-727D-42B3-B17F-99C6608BD32C">关于APPLY_OBJECT_POLICY过程如何更改数据库表</a></p>
                        </li>
                        <li>
                           <p><a href="configuring-data-security.html#GUID-376C9FDE-61AF-4088-8654-C4FA85BE4D1A">关于如何评估表数据上的ACL</a></p>
                        </li>
                     </ul>
                  </div>
               </div><a id="DBFSG99192"></a><a id="DBFSG99191"></a><div class="props_rev_3"><a id="GUID-E388D927-4433-4B6C-8B10-93625EDF6FE6" name="GUID-E388D927-4433-4B6C-8B10-93625EDF6FE6"></a><h4 id="DBFSG-GUID-E388D927-4433-4B6C-8B10-93625EDF6FE6" class="sect4">使用APPLY_OBJECT_POLICY过程启用Real Application Security</h4>
                  <div>
                     <div class="section">
                        <p>使用<code class="codeph">XS_DATA_SECURITY.APPLY_OBJECT_POLICY</code>过程为数据库表或视图启用Real Application Security。<a href="configuring-data-security.html#GUID-E388D927-4433-4B6C-8B10-93625EDF6FE6__CDDFGDEC">例5-5</a>为<code class="codeph">OE.ORDERS</code>表启用<code class="codeph">ORDERS_DS</code>数据安全策略。有关更多信息，请参见<span class="q">“ <a href="XS_DATA_SECURITY-package.html#GUID-E0F31931-07F6-460F-9DE0-34AC681327EE">APPLY_OBJECT_POLICY过程</a> ”</span> 。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-E388D927-4433-4B6C-8B10-93625EDF6FE6__CDDFGDEC">
                        <p class="titleinexample">示例5-5使用XS_DATA_SECURITY.APPLY_OBJECT_POLICY</p><pre class="oac_no_warn" dir="ltr">BEGIN SYS.XS_DATA_SECURITY.APPLY_OBJECT_POLICY（policy =&gt;'ORDERS_DS'，schema =&gt;'OE'，object =&gt;'ORDERS'）;结束;</pre></div>
                     <!-- class="example" -->
                     <div class="section">本节包括以下主题： <a href="configuring-data-security.html#GUID-FF788B16-CBD7-42AE-9336-84ED3BA93563">关于为表或视图应用多个策略</a> 。
                     </div>
                     <!-- class="section" -->
                  </div><a id="DBFSG425"></a><div class="props_rev_3"><a id="GUID-FF788B16-CBD7-42AE-9336-84ED3BA93563" name="GUID-FF788B16-CBD7-42AE-9336-84ED3BA93563"></a><h5 id="DBFSG-GUID-FF788B16-CBD7-42AE-9336-84ED3BA93563" class="sect5">关于为表或视图应用多个策略</h5>
                     <div>
                        <p>您可以为表或视图应用多个数据安全策略。当表或视图受多个数据安全策略保护时，应用程序用户只能访问所有策略允许的那些行。因此，例如，如果策略1的数据域包含一行，但策略2的数据域不包含同一行，则应用程序用户将无法访问该行。</p>
                        <p>列安全性类似。考虑列Col1受多个策略保护的情况：Policy1使用Priv1保护它，Policy2使用Priv2保护它，依此类推。然后，必须已授予应用程序用户所有应用程序权限（Priv1，Priv2等）才能访问Col1。因此，对于受列策略保护的列，必须已为所有保护列的策略授予应用程序用户访问权限。</p>
                     </div>
                  </div>
               </div><a id="DBFSG99193"></a><div class="props_rev_3"><a id="GUID-65920F85-727D-42B3-B17F-99C6608BD32C" name="GUID-65920F85-727D-42B3-B17F-99C6608BD32C"></a><h4 id="DBFSG-GUID-65920F85-727D-42B3-B17F-99C6608BD32C" class="sect4">关于APPLY_OBJECT_POLICY过程如何更改数据库表</h4>
                  <div>
                     <p>前面的<span class="q">“ <a href="configuring-data-security.html#GUID-203EE648-B203-484A-BA93-3AA1D95ABA97">关于理解数据领域的结构</a> ”中</span>显示的下表<code class="codeph">OE.ORDERS</code>已使用<code class="codeph">XS_DATA_SECURITY.APPLY_OBJECT_POLICY</code>启用。它显示了隐藏的<code class="codeph">SYS_ACLOID</code>列的添加。此列的数据类型为<code class="codeph">NUMBER</code> ，列出应用程序用户管理的ACL标识符。下表包含应用程序用户管理的ACL标识符500，它是由订单ID 2356标识的对象实例上的直接授权。
                     </p>
                     <div class="infoboxnote" id="GUID-65920F85-727D-42B3-B17F-99C6608BD32C__GUID-DA345DAF-476C-4C24-A791-BFB79F047A2E">
                        <p class="notep1">注意：</p>
                        <p>可以通过在调用<code class="codeph">XS_DATA_SECURITY</code>过程时为<code class="codeph">apply_option</code>参数传递值<code class="codeph">XS_DATA_SECURITY.APPLY_ACLOID_COLUMN</code>来启用<code class="codeph">SYS_ACLOID</code>隐藏列。Real Application Security仅允许将一个ACLID添加到<code class="codeph">SYS_ACLOID</code>列。
                        </p>
                     </div>
                     <div class="tblformalwide" id="GUID-65920F85-727D-42B3-B17F-99C6608BD32C__GUID-C297713A-0DE9-44BB-9C02-8471C4DC28A5">
                        <table cellpadding="4" cellspacing="0" class="FormalWide" title="" width="100%" border="1" summary="Shows the cloumns of the OE.ORDERS table with the additional hidden SYS_ALCOID column listing the application user-managed ACL identifier 500." frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="13%" id="d20696e2888">ORDER_ID</th>
                                 <th align="left" valign="bottom" width="17%" id="d20696e2891">顾客ID</th>
                                 <th align="left" valign="bottom" width="18%" id="d20696e2894">订单状态</th>
                                 <th align="left" valign="bottom" width="17%" id="d20696e2897">SALES_REP_ID</th>
                                 <th align="left" valign="bottom" width="18%" id="d20696e2900">合计订单</th>
                                 <th align="left" valign="bottom" width="17%" id="d20696e2903">SYS_ALCOID</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="13%" id="d20696e2908" headers="d20696e2888 ">
                                    <p><code class="codeph">2354</code></p>
                                 </td>
                                 <td align="left" valign="top" width="17%" headers="d20696e2908 d20696e2891 ">
                                    <p><code class="codeph">104</code></p>
                                 </td>
                                 <td align="left" valign="top" width="18%" headers="d20696e2908 d20696e2894 ">
                                    <p><code class="codeph">0</code></p>
                                 </td>
                                 <td align="left" valign="top" width="17%" headers="d20696e2908 d20696e2897 ">
                                    <p><code class="codeph">155</code></p>
                                 </td>
                                 <td align="left" valign="top" width="18%" headers="d20696e2908 d20696e2900 ">
                                    <p><code class="codeph">46257</code></p>
                                 </td>
                                 <td align="left" valign="top" width="17%" headers="d20696e2908 d20696e2903 "> </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="13%" id="d20696e2930" headers="d20696e2888 ">
                                    <p><code class="codeph">2355</code></p>
                                 </td>
                                 <td align="left" valign="top" width="17%" headers="d20696e2930 d20696e2891 ">
                                    <p><code class="codeph">104</code></p>
                                 </td>
                                 <td align="left" valign="top" width="18%" headers="d20696e2930 d20696e2894 ">
                                    <p><code class="codeph">8</code></p>
                                 </td>
                                 <td align="left" valign="top" width="17%" headers="d20696e2930 d20696e2897 ">
                                    <p><code class="codeph">空值</code></p>
                                 </td>
                                 <td align="left" valign="top" width="18%" headers="d20696e2930 d20696e2900 ">
                                    <p><code class="codeph">94513.5</code></p>
                                 </td>
                                 <td align="left" valign="top" width="17%" headers="d20696e2930 d20696e2903 "> </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="13%" id="d20696e2952" headers="d20696e2888 ">
                                    <p><code class="codeph">2356</code></p>
                                 </td>
                                 <td align="left" valign="top" width="17%" headers="d20696e2952 d20696e2891 ">
                                    <p><code class="codeph">105</code></p>
                                 </td>
                                 <td align="left" valign="top" width="18%" headers="d20696e2952 d20696e2894 ">
                                    <p><code class="codeph">五</code></p>
                                 </td>
                                 <td align="left" valign="top" width="17%" headers="d20696e2952 d20696e2897 ">
                                    <p><code class="codeph">空值</code></p>
                                 </td>
                                 <td align="left" valign="top" width="18%" headers="d20696e2952 d20696e2900 ">
                                    <p><code class="codeph">29473.8</code></p>
                                 </td>
                                 <td align="left" valign="top" width="17%" headers="d20696e2952 d20696e2903 ">
                                    <p><code class="codeph">500</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="13%" id="d20696e2977" headers="d20696e2888 ">
                                    <p><code class="codeph">2357</code></p>
                                 </td>
                                 <td align="left" valign="top" width="17%" headers="d20696e2977 d20696e2891 ">
                                    <p><code class="codeph">108</code></p>
                                 </td>
                                 <td align="left" valign="top" width="18%" headers="d20696e2977 d20696e2894 ">
                                    <p><code class="codeph">五</code></p>
                                 </td>
                                 <td align="left" valign="top" width="17%" headers="d20696e2977 d20696e2897 ">
                                    <p><code class="codeph">158</code></p>
                                 </td>
                                 <td align="left" valign="top" width="18%" headers="d20696e2977 d20696e2900 ">
                                    <p><code class="codeph">59872.4</code></p>
                                 </td>
                                 <td align="left" valign="top" width="17%" headers="d20696e2977 d20696e2903 "> </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="13%" id="d20696e2999" headers="d20696e2888 ">
                                    <p><code class="codeph">2358</code></p>
                                 </td>
                                 <td align="left" valign="top" width="17%" headers="d20696e2999 d20696e2891 ">
                                    <p><code class="codeph">105</code></p>
                                 </td>
                                 <td align="left" valign="top" width="18%" headers="d20696e2999 d20696e2894 ">
                                    <p><code class="codeph">2</code></p>
                                 </td>
                                 <td align="left" valign="top" width="17%" headers="d20696e2999 d20696e2897 ">
                                    <p><code class="codeph">155</code></p>
                                 </td>
                                 <td align="left" valign="top" width="18%" headers="d20696e2999 d20696e2900 ">
                                    <p><code class="codeph">7826</code></p>
                                 </td>
                                 <td align="left" valign="top" width="17%" headers="d20696e2999 d20696e2903 "> </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p>系统管理的静态ACL标识符存储在物化视图（MV）中。</p>
                     <div class="tblformalwide" id="GUID-65920F85-727D-42B3-B17F-99C6608BD32C__GUID-0EA4F327-2FD6-4B29-8F47-CC3141219060">
                        <table cellpadding="4" cellspacing="0" class="FormalWide" title="" width="100%" border="1" summary="Shows the content of the Materialized view listing the system-managed static ACL identifiers." frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="36%" id="d20696e3030">TABLEROWID</th>
                                 <th align="left" valign="bottom" width="64%" id="d20696e3033">ACLIDLIST</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="36%" id="d20696e3038" headers="d20696e3030 ">
                                    <p><code class="codeph">AAAO / 8AABAAANrCABJ</code></p>
                                 </td>
                                 <td align="left" valign="top" width="64%" headers="d20696e3038 d20696e3033 ">
                                    <p><code class="codeph">60FB8AAA40D46C9EE040449864653987</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="36%" id="d20696e3047" headers="d20696e3030 ">
                                    <p><code class="codeph">AAAO/8AABAAANrCAB</code> L.</p>
                                 </td>
                                 <td align="left" valign="top" width="64%" headers="d20696e3047 d20696e3033 ">
                                    <p><code class="codeph">60FB8AAA40D46C9EE040449864653987</code></p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p>要查找与表关联的数据域或数据域约束的详细信息，请查询<code class="codeph">DBA_XS_REALM_CONSTRAINTS</code>数据字典视图。有关详细信息，请参阅<span class="q">“ <a href="real-application-security-data-dictionary-views.html#GUID-93E684FD-576E-432F-81E5-84A1A3ABC642">DBA_XS_REALM_CONSTRAINTS</a> ”</span> 。
                     </p>
                  </div>
               </div><a id="DBFSG99194"></a><div class="props_rev_3"><a id="GUID-376C9FDE-61AF-4088-8654-C4FA85BE4D1A" name="GUID-376C9FDE-61AF-4088-8654-C4FA85BE4D1A"></a><h4 id="DBFSG-GUID-376C9FDE-61AF-4088-8654-C4FA85BE4D1A" class="sect4">关于如何评估表数据上的ACL</h4>
                  <div>
                     <p>当Oracle数据库评估一组ACL时，它会在找到第一个授予或拒绝时停止评估。因此，仔细规划ACL的顺序非常重要。与表中每行关联的ACL按以下顺序计算：</p>
                     <ol>
                        <li>
                           <p><span class="bold">首先评估直接在对象实例上授予的ACL（即，应用程序用户管理的ACL标识符）。</span> 有关创建ACL并将其添加到对象实例的详细信息，请参阅<span class="q">“ <a href="configuring-application-privileges-and-access-contol-lists.html#GUID-AB53EC7B-C593-4AF3-B991-70E6503586F6">关于配置访问控制列表</a> ”</span> 。
                           </p>
                        </li>
                        <li>
                           <p><span class="bold">在应用程序用户管理的ACL之后，接下来评估来自静态数据领域约束授权的ACL。</span> 如果您有多个静态数据域，则会按照数据安全策略中的物理外观顺序对它们进行评估。有关静态数据域的更多信息，请参见<span class="q">“ <a href="configuring-data-security.html#GUID-0A027C06-5706-4A97-A852-B4BB36E4D57F">关于使用静态</a></span>数据域”。
                           </p>
                        </li>
                        <li>
                           <p><span class="bold">最后评估来自动态数据领域约束授权的ACL。</span> 如果您有多个动态数据域，则会按照策略中的物理外观顺序对它们进行评估。有关动态数据域的详细信息，请参阅<span class="q">“ <a href="configuring-data-security.html#GUID-0A027C06-5706-4A97-A852-B4BB36E4D57F">关于使用静态</a></span>数据域”。
                           </p>
                        </li>
                     </ol>
                  </div>
               </div>
            </div><a id="DBFSG99169"></a><div class="props_rev_3"><a id="GUID-9B12C1F0-26D3-41AC-B9F7-2FA7D6B99135" name="GUID-9B12C1F0-26D3-41AC-B9F7-2FA7D6B99135"></a><h3 id="DBFSG-GUID-9B12C1F0-26D3-41AC-B9F7-2FA7D6B99135" class="sect3">关于在主 - 详细信息相关表上创建实际应用程序安全策略</h3>
               <div>
                  <div class="p">本节包括以下主题：<ul style="list-style-type:disc">
                        <li>
                           <p><a href="configuring-data-security.html#GUID-7D84E5C9-BCB7-4B61-9CC2-C3049D30BC61">关于主 - 详细信息相关表的实际应用程序安全策略</a></p>
                        </li>
                        <li>
                           <p><a href="configuring-data-security.html#GUID-B4AF8584-DA48-416D-AD8E-76A8E7466092">关于理解主细节数据领域的结构</a></p>
                        </li>
                        <li>
                           <p><a href="configuring-data-security.html#GUID-8C309EBB-F1D6-47A9-8DBE-08C2E6D2D21C">在Master-Detail相关表上创建实际应用程序安全策略的示例</a></p>
                        </li>
                     </ul>
                  </div>
                  <p>有关主 - 详细信息表的更多信息，请参阅“ <a href="../tdpjd/index.html" target="_blank"><span><cite>Oracle数据库2天+ Java开发人员指南”中</cite></span></a>有关使用JPA和Oracle ADF创建主 - 详细信息应用程序的章节。
                  </p>
               </div><a id="DBFSG99170"></a><div class="props_rev_3"><a id="GUID-7D84E5C9-BCB7-4B61-9CC2-C3049D30BC61" name="GUID-7D84E5C9-BCB7-4B61-9CC2-C3049D30BC61"></a><h4 id="DBFSG-GUID-7D84E5C9-BCB7-4B61-9CC2-C3049D30BC61" class="sect4">关于主 - 详细信息相关表的实际应用程序安全策略</h4>
                  <div>
                     <p>您可以创建一个数据安全策略<a id="d20696e3485" class="indexterm-anchor"></a>可以使用<a id="d20696e3490" class="indexterm-anchor"></a>对于<a id="d20696e3497" class="indexterm-anchor"></a>主 - 细节相关表。通常，您可能需要保护主表的相同策略以保护其详细信息表。为主 - 详细信息表创建实际应用程序安全策略使访问这些表的任何人都可以在统一策略下执行此操作，该策略可以从主表到详细信息表继承。
                     </p>
                     <p>策略和主从详细信息表的可能继承路径如下：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>多个详细信息表可以从一个主表继承策略。</p>
                        </li>
                        <li>
                           <p>详细信息表可以从其他详细信息表继承策略。</p>
                        </li>
                        <li>
                           <p>一个详细信息表可以从多个主表继承策略。</p>
                        </li>
                     </ul>
                     <p>如果满足主表中的任何一个策略，则应用程序用户可以访问详细信息表中的相应行。</p>
                  </div>
               </div><a id="DBFSG99172"></a><a id="DBFSG99171"></a><div class="props_rev_3"><a id="GUID-B4AF8584-DA48-416D-AD8E-76A8E7466092" name="GUID-B4AF8584-DA48-416D-AD8E-76A8E7466092"></a><h4 id="DBFSG-GUID-B4AF8584-DA48-416D-AD8E-76A8E7466092" class="sect4">关于理解主细节数据领域的结构</h4>
                  <div>
                     <p>要为主 - 详细信息相关表创建Real Application Security策略，您必须为每个表创建数据安全策略。在详细信息表的每个数据安全策略中，您通过包括主详细信息数据域来指示详细信息表继承的主表。步骤<a href="configuring-data-security.html#GUID-8C309EBB-F1D6-47A9-8DBE-08C2E6D2D21C__CDDCEICE">4</a> ， <a href="configuring-data-security.html#GUID-8C309EBB-F1D6-47A9-8DBE-08C2E6D2D21C__CDDFFCEB">6</a>和<a href="configuring-data-security.html#GUID-8C309EBB-F1D6-47A9-8DBE-08C2E6D2D21C__CDDIIAIC">7</a>中的步骤<span class="q">“</span>下<span class="q"><a href="configuring-data-security.html#GUID-8C309EBB-F1D6-47A9-8DBE-08C2E6D2D21C">在主从相关表创建真正应用安全策略的实施例</a></span>示出了创建和使用主-从数据域和创建和应用主详细数据安全策略，以主-的例子<span class="q">”</span>细节表。
                     </p>
                     <p><a href="configuring-data-security.html#GUID-B4AF8584-DA48-416D-AD8E-76A8E7466092__CDDJHIIA">例5-6</a>显示了一个样本主细节数据领域。
                     </p>
                     <p>在本规范中：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">when_condition</code>指定详细信息表的谓词，类似于<code class="codeph">WHERE</code>子句，用于过滤数据。如果<code class="codeph">when_condition</code>计算结果为true，则Oracle数据库将应用主策略。此元素是可选的。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">parent_schema</code>指定包含主表的架构的名称。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">parent_object</code>指定主表的名称。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">primary_key</code>指定主表中的主键。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">foreign_key</code>指定详细信息表的外键。
                           </p>
                        </li>
                     </ul>
                     <div class="example" id="GUID-B4AF8584-DA48-416D-AD8E-76A8E7466092__CDDJHIIA">
                        <p class="titleinexample">例5-6主细节数据领域</p><pre class="oac_no_warn" dir="ltr">realm_cons：= XS $ REALM_CONSTRAINT_TYPE（parent_schema =&gt;'OE'，parent_object =&gt;'CUSTOMERS'，key_list =&gt; XS $ KEY_LIST（XS $ KEY_TYPE（primary_key =&gt;'CUSTOMER_ID'，foreign_key =&gt;'CUSTOMER_ID'，foreign_key_type =&gt; 1 ）），when_condition =&gt;'ORDER_STATUS IS NOT NULL'）</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="DBFSG391"></a><a id="DBFSG99174"></a><div class="props_rev_2"><a id="GUID-8C309EBB-F1D6-47A9-8DBE-08C2E6D2D21C" name="GUID-8C309EBB-F1D6-47A9-8DBE-08C2E6D2D21C"></a><h4 id="DBFSG-GUID-8C309EBB-F1D6-47A9-8DBE-08C2E6D2D21C" class="sect4">在Master-Detail相关表上创建实际应用程序安全策略的示例</h4>
                  <div>
                     <div class="section">
                        <p>此示例使用<code class="codeph">SH</code>示例模式。<code class="codeph">SH</code>模式有一个名为<code class="codeph">CUSTOMERS</code>的表，它是主表。<a id="d20696e3873" class="indexterm-anchor"></a><a id="d20696e3879" class="indexterm-anchor"></a><a id="d20696e3883" class="indexterm-anchor"></a>主表<code class="codeph">CUSTOMERS</code>有一个名为<code class="codeph">SALES</code>的详细信息表，另一个名为<code class="codeph">COUNTRIES</code>详细信息表。以下示例演示如何实施实际应用程序安全策略，该策略实际上按照<code class="codeph">COUNTRIES</code>表中定义的区域边界对客户和销售数据进行分区，以便对<code class="codeph">CUSTOMERS</code>和<code class="codeph">SALES</code>表进行读访问。此外，还需要将<code class="codeph">CUST_INCOME_LEVEL</code>和<code class="codeph">CUST_CREDIT_LIMIT</code>列上的数据屏蔽到用户，但需要对业务分析进行全表访问的用户除外，例如业务分析师。
                        </p>
                        <div class="infoboxnote" id="GUID-8C309EBB-F1D6-47A9-8DBE-08C2E6D2D21C__GUID-F75FA07C-43B3-4569-9914-90539C67DD53">
                           <p class="notep1">注意：</p>
                           <p>此示例中的所有管理命令都可以由数据库用户执行，例如在数据库中具有<code class="codeph">DBA</code>角色的<code class="codeph">SYSTEM</code>帐户，因为<code class="codeph">DBA</code>角色已被授予Real Application Security管理任务的适当权限。此外，由于安全性类，ACL和数据安全性策略是模式限定对象，因此在API中指定这些对象时必须显式使用预期的模式名称，因此不会将它们解析为数据库会话默认模式下的对象。 <code class="codeph">SYSTEM</code> 。</p>
                        </div>
                        <p>三个表的描述都在同一模式（ <code class="codeph">SH</code> ）中，如下所示：</p><pre class="oac_no_warn" dir="ltr">- 主表中的SH.CUSTOMERS。名字空？输入----------------------------------------- -------- ---------------------------- CUST_ID NOT NULL NUMBER CUST_FIRST_NAME NOT NULL VARCHAR2（20）CUST_LAST_NAME NOT NULL VARCHAR2（40）CUST_GENDER CHAR（1） ）CUST_YEAR_OF_BIRTH NUMBER（4）CUST_MARITAL_STATUS VARCHAR2（20）CUST_STREET_ADDRESS NOT NULL VARCHAR2（40）CUST_POSTAL_CODE NOT NULL VARCHAR2（10）CUST_CITY NOT NULL VARCHAR2（30）CUST_STATE_PROVINCE VARCHAR2（40）COUNTRY_ID NOT NULL CHAR（2）CUST_MAIN_PHONE_NUMBER VARCHAR2（25）CUST_INCOME_LEVEL VARCHAR2（30）CUST_CREDIT_LIMIT NUMBER CUST_EMAIL VARCHAR2（30） -  SH.SALES是一个详细信息表。名字空？输入----------------------------------------- -------- ---------------------------- PROD_ID NOT NULL NUMBER（6）CUST_ID NOT NULL NUMBER TIME_ID NOT NULL DATE CHANNEL_ID NOT NULL CHAR（1） PROMO_ID NOT NULL NUMBER（6）QUANTITY_SOLD NOT NULL NUMBER（3）AMOUNT_SOLD NOT NULL NUMBER（10,2） -  SH.COUNTRIES是一个详细信息表。名字空？输入----------------------------------------- -------- ---------------------------- COUNTRY_ID NOT NULL CHAR（2）COUNTRY_NAME NOT NULL VARCHAR2（40）COUNTRY_SUBREGION VARCHAR2（30）COUNTRY_REGION VARCHAR2（ 20）</pre><p><a href="configuring-data-security.html#GUID-8C309EBB-F1D6-47A9-8DBE-08C2E6D2D21C__CDDDFDJB">图5-2</a>显示了已创建并应用于与主 - 详细信息相关的表（ <code class="codeph">CUSTOMERS</code> - <code class="codeph">SALES</code> - <code class="codeph">COUNTRIES</code> ）的已完成的Real Application Security数据安全策略的概述，这些表在以下步骤中作为概述进行了描述，并在步骤中进行了更详细的说明按照这个数字。
                        </p>
                        <ol>
                           <li>
                              <p>除了业务分析师角色和关联的应用程序用户之外，还为四个地理区域（欧洲，美洲，亚洲和非洲）中的每一个创建主体，应用程序角色和应用程序用户。</p>
                           </li>
                           <li>
                              <p>创建<code class="codeph">VIEW_SENSITIVE_INFO</code>权限并创建<code class="codeph">SH.CUST_SEC_CLASS</code>以在其中设置权限范围。
                              </p>
                           </li>
                           <li>
                              <p>将<code class="codeph">VIEW_SENSITIVE_INFO</code>权限授予业务分析师角色。
                              </p>
                           </li>
                           <li>
                              <p>使用参数化区域的规则定义数据领域约束，以便系统识别字符串<code class="codeph">&amp;REGION</code> ，稍后将在策略中使用该字符串。
                              </p>
                           </li>
                           <li>
                              <p>使用<code class="codeph">VIEW_SENSITIVE_INFO</code>权限创建列约束以保护两列<code class="codeph">CUST_INCOME_LEVEL</code>和<code class="codeph">CUST_CREDIT_LEVEL</code> 。
                              </p>
                           </li>
                           <li>
                              <p>创建数据安全策略<code class="codeph">SH.CUSTOMER_DS</code>指定数据领域约束和先前创建的列约束。
                              </p>
                           </li>
                           <li>
                              <p>在<code class="codeph">SH.CUSTOMER_DS</code>数据安全策略的规则中注册参数的名称和数据类型。
                              </p>
                           </li>
                           <li>
                              <p>为每个区域创建ACL，以授予对需要读访问权限的相应角色的读访问权限。例如，对于Europe区域，您将<code class="codeph">SELECT</code>权限授予<code class="codeph">Europe_sales</code>角色，并为<code class="codeph">Business_Analyst</code>角色授予<code class="codeph">SELECT</code>和<code class="codeph">VIEW_SENSITIVE_INFO</code>权限。
                              </p>
                           </li>
                           <li>
                              <p>将每个区域中的每个ACL与满足规则的行相关联，其中参数<code class="codeph">REGION</code>值等于区域名称，例如Europe。您可以为四个区域中的每个区域执行此操作，然后将此ACL添加到<code class="codeph">SH.CUSTOMER_DS</code>数据安全策略中。
                              </p>
                           </li>
                           <li>
                              <p>为主 - 详细信息表创建数据领域约束，因此仅当用户有权访问<code class="codeph">CUSTOMERS</code>主表中的父行时，用户才能访问<code class="codeph">SALES</code>详细信息表中的记录。
                              </p>
                           </li>
                           <li>
                              <p>创建<code class="codeph">SH.SALES_DS</code>数据安全策略以强制执行此数据领域约束。
                              </p>
                           </li>
                        </ol>
                        <p>在<a href="configuring-data-security.html#GUID-8C309EBB-F1D6-47A9-8DBE-08C2E6D2D21C__CDDDFDJB">图5-2中</a> ，主 - 详细信息表还显示了主键（PK）字段和外键（FK）字段以及用于创建数据域约束和列约束的许多其他字段。使用这些PK和FK关系，适用于主表的相同数据安全策略也适用于详细信息表。例如，在这种特殊情况下，所有为<code class="codeph">CUSTOMERS</code>主表授予<code class="codeph">SELECT</code>权限并由<code class="codeph">SH.CUSTOMER_DS</code>数据安全策略强制执行的<code class="codeph">SH.CUSTOMER_DS</code>也适用于<code class="codeph">SALES</code>详细信息表。
                        </p>
                        <div class="figure" id="GUID-8C309EBB-F1D6-47A9-8DBE-08C2E6D2D21C__CDDDFDJB">
                           <p class="titleinfigure">图5-2在Master-Detail相关表上创建的Real Application Security数据安全策略</p><img src="img/dspolicy_master_detail.png" alt="下面是图5-2的描述" title="下面是图5-2的描述" longdesc="img_text/dspolicy_master_detail.html"><br><a href="img_text/dspolicy_master_detail.html">“图5-2在主 - 详细信息相关表上创建的实际应用程序安全数据安全策略”的描述</a></div>
                        <!-- class="figure" -->
                        <p>要为这些主 - 详细信息表创建Real Application Security策略，请按照下列步骤操作：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>创建每个国家/地区所需的角色和用户（角色<code class="codeph">Europe_sales</code> ，用户<code class="codeph">SMITH</code> ），（角色<code class="codeph">Americas_sales</code> ，用户<code class="codeph">JAMES</code> ），（角色<code class="codeph">Asia_sales</code> ，用户<code class="codeph">MILLER</code> ），（角色<code class="codeph">Africa_sales</code> ，用户<code class="codeph">MARTIN</code> ）和（角色<code class="codeph">Business_Analyst</code> ，用户<code class="codeph">TURNER</code> ） ，谁是唯一具有完整表访问权限的用户。</span><div><pre class="oac_no_warn" dir="ltr">BEGIN sys.xs_principal.create_role（name =&gt;'Europe_sales'，enabled =&gt; TRUE）; sys.xs_principal.create_role（name =&gt;'Americas_sales'，enabled =&gt; TRUE）; sys.xs_principal.create_role（name =&gt;'Asia_sales'，enabled =&gt; TRUE）; sys.xs_principal.create_role（name =&gt;'Africa_sales'，enabled =&gt; TRUE）; sys.xs_principal.create_role（name =&gt;'Business_Analyst'，enabled =&gt; TRUE）; sys.xs_principal.create_user（name =&gt;'SMITH'，schema =&gt;'SH'）; sys.dbms_xs_principals.set_password（username =&gt;'SMITH'，password =&gt;' <span class="italic">password</span> '，type =&gt; XS_PRINCIPAL.XS_SHA512）; sys.xs_principal.grant_roles（grantee =&gt;'SMITH'，role =&gt;'Europe_sales'）; sys.xs_principal.create_user（name =&gt;'JAMES'，schema =&gt;'SH'）; sys.dbms_xs_principals.set_password（username =&gt;'JAMES'，password =&gt;'password'，type =&gt; XS_PRINCIPAL.XS_SHA512）; sys.xs_principal.grant_roles（grantee =&gt;'JAMES'，role =&gt;'Americas_sales'）; sys.xs_principal.create_user（name =&gt;'MILLER'，schema =&gt;'SH'）; sys.dbms_xs_principals.set_password（username =&gt;'MILLER'，password =&gt;'password'，type =&gt; XS_PRINCIPAL.XS_SHA512）; sys.xs_principal.grant_roles（grantee =&gt;'MILLER'，role =&gt;'Asia_sales'）; sys.xs_principal.create_user（name =&gt;'MARTIN'，schema =&gt;'SH'）; sys.dbms_xs_principals.set_password（username =&gt;'MARTIN'，password =&gt;'password'，type =&gt; XS_PRINCIPAL.XS_SHA512）; sys.xs_principal.grant_roles（grantee =&gt;'MARTIN'，role =&gt;'Africa_sales'）; sys.xs_principal.create_user（name =&gt;'TURNER'，schema =&gt;'SH'）; sys.dbms_xs_principals.set_password（username =&gt;'TURNER'，password =&gt;'password'，type =&gt; XS_PRINCIPAL.XS_SHA512）; sys.xs_principal.grant_roles（grantee =&gt;'TURNER'，role =&gt;'Business_Analyst'）;结束;</pre></div>
                        </li>
                        <li class="stepexpand"><span>为权限<code class="codeph">VIEW_SENSITIVE_INFO</code>定义<code class="codeph">SH.CUST_SEC_CLASS</code>安全类以保护敏感列。</span><div>
                              <p>访问用于查询和DML的数据安全性受保护对象的行级权限是在<code class="codeph">SYS</code>模式下的安全性类DML中预定义的。
                              </p><pre class="oac_no_warn" dir="ltr">DECLARE pr_list XS $ PRIVILEGE_LIST; BEGIN  - 让我们调用新权限VIEW_SENSIATIVE_INFO pr_list：= XS $ PRIVILEGE_LIST（XS $ PRIVILEGE（name =&gt;'VIEW_SENSITIVE_INFO'））; sys.xs_security_class.create_security_class（name =&gt;'SH.CUST_SEC_CLASS'，description =&gt;'保护CUSTOMERS和SALES数据的安全类'，parent_list =&gt; XS $ NAME_LIST（'SYS.DML'），priv_list =&gt; pr_list）;结束;</pre></div>
                        </li>
                        <li class="stepexpand" id="GUID-8C309EBB-F1D6-47A9-8DBE-08C2E6D2D21C__CDDDEAGH"><span>使用参数化区域的规则定义数据领域约束，然后定义列约束并指定要由<code class="codeph">VIEW_SENSITIVE_INFO</code>权限保护的两列<code class="codeph">CUST_INCOME_LEVEL</code>和<code class="codeph">CUST_CREDIT_LIMIT</code>的<code class="codeph">VIEW_SENSITIVE_INFO</code> 。然后，创建<code class="codeph">SH.CUSTOMER_DS</code>数据安全策略并在规则中注册参数的名称和数据类型。</span><div>
                              <p>安全策略要求区域客户和销售数据使用不同的ACL进行分区。实现此目的的一种方法是将多个数据域定义为区域，并对两个表执行此操作。但是，在此示例中，显示了另一种方式。也就是说，使用单个规则参数化数据域中的区域，并使用主从关系来简化管理任务。</p>
                              <p>因此，不是为策略创建许多约束，而是使用以下用于参数化区域的规则来创建一个约束更有效：</p><pre class="oac_no_warn" dir="ltr">COUNTRY_ID in（从SH.COUNTRIES中选择COUNTRY_ID，其中COUNTRY_REGION =＆REGION）</pre><p>为了使系统能够识别规则中的字符串<code class="codeph">&amp;REGION</code>确实是一个参数，您必须在创建策略后调用<code class="codeph">xs_data_security.create_acl_parameter</code>过程来注册参数名称。此外，您必须指定参数值的数据类型。由于区域存储为字符串数据，因此<code class="codeph">XS_ACL.TYPE_VARCHAR</code>宏用于此示例。对于数字，另一种受支持的数据类型是<code class="codeph">XS_ACL.TYPE_NUMBER</code> 。
                              </p><pre class="oac_no_warn" dir="ltr">DECLARE rows_secs XS $ REALM_CONSTRAINT_LIST; cols_secs XS $ COLUMN_CONSTRAINT_LIST; BEGIN  - 使用参数化区域的规则定义领域约束。rows_secs：= xs $ REALM_CONSTRAINT_LIST（XS $ REALM_CONSTRAINT_TYPE（realm =&gt;'COUNTRY_ID in（从SH.COUNTRIES中选择COUNTRY_ID'||'，其中COUNTRY_REGION =＆'||'REGION）'））; - 使用VIEW_SENSITIVE_INFO权限定义列约束以保护CUST_INCOME_LEVEL和 -  CUST_CREDIT_LIMIT列。cols_secs：= XS $ COLUMN_CONSTRAINT_LIST（XS $ COLUMN_CONSTRAINT_TYPE（column_list =&gt; XS $ LIST（'CUST_INCOME_LEVEL'，'CUST_CREDIT_LIMIT'），privilege =&gt;'VIEW_SENSITIVE_INFO'））; - 创建数据安全策略。sys.xs_data_security.create_policy（name =&gt;'SH.CUSTOMER_DS'，realm_constraint_list =&gt; rows_secs，column_constraint_list =&gt; cols_secs，description =&gt;'保护sh.customers表的政策'）; - 在规则中注册参数的名称和数据类型。sys.xs_data_security.create_acl_parameter（policy =&gt;'SH.CUSTOMER_DS'，parameter =&gt;'REGION'，param_type =&gt; XS_ACL.TYPE_VARCHAR）;结束;</pre></div>
                        </li>
                        <li class="stepexpand" id="GUID-8C309EBB-F1D6-47A9-8DBE-08C2E6D2D21C__CDDCEICE"><span>创建ACL以授权每个区域的读访问权限。对于Europe区域，将<code class="codeph">SELECT</code>授予<code class="codeph">Europe_sales</code>角色。此外， <code class="codeph">SELECT</code>和<code class="codeph">VIEW_SENSITIVE_INFO</code>权限被授予<code class="codeph">Business_Analyst</code>角色，以便角色的被授予者具有完整的表访问权限，并且还能够查看<code class="codeph">CUST_INCOME_LEVEL</code>和<code class="codeph">CUST_CREDIT_LIMIT</code>列中的数据。</span><div><pre class="oac_no_warn" dir="ltr">DECLARE ace_list XS $ ACE_LIST; BEGIN ace_list：= XS $ ACE_LIST（XS $ ACE_TYPE（privilege_list =&gt; XS $ NAME_LIST（'SELECT'），授予=&gt; true，principal_name =&gt;'Europe_sales'），XS $ ACE_TYPE（privilege_list =&gt; XS $ NAME_LIST（'SELECT '，'VIEW_SENSITIVE_INFO'），grant =&gt; true，principal_name =&gt;'Business_Analyst'））; sys.xs_acl.create_acl（name =&gt;'View_Europe_sales'，ace_list =&gt; ace_list，sec_class =&gt;'SH.CUST_SEC_CLASS'，description =&gt;'授权欧洲地区的读取权限'）; -  ACL必须与满足规则的行相关联，其中参数REGION的值等于Europe。例如，约束 - 规则成为 - 中的COUNTRY_ID（从SH.COUNTRIES中选择COUNTRY_ID，其中COUNTRY_REGION ='Europe'）。sys.xs_acl.add_acl_parameter（acl =&gt;'View_Europe_sales'，policy =&gt;'SH.CUSTOMER_DS'，parameter =&gt;'REGION'，value =&gt;'Europe'）;结束;</pre></div>
                        </li>
                        <li class="stepexpand"><span>创建ACL以授权其他三个区域（美洲，亚洲和非洲）的读取访问权限。</span><div><pre class="oac_no_warn" dir="ltr">DECLARE ace_list XS $ ACE_LIST; BEGIN ace_list：= XS $ ACE_LIST（XS $ ACE_TYPE（privilege_list =&gt; XS $ NAME_LIST（'SELECT'），授予=&gt; true，principal_name =&gt;'Americas_sales'），XS $ ACE_TYPE（privilege_list =&gt; XS $ NAME_LIST（'SELECT '，'VIEW_SENSITIVE_INFO'），grant =&gt; true，principal_name =&gt;'Business_Analyst'））; sys.xs_acl.create_acl（name =&gt;'View_Americas_sales'，ace_list =&gt; ace_list，sec_class =&gt;'SH.CUST_SEC_CLASS'，description =&gt;'授权美洲地区的读访问权限'）; sys.xs_acl.add_acl_parameter（acl =&gt;'View_Americas_sales'，policy =&gt;'SH.CUSTOMER_DS'，parameter =&gt;'REGION'，value =&gt;'Americas'）;结束; DECLARE ace_list XS $ ACE_LIST; BEGIN ace_list：= XS $ ACE_LIST（XS $ ACE_TYPE（privilege_list =&gt; XS $ NAME_LIST（'SELECT'），授予=&gt; true，principal_name =&gt;'Asia_sales'），XS $ ACE_TYPE（privilege_list =&gt; XS $ NAME_LIST（'SELECT '，'VIEW_SENSITIVE_INFO'），grant =&gt; true，principal_name =&gt;'Business_Analyst'））; sys.xs_acl.create_acl（name =&gt;'View_Asia_sales'，ace_list =&gt; ace_list，sec_class =&gt;'SH.CUST_SEC_CLASS'，description =&gt;'授权亚洲地区的读取权限'）; sys.xs_acl.add_acl_parameter（acl =&gt;'View_Asia_sales'，policy =&gt;'SH.CUSTOMER_DS'，parameter =&gt;'REGION'，value =&gt;'Asia'）;结束; DECLARE ace_list XS $ ACE_LIST; BEGIN ace_list：= XS $ ACE_LIST（XS $ ACE_TYPE（privilege_list =&gt; XS $ NAME_LIST（'SELECT'），授予=&gt; true，principal_name =&gt;'Africa_sales'），XS $ ACE_TYPE（privilege_list =&gt; XS $ NAME_LIST（'SELECT '，'VIEW_SENSITIVE_INFO'），grant =&gt; true，principal_name =&gt;'Business_Analyst'））; sys.xs_acl.create_acl（name =&gt;'View_Africa_sales'，ace_list =&gt; ace_list，sec_class =&gt;'SH.CUST_SEC_CLASS'，description =&gt;'授权非洲地区的读取权限'）; sys.xs_acl.add_acl_parameter（acl =&gt;'View_Africa_sales'，policy =&gt;'SH.CUSTOMER_DS'，parameter =&gt;'REGION'，value =&gt;'Africa'）;结束;</pre></div>
                        </li>
                        <li class="stepexpand" id="GUID-8C309EBB-F1D6-47A9-8DBE-08C2E6D2D21C__CDDFFCEB"><span>应用在步骤<a href="configuring-data-security.html#GUID-8C309EBB-F1D6-47A9-8DBE-08C2E6D2D21C__CDDDEAGH">3中</a>创建的<code class="codeph">SH.CUSTOMER_DS</code>策略以保护对<code class="codeph">CUSTOMERS</code>表的读访问。</span><div><pre class="oac_no_warn" dir="ltr">BEGIN sys.xs_data_security.apply_object_policy（policy =&gt;'SH.CUSTOMER_DS'，schema =&gt;'SH'，object =&gt;'CUSTOMERS'，statement_types =&gt;'SELECT'，owner_bypass =&gt; true）;结束;</pre></div>
                        </li>
                        <li class="stepexpand" id="GUID-8C309EBB-F1D6-47A9-8DBE-08C2E6D2D21C__CDDIIAIC"><span>创建数据领域主 - 详细信息约束以保护<code class="codeph">SALES</code>表。此主 - 细节约束使用与先前在步骤<a href="configuring-data-security.html#GUID-8C309EBB-F1D6-47A9-8DBE-08C2E6D2D21C__CDDDEAGH">3</a>到<a href="configuring-data-security.html#GUID-8C309EBB-F1D6-47A9-8DBE-08C2E6D2D21C__CDDFFCEB">6中</a>描述的相同的区域分区策略。这意味着只有当该用户有权访问<code class="codeph">CUSTOMERS</code>主表中的父行时，用户才能访问<code class="codeph">SALES</code>详细信息表中的记录。</span><div><pre class="oac_no_warn" dir="ltr">DECLARE rows_secs XS $ REALM_CONSTRAINT_LIST; BEGIN  - 定义主 - 细节约束。rows_secs：= xs $ REALM_CONSTRAINT_LIST（XS $ REALM_CONSTRAINT_TYPE（parent_schema =&gt;'SH'，parent_object =&gt;'CUSTOMERS'，key_list =&gt; xs $ key_list（xs $ key_type（primary_key =&gt;'CUST_ID'，foreign_key =&gt;'CUST_ID'， foreign_key_type =&gt; 1））））; - 创建策略以强制执行约束。sys.xs_data_security.create_policy（name =&gt;'SH.SALES_DS'，realm_constraint_list =&gt; rows_secs，column_constraint_list =&gt; null）; - 应用策略以保护SALES表的读访问权限。sys.xs_data_security.apply_object_policy（policy =&gt;'SH.SALES_DS'，schema =&gt;'SH'，object =&gt;'SALES'，statement_types =&gt;'SELECT'，owner_bypass =&gt; true）;结束;</pre></div>
                        </li>
                        <li class="stepexpand"><span>将对象级别<code class="codeph">SELECT</code>权限授予<code class="codeph">PUBLIC</code>以供用户执行查询。</span><div><pre class="oac_no_warn" dir="ltr">授予sh.customers公共选择权;在国家公共场所选择GRANT;在sh.sales上授予选择公共;</pre></div>
                        </li>
                        <li class="stepexpand"><span>以用户<code class="codeph">MARTIN</code>身份连接并执行查询以显示非洲地区用户<code class="codeph">MARTIN</code>的销售数据，并显示<code class="codeph">CUST_INCOME_LEVEL</code>和<code class="codeph">CUST_CREDIT_LIMIT</code>列的敏感销售信息的屏蔽。</span><div><pre class="oac_no_warn" dir="ltr">连接马丁/欢迎SELECT c。COUNTRY_NAME，c。COUNTRY_ID，ct。CUST_FIRST_NAME，PROD_ID，QUANTITY_SOLD来自sh.customers ct，sh.sales s，sh.countries c WHERE ct。CUST_ID = s。CUST_ID和ct。COUNTRY_ID = c。COUNTRY_ID; COUNTRY_NAME CO CUST_FIRST_NAME PROD_ID QUANTITY_SOLD --------------------  -  -------------------- --- ------- -------------南非ZA Forrest 8050 2南非ZA Mitch 17505 11南非ZA Murry 32785 7南非ZA Heath 3585 12</pre></div>
                        </li>
                     </ol>
                  </div>
               </div>
            </div><a id="DBFSG99175"></a><div class="props_rev_3"><a id="GUID-2F86855F-5039-4DC8-848B-8887357A3672" name="GUID-2F86855F-5039-4DC8-848B-8887357A3672"></a><h3 id="DBFSG-GUID-2F86855F-5039-4DC8-848B-8887357A3672" class="sect3">关于管理数据安全策略的应用程序权限</h3>
               <div>
                  <div class="p">本节包括以下主题：<ul style="list-style-type:disc">
                        <li>
                           <p><a href="configuring-data-security.html#GUID-C713D40B-8D64-41DB-838B-50BEAAAD8888">关于绕过实际应用程序安全策略的安全检查</a></p>
                        </li>
                        <li>
                           <p><a href="configuring-data-security.html#GUID-EE5C9EBE-FB84-4DB8-B78A-FFC7E4592D80">使用SQL * Plus SET SECUREDCOL命令</a></p>
                        </li>
                     </ul>
                  </div>
               </div><a id="DBFSG99176"></a><div class="props_rev_3"><a id="GUID-C713D40B-8D64-41DB-838B-50BEAAAD8888" name="GUID-C713D40B-8D64-41DB-838B-50BEAAAD8888"></a><h4 id="DBFSG-GUID-C713D40B-8D64-41DB-838B-50BEAAAD8888" class="sect4">关于绕过实际应用程序安全策略的安全检查</h4>
                  <div>
                     <p>该<a id="d20696e4497" class="indexterm-anchor"></a><a id="d20696e4503" class="indexterm-anchor"></a>以下数据库用户可以绕过Real Application Security Policy的安全检查：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>用户<code class="codeph">SYS</code></p>
                        </li>
                        <li>
                           <p>拥有<code class="codeph">EXEMPT ACCESS POLICY</code>系统特权的数据库用户</p>
                        </li>
                        <li>
                           <p>应用策略的对象的所有者。</p>
                           <p><a id="d20696e4526" class="indexterm-anchor"></a>如果数据安全策略应用于具有所有者旁路规范的对象，则对象的所有者可以绕过此类策略。默认情况下，不允许所有者绕过。
                           </p>
                           <p>对象所有者还可以在同一个表上创建另一个视图，并为该视图分配不同的Real Application Security策略。</p>
                        </li>
                     </ul>
                  </div>
               </div><a id="DBFSG99183"></a><a id="DBFSG99184"></a><a id="DBFSG99185"></a><a id="DBFSG99186"></a><a id="DBFSG99182"></a><div class="props_rev_3"><a id="GUID-EE5C9EBE-FB84-4DB8-B78A-FFC7E4592D80" name="GUID-EE5C9EBE-FB84-4DB8-B78A-FFC7E4592D80"></a><h4 id="DBFSG-GUID-EE5C9EBE-FB84-4DB8-B78A-FFC7E4592D80" class="sect4">使用SQL * Plus SET SECUREDCOL命令</h4>
                  <div>
                     <div class="section">
                        <p>SQL * Plus <code class="codeph">SET SECUREDCOL</code>命令<a id="d20696e4655" class="indexterm-anchor"></a><a id="d20696e4661" class="indexterm-anchor"></a>使您能够自定义SQL * Plus输出中的列值安全性，以供未经查看列和未知安全性的列的用户使用。您可以选择默认文本或指定显示的文本。默认为<code class="codeph">OFF</code> 。</p>
                        <p>启用列级安全性并将<code class="codeph">SET SECUREDCOL</code>设置为<code class="codeph">ON</code> ，SQL * Plus对安全列或未知安全级别列的输出将替换为您的自定义文本或默认指示符。这仅适用于标量数据类型。复杂对象数据输出不受影响。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-EE5C9EBE-FB84-4DB8-B78A-FFC7E4592D80__GUID-B825D648-BA85-404F-94FA-EB6160967E45">句法</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">SET SECUREDCOL {OFF | ON} [UNAUTH [ORIZED]文字] [UNK [NOWN]文字]</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-EE5C9EBE-FB84-4DB8-B78A-FFC7E4592D80__GUID-6C8FB395-956A-4DE3-9309-88914D8A7AC7">参数</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <div class="tblformalwide" id="GUID-EE5C9EBE-FB84-4DB8-B78A-FFC7E4592D80__GUID-F0E1BC37-9A79-4617-A0CF-FBF08A00E325">
                           <table cellpadding="4" cellspacing="0" class="FormalWide" title="" width="100%" border="1" summary="Shows the parameter descriptions for the SET SECUREDCOL command." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="23%" id="d20696e4695">参数</th>
                                    <th align="left" valign="bottom" width="77%" id="d20696e4698">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="23%" id="d20696e4703" headers="d20696e4695 ">
                                       <p><code class="codeph">上</code></p>
                                    </td>
                                    <td align="left" valign="top" width="77%" headers="d20696e4703 d20696e4698 ">
                                       <p>显示默认指示符星号（ <code class="codeph">****</code> ）代替未经授权查看列的用户的列值，并显示问号（ <code class="codeph">?????</code> ）代替列的安全级别未知的列值（当应用于列的特定权限未知时）。指标“ <code class="codeph">*</code> ”和“ <code class="codeph">?</code>“填充到定义的列长度或由当前<code class="codeph">COLUMN</code>命令定义的列长度。
                                       </p>
                                       <p>默认情况下，此命令将为<code class="codeph">OFF</code> 。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="23%" id="d20696e4731" headers="d20696e4695 ">
                                       <p><code class="codeph">关闭</code></p>
                                    </td>
                                    <td align="left" valign="top" width="77%" headers="d20696e4731 d20696e4698 ">
                                       <p>在没有查看列的授权的情况下，为应用程序用户显示空值以代替列值，并替换列中未知安全级别的列值。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="23%" id="d20696e4739" headers="d20696e4695 ">
                                       <p><code class="codeph">UNAUTH [ORIZED]</code></p>
                                    </td>
                                    <td align="left" valign="top" width="77%" headers="d20696e4739 d20696e4698 ">
                                       <p>通过文本，您可以指定应用程序用户在安全列中显示的文本，而无需查看该列。此文本显示而不是默认<code class="codeph">*****</code> 。
                                       </p>
                                       <p>您可以指定列长度或最多30个字符的任何字母数字文本。较长的文本被截断。必须引用包含空格的文本。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="23%" id="d20696e4752" headers="d20696e4695 ">
                                       <p><code class="codeph">未知]</code></p>
                                    </td>
                                    <td align="left" valign="top" width="77%" headers="d20696e4752 d20696e4698 ">
                                       <p>使用“文本”可以指定要在未知安全级别的列中显示的文本（当应用于列的特定权限未知时）。这个文字出现而不是默认的<code class="codeph">??????</code> 。
                                       </p>
                                       <p>您可以指定列长度或最多30个字符的任何字母数字文本。较长的文本被截断。必须引用包含空格的文本。</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-EE5C9EBE-FB84-4DB8-B78A-FFC7E4592D80__GUID-8185E4E9-704A-4372-B19D-B340113481D1">例1</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">SET SECUREDCOL ON SELECT empno，ename，sal FROM emp ORDER BY deptno;</pre><p>该示例的输出如下：</p><pre class="oac_no_warn" dir="ltr">EMPNO ENAME DEPTNO SAL ----- ------ ------ -------- 7539 KING 10 ******** 7369 SMITH 20 800 7566 JONES 20 2975 7788 SCOTT 20 3000 7521 WARD 30 ******** 7499 ALLEN 30 ********选择了6行。
</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-EE5C9EBE-FB84-4DB8-B78A-FFC7E4592D80__GUID-70A8352D-4E15-4EE2-8C09-C1190CF1B2BB">例2</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">SET SECUREDCOL ON UNAUTH不允许SELECT empno，ename，sal FROM emp ORDER BY deptno;</pre><p>该示例的输出如下：</p><pre class="oac_no_warn" dir="ltr">EMPNO ENAME DEPTNO SAL ----- ------ ------ ------- 7539 KING 10不允许7369 SMITH 20 800 7566 JONES 20 2975 7788 SCOTT 20 3000 7521 WARD 30不允许7499 ALLEN 30不允许选择6行。
</pre></div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="DBFSG434"></a><a id="DBFSG435"></a><a id="DBFSG433"></a><div class="props_rev_3"><a id="GUID-81E7B4AE-B04F-415D-BC51-30097C0384A2" name="GUID-81E7B4AE-B04F-415D-BC51-30097C0384A2"></a><h3 id="DBFSG-GUID-81E7B4AE-B04F-415D-BC51-30097C0384A2" class="sect3">使用BEQUEATH CURRENT_USER视图</h3>
               <div>
                  <div class="section">
                     <p>传统上，Oracle数据库中的视图使用定义者的权限。这意味着如果您调用标识或特权敏感的SQL函数或调用者权限PL / SQL或Java函数，则将当前架构和当前用户设置为视图所有者，并将当前启用的角色设置为视图所有者加上<code class="codeph">PUBLIC</code>在函数的执行中。
                     </p>
                     <p>如果您需要有关调用者权限和定义者权限的背景信息，请参阅<a href="../lnpls/plsql-subprograms.html#LNPLS00809" target="_blank"><span><cite>Oracle Database PL / SQL语言参考</cite></span></a> 。
                     </p>
                     <div class="infoboxnote" id="GUID-81E7B4AE-B04F-415D-BC51-30097C0384A2__GUID-072BDE33-BBA1-4197-B1EB-FEB3FAFFA4E1">
                        <p class="notep1">注意：</p>
                        <p>某些内置SQL函数（如<code class="codeph">SYS_CONTEXT()</code>和<code class="codeph">USERENV()</code>是前面规则的例外。这些函数始终使用当前应用程序用户的环境，即使从definer的权限视图调用也是如此。
                        </p>
                     </div>
                     <p>Oracle数据库12c <span class="italic">分别</span> 1版（12.1）和以后，您可以创建一个视图<code class="codeph">BEQUEATH</code>条款，它可以让你配置此行为。<code class="codeph">BEQUEATH</code>子句确定视图中引用的身份或权限敏感的SQL函数，调用者权限PL / SQL程序单元和Java函数是否从查询用户的环境继承当前架构，当前用户和当前启用的角色。这对于Real Application Security应用程序特别有用，它们通常需要在调用应用程序用户的环境中运行代码。
                     </p>
                     <p>在视图定义中使用<code class="codeph">BEQUEATH CURRENT_USER</code>创建一个视图，该视图允许特权敏感，并且视图中引用的调用者权限函数可以从查询用户的环境继承当前模式，当前用户和当前启用的角色。有关<code class="codeph">CREATE OR REPLACE VIEW</code>语句的语法，请参见<a href="../sqlrf/CREATE-VIEW.html#SQLRF01504" target="_blank"><span><cite>Oracle数据库SQL语言参考</cite></span></a> 。
                     </p>
                     <p><a href="configuring-data-security.html#GUID-81E7B4AE-B04F-415D-BC51-30097C0384A2__BGBFHCJB">例5-7</a>说明了<code class="codeph">BEQUEATH CURRENT_USER</code>视图如何使调用者权限的程序单元在调用应用程序用户的环境中运行。当<code class="codeph">USER2</code>从<code class="codeph">USER1</code>的视图中选择时，在<code class="codeph">USER2</code>的环境中调用调用者的权限函数。
                     </p>
                     <p>在视图定义中使用<code class="codeph">BEQUEATH DEFINER</code>会创建一个视图，该视图会导致特权敏感，并且视图中引用的调用者权限函数可以从视图定义者的环境继承当前模式，当前用户和当前启用的角色。如果未指定<code class="codeph">BEQUEATH</code>子句，则假定为<code class="codeph">BEQUEATH DEFINER</code> 。
                     </p>
                     <p>如果<code class="codeph">BEQUEATH_DEFINER</code>视图包含对<code class="codeph">BEQUEATH CURRENT_USER</code>视图的引用，则引用视图中的调用者权限函数将使用父视图所有者的权限。
                     </p>
                     <p><a href="configuring-data-security.html#GUID-81E7B4AE-B04F-415D-BC51-30097C0384A2__BGBFIGGB">例5-8</a>说明了<code class="codeph">BEQUEATH DEFINER</code>视图如何定义嵌套调用者权限的程序单元在视图所有者环境中运行的边界。当<code class="codeph">USER2</code>从<code class="codeph">USER1</code>的视图中选择时，在<code class="codeph">USER1</code>的环境中调用视图的调用者权限函数。
                     </p>
                     <div class="infoboxnotealso" id="GUID-81E7B4AE-B04F-415D-BC51-30097C0384A2__GUID-8382E9BF-56E3-4B19-966F-F9F5E8B0C09A">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="../dbseg/managing-security-for-definers-rights-and-invokers-rights.html#DBSEG-GUID-EF5300C7-E153-4316-805E-0A87FF2EA676" target="_blank"><span><cite>Oracle数据库安全指南，</cite></span></a>用于在VPD和FGA策略中使用调用者权利和定义者的权利</p>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-81E7B4AE-B04F-415D-BC51-30097C0384A2__BGBFHCJB">
                     <p class="titleinexample">例5-7 BEQUEATH CURRENT_USER视图的工作原理</p><pre class="oac_no_warn" dir="ltr">SQL&gt; CONNECT USER1 / USER1已连接。SQL&gt; SQL&gt;  - 首先创建一个调用者权限函数来确定当前SQL用户的确是谁。SQL&gt; CREATE或REPLACE FUNCTION CALLED_AS_USER RETURN VARCHAR2 AUTHID CURRENT_USER IS 2 BEGIN 3 RETURN SYS_CONTEXT（'USERENV'，'CURRENT_USER'）; 4结束; 5 /创建功能。SQL&gt;  - 请注意，您不需要将EXECUTE授权给called_as_user，因为即使SQL&gt;  -  BEQUEATH CURRENT_USER视图也会对SQL进行名称解析和权限检查&gt;  - 使用定义者权限在视图正文中显示引用。SQL&gt;创建或替换视图BEQUEATH_INVOKER_VIEW <span class="bold">BEQUEATH CURRENT_USER</span> AS 2选择CALLED_AS_USER来自DUAL;查看已创建。SQL&gt; GRANT SELECT ON BEQUEATH_INVOKER_VIEW to PUBLIC;格兰特成功了。SQL&gt; CONNECT USER2 / USER2已连接。SQL&gt; SELECT * FROM USER1。BEQUEATH_INVOKER_VIEW; CALLED_AS_USER ------------------------------------------------- ------------------------------- USER2</pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-81E7B4AE-B04F-415D-BC51-30097C0384A2__BGBFIGGB">
                     <p class="titleinexample">例5-8 BEQUEATH DEFINER视图的工作原理</p><pre class="oac_no_warn" dir="ltr">SQL&gt; CONNECT USER1 / USER1已连接。SQL&gt; SQL&gt;  - 首先创建一个调用者权限函数来确定当前SQL用户的确是谁。SQL&gt; CREATE或REPLACE FUNCTION CALLED_AS_USER RETURN VARCHAR2 AUTHID CURRENT_USER IS 2 BEGIN 3 RETURN SYS_CONTEXT（'USERENV'，'CURRENT_USER'）; 4结束; 5 /创建功能。SQL&gt;  - 请注意，您不需要将EXECUTE授权给called_as_user，因为即使SQL&gt;  -  BEQUEATH CURRENT_USER视图也会对SQL进行名称解析和权限检查&gt;  - 使用定义者权限在视图正文中显示引用。SQL&gt;创建或替换视图BEQUEATH_DEFINER_VIEW <span class="bold">BEQUEATH DEFINER为</span> 2选择CALLED_AS_USER来自DUAL;查看已创建。SQL&gt; GRANT SELECT BEQUEATH_DEFINER_VIEW to PUBLIC;格兰特成功了。SQL&gt; CONNECT USER2 / USER2已连接。SQL&gt; SELECT * FROM USER1。BEQUEATH_DEFINER_VIEW; CALLED_AS_USER ------------------------------------------------- ------------------------------- USER1</pre></div>
                  <!-- class="example" -->
                  <div class="section">本节包括以下主题： <a href="configuring-data-security.html#GUID-0E7D6CB2-5D60-4516-9FFE-989BAEB895CA">使用SQL函数确定调用应用程序用户</a> 。
                  </div>
                  <!-- class="section" -->
               </div><a id="DBFSG436"></a><div class="props_rev_3"><a id="GUID-0E7D6CB2-5D60-4516-9FFE-989BAEB895CA" name="GUID-0E7D6CB2-5D60-4516-9FFE-989BAEB895CA"></a><h4 id="DBFSG-GUID-0E7D6CB2-5D60-4516-9FFE-989BAEB895CA" class="sect4">使用SQL函数确定调用应用程序用户</h4>
                  <div>
                     <div class="section">
                        <p>SQL函数（如<code class="codeph">SYS_CONTEXT()</code>和<code class="codeph">USERENV()</code>以及<code class="codeph">XS_SYS_CONTEXT()</code>始终返回当前应用程序用户的环境，即使从定义者权限视图调用也是如此。有时，应用程序需要根据语句中引用的视图的安全上下文（ <code class="codeph">BEQUEATH</code>属性）来确定调用应用程序用户。
                        </p>
                        <p>Oracle Database 12 <span class="italic">c</span>第1版（12.1）中引入的以下新功能使您能够在考虑语句中引用的视图的<code class="codeph">BEQUEATH</code>属性的情况下找出调用应用程序用户：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">ORA_INVOKING_USER:</code>使用此函数返回当前使用其上下文的数据库用户的名称。如果从定义者的权限边界内调用该函数，则返回数据库对象所有者的名称。如果调用用户是Real Application Security应用程序用户，则返回常量<code class="codeph">XS$USER</code> 。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">ORA_INVOKING_USERID:</code>使用此函数返回当前使用其上下文的数据库用户的标识符（ID）。如果从定义者的权限边界内调用该函数，则返回数据库对象所有者的ID。
                              </p>
                              <p>如果调用用户是Real Application Security应用程序用户，则该函数返回所有Real Application Security应用程序用户共有的标识符，但不同于任何数据库用户的标识符。</p>
                           </li>
                           <li>
                              <p><code class="codeph">ORA_INVOKING_XS_USER:</code>使用此函数返回当前使用其上下文的Real Application Security应用程序用户的名称。
                              </p>
                              <p>如果调用用户是数据库用户，则返回值<code class="codeph">NULL</code> 。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">ORA_INVOKING_XS_USER_GUID:</code>使用此函数返回当前使用其上下文的Real Application Security应用程序用户的标识符（ID）。
                              </p>
                              <p>如果调用用户是数据库用户，则返回值<code class="codeph">NULL</code> 。
                              </p>
                           </li>
                        </ul>
                        <p>以下示例显示了数据库用户<code class="codeph">USER1</code>查询<code class="codeph">ORA_INVOKING_USER</code>和<code class="codeph">ORA_INVOKING_XS_USER.</code> <code class="codeph">ORA_INVOKING_XS_USER</code>返回<code class="codeph">NULL</code> ，因为用户不是Real Application安全应用程序用户。
                        </p><pre class="oac_no_warn" dir="ltr">SQL&gt; CONNECT USER1输入密码：已连接。SQL&gt; SELECT ORA_INVOKING_USER FROM DUAL; ORA_INVOKING_USER ------------------------------------------------- ------------------------------- USER1 SQL&gt; SELECT ORA_INVOKING_XS_USER FROM DUAL; ORA_INVOKING_XS_USER ------------------------------------------------- -------------------------------</pre><div class="infoboxnotealso" id="GUID-0E7D6CB2-5D60-4516-9FFE-989BAEB895CA__GUID-9EFEF967-5279-4290-84D8-3D2ABAF5C78C">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>有关前面的SQL函数和其他函数（如<code class="codeph">SYS_CONTEXT</code>详细信息，请<a href="../sqlrf/SYS_CONTEXT.html#SQLRF06117" target="_blank"><span><cite>参见Oracle数据库SQL语言参考</cite></span></a></p>
                              </li>
                              <li>
                                 <p><span class="q">“ <a href="real-application-security-sql-functions.html#GUID-BC19F7BA-354D-49D2-B9E8-F47B68FCE921">XS_SYS_CONTEXT函数</a> ”</span></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="DBFSG437"></a><div class="props_rev_3"><a id="GUID-C6EF75C9-C167-4482-828E-065BD552E0B7" name="GUID-C6EF75C9-C167-4482-828E-065BD552E0B7"></a><h3 id="DBFSG-GUID-C6EF75C9-C167-4482-828E-065BD552E0B7" class="sect3">真正的应用程序安全性：将它们放在一起</h3>
               <div>
                  <p>本节将所有Real Application Security概念放在一起，以便定义基本数据安全策略。它建立在<span class="q">“ <a href="indroducing-oracle-database-real-application-security.html#GUID-586753AB-4D90-4196-8D02-CBB2FD7891B0">场景：员工信息的安全人力资源（HR）演示</a> ”中</span>引入的<code class="codeph">HR</code>场景示例的基础上。
                  </p>
                  <p>该部分包括以下主题，该示例在示例的帮助下讨论了场景中描述的每个实现任务。</p>
                  <div class="p">本节包括以下主题：<ul style="list-style-type:disc">
                        <li>
                           <p><a href="configuring-data-security.html#GUID-16B08684-CCEA-472B-B9BD-EBFE8B80602E">基本人力资源情景：实施任务</a></p>
                        </li>
                        <li>
                           <p><a href="configuring-data-security.html#GUID-EE972F05-4F5E-4A60-B1F9-B26BA9A60533">运行安全HR演示</a></p>
                        </li>
                     </ul>
                  </div>
               </div><a id="DBFSG438"></a><div class="props_rev_3"><a id="GUID-16B08684-CCEA-472B-B9BD-EBFE8B80602E" name="GUID-16B08684-CCEA-472B-B9BD-EBFE8B80602E"></a><h4 id="DBFSG-GUID-16B08684-CCEA-472B-B9BD-EBFE8B80602E" class="sect4">基本人力资源情景：实施任务</h4>
                  <div>
                     <div class="p">讨论了以下实现任务：<ul style="list-style-type:disc">
                           <li>
                              <p><a href="configuring-data-security.html#GUID-B0BD62FD-9C05-4382-BE5A-96669D999201">作为用户SYS连接以创建真正的应用程序安全用户和角色</a></p>
                           </li>
                           <li>
                              <p><a href="configuring-data-security.html#GUID-E8DC6EA1-D1AB-47E3-A1F9-17E4EE64F0FA">创建角色和应用程序用户</a></p>
                           </li>
                           <li>
                              <p><a href="configuring-data-security.html#GUID-BF7A1CDF-E728-4AF4-B5AE-BC349CA36E6F">创建安全类和ACLS</a></p>
                           </li>
                           <li>
                              <p><a href="configuring-data-security.html#GUID-389095E3-8F07-4C9F-9C57-35C546E242F1">创建数据安全策略</a></p>
                           </li>
                           <li>
                              <p><a href="configuring-data-security.html#GUID-826AAD8C-E182-4CFF-8421-F9FFFC333228">验证Real Application Security对象</a></p>
                           </li>
                           <li>
                              <p><a href="configuring-data-security.html#GUID-EFE8A9C2-9B17-4770-9EDA-CE92F6162B2B">禁用表的数据安全策略</a></p>
                           </li>
                        </ul>
                     </div>
                  </div><a id="DBFSG410"></a><a id="DBFSG396"></a><div class="props_rev_3"><a id="GUID-B0BD62FD-9C05-4382-BE5A-96669D999201" name="GUID-B0BD62FD-9C05-4382-BE5A-96669D999201"></a><h5 id="DBFSG-GUID-B0BD62FD-9C05-4382-BE5A-96669D999201" class="sect5">作为用户SYS连接以创建真正的应用程序安全用户和角色</h5>
                     <div>
                        <div class="section">
                           <p>要创建Real Application Security用户和角色，您只需要以<code class="codeph">SYS</code>用户身份进行连接。</p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-B0BD62FD-9C05-4382-BE5A-96669D999201__GUID-74AF35AD-7F50-4428-A67A-C4CCCE9DF7AA">
                           <p class="titleinexample">例5-9以用户SYS连接</p><pre class="oac_no_warn" dir="ltr">SQL&gt; connect sys / <span class="italic">＆passwd</span> as sysdba已连接。
</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="DBFSG427"></a><a id="DBFSG429"></a><a id="DBFSG439"></a><a id="DBFSG441"></a><a id="DBFSG428"></a><a id="DBFSG430"></a><a id="DBFSG431"></a><a id="DBFSG432"></a><a id="DBFSG440"></a><a id="DBFSG442"></a><a id="DBFSG443"></a><a id="DBFSG426"></a><div class="props_rev_3"><a id="GUID-E8DC6EA1-D1AB-47E3-A1F9-17E4EE64F0FA" name="GUID-E8DC6EA1-D1AB-47E3-A1F9-17E4EE64F0FA"></a><h5 id="DBFSG-GUID-E8DC6EA1-D1AB-47E3-A1F9-17E4EE64F0FA" class="sect5">创建角色和应用程序用户</h5>
                     <div>
                        <div class="section">
                           <p class="subhead3" id="GUID-E8DC6EA1-D1AB-47E3-A1F9-17E4EE64F0FA__GUID-39EE8308-2ECA-4665-955B-57AC3B30FD4C">创建数据库角色</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>创建数据库角色<code class="codeph">DB_EMP</code>并为此角色授予必要的表权限。此角色用于向应用程序用户授予所需的对象权限。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-E8DC6EA1-D1AB-47E3-A1F9-17E4EE64F0FA__GUID-8762BDEE-94DF-4B72-BB5F-29F7B59BC5DA">创建应用程序角色</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-E8DC6EA1-D1AB-47E3-A1F9-17E4EE64F0FA__GUID-90751B45-DE47-4136-B7B6-16060CBE88F5">将DB_EMP数据库角色授予应用程序角色</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>将<code class="codeph">DB_EMP</code>数据库角色授予三个应用程序角色，以便它们各自具有访问该表所需的对象特权。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-E8DC6EA1-D1AB-47E3-A1F9-17E4EE64F0FA__GUID-A28E6908-C549-4182-8F0D-8895523E5727">创建应用程序用户</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>创建应用程序用户<code class="codeph">DAUSTIN</code> （在IT部门中）并授予此用户应用程序角色<code class="codeph">EMPPLOYEE</code>和<code class="codeph">IT_ENGINEER</code> 。</p>
                           <p>在这个例子中：</p>
                           <div class="infoboxnote" id="GUID-E8DC6EA1-D1AB-47E3-A1F9-17E4EE64F0FA__GUID-DC6A7F74-3BA2-4C6C-94FF-6709998CC7A8">
                              <p class="notep1">注意：</p>
                              <p>要使登录更容易，您可以使用大写创建名称。这样，用户可以在登录或连接到SQL * Plus时省略引号。例如：</p><pre class="oac_no_warn" dir="ltr">sqlplus DAUSTIN</pre></div>
                           <div class="infoboxnotealso" id="GUID-E8DC6EA1-D1AB-47E3-A1F9-17E4EE64F0FA__GUID-7B7A094D-D4DC-4BC9-B8F1-3AFE4401F330">
                              <p class="notep1">也可以看看：</p>
                              <p><span class="q">“ <a href="configuring-application-users-and-application-roles.html#GUID-7FAC6DD4-6D98-4EBB-A68E-101E1C576D0D">创建简单应用程序用户帐户</a> ”</span>以获取有关区分大小写如何影响应用程序用户的数据库登录的信息</p>
                           </div>
                           <p>创建应用程序用户<code class="codeph">SMAVRIS</code> （在HR部门中）并授予此用户应用程序角色<code class="codeph">EMPLOYEE</code>和<code class="codeph">HR_REPRESENTATIVE</code> 。</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-E8DC6EA1-D1AB-47E3-A1F9-17E4EE64F0FA__GUID-4132DB01-FF03-4D09-A873-E44D9EC854A7">为HR用户授予策略管理权限ADMIN_ANY_SEC_POLICY</p>
                           <p>为<code class="codeph">HR</code>用户授予<code class="codeph">ADMIN_ANY_SEC_POLICY</code>权限。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-E8DC6EA1-D1AB-47E3-A1F9-17E4EE64F0FA__GUID-0E8B29B9-CE0E-41CF-B2EC-5427513A6CD0">
                           <p class="titleinexample">示例5-10创建DB_EMP角色</p><pre class="oac_no_warn" dir="ltr">SQL&gt; create role db_emp;角色创建。SQL&gt;将hr.employees上的select，insert，update，delete授予db_emp;格兰特成功了。
</pre></div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-E8DC6EA1-D1AB-47E3-A1F9-17E4EE64F0FA__GUID-284AB98E-CB0B-49E0-86FD-B8F4499D3855">
                           <p class="titleinexample">示例5-11为Common Employees创建应用程序角色EMPLOYEE</p><pre class="oac_no_warn" dir="ltr">SQL&gt; exec sys.xs_principal.create_role（name =&gt;'employee'，enabled =&gt; true）; PL / SQL过程成功完成。
</pre></div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-E8DC6EA1-D1AB-47E3-A1F9-17E4EE64F0FA__GUID-C62EF6E9-AD6A-4E10-9D07-3FC848C999DF">
                           <p class="titleinexample">示例5-12为IT部门创建应用程序角色IT_ENGINEER</p><pre class="oac_no_warn" dir="ltr">SQL&gt; exec sys.xs_principal.create_role（name =&gt;'it_engineer'，enabled =&gt; true）; PL / SQL过程成功完成。
</pre></div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-E8DC6EA1-D1AB-47E3-A1F9-17E4EE64F0FA__GUID-C632B1B3-7168-4766-9AA6-FE821CDC85FA">
                           <p class="titleinexample">示例5-13为HR部门创建应用程序角色HR_REPRESENTATIVE</p><pre class="oac_no_warn" dir="ltr">SQL&gt; exec sys.xs_principal.create_role（name =&gt;'hr_representative'，enabled =&gt; true）; PL / SQL过程成功完成。
</pre></div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-E8DC6EA1-D1AB-47E3-A1F9-17E4EE64F0FA__GUID-0550AC4C-3DAA-4C96-B842-D0D748FCD3EF">
                           <p class="titleinexample">示例5-14向每个应用程序角色授予DB_EMP数据库角色</p><pre class="oac_no_warn" dir="ltr">SQL&gt;向员工授予db_emp;格兰特成功了。SQL&gt;将db_emp授予it_engineer;格兰特成功了。SQL&gt;将db_emp授予hr_representative;格兰特成功了。
</pre></div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-E8DC6EA1-D1AB-47E3-A1F9-17E4EE64F0FA__GUID-EF859CF5-4636-49ED-9AC6-EC8AD1EA02D1">
                           <p class="titleinexample">示例5-15创建应用程序用户DAUSTIN</p><pre class="oac_no_warn" dir="ltr">SQL&gt; exec sys.xs_principal.create_user（name =&gt;'daustin'，schema =&gt;'hr'）; PL / SQL过程成功完成。SQL&gt; exec sys.xs_principal.set_password（'daustin'，' <span class="italic">password</span> '）; PL / SQL过程成功完成。SQL&gt; exec sys.xs_principal.grant_roles（'daustin'，'XSCONNECT'）; PL / SQL过程成功完成。SQL&gt; exec sys.xs_principal.grant_roles（'daustin'，'employee'）; PL / SQL过程成功完成。SQL&gt; exec sys.xs_principal.grant_roles（'daustin'，'it_engineer'）; PL / SQL过程成功完成。
</pre></div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-E8DC6EA1-D1AB-47E3-A1F9-17E4EE64F0FA__GUID-F25454B4-FFFB-4725-9783-CF5508C86425">
                           <p class="titleinexample">示例5-16创建应用程序用户SMAVRIS</p><pre class="oac_no_warn" dir="ltr">SQL&gt; exec sys.xs_principal.create_user（name =&gt;'smavris'，schema =&gt;'hr'）; PL / SQL过程成功完成。SQL&gt; exec sys.xs_principal.set_password（'smavris'，' <span class="italic">password</span> '）; PL / SQL过程成功完成。SQL&gt; exec sys.xs_principal.grant_roles（'daustin'，'XSCONNECT'）; PL / SQL过程成功完成。SQL&gt; exec sys.xs_principal.grant_roles（'smavris'，'employee'）; PL / SQL过程成功完成。SQL&gt; exec sys.xs_principal.grant_roles（'smavris'，'hr_representative'）; PL / SQL过程成功完成。
</pre></div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-E8DC6EA1-D1AB-47E3-A1F9-17E4EE64F0FA__GUID-C5685B4F-861F-40E7-BC74-E0E6792C9F81">
                           <p class="titleinexample">示例5-17授予HR用户策略管理权限ADMIN_ANY_SEC_POLICY</p><pre class="oac_no_warn" dir="ltr">SQL&gt; exec sys.xs_admin_util.grant_system_privilege（'ADMIN_ANY_SEC_POLICY'，'HR'）; PL / SQL过程成功完成。</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="DBFSG445"></a><a id="DBFSG447"></a><a id="DBFSG446"></a><a id="DBFSG448"></a><a id="DBFSG444"></a><div class="props_rev_3"><a id="GUID-BF7A1CDF-E728-4AF4-B5AE-BC349CA36E6F" name="GUID-BF7A1CDF-E728-4AF4-B5AE-BC349CA36E6F"></a><h5 id="DBFSG-GUID-BF7A1CDF-E728-4AF4-B5AE-BC349CA36E6F" class="sect5">创建安全类和ACLS</h5>
                     <div>
                        <div class="section">
                           <p class="subhead3" id="GUID-BF7A1CDF-E728-4AF4-B5AE-BC349CA36E6F__GUID-86D31B8E-DF49-4179-9F64-B8776744C1A8">创建安全类</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>根据预定义的DML安全性类创建安全性类<code class="codeph">HR_PRIVILEGES</code> 。<code class="codeph">HR_PRIVILEGES</code>有一个新权限<code class="codeph">VIEW_SALARY</code> ，它控制对<code class="codeph">SALARY</code>列的访问。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-BF7A1CDF-E728-4AF4-B5AE-BC349CA36E6F__GUID-517A2D25-D44A-46EF-A0DF-620BB3DFD5B1">创建ACls</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>创建三个ACL， <code class="codeph">EMP_ACL</code> ， <code class="codeph">IT_ACL</code>和<code class="codeph">HR_ACL</code>以授予稍后定义的数据安全策略的权限。
                           </p>
                           <p>在这个例子中：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><span class="bold">第11到13行：</span>创建<code class="codeph">EMP_ACL</code>并授予<code class="codeph">EMPLOYEE</code> <code class="codeph">SELECT</code>和<code class="codeph">VIEW_SALARY</code>特权。
                                 </p>
                              </li>
                              <li>
                                 <p><span class="bold">第21行到第23行：</span>创建<code class="codeph">IT_ACL</code>并授予<code class="codeph">IT_ENGINEER</code> <code class="codeph">SELECT</code>权限。
                                 </p>
                              </li>
                              <li>
                                 <p><span class="bold">第30行到第33行：</span>创建<code class="codeph">HR_ACL</code>并授予<code class="codeph">HR_REPRESENTATIVE</code> <code class="codeph">SELECT</code> ， <code class="codeph">INSERT</code> ， <code class="codeph">UPDATE</code>和<code class="codeph">DELETE</code>数据库特权，以查看和更新所有员工的记录，并授予<code class="codeph">VIEW_SALARY</code>应用程序特权以查看<code class="codeph">SALARY</code>列。
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-BF7A1CDF-E728-4AF4-B5AE-BC349CA36E6F__GUID-B39EA2E9-9BEF-4A97-9870-246C38AE1B0C">
                           <p class="titleinexample">示例5-18创建HRPRIVS安全类</p><pre class="oac_no_warn" dir="ltr">SQL&gt; declare 2 begin 3 xs_security_class.create_security_class（4 name =&gt;'hr_privileges'，5 parent_list =&gt; xs $ name_list（'sys.dml'），6 priv_list =&gt; xs $ privilege_list（xs $ privilege（'view_salary'）） ）; 7结束; 8 / PL / SQL过程成功完成。
</pre></div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-BF7A1CDF-E728-4AF4-B5AE-BC349CA36E6F__GUID-2FB6CCBA-8A2E-4494-8073-BD5030BB1E3D">
                           <p class="titleinexample">示例5-19创建ACL：EMP_ACL，IT_ACL和HR_ACL</p><pre class="oac_no_warn" dir="ltr">SQL&gt;声明2个aces xs $ ace_list：= xs $ ace_list（）; 3开始4 aces.extend（1）; 5 6  -  EMP_ACL：此ACL授予EMPLOYEE角色查看员工7自己记录（包括SALARY列）的权限。8 aces（1）：= xs $ ace_type（privilege_list =&gt; xs $ name_list（'select'，'view_salary'），9 principal_name =&gt;'employee'）; 10 11 sys.xs_acl.create_acl（name =&gt;'emp_acl'，12 ace_list =&gt; aces，13 sec_class =&gt;'hr_privileges'）; 14 15  -  IT_ACL：此ACL授予IT_ENGINEER查看员工16的权限 -  IT部门中的记录，但不授予访问SALARY列所需的VIEW_SALARY 17权限。18 aces（1）：= xs $ ace_type（privilege_list =&gt; xs $ name_list（'select'），19 principal_name =&gt;'it_engineer'）; 20 21 sys.xs_acl.create_acl（name =&gt;'it_acl'，22 ace_list =&gt; aces，23 sec_class =&gt;'hr_privileges'）; 24 25  -  HR_ACL：此ACL授予HR_REPRESENTATIVE查看和更新所有26个员工记录（包括SALARY列）的权限。27 aces（1）：= xs $ ace_type（privilege_list =&gt; xs $ name_list（'select'，'insert'，28'update'，'delete'，'view_salary'），29 principal_name =&gt;'hr_representative'）; 30 31 sys.xs_acl.create_acl（name =&gt;'hr_acl'，32 ace_list =&gt; aces，33 sec_class =&gt;'hr_privileges'）; 34结束; 35 / PL / SQL过程成功完成。
</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="DBFSG451"></a><a id="DBFSG450"></a><a id="DBFSG452"></a><a id="DBFSG449"></a><div class="props_rev_3"><a id="GUID-389095E3-8F07-4C9F-9C57-35C546E242F1" name="GUID-389095E3-8F07-4C9F-9C57-35C546E242F1"></a><h5 id="DBFSG-GUID-389095E3-8F07-4C9F-9C57-35C546E242F1" class="sect5">创建数据安全策略</h5>
                     <div>
                        <div class="section">
                           <p>为<code class="codeph">EMPLOYEES</code>表创建数据安全策略。该策略定义了三个数据域约束和一个保护<code class="codeph">SALARY</code>列的列约束。
                           </p>
                           <p>在这个例子中：</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><span class="bold">第7行到第23行</span> ：定义三个数据域约束。
                                 </p>
                              </li>
                              <li>
                                 <p><span class="bold">第27到30行：</span>定义需要<code class="codeph">VIEW_SALARY</code>应用程序特权才能查看<code class="codeph">SALARY</code>列的列约束。
                                 </p>
                              </li>
                              <li>
                                 <p><span class="bold">第32行到第35行：</span>创建包含三个数据域约束和列约束的<span class="bold">EMPLOYEES_DS</span>数据安全策略。
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-389095E3-8F07-4C9F-9C57-35C546E242F1__GUID-F2450738-CC64-44A8-9252-8A0E1CD6509A">将数据安全策略应用于表</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>将数据安全策略应用于<code class="codeph">EMPLOYEES</code>表。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-389095E3-8F07-4C9F-9C57-35C546E242F1__CDDIEHFH">
                           <p class="titleinexample">示例5-20创建EMPLOYEES_DS数据安全策略</p><pre class="oac_no_warn" dir="ltr">SQL&gt;声明2个域xs $ realm_constraint_list：= xs $ realm_constraint_list（）; 3 cols xs $ column_constraint_list：= xs $ column_constraint_list（）; 4开始5 realms.extend（3）; 6 7  - 领域＃1：只有员工自己的记录。8  -  EMPLOYEE角色可以查看包括SALARY列的领域。9个领域（1）：= xs $ realm_constraint_type（10 realm =&gt;'email = xs_sys_context（''xs $ session''，''username''）'，11 acl_list =&gt; xs $ name_list（'emp_acl'））; 12 13  - 领域＃2：IT部门的记录。14  -  IT_ENGINEER角色可以查看除SALARY列之外的域。15个领域（2）：= xs $ realm_constraint_type（16 realm =&gt;'department_id = 60'，17 acl_list =&gt; xs $ name_list（'it_acl'））; 18 19  - 境界＃3：所有记录。20  -  HR_REPRESENTATIVE角色可以查看和更新包括SALARY列的领域。21 realms（3）：= xs $ realm_constraint_type（22 realm =&gt;'1 = 1'，23 acl_list =&gt; xs $ name_list（'hr_acl'））; 24 25  - 列约束通过要求VIEW_SALARY 26  - 特权来保护SALARY列。27 cols.extend（1）; 28 cols（1）：= xs $ column_constraint_type（29 column_list =&gt; xs $ list（'salary'），30 privilege =&gt;'view_salary'）; 31 32 sys.xs_data_security.create_policy（33 name =&gt;'employees_ds'，34 realm_constraint_list =&gt; realms，35 column_constraint_list =&gt; cols）; 36结束; 37 / PL / SQL过程成功完成。
</pre></div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-389095E3-8F07-4C9F-9C57-35C546E242F1__GUID-B91D008F-5A3A-410A-8C29-345063C6206A">
                           <p class="titleinexample">示例5-21将EMPLOYEES_DS安全策略应用于EMPLOYEES表</p><pre class="oac_no_warn" dir="ltr">SQL&gt; begin 2 sys.xs_data_security.apply_object_policy（3 policy =&gt;'employees_ds'，4 schema =&gt;'hr'，5 object =&gt;'employees'）; 6结束; 7 / PL / SQL过程成功完成。
</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="DBFSG454"></a><a id="DBFSG453"></a><div class="props_rev_3"><a id="GUID-826AAD8C-E182-4CFF-8421-F9FFFC333228" name="GUID-826AAD8C-E182-4CFF-8421-F9FFFC333228"></a><h5 id="DBFSG-GUID-826AAD8C-E182-4CFF-8421-F9FFFC333228" class="sect5">验证Real Application Security对象</h5>
                     <div>
                        <div class="section">
                           <p>创建这些Real Application Security对象后，请对其进行验证以确保它们都已正确配置。</p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-826AAD8C-E182-4CFF-8421-F9FFFC333228__GUID-49A2A0CB-22FC-458B-A97D-151968DAB7CC">
                           <p class="titleinexample">示例5-22验证Real Application Security对象</p><pre class="oac_no_warn" dir="ltr">SQL&gt; set serveroutput on; SQL&gt; begin 2 if（xs_diag.validate_workspace（））然后3 dbms_output.put_line（'所有配置都正确。“）; 4 else 5 dbms_output.put_line（'某些配置不正确。“）; 6结束如果; 7结束; 8 /所有配置都正确。PL / SQL过程成功完成。SQL&gt;  -  XS $ VALIDATION_TABLE包含验证错误（如果有）。SQL&gt;  - 期望不选择任何行。SQL&gt; select * from xs $ validation_table order by 1,2,3,4;没有选择任何行</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="DBFSG461"></a><a id="DBFSG458"></a><div class="props_rev_3"><a id="GUID-EFE8A9C2-9B17-4770-9EDA-CE92F6162B2B" name="GUID-EFE8A9C2-9B17-4770-9EDA-CE92F6162B2B"></a><h5 id="DBFSG-GUID-EFE8A9C2-9B17-4770-9EDA-CE92F6162B2B" class="sect5">禁用表的数据安全策略</h5>
                     <div>
                        <div class="section">
                           <p><a href="configuring-data-security.html#GUID-EFE8A9C2-9B17-4770-9EDA-CE92F6162B2B__CDDJIDCG">例5-23</a>显示了互补操作<a id="d20696e6587" class="indexterm-anchor"></a>禁用表<code class="codeph">HR.EMPLOYEES</code>数据安全性。</p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-EFE8A9C2-9B17-4770-9EDA-CE92F6162B2B__CDDJIDCG">
                           <p class="titleinexample">示例5-23禁用表的数据安全策略</p><pre class="oac_no_warn" dir="ltr">BEGIN SYS.XS_DATA_SECURITY.DISABLE_OBJECT_POLICY（policy =&gt;'EMPLOYEES_DS'，schema =&gt;'HR'，object =&gt;'EMPLOYEES'）;结束; /</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div>
               </div><a id="DBFSG455"></a><div class="props_rev_3"><a id="GUID-EE972F05-4F5E-4A60-B1F9-B26BA9A60533" name="GUID-EE972F05-4F5E-4A60-B1F9-B26BA9A60533"></a><h4 id="DBFSG-GUID-EE972F05-4F5E-4A60-B1F9-B26BA9A60533" class="sect4">运行安全HR演示</h4>
                  <div>
                     <div class="section">
                        <p>Security HR Demo以两种方式运行：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p>首先使用直接登录作为应用程序用户<code class="codeph">DAUSTIN</code>然后再作为应用程序用户<code class="codeph">SMAVRIS</code> 。</p>
                              <p>在每种情况下，每个用户都在<code class="codeph">HR.EMPLOYEES</code>表上执行查询，以演示每个人可以访问或无法访问以查看员工记录和<code class="codeph">SALARY</code>列的内容。有关此演示的说明，请参阅<span class="q">“ <a href="real-application-security-hr-demo.html#GUID-FA992EC6-83D5-4465-86D8-334EAA195C41">使用Direct Logon运行安全HR演示</a> ”</span> 。
                              </p>
                           </li>
                           <li>
                              <p>附加到Real Application Security会话</p>
                              <p>在此演示中，Real Application Security管理员为要附加到的应用程序用户创建Real Application Security会话。有关此演示的说明，请参阅<span class="q">“ <a href="real-application-security-hr-demo.html#GUID-158CF5F1-BF4C-46C3-9C99-B2686C340F7A">运行连接到Real Application Security会话的安全HR演示</a> ”</span> 。
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-F2B7BBD3-EACD-4D36-B8B5-CF7B7887335E" name="GUID-F2B7BBD3-EACD-4D36-B8B5-CF7B7887335E"></a><h3 id="DBFSG-GUID-F2B7BBD3-EACD-4D36-B8B5-CF7B7887335E" class="sect3">关于Schema Level Real Application Security Policy Administration</h3>
               <div>
                  <p>描述在同一模式中跨不同应用程序引入Real Application Security策略管理的模式级权限。</p>
                  <p>从Oracle Database 12 <span class="italic">c</span>第2版（12.2）开始，Real Application Security引入了架构级权限，允许策略管理员仅在授权的架构中创建，更新和应用策略，并在一个应用程序中管理策略实施，从而实现单独的在同一模式中跨不同应用程序管理和实施策略。在云计算方案中，此级别的策略管理至关重要，其中每个应用程序可能在一个或多个模式下运行。因此，策略管理员非常希望能够为该环境中的每个应用程序管理和应用数据安全策略。
                  </p>
                  <div class="section">
                     <p class="subhead2" id="GUID-F2B7BBD3-EACD-4D36-B8B5-CF7B7887335E__GUID-E95B3D70-4BBD-4CE2-BFDE-7B633F99FEC0">实现架构级数据安全策略管理</p>
                     <div class="p">为了实现模式级数据安全策略管理，引入了以下新增和更改的功能：<ul style="list-style-type:disc">
                           <li>
                              <p>通过添加<code class="codeph">schema</code>参数扩展了<code class="codeph">GRANT_SYSTEM_PRIVILEGE</code>和<code class="codeph">REVOKE_SYSTEM_PRIVILEGE</code>过程，以允许向数据库或应用程序用户授予和撤消对特定模式的Real Application Security特权，如以下语法描述所示：</p><pre class="pre codeblock"><code>XS_ADMIN_UTIL.GRANT_SYSTEM_PRIVILEGE（priv_name IN VARCHAR2，user_name IN VARCHAR2，user_type IN PLS_INTEGER：= XS_ADMIN_UTIL.PTYPE_DB，schema IN VARCHAR2）;</code></pre><pre class="pre codeblock"><code>XS_ADMIN_UTIL.REVOKE_SYSTEM_PRIVILEGE（priv_name IN VARCHAR2，user_name IN VARCHAR2，user_type IN PLS_INTEGER：= XS_ADMIN_UTIL.PTYPE_DB，schema IN VARCHAR2）;</code></pre><p><code class="codeph">schema</code>参数是授予权限的模式。如果特权是系统特权，则该值为<code class="codeph">NULL</code> 。
                              </p>
                           </li>
                           <li>
                              <p>系统安全性类<code class="codeph">ADMIN_SEC_POLICY</code>权限扩展到策略管理（创建，读取，更新和删除）操作的模式。因此，策略管理员可以将特定模式的<code class="codeph">ADMIN_SEC_POLICY</code>权限授予用户，以管理授予的模式中的策略工件，并为各个应用程序应用策略管理。受此增强功能影响的API包括Real Application Security管理员软件包： <code class="codeph">XS_ACL</code> ， <code class="codeph">XS_DATA_SECURITY</code>和<code class="codeph">XS_SECURITY_CLASS</code></p>
                           </li>
                           <li>
                              <div class="p">为策略实施添加了新的系统安全性类<code class="codeph">APPLY_SEC_POLICY</code>权限，以允许策略管理员在一个应用程序中的授权模式中强制实施策略。在实施数据安全策略之前，将检查以下数据安全API：<ul style="list-style-type:disc">
                                    <li>
                                       <p><code class="codeph">XS_DATA_SECURITY.APPLY_OBJECT_POLICY</code></p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">XS_DATA_SECURITY.REMOVE_OBJECT_POLICY</code></p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">XS_DATA_SECURITY.ENABLE_OBJECT_POLICY</code></p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">XS_DATA_SECURITY.DISABLE_OBJECT_POLICY</code></p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li>
                              <p>审计操作<code class="codeph">AUDIT_GRANT_PRIVILEGE</code>提供了<code class="codeph">GRANT_SYSTEM_PRIVILEGE</code>过程的审计。</p>
                           </li>
                           <li>
                              <p>审计操作<code class="codeph">AUDIT_REVOKE_PRIVILEGE</code>提供了对<code class="codeph">REVOKE_SYSTEM_PRIVILEGE</code>过程的审计。</p>
                           </li>
                           <li>
                              <p>添加了新的数据字典视图<code class="codeph">DBA_XS_PRIVILEGE_GRANTS</code> ，以显示数据库中的所有Real Applicaton Security系统或模式级别权限授予。
                              </p>
                           </li>
                           <li>
                              <p>此外，以下视图中加入： <a href="real-application-security-data-dictionary-views.html#GUID-F377CDE0-51A7-4E42-A10D-CB32112AE041">ALL_XS_SECURITY_CLASSES</a> ， <a href="real-application-security-data-dictionary-views.html#GUID-A5B7AD65-C26D-4D25-A0E8-6394F25E3086">ALL_XS_SECURITY_CLASS_DEP</a> ， <a href="real-application-security-data-dictionary-views.html#GUID-790A727D-A221-4F3E-A8C7-27E52C5E893C">ALL_XS_PRIVILEGES</a> ， <a href="real-application-security-data-dictionary-views.html#GUID-47D0EDCB-8422-4DDD-8DA8-5B74F20C221C">ALL_XS_IMPLIED_PRIVILEGES</a> ， <a href="real-application-security-data-dictionary-views.html#GUID-65EF3345-3831-4C99-9A1A-35CD3D326602">ALL_XS_ACLS</a> ， <a href="real-application-security-data-dictionary-views.html#GUID-6349A3A3-2E9C-44A6-82DA-0740419ABB0E">ALL_XS_ACES</a> ， <a href="real-application-security-data-dictionary-views.html#GUID-5A1BD47F-D0E5-439B-A51E-A9E9934DD5CA">ALL_XS_POLICIES</a> ， <a href="real-application-security-data-dictionary-views.html#GUID-37286402-B3E7-442B-8CB0-216E7D88F364">ALL_XS_REALM_CONSTRAINTS</a> ， <a href="real-application-security-data-dictionary-views.html#GUID-CBC0A40F-0F52-4C09-AAA3-12C9264645A7">ALL_XS_INHERITED_REALMS</a> ， <a href="real-application-security-data-dictionary-views.html#GUID-2F22C3EB-762E-47A8-8713-F98D6847D3F8">ALL_XS_ACL_PARAMETERS</a> ， <a href="real-application-security-data-dictionary-views.html#GUID-CFEE58B6-C53B-48AB-A41A-AF0DD1DC9950">ALL_XS_COLUMN_CONSTRAINTS</a> ， <a href="real-application-security-data-dictionary-views.html#GUID-DFE0E28A-F3C0-4900-BDCE-4B8E03FC793C">ALL_XS_APPLIED_POLICIES</a>和<a href="real-application-security-data-dictionary-views.html#GUID-94C1AE7D-B1EA-44B0-9966-7E90B3CCB20F">DBA_XS_PRIVILEGE_GRANTS</a></p>
                           </li>
                        </ul>
                     </div>
                     <p>本节包括以下主题： <a href="configuring-data-security.html#GUID-764D638F-2173-4F5D-85B4-C8E235D0902C" title="介绍如何为两个应用程序管理员设置和启用架构级别数据安全策略。">设置和启用架构级别数据安全策略</a> 。
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
               <div class="sect3"><a id="GUID-764D638F-2173-4F5D-85B4-C8E235D0902C" name="GUID-764D638F-2173-4F5D-85B4-C8E235D0902C"></a><h4 id="DBFSG-GUID-764D638F-2173-4F5D-85B4-C8E235D0902C" class="sect4">设置和启用架构级别数据安全策略</h4>
                  <div>
                     <p>介绍如何为两个应用程序管理员设置和启用架构级别数据安全策略。</p>
                     <div class="section">以下示例说明如何为两个应用程序管理员设置和启用架构级别数据安全策略，以管理两个不同的架构。稍后，它将说明如何禁用这两个应用程序管理员用户的数据安全策略并撤消系统权限。</div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-764D638F-2173-4F5D-85B4-C8E235D0902C__GUID-EF76036E-1649-4C21-A6DD-DAFCB63FF8DC">
                        <p>创建应用程序管理员用户，然后授予他们所需的角色。</p><pre class="pre codeblock"><code>EXEC SYS.XS_PRINCIPAL.CREATE_USER（NAME =&gt;'app_admin_user1'，SCHEMA =&gt;'HR'）; EXEC SYS.XS_PRINCIPAL.SET_PASSWORD（'app_admin_user1'，' <span class="italic">PASSWORD</span> '）; EXEC SYS.XS_PRINCIPAL.GRANT_ROLES（'app_admin_user1'，'XSCONNECT'）;</code></pre><pre class="pre codeblock"><code>EXEC SYS.XS_PRINCIPAL.CREATE_USER（NAME =&gt;'app_admin_user2'，SCHEMA =&gt;'SH'）; EXEC SYS.XS_PRINCIPAL.SET_PASSWORD（'app_admin_user2'，' <span class="italic">PASSWORD</span> '）; EXEC SYS.XS_PRINCIPAL.GRANT_ROLES（'app_admin_user2'，'XSCONNECT'）;</code></pre><p>具有<code class="codeph">SYS</code>或授予<code class="codeph">GRANT ANY PRIVILEGE</code>的用户的Real Application Security管理员将相应<code class="codeph">HR</code>和<code class="codeph">SH</code>模式的每个应用程序管理员用户的系统权限<code class="codeph">ADMIN_SEC_POLICY</code>和<code class="codeph">APPLY_SEC_POLICY</code>授予Real Application Security用户<code class="codeph">PTYPE_XS</code> 。</p><pre class="pre codeblock"><code>EXEC SYS.XS_ADMIN_UTIL.GRANT_SYSTEM_PRIVILEGE（'ADMIN_SEC_POLICY'，'app_admin_user1'，SYS.XS_ADMIN_UTIL.PTYPE_XS，'HR'）;</code></pre><pre class="pre codeblock"><code>EXEC SYS.XS_ADMIN_UTIL.GRANT_SYSTEM_PRIVILEGE（'APPLY_SEC_POLICY'，'app_admin_user1'，SYS.XS_ADMIN_UTIL.PTYPE_XS，'HR'）;</code></pre><pre class="pre codeblock"><code>EXEC SYS.XS_ADMIN_UTIL.GRANT_SYSTEM_PRIVILEGE（'ADMIN_SEC_POLICY'，'app_admin_user2'，SYS.XS_ADMIN_UTIL.PTYPE_XS，'SH'）;</code></pre><pre class="pre codeblock"><code>EXEC SYS.XS_ADMIN_UTIL.GRANT_SYSTEM_PRIVILEGE（'APPLY_SEC_POLICY'，'app_admin_user2'，SYS.XS_ADMIN_UTIL.PTYPE_XS，'SH'）;</code></pre><p>接下来，策略管理员将所需的对象策略应用于应用程序中的特定表并启用它。例如，有关为<code class="codeph">EMPLOYEE</code>表创建数据安全策略<code class="codeph">EMPLOYEES_DS</code>示例，请参阅HR演示脚本<a href="real-application-security-hr-demo.html#GUID-1A2F1C33-17A8-4A9A-98F7-47D7FB8A1863" title="描述创建数据安全策略的流程。">关于创建数据安全策略</a> 。创建后，策略管理员将数据安全策略<code class="codeph">EMPLOYEES_DS</code>应用于<code class="codeph">HR</code>模式中的<code class="codeph">EMPLOYEES</code>表。
                        </p><pre class="pre codeblock"><code>BEGIN SYS.XS_DATA_SECURITY.ENABLE_OBJECT_POLICY（policy =&gt;'EMPLOYEES_DS'，schema =&gt;'hr'，object =&gt;'employees'）;结束; /</code></pre><pre class="pre codeblock"><code>BEGIN SYS.XS_DATA_SECURITY.ENABLE_OBJECT_POLICY（policy =&gt;'CUSTOMERS_DS'，schema =&gt;'sh'，object =&gt;'customers'）;结束; /</code></pre></div>
                     <!-- class="example" -->
                  </div>
                  <div class="sect4"><a id="TASK-14-8EE69CC2" name="TASK-14-8EE69CC2"></a><h5 id="DBFSG-TASK-14-8EE69CC2" class="sect5">禁用数据安全策略并撤消用户的系统权限</h5>
                     <div>
                        <p>介绍如何禁用数据安全策略并撤消用户的系统权限。</p>
                        <div class="section">
                           <p class="subhead3" id="TASK-14-8EE69CC2__GUID-BEBE3184-084D-488B-8354-B8998EB26A7F">如何禁用数据安全策略并撤消用户的系统权限</p>
                           <div class="p">要在<code class="codeph">HR</code>模式中禁用<code class="codeph">EMPLOYEES</code>表的<code class="codeph">EMPLOYEES_DS</code>数据安全策略，策略管理员将执行以下操作：<pre class="pre codeblock"><code>BEGIN SYS.XS_DATA_SECURITY.DISABLE_OBJECT_POLICY（policy =&gt;'EMPLOYEES_DS'，schema =&gt;'hr'，object =&gt;'employees'）;结束; /</code></pre></div>
                           <div class="p">要为<code class="codeph">SH</code>模式中的<code class="codeph">CUSTOMERS</code>表禁用<code class="codeph">CUSTOMERS_DS</code>数据安全策略，策略管理员将执行以下操作：<pre class="pre codeblock"><code>BEGIN SYS.XS_DATA_SECURITY.DISABLE_OBJECT_POLICY（policy =&gt;'CUSTOMERS_DS'，schema =&gt;'sh'，object =&gt;'customers'）;结束; /</code></pre></div>
                           <p>要从应用程序管理员用户<code class="codeph">app_admin_user1</code>和<code class="codeph">app_admin_user2</code>撤消系统权限，而不是来自角色<code class="codeph">policy_admin_role</code>因为可能有其他策略管理员启用了此相同角色，具有<code class="codeph">SYS</code>权限的实际应用程序安全管理员或授予<code class="codeph">GRANT ANY PRIVILEGE</code>权限的用户将撤消系统应用程序用户<code class="codeph">app_admin_user1</code>和<code class="codeph">app_admin_user2</code>特权<code class="codeph">ADMIN_SEC_POLICY</code>和<code class="codeph">APPLY_SEC_POLICY</code>如下：</p><pre class="pre codeblock"><code>EXEC SYS.XS_ADMIN_UTIL.REVOKE_SYSTEM_PRIVILEGE（'APPLY_SEC_POLICY'，'app_admin_user1'，SYS.XS_ADMIN_UTIL.PTYPE_XS，'HR'）; EXEC SYS.XS_ADMIN_UTIL.REVOKE_SYSTEM_PRIVILEGE（'ADMIN_SEC_POLICY'，'app_admin_user1'，SYS.XS_ADMIN_UTIL.PTYPE_XS，'HR'）;</code></pre><pre class="pre codeblock"><code>EXEC SYS.XS_ADMIN_UTIL.REVOKE_SYSTEM_PRIVILEGE（'APPLY_SEC_POLICY'，'app_admin_user2'，SYS.XS_ADMIN_UTIL.PTYPE_XS，'SH'）; EXEC SYS.XS_ADMIN_UTIL.REVOKE_SYSTEM_PRIVILEGE（'ADMIN_SEC_POLICY'，'app_admin_user2'，SYS.XS_ADMIN_UTIL.PTYPE_XS，'SH'）;</code></pre></div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>