<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="SQL/JSON functions json_object, json_array, json_objectagg, and json_arrayagg are presented."></meta>
      <meta name="description" content="SQL/JSON functions json_object, json_array, json_objectagg, and json_arrayagg are presented."></meta>
      <title>使用SQL / JSON函数生成JSON数据</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="JSON Developer&#39;s Guide"></meta>
      <meta property="og:description" content="SQL/JSON functions json_object, json_array, json_objectagg, and json_arrayagg are presented."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="JSON Developer&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="json-developers-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-02-22T10:58:31-08:00"></meta>
      <meta name="dcterms.title" content="JSON Developer&#39;s Guide"></meta>
      <meta name="dcterms.dateCopyrighted" content="2015, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96227-03"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="generation-of-json-data.html" title="Previous" type="text/html"></link>
      <link rel="next" href="pl-sql-object-types-for-json.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="ADJSN"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="generation-of-json-data.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="pl-sql-object-types-for-json.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">JSON开发人员指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="generation-of-json-data.html" property="item" typeof="WebPage"><span property="name">生成JSON数据</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">使用SQL / JSON函数生成JSON数据</li>
            </ol>
            <a id="GUID-6C3441E8-4F02-4E95-969C-BBCA6BDBBD9A" name="GUID-6C3441E8-4F02-4E95-969C-BBCA6BDBBD9A"></a>
            
            <h2 id="ADJSN-GUID-6C3441E8-4F02-4E95-969C-BBCA6BDBBD9A" class="sect2"><span class="enumeration_chapter">21</span>使用SQL / JSON函数生成JSON数据</h2>
         </header>
         <div class="ind"><script type="text/javascript">window.name='generation'</script><script type="text/javascript">
    function footdisplay(footnum,footnote) {
    var msg = window.open('about:blank', 'NewWindow' + footnum,
        'directories=no,height=100,location=no,menubar=no,resizable=yes,' +
        'scrollbars=yes,status=no,toolbar=no,width=598');
    msg.document.open('text/html');
    msg.document.write('<!DOCTYPE html ');
    msg.document.write('PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" ');
    msg.document.write('"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">'); 
    msg.document.write('<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us" dir="ltr"><head><title>');
   
    msg.document.write('Footnote&nbsp; ' + footnum);
    msg.document.write('<\/title><meta http-equiv="Content-Type" ');
    msg.document.write('content="text/html; charset=utf-8" />');
    msg.document.write('<meta http-equiv="Content-Script-Type" ');
    msg.document.write('content="text/javascript" />');
    msg.document.write('<style type="text/css"> <![CDATA[ ');
    msg.document.write('h1 {text-align: center; font-size: 14pt;}');
    msg.document.write('fieldset {border: none;}');
    msg.document.write('form {text-align: center;}');
    msg.document.write(' ]]u003e </style>');
    msg.document.write('<\/head><body><div id="footnote"><h1>Footnote&nbsp; ' + footnum + '<\/h1><p>');
    msg.document.write(footnote);
    msg.document.write('<\/p><form action="" method="post"><fieldset>');
    msg.document.write('<input type="button" value="OK" ');
    msg.document.write('onclick="window.close();" />');
    msg.document.write('<\/fieldset><\/form><\/div><\/body><\/html>');
    msg.document.close();
    setTimeout(function() {
        var height = msg.document.getElementById('footnote').offsetHeight;
        msg.resizeTo(598, height + 100);
    }
    , 100);
    msg.focus();
}
            </script><noscript>
               <p>此页面上的脚本内容仅用于导航目的，不会以任何方式更改内容。</p>
            </noscript>
            <div>
               <p>提供了SQL / JSON函数<code class="codeph">json_object</code> ， <code class="codeph">json_array</code> ， <code class="codeph">json_objectagg</code>和<code class="codeph">json_arrayagg</code> 。
               </p>
               <div class="section"></div>
               <!-- class="section" -->
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="generation.html#GUID-C0F8F837-EE36-4EDD-9261-6E8A9245906C">SQL / JSON生成函数概述</a><br>您可以使用SQL / JSON函数<code class="codeph">json_object</code> ， <code class="codeph">json_array</code> ， <code class="codeph">json_objectagg</code>和<code class="codeph">json_arrayagg</code>从数据库中的非JSON数据构造JSON数据。JSON数据作为SQL值返回。
                  </li>
                  <li class="ulchildlink"><a href="generation.html#GUID-2916ECA4-D033-4232-8CFE-CF9801F5AF2B">处理SQL / JSON生成函数的输入值</a><br>SQL / JSON生成函数将SQL值作为输入，并将其作为返回的SQL值内的JSON值呈现。输入值如何呈现为JSON取决于它们的SQL数据类型。
                  </li>
                  <li class="ulchildlink"><a href="generation.html#GUID-1084A518-A44A-4654-A796-C1DD4D8EC2AA">SQL / JSON函数JSON_OBJECT</a><br>SQL / JSON函数<code class="codeph">json_object</code>从关系（SQL）数据构造JSON对象。
                  </li>
                  <li class="ulchildlink"><a href="generation.html#GUID-F942D202-E4BB-4ED8-997E-AEBD6D8ED8C1">SQL / JSON函数JSON_ARRAY</a><br>SQL / JSON函数<code class="codeph">json_array</code>根据其参数SQL表达式的结果构造一个JSON数组。
                  </li>
                  <li class="ulchildlink"><a href="generation.html#GUID-E4DDB4E8-A4B9-4EA9-BC26-1879AA661D37">SQL / JSON函数JSON_OBJECTAGG</a><br>SQL / JSON函数<code class="codeph">json_objectagg</code>通过聚合来自分组SQL查询的多行的信息作为对象成员<code class="codeph">json_objectagg</code>构造JSON对象。
                  </li>
                  <li class="ulchildlink"><a href="generation.html#GUID-B0FA4582-762D-4C32-8A0C-265142BD347B">SQL / JSON函数JSON_ARRAYAGG</a><br>SQL / JSON函数<code class="codeph">json_arrayagg</code>通过聚合来自分组SQL查询的多行的信息作为数组元素<code class="codeph">json_arrayagg</code>构造JSON数组。默认情况下，数组元素的顺序反映了查询结果顺序，但您可以使用<code class="codeph">ORDER BY</code>子句强制执行数组元素顺序。
                  </li>
               </ul>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>父主题：</strong> <a href="generation-of-json-data.html#GUID-D5DD4CFA-0675-4074-9D5B-F1AAE42DA719" title="您可以使用SQL / JSON函数json_object，json_array，json_objectagg和json_arrayagg，以编程方式使用SQL从其他类型的数据库数据生成JSON数据。">生成JSON数据</a></p>
                  </div>
               </div>
            </div>
            
            <div class="sect2"><a id="GUID-C0F8F837-EE36-4EDD-9261-6E8A9245906C" name="GUID-C0F8F837-EE36-4EDD-9261-6E8A9245906C"></a><h3 id="ADJSN-GUID-C0F8F837-EE36-4EDD-9261-6E8A9245906C" class="sect3"><span class="enumeration_section">21.1</span> SQL / JSON生成函数概述</h3>
               <div>
                  <p>您可以使用SQL / JSON函数<code class="codeph">json_object</code> ， <code class="codeph">json_array</code> ， <code class="codeph">json_objectagg</code>和<code class="codeph">json_arrayagg</code>从数据库中的非JSON数据构造JSON数据。JSON数据作为SQL值返回。
                  </p>
                  <p>这些生成函数可以直接从SQL查询中轻松构造JSON数据。它们允许将非JSON数据表示为JSON对象和JSON数组。您可以通过嵌套对这些函数的调用来生成复杂的分层JSON文档。嵌套子查询可以生成表示一对多关系的JSON集合。<a id="fn_1" name="fn_1" href="#fn_1" data="" the="" behavior="" of="" sql="" /json="" generation="" functions="" for="" json="" is="" similar="" to="" that="" /xml="" xml="" data=")" ="" onclick="footdisplay(1, "><sup>脚1</sup></a></p>
                  <div class="section" id="GUID-C0F8F837-EE36-4EDD-9261-6E8A9245906C__THESQLJSONGENERATIONFUNCTIONSARETHE-0BEE1127">
                     <p class="subhead2" id="GUID-C0F8F837-EE36-4EDD-9261-6E8A9245906C__THESQLJSONGENERATIONFUNCTIONSARETHE-0BEE0EDE">从非JSON数据构造JSON数据的最佳方法</p>
                     <p>使用SQL / JSON生成函数的替代方法通常容易出错或效率低下。</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>使用<span class="italic">字符串连接</span>生成JSON文档很容易出错。特别是，关于何时以及如何转义特殊字符（例如双引号（ <code class="codeph">"</code> ）），必须遵守许多复杂的规则。很容易忽视或误解这些规则，这可能导致生成不正确的JSON数据。
                           </p>
                        </li>
                        <li>
                           <p>从数据库读取非JSON结果集并使用<span class="italic">客户端应用程序代码</span>生成JSON数据通常效率很低，特别是由于网络开销。当将一对多关系表示为JSON数据时，通常需要多个<code class="codeph">SELECT</code>操作来收集所需的所有非JSON数据。如果要生成的文档代表多个级别的一对多关系，那么这种技术可能非常昂贵。
                           </p>
                        </li>
                     </ul>
                     <p>SQL / JSON生成函数不会遇到这样的问题;它们是为从非JSON数据库数据构造JSON数据而设计的。</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>它们总是构造格式良好的JSON文档。</p>
                        </li>
                        <li>
                           <p>通过将SQL子查询与这些函数一起使用，您可以使用单个SQL语句生成一整套JSON文档，从而可以优化生成操作。</p>
                        </li>
                        <li>
                           <p>因为只将生成的文档返回给客户端，所以网络开销最小化：每个文档最多生成一次往返。</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-C0F8F837-EE36-4EDD-9261-6E8A9245906C__THESQLJSONGENERATIONFUNCTIONS-0BEDE84E">
                     <p class="subhead2" id="GUID-C0F8F837-EE36-4EDD-9261-6E8A9245906C__THESQLJSONGENERATIONFUNCTIONS-0BEDE5D6">SQL / JSON生成函数</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>函数<code class="codeph"><span class="bold">json_object</span></code>和<code class="codeph"><span class="bold">json_array</span></code>构造一个JSON对象或数组。在最简单的情况下， <code class="codeph">json_object</code>将SQL名称 - 值对作为参数， <code class="codeph">json_array</code>将SQL值作为参数。
          
                           </p>
                        </li>
                        <li>
                           <p>函数<code class="codeph"><span class="bold">json_objectagg</span></code>和<code class="codeph"><span class="bold">json_arrayagg</span></code>是<span class="italic">聚合</span> SQL函数。它们分别将分组的SQL查询的行中包含的信息转换为JSON对象和数组。参数的评估分别确定对象成员和数组元素的数量;也就是说，结果的大小反映了当前查询的数据。
                           </p>
                           <p>对于<code class="codeph">json_objectagg</code>和<code class="codeph">json_arrayagg</code> ，未指定对象成员和数组元素的顺序。对于<code class="codeph">json_arrayagg</code> ，您可以在<code class="codeph">json_arrayagg</code>调用中使用<code class="codeph">ORDER BY</code>子句来控制数组元素顺序。
                           </p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-C0F8F837-EE36-4EDD-9261-6E8A9245906C__RESULTRETURNEDBYSQLJSONGENERATIONFU-02201A2A">
                     <p class="subhead2" id="GUID-C0F8F837-EE36-4EDD-9261-6E8A9245906C__GUID-49C0E367-25FE-455A-B57A-64FCFD36046B">SQL / JSON生成函数返回的结果</p>
                     <p>默认情况下，生成的JSON数据作为SQL <code class="codeph">VARCHAR2</code>值从生成函数返回。您可以使用可选的<code class="codeph">RETURNING</code>子句指定<code class="codeph">VARCHAR2</code>大小或指定<code class="codeph">CLOB</code>或<code class="codeph">BLOB</code>返回值。当<code class="codeph">BLOB</code>是返回类型时，字符集是AL32UTF8。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-C0F8F837-EE36-4EDD-9261-6E8A9245906C__HANDLINGOFINPUTVALUESFORSQLJSONGENE-E12FED19">
                     <p class="subhead2" id="GUID-C0F8F837-EE36-4EDD-9261-6E8A9245906C__HANDLINGOFINPUTVALUESFORSQLJSONGENE-E12FF10F">处理SQL / JSON生成函数的输入值</p>
                     <p>SQL / JSON生成函数将SQL值作为输入，并将其作为返回的SQL值内的JSON值呈现。输入值如何呈现为JSON取决于它们的SQL数据类型。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-C0F8F837-EE36-4EDD-9261-6E8A9245906C__OPTIONALBEHAVIORFORSQLJSONGENERATIO-022017DB">
                     <p class="subhead2" id="GUID-C0F8F837-EE36-4EDD-9261-6E8A9245906C__GUID-ED4BFB13-FEB3-4097-B384-39867E4E5076">SQL / JSON生成函数的可选行为</p>
                     <p>您可以选择指定SQL <code class="codeph">NULL</code> -handling子句， <code class="codeph">RETURNING</code>子句和关键字<code class="codeph">STRICT</code> 。</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">NULL</code> -handling子句 - 确定如何处理由输入求值产生的SQL <code class="codeph">NULL</code>值。
                           </p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><code class="codeph"><span class="bold">NULL ON NULL</span></code> - 输出SQL <code class="codeph">NULL</code>值转换为JSON <code class="codeph">null</code>以进行输出。这是<code class="codeph">json_object</code>和<code class="codeph">json_objectagg</code>的默认行为。
                                 </p>
                              </li>
                              <li>
                                 <p><code class="codeph"><span class="bold">ABSENT ON NULL</span></code> - 输入SQL <code class="codeph">NULL</code>值不会导致相应的输出。这是<code class="codeph">json_array</code>和<code class="codeph">json_arrayagg</code>的默认行为。
                                 </p>
                              </li>
                           </ul>
                        </li>
                        <li>
                           <p><code class="codeph"><span class="bold">RETURNING</span></code>子句 - 用于函数返回值的SQL数据类型。默认值为<code class="codeph">VARCHAR2(4000)</code> 。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph"><span class="bold">STRICT</span></code>关键字 - 如果存在，则检查返回的JSON数据，以确保其格式正确。如果存在<code class="codeph">STRICT</code>且返回的数据格式不正确，则会引发错误。
                           </p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section"></div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="generation.html#GUID-2916ECA4-D033-4232-8CFE-CF9801F5AF2B" title="SQL / JSON生成函数将SQL值作为输入，并将其作为返回的SQL值内的JSON值呈现。输入值如何呈现为JSON取决于它们的SQL数据类型。">处理SQL / JSON生成函数的输入值</a></li>
                        <li><a href="json-path-expressions.html#GUID-20DC09A8-98DF-4473-8077-913D490A969C" title="国际标准组织（ISO）标准8601描述了一种国际公认的表示日期和时间的方法。Oracle数据库支持许多ISO 8601日期和时间格式。">ISO 8601日期和时间支持</a></li>
                     </ul>
                  </div>
                  <div class="infoboxnotealso" id="GUID-C0F8F837-EE36-4EDD-9261-6E8A9245906C__GUID-21BC57D6-FD27-4CF8-8551-6A8F566A9B2E">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>有关SQL / JSON函数<code class="codeph">json_array</code>信息，请<a href="../sqlrf/JSON_ARRAY.html#SQLRF-GUID-46CDB3AF-5795-455B-85A8-764528CEC43B" target="_blank"><span><cite>参见Oracle数据库SQL语言参考</cite></span></a></p>
                        </li>
                        <li>
                           <p>有关SQL / JSON函数<code class="codeph">json_arrayagg</code>信息，请<a href="../sqlrf/JSON_ARRAYAGG.html#SQLRF-GUID-6D56077D-78DE-4CC0-9498-225DDC42E054" target="_blank"><span><cite>参见Oracle数据库SQL语言参考</cite></span></a></p>
                        </li>
                        <li>
                           <p>有关SQL / JSON函数<code class="codeph">json_object</code>信息，请<a href="../sqlrf/JSON_OBJECT.html#SQLRF-GUID-1EF347AE-7FDA-4B41-AFE0-DD5A49E8B370" target="_blank"><span><cite>参见Oracle数据库SQL语言参考</cite></span></a></p>
                        </li>
                        <li>
                           <p>有关SQL / JSON函数<code class="codeph">json_objectagg</code>信息，请<a href="../sqlrf/JSON_OBJECTAGG.html#SQLRF-GUID-09422D4A-936C-4D38-9991-C64101283D98" target="_blank"><span><cite>参见Oracle数据库SQL语言参考</cite></span></a></p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="generation.html#GUID-6C3441E8-4F02-4E95-969C-BBCA6BDBBD9A" title="提供了SQL / JSON函数json_object，json_array，json_objectagg和json_arrayagg。">使用SQL / JSON函数生成JSON数据</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-2916ECA4-D033-4232-8CFE-CF9801F5AF2B" name="GUID-2916ECA4-D033-4232-8CFE-CF9801F5AF2B"></a><h3 id="ADJSN-GUID-2916ECA4-D033-4232-8CFE-CF9801F5AF2B" class="sect3"><span class="enumeration_section">21.2</span> SQL / JSON生成函数的输入值处理</h3>
               <div>
                  <p>SQL / JSON生成函数将SQL值作为输入，并将其作为返回的SQL值内的JSON值呈现。输入值如何呈现为JSON取决于它们的SQL数据类型。</p>
                  <p>默认情况下，SQL <code class="codeph">NUMBER</code>值在输出中呈现为JSON编号，SQL <code class="codeph">VARCHAR2</code>值呈现为JSON字符串，依此类推。例如，默认情况下， <code class="codeph">VARCHAR2</code>值<code class="codeph">'{}'</code>呈现为JSON字符串<code class="codeph">"{}"</code> 。
                  </p>
                  <p>在某些情况下，您知道或期望输入值实际上已经表示JSON数据，并且您希望将此信息传递给生成函数，以便保持值不变。例如，如果输入为<code class="codeph">'{}'</code>那么您可能希望将其解释（呈现）为空JSON <span class="italic">对象</span> <code class="codeph">{}</code> ，而不是JSON <span class="italic">字符串</span> <code class="codeph">"{}"</code> 。
                  </p>
                  <p>您可以通过在输入表达式之后添加关键字<code class="codeph"><span class="bold">FORMAT JSON</span></code>来声明由此产生的值被视为已经表示JSON数据。同样，您可以将带有关键字<code class="codeph"><span class="bold">AS JSON</span></code> SQL函数<code class="codeph"><span class="bold">treat</span></code>应用于生成函数输入值 - 效果与使用<code class="codeph">FORMAT JSON</code>相同。</p>
                  <p>在许多情况下，Oracle可以自动确定输入值实际上是JSON数据，在这种情况下，输入被视为后面跟着显式的<code class="codeph">FORMAT JSON</code>声明。例如，如果值表达式本身是对SQL / JSON生成函数或函数<code class="codeph">json_query</code>的调用，则就是这种情况。
                  </p>
                  <p>如果<span class="italic">没有</span>为给定的输入值指定<code class="codeph">FORMAT JSON</code> ，并且Oracle <span class="italic">无法</span>确定该值是JSON数据，则假定它是普通（非JSON）SQL数据。在这种情况下，它被序列化如下（任何其他SQL值引发错误）：</p>
                  <ul id="GUID-2916ECA4-D033-4232-8CFE-CF9801F5AF2B__UL_WKM_CZJ_1GB" style="list-style-type:disc">
                     <li>
                        <p>用户定义的SQL对象类型的实例呈现为JSON对象，其字段名称取自对象属性名称，其字段值取自对象属性值（递归应用JSON生成）。</p>
                     </li>
                     <li>
                        <p>SQL集合类型的实例呈现为JSON数组，其元素值取自集合元素值（递归应用JSON生成）。</p>
                     </li>
                     <li>
                        <p><code class="codeph">VARCHAR2</code> ， <code class="codeph">CLOB</code>或<code class="codeph">NVARCHAR</code>值用双引号（ <code class="codeph"><span class="bold">"</span></code> ）括起来，并在必要时转义字符以符合JSON标准。
                        </p>
                     </li>
                     <li>
                        <p>数值（ <code class="codeph">NUMBER</code> ， <code class="codeph">BINARY_DOUBLE</code>或<code class="codeph">BINARY_FLOAT</code> ）呈现为JSON编号。（没有引用。）
                        </p>
                        <p>正数和负数无穷大的数值以及作为数字运算的未定义结果的值（“非数字”或<code class="codeph">NaN</code> ）不能表示为JSON数字。它们分别呈现为JSON字符串： <code class="codeph"><span class="bold">"Inf"</span></code> ， <code class="codeph"><span class="bold">"-Inf"</span></code> <code class="codeph"><span class="bold">"Inf"</span></code>和<code class="codeph"><span class="bold">"Nan"</span></code> 。
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">RAW</code>或<code class="codeph">BLOB</code>值呈现为十六进制JSON字符串（带双引号， <code class="codeph"><span class="bold">"</span></code> ）。
                        </p>
                     </li>
                     <li>
                        <p>与时间相关的值（ <code class="codeph">DATE</code> ， <code class="codeph">TIMESTAMP</code> ， <code class="codeph">TIMESTAMP WITH TIME ZONE</code> ， <code class="codeph">TIMESTAMP WITH LOCAL TIME ZONE</code> ， <code class="codeph">INTERVAL YEAR TO MONTH</code>或<code class="codeph">INTERVAL DAY TO SECOND</code> ）以支持的ISO 8601格式呈现，结果用双引号括起来（ <code class="codeph"><span class="bold">"</span></code> ）。
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">BOOLEAN</code> PL / SQL值呈现为JSON <code class="codeph">true</code>或<code class="codeph">false</code> 。（没有引用。）
                        </p>
                     </li>
                     <li>
                        <p>无论<code class="codeph">NULL</code>数据类型如何， <code class="codeph">NULL</code>值都呈现为JSON <code class="codeph">null</code> 。（没有引用。）
                        </p>
                     </li>
                  </ul>
                  <div class="infoboxnote" id="GUID-2916ECA4-D033-4232-8CFE-CF9801F5AF2B__GUID-D8225538-5B9B-407D-BD77-3275B36FEBA5">
                     <p class="notep1">注意：</p>
                     <p>对于数据类型<code class="codeph">CLOB</code>和<code class="codeph">BLOB</code> ，空实例与<code class="codeph">NULL</code>区分开来，并呈现为空JSON字符串（ <code class="codeph"><span class="bold">""</span></code> ）。但是，对于数据类型<code class="codeph">VARCHAR2</code> ， <code class="codeph">NVARCHAR2</code> ，和<code class="codeph">RAW</code> ，的Oracle SQL把一个空（零长度）值作为<code class="codeph">NULL</code> ，所以<span class="italic">不要</span>指望这样的值，以呈现为一个JSON字符串。
                     </p>
                  </div>
                  <p>输入参数的格式可以影响函数返回的数据的格式。特别是，如果声明输入或自动确定输入格式为JSON，则在计算返回值时将其视为JSON数据。<a href="generation.html#GUID-2916ECA4-D033-4232-8CFE-CF9801F5AF2B__DECLARINGANINPUTVALUETOBEJSON-04C5C58E">例21-1</a>说明了这一点 - 它显式地使用<code class="codeph">FORMAT JSON</code>将SQL字符串<code class="codeph">"true"</code>解释为JSON布尔值<code class="codeph">true</code> 。
                  </p>
                  <div class="example" id="GUID-2916ECA4-D033-4232-8CFE-CF9801F5AF2B__DECLARINGANINPUTVALUETOBEJSON-04C5C58E">
                     <p class="titleinexample">示例21-1声明输入值为JSON</p>
                     <p>此示例为SQL字符串值<code class="codeph">'true'</code>和<code class="codeph">'false'</code>指定<code class="codeph">FORMAT JSON</code> ，以便使用JSON布尔值<code class="codeph">true</code>和<code class="codeph">false</code> 。如果不指定<code class="codeph">FORMAT JSON</code> ，字段<code class="codeph">hasCommission</code>的值将是JSON <span class="italic">字符串</span>值<code class="codeph">"true"</code>和<code class="codeph">"false"</code> ，而不是JSON <span class="italic">布尔</span>值<code class="codeph">true</code>和<code class="codeph">false</code> 。
                     </p><pre class="pre codeblock"><code>SELECT json_object（'name'VALUE first_name ||''|| last_name，'hasCommission'VALUE CASE WHEN Commission_pct IS NULL THEN'false'ELSE'true'END <span class="bold">FORMAT JSON</span> ）FROM employees WHERE first_name LIKE'W％'; JSON_OBJECT（'NAME'ISFIRST_NAME ||''|| LAST_NAME，'----------------------------------- ------------ {“name”：“William Gietz”，“hasCommission”： <span class="bold">false</span> } {“name”：“William Smith”，“hasCommission”： <span class="bold">true</span> } {“name”：“温斯顿泰勒“，”hasCommission“： <span class="bold">false</span> }</code></pre></div>
                  <!-- class="example" -->
                  <div class="section"></div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="generation.html#GUID-C0F8F837-EE36-4EDD-9261-6E8A9245906C" title="您可以使用SQL / JSON函数json_object，json_array，json_objectagg和json_arrayagg从数据库中的非JSON数据构造JSON数据。JSON数据作为SQL值返回。">SQL / JSON生成函数概述</a></li>
                        <li><a href="generation.html#GUID-1084A518-A44A-4654-A796-C1DD4D8EC2AA" title="SQL / JSON函数json_object从关系（SQL）数据构造JSON对象。">SQL / JSON函数JSON_OBJECT</a></li>
                        <li><a href="generation.html#GUID-F942D202-E4BB-4ED8-997E-AEBD6D8ED8C1" title="SQL / JSON函数json_array根据其参数SQL表达式的结果构造一个JSON数组。">SQL / JSON函数JSON_ARRAY</a></li>
                     </ul>
                  </div>
                  <div class="infoboxnotealso" id="GUID-2916ECA4-D033-4232-8CFE-CF9801F5AF2B__GUID-1F74EF1D-D404-4D0E-BF87-FD5AA6768CAC">
                     <p class="notep1">也可以看看：</p>
                     <p><a href="../sqlrf/Data-Types.html#SQLRF-GUID-7B72E154-677A-4342-A1EA-C74C1EA928E6" target="_blank">https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=SQLRF-GUID-7B72E154-677A-4342-A1EA-C74C1EA928E6#GUID-7B72E154- 677A-4342-A1EA-C74C1EA928E6</a></p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="generation.html#GUID-6C3441E8-4F02-4E95-969C-BBCA6BDBBD9A" title="提供了SQL / JSON函数json_object，json_array，json_objectagg和json_arrayagg。">使用SQL / JSON函数生成JSON数据</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-1084A518-A44A-4654-A796-C1DD4D8EC2AA" name="GUID-1084A518-A44A-4654-A796-C1DD4D8EC2AA"></a><h3 id="ADJSN-GUID-1084A518-A44A-4654-A796-C1DD4D8EC2AA" class="sect3"><span class="enumeration_section">21.3</span> SQL / JSON函数JSON_OBJECT</h3>
               <div>
                  <p>SQL / JSON函数<code class="codeph">json_object</code>从关系（SQL）数据构造JSON对象。
                  </p>
                  <p>它接受任意数量的参数，每个参数可以是以下任何一个：</p>
                  <ul id="GUID-1084A518-A44A-4654-A796-C1DD4D8EC2AA__UL_W13_5TS_1GB" style="list-style-type:disc">
                     <li>
                        <p>显式字段名称 - 值对。示例： <code class="codeph">answer : 42</code> 。
                        </p>
                     </li>
                     <li>
                        <p>表名或别名或视图名称，后跟一个圆点和一个星号通配符（ <code class="codeph"><span class="bold">.*</span></code> ）。示例： <code class="codeph">t1.*</code> 。（名称或别名也可以使用数据库模式名称作为前缀，如<code class="codeph">myschema.t1.*</code> 。）
                        </p>
                     </li>
                     <li>
                        <p>关系列名称，可能以表名或别名开头，或者后跟点（ <code class="codeph"><span class="bold">.</span></code> ）的视图名称。示例： <code class="codeph">t1.address</code> 。
                        </p>
                     </li>
                  </ul>
                  <p>或者，它接受<span class="italic">单个</span>参数，即星号通配符（ <code class="codeph"><span class="bold">*</span></code> ）或用户定义的SQL对象类型的单个实例。
                  </p>
                  <p>描述星号通配符使用的另一种方法是它遵循SQL <code class="codeph">SELECT</code>列表中允许使用通配符的方式。
                  </p>
                  <p><span class="italic">名称 - 值</span>对参数指定生成的JSON对象的对象成员（除非值表达式求值为SQL <code class="codeph">NULL</code>且应用了<code class="codeph">ABSENT ON NULL</code>子句）。名称和值是SQL表达式。<span class="italic">名称</span>表达式必须求值为SQL <span class="italic">字符串</span> 。<span class="italic">值</span>表达式必须求值为可以呈现为JSON值的SQL值。名称和值表达式通过关键字分离<code class="codeph"><span class="bold">VALUE</span></code>或冒号（ <code class="codeph"><span class="bold">:</span></code> ）。
                  </p>
                  <div class="infoboxnote" id="GUID-1084A518-A44A-4654-A796-C1DD4D8EC2AA__GUID-30362697-259A-415C-AD22-A9C059AB6AE3">
                     <p class="notep1">注意：</p>
                     <p>某些客户端驱动程序可能会在将查询发送到数据库之前尝试扫描查询文本并识别绑定变量。在某些情况下， <code class="codeph">json_object</code>冒号作为名称 - 值分隔符可能会被误解为引入绑定变量。您可以使用关键字<code class="codeph">VALUE</code>作为分隔符来避免此问题（ <code class="codeph">'Name' VALUE Diderot</code> ），或者您可以简单地将对的值部分括在括号中： <code class="codeph">'Name':(Diderot)</code> 。
                     </p>
                  </div>
                  <p>如果使用<span class="italic">列名</span>作为参数，则对于给定的数据行，column-name参数指定的对象成员将列名称作为其字段名称，将列值作为字段值。无论是否引用，您提供的列名都将<span class="italic">区分大小写</span> 。例如，如果使用<code class="codeph">Email</code>作为列名参数，则<code class="codeph">EMAIL</code>列中的数据用于生成字段名称为<code class="codeph">Email</code>对象成员。
                  </p>
                  <p>您可以使用星号（ <code class="codeph"><span class="bold">*</span></code> ） <span class="italic">通配符</span>作为快捷方式，以显式指定给定表或视图的<span class="italic">所有</span>列以生成对象成员。生成的对象字段名称是<span class="italic">大写的</span>列名称。您可以将通配符与表，视图或表别名一起使用。
                  </p>
                  <p>您可以传递用户定义的SQL对象类型的单个实例，而不是传递用于定义单个JSON对象成员的SQL表达式。这将生成一个JSON对象，其字段名称取自对象属性名称，其字段值取自对象属性值（递归应用JSON生成）。</p>
                  <div class="example" id="GUID-1084A518-A44A-4654-A796-C1DD4D8EC2AA__GUID-D46A2775-B3A9-4153-A016-2D3D67B8D745">
                     <p class="titleinexample">示例21-2使用带有JSON_OBJECT的名称 - 值对</p>
                     <p>此示例为工资大于15000的表<code class="codeph">hr.employees</code> （来自标准数据库模式<code class="codeph">HR</code> ）的每个雇员构造一个JSON对象。
                     </p>
                     <p>它传递显式的名称 - 值对以指定JSON对象成员。作为其字段<code class="codeph">contactInfo</code>的值，JSON对象包括具有字段<code class="codeph">mail</code>和<code class="codeph">phone</code>的对象。
                     </p>
                     <p>由于返回值<code class="codeph">json_object</code>是JSON数据<code class="codeph">FORMAT JSON</code>推导出现场的输入格式<code class="codeph">contactInfo</code> -明确<code class="codeph">FORMAT JSON</code>不需要在这里。
         
                     </p><pre class="pre codeblock"><code>SELECT <span class="bold">json_object</span> （'id'：employee_id，'name'：first_name ||''|| last_name，'hireDate'：hire_date，'pay'：salary，'contactInfo'： <span class="bold">json_object</span> （'mail'：email，'phone'： phone_number）格式JSON）来自hr.employees WHERE salary&gt; 15000; - 查询返回这样的行（为清晰起见，这里打印得非常漂亮）：{“id”：101，“name”：“Neena Kochhar”，“hireDate”：“21-SEP-05”，“pay”： 17000，“contactInfo”：{“mail”：“NKOCHHAR”，“phone”：“515.123.4568”}}</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-1084A518-A44A-4654-A796-C1DD4D8EC2AA__GUID-0CD0015D-98BB-4311-AB57-1631CA78888E">
                     <p class="titleinexample">示例21-3将列名与JSON_OBJECT一起使用</p>
                     <p>此示例为<code class="codeph">employee_id</code>为<code class="codeph">101</code>的员工构造JSON对象。生成的字段以列命名，但区分大小写。
                     </p><pre class="pre codeblock"><code>SELECT <span class="bold">json_object</span> （last_name，hire_date，salary，'contactInfo'： <span class="bold">json_object</span> （email，phone_number）FORMAT JSON）FROM hr.employees WHERE employee_id = 101; - 查询返回这样的行（为清晰起见，这里打印得非常漂亮）：{“last_name”：“Neena Kochhar”，“hire-date”：“21-SEP-05”，“salary”：17000，“contactInfo “：{”email“：”NKOCHHAR“，”phone_number“：”515.123.4568“}}</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-1084A518-A44A-4654-A796-C1DD4D8EC2AA__GUID-C401997F-825D-4A9E-B24A-0519CC270C8D">
                     <p class="titleinexample">示例21-4使用带有JSON_OBJECT的通配符（*）</p>
                     <p>此示例为薪水大于15000的每个员工构造一个JSON对象。表雇员的每列用于构造一个对象成员，其字段名称是（大写）列名称。请注意，SQL <code class="codeph">NULL</code>值会导致JSON字段值为<code class="codeph">null</code> 。
                     </p><pre class="pre codeblock"><code>SELECT <span class="bold">json_object</span> （ <span class="bold">*</span> ）FROM hr.employees WHERE salary&gt; 15000; - 查询返回这样的行（为清晰起见，这里打印得非常漂亮）：JSON_OBJECT（*）-------------- {“EMPLOYEE_ID”：100，“FIRST_NAME”：“Steven” ，“LAST_NAME”：“King”，“EMAIL”：“SKING”，“PHONE_NUMBER”：“515.123.4567”，“HIRE_DATE”：“2003-06-17T00：00：00”，“JOB_ID”：“AD_PRES” ，“SALARY”：24000，“COMMISSION_PCT”：null，“MANAGER_ID”：null，“DEPARTMENT_ID”：90} {“EMPLOYEE_ID”：101，“FIRST_NAME”：“Neena”，“LAST_NAME”：“Kochhar”，“EMAIL “：”NKOCHHAR“，”PHONE_NUMBER“：”515.123.4568“，”HIRE_DATE“：”2005-09-21T00：00：00“，”JOB_ID“：”AD_VP“，”SALARY“：17000，”COMMISSION_PCT“： null，“MANAGER_ID”：100，“DEPARTMENT_ID”：90} {“EMPLOYEE_ID”：102，“FIRST_NAME”：“Lex”，“LAST_NAME”：“De Haan”，“EMAIL”：“LDEHAAN”，“PHONE_NUMBER”： “515.123.4569”，“HIRE_DATE”：“2001-01-13T00：00：00”，“JOB_ID”：“AD_VP”，“SALARY”：17000，“COMMISSION_PCT”：null，“MANAGER_ID”：100，“DEPARTMENT_ID “：90}</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-1084A518-A44A-4654-A796-C1DD4D8EC2AA__GUID-BE6CB437-2C5B-4D9B-9E91-0EBA4B0E97F3">
                     <p class="titleinexample">示例21-5使用带有ABSENT ON NULL的JSON_OBJECT</p>
                     <p>此示例从标准数据库模式<code class="codeph">HR</code>查询表<code class="codeph">hr.locations</code>以创建具有<code class="codeph">city</code>和<code class="codeph">province</code>字段的JSON对象。
                     </p>
                     <p><code class="codeph">json_object</code>的默认<code class="codeph">NULL</code>行为是<code class="codeph">NULL ON NULL</code> 。</p>
                     <p>为了防止创建具有<code class="codeph">null</code> JSON值的字段，此示例使用<code class="codeph">ABSENT ON NULL</code> 。列<code class="codeph">city</code>具有值<code class="codeph">'Singapore'</code>时列<code class="codeph">state_province</code>的<code class="codeph">NULL</code> SQL值表示没有为该位置创建<code class="codeph">province</code>字段。
                     </p><pre class="pre codeblock"><code>SELECT JSON_OBJECT（'city'VALUE city，'province'：state_province <span class="bold">ABSENT ON NULL</span> ）来自hr.locations WHERE city LIKE'S％'; JSON_OBJECT（'CITY'ISCITY，'PROVINCE'ISSTATE_PROVINCEABSENTONNULL）-------------------------------------- -------------------------- {“city”：“Southlake”， <span class="italic">“province”</span> ：“Texas”} {“city”：“South旧金山“， <span class="italic">”省“</span> ：”加利福尼亚“} {”城市“：”南不伦瑞克“， <span class="italic">”省“</span> ：”新泽西“} {”城市“：”西雅图“， <span class="italic">”省“</span> ：”华盛顿“} {”城市“：”悉尼“， <span class="italic">”省“</span> ：”新南威尔士“} <span class="bold">{”城市“：”新加坡“}</span> {”城市“：”斯特雷特福德“， <span class="italic">”省“</span> ：”曼彻斯特“} {”城市“：”圣保罗“， <span class="italic">”省“</span> ：”圣保罗“}</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-1084A518-A44A-4654-A796-C1DD4D8EC2AA__GUID-F476C9BD-3A5E-45AA-92A0-0806881CAE04">
                     <p class="titleinexample">示例21-6将用户定义的对象类型实例与JSON_OBJECT一起使用</p>
                     <p>这个例子创建表<code class="codeph">po_ship</code>用柱<code class="codeph">shipping</code>对象类型的<code class="codeph">shipping_t</code> 。（它使用SQL / JSON函数<code class="codeph">json_value</code>从JSON数据构造<code class="codeph">shipping_t</code>实例 - 请参见<a href="function-JSON_VALUE.html#GUID-622170D8-7BAD-4F5F-86BF-C328451FC3BE__GUID-F8C5F1BC-B369-4E4D-8EBC-BCE8EE7BEE3E">示例16-3</a> 。）
                     </p>
                     <p>然后，它使用<code class="codeph">json_object</code>从列<code class="codeph">po_ship.shipping</code>的SQL对象类型实例生成JSON对象。
                     </p>
                     <p>（为清楚起见，查询输出在此处显示为漂亮。）</p><pre class="pre codeblock"><code>CREATE TABLE <span class="bold">po_ship</span> AS SELECT json_value（po_document，'$。ShippingInstructions'RETURNING <span class="bold">shipping_t</span> ） <span class="bold">shipping</span> from j_purchaseorder; DESCRIBE po_ship;名字空？输入--------- ------- ---------- <span class="bold">SHIPPING</span> <span class="bold">SHIPPING_T</span> SELECT <span class="bold">json_object</span> （ <span class="bold">shipping</span> ）来自po_ship; JSON_OBJECT（SHIPPING）--------------------- {“NAME”：“Alexis Bull”，“ADDRESS”：{“STREET”：“200 Sporting Green”， “CITY”：“South San Francisco”}} {“NAME”：“Sarah Bell”，“ADDRESS”：{“STREET”：“200 Sporting Green”，“CITY”：“South San Francisco”}}</code></pre></div>
                  <!-- class="example" -->
                  <div class="section"></div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="generation.html#GUID-C0F8F837-EE36-4EDD-9261-6E8A9245906C" title="您可以使用SQL / JSON函数json_object，json_array，json_objectagg和json_arrayagg从数据库中的非JSON数据构造JSON数据。JSON数据作为SQL值返回。">SQL / JSON生成函数概述</a></li>
                        <li><a href="generation.html#GUID-2916ECA4-D033-4232-8CFE-CF9801F5AF2B" title="SQL / JSON生成函数将SQL值作为输入，并将其作为返回的SQL值内的JSON值呈现。输入值如何呈现为JSON取决于它们的SQL数据类型。">处理SQL / JSON生成函数的输入值</a></li>
                     </ul>
                  </div>
                  <div class="infoboxnotealso" id="GUID-1084A518-A44A-4654-A796-C1DD4D8EC2AA__GUID-4232E956-EC4B-45E1-A24B-F9BF9BB4AD46">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>有关<code class="codeph">select_list</code>语法的信息，请<a href="../sqlrf/SELECT.html#SQLRF-GUID-CFA006CA-6FF1-4972-821E-6996142A51C6" target="_blank"><span><cite>参见Oracle数据库SQL语言参考</cite></span></a></p>
                        </li>
                        <li>
                           <p>有关SQL / JSON函数<code class="codeph">json_object</code>信息，请<a href="../sqlrf/JSON_OBJECT.html#SQLRF-GUID-1EF347AE-7FDA-4B41-AFE0-DD5A49E8B370" target="_blank"><span><cite>参见Oracle数据库SQL语言参考</cite></span></a></p>
                        </li>
                        <li>
                           <p>用于SQL标识符语法的<a href="../sqlrf/Database-Object-Names-and-Qualifiers.html#SQLRF-GUID-3C59E44A-5140-4BCA-B9E1-3039C8050C49" target="_blank"><span><cite>Oracle数据库SQL语言参考</cite></span></a></p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="generation.html#GUID-6C3441E8-4F02-4E95-969C-BBCA6BDBBD9A" title="提供了SQL / JSON函数json_object，json_array，json_objectagg和json_arrayagg。">使用SQL / JSON函数生成JSON数据</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-F942D202-E4BB-4ED8-997E-AEBD6D8ED8C1" name="GUID-F942D202-E4BB-4ED8-997E-AEBD6D8ED8C1"></a><h3 id="ADJSN-GUID-F942D202-E4BB-4ED8-997E-AEBD6D8ED8C1" class="sect3"><span class="enumeration_section">21.4</span> SQL / JSON函数JSON_ARRAY</h3>
               <div>
                  <p>SQL / JSON函数<code class="codeph">json_array</code>根据其参数SQL表达式的结果构造一个JSON数组。
                  </p>
                  <p>在最简单的情况下，您提供给<code class="codeph">json_array</code>的计算参数是作为JSON数组元素转换为JSON值的SQL值。结果数组为您提供的每个参数都有一个元素（除非参数表达式求值为SQL <code class="codeph">NULL</code>且应用了<code class="codeph">ABSENT ON NULL</code>子句）。数组元素顺序与参数顺序相同。
                  </p>
                  <p>有几种SQL值可用作<code class="codeph">json_array</code>的参数，包括标量，集合实例和用户定义的对象类型实例。
                  </p>
                  <div class="example" id="GUID-F942D202-E4BB-4ED8-997E-AEBD6D8ED8C1__GUID-6035C6C4-1952-4A61-865A-1031F76C5131">
                     <p class="titleinexample">示例21-7使用JSON_ARRAY构造JSON数组</p>
                     <p>此示例为数据库表<code class="codeph">hr.jobs</code>每个雇员作业构建一个JSON对象（来自标准数据库模式<code class="codeph">HR</code> ）。对象的字段是职称和工资范围。工资范围（字段<code class="codeph">salaryRange</code> ）是两个数值的数组，即作业的最小和最大工资。这些值取自SQL列<code class="codeph">min_salary</code>和<code class="codeph">max_salary</code> 。
                     </p><pre class="pre codeblock"><code>SELECT json_object（'title'VALUE job_title，'salaryRange'VALUE <span class="bold">json_array</span> （min_salary，max_salary））FROM jobs; JSON_OBJECT（'TITLE'ISJOB_TITLE，'SALARYRANGE'ISJSON_ARRAY（MIN_SALARY，MAX_SALARY））--------------------------------- ----------------------------------------------- {“title “：”总统“，”salaryRange“：[20080,40000]} {”title“：”行政副总统“，”salaryRange“：[15000,30000]} {”title“：”行政助理“，”salaryRange“ ：[3000,6000]} {“title”：“财务经理”，“salaryRange”：[8200,16000]} {“title”：“accountant”，“salaryRange”：[4200,9000]} {“title” ：“会计经理”，“salaryRange”：[8200,16000]} {“title”：“公共会计师”，“salaryRange”：[4200,9000]} {“title”：“销售经理”，“salaryRange”： [10000,20080]} {“title”：“销售代表”，“salaryRange”：[6000,12008]} {“title”：“采购经理”，“salaryRange”：[8000,15000]} {“title” ：“Purchasing Clerk”，“salaryRange”：[2500,5500]} {“title”：“Stock Manager”，“salaryRange”：[5500,8500]} {“title”：“Stock Clerk”，“salaryRange”： [2008,5000]} {“title”：“Shipping Clerk”，“salaryRange”：[2500,5500]} {“title”：“Programmer”，“salaryRange”：[4000,10000]} {“tit le“：”营销经理“，”salaryRange“：[9000,15000]} {”title“：”营销代表“，”salaryRange“：[4000,9000]} {”title“：”人力资源代表“，” salaryRange“：[4000,9000]} {”title“：”公关代表“，”salaryRange“：[4500,10500]}</code></pre></div>
                  <!-- class="example" -->
                  <div class="section"></div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="generation.html#GUID-C0F8F837-EE36-4EDD-9261-6E8A9245906C" title="您可以使用SQL / JSON函数json_object，json_array，json_objectagg和json_arrayagg从数据库中的非JSON数据构造JSON数据。JSON数据作为SQL值返回。">SQL / JSON生成函数概述</a></li>
                        <li><a href="generation.html#GUID-2916ECA4-D033-4232-8CFE-CF9801F5AF2B" title="SQL / JSON生成函数将SQL值作为输入，并将其作为返回的SQL值内的JSON值呈现。输入值如何呈现为JSON取决于它们的SQL数据类型。">处理SQL / JSON生成函数的输入值</a></li>
                        <li><a href="generation.html#GUID-1084A518-A44A-4654-A796-C1DD4D8EC2AA" title="SQL / JSON函数json_object从关系（SQL）数据构造JSON对象。">SQL / JSON函数JSON_OBJECT</a></li>
                     </ul>
                  </div>
                  <div class="infoboxnotealso" id="GUID-F942D202-E4BB-4ED8-997E-AEBD6D8ED8C1__GUID-5A9973C7-8BEA-43D7-BF48-104499131741">
                     <p class="notep1">也可以看看：</p>
                     <p>有关SQL / JSON函数<code class="codeph">json_array</code>信息，请<a href="../sqlrf/JSON_ARRAY.html#SQLRF-GUID-46CDB3AF-5795-455B-85A8-764528CEC43B" target="_blank"><span><cite>参见Oracle数据库SQL语言参考</cite></span></a></p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="generation.html#GUID-6C3441E8-4F02-4E95-969C-BBCA6BDBBD9A" title="提供了SQL / JSON函数json_object，json_array，json_objectagg和json_arrayagg。">使用SQL / JSON函数生成JSON数据</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-E4DDB4E8-A4B9-4EA9-BC26-1879AA661D37" name="GUID-E4DDB4E8-A4B9-4EA9-BC26-1879AA661D37"></a><h3 id="ADJSN-GUID-E4DDB4E8-A4B9-4EA9-BC26-1879AA661D37" class="sect3"><span class="enumeration_section">21.5</span> SQL / JSON函数JSON_OBJECTAGG</h3>
               <div>
                  <p>SQL / JSON函数<code class="codeph">json_objectagg</code>通过聚合来自分组SQL查询的多行的信息作为对象成员<code class="codeph">json_objectagg</code>构造JSON对象。
                  </p>
                  <p>与SQL / JSON函数<code class="codeph">json_object</code>的情况不同，其中结果对象中的成员数直接反映了参数的数量，对于<code class="codeph">json_objectagg</code> ，结果对象的大小反映了当前查询的数据。因此，它可以根据查询的数据而变化。
                  </p>
                  <div class="example" id="GUID-E4DDB4E8-A4B9-4EA9-BC26-1879AA661D37__GUID-470D6D38-3CF7-4E7B-A5A5-C30FACF1C4F4">
                     <p class="titleinexample">示例21-8使用JSON_OBJECTAGG构造JSON对象</p>
                     <p>此示例使用从<code class="codeph">department_name</code>列中获取的字段名称和从<code class="codeph">department_id</code>列获取的字段值，从表<code class="codeph">hr.departments</code> （来自标准数据库模式<code class="codeph">HR</code> ）构造单个JSON对象。
   
                     </p><pre class="pre codeblock"><code>SELECT <span class="bold">json_objectagg</span> （department_name VALUE department_id）FROM departments; - 为清晰起见，返回的对象在这里打印得很漂亮。- 对象成员的顺序是任意的。JSON_OBJECTAGG（DEPARTMENT_NAMEISDEPARTMENT_ID）---------------------------------------------- {“管理”：10，“营销”：20，“采购”：30，“人力资源”：40，“运输”：50，“IT”：60，“公共关系”：70，“销售”：80 ，“执行”：90，“财务”：100，“会计”：110，“财政部”：120，“企业税”：130，“控制与信用”：140，“股东服务”：150，“福利” ：160，“制造”：170，“建筑”：180，“承包”：190，“操作”：200，“IT支持”：210，“NOC”：220，“IT帮助台”：230，“政府销售” “：240，”零售业“：250，”招聘“：260，”薪资“：270}</code></pre></div>
                  <!-- class="example" -->
                  <div class="section"></div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="generation.html#GUID-C0F8F837-EE36-4EDD-9261-6E8A9245906C" title="您可以使用SQL / JSON函数json_object，json_array，json_objectagg和json_arrayagg从数据库中的非JSON数据构造JSON数据。JSON数据作为SQL值返回。">SQL / JSON生成函数概述</a></li>
                     </ul>
                  </div>
                  <div class="infoboxnotealso" id="GUID-E4DDB4E8-A4B9-4EA9-BC26-1879AA661D37__GUID-D06A8DC7-444C-470F-A4D6-46DA0DDF1CDF">
                     <p class="notep1">也可以看看：</p>
                     <p>有关SQL / JSON函数<code class="codeph">json_objectagg</code>信息，请<a href="../sqlrf/JSON_OBJECTAGG.html#SQLRF-GUID-09422D4A-936C-4D38-9991-C64101283D98" target="_blank"><span><cite>参见Oracle数据库SQL语言参考</cite></span></a></p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="generation.html#GUID-6C3441E8-4F02-4E95-969C-BBCA6BDBBD9A" title="提供了SQL / JSON函数json_object，json_array，json_objectagg和json_arrayagg。">使用SQL / JSON函数生成JSON数据</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-B0FA4582-762D-4C32-8A0C-265142BD347B" name="GUID-B0FA4582-762D-4C32-8A0C-265142BD347B"></a><h3 id="ADJSN-GUID-B0FA4582-762D-4C32-8A0C-265142BD347B" class="sect3"><span class="enumeration_section">21.6</span> SQL / JSON函数JSON_ARRAYAGG</h3>
               <div>
                  <p>SQL / JSON函数<code class="codeph">json_arrayagg</code>通过聚合来自分组SQL查询的多行的信息作为数组元素<code class="codeph">json_arrayagg</code>构造JSON数组。默认情况下，数组元素的顺序反映了查询结果顺序，但您可以使用<code class="codeph">ORDER BY</code>子句强制执行数组元素顺序。
                  </p>
                  <p>与SQL / JSON函数<code class="codeph">json_array</code>的情况不同，其中结果数组中的元素数直接反映了参数的数量，对于<code class="codeph">json_arrayagg</code> ，结果数组的大小反映了当前查询的数据。因此，它可以根据查询的数据而变化。
                  </p>
                  <div class="example" id="GUID-B0FA4582-762D-4C32-8A0C-265142BD347B__GUID-E9251967-C6EB-4025-8A92-FC7262C6D490">
                     <p class="titleinexample">示例21-9使用JSON_ARRAYAGG构造JSON数组</p>
                     <p>此示例为表<code class="codeph">hr.employees</code> （来自标准数据库模式<code class="codeph">HR</code> ）的每个员工构造一个JSON对象，该员工是负责至少六名员工的经理。对象具有经理ID号，经理姓名，向经理报告的员工数以及这些员工的ID号的字段。
    
                     </p>
                     <p>数组中员工ID号的顺序由<code class="codeph">json_arrayagg</code>的<code class="codeph">ORDER BY</code>子句<code class="codeph">json_arrayagg</code> 。<code class="codeph">ORDER BY</code>的默认方向是<code class="codeph">ASC</code> （升序）。数字元素是按数字升序排列的。
                     </p><pre class="pre codeblock"><code>SELECT json_object（'id'VALUE mgr.employee_id，'manager'VALUE（mgr.first_name ||''|| mgr.last_name），'numReports'VALUE count（rpt.employee_id），' <span class="bold">reports'VALUE json_arrayagg</span> （rpt.employee_id <span class="bold">ORDER BY</span> rpt.employee_id））FROM employees mgr，employees rpt WHERE mgr.employee_id = rpt.manager_id <span class="bold">GROUP BY</span> mgr.employee_id，mgr.last_name，mgr.first_name HAVING count（rpt.employee_id）&gt; 6; - 为清晰起见，返回的对象在这里打印得很漂亮。JSON_OBJECT（'ID'ISMGR.EMPLOYEE_ID，'MANAGER'VALUE（MGR.FIRST_NAME ||''||| MGR.LAST_NAME）----------------------- -------------------------------------------------- ---------- {“id”：100，“manager”：“Steven King”，“numReports”：14，“reports”： <span class="bold">[101,102,114,120,121,122,123,124,145,146,147,148,149,201]</span> } {“id”：120，“manager” ：“Matthew Weiss”，“numReports”：8，“reports”： <span class="bold">[125,126,127,128,180,181,182,183]</span> } {“id”：121，“manager”：“Adam Fripp”，“numReports”：8，“reports”： <span class="bold">[129,130,131,132,184,185,186,187]</span> } {“id”：122，“manager”：“Payam Kaufling”，“numReports”：8，“reports”： <span class="bold">[133,134,135,136,188,189,190,191]</span> } {“id”：123，“manager”：“Shanta Vollman”，“numReports”： 8，“报告”： <span class="bold">[137,138,139,140,192,193,194,195]</span> } {“id”：124，“经理”：“Kevin Mourgos”，“numReports”：8，“报告”： <span class="bold">[141,142,143,144,196,197,198,199]</span> }</code></pre></div>
                  <!-- class="example" -->
                  <div class="section"></div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="generation.html#GUID-C0F8F837-EE36-4EDD-9261-6E8A9245906C" title="您可以使用SQL / JSON函数json_object，json_array，json_objectagg和json_arrayagg从数据库中的非JSON数据构造JSON数据。JSON数据作为SQL值返回。">SQL / JSON生成函数概述</a></li>
                     </ul>
                  </div>
                  <div class="infoboxnotealso" id="GUID-B0FA4582-762D-4C32-8A0C-265142BD347B__GUID-F6D14467-FFB8-4CC2-A3CB-711024B92EFF">
                     <p class="notep1">也可以看看：</p>
                     <p>有关SQL / JSON函数<code class="codeph">json_arrayagg</code>信息，请<a href="../sqlrf/JSON_ARRAYAGG.html#SQLRF-GUID-6D56077D-78DE-4CC0-9498-225DDC42E054" target="_blank"><span><cite>参见Oracle数据库SQL语言参考</cite></span></a></p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="generation.html#GUID-6C3441E8-4F02-4E95-969C-BBCA6BDBBD9A" title="提供了SQL / JSON函数json_object，json_array，json_objectagg和json_arrayagg。">使用SQL / JSON函数生成JSON数据</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <hr><br><p style="text-decoration:underline">脚注图例</p>脚注1：JSON数据的SQL / JSON生成函数的行为类似于XML数据的SQL / XML生成函数的行为。<br></div>
      </article>
   </body>
</html>