<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="An explanation is given of how to determine the differences between two Extensible Markup Language (XML) inputs and apply the differences as a patch to one of the XML documents."></meta>
      <meta name="description" content="An explanation is given of how to determine the differences between two Extensible Markup Language (XML) inputs and apply the differences as a patch to one of the XML documents."></meta>
      <title>使用C确定XML差异</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Programmer&#39;s Guide"></meta>
      <meta property="og:description" content="An explanation is given of how to determine the differences between two Extensible Markup Language (XML) inputs and apply the differences as a patch to one of the XML documents."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Programmer&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="xml-developers-kit-programmers-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-11T05:58:48-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2001, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96292-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="using-XML-schema-processor-for-C.html" title="Previous" type="text/html"></link>
      <link rel="next" href="using-SOAP-with-XDK.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="XML Developers Kit Programmers Guide"></meta>
    <meta name="dcterms.isVersionOf" content="ADXDK"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="using-XML-schema-processor-for-C.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="using-SOAP-with-XDK.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">程序员指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="XDK-for-C.html" property="item" typeof="WebPage"><span property="name">适用于C的Oracle XML Developer's Kit</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">使用C确定XML差异</li>
            </ol>
            <a id="GUID-C602E94C-6FC5-4451-B2E0-ED6C5A888B52" name="GUID-C602E94C-6FC5-4451-B2E0-ED6C5A888B52"></a><a id="ADXDK1041"></a><a id="ADXDK2500"></a>
            
            <h2 id="ADXDK-GUID-C602E94C-6FC5-4451-B2E0-ED6C5A888B52" class="sect2"><span class="enumeration_chapter">8</span>使用C确定XML差异</h2>
         </header>
         <div class="ind">
            <div>
               <p>解释了如何确定两个可扩展标记语言（XML）输入之间的差异，并将差异作为补丁应用于其中一个XML文档。</p>
               <div class="section"></div>
               <!-- class="section" -->
            </div><a id="ADXDK19828"></a><div class="props_rev_3"><a id="GUID-9CE0A27F-1595-4BA1-8BF2-083C10274EA9" name="GUID-9CE0A27F-1595-4BA1-8BF2-083C10274EA9"></a><h3 id="ADXDK-GUID-9CE0A27F-1595-4BA1-8BF2-083C10274EA9" class="sect3">C语言中的XMLDiff概述</h3>
               <div>
                  <p>您可以使用Oracle <code class="codeph">XmlDiff</code>确定两个类似的XML文档之间的差异。它生成一个<code class="codeph">Xdiff</code>实例文档，指示差异。<code class="codeph">Xdiff</code>文档是符合XML模式（ <code class="codeph">Xdiff</code>模式）的XML文档。
                  </p>
                  <p>然后，您可以使用<code class="codeph">XmlPatch</code> ，它获取<code class="codeph">Xdiff</code>实例文档并将更改应用于其他文档。您可以使用此过程将相同的更改应用于大量XML文档。
                  </p>
                  <p><code class="codeph">XmlDiff</code>仅支持用于输入和输出的文档对象模型（DOM）应用程序编程接口（API）。
                  </p>
                  <p><code class="codeph">XmlPatch</code>还支持输入和补丁文档的DOM。
                  </p>
                  <p>您可以通过C API或命令行工具使用<code class="codeph">XmlDiff</code>和<code class="codeph">XmlPatch</code> 。它们由两个结构化查询语言（SQL）函数公开。
                  </p>
                  <p>提供<code class="codeph">XmlHash</code> C API来计算XML树或子树的哈希值。如果两个树或子树的哈希值相等，则树的概率非常高。
                  </p>
               </div><a id="ADXDK19829"></a><div class="sect3"><a id="GUID-BB147A78-50C6-43DD-8A07-CAAB060A5F74" name="GUID-BB147A78-50C6-43DD-8A07-CAAB060A5F74"></a><h4 id="ADXDK-GUID-BB147A78-50C6-43DD-8A07-CAAB060A5F74" class="sect4">XMLDiff的处理流程</h4>
                  <div>
                     <p>描述了XMLDiff流程。</p>
                     <ol>
                        <li>
                           <p>两个输入文档由<code class="codeph">XmlDiff</code>进行比较。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">XmlDiff</code>创建一个<code class="codeph">Xdiff</code>实例文档。
                           </p>
                        </li>
                        <li>
                           <p>如果需要，应用程序可以将<code class="codeph">Xdiff</code>实例文档传递给<code class="codeph">XmlPatch</code> 。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">XmlPatch</code>可以将从比较中捕获的差异应用于应用程序指定的其他文档。
                           </p>
                        </li>
                     </ol>
                  </div>
               </div>
            </div><a id="ADXDK2510"></a><div class="props_rev_3"><a id="GUID-D25785EA-996A-44BE-ADF8-FF47DDD174E8" name="GUID-D25785EA-996A-44BE-ADF8-FF47DDD174E8"></a><h3 id="ADXDK-GUID-D25785EA-996A-44BE-ADF8-FF47DDD174E8" class="sect3">使用XmlDiff</h3>
               <div>
                  <p><code class="codeph">XmlDiff</code>比较代表两个输入文档的树，以确定它们的差异。两个输入文档都必须使用相同的字符集编码。<code class="codeph">Xdiff</code> （输出）实例文档具有与输入文档的数据编码（DOM编码）相同的编码。
                  </p>
               </div><a id="ADXDK19830"></a><div class="props_rev_3"><a id="GUID-21B69703-474D-4F5A-9804-DD67F1EBC279" name="GUID-21B69703-474D-4F5A-9804-DD67F1EBC279"></a><h4 id="ADXDK-GUID-21B69703-474D-4F5A-9804-DD67F1EBC279" class="sect4">比较优化的用户选项</h4>
                  <div>
                     <p>有两种可供比较的优化选项：全局和局部优化。</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>全局优化 - 默认</p>
                           <p>比较整个文档树。</p>
                        </li>
                        <li>
                           <p>本地优化</p>
                           <p>比较是在兄弟级别。局部优化比较来自两棵树的相应父母下的兄弟姐妹。</p>
                        </li>
                     </ul>
                     <p>全局优化可以为大型文档占用更多时间和空间，但总是产生最小的差异集（最佳差异）。局部优化要快得多，但可能无法产生最佳差异。</p>
                  </div>
               </div><a id="ADXDK19831"></a><div class="props_rev_3"><a id="GUID-CD4119E5-921E-498A-8F3F-3432D5CD08C8" name="GUID-CD4119E5-921E-498A-8F3F-3432D5CD08C8"></a><h4 id="ADXDK-GUID-CD4119E5-921E-498A-8F3F-3432D5CD08C8" class="sect4">哈希的用户选项</h4>
                  <div>
                     <p>散列通常会加速全局优化，但质量可能会很小。通过局部优化，散列可以提高差异输出的质量。使用不同的哈希级别可能会产生局部和全局差异。您可以为本地和全局优化指定散列的使用。</p>
                     <p>要指定散列，请提供<code class="codeph">hashLevel</code>参数。如果<code class="codeph">hashLevel</code>大于1，那么只有<code class="codeph">DOMHash</code>值用于比较<code class="codeph">depth &gt;= hashLevel</code> of difference的所有子树。如果散列值相等，则假定子树相等。
                     </p>
                  </div>
               </div><a id="ADXDK19832"></a><div class="props_rev_3"><a id="GUID-C427B536-D231-4214-A051-E32F24251A22" name="GUID-C427B536-D231-4214-A051-E32F24251A22"></a><h4 id="ADXDK-GUID-C427B536-D231-4214-A051-E32F24251A22" class="sect4">XmlDiff如何查看输入文档</h4>
                  <div>
                     <p>描述了<code class="codeph">XmlDiff</code>如何处理输入文档。
                     </p>
                     <p><code class="codeph">XmlDiff</code>在进行比较时忽略属性顺序的差异。
                     </p>
                     <p><code class="codeph">XmlDiff</code>忽略<code class="codeph">DocType</code>声明。不根据文档类型定义（DTD）验证文件。
                     </p>
                     <p>如果名称空间前缀引用相同的名称空间<code class="codeph">XmlDiff</code>资源标识符（URI），则<code class="codeph">XmlDiff</code>忽略名称空间前缀中的任何差异。否则，如果两个节点具有相同的本地名称和内容但名称空间URI不同，则会指示这些差异。
                     </p>
                     <div class="infoboxnote" id="GUID-C427B536-D231-4214-A051-E32F24251A22__GUID-50B88F23-AF51-4934-A31A-68E87E2DBFC2">
                        <p class="notep1">注意：</p>
                        <p><code class="codeph">XmlDiff</code>以非基于非标准的方式对其输入文档进行操作。它不以类型感知方式对元素或属性进行操作。
                        </p>
                     </div>
                  </div>
               </div><a id="ADXDK19833"></a><a id="ADXDK2540"></a><div class="props_rev_3"><a id="GUID-74C319A8-BE88-4200-AABC-FD153108D3F3" name="GUID-74C319A8-BE88-4200-AABC-FD153108D3F3"></a><h4 id="ADXDK-GUID-74C319A8-BE88-4200-AABC-FD153108D3F3" class="sect4">使用XmlDiff命令行实用程序</h4>
                  <div>
                     <p>描述了实用程序<code class="codeph">XmlDiff</code>的命令行选项。
                     </p>
                     <div class="section">
                        <div class="tblformal" id="GUID-74C319A8-BE88-4200-AABC-FD153108D3F3__BABJDEEA">
                           <p class="titleintable">表8-1 C语言的XmlDiff命令行选项</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="C语言的XmlDiff命令行选项" width="100%" border="1" summary="This table describes command-line options. Rows are XmlDiff command line options. The first column is the option name, the second column is its description." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="31%" id="d26881e776">选项</th>
                                    <th align="left" valign="bottom" width="69%" id="d26881e779">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d26881e784" headers="d26881e776 ">
                                       <p><code class="codeph">-e</code>编码</p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d26881e784 d26881e779 ">
                                       <p>指定默认输入文件编码。如果在XML文件中未指定编码，则假定此编码用于输入。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d26881e793" headers="d26881e776 ">
                                       <p><code class="codeph">-E</code>编码</p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d26881e793 d26881e779 ">
                                       <p>指定输出/数据编码。DOM和<code class="codeph">Xdiff</code>实例文档是在此编码中创建的。默认值是Unicode（UTF-8）的8位编码。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d26881e805" headers="d26881e776 ">
                                       <p><code class="codeph">-h</code> <code class="codeph">hash</code> L <code class="codeph">evel</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d26881e805 d26881e779 ">
                                       <p>指定哈希级别。 <code class="codeph">0</code>表示无。
                                       </p>
                                       <p>如果大于<code class="codeph">1</code> ，则为子树使用散列的起始深度。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d26881e827" headers="d26881e776 ">
                                       <p><code class="codeph">-G</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d26881e827 d26881e779 ">
                                       <p>设置全局优化（默认）。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d26881e835" headers="d26881e776 ">
                                       <p><code class="codeph">-l</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d26881e835 d26881e779 ">
                                       <p>设置本地优化。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d26881e843" headers="d26881e776 ">
                                       <p><code class="codeph">-p</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d26881e843 d26881e779 ">
                                       <p>显示此用法帮助。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d26881e851" headers="d26881e776 ">
                                       <p><code class="codeph">-u</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d26881e851 d26881e779 ">
                                       <p>禁用更新操作。</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADXDK19835"></a><a id="ADXDK19834"></a><div class="props_rev_3"><a id="GUID-3750C497-D76A-4F95-9DEB-BC047170FF14" name="GUID-3750C497-D76A-4F95-9DEB-BC047170FF14"></a><h4 id="ADXDK-GUID-3750C497-D76A-4F95-9DEB-BC047170FF14" class="sect4">样本输入文档</h4>
                  <div>
                     <p>提供了一个示例输入XML文档。</p>
                     <div class="section">
                        <p><a href="determining-XML-differences-using-C.html#GUID-3750C497-D76A-4F95-9DEB-BC047170FF14__BABBHCIA">示例8-1</a>是一个示例XML文档，您可以使用它来解释使用<code class="codeph">XmlDiff</code>和<code class="codeph">XmlPatch</code>所产生的更新。接下来是一些假设的变化。
                        </p>
                        <p>假设有另一个文件<code class="codeph">book2.xml</code> ，它看起来就像<a href="determining-XML-differences-using-C.html#GUID-3750C497-D76A-4F95-9DEB-BC047170FF14__BABBHCIA">例8-1，</a>除了它导致这些操作：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>删除“第十一诫”，一个<code class="codeph">delete-node</code>操作。
                              </p>
                           </li>
                           <li>
                              <p>将来自美国的“C ++ Primer”的国家/地区代码更改为US，这是一种<code class="codeph">update-node</code>操作。
                              </p>
                           </li>
                           <li>
                              <p>向“Emperor's New Mind”添加描述，这是一个<code class="codeph">append-node</code>操作。
                              </p>
                           </li>
                           <li>
                              <p>将版本添加到“晚间新闻”，即<code class="codeph">insert-node-before</code>操作。
                              </p>
                           </li>
                           <li>
                              <p>更新“晚间新闻”的价格，这是一个<code class="codeph">update-node</code>操作。
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-3750C497-D76A-4F95-9DEB-BC047170FF14__BABBHCIA">
                        <p class="titleinexample">例8-1 book1.xml</p><pre class="pre codeblock"><code>&lt;？xml版本=“1.0”？&gt; &lt;booklist xmlns =“http://booklist.oracle.com”&gt; &lt;book&gt; &lt;title&gt;十二只红鲱鱼&lt;/ title&gt; &lt;作者&gt; Jeffrey Archer &lt;/ author&gt; &lt;publisher&gt; Harper Collins &lt;/ publisher&gt; &lt;price &gt; 7.99 &lt;/ price&gt; &lt;/ book&gt; &lt;book&gt; &lt;title language =“English”&gt;第十一诫&lt;/ title&gt; &lt;author&gt; Jeffrey Archer &lt;/ author&gt; &lt;publisher&gt; McGraw Hill &lt;/ publisher&gt; &lt;price&gt; 3.99 &lt;/ price&gt; &lt;/ book&gt; &lt;book&gt; &lt;title language =“English”country =“USA”&gt; C ++ Primer &lt;/ title&gt; &lt;author&gt; Lippmann &lt;/ author&gt; &lt;publisher&gt; Harper Collins &lt;/ publisher&gt; &lt;price&gt; 4.99 &lt;/ price&gt; &lt;/ book&gt; &lt;book&gt; &lt;title&gt; Emperor's New Mind &lt;/ title&gt; &lt;author&gt; Roger Penrose &lt;/ author&gt; &lt;publisher&gt; Oxford Publishing Company &lt;/ publisher&gt; &lt;price&gt; 15.9 &lt;/ price&gt; &lt; / book&gt; &lt;book&gt; &lt;title&gt;晚间新闻&lt;/ title&gt; &lt;author&gt; Arthur Hailey &lt;/ author&gt; &lt;publisher&gt; MacMillan Publishers &lt;/ publisher&gt; &lt;price&gt; 9.99 &lt;/ price&gt; &lt;/ book&gt; &lt;/ booklist&gt;</code></pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADXDK19837"></a><a id="ADXDK19836"></a><div class="props_rev_3"><a id="GUID-F7B63052-2AC2-4E25-A50D-CF8F0F2ADCAB" name="GUID-F7B63052-2AC2-4E25-A50D-CF8F0F2ADCAB"></a><h4 id="ADXDK-GUID-F7B63052-2AC2-4E25-A50D-CF8F0F2ADCAB" class="sect4">示例Xdiff实例文档</h4>
                  <div>
                     <p>提供了示例<code class="codeph">Xdiff</code>实例文档。
                     </p>
                     <div class="section">
                        <p>本节显示通过比较上一节中描述的这两个XML文件生成的<code class="codeph">Xdiff</code>实例文档。以下各节介绍了XML处理说明和本文档的操作。
                        </p>
                        <p>您可以调用<code class="codeph">XmlDiff</code> ：</p><pre class="oac_no_warn" dir="ltr">&gt; xmldiff book1.xml book2.xml</pre><p>您还可以检查示例应用程序的参数和标志。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-F7B63052-2AC2-4E25-A50D-CF8F0F2ADCAB__GUID-911590D7-7364-4788-AFA0-233514ABBEF8">
                        <p class="titleinexample">示例8-2示例Xdiff实例文档</p><pre class="pre codeblock"><code>&lt;？xml version =“1.0”encoding =“UTF-8”？&gt; &lt;xd：xdiff xsi：schemaLocation =“http://xmlns.oracle.com/xdb/xdiff.xsd xmlns：xd =”http://xmlns.oracle.com/xdb/xdiff.xsd“xmlns：xsi = “http://www.w3.org/2001/XMLSchema-instance”xmlns：oraxdfns_0 =“http://booklist.oracle.com”&gt; <span class="bold">&lt;？oracle-xmldiff operations-in-docorder =“true”output-model =“snapshot”</span> <span class="bold">diff-algorithm =“global”？&gt;</span> &lt;xd：delete-node xd：node-type =“element”xd：xpath =“/ oraxdfns_0：booklist [1] / oraxdfns_0：book [2]”/&gt; &lt;xd：update-node xd：node-type = “attribute”xd：parent-xpath =“/ oraxdfns_0：booklist [1] / oraxdfns_0：book [3] / oraxdfns_0：title [1]”xd：attr-local =“country”&gt; &lt;xd：content&gt; US &lt;/ xd：content&gt; &lt;/ xd：update-node&gt; &lt;xd：append-node xd：node-type =“element”xd：parent-xpath =“/ oraxdfns_0：booklist [1] / oraxdfns_0：book [4]”&gt; &lt;xd：content&gt; &lt;oraxdfns_0：description&gt;这是经典的&lt;/ oraxdfns_0：description&gt; &lt;/ xd：content&gt; &lt;/ xd：append-node&gt; &lt;xd：insert-node-before xd：node-type =“element “xd：xpath =”/ oraxdfns_0：booklist [1] / oraxdfns_0：book [5] / oraxdfns_0：author [1]“&gt; &lt;xd：content&gt; &lt;oraxdfns_0：edition&gt; Hardcover &lt;/ oraxdfns_0：edition&gt; &lt;/ xd： content&gt; &lt;/ xd：insert-node-before&gt; &lt;xd：update-node xd：node-type =“text”xd：xpath =“/ oraxdfns_0：booklist [1] / oraxdfns_0：book [5] / oraxdfns_0：price [1] / text（）[1]“&gt; &lt;xd：content&gt; 12.99 &lt;/ xd：content&gt; &lt;/ xd：update-node&gt; &lt;/ xd：xdiff&gt;</code></pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADXDK19838"></a><div class="props_rev_3"><a id="GUID-707B667B-9A93-40E0-A109-1FE89C58BF47" name="GUID-707B667B-9A93-40E0-A109-1FE89C58BF47"></a><h4 id="ADXDK-GUID-707B667B-9A93-40E0-A109-1FE89C58BF47" class="sect4">输出模型和XML处理指令</h4>
                  <div>
                     <p><code class="codeph">Xdiff</code>实例文档使用一些XML处理指令（在上一节中以粗体显示），用于表示差异处理的某些方面。
                     </p>
                     <p>见<a href="determining-XML-differences-using-C.html#GUID-F795D8C3-DB9B-4617-B3B6-F66FB8F0BF94" title="提供了Xdiff XML模式，Xdiff实例文档（输出）遵循该模式。">Xdiff Schema</a> 。这些说明和相关选项包括：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">operations-in-docorder</code> ：选项是<code class="codeph">true</code>还是<code class="codeph">false</code> ：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><code class="codeph">true</code> - <code class="codeph">Xdiff</code>实例文档以与文档中相同的顺序引用第一个文档中的节点。
                                 </p>
                              </li>
                              <li>
                                 <p><code class="codeph">false</code> - <code class="codeph">Xdiff</code>实例文档未按文档中的顺序引用第一个文档中的节点。
                                 </p>
                              </li>
                           </ul>
                           <p>全局优化的输出满足<code class="codeph">operations-in-docorder</code>的<code class="codeph">operations-in-docorder</code>要求，但本地优化不符合。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">output-model</code> ：选项包括：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><code class="codeph">snapshot</code> - <code class="codeph">Xmldiff</code>在快照模型中生成输出，并遵循UNIX <span class="italic">diff</span>模型。每个操作都使用<code class="codeph">XPath</code> ，就好像没有对输入文档应用任何操作一样。这是默认值。仅当<code class="codeph">operations-in-docorder</code>设置为<code class="codeph">true</code>且<code class="codeph">XPath</code>很简单时， <code class="codeph">XmlPatch</code>才能处理此模型。简单的<code class="codeph">XPath</code>需要子轴，没有通配符，并且必须使用位置谓词，例如<code class="codeph">/root[1]/child[2]/text()[2]</code> 。
                                 </p>
                              </li>
                              <li>
                                 <p><code class="codeph">current</code> -Each操作使用<code class="codeph">XPath</code> ，就好像所有前一个操作都已应用于输入文档一样。尽管<code class="codeph">XmlDiff</code>在当前模型中不会产生差异，但<code class="codeph">XmlPatch</code>可以在当前模型中处理手工制作的<code class="codeph">diff</code>文档</p>
                              </li>
                           </ul>
                        </li>
                        <li>
                           <p><code class="codeph">diff-algorithm</code> ：选项指示产生差异的优化。
                           </p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>全局优化</p>
                              </li>
                              <li>
                                 <p>局部优化</p>
                              </li>
                           </ul>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="determining-XML-differences-using-C.html#GUID-21B69703-474D-4F5A-9804-DD67F1EBC279" title="有两种可供比较的优化选项：全局和局部优化。">比较优化的用户选项</a></li>
                        </ul>
                     </div>
                  </div>
                  
               </div><a id="ADXDK1042"></a><a id="ADXDK19839"></a><div class="props_rev_3"><a id="GUID-BBB028EC-736C-4F02-B330-75A03B96C1E6" name="GUID-BBB028EC-736C-4F02-B330-75A03B96C1E6"></a><h4 id="ADXDK-GUID-BBB028EC-736C-4F02-B330-75A03B96C1E6" class="sect4">Xdiff操作</h4>
                  <div>
                     <p><code class="codeph">XmlDiff</code>使用<code class="codeph">Xdiff</code>实例文档指示的操作捕获差异。描述了<code class="codeph">XmlDiff</code>操作。
                     </p>
                     <div class="tblformal" id="GUID-BBB028EC-736C-4F02-B330-75A03B96C1E6__GUID-F418F0B5-0171-45B7-91C2-43BD5FDA9ABD">
                        <p class="titleintable">表8-2 Xdiff操作属性</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="Xdiff操作属性" width="100%" border="1" summary="Lists and describes the attributes of an Xdiff operation." frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="31%" id="d26881e1409">属性</th>
                                 <th align="left" valign="bottom" width="69%" id="d26881e1412">描述</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d26881e1417" headers="d26881e1409 ">
                                    <p><code class="codeph">parent-path</code>或<code class="codeph">xpath</code></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d26881e1417 d26881e1412 ">
                                    <p>指定<code class="codeph">XPATH</code>操作数节点或父节点的位置<code class="codeph">XPATH</code>节点的位置。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d26881e1434" headers="d26881e1409 ">
                                    <p><code class="codeph">节点型</code></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d26881e1434 d26881e1412 ">
                                    <p>指定操作数节点的类型。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d26881e1442" headers="d26881e1409 ">
                                    <p><code class="codeph">内容</code></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d26881e1442 d26881e1412 ">
                                    <p>子元素，指定附加或插入的新子树或值。</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p><code class="codeph">Xdiff</code>实例文档中提供的<code class="codeph">Xdiff</code>操作是：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">append-node</code> ：</p>
                           <p><code class="codeph">append-node</code>元素指定将给定类型的节点添加为给定父节点的最后一个子节点。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">insert-node-before</code> ：</p>
                           <p><code class="codeph">insert-node-before</code>元素指定在给定的引用节点之前插入给定类型的节点。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">delete-node</code> ：</p>
                           <p><code class="codeph">delete-node</code>元素指定<code class="codeph">delete-node</code>及其所有子节点。您可以使用此元素删除元素，注释等。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">update-node</code> ：</p>
                           <p><code class="codeph">update-node</code>指定与具有给定<code class="codeph">XPath</code>表达式的节点关联的值更新为指定的新值。内容是文本节点的值。属性的值是属性节点的值。
                           </p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>更新文本节点：</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p>用户可以关闭更新节点操作的生成。</p>
                                    </li>
                                    <li>
                                       <p>属性的值是属性节点的值。</p>
                                    </li>
                                    <li>
                                       <p>仅通过全局优化为文本节点生成<code class="codeph">update-node</code> 。
                                       </p>
                                    </li>
                                 </ul>
                              </li>
                              <li>
                                 <p>元素更新：</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p><code class="codeph">XmlDiff</code>不会为元素节点生成更新操作。
                                       </p>
                                       <p>您可以手动修改<code class="codeph">Xdiff</code>实例文档以创建适用于<code class="codeph">XmlPatch</code>的更新操作，也可以提供完全手写的<code class="codeph">Xdiff</code>实例文档。更新操作的元素的所有子项都将被删除。将导入在内容节点下指定的任何新子树。
                                       </p>
                                    </li>
                                 </ul>
                              </li>
                           </ul>
                        </li>
                     </ul>
                  </div>
               </div><a id="ADXDK19840"></a><div class="props_rev_3"><a id="GUID-4BF58AA7-A438-4663-9483-2DEAAC908885" name="GUID-4BF58AA7-A438-4663-9483-2DEAAC908885"></a><h4 id="ADXDK-GUID-4BF58AA7-A438-4663-9483-2DEAAC908885" class="sect4">Xdiff实例文档的格式</h4>
                  <div>
                     <p><code class="codeph">Xdiff</code>实例文档<code class="codeph">XmlDiff</code>的输出是符合<code class="codeph">Xdiff</code> XML模式的XML文档。输出文档包含一系列描述两个输入文档之间差异的操作。如果将差异应用于第一个文档，则会获得第二个文档。
                     </p>
                  </div>
               </div><a id="ADXDK19842"></a><a id="ADXDK19841"></a><div class="props_rev_3"><a id="GUID-F795D8C3-DB9B-4617-B3B6-F66FB8F0BF94" name="GUID-F795D8C3-DB9B-4617-B3B6-F66FB8F0BF94"></a><h4 id="ADXDK-GUID-F795D8C3-DB9B-4617-B3B6-F66FB8F0BF94" class="sect4">Xdiff Schema</h4>
                  <div>
                     <p>提供了<code class="codeph">Xdiff</code> XML模式， <code class="codeph">Xdiff</code>实例文档（输出）遵循该模式。
                     </p>
                     <div class="example" id="GUID-F795D8C3-DB9B-4617-B3B6-F66FB8F0BF94__BABJEFEE">
                        <p class="titleinexample">例8-3 Xdiff模式：xdiff.xsd</p><pre class="pre codeblock"><code>&lt;schema targetNamespace =“http://xmlns.oracle.com/xdb/xdiff.xsd”xmlns =“http://www.w3.org/2001/XMLSchema”xmlns：xd =“http://xmlns.oracle .com / xdb / xdiff.xsd“version =”1.0“elementFormDefault =”qualified“attributeFormDefault =”qualified“&gt; &lt;annotation&gt; &lt;documentation xml：lang =”en“&gt;定义捕获两者之间差异的XML文档的结构XML文档。Oracle XmlDiff不支持的更改可能无法在此架构中表达。Xdiff文档中的'oracle-xmldiff'PI：我们使用'oracle-xmldiff'PI来描述diff的某些方面。PI表示“在docorder中运行”和“输出模型”的值。XmlDiff的输出总是有PI。如果用户对diff文档进行手工编码，那么它也必须将PI作为顶级xdiff元素的第一个子元素，以便能够调用XmlPatch。operations-in-docorder：可以是'true'或'false'。如果为true，则diff文档中的操作以与文档顺序相同的顺序引用输入文档的元素。全局算法的输出满足此要求，而本地算法则不满足。output-model：表示diff的输出模型。可以是“快照”或“当前”。快照模型：每个操作都使用Xpath，就好像没有对输入文档应用任何操作一样。 （如UNIX diff）这是XmlDiff输出中使用的模型。XmlPatch适用于此（以及当前模型）。要使XmlPatch处理此模型，“operations-in-docorder”必须为true且Xpath必须简单。 （请参阅XmlDif C API文档）。当前模型：每个操作都使用Xpath，就好像前一个操作都已应用于输入文档一样。即使不满足'operations-in-docorder'标准且xpath不简单，也可以使用XmlPatch。&lt;！ - 示例：&lt;？oracle-xmldiff operations-in-docorder =“true”output-model =“snapshot”diff-algorithm =“global”？&gt;  - &gt; &lt;/ documentation&gt; &lt;/ annotation&gt; &lt;！ - 枚举支持的节点类型 - &gt; &lt;simpleType name =“xdiff-nodetype”&gt; &lt;restriction base =“string”&gt; &lt;enumeration value =“element”/ &gt; &lt;enumeration value =“attribute”/&gt; &lt;enumeration value =“text”/&gt; &lt;enumeration value =“cdata”/&gt; &lt;enumeration value =“entity-reference”/&gt; &lt;enumeration value =“entity”/&gt; &lt;enumeration value =“processing-instruction”/&gt; &lt;enumeration value =“notation”/&gt; &lt;enumeration value =“comment”/&gt; &lt;/ restriction&gt; &lt;/ simpleType&gt; &lt;element name =“xdiff”&gt; &lt;complexType&gt; &lt;choice minOccurs = “0”maxOccurs =“unbounded”&gt; &lt;element name =“append-node”&gt; &lt;complexType&gt; &lt;sequence&gt; &lt;element name =“content”type =“anyType”/&gt; &lt;/ sequence&gt; &lt;attribute name =“node- type“type =”xd：xdiff-nodetype“/&gt; &lt;attribute name =”xpath“type =”string“/&gt; &lt;attribute name =”parent-xpath“type =”string“/&gt; &lt;attribute name =”attr- local“type =”string“/&gt; &lt;attribute name =”attr-nsuri“type =”string“/&gt; &lt;/ complexType&gt; &lt;/ element&gt; &lt;element name =”insert-node-before“&gt; &lt;complexType&gt; &lt;sequence &gt; &lt;element name =“cont ent“type =”anyType“/&gt; &lt;/ sequence&gt; &lt;attribute name =”xpath“type =”string“/&gt; &lt;attribute name =”node-type“type =”xd：xdiff-nodetype“/&gt; &lt;/ complexType &gt; &lt;/ element&gt; &lt;element name =“delete-node”&gt; &lt;complexType&gt; &lt;attribute name =“node-type”type =“xd：xdiff-nodetype”/&gt; &lt;attribute name =“xpath”type =“string” /&gt; &lt;attribute name =“parent-xpath”type =“string”/&gt; &lt;attribute name =“attr-local”type =“string”/&gt; &lt;attribute name =“attr-nsuri”type =“string”/&gt; &lt;/ complexType&gt; &lt;/ element&gt; &lt;element name =“update-node”&gt; &lt;complexType&gt; &lt;sequence&gt; &lt;element name =“content”type =“anyType”/&gt; &lt;/ sequence&gt; &lt;attribute name =“node-type “type =”xd：xdiff-nodetype“/&gt; &lt;attribute name =”parent-xpath“type =”string“/&gt; &lt;attribute name =”xpath“type =”string“/&gt; &lt;attribute name =”attr-local “type =”string“/&gt; &lt;attribute name =”attr-nsuri“type =”string“/&gt; &lt;/ complexType&gt; &lt;/ element&gt; &lt;element name =”rename-node“&gt; &lt;complexType&gt; &lt;sequence&gt; &lt;element name =“content”type =“anyType”/&gt; &lt;/ sequence&gt; &lt;attribute name =“xpath”type =“string”/&gt; &lt;attribute name =“node-type”type =“xd：xdiff-nodetype”/&gt; &lt;/ complexType&gt; &lt;/ element&gt; &lt;/ choice&gt; &lt;attribute name =“xdiff-version”type =“string”/&gt; &lt;/ complexType&gt; &lt;/ element&gt; &lt;/ schema&gt;</code></pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADXDK19844"></a><a id="ADXDK19843"></a><div class="props_rev_3"><a id="GUID-A210D2A4-B291-4BA5-AA43-2FC2F1DE180D" name="GUID-A210D2A4-B291-4BA5-AA43-2FC2F1DE180D"></a><h4 id="ADXDK-GUID-A210D2A4-B291-4BA5-AA43-2FC2F1DE180D" class="sect4">在应用程序中使用XMLDiff</h4>
                  <div>
                     <p>在应用程序中， <code class="codeph">XmlDiff</code>将输入文档的源类型和位置作为参数。源类型可以是URL，文件， <code class="codeph">orastream</code>和<code class="codeph">stream</code>上下文指针，缓冲区和缓冲区<code class="codeph">buffer_length</code>指针或指向DOM文档元素（ <code class="codeph">docelement</code> ）的指针。
                     </p>
                     <p><code class="codeph">XmlDiff</code>返回<code class="codeph">Xdiff</code>实例文档的DOM的文档节点。
                     </p>
                     <p>在执行比较之前，XmlDiff为两个文档构建DOM（如果它们尚未作为DOM提供）。</p>
                     <div class="infoboxnotealso" id="GUID-A210D2A4-B291-4BA5-AA43-2FC2F1DE180D__GUID-C52B078B-71D7-45E8-9C6E-172FC550B25B">
                        <p class="notep1">也可以看看：</p>
                        <p>用于控制<code class="codeph">XmlDiff</code>行为的标志的C API的<a href="../caxml/package-XmlDiff-API.html#CAXML6192" target="_blank"><span><cite>Oracle数据库XML C API参考</cite></span></a></p>
                     </div>
                     <div class="example" id="GUID-A210D2A4-B291-4BA5-AA43-2FC2F1DE180D__GUID-9D8E4169-0CD1-401C-A097-F0F9D7B70077">
                        <p class="titleinexample">例8-4 XMLDiff应用程序</p><pre class="oac_no_warn" dir="ltr">#include &lt;xmldf.h&gt; ...xmlctx * xctx; xmldocnode * doc1，* doc2，* doc3; uword hash_level; oratext * s，* inp1 =“book1.xml”，* inp2 =“book2.xml”; xmlerr错误; ub4标志; flags = 0; / * defaults：global algorithm * / hash_level = 0; / * no hashing * / / *创建XML元上下文* / if（！（xctx = XmlCreate（＆err，（oratext *）“XmlDiff”，NULL）））{printf（“无法创建XML上下文，错误％u \ n”，（unsigned）错误）; err_exit（ “退出”）; } / *加载两个输入文件* / if（！（doc1 = XmlLoadDom（xctx，＆err，“file”，inp1，“discard_whitespace”，TRUE，NULL）））{printf（“解析第一个文件失败，错误％u \ n”，（无符号）错误）; err_exit（（oratext *）“退出。”）; if（！（doc2 = XmlLoadDom（xctx，＆err，“file”，inp2，“discard_whitespace”，TRUE，NULL）））{printf（“解析第二个文件失败，错误％u \ n”，（unsigned）错误）; err_exit（（oratext *）“退出。”）; } / *在DOM树上运行XmlDiff。* / doc3 = XmlDiff（xctx，＆err，flags，XMLDF_SRCT_DOM，doc1，NULL，XMLDF_SRCT_DOM，doc2，NULL，hash_level，NULL）;如果（！doc3）printf（“XmlDiff失败，错误％u \ n”，（无符号）错误）;别的{if（错！= XMLERR_OK）printf（“XmlDiff返回错误％u \ n”，（unsigned）错误）; / *现在我们在doc3中有DOM树，代表Diff * / ...XmlFreeDocument（xctx，doc1）; XmlFreeDocument（xctx，doc2）; XmlFreeDocument（xctx，doc3）; XmlDestroy（xctx）;</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADXDK19846"></a><a id="ADXDK19845"></a><div class="props_rev_3"><a id="GUID-CB4DB221-21E5-4E33-98CC-9E07C28567C0" name="GUID-CB4DB221-21E5-4E33-98CC-9E07C28567C0"></a><h4 id="ADXDK-GUID-CB4DB221-21E5-4E33-98CC-9E07C28567C0" class="sect4">定制输出</h4>
                  <div>
                     <p>自定义输出构建器以适合应用程序的任何格式存储差异。您可以创建自己的自定义输出构建器，而不是使用默认的<code class="codeph">Xdiff</code>实例文档，该文档由<code class="codeph">XmlDiff</code>生成并符合<code class="codeph">Xdiff</code>模式。
                     </p>
                     <p>要创建自定义输出构建器，必须提供可在<code class="codeph">XmlDiff</code>确定差异后调用的回调。差异作为<code class="codeph">xmdlfop</code>数组传递给回调。在生成差异时，可以多次调用回调。
                     </p>
                     <p>使用自定义输出构建器可能比使用默认值更好，因为它不必维护<code class="codeph">XPath</code>生成所需的内部状态。
                     </p>
                     <p>默认情况下， <code class="codeph">XmlDiff</code>捕获符合<code class="codeph">Xdiff</code>模式的XML差异。如有必要，请插入您自己的输出构建器。差异表示为数组<code class="codeph">xmldfop</code> 。您必须编写输出构建器回调函数。功能签名是：</p><pre class="oac_no_warn" dir="ltr">xmlerr（* xdfobcb）（void * uctx，xmldfop * escript，ub4 escript_siz）;</pre><p><code class="codeph">uctx</code>是用户特定的上下文。
                     </p>
                     <p><code class="codeph">escript</code>是大小<code class="codeph">escript_siz</code>的数组：</p><pre class="oac_no_warn" dir="ltr"><code class="codeph">的diff [escript_siz]</code>
</pre><p><code class="codeph">mctx</code>是内存上下文。
                     </p>
                     <p>通过属性向<code class="codeph">XmlDiff()</code>提供此内存上下文。使用此内存上下文分配<code class="codeph">escript</code> 。你必须稍后释放<code class="codeph">escript</code> 。
                     </p>
                     <p>在找到差异之后调用输出构建器回调，甚至在调用<code class="codeph">XmlDiff()</code>之前就会发生这种回调。可以多次调用输出构建器回调。
                     </p>
                     <div class="example" id="GUID-CB4DB221-21E5-4E33-98CC-9E07C28567C0__GUID-C4B6D5C8-4448-4073-84FD-272679581F03">
                        <p class="titleinexample">示例8-5自定义XMLDiff输出</p><pre class="oac_no_warn" dir="ltr">/ *样品用量：* / ...#include &lt;orastruc.h&gt; / * for'oraprop'* / ...static oraprop diff_props [] = {ORAPROP（XMLDF_PROPN_CUSTOM_OB，XMLDF_PROPI_CUSTOM_OB，POINTER），ORAPROP（XMLDF_PROPN_CUSTOM_OBMCX，XMLDF_PROPI_CUSTOM_OBMCX，POINTER），ORAPROP（XMLDF_PROPN_CUSTOM_OBUCX，XMLDF_PROPI_CUSTOM_OBUCX，POINTER），{NULL}}; ...oramemctx * mymemctx; ...xmlerr myob（void * uctx，xmldfop * escript，ub4 escript_siz）{/ *进程差异在escript * / / * free escript中可用 - 调用者必须这样做* / OraMemFree（mymemctx，escript）; } main（）{...myctxt * myctx; diff_props [0] .value_oraprop.p_oraprop_v = myob; diff_props [1] .value_oraprop.p_oraprop_v = mymemctx; diff_props [2] .value_oraprop.p_oraprop_v = myctx; XmlDiff（xctx，＆err，0，doc1，NULL，0，doc2，NULL，0，diff_props）; ...
 </pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
            </div><a id="ADXDK2520"></a><div class="props_rev_3"><a id="GUID-45E03E82-7DE3-49C3-A29A-8AC3091566EE" name="GUID-45E03E82-7DE3-49C3-A29A-8AC3091566EE"></a><h3 id="ADXDK-GUID-45E03E82-7DE3-49C3-A29A-8AC3091566EE" class="sect3">使用XmlPatch</h3>
               <div>
                  <p><code class="codeph">XmlPatch</code>接受一个<code class="codeph">Xdiff</code>实例文档，所产生<code class="codeph">XmlDiff</code>或通过其他机制创建的，并遵循中的说明<code class="codeph">Xdiff</code>实例文档修改其他XML文档。
                  </p>
                  <div class="section"></div>
                  <!-- class="section" -->
               </div><a id="ADXDK19847"></a><a id="ADXDK2550"></a><div class="props_rev_3"><a id="GUID-2218E811-A238-4942-A4BF-BE4763ECA2CA" name="GUID-2218E811-A238-4942-A4BF-BE4763ECA2CA"></a><h4 id="ADXDK-GUID-2218E811-A238-4942-A4BF-BE4763ECA2CA" class="sect4">使用XmlPatch命令行实用程序</h4>
                  <div>
                     <p>描述了实用程序<code class="codeph">XmlPatch</code>命令行选项。
                     </p>
                     <div class="section">
                        <div class="tblformal" id="GUID-2218E811-A238-4942-A4BF-BE4763ECA2CA__BABFFEGF">
                           <p class="titleintable">表8-3 C命令行选项的XmlPatch</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="用于C命令行选项的XmlPatch" width="100%" border="1" summary="This table describes the XmlPatch command-line options. Rows are XmlPatch command line options. First column is option name, second column is description." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="31%" id="d26881e2185">选项</th>
                                    <th align="left" valign="bottom" width="69%" id="d26881e2188">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d26881e2193" headers="d26881e2185 ">
                                       <p><code class="codeph">-e</code>编码</p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d26881e2193 d26881e2188 ">
                                       <p>指定默认输入文件编码。如果在XML文件中未指定编码，则假定此编码用于输入。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d26881e2202" headers="d26881e2185 ">
                                       <p><code class="codeph">-E</code>编码</p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d26881e2202 d26881e2188 ">
                                       <p>指定输出/数据编码。在此编码中创建DOM和修补文档。默认值为UTF-8。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d26881e2211" headers="d26881e2185 ">
                                       <p><code class="codeph">-一世</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d26881e2211 d26881e2188 ">
                                       <p>将文件名解释为URL。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d26881e2219" headers="d26881e2185 ">
                                       <p><code class="codeph">-H</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d26881e2219 d26881e2188 ">
                                       <p>显示此用法帮助。</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADXDK19849"></a><a id="ADXDK19848"></a><div class="props_rev_3"><a id="GUID-7C4C7410-A8FA-4EE7-9996-31799450485E" name="GUID-7C4C7410-A8FA-4EE7-9996-31799450485E"></a><h4 id="ADXDK-GUID-7C4C7410-A8FA-4EE7-9996-31799450485E" class="sect4">在应用程序中使用XmlPatch</h4>
                  <div>
                     <p><code class="codeph">XmlPatch</code>将输入文档和<code class="codeph">diff</code>文档的源类型和位置作为参数。源类型可以是URL，文件， <code class="codeph">orastream</code>和<code class="codeph">stream</code>上下文指针，缓冲区和缓冲区<code class="codeph">buffer_length</code>指针，或指向DOM文档元素（ <code class="codeph">docelement</code> ）的指针。
                     </p>
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-7C4C7410-A8FA-4EE7-9996-31799450485E__GUID-07697ED1-8946-4A67-AD05-5087FFF23257">
                           <p class="notep1">也可以看看：</p>
                           <p>用于控制<code class="codeph">XmlPatch</code>行为的标志的C API的<a href="../caxml/package-XmlDiff-API.html#CAXML6201" target="_blank"><span><cite>Oracle Database XML C API参考</cite></span></a></p>
                        </div>
                        <p><code class="codeph">Xdiff</code>模式设置的模式会影响<code class="codeph">XmlPatch</code>工作方式。
                        </p>
                        <p>如果<code class="codeph">output-model</code>是<code class="codeph">Snapshot</code> ， <code class="codeph">XmlPatch</code>只有<code class="codeph">operations-in-docorder</code>为<code class="codeph">TRUE</code> ， <code class="codeph">XmlPatch</code>才有效。</p>
                        <p>如果<code class="codeph">output-model</code>为<code class="codeph">Current</code> ，则无需将<code class="codeph">operations-in-docorder</code>设置为<code class="codeph">TRUE</code> 。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-7C4C7410-A8FA-4EE7-9996-31799450485E__GUID-A71CE5FF-ADAC-457C-A02D-401ABE25AE8E">
                        <p class="titleinexample">示例8-6 XmlPatch的示例应用程序</p><pre class="oac_no_warn" dir="ltr">...#include &lt;xmldf.h&gt; ...xmlctx * xctx; xmldocnode * doc1，* doc2; oratext * s; oratext * inp1 =“book1.xml”; / *输入文件* / oratext * inp2 =“diff.xml”，/ * diff document * / xmlerr err; / *创建XML元上下文* / if（！（xctx = XmlCreate（＆err，（oratext *）“XmlPatch”，NULL）））{printf（“无法创建XML上下文，错误％u \ n”，（unsigned）错误）; err_exit（ “退出”）; } / *加载两个输入文件* / if（！（doc1 = XmlLoadDom（xctx，＆err，“file”，inp1，“discard_whitespace”，TRUE，NULL）））{printf（“解析第一个文件失败，错误％u \ n”，（无符号）错误）; err_exit（（oratext *）“退出。”）; if（！（doc2 = XmlLoadDom（xctx，＆err，“file”，inp2，“discard_whitespace”，TRUE，NULL）））{printf（“解析第二个文件失败，错误％u \ n”，（unsigned）错误）; err_exit（（oratext *）“退出。”）; } / *调用XmlPatch * / if（！XmlPatch（xctx，＆err，0，XMLDF_SRCT_DOM，doc1，NULL，XMLDF_SRCT_DOM，doc2，NULL，NULL））; printf（“XmlPatch失败，错误％u \ n”，（无符号）错误）;别的{if（错！= XMLERR_OK）printf（“XmlPatch返回错误％u \ n”，（unsigned）错误）; / *现在我们在doc1 * /中有修补过的文件XmlFreeDocument（xctx，doc1）; XmlFreeDocument（xctx，doc2）; XmlDestroy（xctx）;</pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
            </div><a id="ADXDK19850"></a><a id="ADXDK2530"></a><div class="props_rev_3"><a id="GUID-C0215942-5C76-4B9F-9ECC-B79F48F4F8EF" name="GUID-C0215942-5C76-4B9F-9ECC-B79F48F4F8EF"></a><h3 id="ADXDK-GUID-C0215942-5C76-4B9F-9ECC-B79F48F4F8EF" class="sect3">使用XmlHash</h3>
               <div>
                  <p><code class="codeph">XmlHash</code>计算XML树的哈希值。如果两个树的哈希值相等，则它们可能是相同的XML。您可以使用<code class="codeph">XmlHash</code>进行快速比较，以查看XML树是否已存在于数据库中。
                  </p>
                  <div class="section">
                     <p>如有必要，您可以在任何匹配<code class="codeph">XmlDiff</code>再次运行<code class="codeph">XmlDiff</code> ，以确保匹配。您可以计算新文档的哈希值并查询数据库。
                     </p>
                     <p><a href="determining-XML-differences-using-C.html#GUID-C0215942-5C76-4B9F-9ECC-B79F48F4F8EF__BABDABHF">例8-7</a>显示了一个使用<code class="codeph">XmlHash</code>的示例程序。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-C0215942-5C76-4B9F-9ECC-B79F48F4F8EF__BABDABHF">
                     <p class="titleinexample">例8-7 XmlHash程序</p><pre class="pre codeblock"><code>剑主（剑argc，char * argv []）{xmlctx * xctx; xmldfsrct srct; oratext * data_encoding，* input_encoding，* s，* inp1; ub1标志; xmlerr错误; ub4 num_args; xmlhasht摘要; flags = 0; / * defaults * / srct = XMLDF_SRCT_FILE; inp1 =“somexml.xml”; xctx = XmlCreate（＆err，（oratext *）“XmlHash”，NULL）;如果（！xctx）{/ *处理错误，创建xml上下文并退出* / ...运行XmlHash * / err = XmlHash（xctx，＆digest，0，srct，inp1，NULL，NULL）; if（err）printf（“XmlHash返回错误：％d \ n”，错误）;否则txdfha_pd（摘要）; XmlDestroy（xctx）;返回（剑）错误; / * * xml哈希中的打印字节* / static void txdfha_pd（xmlhasht digest）{ub4 i; for（i = 0; i &lt;digest.l_xmlhasht; i ++）printf（“％x”，digest.d_xmlhasht [i]）;的printf（ “\ n”）; }</code></pre></div>
                  <!-- class="example" -->
               </div><a id="ADXDK19851"></a><div class="props_rev_3"><a id="GUID-6DE2C17C-A24B-428D-9BED-9A6FC9E52390" name="GUID-6DE2C17C-A24B-428D-9BED-9A6FC9E52390"></a><h4 id="ADXDK-GUID-6DE2C17C-A24B-428D-9BED-9A6FC9E52390" class="sect4">调用XmlDiff和XmlPatch</h4>
                  <div>
                     <p><code class="codeph">XmlDiff</code>和<code class="codeph">XmlPatch</code>可以作为命令行工具和C语言调用。它们也可用作SQL函数。
                     </p>
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-6DE2C17C-A24B-428D-9BED-9A6FC9E52390__GUID-88A4522A-6FF1-4A9D-8643-E5D42F877A9D">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><a href="../sqlrf/XMLDIFF.html#SQLRF20025" target="_blank"><span><cite>Oracle数据库SQL语言参考</cite></span></a> <code class="codeph">XMLDiff</code></p>
                              </li>
                              <li>
                                 <p><a href="../sqlrf/XMLPATCH.html#SQLRF20026" target="_blank"><span><cite>Oracle数据库SQL语言参考</cite></span></a> ， <code class="codeph">XMLPatch</code></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>