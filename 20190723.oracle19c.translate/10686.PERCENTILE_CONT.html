<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>PERCENTILE_CONT</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="SQL Language Reference "></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="SQL Language Reference"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="sql-language-reference.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-02-12T15:36:36-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96310-02"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="PERCENT_RANK.html" title="Previous" type="text/html"></link>
      <link rel="next" href="PERCENTILE_DISC.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="SQL Language Reference"></meta>
    <meta name="dcterms.isVersionOf" content="SQLRF"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="PERCENT_RANK.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="PERCENTILE_DISC.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">SQL语言参考</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="Functions.html" property="item" typeof="WebPage"><span property="name">功能</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">PERCENTILE_CONT</li>
            </ol>
            <a id="GUID-CA259452-A565-41B3-A4F4-DD74B66CEDE0" name="GUID-CA259452-A565-41B3-A4F4-DD74B66CEDE0"></a><a id="SQLRF51606"></a><a id="SQLRF51607"></a><a id="SQLRF51608"></a><a id="SQLRF51609"></a><a id="SQLRF00687"></a>
            
            <h2 id="SQLRF-GUID-CA259452-A565-41B3-A4F4-DD74B66CEDE0" class="sect2">PERCENTILE_CONT</h2>
         </header>
         <div class="ind">
            <div>
               <div class="section">
                  <p class="subhead1" id="GUID-CA259452-A565-41B3-A4F4-DD74B66CEDE0__GUID-7E11D28D-71DB-44AE-808F-77BF59E8EBBB">句法</p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <div class="figure" id="GUID-CA259452-A565-41B3-A4F4-DD74B66CEDE0__GUID-A3E806CF-6F0F-48C8-ABF3-E3220AD8791E"><img src="img/percentile_cont.gif" alt="下面是percentile_cont.eps的描述" title="下面是percentile_cont.eps的描述" longdesc="img_text/percentile_cont.html"><br><a href="img_text/percentile_cont.html">插图描述percentile_cont.eps</a></div>
                  <!-- class="figure" -->
                  <div class="infoboxnotealso" id="GUID-CA259452-A565-41B3-A4F4-DD74B66CEDE0__GUID-5EB9D19A-B821-4C83-B4D3-4E256EACCA31">
                     <p class="notep1">也可以看看：</p>
                     <p><span class="q">“ <a href="Analytic-Functions.html#GUID-527832F7-63C0-4445-8C16-307FA5084056">分析函数</a> ”，</span>用于获取有关<code class="codeph">OVER</code>子句的语法，语义和限制的信息</p>
                  </div>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-CA259452-A565-41B3-A4F4-DD74B66CEDE0__GUID-919133EC-7490-4A17-819A-5F657E7D9A47">目的</p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p><code class="codeph">PERCENTILE_CONT</code>是一个逆分布函数，它假设一个连续的分布模型。它采用百分位值和排序规范，并返回一个内插值，该值将根据排序规范落入该百分位数值。在计算中忽略空值。
                  </p>
                  <p>此函数将任何数值数据类型或任何可以隐式转换为数字数据类型的非数字数据类型作为参数。该函数返回与参数的数值数据类型相同的数据类型。</p>
                  <div class="infoboxnotealso" id="GUID-CA259452-A565-41B3-A4F4-DD74B66CEDE0__GUID-3817BC30-728E-4F69-9535-66116EAA0E29">
                     <p class="notep1">也可以看看：</p>
                     <p>有关隐式转换的更多信息，请<a href="Data-Type-Comparison-Rules.html#GUID-98BE3A78-6E33-4181-B5CB-D96FD9DC1694__G195937" title="此矩阵列出了每个后续列的第一列和标题单元格中的数据类型。单元格中的X表示在该列的标题和该行的第1列中指定的数据类型的隐式转换。">参见表2-8</a></p>
                  </div>
                  <p>第一个<span class="italic"><code class="codeph">expr</code></span>必须求值为0到1之间的数值，因为它是百分位值。此<span class="italic"><code class="codeph">expr</code></span>在每个聚合组中必须是常量。<code class="codeph">ORDER</code> <code class="codeph">BY</code>子句采用必须是数字或日期时间值的单个表达式，因为这些是Oracle可以执行插值的类型。
                  </p>
                  <p><code class="codeph">PERCENTILE_CONT</code>的结果是在排序后通过值之间的线性插值计算的。使用聚合组中的百分位值（P）和行数（N），可以在根据排序规范对行进行排序后计算您感兴趣的行号。根据公式<code class="codeph">RN</code> <code class="codeph">=</code> <code class="codeph">(1+(P*(N-1))</code>计算该行号（RN <code class="codeph">(1+(P*(N-1))</code> 。通过行号<code class="codeph">CRN</code> <code class="codeph">=</code> <code class="codeph">CEILING(RN)</code>和<code class="codeph">FRN</code> <code class="codeph">=</code> <code class="codeph">FLOOR(RN)</code>行之间的线性插值来计算聚合函数的最终结果。
                  </p>
                  <p>最终结果将是：</p><pre class="oac_no_warn" dir="ltr">如果（CRN = FRN = RN）则结果是（来自RN的行的表达式的值）否则结果是（CRN-RN）*（FRN处的行的表达式的值）+（RN-FRN）*（的值） CRN行的表达式）</pre><p>您可以使用<code class="codeph">PERCENTILE_CONT</code>函数作为分析函数。您只能在其<code class="codeph">OVER</code>子句中指定<span class="italic"><code class="codeph">query_partitioning_clause</code></span> 。它为每一行返回在每个分区中的一组值中落入指定百分位数的值。
                  </p>
                  <p><code class="codeph">MEDIAN</code>函数是<code class="codeph">PERCENTILE_CONT</code>的特定情况，其中百分位数值默认为0.5。有关更多信息，请参阅<a href="MEDIAN.html#GUID-DE15705A-AC18-4416-8487-B9E1D70CE01A">MEDIAN</a> 。</p>
                  <div class="infoboxnote" id="GUID-CA259452-A565-41B3-A4F4-DD74B66CEDE0__GUID-479FE0FC-C8A1-48C0-92B0-35D3E5FBEEE7">
                     <p class="notep1">注意：</p>
                     <p>在使用<code class="codeph">PERCENTILE_CONT</code>函数处理大量数据之前，请考虑使用以下方法之一来获得比精确结果更快的近似结果：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>在使用<code class="codeph">PERCENTILE_CONT</code>函数之前，将<code class="codeph">APPROX_FOR_PERCENTILE</code>初始化参数设置为<code class="codeph">PERCENTILE_CONT</code>或<code class="codeph">ALL</code> 。有关此参数的详细信息，请参阅<a href="../refrn/APPROX_FOR_PERCENTILE.html#REFRN-GUID-3872A78C-9B3F-457C-AD28-4E86F71AE74D" target="_blank"><span class="italic">Oracle数据库参考</span></a> 。
                           </p>
                        </li>
                        <li>
                           <p>使用<code class="codeph">APPROX_PERCENTILE</code>函数代替<code class="codeph">PERCENTILE_CONT</code>函数。请参阅<a href="APPROX_PERCENTILE.html#GUID-70D54091-EE2F-4283-A10B-1AB5A1242FE2">APPROX_PERCENTILE</a> 。</p>
                        </li>
                     </ul>
                  </div>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-CA259452-A565-41B3-A4F4-DD74B66CEDE0__GUID-9A65F61D-4981-4C3B-B9B7-F59B1086C2B5">聚合示例</p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p>以下示例计算每个部门的工资中位数：</p><pre class="oac_no_warn" dir="ltr">SELECT department_id，PERCENTILE_CONT（0.5）WITHIN GROUP（ORDER BY salary DESC）“Median cont”，PERCENTILE_DISC（0.5）WITHIN GROUP（ORDER BY salary DESC）“Median disc”FROM employees GROUP BY department_id ORDER BY department_id; DEPARTMENT_ID中位数盘中位数------------- ----------- ----------- 10 4400 4400 20 9500 13000 30 2850 2900 40 6500 6500 50 3100 3100 60 4800 4800 70 10000 10000 80 8900 9000 90 17000 17000 100 8000 8200 110 10154 12008 7000 7000</pre><p><code class="codeph">PERCENTILE_CONT</code>和<code class="codeph">PERCENTILE_DISC</code>可能会返回不同的结果。<code class="codeph">PERCENTILE_CONT</code>在执行线性插值后返回计算结果。<code class="codeph">PERCENTILE_DISC</code>只返回聚合的值集合中的值。当百分位数值为0.5时，如本例所示， <code class="codeph">PERCENTILE_CONT</code>返回具有偶数个元素的组的两个中间值的平均值，而<code class="codeph">PERCENTILE_DISC</code>返回两个中间值中第一个的值。对于具有奇数个元素的聚合组，两个函数都返回中间元素的值。
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-CA259452-A565-41B3-A4F4-DD74B66CEDE0__GUID-1B6CDABB-E9D3-4E27-B2EE-5FBA18B37743">分析实例</p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p>在以下示例中，Department 60的中位数为4800，其相应的百分位数（ <code class="codeph">Percent_Rank</code> ）为0.5。部门30的工资中没有一个的百分位数为0.5，因此中值必须在2900（百分位数0.4）和2800（百分位数0.6）之间插值，其评估值为2850。
                  </p><pre class="oac_no_warn" dir="ltr">SELECT last_name，salary，department_id，PERCENTILE_CONT（0.5）WITHIN GROUP（ORDER BY salary DESC）OVER（PARTITION BY department_id）“Percentile_Cont”，PERCENT_RANK（）OVER（PARTITION BY department_id ORDER BY salary DESC）“Percent_Rank”FROM employees WHERE department_id IN （30,60）ORDER BY last_name，salary，department_id; LAST_NAME SALARY DEPARTMENT_ID Percentile_Cont Percent_Rank ------------------------- ---------- ---------- --- --------------- ------------ Austin 4800 60 4800 .5 Baida 2900 30 2850 .4 Colmenares 2500 30 2850 1 Ernst 6000 60 4800 .25冰室2600 30 2850 .8 Hunold 9000 60 4800 0 Khoo 3100 30 2850 .2 Lorentz 4200 60 4800 1 Pataballa 4800 60 4800 .5 Raphaely 11000 30 2850 0 Tobias 2800 30 2850 .6</pre></div>
               <!-- class="section" -->
            </div>
         </div>
      </article>
   </body>
</html>