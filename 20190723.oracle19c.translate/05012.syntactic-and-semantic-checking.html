<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>句法和语义检查</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Programmer&#39;s Guide"></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Programmer&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="c-c-programmers-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-11T03:52:01-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96467-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="performance-tuning.html" title="Previous" type="text/html"></link>
      <link rel="next" href="system-specific-references.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Pro*C/C++ Programmer&#39;s Guide"></meta>
    <meta name="dcterms.isVersionOf" content="LNPCC"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="performance-tuning.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="system-specific-references.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">程序员指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="appendixes.html" property="item" typeof="WebPage"><span property="name">附录</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">句法和语义检查</li>
            </ol>
            <a id="GUID-C11CF911-407A-441F-BABF-9A308CAF54AB" name="GUID-C11CF911-407A-441F-BABF-9A308CAF54AB"></a><a id="LNPCC024"></a>
            
            <h2 id="LNPCC-GUID-C11CF911-407A-441F-BABF-9A308CAF54AB" class="sect2"><span class="enumeration_chapter">C</span>句法和语义检查</h2>
         </header>
         <div class="ind">
            <div>
               <p>通过检查嵌入式SQL语句和PL / SQL块的语法和语义，Pro * C / C ++预编译器可帮助您快速查找和修复编码错误。本附录向您介绍如何使用SQLCHECK选项来控制检查的类型和范围。本附录包含以下主题：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="syntactic-and-semantic-checking.html#GUID-0DA15DAE-51F9-412F-95C4-CC3E06BB6F9F">什么是句法和语义检查？</a></p>
                     <p><a href="syntactic-and-semantic-checking.html#GUID-5C30A41D-4132-4C5A-A8B7-640A8931E15A">关于控制检查的类型和范围</a></p>
                  </li>
                  <li>
                     <p><a href="syntactic-and-semantic-checking.html#GUID-DC65C3C5-995D-445D-86C5-29D9BE3135F3">关于指定SQLCHECK = SEMANTICS</a></p>
                  </li>
                  <li>
                     <p><a href="syntactic-and-semantic-checking.html#GUID-2CB9DAC3-84CC-417F-89D2-BF48071BFB3D">关于指定SQLCHECK = SYNTAX</a></p>
                  </li>
                  <li>
                     <p><a href="syntactic-and-semantic-checking.html#GUID-A23461C2-15DB-490B-A5AF-8855996D5078">关于输入SQLCHECK选项</a></p>
                  </li>
               </ul>
            </div><a id="LNPCC4581"></a><div class="props_rev_3"><a id="GUID-0DA15DAE-51F9-412F-95C4-CC3E06BB6F9F" name="GUID-0DA15DAE-51F9-412F-95C4-CC3E06BB6F9F"></a><h3 id="LNPCC-GUID-0DA15DAE-51F9-412F-95C4-CC3E06BB6F9F" class="sect3"><span class="enumeration_section">C.1</span>什么是句法和语义检查？
               </h3>
               <div>
                  <p>语法规则指定语言元素如何排序以形成有效语句。因此， <span class="italic">语法检查会</span>验证关键字，对象名称，运算符，分隔符等是否正确放置在SQL语句中。例如，以下嵌入式SQL语句包含语法错误： <a id="d115969e74" class="indexterm-anchor"></a> 
                  </p><pre class="oac_no_warn" dir="ltr">执行SQL删除EMP，DEPTNO = 20; - 拼写错误的关键字WHERE EXEC SQL INSERT INTO EMP COMM，SAL VALUES（NULL，1500）; - 列名COMM和SAL周围缺少括号</pre><p>语义规则指定如何进行有效的外部引用。因此， <span class="italic">语义检查</span>验证对数据库对象和主机变量的引用是否有效以及主机变量数据类型是否正确。例如，以下嵌入式SQL语句包含语义错误： <a id="d115969e86" class="indexterm-anchor"></a><a id="d115969e90" class="indexterm-anchor"></a> 
                  </p><pre class="oac_no_warn" dir="ltr">EXEC SQL DELETE FROM empp WHERE deptno = 20; - 不存在的表，EMPP EXEC SQL SELECT * FROM emp WHERE ename =：emp_name; - 未声明的主机变量<span class="italic">emp_name</span> 
</pre><p>SQL语法和语义的规则在<a href="../sqlrf/index.html" target="_blank"><span class="italic">Oracle数据库SQL语言参考</span></a>中定义。
                  </p>
               </div>
            </div><a id="LNPCC4582"></a><div class="props_rev_3"><a id="GUID-5C30A41D-4132-4C5A-A8B7-640A8931E15A" name="GUID-5C30A41D-4132-4C5A-A8B7-640A8931E15A"></a><h3 id="LNPCC-GUID-5C30A41D-4132-4C5A-A8B7-640A8931E15A" class="sect3"><span class="enumeration_section">C.2</span>关于控制检查的类型和范围</h3>
               <div>
                  <p>您可以通过在命令行上指定SQLCHECK选项来控制检查的类型和范围。使用SQLCHECK，检查的<span class="italic">类型</span>可以是语法，语义或两者。检查的<span class="italic">范围</span>可包括以下内容： <a id="d115969e137" class="indexterm-anchor"></a><a id="d115969e141" class="indexterm-anchor"></a> 
                  </p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>数据定义语句（例如CREATE和GRANT）</p>
                     </li>
                     <li>
                        <p>数据操作语句（例如SELECT和INSERT）</p>
                     </li>
                     <li>
                        <p>PL / SQL块</p>
                     </li>
                  </ul>
                  <p>但是，SQLCHECK无法检查动态SQL语句，因为它们在运行时才完全定义。 <a id="d115969e158" class="indexterm-anchor"></a> 
                  </p>
                  <p>您可以为SQLCHECK指定以下值：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>语义学或全部</p>
                     </li>
                     <li>
                        <p>句法</p>
                     </li>
                  </ul>
                  <p>默认值为SYNTAX。</p>
                  <p>使用SQLCHECK不会影响对数据控件，游标控制和动态SQL语句执行的正常语法检查。 <a id="d115969e176" class="indexterm-anchor"></a> 
                  </p>
               </div>
            </div><a id="LNPCC4583"></a><div class="props_rev_3"><a id="GUID-DC65C3C5-995D-445D-86C5-29D9BE3135F3" name="GUID-DC65C3C5-995D-445D-86C5-29D9BE3135F3"></a><h3 id="LNPCC-GUID-DC65C3C5-995D-445D-86C5-29D9BE3135F3" class="sect3"><span class="enumeration_section">C.3</span>关于指定SQLCHECK = SEMANTICS</h3>
               <div>
                  <p>当SQLCHECK = SEMANTICS时，预编译器检查语法和语义</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>数据操作语句（INSERT，UPDATE等）</p>
                     </li>
                     <li>
                        <p>PL / SQL块</p>
                     </li>
                     <li>
                        <p>主机变量数据类型</p>
                     </li>
                  </ul>
                  <p>以及。的语法</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>数据定义语句（CREATE，ALTER等）</p>
                     </li>
                  </ul>
                  <p>但是，只对使用AT <span class="italic">db_name</span>子句的数据操作语句进行语法检查。
                  </p>
                  <p>当SQLCHECK = SEMANTICS时，预编译器通过使用嵌入式DECLARE TABLE语句或通过连接到Oracle服务器并访问数据字典在命令行上指定USERID选项来获取语义检查所需的信息。如果在DECLARE TABLE语句中定义了数据操作语句或PL / SQL块中引用的每个表，则无需连接到Oracle服务器。</p>
                  <p>如果连接到Oracle服务器，但在数据字典中找不到某些所需信息，则必须使用DECLARE TABLE语句提供缺少的信息。如果数据字典定义发生冲突，则DECLARE TABLE定义将覆盖它。</p>
                  <p>如果在主机程序中嵌入PL / SQL块，则<span class="italic">必须</span>指定SQLCHECK = SEMANTICS。</p>
                  <p>在检查数据操作语句时，预编译器使用<a href="../sqlrf/index.html" target="_blank"><span class="italic">Oracle数据库SQL语言参考中</span></a>的语法规则<a href="../sqlrf/index.html" target="_blank"><span class="italic">，</span></a>但使用更严格的语义规则集。特别是，完成了更严格的数据类型检查。因此，当SQLCHECK = SEMANTICS时，为早期版本的Oracle编写的现有应用程序可能无法成功预编译。</p>
                  <p>在预编译新程序或要求更严格的数据类型检查时指定SQLCHECK = SEMANTICS。</p>
               </div><a id="LNPCC4584"></a><div class="props_rev_3"><a id="GUID-98459C5D-0370-4B93-9D31-9B844E62A399" name="GUID-98459C5D-0370-4B93-9D31-9B844E62A399"></a><h4 id="LNPCC-GUID-98459C5D-0370-4B93-9D31-9B844E62A399" class="sect4"><span class="enumeration_section">C.3.1</span>关于启用语义检查</h4>
                  <div>
                     <p>当SQLCHECK = SEMANTICS时，预编译器可以通过以下任一方式获取语义检查所需的信息： <a id="d115969e269" class="indexterm-anchor"></a> 
                     </p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>连接到Oracle服务器并访问数据字典。</p>
                        </li>
                        <li>
                           <p>使用嵌入式DECLARE TABLE和DECLARE TYPE语句。</p>
                        </li>
                     </ul>
                  </div><a id="LNPCC4585"></a><div class="props_rev_3"><a id="GUID-499EB901-16AF-4C29-ADCD-42111416261E" name="GUID-499EB901-16AF-4C29-ADCD-42111416261E"></a><h5 id="LNPCC-GUID-499EB901-16AF-4C29-ADCD-42111416261E" class="sect5"><span class="enumeration_section">C.3.1.1</span>关于连接Oracle服务器</h5>
                     <div>
                        <p>要进行语义检查，预编译器可以连接到Oracle数据库，该数据库维护主机程序中引用的表，类型和视图的定义。 <a id="d115969e305" class="indexterm-anchor"></a> 
                        </p>
                        <p>连接到Oracle服务器后，预编译器访问数据字典以获取所需信息。<span class="italic">数据字典</span>存储表和列名称，表和列约束，列长度，列数据类型等。
                        </p>
                        <p>如果在数据字典中找不到某些所需信息（例如，因为您的程序引用了尚未创建的表），则必须使用DECLARE TABLE语句提供缺少的信息（本附录稍后将对此进行讨论）。</p>
                        <p>要连接到Oracle服务器，请使用以下语法在命令行上指定USERID选项： <a id="d115969e319" class="indexterm-anchor"></a><a id="d115969e323" class="indexterm-anchor"></a> 
                        </p><pre class="oac_no_warn" dir="ltr">USERID =用户名/密码</pre><p>其中<span class="italic">用户名</span>和<span class="italic">密码</span>包含有效的Oracle用户标识。如果省略密码，系统会提示您输入密码。
                        </p>
                        <p>如果您指定的是用户名和密码，而不是用户名和密码</p><pre class="oac_no_warn" dir="ltr">USERID = /</pre><p>预编译器尝试自动连接到Oracle服务器。仅当现有Oracle用户名与前缀为“CLUSTER $”的操作系统ID匹配时，或者在INIT.ORA文件中将参数OS_AUTHENT_PREFIX设置为任何值时，尝试才会成功。例如，如果您的操作系统ID是MBLAKE，则只有在CLUSTER $ MBLAKE是有效的Oracle用户名时，自动连接才会成功。</p>
                        <p>如果省略USERID选项，则预编译器必须从嵌入的DECLARE TABLE语句中获取所需的信息。</p>
                        <p>如果您尝试连接到Oracle服务器但不能（例如，因为数据库不可用），则会发出错误消息，并且您的程序未预编译。</p>
                     </div>
                  </div><a id="LNPCC4586"></a><div class="props_rev_3"><a id="GUID-FA93B032-BE6C-4933-992D-64CB1C271CDD" name="GUID-FA93B032-BE6C-4933-992D-64CB1C271CDD"></a><h5 id="LNPCC-GUID-FA93B032-BE6C-4933-992D-64CB1C271CDD" class="sect5"><span class="enumeration_section">C.3.1.2</span>关于使用DECLARE TABLE</h5>
                     <div>
                        <p>预编译器可以在不连接Oracle服务器的情况下进行语义检查。要进行检查，预编译器必须从嵌入的DECLARE TABLE语句中获取有关表和视图的信息。因此，必须在DECLARE TABLE语句中定义数据操作语句或PL / SQL块中引用的每个表。 <a id="d115969e370" class="indexterm-anchor"></a><a id="d115969e374" class="indexterm-anchor"></a> 
                        </p>
                        <p>DECLARE TABLE语句的语法是：</p><pre class="oac_no_warn" dir="ltr">EXEC SQL DECLARE table_name TABLE（col_name col_datatype [DEFAULT expr] [NULL | NOT NULL]，...）;</pre><p>其中<span class="italic">expr</span>是一个整数，可以在CREATE TABLE语句中用作默认列值。
                        </p>
                        <p>对于用户定义的对象数据类型，大小是可选的，因为它未被使用。</p>
                        <p>如果使用DECLARE TABLE定义已存在的数据库表，则预编译器将使用您的定义，忽略数据字典中的定义。</p>
                     </div>
                  </div><a id="LNPCC4587"></a><div class="props_rev_3"><a id="GUID-AE8B7ADB-9EC9-4660-9E73-9B2006A51906" name="GUID-AE8B7ADB-9EC9-4660-9E73-9B2006A51906"></a><h5 id="LNPCC-GUID-AE8B7ADB-9EC9-4660-9E73-9B2006A51906" class="sect5"><span class="enumeration_section">C.3.1.3</span>关于使用DECLARE TYPE</h5>
                     <div>
                        <p>类似地，对于TYPE，有一个DECLARE TYPE语句，其语法是：</p><pre class="oac_no_warn" dir="ltr">EXEC SQL DECLARE类型TYPE [AS OBJECT（col_name col_datatype，...）]| [AS VARRAY（size）OF element_type] | [AS TABLE OF object_type];</pre><p>这允许在预编译时SQLCHECK = SEMANTICS时对用户定义的类型进行更好的类型检查。当SQLCHECK = SYNTAX时，DECLARE TYPE语句仅用作文档，并被注释掉并被忽略。</p>
                     </div>
                  </div>
               </div>
            </div><a id="LNPCC4588"></a><div class="props_rev_3"><a id="GUID-2CB9DAC3-84CC-417F-89D2-BF48071BFB3D" name="GUID-2CB9DAC3-84CC-417F-89D2-BF48071BFB3D"></a><h3 id="LNPCC-GUID-2CB9DAC3-84CC-417F-89D2-BF48071BFB3D" class="sect3"><span class="enumeration_section">C.4</span>关于指定SQLCHECK = SYNTAX</h3>
               <div>
                  <p>当SQLCHECK = SYNTAX时，预编译器检查<a href="../sqlrf/index.html" target="_blank"><span class="italic">Oracle数据库SQL语言参考中</span></a>记录的SQL语句的语法：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>数据操作语句</p>
                     </li>
                     <li>
                        <p>主机变量表达式</p>
                     </li>
                  </ul>
                  <p>未进行语义检查，并且适用以下限制：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>未尝试与Oracle服务器建立连接，USERID变为无效选项。如果指定USERID，则会发出警告消息。</p>
                     </li>
                     <li>
                        <p>DECLARE TABLE和DECLARE TYPE语句被忽略;它们仅用作文档。</p>
                     </li>
                     <li>
                        <p>不允许使用PL / SQL块。如果预编译器找到PL / SQL块，则会发出错误消息。</p>
                     </li>
                  </ul>
                  <p>检查数据操作语句时，预编译器使用Oracle语法规则。这些规则向下兼容，因此在迁移预编译程序时请指定SQLCHECK = SYNTAX。</p>
               </div>
            </div><a id="LNPCC4589"></a><div class="props_rev_3"><a id="GUID-A23461C2-15DB-490B-A5AF-8855996D5078" name="GUID-A23461C2-15DB-490B-A5AF-8855996D5078"></a><h3 id="LNPCC-GUID-A23461C2-15DB-490B-A5AF-8855996D5078" class="sect3"><span class="enumeration_section">C.5</span>关于输入SQLCHECK选项</h3>
               <div>
                  <p>您可以在线或在命令行上输入SQLCHECK选项。但是，您在内联中指定的检查级别不能高于您在命令行上指定的级别（或默认接受）。例如，如果在命令行上指定SQLCHECK = SYNTAX，则不能指定SQLCHECK = SEMANTICS inline。</p>
                  <p></p>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>