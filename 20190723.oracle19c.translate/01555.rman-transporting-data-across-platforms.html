<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>跨平台传输数据</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Backup and Recovery User&#39;s Guide"></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Backup and Recovery User&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="database-backup-and-recovery-users-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-09T05:20:45-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2003, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96241-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="creating-transportable-tablespace-sets.html" title="Previous" type="text/html"></link>
      <link rel="next" href="part-user-managed-backup-recovery.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database Backup and Recovery User&#39;s Guide"></meta>
    <meta name="dcterms.isVersionOf" content="BRADV"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="creating-transportable-tablespace-sets.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="part-user-managed-backup-recovery.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">备份和恢复用户指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="part-transfering-data-rman.html" property="item" typeof="WebPage"><span property="name">使用RMAN传输数据</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">跨平台传输数据</li>
            </ol>
            <a id="GUID-65AADCB6-CC9A-4229-9AB8-805C37E4471F" name="GUID-65AADCB6-CC9A-4229-9AB8-805C37E4471F"></a><a id="BRADV05432"></a>
            
            <h2 id="BRADV-GUID-65AADCB6-CC9A-4229-9AB8-805C37E4471F" class="sect2"><span class="enumeration_chapter">28</span>跨平台传输数据</h2>
         </header>
         <div class="ind">
            <div>
               <p><a id="d127931e69" class="indexterm-anchor"></a>您<a id="d127931e74" class="indexterm-anchor"></a>可以使用RMAN跨不同端格式的平台传输表空间。只要两个平台具有相同的endian格式，您也可以使用RMAN将整个数据库传输到不同的平台。
               </p>
               <p>本章包含以下主题：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="rman-transporting-data-across-platforms.html#GUID-1DAD0A3D-6DDA-4578-A0A2-603DC385281C">关于跨平台数据传输</a></p>
                  </li>
                  <li>
                     <p><a href="rman-transporting-data-across-platforms.html#GUID-D4C86E36-8EF8-489D-84CE-B8F045C8AB20">使用映像副本进行跨平台数据传输概述</a></p>
                  </li>
                  <li>
                     <p><a href="rman-transporting-data-across-platforms.html#GUID-33C67168-9AD5-43A8-96E0-CF65DEF83F50">使用映像副本执行跨平台表空间转换</a></p>
                  </li>
                  <li>
                     <p><a href="rman-transporting-data-across-platforms.html#GUID-B3E99F38-FDFC-426C-9F03-5C76381290B9">使用映像副本执行跨平台数据文件转换</a></p>
                  </li>
                  <li>
                     <p><a href="rman-transporting-data-across-platforms.html#GUID-EF05DB57-34E6-41AA-A44A-A0A91738DDB9">使用映像副本执行跨平台数据库转换</a></p>
                  </li>
                  <li>
                     <p><a href="rman-transporting-data-across-platforms.html#GUID-4644069A-7849-49F2-A1BF-2193EBAFFDBD">使用备份集的跨平台数据传输概述</a></p>
                  </li>
                  <li>
                     <p><a href="rman-transporting-data-across-platforms.html#GUID-76834111-5476-4591-A472-7DA5E2F4464D">使用备份集执行跨平台数据库传输</a></p>
                  </li>
                  <li>
                     <p><a href="rman-transporting-data-across-platforms.html#GUID-7E1B3B10-CDA2-4E79-9F4C-AC8E51BCDE54">使用备份集执行只读表空间的跨平台传输</a></p>
                  </li>
                  <li>
                     <p><a href="rman-transporting-data-across-platforms.html#GUID-346F0274-51A6-49D3-AB16-B8D1678655A1">使用不一致备份的表空间跨平台传输概述</a></p>
                  </li>
                  <li>
                     <p><a href="rman-transporting-data-across-platforms.html#GUID-06118644-AFC6-4BD4-8CAE-19BD3A886D0A" title="本节介绍使用备份集或映像副本执行不一致表空间的跨平台传输的高级步骤。">使用不一致的备份执行表空间的跨平台传输</a></p>
                  </li>
                  <li>
                     <p><a href="rman-transporting-data-across-platforms.html#GUID-27F404E2-4D45-4C99-B111-CD618F740C2B" title="可插拔数据库（PDB）可以被传输并插入目标多租户容器数据库（CDB），该数据库位于与源CDB不同的平台上。除了PDB的RMAN备份之外，还需要将PDB插入目标CDB所需的元数据。您可以使用不一致和一致备份的组合来传输PDB并将其插入到位于不同平台上的CDB 。不一致的备份使您可以减少应用程序停机时间，因为PDB可以在执行备份时打开">在CDB和PDB中执行跨平台数据传输</a></p>
                  </li>
               </ul>
            </div><a id="BRADV89977"></a><div class="props_rev_3"><a id="GUID-1DAD0A3D-6DDA-4578-A0A2-603DC385281C" name="GUID-1DAD0A3D-6DDA-4578-A0A2-603DC385281C"></a><h3 id="BRADV-GUID-1DAD0A3D-6DDA-4578-A0A2-603DC385281C" class="sect3"><span class="enumeration_section">28.1</span>关于跨平台数据传输</h3>
               <div>
                  <p>跨平台可传输表空间是普通可传输表空间的变体。适用于可传输表空间的所有限制也适用于此，例如需要确保所传输的所有对象完全包含在正在传输的表空间集中。可以在具有相同或不同的endian格式的平台之间执行跨平台可传输表空间。</p>
                  <p>跨平台可传输数据库与可传输表空间不同。在这种情况下，您将整个数据库，包括<code class="codeph">SYSTEM</code>表空间从一个平台复制到另一个平台。包含检查无关紧要，因为正在复制<code class="codeph">SYSTEM</code>表空间，所以不需要导出/导入步骤。跨平台可传输数据库只能在具有相同endian格式的平台之间执行。
                  </p>
               </div><a id="BRADV89978"></a><div class="props_rev_3"><a id="GUID-1EDB745F-CB10-43A7-A3C9-111D9B46049C" name="GUID-1EDB745F-CB10-43A7-A3C9-111D9B46049C"></a><h4 id="BRADV-GUID-1EDB745F-CB10-43A7-A3C9-111D9B46049C" class="sect4"><span class="enumeration_section">28.1.1</span>跨平台数据传输的目的</h4>
                  <div>
                     <p>您可以将在一个平台上运行的数据库中的表空间传输到在不同平台上运行的数据库中。跨平台可传输表空间的典型用法包括：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>将结构化数据发布为可传输的表空间，以便分发给客户，客户可以将表空间转换为现有数据库，而不管平台如何</p>
                        </li>
                        <li>
                           <p>将数据从大型数据仓库服务器移动到较小的计算机（如基于Linux的工作站或服务器）上的数据集市</p>
                        </li>
                        <li>
                           <p>在异构群集中共享只读表空间，其中所有主机共享相同的endian格式</p>
                        </li>
                        <li>
                           <p>跨平台迁移表空间，最小化应用程序停机时间</p>
                        </li>
                     </ul>
                     <p>有关可传输表空间及其用途以及创建和使用它们的不同技术的完整讨论，请参见“ <a href="../admin/transporting-data.html#ADMIN01101" target="_blank"><span class="italic">Oracle数据库管理员指南”</span> 。</a></p>
                     <p>您还可以使用RMAN将整个数据库从一个平台传输到另一个平台。例如，业务需求要求您在使用不同平台的较便宜的服务器上运行数据库。在这种情况下，您可以使用RMAN传输整个数据库，而不是重新创建它，并使用导入实用程序或可传输表空间来重新填充数据。</p>
                     <p>您可以在目标主机或源主机上转换数据库。转换目标主机的原因包括：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>由于转换过程，避免了源主机上的性能开销</p>
                        </li>
                        <li>
                           <p>将数据库从一个源系统分发到多个不同平台上的多个收件人</p>
                        </li>
                        <li>
                           <p>评估新平台的迁移路径</p>
                        </li>
                     </ul>
                  </div>
               </div><a id="BRADV707"></a><div class="props_rev_3"><a id="GUID-853520D8-02B6-4552-B03F-C35A5EDB6FF4" name="GUID-853520D8-02B6-4552-B03F-C35A5EDB6FF4"></a><h4 id="BRADV-GUID-853520D8-02B6-4552-B03F-C35A5EDB6FF4" class="sect4"><span class="enumeration_section">28.1.2</span>跨平台传输数据的方法</h4>
                  <div>
                     <p>RMAN使您可以将数据文件，表空间或整个数据库从一个平台传输到另一个平台。将整个数据库传输到其他平台时，目标平台必须具有与源平台相同的endian格式。</p>
                     <p>使用以下方法之一跨平台传输数据：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>使用图像副本传输数据</p>
                        </li>
                        <li>
                           <p>使用备份集传输数据</p>
                           <div class="infoboxnotealso" id="GUID-853520D8-02B6-4552-B03F-C35A5EDB6FF4__GUID-9C2ADD08-CEBE-4915-890E-7DAA1E1B96B3">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><span class="q">“ <a href="rman-transporting-data-across-platforms.html#GUID-D4C86E36-8EF8-489D-84CE-B8F045C8AB20">使用映像副本进行跨平台数据传输概述</a> ”</span></p>
                                 </li>
                                 <li>
                                    <p><span class="q">“ <a href="rman-transporting-data-across-platforms.html#GUID-4644069A-7849-49F2-A1BF-2193EBAFFDBD">使用备份集的跨平台数据传输概述</a> ”</span></p>
                                 </li>
                              </ul>
                           </div>
                        </li>
                     </ul>
                  </div>
               </div><a id="BRADV811"></a><div class="props_rev_3"><a id="GUID-D113DEE2-8619-4B8B-9EFE-9D2833C9823A" name="GUID-D113DEE2-8619-4B8B-9EFE-9D2833C9823A"></a><h4 id="BRADV-GUID-D113DEE2-8619-4B8B-9EFE-9D2833C9823A" class="sect4"><span class="enumeration_section">28.1.3</span>支持跨平台数据传输的平台</h4>
                  <div>
                     <p>Oracle数据库维护每个支持跨平台数据传输的平台的内部名称列表。这些名称存储在<code class="codeph">V$TRANSPORTABLE_PLATFORM</code>视图中。使用此视图可确定<a href="glossary.html#GUID-F5230E13-106F-4840-9E58-3AB7071E9B21"><span class="xrefglossterm">源平台</span></a>或<a href="glossary.html#GUID-0E17C982-762C-46D3-83BB-C86302304093"><span class="xrefglossterm">目标平台</span></a>的内部名称。在跨平台传输数据时，您可能需要指定源或目标平台的确切名称。必须完全按照<code class="codeph">V$TRANSPORTABLE_PLATFORM</code>视图中所示输入指定为<code class="codeph">CONVERT</code>或<code class="codeph">BACKUP</code>命令参数的任何平台名称。
                     </p>
                     <p>使用以下查询获取已连接数据库的平台名称：</p><pre class="oac_no_warn" dir="ltr">SELECT PLATFORM_NAME FROM V $ TRANSPORTABLE_PLATFORM WHERE PLATFORM_ID =（从V $ DATABASE中选择PLATFORM_ID）;</pre><p>使用以下查询获取Linux平台的名称：</p><pre class="oac_no_warn" dir="ltr">选择PLATFORM_ID，PLATFORM_NAME，END $来自V $ TRANSPORTABLE_PLATFORM WHERE UPPER（PLATFORM_NAME）LIKE'％LINUX％';</pre></div>
               </div>
            </div><a id="BRADV89979"></a><div class="props_rev_3"><a id="GUID-D4C86E36-8EF8-489D-84CE-B8F045C8AB20" name="GUID-D4C86E36-8EF8-489D-84CE-B8F045C8AB20"></a><h3 id="BRADV-GUID-D4C86E36-8EF8-489D-84CE-B8F045C8AB20" class="sect3"><span class="enumeration_section">28.2</span>使用映像副本进行跨平台数据传输概述</h3>
               <div>
                  <p>RMAN使您可以使用映像副本来传输表空间，数据文件或整个数据库。您可以使用RMAN <code class="codeph">CONVERT</code>命令执行带有映像副本的跨平台传输。表空间传输有时通过单独传输存储表空间数据的数据文件来执行。但是，无法传输作为包含多个数据文件的表空间一部分的单个数据文件。
                  </p>
                  <p>当<a href="glossary.html#GUID-F5230E13-106F-4840-9E58-3AB7071E9B21"><span class="xrefglossterm">源平台</span></a>与<a href="glossary.html#GUID-0E17C982-762C-46D3-83BB-C86302304093"><span class="xrefglossterm">目标平台</span></a>不同且endian格式不同时，必须在可传输表空间操作中使用RMAN <code class="codeph">CONVERT</code>命令。如果要在具有相同endian格式的平台之间转换部分数据库，则可以使用操作系统方法将文件从源复制到目标。如果要转换整个相同的endian数据库，则必须转换包含undo信息的所有数据文件。您无法将这些文件直接从源平台复制到目标平台。
                  </p>
               </div><a id="BRADV89980"></a><div class="props_rev_3"><a id="GUID-5515B50B-2FCF-4C94-BEA3-16070E4E2334" name="GUID-5515B50B-2FCF-4C94-BEA3-16070E4E2334"></a><h4 id="BRADV-GUID-5515B50B-2FCF-4C94-BEA3-16070E4E2334" class="sect4"><span class="enumeration_section">28.2.1</span>使用映像副本进行表空间和数据文件转换概述</h4>
                  <div>
                     <p>您可以在源主机上使用RMAN <code class="codeph">CONVERT</code> <code class="codeph">TABLESPACE</code>命令执行表空间转换，但不能在目标主机上执行。<code class="codeph">CONVERT TABLESPACE</code>命令不执行数据文件的就地转换。相反，该命令以正确的格式生成输出文件，以便在目标平台上使用。该命令不会更改<a href="glossary.html#GUID-609A4BFA-A852-4459-AD52-05C49212753A"><span class="xrefglossterm">源数据库</span></a>中数据文件的内容。
                     </p>
                     <p>您可以使用<code class="codeph">CONVERT</code> <code class="codeph">DATAFILE</code>命令转换文件。通常， <code class="codeph">CONVERT DATAFILE</code>命令在目标主机上使用， <code class="codeph">CONVERT TABLESPACE</code>命令在源主机上使用。在源主机上使用<code class="codeph">CONVERT DATAFILE</code>命令时，请确保数据文件完全脱机或包含这些数据文件的表空间是只读的。数据泵导出实用程序生成<a href="glossary.html#GUID-5C2A79F3-E089-41DC-B3F5-879FB6125CE5"><span class="xrefglossterm">导出转储文件</span></a> ，该文件可以将手动复制到目标主机的数据文件导入<a href="glossary.html#GUID-4CDA2F90-4918-4357-AE32-313264940FFA"><span class="xrefglossterm">目标数据库</span></a> 。在将数据泵导出转储文件导入目标数据库之前，数据文件不与数据库中的表空间名称相关联。在这种情况下，RMAN无法将表空间名称转换为数据文件列表。因此，您必须使用<code class="codeph">CONVERT</code> <code class="codeph">DATAFILE</code>并按文件名标识数据文件。
                     </p>
                     <div class="infoboxnote" id="GUID-5515B50B-2FCF-4C94-BEA3-16070E4E2334__GUID-9394B018-3ADE-4DA9-A729-EB7DE01D99CB">
                        <p class="notep1">注意：</p>
                        <p>使用<code class="codeph">CONVERT TABLESPACE</code>或<code class="codeph">CONVERT DATAFILE</code>只是使用跨平台可传输表空间的一个步骤。在尝试按照本章中的步骤进行操作之前<span class="italic">，请完整</span>阅读<a href="../admin/transporting-data.html#ADMIN01101" target="_blank"><span class="italic">Oracle数据库管理员指南</span></a> <span class="italic">中</span>有关可传输表空间的讨论。
                        </p>
                     </div>
                     <div class="infoboxnotealso" id="GUID-5515B50B-2FCF-4C94-BEA3-16070E4E2334__GUID-20AD5DE8-8B7D-4187-9B38-EFE5F79785D6">
                        <p class="notep1">也可以看看：</p>
                        <p>以下部分描述如何使用映像副本执行表空间和数据文件的跨平台传输：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="q">“ <a href="rman-transporting-data-across-platforms.html#GUID-33C67168-9AD5-43A8-96E0-CF65DEF83F50">使用映像副本执行跨平台表空间转换</a> ”</span></p>
                           </li>
                           <li>
                              <p><span class="q">“ <a href="rman-transporting-data-across-platforms.html#GUID-B3E99F38-FDFC-426C-9F03-5C76381290B9">使用映像副本执行跨平台数据文件转换</a> ”</span></p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="BRADV89981"></a><div class="props_rev_3"><a id="GUID-C91F21C3-C3C0-43B5-9D9D-2F9408F8808D" name="GUID-C91F21C3-C3C0-43B5-9D9D-2F9408F8808D"></a><h4 id="BRADV-GUID-C91F21C3-C3C0-43B5-9D9D-2F9408F8808D" class="sect4"><span class="enumeration_section">28.2.2</span>使用映像副本进行数据库转换概述</h4>
                  <div>
                     <p>要将整个数据库转换为不同的平台，两个平台必须使用相同的endian格式。RMAN <code class="codeph">CONVERT</code> <code class="codeph">DATABASE</code>命令可自动将整个数据库从源平台移动到目标平台。传输的数据库包含与<a href="glossary.html#GUID-609A4BFA-A852-4459-AD52-05C49212753A"><span class="xrefglossterm">源数据库</span></a>相同的数据，除少数例外情况外，还具有与源数据库相同的设置。
                     </p>
                     <p>自动传输到目标平台的文件包括：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>属于永久表空间的数据文件</p>
                           <p>与跨平台传输表空间不同，传输整个数据库需要重新格式化某些类型的块（例如还原段中的块）以确保与目标平台的兼容性。即使源平台和目标平台的字节序格式相同，某些类型的文件也必须经过转换过程。有关需要转换的文件类型的详细信息，请参阅<span class="q">“ <a href="rman-transporting-data-across-platforms.html#GUID-B0178538-6E41-455D-8166-FBB1EDC5D198">跨平台数据库转换前检查数据库</a> ”</span> 。
                           </p>
                        </li>
                        <li>
                           <p>初始化参数文件或服务器参数文件</p>
                           <p>如果数据库使用基于文本的初始化参数文件，则RMAN会传输它。如果数据库使用服务器参数文件，则RMAN将根据服务器参数文件生成初始化参数文件，并根据初始化参数文件中的设置传输它并在目标位置创建新的服务器参数文件。</p>
                           <p>通常，初始化参数文件中的某些参数需要手动更新新数据库。例如，您可以更改<code class="codeph">DB_NAME</code>和<code class="codeph">CONTROL_FILES</code>等参数，以指示目标主机上文件的位置。
                           </p>
                        </li>
                     </ul>
                     <p>您可以在源平台或目标平台上转换数据文件的格式。<code class="codeph">CONVERT DATABASE ON DESTINATION PLATFORM</code>命令不转换数据文件的格式。相反，它会生成可以手动运行以执行转换的脚本。<code class="codeph">CONVERT SCRIPT</code>参数创建一个<a href="glossary.html#GUID-6AC61FEB-A410-4A95-A442-90068824E11E"><span class="xrefglossterm">转换脚本</span></a> ，您可以在目标主机上手动执行该<a href="glossary.html#GUID-6AC61FEB-A410-4A95-A442-90068824E11E"><span class="xrefglossterm">脚本</span></a> ，以批处理方式转换数据文件副本。<code class="codeph">TRANSPORT SCRIPT</code>参数生成一个<a href="glossary.html#GUID-9F4C7A24-C72F-4E9C-8801-621CB6771E19"><span class="xrefglossterm">传输脚本</span></a> ，该<a href="glossary.html#GUID-9F4C7A24-C72F-4E9C-8801-621CB6771E19"><span class="xrefglossterm">脚本</span></a>包含用于在目标平台上创建新数据库的SQL语句。
                     </p>
                     <div class="infoboxnotealso" id="GUID-C91F21C3-C3C0-43B5-9D9D-2F9408F8808D__GUID-6D6292D9-268B-4E54-A812-A529D1978019">
                        <p class="notep1">也可以看看：</p>
                        <p>我的Oracle支持说明1079563.1，“RMAN DUPLICATE / RESTORE / RECOVER混合平台支持”，用于以下信息：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>不需要<code class="codeph">CONVERT DATABASE</code>命令的平台组合列表</p>
                           </li>
                           <li>
                              <p>源数据库和目标数据库的先决条件</p>
                           </li>
                        </ul>
                     </div>
                     <div class="infoboxnotealso" id="GUID-C91F21C3-C3C0-43B5-9D9D-2F9408F8808D__GUID-376B29A4-8A9F-4458-9243-8C28D220BCEC">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="http://www.oracle.com/goto/maa" target="_blank"><code class="codeph">http://www.oracle.com/goto/maa</code></a>了解使用跨平台可传输表空间和数据库过程作为数据迁移任务的一部分的最佳实践</p>
                     </div>
                     <div class="infoboxnotealso" id="GUID-C91F21C3-C3C0-43B5-9D9D-2F9408F8808D__GUID-45730CCB-5679-4148-A7A7-B0D3C81754DE">
                        <p class="notep1">也可以看看：</p>
                        <p>以下部分描述如何使用映像副本执行数据库的跨平台传输：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="q">“ <a href="rman-transporting-data-across-platforms.html#GUID-B0178538-6E41-455D-8166-FBB1EDC5D198">在跨平台数据库转换之前检查数据库</a> ”</span></p>
                           </li>
                           <li>
                              <p><span class="q">“ <a href="rman-transporting-data-across-platforms.html#GUID-E681FF6F-0927-4ED5-BF64-73926C4121DC">在传输数据库时转换源主机上的数据文件</a> ”</span></p>
                           </li>
                           <li>
                              <p><span class="q">“ <a href="rman-transporting-data-across-platforms.html#GUID-D8EF7402-2AEE-4FB3-8B84-5BC081333005">在传输数据库时转换目标主机上的数据文件</a> ”</span></p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div>
            </div><a id="BRADV474"></a><a id="BRADV89982"></a><div class="props_rev_3"><a id="GUID-33C67168-9AD5-43A8-96E0-CF65DEF83F50" name="GUID-33C67168-9AD5-43A8-96E0-CF65DEF83F50"></a><h3 id="BRADV-GUID-33C67168-9AD5-43A8-96E0-CF65DEF83F50" class="sect3"><span class="enumeration_section">28.3</span>使用映像副本执行跨平台表空间转换</h3>
               <div>
                  <div class="section">
                     <p>请参阅<a href="../rcmrf/CONVERT.html#RCMRF192" target="_blank"><span class="italic">Oracle数据库备份和恢复参考中</span></a>描述的<code class="codeph">CONVERT</code>命令先决条件列表<a href="../rcmrf/CONVERT.html#RCMRF192" target="_blank"><span class="italic">。</span></a> 在执行本节中的步骤之前，请满足所有这些先决条件。
                     </p>
                     <p>出于说明的目的，假设您必须从<a href="glossary.html#GUID-609A4BFA-A852-4459-AD52-05C49212753A"><span class="xrefglossterm">源数据库</span></a> <code class="codeph">prod_source</code>传输表空间<code class="codeph">finance</code>和<code class="codeph">hr</code> ，该<a href="glossary.html#GUID-609A4BFA-A852-4459-AD52-05C49212753A"><span class="xrefglossterm">源数据库</span></a> <code class="codeph">prod_source</code>在Sun Solaris主机上运行。您计划将它们传输到在Linux PC上运行的<a href="glossary.html#GUID-4CDA2F90-4918-4357-AE32-313264940FFA"><span class="xrefglossterm">目标数据库</span></a> <code class="codeph">prod_dest</code> 。您计划将转换后的数据文件存储在源主机上的临时目录<code class="codeph">/tmp/transport_linux/</code> 。
                     </p>
                     <div class="infoboxnotealso" id="GUID-33C67168-9AD5-43A8-96E0-CF65DEF83F50__GUID-A87083A4-89AC-410E-9247-ADD4657FD325">
                        <p class="notep1">也可以看看：</p>
                        <p><span class="q">“ <a href="rman-transporting-data-across-platforms.html#GUID-5515B50B-2FCF-4C94-BEA3-16070E4E2334">使用映像副本进行表空间和数据文件转换概述</a> ”</span></p>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-33C67168-9AD5-43A8-96E0-CF65DEF83F50__GUID-56B1E0F2-E197-414A-8C51-3DE075117CED">使用映像副本执行跨平台表空间转换：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ol>
                        <li>
                           <p>启动SQL * Plus并使用管理员权限连接到源数据库<code class="codeph">prod_source</code> 。
                           </p>
                        </li>
                        <li>
                           <p>在<code class="codeph">V$TRANSPORTABLE_PLATFORM</code>视图中查询目标平台的名称。
                           </p>
                           <p>PC上的<code class="codeph">PLATFORM_NAME</code> for Linux是<code class="codeph">Linux IA (64-bit)</code> 。
                           </p>
                           <div class="infoboxnotealso" id="GUID-33C67168-9AD5-43A8-96E0-CF65DEF83F50__GUID-6A6EE860-685A-41E1-84A2-E203551FDB4B">
                              <p class="notep1">也可以看看：</p>
                              <p><span class="q">“ <a href="rman-transporting-data-across-platforms.html#GUID-D113DEE2-8619-4B8B-9EFE-9D2833C9823A">支持跨平台数据传输的平台</a> ”，</span>以获取有关确定平台名称的信息</p>
                           </div>
                        </li>
                        <li>
                           <p>通过执行<code class="codeph">DBMS_TTS.TRANSPORT_SET_CHECK</code>过程，检查要传输的表空间是否是自包含的。如果<code class="codeph">TRANSPORT_SET_VIOLATIONS</code>视图包含与指定表空间对应的行，则必须先解析依赖关系，然后再继续转换。
                           </p>
                           <div class="infoboxnotealso" id="GUID-33C67168-9AD5-43A8-96E0-CF65DEF83F50__GUID-A2554873-B132-40D3-AE5C-1C2EA742507C">
                              <p class="notep1">也可以看看：</p>
                              <p><a href="performing-rman-tspitr.html#GUID-06BAA701-860F-4E3C-AA70-277CCCB7F425__CHDFCCFH">例21-1</a>有关执行<code class="codeph">DBMS_TTS.TRANSPORT_SET_CHECK</code>过程的信息</p>
                           </div>
                        </li>
                        <li>
                           <p>将表空间放置为以只读模式传输。例如，输入：</p><pre class="oac_no_warn" dir="ltr">ALTER TABLESPACE资金只读; ALTER TABLESPACE hr阅读;</pre></li>
                        <li>
                           <p>选择命名输出文件的方法。</p>
                           <div class="infoboxnotealso" id="GUID-33C67168-9AD5-43A8-96E0-CF65DEF83F50__GUID-4155300B-23A1-4F75-9CE6-BAE99373C4E3">
                              <p class="notep1">也可以看看：</p>
                              <p><span class="q">“ <a href="rman-transporting-data-across-platforms.html#GUID-2EACDF40-CB58-41C8-9128-487CD534F9C3">关于在RMAN跨平台数据文件转换期间重命名输出文件</a> ”</span></p>
                           </div>
                        </li>
                        <li>
                           <p>启动RMAN并以<code class="codeph">TARGET</code>身份连接到<span class="italic">源</span>数据库（而不是目标数据库）。例如，输入：</p><pre class="oac_no_warn" dir="ltr">％rman RMAN&gt; CONNECT TARGET“sbu @ prod_source AS SYSBACKUP”;</pre></li>
                        <li>
                           <p>运行<code class="codeph">CONVERT TABLESPACE</code>命令将数据文件转换为目标主机的endian格式。
                           </p>
                           <p>在以下示例中， <code class="codeph">FORMAT</code>参数控制已转换数据文件的名称和位置：</p><pre class="oac_no_warn" dir="ltr">RMAN&gt; CONVERT TABLESPACE finance，hr 2&gt; TO PLATFORM'Linux IA（64-bit）'3&gt; FORMAT'/ tmp / transport_linux /％U';</pre><p>结果是<code class="codeph">/tmp/transport_linux/</code>目录中的一组转换数据文件，其中数据采用正确的endian格式，适用于Linux IA（64位）平台。
                           </p>
                           <div class="infoboxnotealso" id="GUID-33C67168-9AD5-43A8-96E0-CF65DEF83F50__GUID-BBB99606-7F2D-41A9-9BFE-C913A4689B32">
                              <p class="notep1">也可以看看：</p>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=RCMRF192" target="_blank"><span class="italic">Oracle数据库备份和恢复参考</span></a> ，了解<code class="codeph">CONVERT</code>命令的完整语义</p>
                           </div>
                        </li>
                        <li>
                           <p>按照大纲的其余部分传输表空间：</p>
                           <ol type="a">
                              <li>
                                 <p>使用Oracle Data Pump Export实用程序在源主机上创建<a href="glossary.html#GUID-5C2A79F3-E089-41DC-B3F5-879FB6125CE5"><span class="xrefglossterm">导出转储文件</span></a> 。
                                 </p>
                              </li>
                              <li>
                                 <p>将转换后的数据文件和导出转储文件从源主机移动到目标主机上的所需目录。</p>
                              </li>
                              <li>
                                 <p>使用DataPump Import实用程序将表空间插入新数据库。</p>
                              </li>
                              <li>
                                 <p>如果适用，将传输的表空间置于读/写模式。</p>
                              </li>
                           </ol>
                           <div class="infoboxnotealso" id="GUID-33C67168-9AD5-43A8-96E0-CF65DEF83F50__GUID-FAD79F6F-F5C5-4B92-B1ED-03C47944C244">
                              <p class="notep1">也可以看看：</p>
                              <p>有关使用可传输表空间的信息，请参见<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=ADMIN11394" target="_blank"><span class="italic">“Oracle数据库管理员指南”</span></a></p>
                           </div>
                        </li>
                     </ol>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="BRADV89983"></a><div class="props_rev_3"><a id="GUID-B3E99F38-FDFC-426C-9F03-5C76381290B9" name="GUID-B3E99F38-FDFC-426C-9F03-5C76381290B9"></a><h3 id="BRADV-GUID-B3E99F38-FDFC-426C-9F03-5C76381290B9" class="sect3"><span class="enumeration_section">28.4</span>使用映像副本执行跨平台数据文件转换</h3>
               <div>
                  <p>请参阅<a href="../rcmrf/CONVERT.html#RCMRF192" target="_blank"><span class="italic">Oracle数据库备份和恢复参考中</span></a>描述的<code class="codeph">CONVERT</code>命令先决条件列表<a href="../rcmrf/CONVERT.html#RCMRF192" target="_blank"><span class="italic">。</span></a> 在执行本节中的步骤之前，请满足这些先决条件。
                  </p>
                  <p>本节包含以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="rman-transporting-data-across-platforms.html#GUID-2EACDF40-CB58-41C8-9128-487CD534F9C3">关于在RMAN跨平台数据文件转换期间重命名输出文件</a></p>
                     </li>
                     <li>
                        <p><a href="rman-transporting-data-across-platforms.html#GUID-1087F30E-647F-4A32-8F33-1BC1A0E5CAE8">使用RMAN CONVERT DATAFILE在目标主机上执行表空间传输</a></p>
                     </li>
                  </ul>
               </div><a id="BRADV89984"></a><div class="props_rev_3"><a id="GUID-2EACDF40-CB58-41C8-9128-487CD534F9C3" name="GUID-2EACDF40-CB58-41C8-9128-487CD534F9C3"></a><h4 id="BRADV-GUID-2EACDF40-CB58-41C8-9128-487CD534F9C3" class="sect4"><span class="enumeration_section">28.4.1</span>关于在RMAN跨平台数据文件转换期间重命名输出文件</h4>
                  <div>
                     <p>数据文件转换需要您选择一种命名输出文件的技术。必须使用<code class="codeph">CONVERT</code>命令的<code class="codeph">FORMAT</code>或<code class="codeph">DB_FILE_NAME_CONVERT</code>参数来控制输出文件的命名。规则按优先顺序列出：</p>
                     <ol>
                        <li>
                           <p>任何与<code class="codeph">DB_FILE_NAME_CONVERT</code>子句中提供的模式匹配的文件都是基于此模式命名的。
                           </p>
                        </li>
                        <li>
                           <p>如果指定<code class="codeph">FORMAT</code>子句，则基于<code class="codeph">DB_FILE_NAME_CONVERT</code>子句中提供的模式未命名的任何文件将根据<code class="codeph">FORMAT</code>模式命名。
                           </p>
                        </li>
                     </ol>
                     <div class="infoboxnote" id="GUID-2EACDF40-CB58-41C8-9128-487CD534F9C3__GUID-40EEDEB2-F74B-4355-9B81-35184A7C262F">
                        <p class="notep1">注意：</p>
                        <p>当源文件和目标文件都是Oracle托管文件时，不能使用<code class="codeph">DB_FILE_NAME_CONVERT</code>子句为<code class="codeph">CONVERT</code>命令生成输出文件名。
                        </p>
                     </div>
                     <p>如果源平台和目标平台不同，则必须指定<code class="codeph">FROM PLATFORM</code>参数。通过查询<code class="codeph">V$TRANSPORTABLE_PLATFORM</code>查看平台名称。 <code class="codeph">FROM PLATFORM</code>值必须与要转换的数据文件的格式匹配，以避免出错。如果未指定<code class="codeph">FROM PLATFORM</code> ，则此参数默认为目标平台的值。
                     </p>
                     <div class="infoboxnotealso" id="GUID-2EACDF40-CB58-41C8-9128-487CD534F9C3__GUID-5A58AB19-4F9B-4FD3-83F1-65A6BB2AFCDE">
                        <p class="notep1">也可以看看：</p>
                        <p><span class="q">“ <a href="rman-transporting-data-across-platforms.html#GUID-D113DEE2-8619-4B8B-9EFE-9D2833C9823A">支持跨平台数据传输的平台</a> ”，</span>以获取有关确定平台名称的信息</p>
                     </div>
                  </div>
               </div><a id="BRADV475"></a><a id="BRADV89985"></a><div class="props_rev_3"><a id="GUID-1087F30E-647F-4A32-8F33-1BC1A0E5CAE8" name="GUID-1087F30E-647F-4A32-8F33-1BC1A0E5CAE8"></a><h4 id="BRADV-GUID-1087F30E-647F-4A32-8F33-1BC1A0E5CAE8" class="sect4"><span class="enumeration_section">28.4.2</span>使用RMAN CONVERT DATAFILE在目标主机上执行表空间传输</h4>
                  <div>
                     <div class="section">
                        <p>本节介绍如何使用<code class="codeph">CONVERT DATAFILE</code>命令。本节假定您打算从名为<code class="codeph">prod_source</code>的<a href="glossary.html#GUID-609A4BFA-A852-4459-AD52-05C49212753A"><span class="xrefglossterm">源数据库</span></a>传输表空间<code class="codeph">finance</code> （数据文件<code class="codeph">fin/fin01.dbf</code>和<code class="codeph">fin/fin02.dbf</code> ）和<code class="codeph">hr</code> （数据文件<code class="codeph">hr/hr01.dbf</code>和<code class="codeph">hr/hr02.dbf</code> ）。该数据库在Sun Solaris主机上运行。您计划将这些表空间传输到名为<code class="codeph">prod_dest</code>的<a href="glossary.html#GUID-4CDA2F90-4918-4357-AE32-313264940FFA"><span class="xrefglossterm">目标数据库</span></a> ，该<a href="glossary.html#GUID-4CDA2F90-4918-4357-AE32-313264940FFA"><span class="xrefglossterm">目标数据库</span></a>在Linux PC上运行。您计划在目标主机上执行转换。
                        </p>
                        <p>将数据文件插入目标数据库时，您计划将它们存储在<code class="codeph">/orahome/dbs</code>并保留当前目录结构。也就是说， <code class="codeph">hr</code>表空间的数据文件存储在<code class="codeph">/orahome/dbs/hr</code>子目录中， <code class="codeph">finance</code>表空间的数据文件存储在<code class="codeph">/orahome/dbs/fin</code>目录中。
                        </p>
                        <div class="infoboxnotealso" id="GUID-1087F30E-647F-4A32-8F33-1BC1A0E5CAE8__GUID-BABFE32A-755A-4256-9475-F9C14C922C2A">
                           <p class="notep1">也可以看看：</p>
                           <p><span class="q">“ <a href="rman-transporting-data-across-platforms.html#GUID-5515B50B-2FCF-4C94-BEA3-16070E4E2334">使用映像副本进行表空间和数据文件转换概述</a> ”</span></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-1087F30E-647F-4A32-8F33-1BC1A0E5CAE8__GUID-934C82FB-1757-400F-BAFE-804A2F49129F">使用映像副本执行跨平台数据文件转换：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ol>
                           <li>
                              <p>启动SQL * Plus并使用管理员权限连接到<a href="glossary.html#GUID-609A4BFA-A852-4459-AD52-05C49212753A"><span class="xrefglossterm">源数据库</span></a> <code class="codeph">prod_source</code> 。
                              </p>
                           </li>
                           <li>
                              <p>在<code class="codeph">V$TRANSPORTABLE_PLATFORM</code>查询源平台的名称。</p>
                              <p>对于此方案，假设源主机的<code class="codeph">PLATFORM_NAME</code>是<code class="codeph">Solaris[tm] OE (64-bit)</code> 。
                              </p>
                              <div class="infoboxnotealso" id="GUID-1087F30E-647F-4A32-8F33-1BC1A0E5CAE8__GUID-AE3FE709-AE91-4907-BD64-D934F8E7C04A">
                                 <p class="notep1">也可以看看：</p>
                                 <p><span class="q">“ <a href="rman-transporting-data-across-platforms.html#GUID-D113DEE2-8619-4B8B-9EFE-9D2833C9823A">支持跨平台数据传输的平台</a> ”，</span>以获取有关确定平台名称的信息</p>
                              </div>
                           </li>
                           <li>
                              <p>确定要从源数据库传输的表空间，并将它们置于只读模式。</p>
                              <p>例如，输入以下SQL语句以将<code class="codeph">finance</code>和<code class="codeph">hr</code>置于只读模式：</p><pre class="oac_no_warn" dir="ltr">ALTER TABLESPACE资金只读; ALTER TABLESPACE hr阅读;</pre></li>
                           <li>
                              <p>在源主机上，使用Data Pump Export创建<a href="glossary.html#GUID-5C2A79F3-E089-41DC-B3F5-879FB6125CE5"><span class="xrefglossterm">导出转储文件</span></a> 
                              </p>
                              <p>在此示例中，转储文件名为<code class="codeph">expdat.dmp</code> 。
                              </p>
                           </li>
                           <li>
                              <p>使<a href="glossary.html#GUID-5C2A79F3-E089-41DC-B3F5-879FB6125CE5"><span class="xrefglossterm">导出转储文件</span></a>和要传输的数据文件可用于目标主机。
                              </p>
                              <p>您可以使用NFS来访问转储文件和当前数据库文件（而不是副本）。或者，您可以使用操作系统实用程序将这些文件复制到目标主机。</p>
                              <p>在此示例中，您将文件存储在目标主机的<code class="codeph">/tmp/transport_solaris/</code>目录中。您从文件的原始位置保留子目录结构;也就是说，数据文件存储为：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><code class="codeph">/tmp/transport_solaris/fin/fin01.dbf</code></p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">/tmp/transport_solaris/fin/fin02.dbf</code></p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">/tmp/transport_solaris/hr/hr01.dbf</code></p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">/tmp/transport_solaris/hr/hr02.dbf</code></p>
                                 </li>
                              </ul>
                           </li>
                           <li>
                              <p>启动RMAN并以<code class="codeph">TARGET</code>身份连接到<a href="glossary.html#GUID-4CDA2F90-4918-4357-AE32-313264940FFA"><span class="xrefglossterm">目标数据库</span></a> （而不是源数据库）。例如，以下命令使用被授予<code class="codeph">SYSBACKUP</code>权限的<code class="codeph">sbu</code>用户连接到目标数据库<code class="codeph">prod_dest</code> ：</p><pre class="oac_no_warn" dir="ltr">％rman RMAN&gt; CONNECT TARGET“sbu @ prod_dest AS SYSBACKUP”;</pre></li>
                           <li>
                              <p>执行<code class="codeph">CONVERT DATAFILE</code>命令将数据文件转换为目标主机的endian格式。
                              </p>
                              <p>在此示例中，您使用<code class="codeph">DB_FILE_NAME_CONVERT</code>来控制已转换数据文件的名称和位置。您还可以指定<code class="codeph">FROM</code> <code class="codeph">PLATFORM</code>子句。
                              </p><pre class="oac_no_warn" dir="ltr">RMAN&gt; CONVERT DATAFILE 2&gt;'/ tmp / transport = solaris / fin / fin01.dbf'，3&gt;'/ tmp / transport_solaris / fin / fin02.dbf'，4&gt;'/ tmp / transport_solaris / hr / hr01.dbf'，5 &gt;'/tmp/transport_solaris/hr/hr02.dbf'6&gt; DB_FILE_NAME_CONVERT 7&gt;'/ tmp / transport_solaris / fin'，'/ orahome / dbs / fin'，8&gt;'/ tmp / transport_solaris / hr'，'/ orahome / dbs / hr'9&gt;来自PLATFORM'Solaris [tm] OE（64位）';</pre><p>结果是<code class="codeph">/orahome/dbs/</code>目录中的一组转换数据文件，其名称如下：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><code class="codeph">/orahome/dbs/fin/fin01.dbf</code></p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">/orahome/dbs/fin/fin02.dbf</code></p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">/orahome/dbs/hr/hr01.dbf</code></p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">/orahome/dbs/hr/hr02.dbf</code></p>
                                 </li>
                              </ul>
                           </li>
                           <li>
                              <p>按照大纲的其余部分传输表空间：</p>
                              <ol type="a">
                                 <li>
                                    <p>使用DataPump Import实用程序将表空间插入新数据库。</p>
                                 </li>
                                 <li>
                                    <p>如果适用，将传输的表空间置于只读模式。</p>
                                 </li>
                              </ol>
                           </li>
                        </ol>
                        <div class="infoboxnotealso" id="GUID-1087F30E-647F-4A32-8F33-1BC1A0E5CAE8__GUID-83E39759-6B7D-4665-9BDA-9D17792A4F0E">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><a href="../rcmrf/CONVERT.html#RCMRF192" target="_blank"><span class="italic">Oracle数据库备份和恢复参考</span></a> ，了解<code class="codeph">CONVERT</code>命令的语法和语义</p>
                              </li>
                              <li>
                                 <p>有关可传输表空间的信息，请参见<a href="../admin/transporting-data.html#ADMIN11394" target="_blank"><span class="italic">“Oracle数据库管理员指南”</span></a></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="BRADV768"></a><div class="props_rev_3"><a id="GUID-EF05DB57-34E6-41AA-A44A-A0A91738DDB9" name="GUID-EF05DB57-34E6-41AA-A44A-A0A91738DDB9"></a><h3 id="BRADV-GUID-EF05DB57-34E6-41AA-A44A-A0A91738DDB9" class="sect3"><span class="enumeration_section">28.5</span>使用映像副本执行跨平台数据库转换</h3>
               <div>
                  <p>使用映像副本执行跨平台数据库转换时，可以转换源主机或目标主机上的数据文件。</p>
                  <p>本节包含：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="rman-transporting-data-across-platforms.html#GUID-B0178538-6E41-455D-8166-FBB1EDC5D198">在跨平台数据库转换之前检查数据库</a></p>
                     </li>
                     <li>
                        <p><a href="rman-transporting-data-across-platforms.html#GUID-E681FF6F-0927-4ED5-BF64-73926C4121DC">传输数据库时在源主机上转换数据文件</a></p>
                     </li>
                     <li>
                        <p><a href="rman-transporting-data-across-platforms.html#GUID-D8EF7402-2AEE-4FB3-8B84-5BC081333005">传输数据库时在目标主机上转换数据文件</a></p>
                     </li>
                  </ul>
               </div><a id="BRADV476"></a><a id="BRADV477"></a><a id="BRADV89986"></a><div class="props_rev_3"><a id="GUID-B0178538-6E41-455D-8166-FBB1EDC5D198" name="GUID-B0178538-6E41-455D-8166-FBB1EDC5D198"></a><h4 id="BRADV-GUID-B0178538-6E41-455D-8166-FBB1EDC5D198" class="sect4"><span class="enumeration_section">28.5.1</span>跨平台数据库转换前检查数据库</h4>
                  <div>
                     <div class="section">
                        <p>如<span class="q">“ <a href="rman-transporting-data-across-platforms.html#GUID-D4C86E36-8EF8-489D-84CE-B8F045C8AB20">使用映像副本进行跨平台数据传输概述</a> ”中所述</span> ，您可以使用RMAN <code class="codeph">CONVERT DATABASE</code>命令自动将整个数据库从一个平台复制到另一个平台。您可以在源或目标平台上转换数据库数据文件。
                        </p>
                        <p>在转换数据库之前，请参阅<a href="../rcmrf/CONVERT.html#RCMRF192" target="_blank"><span class="italic">Oracle数据库备份和恢复参考中</span></a>描述的<code class="codeph">CONVERT DATABASE</code>命令先决条件列表<a href="../rcmrf/CONVERT.html#RCMRF192" target="_blank"><span class="italic">。</span></a> 在尝试本节中的步骤之前，请确认您满足所有这些先决条件。
                        </p>
                        <p>一个先决条件是源平台和目标平台必须共享相同的endian格式。例如，您可以将数据库从Microsoft Windows传输到Linux for x86（小端），或者从HP-UX传输到AIX（都是big-endian），但不能从HP-UX传输到Linux for x86（big-endian）到小端）。</p>
                        <div class="infoboxnote" id="GUID-B0178538-6E41-455D-8166-FBB1EDC5D198__GUID-ACB5CA21-9EFB-4166-ADC2-B7F8826814FA">
                           <p class="notep1">注意：</p>
                           <p>如果由于平台不共享字节序格式而无法使用<code class="codeph">CONVERT DATABASE</code>命令，则可以在目标平台上创建新数据库，然后使用跨平台可传输表空间来复制数据。
                           </p>
                        </div>
                        <p>传输整个数据库时，请注意某些文件需要RMAN转换以确保与目标平台的兼容性。即使源和目标平台的字节序格式相同，也不能简单地将这些文件从源复制到目标系统。以下类型的文件需要RMAN转换：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p>包含还原段的任何文件</p>
                           </li>
                           <li>
                              <p>包含自动段空间管理（ASSM）段标头的任何文件，这些文件正在传输到HP Tru64平台或从HP Tru64平台传输</p>
                           </li>
                        </ul>
                        <div class="infoboxnote" id="GUID-B0178538-6E41-455D-8166-FBB1EDC5D198__GUID-5FFC81AD-2520-4359-B92E-E11C2D532CAB">
                           <p class="notep1">注意：</p>
                           <p>转换到Tru64 UNIX平台或从Tru64 UNIX平台转换时，即使数据库使用相同的endian格式，也必须使用<code class="codeph">CONVERT</code>命令转换具有自动段空间管理（ASSM）标头的数据文件。有关识别包含撤消数据或ASSM标头的数据文件的信息，请参阅My Oracle Support说明732053.1。
                           </p>
                        </div>
                        <p>默认情况下， <code class="codeph">CONVERT DATABASE</code>命令使用RMAN转换处理数据库中的所有数据文件。RMAN转换将文件从一个位置复制到另一个位置，即使它没有对文件进行任何更改。如果您有其他首选方法来复制那些不需要RMAN转换的文件，则可以使用<code class="codeph">CONVERT DATABASE</code>命令的<code class="codeph">SKIP UNNECESSARY DATAFILES</code>选项。如果选择此选项，则<code class="codeph">CONVERT DATABASE</code>命令仅处理需要转换的文件。所有其他文件必须可供用户访问或从源复制到<a href="glossary.html#GUID-4CDA2F90-4918-4357-AE32-313264940FFA"><span class="xrefglossterm">目标数据库</span></a> 。
                        </p>
                        <p>无论是在源主机还是目标主机上执行数据文件转换，都必须在<a href="glossary.html#GUID-609A4BFA-A852-4459-AD52-05C49212753A"><span class="xrefglossterm">源数据库</span></a>以只读模式打开时复制文件。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-B0178538-6E41-455D-8166-FBB1EDC5D198__GUID-8EFC82DB-39FA-49E7-B96D-4734E3A8D7B9">在跨平台转换之前检查数据库：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>在<a href="glossary.html#GUID-609A4BFA-A852-4459-AD52-05C49212753A"><span class="xrefglossterm">源数据库上</span></a> ，以具有<code class="codeph">SYSDBA</code>或<code class="codeph">SYSBACKUP</code>权限的用户身份启动SQL * Plus会话。</span></li>
                        <li class="stepexpand"><span>以只读模式打开数据库。</span><div><pre class="oac_no_warn" dir="ltr">关机立即启动安装更改数据库打开只读;</pre></div>
                        </li>
                        <li class="stepexpand"><span>确保在SQL * Plus中启用了服务器输出。</span><div>
                              <p>例如，输入以下SQL * Plus命令：</p><pre class="oac_no_warn" dir="ltr">SET SERVEROUTPUT ON</pre></div>
                        </li>
                        <li class="stepexpand"><span>执行<code class="codeph">DBMS_TDB.CHECK_DB</code>函数。</span><div>
                              <p>此检查可确保没有任何条件阻止数据库的传输，例如错误的兼容性设置，不确定或活动的事务，或源平台和目标平台之间的不兼容的字节序格式。</p>
                              <p>您可以不带参数调用<code class="codeph">CHECK_DB</code> ，以查看源数据库中的条件是否阻止传输。您也可以使用<a href="rman-transporting-data-across-platforms.html#GUID-B0178538-6E41-455D-8166-FBB1EDC5D198__CHDDHABI" title="该表描述了DBMS_TDB.CHECK_DB函数的参数。">表28-1中</a>显示的参数调用此函数。
                              </p>
                              <div class="tblformal" id="GUID-B0178538-6E41-455D-8166-FBB1EDC5D198__CHDDHABI">
                                 <p class="titleintable">表28-1 CHECK_DB函数参数</p>
                                 <table cellpadding="4" cellspacing="0" class="Formal" title="CHECK_DB函数参数" width="90%" border="1" summary="This table describes the Parameters of DBMS_TDB.CHECK_DB function." frame="hsides" rules="rows">
                                    <thead>
                                       <tr align="left" valign="top">
                                          <th align="left" valign="bottom" width="32%" id="d127931e2056">参数</th>
                                          <th align="left" valign="bottom" width="68%" id="d127931e2059">描述</th>
                                       </tr>
                                    </thead>
                                    <tbody>
                                       <tr align="left" valign="top">
                                          <td align="left" valign="top" width="32%" id="d127931e2064" headers="d127931e2056 ">
                                             <p><code class="codeph">target_platform_name</code></p>
                                          </td>
                                          <td align="left" valign="top" width="68%" headers="d127931e2064 d127931e2059 ">
                                             <p>出现在<a href="../refrn/V-DB_TRANSPORTABLE_PLATFORM.html#REFRN30376" target="_blank"><code class="codeph">V$DB_TRANSPORTABLE_PLATFORM</code></a>视图中的目标平台的名称。
                                             </p>
                                             <p>此参数是可选的，但在使用<code class="codeph">skip_option</code>参数时是必需的。如果省略，则假定目标平台与源平台兼容，并且仅测试与平台兼容性无关的条件。
                                             </p>
                                          </td>
                                       </tr>
                                       <tr align="left" valign="top">
                                          <td align="left" valign="top" width="32%" id="d127931e2082" headers="d127931e2056 ">
                                             <p><code class="codeph">skip_option</code></p>
                                          </td>
                                          <td align="left" valign="top" width="68%" headers="d127931e2082 d127931e2059 ">
                                             <p>指定在检查是否可以传输数据库时要跳过的数据库的哪些部分（如果有）。支持的值（ <code class="codeph">NUMBER</code>类型）是：</p>
                                             <ul style="list-style-type:disc">
                                                <li>
                                                   <p><code class="codeph">SKIP_NONE</code> （或<code class="codeph">0</code> ），用于检查所有表空间</p>
                                                </li>
                                                <li>
                                                   <p><code class="codeph">SKIP_OFFLINE</code> （或<code class="codeph">2</code> ），它跳过检查脱机表空间中的数据文件</p>
                                                </li>
                                                <li>
                                                   <p><code class="codeph">SKIP_READONLY</code> （或<code class="codeph">3</code> ），它跳过检查只读表空间中的数据文件</p>
                                                </li>
                                             </ul>
                                          </td>
                                       </tr>
                                    </tbody>
                                 </table>
                              </div>
                              <!-- class="inftblhruleinformal" -->
                              <p>以下示例说明在32位Linux平台上执行<code class="codeph">CHECK_DB</code>以将数据库传输到32位Windows，从而跳过只读表空间。
                              </p><pre class="oac_no_warn" dir="ltr">DECLARE db_ready BOOLEAN; BEGIN db_ready：= DBMS_TDB.CHECK_DB（'Microsoft Windows IA（32位）'，DBMS_TDB.SKIP_READONLY）;结束; / PL / SQL过程成功完成。
</pre><p>如果未显示警告，或者<code class="codeph">DBMS_TDB.CHECK_DB</code>返回<code class="codeph">TRUE</code> ，则可以传输数据库。继续第6步。
                              </p>
                              <p>如果出现警告，或者<code class="codeph">DBMS_TDB.CHECK_DB</code>返回<code class="codeph">FALSE</code> ，则您当前无法传输数据库。继续第5步。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>检查输出以了解无法传输数据库的原因，如果可能，请修复问题，然后返回到步骤4。</span><div>
                              <div class="infoboxnotealso" id="GUID-B0178538-6E41-455D-8166-FBB1EDC5D198__GUID-599DD40C-EC09-4B97-873C-0A85EE963AC6">
                                 <p class="notep1">也可以看看：</p>
                                 <p>有关<code class="codeph">DBMS_TDB</code>信息，请<code class="codeph">DBMS_TDB</code> <a href="../arpls/DBMS_TDB.html#ARPLS-GUID-E36C9358-B1BA-4952-9CD2-2E5AB1FFDAA6" target="_blank"><span class="italic">Oracle Database PL / SQL包和类型参考</span></a></p>
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>执行<code class="codeph">DBMS_TDB.CHECK_EXTERNAL</code>函数以标识任何外部表，目录或BFILE。RMAN无法自动传输这些文件，因此您必须手动复制文件并重新创建数据库目录。</span><div>
                              <p>以下示例显示如何调用<code class="codeph">DBMS_TDB.CHECK_EXTERNAL</code>函数。
                              </p><pre class="oac_no_warn" dir="ltr">DECLARE外部BOOLEAN;外部的BEGIN / *值被忽略，但SERVEROUTPUT设置为ON * dbms_tdb.check_external在控制台上显示外部对象的报告* / external：= DBMS_TDB.CHECK_EXTERNAL;结束; /</pre><p>如果不存在外部对象，则该过程完成且不输出。但是，如果存在外部对象，则输出类似于以下内容：</p><pre class="oac_no_warn" dir="ltr">数据库中存在以下外部表：SH.SALES_TRANSACTIONS_EXT数据库中存在以下目录：SYS.DATA_PUMP_DIR，SYS.MEDIA_DIR，SYS.DATA_FILE_DIR，SYS.LOG_FILE_DIR数据库中存在以下BFILE：PM.PRINT_MEDIA PL / SQL过程成功完成。</pre></div>
                        </li>
                     </ol>
                  </div>
               </div><a id="BRADV480"></a><a id="BRADV89987"></a><div class="props_rev_3"><a id="GUID-E681FF6F-0927-4ED5-BF64-73926C4121DC" name="GUID-E681FF6F-0927-4ED5-BF64-73926C4121DC"></a><h4 id="BRADV-GUID-E681FF6F-0927-4ED5-BF64-73926C4121DC" class="sect4"><span class="enumeration_section">28.5.2</span>传输数据库时在源主机上转换数据文件</h4>
                  <div>
                     <div class="section">
                        <p>传输整个数据库时，必须重新格式化某些类型的块（如还原段中的块）以确保与目标平台的兼容性。即使源和目标平台的字节序格式相同，某些数据文件也必须经过转换过程，并且不能简单地从一个平台复制到另一个平台。</p>
                        <p>必须转换包含撤消信息的数据文件和HP Tru64平台的数据文件。默认情况下，执行<code class="codeph">CONVERT DATABASE</code>命令时会转换所有数据文件。但是，如果在<code class="codeph">CONVERT DATABASE</code>命令中使用<code class="codeph">SKIP UNNECESSARY DATAFILES</code>则会<code class="codeph">CONVERT DATABASE</code>具有还原段的数据文件和来自HP Tru64平台的数据文件。所有其他数据文件不需要转换，可以使用FTP，操作系统复制命令或其他某种机制将其复制到新数据库。
                        </p>
                        <div class="infoboxnotealso" id="GUID-E681FF6F-0927-4ED5-BF64-73926C4121DC__GUID-35CCC680-5744-442A-9055-6B1F98A3DBA1">
                           <p class="notep1">也可以看看：</p>
                           <p><span class="q">“ <a href="rman-transporting-data-across-platforms.html#GUID-C91F21C3-C3C0-43B5-9D9D-2F9408F8808D">使用映像副本进行数据库转换概述</a> ”</span></p>
                        </div>
                        <p>本节假定您已满足所有<code class="codeph">CONVERT DATABASE</code>先决条件，并按照<span class="q">“ <a href="rman-transporting-data-across-platforms.html#GUID-B0178538-6E41-455D-8166-FBB1EDC5D198">在跨平台数据库转换之前检查数据库</a> ”中</span>的步骤进行操作。此过程的目标是将源主机上的数据文件格式转换为跨平台数据库传输的一部分。
                        </p>
                        <p>假设您要将在Solaris上运行的数据库转换为在Windows上运行的数据库。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-E681FF6F-0927-4ED5-BF64-73926C4121DC__GUID-DF707AC3-8D16-43DF-9A13-CB67627AA4E1">要在源主机上转换数据库：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>以只读模式打开<a href="glossary.html#GUID-609A4BFA-A852-4459-AD52-05C49212753A"><span class="xrefglossterm">源数据库</span></a> 。</span><div><pre class="oac_no_warn" dir="ltr">立即关闭;启动安装; ALTER DATABASE OPEN READ ONLY;</pre></div>
                        </li>
                        <li class="stepexpand"><span>启动RMAN并按照<code class="codeph">TARGET</code>连接到源数据库，如<span class="q">“ <a href="starting-interacting-with-rman-client.html#GUID-E07231B2-F213-4F8F-8D02-E410A6DAE94C" title="您可以从RMAN客户端或操作系统命令行创建数据库连接。可以使用密码文件或操作系统身份验证对这些数据库连接进行身份验证。">使用RMAN建立数据库连接</a> ”中所述</span> 。</span></li>
                        <li class="stepexpand" id="GUID-E681FF6F-0927-4ED5-BF64-73926C4121DC__CHDBBAEJ"><span>运行<code class="codeph">CONVERT</code> <code class="codeph">DATABASE</code>命令。</span><div>
                              <p>以下示例显示<code class="codeph">CONVERT DATABASE</code>命令（包括示例输出）。<code class="codeph">TRANSPORT SCRIPT</code>参数指定可用于创建新数据库的生成的SQL脚本的位置。<code class="codeph">TO PLATFORM</code>参数指示<a href="glossary.html#GUID-4CDA2F90-4918-4357-AE32-313264940FFA"><span class="xrefglossterm">目标数据库</span></a>的平台。<code class="codeph">DB_FILE_NAME_CONVERT</code>参数指定生成的数据文件的命名方案。
                              </p><pre class="oac_no_warn" dir="ltr">RMAN&gt; CONVERT DATABASE 2&gt; NEW DATABASE'newdb'3&gt; TRANSPORT SCRIPT' / tmp / transferdb / transportscript.sql'4&gt; TO PLATFORM'Microsoft Windows IA（32-bit）'5&gt; DB_FILE_NAME_CONVERT'/ disk1 / oracle / dbs' '/ TMP / convertdb';使用通道ORA_DISK_1在数据库中找到外部表SH.SALES_TRANSACTIONS_EXT，在25-NOV-13的源处开始转换。。。在数据库中找到的目录SYS.ORACLE_HOME在数据库中找到的数据库目录SYS.LOG_FILE_DIR中的目录SYS.ORACLE_BASE。。。在数据库中找到的BFILE PM.PRINT_MEDIA在密码文件中找到具有SYSDBA和SYSOPER特权的用户SYS，在密码文件通道ORA_DISK_1中找到具有SYSBACKUP特权的用户SBU：起始数据文件转换输入数据文件fno = 00001 name = / disk1 / oracle / dbs / tbs_01。 f转换datafile = / tmp / convertdb / tbs_01.f通道ORA_DISK_1：数据文件转换完成，经过时间：00：00：15通道ORA_DISK_1：启动数据文件转换输入数据文件fno = 00002 name = / disk1 / oracle / dbs / tbs_ax1.f转换datafile = / tmp / convertdb / tbs_ax1.f通道ORA_DISK_1：数据文件转换完成，已用时间：00：00：03。。。通道ORA_DISK_1：启动数据文件转换输入数据文件fno = 00016 name = / disk1 / oracle / dbs / tbs_52.f转换后的datafile = / tmp / convertdb / tbs_52.f通道ORA_DISK_1：数据文件转换完成，已用时间：00：00：01编辑<span class="bold">init.ora文件init_00gb3vfv_1_0.ora。</span> 此PFILE将用于在目标平台上创建数据库在目标平台上运行<span class="bold">SQL脚本/tmp/convertdb/transportscript.sql</span>以创建数据库要重新编译所有PL / SQL模块，请在目标上运行utlirp.sql和utlrp.sql platform要更改内部数据库标识符，请在25-NOV-13的源处使用DBNEWID Utility完成转换</pre></div>
                        </li>
                        <li class="stepexpand"><span><code class="codeph">CONVERT</code> <code class="codeph">DATABASE</code>完成后，您可以再次打开源数据库读/写。</span></li>
                        <li class="stepexpand"><span>将<code class="codeph">CONVERT DATABASE</code>生成的数据文件移动到目标主机上的所需位置。</span><div>
                              <p>在步骤<a href="rman-transporting-data-across-platforms.html#GUID-E681FF6F-0927-4ED5-BF64-73926C4121DC__CHDBBAEJ">3中</a> ，该命令在源主机上的<code class="codeph">/tmp/convertdb/</code>目录中创建文件。将这些文件移动到目标主机上将包含目标数据库文件的目录。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>如果目标主机上的数据文件路径不同，则编辑传输脚本以引用新数据文件位置。</span></li>
                        <li class="stepexpand"><span>如有必要，请编辑初始化参数文件以更改目标数据库的任何设置。</span><div>
                              <p>当数据库移动到目标平台时，您必须在初始化参数文件的顶部编辑多个条目。例如，初始化参数文件可能如下所示：</p><pre class="oac_no_warn" dir="ltr">＃请更改以下参数的值：control_files =“/ tmp / convertdb / cf_D-NEWDBT_id-1778429277_00gb9u2s”service_names =“NEWDBT.example.com”db_recovery_file_dest =“/ tmp / convertdb / orcva”db_recovery_file_dest_size = 10737418240 instance_name =“NEWDBT “db_name =”NEWDBT“plsql_native_library_dir =”/ tmp / convertdb / plsqlnld1“</pre></div>
                        </li>
                        <li class="stepexpand"><span>如有必要，编辑传输脚本以使用转换后的数据文件的新名称。</span><div>
                              <p>在步骤<a href="rman-transporting-data-across-platforms.html#GUID-E681FF6F-0927-4ED5-BF64-73926C4121DC__CHDBBAEJ">3</a>的示例中，传输脚本名为<code class="codeph">/tmp/convertdb/transportscript.sql</code> 。您在<a href="glossary.html#GUID-45F2720B-CAFE-4120-8D54-05F435852FA3"><span class="xrefglossterm">目标主机</span></a>上运行此脚本以创建数据库。因此，您必须使用数据文件的正确名称编辑此脚本。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>在目标主机上，启动SQL * Plus并使用操作系统身份验证以<code class="codeph">SYSDBA</code>或<code class="codeph">SYSBACKUP</code>身份连接到目标数据库实例。</span><div>
                              <p>例如，连接如下：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; CONNECT / AS SYSBACKUP</pre><p>如果选择不使用操作系统身份验证，则可以创建<a href="glossary.html#GUID-AFB3C6E2-4C77-460F-A64D-A980EBF628EB"><span class="xrefglossterm">密码文件</span></a> ，然后使用用户名和密码进行连接。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>在SQL * Plus中执行传输脚本以在目标主机上创建新数据库。</span><div><pre class="oac_no_warn" dir="ltr">SQL&gt; @transportscript</pre></div>
                        </li>
                     </ol>
                     <div class="section">
                        <p>传输脚本完成后，将完成新数据库的创建。</p>
                        <div class="infoboxnotealso" id="GUID-E681FF6F-0927-4ED5-BF64-73926C4121DC__GUID-160618C8-3C05-4CD7-9A76-117B73B2B602">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="../admin/getting-started-with-database-administration.html#ADMIN11046" target="_blank"><span class="italic">“Oracle数据库管理员指南”</span></a> ，了解有关操作系统身份验证和密码文件身份验</p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="BRADV89988"></a><div class="props_rev_3"><a id="GUID-D8EF7402-2AEE-4FB3-8B84-5BC081333005" name="GUID-D8EF7402-2AEE-4FB3-8B84-5BC081333005"></a><h4 id="BRADV-GUID-D8EF7402-2AEE-4FB3-8B84-5BC081333005" class="sect4"><span class="enumeration_section">28.5.3</span>传输数据库时在目标主机上转换数据文件</h4>
                  <div>
                     <div class="section">
                        <p>本节假定您已满足所有<code class="codeph">CONVERT DATABASE</code>命令先决条件，并按照<span class="q">“ <a href="rman-transporting-data-across-platforms.html#GUID-B0178538-6E41-455D-8166-FBB1EDC5D198">在跨平台数据库转换之前检查数据库</a> ”中</span>的步骤进行操作。此过程的目标是将目标主机上的数据文件格式转换为跨平台数据库传输的一部分。
                        </p>
                        <div class="infoboxnotealso" id="GUID-D8EF7402-2AEE-4FB3-8B84-5BC081333005__GUID-0CB3A329-6453-4D34-B249-CF6F00EF2F68">
                           <p class="notep1">也可以看看：</p>
                           <p><span class="q">“ <a href="rman-transporting-data-across-platforms.html#GUID-C91F21C3-C3C0-43B5-9D9D-2F9408F8808D">使用映像副本进行数据库转换概述</a> ”</span></p>
                        </div>
                        <p>在以下阶段执行数据文件转换：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li><span><a href="rman-transporting-data-across-platforms.html#GUID-017FDD9B-3421-4A07-8FC2-67CAAA9BDA2E">在源主机上执行初步数据文件转换步骤</a></span></li>
                        <li><span><a href="rman-transporting-data-across-platforms.html#GUID-4D513D2F-C544-4DE3-85BF-F6A5CE959DB9">在目标主机上运行转换脚本</a></span></li>
                     </ol>
                  </div><a id="BRADV482"></a><a id="BRADV89989"></a><div class="props_rev_3"><a id="GUID-017FDD9B-3421-4A07-8FC2-67CAAA9BDA2E" name="GUID-017FDD9B-3421-4A07-8FC2-67CAAA9BDA2E"></a><h5 id="BRADV-GUID-017FDD9B-3421-4A07-8FC2-67CAAA9BDA2E" class="sect5"><span class="enumeration_section">28.5.3.1</span>在源主机上执行初步数据文件转换步骤</h5>
                     <div>
                        <div class="section">
                           <p>在此过程中，您将在源主机上执行<code class="codeph">CONVERT DATABASE</code>命令。此命令生成初始化参数文件和脚本，您可以编辑这些文件和脚本以在目标主机上使用。您还将未转换的数据文件从源主机复制到目标主机。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-017FDD9B-3421-4A07-8FC2-67CAAA9BDA2E__GUID-E0A8640A-8486-4EC5-818B-D578F4CA0159">要在源主机上执行初步数据文件转换步骤：</p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>确保数据库以只读模式打开。</span></li>
                           <li class="stepexpand"><span>启动RMAN并以<code class="codeph">TARGET</code>身份连接到<span class="italic">源</span>数据库，如<span class="q">“ <a href="starting-interacting-with-rman-client.html#GUID-E07231B2-F213-4F8F-8D02-E410A6DAE94C" title="您可以从RMAN客户端或操作系统命令行创建数据库连接。可以使用密码文件或操作系统身份验证对这些数据库连接进行身份验证。">使用RMAN建立数据库连接</a> ”中所述</span> 。</span></li>
                           <li class="stepexpand"><span>运行<code class="codeph">CONVERT</code> <code class="codeph">DATABASE ON DESTINATION PLATFORM</code>命令。</span><div>
                                 <p>以下示例显示了一个示例<code class="codeph">CONVERT DATABASE</code>命令（包括示例输出）。<code class="codeph">ON DESTINATION PLATFORM</code>参数指定数据文件所需的任何<code class="codeph">CONVERT</code>命令都在目标平台而不是源平台上执行。<code class="codeph">FORMAT</code>参数指定生成的文件的命名方案。
                                 </p><pre class="oac_no_warn" dir="ltr">RMAN&gt; CONVERT DATABASE 2&gt; ON DESTINATION PLATFORM 3&gt; CONVERT SCRIPT'/ tmp / convertdb / convertedcript-target'4&gt; TRANSPORT SCRIPT'/ tmp / convertdb / transportscript-target'5&gt; NEW DATABASE'newdbt'6&gt; FORMAT'/ tmp / convertdb /％U';使用目标数据库控制文件而不是恢复目录分配通道在28-JAN-13的源处开始转换：ORA_DISK_1通道ORA_DISK_1：sid = 39 devtype = DISK外部表SH.SALES_TRANSACTIONS_EXT在数据库中找到。。。在数据库中找到的目录SYS.ORACLE_HOME在数据库中找到的数据库目录SYS.LOG_FILE_DIR中的目录SYS.ORACLE_BASE。。。在数据库中找到的BFILE PM.PRINT_MEDIA在密码文件中找到具有SYSDBA和SYSOPER权限的用户SYS在密码文件通道ORA_DISK_1中找到具有SYSBACKUP权限的用户SBU：开始检查数据文件输入数据文件fno = 00001 name = / disk1 / oracle / dbs / tbs_01 .f channel ORA_DISK_1：数据文件检查完成，经过时间：00：00：00通道ORA_DISK_1：开始检查数据文件输入数据文件fno = 00002名称= / disk1 / oracle / dbs / tbs_ax1.f通道ORA_DISK_1：数据文件检查完成，经过时间：00：00：00通道ORA_DISK_1：开始检查数据文件输入数据文件fno = 00017名称= / disk1 / oracle / dbs / tbs_03.f通道ORA_DISK_1：数据文件检查完成，经过时间：00：00：00。。。通道ORA_DISK_1：开始检查数据文件输入数据文件fno = 00015名称= / disk1 / oracle / dbs / tbs_51.f通道ORA_DISK_1：数据文件检查完成，经过时间：00：00：00通道ORA_DISK_1：开始检查数据文件输入数据文件fno = 00016 name = / disk1 / oracle / dbs / tbs_52.f channel ORA_DISK_1：数据文件检查完成，已用时间：00：00：00编辑init.ora文件/tmp/convertdb/init_00gb9u2s_1_0.ora。此PFILE将用于在目标平台上创建数据库在目标平台上运行SQL脚本/ tmp / convertdb / transportscript-target以在目标平台上创建数据库运行RMAN脚本/ tmp / convertdb / convertedcript-target以转换数据文件以重新编译所有PL / SQL模块，在目标平台上运行utlirp.sql和utlrp.sql要更改内部数据库标识符，请使用DBNEWID实用程序完成转换，源自28-JAN-13启动控制文件自动备份，28-JAN-13件手柄= / disk2 / oracle / backups / c-1678658224-20131202-02 comment = NONE完成控制文件自动备份28-JAN-13</pre><p>上一个命令为每个要转换的数据文件创建一个传输脚本，一个新数据库的初始化参数文件和一个包含RMAN <code class="codeph">CONVERT DATAFILE</code>命令的转换脚本。
                                 </p>
                                 <div class="infoboxnote" id="GUID-017FDD9B-3421-4A07-8FC2-67CAAA9BDA2E__GUID-B2388606-AEE4-4C6C-9716-D8191B88432A">
                                    <p class="notep1">注意：</p>
                                    <p><code class="codeph">CONVERT</code> <code class="codeph">DATABASE</code> <code class="codeph">ON</code> <code class="codeph">DESTINATION</code> <code class="codeph">PLATFORM</code> <span class="italic">不</span>产生转换后的数据文件的副本。该命令仅创建脚本。
                                    </p>
                                 </div>
                              </div>
                           </li>
                           <li class="stepexpand"><span>使用操作系统实用程序将以下文件复制到目标主机上的临时位置：</span><div>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p>要转换的数据文件</p>
                                    </li>
                                    <li>
                                       <p>转换脚本</p>
                                    </li>
                                    <li>
                                       <p>传输脚本</p>
                                    </li>
                                    <li>
                                       <p>目标数据库的初始化文件</p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li class="stepexpand"><span>使源数据库可读/写。</span></li>
                        </ol>
                     </div>
                  </div><a id="BRADV484"></a><a id="BRADV89990"></a><div class="props_rev_3"><a id="GUID-4D513D2F-C544-4DE3-85BF-F6A5CE959DB9" name="GUID-4D513D2F-C544-4DE3-85BF-F6A5CE959DB9"></a><h5 id="BRADV-GUID-4D513D2F-C544-4DE3-85BF-F6A5CE959DB9" class="sect5"><span class="enumeration_section">28.5.3.2</span>在目标主机上运行转换脚本</h5>
                     <div>
                        <div class="section">
                           <p>本节介绍如何使用上一节中创建的脚本转换目标主机上的数据文件并完成传输过程。</p>
                           <p>在上一阶段中创建的转换脚本使用<a href="glossary.html#GUID-609A4BFA-A852-4459-AD52-05C49212753A"><span class="xrefglossterm">源数据库</span></a>文件的原始数据文件名。<code class="codeph">FORMAT</code>参数指定使用<code class="codeph">CONVERT DATABASE</code>命令的<code class="codeph">FORMAT</code>或<code class="codeph">DB_FILE_NAME_CONVERT</code>参数生成的名称。
                           </p>
                           <p>如果可以从具有相同路径名的目标主机访问源数据库的数据文件，则只要源数据库是只读的，您就可以在目标主机上运行转换脚本而不进行任何更改。例如，如果源主机和目标主机都使用NFS来挂载包含源数据文件的磁盘，并且如果两个主机的挂载点都是<code class="codeph">/fs1/dbs/</code> ，则不需要编辑。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-4D513D2F-C544-4DE3-85BF-F6A5CE959DB9__GUID-C42134E1-7D96-4939-9036-9301BC640A63">要在目标主机上运行转换脚本：</p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>如有必要，请编辑转换脚本。</span><div>
                                 <p>在脚本中，每个要转换的数据文件都存在一个<code class="codeph">CONVERT</code> <code class="codeph">DATAFILE</code>命令。转换脚本必须指示未转换的数据文件的当前临时文件名和转换的数据文件的输出文件名。典型的转换脚本如下所示：</p><pre class="oac_no_warn" dir="ltr">运行{转换平台'Linux IA（32位）'并行10数据文件'/disk1/oracle/dbs/tbs_01.f'FORMAT'/ tmp / convertdb / data_D-TV_I-1778429277_TS-SYSTEM_FNO-1_7qgb9u2s'DATAFILE'/ disk1 /oracle/dbs/tbs_ax1.f'FORMAT'/ tmp / convertdb / data_D-TV_I-1778429277_TS-SYSAUX_FNO-2_7rgb9u2s'DATAFILE'/disk1/oracle/dbs/tbs_03.f'FORMAT'/ tmp / convertdb / data_D-TV_I- 1778429277_TS-SYSTEM_FNO-17_7sgb9u2s'DATAFILE'/disk1/oracle/dbs/tbs_51.f'FORMAT'/ tmp / convertdb / data_D-TV_I-1778429277_TS-TBS_5_FNO-15_8egb9u2u'DATAFILE'/disk1/oracle/dbs/tbs_52.f'FORMAT '/ TMP / convertdb / DATA_D-TV_I-1778429277_TS-TBS_5_FNO-16_8fgb9u2u'; }</pre><p>编辑convert脚本中的每个<code class="codeph">DATAFILE</code>命令，以指定每个数据文件的临时位置作为输入。另外，编辑每个命令的<code class="codeph">FORMAT</code>参数以指定所传输数据库的数据文件的所需最终位置。
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>如有必要，请编辑目标主机上的初始化参数文件以更改<a href="glossary.html#GUID-4CDA2F90-4918-4357-AE32-313264940FFA"><span class="xrefglossterm">目标数据库的</span></a>设置。</span><div>
                                 <p>您必须在初始化参数文件的顶部编辑多个条目。例如，初始化参数文件可能如下所示：</p><pre class="oac_no_warn" dir="ltr">＃请更改以下参数的值：control_files =“/ tmp / convertdb / cf_D-NEWDBT_id-1778429277_00gb9u2s”db_recovery_file_dest =“/ tmp / convertdb / orcva”db_recovery_file_dest_size = 10737418240 instance_name =“NEWDBT”service_names =“NEWDBT.example.com “plsql_native_library_dir =”/ tmp / convertdb / plsqlnld1“db_name =”NEWDBT“</pre></div>
                           </li>
                           <li class="stepexpand"><span>在目标主机上，使用SQL * Plus以<code class="codeph">NOMOUNT</code>模式启动数据库实例。</span><div>
                                 <p>指定在上一步中复制的初始化参数文件。例如，输入以下命令：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; STARTUP NOMOUNT PFILE ='/ tmp / init_convertdb_00i2gj63_1_0.ora'</pre></div>
                           </li>
                           <li class="stepexpand"><span>启动RMAN并以<code class="codeph">TARGET</code>身份连接到目标数据库（而不是源数据库）。例如，输入以下命令：</span><div><pre class="oac_no_warn" dir="ltr">％rman RMAN&gt; CONNECT TARGET“sbu @ prod_dest AS SYSBACKUP”;</pre></div>
                           </li>
                           <li class="stepexpand"><span>在RMAN提示符下运行转换脚本。例如，输入以下命令：</span><div><pre class="oac_no_warn" dir="ltr">RMAN&gt; @ / tmp / convertdb / convertedcript-target</pre></div>
                           </li>
                           <li class="stepexpand"><span>关闭数据库实例。</span><div>
                                 <p>此步骤是必需的，因为必须执行的传输脚本包括<code class="codeph">STARTUP NOMOUNT</code>命令。
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>如有必要，编辑传输脚本以使用转换后的数据文件的新名称。</span><div>
                                 <p>在步骤<a href="rman-transporting-data-across-platforms.html#GUID-E681FF6F-0927-4ED5-BF64-73926C4121DC__CHDBBAEJ">3</a>的示例中，传输脚本是<code class="codeph">/tmp/convertdb/transportscript.sql</code> 。您在目标主机上运行此脚本以创建数据库。因此，您必须使用数据文件的正确名称编辑此脚本。
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>在SQL * Plus中执行传输脚本。</span><div>
                                 <p>例如，在目标主机上创建新数据库，如下所示：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; @ / tmp / convertdb / transportscript</pre></div>
                           </li>
                        </ol>
                        <div class="section">
                           <p>传输脚本完成后，将创建目标数据库。</p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div>
            </div><a id="BRADV861"></a><a id="BRADV723"></a><a id="BRADV709"></a><a id="BRADV708"></a><div class="props_rev_3"><a id="GUID-4644069A-7849-49F2-A1BF-2193EBAFFDBD" name="GUID-4644069A-7849-49F2-A1BF-2193EBAFFDBD"></a><h3 id="BRADV-GUID-4644069A-7849-49F2-A1BF-2193EBAFFDBD" class="sect3"><span class="enumeration_section">28.6</span>使用备份集进行跨平台数据传输概述</h3>
               <div>
                  <p>RMAN可以使用备份集跨平台传输数据库，数据文件和表空间。使用备份集执行跨平台数据传输使您可以使用块压缩来减小备份的大小。这可以提高备份性能并减少通过网络传输备份所需的时间。</p>
                  <div class="infoboxnote" id="GUID-4644069A-7849-49F2-A1BF-2193EBAFFDBD__GUID-223FC536-BAE0-486C-A858-2F4E2ACD1F38">
                     <p class="notep1">注意：</p>
                     <p>要使用备份集执行跨平台数据传输，目标数据库的版本必须是Oracle Database 12 <span class="italic">c</span>第1版（12.1）或更高版本。
                     </p>
                  </div>
                  <p>将整个数据库传输到其他平台时，源平台和目标平台必须使用相同的endian格式。但是，用户表空间可以传输到目标平台，该平台使用源平台的不同端格式。</p>
                  <p>在<a href="glossary.html#GUID-609A4BFA-A852-4459-AD52-05C49212753A"><span class="xrefglossterm">源数据库上</span></a> ，您可以创建需要传输的数据的<a href="glossary.html#GUID-2E1D5532-31E0-4B78-AAF9-DEC27CC3927B"><span class="xrefglossterm">跨平台备份</span></a> 。跨平台备份是RMAN备份，可以在与源平台不同的目标平台上进行还原。在<a href="glossary.html#GUID-4CDA2F90-4918-4357-AE32-313264940FFA"><span class="xrefglossterm">目标数据库上</span></a> ，还原并恢复<a href="glossary.html#GUID-2E1D5532-31E0-4B78-AAF9-DEC27CC3927B"><span class="xrefglossterm">跨平台备份</span></a>以获取要传输的数据。可以在<code class="codeph">V$TRANSPORTABLE_PLATFORM</code>视图中支持的任何平台上恢复跨平台备份。
                  </p>
                  <p>RMAN不会为控制文件中的跨平台传输创建的备份集编目。这可确保在常规还原操作期间不会使用为跨平台传输创建的备份集。</p>
                  <div class="section">
                     <p class="subhead2" id="GUID-4644069A-7849-49F2-A1BF-2193EBAFFDBD__GUID-E743E024-CE1F-467C-A2B0-25951AC1C83A">关于用于使用备份集创建跨平台备份的子句</p>
                  </div>
                  <!-- class="section" -->
                  <p>使用<code class="codeph">BACKUP</code>命令中的<code class="codeph">FOR TRANSPORT</code>或<code class="codeph">TO PLATFORM</code>子句创建跨平台备份。使用这些子句中的任何一个创建只读表空间的跨平台备份时，RMAN还可以创建数据泵<a href="glossary.html#GUID-5C2A79F3-E089-41DC-B3F5-879FB6125CE5"><span class="xrefglossterm">导出转储文件，</span></a>其中包含将这些表空间插入目标数据库所需的元数据。
                  </p>
                  <p>虽然Oracle数据库<span class="italic">10g</span>第2版（10.2）或Oracle Database <span class="italic">11g</span>不支持<code class="codeph">TO PLATFORM</code>和<code class="codeph">FOR TRANSPORT</code>子句，但您可以将数据从这些版本的数据库传输到Oracle Database 12 <span class="italic">c</span>第1版（12.1）。在源数据库上，首先创建要传输的表空间的备份集，然后使用<code class="codeph">expdp</code>命令创建数据泵导出转储文件。要在目标数据库上还原这些备份，请使用<code class="codeph">RESTORE</code>命令执行还原操作，然后使用<code class="codeph">impdp</code>命令导入数据泵导出转储文件。
                  </p>
                  <div class="section">
                     <p class="subhead2" id="GUID-4644069A-7849-49F2-A1BF-2193EBAFFDBD__GUID-0EA9D324-300F-4175-B0B7-C51787EBBB47">RMAN自动创建数据库的跨平台备份的方案</p>
                     <p>使用备份集备份整个数据库时，如果满足以下条件，RMAN将自动创建数据库的<a href="glossary.html#GUID-2E1D5532-31E0-4B78-AAF9-DEC27CC3927B"><span class="xrefglossterm">跨平台备份</span></a>以及指定的备份：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>满足将整个数据库作为备份集传输的先决条件。</p>
                           <div class="infoboxnotealso" id="GUID-4644069A-7849-49F2-A1BF-2193EBAFFDBD__GUID-1BE46072-CA9D-4FC2-8F33-86C4D7F58BF4">
                              <p class="notep1">也可以看看：</p>
                              <p><span class="q">“ <a href="rman-transporting-data-across-platforms.html#GUID-76834111-5476-4591-A472-7DA5E2F4464D__CIHEIGFB">使用备份集进行跨平台数据库传输的先决条件</a> ”</span></p>
                           </div>
                        </li>
                        <li>
                           <p><code class="codeph">BACKUP</code>命令不包含任何与<code class="codeph">FOR TRANSPORT</code>或<code class="codeph">TO PLATFORM</code>子句不兼容的子句。
                           </p>
                           <div class="infoboxnotealso" id="GUID-4644069A-7849-49F2-A1BF-2193EBAFFDBD__GUID-B95CCB05-EE9B-42AC-9D89-004E7527E7E3">
                              <p class="notep1">也可以看看：</p>
                              <p>有关不兼容子句的信息<a href="../rcmrf/BACKUP.html#RCMRF107" target="_blank"><span class="italic">，请参见Oracle数据库备份和恢复参考</span></a></p>
                           </div>
                        </li>
                     </ul>
                     <p>以下<code class="codeph">BACKUP</code>命令可创建数据库的跨平台备份。尽管该命令不包含<code class="codeph">FOR TRANSPORT</code>或<code class="codeph">TO PLATFORM</code>子句以指示它是跨平台备份，但由于满足<span class="q">“ <a href="rman-transporting-data-across-platforms.html#GUID-76834111-5476-4591-A472-7DA5E2F4464D__CIHEIGFB">使用备份集进行跨平台数据库传输的先决</a></span>条件”中描述的条件，因此隐式跨平台创建数据库的备份。
                     </p><pre class="oac_no_warn" dir="ltr">运行{ALLOCATE CHANNEL c1设备类型磁盘; ALLOCATE CHANNEL c2设备类型磁盘; ALLOCATE CHANNEL c3设备类型磁盘; BACKUP SKIP OFFLINE FILESPERSET 1 FORMAT'/ tmp / xplat_backups / implicit_full_db_％U'DATABASE;}</pre></div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-4644069A-7849-49F2-A1BF-2193EBAFFDBD__GUID-DC62B72F-94BC-47AA-A444-01434B153D51">使用备份集跨平台传输数据的高级步骤</p>
                  </div>
                  <!-- class="section" -->
                  <p>使用备份集跨平台传输数据包括以下高级步骤：</p>
                  <ol>
                     <li>
                        <p>在<a href="glossary.html#GUID-609A4BFA-A852-4459-AD52-05C49212753A"><span class="xrefglossterm">源数据库上</span></a> ，使用<code class="codeph">BACKUP</code>命令创建需要传输到其他平台的数据库，表空间或数据文件的<a href="glossary.html#GUID-2E1D5532-31E0-4B78-AAF9-DEC27CC3927B"><span class="xrefglossterm">跨平台备份</span></a> 。备份在源主机上创建为备份集。
                        </p>
                        <div class="infoboxnotealso" id="GUID-4644069A-7849-49F2-A1BF-2193EBAFFDBD__GUID-695BFCAE-B7A7-401C-9180-6AAB299CFCFA">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><span class="q">“ <a href="rman-transporting-data-across-platforms.html#GUID-FDD263CF-7C8F-4E9D-868C-68D17156EE36">关于在源数据库上备份数据以进行跨平台数据传输</a> ”</span></p>
                              </li>
                              <li>
                                 <p><span class="q">“ <a href="rman-transporting-data-across-platforms.html#GUID-FE9ADA7F-3102-401B-B133-5F969E19121C">关于用于跨平台表空间传输的数据泵导出转储文件</a> ”</span></p>
                              </li>
                           </ul>
                        </div>
                     </li>
                     <li>
                        <p>将源主机上创建的备份集传输到目标主机。</p>
                        <p>您可以使用操作系统实用程序传输备份集。例如，如果您的操作系统是Linux或UNIX，则可以使用<code class="codeph">cp</code>命令传输备份集。
                        </p>
                     </li>
                     <li>
                        <p>在<a href="glossary.html#GUID-4CDA2F90-4918-4357-AE32-313264940FFA"><span class="xrefglossterm">目标数据库上</span></a> ，还原从源主机传输的备份集。使用<code class="codeph">RESTORE</code>命令还原跨平台备份。
                        </p>
                        <p>通过使用不一致的表空间备份跨平台传输表空间时，需要<span class="q"><a href="rman-transporting-data-across-platforms.html#GUID-06118644-AFC6-4BD4-8CAE-19BD3A886D0A" title="This section describes the high-level steps to perform cross-platform transport of inconsistent tablespaces using backup sets or image copies.">执行</a></span>恢复表空间的附加步骤，如<span class="q">“ <a href="rman-transporting-data-across-platforms.html#GUID-06118644-AFC6-4BD4-8CAE-19BD3A886D0A" title="本节介绍使用备份集或映像副本执行不一致表空间的跨平台传输的高级步骤。">使用不一致的备份执行表空间的跨平台传输</a> ”中所述</span> 。
                        </p>
                        <div class="infoboxnotealso" id="GUID-4644069A-7849-49F2-A1BF-2193EBAFFDBD__GUID-4B1D1197-883D-4616-B9DF-FA539B3BFE85">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><span class="q">“ <a href="rman-transporting-data-across-platforms.html#GUID-626AB5CF-F183-4C73-B14A-94CEDA409AE3">关于在跨平台数据传输期间在目标主机上恢复数据</a> ”</span></p>
                              </li>
                              <li>
                                 <p><span class="q">“ <a href="rman-transporting-data-across-platforms.html#GUID-B3295ECD-1359-49D8-9F81-3316B2DE722B">关于选择要从跨平台备份中恢复的对象</a> ”</span></p>
                              </li>
                              <li>
                                 <p><span class="q">“ <a href="rman-transporting-data-across-platforms.html#GUID-4F2E196D-A147-48E1-8D32-48974841F2AD">关于目标数据库上还原对象的名称和位置</a> ”</span></p>
                              </li>
                              <li>
                                 <p><span class="q">“ <a href="rman-transporting-data-across-platforms.html#GUID-A98EEA2C-54C4-4AD5-A31F-FFFA2565C00D">关于导入跨平台表空间传输期间创建的数据泵导出转储文件</a> ”</span></p>
                              </li>
                           </ul>
                        </div>
                     </li>
                  </ol>
                  <p>以下各节提供了有关如何使用备份集，先决条件和使用的RMAN语法跨平台传输数据的详细信息：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><span class="q">“ <a href="rman-transporting-data-across-platforms.html#GUID-76834111-5476-4591-A472-7DA5E2F4464D">使用备份集执行跨平台数据库传输</a> ”</span></p>
                     </li>
                     <li>
                        <p><span class="q">“ <a href="rman-transporting-data-across-platforms.html#GUID-7E1B3B10-CDA2-4E79-9F4C-AC8E51BCDE54">使用备份集执行只读表空间的跨平台传输</a> ”</span></p>
                     </li>
                     <li>
                        <p><span class="q">“ <a href="rman-transporting-data-across-platforms.html#GUID-06118644-AFC6-4BD4-8CAE-19BD3A886D0A" title="本节介绍使用备份集或映像副本执行不一致表空间的跨平台传输的高级步骤。">使用不一致的备份执行表空间的跨平台传输</a> ”</span></p>
                     </li>
                  </ul>
               </div><a id="BRADV812"></a><a id="BRADV813"></a><a id="BRADV814"></a><a id="BRADV815"></a><a id="BRADV710"></a><div class="props_rev_3"><a id="GUID-C25B5432-E198-44F0-BE95-9CB4B2A764C4" name="GUID-C25B5432-E198-44F0-BE95-9CB4B2A764C4"></a><h4 id="BRADV-GUID-C25B5432-E198-44F0-BE95-9CB4B2A764C4" class="sect4"><span class="enumeration_section">28.6.1</span>使用备份集进行跨平台数据传输时使用的基本术语</h4>
                  <div>
                     <p>在使用备份集执行跨平台数据传输之前，了解以下术语非常有用。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-C25B5432-E198-44F0-BE95-9CB4B2A764C4__GUID-B0CF1604-A4F6-452E-8501-532ED5B379E2">国外数据文件</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>不属于<a href="glossary.html#GUID-4CDA2F90-4918-4357-AE32-313264940FFA"><span class="xrefglossterm">目标数据库</span></a>的<a href="glossary.html#GUID-9C271FBB-5FE5-4B80-B8E8-0536FF2EA1C1"><span class="xrefglossterm">数据文件</span></a>称为<a href="glossary.html#GUID-9C271FBB-5FE5-4B80-B8E8-0536FF2EA1C1"><span class="xrefglossterm">外部数据文件</span></a> 。这些数据文件作为数据传输到目标数据库的一部分插入目标数据库。在<a href="glossary.html#GUID-609A4BFA-A852-4459-AD52-05C49212753A"><span class="xrefglossterm">源数据库中</span></a> ，此数据文件由其原始数据文件编号标识。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-C25B5432-E198-44F0-BE95-9CB4B2A764C4__GUID-065BDBBB-9870-47F5-A7C9-60FC00DED693">外国表空间</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p><a href="glossary.html#GUID-65A84A4D-0B9F-46E6-979E-0676061771BD"><span class="xrefglossterm">外部表空间</span></a>是一组外部数据文件，包含<a href="glossary.html#GUID-609A4BFA-A852-4459-AD52-05C49212753A"><span class="xrefglossterm">源数据库中</span></a>的表空间。这些外部数据文件不属于<a href="glossary.html#GUID-4CDA2F90-4918-4357-AE32-313264940FFA"><span class="xrefglossterm">目标数据库</span></a> ，但正在传输到目标数据库，并由源数据库中的原始表空间名称标识。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-C25B5432-E198-44F0-BE95-9CB4B2A764C4__GUID-B9A9DEC8-C1A5-4A05-A1C1-7E098D2833FB">外国数据文件复制</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p><a href="glossary.html#GUID-9FD41C84-AEBC-419A-8F0F-175CFF496A71"><span class="xrefglossterm">外部数据文件副本</span></a>是从<a href="glossary.html#GUID-2E1D5532-31E0-4B78-AAF9-DEC27CC3927B"><span class="xrefglossterm">跨平台备份</span></a>还原的数据文件。它不能直接插入<a href="glossary.html#GUID-4CDA2F90-4918-4357-AE32-313264940FFA"><span class="xrefglossterm">目标数据库，</span></a>因为它不一致。必须先将跨平台增量备份应用于此数据文件，然后将其恢复，然后才能将其插入目标数据库。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-C25B5432-E198-44F0-BE95-9CB4B2A764C4__GUID-234F97F2-D19E-44BF-AFA4-2394D558A5B5">数据泵目的地</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>数据泵目标是目标数据库的服务器主机磁盘上的一个位置，数据泵<a href="glossary.html#GUID-5C2A79F3-E089-41DC-B3F5-879FB6125CE5"><span class="xrefglossterm">导出转储文件</span></a>和数据泵日志文件存储在该位置。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="BRADV712"></a><div class="props_rev_3"><a id="GUID-FDD263CF-7C8F-4E9D-868C-68D17156EE36" name="GUID-FDD263CF-7C8F-4E9D-868C-68D17156EE36"></a><h4 id="BRADV-GUID-FDD263CF-7C8F-4E9D-868C-68D17156EE36" class="sect4"><span class="enumeration_section">28.6.2</span>关于备份源数据库上的数据以进行跨平台数据传输</h4>
                  <div>
                     <p>要创建包含必须传输到<a href="glossary.html#GUID-4CDA2F90-4918-4357-AE32-313264940FFA"><span class="xrefglossterm">目标数据库的</span></a>数据的备份集，请在<a href="glossary.html#GUID-609A4BFA-A852-4459-AD52-05C49212753A"><span class="xrefglossterm">源数据库</span></a>上使用<code class="codeph">BACKUP</code>命令。要指示您正在创建<a href="glossary.html#GUID-2E1D5532-31E0-4B78-AAF9-DEC27CC3927B"><span class="xrefglossterm">跨平台备份</span></a> ， <code class="codeph">BACKUP</code>命令必须包含<code class="codeph">FOR TRANSPORT</code>或<code class="codeph">TO PLATFORM</code>子句。
                     </p>
                     <p>什么时候<a id="d127931e3471" class="indexterm-anchor"></a>使用<code class="codeph">FOR TRANSPORT</code> ，创建的备份集可以传输到任何目标数据库。如果目标数据库使用的端格式与源数据库的格式不同，则在目标数据库上执行所需的字节序格式转换。此方法的好处是转换操作的处理开销被卸载到目标数据库。
                     </p>
                     <p>当你<a id="d127931e3481" class="indexterm-anchor"></a>使用<code class="codeph">TO PLATFORM</code> ，在源数据库上执行endian格式转换。<code class="codeph">TO PLATFORM</code>子句指定的目标平台必须是跨平台传输的支持平台。<code class="codeph">V$TRANSPORTABLE_PLATFORM</code>视图包含支持的平台列表。
                     </p>
                     <p>您可以创建包含多个备份片段的跨平台备份。有关示例，请参见<a href="../rcmrf/BACKUP.html#RCMRF107" target="_blank"><span class="italic">Oracle数据库备份和恢复参考</span></a> 。
                     </p>
                     <p>使用<code class="codeph">FOR TRANSPORT</code>或<code class="codeph">TO PLATFORM</code>子句创建<a href="glossary.html#GUID-2E1D5532-31E0-4B78-AAF9-DEC27CC3927B"><span class="xrefglossterm">跨平台备份</span></a>时，不能使用<code class="codeph">BACKUP</code>命令的某些子句。有关与<code class="codeph">TO PLATFORM</code>和<code class="codeph">FOR TRANSPORT</code>不兼容的子句的信息，请参见<a href="../rcmrf/BACKUP.html#RCMRF107" target="_blank"><span class="italic">Oracle数据库备份和恢复参考</span></a> 。</p>
                  </div>
               </div><a id="BRADV713"></a><div class="props_rev_3"><a id="GUID-FE9ADA7F-3102-401B-B133-5F969E19121C" name="GUID-FE9ADA7F-3102-401B-B133-5F969E19121C"></a><h4 id="BRADV-GUID-FE9ADA7F-3102-401B-B133-5F969E19121C" class="sect4"><span class="enumeration_section">28.6.3</span>关于用于跨平台表空间传输的数据泵导出转储文件</h4>
                  <div>
                     <p>创建跨平台一致性表空间备份时，备份集包含包含与指定表空间相关的数据的数据文件。一致的表空间备份是表空间处于只读模式时创建的一个或多个表空间的备份。在<a href="glossary.html#GUID-4CDA2F90-4918-4357-AE32-313264940FFA"><span class="xrefglossterm">目标数据库中</span></a>还原此备份后，必须将表空间插入目标数据库。为此，除了包含表空间数据的备份集之外，还需要<a href="glossary.html#GUID-609A4BFA-A852-4459-AD52-05C49212753A"><span class="xrefglossterm">源数据库中</span></a>这些表空间的元数据。
                     </p>
                     <p>在源数据库上，使用<a id="d127931e3618" class="indexterm-anchor"></a> <code class="codeph">BACKUP</code>命令中的<code class="codeph">DATAPUMP</code>子句用于创建将表空间插入目标数据库所需的元数据。元数据作为单独的备份集存储在数据泵<a href="glossary.html#GUID-5C2A79F3-E089-41DC-B3F5-879FB6125CE5"><span class="xrefglossterm">导出转储文件</span></a>中。使用此备份集将传输的表空间插入目标数据库。
                     </p>
                     <p>您可以使用带有<code class="codeph">DATAPUMP</code>子句的<code class="codeph">FORMAT</code>选项指定如何命名包含表空间元数据的备份集。如果省略<code class="codeph">FORMAT</code>选项，则使用<code class="codeph">BACKUP</code>命令中指定的格式来命名<a href="glossary.html#GUID-5C2A79F3-E089-41DC-B3F5-879FB6125CE5"><span class="xrefglossterm">导出转储文件</span></a> 。如果在<code class="codeph">BACKUP</code>命令中未指定<code class="codeph">FORMAT</code>选项，则使用默认格式。
                     </p>
                     <div class="infoboxnote" id="GUID-FE9ADA7F-3102-401B-B133-5F969E19121C__GUID-F6114C21-C314-45D9-A016-4E276B8D3458">
                        <p class="notep1">注意：</p>
                        <p>使用<code class="codeph">DATAPUMP</code>子句时，必须将正在传输的表空间设置为只读。
                        </p>
                     </div>
                  </div>
               </div><a id="BRADV714"></a><div class="props_rev_3"><a id="GUID-626AB5CF-F183-4C73-B14A-94CEDA409AE3" name="GUID-626AB5CF-F183-4C73-B14A-94CEDA409AE3"></a><h4 id="BRADV-GUID-626AB5CF-F183-4C73-B14A-94CEDA409AE3" class="sect4"><span class="enumeration_section">28.6.4</span>关于在跨平台数据传输期间在目标主机上恢复数据</h4>
                  <div>
                     <p>在<a href="glossary.html#GUID-4CDA2F90-4918-4357-AE32-313264940FFA"><span class="xrefglossterm">目标数据库上</span></a> ，使用<code class="codeph">RESTORE</code>命令还原包含备份集的<a href="glossary.html#GUID-2E1D5532-31E0-4B78-AAF9-DEC27CC3927B"><span class="xrefglossterm">跨平台备份中</span></a>包含的数据库，表空间或数据文件。执行跨平台还原操作时，必须使用<code class="codeph">RESTORE</code>命令的<code class="codeph">foreignFileSpec</code>子句。有关更多信息，请参见<a href="../rcmrf/foreignFileSpec.html#RCMRF90573" target="_blank"><span class="italic">Oracle数据库备份和恢复参考</span></a> 。
                     </p>
                     <p>还原跨平台备份时，必须指定以下信息：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>包含在<a href="glossary.html#GUID-609A4BFA-A852-4459-AD52-05C49212753A"><span class="xrefglossterm">源数据库</span></a>上备份的数据的备份集</p>
                           <p>使用<a id="d127931e3770" class="indexterm-anchor"></a> <code class="codeph">foreignFileSpec</code>子条款的<code class="codeph">BACKUPSET</code>选项，用于指定必须从中还原数据的跨平台备份集的名称。如果跨平台备份包含多个备份集，请为每个备份集使用单独的<code class="codeph">BACKUPSET</code>子句。要还原表空间，必须使用<code class="codeph">BACKUPSET</code>子句指定包含表空间数据的备份集，并使用包含表空间元数据的备份集指定<a id="d127931e3788" class="indexterm-anchor"></a> <code class="codeph">foreignFileSpec</code>子条款的<code class="codeph">DUMP FILE</code>选项。
                           </p>
                           <p></p>
                           <p>恢复期间不支持使用多个备份集。您不能将多个备份集应用于一组外部数据文件。</p>
                           <div class="infoboxnotealso" id="GUID-626AB5CF-F183-4C73-B14A-94CEDA409AE3__GUID-8B59B621-3E2C-4712-A065-C7CB66FE7679">
                              <p class="notep1">也可以看看：</p>
                              <p>有关<code class="codeph">BACKPSET</code>和<code class="codeph">DUMP FILE</code>信息，请<code class="codeph">BACKPSET</code> <a href="../rcmrf/foreignFileSpec.html#RCMRF90573" target="_blank"><span class="italic">Oracle数据库备份和恢复参考</span></a></p>
                           </div>
                        </li>
                        <li>
                           <p>源数据库中存在的表空间的数据文件编号或名称</p>
                           <p>如果要还原数据文件或表空间，则可以还原跨平台备份中包含的特定表空间或数据文件。</p>
                           <div class="infoboxnotealso" id="GUID-626AB5CF-F183-4C73-B14A-94CEDA409AE3__GUID-39FCF0FD-F300-4707-AC2A-54E081D6D1B3">
                              <p class="notep1">也可以看看：</p>
                              <p><span class="q">“ <a href="rman-transporting-data-across-platforms.html#GUID-4F2E196D-A147-48E1-8D32-48974841F2AD">关于目标数据库上还原对象的名称和位置</a> ”</span></p>
                           </div>
                        </li>
                        <li>
                           <p>必须存储已还原数据文件的位置</p>
                           <p>使用<code class="codeph">FORMAT</code>子句指定用于存储还原的数据文件的位置和名称。
                           </p>
                           <p>如果未提供目标，则必须在目标平台中设置<code class="codeph">DB_FILE_CREATE_DEST</code>初始化参数。RMAN使用新的Oracle托管文件（OMF）名称将数据文件还原到此参数指定的位置。
                           </p>
                           <div class="infoboxnotealso" id="GUID-626AB5CF-F183-4C73-B14A-94CEDA409AE3__GUID-3DDA761D-071B-4EF0-B51D-3823699F1020">
                              <p class="notep1">也可以看看：</p>
                              <p><span class="q">“ <a href="rman-transporting-data-across-platforms.html#GUID-4F2E196D-A147-48E1-8D32-48974841F2AD">关于目标数据库上还原对象的名称和位置</a> ”</span></p>
                           </div>
                        </li>
                        <li>
                           <p>源平台的名称（仅在目标数据库上执行转换时）</p>
                           <p>使用<a id="d127931e3849" class="indexterm-anchor"></a> <code class="codeph">FROM PLATFORM</code>指定创建备份集的源平台的名称。平台名称必须与创建备份集时指定的名称完全匹配。如果平台名称存在差异，则还原操作将失败。
                           </p>
                           <div class="infoboxnotealso" id="GUID-626AB5CF-F183-4C73-B14A-94CEDA409AE3__GUID-526AFCE0-A7E6-4884-BF1F-171DB2AA84AA">
                              <p class="notep1">也可以看看：</p>
                              <p><span class="q">“ <a href="rman-transporting-data-across-platforms.html#GUID-FDD263CF-7C8F-4E9D-868C-68D17156EE36">关于在源数据库上备份数据以进行跨平台数据传输</a> ”</span></p>
                           </div>
                        </li>
                     </ul>
                  </div>
               </div><a id="BRADV716"></a><a id="BRADV717"></a><a id="BRADV715"></a><div class="props_rev_3"><a id="GUID-B3295ECD-1359-49D8-9F81-3316B2DE722B" name="GUID-B3295ECD-1359-49D8-9F81-3316B2DE722B"></a><h4 id="BRADV-GUID-B3295ECD-1359-49D8-9F81-3316B2DE722B" class="sect4"><span class="enumeration_section">28.6.5</span>关于从跨平台备份中选择要还原的对象</h4>
                  <div>
                     <p>从<a href="glossary.html#GUID-2E1D5532-31E0-4B78-AAF9-DEC27CC3927B"><span class="xrefglossterm">跨平台备份</span></a>还原数据时，您可以还原跨平台备份中包含的所有数据，也可以仅还原某些对象。
                     </p>
                     <div class="infoboxnotealso" id="GUID-B3295ECD-1359-49D8-9F81-3316B2DE722B__GUID-6A6095F1-ACE8-4BE6-8668-15E6E6B7C64A">
                        <p class="notep1">也可以看看：</p>
                        <p>有关本节中描述的子句的详细信息，请<a href="../rcmrf/foreignFileSpec.html#RCMRF90573" target="_blank"><span class="italic">参见Oracle数据库备份和恢复参考</span></a></p>
                     </div>
                     <div class="section">
                        <p class="subhead3" id="GUID-B3295ECD-1359-49D8-9F81-3316B2DE722B__GUID-36E6D10F-4D7A-46F1-AB0A-07651AD6633A">恢复跨平台备份中包含的所有数据</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>要还原整个数据库，请使用<a id="d127931e3954" class="indexterm-anchor"></a> <code class="codeph">RESTORE</code>命令中的<code class="codeph">FOREIGN DATABASE</code>子句。仅当从整个数据库备份集还原时以及<a href="glossary.html#GUID-F5230E13-106F-4840-9E58-3AB7071E9B21"><span class="xrefglossterm">源平台</span></a>和<a href="glossary.html#GUID-0E17C982-762C-46D3-83BB-C86302304093"><span class="xrefglossterm">目标平台都</span></a>使用相同的endian格式时，才能使用此子句。您可以选择使用<code class="codeph">FORMAT</code>子句指定用于命名已还原文件的模式。
                        </p>
                        <p>要还原跨平台备份中包含的所有数据文件，请使用<a id="d127931e3979" class="indexterm-anchor"></a> <code class="codeph">RESTORE</code>命令中的<code class="codeph">ALL FOREIGN DATAFILES</code>子句。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-B3295ECD-1359-49D8-9F81-3316B2DE722B__GUID-9D837144-A0DB-447B-A947-F0E97FA96648">恢复跨平台备份集中包含的部分数据</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>您可以还原跨平台备份中包含的某些数据文件或表空间。要仅还原某些数据文件，请使用<a id="d127931e3996" class="indexterm-anchor"></a> <code class="codeph">RESTORE</code>命令中的<code class="codeph">FOREIGN DATAFILE</code>子句。在还原数据时指定<a href="glossary.html#GUID-609A4BFA-A852-4459-AD52-05C49212753A"><span class="xrefglossterm">源数据库中</span></a>数据文件的绝对文件号。要仅还原跨平台备份中包含的某些表空间，请使用<a id="d127931e4011" class="indexterm-anchor"></a> <code class="codeph">RESTORE</code>命令中的<code class="codeph">FOREIGN TABLESPACE</code>子句。指定必须作为此子句的一部分还原的表空间的名称。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="BRADV718"></a><div class="props_rev_3"><a id="GUID-4F2E196D-A147-48E1-8D32-48974841F2AD" name="GUID-4F2E196D-A147-48E1-8D32-48974841F2AD"></a><h4 id="BRADV-GUID-4F2E196D-A147-48E1-8D32-48974841F2AD" class="sect4"><span class="enumeration_section">28.6.6</span>关于目标数据库上已还原对象的名称和位置</h4>
                  <div>
                     <p>还原<a href="glossary.html#GUID-2E1D5532-31E0-4B78-AAF9-DEC27CC3927B"><span class="xrefglossterm">跨平台备份时</span></a> ，请使用<code class="codeph">RESTORE</code>命令中的以下选项之一指定数据文件名及其还原位置：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>使用<code class="codeph">TO NEW</code>选项和<code class="codeph">ALL FOREIGN DATAFILES</code>子句将数据文件还原到<code class="codeph">DB_FILE_CREATE_DEST</code>参数指定的位置。默认情况下，RMAN使用OMF名称作为数据文件。
                           </p>
                        </li>
                        <li>
                           <p>使用<code class="codeph">FORMAT</code>选项指定用于命名已还原数据文件的模式。您还可以将这些文件的目录指定为<code class="codeph">FORMAT</code>规范的一部分。
                           </p>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-4F2E196D-A147-48E1-8D32-48974841F2AD__GUID-3D6AB2D9-C254-4A45-8E85-3F40DADAB7C8">
                        <p class="notep1">也可以看看：</p>
                        <p>有关本节中描述的子句的详细信息，请<a href="../rcmrf/RESTORE.html#RCMRF149" target="_blank"><span class="italic">参见Oracle数据库备份和恢复参考</span></a></p>
                     </div>
                  </div>
               </div><a id="BRADV719"></a><div class="props_rev_3"><a id="GUID-A98EEA2C-54C4-4AD5-A31F-FFFA2565C00D" name="GUID-A98EEA2C-54C4-4AD5-A31F-FFFA2565C00D"></a><h4 id="BRADV-GUID-A98EEA2C-54C4-4AD5-A31F-FFFA2565C00D" class="sect4"><span class="enumeration_section">28.6.7</span>关于导入跨平台表空间传输期间创建的数据泵导出转储文件</h4>
                  <div>
                     <p>在<a href="glossary.html#GUID-4CDA2F90-4918-4357-AE32-313264940FFA"><span class="xrefglossterm">目标数据库</span></a>上还原只读表空间的跨平台备份时，请使用<code class="codeph">DUMP FILE ...<code class="codeph">foreignFileSpec</code>子句的FROM BACKUPSET</code>选项用于还原包含Data Pump <a href="glossary.html#GUID-5C2A79F3-E089-41DC-B3F5-879FB6125CE5"><span class="xrefglossterm">导出转储文件</span></a>的备份集。导出转储文件包含将表空间插入目标数据库所需的元数据。
                     </p>
                     <p>使用<a id="d127931e4220" class="indexterm-anchor"></a> <code class="codeph">RESTORE</code>命令中的<code class="codeph">DATAPUMP</code>子句，用于指定还原导出转储文件的目标主机上的位置。如果省略此子句，则转储文件将还原到特定于操作系统的默认位置。
                     </p>
                     <p>默认情况下，RMAN会在还原所有必需的<a href="glossary.html#GUID-9C271FBB-5FE5-4B80-B8E8-0536FF2EA1C1"><span class="xrefglossterm">外部数据文件</span></a>后自动导入导出转储文件。您可以通过指定来选择不导入导出转储文件<a id="d127931e4237" class="indexterm-anchor"></a> <code class="codeph">NOIMPORT</code>条款。如果在还原操作过程中未导入导出转储文件，则必须在要将表空间插入目标数据库时手动导入转储文件。
                     </p>
                     <div class="infoboxnote" id="GUID-A98EEA2C-54C4-4AD5-A31F-FFFA2565C00D__GUID-34F23981-0AB1-4680-9655-4DD47B478F5C">
                        <p class="notep1">注意：</p>
                        <p>如果自动导入导出转储文件（即，未使用<code class="codeph">NOIMPORT</code>子句），则必须以读/写模式打开目标数据库。
                        </p>
                     </div>
                  </div>
               </div>
            </div><a id="BRADV722"></a><a id="BRADV721"></a><div class="props_rev_3"><a id="GUID-76834111-5476-4591-A472-7DA5E2F4464D" name="GUID-76834111-5476-4591-A472-7DA5E2F4464D"></a><h3 id="BRADV-GUID-76834111-5476-4591-A472-7DA5E2F4464D" class="sect3"><span class="enumeration_section">28.7</span>使用备份集执行跨平台数据库传输</h3>
               <div>
                  <p>您可以将整个数据库从源平台传输到不同的目标平台。在创建跨平台备份以传输数据库时，可以在源数据库或目标数据库上转换数据库。在目标数据库上执行转换的好处是转换操作的处理开销从源数据库卸载到目标数据库。</p>
                  <div class="infoboxnotealso" id="GUID-76834111-5476-4591-A472-7DA5E2F4464D__GUID-74467A82-EE92-4147-B126-1CB84EC73C12">
                     <p class="notep1">也可以看看：</p>
                     <p><span class="q">“ <a href="rman-transporting-data-across-platforms.html#GUID-4644069A-7849-49F2-A1BF-2193EBAFFDBD">使用备份集的跨平台数据传输概述</a> ”</span></p>
                  </div>
                  <div class="section" id="GUID-76834111-5476-4591-A472-7DA5E2F4464D__CIHEIGFB">
                     <p class="subhead2" id="GUID-76834111-5476-4591-A472-7DA5E2F4464D__GUID-08B785C7-F3FC-4FE6-BA46-F3CAE602BB7A">使用备份集进行跨平台数据库传输的先决条件</p>
                     <p>在创建<a href="glossary.html#GUID-2E1D5532-31E0-4B78-AAF9-DEC27CC3927B"><span class="xrefglossterm">跨平台备份</span></a>以跨平台传输数据库之前，必须满足以下先决条件：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="glossary.html#GUID-609A4BFA-A852-4459-AD52-05C49212753A"><span class="xrefglossterm">源数据库</span></a>和<a href="glossary.html#GUID-4CDA2F90-4918-4357-AE32-313264940FFA"><span class="xrefglossterm">目标数据库</span></a>的服务器参数文件中的<code class="codeph">COMPATIBLE</code>参数必须设置为12.0.0或更高版本。
                           </p>
                        </li>
                        <li>
                           <p>源数据库必须以只读模式打开。</p>
                        </li>
                        <li>
                           <p><code class="codeph">DBMS_TDB.CHECK_DB</code>过程必须成功运行。
                           </p>
                           <div class="infoboxnotealso" id="GUID-76834111-5476-4591-A472-7DA5E2F4464D__GUID-933939CF-2F90-47EC-B4D4-4FF4BBB78BC8">
                              <p class="notep1">也可以看看：</p>
                              <p><span class="q">“</span>有关使用<code class="codeph">DBMS_TDB.CHECK_DB</code>过程的信息，请<span class="q"><a href="rman-transporting-data-across-platforms.html#GUID-B0178538-6E41-455D-8166-FBB1EDC5D198">在跨平台数据库转换之前检查数据库</a> ”</span></p>
                           </div>
                        </li>
                        <li>
                           <p>源平台和目标平台必须使用相同的endian格式。</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="infoboxnotealso" id="GUID-76834111-5476-4591-A472-7DA5E2F4464D__GUID-CAF6EDA1-8340-45F7-A9F6-B1456C0A7AF0">
                     <p class="notep1">也可以看看：</p>
                     <p><span class="q">“ <a href="rman-transporting-data-across-platforms.html#GUID-1EDA4225-1F4D-4960-A5E8-EE6AF777DF29">使用备份集将数据库传输到不同平台的步骤</a> ”</span> 
                     </p>
                  </div>
               </div><a id="BRADV724"></a><div class="props_rev_3"><a id="GUID-1EDA4225-1F4D-4960-A5E8-EE6AF777DF29" name="GUID-1EDA4225-1F4D-4960-A5E8-EE6AF777DF29"></a><h4 id="BRADV-GUID-1EDA4225-1F4D-4960-A5E8-EE6AF777DF29" class="sect4"><span class="enumeration_section">28.7.1</span>使用备份集将数据库传输到不同平台的步骤</h4>
                  <div>
                     <div class="section">
                        <p>使用以下步骤将整个数据库从一个平台传输到另一个平台：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>确保满足执行跨平台数据库传输所需的先决条件。</span><div>
                              <div class="infoboxnotealso" id="GUID-1EDA4225-1F4D-4960-A5E8-EE6AF777DF29__GUID-435C4AF6-DD7D-448C-8061-A9005B4D5A42">
                                 <p class="notep1">也可以看看：</p>
                                 <p><span class="q">“ <a href="rman-transporting-data-across-platforms.html#GUID-76834111-5476-4591-A472-7DA5E2F4464D__CIHEIGFB">使用备份集进行跨平台数据库传输的先决条件</a> ”</span></p>
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>启动SQL * Plus并使用管理员权限连接到<a href="glossary.html#GUID-609A4BFA-A852-4459-AD52-05C49212753A"><span class="xrefglossterm">源数据库</span></a> <code class="codeph">prod_source</code> 。</span><div><pre class="oac_no_warn" dir="ltr">％sqlplus sys @ prod_source为SYSDBA</pre><p>出现提示时，输入<code class="codeph">sys</code>用户的密码。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>在<code class="codeph">V$TRANSPORTABLE_PLATFORM</code>查询目标平台的名称。</span><div>
                              <p>要传输整个数据库，源平台和目标平台的endian格式必须相同。</p>
                              <div class="infoboxnotealso" id="GUID-1EDA4225-1F4D-4960-A5E8-EE6AF777DF29__GUID-7EFBBF81-D1B7-43A0-BCE7-44915CA40A55">
                                 <p class="notep1">也可以看看：</p>
                                 <p><span class="q">“ <a href="rman-transporting-data-across-platforms.html#GUID-D113DEE2-8619-4B8B-9EFE-9D2833C9823A">支持跨平台数据传输的平台</a> ”，</span>以获取有关确定平台名称的信息</p>
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>选择命名输出文件的方法。</span><div>
                              <p>使用<code class="codeph">BACKUP</code>命令的<code class="codeph">FORMAT</code>子句指定输出文件的名称。
                              </p>
                              <p>例如，以下<code class="codeph">FORMAT</code>子句指定必须使用以<code class="codeph">/oradata/backups/special.</code>目录中的<code class="codeph">transport_</code>开头的唯一名称来存储输出文件<code class="codeph">/oradata/backups/special.</code></p><pre class="oac_no_warn" dir="ltr">格式'/ oradata / backups / special / transport_％U'</pre></div>
                        </li>
                        <li class="stepexpand"><span>启动RMAN并以<code class="codeph">TARGET</code>身份连接到源数据库。</span><div>
                              <p>源数据库是包含需要传输到不同平台的数据的数据库。</p>
                              <p>在此示例中， <code class="codeph">sbu</code>是在源数据库<code class="codeph">prod_source</code>被授予<code class="codeph">SYSBACKUP</code>权限的用户。
                              </p><pre class="oac_no_warn" dir="ltr">％RMAN RMAN&gt; CONNECT TARGET“sbu @ prod_source AS SYSBACKUP”;</pre><p>出现提示时输入<code class="codeph">sbu</code>用户的密码。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>将数据库置于只读模式。</span><div><pre class="oac_no_warn" dir="ltr">立即关闭;启动安装; ALTER DATABASE OPEN READ ONLY;</pre></div>
                        </li>
                        <li class="stepexpand" id="GUID-1EDA4225-1F4D-4960-A5E8-EE6AF777DF29__CHDBHEEB"><span>使用<code class="codeph">BACKUP</code>命令中的<code class="codeph">FOR TRANSPORT</code>或<code class="codeph">TO PLATFORM</code>子句<code class="codeph">BACKUP</code>源数据库。使用这些子句中的任何一个都会创建使用备份集的<a href="glossary.html#GUID-2E1D5532-31E0-4B78-AAF9-DEC27CC3927B"><span class="xrefglossterm">跨平台备份</span></a> 。</span><div>
                              <p>下列<a id="d127931e4590" class="indexterm-anchor"></a>示例创建整个数据库的跨平台备份。可以在使用与源数据库相同的endian格式的任何受支持平台上还原此备份。源平台是Sun Solaris x86 64位。由于使用了<code class="codeph">FOR TRANSPORT</code>子句，因此将在目标数据库上执行转换。跨平台数据库备份存储在源主机上<code class="codeph">/tmp/xplat_backups</code>目录中的<code class="codeph">db_trans.bck</code>中。
                              </p><pre class="oac_no_warn" dir="ltr">备份运输格式'/tmp/xplat_backups/db_trans.bck'数据库;</pre></div>
                        </li>
                        <li class="stepexpand"><span>断开与源数据库的连接。</span></li>
                        <li class="stepexpand"><span>将<code class="codeph">BACKUP</code>命令创建的备份集移动到目标主机。</span><div>
                              <p>使用特定于操作系统的实用程序将创建的备份集从源主机传输到目标主机。</p>
                              <p>例如，如果源主机和目标主机的操作系统是Linux或UNIX，请使用<code class="codeph">cp</code>命令移动文件。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>连接到必须将数据库传输到的<a href="glossary.html#GUID-4CDA2F90-4918-4357-AE32-313264940FFA"><span class="xrefglossterm">目标数据库</span></a> ，作为<code class="codeph">TARGET</code> 。</span><div>
                              <p>在此示例中， <code class="codeph">sbu</code>是在目标数据库<code class="codeph">prod_dest</code>被授予<code class="codeph">SYSBACKUP</code>权限的用户。</p><pre class="oac_no_warn" dir="ltr">％RMAN RMAN&gt; CONNECT TARGET“sbu @ prod_dest AS SYSBACKUP”;</pre><p>出现提示时输入<code class="codeph">sbu</code>用户的密码。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>确保目标数据库处于<code class="codeph">NOMOUNT</code>状态。</span></li>
                        <li class="stepexpand"><span>使用带有<code class="codeph">FOREIGN DATABASE</code>子句的<code class="codeph">RESTORE</code>命令还原从源传输的备份集。</span><div>
                              <p>以下示例将还原在步骤<a href="rman-transporting-data-across-platforms.html#GUID-1EDA4225-1F4D-4960-A5E8-EE6AF777DF29__CHDBHEEB">7中</a>创建的跨平台数据库备份。目标数据库使用与源数据库相同的endian格式。<code class="codeph">FROM PLATFORM</code>子句指定创建备份的平台的名称。转换目标上的备份需要此子句。包含的备份集<a id="d127931e4677" class="indexterm-anchor"></a>跨平台数据库备份存储在目标主机上的<code class="codeph">/tmp/xplat_restores</code>目录中。<code class="codeph">TO NEW</code>选项指定还原的<a href="glossary.html#GUID-9C271FBB-5FE5-4B80-B8E8-0536FF2EA1C1"><span class="xrefglossterm">外部数据文件</span></a>必须在目标数据库中使用新的OMF指定的名称。确保已设置<code class="codeph">DB_CREATE_FILE_DEST</code>初始化参数。
                              </p><pre class="oac_no_warn" dir="ltr">从PLATFORM'Solaris操作系统（x86-64）'从BACKUPSET'/ tmp / xplat_restores / db_trans.bck'恢复到FORDIGN DATABASE的新功能;</pre></div>
                        </li>
                     </ol>
                  </div>
               </div>
            </div><a id="BRADV772"></a><a id="BRADV725"></a><div class="props_rev_3"><a id="GUID-7E1B3B10-CDA2-4E79-9F4C-AC8E51BCDE54" name="GUID-7E1B3B10-CDA2-4E79-9F4C-AC8E51BCDE54"></a><h3 id="BRADV-GUID-7E1B3B10-CDA2-4E79-9F4C-AC8E51BCDE54" class="sect3"><span class="enumeration_section">28.8</span>使用备份集执行只读表空间的跨平台传输</h3>
               <div>
                  <p>使用带有<code class="codeph">FOR TRANSPORT</code>或<code class="codeph">TO PLATFORM</code>子句的<code class="codeph">BACKUP</code>命令创建可用于将只读表空间从一个平台传输到另一个平台的备份集。传输只读表空间时，还必须导出这些表空间的元数据。需要元数据才能将表空间插入<a href="glossary.html#GUID-4CDA2F90-4918-4357-AE32-313264940FFA"><span class="xrefglossterm">目标数据库</span></a> 。在跨平台传输表空间时，源和目标平台可以使用不同的endian格式。
                  </p>
                  <p>您可以还原<a href="glossary.html#GUID-2E1D5532-31E0-4B78-AAF9-DEC27CC3927B"><span class="xrefglossterm">跨平台备份中</span></a>包含的所有数据文件或表空间，或仅还原其中一些数据文件或表空间。还原这些对象后，您可以指定还原的数据文件的名称和位置。
                  </p>
                  <div class="infoboxnotealso" id="GUID-7E1B3B10-CDA2-4E79-9F4C-AC8E51BCDE54__GUID-FB25A0A2-E390-4C0E-ACBB-BD4A79574262">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><span class="q">“ <a href="rman-transporting-data-across-platforms.html#GUID-FDD263CF-7C8F-4E9D-868C-68D17156EE36">关于在源数据库上备份数据以进行跨平台数据传输</a> ”</span></p>
                        </li>
                        <li>
                           <p><span class="q">“ <a href="rman-transporting-data-across-platforms.html#GUID-B3295ECD-1359-49D8-9F81-3316B2DE722B">关于选择要从跨平台备份中恢复的对象</a> ”</span></p>
                        </li>
                        <li>
                           <p><span class="q">“ <a href="rman-transporting-data-across-platforms.html#GUID-4F2E196D-A147-48E1-8D32-48974841F2AD">关于目标数据库上还原对象的名称和位置</a> ”</span></p>
                        </li>
                     </ul>
                  </div>
                  <div class="section" id="GUID-7E1B3B10-CDA2-4E79-9F4C-AC8E51BCDE54__CIHDJFGD">
                     <p class="subhead2" id="GUID-7E1B3B10-CDA2-4E79-9F4C-AC8E51BCDE54__GUID-F64DE359-A59C-480D-AD65-32BECDA7CCAB">使用备份集执行跨平台表空间传输的先决条件</p>
                  </div>
                  <!-- class="section" -->
                  <p>在创建可用于将表空间传输到其他平台的<a href="glossary.html#GUID-2E1D5532-31E0-4B78-AAF9-DEC27CC3927B"><span class="xrefglossterm">跨平台备份</span></a>之前，必须满足以下先决条件：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="glossary.html#GUID-609A4BFA-A852-4459-AD52-05C49212753A"><span class="xrefglossterm">源数据库</span></a>和目标数据库的服务器参数文件中的<code class="codeph">COMPATIBLE</code>参数设置为12.0.0或更高。
                        </p>
                     </li>
                     <li>
                        <p>要传输的表空间是独立的。</p>
                        <p>执行<code class="codeph">DBMS_TTS.TRANSPORT_SET_CHECK</code>过程以检查依赖性。如果<code class="codeph">TRANSPORT_SET_VIOLATIONS</code>视图包含与指定表空间对应的行，则必须在创建跨平台备份之前解析依赖关系。
                        </p>
                        <div class="infoboxnotealso" id="GUID-7E1B3B10-CDA2-4E79-9F4C-AC8E51BCDE54__GUID-C335D86C-2DCB-435E-B7EC-A1320989C427">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="performing-rman-tspitr.html#GUID-06BAA701-860F-4E3C-AA70-277CCCB7F425__CHDFCCFH">例21-1</a>有关执行<code class="codeph">DBMS_TTS.TRANSPORT_SET_CHECK</code>过程的信息</p>
                        </div>
                     </li>
                     <li>
                        <p>除非在<code class="codeph">BACKUP</code>命令中使用<code class="codeph">ALLOW INCONSISTENT</code>子句，否则要传输的表空间处于只读模式。
                        </p>
                     </li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-7E1B3B10-CDA2-4E79-9F4C-AC8E51BCDE54__GUID-A5CDCC27-25C7-4B59-AFA7-0F90D03C69FB">
                     <p class="notep1">也可以看看：</p>
                     <p><span class="q">“</span>有关使用<code class="codeph">DBMS_TDB.CHECK_DB</code>过程的信息<span class="q">” <a href="rman-transporting-data-across-platforms.html#GUID-F83EC306-9E7A-46D2-8F7F-2DDD595E307D">将只读表空间传输到使用备份集的不同平台</a></span>的步骤</p>
                  </div>
               </div><a id="BRADV726"></a><div class="props_rev_3"><a id="GUID-F83EC306-9E7A-46D2-8F7F-2DDD595E307D" name="GUID-F83EC306-9E7A-46D2-8F7F-2DDD595E307D"></a><h4 id="BRADV-GUID-F83EC306-9E7A-46D2-8F7F-2DDD595E307D" class="sect4"><span class="enumeration_section">28.8.1</span>使用备份集将只读表空间传输到不同平台的步骤</h4>
                  <div>
                     <ol>
                        <li class="stepexpand"><span>确保满足将表空间传输到另一个平台所需的先决条件。</span><div>
                              <div class="infoboxnotealso" id="GUID-F83EC306-9E7A-46D2-8F7F-2DDD595E307D__GUID-BB6BF624-5CC3-494F-98C8-E1C1D55CADA5">
                                 <p class="notep1">也可以看看：</p>
                                 <p><span class="q">“ <a href="rman-transporting-data-across-platforms.html#GUID-7E1B3B10-CDA2-4E79-9F4C-AC8E51BCDE54__CIHDJFGD">使用备份集执行跨平台表空间传输的先决条件</a> ”</span></p>
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>连接到需要将表空间作为<code class="codeph">TARGET</code>传输的<a href="glossary.html#GUID-609A4BFA-A852-4459-AD52-05C49212753A"><span class="xrefglossterm">源数据库</span></a> 。</span><div>
                              <p>在此示例中， <code class="codeph">sbu</code>是在源数据库<code class="codeph">prod_source</code>上被授予<code class="codeph">SYSBACKUP</code>特权的用户。
                              </p><pre class="oac_no_warn" dir="ltr">$ RMAN RMAN&gt; CONNECT TARGET“sbu @ prod_source AS SYSBACKUP”;</pre><p>出现提示时输入s <code class="codeph">bu</code>用户的密码。
                              </p>
                              <p></p>
                              <div class="infoboxnote" id="GUID-F83EC306-9E7A-46D2-8F7F-2DDD595E307D__GUID-913B8C43-5565-4EF4-8529-46743908DAD7">
                                 <p class="notep1">注意：</p>
                                 <p>要执行加密表空间的跨平台传输，必须以具有<code class="codeph">SYSDBA</code>或<code class="codeph">SYSBACKUP</code>权限的公共用户身份连接到PDB。
                                 </p>
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>在<code class="codeph">V$TRANSPORTABLE_PLATFORM</code>查询目标平台的名称。</span><div>
                              <div class="infoboxnotealso" id="GUID-F83EC306-9E7A-46D2-8F7F-2DDD595E307D__GUID-E374D819-9CC9-4F39-A54A-E0ACC301C3F6">
                                 <p class="notep1">也可以看看：</p>
                                 <p><span class="q">“ <a href="rman-transporting-data-across-platforms.html#GUID-D113DEE2-8619-4B8B-9EFE-9D2833C9823A">支持跨平台数据传输的平台</a> ”，</span>以获取有关确定平台名称的信息</p>
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>将表空间放置为以只读模式传输。</span><div>
                              <p>以下命令将表空间<code class="codeph">EXAMPLE</code>置于只读模式。
                              </p><pre class="oac_no_warn" dir="ltr">ALTER TABLESPACE示例只读;</pre></div>
                        </li>
                        <li class="stepexpand"><span>选择命名输出文件的方法。</span><div>
                              <p>使用<code class="codeph">BACKUP</code>命令的<code class="codeph">FORMAT</code>子句指定用于命名输出文件的模式。
                              </p>
                              <div class="infoboxnotealso" id="GUID-F83EC306-9E7A-46D2-8F7F-2DDD595E307D__GUID-6EDBDB3E-5BED-47E4-8BC3-E29BED4797BF">
                                 <p class="notep1">也可以看看：</p>
                                 <p><span class="q">“ <a href="rman-transporting-data-across-platforms.html#GUID-4F2E196D-A147-48E1-8D32-48974841F2AD">关于目标数据库上还原对象的名称和位置</a> ”</span></p>
                              </div>
                              <p></p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>如果正在传输的表空间是TDE加密的表空间，则指定在将主密钥存储到备份集之前用于包装主密钥的密码。</span><div>
                              <p>以下命令将密码设置为<code class="codeph">encr_temp</code> 。
                              </p><code class="codeph">RMAN&gt;通过encr_temp识别的SET PASSPHRASE;</code></div>
                        </li>
                        <li class="stepexpand" id="GUID-F83EC306-9E7A-46D2-8F7F-2DDD595E307D__CHDBFEBE"><span>使用带有<code class="codeph">TO PLATFORM</code>或<code class="codeph">FOR TRANSPORT</code>子句的<code class="codeph">BACKUP</code>命令<code class="codeph">BACKUP</code>源数据库上的表空间。使用<code class="codeph">DATAPUMP</code>子句指示必须创建表空间的<a href="glossary.html#GUID-5C2A79F3-E089-41DC-B3F5-879FB6125CE5"><span class="xrefglossterm">导出转储文件</span></a> 。导出转储文件在其自己的备份片段中创建。</span><div>
                              <p>以下示例创建了可以在其上还原的表空间<code class="codeph">projects</code>和<code class="codeph">tasks</code>的<a href="glossary.html#GUID-2E1D5532-31E0-4B78-AAF9-DEC27CC3927B"><span class="xrefglossterm">跨平台备份</span></a> <a id="d127931e5086" class="indexterm-anchor"></a> Solaris [tm] OE（64位）平台。此备份存储在<code class="codeph">/tmp/xplat_backups</code>目录中的备份集<code class="codeph">trans_ts.bck</code>中。该<a id="d127931e5098" class="indexterm-anchor"></a>包含将表空间插入<a href="glossary.html#GUID-4CDA2F90-4918-4357-AE32-313264940FFA"><span class="xrefglossterm">目标数据库</span></a>所需的元数据的数据泵导出转储文件存储在<code class="codeph">/tmp/xplat_backups</code>目录中的<code class="codeph">trans_ts_dmp.bck</code>中。
                              </p><pre class="oac_no_warn" dir="ltr">RMAN&gt;备份到平台'Solaris [tm] OE（64位）'FORMAT'/ tmp / xplat_backups / trans_ts.bck'DATAPUMP FORMAT'/ tmp / xplat_backups / trans_ts_dmp.bck'TABLESPACE项目，任务;</pre><p>因为使用了<code class="codeph">TO PLATFORM</code>子句，所以在源数据库上执行到目标数据库的endian格式的转换。
                              </p>
                              <div class="infoboxnote" id="GUID-F83EC306-9E7A-46D2-8F7F-2DDD595E307D__GUID-F45A61D0-A8EB-497D-BBDF-07E40119AF59">
                                 <p class="notep1">注意：</p>
                                 <p>当您使用<code class="codeph">DATAPUMP</code> <a id="d127931e5126" class="indexterm-anchor"></a>子句，确保目标数据库是打开的。
                                 </p>
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>断开与源数据库的连接。</span></li>
                        <li class="stepexpand"><span>将<code class="codeph">BACKUP</code>命令和数据泵导出转储文件创建的备份集移动到目标主机。</span><div>
                              <p>您可以使用操作系统实用程序将备份集从源主机移动到目标主机。</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>连接到必须传输表空间的目标数据库，作为<code class="codeph">TARGET</code> 。</span><div>
                              <p>在此示例中， <code class="codeph">sbu</code>是在目标数据库<code class="codeph">prod_dest</code>上被授予<code class="codeph">SYSBACKUP</code>权限的用户。</p><pre class="oac_no_warn" dir="ltr">％RMAN RMAN&gt; CONNECT TARGET“sbu @ prod_dest AS SYSBACKUP”;</pre><p>出现提示时输入s <code class="codeph">bu</code>用户的密码。
                              </p>
                              <p></p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>如果正在传输的表空间是TDE-encyrpted表空间，则提供源数据库上用于包装主密钥的密码。</span><div>
                              <p>以下示例将密码设置为encr_temp。</p><pre class="oac_no_warn" dir="ltr">由encr_temp识别的SET PASSPHRASE;</pre></div>
                        </li>
                        <li class="stepexpand"><span>使用<code class="codeph">RESTORE</code>命令还原从源数据库传输的备份集。使用<code class="codeph">DUMP FILE</code>子句导入包含表空间元数据的导出转储文件，并将表空间插入目标数据库。</span><div>
                              <p>以下示例从中恢复<code class="codeph">projects</code>和<code class="codeph">tasks</code>表空间<a id="d127931e5196" class="indexterm-anchor"></a>在步骤<a href="rman-transporting-data-across-platforms.html#GUID-F83EC306-9E7A-46D2-8F7F-2DDD595E307D__CHDBFEBE">7中</a>创建的跨平台备份。备份在目标主机上的<code class="codeph">/tmp/xplat_restores</code>目录中设置<code class="codeph">trans_ts.bck</code> 。包含将这些表空间插入目标数据库所需的元数据的数据泵导出转储文件存储在<code class="codeph">/tmp/xplat_restores</code>目录中的<code class="codeph">trans_ts_dump.bck</code>中。
                              </p><pre class="oac_no_warn" dir="ltr">RMAN&gt; RESTORE FOREIGN TABLESPACE项目，来自BACKUPSET的新任务'/tmp/xplat_restores/trans_ts.bck'来自BACKUPSET的DUMP文件'/tmp/xplat_restores/trans_ts_dmp.bck';</pre></div>
                        </li>
                     </ol>
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-F83EC306-9E7A-46D2-8F7F-2DDD595E307D__GUID-E2F99BA8-DAC8-4674-92DB-91A39E741ED3">
                           <p class="notep1">也可以看看：</p>
                           <p>有关执行跨平台备份和还原操作的其他示例，请<a href="../rcmrf/BACKUP.html#RCMRF107" target="_blank"><span class="italic">参见Oracle数据库备份和恢复参考</span></a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="BRADV720"></a><div class="props_rev_3"><a id="GUID-346F0274-51A6-49D3-AB16-B8D1678655A1" name="GUID-346F0274-51A6-49D3-AB16-B8D1678655A1"></a><h3 id="BRADV-GUID-346F0274-51A6-49D3-AB16-B8D1678655A1" class="sect3"><span class="enumeration_section">28.9</span>使用不一致备份的表空间跨平台传输概述</h3>
               <div>
                  <p>RMAN使您可以跨平台传输不一致的表空间备份。不一致的表空间备份是表空间处于读/写模式时创建的一个或多个表空间的备份。术语“不一致”是指备份中的数据文件包含在检查点文件后进行的更改。跨平台不一致备份操作期间生成的<a href="glossary.html#GUID-9C271FBB-5FE5-4B80-B8E8-0536FF2EA1C1"><span class="xrefglossterm">外部数据文件</span></a>无法直接插入<a href="glossary.html#GUID-4CDA2F90-4918-4357-AE32-313264940FFA"><span class="xrefglossterm">目标数据库</span></a> 。必须先使它们保持一致，然后才能在目标数据库上打开它们。通过将表空间处于只读模式时创建的跨平台增量备份应用于这些外部数据文件，可以使外部数据文件保持一致。此备份还必须包含导出转储文件，该文件包含将传输的表空间插入目标数据库所需的元数据。
                  </p>
                  <p>不一致的表空间备份使您可以减少应用程序停机时间。当表空间联机并可供用户使用时，您将在源数据库上创建跨平台不一致的备份。第一个备份必须是0级增量备份。随后，创建较小的1级增量备份，其中包含自最近的1级备份以来对表空间所做的更改。即使在源数据库上创建了其他1级增量备份，也可以在目标数据库上还原和应用这些0级和1级增量备份。在开始在目标数据库上应用先前创建的第1级备份之前，您无需等到在源数据库上创建所有1级增量备份。由于在创建这些增量备份时表空间仍处于联机状态，因此在此阶段没有应用程序停机时间。创建最终的1级增量备份，并将表空间置于只读模式。应用程序停机时间从此阶段开始。此最终备份必须包括将表空间插入目标数据库所需的元数据。</p>
                  <p>在目标数据库上，首先还原0级增量备份以创建一组外部数据文件。接下来，将表空间处于读/写模式时创建的1级增量备份应用于这些还原的外部数据文件。按照创建它们的顺序应用这些备份。在大多数情况下，目标数据库会捕获最后一级增量备份，然后在源数据库上创建以只读模式放置的表空间进行的最终增量备份。最后一步是恢复在表空间处于只读模式时创建的最终1级增量备份，以使外部数据文件保持一致。此备份包含将表空间插入目标数据库所需的表空间元数据。</p>
                  <div class="infoboxnotealso" id="GUID-346F0274-51A6-49D3-AB16-B8D1678655A1__GUID-C36F9400-6AA3-4024-BA89-E789CB226CCB">
                     <p class="notep1">也可以看看：</p>
                     <p><span class="q">“ <a href="rman-transporting-data-across-platforms.html#GUID-06118644-AFC6-4BD4-8CAE-19BD3A886D0A" title="本节介绍使用备份集或映像副本执行不一致表空间的跨平台传输的高级步骤。">使用不一致的备份执行表空间的跨平台传输</a> ”</span></p>
                  </div>
               </div>
            </div><a id="BRADV776"></a><a id="BRADV777"></a><a id="BRADV778"></a><a id="BRADV775"></a><div class="props_rev_3"><a id="GUID-06118644-AFC6-4BD4-8CAE-19BD3A886D0A" name="GUID-06118644-AFC6-4BD4-8CAE-19BD3A886D0A"></a><h3 id="BRADV-GUID-06118644-AFC6-4BD4-8CAE-19BD3A886D0A" class="sect3"><span class="enumeration_section">28.10</span>使用不一致的备份执行表空间的跨平台传输</h3>
               <div>
                  <p>您可以使用备份集或映像副本跨平台传输不一致的表空间。使用<code class="codeph">BACKUP</code>命令使用备份集创建<a href="glossary.html#GUID-2E1D5532-31E0-4B78-AAF9-DEC27CC3927B"><span class="xrefglossterm">跨平台备份</span></a> 。<code class="codeph">CONVERT</code>命令使用映像副本创建跨平台备份。
                  </p>
                  <p>本节介绍如何将不一致的表空间从一个平台传输到另一个平台。包括使用备份集跨平台传输不一致表空间的示例。</p>
                  <p></p>
                  <div class="infoboxnotealso" id="GUID-06118644-AFC6-4BD4-8CAE-19BD3A886D0A__GUID-134E5BAB-79F0-445C-8663-46479E14D668">
                     <p class="notep1">也可以看看：</p>
                     <p>有关使用脚本使用备份集执行跨平台传输的更多信息，请参阅<a href="https://support.oracle.com/rs?type=doc&amp;id=1389592.1" target="_blank"><code class="codeph">https://support.oracle.com/rs?type=doc&amp;id=1389592.1</code></a>上的My Oracle Support说明1389592.1。</p>
                  </div>
                  <div class="infoboxnotealso" id="GUID-06118644-AFC6-4BD4-8CAE-19BD3A886D0A__GUID-DDADF64A-AC50-4269-BEEB-A8F78CD20C83">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><span class="q">“ <a href="rman-transporting-data-across-platforms.html#GUID-346F0274-51A6-49D3-AB16-B8D1678655A1">使用不一致备份的表空间跨平台传输概述</a> ”</span></p>
                        </li>
                        <li>
                           <p><a href="rman-transporting-data-across-platforms.html#GUID-6A00DACB-DB1F-4742-A561-49383E23C858" title="本节介绍使用备份集或映像副本执行不一致表空间的跨平台传输的高级步骤。">将不一致的表空间传输到不同平台的步骤</a></p>
                        </li>
                     </ul>
                  </div>
                  <div class="section">
                     <p class="subhead2" id="GUID-06118644-AFC6-4BD4-8CAE-19BD3A886D0A__GUID-3D73BBEE-AFDE-48B5-B6F5-447F4EE33598">关于在源数据库上创建不一致和增量备份</p>
                  </div>
                  <!-- class="section" -->
                  <p>在<code class="codeph">BACKUP</code>或<code class="codeph">CONVERT</code>命令中使用<code class="codeph">ALLOW INCONSISTENT</code>子句创建一个或多个表空间的跨平台不一致备份。当创建不一致的备份时，正在传输的表空间处于读/写模式。要创建增量备份，请使用<code class="codeph">BACKUP</code>命令中的<code class="codeph">INCREMENTAL LEVEL 1</code>子句。
                  </p>
                  <p>第一个不一致的备份是0级增量备份。随后，您可以创建多个跨平台的1级增量备份。最终的跨平台增量备份必须是在表空间为只读时创建的一致备份。创建此最终增量备份时，请使用<code class="codeph">BACKUP</code>命令中的<code class="codeph">DUMP FILE</code>子句创建包含表空间元数据的转储文件。
                  </p>
                  <p>使用<code class="codeph">CONVERT</code>命令时，必须使用“数据泵导出”实用程序显式创建包含表空间元数据的<a href="glossary.html#GUID-5C2A79F3-E089-41DC-B3F5-879FB6125CE5"><span class="xrefglossterm">导出转储文件</span></a> 。
                  </p>
                  <div class="infoboxnote" id="GUID-06118644-AFC6-4BD4-8CAE-19BD3A886D0A__GUID-13A35E72-BCFF-499D-A5C3-D6F716514C81">
                     <p class="notep1">注意：</p>
                     <p><code class="codeph">ALLOW INCONSISTENT</code>子句不能用于跨平台的整个数据库备份。
                     </p>
                  </div>
                  <div class="infoboxnotealso" id="GUID-06118644-AFC6-4BD4-8CAE-19BD3A886D0A__GUID-A89C4573-C7FB-49BE-AEC3-44144203D830">
                     <p class="notep1">也可以看看：</p>
                     <p><span class="q">“ <a href="rman-transporting-data-across-platforms.html#GUID-6A00DACB-DB1F-4742-A561-49383E23C858" title="本节介绍使用备份集或映像副本执行不一致表空间的跨平台传输的高级步骤。">将不一致的表空间传输到不同的平台的步骤</a> ”，</span>以获取有关指定SCN的信息</p>
                  </div>
                  <div class="section">
                     <p class="subhead2" id="GUID-06118644-AFC6-4BD4-8CAE-19BD3A886D0A__GUID-0B895A93-2706-4A64-9237-50B41324953F">关于在目标数据库上还原和恢复不一致的备份</p>
                  </div>
                  <!-- class="section" -->
                  <p>首先在<a href="glossary.html#GUID-4CDA2F90-4918-4357-AE32-313264940FFA"><span class="xrefglossterm">目标数据库</span></a>上还原表空间处于读/写模式时执行的跨平台级别0增量备份。此操作会创建还原备份并创建外部数据文件副本。这些外部数据文件不一致，因为创建备份时表空间未置于只读模式。要使这些外部数据文件保持一致并实现一致的检查点SCN，请按创建顺序应用增量备份。应用的最终增量备份必须是在表空间处于只读模式时创建的跨平台增量备份。接下来，要将表空间插入目标数据库，您可以还原并导入包含正在传输的表空间的元数据的转储文件。
                  </p>
                  <div class="section">
                     <p class="subhead2" id="GUID-06118644-AFC6-4BD4-8CAE-19BD3A886D0A__GUID-4F5AE7BE-FC65-4C26-B28A-5190EEDBC42D">将跨平台增量备份应用于已还原数据文件的要求</p>
                  </div>
                  <!-- class="section" -->
                  <p>要成功将跨平台增量表空间备份应用于一组还原的外部数据文件，必须满足以下条件：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>对于跨平台增量备份中包含的每个数据文件，起始SCN必须低于外部数据文件副本的当前检查点SCN。</p>
                     </li>
                     <li>
                        <p>不得修改由还原操作创建的外部数据文件副本。</p>
                        <p>例如，如果外部数据文件副本已插入<a href="glossary.html#GUID-4CDA2F90-4918-4357-AE32-313264940FFA"><span class="xrefglossterm">目标数据库</span></a> ，进行读/写，然后变为只读，则RMAN会认为此文件已被修改。
                        </p>
                     </li>
                  </ul>
               </div><a id="BRADV779"></a><div class="props_rev_3"><a id="GUID-6A00DACB-DB1F-4742-A561-49383E23C858" name="GUID-6A00DACB-DB1F-4742-A561-49383E23C858"></a><h4 id="BRADV-GUID-6A00DACB-DB1F-4742-A561-49383E23C858" class="sect4"><span class="enumeration_section">28.10.1</span>将不一致的表空间传输到不同平台的步骤</h4>
                  <div>
                     <p>本节介绍使用备份集或映像副本执行不一致表空间的跨平台传输的高级步骤。</p>
                     <p>使用备份集传输不一致表空间的先决条件在<span class="q">“</span>使用备份集<span class="q"><a href="rman-transporting-data-across-platforms.html#GUID-7E1B3B10-CDA2-4E79-9F4C-AC8E51BCDE54__CIHDJFGD">执行跨平台表空间传输的先决条件</a> ”中进行了介绍</span> 。<a href="../rcmrf/CONVERT.html#RCMRF192" target="_blank"><span class="italic">Oracle数据库备份和恢复参考</span></a>中介绍了使用映像副本（ <code class="codeph">CONVERT</code>命令）传输不一致表空间的先决条件。
                     </p>
                     <p>执行以下任务以将不一致的表空间传输到其他平台：</p>
                     <ol>
                        <li>
                           <p>创建在源数据库中传输一个以上表空间所需的文件，如<a href="rman-transporting-data-across-platforms.html#GUID-A909F0E6-5400-4F5D-8DF1-77E57EE68AA5">创建将表空间传输到不同平台所需的文件中所述</a></p>
                        </li>
                        <li>
                           <p>将文件从源主机传输到目标主机，如<a href="rman-transporting-data-across-platforms.html#GUID-15F54B2C-6022-4CF9-BC2E-C5B47135CC65">将源主机上创建的文件传输到目标主机中所述</a> 。
                           </p>
                        </li>
                        <li>
                           <p>恢复表空间并将其插入目标数据库，如<a href="rman-transporting-data-across-platforms.html#GUID-6168ACBF-61F6-4CA1-8EEB-4D1ED1F04C5D">恢复表空间并将其插入目标数据库中所述</a> 。
                           </p>
                        </li>
                     </ol>
                  </div><a id="BRADV780"></a><div class="props_rev_3"><a id="GUID-A909F0E6-5400-4F5D-8DF1-77E57EE68AA5" name="GUID-A909F0E6-5400-4F5D-8DF1-77E57EE68AA5"></a><h5 id="BRADV-GUID-A909F0E6-5400-4F5D-8DF1-77E57EE68AA5" class="sect5"><span class="enumeration_section">28.10.1.1</span>创建将表空间传输到不同平台所需的文件</h5>
                     <div>
                        <div class="section">
                           <p>此步骤包括在<a href="glossary.html#GUID-609A4BFA-A852-4459-AD52-05C49212753A"><span class="xrefglossterm">源数据库</span></a>中执行以下任务：</p>
                           <p></p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>如果正在传输的表空间是TDE加密的表空间，则指定在将主密钥存储到备份集之前用于包装主密钥的密码。</span><div>
                                 <p>以下命令将密码设置为<code class="codeph">encr_temp</code> 。
                                 </p><code class="codeph">RMAN&gt;通过encr_temp识别的SET PASSPHRASE;</code></div>
                           </li>
                           <li class="stepexpand"><span>创建必须传输到其他平台的表空间的跨平台级别0不一致备份。表空间处于读/写模式。</span><div>
                                 <p>使用<a id="d127931e5741" class="indexterm-anchor"></a><a id="d127931e5745" class="indexterm-anchor"></a> <code class="codeph">ALLOW INCONSISTENT</code> <a id="d127931e5753" class="indexterm-anchor"></a> <code class="codeph">BACKUP</code>命令中的<code class="codeph">INCREMENTAL LEVEL 0</code>子句指示备份是一个或多个表空间的不一致备份。
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>创建必须传输到另一个平台的表空间的跨平台1级增量备份。表空间处于读/写模式。</span><div>
                                 <p>在第一级0不一致备份之后，当表空间处于读/写模式时，您可以创建任意数量的1级增量备份。使用<a id="d127931e5770" class="indexterm-anchor"></a><a id="d127931e5774" class="indexterm-anchor"></a> <code class="codeph">ALLOW INCONSISTENT</code> <a id="d127931e5782" class="indexterm-anchor"></a> <code class="codeph">INCREMENTAL LEVEL 1</code>子句用于创建这些增量备份。当表空间处于读/写模式时执行频繁的增量备份是有利的，因为这会减少需要使用表空间为只读时采用的最终增量备份应用于<a href="glossary.html#GUID-4CDA2F90-4918-4357-AE32-313264940FFA"><span class="xrefglossterm">目标数据库</span></a>的已更改数据量。
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>使用只读模式下的表空间创建表空间的跨平台1级增量备份。</span><div>
                                 <p>这是最终的增量备份，它必须包含转储文件，该文件包含将传输的表空间插入目标数据库所需的元数据。使用<a id="d127931e5800" class="indexterm-anchor"></a> <code class="codeph">BACKUP</code>命令中的<code class="codeph">INCREMENTAL LEVEL 1</code>子句用于创建1级增量备份。
                                 </p>
                                 <p>使用<code class="codeph">BACKUP</code>命令执行跨平台传输时，请使用<code class="codeph">DATAPUMP</code>子句创建数据泵导出转储文件以及增量备份。转储文件在单独的备份集中创建。使用映像副本创建跨平台增量备份时，必须使用“数据泵导出”实用程序显式创建包含表空间元数据的转储文件。
                                 </p>
                              </div>
                           </li>
                        </ol>
                     </div>
                  </div><a id="BRADV781"></a><div class="props_rev_3"><a id="GUID-15F54B2C-6022-4CF9-BC2E-C5B47135CC65" name="GUID-15F54B2C-6022-4CF9-BC2E-C5B47135CC65"></a><h5 id="BRADV-GUID-15F54B2C-6022-4CF9-BC2E-C5B47135CC65" class="sect5"><span class="enumeration_section">28.10.1.2</span>将源主机上创建的文件传输到目标主机</h5>
                     <div>
                        <div class="section">
                           <p>使用FTP，操作系统复制命令或某些其他机制将在<a href="glossary.html#GUID-609A4BFA-A852-4459-AD52-05C49212753A"><span class="xrefglossterm">源数据库</span></a>中创建的备份集，数据文件和转储文件移动到目标主机。
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="BRADV782"></a><div class="props_rev_3"><a id="GUID-6168ACBF-61F6-4CA1-8EEB-4D1ED1F04C5D" name="GUID-6168ACBF-61F6-4CA1-8EEB-4D1ED1F04C5D"></a><h5 id="BRADV-GUID-6168ACBF-61F6-4CA1-8EEB-4D1ED1F04C5D" class="sect5"><span class="enumeration_section">28.10.1.3</span>恢复表空间并将其插入目标数据库</h5>
                     <div>
                        <div class="section">
                           <p>此步骤包括在<a href="glossary.html#GUID-4CDA2F90-4918-4357-AE32-313264940FFA"><span class="xrefglossterm">目标数据库</span></a>上执行以下任务：</p>
                           <p></p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>如果正在传输的表空间是TDE-encyrpted表空间，则提供源数据库上用于包装主密钥的密码。</span><div>
                                 <p>以下示例将密码设置为encr_temp。</p><pre class="oac_no_warn" dir="ltr">由encr_temp识别的SET PASSPHRASE;</pre></div>
                           </li>
                           <li class="stepexpand"><span>恢复跨平台级别0不一致的备份。</span><div>
                                 <p>此还原操作在目标数据库上创建一组<a href="glossary.html#GUID-9C271FBB-5FE5-4B80-B8E8-0536FF2EA1C1"><span class="xrefglossterm">外部数据文件</span></a> 。这些外部数据文件不一致，需要先恢复才能插入目标数据库。
                                 </p>
                                 <p>使用<code class="codeph">RESTORE</code>命令恢复跨平台级别0不一致的备份。还原包含备份集的跨平台不一致备份时，请使用<a id="d127931e5999" class="indexterm-anchor"></a> <code class="codeph">FROM BACKUPSET</code>子句指定包含级别0不一致备份的备份集的名称。
                                 </p>
                                 <div class="infoboxnotealso" id="GUID-6168ACBF-61F6-4CA1-8EEB-4D1ED1F04C5D__GUID-E1DC5FD1-9893-4806-A466-C9F44A6FF9E3">
                                    <p class="notep1">也可以看看：</p>
                                    <p>有关使用<code class="codeph">RESTORE</code>命令进行跨平台还原操作的信息<a href="../rcmrf/RESTORE.html#RCMRF149" target="_blank"><span class="italic">，请参见“Oracle数据库备份和恢复参考</span></a> ”</p>
                                 </div>
                              </div>
                           </li>
                           <li class="stepexpand"><span>将表空间处于读/写模式时采用的跨平台1级增量备份应用于步骤1中还原的外部数据文件。</span><div>
                                 <p>如果您创建了多个跨平台的1级增量备份，则必须按创建它们的顺序应用这些增量备份。使用<code class="codeph">RECOVER</code>命令应用增量备份。该<a id="d127931e6026" class="indexterm-anchor"></a> <code class="codeph">RECOVER</code>命令的<code class="codeph">FOREIGN DATAFILECOPY</code>子句必须列出必须应用增量备份的每个数据文件。使用<code class="codeph">FROM BACKPSET</code>子句指定包含要恢复的数据的备份集的名称。
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>将表空间处于只读模式时采用的跨平台1级增量备份应用于步骤1中还原的外部数据文件。</span><div>
                                 <p>使用<code class="codeph">RECOVER</code>命令应用增量备份。该<a id="d127931e6049" class="indexterm-anchor"></a> <code class="codeph">RECOVER</code>命令的<code class="codeph">FOREIGN DATAFILECOPY</code>子句必须列出需要应用增量备份的每个数据文件。使用<code class="codeph">FROM BACKPSET</code>子句指定包含要恢复的数据的备份集的名称。
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>还原包含表空间元数据的备份集。</span><div>
                                 <p>使用<code class="codeph">RESTORE</code>命令还原包含在跨平台增量备份期间创建的转储文件的备份集。创建此备份时，表空间处于只读模式。您可以选择使用<a id="d127931e6072" class="indexterm-anchor"></a> <code class="codeph">DUMP FILE</code>子句指定目标数据库上的转储文件的名称和<a id="d127931e6080" class="indexterm-anchor"></a> <code class="codeph">DATAPUMP DESTINATION</code>子句，用于指定还原转储文件的目录。如果省略这些子句，RMAN将使用配置的默认值。使用备份集传输数据时，请使用<code class="codeph">FROM BACKUPSET</code>子句指定包含转储文件的备份集的名称。
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>将包含表空间元数据的转储文件导入目标数据库。</span><div>
                                 <p>使用“数据泵导入”实用程序将恢复的表空间插入目标数据库，以导入在增量备份期间创建的转储文件。您必须以具有<code class="codeph">SYSDBA</code>权限的用户身份运行Data Pump Import实用程序。
                                 </p>
                              </div>
                           </li>
                        </ol>
                     </div>
                  </div>
               </div><a id="BRADV783"></a><div class="props_rev_3"><a id="GUID-F497679C-9413-4AB9-85AD-F364021FA704" name="GUID-F497679C-9413-4AB9-85AD-F364021FA704"></a><h4 id="BRADV-GUID-F497679C-9413-4AB9-85AD-F364021FA704" class="sect4"><span class="enumeration_section">28.10.2</span>示例：使用备份集执行跨平台不一致的表空间传输</h4>
                  <div>
                     <div class="section">
                        <p>此示例将不一致的表空间<code class="codeph">my_tbs</code>从<a href="glossary.html#GUID-609A4BFA-A852-4459-AD52-05C49212753A"><span class="xrefglossterm">源数据库</span></a> （位于Sun Solaris平台上）传输到Linux x86 64位平台上的<a href="glossary.html#GUID-4CDA2F90-4918-4357-AE32-313264940FFA"><span class="xrefglossterm">目标数据库</span></a> 。
                        </p>
                        <div class="infoboxnotealso" id="GUID-F497679C-9413-4AB9-85AD-F364021FA704__GUID-C56086F0-DDBD-4FCC-B266-6897CF509345">
                           <p class="notep1">也可以看看：</p>
                           <p><span class="q">“ <a href="rman-transporting-data-across-platforms.html#GUID-6A00DACB-DB1F-4742-A561-49383E23C858" title="本节介绍使用备份集或映像副本执行不一致表空间的跨平台传输的高级步骤。">将不一致的表空间传输到不同平台的</a></span>步骤<span class="q">”，</span>以获取有关此示例中每个步骤的概念性信息</p>
                        </div>
                        <p>以下步骤使您可以使用备份集跨平台传输不一致的表空间<code class="codeph">my_tbs</code> ：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>以授予<code class="codeph">SYSBACKUP</code>权限的用户身份连接到源数据库。</span><div><pre class="oac_no_warn" dir="ltr">RMAN&gt; CONNECT TARGET“sbu @ prod_source AS SYSBACKUP”;</pre></div>
                        </li>
                        <li class="stepexpand"><span>确保满足将表空间传输到另一个平台所需的先决条件。</span><div>
                              <div class="infoboxnotealso" id="GUID-F497679C-9413-4AB9-85AD-F364021FA704__GUID-6B5CD833-8705-47E3-9468-36C68EB486B6">
                                 <p class="notep1">也可以看看：</p>
                                 <p><span class="q">“ <a href="rman-transporting-data-across-platforms.html#GUID-7E1B3B10-CDA2-4E79-9F4C-AC8E51BCDE54__CIHDJFGD">使用备份集执行跨平台表空间传输的先决条件</a> ”</span></p>
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>当表空间为读/写模式时，创建表空间<code class="codeph">my_tbs</code>的跨平台0级不一致备份。此备份存储在目录<code class="codeph">/tmp/xplat_backups</code>名为<code class="codeph">my_tbs_incon.bck</code>的备份集中。</span><div><pre class="oac_no_warn" dir="ltr">运输备份允许不一致的增量级别0表格my_tbs格式'/tmp/xplat_backups/my_tbs_incon.bck';</pre><p>由于使用<code class="codeph">FOR TRANSPORT</code>而不是<code class="codeph">TO PLATFORM</code> ，因此可以在任何平台上恢复此跨平台备份。转换将在目标数据库上执行。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>创建表空间<code class="codeph">my_tbs</code>的跨平台1级增量备份，其中包含在步骤3中创建备份后所做的更改。表空间仍处于读/写模式。这种增量备份存储在<code class="codeph">my_tbs_incon1.bck</code>目录<code class="codeph">/tmp/xplat_backups</code> 。</span><div><pre class="oac_no_warn" dir="ltr">运输备份允许不一致的增量级别1表格my_tbs格式'/tmp/xplat_backups/my_tbs_incon1.bck';</pre><p>为了最大限度地减少应用程序停机时间，在源表空间仍处于读/写模式时，可以在目标数据库上还原并应用步骤3和4中创建的0级和1级增量备份。当目标数据库赶上最后一级增量备份时，您可以创建最终增量备份，并将表空间置于只读模式。</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>将表空间<code class="codeph">my_tbs</code>置于只读模式。</span><div><pre class="oac_no_warn" dir="ltr">ALTER TABLESPACE my_tbs只读;</pre></div>
                        </li>
                        <li class="stepexpand"><span>创建表空间<code class="codeph">my_tbs</code>的最终跨平台1级增量备份。此备份包含在步骤4中创建的备份后对数据库所做的更改。它必须包含包含表空间元数据的<a href="glossary.html#GUID-5C2A79F3-E089-41DC-B3F5-879FB6125CE5"><span class="xrefglossterm">导出转储文件</span></a> 。</span><div><pre class="oac_no_warn" dir="ltr">备用运输增量级别1表格my_tbs FORMAT'/ tmp / xplat_backups / my_tbs_incr.bck'DATAPUMP FORMAT' / tmp / xplat_backups / my_tbs_incr_dp.bck';</pre><p>增量备份存储在<code class="codeph">my_tbs_incr.bck</code> 。包含表空间元数据的导出转储文件存储在名为<code class="codeph">my_tbs_incr_dp.bck</code>的备份集中。
                              </p>
                              <p>以下是在此步骤中运行的<code class="codeph">BACKUP</code>命令的格式化输出。编辑输出以仅显示相关信息。请注意，转储文件名为<code class="codeph">backup_tts_RDBMS_13462.dmp</code> ，它是操作系统分配的名称，存储在<code class="codeph">DESTINATION</code>子句指定的目录中。
                              </p><pre class="oac_no_warn" dir="ltr">在12-SEP-12开始备份......执行指定表空间的元数据导出...EXPDP&gt;启动“SYS”。“TRANSPORT_EXP_RDBMS_zocc”：.........EXPDP&gt; ************************************************ *************************** EXPDP&gt;为SYS.TRANSPORT_EXP_RDBMS_zocc设置的转储文件是：EXPDP&gt; / ade / b / 191802369 / oracle / backup_tts_RDBMS_13462 .dmp EXPDP&gt; ********************************************** **************************** .......出口完成.............通道ORA_DISK_1：在备份集输入数据文件中指定数据文件文件号= 00006 name = / ade / b / 191802369 / oracle / dbs / tbs_11.f输入数据文件文件号= 00007名称= / ade / b / 191802369 / oracle / dbs / tbs_12.f输入数据文件文件号= 00020 name = / ade / b / 191802369 / oracle / dbs / tbs_14.f输入数据文件文件号= 00010 name = / ade / b / 191802369 / oracle / dbs / tbs_13。 f ...... ......在12-SEP-12完成备份</pre></div>
                        </li>
                        <li class="stepexpand"><span>将步骤3,4和6中生成的备份集和导出转储文件从源主机移动到目标主机上的所需目录。</span><div>
                              <p>在此示例中，所有必需的文件都将移动到目标主机上的目录<code class="codeph">/tmp/xplat_restores</code> 。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>以授予<code class="codeph">SYSBACKUP</code>权限的用户身份连接到目标数据库。</span><div><pre class="oac_no_warn" dir="ltr">RMAN&gt; CONNECT TARGET“sbu @ prod_dest AS SYSBACKUP”;</pre><p><code class="codeph">sbu</code>是在目标数据库中被授予<code class="codeph">SYSBACKUP</code>权限的用户。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>恢复步骤3中创建的跨平台级别0不一致备份。</span><div>
                              <p>使用<code class="codeph">FOREIGN DATAFILE</code>子句指定必须还原的数据文件。<code class="codeph">FROM PLATFORM</code>子句指定创建备份的平台的名称。转换目标数据库上的备份需要此子句。
                              </p>
                              <p>在此示例中，具有数字6,7,20和10的数据文件将还原为与该数据文件对应的<code class="codeph">FORMAT</code>子句中指定的名称。数据文件编号必须是源数据库上使用的编号。您可以从步骤3中创建的不一致备份的RMAN输出中获取数据文件编号。
                              </p><pre class="oac_no_warn" dir="ltr">从PLATFORM恢复'Solaris [tm] OE（64位）'FOREIGN DATAFILE 6 FORMAT'/ ttt /aux / mytbs_6.df'，7 FORMAT'/ ttt /aux / mytbs_7.df'，20 FORMAT'/ tmp / aux /mytbs_20.df'，10格式'/tmp /aux / mytbs_10.df'来自BACKUPSET'/ tmp / xplat_restores / my_tbs_incon.bck';</pre></div>
                        </li>
                        <li class="stepexpand"><span>通过应用已创建的第一个跨平台1级增量备份，恢复在步骤9中获取的<a href="glossary.html#GUID-9C271FBB-5FE5-4B80-B8E8-0536FF2EA1C1"><span class="xrefglossterm">外部数据文件</span></a>步骤4。</span><div><pre class="oac_no_warn" dir="ltr">从PLATFORM'Solaris [tm] OE（64位）'FOREIGN DATAFILECOPY'/tmp/aux/mytbs_6.df','/tmp/aux/mytbs_7.df','/tmp/aux/mytbs_20.df'中恢复， '/tmp/aux/mytbs_10.df'FROM BACKUPSET'/tmp/xplat_restores/my_tbs_incon1.bck';</pre><p>在此示例中，应用于还原的外部数据文件的增量备份存储在<code class="codeph">/tmp/xplat_restores/my_tbs_incon1.bck</code> 。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>通过应用在步骤6中创建的最终跨平台1级增量备份，恢复在步骤9中获取的外部数据文件。使用只读模式的表空间创建此备份。</span><div><pre class="oac_no_warn" dir="ltr">从PLATFORM'Solaris [tm] OE（64位）'FOREIGN DATAFILECOPY'/tmp/aux/mytbs_6.df','/tmp/aux/mytbs_7.df','/tmp/aux/mytbs_20.df'中恢复， '/tmp/aux/mytbs_10.df'FRRO BACKUPSET'/tmp/xplat_restores/my_tbs_incr.bck';</pre><p>在此示例中，应用于还原的外部数据文件的增量备份存储在<code class="codeph">/tmp/xplat_restores/my_tbs_incr.bck</code> 。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>还原包含导出转储文件的备份集。此转储文件包含将表空间插入目标数据库所需的表空间元数据。</span><div><pre class="oac_no_warn" dir="ltr">从PLATFORM恢复'Solaris [tm] OE（64位）'DUMP FILE'my_tbs_restore_md.dmp'DATAPUMP DESTINATION'/ tmp / dump'FRONUPSET'/tmp/xplat_restores/my_tbs_incr_dp.bck';</pre><p>在此示例中，转储文件将还原到目录<code class="codeph">/tmp/dump</code>名为<code class="codeph">my_tbs_restore_md.dmp</code>的文件。您可以省略转储文件的名称和<code class="codeph">DATAPUMP DESTINATION</code>子句，并允许RMAN对这些参数使用操作系统默认值。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>将表空间插入目标数据库。使用Data Pump导入实用程序将包含表空间元数据的转储文件导入目标数据库。</span><div><pre class="oac_no_warn" dir="ltr">＃impdp directory = dp_dir dumpfile = backup_tts_RDBMS_13462.dmp transport_datafiles ='/ tmp / aux / mytbs_6.df'，'/ tmp / aux / mytbs_7.df'，'/ tmp / aux / mytbs_20.df'，'/ tmp / aux /mytbs_10.df'nologfile = Y</pre><p>提示输入用户名和密码时，请输入<code class="codeph">SYS</code>用户的凭据。在此示例中， <code class="codeph">dp_dir</code>是使用<code class="codeph">CREATE DIRECTORY</code>命令创建的目录对象，并映射到<code class="codeph">/tmp</code>目录。
                              </p>
                           </div>
                        </li>
                     </ol>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-6D2F4279-B6CC-4BB3-AE56-4D3D40A4CBF3" name="GUID-6D2F4279-B6CC-4BB3-AE56-4D3D40A4CBF3"></a><h3 id="BRADV-GUID-6D2F4279-B6CC-4BB3-AE56-4D3D40A4CBF3" class="sect3"><span class="enumeration_section">28.11</span>通过网络执行数据文件的跨平台传输</h3>
               <div>
                  <p>RMAN使您可以通过网络执行数据文件的跨平台传输。</p>
                  <div class="section"></div>
                  <!-- class="section" -->
                  <div class="section">RMAN可以连接到源数据库，以备份集格式创建所需的数据文件备份，将它们传输到目标，然后还原目标数据库上的备份。通过使用<code class="codeph">FROM SERVICE</code>子句以及<code class="codeph">RESTORE FOREIGN DATAFILE</code>命令来执行此任务。
                  </div>
                  <!-- class="section" -->
                  <div class="p">您需要通过向<code class="codeph">tnsnames.ora</code>和<code class="codeph">listener.ora</code>文件添加所需的条目来在源数据库和目标数据库之间建立连接。源数据库和目标数据库的<code class="codeph">COMPATIBLE</code>初始化参数必须设置为12.2。
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>以具有<code class="codeph">SYSDBA</code>或<code class="codeph">SYSBACKUP</code>权限的用户身份打开RMAN并将<code class="codeph">AS TARGET</code>连接到目标数据库（必须在其上恢复数据文件）</span></li>
                     <li class="stepexpand"><span>使用源数据库上的相应数据文件还原所需的数据文件。</span><div>
                           <p><code class="codeph">FROM SERVICE</code>子句指定必须从中还原数据文件的源数据库的服务名称。
                           </p>
                           <p>以下语句使用服务名称为<code class="codeph">source_db</code>的源数据库中的数据文件来还原数据文件21和22。<code class="codeph">TO NEW</code>子句指示为指定表空间还原的数据文件必须使用与源数据库上的新名称不同的新名称。
                           </p><pre class="pre codeblock"><code>从服务'source_db'恢复FOREIGN DATAFILE 21,22</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>恢复在步骤2中还原的外部数据文件。</span><div>
                           <p><code class="codeph">FROM SERVICE</code>子句指定源数据库的服务名称。
                           </p>
                           <p>以下语句使用源服务器名为<code class="codeph">source_db</code>的源数据库中的数据文件来恢复<code class="codeph">FOREIGN DATAFILECOPY</code>子句指定的外部数据文件。
                           </p><pre class="pre codeblock"><code>RECOVER FOREIGN DATAFILECOPY'/u01/oracle/oradata/db1_tbs21.dbf','/u01/oracle/oradata/db1_tbs22.db'FROM SERVICE'source_db';</code></pre></div>
                     </li>
                  </ol>
               </div>
            </div><a id="BRADV784"></a><div class="props_rev_3"><a id="GUID-27F404E2-4D45-4C99-B111-CD618F740C2B" name="GUID-27F404E2-4D45-4C99-B111-CD618F740C2B"></a><h3 id="BRADV-GUID-27F404E2-4D45-4C99-B111-CD618F740C2B" class="sect3"><span class="enumeration_section">28.12</span>在CDB和PDB中执行跨平台数据传输</h3>
               <div>
                  <p>RMAN支持在多租户环境中跨平台传输数据。您可以跨平台传输整个<a href="glossary.html#GUID-3E156A59-F6CC-4A2A-9749-DB7D1CE25F13"><span class="xrefglossterm">多租户容器数据库（CDB）</span></a> ，仅限<a href="glossary.html#GUID-EA3DB8F4-F68E-4FC5-A599-32A4886FFF8A"><span class="xrefglossterm">根</span></a> ，或一个或多个可插拔数据库（ <a href="glossary.html#GUID-993BFB3F-3305-481C-999D-26132095DEC9"><span class="xrefglossterm">PDB</span></a> ）。可以使用映像副本或备份集来执行跨平台传输。本章中的信息适用于CDB和PDB，其差异在以下各节中描述。
                  </p>
                  <p>本节包含以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="rman-transporting-data-across-platforms.html#GUID-7523B82F-0DF6-4E1F-8FE6-DFDC049BA002">关于PDB的跨平台传输</a></p>
                     </li>
                     <li>
                        <p><a href="rman-transporting-data-across-platforms.html#GUID-0BA12DA0-9539-4496-8BAA-D20E16375758">执行整个CDB的跨平台传输</a></p>
                     </li>
                     <li>
                        <p><a href="rman-transporting-data-across-platforms.html#GUID-D658A389-1BA6-4793-B564-96357264A0A7" title="可插拔数据库（PDB）可以被传输并插入目标多租户容器数据库（CDB），该数据库位于与源CDB不同的平台上。除了PDB的RMAN备份之外，还需要将PDB插入目标CDB所需的元数据。">执行封闭式PDB的跨平台传输</a></p>
                     </li>
                     <li>
                        <p><a href="rman-transporting-data-across-platforms.html#GUID-0CBA7F68-0AEB-43B8-B9F6-AD7BB0D788F2" title="您可以使用不一致和一致的备份组合来传输PDB并将其插入位于不同平台上的CDB。不一致的备份使您可以减少应用程序停机时间，因为PDB可以在执行备份时打开">使用不一致的备份执行PDB的跨平台传输</a></p>
                     </li>
                     <li>
                        <p><a href="rman-transporting-data-across-platforms.html#GUID-A41CEF69-4D73-45F4-BDF8-DCCAEB20C08F">在PDB中执行表空间的跨平台传输</a></p>
                     </li>
                  </ul>
               </div><a id="BRADV786"></a><div class="props_rev_3"><a id="GUID-7523B82F-0DF6-4E1F-8FE6-DFDC049BA002" name="GUID-7523B82F-0DF6-4E1F-8FE6-DFDC049BA002"></a><h4 id="BRADV-GUID-7523B82F-0DF6-4E1F-8FE6-DFDC049BA002" class="sect4"><span class="enumeration_section">28.12.1</span>关于PDB的跨平台传输</h4>
                  <div>
                     <div class="section">
                        <p>要将整个PDB传输到不同的平台，源平台和目标平台必须使用相同的endian格式。源CDB和目标CDB上的<code class="codeph">COMPATIBLE</code>参数必须设置为12.1或更高。
                        </p>
                        <p>使用以下技术之一跨平台传输PDB：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p>连接到root并使用<code class="codeph">BACKUP FOR TRANSPORT ...PLUGGABLE DATABASE</code>或<code class="codeph">BACKUP TO PLATFORM ...PLUGGABLE DATABASE</code>命令用于创建一个或多个PDB的<a href="glossary.html#GUID-2E1D5532-31E0-4B78-AAF9-DEC27CC3927B"><span class="xrefglossterm">跨平台备份</span></a> 。
                              </p>
                              <p>连接到根目录后，以下命令将创建PDB <code class="codeph">hr_pdb</code>和<code class="codeph">sales_pdb</code>的跨平台备份。在创建跨平台备份之前，PDB必须是只读模式。
                              </p><pre class="oac_no_warn" dir="ltr">BACKUP FOR TRANSPORT PLUGGABLE DATABASE hr_pdb，sales_pdb FORMAT'/ tmp / backups / pdb_％U';</pre></li>
                           <li>
                              <p>连接到PDB并使用<code class="codeph">BACKUP FOR TRANSPORT</code>或<code class="codeph">BACKUP TO PLATFORM</code>命令创建可用于将PDB数据传输到另一个平台的备份集。
                              </p>
                           </li>
                        </ul>
                        <div class="infoboxnote" id="GUID-7523B82F-0DF6-4E1F-8FE6-DFDC049BA002__GUID-CCFC800A-8B5F-4978-AEF5-04EE55D2AE1D">
                           <p class="notep1">注意：</p>
                           <p>不支持使用<code class="codeph">CONVERT</code>命令执行一个或多个PDB的跨平台数据传输。
                           </p>
                        </div>
                        <div class="infoboxnotealso" id="GUID-7523B82F-0DF6-4E1F-8FE6-DFDC049BA002__GUID-145356A5-D04E-499E-ABDA-F14F1D313FB0">
                           <p class="notep1">也可以看看：</p>
                           <p><span class="q">“ <a href="starting-interacting-with-rman-client.html#GUID-B397ADD8-D9CF-4DDA-B6AC-8C5FF04447AD" title="您可以将RMAN客户端连接到多租户容器数据库（CDB）和可插拔数据库（PDB）。">与CDB建立RMAN连接</a> ”</span></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="BRADV785"></a><div class="props_rev_3"><a id="GUID-0BA12DA0-9539-4496-8BAA-D20E16375758" name="GUID-0BA12DA0-9539-4496-8BAA-D20E16375758"></a><h4 id="BRADV-GUID-0BA12DA0-9539-4496-8BAA-D20E16375758" class="sect4"><span class="enumeration_section">28.12.2</span>执行整个CDB的跨平台传输</h4>
                  <div>
                     <div class="section">
                        <p>在CDB中，跨平台传输数据的步骤与用于非CDB的步骤类似。唯一的区别是，在源<a href="glossary.html#GUID-4CDA2F90-4918-4357-AE32-313264940FFA"><span class="xrefglossterm">数据库</span></a>和<a href="glossary.html#GUID-4CDA2F90-4918-4357-AE32-313264940FFA"><span class="xrefglossterm">目标数据库上</span></a> ，必须以具有公共<code class="codeph">SYSBACKUP</code>或<code class="codeph">SYSDBA</code>权限的<a href="glossary.html#GUID-2B102186-15BD-443C-B375-8CB0D442CF5F"><span class="xrefglossterm">公共用户</span></a>身份连接到根。
                        </p>
                        <div class="infoboxnotealso" id="GUID-0BA12DA0-9539-4496-8BAA-D20E16375758__GUID-E76A0E5B-D72F-4222-8B32-AAB624E3ACA9">
                           <p class="notep1">也可以看看：</p>
                           <p><span class="q">“ <a href="rman-transporting-data-across-platforms.html#GUID-76834111-5476-4591-A472-7DA5E2F4464D">使用备份集执行跨平台数据库传输</a> ”</span></p>
                        </div>
                        <p>要传输整个CDB，源平台和目标平台必须使用相同的endian格式。</p>
                        <p><code class="codeph">BACKUP FOR TRANSPORT</code>或<code class="codeph">BACKUP TO PLATFORM</code>命令创建整个CDB的<a href="glossary.html#GUID-2E1D5532-31E0-4B78-AAF9-DEC27CC3927B"><span class="xrefglossterm">跨平台备份</span></a> 。 <code class="codeph">CONVERT</code>命令创建可以传输到不同平台的CDB的映像副本。
                        </p>
                        <p>以下命令连接到root时，会创建整个CDB的跨平台备份：</p><pre class="oac_no_warn" dir="ltr">备份到平台'Linux x86 64位'数据库格式'/ tmp / backups / cdb_％U;</pre><p>在还原目标数据库上的跨平台备份时， <code class="codeph">RESTORE DATABASE</code>命令将还原整个CDB。</p>
                        <div class="infoboxnotealso" id="GUID-0BA12DA0-9539-4496-8BAA-D20E16375758__GUID-7CBC0EB7-7E51-4A52-B370-B42F79F18DD5">
                           <p class="notep1">也可以看看：</p>
                           <p><span class="q">“ <a href="starting-interacting-with-rman-client.html#GUID-B397ADD8-D9CF-4DDA-B6AC-8C5FF04447AD" title="您可以将RMAN客户端连接到多租户容器数据库（CDB）和可插拔数据库（PDB）。">与CDB建立RMAN连接</a> ”</span></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-D658A389-1BA6-4793-B564-96357264A0A7" name="GUID-D658A389-1BA6-4793-B564-96357264A0A7"></a><h4 id="BRADV-GUID-D658A389-1BA6-4793-B564-96357264A0A7" class="sect4"><span class="enumeration_section">28.12.3</span>执行封闭式PDB的跨平台传输</h4>
                  <div>
                     <p>可插拔数据库（PDB）可以被传输并插入目标多租户容器数据库（CDB），该数据库位于与源CDB不同的平台上。除了PDB的RMAN备份之外，还需要将PDB插入目标CDB所需的元数据。</p>
                     <div class="section">
                        <p></p>
                     </div>
                     <!-- class="section" -->
                     <div class="p">
                        <p>源CDB和目标CDB上的<code class="codeph">COMPATIBLE</code>参数必须设置为12.2。源CDB和目标CDB必须使用相同的endian格式。
                        </p>
                        <p>要将已关闭的PDB跨平台传输到目标CDB：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>在源CDB上执行以下步骤：</span><ol type="a">
                              <li class="substepexpand"><span>使用<code class="codeph">SYSDBA</code>或<code class="codeph">SYSBACKUP</code>权限以普通用户身份连接到root用户。</span></li>
                              <li class="substepexpand"><span>关闭需要运输的PDB。</span><div>
                                    <p>以下语句关闭PDB <code class="codeph">hr_pdb</code> 。
                                    </p><pre class="pre codeblock"><code>RMAN&gt; ALTER PLUGGABLE DATABASE hr_pdb立即关闭;</code></pre></div>
                              </li>
                              <li class="substepexpand"><span>创建必须使用<code class="codeph">BACKUP PLUGGABLE DATABASE</code>命令传输的PDB的跨平台完整备份。</span><div>
                                    <p>要创建跨平台备份，请包含<code class="codeph">FOR TRANSPORT</code>或<code class="codeph">TO PLATFORM</code>子句。
                                    </p>
                                    <p>以下示例为<code class="codeph">Linux x86 64-bit</code>平台创建PDB <code class="codeph">hr_pdb</code>的跨平台备份。将此PDB插入目标CDB所需的元数据是使用<code class="codeph">UNPLUG INTO</code>子句指定的，并存储在XML文件<code class="codeph">metadata_hrpdb.xml</code> 。
                                    </p><pre class="pre codeblock"><code>BACKUP TO PLATFORM ='Linux x86 64-bit'UNPLUG INTO'/u01/oradata/backups/metadata_hrpdb.xml'PLUGGABLE DATABASE hr_pdb FORMAT'/u01/oradata/backups/transport_hrpdb.bck';</code></pre></div>
                              </li>
                           </ol>
                        </li>
                        <li class="stepexpand"><span>将备份集和步骤1c中创建的XML文件传输到目标CDB。</span></li>
                        <li class="stepexpand"><span>在目标CDB上执行以下步骤：</span><ol type="a">
                              <li class="substepexpand"><span>使用<code class="codeph">SYSDBA</code>或<code class="codeph">SYSBACKUP</code>权限以普通用户身份连接到root用户。</span></li>
                              <li class="substepexpand"><span>确保CDB以读写模式打开。</span><div>
                                    <p>以下命令显示CDB的当前模式。</p><pre class="pre codeblock"><code>RMAN&gt; SELECT open_mode FROM V $ DATABASE;</code></pre></div>
                              </li>
                              <li class="substepexpand"><span>使用<code class="codeph">DBMS_PDB.CHECK_PLUG_COMPATIBILITY</code>过程确定正在传输的源PDB是否与目标CDB兼容。</span><div>
                                    <p>以下函数确定源PDB <code class="codeph">hr_pdb</code> （其元数据存储在XML文件<code class="codeph">metadata_hrpdb.xml</code> ）是否可以插入目标CDB。函数返回<code class="codeph">TRUE</code>是源PDB与目标CDB兼容。</p><pre class="pre codeblock"><code>SQL&gt; declare 2 c boolean; 3开始4 c：= dbms_pdb.check_plug_compatibility（'/ u02 / backup_restore / metadata_hrpdb.xml'，'HR_PDB'）; 5 if（c）then dbms_output.put_line（'True'）; 6 else dbms_output.put_line（'False'）; 7结束如果; 8结束; 9 / PL / SQL过程成功完成。
</code></pre></div>
                              </li>
                              <li class="substepexpand"><span>还原在源CDB上创建的PDB备份。</span><div>
                                    <p><code class="codeph">USING</code>子句指定XML文件的名称，该文件包含将源PDB插入目标CDB所需的元数据。要将数据文件复制到XML文件中描述的位置以外的其他位置，请使用<code class="codeph">FILE_NAME_CONVERT</code>子句。
                                    </p>
                                    <p>以下语句将恢复存储在backupset <code class="codeph">transport_hrpdb.bck</code>中的PDB <code class="codeph">hr_pdb</code>的备份。此PDB的元数据存储在<code class="codeph">metadata_hrpdb.xml</code> 。
                                    </p><pre class="pre codeblock"><code>恢复使用'/u02/backup_restore/metadata_hrpdb.xml'FOREIGN PLUGGABLE DATABASE hr_pdb格式'/ u02 / oracle / oradata /％U'FRACKUPSET'/u02/backup_restore/transport_hrpdb.bck';</code></pre></div>
                              </li>
                              <li class="substepexpand"><span>打开已恢复的PDB。</span><div>
                                    <p>以下命令将打开PDB <code class="codeph">hr_pdb</code> 。
                                    </p><pre class="pre codeblock"><code>RMAN&gt; ALTER PLUGGABLE DATABASE hr_pdb OPEN;</code></pre><div class="infoboxnote" id="GUID-D658A389-1BA6-4793-B564-96357264A0A7__GUID-02F4BBFB-3DDB-48F9-90D1-4D76AF4F113C">
                                       <p class="notep1">注意：</p>
                                       <p>如果目标数据库上存在与正在传输的PDB同名的PDB，则还原操作将失败。</p>
                                    </div>
                                 </div>
                              </li>
                           </ol>
                           <div>
                              <div class="infoboxnote" id="GUID-D658A389-1BA6-4793-B564-96357264A0A7__GUID-5DD7967C-420F-42E3-83F6-DC768E17C576">
                                 <p class="notep1">注意：</p>
                                 <p><a href="rman-transporting-data-across-platforms.html#GUID-0CBA7F68-0AEB-43B8-B9F6-AD7BB0D788F2" title="您可以使用不一致和一致的备份组合来传输PDB并将其插入位于不同平台上的CDB。不一致的备份使您可以减少应用程序停机时间，因为PDB可以在执行备份时打开">使用不一致的备份执行PDB的跨平台传输</a></p>
                              </div>
                           </div>
                        </li>
                     </ol>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-0CBA7F68-0AEB-43B8-B9F6-AD7BB0D788F2" name="GUID-0CBA7F68-0AEB-43B8-B9F6-AD7BB0D788F2"></a><h4 id="BRADV-GUID-0CBA7F68-0AEB-43B8-B9F6-AD7BB0D788F2" class="sect4"><span class="enumeration_section">28.12.4</span>使用不一致的备份执行PDB的跨平台传输</h4>
                  <div>
                     <p>您可以使用不一致和一致的备份组合来传输PDB并将其插入位于不同平台上的CDB。不一致的备份使您可以减少应用程序停机时间，因为PDB可以在执行备份时打开</p>
                     <div class="section">
                        <p></p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>当PDB打开时，您将创建跨平台不一致的备份。第一个备份是增量级别0备份。后续备份是增量级别1备份，其中包含自上次增量备份以来对PDB所做的更改。不一致的1级备份数量没有限制。最后，关闭PDB，创建最后一致的增量级别1备份以及包含将源PDB插入目标CDB所需的元数据的XML文件。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="p">源CDB和目标CDB上的<code class="codeph">COMPATIBLE</code>参数必须设置为12.2。源CDB和目标CDB必须使用相同的endian格式。
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>在源CDB上执行以下步骤：</span><ol type="a">
                              <li class="substepexpand"><span>使用<code class="codeph">SYSDBA</code>或<code class="codeph">SYSBACKUP</code>权限以普通用户身份连接到root用户。</span></li>
                              <li class="substepexpand"><span>确保必须传输的PDB处于读写模式。</span></li>
                              <li class="substepexpand"><span>注意创建0级备份之前的数据库SCN。</span><div><pre class="pre codeblock"><code>SELECT CHECKPOINT_CHANGE＃FROM V $ DATABASE;</code></pre></div>
                              </li>
                              <li class="substepexpand"><span>创建必须使用<code class="codeph">BACKUP ...运输的PDB的跨平台增量0级<code class="codeph">BACKUP ...PLUGGABLE DATABASE</code>命令。</span><div>
                                    <p>使用<code class="codeph">FOR TRANSPORT</code>或<code class="codeph">TO PLATFORM</code>子句指定跨平台备份。包括<code class="codeph">ALLOW INCONSISTENT</code>子句以指示PDB未处于一致状态。
                                    </p>
                                    <p>以下语句创建PDB <code class="codeph">hr_pdb</code>的跨平台增量级别0备份。
                                    </p><pre class="pre codeblock"><code>BACKUP INCREMENTAL LEVEL 0 FOR TRANSPORT允许不可插拔的数据库hr_pdb格式'/u01/backups/hr_pdb_level0.bck';</code></pre><p>由于PDB处于读写模式，因此会创建不一致的备份。</p>
                                 </div>
                              </li>
                              <li class="substepexpand"><span>关闭正在运输的PDB。</span><div>
                                    <p>以下命令关闭PDB <code class="codeph">hr_pdb</code> 。
                                    </p><pre class="pre codeblock"><code>RMAN&gt; ALTER PLUGGABLE DATABASE hr_pdb立即关闭;</code></pre></div>
                              </li>
                              <li class="substepexpand"><span>创建一致的跨平台增量备份。增量备份的时间点必须来自步骤1c中记录的SCN。</span><div>
                                    <p>包括<code class="codeph">UNPLUG INTO</code>子句以指定存储将此PDB插入目标CDB所需的元数据的XML的名称。</p>
                                    <p>以下语句创建PDB <code class="codeph">hr_pdb</code>的跨平台增量备份。这是一致的PDB备份。
                                    </p><pre class="pre codeblock"><code>来自SCN 36462的备份增量用于传输插入'/u01/backups/metadata_hr_pdb.xml'可插入数据库hr_pdb格式'/u01/backups/hr_pdb_level1_con.bck';</code></pre></div>
                              </li>
                           </ol>
                        </li>
                        <li class="stepexpand"><span>将所有PDB备份和包含PDB元数据的XML文件传输到目标数据库。</span><div>
                              <div class="infoboxnote" id="GUID-0CBA7F68-0AEB-43B8-B9F6-AD7BB0D788F2__GUID-58E8DCFC-E27C-405A-8A8A-07E4E29F6E9C">
                                 <p class="notep1">注意：</p>
                                 <p>通常，您将在创建时传输不一致的备份，然后在目标CDB上还原它们。</p>
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>在目标CDB上执行以下步骤：</span><ol type="a">
                              <li class="substepexpand"><span>使用<code class="codeph">SYSDBA</code>或<code class="codeph">SYSBACKUP</code>权限以普通用户身份连接到root用户。</span></li>
                              <li class="substepexpand"><span>确保目标CDB以读写模式打开。</span></li>
                              <li class="substepexpand"><span>恢复在源CDB上创建的PDB的跨平台不一致的0级备份。</span><div>
                                    <p>此还原操作将创建一组与目标CDB中的源PDB对应的外部数据文件。</p>
                                    <p>以下语句将恢复存储在backupset <code class="codeph">hr_pdb_level0.bck</code>中的PDB <code class="codeph">hr_pdb</code>的跨平台级别0备份。
                                    </p><pre class="pre codeblock"><code>RESTORE FOREIGN PLUGGABLE DATABASE hr_pdb FORMAT'/ u02 / oradata /％U'from BACKUPSET'/u02/backup_restore/hr_pdb_level0.bck';</code></pre></div>
                              </li>
                              <li class="substepexpand"><span>将源PDB关闭时创建的跨平台1级增量备份应用于步骤3c中恢复的数据文件。使用包含源PDB元数据的XML文件将PDB插入目标CDB。</span><div>
                                    <p>以下命令使用增量级别1备份<code class="codeph">hr_pdb_level1_con.bck</code>恢复外部数据文件。使用<code class="codeph">FOREIGN DATAFILECOPY</code>子句指定了两个已还原的外部数据文件。<code class="codeph">USING</code>子句指定包含将PDB插入目标CDB所需的元数据的XML文件。</p><pre class="pre codeblock"><code>使用'/u02/backup_restore/metadata_hr_pdb.xml'ENTEIGN DATAFILECOPY'/ u2 / oradata / 09qurbdp_1_1'，'/ u2 / oradata / 03bcdqrv_2_5'FRRO BACKUPSET'/u02/backup_restore/hr_pdb_level1_con.bck'恢复使用;</code></pre></div>
                              </li>
                              <li class="substepexpand"><span>确定目标CDB中传输的PDB的名称。</span><div>
                                    <p>源PDB使用其他名称插入目标。通常，名称是CDB的唯一名称，后跟随机生成的数字。</p>
                                    <div class="p">以下命令显示PDB列表。<pre class="pre codeblock"><code>SELECT name FROM V $ PDBS;</code></pre></div>
                                 </div>
                              </li>
                              <li class="substepexpand"><span>打开恢复的PDB。</span><div>
                                    <p>以下语句将打开PDB <code class="codeph">mycdb_72346</code> 。
                                    </p><pre class="pre codeblock"><code>RMAN&gt; ALTER PLUGGABLE DATABASE mycdb_72346 OPEN;</code></pre><div class="infoboxnote" id="GUID-0CBA7F68-0AEB-43B8-B9F6-AD7BB0D788F2__GUID-02F4BBFB-3DDB-48F9-90D1-4D76AF4F113C">
                                       <p class="notep1">注意：</p>
                                       <p>如果目标数据库上存在与正在传输的PDB同名的PDB，则还原操作将失败。</p>
                                    </div>
                                 </div>
                              </li>
                           </ol>
                           <div>
                              <div class="infoboxnote" id="GUID-0CBA7F68-0AEB-43B8-B9F6-AD7BB0D788F2__GUID-52635619-FFE7-452A-803E-2AA072312E4A">
                                 <p class="notep1">注意：</p>
                                 <p><a href="rman-transporting-data-across-platforms.html#GUID-D658A389-1BA6-4793-B564-96357264A0A7" title="可插拔数据库（PDB）可以被传输并插入目标多租户容器数据库（CDB），该数据库位于与源CDB不同的平台上。除了PDB的RMAN备份之外，还需要将PDB插入目标CDB所需的元数据。">执行封闭式PDB的跨平台传输</a></p>
                              </div>
                           </div>
                        </li>
                     </ol>
                  </div>
               </div><a id="BRADV862"></a><div class="props_rev_3"><a id="GUID-A41CEF69-4D73-45F4-BDF8-DCCAEB20C08F" name="GUID-A41CEF69-4D73-45F4-BDF8-DCCAEB20C08F"></a><h4 id="BRADV-GUID-A41CEF69-4D73-45F4-BDF8-DCCAEB20C08F" class="sect4"><span class="enumeration_section">28.12.5</span>在PDB中执行表空间的跨平台传输</h4>
                  <div>
                     <div class="section">
                        <p>RMAN使您可以使用<code class="codeph">CONVERT</code>或<code class="codeph">BACKUP</code>命令将PDB中包含的用户表空间传输到其他平台。在这种情况下，源平台和目标平台可以使用不同的endian格式。
                        </p>
                        <p>使用以下技术之一在PDB中传输表空间：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p>以<code class="codeph">TARGET</code>身份连接到PDB，并使用<code class="codeph">BACKUP TABLESPACE</code>命令创建所选表空间的跨平台备份。
                              </p>
                              <p>请参阅<span class="q">“ <a href="rman-transporting-data-across-platforms.html#GUID-F83EC306-9E7A-46D2-8F7F-2DDD595E307D">使用备份集将只读表空间传输到不同平台的步骤</a> ”</span> 。
                              </p>
                           </li>
                           <li>
                              <p>以<code class="codeph">TARGET</code>身份连接到PDB，并使用<code class="codeph">CONVERT TABLESPACE</code>命令传输只读表空间。
                              </p>
                              <p>连接到PDB时，以下命令将转换只读表空间<code class="codeph">my_tbs</code> ：</p><pre class="oac_no_warn" dir="ltr">CONVERT TABLESPACE my_tbs TO PLATFORM'Solaris [tm] OE（64位）'FORMAT' / tmp / xplat_backups / my_tbs_％U.bck';</pre></li>
                           <li>
                              <p>以<code class="codeph">TARGET</code>身份连接到PDB并使用<code class="codeph">CONVERT DATAFILE</code>命令。
                              </p>
                              <p>连接到PDB时，以下命令将转换数据文件<code class="codeph">sales.df</code> ：</p><pre class="oac_no_warn" dir="ltr">从平台转换'Solaris [tm] OE（64位）'DATAFILE'/u01/app/oracle/oradata/orcl/sales.df'FORMAT'/tmp/xplat_backups/sales_df_solaris.dat'</pre></li>
                        </ul>
                        <p>但是，当作为<code class="codeph">TARGET</code>连接到PDB时，您无法使用<code class="codeph">CONVERT DATAFILE</code>命令转换包含还原段的表空间。
                        </p>
                        <div class="infoboxnotealso" id="GUID-A41CEF69-4D73-45F4-BDF8-DCCAEB20C08F__GUID-046ECE28-2CDC-4877-92D9-95D6829500F4">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="rman-transporting-data-across-platforms.html#GUID-2525E4C4-59FF-4A8D-8C1A-8BD352B1235A">示例：在PDB中传输表空间</a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div><a id="BRADV863"></a><div class="props_rev_3"><a id="GUID-2525E4C4-59FF-4A8D-8C1A-8BD352B1235A" name="GUID-2525E4C4-59FF-4A8D-8C1A-8BD352B1235A"></a><h5 id="BRADV-GUID-2525E4C4-59FF-4A8D-8C1A-8BD352B1235A" class="sect5"><span class="enumeration_section">28.12.5.1</span>示例：在PDB中传输表空间</h5>
                     <div>
                        <div class="section">
                           <p>此示例使用<code class="codeph">CONVERT</code>命令将表空间<code class="codeph">sales_tbs</code>从PDB <code class="codeph">pdb5</code>到目标PDB <code class="codeph">pdb3</code> 。源PDB位于Sun Solaris平台上，目标PDB位于Linux x86 64位平台上。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>确保满足所需的先决条件。</span><div>
                                 <div class="infoboxnotealso" id="GUID-2525E4C4-59FF-4A8D-8C1A-8BD352B1235A__GUID-FECF98BC-4705-430F-8B04-96FE0F02A310">
                                    <p class="notep1">也可以看看：</p>
                                    <ul style="list-style-type:disc">
                                       <li>
                                          <p><span class="q">“ <a href="rman-transporting-data-across-platforms.html#GUID-7E1B3B10-CDA2-4E79-9F4C-AC8E51BCDE54__CIHDJFGD">使用备份集执行跨平台表空间传输的先决条件</a> ”</span></p>
                                       </li>
                                       <li>
                                          <p>用于<code class="codeph">CONVERT</code>命令先决条件的<a href="../rcmrf/CONVERT.html#RCMRF192" target="_blank"><span class="italic">Oracle数据库备份和恢复参考</span></a></p>
                                       </li>
                                    </ul>
                                 </div>
                              </div>
                           </li>
                           <li class="stepexpand"><span>启动SQL * Plus并以授予<code class="codeph">SYSDBA</code>或<code class="codeph">SYSBACKUP</code>权限的用户身份连接到源PDB。</span><div>
                                 <p>在此示例中， <code class="codeph">sbu</code>是已在源PDB <code class="codeph">pdb5</code>上被授予<code class="codeph">SYSBACKUP</code>权限的用户。
                                 </p><pre class="oac_no_warn" dir="ltr">％sqlplus sbu @ pdb5 AS SYSBACKUP</pre></div>
                           </li>
                           <li class="stepexpand"><span>在<code class="codeph">V$TRANSPORTABLE_PLATFORM</code>视图中查询目标平台的名称。</span><div>
                                 <p>在此示例中，目标平台的平台名称是<code class="codeph">Linux x86 64-bit</code> 。
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>验证要传输的表空间是否为自包含。</span><div>
                                 <div class="infoboxnotealso" id="GUID-2525E4C4-59FF-4A8D-8C1A-8BD352B1235A__GUID-02E5EEE2-E3E7-43FB-8F7E-F18B3A1E3E76">
                                    <p class="notep1">也可以看看：</p>
                                    <p>有关确定表空间是否为自包含的信息，请参见<a href="../admin/transporting-data.html#ADMIN11399" target="_blank"><span class="italic">“Oracle数据库管理员指南”</span></a></p>
                                 </div>
                              </div>
                           </li>
                           <li class="stepexpand"><span>将表空间放置为以只读模式传输。</span><div><pre class="oac_no_warn" dir="ltr">SQL&gt; ALTER TABLESPACE sales_tbs只读;</pre></div>
                           </li>
                           <li class="stepexpand"><span>创建用于存储DataPump导出和导入实用程序生成的文件的目录对象。</span><div><pre class="oac_no_warn" dir="ltr">SQL&gt; CREATE OR REPLACE DIRECTORY xtt_dir AS'/ scratch / xtt';目录已创建。
</pre></div>
                           </li>
                           <li class="stepexpand"><span>启动RMAN并以具有<code class="codeph">SYSDBA</code>或<code class="codeph">SYSBACKUP</code>权限的用户身份连接到源PDB。</span><div>
                                 <p>以下示例启动RMAN并作为已被授予<code class="codeph">SYSBACKUP</code>权限的<code class="codeph">sbu</code>用户连接到源PDB <code class="codeph">pdb5</code> 。
                                 </p><pre class="oac_no_warn" dir="ltr">％rman RMAN&gt; CONNECT TARGET“sbu @ pdb5 as sysbackup”</pre></div>
                           </li>
                           <li class="stepexpand" id="GUID-2525E4C4-59FF-4A8D-8C1A-8BD352B1235A__CIHFCAHJ"><span>使用<code class="codeph">CONVERT</code>命令转换源数据库上的表空间。</span><div>
                                 <p>以下命令将表空间<code class="codeph">sales_tbs</code>转换为目标平台Linux x86-64位。转换后的数据文件存储在<code class="codeph">/tmp/xplat_convert/sales_tbs_conv.bck</code> 。
                                 </p><pre class="oac_no_warn" dir="ltr">RMAN&gt; CONVERT TABLESPACE'SALES_TBS'平台'Linux x86 64位'格式'/tmp/xplat_convert/sales_tbs_conv.bck';</pre></div>
                           </li>
                           <li class="stepexpand"><span>退出RMAN。</span></li>
                           <li class="stepexpand" id="GUID-2525E4C4-59FF-4A8D-8C1A-8BD352B1235A__CIHFFCJH"><span>在源数据库上，使用DataPump导出实用程序创建包含表空间<code class="codeph">sales_tbs</code>元数据的导出转储文件。使用<code class="codeph">SYS</code>用户的凭据执行导出。</span><div>
                                 <p>以下命令在目录对象<code class="codeph">xtt_dir</code>指定的位置创建名为<code class="codeph">sales_tbs_conv.dmp</code>的导出转储文件。用于执行导出的凭据是<code class="codeph">SYS</code>用户的凭据。
                                 </p><pre class="oac_no_warn" dir="ltr">#expp“'”sys @ pdb5 as sysdba“'”directory = xtt_dir dumpfile = sales_tbs_conv.dmp logfile = sales_tbs_conv.log transport_tablespaces = sales_tbs</pre></div>
                           </li>
                           <li class="stepexpand"><span>将在步骤<a href="rman-transporting-data-across-platforms.html#GUID-2525E4C4-59FF-4A8D-8C1A-8BD352B1235A__CIHFCAHJ">8中</a>创建的已转换数据文件和在步骤<a href="rman-transporting-data-across-platforms.html#GUID-2525E4C4-59FF-4A8D-8C1A-8BD352B1235A__CIHFFCJH">10中</a>创建的导出转储文件复制到目标PDB。您可以使用操作系统命令来复制文件。</span></li>
                           <li class="stepexpand"><span>在目标PDB上，使用DataPump导入实用程序将表空间插入PDB。使用<code class="codeph">SYS</code>用户的凭据执行导入。</span><div>
                                 <p>以下示例导入包含在导出转储文件的元数据<code class="codeph">sales_tbs_conv.dmp</code>和转换后的数据文件<code class="codeph">/tmp/xplat_convert/sales_tbs_conv.bck</code>到PDB <code class="codeph">pdb3</code> 。
                                 </p><pre class="oac_no_warn" dir="ltr">#impdp“'”sys @ pdb3 as sysdba“'”directory = xtt_dir dumpfile = sales_tbs_conv.dmp datafiles = / tmp / xplat_convert / sales_tbs_conv.bck</pre></div>
                           </li>
                           <li class="stepexpand"><span>启动SQL * Plus并以具有<code class="codeph">SYSDBA</code>或<code class="codeph">SYSBACKUP</code>权限的用户身份连接到目标PDB。</span><div>
                                 <p>以下命令作为已被授予<code class="codeph">SYSBACKUP</code>权限的<code class="codeph">sbu</code>用户连接到PDB <code class="codeph">pdb3</code> 。
                                 </p><pre class="oac_no_warn" dir="ltr">％sqlplus sbu @ pdb3 as sysbackup</pre></div>
                           </li>
                           <li class="stepexpand"><span>验证目标PDB上已转换表空间的状态。</span><div>
                                 <p>以下查询确定表空间<code class="codeph">sales_tbs</code>的状态。
                                 </p><pre class="oac_no_warn" dir="ltr">SQL&gt; SELECT status FROM dba_tablespaces WHERE tablespace_name LIKE'SALES_TBS';状态---------只读</pre></div>
                           </li>
                           <li class="stepexpand"><span>使表空间<code class="codeph">sales_tbs</code>在目标PDB <code class="codeph">pdb3</code>在线。</span><div><pre class="oac_no_warn" dir="ltr">SQL&gt; ALTER TABLESPACE sales_tbs READ WRITE;</pre></div>
                           </li>
                        </ol>
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>