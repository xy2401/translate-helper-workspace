<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="You can run SQL Performance Analyzer on a production system or a test system that closely resembles the production system."></meta>
      <meta name="description" content="You can run SQL Performance Analyzer on a production system or a test system that closely resembles the production system."></meta>
      <title>SQL性能分析器简介</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Testing Guide "></meta>
      <meta property="og:description" content="You can run SQL Performance Analyzer on a production system or a test system that closely resembles the production system."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Testing Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="testing-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-07T01:43:11-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2008, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96279-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="sql-performance-analyzer.html" title="Previous" type="text/html"></link>
      <link rel="next" href="creating-an-analysis-task.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Testing Guide"></meta>
    <meta name="dcterms.isVersionOf" content="RATUG"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="sql-performance-analyzer.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="creating-an-analysis-task.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">测试指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="sql-performance-analyzer.html" property="item" typeof="WebPage"><span property="name">SQL性能分析器</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">SQL性能分析器简介</li>
            </ol>
            <a id="GUID-860FC707-B281-4D81-8B43-1E3857194A72" name="GUID-860FC707-B281-4D81-8B43-1E3857194A72"></a><a id="RATUG240"></a><a id="RATUG166"></a>
            
            <h2 id="RATUG-GUID-860FC707-B281-4D81-8B43-1E3857194A72" class="sect2"><span class="enumeration_chapter">2</span> SQL Performance Analyzer简介</h2>
         </header>
         <div class="ind">
            <div>
               <div><span>您可以在生产系统或与生产系统非常相似的测试系统上运行SQL Performance Analyzer。</span> 在生产系统上测试系统更改将影响系统的吞吐量，因为SQL Performance Analyzer必须执行您正在测试的SQL语句。在系统上进行的任何全局更改以测试性能影响也可能会影响系统的其他用户。如果系统更改不会影响许多会话或SQL语句，则可以接受在生产系统上运行SQL Performance Analyzer。但是，对于系统范围的更改 - 例如数据库升级 - 不建议使用生产系统。相反，请考虑在单独的测试系统上运行SQL Performance Analyzer，以便您可以在不影响生产系统的情况下测试系统更改的效果。使用测试系统还可确保生产系统上运行的其他工作负载不会影响SQL Performance Analyzer执行的分析。在测试系统上运行SQL Performance Analyzer是推荐的方法和此处描述的方法。如果选择在生产系统上运行SQL Performance Analyzer，则将生产系统替换为适用的测试系统。
               </div>
               <p>使用分析系统更改的SQL性能影响<a id="d3574e87" class="indexterm-anchor"></a><a id="d3574e91" class="indexterm-anchor"></a> SQL Performance Analyzer涉及以下步骤， <a href="introduction-to-sql-performance-analyzer.html#GUID-860FC707-B281-4D81-8B43-1E3857194A72__CHDJADEJ">如图2-1所示</a> ：</p>
               <div class="figure" id="GUID-860FC707-B281-4D81-8B43-1E3857194A72__CHDJADEJ">
                  <p class="titleinfigure">图2-1 SQL Performance Analyzer工作流程</p><img src="img/ratug002.gif" width="497" alt="下面描述图2-1" title="下面描述图2-1" longdesc="img_text/ratug002.html"><br><a href="img_text/ratug002.html">“图2-1 SQL性能分析器工作流”的说明</a></div>
               <!-- class="figure" -->
               <ol>
                  <li>
                     <p>捕获您要分析的SQL工作负载并将其存储在SQL调优集中，如<span class="q">“ <a href="introduction-to-sql-performance-analyzer.html#GUID-3828F92F-62BC-4A5E-8303-9720DCCB64B4" title="在运行SQL Performance Analyzer之前，在生产系统上捕获一组SQL语句，这些语句表示您要分析的SQL工作负载。">捕获SQL工作负载</a> ”中所述</span> 。
                     </p>
                  </li>
                  <li>
                     <p>如果您计划使用与生产系统分开的测试系统，请执行以下步骤：</p>
                     <ol type="a">
                        <li>
                           <p>设置测试系统以尽可能匹配生产环境。</p>
                        </li>
                        <li>
                           <p>将SQL调整集传输到测试系统。</p>
                        </li>
                     </ol>
                  </li>
                  <li id="GUID-860FC707-B281-4D81-8B43-1E3857194A72__BHCIFFDF">
                     <p>在测试系统上，创建SQL Performance Analyzer任务，如<span class="q">“ <a href="introduction-to-sql-performance-analyzer.html#GUID-9EF13018-5EDB-4B60-85F8-187DF25EECFF" title="捕获SQL工作负载并将其传输到测试系统并正确配置初始数据库环境后，可以运行SQL Performance Analyzer来分析系统更改对SQL性能的影响。">创建SQL Performance Analyzer任务</a> ”中所述</span> 。
                     </p>
                  </li>
                  <li>
                     <p>通过测试执行或生成SQL调优集中存储的SQL语句的执行计划来构建更改前的SQL试用版，如<span class="q">“ <a href="introduction-to-sql-performance-analyzer.html#GUID-310A0AA6-38C9-49A1-97C1-9BED682E654A" title="在进行系统更改之前创建一个更改前的SQL试用版。">测量更改前SQL性能</a> ”中所述</span></p>
                  </li>
                  <li>
                     <p>执行系统更改，如<span class="q">“ <a href="introduction-to-sql-performance-analyzer.html#GUID-176E2C1A-5A09-4CDC-9974-1B47129DA08E" title="进行对您要测量的SQL性能影响的更改。SQL Performance Analyzer可以分析许多类型的系统更改的影响。">进行系统更改</a> ”中所述</span></p>
                  </li>
                  <li id="GUID-860FC707-B281-4D81-8B43-1E3857194A72__CHDBJBIC">
                     <p>通过在更改后测试系统上的SQL调优集中重新执行SQL语句来构建更改后的SQL试验，如<span class="q">“ <a href="introduction-to-sql-performance-analyzer.html#GUID-7BE65E91-0C7B-4740-8114-4DAC76CDDB28" title="执行系统更改后，创建一个更改后的SQL试用版。">测量更改后的SQL性能</a> ”中所述</span></p>
                  </li>
                  <li>
                     <p>比较和分析性能数据的更改前和更改后版本，并生成报告以识别系统更改后已改进，保持不变或退化的SQL语句，如<span class="q">“ <a href="introduction-to-sql-performance-analyzer.html#GUID-F07105CA-0DFA-4102-A8FE-1C11AD201528" title="SQL Performance Analyzer会在更改之前和之后比较SQL语句的性能，并生成一个报告，标识执行计划中的任何更改或SQL语句的性能。">比较性能测量</a> ”中所述</span></p>
                  </li>
                  <li id="GUID-860FC707-B281-4D81-8B43-1E3857194A72__CHDEGIFG">
                     <p>调整已识别的任何已回归的SQL语句，如<span class="q">“ <a href="introduction-to-sql-performance-analyzer.html#GUID-9D5A985E-0BB0-43FA-955A-599B2E6A58AA" title="如果SQL Performance Analyzer执行的性能分析显示了已回归的SQL语句，则可以进行更改以解决问题。">修复</a></span>回归的SQL语句<span class="q">”中所述</span> 。
                     </p>
                  </li>
                  <li id="GUID-860FC707-B281-4D81-8B43-1E3857194A72__BHCGDEFB">
                     <p>通过重复步骤<a href="introduction-to-sql-performance-analyzer.html#GUID-860FC707-B281-4D81-8B43-1E3857194A72__CHDBJBIC">6</a>到<a href="introduction-to-sql-performance-analyzer.html#GUID-860FC707-B281-4D81-8B43-1E3857194A72__CHDEGIFG">8，</a>确保调整的SQL语句的性能可以接受，直到达到性能目标。
                     </p>
                     <p>对于每次比较，您可以使用任何以前的SQL试用版作为更改前的SQL试用版，将当前的SQL试用版用作更改后的SQL试用版。例如，您可能希望将第一个SQL试验与当前SQL试验进行比较以评估总更改，或者您可以将最新的SQL试验与当前的SQL试验进行比较，以仅评估最近的更改。</p>
                  </li>
               </ol>
               <div class="infoboxnote" id="GUID-860FC707-B281-4D81-8B43-1E3857194A72__GUID-C0576332-2067-4176-AAAF-F13F524C3C44">
                  <p class="notep1">注意：</p>
                  <p>Oracle Enterprise Manager为步骤<a href="introduction-to-sql-performance-analyzer.html#GUID-860FC707-B281-4D81-8B43-1E3857194A72__BHCIFFDF">3</a>到<a href="introduction-to-sql-performance-analyzer.html#GUID-860FC707-B281-4D81-8B43-1E3857194A72__BHCGDEFB">9</a>提供了自动化工作流程，以简化此过程。
                  </p>
               </div>
               <div class="infoboxnote" id="GUID-860FC707-B281-4D81-8B43-1E3857194A72__GUID-C33F4953-A579-4581-BABA-57C5A6F9B5B9">
                  <p class="notep1">注意：</p>
                  <p>将SQL Performance Analyzer与可插拔数据库（PDB）一起使用时，数据可见性和权限要求可能会有所不同。</p>
               </div>
               <div class="infoboxnotealso" id="GUID-860FC707-B281-4D81-8B43-1E3857194A72__GUID-9AEE68BB-11EB-4DFD-AE04-8B01EC7EE3B8">
                  <p class="notep1">也可以看看：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><span class="q">“ <a href="introduction-to-sql-performance-analyzer.html#GUID-15E99CE8-282C-4A7E-BD3B-B7C2B93DE0C1" title="将SQL工作负载捕获到生产系统上的SQL调优集后，可以在捕获工作负载的同一数据库上或在其他数据库上执行SQL Performance Analyzer分析。">设置测试系统</a> ”</span></p>
                     </li>
                     <li>
                        <p>有关可管理性功能（包括SQL性能分析器）在多租户容器数据库（CDB）中的工作方式的信息，请参阅<a href="../multi/administering-a-cdb-with-sql-plus.html#ADMIN13885" target="_blank"><span><cite>Oracle数据库管理员指南</cite></span></a></p>
                     </li>
                  </ul>
               </div>
            </div><a id="RATUG167"></a><div class="props_rev_3"><a id="GUID-3828F92F-62BC-4A5E-8303-9720DCCB64B4" name="GUID-3828F92F-62BC-4A5E-8303-9720DCCB64B4"></a><h3 id="RATUG-GUID-3828F92F-62BC-4A5E-8303-9720DCCB64B4" class="sect3"><span class="enumeration_section">2.1</span>捕获SQL工作负载</h3>
               <div>
                  <p>在运行SQL Performance Analyzer之前，在生产系统上捕获一组SQL语句，这些语句表示您要分析的SQL工作负载。</p>
                  <p>捕获的SQL语句应包含以下信息：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>SQL文本</p>
                     </li>
                     <li>
                        <p>执行环境</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>SQL绑定，它是执行SQL语句和生成准确执行统计信息所需的绑定值</p>
                           </li>
                           <li>
                              <p>解析可以编译SQL语句的模式</p>
                           </li>
                           <li>
                              <p>编译环境，包括执行SQL语句的初始化参数</p>
                           </li>
                        </ul>
                     </li>
                     <li>
                        <p>执行SQL语句的次数</p>
                     </li>
                  </ul>
                  <p>捕获SQL工作负载对生产系统的性能影响可忽略不计，不应影响吞吐量。包含更多SQL语句的SQL工作负载将更好地表示应用程序或数据库的状态。这将使SQL Performance Analyzer能够更准确地预测系统更改对SQL工作负载的潜在影响。因此，您应该捕获尽可能多的SQL语句。理想情况下，您应捕获应用程序调用或正在数据库上运行的所有SQL语句。</p>
                  <p>您可以将捕获的SQL语句存储在SQL调优集中，并将其用作SQL Performance Analyzer的输入源。SQL调优集<a id="d3574e333" class="indexterm-anchor"></a>是一个数据库对象，包括一个或多个SQL语句，以及它们的执行统计信息和执行上下文。SQL语句可以从不同的源加载到SQL调优集中，包括游标缓存，自动工作负载存储库（AWR），SQL跟踪文件和现有的SQL调优集。使用SQL调优集捕获SQL工作负载使您能够：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>将SQL文本和任何必要的辅助信息存储在单个持久数据库对象中</p>
                     </li>
                     <li>
                        <p>在SQL调优集中填充，更新，删除和选择捕获的SQL语句</p>
                     </li>
                     <li>
                        <p>加载和合并来自各种数据源的内容，例如自动工作负载存储库（AWR）或游标缓存</p>
                     </li>
                     <li>
                        <p>从捕获SQL工作负载的系统导出SQL调优集，并将其导入另一个系统</p>
                     </li>
                     <li>
                        <p>将SQL工作负载重用为其他顾问程序的输入源，例如SQL Tuning Advisor和SQL Access Advisor</p>
                     </li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-3828F92F-62BC-4A5E-8303-9720DCCB64B4__GUID-E1798EE6-9EC1-4AAC-9656-6321F067651F">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>有关使用Oracle Enterprise Manager创建SQL调优集的信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/ratug&amp;id=TDPPT162" target="_blank"><span><cite>参见“Oracle数据库2天+性能调整指南”</cite></span></a></p>
                        </li>
                        <li>
                           <p>有关使用API创建SQL调优集的信息，请<a href="../tgsql/managing-sql-tuning-sets.html#TGSQL516" target="_blank"><span><cite>参见“Oracle数据库SQL调优指南”</cite></span></a></p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div><a id="RATUG168"></a><div class="props_rev_3"><a id="GUID-15E99CE8-282C-4A7E-BD3B-B7C2B93DE0C1" name="GUID-15E99CE8-282C-4A7E-BD3B-B7C2B93DE0C1"></a><h3 id="RATUG-GUID-15E99CE8-282C-4A7E-BD3B-B7C2B93DE0C1" class="sect3"><span class="enumeration_section">2.2</span>设置测试系统</h3>
               <div>
                  <div><span>将SQL工作负载捕获到生产系统上的SQL调优集后，可以在捕获工作负载的同一数据库上或在其他数据库上执行SQL Performance Analyzer分析。</span> 由于分析是资源密集型的，因此建议您捕获生产数据库上的工作负载并将其传输到可以执行分析的单独测试数据库。为此，请从生产系统中导出SQL调优集，并将其导入到将测试系统更改的单独系统中。
                  </div>
                  <p><a id="d3574e462" class="indexterm-anchor"></a>有许多方法可以创建测试数据库。例如，您可以使用Recovery Manager（RMAN），Oracle Data Pump或可传输表空间的<code class="codeph">DUPLICATE</code>命令。Oracle建议使用RMAN，因为它可以从预先存在的备份或活动的生产数据文件创建测试数据库。生产和测试数据库可以驻留在同一主机或不同主机上。
                  </p>
                  <p>您应该配置测试数据库环境以尽可能地匹配生产系统的数据库环境。通过这种方式，SQL Performance Analyzer可以更准确地预测系统更改对SQL性能的影响。</p>
                  <p>正确配置测试系统后，将SQL调优集从生产系统导出到临时表，然后将其从临时表导入测试系统。</p>
                  <div class="infoboxnotealso" id="GUID-15E99CE8-282C-4A7E-BD3B-B7C2B93DE0C1__GUID-FCCCC9F1-43EA-4FF7-89CD-32A022FF2B0D">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>有关使用RMAN复制数据库的信息，请参见<a href="../bradv/rman-duplicating-databases.html#BRADV-GUID-F31F9FCE-B610-49EB-B9DB-44B9AA4E838F" target="_blank"><span><cite>“Oracle数据库备份和恢复用户指南”</cite></span></a></p>
                        </li>
                        <li>
                           <p>有关使用Oracle Enterprise Manager传输SQL调优集的信息，请<a href="../tdppt/tuning-sql-statements.html#TDPPT159" target="_blank"><span><cite>参见“Oracle数据库2天+性能调整指南”</cite></span></a></p>
                        </li>
                        <li>
                           <p>有关使用API传输SQL调优集的信息，请<a href="../tgsql/managing-sql-tuning-sets.html#TGSQL516" target="_blank"><span><cite>参见“Oracle数据库SQL调优指南”</cite></span></a></p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div><a id="RATUG169"></a><div class="props_rev_3"><a id="GUID-9EF13018-5EDB-4B60-85F8-187DF25EECFF" name="GUID-9EF13018-5EDB-4B60-85F8-187DF25EECFF"></a><h3 id="RATUG-GUID-9EF13018-5EDB-4B60-85F8-187DF25EECFF" class="sect3"><span class="enumeration_section">2.3</span>创建SQL性能分析器任务</h3>
               <div>
                  <p>捕获SQL工作负载并将其传输到测试系统并正确配置初始数据库环境后，可以运行SQL Performance Analyzer来分析系统更改对SQL性能的影响。</p>
                  <p>要运行SQL Performance Analyzer，必须首先创建SQL Performance Analyzer任务。任务是一个容器，它封装有关完整SQL Performance Analyzer分析的所有数据。SQL性能分析器分析包含至少两个SQL试验和比较。一个<a id="d3574e580" class="indexterm-anchor"></a> SQL试用版封装了特定环境条件下SQL调优集的执行性能。创建SQL Performance Analyzer任务时，您需要选择一个<a id="d3574e585" class="indexterm-anchor"></a> SQL调优设置为其输入源。使用测试执行或解释计划方法构建SQL试验时，SQL调优集将用作SQL语句的源。SQL Performance Analyzer分析将显示两个试验之间环境差异的影响。
                  </p>
                  <div class="infoboxnotealso" id="GUID-9EF13018-5EDB-4B60-85F8-187DF25EECFF__GUID-F0D0111C-5886-4697-AEBA-3F6822284773">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="creating-an-analysis-task.html#GUID-41CB8DDE-01C8-42BF-AD16-3494D4648A63" title="一旦捕获了要分析到SQL调优集（STS）的SQL工作负载，就可以运行SQL Performance Analyzer来分析系统更改对SQL性能的影响。">创建Analysis任务</a>以获取有关如何创建SQL Performance Analyzer任务的信息</p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div><a id="RATUG170"></a><div class="props_rev_3"><a id="GUID-310A0AA6-38C9-49A1-97C1-9BED682E654A" name="GUID-310A0AA6-38C9-49A1-97C1-9BED682E654A"></a><h3 id="RATUG-GUID-310A0AA6-38C9-49A1-97C1-9BED682E654A" class="sect3"><span class="enumeration_section">2.4</span>测量更改前的SQL性能</h3>
               <div>
                  <div><span>在进行系统更改之前创建一个更改前的SQL试用版。</span> 您可以使用以下方法生成SQL Performance Analyzer的SQL试用所需的性能数据：</div>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>测试执行</p>
                        <p>此方法测试通过SQL Performance Analyzer执行SQL语句。这可以在运行SPA Performance Analyzer的数据库上或远程数据库上完成。</p>
                     </li>
                     <li>
                        <p>解释计划</p>
                        <p>此方法仅通过SQL Performance Analyzer为SQL语句生成执行计划。这可以在运行SPA Performance Analyzer的数据库上或远程数据库上完成。与<code class="codeph">EXPLAIN PLAN</code>语句不同，使用explain plan方法的SQL试验<code class="codeph">EXPLAIN PLAN</code>绑定值考虑在内并生成实际的执行计划。
                        </p>
                     </li>
                     <li>
                        <p>转换SQL调优集</p>
                        <p>此方法转换存储在SQL调优集中的执行统计信息和计划。这仅适用于API。</p>
                     </li>
                  </ul>
                  <p>测试执行方法运行工作负载中包含的每个SQL语句以完成。在执行期间，SQL Performance Analyzer生成执行计划并计算工作负载中每个SQL语句的执行统计信息。SQL调优集中的每个SQL语句都与其他SQL语句分开执行，而不保留其初始执行顺序或并发性。每个SQL语句至少执行两次，直到执行超时（最多10次）为止。第一次执行用于加热缓冲区缓存。然后，所有后续执行都将用于根据SQL语句的平均值计算SQL语句的运行时执行统计信息。执行SQL语句的实际次数取决于执行SQL语句所需的时间。长时间运行的SQL语句将仅执行第二次，并将使用此执行的执行统计信息。其他（运行速度更快）的SQL语句多次执行，并且它们的执行统计信息在这些执行中取平均值（计算中不使用第一次执行的统计信息）。通过对多次执行的统计信息进行平均，SQL Performance Analyzer可以为每个SQL语句计算更准确的执行统计信息。为避免对数据库造成潜在影响，不支持DDL。默认情况下，仅执行DML的查询部分。使用API，您可以使用<code class="codeph">EXECUTE_FULLDML</code>任务参数执行完整的DML。不支持并行DML，除非删除并行提示，否则不会执行查询部分。
                  </p>
                  <p>根据其大小，执行SQL工作负载可能会耗费大量时间和资源。使用说明计划方法，您可以选择仅生成执行计划，而无需收集执行统计信息。此技术缩短了运行试验的时间并减少了对系统资源的影响，但无法进行全面的性能分析，因为在分析过程中只有执行计划可用。但是，与使用<code class="codeph">EXPLAIN PLAN</code>命令生成计划不同，SQL Performance Analyzer在生成执行计划时为优化程序提供绑定值，这可以更准确地预测执行SQL语句时的计划。
                  </p>
                  <p>在这两种情况下，您都可以使用数据库链接在单独的数据库上远程执行SQL工作负载。SQL Performance Analyzer将使用数据库链接建立与远程数据库的连接，在该数据库上执行SQL语句，收集每个SQL语句的执行计划和运行时统计信息，并将结果存储在本地数据库的SQL试验中可以用于以后的分析。在您希望以下情况下，此方法很有用：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>测试数据库升级</p>
                     </li>
                     <li>
                        <p>在运行其他版本的Oracle数据库的系统上执行SQL工作负载</p>
                     </li>
                     <li>
                        <p>将SQL Performance Analyzer分析的结果存储在单独的测试系统中</p>
                     </li>
                     <li>
                        <p>使用不同的硬件配置在多个系统上执行测试</p>
                     </li>
                     <li>
                        <p>即使您在生产系统上使用旧版本的Oracle数据库，也请使用SQL Performance Analyzer中的最新功能</p>
                     </li>
                  </ul>
                  <p>执行SQL工作负载后，生成的执行计划和运行时统计信息将存储在a中<a id="d3574e739" class="indexterm-anchor"></a> SQL试用版。
                  </p>
                  <p>您还可以使用存储在SQL调优集中的执行统计信息和计划来构建SQL试用版。虽然此方法仅支持API，但在您有另一种方法来运行工作负载（例如数据库重放或其他应用程序测试工具）的情况下，它可能很有用，并且您不需要SQL Performance Analyzer来驱动工作负载。测试系统。在这种情况下，如果在测试运行期间捕获SQL调优集，则可以使用SQL Performance Analyzer从这些SQL调优集构建SQL试验，以查看更全面的分析报告。与标准SQL性能分析器报告（每个试验中只有一个执行计划）和一组执行带有一组绑定的SQL语句生成的执行统计信息不同，您可以生成一个报告，比较从SQL调优集构建的SQL试验显示来自两个试验的所有执行计划，在多个执行中可能存在许多不同的绑定集。</p>
                  <div class="infoboxnotealso" id="GUID-310A0AA6-38C9-49A1-97C1-9BED682E654A__GUID-3A24AF9C-D825-417A-98ED-D1AC483EAE9B">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="creating-a-pre-change-sql-trial.html#GUID-34F13B73-7FFA-4E5E-862E-2D38128ED582" title="在创建SQL Performance Analyzer任务并选择SQL调优集作为输入源之后，您需要在测试系统上建立初始环境。">创建预更改SQL试用版，</a>以获取有关如何衡量更改前性能的信息</p>
                        </li>
                        <li>
                           <p><a href="testing-a-database-upgrade.html#GUID-41A30909-3D5B-4A53-A757-B3497498D36B" title="SQL Performance Analyzer支持测试从Oracle9i及更高版本到Oracle Database 10g第2版或更新版本的数据库升级。">测试数据库升级</a>以获取有关在远程系统上执行SQL工作负载以测试数据库升级的信息</p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div><a id="RATUG171"></a><div class="props_rev_3"><a id="GUID-176E2C1A-5A09-4CDC-9974-1B47129DA08E" name="GUID-176E2C1A-5A09-4CDC-9974-1B47129DA08E"></a><h3 id="RATUG-GUID-176E2C1A-5A09-4CDC-9974-1B47129DA08E" class="sect3"><span class="enumeration_section">2.5</span>进行系统变更</h3>
               <div><span>进行对您要测量的SQL性能影响的更改。SQL Performance Analyzer可以分析许多类型的系统更改的影响。</span> 例如，您可以测试数据库升级，新索引创建，初始化参数更改或优化程序统计信息刷新。如果在生产系统上运行SQL Performance Analyzer，请考虑使用私有会话进行更改，以避免影响系统的其余部分。
               </div>
            </div><a id="RATUG172"></a><div class="props_rev_3"><a id="GUID-7BE65E91-0C7B-4740-8114-4DAC76CDDB28" name="GUID-7BE65E91-0C7B-4740-8114-4DAC76CDDB28"></a><h3 id="RATUG-GUID-7BE65E91-0C7B-4740-8114-4DAC76CDDB28" class="sect3"><span class="enumeration_section">2.6</span>测量更改后的SQL性能</h3>
               <div>
                  <div><span>执行系统更改后，创建一个更改后的SQL试用版。</span> 强烈建议您使用与更改前SQL测试相同的方法创建更改后的SQL试用版。构建后，更改后的SQL试验代表一组新的性能数据，可用于与更改前的版本进行比较。结果存储在新的或更改后的SQL试用版中。
                  </div>
                  <div class="infoboxnotealso" id="GUID-7BE65E91-0C7B-4740-8114-4DAC76CDDB28__GUID-25CD8698-05C9-4985-BDA7-1B5957D42864">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="creating-a-post-change-sql-trial.html#GUID-CE3A1060-2BD8-4EA9-81F8-E101CD9AD9D5" title="计算更改前的SQL性能数据后，可以在测试系统上执行系统更改。">创建更改后的SQL试用版，</a>以获取有关如何衡量更改后性能的信息</p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div><a id="RATUG173"></a><div class="props_rev_3"><a id="GUID-F07105CA-0DFA-4102-A8FE-1C11AD201528" name="GUID-F07105CA-0DFA-4102-A8FE-1C11AD201528"></a><h3 id="RATUG-GUID-F07105CA-0DFA-4102-A8FE-1C11AD201528" class="sect3"><span class="enumeration_section">2.7</span>比较性能测量</h3>
               <div>
                  <p>SQL Performance Analyzer会在更改之前和之后比较SQL语句的性能，并生成一个报告，标识执行计划中的任何更改或SQL语句的性能。</p>
                  <p>SQL Performance Analyzer测量系统更改对SQL工作负载的总体执行时间以及工作负载中每个单独SQL语句的响应时间的影响。默认情况下，SQL Performance Analyzer使用已用时间作为比较指标。或者，您可以从各种可用的SQL运行时统计信息中选择用于比较的度量标准，包括：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>CPU时间</p>
                     </li>
                     <li>
                        <p>用户I / O时间</p>
                     </li>
                     <li>
                        <p>缓冲区得到</p>
                     </li>
                     <li>
                        <p>物理I / O.</p>
                     </li>
                     <li>
                        <p>优化成本</p>
                     </li>
                     <li>
                        <p>I / O互连字节</p>
                     </li>
                     <li>
                        <p>这些指标的任何组合都以表达式的形式出现</p>
                     </li>
                  </ul>
                  <p>如果您选择仅在SQL试验中生成解释计划，则SQL Performance Analyzer将使用存储在SQL执行计划中的优化程序成本。</p>
                  <p>比较完成后，生成的数据将生成到SQL Performance Analyzer中<a id="d3574e1054" class="indexterm-anchor"></a>报告，比较更改前和更改后的SQL性能。可以将SQL Performance Analyzer报告视为HTML，文本或活动报告。活动报告使用交互式用户界面提供深入报告，即使在与数据库或Oracle Enterprise Manager断开连接时也可以执行详细分析。
                  </p>
                  <div class="infoboxnotealso" id="GUID-F07105CA-0DFA-4102-A8FE-1C11AD201528__GUID-86F1CEF9-6451-4EC1-936A-4EC17EC54751">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="comparing-sql-trials.html#GUID-848B84A7-CB08-4728-9E3A-CBDD70E89E63" title="在构建更改后的SQL性能数据之后，您可以通过使用SQL Performance Analyzer运行比较分析，将在更改前的SQL试验中收集的性能数据与更改后的SQL试验进行比较。">比较SQL试验</a>以获取有关比较性能测量和报告的信息</p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div><a id="RATUG174"></a><div class="props_rev_3"><a id="GUID-9D5A985E-0BB0-43FA-955A-599B2E6A58AA" name="GUID-9D5A985E-0BB0-43FA-955A-599B2E6A58AA"></a><h3 id="RATUG-GUID-9D5A985E-0BB0-43FA-955A-599B2E6A58AA" class="sect3"><span class="enumeration_section">2.8</span>修复回归的SQL语句</h3>
               <div>
                  <div><span>如果SQL Performance Analyzer执行的性能分析显示了已回归的SQL语句，则可以进行更改以解决问题。</span> 例如，您可以通过运行SQL Tuning Advisor或使用SQL计划基准来修复回归SQL。然后，您可以重复执行SQL语句的过程，并将其性能与第一次执行进行比较。重复这些步骤，直到您对分析结果感到满意为止。
                  </div>
                  <div class="infoboxnotealso" id="GUID-9D5A985E-0BB0-43FA-955A-599B2E6A58AA__GUID-C47077CD-86EA-47F0-99A0-B334C3F230F9">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="comparing-sql-trials.html#GUID-848B84A7-CB08-4728-9E3A-CBDD70E89E63" title="在构建更改后的SQL性能数据之后，您可以通过使用SQL Performance Analyzer运行比较分析，将在更改前的SQL试验中收集的性能数据与更改后的SQL试验进行比较。">比较SQL试验</a>以获取有关修复回归SQL语句的信息</p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>