<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="There are certain procedures for setting up and using a DBFS SecureFiles Store."></meta>
      <meta name="description" content="There are certain procedures for setting up and using a DBFS SecureFiles Store."></meta>
      <title>DBFS SecureFiles商店</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Database SecureFiles and Large Objects Developer&#39;s Guide"></meta>
      <meta property="og:description" content="There are certain procedures for setting up and using a DBFS SecureFiles Store."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Database SecureFiles and Large Objects Developer&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="securefiles-and-large-objects-developers-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-02-12T02:58:18-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96333-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="introducing-database-file-system.html" title="Previous" type="text/html"></link>
      <link rel="next" href="DBFS-hierarchical-store.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="SecureFiles and Large Objects Developer&#39;s Guide"></meta>
    <meta name="dcterms.isVersionOf" content="ADLOB"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="introducing-database-file-system.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="DBFS-hierarchical-store.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Database SecureFiles和Large Objects Developer's Guide</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="database-file-system.html" property="item" typeof="WebPage"><span property="name">数据库文件系统（DBFS）</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">DBFS SecureFiles商店</li>
            </ol>
            <a id="GUID-F71C0B85-F08D-4CD0-9EB3-AB84C9B355AE" name="GUID-F71C0B85-F08D-4CD0-9EB3-AB84C9B355AE"></a><a id="ADLOB4594"></a>
            
            <h2 id="ADLOB-GUID-F71C0B85-F08D-4CD0-9EB3-AB84C9B355AE" class="sect2"><span class="enumeration_chapter">21</span> DBFS SecureFiles商店</h2>
         </header>
         <div class="ind">
            <div>
               <p>有一些设置和使用DBFS SecureFiles Store的过程。</p>
               <p>话题：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="DBFS-securefiles-store.html#GUID-8DC871AC-95D6-496B-A277-AA47DA94BF64" title="设置SecureFiles商店有几个方面。">设置SecureFiles商店</a></p>
                  </li>
                  <li>
                     <p><a href="DBFS-securefiles-store.html#GUID-D25B94D8-8B78-443D-9167-45B0F9EFC378" title="DBFS Content API提供了填充SecureFiles Store文件系统并以其他方式管理它的方法。">使用DBFS SecureFiles存储文件系统</a></p>
                  </li>
                  <li>
                     <p><a href="DBFS-securefiles-store.html#GUID-CE03355D-56C2-4497-9BD7-AD170EFD9615" title="DBFS SecureFiles Store包（DBMS_DBFS_SFS）是DBMS_DBFS_CONTENT的存储提供程序，它支持DBFS内容的SecureFiles LOB存储。">关于DBFS SecureFiles Store Package_ DBMS_DBFS_SFS</a></p>
                  </li>
               </ul>
            </div><a id="ADLOB46057"></a><div class="props_rev_3"><a id="GUID-8DC871AC-95D6-496B-A277-AA47DA94BF64" name="GUID-8DC871AC-95D6-496B-A277-AA47DA94BF64"></a><h3 id="ADLOB-GUID-8DC871AC-95D6-496B-A277-AA47DA94BF64" class="sect3">设置SecureFiles商店</h3>
               <div>
                  <p>设置SecureFiles商店有几个方面。</p>
                  <p>本节介绍如何设置SecureFiles存储。</p>
                  <p>话题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="DBFS-securefiles-store.html#GUID-C971D674-D133-40E2-9B03-503002DDB20C" title="您必须使用常规数据库用户才能对Content API和存储进行所有操作访问。">关于管理权限</a></p>
                     </li>
                     <li>
                        <p><a href="DBFS-securefiles-store.html#GUID-F6A9C96C-C527-4A42-A3DA-CD95DDEFE8C8" title="您必须将DBFS_ROLE角色授予需要使用DBFS内容API的任何用户。">创建或设置权限</a></p>
                     </li>
                     <li>
                        <p><a href="DBFS-securefiles-store.html#GUID-31709BF1-B980-4252-9428-7E6FE86612A5" title="您必须创建DBFS Content API访问的SecureFiles文件系统存储。">创建SecureFiles文件系统存储</a></p>
                     </li>
                     <li>
                        <p><a href="DBFS-securefiles-store.html#GUID-21EEB659-373D-4101-B276-071928FBBFD5" title="您永远不应该直接访问保存SecureFiles Store文件系统数据的表，即使是通过DBMS_DBFS_SFS包方法也是如此。">访问保存SecureFiles系统存储数据的表</a></p>
                     </li>
                     <li>
                        <p><a href="DBFS-securefiles-store.html#GUID-30782F65-0AC4-46FE-94D3-8E2A195D2327" title="您可以截断并重新初始化与SecureFiles Store关联的表。">初始化SecureFiles存储文件系统</a></p>
                     </li>
                     <li>
                        <p><a href="DBFS-securefiles-store.html#GUID-63980D61-CA18-4D58-8B87-E6AD1ECA969A" title="SecureFiles LOB仅适用于Oracle Database 11g第1版及更高版本。它们在早期版本中不可用。">SecureFiles LOB与BasicFiles LOB的比较</a></p>
                     </li>
                  </ul>
               </div><a id="ADLOB46062"></a><div class="props_rev_3"><a id="GUID-C971D674-D133-40E2-9B03-503002DDB20C" name="GUID-C971D674-D133-40E2-9B03-503002DDB20C"></a><h4 id="ADLOB-GUID-C971D674-D133-40E2-9B03-503002DDB20C" class="sect4">关于管理权限</h4>
                  <div>
                     <p>您必须使用常规数据库用户才能对Content API和存储进行所有操作访问。</p>
                     <p>不要使用<code class="codeph">SYS</code>或<code class="codeph">SYSTEM</code>用户或<code class="codeph">SYSDBA</code>或<code class="codeph">SYSOPER</code>系统特权。为了更好的安全性和职责分离，只允许特定的受信任用户管理DBFS Content API操作。
                     </p>
                     <p>您必须为每个用户授予<code class="codeph">DBFS_ROLE</code>角色。否则，用户无权使用DBFS Content API。具有适当管理权限（或<code class="codeph">SYSDBA</code> ）的用户可以根据需要将角色授予其他用户。
                     </p>
                     <p>由于角色，访问控制以及定义者和调用者权限在数据库中的交互方式，可能需要在DBFS内容API类型（带有<code class="codeph">DBMS_DBFS_CONTENT_</code> <span class="italic"><code class="codeph">xxx</code></span>前缀的SQL类型）和包上显式授予各种权限（通常是执行权限）（通常只有<code class="codeph">DBMS_DBFS_CONTENT</code>和<code class="codeph">DBMS_DBFS_SFS</code> ）给可能具有<code class="codeph">DBFS_ROLE</code>角色的用户。
                     </p>
                     <p>这些明确的直接拨款是正常的，可以预期，可以根据需要和按需提供。</p>
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-F6A9C96C-C527-4A42-A3DA-CD95DDEFE8C8" name="GUID-F6A9C96C-C527-4A42-A3DA-CD95DDEFE8C8"></a><h4 id="ADLOB-GUID-F6A9C96C-C527-4A42-A3DA-CD95DDEFE8C8" class="sect4">创建或设置权限</h4>
                  <div>
                     <p>您必须将<code class="codeph">DBFS_ROLE</code>角色授予需要使用DBFS内容API的任何用户。</p>
                     <ol>
                        <li class="stepexpand"><span>创建或确定DBFS Content API目标用户。</span><div>
                              <p>此示例使用此用户和密码： <code class="codeph">sfs_demo/</code> <span class="italic"><code class="codeph">password</code></span></p>
                              <p>此数据库用户至少必须具有<code class="codeph">CREATE SESSION</code> ， <code class="codeph">CREATE RESOURCE</code>和<code class="codeph">CREATE VIEW</code>权限。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>将<code class="codeph">DBFS_ROLE</code>角色授予用户。</span><div><pre class="oac_no_warn" dir="ltr">CONNECT / as sysdba GRANT dbfs_role TO sfs_demo;</pre></div>
                        </li>
                     </ol>
                     <div class="section">
                        <p>这将为具有<code class="codeph">DBFS_ROLE</code>角色的任何数据库用户设置DBFS Content API。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADLOB46157"></a><a id="ADLOB46063"></a><div class="props_rev_3"><a id="GUID-31709BF1-B980-4252-9428-7E6FE86612A5" name="GUID-31709BF1-B980-4252-9428-7E6FE86612A5"></a><h4 id="ADLOB-GUID-31709BF1-B980-4252-9428-7E6FE86612A5" class="sect4">创建SecureFiles文件系统存储</h4>
                  <div>
                     <p>您必须创建DBFS Content API访问的SecureFiles文件系统存储。</p>
                     <div class="section">
                        <p><code class="codeph">CREATEFILESYSTEM</code>过程在执行之前和之后自动提交（如DDL）。<code class="codeph">CREATESTORE</code>方法是<code class="codeph">CREATEFILESYSTEM</code>的包装器。</p>
                        <div class="infoboxnotealso" id="GUID-31709BF1-B980-4252-9428-7E6FE86612A5__SEEORACLEDATABASEPLSQLPACKAGESANDTY-DFE6E1FE">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="../arpls/index.html" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a> <code class="codeph">DBMS_DBFS_SFS</code>语法详细信息</p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-31709BF1-B980-4252-9428-7E6FE86612A5__GUID-74E2E548-18B1-4776-A02E-E977A7EF7B8C">要创建SecureFiles文件系统存储：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>使用DBFS Content API创建要访问的必要商店：</span><div><pre class="oac_no_warn" dir="ltr">DECLARE BEGIN DBMS_DBFS_SFS.CREATEFILESYSTEM（store_name =&gt;'FS1'，tbl_name =&gt;'T1'，tbl_tbs =&gt; null，use_bf =&gt; false）;承诺;结束; /</pre><p>哪里：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><code class="codeph">store_name</code>是任意的，用户唯一的名称。
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">tbl_name</code>是在当前架构中创建的有效表名。
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">tbl_tbs</code>是用于存储表及其相关段的有效表空间名称，例如索引，LOB或嵌套表。默认值为<code class="codeph">NULL</code>并指定当前架构的表空间。
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">use_bf</code>指定应使用BasicFiles LOB，如果为<code class="codeph">true</code> ，或者不使用，如果为<code class="codeph">false</code> 。
                                    </p>
                                 </li>
                              </ul>
                           </div>
                        </li>
                        <li class="stepexpand"><span>将此商店与DBFS Content API一起注册为SecureFiles Store提供商管理的新商店。</span><div><pre class="oac_no_warn" dir="ltr">CONNECT sfs_demo输入密码： <span class="italic">password</span> DECLARE BEGIN DBMS_DBFS_CONTENT.REGISTERSTORE（store_name =&gt;'FS1'，provider_name =&gt;'anything'，provider_package =&gt;' <span class="bold">dbms_dbfs_sfs</span> '）;承诺;结束; /</pre><p>哪里：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><code class="codeph">store_name</code>是SecureFiles Store <code class="codeph">FS1</code> ，它使用表<code class="codeph">SFS_DEMO.T1</code> 。
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">provider_name</code>被忽略。
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">provider_package</code>是<code class="codeph">DBMS_DBFS_SFS</code> ，用于SecureFiles Store引用提供程序。
                                    </p>
                                 </li>
                              </ul>
                              <p>此操作将SecureFiles Store <code class="codeph">FS1</code>与<code class="codeph">DBMS_DBFS_SFS</code>提供程序相关联。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>将商店安装在合适的安装点。</span><div><pre class="oac_no_warn" dir="ltr">CONNECT sfs_demo输入密码： <span class="italic">password</span> DECLARE BEGIN DBMS_DBFS_CONTENT.MOUNTSTORE（store_name =&gt;'FS1'，store_mount =&gt;'mnt1'）;承诺;结束; /</pre><p>哪里：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><code class="codeph">store_name</code>是SecureFiles Store <code class="codeph">FS1</code> ，它使用表<code class="codeph">SFS_DEMO.T1</code> 。
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">store_mount</code>是<a href="glossary.html#GUID-D2894DED-27C9-4846-A980-D51E22388EC7"><span class="xrefglossterm">挂载点</span></a> 。
                                    </p>
                                 </li>
                              </ul>
                           </div>
                        </li>
                        <li class="stepexpand"><span>[可选]要查看上述步骤的结果，可以使用以下语句。</span><div>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>要验证SecureFiles Store表和文件系统：</p><pre class="oac_no_warn" dir="ltr">SELECT * FROM TABLE（DBMS_DBFS_SFS.LISTTABLES）; SELECT * FROM TABLE（DBMS_DBFS_SFS.LISTFILESYSTEMS）;</pre></li>
                                 <li>
                                    <p>要验证ContentAPI商店和安装：</p><pre class="oac_no_warn" dir="ltr">SELECT * FROM TABLE（DBMS_DBFS_CONTENT.LISTSTORES）; SELECT * FROM TABLE（DBMS_DBFS_CONTENT.LISTMOUNTS）;</pre></li>
                                 <li>
                                    <p>要验证SecureFiles Store功能：</p><pre class="oac_no_warn" dir="ltr">var fs1f number; exec：fs1f：= dbms_dbfs_content.getFeaturesByName（'FS1'）; select * from table（dbms_dbfs_content.decodeFeatures（：fs1f））;</pre></li>
                                 <li>
                                    <p>要验证资源和属性视图：</p><pre class="oac_no_warn" dir="ltr">SELECT * FROM DBFS_CONTENT; SELECT * FROM DBFS_CONTENT_PROPERTIES;</pre></li>
                              </ul>
                           </div>
                        </li>
                     </ol>
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-21EEB659-373D-4101-B276-071928FBBFD5" name="GUID-21EEB659-373D-4101-B276-071928FBBFD5"></a><h4 id="ADLOB-GUID-21EEB659-373D-4101-B276-071928FBBFD5" class="sect4">访问保存SecureFiles系统存储数据的表</h4>
                  <div>
                     <p>您永远不应该直接访问保存SecureFiles Store文件系统数据的表，即使是通过<code class="codeph">DBMS_DBFS_SFS</code>包方法也是如此。
                     </p>
                     <div class="section">
                        <p>这是访问文件系统的正确方法。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p>对于过程操作：使用DBFS Content API（ <code class="codeph">DBMS_DBFS_CONTENT</code>方法）。
                              </p>
                           </li>
                           <li>
                              <p>对于SQL操作：使用资源和属性视图（ <code class="codeph">DBFS_CONTENT</code>和<code class="codeph">DBFS_CONTENT_PROPERTIES</code> ）。
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADLOB46065"></a><div class="props_rev_3"><a id="GUID-30782F65-0AC4-46FE-94D3-8E2A195D2327" name="GUID-30782F65-0AC4-46FE-94D3-8E2A195D2327"></a><h4 id="ADLOB-GUID-30782F65-0AC4-46FE-94D3-8E2A195D2327" class="sect4">初始化SecureFiles存储文件系统</h4>
                  <div>
                     <p>您可以截断并重新初始化与SecureFiles Store关联的表。</p>
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p>使用<code class="codeph">INITFS()</code>过程。
                              </p>
                              <p>该过程像DDL一样执行，在执行之前和之后自动提交。</p>
                           </li>
                        </ul>
                        <p>以下示例使用文件系统<code class="codeph">FS1</code>和表<code class="codeph">SFS_DEMO</code> 。 <code class="codeph">T1</code> ，与SecureFiles Store <code class="codeph">store_name</code>关联。
                        </p><pre class="oac_no_warn" dir="ltr">CONNECT sfs_demo;输入密码： <span class="italic">密码</span> EXEC DBMS_DBFS_SFS.INITFS（ <span class="italic">store_name</span> =&gt;'FS1'）;</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADLOB46064"></a><div class="props_rev_3"><a id="GUID-63980D61-CA18-4D58-8B87-E6AD1ECA969A" name="GUID-63980D61-CA18-4D58-8B87-E6AD1ECA969A"></a><h4 id="ADLOB-GUID-63980D61-CA18-4D58-8B87-E6AD1ECA969A" class="sect4">SecureFiles LOB与BasicFiles LOB的比较</h4>
                  <div>
                     <p>SecureFiles LOB仅适用于Oracle Database <span class="italic">11g</span>第1版及更高版本。它们在早期版本中不可用。
                     </p>
                     <p>必须将BasicFiles LOB存储用于未使用自动段空间管理（ASSM）管理的表空间中的LOB存储。</p>
                     <p>兼容性必须至少为11.1.0.0才能使用SecureFiles LOB。</p>
                     <p>此外，您需要在<code class="codeph">DBMS_DBFS_SFS.CREATEFILESYSTEM:</code>指定以下<code class="codeph">DBMS_DBFS_SFS.CREATEFILESYSTEM:</code></p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>要使用SecureFiles LOB（默认值），请指定<code class="codeph">use_bf =&gt; false.</code> 
                           </p>
                        </li>
                        <li>
                           <p>要使用BasicFiles LOB，请指定<code class="codeph">use_bf =&gt; true</code> 。
                           </p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div><a id="ADLOB46061"></a><div class="props_rev_3"><a id="GUID-D25B94D8-8B78-443D-9167-45B0F9EFC378" name="GUID-D25B94D8-8B78-443D-9167-45B0F9EFC378"></a><h3 id="ADLOB-GUID-D25B94D8-8B78-443D-9167-45B0F9EFC378" class="sect3">使用DBFS SecureFiles存储文件系统</h3>
               <div>
                  <p>DBFS Content API提供了填充SecureFiles Store文件系统并以其他方式管理它的方法。</p>
                  <p>话题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="DBFS-securefiles-store.html#GUID-CCD4D723-3998-47DD-9A77-56F629E5C119" title="您可以创建新的文件和目录元素以填充SecureFiles Store文件系统。">DBFS内容API工作示例</a></p>
                     </li>
                     <li>
                        <p><a href="DBFS-securefiles-store.html#GUID-9EA41230-B03F-4B36-BB14-687DABB295B1" title="您可以使用unmountStore方法删除SecureFiles Store文件系统。">删除SecureFiles存储文件系统</a></p>
                     </li>
                  </ul>
               </div><a id="ADLOB46159"></a><a id="ADLOB46067"></a><div class="props_rev_3"><a id="GUID-CCD4D723-3998-47DD-9A77-56F629E5C119" name="GUID-CCD4D723-3998-47DD-9A77-56F629E5C119"></a><h4 id="ADLOB-GUID-CCD4D723-3998-47DD-9A77-56F629E5C119" class="sect4">DBFS内容API工作示例</h4>
                  <div>
                     <p>您可以创建新的文件和目录元素以填充SecureFiles Store文件系统。</p>
                     <p>如果您已执行<span class="q">“ <a href="DBFS-securefiles-store.html#GUID-8DC871AC-95D6-496B-A277-AA47DA94BF64" title="设置SecureFiles商店有几个方面。">设置SecureFiles商店</a> ”中</span>的步骤，请设置DBFS内容API权限，创建至少一个SecureFiles商店参考文件系统，并将其安装在安装点<code class="codeph">/mnt1</code> ，然后您可以创建一个新文件和目录元素，如<a href="DBFS-securefiles-store.html#GUID-CCD4D723-3998-47DD-9A77-56F629E5C119__BABHCECE">例21-1所示</a> 。
                     </p>
                     <div class="example" id="GUID-CCD4D723-3998-47DD-9A77-56F629E5C119__BABHCECE">
                        <p class="titleinexample">示例21-1使用DBFS Content API</p><pre class="oac_no_warn" dir="ltr">CONNECT tjones输入密码： <span class="bold">密码</span> DECLARE ret integer; b blob; str varchar2（1000）：=''|| chr（10）|| '#include &lt;stdio.h&gt;'|| chr（10）|| ''|| chr（10）|| 'int main（int argc，char ** argv）'|| chr（10）|| '{'|| chr（10）|| '（void）printf（“hello world \ n”）;' || chr（10）|| '返回0;' || chr（10）|| '}'|| chr（10）|| ''; BEGIN ret：= dbms_fuse.fs_mkdir（'/ mnt1 / <span class="bold">FS1</span> '）; ret：= dbms_fuse.fs_creat（'/ mnt1 / FS1 / hello.c'，content =&gt; b）; dbms_lob.writeappend（b，length（str），utl_raw.cast_to_raw（str））;承诺;结束; /显示错误; - 验证新创建的目录和文件SELECT路径名，路径类型，长度（filedata），utl_raw.cast_to_varchar2（filedata）FROM dbfs_content WHERE pathname LIKE'/ mnt1 / <span class="bold">FS1</span> ％'ORDER BY pathname;</pre><p>可以使用<code class="codeph">DBMS_DBFS_CONTENT</code>从PL / SQL填充和访问文件系统。可以使用<code class="codeph">dbfs_content</code>和<code class="codeph">dbfs_content_properties</code>视图从SQL以只读方式访问文件系统。
                        </p>
                        <p>使用FUSE或独立的<code class="codeph">dbfs_client</code>工具（在<code class="codeph">FUSE</code>不可用或未设置的环境中）使用常规文件系统API和UNIX实用程序时，也可以填充和访问文件系统。
                        </p>
                     </div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADLOB46066"></a><div class="props_rev_3"><a id="GUID-9EA41230-B03F-4B36-BB14-687DABB295B1" name="GUID-9EA41230-B03F-4B36-BB14-687DABB295B1"></a><h4 id="ADLOB-GUID-9EA41230-B03F-4B36-BB14-687DABB295B1" class="sect4">删除SecureFiles存储文件系统</h4>
                  <div>
                     <p>您可以使用<code class="codeph">unmountStore</code>方法删除SecureFiles Store文件系统。
                     </p>
                     <div class="section">
                        <p>此方法从元数据表中删除引用文件系统的所有存储，并删除基础文件系统表。该过程像DDL一样执行，在执行之前和之后自动提交。</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>卸载商店。</span><div><pre class="oac_no_warn" dir="ltr">CONNECT sfs_demo输入密码： <span class="italic">password</span> DECLARE BEGIN <code class="codeph">DBMS_DBFS_CONTENT.UNMOUNTSTORE</code> （store_name =&gt;' <span class="bold">FS1</span> '，store_mount =&gt;'mntl';）;承诺;结束; /</pre><p>哪里：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><code class="codeph">store_name</code>是SecureFiles Store <code class="codeph">FS1</code> ，它使用表<code class="codeph">SFS_DEMO.T1</code> 。
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">store_mount</code>是挂载点。
                                    </p>
                                 </li>
                              </ul>
                           </div>
                        </li>
                        <li class="stepexpand"><span>取消注册商店。</span><div><pre class="oac_no_warn" dir="ltr">CONNECT sfs_demo输入密码： <span class="italic">password</span> EXEC DBMS_DBFS_CONTENT.UNREGISTERSTORE（store_name =&gt;'FS1'）;承诺;</pre><p><code class="codeph">store_name</code>是SecureFiles Store <code class="codeph">FS1</code> ，它使用表<code class="codeph">SFS_DEMO.T1</code> 。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>删除文件系统。</span><div><pre class="oac_no_warn" dir="ltr">CONNECT sfs_demo / ******; EXEC DBMS_DBFS_SFS.DROPFILESYSTEM（store_name =&gt;'FS1'）;承诺;</pre><p><code class="codeph">store_name</code>是SecureFiles Store <code class="codeph">FS1</code> ，它使用表<code class="codeph">SFS_DEMO.T1</code> 。
                              </p>
                           </div>
                        </li>
                     </ol>
                  </div>
               </div>
            </div><a id="ADLOB46184"></a><div class="props_rev_3"><a id="GUID-CE03355D-56C2-4497-9BD7-AD170EFD9615" name="GUID-CE03355D-56C2-4497-9BD7-AD170EFD9615"></a><h3 id="ADLOB-GUID-CE03355D-56C2-4497-9BD7-AD170EFD9615" class="sect3">关于DBFS SecureFiles Store Package，DBMS_DBFS_SFS</h3>
               <div>
                  <p>该DBFS SecureFiles的商店包（ <code class="codeph">DBMS_DBFS_SFS</code> ）为存储提供了<code class="codeph">DBMS_DBFS_CONTENT</code>支持的SecureFiles LOB存储为DBFS内容。
                  </p>
                  <p>要使用<code class="codeph">DBMS_DBFS_SFS</code>包，必须授予<code class="codeph">DBFS_ROLE</code>角色。
                  </p>
                  <p>SecureFiles Store提供程序是DBFS Content API的默认实现（并且是符合Provider SPI的商店提供程序的标准示例），它使已经使用LOB作为其架构中的列的应用程序可以访问<code class="codeph">BLOB</code>列。这使现有应用程序可以轻松添加PL / SQL提供程序实现，并通过DBFS Content API提供访问，而无需更改其模式或业务逻辑。
                  </p>
                  <p>应用程序还可以通过标准DBFS Content API接口读取和写入存储在其他（第三方）存储中的内容。</p>
                  <p>在SecureFiles存储中，基础用户数据存储在SecureFiles LOB中，路径名，ID和属性等元数据存储为关系表中的列。</p>
                  <div class="infoboxnotealso" id="GUID-CE03355D-56C2-4497-9BD7-AD170EFD9615__GUID-7B826B84-0463-4FBA-B4BE-E5462C86B0D1">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>有关<code class="codeph">DBMS_DBFS_SFS</code>包的更多信息，请参见<a href="../arpls/DBMS_DBFS_SFS.html#ARPLS72180" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a> 。
                           </p>
                        </li>
                        <li>
                           <p><a href="creating-your-own-DBFS-store.html#GUID-01819696-9FE0-41AB-9388-A0ECA1F72E52" title="要自定义DBFS存储，必须实现DBFS内容SPI（DBMS_DBFS_CONTENT_SPI）。它是现有存储（如DBFS SecureFiles存储和DFFS分层存储）以及您创建的任何用户定义的DBFS存储的基础。DBFS内容SPI（存储提供程序接口）仅是规范，没有包体。您可以将此示例存储提供程序用于DBFS，TaBleFileSystem存储提供程序（" tbf="),=" tbf=").you=" tbf=").once=" tbf=")=" ="">创建自己的DBFS存储</a>和<a href="../arpls/DBMS_DBFS_CONTENT_SPI.html#ARPLS72231" target="_blank"><span><cite>Oracle数据库PL / SQL包和类型参考</cite></span></a> ，以获取有关<code class="codeph">DBMS_DBFS_CONTENT_SPI</code>定义的提供者SPI的更多信息。</p>
                        </li>
                        <li>
                           <p><a href="using-oracle-LOBs-storage.html#GUID-A65C0BA7-BA2A-4DDE-A577-4670CCCC60C0" title="SecureFiles LOBs can only be created in tablespaces managed with Automatic Segment Space Management (ASSM), unlike BasicFiles LOB storage.">SecureFiles LOB存储，</a>用于<a href="using-oracle-LOBs-storage.html#GUID-A65C0BA7-BA2A-4DDE-A577-4670CCCC60C0" title="与BasicFiles LOB存储不同，SecureFiles LOB只能在使用自动段空间管理（ASSM）管理的表空间中创建。">SecureFiles LOB</a>的高级功能。
                           </p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-90F97F5A-8163-4634-813F-7EE372032479" name="GUID-90F97F5A-8163-4634-813F-7EE372032479"></a><h3 id="ADLOB-GUID-90F97F5A-8163-4634-813F-7EE372032479" class="sect3">数据库文件系统（DBFS） -  POSIX文件锁定</h3>
               <div>
                  <p>从Oracle Database 12 <span class="italic">c</span>第2版（12.2）开始，Oracle支持数据库文件系统<code class="codeph">POSIX</code>文件锁定功能。DBFS为以下内容提供文件锁定支持：</p>
                  <div class="p">
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">POSIX</code>应用程序使用<code class="codeph">DBFS_CLIENT</code> （在装载模式下）作为DBFS的前端接口。</p>
                        </li>
                        <li>
                           <p>使用<code class="codeph">PL/SQL</code>作为DBFS接口的应用程序。</p>
                        </li>
                     </ul>
                  </div>
                  <div class="infoboxnote" id="GUID-90F97F5A-8163-4634-813F-7EE372032479__GUID-A50948ED-6F41-40CA-8A5F-962335794859">
                     <p class="notep1">注意：</p>
                     <p>Oracle仅支持DBFS中的完整文件锁。全文锁定意味着将整个文件从字节零偏移锁定到文件末尾。</p>
                  </div>
                  <p>话题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="DBFS-securefiles-store.html#GUID-025D32E0-656F-4E76-836C-15DEEC222296" title="顾问锁定是一种文件锁定机制，可锁定单个进程的文件。">关于咨询锁定</a></p>
                     </li>
                     <li>
                        <p><a href="DBFS-securefiles-store.html#GUID-E82F2616-7310-4624-BD1D-E9629AAF9800" title="强制锁定是一种文件锁定机制，可以从参与的进程获得支持。">关于强制锁定</a></p>
                     </li>
                     <li>
                        <p><a href="DBFS-securefiles-store.html#GUID-AE084E03-789E-40D2-9699-BA4477DFBF0D" title="启用文件锁定机制可帮助应用程序阻止文件以进行各种文件系统操作。">文件锁定支持</a></p>
                     </li>
                     <li>
                        <p><a href="DBFS-securefiles-store.html#GUID-4105E3EB-7D07-4957-BB09-7BCBBC3FC698">数据库文件系统的兼容性和迁移因素 - 文件锁定</a></p>
                     </li>
                     <li>
                        <p><a href="DBFS-securefiles-store.html#GUID-F953FA91-373F-41AB-B3C0-3AA87EED8DCE">数据库文件系统 - 文件锁定的示例</a></p>
                     </li>
                  </ul>
               </div>
               <div class="sect3"><a id="GUID-025D32E0-656F-4E76-836C-15DEEC222296" name="GUID-025D32E0-656F-4E76-836C-15DEEC222296"></a><h4 id="ADLOB-GUID-025D32E0-656F-4E76-836C-15DEEC222296" class="sect4">关于咨询锁定</h4>
                  <div>
                     <p>顾问锁定是一种文件锁定机制，可锁定单个进程的文件。</p>
                     <p>文件锁定机制不能独立地强制执行任何形式的锁定，并且需要来自参与进程的支持。例如，如果进程<code class="codeph">P1</code>对文件<code class="codeph">F1</code>具有<code class="codeph">write</code>锁定，则锁定API或操作系统不执行任何动作以防止任何其他进程<code class="codeph">P2</code>对文件<code class="codeph">F1</code>发出<code class="codeph">read</code>或<code class="codeph">write</code>系统调用。文件锁定机制的这种行为也适用于其他文件系统操作。涉及的进程（在文件锁定机制中）必须遵循用户级库以合适的API形式提供的锁定或解锁协议。保证文件锁定语义可用，这些过程包含锁定协议的推荐用法并尊重API调用的结果。
                     </p>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-E82F2616-7310-4624-BD1D-E9629AAF9800" name="GUID-E82F2616-7310-4624-BD1D-E9629AAF9800"></a><h4 id="ADLOB-GUID-E82F2616-7310-4624-BD1D-E9629AAF9800" class="sect4">关于强制锁定</h4>
                  <div>
                     <p>强制锁定是一种文件锁定机制，可以从参与的进程获得支持。</p>
                     <p>强制锁定是强制锁定方案，其不依赖于参与的进程来协作和/或遵循锁定API。例如，如果一个进程<code class="codeph">P1</code>已经采取了<code class="codeph">write</code>锁定在文件<code class="codeph">F1</code>和如果一个不同的过程<code class="codeph">P2</code>试图发出一个<code class="codeph">read</code> / <code class="codeph">write</code>系统调用（或任何其他的文件系统操作）上的文件<code class="codeph">F1</code> ，该请求被阻止，因为所关注的文件由进程<code class="codeph">P1</code>独占锁定。
                     </p>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-AE084E03-789E-40D2-9699-BA4477DFBF0D" name="GUID-AE084E03-789E-40D2-9699-BA4477DFBF0D"></a><h4 id="ADLOB-GUID-AE084E03-789E-40D2-9699-BA4477DFBF0D" class="sect4">文件锁定支持</h4>
                  <div>
                     <p>启用文件锁定机制可帮助应用程序阻止文件以进行各种文件系统操作。</p>
                     <p><code class="codeph">UNIX</code>和<code class="codeph">LINUX</code>的<code class="codeph">fcntl()</code> ， <code class="codeph">lockf()</code>和<code class="codeph">flock()</code>系统调用提供文件锁定支持。这些系统调用使应用程序能够通过<code class="codeph">dbfs_client-FUSE</code>回调接口使用文件锁定工具。<code class="codeph">fcntl()</code>提供的文件锁被广泛称为POSIX文件锁， <code class="codeph">flock()</code>提供的文件锁称为BSD文件锁。POSIX和BSD文件锁的语义和行为彼此不同。通过<code class="codeph">fcntl()</code>和<code class="codeph">flock()</code>放置在同一文件上的锁彼此正交。在DBFS中设计和实现的文件锁定功能的语义类似于POSIX文件锁。在DBFS中，通过<code class="codeph">flock()</code>系统调用放置的文件锁的语义类似于POSIX文件锁（例如<code class="codeph">fcntl()</code> ）而不是BSD文件锁。 <code class="codeph">lockf()</code>是一个库调用，它在大多数UNIX系统上作为<code class="codeph">fcntl()</code>系统调用的包装器实现，因此，它提供了POSIX文件锁定语义。在DBFS中，通过<code class="codeph">fcntl()</code> ， <code class="codeph">flock()</code>和<code class="codeph">lockf()</code>系统调用放置的文件锁提供了POSIX文件锁的相同类型的行为和语义。
                     </p>
                     <div class="infoboxnote" id="GUID-AE084E03-789E-40D2-9699-BA4477DFBF0D__GUID-3F2E6C77-70ED-4465-B9EC-A376131F182F">
                        <p class="notep1">注意：</p>不支持BSD文件锁定语义。
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-4105E3EB-7D07-4957-BB09-7BCBBC3FC698" name="GUID-4105E3EB-7D07-4957-BB09-7BCBBC3FC698"></a><h4 id="ADLOB-GUID-4105E3EB-7D07-4957-BB09-7BCBBC3FC698" class="sect4">数据库文件系统的兼容性和迁移因素 - 文件锁定</h4>
                  <div>
                     <p></p>
                     <p>数据库文件系统文件锁定功能不会影响<code class="codeph">DBFS</code>和<code class="codeph">SFS</code>存储提供程序与<code class="codeph">RDBMS</code>的兼容性。</p>
                     <p><code class="codeph">DBFS_CLIENT</code>是一个独立的OCI客户端，它使用<code class="codeph">OCI</code>调用和<code class="codeph">DBMS_FUSE API</code> 。</p>
                     <div class="infoboxnote" id="GUID-4105E3EB-7D07-4957-BB09-7BCBBC3FC698__GUID-F46A470A-5018-4A0D-90F9-2C3750C806FE">
                        <p class="notep1">注意：</p>
                        <p>此功能将与<code class="codeph">Ora</code> <code class="codeph">SDK/RSF</code>兼容。
                        </p>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-F953FA91-373F-41AB-B3C0-3AA87EED8DCE" name="GUID-F953FA91-373F-41AB-B3C0-3AA87EED8DCE"></a><h4 id="ADLOB-GUID-F953FA91-373F-41AB-B3C0-3AA87EED8DCE" class="sect4">数据库文件系统 - 文件锁定的示例</h4>
                  <div>
                     <p></p>
                     <p>以下示例说明了基于<code class="codeph">UNIX</code>的系统上可用的建议锁定和锁定功能。以下示例使用两个正在运行的进程 - 进程A和进程B.</p>
                     <div class="example" id="GUID-F953FA91-373F-41AB-B3C0-3AA87EED8DCE__EXAMPLE1NOLOCKING-3C33D561">
                        <p class="titleinexample">例21-2无锁定</p>
                        <p><code class="codeph">进程A打开文件：</code></p><pre class="pre codeblock"><code>file_desc = open（“/ path / to / file”，O_RDONLY）; / *将数据读入bufffers * / read（fd，buf1，sizeof（buf））; read（fd，buf2，sizeof（buf））;关闭（file_desc）;</code></pre><p>受OS调度影响， <code class="codeph">process B</code>可以随时进入并发出影响文件数据完整性的<code class="codeph">write</code>系统调用。
                        </p>
                     </div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-F953FA91-373F-41AB-B3C0-3AA87EED8DCE__EXAMPLE2ADVISORYLOCKINGUSEDBUTPROCE-3C33D280">
                        <p class="titleinexample">例21-3使用了建议锁定但是进程B没有遵循协议</p>
                        <p><code class="codeph">进程A打开文件：</code></p><pre class="pre codeblock"><code>file_desc = open（“/ path / to / file”，O_RDONLY）; ret = AcquireLock（file_desc，RD_LOCK）; if（ret）{read（fd，buf1，sizeof（buf））; read（fd，buf2，sizeof（buf））; RELEASELOCK（file_desc）; close（file_desc）;</code></pre><p>受OS调度影响， <code class="codeph">process B</code>可以随时进入并仍然发出<code class="codeph">write</code>系统调用，忽略<code class="codeph">process A</code>已经拥有<code class="codeph">read</code>锁定。
                        </p>
                        <p><code class="codeph">进程B打开文件：</code></p><pre class="pre codeblock"><code>file_desc1 = open（“/ path / to / file”，O_WRONLY）; write（file_desc1，buf，sizeof（buf））;关闭（file_desc1）;</code></pre><p>执行上述代码并导致文件中的数据不一致。</p>
                     </div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-F953FA91-373F-41AB-B3C0-3AA87EED8DCE__EXAMPLE-144-3C33DBDB">
                        <p class="titleinexample">例21-4使用的咨询锁定和进程遵循协议</p>
                        <p><code class="codeph">进程A打开文件：</code></p><pre class="pre codeblock"><code>file_desc = open（“/ path / to / file”，O_RDONLY）; ret = AcquireLock（file_desc，RD_LOCK）; if（ret）{read（fd，buf1，sizeof（buf））; read（fd，buf2，sizeof（buf））; RELEASELOCK（file_desc）; close（file_desc）;</code></pre><p><code class="codeph">进程B打开文件：</code></p><pre class="pre codeblock"><code>file_desc1 = open（“/ path / to / file”，O_WRONLY）; ret = AcquireLock（file_desc1，WR_LOCK）; / *以上调用将负责检查是否存在锁* / if（ret）{write（file_desc1，buf，sizeof（buf））; RELEASELOCK（file_desc1）; close（file_desc1）;</code></pre><p><code class="codeph">Process B</code>遵循锁定API，此API确保进程在不获取锁定的情况下不<code class="codeph">write</code>文件。
                        </p>
                     </div>
                     <!-- class="example" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-B85868BC-63B1-438F-962C-ED52F19B6E01" name="GUID-B85868BC-63B1-438F-962C-ED52F19B6E01"></a><h4 id="ADLOB-GUID-B85868BC-63B1-438F-962C-ED52F19B6E01" class="sect4">文件锁定行为</h4>
                  <div>
                     <p></p>
                     <p><code class="codeph">DBFS</code>文件锁定功能表现出以下行为：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">DBFS</code>中的文件锁使用幂等函数实现。如果进程在同一文件上发出“N” <code class="codeph">read</code>或<code class="codeph">write</code>锁定调用，则只有第一次调用才会生效，后续的“N-1”调用将被视为冗余并返回“无操作”（NOOP）。
                           </p>
                        </li>
                        <li>
                           <p>文件只能解锁一次。如果进程在同一文件上发出“N” <code class="codeph">unlock</code>呼叫，则只有第一个呼叫才会生效，后续的“N-1”呼叫将被视为冗余并返回NOOP。</p>
                        </li>
                        <li>
                           <p>仅从<code class="codeph">read</code>到<code class="codeph">write</code>支持锁定转换。如果进程<code class="codeph">P</code>在文件<code class="codeph">F</code>上保持<code class="codeph">read</code>锁定（并且<code class="codeph">P</code>是保持<code class="codeph">read</code>锁定的唯一进程），则文件<code class="codeph">F</code>上的<code class="codeph">P</code>的<code class="codeph">write</code>锁定请求将把<code class="codeph">read</code>锁转换为<code class="codeph">exclusive</code> / <code class="codeph">write</code>锁。
                           </p>
                        </li>
                     </ul>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-75A47F45-BA4A-4903-95E3-5E52C7B375B9" name="GUID-75A47F45-BA4A-4903-95E3-5E52C7B375B9"></a><h4 id="ADLOB-GUID-75A47F45-BA4A-4903-95E3-5E52C7B375B9" class="sect4">调度文件锁</h4>
                  <div>
                     <p></p>
                     <p>DBFS文件锁定功能支持锁定调度。该工具完全在DBFS客户端实现。当客户端应用程序在其<code class="codeph">fcntl()</code> ， <code class="codeph">lockf()</code>和<code class="codeph">flock()</code>调用中使用阻塞调用语义时，需要锁定请求调度。
                     </p>
                     <p>有两种类型的调度：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="DBFS-securefiles-store.html#GUID-F925AE51-F3BF-44D4-BB4B-A3E00C35713C">贪心调度</a></p>
                        </li>
                        <li>
                           <p><a href="DBFS-securefiles-store.html#GUID-5C5D4AE4-8CEE-4B3D-93E7-E085C6168CDF">公平调度</a></p>
                        </li>
                     </ul>
                     <p>Oracle提供以下命令行选项来切换调度行为。</p>
                     <p><code class="codeph">挂载-o lock_sched_option = <span class="codeinlineitalic">lock_sched_option值</span> ;</code></p>
                     <div class="p">
                        <div class="tblformal" id="GUID-75A47F45-BA4A-4903-95E3-5E52C7B375B9__LOCK_SCHED_OPTIONVALUEDESCRIPTION-3FC3B812">
                           <p class="titleintable">表21-1 <code class="codeph">lock_sched_option</code>值描述</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="lock_sched_option值描述" border="1" summary="This table provides the description for lock_sched_option values." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="20%" id="d88633e2374">值</th>
                                    <th align="left" valign="bottom" width="20%" id="d88633e2376">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d88633e2380" headers="d88633e2374 ">1</td>
                                    <td align="left" valign="top" width="20%" headers="d88633e2380 d88633e2376 ">将调度类型设置为<a href="DBFS-securefiles-store.html#GUID-F925AE51-F3BF-44D4-BB4B-A3E00C35713C">Greedy Scheduling</a> 。（默认）</td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d88633e2390" headers="d88633e2374 ">2</td>
                                    <td align="left" valign="top" width="20%" headers="d88633e2390 d88633e2376 ">将调度类型设置为<a href="DBFS-securefiles-store.html#GUID-5C5D4AE4-8CEE-4B3D-93E7-E085C6168CDF">公平调度</a> 。
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                        <div class="infoboxnote" id="GUID-75A47F45-BA4A-4903-95E3-5E52C7B375B9__LOCKREQUESTSCHEDULINGWORKSONLYONPER-3FC42CE7">
                           <p class="notep1">注意：</p>锁定请求调度仅适用于每个<code class="codeph">DBFS</code>客户端安装。例如，锁定请求不会跨同一文件系统的多个安装进行调度。
                        </div>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-F925AE51-F3BF-44D4-BB4B-A3E00C35713C" name="GUID-F925AE51-F3BF-44D4-BB4B-A3E00C35713C"></a><h5 id="ADLOB-GUID-F925AE51-F3BF-44D4-BB4B-A3E00C35713C" class="sect5">贪心调度</h5>
                     <div>
                        <p></p>
                        <div class="section">
                           <p>在此调度技术中，文件锁定请求不遵循任何保证顺序。</p>
                           <div class="infoboxnote" id="GUID-F925AE51-F3BF-44D4-BB4B-A3E00C35713C__GUID-905D6536-8A4D-4DE8-9AB7-9633D152EF9D">
                              <p class="notep1">注意：</p>这是DBFS Client提供的默认计划选项。
                           </div>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-F925AE51-F3BF-44D4-BB4B-A3E00C35713C__GUID-EFCF7067-AA1E-4EB5-96A2-B83AE67CD239">
                           <p>如果文件<code class="codeph">F</code>由进程<code class="codeph">P1</code> <code class="codeph">read</code>锁定，并且进程<code class="codeph">P2</code>和<code class="codeph">P3</code>在文件<code class="codeph">F</code>上提交阻止<code class="codeph">write</code>锁定请求，则进程<code class="codeph">P2</code>和<code class="codeph">P3</code>将被阻塞（使用自旋锁的形式）并等待轮到获得锁。在等待期间，如果进程<code class="codeph">P4</code>在文件<code class="codeph">F</code>上提交<code class="codeph">read</code>锁定请求（阻塞调用或非阻塞调用），即使有两个进程（ <code class="codeph">P2</code>和<code class="codeph">P3</code> ）等待获取<code class="codeph">write</code> ， <code class="codeph">P4</code>也将被授予<code class="codeph">read</code>锁定。锁。一旦<code class="codeph">P1</code>和<code class="codeph">P4</code>释放了它们各自的<code class="codeph">read</code>锁定， <code class="codeph">P2</code>和<code class="codeph">P3</code>将成功获得锁定。但是，没有确定进程<code class="codeph">P2</code>和<code class="codeph">P3</code>获得锁定的顺序。进程<code class="codeph">P2</code>可能首先请求，但进程<code class="codeph">P3</code>的请求可能被解除阻塞并获得锁定，进程<code class="codeph">P2</code>必须等待<code class="codeph">P3</code>释放锁定。
                           </p>
                        </div>
                        <!-- class="example" -->
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-5C5D4AE4-8CEE-4B3D-93E7-E085C6168CDF" name="GUID-5C5D4AE4-8CEE-4B3D-93E7-E085C6168CDF"></a><h5 id="ADLOB-GUID-5C5D4AE4-8CEE-4B3D-93E7-E085C6168CDF" class="sect5">公平调度</h5>
                     <div>
                        <p></p>
                        <div class="section">
                           <p>这种调度技术是基于每个文件使用排队机制实现的。例如，如果文件<code class="codeph">F</code>被进程<code class="codeph">P1</code>读取锁定，并且进程<code class="codeph">P2</code>和<code class="codeph">P3</code>在文件<code class="codeph">F</code>上提交阻塞写锁定请求，则将阻止这两个进程（使用自旋锁的形式）并等待获取锁。请求将按DBFS客户端收到的顺序排队。如果进程<code class="codeph">P4</code>在文件<code class="codeph">F</code>上提交读锁定请求（阻塞调用或非阻塞调用），则即使可以向该进程授予读锁定，该请求也将排队。
                           </p>
                           <p>DBFS客户端确保在<code class="codeph">P1</code>释放其读锁之后，锁定请求的顺序是P2-&gt; P3-&gt; P4。
                           </p>
                           <p>这意味着<code class="codeph">P2</code>将是第一个获得锁定的人。一旦<code class="codeph">P2</code>释放其锁定， <code class="codeph">P3</code>将获得锁定，依此类推。
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>