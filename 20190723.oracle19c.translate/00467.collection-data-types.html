<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>集合数据类型</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Object-Relational Developer&#39;s Guide "></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Object-Relational Developer&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="object-relational-developers-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-11T02:05:10-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96436-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="support-for-collection-data-types.html" title="Previous" type="text/html"></link>
      <link rel="next" href="multilevel-collection-types.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Object-Relational Developer&#39;s Guide"></meta>
    <meta name="dcterms.isVersionOf" content="ADOBJ"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="support-for-collection-data-types.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="multilevel-collection-types.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">对象关系开发人员指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="support-for-collection-data-types.html" property="item" typeof="WebPage"><span property="name">支持收集数据类型</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">集合数据类型</li>
            </ol>
            <a id="GUID-1200DD46-95C0-4776-90BB-0ED0CD61267E" name="GUID-1200DD46-95C0-4776-90BB-0ED0CD61267E"></a><a id="ADOBJ00210"></a>
            
            <h2 id="ADOBJ-GUID-1200DD46-95C0-4776-90BB-0ED0CD61267E" class="sect2"><span class="enumeration_section">5.1</span>集合数据类型</h2>
         </header>
         <div class="ind">
            <div>
               <p>Oracle支持varray和嵌套表集合数据类型。</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p>varray是有序的元素集合。</p>
                  </li>
                  <li>
                     <p>嵌套表可以包含任意数量的元素，并且是无序的。</p>
                  </li>
               </ul>
               <p>如果您只需要存储固定数量的项目，或者按顺序遍历元素，或者经常需要检索和操作整个集合作为值，那么请使用varray。</p>
               <p>如果需要对集合运行高效查询，处理任意数量的元素，或执行批量插入，更新或删除操作，则使用嵌套表。</p>
               <p>话题：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="collection-data-types.html#GUID-70E5DE6B-6820-4161-BBE4-E24445E16462">创建集合类型</a></p>
                  </li>
                  <li>
                     <p><a href="collection-data-types.html#GUID-70E5DE6B-6820-4161-BBE4-E24445E16462">创建集合类型</a></p>
                  </li>
                  <li>
                     <p><a href="collection-data-types.html#GUID-12E30364-63D0-4CC0-AF29-389841D3C940">创建VARRAY或嵌套表的实例</a></p>
                  </li>
                  <li>
                     <p><a href="collection-data-types.html#GUID-D8E0DC1F-BD08-4FB8-A92C-AD97FEFF94D5">使用构造方法将值插入嵌套表</a></p>
                  </li>
                  <li>
                     <p><a href="collection-data-types.html#GUID-7AA98D8C-EA70-43AB-BFC8-724186D1E9B4">关于Varrays</a></p>
                  </li>
                  <li>
                     <p><a href="collection-data-types.html#GUID-2F2DD7A9-FC8B-4D79-9C19-4C15780A3ED5" title="嵌套表的元素实际上存储在单独的存储表中。嵌套表可以存储在与其父表不同的表空间中。">嵌套表</a></p>
                  </li>
                  <li>
                     <p><a href="collection-data-types.html#GUID-51BA9FC2-2DA1-4CDE-AD62-A949C2EE3EBA" title="您可以增加变量字符或RAW类型的大小，或者在VARRAY类型或嵌套表类型的元素类型是变量字符或RAW或数字类型时增加数值类型的精度。">增加VARRAY和嵌套表元素的大小和精度</a></p>
                  </li>
                  <li>
                     <p><a href="collection-data-types.html#GUID-022AB707-D639-42F4-9435-F3AB87496792" title="ALTER TYPE ......MODIFY LIMIT语法允许您增加VARRAY类型的元素数。">增加VARRAY限制大小</a></p>
                  </li>
                  <li>
                     <p><a href="collection-data-types.html#GUID-F0C6295F-6BA6-4FD1-B72B-96BE1DDCCFAA" title="要创建LOB引用的varray，首先要定义REF类型的VARRAY类型。">创建包含LOB引用的Varray</a></p>
                  </li>
               </ul>
               <div class="infoboxnotealso" id="GUID-1200DD46-95C0-4776-90BB-0ED0CD61267E__GUID-61DA13F3-2A57-4523-8C00-FB894A5082C9">
                  <p class="notep1">也可以看看：</p>
                  <p>有关使用嵌套表的更多信息，请参阅<span class="q">“ <a href="design-considerations-for-collections.html#GUID-F3904AFE-E6E3-48E9-9482-5DB98D1CD03F" title="您可以根据刚创建的home_phones（）函数查询人员及其家庭电话号码列表。您可以嵌套集合类型以创建真正的多级集合。您可以使用多级集合创建对象表。您可以使用REF创建对象表创建对象表后，可以在其中插入值。">集合的设计注意事项</a> ”</span> 。
                  </p>
               </div>
            </div><a id="ADOBJ7233"></a><a id="ADOBJ7232"></a><div class="props_rev_3"><a id="GUID-70E5DE6B-6820-4161-BBE4-E24445E16462" name="GUID-70E5DE6B-6820-4161-BBE4-E24445E16462"></a><h3 id="ADOBJ-GUID-70E5DE6B-6820-4161-BBE4-E24445E16462" class="sect3"><span class="enumeration_section">5.1.1</span>创建集合类型</h3>
               <div>
                  <div class="section">
                     <p>您使用<code class="codeph">CREATE TYPE</code>和<code class="codeph">CREATE TYPE BODY</code>来创建嵌套表类型。
                     </p>
                     <p><a href="collection-data-types.html#GUID-70E5DE6B-6820-4161-BBE4-E24445E16462__CHDBCCHJ">实施例5-1</a>演示如何创建一个<code class="codeph">person_typ</code>对象和<code class="codeph">people_typ</code>作为嵌套表型<code class="codeph">person_typ</code>对象，它们都在其他实施例中使用。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-70E5DE6B-6820-4161-BBE4-E24445E16462__CHDBCCHJ">
                     <p class="titleinexample">示例5-1后续示例的CREATE TYPE person_typ</p><pre class="oac_no_warn" dir="ltr">CREATE TYPE <span class="bold">person_typ</span> AS OBJECT（idno NUMBER，名称VARCHAR2（30），手机VARCHAR2（20），MAP会员功能get_idno返回号码，会员程序display_details（SELF IN OUT NOCOPY person_typ））; / CREATE TYPE BODY person_typ AS MAP MEMBER FUNCTION get_idno RETURN NUMBER IS BEGIN RETURN idno;结束;成员程序display_details（SELF IN OUT NOCOPY person_typ）IS BEGIN  - 使用DBMS_OUTPUT包的put_line过程显示详细信息DBMS_OUTPUT.put_line（TO_CHAR（idno）||' - '|| name ||' - '|| phone） ;结束;结束; / CREATE TYPE <span class="bold">people_typ</span> AS TABLE OF <span class="bold">person_typ</span> ; - 嵌套表类型/</pre></div>
                  <!-- class="example" -->
               </div>
            </div><a id="ADOBJ7234"></a><div class="props_rev_3"><a id="GUID-12E30364-63D0-4CC0-AF29-389841D3C940" name="GUID-12E30364-63D0-4CC0-AF29-389841D3C940"></a><h3 id="ADOBJ-GUID-12E30364-63D0-4CC0-AF29-389841D3C940" class="sect3"><span class="enumeration_section">5.1.2</span>创建VARRAY或嵌套表的实例</h3>
               <div>
                  <div class="section">
                     <p>您可以通过调用类型的构造函数方法来创建集合类型的实例，方法与创建任何其他对象类型的实例的方式相同。</p>
                     <p>构造函数方法的名称只是类型的名称。例如，您可以将集合的元素指定为逗号分隔的方法参数列表。</p><pre class="oac_no_warn" dir="ltr">（person_typ（1，'John Smith'，'1-650-555-0135'），</pre><p>使用空列表调用构造函数方法会创建该类型的空集合。请注意，空集合是一个恰好为空的实际集合;它与null集合不同。有关使用嵌套表的更多信息，请参见<span class="q">“ <a href="design-considerations-for-collections.html#GUID-75F19B20-952E-46B5-B814-938E76FF716B">嵌套表的设计注意事项</a> ”</span> 。
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="ADOBJ7236"></a><a id="ADOBJ7235"></a><div class="props_rev_3"><a id="GUID-D8E0DC1F-BD08-4FB8-A92C-AD97FEFF94D5" name="GUID-D8E0DC1F-BD08-4FB8-A92C-AD97FEFF94D5"></a><h3 id="ADOBJ-GUID-D8E0DC1F-BD08-4FB8-A92C-AD97FEFF94D5" class="sect3"><span class="enumeration_section">5.1.3</span>使用构造方法将值插入嵌套表中</h3>
               <div>
                  <div class="section">
                     <p>您可以在SQL语句中使用构造函数方法将值插入嵌套表中。</p>
                     <p><a href="collection-data-types.html#GUID-D8E0DC1F-BD08-4FB8-A92C-AD97FEFF94D5__BHBBDFFH">示例5-2</a>首先创建一个表，其中包含嵌套表类型<code class="codeph">people_typ</code>的实例，名为<code class="codeph">people_column</code> ，然后显示如何在SQL语句中使用构造函数方法将值插入<code class="codeph">people_typ</code> 。此示例使用构造函数方法的文字调用。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-D8E0DC1F-BD08-4FB8-A92C-AD97FEFF94D5__BHBBDFFH">
                     <p class="titleinexample">示例5-2使用构造方法将值插入嵌套表</p><pre class="oac_no_warn" dir="ltr">- 需要Ex。5-1 CREATE TABLE people_tab（group_no NUMBER， <span class="bold">people_column persons_typ</span> ） - 嵌套表的实例NESTED TABLE people_column STORE AS people_column_nt; -  NT的存储表</pre><pre class="oac_no_warn" dir="ltr">INSERT INTO people_tab VALUES（100， <span class="bold">people_typ</span> （person_typ（1，'John Smith'，'1-650-555-0135'），person_typ（2，'Diane Smith'，NULL）））;</pre></div>
                  <!-- class="example" -->
               </div>
            </div><a id="ADOBJ7237"></a><div class="props_rev_3"><a id="GUID-F23E2476-DCD9-4D23-8C9E-80E77BA53ED7" name="GUID-F23E2476-DCD9-4D23-8C9E-80E77BA53ED7"></a><h3 id="ADOBJ-GUID-F23E2476-DCD9-4D23-8C9E-80E77BA53ED7" class="sect3"><span class="enumeration_section">5.1.4逐字</span>调用构造函数以指定默认值</h3>
               <div>
                  <p>将表列声明为对象类型或集合类型时，可以包含<code class="codeph">DEFAULT</code>子句。
                  </p>
                  <div class="section">
                     <p>这提供了在未明确指定列值的情况下使用的值。</p>
                     <p><code class="codeph">DEFAULT</code>子句必须包含该对象或集合的构造函数方法的文字调用。
                     </p>
                     <p><a href="collection-data-types.html#GUID-F23E2476-DCD9-4D23-8C9E-80E77BA53ED7__CHDDFHFB">示例5-3</a>显示了如何使用构造函数方法的文字调用来指定<code class="codeph">person_typ</code>对象和<code class="codeph">people_typ</code>嵌套表的默认值：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-F23E2476-DCD9-4D23-8C9E-80E77BA53ED7__CHDDFHFB">
                     <p class="titleinexample">示例5-3使用构造方法的文字调用来指定默认值</p><pre class="oac_no_warn" dir="ltr">- 要求Ex。5-1 CREATE TABLE department_persons（dept_no NUMBER PRIMARY KEY，dept_name CHAR（20），dept_mgr <span class="bold">person_typ DEFAULT person_typ（10，'John Doe'，NULL）</span> ，dept_emps <span class="bold">people_typ DEFAULT people_typ（）</span> ） - 嵌套表类型实例NESTED TABLE dept_emps存储为dept_emps_tab; INSERT INTO department_persons VALUES（101，'Physical Sciences'，person_typ（65，'Vrinda Mills'，'1-650-555-0125'），people_typ（person_typ（1，'John Smith'，'1-650-555- 0135'），person_typ（2，'Diane Smith'，NULL）））; INSERT INTO department_persons VALUES（104，'Life Sciences'，person_typ（70，'James Hall'，'1-415-555-0101'）， <span class="bold">people_typ（）</span> ）; - 一个空的people_typ表</pre><p>请注意， <code class="codeph">people_typ()</code>是空<code class="codeph">people_typ</code>嵌套表的构造函数方法的文字调用。
                     </p>
                     <p>可以通过两种方式查询<code class="codeph">department_persons</code>表，如<a href="operations-on-collection-data-types.html#GUID-ED0C7364-9EDF-46C6-9604-1A3C519CFC26__BHBIIDCC">例5-16</a>和<a href="operations-on-collection-data-types.html#GUID-162C0E09-FE50-48CB-957F-F7B424BEC33A__BHBFDFDJ">例5-17所示</a> 。
                     </p>
                  </div>
                  <!-- class="example" -->
               </div>
            </div><a id="ADOBJ7238"></a><div class="props_rev_3"><a id="GUID-7AA98D8C-EA70-43AB-BFC8-724186D1E9B4" name="GUID-7AA98D8C-EA70-43AB-BFC8-724186D1E9B4"></a><h3 id="ADOBJ-GUID-7AA98D8C-EA70-43AB-BFC8-724186D1E9B4" class="sect3"><span class="enumeration_section">5.1.5</span>关于Varrays</h3>
               <div>
                  <p>varray是一组有序的数据元素。给定varray的所有元素都具有相同的数据类型或声明的varray的子类型。每个元素都有一个索引，它是一个与数组中元素位置相对应的数字。索引号用于访问特定元素。</p>
                  <p>定义varray时，可以指定它可以包含的最大元素数，但稍后可以更改此数字。数组中元素的数量是数组的大小。</p>
                  <p>以下语句创建一个数组类型<code class="codeph">email_list_arr</code> ，该数组类型不超过十个元素，每个元素的数据类型为<code class="codeph">VARCHAR2(80)</code> 。
                  </p><pre class="oac_no_warn" dir="ltr">CREATE TYPE email_list_arr AS VARRAY（10）OF VARCHAR2（80）; /</pre></div>
            </div><a id="ADOBJ7239"></a><div class="props_rev_3"><a id="GUID-399C8571-3BAC-493D-8A3A-C839DD2D3C0F" name="GUID-399C8571-3BAC-493D-8A3A-C839DD2D3C0F"></a><h3 id="ADOBJ-GUID-399C8571-3BAC-493D-8A3A-C839DD2D3C0F" class="sect3"><span class="enumeration_section">5.1.6</span>创建和填充VARRAY</h3>
               <div>
                  <p>与SQL对象类型一样，创建数组类型不会分配空间。</p>
                  <div class="section">
                     <p>它定义了一种数据类型，您可以将其用作：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type:disc">
                        <li>
                           <p>关系表的列的数据类型。</p>
                        </li>
                        <li>
                           <p>对象类型属性。</p>
                        </li>
                        <li>
                           <p>PL / SQL变量，参数或函数返回值的类型。</p>
                        </li>
                     </ul>
                     <p><a href="collection-data-types.html#GUID-399C8571-3BAC-493D-8A3A-C839DD2D3C0F__BHBFEIFI">例5-4</a>创建了一个<code class="codeph">VARRAY</code>类型，它是一个对象类型的数组。<code class="codeph">phone_varray_typ</code> <code class="codeph">VARRAY</code>类型用作<code class="codeph">dept_phone_list</code>表中列的数据类型。在<code class="codeph">INSERT</code>语句展示了如何将值插入<code class="codeph">phone_varray_typ</code>通过调用构造函数的变长数组<code class="codeph">phone_varray_typ</code>和对象<code class="codeph">phone_typ</code> 。
                     </p>
                     <p>您可以为程序目的创建<code class="codeph">VARRAY</code>类型的<code class="codeph">XMLType</code>或<code class="codeph">LOB</code>类型，例如在PL / SQL或视图查询中。但是，不支持这些类型的varrays的数据库存储。因此不能创建一个对象表或VARRAY类型的对象类型列<code class="codeph">XMLType</code>或<code class="codeph">LOB</code>类型。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-399C8571-3BAC-493D-8A3A-C839DD2D3C0F__BHBFEIFI">
                     <p class="titleinexample">示例5-4创建和填充VARRAY数据类型</p><pre class="oac_no_warn" dir="ltr">CREATE TYPE phone_typ AS OBJECT（country_code VARCHAR2（2），area_code VARCHAR2（3），ph_number VARCHAR2（7））; / <span class="bold">CREATE TYPE phone_varray_typ</span> AS VARRAY（5）OF phone_typ; / CREATE TABLE dept_phone_list（dept_no NUMBER（5），phone_list phone_varray_typ）; <span class="bold">INSERT INTO</span> dept_phone_list VALUES（100， <span class="bold">phone_varray_typ</span> （ <span class="bold">phone_typ</span> （ <span class="bold">'01</span> '，'650'，'5550123'），phone_typ（'01'，'650'，'5550148'），phone_typ（'01'，'650'，' 5550192' ）））;</pre><p>varray通常以内联方式存储，即与其行中的其他数据位于同一表空间中。如果它足够大，Oracle会将其存储为<code class="codeph">BLOB</code> 。</p>
                     <div class="infoboxnotealso" id="GUID-399C8571-3BAC-493D-8A3A-C839DD2D3C0F__GUID-F7FD88EF-DDB8-482A-B0CE-D41B694B63EF">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="q">“ <a href="design-considerations-for-collections.html#GUID-92C119FE-CB10-485F-B3E9-C6DE56594650">Varrays的存储注意事项</a> ”</span></p>
                           </li>
                           <li>
                              <p>有关<code class="codeph">CREATE</code> <code class="codeph">TABLE</code>语句的<code class="codeph">STORE</code> <code class="codeph">AS</code> <code class="codeph">LOB</code>子句的信息和示例，请参见<a href="../sqlrf/CREATE-TABLE.html#SQLRF01402" target="_blank"><span><cite>Oracle数据库SQL语言参考</cite></span></a> 。
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="example" -->
               </div>
            </div><a id="ADOBJ7240"></a><div class="props_rev_3"><a id="GUID-2F2DD7A9-FC8B-4D79-9C19-4C15780A3ED5" name="GUID-2F2DD7A9-FC8B-4D79-9C19-4C15780A3ED5"></a><h3 id="ADOBJ-GUID-2F2DD7A9-FC8B-4D79-9C19-4C15780A3ED5" class="sect3"><span class="enumeration_section">5.1.7</span>嵌套表</h3>
               <div>
                  <p>嵌套表是一组无序的数据元素，所有数据类型都相同。表的定义中未指定最大值，并且不保留元素的顺序。您可以在嵌套表中进行选择，插入，删除和更新，就像使用<code class="codeph">TABLE</code>表达式处理普通表一样。
                  </p>
                  <p>嵌套表可以视为单个列。如果嵌套表中的列是对象类型，则该表也可以被视为多列表，其中包含对象类型的每个属性的列。</p>
                  <p>话题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="collection-data-types.html#GUID-6BAB1F78-DC4A-4426-9F24-253F30FEFB4B">创建嵌套表</a></p>
                     </li>
                     <li>
                        <p><a href="collection-data-types.html#GUID-041D1EF0-0EF1-4488-9DBC-894C0214C5EF" title="嵌套表的元素实际上存储在单独的存储表中。">存储嵌套表的元素</a></p>
                     </li>
                     <li>
                        <p><a href="collection-data-types.html#GUID-69859842-4371-4037-9E2D-D5B6AFDD5A20" title="嵌套表可以存储在与其父表不同的表空间中。">存储嵌套表时指定表空间</a></p>
                     </li>
                  </ul>
               </div>
               <div class="props_rev_3"><a id="GUID-6BAB1F78-DC4A-4426-9F24-253F30FEFB4B" name="GUID-6BAB1F78-DC4A-4426-9F24-253F30FEFB4B"></a><h4 id="ADOBJ-GUID-6BAB1F78-DC4A-4426-9F24-253F30FEFB4B" class="sect4"><span class="enumeration_section">5.1.7.1</span>创建嵌套表</h4>
                  <div>
                     <div class="section">
                        <p>要创建嵌套表类型，请使用<code class="codeph">CREATE</code> <code class="codeph">TYPE</code> ...<code class="codeph">AS</code> <code class="codeph">TABLE</code> <code class="codeph">OF</code>语句。例如：</p><pre class="oac_no_warn" dir="ltr">CREATE TYPE <span class="bold">people_typ</span> AS TABLE OF <span class="bold">person_typ</span> ;</pre><p>表类型定义不分配空间。它定义了一个类型，您可以将其用作：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p>关系表的列的数据类型。</p>
                           </li>
                           <li>
                              <p>对象类型属性。</p>
                           </li>
                           <li>
                              <p>PL / SQL变量，参数或函数返回类型。</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADOBJ7242"></a><a id="ADOBJ7241"></a><div class="props_rev_3"><a id="GUID-041D1EF0-0EF1-4488-9DBC-894C0214C5EF" name="GUID-041D1EF0-0EF1-4488-9DBC-894C0214C5EF"></a><h4 id="ADOBJ-GUID-041D1EF0-0EF1-4488-9DBC-894C0214C5EF" class="sect4"><span class="enumeration_section">5.1.7.2</span>存储嵌套表的元素</h4>
                  <div>
                     <p>嵌套表的元素实际上存储在单独的存储表中。</p>
                     <div class="section">
                        <p>对于作为关系表中的列或对象表中的属性的嵌套表类型，Oracle将嵌套表数据存储在与对象表关联的单个存储表中。存储表包含一列，用于标识嵌套表的每个元素所属的父表行或对象。<a href="design-considerations-for-collections.html#GUID-474BD701-F7A2-435B-AE93-00B5B3AD974B__I445616">见图9-2</a> 。
                        </p>
                        <p><code class="codeph">NESTED</code> <code class="codeph">TABLE..STORE AS</code>子句指定嵌套表的存储名称。存储名称用于在嵌套表上创建索引。
                        </p>
                        <p><a href="collection-data-types.html#GUID-041D1EF0-0EF1-4488-9DBC-894C0214C5EF__I477859">例5-5</a>演示了如何创建和填充嵌套表，并使用如<a href="collection-data-types.html#GUID-70E5DE6B-6820-4161-BBE4-E24445E16462__CHDBCCHJ">例5-1中</a>定义的<code class="codeph">person_typ</code>对象和<code class="codeph">people_typ</code>嵌套表来指定嵌套表存储。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-041D1EF0-0EF1-4488-9DBC-894C0214C5EF__I477859">
                        <p class="titleinexample">示例5-5创建和填充简单嵌套表</p><pre class="oac_no_warn" dir="ltr">- 需要5-1 CREATE TABLE学生（毕业DATE，math_majors people_typ， - 嵌套表（空）chem_majors people_typ，physics_majors people_typ） <span class="bold">NESTED TABLE</span> math_majors <span class="bold">STORE AS</span> math_majors_nt  - 存储表<span class="bold">NESTED TABLE</span> chem_majors <span class="bold">STORE AS</span> chem_majors_nt <span class="bold">NESTED TABLE</span> physics_majors <span class="bold">STORE AS</span> physics_majors_nt; CREATE INDEX math_idno_idx ON math_majors_nt（idno）; CREATE INDEX chem_idno_idx ON chem_majors_nt（idno）; CREATE INDEX physics_idno_idx ON physics_majors_nt（idno）;插入学生（毕业）VALUES（'01 -JUN-03'）;更新学生SET math_majors = people_typ（person_typ（12，'Bob Jones'，'650-555-0130'），person_typ（31，'Sarah Chen'，'415-555-0120'），person_typ（45，'Chris Woods '，''415-555-0124'）），chem_majors = people_typ（person_typ（51，'Joe Lane'，'650-555-0140'），person_typ（31，'Sarah Chen'，'415-555-0120' ），person_typ（52，'Kim Patel'，'650-555-0135'）），physics_majors = people_typ（person_typ（12，'Bob Jones'，'650-555-0130'），person_typ（45，'Chris Woods '，''415-555-0124'））毕业= '01 -JUN-03'; SELECT m.idno math_id，c.idno chem_id，p.idno physics_id FROM students s，TABLE（s.math_majors）m，TABLE（s.chem_majors）c，TABLE（s.physics_majors）p;</pre><p>分别访问嵌套表的元素的便捷方法是使用嵌套游标或<code class="codeph">TABLE</code>函数。请参阅<span class="q">“ <a href="operations-on-collection-data-types.html#GUID-972A2EB4-C1CD-4FCA-8D5E-BCF7AC3ECF94" title="查询SELECT列表中的集合列会将集合的元素嵌套在与集合关联的结果行中。您可以取消收集查询的结果。TABLE表达式可以包含集合的子查询。您可以在CURSOR表达式中使用TABLE表达式。未经许可的查询也可以与多级集合一起使用，包括varrays和嵌套表。">集合查询</a> ”</span> 。
                        </p>
                     </div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADOBJ7244"></a><a id="ADOBJ7243"></a><div class="props_rev_3"><a id="GUID-69859842-4371-4037-9E2D-D5B6AFDD5A20" name="GUID-69859842-4371-4037-9E2D-D5B6AFDD5A20"></a><h4 id="ADOBJ-GUID-69859842-4371-4037-9E2D-D5B6AFDD5A20" class="sect4"><span class="enumeration_section">5.1.7.3</span>存储嵌套表时指定表空间</h4>
                  <div>
                     <p>嵌套表可以存储在与其父表不同的表空间中。</p>
                     <div class="section">
                        <p>在<a href="collection-data-types.html#GUID-69859842-4371-4037-9E2D-D5B6AFDD5A20__CIHEDJFJ">例5-6中</a> ，嵌套表存储在<code class="codeph">system</code>表空间中：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-69859842-4371-4037-9E2D-D5B6AFDD5A20__CIHEDJFJ">
                        <p class="titleinexample">示例5-6指定用于存储嵌套表的不同表空间</p><pre class="oac_no_warn" dir="ltr">- 需要Ex。 5-1，必须删除Ex中的代码。 5-2如果创建了CREATE TABLE people_tab（people_column people_typ）NESTED TABLE people_column STORE AS people_column_nt（ <span class="bold">TABLESPACE系统</span> ）;</pre><p>如果未指定<code class="codeph">TABLESPACE</code>子句，则会在创建父表的表空间中创建嵌套表的存储表。对于多级嵌套表，Oracle在与其紧接在前的父表相同的表空间中创建子表。
                        </p>
                        <p>你可以发出一个<code class="codeph">ALTER</code> <code class="codeph">TABLE..</code> <code class="codeph">MOVE</code>语句将表移动到不同的表空间。如果在具有嵌套表列的表上执行此操作，则仅移动父表;不对嵌套表的存储表执行任何操作。要将嵌套表的存储表移动到其他表空间，请发出<code class="codeph">ALTER</code> <code class="codeph">TABLE..</code> <code class="codeph">MOVE</code>存储表。例如：</p><pre class="oac_no_warn" dir="ltr"><span class="bold">ALTER TABLE</span> people_tab <span class="bold">MOVE TABLESPACE</span>系统; - 移动表<span class="bold">ALTER TABLE</span> people_column_nt <span class="bold">MOVE TABLESPACE</span>示例; - 移动存储表</pre><p>现在， <code class="codeph">people_tab</code>表位于<code class="codeph">system</code>表空间中，嵌套表存储存储在<code class="codeph">example</code>表空间中。
                        </p>
                     </div>
                     <!-- class="example" -->
                  </div>
               </div>
            </div><a id="ADOBJ7246"></a><a id="ADOBJ7245"></a><div class="props_rev_3"><a id="GUID-51BA9FC2-2DA1-4CDE-AD62-A949C2EE3EBA" name="GUID-51BA9FC2-2DA1-4CDE-AD62-A949C2EE3EBA"></a><h3 id="ADOBJ-GUID-51BA9FC2-2DA1-4CDE-AD62-A949C2EE3EBA" class="sect3"><span class="enumeration_section">5.1.8</span>增加VARRAY和嵌套表元素的大小和精度</h3>
               <div>
                  <p>可以增加可变字符或大小<code class="codeph">RAW</code>型，或增加数值类型的精度时的元素类型<code class="codeph">VARRAY</code>类型或嵌套表类型是可变的字符，或一个<code class="codeph">RAW</code>或数字类型。
                  </p>
                  <div class="section">
                     <p>为<code class="codeph">VARRAY</code>类型或嵌套表类型生成新类型版本。
                     </p>
                     <p>您使用<code class="codeph">ALTER</code> <code class="codeph">TYPE..进行这些更改<code class="codeph">TYPE..MODIFY</code>语句，有这个选项：</p>
                     <p> <code class="codeph">CASCADE</code> ：将更改传播到其类型和表依赖项</p>
                     <div class="p">
                        <div class="infoboxnotealso" id="GUID-51BA9FC2-2DA1-4CDE-AD62-A949C2EE3EBA__GUID-2AF657C8-92F3-4BF5-AAF0-65F2B1EDDC30">
                           <p class="notep1">也可以看看：</p>
                           <p><span class="q">“ <a href="type-evolution.html#GUID-EBA7E55C-0D72-4CBA-908B-B4B7B55E306B">用于类型演变的ALTER TYPE语句</a> ”</span>用于<code class="codeph">CASCADE</code>进一步描述</p>
                        </div><a href="collection-data-types.html#GUID-51BA9FC2-2DA1-4CDE-AD62-A949C2EE3EBA__BHBBEBCE">例5-7</a>增加了<code class="codeph">VARRAY</code>和嵌套表元素类型的大小。
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-51BA9FC2-2DA1-4CDE-AD62-A949C2EE3EBA__BHBBEBCE">
                     <p class="titleinexample">示例5-7在VARRAY和嵌套表中增加元素类型的大小</p><pre class="oac_no_warn" dir="ltr">CREATE TYPE email_list_arr AS VARRAY（10）OF VARCHAR2（80）; / <span class="bold">ALTER TYPE</span> email_list_arr <span class="bold">MODIFY</span> <span class="bold">ELEMENT</span> <span class="bold">TYPE</span> VARCHAR2（100） <span class="bold">CASCADE</span> ; CREATE TYPE email_list_tab AS VARCHAR2表（30）; / <span class="bold">ALTER TYPE</span> email_list_tab <span class="bold">MODIFY</span> <span class="bold">ELEMENT</span> <span class="bold">TYPE</span> VARCHAR2（40） <span class="bold">CASCADE</span> ;</pre></div>
                  <!-- class="example" -->
               </div>
            </div><a id="ADOBJ7248"></a><a id="ADOBJ7247"></a><div class="props_rev_3"><a id="GUID-022AB707-D639-42F4-9435-F3AB87496792" name="GUID-022AB707-D639-42F4-9435-F3AB87496792"></a><h3 id="ADOBJ-GUID-022AB707-D639-42F4-9435-F3AB87496792" class="sect3"><span class="enumeration_section">5.1.9</span>增加VARRAY限制大小</h3>
               <div>
                  <p><code class="codeph">ALTER</code> <code class="codeph">TYPE</code> ......<code class="codeph">MODIFY</code> <code class="codeph">LIMIT</code>语法允许您增加<code class="codeph">VARRAY</code>类型的元素数。
                  </p>
                  <div class="section">
                     <p>如果增加<code class="codeph">VARRAY</code>类型的元素数，则会为<code class="codeph">VARRAY</code>类型生成新类型版本，并成为类型更改历史记录的一部分。
                     </p>
                     <p><code class="codeph">ALTER</code> <code class="codeph">TYPE</code> ......<code class="codeph">MODIFY</code> <code class="codeph">LIMIT</code>语句有以下选项：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">INVALIDATE</code> ：使所有依赖对象无效</p>
                        </li>
                        <li>
                           <p> <code class="codeph">CASCADE</code> ：将更改传播到其类型和表依赖项</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-022AB707-D639-42F4-9435-F3AB87496792__CHDBJAHH">
                     <p class="titleinexample">例5-8增加VARRAY限制大小</p><pre class="oac_no_warn" dir="ltr">- 如果您已经创建了以下类型，请删除它们。DROP TYPE email_list_tab FORCE; DROP TYPE email_list_arr FORCE; CREATE TYPE email_list_arr AS VARRAY（10）OF VARCHAR2（80）; / CREATE TYPE email_list_typ AS OBJECT（section_no NUMBER，emails email_list_arr）; / CREATE TYPE email_varray_typ AS VARRAY（5）OF email_list_typ; / <span class="bold">ALTER TYPE</span> email_varray_typ <span class="bold">MODIFY LIMIT</span> 100 <span class="bold">INVALIDATE</span> ;</pre><p>更改<code class="codeph">VARRAY</code>类型时，更改将传播到从属表。
                     </p>
                     <div class="infoboxnotealso" id="GUID-022AB707-D639-42F4-9435-F3AB87496792__GUID-91162F23-30D5-41D6-BC86-09BBBAEF18EE">
                        <p class="notep1">也可以看看：</p>
                        <p><span class="q">“ <a href="design-considerations-for-collections.html#GUID-9EA1444F-A46A-4230-B0E3-FD6A57B246C1">关于传播VARRAY尺寸变化</a> ”</span> 。
                        </p>
                     </div>
                  </div>
                  <!-- class="example" -->
               </div>
            </div><a id="ADOBJ7250"></a><a id="ADOBJ7249"></a><div class="props_rev_3"><a id="GUID-F0C6295F-6BA6-4FD1-B72B-96BE1DDCCFAA" name="GUID-F0C6295F-6BA6-4FD1-B72B-96BE1DDCCFAA"></a><h3 id="ADOBJ-GUID-F0C6295F-6BA6-4FD1-B72B-96BE1DDCCFAA" class="sect3"><span class="enumeration_section">5.1.10</span>创建包含LOB引用的Varray</h3>
               <div>
                  <p>要创建LOB引用的varray，首先要定义<code class="codeph">REF</code>类型的<code class="codeph">VARRAY</code>类型。</p>
                  <div class="section">
                     <p>注意：以下示例引用了<a href="collection-data-types.html#GUID-022AB707-D639-42F4-9435-F3AB87496792__CHDBJAHH">示例5-8</a>中定义的<code class="codeph">email_list_typ</code> 。此示例创建一个表<code class="codeph">dept_email_list</code>并在其中定义数组类型的列<code class="codeph">email_addrs</code> 。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-F0C6295F-6BA6-4FD1-B72B-96BE1DDCCFAA__GUID-0E6F4905-DCD7-4772-BB94-C58E64093C66">
                     <p class="titleinexample">示例5-9创建包含LOB引用的VARRAY</p><pre class="oac_no_warn" dir="ltr">- 需要Ex。5-8 CREATE TYPE ref_email_varray_typ AS VARRAY（5） <span class="bold">REF email_list_typ</span> ; / CREATE TABLE dept_email_list（dept_no NUMBER，email_addrs ref_email_varray_typ）VARRAY email_addrs STORE AS LOB dept_emails_lob3;</pre></div>
                  <!-- class="example" -->
               </div>
            </div>
         </div>
      </article>
   </body>
</html>