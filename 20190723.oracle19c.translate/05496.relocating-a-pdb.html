<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="You can move a PDB to a different CDB or application container.">
      <meta name="description" content="You can move a PDB to a different CDB or application container.">
      <title>Relocating a PDB</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Administrator’s Guide ">
      <meta property="og:description" content="You can move a PDB to a different CDB or application container.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Administrator’s Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="multitenant-administrators-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-03-20T09:59:22-07:00">
      
      <meta name="dcterms.dateCopyrighted" content="2017, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96136-03">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="cloning-a-pdb.html" title="Previous" type="text/html">
      <link rel="next" href="plugging-in-a-pdb.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Multitenant Administrator's Guide">
    <meta name="dcterms.isVersionOf" content="MULTI">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="cloning-a-pdb.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="plugging-in-a-pdb.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Administrator’s Guide </span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="creating-pdbs.html" property="item" typeof="WebPage"><span property="name">Creating and Removing PDBs and Application Containers</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Relocating a PDB</li>
            </ol>
            <a id="GUID-75519361-3DA2-4558-A7E5-64BC16FAFC7D" name="GUID-75519361-3DA2-4558-A7E5-64BC16FAFC7D"></a>
            
            <h2 id="MULTI-GUID-75519361-3DA2-4558-A7E5-64BC16FAFC7D" class="sect2"><span class="enumeration_chapter">8 </span>Relocating a PDB
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>You can move a PDB to a different CDB or application container.</p>
               <p>This chapter contains the following topics:</p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="relocating-a-pdb.html#GUID-0A5C8EFF-51A4-497B-8D5C-A4267A694D4B">About PDB Relocation</a><br>During relocation, the source PDB can be open in read/write mode and fully functional.
                  </li>
                  <li class="ulchildlink"><a href="relocating-a-pdb.html#GUID-E908BC15-EDBE-4FD7-B584-1F7FCBC6C814">Purpose of PDB Relocation</a><br>This technique is the fastest way to move a PDB with minimal or no down time. Otherwise, unplugging the source PDB requires a PDB outage until the PDB is plugged in to the target CDB.
                  </li>
                  <li class="ulchildlink"><a href="relocating-a-pdb.html#GUID-EA37D755-A28E-4E85-BF84-F8FCE3164349">How PDB Relocation Works</a><br>The operation moves the files associated with the PDB to a new location, adds the PDB to the target CDB, and then opens the PDB.
                  </li>
                  <li class="ulchildlink"><a href="relocating-a-pdb.html#GUID-9460B932-8EF8-4261-87C9-7267213EBD11">User Interface for PDB Relocation</a><br>You can relocate PDBs on the command line using SQL, the DBCA utility, or the Rapid Home Provisioning utility.
                  </li>
                  <li class="ulchildlink"><a href="relocating-a-pdb.html#GUID-F887DBA7-61A6-49FB-8400-40632765F1E1">Relocating a PDB Using CREATE PLUGGABLE DATABASE</a><br>The <code class="codeph">CREATE PLUGGABLE DATABASE ... RELOCATE</code> statement moves a PDB to a different container.
                  </li>
                  <li class="ulchildlink"><a href="relocating-a-pdb.html#GUID-6A85B92C-0AE6-4737-BDBD-EA8256C09E55">Relocating a PDB: Examples</a><br>The examples in this section demonstration relocation using SQL and DBCA.
                  </li>
               </ul>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>Parent topic:</strong> <a href="creating-pdbs.html#GUID-9A250D93-5B3B-4643-BE85-F32CC7B0E413" title="You can create PDBs, application containers, and application seeds using a variety of techniques.">Creating and Removing PDBs and Application Containers</a></p>
                  </div>
               </div>
            </div>
            
            <div class="props_rev_3"><a id="GUID-0A5C8EFF-51A4-497B-8D5C-A4267A694D4B" name="GUID-0A5C8EFF-51A4-497B-8D5C-A4267A694D4B"></a><h3 id="MULTI-GUID-0A5C8EFF-51A4-497B-8D5C-A4267A694D4B" class="sect3"><span class="enumeration_section">8.1 </span>About PDB Relocation
               </h3>
               <div>
                  <p>During relocation, the source PDB can be open in read/write mode and fully functional.</p>
                  <p>The following graphic shows the relocation of a common PDB (that is, not an application PDB) to a new CDB. The source PDB is plugged in to the CDB root, and the target PDB is plugged in to the CDB root. Note that the <code class="codeph">CREATE PLUGGABLE DATABASE ... RELOCATE</code> statement copies the data blocks, undo blocks, and redo blocks to the new location. A database link is required.
                  </p>
                  <div class="figure" id="GUID-0A5C8EFF-51A4-497B-8D5C-A4267A694D4B__RELOCATEAPDB-5C4973BF">
                     <p class="titleinfigure">Figure 8-1 Relocate a PDB into the Root Container</p><img src="img/admin109.png" alt="Description of Figure 8-1 follows" title="Description of Figure 8-1 follows" longdesc="img_text/admin109.html"><br><a href="img_text/admin109.html">Description of "Figure 8-1 Relocate a PDB into the Root Container"</a></div>
                  <!-- class="figure" -->
                  <p>When the target PDB is an application PDB or application root, you have the following options:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>You can relocate a PDB into an application container as an application PDB. The target PDB can be in the same CDB or a different CDB.</p>
                     </li>
                     <li>
                        <p>You can relocate an application PDB from one application root to another. The target PDB can be in the same CDB or a different CDB.</p>
                     </li>
                     <li>
                        <p>You can relocate an empty application root from one CDB to another, but the application root must not have any hosted application PDBs.</p>
                     </li>
                  </ul>
                  <p>The following graphic illustrates how this technique creates a new application PDB in an application container.</p>
                  <div class="figure" id="GUID-0A5C8EFF-51A4-497B-8D5C-A4267A694D4B__RELOCATEAPDBINTOANAPPLICATIONCONTAI-7FD49079">
                     <p class="titleinfigure">Figure 8-2 Relocate a PDB into an Application Container</p><img src="img/admin116.png" alt="Description of Figure 8-2 follows" title="Description of Figure 8-2 follows" longdesc="img_text/admin116.html"><br><a href="img_text/admin116.html">Description of "Figure 8-2 Relocate a PDB into an Application Container"</a></div>
                  <!-- class="figure" -->
                  <p>When you open the relocated PDB for the first time, Oracle Database drains active sessions on the source PDB and redirects client connections to the relocated PDB services. Opening the relocated PDB initiates the shutdown of the original source PDB. The source and relocated PDBs are never open at the same time.</p>
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-0A5C8EFF-51A4-497B-8D5C-A4267A694D4B__GUID-0D128A0B-3EF1-4B66-A522-1DCAAA9B2408">
                     <p class="notep1">See Also:</p>
                     <p><span class="q">"<a href="overview-of-pdb-creation.html#GUID-59F42929-7237-4371-8934-921B46DB6F31" title="However you choose to create a PDB, you must decide on the tablespaces and files that will store the data.">PDB Storage</a>"</span></p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="relocating-a-pdb.html#GUID-75519361-3DA2-4558-A7E5-64BC16FAFC7D" title="You can move a PDB to a different CDB or application container.">Relocating a PDB</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-E908BC15-EDBE-4FD7-B584-1F7FCBC6C814" name="GUID-E908BC15-EDBE-4FD7-B584-1F7FCBC6C814"></a><h3 id="MULTI-GUID-E908BC15-EDBE-4FD7-B584-1F7FCBC6C814" class="sect3"><span class="enumeration_section">8.2 </span>Purpose of PDB Relocation
               </h3>
               <div>
                  <p>This technique is the fastest way to move a PDB with minimal or no down time. Otherwise, unplugging the source PDB requires a PDB outage until the PDB is plugged in to the target CDB.</p>
                  <p>When moving a PDB between data centers, or from an on-premise environment to a cloud environment, all the data must physically move. For large PDBs, this process may take considerable time, possibly violating availability components of an SLA. PDB relocation eliminates the outage completely. You can relocate the PDB without taking the application offline, changing the application, or changing network connection strings.</p>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="relocating-a-pdb.html#GUID-75519361-3DA2-4558-A7E5-64BC16FAFC7D" title="You can move a PDB to a different CDB or application container.">Relocating a PDB</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-EA37D755-A28E-4E85-BF84-F8FCE3164349" name="GUID-EA37D755-A28E-4E85-BF84-F8FCE3164349"></a><h3 id="MULTI-GUID-EA37D755-A28E-4E85-BF84-F8FCE3164349" class="sect3"><span class="enumeration_section">8.3 </span>How PDB Relocation Works
               </h3>
               <div>
                  <p>The operation moves the files associated with the PDB to a new location, adds the PDB to the target CDB, and then opens the PDB.</p>
                  <p>PDB relocation executes an online block level copy of the source PDB data files, redo, and undo while the source PDB is open with active sessions. When the target PDB comes online because of an <code class="codeph">ALTER PLUGGABLE DATABASE OPEN</code> statement, Oracle Database terminates the active sessions and closes the source PDB. 
                  </p>
                  <p><span>Oracle Database 18c</span> introduces database-generic session draining, where active sessions can exit gracefully under a timer. After the timer has expired, Oracle Database terminates all active sessions and reconnects them to the relocated PDB. This feature is enabled by default for all maintenance operations invoked at the database service and PDB levels: stop service, relocate service, relocate PDB, and stop PDB.
                  </p>
                  <p>PDB relocation services are available in Oracle RAC and single-instance environments in which a PDB relocates between CDB instances in the same clustered database or between distinct CDBs. In Oracle Clusterware, the Rapid Home Provisioning feature automates PDB relocation. An example of finer-grained relocation in an Oracle RAC environment is service relocation between PDB instances. Oracle RAC and Oracle Clusterware offer a rich high availability environment that further minimizes the effect on connected clients during relocation. For example, shared storage may minimize or remove the necessity to copy data files. </p>
                  <p>This section contains the following topics:</p>
                  <div class="infoboxnote" id="GUID-EA37D755-A28E-4E85-BF84-F8FCE3164349__GUID-E71D299D-16B4-40B7-B899-1D455114BBD6">
                     <p class="notep1">Note:</p>In an Oracle Clusterware environment, when relocating a PDB between different CDBs, you must create the non-default service resource using SRVCTL.
                  </div>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="relocating-a-pdb.html#GUID-B33BBFB9-824A-4D78-ABFC-351258DD77D4">Server Session Draining When Relocating or Stopping PDBs</a><br>A key requirement of planned maintenance is draining or failing over PDB sessions so that application work is not interrupted.
                     </li>
                     <li class="ulchildlink"><a href="relocating-a-pdb.html#GUID-1CECFDF5-F402-49AB-B88F-5AD532D5BF41">Stages of PDB Relocation</a><br>The details of PDB relocation vary depending on the listener networks.
                     </li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-EA37D755-A28E-4E85-BF84-F8FCE3164349__GUID-8B7D1316-9C5C-4FF0-94DB-F1AF50ABE32E">
                     <p class="notep1">See Also:</p>
                     <p><span><cite>Oracle Clusterware Administration and Deployment Guide</cite></span> to learn about <a href="../cwadd/server-control-command-reference.html#CWADD-GUID-1DCA9E3F-B929-4555-B673-921FF3588AC3" target="_blank">SRVCTL</a> and <a href="../cwadd/rapid-home-provisioning.html#GUID-CCEC5960-EDA4-4A3F-9643-0CA308EA49AA" target="_blank">Rapid Home Provisioning</a></p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="relocating-a-pdb.html#GUID-75519361-3DA2-4558-A7E5-64BC16FAFC7D" title="You can move a PDB to a different CDB or application container.">Relocating a PDB</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="sect3"><a id="GUID-B33BBFB9-824A-4D78-ABFC-351258DD77D4" name="GUID-B33BBFB9-824A-4D78-ABFC-351258DD77D4"></a><h4 id="MULTI-GUID-B33BBFB9-824A-4D78-ABFC-351258DD77D4" class="sect4"><span class="enumeration_section">8.3.1 </span>Server Session Draining When Relocating or Stopping PDBs
                  </h4>
                  <div>
                     <p>A key requirement of planned maintenance is draining or failing over PDB sessions so that application work is not interrupted.</p>
                     <p>Beginning with <span>Oracle Database 18c</span>, the database automatically marks sessions for draining when a PDB is relocated or stopped. The database uses an extensible set of rules to determine when to drain a database session, which persists until a rule is satisfied. The rules include the following:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Standard application server tests for validity</p>
                        </li>
                        <li>
                           <p>Custom SQL tests for validity</p>
                        </li>
                        <li>
                           <p>Request boundaries are in use and no request is active</p>
                        </li>
                        <li>
                           <p>Request boundaries are in use and the current request has ended</p>
                        </li>
                        <li>
                           <p>The session has one or more session states that are recoverable, and can be recreated at failover</p>
                        </li>
                     </ul>
                     <p>A typical use case is application servers and pooled applications that test connections when borrowing from connection pools, returning connections to the pool, and at batch commits. When draining sessions, the database automatically intercepts the connection test, closes the connection, and then returns a failed status for the test.&nbsp;After receiving the failed status, the application layer can request a different connection.&nbsp;In this way, the application is not disrupted.</p>
                     <p>For an optimal configuration that minimizes the effect on the client, consider using Oracle RAC with FAN and Application Continuity.</p>
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-B33BBFB9-824A-4D78-ABFC-351258DD77D4__GUID-86A91662-455C-4CCE-9DD1-EE77F1FF5715">
                        <p class="notep1">See Also:</p>
                        <p><a href="../racad/ensuring-application-continuity.html#RACAD-GUID-2DD974C8-94C2-446B-B2BD-81B8135A26C3" target="_blank"><span><cite>Oracle Real Application Clusters Administration and Deployment Guide</cite></span></a> to learn more about draining database sessions for planned maintenance
                        </p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="relocating-a-pdb.html#GUID-EA37D755-A28E-4E85-BF84-F8FCE3164349" title="The operation moves the files associated with the PDB to a new location, adds the PDB to the target CDB, and then opens the PDB.">How PDB Relocation Works</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-1CECFDF5-F402-49AB-B88F-5AD532D5BF41" name="GUID-1CECFDF5-F402-49AB-B88F-5AD532D5BF41"></a><h4 id="MULTI-GUID-1CECFDF5-F402-49AB-B88F-5AD532D5BF41" class="sect4"><span class="enumeration_section">8.3.2 </span>Stages of PDB Relocation
                  </h4>
                  <div>
                     <p>The details of PDB relocation vary depending on the listener networks.</p>
                     <p>This section contains the following topics:</p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="relocating-a-pdb.html#GUID-C0A74AC1-86E7-448A-ACA4-F75EF31D8DC7">PDB Relocation in a Common Listener Network</a><br>When the source and target location share a common listener network, forwarding client connections is not necessary because the SQL*Net layer forwards client connections implicitly.
                        </li>
                        <li class="ulchildlink"><a href="relocating-a-pdb.html#GUID-355DBFEE-4330-4B57-8B81-0DD094EBCDE4">PDB Relocation in Isolated Listener Networks</a><br>When independent listeners do not use cross-registration, the listener in the target CDB and source CDB have no knowledge of each other or of their respective published services.
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="relocating-a-pdb.html#GUID-EA37D755-A28E-4E85-BF84-F8FCE3164349" title="The operation moves the files associated with the PDB to a new location, adds the PDB to the target CDB, and then opens the PDB.">How PDB Relocation Works</a></p>
                        </div>
                     </div>
                  </div>
                  
                  <div class="sect4"><a id="GUID-C0A74AC1-86E7-448A-ACA4-F75EF31D8DC7" name="GUID-C0A74AC1-86E7-448A-ACA4-F75EF31D8DC7"></a><h5 id="MULTI-GUID-C0A74AC1-86E7-448A-ACA4-F75EF31D8DC7" class="sect5"><span class="enumeration_section">8.3.2.1 </span>PDB Relocation in a Common Listener Network
                     </h5>
                     <div>
                        <p>When the source and target location share a common listener network, forwarding client connections is not necessary because the SQL*Net layer forwards client connections implicitly.</p>
                        <div class="section">
                           <p class="subhead3" id="GUID-C0A74AC1-86E7-448A-ACA4-F75EF31D8DC7__GUID-57C3244B-7A6A-4858-8963-9D4501B13DB2">AVAILABILITY NORMAL</p>
                           <p>When the listener network is common, specify the <code class="codeph">AVAILABILITY NORMAL</code> clause in <code class="codeph">CREATE PLUGGABLE DATABASE ... RELOCATE</code>. This option is the default. The following situations are typical use cases for <code class="codeph">AVAILABILITY NORMAL</code>:
                           </p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>Shared listener</p>
                                 <p>If you use the same listener for the PDB in its old and new locations, then new connections are automatically routed to the new location when relocation completes. This situation is typical of a relocation between CDBs in the same host. In this case, the PDB is re-registered with the listener in its new location. Additional connection handling is not required.</p>
                              </li>
                              <li>
                                 <p>Cross-registered listeners</p>
                                 <p>If the PDBs use different listeners, and if you employ cross-registration of their respective listeners through configuration of the <code class="codeph">local_listener</code> and <code class="codeph">remote_listener</code> parameters, then relocation is seamless. The availability and location of the PDB’s services are automatically registered with both listeners. This situation is typical of relocation between hosts within a data center, perhaps for load balancing purposes.
                                 </p>
                              </li>
                           </ul>
                           <p>In shared and cross registered listener environments, services from all databases are published to the common listener network. For this reason, services for relocated PDBs are immediately known to the common listener network. To avoid service name space collisions, PDB service definitions must be unique in the common listener network.</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-C0A74AC1-86E7-448A-ACA4-F75EF31D8DC7__GUID-B02759BE-36E6-42BF-9317-90574F338361">Stages of Relocation in a Common Listener Network</p>
                           <ol>
                              <li>
                                 <p>The user issues <code class="codeph">CREATE PLUGGABLE DATABASE ... RELOCATE AVAILABILITY NORMAL</code>.
                                 </p>
                                 <p>This step executes a hot clone of the source PDB from its original location to its target location. The source PDB copies data files, undo blocks, and redo blocks to the target PDB as of an implicit begin SCN marker.</p>
                                 <p>When this step completes, two transactionally consistent copies of this PDB exist: one in the source container and one in the target container. For the duration of the operation, processing continues uninterrupted on the source PDB. Users of an application or applications connected to the source PDB are unaware that a relocation is underway. </p>
                                 <p>All existing application connections, and new connections created during this step, continue to connect to the source PDB.</p>
                              </li>
                              <li>
                                 <p>The user issues <code class="codeph">ALTER PLUGGABLE DATABASE OPEN</code>.
                                 </p>
                                 <p>The following actions occur in the background:</p>
                                 <ol type="a">
                                    <li>
                                       <p>The target PDB implicitly sets the end SCN marker, and applies any redo or undo required to complete media recovery to satisfy the implicit end SCN marker.</p>
                                    </li>
                                    <li>
                                       <p>When media recovery occurs on the target PDB, Oracle Database initiates active session draining on the source PDB.</p>
                                    </li>
                                    <li>
                                       <p>PDB services are registered with the listener and are available on the target CDB.</p>
                                    </li>
                                    <li>
                                       <p>The source PDB is closed.</p>
                                    </li>
                                    <li>
                                       <p>The target PDB opens in read/write mode.</p>
                                       <p>This step completes the relocation of the PDB to the target CDB. At the end of the operation, connections point to the newly relocated PDB.</p>
                                       <p>After the PDB is opened in read/write mode, its status is <code class="codeph">NORMAL</code>. The database returns an error if you attempt to open the PDB in read-only mode.
                                       </p>
                                    </li>
                                 </ol>
                              </li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="infoboxnotealso" id="GUID-C0A74AC1-86E7-448A-ACA4-F75EF31D8DC7__GUID-F55504A4-B071-443B-B3EB-CA525E602884">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><a href="../netag/configuring-and-administering-oracle-net-listener.html#NETAG-GUID-63F36312-FDA8-4B20-B8E1-4949AD55707A" target="_blank"><span><cite>Oracle Database Net Services Administrator's Guide</cite></span></a> for more information about listener redirects
                                 </p>
                              </li>
                              <li>
                                 <p><a href="../racad/ensuring-application-continuity.html#RACAD-GUID-C1EF6BDA-5F90-448F-A1E2-DC15AD5CFE75" target="_blank"><span><cite>Oracle Real Application Clusters Administration and Deployment Guide</cite></span></a> to learn more about using Application Continuity to drain and migration sessions before planned maintenance
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="relocating-a-pdb.html#GUID-1CECFDF5-F402-49AB-B88F-5AD532D5BF41" title="The details of PDB relocation vary depending on the listener networks.">Stages of PDB Relocation</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
                  <div class="sect4"><a id="GUID-355DBFEE-4330-4B57-8B81-0DD094EBCDE4" name="GUID-355DBFEE-4330-4B57-8B81-0DD094EBCDE4"></a><h5 id="MULTI-GUID-355DBFEE-4330-4B57-8B81-0DD094EBCDE4" class="sect5"><span class="enumeration_section">8.3.2.2 </span>PDB Relocation in Isolated Listener Networks
                     </h5>
                     <div>
                        <p>When independent listeners do not use cross-registration, the listener in the target CDB and source CDB have no knowledge of each other or of their respective published services.</p>
                        <div class="section">
                           <p class="subhead3" id="GUID-355DBFEE-4330-4B57-8B81-0DD094EBCDE4__GUID-D6B0E831-9C27-4C84-AEE2-0E1A035A6A65">AVAILABILITY MAX</p>
                           <p>The <code class="codeph">AVAILABILITY MAX</code> clause in <code class="codeph">CREATE PLUGGABLE DATABASE ... RELOCATE</code> implicitly instructs the SQL*Net layer to reconfigure the original listener. This situation may be common when relocating a PDB between data centers. This configuration is intended to be temporary while the Oracle Internet Directory (OID) or LDAP server is updated or the client connections are modified.
                           </p>
                           <p>If a local listener redirects to a Single Client Access Name (SCAN) listener in an Oracle RAC configuration, then this listener may need to further redirect the client connection request to another cluster node. Multiple redirects are not supported by Oracle Net listeners by default. Because any SCAN listener can route the connection request to any node, set the <code class="codeph">ALLOW_MULTIPLE_REDIRECTS_<span class="codeinlineitalic">listener_name</span></code> parameter to the <code class="codeph"><span class="codeinlineitalic">listener_name</span></code> of every SCAN listener, and set it in every <code class="codeph">listener.ora</code> file in the cluster. For example, if the SCAN listeners are named <code class="codeph">listener_scan1</code>, <code class="codeph">listener_scan2</code>, and <code class="codeph">listener_scan3</code>, then the <code class="codeph">listener.ora</code> file on every destination host should have the following settings:
                           </p><pre class="pre codeblock"><code>ALLOW_MULTIPLE_REDIRECTS_LISTENER_SCAN1=YES
ALLOW_MULTIPLE_REDIRECTS_LISTENER_SCAN2=YES
ALLOW_MULTIPLE_REDIRECTS_LISTENER_SCAN3=YES</code></pre><div class="infoboxnote" id="GUID-355DBFEE-4330-4B57-8B81-0DD094EBCDE4__GUID-E5DFD462-7C99-4B2D-A1B1-48749B17A6EE">
                              <p class="notep1">Caution:</p>
                              <p>Do not set the <code class="codeph">ALLOW_MULTIPLE_REDIRECTS_<span class="codeinlineitalic">listener_name</span></code> parameter for node listeners because it may allow infinite redirection loops in certain network configurations.
                              </p>
                           </div>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-355DBFEE-4330-4B57-8B81-0DD094EBCDE4__GUID-A3A41CE9-E9AE-46D6-A025-99175977905A">Stages of Relocation in an Isolated Listener Network</p>
                           <ol>
                              <li>
                                 <p>The user issues <code class="codeph">CREATE PLUGGABLE DATABASE ... RELOCATE AVAILABILITY MAX</code>.
                                 </p>
                                 <p>This step executes a hot clone of the source PDB from its original location to its target location. The source PDB copies data files, undo blocks, and redo blocks to the target PDB as of an implicit begin SCN marker.</p>
                              </li>
                              <li>
                                 <p>The user issues <code class="codeph">ALTER PLUGGABLE DATABASE OPEN</code>.
                                 </p>
                                 <p>The following actions occur in the background:</p>
                                 <ol type="a">
                                    <li>
                                       <p>The target PDB implicitly sets the end SCN marker, and applies any redo or undo required to complete media recovery to satisfy the implicit end SCN marker.</p>
                                    </li>
                                    <li>
                                       <p>When media recovery occurs on the target PDB, Oracle Database initiates active session draining on the source PDB.</p>
                                    </li>
                                    <li>
                                       <p>The <code class="codeph">LISTENER_NETWORKS</code> initialization parameter is implicitly updated in the source PDB with the forwarding address, and the listener PDB services for the source CDB are updated with the forwarding address.
                                       </p>
                                    </li>
                                    <li>
                                       <p>The target PDB opens in read-only mode while media recovery completes.</p>
                                       <p>At this stage, only queries of the target PDB are permitted. Queries behave exactly as if they had been run on the source PDB. However, connections attempting DML do not complete.</p>
                                    </li>
                                    <li>
                                       <p>Read-only connections are immediately forwarded to the new hosting listener, and new read/write connections are forwarded to the new hosting listener, where they spin until the target PDB is opened in a consistent state.</p>
                                    </li>
                                    <li>
                                       <p>The source PDB executes a <code class="codeph">SHUTDOWN IMMEDIATE</code>, terminating persistent connections.
                                       </p>
                                    </li>
                                    <li>
                                       <p>The target PDB opens in read/write mode.</p>
                                       <p>This step completes the relocation of the PDB to the target CDB. At the end of the operation, connections point to the newly relocated PDB.</p>
                                       <p>After the PDB is opened in read/write mode, its status is <code class="codeph">NORMAL</code>. The database returns an error if you attempt to open the PDB in read-only mode.
                                       </p>
                                    </li>
                                 </ol>
                              </li>
                           </ol>
                           <div class="infoboxnote" id="GUID-355DBFEE-4330-4B57-8B81-0DD094EBCDE4__GUID-EE867FD7-3C5A-402D-BE1B-D7EF07927251">
                              <p class="notep1">Note:</p>
                              <p>An artifact known as a <span class="italic">tombstone PDB</span> remains in the source CDB to protect the PDB’s namespace and preserve the listener forwarding configuration until the updates are complete. In the root of the source CDB, the tombstone PDB is visible in <code class="codeph">V$CONTAINERS</code> with a status of <code class="codeph">RELOCATED</code>. When you change the application connect strings to provide direct connections to the target PDB, you can drop the tombstone PDB from the source CDB.
                              </p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="infoboxnotealso" id="GUID-355DBFEE-4330-4B57-8B81-0DD094EBCDE4__GUID-A352C9F1-971A-463D-8177-4C2FC9D6AA1B">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><span class="q">"<a href="creating-removing-application-containers-seeds-with-sql-plus.html#GUID-88E61123-F651-47D7-9977-B589268EBD29" title="You create an application PDB by running the CREATE&nbsp;PLUGGABLE&nbsp;DATABASE&nbsp;statement with an application root as the current container.">Creating an Application PDB</a>"</span></p>
                              </li>
                              <li>
                                 <p><a href="../netag/configuring-and-administering-oracle-net-listener.html#NETAG-GUID-63F36312-FDA8-4B20-B8E1-4949AD55707A" target="_blank"><span><cite>Oracle Database Net Services Administrator's Guide</cite></span></a> for more information about listener redirects
                                 </p>
                              </li>
                              <li>
                                 <p><a href="../racad/ensuring-application-continuity.html#RACAD-GUID-C1EF6BDA-5F90-448F-A1E2-DC15AD5CFE75" target="_blank"><span><cite>Oracle Real Application Clusters Administration and Deployment Guide</cite></span></a> to learn more about using Application Continuity to drain and migration sessions before planned maintenance
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="relocating-a-pdb.html#GUID-1CECFDF5-F402-49AB-B88F-5AD532D5BF41" title="The details of PDB relocation vary depending on the listener networks.">Stages of PDB Relocation</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-9460B932-8EF8-4261-87C9-7267213EBD11" name="GUID-9460B932-8EF8-4261-87C9-7267213EBD11"></a><h3 id="MULTI-GUID-9460B932-8EF8-4261-87C9-7267213EBD11" class="sect3"><span class="enumeration_section">8.4 </span>User Interface for PDB Relocation
               </h3>
               <div>
                  <p>You can relocate PDBs on the command line using SQL, the DBCA utility, or the Rapid Home Provisioning utility.</p>
                  <div class="section">
                     <p class="subhead2" id="GUID-9460B932-8EF8-4261-87C9-7267213EBD11__GUID-A21F1542-2EA9-4E29-8D7B-B361D477A8DC">SQL Statement</p>
                     <p>The form of the SQL statement is as follows:</p><pre class="pre codeblock"><code>CREATE PLUGGABLE DATABASE ... FROM <span class="italic">src_pdb_name</span>@<span class="italic">link2src</span> ... RELOCATE AVAILABILITY [MAX | NORMAL]</code></pre><p>The <code class="codeph">FROM</code> clause identifies the location of the source PDB. For <code class="codeph"><span class="codeinlineitalic">src_pdb_name</span></code>, specify the name of the source PDB. For <code class="codeph">link2src</code>, specify a database link that indicates the location of the source PDB. The database link must have been created in the target CDB, which is the CDB to which the PDB will be relocated. The link can connect either to the root of the remote CDB or to the remote PDB. 
                     </p>
                     <p>The <code class="codeph">AVAILABILITY</code> clause determines how the database handles client connections.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-9460B932-8EF8-4261-87C9-7267213EBD11__GUID-55B2D766-A4B9-4320-97AA-1C071466E7CE">DBCA</p>
                     <p>You can relocate a PDB by running DBCA in silent mode. The <code class="codeph">relocatePDB</code> command performs the relocation.
                     </p>
                     <div class="tblformal" id="GUID-9460B932-8EF8-4261-87C9-7267213EBD11__GUID-BA2854A7-C540-4BF0-82B5-7E90D2E627B5">
                        <p class="titleintable">Table 8-1 relocatePDB Parameters</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="relocatePDB Parameters" summary="This table describe the parameters for the -relocatePDB command in DBCA silent mode." frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" id="d44547e1304">Parameter</th>
                                 <th align="left" valign="bottom" id="d44547e1306">Description</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d44547e1310" headers="d44547e1304 ">
                                    <p><code class="codeph">-remotePDBName <span class="codeinlineitalic">remote_pdb_name</span></code></p>
                                 </td>
                                 <td align="left" valign="top" headers="d44547e1310 d44547e1306 ">
                                    <p>The name of the PDB that you intend to relocate.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d44547e1320" headers="d44547e1304 ">
                                    <p><code class="codeph">-remoteDBConnString <span class="codeinlineitalic">remote_db_conn_string</span></code></p>
                                 </td>
                                 <td align="left" valign="top" headers="d44547e1320 d44547e1306 ">
                                    <p>The net service connection to the remote CDB.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d44547e1330" headers="d44547e1304 ">
                                    <p><code class="codeph">-sysDBAUserName <span class="codeinlineitalic">sysdbusername</span></code></p>
                                 </td>
                                 <td align="left" valign="top" headers="d44547e1330 d44547e1306 ">
                                    <p>The name of the <code class="codeph">SYS</code> user in the local CDB.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d44547e1343" headers="d44547e1304 ">
                                    <p><code class="codeph">-sysDBAPassword <span class="codeinlineitalic">sysdbapassowrd</span></code></p>
                                 </td>
                                 <td align="left" valign="top" headers="d44547e1343 d44547e1306 ">
                                    <p>The password of the <code class="codeph">SYS</code> user in the local CDB.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d44547e1356" headers="d44547e1304 ">
                                    <p><code class="codeph">-remoteDBSYSDBAUserName <span class="codeinlineitalic">sysdbusername</span></code></p>
                                 </td>
                                 <td align="left" valign="top" headers="d44547e1356 d44547e1306 ">
                                    <p>The name of the <code class="codeph">SYS</code> user in the remote CDB.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d44547e1369" headers="d44547e1304 ">
                                    <p><code class="codeph">-remoteDBSYSDBAPassword <span class="codeinlineitalic">sysdbapassowrd</span></code></p>
                                 </td>
                                 <td align="left" valign="top" headers="d44547e1369 d44547e1306 ">
                                    <p>The password of the <code class="codeph">SYS</code> user in the remote CDB.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d44547e1382" headers="d44547e1304 ">
                                    <p><code class="codeph">-dbLinkUsername <span class="codeinlineitalic">dblink_common_user_name</span></code></p>
                                 </td>
                                 <td align="left" valign="top" headers="d44547e1382 d44547e1306 ">
                                    <p>The name of the common user in the remote CDB.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d44547e1392" headers="d44547e1304 ">
                                    <p><code class="codeph">-dbLinkUserPassword <span class="codeinlineitalic">dblink_common_username_pwd</span></code></p>
                                 </td>
                                 <td align="left" valign="top" headers="d44547e1392 d44547e1306 ">
                                    <p>The password of the common user in the remote CDB.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d44547e1402" headers="d44547e1304 ">
                                    <p><code class="codeph">-sourceDB <span class="codeinlineitalic">dbname_pdb_toberelocated</span></code></p>
                                 </td>
                                 <td align="left" valign="top" headers="d44547e1402 d44547e1306 ">
                                    <p>The name of the source PDB.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d44547e1412" headers="d44547e1304 ">
                                    <p><code class="codeph">-pdbName <span class="codeinlineitalic">pdbtoberecreated</span></code></p>
                                 </td>
                                 <td align="left" valign="top" headers="d44547e1412 d44547e1306 ">
                                    <p>The name of the PDB after relocation.</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-9460B932-8EF8-4261-87C9-7267213EBD11__GUID-0FAAE4EE-7E3B-4A4B-AED5-E9DB2589AE7A">Rapid Home Provisioning Control (RHPCTL)</p>
                     <p>In Oracle Grid Infrastructure, you can use Rapid Home Provisioning to automate relocation of a PDB from one CDB to another.</p>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-9460B932-8EF8-4261-87C9-7267213EBD11__GUID-EDF43CD9-14B8-4B26-85A4-A2C9598316CB">
                     <p class="notep1">See Also:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="../sqlrf/CREATE-PLUGGABLE-DATABASE.html#GUID-F2DBA8DD-EEA8-4BB7-A07F-78DC04DB1FFC" target="_blank"><span><cite>Oracle Database SQL Language Reference</cite></span></a> for <code class="codeph">CREATE PLUGGABLE DATABASE</code> syntax and semantics
                           </p>
                        </li>
                        <li>
                           <p><a href="../admin/creating-and-configuring-an-oracle-database.html#GUID-5DD346B8-4404-48F1-A811-F39D739E4D05" target="_blank"><span><cite>Oracle Database Administrator’s Guide</cite></span></a></p> for the DBCA command reference for silent mode
                        </li>
                        <li>
                           <p><a href="../cwadd/rapid-home-provisioning.html#GUID-CCEC5960-EDA4-4A3F-9643-0CA308EA49AA" target="_blank"><span><cite>Oracle Clusterware Administration and Deployment Guide</cite></span></a> to learn more about Rapid Home Provisioning
                           </p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="relocating-a-pdb.html#GUID-75519361-3DA2-4558-A7E5-64BC16FAFC7D" title="You can move a PDB to a different CDB or application container.">Relocating a PDB</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="props_rev_3"><a id="GUID-F887DBA7-61A6-49FB-8400-40632765F1E1" name="GUID-F887DBA7-61A6-49FB-8400-40632765F1E1"></a><h3 id="MULTI-GUID-F887DBA7-61A6-49FB-8400-40632765F1E1" class="sect3"><span class="enumeration_section">8.5 </span>Relocating a PDB Using CREATE PLUGGABLE DATABASE
               </h3>
               <div>
                  <p>The <code class="codeph">CREATE PLUGGABLE DATABASE ... RELOCATE</code> statement moves a PDB to a different container.
                  </p>
                  <div class="section">
                     <p>The <span class="italic">target CDB</span> is the CDB to which the PDB is being relocated. The <span class="italic">target PDB</span> is the relocated PDB. After the <code class="codeph">CREATE PLUGGABLE DATABASE ... RELOCATE</code> operation completes, Oracle Database moves the PDB from the source CDB and then adds it to the target CDB.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-F887DBA7-61A6-49FB-8400-40632765F1E1__GENERALPREREQUISITES-BD079BBC">
                     <p class="subhead2" id="GUID-F887DBA7-61A6-49FB-8400-40632765F1E1__GUID-718B7370-0EF5-4CCA-A5FD-77D24648F0B8">General Prerequisites</p>
                     <p>Address the questions that apply to relocating a PDB in <span class="q">"<a href="overview-of-pdb-creation.html#GUID-87F21FDE-7115-4207-954E-B229C1879EF6__GUID-57A2E4B5-E8EB-4294-95C2-A3E04AF93D8C" title="This table describes each clause and when to use each clause.">Table 5-3</a>"</span>. The table describes which <code class="codeph">CREATE PLUGGABLE DATABASE</code> clauses you must specify based on different factors. Also, complete the prerequisites described in <span class="q">"<a href="overview-of-pdb-creation.html#GUID-B26D56E1-B958-444F-864C-8AFDFF1566A6" title="Before creating a PDB, you must meet certain prerequisites.">General Prerequisites for PDB Creation</a>"</span>.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-F887DBA7-61A6-49FB-8400-40632765F1E1__GUID-EAE2739C-FE18-4CF5-AA6D-8278421DA336">Specific Prerequisites</p>
                     <p>Before relocating the PDB, you must meet the following prerequisites:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>The source CDB must be in local undo mode.</p>
                        </li>
                        <li>
                           <p>In the source CDB, you must save the service and open state of the PDBs in all database instances. Log in to the CDB root as an administrator and issue the following statement:</p><pre class="pre codeblock"><code>ALTER PLUGGABLE DATABASE ALL SAVE STATE INSTANCES=ALL;</code></pre><p>This step ensures that the PDB relocation operation automatically starts the PDB services in the target CDB. </p>
                        </li>
                        <li>
                           <p>In the target CDB, the current user must have the <code class="codeph">CREATE PLUGGABLE DATABASE</code> system privilege in the CDB root.
                           </p>
                        </li>
                        <li>
                           <p>If the target CDB is not in <code class="codeph">ARCHIVELOG</code> mode, then the PDB must be in open read-only mode during the operation. This requirement does not apply if the target CDB is in <code class="codeph">ARCHIVELOG</code> mode.
                           </p>
                        </li>
                        <li>
                           <p>The following prerequisites apply to the database link:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>A database link must enable a connection from the target CDB to the source CDB. The database link must connect to the root of the source CDB. If the PDB is an application PDB, then the database link must connect to its application root.</p>
                              </li>
                              <li>
                                 <p>The user that the database link connects with in current CDB of the PDB must have either the <code class="codeph">CREATE PLUGGABLE DATABASE</code> system privilege or the <code class="codeph">SYSOPER</code> administrative privilege.
                                 </p>
                              </li>
                              <li>
                                 <p>If the database link connects to the CDB root in the PDB’s current CDB, then the user that the database link connects with must be a common user.</p>
                              </li>
                           </ul>
                        </li>
                        <li>
                           <p>The platforms of the PDB’s current CDB and the CDB to which it is being relocated must meet the following requirements:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>They must have the same endianness.</p>
                              </li>
                              <li>
                                 <p>The database options installed on the source platform must be the same as, or a subset of, the database options installed on the target platform.</p>
                              </li>
                           </ul>
                        </li>
                        <li>
                           <p>If the character set of the CDB to which the PDB is being relocated is not AL32UTF8, then the PDB’s current CDB and the CDB to which it is being relocated must have compatible character sets and national character sets.</p> 
                           <p>If the character set of the CDB to which the PDB is being relocated is AL32UTF8, then this requirement does not apply.</p>
                        </li>
                        <li>
                           <p>If you are creating an application PDB, then the source PDB and target application container must have the same application name and version.</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-F887DBA7-61A6-49FB-8400-40632765F1E1__GUID-C4A3DE1C-CC50-46D7-9D92-4BFF8D01A49E">To relocate a PDB:</p>
                     <ol>
                        <li>
                           <p>In SQL*Plus, log in to the target CDB as a user with the <code class="codeph">CREATE PLUGGABLE DATABASE</code> system privilege.
                           </p>
                        </li>
                        <li>
                           <p>Ensure that the current container is the root of the target CDB or target application container.</p>
                        </li>
                        <li>
                           <p>Run the <code class="codeph">CREATE PLUGGABLE DATABASE ... RELOCATE</code> statement with the <code class="codeph">FROM</code> clause. 
                           </p>
                           <p>Specify the source PDB in the <code class="codeph">FROM</code> clause, and include the <code class="codeph">RELOCATE</code> clause. To redirect connections from the old location of the PDB to the new location, specify the <code class="codeph">AVAILABILITY MAX</code>&nbsp;clause. Specify other clauses when they are required.
                           </p>
                           <p>After you relocate the PDB, it is in mounted mode, and its status is <code class="codeph">RELOCATING</code>. You can view the open mode of a PDB by querying the <code class="codeph">OPEN_MODE</code> column in the <code class="codeph">V$PDBS</code> view. You can view the status of a PDB by querying the <code class="codeph">STATUS</code> column of the <code class="codeph">CDB_PDBS</code> or <code class="codeph">DBA_PDBS</code> view.
                           </p>
                           <p>A new default service is created for the PDB. The service has the same name as the PDB and can be used to access the PDB. Oracle Net Services must be configured properly for clients to access this service.</p>
                        </li>
                        <li>
                           <p>Optionally, to determine the status of the file copy operation, query <code class="codeph">V$SESSION_LONGOPS</code>.
                           </p>
                           <p>The <code class="codeph">OPNAMES</code> column shows <code class="codeph">kpdbfCopyTaskCbk</code> for the data file copy and <code class="codeph">kcrfremnoc</code> for the redo file copy.
                           </p>
                        </li>
                        <li>
                           <p>Open the new PDB in read/write mode.</p>
                           <p>This step is required to complete the integration of the new PDB into the CDB. After the PDB is opened in read/write mode, its status is <code class="codeph">NORMAL</code>. An error is returned if you attempt to open the PDB in read-only mode.
                           </p>
                        </li>
                        <li>
                           <p>Back up the PDB.</p>
                           <p>A PDB cannot be recovered unless it is backed up.</p>
                           <div class="infoboxnote" id="GUID-F887DBA7-61A6-49FB-8400-40632765F1E1__GUID-A9FFF8B4-5144-40E0-B701-6D2154BAD23D">
                              <p class="notep1">Note:</p>
                              <p>If an error is returned during PDB relocation, then the PDB being created might be in an <code class="codeph">UNUSABLE</code> state. You can check the PDB state by querying the <code class="codeph">CDB_PDBS</code> or <code class="codeph">DBA_PDBS</code> view, and you can learn more about PDB creation errors by checking the alert log. An unusable PDB can only be dropped, and it must be dropped before a PDB with the same name as the unusable PDB can be created.
                              </p>
                           </div>
                        </li>
                     </ol>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-F887DBA7-61A6-49FB-8400-40632765F1E1__CEGHIBHC"></div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-F887DBA7-61A6-49FB-8400-40632765F1E1__GUID-8E71C064-FAE4-4FC6-9043-FB79FA7D0BA4">
                     <p class="notep1">See Also:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><span class="q">"<a href="administering-a-cdb-with-sql-plus.html#GUID-8F8B2FF8-7FA7-40CD-8AA5-ACABCD3964D8" title="You can configure a CDB to use local undo in every container or to use shared undo for the entire CDB.">About the CDB Undo Mode</a>"</span></p>
                        </li>
                        <li>
                           <p><span class="q">"<a href="administering-a-cdb-with-sql-plus.html#GUID-322C5C03-4C48-40CD-8230-0BA5F16BF96B" title="You can modify the open mode of a PDB by using the ALTER PLUGGABLE DATABASE SQL statement or the SQL*Plus STARTUP command.">Modifying the Open Mode of One or More PDBs</a>"</span></p>
                        </li>
                        <li>
                           <p><a href="../nlspg/choosing-character-set.html#NLSPG1035" target="_blank"><span><cite>Oracle Database Globalization Support Guide</cite></span></a> for the compatibility requirements for character sets and national character sets
                           </p>
                        </li>
                        <li>
                           <p><a href="../bradv/backing-up-database.html#BRADV428" target="_blank"><span><cite>Oracle Database Backup and Recovery User’s Guide</cite></span></a> for information about backing up a PDB
                           </p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="relocating-a-pdb.html#GUID-75519361-3DA2-4558-A7E5-64BC16FAFC7D" title="You can move a PDB to a different CDB or application container.">Relocating a PDB</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-6A85B92C-0AE6-4737-BDBD-EA8256C09E55" name="GUID-6A85B92C-0AE6-4737-BDBD-EA8256C09E55"></a><h3 id="MULTI-GUID-6A85B92C-0AE6-4737-BDBD-EA8256C09E55" class="sect3"><span class="enumeration_section">8.6 </span>Relocating a PDB: Examples
               </h3>
               <div>
                  <p>The examples in this section demonstration relocation using SQL and DBCA.</p>
                  <p>This section contains the following topics:</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="relocating-a-pdb.html#GUID-DA26CC0C-788C-4F7C-AEA8-ED0C3C32B578">Relocating a PDB from a Remote CDB</a><br>This example relocates a PDB named <code class="codeph">pdb1</code> from a remote CDB to the current CDB.
                     </li>
                     <li class="ulchildlink"><a href="relocating-a-pdb.html#GUID-146006B7-42F1-47EB-B1BA-C3F8E6DD89A8">Relocating a PDB Using DBCA: Example</a><br>This example uses DBCA to relocate a PDB named <code class="codeph">pdb1</code> from a remote CDB to the local CDB, where it will be renamed <code class="codeph">relpdb1</code>.
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="relocating-a-pdb.html#GUID-75519361-3DA2-4558-A7E5-64BC16FAFC7D" title="You can move a PDB to a different CDB or application container.">Relocating a PDB</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="sect3"><a id="GUID-DA26CC0C-788C-4F7C-AEA8-ED0C3C32B578" name="GUID-DA26CC0C-788C-4F7C-AEA8-ED0C3C32B578"></a><h4 id="MULTI-GUID-DA26CC0C-788C-4F7C-AEA8-ED0C3C32B578" class="sect4"><span class="enumeration_section">8.6.1 </span>Relocating a PDB from a Remote CDB
                  </h4>
                  <div>
                     <p>This example relocates a PDB named <code class="codeph">pdb1</code> from a remote CDB to the current CDB.
                     </p>
                     <div class="section">
                        <p>In this example, the root to which the new PDB belongs depends on the current container when the <code class="codeph">CREATE PLUGGABLE DATABASE</code> statement is run:
                        </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>When the current container is the CDB root, the new PDB is created in the CDB root.</p>
                           </li>
                           <li>
                              <p>When the current container is an application root in an application container, the new PDB is created as an application PDB in the application root.</p>
                           </li>
                        </ul>
                        <p>This example relocates a PDB named <code class="codeph">pdb1</code> from a remote CDB given different factors. This example assumes the following factors:
                        </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>The current user has the <code class="codeph">CREATE PLUGGABLE DATABASE</code> system privilege in the root of the target CDB.
                              </p>
                           </li>
                           <li>
                              <p>The database link name to the source CDB is <code class="codeph">lnk2src</code>. This database link was created with the following SQL statement:
                              </p>
                              <p><code class="codeph">CREATE PUBLIC DATABASE LINK lnk2src CONNECT TO c##myadmin IDENTIFIED BY <span class="codeinlineitalic">password</span> USING 'MYCDB';</code></p>
                              <p>The common user <code class="codeph">c##myadmin</code> has <code class="codeph">SYSOPER</code> administrative privilege and <code class="codeph">CREATE PLUGGABLE DATABASE</code> system privilege in the source CDB.
                              </p>
                           </li>
                           <li>
                              <p>The <code class="codeph">PATH_PREFIX</code> clause is not required.
                              </p>
                           </li>
                           <li>
                              <p>The <code class="codeph">FILE_NAME_CONVERT</code> clause and the <code class="codeph">CREATE_FILE_DEST</code> clause are not required.
                              </p>
                              <p>Either Oracle Managed Files is enabled, or the <code class="codeph">PDB_FILE_NAME_CONVERT</code> initialization parameter is set. The files will be moved to a new location based on the Oracle Managed Files configuration or the initialization parameter setting.
                              </p>
                           </li>
                           <li>
                              <p>Storage limits are not required for the PDB. Therefore, the <code class="codeph">STORAGE</code> clause is not required.
                              </p>
                           </li>
                           <li>
                              <p>There is no file with the same name as the new temp file that will be created in the target location. Therefore, the <code class="codeph">TEMPFILE REUSE</code> clause is not required.
                              </p>
                           </li>
                           <li>
                              <p>Connections should be relocated automatically from the source PDB to the relocated PDB. Therefore, the <code class="codeph">AVAILABILITY MAX</code> clause is included.
                              </p>
                           </li>
                        </ul>
                        <p>The following statement relocates the <code class="codeph">pdb1</code> PDB from the source CDB to the current CDB:
                        </p><pre class="pre codeblock"><code>CREATE PLUGGABLE DATABASE pdb1 FROM pdb1@lnk2src RELOCATE AVAILABILITY MAX;
</code></pre></div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="relocating-a-pdb.html#GUID-6A85B92C-0AE6-4737-BDBD-EA8256C09E55" title="The examples in this section demonstration relocation using SQL and DBCA.">Relocating a PDB: Examples</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-146006B7-42F1-47EB-B1BA-C3F8E6DD89A8" name="GUID-146006B7-42F1-47EB-B1BA-C3F8E6DD89A8"></a><h4 id="MULTI-GUID-146006B7-42F1-47EB-B1BA-C3F8E6DD89A8" class="sect4"><span class="enumeration_section">8.6.2 </span>Relocating a PDB Using DBCA: Example
                  </h4>
                  <div>
                     <p>This example uses DBCA to relocate a PDB named <code class="codeph">pdb1</code> from a remote CDB to the local CDB, where it will be renamed <code class="codeph">relpdb1</code>.
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-146006B7-42F1-47EB-B1BA-C3F8E6DD89A8__GUID-0AF9187B-7A89-4A64-9D4E-1E44A7DA82A2">Prerequisites</p>
                        <p>This scenario assumes the following:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>The user in the local database has the <code class="codeph">CREATE PLUGGABLE DATABASE</code> privilege in the root container.
                              </p>
                           </li>
                           <li>
                              <p>The remote CDB is in local undo mode.</p>
                           </li>
                           <li>
                              <p>The remote and local CDBs are in <code class="codeph">ARCHIVELOG</code> mode.
                              </p>
                           </li>
                           <li>
                              <p>The common user in the remote CDB to whom the database link connects has the <code class="codeph">CREATE PLUGGABLE DATABASE</code>, <code class="codeph">SESSION</code>, and <code class="codeph">SYSOPER</code> privilege. 
                              </p>
                           </li>
                           <li>
                              <p>The local and remote CDBs have the same options installed.</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-146006B7-42F1-47EB-B1BA-C3F8E6DD89A8__PREREQUISITES-9DAFF8A2">Assumptions</p>
                        <p>This scenario assumes the following:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>You are running DBCA on the host of the CDB that will contain the relocated PDB. The local CDB is named <code class="codeph">loccdb1</code>.
                              </p>
                           </li>
                           <li>
                              <p>The remote (source) CDB is named <code class="codeph">remcdb1</code> and resides on host <code class="codeph">remcdb1host</code>. The instance name for the remote CDB is <code class="codeph">reminst</code>.
                              </p>
                           </li>
                           <li>
                              <p>The remote PDB, which is the PDB to be relocated, is named <code class="codeph">rempdb1</code>.
                              </p>
                           </li>
                           <li>
                              <p>The common user <code class="codeph">c##adminuser_remcdb1</code> resides in <code class="codeph">remcdb1</code>.
                              </p>
                           </li>
                           <li>
                              <p>The administrative user <code class="codeph">locSYS</code> has <code class="codeph">SYSDBA</code> privileges on <code class="codeph">loccdb1</code>, which is the CDB to which the PDB is being relocated.
                              </p>
                           </li>
                           <li>
                              <p>The administrative user <code class="codeph">remSYS</code> has <code class="codeph">SYSDBA</code> privileges on <code class="codeph">remcdb1</code>, which is the CDB that contains the PDB to be relocated.
                              </p>
                           </li>
                           <li>
                              <p>After relocation to <code class="codeph">loccdb1</code>, the PDB will be renamed <code class="codeph">relpdb1</code>.
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-146006B7-42F1-47EB-B1BA-C3F8E6DD89A8__GUID-A5FEF59A-A31C-490F-A28A-E53A68A8B822">
                        <p>This following silent command relocates <code class="codeph">rempdb1</code> to <code class="codeph">loccdb1</code>:
                        </p><pre class="pre codeblock"><code>./dbca -silent 
  -relocatePDB
  -sourceDB <span class="bold">remcdb1</span>  
  -remotePDBName <span class="bold">rempdb1</span> 
  -remoteDBConnString <span class="bold">remcdb1host:1521/reminst</span> 
  -remoteDBSYSDBAUserName <span class="bold">remSYS</span> 
      -remoteDBSYSDBAUserPassword <span class="italic">remsyspwd</span> 
  -dbLinkUsername <span class="bold">c##adminuser_remcdb1</span> 
      -dbLinkUserPassword <span class="italic">pwd4dblinkusr</span> 
  -sysDBAUserName <span class="bold">locSYS</span> 
      -sysDBAPassword <span class="italic">locsyspwd</span>
  -pdbName <span class="bold">relpdb1</span></code></pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-146006B7-42F1-47EB-B1BA-C3F8E6DD89A8__GUID-EFC6AA59-AE8E-4D34-9560-14F68CB9C456">
                        <p class="notep1">See Also:</p>
                        <p><a href="../admin/creating-and-configuring-an-oracle-database.html#GUID-5DD346B8-4404-48F1-A811-F39D739E4D05" target="_blank"><span><cite>Oracle Database Administrator’s Guide</cite></span></a> for syntax and semantics of DBCA commands
                        </p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="relocating-a-pdb.html#GUID-6A85B92C-0AE6-4737-BDBD-EA8256C09E55" title="The examples in this section demonstration relocation using SQL and DBCA.">Relocating a PDB: Examples</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
         </div>
      </article>
   </body>
</html>