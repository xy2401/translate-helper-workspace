<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="A JSON data guide lets you discover information about the structure and content of JSON documents stored in Oracle Database."></meta>
      <meta name="description" content="A JSON data guide lets you discover information about the structure and content of JSON documents stored in Oracle Database."></meta>
      <title>JSON Data Guide</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="JSON Developer&#39;s Guide"></meta>
      <meta property="og:description" content="A JSON data guide lets you discover information about the structure and content of JSON documents stored in Oracle Database."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="JSON Developer&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="json-developers-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-02-22T10:58:31-08:00"></meta>
      <meta name="dcterms.title" content="JSON Developer&#39;s Guide"></meta>
      <meta name="dcterms.dateCopyrighted" content="2015, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96227-03"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="oracle-sql-function-json_serialize.html" title="Previous" type="text/html"></link>
      <link rel="next" href="generation-of-json-data.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="ADJSN"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="oracle-sql-function-json_serialize.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="generation-of-json-data.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">JSON Developer's Guide</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="query-json-data.html" property="item" typeof="WebPage"><span property="name">Query JSON Data</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">JSON Data Guide</li>
            </ol>
            <a id="GUID-219FC30E-89A7-4189-BC36-7B961A24067C" name="GUID-219FC30E-89A7-4189-BC36-7B961A24067C"></a>
            
            <h2 id="ADJSN-GUID-219FC30E-89A7-4189-BC36-7B961A24067C" class="sect2"><span class="enumeration_chapter">20 </span>JSON Data Guide
            </h2>
         </header>
         <div class="ind"><script type="text/javascript">window.name='json-dataguide'</script><script type="text/javascript">
    function footdisplay(footnum,footnote) {
    var msg = window.open('about:blank', 'NewWindow' + footnum,
        'directories=no,height=100,location=no,menubar=no,resizable=yes,' +
        'scrollbars=yes,status=no,toolbar=no,width=598');
    msg.document.open('text/html');
    msg.document.write('<!DOCTYPE html ');
    msg.document.write('PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" ');
    msg.document.write('"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">'); 
    msg.document.write('<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us" dir="ltr"><head><title>');
   
    msg.document.write('Footnote&nbsp; ' + footnum);
    msg.document.write('<\/title><meta http-equiv="Content-Type" ');
    msg.document.write('content="text/html; charset=utf-8" />');
    msg.document.write('<meta http-equiv="Content-Script-Type" ');
    msg.document.write('content="text/javascript" />');
    msg.document.write('<style type="text/css"> <![CDATA[ ');
    msg.document.write('h1 {text-align: center; font-size: 14pt;}');
    msg.document.write('fieldset {border: none;}');
    msg.document.write('form {text-align: center;}');
    msg.document.write(' ]]u003e </style>');
    msg.document.write('<\/head><body><div id="footnote"><h1>Footnote&nbsp; ' + footnum + '<\/h1><p>');
    msg.document.write(footnote);
    msg.document.write('<\/p><form action="" method="post"><fieldset>');
    msg.document.write('<input type="button" value="OK" ');
    msg.document.write('onclick="window.close();" />');
    msg.document.write('<\/fieldset><\/form><\/div><\/body><\/html>');
    msg.document.close();
    setTimeout(function() {
        var height = msg.document.getElementById('footnote').offsetHeight;
        msg.resizeTo(598, height + 100);
    }
    , 100);
    msg.focus();
}
            </script><noscript>
               <p>The script content on this page is for navigation purposes only and does not alter the content in any way.</p>
            </noscript>
            <div>
               <p>A JSON data guide lets you discover information about the structure and content of JSON documents stored in Oracle Database.</p>
               <div class="section">
                  <p>Some ways that you can use this information include:</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>Generating a JSON Schema document that describes the set of JSON documents.</p>
                     </li>
                     <li>
                        <p>Creating views that you can use to perform SQL operations on the data in the documents.</p>
                     </li>
                     <li>
                        <p>Automatically adding or updating virtual columns that correspond to added or changed fields in the documents.</p>
                     </li>
                  </ul>
               </div>
               <!-- class="section" -->
               <div class="section"></div>
               <!-- class="section" -->
               <div class="section">
                  <div class="infoboxnotealso" id="GUID-219FC30E-89A7-4189-BC36-7B961A24067C__GUID-CD618286-A075-4236-96E8-48B3825FC43C">
                     <p class="notep1">See Also:</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=json_schema_core" target="_blank"><span class="italic">JSON Schema: core definitions and terminology json-schema-core</span></a></p>
                        </li>
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=json_schema_validation" target="_blank"><span class="italic">JSON Schema: interactive and non interactive validation</span></a></p>
                        </li>
                     </ul>
                  </div>
               </div>
               <!-- class="section" -->
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="json-dataguide.html#GUID-8A431168-E23B-493D-8190-8A26A8D0BCF1">Overview of JSON Data Guide</a><br>A data guide is a summary of the structural and type information contained in a set of JSON documents. It records metadata about the fields used in those documents.
                  </li>
                  <li class="ulchildlink"><a href="json-dataguide.html#GUID-E77948CB-DCA0-4733-8832-4B5F00C01A2E">Persistent Data-Guide Information: Part of a JSON Search Index</a><br>JSON data-guide information can be saved persistently as part of the JSON search index infrastructure, and this information is updated automatically as new JSON content is added. This is the case by default, when you create a JSON search index: data-guide information is part of the index infrastructure.
                  </li>
                  <li class="ulchildlink"><a href="json-dataguide.html#GUID-B57975A8-3000-4F21-BB22-DC413F06D6DB">Data-Guide Formats and Ways of Creating a Data Guide</a><br>There are two formats for a data guide: flat and hierarchical. Both are made available to SQL and PL/SQL as <code class="codeph">CLOB</code> data. You can construct a data guide from the data-guide information stored in a JSON search index or by scanning JSON documents.
                  </li>
                  <li class="ulchildlink"><a href="json-dataguide.html#GUID-D8448CB1-0350-4848-B07E-9370B3B1A9BE">JSON Data-Guide Fields</a><br>The predefined fields of a JSON data guide are described. They include JSON Schema fields (keywords) and Oracle-specific fields.
                  </li>
                  <li class="ulchildlink"><a href="json-dataguide.html#GUID-70D47F29-BA01-4908-A5C1-8EB10AAB89A0">Data-Dictionary Views For Persistent Data-Guide Information</a><br>You can query static data-dictionary views to see which tables have JSON columns with data guide-enabled JSON search indexes and to extract JSON object field information that is recorded in dataguide-enabled JSON search indexes.
                  </li>
                  <li class="ulchildlink"><a href="json-dataguide.html#GUID-A0AFD360-93A7-4566-8315-6F68D9AE090B">Specifying a Preferred Name for a Field Column</a><br>You can project JSON fields from your data as columns in a database view or as virtual columns added to the same table that contains the JSON column. You can specify a preferred name for such a column.
                  </li>
                  <li class="ulchildlink"><a href="json-dataguide.html#GUID-394009D2-F829-49B0-B6EF-DB24606FEF75">Creating a View Over JSON Data Based on Data-Guide Information</a><br>Based on data-guide information, you can create a database view whose columns project particular scalar fields present in a set of JSON documents. You can choose the fields to project by editing a hierarchical data guide or by specifying a SQL/JSON path expression and a minimum frequency of field occurrence.
                  </li>
                  <li class="ulchildlink"><a href="json-dataguide.html#GUID-7AEF436C-B743-4BA1-B6D4-1F1B98E26DB1">Adding and Dropping Virtual Columns For JSON Fields Based on Data-Guide Information</a><br>Based on data-guide information for a JSON column, you can project scalar fields from that JSON data as virtual columns in the same table. The scalar fields projected are those that are not under an array.
                  </li>
                  <li class="ulchildlink"><a href="json-dataguide.html#GUID-2F4C6F52-0D96-4405-8F85-CDA0B234D0D5">Change Triggers For Data Guide-Enabled Search Index</a><br>When JSON data changes, some information in a data guide-enabled JSON search index is automatically updated. You can specify a procedure whose invocation is triggered whenever this happens. You can define your own PL/SQL procedure for this, or you can use the predefined change-trigger procedure <code class="codeph">add_vc</code>.
                  </li>
                  <li class="ulchildlink"><a href="json-dataguide.html#GUID-BD147159-87A7-4AAC-B150-44E3F10A81E1">Multiple Data Guides Per Document Set</a><br>A data guide reflects the shape of a given set of JSON documents. If a JSON column contains different types of documents, with different structure or type information, you can create and use different data guides for the different kinds of documents.
                  </li>
                  <li class="ulchildlink"><a href="json-dataguide.html#GUID-32ED8EE8-FC3E-406E-8AD6-652BB5A1D510">Querying a Data Guide</a><br>A data guide is information about a set of JSON documents. You can query it from a flat data guide that you obtain using either Oracle SQL function <code class="codeph">json_dataguide</code> or PL/SQL function <code class="codeph">DBMS_JSON.get_index_dataguide</code>. In the latter case, a data guide-enabled JSON search index must be defined on the JSON data.
                  </li>
                  <li class="ulchildlink"><a href="json-dataguide.html#GUID-12BCFCCE-18AE-4CB2-8710-EC7B712DA089">A Flat Data Guide For Purchase-Order Documents</a><br>The fields of a sample flat data guide are described. It corresponds to a set of purchase-order documents.
                  </li>
                  <li class="ulchildlink"><a href="json-dataguide.html#GUID-885E0CB3-9165-448E-96DA-1CC56276F685">A Hierarchical Data Guide For Purchase-Order Documents</a><br>The fields of a sample hierarchical data guide are described. It corresponds to a set of purchase-order documents.
                  </li>
               </ul>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>Parent topic:</strong> <a href="query-json-data.html#GUID-119E5069-77F2-45DC-B6F0-A1B312945590" title="You can query JSON data using a simple dot notation or, for more functionality, using SQL/JSON functions and conditions. You can create and query a data guide that summarizes the structure and type information of a set of JSON documents.">Query JSON Data</a></p>
                  </div>
               </div>
            </div>
            
            <div class="sect2"><a id="GUID-8A431168-E23B-493D-8190-8A26A8D0BCF1" name="GUID-8A431168-E23B-493D-8190-8A26A8D0BCF1"></a><h3 id="ADJSN-GUID-8A431168-E23B-493D-8190-8A26A8D0BCF1" class="sect3"><span class="enumeration_section">20.1 </span>Overview of JSON Data Guide
               </h3>
               <div>
                  <p>A data guide is a summary of the structural and type information contained in a set of JSON documents. It records metadata about the fields used in those documents.</p>
                  <p>For example, for the JSON object presented in <a href="json-data.html#GUID-FBC22D72-AA64-4B0A-92A2-837B32902E2C__CACCBBAI">Example 2-1</a>, a data guide specifies that the document has, among other things, an object <code class="codeph">ShippingInstructions</code> with fields <code class="codeph">name</code>, <code class="codeph">Address</code>, and <code class="codeph">Phone</code>, of types string, object, and array, respectively. The structure of object <code class="codeph">Address</code> is recorded similarly, as are the types of the elements in array <code class="codeph">Phone</code>.
                  </p>
                  <p>JSON data-guide information can be saved persistently as part of the JSON search index infrastructure, and this information is updated automatically as new JSON content is added. This is the case by default, when you create a JSON search index: data-guide information is part of the index infrastructure.</p>
                  <div class="section">
                     <p>You can use a data guide: </p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>As a basis for developing applications that involve data mining, business intelligence, or other analysis of JSON documents.</p>
                        </li>
                        <li>
                           <p>As a basis for providing user assistance about requested JSON information, including search.</p>
                        </li>
                        <li>
                           <p>To check or manipulate new JSON documents before adding them to a document set (for example: validate, type-check, or exclude certain fields).</p>
                        </li>
                     </ul>
                     <p>For such purposes you can: </p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>Query a data guide directly for information about the document set, such as field lengths or which fields occur with at least a certain frequency.</p>
                        </li>
                        <li>
                           <p>Create views, or add virtual columns, that project particular JSON fields of interest, based on their significance according to a data guide.</p>
                        </li>
                     </ul>
                     <div class="infoboxnote" id="GUID-8A431168-E23B-493D-8190-8A26A8D0BCF1__NOTE-1425-F9827709">
                        <p class="notep1">Note:</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>The advantages of virtual columns over a view are that you can build an index on a virtual column and you can obtain statistics on it for the optimizer.</p>
                           </li>
                           <li>
                              <p>Virtual columns, like columns in general, are subject to the 1000-column limit for a given table.</p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section"></div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="json-dataguide.html#GUID-D8448CB1-0350-4848-B07E-9370B3B1A9BE" title="The predefined fields of a JSON data guide are described. They include JSON Schema fields (keywords) and Oracle-specific fields.">JSON Data-Guide Fields</a></li>
                        <li><a href="indexes-for-json-data.html#GUID-D7A604E1-F617-4C92-A9D9-00B6AB78EFD8" title="A JSON search index is a general index. It can improve the performance of both (1) ad hoc structural queries, that is, queries that you might not anticipate or use regularly, and (2) full-text search. It is an Oracle Text index that is designed specifically for use with JSON data.">JSON Search Index: Ad Hoc Queries and Full-Text Search</a></li>
                        <li><a href="json-dataguide.html#GUID-32ED8EE8-FC3E-406E-8AD6-652BB5A1D510" title="A data guide is information about a set of JSON documents. You can query it from a flat data guide that you obtain using either Oracle SQL function json_dataguide or PL/SQL function DBMS_JSON.get_index_dataguide. In the latter case, a data guide-enabled JSON search index must be defined on the JSON data.">Querying a Data Guide</a></li>
                        <li><a href="json-dataguide.html#GUID-90EC7EB8-7D45-4CB7-B16E-97BA3427D35F" title="You can use a hierarchical data guide to create a database view whose columns project specified JSON fields from your documents. The fields projected are those in the data guide. You can edit the data guide to include only the fields that you want to project.">Creating a View Over JSON Data Based on a Hierarchical Data Guide</a></li>
                        <li><a href="json-dataguide.html#GUID-7AEF436C-B743-4BA1-B6D4-1F1B98E26DB1" title="Based on data-guide information for a JSON column, you can project scalar fields from that JSON data as virtual columns in the same table. The scalar fields projected are those that are not under an array.">Adding and Dropping Virtual Columns For JSON Fields Based on Data-Guide Information</a></li>
                     </ul>
                  </div>
                  <div class="infoboxnotealso" id="GUID-8A431168-E23B-493D-8190-8A26A8D0BCF1__GUID-D027FE1B-2DBF-4617-9816-BBDD6E931716">
                     <p class="notep1">See Also:</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="../arpls/DBMS_JSON.html#ARPLS-GUID-52B63CEE-669C-46FB-A276-56F7C6ECD036" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> for information about <code class="codeph">DBMS_JSON.get_index_dataguide</code></p>
                        </li>
                        <li>
                           <p><a href="../sqlrf/JSON_DATAGUIDE.html#SQLRF-GUID-4CF32887-0F46-4925-8381-AE2B74343933" target="_blank"><span><cite>Oracle Database SQL Language Reference</cite></span></a> for information about SQL function <code class="codeph">json_dataguide</code></p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="json-dataguide.html#GUID-219FC30E-89A7-4189-BC36-7B961A24067C" title="A JSON data guide lets you discover information about the structure and content of JSON documents stored in Oracle Database.">JSON Data Guide</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-E77948CB-DCA0-4733-8832-4B5F00C01A2E" name="GUID-E77948CB-DCA0-4733-8832-4B5F00C01A2E"></a><h3 id="ADJSN-GUID-E77948CB-DCA0-4733-8832-4B5F00C01A2E" class="sect3"><span class="enumeration_section">20.2 </span>Persistent Data-Guide Information: Part of a JSON Search Index
               </h3>
               <div>
                  <p>JSON data-guide information can be saved persistently as part of the JSON search index infrastructure, and this information is updated automatically as new JSON content is added. This is the case by default, when you create a JSON search index: data-guide information is part of the index infrastructure.</p>
                  <p>You can use <code class="codeph">CREATE SEARCH INDEX</code> with keywords <code class="codeph">FOR JSON</code> to create a search index, a data guide, or both at the same time. The default behavior is to create both.
                  </p>
                  <p>To create persistent data-guide information as part of a JSON search index <span class="italic">without enabling support for search</span> in the index, you specify <code class="codeph"><span class="bold">SEARCH_ON NONE</span></code> in the <code class="codeph">PARAMETERS</code> clause for <code class="codeph">CREATE SEARCH INDEX</code>, but you leave the value for <code class="codeph">DATAGUIDE</code> as <code class="codeph">ON</code> (the default value). <a href="json-dataguide.html#GUID-E77948CB-DCA0-4733-8832-4B5F00C01A2E__CREATINGAJSONDATAGUIDEWITHOUTSEARCH-E770C3B7">Example 20-1</a> illustrates this. 
                  </p>
                  <p>You can use <code class="codeph">ALTER INDEX</code> ... <code class="codeph">REBUILD</code> to enable or disable data-guide support for an <span class="italic">existing</span> JSON search index. <a href="json-dataguide.html#GUID-E77948CB-DCA0-4733-8832-4B5F00C01A2E__DISABLINGDATAGUIDESUPPORTFORANEXIST-E87466F2">Example 20-2</a> illustrates this — it disables the data-guide support that is added by default in <a href="indexes-for-json-data.html#GUID-D7A604E1-F617-4C92-A9D9-00B6AB78EFD8__GUID-5DC9D338-2D42-46B1-ADAA-793B6DA0CF3A">Example 26-17</a>.
                  </p>
                  <div class="infoboxnote" id="GUID-E77948CB-DCA0-4733-8832-4B5F00C01A2E__GUID-570DEC84-0CF4-4D45-801D-25277C68D983">
                     <p class="notep1">Note:</p>
                     <p>To create a data
                guide-enabled JSON search index, or to data guide-enable an existing JSON search
                index, you need database privilege <code class="codeph">CTXAPP</code> and Oracle Database
                Release 12c (12.2.0.1) or later.
                     </p>
                  </div>
                  <div class="infoboxnote" id="GUID-E77948CB-DCA0-4733-8832-4B5F00C01A2E__ADATAGUIDE-ENABLEDJSONSEARCHINDEXCA-109C01BD">
                     <p class="notep1">Note:</p>
                     <p>A data guide-enabled JSON search index can be built only on a column that has an <code class="codeph">is json</code> check constraint. Furthermore, for the data-guide information in the index to be updated the check constraint must be enabled. 
                     </p>
                     <p>If the check constraint becomes disabled for some reason then you must <span class="italic">rebuild the data-guide information</span> in the index and <span class="italic">re-enable the check constraint</span>, to resume automatic data-guide support updating, as follows:
                     </p><pre class="pre codeblock"><code>ALTER INDEX <span class="italic">index_name</span> REBUILD ('dataguide off');
ALTER INDEX <span class="italic">index_name</span> REBUILD ('dataguide on');
ALTER TABLE <span class="italic">table_name</span> ENABLE CONSTRAINT <span class="italic">is_json_check_constraint_name</span>;</code></pre><p>In particular, using SQL*Loader (<code class="codeph">sqlldr</code>) disables <code class="codeph">is json</code> check constraints.
                     </p>
                  </div>
                  <p>Because persistent data-guide information is part of the search index infrastructure, it is always <span class="italic">live</span>: its content is automatically updated whenever the index is synchronized. Changes in the indexed data are reflected in the search index, including in its data-guide information, only after the index is synchronized.
                  </p>
                  <p>In addition, update of data-guide information in a search index is always <span class="italic">additive</span>: none of it is ever deleted. This is another reason that the index often does not accurately reflect the data in its document set: deletions within the documents it applies to are <span class="italic">not</span> reflected in its data-guide information. If you need to ensure that such information accurately reflects the current data then you must drop the JSON search index and create it anew.
                  </p>
                  <p>The persistent data-guide information in a search index can also include <span class="italic">statistics</span>, such as how frequently each JSON field is used in the document set. Statistics are present only if you explicitly gather them on the document set (gather them on the JSON search index, for example). They are not updated automatically — gather statistics anew if you want to be sure they are up to date. <a href="json-dataguide.html#GUID-E77948CB-DCA0-4733-8832-4B5F00C01A2E__EXAMPLE-1410-F572454E">Example 20-3</a> gathers statistics on the JSON data indexed by JSON search index <code class="codeph">po_search_idx</code>, which is created in <a href="indexes-for-json-data.html#GUID-D7A604E1-F617-4C92-A9D9-00B6AB78EFD8__GUID-5DC9D338-2D42-46B1-ADAA-793B6DA0CF3A">Example 26-17</a>.
                  </p>
                  <div class="infoboxnote" id="GUID-E77948CB-DCA0-4733-8832-4B5F00C01A2E__GUID-B13DEF9E-187A-447D-88D9-0B0E8BF0DFAC">
                     <p class="notep1">Note:</p>
                     <p>When a local data guide-enabled JSON search index is created in a <span class="italic">sharding</span> environment, each individual shard contains the data-guide information for the JSON documents stored in that shard. For this reason, if you invoke data guide-related operations on the shard <span class="italic">catalog</span> database then they will have no effect.
                     </p>
                  </div>
                  <div class="section" id="GUID-E77948CB-DCA0-4733-8832-4B5F00C01A2E__CONSIDERATIONSFORADATAGUIDE-ENABLED-0240B3C3">
                     <p class="subhead2" id="GUID-E77948CB-DCA0-4733-8832-4B5F00C01A2E__CONSIDERATIONSFORADATAGUIDE-ENABLED-0240B18B">Considerations for a Data Guide-Enabled Search Index on a Partitioned Table</p>
                     <p>The data-guide information in a data guide-enabled JSON search index that is local to a partitioned table is not partitioned. It is shared among all partitions.</p>
                     <p>Because the data-guide information in the index is only additive, dropping, merging, splitting, or truncating partitions has no impact on the index.</p>
                     <p>Exchanging a partitioned table with a table that is not partitioned updates the data-guide information in an index on the partitioned table, but any data guide-enabled index on the non-partitioned table must be rebuilt.</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-E77948CB-DCA0-4733-8832-4B5F00C01A2E__GUID-751E4723-B916-46CD-86CE-407BC445BFA9">Avoid Persistent Data-Guide Information If Serializing Hash-Table Data</p>
                     <p>If you serialize Java hash tables or associative arrays (such as are found in JavaScript) as JSON objects, then avoid the use of persistent data-guide information. </p>
                     <p>The default hash-table serialization provided by popular libraries such as GSON and Jackson produces textual JSON documents with object field names that are taken from the hash-table key entries and with field values taken from the corresponding Java hash-table values. Serializing a single Java hash-table entry produces a new (unique) JSON field and value.</p>
                     <p>Persisted data-guide information reflects the shape of your data, and it is updated automatically as new JSON documents are inserted. Each hash-table key–value pair results in a separate entry in the JSON search index. Such serialization can thus greatly increase the size of the information maintained in the index. In addition to the large size, the many index updates affect performance negatively, making DML slow.</p>
                     <p>If you serialize a hash table or an associative array instead as a JSON array of objects, each of which includes a field derived from a hash-table key entry, then there are no such problems.</p>
                     <p>The default serialization of a hash table or associative array as a JSON object is indistinguishable from an object that has field names assigned by a developer. A JSON data guide cannot tell which (metadata-like) field names have been assigned by a developer and which (data-like) names might have been derived from a hash table or associative array. It treats all field names as essentially metadata, as if specified by a developer.</p>
                     <p>For example:</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>If you construct an application object using a hash table that has <code class="codeph">animalName</code> as the hash key and sets of animal properties as values then the resulting default serialization is a single JSON object that has a <span class="italic">separate field</span> (<code class="codeph">"cat"</code>, <code class="codeph">"mouse"</code>,...) for each hash-table entry, with the field value being an object with the corresponding animal properties. This can be problematic in terms of data-guide size and performance because of the typically large number of fields (<code class="codeph">"cat"</code>, <code class="codeph">"mouse"</code>,...) derived from the hash key.
                           </p>
                        </li>
                        <li>
                           <p>If you instead construct an application array of <code class="codeph">animal</code> structures, each of which has a field <code class="codeph">animalName</code> (with value <code class="codeph">"cat"</code> or <code class="codeph">"mouse"</code>...) then the resulting serialization is a JSON array of objects, each of which has the same field, <code class="codeph">animalName</code>. The corresponding data guide has no size or performance problem.
                           </p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-E77948CB-DCA0-4733-8832-4B5F00C01A2E__CREATINGAJSONDATAGUIDEWITHOUTSEARCH-E770C3B7">
                     <p class="titleinexample">Example 20-1 Enabling Persistent Support for a JSON Data Guide But Not For Search</p><pre class="pre codeblock"><code>CREATE SEARCH INDEX po_dg_only_idx ON j_purchaseorder (po_document) FOR JSON
  <span class="bold">PARAMETERS ('SEARCH_ON NONE')</span>;</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-E77948CB-DCA0-4733-8832-4B5F00C01A2E__DISABLINGDATAGUIDESUPPORTFORANEXIST-E87466F2">
                     <p class="titleinexample">Example 20-2 Disabling JSON Data-Guide Support For an Existing JSON Search Index</p><pre class="pre codeblock"><code>ALTER INDEX po_search_idx REBUILD <span class="bold">PARAMETERS ('DATAGUIDE OFF')</span>;</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-E77948CB-DCA0-4733-8832-4B5F00C01A2E__EXAMPLE-1410-F572454E">
                     <p class="titleinexample">Example 20-3 Gathering Statistics on JSON Data Using a JSON Search Index</p><pre class="pre codeblock"><code>EXEC DBMS_STATS.<span class="bold">gather_index_stats</span>(docuser, po_search_idx, NULL, 99);</code></pre></div>
                  <!-- class="example" -->
                  <div class="section"></div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="indexes-for-json-data.html#GUID-D7A604E1-F617-4C92-A9D9-00B6AB78EFD8" title="A JSON search index is a general index. It can improve the performance of both (1) ad hoc structural queries, that is, queries that you might not anticipate or use regularly, and (2) full-text search. It is an Oracle Text index that is designed specifically for use with JSON data.">JSON Search Index: Ad Hoc Queries and Full-Text Search</a></li>
                     </ul>
                  </div>
                  <div class="infoboxnotealso" id="GUID-E77948CB-DCA0-4733-8832-4B5F00C01A2E__GUID-50AF1262-73F7-4B57-9DDA-ED6410C70809">
                     <p class="notep1">See Also:</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="../ccref/oracle-text-SQL-statements-and-operators.html#CCREF-GUID-10013D4C-AB6A-44EB-B8B3-AD318EDE33A9" target="_blank"><span><cite>Oracle Text Reference</cite></span></a> for information about the <code class="codeph">PARAMETERS</code> clause for <code class="codeph">CREATE SEARCH INDEX</code></p>
                        </li>
                        <li>
                           <p><a href="../ccref/oracle-text-SQL-statements-and-operators.html#GUID-47E60252-C731-46A8-B587-AE30C1634F48__I996850" target="_blank"><span><cite>Oracle Text Reference</cite></span></a> for information about the <code class="codeph">PARAMETERS</code> clause for <code class="codeph">ALTER INDEX</code> ... <code class="codeph">REBUILD</code></p>
                        </li>
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=fasterxml_jacksonhome" target="_blank">Faster XML / Jackson</a> for information about the Jackson JSON processor
                           </p>
                        </li>
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=gson_java_library" target="_blank">google / gson</a> for information about the GSON Java library
                           </p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="json-dataguide.html#GUID-219FC30E-89A7-4189-BC36-7B961A24067C" title="A JSON data guide lets you discover information about the structure and content of JSON documents stored in Oracle Database.">JSON Data Guide</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-B57975A8-3000-4F21-BB22-DC413F06D6DB" name="GUID-B57975A8-3000-4F21-BB22-DC413F06D6DB"></a><h3 id="ADJSN-GUID-B57975A8-3000-4F21-BB22-DC413F06D6DB" class="sect3"><span class="enumeration_section">20.3 </span>Data-Guide Formats and Ways of Creating a Data Guide
               </h3>
               <div>
                  <p>There are two formats for a data guide: flat and hierarchical. Both are made available to SQL and PL/SQL as <code class="codeph">CLOB</code> data. You can construct a data guide from the data-guide information stored in a JSON search index or by scanning JSON documents.
                  </p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>You can use a <span class="italic">flat</span> data guide to <span class="italic">query</span> data-guide information such as field frequencies and types. 
                        </p>
                        <p>A flat data guide is represented in JSON as an <span class="italic">array</span> of objects, each of which represents the JSON data of a specific <span class="italic">path</span> in the document set. <a href="json-dataguide.html#GUID-12BCFCCE-18AE-4CB2-8710-EC7B712DA089" title="The fields of a sample flat data guide are described. It corresponds to a set of purchase-order documents.">A Flat Data Guide For Purchase-Order Documents</a> describes a flat data guide for the purchase-order data of <a href="json-data.html#GUID-FBC22D72-AA64-4B0A-92A2-837B32902E2C__CACCBBAI">Example 2-1</a>. 
                        </p>
                     </li>
                     <li>
                        <p>You can use a <span class="italic">hierarchical</span> data guide to create a view, or to add virtual columns, using particular fields that you choose on the basis of data-guide information.
                        </p>
                        <p>A hierarchical data guide is represented in JSON as an <span class="italic">object</span> with nested JSON data, in the same format as that defined by JSON Schema (version 4, json-schema-core). <a href="json-dataguide.html#GUID-885E0CB3-9165-448E-96DA-1CC56276F685" title="The fields of a sample hierarchical data guide are described. It corresponds to a set of purchase-order documents.">A Hierarchical Data Guide For Purchase-Order Documents</a> describes a hierarchical data guide for the purchase-order data of <a href="json-data.html#GUID-FBC22D72-AA64-4B0A-92A2-837B32902E2C__CACCBBAI">Example 2-1</a>.
                        </p>
                     </li>
                  </ul>
                  <p>You use PL/SQL function <code class="codeph">DBMS_JSON.<span class="bold">get_index_dataguide</span></code> to obtain a data guide from the data-guide information stored in a JSON search index.
                  </p>
                  <p>You can also use SQL aggregate function <code class="codeph"><span class="bold">json_dataguide</span></code> to scan your document set and construct a data guide for it, whether or not it has a data guide-enabled search index. The data guide accurately reflects the document set at the moment of function invocation. 
                  </p>
                  <div class="tblformal" id="GUID-B57975A8-3000-4F21-BB22-DC413F06D6DB__TABLE-1464-E88A4116">
                     <p class="titleintable">Table 20-1 SQL and PL/SQL Functions to Obtain a Data Guide</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="SQL and PL/SQL Functions to Obtain a Data Guide" border="1" summary="This table shows the SQL and PL/SQL functions you can use to obtain a JSON data guide, flat or hierarchical, and whether or not the functions use a data guide-enabled search index. Column 1 indicates whether an index is used. Column 2 shows the function to use to obtain a flat data guide. Column 3 shows the function to use to obtain a hierarchical data guide." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="20%" id="d23217e789">Uses Data Guide-Enabled Search Index?</th>
                              <th align="left" valign="bottom" width="20%" id="d23217e791">Flat Data Guide</th>
                              <th align="left" valign="bottom" width="20%" id="d23217e793">Hierarchical Data Guide </th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d23217e797" headers="d23217e789 ">Yes</td>
                              <td align="left" valign="top" width="20%" headers="d23217e797 d23217e791 ">PL/SQL function <code class="codeph"><span class="bold">get_index_dataguide</span></code> with format <code class="codeph">DBMS_JSON.<span class="bold">FORMAT_FLAT</span></code></td>
                              <td align="left" valign="top" width="20%" headers="d23217e797 d23217e793 ">PL/SQL function <code class="codeph"><span class="bold">get_index_dataguide</span></code> with format <code class="codeph">DBMS_JSON.<span class="bold">FORMAT_HIERARCHICAL</span></code></td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d23217e820" headers="d23217e789 ">No</td>
                              <td align="left" valign="top" width="20%" headers="d23217e820 d23217e791 ">SQL function <code class="codeph"><span class="bold">json_dataguide</span></code>, with no format argument or with <code class="codeph"><span class="bold">DBMS_JSON.FORMAT_FLAT</span></code> as the format argument
                              </td>
                              <td align="left" valign="top" width="20%" headers="d23217e820 d23217e793 ">SQL function <code class="codeph"><span class="bold">json_dataguide</span></code>, with <code class="codeph"><span class="bold">DBMS_JSON.FORMAT_HIERARCHICAL</span></code> as the format argument
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="p">Advantages of obtaining a data guide based on a data guide-enabled JSON search index include: 
                     <ul style="list-style-type:disc">
                        <li>
                           <p>Additive updates to the document set are automatically reflected in the persisted data-guide information whenever the index is synced.</p>
                        </li>
                        <li>
                           <p>Because this data-guide information is persisted, obtaining a data guide based on it (using PL/SQL function <code class="codeph">get_index_dataguide</code>) is faster than obtaining a data guide by analyzing the document set (using SQL function <code class="codeph">json_dataguide</code>).
                           </p>
                        </li>
                        <li>
                           <p>If you have gathered statistics on the document set then these are included in the stored information and in a data guide obtained from it.</p>
                        </li>
                        <li>
                           <p>Column-name conflicts encountered when creating a view or virtual columns are automatically resolved.</p>
                        </li>
                     </ul>
                  </div>
                  <p>Advantages of obtaining a data guide without using a data guide-enabled JSON search index include assurance that the data guide is accurate and the lack of index maintenance overhead. In addition, a data guide that is not derived from an index is appropriate in some particular use cases:</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>The JSON data is in an external table. You cannot create an index on it.</p>
                     </li>
                     <li>
                        <p>The JSON column could be indexed, but the index would not be very useful. This can be the case, for example, if the column contains different kinds of documents. In this case, it can sometimes be helpful to add a column to the table that identifies the kind of document stored in the JSON column. You can then use the data guide with SQL aggregate functions and <code class="codeph">GROUP BY</code>.  See <a href="json-dataguide.html#GUID-BD147159-87A7-4AAC-B150-44E3F10A81E1" title="A data guide reflects the shape of a given set of JSON documents. If a JSON column contains different types of documents, with different structure or type information, you can create and use different data guides for the different kinds of documents.">Multiple Data Guides Per Document Set</a>.
                        </p>
                     </li>
                  </ul>
                  <div class="section"></div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="json-dataguide.html#GUID-12BCFCCE-18AE-4CB2-8710-EC7B712DA089" title="The fields of a sample flat data guide are described. It corresponds to a set of purchase-order documents.">A Flat Data Guide For Purchase-Order Documents</a></li>
                        <li><a href="json-dataguide.html#GUID-885E0CB3-9165-448E-96DA-1CC56276F685" title="The fields of a sample hierarchical data guide are described. It corresponds to a set of purchase-order documents.">A Hierarchical Data Guide For Purchase-Order Documents</a></li>
                        <li><a href="json-dataguide.html#GUID-E77948CB-DCA0-4733-8832-4B5F00C01A2E" title="JSON data-guide information can be saved persistently as part of the JSON search index infrastructure, and this information is updated automatically as new JSON content is added. This is the case by default, when you create a JSON search index: data-guide information is part of the index infrastructure.">Persistent Data-Guide Information: Part of a JSON Search Index</a></li>
                     </ul>
                  </div>
                  <div class="infoboxnotealso" id="GUID-B57975A8-3000-4F21-BB22-DC413F06D6DB__GUID-F254F36F-D0AD-4D56-8028-1406659AF8DC">
                     <p class="notep1">See Also:</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="../arpls/DBMS_JSON.html#ARPLS-GUID-52B63CEE-669C-46FB-A276-56F7C6ECD036" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> for information about <code class="codeph">DBMS_JSON.get_index_dataguide</code></p>
                        </li>
                        <li>
                           <p><a href="../sqlrf/JSON_DATAGUIDE.html#SQLRF-GUID-4CF32887-0F46-4925-8381-AE2B74343933" target="_blank"><span><cite>Oracle Database SQL Language Reference</cite></span></a> for information about SQL function <code class="codeph">json_dataguide</code></p>
                        </li>
                        <li>
                           <p><a href="../arpls/DBMS_JSON.html#ARPLS-GUID-F9032949-7FE1-4A31-AA4B-4A2775F0CBE6" target="_blank"><span><cite>Oracle Database SQL Language Reference</cite></span></a> for information about PL/SQL constants <code class="codeph">DBMS_JSON.FORMAT_FLAT</code> and <code class="codeph">DBMS_JSON.FORMAT_HIERARCHICAL</code></p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="json-dataguide.html#GUID-219FC30E-89A7-4189-BC36-7B961A24067C" title="A JSON data guide lets you discover information about the structure and content of JSON documents stored in Oracle Database.">JSON Data Guide</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-D8448CB1-0350-4848-B07E-9370B3B1A9BE" name="GUID-D8448CB1-0350-4848-B07E-9370B3B1A9BE"></a><h3 id="ADJSN-GUID-D8448CB1-0350-4848-B07E-9370B3B1A9BE" class="sect3"><span class="enumeration_section">20.4 </span>JSON Data-Guide Fields
               </h3>
               <div>
                  <p>The predefined fields of a JSON data guide are described. They include JSON Schema fields (keywords) and Oracle-specific fields.</p>
                  <div class="section">
                     <p>A given occurrence of a field in a data guide corresponds to a field that is present in one or more JSON documents of the document set.</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-D8448CB1-0350-4848-B07E-9370B3B1A9BE__GUID-74564345-3913-4271-8A7D-6681B29C5190">JSON Schema Fields (Keywords)</p>
                     <p>A JSON Schema is a JSON document that contains a JSON object, which can itself contain child objects (subschemas). Fields that are defined by JSON Schema are called JSON Schema <span class="bold"><strong class="term">keywords</strong></span>. <a href="json-dataguide.html#GUID-D8448CB1-0350-4848-B07E-9370B3B1A9BE__TABLE-1413-EFBCF25B" title="JSON Schema fields used by a JSON data guide are listed in column 1, with their value descriptions in column 2.">Table 20-2</a> describes the keywords that can be used in an Oracle JSON data guide. Keywords <code class="codeph">properties</code>, <code class="codeph">items</code>, and <code class="codeph">oneOf</code> are used only in a hierarchical JSON data guide (which is a JSON schema). Keyword <code class="codeph">type</code> is used in both flat and hierarchical data guides.
                     </p>
                     <div class="tblformal" id="GUID-D8448CB1-0350-4848-B07E-9370B3B1A9BE__TABLE-1413-EFBCF25B">
                        <p class="titleintable">Table 20-2 JSON Schema Fields (Keywords)</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="JSON Schema Fields (Keywords)" border="1" summary="JSON Schema fields used by a JSON data guide are listed in column 1, with their value descriptions in column 2." frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="20%" id="d23217e1093">Field (Keyword)</th>
                                 <th align="left" valign="bottom" width="20%" id="d23217e1095">Value Description</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d23217e1099" headers="d23217e1093 "><code class="codeph">properties</code></td>
                                 <td align="left" valign="top" width="20%" headers="d23217e1099 d23217e1095 ">
                                    <p>An object whose members represent the properties of a JSON object used in JSON data that is represented by the hierarchical data guide (JSON schema).</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d23217e1106" headers="d23217e1093 "><code class="codeph">items</code></td>
                                 <td align="left" valign="top" width="20%" headers="d23217e1106 d23217e1095 ">
                                    <p>An object whose members represent the elements (items) of an array used in JSON data represented by the hierarchical data guide (JSON schema).</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d23217e1113" headers="d23217e1093 "><code class="codeph">oneOf</code></td>
                                 <td align="left" valign="top" width="20%" headers="d23217e1113 d23217e1095 ">
                                    <p>An array, each of whose items represents one or more occurrences of a JSON field in the JSON data represented by the hierarchical data guide (JSON schema).</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d23217e1120" headers="d23217e1093 "><code class="codeph">type</code></td>
                                 <td align="left" valign="top" width="20%" headers="d23217e1120 d23217e1095 ">
                                    <p>A string naming the type of some JSON data represented by the (flat or hierarchical) data guide.</p>
                                    <p>The possible values are: <code class="codeph">"number"</code>, <code class="codeph">"string"</code>, <code class="codeph">"boolean"</code>, <code class="codeph">"null"</code>, <code class="codeph">"object"</code>, <code class="codeph">"array"</code>, and <code class="codeph">"GeoJSON"</code>.
                                    </p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-D8448CB1-0350-4848-B07E-9370B3B1A9BE__JSONDATAGUIDEFIELDS-EFBFC9C4">Oracle-Specific JSON Data-Guide Fields</p>
                     <p>In addition to JSON Schema keywords, a JSON data guide can contain Oracle data guide-specific fields. The field names all have the prefix <span class="bold"><code class="codeph">o:</code></span>. They are described in <a href="json-dataguide.html#GUID-D8448CB1-0350-4848-B07E-9370B3B1A9BE__TABLE-1423-EFC0120F" title="Oracle—specific fields used by a JSON data guide are listed in column 1, with their value descriptions in column 2.">Table 20-3</a>.
                     </p>
                     <div class="tblformal" id="GUID-D8448CB1-0350-4848-B07E-9370B3B1A9BE__TABLE-1423-EFC0120F">
                        <p class="titleintable">Table 20-3 Oracle-Specific Data-Guide Fields</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="Oracle-Specific Data-Guide Fields" border="1" summary="Oracle—specific fields used by a JSON data guide are listed in column 1, with their value descriptions in column 2." frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="20%" id="d23217e1174">Field</th>
                                 <th align="left" valign="bottom" width="20%" id="d23217e1176">Value Description</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d23217e1180" headers="d23217e1174 "><code class="codeph">o:path</code></td>
                                 <td align="left" valign="top" width="20%" headers="d23217e1180 d23217e1176 ">
                                    <p>Path through the JSON documents to the JSON field. Used only in a <span class="italic">flat</span> data guide. The value is a simple SQL/JSON path expression (no filter expression), possibly with relaxation (implicit array wrapping and unwrapping), and possibly with a wildcard array step. It has no array steps with array indexes or range specifications, and it has no function step. See <a href="json-path-expressions.html#GUID-7B610884-39CD-4910-85E7-C251D342D879" title="SQL/JSON path expressions are matched by SQL/JSON functions and conditions against JSON data, to select portions of it. Path expressions can use wildcards and array ranges. Matching is case-sensitive.">SQL/JSON Path Expression Syntax</a>.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d23217e1196" headers="d23217e1174 "><code class="codeph">o:length</code></td>
                                 <td align="left" valign="top" width="20%" headers="d23217e1196 d23217e1176 ">
                                    <p>Maximum length of the JSON field value, in bytes.  The value is always a power of two. For example, if the maximum length of all actual field values is 5 then the value of <code class="codeph">o:length</code> is 8, the smallest power of two greater than or equal to 5.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d23217e1206" headers="d23217e1174 "><code class="codeph">o:preferred_column_name</code></td>
                                 <td align="left" valign="top" width="20%" headers="d23217e1206 d23217e1176 ">
                                    <p>An identifier, case-sensitive and unique to a given data guide, that you prefer as the name to use for a view column or a virtual column that is created using the data guide. </p>
                                    <p>This field is absent if the data guide was obtained using SQL function <code class="codeph">json_dataguide</code> with format parameter <code class="codeph">DBMS_JSON.FORMAT_FLAT</code> or without any format parameter (<code class="codeph">DBMS_JSON.FORMAT_FLAT</code> is the default). 
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d23217e1224" headers="d23217e1174 "><code class="codeph">o:frequency</code></td>
                                 <td align="left" valign="top" width="20%" headers="d23217e1224 d23217e1176 ">
                                    <p>Percentage of JSON documents that contain the given field. Duplicate occurrences of a field under the same array are ignored. (Available only if statistics were gathered on the document set.)</p>
                                    <p>This field is absent if the data guide was obtained using SQL function <code class="codeph">json_dataguide</code>. 
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d23217e1236" headers="d23217e1174 "><code class="codeph">o:num_nulls</code></td>
                                 <td align="left" valign="top" width="20%" headers="d23217e1236 d23217e1176 ">
                                    <p>Number of documents whose value for the targeted scalar field is JSON <code class="codeph">null</code>. (Available only if statistics were gathered on the document set.)
                                    </p>
                                    <p>This field is absent if the data guide was obtained using SQL function <code class="codeph">json_dataguide</code>. 
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d23217e1251" headers="d23217e1174 "><code class="codeph">o:high_value</code></td>
                                 <td align="left" valign="top" width="20%" headers="d23217e1251 d23217e1176 ">
                                    <p>Highest value for the targeted scalar field, among all documents. (Available only if statistics were gathered on the document set.)</p>
                                    <p>This field is absent if the data guide was obtained using SQL function <code class="codeph">json_dataguide</code>. 
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d23217e1263" headers="d23217e1174 "><code class="codeph">o:low_value</code></td>
                                 <td align="left" valign="top" width="20%" headers="d23217e1263 d23217e1176 ">
                                    <p>Lowest value for the targeted scalar field, among all documents. (Available only if statistics were gathered on the document set.)</p>
                                    <p>This field is absent if the data guide was obtained using SQL function <code class="codeph">json_dataguide</code>. 
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d23217e1275" headers="d23217e1174 "><code class="codeph">o:last_analyzed</code></td>
                                 <td align="left" valign="top" width="20%" headers="d23217e1275 d23217e1176 ">
                                    <p>Date and time when statistics were last gathered on the document set. (Available only if statistics were gathered on the document set.)</p>
                                    <p>This field is absent if the data guide was obtained using SQL function <code class="codeph">json_dataguide</code>. 
                                    </p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p>The data-guide information for documents that contain a JSON array with <span class="italic">only scalar</span> elements records the path and type for both (1) the array and (2) all of the array elements taken together. For the <span class="italic">elements</span>: 
                     </p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>The <code class="codeph">o:path</code> value is the <code class="codeph">o:path</code> value for the array, followed by an array with a wildcard (<code class="codeph">[*]</code>), which indicates all array elements.
                           </p>
                        </li>
                        <li>
                           <p>The <code class="codeph">type</code> value is the type <code class="codeph">string</code>, if the scalar types are <span class="italic">not the same</span> for all elements in all documents.  If <span class="italic">all</span> of the scalar elements the array have the <span class="italic">same</span> type, across <span class="italic">all</span> documents, then that type is recorded.
                           </p>
                        </li>
                     </ul>
                     <p>For example, if, in <span class="italic">all</span> documents, <span class="italic">all</span> of the elements in the array value for object field <code class="codeph">serial_numbers</code> are JSON numbers, then <code class="codeph">type</code> for the array elements is <code class="codeph">number</code>. Otherwise it is <code class="codeph">string</code>.
                     </p>
                     <p>When present, the default value of field <code class="codeph">o:preferred_column_name</code> depends on whether the data guide was obtained using SQL function <code class="codeph">json_dataguide</code> (with format <code class="codeph">DBMS_JSON.FORMAT_HIERARCHICAL</code>) or using PL/SQL function <code class="codeph">DBMS_JSON.get_index_dataguide</code>:
                     </p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">json_dataguide</code> (hierarchical format) — Same as the corresponding JSON field name.
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">get_index_dataguide</code> — Same as the corresponding JSON field name, prefixed with the JSON column name followed by <span class="bold"><code class="codeph">$</code></span>, and with any non-ASCII characters removed. If the resulting field name already exists in the same data guide then it is suffixed with a new sequence number, to make it unique.
                           </p>
                           <p>The column name is uppercase unless the column was defined using escaped lowercase letters (for example, <code class="codeph">'PO_Column'</code> instead of <code class="codeph">po_column</code>). 
                           </p>
                           <p>For example, the default value for field <code class="codeph">User</code> for data in JSON column <code class="codeph">po_document</code> is <code class="codeph"><span class="bold">PO_DOCUMENT$</span>User</code>.
                           </p>
                        </li>
                     </ul>
                     <p>You can use PL/SQL procedure <code class="codeph">DBMS_JSON.rename_column</code> to set the value of <code class="codeph">o:preferred_column_name</code> for a given field and type. 
                     </p>
                     <p>Field <code class="codeph">o:preferred_column_name</code> is used to name a new, virtual column in the table that contains the JSON column, or it is used to name a column in a new view that also contains the other columns of the table. In either case, the name specified by <code class="codeph">o:preferred_column_name</code> must be <span class="italic">unique</span> with respect to the other column names of the table. In addition, the name must be <span class="italic">unique</span> across all JSON fields of any type in the document set. When you use <code class="codeph">DBMS_JSON.get_index_dataguide</code>, the default name is <span class="italic">guaranteed</span> to be unique in these ways.
                     </p>
                     <p>If the name you specify with <code class="codeph">DBMS_JSON.rename_column</code> causes a name conflict then the specified name is ignored and a system-generated name is used instead.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section"></div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="json-dataguide.html#GUID-A0AFD360-93A7-4566-8315-6F68D9AE090B" title="You can project JSON fields from your data as columns in a database view or as virtual columns added to the same table that contains the JSON column. You can specify a preferred name for such a column.">Specifying a Preferred Name for a Field Column</a></li>
                        <li><a href="json-dataguide.html#GUID-12BCFCCE-18AE-4CB2-8710-EC7B712DA089" title="The fields of a sample flat data guide are described. It corresponds to a set of purchase-order documents.">A Flat Data Guide For Purchase-Order Documents</a></li>
                        <li><a href="json-dataguide.html#GUID-885E0CB3-9165-448E-96DA-1CC56276F685" title="The fields of a sample hierarchical data guide are described. It corresponds to a set of purchase-order documents.">A Hierarchical Data Guide For Purchase-Order Documents</a></li>
                        <li><a href="using-GeoJSON-geographic-data.html#GUID-2AD827B4-871E-4652-87F3-AC33FE7839AE" title="GeoJSON objects are JSON objects that represent geographic data. Examples are provided of creating GeoJSON data, indexing it, and querying it.">Using GeoJSON Geographic Data</a></li>
                     </ul>
                  </div>
                  <div class="infoboxnotealso" id="GUID-D8448CB1-0350-4848-B07E-9370B3B1A9BE__GUID-CA8E246C-90F8-4331-B553-4D8BD17BC7A4">
                     <p class="notep1">See Also:</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="../arpls/DBMS_JSON.html#ARPLS-GUID-52B63CEE-669C-46FB-A276-56F7C6ECD036" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> for information about <code class="codeph">DBMS_JSON.get_index_dataguide</code></p>
                        </li>
                        <li>
                           <p><a href="../arpls/DBMS_JSON.html#ARPLS-GUID-0E802354-4508-4DF7-A07A-6999F3337CA5" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a>  for information about <code class="codeph">DBMS_JSON.rename_column</code></p>
                        </li>
                        <li>
                           <p><a href="../sqlrf/JSON_DATAGUIDE.html#SQLRF-GUID-4CF32887-0F46-4925-8381-AE2B74343933" target="_blank"><span><cite>Oracle Database SQL Language Reference</cite></span></a> for information about SQL function <code class="codeph">json_dataguide</code></p>
                        </li>
                        <li>
                           <p><a href="../spatl/spatial-concepts.html#SPATL-GUID-D703DF4D-57D1-4990-8F53-CAAA9C8FCB2F" target="_blank"><span><cite>Oracle Spatial and Graph Developer's Guide</cite></span></a> for information about using GeoJSON data with Oracle Spatial and Graph 
                           </p>
                        </li>
                        <li>
                           <p><a href="../spatl/spatial-concepts.html#SPATL-GUID-67E4037F-C40F-442A-8662-837DD5539784" target="_blank"><span><cite>Oracle Spatial and Graph Developer's Guide</cite></span></a> for information about Oracle Spatial and Graph and <code class="codeph">SDO_GEOMETRY</code> object type
                           </p>
                        </li>
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=geojson_org" target="_blank">GeoJSON.org</a> for information about GeoJSON
                           </p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="json-dataguide.html#GUID-219FC30E-89A7-4189-BC36-7B961A24067C" title="A JSON data guide lets you discover information about the structure and content of JSON documents stored in Oracle Database.">JSON Data Guide</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-70D47F29-BA01-4908-A5C1-8EB10AAB89A0" name="GUID-70D47F29-BA01-4908-A5C1-8EB10AAB89A0"></a><h3 id="ADJSN-GUID-70D47F29-BA01-4908-A5C1-8EB10AAB89A0" class="sect3"><span class="enumeration_section">20.5 </span>Data-Dictionary Views For Persistent Data-Guide Information
               </h3>
               <div>
                  <p>You can query static data-dictionary views to see which tables have JSON columns with data guide-enabled JSON search indexes and to extract JSON object field information that is recorded in dataguide-enabled JSON search indexes.</p>
                  <p>Tables that do not have JSON columns with data guide-enabled indexes are not present in the views.</p>
                  <p>You can use the following views to <span class="italic">find columns</span> that have data guide-enabled JSON search indexes. The views have columns <code class="codeph">TABLE_NAME</code> (the table name), <code class="codeph">COLUMN_NAME</code> (the JSON column name), and <code class="codeph">DATAGUIDE</code> (a data guide). 
                  </p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><code class="codeph">USER_JSON_<span class="bold">DATAGUIDES</span></code> — tables owned by the current user
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">ALL_JSON_<span class="bold">DATAGUIDES</span></code> — tables accessible by the current user
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">DBA_JSON_<span class="bold">DATAGUIDES</span></code> — all tables
                        </p>
                     </li>
                  </ul>
                  <p>If the JSON column has a data guide-enabled JSON search index then the value of column <code class="codeph">DATAGUIDE</code> is the data guide for the JSON column, in flat format as a <code class="codeph">CLOB</code> instance. If it does not have a data guide-enabled index then there is no row for that column in the view.
                  </p>
                  <div class="p">You can use the following views to extract JSON field path and type information that is recorded in dataguide-enabled JSON search indexes. The views have columns <code class="codeph">TABLE_NAME</code>, <code class="codeph">COLUMN_NAME</code>, <code class="codeph">PATH</code>, <code class="codeph">TYPE</code>, and <code class="codeph">LENGTH</code>. Columns <code class="codeph">PATH</code>, <code class="codeph">TYPE</code>, and <code class="codeph">LENGTH</code> correspond to the values of data-guide fields <code class="codeph">o:path</code>, <code class="codeph">o:type</code>, and <code class="codeph">o:length</code>, respectively.
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">USER_JSON_DATAGUIDE_<span class="bold">FIELDS</span></code> — tables owned by the current user
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">ALL_JSON_DATAGUIDE_<span class="bold">FIELDS</span></code> — tables accessible by the current user
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">DBA_JSON_DATAGUIDE_<span class="bold">FIELDS</span></code> — all tables
                           </p>
                        </li>
                     </ul>
                  </div>
                  <p>In the case of both types of view, a view whose name has the prefix <code class="codeph">ALL_</code> or <code class="codeph">DBA_</code> also has column <code class="codeph">OWNER</code>, whose value is the table owner.
                  </p>
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-70D47F29-BA01-4908-A5C1-8EB10AAB89A0__GUID-8DAC6E24-37C6-4416-8915-1A638FA9EE33">
                     <p class="notep1">See Also:</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="../refrn/ALL_JSON_DATAGUIDES.html#REFRN-GUID-36B8E1C7-614E-4085-B75F-57875795890A" target="_blank"><span><cite>Oracle Database Reference</cite></span></a> for information about <code class="codeph">ALL_JSON_DATAGUIDES</code> and the related data-dictionary views
                           </p>
                        </li>
                        <li>
                           <p><a href="../refrn/ALL_JSON_DATAGUIDE_FIELDS.html#REFRN-GUID-7DF39B7B-ED39-4DAD-960F-E604A8340C06" target="_blank"><span><cite>Oracle Database Reference</cite></span></a> for information about <code class="codeph">ALL_JSON_DATAGUIDE_FIELDS</code> and the related data-dictionary views
                           </p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="json-dataguide.html#GUID-219FC30E-89A7-4189-BC36-7B961A24067C" title="A JSON data guide lets you discover information about the structure and content of JSON documents stored in Oracle Database.">JSON Data Guide</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-A0AFD360-93A7-4566-8315-6F68D9AE090B" name="GUID-A0AFD360-93A7-4566-8315-6F68D9AE090B"></a><h3 id="ADJSN-GUID-A0AFD360-93A7-4566-8315-6F68D9AE090B" class="sect3"><span class="enumeration_section">20.6 </span>Specifying a Preferred Name for a Field Column
               </h3>
               <div>
                  <p>You can project JSON fields from your data as columns in a database view or as virtual columns added to the same table that contains the JSON column. You can specify a preferred name for such a column.</p>
                  <div class="section">
                     <p>A data guide obtained from the same document set is used to define this projection. The name of each projected column is taken from data-guide field <code class="codeph">o:preferred_column_name</code> for the JSON data field to be projected. Specifying your preferred name changes the value of this data-guide field. 
                     </p>
                     <p>If your JSON data has a data guide-enabled search index then you can use procedure <code class="codeph">DBMS_JSON.rename_column</code> to specify your preferred name for the column projected from a given field. <a href="json-dataguide.html#GUID-A0AFD360-93A7-4566-8315-6F68D9AE090B__GUID-9EE57EFD-D53A-46EE-9DEF-A4E8FC7D9FB1">Example 20-4</a> illustrates this. It specifies preferred names for the columns to be projected from various fields, as described in <a href="json-dataguide.html#GUID-A0AFD360-93A7-4566-8315-6F68D9AE090B__TABLE-1442-F4DC8EFF" title="This three-column table shows the preferred column names for some fields of JSON purchase-order documents and their types. Column 1 shows the field name. Column 2 shows the JSON type of the field. Column 3 shows the preferred column name.">Table 20-4</a>. (The fields are projected as columns when you use procedure <code class="codeph">DBMS_JSON.create_view</code>, <code class="codeph">DBMS_JSON.create_view_on_path</code>, or <code class="codeph">DBMS_JSON.add_virtual_columns</code>.)
                     </p> 
                     <div class="tblformalwide" id="GUID-A0AFD360-93A7-4566-8315-6F68D9AE090B__TABLE-1442-F4DC8EFF">
                        <p class="titleintable">Table 20-4 Preferred Names for Some JSON Field Columns</p>
                        <table cellpadding="4" cellspacing="0" class="FormalWide" title="Preferred Names for Some JSON Field Columns" width="100%" border="1" summary="This three-column table shows the preferred column names for some fields of JSON purchase-order documents and their types. Column 1 shows the field name. Column 2 shows the JSON type of the field. Column 3 shows the preferred column name." frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="20%" id="d23217e1809">Field</th>
                                 <th align="left" valign="bottom" width="20%" id="d23217e1811">JSON Type</th>
                                 <th align="left" valign="bottom" width="20%" id="d23217e1813">Preferred Column Name</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d23217e1817" headers="d23217e1809 "><code class="codeph">PONumber</code></td>
                                 <td align="left" valign="top" width="20%" headers="d23217e1817 d23217e1811 "><code class="codeph">number</code></td>
                                 <td align="left" valign="top" width="20%" headers="d23217e1817 d23217e1813 "><code class="codeph"><span class="bold">PONumber</span></code></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d23217e1828" headers="d23217e1809 "><code class="codeph">Phone</code> (phone as string, not object – just the number)
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d23217e1828 d23217e1811 "><code class="codeph">string</code></td>
                                 <td align="left" valign="top" width="20%" headers="d23217e1828 d23217e1813 "><code class="codeph"><span class="bold">Phone</span></code></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d23217e1840" headers="d23217e1809 "><code class="codeph">type</code> (phone type)
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d23217e1840 d23217e1811 "><code class="codeph">string</code></td>
                                 <td align="left" valign="top" width="20%" headers="d23217e1840 d23217e1813 "><code class="codeph"><span class="bold">PhoneType</span></code></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d23217e1852" headers="d23217e1809 "><code class="codeph">number</code> (phone number)
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d23217e1852 d23217e1811 "><code class="codeph">string</code></td>
                                 <td align="left" valign="top" width="20%" headers="d23217e1852 d23217e1813 "><code class="codeph"><span class="bold">PhoneNumber</span></code></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d23217e1864" headers="d23217e1809 "><code class="codeph">ItemNumber</code> (line-item number)
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d23217e1864 d23217e1811 "><code class="codeph">number</code></td>
                                 <td align="left" valign="top" width="20%" headers="d23217e1864 d23217e1813 "><code class="codeph"><span class="bold">ItemNumber</span></code></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d23217e1876" headers="d23217e1809 "><code class="codeph">Description</code> (part description)
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d23217e1876 d23217e1811 "><code class="codeph">string</code></td>
                                 <td align="left" valign="top" width="20%" headers="d23217e1876 d23217e1813 "><code class="codeph"><span class="bold">PartDescription</span></code></td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <div class="infoboxnotealso" id="GUID-A0AFD360-93A7-4566-8315-6F68D9AE090B__GUID-F00A5D09-CADA-4EF6-A978-A04620E79629">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="json-dataguide.html#GUID-D8448CB1-0350-4848-B07E-9370B3B1A9BE" title="The predefined fields of a JSON data guide are described. They include JSON Schema fields (keywords) and Oracle-specific fields.">JSON Data-Guide Fields</a> for information about the default value of field <code class="codeph">o:preferred_column_name</code> and the possibility of name conflicts when you use <code class="codeph">DBMS_JSON.rename_column</code></p>
                           </li>
                           <li>
                              <p><a href="creating-a-table-with-a-json-column.html#GUID-E6CC0DCF-3D72-41EF-ACA4-B3BF54EE3CA0" title="You can create a table that has JSON columns. You use SQL condition is json as a check constraint to ensure that data inserted into a column is (well-formed) JSON data. Oracle recommends that you always use an is_json check constraint when you create a column intended for JSON data.">Creating a Table With a JSON Column</a> for information about the JSON data referenced here
                              </p>
                           </li>
                           <li>
                              <p><a href="../arpls/DBMS_JSON.html#ARPLS-GUID-9A634A69-6F96-43E2-9A44-80FD21E262C1" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> for information about <code class="codeph">DBMS_JSON.create_view</code></p>
                           </li>
                           <li>
                              <p><a href="../arpls/DBMS_JSON.html#ARPLS-GUID-F6FCD886-191D-4F2E-8767-62CFDC762FC1" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a>  for information about <code class="codeph">DBMS_JSON.create_view_on_path</code></p>
                           </li>
                           <li>
                              <p><a href="../arpls/DBMS_JSON.html#ARPLS-GUID-0E802354-4508-4DF7-A07A-6999F3337CA5" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a>  for information about <code class="codeph">DBMS_JSON.rename_column</code></p>
                           </li>
                           <li>
                              <p><a href="../arpls/DBMS_JSON.html#ARPLS-GUID-69DD0940-58EA-48D8-A635-097A6BA7A31B" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a>for information about <code class="codeph">DBMS_JSON.add_virtual_columns</code></p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-A0AFD360-93A7-4566-8315-6F68D9AE090B__GUID-9EE57EFD-D53A-46EE-9DEF-A4E8FC7D9FB1">
                     <p class="titleinexample">Example 20-4 Specifying Preferred Column Names For Some JSON Fields</p><pre class="pre codeblock"><code>BEGIN
  DBMS_JSON.rename_column(
    'J_PURCHASEORDER', 'PO_DOCUMENT', '$.PONumber',
    DBMS_JSON.TYPE_NUMBER, '<span class="bold">PONumber</span>');
  DBMS_JSON.rename_column(
    'J_PURCHASEORDER', 'PO_DOCUMENT', '$.ShippingInstructions.Phone',
    DBMS_JSON.TYPE_STRING, '<span class="bold">Phone</span>');
  DBMS_JSON.rename_column(
    'J_PURCHASEORDER', 'PO_DOCUMENT', '$.ShippingInstructions.Phone.type',
    DBMS_JSON.TYPE_STRING, '<span class="bold">PhoneType</span>');
  DBMS_JSON.rename_column(
    'J_PURCHASEORDER', 'PO_DOCUMENT', '$.ShippingInstructions.Phone.number',
    DBMS_JSON.TYPE_STRING, '<span class="bold">PhoneNumber</span>');
  DBMS_JSON.rename_column(
    'J_PURCHASEORDER', 'PO_DOCUMENT', '$.LineItems.ItemNumber',
    DBMS_JSON.TYPE_NUMBER, '<span class="bold">ItemNumber</span>');
  DBMS_JSON.rename_column(
    'J_PURCHASEORDER', 'PO_DOCUMENT', '$.LineItems.Part.Description',
    DBMS_JSON.TYPE_STRING, '<span class="bold">PartDescription</span>');
END;
/</code></pre></div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="json-dataguide.html#GUID-219FC30E-89A7-4189-BC36-7B961A24067C" title="A JSON data guide lets you discover information about the structure and content of JSON documents stored in Oracle Database.">JSON Data Guide</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-394009D2-F829-49B0-B6EF-DB24606FEF75" name="GUID-394009D2-F829-49B0-B6EF-DB24606FEF75"></a><h3 id="ADJSN-GUID-394009D2-F829-49B0-B6EF-DB24606FEF75" class="sect3"><span class="enumeration_section">20.7 </span>Creating a View Over JSON Data Based on Data-Guide Information
               </h3>
               <div>
                  <p>Based on data-guide information, you can create a database view whose columns project particular scalar fields present in a set of JSON documents. You can choose the fields to project by editing a hierarchical data guide or by specifying a SQL/JSON path expression and a minimum frequency of field occurrence.</p>
                  <div class="section">
                     <p>(You can create multiple views based on the same JSON document set, projecting different fields. See <a href="json-dataguide.html#GUID-BD147159-87A7-4AAC-B150-44E3F10A81E1" title="A data guide reflects the shape of a given set of JSON documents. If a JSON column contains different types of documents, with different structure or type information, you can create and use different data guides for the different kinds of documents.">Multiple Data Guides Per Document Set</a>.)
                     </p>
                     <p>You can create a view by projecting JSON fields using SQL/JSON function <code class="codeph">json_table</code> — see <a href="function-JSON_TABLE.html#GUID-BFA1FB9A-0F18-4ED2-B504-6855DC6705B5" title="To improve query performance you can create a view over JSON data that you project to columns using SQL/JSON function json_table. To further improve query performance you can create a materialized view and place the JSON data in memory.">Creating a View Over JSON Data Using JSON_TABLE</a>. An alternative is to use PL/SQL procedure <code class="codeph">DBMS_JSON.create_view</code> or <code class="codeph">DBMS_JSON.create_view_on_path</code> to create a view by projecting fields that you choose based on available data-guide information. 
                     </p>
                     <p>This information can come from either a hierarchical data guide that includes only the fields to project or from a data guide-enabled JSON search index together with a SQL/JSON path expression and a minimum field frequency.</p>
                     <p>In the former case, use procedure <code class="codeph">create_view</code>. You can edit a (hierarchical) data guide to specify the fields you want. In this case you do <span class="italic">not</span> need a data guide-enabled search index.
                     </p>
                     <p>In the latter case, use procedure <code class="codeph">create_view_on_path</code>. In this case you need a data guide-enabled search index, but you do not need a data guide. You provide a SQL/JSON path expression and possibly a minimum frequency of occurrence. The fields in the document set that are projected include both:
                     </p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>All scalar fields that are not under an array.</p>
                        </li>
                        <li>
                           <p>All scalar fields present, at any level, in the data that is targeted by a given SQL/JSON path expression.</p>
                        </li>
                     </ul>
                     <p>Regardless of which way you create the view, in addition to the JSON fields that are projected as columns, the non-JSON columns of the table are also columns of the view.</p>
                     <p>If you use procedure <code class="codeph">create_view_on_path</code> then the <span class="italic"><code class="codeph">PATH</code></span> argument you provide must be a simple SQL/JSON path expression (no filter expression), possibly with relaxation (implicit array wrapping and unwrapping), but with no array steps and no function step. See <a href="json-path-expressions.html#GUID-7B610884-39CD-4910-85E7-C251D342D879" title="SQL/JSON path expressions are matched by SQL/JSON functions and conditions against JSON data, to select portions of it. Path expressions can use wildcards and array ranges. Matching is case-sensitive.">SQL/JSON Path Expression Syntax</a>.
                     </p>
                     <p>However it is created, the data guide that serves as the basis for a given view definition is static and does not necessarily faithfully reflect the current data in the document set. The fields that are projected for the view are determined when the view is created. </p>
                     <p>In particular, if you use <code class="codeph">create_view_on_path</code> (which requires a data guide-enabled search index) then what counts are the fields specified by the given path expression and that have at least the given frequency, based on the <span class="italic">index data at the time of the view creation</span>.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section"></div>
                  <!-- class="section" -->
                  <div class="section"></div>
                  <!-- class="section" -->
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="json-dataguide.html#GUID-90EC7EB8-7D45-4CB7-B16E-97BA3427D35F">Creating a View Over JSON Data Based on a Hierarchical Data Guide</a><br>You can use a hierarchical data guide to create a database view whose columns project specified JSON fields from your documents. The fields projected are those in the data guide. You can edit the data guide to include only the fields that you want to project.
                     </li>
                     <li class="ulchildlink"><a href="json-dataguide.html#GUID-B6A1D87D-9EE8-47F0-8325-96A366254488">Creating a View Over JSON Data Based on a Path Expression</a><br>You can use the information in a data guide-enabled JSON search index to create a database view whose columns project JSON fields from your documents. The fields projected are the scalar fields not under an array plus the scalar fields in the data targeted by a specified SQL/JSON path expression.
                     </li>
                  </ul>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="function-JSON_TABLE.html#GUID-BFA1FB9A-0F18-4ED2-B504-6855DC6705B5" title="To improve query performance you can create a view over JSON data that you project to columns using SQL/JSON function json_table. To further improve query performance you can create a materialized view and place the JSON data in memory.">Creating a View Over JSON Data Using JSON_TABLE</a></li>
                     </ul>
                  </div>
                  <div class="infoboxnotealso" id="GUID-394009D2-F829-49B0-B6EF-DB24606FEF75__GUID-1F2347AF-EA79-4376-B8B5-FA492325A29A">
                     <p class="notep1">See Also:</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="../arpls/DBMS_JSON.html#ARPLS-GUID-9A634A69-6F96-43E2-9A44-80FD21E262C1" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> for information about <code class="codeph">DBMS_JSON.create_view</code></p>
                        </li>
                        <li>
                           <p><a href="../arpls/DBMS_JSON.html#ARPLS-GUID-F6FCD886-191D-4F2E-8767-62CFDC762FC1" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a>  for information about <code class="codeph">DBMS_JSON.create_view_on_path</code></p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="json-dataguide.html#GUID-219FC30E-89A7-4189-BC36-7B961A24067C" title="A JSON data guide lets you discover information about the structure and content of JSON documents stored in Oracle Database.">JSON Data Guide</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="sect3"><a id="GUID-90EC7EB8-7D45-4CB7-B16E-97BA3427D35F" name="GUID-90EC7EB8-7D45-4CB7-B16E-97BA3427D35F"></a><h4 id="ADJSN-GUID-90EC7EB8-7D45-4CB7-B16E-97BA3427D35F" class="sect4"><span class="enumeration_section">20.7.1 </span>Creating a View Over JSON Data Based on a Hierarchical Data Guide
                  </h4>
                  <div>
                     <p>You can use a hierarchical data guide to create a database view whose columns project specified JSON fields from your documents. The fields projected are those in the data guide. You can edit the data guide to include only the fields that you want to project.</p>
                     <div class="section">
                        <p>You can obtain a hierarchical data guide using either PL/SQL function <code class="codeph">DBMS_JSON.get_index_dataguide</code> or SQL function <code class="codeph">json_dataguide</code> with argument <code class="codeph">DBMS_JSON.FORMAT_HIERARCHICAL</code>. In the former case a data guide-enabled JSON search index must be defined on the column of JSON data.
                        </p>
                        <p>You can edit the data guide obtained to include only specific fields, change the length of given types, or rename fields. The resulting data guide specifies which fields of the JSON data to project as columns of the view.</p>
                        <p>You use PL/SQL procedure <code class="codeph">DBMS_JSON.create_view</code> to create the view.
                        </p>
                        <p><a href="json-dataguide.html#GUID-90EC7EB8-7D45-4CB7-B16E-97BA3427D35F__CREATINGAVIEWUSINGAHIERARCHICALDATA-F645E6C8">Example 20-5</a> illustrates this using a data guide obtained with <code class="codeph">DBMS_JSON.get_index_dataguide</code>. <a href="json-dataguide.html#GUID-90EC7EB8-7D45-4CB7-B16E-97BA3427D35F__GUID-5179B888-D665-4D40-A117-6A0B2FD81532">Example 20-6</a> illustrates it using a data guide obtained with <code class="codeph">json_dataguide</code> with argument <code class="codeph">DBMS_JSON.FORMAT_HIERARCHICAL</code>.
                        </p>
                        <p>If you create a view using the data guide obtained with <code class="codeph">json_dataguide</code> then GeoJSON data in your documents is supported. In this case the view column corresponding to the GeoJSON data has SQL data type <code class="codeph">SDO_GEOMETRY</code>. For that you pass constant <code class="codeph">DBMS_JSON.GEOJSON</code> or <code class="codeph">DBMS_JSON.GEOJSON+DBMS_JSON.PRETTY</code> as the third argument to <code class="codeph">json_dataguide</code>.
                        </p>
                        <div class="infoboxnotealso" id="GUID-90EC7EB8-7D45-4CB7-B16E-97BA3427D35F__GUID-D7A0456F-8DA3-45E5-B161-BE3021A0A9E5">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><a href="../arpls/DBMS_JSON.html#ARPLS-GUID-9A634A69-6F96-43E2-9A44-80FD21E262C1" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> for information about <code class="codeph">DBMS_JSON.create_view</code></p>
                              </li>
                              <li>
                                 <p><a href="../arpls/DBMS_JSON.html#ARPLS-GUID-52B63CEE-669C-46FB-A276-56F7C6ECD036" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> for information about <code class="codeph">DBMS_JSON.get_index_dataguide</code></p>
                              </li>
                              <li>
                                 <p><a href="../arpls/DBMS_JSON.html#ARPLS-GUID-0E802354-4508-4DF7-A07A-6999F3337CA5" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a>  for information about <code class="codeph">DBMS_JSON.rename_column</code></p>
                              </li>
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=SQLRF-GUID-4CF32887-0F46-4925-8381-AE2B74343933" target="_blank"><span><cite>Oracle Database SQL Language Reference</cite></span></a> for information about SQL function <code class="codeph">json_dataguide</code></p>
                              </li>
                              <li>
                                 <p><a href="../arpls/DBMS_JSON.html#ARPLS-GUID-F9032949-7FE1-4A31-AA4B-4A2775F0CBE6" target="_blank"><span><cite>Oracle Database SQL Language Reference</cite></span></a> for information about PL/SQL constant <code class="codeph">DBMS_JSON.FORMAT_HIERARCHICAL</code></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-90EC7EB8-7D45-4CB7-B16E-97BA3427D35F__CREATINGAVIEWUSINGAHIERARCHICALDATA-F645E6C8">
                        <p class="titleinexample">Example 20-5 Creating a View Using a Hierarchical Data Guide Obtained With GET_INDEX_DATAGUIDE</p>
                        <p>This example creates a view that projects all of the fields present in the hierarchical data guide that is obtained from the data guide-enabled JSON search index on JSON column <code class="codeph">po_document</code> of table <code class="codeph">j_purchaseorder</code>. (Columns whose names are <span class="italic"><code class="codeph">italic</code></span> in the <code class="codeph">describe</code> command output are those that have been renamed using PL/SQL procedure <code class="codeph">DBMS_JSON.rename_column</code>.)
                        </p><pre class="pre codeblock"><code>EXEC DBMS_JSON.create_view(
       'VIEW1',
       'J_PURCHASEORDER',
       'PO_DOCUMENT',
       DBMS_JSON.<span class="bold">get_index_dataguide</span>('J_PURCHASEORDER',
                                     'PO_DOCUMENT',
                                     DBMS_JSON.<span class="bold">FORMAT_HIERARCHICAL</span>));

DESCRIBE view1
 Name                             Null?    Type
 -------------------------------- -------- ---------------------------
 DATE_LOADED                               TIMESTAMP(6) WITH TIME ZONE
 ID                               NOT NULL RAW(16)
 PO_DOCUMENT$User                          VARCHAR2(8)
 <span class="italic">PONumber</span>                                  NUMBER
 PO_DOCUMENT$Reference                     VARCHAR2(16)
 PO_DOCUMENT$Requestor                     VARCHAR2(16)
 PO_DOCUMENT$CostCenter                    VARCHAR2(4)
 PO_DOCUMENT$AllowPartialShipment          VARCHAR2(4)
 PO_DOCUMENT$name                          VARCHAR2(16)
 <span class="italic">Phone</span>                                     VARCHAR2(16)
 PO_DOCUMENT$city                          VARCHAR2(32)
 PO_DOCUMENT$state                         VARCHAR2(2)
 PO_DOCUMENT$street                        VARCHAR2(32)
 PO_DOCUMENT$country                       VARCHAR2(32)
 PO_DOCUMENT$zipCode                       NUMBER
 PO_DOCUMENT$SpecialInstructions           VARCHAR2(8)
 PO_DOCUMENT$UPCCode                       NUMBER
 PO_DOCUMENT$UnitPrice                     NUMBER
 <span class="italic">PartDescription</span>                           VARCHAR2(32)
 PO_DOCUMENT$Quantity                      NUMBER
 <span class="italic">ItemNumber</span>                                NUMBER
 <span class="italic">PhoneType</span>                                 VARCHAR2(8)
 <span class="italic">PhoneNumber</span>                               VARCHAR2(16)</code></pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-90EC7EB8-7D45-4CB7-B16E-97BA3427D35F__GUID-5179B888-D665-4D40-A117-6A0B2FD81532">
                        <p class="titleinexample">Example 20-6 Creating a View Using a Hierarchical Data Guide Obtained With JSON_DATAGUIDE</p>
                        <p>This example creates a view that projects all of the fields present in the hierarchical data guide that is obtained by invoking SQL function <code class="codeph">json_dataguide</code> on <code class="codeph">po_document</code> of table <code class="codeph">j_purchaseorder</code>. The second and third arguments passed to <code class="codeph">json_dataguide</code> are used, respectively, to specify that the data guide is to be hierarchical and pretty-printed.
                        </p>
                        <p>Note that none of the view column names here have the prefix <code class="codeph">PO_DOCUMENT$</code>. That prefix is used only when you use a data guide that is obtained from the information in a data guide-enabled JSON search index.
                        </p>
                        <p>The data guide returned by <code class="codeph">json_dataguide</code> has only <code class="codeph">o:path</code>, <code class="codeph">type</code>, <code class="codeph">o:length</code>, and <code class="codeph">o:preferred_column_name</code> as its predefined fields. The values of field <code class="codeph">o:preferred_column_name</code> are the same as the field names. (There can of course be no fields holding statistical information, as that can only be stored in an index.)
                        </p>
                        <p>The view column names come from the values of field <code class="codeph">o:preferred_column_name</code> of the data guide that you pass to <code class="codeph">DBMS_JSON.create_view</code>. By default, the view columns are thus named the same as the projected fields. 
                        </p>
                        <p>Because the columns must be uniquely named in the view, <span class="italic">you must ensure</span> that the field names themselves are unique, or else you must edit the data guide returned by <code class="codeph">json_dataguide</code> to add appropriate <code class="codeph">o:preferred_column_name</code> entries that ensure uniqueness. An error is raised by <code class="codeph">DBMS_JSON.create_view</code> if the names for the columns are not unique.
                        </p><pre class="pre codeblock"><code>DECLARE
  dg CLOB;
  BEGIN
    SELECT <span class="bold">json_dataguide</span>(po_document,
                          FORMAT DBMS_JSON.<span class="bold">FORMAT_HIERARCHICAL</span>,
                          DBMS_JSON.<span class="bold">PRETTY</span>)
      INTO <span class="bold">dg</span>
      FROM j_purchaseorder
      WHERE extract(YEAR FROM date_loaded) = 2014;
    DBMS_JSON.create_view('MYVIEW', 'J_PURCHASEORDER', 'PO_DOCUMENT', <span class="bold">dg</span>);
  END;
/

DESCRIBE myview
 Name                 Null?    Type
 -------------------- -------- ---------------------------
 DATE_LOADED                   TIMESTAMP(6) WITH TIME ZONE
 ID                   NOT NULL RAW(16)
 User                          VARCHAR2(8)
 PONumber                      NUMBER
 UPCCode                       NUMBER
 UnitPrice                     NUMBER
 Description                   VARCHAR2(32)
 Quantity                      NUMBER
 ItemNumber                    NUMBER
 Reference                     VARCHAR2(16)
 Requestor                     VARCHAR2(16)
 CostCenter                    VARCHAR2(4)
 AllowPartialShipment          VARCHAR2(4)
 name                          VARCHAR2(16)
 Phone                         VARCHAR2(16)
 type                          VARCHAR2(8)
 number                        VARCHAR2(16)
 city                          VARCHAR2(32)
 state                         VARCHAR2(2)
 street                        VARCHAR2(32)
 country                       VARCHAR2(32)
 zipCode                       NUMBER
 Special Instructions          VARCHAR2(8)
</code></pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="json-dataguide.html#GUID-394009D2-F829-49B0-B6EF-DB24606FEF75" title="Based on data-guide information, you can create a database view whose columns project particular scalar fields present in a set of JSON documents. You can choose the fields to project by editing a hierarchical data guide or by specifying a SQL/JSON path expression and a minimum frequency of field occurrence.">Creating a View Over JSON Data Based on Data-Guide Information</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-B6A1D87D-9EE8-47F0-8325-96A366254488" name="GUID-B6A1D87D-9EE8-47F0-8325-96A366254488"></a><h4 id="ADJSN-GUID-B6A1D87D-9EE8-47F0-8325-96A366254488" class="sect4"><span class="enumeration_section">20.7.2 </span>Creating a View Over JSON Data Based on a Path Expression
                  </h4>
                  <div>
                     <p>You can use the information in a data guide-enabled JSON search index to create a database view whose columns project JSON fields from your documents. The fields projected are the scalar fields not under an array plus the scalar fields in the data targeted by a specified SQL/JSON path expression.</p>
                     <div class="section">
                        <p>For example, if the path expression is <code class="codeph">$</code> then all scalar fields are projected, because the root (top) of the document is targeted. <a href="json-dataguide.html#GUID-B6A1D87D-9EE8-47F0-8325-96A366254488__GUID-E8DF1BBB-BA37-486F-A5AD-E908B7DF1F56">Example 20-7</a> illustrates this. If the path is <code class="codeph">$.LineItems.Part</code> then only the scalar fields that are present (at any level) in the data targeted by <code class="codeph">$.LineItems.Part</code> are projected (in addition to scalar fields elsewhere that are not under an array). <a href="json-dataguide.html#GUID-B6A1D87D-9EE8-47F0-8325-96A366254488__EXAMPLE-133-F3BDE7BF">Example 20-8</a> illustrates this.
                        </p>
                        <p>If you gather statistics on your JSON document set then the data-guide information in a data guide-enabled JSON search index records the frequency of occurrence, across the document set, of each path to a field that is present in a document. When you create the view, you can specify that only the (scalar) fields with a given minimum frequency of occurrence (as a percentage) are to be projected as view columns. You do this by specifying a non-zero value for parameter <code class="codeph"><span class="codeinlineitalic">FREQUENCY</span></code> of procedure <code class="codeph">DBMS_JSON.create_view_on_path</code>.
                        </p>
                        <p>For example, if you specify the path as <code class="codeph">$</code> and the minimum frequency as <code class="codeph">50</code> then all scalar fields (on any path, since <code class="codeph">$</code> targets the whole document) that occur in at least half (50%) of the documents are projected. <a href="json-dataguide.html#GUID-B6A1D87D-9EE8-47F0-8325-96A366254488__EXAMPLE-134-F3C222C1">Example 20-9</a> illustrates this.
                        </p>
                        <p>The value of argument <span class="italic"><code class="codeph">PATH</code></span> is a simple SQL/JSON path expression (no filter expression), possibly with relaxation (implicit array wrapping and unwrapping), but with no array steps and no function step. See <a href="json-path-expressions.html#GUID-7B610884-39CD-4910-85E7-C251D342D879" title="SQL/JSON path expressions are matched by SQL/JSON functions and conditions against JSON data, to select portions of it. Path expressions can use wildcards and array ranges. Matching is case-sensitive.">SQL/JSON Path Expression Syntax</a>.
                        </p>
                        <div class="p"><span class="italic">No</span> frequency filtering is done in <span class="italic">either</span> of the following cases — targeted fields are <span class="italic">projected regardless of their frequency</span> of occurrence in the documents:
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>You never gather statistics information on your set of JSON documents. (No frequency information is included in the data guide-enabled JSON search index.)</p>
                              </li>
                              <li>
                                 <p>The <code class="codeph"><span class="codeinlineitalic">FREQUENCY</span></code> argument of <code class="codeph">DBMS_JSON.create_view_on_path</code> is <span class="italic">zero</span> (0).
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <div class="infoboxnote" id="GUID-B6A1D87D-9EE8-47F0-8325-96A366254488__GUID-1B6A37DF-C443-4B21-8F5D-56BD02B7C04C">
                           <p class="notep1">Note:</p>
                           <p>When the <code class="codeph"><span class="codeinlineitalic">FREQUENCY</span></code> argument is non-zero, even if you have gathered statistics information on your document set, the index contains <span class="italic">no</span> statistical information for any documents added after the most recent gathering of statistics. This means that any <span class="italic">fields added after that statistics gathering are ignored</span> (not projected).
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-B6A1D87D-9EE8-47F0-8325-96A366254488__GUID-829B8C5D-F218-4B2A-A6DB-DEB680F3B22A">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><a href="../arpls/DBMS_JSON.html#ARPLS-GUID-F6FCD886-191D-4F2E-8767-62CFDC762FC1" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a>  for information about <code class="codeph">DBMS_JSON.create_view_on_path</code></p>
                              </li>
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=ARPLS-GUID-0E802354-4508-4DF7-A07A-6999F3337CA5" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a>  for information about <code class="codeph">DBMS_JSON.rename_column</code></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-B6A1D87D-9EE8-47F0-8325-96A366254488__GUID-E8DF1BBB-BA37-486F-A5AD-E908B7DF1F56">
                        <p class="titleinexample">Example 20-7 Creating a View That Projects All Scalar Fields</p>
                        <p>All scalar fields are represented in the view, because the specified path is <code class="codeph">$</code>. 
                        </p>
                        <p>(Columns whose names are <span class="italic"><code class="codeph">italic</code></span> in the <code class="codeph">describe</code> command output are those that have been renamed using PL/SQL procedure <code class="codeph">DBMS_JSON.rename_column</code>. <span class="underline">Underlined</span> rows are missing from <a href="json-dataguide.html#GUID-B6A1D87D-9EE8-47F0-8325-96A366254488__EXAMPLE-134-F3C222C1">Example 20-9</a>.)
                        </p><pre class="pre codeblock"><code>EXEC DBMS_JSON.create_view_on_path('VIEW2',
                                   'J_PURCHASEORDER',
                                   'PO_DOCUMENT',
                                   '<span class="bold">$</span>');

DESCRIBE view2;
 Name                              Null?    Type
 --------------------------------  -------- ------------------
 ID                                NOT NULL RAW(16)
 DATE_LOADED                       TIMESTAMP(6) WITH TIME ZONE
 PO_DOCUMENT$User                  VARCHAR2(8)
 <span class="italic">PONumber</span>                          NUMBER
 PO_DOCUMENT$Reference             VARCHAR2(16)
 PO_DOCUMENT$Requestor             VARCHAR2(16)
 PO_DOCUMENT$CostCenter            VARCHAR2(4)
 <span class="underline">PO_DOCUMENT$AllowPartialShipment  VARCHAR2(4)</span>
 PO_DOCUMENT$name                  VARCHAR2(16)
 <span class="underline"><span class="italic">Phone</span>                             VARCHAR2(16)
</span> PO_DOCUMENT$city                  VARCHAR2(32)
 PO_DOCUMENT$state                 VARCHAR2(2)
 PO_DOCUMENT$street                VARCHAR2(32)
 PO_DOCUMENT$country               VARCHAR2(32)
 PO_DOCUMENT$zipCode               NUMBER
 PO_DOCUMENT$SpecialInstructions   VARCHAR2(8)
 PO_DOCUMENT$UPCCode               NUMBER
 PO_DOCUMENT$UnitPrice             NUMBER
 <span class="italic">PartDescription</span>                   VARCHAR2(32)
 PO_DOCUMENT$Quantity              NUMBER
 <span class="italic">ItemNumber</span>                        NUMBER
 <span class="underline"><span class="italic">PhoneType</span>                         VARCHAR2(8)
</span> <span class="underline"><span class="italic">PhoneNumber</span>                       VARCHAR2(16)</span></code></pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-B6A1D87D-9EE8-47F0-8325-96A366254488__EXAMPLE-133-F3BDE7BF">
                        <p class="titleinexample">Example 20-8 Creating a View That Projects Scalar Fields Targeted By a Path Expression</p>
                        <p>Fields <code class="codeph">Itemnumber</code>, <code class="codeph">PhoneType</code>, and <code class="codeph">PhoneNumber</code> are <span class="italic">not</span> represented in the view. The only fields that are projected are those scalar fields that are not under an array plus those that are present (at any level) in the data that is targeted by <code class="codeph">$.LineItems.Part</code> (that is, the scalar fields whose paths start with <code class="codeph">$.LineItems.Part</code>). (Columns whose names are <span class="italic"><code class="codeph">italic</code></span> in the <code class="codeph">describe</code> command output are those that have been renamed using PL/SQL procedure <code class="codeph">DBMS_JSON.rename_column</code>.)
                        </p><pre class="pre codeblock"><code>SQL&gt; EXEC DBMS_JSON.create_view_on_path('VIEW4',
                                        'J_PURCHASEORDER',
                                        'PO_DOCUMENT',
                                        '<span class="bold">$.LineItems.Part</span>');


SQL&gt; DESCRIBE view4;
 Name                             Null?    Type
 -------------------------------- -------- ------------------
 ID                               NOT NULL RAW(16)
 DATE_LOADED                      TIMESTAMP(6) WITH TIME ZONE
 PO_DOCUMENT$User                 VARCHAR2(8)
 <span class="italic">PONumber</span>                         NUMBER
 PO_DOCUMENT$Reference            VARCHAR2(16)
 PO_DOCUMENT$Requestor            VARCHAR2(16)
 PO_DOCUMENT$CostCenter           VARCHAR2(4)
 PO_DOCUMENT$AllowPartialShipment VARCHAR2(4)
 PO_DOCUMENT$name                 VARCHAR2(16)
 <span class="italic">Phone</span>                            VARCHAR2(16)
 PO_DOCUMENT$city                 VARCHAR2(32)
 PO_DOCUMENT$state                VARCHAR2(2)
 PO_DOCUMENT$street               VARCHAR2(32)
 PO_DOCUMENT$country              VARCHAR2(32)
 PO_DOCUMENT$zipCode              NUMBER
 PO_DOCUMENT$SpecialInstructions  VARCHAR2(8)
 PO_DOCUMENT$UPCCode              NUMBER
 PO_DOCUMENT$UnitPrice            NUMBER
 <span class="italic">PartDescription</span>                  VARCHAR2(32)</code></pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-B6A1D87D-9EE8-47F0-8325-96A366254488__EXAMPLE-134-F3C222C1">
                        <p class="titleinexample">Example 20-9 Creating a View That Projects Scalar Fields Having a Given Frequency</p>
                        <p>All scalar fields that occur in all (100%) of the documents are represented in the view. Field <code class="codeph">AllowPartialShipment</code> does not occur in all of the documents, so there is no column <code class="codeph">PO_DOCUMENT$AllowPartialShipment</code> in the view. Similarly for fields <code class="codeph">Phone</code>, <code class="codeph">PhoneType</code>, and <code class="codeph">PhoneNumber</code>.
                        </p>
                        <p>(Columns whose names are <span class="italic"><code class="codeph">italic</code></span> in the <code class="codeph">describe</code> command output are those that have been renamed using PL/SQL procedure <code class="codeph">DBMS_JSON.rename_column</code>.)
                        </p><pre class="pre codeblock"><code>SQL&gt; EXEC DBMS_JSON.create_view_on_path('VIEW3',
                                        'J_PURCHASEORDER',
                                        'PO_DOCUMENT',
                                        '$',
                                        <span class="bold">100</span>);


SQL&gt; DESCRIBE view3;
 Name                             Null?    Type
 -------------------------------- -------- ------------------
 ID                               NOT NULL RAW(16)
 DATE_LOADED                      TIMESTAMP(6) WITH TIME ZONE
 PO_DOCUMENT$User                 VARCHAR2(8)
 <span class="italic">PONumber</span>                         NUMBER
 PO_DOCUMENT$Reference            VARCHAR2(16)
 PO_DOCUMENT$Requestor            VARCHAR2(16)
 PO_DOCUMENT$CostCenter           VARCHAR2(4)
 PO_DOCUMENT$name                 VARCHAR2(16)
 PO_DOCUMENT$city                 VARCHAR2(32)
 PO_DOCUMENT$state                VARCHAR2(2)
 PO_DOCUMENT$street               VARCHAR2(32)
 PO_DOCUMENT$country              VARCHAR2(32)
 PO_DOCUMENT$zipCode              NUMBER
 PO_DOCUMENT$SpecialInstructions  VARCHAR2(8)
 PO_DOCUMENT$UPCCode              NUMBER
 PO_DOCUMENT$UnitPrice            NUMBER
 <span class="italic">PartDescription</span>                  VARCHAR2(32)
 PO_DOCUMENT$Quantity             NUMBER
 <span class="italic">ItemNumber</span>                       NUMBER</code></pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="json-dataguide.html#GUID-A0AFD360-93A7-4566-8315-6F68D9AE090B" title="You can project JSON fields from your data as columns in a database view or as virtual columns added to the same table that contains the JSON column. You can specify a preferred name for such a column.">Specifying a Preferred Name for a Field Column</a></li>
                           <li><a href="json-path-expressions.html#GUID-2DC05D71-3D62-4A14-855F-76E054032494" title="Oracle Database provides SQL access to JSON data using SQL/JSON path expressions.">SQL/JSON Path Expressions</a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="json-dataguide.html#GUID-394009D2-F829-49B0-B6EF-DB24606FEF75" title="Based on data-guide information, you can create a database view whose columns project particular scalar fields present in a set of JSON documents. You can choose the fields to project by editing a hierarchical data guide or by specifying a SQL/JSON path expression and a minimum frequency of field occurrence.">Creating a View Over JSON Data Based on Data-Guide Information</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
            <div class="sect2"><a id="GUID-7AEF436C-B743-4BA1-B6D4-1F1B98E26DB1" name="GUID-7AEF436C-B743-4BA1-B6D4-1F1B98E26DB1"></a><h3 id="ADJSN-GUID-7AEF436C-B743-4BA1-B6D4-1F1B98E26DB1" class="sect3"><span class="enumeration_section">20.8 </span>Adding and Dropping Virtual Columns For JSON Fields Based on Data-Guide Information
               </h3>
               <div>
                  <p>Based on data-guide information for a JSON column, you can project scalar fields from that JSON data as virtual columns in the same table. The scalar fields projected are those that are not under an array.</p>
                  <div class="section">
                     <p>You can do all of the following with a virtual column, with the aim of improving performance: </p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>Build an index on it.</p>
                        </li>
                        <li>
                           <p>Gather statistics on it for the optimizer.</p>
                        </li>
                        <li>
                           <p>Load it into the In-Memory Column Store (IM column store).</p>
                        </li>
                     </ul>
                     <div class="infoboxnote" id="GUID-7AEF436C-B743-4BA1-B6D4-1F1B98E26DB1__GUID-174F754D-82D9-4600-8883-4F9CEA4939B4">
                        <p class="notep1">Note:</p>
                        <p>Virtual columns, like columns in general, are subject to the 1000-column limit for a given table.</p>
                     </div>
                     <p>You use PL/SQL procedure <code class="codeph">DBMS_JSON.add_virtual_columns</code> to add virtual columns based on data-guide information for a JSON column. Before it adds virtual columns, procedure <code class="codeph">add_virtual_columns</code> first drops any existing virtual columns that were projected from fields in the same JSON column by a previous invocation of <code class="codeph">add_virtual_columns</code> or by data-guide change-trigger procedure <code class="codeph">add_vc</code> (in effect, it does what procedure <code class="codeph">DBMS_JSON.drop_virtual_columns</code> does).
                     </p>
                     <p>There are two alternative sources of the data-guide information that you provide to procedure <code class="codeph">add_virtual_columns</code>:
                     </p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>It can come from a <span class="italic">hierarchical data guide</span> that you pass as an argument. All scalar fields in the data guide that are not under an array are projected as virtual columns. All other fields in the data guide are ignored (not projected).
                           </p>
                           <p>In this case, you can edit the data guide before passing it, so that it specifies the scalar fields (not under an array) that you want projected.  You do <span class="italic">not</span> need a data guide-enabled search index in this case.
                           </p>
                        </li>
                        <li>
                           <p>It can come from a <span class="italic">data guide-enabled JSON search index</span>.
                           </p>
                           <p>In this case, you can specify, as the value of argument <span class="italic"><code class="codeph">FREQUENCY</code></span> to procedure <code class="codeph">add_virtual_columns</code>, a minimum frequency of occurrence for the scalar fields to be projected. You need a data guide-enabled search index in this case, but you do not need a data guide.
                           </p>
                        </li>
                     </ul>
                     <p>You can also specify that added virtual columns be <span class="italic">hidden</span>. The SQL <code class="codeph">describe</code> command does not list hidden columns.
                     </p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>If you pass a (hierarchical) data guide to <code class="codeph">add_virtual_columns</code> then you can specify projection of particular scalar fields (not under an array) as <span class="italic">hidden</span> virtual columns by adding <code class="codeph">"o:hidden": <span class="bold">true</span></code> to their descriptions in the data guide.
                           </p>
                        </li>
                        <li>
                           <p>If you use a data guide-enabled JSON search index with <code class="codeph">add_virtual_columns</code> then you can specify a PL/SQL <code class="codeph"><span class="bold">TRUE</span></code> value for argument <span class="italic"><code class="codeph">HIDDEN</code></span>, to make <span class="italic">all</span> of the added virtual columns be hidden. (The default value of <span class="italic"><code class="codeph">HIDDEN</code></span> is <code class="codeph">FALSE</code>, meaning that the added virtual columns are not hidden.)
                           </p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section"></div>
                  <!-- class="section" -->
                  <div class="section"></div>
                  <!-- class="section" -->
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="json-dataguide.html#GUID-9BAE6F8C-3031-465C-BA54-653E8FB1EE51">Adding Virtual Columns For JSON Fields Based on a Hierarchical Data Guide</a><br>You can use a hierarchical data guide to project scalar fields from JSON data as virtual columns in the same table. All scalar fields in the data guide that are not under an array are projected as virtual columns. All other fields in the data guide are ignored (not projected).
                     </li>
                     <li class="ulchildlink"><a href="json-dataguide.html#GUID-E0591013-535D-4B7F-B7D9-76A7B1BB0989">Adding Virtual Columns For JSON Fields Based on a Data Guide-Enabled Search Index</a><br>You can use a data guide-enabled search index for a JSON column to project scalar fields from that JSON data as virtual columns in the same table. Only scalar fields not under an array are projected. You can specify a minimum frequency of occurrence for the fields to be projected.
                     </li>
                     <li class="ulchildlink"><a href="json-dataguide.html#GUID-3526B063-FCD8-4F78-94E4-1A2E07F115E1">Dropping Virtual Columns for JSON Fields Based on Data-Guide Information</a><br>You can use procedure <code class="codeph">DBMS_JSON.drop_virtual_columns</code> to drop all virtual columns that were added for JSON fields in a column of JSON data.
                     </li>
                  </ul>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="in-memory-json-data.html#GUID-857A2E95-28AB-4314-B654-4CB05C50D9CF" title="A column of JSON data can be stored in the In-Memory Column Store (IM column store) to improve query performance.">In-Memory JSON Data</a></li>
                     </ul>
                  </div>
                  <div class="infoboxnotealso" id="GUID-7AEF436C-B743-4BA1-B6D4-1F1B98E26DB1__GUID-C2224A86-BF00-482B-813B-71BEB36EC242">
                     <p class="notep1">See Also:</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=ARPLS-GUID-69DD0940-58EA-48D8-A635-097A6BA7A31B" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> for information about <code class="codeph">DBMS_JSON.add_virtual_columns</code></p>
                        </li>
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=ARPLS-GUID-F6FCD886-191D-4F2E-8767-62CFDC762FC1" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> for information about <code class="codeph">DBMS_JSON.create_view_on_path</code></p>
                        </li>
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=ARPLS-GUID-119D090B-A309-4A2F-887F-A40B4266D68C" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> for information about <code class="codeph">DBMS_JSON.drop_virtual_columns</code></p>
                        </li>
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=ARPLS-GUID-0E802354-4508-4DF7-A07A-6999F3337CA5" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> for information about <code class="codeph">DBMS_JSON.rename_column</code></p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="json-dataguide.html#GUID-219FC30E-89A7-4189-BC36-7B961A24067C" title="A JSON data guide lets you discover information about the structure and content of JSON documents stored in Oracle Database.">JSON Data Guide</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="sect3"><a id="GUID-9BAE6F8C-3031-465C-BA54-653E8FB1EE51" name="GUID-9BAE6F8C-3031-465C-BA54-653E8FB1EE51"></a><h4 id="ADJSN-GUID-9BAE6F8C-3031-465C-BA54-653E8FB1EE51" class="sect4"><span class="enumeration_section">20.8.1 </span>Adding Virtual Columns For JSON Fields Based on a Hierarchical Data Guide
                  </h4>
                  <div>
                     <p>You can use a hierarchical data guide to project scalar fields from JSON data as virtual columns in the same table. All scalar fields in the data guide that are not under an array are projected as virtual columns. All other fields in the data guide are ignored (not projected).</p>
                     <div class="section">
                        <p>You can obtain a hierarchical data guide using PL/SQL function <code class="codeph">DBMS_JSON.get_index_dataguide</code>. A data guide-enabled JSON search index must be defined on the column of JSON data.
                        </p>
                        <p>You can edit the data guide obtained, to include only specific scalar fields (that are not under an array), rename those fields, or change the lengths of their types. The resulting data guide specifies which such fields to project as new virtual columns. Any fields in the data guide that are not scalar fields not under an array are ignored (not projected).</p>
                        <p>You use PL/SQL procedure <code class="codeph">DBMS_JSON.add_virtual_columns</code> to add the virtual columns to the table that contains the JSON column containing the projected fields. That procedure first drops any existing virtual columns that were projected from fields in the same JSON column by a previous invocation of <code class="codeph">add_virtual_columns</code> or by data-guide change-trigger procedure <code class="codeph">add_vc</code> (in effect, it does what procedure <code class="codeph">DBMS_JSON.drop_virtual_columns</code> does).
                        </p>
                        <p><a href="json-dataguide.html#GUID-9BAE6F8C-3031-465C-BA54-653E8FB1EE51__GUID-FB607F06-E9DA-4023-963D-C0AC20D962DA">Example 20-10</a> illustrates this. It projects scalar fields that are not under an array, from the data in JSON column <code class="codeph">po_document</code> of table <code class="codeph">j_purchaseorder</code>. The fields projected are those that are indicated in the hierarchical data guide.
                        </p>
                        <p><a href="json-dataguide.html#GUID-9BAE6F8C-3031-465C-BA54-653E8FB1EE51__EXAMPLE-145-FB71CAF9">Example 20-11</a> illustrates passing a data-guide argument that specifies the projection of two fields as virtual columns. Data-guide field <code class="codeph">o:hidden</code> is used to hide one of these columns.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-9BAE6F8C-3031-465C-BA54-653E8FB1EE51__NOTE-1521-F98B39D9">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=ARPLS-GUID-69DD0940-58EA-48D8-A635-097A6BA7A31B" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a>  for information about <code class="codeph">DBMS_JSON.add_virtual_columns</code></p>
                              </li>
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=ARPLS-GUID-119D090B-A309-4A2F-887F-A40B4266D68C" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> for information about <code class="codeph">DBMS_JSON.drop_virtual_columns</code></p>
                              </li>
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=ARPLS-GUID-52B63CEE-669C-46FB-A276-56F7C6ECD036" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> for information about <code class="codeph">DBMS_JSON.get_index_dataguide</code></p>
                              </li>
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=ARPLS-GUID-0E802354-4508-4DF7-A07A-6999F3337CA5" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a>  for information about <code class="codeph">DBMS_JSON.rename_column</code></p>
                              </li>
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=ARPLS-GUID-F9032949-7FE1-4A31-AA4B-4A2775F0CBE6" target="_blank"><span><cite>Oracle Database SQL Language Reference</cite></span></a> for information about PL/SQL constant <code class="codeph">DBMS_JSON.FORMAT_HIERARCHICAL</code></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="section"></div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-9BAE6F8C-3031-465C-BA54-653E8FB1EE51__GUID-FB607F06-E9DA-4023-963D-C0AC20D962DA">
                        <p class="titleinexample">Example 20-10 Adding Virtual Columns That Project JSON Fields Using a Data Guide Obtained With GET_INDEX_DATAGUIDE</p>
                        <p>In this example the hierarchical data guide is obtained from a data guide-enabled JSON search index on JSON column <code class="codeph">po_document</code>.
                        </p>
                        <p>The added virtual columns are all of the columns in table <code class="codeph">j_purchaseorder</code> except for <code class="codeph">ID</code>, <code class="codeph">DATE_LOADED</code>, and <code class="codeph">PODOCUMENT</code>. 
                        </p>
                        <p>(Columns whose names are <span class="italic"><code class="codeph">italic</code></span> in the <code class="codeph">describe</code> command output are those that have been renamed using PL/SQL procedure <code class="codeph">DBMS_JSON.rename_column</code>.)
                        </p><pre class="pre codeblock"><code>EXEC DBMS_JSON.add_virtual_columns(
       'J_PURCHASEORDER',
       'PO_DOCUMENT',
       DBMS_JSON.<span class="bold">get_index_dataguide</span>('J_PURCHASEORDER',
                                     'PO_DOCUMENT',
                                     DBMS_JSON.<span class="bold">FORMAT_HIERARCHICAL</span>));

DESCRIBE j_purchaseorder;
 Name                                      Null?    Type
 ----------------------------------------- -------- ----------------------------
 ID                                        NOT NULL RAW(16)
 DATE_LOADED                                        TIMESTAMP(6) WITH TIME ZONE
 PO_DOCUMENT                                        CLOB
 PO_DOCUMENT$User                                   VARCHAR2(8)
 <span class="italic">PONumber</span>                                           NUMBER
 PO_DOCUMENT$Reference                              VARCHAR2(16)
 PO_DOCUMENT$Requestor                              VARCHAR2(16)
 PO_DOCUMENT$CostCenter                             VARCHAR2(4)
 PO_DOCUMENT$AllowPartialShipment                   VARCHAR2(4)
 PO_DOCUMENT$name                                   VARCHAR2(16)
 <span class="italic">Phone</span>                                              VARCHAR2(16)
 PO_DOCUMENT$city                                   VARCHAR2(32)
 PO_DOCUMENT$state                                  VARCHAR2(2)
 PO_DOCUMENT$street                                 VARCHAR2(32)
 PO_DOCUMENT$country                                VARCHAR2(32)
 PO_DOCUMENT$zipCode                                NUMBER
 PO_DOCUMENT$SpecialInstructions                    VARCHAR2(8)
</code></pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-9BAE6F8C-3031-465C-BA54-653E8FB1EE51__EXAMPLE-145-FB71CAF9">
                        <p class="titleinexample">Example 20-11 Adding Virtual Columns, Hidden and Visible</p>
                        <p>In this example only two fields are projected as virtual columns: <code class="codeph">PO_Number</code> and <code class="codeph">PO_Reference</code>. The data guide is defined locally as a literal string. Data-guide field <code class="codeph">o:hidden</code> is used here to hide the virtual column for <code class="codeph">PO_Reference</code>. (For <code class="codeph">PO_Number</code> the <code class="codeph">o:hidden: false</code> entry is not needed, as <code class="codeph">false</code> is the default value.)
                        </p><pre class="pre codeblock"><code>DECLARE
  dg CLOB;
BEGIN
  dg := '{"type" : "object",
          "properties" :
            {"PO_Number"    : {"type" : "number",
                               "o:length" : 4,
                               "o:preferred_column_name" : "PO_Number",
                               "o:hidden" : false},
             "PO_Reference" : {"type" : "string",
                               "o:length" : 16,
                               "o:preferred_column_name" : "PO_Reference",
                               "o:hidden" : <span class="bold">true</span>}}}';
  DBMS_JSON.add_virtual_columns('J_PURCHASEORDER', 'PO_DOCUMENT', dg);
END;
/

DESCRIBE j_purchaseorder;
 Name        Null?    Type
 ----------- -------- ---------------------------
 ID          NOT NULL RAW(16)
 DATE_LOADED          TIMESTAMP(6) WITH TIME ZONE
 PO_DOCUMENT          CLOB
 <span class="bold">PO_Number</span>            NUMBER

SELECT column_name FROM user_tab_columns
  WHERE table_name = 'J_PURCHASEORDER' ORDER BY 1;
COLUMN_NAME
-----------
DATE_LOADED
ID
PO_DOCUMENT
<span class="bold">PO_Number</span>
<span class="bold">PO_Reference</span>

5 rows selected.</code></pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="json-dataguide.html#GUID-7AEF436C-B743-4BA1-B6D4-1F1B98E26DB1" title="Based on data-guide information for a JSON column, you can project scalar fields from that JSON data as virtual columns in the same table. The scalar fields projected are those that are not under an array.">Adding and Dropping Virtual Columns For JSON Fields Based on Data-Guide Information</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-E0591013-535D-4B7F-B7D9-76A7B1BB0989" name="GUID-E0591013-535D-4B7F-B7D9-76A7B1BB0989"></a><h4 id="ADJSN-GUID-E0591013-535D-4B7F-B7D9-76A7B1BB0989" class="sect4"><span class="enumeration_section">20.8.2 </span>Adding Virtual Columns For JSON Fields Based on a Data Guide-Enabled Search Index
                  </h4>
                  <div>
                     <p>You can use a data guide-enabled search index for a JSON column to project scalar fields from that JSON data as virtual columns in the same table. Only scalar fields not under an array are projected. You can specify a minimum frequency of occurrence for the fields to be projected.</p>
                     <div class="section">
                        <p>You use procedure <code class="codeph">DBMS_JSON.add_virtual_columns</code> to add the virtual columns.
                        </p>
                        <p><a href="json-dataguide.html#GUID-E0591013-535D-4B7F-B7D9-76A7B1BB0989__PROJECTINGALLSCALARFIELDSNOTUNDERAN-FE25A770">Example 20-12</a> illustrates this. It projects all scalar fields that are not under an array to table <code class="codeph">j_purchaseorder</code> as virtual columns.
                        </p>
                        <p>If you gather statistics on the documents in the JSON column where you want to project fields then the data-guide information in the data guide-enabled JSON search index records the frequency of occurrence, across that document set, of each field in a document.</p>
                        <p>When you add virtual columns you can specify that only those fields with a given minimum frequency of occurrence are to be projected.</p>
                        <p>You do this by specifying a non-zero value for parameter <span class="italic"><code class="codeph">FREQUENCY</code> </span>of procedure <code class="codeph">add_virtual_columns</code>. Zero is the default value, so if you do not include argument <span class="italic"><code class="codeph">FREQUENCY</code> </span> then all scalar fields (not under an array) are projected.  The frequency of a given field is the number of documents containing that field divided by the total number of documents in the JSON column, expressed as a percentage.
                        </p>
                        <p><a href="json-dataguide.html#GUID-E0591013-535D-4B7F-B7D9-76A7B1BB0989__PROJECTINGSCALARFIELDSWITHAMINIMUMF-FE25ACC0">Example 20-13</a> projects all scalars (not under an array) that occur in all (100%) of the documents as virtual columns.
                        </p>
                        <p>If you want to <span class="italic">hide</span> all of the added virtual columns then specify a <code class="codeph"><span class="bold">TRUE</span></code> value for argument <span class="italic"><code class="codeph">HIDDEN</code></span>. (The default value of parameter <span class="italic"><code class="codeph">HIDDEN</code></span> is <code class="codeph">FALSE</code>, meaning that the added virtual columns are not hidden.)
                        </p>
                        <p><a href="json-dataguide.html#GUID-E0591013-535D-4B7F-B7D9-76A7B1BB0989__PROJECTINGSCALARFIELDSWITHAMINIMUMF-FE25AF56">Example 20-14</a> projects, as hidden virtual columns, the scalar fields (not under an array) that occur in all (100%) of the documents.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-E0591013-535D-4B7F-B7D9-76A7B1BB0989__NOTE-1521-F98AAD63">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=ARPLS-GUID-69DD0940-58EA-48D8-A635-097A6BA7A31B" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a>  for information about <code class="codeph">DBMS_JSON.add_virtual_columns</code></p>
                              </li>
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=ARPLS-GUID-0E802354-4508-4DF7-A07A-6999F3337CA5" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a>  for information about <code class="codeph">DBMS_JSON.rename_column</code></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-E0591013-535D-4B7F-B7D9-76A7B1BB0989__PROJECTINGALLSCALARFIELDSNOTUNDERAN-FE25A770">
                        <p class="titleinexample">Example 20-12 Projecting All Scalar Fields Not Under an Array as Virtual Columns</p>
                        <p>The added virtual columns are all of the columns in table <code class="codeph">j_purchaseorder</code> except for <code class="codeph">ID</code>, <code class="codeph">DATE_LOADED</code>, and <code class="codeph">PODOCUMENT</code>. This is because no <span class="italic"><code class="codeph">FREQUENCY</code></span> argument is passed to <code class="codeph">add_virtual_columns</code>, so all scalar fields (that are not under an array) are projected.
                        </p>
                        <p>(Columns whose names are <span class="italic"><code class="codeph">italic</code></span> in the <code class="codeph">describe</code> command output are those that have been renamed using PL/SQL procedure <code class="codeph">DBMS_JSON.rename_column</code>.)
                        </p><pre class="pre codeblock"><code>EXEC DBMS_JSON.add_virtual_columns('J_PURCHASEORDER', 'PO_DOCUMENT');

DESCRIBE j_purchaseorder;
 Name                                      Null?    Type
 ----------------------------------------- -------- ----------------------------
 ID                                        NOT NULL RAW(16)
 DATE_LOADED                                        TIMESTAMP(6) WITH TIME ZONE
 PO_DOCUMENT                                        CLOB
 PO_DOCUMENT$User                                   VARCHAR2(8)
 <span class="italic">PONumber</span>                                           NUMBER
 PO_DOCUMENT$Reference                              VARCHAR2(16)
 PO_DOCUMENT$Requestor                              VARCHAR2(16)
 PO_DOCUMENT$CostCenter                             VARCHAR2(4)
 PO_DOCUMENT$AllowPartialShipment                   VARCHAR2(4)
 PO_DOCUMENT$name                                   VARCHAR2(16)
 <span class="italic">Phone</span>                                              VARCHAR2(16)
 PO_DOCUMENT$city                                   VARCHAR2(32)
 PO_DOCUMENT$state                                  VARCHAR2(2)
 PO_DOCUMENT$street                                 VARCHAR2(32)
 PO_DOCUMENT$country                                VARCHAR2(32)
 PO_DOCUMENT$zipCode                                NUMBER
 PO_DOCUMENT$SpecialInstructions                    VARCHAR2(8)
</code></pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-E0591013-535D-4B7F-B7D9-76A7B1BB0989__PROJECTINGSCALARFIELDSWITHAMINIMUMF-FE25ACC0">
                        <p class="titleinexample">Example 20-13 Projecting Scalar Fields With a Minimum Frequency as Virtual Columns</p>
                        <p>All scalar fields that occur in all (100%) of the documents are projected as virtual columns. The result is the same as that for <a href="json-dataguide.html#GUID-E0591013-535D-4B7F-B7D9-76A7B1BB0989__PROJECTINGALLSCALARFIELDSNOTUNDERAN-FE25A770">Example 20-12</a>, except that fields <code class="codeph">AllowPartialShipment</code> and <code class="codeph">Phone</code> are not projected, because they do not occur in 100% of the documents.
                        </p>
                        <p>(Columns whose names are <span class="italic"><code class="codeph">italic</code></span> in the <code class="codeph">describe</code> command output are those that have been renamed using PL/SQL procedure <code class="codeph">DBMS_JSON.rename_column</code>.)
                        </p><pre class="pre codeblock"><code>EXEC DBMS_JSON.add_virtual_columns('J_PURCHASEORDER', 'PO_DOCUMENT', 100);

DESCRIBE j_purchaseorder;
 Name                                      Null?    Type
 ----------------------------------------- -------- ----------------------------
 ID                                        NOT NULL RAW(16)
 DATE_LOADED                                        TIMESTAMP(6) WITH TIME ZONE
 PO_DOCUMENT                                        CLOB
 PO_DOCUMENT$User                                   VARCHAR2(8)
 <span class="italic">PONumber</span>                                           NUMBER
 PO_DOCUMENT$Reference                              VARCHAR2(16)
 PO_DOCUMENT$Requestor                              VARCHAR2(16)
 PO_DOCUMENT$CostCenter                             VARCHAR2(4)
 PO_DOCUMENT$name                                   VARCHAR2(16)
 PO_DOCUMENT$city                                   VARCHAR2(32)
 PO_DOCUMENT$state                                  VARCHAR2(2)
 PO_DOCUMENT$street                                 VARCHAR2(32)
 PO_DOCUMENT$country                                VARCHAR2(32)
 PO_DOCUMENT$zipCode                                NUMBER
 PO_DOCUMENT$SpecialInstructions                    VARCHAR2(8)</code></pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-E0591013-535D-4B7F-B7D9-76A7B1BB0989__PROJECTINGSCALARFIELDSWITHAMINIMUMF-FE25AF56">
                        <p class="titleinexample">Example 20-14 Projecting Scalar Fields With a Minimum Frequency as Hidden Virtual Columns</p>
                        <p>The result is the same as that for <a href="json-dataguide.html#GUID-E0591013-535D-4B7F-B7D9-76A7B1BB0989__PROJECTINGSCALARFIELDSWITHAMINIMUMF-FE25ACC0">Example 20-13</a>, except that all of the added virtual columns are <span class="italic">hidden</span>. (The query of view <code class="codeph">USER_TAB_COLUMNS</code> shows that the virtual columns were in fact added.)
                        </p><pre class="pre codeblock"><code>EXEC DBMS_JSON.add_virtual_columns('J_PURCHASEORDER', 'PO_DOCUMENT', 100, <span class="bold">TRUE</span>);

DESCRIBE j_purchaseorder;
 Name                                      Null?    Type
 ----------------------------------------- -------- ----------------------------
 ID                                        NOT NULL RAW(16)
 DATE_LOADED                                        TIMESTAMP(6) WITH TIME ZONE
 PO_DOCUMENT                                        CLOB

SELECT column_name FROM user_tab_columns
  WHERE table_name = 'J_PURCHASEORDER'
  ORDER BY 1;

COLUMN_NAME
-----------
DATE_LOADED
ID
PONumber
PO_DOCUMENT
PO_DOCUMENT$CostCenter
PO_DOCUMENT$Reference
PO_DOCUMENT$Requestor
PO_DOCUMENT$SpecialInstructions
PO_DOCUMENT$User
PO_DOCUMENT$city
PO_DOCUMENT$country
PO_DOCUMENT$name
PO_DOCUMENT$state
PO_DOCUMENT$street
PO_DOCUMENT$zipCode
</code></pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="json-dataguide.html#GUID-7AEF436C-B743-4BA1-B6D4-1F1B98E26DB1" title="Based on data-guide information for a JSON column, you can project scalar fields from that JSON data as virtual columns in the same table. The scalar fields projected are those that are not under an array.">Adding and Dropping Virtual Columns For JSON Fields Based on Data-Guide Information</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-3526B063-FCD8-4F78-94E4-1A2E07F115E1" name="GUID-3526B063-FCD8-4F78-94E4-1A2E07F115E1"></a><h4 id="ADJSN-GUID-3526B063-FCD8-4F78-94E4-1A2E07F115E1" class="sect4"><span class="enumeration_section">20.8.3 </span>Dropping Virtual Columns for JSON Fields Based on Data-Guide Information
                  </h4>
                  <div>
                     <p>You can use procedure <code class="codeph">DBMS_JSON.drop_virtual_columns</code> to drop all virtual columns that were added for JSON fields in a column of JSON data.
                     </p>
                     <div class="section">Procedure <code class="codeph">DBMS_JSON.drop_virtual_columns</code> drops all virtual columns that were projected from fields in a given JSON column by an invocation of <code class="codeph">add_virtual_columns</code> or by data-guide change-trigger procedure <code class="codeph">add_vc</code>. <a href="json-dataguide.html#GUID-3526B063-FCD8-4F78-94E4-1A2E07F115E1__GUID-BAEAF3D3-85C1-44D6-8805-D2E94F3DBFFF">Example 20-15</a> illustrates this for fields projected from column <code class="codeph">po_document</code> of table <code class="codeph">j_purchaseorder</code>.
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-3526B063-FCD8-4F78-94E4-1A2E07F115E1__GUID-6D04D9AF-32E6-4CFB-86ED-CEDC3CF32B43">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=ARPLS-GUID-69DD0940-58EA-48D8-A635-097A6BA7A31B" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a>  for information about <code class="codeph">DBMS_JSON.add_virtual_columns</code></p>
                              </li>
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=ARPLS-GUID-119D090B-A309-4A2F-887F-A40B4266D68C" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a>  for information about <code class="codeph">DBMS_JSON.drop_virtual_columns</code></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-3526B063-FCD8-4F78-94E4-1A2E07F115E1__GUID-BAEAF3D3-85C1-44D6-8805-D2E94F3DBFFF">
                        <p class="titleinexample">Example 20-15 Dropping Virtual Columns Projected From JSON Fields</p><pre class="pre codeblock"><code>EXEC DBMS_JSON.drop_virtual_columns('J_PURCHASEORDER', 'PO_DOCUMENT');</code></pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="json-dataguide.html#GUID-7AEF436C-B743-4BA1-B6D4-1F1B98E26DB1" title="Based on data-guide information for a JSON column, you can project scalar fields from that JSON data as virtual columns in the same table. The scalar fields projected are those that are not under an array.">Adding and Dropping Virtual Columns For JSON Fields Based on Data-Guide Information</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
            <div class="sect2"><a id="GUID-2F4C6F52-0D96-4405-8F85-CDA0B234D0D5" name="GUID-2F4C6F52-0D96-4405-8F85-CDA0B234D0D5"></a><h3 id="ADJSN-GUID-2F4C6F52-0D96-4405-8F85-CDA0B234D0D5" class="sect3"><span class="enumeration_section">20.9 </span>Change Triggers For Data Guide-Enabled Search Index
               </h3>
               <div>
                  <p>When JSON data changes, some information in a data guide-enabled JSON search index is automatically updated. You can specify a procedure whose invocation is triggered whenever this happens. You can define your own PL/SQL procedure for this, or you can use the predefined change-trigger procedure <code class="codeph">add_vc</code>.
                  </p>
                  <p>The data-guide information in a data guide-enabled JSON search index records structure, type, and possibly statistical information about a set of JSON documents. Except for the statistical information, which is updated only when you gather statistics, relevant changes in the document set are automatically reflected in the data-guide information stored in the index.</p>
                  <p>You can define a PL/SQL procedure whose invocation is automatically triggered by such an index update. The invocation occurs when the index is updated. Any errors that occur during the execution of the procedure are ignored.</p>
                  <p>You can use the predefined change-trigger procedure <code class="codeph">add_vc</code> to automatically add virtual columns that project JSON fields from the document set or to modify existing such columns, as needed. The virtual columns added by <code class="codeph">add_vc</code> follow the same naming rules as those you add by invoking procedure <code class="codeph">DBMS_JSON.add_virtual_columns</code> for a JSON column that has a data guide-enabled search index.
                  </p>
                  <p>In either case, any error that occurs during the execution of the procedure is <span class="italic">ignored</span>.
                  </p>
                  <p>Unlike <code class="codeph">DBMS_JSON.add_virtual_columns</code>, <code class="codeph">add_vc</code> does <span class="italic">not</span> first drop any existing virtual columns that were projected from fields in the same JSON column. To drop virtual columns projected from fields in the same JSON column by <code class="codeph">add_vc</code> or by <code class="codeph">add_virtual_columns</code>, use procedure <code class="codeph">DBMS_JSON.drop_virtual_columns</code>.
                  </p>
                  <p>You specify the use of a trigger for data-guide changes by using the keywords <span class="bold"><code class="codeph">DATAGUIDE ON CHANGE</code></span> in the <code class="codeph">PARAMETERS</code> clause when you create or alter a JSON search index. Only one change trigger is allowed per index: altering an index to specify a trigger automatically replaces any previous trigger for it.
                  </p>
                  <p><a href="json-dataguide.html#GUID-2F4C6F52-0D96-4405-8F85-CDA0B234D0D5__GUID-19F6555A-1E4A-4E71-9E62-B613C25F367E">Example 20-16</a> alters existing JSON search index <code class="codeph">po_search_idx</code> to use procedure <code class="codeph">add_vc</code>.
                  </p>
                  <div class="example" id="GUID-2F4C6F52-0D96-4405-8F85-CDA0B234D0D5__GUID-19F6555A-1E4A-4E71-9E62-B613C25F367E">
                     <p class="titleinexample">Example 20-16 Adding Virtual Columns Automatically With Change Trigger ADD_VC</p>
                     <p>This example adds predefined change trigger <code class="codeph">add_vc</code> to  JSON search index <code class="codeph">po_search_idx</code>.
                     </p>
                     <p>It first drops any existing virtual columns that were projected from fields in JSON column <code class="codeph">po_document</code> either by procedure <code class="codeph">DBMS_JSON.add_virtual_columns</code> or by a pre-existing <code class="codeph">add_vc</code> change trigger for the same JSON search index. 
                     </p>
                     <p>Then it alters the search index to add change trigger <code class="codeph">add_vc</code> (if it was already present then this is has no effect). 
                     </p>
                     <p>Finally, it inserts a new document that provokes a change in the data guide. Two virtual columns are added to the table, for the two scalar fields not under an array.</p><pre class="pre codeblock"><code>EXEC DBMS_JSON.drop_virtual_columns('J_PURCHASEORDER', 'PO_DOCUMENT');

ALTER INDEX po_search_idx REBUILD PARAMETERS ('<span class="bold">DATAGUIDE ON CHANGE add_vc</span>');

INSERT INTO j_purchaseorder
  VALUES (
    SYS_GUID(),
    to_date('30-JUN-2015'),
    '{"<span class="bold">PO_Number</span>"     : 4230,
      "<span class="bold">PO_Reference</span>"  : "JDEER-20140421",
      "PO_LineItems"  : [{"Part_Number"  : 230912362345,
                          "Quantity"     : 3.0}]}');

DESCRIBE j_purchaseorder;
 Name                      Null?    Type
 ------------------------- -------- ----------------------------
 ID                        NOT NULL RAW(16)
 DATE_LOADED                        TIMESTAMP(6) WITH TIME ZONE
 PO_DOCUMENT                        CLOB
 <span class="bold">PO_DOCUMENT$PO_Number</span>              NUMBER
 <span class="bold">PO_DOCUMENT$PO_Reference</span>           VARCHAR2(16)
</code></pre></div>
                  <!-- class="example" -->
                  <div class="section"></div>
                  <!-- class="section" -->
                  <div class="section"></div>
                  <!-- class="section" -->
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="json-dataguide.html#GUID-EC076D41-D096-42A9-BCCA-AD894637FB5A">User-Defined Data-Guide Change Triggers</a><br>You can define a procedure whose invocation is triggered automatically whenever a given data guide-enabled JSON search index is updated. Any errors that occur during the execution of the procedure are ignored.
                     </li>
                  </ul>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="json-dataguide.html#GUID-7AEF436C-B743-4BA1-B6D4-1F1B98E26DB1" title="Based on data-guide information for a JSON column, you can project scalar fields from that JSON data as virtual columns in the same table. The scalar fields projected are those that are not under an array.">Adding and Dropping Virtual Columns For JSON Fields Based on Data-Guide Information</a></li>
                     </ul>
                  </div>
                  <div class="infoboxnotealso" id="GUID-2F4C6F52-0D96-4405-8F85-CDA0B234D0D5__NOTE-1431-FA89FE6B">
                     <p class="notep1">See Also:</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=ARPLS-GUID-69DD0940-58EA-48D8-A635-097A6BA7A31B" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a>  for information about <code class="codeph">DBMS_JSON.add_virtual_columns</code></p>
                        </li>
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=ARPLS-GUID-119D090B-A309-4A2F-887F-A40B4266D68C" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a>  for information about <code class="codeph">DBMS_JSON.drop_virtual_columns</code></p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="json-dataguide.html#GUID-219FC30E-89A7-4189-BC36-7B961A24067C" title="A JSON data guide lets you discover information about the structure and content of JSON documents stored in Oracle Database.">JSON Data Guide</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="sect3"><a id="GUID-EC076D41-D096-42A9-BCCA-AD894637FB5A" name="GUID-EC076D41-D096-42A9-BCCA-AD894637FB5A"></a><h4 id="ADJSN-GUID-EC076D41-D096-42A9-BCCA-AD894637FB5A" class="sect4"><span class="enumeration_section">20.9.1 </span>User-Defined Data-Guide Change Triggers
                  </h4>
                  <div>
                     <p>You can define a procedure whose invocation is triggered automatically whenever a given data guide-enabled JSON search index is updated. Any errors that occur during the execution of the procedure are ignored.</p>
                     <p><a href="json-dataguide.html#GUID-EC076D41-D096-42A9-BCCA-AD894637FB5A__GUID-386295CD-EA82-43AC-B168-02F53386320E">Example 20-17</a> illustrates this.
                     </p>
                     <p>A user-defined procedure specified with keywords <code class="codeph">DATAGUIDE ON CHANGE</code> in a JSON search index <code class="codeph">PARAMETERS</code> clause must accept the parameters specified in <a href="json-dataguide.html#GUID-EC076D41-D096-42A9-BCCA-AD894637FB5A__PARAMETERSOFAUSER-DEFINEDDATAGUIDEC-FE29B6E5" title="This three-column table shows the parameters that must be accepted by a user-defined PL/SQL procedure that is used as a data-guide change trigger. Column 1 is the parameter name. Column 2 is the SQL type of the parameter. Column 3 is a description of the parameter.">Table 20-5</a>.
                     </p>
                     <div class="tblformal" id="GUID-EC076D41-D096-42A9-BCCA-AD894637FB5A__PARAMETERSOFAUSER-DEFINEDDATAGUIDEC-FE29B6E5">
                        <p class="titleintable">Table 20-5 Parameters of a User-Defined Data-Guide Change Trigger Procedure</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="Parameters of a User-Defined Data-Guide Change Trigger Procedure" border="1" summary="This three-column table shows the parameters that must be accepted by a user-defined PL/SQL procedure that is used as a data-guide change trigger. Column 1 is the parameter name. Column 2 is the SQL type of the parameter. Column 3 is a description of the parameter." frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" id="d23217e3889">Name</th>
                                 <th align="left" valign="bottom" id="d23217e3891">Type</th>
                                 <th align="left" valign="bottom" id="d23217e3893">Description</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d23217e3897" headers="d23217e3889 "><code class="codeph">table_name</code></td>
                                 <td align="left" valign="top" headers="d23217e3897 d23217e3891 "><code class="codeph">VARCHAR2</code></td>
                                 <td align="left" valign="top" headers="d23217e3897 d23217e3893 ">Name of the table containing column <code class="codeph">column_name</code>.
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d23217e3909" headers="d23217e3889 "><code class="codeph">column_name</code></td>
                                 <td align="left" valign="top" headers="d23217e3909 d23217e3891 "><code class="codeph">VARCHAR2</code></td>
                                 <td align="left" valign="top" headers="d23217e3909 d23217e3893 ">Name of a JSON column that has a data guide-enabled JSON search index.</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d23217e3918" headers="d23217e3889 "><code class="codeph">path</code></td>
                                 <td align="left" valign="top" headers="d23217e3918 d23217e3891 "><code class="codeph">VARCHAR2</code></td>
                                 <td align="left" valign="top" headers="d23217e3918 d23217e3893 ">A SQL/JSON path expression that targets a particular field in the data in column <code class="codeph">column_name</code>. This path is affected by the index change that triggered the procedure invocation. For example, the index change involved adding this path or changing its type value or its type-length value.
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d23217e3930" headers="d23217e3889 "><code class="codeph">new_type</code></td>
                                 <td align="left" valign="top" headers="d23217e3930 d23217e3891 "><code class="codeph">NUMBER</code></td>
                                 <td align="left" valign="top" headers="d23217e3930 d23217e3893 ">A new type for the given path.</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d23217e3939" headers="d23217e3889 "><code class="codeph">new_type_length</code></td>
                                 <td align="left" valign="top" headers="d23217e3939 d23217e3891 "><code class="codeph">NUMBER</code></td>
                                 <td align="left" valign="top" headers="d23217e3939 d23217e3893 ">A new type length for the given path.</td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <div class="example" id="GUID-EC076D41-D096-42A9-BCCA-AD894637FB5A__GUID-386295CD-EA82-43AC-B168-02F53386320E">
                        <p class="titleinexample">Example 20-17 Tracing Data-Guide Updates With a User-Defined Change Trigger</p>
                        <p>This example first drops any existing virtual columns projected from fields in JSON column <code class="codeph">po_document</code>. 
                        </p>
                        <p>It then defines PL/SQL procedure <code class="codeph">my_dataguide_trace</code>, which prints the names of the table and JSON column, together with the path, type and length fields of the added virtual column. It then alters JSON search index <code class="codeph">po_search_idx</code> to specify that this procedure be invoked as a change trigger for updates to the data-guide information in the index.
                        </p>
                        <p>It then inserts a new document that provokes a change in the data guide, which triggers the output of trace information.</p>
                        <p>Note that the <code class="codeph">TYPE</code> argument to the procedure must be a number that is one of the <code class="codeph">DBMS_JSON</code> constants for a JSON type. The procedure tests the argument and outputs a user-friendly string in place of the number.
                        </p><pre class="pre codeblock"><code>EXEC DBMS_JSON.drop_virtual_columns('J_PURCHASEORDER', 'PO_DOCUMENT');

CREATE OR REPLACE PROCEDURE <span class="bold">my_dataguide_trace</span>(tableName VARCHAR2,
                                               jcolName  VARCHAR2,
                                               path      VARCHAR2,
                                               type      NUMBER,
                                               tlength   NUMBER)
  IS
    typename VARCHAR2(10);
  BEGIN
    IF    (type = DBMS_JSON.<span class="bold">TYPE_NULL</span>)    THEN typename := 'null';
    ELSIF (type = DBMS_JSON.<span class="bold">TYPE_BOOLEAN</span>) THEN typename := 'boolean';
    ELSIF (type = DBMS_JSON.<span class="bold">TYPE_NUMBER</span>)  THEN typename := 'number';
    ELSIF (type = DBMS_JSON.<span class="bold">TYPE_STRING</span>)  THEN typename := 'string';
    ELSIF (type = DBMS_JSON.<span class="bold">TYPE_OBJECT</span>)  THEN typename := 'object';
    ELSIF (type = DBMS_JSON.<span class="bold">TYPE_ARRAY</span>)   THEN typename := 'array';
    ELSE                                       typename := 'unknown';
    END IF;
    DBMS_OUTPUT.put_line('Updating ' || tableName || '(' || jcolName
                         || '): Path = ' || path || ', Type = ' || type
                         || ', Type Name = ' || typename
                         || ', Type Length = ' || tlength);
  END;
/

ALTER INDEX po_search_idx REBUILD
  PARAMETERS ('<span class="bold">DATAGUIDE ON CHANGE my_dataguide_trace</span>');

INSERT INTO j_purchaseorder
  VALUES (
    SYS_GUID(),
    to_date('30-MAR-2016'),
    '{"PO_ID"     : 4230,
      "PO_Ref"  : "JDEER-20140421",
      "PO_Items"  : [{"Part_No"       : 98981327234,
                      "Item_Quantity" : 13}]}');

COMMIT;
Updating J_PURCHASEORDER(PO_DOCUMENT):
  Path = <span class="bold">$.PO_ID</span>, Type = 3, Type Name = <span class="bold">number</span>, Type Length = 4
Updating J_PURCHASEORDER(PO_DOCUMENT):
  Path = <span class="bold">$.PO_Ref</span>, Type = 4, Type Name = <span class="bold">string</span>, Type Length = 16
Updating J_PURCHASEORDER(PO_DOCUMENT):
  Path = <span class="bold">$.PO_Items</span>, Type = 6, Type Name = <span class="bold">array</span>, Type Length = 64
Updating J_PURCHASEORDER(PO_DOCUMENT):
  Path = <span class="bold">$.PO_Items.Part_No</span>, Type = 3, Type Name = <span class="bold">number</span>, Type Length = 16
Updating J_PURCHASEORDER(PO_DOCUMENT):
  Path = <span class="bold">$.PO_Items.Item_Quantity</span>, Type = 3, Type Name = <span class="bold">number</span>, Type Length = 2

Commit complete.

</code></pre></div>
                     <!-- class="example" -->
                     <div class="section"></div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-EC076D41-D096-42A9-BCCA-AD894637FB5A__GUID-6E95FB6E-5396-463A-B9BF-6A8B03D550B7">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=ARPLS-GUID-F9032949-7FE1-4A31-AA4B-4A2775F0CBE6" target="_blank"><span><cite>Oracle Database SQL Language Reference</cite></span></a> for information about PL/SQL constants <code class="codeph">TYPE_NULL</code>, <code class="codeph">TYPE_BOOLEAN</code>, <code class="codeph">TYPE_NUMBER</code>, <code class="codeph">TYPE_STRING</code>, <code class="codeph">TYPE_OBJECT</code>, and <code class="codeph">TYPE_ARRAY</code>.
                              </p>
                           </li>
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=ARPLS-GUID-119D090B-A309-4A2F-887F-A40B4266D68C" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> for information about <code class="codeph">DBMS_JSON.drop_virtual_columns</code></p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="json-dataguide.html#GUID-2F4C6F52-0D96-4405-8F85-CDA0B234D0D5" title="When JSON data changes, some information in a data guide-enabled JSON search index is automatically updated. You can specify a procedure whose invocation is triggered whenever this happens. You can define your own PL/SQL procedure for this, or you can use the predefined change-trigger procedure add_vc.">Change Triggers For Data Guide-Enabled Search Index</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
            <div class="sect2"><a id="GUID-BD147159-87A7-4AAC-B150-44E3F10A81E1" name="GUID-BD147159-87A7-4AAC-B150-44E3F10A81E1"></a><h3 id="ADJSN-GUID-BD147159-87A7-4AAC-B150-44E3F10A81E1" class="sect3"><span class="enumeration_section">20.10 </span>Multiple Data Guides Per Document Set
               </h3>
               <div>
                  <p>A data guide reflects the shape of a given set of JSON documents. If a JSON column contains different types of documents, with different structure or type information, you can create and use different data guides for the different kinds of documents.</p>
                  <div class="section">
                     <p class="subhead2" id="GUID-BD147159-87A7-4AAC-B150-44E3F10A81E1__GUID-C83F4337-C7CD-43DB-A1BE-24A3F316C7C7">Data Guides For Different Kinds of JSON Documents</p>
                     <p>JSON documents need not, and typically do not, follow a prescribed schema. This is true even for documents that are used similarly in a given application; they may differ in structural ways (shape), and field types may differ. </p>
                     <p>A JSON data guide summarizes the structural and type information of a given set of documents. In general, the more similar the structure and type information of the documents in a given set, the more useful the resulting data guide.</p>
                     <p>A data guide is created for a given column of JSON data. If the column contains very different kinds of documents (for example, purchase orders and health records) then a single data guide for the column is likely to be of limited use.</p>
                     <p>One way to address this concern is to put different kinds of JSON documents in different JSON columns. But sometimes other considerations decide in favor of mixing document types in the same column.</p>
                     <p>In addition, documents of the same general type, which you decide to store in the same column, can nevertheless differ in relatively systematic ways. This includes the case of <span class="italic">evolving</span> document shape and type information. For example, the structure of tax-information documents could change from year to year.
                     </p>
                     <p>When you create a data guide you can decide which information to summarize. And you can thus create different data guides for the same JSON column, to represent different subsets of the document set.</p>
                     <p>An additional aid in this regard is to have a separate, non-JSON, column in the same table, which is used to label, or categorize, the documents in a JSON column.</p>
                     <p>In the case of the purchase-order documents used in our examples, let’s suppose that their structure can evolve significantly from year to year, so that column <code class="codeph">date_loaded</code> of table <code class="codeph">j_purchaseorder</code> can be used to group them into subsets of reasonably similar shape. <a href="json-dataguide.html#GUID-BD147159-87A7-4AAC-B150-44E3F10A81E1__ADDINGA2015PURCHASE-ORDERDOCUMENT-FC010862">Example 20-18</a> adds a purchase-order document for 2015, and <a href="json-dataguide.html#GUID-BD147159-87A7-4AAC-B150-44E3F10A81E1__ADDINGA2016PURCHASE-ORDERDOCUMENT-FC010487">Example 20-19</a> adds a purchase-order document for 2016. (Compare with the documents for 2014, which are added in <a href="creating-a-table-with-a-json-column.html#GUID-E6CC0DCF-3D72-41EF-ACA4-B3BF54EE3CA0__CACCIEFA">Example 4-2</a>.)
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-BD147159-87A7-4AAC-B150-44E3F10A81E1__GUID-2371E2EC-A702-4B2D-BE00-2090B31251F7">Using a SQL Aggregate Function to Create Multiple Data Guides</p>
                     <p>Oracle SQL function <code class="codeph">json_dataguide</code> is in fact an <span class="italic">aggregate</span> function. An aggregate function returns a single result row based on groups of rows, rather than on a single row. It is typically used in a <code class="codeph">SELECT</code> list for a query that has a <code class="codeph">GROUP BY</code> clause, which divides the rows of a queried table or view into groups. The aggregate function applies to each group of rows, returning a single result row for each group. For example, aggregate function <code class="codeph">avg</code> returns the average  of a group of values.
                     </p>
                     <p>Function  <code class="codeph">json_dataguide</code> aggregates JSON data to produce a summary, or specification, of it, which is returned in the form of a JSON document. In other words, for each group of JSON documents to which they are applied, they return a data guide. 
                     </p>
                     <p>If you omit <code class="codeph">GROUP BY</code> then this function returns a single data guide that summarizes all of the JSON data in the subject JSON column. 
                     </p>
                     <p><a href="json-dataguide.html#GUID-BD147159-87A7-4AAC-B150-44E3F10A81E1__USINGJSON_DATAGUIDETOCREATEMULTIPLE-FC088B94">Example 20-20</a> queries the documents of JSON column <code class="codeph">po_document</code>, grouping them to produce three data guides, one for each year of column <code class="codeph">date_loaded</code>. 
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-BD147159-87A7-4AAC-B150-44E3F10A81E1__ADDINGA2015PURCHASE-ORDERDOCUMENT-FC010862">
                     <p class="titleinexample">Example 20-18 Adding a 2015 Purchase-Order Document</p>
                     <p>The 2015 purchase-order format uses only part number, reference, and line-items as its top-level fields, and these fields use prefix <code class="codeph">PO_</code>. Each line item contains only a part number and a quantity.
                     </p><pre class="pre codeblock"><code>INSERT INTO j_purchaseorder
  VALUES (
    SYS_GUID(),
    to_date('30-JUN-<span class="bold">2015'</span>),
    '{"PO_Number"     : 4230,
      "PO_Reference"  : "JDEER-20140421",
      "PO_LineItems"  : [{"Part_Number"  : 230912362345,
                          "Quantity"     : 3.0}]}');
</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-BD147159-87A7-4AAC-B150-44E3F10A81E1__ADDINGA2016PURCHASE-ORDERDOCUMENT-FC010487">
                     <p class="titleinexample">Example 20-19 Adding a 2016 Purchase-Order Document</p>
                     <p>The 2016 format uses <code class="codeph">PO_ID</code> instead of <code class="codeph">PO_Number</code>, <code class="codeph">PO_Ref</code> instead of <code class="codeph">PO_Reference</code>, <code class="codeph">PO_Items</code> instead of <code class="codeph">PO_LineItems</code>, <code class="codeph">Part_No</code> instead of <code class="codeph">Part_Number</code>, and <code class="codeph">Item_Quantity</code> instead of <code class="codeph">Quantity</code>.
                     </p><pre class="pre codeblock"><code>INSERT INTO j_purchaseorder
  VALUES (
    SYS_GUID(),
    to_date('30-MAR-<span class="bold">2016'</span>),
    '{"PO_ID"     : 4230,
      "PO_Ref"  : "JDEER-20140421",
      "PO_Items"  : [{"Part_No"       : 98981327234,
                      "Item_Quantity" : 13}]}');
</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-BD147159-87A7-4AAC-B150-44E3F10A81E1__USINGJSON_DATAGUIDETOCREATEMULTIPLE-FC088B94">
                     <p class="titleinexample">Example 20-20 Creating Multiple Data Guides With Aggregate Function JSON_DATAGUIDE</p>
                     <p>This example uses aggregate SQL function <code class="codeph">json_dataguide</code> to obtain three flat<a id="fn_1" name="fn_1" href="#fn_1" data="" if="" function="" json_dataguide="" were="" passed="" dbms_json.format_hierarchical="" as="" optional="" second="" argument="" then="" the="" result="" would="" be="" three="" hierarchical="" guides=")" ="" onclick="footdisplay(1, "><sup>Foot 1</sup></a> data guides, one for each year-specific format. The data guide for 2014 is shown only partially — it is the same as the data guide from <a href="json-dataguide.html#GUID-12BCFCCE-18AE-4CB2-8710-EC7B712DA089" title="The fields of a sample flat data guide are described. It corresponds to a set of purchase-order documents.">A Flat Data Guide For Purchase-Order Documents</a>, except that no statistics fields are present. (Data guides returned by functions <code class="codeph">json_dataguide</code> do not contain any statistics fields.
                     </p><pre class="pre codeblock"><code>SELECT extract(YEAR FROM date_loaded), json_dataguide(po_document)
  FROM j_purchaseorder
  <span class="bold">GROUP BY</span> extract(<span class="bold">YEAR</span> FROM <span class="bold">date_loaded</span>)
  ORDER BY extract(YEAR FROM date_loaded) DESC;

EXTRACT(YEARFROMDATE_LOADED)
----------------------------
JSON_DATAGUIDE(PO_DOCUMENT)
---------------------------
                        <span class="bold">2016</span>
[
  {
    "o:path" : "$.PO_ID",
    "type" : "number",
    "o:length" : 4
  },
  {
    "o:path" : "$.PO_Ref",
    "type" : "string",
    "o:length" : 16
  },
  {
    "o:path" : "$.PO_Items",
    "type" : "array",
    "o:length" : 64
  },
  {
    "o:path" : "$.PO_Items.Part_No",
    "type" : "number",
    "o:length" : 16
  },
  {
    "o:path" : "$.PO_Items.Item_Quantity",
    "type" : "number",
    "o:length" : 2
  }
]

                        <span class="bold">2015</span>
[
  {
    "o:path" : "$.PO_Number",
    "type" : "number",
    "o:length" : 4
  },
  {
    "o:path" : "$.PO_LineItems",
    "type" : "array",
    "o:length" : 64
  },
  {
    "o:path" : "$.PO_LineItems.Quantity",
    "type" : "number",
    "o:length" : 4
  },
  {
    "o:path" : "$.PO_LineItems.Part_Number",
    "type" : "number",
    "o:length" : 16
  },
  {
    "o:path" : "$.PO_Reference",
    "type" : "string",
    "o:length" : 16
  }
]

                        <span class="bold">2014</span>
[
  {
    "o:path" : "$.User",
    "type" : "string",
    "o:length" : 8
  },
  {
    "o:path" : "$.PONumber",
    "type" : "number",
    "o:length" : 4
  },
...
  {
    "o:path" : "$.\"Special Instructions\"",
    "type" : "string",
    "o:length" : 8
  }
]

3 rows selected.</code></pre></div>
                  <!-- class="example" -->
                  <div class="section"></div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-BD147159-87A7-4AAC-B150-44E3F10A81E1__GUID-C5A6C50E-9E20-4C4D-8F20-8DCEAF6725F2">
                     <p class="notep1">See Also:</p>
                     <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=SQLRF-GUID-4CF32887-0F46-4925-8381-AE2B74343933" target="_blank"><span><cite>Oracle Database SQL Language Reference</cite></span></a> for information about SQL function <code class="codeph">json_dataguide</code></p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="json-dataguide.html#GUID-219FC30E-89A7-4189-BC36-7B961A24067C" title="A JSON data guide lets you discover information about the structure and content of JSON documents stored in Oracle Database.">JSON Data Guide</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-32ED8EE8-FC3E-406E-8AD6-652BB5A1D510" name="GUID-32ED8EE8-FC3E-406E-8AD6-652BB5A1D510"></a><h3 id="ADJSN-GUID-32ED8EE8-FC3E-406E-8AD6-652BB5A1D510" class="sect3"><span class="enumeration_section">20.11 </span>Querying a Data Guide
               </h3>
               <div>
                  <p>A data guide is information about a set of JSON documents. You can query it from a flat data guide that you obtain using either Oracle SQL function <code class="codeph">json_dataguide</code> or PL/SQL function <code class="codeph">DBMS_JSON.get_index_dataguide</code>. In the latter case, a data guide-enabled JSON search index must be defined on the JSON data.
                  </p>
                  <div class="section">
                     <div class="infoboxnotealso" id="GUID-32ED8EE8-FC3E-406E-8AD6-652BB5A1D510__GUID-5B77088D-F916-40F8-8A14-BB174BAF938A">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=SQLRF-GUID-4CF32887-0F46-4925-8381-AE2B74343933" target="_blank"><span><cite>Oracle Database SQL Language Reference</cite></span></a> for information about SQL function <code class="codeph">json_dataguide</code></p>
                           </li>
                           <li>
                              <p><a href="../sqlrf/JSON_TABLE.html#SQLRF-GUID-3C8E63B5-0B94-4E86-A2D3-3D4831B67C62" target="_blank"><span><cite>Oracle Database SQL Language Reference</cite></span></a> for information about SQL/JSON function <code class="codeph">json_table</code></p>
                           </li>
                           <li>
                              <p><a href="../arpls/DBMS_JSON.html#ARPLS-GUID-52B63CEE-669C-46FB-A276-56F7C6ECD036" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> for information about <code class="codeph">DBMS_JSON.get_index_dataguide</code></p>
                           </li>
                           <li>
                              <p><a href="../arpls/DBMS_JSON.html#ARPLS-GUID-F9032949-7FE1-4A31-AA4B-4A2775F0CBE6" target="_blank"><span><cite>Oracle Database SQL Language Reference</cite></span></a> for information about PL/SQL constant <code class="codeph">DBMS_JSON.FORMAT_FLAT</code></p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-32ED8EE8-FC3E-406E-8AD6-652BB5A1D510__QUERYINGADATAGUIDEOBTAINEDUSINGJSON-FE1C6AE0">
                     <p class="titleinexample">Example 20-21 Querying a Data Guide Obtained Using JSON_DATAGUIDE</p>
                     <p>This example uses SQL/JSON function <code class="codeph">json_dataguide</code> to obtain a flat data guide. It then queries the relational columns projected on the fly by SQL/JSON function <code class="codeph">json_table</code> from fields <code class="codeph">o:path</code>, <code class="codeph">type</code>, and <code class="codeph">o:length</code>. It returns the projected columns ordered lexicographically by the path column created, <code class="codeph">jpath</code>.
                     </p><pre class="pre codeblock"><code>WITH dg_t AS (SELECT <span class="bold">json_dataguide</span>(po_document) dg_doc FROM j_purchaseorder)
  SELECT jt.*
    FROM dg_t,
         json_table(<span class="bold">dg_doc</span>, '<span class="bold">$[*]</span>'
           COLUMNS
             <span class="bold">jpath</span>   VARCHAR2(40) PATH '$."o:path"',
             type    VARCHAR2(10) PATH '$."type"',
             tlength NUMBER       PATH '$."o:length"') <span class="bold">jt</span>
   ORDER BY <span class="bold">jt.jpath</span>;

JPATH                                    TYPE          TLENGTH
---------------------------------------- ------------- -------
$."Special Instructions"                 string              8
$.AllowPartialShipment                   boolean             4
$.CostCenter                             string              4
$.LineItems                              array             512
$.LineItems.ItemNumber                   number              1
$.LineItems.Part                         object            128
$.LineItems.Part.Description             string             32
$.LineItems.Part.UPCCode                 number             16
$.LineItems.Part.UnitPrice               number              8
$.LineItems.Quantity                     number              4
$.PONumber                               number              4
$.PO_LineItems                           array              64
$.Reference                              string             16
$.Requestor                              string             16
$.ShippingInstructions                   object            256
$.ShippingInstructions.Address           object            128
$.ShippingInstructions.Address.city      string             32
$.ShippingInstructions.Address.country   string             32
$.ShippingInstructions.Address.state     string              2
$.ShippingInstructions.Address.street    string             32
$.ShippingInstructions.Address.zipCode   number              8
$.ShippingInstructions.Phone             array             128
$.ShippingInstructions.Phone             string             16
$.ShippingInstructions.Phone.number      string             16
$.ShippingInstructions.Phone.type        string              8
$.ShippingInstructions.name              string             16
$.User                                   string              8
</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-32ED8EE8-FC3E-406E-8AD6-652BB5A1D510__QUERYINGADATAGUIDEFORPATHSWITHFREQU-FE1C38EB">
                     <p class="titleinexample">Example 20-22 Querying a Data Guide With Index Data For Paths With Frequency at Least 80%</p>
                     <p>This example uses PL/SQL function <code class="codeph">DBMS_JSON.get_index_dataguide</code> with format value <code class="codeph">DBMS_JSON.FORMAT_FLAT</code> to obtain a flat data guide from the data-guide information stored in a data guide-enabled JSON search index. It then queries the relational columns projected on the fly from fields <code class="codeph">o:path</code>, <code class="codeph">type</code>, <code class="codeph">o:length</code>, and <code class="codeph">o:frequency</code> by SQL/JSON function <code class="codeph">json_table</code>.
                     </p>
                     <p>The value of field <code class="codeph">o:frequency</code> is a statistic that records the frequency of occurrence, across the document set, of each field in a document. It is available <span class="italic">only if you have gathered statistics</span> on the document set. The frequency of a given field is the number of documents containing that field divided by the total number of documents in the JSON column, expressed as a percentage.
                     </p><pre class="pre codeblock"><code>WITH dg_t AS (SELECT DBMS_JSON.<span class="bold">get_index_dataguide</span>('J_PURCHASEORDER',
                                                   'PO_DOCUMENT',
                                                   DBMS_JSON.<span class="bold">FORMAT_FLAT</span>) <span class="bold">dg_doc
</span>                FROM DUAL)
 SELECT jt.*
   FROM dg_t,
        <span class="bold">json_table</span>(<span class="bold">dg_doc</span>, '<span class="bold">$[*]</span>'
          COLUMNS
            jpath     VARCHAR2(40) PATH '$."o:path"',
            type      VARCHAR2(10) PATH '$."type"',
            tlength   NUMBER       PATH '$."o:length"',
            <span class="bold">frequency</span> NUMBER       PATH '$."o:frequency"') <span class="bold">jt</span>
   WHERE <span class="bold">jt.frequency &gt; 80</span>;

JPATH                                    TYPE          TLENGTH  FREQUENCY
---------------------------------------- ------------- -------- ---------
$.User                                   string              8        100
$.PONumber                               number              4        100
$.LineItems                              array             512        100
$.LineItems.Part                         object            128        100
$.LineItems.Part.UPCCode                 number             16        100
$.LineItems.Part.UnitPrice               number              8        100
$.LineItems.Part.Description             string             32        100
$.LineItems.Quantity                     number              4        100
$.LineItems.ItemNumber                   number              1        100
$.Reference                              string             16        100
$.Requestor                              string             16        100
$.CostCenter                             string              4        100
$.ShippingInstructions                   object            256        100
$.ShippingInstructions.name              string             16        100
$.ShippingInstructions.Address           object            128        100
$.ShippingInstructions.Address.city      string             32        100
$.ShippingInstructions.Address.state     string              2        100
$.ShippingInstructions.Address.street    string             32        100
$.ShippingInstructions.Address.country   string             32        100
$.ShippingInstructions.Address.zipCode   number              8        100
$."Special Instructions"                 string              8        100
</code></pre></div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="json-dataguide.html#GUID-D8448CB1-0350-4848-B07E-9370B3B1A9BE" title="The predefined fields of a JSON data guide are described. They include JSON Schema fields (keywords) and Oracle-specific fields.">JSON Data-Guide Fields</a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="json-dataguide.html#GUID-219FC30E-89A7-4189-BC36-7B961A24067C" title="A JSON data guide lets you discover information about the structure and content of JSON documents stored in Oracle Database.">JSON Data Guide</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-12BCFCCE-18AE-4CB2-8710-EC7B712DA089" name="GUID-12BCFCCE-18AE-4CB2-8710-EC7B712DA089"></a><h3 id="ADJSN-GUID-12BCFCCE-18AE-4CB2-8710-EC7B712DA089" class="sect3"><span class="enumeration_section">20.12 </span>A Flat Data Guide For Purchase-Order Documents
               </h3>
               <div>
                  <p>The fields of a sample flat data guide are described. It corresponds to a set of purchase-order documents.</p>
                  <p>The only JSON Schema keyword used in a flat data guide is <code class="codeph"><span class="bold">type</span></code>. The other fields are all Oracle data-guide fields, which have prefix <code class="codeph"><span class="bold">o:</span></code>.
                  </p>
                  <p><a href="json-dataguide.html#GUID-12BCFCCE-18AE-4CB2-8710-EC7B712DA089__GUID-5B515937-780D-4D8D-86AF-74B13B44EC59">Example 20-23</a> shows a flat data guide for the purchase-order documents in table <code class="codeph">j_purchaseorder</code>. Things to note:
                  </p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>The values of <code class="codeph">o:preferred_column_name</code> use prefix <code class="codeph">PO_DOCUMENT$</code>. This prefix comes from using <code class="codeph">DBMS_JSON.get_index_dataguide</code> to obtain this data guide. 
                        </p>
                     </li>
                     <li>
                        <p>The value of <code class="codeph">o:length</code> is 8 for path <code class="codeph">$.User</code>, for example, in spite of the fact that the actual lengths of the field values are 5. This is because the value of <code class="codeph">o:length</code> is always a power of two.
                        </p>
                     </li>
                     <li>
                        <p>The value of <code class="codeph">o:path</code> for field <code class="codeph">Special Instructions</code> is wrapped in double quotation marks (<code class="codeph">"Special Instructions"</code>) because of the embedded space character.
                        </p>
                     </li>
                  </ul>
                  <div class="example" id="GUID-12BCFCCE-18AE-4CB2-8710-EC7B712DA089__GUID-5B515937-780D-4D8D-86AF-74B13B44EC59">
                     <p class="titleinexample">Example 20-23 Flat Data Guide For Purchase Orders </p>
                     <p>Paths are <span class="bold"><code class="codeph">bold</code></span>. JSON schema keywords are <span class="italic"><code class="codeph">italic</code></span>. Preferred column names that result from using <code class="codeph">DBMS_JSON.rename_column</code> are also <span class="italic"><code class="codeph">italic</code></span>. The formatting used is similar to that produced by using SQL/JSON function <code class="codeph">json_dataguide</code> with format arguments <code class="codeph">DBMS_JSON.FORMAT_FLAT</code> and <code class="codeph">DBMS_JSON.PRETTY</code>.
                     </p>
                     <p>Note that fields <code class="codeph">o:frequency</code>, <code class="codeph">o:low_value</code>, <code class="codeph">o:high_value</code>, <code class="codeph">o:num_nulls</code>, and <code class="codeph">o:last_analyzed</code> are present. This can only be because statistics were gathered on the document set. Their values reflect the state as of the last statistics gathering. See <a href="json-dataguide.html#GUID-E77948CB-DCA0-4733-8832-4B5F00C01A2E__EXAMPLE-1410-F572454E">Example 20-3</a> for an example of gathering statistics for this data.
                     </p><pre class="pre codeblock"><code>[
  {
    "o:path": "<span class="bold">$.User</span>",
    "<span class="italic">type</span>": "string",
    "o:length": 8,
    "o:preferred_column_name": "PO_DOCUMENT$User",
    "o:frequency": 100,
    "o:low_value": "ABULL",
    "o:high_value": "SBELL",
    "o:num_nulls": 0,
    "o:last_analyzed": "2016-03-31T12:17:53"
  },
  {
    "o:path": "<span class="bold">$.PONumber</span>",
    "<span class="italic">type</span>": "number",
    "o:length": 4,
    "o:preferred_column_name": "<span class="italic">PONumber</span>",
    "o:frequency": 100,
    "o:low_value": "672",
    "o:high_value": "1600",
    "o:num_nulls": 0,
    "o:last_analyzed": "2016-03-31T12:17:53"
  },
  {
    "o:path": "<span class="bold">$.LineItems</span>",
    "<span class="italic">type</span>": "array",
    "o:length": 512,
    "o:preferred_column_name": "PO_DOCUMENT$LineItems",
    "o:frequency": 100,
    "o:last_analyzed": "2016-03-31T12:17:53"
  },
  {
    "o:path": "<span class="bold">$.LineItems.Part</span>",
    "<span class="italic">type</span>": "object",
    "o:length": 128,
    "o:preferred_column_name": "PO_DOCUMENT$Part",
    "o:frequency": 100,
    "o:last_analyzed": "2016-03-31T12:17:53"
  },
  {
    "o:path": "<span class="bold">$.LineItems.Part.UPCCode</span>",
    "<span class="italic">type</span>": "number",
    "o:length": 16,
    "o:preferred_column_name": "PO_DOCUMENT$UPCCode",
    "o:frequency": 100,
    "o:low_value": "13131092899",
    "o:high_value": "717951002396",
    "o:num_nulls": 0,
    "o:last_analyzed": "2016-03-31T12:17:53"
  },
  {
    "o:path": "<span class="bold">$.LineItems.Part.UnitPrice</span>",
    "<span class="italic">type</span>": "number",
    "o:length": 8,
    "o:preferred_column_name": "PO_DOCUMENT$UnitPrice",
    "o:frequency": 100,
    "o:low_value": "20",
    "o:high_value": "19.95",
    "o:num_nulls": 0,
    "o:last_analyzed": "2016-03-31T12:17:53"
  },
  {
    "o:path": "<span class="bold">$.LineItems.Part.Description</span>",
    "<span class="italic">type</span>": "string",
    "o:length": 32,
    "o:preferred_column_name": "<span class="italic">PartDescription</span>",
    "o:frequency": 100,
    "o:low_value": "Nixon",
    "o:high_value": "Eric Clapton: Best Of 1981-1999",
    "o:num_nulls": 0,
    "o:last_analyzed": "2016-03-31T12:17:53"
  },
  {
    "o:path": "<span class="bold">$.LineItems.Quantity</span>",
    "<span class="italic">type</span>": "number",
    "o:length": 4,
    "o:preferred_column_name": "PO_DOCUMENT$Quantity",
    "o:frequency": 100,
    "o:low_value": "5",
    "o:high_value": "9.0",
    "o:num_nulls": 0,
    "o:last_analyzed": "2016-03-31T12:17:53"
  },
  {
    "o:path": "<span class="bold">$.LineItems.ItemNumber</span>",
    "<span class="italic">type</span>": "number",
    "o:length": 1,
    "o:preferred_column_name": "<span class="italic">ItemNumber</span>",
    "o:frequency": 100,
    "o:low_value": "1",
    "o:high_value": "3",
    "o:num_nulls": 0,
    "o:last_analyzed": "2016-03-31T12:17:53"
  },
  {
    "o:path": "<span class="bold">$.Reference</span>",
    "<span class="italic">type</span>": "string",
    "o:length": 16,
    "o:preferred_column_name": "PO_DOCUMENT$Reference",
    "o:frequency": 100,
    "o:low_value": "ABULL-20140421",
    "o:high_value": "SBELL-20141017",
    "o:num_nulls": 0,
    "o:last_analyzed": "2016-03-31T12:17:53"
  },
  {
    "o:path": "<span class="bold">$.Requestor</span>",
    "<span class="italic">type</span>": "string",
    "o:length": 16,
    "o:preferred_column_name": "PO_DOCUMENT$Requestor",
    "o:frequency": 100,
    "o:low_value": "Sarah Bell",
    "o:high_value": "Alexis Bull",
    "o:num_nulls": 0,
    "o:last_analyzed": "2016-03-31T12:17:53"
  },
  {
    "o:path": "<span class="bold">$.CostCenter</span>",
    "<span class="italic">type</span>": "string",
    "o:length": 4,
    "o:preferred_column_name": "PO_DOCUMENT$CostCenter",
    "o:frequency": 100,
    "o:low_value": "A50",
    "o:high_value": "A50",
    "o:num_nulls": 0,
    "o:last_analyzed": "2016-03-31T12:17:53"
  },
  {
    "o:path": "<span class="bold">$.AllowPartialShipment</span>",
    "<span class="italic">type</span>": "boolean",
    "o:length": 4,
    "o:preferred_column_name": "PO_DOCUMENT$AllowPartialShipment",
    "o:frequency": 50,
    "o:low_value": "true",
    "o:high_value": "true",
    "o:num_nulls": 0,
    "o:last_analyzed": "2016-03-31T12:17:53"
  },
  {
    "o:path": "<span class="bold">$.ShippingInstructions</span>",
    "<span class="italic">type</span>": "object",
    "o:length": 256,
    "o:preferred_column_name": "PO_DOCUMENT$ShippingInstructions",
    "o:frequency": 100,
    "o:last_analyzed": "2016-03-31T12:17:53"
  },
  {
    "o:path": "<span class="bold">$.ShippingInstructions.name</span>",
    "<span class="italic">type</span>": "string",
    "o:length": 16,
    "o:preferred_column_name": "PO_DOCUMENT$name",
    "o:frequency": 100,
    "o:low_value": "Sarah Bell",
    "o:high_value": "Alexis Bull",
    "o:num_nulls": 0,
    "o:last_analyzed": "2016-03-31T12:17:53"
  },
  {
    "o:path": "<span class="bold">$.ShippingInstructions.Phone</span>",
    "<span class="italic">type</span>": "string",
    "o:length": 16,
    "o:preferred_column_name": "<span class="italic">Phone</span>",
    "o:frequency": 50,
    "o:low_value": "983-555-6509",
    "o:high_value": "983-555-6509",
    "o:num_nulls": 0,
    "o:last_analyzed": "2016-03-31T12:17:53"
  },
  {
    "o:path": "<span class="bold">$.ShippingInstructions.Phone</span>",
    "<span class="italic">type</span>": "array",
    "o:length": 128,
    "o:preferred_column_name": "PO_DOCUMENT$Phone_1",
    "o:frequency": 50,
    "o:last_analyzed": "2016-03-31T12:17:53"
  },
  {
    "o:path": "<span class="bold">$.ShippingInstructions.Phone.type</span>",
    "<span class="italic">type</span>": "string",
    "o:length": 8,
    "o:preferred_column_name": "<span class="italic">PhoneType</span>",
    "o:frequency": 50,
    "o:low_value": "Mobile",
    "o:high_value": "Office",
    "o:num_nulls": 0,
    "o:last_analyzed": "2016-03-31T12:17:53"
  },
  {
    "o:path": "<span class="bold">$.ShippingInstructions.Phone.number</span>",
    "<span class="italic">type</span>": "string",
    "o:length": 16,
    "o:preferred_column_name": "<span class="italic">PhoneNumber</span>",
    "o:frequency": 50,
    "o:low_value": "415-555-1234",
    "o:high_value": "909-555-7307",
    "o:num_nulls": 0,
    "o:last_analyzed": "2016-03-31T12:17:53"
  },
  {
    "o:path": "<span class="bold">$.ShippingInstructions.Address</span>",
    "<span class="italic">type</span>": "object",
    "o:length": 128,
    "o:preferred_column_name": "PO_DOCUMENT$Address",
    "o:frequency": 100,
    "o:last_analyzed": "2016-03-31T12:17:53"
  },
  {
    "o:path": "<span class="bold">$.ShippingInstructions.Address.city</span>",
    "<span class="italic">type</span>": "string",
    "o:length": 32,
    "o:preferred_column_name": "PO_DOCUMENT$city",
    "o:frequency": 100,
    "o:low_value": "South San Francisco",
    "o:high_value": "South San Francisco",
    "o:num_nulls": 0,
    "o:last_analyzed": "2016-03-31T12:17:53"
  },
  {
    "o:path": "<span class="bold">$.ShippingInstructions.Address.state</span>",
    "<span class="italic">type</span>": "string",
    "o:length": 2,
    "o:preferred_column_name": "PO_DOCUMENT$state",
    "o:frequency": 100,
    "o:low_value": "CA",
    "o:high_value": "CA",
    "o:num_nulls": 0,
    "o:last_analyzed": "2016-03-31T12:17:53"
  },
  {
    "o:path": "<span class="bold">$.ShippingInstructions.Address.street</span>",
    "<span class="italic">type</span>": "string",
    "o:length": 32,
    "o:preferred_column_name": "PO_DOCUMENT$street",
    "o:frequency": 100,
    "o:low_value": "200 Sporting Green",
    "o:high_value": "200 Sporting Green",
    "o:num_nulls": 0,
    "o:last_analyzed": "2016-03-31T12:17:53"
  },
  {
    "o:path": "<span class="bold">$.ShippingInstructions.Address.country</span>",
    "<span class="italic">type</span>": "string",
    "o:length": 32,
    "o:preferred_column_name": "PO_DOCUMENT$country",
    "o:frequency": 100,
    "o:low_value": "United States of America",
    "o:high_value": "United States of America",
    "o:num_nulls": 0,
    "o:last_analyzed": "2016-03-31T12:17:53"
  },
  {
    "o:path": "<span class="bold">$.ShippingInstructions.Address.zipCode</span>",
    "<span class="italic">type</span>": "number",
    "o:length": 8,
    "o:preferred_column_name": "PO_DOCUMENT$zipCode",
    "o:frequency": 100,
    "o:low_value": "99236",
    "o:high_value": "99236",
    "o:num_nulls": 0,
    "o:last_analyzed": "2016-03-31T12:17:53"
  },
  {
    "o:path": "<span class="bold">$.\"Special Instructions\"</span>",
    "<span class="italic">type</span>": "string",
    "o:length": 8,
    "o:preferred_column_name": "PO_DOCUMENT$SpecialInstructions",
    "o:frequency": 100,
    "o:low_value": "Courier",
    "o:high_value": "Courier",
    "o:num_nulls": 1,
    "o:last_analyzed": "2016-03-31T12:17:53"
  }
]
</code></pre></div>
                  <!-- class="example" -->
                  <div class="section"></div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="json-dataguide.html#GUID-D8448CB1-0350-4848-B07E-9370B3B1A9BE" title="The predefined fields of a JSON data guide are described. They include JSON Schema fields (keywords) and Oracle-specific fields.">JSON Data-Guide Fields</a></li>
                        <li><a href="json-dataguide.html#GUID-A0AFD360-93A7-4566-8315-6F68D9AE090B" title="You can project JSON fields from your data as columns in a database view or as virtual columns added to the same table that contains the JSON column. You can specify a preferred name for such a column.">Specifying a Preferred Name for a Field Column</a></li>
                     </ul>
                  </div>
                  <div class="infoboxnotealso" id="GUID-12BCFCCE-18AE-4CB2-8710-EC7B712DA089__GUID-B171FF1F-CB6D-40A6-9DAA-D601B636C29F">
                     <p class="notep1">See Also:</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="creating-a-table-with-a-json-column.html#GUID-E6CC0DCF-3D72-41EF-ACA4-B3BF54EE3CA0__CACCIEFA">Example 4-2</a></p>
                        </li>
                        <li>
                           <p><a href="../arpls/DBMS_JSON.html#ARPLS-GUID-52B63CEE-669C-46FB-A276-56F7C6ECD036" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> for information about <code class="codeph">DBMS_JSON.get_index_dataguide</code></p>
                        </li>
                        <li>
                           <p><a href="../arpls/DBMS_JSON.html#ARPLS-GUID-0E802354-4508-4DF7-A07A-6999F3337CA5" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a>  for information about <code class="codeph">DBMS_JSON.rename_column</code></p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="json-dataguide.html#GUID-219FC30E-89A7-4189-BC36-7B961A24067C" title="A JSON data guide lets you discover information about the structure and content of JSON documents stored in Oracle Database.">JSON Data Guide</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-885E0CB3-9165-448E-96DA-1CC56276F685" name="GUID-885E0CB3-9165-448E-96DA-1CC56276F685"></a><h3 id="ADJSN-GUID-885E0CB3-9165-448E-96DA-1CC56276F685" class="sect3"><span class="enumeration_section">20.13 </span>A Hierarchical Data Guide For Purchase-Order Documents
               </h3>
               <div>
                  <p>The fields of a sample hierarchical data guide are described. It corresponds to a set of purchase-order documents.</p>
                  <p><a href="json-dataguide.html#GUID-885E0CB3-9165-448E-96DA-1CC56276F685__GUID-EA4D1E07-20A1-4D3E-8D35-BFC5D0BE6E2C">Example 20-24</a> shows a hierarchical data guide for the purchase-order documents in table <code class="codeph">j_purchaseorder</code>. 
                  </p>
                  <div class="example" id="GUID-885E0CB3-9165-448E-96DA-1CC56276F685__GUID-EA4D1E07-20A1-4D3E-8D35-BFC5D0BE6E2C">
                     <p class="titleinexample">Example 20-24 Hierarchical Data Guide For Purchase Orders</p>
                     <p>Field names are <span class="bold"><code class="codeph">bold</code></span>. JSON Schema keywords are <span class="italic"><code class="codeph">italic</code></span>. Preferred column names that result from using <code class="codeph">DBMS_JSON.rename_column</code> are also <span class="italic"><code class="codeph">italic</code></span>. The formatting used is similar to that produced by using SQL/JSON function <code class="codeph">json_dataguide</code> with format arguments <code class="codeph">DBMS_JSON.FORMAT_HIERARCHICAL</code> and <code class="codeph">DBMS_JSON.PRETTY</code>.
                     </p>
                     <p>Note that fields <code class="codeph">o:frequency</code>, <code class="codeph">o:low_value</code>, <code class="codeph">o:high_value</code>, <code class="codeph">o:num_nulls</code>, and <code class="codeph">o:last_analyzed</code> are present in this example. This can only be because statistics were gathered on the document set. Their values reflect the state as of the last statistics gathering. See <a href="json-dataguide.html#GUID-E77948CB-DCA0-4733-8832-4B5F00C01A2E__EXAMPLE-1410-F572454E">Example 20-3</a> for an example of gathering statistics for this data.
                     </p><pre class="pre codeblock"><code>{
  "<span class="italic">type</span>": "object",
  "<span class="italic">properties</span>": {
    "<span class="bold">User</span>": {
      "<span class="italic">type</span>": "string",
      "o:length": 8,
      "o:preferred_column_name": "PO_DOCUMENT$User",
      "o:frequency": 100,
      "o:low_value": "ABULL",
      "o:high_value": "SBELL",
      "o:num_nulls": 0,
      "o:last_analyzed": "2016-03-31T12:17:53"
    },
    "<span class="bold">PONumber</span>": {
      "<span class="italic">type</span>": "number",
      "o:length": 4,
      "o:preferred_column_name": "<span class="italic">PONumber</span>",
      "o:frequency": 100,
      "o:low_value": "672",
      "o:high_value": "1600",
      "o:num_nulls": 0,
      "o:last_analyzed": "2016-03-31T12:17:53"
    },
    "<span class="bold">LineItems</span>": {
      "<span class="italic">type</span>": "array",
      "o:length": 512,
      "o:preferred_column_name": "PO_DOCUMENT$LineItems",
      "o:frequency": 100,
      "o:last_analyzed": "2016-03-31T12:17:53",
      "<span class="italic">items</span>": {
        "<span class="italic">properties</span>": {
          "<span class="bold">Part</span>": {
            "<span class="italic">type</span>": "object",
            "o:length": 128,
            "o:preferred_column_name": "PO_DOCUMENT$Part",
            "o:frequency": 100,
            "o:last_analyzed": "2016-03-31T12:17:53",
            "<span class="italic">properties</span>": {
              "<span class="bold">UPCCode</span>": {
                "<span class="italic">type</span>": "number",
                "o:length": 16,
                "o:preferred_column_name": "PO_DOCUMENT$UPCCode",
                "o:frequency": 100,
                "o:low_value": "13131092899",
                "o:high_value": "717951002396",
                "o:num_nulls": 0,
                "o:last_analyzed": "2016-03-31T12:17:53"
              },
              "<span class="bold">UnitPrice</span>": {
                "<span class="italic">type</span>": "number",
                "o:length": 8,
                "o:preferred_column_name": "PO_DOCUMENT$UnitPrice",
                "o:frequency": 100,
                "o:low_value": "20",
                "o:high_value": "19.95",
                "o:num_nulls": 0,
                "o:last_analyzed": "2016-03-31T12:17:53"
              },
              "<span class="bold">Description</span>": {
                "<span class="italic">type</span>": "string",
                "o:length": 32,
                "o:preferred_column_name": "<span class="italic">PartDescription</span>",
                "o:frequency": 100,
                "o:low_value": "Nixon",
                "o:high_value": "Eric Clapton: Best Of 1981-1999",
                "o:num_nulls": 0,
                "o:last_analyzed": "2016-03-31T12:17:53"
              }
            }
          },
          "<span class="bold">Quantity</span>": {
            "<span class="italic">type</span>": "number",
            "o:length": 4,
            "o:preferred_column_name": "PO_DOCUMENT$Quantity",
            "o:frequency": 100,
            "o:low_value": "5",
            "o:high_value": "9.0",
            "o:num_nulls": 0,
            "o:last_analyzed": "2016-03-31T12:17:53"
          },
          "<span class="bold">ItemNumber</span>": {
            "<span class="italic">type</span>": "number",
            "o:length": 1,
            "o:preferred_column_name": "<span class="italic">ItemNumber</span>",
            "o:frequency": 100,
            "o:low_value": "1",
            "o:high_value": "3",
            "o:num_nulls": 0,
            "o:last_analyzed": "2016-03-31T12:17:53"
          }
        }
      }
    },
    "<span class="bold">Reference</span>": {
      "<span class="italic">type</span>": "string",
      "o:length": 16,
      "o:preferred_column_name": "PO_DOCUMENT$Reference",
      "o:frequency": 100,
      "o:low_value": "ABULL-20140421",
      "o:high_value": "SBELL-20141017",
      "o:num_nulls": 0,
      "o:last_analyzed": "2016-03-31T12:17:53"
    },
    "<span class="bold">Requestor</span>": {
      "<span class="italic">type</span>": "string",
      "o:length": 16,
      "o:preferred_column_name": "PO_DOCUMENT$Requestor",
      "o:frequency": 100,
      "o:low_value": "Sarah Bell",
      "o:high_value": "Alexis Bull",
      "o:num_nulls": 0,
      "o:last_analyzed": "2016-03-31T12:17:53"
    },
    "<span class="bold">CostCenter</span>": {
      "<span class="italic">type</span>": "string",
      "o:length": 4,
      "o:preferred_column_name": "PO_DOCUMENT$CostCenter",
      "o:frequency": 100,
      "o:low_value": "A50",
      "o:high_value": "A50",
      "o:num_nulls": 0,
      "o:last_analyzed": "2016-03-31T12:17:53"
    },
    "<span class="bold">AllowPartialShipment</span>": {
      "<span class="italic">type</span>": "boolean",
      "o:length": 4,
      "o:preferred_column_name": "PO_DOCUMENT$AllowPartialShipment",
      "o:frequency": 50,
      "o:last_analyzed": "2016-03-31T12:17:53"
    },
    "<span class="bold">ShippingInstructions</span>": {
      "<span class="italic">type</span>": "object",
      "o:length": 256,
      "o:preferred_column_name": "PO_DOCUMENT$ShippingInstructions",
      "o:frequency": 100,
      "o:last_analyzed": "2016-03-31T12:17:53",
      "<span class="italic">properties</span>": {
        "<span class="bold">name</span>": {
          "<span class="italic">type</span>": "string",
          "o:length": 16,
          "o:preferred_column_name": "PO_DOCUMENT$name",
          "o:frequency": 100,
          "o:low_value": "Sarah Bell",
          "o:high_value": "Alexis Bull",
          "o:num_nulls": 0,
          "o:last_analyzed": "2016-03-31T12:17:53"
        },
        "<span class="bold">Phone</span>": {
          "<span class="italic">oneOf</span>": [
            {
              "<span class="italic">type</span>": "string",
              "o:length": 16,
              "o:preferred_column_name": "<span class="italic">Phone</span>",
              "o:frequency": 50,
              "o:low_value": "983-555-6509",
              "o:high_value": "983-555-6509",
              "o:num_nulls": 0,
              "o:last_analyzed": "2016-03-31T12:17:53"
            },
            {
              "<span class="italic">type</span>": "array",
              "o:length": 128,
              "o:preferred_column_name": "PO_DOCUMENT$Phone_1",
              "o:frequency": 50,
              "o:last_analyzed": "2016-03-31T12:17:53",
              "<span class="italic">items</span>": {
                "<span class="italic">properties</span>": {
                  "<span class="bold">type</span>": {
                    "<span class="italic">type</span>": "string",
                    "o:length": 8,
                    "o:preferred_column_name": "<span class="italic">PhoneType</span>",
                    "o:frequency": 50,
                    "o:low_value": "Mobile",
                    "o:high_value": "Office",
                    "o:num_nulls": 0,
                    "o:last_analyzed": "2016-03-31T12:17:53"
                  },
                  "<span class="bold">number</span>": {
                    "<span class="italic">type</span>": "string",
                    "o:length": 16,
                    "o:preferred_column_name": "<span class="italic">PhoneNumber</span>",
                    "o:frequency": 50,
                    "o:low_value": "415-555-1234",
                    "o:high_value": "909-555-7307",
                    "o:num_nulls": 0,
                    "o:last_analyzed": "2016-03-31T12:17:53"
                  }
                }
              }
            }
          ]
        },
        "<span class="bold">Address</span>": {
          "<span class="italic">type</span>": "object",
          "o:length": 128,
          "o:preferred_column_name": "PO_DOCUMENT$Address",
          "o:frequency": 100,
          "o:last_analyzed": "2016-03-31T12:17:53",
          "<span class="italic">properties</span>": {
            "<span class="bold">city</span>": {
              "<span class="italic">type</span>": "string",
              "o:length": 32,
              "o:preferred_column_name": "PO_DOCUMENT$city",
              "o:frequency": 100,
              "o:low_value": "South San Francisco",
              "o:high_value": "South San Francisco",
              "o:num_nulls": 0,
              "o:last_analyzed": "2016-03-31T12:17:53"
            },
            "<span class="bold">state</span>": {
              "<span class="italic">type</span>": "string",
              "o:length": 2,
              "o:preferred_column_name": "PO_DOCUMENT$state",
              "o:frequency": 100,
              "o:low_value": "CA",
              "o:high_value": "CA",
              "o:num_nulls": 0,
              "o:last_analyzed": "2016-03-31T12:17:53"
            },
            "<span class="bold">street</span>": {
              "<span class="italic">type</span>": "string",
              "o:length": 32,
              "o:preferred_column_name": "PO_DOCUMENT$street",
              "o:frequency": 100,
              "o:low_value": "200 Sporting Green",
              "o:high_value": "200 Sporting Green",
              "o:num_nulls": 0,
              "o:last_analyzed": "2016-03-31T12:17:53"
            },
            "<span class="bold">country</span>": {
              "<span class="italic">type</span>": "string",
              "o:length": 32,
              "o:preferred_column_name": "PO_DOCUMENT$country",
              "o:frequency": 100,
              "o:low_value": "United States of America",
              "o:high_value": "United States of America",
              "o:num_nulls": 0,
              "o:last_analyzed": "2016-03-31T12:17:53"
            },
            "<span class="bold">zipCode</span>": {
              "<span class="italic">type</span>": "number",
              "o:length": 8,
              "o:preferred_column_name": "PO_DOCUMENT$zipCode",
              "o:frequency": 100,
              "o:low_value": "99236",
              "o:high_value": "99236",
              "o:num_nulls": 0,
              "o:last_analyzed": "2016-03-31T12:17:53"
            }
          }
        }
      }
    },
    "<span class="bold">Special Instructions</span>": {
      "<span class="italic">type</span>": "string",
      "o:length": 8,
      "o:preferred_column_name": "PO_DOCUMENT$SpecialInstructions",
      "o:frequency": 100,
      "o:low_value": "Courier",
      "o:high_value": "Courier",
      "o:num_nulls": 1,
      "o:last_analyzed": "2016-03-31T12:17:53"
    }
  }
}
</code></pre></div>
                  <!-- class="example" -->
                  <div class="section"></div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="json-dataguide.html#GUID-D8448CB1-0350-4848-B07E-9370B3B1A9BE" title="The predefined fields of a JSON data guide are described. They include JSON Schema fields (keywords) and Oracle-specific fields.">JSON Data-Guide Fields</a></li>
                        <li><a href="json-dataguide.html#GUID-A0AFD360-93A7-4566-8315-6F68D9AE090B" title="You can project JSON fields from your data as columns in a database view or as virtual columns added to the same table that contains the JSON column. You can specify a preferred name for such a column.">Specifying a Preferred Name for a Field Column</a></li>
                     </ul>
                  </div>
                  <div class="infoboxnotealso" id="GUID-885E0CB3-9165-448E-96DA-1CC56276F685__GUID-B171FF1F-CB6D-40A6-9DAA-D601B636C29F">
                     <p class="notep1">See Also:</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="creating-a-table-with-a-json-column.html#GUID-E6CC0DCF-3D72-41EF-ACA4-B3BF54EE3CA0__CACCIEFA">Example 4-2</a></p>
                        </li>
                        <li>
                           <p><a href="../sqlrf/JSON_DATAGUIDE.html#SQLRF-GUID-4CF32887-0F46-4925-8381-AE2B74343933" target="_blank"><span><cite>Oracle Database SQL Language Reference</cite></span></a> for information about SQL function <code class="codeph">json_dataguide</code></p>
                        </li>
                        <li>
                           <p><a href="../arpls/DBMS_JSON.html#ARPLS-GUID-0E802354-4508-4DF7-A07A-6999F3337CA5" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a>  for information about <code class="codeph">DBMS_JSON.rename_column</code></p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="json-dataguide.html#GUID-219FC30E-89A7-4189-BC36-7B961A24067C" title="A JSON data guide lets you discover information about the structure and content of JSON documents stored in Oracle Database.">JSON Data Guide</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <hr><br><p style="text-decoration:underline">Footnote Legend</p>Footnote 1: If function json_dataguide were passed DBMS_JSON.FORMAT_HIERARCHICAL as optional second argument then the result would be three hierarchical data guides.<br></div>
      </article>
   </body>
</html>