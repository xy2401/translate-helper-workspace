<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="A JSON data guide lets you discover information about the structure and content of JSON documents stored in Oracle Database."></meta>
      <meta name="description" content="A JSON data guide lets you discover information about the structure and content of JSON documents stored in Oracle Database."></meta>
      <title>JSON数据指南</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="JSON Developer&#39;s Guide"></meta>
      <meta property="og:description" content="A JSON data guide lets you discover information about the structure and content of JSON documents stored in Oracle Database."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="JSON Developer&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="json-developers-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-02-22T10:58:31-08:00"></meta>
      <meta name="dcterms.title" content="JSON Developer&#39;s Guide"></meta>
      <meta name="dcterms.dateCopyrighted" content="2015, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96227-03"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="oracle-sql-function-json_serialize.html" title="Previous" type="text/html"></link>
      <link rel="next" href="generation-of-json-data.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="ADJSN"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="oracle-sql-function-json_serialize.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="generation-of-json-data.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">JSON开发人员指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="query-json-data.html" property="item" typeof="WebPage"><span property="name">查询JSON数据</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">JSON数据指南</li>
            </ol>
            <a id="GUID-219FC30E-89A7-4189-BC36-7B961A24067C" name="GUID-219FC30E-89A7-4189-BC36-7B961A24067C"></a>
            
            <h2 id="ADJSN-GUID-219FC30E-89A7-4189-BC36-7B961A24067C" class="sect2"><span class="enumeration_chapter">20</span> JSON数据指南</h2>
         </header>
         <div class="ind"><script type="text/javascript">window.name='json-dataguide'</script><script type="text/javascript">
    function footdisplay(footnum,footnote) {
    var msg = window.open('about:blank', 'NewWindow' + footnum,
        'directories=no,height=100,location=no,menubar=no,resizable=yes,' +
        'scrollbars=yes,status=no,toolbar=no,width=598');
    msg.document.open('text/html');
    msg.document.write('<!DOCTYPE html ');
    msg.document.write('PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" ');
    msg.document.write('"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">'); 
    msg.document.write('<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us" dir="ltr"><head><title>');
   
    msg.document.write('Footnote&nbsp; ' + footnum);
    msg.document.write('<\/title><meta http-equiv="Content-Type" ');
    msg.document.write('content="text/html; charset=utf-8" />');
    msg.document.write('<meta http-equiv="Content-Script-Type" ');
    msg.document.write('content="text/javascript" />');
    msg.document.write('<style type="text/css"> <![CDATA[ ');
    msg.document.write('h1 {text-align: center; font-size: 14pt;}');
    msg.document.write('fieldset {border: none;}');
    msg.document.write('form {text-align: center;}');
    msg.document.write(' ]]u003e </style>');
    msg.document.write('<\/head><body><div id="footnote"><h1>Footnote&nbsp; ' + footnum + '<\/h1><p>');
    msg.document.write(footnote);
    msg.document.write('<\/p><form action="" method="post"><fieldset>');
    msg.document.write('<input type="button" value="OK" ');
    msg.document.write('onclick="window.close();" />');
    msg.document.write('<\/fieldset><\/form><\/div><\/body><\/html>');
    msg.document.close();
    setTimeout(function() {
        var height = msg.document.getElementById('footnote').offsetHeight;
        msg.resizeTo(598, height + 100);
    }
    , 100);
    msg.focus();
}
            </script><noscript>
               <p>此页面上的脚本内容仅用于导航目的，不会以任何方式更改内容。</p>
            </noscript>
            <div>
               <p>通过JSON数据指南，您可以发现有关Oracle数据库中存储的JSON文档的结构和内容的信息。</p>
               <div class="section">
                  <p>您可以使用此信息的一些方法包括：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>生成描述JSON文档集的JSON Schema文档。</p>
                     </li>
                     <li>
                        <p>创建可用于对文档中的数据执行SQL操作的视图。</p>
                     </li>
                     <li>
                        <p>自动添加或更新与文档中添加或更改的字段对应的虚拟列。</p>
                     </li>
                  </ul>
               </div>
               <!-- class="section" -->
               <div class="section"></div>
               <!-- class="section" -->
               <div class="section">
                  <div class="infoboxnotealso" id="GUID-219FC30E-89A7-4189-BC36-7B961A24067C__GUID-CD618286-A075-4236-96E8-48B3825FC43C">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=json_schema_core" target="_blank"><span class="italic">JSON Schema：核心定义和术语json-schema-core</span></a></p>
                        </li>
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=json_schema_validation" target="_blank"><span class="italic">JSON Schema：交互式和非交互式验证</span></a></p>
                        </li>
                     </ul>
                  </div>
               </div>
               <!-- class="section" -->
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="json-dataguide.html#GUID-8A431168-E23B-493D-8190-8A26A8D0BCF1">JSON数据指南概述</a><br>数据指南是一组JSON文档中包含的结构和类型信息的摘要。它记录有关这些文档中使用的字段的元数据。
                  </li>
                  <li class="ulchildlink"><a href="json-dataguide.html#GUID-E77948CB-DCA0-4733-8832-4B5F00C01A2E">持久性数据指南信息：JSON搜索索引的一部分</a><br>JSON数据指南信息可以作为JSON搜索索引基础结构的一部分持久保存，并且在添加新的JSON内容时会自动更新此信息。默认情况下，创建JSON搜索索引时就是这种情况：数据引导信息是索引基础结构的一部分。
                  </li>
                  <li class="ulchildlink"><a href="json-dataguide.html#GUID-B57975A8-3000-4F21-BB22-DC413F06D6DB">数据指南格式和创建数据指南的方法</a><br>数据指南有两种格式：平面和分层。两者都可用作SQL和PL / SQL作为<code class="codeph">CLOB</code>数据。您可以根据存储在JSON搜索索引中的数据指南信息或扫描JSON文档来构建数据指南。
                  </li>
                  <li class="ulchildlink"><a href="json-dataguide.html#GUID-D8448CB1-0350-4848-B07E-9370B3B1A9BE">JSON数据指南字段</a><br>描述了JSON数据指南的预定义字段。它们包括JSON Schema字段（关键字）和Oracle特定字段。
                  </li>
                  <li class="ulchildlink"><a href="json-dataguide.html#GUID-70D47F29-BA01-4908-A5C1-8EB10AAB89A0">持久数据指南信息的数据字典视图</a><br>您可以查询静态数据字典视图，以查看哪些表具有启用了数据引导的JSON搜索索引的JSON列，并提取记录在启用了dataguide的JSON搜索索引中的JSON对象字段信息。
                  </li>
                  <li class="ulchildlink"><a href="json-dataguide.html#GUID-A0AFD360-93A7-4566-8315-6F68D9AE090B">为字段列指定首选名称</a><br>您可以将数据中的JSON字段作为数据库视图中的列或作为添加到包含JSON列的同一表的虚拟列进行投影。您可以为此类列指定首选名称。
                  </li>
                  <li class="ulchildlink"><a href="json-dataguide.html#GUID-394009D2-F829-49B0-B6EF-DB24606FEF75">基于数据指南信息创建基于JSON数据的视图</a><br>根据数据指南信息，您可以创建一个数据库视图，其列投影一组JSON文档中的特定标量字段。您可以通过编辑分层数据指南或指定SQL / JSON路径表达式和字段出现的最小频率来选择要投影的字段。
                  </li>
                  <li class="ulchildlink"><a href="json-dataguide.html#GUID-7AEF436C-B743-4BA1-B6D4-1F1B98E26DB1">基于数据指南信息为JSON字段添加和删除虚拟列</a><br>根据JSON列的数据指南信息，您可以将该JSON数据中的标量字段作为虚拟列投影到同一个表中。投射的标量字段是不在数组下的字段。
                  </li>
                  <li class="ulchildlink"><a href="json-dataguide.html#GUID-2F4C6F52-0D96-4405-8F85-CDA0B234D0D5">更改触发器，用于启用数据指南的搜索索引</a><br>当JSON数据更改时，启用数据指南的JSON搜索索引中的某些信息会自动更新。您可以指定在发生这种情况时触发调用的过程。您可以为此定义自己的PL / SQL过程，也可以使用预定义的更改触发过程<code class="codeph">add_vc</code> 。
                  </li>
                  <li class="ulchildlink"><a href="json-dataguide.html#GUID-BD147159-87A7-4AAC-B150-44E3F10A81E1">每个文档集多个数据指南</a><br>数据指南反映了给定JSON文档集的形状。如果JSON列包含具有不同结构或类型信息的不同类型的文档，则可以为不同类型的文档创建和使用不同的数据指南。
                  </li>
                  <li class="ulchildlink"><a href="json-dataguide.html#GUID-32ED8EE8-FC3E-406E-8AD6-652BB5A1D510">查询数据指南</a><br>数据指南是有关一组JSON文档的信息。您可以使用Oracle SQL函数<code class="codeph">json_dataguide</code>或PL / SQL函数<code class="codeph">DBMS_JSON.get_index_dataguide</code>从平面数据指南中查询它。在后一种情况下，必须在JSON数据上定义启用数据引导的JSON搜索索引。
                  </li>
                  <li class="ulchildlink"><a href="json-dataguide.html#GUID-12BCFCCE-18AE-4CB2-8710-EC7B712DA089">采购订单文件的平面数据指南</a><br>描述了样本平面数据指南的字段。它对应于一组采购订单文档。
                  </li>
                  <li class="ulchildlink"><a href="json-dataguide.html#GUID-885E0CB3-9165-448E-96DA-1CC56276F685">采购订单文档的分层数据指南</a><br>描述了样本分层数据指南的字段。它对应于一组采购订单文档。
                  </li>
               </ul>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>父主题：</strong> <a href="query-json-data.html#GUID-119E5069-77F2-45DC-B6F0-A1B312945590" title="您可以使用简单的点表示法查询JSON数据，或者，对于更多功能，使用SQL / JSON函数和条件。您可以创建和查询数据指南，该指南汇总了一组JSON文档的结构和类型信息。">查询JSON数据</a></p>
                  </div>
               </div>
            </div>
            
            <div class="sect2"><a id="GUID-8A431168-E23B-493D-8190-8A26A8D0BCF1" name="GUID-8A431168-E23B-493D-8190-8A26A8D0BCF1"></a><h3 id="ADJSN-GUID-8A431168-E23B-493D-8190-8A26A8D0BCF1" class="sect3"><span class="enumeration_section">20.1</span> JSON数据指南概述</h3>
               <div>
                  <p>数据指南是一组JSON文档中包含的结构和类型信息的摘要。它记录有关这些文档中使用的字段的元数据。</p>
                  <p>例如，对于<a href="json-data.html#GUID-FBC22D72-AA64-4B0A-92A2-837B32902E2C__CACCBBAI">示例2-1中</a>提供的JSON对象，数据指南指定该文档分别具有字符串，对象和数组类型的字段<code class="codeph">name</code> ， <code class="codeph">Address</code>和<code class="codeph">Phone</code>的对象<code class="codeph">ShippingInstructions</code> 。对象<code class="codeph">Address</code>的结构类似地记录，数组<code class="codeph">Phone</code>中的元素类型也是如此。
                  </p>
                  <p>JSON数据指南信息可以作为JSON搜索索引基础结构的一部分持久保存，并且在添加新的JSON内容时会自动更新此信息。默认情况下，创建JSON搜索索引时就是这种情况：数据引导信息是索引基础结构的一部分。</p>
                  <div class="section">
                     <p>您可以使用数据指南：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>作为开发涉及数据挖掘，商业智能或其他JSON文档分析的应用程序的基础。</p>
                        </li>
                        <li>
                           <p>作为向用户提供有关所请求的JSON信息（包括搜索）的帮助的基础。</p>
                        </li>
                        <li>
                           <p>在将新JSON文档添加到文档集之前检查或操作它们（例如：验证，键入检查或排除某些字段）。</p>
                        </li>
                     </ul>
                     <p>为此目的，您可以：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>直接查询数据指南以获取有关文档集的信息，例如字段长度或哪些字段至少以特定频率出现。</p>
                        </li>
                        <li>
                           <p>根据数据指南根据其重要性创建视图或添加虚拟列，以投影感兴趣的特定JSON字段。</p>
                        </li>
                     </ul>
                     <div class="infoboxnote" id="GUID-8A431168-E23B-493D-8190-8A26A8D0BCF1__NOTE-1425-F9827709">
                        <p class="notep1">注意：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>虚拟列优于视图的优点是您可以在虚拟列上构建索引，并且可以为优化程序获取有关它的统计信息。</p>
                           </li>
                           <li>
                              <p>虚拟列（如一般列）受给定表的1000列限制。</p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section"></div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="json-dataguide.html#GUID-D8448CB1-0350-4848-B07E-9370B3B1A9BE" title="描述了JSON数据指南的预定义字段。它们包括JSON Schema字段（关键字）和Oracle特定字段。">JSON数据指南字段</a></li>
                        <li><a href="indexes-for-json-data.html#GUID-D7A604E1-F617-4C92-A9D9-00B6AB78EFD8" title="JSON搜索索引是一般索引。它可以改善（1）即席结构查询的性能，即您可能不会预期或经常使用的查询，以及（2）全文搜索。它是专为与JSON数据一起使用而设计的Oracle Text索引。">JSON搜索索引：特殊查询和全文搜索</a></li>
                        <li><a href="json-dataguide.html#GUID-32ED8EE8-FC3E-406E-8AD6-652BB5A1D510" title="数据指南是有关一组JSON文档的信息。您可以使用Oracle SQL函数json_dataguide或PL / SQL函数DBMS_JSON.get_index_dataguide从平面数据指南中查询它。在后一种情况下，必须在JSON数据上定义启用数据引导的JSON搜索索引。">查询数据指南</a></li>
                        <li><a href="json-dataguide.html#GUID-90EC7EB8-7D45-4CB7-B16E-97BA3427D35F" title="您可以使用分层数据指南来创建数据库视图，该数据库视图的列从文档中投影指定的JSON字段。投影的字段是数据指南中的字段。您可以编辑数据指南以仅包括要投影的字段。">基于分层数据指南创建基于JSON数据的视图</a></li>
                        <li><a href="json-dataguide.html#GUID-7AEF436C-B743-4BA1-B6D4-1F1B98E26DB1" title="根据JSON列的数据指南信息，您可以将该JSON数据中的标量字段作为虚拟列投影到同一个表中。投射的标量字段是不在数组下的字段。">基于数据指南信息为JSON字段添加和删除虚拟列</a></li>
                     </ul>
                  </div>
                  <div class="infoboxnotealso" id="GUID-8A431168-E23B-493D-8190-8A26A8D0BCF1__GUID-D027FE1B-2DBF-4617-9816-BBDD6E931716">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>有关<code class="codeph">DBMS_JSON.get_index_dataguide</code>信息，请<code class="codeph">DBMS_JSON.get_index_dataguide</code> <a href="../arpls/DBMS_JSON.html#ARPLS-GUID-52B63CEE-669C-46FB-A276-56F7C6ECD036" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                        </li>
                        <li>
                           <p>有关SQL函数<code class="codeph">json_dataguide</code>信息，请<a href="../sqlrf/JSON_DATAGUIDE.html#SQLRF-GUID-4CF32887-0F46-4925-8381-AE2B74343933" target="_blank"><span><cite>参见Oracle数据库SQL语言参考</cite></span></a></p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="json-dataguide.html#GUID-219FC30E-89A7-4189-BC36-7B961A24067C" title="通过JSON数据指南，您可以发现有关Oracle数据库中存储的JSON文档的结构和内容的信息。">JSON数据指南</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-E77948CB-DCA0-4733-8832-4B5F00C01A2E" name="GUID-E77948CB-DCA0-4733-8832-4B5F00C01A2E"></a><h3 id="ADJSN-GUID-E77948CB-DCA0-4733-8832-4B5F00C01A2E" class="sect3"><span class="enumeration_section">20.2</span>持久数据指南信息：JSON搜索索引的一部分</h3>
               <div>
                  <p>JSON数据指南信息可以作为JSON搜索索引基础结构的一部分持久保存，并且在添加新的JSON内容时会自动更新此信息。默认情况下，创建JSON搜索索引时就是这种情况：数据引导信息是索引基础结构的一部分。</p>
                  <p>您可以将<code class="codeph">CREATE SEARCH INDEX</code>与关键字<code class="codeph">FOR JSON</code>以同时创建搜索索引，数据指南或两者。默认行为是创建两者。
                  </p>
                  <p>要在JSON搜索索引中创建持久数据指南信息<span class="italic">而不启用</span>对索引中<span class="italic">搜索的支持</span> ，请在<code class="codeph">PARAMETERS</code>子句中为<code class="codeph">CREATE SEARCH INDEX</code>指定<code class="codeph"><span class="bold">SEARCH_ON NONE</span></code> ，但是将<code class="codeph">DATAGUIDE</code>的值<code class="codeph">DATAGUIDE</code>为<code class="codeph">ON</code> （默认值） 。<a href="json-dataguide.html#GUID-E77948CB-DCA0-4733-8832-4B5F00C01A2E__CREATINGAJSONDATAGUIDEWITHOUTSEARCH-E770C3B7">例20-1</a>说明了这一点。
                  </p>
                  <p>你可以使用<code class="codeph">ALTER INDEX</code> ......<code class="codeph">REBUILD</code>为<span class="italic">现有</span> JSON搜索索引启用或禁用数据引导支持。<a href="json-dataguide.html#GUID-E77948CB-DCA0-4733-8832-4B5F00C01A2E__DISABLINGDATAGUIDESUPPORTFORANEXIST-E87466F2">例20-2</a>说明了这一点 - 它禁用了<a href="indexes-for-json-data.html#GUID-D7A604E1-F617-4C92-A9D9-00B6AB78EFD8__GUID-5DC9D338-2D42-46B1-ADAA-793B6DA0CF3A">例26-17中</a>默认添加的数据引导支持。
                  </p>
                  <div class="infoboxnote" id="GUID-E77948CB-DCA0-4733-8832-4B5F00C01A2E__GUID-570DEC84-0CF4-4D45-801D-25277C68D983">
                     <p class="notep1">注意：</p>
                     <p>要创建启用数据指南的JSON搜索索引或数据指南启用现有JSON搜索索引，您需要数据库权限<code class="codeph">CTXAPP</code>和Oracle Database Release 12c（12.2.0.1）或更高版本。
                     </p>
                  </div>
                  <div class="infoboxnote" id="GUID-E77948CB-DCA0-4733-8832-4B5F00C01A2E__ADATAGUIDE-ENABLEDJSONSEARCHINDEXCA-109C01BD">
                     <p class="notep1">注意：</p>
                     <p>启用数据指南的JSON搜索索引只能在具有<code class="codeph">is json</code>检查约束的列上构建。此外，对于要更新的索引中的数据指南信息，必须启用检查约束。
                     </p>
                     <p>如果检查约束由于某种原因而被禁用，则必须<span class="italic">重建</span>索引中<span class="italic">的数据指南信息</span>并<span class="italic">重新启用检查约束</span> ，以恢复自动数据指南支持更新，如下所示：</p><pre class="pre codeblock"><code>ALTER INDEX <span class="italic">index_name</span> REBUILD（'dataguide off'）; ALTER INDEX <span class="italic">index_name</span> REBUILD（'dataguide on'）; ALTER TABLE <span class="italic">table_name</span> ENABLE CONSTRAINT <span class="italic">is_json_check_constraint_name</span> ;</code></pre><p>特别是，使用SQL * Loader（ <code class="codeph">sqlldr</code> ）禁用<code class="codeph">is json</code>检查约束。
                     </p>
                  </div>
                  <p>由于持久数据指南信息是搜索索引基础结构的一部分，因此它始终是<span class="italic">实时的</span> ：只要索引同步，其内容就会自动更新。索引数据的更改仅在索引同步后才会反映在搜索索引中，包括其数据指南信息中。
                  </p>
                  <p>此外，搜索索引中数据指南信息的更新始终是<span class="italic">附加的</span> ：它们都不会被删除。这是索引通常不能准确反映其文档集中的数据的另一个原因：它所适用的文档中的删除<span class="italic">不会</span>反映在其数据指南信息中。如果您需要确保此类信息准确反映当前数据，则必须删除JSON搜索索引并重新创建。
                  </p>
                  <p>搜索索引中的持久数据指南信息还可以包括<span class="italic">统计信息</span> ，例如在文档集中使用每个JSON字段的频率。仅当您在文档集上明确地收集统计信息时才会出现统计信息（例如，将它们收集在JSON搜索索引上）。它们不会自动更新 - 如果您想确保它们是最新的，请重新收集统计信息。<a href="json-dataguide.html#GUID-E77948CB-DCA0-4733-8832-4B5F00C01A2E__EXAMPLE-1410-F572454E">示例20-3</a>收集由JSON搜索索引<code class="codeph">po_search_idx</code>索引的JSON数据的统计信息，该数据在<a href="indexes-for-json-data.html#GUID-D7A604E1-F617-4C92-A9D9-00B6AB78EFD8__GUID-5DC9D338-2D42-46B1-ADAA-793B6DA0CF3A">例26-17中</a>创建。
                  </p>
                  <div class="infoboxnote" id="GUID-E77948CB-DCA0-4733-8832-4B5F00C01A2E__GUID-B13DEF9E-187A-447D-88D9-0B0E8BF0DFAC">
                     <p class="notep1">注意：</p>
                     <p>在<span class="italic">分片</span>环境中创建启用本地数据指南的JSON搜索索引时，每个单独的<span class="italic">分片</span>都包含存储在该分片中的JSON文档的数据指南信息。因此，如果在分片<span class="italic">目录</span>数据库上调用与数据指南相关的操作，则它们将不起作用。
                     </p>
                  </div>
                  <div class="section" id="GUID-E77948CB-DCA0-4733-8832-4B5F00C01A2E__CONSIDERATIONSFORADATAGUIDE-ENABLED-0240B3C3">
                     <p class="subhead2" id="GUID-E77948CB-DCA0-4733-8832-4B5F00C01A2E__CONSIDERATIONSFORADATAGUIDE-ENABLED-0240B18B">分区表上启用数据指南的搜索索引的注意事项</p>
                     <p>未对分区表本地的启用数据指南的JSON搜索索引中的数据指南信息进行分区。它在所有分区之间共享。</p>
                     <p>由于索引中的数据引导信息仅是附加的，因此删除，合并，拆分或截断分区对索引没有影响。</p>
                     <p>使用未分区的表交换分区表会更新分区表上索引中的数据引导信息，但必须重建未分区表上的任何启用数据引导的索引。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-E77948CB-DCA0-4733-8832-4B5F00C01A2E__GUID-751E4723-B916-46CD-86CE-407BC445BFA9">如果序列化哈希表数据，请避免持久数据指南信息</p>
                     <p>如果将Java哈希表或关联数组（例如在JavaScript中找到）序列化为JSON对象，则应避免使用持久性数据引导信息。</p>
                     <p>由诸如GSON和Jackson之类的流行库提供的默认哈希表序列化产生具有对象字段名称的文本JSON文档，所述对象字段名称取自哈希表键条目并且具有取自相应Java哈希表值的字段值。序列化单个Java哈希表条目会生成新的（唯一的）JSON字段和值。</p>
                     <p>持久化的数据指南信息反映了数据的形状，并在插入新的JSON文档时自动更新。每个哈希表键值对都会在JSON搜索索引中生成单独的条目。因此，这种序列化可以大大增加索引中维护的信息的大小。除了大尺寸之外，许多索引更新会对性能产生负面影响，从而使DML变慢。</p>
                     <p>如果将哈希表或关联数组序列化为JSON对象数组，每个对象都包含从哈希表键条目派生的字段，则不会出现此类问题。</p>
                     <p>作为JSON对象的哈希表或关联数组的默认序列化与具有由开发人员分配的字段名称的对象无法区分。JSON数据指南无法分辨开发人员分配了哪些（类似元数据）字段名称，以及哪些（类似数据）名称可能是从哈希表或关联数组派生的。它将所有字段名称视为元数据，就像开发人员指定的那样。</p>
                     <p>例如：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>如果使用具有<code class="codeph">animalName</code>作为哈希键的哈希表构建应用程序对象，并将动物属性集设置为值，则生成的默认序列化是具有<span class="italic">单独字段</span>的单个JSON对象（ <code class="codeph">"cat"</code> ， <code class="codeph">"mouse"</code> ，.. 。）对于每个哈希表条目，字段值是具有相应动物属性的对象。由于通常从散列键导出的大量字段（ <code class="codeph">"cat"</code> ， <code class="codeph">"mouse"</code> ，...），这在数据引导大小和性能方面可能是有问题的。
                           </p>
                        </li>
                        <li>
                           <p>如果您改为构造<code class="codeph">animal</code>结构的应用程序数组，每个<code class="codeph">animal</code>结构都有一个字段<code class="codeph">animalName</code> （值为<code class="codeph">"cat"</code>或<code class="codeph">"mouse"</code> ...），那么生成的序列化是一个JSON对象数组，每个对象都有相同的字段， <code class="codeph">animalName</code> 。相应的数据指南没有大小或性能问题。
                           </p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-E77948CB-DCA0-4733-8832-4B5F00C01A2E__CREATINGAJSONDATAGUIDEWITHOUTSEARCH-E770C3B7">
                     <p class="titleinexample">示例20-1为JSON数据指南启用持久支持，但不为搜索启用</p><pre class="pre codeblock"><code>CREATE SEARCH INDEX po_dg_only_idx ON j_purchaseorder（po_document）FOR JSON <span class="bold">PARAMETERS（'SEARCH_ON NONE'）</span> ;</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-E77948CB-DCA0-4733-8832-4B5F00C01A2E__DISABLINGDATAGUIDESUPPORTFORANEXIST-E87466F2">
                     <p class="titleinexample">示例20-2禁用现有JSON搜索索引的JSON数据指南支持</p><pre class="pre codeblock"><code>ALTER INDEX po_search_idx REBUILD <span class="bold">PARAMETERS（'DATAGUIDE OFF'）</span> ;</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-E77948CB-DCA0-4733-8832-4B5F00C01A2E__EXAMPLE-1410-F572454E">
                     <p class="titleinexample">示例20-3使用JSON搜索索引收集有关JSON数据的统计信息</p><pre class="pre codeblock"><code>EXEC DBMS_STATS。 <span class="bold">gather_index_stats</span> （docuser，po_search_idx，NULL，99）;</code></pre></div>
                  <!-- class="example" -->
                  <div class="section"></div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="indexes-for-json-data.html#GUID-D7A604E1-F617-4C92-A9D9-00B6AB78EFD8" title="JSON搜索索引是一般索引。它可以改善（1）即席结构查询的性能，即您可能不会预期或经常使用的查询，以及（2）全文搜索。它是专为与JSON数据一起使用而设计的Oracle Text索引。">JSON搜索索引：特殊查询和全文搜索</a></li>
                     </ul>
                  </div>
                  <div class="infoboxnotealso" id="GUID-E77948CB-DCA0-4733-8832-4B5F00C01A2E__GUID-50AF1262-73F7-4B57-9DDA-ED6410C70809">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>有关<code class="codeph">CREATE SEARCH INDEX</code>的<code class="codeph">PARAMETERS</code>子句的信息，请参阅<a href="../ccref/oracle-text-SQL-statements-and-operators.html#CCREF-GUID-10013D4C-AB6A-44EB-B8B3-AD318EDE33A9" target="_blank"><span><cite>Oracle Text Reference</cite></span></a></p>
                        </li>
                        <li>
                           <p>有关<code class="codeph">ALTER INDEX</code>的<code class="codeph">PARAMETERS</code>子句的信息，请参阅<a href="../ccref/oracle-text-SQL-statements-and-operators.html#GUID-47E60252-C731-46A8-B587-AE30C1634F48__I996850" target="_blank"><span><cite>Oracle Text Reference</cite></span></a> ...<code class="codeph">重建</code></p>
                        </li>
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=fasterxml_jacksonhome" target="_blank">更快的XML / Jackson</a>获取有关Jackson JSON处理器的信息</p>
                        </li>
                        <li>
                           <p>有关GSON Java库的信息，请访问<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=gson_java_library" target="_blank">google / gson</a></p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="json-dataguide.html#GUID-219FC30E-89A7-4189-BC36-7B961A24067C" title="通过JSON数据指南，您可以发现有关Oracle数据库中存储的JSON文档的结构和内容的信息。">JSON数据指南</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-B57975A8-3000-4F21-BB22-DC413F06D6DB" name="GUID-B57975A8-3000-4F21-BB22-DC413F06D6DB"></a><h3 id="ADJSN-GUID-B57975A8-3000-4F21-BB22-DC413F06D6DB" class="sect3"><span class="enumeration_section">20.3</span>数据指南格式和创建数据指南的方法</h3>
               <div>
                  <p>数据指南有两种格式：平面和分层。两者都可用作SQL和PL / SQL作为<code class="codeph">CLOB</code>数据。您可以根据存储在JSON搜索索引中的数据指南信息或扫描JSON文档来构建数据指南。
                  </p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>您可以使用<span class="italic">平面</span>数据指南<span class="italic">查询</span>数据指南信息，例如字段频率和类型。
                        </p>
                        <p>平面数据指南在JSON中表示为对象<span class="italic">数组</span> ，每个对象表示文档集中特定<span class="italic">路径</span>的JSON数据。<a href="json-dataguide.html#GUID-12BCFCCE-18AE-4CB2-8710-EC7B712DA089" title="描述了样本平面数据指南的字段。它对应于一组采购订单文档。">采购订单文档</a>的平面数据指南描述了<a href="json-data.html#GUID-FBC22D72-AA64-4B0A-92A2-837B32902E2C__CACCBBAI">示例2-1</a>的采购订单数据的平面数据指南。
                        </p>
                     </li>
                     <li>
                        <p>您可以使用<span class="italic">分层</span>数据指南创建视图，或使用您根据数据指南信息选择的特定字段添加虚拟列。
                        </p>
                        <p>分层数据指南在JSON中表示为具有嵌套JSON数据的<span class="italic">对象</span> ，格式与JSON Schema（版本4，json-schema-core）定义的格式相同。<a href="json-dataguide.html#GUID-885E0CB3-9165-448E-96DA-1CC56276F685" title="描述了样本分层数据指南的字段。它对应于一组采购订单文档。">采购订单文档</a>的分层数据指南描述了<a href="json-data.html#GUID-FBC22D72-AA64-4B0A-92A2-837B32902E2C__CACCBBAI">实施例2-1</a>的采购订单数据的分层数据指南。
                        </p>
                     </li>
                  </ul>
                  <p>您使用PL / SQL函数<code class="codeph">DBMS_JSON. <span class="bold">get_index_dataguide</span></code>从存储在JSON搜索索引中的数据指南信息中获取数据指南。
                  </p>
                  <p>您还可以使用SQL聚合函数<code class="codeph"><span class="bold">json_dataguide</span></code>扫描文档集并为其构建数据指南，无论它是否具有启用数据指南的搜索索引。数据指南准确反映了函数调用时的文档集。
                  </p>
                  <div class="tblformal" id="GUID-B57975A8-3000-4F21-BB22-DC413F06D6DB__TABLE-1464-E88A4116">
                     <p class="titleintable">表20-1获取数据指南的SQL和PL / SQL函数</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="SQL和PL / SQL函数获取数据指南" border="1" summary="This table shows the SQL and PL/SQL functions you can use to obtain a JSON data guide, flat or hierarchical, and whether or not the functions use a data guide-enabled search index. Column 1 indicates whether an index is used. Column 2 shows the function to use to obtain a flat data guide. Column 3 shows the function to use to obtain a hierarchical data guide." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="20%" id="d23217e789">使用数据指南启用搜索索引？</th>
                              <th align="left" valign="bottom" width="20%" id="d23217e791">平面数据指南</th>
                              <th align="left" valign="bottom" width="20%" id="d23217e793">分层数据指南</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d23217e797" headers="d23217e789 ">是</td>
                              <td align="left" valign="top" width="20%" headers="d23217e797 d23217e791 ">PL / SQL函数<code class="codeph"><span class="bold">get_index_dataguide</span></code> ，格式为<code class="codeph">DBMS_JSON. <span class="bold">FORMAT_FLAT</span></code></td>
                              <td align="left" valign="top" width="20%" headers="d23217e797 d23217e793 ">PL / SQL函数<code class="codeph"><span class="bold">get_index_dataguide</span></code> ，格式为<code class="codeph">DBMS_JSON. <span class="bold">FORMAT_HIERARCHICAL</span></code></td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d23217e820" headers="d23217e789 ">没有</td>
                              <td align="left" valign="top" width="20%" headers="d23217e820 d23217e791 ">SQL函数<code class="codeph"><span class="bold">json_dataguide</span></code> ，没有格式参数或<code class="codeph"><span class="bold">DBMS_JSON.FORMAT_FLAT</span></code>作为格式参数</td>
                              <td align="left" valign="top" width="20%" headers="d23217e820 d23217e793 ">SQL函数<code class="codeph"><span class="bold">json_dataguide</span></code> ， <code class="codeph"><span class="bold">DBMS_JSON.FORMAT_HIERARCHICAL</span></code>作为格式参数</td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="p">基于启用数据指南的JSON搜索索引获取数据指南的优点包括：<ul style="list-style-type:disc">
                        <li>
                           <p>只要同步索引，文档集的附加更新就会自动反映在持久化数据指南信息中。</p>
                        </li>
                        <li>
                           <p>由于此数据指南信息是持久的，因此通过分析文档集（使用SQL函数<code class="codeph">json_dataguide</code> ）获取基于它的数据指南（使用PL / SQL函数<code class="codeph">get_index_dataguide</code> ）比获取数据指南更快。
                           </p>
                        </li>
                        <li>
                           <p>如果您已收集有关文档集的统计信息，则这些信息将包含在存储的信息和从中获取的数据指南中。</p>
                        </li>
                        <li>
                           <p>创建视图或虚拟列时遇到的列名冲突会自动解决。</p>
                        </li>
                     </ul>
                  </div>
                  <p>在不使用支持数据指南的JSON搜索索引的情况下获得数据指南的优点包括确保数据指南准确且缺乏索引维护开销。此外，在某些特定用例中，不是从索引派生的数据指南是合适的：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>JSON数据位于外部表中。您无法在其上创建索引。</p>
                     </li>
                     <li>
                        <p>可以索引JSON列，但索引不是很有用。例如，如果列包含不同类型的文档，则可能是这种情况。在这种情况下，有时可以帮助向表中添加一列来标识存储在JSON列中的文档类型。然后，您可以将数据指南与SQL聚合函数和<code class="codeph">GROUP BY</code> 。请参阅<a href="json-dataguide.html#GUID-BD147159-87A7-4AAC-B150-44E3F10A81E1" title="数据指南反映了给定JSON文档集的形状。如果JSON列包含具有不同结构或类型信息的不同类型的文档，则可以为不同类型的文档创建和使用不同的数据指南。">每个文档集多个数据指南</a> 。
                        </p>
                     </li>
                  </ul>
                  <div class="section"></div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="json-dataguide.html#GUID-12BCFCCE-18AE-4CB2-8710-EC7B712DA089" title="描述了样本平面数据指南的字段。它对应于一组采购订单文档。">采购订单文件的平面数据指南</a></li>
                        <li><a href="json-dataguide.html#GUID-885E0CB3-9165-448E-96DA-1CC56276F685" title="描述了样本分层数据指南的字段。它对应于一组采购订单文档。">采购订单文档的分层数据指南</a></li>
                        <li><a href="json-dataguide.html#GUID-E77948CB-DCA0-4733-8832-4B5F00C01A2E" title="JSON数据指南信息可以作为JSON搜索索引基础结构的一部分持久保存，并且在添加新的JSON内容时会自动更新此信息。默认情况下，创建JSON搜索索引时就是这种情况：数据引导信息是索引基础结构的一部分。">持久性数据指南信息：JSON搜索索引的一部分</a></li>
                     </ul>
                  </div>
                  <div class="infoboxnotealso" id="GUID-B57975A8-3000-4F21-BB22-DC413F06D6DB__GUID-F254F36F-D0AD-4D56-8028-1406659AF8DC">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>有关<code class="codeph">DBMS_JSON.get_index_dataguide</code>信息，请<code class="codeph">DBMS_JSON.get_index_dataguide</code> <a href="../arpls/DBMS_JSON.html#ARPLS-GUID-52B63CEE-669C-46FB-A276-56F7C6ECD036" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                        </li>
                        <li>
                           <p>有关SQL函数<code class="codeph">json_dataguide</code>信息，请<a href="../sqlrf/JSON_DATAGUIDE.html#SQLRF-GUID-4CF32887-0F46-4925-8381-AE2B74343933" target="_blank"><span><cite>参见Oracle数据库SQL语言参考</cite></span></a></p>
                        </li>
                        <li>
                           <p>有关PL / SQL常量的<code class="codeph">DBMS_JSON.FORMAT_FLAT</code> ，请<code class="codeph">DBMS_JSON.FORMAT_HIERARCHICAL</code> <a href="../arpls/DBMS_JSON.html#ARPLS-GUID-F9032949-7FE1-4A31-AA4B-4A2775F0CBE6" target="_blank"><span><cite>Oracle数据库SQL语言参考</cite></span></a> <code class="codeph">DBMS_JSON.FORMAT_FLAT</code>和<code class="codeph">DBMS_JSON.FORMAT_HIERARCHICAL</code></p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="json-dataguide.html#GUID-219FC30E-89A7-4189-BC36-7B961A24067C" title="通过JSON数据指南，您可以发现有关Oracle数据库中存储的JSON文档的结构和内容的信息。">JSON数据指南</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-D8448CB1-0350-4848-B07E-9370B3B1A9BE" name="GUID-D8448CB1-0350-4848-B07E-9370B3B1A9BE"></a><h3 id="ADJSN-GUID-D8448CB1-0350-4848-B07E-9370B3B1A9BE" class="sect3"><span class="enumeration_section">20.4</span> JSON数据指南字段</h3>
               <div>
                  <p>描述了JSON数据指南的预定义字段。它们包括JSON Schema字段（关键字）和Oracle特定字段。</p>
                  <div class="section">
                     <p>数据指南中给定的字段出现对应于文档集的一个或多个JSON文档中存在的字段。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-D8448CB1-0350-4848-B07E-9370B3B1A9BE__GUID-74564345-3913-4271-8A7D-6681B29C5190">JSON模式字段（关键字）</p>
                     <p>JSON Schema是一个JSON文档，它包含一个JSON对象，它本身可以包含子对象（子程序）。由JSON Schema定义的字段称为JSON Schema <span class="bold"><strong class="term">关键字</strong></span> 。<a href="json-dataguide.html#GUID-D8448CB1-0350-4848-B07E-9370B3B1A9BE__TABLE-1413-EFBCF25B" title="JSON数据指南使用的JSON Schema字段列在第1列中，其值描述在第2列中。">表20-2</a>介绍了可在Oracle JSON数据指南中使用的关键字。关键字<code class="codeph">properties</code> ， <code class="codeph">items</code>和<code class="codeph">oneOf</code>仅在分层JSON数据指南（JSON模式）中使用。关键字<code class="codeph">type</code>用于平面和分层数据指南。
                     </p>
                     <div class="tblformal" id="GUID-D8448CB1-0350-4848-B07E-9370B3B1A9BE__TABLE-1413-EFBCF25B">
                        <p class="titleintable">表20-2 JSON模式字段（关键字）</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="JSON模式字段（关键字）" border="1" summary="JSON Schema fields used by a JSON data guide are listed in column 1, with their value descriptions in column 2." frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="20%" id="d23217e1093">领域（关键字）</th>
                                 <th align="left" valign="bottom" width="20%" id="d23217e1095">价值描述</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d23217e1099" headers="d23217e1093 "><code class="codeph">性能</code></td>
                                 <td align="left" valign="top" width="20%" headers="d23217e1099 d23217e1095 ">
                                    <p>一个对象，其成员表示JSON数据中使用的JSON对象的属性，该对象由分层数据指南（JSON模式）表示。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d23217e1106" headers="d23217e1093 "><code class="codeph">项目</code></td>
                                 <td align="left" valign="top" width="20%" headers="d23217e1106 d23217e1095 ">
                                    <p>一个对象，其成员表示由分层数据指南（JSON模式）表示的JSON数据中使用的数组的元素（项）。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d23217e1113" headers="d23217e1093 "><code class="codeph">oneOf</code></td>
                                 <td align="left" valign="top" width="20%" headers="d23217e1113 d23217e1095 ">
                                    <p>一个数组，其每个项表示由分层数据指南（JSON模式）表示的JSON数据中的一个或多个JSON字段的出现。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d23217e1120" headers="d23217e1093 "><code class="codeph">类型</code></td>
                                 <td align="left" valign="top" width="20%" headers="d23217e1120 d23217e1095 ">
                                    <p>一个字符串，用于命名由（平面或分层）数据指南表示的某些JSON数据的类型。</p>
                                    <p>可能的值为： <code class="codeph">"number"</code> ， <code class="codeph">"string"</code> ， <code class="codeph">"boolean"</code> ， <code class="codeph">"null"</code> ， <code class="codeph">"object"</code> ， <code class="codeph">"array"</code>和<code class="codeph">"GeoJSON"</code> 。
                                    </p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-D8448CB1-0350-4848-B07E-9370B3B1A9BE__JSONDATAGUIDEFIELDS-EFBFC9C4">特定于Oracle的JSON数据指南字段</p>
                     <p>除了JSON Schema关键字之外，JSON数据指南还可以包含Oracle数据指南特定的字段。字段名称都有前缀<span class="bold"><code class="codeph">o:</code></span> .它们在<a href="json-dataguide.html#GUID-D8448CB1-0350-4848-B07E-9370B3B1A9BE__TABLE-1423-EFC0120F" title="JSON数据指南使用的Oracle特定字段列在第1列中，其值描述在第2列中。">表20-3</a>中描述。
                     </p>
                     <div class="tblformal" id="GUID-D8448CB1-0350-4848-B07E-9370B3B1A9BE__TABLE-1423-EFC0120F">
                        <p class="titleintable">表20-3 Oracle特定数据指南字段</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="Oracle特定数据指南字段" border="1" summary="Oracle—specific fields used by a JSON data guide are listed in column 1, with their value descriptions in column 2." frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="20%" id="d23217e1174">领域</th>
                                 <th align="left" valign="bottom" width="20%" id="d23217e1176">价值描述</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d23217e1180" headers="d23217e1174 "><code class="codeph">○：路径</code></td>
                                 <td align="left" valign="top" width="20%" headers="d23217e1180 d23217e1176 ">
                                    <p>通过JSON文档到JSON字段的路径。仅用于<span class="italic">平面</span>数据指南。该值是一个简单的SQL / JSON路径表达式（没有过滤器表达式），可能具有松弛（隐式数组包装和展开），并且可能具有通配符数组步骤。它没有包含数组索引或范围规范的数组步骤，并且没有函数步骤。请参见<a href="json-path-expressions.html#GUID-7B610884-39CD-4910-85E7-C251D342D879" title="SQL / JSON路径表达式由SQL / JSON函数和条件与JSON数据匹配，以选择它的一部分。路径表达式可以使用通配符和数组范围。匹配区分大小写。">SQL / JSON路径表达式语法</a> 。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d23217e1196" headers="d23217e1174 "><code class="codeph">○：长度</code></td>
                                 <td align="left" valign="top" width="20%" headers="d23217e1196 d23217e1176 ">
                                    <p>JSON字段值的最大长度（以字节为单位）。该值始终是2的幂。例如，如果所有实际字段值的最大长度为5，则<code class="codeph">o:length</code>的值为<code class="codeph">o:length</code>的最小幂大于或等于5。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d23217e1206" headers="d23217e1174 "><code class="codeph">○：preferred_column_name</code></td>
                                 <td align="left" valign="top" width="20%" headers="d23217e1206 d23217e1176 ">
                                    <p>对于给定数据指南而言区分大小写且唯一的标识符，您更喜欢将其用作视图列或使用数据指南创建的虚拟列的名称。</p>
                                    <p>如果使用带有格式参数<code class="codeph">DBMS_JSON.FORMAT_FLAT</code> SQL函数<code class="codeph">DBMS_JSON.FORMAT_FLAT</code>或没有任何格式参数（ <code class="codeph">DBMS_JSON.FORMAT_FLAT</code>为<code class="codeph">json_dataguide</code> ）获取数据指南，则此字段不存在。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d23217e1224" headers="d23217e1174 "><code class="codeph">○：频率</code></td>
                                 <td align="left" valign="top" width="20%" headers="d23217e1224 d23217e1176 ">
                                    <p>包含给定字段的JSON文档的百分比。将忽略同一阵列下的字段重复出现。（仅在文档集上收集统计信息时可用。）</p>
                                    <p>如果使用SQL函数<code class="codeph">json_dataguide</code>获取数据指南， <code class="codeph">json_dataguide</code>存在此字段。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d23217e1236" headers="d23217e1174 "><code class="codeph">○：num_nulls</code></td>
                                 <td align="left" valign="top" width="20%" headers="d23217e1236 d23217e1176 ">
                                    <p>目标标量字段的值为JSON <code class="codeph">null</code>的文档数。（仅在文档集上收集统计信息时可用。）
                                    </p>
                                    <p>如果使用SQL函数<code class="codeph">json_dataguide</code>获取数据指南， <code class="codeph">json_dataguide</code>存在此字段。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d23217e1251" headers="d23217e1174 "><code class="codeph">○：HIGH_VALUE</code></td>
                                 <td align="left" valign="top" width="20%" headers="d23217e1251 d23217e1176 ">
                                    <p>所有文档中目标标量字段的最高值。（仅在文档集上收集统计信息时可用。）</p>
                                    <p>如果使用SQL函数<code class="codeph">json_dataguide</code>获取数据指南， <code class="codeph">json_dataguide</code>存在此字段。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d23217e1263" headers="d23217e1174 "><code class="codeph">○：LOW_VALUE</code></td>
                                 <td align="left" valign="top" width="20%" headers="d23217e1263 d23217e1176 ">
                                    <p>所有文档中目标标量字段的最低值。（仅在文档集上收集统计信息时可用。）</p>
                                    <p>如果使用SQL函数<code class="codeph">json_dataguide</code>获取数据指南， <code class="codeph">json_dataguide</code>存在此字段。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d23217e1275" headers="d23217e1174 "><code class="codeph">○：LAST_ANALYZED</code></td>
                                 <td align="left" valign="top" width="20%" headers="d23217e1275 d23217e1176 ">
                                    <p>上次在文档集上收集统计信息的日期和时间。（仅在文档集上收集统计信息时可用。）</p>
                                    <p>如果使用SQL函数<code class="codeph">json_dataguide</code>获取数据指南， <code class="codeph">json_dataguide</code>存在此字段。
                                    </p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p>包含<span class="italic">仅具有标量</span>元素的JSON数组的文档的数据指南信息记录了（1）数组和（2）所有数组元素的路径和类型。对于<span class="italic">元素</span> ：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">o:path</code>值是数组的<code class="codeph">o:path</code>值，后跟带有通配符（ <code class="codeph">[*]</code> ）的数组，表示所有数组元素。
                           </p>
                        </li>
                        <li>
                           <p>如果标量类型对于所有文档中的所有元素<span class="italic">都不相同</span> ，则<code class="codeph">type</code>值为类型<code class="codeph">string</code> 。如果阵列中的<span class="italic">所有</span>标量元素在<span class="italic">所有</span>文档中具有<span class="italic">相同的</span>类型，则记录该类型。
                           </p>
                        </li>
                     </ul>
                     <p>例如，如果在<span class="italic">所有</span>文档中，对象字段<code class="codeph">serial_numbers</code>的数组值中的<span class="italic">所有</span>元素都是JSON编号，则数组元素的<code class="codeph">type</code>是<code class="codeph">number</code> 。否则它是<code class="codeph">string</code> 。
                     </p>
                     <p>如果存在，字段<code class="codeph">o:preferred_column_name</code>的默认值取决于是使用SQL函数<code class="codeph">json_dataguide</code> （格式为<code class="codeph">DBMS_JSON.FORMAT_HIERARCHICAL</code> ）还是使用PL / SQL函数<code class="codeph">DBMS_JSON.get_index_dataguide</code>获取数据指南：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">json_dataguide</code> （分层格式） - 与相应的JSON字段名称相同。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">get_index_dataguide</code> - 与相应的JSON字段名称相同，前缀为JSON列名称后跟<span class="bold"><code class="codeph">$</code></span> ，并删除了任何非ASCII字符。如果结果字段名称已存在于同一数据指南中，则后缀为新序列号，以使其唯一。
                           </p>
                           <p>列名称为大写，除非使用转义的小写字母定义列（例如， <code class="codeph">'PO_Column'</code>而不是<code class="codeph">po_column</code> ）。
                           </p>
                           <p>例如，JSON列<code class="codeph">po_document</code>数据字段<code class="codeph">User</code>的默认值为<code class="codeph"><span class="bold">PO_DOCUMENT$</span> User</code> 。
                           </p>
                        </li>
                     </ul>
                     <p>您可以使用PL / SQL过程<code class="codeph">DBMS_JSON.rename_column</code>为给定字段和类型设置<code class="codeph">o:preferred_column_name</code>的值。
                     </p>
                     <p>字段<code class="codeph">o:preferred_column_name</code>用于在包含JSON列的表中命名新的虚拟列，或者用于命名新视图中的列，该列还包含表的其他列。在任何一种情况下， <code class="codeph">o:preferred_column_name</code>指定的名称必须相对于表的其他列名称是<span class="italic">唯一</span>的。此外，该名称在文档集中的任何类型的所有JSON字段中必须是<span class="italic">唯一的</span> 。使用<code class="codeph">DBMS_JSON.get_index_dataguide</code> ，默认名称在这些方面<span class="italic">保证</span>是唯一的。
                     </p>
                     <p>如果使用<code class="codeph">DBMS_JSON.rename_column</code>指定的名称导致名称冲突，则忽略指定的名称，而使用系统生成的名称。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section"></div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="json-dataguide.html#GUID-A0AFD360-93A7-4566-8315-6F68D9AE090B" title="您可以将数据中的JSON字段作为数据库视图中的列或作为添加到包含JSON列的同一表的虚拟列进行投影。您可以为此类列指定首选名称。">为字段列指定首选名称</a></li>
                        <li><a href="json-dataguide.html#GUID-12BCFCCE-18AE-4CB2-8710-EC7B712DA089" title="描述了样本平面数据指南的字段。它对应于一组采购订单文档。">采购订单文件的平面数据指南</a></li>
                        <li><a href="json-dataguide.html#GUID-885E0CB3-9165-448E-96DA-1CC56276F685" title="描述了样本分层数据指南的字段。它对应于一组采购订单文档。">采购订单文档的分层数据指南</a></li>
                        <li><a href="using-GeoJSON-geographic-data.html#GUID-2AD827B4-871E-4652-87F3-AC33FE7839AE" title="GeoJSON对象是表示地理数据的JSON对象。提供了创建GeoJSON数据，对其进行索引以及查询的示例。">使用GeoJSON地理数据</a></li>
                     </ul>
                  </div>
                  <div class="infoboxnotealso" id="GUID-D8448CB1-0350-4848-B07E-9370B3B1A9BE__GUID-CA8E246C-90F8-4331-B553-4D8BD17BC7A4">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>有关<code class="codeph">DBMS_JSON.get_index_dataguide</code>信息，请<code class="codeph">DBMS_JSON.get_index_dataguide</code> <a href="../arpls/DBMS_JSON.html#ARPLS-GUID-52B63CEE-669C-46FB-A276-56F7C6ECD036" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                        </li>
                        <li>
                           <p>有关<code class="codeph">DBMS_JSON.rename_column</code>信息，请<code class="codeph">DBMS_JSON.rename_column</code> <a href="../arpls/DBMS_JSON.html#ARPLS-GUID-0E802354-4508-4DF7-A07A-6999F3337CA5" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                        </li>
                        <li>
                           <p>有关SQL函数<code class="codeph">json_dataguide</code>信息，请<a href="../sqlrf/JSON_DATAGUIDE.html#SQLRF-GUID-4CF32887-0F46-4925-8381-AE2B74343933" target="_blank"><span><cite>参见Oracle数据库SQL语言参考</cite></span></a></p>
                        </li>
                        <li>
                           <p><a href="../spatl/spatial-concepts.html#SPATL-GUID-D703DF4D-57D1-4990-8F53-CAAA9C8FCB2F" target="_blank"><span><cite>Oracle Spatial and Graph Developer's Guide</cite></span></a> ，了解有关将Oracle GeoJSON数据与Oracle Spatial和Graph一起使用的信息</p>
                        </li>
                        <li>
                           <p><a href="../spatl/spatial-concepts.html#SPATL-GUID-67E4037F-C40F-442A-8662-837DD5539784" target="_blank"><span><cite>Oracle Spatial and Graph Developer's Guide</cite></span></a> ，了解有关Oracle Spatial and Graph和<code class="codeph">SDO_GEOMETRY</code>对象类型的信息</p>
                        </li>
                        <li>
                           <p>有关GeoJSON的信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=geojson_org" target="_blank">参阅GeoJSON.org</a></p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="json-dataguide.html#GUID-219FC30E-89A7-4189-BC36-7B961A24067C" title="通过JSON数据指南，您可以发现有关Oracle数据库中存储的JSON文档的结构和内容的信息。">JSON数据指南</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-70D47F29-BA01-4908-A5C1-8EB10AAB89A0" name="GUID-70D47F29-BA01-4908-A5C1-8EB10AAB89A0"></a><h3 id="ADJSN-GUID-70D47F29-BA01-4908-A5C1-8EB10AAB89A0" class="sect3"><span class="enumeration_section">20.5</span>持久数据指南信息的数据字典视图</h3>
               <div>
                  <p>您可以查询静态数据字典视图，以查看哪些表具有启用了数据引导的JSON搜索索引的JSON列，并提取记录在启用了dataguide的JSON搜索索引中的JSON对象字段信息。</p>
                  <p>视图中不存在没有带有数据引导启用索引的JSON列的表。</p>
                  <p>您可以使用以下视图<span class="italic">查找</span>具有启用数据引导的JSON搜索索引的列。这些视图包含<code class="codeph">TABLE_NAME</code> （表名）列， <code class="codeph">COLUMN_NAME</code> （JSON列名）和<code class="codeph">DATAGUIDE</code> （数据指南）。
                  </p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><code class="codeph">USER_JSON_ <span class="bold">DATAGUIDES</span></code> - 当前用户拥有的表</p>
                     </li>
                     <li>
                        <p><code class="codeph">ALL_JSON_ <span class="bold">DATAGUIDES</span></code> - 当前用户可访问的表</p>
                     </li>
                     <li>
                        <p><code class="codeph">DBA_JSON_ <span class="bold">DATAGUIDES</span></code> - 所有表格</p>
                     </li>
                  </ul>
                  <p>如果JSON列具有启用数据引导的JSON搜索索引，则列<code class="codeph">DATAGUIDE</code>的值是JSON列的数据指南，以平面格式作为<code class="codeph">CLOB</code>实例。如果它没有启用数据引导的索引，则视图中的该列没有行。
                  </p>
                  <div class="p">您可以使用以下视图提取JSON字段路径，并键入在支持dataguide的JSON搜索索引中记录的信息。视图包含<code class="codeph">TABLE_NAME</code> ， <code class="codeph">COLUMN_NAME</code> ， <code class="codeph">PATH</code> ， <code class="codeph">TYPE</code>和<code class="codeph">LENGTH</code> 。列<code class="codeph">PATH</code> ， <code class="codeph">TYPE</code>和<code class="codeph">LENGTH</code>对应于数据引导字段<code class="codeph">o:path</code> ， <code class="codeph">o:type</code>和<code class="codeph">o:length</code> 。
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">USER_JSON_DATAGUIDE_ <span class="bold">FIELDS</span></code> - 当前用户拥有的表</p>
                        </li>
                        <li>
                           <p><code class="codeph">ALL_JSON_DATAGUIDE_ <span class="bold">FIELDS</span></code> - 当前用户可访问的表</p>
                        </li>
                        <li>
                           <p><code class="codeph">DBA_JSON_DATAGUIDE_ <span class="bold">FIELDS</span></code> - 所有表格</p>
                        </li>
                     </ul>
                  </div>
                  <p>对于两种类型的视图，名称具有前缀<code class="codeph">ALL_</code>或<code class="codeph">DBA_</code>的视图也具有列<code class="codeph">OWNER</code> ，其值为表所有者。
                  </p>
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-70D47F29-BA01-4908-A5C1-8EB10AAB89A0__GUID-8DAC6E24-37C6-4416-8915-1A638FA9EE33">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>有关<code class="codeph">ALL_JSON_DATAGUIDES</code>和相关数据字典视图的信息，请<code class="codeph">ALL_JSON_DATAGUIDES</code> <a href="../refrn/ALL_JSON_DATAGUIDES.html#REFRN-GUID-36B8E1C7-614E-4085-B75F-57875795890A" target="_blank"><span><cite>Oracle数据库参考</cite></span></a></p>
                        </li>
                        <li>
                           <p>有关<code class="codeph">ALL_JSON_DATAGUIDE_FIELDS</code>和相关数据字典视图的信息，请<code class="codeph">ALL_JSON_DATAGUIDE_FIELDS</code> <a href="../refrn/ALL_JSON_DATAGUIDE_FIELDS.html#REFRN-GUID-7DF39B7B-ED39-4DAD-960F-E604A8340C06" target="_blank"><span><cite>Oracle数据库参考</cite></span></a></p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="json-dataguide.html#GUID-219FC30E-89A7-4189-BC36-7B961A24067C" title="通过JSON数据指南，您可以发现有关Oracle数据库中存储的JSON文档的结构和内容的信息。">JSON数据指南</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-A0AFD360-93A7-4566-8315-6F68D9AE090B" name="GUID-A0AFD360-93A7-4566-8315-6F68D9AE090B"></a><h3 id="ADJSN-GUID-A0AFD360-93A7-4566-8315-6F68D9AE090B" class="sect3"><span class="enumeration_section">20.6</span>为字段列指定首选名称</h3>
               <div>
                  <p>您可以将数据中的JSON字段作为数据库视图中的列或作为添加到包含JSON列的同一表的虚拟列进行投影。您可以为此类列指定首选名称。</p>
                  <div class="section">
                     <p>从同一文档集获得的数据指南用于定义该投影。每个预计列的名称取自数据引导字段<code class="codeph">o:preferred_column_name</code>用于要投影的JSON数据字段。指定首选名称会更改此数据指南字段的值。
                     </p>
                     <p>如果您的JSON数据具有启用数据指南的搜索索引，则可以使用过程<code class="codeph">DBMS_JSON.rename_column</code>指定从给定字段投影的列的首选名称。<a href="json-dataguide.html#GUID-A0AFD360-93A7-4566-8315-6F68D9AE090B__GUID-9EE57EFD-D53A-46EE-9DEF-A4E8FC7D9FB1">例20-4</a>说明了这一点。它指定要从各个字段投影的列的首选名称，如<a href="json-dataguide.html#GUID-A0AFD360-93A7-4566-8315-6F68D9AE090B__TABLE-1442-F4DC8EFF" title="此三列表显示了JSON采购订单文档及其类型的某些字段的首选列名称。第1列显示字段名称。第2列显示了字段的JSON类型。第3列显示了首选列名称。">表20-4中所述</a> 。（当您使用过程<code class="codeph">DBMS_JSON.create_view</code> ， <code class="codeph">DBMS_JSON.create_view_on_path</code>或<code class="codeph">DBMS_JSON.add_virtual_columns</code>时，这些字段将被投影为列。）
                     </p> 
                     <div class="tblformalwide" id="GUID-A0AFD360-93A7-4566-8315-6F68D9AE090B__TABLE-1442-F4DC8EFF">
                        <p class="titleintable">表20-4某些JSON字段列的首选名称</p>
                        <table cellpadding="4" cellspacing="0" class="FormalWide" title="某些JSON字段列的首选名称" width="100%" border="1" summary="This three-column table shows the preferred column names for some fields of JSON purchase-order documents and their types. Column 1 shows the field name. Column 2 shows the JSON type of the field. Column 3 shows the preferred column name." frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="20%" id="d23217e1809">领域</th>
                                 <th align="left" valign="bottom" width="20%" id="d23217e1811">JSON类型</th>
                                 <th align="left" valign="bottom" width="20%" id="d23217e1813">首选列名称</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d23217e1817" headers="d23217e1809 "><code class="codeph">订单号</code></td>
                                 <td align="left" valign="top" width="20%" headers="d23217e1817 d23217e1811 "><code class="codeph">数</code></td>
                                 <td align="left" valign="top" width="20%" headers="d23217e1817 d23217e1813 "><code class="codeph"><span class="bold">订单号</span></code></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d23217e1828" headers="d23217e1809 "><code class="codeph">Phone</code> （电话为字符串，不是对象 - 只是数字）</td>
                                 <td align="left" valign="top" width="20%" headers="d23217e1828 d23217e1811 "><code class="codeph">串</code></td>
                                 <td align="left" valign="top" width="20%" headers="d23217e1828 d23217e1813 "><code class="codeph"><span class="bold">电话</span></code></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d23217e1840" headers="d23217e1809 "><code class="codeph">type</code> （手机型号）</td>
                                 <td align="left" valign="top" width="20%" headers="d23217e1840 d23217e1811 "><code class="codeph">串</code></td>
                                 <td align="left" valign="top" width="20%" headers="d23217e1840 d23217e1813 "><code class="codeph"><span class="bold">PHONETYPE</span></code></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d23217e1852" headers="d23217e1809 "><code class="codeph">number</code> （电话号码）</td>
                                 <td align="left" valign="top" width="20%" headers="d23217e1852 d23217e1811 "><code class="codeph">串</code></td>
                                 <td align="left" valign="top" width="20%" headers="d23217e1852 d23217e1813 "><code class="codeph"><span class="bold">电话号码</span></code></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d23217e1864" headers="d23217e1809 "><code class="codeph">ItemNumber</code> （行项目编号）</td>
                                 <td align="left" valign="top" width="20%" headers="d23217e1864 d23217e1811 "><code class="codeph">数</code></td>
                                 <td align="left" valign="top" width="20%" headers="d23217e1864 d23217e1813 "><code class="codeph"><span class="bold">项目编号</span></code></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d23217e1876" headers="d23217e1809 "><code class="codeph">Description</code> （部分说明）</td>
                                 <td align="left" valign="top" width="20%" headers="d23217e1876 d23217e1811 "><code class="codeph">串</code></td>
                                 <td align="left" valign="top" width="20%" headers="d23217e1876 d23217e1813 "><code class="codeph"><span class="bold">部分说明</span></code></td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <div class="infoboxnotealso" id="GUID-A0AFD360-93A7-4566-8315-6F68D9AE090B__GUID-F00A5D09-CADA-4EF6-A978-A04620E79629">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="json-dataguide.html#GUID-D8448CB1-0350-4848-B07E-9370B3B1A9BE" title="描述了JSON数据指南的预定义字段。它们包括JSON Schema字段（关键字）和Oracle特定字段。">JSON数据指南字段，</a>用于获取有关字段<code class="codeph">o:preferred_column_name</code>的默认值的信息以及使用<code class="codeph">DBMS_JSON.rename_column</code>时名称冲突的可能性</p>
                           </li>
                           <li>
                              <p><a href="creating-a-table-with-a-json-column.html#GUID-E6CC0DCF-3D72-41EF-ACA4-B3BF54EE3CA0" title="您可以创建具有JSON列的表。您使用SQL条件是json作为检查约束，以确保插入到列中的数据是（格式正确的）JSON数据。Oracle建议您在创建用于JSON数据的列时始终使用is_json检查约束。">使用JSON列创建表以</a>获取有关此处引用的JSON数据的信息</p>
                           </li>
                           <li>
                              <p>有关<code class="codeph">DBMS_JSON.create_view</code>信息，请<code class="codeph">DBMS_JSON.create_view</code> <a href="../arpls/DBMS_JSON.html#ARPLS-GUID-9A634A69-6F96-43E2-9A44-80FD21E262C1" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                           </li>
                           <li>
                              <p>有关<code class="codeph">DBMS_JSON.create_view_on_path</code>信息，请<code class="codeph">DBMS_JSON.create_view_on_path</code> <a href="../arpls/DBMS_JSON.html#ARPLS-GUID-F6FCD886-191D-4F2E-8767-62CFDC762FC1" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                           </li>
                           <li>
                              <p>有关<code class="codeph">DBMS_JSON.rename_column</code>信息，请<code class="codeph">DBMS_JSON.rename_column</code> <a href="../arpls/DBMS_JSON.html#ARPLS-GUID-0E802354-4508-4DF7-A07A-6999F3337CA5" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                           </li>
                           <li>
                              <p>有关<code class="codeph">DBMS_JSON.add_virtual_columns</code>信息，请<code class="codeph">DBMS_JSON.add_virtual_columns</code> <a href="../arpls/DBMS_JSON.html#ARPLS-GUID-69DD0940-58EA-48D8-A635-097A6BA7A31B" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-A0AFD360-93A7-4566-8315-6F68D9AE090B__GUID-9EE57EFD-D53A-46EE-9DEF-A4E8FC7D9FB1">
                     <p class="titleinexample">示例20-4为某些JSON字段指定首选列名称</p><pre class="pre codeblock"><code>BEGIN DBMS_JSON.rename_column（'J_PURCHASEORDER'，'PO_DOCUMENT'，'$。PONumber'，DBMS_JSON.TYPE_NUMBER，' <span class="bold">PONumber</span> '）; DBMS_JSON.rename_column（'J_PURCHASEORDER'，'PO_DOCUMENT'，'$。ShippingInstructions。电话'，DBMS_JSON.TYPE_STRING，' <span class="bold">电话</span> '）; DBMS_JSON.rename_column（'J_PURCHASEORDER'，'PO_DOCUMENT'，'$。ShippingInstructions。Phone.type'，DBMS_JSON.TYPE_STRING，' <span class="bold">PhoneType</span> '）; DBMS_JSON.rename_column（'J_PURCHASEORDER'，'PO_DOCUMENT'，'$。ShippingInstructions。Phone.number'，DBMS_JSON.TYPE_STRING，' <span class="bold">PhoneNumber</span> '）; DBMS_JSON.rename_column（'J_PURCHASEORDER'，'PO_DOCUMENT'，'$。了LineItem。ItemNumber'，DBMS_JSON.TYPE_NUMBER，' <span class="bold">ItemNumber</span> '）; DBMS_JSON.rename_column（'J_PURCHASEORDER'，'PO_DOCUMENT'，'$。了LineItem。部分。描述'，DBMS_JSON.TYPE_STRING，' <span class="bold">PartDescription</span> '）;结束; /</code></pre></div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="json-dataguide.html#GUID-219FC30E-89A7-4189-BC36-7B961A24067C" title="通过JSON数据指南，您可以发现有关Oracle数据库中存储的JSON文档的结构和内容的信息。">JSON数据指南</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-394009D2-F829-49B0-B6EF-DB24606FEF75" name="GUID-394009D2-F829-49B0-B6EF-DB24606FEF75"></a><h3 id="ADJSN-GUID-394009D2-F829-49B0-B6EF-DB24606FEF75" class="sect3"><span class="enumeration_section">20.7</span>基于数据指南信息创建基于JSON数据的视图</h3>
               <div>
                  <p>根据数据指南信息，您可以创建一个数据库视图，其列投影一组JSON文档中的特定标量字段。您可以通过编辑分层数据指南或指定SQL / JSON路径表达式和字段出现的最小频率来选择要投影的字段。</p>
                  <div class="section">
                     <p>（您可以基于相同的JSON文档集创建多个视图，投影不同的字段。请参阅<a href="json-dataguide.html#GUID-BD147159-87A7-4AAC-B150-44E3F10A81E1" title="数据指南反映了给定JSON文档集的形状。如果JSON列包含具有不同结构或类型信息的不同类型的文档，则可以为不同类型的文档创建和使用不同的数据指南。">每个文档集的多个数据指南</a> 。）
                     </p>
                     <p>您可以使用SQL / JSON函数<code class="codeph">json_table</code>通过投影JSON字段来<a href="function-JSON_TABLE.html#GUID-BFA1FB9A-0F18-4ED2-B504-6855DC6705B5" title="To improve query performance you can create a view over JSON data that you project to columns using SQL/JSON function json_table. To further improve query performance you can create a materialized view and place the JSON data in memory.">创建视图</a> - 请参阅<a href="function-JSON_TABLE.html#GUID-BFA1FB9A-0F18-4ED2-B504-6855DC6705B5" title="为了提高查询性能，您可以使用SQL / JSON函数json_table创建投影到列的JSON数据视图。为了进一步提高查询性能，您可以创建物化视图并将JSON数据放在内存中。">使用JSON_TABLE创建基于JSON数据的视图</a> 。另一种方法是使用PL / SQL过程<code class="codeph">DBMS_JSON.create_view</code>或<code class="codeph">DBMS_JSON.create_view_on_path</code>通过根据可用的数据指南信息投影您选择的字段来创建视图。
                     </p>
                     <p>此信息可以来自分层数据指南，该指南仅包括要投影的字段，也可以来自启用数据指南的JSON搜索索引以及SQL / JSON路径表达式和最小字段频率。</p>
                     <p>在前一种情况下，使用过程<code class="codeph">create_view</code> 。您可以编辑（分层）数据指南以指定所需的字段。在这种情况下，你<span class="italic">不需要</span>启用引导数据搜索索引。
                     </p>
                     <p>在后一种情况下，使用过程<code class="codeph">create_view_on_path</code> 。在这种情况下，您需要启用数据指南的搜索索引，但不需要数据指南。您提供SQL / JSON路径表达式，并可能提供最低出现频率。投影的文档集中的字段包括：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>所有不在数组下的标量字段。</p>
                        </li>
                        <li>
                           <p>所有标量字段在任何级别上都存在于给定SQL / JSON路径表达式所针对的数据中。</p>
                        </li>
                     </ul>
                     <p>无论您创建视图的方式如何，除了作为列投影的JSON字段之外，表的非JSON列也是视图的列。</p>
                     <p>如果使用过程<code class="codeph">create_view_on_path</code>则您提供的<span class="italic"><code class="codeph">PATH</code></span>参数必须是简单的SQL / JSON路径表达式（无过滤器表达式），可能具有松弛（隐式数组包装和展开），但没有数组步骤且没有函数步骤。请参见<a href="json-path-expressions.html#GUID-7B610884-39CD-4910-85E7-C251D342D879" title="SQL / JSON路径表达式由SQL / JSON函数和条件与JSON数据匹配，以选择它的一部分。路径表达式可以使用通配符和数组范围。匹配区分大小写。">SQL / JSON路径表达式语法</a> 。
                     </p>
                     <p>无论如何创建，作为给定视图定义基础的数据指南都是静态的，并不一定忠实地反映文档集中的当前数据。创建视图时将确定为视图投影的字段。</p>
                     <p>特别是，如果您使用<code class="codeph">create_view_on_path</code> （需要启用数据引导的搜索索引），那么基于<span class="italic">视图时</span>的<span class="italic">索引数据，</span>由给定路径表达式指定且至少具有给定频率的字段的数量是多少。 <span class="italic">创作</span> 。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section"></div>
                  <!-- class="section" -->
                  <div class="section"></div>
                  <!-- class="section" -->
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="json-dataguide.html#GUID-90EC7EB8-7D45-4CB7-B16E-97BA3427D35F">基于分层数据指南创建基于JSON数据的视图</a><br>您可以使用分层数据指南来创建数据库视图，该数据库视图的列从文档中投影指定的JSON字段。投影的字段是数据指南中的字段。您可以编辑数据指南以仅包括要投影的字段。
                     </li>
                     <li class="ulchildlink"><a href="json-dataguide.html#GUID-B6A1D87D-9EE8-47F0-8325-96A366254488">基于路径表达式创建基于JSON数据的视图</a><br>您可以使用启用数据指南的JSON搜索索引中的信息来创建数据库视图，该视图的列从文档中投影JSON字段。投影的字段是不在数组下的标量字段加上指定的SQL / JSON路径表达式所针对的数据中的标量字段。
                     </li>
                  </ul>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="function-JSON_TABLE.html#GUID-BFA1FB9A-0F18-4ED2-B504-6855DC6705B5" title="为了提高查询性能，您可以使用SQL / JSON函数json_table创建投影到列的JSON数据视图。为了进一步提高查询性能，您可以创建物化视图并将JSON数据放在内存中。">使用JSON_TABLE创建JSON数据视图</a></li>
                     </ul>
                  </div>
                  <div class="infoboxnotealso" id="GUID-394009D2-F829-49B0-B6EF-DB24606FEF75__GUID-1F2347AF-EA79-4376-B8B5-FA492325A29A">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>有关<code class="codeph">DBMS_JSON.create_view</code>信息，请<code class="codeph">DBMS_JSON.create_view</code> <a href="../arpls/DBMS_JSON.html#ARPLS-GUID-9A634A69-6F96-43E2-9A44-80FD21E262C1" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                        </li>
                        <li>
                           <p>有关<code class="codeph">DBMS_JSON.create_view_on_path</code>信息，请<code class="codeph">DBMS_JSON.create_view_on_path</code> <a href="../arpls/DBMS_JSON.html#ARPLS-GUID-F6FCD886-191D-4F2E-8767-62CFDC762FC1" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="json-dataguide.html#GUID-219FC30E-89A7-4189-BC36-7B961A24067C" title="通过JSON数据指南，您可以发现有关Oracle数据库中存储的JSON文档的结构和内容的信息。">JSON数据指南</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="sect3"><a id="GUID-90EC7EB8-7D45-4CB7-B16E-97BA3427D35F" name="GUID-90EC7EB8-7D45-4CB7-B16E-97BA3427D35F"></a><h4 id="ADJSN-GUID-90EC7EB8-7D45-4CB7-B16E-97BA3427D35F" class="sect4"><span class="enumeration_section">20.7.1</span>基于分层数据指南创建基于JSON数据的视图</h4>
                  <div>
                     <p>您可以使用分层数据指南来创建数据库视图，该数据库视图的列从文档中投影指定的JSON字段。投影的字段是数据指南中的字段。您可以编辑数据指南以仅包括要投影的字段。</p>
                     <div class="section">
                        <p>您可以使用PL / SQL函数<code class="codeph">DBMS_JSON.get_index_dataguide</code>或带有参数<code class="codeph">DBMS_JSON.FORMAT_HIERARCHICAL</code> SQL函数<code class="codeph">json_dataguide</code>获取分层数据指南。在前一种情况下，必须在JSON数据列上定义启用数据引导的JSON搜索索引。
                        </p>
                        <p>您可以编辑获取的数据指南，使其仅包含特定字段，更改给定类型的长度或重命名字段。生成的数据指南指定要作为视图列投影的JSON数据的哪些字段。</p>
                        <p>您使用PL / SQL过程<code class="codeph">DBMS_JSON.create_view</code>来创建视图。
                        </p>
                        <p><a href="json-dataguide.html#GUID-90EC7EB8-7D45-4CB7-B16E-97BA3427D35F__CREATINGAVIEWUSINGAHIERARCHICALDATA-F645E6C8">例20-5</a>使用<code class="codeph">DBMS_JSON.get_index_dataguide</code>获得的数据指南说明了这<code class="codeph">DBMS_JSON.get_index_dataguide</code> 。<a href="json-dataguide.html#GUID-90EC7EB8-7D45-4CB7-B16E-97BA3427D35F__GUID-5179B888-D665-4D40-A117-6A0B2FD81532">实施例20-6</a>示出了使用与获得的数据引导它<code class="codeph">json_dataguide</code>带有参数<code class="codeph">DBMS_JSON.FORMAT_HIERARCHICAL</code> 。</p>
                        <p>如果使用通过<code class="codeph">json_dataguide</code>获得的数据指南创建视图，则支持文档中的GeoJSON数据。在这种情况下，对应于GeoJSON数据的视图列具有SQL数据类型<code class="codeph">SDO_GEOMETRY</code> 。为此，您将常量<code class="codeph">DBMS_JSON.GEOJSON</code>或<code class="codeph">DBMS_JSON.GEOJSON+DBMS_JSON.PRETTY</code>作为<code class="codeph">DBMS_JSON.GEOJSON+DBMS_JSON.PRETTY</code>的第三个参数<code class="codeph">json_dataguide</code> 。
                        </p>
                        <div class="infoboxnotealso" id="GUID-90EC7EB8-7D45-4CB7-B16E-97BA3427D35F__GUID-D7A0456F-8DA3-45E5-B161-BE3021A0A9E5">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>有关<code class="codeph">DBMS_JSON.create_view</code>信息，请<code class="codeph">DBMS_JSON.create_view</code> <a href="../arpls/DBMS_JSON.html#ARPLS-GUID-9A634A69-6F96-43E2-9A44-80FD21E262C1" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                              </li>
                              <li>
                                 <p>有关<code class="codeph">DBMS_JSON.get_index_dataguide</code>信息，请<code class="codeph">DBMS_JSON.get_index_dataguide</code> <a href="../arpls/DBMS_JSON.html#ARPLS-GUID-52B63CEE-669C-46FB-A276-56F7C6ECD036" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                              </li>
                              <li>
                                 <p>有关<code class="codeph">DBMS_JSON.rename_column</code>信息，请<code class="codeph">DBMS_JSON.rename_column</code> <a href="../arpls/DBMS_JSON.html#ARPLS-GUID-0E802354-4508-4DF7-A07A-6999F3337CA5" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                              </li>
                              <li>
                                 <p>有关SQL函数<code class="codeph">json_dataguide</code>信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=SQLRF-GUID-4CF32887-0F46-4925-8381-AE2B74343933" target="_blank"><span><cite>参见Oracle数据库SQL语言参考</cite></span></a></p>
                              </li>
                              <li>
                                 <p>有关PL / SQL常量<code class="codeph">DBMS_JSON.FORMAT_HIERARCHICAL</code>信息，请<a href="../arpls/DBMS_JSON.html#ARPLS-GUID-F9032949-7FE1-4A31-AA4B-4A2775F0CBE6" target="_blank"><span><cite>参见Oracle数据库SQL语言参考</cite></span></a></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-90EC7EB8-7D45-4CB7-B16E-97BA3427D35F__CREATINGAVIEWUSINGAHIERARCHICALDATA-F645E6C8">
                        <p class="titleinexample">示例20-5使用GET_INDEX_DATAGUIDE获取的分层数据指南创建视图</p>
                        <p>此示例创建一个视图，该视图<code class="codeph">po_document</code>分层数据指南中存在的所有字段，这些字段是从表<code class="codeph">j_purchaseorder</code> JSON列<code class="codeph">po_document</code>上的数据指南启用的JSON搜索索引中<code class="codeph">j_purchaseorder</code> 。（在<code class="codeph">describe</code>命令输出中名称为<span class="italic"><code class="codeph">italic</code></span>列是那些使用PL / SQL过程<code class="codeph">DBMS_JSON.rename_column</code>重命名的<code class="codeph">DBMS_JSON.rename_column</code> 。）
                        </p><pre class="pre codeblock"><code>EXEC DBMS_JSON.create_view（'VIEW1'，'J_PURCHASEORDER'，'PO_DOCUMENT'， <span class="bold">DBMS_JSON.get_index_dataguide</span> （'J_PURCHASEORDER'，'PO_DOCUMENT'， <span class="bold">DBMS_JSON.FORMAT_HIERARCHICAL</span> ））; DESCRIBE view1名称是否为空？输入-------------------------------- -------- --------- ------------------ DATE_LOADED TIMESTAMP（6）WITH TIME ZONE ID NOT NULL RAW（16）PO_DOCUMENT $ User VARCHAR2（8） <span class="italic">PONumber</span> NUMBER PO_DOCUMENT $ Reference VARCHAR2（16）PO_DOCUMENT $ Requestor VARCHAR2（16）PO_DOCUMENT $ CostCenter VARCHAR2（4）PO_DOCUMENT $ AllowPartialShipment VARCHAR2（4）PO_DOCUMENT $ name VARCHAR2（16） <span class="italic">Phone</span> VARCHAR2（16）PO_DOCUMENT $ city VARCHAR2（32）PO_DOCUMENT $ state VARCHAR2（2）PO_DOCUMENT $ street VARCHAR2 （32）PO_DOCUMENT $ country VARCHAR2（32）PO_DOCUMENT $ zipCode NUMBER PO_DOCUMENT $ SpecialInstructions VARCHAR2（8）PO_DOCUMENT $ UPCCode NUMBER PO_DOCUMENT $ UnitPrice NUMBER <span class="italic">PartDescription</span> VARCHAR2（32）PO_DOCUMENT $ Quantity NUMBER <span class="italic">ItemNumber</span> NUMBER <span class="italic">PhoneType</span> VARCHAR2（8） <span class="italic">PhoneNumber</span> VARCHAR2（16）</code></pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-90EC7EB8-7D45-4CB7-B16E-97BA3427D35F__GUID-5179B888-D665-4D40-A117-6A0B2FD81532">
                        <p class="titleinexample">示例20-6使用JSON_DATAGUIDE获取的分层数据指南创建视图</p>
                        <p>本示例创建突出全部是通过调用SQL函数而获得本分层数据指南中的字段的视图<code class="codeph">json_dataguide</code>上<code class="codeph">po_document</code>表<code class="codeph">j_purchaseorder</code> 。传递给<code class="codeph">json_dataguide</code>的第二个和第三个参数分别用于指定数据指南是分层的和漂亮的打印。
                        </p>
                        <p>请注意，这里没有任何视图列名称具有前缀<code class="codeph">PO_DOCUMENT$</code> 。仅当您使用从启用数据指南的JSON搜索索引中的信息中获取的数据指南时，才使用该前缀。
                        </p>
                        <p><code class="codeph">json_dataguide</code>返回的数据指南仅包含<code class="codeph">o:path</code> ， <code class="codeph">type</code> ， <code class="codeph">o:length</code>和<code class="codeph">o:preferred_column_name</code>作为其预定义字段。字段<code class="codeph">o:preferred_column_name</code>的值与字段名称相同。（当然可以没有包含统计信息的字段，因为它只能存储在索引中。）
                        </p>
                        <p>视图列名称来自您传递给<code class="codeph">DBMS_JSON.create_view</code>的数据指南的字段<code class="codeph">o:preferred_column_name</code>的值。默认情况下，视图列的名称与投影字段相同。
                        </p>
                        <p>由于列必须在视图中唯一命名，因此<span class="italic">必须确保</span>字段名称本身是唯一的，否则您必须编辑<code class="codeph">json_dataguide</code>返回的数据指南，以添加确保唯一性的相应<code class="codeph">o:preferred_column_name</code>条目。如果列的名称不唯一，则<code class="codeph">DBMS_JSON.create_view</code>会引发错误。
                        </p><pre class="pre codeblock"><code>DECLARE dg CLOB; BEGIN SELECT <span class="bold">json_dataguide（po_document，FORMAT</span> DBMS_JSON <span class="bold">FORMAT_HIERARCHICAL，DBMS_JSON</span> <span class="bold">漂亮</span> 。。）INTO <span class="bold">DG</span> FROM j_purchaseorder WHERE提取物（YEAR FROM date_loaded）= 2014; DBMS_JSON.create_view（'MYVIEW'，'J_PURCHASEORDER'，'PO_DOCUMENT'， <span class="bold">dg</span> ）;结束; / DESCRIBE myview Name Null？输入-------------------- -------- --------------------- ------ DATE_LOADED TIMESTAMP（6）WITH TIME ZONE ID NOT NULL RAW（16）User VARCHAR2（8）PONumber NUMBER UPCCode NUMBER UnitPrice NUMBER说明VARCHAR2（32）数量NUMBER ItemNumber NUMBER参考VARCHAR2（16）请求者VARCHAR2（16） ）CostCenter VARCHAR2（4）AllowPartialShipment VARCHAR2（4）name VARCHAR2（16）Phone VARCHAR2（16）type VARCHAR2（8）number VARCHAR2（16）city VARCHAR2（32）state VARCHAR2（2）street VARCHAR2（32）country VARCHAR2（32） ）zipCode NUMBER特殊说明VARCHAR2（8）</code></pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="json-dataguide.html#GUID-394009D2-F829-49B0-B6EF-DB24606FEF75" title="根据数据指南信息，您可以创建一个数据库视图，其列投影一组JSON文档中的特定标量字段。您可以通过编辑分层数据指南或指定SQL / JSON路径表达式和字段出现的最小频率来选择要投影的字段。">基于数据指南信息创建基于JSON数据的视图</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-B6A1D87D-9EE8-47F0-8325-96A366254488" name="GUID-B6A1D87D-9EE8-47F0-8325-96A366254488"></a><h4 id="ADJSN-GUID-B6A1D87D-9EE8-47F0-8325-96A366254488" class="sect4"><span class="enumeration_section">20.7.2</span>基于路径表达式创建基于JSON数据的视图</h4>
                  <div>
                     <p>您可以使用启用数据指南的JSON搜索索引中的信息来创建数据库视图，该视图的列从文档中投影JSON字段。投影的字段是不在数组下的标量字段加上指定的SQL / JSON路径表达式所针对的数据中的标量字段。</p>
                     <div class="section">
                        <p>例如，如果路径表达式为<code class="codeph">$</code>则会投影所有标量字段，因为文档的根（顶部）是目标。<a href="json-dataguide.html#GUID-B6A1D87D-9EE8-47F0-8325-96A366254488__GUID-E8DF1BBB-BA37-486F-A5AD-E908B7DF1F56">例20-7</a>说明了这一点。如果路径是<code class="codeph">$.了LineItem。Part</code>则只有标量场是存在（任何级别）中针对的数据<code class="codeph">$.了LineItem。Part</code>是预测的（除了不在数组下的其他地方的标量字段）。<a href="json-dataguide.html#GUID-B6A1D87D-9EE8-47F0-8325-96A366254488__EXAMPLE-133-F3BDE7BF">例20-8</a>说明了这一点。
                        </p>
                        <p>如果您收集有关JSON文档集的统计信息，则启用数据指南的JSON搜索索引中的数据指南信息会记录文档集中每个路径到文档中存在的字段的出现频率。创建视图时，可以指定仅将具有给定最小出现频率（以百分比表示）的（标量）字段投影为视图列。您可以通过为过程<code class="codeph">DBMS_JSON.create_view_on_path</code>参数<code class="codeph"><span class="codeinlineitalic">FREQUENCY</span></code>指定非零值来执行<code class="codeph">DBMS_JSON.create_view_on_path</code> 。
                        </p>
                        <p>例如，如果您将路径指定为<code class="codeph">$</code>并将最小频率指定为<code class="codeph">50</code>那么将投影至少一半（50％）文档中出现的所有标量字段（在任何路径上，因为<code class="codeph">$</code> target整个文档）。<a href="json-dataguide.html#GUID-B6A1D87D-9EE8-47F0-8325-96A366254488__EXAMPLE-134-F3C222C1">例20-9</a>说明了这一点。
                        </p>
                        <p>参数<span class="italic"><code class="codeph">PATH</code></span>的值是一个简单的SQL / JSON路径表达式（没有过滤器表达式），可能有松弛（隐式数组包装和解包），但没有数组步骤而没有函数步骤。请参见<a href="json-path-expressions.html#GUID-7B610884-39CD-4910-85E7-C251D342D879" title="SQL / JSON路径表达式由SQL / JSON函数和条件与JSON数据匹配，以选择它的一部分。路径表达式可以使用通配符和数组范围。匹配区分大小写。">SQL / JSON路径表达式语法</a> 。
                        </p>
                        <div class="p">在以下<span class="italic">任何一种</span>情况下<span class="italic">都不进行</span>频率过滤 - <span class="italic">无论</span>文档中出现<span class="italic">的频率如何，都会投射</span>目标字段：<ul style="list-style-type:disc">
                              <li>
                                 <p>您永远不会收集有关您的JSON文档集的统计信息。（启用数据指南的JSON搜索索引中不包含频率信息。）</p>
                              </li>
                              <li>
                                 <p><code class="codeph">DBMS_JSON.create_view_on_path</code>的<code class="codeph"><span class="codeinlineitalic">FREQUENCY</span></code>参数<span class="italic">为零</span> （0）。
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <div class="infoboxnote" id="GUID-B6A1D87D-9EE8-47F0-8325-96A366254488__GUID-1B6A37DF-C443-4B21-8F5D-56BD02B7C04C">
                           <p class="notep1">注意：</p>
                           <p>当<code class="codeph"><span class="codeinlineitalic">FREQUENCY</span></code>参数非零时，即使您已收集有关文档集的统计信息，索引<span class="italic">也不</span>包含在最近收集统计信息之后添加的任何文档的统计信息。这意味着<span class="italic">在统计信息收集之后添加的</span>任何<span class="italic">字段都将被忽略</span> （未预测）。
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-B6A1D87D-9EE8-47F0-8325-96A366254488__GUID-829B8C5D-F218-4B2A-A6DB-DEB680F3B22A">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>有关<code class="codeph">DBMS_JSON.create_view_on_path</code>信息，请<code class="codeph">DBMS_JSON.create_view_on_path</code> <a href="../arpls/DBMS_JSON.html#ARPLS-GUID-F6FCD886-191D-4F2E-8767-62CFDC762FC1" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                              </li>
                              <li>
                                 <p>有关<code class="codeph">DBMS_JSON.rename_column</code>信息，请<code class="codeph">DBMS_JSON.rename_column</code> <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=ARPLS-GUID-0E802354-4508-4DF7-A07A-6999F3337CA5" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-B6A1D87D-9EE8-47F0-8325-96A366254488__GUID-E8DF1BBB-BA37-486F-A5AD-E908B7DF1F56">
                        <p class="titleinexample">示例20-7创建投影所有标量字段的视图</p>
                        <p>所有标量字段都在视图中表示，因为指定的路径是<code class="codeph">$</code> 。
                        </p>
                        <p>（在<code class="codeph">describe</code>命令输出中名称为<span class="italic"><code class="codeph">italic</code></span>列是使用PL / SQL过程<code class="codeph">DBMS_JSON.rename_column</code>重命名的<code class="codeph">DBMS_JSON.rename_column</code> 。<a href="json-dataguide.html#GUID-B6A1D87D-9EE8-47F0-8325-96A366254488__EXAMPLE-134-F3C222C1">例20-9</a>中缺少带<span class="underline">下划线的</span>行。）
                        </p><pre class="pre codeblock"><code>EXEC DBMS_JSON.create_view_on_path（'VIEW2'，'J_PURCHASEORDER'，'PO_DOCUMENT'，' <span class="bold">$</span> '）; DESCRIBE view2;名字空？输入-------------------------------- -------- --------- --------- ID NOT NOT RAW（16）DATE_LOADED TIMESTAMP（6）WITH TIME ZONE PO_DOCUMENT $ User VARCHAR2（8） <span class="italic">PONumber</span> NUMBER PO_DOCUMENT $ Reference VARCHAR2（16）PO_DOCUMENT $ Requestor VARCHAR2（16）PO_DOCUMENT $ CostCenter VARCHAR2（4） <span class="underline">PO_DOCUMENT $ AllowPartialShipment VARCHAR2（4）</span> PO_DOCUMENT $ name VARCHAR2（16） <span class="underline"><span class="italic">Phone</span> VARCHAR2（16）</span> PO_DOCUMENT $ city VARCHAR2（32）PO_DOCUMENT $ state VARCHAR2（2）PO_DOCUMENT $ street VARCHAR2（32）PO_DOCUMENT $ country VARCHAR2（32） ）PO_DOCUMENT $ zipCode NUMBER PO_DOCUMENT $ SpecialInstructions VARCHAR2（8）PO_DOCUMENT $ UPCCode NUMBER PO_DOCUMENT $ UnitPrice NUMBER <span class="italic">PartDescription</span> VARCHAR2（32）PO_DOCUMENT $ Quantity NUMBER <span class="italic">ItemNumber</span> NUMBER <span class="underline"><span class="italic">PhoneType</span> VARCHAR2（8）</span> <span class="underline"><span class="italic">PhoneNumber</span> VARCHAR2（16）</span></code></pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-B6A1D87D-9EE8-47F0-8325-96A366254488__EXAMPLE-133-F3BDE7BF">
                        <p class="titleinexample">示例20-8创建以路径表达式为目标的项目标量字段的视图</p>
                        <p>字段<code class="codeph">Itemnumber</code> ， <code class="codeph">PhoneType</code>和<code class="codeph">PhoneNumber</code> <span class="italic">未</span>在视图中显示。投影的唯一字段是不在数组下的标量字段以及<code class="codeph">$.所针对的数据中存在的字段（在任何级别） <code class="codeph">$.了LineItem。Part</code> （即，路径以<code class="codeph">$.开头的标量字段<code class="codeph">$.了LineItem。Part</code> ）。（在<code class="codeph">describe</code>命令输出中名称为<span class="italic"><code class="codeph">italic</code></span>列是那些使用PL / SQL过程<code class="codeph">DBMS_JSON.rename_column</code>重命名的<code class="codeph">DBMS_JSON.rename_column</code> 。）
                        </p><pre class="pre codeblock"><code>SQL&gt; EXEC DBMS_JSON.create_view_on_path（'VIEW4'，'J_PURCHASEORDER'，'PO_DOCUMENT'，' <span class="bold">$。了LineItem。部分</span> '）; SQL&gt; DESCRIBE view4;名字空？输入-------------------------------- -------- --------- --------- ID NOT NOT RAW（16）DATE_LOADED TIMESTAMP（6）WITH TIME ZONE PO_DOCUMENT $ User VARCHAR2（8） <span class="italic">PONumber</span> NUMBER PO_DOCUMENT $ Reference VARCHAR2（16）PO_DOCUMENT $ Requestor VARCHAR2（16）PO_DOCUMENT $ CostCenter VARCHAR2（4）PO_DOCUMENT $ AllowPartialShipment VARCHAR2（4）PO_DOCUMENT $ name VARCHAR2（16） <span class="italic">Phone</span> VARCHAR2（16）PO_DOCUMENT $ city VARCHAR2（32）PO_DOCUMENT $ state VARCHAR2（2）PO_DOCUMENT $ street VARCHAR2（32）PO_DOCUMENT $ country VARCHAR2（32） ）PO_DOCUMENT $ zipCode NUMBER PO_DOCUMENT $ SpecialInstructions VARCHAR2（8）PO_DOCUMENT $ UPCCode NUMBER PO_DOCUMENT $ UnitPrice NUMBER <span class="italic">PartDescription</span> VARCHAR2（32）</code></pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-B6A1D87D-9EE8-47F0-8325-96A366254488__EXAMPLE-134-F3C222C1">
                        <p class="titleinexample">示例20-9创建具有给定频率的项目标量字段的视图</p>
                        <p>所有（100％）文档中出现的所有标量字段都在视图中表示。字段<code class="codeph">AllowPartialShipment</code>不会出现在所有文档中，因此视图中没有列<code class="codeph">PO_DOCUMENT$AllowPartialShipment</code> 。类似地，对于字段<code class="codeph">Phone</code> ， <code class="codeph">PhoneType</code>和<code class="codeph">PhoneNumber</code> 。
                        </p>
                        <p>（在<code class="codeph">describe</code>命令输出中名称为<span class="italic"><code class="codeph">italic</code></span>列是那些使用PL / SQL过程<code class="codeph">DBMS_JSON.rename_column</code>重命名的<code class="codeph">DBMS_JSON.rename_column</code> 。）
                        </p><pre class="pre codeblock"><code>SQL&gt; EXEC DBMS_JSON.create_view_on_path（'VIEW3'，'J_PURCHASEORDER'，'PO_DOCUMENT'，'$'， <span class="bold">100</span> ）; SQL&gt; DESCRIBE view3;名字空？输入-------------------------------- -------- --------- --------- ID NOT NOT RAW（16）DATE_LOADED TIMESTAMP（6）WITH TIME ZONE PO_DOCUMENT $ User VARCHAR2（8） <span class="italic">PONumber</span> NUMBER PO_DOCUMENT $ Reference VARCHAR2（16）PO_DOCUMENT $ Requestor VARCHAR2（16）PO_DOCUMENT $ CostCenter VARCHAR2（4）PO_DOCUMENT $ name VARCHAR2（16）PO_DOCUMENT $ city VARCHAR2（32）PO_DOCUMENT $ state VARCHAR2（2）PO_DOCUMENT $ street VARCHAR2（32）PO_DOCUMENT $ country VARCHAR2（32）PO_DOCUMENT $ zipCode NUMBER PO_DOCUMENT $ SpecialInstructions VARCHAR2（8） PO_DOCUMENT $ UPCCode NUMBER PO_DOCUMENT $ UnitPrice NUMBER <span class="italic">PartDescription</span> VARCHAR2（32）PO_DOCUMENT $ Quantity NUMBER <span class="italic">ItemNumber</span> NUMBER</code></pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="json-dataguide.html#GUID-A0AFD360-93A7-4566-8315-6F68D9AE090B" title="您可以将数据中的JSON字段作为数据库视图中的列或作为添加到包含JSON列的同一表的虚拟列进行投影。您可以为此类列指定首选名称。">为字段列指定首选名称</a></li>
                           <li><a href="json-path-expressions.html#GUID-2DC05D71-3D62-4A14-855F-76E054032494" title="Oracle数据库使用SQL / JSON路径表达式提供对JSON数据的SQL访问。">SQL / JSON路径表达式</a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="json-dataguide.html#GUID-394009D2-F829-49B0-B6EF-DB24606FEF75" title="根据数据指南信息，您可以创建一个数据库视图，其列投影一组JSON文档中的特定标量字段。您可以通过编辑分层数据指南或指定SQL / JSON路径表达式和字段出现的最小频率来选择要投影的字段。">基于数据指南信息创建基于JSON数据的视图</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
            <div class="sect2"><a id="GUID-7AEF436C-B743-4BA1-B6D4-1F1B98E26DB1" name="GUID-7AEF436C-B743-4BA1-B6D4-1F1B98E26DB1"></a><h3 id="ADJSN-GUID-7AEF436C-B743-4BA1-B6D4-1F1B98E26DB1" class="sect3"><span class="enumeration_section">20.8</span>基于数据指南信息为JSON字段添加和删除虚拟列</h3>
               <div>
                  <p>根据JSON列的数据指南信息，您可以将该JSON数据中的标量字段作为虚拟列投影到同一个表中。投射的标量字段是不在数组下的字段。</p>
                  <div class="section">
                     <p>您可以使用虚拟列执行以下所有操作，以提高性能：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>建立一个索引。</p>
                        </li>
                        <li>
                           <p>为优化器收集有关它的统计信息。</p>
                        </li>
                        <li>
                           <p>将其加载到内存中列存储（IM列存储）。</p>
                        </li>
                     </ul>
                     <div class="infoboxnote" id="GUID-7AEF436C-B743-4BA1-B6D4-1F1B98E26DB1__GUID-174F754D-82D9-4600-8883-4F9CEA4939B4">
                        <p class="notep1">注意：</p>
                        <p>虚拟列（如一般列）受给定表的1000列限制。</p>
                     </div>
                     <p>您可以使用PL / SQL过程<code class="codeph">DBMS_JSON.add_virtual_columns</code>根据JSON列的数据指南信息添加虚拟列。在添加虚拟列之前，过程<code class="codeph">add_virtual_columns</code>首先删除通过先前调用<code class="codeph">add_virtual_columns</code>或通过数据引导更改触发器过程<code class="codeph">add_vc</code>从同一JSON列中的字段投影的任何现有虚拟列（实际上，它执行<code class="codeph">DBMS_JSON.drop_virtual_columns</code>过程） <code class="codeph">DBMS_JSON.drop_virtual_columns</code> ）。
                     </p>
                     <p>您为过程<code class="codeph">add_virtual_columns</code>提供了两个备选的数据指南信息<code class="codeph">add_virtual_columns</code> ：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>它可以来自您作为参数传递的<span class="italic">分层数据指南</span> 。数据指南中不在数组下的所有标量字段都将投影为虚拟列。数据指南中的所有其他字段都将被忽略（未预测）。
                           </p>
                           <p>在这种情况下，您可以在传递数据指南之前对其进行编辑，以便指定要投影的标量字段（不在数组下）。你<span class="italic">不需要</span>在这种情况下，数据启用引导搜索索引。
                           </p>
                        </li>
                        <li>
                           <p>它可以来自支持<span class="italic">数据指南的JSON搜索索引</span> 。
                           </p>
                           <p>在这种情况下，您可以将过程<code class="codeph">add_virtual_columns</code>的参数<span class="italic"><code class="codeph">FREQUENCY</code></span>的值指定为要投影的标量字段的最小出现频率。在这种情况下，您需要启用数据指南的搜索索引，但不需要数据指南。
                           </p>
                        </li>
                     </ul>
                     <p>您还可以指定<span class="italic">隐藏</span>添加的虚拟列。SQL <code class="codeph">describe</code>命令不会列出隐藏的列。
                     </p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>如果您将（分层）数据指南传递给<code class="codeph">add_virtual_columns</code>则可以通过在数据指南中添加<code class="codeph">"o:hidden": <span class="bold">true</span></code>来指定特定标量字段（不在数组下）的投影作为<span class="italic">隐藏</span>虚拟列。
                           </p>
                        </li>
                        <li>
                           <p>如果您使用带有<code class="codeph">add_virtual_columns</code>的数据指南启用的JSON搜索索引， <code class="codeph">add_virtual_columns</code>以为参数<span class="italic"><code class="codeph">HIDDEN</code></span>指定PL / SQL <code class="codeph"><span class="bold">TRUE</span></code>值，以<span class="italic"><code class="codeph">HIDDEN</code></span> <span class="italic">所有</span>添加的虚拟列。（ <span class="italic"><code class="codeph">HIDDEN</code></span>的默认值为<code class="codeph">FALSE</code> ，表示未隐藏添加的虚拟列。）
                           </p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section"></div>
                  <!-- class="section" -->
                  <div class="section"></div>
                  <!-- class="section" -->
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="json-dataguide.html#GUID-9BAE6F8C-3031-465C-BA54-653E8FB1EE51">基于分层数据指南为JSON字段添加虚拟列</a><br>您可以使用分层数据指南将JSON数据中的标量字段作为虚拟列投影到同一个表中。数据指南中不在数组下的所有标量字段都将投影为虚拟列。数据指南中的所有其他字段都将被忽略（未预测）。
                     </li>
                     <li class="ulchildlink"><a href="json-dataguide.html#GUID-E0591013-535D-4B7F-B7D9-76A7B1BB0989">基于启用数据指南的搜索索引为JSON字段添加虚拟列</a><br>您可以为JSON列使用支持数据指南的搜索索引，将该JSON数据中的标量字段作为虚拟列投影到同一个表中。仅投影不在阵列下的标量字段。您可以指定要投影的字段的最小出现频率。
                     </li>
                     <li class="ulchildlink"><a href="json-dataguide.html#GUID-3526B063-FCD8-4F78-94E4-1A2E07F115E1">基于数据指南信息删除JSON字段的虚拟列</a><br>您可以使用过程<code class="codeph">DBMS_JSON.drop_virtual_columns</code>删除为JSON数据列中的JSON字段添加的所有虚拟列。
                     </li>
                  </ul>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="in-memory-json-data.html#GUID-857A2E95-28AB-4314-B654-4CB05C50D9CF" title="可以将一列JSON数据存储在内存中列存储（IM列存储）中，以提高查询性能。">内存中的JSON数据</a></li>
                     </ul>
                  </div>
                  <div class="infoboxnotealso" id="GUID-7AEF436C-B743-4BA1-B6D4-1F1B98E26DB1__GUID-C2224A86-BF00-482B-813B-71BEB36EC242">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>有关<code class="codeph">DBMS_JSON.add_virtual_columns</code>信息，请<code class="codeph">DBMS_JSON.add_virtual_columns</code> <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=ARPLS-GUID-69DD0940-58EA-48D8-A635-097A6BA7A31B" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                        </li>
                        <li>
                           <p>有关<code class="codeph">DBMS_JSON.create_view_on_path</code>信息，请<code class="codeph">DBMS_JSON.create_view_on_path</code> <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=ARPLS-GUID-F6FCD886-191D-4F2E-8767-62CFDC762FC1" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                        </li>
                        <li>
                           <p>有关<code class="codeph">DBMS_JSON.drop_virtual_columns</code>信息，请<code class="codeph">DBMS_JSON.drop_virtual_columns</code> <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=ARPLS-GUID-119D090B-A309-4A2F-887F-A40B4266D68C" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                        </li>
                        <li>
                           <p>有关<code class="codeph">DBMS_JSON.rename_column</code>信息，请<code class="codeph">DBMS_JSON.rename_column</code> <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=ARPLS-GUID-0E802354-4508-4DF7-A07A-6999F3337CA5" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="json-dataguide.html#GUID-219FC30E-89A7-4189-BC36-7B961A24067C" title="通过JSON数据指南，您可以发现有关Oracle数据库中存储的JSON文档的结构和内容的信息。">JSON数据指南</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="sect3"><a id="GUID-9BAE6F8C-3031-465C-BA54-653E8FB1EE51" name="GUID-9BAE6F8C-3031-465C-BA54-653E8FB1EE51"></a><h4 id="ADJSN-GUID-9BAE6F8C-3031-465C-BA54-653E8FB1EE51" class="sect4"><span class="enumeration_section">20.8.1</span>基于分层数据指南为JSON字段添加虚拟列</h4>
                  <div>
                     <p>您可以使用分层数据指南将JSON数据中的标量字段作为虚拟列投影到同一个表中。数据指南中不在数组下的所有标量字段都将投影为虚拟列。数据指南中的所有其他字段都将被忽略（未预测）。</p>
                     <div class="section">
                        <p>您可以使用PL / SQL函数<code class="codeph">DBMS_JSON.get_index_dataguide</code>获取分层数据指南。必须在JSON数据列上定义启用数据指南的JSON搜索索引。
                        </p>
                        <p>您可以编辑获取的数据指南，仅包括特定的标量字段（不在数组下），重命名这些字段或更改其类型的长度。生成的数据指南指定将哪些此类字段投影为新的虚拟列。数据指南中不是不在数组下的标量字段的任何字段都将被忽略（未投影）。</p>
                        <p>使用PL / SQL过程<code class="codeph">DBMS_JSON.add_virtual_columns</code>将虚拟列添加到包含包含投影字段的JSON列的表中。该过程首先删除先前调用<code class="codeph">add_virtual_columns</code>或通过数据引导更改触发器过程<code class="codeph">add_vc</code>从同一JSON列中的字段投射的任何现有虚拟列（实际上，它执行<code class="codeph">DBMS_JSON.drop_virtual_columns</code>执行的操作）。
                        </p>
                        <p><a href="json-dataguide.html#GUID-9BAE6F8C-3031-465C-BA54-653E8FB1EE51__GUID-FB607F06-E9DA-4023-963D-C0AC20D962DA">例20-10</a>说明了这一点。它从表<code class="codeph">j_purchaseorder</code> JSON列<code class="codeph">po_document</code>中的数据<code class="codeph">po_document</code>不在数组下的标量字段。投影的字段是分层数据指南中指示的字段。
                        </p>
                        <p><a href="json-dataguide.html#GUID-9BAE6F8C-3031-465C-BA54-653E8FB1EE51__EXAMPLE-145-FB71CAF9">例20-11</a>说明了传递一个数据引导参数，该参数指定两个字段作为虚拟列的投影。数据引导字段<code class="codeph">o:hidden</code>用于隐藏其中一列。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-9BAE6F8C-3031-465C-BA54-653E8FB1EE51__NOTE-1521-F98B39D9">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>有关<code class="codeph">DBMS_JSON.add_virtual_columns</code>信息，请<code class="codeph">DBMS_JSON.add_virtual_columns</code> <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=ARPLS-GUID-69DD0940-58EA-48D8-A635-097A6BA7A31B" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                              </li>
                              <li>
                                 <p>有关<code class="codeph">DBMS_JSON.drop_virtual_columns</code>信息，请<code class="codeph">DBMS_JSON.drop_virtual_columns</code> <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=ARPLS-GUID-119D090B-A309-4A2F-887F-A40B4266D68C" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                              </li>
                              <li>
                                 <p>有关<code class="codeph">DBMS_JSON.get_index_dataguide</code>信息，请<code class="codeph">DBMS_JSON.get_index_dataguide</code> <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=ARPLS-GUID-52B63CEE-669C-46FB-A276-56F7C6ECD036" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                              </li>
                              <li>
                                 <p>有关<code class="codeph">DBMS_JSON.rename_column</code>信息，请<code class="codeph">DBMS_JSON.rename_column</code> <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=ARPLS-GUID-0E802354-4508-4DF7-A07A-6999F3337CA5" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                              </li>
                              <li>
                                 <p>有关PL / SQL常量<code class="codeph">DBMS_JSON.FORMAT_HIERARCHICAL</code>信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=ARPLS-GUID-F9032949-7FE1-4A31-AA4B-4A2775F0CBE6" target="_blank"><span><cite>参见Oracle数据库SQL语言参考</cite></span></a></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="section"></div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-9BAE6F8C-3031-465C-BA54-653E8FB1EE51__GUID-FB607F06-E9DA-4023-963D-C0AC20D962DA">
                        <p class="titleinexample">示例20-10使用GET_INDEX_DATAGUIDE获取的数据指南添加项目JSON字段的虚拟列</p>
                        <p>在此示例中，分层数据指南是从JSON列<code class="codeph">po_document</code>上启用数据指南的JSON搜索索引<code class="codeph">po_document</code> 。
                        </p>
                        <p>添加的虚拟列是表<code class="codeph">j_purchaseorder</code>中的所有列，但<code class="codeph">ID</code> ， <code class="codeph">DATE_LOADED</code>和<code class="codeph">PODOCUMENT</code> 。</p>
                        <p>（在<code class="codeph">describe</code>命令输出中名称为<span class="italic"><code class="codeph">italic</code></span>列是那些使用PL / SQL过程<code class="codeph">DBMS_JSON.rename_column</code>重命名的<code class="codeph">DBMS_JSON.rename_column</code> 。）
                        </p><pre class="pre codeblock"><code>EXEC DBMS_JSON.add_virtual_columns（ 'J_PURCHASEORDER'， 'PO_DOCUMENT'，DBMS_JSON <span class="bold">get_index_dataguide（</span> 'J_PURCHASEORDER'， 'PO_DOCUMENT'，DBMS_JSON <span class="bold">FORMAT_HIERARCHICAL））;</span> DESCRIBE j_purchaseorder;名字空？输入----------------------------------------- -------- ---------------------------- ID NOT NOT RAW（16）DATE_LOADED TIMESTAMP（6）WITH TIME ZONE PO_DOCUMENT CLOB PO_DOCUMENT $ User VARCHAR2（ 8） <span class="italic">PONumber</span> NUMBER PO_DOCUMENT $ Reference VARCHAR2（16）PO_DOCUMENT $ Requestor VARCHAR2（16）PO_DOCUMENT $ CostCenter VARCHAR2（4）PO_DOCUMENT $ AllowPartialShipment VARCHAR2（4）PO_DOCUMENT $ name VARCHAR2（16） <span class="italic">Phone</span> VARCHAR2（16）PO_DOCUMENT $ city VARCHAR2（32） ）PO_DOCUMENT $ state VARCHAR2（2）PO_DOCUMENT $ street VARCHAR2（32）PO_DOCUMENT $ country VARCHAR2（32）PO_DOCUMENT $ zipCode NUMBER PO_DOCUMENT $ SpecialInstructions VARCHAR2（8）</code></pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-9BAE6F8C-3031-465C-BA54-653E8FB1EE51__EXAMPLE-145-FB71CAF9">
                        <p class="titleinexample">示例20-11添加隐藏和可见的虚拟列</p>
                        <p>在此示例中，仅将两个字段投影为虚拟列： <code class="codeph">PO_Number</code>和<code class="codeph">PO_Reference</code> 。数据指南在本地定义为文字字符串。数据引导字段<code class="codeph">o:hidden</code>用于隐藏<code class="codeph">PO_Reference</code>的虚拟列。（对于<code class="codeph">PO_Number</code> <code class="codeph">o:hidden: false</code>条目，因为<code class="codeph">false</code>是默认值。）
                        </p><pre class="pre codeblock"><code>DECLARE dg CLOB; BEGIN dg：='{“type”：“object”，“properties”：{“PO_Number”：{“type”：“number”，“o：length”：4，“o：preferred_column_name”：“PO_Number”， “o：hidden”：false}，“PO_Reference”：{“type”：“string”，“o：length”：16，“o：preferred_column_name”：“PO_Reference”，“o：hidden”： <span class="bold">true</span> }}} “; DBMS_JSON.add_virtual_columns（'J_PURCHASEORDER'，'PO_DOCUMENT'，dg）;结束; / DESCRIBE j_purchaseorder;名字空？键入----------- -------- --------------------------- ID NOT NULL RAW（16）DATE_LOADED TIMESTAMP（6）WITH TIME ZONE PO_DOCUMENT CLOB <span class="bold">PO_Number</span> NUMBER SELECT column_name FROM user_tab_columns WHERE table_name ='J_PURCHASEORDER'ORDER BY 1; COLUMN_NAME ----------- DATE_LOADED ID PO_DOCUMENT <span class="bold">PO_Number</span> <span class="bold">PO_Reference已</span>选择5行。</code></pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="json-dataguide.html#GUID-7AEF436C-B743-4BA1-B6D4-1F1B98E26DB1" title="根据JSON列的数据指南信息，您可以将该JSON数据中的标量字段作为虚拟列投影到同一个表中。投射的标量字段是不在数组下的字段。">基于数据指南信息为JSON字段添加和删除虚拟列</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-E0591013-535D-4B7F-B7D9-76A7B1BB0989" name="GUID-E0591013-535D-4B7F-B7D9-76A7B1BB0989"></a><h4 id="ADJSN-GUID-E0591013-535D-4B7F-B7D9-76A7B1BB0989" class="sect4"><span class="enumeration_section">20.8.2</span>基于启用数据指南的搜索索引为JSON字段添加虚拟列</h4>
                  <div>
                     <p>您可以为JSON列使用支持数据指南的搜索索引，将该JSON数据中的标量字段作为虚拟列投影到同一个表中。仅投影不在阵列下的标量字段。您可以指定要投影的字段的最小出现频率。</p>
                     <div class="section">
                        <p>您使用过程<code class="codeph">DBMS_JSON.add_virtual_columns</code>添加虚拟列。
                        </p>
                        <p><a href="json-dataguide.html#GUID-E0591013-535D-4B7F-B7D9-76A7B1BB0989__PROJECTINGALLSCALARFIELDSNOTUNDERAN-FE25A770">例20-12</a>说明了这一点。它将不在数组下的所有标量字段作为虚拟列<code class="codeph">j_purchaseorder</code>到表<code class="codeph">j_purchaseorder</code> 。
                        </p>
                        <p>如果您收集有关要在其中投影字段的JSON列中的文档的统计信息，则启用数据指南的JSON搜索索引中的数据指南信息会记录文档中每个字段在该文档集中的出现频率。</p>
                        <p>添加虚拟列时，您可以指定仅投影具有给定最小出现频率的那些字段。</p>
                        <p>您可以通过为过程<code class="codeph">add_virtual_columns</code>参数<span class="italic"><code class="codeph">FREQUENCY</code></span>指定非零值来执行<code class="codeph">add_virtual_columns</code> 。零是默认值，因此如果不包含参数<span class="italic"><code class="codeph">FREQUENCY</code></span>则会投影所有标量字段（不在数组下）。给定字段的频率是包含该字段的文档数除以JSON列中的文档总数，以百分比表示。
                        </p>
                        <p><a href="json-dataguide.html#GUID-E0591013-535D-4B7F-B7D9-76A7B1BB0989__PROJECTINGSCALARFIELDSWITHAMINIMUMF-FE25ACC0">示例20-13将</a>所有（100％）文档中出现的所有标量（不在数组下）投影为虚拟列。
                        </p>
                        <p>如果要<span class="italic">隐藏</span>所有添加的虚拟列，请为参数<span class="italic"><code class="codeph">HIDDEN</code></span>指定<code class="codeph"><span class="bold">TRUE</span></code>值。 （参数<span class="italic"><code class="codeph">HIDDEN</code></span>的默认值为<code class="codeph">FALSE</code> ，表示未隐藏添加的虚拟列。）
                        </p>
                        <p><a href="json-dataguide.html#GUID-E0591013-535D-4B7F-B7D9-76A7B1BB0989__PROJECTINGSCALARFIELDSWITHAMINIMUMF-FE25AF56">示例20-14</a>项目，作为隐藏虚拟列，在所有（100％）文档中出现的标量字段（不在数组下）。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-E0591013-535D-4B7F-B7D9-76A7B1BB0989__NOTE-1521-F98AAD63">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>有关<code class="codeph">DBMS_JSON.add_virtual_columns</code>信息，请<code class="codeph">DBMS_JSON.add_virtual_columns</code> <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=ARPLS-GUID-69DD0940-58EA-48D8-A635-097A6BA7A31B" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                              </li>
                              <li>
                                 <p>有关<code class="codeph">DBMS_JSON.rename_column</code>信息，请<code class="codeph">DBMS_JSON.rename_column</code> <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=ARPLS-GUID-0E802354-4508-4DF7-A07A-6999F3337CA5" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-E0591013-535D-4B7F-B7D9-76A7B1BB0989__PROJECTINGALLSCALARFIELDSNOTUNDERAN-FE25A770">
                        <p class="titleinexample">示例20-12将不在数组下的所有标量字段作为虚拟列投影</p>
                        <p>添加的虚拟列是表<code class="codeph">j_purchaseorder</code>中的所有列，但<code class="codeph">ID</code> ， <code class="codeph">DATE_LOADED</code>和<code class="codeph">PODOCUMENT</code> 。这是因为没有将<span class="italic"><code class="codeph">FREQUENCY</code></span>参数传递给<code class="codeph">add_virtual_columns</code> ，因此会投影所有标量字段（不在数组下）。
                        </p>
                        <p>（在<code class="codeph">describe</code>命令输出中名称为<span class="italic"><code class="codeph">italic</code></span>列是那些使用PL / SQL过程<code class="codeph">DBMS_JSON.rename_column</code>重命名的<code class="codeph">DBMS_JSON.rename_column</code> 。）
                        </p><pre class="pre codeblock"><code>EXEC DBMS_JSON.add_virtual_columns（'J_PURCHASEORDER'，'PO_DOCUMENT'）; DESCRIBE j_purchaseorder;名字空？输入----------------------------------------- -------- ---------------------------- ID NOT NOT RAW（16）DATE_LOADED TIMESTAMP（6）WITH TIME ZONE PO_DOCUMENT CLOB PO_DOCUMENT $ User VARCHAR2（ 8） <span class="italic">PONumber</span> NUMBER PO_DOCUMENT $ Reference VARCHAR2（16）PO_DOCUMENT $ Requestor VARCHAR2（16）PO_DOCUMENT $ CostCenter VARCHAR2（4）PO_DOCUMENT $ AllowPartialShipment VARCHAR2（4）PO_DOCUMENT $ name VARCHAR2（16） <span class="italic">Phone</span> VARCHAR2（16）PO_DOCUMENT $ city VARCHAR2（32） ）PO_DOCUMENT $ state VARCHAR2（2）PO_DOCUMENT $ street VARCHAR2（32）PO_DOCUMENT $ country VARCHAR2（32）PO_DOCUMENT $ zipCode NUMBER PO_DOCUMENT $ SpecialInstructions VARCHAR2（8）</code></pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-E0591013-535D-4B7F-B7D9-76A7B1BB0989__PROJECTINGSCALARFIELDSWITHAMINIMUMF-FE25ACC0">
                        <p class="titleinexample">示例20-13以最小频率作为虚拟列投影标量字段</p>
                        <p>所有（100％）文档中出现的所有标量字段都被投影为虚拟列。结果与<a href="json-dataguide.html#GUID-E0591013-535D-4B7F-B7D9-76A7B1BB0989__PROJECTINGALLSCALARFIELDSNOTUNDERAN-FE25A770">示例20-12</a>的结果相同，但不会投影字段<code class="codeph">AllowPartialShipment</code>和<code class="codeph">Phone</code> ，因为它们不会出现在100％的文档中。
                        </p>
                        <p>（在<code class="codeph">describe</code>命令输出中名称为<span class="italic"><code class="codeph">italic</code></span>列是那些使用PL / SQL过程<code class="codeph">DBMS_JSON.rename_column</code>重命名的<code class="codeph">DBMS_JSON.rename_column</code> 。）
                        </p><pre class="pre codeblock"><code>EXEC DBMS_JSON.add_virtual_columns（'J_PURCHASEORDER'，'PO_DOCUMENT'，100）; DESCRIBE j_purchaseorder;名字空？输入----------------------------------------- -------- ---------------------------- ID NOT NOT RAW（16）DATE_LOADED TIMESTAMP（6）WITH TIME ZONE PO_DOCUMENT CLOB PO_DOCUMENT $ User VARCHAR2（ 8） <span class="italic">PONumber</span> NUMBER PO_DOCUMENT $ Reference VARCHAR2（16）PO_DOCUMENT $ Requestor VARCHAR2（16）PO_DOCUMENT $ CostCenter VARCHAR2（4）PO_DOCUMENT $ name VARCHAR2（16）PO_DOCUMENT $ city VARCHAR2（32）PO_DOCUMENT $ state VARCHAR2（2）PO_DOCUMENT $ street VARCHAR2 （32）PO_DOCUMENT $ country VARCHAR2（32）PO_DOCUMENT $ zipCode NUMBER PO_DOCUMENT $ SpecialInstructions VARCHAR2（8）</code></pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-E0591013-535D-4B7F-B7D9-76A7B1BB0989__PROJECTINGSCALARFIELDSWITHAMINIMUMF-FE25AF56">
                        <p class="titleinexample">示例20-14以最小频率作为隐藏虚拟列投影标量字段</p>
                        <p>结果与<a href="json-dataguide.html#GUID-E0591013-535D-4B7F-B7D9-76A7B1BB0989__PROJECTINGSCALARFIELDSWITHAMINIMUMF-FE25ACC0">示例20-13</a>的结果相同，只是<span class="italic">隐藏</span>了所有添加的虚拟列。（查看<code class="codeph">USER_TAB_COLUMNS</code>的查询显示实际上已添加了虚拟列。）
                        </p><pre class="pre codeblock"><code>EXEC DBMS_JSON.add_virtual_columns（'J_PURCHASEORDER'，'PO_DOCUMENT'，100， <span class="bold">TRUE</span> ）; DESCRIBE j_purchaseorder;名字空？输入----------------------------------------- -------- ---------------------------- ID NOT NOT RAW（16）DATE_LOADED TIMESTAMP（6）WITH TIME ZONE PO_DOCUMENT CLOB SELECT column_name FROM user_tab_columns WHERE table_name ='J_PURCHASEORDER'ORDER BY 1; COLUMN_NAME ----------- DATE_LOADED ID PONumber PO_DOCUMENT PO_DOCUMENT $ CostCenter PO_DOCUMENT $ Reference PO_DOCUMENT $ Requestor PO_DOCUMENT $ SpecialInstructions PO_DOCUMENT $ User PO_DOCUMENT $ city PO_DOCUMENT $ country PO_DOCUMENT $ name PO_DOCUMENT $ state PO_DOCUMENT $ street PO_DOCUMENT $ zipCode</code></pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="json-dataguide.html#GUID-7AEF436C-B743-4BA1-B6D4-1F1B98E26DB1" title="根据JSON列的数据指南信息，您可以将该JSON数据中的标量字段作为虚拟列投影到同一个表中。投射的标量字段是不在数组下的字段。">基于数据指南信息为JSON字段添加和删除虚拟列</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-3526B063-FCD8-4F78-94E4-1A2E07F115E1" name="GUID-3526B063-FCD8-4F78-94E4-1A2E07F115E1"></a><h4 id="ADJSN-GUID-3526B063-FCD8-4F78-94E4-1A2E07F115E1" class="sect4"><span class="enumeration_section">20.8.3</span>根据数据指南信息删除JSON字段的虚拟列</h4>
                  <div>
                     <p>您可以使用过程<code class="codeph">DBMS_JSON.drop_virtual_columns</code>删除为JSON数据列中的JSON字段添加的所有虚拟列。
                     </p>
                     <div class="section">过程<code class="codeph">DBMS_JSON.drop_virtual_columns</code>通过调用<code class="codeph">add_virtual_columns</code>或通过data-guide change-trigger procedure <code class="codeph">add_vc</code>从给定JSON列中的字段投影的所有虚拟列。<a href="json-dataguide.html#GUID-3526B063-FCD8-4F78-94E4-1A2E07F115E1__GUID-BAEAF3D3-85C1-44D6-8805-D2E94F3DBFFF">例20-15</a>说明了从表<code class="codeph">j_purchaseorder</code>列<code class="codeph">po_document</code>投射的字段。
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-3526B063-FCD8-4F78-94E4-1A2E07F115E1__GUID-6D04D9AF-32E6-4CFB-86ED-CEDC3CF32B43">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>有关<code class="codeph">DBMS_JSON.add_virtual_columns</code>信息，请<code class="codeph">DBMS_JSON.add_virtual_columns</code> <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=ARPLS-GUID-69DD0940-58EA-48D8-A635-097A6BA7A31B" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                              </li>
                              <li>
                                 <p>有关<code class="codeph">DBMS_JSON.drop_virtual_columns</code>信息，请<code class="codeph">DBMS_JSON.drop_virtual_columns</code> <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=ARPLS-GUID-119D090B-A309-4A2F-887F-A40B4266D68C" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-3526B063-FCD8-4F78-94E4-1A2E07F115E1__GUID-BAEAF3D3-85C1-44D6-8805-D2E94F3DBFFF">
                        <p class="titleinexample">示例20-15删除JSON字段中弹出的虚拟列</p><pre class="pre codeblock"><code>EXEC DBMS_JSON.drop_virtual_columns（'J_PURCHASEORDER'，'PO_DOCUMENT'）;</code></pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="json-dataguide.html#GUID-7AEF436C-B743-4BA1-B6D4-1F1B98E26DB1" title="根据JSON列的数据指南信息，您可以将该JSON数据中的标量字段作为虚拟列投影到同一个表中。投射的标量字段是不在数组下的字段。">基于数据指南信息为JSON字段添加和删除虚拟列</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
            <div class="sect2"><a id="GUID-2F4C6F52-0D96-4405-8F85-CDA0B234D0D5" name="GUID-2F4C6F52-0D96-4405-8F85-CDA0B234D0D5"></a><h3 id="ADJSN-GUID-2F4C6F52-0D96-4405-8F85-CDA0B234D0D5" class="sect3"><span class="enumeration_section">20.9</span>更改触发器以启用数据引导的搜索索引</h3>
               <div>
                  <p>当JSON数据更改时，启用数据指南的JSON搜索索引中的某些信息会自动更新。您可以指定在发生这种情况时触发调用的过程。您可以为此定义自己的PL / SQL过程，也可以使用预定义的更改触发过程<code class="codeph">add_vc</code> 。
                  </p>
                  <p>启用数据指南的JSON搜索索引中的数据指南信息记录有关一组JSON文档的结构，类型和可能的统计信息。除了统计信息（仅在收集统计信息时更新）时，文档集中的相关更改会自动反映在索引中存储的数据指南信息中。</p>
                  <p>您可以定义一个PL / SQL过程，其调用由此类索引更新自动触发。更新索引时会发生调用。将忽略在执行过程期间发生的任何错误。</p>
                  <p>您可以使用预定义的更改触发器过程<code class="codeph">add_vc</code>自动添加从文档集中投影JSON字段的虚拟列，或根据需要修改现有的此类列。<code class="codeph">add_vc</code>添加的虚拟列遵循与通过为具有启用数据引导的搜索索引的JSON列调用过程<code class="codeph">DBMS_JSON.add_virtual_columns</code>而添加的虚拟列相同的命名规则。
                  </p>
                  <p>在任何一种情况下，都会<span class="italic">忽略</span>在执行过程期间发生的任何错误。
                  </p>
                  <p>不像<code class="codeph">DBMS_JSON.add_virtual_columns</code> ， <code class="codeph">add_vc</code> <span class="italic">不</span>首先删除来自同一JSON列字段中预计，任何现有的虚拟列。要通过<code class="codeph">add_vc</code>或<code class="codeph">add_virtual_columns</code>删除从同一JSON列中的字段投影的虚拟列，请使用过程<code class="codeph">DBMS_JSON.drop_virtual_columns</code> 。
                  </p>
                  <p>在创建或更改JSON搜索索引时，可以使用<code class="codeph">PARAMETERS</code>子句中的关键字<span class="bold"><code class="codeph">DATAGUIDE ON CHANGE</code></span>指定使用触发器进行数据引导更改。每个索引只允许一个更改触发器：更改索引以指定触发器会自动替换以前的任何触发器。
                  </p>
                  <p><a href="json-dataguide.html#GUID-2F4C6F52-0D96-4405-8F85-CDA0B234D0D5__GUID-19F6555A-1E4A-4E71-9E62-B613C25F367E">示例20-16将</a>现有JSON搜索索引<code class="codeph">po_search_idx</code>为使用过程<code class="codeph">add_vc</code> 。
                  </p>
                  <div class="example" id="GUID-2F4C6F52-0D96-4405-8F85-CDA0B234D0D5__GUID-19F6555A-1E4A-4E71-9E62-B613C25F367E">
                     <p class="titleinexample">示例20-16使用更改触发器ADD_VC自动添加虚拟列</p>
                     <p>此示例将预定义的更改触发器<code class="codeph">add_vc</code>添加到JSON搜索索引<code class="codeph">po_search_idx</code> 。
                     </p>
                     <p>它首先删除通过过程<code class="codeph">DBMS_JSON.add_virtual_columns</code>或相同JSON搜索索引的预先存在的<code class="codeph">add_vc</code>更改触发器从JSON列<code class="codeph">po_document</code>字段投影的任何现有虚拟列。
                     </p>
                     <p>然后它改变搜索索引以添加更改触发器<code class="codeph">add_vc</code> （如果它已经存在则那么这没有效果）。
                     </p>
                     <p>最后，它会插入一个新文档，引发数据指南的更改。对于不在数组下的两个标量字段，将两个虚拟列添加到表中。</p><pre class="pre codeblock"><code>EXEC DBMS_JSON.drop_virtual_columns（'J_PURCHASEORDER'，'PO_DOCUMENT'）; ALTER INDEX po_search_idx REBUILD PARAMETERS（' <span class="bold">DATAGUIDE ON CHANGE add_vc</span> '）; INSERT INTO j_purchaseorder VALUES（SYS_GUID（），to_date（'30 -JUN-2015'），'{“ <span class="bold">PO_Number</span> ”：4230，“ <span class="bold">PO_Reference</span> ”：“JDEER-20140421”，“PO_LineItems”：[{“Part_Number”：230912362345， “数量”：3.0}]}'）; DESCRIBE j_purchaseorder;名字空？输入------------------------- -------- ---------------- ------------ ID NOT NOT RAW（16）DATE_LOADED TIMESTAMP（6）WITH TIME ZONE PO_DOCUMENT CLOB <span class="bold">PO_DOCUMENT $ PO_Number</span> NUMBER <span class="bold">PO_DOCUMENT $ PO_Reference</span> VARCHAR2（16）</code></pre></div>
                  <!-- class="example" -->
                  <div class="section"></div>
                  <!-- class="section" -->
                  <div class="section"></div>
                  <!-- class="section" -->
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="json-dataguide.html#GUID-EC076D41-D096-42A9-BCCA-AD894637FB5A">用户定义的数据指南更改触发器</a><br>您可以定义在更新给定数据引导的JSON搜索索引时自动触发其调用的过程。将忽略在执行过程期间发生的任何错误。
                     </li>
                  </ul>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="json-dataguide.html#GUID-7AEF436C-B743-4BA1-B6D4-1F1B98E26DB1" title="根据JSON列的数据指南信息，您可以将该JSON数据中的标量字段作为虚拟列投影到同一个表中。投射的标量字段是不在数组下的字段。">基于数据指南信息为JSON字段添加和删除虚拟列</a></li>
                     </ul>
                  </div>
                  <div class="infoboxnotealso" id="GUID-2F4C6F52-0D96-4405-8F85-CDA0B234D0D5__NOTE-1431-FA89FE6B">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>有关<code class="codeph">DBMS_JSON.add_virtual_columns</code>信息，请<code class="codeph">DBMS_JSON.add_virtual_columns</code> <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=ARPLS-GUID-69DD0940-58EA-48D8-A635-097A6BA7A31B" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                        </li>
                        <li>
                           <p>有关<code class="codeph">DBMS_JSON.drop_virtual_columns</code>信息，请<code class="codeph">DBMS_JSON.drop_virtual_columns</code> <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=ARPLS-GUID-119D090B-A309-4A2F-887F-A40B4266D68C" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="json-dataguide.html#GUID-219FC30E-89A7-4189-BC36-7B961A24067C" title="通过JSON数据指南，您可以发现有关Oracle数据库中存储的JSON文档的结构和内容的信息。">JSON数据指南</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="sect3"><a id="GUID-EC076D41-D096-42A9-BCCA-AD894637FB5A" name="GUID-EC076D41-D096-42A9-BCCA-AD894637FB5A"></a><h4 id="ADJSN-GUID-EC076D41-D096-42A9-BCCA-AD894637FB5A" class="sect4"><span class="enumeration_section">20.9.1</span>用户定义的数据指南更改触发器</h4>
                  <div>
                     <p>您可以定义在更新给定数据引导的JSON搜索索引时自动触发其调用的过程。将忽略在执行过程期间发生的任何错误。</p>
                     <p><a href="json-dataguide.html#GUID-EC076D41-D096-42A9-BCCA-AD894637FB5A__GUID-386295CD-EA82-43AC-B168-02F53386320E">例20-17</a>说明了这一点。
                     </p>
                     <p>在JSON搜索索引<code class="codeph">PARAMETERS</code>子句中使用关键字<code class="codeph">DATAGUIDE ON CHANGE</code>指定的用户定义过程必须接受<a href="json-dataguide.html#GUID-EC076D41-D096-42A9-BCCA-AD894637FB5A__PARAMETERSOFAUSER-DEFINEDDATAGUIDEC-FE29B6E5" title="此三列表显示了用作用户定义的PL / SQL过程必须接受的参数，该过程用作数据引导更改触发器。第1列是参数名称。第2列是参数的SQL类型。第3列是参数的描述。">表20-5中</a>指定的参数。
                     </p>
                     <div class="tblformal" id="GUID-EC076D41-D096-42A9-BCCA-AD894637FB5A__PARAMETERSOFAUSER-DEFINEDDATAGUIDEC-FE29B6E5">
                        <p class="titleintable">表20-5用户自定义数据指南的参数更改触发器过程</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="用户定义的数据指南的参数更改触发过程" border="1" summary="This three-column table shows the parameters that must be accepted by a user-defined PL/SQL procedure that is used as a data-guide change trigger. Column 1 is the parameter name. Column 2 is the SQL type of the parameter. Column 3 is a description of the parameter." frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" id="d23217e3889">名称</th>
                                 <th align="left" valign="bottom" id="d23217e3891">类型</th>
                                 <th align="left" valign="bottom" id="d23217e3893">描述</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d23217e3897" headers="d23217e3889 "><code class="codeph">TABLE_NAME</code></td>
                                 <td align="left" valign="top" headers="d23217e3897 d23217e3891 "><code class="codeph">VARCHAR2</code></td>
                                 <td align="left" valign="top" headers="d23217e3897 d23217e3893 ">包含列<code class="codeph">column_name</code>的表的名称。
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d23217e3909" headers="d23217e3889 "><code class="codeph">列名</code></td>
                                 <td align="left" valign="top" headers="d23217e3909 d23217e3891 "><code class="codeph">VARCHAR2</code></td>
                                 <td align="left" valign="top" headers="d23217e3909 d23217e3893 ">具有启用数据引导的JSON搜索索引的JSON列的名称。</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d23217e3918" headers="d23217e3889 "><code class="codeph">路径</code></td>
                                 <td align="left" valign="top" headers="d23217e3918 d23217e3891 "><code class="codeph">VARCHAR2</code></td>
                                 <td align="left" valign="top" headers="d23217e3918 d23217e3893 ">一个SQL / JSON路径表达式，用于定位列<code class="codeph">column_name</code>数据中的特定字段。此路径受触发过程调用的索引更改的影响。例如，索引更改涉及添加此路径或更改其类型值或其类型长度值。
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d23217e3930" headers="d23217e3889 "><code class="codeph">NEW_TYPE</code></td>
                                 <td align="left" valign="top" headers="d23217e3930 d23217e3891 "><code class="codeph">数</code></td>
                                 <td align="left" valign="top" headers="d23217e3930 d23217e3893 ">给定路径的新类型。</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d23217e3939" headers="d23217e3889 "><code class="codeph">new_type_length</code></td>
                                 <td align="left" valign="top" headers="d23217e3939 d23217e3891 "><code class="codeph">数</code></td>
                                 <td align="left" valign="top" headers="d23217e3939 d23217e3893 ">给定路径的新类型长度。</td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <div class="example" id="GUID-EC076D41-D096-42A9-BCCA-AD894637FB5A__GUID-386295CD-EA82-43AC-B168-02F53386320E">
                        <p class="titleinexample">示例20-17使用用户定义的更改触发器跟踪数据指南更新</p>
                        <p>此示例首先删除从JSON列<code class="codeph">po_document</code>字段投影的任何现有虚拟列。
                        </p>
                        <p>然后定义PL / SQL过程<code class="codeph">my_dataguide_trace</code> ，它打印表和JSON列的名称，以及添加的虚拟列的路径，类型和长度字段。然后，它会更改JSON搜索索引<code class="codeph">po_search_idx</code>以指定将此过程作为更新触发器来调用，以更新索引中的数据指南信息。
                        </p>
                        <p>然后，它会插入一个新文档，引发数据指南的更改，从而触发跟踪信息的输出。</p>
                        <p>请注意，过程的<code class="codeph">TYPE</code>参数必须是一个数字，它是JSON类型的<code class="codeph">DBMS_JSON</code>常量之一。该过程测试参数并输出用户友好的字符串来代替数字。
                        </p><pre class="pre codeblock"><code>EXEC DBMS_JSON.drop_virtual_columns（'J_PURCHASEORDER'，'PO_DOCUMENT'）;创建或替换过程<span class="bold">my_dataguide_trace</span> （tableName VARCHAR2，jcolName VARCHAR2，path VARCHAR2，type NUMBER，tlength NUMBER）IS typename VARCHAR2（10）; BEGIN IF（类型= DBMS_JSON <span class="bold">TYPE_NULL。）THEN</span>类型名：= '空'; ELSIF（类型= DBMS_JSON <span class="bold">TYPE_BOOLEAN。）THEN</span>类型名：= '布尔'; ELSIF（类型= DBMS_JSON <span class="bold">TYPE_NUMBER。）THEN</span>类型名：= '编号'; ELSIF（类型= DBMS_JSON <span class="bold">TYPE_STRING。）THEN</span>类型名：= '字符串'; ELSIF（类型= DBMS_JSON <span class="bold">TYPE_OBJECT。）THEN</span>类型名：= '对象'; ELSIF（类型= DBMS_JSON <span class="bold">TYPE_ARRAY。）THEN</span>类型名：= '阵列'; ELSE typename：='unknown';万一; DBMS_OUTPUT.put_line（'Updating'|| tableName ||'（'|| jcolName ||'）：Path ='|| path ||'，Type ='|| type ||'，Type Name ='|| typename ||'，Type Length ='|| tlength）;结束; / ALTER INDEX po_search_idx REBUILD PARAMETERS（' <span class="bold">DATAGUIDE ON CHANGE my_dataguide_trace</span> '）; INSERT INTO j_purchaseorder VALUES（SYS_GUID（），to_date（'30 -MAR-2016'），'{“PO_ID”：4230，“PO_Ref”：“JDEER-20140421”，“PO_Items”：[{“Part_No”：98981327234， “Item_Quantity”：13}]}'）;承诺;更新J_PURCHASEORDER（PO_DOCUMENT）：Path = <span class="bold">$。PO_ID</span> ，Type = 3，Type Name = <span class="bold">number</span> ，Type Length = 4更新J_PURCHASEORDER（PO_DOCUMENT）：Path = <span class="bold">$。PO_Ref</span> ，Type = 4，Type Name = <span class="bold">string</span> ，Type Length = 16更新J_PURCHASEORDER（PO_DOCUMENT）：Path = <span class="bold">$。PO_Items</span> ，Type = 6，Type Name = <span class="bold">array</span> ，Type Length = 64更新J_PURCHASEORDER（PO_DOCUMENT）：Path = <span class="bold">$。PO_Items。Part_No</span> ，Type = 3，Type Name = <span class="bold">number</span> ，Type Length = 16更新J_PURCHASEORDER（PO_DOCUMENT）：Path = <span class="bold">$。PO_Items。Item_Quantity</span> ，Type = 3，Type Name = <span class="bold">number</span> ，Type Length = 2 Commit complete。

</code></pre></div>
                     <!-- class="example" -->
                     <div class="section"></div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-EC076D41-D096-42A9-BCCA-AD894637FB5A__GUID-6E95FB6E-5396-463A-B9BF-6A8B03D550B7">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=ARPLS-GUID-F9032949-7FE1-4A31-AA4B-4A2775F0CBE6" target="_blank"><span><cite>Oracle数据库SQL语言参考</cite></span></a>有关PL / SQL常数信息<code class="codeph">TYPE_NULL</code> ， <code class="codeph">TYPE_BOOLEAN</code> ， <code class="codeph">TYPE_NUMBER</code> ， <code class="codeph">TYPE_STRING</code> ， <code class="codeph">TYPE_OBJECT</code>和<code class="codeph">TYPE_ARRAY</code> 。</p>
                           </li>
                           <li>
                              <p>有关<code class="codeph">DBMS_JSON.drop_virtual_columns</code>信息，请<code class="codeph">DBMS_JSON.drop_virtual_columns</code> <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=ARPLS-GUID-119D090B-A309-4A2F-887F-A40B4266D68C" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="json-dataguide.html#GUID-2F4C6F52-0D96-4405-8F85-CDA0B234D0D5" title="当JSON数据更改时，启用数据指南的JSON搜索索引中的某些信息会自动更新。您可以指定在发生这种情况时触发调用的过程。您可以为此定义自己的PL / SQL过程，也可以使用预定义的更改触发过程add_vc。">更改触发器以启用数据指南的搜索索引</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
            <div class="sect2"><a id="GUID-BD147159-87A7-4AAC-B150-44E3F10A81E1" name="GUID-BD147159-87A7-4AAC-B150-44E3F10A81E1"></a><h3 id="ADJSN-GUID-BD147159-87A7-4AAC-B150-44E3F10A81E1" class="sect3"><span class="enumeration_section">20.10</span>每个文档集的多个数据指南</h3>
               <div>
                  <p>数据指南反映了给定JSON文档集的形状。如果JSON列包含具有不同结构或类型信息的不同类型的文档，则可以为不同类型的文档创建和使用不同的数据指南。</p>
                  <div class="section">
                     <p class="subhead2" id="GUID-BD147159-87A7-4AAC-B150-44E3F10A81E1__GUID-C83F4337-C7CD-43DB-A1BE-24A3F316C7C7">针对不同种类的JSON文档的数据指南</p>
                     <p>JSON文档不需要，通常也不需要遵循规定的模式。即使对于在给定应用程序中使用类似的文档也是如此;它们的结构方式（形状）可能不同，字段类型可能不同。</p>
                     <p>JSON数据指南总结了给定文档集的结构和类型信息。通常，给定集合中的文档的结构和类型信息越相似，得到的数据指南就越有用。</p>
                     <p>为给定的JSON数据列创建数据指南。如果该列包含非常不同类型的文档（例如，采购订单和健康记录），则该列的单个数据指南可能用途有限。</p>
                     <p>解决此问题的一种方法是将不同类型的JSON文档放在不同的JSON列中。但有时其他考虑因素决定支持在同一列中混合文档类型。</p>
                     <p>此外，您决定存储在同一列中的相同通用类型的文档可能以相对系统的方式不同。这包括<span class="italic">演变</span>文档形状和类型信息的情况。例如，税务信息文件的结构可能每年都在变化。
                     </p>
                     <p>创建数据指南时，您可以决定要汇总哪些信息。因此，您可以为同一JSON列创建不同的数据指南，以表示文档集的不同子集。</p>
                     <p>在这方面的另一个辅助是在同一个表中有一个单独的非JSON列，用于标记或分类JSON列中的文档。</p>
                     <p>对于我们的示例中使用的采购订单文档，我们假设它们的结构可以每年显着发展，因此表<code class="codeph">j_purchaseorder</code>列<code class="codeph">date_loaded</code>可用于将它们分组为具有相似相似形状的子集。<a href="json-dataguide.html#GUID-BD147159-87A7-4AAC-B150-44E3F10A81E1__ADDINGA2015PURCHASE-ORDERDOCUMENT-FC010862">示例20-18</a>添加了2015年的采购订单文档， <a href="json-dataguide.html#GUID-BD147159-87A7-4AAC-B150-44E3F10A81E1__ADDINGA2016PURCHASE-ORDERDOCUMENT-FC010487">示例20-19</a>添加了2016年的采购订单文档。（与2014年的文档相比较，这些文档在<a href="creating-a-table-with-a-json-column.html#GUID-E6CC0DCF-3D72-41EF-ACA4-B3BF54EE3CA0__CACCIEFA">例4-2</a>中添加。）
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-BD147159-87A7-4AAC-B150-44E3F10A81E1__GUID-2371E2EC-A702-4B2D-BE00-2090B31251F7">使用SQL聚合函数创建多个数据指南</p>
                     <p>Oracle SQL函数<code class="codeph">json_dataguide</code>实际上是一个<span class="italic">聚合</span>函数。聚合函数返回基于行组的单个结果行，而不是单个行。它通常在<code class="codeph">SELECT</code>列表中用于具有<code class="codeph">GROUP BY</code>子句的查询，该子句将查询的表或视图的行划分为组。聚合函数适用于每组行，为每个组返回单个结果行。例如，聚合函数<code class="codeph">avg</code>返回一组值的平均值。
                     </p>
                     <p>函数<code class="codeph">json_dataguide</code>聚合JSON数据以生成它的摘要或规范，它以JSON文档的形式返回。换句话说，对于应用它们的每组JSON文档，它们返回数据指南。
                     </p>
                     <p>如果省略<code class="codeph">GROUP BY</code>则此函数返回单个数据指南，该指南汇总了主题JSON列中的所有JSON数据。
                     </p>
                     <p><a href="json-dataguide.html#GUID-BD147159-87A7-4AAC-B150-44E3F10A81E1__USINGJSON_DATAGUIDETOCREATEMULTIPLE-FC088B94">示例20-20</a>查询JSON列<code class="codeph">po_document</code>的文档，将它们分组以生成三个数据指南，每年对应一列<code class="codeph">date_loaded</code> 。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-BD147159-87A7-4AAC-B150-44E3F10A81E1__ADDINGA2015PURCHASE-ORDERDOCUMENT-FC010862">
                     <p class="titleinexample">示例20-18添加2015采购订单凭证</p>
                     <p>2015年采购订单格式仅使用部件号，参考和行项目作为其顶级字段，这些字段使用前缀<code class="codeph">PO_</code> 。每个订单项仅包含部件号和数量。
                     </p><pre class="pre codeblock"><code>INSERT INTO j_purchaseorder VALUES（SYS_GUID（），to_date（'30 -JUN- <span class="bold">2015'</span> ），'{“PO_Number”：4230，“PO_Reference”：“JDEER-20140421”，“PO_LineItems”：[{“Part_Number”：230912362345， “数量”：3.0}]}'）;</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-BD147159-87A7-4AAC-B150-44E3F10A81E1__ADDINGA2016PURCHASE-ORDERDOCUMENT-FC010487">
                     <p class="titleinexample">示例20-19添加2016采购订单凭证</p>
                     <p>2016格式使用<code class="codeph">PO_ID</code>而不是<code class="codeph">PO_Number</code> ， <code class="codeph">PO_Ref</code>而不是<code class="codeph">PO_Reference</code> ， <code class="codeph">PO_Items</code>而不是<code class="codeph">PO_LineItems</code> ， <code class="codeph">Part_No</code>而不是<code class="codeph">Part_Number</code> ，以及<code class="codeph">Item_Quantity</code>而不是<code class="codeph">Quantity</code> 。
                     </p><pre class="pre codeblock"><code>INSERT INTO j_purchaseorder VALUES（SYS_GUID（），to_date（'30 -MAR- <span class="bold">2016'</span> ），'{“PO_ID”：4230，“PO_Ref”：“JDEER-20140421”，“PO_Items”：[{“Part_No”：98981327234， “Item_Quantity”：13}]}'）;</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-BD147159-87A7-4AAC-B150-44E3F10A81E1__USINGJSON_DATAGUIDETOCREATEMULTIPLE-FC088B94">
                     <p class="titleinexample">示例20-20使用聚合函数JSON_DATAGUIDE创建多个数据指南</p>
                     <p>此示例使用聚合SQL函数<code class="codeph">json_dataguide</code>获取三个平坦的<a id="fn_1" name="fn_1" href="#fn_1" data="" if="" function="" json_dataguide="" were="" passed="" dbms_json.format_hierarchical="" as="" optional="" second="" argument="" then="" the="" result="" would="" be="" three="" hierarchical="" guides=")" ="" ="" onclick="footdisplay(1, "><sup>Foot 1</sup></a>数据指南，每个<code class="codeph">json_dataguide</code>针对每年特定的格式。2014年数据指南仅部分显示 - 与<a href="json-dataguide.html#GUID-12BCFCCE-18AE-4CB2-8710-EC7B712DA089" title="描述了样本平面数据指南的字段。它对应于一组采购订单文档。">采购订单文档的平面数据指南中</a>的数据指南相同，但不存在统计字段。（函数<code class="codeph">json_dataguide</code>返回的数据指南不包含任何统计字段。
                     </p><pre class="pre codeblock"><code>SELECT提取（YEAR FROM date_loaded），json_dataguide（po_document）FROM j_purchaseorder <span class="bold">GROUP BY</span> extract（ <span class="bold">YEAR</span> FROM <span class="bold">date_loaded</span> ）ORDER BY extract（YEAR FROM date_loaded）DESC; EXTRACT（YEARFROMDATE_LOADED）---------------------------- JSON_DATAGUIDE（PO_DOCUMENT）-------------- ------------- <span class="bold">2016</span> [{“o：path”：“$。PO_ID“，”类型“：”数字“，”o：长度“：4}，{”o：路径“：”$。PO_Ref“，”type“：”string“，”o：length“：16}，{”o：path“：”$。PO_Items“，”type“：”array“，”o：length“：64}，{”o：path“：”$。PO_Items。Part_No“，”type“：”number“，”o：length“：16}，{”o：path“：”$。PO_Items。Item_Quantity“，”type“：”number“，”o：length“：2}] <span class="bold">2015</span> [{”o：path“：”$。PO_Number“，”type“：”number“，”o：length“：4}，{”o：path“：”$。PO_LineItems“，”type“：”array“，”o：length“：64}，{”o：path“：”$。PO_LineItems。数量“，”类型“：”数字“，”o：长度“：4}，{”o：路径“：”$。PO_LineItems。Part_Number“，”type“：”number“，”o：length“：16}，{”o：path“：”$。PO_Reference“，”type“：”string“，”o：length“：16}] <span class="bold">2014</span> [{”o：path“：”$。用户“，”键入“：”string“，”o：length“：8}，{”o：path“：”$。PONumber“，”键入“：”数字“，”o：长度“：4}，...{“o：path”：“$。\”特殊说明\“”，“类型”：“字符串”，“o：长度”：8}]选择3行。</code></pre></div>
                  <!-- class="example" -->
                  <div class="section"></div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-BD147159-87A7-4AAC-B150-44E3F10A81E1__GUID-C5A6C50E-9E20-4C4D-8F20-8DCEAF6725F2">
                     <p class="notep1">也可以看看：</p>
                     <p>有关SQL函数<code class="codeph">json_dataguide</code>信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=SQLRF-GUID-4CF32887-0F46-4925-8381-AE2B74343933" target="_blank"><span><cite>参见Oracle数据库SQL语言参考</cite></span></a></p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="json-dataguide.html#GUID-219FC30E-89A7-4189-BC36-7B961A24067C" title="通过JSON数据指南，您可以发现有关Oracle数据库中存储的JSON文档的结构和内容的信息。">JSON数据指南</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-32ED8EE8-FC3E-406E-8AD6-652BB5A1D510" name="GUID-32ED8EE8-FC3E-406E-8AD6-652BB5A1D510"></a><h3 id="ADJSN-GUID-32ED8EE8-FC3E-406E-8AD6-652BB5A1D510" class="sect3"><span class="enumeration_section">20.11</span>查询数据指南</h3>
               <div>
                  <p>数据指南是有关一组JSON文档的信息。您可以使用Oracle SQL函数<code class="codeph">json_dataguide</code>或PL / SQL函数<code class="codeph">DBMS_JSON.get_index_dataguide</code>从平面数据指南中查询它。在后一种情况下，必须在JSON数据上定义启用数据引导的JSON搜索索引。
                  </p>
                  <div class="section">
                     <div class="infoboxnotealso" id="GUID-32ED8EE8-FC3E-406E-8AD6-652BB5A1D510__GUID-5B77088D-F916-40F8-8A14-BB174BAF938A">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>有关SQL函数<code class="codeph">json_dataguide</code>信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=SQLRF-GUID-4CF32887-0F46-4925-8381-AE2B74343933" target="_blank"><span><cite>参见Oracle数据库SQL语言参考</cite></span></a></p>
                           </li>
                           <li>
                              <p>有关SQL / JSON函数<code class="codeph">json_table</code>信息，请<a href="../sqlrf/JSON_TABLE.html#SQLRF-GUID-3C8E63B5-0B94-4E86-A2D3-3D4831B67C62" target="_blank"><span><cite>参见Oracle数据库SQL语言参考</cite></span></a></p>
                           </li>
                           <li>
                              <p>有关<code class="codeph">DBMS_JSON.get_index_dataguide</code>信息，请<code class="codeph">DBMS_JSON.get_index_dataguide</code> <a href="../arpls/DBMS_JSON.html#ARPLS-GUID-52B63CEE-669C-46FB-A276-56F7C6ECD036" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                           </li>
                           <li>
                              <p>有关PL / SQL常量<code class="codeph">DBMS_JSON.FORMAT_FLAT</code>信息，请<a href="../arpls/DBMS_JSON.html#ARPLS-GUID-F9032949-7FE1-4A31-AA4B-4A2775F0CBE6" target="_blank"><span><cite>参见Oracle数据库SQL语言参考</cite></span></a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-32ED8EE8-FC3E-406E-8AD6-652BB5A1D510__QUERYINGADATAGUIDEOBTAINEDUSINGJSON-FE1C6AE0">
                     <p class="titleinexample">示例20-21查询使用JSON_DATAGUIDE获取的数据指南</p>
                     <p>此示例使用SQL / JSON函数<code class="codeph">json_dataguide</code>获取平面数据指南。然后它通过SQL / JSON函数<code class="codeph">json_table</code>从字段<code class="codeph">o:path</code> ， <code class="codeph">type</code>和<code class="codeph">o:length</code>查询动态投影的关系列。它返回按创建的路径列<code class="codeph">jpath</code>按字典顺序排序的预计列。
                     </p><pre class="pre codeblock"><code>WITH dg_t AS（SELECT <span class="bold">json_dataguide</span> （po_document）dg_doc FROM j_purchaseorder）SELECT jt。* FROM dg_t，json_table（ <span class="bold">dg_doc</span> ，' <span class="bold">$ [*]</span> 'COLUMNS <span class="bold">jpath</span> VARCHAR2（40）PATH'$。“o：path”'，输入VARCHAR2（10）PATH'$。“type”'，tlength NUMBER PATH'$ 。“o：length”'） <span class="bold">jt</span> ORDER BY <span class="bold">jt.jpath</span> ; JPATH TYPE TLENGTH ---------------------------------------- ------- ------ ------- $。“特别说明”字符串8 $。AllowPartialShipment布尔值4 $。CostCenter字符串4 $。LineItems数组512 $。了LineItem。ItemNumber编号1 $。了LineItem。零件对象128 $。了LineItem。部分。描述字符串32 $。了LineItem。部分。UPCCode编号16 $。了LineItem。部分。UnitPrice编号8 $。了LineItem。数量4 $。PONumber 4号$。PO_LineItems数组64 $。参考字符串16 $。请求者字符串16 $。ShippingInstructions对象256 $。ShippingInstructions。地址对象128 $。ShippingInstructions。Address.city字符串32 $。ShippingInstructions。Address.country字符串32 $。ShippingInstructions。Address.state string 2 $。ShippingInstructions。Address.street字符串32 $。ShippingInstructions。Address.zipCode number 8 $。ShippingInstructions。手机阵列128 $。ShippingInstructions。电话串16 $。ShippingInstructions。Phone.number string 16 $。ShippingInstructions。Phone.type字符串8 $。ShippingInstructions.name字符串16 $。用户字符串8</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-32ED8EE8-FC3E-406E-8AD6-652BB5A1D510__QUERYINGADATAGUIDEFORPATHSWITHFREQU-FE1C38EB">
                     <p class="titleinexample">示例20-22使用索引数据查询数据指南，路径频率至少为80％</p>
                     <p>此示例使用格式值为<code class="codeph">DBMS_JSON.FORMAT_FLAT</code> PL / SQL函数<code class="codeph">DBMS_JSON.get_index_dataguide</code>从存储在启用数据指南的JSON搜索索引中的数据指南信息中获取平面数据指南。然后它通过SQL / JSON函数<code class="codeph">json_table</code>查询动态投影的关系列<code class="codeph">o:path</code> ， <code class="codeph">type</code> ， <code class="codeph">o:length</code>和<code class="codeph">o:frequency</code> 。
                     </p>
                     <p>字段<code class="codeph">o:frequency</code>的值是一个统计信息，用于记录文档中每个字段的整个文档集的出现频率。<span class="italic">仅当您收集</span>了文档集的<span class="italic">统计</span>信息<span class="italic">时才</span>可用。给定字段的频率是包含该字段的文档数除以JSON列中的文档总数，以百分比表示。
                     </p><pre class="pre codeblock"><code>WITH AS dg_t（SELECT <span class="bold">DBMS_JSON。get_index_dataguide（</span> 'J_PURCHASEORDER'， <span class="bold"><span class="bold">'PO_DOCUMENT'，DBMS_JSON。FORMAT_FLAT）dg_doc</span></span> FROM DUAL）SELECT JT。* FROM dg_t， <span class="bold">json_table</span> （ <span class="bold">dg_doc</span> ，' <span class="bold">$ [*]</span> 'COLUMNS jpath VARCHAR2（40）PATH'$。“o：path”'，输入VARCHAR2（10）PATH'$。“type”'，tlength NUMBER PATH'$ 。“o：length”'， <span class="bold">频率</span> NUMBER PATH'$。“o：frequency”'） <span class="bold">jt</span> WHERE <span class="bold">jt.frequency&gt; 80</span> ; JPATH TYPE TLENGTH FREQUENCY ---------------------------------------- ------ ------- -------- --------- $。用户字符串8 100 $。PONumber编号4 100 $。LineItems数组512 100 $。了LineItem。零件对象128 100 $。了LineItem。部分。UPCCode编号16 100 $。了LineItem。部分。UnitPrice编号8 100 $。了LineItem。部分。描述字符串32 100 $。了LineItem。数量4 100 $。了LineItem。ItemNumber编号1 100 $。参考字符串16 100 $。请求者字符串16 100 $。CostCenter字符串4 100 $。ShippingInstructions对象256 100 $。ShippingInstructions.name字符串16 100 $。ShippingInstructions。地址对象128 100 $。ShippingInstructions。Address.city字符串32 100 $。ShippingInstructions。Address.state string 2 100 $。ShippingInstructions。Address.street string 32 100 $。ShippingInstructions。Address.country字符串32 100 $。ShippingInstructions。Address.zipCode number 8 100 $。“Special Instructions”字符串8 100</code></pre></div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="json-dataguide.html#GUID-D8448CB1-0350-4848-B07E-9370B3B1A9BE" title="描述了JSON数据指南的预定义字段。它们包括JSON Schema字段（关键字）和Oracle特定字段。">JSON数据指南字段</a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="json-dataguide.html#GUID-219FC30E-89A7-4189-BC36-7B961A24067C" title="通过JSON数据指南，您可以发现有关Oracle数据库中存储的JSON文档的结构和内容的信息。">JSON数据指南</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-12BCFCCE-18AE-4CB2-8710-EC7B712DA089" name="GUID-12BCFCCE-18AE-4CB2-8710-EC7B712DA089"></a><h3 id="ADJSN-GUID-12BCFCCE-18AE-4CB2-8710-EC7B712DA089" class="sect3"><span class="enumeration_section">20.12</span>采购订单文件的平面数据指南</h3>
               <div>
                  <p>描述了样本平面数据指南的字段。它对应于一组采购订单文档。</p>
                  <p>平面数据指南中使用的唯一JSON Schema关键字是<code class="codeph"><span class="bold">type</span></code> 。其他字段都是Oracle数据引导字段，前缀为<code class="codeph"><span class="bold">o:</span></code> .
                  </p>
                  <p><a href="json-dataguide.html#GUID-12BCFCCE-18AE-4CB2-8710-EC7B712DA089__GUID-5B515937-780D-4D8D-86AF-74B13B44EC59">例20-23</a>显示了表<code class="codeph">j_purchaseorder</code>采购订单文档的平面数据指南。注意事项：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><code class="codeph">o:preferred_column_name</code>的值使用前缀<code class="codeph">PO_DOCUMENT$</code> 。此前缀来自使用<code class="codeph">DBMS_JSON.get_index_dataguide</code>获取此数据指南。
                        </p>
                     </li>
                     <li>
                        <p>对于路径<code class="codeph">$. ， <code class="codeph">o:length</code>值为8 <code class="codeph">$.例如， User</code>尽管字段值的实际长度为5。这是因为<code class="codeph">o:length</code>值总是2的幂。
                        </p>
                     </li>
                     <li>
                        <p>由于嵌入的空格字符，字段<code class="codeph">Special Instructions</code>的<code class="codeph">o:path</code>的值用双引号（ <code class="codeph">"Special Instructions"</code> ）包装。
                        </p>
                     </li>
                  </ul>
                  <div class="example" id="GUID-12BCFCCE-18AE-4CB2-8710-EC7B712DA089__GUID-5B515937-780D-4D8D-86AF-74B13B44EC59">
                     <p class="titleinexample">示例20-23采购订单的平面数据指南</p>
                     <p>路径是<span class="bold"><code class="codeph">bold</code></span> 。JSON模式关键字是<span class="italic"><code class="codeph">italic</code></span> 。使用<code class="codeph">DBMS_JSON.rename_column</code>产生的首选列名也是<span class="italic"><code class="codeph">italic</code></span> 。使用的格式类似于使用带有格式参数<code class="codeph">DBMS_JSON.FORMAT_FLAT</code>和<code class="codeph">DBMS_JSON.PRETTY</code> SQL / JSON函数<code class="codeph">json_dataguide</code>生成的格式。</p>
                     <p>请注意，字段<code class="codeph">o:frequency</code> ， <code class="codeph">o:low_value</code> ， <code class="codeph">o:high_value</code> ， <code class="codeph">o:num_nulls</code>和<code class="codeph">o:last_analyzed</code>存在。这只能是因为在文档集上收集了统计信息。他们的价值观反映了上次统计数据的状态。有关收集此数据的统计信息的示例，请参见<a href="json-dataguide.html#GUID-E77948CB-DCA0-4733-8832-4B5F00C01A2E__EXAMPLE-1410-F572454E">示例20-3</a> 。
                     </p><pre class="pre codeblock"><code>[{“o：path”：“ <span class="bold">$。用户</span> “，” <span class="italic">键入</span> “：”字符串“，”o：length“：8，”o：preferred_column_name“：”PO_DOCUMENT $ User“，”o：frequency“：100，”o：low_value“：”ABULL“，” o：high_value“：”SBELL“，”o：num_nulls“：0，”o：last_analyzed“：”2016-03-31T12：17：53“}，{”o：path“：” <span class="bold">$。PONumber</span> “，” <span class="italic">键入</span> “：”数字“，”o：长度“：4，”o：preferred_column_name“：” <span class="italic">PONumber</span> “，”o：frequency“：100，”o：low_value“：”672“，”o： high_value“：”1600“，”o：num_nulls“：0，”o：last_analyzed“：”2016-03-31T12：17：53“}，{”o：path“：” <span class="bold">$。LineItems</span> “，” <span class="italic">type</span> “：”array“，”o：length“：512，”o：preferred_column_name“：”PO_DOCUMENT $ LineItems“，”o：frequency“：100，”o：last_analyzed“：”2016-03- 31T12：17：53“}，{”o：path“：” <span class="bold">$。了LineItem。部分</span> “，” <span class="italic">类型</span> “：”对象“，”o：长度“：128，”o：preferred_column_name“：”PO_DOCUMENT $ Part“，”o：frequency“：100，”o：last_analyzed“：”2016-03- 31T12：17：53“}，{”o：path“：” <span class="bold">$。了LineItem。部分。UPCCode</span> “，” <span class="italic">type</span> “：”number“，”o：length“：16，”o：preferred_column_name“：”PO_DOCUMENT $ UPCCode“，”o：frequency“：100，”o：low_value“：”13131092899“，” o：high_value“：”717951002396“，”o：num_nulls“：0，”o：last_analyzed“：”2016-03-31T12：17：53“}，{”o：path“：” <span class="bold">$。了LineItem。部分。UnitPrice</span> “，” <span class="italic">type</span> “：”number“，”o：length“：8，”o：preferred_column_name“：”PO_DOCUMENT $ UnitPrice“，”o：frequency“：100，”o：low_value“：”20“，” o：high_value“：”19.95“，”o：num_nulls“：0，”o：last_analyzed“：”2016-03-31T12：17：53“}，{”o：path“：” <span class="bold">$。了LineItem。部分。说明</span> “，” <span class="italic">类型</span> “：”字符串“，”o：长度“：32，”o：preferred_column_name“：” <span class="italic">PartDescription</span> “，”o：frequency“：100，”o：low_value“：”Nixon“，”o： high_value“：”Eric Clapton：最佳1981-1999“，”o：num_nulls“：0，”o：last_analyzed“：”2016-03-31T12：17：53“}，{”o：path“：” <span class="bold">$ 。了LineItem。数量</span> “，” <span class="italic">类型</span> “：”数字“，”o：长度“：4，”o：preferred_column_name“：”PO_DOCUMENT $ Quantity“，”o：frequency“：100，”o：low_value“：”5“，” o：high_value“：”9.0“，”o：num_nulls“：0，”o：last_analyzed“：”2016-03-31T12：17：53“}，{”o：path“：” <span class="bold">$。了LineItem。ItemNumber</span> “，” <span class="italic">type</span> “：”number“，”o：length“：1，”o：preferred_column_name“：” <span class="italic">ItemNumber</span> “，”o：frequency“：100，”o：low_value“：”1“，”o： high_value“：”3“，”o：num_nulls“：0，”o：last_analyzed“：”2016-03-31T12：17：53“}，{”o：path“：” <span class="bold">$。引用</span> “，” <span class="italic">类型</span> “：”字符串“，”o：length“：16，”o：preferred_column_name“：”PO_DOCUMENT $ Reference“，”o：frequency“：100，”o：low_value“：”ABULL-20140421“ ，“o：high_value”：“SBELL-20141017”，“o：num_nulls”：0，“o：last_analyzed”：“2016-03-31T12：17：53”}，{“o：path”：“ <span class="bold">$。请求者</span> “，” <span class="italic">类型</span> “：”字符串“，”o：长度“：16，”o：preferred_column_name“：”PO_DOCUMENT $ Requestor“，”o：frequency“：100，”o：low_value“：”Sarah Bell“， “o：high_value”：“Alexis Bull”，“o：num_nulls”：0，“o：last_analyzed”：“2016-03-31T12：17：53”}，{“o：path”：“ <span class="bold">$。CostCenter</span> “，” <span class="italic">type</span> “：”string“，”o：length“：4，”o：preferred_column_name“：”PO_DOCUMENT $ CostCenter“，”o：frequency“：100，”o：low_value“：”A50“，” o：high_value“：”A50“，”o：num_nulls“：0，”o：last_analyzed“：”2016-03-31T12：17：53“}，{”o：path“：” <span class="bold">$。AllowPartialShipment</span> “，” <span class="italic">type</span> “：”boolean“，”o：length“：4，”o：preferred_column_name“：”PO_DOCUMENT $ AllowPartialShipment“，”o：frequency“：50，”o：low_value“：”true“，” o：high_value“：”true“，”o：num_nulls“：0，”o：last_analyzed“：”2016-03-31T12：17：53“}，{”o：path“：” <span class="bold">$。ShippingInstructions</span> “，” <span class="italic">type</span> “：”object“，”o：length“：256，”o：preferred_column_name“：”PO_DOCUMENT $ ShippingInstructions“，”o：frequency“：100，”o：last_analyzed“：”2016-03- 31T12：17：53“}，{”o：path“：” <span class="bold">$。ShippingInstructions.name</span> “，” <span class="italic">type</span> “：”string“，”o：length“：16，”o：preferred_column_name“：”PO_DOCUMENT $ name“，”o：frequency“：100，”o：low_value“：”Sarah Bell “，”o：high_value“：”Alexis Bull“，”o：num_nulls“：0，”o：last_analyzed“：”2016-03-31T12：17：53“}，{”o：path“：” <span class="bold">$。ShippingInstructions。电话</span> “，” <span class="italic">键入</span> “：”字符串“，”o：长度“：16，”o：preferred_column_name“：” <span class="italic">电话</span> “，”o：频率“：50，”o：low_value“：”983-555-6509“ ，“o：high_value”：“983-555-6509”，“o：num_nulls”：0，“o：last_analyzed”：“2016-03-31T12：17：53”}，{“o：path”：“ <span class="bold">$。ShippingInstructions。电话</span> “，” <span class="italic">键入</span> “：”数组“，”o：长度“：128，”o：preferred_column_name“：”PO_DOCUMENT $ Phone_1“，”o：frequency“：50，”o：last_analyzed“：”2016-03- 31T12：17：53“}，{”o：path“：” <span class="bold">$。ShippingInstructions。Phone.type</span> “，” <span class="italic">type</span> “：”string“，”o：length“：8，”o：preferred_column_name“：” <span class="italic">PhoneType</span> “，”o：frequency“：50，”o：low_value“：”Mobile“，” o：high_value“：”Office“，”o：num_nulls“：0，”o：last_analyzed“：”2016-03-31T12：17：53“}，{”o：path“：” <span class="bold">$。ShippingInstructions。Phone.number</span> “，” <span class="italic">type</span> “：”string“，”o：length“：16，”o：preferred_column_name“：” <span class="italic">PhoneNumber</span> “，”o：frequency“：50，”o：low_value“：”415-555- 1234“，”o：high_value“：”909-555-7307“，”o：num_nulls“：0，”o：last_analyzed“：”2016-03-31T12：17：53“}，{”o：path“ ：“ <span class="bold">$。ShippingInstructions。地址</span> “，” <span class="italic">类型</span> “：”对象“，”o：长度“：128，”o：preferred_column_name“：”PO_DOCUMENT $ Address“，”o：frequency“：100，”o：last_analyzed“：”2016-03- 31T12：17：53“}，{”o：path“：” <span class="bold">$。ShippingInstructions。Address.city</span> “，” <span class="italic">type</span> “：”string“，”o：length“：32，”o：preferred_column_name“：”PO_DOCUMENT $ city“，”o：frequency“：100，”o：low_value“：”South San Francisco“，”o：high_value“：”South San Francisco“，”o：num_nulls“：0，”o：last_analyzed“：”2016-03-31T12：17：53“}，{”o：path“：” <span class="bold">$。ShippingInstructions。Address.state</span> “，” <span class="italic">type</span> “：”string“，”o：length“：2，”o：preferred_column_name“：”PO_DOCUMENT $ state“，”o：frequency“：100，”o：low_value“：”CA“ ，“o：high_value”：“CA”，“o：num_nulls”：0，“o：last_analyzed”：“2016-03-31T12：17：53”}，{“o：path”：“ <span class="bold">$。ShippingInstructions。Address.street</span> “，” <span class="italic">type</span> “：”string“，”o：length“：32，”o：preferred_column_name“：”PO_DOCUMENT $ street“，”o：frequency“：100，”o：low_value“：”200 Sporting绿色“，”o：high_value“：”200 Sporting Green“，”o：num_nulls“：0，”o：last_analyzed“：”2016-03-31T12：17：53“}，{”o：path“：” <span class="bold">$。ShippingInstructions。Address.country</span> “，” <span class="italic">type</span> “：”string“，”o：length“：32，”o：preferred_column_name“：”PO_DOCUMENT $ country“，”o：frequency“：100，”o：low_value“：”United States of America“，”o：high_value“：”United States of America“，”o：num_nulls“：0，”o：last_analyzed“：”2016-03-31T12：17：53“}，{”o：path“ ：“ <span class="bold">$。ShippingInstructions。Address.zipCode</span> “，” <span class="italic">type</span> “：”number“，”o：length“：8，”o：preferred_column_name“：”PO_DOCUMENT $ zipCode“，”o：frequency“：100，”o：low_value“：”99236“ ，“o：high_value”：“99236”，“o：num_nulls”：0，“o：last_analyzed”：“2016-03-31T12：17：53”}，{“o：path”：“ <span class="bold">$。\”特殊说明\“</span> ”，“ <span class="italic">类型</span> ”：“字符串”，“o：长度”：8，“o：preferred_column_name”：“PO_DOCUMENT $ SpecialInstructions”，“o：frequency”：100，“o：low_value”：“Courier “，”o：high_value“：”Courier“，”o：num_nulls“：1，”o：last_analyzed“：”2016-03-31T12：17：53“}]</code></pre></div>
                  <!-- class="example" -->
                  <div class="section"></div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="json-dataguide.html#GUID-D8448CB1-0350-4848-B07E-9370B3B1A9BE" title="描述了JSON数据指南的预定义字段。它们包括JSON Schema字段（关键字）和Oracle特定字段。">JSON数据指南字段</a></li>
                        <li><a href="json-dataguide.html#GUID-A0AFD360-93A7-4566-8315-6F68D9AE090B" title="您可以将数据中的JSON字段作为数据库视图中的列或作为添加到包含JSON列的同一表的虚拟列进行投影。您可以为此类列指定首选名称。">为字段列指定首选名称</a></li>
                     </ul>
                  </div>
                  <div class="infoboxnotealso" id="GUID-12BCFCCE-18AE-4CB2-8710-EC7B712DA089__GUID-B171FF1F-CB6D-40A6-9DAA-D601B636C29F">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="creating-a-table-with-a-json-column.html#GUID-E6CC0DCF-3D72-41EF-ACA4-B3BF54EE3CA0__CACCIEFA">例4-2</a></p>
                        </li>
                        <li>
                           <p>有关<code class="codeph">DBMS_JSON.get_index_dataguide</code>信息，请<code class="codeph">DBMS_JSON.get_index_dataguide</code> <a href="../arpls/DBMS_JSON.html#ARPLS-GUID-52B63CEE-669C-46FB-A276-56F7C6ECD036" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                        </li>
                        <li>
                           <p>有关<code class="codeph">DBMS_JSON.rename_column</code>信息，请<code class="codeph">DBMS_JSON.rename_column</code> <a href="../arpls/DBMS_JSON.html#ARPLS-GUID-0E802354-4508-4DF7-A07A-6999F3337CA5" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="json-dataguide.html#GUID-219FC30E-89A7-4189-BC36-7B961A24067C" title="通过JSON数据指南，您可以发现有关Oracle数据库中存储的JSON文档的结构和内容的信息。">JSON数据指南</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-885E0CB3-9165-448E-96DA-1CC56276F685" name="GUID-885E0CB3-9165-448E-96DA-1CC56276F685"></a><h3 id="ADJSN-GUID-885E0CB3-9165-448E-96DA-1CC56276F685" class="sect3"><span class="enumeration_section">20.13</span>采购订单文档的分层数据指南</h3>
               <div>
                  <p>描述了样本分层数据指南的字段。它对应于一组采购订单文档。</p>
                  <p><a href="json-dataguide.html#GUID-885E0CB3-9165-448E-96DA-1CC56276F685__GUID-EA4D1E07-20A1-4D3E-8D35-BFC5D0BE6E2C">示例20-24</a>显示了表<code class="codeph">j_purchaseorder</code>的采购订单文档的分层数据指南。
                  </p>
                  <div class="example" id="GUID-885E0CB3-9165-448E-96DA-1CC56276F685__GUID-EA4D1E07-20A1-4D3E-8D35-BFC5D0BE6E2C">
                     <p class="titleinexample">示例20-24采购订单的分层数据指南</p>
                     <p>字段名称是<span class="bold"><code class="codeph">bold</code></span> 。JSON Schema关键字是<span class="italic"><code class="codeph">italic</code></span> 。使用<code class="codeph">DBMS_JSON.rename_column</code>产生的首选列名也是<span class="italic"><code class="codeph">italic</code></span> 。使用的格式类似于使用带有格式参数<code class="codeph">DBMS_JSON.FORMAT_HIERARCHICAL</code>和<code class="codeph">DBMS_JSON.PRETTY</code> SQL / JSON函数<code class="codeph">json_dataguide</code>生成的格式。</p>
                     <p>请注意，此示例中存在字段<code class="codeph">o:frequency</code> ， <code class="codeph">o:low_value</code> ， <code class="codeph">o:high_value</code> ， <code class="codeph">o:num_nulls</code>和<code class="codeph">o:last_analyzed</code> 。这只能是因为在文档集上收集了统计信息。他们的价值观反映了上次统计数据的状态。有关收集此数据的统计信息的示例，请参见<a href="json-dataguide.html#GUID-E77948CB-DCA0-4733-8832-4B5F00C01A2E__EXAMPLE-1410-F572454E">示例20-3</a> 。
                     </p><pre class="pre codeblock"><code>{“ <span class="italic">type</span> ”：“object”，“ <span class="italic">properties</span> ”：{“ <span class="bold">User</span> ”：{“ <span class="italic">type</span> ”：“string”，“o：length”：8，“o：preferred_column_name”：“PO_DOCUMENT $ User”，“o：频率“：100，”o：low_value“：”ABULL“，”o：high_value“：”SBELL“，”o：num_nulls“：0，”o：last_analyzed“：”2016-03-31T12：17：53“ }，“ <span class="bold">PONumber</span> ”：{“ <span class="italic">type</span> ”：“number”，“o：length”：4，“o：preferred_column_name”：“ <span class="italic">PONumber</span> ”，“o：frequency”：100，“o：low_value”：“672” ，“o：high_value”：“1600”，“o：num_nulls”：0，“o：last_analyzed”：“2016-03-31T12：17：53”}，“ <span class="bold">LineItems</span> ”：{“ <span class="italic">type</span> ”：“array” ，“o：length”：512，“o：preferred_column_name”：“PO_DOCUMENT $ LineItems”，“o：frequency”：100，“o：last_analyzed”：“2016-03-31T12：17：53”，“ <span class="italic">items</span> ” ：{“ <span class="italic">properties</span> ”：{“ <span class="bold">Part</span> ”：{“ <span class="italic">type</span> ”：“object”，“o：length”：128，“o：preferred_column_name”：“PO_DOCUMENT $ Part”，“o：frequency”：100，“o ：last_analyzed“：”2016-03-31T12：17：53“，” <span class="italic">properties</span> “：{” <span class="bold">UPCCode</span> “：{” <span class="italic">type</span> “：”number“，”o：length“：16，”o：preferred_column_name“：”PO_DOCUMENT $ UPCCode“，”o：频率“：100，”o：low_value“：”1313 1092899“，”o：high_value“：”717951002396“，”o：num_nulls“：0，”o：last_analyzed“：”2016-03-31T12：17：53“}，” <span class="bold">UnitPrice</span> “：{” <span class="italic">type</span> “：” number“，”o：length“：8，”o：preferred_column_name“：”PO_DOCUMENT $ UnitPrice“，”o：frequency“：100，”o：low_value“：”20“，”o：high_value“：”19.95“ ，“o：num_nulls”：0，“o：last_analyzed”：“2016-03-31T12：17：53”}，“ <span class="bold">描述</span> ”：{“ <span class="italic">type</span> ”：“string”，“o：length”：32，“ o：preferred_column_name“：” <span class="italic">PartDescription</span> “，”o：frequency“：100，”o：low_value“：”Nixon“，”o：high_value“：”Eric Clapton：Best Of 1981-1999“，”o：num_nulls“： 0，“o：last_analyzed”：“2016-03-31T12：17：53”}}}，“ <span class="bold">Quantity</span> ”：{“ <span class="italic">type</span> ”：“number”，“o：length”：4，“o：preferred_column_name”： “PO_DOCUMENT $ Quantity”，“o：frequency”：100，“o：low_value”：“5”，“o：high_value”：“9.0”，“o：num_nulls”：0，“o：last_analyzed”：“2016 -03-31T12：17：53“}，” <span class="bold">ItemNumber</span> “：{” <span class="italic">type</span> “：”number“，”o：length“：1，”o：preferred_column_name“：” <span class="italic">ItemNumber</span> “，”o：frequency“：100， “o：low_value”：“1”，“o：high_value”：“3”，“o：num_nulls”：0 ，“o：last_analyzed”：“2016-03-31T12：17：53”}}}}，“ <span class="bold">参考</span> ”：{“ <span class="italic">type</span> ”：“string”，“o：length”：16，“o：preferred_column_name”： “PO_DOCUMENT $ Reference”，“o：frequency”：100，“o：low_value”：“ABULL-20140421”，“o：high_value”：“SBELL-20141017”，“o：num_nulls”：0，“o：last_analyzed “：”2016-03-31T12：17：53“}，” <span class="bold">请求者</span> “：{” <span class="italic">type</span> “：”string“，”o：length“：16，”o：preferred_column_name“：”PO_DOCUMENT $ Requestor“，”o ：频率“：100，”o：low_value“：”Sarah Bell“，”o：high_value“：”Alexis Bull“，”o：num_nulls“：0，”o：last_analyzed“：”2016-03-31T12：17 ：53“}，” <span class="bold">CostCenter</span> “：{” <span class="italic">type</span> “：”string“，”o：length“：4，”o：preferred_column_name“：”PO_DOCUMENT $ CostCenter“，”o：frequency“：100，”o：low_value “：”A50“，”o：high_value“：”A50“，”o：num_nulls“：0，”o：last_analyzed“：”2016-03-31T12：17：53“}，” <span class="bold">AllowPartialShipment</span> “：{” <span class="italic">type</span> “：”boolean“，”o：length“：4，”o：preferred_column_name“：”PO_DOCUMENT $ AllowPartialShipment“，”o：frequency“：50，”o：last_analyzed“：”2016-03-31T12：17：53 “}，” <span class="bold">ShippingInstructions</span> “ ：{“ <span class="italic">type</span> ”：“object”，“o：length”：256，“o：preferred_column_name”：“PO_DOCUMENT $ ShippingInstructions”，“o：frequency”：100，“o：last_analyzed”：“2016-03-31T12 ：17：53“，” <span class="italic">properties</span> “：{” <span class="bold">name</span> “：{” <span class="italic">type</span> “：”string“，”o：length“：16，”o：preferred_column_name“：”PO_DOCUMENT $ name“，”o：frequency“： 100，“o：low_value”：“Sarah Bell”，“o：high_value”：“Alexis Bull”，“o：num_nulls”：0，“o：last_analyzed”：“2016-03-31T12：17：53”} ，“ <span class="bold">电话</span> ”：{“ <span class="italic">oneOf</span> ”：[{“ <span class="italic">type</span> ”：“string”，“o：length”：16，“o：preferred_column_name”：“ <span class="italic">Phone</span> ”，“o：frequency”：50，“o：low_value “：”983-555-6509“，”o：high_value“：”983-555-6509“，”o：num_nulls“：0，”o：last_analyzed“：”2016-03-31T12：17：53“} ，{“ <span class="italic">type</span> ”：“array”，“o：length”：128，“o：preferred_column_name”：“PO_DOCUMENT $ Phone_1”，“o：frequency”：50，“o：last_analyzed”：“2016-03-31T12 ：17：53“，” <span class="italic">items</span> “：{” <span class="italic">properties</span> “：{” <span class="bold">type</span> “：{” <span class="italic">type</span> “：”string“，”o：length“：8，”o：preferred_column_name“：” <span class="italic">PhoneType</span> “，”o：频率“：50，”o：low_value“：”移动“，”o：high_value“：”关闭ice“，”o：num_nulls“：0，”o：last_analyzed“：”2016-03-31T12：17：53“}，” <span class="bold">number</span> “：{” <span class="italic">type</span> “：”string“，”o：length“：16 ，“o：preferred_column_name”：“ <span class="italic">PhoneNumber</span> ”，“o：frequency”：50，“o：low_value”：“415-555-1234”，“o：high_value”：“909-555-7307”，“o： num_nulls“：0，”o：last_analyzed“：”2016-03-31T12：17：53“}}}}]}，” <span class="bold">地址</span> “：{” <span class="italic">type</span> “：”object“，”o：length“：128， “o：preferred_column_name”：“PO_DOCUMENT $ Address”，“o：frequency”：100，“o：last_analyzed”：“2016-03-31T12：17：53”，“ <span class="italic">properties</span> ”：{“ <span class="bold">city</span> ”：{“ <span class="italic">type</span> “：”string“，”o：length“：32，”o：preferred_column_name“：”PO_DOCUMENT $ city“，”o：frequency“：100，”o：low_value“：”South San Francisco“，”o：high_value “：”南旧金山“，”o：num_nulls“：0，”o：last_analyzed“：”2016-03-31T12：17：53“}，” <span class="bold">州</span> “：{” <span class="italic">type</span> “：”string“，”o ：length“：2，”o：preferred_column_name“：”PO_DOCUMENT $ state“，”o：frequency“：100，”o：low_value“：”CA“，”o：high_value“：”CA“，”o：num_nulls “：0，”o：last_analyzed“：”2016-03-31T12：17：53“}，” <span class="bold">street</span> “：{” <span class="italic">type</span> “：”st ring“，”o：length“：32，”o：preferred_column_name“：”PO_DOCUMENT $ street“，”o：frequency“：100，”o：low_value“：”200 Sporting Green“，”o：high_value“：” 200 Sporting Green“，”o：num_nulls“：0，”o：last_analyzed“：”2016-03-31T12：17：53“}，” <span class="bold">country</span> “：{” <span class="italic">type</span> “：”string“，”o：length“ ：32，“o：preferred_column_name”：“PO_DOCUMENT $ country”，“o：frequency”：100，“o：low_value”：“United States of America”，“o：high_value”：“United States of America”，“ o：num_nulls“：0，”o：last_analyzed“：”2016-03-31T12：17：53“}，” <span class="bold">zipCode</span> “：{” <span class="italic">type</span> “：”number“，”o：length“：8，”o： preferred_column_name“：”PO_DOCUMENT $ zipCode“，”o：frequency“：100，”o：low_value“：”99236“，”o：high_value“：”99236“，”o：num_nulls“：0，”o：last_analyzed“ ：“2016-03-31T12：17：53”}}}}}，“ <span class="bold">特别说明</span> ”：{“ <span class="italic">type</span> ”：“string”，“o：length”：8，“o：preferred_column_name”：“PO_DOCUMENT $ SpecialInstructions “，”o：频率“：100，”o：low_value“：”Courier“，”o：high_value“：”Courier“，”o：num_nulls“：1，”o：last_analyzed“：”2016-03-31T12 ：17：53“}}}</code></pre></div>
                  <!-- class="example" -->
                  <div class="section"></div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="json-dataguide.html#GUID-D8448CB1-0350-4848-B07E-9370B3B1A9BE" title="描述了JSON数据指南的预定义字段。它们包括JSON Schema字段（关键字）和Oracle特定字段。">JSON数据指南字段</a></li>
                        <li><a href="json-dataguide.html#GUID-A0AFD360-93A7-4566-8315-6F68D9AE090B" title="您可以将数据中的JSON字段作为数据库视图中的列或作为添加到包含JSON列的同一表的虚拟列进行投影。您可以为此类列指定首选名称。">为字段列指定首选名称</a></li>
                     </ul>
                  </div>
                  <div class="infoboxnotealso" id="GUID-885E0CB3-9165-448E-96DA-1CC56276F685__GUID-B171FF1F-CB6D-40A6-9DAA-D601B636C29F">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="creating-a-table-with-a-json-column.html#GUID-E6CC0DCF-3D72-41EF-ACA4-B3BF54EE3CA0__CACCIEFA">例4-2</a></p>
                        </li>
                        <li>
                           <p>有关SQL函数<code class="codeph">json_dataguide</code>信息，请<a href="../sqlrf/JSON_DATAGUIDE.html#SQLRF-GUID-4CF32887-0F46-4925-8381-AE2B74343933" target="_blank"><span><cite>参见Oracle数据库SQL语言参考</cite></span></a></p>
                        </li>
                        <li>
                           <p>有关<code class="codeph">DBMS_JSON.rename_column</code>信息，请<code class="codeph">DBMS_JSON.rename_column</code> <a href="../arpls/DBMS_JSON.html#ARPLS-GUID-0E802354-4508-4DF7-A07A-6999F3337CA5" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="json-dataguide.html#GUID-219FC30E-89A7-4189-BC36-7B961A24067C" title="通过JSON数据指南，您可以发现有关Oracle数据库中存储的JSON文档的结构和内容的信息。">JSON数据指南</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <hr><br><p style="text-decoration:underline">脚注图例</p>脚注1：如果函数json_dataguide通过DBMS_JSON.FORMAT_HIERARCHICAL作为可选的第二个参数，那么结果将是三个分层数据指南。<br></div>
      </article>
   </body>
</html>