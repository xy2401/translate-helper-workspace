<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>分配维护通道</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Backup and Recovery Reference"></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Backup and Recovery Reference"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="database-backup-and-recovery-reference.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-09T19:31:58-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2003, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96242-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="ALLOCATE-CHANNEL.html" title="Previous" type="text/html"></link>
      <link rel="next" href="BACKUP.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database Backup and Recovery Reference"></meta>
    <meta name="dcterms.isVersionOf" content="RCMRF"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="ALLOCATE-CHANNEL.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="BACKUP.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">备份和恢复参考</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="rman-commands-at-sign-to-quit.html" property="item" typeof="WebPage"><span property="name">RMAN命令：@（at符号）到QUIT</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">分配维护通道</li>
            </ol>
            <a id="GUID-6F9887A0-1D48-4332-8E59-6FA2EFE67824" name="GUID-6F9887A0-1D48-4332-8E59-6FA2EFE67824"></a><a id="RCMRF89998"></a><a id="RCMRF89999"></a><a id="RCMRF90000"></a><a id="RCMRF90001"></a><a id="RCMRF90002"></a><a id="RCMRF103"></a>
            
            <h2 id="RCMRF-GUID-6F9887A0-1D48-4332-8E59-6FA2EFE67824" class="sect2"><span class="enumeration_section">2.5</span>分配维护通道</h2>
         </header>
         <div class="ind">
            <div>
               <div class="section">
                  <p class="subhead1" id="GUID-6F9887A0-1D48-4332-8E59-6FA2EFE67824__GUID-F7BA6E80-B2E1-40DF-A9C8-ABC0A1D8E7A0">目的</p>
                  <p>使用<code class="codeph">ALLOCATE CHANNEL FOR MAINTENANCE</code>命令手动分配通道以准备发出<code class="codeph"><a href="CHANGE.html#GUID-961151C6-EEFF-4347-AF1E-93EFDD5F5BF2">CHANGE</a></code> ， <code class="codeph"><a href="DELETE.html#GUID-FB4EAC69-4978-42F7-8B09-77C6736188B3">DELETE</a></code>或<code class="codeph"><a href="CROSSCHECK.html#GUID-07E07E7E-9A29-4901-9739-FFC472029A7D">CROSSCHECK</a></code>命令。您可以使用<code class="codeph"><a href="RELEASE-CHANNEL.html#GUID-E5B046B9-FE5E-46B4-ABDB-455DB433AECD">RELEASE CHANNEL</a></code>命令取消分配通道。
                  </p>
                  <div class="infoboxnote" id="GUID-6F9887A0-1D48-4332-8E59-6FA2EFE67824__GUID-6E2C43B2-4DDE-42ED-B242-E120552FDE07">
                     <p class="notep1">注意：</p>
                     <p>如果为<code class="codeph"><a href="CONFIGURE.html#GUID-B5094E73-C26C-4FED-AE39-8C2E9540050A">CONFIGURE</a></code>中的每种设备类型<code class="codeph"><a href="CONFIGURE.html#GUID-B5094E73-C26C-4FED-AE39-8C2E9540050A">CONFIGURE</a></code>至少一个通道，则无需使用<code class="codeph">ALLOCATE CHANNEL FOR MAINTENANCE</code> 。 Oracle建议您使用已配置的通道而不是维护通道。您可以将已配置的通道用于指定设备的所有RMAN I / O，而不仅仅是维护通道支持的维护任务。配置的通道在RMAN会话中保持不变。
                     </p>
                  </div>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-6F9887A0-1D48-4332-8E59-6FA2EFE67824__GUID-313B4CC3-D28A-4362-A7F9-D1827F35D227">先决条件</p>
                  <p>仅在RMAN提示符处执行此命令，而不是在<code class="codeph">RUN</code>块中。必须启动目标实例。您无法将维护通道分配给共享会话。<a id="d11611e143" class="indexterm-anchor"></a><a id="d11611e145" class="indexterm-anchor"></a><a id="d11611e149" class="indexterm-anchor"></a></p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-6F9887A0-1D48-4332-8E59-6FA2EFE67824__GUID-4058161B-568C-439C-8122-3776392A507A">使用说明</p>
                  <p>通常，为每个设备分配一个维护通道。手动分配的频道和自动频道永远不会混合。通常，仅在以下情况下为单个作业分配多个维护通道：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a id="d11611e161" class="indexterm-anchor"></a><a id="d11611e165" class="indexterm-anchor"></a><a id="d11611e169" class="indexterm-anchor"></a><a id="d11611e173" class="indexterm-anchor"></a><a id="d11611e177" class="indexterm-anchor"></a>使用单个命令启用磁盘和磁带上所有备份片的交叉检查或删除（请参阅<a href="ALLOCATE-CHANNEL-FOR-MAINTENANCE.html#GUID-6F9887A0-1D48-4332-8E59-6FA2EFE67824__CHDGBFJH">示例2-11</a> ）</p>
                     </li>
                     <li>
                        <p>在Oracle Real Application Clusters（Oracle RAC）配置中正确地进行交叉检查和删除工作，其中每个备份片仅存在于一个节点上（请参阅<a href="ALLOCATE-CHANNEL-FOR-MAINTENANCE.html#GUID-6F9887A0-1D48-4332-8E59-6FA2EFE67824__CHDCJABF">示例2-12</a> ）</p>
                     </li>
                  </ul>
                  <p>RMAN使用以下约定来命名维护通道： <code class="codeph">ORA_MAINT_</code> <span class="italic"><code class="codeph">devicetype</code></span> <code class="codeph">_</code> <span class="italic"><code class="codeph">n</code></span> ，其中<span class="italic"><code class="codeph">devicetype</code></span>是指<code class="codeph">DISK</code>或<code class="codeph">sbt</code> ， <span class="italic"><code class="codeph">n</code></span>是指通道号。例如，RMAN将这些名称用于两个手动分配的磁盘通道：</p><pre class="oac_no_warn" dir="ltr">ORA_MAINT_DISK_1 ORA_MAINT_DISK_2</pre><div class="infoboxnotealso" id="GUID-6F9887A0-1D48-4332-8E59-6FA2EFE67824__GUID-CD45A8C3-B469-482D-A2D9-F3C778BF51CF">
                     <p class="notep1">也可以看看：</p>
                     <p> <a href="../bradv/maintaining-rman-backups.html#BRADV-GUID-E1D38362-4C8E-4F16-AEBF-6A6429D7BB3A" target="_blank"><span><cite>Oracle数据库备份和恢复用户指南</cite></span></a> ，了解如何在多个渠道上进行交叉检查和删除</p>
                  </div>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-6F9887A0-1D48-4332-8E59-6FA2EFE67824__GUID-E6D12C02-2E2C-43AC-A022-55D006ACB788">句法</p>
                  <p><span class="bold"><span class="italic">allocateForMaint :: =</span></span></p>
                  <div class="figure" id="GUID-6F9887A0-1D48-4332-8E59-6FA2EFE67824__GUID-FB343E34-42EF-4A08-B68E-B150B1FC9587"><img src="img/allocateformaint.gif" alt="allocateformaint.eps的描述如下" title="allocateformaint.eps的描述如下" longdesc="img_text/allocateformaint.html"><br><a href="img_text/allocateformaint.html">allocateformaint.eps插图说明</a></div>
                  <!-- class="figure" -->
                  <p>（ <span class="italic"><a href="deviceSpecifier.html#GUID-F653748D-4AB5-4A0E-B6E5-D891A000ADAC__BABDEJAC">deviceSpecifier :: =</a></span> ， <span class="italic"><a href="allocOperandList.html#GUID-8B6C1DAB-F27A-4DA8-BECC-5DA04F5907DA__BABFFJCH">allocOperandList :: =</a></span> ）</p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-6F9887A0-1D48-4332-8E59-6FA2EFE67824__GUID-F2B24F17-31AC-4E2F-B59A-F46ACF4032B3">语义</p>
                  <p id="GUID-6F9887A0-1D48-4332-8E59-6FA2EFE67824__CHDHDJFB"><span class="bold"><span class="italic">allocateForMaint</span></span></p>
                  <div class="tblformalwide" id="GUID-6F9887A0-1D48-4332-8E59-6FA2EFE67824__GUID-387C7C8D-8803-4B66-870E-7164A9AE20D5">
                     <table cellpadding="4" cellspacing="0" class="FormalWide" title="" width="100%" border="1" summary="Describes ALLOCATE CHANNEL FOR MAINTENANCE command parameters" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="27%" id="d11611e263">语法元素</th>
                              <th align="left" valign="bottom" width="73%" id="d11611e266">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="27%" id="d11611e271" headers="d11611e263 "><code class="codeph">DEVICE TYPE</code> <span class="italic"><code class="codeph"><span class="codeinlineitalic"><a href="deviceSpecifier.html#GUID-F653748D-4AB5-4A0E-B6E5-D891A000ADAC">deviceSpecifier</a></span></code></span></td>
                              <td align="left" valign="top" width="73%" headers="d11611e271 d11611e266 ">
                                 <p>指定备份的存储类型。查询<a id="d11611e284" class="indexterm-anchor"></a> <code class="codeph">V$BACKUP_DEVICE</code>视图，了解有关可用设备类型和名称的信息。
                                 </p>
                                 <p><span class="bold">另请参见：</span> <span class="italic"><code class="codeph"><span class="codeinlineitalic"><a href="deviceSpecifier.html#GUID-F653748D-4AB5-4A0E-B6E5-D891A000ADAC">deviceSpecifier</a></span></code></span></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="27%" id="d11611e300" headers="d11611e263 ">
                                 <p><code class="codeph">   </code><span class="italic"><code class="codeph"><span class="codeinlineitalic"><a href="allocOperandList.html#GUID-8B6C1DAB-F27A-4DA8-BECC-5DA04F5907DA">allocOperandList</a></span></code></span></p>
                              </td>
                              <td align="left" valign="top" width="73%" headers="d11611e300 d11611e266 ">
                                 <p>指定已分配通道的控制选项。顺序I / O设备的通道参数是特定于平台的。</p>
                                 <p><span class="bold">另请参见：</span> <span class="italic"><code class="codeph"><span class="codeinlineitalic"><a href="allocOperandList.html#GUID-8B6C1DAB-F27A-4DA8-BECC-5DA04F5907DA">allocOperandList</a></span></code></span></p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-6F9887A0-1D48-4332-8E59-6FA2EFE67824__GUID-0708B0B0-F8C5-4E40-86EC-D3DDB0BF332D">例子</p>
               </div>
               <!-- class="section" -->
               <div class="example" id="GUID-6F9887A0-1D48-4332-8E59-6FA2EFE67824__GUID-D1B36944-C494-4E5B-B5AC-71BFF56A5048">
                  <p class="titleinexample">示例2-10删除备份集</p>
                  <p>假设您要通过删除所有RMAN备份来回收一组磁带。在此示例中，默认情况下仅配置磁盘通道。该示例手动分配SBT通道，从磁带中删除所有备份，然后释放通道。</p><pre class="oac_no_warn" dir="ltr">RMAN&gt;维护设备类型的分配通道;已分配通道：ORA_MAINT_SBT_TAPE_1通道ORA_MAINT_SBT_TAPE_1：SID = 135设备类型= SBT_TAPE通道ORA_MAINT_SBT_TAPE_1：Oracle Secure Backup RMAN&gt; DELETE NOPROMPT BACKUP;备份件列表BP键BS键Pc＃Cp＃状态设备类型件名------- ------- --- --- ----------- --------- ---------- 9957 9954 1 1可用SBT_TAPE 8oic41ad_1_1 9974 9972 1 1可用SBT_TAPE c-28014364-20130308-17 10024 10021 1 1可用SBT_TAPE 8qic41c3_1_1 10045 10042 1 1可用SBT_TAPE c-28014364-20130308-18 10446 10443 1 1可用SBT_TAPE 8uic47fg_1_1 10487 10482 1 1可用SBT_TAPE 90ic47ih_1_1 10488 10483 1 1可用SBT_TAPE 91ic47j1_1_1 10524 10514 1 1可用SBT_TAPE 92ic47q4_1_1 10540 10538 1 1可用SBT_TAPE c-28014364-20130308-1a删除备份片备份片句= 8oic41ad_1_1 RECID = 198 STAMP = 616695118删除备份片备份片句柄= c-28014364-20130308-17 RECID = 199 STAMP = 616695145删除备份片备份片句柄= 8qic41c3_1_1 RECID = 200 STAMP = 616695171删除备份件备用件手柄= c-28014364-20130308-18 RECID = 201 STAMP = 616695188已删除备件件备件件手柄= 8uic47fg_1_1 RECID = 204 STAMP = 616701424已删除备份件备件件句柄= 90ic47ih_1_1 RECID = 205 STAMP = 616701521已删除备件件备件件句柄= 91ic47j1_1_1 RECID = 206 STAMP = 616701538已删除备件件备件件句柄= 92ic47q4_1_1 RECID = 207 STAMP = 616701764已删除备件件备件件手柄= c-28014364-20130308-1a RECID = 208 STAMP = 616701783删除了11个对象RMAN&gt; RELEASE CHANNEL;发布频道：ORA_MAINT_SBT_TAPE_1</pre></div>
               <!-- class="example" -->
               <div class="example" id="GUID-6F9887A0-1D48-4332-8E59-6FA2EFE67824__CHDGBFJH">
                  <p class="titleinexample">示例2-11交叉检查多个设备上的备份</p>
                  <p>假设您要交叉检查磁盘和磁带上的归档重做日志文件的备份。假设您已将默认设备类型配置为磁盘，并且还配置了SBT通道，但您希望对磁盘和磁带使用不同的通道设置。在这种情况下，您可以使用所需的设置手动分配维护通道。</p><pre class="oac_no_warn" dir="ltr">RMAN&gt; SHOW DEFAULT DEVICE TYPE;具有db_unique_name PROD的数据库的RMAN配置参数是：配置默认设备类型到磁盘; RMAN&gt; SHOW CHANNEL;具有db_unique_name PROD的数据库的RMAN配置参数是：CONFIGURE CHANNEL DEVICE TYPE'SBT_TAPE'PARMS'SBT_LIBRARY = / usr / local / oracle / backup / lib / libobk.so，ENV =（OB_DEVICE_1 = stape1）'; RMAN&gt;为维护设备类型分配通道sbt PARMS'SBT_LIBRARY = / usr / local / oracle / backup / lib / libobk.so，ENV =（OB_DEVICE_1 = stape2）';已分配的通道：ORA_MAINT_SBT_TAPE_1通道ORA_MAINT_SBT_TAPE_1：SID = 135设备类型= SBT_TAPE通道ORA_MAINT_SBT_TAPE_1：Oracle安全备份RMAN&gt;用于维护设备类型磁盘格式的分配通道“/ disk2 /％U”;已分配的通道：ORA_MAINT_DISK_2通道ORA_MAINT_DISK_2：SID = 101设备类型= DISK完成控制文件和SPFILE自动备份09-MAR-13 RMAN&gt; CROSSCHECK BACKUP OF ARCHIVELOG ALL;交叉检查备件：发现'AVAILABLE'备件件手柄= / disk2 / 95ic69jc_1_1 RECID = 210 STAMP = 616769132交叉检查备件：发现'EXPIRED'备件件手柄= / disk2 / 96ic69jf_1_1 RECID = 211 STAMP = 616769135交叉检查2对象交叉检查备份件：发现'AVAILABLE'备件件手柄= / disk2 / 96ic69jf_1_1 RECID = 211 STAMP = 616769135交叉检查1个对象RMAN&gt; RELEASE CHANNEL;发布渠道：ORA_MAINT_SBT_TAPE_1发布渠道：ORA_MAINT_DISK_2</pre></div>
               <!-- class="example" -->
               <div class="example" id="GUID-6F9887A0-1D48-4332-8E59-6FA2EFE67824__CHDCJABF">
                  <p class="titleinexample">示例2-12 Oracle Real Application Clusters（Oracle RAC）配置中的交叉检查</p>
                  <p><a id="d11611e344" class="indexterm-anchor"></a><a id="d11611e348" class="indexterm-anchor"></a> Oracle RAC配置中的所有节点应对所有存储设备上的所有备份具有相同的访问权限，但这不是必需的。假设您要在Oracle RAC配置的两个节点上交叉检查备份，其中每个节点都可以访问磁盘备份的子集。假设所有备份都可由交叉检查中使用的至少两个节点访问。在交叉检查后，任何无法从至少一个节点访问的备份都标记为<code class="codeph">EXPIRED</code> 。
                  </p>
                  <p>下面的示例示出了到Oracle RAC实例通道连接<code class="codeph">inst1</code>和<code class="codeph">inst2</code> 。对于两个通道连接，RMAN使用为目标数据库连接输入的相同用户名和密码。
                  </p><pre class="oac_no_warn" dir="ltr">维护设备类型磁盘连接'@ inst1'的分配通道;用于维护设备类型磁盘连接的分配通道'@ inst2'; CROSSCHECK BACKUP;</pre></div>
               <!-- class="example" -->
            </div>
         </div>
      </article>
   </body>
</html>