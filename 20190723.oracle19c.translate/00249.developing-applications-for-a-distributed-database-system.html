<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="Developing applications for a distributed database system includes tasks such as managing the distribution of application data, controlling connections established by database links, maintaining referential integrity, tuning distributed queries, and handling errors in remote procedures."></meta>
      <meta name="description" content="Developing applications for a distributed database system includes tasks such as managing the distribution of application data, controlling connections established by database links, maintaining referential integrity, tuning distributed queries, and handling errors in remote procedures."></meta>
      <title>开发分布式数据库系统的应用程序</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Database Administrator’s Guide "></meta>
      <meta property="og:description" content="Developing applications for a distributed database system includes tasks such as managing the distribution of application data, controlling connections established by database links, maintaining referential integrity, tuning distributed queries, and handling errors in remote procedures."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Database Administrator’s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="database-administrators-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-03-14T11:02:35-07:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96348-04"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="managing-a-distributed-database.html" title="Previous" type="text/html"></link>
      <link rel="next" href="distributed-transactions-concepts.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database Administrator&#39;s Guide"></meta>
    <meta name="dcterms.isVersionOf" content="ADMIN"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="managing-a-distributed-database.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="distributed-transactions-concepts.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">数据库管理员指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="distributed-database-management.html" property="item" typeof="WebPage"><span property="name">分布式数据库管理</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">开发分布式数据库系统的应用程序</li>
            </ol>
            <a id="GUID-6F3F4439-F580-48E2-8D1D-D60381438653" name="GUID-6F3F4439-F580-48E2-8D1D-D60381438653"></a><a id="ADMIN030"></a>
            
            <h2 id="ADMIN-GUID-6F3F4439-F580-48E2-8D1D-D60381438653" class="sect2"><span class="enumeration_chapter">33</span>开发分布式数据库系统的应用程序</h2>
         </header>
         <div class="ind">
            <div>
               <p>为分布式数据库系统开发应用程序包括诸如管理应用程序数据的分发，控制由数据库链接建立的连接，维护参照完整性，调整分布式查询以及处理远程过程中的错误等任务。</p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="developing-applications-for-a-distributed-database-system.html#GUID-1A09E715-0487-403D-A238-DAAADF7A1C18">管理应用程序数据的分发</a><br>在分布式数据库环境中，与数据库管理员协调以确定数据的最佳位置。
                  </li>
                  <li class="ulchildlink"><a href="developing-applications-for-a-distributed-database-system.html#GUID-C9C396BA-FADA-40C1-8BE0-1FBA8B939892">控制由数据库链接建立的连接</a><br>在SQL语句或远程过程调用中引用全局对象名称时，数据库链接将代表本地用户与远程数据库中的会话建立连接。
                  </li>
                  <li class="ulchildlink"><a href="developing-applications-for-a-distributed-database-system.html#GUID-AC5C8B2C-9F68-40C2-B18D-61FF687798E4">在分布式系统中维护参照完整性</a><br>设计应用程序以检查是否有任何返回的错误消息，指示分布式更新的一部分已失败。如果检测到故障，则应在允许应用程序继续之前回滚整个事务。
                  </li>
                  <li class="ulchildlink"><a href="developing-applications-for-a-distributed-database-system.html#GUID-40CD4112-BCA0-4BF9-8EB7-313069531009">调整分布式查询</a><br>本地Oracle数据库服务器将分布式查询分解为相应数量的远程查询，然后将其发送到远程节点以供执行。远程节点执行查询并将结果发送回本地节点。然后，本地节点执行任何必要的后处理，并将结果返回给用户或应用程序。
                  </li>
                  <li class="ulchildlink"><a href="developing-applications-for-a-distributed-database-system.html#GUID-9DBAE281-2697-4104-9A42-9C5A1662F350">处理远程过程中的错误</a><br>数据库执行过程时可能会发生错误。
                  </li>
               </ul>
               <div class="infoboxnotealso" id="GUID-6F3F4439-F580-48E2-8D1D-D60381438653__GUID-01C07EE4-3086-4030-8357-7081EBAE62C9">
                  <p class="notep1">也可以看看：</p>
                  <p>有关Oracle数据库环境中的应用程序开发的更多信息，请参见<a href="../adfns/index.html" target="_blank"><span class="italic">Oracle数据库开发指</span></a></p>
               </div>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>父主题：</strong> <a href="distributed-database-management.html#GUID-43B1A794-4C8E-4CC5-BF5B-A408A50EB6FA" title="您可以管理分布式数据库环境。">分布式数据库管理</a></p>
                  </div>
               </div>
            </div>
            <a id="ADMIN12193"></a><div class="props_rev_3"><a id="GUID-1A09E715-0487-403D-A238-DAAADF7A1C18" name="GUID-1A09E715-0487-403D-A238-DAAADF7A1C18"></a><h3 id="ADMIN-GUID-1A09E715-0487-403D-A238-DAAADF7A1C18" class="sect3"><span class="enumeration_section">33.1</span>管理应用程序数据的分布</h3>
               <div>
                  <p>在分布式数据库环境中，与数据库管理员协调以确定数据的最佳位置。</p>
                  <p>需要考虑的一些问题是：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>每个位置发布的交易数量</p>
                     </li>
                     <li>
                        <p>每个节点使用的数据量（表的一部分）</p>
                     </li>
                     <li>
                        <p>网络的性能特征和可靠性</p>
                     </li>
                     <li>
                        <p>各种节点的速度，磁盘容量</p>
                     </li>
                     <li>
                        <p>节点或链接不可用时的重要性</p>
                     </li>
                     <li>
                        <p>表格之间需要参照完整性</p>
                     </li>
                  </ul>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="developing-applications-for-a-distributed-database-system.html#GUID-6F3F4439-F580-48E2-8D1D-D60381438653" title="为分布式数据库系统开发应用程序包括诸如管理应用程序数据的分发，控制由数据库链接建立的连接，维护参照完整性，调整分布式查询以及处理远程过程中的错误等任务。">为分布式数据库系统开发应用程序</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="ADMIN12194"></a><div class="props_rev_3"><a id="GUID-C9C396BA-FADA-40C1-8BE0-1FBA8B939892" name="GUID-C9C396BA-FADA-40C1-8BE0-1FBA8B939892"></a><h3 id="ADMIN-GUID-C9C396BA-FADA-40C1-8BE0-1FBA8B939892" class="sect3"><span class="enumeration_section">33.2</span>控制由数据库链接建立的连接</h3>
               <div>
                  <p>在SQL语句或远程过程调用中引用全局对象名称时，数据库链接将代表本地用户与远程数据库中的会话建立连接。</p>
                  <div class="section">
                     <p>仅当先前尚未为本地用户会话建立连接时，才会创建远程连接和会话。</p>
                     <p>建立到远程数据库的连接和会话在本地用户会话期间保持不变，除非应用程序或用户明确终止它们。请注意，当您跨数据库链接发出<code class="codeph">SELECT</code>语句时，会在撤消段上放置事务锁。要重新发布该段，您必须发出<code class="codeph">COMMIT</code>或<code class="codeph">ROLLBACK</code>语句。
                     </p>
                     <p>终止使用数据库链接建立的远程连接对于断开应用程序不再需要的高成本连接非常有用。您可以使用带有<code class="codeph">CLOSE DATABASE LINK</code>子句的<code class="codeph">ALTER SESSION</code>语句终止远程连接和会话。例如，假设您发出以下事务：</p><pre class="oac_no_warn" dir="ltr">SELECT * FROM emp @ sales;承诺;</pre><p>以下语句终止<code class="codeph">sales</code>数据库链接指向的远程数据库中的会话：</p><pre class="oac_no_warn" dir="ltr">ALTER SESSION CLOSE DATABASE LINK销售;</pre><p>要在用户会话中关闭数据库链接连接，您必须具有<code class="codeph">ALTER SESSION</code>系统特权。
                     </p>
                     <div class="infoboxnote" id="GUID-C9C396BA-FADA-40C1-8BE0-1FBA8B939892__GUID-79B171AD-5F6F-4A78-B88A-39A3B3A32CC8">
                        <p class="notep1">注意：</p>
                        <p>在关闭数据库链接之前，首先关闭所有使用该链接的游标，然后在使用该链接时结束当前事务。</p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-C9C396BA-FADA-40C1-8BE0-1FBA8B939892__GUID-51562D0D-2CE5-4623-B6E6-566476096339">
                     <p class="notep1">也可以看看：</p>
                     <p>有关<code class="codeph">ALTER SESSION</code>语句的更多信息，请<a href="../sqlrf/ALTER-SESSION.html#SQLRF00901" target="_blank"><span class="italic">参见Oracle数据库SQL语言参考</span></a></p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="developing-applications-for-a-distributed-database-system.html#GUID-6F3F4439-F580-48E2-8D1D-D60381438653" title="为分布式数据库系统开发应用程序包括诸如管理应用程序数据的分发，控制由数据库链接建立的连接，维护参照完整性，调整分布式查询以及处理远程过程中的错误等任务。">为分布式数据库系统开发应用程序</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="ADMIN12195"></a><div class="props_rev_3"><a id="GUID-AC5C8B2C-9F68-40C2-B18D-61FF687798E4" name="GUID-AC5C8B2C-9F68-40C2-B18D-61FF687798E4"></a><h3 id="ADMIN-GUID-AC5C8B2C-9F68-40C2-B18D-61FF687798E4" class="sect3"><span class="enumeration_section">33.3</span>维护分布式系统中的参照完整性</h3>
               <div>
                  <p>设计应用程序以检查是否有任何返回的错误消息，指示分布式更新的一部分已失败。如果检测到故障，则应在允许应用程序继续之前回滚整个事务。</p>
                  <p>如果分布式语句的一部分失败（例如，由于完整性约束违规），则数据库返回错误号<code class="codeph">ORA-02055</code> 。后续语句或过程调用将返回错误号<code class="codeph">ORA-02067</code>直到发出<code class="codeph">ROLLBACK</code>或<code class="codeph">ROLLBACK TO SAVEPOINT</code> 。
                  </p>
                  <p>数据库不允许跨分布式系统的节点定义声明性参照完整性约束。换句话说，一个表上的声明性引用完整性约束不能指定引用远程表的主键或唯一键的外键。但是，您可以使用触发器维护跨节点的父/子表关系。</p>
                  <p>如果您决定使用触发器跨分布式数据库的节点定义参照完整性，请注意网络故障不仅会限制父表的可访问性，还会限制子表的可访问性。例如，假设子表位于<code class="codeph">sales</code>数据库中，而父表位于<code class="codeph">hq</code>数据库中。如果两个数据库之间的网络连接失败，则针对子表的某些DML语句（将子行插入子表或更新子表中的外键值的那些语句）无法继续，因为参照完整性触发器必须能够访问父表<code class="codeph">hq</code>数据库中的表。
                  </p>
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-AC5C8B2C-9F68-40C2-B18D-61FF687798E4__GUID-3CA52F4C-5C02-476F-B030-7197C1EEE031">
                     <p class="notep1">也可以看看：</p>
                     <p>有关使用触发器强制引用完整性的更多信息，请<a href="../lnpls/plsql-triggers.html#LNPLS020" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="developing-applications-for-a-distributed-database-system.html#GUID-6F3F4439-F580-48E2-8D1D-D60381438653" title="为分布式数据库系统开发应用程序包括诸如管理应用程序数据的分发，控制由数据库链接建立的连接，维护参照完整性，调整分布式查询以及处理远程过程中的错误等任务。">为分布式数据库系统开发应用程序</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="ADMIN12196"></a><div class="props_rev_3"><a id="GUID-40CD4112-BCA0-4BF9-8EB7-313069531009" name="GUID-40CD4112-BCA0-4BF9-8EB7-313069531009"></a><h3 id="ADMIN-GUID-40CD4112-BCA0-4BF9-8EB7-313069531009" class="sect3"><span class="enumeration_section">33.4</span>调整分布式查询</h3>
               <div>
                  <p>本地Oracle数据库服务器将分布式查询分解为相应数量的远程查询，然后将其发送到远程节点以供执行。远程节点执行查询并将结果发送回本地节点。然后，本地节点执行任何必要的后处理，并将结果返回给用户或应用程序。</p>
                  <div class="infoboxnote" id="GUID-40CD4112-BCA0-4BF9-8EB7-313069531009__GUID-01D07C38-92B6-4100-915F-E43FAE28643E">
                     <p class="notep1">注意：</p>如果查询引用具有数据库链接的远程表，则SQL管理对象（如SQL配置文件，SQL计划基准和SQL修补程序以及存储的大纲）可能无法始终按预期工作。例如，对于SQL计划管理，当Oracle对查询使用SQL计划基准时，远程执行的查询部分可能使用与创建SQL计划基准时不同的计划。
                  </div>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="developing-applications-for-a-distributed-database-system.html#GUID-BE4D1049-BB3B-4F5F-BB2C-4CC0CD9407E7">使用并置的内联视图</a><br>优化分布式查询的最有效方法是尽可能少地访问远程数据库并仅检索所需的数据。
                     </li>
                     <li class="ulchildlink"><a href="developing-applications-for-a-distributed-database-system.html#GUID-743A1A29-3AA5-424B-A844-BF088EE2383B">使用基于成本的优化</a><br>使用基于成本的优化包括完成诸如重写查询和设置基于成本的优化之类的任务。
                     </li>
                     <li class="ulchildlink"><a href="developing-applications-for-a-distributed-database-system.html#GUID-4EEFC86C-EE7C-442B-AD5C-784CE064E5C4">使用提示</a><br>提示可以扩展基于成本的优化的能力。
                     </li>
                     <li class="ulchildlink"><a href="developing-applications-for-a-distributed-database-system.html#GUID-7E7B2C97-BAEB-4722-8430-B84923C14DD4">分析执行计划</a><br>调优分布式查询的一个重要方面是分析执行计划。
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="developing-applications-for-a-distributed-database-system.html#GUID-6F3F4439-F580-48E2-8D1D-D60381438653" title="为分布式数据库系统开发应用程序包括诸如管理应用程序数据的分发，控制由数据库链接建立的连接，维护参照完整性，调整分布式查询以及处理远程过程中的错误等任务。">为分布式数据库系统开发应用程序</a></p>
                     </div>
                  </div>
               </div>
               <a id="ADMIN12197"></a><div class="props_rev_3"><a id="GUID-BE4D1049-BB3B-4F5F-BB2C-4CC0CD9407E7" name="GUID-BE4D1049-BB3B-4F5F-BB2C-4CC0CD9407E7"></a><h4 id="ADMIN-GUID-BE4D1049-BB3B-4F5F-BB2C-4CC0CD9407E7" class="sect4"><span class="enumeration_section">33.4.1</span>使用并置的内联视图</h4>
                  <div>
                     <p>优化分布式查询的最有效方法是尽可能少地访问远程数据库并仅检索所需的数据。</p>
                     <p>例如，假设您在分布式查询中引用来自两个不同远程数据库的五个远程表，并且具有复杂的过滤器（例如， <code class="codeph">WHERE</code> <code class="codeph">r1.salary</code> + <code class="codeph">r2.salary</code> &gt; <code class="codeph">50000</code> ）。您可以通过重写查询以访问远程数据库一次并在远程站点应用筛选器来提高查询性能。此重写导致较少的数据传输到查询执行站点。
                     </p>
                     <p>通过使用并置的内联视图来重写您的查询以访问远程数据库一次。需要定义以下术语：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><span class="bold">并置</span> 
                           </p>
                           <p>两个或多个表位于同一数据库中。</p>
                        </li>
                        <li>
                           <p><span class="bold">内联视图</span> 
                           </p>
                           <p>一个<code class="codeph">SELECT</code>是在父置换为表语句<code class="codeph">SELECT</code>语句。括号中显示的嵌入式<code class="codeph">SELECT</code>语句是内联视图的示例：</p><pre class="oac_no_warn" dir="ltr"><code class="codeph">SELECT e.empno,e.ename,d.deptno,d.dname</code> <code class="codeph">FROM (SELECT empno, ename from</code> <code class="codeph">emp@orc1.world) e, dept d;</code>
</pre></li>
                        <li>
                           <p><span class="bold">并置内联视图</span> 
                           </p>
                           <p>内联视图，仅从单个数据库中选择多个表中的数据。它减少了访问远程数据库的次数，从而提高了分布式查询的性能。</p>
                        </li>
                     </ul>
                     <p>Oracle建议您使用并置的内联视图来形成分布式查询，以提高分布式查询的性能。Oracle数据库基于成本的优化可以透明地重写您的许多分布式查询，以利用并置内联视图提供的性能提升。</p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="developing-applications-for-a-distributed-database-system.html#GUID-40CD4112-BCA0-4BF9-8EB7-313069531009" title="本地Oracle数据库服务器将分布式查询分解为相应数量的远程查询，然后将其发送到远程节点以供执行。远程节点执行查询并将结果发送回本地节点。然后，本地节点执行任何必要的后处理，并将结果返回给用户或应用程序。">调整分布式查询</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-743A1A29-3AA5-424B-A844-BF088EE2383B" name="GUID-743A1A29-3AA5-424B-A844-BF088EE2383B"></a><h4 id="ADMIN-GUID-743A1A29-3AA5-424B-A844-BF088EE2383B" class="sect4"><span class="enumeration_section">33.4.2</span>使用基于成本的优化</h4>
                  <p>使用基于成本的优化包括完成诸如重写查询和设置基于成本的优化之类的任务。</p>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="developing-applications-for-a-distributed-database-system.html#GUID-30B9D31C-EBE8-4215-86A4-164AF4172611">基于成本的优化如何运作？</a><br>优化的主要任务是重写分布式查询以使用并置的内联视图。
                        </li>
                        <li class="ulchildlink"><a href="developing-applications-for-a-distributed-database-system.html#GUID-797A67C0-0836-4244-9826-FBE4A95EFA1C">重写基于成本优化的查询</a><br>除了使用并置的内联视图重写查询之外，基于成本的优化方法还根据所引用表的收集统计信息和优化程序执行的计算来优化分布式查询。
                        </li>
                        <li class="ulchildlink"><a href="developing-applications-for-a-distributed-database-system.html#GUID-D64F886A-7C62-4E23-A24D-FC529B227D77">设置基于成本的优化</a><br>在将系统设置为使用基于成本的优化来提高分布式查询的性能之后，该操作对用户是透明的。换句话说，优化在发出查询时自动发生。
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="developing-applications-for-a-distributed-database-system.html#GUID-40CD4112-BCA0-4BF9-8EB7-313069531009" title="本地Oracle数据库服务器将分布式查询分解为相应数量的远程查询，然后将其发送到远程节点以供执行。远程节点执行查询并将结果发送回本地节点。然后，本地节点执行任何必要的后处理，并将结果返回给用户或应用程序。">调整分布式查询</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="ADMIN12199"></a><div class="props_rev_3"><a id="GUID-30B9D31C-EBE8-4215-86A4-164AF4172611" name="GUID-30B9D31C-EBE8-4215-86A4-164AF4172611"></a><h5 id="ADMIN-GUID-30B9D31C-EBE8-4215-86A4-164AF4172611" class="sect5"><span class="enumeration_section">33.4.2.1</span>基于成本的优化如何工作？
                     </h5>
                     <div>
                        <p>优化的主要任务是重写分布式查询以使用并置的内联视图。</p>
                        <p>此优化分三步执行：</p>
                        <ol>
                           <li>
                              <p>合并所有可合并视图。</p>
                           </li>
                           <li>
                              <p>优化程序执行并置查询块测试。</p>
                           </li>
                           <li>
                              <p>优化程序使用并置的内联视图重写查询。</p>
                           </li>
                        </ol>
                        <p>在重写查询之后，执行该查询并将数据集返回给用户。</p>
                        <p>虽然基于成本的优化是透明地对用户执行的，但它无法提高几种分布式查询方案的性能。具体而言，如果您的分布式查询包含以下任何内容，则基于成本的优化无效：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>骨料</p>
                           </li>
                           <li>
                              <p>子查询</p>
                           </li>
                           <li>
                              <p>复杂的SQL</p>
                           </li>
                        </ul>
                        <p>如果分布式查询包含其中一个元素，请参阅<span class="q">“ <a href="developing-applications-for-a-distributed-database-system.html#GUID-9348B4FC-37A4-4C64-B75F-78B29CC6A059" title="如果语句没有充分优化，那么您可以使用提示来扩展基于成本的优化功能。具体来说，如果您编写自己的查询以使用并置的内联视图，请指示基于成本的优化程序不要重写分布式查询。">使用提示</a> ”</span>以了解如何修改查询并使用提示来提高分布式查询的性能。
                        </p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="developing-applications-for-a-distributed-database-system.html#GUID-743A1A29-3AA5-424B-A844-BF088EE2383B" title="使用基于成本的优化包括完成诸如重写查询和设置基于成本的优化之类的任务。">使用基于成本的优化</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="ADMIN12198"></a><div class="props_rev_3"><a id="GUID-797A67C0-0836-4244-9826-FBE4A95EFA1C" name="GUID-797A67C0-0836-4244-9826-FBE4A95EFA1C"></a><h5 id="ADMIN-GUID-797A67C0-0836-4244-9826-FBE4A95EFA1C" class="sect5"><span class="enumeration_section">33.4.2.2</span>重写基于成本的优化的查询</h5>
                     <div>
                        <p>除了使用并置的内联视图重写查询之外，基于成本的优化方法还根据所引用表的收集统计信息和优化程序执行的计算来优化分布式查询。</p>
                        <div class="section">
                           <p>例如，基于成本的优化分析以下查询。该示例假定表统计信息可用。请注意，它分析<code class="codeph">CREATE TABLE</code>语句中的查询：</p><pre class="oac_no_warn" dir="ltr">CREATE TABLE AS（SELECT la，lb，r1.c，r1.d，r1.e，r2.b，r2.c FROM local l，remote1 r1，remote2 r2 WHERE lc = rc AND r1.c = r2.c AND re&gt; 300）;</pre><p>并将其重写为：</p><pre class="oac_no_warn" dir="ltr">CREATE TABLE AS（SELECT la，lb，vc，vd，ve FROM（SELECT r1.c，r1.d，r1.e，r2.b，r2.c FROM remote1 r1，remote2 r2 WHERE r1.c = r2.c AND r1.e&gt; 300）v，local l WHERE lc = r1.c）;</pre><p>别名<code class="codeph">v</code>被分配给内联视图，然后可以将其作为前面<code class="codeph">SELECT</code>语句中的表引用。创建并置的内联视图可减少在远程站点执行的查询量，从而减少代价高昂的网络流量。
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="developing-applications-for-a-distributed-database-system.html#GUID-743A1A29-3AA5-424B-A844-BF088EE2383B" title="使用基于成本的优化包括完成诸如重写查询和设置基于成本的优化之类的任务。">使用基于成本的优化</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="ADMIN12200"></a><div class="props_rev_3"><a id="GUID-D64F886A-7C62-4E23-A24D-FC529B227D77" name="GUID-D64F886A-7C62-4E23-A24D-FC529B227D77"></a><h5 id="ADMIN-GUID-D64F886A-7C62-4E23-A24D-FC529B227D77" class="sect5"><span class="enumeration_section">33.4.2.3</span>设置基于成本的优化</h5>
                     <p>在将系统设置为使用基于成本的优化来提高分布式查询的性能之后，该操作对用户是透明的。换句话说，优化在发出查询时自动发生。</p>
                     <div>
                        <ul class="ullinks">
                           <li class="ulchildlink"><a href="developing-applications-for-a-distributed-database-system.html#GUID-E6CA00F6-20F5-4210-9DC0-35A61BB453C3">设置环境</a><br>设置<code class="codeph">OPTIMIZER_MODE</code>初始化参数以确定为实例选择优化方法的默认行为。
                           </li>
                           <li class="ulchildlink"><a href="developing-applications-for-a-distributed-database-system.html#GUID-496D9BCE-B194-4568-9FF2-3328B2B3F9C0">分析表格</a><br>对于基于成本的优化，为分布式查询选择最有效的路径，必须为所涉及的表提供准确的统计信息。您可以使用<code class="codeph">DBMS_STATS</code>包执行此操作。
                           </li>
                        </ul>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="developing-applications-for-a-distributed-database-system.html#GUID-743A1A29-3AA5-424B-A844-BF088EE2383B" title="使用基于成本的优化包括完成诸如重写查询和设置基于成本的优化之类的任务。">使用基于成本的优化</a></p>
                           </div>
                        </div>
                     </div>
                     <a id="ADMIN12201"></a><div class="props_rev_3"><a id="GUID-E6CA00F6-20F5-4210-9DC0-35A61BB453C3" name="GUID-E6CA00F6-20F5-4210-9DC0-35A61BB453C3"></a><h6 id="ADMIN-GUID-E6CA00F6-20F5-4210-9DC0-35A61BB453C3" class="sect6"><span class="enumeration_section">33.4.2.3.1</span>设置环境</h6>
                        <div>
                           <p>设置<code class="codeph">OPTIMIZER_MODE</code>初始化参数以确定为实例选择优化方法的默认行为。
                           </p>
                           <div class="section">
                              <p>您可以通过以下方式设置此参数</p>
                           </div>
                           <!-- class="section" -->
                           <div class="section">
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>修改初始化参数文件中的<code class="codeph">OPTIMIZER_MODE</code>参数</p>
                                 </li>
                                 <li>
                                    <p>通过发出<code class="codeph">ALTER SESSION</code>语句在会话级别设置它</p>
                                 </li>
                              </ul>
                           </div>
                           <!-- class="section" -->
                        </div>
                        <div>
                           <div class="infoboxnotealso" id="GUID-E6CA00F6-20F5-4210-9DC0-35A61BB453C3__GUID-ED0F4E2E-FF7F-4A9F-857C-FA27449A74AE">
                              <p class="notep1">也可以看看：</p>
                              <p><a href="../tgsql/query-optimizer-concepts.html#TGSQL193" target="_blank"><span class="italic">“Oracle数据库SQL调优指南”</span></a> ，了解有关在参数文件中设置<code class="codeph">OPTIMIZER_MODE</code>初始化参数以及如何配置系统以使用基于成本的优化方法的信息</p>
                           </div>
                           <div class="familylinks">
                              <div class="parentlink">
                                 <p><strong>父主题：</strong> <a href="developing-applications-for-a-distributed-database-system.html#GUID-D64F886A-7C62-4E23-A24D-FC529B227D77" title="在将系统设置为使用基于成本的优化来提高分布式查询的性能之后，该操作对用户是透明的。换句话说，优化在发出查询时自动发生。">设置基于成本的优化</a></p>
                              </div>
                           </div>
                        </div>
                        
                     </div><a id="ADMIN12202"></a><div class="props_rev_3"><a id="GUID-496D9BCE-B194-4568-9FF2-3328B2B3F9C0" name="GUID-496D9BCE-B194-4568-9FF2-3328B2B3F9C0"></a><h6 id="ADMIN-GUID-496D9BCE-B194-4568-9FF2-3328B2B3F9C0" class="sect6"><span class="enumeration_section">33.4.2.3.2</span>分析表</h6>
                        <div>
                           <p>对于基于成本的优化，为分布式查询选择最有效的路径，必须为所涉及的表提供准确的统计信息。您可以使用<code class="codeph">DBMS_STATS</code>包执行此操作。
                           </p>
                           <div class="section">
                              <div class="infoboxnote" id="GUID-496D9BCE-B194-4568-9FF2-3328B2B3F9C0__GUID-B1E3F725-37FF-4D46-ABED-2DAC19784272">
                                 <p class="notep1">注意：</p>
                                 <p>执行<code class="codeph">DBMS_STATS</code>过程时，必须在本地连接表。
                                 </p>
                                 <p>您必须首先连接到远程站点，然后执行<code class="codeph">DBMS_STATS</code>过程。
                                 </p>
                              </div>
                              <p>以下<code class="codeph">DBMS_STATS</code>过程可以收集某些类的优化程序统计信息：</p>
                           </div>
                           <!-- class="section" -->
                           <div class="section">
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><code class="codeph">GATHER_INDEX_STATS</code> 
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">GATHER_TABLE_STATS</code> 
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">GATHER_SCHEMA_STATS</code> 
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">GATHER_DATABASE_STATS</code> 
                                    </p>
                                 </li>
                              </ul>
                              <p>例如，假设分布式事务通常访问<code class="codeph">scott.dept</code>表。要确保基于成本的优化程序仍在选择最佳计划，请执行以下操作：</p><pre class="oac_no_warn" dir="ltr">BEGIN DBMS_STATS.GATHER_TABLE_STATS（'scott'，'dept'）;结束;</pre></div>
                           <!-- class="section" -->
                        </div>
                        <div>
                           <div class="infoboxnotealso" id="GUID-496D9BCE-B194-4568-9FF2-3328B2B3F9C0__GUID-672CB0FF-75D6-446D-B3FE-AB5F279357E8">
                              <p class="notep1">也可以看看：</p>
                              <p></p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><a href="../tgsql/gathering-optimizer-statistics.html#TGSQL389" target="_blank"><span class="italic">“Oracle数据库SQL调优指南”</span></a> ，了解有关生成统计信息</p>
                                 </li>
                                 <li>
                                    <p>有关使用<code class="codeph">DBMS_STATS</code>程序包的其他信息，请<a href="../arpls/DBMS_STATS.html#ARPLS059" target="_blank"><span class="italic">参见Oracle Database PL / SQL程序包和类型参考</span></a></p>
                                 </li>
                              </ul>
                           </div>
                           <div class="familylinks">
                              <div class="parentlink">
                                 <p><strong>父主题：</strong> <a href="developing-applications-for-a-distributed-database-system.html#GUID-D64F886A-7C62-4E23-A24D-FC529B227D77" title="在将系统设置为使用基于成本的优化来提高分布式查询的性能之后，该操作对用户是透明的。换句话说，优化在发出查询时自动发生。">设置基于成本的优化</a></p>
                              </div>
                           </div>
                        </div>
                        
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-4EEFC86C-EE7C-442B-AD5C-784CE064E5C4" name="GUID-4EEFC86C-EE7C-442B-AD5C-784CE064E5C4"></a><h4 id="ADMIN-GUID-4EEFC86C-EE7C-442B-AD5C-784CE064E5C4" class="sect4"><span class="enumeration_section">33.4.3</span>使用提示</h4>
                  <p>提示可以扩展基于成本的优化的能力。</p>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="developing-applications-for-a-distributed-database-system.html#GUID-9348B4FC-37A4-4C64-B75F-78B29CC6A059">关于使用提示</a><br>如果语句没有充分优化，那么您可以使用提示来扩展基于成本的优化功能。具体来说，如果您编写自己的查询以使用并置的内联视图，请指示基于成本的优化程序不要重写分布式查询。
                        </li>
                        <li class="ulchildlink"><a href="developing-applications-for-a-distributed-database-system.html#GUID-8672F609-4F0D-4890-82CB-7774B13FE453">使用NO_MERGE提示</a><br><code class="codeph">NO_MERGE</code>提示可防止数据库将内联视图合并到潜在的非并置SQL语句中。
                        </li>
                        <li class="ulchildlink"><a href="developing-applications-for-a-distributed-database-system.html#GUID-70AFACF7-CB80-4ED5-A2B6-D99F3A48C7B2">使用DRIVING_SITE提示</a><br><code class="codeph">DRIVING_SITE</code>提示允许您指定执行查询的站点。
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="developing-applications-for-a-distributed-database-system.html#GUID-40CD4112-BCA0-4BF9-8EB7-313069531009" title="本地Oracle数据库服务器将分布式查询分解为相应数量的远程查询，然后将其发送到远程节点以供执行。远程节点执行查询并将结果发送回本地节点。然后，本地节点执行任何必要的后处理，并将结果返回给用户或应用程序。">调整分布式查询</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="ADMIN12203"></a><div class="props_rev_3"><a id="GUID-9348B4FC-37A4-4C64-B75F-78B29CC6A059" name="GUID-9348B4FC-37A4-4C64-B75F-78B29CC6A059"></a><h5 id="ADMIN-GUID-9348B4FC-37A4-4C64-B75F-78B29CC6A059" class="sect5"><span class="enumeration_section">33.4.3.1</span>关于使用提示</h5>
                     <div>
                        <p>如果语句没有充分优化，那么您可以使用提示来扩展基于成本的优化功能。具体来说，如果您编写自己的查询以使用并置的内联视图，请指示基于成本的优化程序不要重写分布式查询。</p>
                        <p>此外，如果您对数据库环境有特殊了解（例如统计信息，负载，网络和CPU限制，分布式查询等），则可以指定提示以指导基于成本的优化。例如，如果您使用基于您对数据库环境的了解的并置内联视图编写了自己的优化查询，请指定<code class="codeph">NO_MERGE</code>提示以防止优化程序重写您的查询。
                        </p>
                        <p>如果分布式查询包含聚合，子查询或复杂SQL，则此技术特别有用。由于优化程序无法重写此类分布式查询，因此指定<code class="codeph">NO_MERGE</code>会导致优化程序跳过<span class="q">“ <a href="developing-applications-for-a-distributed-database-system.html#GUID-30B9D31C-EBE8-4215-86A4-164AF4172611" title="The main task of optimization is to rewrite a distributed query to use collocated inline views.">基于成本的优化如何工作？</a> ”中描述的步骤<span class="q"><a href="developing-applications-for-a-distributed-database-system.html#GUID-30B9D31C-EBE8-4215-86A4-164AF4172611" title="优化的主要任务是重写分布式查询以使用并置的内联视图。">。</a>“</span> 。
                        </p>
                        <p><code class="codeph">DRIVING_SITE</code>提示允许您定义远程站点以充当查询执行站点。通过这种方式，查询在远程站点上执行，然后远程站点将数据返回到本地站点。当远程站点包含大部分数据时，此提示特别有用。
                        </p>
                     </div>
                     <div>
                        <div class="infoboxnotealso" id="GUID-9348B4FC-37A4-4C64-B75F-78B29CC6A059__GUID-A3A20E3F-66BA-44E3-A245-39559E30B331">
                           <p class="notep1">也可以看看：</p>
                           <p>有关使用提示的详细信息，请参阅<a href="../tgsql/influencing-the-optimizer.html#TGSQL259" target="_blank"><span class="italic">“Oracle数据库SQL调优指南”</span></a></p>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="developing-applications-for-a-distributed-database-system.html#GUID-4EEFC86C-EE7C-442B-AD5C-784CE064E5C4" title="提示可以扩展基于成本的优化的能力。">使用提示</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="ADMIN12204"></a><div class="props_rev_3"><a id="GUID-8672F609-4F0D-4890-82CB-7774B13FE453" name="GUID-8672F609-4F0D-4890-82CB-7774B13FE453"></a><h5 id="ADMIN-GUID-8672F609-4F0D-4890-82CB-7774B13FE453" class="sect5"><span class="enumeration_section">33.4.3.2</span>使用NO_MERGE提示</h5>
                     <div>
                        <p><code class="codeph">NO_MERGE</code>提示可防止数据库将内联视图合并到潜在的非并置SQL语句中。
                        </p>
                        <div class="section">
                           <p>此提示嵌入在<code class="codeph">SELECT</code>语句中，可以出现在<code class="codeph">SELECT</code>语句的开头，内联视图作为参数，也可以出现在定义内联视图的查询块中。
                           </p><pre class="oac_no_warn" dir="ltr">/ * with argument * / SELECT / * + NO_MERGE（v）* / t1.x，v.avg_y FROM t1，（SELECT x，AVG（y）AS avg_y FROM t2 GROUP BY x）v，WHERE t1.x = vx AND t1.y = 1; / *在查询块中* / SELECT t1.x，v.avg_y FROM t1，（SELECT / * + NO_MERGE * / x，AVG（y）AS avg_y FROM t2 GROUP BY x）v，WHERE t1.x = vx AND t1 .y = 1;</pre><p>通常，在根据您对数据库环境的了解开发优化查询时，可以使用此提示。</p>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>相关话题</strong></p>
                           <ul>
                              <li><a href="developing-applications-for-a-distributed-database-system.html#GUID-4EEFC86C-EE7C-442B-AD5C-784CE064E5C4" title="提示可以扩展基于成本的优化的能力。">使用提示</a></li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="developing-applications-for-a-distributed-database-system.html#GUID-4EEFC86C-EE7C-442B-AD5C-784CE064E5C4" title="提示可以扩展基于成本的优化的能力。">使用提示</a></p>
                           </div>
                        </div>
                     </div>
                  </div><a id="ADMIN12205"></a><div class="props_rev_3"><a id="GUID-70AFACF7-CB80-4ED5-A2B6-D99F3A48C7B2" name="GUID-70AFACF7-CB80-4ED5-A2B6-D99F3A48C7B2"></a><h5 id="ADMIN-GUID-70AFACF7-CB80-4ED5-A2B6-D99F3A48C7B2" class="sect5"><span class="enumeration_section">33.4.3.3</span>使用DRIVING_SITE提示</h5>
                     <div>
                        <p><code class="codeph">DRIVING_SITE</code>提示允许您指定执行查询的站点。
                        </p>
                        <div class="section">
                           <p>最好让基于成本的优化确定执行的执行位置，但如果您希望覆盖优化程序，则可以手动指定执行站点。</p>
                           <p>以下是带有<code class="codeph">DRIVING_SITE</code>提示的<code class="codeph">SELECT</code>语句的<code class="codeph">DRIVING_SITE</code> ：</p><pre class="oac_no_warn" dir="ltr">SELECT / * + DRIVING_SITE（dept）* / * FROM emp，dept @ remote.com WHERE emp.deptno = dept.deptno;</pre></div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>相关话题</strong></p>
                           <ul>
                              <li><a href="developing-applications-for-a-distributed-database-system.html#GUID-4EEFC86C-EE7C-442B-AD5C-784CE064E5C4" title="提示可以扩展基于成本的优化的能力。">使用提示</a></li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="developing-applications-for-a-distributed-database-system.html#GUID-4EEFC86C-EE7C-442B-AD5C-784CE064E5C4" title="提示可以扩展基于成本的优化的能力。">使用提示</a></p>
                           </div>
                        </div>
                     </div>
                  </div>
               </div><a id="ADMIN12206"></a><div class="props_rev_3"><a id="GUID-7E7B2C97-BAEB-4722-8430-B84923C14DD4" name="GUID-7E7B2C97-BAEB-4722-8430-B84923C14DD4"></a><h4 id="ADMIN-GUID-7E7B2C97-BAEB-4722-8430-B84923C14DD4" class="sect4"><span class="enumeration_section">33.4.4</span>分析执行计划</h4>
                  <div>
                     <p>调优分布式查询的一个重要方面是分析执行计划。</p>
                     <p>您从分析中收到的反馈是测试和验证数据库的重要元素。当您想要比较计划时，验证变得尤为重要。例如，将通过基于成本的优化优化的分布式查询的执行计划与使用提示，并置的内联视图和其他技术手动优化的查询的计划进行比较。</p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="developing-applications-for-a-distributed-database-system.html#GUID-7A3FB5C4-61B2-4BDA-BB20-B6A4775E1908">生成执行计划</a><br>准备好数据库以存储执行计划后，即可查看指定查询的计划。而不是直接执行SQL语句，将语句附加到<code class="codeph">EXPLAIN PLAN FOR</code>子句。
                        </li>
                        <li class="ulchildlink"><a href="developing-applications-for-a-distributed-database-system.html#GUID-69B1AE56-E818-441D-B205-FA6B6E3590EC">查看执行计划</a><br>执行上述SQL语句后，执行计划将临时存储在<code class="codeph">PLAN_TABLE</code> 。</li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-7E7B2C97-BAEB-4722-8430-B84923C14DD4__GUID-9822731C-4C2A-4BB7-BEFE-88D3F6E29283">
                        <p class="notep1">也可以看看：</p>
                        <p>有关执行计划， <code class="codeph">EXPLAIN PLAN</code>语句以及如何解释结果的详细信息，请参阅<a href="../tgsql/generating-and-displaying-execution-plans.html#TGSQL271" target="_blank"><span class="italic">“Oracle数据库SQL调优指南”</span></a></p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="developing-applications-for-a-distributed-database-system.html#GUID-40CD4112-BCA0-4BF9-8EB7-313069531009" title="本地Oracle数据库服务器将分布式查询分解为相应数量的远程查询，然后将其发送到远程节点以供执行。远程节点执行查询并将结果发送回本地节点。然后，本地节点执行任何必要的后处理，并将结果返回给用户或应用程序。">调整分布式查询</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="ADMIN12208"></a><div class="props_rev_3"><a id="GUID-7A3FB5C4-61B2-4BDA-BB20-B6A4775E1908" name="GUID-7A3FB5C4-61B2-4BDA-BB20-B6A4775E1908"></a><h5 id="ADMIN-GUID-7A3FB5C4-61B2-4BDA-BB20-B6A4775E1908" class="sect5"><span class="enumeration_section">33.4.4.1</span>生成执行计划</h5>
                     <div>
                        <p>准备好数据库以存储执行计划后，即可查看指定查询的计划。而不是直接执行SQL语句，将语句附加到<code class="codeph">EXPLAIN PLAN FOR</code>子句。
                        </p>
                        <div class="section">
                           <p>例如，您可以执行以下操作：</p><pre class="oac_no_warn" dir="ltr">EXPLAIN PLAN FOR SELECT d.dname FROM dept d WHERE d.deptno IN（SELECT deptno FROM emp@orc2.world GROUP BY deptno HAVING COUNT（deptno）&gt; 3）/</pre></div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="developing-applications-for-a-distributed-database-system.html#GUID-7E7B2C97-BAEB-4722-8430-B84923C14DD4" title="调优分布式查询的一个重要方面是分析执行计划。">分析执行计划</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="ADMIN12209"></a><div class="props_rev_3"><a id="GUID-69B1AE56-E818-441D-B205-FA6B6E3590EC" name="GUID-69B1AE56-E818-441D-B205-FA6B6E3590EC"></a><h5 id="ADMIN-GUID-69B1AE56-E818-441D-B205-FA6B6E3590EC" class="sect5"><span class="enumeration_section">33.4.4.2</span>查看执行计划</h5>
                     <div>
                        <p>执行上述SQL语句后，执行计划将临时存储在<code class="codeph">PLAN_TABLE</code> 。</p>
                        <div class="section">
                           <p>要查看执行计划的结果，请执行以下脚本：</p><pre class="oac_no_warn" dir="ltr">@ utlxpls.sql</pre><div class="infoboxnote" id="GUID-69B1AE56-E818-441D-B205-FA6B6E3590EC__GUID-A51E5E71-90E1-4156-AFA0-548F56B3E3F9">
                              <p class="notep1">注意：</p>
                              <p><code class="codeph">utlxpls.sql</code>可以在<code class="codeph">$ORACLE_HOME/rdbms/admin</code>目录中找到。
                              </p>
                           </div>
                           <p>执行<code class="codeph">utlxpls.sql</code>脚本将显示您指定的<code class="codeph">SELECT</code>语句的执行计划。结果格式如下：</p><pre class="oac_no_warn" dir="ltr">计划表------------------------------------------------ ------------------------------- |操作|名称|行|字节|成本| Pstart时| Pstop | -------------------------------------------------- ----------------------------- |选择声明| | | | | | | | NESTED LOOPS | | | | | | | |查看| | | | | | | | REMOTE | | | | | | | |按INDEX RO | DEPT |表的访问权限| | | | | | INDEX UNIQUE SCAN | PK_DEPT | | | | | | -------------------------------------------------- -----------------------------</pre><p>如果您通过编写自己的并置内联视图或使用提示来手动优化分布式查询，则最好在手动优化之前和之后生成执行计划。通过这两个执行计划，您可以比较手动优化的有效性，并根据需要进行更改，以提高分布式查询的性能。</p>
                           <p>要查看将在远程站点上执行的SQL语句，请执行以下select语句：</p><pre class="oac_no_warn" dir="ltr">从PLAN_TABLE中选择其他操作='REMOTE';</pre><p>以下是示例输出：</p><pre class="oac_no_warn" dir="ltr">SELECT DISTINCT“A1”。“DEPTNO”来自“EMP”“A1”GROUP BY“A1”。“DEPTNO”具有COUNT（“A1”。“DEPTNO”）&gt; 3</pre><div class="infoboxnote" id="GUID-69B1AE56-E818-441D-B205-FA6B6E3590EC__GUID-AB38133E-DB9E-4A9B-9E5A-43D8A413D0D1">
                              <p class="notep1">注意：</p>
                              <p>如果您在查看<code class="codeph">OTHER</code>列的全部内容时遇到困难，请执行以下SQL * Plus命令：</p><pre class="oac_no_warn" dir="ltr">SET LONG 9999999</pre></div>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="developing-applications-for-a-distributed-database-system.html#GUID-7E7B2C97-BAEB-4722-8430-B84923C14DD4" title="调优分布式查询的一个重要方面是分析执行计划。">分析执行计划</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div>
            </div><a id="ADMIN12210"></a><div class="props_rev_3"><a id="GUID-9DBAE281-2697-4104-9A42-9C5A1662F350" name="GUID-9DBAE281-2697-4104-9A42-9C5A1662F350"></a><h3 id="ADMIN-GUID-9DBAE281-2697-4104-9A42-9C5A1662F350" class="sect3"><span class="enumeration_section">33.5</span>处理远程过程中的错误</h3>
               <div>
                  <p>数据库执行过程时可能会发生错误。</p>
                  <div class="section">
                     <p>当数据库在本地或远程位置执行过程时，可能会发生四种类型的异常：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type:disc">
                        <li>
                           <p>PL / SQL用户定义的异常，必须使用关键字<code class="codeph">EXCEPTION</code>声明</p>
                        </li>
                        <li>
                           <p>PL / SQL预定义的异常，例如<code class="codeph">NO_DATA_FOUND</code>关键字</p>
                        </li>
                        <li>
                           <p>SQL错误，如<code class="codeph">ORA-00900</code>和<code class="codeph">ORA-02015</code></p>
                        </li>
                        <li>
                           <p>使用<code class="codeph">RAISE_APPLICATION_ERROR</code> （）过程生成的应用程序异常</p>
                        </li>
                     </ul>
                     <p>使用本地过程时，可以通过编写异常处理程序来捕获这些消息，如下所示</p><pre class="oac_no_warn" dir="ltr">开始 ...ZERO_DIVIDE THEN / * ...处理例外* / END时的异常;</pre><p>请注意， <code class="codeph">WHEN</code>子句需要一个异常名称。如果异常没有名称（例如，使用<code class="codeph">RAISE_APPLICATION_ERROR</code>生成的异常），则可以使用<code class="codeph">PRAGMA_EXCEPTION_INIT</code>分配一个。例如：</p><pre class="oac_no_warn" dir="ltr">DECLARE null_salary EXCEPTION; PRAGMA EXCEPTION_INIT（null_salary，-20101）;开始 ...RAISE_APPLICATION_ERROR（-20101，'工资缺失'）; ...null_salary那么例外......结束;</pre><p>调用远程过程时，异常可以由本地过程中的异常处理程序处理。远程过程必须向本地调用过程返回一个错误号，然后该过程处理异常，如上例所示。请注意，PL / SQL用户定义的异常始终将<code class="codeph">ORA-06510</code>返回到本地过程。
                     </p>
                     <p>因此，不可能基于错误号区分两个不同的用户定义的异常。可以使用与本地异常相同的方式处理所有其他远程异常。</p>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-9DBAE281-2697-4104-9A42-9C5A1662F350__GUID-E8E2169C-EBBB-4B44-B1AF-72052522B3F7">
                     <p class="notep1">也可以看看：</p>
                     <p>有关PL / SQL过程的更多信息，请<a href="../lnpls/plsql-subprograms.html#LNPLS008" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="developing-applications-for-a-distributed-database-system.html#GUID-6F3F4439-F580-48E2-8D1D-D60381438653" title="为分布式数据库系统开发应用程序包括诸如管理应用程序数据的分发，控制由数据库链接建立的连接，维护参照完整性，调整分布式查询以及处理远程过程中的错误等任务。">为分布式数据库系统开发应用程序</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
         </div>
      </article>
   </body>
</html>