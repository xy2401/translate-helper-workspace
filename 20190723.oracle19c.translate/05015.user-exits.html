<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>User Exits</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Programmer's Guide">
      <meta property="og:description" content>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Programmer's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="c-c-programmers-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-01-11T03:52:01-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96467-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="the-Object-type.html" title="Previous" type="text/html">
      <link rel="next" href="appendixes.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Pro*C/C++ Programmer's Guide">
    <meta name="dcterms.isVersionOf" content="LNPCC">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="the-Object-type.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="appendixes.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Programmer's Guide</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="applications.html" property="item" typeof="WebPage"><span property="name"> Applications </span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem"> User Exits</li>
            </ol>
            <a id="GUID-2EC87842-41F9-4923-80D3-C89201CD39AD" name="GUID-2EC87842-41F9-4923-80D3-C89201CD39AD"></a><a id="LNPCC4492"></a>
            
            <h2 id="LNPCC-GUID-2EC87842-41F9-4923-80D3-C89201CD39AD" class="sect2"><span class="enumeration_chapter">20 </span> User Exits
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>This chapter focuses on writing user exits for your Oracle Tools applications. You learn how C subroutines can do certain jobs more quickly and easily than SQL*Forms and Oracle Forms. This chapter contains the following topics: </p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p><a href="user-exits.html#GUID-01BF752C-0920-4AB2-97E0-9AEEE3072600">What Is a User Exit?</a></p>
                  </li>
                  <li>
                     <p><a href="user-exits.html#GUID-658BCDA9-34A4-456F-BB17-150F505AE7D3">Why Write a User Exit?</a></p>
                  </li>
                  <li>
                     <p><a href="user-exits.html#GUID-1ED375CA-206E-4450-9619-7B4DD1A7257C">About Developing a User Exit</a></p>
                  </li>
                  <li>
                     <p><a href="user-exits.html#GUID-86EAB22E-A8CE-4791-AE4F-FC348B444BEB">About Writing a User Exit</a></p>
                  </li>
                  <li>
                     <p><a href="user-exits.html#GUID-23C28BBA-AC3F-4462-8073-A91B49567CCA">EXEC TOOLS Statements </a> 
                     </p>
                  </li>
                  <li>
                     <p><a href="user-exits.html#GUID-C2458504-6AE7-40A0-AEF9-FF8B4E852CFB">About Calling a User Exit</a></p>
                  </li>
                  <li>
                     <p><a href="user-exits.html#GUID-C7428D0F-610A-45B9-B6BF-402BB4659A5A">About Passing Parameters to a User Exit</a></p>
                  </li>
                  <li>
                     <p><a href="user-exits.html#GUID-188EE5CE-C30C-4A9F-9117-7527447C4161">About Returning Values to a Form</a></p>
                  </li>
                  <li>
                     <p><a href="user-exits.html#GUID-0B8CC6FE-384B-4272-A0B8-63594E3D0D5D">An Example of Using User Exits</a></p>
                  </li>
                  <li>
                     <p><a href="user-exits.html#GUID-2E8FDA40-3EF3-400C-B6CA-E206DDB8C377">About Precompiling and Compiling a User Exit</a></p>
                  </li>
                  <li>
                     <p><a href="user-exits.html#GUID-C2AA12E6-ACE0-40BA-A668-620E075A4EA3">Example Program: A User Exit</a></p>
                  </li>
                  <li>
                     <p><a href="user-exits.html#GUID-E33F55DB-E663-44DB-A526-B29A3D56746B">About Using the GENXTB Utility</a></p>
                  </li>
                  <li>
                     <p><a href="user-exits.html#GUID-8A1DC311-712E-4181-A3A7-230DB139EFEA">About Linking a User Exit into SQL*Forms</a></p>
                  </li>
                  <li>
                     <p><a href="user-exits.html#GUID-6C3CEBC0-BFC0-4AF0-9C08-9DF529FCE5E2">Guidelines</a></p>
                  </li>
               </ul>
               <p>This chapter is supplemental. For more information about user exits, refer to the <span class="italic">SQL*Forms Designer's Reference</span>, the <span class="italic">Oracle Forms Reference Manual, Vol. 2</span>, and your system-specific Oracle documentation. <a id="d106100e103" class="indexterm-anchor"></a></p>
            </div><a id="LNPCC4493"></a><div class="props_rev_3"><a id="GUID-01BF752C-0920-4AB2-97E0-9AEEE3072600" name="GUID-01BF752C-0920-4AB2-97E0-9AEEE3072600"></a><h3 id="LNPCC-GUID-01BF752C-0920-4AB2-97E0-9AEEE3072600" class="sect3"><span class="enumeration_section">20.1 </span>What Is a User Exit?
               </h3>
               <div>
                  <p>A <span class="italic">user exit</span> is a C subroutine written by you and called by Oracle Forms to do special-purpose processing. You can embed SQL statements and PL/SQL blocks in your user exit, then precompile it as you would a host program. 
                  </p>
                  <p>When called by an Oracle Forms V3 trigger, the user exit runs, then returns a status code to Oracle Forms. Your exit can display messages on the Oracle Forms status line, get and set field values, do high-speed computations and table lookups, and manipulate Oracle data. </p>
               </div>
            </div><a id="LNPCC4494"></a><div class="props_rev_3"><a id="GUID-658BCDA9-34A4-456F-BB17-150F505AE7D3" name="GUID-658BCDA9-34A4-456F-BB17-150F505AE7D3"></a><h3 id="LNPCC-GUID-658BCDA9-34A4-456F-BB17-150F505AE7D3" class="sect3"><span class="enumeration_section">20.2 </span>Why Write a User Exit?
               </h3>
               <div>
                  <p>SQL*Forms provides the ability to use PL/SQL blocks in triggers. So, in most cases, instead of calling a user exit, you can use the procedural power of PL/SQL. If the need arises, you can call user exits from a PL/SQL block with the USER_EXIT function. User exits are harder to write and implement than SQL, PL/SQL, or SQL*Forms commands. So, you will probably use them only to do processing that is beyond the scope of SQL, PL/SQL, and SQL*Forms. Some common uses follow:<a id="d106100e158" class="indexterm-anchor"></a> 
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Operations more quickly or easily done in a third generation languages like C (numerical integration, for instance) </p>
                     </li>
                     <li>
                        <p>Controlling real time devices or processes (issuing a sequence of instructions to a printer or graphics device, for example) </p>
                     </li>
                     <li>
                        <p>Data manipulations that need extended procedural capabilities (recursive sorting, for example) </p>
                     </li>
                     <li>
                        <p>Special file I/O operations </p>
                     </li>
                  </ul>
               </div>
            </div><a id="LNPCC4495"></a><div class="props_rev_3"><a id="GUID-1ED375CA-206E-4450-9619-7B4DD1A7257C" name="GUID-1ED375CA-206E-4450-9619-7B4DD1A7257C"></a><h3 id="LNPCC-GUID-1ED375CA-206E-4450-9619-7B4DD1A7257C" class="sect3"><span class="enumeration_section">20.3 </span>About Developing a User Exit
               </h3>
               <div>
                  <p>This section outlines the way to develop a SQL*Forms user exit; later sections go into more detail. </p>
                  <p>To incorporate a user exit into a form, you take the following steps: </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Write the user exit in Pro*C. </p>
                     </li>
                     <li>
                        <p>Precompile the source code. </p>
                     </li>
                     <li>
                        <p>Compile the. c file from step 2. </p>
                     </li>
                     <li>
                        <p>Use the GENXTB utility to create a database table, IAPXTB. </p>
                     </li>
                     <li>
                        <p>Use the GENXTB form in SQL*Forms to insert your user exit information into the table. </p>
                     </li>
                     <li>
                        <p>Use the GENXTB utility to read the information from the table and create an IAPXIT source code module. Then compile the source code module.</p>
                     </li>
                     <li>
                        <p>Create a new SQL*Forms executable by linking the standard SQL*Forms modules, your user exit object, and the IAPXIT object created in step 6. </p>
                     </li>
                     <li>
                        <p>In the form, define a trigger to call the user exit. </p>
                     </li>
                     <li>
                        <p>Instruct operators to use the new IAP when running the form. This is unnecessary if the new IAP replaces the standard one. For details, see the Oracle installation or user's guide for your system. </p>
                     </li>
                  </ul>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="user-exits.html#GUID-23C28BBA-AC3F-4462-8073-A91B49567CCA">EXEC TOOLS Statements</a></li>
                     </ul>
                  </div>
               </div>
               
            </div><a id="LNPCC4496"></a><div class="props_rev_3"><a id="GUID-86EAB22E-A8CE-4791-AE4F-FC348B444BEB" name="GUID-86EAB22E-A8CE-4791-AE4F-FC348B444BEB"></a><h3 id="LNPCC-GUID-86EAB22E-A8CE-4791-AE4F-FC348B444BEB" class="sect3"><span class="enumeration_section">20.4 </span>About Writing a User Exit
               </h3>
               <div>
                  <p>You can use the following kinds of statements to write your SQL*Forms user exit:<a id="d106100e264" class="indexterm-anchor"></a> 
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>C code</p>
                     </li>
                     <li>
                        <p>EXEC SQL </p>
                     </li>
                     <li>
                        <p>EXEC ORACLE </p>
                     </li>
                     <li>
                        <p>EXEC TOOLS</p>
                     </li>
                  </ul>
                  <p>This section focuses on the EXEC TOOLS statements, which let you pass values between SQL*Forms and a user exit.</p>
               </div><a id="LNPCC4497"></a><div class="props_rev_3"><a id="GUID-2B2F5780-7471-4F69-96D7-17ACC0392216" name="GUID-2B2F5780-7471-4F69-96D7-17ACC0392216"></a><h4 id="LNPCC-GUID-2B2F5780-7471-4F69-96D7-17ACC0392216" class="sect4"><span class="enumeration_section">20.4.1 </span>Requirements for Variables
                  </h4>
                  <div>
                     <p>The variables used in EXEC TOOLS statements must correspond to field names used in the form definition.  <a id="d106100e308" class="indexterm-anchor"></a><a id="d106100e312" class="indexterm-anchor"></a><a id="d106100e316" class="indexterm-anchor"></a></p>
                  </div>
               </div>
            </div><a id="LNPCC4498"></a><div class="props_rev_3"><a id="GUID-23C28BBA-AC3F-4462-8073-A91B49567CCA" name="GUID-23C28BBA-AC3F-4462-8073-A91B49567CCA"></a><h3 id="LNPCC-GUID-23C28BBA-AC3F-4462-8073-A91B49567CCA" class="sect3"><span class="enumeration_section">20.5 </span>EXEC TOOLS Statements 
               </h3>
               <div>
                  <p>EXEC TOOLS statements support the basic Oracle Toolset by providing a generic way to handle get, set, and exception callbacks from user exits. The following discussion focuses on Oracle Forms but the same concepts apply to Oracle Report. </p>
               </div><a id="LNPCC4499"></a><div class="props_rev_3"><a id="GUID-770C05B5-2E78-4AC8-9DBD-F8578FFC5B13" name="GUID-770C05B5-2E78-4AC8-9DBD-F8578FFC5B13"></a><h4 id="LNPCC-GUID-770C05B5-2E78-4AC8-9DBD-F8578FFC5B13" class="sect4"><span class="enumeration_section">20.5.1 </span>About Writing a Toolset User Exit
                  </h4>
                  <div>
                     <p>Besides EXEC SQL, EXEC ORACLE, and host language statements, you can use the following EXEC TOOLS statements to write an Oracle Forms user exit: </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>SET </p>
                        </li>
                        <li>
                           <p>GET </p>
                        </li>
                        <li>
                           <p>SET CONTEXT </p>
                        </li>
                        <li>
                           <p>GET CONTEXT </p>
                        </li>
                        <li>
                           <p>MESSAGE </p>
                        </li>
                     </ul>
                     <p>The EXEC TOOLS GET and SET statements replace the EXEC IAF GET and PUT statements used with earlier versions of Oracle Forms. Unlike IAF GET and PUT, however, TOOLS GET and SET accept indicator variables. The EXEC TOOLS MESSAGE statement replaces the message-handling function <span class="italic">sqliem</span>. Now, let us take a brief look at all the EXEC TOOLS statements. For more information, see the <span class="italic">Oracle Forms Reference Manual, Vol 2</span>. 
                     </p>
                  </div>
               </div><a id="LNPCC4500"></a><div class="props_rev_3"><a id="GUID-6E8B5604-F836-4D0C-AC72-7FE38384B199" name="GUID-6E8B5604-F836-4D0C-AC72-7FE38384B199"></a><h4 id="LNPCC-GUID-6E8B5604-F836-4D0C-AC72-7FE38384B199" class="sect4"><span class="enumeration_section">20.5.2 </span>EXEC TOOLS SET 
                  </h4>
                  <div>
                     <div class="section">
                        <p>The EXEC TOOLS SET statement passes values from a user exit to Oracle Forms. Specifically, it assigns the values of host variables and constants to Oracle Forms variables and items. Values passed to form items display after the user exit returns control to the form. To code the EXEC TOOLS SET statement, you use the syntax </p><pre class="oac_no_warn" dir="ltr">EXEC TOOLS SET form_variable[, ...] 
     VALUES ({:host_variable :indicator | constant}[, ...]); 
</pre><p>where <span class="italic">form_variable</span> is an Oracle Forms field, block.field, system variable, or global variable, or a host variable (prefixed with a colon) containing the value of one of the foregoing items. In the following example, a user exit passes an employee name to Oracle Forms:
                        </p><pre class="oac_no_warn" dir="ltr">char ename[20];
short ename_ind;

...

    strcpy(ename, "MILLER");
    ename_ind = 0;
    EXEC TOOLS SET emp.ename VALUES (:ename :ename_ind);
</pre><p>In this example, <span class="italic">emp.ename</span> is an Oracle Forms block.field.
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="LNPCC4501"></a><div class="props_rev_3"><a id="GUID-51F78FF5-AE25-4B3D-9BEA-72F772CE3BD5" name="GUID-51F78FF5-AE25-4B3D-9BEA-72F772CE3BD5"></a><h4 id="LNPCC-GUID-51F78FF5-AE25-4B3D-9BEA-72F772CE3BD5" class="sect4"><span class="enumeration_section">20.5.3 </span>EXEC TOOLS GET 
                  </h4>
                  <div>
                     <div class="section">
                        <p>The EXEC TOOLS GET statement passes values from Oracle Forms to a user exit. Specifically, it assigns the values of Oracle Forms variables and items to host variables. As soon as the values are passed, the user exit can use them for any purpose. To code the EXEC TOOLS GET statement, you use the syntax </p><pre class="oac_no_warn" dir="ltr">EXEC TOOLS GET form_variable[, ...] 
    INTO :host_variable:indicator[, ...]; 
</pre><p>where <span class="italic">form_variable</span> is an Oracle Forms field, block.field, system variable, or global variable, or a host variable (prefixed with a colon) containing the value of one of the foregoing items. In the following example, Oracle Forms passes an item name from a block to your user exit: 
                        </p><pre class="oac_no_warn" dir="ltr">...
char     name_buff[20];
VARCHAR  name_fld[20];
 
strcpy(name_fld.arr, "EMP.NAME");
name_fld.len = strlen(name_fld.arr);
EXEC TOOLS GET :name_fld INTO :name_buff;</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="LNPCC4502"></a><div class="props_rev_3"><a id="GUID-31E04BDE-C256-42C8-8AE1-E36B557C72DC" name="GUID-31E04BDE-C256-42C8-8AE1-E36B557C72DC"></a><h4 id="LNPCC-GUID-31E04BDE-C256-42C8-8AE1-E36B557C72DC" class="sect4"><span class="enumeration_section">20.5.4 </span>EXEC TOOLS SET CONTEXT 
                  </h4>
                  <div>
                     <div class="section">
                        <p>The EXEC TOOLS SET CONTEXT statement saves context information from a user exit for later use in another user exit. A pointer variable points to a block of memory in which the context information is stored. With SET CONTEXT, you need not declare a global variable to hold the information. To code the EXEC TOOLS SET CONTEXT statement, you use the syntax </p><pre class="oac_no_warn" dir="ltr">EXEC TOOLS SET CONTEXT :host_pointer_variable 
    IDENTIFIED BY context_name; 
</pre><p>where <span class="italic">context_name</span> is an undeclared identifier or a character host variable (prefixed with a colon) that names the context area.
                        </p><pre class="oac_no_warn" dir="ltr">... 
char  *context_ptr; 
char  context[20]; 
 
strcpy(context, "context1") 
EXEC TOOLS SET CONTEXT :context IDENTIFIED BY application1; </pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="LNPCC4503"></a><div class="props_rev_3"><a id="GUID-E3AD6E64-0B21-4D77-BE47-877E10F43579" name="GUID-E3AD6E64-0B21-4D77-BE47-877E10F43579"></a><h4 id="LNPCC-GUID-E3AD6E64-0B21-4D77-BE47-877E10F43579" class="sect4"><span class="enumeration_section">20.5.5 </span>EXEC TOOLS GET CONTEXT 
                  </h4>
                  <div>
                     <div class="section">
                        <p>The EXEC TOOLS GET CONTEXT statement retrieves context information (saved earlier by SET CONTEXT) into a user exit. A host-language pointer variable points to a block of memory in which the context information is stored. To code the EXEC TOOLS GET CONTEXT statement, you use the syntax </p><pre class="oac_no_warn" dir="ltr">EXEC TOOLS GET CONTEXT context_name 
    INTO :host_pointer_variable; 
</pre><p>where <span class="italic">context_name</span> is an undeclared identifier or a character host variable (prefixed with a colon) that names the context area. In the following example, your user exit retrieves context information 1saved earlier: 
                        </p><pre class="oac_no_warn" dir="ltr">... 
char  *context_ptr; 
 
EXEC TOOLS GET CONTEXT application1 INTO :context_ptr;  </pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="LNPCC4504"></a><div class="props_rev_3"><a id="GUID-A26BBFE5-6C31-4552-82B7-0784D6503530" name="GUID-A26BBFE5-6C31-4552-82B7-0784D6503530"></a><h4 id="LNPCC-GUID-A26BBFE5-6C31-4552-82B7-0784D6503530" class="sect4"><span class="enumeration_section">20.5.6 </span>EXEC TOOLS MESSAGE 
                  </h4>
                  <div>
                     <div class="section">
                        <p>The EXEC TOOLS MESSAGE statement passes a message from a user exit to Oracle Forms. The message is displayed on the Oracle Forms message line after the user exit returns control to the form. To code the EXEC TOOLS MESSAGE statement, you use the syntax </p><pre class="oac_no_warn" dir="ltr">EXEC TOOLS MESSAGE message_text [severity_code]; 
</pre><p>where <span class="italic">message_text</span> is a quoted string or a character host variable (prefixed with a colon), and the optional <span class="italic">severity_code</span> is an integer constant or an integer host variable (prefixed with a colon). The MESSAGE statement does <span class="italic">not</span> accept indicator variables. In the following example, your user exit passes an error message to Oracle Forms: 
                        </p><pre class="oac_no_warn" dir="ltr">EXEC TOOLS MESSAGE 'Bad field name! Please reenter.'; </pre></div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="LNPCC4505"></a><div class="props_rev_3"><a id="GUID-C2458504-6AE7-40A0-AEF9-FF8B4E852CFB" name="GUID-C2458504-6AE7-40A0-AEF9-FF8B4E852CFB"></a><h3 id="LNPCC-GUID-C2458504-6AE7-40A0-AEF9-FF8B4E852CFB" class="sect3"><span class="enumeration_section">20.6 </span>About Calling a User Exit
               </h3>
               <div>
                  <p>You call a user exit from a SQL*Forms trigger using a packaged procedure named USER_EXIT (supplied with SQL*Forms). The syntax you use is </p><pre class="oac_no_warn" dir="ltr">USER_EXIT(user_exit_string [, error_string]); <a id="d106100e648" class="indexterm-anchor"></a> 
</pre><p>where <span class="italic">user_exit_string</span> contains the name of the user exit plus optional parameters and <span class="italic">error_string</span> contains an error message issued by SQL*Forms if the user exit fails. For example, the following trigger command calls a user exit named LOOKUP:
                  </p><pre class="oac_no_warn" dir="ltr">USER_EXIT('LOOKUP'); 
</pre><p>Notice that the user exit string is enclosed by single (not double) quotes.<code class="codeph"> </code></p>
               </div>
            </div><a id="LNPCC4506"></a><div class="props_rev_3"><a id="GUID-C7428D0F-610A-45B9-B6BF-402BB4659A5A" name="GUID-C7428D0F-610A-45B9-B6BF-402BB4659A5A"></a><h3 id="LNPCC-GUID-C7428D0F-610A-45B9-B6BF-402BB4659A5A" class="sect3"><span class="enumeration_section">20.7 </span>About Passing Parameters to a User Exit
               </h3>
               <div>
                  <p><a id="d106100e690" class="indexterm-anchor"></a>When you call a user exit, SQL*Forms passes it the following parameters automatically:
                  </p>
                  <div class="tblformal" id="GUID-C7428D0F-610A-45B9-B6BF-402BB4659A5A__GUID-72B86F3A-A997-4AF6-B642-98E735CDEDAE">
                     <table cellpadding="4" cellspacing="0" class="Formal" title summary="Passing Parameters to a User Exit" width="100%" frame="hsides" border="1" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="29%" id="d106100e703">Parameters</th>
                              <th align="left" valign="bottom" width="71%" id="d106100e706">Description</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d106100e711" headers="d106100e703 ">
                                 <p>Command Line</p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d106100e711 d106100e706 ">
                                 <p>Is the user exit string. </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d106100e718" headers="d106100e703 ">
                                 <p>Command Line Length</p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d106100e718 d106100e706 ">
                                 <p>Is the length (in characters) of the user exit string. </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d106100e725" headers="d106100e703 ">
                                 <p>Error Message</p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d106100e725 d106100e706 ">
                                 <p>Is the error string (failure message) if one is defined. </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d106100e732" headers="d106100e703 ">
                                 <p>Error Message Length</p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d106100e732 d106100e706 ">
                                 <p>Is the length of the error string. </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d106100e739" headers="d106100e703 ">
                                 <p>In-Query</p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d106100e739 d106100e706 ">
                                 <p>Is a Boolean value indicating whether the exit was called in normal or query mode. </p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <p>However, the user exit string provides the ability to pass additional parameters to the user exit. For example, the following trigger command passes two parameters and an error message to the user exit LOOKUP: </p>
                  <p>Notice that the user exit string is enclosed by single (not double) quotes. </p><pre class="oac_no_warn" dir="ltr">USER_EXIT('LOOKUP 2025 A', 'Lookup failed');
 </pre><p>You can use this feature to pass field names to the user exit, as the following example shows: </p><pre class="oac_no_warn" dir="ltr">USER_EXIT('CONCAT firstname, lastname, address');
 </pre><p>However, it is up to the user exit, not SQL*Forms, to parse the user exit string. </p>
               </div>
            </div><a id="LNPCC4507"></a><div class="props_rev_3"><a id="GUID-188EE5CE-C30C-4A9F-9117-7527447C4161" name="GUID-188EE5CE-C30C-4A9F-9117-7527447C4161"></a><h3 id="LNPCC-GUID-188EE5CE-C30C-4A9F-9117-7527447C4161" class="sect3"><span class="enumeration_section">20.8 </span>About Returning Values to a Form
               </h3>
               <div>
                  <p><a id="d106100e780" class="indexterm-anchor"></a><a id="d106100e784" class="indexterm-anchor"></a><a id="d106100e788" class="indexterm-anchor"></a>When a user exit returns control to SQL*Forms, it must also return a code indicating whether it succeeded, failed, or suffered a fatal error. The return code is an integer constant defined by SQL*Forms (see the next section). The three results have the following meanings:
                  </p>
                  <div class="tblformal" id="GUID-188EE5CE-C30C-4A9F-9117-7527447C4161__GUID-73BA651D-EC6B-4C1B-9EDE-D3C678E57D8D">
                     <table cellpadding="4" cellspacing="0" class="Formal" title summary="descriptions of possible results" width="100%" frame="hsides" border="1" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="29%" id="d106100e801">Results</th>
                              <th align="left" valign="bottom" width="71%" id="d106100e805">Meaning</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d106100e810" headers="d106100e801 ">
                                 <p>success</p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d106100e810 d106100e805 ">
                                 <p>The user exit encountered no errors. SQL*Forms proceeds to the <span class="italic">success</span> label or the next step, unless the Reverse Return Code switch is set by the calling trigger step. <a id="d106100e819" class="indexterm-anchor"></a>  
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d106100e825" headers="d106100e801 ">
                                 <p>failure</p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d106100e825 d106100e805 ">
                                 <p>The user exit detected an error, such as an invalid value in a field. An optional message passed by the exit appears on the message line at the bottom of the SQL*Forms screen and on the Display Error screen. SQL*Forms responds as it does to a SQL statement that affects no rows.<a id="d106100e831" class="indexterm-anchor"></a> 
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d106100e837" headers="d106100e801 ">
                                 <p>fatal error</p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d106100e837 d106100e805 ">
                                 <p>The user exit detected a condition that makes further processing impossible, such as an execution error in a SQL statement. An optional error message passed by the exit appears on the SQL*Forms Display Error screen. SQL*Forms responds as it does to a fatal SQL error. If a user exit changes the value of a field, then returns a <span class="italic">failure</span> or <span class="italic">fatal error</span> code, SQL*Forms does <span class="italic">not</span> discard the change. Nor does SQL*Forms discard changes when the Reverse Return Code switch is set and a <span class="italic">success</span> code is returned. 
                                 </p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
               </div><a id="LNPCC4508"></a><div class="props_rev_3"><a id="GUID-09F0FA91-FEA1-4BDF-A8E6-AE5140B38F0F" name="GUID-09F0FA91-FEA1-4BDF-A8E6-AE5140B38F0F"></a><h4 id="LNPCC-GUID-09F0FA91-FEA1-4BDF-A8E6-AE5140B38F0F" class="sect4"><span class="enumeration_section">20.8.1 </span>The IAP Constants
                  </h4>
                  <div>
                     <p>SQL*Forms defines three symbolic constants for use as return codes. Depending on the host language, they are prefixed with IAP or SQL. For example, they might be IAPSUCC, IAPFAIL, and IAPFTL.<a id="d106100e879" class="indexterm-anchor"></a> 
                     </p>
                  </div>
               </div><a id="LNPCC4509"></a><div class="props_rev_3"><a id="GUID-E058067A-7798-44E8-A3FA-A8C9B1589823" name="GUID-E058067A-7798-44E8-A3FA-A8C9B1589823"></a><h4 id="LNPCC-GUID-E058067A-7798-44E8-A3FA-A8C9B1589823" class="sect4"><span class="enumeration_section">20.8.2 </span>About Using WHENEVER
                  </h4>
                  <div>
                     <p>You can use the WHENEVER statement in an exit to detect invalid datatype conversions (SQLERROR), truncated values PUT into form fields (SQLWARNING), and queries that return no rows (NOT FOUND). <a id="d106100e908" class="indexterm-anchor"></a><a id="d106100e912" class="indexterm-anchor"></a>  
                     </p>
                  </div>
               </div>
            </div><a id="LNPCC4510"></a><div class="props_rev_3"><a id="GUID-0B8CC6FE-384B-4272-A0B8-63594E3D0D5D" name="GUID-0B8CC6FE-384B-4272-A0B8-63594E3D0D5D"></a><h3 id="LNPCC-GUID-0B8CC6FE-384B-4272-A0B8-63594E3D0D5D" class="sect3"><span class="enumeration_section">20.9 </span>An Example of Using User Exits
               </h3>
               <div>
                  <div class="section">
                     <p>The following example shows how a user exit that uses the EXEC TOOLS GET and PUT routines, as well as the <span class="italic">EXEC TOOLS MESSAGE</span> function, is coded.<a id="d106100e946" class="indexterm-anchor"></a> 
                     </p><pre class="oac_no_warn" dir="ltr">int
myexit()
{
    char field1[20], field2[20], value1[20], value2[20];
    char result_value[20];
    char errmsg[80];
    int errlen;

    #include sqlca.h
    EXEC SQL WHENEVER SQLERROR GOTO sql_error;
    /* get field values into form */
    EXEC TOOLS GET :field1, :field2 INTO :value1, :value2;
    /* manipulate the values to obtain result_val */
    ...
    /* put result_val into form field result */
    EXEC TOOLS PUT result VALUES (:result_val);
    return IAPSUCC;   /* trigger step succeeded */

sql_error:
    strcpy(errmsg, CONCAT("MYEXIT", sqlca.sqlerrm.sqlerrmc);
    errlen = strlen(errmsg);
    EXEC TOOLS MESSAGE :errmsg ; /* send error msg to Forms */
    return IAPFAIL;</pre></div>
                  <!-- class="section" -->
               </div>
            </div><a id="LNPCC4511"></a><div class="props_rev_3"><a id="GUID-2E8FDA40-3EF3-400C-B6CA-E206DDB8C377" name="GUID-2E8FDA40-3EF3-400C-B6CA-E206DDB8C377"></a><h3 id="LNPCC-GUID-2E8FDA40-3EF3-400C-B6CA-E206DDB8C377" class="sect3"><span class="enumeration_section">20.10 </span>About Precompiling and Compiling a User Exit
               </h3>
               <div>
                  <p>User exits are precompiled like standalone host programs. For instructions on compiling a user exit, see the Oracle installation or user's guide for your system. </p>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="precompiler-options.html#GUID-43E60380-8B54-4528-A76F-5A78A46F05D4">Precompiler Options</a></li>
                     </ul>
                  </div>
               </div>
               
            </div><a id="LNPCC4512"></a><div class="props_rev_3"><a id="GUID-C2AA12E6-ACE0-40BA-A668-620E075A4EA3" name="GUID-C2AA12E6-ACE0-40BA-A668-620E075A4EA3"></a><h3 id="LNPCC-GUID-C2AA12E6-ACE0-40BA-A668-620E075A4EA3" class="sect3"><span class="enumeration_section">20.11 </span>Example Program: A User Exit
               </h3>
               <div>
                  <div class="section">
                     <p>The following example shows a user exit.</p><pre class="oac_no_warn" dir="ltr">
/**************************************************************
Sample Program 5:  SQL*Forms User Exit

This user exit concatenates form fields.  To call the user 
exit from a SQL*Forms trigger, use the syntax

   user_exit('CONCAT field1, field2, ..., result_field');

where user_exit is a packaged procedure supplied with SQL*Forms
and CONCAT is the name of the user exit.  A sample form named
CONCAT invokes the user exit.
**************************************************************/

#define min(a, b) ((a &lt; b) ? a : b)
#include &lt;stdio.h&gt;
#include &lt;string.h&gt;

/* Include the SQL Communications Area, a structure through which
 * Oracle makes runtime status information such as error
 * codes, warning flags, and diagnostic text available to the
 * program.
 */
#include &lt;sqlca.h&gt;

/* All host variables used in embedded SQL in this example
 * appear in the Declare Section.
 */
EXEC SQL BEGIN DECLARE SECTION;
    VARCHAR   field[81];
    VARCHAR   value[81];
    VARCHAR   result[241];
EXEC SQL END DECLARE SECTION;


/* Define the user exit, called "concat". */
int concat(cmd, cmdlen, msg, msglen, query)
char *cmd;     /* command line in trigger step ("CONCAT...") */
int  *cmdlen;  /* length of command line */
char *msg;     /* trigger step failure message from form */
int  *msglen;  /* length of failure message */
int  *query;   /* TRUE if invoked by post-query trigger,
                  FALSE otherwise */
{
    char *cp = cmd + 7;    /* pointer to field list in
                              cmd string; 7 characters
                              are needed for "CONCAT " */
    char *fp = (char*)&amp;field.arr[0];  /* pointer to a field name in
                                         cmd string */
    char  errmsg[81];      /* message returned to SQL*Forms
                              on error */
    int   errlen;          /* length of message returned
                              to SQL*Forms */

/* Branch to label sqlerror if an ORACLE error occurs. */
    EXEC SQL WHENEVER SQLERROR GOTO sqlerror;

    result.arr[0] = '\0';

/* Parse field names from cmd string. */
    for (; *cp != '\0'; cp++)
    {
       if (*cp != ',' &amp;&amp; *cp != ' ')
           /* Copy a field name into field.arr from cmd. */
       {
           *fp = *cp;
           fp++;
       }
       else
           if (*cp == ' ')
           {   /* Have whole field name now. */
               *fp = '\0';
               field.len = strlen((char *) field.arr);
               /* Get field value from form. */
               EXEC TOOLS GET :field INTO :value;
               value.arr[value.len] = '\0';
               strcat((char *) result.arr, (char *) value.arr);
               fp = (char *)&amp;field.arr[0];  /* Reset field pointer. */
           }
    }

/* Have last field name now. */
    *fp = '\0';
    field.len = strlen((char *) field.arr);
    result.len = strlen((char *) result.arr);

/* Put result into form. */
    EXEC TOOLS PUT :field VALUES (:result);

/* Trigger step succeeded. */
    return(IAPSUCC);

sqlerror:
    strcpy(errmsg, "CONCAT: ");
    strncat(errmsg, sqlca.sqlerrm.sqlerrmc, min(72,
        sqlca.sqlerrm.sqlerrml));
    errlen = strlen(errmsg);
/* Pass error message to SQL*Forms status line. */
     EXEC TOOLS MESSAGE :errmsg ;
    return(IAPFAIL);  /* Trigger step failed. */
}</pre></div>
                  <!-- class="section" -->
               </div>
            </div><a id="LNPCC4513"></a><div class="props_rev_3"><a id="GUID-E33F55DB-E663-44DB-A526-B29A3D56746B" name="GUID-E33F55DB-E663-44DB-A526-B29A3D56746B"></a><h3 id="LNPCC-GUID-E33F55DB-E663-44DB-A526-B29A3D56746B" class="sect3"><span class="enumeration_section">20.12 </span>About Using the GENXTB Utility
               </h3>
               <div>
                  <p>The IAP program table IAPXTB in module IAPXIT contains an entry for each user exit linked into IAP. IAPXTB tells IAP the name, location, and host language of each user exit. When you add a new user exit to IAP, you must add a corresponding entry to IAPXTB. IAPXTB is derived from a database table, also named IAPXTB. You can modify the database table by running the GENXTB form on the operating system command line, as follows:<a id="d106100e1044" class="indexterm-anchor"></a><a id="d106100e1048" class="indexterm-anchor"></a><a id="d106100e1052" class="indexterm-anchor"></a> 
                  </p><pre class="oac_no_warn" dir="ltr">RUNFORM GENXTB username/password 
</pre><p>A form is displayed for you to enter the following information for each user exit you define: </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Exit name</p>
                     </li>
                     <li>
                        <p>C-language code</p>
                     </li>
                     <li>
                        <p>Date created </p>
                     </li>
                     <li>
                        <p>Date last modified </p>
                     </li>
                     <li>
                        <p>Comments </p>
                     </li>
                  </ul>
                  <p>After modifying the IAPXTB database table, use the GENXTB utility to read the table and create an Assembler or C source program that defines the module IAPXIT and the IAPXTB program table it contains. The source language used depends on your operating system. The syntax you use to run the GENXTB utility is </p><pre class="oac_no_warn" dir="ltr">GENXTB username/password outfile </pre><p>where <span class="italic">outfile</span> is the name you give the Assembler or C source program that GENXTB creates. <a id="d106100e1086" class="indexterm-anchor"></a><a id="d106100e1090" class="indexterm-anchor"></a><a id="d106100e1094" class="indexterm-anchor"></a>  
                  </p>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="user-exits.html#GUID-6C3CEBC0-BFC0-4AF0-9C08-9DF529FCE5E2">Guidelines</a></li>
                     </ul>
                  </div>
               </div>
               
            </div><a id="LNPCC4514"></a><div class="props_rev_3"><a id="GUID-8A1DC311-712E-4181-A3A7-230DB139EFEA" name="GUID-8A1DC311-712E-4181-A3A7-230DB139EFEA"></a><h3 id="LNPCC-GUID-8A1DC311-712E-4181-A3A7-230DB139EFEA" class="sect3"><span class="enumeration_section">20.13 </span>About Linking a User Exit into SQL*Forms
               </h3>
               <div>
                  <p>Before running a form that calls a user exit, you must link the user exit into IAP, the SQL*Forms component that runs a form. The user exit can be linked into your standard version of IAP or into a special version for those forms that call the exit. <a id="d106100e1132" class="indexterm-anchor"></a><a id="d106100e1136" class="indexterm-anchor"></a></p>
                  <p>To produce a new executable copy of IAP, link your user exit object module, the standard IAP modules, the IAPXIT module, and any modules needed from the Oracle and C link libraries. </p>
                  <p>The details of linking are system-dependent. Check the Oracle installation or user's guide for your system. </p>
               </div>
            </div><a id="LNPCC4515"></a><div class="props_rev_3"><a id="GUID-6C3CEBC0-BFC0-4AF0-9C08-9DF529FCE5E2" name="GUID-6C3CEBC0-BFC0-4AF0-9C08-9DF529FCE5E2"></a><h3 id="LNPCC-GUID-6C3CEBC0-BFC0-4AF0-9C08-9DF529FCE5E2" class="sect3"><span class="enumeration_section">20.14 </span>Guidelines
               </h3>
               <div>
                  <p>The guidelines in this section will help you avoid some common problems. </p>
               </div><a id="LNPCC4516"></a><div class="props_rev_3"><a id="GUID-F71C27B1-E23B-4784-AF9A-4F6A9C37BC11" name="GUID-F71C27B1-E23B-4784-AF9A-4F6A9C37BC11"></a><h4 id="LNPCC-GUID-F71C27B1-E23B-4784-AF9A-4F6A9C37BC11" class="sect4"><span class="enumeration_section">20.14.1 </span>About Naming the Exit
                  </h4>
                  <div>
                     <p>The name of your user exit cannot be an Oracle reserved word. Also avoid using names that conflict with the names of SQL*Forms commands, function codes, and externally defined names used by SQL*Forms. The name of the user exit entry point in the source code becomes the name of the user exit itself. The exit name must be a valid C function name, and a valid filename for your operating system. </p>
                     <p>SQL*Forms converts the name of a user exit to upper case before searching for the exit. Therefore, the exit name must be in upper case in your source code.<a id="d106100e1194" class="indexterm-anchor"></a><a id="d106100e1198" class="indexterm-anchor"></a> 
                     </p>
                  </div>
               </div><a id="LNPCC4517"></a><div class="props_rev_3"><a id="GUID-492D68C7-4655-48AC-8577-5BA6DB521087" name="GUID-492D68C7-4655-48AC-8577-5BA6DB521087"></a><h4 id="LNPCC-GUID-492D68C7-4655-48AC-8577-5BA6DB521087" class="sect4"><span class="enumeration_section">20.14.2 </span>About Connecting to Oracle
                  </h4>
                  <div>
                     <p>User exits communicate with Oracle using the connection made by SQL*Forms. However, a user exit can establish additional connections to any database using Oracle Net Services. </p>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="database-concepts.html#GUID-AE4C1784-5F16-4DB3-835C-9BEDCAA13414">Advanced Connection Options</a></li>
                        </ul>
                     </div>
                  </div>
                  
               </div><a id="LNPCC4518"></a><div class="props_rev_3"><a id="GUID-63A0EE1D-2DFE-4192-BB1E-A0E9F3949658" name="GUID-63A0EE1D-2DFE-4192-BB1E-A0E9F3949658"></a><h4 id="LNPCC-GUID-63A0EE1D-2DFE-4192-BB1E-A0E9F3949658" class="sect4"><span class="enumeration_section">20.14.3 </span>About Issuing I/O Calls
                  </h4>
                  <div>
                     <p>File I/O is supported but screen I/O is not. </p>
                  </div>
               </div><a id="LNPCC4519"></a><div class="props_rev_3"><a id="GUID-C3FE4B58-0991-46D7-84A0-116AEE52E853" name="GUID-C3FE4B58-0991-46D7-84A0-116AEE52E853"></a><h4 id="LNPCC-GUID-C3FE4B58-0991-46D7-84A0-116AEE52E853" class="sect4"><span class="enumeration_section">20.14.4 </span>About Using Host Variables
                  </h4>
                  <div>
                     <p>Restrictions on the use of host variables in a standalone program also apply to user exits. Host variables must be prefixed with a colon in EXEC SQL and EXEC TOOLS statements. The use of host arrays is not allowed in EXEC TOOLS statements. </p>
                  </div>
               </div><a id="LNPCC4520"></a><div class="props_rev_3"><a id="GUID-D465CD0E-D612-41F9-87A4-7204C78F6D45" name="GUID-D465CD0E-D612-41F9-87A4-7204C78F6D45"></a><h4 id="LNPCC-GUID-D465CD0E-D612-41F9-87A4-7204C78F6D45" class="sect4"><span class="enumeration_section">20.14.5 </span>About Updating Tables
                  </h4>
                  <div>
                     <p>Generally, a user exit should not UPDATE database tables associated with a form. For example, suppose an operator updates a record in the SQL*Forms work space, then a user exit UPDATEs the corresponding row in the associated database table. When the transaction is COMMITted, the record in the SQL*Forms work space is applied to the table, overwriting the user exit UPDATE. </p>
                  </div>
               </div><a id="LNPCC4521"></a><div class="props_rev_3"><a id="GUID-003EAFCF-9DDF-4B4D-A1BD-60CA77797867" name="GUID-003EAFCF-9DDF-4B4D-A1BD-60CA77797867"></a><h4 id="LNPCC-GUID-003EAFCF-9DDF-4B4D-A1BD-60CA77797867" class="sect4"><span class="enumeration_section">20.14.6 </span>About Issuing Commands
                  </h4>
                  <div>
                     <p>Avoid issuing a COMMIT or ROLLBACK command from your user exit because Oracle will commit or roll back work begun by the SQL*Forms operator, not just work done by the user exit. Instead, issue the COMMIT or ROLLBACK from the SQL*Forms trigger. This also applies to data definition commands (such as ALTER, CREATE, and GRANT) because they issue an implicit COMMIT before and after executing.</p>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>