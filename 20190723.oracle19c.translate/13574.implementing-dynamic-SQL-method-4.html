<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>实现动态SQL方法4</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Supplement to the Oracle Precompilers Guide "></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Supplement to the Oracle Precompilers Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="fortran-supplement-oracle-precompilers.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-11T01:30:46-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="1994, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96472-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="sample-programs.html" title="Previous" type="text/html"></link>
      <link rel="next" href="operating-system-dependencies.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Pro*FORTRAN Supplement to the Oracle Precompilers"></meta>
    <meta name="dcterms.isVersionOf" content="ZZFOR"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="sample-programs.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="operating-system-dependencies.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Oracle预编译器指南的补充</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">实现动态SQL方法4</li>
            </ol>
            <a id="GUID-08A77201-A5AA-418E-8718-BFD0EB365980" name="GUID-08A77201-A5AA-418E-8718-BFD0EB365980"></a><a id="ZZFOR245"></a>
            
            <h2 id="ZZFOR-GUID-08A77201-A5AA-418E-8718-BFD0EB365980" class="sect2"><span class="enumeration_chapter">4</span>实现动态SQL方法4</h2>
         </header>
         <div class="ind">
            <div>
               <p>本章介绍如何实现动态SQL方法4，它允许程序接受或构建包含不同数量的主机变量的动态SQL语句。</p>
               <div class="infoboxnote" id="GUID-08A77201-A5AA-418E-8718-BFD0EB365980__GUID-FCB53630-FC12-4F5E-A9F2-DB004AC698DC">
                  <p class="notep1">注意：</p>
                  <p>有关动态SQL方法1,2和3的讨论以及方法4的概述，请参阅<a href="../zzpre/using-dynamic-SQL.html#ZZPRE-GUID-5C0F172A-6D8C-45FC-8F23-B544995108FE" target="_blank">使用动态SQL</a> 。</p>
               </div>
               <p>本章包含以下部分：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="implementing-dynamic-SQL-method-4.html#GUID-6AC52D62-623E-4A78-BDA7-07E12FC9953F">满足方法4的特殊要求</a></p>
                  </li>
                  <li>
                     <p><a href="implementing-dynamic-SQL-method-4.html#GUID-0957291E-79B3-409A-B162-1245784AC373">理解SQL描述符区域（SQLDA）</a></p>
                  </li>
                  <li>
                     <p><a href="implementing-dynamic-SQL-method-4.html#GUID-B62C3A88-0C82-42D3-BB1B-7D55B7A49CF4">关于使用SQLDA变量和数组</a></p>
                  </li>
                  <li>
                     <p><a href="implementing-dynamic-SQL-method-4.html#GUID-22316CD6-2AEE-4BB4-8A4F-1CACCE89F3D0">一些预赛</a></p>
                  </li>
                  <li>
                     <p><a href="implementing-dynamic-SQL-method-4.html#GUID-B08A82F9-60B2-4FF0-9942-8A5B182A1F87">基本步骤</a></p>
                  </li>
                  <li>
                     <p><a href="implementing-dynamic-SQL-method-4.html#GUID-AD0E4E53-F53D-4449-A757-0D01BED9482A">仔细看看每一步</a></p>
                  </li>
                  <li>
                     <p><a href="implementing-dynamic-SQL-method-4.html#GUID-36D43855-12A0-45AC-A1B1-F4B932F7D23A">使用方法4的主机阵列</a></p>
                  </li>
                  <li>
                     <p><a href="implementing-dynamic-SQL-method-4.html#GUID-B67BC85D-505C-491A-B210-F34A86561E3F">示例程序10：动态SQL方法4</a></p>
                  </li>
               </ul>
            </div><a id="ZZFOR246"></a><div class="props_rev_3"><a id="GUID-6AC52D62-623E-4A78-BDA7-07E12FC9953F" name="GUID-6AC52D62-623E-4A78-BDA7-07E12FC9953F"></a><h3 id="ZZFOR-GUID-6AC52D62-623E-4A78-BDA7-07E12FC9953F" class="sect3"><span class="enumeration_section">4.1</span>满足方法4的特殊要求</h3>
               <div>
                  <p>在研究方法4的要求之前，您应该对术语<span class="italic">select-list项</span>和<span class="italic">占位符</span>感到满意。选择列表项是查询中关键字SELECT后面的列或表达式。例如，以下动态查询包含三个选择列表项：</p><pre class="oac_no_warn" dir="ltr">从EMP中选择ENAME，JOB，SAL + COMM，DEPTNO = 20</pre><p>占位符是伪绑定（输入）变量，它们在SQL语句中保存实际绑定变量的位置。您没有声明占位符，可以将它们命名为您喜欢的任何名称。绑定变量的占位符最常用于SET，VALUES和WHERE子句中。例如，以下动态SQL语句每个都包含两个占位符：</p><pre class="oac_no_warn" dir="ltr">插入EMP（EMPNO，DEPTNO）值（：E，：D）从部门删除DEPTNO =：DNUM和LOC =：DLOC</pre><div class="infoboxnote" id="GUID-6AC52D62-623E-4A78-BDA7-07E12FC9953F__GUID-8F60ECBE-D8ED-45CF-AC23-C1A3EDFDC8B5">
                     <p class="notep1">注意：</p>
                     <p>占位符不能引用表名或列名。</p>
                  </div>
               </div><a id="ZZFOR247"></a><div class="props_rev_3"><a id="GUID-0BC4615D-EEE1-4978-B316-D6529679D017" name="GUID-0BC4615D-EEE1-4978-B316-D6529679D017"></a><h4 id="ZZFOR-GUID-0BC4615D-EEE1-4978-B316-D6529679D017" class="sect4"><span class="enumeration_section">4.1.1</span>什么使方法4特别？
                  </h4>
                  <div>
                     <p>与方法1,2和3不同，动态SQL方法4允许您的程序</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>接受或构建包含未知数量的选择列表项或占位符的动态SQL语句</p>
                        </li>
                        <li>
                           <p>明确控制Oracle和FORTRAN类型之间的数据类型转换</p>
                        </li>
                     </ul>
                     <p>要为程序添加此灵活性，必须为Oracle运行时库提供其他信息。</p>
                  </div>
               </div><a id="ZZFOR248"></a><div class="props_rev_3"><a id="GUID-5A554289-4E96-4A1F-A2FC-1B2C560000C7" name="GUID-5A554289-4E96-4A1F-A2FC-1B2C560000C7"></a><h4 id="ZZFOR-GUID-5A554289-4E96-4A1F-A2FC-1B2C560000C7" class="sect4"><span class="enumeration_section">4.1.2</span> Oracle需要哪些信息？
                  </h4>
                  <div>
                     <p>Pro * FORTRAN预编译器为所有可执行动态SQL语句生成对Oracle的调用。如果动态SQL语句不包含选择列表项或占位符，则Oracle不需要其他信息来执行该语句。以下DELETE语句属于此类别：</p><pre class="oac_no_warn" dir="ltr">*动态SQL语句STMT ='从EMP删除DEPTNO = 30'</pre><p>但是，大多数动态SQL语句包含绑定变量的选择列表项或占位符，如以下UPDATE语句所示：</p><pre class="oac_no_warn" dir="ltr">*带占位符的动态SQL语句STMT ='UPDATE EMP SET COMM =：C WHERE EMPNO =：E'</pre><p>要执行包含绑定变量的选择列表项和/或占位符的动态SQL语句，Oracle需要有关将保存输出或输入值的程序变量的信息。具体而言，Oracle需要以下信息：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>选择列表项的数量和绑定变量的数量</p>
                        </li>
                        <li>
                           <p>每个选择列表项和绑定变量的长度</p>
                        </li>
                        <li>
                           <p>每个选择列表项和绑定变量的数据类型</p>
                        </li>
                        <li>
                           <p>每个输出变量的内存地址，用于存储选择列表项的值，以及每个绑定变量的地址</p>
                        </li>
                     </ul>
                     <p>例如，要写入select-list项的值，Oracle需要相应输出变量的地址。</p>
                  </div>
               </div><a id="ZZFOR249"></a><div class="props_rev_3"><a id="GUID-4C7B4963-5300-4C29-B9C9-1B05FA2CBA76" name="GUID-4C7B4963-5300-4C29-B9C9-1B05FA2CBA76"></a><h4 id="ZZFOR-GUID-4C7B4963-5300-4C29-B9C9-1B05FA2CBA76" class="sect4"><span class="enumeration_section">4.1.3</span>信息存储在哪里？
                  </h4>
                  <div>
                     <p>Oracle需要的关于绑定变量的选择列表项或占位符的所有信息（除了它们的值）都存储在称为SQL描述符区域（SQLDA）的程序数据结构中。</p>
                     <p>选择列表项的描述存储在<span class="italic">选择的SQLDA中，</span>绑定变量的占位符描述存储在<span class="italic">绑定的SQLDA中</span> 。</p>
                     <p>select-list项的值存储在输出缓冲区中;绑定变量的值存储在输入缓冲区中。您可以使用库例程SQLADR将这些数据缓冲区的地址存储在select或bind SQLDA中，以便Oracle知道在何处写入输出值和读取输入值。</p>
                     <p>值如何存储在这些数据缓冲区中？输出值使用游标进行FETCH，输入值由程序填充，通常来自用户交互输入的信息。</p>
                  </div>
               </div><a id="ZZFOR250"></a><div class="props_rev_3"><a id="GUID-0ED02C0B-640A-4622-A379-8CF81219F7B9" name="GUID-0ED02C0B-640A-4622-A379-8CF81219F7B9"></a><h4 id="ZZFOR-GUID-0ED02C0B-640A-4622-A379-8CF81219F7B9" class="sect4"><span class="enumeration_section">4.1.4</span>如何获取信息？
                  </h4>
                  <div>
                     <p>您可以使用DESCRIBE语句来帮助获取Oracle所需的信息。DESCRIBE SELECT LIST语句检查每个选择列表项以确定其名称，数据类型，约束，长度，比例和精度，然后将此信息存储在选择的SQLDA中供您使用。例如，您可以使用选择列表名称作为打印输出中的列标题。DESCRIBE还存储SQLDA中的选择列表项的总数。</p>
                     <p>DESCRIBE BIND VARIABLES语句检查每个占位符以确定其名称和长度，然后将此信息存储在输入缓冲区中并绑定SQLDA供您使用。例如，您可以使用占位符名称来提示用户输入绑定变量的值。</p>
                  </div>
               </div>
            </div><a id="ZZFOR251"></a><div class="props_rev_3"><a id="GUID-0957291E-79B3-409A-B162-1245784AC373" name="GUID-0957291E-79B3-409A-B162-1245784AC373"></a><h3 id="ZZFOR-GUID-0957291E-79B3-409A-B162-1245784AC373" class="sect3"><span class="enumeration_section">4.2</span>了解SQL描述符区域（SQLDA）</h3>
               <div>
                  <p>本节详细介绍了SQLDA数据结构。您将学习如何声明它，它包含哪些变量，如何初始化它们以及如何在程序中使用它们。</p>
               </div><a id="ZZFOR252"></a><div class="props_rev_3"><a id="GUID-BC942FC4-45B6-42A1-9229-FC877EC0B7E0" name="GUID-BC942FC4-45B6-42A1-9229-FC877EC0B7E0"></a><h4 id="ZZFOR-GUID-BC942FC4-45B6-42A1-9229-FC877EC0B7E0" class="sect4"><span class="enumeration_section">4.2.1</span> SQLDA的目的</h4>
                  <div>
                     <p>对于包含未知数量的选择列表项或绑定变量占位符的动态SQL语句，需要方法4。要处理这种动态SQL语句，程序必须显式声明SQLDAs，也称为<span class="italic">描述符</span> （不要与某些FORTRAN编译器生成的CHARACTER变量描述符混淆）。每个描述符都是一个名为COMMON的块，您必须将其复制或硬编码到程序中。
                     </p>
                     <p><span class="italic">选择描述符</span>包含选择列表项的描述和输出缓冲区的地址，其中存储了选择列表项的名称和值。
                     </p>
                     <div class="infoboxnote" id="GUID-BC942FC4-45B6-42A1-9229-FC877EC0B7E0__GUID-0585B071-EF9A-4659-B17E-985FC59EEE12">
                        <p class="notep1">注意：</p>
                        <p>选择列表项的名称可以是列名，列别名，也可以是SAL + COMM等表达式的文本。</p>
                     </div>
                     <p><span class="italic">绑定描述符</span>包含绑定变量和指示符变量的描述以及存储绑定变量和指示符变量的名称和值的输入缓冲区的地址。
                     </p>
                     <p>请记住，一些描述符变量包含地址，而不是值。因此，您必须声明数据缓冲区以保存值。您可以决定所需输入和输出缓冲区的大小。因为FORTRAN不支持指针，所以必须使用库子例程SQLADR来获取输入和输出缓冲区的地址。您将学习如何在<span class="q">“ <a href="implementing-dynamic-SQL-method-4.html#GUID-016E8B3C-41EF-46DD-8006-0DFCD30DB8C8">关于使用SQLADR</a> ”</span>一节中调用SQLADR。
                     </p>
                  </div>
               </div><a id="ZZFOR253"></a><div class="props_rev_3"><a id="GUID-2E3F97A7-7C38-4B70-B0C9-BC3657A22DE7" name="GUID-2E3F97A7-7C38-4B70-B0C9-BC3657A22DE7"></a><h4 id="ZZFOR-GUID-2E3F97A7-7C38-4B70-B0C9-BC3657A22DE7" class="sect4"><span class="enumeration_section">4.2.2</span>多个SQLDA</h4>
                  <div>
                     <p>如果您的程序有多个活动的动态SQL语句，则每个语句必须具有自己的SQLDA。您可以声明任意数量的具有不同名称的SQLDA。例如，您可以声明三个名为SEL1，SEL2和SEL3的选择SQLDAs，以便您可以从三个同时打开的游标进行FETCH。但是，非并发游标可以重用SQLDA。</p>
                  </div>
               </div><a id="ZZFOR254"></a><div class="props_rev_3"><a id="GUID-374624BE-61C2-4F6E-9CE8-9A31EA944412" name="GUID-374624BE-61C2-4F6E-9CE8-9A31EA944412"></a><h4 id="ZZFOR-GUID-374624BE-61C2-4F6E-9CE8-9A31EA944412" class="sect4"><span class="enumeration_section">4.2.3</span>命名约定</h4>
                  <div>
                     <div class="section">
                        <p>您可以根据需要为选择和绑定描述符命名。通常，使用名称SEL和BND。预编译器通过在描述符名称后附加单字符后缀来引用描述符变量（参见表4-1）。您在DESCRIBE，OPEN和FETCH语句中使用描述符名称。</p>
                        <p>例如，声明</p><pre class="oac_no_warn" dir="ltr">*打开一个光标。EXEC SQL OPEN CUR1使用DESCRIPTOR BND *获取选择列表值。EXEC SQL FETCH CUR1使用DESCRIPTOR SEL</pre><p>将select-list值提取到输出数据缓冲区中。</p>
                        <p>您可以确定所需数据缓冲区的名称和大小。下表中分别显示的变量和缓冲区名称将在以下讨论中使用。例如，描述符数组SELS的元素寻址数据缓冲器数组SELSB的元素。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="tblformal" id="GUID-374624BE-61C2-4F6E-9CE8-9A31EA944412__GUID-843D831A-CC93-4AF8-9D06-90FA69360A26">
                        <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="variable and buffer names" frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="33%" id="d14652e372">后缀</th>
                                 <th align="left" valign="bottom" width="33%" id="d14652e375">主机数据类型</th>
                                 <th align="left" valign="bottom" width="33%" id="d14652e378">描述</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="33%" id="d14652e383" headers="d14652e372 ">
                                    <p>ñ</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e383 d14652e375 ">
                                    <p>INTEGER var</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e383 d14652e378 ">
                                    <p>选择列表项或占位符的最大数量</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="33%" id="d14652e393" headers="d14652e372 ">
                                    <p>F</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e393 d14652e375 ">
                                    <p>INTEGER var</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e393 d14652e378 ">
                                    <p>选择列表项或占位符的实际数量</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="33%" id="d14652e403" headers="d14652e372 ">
                                    <p>小号</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e403 d14652e375 ">
                                    <p>INTEGER * 4 var（n）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e403 d14652e378 ">
                                    <p>选择列表或占位符名称的地址</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="33%" id="d14652e413" headers="d14652e372 ">
                                    <p>中号</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e413 d14652e375 ">
                                    <p>INTEGER * 2 var（n）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e413 d14652e378 ">
                                    <p>选择列表或占位符名称的最大长度</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="33%" id="d14652e423" headers="d14652e372 ">
                                    <p>C</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e423 d14652e375 ">
                                    <p>INTEGER * 2 var（n）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e423 d14652e378 ">
                                    <p>选择列表或占位符名称的实际长度</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="33%" id="d14652e433" headers="d14652e372 ">
                                    <p>大号</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e433 d14652e375 ">
                                    <p>INTEGER * 4 var（n）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e433 d14652e378 ">
                                    <p>select-list或bind-variable值的长度</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="33%" id="d14652e443" headers="d14652e372 ">
                                    <p>Ť</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e443 d14652e375 ">
                                    <p>INTEGER * 2 var（n）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e443 d14652e378 ">
                                    <p>select-list或bind-variable值的数据类型</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="33%" id="d14652e453" headers="d14652e372 ">
                                    <p>V</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e453 d14652e375 ">
                                    <p>INTEGER * 4 var（n）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e453 d14652e378 ">
                                    <p>select-list或bind-variable值的地址</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="33%" id="d14652e463" headers="d14652e372 ">
                                    <p>一世</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e463 d14652e375 ">
                                    <p>INTEGER * 4 var（n）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e463 d14652e378 ">
                                    <p>指标变量值的地址（1）</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="33%" id="d14652e473" headers="d14652e372 ">
                                    <p>X（2）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e473 d14652e375 ">
                                    <p>INTEGER * 4 var（n）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e473 d14652e378 ">
                                    <p>指标变量名称的地址（1）</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="33%" id="d14652e483" headers="d14652e372 ">
                                    <p>Y（2）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e483 d14652e375 ">
                                    <p>INTEGER * 2 var（n）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e483 d14652e378 ">
                                    <p>指标变量名称的最大长度（1）</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="33%" id="d14652e494" headers="d14652e372 ">
                                    <p>Z（2）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e494 d14652e375 ">
                                    <p>INTEGER * 2 var（n）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e494 d14652e378 ">
                                    <p>指标变量名称的实际长度（1）</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <div class="section">
                        <div class="infoboxnote" id="GUID-374624BE-61C2-4F6E-9CE8-9A31EA944412__GUID-388F3CEA-1B17-4817-9760-69B467801648">
                           <p class="notep1">注意：</p>
                           <p>1。指示符变量名称仅适用于绑定SQLDA。</p>
                           <p>2。这些后缀仅适用于绑定变量。</p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="tblformal" id="GUID-374624BE-61C2-4F6E-9CE8-9A31EA944412__GUID-5CF027CA-670D-4883-BE29-221DF9DA7496">
                        <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="SQLDA variables" frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="33%" id="d14652e518">缓冲</th>
                                 <th align="left" valign="bottom" width="33%" id="d14652e521">主机数据类型</th>
                                 <th align="left" valign="bottom" width="33%" id="d14652e524">描述</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="33%" id="d14652e529" headers="d14652e518 ">
                                    <p>SELSB</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e529 d14652e521 ">
                                    <p>LOGICAL * 1 var（m，n）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e529 d14652e524 ">
                                    <p>选择列表名称</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="33%" id="d14652e539" headers="d14652e518 ">
                                    <p>SELVB</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e539 d14652e521 ">
                                    <p>LOGICAL * 1 var（m，n）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e539 d14652e524 ">
                                    <p>选择列表名称</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="33%" id="d14652e549" headers="d14652e518 ">
                                    <p>SELIV</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e549 d14652e521 ">
                                    <p>INTEGER * 2 var（n）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e549 d14652e524 ">
                                    <p>指标变量值</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="33%" id="d14652e559" headers="d14652e518 ">
                                    <p>BNDSB</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e559 d14652e521 ">
                                    <p>LOGICAL * 1 var（m，n）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e559 d14652e524 ">
                                    <p>占位符名称</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="33%" id="d14652e569" headers="d14652e518 ">
                                    <p>BNDVB</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e569 d14652e521 ">
                                    <p>LOGICAL * 1 var（m，n）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e569 d14652e524 ">
                                    <p>绑定变量值</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="33%" id="d14652e579" headers="d14652e518 ">
                                    <p>BNDXB</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e579 d14652e521 ">
                                    <p>LOGICAL * 1 var（m，n）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e579 d14652e524 ">
                                    <p>指标变量名称</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="33%" id="d14652e589" headers="d14652e518 ">
                                    <p>BNDIV</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e589 d14652e521 ">
                                    <p>INTEGER * 2 var（n）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e589 d14652e524 ">
                                    <p>指标变量名称</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <div class="section">
                        <div class="infoboxnote" id="GUID-374624BE-61C2-4F6E-9CE8-9A31EA944412__GUID-A869A47D-D126-4A5D-AA42-9D0E375CDFC3">
                           <p class="notep1">注意：</p>
                           <p>没有SELXB缓冲区，因为指示符变量名称不能与选择列表项关联。</p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ZZFOR256"></a><a id="ZZFOR257"></a><a id="ZZFOR255"></a><div class="props_rev_3"><a id="GUID-4882619D-4344-4326-A8FD-9B6CF702DCB4" name="GUID-4882619D-4344-4326-A8FD-9B6CF702DCB4"></a><h4 id="ZZFOR-GUID-4882619D-4344-4326-A8FD-9B6CF702DCB4" class="sect4"><span class="enumeration_section">4.2.4</span>关于声明SQLDA</h4>
                  <div>
                     <p>要声明select和bind SQLDAs，可以使用<a href="implementing-dynamic-SQL-method-4.html#GUID-4882619D-4344-4326-A8FD-9B6CF702DCB4__BCEHGBJI">图4-1</a>中<a href="implementing-dynamic-SQL-method-4.html#GUID-4882619D-4344-4326-A8FD-9B6CF702DCB4__BCEHGBJI">所示</a>的示例SQLDA将它们硬编码到程序中。
                     </p>
                     <div class="figure" id="GUID-4882619D-4344-4326-A8FD-9B6CF702DCB4__BCEHGBJI">
                        <p class="titleinfigure">图4-1 Pro * FORTRAN SQLDA变量和数据缓冲区示例</p><img src="img/image004.gif" alt="下面是图4-1的描述" title="下面是图4-1的描述" longdesc="img_text/image004.html"><br><a href="img_text/image004.html">“图4-1示例Pro * FORTRAN SQLDA变量和数据缓冲区”的说明</a></div>
                     <!-- class="figure" -->
                     <p>您可以修改阵列尺寸以满足您的需求。以下示例使用参数指定数组维度;这使得改变尺寸变得容易：</p><pre class="oac_no_warn" dir="ltr">INTEGER SIZE *设置描述符数组的维度。PARAMETER（SIZE = 25）*声明选择描述符。INTEGER SELN INTEGER SELF INTEGER * 4 SELV（SIZE）INTEGER * 4卖（尺寸）......
</pre><p>您可能希望将SQLDAs存储在文件中（例如，名为SELDSC和BNDDSC），根据需要对其进行修改，然后使用INCLUDE语句将文件复制到程序中，如下所示：</p><pre class="oac_no_warn" dir="ltr">*声明选择并绑定SQLDA。EXEC SQL包含SELDSC EXEC SQL包含BNDDSC</pre><p>因为它们是COMMON块，所以必须在Declare Section <span class="italic">之外</span>声明SQLDAs。如何声明数据缓冲区取决于您。您不需要将它们包含在SQLDA COMMON块中。例如，您可能希望声明一个大型数据缓冲区来存储所有名称和值，然后使用字节偏移来访问它们。
                     </p>
                     <p><a href="implementing-dynamic-SQL-method-4.html#GUID-4882619D-4344-4326-A8FD-9B6CF702DCB4__BCEEGFAD">图4-2</a>显示了变量是由SQLADR调用，DESCRIBE命令，FETCH命令还是程序分配设置的。
                     </p>
                     <div class="figure" id="GUID-4882619D-4344-4326-A8FD-9B6CF702DCB4__BCEEGFAD">
                        <p class="titleinfigure">图4-2如何设置变量</p><img src="img/image005.gif" alt="下面是图4-2的描述" title="下面是图4-2的描述" longdesc="img_text/image005.html"><br><a href="img_text/image005.html">“图4-2如何设置变量”的描述</a></div>
                     <!-- class="figure" -->
                  </div>
               </div>
            </div><a id="ZZFOR258"></a><div class="props_rev_3"><a id="GUID-B62C3A88-0C82-42D3-BB1B-7D55B7A49CF4" name="GUID-B62C3A88-0C82-42D3-BB1B-7D55B7A49CF4"></a><h3 id="ZZFOR-GUID-B62C3A88-0C82-42D3-BB1B-7D55B7A49CF4" class="sect3"><span class="enumeration_section">4.3</span>关于使用SQLDA变量和数组</h3>
               <div>
                  <p>本节介绍每个SQLDA变量的用途和用法。在示例中，使用先前给出的任意SQLDA文件名，描述符名称和数据缓冲区名称。</p>
               </div><a id="ZZFOR259"></a><div class="props_rev_3"><a id="GUID-AD99A7B5-07FE-44F4-BCA6-804FD6750C71" name="GUID-AD99A7B5-07FE-44F4-BCA6-804FD6750C71"></a><h4 id="ZZFOR-GUID-AD99A7B5-07FE-44F4-BCA6-804FD6750C71" class="sect4"><span class="enumeration_section">4.3.1</span> N变量</h4>
                  <div>
                     <div class="section">
                        <p>此变量指定可以DESCRIBEd的选择列表项或占位符的最大数量。例如，SELN确定选择描述符数组中的元素数。</p>
                        <p>在发出DESCRIBE命令之前，必须将此变量设置为描述符数组的维度。在DESCRIBE之后，必须将其重置为变量DESCRIBEd的实际数量，该变量存储在F变量中。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ZZFOR260"></a><div class="props_rev_3"><a id="GUID-811CC1C0-A2CE-44EE-8CB7-CE143993D52C" name="GUID-811CC1C0-A2CE-44EE-8CB7-CE143993D52C"></a><h4 id="ZZFOR-GUID-811CC1C0-A2CE-44EE-8CB7-CE143993D52C" class="sect4"><span class="enumeration_section">4.3.2</span> F变量</h4>
                  <div>
                     <div class="section">
                        <p>这是DESCRIBE命令找到的选择列表项或占位符的实际数量。</p>
                        <p>F变量由DESCRIBE设置。如果F变量为负数，则DESCRIBE命令找到过多的选择列表项或占位符以获取描述符的大小。例如，如果将SELN设置为10但DESCRIBE找到11个选择列表项，则SELF设置为-11。如果发生这种情况，则无法在不重新分配描述符的情况下处理SQL语句。</p>
                        <p>在DESCRIBE命令之后，必须将N变量设置为等于F变量。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ZZFOR261"></a><div class="props_rev_3"><a id="GUID-AC8E7C28-9A8B-448A-99E8-3184FDA769DF" name="GUID-AC8E7C28-9A8B-448A-99E8-3184FDA769DF"></a><h4 id="ZZFOR-GUID-AC8E7C28-9A8B-448A-99E8-3184FDA769DF" class="sect4"><span class="enumeration_section">4.3.3</span> S阵列</h4>
                  <div>
                     <div class="section">
                        <p>此数组包含存储在动态SQL语句中出现的选择列表或占位符名称的数据缓冲区的地址。</p>
                        <p>在发出DESCRIBE命令之前，必须使用SQLADR设置S数组的元素。</p>
                        <p>DESCRIBE指示Oracle将第J个选择列表项或占位符的名称存储在SELS（J）或BNDS（J）寻址的缓冲区中。如果SELS和BNDS的元素寻址名为SELSB和BNDSB的数据缓冲区数组的元素，则Oracle将第J个选择列表或占位符名称存储在SELSB（J）或BNDSB（J）中。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ZZFOR262"></a><div class="props_rev_3"><a id="GUID-E2F88DBF-33AE-4BEB-9FFA-C387C0B171C5" name="GUID-E2F88DBF-33AE-4BEB-9FFA-C387C0B171C5"></a><h4 id="ZZFOR-GUID-E2F88DBF-33AE-4BEB-9FFA-C387C0B171C5" class="sect4"><span class="enumeration_section">4.3.4</span> M阵列</h4>
                  <div>
                     <div class="section">
                        <p>此数组包含存储选择列表或占位符名称的数据缓冲区的长度。缓冲区由S数组的元素寻址。</p>
                        <p>必须在发出DESCRIBE命令之前设置M数组的元素。每个选择列表或占位符名称缓冲区可以具有不同的长度。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ZZFOR263"></a><div class="props_rev_3"><a id="GUID-5D35FEE5-A05F-49AB-B03B-FEDC9FC64A68" name="GUID-5D35FEE5-A05F-49AB-B03B-FEDC9FC64A68"></a><h4 id="ZZFOR-GUID-5D35FEE5-A05F-49AB-B03B-FEDC9FC64A68" class="sect4"><span class="enumeration_section">4.3.5</span> C阵列</h4>
                  <div>
                     <div class="section">
                        <p>此数组包含select-list或占位符名称的实际长度。DESCRIBE将实际长度数组设置为每个选择列表或占位符名称中的字符数。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ZZFOR264"></a><div class="props_rev_3"><a id="GUID-3816347C-8714-43E1-89F9-4CBE44179313" name="GUID-3816347C-8714-43E1-89F9-4CBE44179313"></a><h4 id="ZZFOR-GUID-3816347C-8714-43E1-89F9-4CBE44179313" class="sect4"><span class="enumeration_section">4.3.6</span> L阵列</h4>
                  <div>
                     <div class="section">
                        <p>此数组包含存储在数据缓冲区中的select-list或bind-variable值的长度。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ZZFOR265"></a><div class="props_rev_3"><a id="GUID-7FE620EA-C96B-4598-A08B-15CCA7A18F29" name="GUID-7FE620EA-C96B-4598-A08B-15CCA7A18F29"></a><h4 id="ZZFOR-GUID-7FE620EA-C96B-4598-A08B-15CCA7A18F29" class="sect4"><span class="enumeration_section">4.3.7</span>选择描述符</h4>
                  <div>
                     <div class="section">
                        <p>DESCRIBE将长度数组设置为每个选择列表项的预期最大值。但是，您可能希望在发出FETCH命令之前重置某些长度。FETCH最多返回<span class="italic">n个</span>字符，其中<span class="italic">n</span>是FETCH之前的SELL（J）值。</p>
                        <p>长度的格式因Oracle数据类型而异。对于字符选择列表项，DESCRIBE将SELL（J）设置为选择列表项的最大长度（以字节为单位）。对于NUMBER个选择列表项，分别在变量的低字节和下一个字节中返回缩放和精度。您可以使用库子例程SQLPRC从SELL中提取精度和比例值。请参阅“提取精度和比例”一节。</p>
                        <p>必须在FETCH之前将SELL（J）重置为数据缓冲区所需的长度。例如，在将NUMBER强制转换为FORTRAN CHARACTER字符串时，将SELL（J）设置为数字的精度加上符号和小数点的2。将NUMBER强制转换为FORTRAN REAL时，将SELL（J）设置为系统上REAL的长度。有关强制数据类型长度的更多信息，请参阅“转换数据”部分。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ZZFOR266"></a><div class="props_rev_3"><a id="GUID-1D725440-90CB-4EFC-81AA-8E429CA2C298" name="GUID-1D725440-90CB-4EFC-81AA-8E429CA2C298"></a><h4 id="ZZFOR-GUID-1D725440-90CB-4EFC-81AA-8E429CA2C298" class="sect4"><span class="enumeration_section">4.3.8</span>绑定描述符</h4>
                  <div>
                     <div class="section">
                        <p>必须在发出OPEN命令之前设置长度数组。</p>
                        <p>由于Oracle使用SELV（J）或BNDV（J）中的地址间接访问数据缓冲区，因此它不知道该缓冲区中值的长度。如果要更改Oracle用于第J个select-list或bind-variable值的长度，请将SELL（J）或BNDL（J）重置为所需的长度。每个输入或输出缓冲区可以具有不同的长度。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ZZFOR267"></a><div class="props_rev_3"><a id="GUID-9A7C654B-FA85-45BD-A1AD-B192822CAF06" name="GUID-9A7C654B-FA85-45BD-A1AD-B192822CAF06"></a><h4 id="ZZFOR-GUID-9A7C654B-FA85-45BD-A1AD-B192822CAF06" class="sect4"><span class="enumeration_section">4.3.9</span> T阵列</h4>
                  <div>
                     <div class="section">
                        <p>此数组包含select-list或bind-variable值的数据类型代码。这些代码确定在存储在SELV元素寻址的数据缓冲区中时如何转换Oracle数据。 “转换数据”一节中介绍了此主题。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ZZFOR268"></a><div class="props_rev_3"><a id="GUID-6C980560-AD21-40E9-8439-9FF396772428" name="GUID-6C980560-AD21-40E9-8439-9FF396772428"></a><h4 id="ZZFOR-GUID-6C980560-AD21-40E9-8439-9FF396772428" class="sect4"><span class="enumeration_section">4.3.10</span>选择描述符</h4>
                  <div>
                     <div class="section">
                        <p>DESCRIBE将数据类型代码数组设置为选择列表中项目的<span class="italic">内部</span>数据类型（例如，VARCHAR2，CHAR，NUMBER或DATE）。
                        </p>
                        <p>在FETCHing之前，您可能希望重置某些数据类型，因为Oracle数据类型的内部格式可能难以处理。出于显示目的，将选择列表值的数据类型强制转换为VARCHAR2通常是个好主意。对于计算，您可能希望将数字从Oracle强制转换为FORTRAN格式。请参阅“强制数据类型”部分。</p>
                        <p>SELT（J）的高位被设置为指示第J个选择列表列的空/非空状态。在发出OPEN或FETCH命令之前，必须始终清除该位。您使用库子例程SQLNUL来检索数据类型代码并清除null / not null位。请参阅“处理空/非空数据类型”一节。</p>
                        <p>您应该将Oracle NUMBER内部数据类型更改为与SELV（J）寻址的FORTRAN数据缓冲区的外部数据类型兼容的外部数据类型。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ZZFOR269"></a><div class="props_rev_3"><a id="GUID-DB83E520-201D-4C7E-9F73-962338D517BE" name="GUID-DB83E520-201D-4C7E-9F73-962338D517BE"></a><h4 id="ZZFOR-GUID-DB83E520-201D-4C7E-9F73-962338D517BE" class="sect4"><span class="enumeration_section">4.3.11</span>绑定描述符</h4>
                  <div>
                     <div class="section">
                        <p>DESCRIBE将数据类型代码数组设置为零。在发出OPEN命令之前，必须重置存储在每个元素中的数据类型代码。代码表示由BNDV（J）寻址的数据缓冲区的外部（FORTRAN）数据类型。通常，绑定变量值存储在字符串中，因此数据类型数组元素设置为1（VARCHAR2数据类型代码）。</p>
                        <p>要更改第J个选择列表或绑定变量值的数据类型，请将SELT（J）或BNDT（J）重置为所需的数据类型。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ZZFOR270"></a><div class="props_rev_3"><a id="GUID-2B26E62E-6227-41B7-80B1-ECE96F9F47C2" name="GUID-2B26E62E-6227-41B7-80B1-ECE96F9F47C2"></a><h4 id="ZZFOR-GUID-2B26E62E-6227-41B7-80B1-ECE96F9F47C2" class="sect4"><span class="enumeration_section">4.3.12</span> V阵列</h4>
                  <div>
                     <div class="section">
                        <p>此数组包含存储select-list或bind-variable值的数据缓冲区的地址。您必须使用SQLADR设置V数组的元素。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ZZFOR271"></a><div class="props_rev_3"><a id="GUID-0C2E1B2B-762B-41BC-9728-A77692ABAFDD" name="GUID-0C2E1B2B-762B-41BC-9728-A77692ABAFDD"></a><h4 id="ZZFOR-GUID-0C2E1B2B-762B-41BC-9728-A77692ABAFDD" class="sect4"><span class="enumeration_section">4.3.13</span>选择描述符</h4>
                  <div>
                     <div class="section">
                        <p>必须在发出FETCH命令之前设置此数组。以下声明</p><pre class="oac_no_warn" dir="ltr">*获取选择列表值。EXEC SQL FETCH ...使用DESCRIPTOR SEL</pre><p>指示Oracle在由SELV（1）到SELV（SELN）寻址的数据缓冲区中存储FETCHed选择列表值。如果SELV的元素寻址名为SELVB的数据缓冲区数组的元素，则Oracle将第J个选择列表值存储在SELVB（J）中。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ZZFOR272"></a><div class="props_rev_3"><a id="GUID-8BCBB1BB-2F6A-4198-963E-3C60FB3358A8" name="GUID-8BCBB1BB-2F6A-4198-963E-3C60FB3358A8"></a><h4 id="ZZFOR-GUID-8BCBB1BB-2F6A-4198-963E-3C60FB3358A8" class="sect4"><span class="enumeration_section">4.3.14</span>绑定描述符</h4>
                  <div>
                     <div class="section">
                        <p>必须在发出OPEN命令之前设置此数组。以下声明</p><pre class="oac_no_warn" dir="ltr">*打开光标。EXEC SQL OPEN ...使用DESCRIPTOR BND</pre><p>指示Oracle使用BNDV（1）到BNDV（BNDN）寻址的绑定变量值来执行动态SQL语句。如果BNDV的元素寻址名为BNDVB的数据缓冲区数组的元素，则Oracle在数据缓冲区BNDVB（J）中找到第J个绑定变量值。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ZZFOR273"></a><div class="props_rev_3"><a id="GUID-AF96A2CA-340C-4CA8-95D4-F5B83FDC5FE1" name="GUID-AF96A2CA-340C-4CA8-95D4-F5B83FDC5FE1"></a><h4 id="ZZFOR-GUID-AF96A2CA-340C-4CA8-95D4-F5B83FDC5FE1" class="sect4"><span class="enumeration_section">4.3.15</span> I阵列</h4>
                  <div>
                     <div class="section">
                        <p>此数组包含存储指示符变量值的数据缓冲区的地址。</p>
                        <p>您必须使用SQLADR设置I数组的元素。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ZZFOR274"></a><div class="props_rev_3"><a id="GUID-DAC5099D-2957-4E4B-B912-A6E9588BBA01" name="GUID-DAC5099D-2957-4E4B-B912-A6E9588BBA01"></a><h4 id="ZZFOR-GUID-DAC5099D-2957-4E4B-B912-A6E9588BBA01" class="sect4"><span class="enumeration_section">4.3.16</span>选择描述符</h4>
                  <div>
                     <div class="section">
                        <p>必须在发出FETCH命令之前设置此数组。当Oracle执行语句时</p><pre class="oac_no_warn" dir="ltr">*获取选择列表值。EXEC SQL FETCH ...使用DESCRIPTOR SEL</pre><p>如果Jth返回的select-list值为null，则SELI（J）寻址的缓冲区设置为-1。否则，将其设置为零（值不为空）或正整数（该值被截断）。例如，如果SELI的元素寻址名为SELIV的数据缓冲区数组的元素，并且Jth返回的select-list值为null，则SELIV（J）设置为-1。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ZZFOR275"></a><div class="props_rev_3"><a id="GUID-A326C3F4-628F-4370-8F3A-0AF4BA51EC0F" name="GUID-A326C3F4-628F-4370-8F3A-0AF4BA51EC0F"></a><h4 id="ZZFOR-GUID-A326C3F4-628F-4370-8F3A-0AF4BA51EC0F" class="sect4"><span class="enumeration_section">4.3.17</span>绑定描述符</h4>
                  <div>
                     <div class="section">
                        <p>必须初始化此数组并在发出OPEN命令之前设置关联的指示符变量。当Oracle执行以下语句时</p><pre class="oac_no_warn" dir="ltr">*打开光标。EXEC SQL OPEN ...使用DESCRIPTOR BND</pre><p>BNDI（J）寻址的缓冲区确定第J个绑定变量是否为空。如果指示符变量的值为-1，则其关联的主变量为null。例如，如果BNDI的元素寻址名为BNDIV的数据缓冲区数组的元素，并且BNDIV（J）的值为-1，则将第J个绑定变量的值设置为NULL。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ZZFOR276"></a><div class="props_rev_3"><a id="GUID-53106641-EA85-447D-A650-B24E9BDD4800" name="GUID-53106641-EA85-447D-A650-B24E9BDD4800"></a><h4 id="ZZFOR-GUID-53106641-EA85-447D-A650-B24E9BDD4800" class="sect4"><span class="enumeration_section">4.3.18</span> X阵列</h4>
                  <div>
                     <div class="section">
                        <p>此数组包含存储指示符变量名称的数据缓冲区的地址。您可以将指标变量<span class="italic">值</span>与选择列表项和绑定变量相关联。但是，您只能将指示符变量<span class="italic">名称</span>与绑定变量相关联。因此，您只能将X数组与绑定描述符一起使用。
                        </p>
                        <p>在发出DESCRIBE命令之前，必须使用SQLADR设置X数组的元素。</p>
                        <p>DESCRIBE指示Oracle将任何指示符变量名称存储在BNDX（1）到BNDX（BNDN）寻址的缓冲区中。如果BNDX的元素寻址名为BNDXB的数据缓冲区数组的元素，则Oracle将第J个指示符变量名称存储在BNDXB（J）中。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ZZFOR277"></a><div class="props_rev_3"><a id="GUID-1B5372E0-61C9-4900-8399-D01B6F1F503B" name="GUID-1B5372E0-61C9-4900-8399-D01B6F1F503B"></a><h4 id="ZZFOR-GUID-1B5372E0-61C9-4900-8399-D01B6F1F503B" class="sect4"><span class="enumeration_section">4.3.19</span> Y阵列</h4>
                  <div>
                     <div class="section">
                        <p>此数组包含存储指示符变量名称的数据缓冲区的最大长度。缓冲区由X数组的元素寻址。与X数组一样，您只能将Y数组与绑定描述符一起使用。</p>
                        <p>在发出DESCRIBE命令之前，必须将元素BNDY（1）设置为BNDY（BNDN）。每个指示符变量名称缓冲区可以具有不同的长度。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ZZFOR278"></a><div class="props_rev_3"><a id="GUID-1A308E50-431C-4D85-A803-9BA37DB092DE" name="GUID-1A308E50-431C-4D85-A803-9BA37DB092DE"></a><h4 id="ZZFOR-GUID-1A308E50-431C-4D85-A803-9BA37DB092DE" class="sect4"><span class="enumeration_section">4.3.20</span> Z阵列</h4>
                  <div>
                     <div class="section">
                        <p>此数组包含指示符变量名称的实际长度。与X和Y数组一样，您只能将Z数组与绑定描述符一起使用。</p>
                        <p>DESCRIBE将实际长度数组设置为每个指示符变量名称中的字符数。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="ZZFOR279"></a><div class="props_rev_3"><a id="GUID-22316CD6-2AEE-4BB4-8A4F-1CACCE89F3D0" name="GUID-22316CD6-2AEE-4BB4-8A4F-1CACCE89F3D0"></a><h3 id="ZZFOR-GUID-22316CD6-2AEE-4BB4-8A4F-1CACCE89F3D0" class="sect3"><span class="enumeration_section">4.4</span>一些预赛</h3>
               <div>
                  <p>您需要具备以下主题的工作知识才能实现动态SQL方法4：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>使用库子例程SQLADR</p>
                     </li>
                     <li>
                        <p>转换数据</p>
                     </li>
                     <li>
                        <p>强制数据类型</p>
                     </li>
                     <li>
                        <p>处理null / not null数据类型</p>
                     </li>
                  </ul>
               </div><a id="ZZFOR280"></a><div class="props_rev_3"><a id="GUID-016E8B3C-41EF-46DD-8006-0DFCD30DB8C8" name="GUID-016E8B3C-41EF-46DD-8006-0DFCD30DB8C8"></a><h4 id="ZZFOR-GUID-016E8B3C-41EF-46DD-8006-0DFCD30DB8C8" class="sect4"><span class="enumeration_section">4.4.1</span>关于使用SQLADR</h4>
                  <div>
                     <p>必须调用库子例程SQLADR以获取存储输入和输出值的数据缓冲区的地址。将地址存储在select或绑定SQLDA中，以便Oracle知道在何处读取绑定变量值或写入select-list值。</p>
                     <p>使用语法调用SQLADR</p><pre class="oac_no_warn" dir="ltr">CALL SQLADR（BUFF，ADDR）</pre><p>哪里：</p>
                     <p>BUFF</p>
                     <p>是一个数据缓冲区，用于存储选择列表项，绑定变量或指示符变量的值或名称。</p>
                     <p>ADDR</p>
                     <p>是一个返回数据缓冲区地址的整数变量。</p>
                     <p>对SQLADR的调用将ADFF的地址存储在ADDR中。在以下示例中，您使用SQLADR初始化选择描述符数组SELV，SELS和SELI。它们的元素用于选择列表值，选择列表名称和指示符值的数据缓冲区。</p><pre class="oac_no_warn" dir="ltr">*初始化选择描述符数组。DO 100 J = 1，SELN CALL SQLADR（SELVB（1，J），SELV（J））CALL SQLADR（SELSB（1，J），SELS（J））CALL SQLADR（SELIV（J），SELI（J）） 100继续</pre></div>
               </div><a id="ZZFOR281"></a><div class="props_rev_3"><a id="GUID-392B3F2B-E152-45EE-BD5F-A9B8E6CBF4B7" name="GUID-392B3F2B-E152-45EE-BD5F-A9B8E6CBF4B7"></a><h4 id="ZZFOR-GUID-392B3F2B-E152-45EE-BD5F-A9B8E6CBF4B7" class="sect4"><span class="enumeration_section">4.4.2</span>限制</h4>
                  <div>
                     <p>如果FORTRAN编译器为CHARACTER变量生成描述符并将描述符地址（而不是数据地址）传递给SQLADR，则不能将CHARACTER变量与SQLADR一起使用。检查您的FORTRAN编译器用户指南。在这种情况下，SQLADR获取错误的地址。相反，使用LOGICAL * 1变量，因为它们总是具有简单的地址。</p>
                     <p>但是，如果编译器提供了访问数据地址的内置函数，则可以（谨慎地）将SQLADR与CHARACTER变量一起使用。例如，如果编译器提供名为％REF的函数，而X是CHARACTER变量，则按如下方式调用SQLADR：</p><pre class="oac_no_warn" dir="ltr">*使用％REF内置功能。CALL SQLADR（％REF（X），...）
</pre></div>
               </div><a id="ZZFOR282"></a><div class="props_rev_3"><a id="GUID-D4BB40D8-84B7-4B83-9F9C-296132AB76AE" name="GUID-D4BB40D8-84B7-4B83-9F9C-296132AB76AE"></a><h4 id="ZZFOR-GUID-D4BB40D8-84B7-4B83-9F9C-296132AB76AE" class="sect4"><span class="enumeration_section">4.4.3</span>转换数据</h4>
                  <div>
                     <p>本节提供有关数据类型描述符数组的更多详细信息。在既不使用数据类型等效也不使用动态SQL方法4的主机程序中，Oracle内部数据类型和外部数据类型之间的转换是在预编译时确定的。默认情况下，预编译器会为Declare Section中的每个主机变量分配特定的外部数据类型。例如，预编译器将FLOAT外部数据类型分配给REAL类型的主机变量。</p>
                     <p>但是，方法4允许您控制数据转换和格式。您可以通过在数据类型描述符数组中设置数据类型代码来指定转换。</p>
                  </div>
               </div><a id="ZZFOR283"></a><div class="props_rev_3"><a id="GUID-4DD9BFDD-374B-4AA0-B22B-D4F9713F3BB9" name="GUID-4DD9BFDD-374B-4AA0-B22B-D4F9713F3BB9"></a><h4 id="ZZFOR-GUID-4DD9BFDD-374B-4AA0-B22B-D4F9713F3BB9" class="sect4"><span class="enumeration_section">4.4.4</span>内部数据类型</h4>
                  <div>
                     <div class="section">
                        <p>内部数据类型指定Oracle用于在数据库表中存储列值的格式以及表示伪列值的格式。</p>
                        <p>当您发出DESCRIBE SELECT LIST命令时，Oracle会将每个选择列表项的内部数据类型代码返回到SELT（数据类型）描述符数组。例如，第J个选择列表项的数据类型代码返回到SELT（J）。</p>
                        <p>下表显示了Oracle内部数据类型及其代码。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="tblformal" id="GUID-4DD9BFDD-374B-4AA0-B22B-D4F9713F3BB9__GUID-6DE5F3BD-161C-4754-B8F3-E7C567B04F84">
                        <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="internal datatypes and their codes" frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="50%" id="d14652e1371">Oracle内部数据类型</th>
                                 <th align="left" valign="bottom" width="50%" id="d14652e1374">码</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d14652e1379" headers="d14652e1371 ">
                                    <p>VARCHAR2</p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d14652e1379 d14652e1374 ">
                                    <p>1</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d14652e1386" headers="d14652e1371 ">
                                    <p>数</p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d14652e1386 d14652e1374 ">
                                    <p>2</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d14652e1393" headers="d14652e1371 ">
                                    <p>长</p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d14652e1393 d14652e1374 ">
                                    <p>8</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d14652e1400" headers="d14652e1371 ">
                                    <p>ROWID</p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d14652e1400 d14652e1374 ">
                                    <p>11</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d14652e1407" headers="d14652e1371 ">
                                    <p>日期</p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d14652e1407 d14652e1374 ">
                                    <p>12</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d14652e1414" headers="d14652e1371 ">
                                    <p>生的</p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d14652e1414 d14652e1374 ">
                                    <p>23</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d14652e1421" headers="d14652e1371 ">
                                    <p>LONG RAW</p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d14652e1421 d14652e1374 ">
                                    <p>24</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d14652e1428" headers="d14652e1371 ">
                                    <p>CHAR</p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d14652e1428 d14652e1374 ">
                                    <p>96</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d14652e1435" headers="d14652e1371 ">
                                    <p>MLSLABEL</p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d14652e1435 d14652e1374 ">
                                    <p>105</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div>
               </div><a id="ZZFOR284"></a><div class="props_rev_3"><a id="GUID-E0C9F6B8-7C01-4214-9BDB-65FDDB7A3F2B" name="GUID-E0C9F6B8-7C01-4214-9BDB-65FDDB7A3F2B"></a><h4 id="ZZFOR-GUID-E0C9F6B8-7C01-4214-9BDB-65FDDB7A3F2B" class="sect4"><span class="enumeration_section">4.4.5</span>外部数据类型</h4>
                  <div>
                     <div class="section">
                        <p>外部数据类型指定用于在输入和输出主机变量中存储值的格式。</p>
                        <p>DESCRIBE BIND VARIABLES命令将BNDT数据类型代码数组设置为零。因此，您必须<span class="italic">在</span>发出OPEN命令<span class="italic">之前</span>重置代码。这些代码告诉Oracle各种绑定变量需要哪些外部数据类型。对于第J个绑定变量，将BNDT（J）重置为所需的外部数据类型。
                        </p>
                        <p>下表显示了Oracle外部数据类型及其代码，以及相应的FORTRAN数据类型：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="tblformal" id="GUID-E0C9F6B8-7C01-4214-9BDB-65FDDB7A3F2B__GUID-79E0D351-80CE-4669-A77C-E9AF577B4392">
                        <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="internal data types and FORTRAN data types" frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="33%" id="d14652e1480">名称</th>
                                 <th align="left" valign="bottom" width="33%" id="d14652e1483">码</th>
                                 <th align="left" valign="bottom" width="33%" id="d14652e1486">FORTRAN数据类型</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="33%" id="d14652e1491" headers="d14652e1480 ">
                                    <p>VARCHAR2</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e1491 d14652e1483 ">
                                    <p>1</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e1491 d14652e1486 ">
                                    <p>MODE时的CHARACTER * <span class="italic">n</span> ！= ANSI</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="33%" id="d14652e1504" headers="d14652e1480 ">
                                    <p>数</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e1504 d14652e1483 ">
                                    <p>2</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e1504 d14652e1486 ">
                                    <p>字符* <span class="italic">n</span></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="33%" id="d14652e1516" headers="d14652e1480 ">
                                    <p>整数</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e1516 d14652e1483 ">
                                    <p>3</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e1516 d14652e1486 ">
                                    <p>整数</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="33%" id="d14652e1526" headers="d14652e1480 ">
                                    <p>浮动</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e1526 d14652e1483 ">
                                    <p>4</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e1526 d14652e1486 ">
                                    <p>真实</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="33%" id="d14652e1536" headers="d14652e1480 ">
                                    <p>STRING（1）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e1536 d14652e1483 ">
                                    <p>五</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e1536 d14652e1486 ">
                                    <p>字符*（ <span class="italic">n</span> + 1）</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="33%" id="d14652e1549" headers="d14652e1480 ">
                                    <p>VARNUM</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e1549 d14652e1483 ">
                                    <p>6</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e1549 d14652e1486 ">
                                    <p>字符* <span class="italic">n</span></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="33%" id="d14652e1561" headers="d14652e1480 ">
                                    <p>DECIMAL</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e1561 d14652e1483 ">
                                    <p>7</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e1561 d14652e1486 ">
                                    <p>字符* <span class="italic">n</span></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="33%" id="d14652e1573" headers="d14652e1480 ">
                                    <p>长</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e1573 d14652e1483 ">
                                    <p>8</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e1573 d14652e1486 ">
                                    <p>字符* <span class="italic">n</span></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="33%" id="d14652e1585" headers="d14652e1480 ">
                                    <p>VARCHAR（2）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e1585 d14652e1483 ">
                                    <p>9</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e1585 d14652e1486 ">
                                    <p>字符* <span class="italic">n</span></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="33%" id="d14652e1597" headers="d14652e1480 ">
                                    <p>ROWID</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e1597 d14652e1483 ">
                                    <p>11</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e1597 d14652e1486 ">
                                    <p>字符* <span class="italic">n</span></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="33%" id="d14652e1609" headers="d14652e1480 ">
                                    <p>日期</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e1609 d14652e1483 ">
                                    <p>12</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e1609 d14652e1486 ">
                                    <p>字符* <span class="italic">n</span></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="33%" id="d14652e1622" headers="d14652e1480 ">
                                    <p>VARRAW（2）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e1622 d14652e1483 ">
                                    <p>15</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e1622 d14652e1486 ">
                                    <p>字符* <span class="italic">n</span></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="33%" id="d14652e1634" headers="d14652e1480 ">
                                    <p>生的</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e1634 d14652e1483 ">
                                    <p>23</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e1634 d14652e1486 ">
                                    <p>字符* <span class="italic">n</span></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="33%" id="d14652e1646" headers="d14652e1480 ">
                                    <p>LONG RAW</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e1646 d14652e1483 ">
                                    <p>24</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e1646 d14652e1486 ">
                                    <p>字符* <span class="italic">n</span></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="33%" id="d14652e1658" headers="d14652e1480 ">
                                    <p>UNSIGNED</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e1658 d14652e1483 ">
                                    <p>68</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e1658 d14652e1486 ">
                                    <p>整数</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="33%" id="d14652e1668" headers="d14652e1480 ">
                                    <p>显示</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e1668 d14652e1483 ">
                                    <p>91</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e1668 d14652e1486 ">
                                    <p>字符* <span class="italic">n</span></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="33%" id="d14652e1680" headers="d14652e1480 ">
                                    <p>LONG VARCHAR（2）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e1680 d14652e1483 ">
                                    <p>94</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e1680 d14652e1486 ">
                                    <p>字符* <span class="italic">n</span></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="33%" id="d14652e1692" headers="d14652e1480 ">
                                    <p>长萝卜（2）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e1692 d14652e1483 ">
                                    <p>95</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e1692 d14652e1486 ">
                                    <p>字符* <span class="italic">n</span></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="33%" id="d14652e1704" headers="d14652e1480 ">
                                    <p>CHARF</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e1704 d14652e1483 ">
                                    <p>96</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e1704 d14652e1486 ">
                                    <p>MODE = ANSI时的CHARACTER * <span class="italic">n</span></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="33%" id="d14652e1717" headers="d14652e1480 ">
                                    <p>CHARZ（1）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e1717 d14652e1483 ">
                                    <p>97</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e1717 d14652e1486 ">
                                    <p>字符*（ <span class="italic">n</span> + 1）</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="33%" id="d14652e1730" headers="d14652e1480 ">
                                    <p>光标</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e1730 d14652e1483 ">
                                    <p>102</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e1730 d14652e1486 ">
                                    <p>SQLCURSOR</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="33%" id="d14652e1740" headers="d14652e1480 ">
                                    <p>MLSLABEL</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e1740 d14652e1483 ">
                                    <p>106</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e1740 d14652e1486 ">
                                    <p>字符* <span class="italic">n</span></p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <div class="section">
                        <div class="infoboxnote" id="GUID-E0C9F6B8-7C01-4214-9BDB-65FDDB7A3F2B__GUID-2906757D-2020-4BE3-930F-768013C9C09F">
                           <p class="notep1">注意：</p>
                           <p>1。仅用于EXEC SQL VAR语句。</p>
                           <p>2。包括<span class="italic">n</span>字节长度字段。
                           </p>
                        </div>
                        <p>有关Oracle数据类型及其格式的更多信息，请参阅<a href="../zzpre/meeting-program-requirements.html#ZZPRE-GUID-ED71BADE-AF94-4074-B4B1-140E03903E88" target="_blank">满足程序要求</a> 。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ZZFOR285"></a><div class="props_rev_3"><a id="GUID-866A067C-CE33-4414-B0E5-CC8ADAE440C2" name="GUID-866A067C-CE33-4414-B0E5-CC8ADAE440C2"></a><h4 id="ZZFOR-GUID-866A067C-CE33-4414-B0E5-CC8ADAE440C2" class="sect4"><span class="enumeration_section">4.4.6</span> PL / SQL数据类型</h4>
                  <div>
                     <div class="section">
                        <p>PL / SQL提供了各种预定义的标量和复合数据类型。<span class="italic">标量</span>类型没有内部组件。<span class="italic">复合</span>类型具有可以单独操作的内部组件。下表显示了预定义的PL / SQL标量数据类型及其Oracle内部数据类型等效项。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="tblformal" id="GUID-866A067C-CE33-4414-B0E5-CC8ADAE440C2__GUID-5DF41C9A-8AED-476B-8507-BC72B81C7885">
                        <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="predefined PL/SQL scalar datatypes" frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="50%" id="d14652e1804">PL / SQL数据类型</th>
                                 <th align="left" valign="bottom" width="50%" id="d14652e1807">Oracle内部数据类型</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d14652e1812" headers="d14652e1804 ">
                                    <p>VARCHAR VARCHAR2</p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d14652e1812 d14652e1807 ">
                                    <p>VARCHAR2</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d14652e1819" headers="d14652e1804 ">
                                    <p>BINARY_INTEGER DEC DECIMAL DOUBLE PRECISION FLOAT INT INTEGER NATURAL NUMBER NUMERIC POSITIVE REAL SMALLINT</p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d14652e1819 d14652e1807 ">
                                    <p>数</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d14652e1826" headers="d14652e1804 ">
                                    <p>长</p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d14652e1826 d14652e1807 ">
                                    <p>长</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d14652e1833" headers="d14652e1804 ">
                                    <p>ROWID</p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d14652e1833 d14652e1807 ">
                                    <p>ROWID</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d14652e1840" headers="d14652e1804 ">
                                    <p>日期</p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d14652e1840 d14652e1807 ">
                                    <p>日期</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d14652e1847" headers="d14652e1804 ">
                                    <p>生的</p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d14652e1847 d14652e1807 ">
                                    <p>生的</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d14652e1854" headers="d14652e1804 ">
                                    <p>LONG RAW</p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d14652e1854 d14652e1807 ">
                                    <p>LONG RAW</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d14652e1861" headers="d14652e1804 ">
                                    <p>CHAR CHARACTER STRING</p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d14652e1861 d14652e1807 ">
                                    <p>CHAR</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d14652e1868" headers="d14652e1804 ">
                                    <p>MLSLABEL</p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d14652e1868 d14652e1807 ">
                                    <p>MLSLABEL</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div>
               </div><a id="ZZFOR286"></a><div class="props_rev_3"><a id="GUID-C453736A-C5F3-4ACB-8766-179C6BF0E5D0" name="GUID-C453736A-C5F3-4ACB-8766-179C6BF0E5D0"></a><h4 id="ZZFOR-GUID-C453736A-C5F3-4ACB-8766-179C6BF0E5D0" class="sect4"><span class="enumeration_section">4.4.7</span>强制数据类型</h4>
                  <div>
                     <p>对于选择描述符，DESCRIBE SELECT LIST可以返回任何Oracle内部数据类型。通常，与字符数据一样，内部数据类型与您要使用的外部数据类型完全对应。但是，一些内部数据类型映射到可能难以处理的外部数据类型。因此，您可能希望重置SELT描述符数组中的某些元素。</p>
                     <p>例如，您可能希望将NUMBER值重置为FLOAT值，这些值对应于FORTRAN中的REAL值。 Oracle在FETCH时间执行内部和外部数据类型之间的任何必要转换。所以，一定要重新设置数据类型的DESCRIBE SELECT LIST <span class="italic">之后</span> ，但<span class="italic">之前</span>的FETCH。</p>
                     <p>对于绑定描述符，DESCRIBE BIND VARIABLES <span class="italic">并不</span>返回绑定变量的数据类型，只是它们的数量和名称。因此，必须显式设置数据类型代码的BNDT数组，以告知Oracle每个绑定变量的外部数据类型。Oracle在OPEN时执行外部和内部数据类型之间的任何必要转换。
                     </p>
                     <p>在SELT或BNDT描述符数组中重置数据类型代码时，您将“强制数据类型”。例如，要将Jth select-list值强制转换为VARCHAR2，请使用以下语句：</p><pre class="oac_no_warn" dir="ltr">*将选择列表值强制转换为VARCHAR2。SELT（J）= 1</pre><p>将NUMBER选择列表值强制转换为VARCHAR2以进行显示时，还必须提取值的精度和比例字节，并使用它们计算最大显示长度。然后，在FETCH之前，必须重置SELL（长度）描述符数组的相应元素，以告知Oracle要使用的缓冲区长度。要指定第J个选择列表值的长度，请将SELL（J）设置为您需要的长度。</p>
                     <p>例如，如果DESCRIBE SELECT LIST发现第J个选择列表项的类型为NUMBER，并且您希望将返回的值存储在声明为REAL的FORTRAN变量中，只需将SELT（J）设置为4并将SELL（J）设置为系统上REAL数字的长度。</p>
                  </div>
               </div><a id="ZZFOR287"></a><div class="props_rev_3"><a id="GUID-9E20CF7F-5586-4AA3-BD16-343DE84429DB" name="GUID-9E20CF7F-5586-4AA3-BD16-343DE84429DB"></a><h4 id="ZZFOR-GUID-9E20CF7F-5586-4AA3-BD16-343DE84429DB" class="sect4"><span class="enumeration_section">4.4.8</span>例外情况</h4>
                  <div>
                     <p>在某些情况下，DESCRIBE SELECT LIST返回的内部数据类型可能不适合您的目的。两个例子是DATE和NUMBER。当您描述DATE选择列表项时，Oracle将数据类型代码12返回给SELT数组。除非您在FETCH之前重置代码，否则日期值将以其7字节内部格式返回。要以默认字符格式获取日期，必须将数据类型代码从12更改为1（VARCHAR2），并将SELL值从7增加到9。</p>
                     <p>同样，当您描述一个NUMBER选择列表项时，Oracle会将数据类型代码2返回给SELT数组。除非您在FETCH之前重置代码，否则数值将以其内部格式返回，这可能不是您想要的。因此，将代码从2更改为1（VARCHAR2），3（INTEGER），4（FLOAT）或其他一些适当的数据类型。</p>
                  </div>
               </div><a id="ZZFOR288"></a><div class="props_rev_3"><a id="GUID-FBC71A98-1654-4555-B00A-44A5601D0C7A" name="GUID-FBC71A98-1654-4555-B00A-44A5601D0C7A"></a><h4 id="ZZFOR-GUID-FBC71A98-1654-4555-B00A-44A5601D0C7A" class="sect4"><span class="enumeration_section">4.4.9</span>关于提取精度和规模</h4>
                  <div>
                     <p>库子例程SQLPRC提取精度和比例。通常，它在DESCRIBE SELECT LIST之后使用，其第一个参数是SELL（J）。您可以使用语法调用SQLPRC</p><pre class="oac_no_warn" dir="ltr">CALL SQLPRC（LENGTH，PREC，SCALE）</pre><p>哪里：</p>
                     <p>长度</p>
                     <p>是一个整数变量，用于存储Oracle NUMBER值的长度。值的比例和精度分别存储在低位和高位字节中。</p>
                     <p>PREC</p>
                     <p>是一个整数变量，它返回NUMBER值的<span class="italic">精度</span> 。Precision是有效数字的位数。如果select-list项指的是未指定大小的NUMBER，则设置为零。在这种情况下，由于未指定大小，您可能需要假设最大精度，38。
                     </p>
                     <p>规模</p>
                     <p>是一个整数变量，它返回NUMBER值的<span class="italic">比例</span> 。Scale指定舍入将发生的位置。例如，2的刻度表示该值四舍五入到最接近的百分位数（3.456变为3.46）;比例为-3表示数字四舍五入到最接近的千位（3456变为3000）。
                     </p>
                     <p>以下示例显示如何使用SQLPRC计算将被强制转换为VARCHAR2的NUMBER值的最大显示长度：</p><pre class="oac_no_warn" dir="ltr">*声明函数调用的变量。INTEGER PREC INTEGER SCALE EXEC SQL描述选择列表用于输入SEL DO 1300 J = 1，SELN IF（SELT（J）。NE。 2）GOTO 1300 *如果数据类型为NUMBER，则提取精度和比例。CALL SQLPRC（卖出（J），PREC，SCALE）*如果未指定精度，则指定最大值。IF（PREC。NE。 0）GOTO 1100卖出（J）= 10 GOTO 1300 1100继续卖出（J）= PREC *允许可能的符号和小数点。卖出（J）=出售（J）+ 2 1300续......
</pre><p>SQLPRC子例程返回零作为某些SQL数据类型的精度和小数位数值。SQLPR2子例程与SQLPRC类似，它具有相同的语法并返回相同的二进制值，但下表中显示的数据类型除外。</p>
                     <div class="tblformal" id="GUID-FBC71A98-1654-4555-B00A-44A5601D0C7A__GUID-4A579165-8CFD-49AD-8D97-EFCA7FDDD1F8">
                        <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="datatypes" frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="33%" id="d14652e2002">SQL数据类型</th>
                                 <th align="left" valign="bottom" width="33%" id="d14652e2005">二进制精度</th>
                                 <th align="left" valign="bottom" width="33%" id="d14652e2008">二进制比例</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="33%" id="d14652e2013" headers="d14652e2002 ">
                                    <p>浮动</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e2013 d14652e2005 ">
                                    <p>126</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e2013 d14652e2008 ">
                                    <p>-127</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="33%" id="d14652e2023" headers="d14652e2002 ">
                                    <p>FLOAT（ <span class="italic">n</span> ）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e2023 d14652e2005 ">
                                    <p><span class="italic">n</span> （范围是1 ..126）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e2023 d14652e2008 ">
                                    <p>-127</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="33%" id="d14652e2038" headers="d14652e2002 ">
                                    <p>真实</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e2038 d14652e2005 ">
                                    <p>63</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e2038 d14652e2008 ">
                                    <p>-127</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="33%" id="d14652e2048" headers="d14652e2002 ">
                                    <p>双精度</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e2048 d14652e2005 ">
                                    <p>126</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d14652e2048 d14652e2008 ">
                                    <p>-127</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div>
               </div><a id="ZZFOR289"></a><div class="props_rev_3"><a id="GUID-747DB02B-A52E-4351-878D-79669C505FF1" name="GUID-747DB02B-A52E-4351-878D-79669C505FF1"></a><h4 id="ZZFOR-GUID-747DB02B-A52E-4351-878D-79669C505FF1" class="sect4"><span class="enumeration_section">4.4.10</span>关于处理Null / Not Null数据类型</h4>
                  <div>
                     <p>对于每个select-list列（非表达式），DESCRIBE SELECT LIST在选择描述符的数据类型数组（SELT）中返回null / not null指示。如果第J个选择列列被约束为非空，则SELT（J）的高位清零;否则，它被设定。</p>
                     <p>在OPEN或FETCH语句中使用数据类型之前，如果设置了空状态位，则必须清除它。永远不要设置位。</p>
                     <p>您可以使用库子例程SQLNUL来查明列是否允许空值，以及清除数据类型的空状态位。您可以使用语法调用SQLNUL</p><pre class="oac_no_warn" dir="ltr">CALL SQLNUL（VALTYP，TYPCODE，NULSTAT）</pre><p>哪里：</p>
                     <p>VALTYP</p>
                     <p>是一个2字节的整数变量，用于存储select-list列的数据类型代码。</p>
                     <p>TYPCODE</p>
                     <p>是一个2字节的整数变量，它返回清除高位的select-list列的数据类型代码。</p>
                     <p>NULSTAT</p>
                     <p>是一个整数变量，它返回select-list列的null状态。 1表示该列允许空值; 0意味着它没有。</p>
                     <p>以下示例显示如何使用SQLNUL：</p><pre class="oac_no_warn" dir="ltr">*为子程序调用声明变量。INTEGER * 2 DATYPE INTEGER NULLOK DO 1500 J = 1，SELN *确定列是否为NULL，并且*清除高位。CALL SQLNUL（SELT（J），DATYPE，NULLOK）SELT（J）= DATYPE *如果NULLOK等于1，则允许空值。...1500续......
</pre><p>子例程中的第一个参数是SELT数据类型数组的第J个元素，在其清空null / not null位之前。虽然有些系统允许你使用SELT（J）作为第二个参数，但是使用相同的变量作为多个参数是不好的编程习惯。</p>
                  </div>
               </div>
            </div><a id="ZZFOR290"></a><div class="props_rev_3"><a id="GUID-B08A82F9-60B2-4FF0-9942-8A5B182A1F87" name="GUID-B08A82F9-60B2-4FF0-9942-8A5B182A1F87"></a><h3 id="ZZFOR-GUID-B08A82F9-60B2-4FF0-9942-8A5B182A1F87" class="sect3"><span class="enumeration_section">4.5</span>基本步骤</h3>
               <div>
                  <div class="section">
                     <p>方法4可用于处理<span class="italic">任何</span>动态SQL语句。在该示例中，将处理查询，以便您可以查看如何处理输入和输出主机变量。同样，使用前面给出的任意SQLDA文件名，描述符名称和数据缓冲区名称。
                     </p>
                     <p>要处理动态查询，我们的示例程序执行以下操作：</p>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>在Declare Section中声明一个主机字符串以保存查询文本。</span><div></div>
                     </li>
                     <li class="stepexpand"><span>声明选择和绑定描述符。</span><div></div>
                     </li>
                     <li class="stepexpand"><span>设置可以DESCRIBEd的选择列表项和占位符的最大数量。</span><div></div>
                     </li>
                     <li class="stepexpand"><span>初始化select和bind描述符。</span><div></div>
                     </li>
                     <li class="stepexpand"><span>将查询文本存储在主机字符串中。</span><div></div>
                     </li>
                     <li class="stepexpand"><span>从主机字符串中预处理查询。</span><div></div>
                     </li>
                     <li class="stepexpand"><span>为查询DECLARE游标。</span><div></div>
                     </li>
                     <li class="stepexpand"><span>将绑定变量描述为绑定描述符。</span><div></div>
                     </li>
                     <li class="stepexpand"><span>将占位符数重置为DESCRIBE命令实际找到的数字。</span><div></div>
                     </li>
                     <li class="stepexpand"><span>获取DESCRIBE找到的绑定变量的值。</span><div></div>
                     </li>
                     <li class="stepexpand"><span>使用绑定描述符打开游标。</span><div></div>
                     </li>
                     <li class="stepexpand"><span>将选择列表描述为选择描述符。</span><div></div>
                     </li>
                     <li class="stepexpand"><span>将选择列表项的数量重置为DESCRIBE命令实际找到的数字。</span><div></div>
                     </li>
                     <li class="stepexpand"><span>重置每个选择列表项的长度和数据类型以用于显示目的。</span><div></div>
                     </li>
                     <li class="stepexpand"><span>使用select描述符从数据库INTO数据缓冲区中FETCH一行。</span><div></div>
                     </li>
                     <li class="stepexpand"><span>处理FETCH返回的select-list值。</span><div></div>
                     </li>
                     <li class="stepexpand"><span>当FETCH没有更多行时关闭光标。</span><div></div>
                     </li>
                  </ol>
                  <div class="section">
                     <div class="infoboxnote" id="GUID-B08A82F9-60B2-4FF0-9942-8A5B182A1F87__GUID-E52A977E-AA13-4FE9-B2A4-B2CA0D813F3C">
                        <p class="notep1">注意：</p>
                        <p>如果动态SQL语句<span class="italic">不是</span>查询或包含已知数量的选择列表项或占位符，则不需要执行某些步骤。
                        </p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="ZZFOR291"></a><div class="props_rev_3"><a id="GUID-AD0E4E53-F53D-4449-A757-0D01BED9482A" name="GUID-AD0E4E53-F53D-4449-A757-0D01BED9482A"></a><h3 id="ZZFOR-GUID-AD0E4E53-F53D-4449-A757-0D01BED9482A" class="sect3"><span class="enumeration_section">4.6</span>仔细研究每一步</h3>
               <div>
                  <div class="section">
                     <p>本节将更详细地讨论每个步骤。此外，本章末尾是一个说明方法4的完整程序。</p>
                     <p>使用方法4，您可以使用以下嵌入式SQL语句序列：</p><pre class="oac_no_warn" dir="ltr">EXEC SQL PREPARE &lt;statement_name&gt; FROM {：&lt;host_string&gt; | &lt;string_literal&gt;} EXEC SQL DECLARE &lt;cursor_name&gt; CURSOR FOR &lt;statement_name&gt; EXEC SQL DESCRIBE BIND VARIABLES FOR &lt;statement_name&gt; INTO &lt;bind_descriptor_name&gt; EXEC SQL OPEN &lt;cursor_name&gt; [USING DESCRIPTOR &lt;bind_descriptor_name&gt;] EXEC SQL DESCRIBE [SELECT LIST FOR] &lt;statement_name&gt; INTO &lt;select_descriptor_name&gt; EXEC SQL FETCH &lt;cursor_name&gt; USING DESCRIPTOR &lt;select_descriptor_name&gt; EXEC SQL CLOSE &lt;cursor_name&gt;</pre><p>如果已知动态查询中的选择列表项的数量，则可以省略DESCRIBE SELECT LIST并使用以下方法3 FETCH语句：</p><pre class="oac_no_warn" dir="ltr">EXEC SQL FETCH &lt;cursor_name&gt; INTO &lt;host_variable_list&gt;</pre><p>如果已知动态SQL语句中绑定变量的占位符数，则可以省略DESCRIBE BIND VARIABLES并使用以下方法3 OPEN语句：</p><pre class="oac_no_warn" dir="ltr">EXEC SQL OPEN &lt;cursor_name&gt; [USING &lt;host_variable_list&gt;]</pre><p>接下来，您将看到这些语句如何允许宿主程序使用描述符接受和处理动态SQL语句。</p>
                     <div class="infoboxnote" id="GUID-AD0E4E53-F53D-4449-A757-0D01BED9482A__GUID-8FFE02F5-0336-4DBC-A352-49A698706F54">
                        <p class="notep1">注意：</p>
                        <p>以下讨论伴随着几个数字。为了避免使图形混乱，有必要将描述符数组限制为3个元素，并将名称和值的最大长度分别限制为5和10个字符。</p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div><a id="ZZFOR292"></a><div class="props_rev_3"><a id="GUID-84754EAB-4E11-4483-9330-70927ED46894" name="GUID-84754EAB-4E11-4483-9330-70927ED46894"></a><h4 id="ZZFOR-GUID-84754EAB-4E11-4483-9330-70927ED46894" class="sect4"><span class="enumeration_section">4.6.1</span>声明主机字符串</h4>
                  <div>
                     <div class="section">
                        <p>您的程序需要一个宿主变量来存储动态SQL语句的文本。必须将主变量（在我们的示例中为SELSTM）声明为字符串。</p><pre class="oac_no_warn" dir="ltr">EXEC SQL BEGIN DECLARE SECTION ...CHARACTER * 120 SELSTM EXEC SQL END DECLARE SECTION</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ZZFOR293"></a><div class="props_rev_3"><a id="GUID-46BD45C9-2978-46CF-AA88-E997F0FE5809" name="GUID-46BD45C9-2978-46CF-AA88-E997F0FE5809"></a><h4 id="ZZFOR-GUID-46BD45C9-2978-46CF-AA88-E997F0FE5809" class="sect4"><span class="enumeration_section">4.6.2</span>声明SQLDA</h4>
                  <div>
                     <div class="section">
                        <p>因为我们示例中的查询可能包含未知数量的选择列表项或占位符，所以必须声明select和bind描述符。您可以使用INCLUDE语句将它们复制到程序中，而不是对SQLDAs进行硬编码，如下所示：</p><pre class="oac_no_warn" dir="ltr">EXEC SQL包含SELDSC EXEC SQL包含BNDDSC</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ZZFOR294"></a><div class="props_rev_3"><a id="GUID-3334E251-BF33-4D71-A8DF-FDD32FEC535C" name="GUID-3334E251-BF33-4D71-A8DF-FDD32FEC535C"></a><h4 id="ZZFOR-GUID-3334E251-BF33-4D71-A8DF-FDD32FEC535C" class="sect4"><span class="enumeration_section">4.6.3</span>设置DESCRIBE的最大数量</h4>
                  <div>
                     <div class="section">
                        <p>接下来，设置可以DESCRIBEd的选择列表项或占位符的最大数量，如下所示：</p><pre class="oac_no_warn" dir="ltr">SELN = 3 BNDN = 3</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ZZFOR296"></a><a id="ZZFOR297"></a><a id="ZZFOR295"></a><div class="props_rev_3"><a id="GUID-A2645DC1-65F4-4FAC-8CCD-931ED3D56EE1" name="GUID-A2645DC1-65F4-4FAC-8CCD-931ED3D56EE1"></a><h4 id="ZZFOR-GUID-A2645DC1-65F4-4FAC-8CCD-931ED3D56EE1" class="sect4"><span class="enumeration_section">4.6.4</span>初始化描述符</h4>
                  <div>
                     <div class="section">
                        <p>您必须初始化几个描述符变量;有些需要库子例程SQLADR。在我们的示例中，您将名称缓冲区的最大长度存储在M和Y数组中，并使用SQLADR在V，S，I和X数组中存储值和名称缓冲区的地址：</p><pre class="oac_no_warn" dir="ltr">*初始化选择描述符数组。*存储SELV和SELS中选择列表值和名称*缓冲区的地址，SELI中指示符*值缓冲区的地址，以及SELM中* select-list name缓冲区的最大长度。 DO 100 J = 1，SELN CALL SQLADR（SELVB（1，J），SELV（J））CALL SQLADR（SELSB（1，J），SELS（J））CALL SQLADR（SELIV（J），SELI（J）） SELM（J）= 5 100 CONTINUE *初始化绑定描述符数组。*存储BNDV和BNDS中绑定变量值和名称*缓冲区的地址，BNDI和BNDX中指示符*值和名称缓冲区的地址，以及* BNDM和BNDY中占位符和指示符名称缓冲区的最大*长度。 DO 200 J = 1，BNDN CALL SQLADR（BNDVB（1，J），BNDV（J））CALL SQLADR（BNDSB（1，J），BNDS（J））CALL SQLADR（BNDIV（J），BNDI（J）） CALL SQLADR（BNDXB（1，J），BNDX（J））BNDM（J）= 5 BNDY（J）= 5 200续......
</pre><p><a href="implementing-dynamic-SQL-method-4.html#GUID-A2645DC1-65F4-4FAC-8CCD-931ED3D56EE1__BCEHCBFH">图4-3</a>和<a href="implementing-dynamic-SQL-method-4.html#GUID-A2645DC1-65F4-4FAC-8CCD-931ED3D56EE1__BCEGIIGF">图4-4</a>表示结果描述符。
                        </p>
                        <div class="figure" id="GUID-A2645DC1-65F4-4FAC-8CCD-931ED3D56EE1__BCEHCBFH">
                           <p class="titleinfigure">图4-3初始化选择描述符</p><img src="img/image006.gif" width="505" alt="下面是图4-3的描述" title="下面是图4-3的描述" longdesc="img_text/image006.html"><br><a href="img_text/image006.html">“图4-3初始化选择描述符”的描述</a></div>
                        <!-- class="figure" -->
                        <div class="figure" id="GUID-A2645DC1-65F4-4FAC-8CCD-931ED3D56EE1__BCEGIIGF">
                           <p class="titleinfigure">图4-4初始化的绑定描述符</p><img src="img/image007.gif" width="505" alt="下面是图4-4的描述" title="下面是图4-4的描述" longdesc="img_text/image007.html"><br><a href="img_text/image007.html">“图4-4初始化绑定描述符”的描述</a></div>
                        <!-- class="figure" -->
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ZZFOR298"></a><div class="props_rev_3"><a id="GUID-BB746DB8-AA6A-4704-BFA2-1632EBAABE9B" name="GUID-BB746DB8-AA6A-4704-BFA2-1632EBAABE9B"></a><h4 id="ZZFOR-GUID-BB746DB8-AA6A-4704-BFA2-1632EBAABE9B" class="sect4"><span class="enumeration_section">4.6.5</span>将查询文本存储在主机字符串中</h4>
                  <div>
                     <div class="section">
                        <p>继续我们的示例，您提示用户输入SQL语句，然后将输入字符串存储在SELSTM中，如下所示：</p><pre class="oac_no_warn" dir="ltr">WRITE（*，1900）1900 FORMAT（'输入查询：'）READ（*，2000）SELSTM 2000 FORMAT（A120）</pre><p>我们假设用户输入以下字符串：</p><pre class="oac_no_warn" dir="ltr">SELECT ENAME，EMPNO，COMM from EMP WHERE COMM &lt;：BONUS</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ZZFOR299"></a><div class="props_rev_3"><a id="GUID-8921CF66-66BC-48A0-A494-29B05E4F23CC" name="GUID-8921CF66-66BC-48A0-A494-29B05E4F23CC"></a><h4 id="ZZFOR-GUID-8921CF66-66BC-48A0-A494-29B05E4F23CC" class="sect4"><span class="enumeration_section">4.6.6</span>从主机字符串中预处理查询</h4>
                  <div>
                     <div class="section">
                        <p>PREPARE解析SQL语句并为其命名。在我们的示例中，PREPARE解析主机字符串SELSTM并为其指定名称DYNSTMT，如下所示：</p><pre class="oac_no_warn" dir="ltr">EXEC SQL PREPARE DYNSTMT来自：SELSTM</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ZZFOR300"></a><div class="props_rev_3"><a id="GUID-6B031F91-41B9-4938-9F8A-388CDF7A1355" name="GUID-6B031F91-41B9-4938-9F8A-388CDF7A1355"></a><h4 id="ZZFOR-GUID-6B031F91-41B9-4938-9F8A-388CDF7A1355" class="sect4"><span class="enumeration_section">4.6.7</span> DECLARE一个游标</h4>
                  <div>
                     <div class="section">
                        <p>DECLARE CURSOR通过为游标指定名称并将其与特定的SELECT语句相关联来定义游标。</p>
                        <p>要为<span class="italic">静态</span>查询声明游标，请使用以下语法：</p><pre class="oac_no_warn" dir="ltr">EXEC SQL DECLARE cursor_name CURSOR FOR SELECT ...
</pre><p>要为<span class="italic">动态</span>查询声明游标，请将PREPARE指定给动态查询的语句名称替换为静态查询。在我们的示例中，DECLARE CURSOR定义了一个名为EMPCUR的游标，并将其与DYNSTMT关联，如下所示：</p><pre class="oac_no_warn" dir="ltr">用于DYNSTMT的EXEC SQL DECLARE EMPCUR CURSOR</pre><p><span class="bold">注意</span> ：您必须为所有动态SQL语句声明游标，而不仅仅是查询。对于非查询，OPENing游标执行动态SQL语句。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ZZFOR302"></a><a id="ZZFOR301"></a><div class="props_rev_3"><a id="GUID-636AC966-249E-4DE4-8037-70DB30AF47CA" name="GUID-636AC966-249E-4DE4-8037-70DB30AF47CA"></a><h4 id="ZZFOR-GUID-636AC966-249E-4DE4-8037-70DB30AF47CA" class="sect4"><span class="enumeration_section">4.6.8</span>描述绑定变量</h4>
                  <div>
                     <div class="section">
                        <p>DESCRIBE BIND VARIABLES将绑定变量的描述放入绑定描述符中。在我们的示例中，DESCRIBE准备BND如下：</p><pre class="oac_no_warn" dir="ltr">执行SQL描述DYNSTMT到BND的绑定变量</pre><p>DESCRIBE BIND VARIABLES语句必须遵循PREPARE语句，但必须在OPEN语句之前。</p>
                        <p><a href="implementing-dynamic-SQL-method-4.html#GUID-636AC966-249E-4DE4-8037-70DB30AF47CA__BCEEIBJC">图4-5</a>显示了DESCRIBE之后的示例中的绑定描述符。请注意，DESCRIBE已将BNDF设置为在已处理的SQL语句中找到的实际占位符数。
                        </p>
                        <div class="figure" id="GUID-636AC966-249E-4DE4-8037-70DB30AF47CA__BCEEIBJC">
                           <p class="titleinfigure">图4-5 DESCRIBE后的绑定描述符</p><img src="img/image008.gif" width="505" alt="下面是图4-5的描述" title="下面是图4-5的描述" longdesc="img_text/image008.html"><br><a href="img_text/image008.html">“图4-5 DESCRIBE后绑定描述符”的描述</a></div>
                        <!-- class="figure" -->
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ZZFOR303"></a><div class="props_rev_3"><a id="GUID-B17605EE-E49F-49DA-95BF-0CFA4CECAF65" name="GUID-B17605EE-E49F-49DA-95BF-0CFA4CECAF65"></a><h4 id="ZZFOR-GUID-B17605EE-E49F-49DA-95BF-0CFA4CECAF65" class="sect4"><span class="enumeration_section">4.6.9</span>重置占位符数</h4>
                  <div>
                     <div class="section">
                        <p>接下来，您必须将最大占位符数重置为DESCRIBE实际找到的数字，如下所示：</p><pre class="oac_no_warn" dir="ltr">BNDN = BNDF</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ZZFOR305"></a><a id="ZZFOR304"></a><div class="props_rev_3"><a id="GUID-300AB525-1530-43A6-AA0A-2E642276526B" name="GUID-300AB525-1530-43A6-AA0A-2E642276526B"></a><h4 id="ZZFOR-GUID-300AB525-1530-43A6-AA0A-2E642276526B" class="sect4"><span class="enumeration_section">4.6.10</span>获取绑定变量的值</h4>
                  <div>
                     <div class="section">
                        <p>您的程序必须在SQL语句中获取绑定变量的值。程序如何获取值取决于您。例如，它们可以是硬编码，从文件读取或交互式输入。</p>
                        <p>在我们的示例中，必须将值赋给bind变量，该变量将替换查询的WHERE子句中的占位符BONUS。提示用户输入值，然后按如下方式处理：</p><pre class="oac_no_warn" dir="ltr">CHARACTER * 1 COLON COLON ='：'*在DESCRIBE之后，BNDN被设置为等于BNDF。 DO 500 J = 1，BNDN *提示用户输入绑定变量的值。WRITE（*，10200）（BNDSB（K，J），K = 1，BNDC（J）），COLON 10200 FORMAT（1X，'为'输入值，6A1）*获取绑定变量的值。READ（*，10300）（BNDVB（K，J），K = 1,10）10300格式（10A1）*通过向后扫描第一个*非空白字符来查找值的长度。DO 200 K = 1,10 IF（BNDVB（BNDL（J），J）。NE。 ''）GOTO 300 BNDL（J）= BNDL（J） -  1 200 CONTINUE *将绑定变量的数据类型设置为VARCHAR2（代码1），并将*指示符变量设置为NOT NULL。 300 BNDT（J）= 1 BNDIV（J）= 0 500 CONTINUE</pre><p>假设用户为BONUS提供了值625， <a href="implementing-dynamic-SQL-method-4.html#GUID-300AB525-1530-43A6-AA0A-2E642276526B__BCEJEDFF">图4-6</a>显示了生成的绑定描述符。
                        </p>
                        <div class="figure" id="GUID-300AB525-1530-43A6-AA0A-2E642276526B__BCEJEDFF">
                           <p class="titleinfigure">图4-6分配值后的绑定描述符</p><img src="img/image009.gif" width="505" alt="下面是图4-6的描述" title="下面是图4-6的描述" longdesc="img_text/image009.html"><br><a href="img_text/image009.html">“图4-6分配值后绑定描述符”的描述</a></div>
                        <!-- class="figure" -->
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ZZFOR306"></a><div class="props_rev_3"><a id="GUID-9E5FA85D-FE7F-4A37-9186-6FD3E7CC3E25" name="GUID-9E5FA85D-FE7F-4A37-9186-6FD3E7CC3E25"></a><h4 id="ZZFOR-GUID-9E5FA85D-FE7F-4A37-9186-6FD3E7CC3E25" class="sect4"><span class="enumeration_section">4.6.11</span>打开光标</h4>
                  <div>
                     <div class="section">
                        <p>动态查询的OPEN语句类似于静态查询的语句，除了游标与绑定描述符相关联。在运行时确定并存储在由绑定描述符数组的元素寻址的缓冲区中的值用于评估SQL语句。通过查询，这些值还用于标识活动集。</p>
                        <p>在我们的示例中，OPEN将EMPCUR与BND关联如下：</p><pre class="oac_no_warn" dir="ltr">EXEC SQL OPEN EMPCUR使用DESCRIPTOR BND</pre><p>请记住，BND <span class="italic">不得</span>以冒号为前缀。
                        </p>
                        <p>然后，OPEN执行SQL语句。通过查询，OPEN还可以识别活动集并将光标定位在第一行。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ZZFOR308"></a><a id="ZZFOR307"></a><div class="props_rev_3"><a id="GUID-3B0C152B-50D4-4F36-BF07-AB9AB8DF9616" name="GUID-3B0C152B-50D4-4F36-BF07-AB9AB8DF9616"></a><h4 id="ZZFOR-GUID-3B0C152B-50D4-4F36-BF07-AB9AB8DF9616" class="sect4"><span class="enumeration_section">4.6.12</span>描述选择列表</h4>
                  <div>
                     <div class="section">
                        <p>如果动态SQL语句是查询，则DESCRIBE SELECT LIST语句必须遵循OPEN语句，并且必须在FETCH语句之前。</p>
                        <p>DESCRIBE SELECT LIST将选择列表项的描述放入选择描述符中。在我们的示例中，DESCRIBE准备SEL如下：</p><pre class="oac_no_warn" dir="ltr">执行SQL描述DYNSTMT进入SEL的选择列表</pre><p>访问Oracle数据字典时，DESCRIBE设置每个选择列表值的长度和数据类型。</p>
                        <p><a href="implementing-dynamic-SQL-method-4.html#GUID-3B0C152B-50D4-4F36-BF07-AB9AB8DF9616__BCEBJIHH">图4-7</a>显示了DESCRIBE之后的示例中的选择描述符。请注意，DESCRIBE已将SELF设置为查询选择列表中找到的实际项目数。如果SQL语句不是查询，则SELF设置为零。
                        </p>
                        <p>另请注意，NUMBER长度尚不可用。对于定义为NUMBER的列，必须使用库子例程SQLPRC来提取精度和比例。请参阅“强制数据类型”部分。</p>
                        <div class="figure" id="GUID-3B0C152B-50D4-4F36-BF07-AB9AB8DF9616__BCEBJIHH">
                           <p class="titleinfigure">图4-7 DESCRIBE后的选择描述符</p><img src="img/image010.gif" width="505" alt="下面是图4-7的描述" title="下面是图4-7的描述" longdesc="img_text/image010.html"><br><a href="img_text/image010.html">“图4-7 DESCRIBE后选择描述符”的描述</a></div>
                        <!-- class="figure" -->
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ZZFOR309"></a><div class="props_rev_3"><a id="GUID-688A91E6-44FB-41F4-923D-209D80485336" name="GUID-688A91E6-44FB-41F4-923D-209D80485336"></a><h4 id="ZZFOR-GUID-688A91E6-44FB-41F4-923D-209D80485336" class="sect4"><span class="enumeration_section">4.6.13</span>重置选择列表项的数量</h4>
                  <div>
                     <div class="section">
                        <p>接下来，您必须将选择列表项的最大数量重置为DESCRIBE实际找到的数字，如下所示：</p><pre class="oac_no_warn" dir="ltr">SELN = SELF</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ZZFOR311"></a><a id="ZZFOR310"></a><div class="props_rev_3"><a id="GUID-FCD1F34D-364B-44BF-8C1A-B3C76013A863" name="GUID-FCD1F34D-364B-44BF-8C1A-B3C76013A863"></a><h4 id="ZZFOR-GUID-FCD1F34D-364B-44BF-8C1A-B3C76013A863" class="sect4"><span class="enumeration_section">4.6.14</span>重置每个选择列表项的长度/数据类型</h4>
                  <div>
                     <div class="section">
                        <p>在我们的示例中，在获取select-list值之前，重置length和datatype数组中的一些元素以用于显示目的。</p><pre class="oac_no_warn" dir="ltr">DO 500 J = 1，SELN *清零/非空位。CALL SQLNUL（SELT（J），DATYPE，NULLOK）SELT（J）= DATYPE *如果数据类型为NUMBER，则提取精度和比例。IF（SELT（J）。NE。 2）GOTO 400 CALL SQLPRC（卖（J），PREC，SCALE）*允许最大精度。IF（PREC。NE。 0）GOTO 200 *尽管最大精度为38，但我们使用10因为*是我们的缓冲区大小。卖出（J）= 10 GOTO 400 200继续卖出（J）= PREC *允许可能的符号和小数点。卖出（J）=卖出（J）+ 2 *如果超过缓冲区大小，则调整长度。此*适用于字符和数字数据。400 IF（卖出（J）。GT。 10）卖出（J）= 10 *将数据类型强制转换为VARCHAR2。SELT（J）= 1 500续</pre><p><a href="implementing-dynamic-SQL-method-4.html#GUID-FCD1F34D-364B-44BF-8C1A-B3C76013A863__BCEDFHBG">图4-8</a>显示了结果选择描述符。请注意，NUMBER长度现在可用，并且所有数据类型都是VARCHAR2。卖出（2）和卖出（3）的长度分别为6和9，因为我们将DESCRIBEd长度4和7增加了2，以允许可能的符号和小数点。
                        </p>
                        <div class="infoboxnote" id="GUID-FCD1F34D-364B-44BF-8C1A-B3C76013A863__GUID-EB5CC87F-1B66-4EF2-AB80-5AED7CA1F914">
                           <p class="notep1">注意：</p>
                           <p>当DESCRIBE返回的数据类型代码为2（NUMBER）时，必须将其强制转换为兼容的FORTRAN类型。FORTRAN类型不必是CHARACTER。例如，您可以通过将SELT（J）设置为4，并将SELL（J）设置为系统上REAL的长度，将NUMBER强制转换为REAL。</p>
                        </div>
                        <div class="figure" id="GUID-FCD1F34D-364B-44BF-8C1A-B3C76013A863__BCEDFHBG">
                           <p class="titleinfigure">图4-8 FETCH前的选择描述符</p><img src="img/image011.gif" width="505" alt="下面是图4-8的描述" title="下面是图4-8的描述" longdesc="img_text/image011.html"><br><a href="img_text/image011.html">“图4-8 FETCH前选择描述符”的描述</a></div>
                        <!-- class="figure" -->
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ZZFOR312"></a><div class="props_rev_3"><a id="GUID-57C5EFD2-DDAB-4AFA-A134-493EAA4C16D0" name="GUID-57C5EFD2-DDAB-4AFA-A134-493EAA4C16D0"></a><h4 id="ZZFOR-GUID-57C5EFD2-DDAB-4AFA-A134-493EAA4C16D0" class="sect4"><span class="enumeration_section">4.6.15</span>来自激活集的FETCH行</h4>
                  <div>
                     <div class="section">
                        <p>FETCH从活动集返回一行，将select-list值存储在数据缓冲区中，并将光标前进到活动集中的下一行。如果没有更多行，FETCH将SQLCA中的SQLCDE，SQLCODE变量或SQLSTATE变量设置为“无数据找到”Oracle错误代码。在以下示例中，FETCH将列ENAME，EMPNO和COMM的值返回给SEL：</p><pre class="oac_no_warn" dir="ltr">使用DESCRIPTOR SEL执行SQL FETCH EMPCUR</pre><p><a href="implementing-dynamic-SQL-method-4.html#GUID-044B22E3-8BBA-46B6-868A-A512198B9C9D__BCEEIDBC">图4-9</a>显示了FETCH之后的示例中的选择描述符。请注意，Oracle已将select-list和指示符值存储在SELV和SELI元素所寻址的数据缓冲区中。</p>
                        <p>对于数据类型1的输出缓冲区，Oracle使用存储在SELL中的长度，左对齐CHAR或VARCHAR2数据，并右对齐NUMBER数据。</p>
                        <p>从“EMP表”中的VARCHAR2（10）列检索值“MARTIN”。使用SELL（1）中的长度，Oracle左对齐10字节字段中的值，填充缓冲区。</p>
                        <p>从NUMBER（4）列检索值7654并强制转换为“7654”。但是，SELL（2）中的长度增加了2以允许可能的符号和小数点，因此Oracle右对齐6字节字段中的值。</p>
                        <p>从NUMBER（7,2）列中检索值482.50并强制为“482.50”。同样，SELL（3）中的长度增加了2，因此Oracle右对齐9字节字段中的值。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ZZFOR313"></a><div class="props_rev_3"><a id="GUID-8130FCF8-8D1F-4D88-8E4A-4574D8F725C1" name="GUID-8130FCF8-8D1F-4D88-8E4A-4574D8F725C1"></a><h4 id="ZZFOR-GUID-8130FCF8-8D1F-4D88-8E4A-4574D8F725C1" class="sect4"><span class="enumeration_section">4.6.16</span>获取和处理选择列表值</h4>
                  <div>
                     <div class="section">
                        <p>在FETCH之后，您的程序可以处理FETCH返回的选择列表值。在我们的示例中，处理了ENAME，EMPNO和COMM列的值。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ZZFOR315"></a><a id="ZZFOR314"></a><div class="props_rev_3"><a id="GUID-044B22E3-8BBA-46B6-868A-A512198B9C9D" name="GUID-044B22E3-8BBA-46B6-868A-A512198B9C9D"></a><h4 id="ZZFOR-GUID-044B22E3-8BBA-46B6-868A-A512198B9C9D" class="sect4"><span class="enumeration_section">4.6.17</span>关闭光标</h4>
                  <div>
                     <div class="section">
                        <p>CLOSE禁用光标。在我们的示例中，CLOSE禁用EMPCUR，如下所示：</p><pre class="oac_no_warn" dir="ltr">EXEC SQL CLOSE EMPCUR</pre><div class="figure" id="GUID-044B22E3-8BBA-46B6-868A-A512198B9C9D__BCEEIDBC">
                           <p class="titleinfigure">图4-9 FETCH后选择描述符</p><img src="img/image012.gif" width="505" alt="下面是图4-9的描述" title="下面是图4-9的描述" longdesc="img_text/image012.html"><br><a href="img_text/image012.html">“图4-9 FETCH后选择描述符”的描述</a></div>
                        <!-- class="figure" -->
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="ZZFOR316"></a><div class="props_rev_3"><a id="GUID-36D43855-12A0-45AC-A1B1-F4B932F7D23A" name="GUID-36D43855-12A0-45AC-A1B1-F4B932F7D23A"></a><h3 id="ZZFOR-GUID-36D43855-12A0-45AC-A1B1-F4B932F7D23A" class="sect3"><span class="enumeration_section">4.7</span>使用方法4的主机阵列</h3>
               <div>
                  <div class="section">
                     <p>要使用方法4使用输入或输出主机阵列，必须使用可选的FOR子句告诉Oracle主机阵列的大小。有关FOR子句的更多信息，请参阅<a href="../zzpre/using-host-arrays.html#ZZPRE-GUID-67713341-6FF8-4FF6-B5A7-C390A2B0B802" target="_blank">关于使用FOR子句</a> 。
                     </p>
                     <p>设置第J个选择列表项或绑定变量的描述符条目，但SELV（J）或BNDV（J）不是寻址单个数据缓冲区，而是寻址数据缓冲区数组的第一个元素。然后根据需要在EXECUTE或FETCH语句中使用FOR子句，以告知Oracle要处理的表元素的数量。</p>
                     <p>此过程是必要的，因为Oracle无法了解主机ARRAY的大小。</p>
                     <p>在以下示例中，输入主机数组用于从EMP表中删除行。请注意，EXECUTE可用于方法4的非查询。</p><pre class="oac_no_warn" dir="ltr">*使用方法4的主机阵列。程序DYN4HA EXEC SQL开始声明部分字符* 20 UID字符* 20 PWD字符* 60 STMT INTEGER * 4 SIZE EXEC SQL END DECLARE部分EXEC SQL包含SQLCA字符* 10个字符（5）INTEGER * 2个数字（5）INTEGER * 2 DEPTS （5）EXEC SQL包含BNDDSC EXEC SQL SQLERNROR GOTO 9000 UID ='SCOTT'PWD ='TIGER'*登录Oracle。EXEC SQL CONNECT：UID标识者：PWD WRITE（*，10000）10000格式（'连接到Oracle'）SIZE = 5 STMT ='INSERT INTO EMP（EMPNO，ENAME，DEPTNO）1 VALUES（：E，：N，： D）'*准备并描述SQL语句。EXEC SQL PREPARE S FROM：STMT BNDN = 3 EXEC SQL DESCRIBE BIND VARIABLES FOR S INTO BND *初始化绑定描述符项。BNDN = BNDF CALL SQLADR（NUMBERS（1），BNDV（1））BNDL（1）= 2 BNDT（1）= 3 BNDI（1）= 0 *％REF用于传递数据的地址，而不是* FORTRAN编译器生成的* CHARACTER变量NAMES的描述符。 （请参阅本章前面的“使用* SQLADR”一节。）CALL SQLADR（％REF（NAMES（1）），BNDV（2））BNDL（2）= 10 BNDT（2）= 1 BNDI（2）= 0 CALL SQLADR（DEPTS（1），BNDV（3））BNDL（ 3）= 2 BNDT（3）= 3 BNDI（3）= 0 DO 110 I = 1，SIZE BNDM（I）= 0 BNDY（I）= 0 BNDX（I）= 0 110 CONTINUE *填充数据缓冲区。通常，这些数据将由用户以交互方式输入，或从*文件中读取。NAMES（1）='TRUSDALE'NUMBERS（1）= 1014 DEPTS（1）= 30 NAMES（2）='WILKES'NUMBERS（2）= 1015 DEPTS（2）= 30 NAMES（3）='BERNSTEIN'NUMBERS（ 3）= 1016 DEPTS（3）= 30个名字（4）='FRAZIER'数字（4）= 1017 DEPTS（4）= 30个名字（5）='MCCOMB'NUMBERS（5）= 1018 DEPTS（5）= 30 *执行INSERT。 WRITE（*，10020）10020 FORMAT（1X，'增加销售力......'）EXEC SQL FOR：SIZE EXECUTE S使用DESCRIPTOR BND EXEC SQL COMMIT RELEASE GOTO 150 *此处如果发生SQLERROR。9000 CONTINUE WRITE（*，10030）SQLEMC 10030格式（1X，70A1）EXEC SQL WHENEVER SQLERROR CONTINUE EXEC SQL ROLLBACK RELEASE *此时准备退出程序。150 CONTINUE STOP END</pre></div>
                  <!-- class="section" -->
               </div>
            </div><a id="ZZFOR317"></a><div class="props_rev_3"><a id="GUID-B67BC85D-505C-491A-B210-F34A86561E3F" name="GUID-B67BC85D-505C-491A-B210-F34A86561E3F"></a><h3 id="ZZFOR-GUID-B67BC85D-505C-491A-B210-F34A86561E3F" class="sect3"><span class="enumeration_section">4.8</span>示例程序10：动态SQL方法4</h3>
               <div>
                  <p>此程序显示使用动态SQL方法4所需的基本步骤。登录到Oracle后，程序会提示用户输入SQL语句，PREPARE语句，DECLAREs游标，使用DESCRIBE BIND检查任何绑定变量，打开游标，以及DESCRIBE任何选择列表项。如果输入的SQL语句是查询，程序会对每行数据进行FETCH，然后关闭光标。请注意，VARCHAR用于存储动态SQL语句。</p><pre class="oac_no_warn" dir="ltr">PROGRAM DYN4 EXEC SQL BEGIN DECLARE SECTION CHARACTER * 20 UID CHARACTER * 20 PWD VARCHAR * 1024 STMT，STMTL，STMTA EXEC SQL END DECLARE SECTION CHARACTER * 1 ANS EXEC SQL包含SQLCA EXEC SQL包含BNDDSC EXEC SQL包含SELDSC * INITIALIZE。 CALL INIT *登录ORACLE。 10 PRINT *，'ENTER USERNAME：'READ'（20A）'，UID PRINT *，'ENTER PASSWORD：'READ'（20A）'，PWD EXEC SQL WHENEVER SQLERROR GOTO 8500 EXEC SQL CONNECT：UID IDENTIFIED BY：PWD EXEC SQL WHEREVER SQLERROR GOTO 9000 PRINT *，1'TO EXIT，TYPE NULL SQL STATEMENT（;）在DSQL PROMPT。 *从USER获取SQL语句。 100继续致电GETSQL（STMTA，STMTL）IF（STMTL。EQ。 0）GOTO 9500 *准备SQL语句，并为其声明一个游标。 EXEC SQL PREPARE S FROM：用于S *的STMT EXEC SQL DECLARE C CURSOR描述了绑定变量。首先，初始化BNDN到*可以描述的最大变量数量。 BNDN = 20 EXEC SQL描述用于进入BND IF的BIND变量（BNDF。GE。 0）GOTO 125 PRINT *，'太多的变量 - 再试一次......'GOTO 300 *已经描述了各种变量。获取任何* BIND VARIABLES的值。 125 BNDN = BNDF IF（BNDN。GT。 0）CALL GETBND * OPEN CURSOR执行SQL语句。 EXEC SQL OPEN C使用DESCRIPTOR BND *描述选择列表项目。首先，初始化选择可以描述的最大数量的项目。 SELN = 20 EXEC SQL描述选择列表以进入SEL IF（自我。GE。 0）GOTO 150 PRINT *，'太多选择列表项目。再试一次...'GOTO 300 *已经描述了选择列表。如果这是一个选择声明，*重置已设定值的长度和数据，并输出*列标题。 150 SELN = SELF IF（SELN。EQ。 0）转到300呼叫PRCOLH *每个行，并打印它。 EXEC SQL WHENEVER未找到GOTO 300 200 EXEC SQL FETCH C使用DESCRIPTOR SEL CALL PRROW GOTO 200 *没有更多行（未找到行）或非选择*语句已完成。 300 EXEC SQL CLOSE C IF（SELN。EQ。 0）GOTO 310 *有一些选择列表项，所以SQL语句*必须是一个选择。 PRINT *，SQLERD（3），'ROW（S）SELECTED'。 GOTO 100 *没有选择列表项，所以SQL语句*不能是一个选择。 310 PRINT *，SQLERD（3），'ROW（S）PROCESSED'。 GOTO 100 *发生了SQL执行错误（SQLERROR）。 * CONNECT ERROR 8500 PRINT'（70A1）'，SQLEMC PRINT *，'再试一次（是或否）？'READ'（A1）'，ANS IF（（ANS。EQ。 'Y'）。要么。 （ANS。EQ。 'Y'））GOTO 10 GOTO 9500 *其他SQL错误9000 PRINT'（70A1）'，SQLEMC GOTO 100 *现在准备退出程序。 9500 EXEC SQL WHENEVER SQLERROR CONTINUE EXEC SQL COMMIT WORK RELEASE PRINT *，'有一个好日子'。 9600续表********************************************* ********** * NAME：INIT（INITIALIZE）*功能：初始化绑定和选择描述符。 *退货：无********************************************** *********** SUBROUTINE INIT EXEC SQL包含BNDDSC EXEC SQL包含SELDSC *初始化绑定描述符项目。 DO 100 I = 1，20 CALL SQLADR（BNDSB（1，I），BNDS（I））CALL SQLADR（BNDVB（1，I），BNDV（I））CALL SQLADR（BNDXB（1，I），BNDX（I） ））CALL SQLADR（BNDIV（I），BNDI（I））BNDM（I）= 30 BNDY（I）= 30 100 CONTINUE * INITIALIZE SELECT DESCRIPTOR ITEMS。 DO 200 I = 1，20 CALL SQLADR（SELSB（1，I），SELS（I））CALL SQLADR（SELVB（1，I），SELV（I））CALL SQLADR（SELIV（I），SELI（I）） SELM（I）= 30 200 CONTINUE RETURN END **************************************** ***************** *名称：GETSQL（从终端获取SQL语句）*功能：要求用户在SQL语句中键入。 *退货：SARR是一个包含* SQL语句的字符串（逻辑* 1）。 SLEN是SARR中的*字符数。如果SLEN为0，那么没有* SQL语句被输入（DSQL使用此*表示用户想要注销）。************************************************** ******* SUBROUTINE GETSQL（SARR，SLEN）逻辑* 1 SARR（1）INTEGER * 2 SLEN LOGICAL * 1 INP（80）INTEGER INPL INTEGER CNTLIN CNTLIN = 0 SLEN = 0 PRINT *，'DSQL&gt;'50 READ'（80A1）'，（INP（I），I = 1,80）*通过向后扫描*第一个非空白字符来查找SQL语句的长度。 INPL = 80 DO 100 I = 1,80 IF（INP（INPL）。NE。 ''）GOTO 150 INPL = INPL  -  1 100 CONTINUE *将SQL语句的这一部分移动到SQL语句* BUFFER。 150 CONTINUE DO 200 I = 1，INPL SLEN = SLEN + 1 IF（SLEN。GT。 1024）GOTO 1000 SARR（SLEN）= INP（I）200 CONTINUE IF（SARR（SLEN）。EQ。 ';'）GOTO 1000 * LINE未被';'终止。请求续行。 CNTLIN = CNTLIN + 1 WRITE（*，10300）CNTLIN 10300格式（'$'，I5，'：'）SLEN = SLEN + 1 IF（SLEN。GT。 1024）GOTO 1000 SARR（SLEN）=''GOTO 50 1000 CONTINUE SLEN = SLEN  -  1返回结束**************************** ***************************** *名称：PRCOLH（打印栏目标题）*功能：在SELECT * DESCRIPTOR中重置长度和数据库阵列，和打印列*标题列表*选项列表项目。 *注意：例如：给出声明* *选择TNAME，TABTYPE来自TAB * *并且假设TNAME列是30个字符*宽和TABTYPE列是7个字符宽，* PRCOLH PRINTS：* * TNAME TABTYPE * ----- ------------------------ ------- ******************* ************************************** SUBROUTINE PRCOLH EXEC SQL包含SELDSC LOGICAL * 1行（132 ）INTEGER LINESZ INTEGER PREC，SCALE，NULLOK INTEGER * 2 DATYPE PREC = 26 SCALE = 0 LINESZ = 132 L = 0 DO 500 I = 1，SELN * SQLPRC用于从*长度提取精度和尺度（卖出（I） ）。* SQLNUL用于重置DATATYPE *的高阶位，并检查列是否为空。 * CHAR DATATYPES有长度，但零精度和*规模。这个长度是在创造时间定义的。 *如果在创建时定义*，则数字数据表具有精度和比例。但是，如果列定义*只是数字，精度和标度是零，*因此我们将列宽度限定为10。*正确的合理栏目为数字。 CALL SQLNUL（SELT（I），DATYPE，NULLOK）SELT（I）= DATYPE IF（SELT（I）。NE。 2）GOTO 150 CALL SQLPRC（卖（I），PREC，SCALE）*如果没有精确，使用默认值。 IF（PREC。EQ。 0）PREC = 10卖出（I）= PREC * ADD 2用于可能的标志和DECIMAL POINT。出售（I）=卖出（I）+ 2 * BLANK-PAD COLUMN NAME-JUSTIFY COLUMN HEADING。 NBLANKS =卖出（I） -  SELC（I）DO 130 J = 1，NBLANKS L = L + 1 IF（L。GT。 LINESZ  -  1）GOTO 450 LINE（L）=''130继续GOTO 190 *检查长柱，并设置数据缓冲区*长度为240。150 IF（SELT（I）。NE。 8）GOTO 153卖出（I）= 240 GOTO 190 *检查长列，并设置数据缓冲区*长度为240。153 IF（SELT（I）。NE。 24）GOTO 155卖出（I）= 240 GOTO 190 *检查ROWID COLUMN，并设置数据缓冲区*长度为18（显示长度）。155 IF（SELT（I）。NE。 11）GOTO 160卖出（I）= 18 GOTO 190 *检查日期列，并将数据缓冲区长度*设置为9（默认格式为DD-MON-YY）。160 IF（SELT（I）。NE。 12）GOTO 165卖出（I）= 9 GOTO 190 *检查原始列，并添加1到数据缓冲区长度。 165 IF（SELT（I）。NE。 23）GOTO 190卖出（I）=卖出（I）+ 1 *复制栏名称输出线。 190 DO 200 J = 1，MIN（SELC（I），卖出（I））L = L + 1 IF（L。GT。 LINESZ  -  1）GOTO 450 LINE（L）= SELSB（J，I）200 CONTINUE * PAD COLUMN NAME BLANKS PLUS 1 FOR INTER-COLUMN * SPACING。注意，数字列是正确的*只需要一个空白就可以进行列间距离。 NBLANKS = 1 IF（SELT（I）。EQ。 2）GOTO 210 NBLANKS = MAX（卖出（I） -  SELC（I）+ 1,1）210 DO 300 J = 1，NBLANKS L = L + 1 IF（L。GT。 LINESZ  -  1）GOTO 450 LINE（L）=''300 CONTINUE *除了长列，COOLCE COLUMN * DATATYPE到VARCHAR2以简化印刷行。 450 IF（SELT（I）。NE。 24）SELT（I）= 1 500 CONTINUE *现在准备打印HEADING LINE。 1000 WRITE（*，10100）（LINE（I），I = 1，L）10100 FORMAT（/，1X，132A1）*列出列标题。 L = 0 DO 1500 I = 1，SELN NUNDER =卖出（I）DO 1250 J = 1，NUNDER L = L + 1 IF（L。GT。 LINESZ  -  1）GOTO 2000 LINE（L）=' - '1250 CONTINUE L = L + 1 IF（L。GT。 LINESZ  -  1）GOTO 2000 LINE（L）=''1500 CONTINUE *现在准备打印下线。 2000 WRITE（*，10200）（LINE（I），I = 1，L）10200 FORMAT（1X，132A1）返回结束********************** ************************************姓名：PRROW（PRINT ROW）*功能：打印单个刀具行。 ************************************************** ******* SUBROUTINE PRROW EXEC SQL包含SELDSC逻辑* 1行（132）INTEGER LINESZ LINESZ = 132 L = 0 DO 500 I = 1，SELN *检查空列。 IF NULL，BLANK-PAD COLUMN。如果（SELIV（I）。GE。 0）GOTO 100 DO 90 J = 1，卖出（I）L = L + 1 IF（L。GT。 LINESZ  -  1）GOTO 1000 LINE（L）=''90 CONTINUE GOTO 250 * COLUMN DATATYPE是VARCHAR2。将列值复制到*输出行。 100 CONTINUE DO 200 J = 1，卖出（I）L = L + 1 IF（L。GT。 LINESZ  -  1）GOTO 1000 LINE（L）= SELVB（J，I）200 CONTINUE *附加一个空白用于列间距。 250续L = L + 1 IF（L。GT。 LINESZ  -  1）GOTO 1000 LINE（L）=''500 CONTINUE *现在准备打印线。 1000 WRITE（*，10100）（LINE（I），I = 1，L）10100 FORMAT（1X，132A1）返回结束********************** ************************************姓名：GETBND（获得各种变量）*功能：使用描述符BND，设置*描述的变量声明，* GETBND为用户提供绑定*变量的值。 *退货：BNDVB和BNDL ARRAYS设置为值*用于绑定变量。 ************************************************** ******* SUBROUTINE GETBND EXEC SQL包含BNDDSC字符* 1 CLN，SPC CLN ='：'SPC =''WRITE（*，10100）10100格式（/，'请输入绑定变量的值。'，/ ）DO 500 I = 1，BNDN WRITE（*，10200）（BNDSB（J，I），J = 1，BNDC（I）），CLN，SPC 10200格式（'输入值为'，32A1）*获得值BIND VARIABLE。 READ'（80A1）'，（BNDVB（J，I），J = 1,80）*通过向前扫描*找到第一个非空白字符的值的长度。 BNDL（I）= 80 DO 200 J = 1,80 IF（BNDVB（BNDL（I），I）。NE。 ''）GOTO 300 BNDL（I）= BNDL（I） -  1 200 CONTINUE *将变量的数据类型设置为VARCHAR2，并设置*指示变量为非空。 300 CONTINUE BNDT（I）= 1 BNDIV（I）= 0 500 CONTINUE RETURN END</pre></div>
            </div>
         </div>
      </article>
   </body>
</html>