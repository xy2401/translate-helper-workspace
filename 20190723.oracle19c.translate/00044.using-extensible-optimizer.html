<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>使用可扩展优化器</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Data Cartridge Developer&#39;s Guide"></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Data Cartridge Developer&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="data-cartridge-developers-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-10T07:34:53-08:00"></meta>
      <meta name="dcterms.title" content="Data Cartridge Developer&#39;s Guide"></meta>
      <meta name="dcterms.dateCopyrighted" content="1996, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96431-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="defining-operators.html" title="Previous" type="text/html"></link>
      <link rel="next" href="using-cartridge-services.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="ADDCI"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="defining-operators.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="using-cartridge-services.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">数据盒式开发人员指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="building-data-cartridges.html" property="item" typeof="WebPage"><span property="name">构建数据磁带</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">使用可扩展优化器</li>
            </ol>
            <a id="GUID-7E1BFCFC-9C05-4CC6-9E4F-B1B1212DBE84" name="GUID-7E1BFCFC-9C05-4CC6-9E4F-B1B1212DBE84"></a><a id="ADDCI2110"></a>
            
            <h2 id="ADDCI-GUID-7E1BFCFC-9C05-4CC6-9E4F-B1B1212DBE84" class="sect2"><span class="enumeration_chapter">10</span>使用可扩展优化器</h2>
         </header>
         <div class="ind">
            <div>
               <p>您可以使用Oracle Database可扩展优化器来优化SQL语句执行。描述了优化概念，统计，选择性，成本分析，谓词排序以及优化器的依赖模型。</p>
            </div><a id="ADDCI4552"></a><div class="props_rev_3"><a id="GUID-75924AC7-A489-4533-AE4E-25C4BF631B84" name="GUID-75924AC7-A489-4533-AE4E-25C4BF631B84"></a><h3 id="ADDCI-GUID-75924AC7-A489-4533-AE4E-25C4BF631B84" class="sect3"><span class="enumeration_section">10.1</span>查询优化概述</h3>
               <div>
                  <p><span class="bold">查询优化</span>是选择执行SQL语句的最有效方法的过程。<a href="defining-operators.html#GUID-E10C1C49-E5DA-45E9-959D-E203DD964FBF">定义运算符中</a>讨论的可扩展索引功能引入了用户定义的访问方法。
                  </p>
                  <p>可扩展优化器功能允许用户定义函数和索引的作者创建统计信息收集，选择性和成本函数，优化程序在选择查询计划时使用这些函数。优化器成本模型扩展为集成用户提供的信息以评估CPU和I / O成本，其中CPU成本是使用的机器指令数，I / O成本是获取的数据块数。</p>
                  <p>具体来说，您可以执行以下计算。</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>将成本函数和默认成本与域索引（分区或非分区），索引类型，包和独立函数相关联。优化器可以获得扫描域索引，多个域索引分区或整个索引的单个分区的成本。</p>
                     </li>
                     <li>
                        <p>将选择性函数和缺省选择性与对象类型，包函数和独立函数的方法相关联。优化程序可以估计单个分区，多个分区或查询中涉及的整个表的用户定义的选择性。</p>
                     </li>
                     <li>
                        <p>将统计信息收集功能与域索引和表列相关联。优化器可以在域索引或表的分区级别和对象级别收集用户定义的统计信息。</p>
                     </li>
                     <li>
                        <p>使用基于成本的函数对谓词进行排序。</p>
                     </li>
                     <li>
                        <p>根据访问开销为表选择用户定义的访问方法（域索引）。</p>
                     </li>
                     <li>
                        <p>使用<code class="codeph">DBMS_STATS</code>包调用用户定义的统计信息收集和删除功能。
                        </p>
                     </li>
                     <li>
                        <p>使用新数据字典视图包含有关与列，域索引，索引类型或函数关联的统计信息收集，成本或选择性函数的信息。</p>
                     </li>
                     <li>
                        <p>添加提示以保留函数谓词的评估顺序。</p>
                     </li>
                  </ul>
                  <p>请注意，只有基于成本的优化器已得到增强; Oracle没有改变基于规则的优化器的操作。</p>
                  <p>优化器为SQL查询和DML语句<code class="codeph">SELECT</code> ， <code class="codeph">INSERT</code> ， <code class="codeph">UPDATE</code>或<code class="codeph">DELETE</code>生成执行计划。为简单起见，我们描述了根据<code class="codeph">SELECT</code>语句生成执行计划，但DML语句的过程类似。
                  </p>
                  <p>执行计划包括用于在每个表的访问方法<code class="codeph">FROM</code>子句中的表中，和一个排序，叫做连接顺序， <code class="codeph">FROM</code>子句。系统定义的访问方法包括索引，散列簇和表扫描。优化器通过生成一组连接顺序或排列来选择计划，方法是计算每个连接顺序或排列，然后选择成本最低的过程。对于连接顺序中的每个表，优化程序计算每种可能的访问方法和连接方法的开销，并选择成本最低的方法。连接顺序的成本是访问方法和连接方法成本的总和。使用包含成本模型的算法计算成本。成本模型包括有关执行查询的物理环境的不同详细程度。
                  </p>
                  <p>优化程序使用有关查询中引用的对象的统计信息来计算选择性和成本。使用<code class="codeph">DBMS_STATS</code>包收集统计信息。谓词的选择性是谓词选择的表中行的比例，它是介于<code class="codeph">0</code>和<code class="codeph">1</code>之间的数字。
                  </p>
                  <p>可扩展索引功能允许用户定义新的运算符，索引类型和域索引。对于用户定义的运算符和域索引，可扩展优化器功能使您可以控制优化程序使用的三个主要组件，以选择执行计划统计信息，选择性和成本。</p>
                  <div class="infoboxnotealso" id="GUID-75924AC7-A489-4533-AE4E-25C4BF631B84__GUID-32FFE5BE-F617-462B-9B26-F0895E34E10D">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/addci&amp;id=CNCPT-GUID-A42A6EF0-20F8-4F4B-AFF7-09C100AE581E" target="_blank"><span class="variable" translate="no">Oracle Database Concepts</span></a> ，介绍优化</p>
                        </li>
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/addci&amp;id=TDPPT-GUID-FED9A6D8-49BB-43BE-9F4D-336E6006D366" target="_blank"><span class="variable" translate="no">Oracle Database 2 Day + Performance Tuning Guide</span></a> ，了解有关在SQL语句中使用提示的信息</p>
                        </li>
                        <li>
                           <p>有关<code class="codeph">DBMS_STATS</code>信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/addci&amp;id=ARPLS-GUID-01FAB8ED-E4A3-4C3E-8FE2-88717DCDDA06" target="_blank"><span class="italic">Oracle Database PL / SQL包和类型参考</span></a></p>
                        </li>
                     </ul>
                  </div>
               </div><a id="ADDCI4553"></a><div class="props_rev_3"><a id="GUID-2EB73B6D-3AE1-4B00-BFD0-D07BBF6E54B7" name="GUID-2EB73B6D-3AE1-4B00-BFD0-D07BBF6E54B7"></a><h4 id="ADDCI-GUID-2EB73B6D-3AE1-4B00-BFD0-D07BBF6E54B7" class="sect4"><span class="enumeration_section">10.1.1</span>统计</h4>
                  <div>
                     <p>可以使用<code class="codeph">DBMS_STATS</code>包生成表和索引的统计信息。通常，统计信息越准确，优化程序生成的执行计划就越好。
                     </p>
                  </div><a id="ADDCI4554"></a><div class="props_rev_3"><a id="GUID-926A97D8-A664-42BB-AA75-A39F94582054" name="GUID-926A97D8-A664-42BB-AA75-A39F94582054"></a><h5 id="ADDCI-GUID-926A97D8-A664-42BB-AA75-A39F94582054" class="sect5"><span class="enumeration_section">10.1.1.1</span>用户定义的统计信息</h5>
                     <div>
                        <p>Extensible Optimizer功能允许您为域索引，索引类型，数据类型，单个表列和分区定义<span class="italic">统计信息收集</span>功能。这意味着无论何时分析域索引，都会调用用户指定的统计信息收集功能。数据库不知道用户收集的统计信息的表示和含义。
                        </p>
                        <p>除了域索引之外，Oracle还支持表的各个列以及用户定义的数据类型的用户定义的统计信息收集功能。在前一种情况下，无论何时分析列，除了数据库收集的任何标准统计信息之外，还会调用用户定义的统计信息收集功能来收集统计信息。如果存在数据类型的统计信息收集功能，则会为正在分析的具有所需类型的表的每列调用该函数。</p>
                        <p>评估用户定义函数的成本取决于算法及其参数的统计属性。为所有可能用作所有函数的参数的列的所有可能组合存储统计信息是不切实际的。因此，Oracle仅维护各列的统计信息。功能成本也可能取决于每个参数的不同统计特性。每列可能需要对每个适用函数的每个参数位置进行统计。Oracle不支持这种统计和成本函数的扩散，因为它会降低性能。</p>
                        <p>只要存在用户定义的统计信息收集功能，就需要用户定义的丢弃统计信息的功能。</p>
                     </div>
                  </div><a id="ADDCI4555"></a><div class="props_rev_3"><a id="GUID-2F5A858A-E73C-4FED-99D4-B715536E1814" name="GUID-2F5A858A-E73C-4FED-99D4-B715536E1814"></a><h5 id="ADDCI-GUID-2F5A858A-E73C-4FED-99D4-B715536E1814" class="sect5"><span class="enumeration_section">10.1.1.2</span>分区对象的用户定义统计信息</h5>
                     <div>
                        <p>使用系统管理的本地域索引时，必须实现ODCIStats接口的两个方法： <a href="extensible-optimizer-interface.html#GUID-6FE88952-A3B9-40B3-8A49-BF0D548C7EE6">ODCIStatsExchangePartition（）</a>和<a href="extensible-optimizer-interface.html#GUID-E3185A04-24BD-43C8-A2EC-76DDF78188A2">ODCIStatsUpdPartStatistics（）</a> 。
                        </p>
                     </div>
                  </div>
               </div><a id="ADDCI4556"></a><div class="props_rev_3"><a id="GUID-D1C3674F-605A-43B6-BBD2-BF37803FA8B2" name="GUID-D1C3674F-605A-43B6-BBD2-BF37803FA8B2"></a><h4 id="ADDCI-GUID-D1C3674F-605A-43B6-BBD2-BF37803FA8B2" class="sect4"><span class="enumeration_section">10.1.2</span>选择性</h4>
                  <div>
                     <p>优化程序使用统计信息来计算谓词的选择性。选择性是谓词选择的表或分区中行的比例。它是介于<code class="codeph">0</code>和<code class="codeph">1</code>之间的数字。谓词的选择性用于估计特定访问方法的成本;它还用于确定最佳连接顺序。优化程序对连接顺序的不良选择可能导致非常昂贵的执行计划。
                     </p>
                     <p>目前，优化器使用标准算法来估计选择和连接谓词的选择性。但是，在谓词包含函数或类型方法的情况下，该算法并不总是有效。此外，谓词可以包含优化程序没有任何信息的用户定义的运算符。在这种情况下，优化器无法计算准确的选择性。</p>
                  </div><a id="ADDCI4558"></a><a id="ADDCI4557"></a><div class="props_rev_3"><a id="GUID-A1009F29-C62F-4A53-B870-F438DD3B9796" name="GUID-A1009F29-C62F-4A53-B870-F438DD3B9796"></a><h5 id="ADDCI-GUID-A1009F29-C62F-4A53-B870-F438DD3B9796" class="sect5"><span class="enumeration_section">10.1.2.1</span>用户定义的选择性</h5>
                     <div>
                        <p>为了更好地控制优化程序的选择性估计，此功能允许您为包含用户定义的运算符，独立函数，包函数或类型方法的谓词指定用户定义的选择性函数。只要遇到带有<a href="using-extensible-optimizer.html#GUID-A1009F29-C62F-4A53-B870-F438DD3B9796__CHDFFJIB">示例10-1中</a>所示形式之一的谓词，优化程序就会调用用户定义的选择性函数：</p>
                        <p>对于这种情况，用户可以定义与<code class="codeph">operator(...)</code>关联的选择性函数。<code class="codeph">operator</code>的参数可以是列，常量，绑定变量或属性引用。当优化器遇到这样的谓词时，它调用用户定义的选择函数并将整个谓词作为参数传递（包括运算符，函数或类型方法及其参数，关系运算符<code class="codeph">relational_operator</code> ，以及常量表达式或绑定变量） 。用户定义的选择性函数的返回值必须表示为百分比，并且介于0和100之间（包括0和100）;优化程序忽略此范围之外的值。
                        </p>
                        <p>只要有可能，优化程序使用用户定义的选择性值。但是，在以下情况下，这是不可能的：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>用户定义的选择性函数返回无效值（小于<code class="codeph">0</code>或大于<code class="codeph">100</code> ）。
                              </p>
                           </li>
                           <li>
                              <p>没有为谓词中的运算符，函数或方法定义用户定义的选择性函数。</p>
                           </li>
                           <li>
                              <p>谓词没有<a href="using-extensible-optimizer.html#GUID-A1009F29-C62F-4A53-B870-F438DD3B9796__CHDFFJIB">例10-1中</a>列出的形式之一;它也可以是<code class="codeph">operator(...) + 3 relational_operator</code> <span class="italic"><code class="codeph">constant</code></span> 。
                              </p>
                           </li>
                        </ul>
                        <p>在每种情况下，优化程序都使用启发式方法来估计选择性。</p>
                        <div class="example" id="GUID-A1009F29-C62F-4A53-B870-F438DD3B9796__CHDFFJIB">
                           <p class="titleinexample">示例10-1触发对优化程序调用的三种谓词表单</p><pre class="oac_no_warn" dir="ltr">operator（...）relational_operator <span class="italic">常量</span> <span class="italic">constantal_operator</span>运算符（...）运算符（...）像<span class="italic">常数一样</span></pre><p>哪里</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><code class="codeph">operator(...)</code>是用户定义的运算符，独立函数，包函数或类型方法，</p>
                              </li>
                              <li>
                                 <p><code class="codeph">relational_operator</code>是<code class="codeph">{&lt;, &lt;=, =, &gt;=, &gt;}</code> ，和</p>
                              </li>
                              <li>
                                 <p><span class="italic"><code class="codeph">constant</code></span>是常量值表达式或绑定变量。
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="example" -->
                     </div>
                  </div>
               </div><a id="ADDCI4559"></a><div class="props_rev_3"><a id="GUID-E5800EC1-1300-449D-8FE6-536796F54B3E" name="GUID-E5800EC1-1300-449D-8FE6-536796F54B3E"></a><h4 id="ADDCI-GUID-E5800EC1-1300-449D-8FE6-536796F54B3E" class="sect4"><span class="enumeration_section">10.1.3</span>成本</h4>
                  <div>
                     <p>优化器估计选择最佳计划的各种访问路径的成本。例如，它计算使用索引和全表扫描的CPU和I / O成本，以便在两者之间进行选择。但是，优化器不知道域索引的内部存储结构，因此无法计算域索引成本的良好估计。</p>
                  </div><a id="ADDCI4560"></a><div class="props_rev_3"><a id="GUID-AC9EF1A1-7519-4EDF-8ADE-5F0E5051A6CE" name="GUID-AC9EF1A1-7519-4EDF-8ADE-5F0E5051A6CE"></a><h5 id="ADDCI-GUID-AC9EF1A1-7519-4EDF-8ADE-5F0E5051A6CE" class="sect5"><span class="enumeration_section">10.1.3.1</span>用户定义的成本</h5>
                     <div>
                        <p>为了获得更大的灵活性，已扩展成本模型，以便为域索引，索引分区和用户定义的独立函数，包函数和类型方法定义成本。用户定义的成本可以是优化程序查找的默认成本的形式，也可以是优化程序调用以计算成本的完整成本函数。</p>
                        <p>与用户定义的选择性统计信息一样，用户定义的成本统计信息是可选如果没有可用的用户定义成本，则优化程序使用启发式算法来计算估计值。然而，在缺乏关于用户定义的域索引和函数中的存储结构的足够有用信息的情况下，这样的估计可能非常不准确并且导致选择次优执行计划。</p>
                        <p>仅当域索引是用户定义的运算符的有效访问路径时，优化程序才会调用用户定义的域索引的成本函数。仅当谓词具有<a href="using-extensible-optimizer.html#GUID-A1009F29-C62F-4A53-B870-F438DD3B9796__CHDFFJIB">示例10-1中</a>概述的形式之一时，才会调用用户定义的函数，方法和域索引的成本函数，这与用户定义的选择性函数的条件相同。
                        </p>
                        <p>用户定义的成本函数可以返回三个成本值，每个值表示<span class="italic">单个</span>执行函数或域索引实现的成本：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">CPU</code> - 函数或域索引实现执行的机器周期数。这不包括调用函数的开销。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">I/O</code> - 函数或域索引实现读取的数据块数。对于域索引，这不包括对Oracle表的访问。多块I / O因子不会传递给用户定义的成本函数。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">NETWORK</code> - 传输的数据块数。这对分布式查询，函数和域索引实现有效。对于Oracle，此成本组件未使用，因此被忽略;但是，用户需要规定一个值，以确保向后兼容性。
                              </p>
                           </li>
                        </ul>
                        <p>优化程序根据这些成本值计算复合成本。</p>
                        <p><code class="codeph">DBMS_ODCI</code>包包含一个函数<code class="codeph">estimate_cpu_units</code>以帮助从输入中获取CPU和I / O开销，其中包括用户函数的已用时间。 <code class="codeph">estimate_cpu_units</code>通过将经过的时间乘以机器的处理器速度来测量CPU单位，并返回与用户函数关联的近似CPU指令数。对于多处理器机器， <code class="codeph">estimate_cpu_units</code>考虑单个处理器的速度。
                        </p>
                        <p>查询的成本是成本值的函数。优化程序初始化参数的设置确定要最小化的成本。如果<code class="codeph">optimizer_mode</code>是<code class="codeph">first_rows</code> ，则返回单行的资源成本最小化，优化程序模式将传递给用户定义的成本函数。否则，返回所有行的资源成本最小化。
                        </p>
                     </div>
                  </div>
               </div>
            </div><a id="ADDCI4563"></a><a id="ADDCI4561"></a><div class="props_rev_3"><a id="GUID-90DC8855-4A40-480F-B574-4D82A227B4F4" name="GUID-90DC8855-4A40-480F-B574-4D82A227B4F4"></a><h3 id="ADDCI-GUID-90DC8855-4A40-480F-B574-4D82A227B4F4" class="sect3"><span class="enumeration_section">10.2</span>定义统计，选择性和成本函数</h3>
               <div>
                  <p>您可以为域索引和列计算和存储用户定义的统计信息。用户定义的函数和域索引的选择性和成本函数可以在计算中使用标准和用户定义的统计信息。Oracle无需了解这些统计信息的内部表示，但您必须提供其收集方法。您自行负责定义此类统计信息的表示以及维护这些统计信息。请注意，用户收集的统计信息仅由用户定义的选择性和成本函数使用;优化程序仅使用其标准统计信息。</p>
                  <p>必须在用户定义的类型中定义用户定义的统计信息收集，选择性和成本函数。根据您希望它支持的功能，此类型必须实现在<a href="extensible-optimizer-interface.html#GUID-2B314B88-73C1-49A0-9A74-1AB99B20FA94">可扩展优化器接口</a>中的系统接口<code class="codeph">ODCIStats</code> ，Oracle数据盒式磁带接口统计信息中定义的部分或全部功能的方法。
                  </p>
                  <p><a href="using-extensible-optimizer.html#GUID-FD862D70-F067-467B-B426-FF83D60AFABE__CHDCFDCF">例10-2</a>显示了实现<code class="codeph">ODCIStats</code>接口中所有函数的类型定义（或一个大纲）。
                  </p>
                  <p>您定义的对象类型（称为<span class="bold">统计类型）</span>无需实现<code class="codeph">ODCIStats</code>所有函数。用户定义的统计信息收集，选择性和成本函数是可选的，因此统计信息类型可能只包含<code class="codeph">ODCIStats</code>的一部分函数。<a href="using-extensible-optimizer.html#GUID-90DC8855-4A40-480F-B574-4D82A227B4F4__G1006880" title="列出与不同类型的架构对象关联的类型方法和默认统计信息">表10-1</a>总结了与不同类型的架构对象关联的类型方法和默认统计信息。
                  </p>
                  <div class="tblformal" id="GUID-90DC8855-4A40-480F-B574-4D82A227B4F4__G1006880">
                     <p class="titleintable">表10-1各种模式对象的统计方法和缺省统计信息</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="各种模式对象的统计方法和默认统计信息" width="100%" border="1" summary="Lists the type methods and default statistics associated with different kinds of schema objects" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="24%" id="d30475e851">协会统计</th>
                              <th align="left" valign="bottom" width="56%" id="d30475e854">统计类型使用的方法</th>
                              <th align="left" valign="bottom" width="19%" id="d30475e857">默认统计</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="24%" id="d30475e862" headers="d30475e851 ">
                                 <p>柱</p>
                              </td>
                              <td align="left" valign="top" width="56%" headers="d30475e862 d30475e854 ">
                                 <p><a href="extensible-optimizer-interface.html#GUID-227ABB3C-6218-4AA9-BC1C-D963EE800D87">ODCIStatsCollect（）</a> ， <a href="extensible-optimizer-interface.html#GUID-294738F4-65B1-4272-BBD6-686F2E38B9C2">ODCIStatsDelete（）</a></p>
                              </td>
                              <td align="left" valign="top" width="19%" headers="d30475e862 d30475e857 ">
                                 <p></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="24%" id="d30475e877" headers="d30475e851 ">
                                 <p>对象类型</p>
                              </td>
                              <td align="left" valign="top" width="56%" headers="d30475e877 d30475e854 ">
                                 <p><a href="extensible-optimizer-interface.html#GUID-227ABB3C-6218-4AA9-BC1C-D963EE800D87">ODCIStatsCollect（）</a> ， <a href="extensible-optimizer-interface.html#GUID-294738F4-65B1-4272-BBD6-686F2E38B9C2">ODCIStatsDelete（）</a> ， <a href="extensible-optimizer-interface.html#GUID-B13AA56D-ABAF-431A-BAED-006B8331DCE1">ODCIStatsFunctionCost（）</a> ， <a href="extensible-optimizer-interface.html#GUID-4CEECA5F-099A-4558-A50C-FD856A814CF3">ODCIStatsSelectivity（）</a></p>
                              </td>
                              <td align="left" valign="top" width="19%" headers="d30475e877 d30475e857 ">
                                 <p>成本，选择性</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="24%" id="d30475e901" headers="d30475e851 ">
                                 <p>功能</p>
                              </td>
                              <td align="left" valign="top" width="56%" headers="d30475e901 d30475e854 ">
                                 <p><a href="extensible-optimizer-interface.html#GUID-B13AA56D-ABAF-431A-BAED-006B8331DCE1">ODCIStatsFunctionCost（）</a> ， <a href="extensible-optimizer-interface.html#GUID-4CEECA5F-099A-4558-A50C-FD856A814CF3">ODCIStatsSelectivity（）</a></p>
                              </td>
                              <td align="left" valign="top" width="19%" headers="d30475e901 d30475e857 ">
                                 <p>成本，选择性</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="24%" id="d30475e917" headers="d30475e851 ">
                                 <p>包</p>
                              </td>
                              <td align="left" valign="top" width="56%" headers="d30475e917 d30475e854 ">
                                 <p><a href="extensible-optimizer-interface.html#GUID-B13AA56D-ABAF-431A-BAED-006B8331DCE1">ODCIStatsFunctionCost（）</a> ， <a href="extensible-optimizer-interface.html#GUID-4CEECA5F-099A-4558-A50C-FD856A814CF3">ODCIStatsSelectivity（）</a></p>
                              </td>
                              <td align="left" valign="top" width="19%" headers="d30475e917 d30475e857 ">
                                 <p>成本，选择性</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="24%" id="d30475e933" headers="d30475e851 ">
                                 <p>指数</p>
                              </td>
                              <td align="left" valign="top" width="56%" headers="d30475e933 d30475e854 ">
                                 <p><a href="extensible-optimizer-interface.html#GUID-227ABB3C-6218-4AA9-BC1C-D963EE800D87">ODCIStatsCollect（）</a> ， <a href="extensible-optimizer-interface.html#GUID-294738F4-65B1-4272-BBD6-686F2E38B9C2">ODCIStatsDelete（）</a> ， <a href="extensible-optimizer-interface.html#GUID-158EC3A8-CB48-48B2-9405-198BA0FDD777">ODCIStatsIndexCost（）</a></p>
                              </td>
                              <td align="left" valign="top" width="19%" headers="d30475e933 d30475e857 ">
                                 <p>成本</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="24%" id="d30475e953" headers="d30475e851 ">
                                 <p>INDEXTYPE</p>
                              </td>
                              <td align="left" valign="top" width="56%" headers="d30475e953 d30475e854 ">
                                 <p><a href="extensible-optimizer-interface.html#GUID-227ABB3C-6218-4AA9-BC1C-D963EE800D87">ODCIStatsCollect（）</a> ， <a href="extensible-optimizer-interface.html#GUID-294738F4-65B1-4272-BBD6-686F2E38B9C2">ODCIStatsDelete（）</a> ， <a href="extensible-optimizer-interface.html#GUID-158EC3A8-CB48-48B2-9405-198BA0FDD777">ODCIStatsIndexCost（）</a> ， <a href="extensible-optimizer-interface.html#GUID-E3185A04-24BD-43C8-A2EC-76DDF78188A2">ODCIStatsUpdPartStatistics（）</a> ， <a href="extensible-optimizer-interface.html#GUID-6FE88952-A3B9-40B3-8A49-BF0D548C7EE6">ODCIStatsExchangePartition（）</a></p>
                              </td>
                              <td align="left" valign="top" width="19%" headers="d30475e953 d30475e857 ">
                                 <p>成本</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <p>统计类型方法的参数类型是系统定义的ODCI数据类型。这些在<a href="extensible-optimizer-interface.html#GUID-2B314B88-73C1-49A0-9A74-1AB99B20FA94">可扩展优化器接口</a>中描述。
                  </p>
                  <p>选择性和成本函数不得更改任何数据库或包状态。因此，在选择性和成本函数中不允许SQL DDL或DML操作。如果存在此类操作，则优化程序不会调用这些函数。</p>
               </div><a id="ADDCI4562"></a><div class="props_rev_3"><a id="GUID-FD862D70-F067-467B-B426-FF83D60AFABE" name="GUID-FD862D70-F067-467B-B426-FF83D60AFABE"></a><h4 id="ADDCI-GUID-FD862D70-F067-467B-B426-FF83D60AFABE" class="sect4"><span class="enumeration_section">10.2.1</span>定义统计类型</h4>
                  <div>
                     <div class="example" id="GUID-FD862D70-F067-467B-B426-FF83D60AFABE__CHDCFDCF">
                        <p class="titleinexample">示例10-2定义统计类型</p><pre class="oac_no_warn" dir="ltr">CREATE TYPE my_statistics AS OBJECT（ - 获取当前接口的函数FUNCTION ODCIGetInterfaces（ifclist OUT ODCIObjectList）RETURN NUMBER， - 用户定义的统计函数FUNCTION ODCIStatsCollect（col ODCIColInfo，options ODCIStatsOptions，statistics OUT RAW，env ODCIEnv）返回编号，功能ODCIStatsCollect（ia ODCIIndexInfo，options ODCIStatsOptions，statistics OUT RAW，env ODCIEnv）RETURN NUMBER，FUNCTION ODCIStatsDelete（col ODCIColInfo，statistics OUT RAW，env ODCIEnv）RETURN NUMBER，FUNCTION ODCIStatsDelete（ia ODCIIndexInfo，statistics OUT RAW，env ODCIEnv）RETURN NUMBER， - 用户定义的本地域索引的统计函数FUNCTION ODCIStatsUpdPartStatistics（ia ODCIIndexInfo，palistODCIPartInfoList，env ODCIEnv）RETURN NUMBER; FUNCTION ODCIStatsExchangePartition（ia ODCIIndexInfo，ia1 ODCIIndexInfo，env ODCIEnv）RETURN NUMBER;  - 用户定义的选择函数FUNCTION ODCIStatsSelectivity（ pred ODCIPredInfo，s el OUT NUMBER，args ODCIArgDescList，start &lt;function_return_type&gt;，stop &lt;function_return_type&gt;，&lt;list of functions arguments&gt;，env ODCIEnv）RETURN NUMBER， - 用户定义的函数和类型方法的成本函数FUNCTION ODCIStatsFunctionCost（func ODCIFuncInfo，cost OUT ODCICost，args ODCIArgDescList，&lt;函数参数列表&gt;）RETURN NUMBER， - 域索引的用户定义成本函数FUNCTION ODCIStatsIndexCost（ia ODCIIndexInfo，sel NUMBER，cost OUT ODCICost，qi ODCIQueryInfo，pred ODCIPredInfo，args ODCIArgDescList，start &lt;operator_return_type &gt;，停止&lt;operator_return_type&gt;，&lt;运算符值参数列表&gt;，env ODCIEnv）返回数字）</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADDCI4564"></a><div class="props_rev_3"><a id="GUID-249361C5-22D2-4DB0-8DA6-5235BF84FC3A" name="GUID-249361C5-22D2-4DB0-8DA6-5235BF84FC3A"></a><h4 id="ADDCI-GUID-249361C5-22D2-4DB0-8DA6-5235BF84FC3A" class="sect4"><span class="enumeration_section">10.2.2</span>用户定义的统计函数</h4>
                  <div>
                     <p>有两个用户定义的统计信息收集功能，一个用于收集统计信息，另一个用于删除统计信息。</p>
                     <p>第一个， <code class="codeph">ODCIStatsCollect()</code> ，用于收集用户定义的统计信息;它的接口取决于是否正在分析列索引或域索引。在分析表或域索引的列时调用它并采用两个参数：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>正在分析的列的<code class="codeph">col</code> ，或者正在分析的域索引的<code class="codeph">ia</code> ;</p>
                        </li>
                        <li>
                           <p><code class="codeph">DBMS_STATS</code>包中指定的<code class="codeph">options</code>的选项。
                           </p>
                        </li>
                     </ul>
                     <p>如上所述，数据库不解释<code class="codeph">ODCIStatsCollect()</code>收集的统计信息。对于系统管理的域索引统计信息，您不返回<code class="codeph">ODCIStatsCollect()</code>收集的统计信息。您应该以用户管理的格式存储这些统计信息，如<a href="using-extensible-optimizer.html#GUID-D987A267-CC07-44A4-9753-786493389B7C">生成系统管理域索引的</a>统计信息中所述， <a href="using-extensible-optimizer.html#GUID-09C1B9E4-4294-450A-BE31-79CC9F82C2A6__CHDHAHFD">如图10-1</a> ， <a href="using-extensible-optimizer.html#GUID-725CC8C9-C99D-45DC-82B9-1D6237DB605D__CHDEHGJA">图10-2</a>和<a href="using-extensible-optimizer.html#GUID-1595D5D4-D81C-4A28-A892-51D9388B7CC9__CHDICHBJ">图10-3所示</a> 。
                     </p>
                     <p>通过调用<code class="codeph">ODCIStatsDelete()</code>函数删除用户收集的统计信息，该函数的接口取决于是否删除了列索引或域索引的统计信息。它需要一个参数： <code class="codeph">col</code> ，用于必须删除其用户定义统计信息的列，或者<code class="codeph">ia</code> ，用于要删除其统计信息的域索引。
                     </p>
                     <p>如果统计类型中存在用户定义的<code class="codeph">ODCIStatsCollect()</code>函数，则还必须存在相应的<code class="codeph">ODCIStatsDelete()</code>函数。
                     </p>
                     <p><code class="codeph">ODCIStatsCollect()</code>和<code class="codeph">ODCIStatsDelete()</code>函数的返回值必须是<code class="codeph">Success</code> ， <code class="codeph">Error</code>或<code class="codeph">Warning</code> ;这些返回值在系统包<code class="codeph">ODCIConst</code>中定义。
                     </p>
                     <div class="infoboxnotealso" id="GUID-249361C5-22D2-4DB0-8DA6-5235BF84FC3A__GUID-D670309A-901C-4088-AD3D-E317946BE42A">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="extensible-optimizer-interface.html#GUID-227ABB3C-6218-4AA9-BC1C-D963EE800D87">ODCIStatsCollect（）</a></p>
                           </li>
                           <li>
                              <p><a href="extensible-optimizer-interface.html#GUID-294738F4-65B1-4272-BBD6-686F2E38B9C2">ODCIStatsDelete（）</a></p>
                           </li>
                           <li>
                              <p></p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="ADDCI4566"></a><a id="ADDCI4567"></a><a id="ADDCI4568"></a><a id="ADDCI4565"></a><div class="props_rev_3"><a id="GUID-06490C53-A46D-4909-AC83-B1BB0B375AF8" name="GUID-06490C53-A46D-4909-AC83-B1BB0B375AF8"></a><h4 id="ADDCI-GUID-06490C53-A46D-4909-AC83-B1BB0B375AF8" class="sect4"><span class="enumeration_section">10.2.3</span>用户定义的选择性功能</h4>
                  <div>
                     <p>用户定义的选择性函数仅用于<a href="using-extensible-optimizer.html#GUID-A1009F29-C62F-4A53-B870-F438DD3B9796__CHDFFJIB">示例10-1中</a>列出的谓词形式。
                     </p>
                     <p>用户定义的选择函数<code class="codeph">ODCIStatsSelectivity()</code>接受五组描述谓词的输入参数：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">pred</code>参数描述了函数<code class="codeph">operator</code>和关系运算符<code class="codeph">relational_operator</code> 。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">args</code>参数描述函数的开始值和停止值（即&lt; <code class="codeph">constant</code> &gt;）以及函数的实际参数（ <code class="codeph">operator()</code> ）。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">start</code>参数的数据类型与函数返回值的数据类型相同，描述了函数的起始值。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">stop</code>参数的数据类型与函数返回值的数据类型相同，描述了函数的停止值。
                           </p>
                        </li>
                        <li>
                           <p>函数参数列表，其数量，位置和类型必须与函数<code class="codeph">operator</code>的参数匹配。
                           </p>
                        </li>
                     </ul>
                     <p>计算的选择性在输出参数<code class="codeph">sel</code>返回为<code class="codeph">0</code>到<code class="codeph">100</code> （包括）之间的数字，表示百分比。优化程序将小于<code class="codeph">0</code>或大于100的数字忽略为无效值。如果计算的选择性小于0.5％，则可以在输出参数<code class="codeph">sel</code>返回值<code class="codeph">0</code> 。选择性为<code class="codeph">0</code>并不意味着将删除谓词。
                     </p>
                     <p><code class="codeph">ODCIStatsSelectivity()</code>函数的返回值必须是<code class="codeph">Success</code> ， <code class="codeph">Error</code>或<code class="codeph">Warning</code> 。
                     </p>
                     <p>例如，考虑一个函数<code class="codeph">myFunction</code> ，如<a href="using-extensible-optimizer.html#GUID-06490C53-A46D-4909-AC83-B1BB0B375AF8__CHDIGBIH">例10-3中</a>所定义。
                     </p>
                     <p>用户定义的选择性函数<code class="codeph">ODCIStatsSelectivity()</code>在<a href="extensible-optimizer-interface.html#GUID-2B314B88-73C1-49A0-9A74-1AB99B20FA94">可扩展优化器接口中</a>有详细说明。
                     </p>
                     <p>如果使用文字参数调用<code class="codeph">myFunction()</code> ，例如<code class="codeph">myFunction(2, 'TEST') &gt; 5</code> ，那么在<a href="using-extensible-optimizer.html#GUID-06490C53-A46D-4909-AC83-B1BB0B375AF8__CHDEIGDJ">例10-4中</a>调用选择性函数。
                     </p>
                     <p>另一方面，如果使用一些非文字参数调用<code class="codeph">myFunction()</code> ，例如<code class="codeph">myFunction(Test_tab.col_a, 'TEST')&gt; 5</code> ，其中<code class="codeph">col_a</code>是表<code class="codeph">Test_tab</code>一列，则选择性函数被调用为<a href="using-extensible-optimizer.html#GUID-06490C53-A46D-4909-AC83-B1BB0B375AF8__CHDFHEJH">例10-5中</a>概述了。
                     </p>
                     <p>总之，start，stop和function参数值只有在它们是文字的情况下才会传递给选择性函数。否则它们是<code class="codeph">NULL</code> 。 <code class="codeph">ODCIArgDescList</code>描述了它<code class="codeph">ODCIArgDescList</code>所有参数。
                     </p>
                     <div class="example" id="GUID-06490C53-A46D-4909-AC83-B1BB0B375AF8__CHDIGBIH">
                        <p class="titleinexample">例10-3定义用户定义的函数</p><pre class="oac_no_warn" dir="ltr"><code class="codeph">myFunction</code> （NUMBER，b VARCHAR2（10））返回NUMBER</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-06490C53-A46D-4909-AC83-B1BB0B375AF8__CHDEIGDJ">
                        <p class="titleinexample">例10-4使用文字参数调用选择性函数</p><pre class="oac_no_warn" dir="ltr">ODCIStatsSelectivity（ <span class="italic">ODCIPredInfo_constructor</span> ，sel，O <span class="italic">DCIArgDescList_constructor</span> ，5，NULL，2，'TEST'， <span class="italic">ODCIEnv_flag</span> ）</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-06490C53-A46D-4909-AC83-B1BB0B375AF8__CHDFHEJH">
                        <p class="titleinexample">例10-5使用非文字参数调用选择性函数</p><pre class="oac_no_warn" dir="ltr">ODCIStatsSelectivity（ <span class="italic">ODCIPredInfo_constructor</span> ，sel， <span class="italic">ODCIArgDescList_constructor</span> ，5，NULL，NULL，'TEST'， <span class="italic">ODCIEnv_flag</span> ）</pre><div class="infoboxnotealso" id="GUID-06490C53-A46D-4909-AC83-B1BB0B375AF8__GUID-21BA8225-39BA-416D-ABF8-CA74F22ECCE2">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><a href="extensible-optimizer-interface.html#GUID-4CEECA5F-099A-4558-A50C-FD856A814CF3">ODCIStatsSelectivity（）</a></p>
                              </li>
                              <li>
                                 <p><a href="extensibility-constants-types-and-mappings.html#GUID-1A0380C1-2555-4910-8704-548CE1F4E166">ODCIArgDescList</a></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADDCI4570"></a><a id="ADDCI4571"></a><a id="ADDCI4569"></a><div class="props_rev_3"><a id="GUID-7A3F883B-E524-48DC-96AB-6D0A8BB56F79" name="GUID-7A3F883B-E524-48DC-96AB-6D0A8BB56F79"></a><h4 id="ADDCI-GUID-7A3F883B-E524-48DC-96AB-6D0A8BB56F79" class="sect4"><span class="enumeration_section">10.2.4</span>函数的用户定义成本函数</h4>
                  <div>
                     <p>用户定义的成本函数仅用于<a href="using-extensible-optimizer.html#GUID-A1009F29-C62F-4A53-B870-F438DD3B9796__CHDFFJIB">示例10-1中</a>列出的谓词形式。
                     </p>
                     <p>您可以定义一个函数<code class="codeph">ODCIStatsFunctionCost()</code> ，用于计算独立函数，包函数或类型方法的成本。此函数使用三组描述谓词的输入参数：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">func</code>参数描述了函数<code class="codeph">operator</code> 。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">args</code>参数描述函数<code class="codeph">operator</code>的实际参数。
                           </p>
                        </li>
                        <li>
                           <p>函数参数列表，其数量，位置和类型必须与函数<code class="codeph">operator</code>的参数匹配。
                           </p>
                        </li>
                     </ul>
                     <p><code class="codeph">ODCIStatsFunctionCost()</code>函数在<code class="codeph">cost</code>参数中返回其计算的<code class="codeph">cost</code> 。返回的成本可以包含两个组件，CPU成本和I / O成本，它们由优化器组合以计算复合成本。用户定义的成本函数返回的成本必须是正整数。优化程序将忽略无效值。
                     </p>
                     <p><code class="codeph">ODCIStatsFunctionCost()</code>函数的返回值必须是<code class="codeph">Success</code> ， <code class="codeph">Error</code>或<code class="codeph">Warning</code> 。
                     </p>
                     <p>考虑一个在<a href="using-extensible-optimizer.html#GUID-06490C53-A46D-4909-AC83-B1BB0B375AF8__CHDIGBIH">例10-3中</a>定义的<code class="codeph">myFunction()</code> 。
                     </p>
                     <p>用户定义的成本函数<code class="codeph">ODCIStatsFunctionCost()</code>在<a href="extensible-optimizer-interface.html#GUID-2B314B88-73C1-49A0-9A74-1AB99B20FA94">可扩展优化器接口中</a>有详细说明。
                     </p>
                     <p>如果使用文字参数调用<code class="codeph">myFunction()</code> ，例如<code class="codeph">myFunction(2, 'TEST') &gt; 5</code> ，其中<code class="codeph">col_a</code>是表<code class="codeph">Test_tab</code>一列，则在<a href="using-extensible-optimizer.html#GUID-7A3F883B-E524-48DC-96AB-6D0A8BB56F79__CHDGBEEI">示例10-6中</a>调用cost函数。
                     </p>
                     <p>另一方面，如果用非文字参数调用<code class="codeph">myFunction()</code> ，例如<code class="codeph">myFunction(Test_tab.col_a, 'TEST') &gt; 5</code> ，其中<code class="codeph">col_a</code>是表<code class="codeph">Test_tab</code>一列，则成本函数被调用为out在<a href="using-extensible-optimizer.html#GUID-7A3F883B-E524-48DC-96AB-6D0A8BB56F79__CHDFBFEI">例10-7中列出</a> 。
                     </p>
                     <p>总之，函数参数值只有在它们是文字时才会传递给成本函数;否则，它们是<code class="codeph">NULL</code> 。 <a href="extensibility-constants-types-and-mappings.html#GUID-1A0380C1-2555-4910-8704-548CE1F4E166">ODCIArgDescList</a>描述了它<a href="extensibility-constants-types-and-mappings.html#GUID-1A0380C1-2555-4910-8704-548CE1F4E166">后面的</a>所有参数。
                     </p>
                     <div class="example" id="GUID-7A3F883B-E524-48DC-96AB-6D0A8BB56F79__CHDGBEEI">
                        <p class="titleinexample">示例10-6使用文字参数调用成本函数</p><pre class="oac_no_warn" dir="ltr">ODCIStatsFunctionCost（ <span class="italic">ODCIFuncInfo_constructor</span> ，cost， <span class="italic">ODCIArgDescList_constructor</span> ，2，'TEST'， <span class="italic">ODCIEnv_flag</span> ）</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-7A3F883B-E524-48DC-96AB-6D0A8BB56F79__CHDFBFEI">
                        <p class="titleinexample">示例10-7使用非文字参数调用成本函数</p><pre class="oac_no_warn" dir="ltr">ODCIStatsFunctionCost（ <span class="italic">ODCIFuncInfo_constructor</span> ，cost， <span class="italic">ODCIArgDescList_constructor</span> ，NULL，'TEST'， <span class="italic">ODCIEnv_flag</span> ）</pre><div class="infoboxnotealso" id="GUID-7A3F883B-E524-48DC-96AB-6D0A8BB56F79__GUID-D55E86C1-C807-498A-9987-55778C966C62">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><a href="extensible-optimizer-interface.html#GUID-B13AA56D-ABAF-431A-BAED-006B8331DCE1">ODCIStatsFunctionCost（）</a></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADDCI4573"></a><a id="ADDCI4574"></a><a id="ADDCI4572"></a><div class="props_rev_3"><a id="GUID-D562A817-B4E6-4AB4-B5B9-6871D909BD06" name="GUID-D562A817-B4E6-4AB4-B5B9-6871D909BD06"></a><h4 id="ADDCI-GUID-D562A817-B4E6-4AB4-B5B9-6871D909BD06" class="sect4"><span class="enumeration_section">10.2.5</span>域索引的用户定义成本函数</h4>
                  <div>
                     <p>域索引的用户定义的成本函数用于前面提到的相同类型的谓词，除了<code class="codeph">operator</code>必须是存在有效域索引访问路径的用户定义的运算符。
                     </p>
                     <p><code class="codeph">ODCIStatsIndexCost()</code>函数接受以下参数集：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">ia</code>描述了域索引</p>
                        </li>
                        <li>
                           <p><code class="codeph">sel</code>表示谓词的用户计算选择性</p>
                        </li>
                        <li>
                           <p><code class="codeph">cost</code>给出计算的成本</p>
                        </li>
                        <li>
                           <p><code class="codeph">qi</code>包含有关查询的其他信息</p>
                        </li>
                        <li>
                           <p>描述谓词的<code class="codeph">pred</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">args</code>描述的启动和停止的值（即，&lt; <code class="codeph">constant</code>操作者&gt;）和实际的参数给操作者<code class="codeph">operator</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">start</code> ，其数据类型与运算符的返回值的数据类型相同，描述运算符的起始值</p>
                        </li>
                        <li>
                           <p><code class="codeph">stop</code>的数据类型与运算符返回值的数据类型相同，描述运算符的停止值</p>
                        </li>
                        <li>
                           <p>运算符值参数列表，其编号，位置和类型必须与运算<code class="codeph">operator</code>运算<code class="codeph">operator</code>的参数匹配。运算符的value参数是排除第一个参数的参数。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">env</code> ，由服务器设置的环境标志，用于指示在对同一例程进行多次调用的情况下正在进行哪个调用。该标志留作将来使用;目前它始终设置为<code class="codeph">0</code> 。
                           </p>
                        </li>
                     </ul>
                     <p>域索引的计算成本在输出参数<code class="codeph">cost</code>返回。
                     </p>
                     <p><code class="codeph">ODCIStatsIndexCost()</code>返回<code class="codeph">Success</code> ， <code class="codeph">Error</code>或<code class="codeph">Warning</code> 。
                     </p>
                     <p>考虑<a href="using-extensible-optimizer.html#GUID-D562A817-B4E6-4AB4-B5B9-6871D909BD06__CHDIGECH">例10-8中</a>定义的运算符，它返回<code class="codeph">1</code>或<code class="codeph">0</code>具体取决于字符串<code class="codeph">b_string</code>是否包含在字符串<code class="codeph">a_string</code> 。此外，假设运营商由域索引实现。
                     </p>
                     <p>用户定义的索引成本函数<code class="codeph">ODCIStatsIndexCost()</code>在<a href="extensible-optimizer-interface.html#GUID-2B314B88-73C1-49A0-9A74-1AB99B20FA94">可扩展优化器接口中</a>有详细说明。
                     </p>
                     <p>如果使用非文字参数调用<code class="codeph">contains()</code> ，例如<code class="codeph">Contains(Test_tab.col_c,'TEST') &lt;= 1</code> ，则在<a href="using-extensible-optimizer.html#GUID-D562A817-B4E6-4AB4-B5B9-6871D909BD06__CHDIDIDE">示例10-9中</a>调用索引成本函数。
                     </p>
                     <p>请注意， <code class="codeph">Contains</code>的第一个参数<code class="codeph">a_string</code>不会显示为<code class="codeph">ODCIStatsIndexCost()</code>的参数。这是因为运算符的第一个参数必须是要使用的域索引的列，并且此列信息通过<code class="codeph">ODCIIndexInfo</code>参数传入。只有第一个（值参数）之后的运算符参数必须作为<code class="codeph">ODCIStatsIndexCost()</code>函数的参数出现。
                     </p>
                     <p>总之，start，stop和operator参数值只有在它们是文字的情况下才会传递给索引成本函数。否则它们是<code class="codeph">NULL</code> 。 <a href="extensibility-constants-types-and-mappings.html#GUID-1A0380C1-2555-4910-8704-548CE1F4E166">ODCIArgDescList</a>描述了它<a href="extensibility-constants-types-and-mappings.html#GUID-1A0380C1-2555-4910-8704-548CE1F4E166">后面的</a>所有参数。
                     </p>
                     <div class="example" id="GUID-D562A817-B4E6-4AB4-B5B9-6871D909BD06__CHDIGECH">
                        <p class="titleinexample">例10-8定义一个运算符</p><pre class="oac_no_warn" dir="ltr"><code class="codeph">Contains(a_string</code> <code class="codeph">VARCHAR2(2000)</code> ， <code class="codeph">b_string</code> <code class="codeph">VARCHAR2(10))</code>
</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-D562A817-B4E6-4AB4-B5B9-6871D909BD06__CHDIDIDE">
                        <p class="titleinexample">示例10-9使用非文字参数调用索引成本函数</p><pre class="oac_no_warn" dir="ltr">ODCIStatsIndexCost（ <span class="italic">ODCIIndexInfo_constructor</span> ，sel，cost， <span class="italic">ODCIQueryInfo_constructor</span> ， <span class="italic">ODCIPredInfo_constructor</span> ， <span class="italic">ODCIArgDescList_constructor</span> ，NULL，1，'TEST'， <span class="italic">ODCIEnv_flag</span> ）</pre><div class="infoboxnotealso" id="GUID-D562A817-B4E6-4AB4-B5B9-6871D909BD06__GUID-D43D5BC9-D6A8-4732-8C5F-125CC4DFA1B0">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="extensible-optimizer-interface.html#GUID-158EC3A8-CB48-48B2-9405-198BA0FDD777">ODCIStatsIndexCost（）</a></p>
                        </div>
                     </div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADDCI4575"></a><div class="props_rev_3"><a id="GUID-D987A267-CC07-44A4-9753-786493389B7C" name="GUID-D987A267-CC07-44A4-9753-786493389B7C"></a><h4 id="ADDCI-GUID-D987A267-CC07-44A4-9753-786493389B7C" class="sect4"><span class="enumeration_section">10.2.6</span>生成系统管理域索引的统计信息</h4>
                  <div>
                     <p>如果选择系统管理的方法来维护域索引，并且必须将统计类型与域索引或索引类型相关联，则统计类型也必须由系统管理。</p>
                     <p>在为系统管理的域索引发出<code class="codeph">ODCIStatsCollect()</code>调用时，可能会收集统计信息。对于非分区索引，统计信息可以与索引存储表一起存储，作为单独的表存储，也可以与索引名称限定行的数据盒式元数据表一起存储。
                     </p>
                     <p>对于本地分区域索引，有三种用于存储统计信息的选项。所有在分区维护操作期间都使用<code class="codeph">ODCIStatsUpdPartStatistics()</code>方法，方法如下。请注意，在以下所有示例中， <code class="codeph">ODCIStatsUpdPartStatistics()</code>调用中不执行任何DDL，并且在<code class="codeph">ODCIStatsUpdPartStatistics()</code>的实现中<code class="codeph">ODCIStatsUpdPartStatistics()</code>允许DML和查询指令。
                     </p>
                     <div class="infoboxnotealso" id="GUID-D987A267-CC07-44A4-9753-786493389B7C__GUID-EFC11F8F-A3F9-4C5D-B1A2-3031844DFBA5">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="extensible-optimizer-interface.html#GUID-227ABB3C-6218-4AA9-BC1C-D963EE800D87">ODCIStatsCollect（）</a></p>
                           </li>
                           <li>
                              <p><a href="extensible-optimizer-interface.html#GUID-E3185A04-24BD-43C8-A2EC-76DDF78188A2">ODCIStatsUpdPartStatistics（）</a></p>
                           </li>
                        </ul>
                     </div>
                  </div><a id="ADDCI4576"></a><div class="props_rev_3"><a id="GUID-09C1B9E4-4294-450A-BE31-79CC9F82C2A6" name="GUID-09C1B9E4-4294-450A-BE31-79CC9F82C2A6"></a><h5 id="ADDCI-GUID-09C1B9E4-4294-450A-BE31-79CC9F82C2A6" class="sect5"><span class="enumeration_section">10.2.6.1</span>索引表中的索引 - 分区统计存储</h5>
                     <div>
                        <p>系统调用<a href="extensible-optimizer-interface.html#GUID-E3185A04-24BD-43C8-A2EC-76DDF78188A2">ODCIStatsUpdPartStatistics（）</a>方法如果统计信息与索引数据一起存储在索引存储（系统分区）表中， <a href="using-extensible-optimizer.html#GUID-09C1B9E4-4294-450A-BE31-79CC9F82C2A6__CHDHAHFD">如图10-1所示</a> 。该方法可以可选地维护任何与统计相关的分区元数据，或者是空操作。服务器删除或删除受影响分区的统计信息以及特定于这些分区的索引数据。
                        </p>
                        <div class="figure" id="GUID-09C1B9E4-4294-450A-BE31-79CC9F82C2A6__CHDHAHFD">
                           <p class="titleinfigure">图10-1使用索引表存储特定于索引的统计信息</p><img src="img/addci049.gif" alt="下面是图10-1的描述" title="下面是图10-1的描述" longdesc="img_text/addci049.html"><br><a href="img_text/addci049.html">“图10-1使用索引表存储特定于索引的统计信息”的描述</a></div>
                        <!-- class="figure" -->
                     </div>
                  </div><a id="ADDCI4577"></a><div class="props_rev_3"><a id="GUID-725CC8C9-C99D-45DC-82B9-1D6237DB605D" name="GUID-725CC8C9-C99D-45DC-82B9-1D6237DB605D"></a><h5 id="ADDCI-GUID-725CC8C9-C99D-45DC-82B9-1D6237DB605D" class="sect5"><span class="enumeration_section">10.2.6.2</span>索引 - 分区统计存储在单独的表中</h5>
                     <div>
                        <p>如果统计信息存储在单独的系统分区表中， <a href="using-extensible-optimizer.html#GUID-725CC8C9-C99D-45DC-82B9-1D6237DB605D__CHDEHGJA">如图10-2所示</a> ，则服务器会在<a href="extensible-optimizer-interface.html#GUID-227ABB3C-6218-4AA9-BC1C-D963EE800D87">ODCIStatsCollect（）</a>调用期间跟踪这些存储统计信息的系统分区表的创建。这些表由服务器以与索引存储表相同的方式维护。
                        </p>
                        <div class="figure" id="GUID-725CC8C9-C99D-45DC-82B9-1D6237DB605D__CHDEHGJA">
                           <p class="titleinfigure">图10-2在单独的表中存储特定于索引的统计信息</p><img src="img/addci050.gif" alt="下面是图10-2的描述" title="下面是图10-2的描述" longdesc="img_text/addci050.html"><br><a href="img_text/addci050.html">“图10-2在单独的表中存储特定于索引的统计信息”的描述</a></div>
                        <!-- class="figure" -->
                     </div>
                  </div><a id="ADDCI4578"></a><div class="props_rev_3"><a id="GUID-1595D5D4-D81C-4A28-A892-51D9388B7CC9" name="GUID-1595D5D4-D81C-4A28-A892-51D9388B7CC9"></a><h5 id="ADDCI-GUID-1595D5D4-D81C-4A28-A892-51D9388B7CC9" class="sect5"><span class="enumeration_section">10.2.6.3</span>公共表中的索引 - 分区统计存储</h5>
                     <div>
                        <p>如果统计信息作为schema-name，index-name或partition-name限定行存储在非分区表中， <a href="using-extensible-optimizer.html#GUID-1595D5D4-D81C-4A28-A892-51D9388B7CC9__CHDICHBJ">如图10-3所示</a> ，则必须通过调用来维护分区级统计信息。 <a href="extensible-optimizer-interface.html#GUID-E3185A04-24BD-43C8-A2EC-76DDF78188A2">ODCIStatsUpdPartStatistics（）</a> 。服务器不对这些表执行任何操作。
                        </p>
                        <div class="figure" id="GUID-1595D5D4-D81C-4A28-A892-51D9388B7CC9__CHDICHBJ">
                           <p class="titleinfigure">图10-3在公用表中存储索引 - 分区统计信息</p><img src="img/addci051.gif" alt="下面是图10-3的描述" title="下面是图10-3的描述" longdesc="img_text/addci051.html"><br><a href="img_text/addci051.html">“图10-3在公用表中存储索引 - 分区统计信息”的说明</a></div>
                        <!-- class="figure" -->
                     </div>
                  </div>
               </div>
            </div><a id="ADDCI4579"></a><div class="props_rev_3"><a id="GUID-C7523834-F426-4E6D-B1AB-AE1ABE9F5B4C" name="GUID-C7523834-F426-4E6D-B1AB-AE1ABE9F5B4C"></a><h3 id="ADDCI-GUID-C7523834-F426-4E6D-B1AB-AE1ABE9F5B4C" class="sect3"><span class="enumeration_section">10.3</span>使用用户定义的统计，选择性和成本</h3>
               <div>
                  <p>统计类型充当用户定义函数的接口，这些函数影响优化程序对执行计划的选择。但是，为了使优化器能够使用统计类型，它需要一种机制将统计类型绑定到数据库对象，例如列，独立函数，对象类型，索引，索引类型或包。您无法将统计信息类型与表的分区或域索引的分区相关联。<code class="codeph">ASSOCIATE</code> <code class="codeph">STATISTICS</code>命令创建此关联。
                  </p>
               </div><a id="ADDCI4580"></a><div class="props_rev_3"><a id="GUID-BE0E1E1D-8D3D-46FF-B76F-0C624FFBFBB0" name="GUID-BE0E1E1D-8D3D-46FF-B76F-0C624FFBFBB0"></a><h4 id="ADDCI-GUID-BE0E1E1D-8D3D-46FF-B76F-0C624FFBFBB0" class="sect4"><span class="enumeration_section">10.3.1</span>用户定义的统计信息</h4>
                  <div>
                     <p>用户定义的统计信息函数与使用标准SQL数据类型和对象类型以及域索引的列相关。<a href="extensible-optimizer-interface.html#GUID-4CEECA5F-099A-4558-A50C-FD856A814CF3">ODCIStatsSelectivity（）</a> ， <a href="extensible-optimizer-interface.html#GUID-B13AA56D-ABAF-431A-BAED-006B8331DCE1">ODCIStatsFunctionCost（）</a>和<a href="extensible-optimizer-interface.html#GUID-158EC3A8-CB48-48B2-9405-198BA0FDD777">ODCIStatsIndexCost（）</a>函数不用于用户定义的统计信息，因此仅用于收集用户定义的统计信息的统计信息类型无需实现这些功能。
                     </p>
                     <p>用户可以创建自己的表。此方法要求正确管理这些表的权限，这些表的备份和还原以及其他字典表，并解决时间点恢复注意事项。</p>
                  </div><a id="ADDCI4582"></a><a id="ADDCI4583"></a><a id="ADDCI4584"></a><a id="ADDCI4581"></a><div class="props_rev_3"><a id="GUID-0BD377DD-F6BA-42A4-9CB4-3B3A2FA9247E" name="GUID-0BD377DD-F6BA-42A4-9CB4-3B3A2FA9247E"></a><h5 id="ADDCI-GUID-0BD377DD-F6BA-42A4-9CB4-3B3A2FA9247E" class="sect5"><span class="enumeration_section">10.3.1.1</span>列统计</h5>
                     <div>
                        <p>考虑一个表<code class="codeph">Test_tab</code> ，如<a href="using-extensible-optimizer.html#GUID-0BD377DD-F6BA-42A4-9CB4-3B3A2FA9247E__CHDCDBAB">例10-10中</a>所定义，其中<code class="codeph">typ1</code>是一个对象类型。
                        </p>
                        <p>假设<code class="codeph">stat</code>是一个实现<a href="extensible-optimizer-interface.html#GUID-227ABB3C-6218-4AA9-BC1C-D963EE800D87">ODCIStatsCollect（）</a>和<a href="extensible-optimizer-interface.html#GUID-294738F4-65B1-4272-BBD6-686F2E38B9C2">ODCIStatsDelete（）</a>函数的统计类型。如果我们将统计类型与列绑定，则<code class="codeph">DBMS_STATS</code>包将为列<code class="codeph">col_b</code>收集用户定义的统计信息，如<a href="using-extensible-optimizer.html#GUID-0BD377DD-F6BA-42A4-9CB4-3B3A2FA9247E__CHDEICEA">例10-11所示</a> ：</p>
                        <p>列的列表可以与统计类型<code class="codeph">stat</code>关联。请注意，Oracle仅支持与顶级列的关联，而不支持对象类型的属性;如果您愿意， <a href="extensible-optimizer-interface.html#GUID-227ABB3C-6218-4AA9-BC1C-D963EE800D87">ODCIStatsCollect（）</a>函数可以通过遍历列来收集单个属性统计信息。
                        </p>
                        <p>收集用户定义的统计数据的另一种方法是声明与一个数据类型的关联，如在<a href="using-extensible-optimizer.html#GUID-0BD377DD-F6BA-42A4-9CB4-3B3A2FA9247E__CHDBFCFG">实施例10-12</a> ，其中宣布<code class="codeph">stat_typ1</code>作为统计类型的类型<code class="codeph">typ1</code> 。使用此关联分析表<code class="codeph">Test_tab</code> ，将使用统计类型<code class="codeph">stat_typ1</code>的<a href="extensible-optimizer-interface.html#GUID-227ABB3C-6218-4AA9-BC1C-D963EE800D87">ODCIStatsCollect（）</a>函数为列<code class="codeph">col_b</code>收集用户定义的统计信息。
                        </p>
                        <p>单个列关联始终优先于与类型的关联。因此，在前面的示例中，如果同时发出了<code class="codeph">ASSOCIATE</code> <code class="codeph">STATISTICS</code>命令，则<code class="codeph">DBMS_STATS</code>将使用统计信息类型<code class="codeph">stat</code> （而<span class="italic">不是</span> <code class="codeph">stat_typ1</code> ）来收集列<code class="codeph">col_b</code>用户定义的统计信息。同样重要的是要注意，标准统计数据（如果可能）与用户定义的统计数据一起收集。
                        </p>
                        <p>使用<a href="extensible-optimizer-interface.html#GUID-294738F4-65B1-4272-BBD6-686F2E38B9C2">ODCIStatsDelete（）</a>函数从用于收集统计信息的相同统计类型中删除用户定义的统计信息。
                        </p>
                        <p><code class="codeph">ASSOCIATE</code> <code class="codeph">STATISTICS</code>命令定义的关联存储在名为<code class="codeph">ASSOCIATION$</code>的字典表中。
                        </p>
                        <p>只有用户定义的数据类型才能包含与之关联的统计类型;您无法声明标准SQL数据类型的关联。</p>
                        <div class="example" id="GUID-0BD377DD-F6BA-42A4-9CB4-3B3A2FA9247E__CHDCDBAB">
                           <p class="titleinexample">示例10-10使用对象类型列创建表</p><pre class="oac_no_warn" dir="ltr">CREATE TABLE Test_tab（col_a NUMBER，col_b typ1，col_c VARCHAR2（2000））</pre></div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-0BD377DD-F6BA-42A4-9CB4-3B3A2FA9247E__CHDEICEA">
                           <p class="titleinexample">示例10-11将统计信息与用户定义统计信息的列关联</p><pre class="oac_no_warn" dir="ltr">与列相关联的统计数据Test_tab.col_b使用统计数据</pre></div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-0BD377DD-F6BA-42A4-9CB4-3B3A2FA9247E__CHDBFCFG">
                           <p class="titleinexample">示例10-12将统计信息与用户定义的统计信息的数据类型相关联</p><pre class="oac_no_warn" dir="ltr">关联统计类型typ1使用stat_typ1</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="ADDCI4586"></a><a id="ADDCI4587"></a><a id="ADDCI4585"></a><div class="props_rev_3"><a id="GUID-5675D5A9-3F1B-4221-87BA-18216BBCD29A" name="GUID-5675D5A9-3F1B-4221-87BA-18216BBCD29A"></a><h5 id="ADDCI-GUID-5675D5A9-3F1B-4221-87BA-18216BBCD29A" class="sect5"><span class="enumeration_section">10.3.1.2</span>实现域索引统计</h5>
                     <div>
                        <p>域索引具有索引类型。系统管理域索引的统计类型是通过仅将其与其索引类型相关联来定义的。<a href="using-extensible-optimizer.html#GUID-5675D5A9-3F1B-4221-87BA-18216BBCD29A__CHDGGHIB">例10-13</a>演示了如何在<a href="using-extensible-optimizer.html#GUID-0BD377DD-F6BA-42A4-9CB4-3B3A2FA9247E__CHDCDBAB">例10-10中</a>的表<code class="codeph">Test_tab</code>上创建索引类型，索引和运算符：</p>
                        <p>这里， <code class="codeph">indtype</code>是索引类型， <code class="codeph">userOp</code>是所支持的用户定义的运算符<code class="codeph">indtype</code> ， <code class="codeph">userOp_func</code>是的功能实现<code class="codeph">userOp</code> ，和<code class="codeph">imptype</code>是实现类型的索引类型的<code class="codeph">indtype</code> 。
                        </p>
                        <p>统计类型<code class="codeph">stat_indtype</code>可以与系统管理的indextype相关联，如<a href="using-extensible-optimizer.html#GUID-5675D5A9-3F1B-4221-87BA-18216BBCD29A__CHDDHFGE">例10-14所示</a> 。当域索引<code class="codeph">Test_indx</code>具有一个INDEXTYPE <code class="codeph">indtype</code>进行了分析，该指数的用户定义的统计信息通过调用收集<a href="extensible-optimizer-interface.html#GUID-227ABB3C-6218-4AA9-BC1C-D963EE800D87">ODCIStatsCollect（）</a>的函数<code class="codeph">stat_indtype</code> 。
                        </p>
                        <p>要删除索引统计信息，请使用<a href="extensible-optimizer-interface.html#GUID-294738F4-65B1-4272-BBD6-686F2E38B9C2">ODCIStatsDelete（）</a>方法，该方法是为定义早期<a href="extensible-optimizer-interface.html#GUID-227ABB3C-6218-4AA9-BC1C-D963EE800D87">ODCIStatsCollect（）</a>方法的相同统计类型定义的。
                        </p>
                        <div class="example" id="GUID-5675D5A9-3F1B-4221-87BA-18216BBCD29A__CHDGGHIB">
                           <p class="titleinexample">示例10-13为用户定义的统计信息创建索引类型，索引和运算符</p><pre class="oac_no_warn" dir="ltr">CREATE INDEXTYPE indtype FOR userOp（NUMBER）使用imptype with SYSTEM MANAGED STORAGE TABLES; CREATE INDEX Test_indx ON Test_tab（col_a）INDEXTYPE IS indtype PARAMETERS（'example'）;使用userOp_func创建操作员userOp BINDING（NUMBER）返回编号;</pre></div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-5675D5A9-3F1B-4221-87BA-18216BBCD29A__CHDDHFGE">
                           <p class="titleinexample">示例10-14将统计信息与系统管理的索引类型相关联</p><pre class="oac_no_warn" dir="ltr">与INDEXTYPES关联的统计信息indtype使用stat_indtype和SYSTEM MANAGED STORAGE TABLES</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div>
               </div><a id="ADDCI4588"></a><div class="props_rev_3"><a id="GUID-F832FD36-A66D-4894-B578-9DB002CBCE7A" name="GUID-F832FD36-A66D-4894-B578-9DB002CBCE7A"></a><h4 id="ADDCI-GUID-F832FD36-A66D-4894-B578-9DB002CBCE7A" class="sect4"><span class="enumeration_section">10.3.2</span>用户定义的选择性</h4>
                  <div>
                     <p>优化器使用选择性函数来计算查询中谓词的选择性。谓词必须具有适当的形式之一，并且可以包含用户定义的运算符，独立函数，包函数或类型方法。</p>
                  </div><a id="ADDCI4590"></a><a id="ADDCI4589"></a><div class="props_rev_3"><a id="GUID-26B29F5B-B8D3-4066-93CE-25F4EB37D304" name="GUID-26B29F5B-B8D3-4066-93CE-25F4EB37D304"></a><h5 id="ADDCI-GUID-26B29F5B-B8D3-4066-93CE-25F4EB37D304" class="sect5"><span class="enumeration_section">10.3.2.1</span>用户定义的运算符</h5>
                     <div>
                        <p>假设声明了<a href="using-extensible-optimizer.html#GUID-26B29F5B-B8D3-4066-93CE-25F4EB37D304__CHDCFAHB">例10-15</a>中的关联。如果优化器遇到<code class="codeph">userOp(Test_tab.col_a) = 1</code>谓词，它将调用统计类型<code class="codeph">stat_userOp_func</code>中的<a href="extensible-optimizer-interface.html#GUID-4CEECA5F-099A-4558-A50C-FD856A814CF3">ODCIStatsSelectivity（）</a>函数（如果存在），该函数与<code class="codeph">userOp</code>运算符的<code class="codeph">userOp_func</code>的功能实现相关联。
                        </p>
                        <div class="example" id="GUID-26B29F5B-B8D3-4066-93CE-25F4EB37D304__CHDCFAHB">
                           <p class="titleinexample">示例10-15将统计信息与用户定义的运算符相关联</p><pre class="oac_no_warn" dir="ltr">使用函数关联统计信息userOp_func使用stat_userOp_func</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="ADDCI4592"></a><a id="ADDCI4591"></a><div class="props_rev_3"><a id="GUID-A6D4832A-9C42-4280-A8D7-AAA11715CFB1" name="GUID-A6D4832A-9C42-4280-A8D7-AAA11715CFB1"></a><h5 id="ADDCI-GUID-A6D4832A-9C42-4280-A8D7-AAA11715CFB1" class="sect5"><span class="enumeration_section">10.3.2.2</span>独立功能</h5>
                     <div>
                        <p>如果为独立函数<code class="codeph">myFunction</code>声明了<a href="using-extensible-optimizer.html#GUID-A6D4832A-9C42-4280-A8D7-AAA11715CFB1__CHDBFGDA">示例10-16中</a>的关联，则优化器会在统计类型<code class="codeph">stat_myFunction</code> <code class="codeph">myFunction(Test_tab.col_a, 'TEST') = 1</code>谓词的<a href="extensible-optimizer-interface.html#GUID-4CEECA5F-099A-4558-A50C-FD856A814CF3">ODCIStatsSelectivity（）</a>函数（如果存在）。
                        </p>
                        <div class="example" id="GUID-A6D4832A-9C42-4280-A8D7-AAA11715CFB1__CHDBFGDA">
                           <p class="titleinexample">示例10-16将统计信息与独立功能关联</p><pre class="oac_no_warn" dir="ltr">关联统计与函数myFunction使用stat_MyFunction</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="ADDCI4594"></a><a id="ADDCI4593"></a><div class="props_rev_3"><a id="GUID-C16F0231-0409-4BB8-A243-1FA62E220B00" name="GUID-C16F0231-0409-4BB8-A243-1FA62E220B00"></a><h5 id="ADDCI-GUID-C16F0231-0409-4BB8-A243-1FA62E220B00" class="sect5"><span class="enumeration_section">10.3.2.3</span>包功能</h5>
                     <div>
                        <p>如果为包<code class="codeph">Demo_pack</code>声明了<a href="using-extensible-optimizer.html#GUID-C16F0231-0409-4BB8-A243-1FA62E220B00__CHDEBDHD">示例10-17中</a>的关联，则优化器调用统计类型<code class="codeph">stat_Demo_pack</code>的<a href="extensible-optimizer-interface.html#GUID-4CEECA5F-099A-4558-A50C-FD856A814CF3">ODCIStatsSelectivity（）</a>函数（如果存在），用于<code class="codeph">Demo_pack.myDemoPackFunction(Test_tab.col_a, 'TEST') = 1</code>谓词其中<code class="codeph">myDemoPackFunction</code>处于功能<code class="codeph">Demo_pack</code> 。
                        </p>
                        <div class="example" id="GUID-C16F0231-0409-4BB8-A243-1FA62E220B00__CHDEBDHD">
                           <p class="titleinexample">示例10-17将统计信息与包函数关联</p><pre class="oac_no_warn" dir="ltr">包含统计数据与包装Demo_pack使用stat_Demo_pack</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="ADDCI4596"></a><a id="ADDCI4595"></a><div class="props_rev_3"><a id="GUID-39D6098E-1650-49DF-8AF3-1014C673424D" name="GUID-39D6098E-1650-49DF-8AF3-1014C673424D"></a><h5 id="ADDCI-GUID-39D6098E-1650-49DF-8AF3-1014C673424D" class="sect5"><span class="enumeration_section">10.3.2.4</span>类型方法</h5>
                     <div>
                        <div class="section">
                           <p>如果为类型<code class="codeph">Example_typ</code>声明了<a href="using-extensible-optimizer.html#GUID-39D6098E-1650-49DF-8AF3-1014C673424D__CHDBDEHF">示例10-18中</a>的关联，则优化器会在统计信息类型<code class="codeph">stat_Example_typ</code>为<code class="codeph">myExampleTypMethod(Test_tab.col_b) = 1</code>谓词调用<a href="extensible-optimizer-interface.html#GUID-4CEECA5F-099A-4558-A50C-FD856A814CF3">ODCIStatsSelectivity（）</a>函数（如果存在），其中<code class="codeph">myExampleTypMethod</code>是一种方法在<code class="codeph">Example_typ</code> 。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-39D6098E-1650-49DF-8AF3-1014C673424D__CHDBDEHF">
                           <p class="titleinexample">示例10-18将统计信息与类型方法关联</p><pre class="oac_no_warn" dir="ltr">关联统计与类型Example_typ使用stat_Example_typ</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="ADDCI4598"></a><a id="ADDCI4597"></a><div class="props_rev_3"><a id="GUID-5FCAE45F-40FA-47BD-A512-D3BF449B32C3" name="GUID-5FCAE45F-40FA-47BD-A512-D3BF449B32C3"></a><h5 id="ADDCI-GUID-5FCAE45F-40FA-47BD-A512-D3BF449B32C3" class="sect5"><span class="enumeration_section">10.3.2.5</span>默认选择性</h5>
                     <div>
                        <p>选择性函数的替代方法是用户定义的<span class="italic">默认选择性。</span> 默认选择性是<code class="codeph">0</code>到<code class="codeph">100%</code>之间的值;优化器查找它而不是调用选择性函数。默认选择性可用于具有用户定义的运算符，独立函数，包函数或类型方法的谓词。
                        </p>
                        <p><a href="using-extensible-optimizer.html#GUID-5FCAE45F-40FA-47BD-A512-D3BF449B32C3__CHDECCEG">示例10-19中</a>的关联声明<code class="codeph">myFunction(Test_tab.col_a) = 1</code>谓词的选择性始终为<code class="codeph">20%</code> （或<code class="codeph">0.2</code> ），无论<code class="codeph">myFunction,</code>比较运算符<code class="codeph">=</code>或常量<code class="codeph">1</code>的参数如何。优化程序使用此缺省选择性而不是调用选择性函数。
                        </p>
                        <p>可以使用统计类型或默认选择性声明关联，但不能同时使用两者。因此，以下声明是非法的：</p><pre class="oac_no_warn" dir="ltr">关联统计与函数myFunction使用stat_myFunction DEFAULT SELECTIVITY 20</pre><p>默认选择性声明的其他示例包括：</p><pre class="oac_no_warn" dir="ltr">与包括关联的统计数据Demo_pack默认选择性20关联类型统计与类型Example_typ默认选择性20</pre><div class="example" id="GUID-5FCAE45F-40FA-47BD-A512-D3BF449B32C3__CHDECCEG">
                           <p class="titleinexample">示例10-19将统计信息与默认选择性相关联</p><pre class="oac_no_warn" dir="ltr">关联统计与功能myFunction DEFAULT SELECTIVITY 20</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div>
               </div><a id="ADDCI4599"></a><div class="props_rev_3"><a id="GUID-9865F793-8211-44BA-A8D8-945720F30AE1" name="GUID-9865F793-8211-44BA-A8D8-945720F30AE1"></a><h4 id="ADDCI-GUID-9865F793-8211-44BA-A8D8-945720F30AE1" class="sect4"><span class="enumeration_section">10.3.3</span>用户定义的成本</h4>
                  <div>
                     <p>优化程序使用用户定义的成本函数来计算查询中谓词的成本。谓词必须具有前面列出的表单之一，并且可以包含用户定义的运算符，独立函数，包函数或类型方法。此外，用户定义的成本函数还用于计算域索引的成本。</p>
                  </div><a id="ADDCI4601"></a><a id="ADDCI4600"></a><div class="props_rev_3"><a id="GUID-59D85F03-55FF-44CA-B0C8-89257B8F20C9" name="GUID-59D85F03-55FF-44CA-B0C8-89257B8F20C9"></a><h5 id="ADDCI-GUID-59D85F03-55FF-44CA-B0C8-89257B8F20C9" class="sect5"><span class="enumeration_section">10.3.3.1</span>用户定义的运算符</h5>
                     <div>
                        <p>如果声明了<a href="using-extensible-optimizer.html#GUID-59D85F03-55FF-44CA-B0C8-89257B8F20C9__CHDCFABJ">示例10-20中</a>的关联，请考虑<code class="codeph">userOp(Test_tab.col_a) = 1</code>谓词。如果优化器使用实现<code class="codeph">userOp</code>的<code class="codeph">indtype</code>索引<code class="codeph">Test_indx</code>评估域索引<code class="codeph">Test_indx</code> ，则它会在统计信息类型<code class="codeph">stat_indtype</code>调用<a href="extensible-optimizer-interface.html#GUID-158EC3A8-CB48-48B2-9405-198BA0FDD777">ODCIStatsIndexCost（）</a>方法（如果存在）。但是，如果未使用域索引，优化程序将调用统计信息类型<code class="codeph">stat_userOp</code>的<a href="extensible-optimizer-interface.html#GUID-B13AA56D-ABAF-431A-BAED-006B8331DCE1">ODCIStatsFunctionCost（）</a> （如果存在）以计算操作员<code class="codeph">userOp</code>的功能实现的<code class="codeph">userOp</code> 。</p>
                        <div class="example" id="GUID-59D85F03-55FF-44CA-B0C8-89257B8F20C9__CHDCFABJ">
                           <p class="titleinexample">示例10-20将统计信息与用户定义的运算符相关联</p><pre class="oac_no_warn" dir="ltr">与INDEXTYPES关联的统计信息indtype使用stat_indtype与SYSTEM MANAGED STORAGE TABLES关联统计与函数userOp使用stat_userOp_func</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="ADDCI4603"></a><a id="ADDCI4602"></a><div class="props_rev_3"><a id="GUID-9E9BBF66-2DB1-432F-AE4D-60667274A7CD" name="GUID-9E9BBF66-2DB1-432F-AE4D-60667274A7CD"></a><h5 id="ADDCI-GUID-9E9BBF66-2DB1-432F-AE4D-60667274A7CD" class="sect5"><span class="enumeration_section">10.3.3.2</span>独立功能</h5>
                     <div>
                        <p>如果为独立函数<code class="codeph">myFunction</code>声明了<a href="using-extensible-optimizer.html#GUID-9E9BBF66-2DB1-432F-AE4D-60667274A7CD__CHDBCAIG">示例10-21中</a>的关联，则优化器会在统计类型<code class="codeph">stat_myFunction</code>为<code class="codeph">myFunction(Test_tab.col_a, 'TEST') = 1</code>谓词调用<a href="extensible-optimizer-interface.html#GUID-B13AA56D-ABAF-431A-BAED-006B8331DCE1">ODCIStatsFunctionCost（）</a>函数（如果存在）。
                        </p>
                        <p>用户定义的功能成本不会影响访问方法的选择;它们仅用于排序谓词，如<a href="extensible-optimizer-interface.html#GUID-2B314B88-73C1-49A0-9A74-1AB99B20FA94">可扩展优化器接口中所述</a> 。
                        </p>
                        <div class="example" id="GUID-9E9BBF66-2DB1-432F-AE4D-60667274A7CD__CHDBCAIG">
                           <p class="titleinexample">示例10-21将统计信息与独立功能关联</p><pre class="oac_no_warn" dir="ltr">关联统计与函数myFunction使用stat_myFunction;</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="ADDCI4605"></a><a id="ADDCI4604"></a><div class="props_rev_3"><a id="GUID-EB446223-CAA9-4599-B73E-7F85278F5AA1" name="GUID-EB446223-CAA9-4599-B73E-7F85278F5AA1"></a><h5 id="ADDCI-GUID-EB446223-CAA9-4599-B73E-7F85278F5AA1" class="sect5"><span class="enumeration_section">10.3.3.3</span>包功能</h5>
                     <div>
                        <p>如果为包<code class="codeph">Demo_pack</code>声明了<a href="using-extensible-optimizer.html#GUID-EB446223-CAA9-4599-B73E-7F85278F5AA1__CHDFCBAB">示例10-22中</a>的关联，则优化器在<code class="codeph">Demo_pack.myDemoPackFunction(Test_tab.col_a) = 1</code>谓词的统计类型<code class="codeph">stat_Demo_pack</code>调用<a href="extensible-optimizer-interface.html#GUID-B13AA56D-ABAF-431A-BAED-006B8331DCE1">ODCIStatsFunctionCost（）</a>函数（如果存在<code class="codeph">Demo_pack.myDemoPackFunction(Test_tab.col_a) = 1</code> ，其中<code class="codeph">myDemoPackFunction</code>为<code class="codeph">Demo_pack</code>一个函数。
                        </p>
                        <div class="example" id="GUID-EB446223-CAA9-4599-B73E-7F85278F5AA1__CHDFCBAB">
                           <p class="titleinexample">示例10-22将统计信息与程序包功能关联</p><pre class="oac_no_warn" dir="ltr">包含统计数据与包装Demo_pack使用stat_Demo_pack;</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="ADDCI4607"></a><a id="ADDCI4606"></a><div class="props_rev_3"><a id="GUID-B71F2865-CEFE-42E7-97C8-5AC491C79FA2" name="GUID-B71F2865-CEFE-42E7-97C8-5AC491C79FA2"></a><h5 id="ADDCI-GUID-B71F2865-CEFE-42E7-97C8-5AC491C79FA2" class="sect5"><span class="enumeration_section">10.3.3.4</span>类型方法</h5>
                     <div>
                        <div class="section">
                           <p>如果声明了关联，如<a href="using-extensible-optimizer.html#GUID-B71F2865-CEFE-42E7-97C8-5AC491C79FA2__CHDJCJJF">例10-23所示</a> ，对于类型<code class="codeph">Example_typ</code> ，则优化器在<code class="codeph">myExampleTypMethod(Test_tab.col_b) = 1</code>谓词的统计类型<code class="codeph">stat_Example_typ</code>调用<a href="extensible-optimizer-interface.html#GUID-B13AA56D-ABAF-431A-BAED-006B8331DCE1">ODCIStatsFunctionCost（）</a>函数（如果存在<code class="codeph">myExampleTypMethod(Test_tab.col_b) = 1</code> ，其中<code class="codeph">myExampleTypMethod</code>是<code class="codeph">Example_typ</code>的方法。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-B71F2865-CEFE-42E7-97C8-5AC491C79FA2__CHDJCJJF">
                           <p class="titleinexample">示例10-23将统计信息与类型方法关联</p><pre class="oac_no_warn" dir="ltr">关联统计与类型Example_typ使用stat_Example_typ;</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="ADDCI4609"></a><a id="ADDCI4608"></a><div class="props_rev_3"><a id="GUID-4318FDB4-A69A-4E20-B481-1857B8D327C5" name="GUID-4318FDB4-A69A-4E20-B481-1857B8D327C5"></a><h5 id="ADDCI-GUID-4318FDB4-A69A-4E20-B481-1857B8D327C5" class="sect5"><span class="enumeration_section">10.3.3.5</span>默认成本</h5>
                     <div>
                        <p>与默认选择性一样，默认成本可用于具有用户定义的运算符，独立函数，包函数或类型方法的谓词。<a href="using-extensible-optimizer.html#GUID-4318FDB4-A69A-4E20-B481-1857B8D327C5__CHDCCFJE">例10-24中</a>的命令声明使用域索引<code class="codeph">Test_indx</code>来实现<code class="codeph">userOp(Test_tab.col_a) = 1</code>谓词的CPU成本总是<code class="codeph">100</code> ，I / O成本为<code class="codeph">5</code> ，网络成本为<code class="codeph">0</code> （无论<code class="codeph">userOp</code> ，比较运算符“ <code class="codeph">=</code> ”或常量“ <code class="codeph">1</code> ”的参数如何，Oracle中都忽略了网络成本。优化程序使用此默认开销而不是调用<a href="extensible-optimizer-interface.html#GUID-158EC3A8-CB48-48B2-9405-198BA0FDD777">ODCIStatsIndexCost（）</a>函数。
                        </p>
                        <p>您可以使用统计类型或默认成本来声明关联，但不能同时使用两者。因此，以下声明是非法的：</p><pre class="oac_no_warn" dir="ltr">关联统计与索引Test_indx使用stat_Test_indx默认成本（100,5,0）</pre><p>以下是一些默认成本声明的示例：</p><pre class="oac_no_warn" dir="ltr">关联统计与函数myFunction默认成本（100,5,0）关联统计与包Demo_pack默认成本（100,5,0）关联统计与类型Example_typ默认成本（100,5,0）关联统计与INDEXTYPES indtype DEFAULT COST（ 100,5,0）</pre><div class="example" id="GUID-4318FDB4-A69A-4E20-B481-1857B8D327C5__CHDCCFJE">
                           <p class="titleinexample">示例10-24将统计信息与默认成本相关联</p><pre class="oac_no_warn" dir="ltr">关联统计与指数Test_indx DEFAULT COST（100,5,0）;</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div>
               </div><a id="ADDCI4611"></a><a id="ADDCI4610"></a><div class="props_rev_3"><a id="GUID-2EE2FDCC-8F34-4365-B0C3-F0DB2C30AFD9" name="GUID-2EE2FDCC-8F34-4365-B0C3-F0DB2C30AFD9"></a><h4 id="ADDCI-GUID-2EE2FDCC-8F34-4365-B0C3-F0DB2C30AFD9" class="sect4"><span class="enumeration_section">10.3.4</span>声明索引或列的NULL关联</h4>
                  <div>
                     <p>为索引类型或对象类型定义的统计类型的关联由该索引类型的索引实例和该对象类型的列继承。可以通过显式定义索引实例或列的不同关联来覆盖继承的关联，但有时您可能希望索引或列根本不具有任何关联。例如，对于特定查询，更好的计划的好处可能不会超过调用成本或选择性函数所产生的额外编译时间。对于这种情况，您可以使用<code class="codeph">ASSOCIATE</code>命令为列或索引声明<code class="codeph">NULL</code>关联，如<a href="using-extensible-optimizer.html#GUID-2EE2FDCC-8F34-4365-B0C3-F0DB2C30AFD9__CHDFHGJA">例10-25所示</a> 。
                     </p>
                     <p>如果指定了<code class="codeph">NULL</code>关联，则架构对象不会从列类型或索引类型继承任何统计类型。<code class="codeph">NULL</code>关联也会排除默认值。
                     </p>
                     <div class="example" id="GUID-2EE2FDCC-8F34-4365-B0C3-F0DB2C30AFD9__CHDFHGJA">
                        <p class="titleinexample">示例10-25声明列和索引的NULL统计关联</p><pre class="oac_no_warn" dir="ltr">ASSOCIATE STATISTICS WITH COLUMNS <span class="italic">列</span> NULL; ASSOCIATE STATISTICS WITH INDEXES <span class="italic">索引为</span> NULL;</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADDCI4613"></a><a id="ADDCI4612"></a><div class="props_rev_3"><a id="GUID-9F768A9E-9883-4E62-A630-7D9A63C51042" name="GUID-9F768A9E-9883-4E62-A630-7D9A63C51042"></a><h4 id="ADDCI-GUID-9F768A9E-9883-4E62-A630-7D9A63C51042" class="sect4"><span class="enumeration_section">10.3.5</span> DDL操作如何影响统计</h4>
                  <div>
                     <p>DDL操作以与标准统计信息相同的方式影响分区级和模式对象级聚合统计信息。<a href="using-extensible-optimizer.html#GUID-9F768A9E-9883-4E62-A630-7D9A63C51042__G1006951" title="列出DDL操作对分区级别和架构对象级别聚合统计信息的影响">表10-2</a>总结了这些影响。
                     </p>
                     <div class="tblformal" id="GUID-9F768A9E-9883-4E62-A630-7D9A63C51042__G1006951">
                        <p class="titleintable">表10-2 DDL对分区和全球统计的影响</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="DDL对分区和全局统计的影响" width="100%" border="1" summary="Lists the effects of DDL operations on partition-level and schema object-level aggregrate statistics" frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="30%" id="d30475e3735">手术</th>
                                 <th align="left" valign="bottom" width="31%" id="d30475e3738">对分区统计的影响</th>
                                 <th align="left" valign="bottom" width="39%" id="d30475e3741">对全球统计的影响</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="30%" id="d30475e3746" headers="d30475e3735 "><pre class="oac_no_warn" dir="ltr">添加分区</pre></td>
                                 <td align="left" valign="top" width="31%" headers="d30475e3746 d30475e3738 ">
                                    <p>没有</p>
                                 </td>
                                 <td align="left" valign="top" width="39%" headers="d30475e3746 d30475e3741 ">
                                    <p>没有行动</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="30%" id="d30475e3756" headers="d30475e3735 ">
                                    <p><code class="codeph">COALESCE</code> <code class="codeph">PARTITION</code>      
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="31%" headers="d30475e3756 d30475e3738 ">
                                    <p>统计删除</p>
                                 </td>
                                 <td align="left" valign="top" width="39%" headers="d30475e3756 d30475e3741 ">
                                    <p>重新计算统计数据（如果<code class="codeph">minimal_stats_aggregation</code>为<code class="codeph">FALSE</code> ，否则无效）</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="30%" id="d30475e3777" headers="d30475e3735 "><pre class="oac_no_warn" dir="ltr">DROP PARTITION</pre></td>
                                 <td align="left" valign="top" width="31%" headers="d30475e3777 d30475e3738 ">
                                    <p>统计删除</p>
                                 </td>
                                 <td align="left" valign="top" width="39%" headers="d30475e3777 d30475e3741 ">
                                    <p>重新计算统计数据（如果<code class="codeph">minimal_stats_aggregation</code>为<code class="codeph">FALSE</code> ，否则无效）</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="30%" id="d30475e3793" headers="d30475e3735 "><pre class="oac_no_warn" dir="ltr">分裂分区</pre></td>
                                 <td align="left" valign="top" width="31%" headers="d30475e3793 d30475e3738 ">
                                    <p>统计删除</p>
                                 </td>
                                 <td align="left" valign="top" width="39%" headers="d30475e3793 d30475e3741 ">
                                    <p>没有</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="30%" id="d30475e3803" headers="d30475e3735 "><pre class="oac_no_warn" dir="ltr">合并分区</pre></td>
                                 <td align="left" valign="top" width="31%" headers="d30475e3803 d30475e3738 ">
                                    <p>统计删除</p>
                                 </td>
                                 <td align="left" valign="top" width="39%" headers="d30475e3803 d30475e3741 ">
                                    <p>没有</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="30%" id="d30475e3813" headers="d30475e3735 "><pre class="oac_no_warn" dir="ltr">TRUNCATE PARTITION</pre></td>
                                 <td align="left" valign="top" width="31%" headers="d30475e3813 d30475e3738 ">
                                    <p>统计删除</p>
                                 </td>
                                 <td align="left" valign="top" width="39%" headers="d30475e3813 d30475e3741 ">
                                    <p>没有</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="30%" id="d30475e3823" headers="d30475e3735 "><pre class="oac_no_warn" dir="ltr">交换分区</pre></td>
                                 <td align="left" valign="top" width="31%" headers="d30475e3823 d30475e3738 ">
                                    <p>统计删除</p>
                                 </td>
                                 <td align="left" valign="top" width="39%" headers="d30475e3823 d30475e3741 ">
                                    <p>重新计算统计数据（如果<code class="codeph">minimal_stats_aggregation</code>为<code class="codeph">FALSE</code> ，否则无效）</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="30%" id="d30475e3839" headers="d30475e3735 "><pre class="oac_no_warn" dir="ltr">重建分区</pre></td>
                                 <td align="left" valign="top" width="31%" headers="d30475e3839 d30475e3738 ">
                                    <p>没有</p>
                                 </td>
                                 <td align="left" valign="top" width="39%" headers="d30475e3839 d30475e3741 ">
                                    <p>没有</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="30%" id="d30475e3849" headers="d30475e3735 "><pre class="oac_no_warn" dir="ltr">移动分区</pre></td>
                                 <td align="left" valign="top" width="31%" headers="d30475e3849 d30475e3738 ">
                                    <p>没有</p>
                                 </td>
                                 <td align="left" valign="top" width="39%" headers="d30475e3849 d30475e3741 ">
                                    <p>没有</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="30%" id="d30475e3859" headers="d30475e3735 "><pre class="oac_no_warn" dir="ltr">重命名分区</pre></td>
                                 <td align="left" valign="top" width="31%" headers="d30475e3859 d30475e3738 ">
                                    <p>没有</p>
                                 </td>
                                 <td align="left" valign="top" width="39%" headers="d30475e3859 d30475e3741 ">
                                    <p>没有</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p>如果使用<code class="codeph">ALTER TABLE DROP PARTITION</code>语句交换或删除现有分区，并且<code class="codeph">_minimal_stats_aggregation</code>参数设置为<code class="codeph">FALSE</code> ，则会删除该分区的统计信息，并重新计算表或索引的聚合统计信息。
                     </p>
                  </div>
               </div>
            </div><a id="ADDCI4614"></a><div class="props_rev_3"><a id="GUID-8EE46DDC-F955-4DD6-8EA9-AC64B1A4941F" name="GUID-8EE46DDC-F955-4DD6-8EA9-AC64B1A4941F"></a><h3 id="ADDCI-GUID-8EE46DDC-F955-4DD6-8EA9-AC64B1A4941F" class="sect3"><span class="enumeration_section">10.4</span>谓词排序</h3>
               <div>
                  <p>如果没有<code class="codeph">ORDERED_PREDICATES</code>提示，则会按以下规则指定的顺序评估谓词（用于索引键的谓词除外）：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>根据<code class="codeph">WHERE</code>子句中指定的顺序，首先计算没有任何用户定义的函数，类型方法或子查询的谓词。
                        </p>
                     </li>
                     <li>
                        <p>具有用户定义的函数的预测和具有用户计算成本的类型方法按其成本的递增顺序进行评估。</p>
                     </li>
                     <li>
                        <p>接下来，按照<code class="codeph">WHERE</code>子句中指定的顺序评估具有用户定义的函数和没有用户计算成本的类型方法的谓词。
                        </p>
                     </li>
                     <li>
                        <p>接下来将评估未在<code class="codeph">WHERE</code>子句中指定的谓词（例如，由优化程序传递生成的谓词）。
                        </p>
                     </li>
                     <li>
                        <p>具有子查询的谓词最后按<code class="codeph">WHERE</code>子句中指定的顺序进行求值。
                        </p>
                     </li>
                  </ul>
               </div>
            </div><a id="ADDCI4616"></a><a id="ADDCI4615"></a><div class="props_rev_3"><a id="GUID-A909C27C-55A7-4F39-AB60-CA47A2A4AC5B" name="GUID-A909C27C-55A7-4F39-AB60-CA47A2A4AC5B"></a><h3 id="ADDCI-GUID-A909C27C-55A7-4F39-AB60-CA47A2A4AC5B" class="sect3"><span class="enumeration_section">10.5</span>依赖模型</h3>
               <div>
                  <p>依赖关系模型反映了在发出<a href="using-extensible-optimizer.html#GUID-A909C27C-55A7-4F39-AB60-CA47A2A4AC5B__G1006912" title="列出发出任何一组DDL命令时执行的操作">表10-3中</a>描述的任何SQL命令时所采取的操作。
                  </p>
                  <div class="tblformal" id="GUID-A909C27C-55A7-4F39-AB60-CA47A2A4AC5B__G1006912">
                     <p class="titleintable">表10-3 DDL的依赖关系模型</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="DDL的依赖模型" width="100%" border="1" summary="Lists the actions that are taken when you issue any of a set of DDL commands" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="40%" id="d30475e4036">命令</th>
                              <th align="left" valign="bottom" width="60%" id="d30475e4039">行动</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="40%" id="d30475e4044" headers="d30475e4036 "><pre class="oac_no_warn" dir="ltr"><span class="italic">DROP statistics_type</span></pre></td>
                              <td align="left" valign="top" width="60%" headers="d30475e4044 d30475e4039 ">
                                 <p>如果使用<code class="codeph">statistics_type</code>定义关联，则命令将失败，否则将删除该类型。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="40%" id="d30475e4055" headers="d30475e4036 "><pre class="oac_no_warn" dir="ltr">DROP <span class="italic">statistics_type</span> FORCE</pre></td>
                              <td align="left" valign="top" width="60%" headers="d30475e4055 d30475e4039 ">
                                 <p>为与<code class="codeph">statistics_type</code>关联的所有对象调用<code class="codeph">DISASSOCIATE</code> <code class="codeph">FORCE</code> ; drop <code class="codeph">statistics_type</code> 。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="40%" id="d30475e4077" headers="d30475e4036 "><pre class="oac_no_warn" dir="ltr">DROP <span class="italic">对象</span></pre></td>
                              <td align="left" valign="top" width="60%" headers="d30475e4077 d30475e4039 ">
                                 <p>调用<code class="codeph">DISASSOCIATE</code> ，如果<code class="codeph">DISASSOCIATE</code>成功则删除<code class="codeph">object_type</code> 。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="40%" id="d30475e4095" headers="d30475e4036 "><pre class="oac_no_warn" dir="ltr"><code class="codeph">ALTER TABLE DROP COLUMN</code></pre></td>
                              <td align="left" valign="top" width="60%" headers="d30475e4095 d30475e4039 ">
                                 <p>如果列存在关联，则使用列调用<code class="codeph">DISASSOCIATE</code> <code class="codeph">FORCE</code> ;如果<code class="codeph">ASSOCIATION$</code>没有条目但是<code class="codeph">USATS$,</code>类型中有条目<code class="codeph">USATS$,</code>则调用列的<code class="codeph">ODCIStatsDelete()</code> 。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="40%" id="d30475e4118" headers="d30475e4036 "><pre class="oac_no_warn" dir="ltr"><code class="codeph">撇清</code></pre></td>
                              <td align="left" valign="top" width="60%" headers="d30475e4118 d30475e4039 ">
                                 <p>如果存在使用statistics_type收集的用户定义统计<code class="codeph">statistics_type</code> ，则该命令将失败。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="40%" id="d30475e4129" headers="d30475e4036 "><pre class="oac_no_warn" dir="ltr"><code class="codeph">失败的力量</code></pre></td>
                              <td align="left" valign="top" width="60%" headers="d30475e4129 d30475e4039 ">
                                 <p>删除<code class="codeph">ASSOCIATION$</code>的条目并调用<code class="codeph">ODCIStatsDelete()</code> 。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="40%" id="d30475e4143" headers="d30475e4036 ">
                                 <p>使用<code class="codeph">DBMS_STATISTICS</code>包删除索引统计信息</p>
                              </td>
                              <td align="left" valign="top" width="60%" headers="d30475e4143 d30475e4039 ">
                                 <p>调用<code class="codeph">ODCIStatsDelete()</code>函数;如果出现任何错误，则统计信息删除失败并报告错误。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="40%" id="d30475e4156" headers="d30475e4036 "><pre class="oac_no_warn" dir="ltr"><code class="codeph">关联</code></pre></td>
                              <td align="left" valign="top" width="60%" headers="d30475e4156 d30475e4039 ">
                                 <p>如果关联对象存在关联或用户定义的统计信息，则该命令将失败。</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="infoboxnotealso" id="GUID-A909C27C-55A7-4F39-AB60-CA47A2A4AC5B__GUID-B79DB04A-395E-4111-BB6D-49F3456D4E79">
                     <p class="notep1">也可以看看：</p>
                     <p><a href="extensible-optimizer-interface.html#GUID-294738F4-65B1-4272-BBD6-686F2E38B9C2">ODCIStatsDelete（）</a></p>
                  </div>
               </div>
            </div><a id="ADDCI4617"></a><div class="props_rev_3"><a id="GUID-3B0CDF21-FA40-4C64-B8C3-B3B877A3D633" name="GUID-3B0CDF21-FA40-4C64-B8C3-B3B877A3D633"></a><h3 id="ADDCI-GUID-3B0CDF21-FA40-4C64-B8C3-B3B877A3D633" class="sect3"><span class="enumeration_section">10.6</span>限制和建议</h3>
               <div>
                  <div class="section">
                     <p>统计类型是普通对象类型。由于对象类型必须至少具有一个属性，因此必须具有统计类型。但是，因为永远不会访问或设置它，所以这是一个虚拟属性。</p>
                  </div>
                  <!-- class="section" -->
               </div><a id="ADDCI4618"></a><div class="props_rev_3"><a id="GUID-4D781A0D-56B5-43F8-B5D6-28FCFC359122" name="GUID-4D781A0D-56B5-43F8-B5D6-28FCFC359122"></a><h4 id="ADDCI-GUID-4D781A0D-56B5-43F8-B5D6-28FCFC359122" class="sect4"><span class="enumeration_section">10.6.1</span>分布式执行</h4>
                  <div>
                     <p>Oracle的分布式实现不支持向远程功能列表添加功能。引用远程表的所有函数都作为过滤器执行。过滤器的位置发生在优化程序之外。成本模型反映了此实现，并不尝试优化这些谓词的放置。</p>
                     <p>由于谓词未发送到远程站点，因此无法在远程表上使用域索引。因此， <code class="codeph">DESCRIBE</code>协议保持不变，并且从本地站点看不到远程域索引。
                     </p>
                  </div>
               </div><a id="ADDCI4619"></a><div class="props_rev_3"><a id="GUID-5EEB0B31-57BF-404D-9417-8C0E45D44C86" name="GUID-5EEB0B31-57BF-404D-9417-8C0E45D44C86"></a><h4 id="ADDCI-GUID-5EEB0B31-57BF-404D-9417-8C0E45D44C86" class="sect4"><span class="enumeration_section">10.6.2</span>系统管理的存储表和ASSOCIATE STATISTICS</h4>
                  <div>
                     <p>如果要创建具有<code class="codeph">WITH SYSTEM MANAGED STORAGE TABLES</code> SYSTEMED <code class="codeph">WITH SYSTEM MANAGED STORAGE TABLES</code>的索引类型，则还应创建其关联的统计类型<code class="codeph">WITH SYSTEM MANAGED STORAGE TABLES</code> 。如果使用系统分区表收集有关本地索引列的统计信息，则Oracle服务器会在分区维护操作期间为它们维护系统分区统计信息表。当indextype与统计类型相关联时，您只能使用<code class="codeph">WITH SYSTEM MANAGED STORAGE TABLES</code>选项;否则系统会引发错误。
                     </p>
                  </div>
               </div><a id="ADDCI4620"></a><div class="props_rev_3"><a id="GUID-733EA528-E55A-4F4B-BF8B-2C415384C7D8" name="GUID-733EA528-E55A-4F4B-BF8B-2C415384C7D8"></a><h4 id="ADDCI-GUID-733EA528-E55A-4F4B-BF8B-2C415384C7D8" class="sect4"><span class="enumeration_section">10.6.3</span>聚合对象级统计</h4>
                  <div>
                     <p>使用本地索引时，维护分区级别和聚合对象级别统计信息可能很有用。在分区维护操作期间，将删除分区级别统计信息，同时调整聚合对象级别统计信息以反映操作，或者“按原样”保留以便以后重新计算。</p>
                     <p>调整或重新计算聚合统计信息的决定是基于服务器中的<code class="codeph">_minimal_stats_aggregation</code>参数进行的。如果参数为<code class="codeph">FALSE</code> ，则重新计算聚合统计信息。如果参数为<code class="codeph">TRUE</code> ，则不会重新计算统计信息。
                     </p>
                  </div>
               </div><a id="ADDCI4621"></a><div class="props_rev_3"><a id="GUID-6BEFEDA4-C2F0-4281-9EF7-B46C6EA33ADF" name="GUID-6BEFEDA4-C2F0-4281-9EF7-B46C6EA33ADF"></a><h4 id="ADDCI-GUID-6BEFEDA4-C2F0-4281-9EF7-B46C6EA33ADF" class="sect4"><span class="enumeration_section">10.6.4</span>系统管理的域索引</h4>
                  <div>
                     <p>系统管理的域索引方法支持与索引类型相关联的系统管理的统计信息; indextype本身也应该是系统管理的。</p>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-09E028A5-A83D-4CFC-A5E1-097D2BD3D279" name="GUID-09E028A5-A83D-4CFC-A5E1-097D2BD3D279"></a><h4 id="ADDCI-GUID-09E028A5-A83D-4CFC-A5E1-097D2BD3D279" class="sect4"><span class="enumeration_section">10.6.5</span>收集和删除系统管理索引的用户定义统计信息</h4>
                  <div>
                     <p>在分析域索引本身时，不会发生系统管理的域索引的用户定义的统计信息收集。相反，在调用<code class="codeph">DBMS_STATS</code>包中定义的<code class="codeph">GATHER_*_STATS</code>过程期间收集索引统计信息时，将调用对<code class="codeph">ODCIStatsCollect()</code>调用。同样，在调用<code class="codeph">DBMS_STATS</code>包中定义的<code class="codeph">DELETE_*_STATS</code>过程期间，将调用对<code class="codeph">ODCIStatsDelete()</code>删除域索引统计信息的调用。
                     </p>
                     <div class="section">
                        <p>例10-26演示了如何通过发出对<code class="codeph">DBMS_STATS.GATHER_INDEX_STATS()</code>的调用来收集<code class="codeph">SCOTT</code>模式上的<code class="codeph">TXT_IDX</code>域索引的统计信息。
                        </p>
                        <p>例10-27显示了如何删除同一索引的统计信息。</p>
                        <p>例10-28演示了如何使用<code class="codeph">DBMS_STATS.GATHER_INDEX_STATS()</code>的粒度参数从<code class="codeph">SCOTT</code>模式的<code class="codeph">PT_TXT_IDX</code>本地域索引收集分区统计信息。
                        </p>
                        <p>例10-29显示了如何删除同一索引的分区统计信息。例10-30和例10-31分别演示了如何收集和删除本地域索引的单个分区的统计信息。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-09E028A5-A83D-4CFC-A5E1-097D2BD3D279__GUID-1AF0C129-D142-4447-BD38-4E4BD2150412">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/addci&amp;id=ARPLS-GUID-01FAB8ED-E4A3-4C3E-8FE2-88717DCDDA06" target="_blank"><span><cite>Oracle数据库PL / SQL包和类型参考</cite></span></a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div class="sect4"><a id="GUID-0AD8C7C0-E2CB-4C80-99C0-5E56C67D9549" name="GUID-0AD8C7C0-E2CB-4C80-99C0-5E56C67D9549"></a><h5 id="ADDCI-GUID-0AD8C7C0-E2CB-4C80-99C0-5E56C67D9549" class="sect5"><span class="enumeration_section">10.6.5.1</span>收集系统管理域索引的统计信息</h5>
                     <div>
                        <p>此主题说明如何收集系统管理的域索引的统计信息。</p>
                        <div class="example" id="GUID-0AD8C7C0-E2CB-4C80-99C0-5E56C67D9549__GUID-001B6C70-C73D-47F6-A948-77C90454EC59">
                           <p class="titleinexample">示例10-26收集系统管理的域索引的统计信息</p><pre class="oac_no_warn" dir="ltr">BEGIN SYS.DBMS_STATS.GATHER_INDEX_STATS（'SCOTT'，'TXT_IDX'）;结束; /</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-3BD23B54-B026-46E4-8D8C-BB022487B42D" name="GUID-3BD23B54-B026-46E4-8D8C-BB022487B42D"></a><h5 id="ADDCI-GUID-3BD23B54-B026-46E4-8D8C-BB022487B42D" class="sect5"><span class="enumeration_section">10.6.5.2</span>删除系统管理域索引的统计信息</h5>
                     <div>
                        <p>本主题说明如何删除系统管理的域索引的统计信息。</p>
                        <div class="example" id="GUID-3BD23B54-B026-46E4-8D8C-BB022487B42D__GUID-4583D6A0-D212-4F87-9A2B-69366FBA229E">
                           <p class="titleinexample">示例10-27删除系统管理的域索引的统计信息</p><pre class="oac_no_warn" dir="ltr">BEGIN SYS.DBMS_STATS.DELETE_INDEX_STATS（'SCOTT'，'TXT_IDX'）;结束; /</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-0AC6DB72-6AE2-44ED-A1D1-45717320721F" name="GUID-0AC6DB72-6AE2-44ED-A1D1-45717320721F"></a><h5 id="ADDCI-GUID-0AC6DB72-6AE2-44ED-A1D1-45717320721F" class="sect5"><span class="enumeration_section">10.6.5.3</span>收集本地系统管理域索引的所有分区的统计信息</h5>
                     <div>
                        <p>本主题说明如何收集本地系统管理的域索引的所有分区的统计信息。</p>
                        <div class="example" id="GUID-0AC6DB72-6AE2-44ED-A1D1-45717320721F__GUID-9AE40AD1-EAA5-4C37-819F-9C4BE2CEF715">
                           <p class="titleinexample">示例10-28收集本地系统管理的域索引的所有分区的统计信息</p><pre class="oac_no_warn" dir="ltr">BEGIN SYS.DBMS_STATS.GATHER_INDEX_STATS（'SCOTT'，'PT_TXT_IDX'，granularity =&gt;'PARTITION'）;结束; /</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-E5A10484-55B0-499D-95C1-71BE70BE8A92" name="GUID-E5A10484-55B0-499D-95C1-71BE70BE8A92"></a><h5 id="ADDCI-GUID-E5A10484-55B0-499D-95C1-71BE70BE8A92" class="sect5"><span class="enumeration_section">10.6.5.4</span>删除本地系统管理域索引的所有分区的统计信息</h5>
                     <div>
                        <p>本主题说明如何删除本地系统管理的域索引的所有分区的统计信息。</p>
                        <div class="example" id="GUID-E5A10484-55B0-499D-95C1-71BE70BE8A92__GUID-6083F9DD-4D8C-40B4-9FAF-BB96E5C6935C">
                           <p class="titleinexample">示例10-29删除本地系统管理的域索引的所有分区的统计信息</p><pre class="oac_no_warn" dir="ltr">BEGIN SYS.DBMS_STATS.DELETE_INDEX_STATS（'SCOTT'，'PT_TXT_IDX'，cascade_parts =&gt; TRUE）;结束; /</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-AC02252A-15A8-472D-B401-5EAA94853EF0" name="GUID-AC02252A-15A8-472D-B401-5EAA94853EF0"></a><h5 id="ADDCI-GUID-AC02252A-15A8-472D-B401-5EAA94853EF0" class="sect5"><span class="enumeration_section">10.6.5.5</span>收集本地系统管理域索引的分区P2的统计信息</h5>
                     <div>
                        <p>本主题说明如何收集本地系统管理的域索引的分区P2的统计信息。</p>
                        <div class="example" id="GUID-AC02252A-15A8-472D-B401-5EAA94853EF0__GUID-39A1FCE6-136D-4D2B-A7D1-D0011CD5FED4">
                           <p class="titleinexample">示例10-30收集本地系统管理的域索引的分区P2的统计信息</p><pre class="oac_no_warn" dir="ltr">BEGIN SYS.DBMS_STATS.GATHER_INDEX_STATS（'SCOTT'，'PT_TXT_IDX'，P2，granularity =&gt;'PARTITION'）;结束; /</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-8C947F78-7CFC-4BA8-9EB5-EC2428CA0064" name="GUID-8C947F78-7CFC-4BA8-9EB5-EC2428CA0064"></a><h5 id="ADDCI-GUID-8C947F78-7CFC-4BA8-9EB5-EC2428CA0064" class="sect5"><span class="enumeration_section">10.6.5.6</span>删除本地系统管理域索引的分区P2的统计信息</h5>
                     <div>
                        <p>本主题说明如何删除本地系统管理的域索引的分区P2的统计信息。</p>
                        <div class="example" id="GUID-8C947F78-7CFC-4BA8-9EB5-EC2428CA0064__GUID-E8E6B7FD-E23D-4CD4-A38C-DFA561708EAA">
                           <p class="titleinexample">示例10-31删除本地系统管理的域索引的分区P2的统计信息</p><pre class="oac_no_warn" dir="ltr">BEGIN SYS.DBMS_STATS.DELETE_INDEX_STATS（'SCOTT'，'PT_TXT_IDX'，P2，cascade_parts =&gt; FALSE）;结束; /</pre><p>当本地域索引是复合分区时，可以收集和删除复合分区的所有子分区的统计信息，如例10-32和例10-33所示。</p>
                           <p>示例10-34和示例10-35演示了如何收集和删除单个子分区的统计信息。</p>
                           <p>此外，如果需要收集或删除所有子分区中的统计信息，则必须使用示例10-28和示例10-29中显示的相同调用。</p>
                        </div>
                        <!-- class="example" -->
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-9DC1123E-2A16-463F-B758-58AFCA982A79" name="GUID-9DC1123E-2A16-463F-B758-58AFCA982A79"></a><h5 id="ADDCI-GUID-9DC1123E-2A16-463F-B758-58AFCA982A79" class="sect5"><span class="enumeration_section">10.6.5.7</span>收集本地系统管理域索引的复合分区的所有子分区的统计信息</h5>
                     <div>
                        <p>本主题说明如何收集本地系统管理的域索引的复合分区的所有子分区的统计信息。</p>
                        <div class="example" id="GUID-9DC1123E-2A16-463F-B758-58AFCA982A79__GUID-1CBDDAF4-2599-4875-9D03-9ECA1BFAB981">
                           <p class="titleinexample">示例10-32收集本地系统管理的域索引的复合分区的所有子分区的统计信息</p><pre class="oac_no_warn" dir="ltr">BEGIN SYS.DBMS_STATS.GATHER_INDEX_STATS（'SCOTT'，'CPT_TXT_IDX'，CP2，granularity =&gt;'PARTITION'）;结束; /</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-B6691870-FB0E-4AB6-8FC1-58DF8C48215E" name="GUID-B6691870-FB0E-4AB6-8FC1-58DF8C48215E"></a><h5 id="ADDCI-GUID-B6691870-FB0E-4AB6-8FC1-58DF8C48215E" class="sect5"><span class="enumeration_section">10.6.5.8</span>删除本地系统管理域索引的复合分区的所有子分区的统计信息</h5>
                     <div>
                        <p>本主题说明如何删除本地系统管理的域索引的复合分区的所有子分区的统计信息</p>
                        <div class="example" id="GUID-B6691870-FB0E-4AB6-8FC1-58DF8C48215E__GUID-D41244E4-0BA0-49DD-8699-F5B0D7B11B4C">
                           <p class="titleinexample">示例10-33删除本地系统管理的域索引的复合分区的所有子分区的统计信息</p><pre class="oac_no_warn" dir="ltr">BEGIN SYS.DBMS_STATS.DELETE_INDEX_STATS（'SCOTT'，'CPT_TXT_IDX'，CP2，cascade_parts =&gt; FALSE）;结束; /</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-A89B5B04-DD9C-470C-A607-98B32628F15E" name="GUID-A89B5B04-DD9C-470C-A607-98B32628F15E"></a><h5 id="ADDCI-GUID-A89B5B04-DD9C-470C-A607-98B32628F15E" class="sect5"><span class="enumeration_section">10.6.5.9</span>收集本地系统管理域索引的子分区的统计信息</h5>
                     <div>
                        <p>本主题说明如何收集本地系统管理的域索引的子分区的统计信息</p>
                        <div class="example" id="GUID-A89B5B04-DD9C-470C-A607-98B32628F15E__GUID-A14547C8-3ED6-470C-8B56-F08FE276FB4E">
                           <p class="titleinexample">示例10-34收集本地系统管理的域索引的子分区的统计信息</p><pre class="oac_no_warn" dir="ltr">BEGIN SYS.DBMS_STATS.GATHER_INDEX_STATS（'SCOTT'，'CPT_TXT_IDX'，CP2_S1，granularity =&gt;'SUBPARTITION'）;结束; /</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-7C9647C2-A2CA-46BC-92E2-C41AB326CF3F" name="GUID-7C9647C2-A2CA-46BC-92E2-C41AB326CF3F"></a><h5 id="ADDCI-GUID-7C9647C2-A2CA-46BC-92E2-C41AB326CF3F" class="sect5"><span class="enumeration_section">10.6.5.10</span>删除本地系统管理域索引的子分区的统计信息</h5>
                     <div>
                        <p>本主题说明如何删除本地系统管理的域索引的子分区的统计信息</p>
                        <div class="example" id="GUID-7C9647C2-A2CA-46BC-92E2-C41AB326CF3F__GUID-710A392D-6725-4F6C-9F35-B7693628B9D3">
                           <p class="titleinexample">示例10-35删除本地系统管理的域索引的子分区的统计信息</p><pre class="oac_no_warn" dir="ltr">BEGIN SYS.DBMS_STATS.DELETE_INDEX_STATS（'SCOTT'，'CPT_TXT_IDX'，CP2_S1，cascade_parts =&gt; FALSE）;结束; /</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div>
               </div><a id="ADDCI4622"></a><div class="props_rev_3"><a id="GUID-B68F5E7A-0B98-42C0-88ED-6870F2CCD96F" name="GUID-B68F5E7A-0B98-42C0-88ED-6870F2CCD96F"></a><h4 id="ADDCI-GUID-B68F5E7A-0B98-42C0-88ED-6870F2CCD96F" class="sect4"><span class="enumeration_section">10.6.6</span>表现</h4>
                  <div>
                     <p>如果选择相同的计划，则可扩展优化器的查询执行成本保持不变。如果选择了不同的计划，假定用户定义的成本，选择性和统计信息收集功能是准确的，则执行时间应该更好。鉴于此，强烈建议您为用户定义的结构提供统计信息收集，选择性和成本函数，因为优化程序默认值可能不准确并导致昂贵的执行计划。</p>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>