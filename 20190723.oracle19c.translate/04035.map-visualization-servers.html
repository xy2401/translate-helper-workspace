<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="The map visualizer, as a set of Java Enterprise Edition packages, contains a collection of servers to provide mapping services."></meta>
      <meta name="description" content="The map visualizer, as a set of Java Enterprise Edition packages, contains a collection of servers to provide mapping services."></meta>
      <title>映射可视化服务器</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Map Visualization Developer&#39;s Guide "></meta>
      <meta property="og:description" content="The map visualizer, as a set of Java Enterprise Edition packages, contains a collection of servers to provide mapping services."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Map Visualization Developer&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="spatial-and-graph-map-visualization-developers-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-10T11:37:22-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2001, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E94797-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="map-visualization-concepts.html" title="Previous" type="text/html"></link>
      <link rel="next" href="oracle-maps.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Spatial and Graph Map Visualization Developer&#39;s Guide"></meta>
    <meta name="dcterms.isVersionOf" content="JIMPV"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="map-visualization-concepts.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="oracle-maps.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">地图可视化开发人员指南</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">映射可视化服务器</li>
            </ol>
            <a id="GUID-0D2CF483-95C0-45D0-B4E8-5A4578741A63" name="GUID-0D2CF483-95C0-45D0-B4E8-5A4578741A63"></a><a id="JIMPV3000"></a>
            
            <h2 id="JIMPV-GUID-0D2CF483-95C0-45D0-B4E8-5A4578741A63" class="sect2"><span class="enumeration_chapter">3</span>映射可视化服务器</h2>
         </header>
         <div class="ind">
            <div>
               <p>地图可视化工具作为一组Java Enterprise Edition包，包含一组服务器以提供地图服务。</p>
               <p>这些服务包括地图服务器，地图数据服务器，地图图块服务器，WMS服务器（请参阅<a href="ogc-wms-support-map-visualzation-component.html#GUID-9B407D9F-0298-4890-A345-C22A99C50226" title="地图可视化组件支持使用Open GIS Consortium（OGC）Web地图服务（WMS）协议（特别是WMS 1.1.1和1.3.0实施规范）提供的数据呈现。">地图可视化组件中的OGC WMS支持</a> ）和WMTS服务器（请参阅<a href="ogc-wmts-support-map-visualzation-component.html#GUID-FD2428ED-0400-4D11-83F4-9AB59FE766C9" title="地图可视化组件支持使用Open GIS Consortium（OGC）Web Map Tile Service（WMTS）协议（特别是WMS 1.0.0实现规范）提供的数据呈现">地图可视化组件中的OGC WMTS支持</a> ）。开发Oracle Maps应用程序时，Oracle Maps API和地图可视化服务器将识别所需的服务，然后向适当的服务器发出地图服务请求。您通常不需要在地图应用程序中明确发送服务请求;但是，如果您熟悉本章中描述的地图可视化服务器，则可以在需要调试或优化应用程序时提供帮助。
               </p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="map-visualization-servers.html#GUID-3A6C41AB-66DC-40D7-8B3A-9B2F7A1ED58F">映射Visualizer Map数据服务器</a><br>地图可视化器地图数据服务器提供用于将实时数据从数据库服务器流式传输到客户端的服务。
                  </li>
                  <li class="ulchildlink"><a href="map-visualization-servers.html#GUID-7E88B130-FB2F-47D1-A8B2-909CFB1454AC">映射平铺服务器</a><br>地图图块服务器是一种地图图像缓存引擎，用于获取，缓存和提供预生成的固定大小的地图图像图块。
                  </li>
               </ul>
            </div>
            <a id="JIMPV10114"></a><div class="props_rev_3"><a id="GUID-3A6C41AB-66DC-40D7-8B3A-9B2F7A1ED58F" name="GUID-3A6C41AB-66DC-40D7-8B3A-9B2F7A1ED58F"></a><h3 id="JIMPV-GUID-3A6C41AB-66DC-40D7-8B3A-9B2F7A1ED58F" class="sect3"><span class="enumeration_section">3.1</span> Map Visualizer Map数据服务器</h3>
               <div>
                  <p>地图可视化器地图数据服务器提供用于将实时数据从数据库服务器流式传输到客户端的服务。</p>
                  <p>数据可以由Oracle Maps JavaScript API客户端使用，也可以由API编辑实用程序进行编辑。它还用作处理数据同步任务的中间层组件。</p>
                  <p>在最基本的级别，客户端向地图数据服务器发送请求，指定主题的名称和可选的边界框。然后，服务器以压缩的GeoJSON格式返回实时数据（包括几何和属性）。</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="map-visualization-servers.html#GUID-0A52EF92-14F4-414A-BE5E-D3B68427E8AC">域和映射数据服务器URL模式</a><br></li>
                     <li class="ulchildlink"><a href="map-visualization-servers.html#GUID-A4529184-3550-4058-8EBB-C4670BB4233B">映射数据服务器请求参数</a><br></li>
                     <li class="ulchildlink"><a href="map-visualization-servers.html#GUID-28D5721C-1246-4C56-8602-3DB9CC05D1F3">解释从地图数据服务器返回的数据</a><br></li>
                     <li class="ulchildlink"><a href="map-visualization-servers.html#GUID-13559073-0FDA-461A-8A71-826722F2AEC5">映射数据服务器错误处理</a><br></li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="map-visualization-servers.html#GUID-0D2CF483-95C0-45D0-B4E8-5A4578741A63" title="地图可视化工具作为一组Java Enterprise Edition包，包含一组服务器以提供地图服务。">映射可视化服务器</a></p>
                     </div>
                  </div>
               </div>
               <a id="JIMPV10115"></a><div class="props_rev_3"><a id="GUID-0A52EF92-14F4-414A-BE5E-D3B68427E8AC" name="GUID-0A52EF92-14F4-414A-BE5E-D3B68427E8AC"></a><h4 id="JIMPV-GUID-0A52EF92-14F4-414A-BE5E-D3B68427E8AC" class="sect4"><span class="enumeration_section">3.1.1</span>域和映射数据服务器URL模式</h4>
                  <div>
                     <p>地图数据服务器使用域，其中每个<span class="bold">域</span>对应于地图可视化器数据源。例如，要从<code class="codeph">mvdemo</code>数据源请求数据，URL必须具有以下模式：</p>
                     <p><code class="codeph">http://example.com:8080/mapviewer/dataserver/mvdemo？</code></p>
                     <p>在此URL请求中， <code class="codeph">/dataserver</code>引用地图数据服务器。 <code class="codeph">/mvdemo</code>是路径信息，指示此请求针对哪个域或数据源。无需在URL请求的其余部分中明确指定数据源。此URL模式提供了保护方面的灵活性。用户或Web管理员可以使用这种URL模式轻松地为不同的域设置不同级别的保护。
                     </p>
                     <p>要获得有关受支持的HTTP请求参数的完整列表的快速帮助，您可以发出包含help参数的请求。例如：</p>
                     <p><code class="codeph">HTTP：//例子：8080 /服务器MapViewer /数据服务器/ mvdemo帮助=真</code></p>
                     <p>此示例返回支持的参数列表。（请注意，即使对于此帮助请求，仍然需要<code class="codeph">/mvdemo</code>路径。）
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="map-visualization-servers.html#GUID-3A6C41AB-66DC-40D7-8B3A-9B2F7A1ED58F" title="地图可视化器地图数据服务器提供用于将实时数据从数据库服务器流式传输到客户端的服务。">映射Visualizer Map数据服务器</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="JIMPV10116"></a><div class="props_rev_3"><a id="GUID-A4529184-3550-4058-8EBB-C4670BB4233B" name="GUID-A4529184-3550-4058-8EBB-C4670BB4233B"></a><h4 id="JIMPV-GUID-A4529184-3550-4058-8EBB-C4670BB4233B" class="sect4"><span class="enumeration_section">3.1.2</span>映射数据服务器请求参数</h4>
                  <div>
                     <p>在获取数据的地图数据服务器请求中，URL必须包含适当的查询参数。数据可以来自地图可视化器预定义几何主题或JDBC主题。</p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="map-visualization-servers.html#GUID-2E270F13-ED13-4694-BFC4-2B92A2061A76">从预定义的几何主题中获取数据</a><br></li>
                        <li class="ulchildlink"><a href="map-visualization-servers.html#GUID-1D3893BD-9CCC-48B8-88DD-B62FEA2E33EE">从JDBC主题获取数据</a><br></li>
                        <li class="ulchildlink"><a href="map-visualization-servers.html#GUID-11E24A20-1AA6-4A1E-A6DC-53FA29D94225">从JDBC主题获取注释文本</a><br></li>
                        <li class="ulchildlink"><a href="map-visualization-servers.html#GUID-7CDCDBF2-D41D-49B5-8F18-D73E016515F4">获取拓扑数据</a><br></li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="map-visualization-servers.html#GUID-3A6C41AB-66DC-40D7-8B3A-9B2F7A1ED58F" title="地图可视化器地图数据服务器提供用于将实时数据从数据库服务器流式传输到客户端的服务。">映射Visualizer Map数据服务器</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="JIMPV10117"></a><div class="props_rev_3"><a id="GUID-2E270F13-ED13-4694-BFC4-2B92A2061A76" name="GUID-2E270F13-ED13-4694-BFC4-2B92A2061A76"></a><h5 id="JIMPV-GUID-2E270F13-ED13-4694-BFC4-2B92A2061A76" class="sect5"><span class="enumeration_section">3.1.2.1</span>从预定义的几何主题中获取数据</h5>
                     <div>
                        <p>在从预定义几何主题获取数据之前，请确保已正确定义预定义几何主题。如果未正确定义，请修改其定义或使用正确的定义创建新的预定义几何主题。</p>
                        <p>除了空间表的几何列之外，如果还需要应用程序的某些属性列，那么几何主题的STYLING_RULES列必须具有<code class="codeph">&lt;hidden_info&gt;</code>元素以定义所需的属性。例如，如果您的应用程序需要几何主题（例如CUSTOMERS）来表示空间表，并且您还需要每个客户的名称，城市和销售额，那么STYLING_RULES应该类似于以下内容：</p><pre class="oac_no_warn" dir="ltr">SQL&gt;从user_sdo_themes中选择STYLING_RULES，其中name ='CUSTOMERS'; STYLING_RULES ------------------------------------------------- ------------------------------- &lt;？xml version =“1.0”standalone =“yes”？&gt; &lt;styling_rules&gt; &lt;hidden_info&gt; &lt;field column =“name”name =“Name”/&gt; &lt;field column =“city”name =“City”/&gt; &lt;field column =“sales”name =“Sales”/&gt; &lt; / hidden_info&gt; &lt;rule&gt; &lt;features style =“M.STOPLIGHT_RED”&gt; &lt;/ features&gt; &lt;/ rule&gt; &lt;/ styling_rules&gt;</pre><p>Map Builder实用程序是用于修改或创建几何主题的推荐工具。</p>
                        <p>有关在预定义几何主题中使用样式规则的信息，请参阅<a href="map-visualization-concepts.html#GUID-1A5A976B-8E3F-42DD-AB10-A35ED02385DD">预定义空间几何主题中的样式规则</a> 。
                        </p>
                        <p>以下参数可用于地图数据服务器请求以从地图可视化工具预定义几何主题获取数据。<code class="codeph">t</code> （主题名称）参数是必需的;其他是可选的。
                        </p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">t</code> ：主题的名称。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">bbox</code> ：边界框。必须是以逗号分隔的<code class="codeph">minx,miny,maxx,maxy</code> 。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">to_srid</code> ：SRID（空间参考系统），用于返回数据。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">bbox_srid</code> ：边界框的SRID（空间参照系），如果与数据的本机SRID不同。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">seq</code> ：序列ID，用于以多部分格式获取数据时使用。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">dadp</code> ：小数点后的位数：返回数据中坐标小数点后的最大位数。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">include_style_info</code> ：确定每个要素是否应包含样式信息（呈现/标记样式名称和相关列）。（默认为<code class="codeph">true</code> 。）
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">include_label_box</code> ：确定每个面要素中是否应包含标签框。（默认为<code class="codeph">true</code> 。）标签框是多边形内的近似最大矩形。放置在此矩形内的标签保证完全位于面要素内。对于非多边形要素，将忽略此参数。
                              </p>
                           </li>
                        </ul>
                        <p>以下是一些例子。</p>
                        <p>要从3857 SRID中的CITIES表中获取所有数据：</p>
                        <p><code class="codeph">HTTP：//例如：8080 / MapViewer的/数据服务器/ mvdemo吨= theme_demo_cities＆to_srid = 3857</code></p>
                        <p>要从CITIES表中获取与3857 SRID中指定的bbox交互的所有数据：</p>
                        <p><code class="codeph">HTTP：//例如：8080 / MapViewer的/数据服务器/ mvdemo吨= theme_demo_cities＆BBOX = -122.0,25，-100,45＆to_srid = 3857</code></p>
                        <p>要从CITIES表中获取与3857 SRID中指定的bbox交互的所有数据，小数点后面有3位数，并且没有样式信息：</p>
                        <p><code class="codeph">HTTP：//例如：8080 / MapViewer的/数据服务器/ mvdemo吨= theme_demo_cities＆BBOX = -122.0,25，-100,45＆to_srid = 3857＆DADP = 3＆include_style_info =无</code></p>
                        <p>要从COUNTIES表中获取所有数据并包含标签框：</p>
                        <p><code class="codeph">HTTP：//例如：8080 / MapViewer的/数据服务器/ mvdemo吨= theme_demo_counties＆include_label_box =是</code></p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="map-visualization-servers.html#GUID-A4529184-3550-4058-8EBB-C4670BB4233B">映射数据服务器请求参数</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="JIMPV10118"></a><div class="props_rev_3"><a id="GUID-1D3893BD-9CCC-48B8-88DD-B62FEA2E33EE" name="GUID-1D3893BD-9CCC-48B8-88DD-B62FEA2E33EE"></a><h5 id="JIMPV-GUID-1D3893BD-9CCC-48B8-88DD-B62FEA2E33EE" class="sect5"><span class="enumeration_section">3.1.2.2</span>从JDBC主题获取数据</h5>
                     <div>
                        <p>以下参数可用于地图数据服务器请求，以基于动态JDBC主题从地图可视化工具主题获取数据。需要<code class="codeph">t</code> （主题名称）和<code class="codeph">sql</code> （SQL查询）参数;其他是可选的。
                        </p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">t</code> ：主题的名称。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">sql</code> ：完整的SQL查询，正确的URL编码。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">asis</code> ：确定查询是否应“按原样”执行。默认值为<code class="codeph">false</code> ，这会导致地图可视化工具将SQL查询作为其空间过滤器查询的子查询嵌入。如果值为<code class="codeph">true</code> ，则地图可视化工具不会尝试修改提供的查询字符串。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">bbox</code> ：边界框。必须是以逗号分隔的<code class="codeph">minx,miny,maxx,maxy</code> 。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">to_srid</code> ：SRID（空间参考系统），用于返回数据。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">bbox_srid</code> ：边界框的SRID（空间参照系），如果与数据的本机SRID不同。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">seq</code> ：序列ID，用于以多部分格式获取数据时使用。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">dadp</code> ：小数点后的位数：返回数据中坐标小数点后的最大位数。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">include_style_info</code> ：确定每个要素是否应包含样式信息（呈现/标记样式名称和相关列）。（默认为<code class="codeph">true</code> 。）
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">include_label_box</code> ：确定每个面要素中是否应包含标签框。（默认为<code class="codeph">true</code> 。）标签框是多边形内的近似最大矩形。放置在此矩形内的标签保证完全位于面要素内。对于非多边形要素，将忽略此参数。
                              </p>
                           </li>
                        </ul>
                        <p>以下是一些例子。</p>
                        <p>要获取SRID 3857中CITIES表的所有数据：</p>
                        <p><code class="codeph">HTTP：//例如：8080 / MapViewer的/数据服务器/ mvdemo吨= THEME1＆SQL =选择+ * + +从城市＆to_srid = 3857</code></p>
                        <p>要获取SRID 3857中给定bbox中表CITIES的所有数据：</p>
                        <p><code class="codeph">HTTP：//例如：8080 / MapViewer的/数据服务器/ mvdemo吨= THEME1＆SQL =选择+ * + +从城市＆to_srid = 3857＆BBOX = -122.0,25，-100,45</code></p>
                        <p>要按原样运行查询，没有bbox并在SRID 3857中返回数据：</p>
                        <p><code class="codeph">HTTP：//例如：8080 / MapViewer的/数据服务器/ mvdemo吨= THEME1＆SQL =选择+ * + +从城市＆to_srid = 3857＆BBOX = -122.0,25，-100,45＆ASIS =吨</code></p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="map-visualization-servers.html#GUID-A4529184-3550-4058-8EBB-C4670BB4233B">映射数据服务器请求参数</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="JIMPV10119"></a><div class="props_rev_3"><a id="GUID-11E24A20-1AA6-4A1E-A6DC-53FA29D94225" name="GUID-11E24A20-1AA6-4A1E-A6DC-53FA29D94225"></a><h5 id="JIMPV-GUID-11E24A20-1AA6-4A1E-A6DC-53FA29D94225" class="sect5"><span class="enumeration_section">3.1.2.3</span>从JDBC主题获取注释文本</h5>
                     <div>
                        <p>从JDBC主题检索注释文本元素的请求类似于<a href="map-visualization-servers.html#GUID-1D3893BD-9CCC-48B8-88DD-B62FEA2E33EE">从JDBC主题获取数据</a>的请求</p>
                        <p>以下参数可用于地图数据服务器请求，以基于动态JDBC主题从地图可视化工具主题获取数据。<code class="codeph">t</code> （主题名称）， <code class="codeph">sql</code> （SQL查询， <code class="codeph">geom_type</code>和<code class="codeph">base_table</code>参数是必需的;其他参数是可选的。
                        </p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">t</code> ：主题的名称。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">sql</code> ：完整的SQL查询，正确的URL编码。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">geom_type</code> ：必须指定为<code class="codeph">annotation</code>以指示空间列位于注释类型上。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">base_table</code> ：数据库表（用于服务器读取该表的注释文本元数据信息）。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">asis</code> ：确定查询是否应“按原样”执行。默认值为<code class="codeph">false</code> ，这会导致地图可视化工具将SQL查询作为其空间过滤器查询的子查询嵌入。如果值为<code class="codeph">true</code> ，则地图可视化工具不会尝试修改提供的查询字符串。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">bbox</code> ：边界框。必须是以逗号分隔的<code class="codeph">minx,miny,maxx,maxy</code> 。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">to_srid</code> ：SRID（空间参考系统），用于返回数据。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">bbox_srid</code> ：边界框的SRID（空间参照系），如果与数据的本机SRID不同。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">seq</code> ：序列ID，用于以多部分格式获取数据时使用。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">dadp</code> ：小数点后的位数：返回数据中坐标小数点后的最大位数。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">include_style_info</code> ：确定每个要素是否应包含样式信息（呈现/标记样式名称和相关列）。（默认为<code class="codeph">true</code> 。）
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">include_label_box</code> ：确定每个面要素中是否应包含标签框。（默认为<code class="codeph">true</code> 。）标签框是多边形内的近似最大矩形。放置在此矩形内的标签保证完全位于面要素内。对于非多边形要素，将忽略此参数。
                              </p>
                           </li>
                        </ul>
                        <p>以下示例检索注释文本信息：</p>
                        <p><code class="codeph">HTTP：//例如：8080 / MapViewer的/数据服务器/ tilsmenv吨= THEME1＆SQL =选择+ * + +从＆annotext_table = geom_col＆textobj = geom_type注释＆base_table = annotext_table＆BBOX = 0,0,10,10</code></p>
                        <p>典型的响应包括注释文本表元数据信息加注释文本特征。每个注释文本特征可以具有一个或多个文本元素。每个文本元素可以由文本值，位置，引导线和图形属性定义。有关其他信息，请参阅注释文本的OGC规范。</p>
                        <p>响应如下所示：</p><pre class="oac_no_warn" dir="ltr">{“type”：“AnnotationText”，“collectionName”：“theme1”，“srs”：0，“geodetic”：false，“bbox”：[0,0,10,10]，“attr_names”：[“ID “]，”attr_types“：[”double“]，”default_text_attributes“：{”fontWeight“：”Normal“，”fontStyle“：”Normal“，”textDecoration“：”None“，”letterSpacing“：”Normal“， “wordSpacing”： “正常”， “填充”： “黑”， “填充不透明度”：1.0， “中风”： “黑”， “strokeWidth”：1.0， “笔画不透明度”：1.0 “的HorizontalAlignment”： “start”，“verticalAlignment”：“top”，“multilineJustification”：“left”，“multilineSpacing”：0.0}，“metadata”：{“textExpression”：“name”，“textAttributes”：{“fontFamily”：“ Serif“，”fontSize“：14.0，”fill“：”＃ff0000“}}，”features“：[{”type“：”AnnoText“，”elements“：[{”location“：{”type“：”点“，”坐标“：[1,1]}，”textValue“：”样本标签1“，”leaderLine“：{”type“：”LineString“，”坐标“：[0,0,1,1] }}，“envelope”：{“type”：“Rectangle”，“coordinates”：[0,0,1,1]}，“properties”：{“ID”：“1.0”}}，{“type “：”AnnoText“，”elements“：[{”location“：{”type“：”LineString“，”coordinates“：[2,5,4,5,6,5]}，”leaderLine“：{”键入 “：” LINEST ring“，”坐标“：[4,3,4,5]}，”textAttributes“：{”fontFamily“：”Dialog“，”fontSize“：14.0，”fill“：”blue“}}]，”信封“：{”type“：”Rectangle“，”coordinates“：[2,3,6,5]}，”properties“：{”ID“：”3.0“}}，{”type“：”AnnoText“， “elements”：[{“location”：{“type”：“Point”，“coordinates”：[10,10]}，“textValue”：“Sample Label 2”，“leaderLine”：{“type”：“ LineString“，”坐标“：[5,10,10,10]}}]，”envelope“：{”type“：”LineString“，”coordinates“：[5,10,10,10]}，”属性“：{{ID”：“2.0”}}}}</pre></div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="map-visualization-servers.html#GUID-A4529184-3550-4058-8EBB-C4670BB4233B">映射数据服务器请求参数</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="JIMPV10120"></a><div class="props_rev_3"><a id="GUID-7CDCDBF2-D41D-49B5-8F18-D73E016515F4" name="GUID-7CDCDBF2-D41D-49B5-8F18-D73E016515F4"></a><h5 id="JIMPV-GUID-7CDCDBF2-D41D-49B5-8F18-D73E016515F4" class="sect5"><span class="enumeration_section">3.1.2.4</span>获取拓扑数据</h5>
                     <div>
                        <p>拓扑集由一组拓扑基元（面，边和节点（。每个拓扑特征可以与一个或多个拓扑基元相关联。</p>
                        <p>检索拓扑基元的请求必须包含<code class="codeph">topology</code>参数，如以下示例所示：</p>
                        <p><code class="codeph">HTTP：//例如：8080 / MapViewer的/数据服务器/ tilsmenv拓扑= city_data＆BBOX = 10,10,35,35？</code></p>
                        <p>响应包括与输入MBR交互的所有原语：</p><pre class="oac_no_warn" dir="ltr">{“type”：“TopologyPrimitives”，“topology”：“city_data”，“srs”：0，“bbox”：[0,0,62,42]，“face_attr_names”：[“FACE_ID”，“BOUNDARY_EDGE_ID”， “ISLAND_EDGE_ID_LIST”，“ISLAND_NODE_ID_LIST”]，“face_attr_types”：[“整数”，“整数”，“数组：整数”，“数组：整数”]，“edge_attr_names”：[“EDGE_ID”，“START_NODE_ID”，“END_NODE_ID” “，”NEXT_LEFT_EDGE_ID“，”PREV_LEFT_EDGE_ID“，”NEXT_RIGHT_EDGE_ID“，”PREV_RIGHT_EDGE_ID“，”LEFT_FACE_ID“，”RIGHT_FACE_ID“]，”edge_attr_types“：[”整数“，”整数“，”整数“，”整数“，”整数“，”整数“，”整数“，”整数“，”整数“]，”node_attr_names“：[”NODE_ID“，”EDGE_ID“，”FACE_ID“]，”node_attr_types“：[”整数“，”整数“， “integer”]，“primitives”：[{“type”：“Face”，“mbr_geometry”：{“type”：“Rectangle”，“coordinates”：[3,30,15,38]}，“properties” ：{“FACE_ID”：“1”，“BOUNDARY_EDGE_ID”：“1”，“ISLAND_EDGE_ID_LIST”：[25]}}，{“type”：“Face”，“mbr_geometry”：{“type”：“Rectangle”， “coordinates”：[9,14,21,22]}，“properties”：{“FACE_ID”：“3”，“BOUNDARY_EDGE_ID”：“19”}}，{“type”：“Face”，“mbr_geometry” ：{ “类型”：“矩形angle“，”坐标“：[9,6,21,14]}，”properties“：{”FACE_ID“：”6“，”BOUNDARY_EDGE_ID“：”20“}}，{”type“：”Face“， “mbr_geometry”：{“type”：“Rectangle”，“coordinates”：[17,30,31,40]}，“properties”：{“FACE_ID”：“2”，“BOUNDARY_EDGE_ID”：“2”，“ ISLAND_NODE_ID_LIST“：[4]}}，{”type“：”Face“，”mbr_geometry“：{”type“：”Rectangle“，”coordinates“：[21,6,35,14]}，”properties“： {“FACE_ID”：“7”，“BOUNDARY_EDGE_ID”：“10”}}，{“type”：“Face”，“mbr_geometry”：{“type”：“Rectangle”，“coordinates”：[21,14， 35,22]}，“properties”：{“FACE_ID”：“4”，“BOUNDARY_EDGE_ID”：“17”}}，{“type”：“Face”，“mbr_geometry”：{“type”：“Rectangle” ，“coordinates”：[35,14,47,22]}，“properties”：{“FACE_ID”：“5”，“BOUNDARY_EDGE_ID”：“15”}}，{“type”：“Face”，“mbr_geometry “：{”type“：”Rectangle“，”coordinates“：[35,6,47,14]}，”properties“：{”FACE_ID“：”8“，”BOUNDARY_EDGE_ID“：”16“}}，{ “type”：“Edge”，“geometry”：{“type”：“LineString”，“coordinates”：[8,30,16,30,16,38,3,38,3,30,8,30] }，“properties”：{“EDGE_ID”：“1”，“START_NODE_ID”：“1”，“END_NODE_ID”：“1”，“NEXT_LEFT_EDGE_ID”：“1”，“ PREV_LEFT_EDGE_ID“：”1“，”NEXT_RIGHT_EDGE_ID“：” -  1“，”PREV_RIGHT_EDGE_ID“：” -  1“，”LEFT_FACE_ID“：”1“，”RIGHT_FACE_ID“：” -  1“}}，{”type“：” Edge“，”geometry“：{”type“：”LineString“，”coordinates“：[4,31,7,31,7,34,4,34,4,31]}，”properties“：{”EDGE_ID “：”26“，”START_NODE_ID“：”20“，”END_NODE_ID“：”20“，”NEXT_LEFT_EDGE_ID“：”26“，”PREV_LEFT_EDGE_ID“：”26“，”NEXT_RIGHT_EDGE_ID“：” -  26“，”PREV_RIGHT_EDGE_ID“ ：“ -  26”，“LEFT_FACE_ID”：“9”，“RIGHT_FACE_ID”：“1”}}，{“type”：“Edge”，“geometry”：{“type”：“LineString”，“coordinates”： [9,22,21,22]}，“properties”：{“EDGE_ID”：“6”，“START_NODE_ID”：“16”，“END_NODE_ID”：“17”，“NEXT_LEFT_EDGE_ID”：“7”，“PREV_LEFT_EDGE_ID “：”21“，”NEXT_RIGHT_EDGE_ID“：” -  21“，”PREV_RIGHT_EDGE_ID“：”19“，”LEFT_FACE_ID“：” -  1“，”RIGHT_FACE_ID“：”3“}}，{”type“：”Edge“ ，“geometry”：{“type”：“LineString”，“coordinates”：[9,14,9,22]}，“properties”：{“EDGE_ID”：“21”，“START_NODE_ID”：“15”， “END_NODE_ID”：“16”，“NEXT_LEFT_EDGE_ID”：“6”，“PREV_LEFT_EDGE_ID”：“22”，“NEXT_RIGHT_EDGE_ID”：“9”，“PREV_RIGHT_EDGE_ID”：“ -  6”，“LEFT_FACE_ ID“：” -  1“，”RIGHT_FACE_ID“：”3“}}，{”type“：”Edge“，”geometry“：{”type“：”LineString“，”coordinates“：[9,14,21 ，14，}，“properties”：{“EDGE_ID”：“9”，“START_NODE_ID”：“15”，“END_NODE_ID”：“14”，“NEXT_LEFT_EDGE_ID”：“19”，“PREV_LEFT_EDGE_ID”：“ -  21” ，“NEXT_RIGHT_EDGE_ID”：“ -  22”，“PREV_RIGHT_EDGE_ID”：“20”，“LEFT_FACE_ID”：“3”，“RIGHT_FACE_ID”：“6”}}，{“type”：“Edge”，“geometry”：{ “type”：“LineString”，“coordinates”：[9,6,21,6]}，“properties”：{“EDGE_ID”：“12”，“START_NODE_ID”：“8”，“END_NODE_ID”：“9 “，”NEXT_LEFT_EDGE_ID“：”20“，”PREV_LEFT_EDGE_ID“：” -  22“，”NEXT_RIGHT_EDGE_ID“：”22“，”PREV_RIGHT_EDGE_ID“：” -  13“，”LEFT_FACE_ID“：”6“，”RIGHT_FACE_ID“：” - 1“}}，{”type“：”Edge“，”geometry“：{”type“：”LineString“，”coordinates“：[9,35,13,35]}，”properties“：{”EDGE_ID“ ：“25”，“START_NODE_ID”：“21”，“END_NODE_ID”：“22”，“NEXT_LEFT_EDGE_ID”：“ -  25”，“PREV_LEFT_EDGE_ID”：“ -  25”，“NEXT_RIGHT_EDGE_ID”：“25”，“PREV_RIGHT_EDGE_ID” ：“25”，“LEFT_FACE_ID”：“1”，“RIGHT_FACE_ID”：“1”}}，{“type”：“Edge”，“geometry”：{“type”：“LineString”，“coordinates”：[ 9,6， 9,14]}，“properties”：{“EDGE_ID”：“22”，“START_NODE_ID”：“8”，“END_NODE_ID”：“15”，“NEXT_LEFT_EDGE_ID”：“21”，“PREV_LEFT_EDGE_ID”：“ -  12 “，”NEXT_RIGHT_EDGE_ID“：”12“，”PREV_RIGHT_EDGE_ID“：” -  9“，”LEFT_FACE_ID“：” -  1“，”RIGHT_FACE_ID“：”6“}}，{”type“：”Edge“，”geometry“ ：{“type”：“LineString”，“coordinates”：[25,30,31,30,31,40,17,40,17,30,25,30]}，“properties”：{“EDGE_ID”： “2”，“START_NODE_ID”：“2”，“END_NODE_ID”：“2”，“NEXT_LEFT_EDGE_ID”：“3”，“PREV_LEFT_EDGE_ID”：“ -  3”，“NEXT_RIGHT_EDGE_ID”：“ -  2”，“PREV_RIGHT_EDGE_ID”： “-2”，“LEFT_FACE_ID”：“2”，“RIGHT_FACE_ID”：“ -  1”}}，{“type”：“Edge”，“geometry”：{“type”：“LineString”，“coordinates”： [21,6,35,6]}，“properties”：{“EDGE_ID”：“13”，“START_NODE_ID”：“9”，“END_NODE_ID”：“10”，“NEXT_LEFT_EDGE_ID”：“18”，“PREV_LEFT_EDGE_ID “：” -  20“，”NEXT_RIGHT_EDGE_ID“：” -  12“，”PREV_RIGHT_EDGE_ID“：” -  14“，”LEFT_FACE_ID“：”7“，”RIGHT_FACE_ID“：” -  1“}}，{”type“：” Edge“，”geometry“：{”type“：”LineString“，”coordinates“：[21,22,35,22]}，”properties“：{”EDGE_ID“：”7“，”START_NODE_ID“：”17 “，”END_NODE_ID“：”18“ ，“NEXT_LEFT_EDGE_ID”：“8”，“PREV_LEFT_EDGE_ID”：“6”，“NEXT_RIGHT_EDGE_ID”：“ -  19”，“PREV_RIGHT_EDGE_ID”：“17”，“LEFT_FACE_ID”：“ -  1”，“RIGHT_FACE_ID”：“4” }，{“type”：“Edge”，“geometry”：{“type”：“LineString”，“coordinates”：[21,6,21,14]}，“properties”：{“EDGE_ID”：“ 20“，”START_NODE_ID“：”9“，”END_NODE_ID“：”14“，”NEXT_LEFT_EDGE_ID“：” -  9“，”PREV_LEFT_EDGE_ID“：”12“，”NEXT_RIGHT_EDGE_ID“：”13“，”PREV_RIGHT_EDGE_ID“：”10 “，”LEFT_FACE_ID“：”6“，”RIGHT_FACE_ID“：”7“}}，{”type“：”Edge“，”geometry“：{”type“：”LineString“，”coordinates“：[35,14 ，21,14]}，“properties”：{“EDGE_ID”：“10”，“START_NODE_ID”：“13”，“END_NODE_ID”：“14”，“NEXT_LEFT_EDGE_ID”：“ -  20”，“PREV_LEFT_EDGE_ID”：“ 18“，”NEXT_RIGHT_EDGE_ID“：”17“，”PREV_RIGHT_EDGE_ID“：” -  19“，”LEFT_FACE_ID“：”7“，”RIGHT_FACE_ID“：”4“}}，{”type“：”Edge“，”geometry“ ：{“type”：“LineString”，“coordinates”：[21,14,21,22]}，“properties”：{“EDGE_ID”：“19”，“START_NODE_ID”：“14”，“END_NODE_ID”： “17”，“NEXT_LEFT_EDGE_ID”：“ -  6”，“PREV_LEFT_EDGE_ID”：“9”，“NEXT_RIGHT_EDGE_ID”：“ -  10”，“PREV_RIGHT_EDGE_ID” “：” -  7“，”LEFT_FACE_ID“：”3“，”RIGHT_FACE_ID“：”4“}}，{”type“：”Edge“，”geometry“：{”type“：”LineString“，”coordinates“ ：[25,30,25,35]}，“properties”：{“EDGE_ID”：“3”，“START_NODE_ID”：“2”，“END_NODE_ID”：“3”，“NEXT_LEFT_EDGE_ID”：“ -  3”， “PREV_LEFT_EDGE_ID”：“2”，“NEXT_RIGHT_EDGE_ID”：“2”，“PREV_RIGHT_EDGE_ID”：“3”，“LEFT_FACE_ID”：“2”，“RIGHT_FACE_ID”：“2”}}，{“type”：“Edge” ，“geometry”：{“type”：“LineString”，“coordinates”：[35,6,47,6]}，“properties”：{“EDGE_ID”：“14”，“START_NODE_ID”：“10”， “END_NODE_ID”：“11”，“NEXT_LEFT_EDGE_ID”：“16”，“PREV_LEFT_EDGE_ID”：“ -  18”，“NEXT_RIGHT_EDGE_ID”：“ -  13”，“PREV_RIGHT_EDGE_ID”：“ -  16”，“LEFT_FACE_ID”：“8” ，“RIGHT_FACE_ID”：“ -  1”}}，{“type”：“Edge”，“geometry”：{“type”：“LineString”，“coordinates”：[35,14,47,14]}，“ properties“：{”EDGE_ID“：”11“，”START_NODE_ID“：”13“，”END_NODE_ID“：”12“，”NEXT_LEFT_EDGE_ID“：”15“，”PREV_LEFT_EDGE_ID“：” -  17“，”NEXT_RIGHT_EDGE_ID“：” -18“，”PREV_RIGHT_EDGE_ID“：”16“，”LEFT_FACE_ID“：”5“，”RIGHT_FACE_ID“：”8“}}，{”type“：”Edge“，”geometry“：{”type“：”LineString “， “C oordinates“：[35,6,35,14]}，”properties“：{”EDGE_ID“：”18“，”START_NODE_ID“：”10“，”END_NODE_ID“：”13“，”NEXT_LEFT_EDGE_ID“：”10“ ，“PREV_LEFT_EDGE_ID”：“13”，“NEXT_RIGHT_EDGE_ID”：“ -  14”，“PREV_RIGHT_EDGE_ID”：“ -  11”，“LEFT_FACE_ID”：“7”，“RIGHT_FACE_ID”：“8”}}，{“type”：“ Edge“，”geometry“：{”type“：”LineString“，”coordinates“：[35,22,47,22]}，”properties“：{”EDGE_ID“：”8“，”START_NODE_ID“：”18 “，”END_NODE_ID“：”19“，”NEXT_LEFT_EDGE_ID“：” -  15“，”PREV_LEFT_EDGE_ID“：”7“，”NEXT_RIGHT_EDGE_ID“：” -  17“，”PREV_RIGHT_EDGE_ID“：”15“，”LEFT_FACE_ID“：” - 1“，”RIGHT_FACE_ID“：”5“}}，{”type“：”Edge“，”geometry“：{”type“：”LineString“，”coordinates“：[35,14,35,22]}， “properties”：{“EDGE_ID”：“17”，“START_NODE_ID”：“13”，“END_NODE_ID”：“18”，“NEXT_LEFT_EDGE_ID”：“ -  7”，“PREV_LEFT_EDGE_ID”：“ -  10”，“NEXT_RIGHT_EDGE_ID” ：“11”，“PREV_RIGHT_EDGE_ID”：“ -  8”，“LEFT_FACE_ID”：“4”，“RIGHT_FACE_ID”：“5”}}，{“type”：“Edge”，“geometry”：{“type”： “LineString”，“坐标”：[36,38,38,35,41,34,42,33,45,32,47,28,50,28,52,32,57,33]}，“属性” ：{ “EDGE_ID”： “4”， “START_NODE_ID”：“5”，“END_NODE_ID”：“6”，“NEXT_LEFT_EDGE_ID”：“ -  5”，“PREV_LEFT_EDGE_ID”：“ -  4”，“NEXT_RIGHT_EDGE_ID”：“4”，“PREV_RIGHT_EDGE_ID”：“5”， “LEFT_FACE_ID”：“ -  1”，“RIGHT_FACE_ID”：“ -  1”}}，{“type”：“Edge”，“geometry”：{“type”：“LineString”，“coordinates”：[41,40 ，45,40,47,42,62,41,61,38,59,39,57,36,57,33]}，“properties”：{“EDGE_ID”：“5”，“START_NODE_ID”：“7 “，”END_NODE_ID“：”6“，”NEXT_LEFT_EDGE_ID“：” -  4“，”PREV_LEFT_EDGE_ID“：” -  5“，”NEXT_RIGHT_EDGE_ID“：”5“，”PREV_RIGHT_EDGE_ID“：”4“，”LEFT_FACE_ID“：” - 1“，”RIGHT_FACE_ID“：” -  1“}}，{”type“：”Edge“，”geometry“：{”type“：”LineString“，”coordinates“：[47,14,47,22]} ，“properties”：{“EDGE_ID”：“15”，“START_NODE_ID”：“12”，“END_NODE_ID”：“19”，“NEXT_LEFT_EDGE_ID”：“ -  8”，“PREV_LEFT_EDGE_ID”：“11”，“NEXT_RIGHT_EDGE_ID” ：“ -  16”，“PREV_RIGHT_EDGE_ID”：“8”，“LEFT_FACE_ID”：“5”，“RIGHT_FACE_ID”：“ -  1”}}，{“type”：“Edge”，“geometry”：{“type” ：“LineString”，“coordinates”：[47,6,47,14]}，“properties”：{“EDGE_ID”：“16”，“START_NODE_ID”：“11”，“END_NODE_ID”：“12”，“ NEXT_LEFT_EDGE_ID “：”  -  11" ， “PREV_LEFT_EDGE_ID”：“14”，“NEXT_RIGHT_EDGE_ID”：“ -  14”，“PREV_RIGHT_EDGE_ID”：“ -  15”，“LEFT_FACE_ID”：“8”，“RIGHT_FACE_ID”：“ -  1”}}，{“type”： “节点”，“几何”：{“type”：“Point”，“coordinates”：[4,31]}，“properties”：{“NODE_ID”：“20”，“EDGE_ID”：“26”，“ FACE_ID“：”0“}}，{”type“：”Node“，”geometry“：{”type“：”Point“，”coordinates“：[8,30]}，”properties“：{”NODE_ID“ ：“1”，“EDGE_ID”：“1”，“FACE_ID”：“0”}}，{“type”：“Node”，“geometry”：{“type”：“Point”，“coordinates”：[ 9,6“}，”properties“：{”NODE_ID“：”8“，”EDGE_ID“：”12“，”FACE_ID“：”0“}}，{”type“：”Node“，”geometry“： {“type”：“Point”，“coordinates”：[9,35]}，“properties”：{“NODE_ID”：“21”，“EDGE_ID”：“25”，“FACE_ID”：“0”}} ，{“type”：“Node”，“geometry”：{“type”：“Point”，“coordinates”：[9,14]}，“properties”：{“NODE_ID”：“15”，“EDGE_ID” ：“21”，“FACE_ID”：“0”}}，{“type”：“Node”，“geometry”：{“type”：“Point”，“coordinates”：[9,22]}，“properties” “：{”NODE_ID“：”16“，”EDGE_ID“：”6“，”FACE_ID“：”0“}}，{”type“：”节点“，”几何“：{”type“：”Point“ ，“coordinates”：[13,35]}，“properties”：{“NODE_ID” ：“22”，“EDGE_ID”：“ -  25”，“FACE_ID”：“0”}}，{“type”：“Node”，“geometry”：{“type”：“Point”，“coordinates”： [20,37]}，“properties”：{“NODE_ID”：“4”，“EDGE_ID”：“0”，“FACE_ID”：“2”}}，{“type”：“Node”，“geometry” ：{“type”：“Point”，“coordinates”：[21,14]}，“properties”：{“NODE_ID”：“14”，“EDGE_ID”：“19”，“FACE_ID”：“0”} }，{“type”：“Node”，“geometry”：{“type”：“Point”，“coordinates”：[21,22]}，“properties”：{“NODE_ID”：“17”，“EDGE_ID” “：”7“，”FACE_ID“：”0“}}，{”type“：”Node“，”geometry“：{”type“：”Point“，”coordinates“：[21,6]}，” properties“：{”NODE_ID“：”9“，”EDGE_ID“：”20“，”FACE_ID“：”0“}}，{”type“：”Node“，”geometry“：{”type“：”Point“ “，”坐标“：[25,30]}，”properties“：{”NODE_ID“：”2“，”EDGE_ID“：”2“，”FACE_ID“：”0“}}，{”type“：”节点“，”几何“：{”type“：”Point“，”coordinates“：[25,35]}，”properties“：{”NODE_ID“：”3“，”EDGE_ID“：” -  3“，” FACE_ID“：”0“}}，{”type“：”Node“，”geometry“：{”type“：”Point“，”coordinates“：[35,14]}，”properties“：{”NODE_ID“ ：“13”，“EDGE_ID”：“17”，“FACE_ID”：“0”}}，{“type”：“Node”，“geometry”：{“type”：“Point”， “coordinates”：[35,6]}，“properties”：{“NODE_ID”：“10”，“EDGE_ID”：“18”，“FACE_ID”：“0”}}，{“type”：“Node” ，“geometry”：{“type”：“Point”，“coordinates”：[35,22]}，“properties”：{“NODE_ID”：“18”，“EDGE_ID”：“8”，“FACE_ID”： “0”}}，{“type”：“Node”，“geometry”：{“type”：“Point”，“coordinates”：[36,38]}，“properties”：{“NODE_ID”：“5 “，”EDGE_ID“：”4“，”FACE_ID“：”0“}}，{”type“：”Node“，”geometry“：{”type“：”Point“，”coordinates“：[41,40 ]，“properties”：{“NODE_ID”：“7”，“EDGE_ID”：“5”，“FACE_ID”：“0”}}，{“type”：“Node”，“geometry”：{“type “：”点“，”坐标“：[47,14]}，”属性“：{”NODE_ID“：”12“，”EDGE_ID“：”15“，”FACE_ID“：”0“}}，{” type“：”Node“，”geometry“：{”type“：”Point“，”coordinates“：[47,6]}，”properties“：{”NODE_ID“：”11“，”EDGE_ID“：” - 14“，”FACE_ID“：”0“}}，{”type“：”Node“，”geometry“：{”type“：”Point“，”coordinates“：[47,22]}，”properties“： {“NODE_ID”：“19”，“EDGE_ID”：“ -  15”，“FACE_ID”：“0”}}，{“type”：“Node”，“geometry”：{“type”：“Point”， “coordinates”：[57,33]}，“properties”：{“NODE_ID”：“6”，“EDGE_ID”：“ -  4”，“FACE_ID”： “0”}}]}</pre><p>要检索拓扑功能，以下示例指定<code class="codeph">topology</code> ， <code class="codeph">base_table</code>和<code class="codeph">geom_col</code>参数（其中<code class="codeph">grom_col</code>指拓扑列）：</p>
                        <p><code class="codeph">HTTP：//例如：8080 / MapViewer的/数据服务器/ tilsmenv拓扑= city_data＆base_table = land_parcels＆geom_col =特征</code></p>
                        <p>对此请求的响应类似于以下内容：</p><pre class="oac_no_warn" dir="ltr">{“type”：“TopologyFeatures”，“topology”：“CITY_DATA”，“topology_id”：5，“topology_owner”：“TILSZUSER”，“tolerance”：5.0E-5，“srs”：0，“table_schema”： “TILSZUSER”，“table_name”：“LAND_PARCELS”，“topo_column”：“FEATURE”，“layer_id”：1，“layer_type”：“POLYGON”，“layer_level”：0，“child_layer”：0，“node_sequence”： “CITY_DATA_NODE_S”，“edge_sequence”：“CITY_DATA_EDGE_S”，“face_sequence”：“CITY_DATA_FACE_S”，“feature_sequence”：“CITY_DATA_TG_S”，“digits_right_decimal”：16，“attr_names”：[“FEATURE_NAME”]，“attr_types”：[“ string“]，”features“：[{”type“：”topology“，”tg_id“：4，”primitives“：[{”topo_id“：3，”topo_type“：3}，{”topo_id“：6， “topo_type”：3}]，“properties”：{“FEATURE_NAME”：“P1”}}，{“type”：“topology”，“tg_id”：5，“primitives”：[{“topo_id”：4， “topo_type”：3}，{“topo_id”：7，“topo_type”：3}]，“properties”：{“FEATURE_NAME”：“P2”}}，{“type”：“topology”，“tg_id”： 6，“原语”：[{“topo_id”：5，“topo_type”：3}，{“topo_id”：8，“topo_type”：3}]，“properties”：{“FEATURE_NAME”：“P3”}} ，{“type”：“topology”，“tg_id”：7，“primitives”：[{“topo_id”：2 ，“topo_type”：3}]，“properties”：{“FEATURE_NAME”：“P4”}}，{“type”：“topology”，“tg_id”：8，“primitives”：[{“topo_id”：1 ，“topo_type”：3}]，“属性”：{“FEATURE_NAME”：“P5”}}]}</pre><p>对于特定的基本面，边和节点，以下示例定义基元标识符：</p>
                        <p><code class="codeph">HTTP：//例如：8080 / MapViewer的/数据服务器/ tilsmenv拓扑= city_data＆face_ids = -1＆edge_ids = 3,4 node_ids = 5</code></p>
                        <p>对此请求的响应类似于以下内容：</p><pre class="oac_no_warn" dir="ltr">{“type”：“TopologyPrimitives”，“topology”：“city_data”，“srs”：0，“bbox”：[0,0,57,38]，“face_attr_names”：[“FACE_ID”，“BOUNDARY_EDGE_ID”， “ISLAND_EDGE_ID_LIST”，“ISLAND_NODE_ID_LIST”]，“face_attr_types”：[“整数”，“整数”，“数组：整数”，“数组：整数”]，“edge_attr_names”：[“EDGE_ID”，“START_NODE_ID”，“END_NODE_ID” “，”NEXT_LEFT_EDGE_ID“，”PREV_LEFT_EDGE_ID“，”NEXT_RIGHT_EDGE_ID“，”PREV_RIGHT_EDGE_ID“，”LEFT_FACE_ID“，”RIGHT_FACE_ID“]，”edge_attr_types“：[”整数“，”整数“，”整数“，”整数“，”整数“，”整数“，”整数“，”整数“，”整数“]，”node_attr_names“：[”NODE_ID“，”EDGE_ID“，”FACE_ID“]，”node_attr_types“：[”整数“，”整数“， “integer”]，“primitives”：[{“type”：“Face”，“properties”：{“FACE_ID”：“ -  1”，“BOUNDARY_EDGE_ID”：“0”，“ISLAND_EDGE_ID_LIST”：[ -  1， - 2,4,6]}}，{“type”：“Edge”，“geometry”：{“type”：“LineString”，“coordinates”：[25,30,25,35]}，“properties”： {“EDGE_ID”：“3”，“START_NODE_ID”：“2”，“END_NODE_ID”：“3”，“NEXT_LEFT_EDGE_ID”：“ -  3”，“PREV_LEFT_EDGE_ID”：“2”，“NEXT_RIGHT_EDGE_ID”：“2”， “PREV_RIGHT_E DGE_ID“：”3“，”LEFT_FACE_ID“：”2“，”RIGHT_FACE_ID“：”2“}}，{”type“：”Edge“，”geometry“：{”type“：”LineString“，”coordinates“ ：[36,38,38,35,41,34,42,33,45,32,47,28,50,28,52,32,57,33]}，“properties”：{“EDGE_ID”：“ 4“，”START_NODE_ID“：”5“，”END_NODE_ID“：”6“，”NEXT_LEFT_EDGE_ID“：” -  5“，”PREV_LEFT_EDGE_ID“：” -  4“，”NEXT_RIGHT_EDGE_ID“：”4“，”PREV_RIGHT_EDGE_ID“：” 5“，”LEFT_FACE_ID“：” -  1“，”RIGHT_FACE_ID“：” -  1“}}，{”type“：”Node“，”geometry“：{”type“：”Point“，”coordinates“：[ 36,38]}，“properties”：{“NODE_ID”：“5”，“EDGE_ID”：“4”，“FACE_ID”：“0”}}}}</pre></div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="map-visualization-servers.html#GUID-A4529184-3550-4058-8EBB-C4670BB4233B">映射数据服务器请求参数</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div><a id="JIMPV10121"></a><div class="props_rev_3"><a id="GUID-28D5721C-1246-4C56-8602-3DB9CC05D1F3" name="GUID-28D5721C-1246-4C56-8602-3DB9CC05D1F3"></a><h4 id="JIMPV-GUID-28D5721C-1246-4C56-8602-3DB9CC05D1F3" class="sect4"><span class="enumeration_section">3.1.3</span>解释从地图数据服务器返回的数据</h4>
                  <div>
                     <p>地图数据服务器以压缩的GeoJSON格式返回数据。对标准GeoJSON进行了一些小的更改和添加，以提高性能和信息的实用性。</p>
                     <p>以下是示例回复：</p><pre class="oac_no_warn" dir="ltr">{“type”：“FeatureCollection”，“collectionName”：“theme1”，“srs”：3857，“geodetic”：false，“bbox”：[ -  17566686.86258,2414218.89842，-7905675.57465,8629389.76988]，“attr_names”：[ “CITY”，“STATE_ABRV”，“POP90”，“RANK90”]，“attr_types”：[“string”，“string”，“double”，“double”]，“features”：[{“type”：“特征“，”_ id“：”AAASQ3AAEAAAAMbAAA“，”几何“：{”type“：”Point“，”coordinates“：[ -  119.99823,38.9052]}，”properties“：{”CITY“：”SOUTH LAKE TAHOE“ ，“SALES”：“125.8”，“NAME”：“Y的工厂商店”，“_ label _”：“Y的工厂商店”，“风格”：{“渲染”：{“style”：“M .SMALL CIRCLE“}，”标签“：{”style“：”T.RED STREET“，”栏“：[”_ label_“]}}}，{”type“：”Feature“，”_ id“：”AAASQ3AAEAAAAMbAAB “，”geometry“：{”type“：”Point“，”coordinates“：[ -  121.95073,37.53356]}，”properties“：{”CITY“：”FREMONT“，”SALES“：”186.8“，”NAME“ “：”OHLONE VILLAGE“，”_ label _“：”OHLONE VILLAGE“}，”styles“：{”rendering“：{”style“：”M.SMALL CIRCLE“}，”label“：{”style“：”T .RED STREET“，”栏“：[”_ label_“]}}}，{”type“：”Feature“，”_ id“：”AAASQ3AAEAAAAMbAAC“，”ge ometry“：{”type“：”Point“，”coordinates“：[ -  118.48844,34.02353]}，”properties“：{”CITY“：”SANTA MONICA“，”SALES“：”9.1“，”NAME“： “SANTA MONICA PLACE”，“_ label _”：“SANTA MONICA PLACE”}，“styles”：{“rendering”：{“style”：“M.SMALL CIRCLE”}，“labels”：{“style”：“T .RED STREET“，”栏“：[”_ label_“]}}}，{”type“：”Feature“，”_ id“：”AAASQ3AAEAAAAMbAAD“，”geometry“：{”type“：”Point“，”坐标“：[ -  118.55093,34.42104]}，”properties“：{”CITY“：”SANTA CLARITA“，”SALES“：”52.6“，”NAME“：”VALENCIA TOWN CENTER“，”_ label _“：”VALENCIA TOWN CENTER “}，”styles“：{”rendering“：{”style“：”M.SMALL CIRCLE“}，”labels“：{”style“：”T.RED STREET“，”columns“：[”_ label_“] }，}“”type“：”Feature“，”_ id“：”AAASQ3AAEAAAAMbAAE“，”geometry“：{”type“：”Point“，”coordinates“：[ -  122.56007,38.08187]}，”properties“： {“CITY”：“NOVATO”，“SALES”：“119.1”，“NAME”：“VOTAGE OAKS NOVATO”，“_ label _”：“VINTAGE OAKS NOVATO”}，“styles”：{“rendering”：{ “style”：“M.SMALL CIRCLE”}，“标签”：{“style”：“T.RED STREET”，“columns”：[“_ label_”]}}}}}</pre><p>响应包含最小标头和一系列功能。标题包括空间参考系（ <code class="codeph">srs</code> ）ID和结果数据的最小边界框。功能数组包括属性名称及其类型。可能的类型名称包括： <code class="codeph">"byte","short","int","long","float","double","char","string","boolean", "date"</code></p>
                     <p>对于每个功能，以下字段适用：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">type</code> ：始终<code class="codeph">Feature</code> 。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">_id</code> ：可选ID或键属性。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">geometry</code> ：以修改后的GeoJSON格式编码的实际几何体。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">properties</code> ：包含要素的所有属性（名称 - 值对）的对象。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">styles</code> ：可选的样式信息对象。包含两个嵌入对象， <code class="codeph">rendering</code>和<code class="codeph">labeling</code> ，它们共享相同的结构：基本上是一个包含<code class="codeph">style</code>字段和可选<code class="codeph">columns</code>数组的对象。目前只有预定义的主题支持包括响应中的样式信息;动态主题的响应不包含样式信息。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">label_box</code> ：一个4元素数组，指定标签框的<code class="codeph">minX</code> ， <code class="codeph">minY</code> ， <code class="codeph">maxX</code>和<code class="codeph">maxY</code> 。只有多边形可以有一个标签框。
                           </p>
                        </li>
                     </ul>
                     <p>请注意，标签文本始终作为伪属性包含在属性列表中，名称为<code class="codeph">_label_</code> 。
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="map-visualization-servers.html#GUID-3A6C41AB-66DC-40D7-8B3A-9B2F7A1ED58F" title="地图可视化器地图数据服务器提供用于将实时数据从数据库服务器流式传输到客户端的服务。">映射Visualizer Map数据服务器</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="JIMPV10122"></a><div class="props_rev_3"><a id="GUID-13559073-0FDA-461A-8A71-826722F2AEC5" name="GUID-13559073-0FDA-461A-8A71-826722F2AEC5"></a><h4 id="JIMPV-GUID-13559073-0FDA-461A-8A71-826722F2AEC5" class="sect4"><span class="enumeration_section">3.1.4</span>映射数据服务器错误处理</h4>
                  <div>
                     <p>如果地图数据服务器无法处理数据请求，它将发送包含错误对象的JSON响应。此JSON错误对象可能如下所示：</p><pre class="oac_no_warn" dir="ltr">{“error”：{“code”：“ora-500”，“message”：“请求的表不存在”，“详细信息”：“这里可能是堆栈跟踪...”}}</pre><p>在前面的JSON对象中， <code class="codeph">code</code>是只有地图数据服务器知道的错误代码， <code class="codeph">message</code>包含可以在警告对话框中显示给最终用户的短消息， <code class="codeph">details</code>是可选字段，可能包含更多详细信息（例如如果包括堆栈跟踪）。
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="map-visualization-servers.html#GUID-3A6C41AB-66DC-40D7-8B3A-9B2F7A1ED58F" title="地图可视化器地图数据服务器提供用于将实时数据从数据库服务器流式传输到客户端的服务。">映射Visualizer Map数据服务器</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="JIMPV9794"></a><a id="JIMPV9793"></a><div class="props_rev_3"><a id="GUID-7E88B130-FB2F-47D1-A8B2-909CFB1454AC" name="GUID-7E88B130-FB2F-47D1-A8B2-909CFB1454AC"></a><h3 id="JIMPV-GUID-7E88B130-FB2F-47D1-A8B2-909CFB1454AC" class="sect3"><span class="enumeration_section">3.2</span>映射平铺服务器</h3>
               <div>
                  <p>地图图块服务器是一种地图图像缓存引擎，用于获取，缓存和提供预生成的固定大小的地图图像图块。</p>
                  <p>它作为Java servlet实现，它是map可视化服务器的一部分。地图图块服务器接受请求由图块缩放级别和图块位置（网格代码）指定的地图图像图块的请求，并将请求的图块发送回客户端。</p>
                  <p><a href="map-visualization-servers.html#GUID-7E88B130-FB2F-47D1-A8B2-909CFB1454AC__BABCGFGD">图3-1</a>显示了地图图块服务器的基本工作流程。
                  </p>
                  <div class="figure" id="GUID-7E88B130-FB2F-47D1-A8B2-909CFB1454AC__BABCGFGD">
                     <p class="titleinfigure">图3-1 Map Tile Server的工作流程</p><img src="img/workflow_omaps.jpg" alt="下面是图3-1的描述" title="下面是图3-1的描述" longdesc="img_text/workflow_omaps.html"><br><a href="img_text/workflow_omaps.html">“图3-1 Map Tile Server的工作流程”的描述</a></div>
                  <!-- class="figure" -->
                  <p><a href="map-visualization-servers.html#GUID-7E88B130-FB2F-47D1-A8B2-909CFB1454AC__BABCGFGD">如图3-1</a>所示，当地图图块服务器收到对地图图块的请求时，它会在缓存存储系统中搜索图块。如果磁贴已缓存，则映射磁贴服务器将磁贴发送到客户端。如果未缓存切片，则地图切片服务器将提取切片，将其保存在缓存中，然后将其发送到客户端。
                  </p>
                  <p>您可以使用地图可视化工具管理工具来管理地图图块服务器。</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="map-visualization-servers.html#GUID-A151DBDD-2F04-4AFC-B658-E943C2E1CA1E">映射平铺服务器概念</a><br></li>
                     <li class="ulchildlink"><a href="map-visualization-servers.html#GUID-A144D404-681B-4BBE-A3FF-E9826A5DF605">映射平铺服务器配置</a><br></li>
                     <li class="ulchildlink"><a href="map-visualization-servers.html#GUID-A2E5CC6C-EC68-4C67-A1D1-09B8123BF3C3">映射缓存自动更新</a><br></li>
                     <li class="ulchildlink"><a href="map-visualization-servers.html#GUID-9576FC06-D773-4C47-8F5F-DF3AD4567206">用于地图图块的UTFGrid：包括关于要素的文本信息</a><br></li>
                     <li class="ulchildlink"><a href="map-visualization-servers.html#GUID-D58CA71F-B70B-4FFE-964A-CEE2859C7FC6">外部地图源适配器</a><br></li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="map-visualization-servers.html#GUID-0D2CF483-95C0-45D0-B4E8-5A4578741A63" title="地图可视化工具作为一组Java Enterprise Edition包，包含一组服务器以提供地图服务。">映射可视化服务器</a></p>
                     </div>
                  </div>
               </div>
               <a id="JIMPV9795"></a><div class="props_rev_3"><a id="GUID-A151DBDD-2F04-4AFC-B658-E943C2E1CA1E" name="GUID-A151DBDD-2F04-4AFC-B658-E943C2E1CA1E"></a><h4 id="JIMPV-GUID-A151DBDD-2F04-4AFC-B658-E943C2E1CA1E" class="sect4"><span class="enumeration_section">3.2.1</span>映射平铺服务器概念</h4>
                  <div>
                     <p>本节介绍了为有效使用Oracle Maps而需要了解的地图切片服务器概念。</p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="map-visualization-servers.html#GUID-B80231C4-6E0F-4CC4-9561-6CFEDCD93C68">地图平铺图层和地图平铺源</a><br></li>
                        <li class="ulchildlink"><a href="map-visualization-servers.html#GUID-F0DB152D-5F21-41E5-9D58-AAA71B82753B">地图图像瓷砖的存储</a><br></li>
                        <li class="ulchildlink"><a href="map-visualization-servers.html#GUID-BEC4AE53-AFCF-4872-8C7C-2F21F025ECB0">地图瓷砖坐标系</a><br></li>
                        <li class="ulchildlink"><a href="map-visualization-servers.html#GUID-9C11BC3A-B721-4B0A-B576-5773363196DC">平铺网格代码</a><br></li>
                        <li class="ulchildlink"><a href="map-visualization-servers.html#GUID-F0B40C14-40EC-4973-B68D-2EFD4C825E86">地图平铺请求</a><br></li>
                        <li class="ulchildlink"><a href="map-visualization-servers.html#GUID-F2CD1712-676D-4986-9233-4ACC7E3809B9">平铺规则</a><br></li>
                        <li class="ulchildlink"><a href="map-visualization-servers.html#GUID-1D0E8411-88A0-4874-8EAD-BD558E752F08">平铺背景颜色和超出界限颜色</a><br></li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="map-visualization-servers.html#GUID-7E88B130-FB2F-47D1-A8B2-909CFB1454AC" title="地图图块服务器是一种地图图像缓存引擎，用于获取，缓存和提供预生成的固定大小的地图图像图块。">映射平铺服务器</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="JIMPV9796"></a><div class="props_rev_3"><a id="GUID-B80231C4-6E0F-4CC4-9561-6CFEDCD93C68" name="GUID-B80231C4-6E0F-4CC4-9561-6CFEDCD93C68"></a><h5 id="JIMPV-GUID-B80231C4-6E0F-4CC4-9561-6CFEDCD93C68" class="sect5"><span class="enumeration_section">3.2.1.1</span>映射图块图层和地图图块源</h5>
                     <div>
                        <p>所有地图图块层都由地图图块服务器管理。<span class="bold">地图图块服务器</span>获取并存储属于地图图块图层的地图图像图块并将地图图像图块返回给客户端。地图图块服务器可以管理多个地图图块层。
                        </p>
                        <p>每个地图图块层可以具有多个预定义的缩放级别。为每个缩放级别分配一个范围从0到n-1的缩放级别编号，其中n是缩放级别的总数。缩放级别0是缩小最多的级别，缩放级别n-1是放大最多的级别。</p>
                        <p>在每个缩放级别上将地图均匀地划分为相同大小的小地图图像块。客户端通过缩放级别和平铺网格代码指定地图图块。</p>
                        <p>地图图块层可以来自两种不同类型的源：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>由地图可视化工具地图渲染引擎渲染的内部地图可视化工基础地图。地图可视化工具基本地图由一组预定义主题组成，必须在数据库视图USER_SDO_MAPS中预定义。</p>
                           </li>
                           <li>
                              <p>由外部Web地图服务提供商呈现的地图。外部Web地图服务提供程序是一种服务器，它根据Web上的客户端请求呈现和提供映射。如果您正确配置了可从外部地图服务提供程序获取地图的适配器，则地图图块服务器可以获取并缓存由外部地图服务提供程序生成的地图图块。（地图可视化工具实例以外的地图可视化工具实例也在其中运行地图图块服务器也被视为外部地图服务提供商。）</p>
                           </li>
                        </ul>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="map-visualization-servers.html#GUID-A151DBDD-2F04-4AFC-B658-E943C2E1CA1E">映射平铺服务器概念</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="JIMPV9797"></a><div class="props_rev_3"><a id="GUID-F0DB152D-5F21-41E5-9D58-AAA71B82753B" name="GUID-F0DB152D-5F21-41E5-9D58-AAA71B82753B"></a><h5 id="JIMPV-GUID-F0DB152D-5F21-41E5-9D58-AAA71B82753B" class="sect5"><span class="enumeration_section">3.2.1.2</span>地图图像的存储</h5>
                     <div>
                        <p>Oracle Maps有三个处理地图图像切片存储的选项：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="map-visualization-servers.html#GUID-A61122F9-FD15-4797-A48D-DB5B6D3946DC">使用本地文件系统存储切片</a> 。
                              </p>
                              <p>如果使用本地文件系统进行高速缓存，则可以自定义用于此存储的路径，作为地图切片服务器配置设置的一部分。</p>
                           </li>
                           <li>
                              <p><a href="map-visualization-servers.html#GUID-F9C62C09-CF22-40F0-B4D3-E9A5AC0FED32">将切片存储在数据库表中</a> 。
                              </p>
                              <p>如果使用数据库表进行高速缓存，则必须创建数据库表，并在USER_SDO_CACHED_MAPS视图中将切片层的TILES_TABLE列设置为该表。</p>
                           </li>
                           <li>
                              <p><a href="map-visualization-servers.html#GUID-A4B8E43B-A59B-4D77-89C7-91A29602DE46">直接流式传输瓷砖而不存储它们</a> 。
                              </p>
                              <p>如果您不想缓存任何图像切片，则必须在切片图层的定义中指明。</p>
                           </li>
                        </ul>
                     </div>
                     <div>
                        <ul class="ullinks">
                           <li class="ulchildlink"><a href="map-visualization-servers.html#GUID-A61122F9-FD15-4797-A48D-DB5B6D3946DC">使用本地文件系统存储切片</a><br></li>
                           <li class="ulchildlink"><a href="map-visualization-servers.html#GUID-F9C62C09-CF22-40F0-B4D3-E9A5AC0FED32">将切片存储在数据库表中</a><br></li>
                           <li class="ulchildlink"><a href="map-visualization-servers.html#GUID-A4B8E43B-A59B-4D77-89C7-91A29602DE46">直接流式传输瓷砖而不存储它们</a><br></li>
                        </ul>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="map-visualization-servers.html#GUID-A151DBDD-2F04-4AFC-B658-E943C2E1CA1E">映射平铺服务器概念</a></p>
                           </div>
                        </div>
                     </div>
                     <a id="JIMPV10069"></a><div class="props_rev_3"><a id="GUID-A61122F9-FD15-4797-A48D-DB5B6D3946DC" name="GUID-A61122F9-FD15-4797-A48D-DB5B6D3946DC"></a><h6 id="JIMPV-GUID-A61122F9-FD15-4797-A48D-DB5B6D3946DC" class="sect6"><span class="enumeration_section">3.2.1.2.1</span>使用本地文件系统存储切片</h6>
                        <div>
                           <p>在文件系统中，每个切片层都有自己的存储根目录，该目录由切片图层定义中的<code class="codeph">&lt;cache_storage&gt;</code>元素的<code class="codeph">root_path</code>属性指定。如果未指定该属性，则将<code class="codeph">mapViewerConfig.xml</code>文件<code class="codeph">&lt;tile_storage&gt;</code>元素中指定的默认存储位置用作根路径。例如，如果根路径定义为<code class="codeph">/scratch/tilecache/</code> ，并且名为MVDEMO的数据源具有名为DEMO_MAP且具有19个缩放级别的切片层，则在实例化服务器之后创建文件夹<code class="codeph">/scratch/tilecache/MVDEMO.DEMO_MAP</code> ，它包含19个子文件夹（ <code class="codeph">/0</code> ， <code class="codeph">/1</code> ，...， <code class="codeph">/18</code> ），每个子文件夹用于存储缩放级别的图像切片。
                           </p>
                           <p>在每个缩放级别下，有两个选项可用于组织地图切片的子文件夹。一个是默认选项，它使用网格代码树结构;另一个称为xyz存储方案，使用tile的行和列值作为子文件夹和tile名称来存储地图图块。两个存储选项都从每个缩放级别的图块网格代码值开始（有关图块网格代码的详细信息，请参阅<a href="map-visualization-servers.html#GUID-9C11BC3A-B721-4B0A-B576-5773363196DC">平铺</a>网格代码）。缩放级别中的每个图块可以使用其网格代码值对（ <code class="codeph">mx, my</code> ）来表示，其中<code class="codeph">mx</code>和<code class="codeph">my</code>分别是水平和垂直方向上的整数值。左下角的图块的值为（0,0）。还可以使用其tile行和tile列值对（ <code class="codeph">tile_column, tile_row</code> ）来定位tile。左上角的图块的值为（0,0）。
                           </p>
                        </div>
                        <div>
                           <div class="familylinks">
                              <div class="parentlink">
                                 <p><strong>父主题：</strong> <a href="map-visualization-servers.html#GUID-F0DB152D-5F21-41E5-9D58-AAA71B82753B">地图图像平铺的存储</a></p>
                              </div>
                           </div>
                        </div>
                        
                     </div><a id="JIMPV10070"></a><div class="props_rev_3"><a id="GUID-F9C62C09-CF22-40F0-B4D3-E9A5AC0FED32" name="GUID-F9C62C09-CF22-40F0-B4D3-E9A5AC0FED32"></a><h6 id="JIMPV-GUID-F9C62C09-CF22-40F0-B4D3-E9A5AC0FED32" class="sect6"><span class="enumeration_section">3.2.1.2.2</span>将切片存储在数据库表中</h6>
                        <div>
                           <p>图像切片可以存储在数据库表中，如下所示。</p>
                           <ol>
                              <li>
                                 <p>创建一个用于存储图像切片的表。例如：</p><pre class="oac_no_warn" dir="ltr">CREATE TABLE tile_dbt（tile_layer varchar2（64），zoom_level number，x number，y number，modified TIMESTAMP，data BLOB）;承诺;</pre></li>
                              <li>
                                 <p>更新切片图层的USER_SDO_CACHED_MAPS视图中的TILES_TABLE列。例如，如果您有一个切片图层DEMP_MAP，并且您希望使用在步骤1中创建的表来存储其地图切片，则更新切片图层的TILES_TABLE列，如下所示：</p><pre class="oac_no_warn" dir="ltr">UPDATE user_sdo_cached_maps SET tiles_table ='tiles_dbt'WHERE name ='DEMP_MAP';</pre></li>
                              <li>
                                 <p>重新启动地图可视化服务器以使更改生效。</p>
                              </li>
                           </ol>
                           <p>使用此示例，用于图块层DEMP_MAP的地图图像图块将存储在数据库表TILE_DBT中。</p>
                        </div>
                        <div>
                           <div class="familylinks">
                              <div class="parentlink">
                                 <p><strong>父主题：</strong> <a href="map-visualization-servers.html#GUID-F0DB152D-5F21-41E5-9D58-AAA71B82753B">地图图像平铺的存储</a></p>
                              </div>
                           </div>
                        </div>
                        
                     </div><a id="JIMPV10072"></a><a id="JIMPV10071"></a><div class="props_rev_3"><a id="GUID-A4B8E43B-A59B-4D77-89C7-91A29602DE46" name="GUID-A4B8E43B-A59B-4D77-89C7-91A29602DE46"></a><h6 id="JIMPV-GUID-A4B8E43B-A59B-4D77-89C7-91A29602DE46" class="sect6"><span class="enumeration_section">3.2.1.2.3</span>直接流式传输瓷砖而不存储它们</h6>
                        <div>
                           <p>如果磁贴内容可能会不断变化（例如实时云覆盖卫星图像映射），或者如果您不想存储图像磁贴，则可以直接流式传输磁贴而不存储它们。</p>
                           <p>要选择此选项，请在切片图层定义中的<code class="codeph">&lt;map_tile_layer&gt;</code>元素中将<code class="codeph">persistent_tiles</code>属性设置为<code class="codeph">false</code> 。（ <code class="codeph">persistent_tiles</code>属性的默认值为<code class="codeph">true</code> 。）。<a href="map-visualization-servers.html#GUID-A4B8E43B-A59B-4D77-89C7-91A29602DE46__BACGIBEF">示例3-1</a>插入名为DEMO_MAP的切片图层，并将<code class="codeph">persistent_tiles</code>属性设置为<code class="codeph">false</code>以便不会为此切片图层缓存地图图像切片。
                           </p>
                           <div class="example" id="GUID-A4B8E43B-A59B-4D77-89C7-91A29602DE46__BACGIBEF">
                              <p class="titleinexample">例3-1流媒体瓷砖没有存储它们</p><pre class="oac_no_warn" dir="ltr">INSERT INTO user_sdo_cached_maps值（'DEMO_MAP'，'不缓存图像切片的示例切片图层'，''，'YES'，'YES'，'&lt;map_tile_layer name =“DEMO_MAP_TREEMESH”image_format =“PNG”http_header_expires =“168.0 “concurrent_fetching_threads =”3“ <span class="bold">persistent_tiles =”false“</span> &gt; &lt;internal_map_source data_source =”mvdemo“base_map =”DEMO_MAP“bgcolor =”#dddddd“out_of_bounds_color =”＃eeddff“/&gt; &lt;tile_storage root_path =”/ temp“short_path =”false “/&gt; &lt;coordinate_system srid =”8307“minX =” -  180.0“maxX =”180.0“minY =” -  90.0“maxY =”90.0“/&gt; &lt;tile_image width =”256“height =”256“/&gt; &lt;tile_dpi value =“90.7142857”/&gt; &lt;tile_meters_per_unit value =“111319.49079327358”/&gt; &lt;zoom_levels levels =“19”min_scale =“2132.729583849784”max_scale =“559082264.0287178”/&gt; &lt;/ map_tile_layer&gt;'，'DEMO_MAP'，''）;承诺;</pre></div>
                           <!-- class="example" -->
                        </div>
                        <div>
                           <div class="familylinks">
                              <div class="parentlink">
                                 <p><strong>父主题：</strong> <a href="map-visualization-servers.html#GUID-F0DB152D-5F21-41E5-9D58-AAA71B82753B">地图图像平铺的存储</a></p>
                              </div>
                           </div>
                        </div>
                        
                     </div>
                  </div><a id="JIMPV9799"></a><a id="JIMPV9798"></a><div class="props_rev_3"><a id="GUID-BEC4AE53-AFCF-4872-8C7C-2F21F025ECB0" name="GUID-BEC4AE53-AFCF-4872-8C7C-2F21F025ECB0"></a><h5 id="JIMPV-GUID-BEC4AE53-AFCF-4872-8C7C-2F21F025ECB0" class="sect5"><span class="enumeration_section">3.2.1.3</span>地图瓷砖的坐标系</h5>
                     <div>
                        <p>地图图像由地图图块服务器缓存和管理为小型相同尺寸的矩形图像图块。目前，我们支持在任何二维笛卡尔坐标系上进行平铺。当一个大地坐标系被映射为一个笛卡尔坐标系时，也可以支持该大地坐标系，其中经度和纬度被简单地视为两个垂直轴， <a href="map-visualization-servers.html#GUID-BEC4AE53-AFCF-4872-8C7C-2F21F025ECB0__BABJJCDG">如图3-2</a>所示。
                        </p>
                        <div class="figure" id="GUID-BEC4AE53-AFCF-4872-8C7C-2F21F025ECB0__BABJJCDG">
                           <p class="titleinfigure">图3-2使用经度/纬度坐标系统进行平铺</p><img src="img/coord_sys_omaps.gif" alt="下面是图3-2的描述" title="下面是图3-2的描述" longdesc="img_text/coord_sys_omaps.html"><br><a href="img_text/coord_sys_omaps.html">“图3-2使用经度/纬度坐标系统平铺”的描述</a></div>
                        <!-- class="figure" -->
                        <p>在每个缩放级别上，通过沿着两个维度（X和Y，在<a href="map-visualization-servers.html#GUID-BEC4AE53-AFCF-4872-8C7C-2F21F025ECB0__BABJJCDG">图3-2中</a>表示纬度和经度）等分整个地图坐标系来创建地图图块。地图图块服务器需要地图坐标系的此维信息才能创建地图图像图块，因此您必须在地图图块图层配置设置中包含此信息。
                        </p>
                        <p>整个地图坐标系可以用矩形表示，其边界由（Xmin，Ymin）和（Xmax，Ymax）指定，其中Xmin是坐标系中允许的最小X值，Ymin是允许的最小Y值，Xmax是允许的最大X值，Ymax是允许的最大Y值。在<a href="map-visualization-servers.html#GUID-BEC4AE53-AFCF-4872-8C7C-2F21F025ECB0__BABJJCDG">图3-2中</a> ，Xmin是-180，Ymin是-90，Xmax是180，Ymax是90。
                        </p>
                        <p>您还必须指定坐标系的空间参考ID（SRID），以使地图图块服务器能够计算地图比例。</p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="map-visualization-servers.html#GUID-A151DBDD-2F04-4AFC-B658-E943C2E1CA1E">映射平铺服务器概念</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="JIMPV9801"></a><a id="JIMPV9800"></a><div class="props_rev_3"><a id="GUID-9C11BC3A-B721-4B0A-B576-5773363196DC" name="GUID-9C11BC3A-B721-4B0A-B576-5773363196DC"></a><h5 id="JIMPV-GUID-9C11BC3A-B721-4B0A-B576-5773363196DC" class="sect5"><span class="enumeration_section">3.2.1.4</span>平铺网格码</h5>
                     <div>
                        <p>每个地图图块由网格代码指定，网格代码定义为一对整数（Mx，My），其中Mx指定图块的X维度索引，而My指定图块的Y维度索引。如果图块是从Xmin开始的X维上的第<span class="italic">i</span>个图块，则Mx应该是i-1。如果拼贴是从Ymin开始的Y维上的第<span class="italic">j</span>个拼贴，那么我应该是j-1。<a href="map-visualization-servers.html#GUID-9C11BC3A-B721-4B0A-B576-5773363196DC__BABEHBJJ">图3-3</a>显示了地图上图块的网格代码。
                        </p>
                        <div class="figure" id="GUID-9C11BC3A-B721-4B0A-B576-5773363196DC__BABEHBJJ">
                           <p class="titleinfigure">图3-3平铺网格代码</p><img src="img/mesh_codes.gif" alt="下面是图3-3的描述" title="下面是图3-3的描述" longdesc="img_text/mesh_codes.html"><br><a href="img_text/mesh_codes.html">“图3-3平铺网格代码”的说明</a></div>
                        <!-- class="figure" -->
                        <p>JavaScript地图客户端自动计算在Web浏览器中显示地图所需的图块，并将带有网格代码的请求发送到服务器。网格代码对应用程序是透明的，应用程序开发人员不需要直接处理网格代码。</p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="map-visualization-servers.html#GUID-A151DBDD-2F04-4AFC-B658-E943C2E1CA1E">映射平铺服务器概念</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="JIMPV10123"></a><div class="props_rev_3"><a id="GUID-F0B40C14-40EC-4973-B68D-2EFD4C825E86" name="GUID-F0B40C14-40EC-4973-B68D-2EFD4C825E86"></a><h5 id="JIMPV-GUID-F0B40C14-40EC-4973-B68D-2EFD4C825E86" class="sect5"><span class="enumeration_section">3.2.1.5</span>映射平铺请求</h5>
                     <div>
                        <p>地图图块服务器处理地图图块请求。地图图块请求可以是键/值对格式或REST格式：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>以键/值对格式映射切片请求</p>
                              <p>例如，如果数据源DS_NAME具有切片图层TL_NAME，那么要从缩放级别2和网格代码（3.2）获取PNG格式的地图图块图像，该网址可以格式化为：</p><pre class="oac_no_warn" dir="ltr">HTTP：//本地主机：8080 /的MapViewer / mcserver请求= gettile＆格式= PNG＆缩放级别= 2＆mapcache = DS_NAME.TL_NAME＆MX = 3＆我= 2</pre></li>
                           <li>
                              <p>以REST格式映射切片请求</p>
                              <p>REST格式的请求的一般格式是：</p><pre class="oac_no_warn" dir="ltr">HTTP：//本地主机：8080 /的MapViewer / mcserver / DS_NAME / TL_NAME / {变焦} / {行} / {列} .PNG</pre><p>例如，要发送前面的键/值对示例中显示的相同的地图图块请求，但是采用REST格式，URL可以是：</p><pre class="oac_no_warn" dir="ltr">HTTP：//本地主机：8080 /的MapViewer / mcserver / DS_NAME / TL_NAME / 2/1 / 3.png</pre></li>
                        </ul>
                        <p>键/值对格式的网格代码具有左下角的原点，但REST格式请求切片的行和列，因此原点位于左上角。由于这两种格式的起源不同，因此<code class="codeph">my</code>值与<code class="codeph">row</code>值不同，但<code class="codeph">mx</code>值与<code class="codeph">column</code>值相同。
                        </p>
                        <p>通常，地图图块请求被封装在地图可视化工具JavaScript API库中，因此API处理地图图块请求。但是，如果您使用第三方的JavaScript API与地图可视化服务器进行通信，则可能需要在应用程序中指定地图图块请求格式。例如，如果您使用Leaflet JavaScript API从地图可视化服务器获取地图图块，则可能需要将其<code class="codeph">L.tileLayer</code>的URL模板设置为：</p><pre class="oac_no_warn" dir="ltr">HTTP：//本地主机：8080 /的MapViewer / mcserver / DS_NAME / TL_NAME / {Z} / {Y} / {X} .PNG。</pre></div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="map-visualization-servers.html#GUID-A151DBDD-2F04-4AFC-B658-E943C2E1CA1E">映射平铺服务器概念</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="JIMPV9802"></a><div class="props_rev_3"><a id="GUID-F2CD1712-676D-4986-9233-4ACC7E3809B9" name="GUID-F2CD1712-676D-4986-9233-4ACC7E3809B9"></a><h5 id="JIMPV-GUID-F2CD1712-676D-4986-9233-4ACC7E3809B9" class="sect5"><span class="enumeration_section">3.2.1.6</span>平铺规则</h5>
                     <div>
                        <p>您必须创建切片规则，以确定如何划分地图以及如何创建切片。地图图块服务器使用这些切片规则将地图划分为存储在图块存储系统中的小地图图像图块。JavaScript地图客户端也使用这些规则。</p>
                        <p>由于给定缩放级别上的所有切片都具有相同的大小，因此地图切片服务器需要知道以下信息才能执行切片分区：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>地图图块图像大小（宽度和高度），以屏幕像素指定。这是平铺图像的物理尺寸。</p>
                           </li>
                           <li>
                              <p>根据地图坐标系指定的图块大小。例如，如果地图使用大地坐标系，则应以度为单位定义切片宽度和高度。可以通过切片宽度和高度明确指定大小，也可以通过地图比例隐式指定大小。（地图比例，与图块图像大小相结合，可用于根据地图坐标系统导出图块宽度和高度。）</p>
                           </li>
                        </ul>
                        <p>前面的信息构成给定缩放级别的平铺规则。每个缩放级别必须具有自己的平铺规则。如<a href="map-visualization-servers.html#GUID-A144D404-681B-4BBE-A3FF-E9826A5DF605">地图平铺服务器配置中</a>所述，您必须在指定地图平铺服务器的配置设置时定义平铺规则。
                        </p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="map-visualization-servers.html#GUID-A151DBDD-2F04-4AFC-B658-E943C2E1CA1E">映射平铺服务器概念</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="JIMPV9994"></a><div class="props_rev_3"><a id="GUID-1D0E8411-88A0-4874-8EAD-BD558E752F08" name="GUID-1D0E8411-88A0-4874-8EAD-BD558E752F08"></a><h5 id="JIMPV-GUID-1D0E8411-88A0-4874-8EAD-BD558E752F08" class="sect5"><span class="enumeration_section">3.2.1.7</span>平铺背景颜色和超出界限颜色</h5>
                     <div>
                        <p>切片图层元数据定义中的两个属性会影响切片的颜色： <code class="codeph">bgcolor</code> （背景颜色）和<code class="codeph">out_of_bounds_color</code> （越界颜色）。<code class="codeph">bgcolor</code>属性值用于填充图块层的有效数据区域内的区域（有效数据区域由<code class="codeph">minX, minY, maxY, maxY</code> ），而<code class="codeph">out_of_bounds_color</code>属性值用于填充有效区域外的区域数据区。两个属性都具有相同的默认值（ <code class="codeph">Color(192, 192, 192)</code> ）。
                        </p>
                        <p>如果由于尝试生成图块的异常而导致图块获取过程失败，则使用填充了越界颜色的图块作为其替代，而不管它是否在有效数据区域内。但是，由于拼贴异常而导致的这种替代拼贴不会永久存储在磁盘上;相反，它是临时流向客户端的。如果客户端浏览器缓存中的临时磁贴数据被清除或者其他客户端发起请求，则映射可视化工具将在后续请求中重试磁贴生成。</p>
                        <p>如果<code class="codeph">bgcolor</code>设置为<code class="codeph">none</code> ，则图块变为透明;也就是说，HTML页面的背景颜色替换了<code class="codeph">bgcolor</code>和<code class="codeph">out_of_bounds_color</code>的属性值。
                        </p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="map-visualization-servers.html#GUID-A151DBDD-2F04-4AFC-B658-E943C2E1CA1E">映射平铺服务器概念</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div><a id="JIMPV9803"></a><div class="props_rev_3"><a id="GUID-A144D404-681B-4BBE-A3FF-E9826A5DF605" name="GUID-A144D404-681B-4BBE-A3FF-E9826A5DF605"></a><h4 id="JIMPV-GUID-A144D404-681B-4BBE-A3FF-E9826A5DF605" class="sect4"><span class="enumeration_section">3.2.2</span>映射平铺服务器配置</h4>
                  <div>
                     <p>映射磁贴服务器配置设置存储在本地配置文件和数据库视图中。您可以自定义这些设置。</p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="map-visualization-servers.html#GUID-247681EA-BA75-488E-9CAE-C2139AA37E40">全局地图平铺服务器配置</a><br></li>
                        <li class="ulchildlink"><a href="map-visualization-servers.html#GUID-5CF7DC08-0B32-4C72-B9D0-F3762A7E6171">映射磁贴层配置</a><br></li>
                        <li class="ulchildlink"><a href="map-visualization-servers.html#GUID-9956C928-09A1-43E8-AB72-410F9A9B94EB">映射平铺存储方案：内部网格代码或XYZ</a><br></li>
                        <li class="ulchildlink"><a href="map-visualization-servers.html#GUID-25DD5A19-EC7F-4BB7-B1BA-E1CC2651EC04">使用外部Web地图源创建地图图块层</a><br></li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="map-visualization-servers.html#GUID-7E88B130-FB2F-47D1-A8B2-909CFB1454AC" title="地图图块服务器是一种地图图像缓存引擎，用于获取，缓存和提供预生成的固定大小的地图图像图块。">映射平铺服务器</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="JIMPV9804"></a><div class="props_rev_3"><a id="GUID-247681EA-BA75-488E-9CAE-C2139AA37E40" name="GUID-247681EA-BA75-488E-9CAE-C2139AA37E40"></a><h5 id="JIMPV-GUID-247681EA-BA75-488E-9CAE-C2139AA37E40" class="sect5"><span class="enumeration_section">3.2.2.1</span>全局地图平铺服务器配置</h5>
                     <div>
                        <p>全局地图图块服务器设置（例如日志记录选项和默认缓存存储目录）存储在地图可视化工具配置文件<code class="codeph">mapViewerConfig.xml</code> ，该文件位于<span class="italic"><code class="codeph">$MAPVIEWER_HOME</code></span> <code class="codeph">/web/WEB-INF/conf</code> 。
                        </p>
                        <p>地图图块服务器配置设置在顶级<code class="codeph">&lt;mapperConfig&gt;</code>元素内的元素<code class="codeph">&lt;map_tile_server&gt;</code>中定义，如以下示例所示：</p><pre class="oac_no_warn" dir="ltr">&lt;map_tile_server&gt; &lt;tile_storage default_root_path =“/ scratch / tilecache /”/&gt; &lt;/ map_tile_server&gt;</pre><p><code class="codeph">&lt;</code> <code class="codeph">tile_storage&gt;</code>元素指定地图图块存储设置。<code class="codeph">default_root_path</code>属性指定要在其下存储缓存的图块图像的默认文件系统目录。如果默认根目录未设置或无效，则默认根目录为<span class="italic"><code class="codeph">$MAPVIEWER_HOME</code></span> <code class="codeph">/web/tilecache</code> 。如果地图图块层配置未指定自身的地图图块存储目录，则将创建此目录下的子目录并将其用于地图图块图层。子目录的名称将与地图图块层的名称相同。
                        </p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="map-visualization-servers.html#GUID-A144D404-681B-4BBE-A3FF-E9826A5DF605">映射平铺服务器配置</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="JIMPV9807"></a><a id="JIMPV10124"></a><a id="JIMPV9808"></a><a id="JIMPV9805"></a><div class="props_rev_3"><a id="GUID-5CF7DC08-0B32-4C72-B9D0-F3762A7E6171" name="GUID-5CF7DC08-0B32-4C72-B9D0-F3762A7E6171"></a><h5 id="JIMPV-GUID-5CF7DC08-0B32-4C72-B9D0-F3762A7E6171" class="sect5"><span class="enumeration_section">3.2.2.2</span>地图图块层配置</h5>
                     <div>
                        <p>地图图块层的配置设置存储在USER_SDO_CACHED_MAPS元数据视图中，该视图在<a href="map-visualization-concepts.html#GUID-820FD52E-E02D-4371-B85B-88B76FAC50FF">xxx_SDO_CACHED_MAPS视图中</a>描述。您通常不应直接操作此视图，而应使用地图可视化工具管理工具，该工具使用此视图配置地图图块图层。
                        </p>
                        <p>每个数据库用户（模式）都有自己的USER_SDO_CACHED_MAPS视图。此视图中的每个条目都存储一个地图图块层的配置设置。如果地图图块层基于内部地图可视化器基本地图或主题，则必须在存储地图图块图层配置设置的同一数据库模式中定义与地图图块图层关联的基本地图或主题。</p>
                        <p>地图图块服务器通过使用地图可视化工具数据源指定的数据库连接查询USER_SDO_CACHED_MAPS视图来获取地图源配置。当地图图块服务器启动或者新的数据源作为地图可视化工具管理请求的结果添加到地图可视化工具时，会发生这种情况。</p>
                        <p>对于USER_SDO_CACHED_MAPS视图中的DEFINITION列，地图源定义具有以下通用格式：</p><pre class="oac_no_warn" dir="ltr">&lt;map_tile_layer name =“map tile layer name”image_format =“tile-image-format”&gt; &lt;internal_map_source data_source =“name-of-data-source”base_map =“name-of-MapViewer-base-map”bgcolor =“base -map-background-color“antialias =”是否打开抗锯齿“/&gt; &lt;/ internal_map_source&gt; &lt;external_map_source url =”external-map-service-url“adapter_class =”name-of-adapter-class“ proxy_host =“proxy-server-host”proxy_port =“proxy-server-port”timeout =“request-timeout”request_method =“http-request-method：'GET'|'POST'”&gt; &lt;properties&gt; &lt;property name = “property-name”value =“property-value”/&gt; ... &lt;/ properties&gt; &lt;/ external_map_source&gt; &lt;tile_storage root_path =“disk-path-of-cache-root-directory”&lt;/ tile_storage&gt; &lt;coordinate_system srid =“coordinate -system-srid“minX =”minimum-allowed-X-value“maxX =”maximum-allowed-X-value“minY =”minimum-allowed-Y-value“maxY =”maximum-allowed-Y-value“&gt; &lt;/ coordinate_system&gt; &lt;tile_image width =“tile-image-width-in-screen-pixels”height =“tile-image-height-in-screen-pixels”&gt; &lt;/ tile_i mage&gt; &lt;tile_bound&gt; &lt;coordinates&gt; ... &lt;/ coordinates&gt; &lt;/ tile_bound&gt; &lt;zoom_levels levels =“缩放级别数”min_scale =“map-scale-at-highest-zoom-level”max_scale =“map-缩放比例缩放级别“min_tile_width =”tile-width-specified-in-map-data-units-at-highest-zoom-level“max_tile_width =”tile-width-specified-in-map-data-单位为最低缩放级别“&gt; &lt;zoom_level description =”zoom-level-description“level_name =”zoom-level-name“scale =”map-scale-of-zoom-level“tile_width =”tile-width -specified-in-map-data-units“tile_height =”tile-height-specified-in-map-data-units“&gt; &lt;tile_bound&gt; &lt;coordinates&gt; ... &lt;/ coordinates&gt; &lt;/ tile_bound&gt; &lt;/ zoom_level&gt; ... &lt; / zoom_levels&gt; &lt;/ map_tile_layer&gt;</pre><p>地图图块层定义XML的DTD列在<a href="xml-formats-map-visualizer.html#GUID-8B972AAC-B614-459B-91E2-18ADA5EF234F" title="Oracle Maps地图图块层，用于从地图图块服务器组装并显示预生成的地图图像图块，">地图图块层中</a> 。
                        </p>
                        <p><a href="map-visualization-servers.html#GUID-5CF7DC08-0B32-4C72-B9D0-F3762A7E6171__BABEHBBH">例3-2</a>显示了基于基本映射的内部地图图块层的XML定义; <a href="map-visualization-servers.html#GUID-5CF7DC08-0B32-4C72-B9D0-F3762A7E6171__BACBHEBD">示例3-3</a>显示了基于主题（不在基本地图上）的内部地图图块层的XML定义; <a href="map-visualization-servers.html#GUID-5CF7DC08-0B32-4C72-B9D0-F3762A7E6171__BABGDIBD">示例3-4</a>显示了外部地图图块层的XML定义。<code class="codeph">&lt;map_tile_layer&gt;</code>元素及其子元素的说明遵循这些示例。
                        </p>
                        <div class="example" id="GUID-5CF7DC08-0B32-4C72-B9D0-F3762A7E6171__BABEHBBH">
                           <p class="titleinexample">示例3-2基于基本映射的内部地图图块层的XML定义</p><pre class="oac_no_warn" dir="ltr">&lt;？xml版本='1.0'？&gt; &lt;！ - 内部地图图块层的XML定义。- &gt; &lt;map_tile_layer image_format =“PNG”&gt; &lt;internal_map_source base_map =“demo_map”/&gt; &lt;tile_storage root_path =“/ scratch / mapcache /”/&gt; &lt;coordinate_system srid =“8307”minX =“ -  180”maxX =“180 “minY =” -  90“maxY =”90“/&gt; &lt;tile_image width =”250“height =”250“/&gt; &lt;zoom_levels&gt; &lt;zoom_level description =”continent level“scale =”10000000“/&gt; &lt;zoom_level description = “country level”scale =“3000000”/&gt; &lt;zoom_level description =“state level”scale =“1000000”/&gt; &lt;zoom_level description =“county level”scale =“300000”/&gt; &lt;zoom_level description =“city level”scale =“100000”/&gt; &lt;zoom_level description =“street level”scale =“30000”/&gt; &lt;zoom_level description =“local street level”scale =“10000”/&gt; &lt;/ zoom_levels&gt; &lt;/ map_tile_layer&gt;</pre></div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-5CF7DC08-0B32-4C72-B9D0-F3762A7E6171__BACBHEBD">
                           <p class="titleinexample">示例3-3基于主题的内部地图图块层的XML定义</p><pre class="oac_no_warn" dir="ltr">&lt;？xml version ='1.0'coding ='UTF-8'？&gt; &lt;map_tile_layer name =“TL1”image_format =“PNG”http_header_expires =“168.0”utfgrid =“true”utfgrid_resolution =“4”concurrent_fetching_threads =“3”&gt; &lt;internal_map_source data_source =“MVDEMO”bgcolor =“none”out_of_bounds_color =“＃ ffffff“base_map =”“db_tile_table =”“/&gt; &lt;tile_storage root_path =”/ temp“xyz_storage_scheme =”true“/&gt; &lt;coordinate_system srid =”3857“minX =” -  2.0037508E7“minY =” -  2.0037508E7“maxX = “2.0037508E7”maxY =“2.0037508E7”/&gt; &lt;tile_image width =“256”height =“256”/&gt; &lt;tile_dpi value =“90.714”/&gt; &lt;tile_meters_per_unit value =“1.0”/&gt; &lt;zoom_levels levels =“19 “min_scale =”2132.72958384“max_scale =”5.59082264028E8“min_tile_width =”152.874538064“max_tile_width =”4.00751429065E7“&gt; &lt;zoom_level level =”0“name =”level0“tile_width =”4.00751429065E7“tile_height =”4.00751429065E7“/&gt; &lt;zoom_level level =“1”name =“level1”tile_width =“2.003757145325E7”tile_height =“2.003757145325E7”/&gt; &lt;zoom_level level =“2”name =“level2”tile_width =“1.0018785726625258E7”tile_height =“1.001878572662E7” /&gt; &lt;zoom_level level =“ 3“name =”level3“tile_width =”5009392.86331“tile_height =”5009392.86331“/&gt; &lt;zoom_level level =”4“name =”level4“tile_width =”2504696.431656“tile_height =”2504696.431656“/&gt; &lt;zoom_level level =”5“ name =“level5”tile_width =“1252348.215828”tile_height =“1252348.215828”/&gt; &lt;zoom_level level =“6”name =“level6”tile_width =“626174.1079140786”tile_height =“626174.107914”/&gt; &lt;zoom_level level =“7”name = “level7”tile_width =“313087.0539570393”tile_height =“313087.053957”/&gt; &lt;zoom_level level =“8”name =“level8”tile_width =“156543.5269785”tile_height =“156543.5269785”/&gt; &lt;zoom_level level =“9”name =“level9 “tile_width =”78271.763489“tile_height =”78271.763489“/&gt; &lt;zoom_level level =”10“name =”level10“tile_width =”39135.8817446“tile_height =”39135.8817446“/&gt; &lt;zoom_level level =”11“name =”level11“tile_width =“19567.9408723”tile_height =“19567.9408723”/&gt; &lt;zoom_level level =“12”name =“level12”tile_width =“9783.9704361”tile_height =“9783.9704361”/&gt; &lt;zoom_level level =“13”name =“level13”tile_width =“ 4891.9852180“tile_heig ht =“4891.9852180”/&gt; &lt;zoom_level level =“14”name =“level14”tile_width =“2445.9926090”tile_height =“2445.99260903”/&gt; &lt;zoom_level level =“15”name =“level15”tile_width =“1222.99630451”tile_height = “1222.99630451”/&gt; &lt;zoom_level level =“16”name =“level16”tile_width =“611.49815225”tile_height =“611.49815225”/&gt; &lt;zoom_level level =“17”name =“level17”tile_width =“305.74907612”tile_height =“305.74907612 “/&gt; &lt;zoom_level level =”18“name =”level18“tile_width =”152.87453806“tile_height =”152.87453806“/&gt; &lt;/ zoom_levels&gt; &lt;auto_update finest_level_to_refresh =”13“dirty_mbr_batch =”100“dirty_mbr_cap =”1000“&gt; &lt; dirty_mbr_table name =“TL1MBR”/&gt; &lt;logtable name =“TL1LOG”/&gt; &lt;/ auto_update&gt; &lt;themes&gt; &lt;theme name =“UTFGRID_THEME_DEMO_STATES”from_level =“0”to_level =“18”/&gt; &lt;theme name =“UTFGRID_THEME_DEMO_COUNTIES” from_level =“0”to_level =“18”/&gt; &lt;theme name =“UTFGRID_THEME_DEMO_HIGHWAYS”from_level =“0”to_level =“18”/&gt; &lt;theme name =“UTFGRID_THEME_DEMO_CITIES”from_level =“0”to_level =“18”/&gt; &lt;/ themes&gt; &lt;/ map_tile_layer&gt;</pre></div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-5CF7DC08-0B32-4C72-B9D0-F3762A7E6171__BABGDIBD">
                           <p class="titleinexample">示例3-4外部地图图块层的XML定义</p><pre class="oac_no_warn" dir="ltr">&lt;？xml版本='1.0'？&gt; &lt;！ - 外部地图图块层的XML定义.--&gt; &lt;map_tile_layer name =“TILELAYER1”image_format =“PNG”&gt; &lt;external_map_source url =“http://mycorp.com:7001/mapviewer/wms/” request_method =“GET”adapter_class =“oracle.lbs.mapcache.adapter。WMSAdapter“adapter_class_path =”“&gt; &lt;properties&gt; &lt;property name =”datasource“value =”mvdemo“/&gt; &lt;property name =”version“value =”1.1.1“/&gt; &lt;property name =”srs“value =” EPSG：4326“/&gt; &lt;property name =”layers“value =”THEME_DEMO_COUNTIES，THEME_DEMO_HIGHWAYS“/&gt; &lt;property name =”format“value =”image / png“/&gt; &lt;property name =”transparent“value =”true“ /&gt; &lt;/ properties&gt; &lt;/ external_map_source&gt; &lt;tile_storage root_path =“/ scratch / tmp /”/&gt; &lt;coordinate_system srid =“8307”minX =“ -  180.0”minY =“ -  90.0”maxX =“180.0”maxY =“ 90.0“/&gt; &lt;tile_image width =”256“height =”256“/&gt; &lt;！ - 以下&lt;zoom_levels&gt;元素中没有任何&lt;zoom_level&gt;元素。但由于它具有其级别，min_scale和max_scale属性设置，因此地图切片服务器将自动生成10个缩放级别的&lt;zoom_level&gt;元素。- &gt; &lt;zoom_levels levels =“10”min_scale =“1000.0”max_scale =“2.5E8”&gt; &lt;/ zoom_levels&gt; &lt;/ map_tile_layer&gt;</pre><p>顶级元素是<code class="codeph">&lt;map_tile_layer&gt;</code> 。<code class="codeph">image_format</code>属性指定图块图像格式;此属性当前支持的值为<code class="codeph">PNG</code> ， <code class="codeph">GIF</code>和<code class="codeph">JPG</code> 。 PNG和GIF图像通常更适用于矢量基础地图，而JPG图像通常更适用于栅格地图，例如卫星图像，因为压缩比更好。目前，只有PNG格式的平铺图像才能具有透明背景。
                           </p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><code class="codeph">http_header_expires</code>属性指定可以将缓存的图块层视为过时的小时数。
                                 </p>
                              </li>
                              <li>
                                 <p><code class="codeph">utfgrid</code>属性设置为<code class="codeph">true</code> ，表示将生成图像文件的伴随UTFGrid数据集。（默认值为<code class="codeph">false</code> 。）
                                 </p>
                              </li>
                              <li>
                                 <p><code class="codeph">utfgrid_resolution</code>属性指定将网格数据与图像切片进行比较的精细程度。例如，值4（默认值）表示一个网格单元在其伴随图像块中表示4乘4像素。
                                 </p>
                              </li>
                              <li>
                                 <p><code class="codeph">concurrent_fetching_threads</code>属性定义可以为此图块层获取图像图块而创建的并发图块提取线程的最大数量。（默认值为3.）
                                 </p>
                              </li>
                              <li>
                                 <p><code class="codeph">fetch_larger_tile</code>属性，当为<code class="codeph">true</code> （默认值）时，告诉<code class="codeph">fetch_larger_tile</code>贴服务器，如果<code class="codeph">fetch_larger_tile</code>贴在缓存中不可用，则还将生成<code class="codeph">fetch_larger_tile</code>贴的相邻磁贴。当请求的<code class="codeph">getTile</code>贴已在缓存中可用时，此参数会影响<code class="codeph">getTile</code>性能。默认设置（ <code class="codeph">true</code> ）旨在改善服务器响应时间。
                                 </p>
                              </li>
                              <li>
                                 <p><code class="codeph">persistent_tiles</code>属性，当为<code class="codeph">true</code> （默认值）时，指定将保存图像切片是服务器的磁盘高速缓存。如果此属性设置为false，则每个getTile请求将在地图可视化工具服务器中调用图像切片渲染过程，并且不会缓存新获取的图像切片以供将来使用。您可能想要指定<code class="codeph">false</code>包括（A）GeoRaster主题由图块层使用，您不希望在地图可视化工具的磁盘缓存中有重复的光栅图像，或者（B）您希望图块服务器始终提供 -迄今为止的图像拼贴。
                                 </p>
                              </li>
                           </ul>
                           <p>仅当地图图块由本地地图可视化工具实例呈现时，才需要<code class="codeph">&lt;internal_map_source&gt;</code>元素。
                           </p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><code class="codeph">base_map</code>属性是必需的，并指定由地图图块服务器缓存的预定义地图可视化器基本地图;其值应与USER_SDO_CACHED_MAPS视图中BASE_MAP列中的条目匹配。
                                 </p>
                              </li>
                              <li>
                                 <p><code class="codeph">bgcolor</code>属性是可选的，它指定地图的背景颜色。如果此属性的值设置为<code class="codeph">NONE</code> ，则背景将是透明的。（目前，只有PNG格式的平铺图像才能具有透明背景。）
                                 </p>
                              </li>
                              <li>
                                 <p><code class="codeph">out_of_bounds_color</code>属性是可选的，它指定数据边界之外的区域的颜色。数据边界由<code class="codeph">&lt;coordinate_system&gt;</code>元素的属性指定。
                                 </p>
                              </li>
                              <li>
                                 <p><code class="codeph">db_tile_table</code>属性是可选的，指定用于缓存切片图层图像切片的数据库表。如果未指定该属性，则会将切片缓存在地图可视化工具的磁盘缓存中。
                                 </p>
                              </li>
                           </ul>
                           <p>仅当外部地图服务提供者呈现地图图块时，才需要<code class="codeph">&lt;external_map_source&gt;</code>元素。该元素具有以下属性：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><code class="codeph">url</code>属性是必需的，并指定可从中提取地图图块的地图服务URL（例如， <code class="codeph">http://myhost/mapviewer/omserver</code> ）。</p>
                              </li>
                              <li>
                                 <p><code class="codeph">adapter_class</code>属性是必需的，并指定地图适配器类的全名，包括包名称（例如， <code class="codeph">mcsadapter.MVAdapter</code> ）。
                                 </p>
                              </li>
                              <li>
                                 <p>仅当必须通过代理服务器访问外部地图提供程序服务器时，才需要<code class="codeph">proxy_host</code>和<code class="codeph">proxy_port</code>属性。这些属性分别指定代理服务器的主机名和端口号。如果将<code class="codeph">proxy_host</code>指定为<code class="codeph">NONE</code> ，则所有地图图块请求将直接发送到远程服务器，而无需通过任何代理服务器。如果省略<code class="codeph">proxy_host</code>或指定空字符串，则在发送地图图块请求时将使用<code class="codeph">mapViewerConfig.xml file</code>定义的全局地图可视化器代理设置。
                                 </p>
                              </li>
                              <li>
                                 <p><code class="codeph">timeout</code>属性是可选的，它指定在放弃尝试之前地图图块服务器必须等待外部地图图块图像的毫秒数。默认超时值为15000。
                                 </p>
                              </li>
                              <li>
                                 <p><code class="codeph">request_method</code>属性是可选的，用于发送地图图块请求的HTTP请求方法;它的值可以是<code class="codeph">POST</code> （默认值）或<code class="codeph">GET</code> 。</p>
                              </li>
                           </ul>
                           <p>有关外部地图图块层的更多信息和示例，请参阅<a href="map-visualization-servers.html#GUID-25DD5A19-EC7F-4BB7-B1BA-E1CC2651EC04">使用外部Web地图源创建地图图块层</a> 。
                           </p>
                           <p><code class="codeph">&lt;external_map_source&gt;</code>元素中的&lt;properties&gt;元素可以包含多个<code class="codeph">&lt;property&gt;</code>元素，每个元素都指定一个用户定义的参数，供地图适配器在获取地图图块时使用。相同的地图源适配器可以使用不同的参数集来获取不同的地图图块层。例如，示例映射可视化器适配器<code class="codeph">mcsadapter.地图可视化MVAdapter</code>附带的MVAdapter</code>接受如下定义的参数：</p><pre class="oac_no_warn" dir="ltr">&lt;properties&gt; &lt;property name =“data_source”value =“elocation”/&gt; &lt;property name =“base_map”value =“us_base_map”/&gt; &lt;/ properties&gt;</pre><p>但是，通过更改<code class="codeph">value</code>属性值，您可以使用此适配器从同一数据源或不同的数据源获取不同的基本映射。
                           </p>
                           <p><code class="codeph">&lt;tile_storage&gt;</code>元素指定地图图块层的存储设置。
                           </p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>可选的<code class="codeph">root_path</code>属性指定要用作<code class="codeph">root_path</code>贴存储的根目录的文件系统目录。如果省略此属性或无效，则使用<code class="codeph">mapViewerConfig.xml</code>文件中定义的默认根目录。
                                 </p>
                              </li>
                              <li>
                                 <p>可选的<code class="codeph">xyz_storage_scheme</code>元素控制如何组织磁盘缓存中的地图图块的目录结构。默认值（ <code class="codeph">false</code> ）会导致使用地图可视化工具内部网格代码存储方案。值<code class="codeph">true</code>导致使用XYZ存储方案。有关更多信息，请参阅<a href="map-visualization-servers.html#GUID-9956C928-09A1-43E8-AB72-410F9A9B94EB">映射平铺存储方案：内部网格代码或XYZ</a></p>
                              </li>
                           </ul>
                           <p><code class="codeph">&lt;coordinate_system&gt;</code>元素指定地图坐标系，它有几个必需的属性。<code class="codeph">srid</code>属性指定坐标系的空间参考ID。<code class="codeph">minX</code>属性指定X维度的下限; <code class="codeph">minY</code>属性指定Y维度的下限; <code class="codeph">maxX</code>属性指定X维度的上限; <code class="codeph">maxY</code>属性指定Y维度的上限。对于标准经度/纬度（WGS 84）坐标系， <code class="codeph">srid</code>值为8307; <code class="codeph">minX</code> ， <code class="codeph">minY</code> ， <code class="codeph">maxX</code>和<code class="codeph">maxY</code>值分别为-180， <code class="codeph">minY</code>和90。
                           </p>
                           <p>对于内部地图图块层，地图坐标系可以与数据坐标系不同。如果两者不同，则地图图块服务器将地图数据转换为<code class="codeph">&lt;coordinate_system&gt;</code>元素中定义的坐标系，并使用此坐标系渲染地图图块图像。
                           </p>
                           <p><code class="codeph">&lt;tile_image&gt;</code>元素指定平铺图像大小设置，它具有以下必需属性： <code class="codeph">width</code>指定平铺图像的宽度（以屏幕像素为单位）， <code class="codeph">height</code>指定平铺图像的高度（以屏幕像素为单位）。
                           </p>
                           <p>可选的<code class="codeph">&lt;tile_bound&gt;</code>元素指定缓存的地图图块的边界框。地图图块服务器仅提取此框内的图块，如果请求的图块位于此框之外，则返回空白图块。边界框由地图数据坐标系中的矩形指定。矩形由<code class="codeph">&lt;coordinates&gt;</code>元素指定，格式如下：</p><pre class="oac_no_warn" dir="ltr">&lt;coordinates&gt; minX，minY，maxX，maxY &lt;/ coordinates&gt;</pre><p>默认缓存边界框与<code class="codeph">&lt;coordinate_system&gt;</code>元素中指定的边界框相同。
                           </p>
                           <p>可选的<code class="codeph">&lt;tile_dpi&gt;</code>元素将地图显示屏幕分辨率指定为“每英寸点数”值。如果未指定此元素，则会将<code class="codeph">mapViewerConfig.xml</code>文件中指定的值分配给切片图层。如果地图可视化工具在其WMTS服务中公开切片图层时必须符合OGC标准，则必须使用以下值指定此元素： <code class="codeph">90.714</code></p>
                           <p>可选的<code class="codeph">&lt;tile_meters_per_unit&gt;</code>元素指定每单位的米数。该单元由<code class="codeph">&lt;coordinate_system&gt;</code>元素中的<code class="codeph">srid</code>属性间接定义。例如，如果<code class="codeph">srid</code>为3857，则其单位为米，因此该属性的值必须为1.0;或者如果<code class="codeph">srid</code>是8307，则其单位为十进制度，因此该值可以设置为111319.49。如果未指定此元素，则地图可视化工具内部流程将根据数据边界计算值，结果非常接近111319.49。如果要通过地图可视化工具公开此图块层以提供WMTS服务，并且如果<code class="codeph">srid</code>为8307，则必须将此元素的值设置为111319.49以符合OGC标准。
                           </p>
                           <p><code class="codeph">&lt;zoom_levels&gt;</code>元素指定预定义的缩放级别。只有预定义缩放级别的图像切片才会被地图切片服务器高速缓存和提供。<code class="codeph">&lt;zoom_levels&gt;</code>元素可以有多个<code class="codeph">&lt;zoom_level&gt;</code>元素，每个元素指定一个预定义的缩放级别。如果没有<code class="codeph">&lt;zoom_level&gt;</code>元素，则地图图块服务器将使用<code class="codeph">&lt;zoom_level&gt;</code>元素内的以下属性自动生成<code class="codeph">&lt;zoom_levels&gt;</code>元素。（这些属性可以省略，如果存在任何<code class="codeph">&lt;zoom_level&gt;</code>元素，将被忽略。）
                           </p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><code class="codeph">levels</code>指定缩放级别的总数。
                                 </p>
                              </li>
                              <li>
                                 <p><code class="codeph">min_scale</code>指定最高（放大最多）缩放级别的地图图像的比例。
                                 </p>
                              </li>
                              <li>
                                 <p><code class="codeph">max_scale</code>指定最低（缩小最多）缩放级别的地图图像的比例。
                                 </p>
                              </li>
                              <li>
                                 <p><code class="codeph">min_tile_width</code>指定最高缩放级别的地图图块的宽度。宽度以地图数据单位指定。
                                 </p>
                              </li>
                              <li>
                                 <p><code class="codeph">max_tile_width</code>指定最低缩放级别的地图图块的宽度。宽度以地图数据单位指定。
                                 </p>
                              </li>
                           </ul>
                           <p>要使地图图块服务器能够自动生成各个缩放级别的定义，您必须指定以下属性的以下任一组合：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><code class="codeph">levels</code> ， <code class="codeph">min_scale</code>和<code class="codeph">max_scale</code></p>
                              </li>
                              <li>
                                 <p><code class="codeph">levels</code> ， <code class="codeph">min_tile_width</code>和<code class="codeph">max_tile_width</code></p>
                              </li>
                           </ul>
                           <p>当以这种方式定义缩放级别时，地图图块服务器自动导出所有单个缩放级别的定义，并使用为缩放级别生成的<code class="codeph">&lt;zoom_level&gt;</code>元素更新XML定义。然后，您可以根据需要调整每个缩放级别。
                           </p>
                           <p>地图块服务器基于定义缩放级别的顺序为每个缩放级别分配缩放级别编号。<code class="codeph">&lt;zoom_levels&gt;</code>元素中定义的第一个缩放级别是缩放级别0，第二个缩放级别是缩放级别1，依此类推。这些缩放级别编号在切片请求中用于指代预定义的缩放级别。
                           </p>
                           <p><code class="codeph">&lt;zoom_level&gt;</code>元素指定预定义的缩放级别，并且它具有多个属性。<code class="codeph">description</code>属性是可选的，它指定缩放级别的文本描述。<code class="codeph">level_name</code>属性是可选的，指定缩放级别的名称。<code class="codeph">scale</code>属性指定缩放级别的地图比例;如果<code class="codeph">tile_width</code>和<code class="codeph">tile_height</code>属性，则需要它。<code class="codeph">tile_width</code>和<code class="codeph">tile_height</code>属性分别以地图数据单位指定图块宽度和高度。<code class="codeph">fetch_larger_tiles</code>属性是可选的，它指定是否获取较大的地图图像而不是小地图图像块;值为<code class="codeph">TRUE</code> （默认值）意味着可以获取可能包含多个地图图块的较大地图图像并将其分解为小地图图像图块，这可以节省地图图块服务器和地图服务提供商之间的网络往返行程。
                           </p>
                           <p>在<code class="codeph">&lt;zoom_level&gt;</code>元素中，必须指定<code class="codeph">scale</code>属性或指定<code class="codeph">tile_width</code>和<code class="codeph">tile_height</code>元素。
                           </p>
                           <p><code class="codeph">&lt;tile_bound&gt;</code>元素中的<code class="codeph">&lt;zoom_level&gt;</code>元素可选地指定缩放级别的缓存地图图块的边界框。地图图块服务器仅提取此框内的图块，如果请求的图块位于此框之外，则返回空白图块。边界框由地图数据坐标系中指定的矩形指定。矩形由<code class="codeph">&lt;coordinates&gt;</code>元素指定（在本主题前面说明）如果在<code class="codeph">&lt;tile_bound&gt;</code>元素中指定<code class="codeph">&lt;zoom_level&gt;</code>元素，它将覆盖由上面的<code class="codeph">&lt;tile_bound&gt;</code>元素指定的整体缓存边界框设置它在XML层次结构中。
                           </p>
                           <p><code class="codeph">&lt;auto_update&gt;</code>元素定义在修改基表中的空间数据时如何自动更新切片图层的磁盘缓存。有关详细信息，请参阅<a href="map-visualization-servers.html#GUID-5D18BF91-F92B-46BE-B3EE-79CCECA6DF09">将&lt;auto_update&gt;元素添加到切片图层定义</a> 。
                           </p>
                           <p><code class="codeph">&lt;themes&gt;</code>元素定义基于主题的图层（而不是基于基本图的图层）。用于渲染图像切片的主题在其子元素中列出。在每个子元素<code class="codeph">&lt;theme&gt;</code> ，需要<code class="codeph">name</code>属性来指定元数据中的预定义主题。另外两个可选属性<code class="codeph">from_level</code>和<code class="codeph">to_level</code>定义了该主题的可见性。这两个属性的默认值是<code class="codeph">from_level</code>为0（包含最少的地图详细信息）和最后一个级别的<code class="codeph">to_level</code> （包含最多的地图详细信息）。
                           </p>
                        </div>
                        <!-- class="example" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="map-visualization-servers.html#GUID-A144D404-681B-4BBE-A3FF-E9826A5DF605">映射平铺服务器配置</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="JIMPV10126"></a><a id="JIMPV10125"></a><div class="props_rev_3"><a id="GUID-9956C928-09A1-43E8-AB72-410F9A9B94EB" name="GUID-9956C928-09A1-43E8-AB72-410F9A9B94EB"></a><h5 id="JIMPV-GUID-9956C928-09A1-43E8-AB72-410F9A9B94EB" class="sect5"><span class="enumeration_section">3.2.2.3</span>地图平铺存储方案：内部网格代码或XYZ</h5>
                     <div>
                        <p><code class="codeph">&lt;file_storage&gt;</code>元素的<code class="codeph">xyz_storage_scheme</code>属性（在<a href="map-visualization-servers.html#GUID-5CF7DC08-0B32-4C72-B9D0-F3762A7E6171">Map Tile Layer Configuration中</a>描述）控制如何组织磁盘缓存中的地图图块的目录结构。默认方案使用地图可视化工具的内部网格代码，但您可以选择XYZ存储方案。
                        </p>
                        <p>图<a href="map-visualization-servers.html#GUID-9956C928-09A1-43E8-AB72-410F9A9B94EB__BACBCJAG">3-4</a>显示了两种存储方案。
                        </p>
                        <div class="figure" id="GUID-9956C928-09A1-43E8-AB72-410F9A9B94EB__BACBCJAG">
                           <p class="titleinfigure">图3-4内部网格代码和XYZ地图平铺存储方案</p><img src="img/tile_storage_schemes.jpg" alt="下面是图3-4的描述" title="下面是图3-4的描述" longdesc="img_text/tile_storage_schemes.html"><br><a href="img_text/tile_storage_schemes.html">“图3-4内部网格代码和XYZ地图平铺存储方案”的说明</a></div>
                        <!-- class="figure" -->
                        <p>地图可视化器内部网格代码的细节对用户来说也不重要。您只需要知道有两种不同的存储方案选项，并且XYZ存储方案类似于多个地图数据提供商使用的方案。因此，如果要从离线项目（局部切片图层）的某些缩放级别导出切片，如果您发现XYZ存储方案更直观，则可以指定它。</p>
                        <p>在地图可视化器XYZ存储方案中，子目录的命名格式为<code class="codeph">/z/y/x</code> ，其中<code class="codeph">z</code>是缩放级别， <code class="codeph">y</code>是图块的行号，而图块的列号中是<code class="codeph">x</code> 。例如，在<a href="map-visualization-servers.html#GUID-9956C928-09A1-43E8-AB72-410F9A9B94EB__BACBCJAG">图3-4中</a> ，地图可视化器XYX存储方案在用于缩放级别8的区块行33的区块列中显示图像（ <code class="codeph">74.png</code> ， <code class="codeph">75.png</code> ， <code class="codeph">76,png</code> ， <code class="codeph">77.png</code> ）。
                        </p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="map-visualization-servers.html#GUID-A144D404-681B-4BBE-A3FF-E9826A5DF605">映射平铺服务器配置</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="JIMPV10073"></a><div class="props_rev_3"><a id="GUID-25DD5A19-EC7F-4BB7-B1BA-E1CC2651EC04" name="GUID-25DD5A19-EC7F-4BB7-B1BA-E1CC2651EC04"></a><h5 id="JIMPV-GUID-25DD5A19-EC7F-4BB7-B1BA-E1CC2651EC04" class="sect5"><span class="enumeration_section">3.2.2.4</span>使用外部Web地图源创建地图图块层</h5>
                     <div>
                        <div class="section">
                           <p>您可以使用外部Web地图源创建地图图块层，如下所示：</p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>登录到地图可视化工具管理控制台。</span></li>
                           <li class="stepexpand"><span>单击“ <span class="bold">创建切片图层”</span> 。</span></li>
                           <li class="stepexpand"><span>选择“ <span class="bold">外部”</span>作为此切片图层的地图图像源，然后单击“ <span class="bold">继续”</span> 。</span></li>
                           <li class="stepexpand"><span>在“为外部地图源页面创建地图切片图层”上，输入相应的信息：</span><div>
                                 <p><span class="bold">名称</span> ：瓷砖图层名称。示例： <code class="codeph">TILELAYER1</code></p>
                                 <p><span class="bold">数据源</span> ：切片图层的数据源名称。示例MVDEMO</p>
                                 <p><span class="bold">最大浏览器磁贴缓存时间（小时）</span> ：刷新磁贴之前缓存中的最大小时数。示例：168</p>
                                 <p><span class="bold">地图服务URL</span> ：示例： <code class="codeph">http://mycorp.com:7001/mapviewer/wms</code> ： <code class="codeph">http://mycorp.com:7001/mapviewer/wms</code> ： <code class="codeph">http://mycorp.com:7001/mapviewer/wms</code></p>
                                 <p><span class="bold">请求方法</span> ： <code class="codeph">HTTP GET</code></p>
                                 <p><span class="bold">适配器类</span> ： <code class="codeph">oracle.lbs.mapcache.adapter.WMSAdapter</code></p>
                                 <p><span class="bold">Jar文件位置</span> ：示例： <code class="codeph">adapterlibs/</code></p>
                                 <p><span class="bold">背景</span> ： <code class="codeph">transparent</code></p>
                                 <p><span class="bold">适配器属性</span> :(选中它并在适当时单击<span class="bold">添加</span>多次，每次都输入以下值。）
                                 </p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p><span class="bold">datasource</span> ：示例： <code class="codeph">mvdemo</code></p>
                                    </li>
                                    <li>
                                       <p><span class="bold">版本</span> ： <code class="codeph">1.1.1</code></p>
                                    </li>
                                    <li>
                                       <p><span class="bold">srs</span> ： <code class="codeph">EPSG:4326</code></p>
                                    </li>
                                    <li>
                                       <p><span class="bold">layers</span> ：示例： <code class="codeph">THEME_DEMO_COUNTIES,THEME_DEMO_HIGHWAYS</code></p>
                                    </li>
                                    <li>
                                       <p><span class="bold">格式</span> ： <code class="codeph">image/png</code></p>
                                    </li>
                                    <li>
                                       <p><span class="bold">透明</span> ： <code class="codeph">true</code></p>
                                    </li>
                                 </ul>
                                 <p><span class="bold">平铺存储</span> ：示例： <code class="codeph">C:\temp</code></p>
                                 <p><span class="bold">SRID</span> ： <code class="codeph">8307</code></p>
                                 <p><span class="bold">Min X</span> ： - <code class="codeph">180.0</code></p>
                                 <p><span class="bold">最大X</span> ： <code class="codeph">180.0</code></p>
                                 <p><span class="bold">闵Y</span> ： <code class="codeph">-90.0</code></p>
                                 <p><span class="bold">最大Y</span> ： <code class="codeph">90.0</code></p>
                                 <p><span class="bold">平铺宽度（像素）</span> ： <code class="codeph">256</code></p>
                                 <p><span class="bold">平铺高度（像素）</span> ： <code class="codeph">256</code></p>
                                 <p><span class="bold">文件格式</span> ： <code class="codeph">PNG</code></p>
                                 <p><span class="bold">#Zoom级别</span> ： <code class="codeph">10</code></p>
                                 <p><span class="bold">最小地图比例</span> ： <code class="codeph">1000</code></p>
                                 <p><span class="bold">最大地图比例</span> ： <code class="codeph">250000000</code></p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>单击“ <span class="bold">提交”</span>以创建切片图层。</span><div>
                                 <p>将显示消息<span class="italic">信息：已</span> <span class="italic">成功创建新地图图块层</span> 。
                                 </p>
                              </div>
                           </li>
                        </ol>
                        <div class="section">
                           <p>要验证创建的图层，可以单击左侧的“ <span class="bold">管理图块”图层</span> ，选择图块图层，然后单击“ <span class="bold">查看地图/管理图块”</span>以预览地图。
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="map-visualization-servers.html#GUID-A144D404-681B-4BBE-A3FF-E9826A5DF605">映射平铺服务器配置</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div><a id="JIMPV9995"></a><div class="props_rev_3"><a id="GUID-A2E5CC6C-EC68-4C67-A1D1-09B8123BF3C3" name="GUID-A2E5CC6C-EC68-4C67-A1D1-09B8123BF3C3"></a><h4 id="JIMPV-GUID-A2E5CC6C-EC68-4C67-A1D1-09B8123BF3C3" class="sect4"><span class="enumeration_section">3.2.3</span>映射缓存自动更新</h4>
                  <div>
                     <p>地图缓存自动更新功能会在缓存的地图图块变为“脏”时定期更新。当通过更新，插入或删除操作更改基表中的数据时，缓存的地图图块变<span class="bold">脏</span> ，因为此类更改可能会影响已缓存的地图图块的渲染样式的形状，注释或选择。更新脏区块会调用以下操作之一：a）刷新：删除缓存的脏区块，然后重新获取它们;或b）清除：仅删除缓存的脏磁贴。要启用切片图层的自动更新，请执行以下主要步骤：</p>
                     <ol>
                        <li>
                           <p><a href="map-visualization-servers.html#GUID-8761BE2F-D8AA-4B18-B403-0D707021FB2F">将&lt;dirty_tile_auto_update&gt;元素添加到mapViewerConfig.xml配置文件中</a> 。
                           </p>
                        </li>
                        <li>
                           <p><a href="map-visualization-servers.html#GUID-5D18BF91-F92B-46BE-B3EE-79CCECA6DF09">将&lt;auto_update&gt;元素添加到切片图层定义</a> 。
                           </p>
                        </li>
                        <li>
                           <p><a href="map-visualization-servers.html#GUID-58F058AE-426D-4951-AE2D-484708A92EA4">创建脏MBR表，基表的日志表和触发器</a> 。
                           </p>
                        </li>
                     </ol>
                     <p>要测试自动磁贴更新，请按照<a href="map-visualization-servers.html#GUID-4BC91BF6-09DC-4B02-8754-61237959CCAE">启动地图可视化服务器中</a>的说明操作<a href="map-visualization-servers.html#GUID-4BC91BF6-09DC-4B02-8754-61237959CCAE">并测试地图缓存自动更新功能</a> 。
                     </p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="map-visualization-servers.html#GUID-8761BE2F-D8AA-4B18-B403-0D707021FB2F">将&lt;dirty_tile_auto_update&gt;元素添加到mapViewerConfig.xml配置文件中</a><br></li>
                        <li class="ulchildlink"><a href="map-visualization-servers.html#GUID-5D18BF91-F92B-46BE-B3EE-79CCECA6DF09">将&lt;auto_update&gt;元素添加到切片图层定义</a><br></li>
                        <li class="ulchildlink"><a href="map-visualization-servers.html#GUID-58F058AE-426D-4951-AE2D-484708A92EA4">创建脏MBR表，基表的日志表和触发器</a><br></li>
                        <li class="ulchildlink"><a href="map-visualization-servers.html#GUID-4BC91BF6-09DC-4B02-8754-61237959CCAE">启动地图可视化工具服务器并测试地图缓存自动更新功能</a><br></li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="map-visualization-servers.html#GUID-7E88B130-FB2F-47D1-A8B2-909CFB1454AC" title="地图图块服务器是一种地图图像缓存引擎，用于获取，缓存和提供预生成的固定大小的地图图像图块。">映射平铺服务器</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="JIMPV9996"></a><div class="props_rev_3"><a id="GUID-8761BE2F-D8AA-4B18-B403-0D707021FB2F" name="GUID-8761BE2F-D8AA-4B18-B403-0D707021FB2F"></a><h5 id="JIMPV-GUID-8761BE2F-D8AA-4B18-B403-0D707021FB2F" class="sect5"><span class="enumeration_section">3.2.3.1</span>将&lt;dirty_tile_auto_update&gt;元素添加到mapViewerConfig.xml配置文件中</h5>
                     <div>
                        <p>添加<code class="codeph">&lt;dirty_tile_auto_update&gt;</code>元素作为的子元素<code class="codeph">&lt;map_tile_server&gt;</code>元素。例如：</p><pre class="oac_no_warn" dir="ltr">&lt;map_tile_server&gt; &lt;tile_storage default_root_path =“/ scratch / tilecache /”/&gt; <span class="bold">&lt;dirty_tile_auto_update</span> <span class="bold">auto_update =“true”</span> <span class="bold">auto_update_interval =“1”</span> <span class="bold">recycle_interval =“168”/&gt;</span> &lt;/ map_tile_server&gt;</pre><p><code class="codeph">auto_update</code>属性在设置为<code class="codeph">true</code>时启用服务器的自动更新（默认值为<code class="codeph">false</code> ）。如果此属性设置为<code class="codeph">true</code> ，则服务器上的所有限定切片图层都将自动更新。要进行限定，切片图层必须具有正确的定义（请参阅<a href="map-visualization-servers.html#GUID-5D18BF91-F92B-46BE-B3EE-79CCECA6DF09">将&lt;auto_update&gt;元素添加到切片图层定义</a> ）。
                        </p>
                        <p><code class="codeph">auto_update_interval</code>属性设置用于检查基表的日志表和脏MBR表的重复间隔。其值以分钟为单位，默认值为1。该值不应超过几分钟，并且它不应该非常大（即使您更不频繁地更新基表，例如每天或每周）。应在启动地图可视化服务器之前创建基表的日志表和脏MBR表。用于创建这两个表以及相关序列和触发器的示例脚本包含在<a href="map-visualization-servers.html#GUID-58F058AE-426D-4951-AE2D-484708A92EA4">创建脏MBR表，基表的日志表和触发器中</a> 。
                        </p>
                        <p><code class="codeph">recycle_interval</code>属性指定在日志表和脏MBR表中保留已处理行的时间。它的值以小时为单位，默认值为168。将删除早于此的已处理行。
                        </p>
                        <p>当地图可视化工具启动时，它会从<code class="codeph">mapViewerConfig.xml</code>配置文件中加载<code class="codeph">&lt;dirty_tile_auto_update&gt;</code>元素，该元素将应用于此服务器的所有切片图层。如果找不到该元素，则服务器将禁用任何切片图层的自动更新功能。
                        </p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="map-visualization-servers.html#GUID-A2E5CC6C-EC68-4C67-A1D1-09B8123BF3C3">映射缓存自动更新</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="JIMPV9997"></a><div class="props_rev_3"><a id="GUID-5D18BF91-F92B-46BE-B3EE-79CCECA6DF09" name="GUID-5D18BF91-F92B-46BE-B3EE-79CCECA6DF09"></a><h5 id="JIMPV-GUID-5D18BF91-F92B-46BE-B3EE-79CCECA6DF09" class="sect5"><span class="enumeration_section">3.2.3.2</span>将&lt;auto_update&gt;元素添加到切片图层定义</h5>
                     <div>
                        <p>添加<code class="codeph">&lt;auto_update&gt;</code>后元素<code class="codeph">&lt;zoom_levels&gt;</code>在平铺层限定元件。您可以手动添加此元素，也可以使用地图可视化工具Web控制台。例如：</p><pre class="oac_no_warn" dir="ltr">&lt;auto_update finest_level_to_refresh =“15”dirty_mbr_batch =“100”dirty_mbr_cap =“1000”&gt; &lt;dirty_mbr_table name =“mbr_mcau”/&gt; &lt;logtable name =“log_mcau_tl”/&gt; &lt;/ auto_update&gt;</pre><p><code class="codeph">finest_level_to_refresh</code>属性指定要刷新的最佳级别。从级别0，级别1，级别2，...开始的级别将被刷新，并且将清除剩余缩放级别中的脏区块。如果基表中的数据修改通常是地理上较小的特征（应该是大多数数据修改），例如更改餐馆名称或插入新开发的街道，则值可以是在图块层中找到的最精细缩放级别定义。例如，如果从0到18有19个缩放级别，则此属性可以设置为18。
                        </p>
                        <p><code class="codeph">dirty_mbr_batch</code>属性指定脏MBR表中用于更新的最大行数。默认值为100。此值可防止服务器一次更新大量磁贴。相反，如果大量脏区块需要刷新或清除操作，则这些区块将在许多更新中处理，并且一个区间仅处理一个批处理。要确定此属性的最佳值，请考虑以下因素：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">auto_update_interval</code>值（请参阅<a href="map-visualization-servers.html#GUID-8761BE2F-D8AA-4B18-B403-0D707021FB2F">将&lt;dirty_tile_auto_update&gt;元素添加到mapViewerConfig.xml配置文件中</a> ）以及服务器能够在间隔内完成多少个切片</p>
                           </li>
                           <li>
                              <p>服务器可以使用的内存量</p>
                           </li>
                           <li>
                              <p>为地图缓存自动更新启用的切片图层数量以及其基表中更改的频率和大小</p>
                           </li>
                        </ul>
                        <p>由于没有精确计算最佳<code class="codeph">dirty_mbr_batch</code>值的公式，因此最佳做法是设置环境以测试不同的设置。选择值时，请考虑最坏的情况。要避免的两个极端情况是：a）该值太小以至于服务器在完成刷新操作后空闲，而脏MBR表中的脏MBR行数持续增长;或者b）该值太大以至于服务器内存不足，抛出内存不足异常，并关闭所有服务。
                        </p>
                        <p><code class="codeph">dirty_mbr_cap</code>属性指定在一个时间间隔内生成的日志表的最大脏块数。此约束可能会影响刷新操作的最佳缩放级别，然后将其余缩放级别设置为清除操作。脏磁贴的累积计数器从缩放级别0开始，到级别1，级别2，依此类推，直到达到上限或达到刷新的最佳级别。
                        </p>
                        <p>在达到指定的最佳级别以达到刷新之前达到级别为<span class="italic">n的上</span>限时，级别0，级别1，级别2，...和级别<span class="italic">n</span> -1中已经计数的切片用于刷新操作（删除然后重新获取） ），以及当前缩放级别（本例中的级别<span class="italic">n</span> ）和所有其他更精细的级别用于清除操作（从地图图块缓存中删除而不重新获取）。例如，如果给定的值为1000，则脏区块计数器在缩放级别4处达到上限，然后从级别0到级别3的所有计数的脏区块用于刷新。之后，级别3中的每个脏图块将用于定义矩形（图块覆盖在地面上的矩形区域），此矩形将被视为MBR，以清除从级别4，级别5开始的所有缩放级别，以及此图块层中的所有其他更精细的级别。
                        </p>
                        <p><code class="codeph">&lt;dirty_mbr_table&gt;</code>元素指定脏MBR表的名称，其中要存储，检索和更新脏MBR。您需要在启动地图可视化工具服务器之前手动创建此表（请参阅<a href="map-visualization-servers.html#GUID-58F058AE-426D-4951-AE2D-484708A92EA4">创建脏MBR表，基表的日志表和触发器中</a>的示例）。
                        </p>
                        <p><code class="codeph">&lt;logtable&gt;</code>元素指定基表的日志表的名称。如果一个tile层依赖于多个基表（通常就是这种情况），那么每个基表中的每个更改都应该通过其触发器插入到该日志表中;如果架构由<code class="codeph">mapViewerConfig.xml</code>定义的多个数据源访问，则基表中的一个更改应为每个数据源插入一行。
                        </p>
                        <p>建议每个切片层都有自己的日志表和自己的脏MBR表。应在启动服务器之前手动创建这两个表（请参阅<a href="map-visualization-servers.html#GUID-58F058AE-426D-4951-AE2D-484708A92EA4">创建脏MBR表，基表的日志表和触发器中</a>的示例）。
                        </p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="map-visualization-servers.html#GUID-A2E5CC6C-EC68-4C67-A1D1-09B8123BF3C3">映射缓存自动更新</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="JIMPV9998"></a><div class="props_rev_3"><a id="GUID-58F058AE-426D-4951-AE2D-484708A92EA4" name="GUID-58F058AE-426D-4951-AE2D-484708A92EA4"></a><h5 id="JIMPV-GUID-58F058AE-426D-4951-AE2D-484708A92EA4" class="sect5"><span class="enumeration_section">3.2.3.3</span>创建脏MBR表，基表的日志表和触发器</h5>
                     <div>
                        <p>本节包含的示例一起显示了创建脏MBR表，基表的日志表和触发器的操作。示例段假定已定义名为DEMO_MAP的基本映射，并且有一个名为MVDEMO的数据源正在访问该模式。</p>
                        <p>示例代码段包含说明性注释，并执行以下操作：</p>
                        <ol>
                           <li>
                              <p>创建包含<code class="codeph">&lt;auto_update&gt;</code>元素的切片图层。
                              </p><pre class="oac_no_warn" dir="ltr">插入user_sdo_cached_maps值（'MCAU_TL'，'地图缓存自动更新的测试用例'，''，'是'，'是'，'&lt;map_tile_layer name =“MCAU_TL”image_format =“PNG”http_header_expires =“168.0”concurrent_fetching_threads =“3”fetch_larger_tiles =“false”&gt; &lt;internal_map_source data_source =“mvdemo”base_map =“DEMO_MAP”/&gt; &lt;coordinate_system srid =“8307”minX =“ -  180.0”maxX =“180.0”minY =“ -  90.0”maxY = “90.0”/&gt; &lt;tile_image width =“256”height =“256”/&gt; &lt;tile_dpi value =“90.7142857”/&gt; &lt;tile_meters_per_unit value =“111319.49079327358”/&gt; &lt;zoom_levels levels =“19”min_scale =“2132.729583849784”max_scale =“559082264.0287178”&gt; &lt;/ zoom_levels&gt; <span class="bold">&lt;auto_update</span> <span class="bold">finest_level_to_refresh =“15”</span> <span class="bold">dirty_mbr_batch =“100”</span> <span class="bold">dirty_mbr_cap =“1000”&gt;</span> <span class="bold">&lt;dirty_mbr_table name =“mbr_MCAU_TL”/&gt;</span> <span class="bold">&lt;logtable name =“log_MCAU_TL”/&gt;</span> <span class="bold">&lt;/ auto_update&gt;</span> &lt; / map_tile_layer&gt;'，'DEMO_MAP'，''）;承诺;</pre></li>
                           <li>
                              <p>创建一个脏的MBR表及其触发器。</p>
                              <p>脏MBR表存储脏MBR以进行刷新和清除操作。使用日志表中的几何图形填充此表。还创建了一个序列和触发器，用于为此表的ID列生成唯一ID。</p><pre class="oac_no_warn" dir="ltr">- 创建脏MBR表CREATE TABLE mbr_MCAU_TL（ - 脏MBR表名id号， -  id，用于跟踪状态数据源varchar2（32）， - 数据源名称tile_layer varchar2（32）， -  tile层name logtable varchar2（32）， -  basetable的log-table refresh_status varchar2（1）， -  n：未刷新，y：刷新，p：pending，f：failed clear_status varchar2（1）， -  n：未清除， y：清除，p：挂起，f：失败mbr_to_clear varchar2（1）， -  y / n：使用tile的mbr清除更精细的级别zoom_level number， - 此tile的缩放级别mx number， -  mesh x ordinate my number ， - 网格Y纵坐标minx数， -  tile的最小x坐标miny数， -  tile的最小y坐标maxx number， -  tile的最大x坐标maxy数， -  tile的最大y坐标insert_time Date， - 当tile时MBR被插入此表update_time日期 - 最近更新（刷新/清除）时间）; - 为mbr_MCAU_TL创建一个序列CREATE SEQUENCE mbr_MCAU_TL_seq START WITH 1 INCREMENT BY 1 CYCLE MAXVALUE 9999999999; - 在插入mbr_MCAU_TL之前创建一个触发器以获取唯一id创建或替换触发器mbr_MCAU_TL_br  - 在插入引用new的行作为每行的旧旧之前 - 对于每一行开始选择mbr_MCAU_TL_seq.nextval INTO：new.id来自双重;结束; /</pre></li>
                           <li>
                              <p>创建一个日志表。</p>
                              <p>基表的日志表用于记录在图块层的基表中更改的行。由于每个切片图层在生成地图图块时都依赖于其基表中的数据，因此对基表所做的任何更改（例如几何图形的修改或对属性值的更改）都可能会影响它们在相应地图图块中的表示。更改日志表通过在其基表上创建的触发器记录此类更改。</p>
                              <p>以下语句使用序列在表上创建日志表，序列和触发器以生成唯一ID值。</p><pre class="oac_no_warn" dir="ltr">- 创建日志表创建表log_MCAU_TL（id号，geomO sdo_geometry， - 受影响的几何或其属性，原始几何geomN sdo_geometry， - 受影响的几何或其属性，新几何修改日期， - 当修改发生时status varchar2（1）， -  y：processed，n：未处理数据源varchar2（32）， - 数据源名称，多个ds可以访问同一个日志tile_layer varchar2（32）， -  tile layer name basetable varchar2 （32） - 基表名，多个基表可以插入此日志中）; - 为log_MCAU_TL创建一个序列CREATE SEQUENCE log_MCAU_TL_seq START WITH 1 INCREMENT BY 1 CYCLE MAXVALUE 9999999999; - 为log_MCAU_TL创建一个触发器，以便在插入log_MCAU_TL之前创建一个唯一的id创建或替换触发器log_MCAU_TL_br  - 在插入new之前将new引用为旧的每行 - 对于每一行开始select select log_MCAU_TL_seq.nextval INTO：new.id来自双重;结束; /</pre></li>
                           <li>
                              <p>在每个基表上创建一个触发器，以将更改插入到日志表中。</p>
                              <p>在基表的触发器中，插入到日志表中的任何几何都将转换为与图块层相同的空间参照系（坐标系）。如果在<code class="codeph">mapViewerConfig.xml</code>配置文件中定义了多个访问相同模式的数据源，则应在每个触发器定义中为每个这些数据源使用一个INSERT语句。
                              </p>
                              <p>以下陈述作出以下假设：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>一个名为MVDEMO的数据源正在访问包含MCAU_TL切片图层的模式。（因此，每个触发器定义中只有一个INSERT语句。）</p>
                                 </li>
                                 <li>
                                    <p>图块层的空间参照系（SRID）是8307（WGS 84经度/纬度）。</p>
                                 </li>
                                 <li>
                                    <p>要监视此图块层有四个基表：州，县，州际公路和城市。</p>
                                 </li>
                              </ul><pre class="oac_no_warn" dir="ltr"><span class="bold">--states</span>在插入或更新或删除状态后<span class="bold">触发</span>创建或替换触发器states_MCAU_TL_ar  - 当（old.geom IS NOT NULL或new.geom IS NOT NULL）声明oldGeom SDO_GEOMETRY时，每行引用new作为new old的任何更改; newGeom SDO_GEOMETRY; tileSRID号码;开始tileSRID：= 8307; oldGeom：=：old.geom;如果（：old.geom IS NOT NULL）则if（：old.geom。SDO_SRID！= tileSRID）然后从dual中选择sdo_cs.transform（：old.geom，tileSRID）到oldGeom;万一;万一; newGeom：=：new.geom;如果（：new.geom IS NOT NULL）则if（：new.geom。SDO_SRID！= tileSRID）然后从dual中选择sdo_cs.transform（：new.geom，tileSRID）到newGeom;万一;万一;插入log_MCAU_TL（id，geomO，geomN，modified，status，datasource，tile_layer，basetable）值（null，oldGeom，newGeom，sysdate，'n'，'MVDEMO'，'MCAU_TL'，'states'）;结束; / <span class="bold">--counties触发器</span>创建或替换触发器counties_MCAU_TL_ar之后插入或更新或删除引用new为old的旧的每个旧的每个行（old.geom IS NOT NULL或new.geom IS NOT NULL）声明oldGeom SDO_GEOMETRY; newGeom SDO_GEOMETRY; tileSRID号码;开始tileSRID：= 8307; oldGeom：=：old.geom;如果（：old.geom IS NOT NULL）则if（：old.geom。SDO_SRID！= tileSRID）然后从dual中选择sdo_cs.transform（：old.geom，tileSRID）到oldGeom;万一;万一; newGeom：=：new.geom;如果（：new.geom IS NOT NULL）则if（：new.geom。SDO_SRID！= tileSRID）然后从dual中选择sdo_cs.transform（：new.geom，tileSRID）到newGeom;万一;万一;插入log_MCAU_TL（id，geomO，geomN，modified，status，datasource，tile_layer，basetable）值（null，oldGeom，newGeom，sysdate，'n'，'MVDEMO'，'MCAU_TL'，'counties'）;结束; /  - <span class="bold">insterstates触发</span>创建或替换触发器interstates_MCAU_TL_ar之后插入或更新或删除州际时引用new作为旧的旧行为（old.geom IS NOT NULL或new.geom IS NOT NULL）声明oldGeom SDO_GEOMETRY; newGeom SDO_GEOMETRY; tileSRID号码;开始tileSRID：= 8307; oldGeom：=：old.geom;如果（：old.geom IS NOT NULL）则if（：old.geom。SDO_SRID！= tileSRID）然后从dual中选择sdo_cs.transform（：old.geom，tileSRID）到oldGeom;万一;万一; newGeom：=：new.geom;如果（：new.geom IS NOT NULL）则if（：new.geom。SDO_SRID！= tileSRID）然后从dual中选择sdo_cs.transform（：new.geom，tileSRID）到newGeom;万一;万一;插入log_MCAU_TL（id，geomO，geomN，modified，status，datasource，tile_layer，basetable）值（null，oldGeom，newGeom，sysdate，'n'，'MVDEMO'，'MCAU_TL'，'interstates'）;结束; / <span class="bold">--cities触发器</span>创建或替换触发器cities_MCAU_TL_ar之后插入或更新或删除引用new的旧城市作为每行的旧旧时（old.location IS NOT NULL或new.location IS NOT NULL）声明oldGeom SDO_GEOMETRY; newGeom SDO_GEOMETRY; tileSRID号码;开始tileSRID：= 8307; oldGeom：=：old.location; if（：old.location IS NOT NULL）则if（：old.location。SDO_SRID！= tileSRID）然后从dual中选择sdo_cs.transform（：old.location，tileSRID）到oldGeom;万一;万一; newGeom：=：new.location; if（：new.location IS NOT NULL）则if（：new.location。SDO_SRID！= tileSRID）然后从dual中选择sdo_cs.transform（：new.location，tileSRID）到newGeom;万一;万一;插入log_MCAU_TL（id，geomO，geomN，modified，status，datasource，tile_layer，basetable）值（null，oldGeom，newGeom，sysdate，'n'，'MVDEMO'，'MCAU_TL'，'cities'）;结束; / commit;</pre></li>
                        </ol>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="map-visualization-servers.html#GUID-A2E5CC6C-EC68-4C67-A1D1-09B8123BF3C3">映射缓存自动更新</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="JIMPV9999"></a><div class="props_rev_3"><a id="GUID-4BC91BF6-09DC-4B02-8754-61237959CCAE" name="GUID-4BC91BF6-09DC-4B02-8754-61237959CCAE"></a><h5 id="JIMPV-GUID-4BC91BF6-09DC-4B02-8754-61237959CCAE" class="sect5"><span class="enumeration_section">3.2.3.4</span>启动地图可视化服务器并测试地图缓存自动更新功能</h5>
                     <div>
                        <p>要测试自动切片更新，请启动地图可视化工具服务器，然后更改基表中的一行或多行。</p>
                        <ol>
                           <li>
                              <p>修改基表中的行。例如：</p><pre class="oac_no_warn" dir="ltr">更新城市设置城市='伍斯特'其中city ='Worcester'和state_abrv ='MA';</pre></li>
                           <li>
                              <p>检查日志表。例如：</p><pre class="oac_no_warn" dir="ltr">select * from log_mcau_tl;</pre><p>结果应该包括刚刚由基表触发器插入的行。</p>
                           </li>
                           <li>
                              <p>等待大约一个时间间隔（在本例中为一分钟），然后检查脏MBR表。例如：</p><pre class="oac_no_warn" dir="ltr">从mbr_mcau_tl中选择count（*）;</pre><p>结果应该包括服务器插入的一些脏MBR行。</p>
                           </li>
                        </ol>
                        <p>您还可以在脏MBR表中的<code class="codeph">refresh_status</code>列中查找更改。最初插入行时，状态设置为<code class="codeph">n</code>表示<span class="italic">未处理</span> ;然后它在<span class="italic">处理</span>时变为<code class="codeph">p</code> <span class="italic">挂起</span> ;更新完成后，它将更改为<code class="codeph">y</code>以进行<span class="italic">处理</span> 。同时，在服务器上，您可以看到服务器一直在更新磁贴（服务器的记录器需要设置为<code class="codeph">finest</code>级别以查看最精细的记录信息）。
                        </p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="map-visualization-servers.html#GUID-A2E5CC6C-EC68-4C67-A1D1-09B8123BF3C3">映射缓存自动更新</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div><a id="JIMPV10127"></a><div class="props_rev_3"><a id="GUID-9576FC06-D773-4C47-8F5F-DF3AD4567206" name="GUID-9576FC06-D773-4C47-8F5F-DF3AD4567206"></a><h4 id="JIMPV-GUID-9576FC06-D773-4C47-8F5F-DF3AD4567206" class="sect4"><span class="enumeration_section">3.2.4</span>地图图块的UTFGrid：包括有关要素的文本信息</h4>
                  <div>
                     <p>当图块层启用了UTFGrid时，名为UTFGrid的数据集将成为图像图块的“伴随”，其中包含有关图像图块中要素的文本信息。当响应鼠标事件时，浏览器可以显示此文本信息，例如鼠标单击地图功能。</p>
                     <p>UTFGrid数据集以JSON格式存储，并且具有两个组件：（a）镜像其伴随图像块的网格数据集，以及（b）所有网格单元的属性。每个网格单元的值用作链接图像切片单元格及其属性的关键。地图上的每个图像像素都与UTFGrid网格单元格相关联，并且单元格的值指示可以检索其属性（作为文本字符串）的位置。为了存储效率，每个网格单元的值以修订的UTF-8编码方案编码。</p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="map-visualization-servers.html#GUID-C8A62EAE-5C58-43F8-93C0-B964927F8C11">为拼贴层启用UTFGrid选项</a><br></li>
                        <li class="ulchildlink"><a href="map-visualization-servers.html#GUID-748AD86A-956E-4624-9242-A6F827D66C49">编码密钥并解码网格单元的值</a><br></li>
                        <li class="ulchildlink"><a href="map-visualization-servers.html#GUID-FFBDBD49-AB91-470C-9182-31D6D19DFFC0">构建UTFGrid测试用例</a><br></li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="map-visualization-servers.html#GUID-7E88B130-FB2F-47D1-A8B2-909CFB1454AC" title="地图图块服务器是一种地图图像缓存引擎，用于获取，缓存和提供预生成的固定大小的地图图像图块。">映射平铺服务器</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="JIMPV10128"></a><div class="props_rev_3"><a id="GUID-C8A62EAE-5C58-43F8-93C0-B964927F8C11" name="GUID-C8A62EAE-5C58-43F8-93C0-B964927F8C11"></a><h5 id="JIMPV-GUID-C8A62EAE-5C58-43F8-93C0-B964927F8C11" class="sect5"><span class="enumeration_section">3.2.4.1</span>为拼贴层启用UTFGrid选项</h5>
                     <div>
                        <p>要为地图图块层启用UTFGrid选项，请在图块层的USER_ADO_CACHED_MAPS行中，在<code class="codeph">&lt;map_tile_layer&gt;</code>元素中指定<code class="codeph">utfgrid="true"</code> ，并可选择使用<code class="codeph">utfgrid_resolution</code>属性指定UTFGrid分辨率（默认值为4） 。例如：</p><pre class="oac_no_warn" dir="ltr">插入user_sdo_cached_maps值（'UTFGRID_TL'，'utfgrid enalbled test case'，''，'YES'，'YES'，'&lt;map_tile_layer name =“UTFGRID_TL”image_format =“PNG”http_header_expires =“168.0”concurrent_fetching_threads =“3” fetch_larger_tiles =“false”persistent_tiles =“true” <span class="bold">utfgrid =“true”utfgrid_resolution =“4”</span> &gt; &lt;internal_map_source data_source =“mvdemo”base_map =“UTFGRID_BASEMAP”bgcolor =“#dddddd”out_of_bounds_color =“＃eeddff”/&gt; &lt;tile_storage root_path =“/ temp”xyz_storage_scheme =“true”/&gt; &lt;coordinate_system srid =“8307”minX =“ -  180.0”maxX =“180.0”minY =“ -  90.0”maxY =“90.0”/&gt; &lt;tile_image width =“256” height =“256”/&gt; &lt;tile_dpi value =“90.7142857”/&gt; &lt;tile_meters_per_unit value =“111319.49079327358”/&gt; &lt;zoom_levels levels =“19”min_scale =“2132.729583849784”max_scale =“559082264.0287178”&gt; &lt;/ zoom_levels&gt; &lt;/ map_tile_layer &gt;'，'UTFGRID_BASEMAP'，''）;承诺;</pre><p><code class="codeph">utfgrid_resolution</code>属性确定网格单元格在UTFGrid数据集中的精细程度，默认值4表示一个网格单元格表示其随播图像图块中的4乘4图像像素。例如，如果256x256是图像的尺寸，则网格的尺寸将为64x64，并且行= 10，列= 20的网格单元表示从第40行到第43行以及从第80行到第83列的图块图像中的像素（注意，一个网格单元代表16个图像平铺像素）。当地图图像区块中的多个特征以指示的分辨率落入一个网格单元中时，具有多个或多个像素的特征被分配给网格单元。存储在网格单元中的值使用UTF-8编码进行编码。
                        </p>
                        <p>如果图块层启用了UTFGrid，则当地图服务器生成地图图像图块时，它还将生成以JSON格式存储的UTFGrid数据集。当客户端请求地图图像切片时，图像切片及其UTFGrid JSON文件都将在响应中返回。</p>
                        <p>在地图可视化工具服务器中，UTFGrid JSON文件与其图像切片存储在同一位置。例如，如果图像切片缓存在<code class="codeph">/mapcache/MVDEMO.UTFGRID_TL/0/1/2.PNG</code> ，您还应该看到它的伴随UTFGrid文件<code class="codeph">/mapcache/MVDEMO.UTFGRID_TL/0/1/2.JSON</code> 。</p>
                        <p>如果图像切片存储在数据库表中（请参阅在数据库表中<a href="map-visualization-servers.html#GUID-F9C62C09-CF22-40F0-B4D3-E9A5AC0FED32">存储切片</a> ），则为切片图层禁用磁盘高速缓存时，不支持此UTFGrid选项（请参阅<a href="map-visualization-servers.html#GUID-A4B8E43B-A59B-4D77-89C7-91A29602DE46">直接流式传输切片而不存储它们</a> ）。
                        </p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="map-visualization-servers.html#GUID-9576FC06-D773-4C47-8F5F-DF3AD4567206">地图图块的UTFGrid：包括有关要素的文本信息</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="JIMPV10129"></a><div class="props_rev_3"><a id="GUID-748AD86A-956E-4624-9242-A6F827D66C49" name="GUID-748AD86A-956E-4624-9242-A6F827D66C49"></a><h5 id="JIMPV-GUID-748AD86A-956E-4624-9242-A6F827D66C49" class="sect5"><span class="enumeration_section">3.2.4.2</span>编码密钥并解码网格单元的值</h5>
                     <div>
                        <p>切片图层可以包含多个数据图层或主题。每个主题都有自己的网格数据集，UTFGrid JSON对象可能包含多个网格数据集。在每个主题的网格中，其图像图块中显示的要素也使用样式“绘制”以呈现每个要素。至于其关联的图像区块，使用其键绘制特征，并且键是分配给每个特征的序号。此数字用于为单元格的值分配UTF-8编码值。</p>
                        <p>当在图像块中的特征上触发鼠标事件时，可以定位图像像素的对应网格单元，然后可以检索单元的值（UTF-8编码值）。然后可以对该UTF-8编码值进行解码以导出其密钥，即序数。使用该密钥，可以获得存储的属性。（请参阅<a href="map-visualization-servers.html#GUID-FFBDBD49-AB91-470C-9182-31D6D19DFFC0">构建UTFGrid测试用例</a>结尾附近的示例。）
                        </p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="map-visualization-servers.html#GUID-9576FC06-D773-4C47-8F5F-DF3AD4567206">地图图块的UTFGrid：包括有关要素的文本信息</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="JIMPV10130"></a><div class="props_rev_3"><a id="GUID-FFBDBD49-AB91-470C-9182-31D6D19DFFC0" name="GUID-FFBDBD49-AB91-470C-9182-31D6D19DFFC0"></a><h5 id="JIMPV-GUID-FFBDBD49-AB91-470C-9182-31D6D19DFFC0" class="sect5"><span class="enumeration_section">3.2.4.3</span>构建UTFGrid测试用例</h5>
                     <div>
                        <div class="section">
                           <p>此测试用例侧重于服务器端。它有两个主要步骤：创建启用UTFGrid的切片图层，并向服务器发送一些硬编码请求。（在实际应用程序中，您需要使用客户端侧地图应用程序来使用切片图层。）</p>
                           <ol>
                              <li>
                                 <p>创建启用UTFGrid的切片图层。</p>
                                 <p>如果元数据中存在所有空间基表和样式，则以下示例将创建四个主题，一个底图和一个启用UTFGrid的切片图层。因为存储在UTFGrid JSON对象的特征的属性从来<code class="codeph">&lt;hidden_info&gt;</code>主题的元件，所述<code class="codeph">&lt;hidden_info&gt;</code>元件中的三个四个主题的限定。（如果四个主题中没有一个定义了<code class="codeph">&lt;hidden_info&gt;</code>元素，那么启用此tile图层的UTFGrid选项就没有意义，因为UTFGrid对象将为空并且创建它仍然会消耗服务器资源。）
                                 </p><pre class="oac_no_warn" dir="ltr">- 将主题1插入到USER_SDO_THEMES（名称，描述，base_table，geometry_column，styling_rules）值（'UTFGRID_THEME_DEMO_STATES'，'用于utfgrid测试'，'STATES'，'GEOM'，'&lt;？xml version =“1.0”standalone =“yes”？&gt; &lt;styling_rules&gt; &lt;hidden_info&gt; &lt;field column =“STATE”name =“State”/&gt; &lt;field column =“STATE_ABRV”name =“Abrv。”/&gt; &lt;field column =“TOTPOP”name =“Population”/&gt; &lt;/ hidden_info&gt; &lt;rule&gt; &lt;features style =“C.S02_COUNTRY_AREA”&gt; &lt;/ features&gt; &lt;label column =“STATE_ABRV”style =“T.S02_STATE_ABBREVS”&gt; 1 &lt;/ label&gt; &lt;/ rule&gt; &lt;/ styling_rules&gt;' ）; - 将主题2插入USER_SDO_THEMES（name，description，base_table，geometry_column，styling_rules）值（'UTFGRID_THEME_DEMO_COUNTIES'，'用于utfgrid测试'，'COUNTIES'，'GEOM'，'&lt;？xml version =“1.0”standalone =“yes”？&gt; &lt;styling_rules&gt; &lt;！ -  &lt;hidden_info&gt; &lt;field column =“COUNTY”name =“County”/&gt; &lt;field column =“FIPSSTCO”name =“Fips”/&gt; &lt;field column =“TOTPOP”name =“Population “/&gt; &lt;field column =”STATE_ABRV“name =”State“/&gt; &lt;/ hidden_info&gt;  - &gt; &lt;rule&gt; &lt;features style =”L.S06_BORDER_STATE“&gt; &lt;/ features&gt; &lt;/ rule&gt; &lt;/ styling_rules&gt;' ）; - 将主题3插入USER_SDO_THEMES（名称，描述，base_table，geometry_column，styling_rules）值（'UTFGRID_THEME_DEMO_HIGHWAYS'，'用于utfgrid测试'，'INTERSTATES'，'GEOM'，'&lt;？xml version =“1.0”standalone =“yes”？&gt; &lt;styling_rules&gt; &lt;hidden_info&gt; &lt;field column =“HIGHWAY”name =“Highway”/&gt; &lt;field column =“ROUTEN”name =“No。”/&gt; &lt;/ hidden_info&gt; &lt;rule&gt; &lt;features style =“L。 S04_ROAD_INTERSTATE“&gt; &lt;/ features&gt; &lt;label column =”routen“style =”M.HWY_USA_INTERSTATE_NARROW“&gt;（3-length（routen））&lt;/ label&gt; &lt;/ rule&gt; &lt;/ styling_rules&gt;'）; - 将主题4插入USER_SDO_THEMES（name，description，base_table，geometry_column，styling_rules）值（'UTFGRID_THEME_DEMO_CITIES'，'用于utfgrid测试'，'CITIES'，'LOCATION'，'&lt;？xml version =“1.0”standalone =“yes”？&gt; &lt;styling_rules&gt; &lt;hidden_info&gt; &lt;field column =“CITY”name =“City”/&gt; &lt;field column =“POP90”name =“Population”/&gt; &lt;/ hidden_info&gt; &lt;rule&gt; &lt;features style =“M.ALL_CITY_L2 “&gt;（pop90在200000和1000000之间）&lt;/ features&gt; &lt;label column =”city“style =”T.S07_CITIES_L2“&gt; 1 &lt;/ label&gt; &lt;/ rule&gt; &lt;rule&gt; &lt;features style =”M.ALL_CITY_L3“&gt; （pop90介于0和200000之间）&lt;/ features&gt; &lt;label column =“city”style =“T.S07_CITIES_L3”&gt; 1 &lt;/ label&gt; &lt;/ rule&gt; &lt;/ styling_rules&gt;'）; - 插入一个底图INSERT INTO USER_SDO_MAPS（名称，描述，定义）值（'UTFGRID_BASEMAP'，'用于utfgrid测试'，'&lt;？xml version =“1.0”standalone =“yes”？&gt; &lt;map_definition&gt; &lt;theme name =“UTFGRID_THEME_DEMO_STATES”min_scale =“1.5E8”max_scale =“0.0”scale_mode =“RATIO”/&gt; &lt;theme name =“UTFGRID_THEME_DEMO_COUNTIES”min_scale =“8500000.0”max_scale =“0.0”scale_mode =“RATIO “/&gt; &lt;theme name =”UTFGRID_THEME_DEMO_HIGHWAYS“min_scale =”4.5E7“max_scale =”0.0“scale_mode =”RATIO“/&gt; &lt;theme name =”UTFGRID_THEME_DEMO_CITIES“min_scale =”7500000.0“max_scale =”0.0“scale_mode =”RATIO“ /&gt; &lt;/ map_definition&gt;'）; - 将启用UTFGrid的切片图层插入到user_sdo_cached_maps值中（'UTFGRID_TL'，'a utfgrid'，''，'YES'，'YES'，'&lt;map_tile_layer name =“UTFGRID_TL”image_format =“PNG”http_header_expires =“168.0 “concurrent_fetching_threads =”3“fetch_larger_tiles =”false“persistent_tiles =”true“utfgrid =”true“utfgrid_resolution =”8“&gt; &lt;internal_map_source data_source =”mvdemo“base_map =”UTFGRID_BASEMAP“bgcolor =”＃dddddd“out_of_bounds_color =”＃eeddff “/&gt; &lt;tile_storage root_path =”/ temp“xyz_storage_scheme =”true“/&gt; &lt;coordinate_system srid =”8307“minX =” -  180.0“maxX =”180.0“minY =” -  90.0“maxY =”90.0“/&gt; &lt; tile_image width =“256”height =“256”/&gt; &lt;tile_dpi value =“90.7142857”/&gt; &lt;tile_meters_per_unit value =“111319.49079327358”/&gt; &lt;zoom_levels levels =“19”min_scale =“2132.729583849784”max_scale =“559082264.0287178”&gt; &lt; / zoom_levels&gt; &lt;/ map_tile_layer&gt;'，'UTFGRID_BASEMAP'，''）;承诺;</pre></li>
                              <li>
                                 <p>请求地图图像及其UTFGrid对象。</p>
                                 <p>在实际应用程序中，请求地图图像切片及其伴随UTFGrid JSON文件由地图可视化工具HTML5 API处理;但是，为了便于说明，此处显示了两个带有硬编码请求的子步骤。</p>
                                 <ol type="a">
                                    <li>
                                       <p>从服务器请求图像磁贴。例如：</p>
                                       <p><code class="codeph">HTTP：//本地主机：8080 /的MapViewer / mcserver请求= gettile＆格式= PNG＆缩放级别= 8＆mapcache = MVDEMO.UTFGRID_TL＆MX = 77＆我= 94</code></p>
                                       <p>服务器的响应：</p>
                                       <div class="figure" id="GUID-FFBDBD49-AB91-470C-9182-31D6D19DFFC0__GUID-31F0EE31-1F94-4C8F-858C-F3A1FC4FFCC4"><img src="img/utfgrid_example_image_tile.jpg" alt="下面是utfgrid_example_image_tile.jpg的描述" title="下面是utfgrid_example_image_tile.jpg的描述" longdesc="img_text/utfgrid_example_image_tile.html"><br><a href="img_text/utfgrid_example_image_tile.html">说明utfgrid_example_image_tile.jpg的描述</a></div>
                                       <!-- class="figure" -->
                                    </li>
                                    <li>
                                       <p>从服务器请求图像磁贴的伴随UTFGrid。例如：</p>
                                       <p><code class="codeph">HTTP：//本地主机：8080 /的MapViewer / mcserver请求= getutfgrid＆格式= JSON＆缩放级别= 8＆mapcache = MVDEMO.UTFGRID_TL＆MX = 77＆我= 94</code></p>
                                       <p>服务器的响应：</p><pre class="oac_no_warn" dir="ltr">{“UTFGRID_THEME_DEMO_STATES”：{“keys”：[“1”，“2”，“3”]，“data”：{“1”：{“State”：“New Hampshire”，“Abrv。”：“NH “，”“人口”：“1109252”}，“2”：{“国家”：“缅因州”，“Abrv。”：“我”，“人口”：“1227928”}，“3”：{“国家” ：“马萨诸塞州”，“Abrv。”：“MA”，“人口”：“6016424”}}，“网格”：[“!!!!!!!!!!!!!!!!!###############“，”!!!!!!!!!!!!!!!!!###############“，”!!!!!!!!!!!!!!!!!##############“，”!!!!!!!!!!!!!!!!!###############“，”!!!!!!!!!!!!!!!!!##############“，”!!!!!!!!!!!!!!!!!#############“，”!!!!!!!!!!!!!!!!!!#########“，”!!!!!!!!!!!!!!!!!!!########“，”!!!!!!!!!!!!!!!!!!!!#######“，”!!!!!!!!!!!!!!!!!!!!######“，”!!!!!!!!!!!!!!!!!!!!######“，”!!!!!!!!!!!!!!!!!!!!!!###“，”!!!!!!!!!!!!!!!!!!!!!!!＃“，”!!!!!!!!!!!!!!!!!!!!!!!“，”!!!!!!!!!!!!!!!!!!!!!!“，”!!!!!!!!!!!!!!!!!!!!!!“，”!!!!!!!!!!!!!!!!!$$！“，”!!!!!!!!!!!!!!!!$$$$$$“，”!!!!!!!!!!!!$$$$$$$$$“，”!!!!!!!!!!!$$$$$$$$$$$“，”$$$$$ !!!!$$$$$$$$$$$$$ $$“，”$$$$$$$$$$$$$$$$$$$$$$$$$“，”$$ $$$$$$$$$$$$$$$$$$$$$$“，”$$$$$$$$$$$$$$$$$$$$$ $$“，”$$$$$$$$$$$$$$$$$$$$“，”$$$$$$$$$$$$$$$$$$$$“ ，“$$$$$$$$$$$$$$$$$$$”，“$$$$$$$$$$$$$$$$$$”，“$$$$$” $$$$$$$$$$$$$“，”$$$$$$$$$$$$$$$$$$$$“，”$$$$$$$$$$ $$$$$$$$$$$“，”$$$$$$$$$$$$$$$$$$$$$$“]}，”UTFGRID_THEME_DEMO_HIGHWAYS“：{”keys“： [“1”，“2”，“3”，“4”，“5”，“6”，“7”，“8”，“9”]，“数据”：{“1”：{“Highway” “：”I 93“，”No。“：”93“}，”2“：{”Highway“：”I 95“，”No。“：”95“}，”3“：{”Highway“： “我89”，“不。”：“89”}，“4”：{“公路”：“我293”，“不。”：“293”}，“5”：{“公路”：“我495“，”No。“：”495“}，”6“：{”Highway“：”I 190“，”No。“：”190“}，”7“：{”Highway“：”88“， “不。”：“99”}，“8”：{“Highway”：“I 290”，“No。”：“290”}，“9”：{“Highway”：“I 90”，“No 。“：”90“}}，”网格“：[”！##“，”！###“，”!!##“，”!!##“，”！##“，”！##“，”!!##“，”!!##“，”$ !!＃“，”$$$$！##“，”!!###“，”！###“，”％！##“，”％!!##“，”%%！＃“，”!!##“，”!!##“，”!!&amp;&amp;&amp;&amp;＃“，”!!&amp;&amp;&amp; ##“，”!!＆＃“，”！&amp;&amp; ##“，”&amp;&amp;&amp;！##“，”&amp;&amp;&amp;&amp;！##“，”&amp;&amp;&amp;&amp; !!##“，”'&amp;&amp;&amp; ##！###“，”'&amp;&amp;&amp;＃（（!!“，”&amp;&amp;＃（!!“，”&amp;&amp;（!!!“，”）））和*********！“，”）和***** ##！“，”***** ##！“，”*** &amp;&amp; ## !!!“]}，”UTFGRID_THEME_DEMO_CITIES“：{”keys“：[”1“，”2“]，”data“：{”1“：{”City“：”Lowell“，”Population“：”103439“}， “2”：{“City”：“Boston”，“Population”：“574283”}}，“grid”：[“”，“”，“”，“”，“”，“”，“”，“ “，”“，”“，”“，”“，”“，”“，”“，”“，”“，”“，”“，”“，”“，”!!“，”“，”“，”“，”“，”“，”“，”##“，”“，”“，”“]}，”分辨率“：”8“，”行“：”32 ”， “列”： “32”}</pre><p>前面的响应显示了一个UTFGrid对象，该对象包含主题<code class="codeph">UTFGRID_THEME_DEMO_STATES</code> ， <code class="codeph">UTFGRID_THEME_DEMO_HIGHWAYS</code>和<code class="codeph">UTFGRID_THEME_DEMO_CITIES</code> 。 （主题<code class="codeph">UTFGRID_THEME_DEMO_COUNTIES</code>未定义<code class="codeph">&lt;hidden_info&gt;</code>元素，因此响应中未列出该主题。）
                                       </p>
                                    </li>
                                 </ol>
                              </li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="map-visualization-servers.html#GUID-9576FC06-D773-4C47-8F5F-DF3AD4567206">地图图块的UTFGrid：包括有关要素的文本信息</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div><a id="JIMPV9810"></a><a id="JIMPV9811"></a><a id="JIMPV9809"></a><div class="props_rev_3"><a id="GUID-D58CA71F-B70B-4FFE-964A-CEE2859C7FC6" name="GUID-D58CA71F-B70B-4FFE-964A-CEE2859C7FC6"></a><h4 id="JIMPV-GUID-D58CA71F-B70B-4FFE-964A-CEE2859C7FC6" class="sect4"><span class="enumeration_section">3.2.5</span>外部映射源适配器</h4>
                  <div>
                     <p>外部地图源适配器是地图图块服务器和外部地图服务提供者之间的接口。当需要从外部地图服务提供者提取地图图像切片时，地图切片服务器会调用适配器，其中包含有关切片的缩放级别，大小和位置的信息。然后，适配器构造特定于提供者的请求，将请求发送到外部地图服务提供者，并将得到的图像切片返回到地图切片服务器。</p>
                     <p>外部映射源适配器是Java类，必须扩展抽象Java类<code class="codeph">oracle.mapviewer.share.mapcache.MapSourceAdapter</code> ，定义如下：</p><pre class="oac_no_warn" dir="ltr">public abstract class MapSourceAdapter {public abstract String getMapTileRequest（TileDefinition tile）; public byte [] getTileImageBytes（TileDefinition tile）; public Properties getProperties（）; }</pre><p>扩展此类的适配器必须实现以下方法：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">public String getMapTileRequest（TileDefinition tile）</code></p>
                           <p>此方法应实现构造HTTP请求字符串的逻辑，该字符串可以发送到地图服务提供程序以获取地图图像切片。例如，如果地图图块的URL是<code class="codeph">http://myhost/mymapserver?par1=v1&amp;par2=v2&amp;par3=v3</code> ，则此方法返回的HTTP请求字符串应为<code class="codeph">par1_v1&amp;par2=v2&amp;par3=v3</code> 。
                           </p>
                           <p>当地图图块服务器找不到特定的地图图块时，它会调用<code class="codeph">getTileImageBytes</code>方法来获取图块图像的二进制数据，并且该方法在获取图块之前调用<code class="codeph">getMapTileRequest</code>方法来构造地图图块请求。<code class="codeph">getMapTileRequest</code>方法接受一个参数： <code class="codeph">TileDefinition</code>对象，它指定所请求图块的缩放级别，边界框，图像大小和图像格式。此方法返回HTTP请求字符串。
                           </p>
                        </li>
                     </ul>
                     <p>地图源适配器还继承了<code class="codeph">MapSourceAdapter</code>类中实现的所有方法。其中，以下方法比其他方法更重要：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">public byte [] getTileImageBytes（TileDefinition tile）</code></p>
                           <p>此方法从外部地图服务提供程序获取实际二进制地图图块图像数据。此方法已实施。它调用抽象方法<code class="codeph">getMapTileRequest</code>来构造地图块请求，并将请求发送到外部地图服务提供者。如果无法通过发送HTTP请求获取地图图块，则可以覆盖此方法以实现相应的逻辑以从地图源中获取图像图块。此方法采用一个参数： <code class="codeph">TileDefinition</code>对象，该对象指定所请求图块的缩放级别，边界框，图像大小和图像格式。此方法返回以地图图块层配置设置中指定的图像格式编码的二进制图块图像数据。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">public属性getProperties（）</code></p>
                           <p>此方法返回在地图瓦片层配置设置定义的提供者特定的参数中说明<a href="map-visualization-servers.html#GUID-5CF7DC08-0B32-4C72-B9D0-F3762A7E6171">的地图图块层配置</a> 。
                           </p>
                        </li>
                     </ul>
                     <p><code class="codeph">MapSourceAdapter</code>和<code class="codeph">TileDefinition</code>类打包在<code class="codeph">mvclient.jar</code> ，可以在<span class="italic"><code class="codeph">$MAPVIEWER_HOME</code></span> <code class="codeph">/web/WEB/lib</code>目录下找到。
                     </p>
                     <p><a href="map-visualization-servers.html#GUID-D58CA71F-B70B-4FFE-964A-CEE2859C7FC6__BABGCHJB">例3-5</a>显示了一个外部地图源适配器。
                     </p>
                     <div class="example" id="GUID-D58CA71F-B70B-4FFE-964A-CEE2859C7FC6__BABGCHJB">
                        <p class="titleinexample">示例3-5外部映射源适配器</p><pre class="oac_no_warn" dir="ltr">/ ** *这是一个示例地图源适配器，可用于从地图可视化工具实例中获取地图*图块。* / package mcsadapter; import java.awt。尺寸; import java.net。网址; import java.util。性能; import oracle.lbs.mapclient。MapViewer的; import oracle.lbs.mapcommon。MapResponse; import oracle.mapviewer.share.mapcache。*; / ** *映射源适配器必须扩展class * oracle.lbs.mapcache.cache。MapSourceAdapter。* / public class MVAdapter extends MapSourceAdapter {/ ** *获取要发送到map *服务提供者URL的地图图块请求字符串。 * @param tile tile定义* @return请求字符串* / public String getMapTileRequest（TileDefinition tile）{//获取地图源指定参数属性props = this.getProperties（）; String dataSource = props.getProperty（“data_source”）; String baseMap = props.getProperty（“base_map”）; //使用oracle.lbs.mapclient。MapViewer构造请求字符串MapViewer mv = new MapViewer（this.getMapServiceURL（））; mv.setDataSourceName（数据源）; mv.setBaseMapName（为baseMap）; mv.setDeviceSize（new Dimension（tile.getImageWidth（），tile.getImageHeight（）））; mv.setCenterAndSize（tile.getBoundingBox（）。getCenterX（），tile.getBoundingBox（）。getCenterY（），tile.getBoundingBox（）。getHeight（））; int format = MapResponse。FORMAT_PNG_STREAM; String req = null; switch（tile.getImageFormat（））{case TileDefinition。FORMAT_GIF：mv.setImageFormat（MapResponse。FORMAT_GIF_URL）; req = mv.getMapRequest（）。toXMLString（）。replaceFirst（“format = \”GIF_URL \“”，“format = \”GIF_STREAM \“”）;休息case TileDefinition。FORMAT_PNG：mv.setImageFormat（MapResponse。FORMAT_PNG_URL）; req = mv.getMapRequest（）。toXMLString（）。replaceFirst（“format = \”PNG_URL \“”，“format = \”PNG_STREAM \“”）;休息case TileDefinition。FORMAT_JPEG：mv.setImageFormat（MapResponse。FORMAT_JPEG_URL）; req = mv.getMapRequest（）。toXMLString（）。replaceFirst（“format = \”JPEG_URL \“”，“format = \”JPEG_STREAM \“”）;休息} byte [] reqStr = null; try {reqStr = req.getBytes（“UTF8”）; } catch（Exception e）{} //返回请求字符串。return“xml_request =”+ new String（reqStr）; }}</pre><p><a href="map-visualization-servers.html#GUID-D58CA71F-B70B-4FFE-964A-CEE2859C7FC6__BABDAHAG">示例3-6</a>显示了<code class="codeph">MapSourceAdapter.getTileImageBytes</code>方法的实现。
                        </p>
                     </div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-D58CA71F-B70B-4FFE-964A-CEE2859C7FC6__BABDAHAG">
                        <p class="titleinexample">示例3-6 MapSourceAdapter.getTileImageBytes实现</p><pre class="oac_no_warn" dir="ltr">/ ** *通过向地图服务提供商发送HTTP地图图块请求，从外部地图服务提供商获取地图图像图块，并返回二进制图块图像数据。您可以重写此方法，以便*适配器可以从外部地图服务提供程序*获取不完全接受HTTP请求的切片。* @param平铺图块定义* @return二进制图块图像数据。* @throws Exception * / public byte [] getTileImageBytes（TileDefinition tile）throws Exception {//构造请求字符串String request = getMapTileRequest（tile）; if（request == null）{throw new Exception（“地图源适配器中的空地图平铺请求字符串！“）;} //设置代理设置代理服务器代理= null; / *如果proxyHost为”NONE“，请求将直接发送到*外部服务器。如果proxyHost是有效主机，则该主机将*用作代理服务器。如果省略的proxyHost为空，则mapViewerConfig.xml中的全局代理设置将生效。* / boolean noProxy =“NONE”.equalsIgnoreCase（getProxyHost（））;如果（getProxyHost（）！= null &amp;&amp;！noProxy）{SocketAddress addr = new InetSocketAddress（proxyHost，proxyPort）; proxy = new Proxy（代理。类型。HTTP，addr）; } //发送请求并获取tile图像二进制PrintWriter wr = null; BufferedInputStream bis = null; try {String urlStr = mapServiceURL; if（“GET”.equalsIgnoreCase（httpMethod））urlStr = mapServiceURL +“？“+ request; log.finest（”http“+ httpMethod +”：“+ urlStr）; URL url = new URL（urlStr）; //根据当前代理设置打开URL连接URLConnection conn = proxy！= NULL？url.openConnection（proxy）:( noProxy？url.openConnection（代理。NO_PROXY）：url.openConnection（））; conn.setConnectTimeout（超时）; if（“GET”.equalsIgnoreCase（getHTTPMethod（）））conn.connect（）; else {conn.setDoOutput（true）; wr = new PrintWriter（conn.getOutputStream（））; wr.print（请求）; wr.flush（）; wr.close（）; wr = null; } bis = new BufferedInputStream（conn.getInputStream（））; byte [] result = toBytes（bis）; bis.close（）; bis = null;返回结果; } catch（Exception ioe）{throw new Exception（“无法获取外部地图图块。”，ioe）; } finally {try {if（bis！）= null）{bis.close（）; bis = null;如果（wr！= null）{wr.close（）; wr = null; catch（IOException ioee）{throw ioee; }}}</pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="map-visualization-servers.html#GUID-7E88B130-FB2F-47D1-A8B2-909CFB1454AC" title="地图图块服务器是一种地图图像缓存引擎，用于获取，缓存和提供预生成的固定大小的地图图像图块。">映射平铺服务器</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
         </div>
      </article>
   </body>
</html>