<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="This overview describes: (1) data types for JSON columns, (2) LOB storage considerations for JSON data, and (3) ensuring that JSON columns contain well-formed JSON data."></meta>
      <meta name="description" content="This overview describes: (1) data types for JSON columns, (2) LOB storage considerations for JSON data, and (3) ensuring that JSON columns contain well-formed JSON data."></meta>
      <title>存储和管理JSON数据概述</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="JSON Developer&#39;s Guide"></meta>
      <meta property="og:description" content="This overview describes: (1) data types for JSON columns, (2) LOB storage considerations for JSON data, and (3) ensuring that JSON columns contain well-formed JSON data."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="JSON Developer&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="json-developers-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-02-22T10:58:31-08:00"></meta>
      <meta name="dcterms.title" content="JSON Developer&#39;s Guide"></meta>
      <meta name="dcterms.dateCopyrighted" content="2015, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96227-03"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="store-and-manage-json-data.html" title="Previous" type="text/html"></link>
      <link rel="next" href="creating-a-table-with-a-json-column.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="ADJSN"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="store-and-manage-json-data.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="creating-a-table-with-a-json-column.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">JSON开发人员指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="store-and-manage-json-data.html" property="item" typeof="WebPage"><span property="name">存储和管理JSON数据</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">存储和管理JSON数据概述</li>
            </ol>
            <a id="GUID-26AB85D2-3277-451B-BFAA-9DD45355FCC7" name="GUID-26AB85D2-3277-451B-BFAA-9DD45355FCC7"></a>
            
            <h2 id="ADJSN-GUID-26AB85D2-3277-451B-BFAA-9DD45355FCC7" class="sect2"><span class="enumeration_chapter">3</span>存储和管理JSON数据概述</h2>
         </header>
         <div class="ind"><script type="text/javascript">window.name='overview-of-storage-and-management-of-JSON-data'</script><script type="text/javascript">
    function footdisplay(footnum,footnote) {
    var msg = window.open('about:blank', 'NewWindow' + footnum,
        'directories=no,height=100,location=no,menubar=no,resizable=yes,' +
        'scrollbars=yes,status=no,toolbar=no,width=598');
    msg.document.open('text/html');
    msg.document.write('<!DOCTYPE html ');
    msg.document.write('PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" ');
    msg.document.write('"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">'); 
    msg.document.write('<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us" dir="ltr"><head><title>');
   
    msg.document.write('Footnote&nbsp; ' + footnum);
    msg.document.write('<\/title><meta http-equiv="Content-Type" ');
    msg.document.write('content="text/html; charset=utf-8" />');
    msg.document.write('<meta http-equiv="Content-Script-Type" ');
    msg.document.write('content="text/javascript" />');
    msg.document.write('<style type="text/css"> <![CDATA[ ');
    msg.document.write('h1 {text-align: center; font-size: 14pt;}');
    msg.document.write('fieldset {border: none;}');
    msg.document.write('form {text-align: center;}');
    msg.document.write(' ]]u003e </style>');
    msg.document.write('<\/head><body><div id="footnote"><h1>Footnote&nbsp; ' + footnum + '<\/h1><p>');
    msg.document.write(footnote);
    msg.document.write('<\/p><form action="" method="post"><fieldset>');
    msg.document.write('<input type="button" value="OK" ');
    msg.document.write('onclick="window.close();" />');
    msg.document.write('<\/fieldset><\/form><\/div><\/body><\/html>');
    msg.document.close();
    setTimeout(function() {
        var height = msg.document.getElementById('footnote').offsetHeight;
        msg.resizeTo(598, height + 100);
    }
    , 100);
    msg.focus();
}
            </script><noscript>
               <p>此页面上的脚本内容仅用于导航目的，不会以任何方式更改内容。</p>
            </noscript>
            <div>
               <p>此概述描述：（1）JSON列的数据类型，（2）JSON数据的LOB存储注意事项，以及（3）确保JSON列包含格式良好的JSON数据。</p>
               <div class="section">
                  <p class="subhead1" id="GUID-26AB85D2-3277-451B-BFAA-9DD45355FCC7__GUID-6D940175-4896-4583-AAA2-8FBD9F30154C">JSON列的数据类型</p>
                  <p>您可以使用数据类型为<code class="codeph">VARCHAR2</code> ， <code class="codeph">CLOB</code>或<code class="codeph">BLOB</code>列将JSON数据存储在Oracle数据库中。选择使用的方式通常取决于您需要管理的JSON文档的大小：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>如果您确定最大的JSON文档不超过4000字节（或字符） <a id="GUID-26AB85D2-3277-451B-BFAA-9DD45355FCC7__WHETHERTHELIMITISEXPRESSEDINBYTESOR-14243E7F" name="GUID-26AB85D2-3277-451B-BFAA-9DD45355FCC7__WHETHERTHELIMITISEXPRESSEDINBYTESOR-14243E7F" href="#GUID-26AB85D2-3277-451B-BFAA-9DD45355FCC7__WHETHERTHELIMITISEXPRESSEDINBYTESOR-14243E7F" whether="" the="" limit="" is="" expressed="" in="" bytes="" or="" characters="" determined="" by="" session="" parameter="" nls_length_semantics=")" ="" onclick="footdisplay(1, "><sup>Foot 1</sup></a> <a id="fnsrc_d6022e51" name="fnsrc_d6022e51" href="#fnsrc_d6022e51" whether="" the="" limit="" is="" expressed="" in="" bytes="" or="" characters="" determined="" by="" session="" parameter="" nls_length_semantics=")" ="" onclick="footdisplay(1, "><sup>Footref 1</sup></a> ，请使用<code class="codeph">VARCHAR2(4000)</code> 。
                        </p>
                        <p>如果使用Oracle Exadata，则选择<code class="codeph">VARCHAR2(4000)</code>可以通过将某些JSON操作的执行推送到Exadata存储单元来提高性能，从而提高性能。
                        </p>
                     </li>
                     <li>
                        <p>如果您知道某些JSON文档大于4000字节（或字符），并且您确定没有文档超过32767字节（或字符） <a id="fnsrc_d6022e65" name="fnsrc_d6022e65" href="#fnsrc_d6022e65" whether="" the="" limit="" is="" expressed="" in="" bytes="" or="" characters="" determined="" by="" session="" parameter="" nls_length_semantics=")" ="" onclick="footdisplay(1, "><sup>Footref 1，</sup></a>请使用<code class="codeph">VARCHAR2(32767)</code> 。
                        </p>
                        <p>使用<code class="codeph">VARCHAR2(32767)</code> ，文档的第一个大约3.5K字节（或字符）作为表行的一部分<span class="italic">存储</span>在行中。这意味着使用<code class="codeph">VARCHAR2(32767)</code>而不是<code class="codeph">VARCHAR2(4000)</code>的额外成本仅适用于那些大于约3.5K的文档。如果您的大多数文档都小于此，那么您可能会发现使用<code class="codeph">VARCHAR2(4000)</code>性能差异很小。
                        </p>
                        <p>如果使用Oracle Exadata，则会对存储在行中的所有文档启用下推。</p>
                     </li>
                     <li>
                        <p>如果您知道某些JSON文档大于32767字节（或字符） <a id="fnsrc_d6022e96" name="fnsrc_d6022e96" href="#fnsrc_d6022e96" whether="" the="" limit="" is="" expressed="" in="" bytes="" or="" characters="" determined="" by="" session="" parameter="" nls_length_semantics=")" ="" onclick="footdisplay(1, "><sup>Footref 1，</sup></a>请使用<code class="codeph">BLOB</code> （二进制大对象）或<code class="codeph">CLOB</code> （字符大对象）存储。
                        </p>
                     </li>
                  </ul>
                  <p>使用<span class="italic">标准SQL数据类型</span>将JSON数据存储在数据库中这一事实意味着您可以操纵JSON数据，就像操作这些类型的任何其他数据一样。使用标准数据类型存储JSON数据允许Oracle数据库的所有功能（如高级复制）与包含JSON文档的表一起使用。
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-26AB85D2-3277-451B-BFAA-9DD45355FCC7__GUID-F7610112-4BD7-457D-8B83-0C9FE7F3DABE">为LSON数据使用LOB存储时的注意事项</p>
                  <p>Oracle建议您使用<code class="codeph">BLOB</code> ，而不是<code class="codeph">CLOB</code>存储。
                  </p>
                  <p>如果数据库字符集是AL32UTF8的Oracle建议值，则这尤其重要。在AL32UTF8数据库中， <code class="codeph">CLOB</code>实例使用UCS2字符集存储，这意味着每个字符需要两个字节。如果文档的大部分内容由使用字符集AL32UTF8中的单个字节表示的字符组成，则这会使文档所需的存储空间翻倍。
                  </p>
                  <p>即使在数据库字符集不是AL32UTF8的情况下，选择<code class="codeph">BLOB</code> over <code class="codeph">CLOB</code>存储也具有避免在存储JSON文档时需要进行字符集转换的优点（请参阅<a href="json-character-sets-and-encoding.html#GUID-2BD7911A-0201-4BEC-906E-D174267B438A" title="JSON数据始终使用Unicode字符集。在这方面，JSON数据比XML数据更易于使用。这是JSON数据交换格式（RFC 4627）的重要组成部分。对于Oracle数据库处理的JSON数据，将自动执行任何所需的字符集转换。">JSON数据的字符集和字符编码</a> ）。
                  </p>
                  <p>使用大对象（LOB）时，Oracle建议您执行以下操作：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>在<code class="codeph">CREATE TABLE</code>语句中使用子句<code class="codeph"><span class="bold">LOB (</span> <span class="codeinlineitalic">COLUMN_NAME</span> <span class="bold">) STORE AS (CACHE)</span></code> ，以确保使用数据库缓冲区高速缓存对JSON文档的读取操作进行优化。
                        </p>
                     </li>
                     <li>
                        <p>使用SecureFiles LOB。还要考虑使用Oracle Advanced Compression，以减少JSON数据所需的存储空间。如果使用压缩，则Oracle建议选择“中压缩”，这样可以节省空间并提高性能。</p>
                     </li>
                  </ul>
                  <p>无论数据是存储为<code class="codeph">BLOB</code>还是<code class="codeph">CLOB</code> ，SQL / JSON函数和条件都可以使用JSON数据而无需任何特殊注意事项。从应用程序开发的角度来看，使用<code class="codeph">BLOB</code>内容的API调用几乎与使用<code class="codeph">CLOB</code>内容的API调用相同。
                  </p>
                  <p>选择<code class="codeph">BLOB</code>存储而不是<code class="codeph">CLOB</code> （对于JSON或任何其他类型的数据）的缺点是，使用SQL * Plus等命令行工具处理<code class="codeph">BLOB</code>内容有时会更加困难。例如：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>从<code class="codeph">BLOB</code>列中选择数据时，如果要将其视为可打印文本，则必须使用SQL函数<code class="codeph">to_clob</code> 。
                        </p>
                     </li>
                     <li>
                        <p>在<code class="codeph">BLOB</code>列上执行插入或更新操作时，必须使用SQL函数<code class="codeph">rawtohex</code>将字符串显式转换为<code class="codeph">BLOB</code>格式。<a id="fn_2" name="fn_2" href="#fn_2" value="" data="" the="" return="" of="" sql="" function="" rawtohex="" is="" limited="" to="" 32767="" bytes.="" truncated="" remove="" any="" converted="" beyond="" this="" length=")" ="" onclick="footdisplay(2, "><sup>脚2</sup></a></p>
                     </li>
                  </ul>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-26AB85D2-3277-451B-BFAA-9DD45355FCC7__GUID-918CD439-67BB-45C0-958D-CE1DED1958D9">确保JSON列包含格式良好的JSON数据</p>
                  <p>您可以使用SQL / JSON条件<code class="codeph">is json</code>来检查某些JSON数据是否格式正确。Oracle强烈建议您将<code class="codeph">is json</code>检查约束应用于任何JSON列，除非您希望某些行包含除格式良好的JSON数据之外的其他内容。
                  </p>
                  <p>解析JSON的开销是这样的，评估条件不应该对插入和更新性能产生重大影响，省略约束意味着您不能使用简单的点符号语法来查询JSON数据。</p>
                  <p>构成格式良好的JSON数据的构成是一个灰色区域。实际上，JSON数据通常具有一些严格遵循标准定义的特征。您可以控制要求给定的JSON数据列符合的语法：标准定义（严格语法）或常见实践中的类似JavaScript的语法（松散语法）。Oracle数据库的默认SQL / JSON语法不<span class="italic">严格</span> 。使用哪种语法由条件<code class="codeph">is json</code>控制。将<code class="codeph">is json</code>检查约束应用于JSON列，因此默认情况下允许使用宽松的JSON语法。
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <div class="infoboxnotealso" id="GUID-26AB85D2-3277-451B-BFAA-9DD45355FCC7__GUID-09D2953A-18A2-4A38-BA81-2576385AC3D0">
                     <p class="notep1">也可以看看：</p>
                     <p>有关SQL函数<code class="codeph">rawtohex</code>信息，请参阅<a href="../sqlrf/RAWTOHEX.html#SQLRF-GUID-F86E3B5B-7FEE-47FD-A0C2-2FC55DC21C9E" target="_blank"><span><cite>Oracle数据库SQL语言参考</cite></span></a></p>
                  </div>
               </div>
               <!-- class="section" -->
            </div>
            <div>
               <div class="relinfo">
                  <p><strong>相关话题</strong></p>
                  <ul>
                     <li><a href="json-character-sets-and-encoding.html#GUID-2BD7911A-0201-4BEC-906E-D174267B438A" title="JSON数据始终使用Unicode字符集。在这方面，JSON数据比XML数据更易于使用。这是JSON数据交换格式（RFC 4627）的重要组成部分。对于Oracle数据库处理的JSON数据，将自动执行任何所需的字符集转换。">JSON数据的字符集和字符编码</a></li>
                     <li><a href="overview-of-inserting-updating-loading-JSON-data.html#GUID-94E37619-C242-44F0-B1C3-9A63859AD0C5" title="您可以使用标准数据库API在Oracle数据库中插入或更新JSON数据。您可以通过创建将其公开给数据库的外部表，直接处理文件系统文件中包含的JSON数据。您可以使用JSON Merge Patch更新JSON文档。">插入，更新和加载JSON数据概述</a></li>
                     <li><a href="simple-dot-notation-access-to-json-data.html#GUID-7249417B-A337-4854-8040-192D5CEFD576" title="点符号设计用于简单，通用和常见用例。使用点符号语法的JSON数据查询尽可能返回JSON值。">简单的点表示法访问JSON数据</a></li>
                  </ul>
               </div>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>父主题：</strong> <a href="store-and-manage-json-data.html#GUID-F5FFFBC6-6672-40D6-A0DE-D395570AC135" title="本部分包括在数据库表中创建JSON列，对这些表进行分区，使用Oracle GoldenGate复制它们以及对JSON数据进行字符集编码。它涵盖了使用SQL / JSON条件是json作为检查约束，以确保列中的数据是格式良好的JSON数据。">存储和管理JSON数据</a></p>
                  </div>
               </div>
            </div>
            
            <hr><br><p style="text-decoration:underline">脚注图例</p>脚注1：限制是以字节还是字符表示，由会话参数<code class="codeph">NLS_LENGTH_SEMANTICS</code>决定。<br>脚注2：SQL函数<code class="codeph">rawtohex</code>的返回值限制为32767字节。该值被截断以删除超出此长度的任何转换数据。<br></div>
      </article>
   </body>
</html>