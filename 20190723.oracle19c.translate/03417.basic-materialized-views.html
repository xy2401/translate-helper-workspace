<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>基本物化观点</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Data Warehousing Guide"></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Data Warehousing Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="database-data-warehousing-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-09T00:20:13-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2001, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96243-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="part-optimizing-dw.html" title="Previous" type="text/html"></link>
      <link rel="next" href="advanced-materialized-views.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database Data Warehousing Guide"></meta>
    <meta name="dcterms.isVersionOf" content="DWHSG"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="part-optimizing-dw.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="advanced-materialized-views.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">数据仓库指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="part-optimizing-dw.html" property="item" typeof="WebPage"><span property="name">优化数据仓库</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">基本物化观点</li>
            </ol>
            <a id="GUID-A7AE8E5D-68A5-4519-81EB-252EAAF0ADFF" name="GUID-A7AE8E5D-68A5-4519-81EB-252EAAF0ADFF"></a>
            
            <h2 id="DWHSG-GUID-A7AE8E5D-68A5-4519-81EB-252EAAF0ADFF" class="sect2"><span class="enumeration_chapter">5</span>基本物化视图</h2>
         </header>
         <div class="ind">
            <div>
               <p>本章介绍了物化视图的使用。它包含以下主题：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="basic-materialized-views.html#GUID-FC9E665B-8AB2-4B64-AB8A-FAA732511839">物化视图的数据仓库概述</a></p>
                  </li>
                  <li>
                     <p><a href="basic-materialized-views.html#GUID-63E162FE-8957-4C1D-9494-041A8B2B7917" title="如果物化视图仅包含连接，则每个表的ROWID列（以及在FROM列表中多次出现的表的每个实例）必须存在于实例化视图的SELECT列表中。">物化视图的类型</a></p>
                  </li>
                  <li>
                     <p><a href="basic-materialized-views.html#GUID-2FA7BA5F-8222-4DEE-87B3-54352CE95F52" title="可以使用CREATE MATERIALIZED VIEW语句或使用Enterprise Manager创建实例化视图。">创建物化视图</a></p>
                  </li>
                  <li>
                     <p><a href="basic-materialized-views.html#GUID-4BCA1300-C03E-4C24-AD19-50EB9BBA8806">创建物化视图日志</a></p>
                  </li>
                  <li>
                     <p><a href="basic-materialized-views.html#GUID-42B64F99-7391-48B8-B37D-1B486DC29645" title="基于近似查询的物化视图使用SQL函数，该函数在其定义查询中返回近似函数。">基于近似查询创建物化视图</a></p>
                  </li>
                  <li>
                     <p><a href="basic-materialized-views.html#GUID-4DE39B8B-8452-4581-A841-6AF77019986D">注册现有的物化视图</a></p>
                  </li>
                  <li>
                     <p><a href="basic-materialized-views.html#GUID-681BB72C-13B2-42AF-BD59-F4DFE8685F83">选择物化视图的索引</a></p>
                  </li>
                  <li>
                     <p><a href="basic-materialized-views.html#GUID-2932186A-CA03-47B7-A11A-FF30BD62AB57">删除物化视图</a></p>
                  </li>
                  <li>
                     <p><a href="basic-materialized-views.html#GUID-651B08EB-4D32-4A93-A260-A965C40AE136">分析物化视图功能</a></p>
                  </li>
               </ul>
            </div><a id="DWHSG0081"></a><div class="props_rev_3"><a id="GUID-FC9E665B-8AB2-4B64-AB8A-FAA732511839" name="GUID-FC9E665B-8AB2-4B64-AB8A-FAA732511839"></a><h3 id="DWHSG-GUID-FC9E665B-8AB2-4B64-AB8A-FAA732511839" class="sect3"><span class="enumeration_section">5.1</span>具有物化视图的数据仓库概述</h3>
               <div>
                  <p><a id="d15276e112" class="indexterm-anchor"></a><a id="d15276e114" class="indexterm-anchor"></a><a id="d15276e118" class="indexterm-anchor"></a>通常，数据每月，每周或每天从一个或多个在线事务处理（OLTP）数据库流入数据仓库。数据通常在a中处理<a id="d15276e123" class="indexterm-anchor"></a>在添加到数据仓库之前<a href="glossary.html#GUID-534190F8-A767-42E3-866C-3166B300D21B"><span class="xrefglossterm">暂存文件</span></a> 。数据仓库的大小通常在数百GB到几TB之间。通常，绝大多数数据都存储在一些非常大的<a href="glossary.html#GUID-5E1E8221-92AE-47F6-BB30-5F2D7BCD68F5"><span class="xrefglossterm">事实表中</span></a> 。
                  </p>
                  <p>数据仓库中用于提高性能的一种技术是创建摘要。摘要是特殊类型的聚合视图，它通过在执行之前预先计算昂贵的连接和聚合操作并将结果存储在数据库的表中来改善查询执行时间。例如，您可以创建汇总表以包含按地区和按产品划分的销售总额。</p>
                  <p>本书和有关数据仓库的文献中提及的摘要或汇总是在Oracle数据库中使用名为的模式对象创建的。 <a id="d15276e140" class="indexterm-anchor"></a> <a href="glossary.html#GUID-AC1E7D15-7178-4C7E-89CA-809D13AB2513"><span class="xrefglossterm">物化视图</span></a> 。物化视图可以执行许多角色，例如提高查询性能或提供复制数据。
                  </p>
                  <p>数据库管理员创建一个或多个物化视图，这相当于摘要。最终用户在详细数据级别查询表和视图。Oracle服务器中的<a href="glossary.html#GUID-BD33929F-FA4E-4E15-BAA7-2E62E2CF6B7B"><span class="xrefglossterm">查询重写</span></a>机制会自动重写SQL查询以使用摘要表。此机制减少了从查询返回结果的响应时间。数据仓库中的物化视图对最终用户或数据库应用程序是透明的。
                  </p>
                  <p>虽然物化视图通常通过查询重写机制访问，但最终用户或数据库应用程序可以构造直接访问物化视图的查询。但是，应该认真考虑是否允许用户这样做，因为对物化视图的任何更改都会影响引用它们的查询。</p>
                  <p>本节包含以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="basic-materialized-views.html#GUID-26AB0CB6-F8E5-41B8-B357-9B182597F732">关于数据仓库的物化视图</a></p>
                     </li>
                     <li>
                        <p><a href="basic-materialized-views.html#GUID-881E9280-3C16-4893-A5AE-7FAE20746664">关于分布式计算的物化视图</a></p>
                     </li>
                     <li>
                        <p><a href="basic-materialized-views.html#GUID-191A50DB-3BD3-4B64-B023-20A3E607EE43">关于移动计算的物化视图</a></p>
                     </li>
                     <li>
                        <p><a href="basic-materialized-views.html#GUID-E4538195-1C38-429C-B10F-8722C6A8A06F">物化观点的必要性</a></p>
                     </li>
                     <li>
                        <p><a href="basic-materialized-views.html#GUID-51B55F3F-6ABC-4304-9573-BAB08E1E67FF">摘要管理的组件</a></p>
                     </li>
                     <li>
                        <p><a href="basic-materialized-views.html#GUID-543AB802-DA73-408B-9FE5-686E26D0F44B">数据仓库术语</a></p>
                     </li>
                     <li>
                        <p><a href="basic-materialized-views.html#GUID-8FA00C38-B792-4B44-BDDF-1D80B2451F27">关于物化视图架构设计</a></p>
                     </li>
                     <li>
                        <p><a href="basic-materialized-views.html#GUID-EC6F077E-CA4F-44B0-8A1B-60B921488E05">关于将数据加载到数据仓库中</a></p>
                     </li>
                     <li>
                        <p><a href="basic-materialized-views.html#GUID-6D7B8BA6-9217-48B5-A6F9-87FF0834DA46">物化视图管理任务概述</a></p>
                     </li>
                  </ul>
               </div><a id="DWHSG8161"></a><div class="props_rev_3"><a id="GUID-26AB0CB6-F8E5-41B8-B357-9B182597F732" name="GUID-26AB0CB6-F8E5-41B8-B357-9B182597F732"></a><h4 id="DWHSG-GUID-26AB0CB6-F8E5-41B8-B357-9B182597F732" class="sect4"><span class="enumeration_section">5.1.1</span>关于数据仓库的物化视图</h4>
                  <div>
                     <p>在数据仓库中，您可以使用物化视图来预先计算和存储聚合数据，例如销售总额。这些环境中的物化视图通常称为摘要，因为它们存储汇总数据。它们还可用于预先计算具有或不具有聚合的联接。物化视图消除了与大型或重要类查询的昂贵连接和聚合相关的开销。</p>
                  </div>
               </div><a id="DWHSG8162"></a><div class="props_rev_3"><a id="GUID-881E9280-3C16-4893-A5AE-7FAE20746664" name="GUID-881E9280-3C16-4893-A5AE-7FAE20746664"></a><h4 id="DWHSG-GUID-881E9280-3C16-4893-A5AE-7FAE20746664" class="sect4"><span class="enumeration_section">5.1.2</span>关于分布式计算的物化视图</h4>
                  <div>
                     <p>在分布式环境中，您可以使用物化视图在分布式站点上复制数据，并使用冲突解决方法同步在这些站点上完成的更新。这些副本物化视图提供对本来必须从远程站点访问的数据的本地访问。物化视图在远程数据集市中也很有用。</p>
                     <div class="infoboxnotealso" id="GUID-881E9280-3C16-4893-A5AE-7FAE20746664__GUID-018DF864-8DF8-458B-B100-4C97F497B920">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/dwhsg&amp;id=HETER006" target="_blank"><span class="italic">Oracle数据库异构连接用户指南</span></a></p>
                     </div>
                  </div>
               </div><a id="DWHSG8163"></a><div class="props_rev_3"><a id="GUID-191A50DB-3BD3-4B64-B023-20A3E607EE43" name="GUID-191A50DB-3BD3-4B64-B023-20A3E607EE43"></a><h4 id="DWHSG-GUID-191A50DB-3BD3-4B64-B023-20A3E607EE43" class="sect4"><span class="enumeration_section">5.1.3</span>关于移动计算的物化视图</h4>
                  <div>
                     <p>您还可以使用物化视图将数据子集从中央服务器下载到移动客户端，并在客户端和中央服务器之间定期刷新和更新。本章重点介绍在数据仓库中使用物化视图。</p>
                     <div class="infoboxnotealso" id="GUID-191A50DB-3BD3-4B64-B023-20A3E607EE43__GUID-5D8AB9FA-4BDA-4BA0-B927-14796765C28A">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/dwhsg&amp;id=HETER006" target="_blank"><span class="italic">Oracle数据库异构连接用户指南</span></a></p>
                     </div>
                  </div>
               </div><a id="DWHSG8165"></a><a id="DWHSG8164"></a><div class="props_rev_3"><a id="GUID-E4538195-1C38-429C-B10F-8722C6A8A06F" name="GUID-E4538195-1C38-429C-B10F-8722C6A8A06F"></a><h4 id="DWHSG-GUID-E4538195-1C38-429C-B10F-8722C6A8A06F" class="sect4"><span class="enumeration_section">5.1.4</span>物化观点的必要性</h4>
                  <div>
                     <p>您可以使用物化视图来提高对非常大的数据库的查询速度。对大型数据库的查询通常涉及表之间的连接， <code class="codeph">SUM</code>聚合或两者。这些操作在时间和处理能力方面是昂贵的。您创建的实例化视图的类型决定了查询重写如何刷新和使用实例化视图。
                     </p>
                     <p>物化视图通过在执行之前预先计算数据库上昂贵的连接和聚合操作并将结果存储在数据库中来提高查询性能。查询优化器会自动识别何时可以并且应该使用现有的物化视图来满足请求。然后它透明地重写使用物化视图的请求。查询直接转到物化视图，而不是基础详细信息表。通常，重写查询以使用实体化视图而不是详细信息表可以缩短响应时间。<a href="basic-materialized-views.html#GUID-E4538195-1C38-429C-B10F-8722C6A8A06F__CACGIDEI">图5-1</a>说明了查询重写的工作原理。
                     </p>
                     <div class="figure" id="GUID-E4538195-1C38-429C-B10F-8722C6A8A06F__CACGIDEI">
                        <p class="titleinfigure">图5-1透明查询重写</p><img src="img/dwhsg027.gif" alt="下面是图5-1的描述" title="下面是图5-1的描述" longdesc="img_text/dwhsg027.html"><br><a href="img_text/dwhsg027.html">“图5-1透明查询重写”的描述</a></div>
                     <!-- class="figure" -->
                     <p>使用查询重写时，创建满足最大查询数的实体化视图。例如，如果您确定了通常应用于详细信息表或事实表的20个查询，那么您可以使用五个或六个编写良好的物化视图来满足它们。物化视图定义可以包括任意数量的聚合（ <code class="codeph">SUM</code> ， <code class="codeph">COUNT(x)</code> ， <code class="codeph">COUNT(*)</code> ， <code class="codeph">COUNT(DISTINCT x)</code> ， <code class="codeph">AVG</code> ， <code class="codeph">VARIANCE</code> ， <code class="codeph">STDDEV</code> ， <code class="codeph">MIN</code>和<code class="codeph">MAX</code> ）。它还可以包含任意数量的连接。如果您不确定要创建哪些物化视图，Oracle数据库会提供SQL Access Advisor，它是<code class="codeph">DBMS_ADVISOR</code>包中的一组建议过程，用于帮助设计和评估<code class="codeph">DBMS_ADVISOR</code>化视图以进行查询重写。
                     </p>
                     <p>如果查询重写要使用实例化视图，则必须将其存储在与其所依赖的详细信息表相同的数据库中。可以对实例化视图进行分区，并且可以在分区表上定义实例化视图。您还可以在实例化视图上定义一个或多个索引。</p>
                     <p>与索引不同，可以使用<code class="codeph">SELECT</code>语句直接访问实例化视图。但是，建议您尝试避免编写直接引用实例化视图的SQL语句，因为在不影响应用程序的情况下很难更改它们。相反，让查询重写透明地重写您的查询以使用物化视图。
                     </p>
                     <p>请注意，本章中显示的技术说明了如何在数据仓库中使用物化视图。Oracle Replication也可以使用物化视图。</p>
                  </div>
               </div><a id="DWHSG8167"></a><a id="DWHSG8166"></a><div class="props_rev_3"><a id="GUID-51B55F3F-6ABC-4304-9573-BAB08E1E67FF" name="GUID-51B55F3F-6ABC-4304-9573-BAB08E1E67FF"></a><h4 id="DWHSG-GUID-51B55F3F-6ABC-4304-9573-BAB08E1E67FF" class="sect4"><span class="enumeration_section">5.1.5</span>摘要管理的组成部分</h4>
                  <div>
                     <p>摘要<a id="d15276e389" class="indexterm-anchor"></a>管理包括：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>定义<a href="glossary.html#GUID-AC1E7D15-7178-4C7E-89CA-809D13AB2513"><span class="xrefglossterm">物化视图</span></a>和<a href="glossary.html#GUID-51168741-F40B-41B8-83DE-F159BEB2DE75"><span class="xrefglossterm">维度</span></a>的机制。
                           </p>
                        </li>
                        <li>
                           <p>一种<a href="glossary.html#GUID-649991BA-18DC-4416-9AB5-D7CF69E202F9"><span class="xrefglossterm">刷新</span></a>机制，用于确保所有实例化视图都包含最新数据。
                           </p>
                        </li>
                        <li>
                           <p>一种<a href="glossary.html#GUID-BD33929F-FA4E-4E15-BAA7-2E62E2CF6B7B"><span class="xrefglossterm">查询重写</span></a>功能，用于透明地重写查询以使用实体化视图。
                           </p>
                        </li>
                        <li>
                           <p><a href="glossary.html#GUID-5C0A9E85-E776-4D52-A9A0-C57198FE4165"><span class="xrefglossterm">SQL Access Advisor</span></a> ，它推荐要创建的物化视图，分区和索引。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">TUNE_MVIEW</code>包，向您展示如何使物化视图快速刷新并使用常规查询重写。
                           </p>
                        </li>
                     </ul>
                     <p>使用摘要管理功能不会产生任何架构限制，并且可以使某些现有DSS数据库应用程序无需重新设计数据库或应用程序即可提高性能。</p>
                     <p><a href="basic-materialized-views.html#GUID-51B55F3F-6ABC-4304-9573-BAB08E1E67FF__I1012580">图5-2</a>说明了在仓储周期中使用摘要管理。数据转换，暂存并加载到仓库中的详细数据后，您可以调用摘要管理过程。首先，使用SQL Access Advisor来规划如何使用实体化视图。然后，创建物化视图并设计如何重写查询。如果您在尝试使物化视图工作时遇到问题，请使用<code class="codeph">TUNE_MVIEW</code>获取优化的物化视图。
                     </p>
                     <div class="figure" id="GUID-51B55F3F-6ABC-4304-9573-BAB08E1E67FF__I1012580">
                        <p class="titleinfigure">图5-2摘要管理概述</p><img src="img/dwhsg071.gif" alt="下面是图5-2的描述" title="下面是图5-2的描述" longdesc="img_text/dwhsg071.html"><br><a href="img_text/dwhsg071.html">“图5-2摘要管理概述”的说明</a></div>
                     <!-- class="figure" -->
                     <p>在数据仓库设计的早期阶段理解汇总管理流程可以在以后以更高的性能，更低的汇总管理成本和更低的存储要求的形式产生大的红利。</p>
                  </div>
               </div><a id="DWHSG8168"></a><div class="props_rev_3"><a id="GUID-543AB802-DA73-408B-9FE5-686E26D0F44B" name="GUID-543AB802-DA73-408B-9FE5-686E26D0F44B"></a><h4 id="DWHSG-GUID-543AB802-DA73-408B-9FE5-686E26D0F44B" class="sect4"><span class="enumeration_section">5.1.6</span>数据仓库术语</h4>
                  <div>
                     <p>一些基本数据仓库术语定义如下：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><span class="bold">维度</span> <span class="bold">表</span>描述企业的业务实体，表示为分层的分类信息，如时间，部门，位置和产品。有时会调用维度表<a id="d15276e510" class="indexterm-anchor"></a>查找或<a id="d15276e515" class="indexterm-anchor"></a>参考表。
                           </p>
                           <p>维度表通常会随着时间的推移缓慢变化，并且不会定期修改。它们用于长期运行的决策支持查询，以将查询返回的数据聚合到维度层次结构的适当级别。</p>
                        </li>
                        <li>
                           <p><span class="bold">层次结构</span>描述了数据库中的业务关系和公共访问模式。可以使用对尺寸的分析以及对典型工作负荷的理解来创建物化视图。有关更多信息，请参阅<a href="dimensions.html#GUID-106BE703-0D67-41F1-8CAC-6432B95FBF82">尺寸</a> 。
                           </p>
                        </li>
                        <li>
                           <p><span class="bold">事实</span> <span class="bold">表</span>描述了企业的业务交易。
                           </p>
                           <p>数据仓库中的绝大多数数据存储在一些非常大的事实表中，这些事实表定期使用来自一个或多个操作OLTP数据库的数据进行更新。</p>
                           <p>事实表包括事实（也称为措施），例如销售，单位和库存。
                           </p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>一个简单的度量是一个表的数字或字符列，例如<code class="codeph">fact.sales</code> 。
                                 </p>
                              </li>
                              <li>
                                 <p>计算度量是涉及一个表的度量的表达式，例如<code class="codeph">fact.revenues</code> - <code class="codeph">fact.expenses</code> 。
                                 </p>
                              </li>
                              <li>
                                 <p>多表度量是在多个表上定义的计算度量，例如， <code class="codeph">fact_a.revenues</code> - <code class="codeph">fact_b.expenses</code> 。
                                 </p>
                              </li>
                           </ul>
                           <p>事实表还包含一个或多个外国人<a id="d15276e573" class="indexterm-anchor"></a>由相关业务实体组织业务交易的密钥，例如时间，产品和市场。在大多数情况下，这些外键是非null的，形成事实表的唯一复合键，并且每个外键都与一行中的一行连接。 <a id="d15276e576" class="indexterm-anchor"></a> <a href="glossary.html#GUID-168122D2-C615-4834-BA3D-B578B3EDC4A4"><span class="xrefglossterm">维度表</span></a> 。
                           </p>
                        </li>
                        <li>
                           <p>物化视图是一个预先计算的表，包含来自事实和可能来自维度表的聚合和连接数据。</p>
                        </li>
                     </ul>
                  </div>
               </div><a id="DWHSG8169"></a><div class="props_rev_3"><a id="GUID-8FA00C38-B792-4B44-BDDF-1D80B2451F27" name="GUID-8FA00C38-B792-4B44-BDDF-1D80B2451F27"></a><h4 id="DWHSG-GUID-8FA00C38-B792-4B44-BDDF-1D80B2451F27" class="sect4"><span class="enumeration_section">5.1.7</span>关于物化视图模式设计</h4>
                  <div>
                     <p>总结管理<a id="d15276e618" class="indexterm-anchor"></a>即使您的数据仓库设计不遵循这些准则，也可以执行许多有用的功能，包括查询重写和物化视图刷新。但是，如果您的架构设计符合这些准则，您将实现更高的查询执行性能和物化视图刷新性能优势，并且您需要更少的物化视图。
                     </p>
                     <p>物化视图定义包括任意数量的聚合以及任意数量的连接。在几种方面，物化视图的行为类似于索引：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>物化视图的目的是提高查询执行性能。</p>
                        </li>
                        <li>
                           <p>物化视图的存在对SQL应用程序是透明的，因此数据库管理员可以随时创建或删除物化视图，而不会影响SQL应用程序的有效性。</p>
                        </li>
                        <li>
                           <p>物化视图占用存储空间。</p>
                        </li>
                        <li>
                           <p>修改基础详细信息表时，必须更新实例化视图的内容。</p>
                        </li>
                     </ul>
                     <p>本节包含以下主题：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="basic-materialized-views.html#GUID-0EB40435-5B01-4333-8C7F-CC3D6E73BF23">架构和维度表</a></p>
                        </li>
                        <li>
                           <p><a href="basic-materialized-views.html#GUID-1BAEE838-C1E9-43ED-9441-6E969DB4EAB4">物化视图模式设计指南</a></p>
                        </li>
                     </ul>
                  </div><a id="DWHSG8170"></a><div class="props_rev_3"><a id="GUID-0EB40435-5B01-4333-8C7F-CC3D6E73BF23" name="GUID-0EB40435-5B01-4333-8C7F-CC3D6E73BF23"></a><h5 id="DWHSG-GUID-0EB40435-5B01-4333-8C7F-CC3D6E73BF23" class="sect5"><span class="enumeration_section">5.1.7.1</span>模式和维度表</h5>
                     <div>
                        <p>对于规范化或部分规范化的维度表（存储在多个表中的维度），请确定这些表的连接方式。请注意维度表之间的连接是否可以保证每个子端行与一个且只有一个父端行连接。在非规范化维度的情况下，确定子端列是否唯一地确定父端（或属性）列。如果约束表示的关系通过其他方式得到保证，则可以使用<code class="codeph">NOVALIDATE</code>和<code class="codeph">RELY</code>选项使用约束启用这些关系。请注意，如果事实和维度表之间的连接不支持前面描述的父子关系，那么使用<code class="codeph">CREATE</code> <code class="codeph">DIMENSION</code>语句定义维度仍然可以获得显着的性能优势。另一个替代方案是在物化视图定义中（即在<code class="codeph">CREATE</code> <code class="codeph">MATERIALIZED</code> <code class="codeph">VIEW</code>语句中）使用外连接。
                        </p>
                        <p>您不得在任何不满足这些关系的架构中创建维度。否则，可以从查询返回不正确的结果。</p>
                     </div>
                  </div><a id="DWHSG8171"></a><div class="props_rev_3"><a id="GUID-1BAEE838-C1E9-43ED-9441-6E969DB4EAB4" name="GUID-1BAEE838-C1E9-43ED-9441-6E969DB4EAB4"></a><h5 id="DWHSG-GUID-1BAEE838-C1E9-43ED-9441-6E969DB4EAB4" class="sect5"><span class="enumeration_section">5.1.7.2</span>物化视图模式设计指南</h5>
                     <div>
                        <p>在开始定义和使用摘要管理的各个组件之前，您应该检查您的架构设计，以尽可能遵守以下准则。准则1和2比准则3更重要。如果您的架构设计不遵循指南1和2，那么它是否遵循准则3并不重要。准则1,2和3会影响查询重写性能和物化视图刷新性能。</p>
                        <div class="section">
                           <p class="subhead3" id="GUID-1BAEE838-C1E9-43ED-9441-6E969DB4EAB4__GUID-310BAA25-5FEA-4A74-8387-CEBDE81E1521">尺寸指南1</p>
                           <p>维度应该是非规范化的（每个维度包含在一个表中）或者规范化或部分规范化维度中的表之间的联接应该保证每个子端行与正好一个父端行连接。</p>
                           <p>您可以通过在子端连接键上添加<code class="codeph">FOREIGN</code> <code class="codeph">KEY</code>和<code class="codeph">NOT NULL</code>约束以及在父端连接键上添加<code class="codeph">PRIMARY</code> <code class="codeph">KEY</code>约束来强制执行此条件。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-1BAEE838-C1E9-43ED-9441-6E969DB4EAB4__GUID-6E4CBE68-0C9F-4BAC-88E5-7F004CFC2523">尺寸指南2</p>
                           <p>如果维度非规范化或部分非规范化，则必须在维度表的键列之间保持层次完整性。即使维度表已非规范化，每个子键值也必须唯一标识其父键值。可以通过调用<code class="codeph">DBMS_DIMENSION</code>包的<code class="codeph">VALIDATE_DIMENSION</code>过程来验证非规范化维度中的层次完整性。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-1BAEE838-C1E9-43ED-9441-6E969DB4EAB4__GUID-BA144B4F-D42F-4288-855C-FE5CA8B031C1">尺寸指南3</p>
                           <p>事实和维度表应该类似地保证每个事实表行与正好一个维度表行连接。必须通过在维度键列上的事实键列和<code class="codeph">PRIMARY</code> <code class="codeph">KEY</code>约束上添加<code class="codeph">FOREIGN</code> <code class="codeph">KEY</code>和<code class="codeph">NOT</code> <code class="codeph">NULL</code>约束，或者通过使用外部联接来声明并可选地强制执行此条件。在数据仓库中，通常使用<code class="codeph">NOVALIDATE</code>和<code class="codeph">RELY</code>子句启用约束，以避免约束执行性能开销。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-1BAEE838-C1E9-43ED-9441-6E969DB4EAB4__GUID-AF7C8988-AA8A-493A-A82B-DFCABF00A96F">尺寸指南4</p>
                           <p>在每次加载之后和刷新<code class="codeph">DBMS_DIMENSION</code>化视图之前，使用<code class="codeph">DBMS_DIMENSION</code>包的<code class="codeph">VALIDATE_DIMENSION</code>过程逐步验证尺寸完整性。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-1BAEE838-C1E9-43ED-9441-6E969DB4EAB4__GUID-7562295B-1501-4C05-93F0-4C4F9C01F521">增量载荷指南</p>
                           <p>应使用SQL * Loader direct-path选项或使用Oracle直接路径接口的任何批量加载器实用程序来完成详细数据的增量加载。这包括<code class="codeph">INSERT</code> ......<code class="codeph">AS SELECT</code>与<code class="codeph">APPEND</code>或<code class="codeph">PARALLEL</code>提示，其中提示导致在插入期间使用直接加载器日志。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-1BAEE838-C1E9-43ED-9441-6E969DB4EAB4__GUID-D5FC461B-223C-4F80-9B36-C944923EF7E7">分区指南</p>
                           <p>如果可能，范围/复合将表分区为单调增加的时间列（最好是<code class="codeph">DATE</code>类型）。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-1BAEE838-C1E9-43ED-9441-6E969DB4EAB4__GUID-0F7C0117-933F-453C-9659-9B168F0AEA6B">时间维度指南</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>如果时间维在实体化视图中显示为时间列，则以与事实表相同的方式对实例化视图进行分区和索引。</p>
                           <p>如果您关注启用约束所需的时间以及是否可能违反任何约束，则使用带有<code class="codeph">RELY</code>子句的<code class="codeph">ENABLE</code> <code class="codeph">NOVALIDATE</code>打开约束检查，而不验证任何现有约束。这种方法的风险在于，如果任何约束被破坏，可能会出现不正确的查询结果。因此，作为设计人员，您必须确定数据的清洁程度以及错误结果的风险是否过大。
                           </p>
                           <div class="infoboxnotealso" id="GUID-1BAEE838-C1E9-43ED-9441-6E969DB4EAB4__GUID-20A7AE13-61D9-4540-8FA7-0E4006EEBD4D">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><span class="q">“ <a href="basic-materialized-views.html#GUID-63E162FE-8957-4C1D-9494-041A8B2B7917" title="如果物化视图仅包含连接，则每个表的ROWID列（以及在FROM列表中多次出现的表的每个实例）必须存在于实例化视图的SELECT列表中。">物化视图的类型</a> ”</span></p>
                                 </li>
                                 <li>
                                    <p><span class="q">“ <a href="dimensions.html#GUID-C924590B-C481-4202-9243-1EEB66560C6D">创建维度</a> ”</span>以获取有关使用父端行维护子端行连接的好处的详细信息</p>
                                 </li>
                                 <li>
                                    <p><a href="../sqlrf/CREATE-MATERIALIZED-VIEW.html#SQLRF01302" target="_blank"><span><cite>Oracle数据库SQL语言参考</cite></span></a></p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div><a id="DWHSG8173"></a><div class="props_rev_3"><a id="GUID-EC6F077E-CA4F-44B0-8A1B-60B921488E05" name="GUID-EC6F077E-CA4F-44B0-8A1B-60B921488E05"></a><h4 id="DWHSG-GUID-EC6F077E-CA4F-44B0-8A1B-60B921488E05" class="sect4"><span class="enumeration_section">5.1.8</span>关于将数据加载到数据仓库中</h4>
                  <div>
                     <p>将数据加载到数据仓库或数据集市中的一种流行且有效的方法是将SQL * Loader与<code class="codeph">DIRECT</code>或<code class="codeph">PARALLEL</code>选项，Data Pump一起使用，或使用另一个使用Oracle直接路径API的加载器工具。</p>
                     <p>装载策略可分为单阶段或两阶段。在单阶段加载中，数据直接加载到目标表中，执行质量保证测试，并通过在刷新实例化视图之前执行DML操作来解决错误。如果可能发生大量删除，则存储利用率可能会受到不利影响，但临时空间要求和加载时间会最小化。</p>
                     <p>在两阶段加载过程中：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>数据首先加载到仓库中的临时表中。</p>
                        </li>
                        <li>
                           <p>质量保证程序适用于数据。</p>
                        </li>
                        <li>
                           <p>禁用目标表上的参照完整性约束，并将目标分区中的本地索引标记为不可用。</p>
                        </li>
                        <li>
                           <p>使用<code class="codeph">INSERT</code> <code class="codeph">AS</code> <code class="codeph">SELECT</code>和<code class="codeph">PARALLEL</code>或<code class="codeph">APPEND</code>提示将数据从临时区域复制到目标表的相应分区中。然后删除临时表。或者，如果目标表已分区，则可以在目标表中创建一个新的（空）分区，并使用<code class="codeph">ALTER TABLE ...EXCHANGE PARTITION</code>将临时表合并到目标表中。有关更多信息，请参见<a href="../sqlrf/ALTER-TABLE.html#SQLRF53492" target="_blank"><span><cite>Oracle数据库SQL语言参考</cite></span></a> 。
                           </p>
                        </li>
                        <li>
                           <p>通常使用<code class="codeph">NOVALIDATE</code>选项启用约束。
                           </p>
                        </li>
                     </ul>
                     <p>加载详细数据并更新详细数据上的索引后，如果需要，可以立即打开数据库进行操作。您可以通过发出<code class="codeph">ALTER</code> <code class="codeph">SYSTEM</code> <code class="codeph">SET</code> <code class="codeph">QUERY_REWRITE_ENABLED</code> = <code class="codeph">FALSE</code>语句在系统级别禁用查询重写，直到刷新所有物化视图。
                     </p>
                     <p>如果<code class="codeph">QUERY_REWRITE_INTEGRITY</code>设置为<code class="codeph">STALE_TOLERATED</code> ，则可以在会话级别对任何不要求物化视图通过发出<code class="codeph">ALTER</code> <code class="codeph">SESSION</code> <code class="codeph">SET</code> <code class="codeph">QUERY_REWRITE_ENABLED</code> = <code class="codeph">TRUE</code>语句来反映最新加载数据的用户进行物化视图访问。当<code class="codeph">QUERY_REWRITE_INTEGRITY</code>为<code class="codeph">ENFORCED</code>或<code class="codeph">TRUSTED</code>时，此方案不适用，因为系统在这些模式下确保只有具有更新数据的物化视图参与查询重写。
                     </p>
                     <div class="infoboxnotealso" id="GUID-EC6F077E-CA4F-44B0-8A1B-60B921488E05__GUID-15444819-88B8-4D39-81DE-51EAACBD0FE8">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="../sutil/oracle-sql-loader-concepts.html#SUTIL003" target="_blank"><span class="italic">Oracle Database Utilities</span></a> ，了解使用带有<code class="codeph">DIRECT</code>或<code class="codeph">PARALLEL</code>关键字的SQL * Loader时的限制和注意事项</p>
                     </div>
                  </div>
               </div><a id="DWHSG8174"></a><div class="props_rev_3"><a id="GUID-6D7B8BA6-9217-48B5-A6F9-87FF0834DA46" name="GUID-6D7B8BA6-9217-48B5-A6F9-87FF0834DA46"></a><h4 id="DWHSG-GUID-6D7B8BA6-9217-48B5-A6F9-87FF0834DA46" class="sect4"><span class="enumeration_section">5.1.9</span>物化视图管理任务概述</h4>
                  <div>
                     <p>使用物化视图的动机是提高性能，但与物化视图管理相关的开销可能会成为一个重要的系统管理问题。在审查或评估一些必要的物化视图管理活动时，请考虑以下某些方面：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>确定最初要创建的物化视图。</p>
                        </li>
                        <li>
                           <p>索引物化视图。</p>
                        </li>
                        <li>
                           <p>确保每次更新数据库时都能正确刷新所有实例化视图和物化视图索引。</p>
                        </li>
                        <li>
                           <p>检查已使用的物化视图。</p>
                        </li>
                        <li>
                           <p>确定每个物化视图对工作负载性能的有效性。</p>
                        </li>
                        <li>
                           <p>测量物化视图使用的空间。</p>
                        </li>
                        <li>
                           <p>确定应创建哪些新的物化视图。</p>
                        </li>
                        <li>
                           <p>确定应删除哪些现有的物化视图。</p>
                        </li>
                        <li>
                           <p>存档不再有用的旧详细信息和物化视图数据。</p>
                        </li>
                     </ul>
                     <p>在创建和填充数据仓库或数据集市的初始工作之后，主要的管理开销是更新过程，其中涉及：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>定期从操作系统中提取增量变化。</p>
                        </li>
                        <li>
                           <p>转换数据。</p>
                        </li>
                        <li>
                           <p>验证增量更改是否正确，一致且完整。</p>
                        </li>
                        <li>
                           <p>将数据批量加载到仓库中。</p>
                        </li>
                        <li>
                           <p>刷新索引和物化视图，使其与详细数据保持一致。</p>
                        </li>
                     </ul>
                     <p>更新过程通常必须在称为的有限时间内执行<a id="d15276e1079" class="indexterm-anchor"></a> <a href="glossary.html#GUID-3924FE75-A719-428A-B7AB-714D15A456A0"><span class="xrefglossterm">更新窗口</span></a> 。更新窗口取决于<a id="d15276e1085" class="indexterm-anchor"></a> <a href="glossary.html#GUID-6AEAFA62-131A-4B0B-990D-42DD06C68438"><span class="xrefglossterm">更新频率</span></a> （例如每日或每周）和业务性质。对于每日更新频率，可能是典型的2到6小时的更新窗口。
                     </p>
                     <p>您需要知道以下活动的更新窗口：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>加载详细数据</p>
                        </li>
                        <li>
                           <p>更新或重建详细数据上的索引</p>
                        </li>
                        <li>
                           <p>对数据执行质量保证测试</p>
                        </li>
                        <li>
                           <p>刷新物化视图</p>
                        </li>
                        <li>
                           <p>更新实例化视图上的索引</p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div><a id="DWHSG0082"></a><div class="props_rev_3"><a id="GUID-63E162FE-8957-4C1D-9494-041A8B2B7917" name="GUID-63E162FE-8957-4C1D-9494-041A8B2B7917"></a><h3 id="DWHSG-GUID-63E162FE-8957-4C1D-9494-041A8B2B7917" class="sect3"><span class="enumeration_section">5.2</span>物化视图的类型</h3>
               <div>
                  <p><a id="d15276e1130" class="indexterm-anchor"></a>物化视图创建语句中的<code class="codeph">SELECT</code>子句定义物化视图要包含的数据。只有少数限制限制了可以指定的内容。可以将任意数量的表连接在一起。除了表之外，其他元素（如视图，内联视图（ <code class="codeph">SELECT</code>语句的<code class="codeph">FROM</code>子句中的子查询），子查询和物化视图）都可以在<code class="codeph">SELECT</code>子句中连接或引用。但是，您无法在定义查询的<code class="codeph">SELECT</code>列表中使用子查询定义实例化视图。但是，您可以在定义查询的其他位置包含子查询，例如在<code class="codeph">WHERE</code>子句中。
                  </p>
                  <p>物化视图的类型是：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="basic-materialized-views.html#GUID-E087FDD0-B08C-4878-BBA9-DE56A705835E">关于具有聚合的物化视图</a></p>
                     </li>
                     <li>
                        <p><a href="basic-materialized-views.html#GUID-3B903558-0C98-4033-9BCD-4A146220E868" title="如果物化视图仅包含连接，则每个表的ROWID列（以及在FROM列表中多次出现的表的每个实例）必须存在于实例化视图的SELECT列表中。">关于仅包含联接的物化视图</a></p>
                     </li>
                     <li>
                        <p><a href="basic-materialized-views.html#GUID-BA7DBCFF-67F2-44A6-BCE2-931A469F553C">关于嵌套的物化视图</a></p>
                     </li>
                  </ul>
               </div><a id="DWHSG8176"></a><a id="DWHSG8177"></a><a id="DWHSG8178"></a><a id="DWHSG8175"></a><div class="props_rev_3"><a id="GUID-E087FDD0-B08C-4878-BBA9-DE56A705835E" name="GUID-E087FDD0-B08C-4878-BBA9-DE56A705835E"></a><h4 id="DWHSG-GUID-E087FDD0-B08C-4878-BBA9-DE56A705835E" class="sect4"><span class="enumeration_section">5.2.1</span>关于具有聚合的物化视图</h4>
                  <div>
                     <p>在<a id="d15276e1215" class="indexterm-anchor"></a>数据仓库，物化视图通常包含聚合，如<a href="basic-materialized-views.html#GUID-E087FDD0-B08C-4878-BBA9-DE56A705835E__I1006540">例5-1</a>所示。为了能够<a href="glossary.html#GUID-4D70E5C0-17A2-4AD5-B75D-3C81B5110FBF"><span class="xrefglossterm">快速刷新</span></a> ， <code class="codeph">SELECT</code>列表必须包含所有<code class="codeph">GROUP</code> <code class="codeph">BY</code>列（如果存在），并且在任何聚合列上必须有<code class="codeph">COUNT(*)</code>和<code class="codeph">COUNT(column)</code> 。此外， <a href="glossary.html#GUID-EDB1A012-531D-4BE8-8826-F6D3DC477E33"><span class="xrefglossterm">物化视图日志</span></a>必须出现在定义物化视图的查询中引用的所有表上。有效的聚合函数是： <code class="codeph">SUM</code> ， <code class="codeph">COUNT(x)</code> ， <code class="codeph">COUNT(*)</code> ， <code class="codeph">AVG</code> ， <code class="codeph">VARIANCE</code> ， <code class="codeph">STDDEV</code> ， <code class="codeph">MIN</code>和<code class="codeph">MAX</code> ，要聚合的表达式可以是任何SQL值表达式。请参阅<span class="q">“ <a href="basic-materialized-views.html#GUID-932B8CD4-BF60-419A-9202-8A9FD5D24024">使用聚合在物化视图上快速刷新的限制</a> ”</span> 。
                     </p>
                     <div class="infoboxnotealso" id="GUID-E087FDD0-B08C-4878-BBA9-DE56A705835E__GUID-3BA10586-294C-478E-B949-016C50571746">
                        <p class="notep1">也可以看看：</p>
                        <p><span class="q">“ <a href="basic-materialized-views.html#GUID-8823A06E-853B-4876-AB9F-96D2D4E5A1DE">使用具有聚合的物化视图的要求</a> ”</span></p>
                     </div>
                     <p>在基表的任何类型的DML（直接加载或传统的<code class="codeph">INSERT</code> ， <code class="codeph">UPDATE</code>或<code class="codeph">DELETE</code> ）之后，可以快速刷新包含连接和聚合的物化视图。它可以定义为刷新<code class="codeph">ON</code> <code class="codeph">COMMIT</code>或<code class="codeph">ON</code> <code class="codeph">DEMAND</code> 。当对物化视图的详细信息表之一执行DML的事务<code class="codeph">COMMIT</code> <code class="codeph">REFRESH ON</code> <code class="codeph">COMMIT</code>物化视图会自动刷新。选择此方法时，完成提交所需的时间可能比平时略长。这是因为刷新操作是作为提交过程的一部分执行的。因此，如果许多用户同时改变物化视图所基于的表，则该方法可能不合适。
                     </p>
                     <p>以下是使用聚合的物化视图的一些示例。请注意，仅创建物化视图日志，因为此物化视图已快速刷新。</p>
                     <div class="example" id="GUID-E087FDD0-B08C-4878-BBA9-DE56A705835E__I1006540">
                        <p class="titleinexample">示例5-1 <span class="bold">创建物化视图</span> （销售总数和值）</p><pre class="oac_no_warn" dir="ltr">使用SEQUENCE，ROWID（prod_id，prod_name，prod_desc，prod_subcategory，prod_subcategory_desc，prod_category，prod_category_desc，prod_weight_class，prod_unit_of_measure，prod_pack_size，supplier_id，prod_status，prod_list_price，prod_min_price）创建物料化视图登录产品，包括新价值;使用SEQUENCE，ROWID（prod_id，cust_id，time_id，channel_id，promo_id，quantity_sold，amount_sold）创建物料化视图登录销售包括新值; CREATE MATERIALIZED VIEW product_sales_mv PCTFREE 0 TABLESPACE演示存储（初始8M）构建立即刷新快速启用QUERY REWRITE作为选择p.prod_name，SUM（s.amount_sold）AS dollar_sales，COUNT（*）AS cnt，COUNT（s.amount_sold）AS cnt_amt FROM sales s，products p WHERE s.prod_id = p.prod_id GROUP BY p.prod_name;</pre><p>此示例创建一个物化视图<code class="codeph">product_sales_mv</code> ，用于计算产品的总销售额和销售额。它是通过在<code class="codeph">prod_id</code>列上加入表<code class="codeph">sales</code>和<code class="codeph">products</code>来派生的。物化视图立即填充数据，因为构建方法是立即的，并且可供查询重写使用。在此示例中，默认刷新方法是<code class="codeph">FAST</code> ，这是允许的，因为已在表<code class="codeph">products</code>和<code class="codeph">sales</code>上创建了相应的物化视图日志。
                        </p>
                        <p>如果使用包含<code class="codeph">WITH</code> <code class="codeph">COMMIT</code> <code class="codeph">SCN</code>子句的物化视图日志，则可以为本地物化视图实现更好的快速刷新性能。一个例子如下：</p><pre class="oac_no_warn" dir="ltr">使用ROWID（prod_id，cust_id，time_id）创建物料化视图登录销售，包括新值的COMMIT SCN;</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-E087FDD0-B08C-4878-BBA9-DE56A705835E__GUID-6E37B03D-750D-4E30-9718-168EB4039E95">
                        <p class="titleinexample">示例5-2 <span class="bold">创建物化视图</span> （计算的销售总和）</p><pre class="oac_no_warn" dir="ltr">CREATE MATERIALIZED VIEW product_sales_mv PCTFREE 0 TABLESPACE演示存储（初始8M）根据需求构建延迟刷新使用QUERY REWRITE作为SELECT p.prod_name，SUM（s.amount_sold）AS dollar_sales FROM sales s，products p WHERE s.prod_id = p.prod_id GROUP BY p.prod_name;</pre><p>此示例创建一个物化视图<code class="codeph">product_sales_mv</code> ，用于计算<code class="codeph">prod_name</code>的销售<code class="codeph">prod_name</code> 。它是通过在<code class="codeph">prod_id</code>列上加入表<code class="codeph">sales</code>和<code class="codeph">products</code>来派生的。物化视图最初不包含任何数据，因为构建方法是<code class="codeph">DEFERRED</code> 。第一次刷新构建延迟实例化视图时需要完全刷新。刷新并填充后，查询重写可以使用此物化视图。
                        </p>
                     </div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-E087FDD0-B08C-4878-BBA9-DE56A705835E__GUID-B6CFF335-0EC9-4EEC-9CD6-26F63B098D8E">
                        <p class="titleinexample">示例5-3 <span class="bold">创建物化视图</span> （在单个表上聚合）</p><pre class="oac_no_warn" dir="ltr">使用SEQUENCE，ROWID（prod_id，cust_id，time_id，channel_id，promo_id，quantity_sold，amount_sold）创建物料化视图登录销售包括新值; CREATE MATERIALIZED VIEW sum_sales PARALLEL BUILD IMFEDIATE REFRESH FAST ON COMMIT AS SELECT s.prod_id，s.time_id，COUNT（*）AS count_grp，SUM（s.amount_sold）AS sum_dollar_sales，COUNT（s.amount_sold）AS count_dollar_sales，SUM（s。 quantity_sold）AS sum_quantity_sales，COUNT（s.quantity_sold）AS count_quantity_sales FROM sales s GROUP BY s.prod_id，s.time_id;</pre><p>此示例创建一个包含单个表上的聚合的实例化视图。由于已在物化视图的定义查询中使用所有引用列创建了物化视图日志，因此物化视图可快速刷新。如果对<code class="codeph">sales</code>表应用DML，则在发出提交时，更改将反映在实例化视图中。
                        </p>
                        <div class="infoboxnotealso" id="GUID-E087FDD0-B08C-4878-BBA9-DE56A705835E__GUID-D57F74C8-777A-4FE1-B3CF-3CF52758DDCD">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="../sqlrf/CREATE-MATERIALIZED-VIEW.html#SQLRF01302" target="_blank"><span><cite>Oracle Database SQL语言参考，</cite></span></a>用于<code class="codeph">CREATE</code> <code class="codeph">MATERIALIZED</code> <code class="codeph">VIEW</code>和<code class="codeph">CREATE</code> <code class="codeph">MATERIALIZED</code> <code class="codeph">VIEW</code> <code class="codeph">LOG</code>语句的语法</p>
                        </div>
                     </div>
                     <!-- class="example" -->
                  </div><a id="DWHSG8180"></a><a id="DWHSG8179"></a><div class="props_rev_3"><a id="GUID-8823A06E-853B-4876-AB9F-96D2D4E5A1DE" name="GUID-8823A06E-853B-4876-AB9F-96D2D4E5A1DE"></a><h5 id="DWHSG-GUID-8823A06E-853B-4876-AB9F-96D2D4E5A1DE" class="sect5"><span class="enumeration_section">5.2.1.1</span>使用具有聚合的物化视图的要求</h5>
                     <div>
                        <p><a href="basic-materialized-views.html#GUID-8823A06E-853B-4876-AB9F-96D2D4E5A1DE__G1014280" title="具有聚合的物化视图的要求">表5-1</a>说明了物化视图的总体要求。如果存在聚合<code class="codeph">X</code> ，则需要聚合<code class="codeph">Y</code> ，聚合<code class="codeph">Z</code>是可选的。
                        </p>
                        <div class="tblformal" id="GUID-8823A06E-853B-4876-AB9F-96D2D4E5A1DE__G1014280">
                           <p class="titleintable">表5-1具有聚合的物化视图的要求</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="具有聚合的物化视图的要求" width="100%" border="1" summary="Requirements for Materialized Views with Aggregates" frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="30%" id="d15276e1474">X</th>
                                    <th align="left" valign="bottom" width="33%" id="d15276e1477">ÿ</th>
                                    <th align="left" valign="bottom" width="37%" id="d15276e1480">ž</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="30%" id="d15276e1485" headers="d15276e1474 ">
                                       <p><code class="codeph">COUNT（表达式）</code></p>
                                    </td>
                                    <td align="left" valign="top" width="33%" headers="d15276e1485 d15276e1477 ">
                                       <p><code class="codeph">-</code></p>
                                    </td>
                                    <td align="left" valign="top" width="37%" headers="d15276e1485 d15276e1480 ">
                                       <p><code class="codeph">-</code></p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="30%" id="d15276e1498" headers="d15276e1474 ">
                                       <p><code class="codeph">MIN（表达式）</code></p>
                                    </td>
                                    <td align="left" valign="top" width="33%" headers="d15276e1498 d15276e1477 ">
                                       <p></p>
                                    </td>
                                    <td align="left" valign="top" width="37%" headers="d15276e1498 d15276e1480 ">
                                       <p></p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="30%" id="d15276e1507" headers="d15276e1474 ">
                                       <p><code class="codeph">MAX（表达式）</code></p>
                                    </td>
                                    <td align="left" valign="top" width="33%" headers="d15276e1507 d15276e1477 ">
                                       <p></p>
                                    </td>
                                    <td align="left" valign="top" width="37%" headers="d15276e1507 d15276e1480 ">
                                       <p></p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="30%" id="d15276e1516" headers="d15276e1474 ">
                                       <p><code class="codeph">SUM（表达式）</code></p>
                                    </td>
                                    <td align="left" valign="top" width="33%" headers="d15276e1516 d15276e1477 ">
                                       <p><code class="codeph">COUNT（表达式）</code></p>
                                    </td>
                                    <td align="left" valign="top" width="37%" headers="d15276e1516 d15276e1480 ">
                                       <p><code class="codeph">-</code></p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="30%" id="d15276e1529" headers="d15276e1474 ">
                                       <p><code class="codeph">SUM(col)</code> ， <code class="codeph">col</code>具有<code class="codeph">NOT</code> <code class="codeph">NULL</code>约束</p>
                                    </td>
                                    <td align="left" valign="top" width="33%" headers="d15276e1529 d15276e1477 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="37%" headers="d15276e1529 d15276e1480 ">
                                       <p></p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="30%" id="d15276e1549" headers="d15276e1474 ">
                                       <p><code class="codeph">AVG（表达式）</code></p>
                                    </td>
                                    <td align="left" valign="top" width="33%" headers="d15276e1549 d15276e1477 ">
                                       <p><code class="codeph">COUNT（表达式）</code></p>
                                    </td>
                                    <td align="left" valign="top" width="37%" headers="d15276e1549 d15276e1480 ">
                                       <p><code class="codeph">SUM（表达式）</code></p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="30%" id="d15276e1562" headers="d15276e1474 ">
                                       <p><code class="codeph">STDDEV（表达式）</code></p>
                                    </td>
                                    <td align="left" valign="top" width="33%" headers="d15276e1562 d15276e1477 ">
                                       <p><code class="codeph">COUNT（expr）SUM（expr）</code></p>
                                    </td>
                                    <td align="left" valign="top" width="37%" headers="d15276e1562 d15276e1480 ">
                                       <p><code class="codeph">SUM（expr * expr）</code></p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="30%" id="d15276e1575" headers="d15276e1474 ">
                                       <p><code class="codeph">方差（表达式）</code></p>
                                    </td>
                                    <td align="left" valign="top" width="33%" headers="d15276e1575 d15276e1477 ">
                                       <p><code class="codeph">COUNT（expr）SUM（expr）</code></p>
                                    </td>
                                    <td align="left" valign="top" width="37%" headers="d15276e1575 d15276e1480 ">
                                       <p><code class="codeph">SUM（expr * expr）</code></p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                        <p>请注意，必须始终存在<code class="codeph">COUNT(*)</code>以保证所有类型的快速刷新。否则，您可能仅限于在插入后快速刷新。Oracle建议您在实例化视图中的<code class="codeph">Z</code>列中包含可选聚合，以便获得最有效和准确的聚合快速刷新。
                        </p>
                     </div>
                  </div>
               </div><a id="DWHSG8181"></a><div class="props_rev_3"><a id="GUID-3B903558-0C98-4033-9BCD-4A146220E868" name="GUID-3B903558-0C98-4033-9BCD-4A146220E868"></a><h4 id="DWHSG-GUID-3B903558-0C98-4033-9BCD-4A146220E868" class="sect4"><span class="enumeration_section">5.2.2</span>关于仅包含联接的物化视图</h4>
                  <div>
                     <p>某些物化视图仅包含连接而不包含聚合，例如在<a href="basic-materialized-views.html#GUID-1F42F25D-739B-4FEE-BEBC-212869D5CD10" title="如果物化视图仅包含连接，则每个表的ROWID列（以及在FROM列表中多次出现的表的每个实例）必须存在于实例化视图的SELECT列表中。">物化连接视图FROM子句注意事项中</a> ，其中创建了将<code class="codeph">sales</code>表连接到<code class="codeph">times</code>和<code class="codeph">customers</code>表的实例化视图。创建此类物化视图的优点是预先计算了昂贵的连接。
                     </p>
                     <div class="infoboxnotealso" id="GUID-3B903558-0C98-4033-9BCD-4A146220E868__GUID-B5AA2F20-C6B7-4119-8F7F-E74702970FA8">
                        <p class="notep1">也可以看看：</p>
                        <p><span class="q">“ <a href="basic-materialized-views.html#GUID-1F42F25D-739B-4FEE-BEBC-212869D5CD10" title="如果物化视图仅包含连接，则每个表的ROWID列（以及在FROM列表中多次出现的表的每个实例）必须存在于实例化视图的SELECT列表中。">物化加入视图FROM子句注意事项</a> ”</span></p>
                     </div>
                     <p>在基表的任何类型的DML（直接路径或传统的<code class="codeph">INSERT</code> ， <code class="codeph">UPDATE</code>或<code class="codeph">DELETE</code> ）之后，可以快速刷新仅包含连接的物化视图。
                     </p>
                     <p>只包含连接的物化视图可以定义为在<code class="codeph">ON COMMIT</code>或<code class="codeph">ON</code> <code class="codeph">DEMAND</code>刷新。如果它是<code class="codeph">ON</code> <code class="codeph">COMMIT</code> ，则在事务的提交时执行刷新，该事务在物化视图的详细信息表上执行DML。
                     </p>
                     <p>如果指定<code class="codeph">REFRESH</code> <code class="codeph">FAST</code> ，Oracle数据库将执行查询定义的进一步验证，以确保在任何详细信息表更改时可以执行快速刷新。这些额外的检查是：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>除非表支持分区更改跟踪（PCT），否则每个详细信息表必须存在物化视图日志。此外，当需要物化视图日志时，每个物化视图日志中都必须存在<code class="codeph">ROWID</code>列。
                           </p>
                        </li>
                        <li>
                           <p>所有详细信息表的rowid必须出现在<code class="codeph">SELECT</code>化视图查询定义的<code class="codeph">SELECT</code>列表中。
                           </p>
                        </li>
                     </ul>
                     <p>如果不满足其中一些限制，您可以将物化视图创建为<code class="codeph">REFRESH</code> <code class="codeph">FORCE</code> ，以便在可能的情况下利用快速刷新。如果其中一个表不符合所有条件，但其他表格不符合，则相对于满足所有条件的其他表格，物化视图仍可快速刷新。
                     </p>
                     <p>要实现最佳效率的刷新，应确保定义查询不使用行为类似于内部联接的外部联接。如果定义查询包含此类连接，请考虑重写定义查询以包含内部联接。</p>
                     <div class="infoboxnotealso" id="GUID-3B903558-0C98-4033-9BCD-4A146220E868__GUID-7DA8543B-D858-4D40-B02D-3CF4337E376C">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="q">“ <a href="basic-materialized-views.html#GUID-D930288D-D242-4C27-B8D1-B01236F2E0B1">有关仅具有联接的物化视图上的快速刷新的限制</a> ”</span> ，以获取有关导致刷新性能降级的条件的更多信息。
                              </p>
                           </li>
                           <li>
                              <p><span class="q">“ <a href="refreshing-materialized-views.html#GUID-FE65EDEB-56AF-43CB-A7C2-06E74553E0CD">关于物化视图的分区更改跟踪（PCT）刷新</a> ”</span></p>
                           </li>
                        </ul>
                     </div>
                  </div><a id="DWHSG8183"></a><a id="DWHSG8182"></a><div class="props_rev_3"><a id="GUID-1F42F25D-739B-4FEE-BEBC-212869D5CD10" name="GUID-1F42F25D-739B-4FEE-BEBC-212869D5CD10"></a><h5 id="DWHSG-GUID-1F42F25D-739B-4FEE-BEBC-212869D5CD10" class="sect5"><span class="enumeration_section">5.2.2.1</span>实体连接视图FROM子句注意事项</h5>
                     <div>
                        <p>如果物化视图仅包含连接，则每个表的<code class="codeph">ROWID</code>列（以及在<code class="codeph">FROM</code>列表中多次出现的表的每个实例）必须存在于实例化视图的<code class="codeph">SELECT</code>列表中。
                        </p>
                        <p></p>
                        <p>如果物化视图在远程表<code class="codeph">FROM</code>子句中的所有表<code class="codeph">FROM</code>子句必须在同一个网站上以位于执行增量（快）刷新物化视图。此外，具有远程表的物化视图不支持<code class="codeph">ON</code> <code class="codeph">COMMIT</code>刷新。除基于SCN的物化视图日志外，物化视图日志必须存在于远程站点上，以用于物化视图的每个详细信息表，并且<code class="codeph">ROWID</code>列必须存在于物化视图的<code class="codeph">SELECT</code>列表中，如以下示例所示。
                        </p>
                        <div class="example" id="GUID-1F42F25D-739B-4FEE-BEBC-212869D5CD10__I1006694">
                           <p class="titleinexample">示例5-4仅包含连接的物化视图</p><pre class="oac_no_warn" dir="ltr">使用ROWID创建物料化视图登录销售;使用ROWID创建物料化视图日志;使用ROWID创建物料化视图登录客户; CREATE MATERIALIZED VIEW detail_sales_mv并行构建立即刷新快速选择s.rowid“sales_rid”，t.rowid“times_rid”，c.rowid“customers_rid”，c.cust_id，c.cust_last_name，s.amount_sold，s.quantity_sold，s。 time_id FROM sales s，times t，customers c WHERE s.cust_id = c.cust_id（+）AND s.time_id = t.time_id（+）;</pre><p>或者，如果前面的示例不包含列<code class="codeph">times_rid</code>和<code class="codeph">customers_rid</code> ，并且刷新方法是<code class="codeph">REFRESH</code> <code class="codeph">FORCE</code> ，则只有在更新销售表时才会快速刷新此物化视图，但如果表<code class="codeph">times</code>或<code class="codeph">customers</code>已更新则不会快速刷新。
                           </p><pre class="oac_no_warn" dir="ltr">CREATE MATERIALIZED VIEW detail_sales_mv PARALLEL BUILD IMMEDIATE REFRESH FORCE作为SELECT s.rowid“sales_rid”，c.cust_id，c.cust_last_name，s.amount_sold，s.quantity_sold，s.time_id FROM sales s，times t，customers c WHERE s.cust_id = c.cust_id（+）AND s.time_id = t.time_id（+）;</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div>
               </div><a id="DWHSG8184"></a><div class="props_rev_3"><a id="GUID-BA7DBCFF-67F2-44A6-BCE2-931A469F553C" name="GUID-BA7DBCFF-67F2-44A6-BCE2-931A469F553C"></a><h4 id="DWHSG-GUID-BA7DBCFF-67F2-44A6-BCE2-931A469F553C" class="sect4"><span class="enumeration_section">5.2.3</span>关于嵌套的物化视图</h4>
                  <div>
                     <p><a id="d15276e1843" class="indexterm-anchor"></a><a id="d15276e1847" class="indexterm-anchor"></a>嵌套的物化视图是物化视图，其定义基于另一个物化视图。除引用实体化视图外，嵌套的物化视图还可以引用数据库中的其他关系。
                     </p>
                     <p>本节包含以下主题：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="basic-materialized-views.html#GUID-6516CC0D-1F11-4127-A497-114AD84128DF">为什么使用嵌套的物化视图？</a></p>
                        </li>
                        <li>
                           <p><a href="basic-materialized-views.html#GUID-179C8C8A-585B-49E6-8970-09396DB53DE3">关于使用联接和聚合嵌套物化视图</a></p>
                        </li>
                        <li>
                           <p><a href="basic-materialized-views.html#GUID-8B2C0915-2FC8-4866-BDF7-7F74ABDC1D5D">嵌套的物化视图使用指南</a></p>
                        </li>
                        <li>
                           <p><a href="basic-materialized-views.html#GUID-6DABD06E-555C-4C39-9DA5-7601E2464FDA">使用嵌套物化视图时的限制</a></p>
                        </li>
                     </ul>
                  </div><a id="DWHSG8186"></a><a id="DWHSG8185"></a><div class="props_rev_3"><a id="GUID-6516CC0D-1F11-4127-A497-114AD84128DF" name="GUID-6516CC0D-1F11-4127-A497-114AD84128DF"></a><h5 id="DWHSG-GUID-6516CC0D-1F11-4127-A497-114AD84128DF" class="sect5"><span class="enumeration_section">5.2.3.1</span>为什么使用嵌套的物化视图？
                     </h5>
                     <div>
                        <p>在数据仓库中，通常在单个连接上创建许多聚合视图（例如，沿不同维度汇总）。增量维护这些不同的物化聚合视图可能需要很长时间，因为底层连接必须多次执行。</p>
                        <p>使用嵌套的物化视图，您可以基于仅限连接的物化视图创建多个单表实体化视图，并且仅执行一次连接。此外，可以对此类单表聚合物化视图执行优化，因此刷新非常有效。</p>
                        <div class="example" id="GUID-6516CC0D-1F11-4127-A497-114AD84128DF__GUID-35F7AA61-B4A1-4620-B7AA-B7E120FC012B">
                           <p class="titleinexample">示例5-5嵌套的物化视图</p>
                           <p>您可以在物化视图上创建嵌套的物化视图，但所有父物化和基本物化视图都必须包含连接或聚合。如果物化视图的定义查询不包含连接或聚合，则不能嵌套。定义了物化视图的所有底层对象（物化视图或表）必须具有物化视图日志。所有底层对象都被视为表格。此外，您可以使用物化视图的所有现有选项。</p>
                           <p>使用<code class="codeph">sh</code>示例模式中的表及其列，以下物化视图说明了如何创建嵌套的物化视图。
                           </p><pre class="oac_no_warn" dir="ltr">使用ROWID创建物料化视图登录销售;使用ROWID创建物料化视图登录客户;使用ROWID创建物料化视图日志; / *创建物化视图join_sales_cust_time，在COMMIT时间快速刷新* / CREATE MATERIALIZED VIEW join_sales_cust_time REFRESH FAST ON COMMIT AS SELECT c.cust_id，c.cust_last_name，s.amount_sold，t.time_id，t.day_number_in_week，s.rowid srid，t .rowid trid，c.rowid crid FROM sales s，customers c，times t WHERE s.time_id = t.time_id AND s.cust_id = c.cust_id;</pre><p>要在表<code class="codeph">join_sales_cust_time</code>上创建嵌套的<code class="codeph">join_sales_cust_time</code>化视图<span class="italic">，</span>您必须在表上创建<code class="codeph">join_sales_cust_time</code>化视图日志。因为这将是<code class="codeph">join_sales_cust_time</code>上的单表聚合物化视图， <code class="codeph">join_sales_cust_time</code>必须记录所有必需的列并使用<code class="codeph">INCLUDING</code> <code class="codeph">NEW</code> <code class="codeph">VALUES</code>子句。
                           </p><pre class="oac_no_warn" dir="ltr">/ *在join_sales_cust_time上创建物化视图日志* / CREATE MATERIALIZED VIEW LOG ON join_sales_cust_time WITH ROWID（cust_last_name，day_number_in_week，amount_sold）包括新值; / *在join_sales_cust_time上创建单表聚合物化视图sum_sales_cust_time，在COMMIT时间快速刷新* / CREATE MATERIALIZED VIEW sum_sales_cust_time REFRESH FAST ON COMMIT AS SELECT COUNT（*）cnt_all，SUM（amount_sold）sum_sales，COUNT（amount_sold）cnt_sales，cust_last_name ，day_number_in_week FROM join_sales_cust_time GROUP BY cust_last_name，day_number_in_week;</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="DWHSG8187"></a><div class="props_rev_3"><a id="GUID-179C8C8A-585B-49E6-8970-09396DB53DE3" name="GUID-179C8C8A-585B-49E6-8970-09396DB53DE3"></a><h5 id="DWHSG-GUID-179C8C8A-585B-49E6-8970-09396DB53DE3" class="sect5"><span class="enumeration_section">5.2.3.2</span>关于使用联接和聚合嵌套物化视图</h5>
                     <div>
                        <p>某些类型的嵌套物化视图无法快速刷新。使用<code class="codeph">EXPLAIN_MVIEW</code>识别这些类型的物化视图。您可以通过使用<code class="codeph">DBMS_MVIEW.REFRESH</code>参数指定<code class="codeph">nested = TRUE</code>参数，以适当的依赖关系顺序刷新嵌套的<code class="codeph">DBMS_MVIEW.REFRESH</code>化视图树。例如，如果调用<code class="codeph">DBMS_MVIEW.REFRESH ('SUM_SALES_CUST_TIME', nested =&gt; TRUE)</code> ，则<code class="codeph">REFRESH</code>过程将首先刷新<code class="codeph">join_sales_cust_time</code>化视图，然后刷新<code class="codeph">sum_sales_cust_time</code>化视图。
                        </p>
                     </div>
                  </div><a id="DWHSG8188"></a><div class="props_rev_3"><a id="GUID-8B2C0915-2FC8-4866-BDF7-7F74ABDC1D5D" name="GUID-8B2C0915-2FC8-4866-BDF7-7F74ABDC1D5D"></a><h5 id="DWHSG-GUID-8B2C0915-2FC8-4866-BDF7-7F74ABDC1D5D" class="sect5"><span class="enumeration_section">5.2.3.3</span>嵌套的物化视图使用指南</h5>
                     <div>
                        <p>在决定是否使用嵌套的物化视图时，请记住以下几点：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>如果要使用快速刷新，则应快速刷新任何链上的所有物化视图。</p>
                           </li>
                           <li>
                              <p>如果希望最高级别的物化视图相对于详细信息表是新鲜的，则必须确保在刷新最高级别之前，以正确的依赖关系顺序刷新树中的所有实例化视图。您可以使用<code class="codeph">nested = TRUE</code>参数自动刷新嵌套层次结构中的中间物化视图，如<span class="q">“ <a href="basic-materialized-views.html#GUID-179C8C8A-585B-49E6-8970-09396DB53DE3">关于使用联接和聚合嵌套物化视图</a> ”中所述</span> 。如果未指定<code class="codeph">nested = TRUE</code>且最高级别物化视图下的物化视图已过时，则仅刷新最高级别将成功，但仅使其基础物化视图更新，而不是树的基础。
                              </p>
                           </li>
                           <li>
                              <p>刷新实例化视图时，必须确保刷新树中的所有实例化视图。如果仅刷新最高级别的物化视图，则其下的物化视图将过时，您必须明确刷新它们。如果使用<code class="codeph">REFRESH</code>过程并将<code class="codeph">nested</code>参数值设置为<code class="codeph">TRUE</code> ，则仅刷新树中指定的实例化视图及其子实例化视图，而不刷新其顶级实例化视图。如果要确保刷新树中的所有实例化视图，请使用<code class="codeph">REFRESH_DEPENDENT</code>过程并将嵌套参数值设置为<code class="codeph">TRUE</code> 。
                              </p>
                           </li>
                           <li>
                              <p>如果完全刷新是特定嵌套实体化视图支持的唯一刷新选项，则即使指定了快速刷新，也会执行完整刷新。</p>
                           </li>
                           <li>
                              <p>物化视图的新鲜度是相对于物化视图直接引用的对象计算的。当物化视图引用另一个物化视图时，最顶层物化视图的新鲜度是相对于它直接引用的物化视图中的更改计算的，而不是相对于它引用的物化视图引用的表中的更改。</p>
                           </li>
                        </ul>
                     </div>
                  </div><a id="DWHSG8189"></a><div class="props_rev_3"><a id="GUID-6DABD06E-555C-4C39-9DA5-7601E2464FDA" name="GUID-6DABD06E-555C-4C39-9DA5-7601E2464FDA"></a><h5 id="DWHSG-GUID-6DABD06E-555C-4C39-9DA5-7601E2464FDA" class="sect5"><span class="enumeration_section">5.2.3.4</span>使用嵌套物化视图时的限制</h5>
                     <div>
                        <div class="section">
                           <p><a id="d15276e2061" class="indexterm-anchor"></a><a id="d15276e2065" class="indexterm-anchor"></a>您无法在同一个表上同时创建实体化视图和预构建的实体化视图。例如，如果您的表<code class="codeph">costs</code>具有基于它的物化视图<code class="codeph">cost_mv</code> ，则无法在表<code class="codeph">costs</code>上创建预构建的物化视图。结果将使<code class="codeph">cost_mv</code>成为嵌套的物化视图，并且不支持此转换方法。
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div>
            </div><a id="DWHSG8190"></a><a id="DWHSG0083"></a><div class="props_rev_3"><a id="GUID-2FA7BA5F-8222-4DEE-87B3-54352CE95F52" name="GUID-2FA7BA5F-8222-4DEE-87B3-54352CE95F52"></a><h3 id="DWHSG-GUID-2FA7BA5F-8222-4DEE-87B3-54352CE95F52" class="sect3"><span class="enumeration_section">5.3</span>创建物化视图</h3>
               <div>
                  <p>可以使用<code class="codeph">CREATE</code> <code class="codeph">MATERIALIZED</code> <code class="codeph">VIEW</code>语句或使用Enterprise Manager <code class="codeph">CREATE</code> <code class="codeph">MATERIALIZED</code> <code class="codeph">VIEW</code> 。
                  </p>
                  <div class="section">
                     <p>在数据仓库中已经创建了汇总表或聚合表并不常见，您可能不希望通过构建新的物化视图来重复此工作。在这种情况下，数据库中已存在的表可以注册为<a id="d15276e2126" class="indexterm-anchor"></a><a id="d15276e2128" class="indexterm-anchor"></a>预建的物化视图。<span class="q">“ <a href="basic-materialized-views.html#GUID-4DE39B8B-8452-4581-A841-6AF77019986D">注册现有物化视图</a> ”中</span>描述了此技术。
                     </p>
                     <p>选择要创建的实例化视图后，请对每个实例化视图执行以下步骤。</p>
                     <ol>
                        <li>
                           <p>设计物化视图。现有的用户定义的物化视图不需要此步骤。</p>
                           <p>如果物化视图包含许多行，则在适当的情况下，应对物化视图进行分区（如果可能），并且应与最大或最常更新的详细信息或事实表（如果可能）的分区相匹配。刷新性能受益于分区，因为它可以利用并行DML功能和可能的基于PCT的刷新。</p>
                        </li>
                        <li>
                           <p>使用<code class="codeph">CREATE</code> <code class="codeph">MATERIALIZED</code> <code class="codeph">VIEW</code>语句创建并可选地填充实例化视图。
                           </p>
                           <p>如果已存在用户定义的<code class="codeph">PREBUILT</code>化视图，则使用<code class="codeph">CREATE</code> <code class="codeph">MATERIALIZED</code> <code class="codeph">VIEW</code>语句中的<code class="codeph">ON</code> <code class="codeph">PREBUILT</code> <code class="codeph">TABLE</code>子句。否则，使用<code class="codeph">BUILD</code> <code class="codeph">IMMEDIATE</code>子句<code class="codeph">IMMEDIATE</code>填充<code class="codeph">BUILD</code>化视图，或使用<code class="codeph">BUILD</code> <code class="codeph">DEFERRED</code>子句稍后填充<code class="codeph">DEFERRED</code>化视图。如果已指定<code class="codeph">ENABLE</code> <code class="codeph">QUERY</code> <code class="codeph">REWRITE</code>子句，则禁用<code class="codeph">BUILD</code> <code class="codeph">DEFERRED</code>物化视图以供查询重写使用，直到第一个<code class="codeph">COMPLETE</code> <code class="codeph">REFRESH</code> ，然后自动启用它。
                           </p>
                        </li>
                     </ol>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-2FA7BA5F-8222-4DEE-87B3-54352CE95F52__I1006810">
                     <p class="titleinexample">示例5-6创建物化视图</p>
                     <p>此示例说明了如何创建名为<code class="codeph">cust_sales_mv</code>的物化视图。</p><pre class="oac_no_warn" dir="ltr">CREATE MATERIALIZED VIEW cust_sales_mv PCTFREE 0 TABLESPACE演示存储（初始8M）并行构建立即刷新完成启用QUERY REWRITE作为选择c.cust_last_name，SUM（amount_sold）AS sum_amount_sold FROM customers c，sales s WHERE s.cust_id = c.cust_id GROUP BY c .cust_last_name;</pre><div class="infoboxnotealso" id="GUID-2FA7BA5F-8222-4DEE-87B3-54352CE95F52__GUID-8A5A1CB4-A761-4E88-89DC-FA19D87F61CD">
                        <p class="notep1">也可以看看：</p>
                        <p>用于SQL语句描述的<a href="../sqlrf/CREATE-MATERIALIZED-VIEW.html#SQLRF01302" target="_blank"><span><cite>Oracle数据库SQL语言参考</cite></span></a> <code class="codeph">CREATE</code> <code class="codeph">MATERIALIZED</code> <code class="codeph">VIEW</code> ， <code class="codeph">ALTER</code> <code class="codeph">MATERIALIZED</code> <code class="codeph">VIEW</code>和<code class="codeph">DROP</code> <code class="codeph">MATERIALIZED</code> <code class="codeph">VIEW</code></p>
                     </div>
                  </div>
                  <!-- class="example" -->
               </div><a id="DWHSG00831"></a><div class="props_rev_3"><a id="GUID-701F4C59-4FA0-4CF4-B7B1-5AAA0A12515B" name="GUID-701F4C59-4FA0-4CF4-B7B1-5AAA0A12515B"></a><h4 id="DWHSG-GUID-701F4C59-4FA0-4CF4-B7B1-5AAA0A12515B" class="sect4"><span class="enumeration_section">5.3.1</span>使用列别名列表创建物化视图</h4>
                  <div>
                     <div class="section">
                        <p>目前，在创建实例化视图时，如果其定义查询在<code class="codeph">SELECT</code>列表中包含同名列，则需要通过为这些列指定唯一别名来解析名称冲突。否则， <code class="codeph">CREATE</code> <code class="codeph">MATERIALIZED</code> <code class="codeph">VIEW</code>语句将失败，并且会明确定义列的错误消息。但是，在<code class="codeph">SELECT</code>子句中附加别名以进行名称解析的标准方法限制了全文匹配查询重写的使用，并且仅当实例化视图的定义查询的文本和用户输入查询的文本相同时才会发生。因此，如果用户在物化视图的定义查询中指定了选择别名，而查询中没有别名，则全文匹配比较将失败。对于来自Discoverer的查询，这尤其是一个问题，它大量使用列别名。
                        </p>
                        <p>以下是该问题的示例。在<code class="codeph">SELECT</code>子句中使用列别名创建<code class="codeph">sales_mv</code> ，但输入查询<code class="codeph">Q1</code>没有别名。全文匹配重写失败。物化视图如下：</p><pre class="oac_no_warn" dir="ltr">CREATE MATERIALIZED VIEW sales_mv ENABLE QUERY REWRITE AS SELECT s.time_id sales_tid，c.time_id costs_tid FROM sales s，products p，costs c WHERE s.prod_id = p.prod_id AND c.prod_id = p.prod_id AND p.prod_name IN（SELECT prod_name FROM products）;</pre><p>输入查询语句<code class="codeph">Q1</code>如下：</p><pre class="oac_no_warn" dir="ltr">SELECT s.time_id，c1.time_id FROM sales s，products p，cost c1 WHERE s.prod_id = p.prod_id AND c1.prod_id = p.prod_id AND p.prod_name IN（SELECT prod_name FROM products）;</pre><p>尽管物化视图的定义查询几乎完全相同，并且在逻辑上等同于用户的输入查询，但由于全文匹配失败是一些查询的唯一重写可能性（例如， <code class="codeph">WHERE</code>的子查询），因此不会发生查询重写条款）。
                        </p>
                        <p>您可以将列别名列表添加到<code class="codeph">CREATE</code> <code class="codeph">MATERIALIZED</code> <code class="codeph">VIEW</code>语句中。列别名列表显式解决任何列名冲突，而不在<code class="codeph">SELECT</code>化视图的<code class="codeph">SELECT</code>子句中附加别名。以下示例说明了物化视图列别名列表的语法：</p><pre class="oac_no_warn" dir="ltr">CREATE MATERIALIZED VIEW sales_mv（sales_tid，costs_tid）ENABLE QUERY REWRITE AS SELECT s.time_id，c.time_id FROM sales s，products p，cost c WHERE s.prod_id = p.prod_id AND c.prod_id = p.prod_id AND p.prod_name IN（SELECT prod_name FROM products）;</pre><p>在此示例中， <code class="codeph">sales_mv</code>的定义查询现在与用户查询<code class="codeph">Q1</code>完全匹配，因此将进行全文匹配重写。
                        </p>
                        <p>请注意，当<code class="codeph">SELECT</code>子句和新别名列表子句中都指定了别名时，别名列表子句将取代<code class="codeph">SELECT</code>子句中的别名。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-BF609671-F8F4-48BE-A536-B50527C814F8" name="GUID-BF609671-F8F4-48BE-A536-B50527C814F8"></a><h4 id="DWHSG-GUID-BF609671-F8F4-48BE-A536-B50527C814F8" class="sect4"><span class="enumeration_section">5.3.2</span>基于Hybird分区表创建物化视图</h4>
                  <div>
                     <p>使用<code class="codeph">CREATE MATERIALIZED VIEW</code>语句创建基于混合分区表的物化视图。
                     </p>
                     <div class="section">
                        <p></p>
                        <p>在混合分区表中，一些分区存储在数据库段中，而其他分区存储在外部。如果基于混合分区表的实例化视图在其<code class="codeph">SELECT</code>语句中包含分区键或分区标记，则它满足PCT刷新的要求。
                        </p>
                        <p>要基于混合分区表创建实例化视图，请执行以下操作：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>创建混合分区表。</span><div>
                              <p>以下命令创建名为<code class="codeph">hybrid_sales</code>的混合分区表。
                              </p><pre class="pre codeblock"><code>CREATE TABLE hybrid_sales（time_id日期，客户编号，价格编号，......）...按范围划分（time_id）（PARTITION century_19值不到（TO_DATE（'01 -01-1900'，'DD-MM-YYYY'））外部位置（data_dir1：'sales_1.csv'），PARTITION century_20值少于（TO_DATE（'01 -01-2000'，'DD-MM-YYYY'））EXTERNAL DEFAULT DIRECTORY data_dir2 LOCATION（'sales_2.csv'），PARTITION year_2000价值不到（截止日期（'01 -01-2001'，'DD-MM-YYYY'）），分年year_2001价值不到（截止日期（'01 -01-2002'，'DD-MM-YYYY'））） ;</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>创建基于混合分区表的物化视图。</span><div> 
                              <p>以下命令创建一个名为<code class="codeph">hypt_mv</code>的物化视图，该视图基于混合分区表<code class="codeph">hybrid_sales</code> ：</p><pre class="pre codeblock"><code>创建物化视图HyPT_MV快速按需选择time_id，customer_no，sum（price）as total_price FROM hybrid_sales GROUP BY time_id，customer_no;</code></pre><p>假设表<code class="codeph">hybrid_sales</code>上有相应的物化视图日志。
                              </p>
                           </div>
                        </li>
                     </ol>
                  </div>
               </div><a id="DWHSG00832"></a><div class="props_rev_3"><a id="GUID-9C3332BB-53E2-4179-B05C-5C8D1E46EFDF" name="GUID-9C3332BB-53E2-4179-B05C-5C8D1E46EFDF"></a><h4 id="DWHSG-GUID-9C3332BB-53E2-4179-B05C-5C8D1E46EFDF" class="sect4"><span class="enumeration_section">5.3.3</span>关于物化视图名称</h4>
                  <div>
                     <p><a id="d15276e2446" class="indexterm-anchor"></a>物化视图的名称必须符合标准Oracle命名约定。但是，如果物化视图基于用户定义的预构建表，则物化视图的名称必须与该表名完全匹配。
                     </p>
                     <p>如果已经有表和索引的命名约定，则可以考虑将此命名方案扩展到实例化视图，以便可以轻松识别它们。例如，不是命名物化视图<code class="codeph">sum_of_sales</code> ，而是可以将其称为<code class="codeph">sum_of_sales_mv</code>以表示这是物化视图而不是表或视图。
                     </p>
                  </div>
               </div><a id="DWHSG00833"></a><div class="props_rev_3"><a id="GUID-E75B9A93-BEFB-42A7-B9CB-38FA48EBB266" name="GUID-E75B9A93-BEFB-42A7-B9CB-38FA48EBB266"></a><h4 id="DWHSG-GUID-E75B9A93-BEFB-42A7-B9CB-38FA48EBB266" class="sect4"><span class="enumeration_section">5.3.4</span>物化视图的存储和表压缩</h4>
                  <div>
                     <p><a id="d15276e2480" class="indexterm-anchor"></a>除非物化视图基于<a id="d15276e2485" class="indexterm-anchor"></a><a id="d15276e2489" class="indexterm-anchor"></a><a id="d15276e2493" class="indexterm-anchor"></a><a id="d15276e2497" class="indexterm-anchor"></a>用户定义的预构建表，它需要并占用数据库内的存储空间。因此，物化视图的存储需求应根据其所在的表空间和扩展区的大小来指定。
                     </p>
                     <p>如果您不知道<code class="codeph">DBMS_MVIEW.ESTIMATE_MVIEW_SIZE</code>化视图需要多少空间，则<code class="codeph">DBMS_MVIEW.ESTIMATE_MVIEW_SIZE</code>包可以估计存储此未压缩<code class="codeph">DBMS_MVIEW.ESTIMATE_MVIEW_SIZE</code>化视图所需的字节数。然后，此信息可以帮助设计团队确定实体化视图应驻留的表空间。
                     </p>
                     <p>您应该使用具有高度冗余数据的表压缩，例如具有许多外键的表。这对使用<code class="codeph">ROLLUP</code>子句创建的物化视图特别有用。表压缩减少了磁盘使用和内存使用（特别是缓冲区缓存），通常可以为只读操作带来更好的扩展。表压缩还可以加快查询执行速度，但代价是更新成本。
                     </p>
                     <div class="infoboxnotealso" id="GUID-E75B9A93-BEFB-42A7-B9CB-38FA48EBB266__GUID-8064D264-5A74-4998-8014-2FA55C22CF2C">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>有关表压缩的详细信息<a href="../vldbg/partition-availability.html#VLDBG004" target="_blank"><span><cite>，请参见“Oracle数据库VLDB和分区指南”</cite></span></a></p>
                           </li>
                           <li>
                              <p>有关表压缩的详细信息，请参见<a href="../admin/managing-tables.html#ADMIN13948" target="_blank"><span><cite>“Oracle数据库管理员指南”</cite></span></a></p>
                           </li>
                           <li>
                              <p>有关<code class="codeph">STORAGE</code>语义的完整说明，请<a href="../sqlrf/SQL-Statements-MERGE-to-UPDATE.html#SQLRF017" target="_blank"><span><cite>参见Oracle数据库SQL语言参考</cite></span></a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="DWHSG8192"></a><a id="DWHSG8191"></a><div class="props_rev_3"><a id="GUID-43C2E761-7188-43F6-9678-A80098C1D521" name="GUID-43C2E761-7188-43F6-9678-A80098C1D521"></a><h4 id="DWHSG-GUID-43C2E761-7188-43F6-9678-A80098C1D521" class="sect4"><span class="enumeration_section">5.3.5</span>关于物化视图的构建方法</h4>
                  <div>
                     <p><a id="d15276e2564" class="indexterm-anchor"></a><a id="d15276e2568" class="indexterm-anchor"></a>有两种构建方法可用于创建物化视图，如<a href="basic-materialized-views.html#GUID-43C2E761-7188-43F6-9678-A80098C1D521__G1014320" title="构建方法">表5-2</a>所示。如果选择<code class="codeph">BUILD</code> <code class="codeph">IMMEDIATE</code> ，则将物化视图定义添加到数据字典中的模式对象，然后根据<code class="codeph">SELECT</code>表达式扫描事实或详细信息表，并将结果存储在物化视图中。根据要扫描的表的大小，此构建过程可能需要相当长的时间。
                     </p>
                     <p>另一种方法是使用<code class="codeph">BUILD</code> <code class="codeph">DEFERRED</code>子句，该子句创建没有数据的物化视图，从而可以使用<code class="codeph">DBMS_MVIEW.REFRESH</code>包在以后填充它。
                     </p>
                     <div class="infoboxnotealso" id="GUID-43C2E761-7188-43F6-9678-A80098C1D521__GUID-5E1CF3BB-027B-4851-BFB2-7B0223F2D0A5">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="refreshing-materialized-views.html#GUID-64068234-BDB0-4C12-AE70-75571046A586" title="每次在任何物化视图的基表上执行DML操作时，都会自动刷新使用ON STATEMENT刷新模式的物化视图。Oracle数据库对使用近似查询定义的物化视图执行快速刷新。在使用DBMS_REDEFINITION包在线重新定义表时，可以执行依赖于正在重新定义的表的快速可刷新实体化视图的增量刷新。您可以使用完整，快速或PCT刷新方法刷新基于混合分区表的实例化视图。">刷新物化视图</a></p>
                     </div>
                     <div class="tblformal" id="GUID-43C2E761-7188-43F6-9678-A80098C1D521__G1014320">
                        <p class="titleintable">表5-2构建方法</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="构建方法" width="100%" border="1" summary="Build Methods" frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="23%" id="d15276e2620">构建方法</th>
                                 <th align="left" valign="bottom" width="77%" id="d15276e2623">描述</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="23%" id="d15276e2628" headers="d15276e2620 ">
                                    <p><code class="codeph">BUILD</code> <code class="codeph">IMMEDIATE</code></p>
                                 </td>
                                 <td align="left" valign="top" width="77%" headers="d15276e2628 d15276e2623 ">
                                    <p>创建实体化视图，然后使用数据填充它。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="23%" id="d15276e2639" headers="d15276e2620 ">
                                    <p><code class="codeph">BUILD</code> <code class="codeph">DEFERRED</code></p>
                                 </td>
                                 <td align="left" valign="top" width="77%" headers="d15276e2639 d15276e2623 ">
                                    <p>创建物化视图定义，但不要用数据填充它。</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div>
               </div><a id="DWHSG8193"></a><div class="props_rev_3"><a id="GUID-AC92B31A-C6B0-45AE-95A6-B1DE3630EB8A" name="GUID-AC92B31A-C6B0-45AE-95A6-B1DE3630EB8A"></a><h4 id="DWHSG-GUID-AC92B31A-C6B0-45AE-95A6-B1DE3630EB8A" class="sect4"><span class="enumeration_section">5.3.6</span>关于为物化视图启用查询重写</h4>
                  <div>
                     <p>之前<a id="d15276e2671" class="indexterm-anchor"></a>创建物化视图，您可以通过调用过程<code class="codeph">DBMS_MVIEW.EXPLAIN_MVIEW</code>来验证哪些类型的查询重写是可能的，或者使用<code class="codeph">DBMS_ADVISOR.TUNE_MVIEW</code>来优化物化视图，以便可以进行多种类型的查询重写。创建<code class="codeph">DBMS_MVIEW.EXPLAIN_REWRITE</code>化视图后，您可以使用<code class="codeph">DBMS_MVIEW.EXPLAIN_REWRITE</code>来查明是否（或为什么不）重写特定查询。
                     </p>
                     <p>即使定义了物化视图，查询重写工具也不会自动使用它。即使默认情况下启用了查询重写，如果要将<code class="codeph">REWRITE</code>化视图用于重写查询，也必须指定<code class="codeph">ENABLE</code> <code class="codeph">QUERY</code> <code class="codeph">REWRITE</code>子句。
                     </p>
                     <p>如果在创建<code class="codeph">REWRITE</code>化视图时省略此子句或将其指定为<code class="codeph">DISABLE</code> <code class="codeph">QUERY</code> <code class="codeph">REWRITE</code> ，则随后可以使用<code class="codeph">ALTER</code> <code class="codeph">MATERIALIZED</code> <code class="codeph">VIEW</code>语句启用<code class="codeph">REWRITE</code>化视图以进行查询重写。
                     </p>
                     <p>如果将<code class="codeph">BUILD</code>化视图定义为<code class="codeph">BUILD</code> <code class="codeph">DEFERRED</code> ，则在通过完整刷新填充数据之前，它不符合查询重写的条件。
                     </p>
                  </div>
               </div><a id="DWHSG8194"></a><div class="props_rev_3"><a id="GUID-580EF7BC-4C61-4030-B42D-BFF47469C1E6" name="GUID-580EF7BC-4C61-4030-B42D-BFF47469C1E6"></a><h4 id="DWHSG-GUID-580EF7BC-4C61-4030-B42D-BFF47469C1E6" class="sect4"><span class="enumeration_section">5.3.7</span>关于查询重写限制</h4>
                  <div>
                     <div class="section">
                        <p><a id="d15276e2747" class="indexterm-anchor"></a><a id="d15276e2751" class="indexterm-anchor"></a><a id="d15276e2757" class="indexterm-anchor"></a><a id="d15276e2763" class="indexterm-anchor"></a>所有物化视图都无法进行查询重写。如果在预期时未发生查询重写，则<code class="codeph">DBMS_MVIEW.EXPLAIN_REWRITE</code>可以帮助提供特定查询不符合重写条件的原因。如果这表明不是所有类型的查询重写都是可能的，请使用过程<code class="codeph">DBMS_ADVISOR.TUNE_MVIEW</code>来查看是否可以以不同方式定义<code class="codeph">DBMS_ADVISOR.TUNE_MVIEW</code>化视图，以便可以进行查询重写。另外，检查物化视图是否满足以下所有条件：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="basic-materialized-views.html#GUID-6A80266B-444E-4BB6-8A48-911E4619338B">关于查询重写的物化视图限制</a></p>
                           </li>
                           <li>
                              <p><a href="basic-materialized-views.html#GUID-A5409962-E85D-46DD-B34A-820074CA579C">一般查询重写限制</a></p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div><a id="DWHSG8195"></a><div class="props_rev_3"><a id="GUID-6A80266B-444E-4BB6-8A48-911E4619338B" name="GUID-6A80266B-444E-4BB6-8A48-911E4619338B"></a><h5 id="DWHSG-GUID-6A80266B-444E-4BB6-8A48-911E4619338B" class="sect5"><span class="enumeration_section">5.3.7.1</span>关于查询重写的物化视图限制</h5>
                     <div>
                        <div class="section">
                           <p>您应该记住以下限制：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>物化视图的定义查询不能包含任何不可重复的表达式（ <code class="codeph">ROWNUM</code> ， <code class="codeph">SYSDATE</code> ，不可重复的PL / SQL函数等）。
                                 </p>
                              </li>
                              <li>
                                 <p>查询不能包含对<code class="codeph">LONG</code>或<code class="codeph">LONG</code> <code class="codeph">RAW</code>数据类型或对象<code class="codeph">REF</code>的任何引用。
                                 </p>
                              </li>
                              <li>
                                 <p>如果物化视图已注册为<code class="codeph">PREBUILT</code> ，则列的精度必须与相应<code class="codeph">SELECT</code>表达式的精度一致，除非被<code class="codeph">WITH</code> <code class="codeph">REDUCED</code> <code class="codeph">PRECISION</code>子句覆盖。
                                 </p>
                              </li>
                              <li>
                                 <p>定义查询不能包含对对象或<code class="codeph">XMLTYPE</code>的任何引用。
                                 </p>
                              </li>
                              <li>
                                 <p>物化视图是一个非专用对象，除非提及要在其中解析已编辑对象名称的评估版，否则不能依赖于已编辑的对象。</p>
                              </li>
                              <li>
                                 <p>物化视图可能仅适用于特定版本范围内的查询重写。<code class="codeph">CREATE</code>或<code class="codeph">ALTER</code> <code class="codeph">MATERIALIZED</code> <code class="codeph">VIEW</code>语句中的<span class="italic"><code class="codeph">query_rewrite_clause</code></span>允许您指定<span class="italic"><code class="codeph">query_rewrite_clause</code></span>化视图符合查询重写条件的版本范围。
                                 </p>
                              </li>
                           </ul>
                           <div class="infoboxnotealso" id="GUID-6A80266B-444E-4BB6-8A48-911E4619338B__GUID-322BC2A6-F960-45EF-80BC-5CD0DD7B7C41">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><a href="advanced-query-rewrite-materialized-views.html#GUID-0906CA6B-7EE3-42E1-A598-C6541BCD9B36" title="查询重写认为混合分区表中的外部分区具有UNKNOWN新鲜度。因此，当查询从一个或多个外部分区请求数据时，它只能在TRUSTED或STALE_TOLERATED完整性模式下重写。如果可以使用物化视图回答这些查询，则会自动重写包含返回近似结果的SQL函数的查询以使用匹配的物化视图。可以重写对整数列包含COUNT（DISTINCT）操作的查询，以使用包含基于位图的函数的实体化视图。">物化视图的高级查询重写</a></p>
                                 </li>
                                 <li>
                                    <p><a href="../sqlrf/CREATE-MATERIALIZED-VIEW.html#SQLRF54175" target="_blank"><span class="italic">Oracle数据库SQL语言参考</span></a></p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="DWHSG8196"></a><div class="props_rev_3"><a id="GUID-A5409962-E85D-46DD-B34A-820074CA579C" name="GUID-A5409962-E85D-46DD-B34A-820074CA579C"></a><h5 id="DWHSG-GUID-A5409962-E85D-46DD-B34A-820074CA579C" class="sect5"><span class="enumeration_section">5.3.7.2</span>一般查询重写限制</h5>
                     <div>
                        <div class="section">
                           <p>您应该记住以下限制：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>查询可以引用本地和远程表。只要引用相同表的符合条件的物化视图在本地可用，就可以重写此类查询。</p>
                              </li>
                              <li>
                                 <p><code class="codeph">SYS</code>不能拥有详细信息表和物化视图。</p>
                              </li>
                              <li>
                                 <p>如果<code class="codeph">BY</code>化视图的<code class="codeph">GROUP</code> <code class="codeph">BY</code>子句中存在列或表达式，则它也必须存在于<code class="codeph">SELECT</code>列表中。
                                 </p>
                              </li>
                              <li>
                                 <p>聚合函数必须仅作为表达式的最外层部分发生。也就是说，不允许诸如<code class="codeph">AVG(AVG(x))</code>或<code class="codeph">AVG(x)</code> + <code class="codeph">AVG(x)</code>聚合。
                                 </p>
                              </li>
                              <li>
                                 <p>不允许使用<code class="codeph">CONNECT</code> <code class="codeph">BY</code>子句。
                                 </p>
                              </li>
                           </ul>
                           <div class="infoboxnotealso" id="GUID-A5409962-E85D-46DD-B34A-820074CA579C__GUID-1AFBC5C0-2A4A-48AD-A8FB-90BEBE472A2E">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><a href="advanced-query-rewrite-materialized-views.html#GUID-0906CA6B-7EE3-42E1-A598-C6541BCD9B36" title="查询重写认为混合分区表中的外部分区具有UNKNOWN新鲜度。因此，当查询从一个或多个外部分区请求数据时，它只能在TRUSTED或STALE_TOLERATED完整性模式下重写。如果可以使用物化视图回答这些查询，则会自动重写包含返回近似结果的SQL函数的查询以使用匹配的物化视图。可以重写对整数列包含COUNT（DISTINCT）操作的查询，以使用包含基于位图的函数的实体化视图。">物化视图的高级查询重写</a></p>
                                 </li>
                                 <li>
                                    <p><a href="../sqlrf/CREATE-MATERIALIZED-VIEW.html#SQLRF54175" target="_blank"><span><cite>Oracle数据库SQL语言参考</cite></span></a></p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div><a id="DWHSG8197"></a><div class="props_rev_3"><a id="GUID-11109A1B-1E8A-4F10-9BB3-DEB4D1AAEC36" name="GUID-11109A1B-1E8A-4F10-9BB3-DEB4D1AAEC36"></a><h4 id="DWHSG-GUID-11109A1B-1E8A-4F10-9BB3-DEB4D1AAEC36" class="sect4"><span class="enumeration_section">5.3.8</span>关于物化视图的刷新选项</h4>
                  <div>
                     <p><a id="d15276e3035" class="indexterm-anchor"></a>定义实例化视图时，可以指定三个刷新选项：如何刷新，使用何种类型的刷新以及可信任的约束。如果未指定，则默认值分别假定为<code class="codeph">ON</code> <code class="codeph">DEMAND</code> ， <code class="codeph">FORCE</code>和<code class="codeph">ENFORCED</code>约束。
                     </p>
                     <div class="infoboxnotealso" id="GUID-11109A1B-1E8A-4F10-9BB3-DEB4D1AAEC36__GUID-4C2B1E31-6F24-46C2-A292-FB3ADBEB0CCE">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="basic-materialized-views.html#GUID-6BE42145-3DD1-4F39-B417-E26C81F5682D">关于物化视图的刷新模式</a></p>
                           </li>
                           <li>
                              <p><a href="basic-materialized-views.html#GUID-36A4A15D-4CAC-496C-95AD-EF36B9B645F5">关于物化视图刷新的类型</a></p>
                           </li>
                           <li>
                              <p><a href="basic-materialized-views.html#GUID-B9F8853B-5C0B-4C7A-AB03-CE3D29814A82">关于使用受信任的约束和物化视图刷新</a></p>
                           </li>
                        </ul>
                     </div>
                  </div><a id="DWHSG8198"></a><div class="props_rev_3"><a id="GUID-6BE42145-3DD1-4F39-B417-E26C81F5682D" name="GUID-6BE42145-3DD1-4F39-B417-E26C81F5682D"></a><h5 id="DWHSG-GUID-6BE42145-3DD1-4F39-B417-E26C81F5682D" class="sect5"><span class="enumeration_section">5.3.8.1</span>关于物化视图的刷新模式</h5>
                     <div>
                        <p>刷新执行模式为<code class="codeph">ON COMMIT</code> ， <code class="codeph">ON DEMAND</code>和<code class="codeph">ON STATEMENT</code> 。根据您创建的物化视图，某些选项可能不可用。<a href="basic-materialized-views.html#GUID-6BE42145-3DD1-4F39-B417-E26C81F5682D__G1014263" title="此表描述了物化视图支持的刷新模式。">表5-3</a>介绍了刷新模式。
                        </p>
                        <p></p>
                        <div class="tblformal" id="GUID-6BE42145-3DD1-4F39-B417-E26C81F5682D__G1014263">
                           <p class="titleintable">表5-3刷新模式</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="刷新模式" width="100%" border="1" summary="This table describes the refresh modes supported for materialized views." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="20%" id="d15276e3124">刷新模式</th>
                                    <th align="left" valign="bottom" width="80%" id="d15276e3127">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d15276e3132" headers="d15276e3124 ">
                                       <p><code class="codeph">ON COMMIT</code></p>
                                    </td>
                                    <td align="left" valign="top" width="80%" headers="d15276e3132 d15276e3127 ">
                                       <p>当修改其中一个物化视图的详细信息表的事务提交时，将自动刷新。只要物化视图可快速刷新（换句话说，不复杂），就可以指定此项。使用此模式需要<code class="codeph">ON</code> <code class="codeph">COMMIT</code>权限。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d15276e3146" headers="d15276e3124 ">
                                       <p><code class="codeph">一经请求</code></p>
                                    </td>
                                    <td align="left" valign="top" width="80%" headers="d15276e3146 d15276e3127 ">
                                       <p>当用户手动执行<code class="codeph">DBMS_MVIEW</code>包（ <code class="codeph">REFRESH</code> ， <code class="codeph">REFRESH_ALL_MVIEWS</code> ， <code class="codeph">REFRESH_DEPENDENT</code> ）中包含的可用刷新过程之一时，会发生刷新。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d15276e3166" headers="d15276e3124 ">
                                       <p><code class="codeph">声明</code></p>
                                    </td>
                                    <td align="left" valign="top" width="80%" headers="d15276e3166 d15276e3127 ">
                                       <p>当在任何物化视图的基表上执行DML操作时，刷新自动发生，无需提交事务。此方法不需要在物化视图的基表上创建物化视图日志。只要物化视图可快速刷新，就可以使用此模式。</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                        <p>使用<code class="codeph">ON STATEMENT</code>或<code class="codeph">ON COMMIT</code>方法时，完成DML或提交的时间可能比平时略长。这是因为刷新操作是作为DML的一部分（用于<code class="codeph">ON STATEMENT</code>刷新）或作为提交的一部分（用于<code class="codeph">ON COMMIT</code>刷新）执行的。因此，如果许多用户同时改变物化视图所基于的表，则这些方法可能不合适。
                        </p>
                        <p>如果您预期对物化视图引用的表执行插入，更新或删除操作，同时刷新该物化视图，并且该物化视图包括连接和聚合，Oracle建议您使用<code class="codeph">ON COMMIT</code>快速刷新而不是<code class="codeph">ON DEMAND</code>快速刷新。
                        </p>
                        <p>如果您认为物化视图未刷新，请检查警报日志或跟踪文件。</p>
                        <p>如果在DML或提交时刷新期间物化视图失败，则必须在解决跟踪文件中指定的错误后使用<code class="codeph">DBMS_MVIEW</code>包显式调用刷新过程。在此之前，物化视图将不再在提交时自动刷新。
                        </p>
                     </div>
                  </div><a id="DWHSG8199"></a><div class="props_rev_3"><a id="GUID-36A4A15D-4CAC-496C-95AD-EF36B9B645F5" name="GUID-36A4A15D-4CAC-496C-95AD-EF36B9B645F5"></a><h5 id="DWHSG-GUID-36A4A15D-4CAC-496C-95AD-EF36B9B645F5" class="sect5"><span class="enumeration_section">5.3.8.2</span>关于物化视图刷新的类型</h5>
                     <div>
                        <p>您可以通过选择以下四个选项之一来指定从详细信息表中刷新实例化视图的方式： <code class="codeph">COMPLETE</code> ， <code class="codeph">FAST</code> ， <code class="codeph">FORCE</code>和<code class="codeph">NEVER</code> 。 <a href="basic-materialized-views.html#GUID-36A4A15D-4CAC-496C-95AD-EF36B9B645F5__G1014333" title="此表描述了物化视图支持的刷新选项。">表5-4说明</a>了刷新选项。
                        </p>
                        <div class="tblformal" id="GUID-36A4A15D-4CAC-496C-95AD-EF36B9B645F5__G1014333">
                           <p class="titleintable">表5-4刷新选项</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="刷新选项" width="100%" border="1" summary="This table describes the refresh options supported for materialized views." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="20%" id="d15276e3257">刷新选项</th>
                                    <th align="left" valign="bottom" width="80%" id="d15276e3260">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d15276e3265" headers="d15276e3257 ">
                                       <p><code class="codeph">完成</code></p>
                                    </td>
                                    <td align="left" valign="top" width="80%" headers="d15276e3265 d15276e3260 ">
                                       <p>通过重新计算实体化视图的定义查询来刷新。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d15276e3273" headers="d15276e3257 ">
                                       <p><code class="codeph">快速</code></p>
                                    </td>
                                    <td align="left" valign="top" width="80%" headers="d15276e3273 d15276e3260 ">
                                       <p>使用物化视图日志中记录的信息或SQL * Loader直接路径或分区维护操作，应用增量更改以刷新物化视图。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d15276e3281" headers="d15276e3257 ">
                                       <p><code class="codeph">力</code></p>
                                    </td>
                                    <td align="left" valign="top" width="80%" headers="d15276e3281 d15276e3260 ">
                                       <p>如果可能，应用<code class="codeph">FAST</code>刷新;否则，它应用<code class="codeph">COMPLETE</code>刷新。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d15276e3295" headers="d15276e3257 ">
                                       <p><code class="codeph">决不</code></p>
                                    </td>
                                    <td align="left" valign="top" width="80%" headers="d15276e3295 d15276e3260 ">
                                       <p>指示不会使用刷新机制刷新实例化视图。</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                        <p>快速刷新选项是否可用取决于物化视图的类型。您可以调用过程<code class="codeph">DBMS_MVIEW.EXPLAIN_MVIEW</code>来确定是否可以进行快速刷新。
                        </p>
                     </div>
                  </div><a id="DWHSG8200"></a><div class="props_rev_3"><a id="GUID-B9F8853B-5C0B-4C7A-AB03-CE3D29814A82" name="GUID-B9F8853B-5C0B-4C7A-AB03-CE3D29814A82"></a><h5 id="DWHSG-GUID-B9F8853B-5C0B-4C7A-AB03-CE3D29814A82" class="sect5"><span class="enumeration_section">5.3.8.3</span>关于使用受信任约束和物化视图刷新</h5>
                     <div>
                        <p>您还可以指定在刷新期间是否可以使用受信任的约束和<code class="codeph">QUERY_REWRITE_INTEGRITY = TRUSTED</code> 。任何未经验证的<code class="codeph">RELY</code>约束都是受信任的约束。例如，未经验证的外键/主键关系，维度中定义的功能依赖关系或<code class="codeph">UNKNOWN</code>状态中的物化视图。如果在刷新期间启用了查询重写，则可以通过启用更高性能的查询重写来提高刷新性能。可以使用<code class="codeph">TRUSTED</code>约束进行刷新的任何物化视图在刷新后都处于可信新鲜状态（ <code class="codeph">UNKNOWN</code>状态）。
                        </p>
                        <p>这反映在列<code class="codeph">STALENESS</code>在视图<code class="codeph">USER_MVIEWS</code> 。同一视图中的<code class="codeph">UNKNOWN_TRUSTED_FD</code>列也设置为<code class="codeph">Y</code> ，表示是。
                        </p>
                        <p>您可以在创建时通过指定<code class="codeph">REFRESH USING TRUSTED [ENFORCED] CONSTRAINTS</code>或使用<code class="codeph">ALTER MATERIALIZED VIEW</code> DDL来定义物化视图的此属性。</p>
                        <div class="tblformal" id="GUID-B9F8853B-5C0B-4C7A-AB03-CE3D29814A82__GUID-5B66D2E9-33C3-44FF-A0AD-9821B1A82354">
                           <p class="titleintable">表5-5约束</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="约束" width="100%" border="1" summary="This table describes the options for using constraints with materialized views." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="20%" id="d15276e3377">使用限制</th>
                                    <th align="left" valign="bottom" width="80%" id="d15276e3380">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d15276e3385" headers="d15276e3377 "><pre class="oac_no_warn" dir="ltr">受信任的约束</pre></td>
                                    <td align="left" valign="top" width="80%" headers="d15276e3385 d15276e3380 ">
                                       <p>刷新期间，Refresh可以使用受信任的约束和<code class="codeph">QUERY_REWRITE_INTEGRITY</code> <code class="codeph">= TRUSTED</code> 。这允许使用未经验证的<code class="codeph">RELY</code>约束，并在刷新期间以<code class="codeph">UNKNOWN</code>或<code class="codeph">FRESH</code>状态重写物化视图。
                                       </p>
                                       <p><code class="codeph">USING TRUSTED CONSTRAINTS</code>子句使您能够在表上具有非NULL虚拟专用数据库（VPD）策略的物化视图。在这种情况下，请确保实体化视图正常运行。物化视图结果基于VPD策略过滤的行和列计算。因此，您必须使用VPD策略协调物化视图定义，以确保正确的结果。如果没有<code class="codeph">USING TRUSTED CONSTRAINTS</code>子句，基表上的任何VPD策略都将阻止创建<code class="codeph">USING TRUSTED CONSTRAINTS</code>化视图。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d15276e3415" headers="d15276e3377 "><pre class="oac_no_warn" dir="ltr">强制约束</pre></td>
                                    <td align="left" valign="top" width="80%" headers="d15276e3415 d15276e3380 ">
                                       <p>刷新时可以使用经过验证的约束和<code class="codeph">QUERY_REWRITE_INTEGRITY = ENFORCED</code> 。这允许在刷新期间仅使用经过验证的强制约束并对<code class="codeph">FRESH</code>状态中的物化视图进行重写。
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                        <p>使用连接列上的可用主键和外键约束来优化物化视图的快速刷新。此外键/主键优化可以显着提高刷新性能。例如，对于包含事实表和维度表之间的连接的物化视图，如果仅在维度表中插入新行而自上次刷新后没有更改事实表，则无需刷新任何内容这种物化观点。原因是，由于维度表的连接列上的主键约束和事实表的连接列上的外键约束，插入维度表的新行将不会与任何事实表行，因此没有什么可刷新的。此刷新优化的另一个示例是自上次刷新以来事实和维度表都具有插入。在这种情况下，Oracle数据库将仅执行delta事实表与维度表的连接。如果没有外键/主键优化，则需要刷新期间的两个连接，delta事实与维度表的连接，以及delta维度与插入之前的事实表的图像的连接。</p>
                        <p>请注意，使用和不使用约束实施时，可以使用对连接列使用主键和外键约束的此优化快速刷新。在第一种情况下，主数据库和外键约束由Oracle数据库强制执行。然而，这会导致约束维护的成本。在第二种情况下，应用程序保证主键和外键关系，因此约束声明为<code class="codeph">RELY NOVALIDATE</code> ，物化视图<code class="codeph">REFRESH FAST USING TRUSTED CONSTRAINTS</code>选项定义。
                        </p>
                     </div>
                  </div><a id="DWHSG8201"></a><div class="props_rev_3"><a id="GUID-505C24CF-5D56-4820-88AA-2221410950E7" name="GUID-505C24CF-5D56-4820-88AA-2221410950E7"></a><h5 id="DWHSG-GUID-505C24CF-5D56-4820-88AA-2221410950E7" class="sect5"><span class="enumeration_section">5.3.8.4</span>快速刷新的一般限制</h5>
                     <div>
                        <div class="section">
                           <p>物化视图的定义查询限制如下：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>物化视图不得包含对非重复表达式（如<code class="codeph">SYSDATE</code>和<code class="codeph">ROWNUM</code>引用。</p>
                              </li>
                              <li>
                                 <p>物化视图不得包含对<code class="codeph">RAW</code>或<code class="codeph">LONG</code> <code class="codeph">RAW</code>数据类型的引用。
                                 </p>
                              </li>
                              <li>
                                 <p>它不能包含<code class="codeph">SELECT</code>列表子查询。
                                 </p>
                              </li>
                              <li>
                                 <p>它不能在<code class="codeph">SELECT</code>子句中包含分析函数（例如， <code class="codeph">RANK</code> ）。
                                 </p>
                              </li>
                              <li>
                                 <p>它不能引用定义了<code class="codeph">XMLIndex</code>索引的表。
                                 </p>
                              </li>
                              <li>
                                 <p>它不能包含<code class="codeph">MODEL</code>子句。
                                 </p>
                              </li>
                              <li>
                                 <p>它不能包含<code class="codeph">HAVING</code>查询的<code class="codeph">HAVING</code>子句。
                                 </p>
                              </li>
                              <li>
                                 <p>它不能包含具有<code class="codeph">ANY</code> ， <code class="codeph">ALL</code>或<code class="codeph">NOT</code> <code class="codeph">EXISTS</code>嵌套查询。</p>
                              </li>
                              <li>
                                 <p>它不能包含<code class="codeph">[START WITH …] CONNECT BY</code>子句。
                                 </p>
                              </li>
                              <li>
                                 <p>它不能在不同站点包含多个详细信息表。</p>
                              </li>
                              <li>
                                 <p><code class="codeph">ON</code> <code class="codeph">COMMIT</code>物化视图不能具有远程详细信息表。
                                 </p>
                              </li>
                              <li>
                                 <p>嵌套的物化视图必须具有连接或聚合。</p>
                              </li>
                              <li>
                                 <p>具有<code class="codeph">GROUP</code> <code class="codeph">BY</code>子句的物化连接视图和物化聚合视图无法从索引组织表中进行选择。
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="DWHSG8202"></a><div class="props_rev_3"><a id="GUID-D930288D-D242-4C27-B8D1-B01236F2E0B1" name="GUID-D930288D-D242-4C27-B8D1-B01236F2E0B1"></a><h5 id="DWHSG-GUID-D930288D-D242-4C27-B8D1-B01236F2E0B1" class="sect5"><span class="enumeration_section">5.3.8.5</span>仅具有联接的物化视图上的快速刷新限制</h5>
                     <div>
                        <div class="section">
                           <p>仅使用连接定义实体化视图的查询且没有聚合对快速刷新具有以下限制：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><span class="q">“ <a href="basic-materialized-views.html#GUID-505C24CF-5D56-4820-88AA-2221410950E7">快速刷新的一般限制</a> ”的</span>所有限制。
                                 </p>
                              </li>
                              <li>
                                 <p>他们不能拥有<code class="codeph">GROUP</code> <code class="codeph">BY</code>子句或聚合。
                                 </p>
                              </li>
                              <li>
                                 <p><code class="codeph">FROM</code>列表中所有表的Rowid必须出现在查询的<code class="codeph">SELECT</code>列表中。
                                 </p>
                              </li>
                              <li>
                                 <p>物化视图日志必须与查询的<code class="codeph">FROM</code>列表中的所有基表的rowid一起存在。
                                 </p>
                              </li>
                              <li>
                                 <p>您无法使用包含<code class="codeph">SELECT</code>语句中的对象类型列的简单连接从多个表创建快速可刷新的实例化视图。
                                 </p>
                              </li>
                           </ul>
                           <p>此外，如果出现以下情况，您选择的刷新方法效率最高：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>定义查询使用外连接，其行为类似于内连接。如果定义查询包含此类连接，请考虑重写定义查询以包含内部联接。</p>
                              </li>
                              <li>
                                 <p>物化视图的<code class="codeph">SELECT</code>列表包含来自多个表的列的表达式。
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="DWHSG8203"></a><div class="props_rev_3"><a id="GUID-932B8CD4-BF60-419A-9202-8A9FD5D24024" name="GUID-932B8CD4-BF60-419A-9202-8A9FD5D24024"></a><h5 id="DWHSG-GUID-932B8CD4-BF60-419A-9202-8A9FD5D24024" class="sect5"><span class="enumeration_section">5.3.8.6</span>使用聚合实现物化视图快速刷新的限制</h5>
                     <div>
                        <div class="section">
                           <p>使用聚合或联接定义具体化视图的查询对快速刷新具有以下限制：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><span class="q">“ <a href="basic-materialized-views.html#GUID-505C24CF-5D56-4820-88AA-2221410950E7">快速刷新的一般限制</a> ”的</span>所有限制。
                                 </p>
                              </li>
                           </ul>
                           <p><code class="codeph">ON</code> <code class="codeph">COMMIT</code>和<code class="codeph">ON</code> <code class="codeph">DEMAND</code>物化视图都支持快速刷新，但以下限制适用：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>物化视图中的所有表必须具有物化视图日志，物化视图日志必须：</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p>包含物化视图中引用的表中的所有列。</p>
                                    </li>
                                    <li>
                                       <p>与指定<code class="codeph">ROWID</code>和<code class="codeph">INCLUDING</code> <code class="codeph">NEW</code> <code class="codeph">VALUES</code> 。</p>
                                    </li>
                                    <li>
                                       <p>如果预期表具有插入/直接加载，删除和更新的混合，则指定<code class="codeph">SEQUENCE</code>子句。
                                       </p>
                                    </li>
                                 </ul>
                              </li>
                              <li>
                                 <p>仅支持<code class="codeph">SUM</code> ， <code class="codeph">COUNT</code> ， <code class="codeph">AVG</code> ， <code class="codeph">STDDEV</code> ， <code class="codeph">VARIANCE</code> ， <code class="codeph">MIN</code>和<code class="codeph">MAX</code>以进行快速刷新。
                                 </p>
                              </li>
                              <li>
                                 <p>必须指定<code class="codeph">COUNT(*)</code> 。
                                 </p>
                              </li>
                              <li>
                                 <p>聚合函数必须仅作为表达式的最外层部分发生。也就是说，不允许诸如<code class="codeph">AVG(AVG(x))</code>或<code class="codeph">AVG(x)</code> + <code class="codeph">AVG(x)</code>聚合。
                                 </p>
                              </li>
                              <li>
                                 <p>对于每个聚合，例如<code class="codeph">AVG(expr)</code> ，必须存在相应的<code class="codeph">COUNT(expr)</code> 。Oracle建议指定<code class="codeph">SUM(expr)</code> 。
                                 </p>
                              </li>
                              <li>
                                 <p>如果指定了<code class="codeph">VARIANCE(expr)</code>或<code class="codeph">STDDEV(expr</code> ），则必须指定<code class="codeph">COUNT(expr)</code>和<code class="codeph">SUM(expr)</code> 。Oracle建议指定<code class="codeph">SUM(expr *expr)</code> 。
                                 </p>
                              </li>
                              <li>
                                 <p>定义查询中的<code class="codeph">SELECT</code>列不能是包含多个基表的列的复杂表达式。可能的解决方法是使用嵌套的物化视图。
                                 </p>
                              </li>
                              <li>
                                 <p><code class="codeph">SELECT</code>列表必须包含所有<code class="codeph">GROUP</code> <code class="codeph">BY</code>列。
                                 </p>
                              </li>
                              <li>
                                 <p>物化视图不基于一个或多个远程表。</p>
                              </li>
                              <li>
                                 <p>如果在<code class="codeph">CHAR</code>化视图日志的筛选列中使用<code class="codeph">CHAR</code>数据类型，则主站点和实例化视图的字符集必须相同。
                                 </p>
                              </li>
                              <li>
                                 <p>如果物化视图具有以下之一，则仅在常规DML插入和直接加载时支持快速刷新。</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p>具有<code class="codeph">MIN</code>或<code class="codeph">MAX</code>聚合的物化视图</p>
                                    </li>
                                    <li>
                                       <p>具有<code class="codeph">SUM(expr)</code>但没有<code class="codeph">COUNT(expr)</code>物化视图</p>
                                    </li>
                                    <li>
                                       <p>没有<code class="codeph">COUNT(*)</code>物化视图</p>
                                    </li>
                                 </ul>
                                 <p>这种物化视图称为仅插入物化视图。</p>
                              </li>
                              <li>
                                 <p>如果没有<code class="codeph">WHERE</code>子句，则删除或混合DML语句后，具有<code class="codeph">MAX</code>或<code class="codeph">MIN</code>物化视图可快速刷新。
                                 </p>
                                 <p>删除或混合DML之后的最大/最小快速刷新与仅插入的情况不具有相同的行为。它删除并重新计算受影响组的最大/最小值。您需要了解其对性能的影响。</p>
                              </li>
                              <li>
                                 <p>只要视图可以完全合并，就可以快速刷新具有<code class="codeph">FROM</code>子句中的命名视图或子查询的物化视图。有关将合并哪些视图的信息，请参见<a href="../tgsql/introduction-to-sql-tuning.html#TGSQL591" target="_blank"><span><cite>Oracle数据库SQL语言参考</cite></span></a> 。
                                 </p>
                              </li>
                              <li>
                                 <p>如果没有外连接，则可以在<code class="codeph">WHERE</code>子句中进行任意选择和连接。
                                 </p>
                              </li>
                              <li>
                                 <p>具有外连接的物化聚合视图在传统DML和直接加载后可快速刷新，前提是只修改了外表。此外，内部联接表的连接列上必须存在唯一约束。如果存在外连接，则所有连接必须通过<code class="codeph">AND</code>连接<code class="codeph">AND</code>并且必须使用equality（ <code class="codeph">=</code> ）运算符。
                                 </p>
                              </li>
                              <li>
                                 <p>对于使用<code class="codeph">CUBE</code> ， <code class="codeph">ROLLUP</code> ，分组集或它们的串联的物化视图，以下限制适用：</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p><code class="codeph">SELECT</code>列表应包含分组区分器，它可以是所有<code class="codeph">GROUP</code> <code class="codeph">BY</code>表达式上的<code class="codeph">GROUPING_ID</code>函数，也可以是<code class="codeph">GROUPING</code>函数，每个<code class="codeph">GROUP</code> <code class="codeph">BY</code>表达式一个。例如，如果物化视图的<code class="codeph">GROUP</code> <code class="codeph">BY</code>子句是“ <code class="codeph">GROUP</code> <code class="codeph">BY</code> <code class="codeph">CUBE(a, b)</code> ”，则<code class="codeph">SELECT</code>列表应包含“ <code class="codeph">GROUPING_ID(a, b)</code> ”或“ <code class="codeph">GROUPING(a)</code> <code class="codeph">AND</code> <code class="codeph">GROUPING(b)</code> “因为物化视图可以快速刷新。
                                       </p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">GROUP</code> <code class="codeph">BY</code>不应导致任何重复分组。例如，“ <code class="codeph">GROUP BY a, ROLLUP(a, b)</code> ”不能快速刷新，因为它会导致重复分组“ <code class="codeph">(a), (a, b), AND (a)</code> ”。
                                       </p>
                                    </li>
                                 </ul>
                              </li>
                           </ul>
                           <div class="infoboxnotealso" id="GUID-932B8CD4-BF60-419A-9202-8A9FD5D24024__GUID-E825C5A7-6004-4F9F-BB9F-4C25ECDBA90B">
                              <p class="notep1">也可以看看：</p>
                              <p><a href="basic-materialized-views.html#GUID-8823A06E-853B-4876-AB9F-96D2D4E5A1DE">使用聚合的物化视图的要求</a></p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="DWHSG8204"></a><div class="props_rev_3"><a id="GUID-81A544CA-14C4-41B1-ACC1-5FF7960F18A6" name="GUID-81A544CA-14C4-41B1-ACC1-5FF7960F18A6"></a><h5 id="DWHSG-GUID-81A544CA-14C4-41B1-ACC1-5FF7960F18A6" class="sect5"><span class="enumeration_section">5.3.8.7</span>使用UNION ALL快速刷新物化视图的限制</h5>
                     <div>
                        <div class="section">
                           <p>如果满足以下条件，则使用<code class="codeph">UNION</code> <code class="codeph">ALL</code>集合运算符的物化视图支持<code class="codeph">REFRESH</code> <code class="codeph">FAST</code>选项：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>定义查询必须在顶层具有<code class="codeph">UNION</code> <code class="codeph">ALL</code>运算符。
                                 </p>
                                 <p><code class="codeph">UNION</code> <code class="codeph">ALL</code>运算符不能嵌入子查询中，但有一个例外： <code class="codeph">UNION</code> <code class="codeph">ALL</code>可以位于<code class="codeph">FROM</code>子句的子查询中，前提是定义查询的格式为<code class="codeph">SELECT * FROM</code> （带有<code class="codeph">UNION</code> <code class="codeph">ALL</code>视图或子查询），如下所示例：</p><pre class="oac_no_warn" dir="ltr">CREATE VIEW view_with_unionall AS（SELECT c.rowid crid，c.cust_id，2 umarker FROM customers c WHERE c.cust_last_name ='Smith'UNION ALL SELECT c.rowid crid，c.cust_id，3 umarker FROM customers c WHERE c.cust_last_name = '琼斯'）; CREATE MATERIALIZED VIEW unionall_inside_view_mv REFRESH FAST ON DEMAND AS SELECT * FROM view_with_unionall;</pre><p>请注意，视图<code class="codeph">view_with_unionall</code>满足快速刷新的要求。
                                 </p>
                              </li>
                              <li>
                                 <p><code class="codeph">UNION</code> <code class="codeph">ALL</code>查询中的每个查询块必须满足具有聚合的快速可刷新实体化视图或具有连接的快速可刷新实体化视图的要求。
                                 </p>
                                 <p>必须根据相应类型的快速可刷新实体化视图的要求在表上创建相应的物化视图日志。</p>
                                 <p>请注意，只有<code class="codeph">ROWID</code>列已包含在<code class="codeph">SELECT</code>列表和物化视图日志中，Oracle数据库还允许使用连接的单个表实例化视图的特殊情况。这在视图<code class="codeph">view_with_unionall</code>的定义查询中显示。
                                 </p>
                              </li>
                              <li>
                                 <p>每个查询的<code class="codeph">SELECT</code>列表必须包含<code class="codeph">UNION</code> <code class="codeph">ALL</code>标记，并且<code class="codeph">UNION</code> <code class="codeph">ALL</code>列必须在每个<code class="codeph">UNION</code> <code class="codeph">ALL</code>分支中具有不同的常量数字或字符串值。此外，标记列必须出现在每个查询块的<code class="codeph">SELECT</code>列表中的相同序号位置。请参见<span class="q">“ <a href="advanced-query-rewrite-materialized-views.html#GUID-26E9AF20-AE8E-4D6E-9AF0-E5C9679A09F6">UNION ALL标记和查询重写</a> ”</span>了解有关详细信息， <code class="codeph">UNION</code> <code class="codeph">ALL</code>标记。
                                 </p>
                              </li>
                              <li>
                                 <p>具有<code class="codeph">UNION</code> <code class="codeph">ALL</code>物化视图不支持某些功能，如外连接，仅插入聚合物化视图查询和远程表。但请注意，在使用<code class="codeph">UNION</code> <code class="codeph">ALL</code>或远程表时，可以快速刷新复制中使用的实例化视图（不包含连接或聚合）。
                                 </p>
                              </li>
                              <li>
                                 <p>兼容性初始化参数必须设置为9.2.0或更高，以使用<code class="codeph">UNION</code> <code class="codeph">ALL</code>创建快速可刷新的物化视图。</p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="DWHSG8205"></a><div class="props_rev_3"><a id="GUID-00879D7D-D517-463F-9052-2FD8F9CE9EAD" name="GUID-00879D7D-D517-463F-9052-2FD8F9CE9EAD"></a><h5 id="DWHSG-GUID-00879D7D-D517-463F-9052-2FD8F9CE9EAD" class="sect5"><span class="enumeration_section">5.3.8.8</span>关于实现刷新目标</h5>
                     <div>
                        <p>除了本章中讨论的<code class="codeph">EXPLAIN_MVIEW</code>过程之外，您还可以使用<code class="codeph">DBMS_ADVISOR.TUNE_MVIEW</code>过程来优化<code class="codeph">CREATE</code> <code class="codeph">MATERIALIZED</code> <code class="codeph">VIEW</code>语句，以实现<code class="codeph">REFRESH</code> <code class="codeph">FAST</code>和<code class="codeph">ENABLE</code> <code class="codeph">QUERY</code> <code class="codeph">REWRITE</code>目标。
                        </p>
                        <p>请参阅<a href="basic-materialized-views.html#GUID-FE444279-E7A0-4BF4-B4CA-0F54CB0ACA52">在预构建表上刷新实体化视图</a> 。
                        </p>
                     </div><a id="DWHSG9298"></a><div class="props_rev_3"><a id="GUID-FE444279-E7A0-4BF4-B4CA-0F54CB0ACA52" name="GUID-FE444279-E7A0-4BF4-B4CA-0F54CB0ACA52"></a><h6 id="DWHSG-GUID-FE444279-E7A0-4BF4-B4CA-0F54CB0ACA52" class="sect6"><span class="enumeration_section">5.3.8.8.1</span>刷新预构建表的物化视图</h6>
                        <div>
                           <div class="section">
                              <p>对于使用预构建选项创建的物化视图，默认情况下不会创建索引<code class="codeph">I_snap$</code> 。此索引有助于快速刷新性能， <span class="q">“ <a href="basic-materialized-views.html#GUID-681BB72C-13B2-42AF-BD59-F4DFE8685F83">选择实体化视图的索引</a> ”中</span>说明了如何创建此索引。
                              </p>
                           </div>
                           <!-- class="section" -->
                        </div>
                     </div>
                  </div><a id="DWHSG8207"></a><a id="DWHSG8206"></a><div class="props_rev_3"><a id="GUID-34A64C33-07E3-48BE-B6E5-48C9AE0BDB8B" name="GUID-34A64C33-07E3-48BE-B6E5-48C9AE0BDB8B"></a><h5 id="DWHSG-GUID-34A64C33-07E3-48BE-B6E5-48C9AE0BDB8B" class="sect5"><span class="enumeration_section">5.3.8.9</span>刷新嵌套的物化视图</h5>
                     <div>
                        <div class="section">
                           <p>只要其数据与其详细信息表中的数据同步，嵌套的物化视图就会被认为是新鲜的，即使它的某些详细信息表可能是陈旧的物化视图。</p>
                           <p>您可以通过两种方式刷新嵌套的<code class="codeph">DBMS_MVIEW.REFRESH</code>化视图： <code class="codeph">DBMS_MVIEW.REFRESH</code> ， <code class="codeph">nested</code>标志设置为<code class="codeph">TRUE</code> ， <code class="codeph">REFRESH_DEPENDENT</code> ，基础表上的<code class="codeph">nested</code>标志设置为<code class="codeph">TRUE</code> 。如果使用<code class="codeph">DBMS_MVIEW.REFRESH</code> ，则刷新整个物化视图链，并从上下方式从指定的物化视图开始覆盖。也就是说，依赖关系层次结构中指定的物化视图及其所有子物化视图将按顺序刷新。使用<code class="codeph">DBMS_MVIEW.REFRESH_DEPENDENT</code> ，整个链从下到上刷新。也就是说，从指定表开始的依赖关系层次结构中的所有父物化视图都按顺序刷新。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-34A64C33-07E3-48BE-B6E5-48C9AE0BDB8B__GUID-1A319C2D-FBF7-4C68-879F-4EF313462D7A">
                           <p class="titleinexample">示例5-7刷新嵌套的物化视图的示例</p>
                           <p>以下语句显示了刷新嵌套的实例化视图的示例：</p><pre class="oac_no_warn" dir="ltr">DBMS_MVIEW.REFRESH（'SALES_MV，COST_MV'，嵌套=&gt; TRUE）;</pre><p>此语句将首先根据依赖关系分析刷新<code class="codeph">sales_mv</code>和<code class="codeph">cost_mv</code>的所有<code class="codeph">sales_mv</code>化视图，然后刷新两个指定的<code class="codeph">cost_mv</code>化视图。
                           </p>
                           <p>您可以在<code class="codeph">*_MVIEWS</code>视图中查询<code class="codeph">STALE_SINCE</code>列，以查明<code class="codeph">*_MVIEWS</code>视图何时变为陈旧。
                           </p>
                        </div>
                        <!-- class="example" -->
                     </div>
                  </div>
               </div><a id="DWHSG8208"></a><div class="props_rev_3"><a id="GUID-CBE901D0-B358-4007-8B87-F18966F9A72E" name="GUID-CBE901D0-B358-4007-8B87-F18966F9A72E"></a><h4 id="DWHSG-GUID-CBE901D0-B358-4007-8B87-F18966F9A72E" class="sect4"><span class="enumeration_section">5.3.9</span>物化视图中的订购条款</h4>
                  <div>
                     <p><a id="d15276e4323" class="indexterm-anchor"></a> <code class="codeph">CREATE</code> <code class="codeph">MATERIALIZED</code> <code class="codeph">VIEW</code>语句中允许使用<code class="codeph">ORDER</code> <code class="codeph">BY</code>子句。它仅在物化视图的初始创建期间使用。在完全刷新或快速刷新期间不使用它。
                     </p>
                     <p>要提高针对大型实例化视图的查询性能，请按照<code class="codeph">ORDER</code> <code class="codeph">BY</code>子句中指定的顺序将实体存储在实例化视图中。此初始排序提供数据的物理群集。如果索引是在订购实例化视图的列上构建的，则使用索引访问实例化视图的行通常会减少由于物理群集而导致的磁盘I / O时间。
                     </p>
                     <p><code class="codeph">ORDER</code> <code class="codeph">BY</code>子句不被视为物化视图定义的一部分。因此，Oracle数据库检测各种类型的物化视图的方式没有区别（例如，没有聚合的物化连接视图）。出于同样的原因，查询重写不受<code class="codeph">ORDER</code> <code class="codeph">BY</code>子句的影响。此功能类似于<code class="codeph">CREATE</code> <code class="codeph">TABLE</code> ...<code class="codeph">ORDER</code> <code class="codeph">BY</code>功能。
                     </p>
                  </div>
               </div><a id="DWHSG8212"></a><div class="props_rev_3"><a id="GUID-EC2E9E41-9C37-44D5-BCE5-568BD5F6E792" name="GUID-EC2E9E41-9C37-44D5-BCE5-568BD5F6E792"></a><h4 id="DWHSG-GUID-EC2E9E41-9C37-44D5-BCE5-568BD5F6E792" class="sect4"><span class="enumeration_section">5.3.10</span>使用Oracle Enterprise Manager创建物化视图</h4>
                  <div>
                     <p>也可以使用Enterprise Manager通过选择实体化视图对象类型来创建实例化视图。如果使用这种方法，所需信息没有区别。</p>
                  </div>
               </div><a id="DWHSG8213"></a><div class="props_rev_3"><a id="GUID-4845AEBC-1AA9-4CD8-AE91-2E4379291FDE" name="GUID-4845AEBC-1AA9-4CD8-AE91-2E4379291FDE"></a><h4 id="DWHSG-GUID-4845AEBC-1AA9-4CD8-AE91-2E4379291FDE" class="sect4"><span class="enumeration_section">5.3.11</span>使用具有NLS参数的物化视图</h4>
                  <div>
                     <p>使用某些物化视图时，必须确保NLS参数与创建物化视图时的参数相同。具有此限制的物化视图如下：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>表达式可能会返回不同的值，具体取决于NLS参数设置。例如，（ <code class="codeph">date &gt; "01/02/03"</code> ）或（ <code class="codeph">rate &lt;= "2.150"</code> ）是NLS参数相关表达式。
                           </p>
                        </li>
                        <li>
                           <p>Equijoins，其中连接的一侧是字符数据。此等值连接的结果取决于排序规则，这可能会在会话的基础上发生变化，在查询重写的情况下会产生错误的结果，或者在刷新操作后产生不一致的物化视图。</p>
                        </li>
                        <li>
                           <p>在物化视图的<code class="codeph">SELECT</code>列表中或在物化聚合视图的聚合内生成内部转换为字符数据的表达式。此限制不适用于仅涉及数字数据的表达式，例如<code class="codeph">a+b</code> ，其中<code class="codeph">a</code>和<code class="codeph">b</code>是数字字段。
                           </p>
                        </li>
                     </ul>
                  </div>
               </div><a id="DWHSG9299"></a><a id="DWHSG8214"></a><div class="props_rev_3"><a id="GUID-99476E65-CC39-49CF-A619-C4D947662040" name="GUID-99476E65-CC39-49CF-A619-C4D947662040"></a><h4 id="DWHSG-GUID-99476E65-CC39-49CF-A619-C4D947662040" class="sect4"><span class="enumeration_section">5.3.12</span>为物化视图添加注释</h4>
                  <div>
                     <div class="section">
                        <p>您可以为物化视图添加注释。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-99476E65-CC39-49CF-A619-C4D947662040__GUID-B4EC61E0-B46F-41B7-82B9-089286223E92">示例：向实体化视图添加注释</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>以下语句为现有物化视图的数据字典视图添加注释：</p><pre class="oac_no_warn" dir="ltr">对物质化视图的评论sales_mv是'销售物化视图';</pre><p>要在前面的语句执行后查看注释，可以查询目录视图<code class="codeph">{USER</code> ， <code class="codeph">DBA}</code> <code class="codeph">ALL_MVIEW_COMMENTS</code> 。例如，请考虑以下示例：</p><pre class="oac_no_warn" dir="ltr">SELECT MVIEW_NAME，来自USER_MVIEW_COMMENTS的评论，其中MVIEW_NAME ='SALES_MV';</pre><p>输出将类似于以下内容：</p><pre class="oac_no_warn" dir="ltr">MVIEW_NAME评论----------- ----------------------- SALES_MV销售物化视图</pre><p>注意：如果兼容性设置为10.0.1或更高版本，则物化视图容器表将不允许使用<code class="codeph">COMMENT</code> <code class="codeph">ON</code> <code class="codeph">TABLE</code> 。如果发出以下错误消息将被抛出。
                        </p><pre class="oac_no_warn" dir="ltr">ORA-12098：无法对物化视图发表评论。
</pre><p>对于预构建表，如果它具有现有注释，则注释将在物化视图创建后继承。现有注释将以<code class="codeph">'(from table)'</code>为前缀。例如，创建表<code class="codeph">sales_summary</code>以包含销售摘要信息。现有注释<code class="codeph">'Sales summary data'</code>与表关联。创建具有相同名称的物化视图以将预构建表用作其容器表。物化视图创建后，注释变为<code class="codeph">'(from table) Sales summary data'</code> 。
                        </p>
                        <p>但是，如果预构建的表<code class="codeph">sales_summary</code>没有任何注释，则会添加以下注释： <code class="codeph">'Sales summary data'</code> 。然后，如果删除实体化视图，则注释将传递给预先构建的表，其中包含注释： <code class="codeph">'(from materialized view) Sales summary data'</code> 。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="DWHSG9300"></a><div class="props_rev_3"><a id="GUID-4BCA1300-C03E-4C24-AD19-50EB9BBA8806" name="GUID-4BCA1300-C03E-4C24-AD19-50EB9BBA8806"></a><h3 id="DWHSG-GUID-4BCA1300-C03E-4C24-AD19-50EB9BBA8806" class="sect3"><span class="enumeration_section">5.4</span>创建物化视图日志</h3>
               <div>
                  <div class="section">
                     <p>物化视图<a id="d15276e4559" class="indexterm-anchor"></a><a id="d15276e4561" class="indexterm-anchor"></a>如果要使用快速刷新，则需要日志，但分区更改跟踪刷新除外。也就是说，如果详细信息表支持物化视图的分区更改跟踪，则不需要该详细信息表上的物化视图日志，以便在该物化视图上快速刷新。但是，作为一般规则，如果要使用快速刷新，则应创建物化视图日志。使用要更改的基表上的<code class="codeph">CREATE</code> <code class="codeph">MATERIALIZED</code> <code class="codeph">VIEW</code> <code class="codeph">LOG</code>语句定义物化视图日志。它们不是在物化视图上创建的，除非在该物化视图的顶部有另一个物化视图，嵌套的物化视图就是这种情况。为了快速刷新物化视图，物化视图日志的定义通常必须指定<code class="codeph">ROWID</code>子句。此外，对于聚合物化视图，它还必须包含物化视图， <code class="codeph">INCLUDING</code> <code class="codeph">NEW</code> <code class="codeph">VALUES</code>子句和<code class="codeph">SEQUENCE</code>子句中引用的表中的每一列。通过使用<code class="codeph">WITH</code> <code class="codeph">COMMIT</code> <code class="codeph">SCN</code>子句，通常可以实现包含聚合或连接的本地物化视图的更好的快速刷新性能。
                     </p>
                     <p>物化视图日志的示例如下所示，其中一个在表<code class="codeph">sales</code>上创建：</p><pre class="oac_no_warn" dir="ltr">使用ROWID创建物料化视图登录销售（prod_id，cust_id，time_id，channel_id，promo_id，quantity_sold，amount_sold）包括新值;</pre><p>或者，您可以创建基于提交SCN的物化视图日志，如下所示：</p><pre class="oac_no_warn" dir="ltr">使用ROWID（prod_id，cust_id，time_id，channel_id，promo_id，quantity_sold，amount_sold）创建物料化视图登录销售，包括新值的COMMIT SCN;</pre><p>Oracle建议将关键字<code class="codeph">SEQUENCE</code>包含在物化视图日志语句中，除非您确定永远不会执行混合DML操作（对多个表<code class="codeph">INSERT</code> ， <code class="codeph">UPDATE</code>或<code class="codeph">DELETE</code>操作的组合）。物化视图日志中需要<code class="codeph">SEQUENCE</code>列，以支持在多个表上使用<code class="codeph">INSERT</code> ， <code class="codeph">UPDATE</code>或<code class="codeph">DELETE</code>语句的组合进行快速刷新。但是，您可以在创建后将<code class="codeph">SEQUENCE</code>编号添加到<code class="codeph">SEQUENCE</code>化视图日志中。
                     </p>
                     <p>混合DML操作的边界由物化视图是<code class="codeph">ON</code> <code class="codeph">COMMIT</code>还是<code class="codeph">ON</code> <code class="codeph">DEMAND</code> 。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type:disc">
                        <li>
                           <p>对于<code class="codeph">ON</code> <code class="codeph">COMMIT</code> ，混合DML语句在同一事务中发生，因为在提交此事务时将发生物化视图的刷新。
                           </p>
                        </li>
                        <li>
                           <p>对于<code class="codeph">ON</code> <code class="codeph">DEMAND</code> ，混合DML语句在刷新之间发生。物化视图日志的以下示例说明了在包含<code class="codeph">SEQUENCE</code>关键字的表<code class="codeph">sales</code>中创建一个的情况：</p><pre class="oac_no_warn" dir="ltr">使用SEQUENCE，ROWID（prod_id，cust_id，time_id，channel_id，promo_id，quantity_sold，amount_sold）创建物料化视图登录销售包括新值;</pre></li>
                     </ul>
                     <p>本节包含以下主题：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="basic-materialized-views.html#GUID-03F7FB6A-A806-4F8F-A3E8-5C4D7F06E916">使用具有物化视图日志的FORCE选项</a></p>
                        </li>
                        <li>
                           <p><a href="basic-materialized-views.html#GUID-D88BCD87-B724-41F9-99DC-44B67E46B0ED">清除物化视图日志</a></p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div><a id="DWHSG9301"></a><div class="props_rev_3"><a id="GUID-03F7FB6A-A806-4F8F-A3E8-5C4D7F06E916" name="GUID-03F7FB6A-A806-4F8F-A3E8-5C4D7F06E916"></a><h4 id="DWHSG-GUID-03F7FB6A-A806-4F8F-A3E8-5C4D7F06E916" class="sect4"><span class="enumeration_section">5.4.1</span>在物化视图日志中使用FORCE选项</h4>
                  <div>
                     <p>如果指定<code class="codeph">FORCE</code>并且已为物化视图日志指定了使用<code class="codeph">ADD</code>子句指定的任何项，则Oracle不会返回错误，而是静默忽略现有元素，并将任何尚未存在的项添加到物化视图日志中。日志。例如，如果您使用过滤器列（例如<code class="codeph">cust_id</code>并且此列已存在，则Oracle数据库会忽略冗余并且不会返回错误。
                     </p>
                  </div>
               </div><a id="DWHSG9302"></a><div class="props_rev_3"><a id="GUID-D88BCD87-B724-41F9-99DC-44B67E46B0ED" name="GUID-D88BCD87-B724-41F9-99DC-44B67E46B0ED"></a><h4 id="DWHSG-GUID-D88BCD87-B724-41F9-99DC-44B67E46B0ED" class="sect4"><span class="enumeration_section">5.4.2</span>清除物化视图日志</h4>
                  <div>
                     <div class="section">
                        <p>清除物化视图日志可以在物化视图刷新过程中完成，也可以延迟到以后，从而提高刷新性能时间。您可以使用<code class="codeph">PURGE</code>子句为清除时间选择不同的选项，如下所示：</p><pre class="oac_no_warn" dir="ltr">CREATE MATERIALIZED VIEW LOG ON销售PURGE START WITH sysdate NEXT sysdate + 1 WITH ROWID（prod_id，cust_id，time_id，channel_id，promo_id，quantity_sold，amount_sold）包括新价值;</pre><p>您还可以在<code class="codeph">USER_MVIEW_LOGS</code>中查询清除信息，如下所示：</p><pre class="oac_no_warn" dir="ltr">SELECT PURGE_DEFERRED，PURGE_INTERVAL，LAST_PURGE_DATE，LAST_PURGE_STATUS来自USER_MVIEW_LOGS，其中LOG_OWNER“SH”和MASTER ='SALES';</pre><p>除了在创建物化视图日志时设置清除外，您还可以通过发出类似于以下内容的语句来修改现有的物化视图日志：</p><pre class="oac_no_warn" dir="ltr">ALTER MATERIALIZED VIEW LOG ON销售PURGE IMMEDIATE;</pre><div class="infoboxnotealso" id="GUID-D88BCD87-B724-41F9-99DC-44B67E46B0ED__GUID-94DD02CD-2936-4AE5-A37F-81F872699936">
                           <p class="notep1">也可以看看：</p>
                           <p>有关物化视图日志语法的详细信息，请参阅<a href="../sqlrf/CREATE-MATERIALIZED-VIEW-LOG.html#SQLRF01303" target="_blank"><span><cite>Oracle数据库SQL语言参考</cite></span></a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-42B64F99-7391-48B8-B37D-1B486DC29645" name="GUID-42B64F99-7391-48B8-B37D-1B486DC29645"></a><h3 id="DWHSG-GUID-42B64F99-7391-48B8-B37D-1B486DC29645" class="sect3"><span class="enumeration_section">5.5</span>基于近似查询创建物化视图</h3>
               <div>
                  <p>基于近似查询的物化视图使用SQL函数，该函数在其定义查询中返回近似函数。</p>
                  <div class="section">
                     <p></p>
                     <p>您可以计算汇总和汇总近似值，并将这些结果存储在物化视图中，以便进一步分析或查询。汇总近似计算一组行中所有维度的近似聚合，可用于执行详细聚合。您可以进一步聚合摘要数据以获取可用于高级分析的聚合近似值，以便Oracle数据库不会再次扫描基表以计算更高级别的聚合。Oracle数据库不会再次扫描基表以计算更高级别的聚合。它只使用现有的聚合结果来计算更高级别的聚合。例如，您可以创建一个汇总近似值，用于存储每个州和每个国家/地区内销售的产品的大致数量。然后使用该总近似值返回每个国家内的大致不同数量的产品。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="p">
                     <p>要创建包含返回近似结果的SQL函数的实例化视图：</p>
                  </div>
                  <!-- class="section" -->
                  <ul>
                     <li class="stepexpand"><span>使用包含相应函数的定义查询运行<code class="codeph">CREATE MATERIALIZED VIEW</code>语句</span><div>
                           <p>例如，在物化视图的定义查询中使用<code class="codeph">APPROX_PERCENTILE</code>函数。
                           </p>
                        </div>
                     </li>
                  </ul>
                  <div class="example" id="GUID-42B64F99-7391-48B8-B37D-1B486DC29645__GUID-DB6FA7AA-68EC-445D-B3AE-AE04025F3C36">
                     <p class="titleinexample">示例5-8 <span class="bold">基于近似查询创建实体化视图</span></p>
                     <p>以下示例创建一个实体化视图，用于存储每天销售的不同产品的大致数量。</p><pre class="pre codeblock"><code>CREATE MATERIALIZED VIEW approx_count_distinct_pdt_mv ENABLE QUERY REWRITE AS SELECT t.calendar_year，t.calendar_month_number，t.day_number_in_month，approx_count_distinct（prod_id）daily_detail FROM sales s，times t WHERE s.time_id = t.time_id GROUP BY t.calendar_year，t.calendar_month_number， t.day_number_in_month;</code></pre><div class="infoboxnotealso" id="GUID-42B64F99-7391-48B8-B37D-1B486DC29645__GUID-9A25B83F-4BF7-435F-B25F-A4E8B2DE828B">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="refreshing-materialized-views.html#GUID-675D03FA-F6E3-4DBD-90E2-1290B20E4689" title="Oracle数据库对使用近似查询定义的物化视图执行快速刷新。">基于近似查询的刷新物化视图</a></p>
                           </li>
                           <li>
                              <p><a href="sql-analysis-reporting-data-warehouses.html#GUID-E8AF7908-979A-49F2-B845-D9A5010BE863" title="Oracle数据库提供了一组返回近似百分位数结果的SQL函数。这些功能可用于监控质量，跟踪社交媒体活动，监控性能以及搜索数据集中的异常值。">使用返回近似结果的百分位函数</a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="example" -->
               </div>
            </div>
            <div class="sect2"><a id="GUID-03107B3C-72D3-4B6B-A922-F13FF0CF2B6D" name="GUID-03107B3C-72D3-4B6B-A922-F13FF0CF2B6D"></a><h3 id="DWHSG-GUID-03107B3C-72D3-4B6B-A922-F13FF0CF2B6D" class="sect3"><span class="enumeration_section">5.6</span>创建包含基于位图的COUNT（DISTINCT）函数的物化视图</h3>
               <div>
                  <p>基于<code class="codeph">COUNT(DISTINCT)</code>函数的物化视图可以通过对整数列使用基于位图的操作来提供增强的性能。
                  </p>
                  <div class="section">
                     <p></p>
                     <p>从Oracle Database Release 19c开始，您可以基于SQL聚合函数创建实例化视图，这些函数使用位图表示来表示<code class="codeph">COUNT(DISTINCT)</code>操作的计算。这些函数包括<code class="codeph">BITMAP_BUCKET_NUMBER</code> ， <code class="codeph">BITMAP_BIT_POSITION</code>和<code class="codeph">BITMAP_CONSTRUCT_AGG</code> 。</p>
                     <p>要基于位图创建物化视图：</p>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>确保物化视图将基于的表存在物化视图日志。</span></li>
                     <li class="stepexpand"><span>使用<code class="codeph">CREATE MATERIALIZED VIEW</code>命令创建物化视图。</span><div>
                           <p>以下示例基于<code class="codeph">SH.SALES</code>表创建实例化视图，并包含非附加事实。
                           </p><pre class="pre codeblock"><code>SQL&gt;创建物化视图mv_sales为2选择PROMO_ID，3 BITMAP_BUCKET_NUMBER（PROD_ID）bm_bktno，4 BITMAP_CONSTRUCT_AGG（BITMAP_BIT_POSITION（PROD_ID），'RAW'）bm_details 5来自销售6组PROMO_ID，BITMAP_BUCKET_NUMBER（PROD_ID）;物化视图已创建。</code></pre></div>
                     </li>
                  </ol>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="advanced-query-rewrite-materialized-views.html#GUID-50F1CD49-F551-4443-96FD-6F8EDA694930" title="可以重写对整数列包含COUNT（DISTINCT）操作的查询，以使用包含基于位图的函数的实体化视图。">基于位图的COUNT（DISTINCT）函数查询重写和物化视图</a></li>
                     </ul>
                  </div>
               </div>
            </div><a id="DWHSG8215"></a><div class="props_rev_3"><a id="GUID-4DE39B8B-8452-4581-A841-6AF77019986D" name="GUID-4DE39B8B-8452-4581-A841-6AF77019986D"></a><h3 id="DWHSG-GUID-4DE39B8B-8452-4581-A841-6AF77019986D" class="sect3"><span class="enumeration_section">5.7</span>注册现有的物化视图</h3>
               <div>
                  <div class="section">
                     <p><a id="d15276e4949" class="indexterm-anchor"></a>一些数据仓库已在普通用户表中实现了物化视图。虽然此解决方案提供了物化视图的性能优势，但它不会：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type:disc">
                        <li>
                           <p>为所有SQL应用程序提供查询重写。</p>
                        </li>
                        <li>
                           <p>允许在一个应用程序中定义的物化视图在另一个应用程序中透明访问。</p>
                        </li>
                        <li>
                           <p>通常支持快速并行或快速物化视图刷新。</p>
                        </li>
                     </ul>
                     <p>由于存在这些限制，并且由于现有的物化视图可能非常庞大且重建成本很高，因此应尽可能注册现有的物化视图表。您可以使用<code class="codeph">CREATE</code> <code class="codeph">MATERIALIZED</code> <code class="codeph">VIEW</code>注册用户定义的物化视图...<code class="codeph">ON</code> <code class="codeph">PREBUILT</code> <code class="codeph">TABLE</code>语句。一旦注册，物化视图可用于查询重写或由其中一个刷新方法维护，或两者都维护。
                     </p>
                     <p>表的内容必须反映定义查询在物化视图中注册时的具体化，定义查询中的每一列必须对应于表中具有匹配数据类型的列。但是，您可以指定<code class="codeph">WITH</code> <code class="codeph">REDUCED</code> <code class="codeph">PRECISION</code>以允许定义查询中的列的精度与表列的列的精度不同。
                     </p>
                     <p>表和物化视图必须具有相同的名称，但该表将其标识保留为表，并且可以包含在实例化视图的定义查询中未引用的列。这些额外的列称为非托管列。如果在刷新操作期间插入行，则该行的每个非托管列都将设置为其默认值。因此，非托管列不能具有<code class="codeph">NOT</code> <code class="codeph">NULL</code>约束，除非它们也具有默认值。
                     </p>
                     <p>如果参数<code class="codeph">QUERY_REWRITE_INTEGRITY</code>设置为<code class="codeph">STALE_TOLERATED</code>或<code class="codeph">TRUSTED</code>则基于预构建表的物化视图可通过查询重写进行选择。</p>
                     <div class="infoboxnotealso" id="GUID-4DE39B8B-8452-4581-A841-6AF77019986D__GUID-C92605F2-CB73-4E1E-9E08-4FBAA9AEC4D0">
                        <p class="notep1">也可以看看：</p>
                        <p>有关完整性级别的详细信息， <a href="basic-query-rewrite-materialized-views.html#GUID-DB76286B-8557-446B-A6CC-BC987C378076" title="A query undergoes several checks to determine whether it is a candidate for query rewrite. If the query fails any check, then the query is applied to the detail tables rather than the materialized view. The inability to rewrite can be costly in terms of response time and processing power.Query rewrite behavior is controlled by certain database initialization parameters.Query rewrite offers three levels of rewrite integrity that are controlled by the initialization parameter QUERY_REWRITE_INTEGRITY.This example illustrates the power of query rewrite with materialized views.">对物化视图</a>进行<a href="basic-query-rewrite-materialized-views.html#GUID-DB76286B-8557-446B-A6CC-BC987C378076" title="查询经过多次检查以确定它是否是查询重写的候选者。如果查询未通过任何检查，则查询将应用于详细信息表而不是物化视图。在响应时间和处理能力方面，无法重写可能代价高昂。查询重写行为由某些数据库初始化参数控制。查询重写提供了三个级别的重写完整性，这些级别由初始化参数QUERY_REWRITE_INTEGRITY控制。此示例说明了使用实例化视图重写查询的强大功能。">基本查询重写</a></p>
                     </div>
                     <p><a id="d15276e5029" class="indexterm-anchor"></a><a id="d15276e5033" class="indexterm-anchor"></a>删除在预构建表上创建的实体化视图时，该表仍然存在 - 仅删除实例化视图。
                     </p>
                     <p>以下示例说明了注册用户定义表所需的两个步骤。首先，创建表，然后使用与表完全相同的名称定义实例化视图。此物化视图<code class="codeph">sum_sales_tab_mv</code>适用于查询重写。
                     </p><pre class="oac_no_warn" dir="ltr">CREATE TABLE sum_sales_tab PCTFREE 0 TABLESPACE demo STORAGE（INITIAL 8M）AS SELECT s.prod_id，SUM（amount_sold）AS dollar_sales，SUM（quantity_sold）AS unit_sales FROM sales s GROUP BY s.prod_id; CREATE MATERIALIZED VIEW sum_sales_tab_mv ON PREUUTT表没有降低PRECISION ENABLE QUERY REWRITE作为SELECT s.prod_id，SUM（amount_sold）AS dollar_sales，SUM（quantity_sold）AS unit_sales FROM sales s GROUP BY s.prod_id;</pre><p>您可以压缩此表以节省空间。</p>
                     <p>在某些情况下，用户定义的物化视图会按照比更新周期更长的计划进行刷新。例如，月度物化视图可能仅在每个月末更新，物化视图值始终指向完整时段。直接针对这些物化视图编写的报告仅隐式选择不在当前（不完整）时间段内的数据。如果用户定义的物化视图已包含时间维：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>它应该被注册，然后在每个更新周期快速刷新。</p>
                        </li>
                        <li>
                           <p>您可以创建一个选择感兴趣的完整时间段的视图。</p>
                        </li>
                        <li>
                           <p>应修改报告以引用视图，而不是直接引用用户定义的物化视图。</p>
                        </li>
                     </ul>
                     <p>如果用户定义的物化视图不包含时间维，则应创建包含时间维的新物化视图（如果可能）。此外，在这种情况下，视图应聚合新物化视图中的时间列。</p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="DWHSG8216"></a><div class="props_rev_3"><a id="GUID-681BB72C-13B2-42AF-BD59-F4DFE8685F83" name="GUID-681BB72C-13B2-42AF-BD59-F4DFE8685F83"></a><h3 id="DWHSG-GUID-681BB72C-13B2-42AF-BD59-F4DFE8685F83" class="sect3"><span class="enumeration_section">5.8</span>选择物化视图的索引</h3>
               <div>
                  <div class="section">
                     <p>物化视图上最常见的两个操作是查询执行和快速刷新，每个操作都有不同的性能要求。查询执行可能需要访问实体化视图键列的任何子集，并且可能需要加入并聚合这些列的子集。因此，如果在每个物化视图键列上定义了单列位图索引，则查询执行通常会执行得最好。</p>
                     <p>对于仅包含使用快速刷新的连接的实例化视图的情况，Oracle建议在包含rowid的列上创建索引，以提高刷新操作的性能。</p>
                     <p>如果使用聚合的物化视图可快速刷新，则会创建适合快速刷新过程的索引，除非在<code class="codeph">CREATE</code> <code class="codeph">MATERIALIZED</code> <code class="codeph">VIEW</code>语句中指定了<code class="codeph">USING</code> <code class="codeph">NO</code> <code class="codeph">INDEX</code> 。
                     </p>
                     <p>如果物化视图已分区，则在物化视图上执行分区维护操作后，索引将变为不可用，并且需要重建它们以使快速刷新工作。</p>
                     <p>如果使用预构建选项创建<code class="codeph">I_snap$</code>化视图，则不会自动创建<code class="codeph">I_snap$</code>索引。此索引显着提高了快速刷新性能，您可以通过发出如下语句手动创建它：</p><pre class="oac_no_warn" dir="ltr">创建独特的索引&lt;OWNER&gt;。“I_SNAP $ _ &lt;MVIEW_NAME&gt;”ON &lt;OWNER&gt;。&lt;MVIEW_NAME&gt;（SYS_OP_MAP_NONNULL（“LOG_DATE”））PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS STORAGE（INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645 PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DE FAULT CELL_FLASH_CACHE DEFAULT）TABLESPACE &lt;TABLESPACE_NAME&gt;;</pre><div class="infoboxnotealso" id="GUID-681BB72C-13B2-42AF-BD59-F4DFE8685F83__GUID-B53F843C-E73E-4A7A-84DF-5F82CD036DA5">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="../tgsql/introduction-to-sql-tuning.html#TGSQL591" target="_blank"><span class="italic">“Oracle数据库SQL调优指南”，</span></a>以获取有关使用SQL Access Advisor确定哪些索引适合您的实例化视图的信息</p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="DWHSG8217"></a><div class="props_rev_3"><a id="GUID-2932186A-CA03-47B7-A11A-FF30BD62AB57" name="GUID-2932186A-CA03-47B7-A11A-FF30BD62AB57"></a><h3 id="DWHSG-GUID-2932186A-CA03-47B7-A11A-FF30BD62AB57" class="sect3"><span class="enumeration_section">5.9</span>删除物化视图</h3>
               <div>
                  <div class="section">
                     <p>使用<code class="codeph">DROP</code> <code class="codeph">MATERIALIZED</code> <code class="codeph">VIEW</code>语句删除a <a id="d15276e5157" class="indexterm-anchor"></a><a id="d15276e5161" class="indexterm-anchor"></a>物化观点。例如，请考虑以下语句：</p><pre class="oac_no_warn" dir="ltr">DROP MATERIALIZED VIEW sales_sum_mv;</pre><p>此语句将删除物化视图<code class="codeph">sales_sum_mv</code> 。如果物化视图是在表上预先构建的，则表不会被删除，但不能再使用刷新机制维护或由查询重写使用。或者，您可以使用Oracle Enterprise Manager删除实例化视图。
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="DWHSG8218"></a><div class="props_rev_3"><a id="GUID-651B08EB-4D32-4A93-A260-A965C40AE136" name="GUID-651B08EB-4D32-4A93-A260-A965C40AE136"></a><h3 id="DWHSG-GUID-651B08EB-4D32-4A93-A260-A965C40AE136" class="sect3"><span class="enumeration_section">5.10</span>分析物化视图功能</h3>
               <div>
                  <div class="section">
                     <p>您可以使用<code class="codeph">DBMS_MVIEW</code> 。 <code class="codeph">EXPLAIN_MVIEW</code>过程，了解物化视图或潜在物化视图的可能性。特别是，此过程使您可以确定：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type:disc">
                        <li>
                           <p>如果物化视图可快速刷新</p>
                        </li>
                        <li>
                           <p>您可以使用此物化视图执行哪些类型的查询重写</p>
                        </li>
                        <li>
                           <p>是否可以进行分区更改跟踪刷新</p>
                        </li>
                     </ul>
                     <p>使用此过程很简单，并在<span class="q">“ <a href="basic-materialized-views.html#GUID-A5620B3E-42C2-48B8-AB24-85C83A6035C0">使用DBMS_MVIEW.EXPLAIN_MVIEW过程</a> ”中进行了描述</span> 。您只需调用<code class="codeph">DBMS_MVIEW.EXPLAIN_MVIEW</code> ，将现有物化视图的模式和物化视图名称作为单个参数传入。或者，您可以为潜在的实例化视图或完整的<code class="codeph">CREATE</code> <code class="codeph">MATERIALIZED</code> <code class="codeph">VIEW</code>语句指定<code class="codeph">SELECT</code>字符串。然后分析物化视图或潜在物化视图，并将结果写入名为<code class="codeph">MV_CAPABILITIES_TABLE</code>的表（默认值）或称为<code class="codeph">MSG_ARRAY</code>的数组。</p>
                     <p>请注意，除非将结果放在<code class="codeph">MSG_ARRAY</code>否则必须在调用<code class="codeph">EXPLAIN_MVIEW</code>之前运行<code class="codeph">utlxmv.sql</code>脚本。该脚本位于<code class="codeph">admin</code>目录中。它是在当前架构中创建<code class="codeph">MV_CAPABILITIES_TABLE</code> 。各种功能的说明<a href="basic-materialized-views.html#GUID-34046E83-7E73-495D-B071-30033E54C616__G1014360" title="此表描述了CAPABILITY_NAME列的值。">见表5-6</a> ， <a href="basic-materialized-views.html#GUID-382EA476-95A5-4B2C-B708-79849C37DC57__G1014409" title="此表描述了MV_CAPABILITIES_TABLE表中某些列的语义。">表5-7</a>列出了所有可能的消息。
                     </p>
                  </div>
                  <!-- class="section" -->
               </div><a id="DWHSG8219"></a><div class="props_rev_3"><a id="GUID-A5620B3E-42C2-48B8-AB24-85C83A6035C0" name="GUID-A5620B3E-42C2-48B8-AB24-85C83A6035C0"></a><h4 id="DWHSG-GUID-A5620B3E-42C2-48B8-AB24-85C83A6035C0" class="sect4"><span class="enumeration_section">5.10.1</span>使用DBMS_MVIEW.EXPLAIN_MVIEW过程</h4>
                  <div>
                     <div class="section">
                        <p><code class="codeph">EXPLAIN_MVIEW</code> proc edure具有以下参数：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">stmt_id</code></p>
                              <p>可选参数。客户端提供的唯一标识符，用于将输出行与<code class="codeph">EXPLAIN_MVIEW</code>特定调用相关联。</p>
                           </li>
                           <li>
                              <p><code class="codeph">MV</code></p>
                              <p>要分析的潜在物化视图的现有物化视图或查询定义的名称或整个<code class="codeph">CREATE</code> <code class="codeph">MATERIALIZED</code> <code class="codeph">VIEW</code>语句。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">MSG-阵列</code></p>
                              <p>接收输出的PL / SQL <code class="codeph">VARRAY</code> 。
                              </p>
                           </li>
                        </ul>
                        <p><code class="codeph">EXPLAIN_MVIEW</code>根据其刷新和重写功能分析指定的物化视图，并将其结果（以多行的形式）插入<code class="codeph">MV_CAPABILITIES_TABLE</code>或<code class="codeph">MSG_ARRAY</code> 。</p>
                        <div class="infoboxnotealso" id="GUID-A5620B3E-42C2-48B8-AB24-85C83A6035C0__GUID-99980C82-522E-4E67-83A2-7F421CF3BD62">
                           <p class="notep1">也可以看看：</p>
                           <p>有关<code class="codeph">DBMS_MVIEW</code>包的更多信息，请<code class="codeph">DBMS_MVIEW</code> <a href="../arpls/DBMS_MVIEW.html#ARPLS027" target="_blank"><span class="italic">Oracle Database PL / SQL包和类型参考</span></a></p>
                        </div>
                        <p>本节包含以下主题：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="basic-materialized-views.html#GUID-A3B09707-E5D5-4902-8181-B0D1FB2FC188">DBMS_MVIEW.EXPLAIN_MVIEW声明</a></p>
                           </li>
                           <li>
                              <p><a href="basic-materialized-views.html#GUID-37A6231A-2751-4EFB-9AF5-E5C60DB6393B">使用MV_CAPABILITIES_TABLE</a></p>
                           </li>
                           <li>
                              <p><a href="basic-materialized-views.html#GUID-34046E83-7E73-495D-B071-30033E54C616">MV_CAPABILITIES_TABLE.CAPABILITY_NAME详细信息</a></p>
                           </li>
                           <li>
                              <p><a href="basic-materialized-views.html#GUID-382EA476-95A5-4B2C-B708-79849C37DC57">MV_CAPABILITIES_TABLE列详细信息</a></p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div><a id="DWHSG8220"></a><div class="props_rev_3"><a id="GUID-A3B09707-E5D5-4902-8181-B0D1FB2FC188" name="GUID-A3B09707-E5D5-4902-8181-B0D1FB2FC188"></a><h5 id="DWHSG-GUID-A3B09707-E5D5-4902-8181-B0D1FB2FC188" class="sect5"><span class="enumeration_section">5.10.1.1</span> DBMS_MVIEW.EXPLAIN_MVIEW声明</h5>
                     <div>
                        <div class="section">
                           <p>下列<a id="d15276e5402" class="indexterm-anchor"></a>在<code class="codeph">DBMS_MVIEW</code>包中为您创建的PL / SQL声明显示了这些参数的顺序和数据类型，用于解释现有的物化视图和具有输出到表和<code class="codeph">VARRAY</code>的潜在物化视图。</p>
                           <p>使用输出到<code class="codeph">MV_CAPABILITIES_TABLE</code>来解释现有或潜在的物化视图：</p><pre class="oac_no_warn" dir="ltr">DBMS_MVIEW.EXPLAIN_MVIEW（mv IN VARCHAR2，stmt_id IN VARCHAR2：= NULL）;</pre><p>使用输出到<code class="codeph">VARRAY</code>解释现有或潜在的物化视图：</p><pre class="oac_no_warn" dir="ltr">DBMS_MVIEW.EXPLAIN_MVIEW（mv IN VARCHAR2，msg_array OUT SYS.ExplainMVArrayType）;</pre></div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="DWHSG8222"></a><a id="DWHSG8221"></a><div class="props_rev_3"><a id="GUID-37A6231A-2751-4EFB-9AF5-E5C60DB6393B" name="GUID-37A6231A-2751-4EFB-9AF5-E5C60DB6393B"></a><h5 id="DWHSG-GUID-37A6231A-2751-4EFB-9AF5-E5C60DB6393B" class="sect5"><span class="enumeration_section">5.10.1.2</span>使用MV_CAPABILITIES_TABLE</h5>
                     <div>
                        <div class="section">
                           <p>使用<code class="codeph">DBMS_MVIEW.EXPLAIN_MVIEW</code>的最简单方法<code class="codeph">DBMS_MVIEW.EXPLAIN_MVIEW</code>是<a id="d15276e5454" class="indexterm-anchor"></a>使用<code class="codeph">MV_CAPABILITIES_TABLE</code> ，它具有以下结构：</p><pre class="oac_no_warn" dir="ltr">CREATE TABLE MV_CAPABILITIES_TABLE（STATEMENT_ID VARCHAR（30）， - 客户端提供的唯一语句标识符MVOWNER VARCHAR（30）， - 基于SELECT的EXPLAIN_MVIEW MVNAME VARCHAR（30）的NULL， - 基于SELECT的EXPLAIN_MVIEW CAPABILITY_NAME VARCHAR（30）的NULL， - 特定的描述性名称 - 能力： -  REWRITE  - 至少可以完成全文匹配 - 重写 -  REWRITE_PARTIAL_TEXT_MATCH  - 至少可以完成和部分 - 文本匹配重写 -  REWRITE_GENERAL  - 可以做所有形式的重写 - 刷新 - 至少可以完成刷新 -  REFRESH_FROM_LOG_AFTER_INSERT  - 可以从mv日志快速刷新 - 或至少更改捕获表 - 当更新操作 - 限制为INSERT时 - REFRESH_FROM_LOG_AFTER_ANY  - 可以从mv日志快速刷新 - 或者在任何更新组合之后更改捕获表 -  PCT  - 可以在RELATED_NAME列中指定的表上执行增强更新跟踪。在表上进行分区维护操作（在RELATED_NAME列中命名）后快速刷新需要EUT，并且当mv部分 - 相对于表失效时 - 进行非陈旧容忍 - 重写 - 在RELATED_NAME列中命名。-  EUT有时还可以快速刷新表的更新 - 在RELATED_NAME列中命名 - 当从mv日志快速刷新 - 或更改捕获表时 - 不可能。- 请参阅<a href="basic-materialized-views.html#GUID-34046E83-7E73-495D-B071-30033E54C616__G1014360" title="此表描述了CAPABILITY_NAME列的值。">表5-6</a>可能的字符（1）， -  T =功能是可能的 -  F =功能不可能RELATED_TEXT VARCHAR（2000）， -  Owner.table.column，别名等， -与此消息相关。具体 - 本专栏的含义取决于-NSGNO列。有关详细信息，请参阅 -  DBMS_MVIEW.EXPLAIN_MVIEW（）的文档。RELATED_NUM NUMBER， - 当有一个数字值 - 与一行相关时，它就在这里。MSGNO INTEGER， - 可用时，QSM消息＃解释 - 为什么禁用或启用时更多详细信息。MSGTXT VARCHAR（2000）， - 与MSGNO相关的文本。 SEQ NUMBER）; - 在从此表中选择时，在ORDER BY子句中很有用。
</pre><p>您可以使用<code class="codeph">admin</code>目录中的<code class="codeph">utlxmv.sql</code>脚本来创建<code class="codeph">MV_CAPABILITIES_TABLE</code> 。</p>
                           <div class="infoboxnotealso" id="GUID-37A6231A-2751-4EFB-9AF5-E5C60DB6393B__GUID-D88801AE-16D1-4C06-A2B5-0DA46017B6F8">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><a href="refreshing-materialized-views.html#GUID-64068234-BDB0-4C12-AE70-75571046A586" title="每次在任何物化视图的基表上执行DML操作时，都会自动刷新使用ON STATEMENT刷新模式的物化视图。Oracle数据库对使用近似查询定义的物化视图执行快速刷新。在使用DBMS_REDEFINITION包在线重新定义表时，可以执行依赖于正在重新定义的表的快速可刷新实体化视图的增量刷新。您可以使用完整，快速或PCT刷新方法刷新基于混合分区表的实例化视图。">刷新物化视图</a>以获取有关分区更改跟踪的更多详细信息</p>
                                 </li>
                                 <li>
                                    <p><a href="advanced-query-rewrite-materialized-views.html#GUID-0906CA6B-7EE3-42E1-A598-C6541BCD9B36" title="查询重写认为混合分区表中的外部分区具有UNKNOWN新鲜度。因此，当查询从一个或多个外部分区请求数据时，它只能在TRUSTED或STALE_TOLERATED完整性模式下重写。如果可以使用物化视图回答这些查询，则会自动重写包含返回近似结果的SQL函数的查询以使用匹配的物化视图。可以重写对整数列包含COUNT（DISTINCT）操作的查询，以使用包含基于位图的函数的实体化视图。">有关物化视图的高级查询重写，以</a>获取有关分区更改跟踪的更多详细信息</p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-37A6231A-2751-4EFB-9AF5-E5C60DB6393B__GUID-DD2328B4-1CB9-4F6D-8ADF-5C6424676722">
                           <p class="titleinexample">示例5-9 DBMS_MVIEW.EXPLAIN_MVIEW</p>
                           <p>首先，创建物化视图。或者，您可以使用<code class="codeph">SELECT</code>语句或完整的<code class="codeph">CREATE</code> <code class="codeph">MATERIALIZED</code> <code class="codeph">VIEW</code>语句在潜在的物化视图上使用<code class="codeph">EXPLAIN_MVIEW</code> 。
                           </p><pre class="oac_no_warn" dir="ltr">CREATE MATERIALIZED VIEW cal_month_sales_mv构建立即刷新强制启用QUERY REWRITE作为选择t.calendar_month_desc，SUM（s.amount_sold）AS $ FROM sales s，times t WHERE s.time_id = t.time_id GROUP BY t.calendar_month_desc;</pre><p>然后，使用物化视图调用<code class="codeph">EXPLAIN_MVIEW</code>来解释。您需要在<code class="codeph">ORDER</code> <code class="codeph">BY</code>子句中使用<code class="codeph">SEQ</code>列，以便行以逻辑顺序显示。如果无法提供功能，则<code class="codeph">N</code>将显示在<code class="codeph">P</code>列中，并在<code class="codeph">MSGTXT</code>列中显示。如果由于多种原因无法提供功能，则会为每个原因显示一行。
                           </p><pre class="oac_no_warn" dir="ltr">EXECUTE DBMS_MVIEW.EXPLAIN_MVIEW（'SH.CAL_MONTH_SALES_MV'）; SELECT capability_name，possible，SUBSTR（related_text，1,8）AS rel_text，SUBSTR（msgtxt，1,60）AS msgtxt FROM MV_CAPABILITIES_TABLE ORDER BY seq;</pre><pre class="oac_no_warn" dir="ltr">CAPABILITY_NAME P REL_TEXT MSGTXT ---------------  -  -------- ------ PCT N REFRESH_COMPLETE Y REFRESH_FAST N REWRITE Y PCT_TABLE N SALES没有分区键或PMARKER在选择列表中PCT_TABLE N TIMES关系不是分区表REFRESH_FAST_AFTER_INSERT N SH.TIMES mv日志必须具有新值REFRESH_FAST_AFTER_INSERT N SH.TIMES mv log必须具有ROWID REFRESH_FAST_AFTER_INSERT N SH.TIMES mv log没有所有必需的列REFRESH_FAST_AFTER_INSERT N SH。 SALES mv log必须具有新值REFRESH_FAST_AFTER_INSERT N SH.SALES mv log必须具有ROWID REFRESH_FAST_AFTER_INSERT N SH.SALES mv日志没有所有必需的列REFRESH_FAST_AFTER_ONETAB_DML N DOLLARS SUM（expr）没有COUNT（expr）REFRESH_FAST_AFTER_ONETAB_DML N请参阅REFRESH_FAST_AFTER_INSERT的原因是已禁用REFRESH_FAST_AFTER_ONETAB_DML选择列表中没有N COUNT（*）REFRESH_FAST_AFTER_ONETAB_DML N SUM（expr）没有COUNT（expr）REFRESH_FAST_AFTER_ANY_DML N请参阅REFRESH_FAST_的原因AFTER_ONETAB_DML被禁用REFRESH_FAST_AFTER_ANY_DML N SH.TIMES mv log必须具有序列REFRESH_FAST_AFTER_ANY_DML N SH.SALES mv log必须具有序列REFRESH_PCT N PCT在物化视图中的任何详细信息表上都不可能REWRITE_FULL_TEXT_MATCH Y REWRITE_PARTIAL_TEXT_MATCH Y REWRITE_GENERAL Y REWRITE_PCT N PCT不是可以在任何细节表上</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="DWHSG8224"></a><a id="DWHSG8223"></a><div class="props_rev_3"><a id="GUID-34046E83-7E73-495D-B071-30033E54C616" name="GUID-34046E83-7E73-495D-B071-30033E54C616"></a><h5 id="DWHSG-GUID-34046E83-7E73-495D-B071-30033E54C616" class="sect5"><span class="enumeration_section">5.10.1.3</span> MV_CAPABILITIES_TABLE.CAPABILITY_NAME详细信息</h5>
                     <div>
                        <div class="section">
                           <p><a href="basic-materialized-views.html#GUID-34046E83-7E73-495D-B071-30033E54C616__G1014360" title="此表描述了CAPABILITY_NAME列的值。">表5-6</a>列出了<code class="codeph">CAPABILITY_NAME</code>列中值的说明。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="tblformalwide" id="GUID-34046E83-7E73-495D-B071-30033E54C616__G1014360">
                           <p class="titleintable">表5-6 CAPABILITY_NAME列详细信息</p>
                           <table cellpadding="4" cellspacing="0" class="FormalWide" title="CAPABILITY_NAME列详细信息" width="100%" border="1" summary="This table describes the values of the CAPABILITY_NAME column." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="21%" id="d15276e5605">CAPABILITY_NAME</th>
                                    <th align="left" valign="bottom" width="79%" id="d15276e5608">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="21%" id="d15276e5613" headers="d15276e5605 ">
                                       <p><code class="codeph">PCT</code></p>
                                    </td>
                                    <td align="left" valign="top" width="79%" headers="d15276e5613 d15276e5608 ">
                                       <p>如果可以使用此功能，则可以在至少一个详细信息关系上进行分区更改跟踪。如果无法使用此功能，则物化视图引用的任何详细信息关系都无法进行分区更改跟踪。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="21%" id="d15276e5621" headers="d15276e5605 ">
                                       <p><code class="codeph">REFRESH_COMPLETE</code></p>
                                    </td>
                                    <td align="left" valign="top" width="79%" headers="d15276e5621 d15276e5608 ">
                                       <p>如果可以使用此功能，则可以完全刷新物化视图。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="21%" id="d15276e5629" headers="d15276e5605 ">
                                       <p><code class="codeph">REFRESH_FAST</code></p>
                                    </td>
                                    <td align="left" valign="top" width="79%" headers="d15276e5629 d15276e5608 ">
                                       <p>如果可以实现此功能，则至少在某些情况下可以快速刷新。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="21%" id="d15276e5637" headers="d15276e5605 ">
                                       <p><code class="codeph">改写</code></p>
                                    </td>
                                    <td align="left" valign="top" width="79%" headers="d15276e5637 d15276e5608 ">
                                       <p>如果可以使用此功能，则至少可以进行全文匹配查询重写。如果无法使用此功能，则无法进行任何形式的查询重写。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="21%" id="d15276e5645" headers="d15276e5605 ">
                                       <p><code class="codeph">PCT_TABLE</code></p>
                                    </td>
                                    <td align="left" valign="top" width="79%" headers="d15276e5645 d15276e5608 ">
                                       <p>如果可以使用此功能，则可以针对顶级<code class="codeph">FROM</code>列表中的特定分区表进行操作。如果可能，分区更改跟踪（PCT）适用于<code class="codeph">RELATED_TEXT</code>列中指定的分区表。
                                       </p>
                                       <p>需要PCT来支持在<code class="codeph">RELATED_TEXT</code>列中指定的表上进行分区维护操作后的快速刷新。
                                       </p>
                                       <p>当无法从物化视图日志快速刷新时，PCT还可以支持对<code class="codeph">RELATED_TEXT</code>列中指定的表的更新进行快速刷新。
                                       </p>
                                       <p>对于在<code class="codeph">RELATED_TEXT</code>列中指定的表，在物化视图的部分过时的情况下，还需要PCT来支持查询重写。
                                       </p>
                                       <p>禁用时，PCT不适用于<code class="codeph">RELATED_TEXT</code>列中指定的表。在这种情况下，在<code class="codeph">RELATED_TEXT</code>列中指定的表上执行分区维护操作后，无法快速刷新。此外，无法对<code class="codeph">RELATED_TEXT</code>列中指定的表进行基于PCT的刷新更新。最后，对于在<code class="codeph">RELATED_TEXT</code>列中指定的表的物化视图的部分过时，不能支持查询重写。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="21%" id="d15276e5688" headers="d15276e5605 ">
                                       <p><code class="codeph">PCT_TABLE_REWRITE</code></p>
                                    </td>
                                    <td align="left" valign="top" width="79%" headers="d15276e5688 d15276e5608 ">
                                       <p>如果可以使用此功能，则可以针对顶级<code class="codeph">FROM</code>列表中的特定分区表进行操作。如果可能，PCT适用于<code class="codeph">RELATED_TEXT</code>列中指定的分区表。
                                       </p>
                                       <p>对于<code class="codeph">RELATED_TEXT</code>列中指定的表，需要此功能来支持针对部分失效状态下的物化视图的查询重写。
                                       </p>
                                       <p>禁用时，如果此<code class="codeph">RELATED_TEXT</code>化视图与<code class="codeph">RELATED_TEXT</code>列中指定的表处于部分失效状态，则不支持查询重写。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="21%" id="d15276e5712" headers="d15276e5605 ">
                                       <p><code class="codeph">REFRESH_FAST_AFTER_INSERT</code></p>
                                    </td>
                                    <td align="left" valign="top" width="79%" headers="d15276e5712 d15276e5608 ">
                                       <p>如果可以使用此功能，则至少在更新仅限于<code class="codeph">INSERT</code>操作的情况下，可以从物化视图日志快速刷新;完全刷新也是可能的。如果无法使用此功能，则无法从物化视图日志中进行快速刷新。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="21%" id="d15276e5723" headers="d15276e5605 ">
                                       <p><code class="codeph">REFRESH_FAST_AFTER_ONETAB_DML</code></p>
                                    </td>
                                    <td align="left" valign="top" width="79%" headers="d15276e5723 d15276e5608 ">
                                       <p>如果可以使用此功能，则无论更新操作的类型如何，只要在单个表上执行所有更新操作，都可以从物化视图日志快速刷新。如果无法使用此功能，则在对多个表执行更新操作时，可能无法从物化视图日志快速刷新。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="21%" id="d15276e5731" headers="d15276e5605 ">
                                       <p><code class="codeph">REFRESH_FAST_AFTER_ANY_DML</code></p>
                                    </td>
                                    <td align="left" valign="top" width="79%" headers="d15276e5731 d15276e5608 ">
                                       <p>如果可以使用此功能，则无论更新操作的类型或更新的表的数量如何，都可以从物化视图日志快速刷新。如果无法使用此功能，则当更新操作（ <code class="codeph">INSERT</code>除外）影响多个表时，可能无法从物化视图日志快速刷新。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="21%" id="d15276e5742" headers="d15276e5605 ">
                                       <p><code class="codeph">REFRESH_FAST_PCT</code></p>
                                    </td>
                                    <td align="left" valign="top" width="79%" headers="d15276e5742 d15276e5608 ">
                                       <p>如果可以使用此功能，则可以使用PCT进行快速刷新。通常，这意味着在对可能指示PCT的那些详细信息表进行分区维护操作之后，可以进行刷新。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="21%" id="d15276e5750" headers="d15276e5605 ">
                                       <p><code class="codeph">REWRITE_FULL_TEXT_MATCH</code></p>
                                    </td>
                                    <td align="left" valign="top" width="79%" headers="d15276e5750 d15276e5608 ">
                                       <p>如果可以使用此功能，则可以进行全文匹配查询重写。如果无法使用此功能，则无法进行全文匹配查询重写。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="21%" id="d15276e5759" headers="d15276e5605 ">
                                       <p><code class="codeph">REWRITE_PARTIAL_ TEXT_MATCH</code></p>
                                    </td>
                                    <td align="left" valign="top" width="79%" headers="d15276e5759 d15276e5608 ">
                                       <p>如果可以使用此功能，则至少可以进行完整和部分文本匹配查询重写。如果无法使用此功能，则至少部分文本匹配查询重写和一般查询重写是不可能的。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="21%" id="d15276e5767" headers="d15276e5605 ">
                                       <p><code class="codeph">REWRITE_GENERAL</code></p>
                                    </td>
                                    <td align="left" valign="top" width="79%" headers="d15276e5767 d15276e5608 ">
                                       <p>如果可以使用此功能，则可以使用所有查询重写功能，包括常规查询重写以及完整和部分文本匹配查询重写。如果无法使用此功能，则至少不能进行一般的查询重写。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="21%" id="d15276e5775" headers="d15276e5605 ">
                                       <p><code class="codeph">REWRITE_PCT</code></p>
                                    </td>
                                    <td align="left" valign="top" width="79%" headers="d15276e5775 d15276e5608 ">
                                       <p>如果可以使用此功能，即使在<code class="codeph">QUERY_REWRITE_INTEGRITY</code> = <code class="codeph">ENFORCED</code>或<code class="codeph">TRUSTED</code>模式下，查询重写也可以使用部分过时的物化视图。如果无法使用此功能，则查询重写只能在<code class="codeph">QUERY_REWRITE_INTEGRITY</code> = <code class="codeph">STALE_TOLERATED</code>模式下使用部分过时的物化视图。
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                  </div><a id="DWHSG8226"></a><a id="DWHSG8225"></a><div class="props_rev_3"><a id="GUID-382EA476-95A5-4B2C-B708-79849C37DC57" name="GUID-382EA476-95A5-4B2C-B708-79849C37DC57"></a><h5 id="DWHSG-GUID-382EA476-95A5-4B2C-B708-79849C37DC57" class="sect5"><span class="enumeration_section">5.10.1.4</span> MV_CAPABILITIES_TABLE列详细信息</h5>
                     <div>
                        <div class="section">
                           <p><a href="basic-materialized-views.html#GUID-382EA476-95A5-4B2C-B708-79849C37DC57__G1014409" title="此表描述了MV_CAPABILITIES_TABLE表中某些列的语义。">表5-7</a>列出了<code class="codeph">RELATED_TEXT</code>和<code class="codeph">RELATED_NUM</code>列的语义。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="tblformalwide" id="GUID-382EA476-95A5-4B2C-B708-79849C37DC57__G1014409">
                           <p class="titleintable">表5-7 MV_CAPABILITIES_TABLE列详细信息</p>
                           <table cellpadding="4" cellspacing="0" class="FormalWide" title="MV_CAPABILITIES_TABLE列详细信息" width="100%" border="1" summary="This table describes the semantics of some columns in the MV_CAPABILITIES_TABLE table." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="10%" id="d15276e5843">MSGNO</th>
                                    <th align="left" valign="bottom" width="33%" id="d15276e5846">MSGTXT</th>
                                    <th align="left" valign="bottom" width="21%" id="d15276e5849">RELATED_NUM</th>
                                    <th align="left" valign="bottom" width="36%" id="d15276e5852">RELATED_TEXT</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="10%" id="d15276e5857" headers="d15276e5843 ">
                                       <p><code class="codeph">空值</code></p>
                                    </td>
                                    <td align="left" valign="top" width="33%" headers="d15276e5857 d15276e5846 ">
                                       <p><code class="codeph">空值</code></p>
                                    </td>
                                    <td align="left" valign="top" width="21%" headers="d15276e5857 d15276e5849 ">
                                       <p></p>
                                    </td>
                                    <td align="left" valign="top" width="36%" headers="d15276e5857 d15276e5852 ">
                                       <p>仅适用于PCT功能： <code class="codeph">[</code> <span class="italic"><code class="codeph">owner</code></span> <code class="codeph">.]</code>启用PCT的表的<span class="italic"><code class="codeph">name</code></span></p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="10%" id="d15276e5882" headers="d15276e5843 ">
                                       <p>2066</p>
                                    </td>
                                    <td align="left" valign="top" width="33%" headers="d15276e5882 d15276e5846 ">
                                       <p>此声明导致Oracle错误</p>
                                    </td>
                                    <td align="left" valign="top" width="21%" headers="d15276e5882 d15276e5849 ">
                                       <p>发生的Oracle错误号</p>
                                    </td>
                                    <td align="left" valign="top" width="36%" headers="d15276e5882 d15276e5852 ">
                                       <p></p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="10%" id="d15276e5894" headers="d15276e5843 ">
                                       <p>2067</p>
                                    </td>
                                    <td align="left" valign="top" width="33%" headers="d15276e5894 d15276e5846 ">
                                       <p><code class="codeph">SELECT</code>列表中没有分区键或<code class="codeph">PMARKER</code>或连接相关表达式</p>
                                    </td>
                                    <td align="left" valign="top" width="21%" headers="d15276e5894 d15276e5849 ">
                                       <p></p>
                                    </td>
                                    <td align="left" valign="top" width="36%" headers="d15276e5894 d15276e5852 ">
                                       <p><code class="codeph">[</code> <span class="italic"><code class="codeph">owner</code></span> <code class="codeph">.]</code>不支持PCT的关系<span class="italic"><code class="codeph">name</code></span></p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="10%" id="d15276e5922" headers="d15276e5843 ">
                                       <p>2068</p>
                                    </td>
                                    <td align="left" valign="top" width="33%" headers="d15276e5922 d15276e5846 ">
                                       <p>关系未分区</p>
                                    </td>
                                    <td align="left" valign="top" width="21%" headers="d15276e5922 d15276e5849 ">
                                       <p></p>
                                    </td>
                                    <td align="left" valign="top" width="36%" headers="d15276e5922 d15276e5852 ">
                                       <p><code class="codeph">[</code> <span class="italic"><code class="codeph">owner</code></span> <code class="codeph">.]</code>不支持PCT的关系<span class="italic"><code class="codeph">name</code></span></p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="10%" id="d15276e5944" headers="d15276e5843 ">
                                       <p>2069</p>
                                    </td>
                                    <td align="left" valign="top" width="33%" headers="d15276e5944 d15276e5846 ">
                                       <p>PCT不支持多列分区键</p>
                                    </td>
                                    <td align="left" valign="top" width="21%" headers="d15276e5944 d15276e5849 ">
                                       <p></p>
                                    </td>
                                    <td align="left" valign="top" width="36%" headers="d15276e5944 d15276e5852 ">
                                       <p><code class="codeph">[</code> <span class="italic"><code class="codeph">owner</code></span> <code class="codeph">.]</code>不支持PCT的关系<span class="italic"><code class="codeph">name</code></span></p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="10%" id="d15276e5966" headers="d15276e5843 ">
                                       <p>2070</p>
                                    </td>
                                    <td align="left" valign="top" width="33%" headers="d15276e5966 d15276e5846 ">
                                       <p>PCT不支持此类分区</p>
                                    </td>
                                    <td align="left" valign="top" width="21%" headers="d15276e5966 d15276e5849 ">
                                       <p></p>
                                    </td>
                                    <td align="left" valign="top" width="36%" headers="d15276e5966 d15276e5852 ">
                                       <p><code class="codeph">[</code> <span class="italic"><code class="codeph">owner</code></span> <code class="codeph">.]</code>不支持PCT的关系<span class="italic"><code class="codeph">name</code></span></p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="10%" id="d15276e5988" headers="d15276e5843 ">
                                       <p>2071</p>
                                    </td>
                                    <td align="left" valign="top" width="33%" headers="d15276e5988 d15276e5846 ">
                                       <p>内部错误：未定义的PCT故障代码</p>
                                    </td>
                                    <td align="left" valign="top" width="21%" headers="d15276e5988 d15276e5849 ">
                                       <p>无法识别的数字PCT故障代码</p>
                                    </td>
                                    <td align="left" valign="top" width="36%" headers="d15276e5988 d15276e5852 ">
                                       <p><code class="codeph">[</code> <span class="italic"><code class="codeph">owner</code></span> <code class="codeph">.]</code>不支持PCT的关系<span class="italic"><code class="codeph">name</code></span></p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="10%" id="d15276e6011" headers="d15276e5843 ">
                                       <p>2072</p>
                                    </td>
                                    <td align="left" valign="top" width="33%" headers="d15276e6011 d15276e5846 ">
                                       <p>快速刷新嵌套的物化视图不满足要求</p>
                                    </td>
                                    <td align="left" valign="top" width="21%" headers="d15276e6011 d15276e5849 ">
                                       <p></p>
                                    </td>
                                    <td align="left" valign="top" width="36%" headers="d15276e6011 d15276e5852 ">
                                       <p></p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="10%" id="d15276e6022" headers="d15276e5843 ">
                                       <p>2077</p>
                                    </td>
                                    <td align="left" valign="top" width="33%" headers="d15276e6022 d15276e5846 ">
                                       <p>物化视图日志比上次完全刷新更新</p>
                                    </td>
                                    <td align="left" valign="top" width="21%" headers="d15276e6022 d15276e5849 ">
                                       <p></p>
                                    </td>
                                    <td align="left" valign="top" width="36%" headers="d15276e6022 d15276e5852 ">
                                       <p><code class="codeph">[</code> <span class="italic"><code class="codeph">owner</code></span> <code class="codeph">.]</code>表的<span class="italic"><code class="codeph">table_name</code></span> ，需要物化视图日志</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="10%" id="d15276e6044" headers="d15276e5843 ">
                                       <p>2078</p>
                                    </td>
                                    <td align="left" valign="top" width="33%" headers="d15276e6044 d15276e5846 ">
                                       <p>物化视图日志必须具有新值</p>
                                    </td>
                                    <td align="left" valign="top" width="21%" headers="d15276e6044 d15276e5849 ">
                                       <p></p>
                                    </td>
                                    <td align="left" valign="top" width="36%" headers="d15276e6044 d15276e5852 ">
                                       <p><code class="codeph">[</code> <span class="italic"><code class="codeph">owner</code></span> <code class="codeph">.]</code>表的<span class="italic"><code class="codeph">table_name</code></span> ，需要物化视图日志</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="10%" id="d15276e6066" headers="d15276e5843 ">
                                       <p>2079</p>
                                    </td>
                                    <td align="left" valign="top" width="33%" headers="d15276e6066 d15276e5846 ">
                                       <p>物化视图日志必须具有<code class="codeph">ROWID</code></p>
                                    </td>
                                    <td align="left" valign="top" width="21%" headers="d15276e6066 d15276e5849 ">
                                       <p></p>
                                    </td>
                                    <td align="left" valign="top" width="36%" headers="d15276e6066 d15276e5852 ">
                                       <p><code class="codeph">[</code> <span class="italic"><code class="codeph">owner</code></span> <code class="codeph">.]</code>表的<span class="italic"><code class="codeph">table_name</code></span> ，需要物化视图日志</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="10%" id="d15276e6091" headers="d15276e5843 ">
                                       <p>2080</p>
                                    </td>
                                    <td align="left" valign="top" width="33%" headers="d15276e6091 d15276e5846 ">
                                       <p>物化视图日志必须具有主键</p>
                                    </td>
                                    <td align="left" valign="top" width="21%" headers="d15276e6091 d15276e5849 ">
                                       <p></p>
                                    </td>
                                    <td align="left" valign="top" width="36%" headers="d15276e6091 d15276e5852 ">
                                       <p><code class="codeph">[</code> <span class="italic"><code class="codeph">owner</code></span> <code class="codeph">.]</code>表的<span class="italic"><code class="codeph">table_name</code></span> ，需要物化视图日志</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="10%" id="d15276e6113" headers="d15276e5843 ">
                                       <p>2081</p>
                                    </td>
                                    <td align="left" valign="top" width="33%" headers="d15276e6113 d15276e5846 ">
                                       <p>物化视图日志没有所有必需的列</p>
                                    </td>
                                    <td align="left" valign="top" width="21%" headers="d15276e6113 d15276e5849 ">
                                       <p></p>
                                    </td>
                                    <td align="left" valign="top" width="36%" headers="d15276e6113 d15276e5852 ">
                                       <p><code class="codeph">[</code> <span class="italic"><code class="codeph">owner</code></span> <code class="codeph">.]</code>表的<span class="italic"><code class="codeph">table_name</code></span> ，需要物化视图日志</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="10%" id="d15276e6135" headers="d15276e5843 ">
                                       <p>2082</p>
                                    </td>
                                    <td align="left" valign="top" width="33%" headers="d15276e6135 d15276e5846 ">
                                       <p>物化视图日志的问题</p>
                                    </td>
                                    <td align="left" valign="top" width="21%" headers="d15276e6135 d15276e5849 ">
                                       <p></p>
                                    </td>
                                    <td align="left" valign="top" width="36%" headers="d15276e6135 d15276e5852 ">
                                       <p><code class="codeph">[</code> <span class="italic"><code class="codeph">owner</code></span> <code class="codeph">.]</code>表的<span class="italic"><code class="codeph">table_name</code></span> ，需要物化视图日志</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="10%" id="d15276e6157" headers="d15276e5843 ">
                                       <p>2099</p>
                                    </td>
                                    <td align="left" valign="top" width="33%" headers="d15276e6157 d15276e5846 ">
                                       <p>物化视图引用<code class="codeph">FROM</code>列表中的远程表或视图</p>
                                    </td>
                                    <td align="left" valign="top" width="21%" headers="d15276e6157 d15276e5849 ">
                                       <p>从<code class="codeph">SELECT</code>关键字偏移到相关的表或视图</p>
                                    </td>
                                    <td align="left" valign="top" width="36%" headers="d15276e6157 d15276e5852 ">
                                       <p><code class="codeph">[</code> <span class="italic"><code class="codeph">owner</code></span> <code class="codeph">.]</code>相关表格或视图的<span class="italic"><code class="codeph">name</code></span></p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="10%" id="d15276e6186" headers="d15276e5843 ">
                                       <p>2126</p>
                                    </td>
                                    <td align="left" valign="top" width="33%" headers="d15276e6186 d15276e5846 ">
                                       <p>多个主站点</p>
                                    </td>
                                    <td align="left" valign="top" width="21%" headers="d15276e6186 d15276e5849 ">
                                       <p></p>
                                    </td>
                                    <td align="left" valign="top" width="36%" headers="d15276e6186 d15276e5852 ">
                                       <p>第一个不同节点的名称，如果第一个不同节点是本地节点，则为<code class="codeph">NULL</code></p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="10%" id="d15276e6201" headers="d15276e5843 ">
                                       <p>2129</p>
                                    </td>
                                    <td align="left" valign="top" width="33%" headers="d15276e6201 d15276e5846 ">
                                       <p>加入或过滤条件很复杂</p>
                                    </td>
                                    <td align="left" valign="top" width="21%" headers="d15276e6201 d15276e5849 ">
                                       <p></p>
                                    </td>
                                    <td align="left" valign="top" width="36%" headers="d15276e6201 d15276e5852 ">
                                       <p><code class="codeph">[</code> <span class="italic"><code class="codeph">owner</code></span> <code class="codeph">.]</code>参与连接或过滤条件的表的<span class="italic"><code class="codeph">name</code></span> （或不可用时为<code class="codeph">NULL</code> ）</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="10%" id="d15276e6226" headers="d15276e5843 ">
                                       <p>2130</p>
                                    </td>
                                    <td align="left" valign="top" width="33%" headers="d15276e6226 d15276e5846 ">
                                       <p>表达式不支持快速刷新</p>
                                    </td>
                                    <td align="left" valign="top" width="21%" headers="d15276e6226 d15276e5849 ">
                                       <p>从<code class="codeph">SELECT</code>关键字偏移到有问题的表达式</p>
                                    </td>
                                    <td align="left" valign="top" width="36%" headers="d15276e6226 d15276e5852 ">
                                       <p>有问题的表达式的<code class="codeph">SELECT</code>列表中的别名</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="10%" id="d15276e6245" headers="d15276e5843 ">
                                       <p>2150</p>
                                    </td>
                                    <td align="left" valign="top" width="33%" headers="d15276e6245 d15276e5846 ">
                                       <p><code class="codeph">UNION</code>运算符的<code class="codeph">SELECT</code>列表必须相同</p>
                                    </td>
                                    <td align="left" valign="top" width="21%" headers="d15276e6245 d15276e5849 ">
                                       <p>从<code class="codeph">SELECT</code>关键字偏移到<code class="codeph">SELECT</code>列表中的第一个不同的选择项</p>
                                    </td>
                                    <td align="left" valign="top" width="36%" headers="d15276e6245 d15276e5852 ">
                                       <p><code class="codeph">SELECT</code>列表中第一个不同选择项的别名</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="10%" id="d15276e6272" headers="d15276e5843 ">
                                       <p>2182</p>
                                    </td>
                                    <td align="left" valign="top" width="33%" headers="d15276e6272 d15276e5846 ">
                                       <p>PCT通过连接依赖项启用</p>
                                    </td>
                                    <td align="left" valign="top" width="21%" headers="d15276e6272 d15276e5849 ">
                                       <p></p>
                                    </td>
                                    <td align="left" valign="top" width="36%" headers="d15276e6272 d15276e5852 ">
                                       <p><code class="codeph">[</code> <span class="italic"><code class="codeph">owner</code></span> <code class="codeph">.]</code>未启用<code class="codeph">PCT_TABLE_REWRITE</code>的关系<span class="italic"><code class="codeph">name</code></span></p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="10%" id="d15276e6297" headers="d15276e5843 ">
                                       <p>2183</p>
                                    </td>
                                    <td align="left" valign="top" width="33%" headers="d15276e6297 d15276e5846 ">
                                       <p>表达式使PCT不在分析函数或模型的<code class="codeph">PARTITION</code> <code class="codeph">BY</code>中</p>
                                    </td>
                                    <td align="left" valign="top" width="21%" headers="d15276e6297 d15276e5849 ">
                                       <p>无法识别的数字PCT故障代码</p>
                                    </td>
                                    <td align="left" valign="top" width="36%" headers="d15276e6297 d15276e5852 ">
                                       <p><code class="codeph">[</code> <span class="italic"><code class="codeph">owner</code></span> <code class="codeph">.]</code>未启用PCT的关系<span class="italic"><code class="codeph">name</code></span></p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="10%" id="d15276e6326" headers="d15276e5843 ">
                                       <p>2184</p>
                                    </td>
                                    <td align="left" valign="top" width="33%" headers="d15276e6326 d15276e5846 ">
                                       <p>无法汇总启用PCT的表达方式</p>
                                    </td>
                                    <td align="left" valign="top" width="21%" headers="d15276e6326 d15276e5849 ">
                                       <p></p>
                                    </td>
                                    <td align="left" valign="top" width="36%" headers="d15276e6326 d15276e5852 ">
                                       <p><code class="codeph">[</code> <span class="italic"><code class="codeph">owner</code></span> <code class="codeph">.]</code>未启用PCT的关系<span class="italic"><code class="codeph">name</code></span></p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="10%" id="d15276e6349" headers="d15276e5843 ">
                                       <p>2185</p>
                                    </td>
                                    <td align="left" valign="top" width="33%" headers="d15276e6349 d15276e5846 ">
                                       <p><code class="codeph">SELECT</code>列表中没有分区键或<code class="codeph">PMARKER</code></p>
                                    </td>
                                    <td align="left" valign="top" width="21%" headers="d15276e6349 d15276e5849 ">
                                       <p></p>
                                    </td>
                                    <td align="left" valign="top" width="36%" headers="d15276e6349 d15276e5852 ">
                                       <p><code class="codeph">[</code> <span class="italic"><code class="codeph">owner</code></span> <code class="codeph">.]</code>未启用<code class="codeph">PCT_TABLE_REWRITE</code>的关系<span class="italic"><code class="codeph">name</code></span></p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="10%" id="d15276e6380" headers="d15276e5843 ">
                                       <p>2186</p>
                                    </td>
                                    <td align="left" valign="top" width="33%" headers="d15276e6380 d15276e5846 ">
                                       <p><code class="codeph">GROUP</code> <code class="codeph">OUTER</code> <code class="codeph">JOIN</code>存在</p>
                                    </td>
                                    <td align="left" valign="top" width="21%" headers="d15276e6380 d15276e5849 ">
                                       <p></p>
                                    </td>
                                    <td align="left" valign="top" width="36%" headers="d15276e6380 d15276e5852 ">
                                       <p></p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="10%" id="d15276e6399" headers="d15276e5843 ">
                                       <p>2187</p>
                                    </td>
                                    <td align="left" valign="top" width="33%" headers="d15276e6399 d15276e5846 ">
                                       <p>外部表上的物化视图</p>
                                    </td>
                                    <td align="left" valign="top" width="21%" headers="d15276e6399 d15276e5849 ">
                                       <p></p>
                                    </td>
                                    <td align="left" valign="top" width="36%" headers="d15276e6399 d15276e5852 ">
                                       <p></p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>