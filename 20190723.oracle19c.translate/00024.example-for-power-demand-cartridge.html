<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>电力需求墨盒示例</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Data Cartridge Developer&#39;s Guide"></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Data Cartridge Developer&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="data-cartridge-developers-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-10T07:34:53-08:00"></meta>
      <meta name="dcterms.title" content="Data Cartridge Developer&#39;s Guide"></meta>
      <meta name="dcterms.dateCopyrighted" content="1996, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96431-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="scenarios-and-examples.html" title="Previous" type="text/html"></link>
      <link rel="next" href="example-for-PSBTREE-extensible-indexing.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="ADDCI"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="scenarios-and-examples.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="example-for-PSBTREE-extensible-indexing.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">数据盒式开发人员指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="scenarios-and-examples.html" property="item" typeof="WebPage"><span property="name">场景和示例</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">电力需求墨盒示例</li>
            </ol>
            <a id="GUID-60A032E8-F21B-4026-847B-654BE6C38C17" name="GUID-60A032E8-F21B-4026-847B-654BE6C38C17"></a><a id="ADDCI3150"></a>
            
            <h2 id="ADDCI-GUID-60A032E8-F21B-4026-847B-654BE6C38C17" class="sect2"><span class="enumeration_chapter">15</span>电源需求盒示例</h2>
         </header>
         <div class="ind">
            <div>
               <p><a id="d43303e52" class="indexterm-anchor"></a><a id="d43303e54" class="indexterm-anchor"></a>此示例中的电源需求盒包括用户定义的对象类型，可扩展索引和优化。整个盒式磁带定义可在Oracle演示目录的<code class="codeph">extdemo1.sql</code>文件中在线获得。
               </p>
               <div class="infoboxnotealso" id="GUID-60A032E8-F21B-4026-847B-654BE6C38C17__GUID-5B014064-2FD1-44C0-BF6B-890E9A1DC32A">
                  <p class="notep1">也可以看看：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="building-domain-indexes.html#GUID-E370B5E4-BAC0-49C6-B17D-830B3A507FB4">构建域索引</a>以获取有关可扩展查询优化的信息</p>
                     </li>
                     <li>
                        <p><a href="using-extensible-optimizer.html#GUID-7E1BFCFC-9C05-4CC6-9E4F-B1B1212DBE84" title="在分析域索引本身时，不会发生系统管理的域索引的用户定义的统计信息收集。相反，在调用DBMS_STATS包中定义的GATHER _ * _ STATS过程期间收集索引统计信息时，将调用对ODCIStatsCollect（）的调用。同样，在调用DBMS_STATS包中定义的DELETE _ * _ STATS过程期间，将调用对ODCIStatsDelete（）删除域索引统计信息的调用。此主题说明如何收集系统管理的域索引的统计信息。本主题说明如何删除系统管理的域索引的统计信息。本主题说明如何收集本地系统管理的域索引的所有分区的统计信息。本主题说明如何删除本地系统管理的域索引的所有分区的统计信息。本主题说明如何收集本地系统管理的域索引的分区P2的统计信息。本主题说明如何删除本地系统管理的域索引的分区P2的统计信息。本主题说明如何收集本地系统管理的域索引的复合分区的所有子分区的统计信息。本主题说明如何删除本地系统管理的域索引的复合分区的所有子分区的统计信息。此主题说明如何收集本地系统管理的域索引的子分区的统计信息。此主题说明如何删除子分区的统计信息。本地系统管理的域索引">使用Extensible Optimizer</a>获取有关可扩展索引的信息</p>
                     </li>
                     <li>
                        <p><a href="using-cartridge-services.html#GUID-2CB76BF0-C6C9-46BB-89C4-3619BC7A0F39">使用墨盒服务</a>有关墨盒服务信息</p>
                     </li>
                  </ul>
               </div>
            </div><a id="ADDCI4779"></a><a id="ADDCI4780"></a><a id="ADDCI4781"></a><a id="ADDCI4782"></a><a id="ADDCI4783"></a><a id="ADDCI4784"></a><a id="ADDCI4785"></a><a id="ADDCI4786"></a><a id="ADDCI4778"></a><div class="props_rev_3"><a id="GUID-DF72AE3E-E469-4A87-B3F8-5D60D73FCEEC" name="GUID-DF72AE3E-E469-4A87-B3F8-5D60D73FCEEC"></a><h3 id="ADDCI-GUID-DF72AE3E-E469-4A87-B3F8-5D60D73FCEEC" class="sect3"><span class="enumeration_section">15.1</span>功能要求</h3>
               <div>
                  <p><a id="d43303e165" class="indexterm-anchor"></a><a id="d43303e169" class="indexterm-anchor"></a><a id="d43303e173" class="indexterm-anchor"></a><a id="d43303e175" class="indexterm-anchor"></a> <span class="italic">Power-To-People</span>的电力公用事业<span class="italic">公司</span>开发了一种复杂的模型来决定如何部署其资源。公用事业服务的区域由铺设在地理区域上的网格表示。该网格<a href="example-for-power-demand-cartridge.html#GUID-DF72AE3E-E469-4A87-B3F8-5D60D73FCEEC__BABJAIIE">如图15-1所示</a> 。
                  </p>
                  <div class="figure" id="GUID-DF72AE3E-E469-4A87-B3F8-5D60D73FCEEC__BABJAIIE">
                     <p class="titleinfigure">图15-1 Power Utility服务的区域</p><img src="img/addci004.gif" alt="下面是图15-1的描述" title="下面是图15-1的描述" longdesc="img_text/addci004.html"><br><a href="img_text/addci004.html">“图15-1 Power Utility服务区域”的描述</a></div>
                  <!-- class="figure" -->
                  <p>该区域可能被其他区域包围，其中一些区域的电力需求由其他公用事业提供。如图所示，每个区域由10x10网格上的地理象限（称为单元格）组成。有几种方法可以识别单元格 - 按空间坐标（经度/纬度），矩阵编号（1,1; 1,2; ...），并按顺序编号， <a href="example-for-power-demand-cartridge.html#GUID-DF72AE3E-E469-4A87-B3F8-5D60D73FCEEC__BABEHDCE">如图15-2所示</a> 。
                  </p>
                  <div class="figure" id="GUID-DF72AE3E-E469-4A87-B3F8-5D60D73FCEEC__BABEHDCE">
                     <p class="titleinfigure">图15-2编号序列中的区域网格单元格</p><img src="img/addci006.gif" alt="下面是图15-2的描述" title="下面是图15-2的描述" longdesc="img_text/addci006.html"><br><a href="img_text/addci006.html">“图15-2编号序列中的区域网格单元”的描述</a></div>
                  <!-- class="figure" -->
                  <p>在每个小区所代表的区域内，每小时记录消费者在该区域使用的功率。例如，特定小时的功率需求读数可以由<a href="example-for-power-demand-cartridge.html#GUID-DF72AE3E-E469-4A87-B3F8-5D60D73FCEEC__BGEGFJDE" title="列出给定小时的样本电力需求读数">表15-1</a>表示（这里的单元表示在矩阵上）。
                  </p>
                  <div class="tblformal" id="GUID-DF72AE3E-E469-4A87-B3F8-5D60D73FCEEC__BGEGFJDE">
                     <p class="titleintable">表15-1一小时的电力需求读数示例</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="一小时的电力需求读数示例" width="100%" border="1" summary="Lists sample power demand readings for a given hour" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="9%" id="d43303e224">-</th>
                              <th align="left" valign="bottom" width="9%" id="d43303e227">1</th>
                              <th align="left" valign="bottom" width="9%" id="d43303e231">2</th>
                              <th align="left" valign="bottom" width="9%" id="d43303e235">3</th>
                              <th align="left" valign="bottom" width="9%" id="d43303e239">4</th>
                              <th align="left" valign="bottom" width="9%" id="d43303e243">五</th>
                              <th align="left" valign="bottom" width="9%" id="d43303e247">6</th>
                              <th align="left" valign="bottom" width="9%" id="d43303e251">7</th>
                              <th align="left" valign="bottom" width="9%" id="d43303e255">8</th>
                              <th align="left" valign="bottom" width="9%" id="d43303e259">9</th>
                              <th align="left" valign="bottom" width="9%" id="d43303e263">10</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="9%" id="d43303e269" headers="d43303e224 ">
                                 <p><span class="bold">1</span></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e269 d43303e227 ">
                                 <p><code class="codeph">23</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e269 d43303e231 ">
                                 <p><code class="codeph">21</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e269 d43303e235 ">
                                 <p><code class="codeph">25</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e269 d43303e239 ">
                                 <p><code class="codeph">23</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e269 d43303e243 ">
                                 <p><code class="codeph">24</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e269 d43303e247 ">
                                 <p><code class="codeph">25</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e269 d43303e251 ">
                                 <p><code class="codeph">27</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e269 d43303e255 ">
                                 <p><code class="codeph">32</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e269 d43303e259 ">
                                 <p><code class="codeph">31</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e269 d43303e263 ">
                                 <p><code class="codeph">三十</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="9%" id="d43303e314" headers="d43303e224 ">
                                 <p><span class="bold">2</span></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e314 d43303e227 ">
                                 <p><code class="codeph">33</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e314 d43303e231 ">
                                 <p><code class="codeph">32</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e314 d43303e235 ">
                                 <p><code class="codeph">31</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e314 d43303e239 ">
                                 <p><code class="codeph">33</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e314 d43303e243 ">
                                 <p><code class="codeph">34</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e314 d43303e247 ">
                                 <p><code class="codeph">32</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e314 d43303e251 ">
                                 <p><code class="codeph">23</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e314 d43303e255 ">
                                 <p><code class="codeph">22</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e314 d43303e259 ">
                                 <p><code class="codeph">21</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e314 d43303e263 ">
                                 <p><code class="codeph">34</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="9%" id="d43303e359" headers="d43303e224 ">
                                 <p><span class="bold">3</span></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e359 d43303e227 ">
                                 <p><code class="codeph">45</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e359 d43303e231 ">
                                 <p><code class="codeph">44</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e359 d43303e235 ">
                                 <p><code class="codeph">43</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e359 d43303e239 ">
                                 <p><code class="codeph">33</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e359 d43303e243 ">
                                 <p><code class="codeph">44</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e359 d43303e247 ">
                                 <p><code class="codeph">43</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e359 d43303e251 ">
                                 <p><code class="codeph">42</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e359 d43303e255 ">
                                 <p><code class="codeph">41</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e359 d43303e259 ">
                                 <p><code class="codeph">45</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e359 d43303e263 ">
                                 <p><code class="codeph">46</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="9%" id="d43303e404" headers="d43303e224 ">
                                 <p><span class="bold">4</span></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e404 d43303e227 ">
                                 <p><code class="codeph">44</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e404 d43303e231 ">
                                 <p><code class="codeph">45</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e404 d43303e235 ">
                                 <p><code class="codeph">45</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e404 d43303e239 ">
                                 <p><code class="codeph">43</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e404 d43303e243 ">
                                 <p><code class="codeph">42</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e404 d43303e247 ">
                                 <p><code class="codeph">26</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e404 d43303e251 ">
                                 <p><code class="codeph">19</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e404 d43303e255 ">
                                 <p><code class="codeph">44</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e404 d43303e259 ">
                                 <p><code class="codeph">33</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e404 d43303e263 ">
                                 <p><code class="codeph">43</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="9%" id="d43303e449" headers="d43303e224 ">
                                 <p><span class="bold">五</span></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e449 d43303e227 ">
                                 <p><code class="codeph">45</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e449 d43303e231 ">
                                 <p><code class="codeph">44</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e449 d43303e235 ">
                                 <p><code class="codeph">43</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e449 d43303e239 ">
                                 <p><code class="codeph">42</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e449 d43303e243 ">
                                 <p><code class="codeph">41</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e449 d43303e247 ">
                                 <p><code class="codeph">44</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e449 d43303e251 ">
                                 <p><code class="codeph">45</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e449 d43303e255 ">
                                 <p><code class="codeph">46</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e449 d43303e259 ">
                                 <p><code class="codeph">47</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e449 d43303e263 ">
                                 <p><code class="codeph">44</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="9%" id="d43303e494" headers="d43303e224 ">
                                 <p><span class="bold">6</span></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e494 d43303e227 ">
                                 <p><code class="codeph">43</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e494 d43303e231 ">
                                 <p><code class="codeph">45</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e494 d43303e235 ">
                                 <p><code class="codeph">98</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e494 d43303e239 ">
                                 <p><code class="codeph">55</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e494 d43303e243 ">
                                 <p><code class="codeph">54</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e494 d43303e247 ">
                                 <p><code class="codeph">43</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e494 d43303e251 ">
                                 <p><code class="codeph">44</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e494 d43303e255 ">
                                 <p><code class="codeph">33</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e494 d43303e259 ">
                                 <p><code class="codeph">34</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e494 d43303e263 ">
                                 <p><code class="codeph">44</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="9%" id="d43303e539" headers="d43303e224 ">
                                 <p><span class="bold">7</span></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e539 d43303e227 ">
                                 <p><code class="codeph">33</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e539 d43303e231 ">
                                 <p><code class="codeph">45</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e539 d43303e235 ">
                                 <p><code class="codeph">44</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e539 d43303e239 ">
                                 <p><code class="codeph">43</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e539 d43303e243 ">
                                 <p><code class="codeph">33</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e539 d43303e247 ">
                                 <p><code class="codeph">44</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e539 d43303e251 ">
                                 <p><code class="codeph">34</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e539 d43303e255 ">
                                 <p><code class="codeph">55</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e539 d43303e259 ">
                                 <p><code class="codeph">46</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e539 d43303e263 ">
                                 <p><code class="codeph">34</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="9%" id="d43303e584" headers="d43303e224 ">
                                 <p><span class="bold">8</span></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e584 d43303e227 ">
                                 <p><code class="codeph">87</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e584 d43303e231 ">
                                 <p><code class="codeph">34</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e584 d43303e235 ">
                                 <p><code class="codeph">33</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e584 d43303e239 ">
                                 <p><code class="codeph">32</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e584 d43303e243 ">
                                 <p><code class="codeph">31</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e584 d43303e247 ">
                                 <p><code class="codeph">34</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e584 d43303e251 ">
                                 <p><code class="codeph">35</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e584 d43303e255 ">
                                 <p><code class="codeph">38</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e584 d43303e259 ">
                                 <p><code class="codeph">33</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e584 d43303e263 ">
                                 <p><code class="codeph">39</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="9%" id="d43303e629" headers="d43303e224 ">
                                 <p><span class="bold">9</span></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e629 d43303e227 ">
                                 <p><code class="codeph">三十</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e629 d43303e231 ">
                                 <p><code class="codeph">40</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e629 d43303e235 ">
                                 <p><code class="codeph">43</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e629 d43303e239 ">
                                 <p><code class="codeph">42</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e629 d43303e243 ">
                                 <p><code class="codeph">33</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e629 d43303e247 ">
                                 <p><code class="codeph">43</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e629 d43303e251 ">
                                 <p><code class="codeph">34</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e629 d43303e255 ">
                                 <p><code class="codeph">32</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e629 d43303e259 ">
                                 <p><code class="codeph">34</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e629 d43303e263 ">
                                 <p><code class="codeph">46</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="9%" id="d43303e674" headers="d43303e224 ">
                                 <p><span class="bold">10</span></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e674 d43303e227 ">
                                 <p><code class="codeph">43</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e674 d43303e231 ">
                                 <p><code class="codeph">42</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e674 d43303e235 ">
                                 <p><code class="codeph">34</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e674 d43303e239 ">
                                 <p><code class="codeph">12</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e674 d43303e243 ">
                                 <p><code class="codeph">43</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e674 d43303e247 ">
                                 <p><code class="codeph">45</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e674 d43303e251 ">
                                 <p><code class="codeph">48</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e674 d43303e255 ">
                                 <p><code class="codeph">45</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e674 d43303e259 ">
                                 <p><code class="codeph">43</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d43303e674 d43303e263 ">
                                 <p><code class="codeph">32</code></p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <p>发电站还接收来自其他两个来源的报告：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>地面上的<span class="italic">传感器</span>为每个电池提供温度读数</p>
                        <p>通过分析来自电池的历史电力需求与这些区域的温度读数之间的相关性，公用事业能够在给定特定温度的情况下以近似的方式确定预期需求。</p>
                     </li>
                     <li>
                        <p><span class="italic">卫星摄像机</span>提供有关当前条件的图像，这些图像被转换为与<a href="example-for-power-demand-cartridge.html#GUID-DF72AE3E-E469-4A87-B3F8-5D60D73FCEEC__BABICABD">图15-3</a>中<a href="example-for-power-demand-cartridge.html#GUID-DF72AE3E-E469-4A87-B3F8-5D60D73FCEEC__BABICABD">所示</a>网格匹配的灰度图像。
                        </p>
                     </li>
                  </ul>
                  <div class="figure" id="GUID-DF72AE3E-E469-4A87-B3F8-5D60D73FCEEC__BABICABD">
                     <p class="titleinfigure">图15-3卫星图像的灰度表示</p><img src="img/addci025.gif" alt="下面是图15-3的描述" title="下面是图15-3的描述" longdesc="img_text/addci025.html"><br><a href="img_text/addci025.html">“图15-3卫星图像的灰度表示”的描述</a></div>
                  <!-- class="figure" -->
                  <p>这些图像的设计使得打火机更冷。因此，图像显示了从西南方向移动到该区域的冷锋。通过将灰度图像提供的数据与同时获得的温度读数相关联，公用事业公司已经能够确定从平流层看到的天气条件下的电力需求。</p>
                  <p>这一点很重要的原因是，这种建模的关键部分与注意到天气变化和电力部署时输入报告的快速性和变化程度有关。下图显示了第二次录制时的相同冷锋， <a href="example-for-power-demand-cartridge.html#GUID-DF72AE3E-E469-4A87-B3F8-5D60D73FCEEC__BABIDHGD">如图15-4所示</a> 。
                  </p>
                  <div class="figure" id="GUID-DF72AE3E-E469-4A87-B3F8-5D60D73FCEEC__BABIDHGD">
                     <p class="titleinfigure">图15-4第二次记录时天气状况的灰度表示</p><img src="img/addci026.gif" alt="下面是图15-4的描述" title="下面是图15-4的描述" longdesc="img_text/addci026.html"><br><a href="img_text/addci026.html">“图15-4第二次录制时天气状况的灰度表示”的说明</a></div>
                  <!-- class="figure" -->
                  <p>通过分析冷锋的范围和速度，公用事业公司能够预测短期和中期可能出现的条件， <a href="example-for-power-demand-cartridge.html#GUID-DF72AE3E-E469-4A87-B3F8-5D60D73FCEEC__BABHCAIH">如图15-5所示</a> 。
                  </p>
                  <div class="figure" id="GUID-DF72AE3E-E469-4A87-B3F8-5D60D73FCEEC__BABHCAIH">
                     <p class="titleinfigure">图15-5预测条件的灰度表示</p><img src="img/addci041.gif" alt="下面是图15-5的描述" title="下面是图15-5的描述" longdesc="img_text/addci041.html"><br><a href="img_text/addci041.html">“图15-5投影条件的灰度表示”的说明</a></div>
                  <!-- class="figure" -->
                  <p>通过梳理有关这些条件和其他异常情况（例如变电站故障）的数据，公用事业必须能够组织其资源的最佳部署。<a href="example-for-power-demand-cartridge.html#GUID-DF72AE3E-E469-4A87-B3F8-5D60D73FCEEC__BABFCGBC">图15-6</a>反映了整个地区的变电站分布情况。
                  </p>
                  <div class="figure" id="GUID-DF72AE3E-E469-4A87-B3F8-5D60D73FCEEC__BABFCGBC">
                     <p class="titleinfigure">图15-6各地区电站的分布情况</p><img src="img/addci020.gif" alt="下面是图15-6的描述" title="下面是图15-6的描述" longdesc="img_text/addci020.html"><br><a href="img_text/addci020.html">“图15-6各地区电站分布”的说明</a></div>
                  <!-- class="figure" -->
                  <p>发电站的分布意味着公用事业公司可以将其电力部署重新定向到最需要的地区。<a href="example-for-power-demand-cartridge.html#GUID-DF72AE3E-E469-4A87-B3F8-5D60D73FCEEC__BABBHACJ">图15-7</a>给出了三个站之间重叠的图示。
                  </p>
                  <div class="figure" id="GUID-DF72AE3E-E469-4A87-B3F8-5D60D73FCEEC__BABBHACJ">
                     <p class="titleinfigure">图15-7三个发电站服务的区域</p><img src="img/addci021.gif" alt="下面是图15-7的描述" title="下面是图15-7的描述" longdesc="img_text/addci021.html"><br><a href="img_text/addci021.html">“图15-7三个发电站服务的区域”的描述</a></div>
                  <!-- class="figure" -->
                  <p>根据波动的要求，公用事业公司必须能够决定如何部署其资源，甚至是否能够在发生短缺时从其他公用事业公司购买电力。</p>
               </div>
            </div><a id="ADDCI4788"></a><a id="ADDCI4787"></a><div class="props_rev_3"><a id="GUID-9E9E9B45-983F-446C-BDD0-3706FF8903C7" name="GUID-9E9E9B45-983F-446C-BDD0-3706FF8903C7"></a><h3 id="ADDCI-GUID-9E9E9B45-983F-446C-BDD0-3706FF8903C7" class="sect3"><span class="enumeration_section">15.2</span>应用程序建模</h3>
               <div>
                  <p>考虑用于建模应用程序的技术和业务场景。<a href="example-for-power-demand-cartridge.html#GUID-9E9E9B45-983F-446C-BDD0-3706FF8903C7__BABGCEHD">图15-8</a>中的类图描述了使用统一建模语言（UML）表示法的应用程序对象。
                  </p>
                  <div class="figure" id="GUID-9E9E9B45-983F-446C-BDD0-3706FF8903C7__BABGCEHD">
                     <p class="titleinfigure">图15-8电源需求盒的应用对象模型</p><img src="img/addci029.gif" alt="下面是图15-8的描述" title="下面是图15-8的描述" longdesc="img_text/addci029.html"><br><a href="img_text/addci029.html">“图15-8电源需求盒的应用对象模型”的描述</a></div>
                  <!-- class="figure" -->
               </div><a id="ADDCI4790"></a><a id="ADDCI4791"></a><a id="ADDCI4789"></a><div class="props_rev_3"><a id="GUID-4BBDDBE4-4574-402B-A4A7-3528AB218F83" name="GUID-4BBDDBE4-4574-402B-A4A7-3528AB218F83"></a><h4 id="ADDCI-GUID-4BBDDBE4-4574-402B-A4A7-3528AB218F83" class="sect4"><span class="enumeration_section">15.2.1</span>样本查询</h4>
                  <div>
                     <div class="section">
                        <p>以这种方式对应用程序建模使得以下特定查询成为可能：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>找到对指定时间段具有最高需求的单元格（地理象限）。</p>
                           </li>
                           <li>
                              <p>找出总需求最高的时间段。</p>
                           </li>
                           <li>
                              <p>查找需求大于某个指定值的所有单元格。</p>
                           </li>
                           <li>
                              <p>在需求等于某个指定值的任何时间查找任何单元格。</p>
                           </li>
                           <li>
                              <p>查找3个或更多单元格的需求大于指定值的任何时间段。</p>
                           </li>
                           <li>
                              <p>找出具有最小需求的单元与具有最大需求的单元之间存在最大差异（差异）的时间段。</p>
                           </li>
                           <li>
                              <p>找出10个或更多单元格需求不低于某个指定值的时间。</p>
                           </li>
                           <li>
                              <p>找出平均单元格需求大于某个指定值的时间。</p>
                              <p>请注意，假设通过<code class="codeph">TotalPowerDemand/100</code>可以轻松计算平均值。
                              </p>
                           </li>
                           <li>
                              <p>找出中值单元格需求大于某个指定值的时间段。</p>
                              <p>请注意，我们假设中值不易计算。</p>
                           </li>
                           <li>
                              <p>查找总需求比上一次总需求增加10％或更多的所有时间段。</p>
                           </li>
                        </ul>
                        <p>当然，这些查询只是可以从系统中收集的可能信息的简短列表。例如，显然这样的应用程序的开发人员想要构建基于从先前查询派生的信息的查询：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>与前一个时间段相比，特定单元的需求变化百分比是多少？</p>
                           </li>
                           <li>
                              <p>哪些细胞表现出快速增加或减少的需求，以大于或小于指定值的百分比来衡量？</p>
                           </li>
                        </ul>
                        <p><a href="example-for-power-demand-cartridge.html#GUID-4BBDDBE4-4574-402B-A4A7-3528AB218F83__BABJEFDG">图15-9</a>描述并说明了已实施的Power Demand盒式磁带。
                        </p>
                        <div class="figure" id="GUID-4BBDDBE4-4574-402B-A4A7-3528AB218F83__BABJEFDG">
                           <p class="titleinfigure">图15-9电源需求盒的实现模型</p><img src="img/addci028.gif" alt="下面是图15-9的描述" title="下面是图15-9的描述" longdesc="img_text/addci028.html"><br><a href="img_text/addci028.html">“图15-9电力需求盒的实施模型”的描述</a></div>
                        <!-- class="figure" -->
                        <p>公用事业公司接收来自气象中心的关于当前状况的持续报告以及来自发电站的关于特定地理区域的持续电力利用的报告（由10x10网格上的小区表示）。然后，它将此信息与历史数据进行比较，以便预测给定时间段内不同地理区域的电力需求。</p>
                        <p>该实用程序的每个服务区域被视为10x10的单元格网格，其中每个单元格的边界与空间坐标（经度/纬度）相关联。由细胞表示的地理区域可以是均匀的或可以具有不同的形状和大小。在每个小区所代表的区域内，每小时记录消费者在该区域使用的功率。例如，特定小时的电力需求读数可以由<a href="example-for-power-demand-cartridge.html#GUID-4BBDDBE4-4574-402B-A4A7-3528AB218F83__G1012310" title="列出与上一个表不同的小时的样本电力需求读数">表15-2</a>表示。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="tblformal" id="GUID-4BBDDBE4-4574-402B-A4A7-3528AB218F83__G1012310">
                        <p class="titleintable">表15-2一小时的电源需求读数示例</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="一小时的电力需求读数示例" width="100%" border="1" summary="Lists sample power demand readings for a different hour than a previous table" frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="9%" id="d43303e986">-</th>
                                 <th align="left" valign="bottom" width="9%" id="d43303e989">1</th>
                                 <th align="left" valign="bottom" width="9%" id="d43303e993">2</th>
                                 <th align="left" valign="bottom" width="9%" id="d43303e997">3</th>
                                 <th align="left" valign="bottom" width="9%" id="d43303e1001">4</th>
                                 <th align="left" valign="bottom" width="9%" id="d43303e1005">五</th>
                                 <th align="left" valign="bottom" width="9%" id="d43303e1009">6</th>
                                 <th align="left" valign="bottom" width="9%" id="d43303e1013">7</th>
                                 <th align="left" valign="bottom" width="9%" id="d43303e1017">8</th>
                                 <th align="left" valign="bottom" width="9%" id="d43303e1021">9</th>
                                 <th align="left" valign="bottom" width="9%" id="d43303e1025">10</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="9%" id="d43303e1031" headers="d43303e986 ">
                                    <p><span class="bold">1</span></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1031 d43303e989 ">
                                    <p><code class="codeph">23</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1031 d43303e993 ">
                                    <p><code class="codeph">21</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1031 d43303e997 ">
                                    <p><code class="codeph">25</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1031 d43303e1001 ">
                                    <p><code class="codeph">23</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1031 d43303e1005 ">
                                    <p><code class="codeph">24</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1031 d43303e1009 ">
                                    <p><code class="codeph">25</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1031 d43303e1013 ">
                                    <p><code class="codeph">27</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1031 d43303e1017 ">
                                    <p><code class="codeph">32</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1031 d43303e1021 ">
                                    <p><code class="codeph">31</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1031 d43303e1025 ">
                                    <p><code class="codeph">三十</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="9%" id="d43303e1076" headers="d43303e986 ">
                                    <p><span class="bold">2</span></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1076 d43303e989 ">
                                    <p><code class="codeph">33</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1076 d43303e993 ">
                                    <p><code class="codeph">32</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1076 d43303e997 ">
                                    <p><code class="codeph">31</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1076 d43303e1001 ">
                                    <p><code class="codeph">33</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1076 d43303e1005 ">
                                    <p><code class="codeph">34</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1076 d43303e1009 ">
                                    <p><code class="codeph">32</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1076 d43303e1013 ">
                                    <p><code class="codeph">23</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1076 d43303e1017 ">
                                    <p><code class="codeph">22</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1076 d43303e1021 ">
                                    <p><code class="codeph">21</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1076 d43303e1025 ">
                                    <p><code class="codeph">34</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="9%" id="d43303e1121" headers="d43303e986 ">
                                    <p><span class="bold">3</span></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1121 d43303e989 ">
                                    <p><code class="codeph">45</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1121 d43303e993 ">
                                    <p><code class="codeph">44</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1121 d43303e997 ">
                                    <p><code class="codeph">43</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1121 d43303e1001 ">
                                    <p><code class="codeph">33</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1121 d43303e1005 ">
                                    <p><code class="codeph">44</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1121 d43303e1009 ">
                                    <p><code class="codeph">43</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1121 d43303e1013 ">
                                    <p><code class="codeph">42</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1121 d43303e1017 ">
                                    <p><code class="codeph">41</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1121 d43303e1021 ">
                                    <p><code class="codeph">45</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1121 d43303e1025 ">
                                    <p><code class="codeph">46</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="9%" id="d43303e1166" headers="d43303e986 ">
                                    <p><span class="bold">4</span></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1166 d43303e989 ">
                                    <p><code class="codeph">44</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1166 d43303e993 ">
                                    <p><code class="codeph">45</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1166 d43303e997 ">
                                    <p><code class="codeph">45</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1166 d43303e1001 ">
                                    <p><code class="codeph">43</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1166 d43303e1005 ">
                                    <p><code class="codeph">42</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1166 d43303e1009 ">
                                    <p><code class="codeph">26</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1166 d43303e1013 ">
                                    <p><code class="codeph">19</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1166 d43303e1017 ">
                                    <p><code class="codeph">44</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1166 d43303e1021 ">
                                    <p><code class="codeph">33</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1166 d43303e1025 ">
                                    <p><code class="codeph">43</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="9%" id="d43303e1211" headers="d43303e986 ">
                                    <p><span class="bold">五</span></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1211 d43303e989 ">
                                    <p><code class="codeph">45</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1211 d43303e993 ">
                                    <p><code class="codeph">44</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1211 d43303e997 ">
                                    <p><code class="codeph">43</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1211 d43303e1001 ">
                                    <p><code class="codeph">42</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1211 d43303e1005 ">
                                    <p><code class="codeph">41</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1211 d43303e1009 ">
                                    <p><code class="codeph">44</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1211 d43303e1013 ">
                                    <p><code class="codeph">45</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1211 d43303e1017 ">
                                    <p><code class="codeph">46</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1211 d43303e1021 ">
                                    <p><code class="codeph">47</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1211 d43303e1025 ">
                                    <p><code class="codeph">44</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="9%" id="d43303e1256" headers="d43303e986 ">
                                    <p><span class="bold">6</span></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1256 d43303e989 ">
                                    <p><code class="codeph">43</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1256 d43303e993 ">
                                    <p><code class="codeph">45</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1256 d43303e997 ">
                                    <p><code class="codeph">98</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1256 d43303e1001 ">
                                    <p><code class="codeph">55</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1256 d43303e1005 ">
                                    <p><code class="codeph">54</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1256 d43303e1009 ">
                                    <p><code class="codeph">43</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1256 d43303e1013 ">
                                    <p><code class="codeph">44</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1256 d43303e1017 ">
                                    <p><code class="codeph">33</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1256 d43303e1021 ">
                                    <p><code class="codeph">34</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1256 d43303e1025 ">
                                    <p><code class="codeph">44</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="9%" id="d43303e1301" headers="d43303e986 ">
                                    <p><span class="bold">7</span></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1301 d43303e989 ">
                                    <p><code class="codeph">33</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1301 d43303e993 ">
                                    <p><code class="codeph">45</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1301 d43303e997 ">
                                    <p><code class="codeph">44</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1301 d43303e1001 ">
                                    <p><code class="codeph">43</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1301 d43303e1005 ">
                                    <p><code class="codeph">33</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1301 d43303e1009 ">
                                    <p><code class="codeph">44</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1301 d43303e1013 ">
                                    <p><code class="codeph">34</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1301 d43303e1017 ">
                                    <p><code class="codeph">55</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1301 d43303e1021 ">
                                    <p><code class="codeph">46</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1301 d43303e1025 ">
                                    <p><code class="codeph">34</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="9%" id="d43303e1346" headers="d43303e986 ">
                                    <p><span class="bold">8</span></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1346 d43303e989 ">
                                    <p><code class="codeph">87</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1346 d43303e993 ">
                                    <p><code class="codeph">34</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1346 d43303e997 ">
                                    <p><code class="codeph">33</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1346 d43303e1001 ">
                                    <p><code class="codeph">32</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1346 d43303e1005 ">
                                    <p><code class="codeph">31</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1346 d43303e1009 ">
                                    <p><code class="codeph">34</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1346 d43303e1013 ">
                                    <p><code class="codeph">35</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1346 d43303e1017 ">
                                    <p><code class="codeph">38</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1346 d43303e1021 ">
                                    <p><code class="codeph">33</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1346 d43303e1025 ">
                                    <p><code class="codeph">39</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="9%" id="d43303e1391" headers="d43303e986 ">
                                    <p><span class="bold">9</span></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1391 d43303e989 ">
                                    <p><code class="codeph">三十</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1391 d43303e993 ">
                                    <p><code class="codeph">40</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1391 d43303e997 ">
                                    <p><code class="codeph">43</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1391 d43303e1001 ">
                                    <p><code class="codeph">42</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1391 d43303e1005 ">
                                    <p><code class="codeph">33</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1391 d43303e1009 ">
                                    <p><code class="codeph">43</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1391 d43303e1013 ">
                                    <p><code class="codeph">34</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1391 d43303e1017 ">
                                    <p><code class="codeph">32</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1391 d43303e1021 ">
                                    <p><code class="codeph">34</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1391 d43303e1025 ">
                                    <p><code class="codeph">46</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="9%" id="d43303e1436" headers="d43303e986 ">
                                    <p><span class="bold">10</span></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1436 d43303e989 ">
                                    <p><code class="codeph">43</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1436 d43303e993 ">
                                    <p><code class="codeph">42</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1436 d43303e997 ">
                                    <p><code class="codeph">34</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1436 d43303e1001 ">
                                    <p><code class="codeph">12</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1436 d43303e1005 ">
                                    <p><code class="codeph">43</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1436 d43303e1009 ">
                                    <p><code class="codeph">45</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1436 d43303e1013 ">
                                    <p><code class="codeph">48</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1436 d43303e1017 ">
                                    <p><code class="codeph">45</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1436 d43303e1021 ">
                                    <p><code class="codeph">43</code></p>
                                 </td>
                                 <td align="left" valign="top" width="9%" headers="d43303e1436 d43303e1025 ">
                                    <p><code class="codeph">32</code></p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <div class="section">
                        <p>每个单元中的数字反映该区域的小时的功率需求（在由电力公用事业确定的某个测量单位中）。例如，对第一个单元（1,1）的需求为23，对第二个单元（1,2）的需求为21，依此类推。对最后一个小区（10,10）的需求是32。</p>
                        <p>该实用程序将此数据用于许多监视和分析应用程序。监测各个电池的读数是否存在异常浪涌或需求减少。例如，（6,3）的98和（8,1）的87的读数可能异常高，（4,7）的19和（10,4）的读数可能异常低。还分析了趋势，例如每个站点的每个邻域的需求显着增加或减少，并且总体上随着时间的推移而增加或减少。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="ADDCI4792"></a><div class="props_rev_3"><a id="GUID-C78F49B3-DA5A-47A0-81B6-518F87691C91" name="GUID-C78F49B3-DA5A-47A0-81B6-518F87691C91"></a><h3 id="ADDCI-GUID-C78F49B3-DA5A-47A0-81B6-518F87691C91" class="sect3"><span class="enumeration_section">15.3</span>查询和可扩展索引</h3>
               <div>
                  <p>考虑从域索引中受益的各种查询。使用可扩展索引的选择取决于查询是使用标准Oracle索引高效运行，还是根本没有索引。</p>
               </div><a id="ADDCI4793"></a><div class="props_rev_3"><a id="GUID-8CD2A893-EB35-4962-9B2A-EE3F395A17DB" name="GUID-8CD2A893-EB35-4962-9B2A-EE3F395A17DB"></a><h4 id="ADDCI-GUID-8CD2A893-EB35-4962-9B2A-EE3F395A17DB" class="sect4"><span class="enumeration_section">15.3.1</span>查询不受可扩展索引的影响</h4>
                  <div>
                     <p><a id="d43303e1595" class="indexterm-anchor"></a><a id="d43303e1601" class="indexterm-anchor"></a>如果满足以下两个条件，则查询不需要域索引：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>可以将所需信息作为表的属性（列），并且可以在该列上定义标准索引。</p>
                        </li>
                        <li>
                           <p>对数据的查询中的操作仅限于标准索引支持的操作，例如b-tree索引的<code class="codeph">equals</code> ， <code class="codeph">lessthan</code> ， <code class="codeph">greaterthan</code> ， <code class="codeph">max</code>和<code class="codeph">min</code> 。
                           </p>
                        </li>
                     </ul>
                     <p>在<code class="codeph">PowerDemand_Typ</code>对象类型盒式磁带示例中，三列（ <code class="codeph">TotGridDemand</code> ， <code class="codeph">MaxCellDemand</code>和<code class="codeph">MinCellDemand</code> ）的值由函数设置，之后值不会更改。（例如，1998年1月1日13:00的总电网电力需求在计算后不会改变。）对于使用这些列的查询，每列上的标准b树索引就足够了，建议用于<code class="codeph">equals</code> ， <code class="codeph">lessthan</code> ， <code class="codeph">greaterthan</code> ， <code class="codeph">max</code>和<code class="codeph">min</code> 。
                     </p>
                     <p>无法从可扩展索引（使用电源需求盒式磁带）中受益的查询示例包括：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>找到特定时间内具有最高功率需求的单元。</p>
                        </li>
                        <li>
                           <p>找出总电网电力需求最高的时间。</p>
                        </li>
                        <li>
                           <p>查找电源需求大于指定值的所有单元。</p>
                        </li>
                        <li>
                           <p>找出平均细胞需求或中值细胞需求大于指定值的时间。</p>
                           <p>要使此查询高效运行，请在<code class="codeph">PowerDemand_Typ</code>对象类型（ <code class="codeph">AverageCellDemand</code>和<code class="codeph">MedianCellDemand</code> ）中定义另外两列，并创建函数以设置这些列的值。（例如， <code class="codeph">AverageCellDemand</code>是<code class="codeph">TotGridDemand</code>除以100.）然后，在<code class="codeph">AverageCellDemand</code>和<code class="codeph">MedianCellDemand</code>列上创建b-tree索引。
                           </p>
                        </li>
                     </ul>
                  </div>
               </div><a id="ADDCI4794"></a><div class="props_rev_3"><a id="GUID-9EF4FDCF-4717-43F8-A1E0-BE5AF74E662D" name="GUID-9EF4FDCF-4717-43F8-A1E0-BE5AF74E662D"></a><h4 id="ADDCI-GUID-9EF4FDCF-4717-43F8-A1E0-BE5AF74E662D" class="sect4"><span class="enumeration_section">15.3.2</span>查询受益于可扩展索引</h4>
                  <div>
                     <p><a id="d43303e1751" class="indexterm-anchor"></a><a id="d43303e1757" class="indexterm-anchor"></a>如果要查询的数据不能成为表的简单属性，或者要对数据执行的操作不是Oracle索引支持的标准操作之一，则查询将受益于域索引。
                     </p>
                     <p>可从可扩展索引（使用电源需求盒式磁带）中受益的查询示例包括：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>找到电源需求等于指定值的指定时间的第一个单元。</p>
                           <p>通过询问第一个单元格，查询超出了简单的真假检查（例如查明指定时间内的<span class="italic">任何</span>单元格是否具有等于指定值的需求），从而受益于域索引。
                           </p>
                        </li>
                        <li>
                           <p>找出最小需求的单元格与具有最小需求的单元格和具有最大需求的单元格之间的差异的时间。</p>
                        </li>
                        <li>
                           <p>查找<code class="codeph">3</code>或更多单元格的需求大于指定值的所有时间。
                           </p>
                        </li>
                        <li>
                           <p>查找10个或更多单元格的需求不低于指定值的所有时间。</p>
                        </li>
                        <li>
                           <p>查找总电网需求比上一次电网总需求增加10％或更多的所有时间。</p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div><a id="ADDCI4795"></a><div class="props_rev_3"><a id="GUID-C21C2320-540B-496F-8DFB-C37E6717FF32" name="GUID-C21C2320-540B-496F-8DFB-C37E6717FF32"></a><h3 id="ADDCI-GUID-C21C2320-540B-496F-8DFB-C37E6717FF32" class="sect3"><span class="enumeration_section">15.4</span>创建域索引</h3>
               <div>
                  <p><a id="d43303e1842" class="indexterm-anchor"></a><a id="d43303e1848" class="indexterm-anchor"></a>考虑电源需求盒的部分，因为它们与可扩展索引有关。解释性文本和代码段是混合的。
                  </p>
                  <p><a id="d43303e1854" class="indexterm-anchor"></a><a id="d43303e1856" class="indexterm-anchor"></a><a id="d43303e1860" class="indexterm-anchor"></a>整个盒式磁带定义可在标准Oracle演示目录中以extdemo1.sql在线获得（位置取决于平台）。
                  </p>
               </div><a id="ADDCI4797"></a><a id="ADDCI4796"></a><div class="props_rev_3"><a id="GUID-4E99E2E1-3152-4450-A5A1-3007E5FC6841" name="GUID-4E99E2E1-3152-4450-A5A1-3007E5FC6841"></a><h4 id="ADDCI-GUID-4E99E2E1-3152-4450-A5A1-3007E5FC6841" class="sect4"><span class="enumeration_section">15.4.1</span>创建拥有索引的模式</h4>
                  <div>
                     <div class="section">
                        <p>在创建域索引之前，请创建数据库用户或架构。拥有索引。在电力需求<span class="italic"> </span>例如，创建用户<code class="codeph">PowerCartUser</code>并授予相应的权限。与该盒式磁带相关的所有数据库结构都是在此用户下创建的（即，当盒式磁带开发人员或DBA作为<code class="codeph">PowerCartUser</code>连接到数据库时），如<a href="example-for-power-demand-cartridge.html#GUID-4E99E2E1-3152-4450-A5A1-3007E5FC6841__CIAEDEHD">例15-1所示</a> 。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-4E99E2E1-3152-4450-A5A1-3007E5FC6841__CIAEDEHD">
                        <p class="titleinexample">示例15-1为Power Demand Cartridge创建数据库用户</p><pre class="oac_no_warn" dir="ltr">将connect sys / knl_test7上的echo设置为sysdba; drop用户PowerCartUser级联;创建PowerCartUser标识的用户PowerCartUser; -------------------------------------------------- -  -  -  -  -  -  -  - -  -  初始设置  -  -  -  -  -  -  -  -  -  -  -  -  - - ----------------------------------------  - 授予权限 - 授予连接，资源到PowerCartUser;授予PowerCartUser创建运营商;将create indextype授予PowerCartUser;将create table授予PowerCartUser;</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADDCI4799"></a><a id="ADDCI4798"></a><div class="props_rev_3"><a id="GUID-B5FAAD9E-228D-43FB-B939-EB48EEF4BA3F" name="GUID-B5FAAD9E-228D-43FB-B939-EB48EEF4BA3F"></a><h4 id="ADDCI-GUID-B5FAAD9E-228D-43FB-B939-EB48EEF4BA3F" class="sect4"><span class="enumeration_section">15.4.2</span>创建对象类型</h4>
                  <div>
                     <div class="section">
                        <p>对象类型<code class="codeph">PowerDemand_Typ</code>存储每小时电网读数。此类型用于定义表中存储读数的列。
                        </p>
                        <p>首先，定义了三种类型供以后使用，如<a href="example-for-power-demand-cartridge.html#GUID-B5FAAD9E-228D-43FB-B939-EB48EEF4BA3F__CIABCEDC">例15-2所示</a> 。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">PowerGrid_Typ</code>定义<code class="codeph">PowerGrid_Typ</code>的单元<code class="codeph">PowerDemand_Typ</code> 。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">NumTab_Typ</code>用于存储索引条目的表中。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">PowerDemand_Typ</code>类型包括以下内容：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>由三个成员过程设置的三个属性（ <code class="codeph">TotGridDemand</code> ， <code class="codeph">MaxCellDemand</code> ， <code class="codeph">MinCellDemand</code> ）</p>
                                 </li>
                                 <li>
                                    <p>电力需求读数（网格中的<code class="codeph">100</code>单元）</p>
                                 </li>
                                 <li>
                                    <p>电力需求读数的日期/时间。（每小时， <code class="codeph">100</code>区域传输其电力需求读数。）
                                    </p>
                                 </li>
                              </ul>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-B5FAAD9E-228D-43FB-B939-EB48EEF4BA3F__CIABCEDC">
                        <p class="titleinexample">示例15-2创建电源需求盒的类型</p><pre class="oac_no_warn" dir="ltr">创建或替换类型PowerGrid_Typ为NUMBER的VARRAY（100）;创建或替换类型NumTab_Typ作为NUMBER表;</pre><pre class="oac_no_warn" dir="ltr">创建或替换类型PowerDemand_Typ AS OBJECT（ - 网格的总功率需求TotGridDemand NUMBER， - 具有网格最大/最小功率需求的单元MaxCellDemand NUMBER，MinCellDemand NUMBER， - 电网：10X10阵列表示为Varray（100） - 使用先前定义的PowerGrid_Typ CellDemandValues PowerGrid_Typ， - 电力需求采样的日期/时间：每小时， -  100个区域传输其电力需求读数。SampleTime DATE， -   - 此类型的方法（Set ...）： - 整个电网的总需求 -  SampleTime：设置TotGridDemand的值。成员过程SetTotalDemand， - 对于整个电网的最大需求 -  SampleTime：设置MaxCellDemand的值。成员程序SetMaxDemand， - 对整个电网的最低需求 -  SampleTime：设置MinCellDemand的值。成员程序SetMinDemand）; /</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADDCI4802"></a><a id="ADDCI4801"></a><div class="props_rev_3"><a id="GUID-E4ECA421-B472-45C7-B4BE-92958672D4AD" name="GUID-E4ECA421-B472-45C7-B4BE-92958672D4AD"></a><h4 id="ADDCI-GUID-E4ECA421-B472-45C7-B4BE-92958672D4AD" class="sect4"><span class="enumeration_section">15.4.3</span>定义对象类型方法</h4>
                  <div>
                     <div class="section">
                        <p><code class="codeph">PowerDemand_Typ</code>对象类型具有在类型定义中设置前三个属性的方法：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">TotGridDemand</code> ，相关小时的整个电网总需求（由<code class="codeph">SampleTime</code>确定）</p>
                           </li>
                           <li>
                              <p><code class="codeph">MaxCellDemand</code> ，所有单元的功率要求最高的价值<code class="codeph">SampleTime</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">MinCellDemand</code> ，所有细胞的最低功率需求值<code class="codeph">SampleTime</code></p>
                           </li>
                        </ul>
                        <p>每个程序的逻辑并不复杂。<code class="codeph">SetTotDemand</code>遍历单元格值并创建运行总计。<code class="codeph">SetMaxDemand</code>比较前两个单元格值并将较高值保存为当前最高值;然后检查每个连续的单元格，将其与当前最高值进行比较，并将两者中的较高者保存为当前最高值，直到达到单元格值的末尾。<code class="codeph">SetMinDemand</code>使用相同的方法<code class="codeph">SetMaxDemand</code> ，但它不断保存在比较下限值到总体导出的最低值，如在展示<a href="example-for-power-demand-cartridge.html#GUID-E4ECA421-B472-45C7-B4BE-92958672D4AD__CIAEIAFE">实施例15-3</a> 。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-E4ECA421-B472-45C7-B4BE-92958672D4AD__CIAEIAFE">
                        <p class="titleinexample">示例15-3为Power Demand Cartridge实现对象类型</p><pre class="oac_no_warn" dir="ltr">创建或替换类型体PowerDemand_Typ IS  -   - 此类型的方法（设置...）： - 整个电网的总需求 -  SampleTime：设置TotGridDemand的值。成员程序SetTotalDemand IS I BINARY_INTEGER;总数; BEGIN总计：= 0;我：= CellDemandValues。第一;当我不是空时LOOP Total：= Total + CellDemandValues（I）;我：= CellDemandValues。NEXT（I）;结束循环; TotGridDemand：=总计;结束; - 对于整个电网的最大需求 -  SampleTime：设置MaxCellDemand的值。成员过程SetMaxDemand IS I BINARY_INTEGER;临时号码; BEGIN I：= CellDemandValues。第一; Temp：= CellDemandValues（I）;虽然我不是空的循环如果Temp &lt;CellDemandValues（I）THEN Temp：= CellDemandValues（I）;万一;我：= CellDemandValues。NEXT（I）;结束循环; MaxCellDemand：= Temp;结束; - 对整个电网的最低需求 -  SampleTime：设置MinCellDemand的值。成员程序SetMinDemand IS I BINARY_INTEGER;临时号码; BEGIN I：= CellDemandValues。第一; Temp：= CellDemandValues（I）;如果我不是NULL LOOP IF Temp&gt; CellDemandValues（I）THEN Temp：= CellDemandValues（I）;万一;我：= CellDemandValues。NEXT（I）;结束循环; MinCellDemand：= Temp;结束;结束; /</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADDCI4804"></a><a id="ADDCI4803"></a><div class="props_rev_3"><a id="GUID-8CEF68C3-827D-4265-A86C-912B503755E9" name="GUID-8CEF68C3-827D-4265-A86C-912B503755E9"></a><h4 id="ADDCI-GUID-8CEF68C3-827D-4265-A86C-912B503755E9" class="sect4"><span class="enumeration_section">15.4.4</span>了解函数和操作符</h4>
                  <div>
                     <p>电力需求筒的设计，使用户可以查询的关系电网<code class="codeph">equality</code> ， <code class="codeph">greaterthan</code> ，或<code class="codeph">lessthan</code> 。但是，由于存储单元格需求数据的方式，因此不能使用标准运算符（ <code class="codeph">=</code> ， <code class="codeph">&gt;</code> ， <code class="codeph">&lt;</code> ）。相反，必须创建新的运算符，并且必须创建一个函数来定义每个新运算符的实现（即Oracle如何解释运算符）。
                     </p>
                     <p>对于此墨盒，可以通过两种方式检查三种关系中的每一种：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>网格中的特定单元是否满足关系。例如，是否存在小区<code class="codeph">(3,7)</code>需求等于<code class="codeph">25</code>网格？
                           </p>
                           <p>这些运算符的名称格式为<code class="codeph">Power_XxxxxSpecific()</code> ，例如<code class="codeph">Power_EqualsSpecific()</code> ，实现函数的名称格式为<code class="codeph">Power_XxxxxSpecific_Func()</code> 。
                           </p>
                        </li>
                        <li>
                           <p>网格中的任何单元格是否满足关系。例如，是否存在任何单元格需求等于<code class="codeph">25</code>网格？
                           </p>
                           <p>这些运算符的名称格式为<code class="codeph">Power_XxxxxAny()</code> ，例如<code class="codeph">Power_EqualsAny()</code> ，实现函数的名称格式为<code class="codeph">Power_XxxxxAny_Func()</code> 。
                           </p>
                        </li>
                     </ul>
                     <p>对于每个操作员 - 功能对，首先定义该功能，然后使用该功能定义操作员。该函数是在没有定义索引的情况下使用的实现。必须指定此实现，以便Oracle优化程序可以确定成本，决定是否应使用索引，以及创建执行计划。</p>
                     <p><a href="example-for-power-demand-cartridge.html#GUID-8CEF68C3-827D-4265-A86C-912B503755E9__G1012446" title="列出为Power Demand盒示例定义的操作符及其实现功能">表15-3</a>显示了运算符和实现函数：</p>
                     <div class="tblformal" id="GUID-8CEF68C3-827D-4265-A86C-912B503755E9__G1012446">
                        <p class="titleintable">表15-3运算符和实现函数</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="运算符和实现函数" width="100%" border="1" summary="Lists operators defined for the Power Demand cartridge example along with their implementing functions" frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="40%" id="d43303e2294">操作者</th>
                                 <th align="left" valign="bottom" width="60%" id="d43303e2297">实现功能</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="40%" id="d43303e2302" headers="d43303e2294 "><pre class="oac_no_warn" dir="ltr">Power_EqualsSpecific（）</pre></td>
                                 <td align="left" valign="top" width="60%" headers="d43303e2302 d43303e2297 "><pre class="oac_no_warn" dir="ltr">Power_EqualsSpecific_Func（）</pre></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="40%" id="d43303e2309" headers="d43303e2294 "><pre class="oac_no_warn" dir="ltr">Power_EqualsAny（）</pre></td>
                                 <td align="left" valign="top" width="60%" headers="d43303e2309 d43303e2297 "><pre class="oac_no_warn" dir="ltr">Power_EqualsAny_Func（）</pre></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="40%" id="d43303e2316" headers="d43303e2294 "><pre class="oac_no_warn" dir="ltr">Power_LessThanSpecific（）</pre></td>
                                 <td align="left" valign="top" width="60%" headers="d43303e2316 d43303e2297 "><pre class="oac_no_warn" dir="ltr">Power_LessThanSpecific_Func（）</pre></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="40%" id="d43303e2323" headers="d43303e2294 "><pre class="oac_no_warn" dir="ltr">Power_LessThanAny（）</pre></td>
                                 <td align="left" valign="top" width="60%" headers="d43303e2323 d43303e2297 "><pre class="oac_no_warn" dir="ltr">Power_LessThanAny_Func（）</pre></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="40%" id="d43303e2330" headers="d43303e2294 "><pre class="oac_no_warn" dir="ltr">Power_GreaterThanSpecific（）</pre></td>
                                 <td align="left" valign="top" width="60%" headers="d43303e2330 d43303e2297 "><pre class="oac_no_warn" dir="ltr">Power_GreaterThanSpecific_Func（）</pre></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="40%" id="d43303e2337" headers="d43303e2294 "><pre class="oac_no_warn" dir="ltr">Power_GreaterThanAny（）</pre></td>
                                 <td align="left" valign="top" width="60%" headers="d43303e2337 d43303e2297 "><pre class="oac_no_warn" dir="ltr">Power_GreaterThanAny_Func（）</pre></td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p>如果条件为真，则每个函数和运算符返回数值<code class="codeph">1</code> （例如，如果指定的单元格等于指定的值），如果条件不为真，则返回<code class="codeph">0</code>如果指定的单元格编号无效，则返回<code class="codeph">null</code> 。
                     </p>
                     <p><a href="example-for-power-demand-cartridge.html#GUID-C3FD1445-8E14-423F-BAC5-CDE6CE63A0DA__CIAFCFJD">例15-4中</a>的语句创建了实现函数<code class="codeph">Power_xxx_Func()</code> ，首先是<code class="codeph">specific</code> ，然后是<code class="codeph">any</code>实现。
                     </p>
                     <p><a href="example-for-power-demand-cartridge.html#GUID-C3FD1445-8E14-423F-BAC5-CDE6CE63A0DA__CIADJEDC">例15-5中</a>的语句创建了运算符（ <code class="codeph">Power_xxx</code> ）。每个语句都指定一个实现函数。
                     </p>
                  </div><a id="ADDCI4806"></a><a id="ADDCI4805"></a><div class="props_rev_3"><a id="GUID-C3FD1445-8E14-423F-BAC5-CDE6CE63A0DA" name="GUID-C3FD1445-8E14-423F-BAC5-CDE6CE63A0DA"></a><h5 id="ADDCI-GUID-C3FD1445-8E14-423F-BAC5-CDE6CE63A0DA" class="sect5"><span class="enumeration_section">15.4.4.1</span>创建函数和操作符</h5>
                     <div>
                        <div class="section">
                           <p>示例<a href="example-for-power-demand-cartridge.html#GUID-C3FD1445-8E14-423F-BAC5-CDE6CE63A0DA__CIAFCFJD">示例15-4</a>和<a href="example-for-power-demand-cartridge.html#GUID-C3FD1445-8E14-423F-BAC5-CDE6CE63A0DA__CIADJEDC">示例15-5</a>演示了如何为以前定义的Power Demand盒式对象类型实现函数和运算符。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-C3FD1445-8E14-423F-BAC5-CDE6CE63A0DA__CIAFCFJD">
                           <p class="titleinexample">示例15-4为Power Demand Cartridge实现Power_XXX_Func（）函数</p><pre class="oac_no_warn" dir="ltr">CREATE FUNCTION Power_EqualsSpecific_Func（对象PowerDemand_Typ，单元格NUMBER，值NUMBER）返回NUMBER作为BEGIN IF cell &lt;= object。CellDemandValues。最后一次（对象。CellDemandValues（cell）= value）THEN RETURN 1; ELSE RETURN 0;万一; ELSE RETURN NULL;万一;结束; / CREATE FUNCTION Power_GreaterThanSpecific_Func（对象PowerDemand_Typ，单元格NUMBER，值NUMBER）返回NUMBER AS BEGIN IF cell &lt;= object。CellDemandValues。最后一次（对象。CellDemandValues（cell）&gt; value）THEN RETURN 1; ELSE RETURN 0;万一; ELSE RETURN NULL;万一;结束; / CREATE FUNCTION Power_LessThanSpecific_Func（对象PowerDemand_Typ，单元格NUMBER，值NUMBER）如果单元格&lt;= object，则返回NUMBER AS BEGIN。CellDemandValues。最后一次（对象。CellDemandValues（cell）&lt;value）THEN RETURN 1; ELSE RETURN 0;万一; ELSE RETURN NULL;万一;结束; / CREATE FUNCTION Power_EqualsAny_Func（对象PowerDemand_Typ，值NUMBER）返回NUMBER作为idx NUMBER;为idx IN对象开始。CellDemandValues。FIRST..object。CellDemandValues。最后循环IF（对象。CellDemandValues（idx）= value）THEN RETURN 1;万一;结束循环;返回0;结束; / CREATE FUNCTION Power_GreaterThanAny_Func（对象PowerDemand_Typ，值NUMBER）返回NUMBER作为idx NUMBER;为idx IN对象开始。CellDemandValues。FIRST..object。CellDemandValues。最后循环IF（对象。CellDemandValues（idx）&gt; value）THEN RETURN 1;万一;结束循环;返回0;结束; / CREATE FUNCTION Power_LessThanAny_Func（对象PowerDemand_Typ，值NUMBER）返回NUMBER作为idx NUMBER;为idx IN对象开始。CellDemandValues。FIRST..object。CellDemandValues。最后循环IF（对象。CellDemandValues（idx）&lt;value）THEN RETURN 1;万一;结束循环;返回0;结束; /</pre></div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-C3FD1445-8E14-423F-BAC5-CDE6CE63A0DA__CIADJEDC">
                           <p class="titleinexample">示例15-5为Power Demand Cartridge实现Power_XXX（）函数</p><pre class="oac_no_warn" dir="ltr">使用Power_EqualsSpecific_Func创建操作符Power_Equals BINDING（PowerDemand_Typ，NUMBER，NUMBER）返回数字;创建运算符Power_GreaterThan绑定（PowerDemand_Typ，NUMBER，NUMBER）使用Power_GreaterThanSpecific_Func返回数字;创建运算符Power_LessThan绑定（PowerDemand_Typ，NUMBER，NUMBER）使用Power_LessThanSpecific_Func返回数字; CREATE OPERATOR Power_EqualsAny BINDING（PowerDemand_Typ，NUMBER）使用Power_EqualsAny_Func返回数字;创建运算符Power_GreaterThanAny BINDING（PowerDemand_Typ，NUMBER）使用Power_GreaterThanAny_Func返回数字;创建运算符Power_LessThanAny BINDING（PowerDemand_Typ，NUMBER）使用Power_LessThanAny_Func返回数字;</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div>
               </div><a id="ADDCI4808"></a><a id="ADDCI4807"></a><div class="props_rev_3"><a id="GUID-1DFCE5CB-E6DE-4D72-87F8-21334041ADC1" name="GUID-1DFCE5CB-E6DE-4D72-87F8-21334041ADC1"></a><h4 id="ADDCI-GUID-1DFCE5CB-E6DE-4D72-87F8-21334041ADC1" class="sect4"><span class="enumeration_section">15.4.5</span>创建Indextype实现方法</h4>
                  <div>
                     <div class="section">
                        <p><a id="d43303e2501" class="indexterm-anchor"></a>电源需求盒式磁带为indextype创建一个对象类型，指定域索引的方法。这些方法是<code class="codeph">ODCIIndex</code> （Oracle数据盒式磁带接口索引）接口的一部分，它们根据定义，操作，扫描和导出索引的方法共同定义索引的行为。
                        </p>
                        <p><a href="example-for-power-demand-cartridge.html#GUID-1DFCE5CB-E6DE-4D72-87F8-21334041ADC1__G1012471" title="列出为Power Demand盒示例创建的方法功能，并描述每个功能">表15-4</a>显示了为电源需求盒创建的方法功能（除了一个以<code class="codeph">ODCIIndex</code>开头）。
                        </p>
                        <div class="tblformal" id="GUID-1DFCE5CB-E6DE-4D72-87F8-21334041ADC1__G1012471">
                           <p class="titleintable">表15-4索引类型方法</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="索引类型方法" width="100%" border="1" summary="Lists the method functions created for the Power Demand cartridge example and describes each" frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="32%" id="d43303e2526">方法</th>
                                    <th align="left" valign="bottom" width="68%" id="d43303e2529">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="32%" id="d43303e2534" headers="d43303e2526 ">
                                       <p><a href="extensible-indexing-interface.html#GUID-28AC1C1B-6B6B-446F-A6C9-EEF4A4842D5F">ODCIGetInterfaces（）</a></p>
                                    </td>
                                    <td align="left" valign="top" width="68%" headers="d43303e2534 d43303e2529 ">
                                       <p>返回由类型实现的列表接口名称。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="32%" id="d43303e2543" headers="d43303e2526 ">
                                       <p><a href="extensible-indexing-interface.html#GUID-C14A0478-6EA1-4EAE-BAA6-AA59EE5D300C">ODCIIndexCreate（）</a></p>
                                    </td>
                                    <td align="left" valign="top" width="68%" headers="d43303e2543 d43303e2529 ">
                                       <p>创建一个表来存储索引数据。如果包含要编制索引的数据的基表不为空，则此方法将为现有数据构建索引。</p>
                                       <p>当发出引用indextype的<code class="codeph">CREATE</code> <code class="codeph">INDEX</code>语句时，将调用此方法。在调用时， <code class="codeph">PARAMETERS</code>子句中指定的任何参数都将与索引的描述一起传递。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="32%" id="d43303e2563" headers="d43303e2526 ">
                                       <p><a href="extensible-indexing-interface.html#GUID-F128CB3B-6B3E-41C3-A623-67BCB5BC9292">ODCIIndexDrop（）</a></p>
                                    </td>
                                    <td align="left" valign="top" width="68%" headers="d43303e2563 d43303e2529 ">
                                       <p>删除存储索引数据的表。当<code class="codeph">DROP</code> <code class="codeph">INDEX</code>语句指定索引时，将调用此方法。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="32%" id="d43303e2578" headers="d43303e2526 ">
                                       <p><a href="extensible-indexing-interface.html#GUID-53F2321C-B0F8-4783-AC1B-056372A0C073">ODCIIndexStart（）</a></p>
                                    </td>
                                    <td align="left" valign="top" width="68%" headers="d43303e2578 d43303e2529 ">
                                       <p>初始化运算符谓词的索引扫描。当提交涉及可以使用域索引执行的运算符的查询时，将调用此方法。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="32%" id="d43303e2587" headers="d43303e2526 ">
                                       <p><a href="extensible-indexing-interface.html#GUID-BB601420-A858-46E3-A9AC-3433220D4F82">ODCIIndexFetch（）</a></p>
                                    </td>
                                    <td align="left" valign="top" width="68%" headers="d43303e2587 d43303e2529 ">
                                       <p>返回满足运算符谓词的每一行的<code class="codeph">ROWID</code> 。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="32%" id="d43303e2599" headers="d43303e2526 ">
                                       <p><a href="extensible-indexing-interface.html#GUID-2F49CDE4-C064-4644-948C-BBF014FDD8C8">ODCIIndexClose（）</a></p>
                                    </td>
                                    <td align="left" valign="top" width="68%" headers="d43303e2599 d43303e2529 ">
                                       <p>结束当前使用的索引。该方法可以执行任何必要的清理。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="32%" id="d43303e2608" headers="d43303e2526 ">
                                       <p><a href="extensible-indexing-interface.html#GUID-EF42025B-6DE2-4F2A-90EF-62775EE0EED6">ODCIIndexInsert（）</a></p>
                                    </td>
                                    <td align="left" valign="top" width="68%" headers="d43303e2608 d43303e2529 ">
                                       <p>在将记录插入包含由indextype索引的列或对象属性的表中时，维护索引结构。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="32%" id="d43303e2617" headers="d43303e2526 ">
                                       <p><a href="extensible-indexing-interface.html#GUID-4B2E080D-FE8B-4598-9084-56FBE255196B">ODCIIndexDelete（）</a></p>
                                    </td>
                                    <td align="left" valign="top" width="68%" headers="d43303e2617 d43303e2529 ">
                                       <p>从包含由indextype索引的列或对象属性的表中删除记录时，维护索引结构。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="32%" id="d43303e2626" headers="d43303e2526 ">
                                       <p><a href="extensible-indexing-interface.html#GUID-CB42E738-EFD1-4053-9DDF-BEF455F92815">ODCIIndexUpdate（）</a></p>
                                    </td>
                                    <td align="left" valign="top" width="68%" headers="d43303e2626 d43303e2529 ">
                                       <p>在包含由indextype索引的列或对象属性的表中更新（修改）记录时，维护索引结构。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="32%" id="d43303e2635" headers="d43303e2526 ">
                                       <p><a href="extensible-indexing-interface.html#GUID-B4A15D4C-A136-494E-BA05-4E8DD776C118">ODCIIndexGetMetadata（）</a></p>
                                    </td>
                                    <td align="left" valign="top" width="68%" headers="d43303e2635 d43303e2529 ">
                                       <p>允许导出和导入与索引关联的特定于实现的元数据。</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADDCI4810"></a><a id="ADDCI4809"></a><div class="props_rev_3"><a id="GUID-82CA23D3-C083-4570-8A1B-E3184007AAB4" name="GUID-82CA23D3-C083-4570-8A1B-E3184007AAB4"></a><h4 id="ADDCI-GUID-82CA23D3-C083-4570-8A1B-E3184007AAB4" class="sect4"><span class="enumeration_section">15.4.6</span>定义类型</h4>
                  <div>
                     <div class="section">
                        <p><a href="example-for-power-demand-cartridge.html#GUID-82CA23D3-C083-4570-8A1B-E3184007AAB4__CIAFGJIC">例15-6</a>创建了<code class="codeph">power_idxtype_im</code>对象类型。这种方法是用于定义，操作和扫描域索引的ODCI方法。<code class="codeph">curnum</code>属性是用作扫描例程<a href="extensible-indexing-interface.html#GUID-53F2321C-B0F8-4783-AC1B-056372A0C073">ODCIIndexStart（）</a> ， <a href="extensible-indexing-interface.html#GUID-BB601420-A858-46E3-A9AC-3433220D4F82">ODCIIndexFetch（）</a>和<a href="extensible-indexing-interface.html#GUID-2F49CDE4-C064-4644-948C-BBF014FDD8C8">ODCIIndexClose（）的</a>上下文的游标号。
                        </p>
                        <p><code class="codeph">CREATE</code> <code class="codeph">TYPE</code>语句后跟一个<code class="codeph">CREATE</code> <code class="codeph">TYPE</code> <code class="codeph">BODY</code>语句，该语句指定每个成员函数的实现：</p><pre class="oac_no_warn" dir="ltr">创建或替换类型身体power_idxtype_im是......
</pre><p>所有方法定义（ <a href="extensible-indexing-interface.html#GUID-B4A15D4C-A136-494E-BA05-4E8DD776C118">ODCIIndexGetMetadata（）</a>除外，它返回<code class="codeph">VARCHAR2</code>字符串）具有以下一般形式：</p><pre class="oac_no_warn" dir="ltr">STATIC FUNCTION函数名（...）返回号码是......结束;</pre></div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-82CA23D3-C083-4570-8A1B-E3184007AAB4__CIAFGJIC">
                        <p class="titleinexample">示例15-6为Power Demand Cartridge创建power_idxtype_im对象类型</p><pre class="oac_no_warn" dir="ltr">创建或替换类型power_idxtype_im AS OBJECT（curnum NUMBER，STATIC FUNCTION ODCIGetInterfaces（ifclist OUT sys。ODCIObjectList）返回NUMBER，STATIC FUNCTION ODCIIndexCreate（ia sys。ODCIIndexInfo，parms VARCHAR2，env sys。ODCIEnv）返回编号，静态功能ODCIIndexDrop（ia sys。ODCIIndexInfo，env sys。ODCIEnv）返回编号，静态功能ODCIIndexStart（sctx IN OUT power_idxtype_im，ia sys。ODCIIndexInfo，op sys。ODCIPredInfo，qi sys。ODCIQueryInfo，strt NUMBER，停止NUMBER，cmppos NUMBER，cmpval NUMBER，env sys。ODCIEnv）返回编号，静态功能ODCIIndexStart（sctx IN OUT power_idxtype_im，ia sys。ODCIIndexInfo，op sys。ODCIPredInfo，qi sys。ODCIQueryInfo，strt NUMBER，停止NUMBER，cmpval NUMBER，env sys。ODCIEnv）返回号码，成员函数ODCIIndexFetch（nrows NUMBER，rids OUT sys。ODCIRidList，env sys。ODCIEnv）返回号码，成员函数ODCIIndexClose（env sys。ODCIEnv）返回编号，静态功能ODCIIndexInsert（ia sys。ODCIIndexInfo，rid VARCHAR2，newval PowerDemand_Typ，env sys。ODCIEnv）返回号码，静态功能ODCIIndexDelete（ia sys。ODCIIndexInfo，rid VARCHAR2，oldval PowerDemand_Typ，env sys。ODCIEnv）返回编号，静态功能ODCIIndexUpdate（ia sys。ODCIIndexInfo，rid VARCHAR2，oldval PowerDemand_Typ，newval PowerDemand_Typ，env sys。ODCIEnv）返回号码，静态功能ODCIIndexGetMetadata（ia sys。ODCIIndexInfo，expversion VARCHAR2，newblock OUT PLS_INTEGER，env sys。ODCIEnv）RETURN VARCHAR2）; /</pre></div>
                     <!-- class="example" -->
                  </div><a id="ADDCI4812"></a><a id="ADDCI4811"></a><div class="props_rev_3"><a id="GUID-7CDBE109-6EAB-41EE-BFB5-DD94CE516186" name="GUID-7CDBE109-6EAB-41EE-BFB5-DD94CE516186"></a><h5 id="ADDCI-GUID-7CDBE109-6EAB-41EE-BFB5-DD94CE516186" class="sect5"><span class="enumeration_section">15.4.6.1</span> ODCIGetInterfaces（）</h5>
                     <div>
                        <div class="section">
                           <p><a id="d43303e2811" class="indexterm-anchor"></a> <a href="extensible-indexing-interface.html#GUID-28AC1C1B-6B6B-446F-A6C9-EEF4A4842D5F">ODCIGetInterfaces（）</a>函数返回由该类型实现的接口的名称列表。要指定这些接口的当前版本， <a href="extensible-indexing-interface.html#GUID-28AC1C1B-6B6B-446F-A6C9-EEF4A4842D5F">ODCIGetInterfaces（）</a>例程必须在<code class="codeph">OUT</code>参数中返回<code class="codeph">'SYS.ODCIINDEX2'</code> ，如<a href="example-for-power-demand-cartridge.html#GUID-7CDBE109-6EAB-41EE-BFB5-DD94CE516186__CIAIHJBJ">例15-7所示</a> 。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-7CDBE109-6EAB-41EE-BFB5-DD94CE516186__CIAIHJBJ">
                           <p class="titleinexample">例15-7在Power Demand Cartridge中注册接口和索引功能</p><pre class="oac_no_warn" dir="ltr">静态功能ODCIGetInterfaces（ifclist OUT sys。ODCIObjectList）RETURN NUMBER是BEGIN ifclist：= sys。ODCIObjectList（SYS。ODCIObject（ 'SYS'， 'ODCIINDEX2'））;返回ODCIConst。成功; END ODCIGetInterfaces;</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="ADDCI4814"></a><a id="ADDCI4813"></a><div class="props_rev_3"><a id="GUID-E5950FD7-A2C2-4455-BFCA-62FFB2ECCB96" name="GUID-E5950FD7-A2C2-4455-BFCA-62FFB2ECCB96"></a><h5 id="ADDCI-GUID-E5950FD7-A2C2-4455-BFCA-62FFB2ECCB96" class="sect5"><span class="enumeration_section">15.4.6.2</span> ODCIIndexCreate（）</h5>
                     <div>
                        <div class="section">
                           <p><a id="d43303e2891" class="indexterm-anchor"></a> <a href="extensible-indexing-interface.html#GUID-C14A0478-6EA1-4EAE-BAA6-AA59EE5D300C">ODCIIndexCreate（）</a>函数创建用于存储索引数据的表。如果包含要编制索引的数据的基表不为空，则此方法将插入现有数据的索引数据条目。
                           </p>
                           <p>该函数将索引信息作为对象参数，其类型为<code class="codeph">SYS</code> 。 <code class="codeph">ODCIINDEXINFO</code> 。类型属性包括索引名称，所有者名称等。<code class="codeph">CREATE</code> <code class="codeph">INDEX</code>语句中指定的<code class="codeph">PARAMETERS</code>字符串也作为参数传递给函数，如<a href="example-for-power-demand-cartridge.html#GUID-E5950FD7-A2C2-4455-BFCA-62FFB2ECCB96__CIAFJFEH">例15-8所示</a> 。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-E5950FD7-A2C2-4455-BFCA-62FFB2ECCB96__CIAFJFEH">
                           <p class="titleinexample">例15-8为Power Demand Cartridge注册ODCIIndexCreate（）</p><pre class="oac_no_warn" dir="ltr">静态功能ODCIIndexCreate（ia sys。ODCIIndexInfo，parms VARCHAR2，env sys。ODCIEnv）返回号码是我整数; r ROWID; p NUMBER; v NUMBER; stmt1 VARCHAR2（1000）; stmt2 VARCHAR2（1000）; stmt3 VARCHAR2（1000）; cnum1 INTEGER; cnum2 INTEGER; cnum3 INTEGER;垃圾NUMBER;</pre><p>构造并执行用于为索引数据创建表的SQL语句。该表包括基表的<code class="codeph">ROWID</code> ， <code class="codeph">r</code> ，网格中从1到100的单元位置编号（ <code class="codeph">cpos</code> ），以及该单元中的功率需求值（ <code class="codeph">cval</code> ）。
                           </p><pre class="oac_no_warn" dir="ltr">BEGIN  - 构造SQL语句。stmt1：='CREATE TABLE'|| IA。IndexSchema || '' || IA。IndexName ||'_ pidx'|| '（r ROWID，cpos NUMBER，cval NUMBER）'; - 转储SQL语句。DBMS_OUTPUT.PUT_LINE（ 'ODCIIndexCreate &gt;&gt;&gt;&gt;&gt;'）; SYS。ODCIIndexInfoDump（IA）; DBMS_OUTPUT.PUT_LINE（ 'ODCIIndexCreate &gt;&gt;&gt;&gt;&gt;' || stmt1）; - 执行声明。cnum1：= dbms_sql.open_cursor; dbms_sql.parse（cnum1，stmt1，dbms_sql.native）; junk：= dbms_sql.execute（cnum1）; dbms_sql.close_cursor（cnum1）;</pre><p>该函数通过在表中插入行来填充索引。该函数“不使用” <code class="codeph">VARRAY</code>属性，并将每个单元格的行插入表中。因此，每个10×10网格（10行，每行10个值）在表中变为100行（每个单元一行）。
                           </p><pre class="oac_no_warn" dir="ltr">- 现在填充表格。stmt2：='INSERT INTO'|| IA。IndexSchema || '' || IA。IndexName || '_pidx'|| 'SELECT：rr，ROWNUM，column_value来自'|| '（选择CAST（P.'|| ia。IndexCols（1）。COLNAME ||”。CellDemandValues AS NumTab_Typ）'|| 'FROM'|| IA。IndexCols（1）。TableSchema || '' || IA。IndexCols（1）。TableName || 'P'|| '在哪里P.ROWID =：rr）'; - 执行声明。DBMS_OUTPUT.PUT_LINE（ 'ODCIIndexCreate &gt;&gt;&gt;&gt;&gt;' || stmt2）; - 解析声明。cnum2：= dbms_sql.open_cursor; dbms_sql.parse（cnum2，stmt2，dbms_sql.native）; stmt3：='SELECT ROWID FROM'|| IA。IndexCols（1）。TableSchema || ”。'|| IA。IndexCols（1）。表名; DBMS_OUTPUT.PUT_LINE（ 'ODCIIndexCreate &gt;&gt;&gt;&gt;&gt;' || stmt3）; cnum3：= dbms_sql.open_cursor; dbms_sql.parse（cnum3，stmt3，dbms_sql.native）; dbms_sql.define_column_rowid（cnum3,1，r）; junk：= dbms_sql.execute（cnum3）; WHILE dbms_sql.fetch_rows（cnum3）&gt; 0 LOOP  - 获取行的列值。 -  dbms_sql.column_value_rowid（cnum3,1，r）; - 将行绑定到光标以进行下一次插入。 -  dbms_sql.bind_variable_rowid（cnum2，'：rr'，r）; junk：= dbms_sql.execute（cnum2）;结束循环;</pre><p>该函数通过关闭游标并返回成功状态来结束。</p><pre class="oac_no_warn" dir="ltr">dbms_sql.close_cursor（cnum2）; dbms_sql.close_cursor（cnum3）;返回ODCICONST.SUCCESS; END ODCIInexCreate;</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="ADDCI4816"></a><a id="ADDCI4815"></a><div class="props_rev_3"><a id="GUID-51A035C8-8C13-4905-B829-DF7998F3E826" name="GUID-51A035C8-8C13-4905-B829-DF7998F3E826"></a><h5 id="ADDCI-GUID-51A035C8-8C13-4905-B829-DF7998F3E826" class="sect5"><span class="enumeration_section">15.4.6.3</span> ODCIIndexDrop（）</h5>
                     <div>
                        <div class="section">
                           <p><a id="d43303e3007" class="indexterm-anchor"></a> <a href="extensible-indexing-interface.html#GUID-F128CB3B-6B3E-41C3-A623-67BCB5BC9292">ODCIIndexDrop（）</a>函数删除存储索引数据的表，如<a href="example-for-power-demand-cartridge.html#GUID-51A035C8-8C13-4905-B829-DF7998F3E826__CIADADCD">例15-9所示</a> 。发出<code class="codeph">DROP</code> <code class="codeph">INDEX</code>语句时调用此方法。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-51A035C8-8C13-4905-B829-DF7998F3E826__CIADADCD">
                           <p class="titleinexample">示例15-9为Power Demand Cartridge注册ODCIIndexDrop（）</p><pre class="oac_no_warn" dir="ltr">静态功能ODCIIndexDrop（ia sys。ODCIIndexInfo，env sys。ODCIEnv）返回号码是stmt VARCHAR2（1000）; cnum INTEGER;垃圾INTEGER; BEGIN  - 构造SQL语句。stmt：='drop table'|| IA。IndexSchema || '' || IA。IndexName || '_pidx'; DBMS_OUTPUT.PUT_LINE（ 'ODCIIndexDrop &gt;&gt;&gt;&gt;&gt;'）; SYS。ODCIIndexInfoDump（IA）; DBMS_OUTPUT.PUT_LINE（ 'ODCIIndexDrop &gt;&gt;&gt;&gt;&gt;' || stmt）;第 - 执行声明。cnum：= dbms_sql.open_cursor; dbms_sql.parse（cnum，stmt，dbms_sql.native）; junk：= dbms_sql.execute（cnum）; dbms_sql.close_cursor（CNUM）;返回ODCICONST.SUCCESS; END ODCIIndexDrop;</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="ADDCI4818"></a><a id="ADDCI4817"></a><div class="props_rev_3"><a id="GUID-AB826A69-6D7D-4224-99F1-19771BC2D87B" name="GUID-AB826A69-6D7D-4224-99F1-19771BC2D87B"></a><h5 id="ADDCI-GUID-AB826A69-6D7D-4224-99F1-19771BC2D87B" class="sect5"><span class="enumeration_section">15.4.6.4</span> ODCIIndexStart（）; <span class="bold">具体</span>查询</h5>
                     <div>
                        <div class="section">
                           <p><a id="d43303e3086" class="indexterm-anchor"></a> <code class="codeph">ODCIIndexStart()</code>函数的第一个定义初始化索引的扫描，以返回满足运算符谓词的所有行。例如，如果查询要求cell <code class="codeph">(3,7)</code>的值等于<code class="codeph">25</code>所有实例，则该函数初始化扫描以返回索引组织表中该单元具有该值的所有行。<code class="codeph">ODCIIndexStart()</code>定义与<code class="codeph">ODCIIndexStart()</code>的定义不同<code class="codeph">ODCIIndexStart(); Any Queries</code> ，包括单元格位置的<code class="codeph">cmppos</code>参数。
                           </p>
                           <p><code class="codeph">self</code>参数是与<code class="codeph">ODCIIndexFetch()</code>和<code class="codeph">ODCIIndexClose()</code>函数共享的上下文。<code class="codeph">ia</code>参数包含索引信息，作为<code class="codeph">SYS</code>类型的对象实例。 <code class="codeph">ODCIINDEXINFO</code>和<code class="codeph">op</code>参数包含操作员信息作为<code class="codeph">SYS</code>类型的对象实例。 <code class="codeph">ODCIOPERINFO</code> 。 <code class="codeph">strt</code>和<code class="codeph">stop</code>参数是操作员返回值的下边界和上边界点。<code class="codeph">cmppos</code>参数是单元格位置， <code class="codeph">cmpval</code>是运算符<code class="codeph">Power_XxxxxSpecific()</code>指定的单元格中的值。这在<a href="example-for-power-demand-cartridge.html#GUID-AB826A69-6D7D-4224-99F1-19771BC2D87B__CIAEHIJB">实施例15-10中</a>得到证实。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-AB826A69-6D7D-4224-99F1-19771BC2D87B__CIAEHIJB">
                           <p class="titleinexample">示例15-10为Power Demand Cartridge注册ODCIIndexStart（）</p><pre class="oac_no_warn" dir="ltr">静态功能ODCIIndexStart（sctx IN OUT power_idxtype_im，ia sys。ODCIIndexInfo，op sys。ODCIPredInfo，qi sys。ODCIQueryInfo，strt NUMBER，停止NUMBER，cmppos NUMBER，cmpval NUMBER，env sys。ODCIEnv）返回号码是cnum INTEGER;摆脱ROWID; nrows INTEGER; relop VARCHAR2（2）; stmt VARCHAR2（1000）; BEGIN dbms_output.put_line（'ODCIIndexStart &gt;&gt;&gt;&gt;&gt;'）; SYS。ODCIIndexInfoDump（IA）; SYS。ODCIPredInfoDump（OP）; dbms_output.put_line（'start key：'|| strt）; dbms_output.put_line（'stop key：'|| stop）; dbms_output.put_line（'比较位置：'|| cmppos）; dbms_output.put_line（'compare value：'|| cmpval）;</pre><p>该函数检查谓词中的错误。</p><pre class="oac_no_warn" dir="ltr">- 处理一些错误案例。-  btree运算符可以出现的唯一谓词是 -  op（）= 1 OR op（）= 0 if（strt！= 1）和（strt！= 0）然后raise_application_error（-20101，'运算符的谓词不正确'）;万一;如果（停！= 1）和（停止！= 0）然后raise_application_error（-20101，'运算符的谓词不正确'）;万一;</pre><p>该函数生成要执行的SQL语句。它确定运算符名称以及下限和上限索引值边界（开始和停止键）。启动键和停止键都可以是1（= <code class="codeph">TRUE</code> ）或两者都是0（= <code class="codeph">FALSE</code> ）。
                           </p><pre class="oac_no_warn" dir="ltr">- 生成要执行的SQL语句。- 首先，找出声明所需的关系运算符。- 考虑操作员名称以及启动和停止键。目前， - 开始和停止键都可以是1（= TRUE）或两者都是0（= FALSE）。如果操作。ObjectName ='POWER_EQUALS'然后如果strt = 1则relop：='=';别的relop：='！=';万一;埃尔西夫ObjectName ='POWER_LESSTHAN'然后如果strt = 1则relop：='&lt;'; else relop：='&gt; =';万一;埃尔西夫ObjectName ='POWER_GREATERTHAN'然后如果strt = 1则relop：='&gt;'; else relop：='&lt;=';万一;否则raise_application_error（-20101，'不支持的运营商'）;万一; stmt：='select r from'|| ia。||的IndexSchema '' || IA。INDEXNAME || '_pidx' || '哪里有cpos'|| '='||''''|| cmppos ||''''|| '和cval'|| relop ||''''|| cmpval || '' ''; dbms_output.put_line（'ODCIIndexStart &gt;&gt;&gt;&gt;&gt;'|| stmt）; cnum：= dbms_sql.open_cursor; dbms_sql.parse（cnum，stmt，dbms_sql.native）; dbms_sql.define_column_rowid（cnum，1，rid）; nrows：= dbms_sql.execute（cnum）;</pre><p>该函数将游标号存储在<code class="codeph">ODCIIndexFetch</code>函数使用的上下文中，并设置成功返回状态。
                           </p><pre class="oac_no_warn" dir="ltr">- 将上下文设置为光标编号。stcx：= power_idxtype_im（cnum）; - 回归成功。返回ODCICONST.SUCCESS; END ODCIIndexStart;</pre><div class="infoboxnotealso" id="GUID-AB826A69-6D7D-4224-99F1-19771BC2D87B__GUID-50A60EAD-8A33-4417-841B-6918D54A0E42">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><a href="extensible-indexing-interface.html#GUID-2F49CDE4-C064-4644-948C-BBF014FDD8C8">ODCIIndexClose（）</a></p>
                                 </li>
                                 <li>
                                    <p><a href="extensible-indexing-interface.html#GUID-BB601420-A858-46E3-A9AC-3433220D4F82">ODCIIndexFetch（）</a></p>
                                 </li>
                                 <li>
                                    <p><a href="extensible-indexing-interface.html#GUID-53F2321C-B0F8-4783-AC1B-056372A0C073">ODCIIndexStart（）</a></p>
                                 </li>
                                 <li>
                                    <p><a href="example-for-power-demand-cartridge.html#GUID-22B9F918-5A37-414D-B3FC-0B8ADF61BA36">ODCIIndexStart（）;任何查询</a></p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="ADDCI4820"></a><a id="ADDCI4819"></a><div class="props_rev_3"><a id="GUID-22B9F918-5A37-414D-B3FC-0B8ADF61BA36" name="GUID-22B9F918-5A37-414D-B3FC-0B8ADF61BA36"></a><h5 id="ADDCI-GUID-22B9F918-5A37-414D-B3FC-0B8ADF61BA36" class="sect5"><span class="enumeration_section">15.4.6.5</span> ODCIIndexStart（）; <span class="bold">任何</span>查询</h5>
                     <div>
                        <div class="section">
                           <p><a id="d43303e3259" class="indexterm-anchor"></a> <code class="codeph">ODCIIndexStart()</code>函数的此定义初始化索引的扫描以返回满足运算符谓词的所有行。例如，如果查询要求任何单元格的值等于<code class="codeph">25</code>所有实例，则该函数会初始化扫描以返回索引组织表中该单元格具有该值的所有行。此定义与<code class="codeph">ODCIIndexStart(); Specific Queries</code>的定义不同<code class="codeph">ODCIIndexStart(); Specific Queries</code> ，因为它不包含<code class="codeph">cmppos</code>参数。
                           </p>
                           <p><code class="codeph">self</code>参数是与<code class="codeph">ODCIIndexFetch()</code>和<code class="codeph">ODCIIndexClose()</code>函数共享的上下文。<code class="codeph">ia</code>参数包含索引信息，作为<code class="codeph">SYS</code>类型的对象实例。 <code class="codeph">ODCIINDEXINFO</code>和<code class="codeph">op</code>参数包含操作员信息作为<code class="codeph">SYS</code>类型的对象实例。 <code class="codeph">ODCIOPERINFO</code> 。 <code class="codeph">strt</code>和<code class="codeph">stop</code>参数是操作员返回值的下边界和上边界点。<code class="codeph">cmpval</code>参数是运算符<code class="codeph">Power_Xxxx()</code>指定的单元格中的值。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-22B9F918-5A37-414D-B3FC-0B8ADF61BA36__GUID-2DC85583-9A65-4734-8052-E0AB7BD91C50">
                           <p class="titleinexample">示例15-11为Power Demand Cartridge的任何查询注册ODCIIndexStart（）</p><pre class="oac_no_warn" dir="ltr">静态功能ODCIIndexStart（sctx IN OUT power_idxtype_im，ia sys。ODCIIndexInfo，op sys。ODCIPredInfo，qi sys。ODCIQueryInfo，strt NUMBER，停止NUMBER，cmpval NUMBER，env sys。ODCIEnv）返回号码是cnum INTEGER;摆脱ROWID; nrows INTEGER; relop VARCHAR2（2）; stmt VARCHAR2（1000）; BEGIN dbms_output.put_line（'ODCIIndexStart &gt;&gt;&gt;&gt;&gt;'）; SYS。ODCIIndexInfoDump（IA）; SYS。ODCIPredInfoDump（OP）; dbms_output.put_line（'start key：'|| strt）; dbms_output.put_line（'stop key：'|| stop）; dbms_output.put_line（'compare value：'|| cmpval）;</pre><p>该函数检查谓词中的错误。</p><pre class="oac_no_warn" dir="ltr">- 处理一些错误案例。-  btree运算符可以出现的唯一谓词是 -  op（）= 1 OR op（）= 0 if（strt！= 1）和（strt！= 0）然后raise_application_error（-20101，'运算符的谓词不正确'）;万一;如果（停！= 1）和（停止！= 0）然后raise_application_error（-20101，'运算符的谓词不正确'）;万一;</pre><p>该函数生成要执行的SQL语句。它确定运算符名称以及下限和上限索引值边界（开始和停止键）。启动键和停止键都可以是1（= <code class="codeph">TRUE</code> ）或两者都是0（= <code class="codeph">FALSE</code> ）。
                           </p><pre class="oac_no_warn" dir="ltr">- 生成要执行的SQL语句。- 首先，找出声明所需的关系运算符。- 考虑操作员名称以及启动和停止键。目前， - 开始和停止键都可以是1（= TRUE）或两者都是0（= FALSE）。如果操作。ObjectName ='POWER_EQUALSANY'然后relop：='=';埃尔西夫ObjectName ='POWER_LESSTHANANY'然后relop：='&lt;';埃尔西夫ObjectName ='POWER_GREATERTHANANY'然后relop：='&gt;';否则raise_application_error（-20101，'不支持的运营商'）;万一; - 此语句返回TRUE案例的限定行。stmt：='从'| i选择不同的r。||的IndexSchema '' || IA。INDEXNAME || '_pidx' ||”其中cval'|| relop ||''''|| cmpval ||''''; - 在FALSE情况下，我们必须找到行的补码。如果（strt = 0）则stmt：='从'|| i中选择不同的r。||的IndexSchema '' || IA。INDEXNAME || '_pidx' ||”减去'|| stmt;万一; dbms_output.put_line（'ODCIIndexStart &gt;&gt;&gt;&gt;&gt;'|| stmt）; cnum：= dbms_sql.open_cursor; dbms_sql.parse（cnum，stmt，dbms_sql.native）; dbms_sql.define_column_rowid（cnum，1，rid）; nrows：= dbms_sql.execute（cnum）;</pre><p>该函数将游标号存储在<code class="codeph">ODCIIndexFetch()</code>函数使用的上下文中，并设置成功返回状态。
                           </p><pre class="oac_no_warn" dir="ltr">- 将上下文设置为光标编号。self：= power_idxtype_im（cnum）; - 回归成功。返回ODCICONST.SUCCESS; END ODCIIndexStart;</pre><div class="infoboxnotealso" id="GUID-22B9F918-5A37-414D-B3FC-0B8ADF61BA36__GUID-34EA7B9C-6D41-4AB6-A576-1190AF650FDA">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><a href="extensible-indexing-interface.html#GUID-2F49CDE4-C064-4644-948C-BBF014FDD8C8">ODCIIndexClose（）</a></p>
                                 </li>
                                 <li>
                                    <p><a href="extensible-indexing-interface.html#GUID-BB601420-A858-46E3-A9AC-3433220D4F82">ODCIIndexFetch（）</a></p>
                                 </li>
                                 <li>
                                    <p><a href="extensible-indexing-interface.html#GUID-53F2321C-B0F8-4783-AC1B-056372A0C073">ODCIIndexStart（）</a></p>
                                 </li>
                                 <li>
                                    <p><a href="example-for-power-demand-cartridge.html#GUID-AB826A69-6D7D-4224-99F1-19771BC2D87B">ODCIIndexStart（）;具体查询</a></p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="ADDCI4822"></a><a id="ADDCI4821"></a><div class="props_rev_3"><a id="GUID-68AC5CFF-9219-4F6F-8458-EE495FA5893F" name="GUID-68AC5CFF-9219-4F6F-8458-EE495FA5893F"></a><h5 id="ADDCI-GUID-68AC5CFF-9219-4F6F-8458-EE495FA5893F" class="sect5"><span class="enumeration_section">15.4.6.6</span> ODCIIndexFetch（）</h5>
                     <div>
                        <div class="section">
                           <p><a id="d43303e3418" class="indexterm-anchor"></a> <a href="example-for-power-demand-cartridge.html#GUID-68AC5CFF-9219-4F6F-8458-EE495FA5893F__CIAGGBBD">示例15-12中</a>演示的<code class="codeph">ODCIIndexFetch()</code>函数为满足运算符谓词的行返回一批<code class="codeph">ROWIDs</code> 。每次<code class="codeph">ODCIIndexFetch()</code>被调用时，它返回下一个批处理中的行（ <code class="codeph">rids</code>参数，类型的集合<code class="codeph">SYS</code> 。 <code class="codeph">ODCIRIDLIST</code> ）满足操作者的谓词。每次调用可以返回的最大行数由<code class="codeph">nrows</code>参数指定。
                           </p>
                           <p>Oracle重复调用<code class="codeph">ODCIIndexFetch()</code> ，直到返回了满足运算符谓词的所有行。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-68AC5CFF-9219-4F6F-8458-EE495FA5893F__CIAGGBBD">
                           <p class="titleinexample">示例15-12为Power Demand Cartridge注册ODCIIndexFetch（）</p><pre class="oac_no_warn" dir="ltr">成员函数ODCIIndexFetch（nrows NUMBER，rids OUT sys。ODCIRidList，env sys。ODCIEnv）返回号码是cnum INTEGER; idx INTEGER：= 1; rlist sys。ODCIRidList：= sys。ODCIRidList（）; done boolean：= FALSE;</pre><p>该功能通过由所选行的集合环<code class="codeph">ODCIIndexStart()</code>函数，使用相同的光标号， <code class="codeph">cnum</code> ，如在<code class="codeph">ODCIIndexStart()</code>函数，并返回<code class="codeph">ROWIDs</code> 。
                           </p><pre class="oac_no_warn" dir="ltr">BEGIN dbms_output.put_line（'ODCIIndexFetch &gt;&gt;&gt;&gt;&gt;'）; dbms_output.put_line（'Nrows：'|| round（nrows））; cnum：= self.curnum;如果没有完成LOOP，如果idx&gt; nrows则完成：= TRUE;否则rlist.extEND;如果dbms_sql.fetch_rows（cnum）&gt; 0则为dbms_sql.column_value_rowid（cnum，1，rlist（idx））; idx：= idx + 1; else rlist（idx）：= null;完成：= TRUE;万一;万一;结束循环; rids：= rlist;返回ODCICONST.SUCCESS; END ODCIIndexFetch;</pre><div class="infoboxnotealso" id="GUID-68AC5CFF-9219-4F6F-8458-EE495FA5893F__GUID-A41297E3-2DC0-4B1B-BB90-B6CA50183640">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><a href="extensible-indexing-interface.html#GUID-BB601420-A858-46E3-A9AC-3433220D4F82">ODCIIndexFetch（）</a></p>
                                 </li>
                                 <li>
                                    <p><a href="extensible-indexing-interface.html#GUID-53F2321C-B0F8-4783-AC1B-056372A0C073">ODCIIndexStart（）</a></p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="ADDCI4824"></a><a id="ADDCI4823"></a><div class="props_rev_3"><a id="GUID-211432D0-CEA4-4D20-90A0-AC49EE5BC68A" name="GUID-211432D0-CEA4-4D20-90A0-AC49EE5BC68A"></a><h5 id="ADDCI-GUID-211432D0-CEA4-4D20-90A0-AC49EE5BC68A" class="sect5"><span class="enumeration_section">15.4.6.7</span> ODCIIndexClose（）</h5>
                     <div>
                        <div class="section">
                           <p><a id="d43303e3537" class="indexterm-anchor"></a> <a href="example-for-power-demand-cartridge.html#GUID-211432D0-CEA4-4D20-90A0-AC49EE5BC68A__CIAEJGFH">例15-13中</a>演示的<a href="extensible-indexing-interface.html#GUID-2F49CDE4-C064-4644-948C-BBF014FDD8C8">ODCIIndexClose（）</a>函数关闭了<a href="extensible-indexing-interface.html#GUID-53F2321C-B0F8-4783-AC1B-056372A0C073">ODCIIndexStart（）</a>和<a href="extensible-indexing-interface.html#GUID-BB601420-A858-46E3-A9AC-3433220D4F82">ODCIIndexFetch（）</a>函数使用的游标。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-211432D0-CEA4-4D20-90A0-AC49EE5BC68A__CIAEJGFH">
                           <p class="titleinexample">示例15-13为Power Demand Cartridge注册ODCIIndexStart（）</p><pre class="oac_no_warn" dir="ltr">成员函数ODCIIndexClose（env sys。ODCIEnv）返回号码是cnum INTEGER; BEGIN dbms_output.put_line（'ODCIIndexClose &gt;&gt;&gt;&gt;&gt;'）; cnum：= self.curnum; dbms_sql.close_cursor（CNUM）;返回ODCICONST.SUCCESS; END ODCIIndexClose;</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="ADDCI4826"></a><a id="ADDCI4825"></a><div class="props_rev_3"><a id="GUID-4F065165-D680-4F2D-823E-FCC7A2A9C5BC" name="GUID-4F065165-D680-4F2D-823E-FCC7A2A9C5BC"></a><h5 id="ADDCI-GUID-4F065165-D680-4F2D-823E-FCC7A2A9C5BC" class="sect5"><span class="enumeration_section">15.4.6.8</span> ODCIIndexInsert（）</h5>
                     <div>
                        <div class="section">
                           <p><a id="d43303e3615" class="indexterm-anchor"></a>当在包含由indextype索引的列或<code class="codeph">OBJECT</code>属性的表中插入记录时，将调用<a href="example-for-power-demand-cartridge.html#GUID-4F065165-D680-4F2D-823E-FCC7A2A9C5BC__CIAGGDAC">示例15-14中</a>演示的<a href="extensible-indexing-interface.html#GUID-EF42025B-6DE2-4F2A-90EF-62775EE0EED6">ODCIIndexInsert（）</a>函数。索引列中的新值作为参数与相应的行标识符一起传递。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-4F065165-D680-4F2D-823E-FCC7A2A9C5BC__CIAGGDAC">
                           <p class="titleinexample">示例15-14为Power Demand Cartridge注册ODCIIndexInsert（）</p><pre class="oac_no_warn" dir="ltr">静态功能ODCIIndexInsert（ia sys。ODCIIndexInfo，rid VARCHAR2，newval PowerDemand_Typ，env sys。ODCIEnv）返回号码作为cid INTEGER;我是BINARY_INTEGER; nrows INTEGER; stmt VARCHAR2（1000）; BEGIN dbms_output.put_line（''）; dbms_output.put_line（'ODCIIndexInsert &gt;&gt;&gt;&gt;&gt;'||'TotGridDemand ='|| newval。TotGridDemand ||' MaxCellDemand ='|| newval。MaxCellDemand || 'MinCellDemand ='|| newval。MinCellDemand）; SYS。ODCIIndexInfoDump（IA）; - 构建声明。stmt：='INSERT INTO'|| IA。IndexSchema || '' || IA。IndexName || '_pidx'|| 'VALUES（：rr，：pos，：val）'; - 执行声明。DBMS_OUTPUT.PUT_LINE（ 'ODCIIndexInsert &gt;&gt;&gt;&gt;&gt;' || stmt）;第 - 解析声明。cid：= dbms_sql.open_cursor; dbms_sql.parse（cid，stmt，dbms_sql.native）; dbms_sql.bind_variable_rowid（cid，'：rr'，rid）; - 迭代Varray的行并插入它们。我：= newval。CellDemandValues。第一;虽然我不是空的循环 - 将行绑定到光标中以进行插入。dbms_sql.bind_variable（cid，'：pos'，i）; dbms_sql.bind_variable（cid，'：val'，newval。CellDemandValues（I））; -  执行。nrows：= dbms_sql.execute（cid）; dbms_output.put_line（'ODCIIndexInsert &gt;&gt;&gt;&gt;&gt;（'||'RID'||'，'|| i ||'，'|| newval。CellDemandValues（ⅰ）|| '）'）;我：= newval。CellDemandValues。NEXT（ⅰ）;结束循环; dbms_sql.close_cursor（CID）;返回ODCICONST.SUCCESS; END ODCIIndexInsert;</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="ADDCI4828"></a><a id="ADDCI4827"></a><div class="props_rev_3"><a id="GUID-E30FF8C3-6251-4AFF-8BDE-E88935CB7235" name="GUID-E30FF8C3-6251-4AFF-8BDE-E88935CB7235"></a><h5 id="ADDCI-GUID-E30FF8C3-6251-4AFF-8BDE-E88935CB7235" class="sect5"><span class="enumeration_section">15.4.6.9</span> ODCIIndexDelete（）</h5>
                     <div>
                        <div class="section">
                           <p><a id="d43303e3689" class="indexterm-anchor"></a>当从包含由indextype索引的列或对象属性的表中删除记录时，将调用<a href="example-for-power-demand-cartridge.html#GUID-E30FF8C3-6251-4AFF-8BDE-E88935CB7235__CIAIGHCB">示例15-15中</a>演示的<a href="extensible-indexing-interface.html#GUID-4B2E080D-FE8B-4598-9084-56FBE255196B">ODCIIndexDelete（）</a>函数。索引列中的旧值作为参数与相应的行标识符一起传递。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-E30FF8C3-6251-4AFF-8BDE-E88935CB7235__CIAIGHCB">
                           <p class="titleinexample">示例15-15为Power Demand Cartridge注册ODCIIndexDelete（）</p><pre class="oac_no_warn" dir="ltr">静态功能ODCIIndexDelete（ia sys。ODCIIndexInfo，rid VARCHAR2，oldval PowerDemand_Typ，env sys。ODCIEnv）返回号码作为cid INTEGER; stmt VARCHAR2（1000）; nrows INTEGER; BEGIN dbms_output.put_line（''）; dbms_output.put_line（'ODCIIndexDelete &gt;&gt;&gt;&gt;&gt;'||'TotGridDemand ='|| oldval。TotGridDemand ||' MaxCellDemand ='|| oldval。MaxCellDemand || 'MinCellDemand ='|| oldval。MinCellDemand）; SYS。ODCIIndexInfoDump（IA）; - 构建声明。stmt：='DELETE FROM'|| IA。IndexSchema || '' || IA。INDEXNAME || '_pidx'|| '哪里r =：rr'; DBMS_OUTPUT.PUT_LINE（ 'ODCIIndexDelete &gt;&gt;&gt;&gt;&gt;' || stmt）;第 - 解析并执行语句。cid：= dbms_sql.open_cursor; dbms_sql.parse（cid，stmt，dbms_sql.native）; dbms_sql.bind_variable_rowid（cid，'：rr'，rid）; nrows：= dbms_sql.execute（cid）; dbms_sql.close_cursor（CID）;返回ODCICONST.SUCCESS; END ODCIIndexDelete;</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="ADDCI4830"></a><a id="ADDCI4829"></a><div class="props_rev_3"><a id="GUID-3878F1E1-F59D-4E36-8F23-FF446AFDC348" name="GUID-3878F1E1-F59D-4E36-8F23-FF446AFDC348"></a><h5 id="ADDCI-GUID-3878F1E1-F59D-4E36-8F23-FF446AFDC348" class="sect5"><span class="enumeration_section">15.4.6.10</span> ODCIIndexUpdate（）</h5>
                     <div>
                        <div class="section">
                           <p><a id="d43303e3759" class="indexterm-anchor"></a>当在包含由indextype索引的列或对象属性的表中更新记录时，将调用<a href="example-for-power-demand-cartridge.html#GUID-3878F1E1-F59D-4E36-8F23-FF446AFDC348__CIAJDCEC">示例15-16中</a>演示的<a href="extensible-indexing-interface.html#GUID-CB42E738-EFD1-4053-9DDF-BEF455F92815">ODCIIndexUpdate（）</a>函数。索引列中的旧值和新值作为参数与行标识符一起传入。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-3878F1E1-F59D-4E36-8F23-FF446AFDC348__CIAJDCEC">
                           <p class="titleinexample">示例15-16为Power Demand Cartridge注册ODCIIndexUpdate（）</p><pre class="oac_no_warn" dir="ltr">静态功能ODCIIndexUpdate（ia sys。ODCIIndexInfo，rid VARCHAR2，oldval PowerDemand_Typ，newval PowerDemand_Typ，env sys。ODCIEnv）返回号码作为cid INTEGER; cid2 INTEGER; stmt VARCHAR2（1000）; stmt2 VARCHAR2（1000）; nrows INTEGER;我号码; BEGIN dbms_output.put_line（''）; dbms_output.put_line（'ODCIIndexUpdate &gt;&gt;&gt;&gt;&gt; Old'||'TotGridDemand ='|| oldval。TotGridDemand ||” MaxCellDemand ='|| oldval。MaxCellDemand || 'MinCellDemand ='|| oldval。MinCellDemand）; dbms_output.put_line（'ODCIIndexUpdate &gt;&gt;&gt;&gt;&gt; New'||'TotGridDemand ='|| newval。TotGridDemand ||' MaxCellDemand ='|| newval。MaxCellDemand || 'MinCellDemand ='|| newval。MinCellDemand）; SYS。ODCIIndexInfoDump（IA）; - 删除旧条目。stmt：='DELETE FROM'|| ia。IndexSchema ||'。'|| ia。INDEXNAME || '_pidx' || '哪里r =：rr'; DBMS_OUTPUT.PUT_LINE（ 'ODCIIndexUpdate &gt;&gt;&gt;&gt;&gt;' || stmt）;第 - 解析并执行语句。cid：= dbms_sql.open_cursor; dbms_sql.parse（cid，stmt，dbms_sql.native）; dbms_sql.bind_variable_rowid（cid，'：rr'，rid）; nrows：= dbms_sql.execute（cid）; dbms_sql.close_cursor（CID）; - 插入新条目。stmt2：='INSERT INTO'|| ia。||的IndexSchema '' || IA。INDEXNAME || '_pidx' || 'VALUES（：rr，：pos，：val）'; DBMS_OUTPUT.PUT_LINE（ 'ODCIIndexUpdate &gt;&gt;&gt;&gt;&gt;' || stmt2）; - 解析并执行语句。cid2：= dbms_sql.open_cursor; dbms_sql.parse（cid2，stmt2，dbms_sql.native）; dbms_sql.bind_variable_rowid（cid2，'：rr'，rid）; - 迭代Varray的行并插入它们。我：= newval。CellDemandValues。第一;虽然我不是空的循环 - 将行绑定到光标中以进行插入。dbms_sql.bind_variable（cid2，'：pos'，i）; dbms_sql.bind_variable（cid2，'：val'，newval。CellDemandValues（I））; nrows：= dbms_sql.execute（cid2）; dbms_output.put_line（'ODCIIndexUpdate &gt;&gt;&gt;&gt;&gt;（'||'RID'||'，'|| i ||'，'|| newval。CellDemandValues（ⅰ）|| '）'）;我：= newval。CellDemandValues。NEXT（ⅰ）;结束循环; dbms_sql.close_cursor（CID2）;返回ODCICONST.SUCCESS; END ODCIIndexUpdate;</pre><p><code class="codeph">ODCIIndexUpdate</code>是<code class="codeph">CREATE</code> <code class="codeph">TYPE</code> <code class="codeph">BODY</code>语句中定义的最后一个方法，结束如下：</p><pre class="oac_no_warn" dir="ltr">结束; /</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="ADDCI4832"></a><a id="ADDCI4833"></a><a id="ADDCI4831"></a><div class="props_rev_3"><a id="GUID-D42D34EB-5AEF-4F85-A7BD-EA0F2EB2E6F6" name="GUID-D42D34EB-5AEF-4F85-A7BD-EA0F2EB2E6F6"></a><h5 id="ADDCI-GUID-D42D34EB-5AEF-4F85-A7BD-EA0F2EB2E6F6" class="sect5"><span class="enumeration_section">15.4.6.11</span> ODCIIndexGetMetadata（）</h5>
                     <div>
                        <div class="section">
                           <p><a id="d43303e3845" class="indexterm-anchor"></a><a id="d43303e3847" class="indexterm-anchor"></a><a id="d43303e3851" class="indexterm-anchor"></a>如<a href="example-for-power-demand-cartridge.html#GUID-D42D34EB-5AEF-4F85-A7BD-EA0F2EB2E6F6__CIABBAEG">示例15-17中所示</a> ，可选的<code class="codeph">ODCIIndexGetMetadata()</code>函数<code class="codeph">ODCIIndexGetMetadata()</code>如果存在）由Export实用程序调用，以将特定于实现的元数据（未存储在系统目录中）写入导出转储文件中。此元数据可能是策略信息，版本信息，用户设置等。此元数据作为匿名PL / SQL块写入转储文件，这些块在导入时执行，紧接在创建关联索引之前执行。
                           </p>
                           <p>此方法将字符串返回到Export实用程序，该实用程序包含PL / SQL块的代码。Export实用程序重复调用此方法，直到返回零长度字符串，从而允许创建任意数量的任意复杂度的PL / SQL块。通常，此方法调用PL / SQL包中的函数以使用包级别变量（如游标和迭代计数器），这些变量通过Export维护多个调用的状态。</p>
                           <p>在电源需求盒式磁带中，传递的唯一元数据是<code class="codeph">V1.0</code>的版本字符串，用于标识作为域索引基础的索引组织表的当前格式。<code class="codeph">power_pkg</code> 。 <code class="codeph">getversion</code>函数生成对<code class="codeph">power_pkg</code>的调用。 <code class="codeph">checkversion</code>程序，在导入时执行，检查版本字符串是否为<code class="codeph">V1.0</code> 。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-D42D34EB-5AEF-4F85-A7BD-EA0F2EB2E6F6__CIABBAEG">
                           <p class="titleinexample">示例15-17为Power Demand Cartridge注册ODCIIndexGetMetadata（）</p><pre class="oac_no_warn" dir="ltr">静态功能ODCIIndexGetMetadata（ia sys。ODCIIndexInfo，expversion VARCHAR2，newblock OUT PLS_INTEGER，env sys。ODCIEnv）RETURN VARCHAR2开始 - 让getversion完成所有工作，因为它必须维持跨越调用的状态。RETURN power_pkg.getversion（ia。IndexSchema，ia。IndexName，newblock）;当其他人提升时的异常; END ODCIIndexGetMetaData;</pre></div>
                        <!-- class="example" -->
                        <div class="section">
                           <p><code class="codeph">power_pkg</code>包定义如下：</p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-D42D34EB-5AEF-4F85-A7BD-EA0F2EB2E6F6__GUID-D81BF8B3-527F-4EBE-BE56-7AD80300F4F8">
                           <p class="titleinexample">示例15-18为Power Demand Cartridge创建包power_pkg</p><pre class="oac_no_warn" dir="ltr">CREATE或REPLACE PACKAGE power_pkg AS FUNCTION getversion（idxschema IN VARCHAR2，idxname IN VARCHAR2，newblock OUT PLS_INTEGER）RETURN VARCHAR2; PROCEDURE checkversion（版本IN VARCHAR2）; END power_pkg; /显示错误;创建或替换程序包power_pkg AS-iterate是一个程序包级变量，用于维护跨调用的状态 - 在此会话中通过导出。迭代NUMBER：= 0; FUNCTION getversion（idxschema IN VARCHAR2，idxname IN VARCHAR2，newblock OUT PLS_INTEGER）RETURN VARCHAR2 IS BEGIN  - 我们只生成一个由一行代码组成的PL / SQL块。newblock：= 1; IF iterate = 0那么 - 递增迭代，这样我们就知道我们下次调用时就完成了。iterate：= iterate + 1; - 返回一个调用checkversion的字符串，版本为'V1.0' - 注意导出会添加周围的BEGIN / END对以形成anon。- 阻止...我们没有。RETURN'power_pkg.checkversion（''V1.0''）;'; ELSE  - 为下一个索引迭代重置迭代：= 0; - 返回一个0长度的字符串;我们不会再为这个指数打电话。返回'';万一; END getversion; PROCEDURE checkversion（版本IN VARCHAR2）IS wrong_version EXCEPTION; BEGIN IF版！='V1.0'然后提升wrong_version;万一;结束检查; END power_pkg;</pre></div>
                        <!-- class="example" -->
                        <div class="section">
                           <div class="infoboxnotealso" id="GUID-D42D34EB-5AEF-4F85-A7BD-EA0F2EB2E6F6__GUID-62E38A99-7970-40A6-9AE9-E16C7468371C">
                              <p class="notep1">也可以看看：</p>
                              <p> 有关导出和导入实用<a href="../sutil/oracle-data-pump-overview.html#SUTIL100" target="_blank"><span class="variable" translate="no">Oracle Database Utilities</span></a>的信息，请参见<a href="../sutil/oracle-data-pump-overview.html#SUTIL100" target="_blank"><span class="variable" translate="no">Oracle Database Utilities</span></a>程序</p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div><a id="ADDCI4835"></a><a id="ADDCI4834"></a><div class="props_rev_3"><a id="GUID-50AEDF62-AA49-40A2-9B4D-64E0C22BDFB6" name="GUID-50AEDF62-AA49-40A2-9B4D-64E0C22BDFB6"></a><h4 id="ADDCI-GUID-50AEDF62-AA49-40A2-9B4D-64E0C22BDFB6" class="sect4"><span class="enumeration_section">15.4.7</span>创建索引类型</h4>
                  <div>
                     <div class="section">
                        <p>电源需求盒创建域索引的索引类型。<a href="example-for-power-demand-cartridge.html#GUID-50AEDF62-AA49-40A2-9B4D-64E0C22BDFB6__CIAHDCFE">例15-19中</a>的规范包括indextype支持的运算符列表。它还标识包含OCDI索引例程的实现类型。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-50AEDF62-AA49-40A2-9B4D-64E0C22BDFB6__CIAHDCFE">
                        <p class="titleinexample">示例15-19为Power Demand Cartridge创建Indextype power_idxtype</p><pre class="oac_no_warn" dir="ltr">创建或替换INDEXTYPE power_idxtype FOR Power_Equals（PowerDemand_Typ，NUMBER，NUMBER），Power_GreaterThan（PowerDemand_Typ，NUMBER，NUMBER），Power_LessThan（PowerDemand_Typ，NUMBER，NUMBER），Power_EqualsAny（PowerDemand_Typ，NUMBER），Power_GreaterThanAny（PowerDemand_Typ，NUMBER），Power_LessThanAny（PowerDemand_Typ） ，NUMBER）使用power_idxtype_im;</pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
            </div><a id="ADDCI4836"></a><div class="props_rev_3"><a id="GUID-AD1B4965-8FDB-458B-9E68-09116FD294E4" name="GUID-AD1B4965-8FDB-458B-9E68-09116FD294E4"></a><h3 id="ADDCI-GUID-AD1B4965-8FDB-458B-9E68-09116FD294E4" class="sect3"><span class="enumeration_section">15.5</span>定义可扩展优化的类型和方法</h3>
               <div>
                  <p>考虑功率需求盒的部分，因为它们与可扩展优化有关。</p>
               </div><a id="ADDCI4838"></a><a id="ADDCI4837"></a><div class="props_rev_3"><a id="GUID-12482A82-9C85-450A-AF32-2B7654EA2328" name="GUID-12482A82-9C85-450A-AF32-2B7654EA2328"></a><h4 id="ADDCI-GUID-12482A82-9C85-450A-AF32-2B7654EA2328" class="sect4"><span class="enumeration_section">15.5.1</span>创建统计表，PowerCartUserStats</h4>
                  <div>
                     <div class="section">
                        <p><a href="example-for-power-demand-cartridge.html#GUID-12482A82-9C85-450A-AF32-2B7654EA2328__CIAGEBIC">示例15-20中</a>演示的<code class="codeph">PowerCartUserStats</code>表存储有关每小时电网读数的统计信息。<a href="extensible-optimizer-interface.html#GUID-4CEECA5F-099A-4558-A50C-FD856A814CF3">ODCIStatsSelectivity（）</a>方法使用这些统计信息来估计运算符谓词的选择性。由于收集的统计信息类型，使用单独的表而不是让Oracle存储统计信息更方便。
                        </p>
                        <p><code class="codeph">PowerCartUserStats</code>表包含以下列：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p>收集统计信息的表和列</p>
                           </li>
                           <li>
                              <p>收集统计信息的单元格</p>
                           </li>
                           <li>
                              <p>所有电网读数中给定电池的最小和最大功率需求</p>
                           </li>
                           <li>
                              <p>在所有电网读数上给定电池的<code class="codeph">null</code>读数的数量</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-12482A82-9C85-450A-AF32-2B7654EA2328__CIAGEBIC">
                        <p class="titleinexample">示例15-20为Power Demand Cartridge创建统计表PowerCartUserStats</p><pre class="oac_no_warn" dir="ltr">CREATE TABLE PowerCartUserStats（ - 收集统计信息的表格选项卡VARCHAR2（30）， - 收集统计信息的列col VARCHAR2（30）， - 单元格位置cpos NUMBER， - 给定单元格的最小电力需求lo NUMBER ， - 给定小区的最大功率需求数量， - 给定小区的（非空）功率需求数量为NUMBER）; /</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADDCI4840"></a><a id="ADDCI4839"></a><div class="props_rev_3"><a id="GUID-0BB62838-3F71-42FD-8E13-B05B4C5D3F0B" name="GUID-0BB62838-3F71-42FD-8E13-B05B4C5D3F0B"></a><h4 id="ADDCI-GUID-0BB62838-3F71-42FD-8E13-B05B4C5D3F0B" class="sect4"><span class="enumeration_section">15.5.2</span>创建可扩展优化器方法</h4>
                  <div>
                     <p>电源需求盒式磁带创建一个对象类型，指定可扩展优化器使用的方法。这些方法是<code class="codeph">ODCIStats</code>接口的一部分，它们共同定义<code class="codeph">DBMS_STATS</code>包的方法调用的方法，或者优化器决定查询的最佳执行计划时。
                     </p>
                     <p><a href="example-for-power-demand-cartridge.html#GUID-0BB62838-3F71-42FD-8E13-B05B4C5D3F0B__G1012516" title="列出为Power Demand盒示例创建的可扩展优化器使用的方法，并描述每种方法">表15-5</a>显示了为电源需求盒创建的方法功能。除了其中一个函数之外的所有函数的名称都以字符串<code class="codeph">ODCIStats</code> 。
                     </p>
                     <div class="tblformal" id="GUID-0BB62838-3F71-42FD-8E13-B05B4C5D3F0B__G1012516">
                        <p class="titleintable">表15-5可扩展优化器方法</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="可扩展的优化方法" width="100%" border="1" summary="Lists methods to be used by the extensible optimizer that were created for the Power Demand cartridge example and describes each" frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="32%" id="d43303e4206">方法</th>
                                 <th align="left" valign="bottom" width="68%" id="d43303e4209">描述</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="32%" id="d43303e4214" headers="d43303e4206 ">
                                    <p><a href="extensible-optimizer-interface.html#GUID-866750E9-7193-458B-B29C-6A494094DF6C">ODCIGetInterfaces（）</a></p>
                                 </td>
                                 <td align="left" valign="top" width="68%" headers="d43303e4214 d43303e4209 ">
                                    <p>返回该类型实现的接口的名称列表。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="32%" id="d43303e4223" headers="d43303e4206 ">
                                    <p><a href="extensible-optimizer-interface.html#GUID-227ABB3C-6218-4AA9-BC1C-D963EE800D87">ODCIStatsCollect（）</a></p>
                                 </td>
                                 <td align="left" valign="top" width="68%" headers="d43303e4223 d43303e4209 ">
                                    <p>收集PowerDemand_Typ类型的列或indextype power_idxtype的域索引的统计信息。</p>
                                    <p>该指无论对的列的声明时，此方法被称为<code class="codeph">PowerDemand_Typ</code>类型或所述的索引<code class="codeph">power_idxtype</code>发出INDEXTYPE。调用后，将传入任何指定的选项以及列或索引的描述。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="32%" id="d43303e4240" headers="d43303e4206 ">
                                    <p><a href="extensible-optimizer-interface.html#GUID-294738F4-65B1-4272-BBD6-686F2E38B9C2">ODCIStatsDelete（）</a></p>
                                 </td>
                                 <td align="left" valign="top" width="68%" headers="d43303e4240 d43303e4209 ">
                                    <p>删除<code class="codeph">PowerDemand_Typ</code>类型的<code class="codeph">PowerDemand_Typ</code>或indextype <code class="codeph">power_idxtype</code>域索引的统计<code class="codeph">power_idxtype</code> 。
                                    </p>
                                    <p>当发出删除相应类型的列或相应索引类型的索引的统计信息的语句时，将调用此方法。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="32%" id="d43303e4257" headers="d43303e4206 ">
                                    <p><a href="extensible-optimizer-interface.html#GUID-4CEECA5F-099A-4558-A50C-FD856A814CF3">ODCIStatsSelectivity（）</a></p>
                                 </td>
                                 <td align="left" valign="top" width="68%" headers="d43303e4257 d43303e4209 ">
                                    <p>计算涉及运算符或其功能实现的谓词的选择性。</p>
                                    <p>当查询的<code class="codeph">WHERE</code>子句中出现适当类型的谓词时，由优化程序调用。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="32%" id="d43303e4271" headers="d43303e4206 ">
                                    <p><a href="extensible-optimizer-interface.html#GUID-158EC3A8-CB48-48B2-9405-198BA0FDD777">ODCIStatsIndexCost（）</a></p>
                                 </td>
                                 <td align="left" valign="top" width="68%" headers="d43303e4271 d43303e4209 ">
                                    <p>计算域索引访问路径的开销。</p>
                                    <p>由优化器调用以获取域索引访问路径的开销，假设索引可用于查询。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="32%" id="d43303e4282" headers="d43303e4206 ">
                                    <p><a href="extensible-optimizer-interface.html#GUID-B13AA56D-ABAF-431A-BAED-006B8331DCE1">ODCIStatsFunctionCost（）</a></p>
                                 </td>
                                 <td align="left" valign="top" width="68%" headers="d43303e4282 d43303e4209 ">
                                    <p>计算函数的成本。</p>
                                    <p>由优化器调用以获得执行函数的成本。该功能不一定是运营商的实现。</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div><a id="ADDCI4842"></a><a id="ADDCI4841"></a><div class="props_rev_3"><a id="GUID-130B2EF6-299F-4181-AB04-3E15B5024869" name="GUID-130B2EF6-299F-4181-AB04-3E15B5024869"></a><h5 id="ADDCI-GUID-130B2EF6-299F-4181-AB04-3E15B5024869" class="sect5"><span class="enumeration_section">15.5.2.1</span>创建类型定义</h5>
                     <div>
                        <div class="section">
                           <p><a href="example-for-power-demand-cartridge.html#GUID-130B2EF6-299F-4181-AB04-3E15B5024869__CIAHBGBI">例15-21</a>创建了<code class="codeph">power_statistics</code>对象类型。此对象类型的ODCI方法用于收集和删除有关列和索引的统计信息，使用运算符或函数计算谓词的选择性，以及计算域索引和函数的成本。不使用<code class="codeph">curnum</code>属性。
                           </p>
                           <p><code class="codeph">CREATE TYPE</code>语句后跟一个<code class="codeph">CREATE TYPE BODY</code>语句，该语句指定每个成员函数的实现：</p><pre class="oac_no_warn" dir="ltr">创建或替换TYPE BODY power_statistics IS ...
</pre><p>所有函数定义都具有以下一般形式：</p><pre class="oac_no_warn" dir="ltr">STATIC FUNCTION函数名（...）BEGIN RETURN NUMBER结束;</pre></div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-130B2EF6-299F-4181-AB04-3E15B5024869__CIAHBGBI">
                           <p class="titleinexample">示例15-21为Power Demand Cartridge创建power_statistics对象类型定义</p><pre class="oac_no_warn" dir="ltr">创建或替换类型power_statistics AS OBJECT（curnum NUMBER，STATIC FUNCTION ODCIGetInterfaces（ifclist OUT sys。ODCIObjectList）返回NUMBER，STATIC FUNCTION ODCIStatsCollect（col sys。ODCIColInfo，选项sys。ODCIStatsOptions，rawstats OUT RAW，env sys。ODCIEnv）返回编号，静态功能ODCIStatsDelete（col sys。ODCIColInfo，env sys。ODCIEnv）返回编号，静态功能ODCIStatsCollect（ia sys。ODCIIndexInfo，options sys。ODCIStatsOptions，rawstats OUT RAW，env sys。ODCIEnv）返回编号，静态功能ODCIStatsDelete（ia sys。ODCIIndexInfo，env sys。ODCIEnv）返回编号，静态功能ODCIStatsSelectivity（pred sys。ODCIPredInfo，sel OUT NUMBER，args sys。ODCIArgDescList，strt NUMBER，停止NUMBER，对象PowerDemand_Typ，单元格NUMBER，值NUMBER，env sys。ODCIEnv）返回编号，静态功能ODCIStatsSelectivity（pred sys。ODCIPredInfo，sel OUT NUMBER，args sys。ODCIArgDescList，strt NUMBER，停止NUMBER，对象PowerDemand_Typ，值NUMBER，env sys。ODCIEnv）返回编号，静态功能ODCIStatsIndexCost（ia sys。ODCIIndexInfo，sel NUMBER，cost OUT sys。ODCICost，qi sys。ODCIQueryInfo，pred sys。ODCIPredInfo，args sys。ODCIArgDescList，strt NUMBER，停止NUMBER，cmppos NUMBER，cmpval NUMBER，env sys。ODCIEnv）返回编号，静态功能ODCIStatsIndexCost（ia sys。ODCIIndexInfo，sel NUMBER，cost OUT sys。ODCICost，qi sys。ODCIQueryInfo，pred sys。ODCIPredInfo，args sys。ODCIArgDescList，strt NUMBER，停止NUMBER，cmpval NUMBER，env sys。ODCIEnv）返回编号，静态功能ODCIStatsFunctionCost（func sys。ODCIFuncInfo，成本OUT系统。ODCICost，args sys。ODCIArgDescList，对象PowerDemand_Typ，单元格NUMBER，值NUMBER，env sys。ODCIEnv）返回编号，静态功能ODCIStatsFunctionCost（func sys。ODCIFuncInfo，成本OUT系统。ODCICost，args sys。ODCIArgDescList，对象PowerDemand_Typ，值NUMBER，env sys。ODCIEnv）返回编号，静态功能ODCIStatsFunctionCost（func sys。ODCIFuncInfo，成本OUT系统。ODCICost，args sys。ODCIArgDescList，对象PowerDemand_Typ，单元格NUMBER，值NUMBER，env sys。ODCIEnv）返回号码）; /</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="ADDCI4844"></a><a id="ADDCI4843"></a><div class="props_rev_3"><a id="GUID-64490C8E-E5D7-40BE-8A7C-025AD5E3174C" name="GUID-64490C8E-E5D7-40BE-8A7C-025AD5E3174C"></a><h5 id="ADDCI-GUID-64490C8E-E5D7-40BE-8A7C-025AD5E3174C" class="sect5"><span class="enumeration_section">15.5.2.2</span> ODCIGetInterfaces（）</h5>
                     <div>
                        <div class="section">
                           <p><a href="example-for-power-demand-cartridge.html#GUID-64490C8E-E5D7-40BE-8A7C-025AD5E3174C__CIAJCGEJ">示例15-22中</a>演示的<a href="extensible-optimizer-interface.html#GUID-866750E9-7193-458B-B29C-6A494094DF6C">ODCIGetInterfaces（）</a>函数返回由该类型实现的接口的名称列表。只有一组可扩展的优化器接口例程，称为<code class="codeph">SYS.ODCISTATS</code> ，但服务器支持它们的多个版本以实现向后兼容。要指定例程的当前版本，函数<a href="extensible-optimizer-interface.html#GUID-866750E9-7193-458B-B29C-6A494094DF6C">ODCIGetInterfaces（）</a>必须在<code class="codeph">OUT</code> ， <code class="codeph">ODCIObjectList</code>参数中指定<code class="codeph">SYS.ODCISTATS2</code> 。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-64490C8E-E5D7-40BE-8A7C-025AD5E3174C__CIAJCGEJ">
                           <p class="titleinexample">示例15-22为Power Demand Cartridge注册接口和统计功能</p><pre class="oac_no_warn" dir="ltr">静态功能ODCIGetInterfaces（ifclist OUT sys。ODCIObjectList）RETURN NUMBER是BEGIN ifclist：= sys。ODCIObjectList（SYS。ODCIObject（ 'SYS'， 'ODCISTATS2'））;返回ODCIConst。成功; END ODCIGetInterfaces;</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="ADDCI4846"></a><a id="ADDCI4845"></a><div class="props_rev_3"><a id="GUID-AAB58858-E573-489B-ABFD-C59599E52A3B" name="GUID-AAB58858-E573-489B-ABFD-C59599E52A3B"></a><h5 id="ADDCI-GUID-AAB58858-E573-489B-ABFD-C59599E52A3B" class="sect5"><span class="enumeration_section">15.5.2.3</span> <span class="bold">PowerDemand_Typ</span>列的ODCIStatsCollect（）方法</h5>
                     <div>
                        <div class="section">
                           <p><a href="example-for-power-demand-cartridge.html#GUID-AAB58858-E573-489B-ABFD-C59599E52A3B__CIAFECHD">例15-23中</a>演示的<a href="extensible-optimizer-interface.html#GUID-227ABB3C-6218-4AA9-BC1C-D963EE800D87">ODCIStatsCollect（）</a>函数收集数据类型为<code class="codeph">PowerDemand_Typ</code>对象类型的列的统计信息。在所有电网读数中，为列中的每个单元收集统计数据。对于给定的单元，收集的统计数据是最小和最大电网读数，以及非空读数的数量。
                           </p>
                           <p>该函数将列信息作为对象参数，其类型为<code class="codeph">SYS.ODCICOLINFO</code> 。类型属性包括表名，列名等。用于收集列统计信息的<code class="codeph">DBMS_STATS</code>包命令中指定的选项也作为参数传递。由于电源需求盒使用表来存储统计信息，因此此盒式磁带中不使用输出参数<code class="codeph">rawstats</code> 。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-AAB58858-E573-489B-ABFD-C59599E52A3B__CIAFECHD">
                           <p class="titleinexample">示例15-23为Power Demand Cartridge注册ODCIStatsCollect（）</p><pre class="oac_no_warn" dir="ltr">静态功能ODCIStatsCollect（col sys。ODCIColInfo，选项sys。ODCIStatsOptions，rawstats OUT RAW，env sys。ODCIEnv）返回号码是cnum INTEGER; stmt VARCHAR2（1000）;垃圾INTEGER; cval NUMBER; colname VARCHAR2（30）：= rtrim（ltrim（col.colName，'“'），'”'）; statsexists BOOLEAN：= FALSE; pdemands PowerDemand_Tab％ROWTYPE; user_defined_stats PowerCartUserStats％ROWTYPE; CURSOR c1（tname VARCHAR2，cname VARCHAR2）IS SELECT * FROM PowerCartUserStats WHERE tab = tname AND col = cname; CURSOR c2 IS SELECT * FROM PowerDemand_Tab;开始系统ODCIColInfoDump（COL）; SYS。ODCIStatsOptionsDump（选项）; IF（col。TableSchema是NULL或col。TableName IS NULL或col。ColName IS NULL）然后返回ODCIConst。错误;万一; DBMS_OUTPUT.PUT_LINE（ 'ODCIStatsCollect &gt;&gt;&gt;&gt;&gt;'）; dbms_output.put_line（'****分析列'|| col。TableSchema表|| ”。'||山坳。表名|| '' ||山坳。COLNAME）; - 检查此列的统计信息是否存在FOR user_defined_stats IN c1（col。TableName，colname）LOOP statsexists：= TRUE;出口;结束循环;</pre><p>该函数检查是否存在此列的统计信息。如果是这样，它将它们初始化为<code class="codeph">NULL</code> ;否则，它会为100个单元格中的每一个创建统计信息，并将它们初始化为<code class="codeph">NULL</code> 。</p><pre class="oac_no_warn" dir="ltr">如果不是statsexists那么 - 列统计不存在;为100个单元格中的每一个创建条目cnum：= dbms_sql.open_cursor; FOR i in 1..100 LOOP stmt：='INSERT INTO PowerCartUserStats VALUES（'||''''|| col。TableName || '''，'||''''|| colname ||'''，'|| to_char（i）||'，'||'NULL，NULL，NULL）'; dbms_sql.parse（cnum，stmt，dbms_sql.native）; junk：= dbms_sql.execute（cnum）;结束循环; dbms_sql.close_cursor（CNUM）; ELSE  - 列统计信息存在;初始化为NULL cnum：= dbms_sql.open_cursor; stmt：='UPDATE PowerCartUserStats'|| 'SET lo = NULL，hi = NULL，nrows = NULL'||' WHERE tab ='||山坳。表名||” AND col ='|| colname; dbms_sql.parse（cnum，stmt，dbms_sql.native）; junk：= dbms_sql.execute（cnum）; dbms_sql.close_cursor（CNUM）;万一;</pre><p>该函数通过读取正在分析的表中的行来收集列的统计信息。这是通过构造和执行SQL语句来完成的。</p><pre class="oac_no_warn" dir="ltr">- 对于每个单元格位置，收集以下统计信息： - 最大值 - 最小值 - 行数（不包括NULL）cnum：= dbms_sql.open_cursor; FOR i in 1..100 LOOP for pdemands in c2 LOOP IF BETWEEN pdemands.sample。CellDemandValues。第一个和pdemands.sample。CellDemandValues。最后那么cval：= pdemands.sample。CellDemandValues（ⅰ）; stmt：='UPDATE PowerCartUserStats SET'|| 'lo = least（'||'NVL（'|| to_char（cval）||'，lo），'||'NVL（'||'lo，'|| to_char（cval）||'））， “|| 'hi = great（'||'NVL（'|| to_char（cval）||'，hi），'||'NVL（'||'hi，'|| to_char（cval）||'））， “|| 'nrows = decode（nrows，NULL，decode（'|| to_char（cval）||'，NULL，NULL，1），decode（'|| to_char（cval）||'，NULL，nrows，nrows + 1） ）'||'WHERE cpos ='|| to_char（i）|| 'AND tab ='''|| col。表名|| '' '' ||” AND col ='''|| colname || '' ''; dbms_sql.parse（cnum，stmt，dbms_sql.native）; junk：= dbms_sql.execute（cnum）;万一;结束循环;结束循环;</pre><p>该函数通过关闭游标并返回成功状态来结束。</p><pre class="oac_no_warn" dir="ltr">dbms_sql.close_cursor（CNUM）; rawstats：= NULL;返回ODCIConst。成功; END ODCIStatsCollect;</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="ADDCI4848"></a><a id="ADDCI4847"></a><div class="props_rev_3"><a id="GUID-44A46D99-F33C-4C1C-AB3F-DC0C7BF26D67" name="GUID-44A46D99-F33C-4C1C-AB3F-DC0C7BF26D67"></a><h5 id="ADDCI-GUID-44A46D99-F33C-4C1C-AB3F-DC0C7BF26D67" class="sect5"><span class="enumeration_section">15.5.2.4</span> <span class="bold">PowerDemand_Typ</span>列的ODCIStatsDelete（）方法</h5>
                     <div>
                        <div class="section">
                           <p><a href="example-for-power-demand-cartridge.html#GUID-44A46D99-F33C-4C1C-AB3F-DC0C7BF26D67__CIACJEIF">例15-24中</a>演示的<a href="extensible-optimizer-interface.html#GUID-294738F4-65B1-4272-BBD6-686F2E38B9C2">ODCIStatsDelete（）</a>函数删除了数据类型为<code class="codeph">PowerDemand_Typ</code>对象类型的列的统计信息。该函数将列信息作为对象参数，其类型为<code class="codeph">SYS.ODCICOLINFO</code> 。类型属性包括表名，列名等。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-44A46D99-F33C-4C1C-AB3F-DC0C7BF26D67__CIACJEIF">
                           <p class="titleinexample">示例15-24为Power Demand Cartridge注册ODCIStatsDelete（）</p><pre class="oac_no_warn" dir="ltr">静态功能ODCIStatsDelete（col sys。ODCIColInfo，env sys。ODCIEnv）返回号码是cnum INTEGER; stmt VARCHAR2（1000）;垃圾INTEGER; colname VARCHAR2（30）：= rtrim（ltrim（col.colName，'“'），'”'）; statsexists BOOLEAN：= FALSE; user_defined_stats PowerCartUserStats％ROWTYPE; CURSOR c1（tname VARCHAR2，cname VARCHAR2）IS SELECT * FROM PowerCartUserStats WHERE tab = tname AND col = cname;开始系统ODCIColInfoDump（COL）; IF（col。TableSchema是NULL或col。TableName IS NULL或col。ColName IS NULL）然后返回ODCIConst。错误;万一; DBMS_OUTPUT.PUT_LINE（ 'ODCIStatsDelete &gt;&gt;&gt;&gt;&gt;'）; dbms_output.put_line（'****分析（删除）列'|| col。TableSchema表|| '' ||山坳。表名|| '' ||关口。COLNAME）;</pre></div>
                        <!-- class="example" -->
                        <div class="section">
                           <p>该函数通过检查统计信息表来验证列的统计信息是否存在。如果没有收集统计数据，那么就没有什么可做的了。但是，如果存在统计信息，则构造并执行SQL语句以从统计信息表中删除相关行。</p><pre class="oac_no_warn" dir="ltr">- 检查此列的统计信息是否存在FOR user_defined_stats IN c1（col。TableName，colname）LOOP statsexists：= TRUE;出口;结束循环; - 如果存在用户定义的统计信息，请删除它们IF statsexists THEN stmt：='DELETE FROM PowerCartUserStats'||' WHERE tab ='''|| col。表名|| '' '' || 'AND col ='''|| colname || '' ''; cnum：= dbms_sql.open_cursor; DBMS_OUTPUT.PUT_LINE（ 'ODCIStatsDelete &gt;&gt;&gt;&gt;&gt;'）; dbms_output.put_line（'ODCIStatsDelete &gt;&gt;&gt;&gt;&gt;'|| stmt）; dbms_sql.parse（cnum，stmt，dbms_sql.native）; junk：= dbms_sql.execute（cnum）; dbms_sql.close_cursor（CNUM）;万一;返回ODCIConst。成功; END ODCStatsDelete;</pre></div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="ADDCI4850"></a><a id="ADDCI4849"></a><div class="props_rev_3"><a id="GUID-12CD2083-AF25-4F41-91CB-050DEC92259C" name="GUID-12CD2083-AF25-4F41-91CB-050DEC92259C"></a><h5 id="ADDCI-GUID-12CD2083-AF25-4F41-91CB-050DEC92259C" class="sect5"><span class="enumeration_section">15.5.2.5</span>用于<span class="bold">power_idxtype</span>域索引的ODCIStatsCollect（）方法</h5>
                     <div>
                        <div class="section">
                           <p><a href="example-for-power-demand-cartridge.html#GUID-12CD2083-AF25-4F41-91CB-050DEC92259C__CIAECBHC">例15-25中</a>演示的<a href="extensible-optimizer-interface.html#GUID-227ABB3C-6218-4AA9-BC1C-D963EE800D87">ODCIStatsCollect（）</a>函数收集索引类型为<code class="codeph">power_idxtype</code>域索引的统计信息。在电源需求盒中，此功能仅分析存储索引数据的索引组织表。
                           </p>
                           <p>该函数将索引信息作为对象参数，其类型为<code class="codeph">SYS.ODCIINDEXINFO</code> 。类型属性包括索引名称，所有者名称等。<code class="codeph">DBMS_STATS</code>包指定的选项用于收集索引统计信息，也作为参数传入。不使用输出参数<code class="codeph">rawstats</code> 。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-12CD2083-AF25-4F41-91CB-050DEC92259C__CIAECBHC">
                           <p class="titleinexample">示例15-25为Power Demand Cartridge注册ODCIStatsCollect（）</p><pre class="oac_no_warn" dir="ltr">静态功能ODCIStatsCollect（ia sys。ODCIIndexInfo，options sys。ODCIStatsOptions，rawstats OUT RAW，env sys。ODCIEnv）返回号码是stmt VARCHAR2（1000）; BEGIN  - 要分析域索引，请分析实现索引sys的表。ODCIIndexInfoDump（IA）; SYS。ODCIStatsOptionsDump（选项）; stmt：='dbms_stats.gather_table_stats（'||''''|| ia。IndexSchema || '''，'|| ''''|| IA。IndexName || '_pidx'|| '' '）;'; dbms_output.put_line（'****分析索引'|| ia。IndexSchema || '' || IA。INDEXNAME）; dbms_output.put_line（'SQL Statement：'|| stmt）;执行立即'开始'|| stmt || ' 结束;'; rawstats：= NULL;返回ODCIConst。成功; END ODCIStatsCollect;</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="ADDCI4852"></a><a id="ADDCI4851"></a><div class="props_rev_3"><a id="GUID-9613F347-9D87-49C0-84ED-DD0749F4954E" name="GUID-9613F347-9D87-49C0-84ED-DD0749F4954E"></a><h5 id="ADDCI-GUID-9613F347-9D87-49C0-84ED-DD0749F4954E" class="sect5"><span class="enumeration_section">15.5.2.6</span> ODCIStatsDelete（） <span class="bold">power_idxtype</span>域索引的方法</h5>
                     <div>
                        <div class="section">
                           <p><a href="example-for-power-demand-cartridge.html#GUID-9613F347-9D87-49C0-84ED-DD0749F4954E__CIAJIAAI">例15-26中</a>演示的<a href="extensible-optimizer-interface.html#GUID-294738F4-65B1-4272-BBD6-686F2E38B9C2">ODCIStatsDelete（）</a>函数删除索引类型为<code class="codeph">power_idxtype</code>域索引的统计信息。在电源需求盒中，此功能只删除存储索引数据的索引组织表的统计信息。
                           </p>
                           <p>该函数将索引信息作为对象参数，其类型为<code class="codeph">SYS.ODCIINDEXINFO</code> 。类型属性包括索引名称，所有者名称等。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-9613F347-9D87-49C0-84ED-DD0749F4954E__CIAJIAAI">
                           <p class="titleinexample">示例15-26在Power Demand Cartridge中为域索引注册ODCIStatsDelete（）</p><pre class="oac_no_warn" dir="ltr">静态功能ODCIStatsDelete（ia sys。ODCIIndexInfo，env sys。ODCIEnv）返回号码是stmt VARCHAR2（1000）; BEGIN  - 要删除域索引的统计信息，请删除实现索引sys的 - 表的统计信息。ODCIIndexInfoDump（IA）; stmt：='dbms_stats.delete_table_stats（'||''''|| ia。IndexSchema || '''，'|| ''''|| IA。IndexName || '_pidx'|| '' '）;'; dbms_output.put_line（'****分析（删除）索引'|| ia。||的IndexSchema”。“|| IA。INDEXNAME）; dbms_output.put_line（'SQL Statement：'|| stmt）;执行立即'开始'|| stmt || ' 结束;';返回ODCIConst。成功; END ODCIStatsDelete;</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="ADDCI4854"></a><a id="ADDCI4855"></a><a id="ADDCI4853"></a><div class="props_rev_3"><a id="GUID-3659AEBF-759E-46E9-AE72-7F0970FFF242" name="GUID-3659AEBF-759E-46E9-AE72-7F0970FFF242"></a><h5 id="ADDCI-GUID-3659AEBF-759E-46E9-AE72-7F0970FFF242" class="sect5"><span class="enumeration_section">15.5.2.7</span> <span class="bold">特定</span>查询的ODCIStatsSelectivity（）方法</h5>
                     <div>
                        <div class="section">
                           <p><a href="extensible-optimizer-interface.html#GUID-4CEECA5F-099A-4558-A50C-FD856A814CF3">ODCIStatsSelectivity（）</a>函数的第一个定义估计<code class="codeph">Specific</code>查询的运算符或函数谓词的选择性。例如，如果查询要求cell <code class="codeph">(3,7)</code>的值等于<code class="codeph">25</code>所有实例，则该函数估计给定单元格具有指定值的行的百分比。
                           </p>
                           <p><code class="codeph">pred</code>参数包含函数信息（运算符谓词中运算符的功能实现）;此参数是<code class="codeph">SYS.ODCIPREDINFO</code>类型的对象实例。选择性在<code class="codeph">sel</code>输出参数中以百分比形式返回。<code class="codeph">args</code>参数（ <code class="codeph">SYS.ODCIARGDESCLIST</code>类型的对象实例）包含函数的每个参数的描述符，以及函数的开始和结束值。例如，如果参数是列，则参数描述符包含表名，列名等。<code class="codeph">strt</code>和<code class="codeph">stop</code>参数是函数返回值的下边界和上边界点。如果谓词中的函数包含<code class="codeph">PowerDemand_Typ</code>类型的<code class="codeph">PowerDemand_Typ</code> ，则<code class="codeph">object</code>参数包含对象构造函数形式的值。<code class="codeph">cell</code>参数是单元格位置， <code class="codeph">value</code>参数是函数指定的单元格中的值（ <code class="codeph">PowerXxxxxSpecific_Func</code> ）。
                           </p>
                           <p>通过使用类似于用于简单范围谓词的技术来估计选择性。例如，对谓词的选择性的简单估计</p><pre class="oac_no_warn" dir="ltr">c&gt; v</pre><p>is <code class="codeph">(Mv)/(Mm)</code>其中<code class="codeph">m</code>和<code class="codeph">M</code>分别是列<code class="codeph">c</code>的最小值和最大值（由列统计确定），条件是值<code class="codeph">v</code>位于<code class="codeph">m</code>和<code class="codeph">M</code>之间。</p>
                           <p><a href="example-for-power-demand-cartridge.html#GUID-3659AEBF-759E-46E9-AE72-7F0970FFF242__CIAJJJFC">示例15-27中</a>演示的<code class="codeph">get_selectivity</code>函数根据谓词中列的最小值和最大值计算简单范围谓词的选择性。它假定表中的列值均匀分布在最小值和最大值之间。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-3659AEBF-759E-46E9-AE72-7F0970FFF242__CIAJJJFC">
                           <p class="titleinexample">例15-27为电源需求盒实现选择性功能</p><pre class="oac_no_warn" dir="ltr">CREATE FUNCTION get_selectivity（relop VARCHAR2，value NUMBER，lo NUMBER，hi NUMBER，ndv NUMBER）RETURN NUMBER AS sel NUMBER：= NULL; ndv NUMBER; BEGIN  - 此函数计算谓词的选择性（百分比） -  col &lt;relop&gt; &lt;value&gt;  - 其中&lt;relop&gt;是以下之一：= ,!=，&lt;，&lt;=，&gt;，&gt; =  -  &lt;value&gt;是以下之一：0,1  -  lo和hi是表中列的最小值和最大值。该函数通过假设 - 列的不同值的范围在lo..hi范围内均匀分布并且 - 每个不同的值出现nrows /（hi-lo + 1）来执行对 - 选择性的简单估计。 ）次（其中nrows是 - 行数）。IF ndv IS NULL或ndv &lt;= 0 THEN RETURN 0;万一; -  col！= &lt;值&gt; IF relop ='！='那么如果lo和hi之间的值那么sel：= 1  -  1 / ndv; ELSE sel：= 1;万一; -  col = &lt;value&gt; ELSIF relop ='='那么如果lo和hi之间的值那么sel：= 1 / ndv; ELSE sel：= 0;万一; -  col&gt; = &lt;value&gt; ELSIF relop ='&gt; ='那么如果lo = hi那么如果值&lt;= lo那么sel：= 1; ELSE sel：= 0;万一; lo和hi之间的ELSIF值那么sel：=（hi-value）/（hi-lo）+ 1 / ndv; ELSIF值&lt;lo THEN sel：= 1; ELSE sel：= 0;万一; -  col &lt;&lt;值&gt; ELSIF relop ='&lt;'那么如果lo = hi那么如果值&gt;那么sel：= 1; ELSE sel：= 0;万一; lo和hi之间的ELSIF值那么sel：=（value-lo）/（hi-lo）; ELSIF值&lt;lo THEN sel：= 0; ELSE sel：= 1;万一; -  col &lt;= &lt;value&gt; ELSIF relop ='&lt;='那么如果lo = hi那么如果值&gt; = lo那么sel：= 1; ELSE sel：= 0;万一; lo和hi之间的ELSIF值THEN sel：=（value-lo）/（hi-lo）+ 1 / ndv; ELSIF值&lt;lo THEN sel：= 0; ELSE sel：= 1;万一; -  col&gt; &lt;value&gt; ELSIF relop ='&gt;'那么如果lo = hi那么如果值&lt;lo THEN sel：= 1; ELSE sel：= 0;万一; lo和hi之间的ELSIF值那么sel：=（hi-value）/（hi-lo）; ELSIF值&lt;lo THEN sel：= 1; ELSE sel：= 0;万一;万一;返回最少（100，ceil（100 * sel））;结束; /</pre></div>
                        <!-- class="example" -->
                        <div class="section">
                           <p><a href="example-for-power-demand-cartridge.html#GUID-3659AEBF-759E-46E9-AE72-7F0970FFF242__CIAJECAH">例15-28中</a>演示的<a href="extensible-optimizer-interface.html#GUID-4CEECA5F-099A-4558-A50C-FD856A814CF3">ODCIStatsSelectivity（）</a>函数估计了具有恒定启动和停止值的函数谓词的选择性。此外，谓词中函数的第一个参数必须是<code class="codeph">PowerDemand_Typ</code>类型的列，其余参数必须是常量。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-3659AEBF-759E-46E9-AE72-7F0970FFF242__CIAJECAH">
                           <p class="titleinexample">示例15-28为Power Demand Cartridge的查询注册ODCIStatsSelectivity（）</p><pre class="oac_no_warn" dir="ltr">静态功能ODCIStatsSelectivity（pred sys。ODCIPredInfo，sel OUT NUMBER，args sys。ODCIArgDescList，strt NUMBER，停止NUMBER，对象PowerDemand_Typ，单元格NUMBER，值NUMBER，env sys。ODCIEnv）返回号码是fname varchar2（30）; relop varchar2（2）; lo NUMBER;嗨，NUMBER; nrows NUMBER; colname VARCHAR2（30）; statsexists BOOLEAN：= FALSE; stats PowerCartUserStats％ROWTYPE; CURSOR c1（单元格NUMBER，tname VARCHAR2，cname VARCHAR2）IS SELECT * FROM PowerCartUserStats WHERE cpos = cell AND tab = tname AND col = cname; BEGIN  - 仅当谓词具有以下形式时才计算选择性： -  fn（col，&lt;cell&gt;，&lt;value&gt;）&lt;relop&gt; &lt;val&gt;  - 在所有其他情况下，返回错误并让优化器 -  make一个猜测。我们还假设函数“fn”具有 - 返回值0,1或NULL。 - 起始值IF（args（1）。ArgType！= ODCIConst。ArgLit AND args（1）。ArgType！= ODCIConst。ArgNull）然后返回ODCIConst。错误;万一; - 停止值IF（args（2）。ArgType！= ODCIConst。ArgLit和args（2）。ArgType！= ODCIConst。ArgNull）然后返回ODCIConst。错误;万一; - 函数IF的第一个参数（args（3）。ArgType！= ODCIConst。ArgCol）然后返回ODCIConst。错误;万一; - 函数IF的第二个参数（args（4）。ArgType！= ODCIConst。ArgLit和args（4）。ArgType！= ODCIConst。ArgNull）然后返回ODCIConst。错误;万一; - 函数IF的第三个参数（args（5）。ArgType！= ODCIConst。ArgLit和args（5）。ArgType！= ODCIConst。ArgNull）然后返回ODCIConst。错误;万一; colname：= rtrim（ltrim（args（3）.colName，'“'），'”'）;</pre><p>谓词中函数的第一个（列）参数必须包含为其收集的统计信息。如果尚未收集统计信息，则<a href="extensible-optimizer-interface.html#GUID-4CEECA5F-099A-4558-A50C-FD856A814CF3">ODCIStatsSelectivity（）</a>将返回错误状态。
                           </p><pre class="oac_no_warn" dir="ltr">- 检查统计表是否存在（我们使用 - 用户定义的表来存储用户定义的统计信息）。- 获取用户定义的统计数据：MIN，MAX，NROWS FOR stats IN c1（cell，args（3）。TableName，colname）LOOP  - 获取用户定义的统计信息：MIN，MAX，NROWS lo：= stats.lo;你好：= stats.hi; nrows：= stats.nrows; statsexists：= TRUE;出口;结束循环; - 如果没有收集用户定义的统计信息，则返回错误IF而不是statsexists THEN RETURN ODCIConst。错误;万一;</pre><p>每个<code class="codeph">Specific</code>函数谓词对应于等效范围谓词。例如，谓词<code class="codeph">Power_EqualsSpecific_Func(col, 21, 25) = 0</code> ，它检查单元格<code class="codeph">21</code>中的读数不等于<code class="codeph">25</code> ，对应于等效范围谓词<code class="codeph">col[21] != 25</code> 。
                           </p>
                           <p><a href="extensible-optimizer-interface.html#GUID-4CEECA5F-099A-4558-A50C-FD856A814CF3">ODCIStatsSelectivity（）</a>函数查找每个<code class="codeph">Specific</code>函数谓词的相应范围谓词。有几种边界情况可以立即确定选择性。
                           </p><pre class="oac_no_warn" dir="ltr">- 对于“fn（col，&lt;cell&gt;，&lt;value&gt;）&lt;0”IF（stop = 0 AND bitand（pred。），选择性为0。标志，ODCIConst。PredIncludeStop）= 0）那么sel：= 0;返回ODCIConst。成功;万一; - 对于“fn（col，&lt;cell&gt;，&lt;value&gt;）&gt; 1”IF（strt = 1 AND bitand（pred。），选择性为0。标志，ODCIConst。PredIncludeStart）= 0）那么sel：= 0;返回ODCIConst。成功;万一; - “fn（col，&lt;cell&gt;，&lt;value&gt;）&gt; = 0”IF（strt = 0 AND bitand（pred。）的选择性为100％。标志，ODCIConst。PredExactMatch）= 0 AND bitand（pred。标志，ODCIConst。PredIncludeStart）&gt; 0）那么sel：= 100;返回ODCIConst。成功;万一; - “fn（col，&lt;cell&gt;，&lt;value&gt;）&lt;= 1”IF的选择性为100％（stop = 1 AND bitand（pred。标志，ODCIConst。PredExactMatch）= 0 AND bitand（pred。标志，ODCIConst。PredIncludeStop）&gt; 0）那么sel：= 100;返回ODCIConst。成功;万一; - 获取函数名称IF bit（pred。标志，ODCIConst。PredObjectFunc）&gt; 0 THEN fname：= pred。对象名; ELSE fname：= pred。方法名;万一; - 将前缀关系运算符转换为中缀： - “Power_EqualsSpecific_Func（col，&lt;cell&gt;，&lt;value&gt;）= 1” - 变为“col [&lt;cell&gt;] = &lt;value&gt;” -  Power_EqualsSpecific_Func（col，&lt;cell &gt;，&lt;value&gt;）= 0  -  Power_EqualsSpecific_Func（col，&lt;cell&gt;，&lt;value&gt;）&lt;= 0  -  Power_EqualsSpecific_Func（col，&lt;cell&gt;，&lt;value&gt;）&lt;1  - 可以转换为 -  col [&lt;cell&gt;]！= &lt;value&gt; IF（fname LIKE upper（'Power_Equals％'）AND（stop = 0 OR（stop = 1 AND bitand（pred。）标志，ODCIConst。PredIncludeStop）= 0）））那么relop：='！='; -  Power_LessThanSpecific_Func（col，&lt;cell&gt;，&lt;value&gt;）= 0  -  Power_LessThanSpecific_Func（col，&lt;cell&gt;，&lt;value&gt;）&lt;= 0  -  Power_LessThanSpecific_Func（col，&lt;cell&gt;，&lt;value&gt;）&lt;1  -  - 可以转换为 -  col [&lt;cell&gt;]&gt; = &lt;value&gt; ELSIF（fname LIKE upper（'Power_LessThan％'）AND（stop = 0 OR（stop = 1 AND bitand（pred。）标志，ODCIConst。PredIncludeStop）= 0）））那么relop：='&gt; ='; -  Power_GreaterThanSpecific_Func（col，&lt;cell&gt;，&lt;value&gt;）= 0  -  Power_GreaterThanSpecific_Func（col，&lt;cell&gt;，&lt;value&gt;）&lt;= 0  -  Power_GreaterThanSpecific_Func（col，&lt;cell&gt;，&lt;value&gt;）&lt;1  -  - 可以转换为 -  col [&lt;cell&gt;] &lt;= &lt;value&gt; ELSIF（fname LIKE upper（'Power_GreaterThan％'）AND（stop = 0 OR（stop = 1 AND bitand（pred。）标志，ODCIConst。PredIncludeStop）= 0）））那么relop：='&lt;='; -  Power_EqualsSpecific_Func（col，&lt;cell&gt;，&lt;value&gt;）= 1  -  Power_EqualsSpecific_Func（col，&lt;cell&gt;，&lt;value&gt;）&gt; = 1  -  Power_EqualsSpecific_Func（col，&lt;cell&gt;，&lt;value&gt;）&gt; 0  -  - 可以转换为 -  col [&lt;cell&gt;] = &lt;value&gt; ELSIF（fname LIKE upper（'Power_Equals％'）AND（strt = 1 OR（strt = 0 AND bitand（pred。标志，ODCIConst。PredIncludeStart）= 0）））那么relop：='='; -  Power_LessThanSpecific_Func（col，&lt;cell&gt;，&lt;value&gt;）= 1  -  Power_LessThanSpecific_Func（col，&lt;cell&gt;，&lt;value&gt;）&gt; = 1  -  Power_LessThanSpecific_Func（col，&lt;cell&gt;，&lt;value&gt;）&gt; 0  -  - 可以转换为 -  col [&lt;cell&gt;] &lt;&lt; Value&gt; ELSIF（fname LIKE upper（'Power_LessThan％'）AND（strt = 1 OR（strt = 0 AND bitand（pred。）标志，ODCIConst。PredIncludeStart）= 0）））那么relop：='&lt;'; -  Power_GreaterThanSpecific_Func（col，&lt;cell&gt;，&lt;value&gt;）= 1  -  Power_GreaterThanSpecific_Func（col，&lt;cell&gt;，&lt;value&gt;）&gt; = 1  -  Power_GreaterThanSpecific_Func（col，&lt;cell&gt;，&lt;value&gt;）&gt; 0  -  - 可以转换为 -  col [&lt;cell&gt;]&gt; &lt;value&gt; ELSIF（fname LIKE upper（'Power_GreaterThan％'）AND（strt = 1 OR（strt = 0 AND bitand（pred。）标志，ODCIConst。PredIncludeStart）= 0）））那么relop：='&gt;'; ELSE RETURN ODCIConst。错误;万一;</pre><p>在将<code class="codeph">Specific</code>函数谓词转换为简单范围谓词之后， <a href="extensible-optimizer-interface.html#GUID-4CEECA5F-099A-4558-A50C-FD856A814CF3">ODCIStatsSelectivity（）</a>调用<code class="codeph">get_selectivity</code>来计算范围谓词的选择性（因此，等效地，对于<code class="codeph">Specific</code>函数谓词）。它返回成功状态。
                           </p><pre class="oac_no_warn" dir="ltr">sel：= get_selectivity（relop，value，lo，hi，nrows）;返回ODCIConst。成功;结束;</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="ADDCI4857"></a><a id="ADDCI4856"></a><div class="props_rev_3"><a id="GUID-A248709C-33C3-4171-BBE8-270972724BFA" name="GUID-A248709C-33C3-4171-BBE8-270972724BFA"></a><h5 id="ADDCI-GUID-A248709C-33C3-4171-BBE8-270972724BFA" class="sect5"><span class="enumeration_section">15.5.2.8</span> ODCIStatsIndexCost（） <span class="bold">特定</span>查询的方法</h5>
                     <div>
                        <div class="section">
                           <p><a href="example-for-power-demand-cartridge.html#GUID-A248709C-33C3-4171-BBE8-270972724BFA__CIABCJAG">例15-29中</a>演示的<code class="codeph">ODCIStatsIndexCost()</code>函数的第一个定义估计了<code class="codeph">Specific</code>查询的域索引的开销。例如，如果查询要求cell <code class="codeph">(3,7)</code>具有等于<code class="codeph">25</code>的值的所有实例，则该函数估计用于评估此查询的域索引访问路径的开销。<code class="codeph">ODCIStatsIndexCost()</code>的定义与<code class="codeph">ODCIStatsIndexCost() Method for Any Queries</code>的定义不同，因为它包含单元格位置的<code class="codeph">cmppos</code>参数。
                           </p>
                           <p><code class="codeph">ia</code>参数包含索引信息，作为<code class="codeph">SYS.ODCIINDEXINFO</code>类型的对象实例。 <code class="codeph">sel</code>参数是由<code class="codeph">ODCIStatsSelectivity()</code>函数针对<code class="codeph">Specific</code>查询估计的运算符谓词的选择性。估算成本在<code class="codeph">cost</code>输出参数中返回。<code class="codeph">qi</code>参数包含有关查询及其环境的一些信息，例如是否正在使用<code class="codeph">ALL_ROWS</code>或<code class="codeph">FIRST_ROWS</code>优化器模式。<code class="codeph">pred</code>参数包含操作员信息，作为<code class="codeph">SYS.ODCIPREDINFO</code>类型的对象实例。 <code class="codeph">args</code>参数包含运算符的value参数的描述符，以及运算符的start和stop值。<code class="codeph">strt</code>和<code class="codeph">stop</code>参数是操作员返回值的下边界和上边界点。<code class="codeph">cmppos</code>参数是单元格位置， <code class="codeph">cmpval</code>是运算符<code class="codeph">Power_XxxxxSpecific()</code>指定的单元格中的值。
                           </p>
                           <p>在电源需求盒式磁带中， <code class="codeph">Specific</code>查询的域索引成本与<code class="codeph">Any</code>查询的域索引成本相同，因此此版本的<code class="codeph">ODCIStatsIndexCost()</code>函数只调用该函数的第二个定义，如<code class="codeph">ODCIStatsIndexCost() Method for Any Queries</code> 。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-A248709C-33C3-4171-BBE8-270972724BFA__CIABCJAG">
                           <p class="titleinexample">示例15-29为Power Demand Cartridge的查询注册ODCISIndexCost（）</p><pre class="oac_no_warn" dir="ltr">静态功能ODCIStatsIndexCost（ia sys。ODCIIndexInfo，sel NUMBER，cost OUT sys。ODCICost，qi sys。ODCIQueryInfo，pred sys。ODCIPredInfo，args sys。ODCIArgDescList，strt NUMBER，停止NUMBER，cmppos NUMBER，cmpval NUMBER，env sys。ODCIEnv）返回号码开始 - 这是特定小区查询的成本;简单地说 - 在任何单元格上使用查询的成本。RETURN ODCIStatsIndexCost（ia，sel，cost，qi，pred，args，strt，stop，cmpval，env）;结束;</pre><div class="infoboxnotealso" id="GUID-A248709C-33C3-4171-BBE8-270972724BFA__GUID-11BBDDD5-2F41-4DE7-B359-9B93A9ED6841">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><a href="extensible-optimizer-interface.html#GUID-158EC3A8-CB48-48B2-9405-198BA0FDD777">ODCIStatsIndexCost（）</a></p>
                                 </li>
                                 <li>
                                    <p><a href="example-for-power-demand-cartridge.html#GUID-2AFC0498-0606-4B99-AD0B-480339855F44">任何查询的ODCIStatsIndexCost（）方法</a></p>
                                 </li>
                                 <li>
                                    <p><a href="extensible-optimizer-interface.html#GUID-4CEECA5F-099A-4558-A50C-FD856A814CF3">ODCIStatsSelectivity（）</a></p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="ADDCI4859"></a><a id="ADDCI4858"></a><div class="props_rev_3"><a id="GUID-2AFC0498-0606-4B99-AD0B-480339855F44" name="GUID-2AFC0498-0606-4B99-AD0B-480339855F44"></a><h5 id="ADDCI-GUID-2AFC0498-0606-4B99-AD0B-480339855F44" class="sect5"><span class="enumeration_section">15.5.2.9</span> <span class="bold">任何</span>查询的ODCIStatsIndexCost（）方法</h5>
                     <div>
                        <div class="section">
                           <p><a href="example-for-power-demand-cartridge.html#GUID-2AFC0498-0606-4B99-AD0B-480339855F44__CIAEDEIG">例15-30中</a>演示的<code class="codeph">ODCIStatsIndexCost()</code>函数的第二个定义估计了<code class="codeph">Any</code>查询的域索引的开销。例如，如果查询要求任何单元格的值等于25的所有实例，则该函数会估计用于评估此查询的域索引访问路径的开销。<code class="codeph">ODCIStatsIndexCost()</code>的定义与<code class="codeph">ODCIStatsIndexCost() Method for Specific Queries</code>的定义不同，因为它不包含<code class="codeph">cmppos</code>参数。
                           </p>
                           <p><code class="codeph">ia</code>参数包含索引信息，作为<code class="codeph">SYS.ODCIINDEXINFO</code>类型的对象实例。 <code class="codeph">sel</code>参数是由<code class="codeph">Any</code>查询的<code class="codeph">ODCIStatsSelectivity()</code>函数估计的运算符谓词的选择性。估算成本在<code class="codeph">cost</code>输出参数中返回。<code class="codeph">qi</code>参数包含有关查询及其环境的一些信息，例如是否正在使用<code class="codeph">ALL_ROWS</code>或<code class="codeph">FIRST_ROWS</code>优化器模式。<code class="codeph">pred</code>参数包含操作员信息，作为<code class="codeph">SYS.ODCIPREDINFO</code>类型的对象实例。 <code class="codeph">args</code>参数包含运算符的value参数的描述符，以及运算符的start和stop值。<code class="codeph">strt</code>和<code class="codeph">stop</code>参数是操作员返回值的下边界和上边界点。<code class="codeph">cmpval</code>参数是运算符<code class="codeph">Power_XxxxxAny()</code>指定的单元格中的值。
                           </p>
                           <p>索引成本估计为实现索引的索引组织表中的块数乘以运算符谓词的选择性乘以常数因子。</p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-2AFC0498-0606-4B99-AD0B-480339855F44__CIAEDEIG">
                           <p class="titleinexample">示例15-30为Power Demand Cartridge的任何查询注册ODCIStatsIndexCost（）</p><pre class="oac_no_warn" dir="ltr">静态功能ODCIStatsIndexCost（ia sys。ODCIIndexInfo，sel NUMBER，cost OUT sys。ODCICost，qi sys。ODCIQueryInfo，pred sys。ODCIPredInfo，args sys。ODCIArgDescList，strt NUMBER，停止NUMBER，cmpval NUMBER，env sys。ODCIEnv）返回号码是ixtable VARCHAR2（40）; numblocks NUMBER：= NULL; get_table user_tables％ROWTYPE; CURSOR c1（tab VARCHAR2）IS SELECT * FROM user_tables WHERE table_name = tab; BEGIN  - 这是任何单元格查询的成本。- 要计算域索引的成本，将 - 实现索引的表中的块数 - 乘以选择性 - 如果我们没有谓词选择性则返回IF sel IS NULL返回ODCIConst。错误;万一; cost：= sys。ODCICost（NULL，NULL，NULL，NULL）; - 获取实现域索引的表的名称ixtable：= ia。IndexName || '_pidx'; - 获取域索引中的块数FOR get_table IN c1（upper（ixtable））LOOP numblocks：= get_table.blocks;出口;结束循环; IF numblocks IS NULL THEN  - 如果索引RETURN ODCIConst没有用户定义的统计信息，则退出。错误;万一;成本。CPUCost：= ceil（400 *（sel / 100）* numblocks）;成本。IOCost：= ceil（1.5 *（sel / 100）* numblocks）;返回ODCIConst。成功;结束;</pre><div class="infoboxnotealso" id="GUID-2AFC0498-0606-4B99-AD0B-480339855F44__GUID-D8A9A3D6-FB7E-4E04-ABFA-97138554BD8B">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><a href="extensible-optimizer-interface.html#GUID-158EC3A8-CB48-48B2-9405-198BA0FDD777">ODCIStatsIndexCost（）</a></p>
                                 </li>
                                 <li>
                                    <p><a href="example-for-power-demand-cartridge.html#GUID-A248709C-33C3-4171-BBE8-270972724BFA">ODCIStatsIndexCost（）特定查询的方法</a></p>
                                 </li>
                                 <li>
                                    <p><a href="extensible-optimizer-interface.html#GUID-4CEECA5F-099A-4558-A50C-FD856A814CF3">ODCIStatsSelectivity（）</a></p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="ADDCI4861"></a><a id="ADDCI4860"></a><div class="props_rev_3"><a id="GUID-A3398ED3-8FD7-43E2-8A15-E0E37D08DE9B" name="GUID-A3398ED3-8FD7-43E2-8A15-E0E37D08DE9B"></a><h5 id="ADDCI-GUID-A3398ED3-8FD7-43E2-8A15-E0E37D08DE9B" class="sect5"><span class="enumeration_section">15.5.2.10</span> ODCIStatsFunctionCost（）方法</h5>
                     <div>
                        <div class="section">
                           <p><a href="example-for-power-demand-cartridge.html#GUID-A3398ED3-8FD7-43E2-8A15-E0E37D08DE9B__CIAHHBJG">例15-31中</a>演示的<a href="extensible-optimizer-interface.html#GUID-B13AA56D-ABAF-431A-BAED-006B8331DCE1">ODCIStatsFunctionCost（）</a>函数估计了评估函数<code class="codeph">Power_XxxxxSpecific_Func()</code>或<code class="codeph">Power_XxxxxAny_Func()</code>的成本。
                           </p>
                           <p><code class="codeph">func</code>参数包含函数信息;此参数是<code class="codeph">SYS.ODCIFUNCINFO</code>类型的对象实例。估计成本在输出<code class="codeph">cost</code>参数中返回。作为<code class="codeph">SYS.ODCIARGDESCLIST</code>类型的对象实例的<code class="codeph">args</code>参数包含函数的每个参数的描述符。如果函数包含<code class="codeph">PowerDemand_Typ</code>类型的<code class="codeph">PowerDemand_Typ</code>作为其第一个参数，则<code class="codeph">object</code>参数包含对象构造函数形式的值。<code class="codeph">value</code>参数是函数<code class="codeph">PowerXxxxxSpecific_Func()</code>或<code class="codeph">Power_XxxxxAny_Func()</code>指定的单元格中的值。
                           </p>
                           <p>根据函数名称，函数成本简单地估计为某个默认值。由于函数不从磁盘读取任何数据，因此I / O成本设置为零。</p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-A3398ED3-8FD7-43E2-8A15-E0E37D08DE9B__CIAHHBJG">
                           <p class="titleinexample">示例15-31为Power Demand Cartridge注册ODCIStatsFunctionCost（）</p><pre class="oac_no_warn" dir="ltr">静态功能ODCIStatsFunctionCost（func sys。ODCIFuncInfo，成本OUT系统。ODCICost，args sys。ODCIArgDescList，对象PowerDemand_Typ，值NUMBER，env sys。ODCIEnv）返回号码是fname VARCHAR2（30）;开始费用：= sys。ODCICost（NULL，NULL，NULL，NULL）; - 获取函数名称IF bitand（func。标志，ODCIConst。ObjectFunc）&gt; 0那么fname：= func。对象名; ELSE fname：= func。方法名;万一; IF fname LIKE upper（'Power_LessThan％'）那么费用。CPUCost：= 5000;成本。IOCost：= 0;返回ODCIConst。成功; ELSIF fname LIKE upper（'Power_Equals％'）那么费用。CPUCost：= 7000;成本。IOCost：= 0;返回ODCIConst。成功; ELSIF fname LIKE upper（'Power_GreaterThan％'）那么费用。CPUCost：= 5000;成本。IOCost：= 0;返回ODCIConst。成功; ELSE RETURN ODCIConst。错误;万一;结束;</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div>
               </div><a id="ADDCI4863"></a><a id="ADDCI4862"></a><div class="props_rev_3"><a id="GUID-3D3E0C4D-D3FC-426C-A4C9-5BABA008B6BE" name="GUID-3D3E0C4D-D3FC-426C-A4C9-5BABA008B6BE"></a><h4 id="ADDCI-GUID-3D3E0C4D-D3FC-426C-A4C9-5BABA008B6BE" class="sect4"><span class="enumeration_section">15.5.3</span>将可扩展优化器方法与数据库对象关联</h4>
                  <div>
                     <div class="section">
                        <p>为了使优化器使用<code class="codeph">power_statistics</code>对象类型中定义的方法，必须将它们与相应的数据库对象相关联，如<a href="example-for-power-demand-cartridge.html#GUID-3D3E0C4D-D3FC-426C-A4C9-5BABA008B6BE__CIAFGDIF">例15-32所示</a> 。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-3D3E0C4D-D3FC-426C-A4C9-5BABA008B6BE__CIAFGDIF">
                        <p class="titleinexample">示例15-32将数据库对象的统计方法用于电源需求盒式磁带</p><pre class="oac_no_warn" dir="ltr">将统计类型与类型，索引类型和函数关联关联统计与类型PowerDemand_Typ使用power_statistics;使用INDEXTYPES的关联统计数据power_idxtype使用带有系统管理存储表的power_statistics;使用函数的关联统计数据Power_EqualsSpecific_Func，Power_GreaterThanSpecific_Func，Power_LessThanSpecific_Func，Power_EqualsAny_Func，Power_GreaterThanAny_Func，Power_LessThanAny_Func使用power_statistics;</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADDCI4865"></a><a id="ADDCI4864"></a><div class="props_rev_3"><a id="GUID-B2AFBB43-0A13-4309-A0B7-D8D81A808E83" name="GUID-B2AFBB43-0A13-4309-A0B7-D8D81A808E83"></a><h4 id="ADDCI-GUID-B2AFBB43-0A13-4309-A0B7-D8D81A808E83" class="sect4"><span class="enumeration_section">15.5.4</span>分析数据库对象</h4>
                  <div>
                     <div class="section">
                        <p>分析表，列和索引可确保优化程序具有相关统计信息，以估计各种访问路径的准确成本并选择一个好的计划。此外， <code class="codeph">power_statistics</code>对象类型中定义的选择性和成本函数依赖于统计信息的存在。<a href="example-for-power-demand-cartridge.html#GUID-B2AFBB43-0A13-4309-A0B7-D8D81A808E83__CIABDGID">示例15-33</a>演示了分析数据库对象并验证确实收集了统计信息的语句。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-B2AFBB43-0A13-4309-A0B7-D8D81A808E83__CIABDGID">
                        <p class="titleinexample">示例15-33分析电源需求盒的数据库对象</p><pre class="oac_no_warn" dir="ltr">- 分析表EXECUTE dbms_stats.gather_table_stats（'POWERCARTUSER'，'POWERDEMAND_TAB'，cascade =&gt; TRUE）; - 验证是否收集了用户定义的统计信息SELECT tab tablename，col colname，cpos，lo，hi，nrows FROM PowerCartUserStats WHERE nrows IS NOT NULL ORDER BY cpos; - 删除统计信息EXECUTE dbms_stats.delete_table_stats（'POWERCARTUSER'，'POWERDEMAND_TAB'）; - 验证用户定义的统计信息是否已删除SELECT tab tablename，col colname，cpos，lo，hi，nrows FROM PowerCartUserStats WHERE nrows IS NOT NULL ORDER BY cpos; - 重新分析表EXECUTE dbms_stats.gather_table_stats（'POWERCARTUSER'，'POWERDEMAND_TAB'，cascade =&gt; TRUE）; - 验证是否重新收集了用户定义的统计信息SELECT tab tablename，col colname，cpos，lo，hi，nrows FROM PowerCartUserStats WHERE nrows IS NOT NULL ORDER BY cpos;</pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
            </div><a id="ADDCI4866"></a><div class="props_rev_3"><a id="GUID-62E8B2EA-FC0B-43A1-9A6D-6FD3CD7587BF" name="GUID-62E8B2EA-FC0B-43A1-9A6D-6FD3CD7587BF"></a><h3 id="ADDCI-GUID-62E8B2EA-FC0B-43A1-9A6D-6FD3CD7587BF" class="sect3"><span class="enumeration_section">15.6</span>测试域索引</h3>
               <div>
                  <p>考虑电源需求示例中执行域索引的一些简单测试的部分，以及如何测试域索引并查看它是否导致查询的执行效率高于没有索引的情况。这些测试包括：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>创建电源需求表（ <code class="codeph">PowerDemand_Tab</code> ）并使用少量数据填充它</p>
                     </li>
                     <li>
                        <p>在创建索引之前执行一些查询（并显示没有使用索引的执行计划）</p>
                        <p>执行计划显示在每种情况下都执行全表扫描。</p>
                     </li>
                     <li>
                        <p>在网格上创建索引</p>
                     </li>
                     <li>
                        <p>创建索引后执行相同的查询（并显示正在使用索引的执行计划）</p>
                        <p>执行计划显示Oracle正在使用索引而不执行全表扫描，因此可以提高执行效率。</p>
                     </li>
                  </ul>
                  <p>此处描述的语句可在示例文件（tkqxpwr.sql）中在线获得。</p>
               </div><a id="ADDCI4868"></a><a id="ADDCI4869"></a><a id="ADDCI4870"></a><a id="ADDCI4867"></a><div class="props_rev_3"><a id="GUID-E784E9CF-E397-4190-8AA0-9BE1BAE5885C" name="GUID-E784E9CF-E397-4190-8AA0-9BE1BAE5885C"></a><h4 id="ADDCI-GUID-E784E9CF-E397-4190-8AA0-9BE1BAE5885C" class="sect4"><span class="enumeration_section">15.6.1</span>创建和<span class="enumeration_section">填充</span>电力需求表</h4>
                  <div>
                     <div class="section">
                        <p>如<a href="example-for-power-demand-cartridge.html#GUID-E784E9CF-E397-4190-8AA0-9BE1BAE5885C__CIABEGBC">示例15-34</a>所示，电源需求表由两列创建：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">region</code>允许电力公用事业在多个区域或状态中使用电网方案。每个区域，例如纽约，新泽西，宾夕法尼亚等，由<code class="codeph">10x10</code>网格表示。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">sample</code>是使用<code class="codeph">PowerDemand_Typ</code>对象类型定义的采样或电网中每个单元的电源需求读数的<code class="codeph">PowerDemand_Typ</code> 。
                              </p>
                           </li>
                        </ul>
                        <p>插入几行，表示两个区域<code class="codeph">1</code>和<code class="codeph">2</code>电力需求数据，用于几个小时时间戳。为简单起见，值仅插入每个网格的前<code class="codeph">5</code>位置;其余<code class="codeph">95</code>值设置为<code class="codeph">null</code> ，如<a href="example-for-power-demand-cartridge.html#GUID-E784E9CF-E397-4190-8AA0-9BE1BAE5885C__CIAGCGBE">例15-35所示</a> 。
                        </p>
                        <p>最后，为每个新插入的行计算并设置<code class="codeph">TotGridDemand</code> ， <code class="codeph">MaxCellDemand</code>和<code class="codeph">MinCellDemand</code>值，并显示这些值，如<a href="example-for-power-demand-cartridge.html#GUID-E784E9CF-E397-4190-8AA0-9BE1BAE5885C__CIAEFDEB">例15-36所示</a> 。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-E784E9CF-E397-4190-8AA0-9BE1BAE5885C__CIABEGBC">
                        <p class="titleinexample">示例15-34为Power Demand Cartridge创建PowerDemand_Tab表</p><pre class="oac_no_warn" dir="ltr">CREATE TABLE PowerDemand_Tab（ - 这些电源需求读数适用的区域NUMBER， - 每个“采样”时间（给定小时）样本PowerDemand_Typ的值）;</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-E784E9CF-E397-4190-8AA0-9BE1BAE5885C__CIAGCGBE">
                        <p class="titleinexample">示例15-35为Power Demand Cartridge填充PowerDemand_Tab表</p><pre class="oac_no_warn" dir="ltr">- 下一个INSERT语句通过仅提供5个网格值来“欺骗” - 前5个INSERT语句用于区域1（1998年2月1日凌晨1点到5点）。INSERT INTO PowerDemand_Tab VALUES（1，PowerDemand_Typ（NULL，NULL，NULL，PowerGrid_Typ（55,8,13,9,5），to_date（'02 -01-1998 01'，'MM-DD-YYYY HH'））） ; INSERT INTO PowerDemand_Tab VALUES（1，PowerDemand_Typ（NULL，NULL，NULL，PowerGrid_Typ（56,8,13,9,3），to_date（'02 -01-1998 02'，'MM-DD-YYYY HH'））） ; INSERT INTO PowerDemand_Tab VALUES（1，PowerDemand_Typ（NULL，NULL，NULL，PowerGrid_Typ（54,6,13,9,3），to_date（'02 -01-1998 03'，'MM-DD-YYYY HH'））） ; INSERT INTO PowerDemand_Tab VALUES（1，PowerDemand_Typ（NULL，NULL，NULL，PowerGrid_Typ（54,13,9,3），to_date（'02 -01-1998 04'，'MM-DD-YYYY HH'））） ; INSERT INTO PowerDemand_Tab VALUES（1，PowerDemand_Typ（NULL，NULL，NULL，PowerGrid_Typ（54,12,9,3），to_date（'02 -01-1998 05'，'MM-DD-YYYY HH'））） ; - 还为区域2插入一些行。INSERT INTO PowerDemand_Tab VALUES（2，PowerDemand_Typ（NULL，NULL，NULL，PowerGrid_Typ（9,8,11,16,5），to_date（'02 -01-1998 01'，'MM-DD-YYYY HH'））） ; INSERT INTO PowerDemand_Tab VALUES（2，PowerDemand_Typ（NULL，NULL，NULL，PowerGrid_Typ（9,8,11,20,5），to_date（'02 -01-1998 02'，'MM-DD-YYYY HH'））） ;</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-E784E9CF-E397-4190-8AA0-9BE1BAE5885C__CIAEFDEB">
                        <p class="titleinexample">例15-36计算电力需求盒的网格和单元需求</p><pre class="oac_no_warn" dir="ltr">DECLARE CURSOR c1 IS SELECT Sample，Region FROM PowerDemand_Tab FOR UPDATE; s PowerDemand_Typ; r NUMBER;开始打开c1; LOOP FETCH c1 INTO s，r;退出时c1％NOTFOUND;秒。SetTotalDemand;秒。SetMaxDemand;秒。SetMinDemand; DBMS_OUTPUT.PUT_LINE（S。TotGridDemand）; DBMS_OUTPUT.PUT_LINE（S。MaxCellDemand）; DBMS_OUTPUT.PUT_LINE（S。MinCellDemand）; UPDATE PowerDemand_Tab SET Sample = s当前是c1的当前值;结束循环;关闭c1;结束; /  - 检查值。SELECT区域，P.Sample。TotGridDemand，P.Sample。MaxCellDemand，P.Sample。MinCellDemand，to_char（P.sample.sampletime，'MM-DD-YYYY HH'）来自PowerDemand_Tab P;</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADDCI4872"></a><a id="ADDCI4871"></a><div class="props_rev_3"><a id="GUID-F34AB274-C2F2-4AF2-A435-E6C826426F41" name="GUID-F34AB274-C2F2-4AF2-A435-E6C826426F41"></a><h4 id="ADDCI-GUID-F34AB274-C2F2-4AF2-A435-E6C826426F41" class="sect4"><span class="enumeration_section">15.6.2</span>查询没有索引</h4>
                  <div>
                     <div class="section">
                        <p>这里使用的查询是通过为表中的每一行应用基础函数<code class="codeph">PowerEqualsSpecific_Func()</code>来执行的，因为尚未定义索引。
                        </p>
                        <p>示例文件包括针对特定单元号和任何单元号检查等于，大于和小于指定值的查询。例如，在<a href="example-for-power-demand-cartridge.html#GUID-F34AB274-C2F2-4AF2-A435-E6C826426F41__CIAEIGFE">例15-37</a>中演示了相等查询。
                        </p>
                        <p>执行计划显示在每种情况下都执行全表扫描：</p><pre class="oac_no_warn" dir="ltr">操作选项OBJECT_NAME --------------- --------------- --------------- SELECT SELECTEMENT表访问完全POWERDEMAND_TAB</pre></div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-F34AB274-C2F2-4AF2-A435-E6C826426F41__CIAEIGFE">
                        <p class="titleinexample">例15-37对电源需求盒进行等式查询</p><pre class="oac_no_warn" dir="ltr">SET SERVEROUTPUT ON ----------------------------------------------- --------------------  - 查询，引用运算符（无索引）------------------- ------------------------------------------------解释计划对于SELECT P.Region，P.Sample。TotGridDemand，P.Sample。MaxCellDemand，P.Sample。MinCellDemand FROM PowerDemand_Tab P WHERE Power_Equals（P.Sample，2,10）= 1; @tkoqxpll SELECT P.Region，P.Sample。TotGridDemand，P.Sample。MaxCellDemand，P.Sample。MinCellDemand FROM PowerDemand_Tab P WHERE Power_Equals（P.Sample，2,10）= 1;解释SELECT P.Region，P.Sample的计划。TotGridDemand，P.Sample。MaxCellDemand，P.Sample。MinCellDemand FROM PowerDemand_Tab P WHERE Power_Equals（P.Sample，1,25）= 1; @tkoqxpll SELECT P.Region，P.Sample。TotGridDemand，P.Sample。MaxCellDemand，P.Sample。MinCellDemand FROM PowerDemand_Tab P WHERE Power_Equals（P.Sample，1,25）= 1;解释SELECT P.Region，P.Sample的计划。TotGridDemand，P.Sample。MaxCellDemand，P.Sample。MinCellDemand FROM PowerDemand_Tab P WHERE Power_Equals（P.Sample，2,8）= 1; @tkoqxpll SELECT P.Region，P.Sample。TotGridDemand，P.Sample。MaxCellDemand，P.Sample。MinCellDemand FROM PowerDemand_Tab P WHERE Power_Equals（P.Sample，2,8）= 1;解释SELECT P.Region，P.Sample的计划。TotGridDemand，P.Sample。MaxCellDemand，P.Sample。MinCellDemand FROM PowerDemand_Tab P WHERE Power_EqualsAny（P.Sample，9）= 1; @tkoqxpll SELECT P.Region，P.Sample。TotGridDemand，P.Sample。MaxCellDemand，P.Sample。MinCellDemand FROM PowerDemand_Tab P WHERE Power_EqualsAny（P.Sample，9）= 1;</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADDCI4874"></a><a id="ADDCI4873"></a><div class="props_rev_3"><a id="GUID-F1752A63-2BF6-4F5E-8ED2-B5FF7F6D1052" name="GUID-F1752A63-2BF6-4F5E-8ED2-B5FF7F6D1052"></a><h4 id="ADDCI-GUID-F1752A63-2BF6-4F5E-8ED2-B5FF7F6D1052" class="sect4"><span class="enumeration_section">15.6.3</span>创建索引</h4>
                  <div>
                     <div class="section">
                        <p>索引在电源需求表的<code class="codeph">Sample</code>列上创建，如<a href="example-for-power-demand-cartridge.html#GUID-F1752A63-2BF6-4F5E-8ED2-B5FF7F6D1052__CIAGHACH">例15-38所示</a> 。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-F1752A63-2BF6-4F5E-8ED2-B5FF7F6D1052__CIAGHACH">
                        <p class="titleinexample">示例15-38在PowerDemand_Tab中为Power Demand Cartridge创建索引</p><pre class="oac_no_warn" dir="ltr">CREATE INDEX PowerIndex ON PowerDemand_Tab（示例）INDEXTYPE IS power_idxtype;</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADDCI4876"></a><a id="ADDCI4875"></a><div class="props_rev_3"><a id="GUID-FDE33DF6-0131-47E3-8C19-BDE7892DA267" name="GUID-FDE33DF6-0131-47E3-8C19-BDE7892DA267"></a><h4 id="ADDCI-GUID-FDE33DF6-0131-47E3-8C19-BDE7892DA267" class="sect4"><span class="enumeration_section">15.6.4</span>查询索引</h4>
                  <div>
                     <div class="section">
                        <p>此处使用的查询与<span class="q">“ <a href="example-for-power-demand-cartridge.html#GUID-F34AB274-C2F2-4AF2-A435-E6C826426F41">查询无索引</a> ”中的<a href="example-for-power-demand-cartridge.html#GUID-F34AB274-C2F2-4AF2-A435-E6C826426F41">查询</a></span>相同，但这次使用索引。
                        </p>
                        <p>执行计划显示Oracle正在使用域索引而不执行全表扫描，从而导致更高效的执行，如<a href="example-for-power-demand-cartridge.html#GUID-FDE33DF6-0131-47E3-8C19-BDE7892DA267__CIAIIFAC">例15-39所示</a> 。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-FDE33DF6-0131-47E3-8C19-BDE7892DA267__CIAIIFAC">
                        <p class="titleinexample">例15-39使用电力需求盒索引进行平等查询</p><pre class="oac_no_warn" dir="ltr">SQLPLUS&gt; ------------------------------------------------ ------------------- SQLPLUS&gt;  - 查询，引用运算符（带索引）SQLPLUS&gt; ---------------- -------------------------------------------------- -  SQLPLUS&gt;解释计划2&gt; SELECT P.Region，P.Sample。TotGridDemand，P.Sample。MaxCellDemand，3&gt; P.Sample。MinCellDemand 4&gt; FROM PowerDemand_Tab P 5&gt; WHERE Power_Equals（P.Sample，2,10）= 1;声明已处理。SQLPLUS&gt; @tkoqxpll SQLPLUS&gt; set echo off Echo OFF Charwidth 15操作选项OBJECT_NAME --------------- --------------- ---- ----------- SELECT STATEMEN TABLE ACCESS by ROWID POWERDEMAND_TAB DOMAIN INDEX POWERINDEX 3行被选中。声明已处理。Echo ON SQLPLUS&gt; SQLPLUS&gt; SELECT P.Region，P.Sample。TotGridDemand，P.Sample。MaxCellDemand，2&gt; P.Sample。MinCellDemand 3&gt; FROM PowerDemand_Tab P 4&gt; WHERE Power_Equals（P.Sample，2,10）= 1; REGION SAMPLE.TOT SAMPLE.MAX SAMPLE.MIN ---------- ---------- ---------- ----------选择了0行。ODCIIndexStart &gt;&gt;&gt;&gt;&gt; ODCIIndexInfo索引所有者：POWERCARTUSER索引名称：POWERINDEX表所有者：POWERCARTUSER表名：POWERDEMAND_TAB索引列：“SAMPLE”索引列类型：POWERDEMAND_TYP索引列类型架构：POWERCARTUSER ODCIPredInfo对象所有者：POWERCARTUSER对象名称：POWER_EQUALS方法name：谓词匹配标志：完全匹配包含开始键包含停止键开始键：1停止键：1比较位置：2比较值：10 ODCIIndexStart &gt;&gt;&gt;&gt;&gt;从POWERCARTUSER.POWERINDEX_pidx中选择r，其中cpos ='2'和cval ='10'ODCIIndexFetch &gt;&gt;&gt;&gt;&gt; Nrows：2000 ODCIIndexClose &gt;&gt;&gt;&gt;&gt; SQLPLUS&gt; SQLPLUS&gt;解释计划2&gt; SELECT P.Region，P.Sample。TotGridDemand，P.Sample。MaxCellDemand，3&gt; P.Sample。MinCellDemand 4&gt; FROM PowerDemand_Tab P 5&gt; WHERE Power_Equals（P.Sample，2,8）= 1;声明已处理。SQLPLUS&gt; @tkoqxpll SQLPLUS&gt; set echo off Echo OFF Charwidth 15操作选项OBJECT_NAME --------------- --------------- ---- ----------- SELECT STATEMEN TABLE ACCESS by ROWID POWERDEMAND_TAB DOMAIN INDEX POWERINDEX 3行被选中。声明已处理。Echo ON SQLPLUS&gt; SQLPLUS&gt; SELECT P.Region，P.Sample。TotGridDemand，P.Sample。MaxCellDemand，2&gt; P.Sample。MinCellDemand 3&gt; FROM PowerDemand_Tab P 4&gt; WHERE Power_Equals（P.Sample，2,8）= 1; REGION SAMPLE.TOT SAMPLE.MAX SAMPLE.MIN ---------- ---------- ---------- ----------选择1 90 55 5 1 89 56 3 1 88 55 3 1 87 54 3 1 86 54 3 2 49 16 5 2 53 20 5 7行。ODCIIndexStart &gt;&gt;&gt;&gt;&gt; ODCIIndexInfo索引所有者：POWERCARTUSER索引名称：POWERINDEX表所有者：POWERCARTUSER表名：POWERDEMAND_TAB索引列：“SAMPLE”索引列类型：POWERDEMAND_TYP索引列类型架构：POWERCARTUSER ODCIPredInfo对象所有者：POWERCARTUSER对象名称：POWER_EQUALS方法name：Predicate bounds标志：Exact Match Include Start Key Include Stop键开始键：1停止键：1比较位置：2比较值：8 ODCIIndexStart &gt;&gt;&gt;&gt;&gt;从POWERCARTUSER.POWERINDEX_pidx中选择r，其中cpos ='2'和cval ='8'ODCIIndexFetch &gt;&gt;&gt;&gt;&gt; Nrows：2000 ODCIIndexClose &gt;&gt;&gt;&gt;&gt; SQLPLUS&gt; SQLPLUS&gt;解释计划2&gt; SELECT P.Region，P.Sample。TotGridDemand，P.Sample。MaxCellDemand，3&gt; P.Sample。MinCellDemand 4&gt; FROM PowerDemand_Tab P 5&gt; WHERE Power_EqualsAny（P.Sample，9）= 1;声明已处理。SQLPLUS&gt; @tkoqxpll SQLPLUS&gt; set echo off Echo OFF Charwidth 15操作选项OBJECT_NAME --------------- --------------- ---- ----------- SELECT STATEMEN TABLE ACCESS by ROWID POWERDEMAND_TAB DOMAIN INDEX POWERINDEX 3行被选中。声明已处理。Echo ON SQLPLUS&gt; SQLPLUS&gt; SELECT P.Region，P.Sample。TotGridDemand，P.Sample。MaxCellDemand，2&gt; P.Sample。MinCellDemand 3&gt; FROM PowerDemand_Tab P 4&gt; WHERE Power_EqualsAny（P.Sample，9）= 1; REGION SAMPLE.TOT SAMPLE.MAX SAMPLE.MIN ---------- ---------- ---------- ----------选择1 90 55 5 1 89 56 3 1 88 55 3 1 87 54 3 1 86 54 3 2 49 16 5 2 53 20 5 7行。ODCIIndexStart &gt;&gt;&gt;&gt;&gt; ODCIIndexInfo索引所有者：POWERCARTUSER索引名称：POWERINDEX表所有者：POWERCARTUSER表名：POWERDEMAND_TAB索引列：“SAMPLE”索引列类型：POWERDEMAND_TYP索引列类型架构：POWERCARTUSER ODCIPredInfo对象所有者：POWERCARTUSER对象名称：POWER_EQUALSANY方法name：谓词绑定标志：完全匹配包含开始键包含停止键开始键：1停止键：1比较值：9 ODCIIndexStart &gt;&gt;&gt;&gt;&gt;从POWERCARTUSER.POWERINDEX_pidx中选择不同的r，其中cval ='9'ODCIIndexFetch &gt;&gt;&gt;&gt; &gt; Nrows：2000 ODCIIndexClose &gt;&gt;&gt;&gt;&gt; SQLPLUS&gt; SQLPLUS&gt;解释计划2&gt; SELECT P.Region，P.Sample。TotGridDemand，P.Sample。MaxCellDemand，3&gt; P.Sample。MinCellDemand 4&gt; FROM PowerDemand_Tab P 5&gt; WHERE Power_GreaterThanAny（P.Sample，50）= 1;声明已处理。SQLPLUS&gt; @tkoqxpll SQLPLUS&gt; set echo off Echo OFF Charwidth 15操作选项OBJECT_NAME --------------- --------------- ---- ----------- SELECT STATEMEN TABLE ACCESS by ROWID POWERDEMAND_TAB DOMAIN INDEX POWERINDEX 3行被选中。声明已处理。Echo ON SQLPLUS&gt; SQLPLUS&gt; SELECT P.Region，P.Sample。TotGridDemand，P.Sample。MaxCellDemand，2&gt; P.Sample。MinCellDemand 3&gt; FROM PowerDemand_Tab P 4&gt; WHERE Power_GreaterThanAny（P.Sample，50）= 1; REGION SAMPLE.TOT SAMPLE.MAX SAMPLE.MIN ---------- ---------- ---------- ----------选择1 90 55 5 1 89 56 3 1 88 55 3 1 87 54 3 1 86 54 3 5行。ODCIIndexStart &gt;&gt;&gt;&gt;&gt; ODCIIndexInfo索引所有者：POWERCARTUSER索引名称：POWERINDEX表所有者：POWERCARTUSER表名：POWERDEMAND_TAB索引列：“SAMPLE”索引列类型：POWERDEMAND_TYP索引列类型架构：POWERCARTUSER ODCIPredInfo对象所有者：POWERCARTUSER对象名称：POWER_GREATERTHANANY方法name：谓词匹配标志：完全匹配包括开始键包含停止键开始键：1停止键：1比较值：50 ODCIIndexStart &gt;&gt;&gt;&gt;&gt;从POWERCARTUSER.POWERINDEX_pidx中选择不同的r，其中cv al&gt; '50'ODCIIndexFetch &gt;&gt;&gt; &gt;&gt; Nrows：2000 ODCIIndexClose &gt;&gt;&gt;&gt;&gt; SQLPLUS&gt; SQLPLUS&gt;解释计划2&gt; SELECT P.Region，P.Sample。TotGridDemand，P.Sample。MaxCellDemand，3&gt; P.Sample。MinCellDemand 4&gt; FROM PowerDemand_Tab P 5&gt; WHERE Power_LessThanAny（P.Sample，50）= 0;声明已处理。SQLPLUS&gt; @tkoqxpll SQLPLUS&gt; set echo off Echo OFF Charwidth 15操作选项OBJECT_NAME --------------- --------------- ---- ----------- SELECT STATEMEN TABLE ACCESS by ROWID POWERDEMAND_TAB DOMAIN INDEX POWERINDEX 3行被选中。声明已处理。Echo ON SQLPLUS&gt; SQLPLUS&gt; SELECT P.Region，P.Sample。TotGridDemand，P.Sample。MaxCellDemand，2&gt; P.Sample。MinCellDemand 3&gt; FROM PowerDemand_Tab P 4&gt; WHERE Power_LessThanAny（P.Sample，50）= 0; REGION SAMPLE.TOT SAMPLE.MAX SAMPLE.MIN ---------- ---------- ---------- ----------选择了0行。ODCIIndexStart &gt;&gt;&gt;&gt;&gt; ODCIIndexInfo索引所有者：POWERCARTUSER索引名称：POWERINDEX表所有者：POWERCARTUSER表名：POWERDEMAND_TAB索引列：“SAMPLE”索引列类型：POWERDEMAND_TYP索引列类型架构：POWERCARTUSER ODCIPredInfo对象所有者：POWERCARTUSER对象名称：POWER_LESSTHANANY方法name：谓词匹配标志：完全匹配包含开始键包括停止键开始键：0停止键：0比较值：50 ODCIIndexStart &gt;&gt;&gt;&gt;&gt;从POWERCARTUSER.POWERINDEX_pidx中选择不同的r减去从POWERCARTUSER.POWERINDEX_pidx中选择不同的r其中cval &lt;'50'ODCIIndexFetch &gt;&gt;&gt;&gt;&gt; Nrows：2000 ODCIIndexClose &gt;&gt;&gt;&gt;&gt;</pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>