<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>Oracle Clusterware Agent Framework C应用程序接口</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Clusterware Administration and Deployment Guide"></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Clusterware Administration and Deployment Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="clusterware-administration-and-deployment-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-04-24T07:05:38-07:00"></meta>
      <meta name="dcterms.title" content="Clusterware Administration and Deployment Guide"></meta>
      <meta name="dcterms.dateCopyrighted" content="2007, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E95727-05"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="server-control-command-reference.html" title="Previous" type="text/html"></link>
      <link rel="next" href="oracle-clusterware-c-application-program-interfaces.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="CWADD"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="server-control-command-reference.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="oracle-clusterware-c-application-program-interfaces.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">“Clusterware管理和部署指南”</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Oracle Clusterware Agent Framework C应用程序接口</li>
            </ol>
            <a id="GUID-1B0838C1-2211-4EF6-8108-0BFC06F51082" name="GUID-1B0838C1-2211-4EF6-8108-0BFC06F51082"></a><a id="CWADD92426"></a>
            
            <h2 id="CWADD-GUID-1B0838C1-2211-4EF6-8108-0BFC06F51082" class="sect2"><span class="enumeration_appendix">H</span> Oracle Clusterware Agent Framework C应用程序接口</h2>
         </header>
         <div class="ind">
            <div>
               <p>Oracle Clusterware管理使用Oracle Clusterware注册为资源的应用程序，并且必须能够访问能够启动，停止和监视特定资源的特定于应用程序的基元。Oracle Clusterware通过称为<span class="italic">代理</span>的实体运行所有特定于资源的命令。
               </p>
               <p>代理程序是包含用于管理资源的代理程序框架和用户代码的程序。代理框架是一个C库，使您可以插入特定于应用程序的代码来管理自定义应用程序。您可以将C或C ++中的所有实际应用程序管理功能（例如，启动，停止和检查应用程序的运行状况）编程到代理程序中。这些功能称为<span class="italic">入口点</span> 。代理框架负责代表Oracle Clusterware调用这些入口点函数。代理开发人员可以使用这些入口点来插入有关如何启动，停止和监视资源的特定资源所需的功能。代理能够管理多个资源。
               </p>
               <p>本附录包括以下主题：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-9B95F8E6-76AD-444A-BEA2-956038E35080">代理框架数据类型</a></p>
                  </li>
                  <li>
                     <p><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-A142ECEA-AC0C-4937-90A4-071A98A49B04">代理框架上下文初始化和持久性</a></p>
                  </li>
                  <li>
                     <p><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-527AB33A-F618-4BF4-BCA3-42D8AA3DDBD0">C和C ++入口点函数的原型</a></p>
                  </li>
                  <li>
                     <p><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-F6CDAA84-1AE4-4F31-BAA5-7D7EEC03985E">C和C ++入口点类型和代码</a></p>
                  </li>
                  <li>
                     <p><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-6246C353-CC04-49A7-9AF7-54EEF0F60795">C和C ++入口点函数返回值</a></p>
                  </li>
                  <li>
                     <p><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-DF728937-D87A-43EE-8DE8-1B72219ED8FB">多线程注意事项</a></p>
                  </li>
                  <li>
                     <p><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-AE0637F9-774B-4408-A948-09BE47A12EAB">弃用的API</a></p>
                  </li>
                  <li>
                     <p><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-D18CD5D3-F691-48AD-B2FC-7970DA919E1B" title="注册代理管理的资源类型。启动对特定资源的检查操作。创建迭代器以访问当前资源的所有属性。删除存储在代理框架中的cookie。使用资源重试反馈终止代理进程。从创建的迭代器返回下一个属性名称和值。获取当前资源的属性值。返回当前正在执行的检查命令的类型。返回调用入口点的命令的类型。检索存储在代理框架中的cookie的值。返回要在资源上执行的自定义操作的名称。检索正在执行入口点的资源的ID。检索当前命令的资源名称。返回当前命令的重试尝试次数。检索正在为其执行入口点的资源的类型名称。初始化代理框架。返回ABORT入口点的原因。将诊断消息打印到代理日志文件。修改当前资源的属性。重置属性迭代器。向Oracle Clusterware服务器和用户报告进度，警告和错误消息。在代理框架中存储cookie及其值。设置要对资源上的特定操作执行的C / C ++入口点函数。注册代理进程退出时要调用的函数。在当前资源上设置自定义标签。启动代理框架。">API参考</a></p>
                  </li>
                  <li>
                     <p><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-DD78FC7D-82CB-4783-8DAF-1DC1FD7EFAE9">代理示例</a></p>
                  </li>
               </ul>
            </div><a id="CWADD92428"></a><a id="CWADD92427"></a><div class="sect2"><a id="GUID-9B95F8E6-76AD-444A-BEA2-956038E35080" name="GUID-9B95F8E6-76AD-444A-BEA2-956038E35080"></a><h3 id="CWADD-GUID-9B95F8E6-76AD-444A-BEA2-956038E35080" class="sect3">代理框架数据类型</h3>
               <div>
                  <p>Oracle Clusterware代理框架使用Oracle定义的可移植数据类型来表示字符串和数字。通过使用这些数据类型，您可以在多个平台上构建和执行代理程序。<a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-9B95F8E6-76AD-444A-BEA2-956038E35080__CACEJGGA" title="此表列出并描述了代理框架中使用的Oracle数据类型。">表H-1</a>列出并描述了代理框架中使用的Oracle数据类型。
                  </p>
                  <div class="tblformal" id="GUID-9B95F8E6-76AD-444A-BEA2-956038E35080__CACEJGGA">
                     <p class="titleintable">表H-1代理框架中使用的Oracle数据类型</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="代理框架中使用的Oracle数据类型" width="100%" border="1" summary="This table lists and describes Oracle data types used in the agent framework." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="31%" id="d183093e309">Oracle数据类型</th>
                              <th align="left" valign="bottom" width="69%" id="d183093e312">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d183093e317" headers="d183093e309 ">
                                 <p>UB4</p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d183093e317 d183093e312 ">
                                 <p>无符号32位整数</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d183093e324" headers="d183093e309 ">
                                 <p>SB4</p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d183093e324 d183093e312 ">
                                 <p>有符号的32位整数</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d183093e331" headers="d183093e309 ">
                                 <p>oratext *</p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d183093e331 d183093e312 ">
                                 <p>C样式以null结尾的字符串，显式转换为<span class="bold">char *</span> required</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <p>代理框架API返回<code class="codeph">clsagfwret</code>类型的状态值，如下所示：</p>
                  <ul class="simple" style="list-style-type:none;padding-left:0">
                     <li><code class="codeph">CLSAGFW_SUCCESS</code> ：函数执行成功</li>
                     <li><code class="codeph">CLSAGFW_FAIL</code> ：参数或执行函数时出错</li>
                     <li></li>
                  </ul>
                  <p>API返回的字符串值只能在当前命令入口点的范围内访问。代理可以将返回的字符串值复制到其自己的缓冲区以保留该值。</p>
               </div>
            </div><a id="CWADD92429"></a><div class="sect2"><a id="GUID-A142ECEA-AC0C-4937-90A4-071A98A49B04" name="GUID-A142ECEA-AC0C-4937-90A4-071A98A49B04"></a><h3 id="CWADD-GUID-A142ECEA-AC0C-4937-90A4-071A98A49B04" class="sect3">代理框架上下文初始化和持久性</h3>
               <div>
                  <p>代理框架由<code class="codeph">clsagfw_init()</code>函数调用初始化。没有您需要维护的上下文。操作入口点函数传递指向代理框架上下文的指针（类型为<code class="codeph">clsagfw_aectx</code> ）。此上下文特定于被调用的入口点，不能在入口点的范围之外使用。其他代理框架API将此上下文指针作为参数。这是代理框架维护但不显式初始化或销毁的不透明数据结构。
                  </p>
               </div>
            </div><a id="CWADD92430"></a><div class="sect2"><a id="GUID-527AB33A-F618-4BF4-BCA3-42D8AA3DDBD0" name="GUID-527AB33A-F618-4BF4-BCA3-42D8AA3DDBD0"></a><h3 id="CWADD-GUID-527AB33A-F618-4BF4-BCA3-42D8AA3DDBD0" class="sect3">C和C ++入口点函数的原型</h3>
               <div>
                  <p>代理程序实现资源管理命令的入口点函数，并使用代理程序框架注册这些函数。代理框架调用入口点函数以对资源执行命令或操作。入口点函数需要符合以下原型和约定：</p><pre class="oac_no_warn" dir="ltr">typedef ub4（* clsagfw_action_entry）（const clsagfw_aectx * aectx）</pre><p>使用指向代理框架维护的上下文区域的指针调用入口点函数。此函数应返回一个值，指示入口点的执行状态。对于CHECK入口点，该函数返回资源的当前状态。</p>
                  <p>如果使用C ++开发代理，则使用<span class="bold"><code class="codeph">extern 'C'</code></span>关键字声明入口点函数原型。
                  </p>
               </div>
            </div><a id="CWADD92432"></a><a id="CWADD92431"></a><div class="sect2"><a id="GUID-F6CDAA84-1AE4-4F31-BAA5-7D7EEC03985E" name="GUID-F6CDAA84-1AE4-4F31-BAA5-7D7EEC03985E"></a><h3 id="CWADD-GUID-F6CDAA84-1AE4-4F31-BAA5-7D7EEC03985E" class="sect3">C和C ++入口点类型和代码</h3>
               <div>
                  <p>代理框架当前定义了与资源管理命令和对资源执行的操作相对应的七种入口点类型。代理必须注册START，STOP，CHECK和CLEAN命令的入口点。其他命令入口点是可选的。代理通过为每种资源类型和命令调用<code class="codeph">clsagfw_set_entrypoint()</code> API来注册入口点。<a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-F6CDAA84-1AE4-4F31-BAA5-7D7EEC03985E__CACGAJFF" title="此表列出并描述了入口点类型。">表H-2</a>列出并描述了入口点类型及其等效类型代码。
                  </p>
                  <div class="tblformal" id="GUID-F6CDAA84-1AE4-4F31-BAA5-7D7EEC03985E__CACGAJFF">
                     <p class="titleintable">表H-2入口点类型</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="入口点类型" width="100%" border="1" summary="This table lists and describes entry point types." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="16%" id="d183093e748">名称</th>
                              <th align="left" valign="bottom" width="49%" id="d183093e751">描述</th>
                              <th align="left" valign="bottom" width="36%" id="d183093e754">类型代码</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="16%" id="d183093e759" headers="d183093e748 ">
                                 <p>开始</p>
                              </td>
                              <td align="left" valign="top" width="49%" headers="d183093e759 d183093e751 ">
                                 <p>启动资源并将其联机</p>
                              </td>
                              <td align="left" valign="top" width="36%" headers="d183093e759 d183093e754 ">
                                 <p>CLSAGFW_ACTION_START</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="16%" id="d183093e769" headers="d183093e748 ">
                                 <p>停</p>
                              </td>
                              <td align="left" valign="top" width="49%" headers="d183093e769 d183093e751 ">
                                 <p>停止资源并使其脱机</p>
                              </td>
                              <td align="left" valign="top" width="36%" headers="d183093e769 d183093e754 ">
                                 <p>CLSAGFW_ACTION_STOP</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="16%" id="d183093e779" headers="d183093e748 ">
                                 <p>清洁</p>
                              </td>
                              <td align="left" valign="top" width="49%" headers="d183093e779 d183093e751 ">
                                 <p>在资源上发生命令失败后清理</p>
                              </td>
                              <td align="left" valign="top" width="36%" headers="d183093e779 d183093e754 ">
                                 <p>CLSAGFW_ACTION_CLEAN</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="16%" id="d183093e789" headers="d183093e748 ">
                                 <p>校验</p>
                              </td>
                              <td align="left" valign="top" width="49%" headers="d183093e789 d183093e751 ">
                                 <p>检查资源的状态</p>
                              </td>
                              <td align="left" valign="top" width="36%" headers="d183093e789 d183093e754 ">
                                 <p>CLSAGFW_ACTION_CHECK</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="16%" id="d183093e799" headers="d183093e748 ">
                                 <p>中止</p>
                              </td>
                              <td align="left" valign="top" width="49%" headers="d183093e799 d183093e751 ">
                                 <p>结束已超时的执行命令</p>
                              </td>
                              <td align="left" valign="top" width="36%" headers="d183093e799 d183093e754 ">
                                 <p>CLSAGFW_ACTION_ABORT</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="16%" id="d183093e809" headers="d183093e748 ">
                                 <p>删除</p>
                              </td>
                              <td align="left" valign="top" width="49%" headers="d183093e809 d183093e751 ">
                                 <p>资源即将被删除</p>
                              </td>
                              <td align="left" valign="top" width="36%" headers="d183093e809 d183093e754 ">
                                 <p>CLSAGFW_ACTION_RES_DELETED</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="16%" id="d183093e819" headers="d183093e748 ">
                                 <p>修改</p>
                              </td>
                              <td align="left" valign="top" width="49%" headers="d183093e819 d183093e751 ">
                                 <p>资源被修改</p>
                              </td>
                              <td align="left" valign="top" width="36%" headers="d183093e819 d183093e754 ">
                                 <p>CLSAGFW_RESATTR_MODIFIED</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="16%" id="d183093e829" headers="d183093e748 ">
                                 <p>行动</p>
                              </td>
                              <td align="left" valign="top" width="49%" headers="d183093e829 d183093e751 ">
                                 <p>在资源上调用自定义操作</p>
                              </td>
                              <td align="left" valign="top" width="36%" headers="d183093e829 d183093e754 ">
                                 <p>CLSAGFW_RES_ACTION</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="infoboxnotealso" id="GUID-F6CDAA84-1AE4-4F31-BAA5-7D7EEC03985E__GUID-AB2DC922-B92B-4370-B943-F6C0D80C770B">
                     <p class="notep1">也可以看看：</p>
                     <p>有关入口点的更多信息，请参阅<span class="q">“ <a href="making-applications-highly-available-using-oracle-clusterware.html#GUID-342D37E6-E73E-4A80-BEAC-699EC25E46C5" title="Oracle Clusterware将应用程序和进程作为您向Oracle Clusterware注册的资源进行管理。虚拟机是为正在运行的操作系统创建的环境，称为客户操作系统。虚拟机显示为计算机桌面上的一个窗口，可以全屏模式显示，也可以在另一台计算机上远程显示。资源组是逻辑上相关的资源组的容器。在Oracle Clusterware中，资源类型是一类资源的模板。使用CRSCTL创建资源组，资源组类型以及向资源组添加资源。Oracle Clusterware通过称为代理的实体运行所有特定于资源的命令。操作脚本定义一个或多个操作以启动，停止，检查或清除资源。使用crsctl add resource命令在Oracle Clusterware 12c中注册资源。">Oracle Clusterware资源和代理</a> ”</span></p>
                  </div>
               </div>
            </div><a id="CWADD92433"></a><div class="sect2"><a id="GUID-6246C353-CC04-49A7-9AF7-54EEF0F60795" name="GUID-6246C353-CC04-49A7-9AF7-54EEF0F60795"></a><h3 id="CWADD-GUID-6246C353-CC04-49A7-9AF7-54EEF0F60795" class="sect3">C和C ++入口点函数返回值</h3>
               <div>
                  <p>除CHECK入口点之外的所有入口点函数都返回以下值之一以指示入口点的执行状态：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><span class="bold">CLSAGFW_AE_SUCCESS</span> ：入口点执行成功完成</p>
                     </li>
                     <li>
                        <p><span class="bold">CLSAGFW_AE_FAIL</span> ：入口点执行失败</p>
                     </li>
                  </ul>
                  <p>代理框架调用CHECK入口点函数来监视资源的状态。此函数返回以下值之一，表示资源的当前状态：</p>
                  <ul class="simple" style="list-style-type:none;padding-left:0">
                     <li>CLSAGFW_ONLINE</li>
                     <li>CLSAGFW_UNPLANNED_OFFLINE</li>
                     <li>CLSAGFW_PLANNED_OFFLINE</li>
                     <li>CLSAGFW_UNKNOWN</li>
                     <li>CLSAGFW_PARTIAL</li>
                     <li>CLSAGFW_FAILED</li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-6246C353-CC04-49A7-9AF7-54EEF0F60795__GUID-C0996094-F7DE-47C9-9950-20A68F15F28F">
                     <p class="notep1">也可以看看：</p>
                     <p><span class="q">“ <a href="making-applications-highly-available-using-oracle-clusterware.html#GUID-CD3442A5-D6A8-4370-ABDA-CB686A736D3C" title="Oracle Clusterware通过称为代理的实体运行所有特定于资源的命令。">Oracle Clusterware中的代理</a> ”</span> ，以获取有关评估和返回资源状态的更多信息</p>
                  </div>
               </div>
            </div><a id="CWADD92434"></a><div class="sect2"><a id="GUID-DF728937-D87A-43EE-8DE8-1B72219ED8FB" name="GUID-DF728937-D87A-43EE-8DE8-1B72219ED8FB"></a><h3 id="CWADD-GUID-DF728937-D87A-43EE-8DE8-1B72219ED8FB" class="sect3">多线程注意事项</h3>
               <div>
                  <p>Oracle Clusterware代理框架在设计上是多线程的。代理程序代码还可以启动新线程以执行特定于应用程序的功能，例如监视外部事件源。代理框架一次只执行一个资源的一个入口点，唯一的例外是ABORT入口点，该入口点被调用以结束对资源的当前活动操作。C和C ++开发人员必须确保所有代理程序代码都是多线程安全的。必须使用锁定机制（例如互斥锁）序列化对全局变量和其他资源的访问。代理程序包含的其他外部C或C ++库也应该是多线程安全的。</p>
               </div>
            </div><a id="CWADD92941"></a><a id="CWADD92940"></a><div class="sect2"><a id="GUID-AE0637F9-774B-4408-A948-09BE47A12EAB" name="GUID-AE0637F9-774B-4408-A948-09BE47A12EAB"></a><h3 id="CWADD-GUID-AE0637F9-774B-4408-A948-09BE47A12EAB" class="sect3">弃用的API</h3>
               <div>
                  <p><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-AE0637F9-774B-4408-A948-09BE47A12EAB__BABEACFC" title="此表列出了已弃用的代理框架API命令及其替代项。">表H-3</a>列出了已弃用的代理框架API以及Oracle Clusterware的相应替换API。
                  </p>
                  <div class="tblformalwide" id="GUID-AE0637F9-774B-4408-A948-09BE47A12EAB__BABEACFC">
                     <p class="titleintable">表H-3不推荐使用的代理框架API</p>
                     <table cellpadding="4" cellspacing="0" class="FormalWide" title="不推荐使用的代理框架API" width="100%" border="1" summary="This table lists deprecated agent framework API commands and their replacements." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="45%" id="d183093e1266">弃用的API</th>
                              <th align="left" valign="bottom" width="55%" id="d183093e1269">替换</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="45%" id="d183093e1274" headers="d183093e1266 "><pre class="oac_no_warn" dir="ltr">clsagfw_exit（）</pre></td>
                              <td align="left" valign="top" width="55%" headers="d183093e1274 d183093e1269 "><pre class="oac_no_warn" dir="ltr">clsagfw_exit2（）</pre></td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="45%" id="d183093e1281" headers="d183093e1266 "><pre class="oac_no_warn" dir="ltr">clsagfw_send_status（）</pre></td>
                              <td align="left" valign="top" width="55%" headers="d183093e1281 d183093e1269 "><pre class="oac_no_warn" dir="ltr">clsagfw_send_status2（）</pre></td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
               </div>
            </div><a id="CWADD92435"></a><div class="sect2"><a id="GUID-D18CD5D3-F691-48AD-B2FC-7970DA919E1B" name="GUID-D18CD5D3-F691-48AD-B2FC-7970DA919E1B"></a><h3 id="CWADD-GUID-D18CD5D3-F691-48AD-B2FC-7970DA919E1B" class="sect3">API参考</h3>
               <div>
                  <p>本节列出并描述了以下功能：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-62EC5F68-5A8B-41B9-A4BB-7825031F2822" title="注册代理管理的资源类型。">clsagfw_add_type（）</a></code></p>
                     </li>
                     <li>
                        <p><code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-AE09D76E-63EC-4270-83FC-0504D38276BD" title="启动对特定资源的检查操作。">clsagfw_check_resource（）</a></code></p>
                     </li>
                     <li>
                        <p><code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-74BF1AD0-D54A-4592-A08C-7072DE37DFD0" title="创建迭代器以访问当前资源的所有属性。">clsagfw_create_attr_iterator（）</a></code></p>
                     </li>
                     <li>
                        <p><code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-3224508B-72A9-4E7B-8A47-5B803FD915DC" title="删除存储在代理框架中的cookie。">clsagfw_delete_cookie（）</a></code></p>
                     </li>
                     <li>
                        <p><code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-452087CF-77B9-4381-94A6-3E89E978A58C" title="使用资源重试反馈终止代理进程。">clsagfw_exit2（）</a></code></p>
                     </li>
                     <li>
                        <p><code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-6616A067-3258-4D1E-B6EE-1098ABF2D67B" title="从创建的迭代器返回下一个属性名称和值。">clsagfw_get_attr_from_iterator（）</a></code></p>
                     </li>
                     <li>
                        <p><code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-9B4900CC-0BE6-46AB-A8B8-D91D6C598B86" title="获取当前资源的属性值。">clsagfw_get_attrvalue（）</a></code></p>
                     </li>
                     <li>
                        <p><code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-7D7A085C-51D6-446F-9687-B04A20AA139A" title="返回当前正在执行的检查命令的类型。">clsagfw_get_check_type（）</a></code></p>
                     </li>
                     <li>
                        <p><code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-5F052C35-F002-44BC-981A-90EB38E2CFF3" title="返回调用入口点的命令的类型。">clsagfw_get_cmdid（）</a></code></p>
                     </li>
                     <li>
                        <p><code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-24F42F78-86EB-4157-89E5-31C98F37946B" title="检索存储在代理框架中的cookie的值。">clsagfw_get_cookie（）</a></code></p>
                     </li>
                     <li>
                        <p><code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-DC809473-DDBA-4D62-B860-DAF768A4B06A" title="返回要在资源上执行的自定义操作的名称。">clsagfw_get_request_action_name（）</a></code></p>
                     </li>
                     <li>
                        <p><code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-4D6EA7DF-B212-45B3-91ED-9AA1AE6200E6" title="检索正在执行入口点的资源的ID。">clsagfw_get_resource_id（）</a></code></p>
                     </li>
                     <li>
                        <p><code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-BAB747A7-4AC4-4EB4-AAC2-419C09ACE1E9" title="检索当前命令的资源名称。">clsagfw_get_resource_name（）</a></code></p>
                     </li>
                     <li>
                        <p><code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-2B1F79C0-6C9E-4BD8-9709-C0092E699D06" title="返回当前命令的重试尝试次数。">clsagfw_get_retry_count（）</a></code></p>
                     </li>
                     <li>
                        <p><code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-22B8F816-B746-4C5A-8EE6-B2312F401B37" title="检索正在为其执行入口点的资源的类型名称。">clsagfw_get_type_name（）</a></code></p>
                     </li>
                     <li>
                        <p><code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-87A74224-9BCA-41F8-90AB-6B17D93C6A21" title="初始化代理框架。">clsagfw_init（）</a></code></p>
                     </li>
                     <li>
                        <p><code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-B0D795A7-493E-42F8-8416-0EE6A19244B7" title="返回ABORT入口点的原因。">clsagfw_is_cmd_timedout（）</a></code></p>
                     </li>
                     <li>
                        <p><code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-9B6E15B5-D6CC-4125-9F61-64DF59410DA4" title="将诊断消息打印到代理日志文件。">clsagfw_log（）</a></code></p>
                     </li>
                     <li>
                        <p><code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-53EAECD0-2E3A-4551-A21F-69BFEA734D8B" title="修改当前资源的属性。">clsagfw_modify_attribute（）</a></code></p>
                     </li>
                     <li>
                        <p><code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-507370BC-58AC-4FD2-BAE0-1AE092B1B14B" title="重置属性迭代器。">clsagfw_reset_attr_iterator（）</a></code></p>
                     </li>
                     <li>
                        <p><code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-BCB22E7E-D21C-445E-A253-3B099331304B" title="向Oracle Clusterware服务器和用户报告进度，警告和错误消息。">clsagfw_send_status2（）</a></code></p>
                     </li>
                     <li>
                        <p><code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-EAA6711F-A7E8-453D-B3DE-3711461CC31C" title="在代理框架中存储cookie及其值。">clsagfw_set_cookie（）</a></code></p>
                     </li>
                     <li>
                        <p><code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-12FC4CAD-F6AF-4030-8C3C-CFC92C9A9842" title="设置要对资源上的特定操作执行的C / C ++入口点函数。">clsagfw_set_entrypoint（）</a></code></p>
                     </li>
                     <li>
                        <p><code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-4FE4ECFB-2712-4D6A-933A-CE0737F4559C" title="注册代理进程退出时要调用的函数。">clsagfw_set_exitcb（）</a></code></p>
                     </li>
                     <li>
                        <p><code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-B6065249-F1B5-4D12-B26B-EDA24CFCB841" title="在当前资源上设置自定义标签。">clsagfw_set_resource_state_label（）</a></code></p>
                     </li>
                     <li>
                        <p><code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-800B6FFF-3807-47E2-8239-92C293D1E385" title="启动代理框架。">clsagfw_startup（）</a></code></p>
                     </li>
                  </ul>
               </div>
               <div class="sect3"><a id="GUID-62EC5F68-5A8B-41B9-A4BB-7825031F2822" name="GUID-62EC5F68-5A8B-41B9-A4BB-7825031F2822"></a><h4 id="CWADD-GUID-62EC5F68-5A8B-41B9-A4BB-7825031F2822" class="sect4">clsagfw_add_type（）</h4>
                  <div>
                     <p>注册代理管理的资源类型。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-62EC5F68-5A8B-41B9-A4BB-7825031F2822__GUID-CA3DDE40-D277-442D-A24A-573295DCADC9">句法</p><pre class="pre codeblock"><code>clsagfwret clsagfw_add_type（const oratext * type_name）;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-62EC5F68-5A8B-41B9-A4BB-7825031F2822__GUID-95DD9DE0-3454-4378-895C-70F664B8117F">输入</p>
                        <p><code class="codeph">type_name</code> ：代理要管理的资源类型名称</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-62EC5F68-5A8B-41B9-A4BB-7825031F2822__GUID-2D8725C5-FCEF-47D2-A1B2-F611F6A7BA44">使用说明</p>
                        <p>启动时，代理必须注册它管理的所有资源类型。单个代理可以管理多种资源类型和多种资源。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-AE09D76E-63EC-4270-83FC-0504D38276BD" name="GUID-AE09D76E-63EC-4270-83FC-0504D38276BD"></a><h4 id="CWADD-GUID-AE09D76E-63EC-4270-83FC-0504D38276BD" class="sect4">clsagfw_check_resource（）</h4>
                  <div>
                     <p>启动对特定资源的检查操作。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-AE09D76E-63EC-4270-83FC-0504D38276BD__GUID-7409E839-ECE8-4260-B889-21658608EE56">句法</p><pre class="pre codeblock"><code>void clsagfw_check_resource（const oratext * pResId）</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-AE09D76E-63EC-4270-83FC-0504D38276BD__GUID-DBE12892-2CF6-4E4A-87C9-54FD6DBD0050">输入</p>
                        <p><code class="codeph">pResId</code> ：资源的识别</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-AE09D76E-63EC-4270-83FC-0504D38276BD__GUID-63A52656-064E-4DA5-95D0-E94C1405B9A8">使用说明</p>
                        <p>代理可以在入口点或其他后台线程中使用此功能来启动对特定资源的检查操作。代理框架在另一个线程中调度并执行检查操作。如果从CHECK入口点调用，则此函数无效。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-74BF1AD0-D54A-4592-A08C-7072DE37DFD0" name="GUID-74BF1AD0-D54A-4592-A08C-7072DE37DFD0"></a><h4 id="CWADD-GUID-74BF1AD0-D54A-4592-A08C-7072DE37DFD0" class="sect4">clsagfw_create_attr_iterator（）</h4>
                  <div>
                     <p>创建迭代器以访问当前资源的所有属性。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-74BF1AD0-D54A-4592-A08C-7072DE37DFD0__GUID-21F8ECB8-9B38-4BE4-B03C-A69F3F57F549">句法</p><pre class="pre codeblock"><code>clsagfwret clsagfw_create_attr_iterator（const clsagfw_aectx * pAeCtx，clsagfw_ai_flags flags）;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-74BF1AD0-D54A-4592-A08C-7072DE37DFD0__GUID-D03AFB99-7F92-49C3-8401-13EF5EBEA0E8">输入</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">pAeCtx</code> ：传递给入口点的代理框架上下文指针</p>
                           </li>
                           <li>
                              <p><code class="codeph">flags</code> ：</p>
                              <p>             <code class="codeph">CLSAGFW_ALL_ATTRS</code> ：资源的所有属性</p>
                              <p>             <code class="codeph">CLSAGFW_MODIFIED_ATTRS</code> ：仅修改属性</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-74BF1AD0-D54A-4592-A08C-7072DE37DFD0__GUID-9DC193DC-0E11-4DEC-9F15-D061CED131CB">使用说明</p>
                        <p>代理程序调用此函数来创建迭代器以浏览资源的所有属性。这对于管理不同类型的多个资源的代理很有用。迭代器是在代理框架上下文中维护的内部迭代器。通过调用<code class="codeph">clsagfw_get_attr_from_iterator()</code> API来检索每个属性。只能在MODIFY入口点访问已修改的属性。在任何给定时间，入口点只能创建一个迭代器。所有后续创建迭代器的尝试都会获得指向已创建的迭代器的指针。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-3224508B-72A9-4E7B-8A47-5B803FD915DC" name="GUID-3224508B-72A9-4E7B-8A47-5B803FD915DC"></a><h4 id="CWADD-GUID-3224508B-72A9-4E7B-8A47-5B803FD915DC" class="sect4">clsagfw_delete_cookie（）</h4>
                  <div>
                     <p>删除存储在代理框架中的cookie。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-3224508B-72A9-4E7B-8A47-5B803FD915DC__GUID-6289891F-90D3-4EFC-A0BF-C73974F746E0">句法</p><pre class="pre codeblock"><code>clsagfwret clsagfw_delete_cookie（const oratext * key）;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-3224508B-72A9-4E7B-8A47-5B803FD915DC__GUID-AD08D837-F4C8-41F8-8207-5F0F12CFA119">输入</p>
                        <p><code class="codeph">key</code> ：cookie的键，以null结尾的字符串</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-3224508B-72A9-4E7B-8A47-5B803FD915DC__GUID-470E209E-B50C-48AC-9C76-1685B55BECBE">使用说明</p>
                        <p>此函数删除cookie并释放cookie使用的所有内存及其值。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-452087CF-77B9-4381-94A6-3E89E978A58C" name="GUID-452087CF-77B9-4381-94A6-3E89E978A58C"></a><h4 id="CWADD-GUID-452087CF-77B9-4381-94A6-3E89E978A58C" class="sect4">clsagfw_exit2（）</h4>
                  <div>
                     <p>使用资源重试反馈终止代理进程。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-452087CF-77B9-4381-94A6-3E89E978A58C__GUID-01DB4A37-73A5-49FF-A2A5-21079BDDFA4A">句法</p><pre class="pre codeblock"><code>void clsagfw_exit2（const oratext * rid，sb4 exitCode，bool retry）;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-452087CF-77B9-4381-94A6-3E89E978A58C__GUID-CDCE196D-14F2-437B-B3FD-C6578E4925B4">输入</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">rid</code> ：导致无法恢复的错误的资源的资源ID</p>
                           </li>
                           <li>
                              <p><code class="codeph">exitCode</code> ：处理退出代码</p>
                           </li>
                           <li>
                              <p><code class="codeph">retry</code> ：重试资源的选项</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-452087CF-77B9-4381-94A6-3E89E978A58C__GUID-50EA6F2A-5ACE-4122-BF6D-0B6B2D4E22A6">使用说明</p>
                        <p>在执行资源的入口点时，代理可能会遇到不可恢复的错误，然后必须终止当前进程。代理可以使用此API来结束代理进程，并在资源上向代理框架提供反馈，这是导致无法恢复的错误的原因。如果retry参数设置为<span class="italic">true</span> ，则在代理进程重新启动时将重试资源上的当前命令。如果参数设置为<span class="italic">false</span> ，则不会重试当前资源命令，并且禁用资源监视。当特定资源是代理重复失败的原因时，可以使用此选项。Oracle Clusterware服务器会跟踪导致代理退出的资源，并在故障率很高时自动禁用资源。要重新启用由于高故障率而禁用的资源，必须发出显式请求以启动资源（例如，使用CRSCTL）。
                        </p>
                        <p>Oracle Clusterware服务器重新启动代理以继续监视代理管理的资源。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-6616A067-3258-4D1E-B6EE-1098ABF2D67B" name="GUID-6616A067-3258-4D1E-B6EE-1098ABF2D67B"></a><h4 id="CWADD-GUID-6616A067-3258-4D1E-B6EE-1098ABF2D67B" class="sect4">clsagfw_get_attr_from_iterator（）</h4>
                  <div>
                     <p>从创建的迭代器返回下一个属性名称和值。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-6616A067-3258-4D1E-B6EE-1098ABF2D67B__GUID-092EF3B4-81EB-4887-A706-4E42542111CE">句法</p><pre class="pre codeblock"><code>clsagfwret clsagfw_get_attr_from_iterator（const clsagfw_aectx * pAeCtx，const oratext ** argName，const oratext ** argValue）;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-6616A067-3258-4D1E-B6EE-1098ABF2D67B__GUID-245BDF89-B7B4-4573-913F-84454D9AAA0D">输入</p>
                        <p><code class="codeph">pAeCtx</code> ：传递给入口点的代理框架上下文指针</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-6616A067-3258-4D1E-B6EE-1098ABF2D67B__GUID-B14245A3-3927-40F5-A3F6-BCAAD3254E8C">返回</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">argname</code> ：属性名称</p>
                           </li>
                           <li>
                              <p><code class="codeph">argValue</code> ：属性值</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-6616A067-3258-4D1E-B6EE-1098ABF2D67B__GUID-576CC7DE-CCF1-4F89-9CCB-3853E6678CDB">使用说明</p>
                        <p>在代理框架上下文中创建迭代器后，使用此函数检索属性。当此函数返回时，迭代器将前进到下一个属性。如果API返回CLSAGFW_FAIL，则不再有资源要检索的属性。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-9B4900CC-0BE6-46AB-A8B8-D91D6C598B86" name="GUID-9B4900CC-0BE6-46AB-A8B8-D91D6C598B86"></a><h4 id="CWADD-GUID-9B4900CC-0BE6-46AB-A8B8-D91D6C598B86" class="sect4">clsagfw_get_attrvalue（）</h4>
                  <div>
                     <p>获取当前资源的属性值。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-9B4900CC-0BE6-46AB-A8B8-D91D6C598B86__GUID-F7F1B394-7B02-4B1A-A23D-FE1F7A94B80F">句法</p><pre class="pre codeblock"><code>void clsagfw_get_attrvalue（const clsagfw_aectx * pAeCtx，const oratext * pAttrName，const oratext ** pAttrValue）;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-9B4900CC-0BE6-46AB-A8B8-D91D6C598B86__GUID-E1468BEB-84FD-47B0-BBB2-A6D7E597C60A">输入</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">pAeCtx</code> ：传递给入口点的代理框架上下文指针</p>
                           </li>
                           <li>
                              <p><code class="codeph">pAttrName</code> ：要检索的属性的名称</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-9B4900CC-0BE6-46AB-A8B8-D91D6C598B86__GUID-37A9BEC8-554B-43C2-8005-CAC8DE0B4450">返回</p>
                        <p><code class="codeph">pAttrValue</code> ：指定属性的值</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-9B4900CC-0BE6-46AB-A8B8-D91D6C598B86__GUID-72B2671F-7A3F-48AC-BBB8-9A71E3A64AF1">使用说明</p>
                        <p>代理使用此API来检索当前命令资源的单个属性的值。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-7D7A085C-51D6-446F-9687-B04A20AA139A" name="GUID-7D7A085C-51D6-446F-9687-B04A20AA139A"></a><h4 id="CWADD-GUID-7D7A085C-51D6-446F-9687-B04A20AA139A" class="sect4">clsagfw_get_check_type（）</h4>
                  <div>
                     <p>返回当前正在执行的检查命令的类型。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-7D7A085C-51D6-446F-9687-B04A20AA139A__GUID-7FF69B67-3E86-4411-B2DD-E094A5C07772">句法</p><pre class="pre codeblock"><code>clsagfw_checktype clsagfw_get_check_type（const clsagfw_aectx * pAeCtx）;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-7D7A085C-51D6-446F-9687-B04A20AA139A__GUID-688A3557-4019-4074-A0FD-1D795FCE3563">输入</p>
                        <p><code class="codeph">pAeCtx</code> ：传递给入口点的代理框架上下文指针</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-7D7A085C-51D6-446F-9687-B04A20AA139A__GUID-A5AED642-FBB0-4EAA-802C-5AE0F31F1E4E">使用说明</p>
                        <p>代理框架针对多个条件调用资源的CHECK入口点。通过使用此功能，代理可以识别当前CHECK入口点的确切条件并执行适当的操作。</p>
                        <p>可能的条件包括：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="bold">CLSAGFW_INITIAL_CHECK</span> ：检查在启动或重新启动Oracle Clusterware服务器时作为初始探测阶段的一部分调用的入口点。
                              </p>
                           </li>
                           <li>
                              <p><span class="bold">CLSAGFW_CHECK_AFTER_CMD</span> ：检查调用的入口点以跟进先前的操作（例如启动或停止），以确定操作执行后的结果资源状态。
                              </p>
                           </li>
                           <li>
                              <p><span class="bold">CLSAGFW_PERIODIC_CHECK</span> ：定期检查代理框架调用的入口点以监视资源的状态。时间间隔在资源的<code class="codeph">CHECK_INTERVAL</code>属性中指定。
                              </p>
                           </li>
                           <li>
                              <p><span class="bold">CLSAGFW_EXTERNAL_CHECK</span> ：检查代理框架在收到来自外部实体（如CRSCTL）的显式检查请求时调用的入口点。</p>
                           </li>
                           <li>
                              <p><span class="bold">CLSAGFW_CHECKFROM_EP</span> ：通过调用<code class="codeph">clsagfw_check_resource()</code> API检查代理本身启动的操作。</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-5F052C35-F002-44BC-981A-90EB38E2CFF3" name="GUID-5F052C35-F002-44BC-981A-90EB38E2CFF3"></a><h4 id="CWADD-GUID-5F052C35-F002-44BC-981A-90EB38E2CFF3" class="sect4">clsagfw_get_cmdid（）</h4>
                  <div>
                     <p>返回调用入口点的命令的类型。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-5F052C35-F002-44BC-981A-90EB38E2CFF3__GUID-179A7993-BABC-4652-8DB8-E96E334BB4D3">句法</p><pre class="pre codeblock"><code>clsagfw_aecode clsagfw_get_cmdid（const clsagfw_aectx * pAeCtx）;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-5F052C35-F002-44BC-981A-90EB38E2CFF3__GUID-D854E0F9-86AE-4B5F-B73B-DAC2AE8F7B5F">输入</p>
                        <p><code class="codeph">pAeCtx</code> ：传递给入口点的代理框架上下文指针</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-5F052C35-F002-44BC-981A-90EB38E2CFF3__GUID-54356944-5773-4E55-A813-E94B0E083370">使用说明</p>
                        <p>代理可以在ABORT入口点调用此API以确定正在中止的资源命令。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-24F42F78-86EB-4157-89E5-31C98F37946B" name="GUID-24F42F78-86EB-4157-89E5-31C98F37946B"></a><h4 id="CWADD-GUID-24F42F78-86EB-4157-89E5-31C98F37946B" class="sect4">clsagfw_get_cookie（）</h4>
                  <div>
                     <p>检索存储在代理框架中的cookie的值。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-24F42F78-86EB-4157-89E5-31C98F37946B__GUID-19ECE386-8F42-4D2A-A156-8624404CDB39">句法</p><pre class="pre codeblock"><code>clsagfwret clsagfwret clsagfw_set_cookie（const oratext * key，const void ** value）;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-24F42F78-86EB-4157-89E5-31C98F37946B__GUID-795AF91F-E624-4F96-8406-977FB0BA2CB1">输入</p>
                        <p><code class="codeph">key</code> ：cookie的键，以null结尾的字符串</p>
                        <p><code class="codeph">Value</code> ：指向cookie值的指针</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-DC809473-DDBA-4D62-B860-DAF768A4B06A" name="GUID-DC809473-DDBA-4D62-B860-DAF768A4B06A"></a><h4 id="CWADD-GUID-DC809473-DDBA-4D62-B860-DAF768A4B06A" class="sect4">clsagfw_get_request_action_name（）</h4>
                  <div>
                     <p>返回要在资源上执行的自定义操作的名称。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-DC809473-DDBA-4D62-B860-DAF768A4B06A__GUID-4269D22E-1165-41D6-9621-D94B13908CF5">句法</p><pre class="pre codeblock"><code>const oratext * clsagfw_get_request_action_name（const clsagfw_aectx * pAeCtx）;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-DC809473-DDBA-4D62-B860-DAF768A4B06A__GUID-DE01E973-35CD-4CEC-922B-21FCC926766D">输入</p>
                        <p><code class="codeph">pAeCtx</code> ：传递给用户入口点的代理框架上下文</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-DC809473-DDBA-4D62-B860-DAF768A4B06A__GUID-8A961D7B-AFDE-4F03-BD94-DA335BF528E1">使用说明</p>
                        <p>在ACTION入口点调用此函数以检索您在请求操作命令中指定的操作名称。您可以在资源的ACTION属性中配置资源的操作列表。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-4D6EA7DF-B212-45B3-91ED-9AA1AE6200E6" name="GUID-4D6EA7DF-B212-45B3-91ED-9AA1AE6200E6"></a><h4 id="CWADD-GUID-4D6EA7DF-B212-45B3-91ED-9AA1AE6200E6" class="sect4">clsagfw_get_resource_id（）</h4>
                  <div>
                     <p>检索正在执行入口点的资源的ID。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-4D6EA7DF-B212-45B3-91ED-9AA1AE6200E6__GUID-5918E859-DB36-4863-9573-9611F298D260">句法</p><pre class="pre codeblock"><code>const oratext * clsagfw_get_resource_id（const clsagfw_aectx * pAeCtx）;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-4D6EA7DF-B212-45B3-91ED-9AA1AE6200E6__GUID-8C6F4EA9-1D7C-4187-B67F-C2F47561E2D1">输入</p>
                        <p><code class="codeph">pAeCtx</code> ：传递给入口点的代理框架上下文指针</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-4D6EA7DF-B212-45B3-91ED-9AA1AE6200E6__GUID-1240969F-4741-4FC8-9DA5-29D6743A3991">使用说明</p>
                        <p>此函数返回Oracle Clusterware生成的资源ID。要检索资源的公共显示名称，请使用<code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-BAB747A7-4AC4-4EB4-AAC2-419C09ACE1E9" title="检索当前命令的资源名称。">clsagfw_get_resource_name()</a></code> API。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-BAB747A7-4AC4-4EB4-AAC2-419C09ACE1E9" name="GUID-BAB747A7-4AC4-4EB4-AAC2-419C09ACE1E9"></a><h4 id="CWADD-GUID-BAB747A7-4AC4-4EB4-AAC2-419C09ACE1E9" class="sect4">clsagfw_get_resource_name（）</h4>
                  <div>
                     <p>检索当前命令的资源名称。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-BAB747A7-4AC4-4EB4-AAC2-419C09ACE1E9__GUID-A097A44A-9886-494A-B250-BD52C89E6E37">句法</p><pre class="pre codeblock"><code>const oratext * clsagfw_get_resource_name（const clsagfw_aectx * pAeCtx）;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-BAB747A7-4AC4-4EB4-AAC2-419C09ACE1E9__GUID-317809A6-9F94-483D-A9D8-20A01BB193C8">输入</p>
                        <p><code class="codeph">pAeCtx</code> ：传递给入口点的代理框架上下文指针</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-BAB747A7-4AC4-4EB4-AAC2-419C09ACE1E9__GUID-0140BCD0-AAAD-4AFD-919E-501BBAAD64F4">使用说明</p>
                        <p>此函数返回正在为其执行当前命令和入口点的资源的名称。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-2B1F79C0-6C9E-4BD8-9709-C0092E699D06" name="GUID-2B1F79C0-6C9E-4BD8-9709-C0092E699D06"></a><h4 id="CWADD-GUID-2B1F79C0-6C9E-4BD8-9709-C0092E699D06" class="sect4">clsagfw_get_retry_count（）</h4>
                  <div>
                     <p>返回当前命令的重试尝试次数。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-2B1F79C0-6C9E-4BD8-9709-C0092E699D06__GUID-FA275796-3249-4C11-98B9-11B848725927">句法</p><pre class="pre codeblock"><code>ub4 clsagfw_get_retry_count（const clsagfw_aectx * pAeCtx）</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-2B1F79C0-6C9E-4BD8-9709-C0092E699D06__GUID-4E5A9A58-62FF-423E-8FEB-7A6450433869">输入</p>
                        <p><code class="codeph">pAeCtx</code> ：传递给用户入口点的代理框架上下文</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-2B1F79C0-6C9E-4BD8-9709-C0092E699D06__GUID-E26D738D-EEA3-4538-A441-57ABD73BC9F5">使用说明</p>
                        <p>代理可以在入口点调用此函数以检查是否正在重试当前命令。代理进程或Oracle Clusterware服务器进程可以在对资源执行命令的过程中终止。当代理或服务器进程重新启动时，Oracle Clusterware会重试失败的命令。该命令可能在先前的尝试中已成功或部分执行。当Oracle Clusterware重试命令时，代理可以执行恢复或清理操作。可以重试命令的次数是Oracle Clusterware的内部参数。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-22B8F816-B746-4C5A-8EE6-B2312F401B37" name="GUID-22B8F816-B746-4C5A-8EE6-B2312F401B37"></a><h4 id="CWADD-GUID-22B8F816-B746-4C5A-8EE6-B2312F401B37" class="sect4">clsagfw_get_type_name（）</h4>
                  <div>
                     <p>检索正在为其执行入口点的资源的类型名称。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-22B8F816-B746-4C5A-8EE6-B2312F401B37__GUID-81C067C9-6587-4E7C-8733-5FCEDB3A9B27">句法</p><pre class="pre codeblock"><code>const oratext * clsagfw_get_type_name（const clsagfw_aectx * pAeCtx）;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-22B8F816-B746-4C5A-8EE6-B2312F401B37__GUID-12029F61-EB81-4CD7-ACD3-8192415168B8">输入</p>
                        <p><code class="codeph">pAeCtx</code> ：传递给入口点的代理框架上下文指针</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-22B8F816-B746-4C5A-8EE6-B2312F401B37__GUID-A92D75F7-5E09-4CFD-9428-7F7A5F5CC053">使用说明</p>
                        <p>此函数返回Oracle Clusterware生成的资源ID。要检索资源的公共显示名称，请使用<code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-BAB747A7-4AC4-4EB4-AAC2-419C09ACE1E9" title="检索当前命令的资源名称。">clsagfw_get_resource_name()</a></code> API。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-87A74224-9BCA-41F8-90AB-6B17D93C6A21" name="GUID-87A74224-9BCA-41F8-90AB-6B17D93C6A21"></a><h4 id="CWADD-GUID-87A74224-9BCA-41F8-90AB-6B17D93C6A21" class="sect4">clsagfw_init（）</h4>
                  <div>
                     <p>初始化代理框架。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-87A74224-9BCA-41F8-90AB-6B17D93C6A21__GUID-830E1A20-5C7A-4930-8BE1-3FF37DCE3457">句法</p><pre class="pre codeblock"><code>clsagfwret clsagfw_init（sb4 argc，oratext ** argv，ub4 flags，const oratext * logName，void * reserved）;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-87A74224-9BCA-41F8-90AB-6B17D93C6A21__GUID-1F27FCF8-D3DD-4589-9D3F-7FBE6801A212">输入</p>
                        <p><code class="codeph">argc</code> ：传递给代理进程的命令行参数的数量</p>
                        <p><code class="codeph">argv</code> ：传递给代理进程的命令行参数</p>
                        <p><code class="codeph">flags</code> ：</p>
                        <p><code class="codeph">logName</code> ：此代理的日志文件的名称</p>
                        <p><code class="codeph">reserved</code> ：传递NULL</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-87A74224-9BCA-41F8-90AB-6B17D93C6A21__GUID-A5CBA3CA-46D9-40F4-B9E9-AB1D8BB85CD1">使用说明</p>
                        <p>当必须对资源执行操作时，Oracle Clusterware会自动启动为资源配置的代理。在启动时，代理进程首先调用此函数以初始化代理框架运行时。必须将Oracle Clusterware服务器传递给代理进程的命令行参数传递给<code class="codeph">clsagfw_init()</code> 。初始化完成后，代理可以注册由代理管理的资源类型。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-B0D795A7-493E-42F8-8416-0EE6A19244B7" name="GUID-B0D795A7-493E-42F8-8416-0EE6A19244B7"></a><h4 id="CWADD-GUID-B0D795A7-493E-42F8-8416-0EE6A19244B7" class="sect4">clsagfw_is_cmd_timedout（）</h4>
                  <div>
                     <p>返回ABORT入口点的原因。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-B0D795A7-493E-42F8-8416-0EE6A19244B7__GUID-58CBCE73-26BA-425A-9601-372C3C8313B3">句法</p><pre class="pre codeblock"><code>bool clsagfw_is_cmd_timedout（const clsagfw_aectx * pAeCtx）;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-B0D795A7-493E-42F8-8416-0EE6A19244B7__GUID-B60F40B6-FB79-4455-8645-067851ADB096">输入</p>
                        <p><code class="codeph">pAeCtx</code> ：传递给入口点的代理框架上下文指针</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-B0D795A7-493E-42F8-8416-0EE6A19244B7__GUID-1EC4E16D-4EA0-44C4-A401-8D60A175B66E">使用说明</p>
                        <p>代理可以在ABORT入口点中使用此函数来标识ABORT入口点调用的原因。如果命令执行时间超过其超时值，或者Oracle Clusterware管理员中止命令，则可以调用ABORT入口点。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-9B6E15B5-D6CC-4125-9F61-64DF59410DA4" name="GUID-9B6E15B5-D6CC-4125-9F61-64DF59410DA4"></a><h4 id="CWADD-GUID-9B6E15B5-D6CC-4125-9F61-64DF59410DA4" class="sect4">clsagfw_log（）</h4>
                  <div>
                     <p>将诊断消息打印到代理日志文件。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-9B6E15B5-D6CC-4125-9F61-64DF59410DA4__GUID-E50403F5-885B-47EA-B217-94C80018865E">句法</p><pre class="pre codeblock"><code>void clsagfw_log（const clsagfw_aectx * pAeCtx，const ub4 log_level，const oratext * fmtp，...）;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-9B6E15B5-D6CC-4125-9F61-64DF59410DA4__GUID-442FD625-6F8B-47ED-BFC2-6538D3260740">输入</p>
                        <p><code class="codeph">pAeCtx</code> ：传递给用户入口点的代理框架上下文</p>
                        <p><code class="codeph">log_level</code> ：消息的日志级别，取值范围为1-5</p>
                        <p><code class="codeph">fmtp</code> ：消息格式字符串，根据标准C库打印规范</p>
                        <p><code class="codeph">...</code> ：与格式字符串对应的变量参数</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-9B6E15B5-D6CC-4125-9F61-64DF59410DA4__GUID-882A5145-292A-4C1A-9670-D73DBF2009FE">使用说明</p>
                        <p>代理程序调用此函数来记录有助于调试和理解代理程序执行的诊断消息。您可以使用<code class="codeph">LOG_LEVEL</code>参数来控制日志消息的数量。您可以使用CRSCTL配置资源的当前日志记录级别，如下所示：</p><pre class="oac_no_warn" dir="ltr">$ crsctl设置日志级别res“myResource1 = 3”</pre><p>错误将记录到<code class="codeph">TODO</code>目录中的代理日志文件中。默认情况下，日志文件的名称与代理可执行文件名称相同。您可以通过将<code class="codeph">logName</code>参数传递给<code class="codeph">clsagfw_init()</code> API来更改此设置。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-53EAECD0-2E3A-4551-A21F-69BFEA734D8B" name="GUID-53EAECD0-2E3A-4551-A21F-69BFEA734D8B"></a><h4 id="CWADD-GUID-53EAECD0-2E3A-4551-A21F-69BFEA734D8B" class="sect4">clsagfw_modify_attribute（）</h4>
                  <div>
                     <p>修改当前资源的属性。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-53EAECD0-2E3A-4551-A21F-69BFEA734D8B__GUID-4E37C94D-1B64-431F-8F5C-2DF9B025AA67">句法</p><pre class="pre codeblock"><code>void clsagfw_modify_attribute（const clsagfw_aectx * pAeCtx，const oratext * pAttrName，const oratext * pAttrValue）;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-53EAECD0-2E3A-4551-A21F-69BFEA734D8B__GUID-B7FC4F29-F09C-49BF-BBEA-7679DFF1818D">输入</p>
                        <p><code class="codeph">pAeCtx</code> ：传递给入口点的代理框架上下文指针</p>
                        <p><code class="codeph">pAttrName</code> ：要修改的属性的名称</p>
                        <p><code class="codeph">pAttrValue</code> ：属性的新值</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-53EAECD0-2E3A-4551-A21F-69BFEA734D8B__GUID-115E72C1-2574-41FD-8AC3-26E806B3E0FF">使用说明</p>
                        <p>代理可以通过调用此API来修改当前命令资源的属性值。资源修改请求将发送到Oracle Clusterware服务器进行验证，更新后的属性值仅在Oracle Clusterware服务器确认后才会反映在代理中。此功能只能从START，STOP和CLEAN入口点调用。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-507370BC-58AC-4FD2-BAE0-1AE092B1B14B" name="GUID-507370BC-58AC-4FD2-BAE0-1AE092B1B14B"></a><h4 id="CWADD-GUID-507370BC-58AC-4FD2-BAE0-1AE092B1B14B" class="sect4">clsagfw_reset_attr_iterator（）</h4>
                  <div>
                     <p>重置属性迭代器。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-507370BC-58AC-4FD2-BAE0-1AE092B1B14B__GUID-80222244-D1F1-49EF-B1EF-038562F0024C">句法</p><pre class="pre codeblock"><code>clsagfwret clsagfw_reset_attr_iterator（const clsagfw_aectx * pAeCtx，clsagfw_ai_flags flags）;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-507370BC-58AC-4FD2-BAE0-1AE092B1B14B__GUID-29903647-2101-4BDE-8A48-618E86B56CE4">输入</p>
                        <p><code class="codeph">pAeCtx</code> ：传递给入口点的代理框架上下文指针</p>
                        <p><code class="codeph">flags</code> ：要访问的属性：</p>
                        <p>            <code class="codeph">CLSAGFW_ALL_ATTRS</code> ：资源的所有属性</p>
                        <p>            <code class="codeph">CLSAGFW_MODIFIED_ATTRS</code> ：仅修改属性</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-507370BC-58AC-4FD2-BAE0-1AE092B1B14B__GUID-B970722B-C935-4200-BB34-0E964433C269">使用说明</p>
                        <p>此函数重置代理框架上下文中的迭代器，以便代理可以重新启动属性导航。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-BCB22E7E-D21C-445E-A253-3B099331304B" name="GUID-BCB22E7E-D21C-445E-A253-3B099331304B"></a><h4 id="CWADD-GUID-BCB22E7E-D21C-445E-A253-3B099331304B" class="sect4">clsagfw_send_status2（）</h4>
                  <div>
                     <p>向Oracle Clusterware服务器和用户报告进度，警告和错误消息。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-BCB22E7E-D21C-445E-A253-3B099331304B__GUID-F9841C4E-0F6D-47F4-88C6-B78BF90E6ACB">句法</p><pre class="pre codeblock"><code>void clsagfw_send_status2（const clsagfw_aectx * pAeCtx，const oratext * pResId，clsagfw_status_type type，const oratext * fmtp，...）;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-BCB22E7E-D21C-445E-A253-3B099331304B__GUID-8E98061F-4C6F-498C-A66D-6F121F9B4638">输入</p>
                        <p><code class="codeph">pAeCtx</code> ：传递给入口点的代理框架上下文指针</p>
                        <p><code class="codeph">pResId</code> ：报告消息的资源</p>
                        <p><code class="codeph">type</code> ：以下类型的消息之一：</p>
                        <p>          <code class="codeph">CLSAGFW_STATUS_PROGRESS</code> ：进度消息</p>
                        <p>          <code class="codeph">CLSAGFW_STATUS_WARNING</code> ：警告消息</p>
                        <p>          <code class="codeph">CLSAGFW_STATUS_ERROR</code> ：错误消息</p>
                        <p><code class="codeph">fmtp</code> ：消息格式字符串</p>
                        <p><code class="codeph">...</code> ：与消息格式字符串中的位置对应的变量</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-BCB22E7E-D21C-445E-A253-3B099331304B__GUID-4C70A852-8960-4C90-8326-BDC73F17BC36">使用说明</p>
                        <p>在执行命令期间，代理可以向Oracle Clusterware服务器和执行资源操作的用户发送信息性消息。这些消息可以告知您执行进度以及是否有任何警告或错误。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-EAA6711F-A7E8-453D-B3DE-3711461CC31C" name="GUID-EAA6711F-A7E8-453D-B3DE-3711461CC31C"></a><h4 id="CWADD-GUID-EAA6711F-A7E8-453D-B3DE-3711461CC31C" class="sect4">clsagfw_set_cookie（）</h4>
                  <div>
                     <p>在代理框架中存储cookie及其值。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-EAA6711F-A7E8-453D-B3DE-3711461CC31C__GUID-BBAE0B51-155D-4E6A-864B-AD3C14EE1525">句法</p><pre class="pre codeblock"><code>clsagfwret clsagfwret clsagfw_set_cookie（const oratext * key，const void * value）;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-EAA6711F-A7E8-453D-B3DE-3711461CC31C__GUID-509982C0-7D1E-47A1-80E9-FD4C12F52DF0">输入</p>
                        <p><code class="codeph">key</code> ：cookie的键，以null结尾的字符串</p>
                        <p><code class="codeph">Value</code> ：指向要存储的cookie值的指针</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-EAA6711F-A7E8-453D-B3DE-3711461CC31C__GUID-0117165C-9C1B-4756-81AB-9ECE22099480">使用说明</p>
                        <p>稍后可以通过调用<code class="codeph">clsagfw_get_cookie()</code>来检索保存的cookie的值。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-12FC4CAD-F6AF-4030-8C3C-CFC92C9A9842" name="GUID-12FC4CAD-F6AF-4030-8C3C-CFC92C9A9842"></a><h4 id="CWADD-GUID-12FC4CAD-F6AF-4030-8C3C-CFC92C9A9842" class="sect4">clsagfw_set_entrypoint（）</h4>
                  <div>
                     <p>设置要对资源上的特定操作执行的C / C ++入口点函数。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-12FC4CAD-F6AF-4030-8C3C-CFC92C9A9842__GUID-0C202471-EAF2-4645-B21E-9F62501EBCFD">句法</p><pre class="pre codeblock"><code>void clsagfw_set_entrypoint（const oratext * type_name，clsagfw_action_entry action_entry，clsagfw_aecode action_entrycode）</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-12FC4CAD-F6AF-4030-8C3C-CFC92C9A9842__GUID-BFD50C9B-9B22-4C48-BD5B-ED462FBAA618">输入</p>
                        <p><code class="codeph">key</code> ：cookie的键，以null结尾的字符串</p>
                        <p><code class="codeph">Value</code> ：指向要存储的cookie值的指针</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-12FC4CAD-F6AF-4030-8C3C-CFC92C9A9842__GUID-187506C8-CFFC-4A4B-90DE-54F8CD2B19C6">使用说明</p>
                        <p>稍后可以通过调用<code class="codeph">clsagfw_get_cookie()</code>来检索保存的cookie的值。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-4FE4ECFB-2712-4D6A-933A-CE0737F4559C" name="GUID-4FE4ECFB-2712-4D6A-933A-CE0737F4559C"></a><h4 id="CWADD-GUID-4FE4ECFB-2712-4D6A-933A-CE0737F4559C" class="sect4">clsagfw_set_exitcb（）</h4>
                  <div>
                     <p>注册代理进程退出时要调用的函数。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-4FE4ECFB-2712-4D6A-933A-CE0737F4559C__GUID-83430690-2C2B-49E3-B715-F47E565490E8">句法</p><pre class="pre codeblock"><code>typedef void（* clsagfw_exit_callback）（sb4 exitCode）; void clsagfw_set_exitcb（clsagfw_exit_callback exit_func）</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-4FE4ECFB-2712-4D6A-933A-CE0737F4559C__GUID-CA8ECBB8-7996-43A0-8776-7EC9BE638C13">输入</p>
                        <p><code class="codeph">exit_func</code> ：代理进程退出时要调用的函数</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-4FE4ECFB-2712-4D6A-933A-CE0737F4559C__GUID-61A162D6-0117-4BD0-99E8-59335027C130">使用说明</p>
                        <p>当代理框架终止代理进程时，代理可以注册要调用的回调函数。回调函数可以执行代理实例化的任何内部资源的正确清理。如果代理进程正在退出以从无法恢复的错误中恢复，则Oracle Clusterware服务器不会重新启动代理，直到旧的化身退出为止。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-B6065249-F1B5-4D12-B26B-EDA24CFCB841" name="GUID-B6065249-F1B5-4D12-B26B-EDA24CFCB841"></a><h4 id="CWADD-GUID-B6065249-F1B5-4D12-B26B-EDA24CFCB841" class="sect4">clsagfw_set_resource_state_label（）</h4>
                  <div>
                     <p>在当前资源上设置自定义标签。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-B6065249-F1B5-4D12-B26B-EDA24CFCB841__GUID-E03F333F-A299-406D-AE2A-41B4721B6D2C">句法</p><pre class="pre codeblock"><code>void clsagfw_set_resource_state_label（const clsagfw_aectx * pAeCtx，const oratext * pLabel）;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-B6065249-F1B5-4D12-B26B-EDA24CFCB841__GUID-36BF0255-AD42-4E5F-9A01-0CDE4F980918">输入</p>
                        <p><code class="codeph">pAeCtx</code> ：传递给入口点的代理框架上下文指针</p>
                        <p><code class="codeph">pLabel</code> ：与资源关联的标签，以null结尾的字符串</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-B6065249-F1B5-4D12-B26B-EDA24CFCB841__GUID-394FD817-7B85-4890-B3CB-B43FE4DA8D98">使用说明</p>
                        <p>代理可以使用此功能设置与资源状态关联的描述性标签。此标签在资源的<code class="codeph">STATE_DETAILS</code>属性中报告。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-800B6FFF-3807-47E2-8239-92C293D1E385" name="GUID-800B6FFF-3807-47E2-8239-92C293D1E385"></a><h4 id="CWADD-GUID-800B6FFF-3807-47E2-8239-92C293D1E385" class="sect4">clsagfw_startup（）</h4>
                  <div>
                     <p>启动代理框架。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-800B6FFF-3807-47E2-8239-92C293D1E385__GUID-D1ACD077-3DD3-4219-B43D-49DC90AE2061">句法</p><pre class="pre codeblock"><code>clsagfwret clsagfw_startup（void）</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-800B6FFF-3807-47E2-8239-92C293D1E385__GUID-6A1E87A4-F587-4D68-AC46-FC72C5EE0D5E">使用说明</p>
                        <p>初始化代理框架并注册资源类型及其入口点后，代理将调用此API以启动代理框架，然后启动多线程基础结构以监视资源并对其执行操作。</p>
                        <p>成功时，此函数永远不会返回到调用线程。当需要时，代理框架线程将调用资源操作的入口点。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="CWADD92533"></a><a id="CWADD92532"></a><div class="sect2"><a id="GUID-DD78FC7D-82CB-4783-8DAF-1DC1FD7EFAE9" name="GUID-DD78FC7D-82CB-4783-8DAF-1DC1FD7EFAE9"></a><h3 id="CWADD-GUID-DD78FC7D-82CB-4783-8DAF-1DC1FD7EFAE9" class="sect3">代理示例</h3>
               <div>
                  <p><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-DD78FC7D-82CB-4783-8DAF-1DC1FD7EFAE9__CACDAJEB">示例H-1</a>详述了用于管理表示文件的资源的代理实现。
                  </p>
                  <div class="example" id="GUID-DD78FC7D-82CB-4783-8DAF-1DC1FD7EFAE9__CACDAJEB">
                     <p class="titleinexample">示例H-1 demoagent1.cpp</p><pre class="oac_no_warn" dir="ltr">/ *版权所有（c）2004,2012，Oracle和/或其附属公司。版权所有。* / / * * NAME * Demoagent1.cpp：演示代理监视文件* * DESCRIPTION *这是一个演示代理来监视文件的示例程序。代理具有以下任务：*  - 启动时：创建文件。*  - 关闭时：删除文件。*  -  On check命令：检测文件是否存在。*  - 关于清除命令：删除文件。*此程序可用作构建更复杂*代理的基础，以管理现实资源。* #include &lt;stdlib.h&gt; #include &lt;stdio.h&gt; #include &lt;string.h&gt; #include &lt;clsagfw.h&gt;</pre></div>
                  <!-- class="example" -->
                  <p>包括代理框架<code class="codeph">clsagfw.h</code>头文件。
                  </p><pre class="oac_no_warn" dir="ltr">#define TEST_TYPE1（oratext *）“HOTFILE_TYPE”#define TEST_PATHNAME_ATTR（oratext *）“PATH_NAME”/ * * NAME * test_agent_exit * DESCRIPTION *清理的功能，每当代理*进程即将终止时由框架调用* PARAMS * exitCode ，这是描述退出原因的sb4。* RETURNS * void * / void test_agent_exit（sb4 exitCode）{clsagfw_log（NULL，1，（oratext *）“Demo Agent正在退出.. \ n”）; }</pre><p>退出与代理框架注册的回调函数。</p><pre class="oac_no_warn" dir="ltr">/ * * NAME * type1_start * DESCRIPTION *'start'命令的操作入口点。为* monitoring创建文件。* PARAMS *指向代理框架上下文的指针* RETURNS * ub4，可以是CLSAGFW_AE_FAIL或CLSAGFW_AE_SUCCESS *，具体取决于操作是失败还是成功。* / ub4 type1_start（const clsagfw_aectx * ectx）{ub4 ret = CLSAGFW_AE_FAIL; const oratext * pResName = NULL; const oratext * pPathName = NULL; FILE * fp; clsagfw_log（ectx，1，（oratext *）“Start action called ..”）; / *尝试读取资源名称* / if（clsagfw_get_attrvalue（ectx，（oratext *）“NAME”，＆pResName）！= CLSAGFW_SUCCESS）{goto done; / / *尝试读取PATH_NAME属性* / if（clsagfw_get_attrvalue（ectx，TEST_PATHNAME_ATTR，＆pPathName）！= CLSAGFW_SUCCESS）{goto done; }</pre><p>使用<code class="codeph">clsagfw_get_attrvalue()</code>检索资源名称和<code class="codeph">PATH_NAME</code>属性的值。
                  </p><pre class="oac_no_warn" dir="ltr">clsagfw_log（ectx，1，（oratext *）“启动操作参数：resName =％s，pathName =％s”，pResName，pPathName）; / *尝试创建文件* / fp = fopen（（char *）pPathName，“w”）;如果（！fp）{/ *无法创建文件* / clsagfw_log（ectx，1，（oratext *）“资源％s的START操作：FAILED \ n”，pResName）; ret = CLSAGFW_AE_FAIL; } else {/ *成功创建文件* / clsagfw_log（ectx，1，（oratext *）“资源％s的START操作：SUCCESS \ n”，pResName）; ret = CLSAGFW_AE_SUCCESS; FCLOSE（FP）;完成：返回ret; }</pre><p>通过调用<code class="codeph">clsagfw_log()</code>将诊断和错误消息记录到代理程序日志文件中。
                  </p><pre class="oac_no_warn" dir="ltr">/ * * NAME * type1_stop * DESCRIPTION *'stop'和'clean'命令的动作入口点。删除*正在监视的文件。* PARAMS *指向代理框架上下文的指针* RETURNS * ub4，可以是CLSAGFW_AE_FAIL或CLSAGFW_AE_SUCCESS *，具体取决于操作是失败还是成功。* / ub4 type1_stop（const clsagfw_aectx * ectx）{ub4 ret = CLSAGFW_AE_FAIL; const oratext * pResName = NULL; const oratext * pPathName = NULL; clsagfw_log（ectx，1，（oratext *）“停止动作调用..”）; / *尝试读取资源名称* / if（clsagfw_get_attrvalue（ectx，（oratext *）“NAME”，＆pResName）！= CLSAGFW_SUCCESS）{clsagfw_log（ectx，1，（oratext *）“STOP动作：％s：无法读取属性\ n”，pResName）;完成; / / *尝试读取PATH_NAME属性* / if（clsagfw_get_attrvalue（ectx，TEST_PATHNAME_ATTR，＆pPathName）！= CLSAGFW_SUCCESS）{pPathName = pResName; } clsagfw_log（ectx，1，（oratext *）“停止动作参数：resName =％s，pathName =％s”，pResName，pPathName）; / *尝试删除文件* / if（remove（（char *）pPathName））{/ *无法删除文件* / clsagfw_log（ectx，1，（oratext *）“资源％s的停止操作：FAILED \ n“，pResName）; ret = CLSAGFW_AE_FAIL; } else {/ *成功删除文件* / clsagfw_log（ectx，1，（oratext *）“资源％s的停止操作：SUCCESS \ n”，pResName）; ret = CLSAGFW_AE_SUCCESS;完成：返回ret; } / * * NAME * type1_check * DESCRIPTION *'check'命令的操作入口点。确定*文件是否存在。* PARAMS *指向代理框架上下文的指针。* RETURNS * ub4，它给出了资源的状态。有关此函数的*返回代码的详细信息，请查看*代理框架参考。* / ub4 type1_check（const clsagfw_aectx * ectx）{ub4 ret = CLSAGFW_UNKNOWN; const oratext * pResName = NULL; const oratext * pPathName = NULL; FILE * fp; clsagfw_log（ectx，1，（oratext *）“检查动作叫......”）; / *尝试读取资源名称* / if（clsagfw_get_attrvalue（ectx，（oratext *）“NAME”，＆pResName）！= CLSAGFW_SUCCESS）{goto done; / / *尝试读取PATH_NAME属性* / if（clsagfw_get_attrvalue（ectx，TEST_PATHNAME_ATTR，＆pPathName）！= CLSAGFW_SUCCESS）{clsagfw_log（ectx，1，（oratext *）“CHECK action：％s：无法读取属性\ n”，pResName）;完成; } clsagfw_log（ectx，1，（oratext *）“检查操作参数：resName =％s，pathName =％s”，pResName，pPathName）; / *检查文件是否可访问* / fp = fopen（（char *）pPathName，“r”）;如果（！fp）{/ *无法打开文件* / clsagfw_log（ectx，1，（oratext *）“检查操作：％s状态 -  UNPLANNED_OFFLINE \ n”，pResName）; ret = CLSAGFW_UNPLANNED_OFFLINE; } else {/ *打开文件成功* / clsagfw_log（ectx，1，（oratext *）“检查操作：％s状态 -  ONLINE \ n”，pResName）; FCLOSE（FP）; ret = CLSAGFW_ONLINE;完成：返回ret; / * *代理框架的初始化和类型的注册是在main中完成的。* / int main（sb4 argc，oratext ** argv）{clsagfw_log（NULL，1，（oratext *）“***代理框架演示代理已启动*** \ n”）; / * *初始化代理框架* / if（clsagfw_init（argc，argv，0，NULL，0）！= CLSAGFW_SUCCESS）{clsagfw_log（NULL，1，（oratext *）“无法初始化代理框架\ n”）; clsagfw_exit（-1）; } / * *设置退出回调函数* / clsagfw_set_exitcb（test_agent_exit）; / * *将类型定义添加到框架* / if（clsagfw_add_type（TEST_TYPE1）！= CLSAGFW_SUCCESS）{clsagfw_log（NULL，1，（oratext *）“将类型％s添加到框架中失败\ n”，TEST_TYPE1）; clsagfw_exit（-1）; } / * *设置HOTFILE_TYPE * / clsagfw_set_entrypoint的所有入口点（TEST_TYPE1，type1_start，CLSAGFW_ACTION_START）; clsagfw_set_entrypoint（TEST_TYPE1，type1_stop，CLSAGFW_ACTION_STOP）; clsagfw_set_entrypoint（TEST_TYPE1，type1_check，CLSAGFW_ACTION_CHECK）; clsagfw_set_entrypoint（TEST_TYPE1，type1_stop，CLSAGFW_ACTION_CLEAN）; clsagfw_log（NULL，1，（oratext *）“向代理框架添加资源类型[％s] \ n”，TEST_TYPE1）; / * *全部设置为，启动框架。如果框架成功启动，则此函数不会返回。* / clsagfw_startup（）; / ***未达到** /返回0; }</pre></div>
            </div>
         </div>
      </article>
   </body>
</html>