<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="This chapter describes how to use the DUPLICATE command to create an independently functioning database copy."></meta>
      <meta name="description" content="This chapter describes how to use the DUPLICATE command to create an independently functioning database copy."></meta>
      <title>复制数据库</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Backup and Recovery User&#39;s Guide"></meta>
      <meta property="og:description" content="This chapter describes how to use the DUPLICATE command to create an independently functioning database copy."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Backup and Recovery User&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="database-backup-and-recovery-users-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-09T05:20:45-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2003, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96241-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="part-transfering-data-rman.html" title="Previous" type="text/html"></link>
      <link rel="next" href="rman-duplicating-databases-advanced.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database Backup and Recovery User&#39;s Guide"></meta>
    <meta name="dcterms.isVersionOf" content="BRADV"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="part-transfering-data-rman.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="rman-duplicating-databases-advanced.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">备份和恢复用户指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="part-transfering-data-rman.html" property="item" typeof="WebPage"><span property="name">使用RMAN传输数据</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">复制数据库</li>
            </ol>
            <a id="GUID-F31F9FCE-B610-49EB-B9DB-44B9AA4E838F" name="GUID-F31F9FCE-B610-49EB-B9DB-44B9AA4E838F"></a><a id="BRADV010"></a>
            
            <h2 id="BRADV-GUID-F31F9FCE-B610-49EB-B9DB-44B9AA4E838F" class="sect2"><span class="enumeration_chapter">25</span>复制数据库</h2>
         </header>
         <div class="ind">
            <div>
               <p>本章介绍如何使用<code class="codeph">DUPLICATE</code>命令创建独立运行的数据库副本。
               </p>
               <p>本章包含以下主题：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="rman-duplicating-databases.html#GUID-D8CFCA95-85F7-4824-B2CC-32C37A42F9FF" title="数据库复制是使用DUPLICATE命令复制源数据库中的全部或部分数据。重复数据库（复制的数据库）完全独立于源数据库（正在复制的数据库）。">RMAN数据库复制概述</a></p>
                  </li>
                  <li>
                     <p><a href="rman-duplicating-databases.html#GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" title="在复制数据库之前，您必须对复制过程做出一些决定。">计划复制数据库</a></p>
                  </li>
                  <li>
                     <p><a href="rman-duplicating-databases.html#GUID-FCE67CCA-78B3-47E4-8D1B-75C8719BD51A" title="RMAN使用辅助实例来创建重复数据库。在开始复制之前，必须准备辅助实例。">准备辅助实例</a></p>
                  </li>
                  <li>
                     <p><a href="rman-duplicating-databases.html#GUID-9AA25E86-888F-4E72-B0BC-E3849F39B76A" title="使用DUPLICATE命令复制数据库。您可以在源数据库中复制指定的表空间。复制Oracle Real Application Clusters（Oracle RAC）数据库的步骤包含与用于复制数据库的步骤相比较小的变化。稀疏数据库的复制过程以隐式还原开始，然后完成复制包含稀疏数据文件的数据库。数据库复制的主要工作由RMAN通道执行。每个通道对应于执行复制任务的Oracle数据库服务器会话。根据复制技术，RMAN使用辅助通道或目标通道。对于基于备份的复制，复制的主要工作由辅助通道执行。辅助通道对应于目标主机上辅助实例上的服务器会话。RMAN使用通道还原辅助实例中的备份。使用活动数据库复制，您无需更改源数据库通道配置或配置辅助通道。但是，您可能希望增加源数据库磁盘通道的并行度设置，以便RMAN并行通过网络复制文件。如果RMAN作为TARGET连接到源数据库，则源数据库必须处于正确的复制状态。您必须启动RMAN客户端并根据所选复制技术的要求连接到数据库实例。RMAN客户端可以位于任何主机上，只要它可以通过网络连接到必要的数据库。RMAN使用DUPLICATE命令为复制数据库提供了多个选项。">复制数据库</a></p>
                  </li>
                  <li>
                     <p><a href="rman-duplicating-databases.html#GUID-D95D9275-5882-4D5B-846F-1A03304BC307" title="使用DUPLICATE命令复制CDB，一个或多个PDB，稀疏CDB和稀疏PDB。复制CDB和PDB的步骤类似于复制非CDB的步骤，其中复制非CDB的过程有微小的变化。本节介绍如何复制CDB和PDB。">复制CDB和PDB</a></p>
                  </li>
                  <li>
                     <p><a href="rman-duplicating-databases.html#GUID-4A9A4F04-0D65-4BC0-AE4B-EFBD453D017F" title="RMAN自动优化DUPLICATE命令，该命令是先前失败的DUPLICATE命令的重复。">失败后重新启动DUPLICATE</a></p>
                  </li>
                  <li>
                     <p><a href="rman-duplicating-databases.html#GUID-EA6E8219-56BF-471C-AC5A-DFC55E760806" title="本节包含使用不同复制技术复制数据库的示例。">示例：复制数据库</a></p>
                  </li>
                  <li>
                     <p><a href="rman-duplicating-databases.html#GUID-D65799A8-0921-4DFE-B407-21715911DA21" title="此示例显示如何使用脚本自动执行复制目标数据库的过程。">示例：使用基于备份的复制复制数据库的脚本</a></p>
                  </li>
               </ul>
            </div>
            <div class="sect2"><a id="GUID-D8CFCA95-85F7-4824-B2CC-32C37A42F9FF" name="GUID-D8CFCA95-85F7-4824-B2CC-32C37A42F9FF"></a><h3 id="BRADV-GUID-D8CFCA95-85F7-4824-B2CC-32C37A42F9FF" class="sect3"><span class="enumeration_section">25.1</span> RMAN数据库复制概述</h3>
               <div>
                  <p>数据库复制是使用<code class="codeph">DUPLICATE</code>命令复制源数据库中的全部或部分数据。重复数据库（复制的数据库）完全独立于源数据库（正在复制的数据库）。
                  </p>
                  <p>本节包含以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="rman-duplicating-databases.html#GUID-BBCD4E68-DC14-4D24-BE74-9BAE7684C6ED" title="重复数据库可用于各种目的，其中大多数涉及测试。">数据库复制的目的</a></p>
                     </li>
                     <li>
                        <p><a href="rman-duplicating-databases.html#GUID-3C3A10DE-A843-4F48-AB34-E6D0064FDE9F" title="在复制数据库之前，您必须了解一些基本概念。">数据库复制的基本概念</a></p>
                     </li>
                     <li>
                        <p><a href="rman-duplicating-databases.html#GUID-F700603C-44EF-422F-8770-E7AA5BE33C87" title="RMAN使您可以执行两种主要类型的数据库复制。">数据库重复的类型</a></p>
                     </li>
                     <li>
                        <p><a href="rman-duplicating-databases.html#GUID-DC0A075D-82E3-4EC9-9FCF-51DB99F3EA03" title="RMAN执行一组自动化步骤来复制数据库。">RMAN如何复制数据库</a></p>
                     </li>
                     <li>
                        <p><a href="rman-duplicating-databases.html#GUID-0667FB47-1E7D-42E8-9342-7E1DE3FF150F" title="重复数据库可以包含与源数据库相同的内容，也可以只包含源数据库中表空间的子集。">重复数据库的内容</a></p>
                     </li>
                     <li>
                        <p><a href="rman-duplicating-databases.html#GUID-89053F52-4EAF-424E-B106-3ABFA076521C" title="RMAN在指定的目标主机上创建重复数据库。目标主机可以与源主机相同或不同。">关于数据库复制的目标主机</a></p>
                     </li>
                     <li>
                        <p><a href="rman-duplicating-databases.html#GUID-102FF47A-63D1-45CA-8C9F-4257E16BCA52" title="根据使用的目标主机和复制方案，重复的数据库文件可以使用与源数据库相同的名称或不同的名称。数据库文件包括数据文件，控制文件，联机重做日志文件和临时文件。">关于重复数据库文件名</a></p>
                     </li>
                     <li>
                        <p><a href="rman-duplicating-databases.html#GUID-7154AD5C-A192-4502-B3AC-FCD6DB3CDEAD" title="您可以在DUPLICATE命令中使用子句将数据库复制到过去的时间点。">关于将数据库复制到过去的时间点</a></p>
                     </li>
                     <li>
                        <p><a href="rman-duplicating-databases.html#GUID-7FDB9916-8FB9-471A-8EFD-26E34FB8EA25" title="先决条件取决于正在执行的数据库重复的类型。某些先决条件对于所有类型的复制都是通用的，而其他先决条件则特定于特定类型的复制。">复制数据库的先决条件</a></p>
                     </li>
                  </ul>
               </div>
               <div class="sect3"><a id="GUID-BBCD4E68-DC14-4D24-BE74-9BAE7684C6ED" name="GUID-BBCD4E68-DC14-4D24-BE74-9BAE7684C6ED"></a><h4 id="BRADV-GUID-BBCD4E68-DC14-4D24-BE74-9BAE7684C6ED" class="sect4"><span class="enumeration_section">25.1.1</span>数据库复制的目的</h4>
                  <div>
                     <p>重复数据库可用于各种目的，其中大多数涉及测试。</p>
                     <p>您可以在重复的数据库中执行以下任务：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>测试备份和恢复过程</p>
                           <p>例如，您可以将<code class="codeph">host1</code>上的生产数据库复制到<code class="codeph">host2</code> ，然后使用<code class="codeph">host2</code>上的duplicate数据库练习恢复和恢复此数据库，而<code class="codeph">host1</code>上的生产数据库照常运行。
                           </p>
                        </li>
                        <li>
                           <p>测试升级到新版Oracle数据库</p>
                        </li>
                        <li>
                           <p>测试应用程序对数据库性能的影响</p>
                        </li>
                        <li>
                           <p>创建备用数据库</p>
                           <p></p>
                           <p>您可以创建物理备用数据库或Oracle Data Guard远程同步实例。备用数据库是主数据库的副本，您可以使用主数据库中的归档重做日志文件不断更新主数据库。如果主数据库不可访问，则可以故障转移到备用数据库，备用数据库将成为新的主数据库。但是，不能以这种方式使用数据库副本：它不适用于故障转移方案， <span class="italic">也不</span>支持各种备用恢复和故障转移选项。
                           </p>
                        </li>
                        <li>
                           <p>生成报告</p>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-BBCD4E68-DC14-4D24-BE74-9BAE7684C6ED__GUID-823A74B2-F731-4C30-877B-37B5E205C80F">
                        <p class="notep1">也可以看看：</p>
                        <p><span class="italic"><a href="../sbydb/creating-data-guard-standby-database-using-RMAN.html#SBYDB-GUID-C713FD5C-3375-45E4-A78F-4063006DAC5B" target="_blank">Oracle Data Guards概念和管理</a></span> ，了解如何使用<code class="codeph">DUPLICATE</code>命令创建备用数据库</p>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-3C3A10DE-A843-4F48-AB34-E6D0064FDE9F" name="GUID-3C3A10DE-A843-4F48-AB34-E6D0064FDE9F"></a><h4 id="BRADV-GUID-3C3A10DE-A843-4F48-AB34-E6D0064FDE9F" class="sect4"><span class="enumeration_section">25.1.2</span>数据库复制的基本概念</h4>
                  <div>
                     <p>在复制数据库之前，您必须了解一些基本概念。</p>
                     <p>源主机是托管源数据库的计算机。<span class="bold">源数据库实例</span>是与源数据库关联的实例。
                     </p>
                     <p>目标主机是承载重复数据库的计算机。源主机和目标主机可以是相同或不同的计算机。</p>
                     <p>对于复制过程，与重复数据库关联的数据库实例称为辅助实例。</p>
                     <p>即使没有为重复提供明确的时间点，RMAN也必须执行数据库时间点恢复。需要时间点恢复，因为源数据库中的联机重做日志文件未备份且无法应用于重复数据库。复制数据库的最远恢复点是源数据库归档的最新重做日志文件。</p>
                     <p>RMAN为重复数据库分配新的DBID（创建备用数据库时除外，在这种情况下保留源DBID）。然后，您可以将重复数据库注册到与源数据库相同的恢复目录中。</p>
                     <p>如果使用操作系统实用程序而不是<code class="codeph">DUPLICATE</code>命令复制数据库，则复制的数据库的DBID将与原始数据库保持一致。要在与原始数据库相同的恢复目录中注册复制的数据库，必须使用DBNEWID实用程序更改DBID。
                     </p>
                     <div class="infoboxnotealso" id="GUID-3C3A10DE-A843-4F48-AB34-E6D0064FDE9F__GUID-B3C40074-07E7-4A7D-9CD8-2AF364040EF8">
                        <p class="notep1">也可以看看：</p>
                        <p><span><cite>Oracle数据库实用程序</cite></span></p>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-31F759B9-862C-4B97-B14B-843E82926074" name="GUID-31F759B9-862C-4B97-B14B-843E82926074"></a><h5 id="BRADV-GUID-31F759B9-862C-4B97-B14B-843E82926074" class="sect5"><span class="enumeration_section">25.1.2.1</span>辅助实例的初始化参数</h5>
                     <div>
                        <p>必须为辅助实例设置某些必需的初始化参数。</p>
                        <div class="section">
                           <p>下表描述了辅助实例的可能初始化参数的子集。</p>
                           <div class="tblformal" id="GUID-31F759B9-862C-4B97-B14B-843E82926074__GUID-F322CB44-D43D-4B1C-894B-30A4D80C1F1D">
                              <p class="titleintable">表25-1辅助实例初始化参数</p>
                              <table cellpadding="4" cellspacing="0" class="Formal" title="辅助实例初始化参数" border="1" summary="This table describes the initialization parameters that are set for the auxiliary instance." frame="hsides" rules="rows">
                                 <thead>
                                    <tr align="left" valign="top">
                                       <th align="left" valign="bottom" id="d109284e286"><span class="bold">初始化参数</span></th>
                                       <th align="left" valign="bottom" id="d109284e289"><span class="bold">值</span></th>
                                       <th align="left" valign="bottom" id="d109284e292"><span class="bold">状态</span></th>
                                    </tr>
                                 </thead>
                                 <tbody>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d109284e297" headers="d109284e286 ">
                                          <p><code class="codeph">DB_NAME</code></p>
                                       </td>
                                       <td align="left" valign="top" headers="d109284e297 d109284e289 ">
                                          <p><code class="codeph">DUPLICATE</code>命令中使用的名称相同。如果使用<code class="codeph">DUPLICATE</code>命令创建备用数据库，则该名称必须与主数据库相同。
                                          </p>
                                          <p>重复数据库的<code class="codeph">DB_NAME</code>初始化参数在其Oracle主目录中的数据库中必须是唯一的。
                                          </p>
                                       </td>
                                       <td align="left" valign="top" headers="d109284e297 d109284e292 ">
                                          <p>需要</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d109284e319" headers="d109284e286 ">
                                          <p><code class="codeph">CONTROL_FILES</code></p>
                                       </td>
                                       <td align="left" valign="top" headers="d109284e319 d109284e289 ">
                                          <p>控制文件位置。</p>
                                       </td>
                                       <td align="left" valign="top" headers="d109284e319 d109284e292 ">
                                          <p>需要</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d109284e330" headers="d109284e286 ">
                                          <p><code class="codeph">DB_BLOCK_SIZE</code></p>
                                       </td>
                                       <td align="left" valign="top" headers="d109284e330 d109284e289 ">
                                          <p>重复数据库的块大小。此块大小必须与源数据库的块大小匹配。如果源数据库参数文件包含<code class="codeph">DB_BLOCK_SIZE</code>初始化参数的值，则必须为辅助实例指定相同的值。然而，如果没有<code class="codeph">DB_BLOCK_SIZE</code>在源数据库初始化参数文件中指定参数，则没有指定<code class="codeph">DB_BLOCK_SIZE</code>辅助实例参数。
                                          </p>
                                       </td>
                                       <td align="left" valign="top" headers="d109284e330 d109284e292 ">
                                          <p>如果在源数据库中设置了此初始化参数，则为必需</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d109284e350" headers="d109284e286 ">
                                          <p><code class="codeph">DB_FILE_NAME_CONVERT</code></p>
                                       </td>
                                       <td align="left" valign="top" headers="d109284e350 d109284e289 ">
                                          <p>用于转换数据文件和临时文件名称的成对字符串。您还可以在<code class="codeph">DUPLICATE</code>命令本身上指定<code class="codeph">DB_FILE_NAME_CONVERT</code>参数。请参阅<span class="q">“ <a href="rman-duplicating-databases-advanced.html#GUID-086A9599-15DB-4441-8E02-A939CBC5FF96" title="除了使用SET NEWNAME或CONFIGURE AUXNAME命令外，还可以使用DB_FILE_NAME_CONVERT参数转换目标文件名。您可以在DUPLICATE命令中指定DB_FILE_NAME_CONVERT选项，也可以在辅助实例的初始化参数文件中设置它。">使用DB_FILE_NAME_CONVERT参数为非OMF或ASM数据文件生成名称</a> ”</span> 。
                                          </p>
                                       </td>
                                       <td align="left" valign="top" headers="d109284e350 d109284e292 ">
                                          <p>可选的</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d109284e389" headers="d109284e286 ">
                                          <p><code class="codeph">LOG_FILE_NAME_CONVERT</code></p>
                                       </td>
                                       <td align="left" valign="top" headers="d109284e389 d109284e289 ">
                                          <p>用于命名在线重做日志文件的成对字符串。请参阅<span class="q">“ <a href="rman-duplicating-databases-advanced.html#GUID-A11B8766-5078-433F-927E-D77314236755" title="如果已省略LOG_FILE子句且未指定任何OMF初始化参数DB_CREATE_FILE_DEST，DB_CREATE_ONLINE_DEST_n或DB_RECOVERY_FILE_DEST，则LOG_FILE_NAME_CONVERT参数可以转换目标文件名。这与DB_FILE_NAME_CONVERT参数将目标文件名从log_ *转换为duplog_ *的方式相同。">使用LOG_FILE_NAME_CONVERT参数为非OMF或ASM日志文件生成名称</a> ”</span> 。
                                          </p>
                                       </td>
                                       <td align="left" valign="top" headers="d109284e389 d109284e292 ">
                                          <p>可选的</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d109284e432" headers="d109284e286 ">
                                          <p><code class="codeph">DB_CREATE_FILE_DEST</code></p>
                                       </td>
                                       <td align="left" valign="top" headers="d109284e432 d109284e289 ">
                                          <p>Oracle托管数据文件的位置。</p>
                                       </td>
                                       <td align="left" valign="top" headers="d109284e432 d109284e292 ">
                                          <p>可选的</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d109284e443" headers="d109284e286 ">
                                          <p><code class="codeph">DB_CREATE_ONLINE_LOG_DEST_</code> <span class="italic">n</span></p>
                                       </td>
                                       <td align="left" valign="top" headers="d109284e443 d109284e289 ">
                                          <p>Oracle托管在线重做日志文件的位置。</p>
                                       </td>
                                       <td align="left" valign="top" headers="d109284e443 d109284e292 ">
                                          <p>可选的</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d109284e456" headers="d109284e286 ">
                                          <p><code class="codeph">DB_RECOVERY_FILE_DEST</code></p>
                                       </td>
                                       <td align="left" valign="top" headers="d109284e456 d109284e289 ">
                                          <p>快速恢复区的位置。</p>
                                       </td>
                                       <td align="left" valign="top" headers="d109284e456 d109284e292 ">
                                          <p>可选的</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d109284e467" headers="d109284e286 ">
                                          <div class="p">Oracle Real Application Cluster（Oracle RAC）参数：<ul style="list-style-type:disc">
                                                <li>
                                                   <p><code class="codeph"><span class="codeinlineitalic">&lt;INSTANCESIDn&gt;</span> 。INSTANCE_NAME</code></p>
                                                </li>
                                                <li>
                                                   <p><code class="codeph"><span class="codeinlineitalic">&lt;INSTANCESIDn&gt;</span> 。INSTANCE_NUMBER</code></p>
                                                </li>
                                                <li>
                                                   <p><code class="codeph"><span class="codeinlineitalic">&lt;INSTANCESIDn&gt;</span> 。线</code></p>
                                                </li>
                                                <li>
                                                   <p><code class="codeph"><span class="codeinlineitalic">&lt;INSTANCESIDn</span> &gt;。UNDO_TABLESPACE</code></p>
                                                </li>
                                                <li>
                                                   <p><code class="codeph"><span class="codeinlineitalic">&lt;INSTANCESIDn</span> &gt;。LOCAL_LISTENER</code></p>
                                                </li>
                                             </ul>
                                          </div>
                                       </td>
                                       <td align="left" valign="top" headers="d109284e467 d109284e289 ">
                                          <p>为每个Oracle RAC数据库实例设置这些参数。</p>
                                       </td>
                                       <td align="left" valign="top" headers="d109284e467 d109284e292 ">
                                          <p>Oracle RAC配置所必需的</p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <!-- class="inftblhruleinformal" -->
                           <div class="infoboxnotealso" id="GUID-31F759B9-862C-4B97-B14B-843E82926074__GUID-DBDEA9A7-DAD6-4B7A-878E-1E208F90D09B">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>有关辅助实例的初始化参数的详细信息，请<a href="../refrn/index.html" target="_blank"><span><cite>参见Oracle数据库参考</cite></span></a></p>
                                 </li>
                                 <li>
                                    <p><a href="rman-duplicating-databases-advanced.html#GUID-30331FAC-15B0-4316-8FAF-C0E1C1E01D65__GUID-9E492CBE-B861-4ACB-AA35-89E96B264B97" title="此表描述了可用于命名重复数据库文件的格式">表26-1</a>了解命名重复文件的选项</p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-556C92BF-807D-483C-9CAB-A0E7B3ACA6A8" name="GUID-556C92BF-807D-483C-9CAB-A0E7B3ACA6A8"></a><h5 id="BRADV-GUID-556C92BF-807D-483C-9CAB-A0E7B3ACA6A8" class="sect5"><span class="enumeration_section">25.1.2.2</span>关于在活动数据库复制期间并行化备份集的创建</h5>
                     <div>
                        <p>RMAN多节备份通过并行备份非常大的数据文件来提供更快的备份性能。创建多个备份片段，并为每个备份片段写入单独的通道。从Oracle Database 12 <span class="italic">c</span>第1版（12.1）开始，您可以使用多节备份集来传输执行活动数据库复制所需的源文件。
                        </p>
                        <p>使用<code class="codeph">DUPLICATE</code>命令中的<code class="codeph">SECTION SIZE</code>选项创建多节备份集。以下命令创建多节备份集，每个备份片的大小为400MB。假设已使用网络服务名称建立与目标数据库和辅助实例的连接。
                        </p><pre class="pre codeblock"><code>重复目标数据库到活动数据库密码文件部分400M的dup_db;</code></pre></div>
                  </div>
                  <div class="sect4"><a id="GUID-73681CB6-5AEB-40FA-923F-D59DF1A40EAF" name="GUID-73681CB6-5AEB-40FA-923F-D59DF1A40EAF"></a><h5 id="BRADV-GUID-73681CB6-5AEB-40FA-923F-D59DF1A40EAF" class="sect5"><span class="enumeration_section">25.1.2.3</span>关于在活动数据库复制期间加密备份集</h5>
                     <div>
                        <p>RMAN可以使用备份集来传输需要复制的源数据库文件。备份集通过网络传输到辅助数据库。可以加密备份集以提高安全性。在<code class="codeph">DUPLICATE</code>命令之前使用<code class="codeph">SET ENCRYPTION ALGORITHM</code>命令指定加密算法。
                        </p>
                        <p>在执行活动数据库复制之前，请使用以下技术之一来确保加密成功：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>如果源数据库使用透明加密，则必须共享包含源数据库和辅助实例之间的加密密钥的Oracle软件密钥库，如<a href="rman-duplicating-databases.html#GUID-E016C2DC-1774-4057-8EAF-3F69E9A6322A" title="如果在源数据库上配置了透明加密，则必须确保源数据库中的Oracle软件密钥库可用于辅助实例。将密钥库从源数据库手动复制到目标主机。">使Oracle密钥库可用于目标主机中所述</a> 。
                              </p>
                           </li>
                           <li>
                              <p>如果源数据库使用密码加密，则必须指定用于加密备份的密码。</p>
                              <div class="p">以下命令设置加密密码（其中<code class="codeph"><span class="codeinlineitalic">password</span></code>是您输入的实际密码的占位符）：<pre class="pre codeblock"><code>按<span class="italic">密码</span>识别设置ENCRYPTION;</code></pre></div>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-DE4FBE49-E93B-4A47-9D47-19C1378D827F" name="GUID-DE4FBE49-E93B-4A47-9D47-19C1378D827F"></a><h5 id="BRADV-GUID-DE4FBE49-E93B-4A47-9D47-19C1378D827F" class="sect5"><span class="enumeration_section">25.1.2.4</span>关于在活动数据库复制期间压缩备份集</h5>
                     <div>
                        <p>使用备份集执行活动数据库复制时，RMAN可以使用备份压缩来最小化用于将文件从源数据库传输到目标主机的备份集的大小。因此，压缩可以增强复制过程的性能。</p>
                        <p>从Oracle Database 12 <span class="italic">c</span>第1版（12.1）开始，支持压缩用于活动数据库复制的备份集。
                        </p>
                        <p>使用<code class="codeph">DUPLICATE</code>命令的<code class="codeph">USING COMPRESSED BACKUPSET</code>子句压缩包含执行活动数据库复制所需数据的备份集。以下命令使用压缩备份集执行活动数据库复制。假设已使用网络服务名称建立与目标数据库和辅助实例的连接。
                        </p><pre class="pre codeblock"><code>使用压缩的BACKUPSET将重复目标数据库复制到活动数据库密码文件中的dup_db;</code></pre></div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-F700603C-44EF-422F-8770-E7AA5BE33C87" name="GUID-F700603C-44EF-422F-8770-E7AA5BE33C87"></a><h4 id="BRADV-GUID-F700603C-44EF-422F-8770-E7AA5BE33C87" class="sect4"><span class="enumeration_section">25.1.3</span>数据库复制的类型</h4>
                  <div>
                     <p>RMAN使您可以执行两种主要类型的数据库复制。</p>
                     <div class="p">它们包括以下内容：<ul style="list-style-type:disc">
                           <li>
                              <p>基于备份的复制</p>
                              <p>通过使用预先存在的RMAN备份或源数据库的副本来创建重复数据库。您可以使用不同的技术通过使用基于备份的复制来复制数据库。</p>
                           </li>
                           <li>
                              <p>活动数据库重复</p>
                              <p>通过将实时源数据库通过网络复制到辅助实例来创建重复数据库。可以使用备份集或映像副本执行复制。</p>
                           </li>
                        </ul>
                     </div>
                     <p>您可以使用任何类型的复制将数据库复制到本地主机或远程主机。</p>
                     <div class="infoboxnotealso" id="GUID-F700603C-44EF-422F-8770-E7AA5BE33C87__GUID-B6ADE955-33CE-4A37-89DD-E077DEEDBBC0">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="rman-duplicating-databases.html#GUID-5E066C8F-80C2-4C2D-911B-31E4CFC5B462" title="有多种技术可用于执行基于备份的复制。">执行基于备份的复制的技术</a></p>
                           </li>
                           <li>
                              <p><a href="rman-duplicating-databases.html#GUID-61834C69-9BC4-44D7-A8CC-437A2673BC32" title="有多种技术可用于执行活动数据库复制。">执行主动数据库复制的技术</a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-5D9CDA5A-203F-4E95-90A8-96898A2C95F1" name="GUID-5D9CDA5A-203F-4E95-90A8-96898A2C95F1"></a><h5 id="BRADV-GUID-5D9CDA5A-203F-4E95-90A8-96898A2C95F1" class="sect5"><span class="enumeration_section">25.1.3.1</span>基于备份的复制概述</h5>
                     <div>
                        <p>在基于备份的复制中，源数据库的预先存在的RMAN备份用于创建重复数据库。可以使用完全备份和增量备份的组合。RMAN根据<code class="codeph">UNTIL</code>条件确定必须使用哪些备份和归档重做日志文件。
                        </p>
                        <p>在基于备份的复制中，复制数据库的主要工作由辅助通道执行。您可以按<a href="rman-duplicating-databases.html#GUID-F2ED1190-E3BF-4898-BDCC-B9FF0500C76B" title="数据库复制的主要工作由RMAN通道执行。每个通道对应于执行复制任务的Oracle数据库服务器会话。根据复制技术，RMAN使用辅助通道或目标通道。">配置RMAN通道以在复制中使用中</a>所述配置其他通道。
                        </p>
                        <p>基于备份的复制可用于以下场景：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>与源数据库的连接不可用，但可以使用源数据库的备份。</p>
                           </li>
                           <li>
                              <p>源主机和目标主机之间的网络带宽是约束。</p>
                              <p>当源主机和目标主机之间的网络带宽有限时，使用活动数据库复制可能会导致性能降低。例如，源主机和目标主机位于不同的地理位置，并通过WAN连接。在这种情况下，最好使用基于备份的复制。</p>
                              <div class="infoboxnotealso" id="GUID-5D9CDA5A-203F-4E95-90A8-96898A2C95F1__GUID-49153C64-207E-4B38-A099-3E0FE49059D9">
                                 <p class="notep1">也可以看看：</p>
                                 <p><a href="rman-duplicating-databases.html#GUID-2D2ED1CD-2582-4B4E-8363-681C59DB331F" title="活动数据库复制不需要备份源数据库。它通过网络将数据库文件复制到辅助实例，将实时源数据库复制到目标主机。RMAN可以将所需文件复制为映像副本或备份集。">活动数据库复制概述，</a>了解首选活动数据库复制的方案的详细信息。
                                 </p>
                              </div>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-5E066C8F-80C2-4C2D-911B-31E4CFC5B462" name="GUID-5E066C8F-80C2-4C2D-911B-31E4CFC5B462"></a><h5 id="BRADV-GUID-5E066C8F-80C2-4C2D-911B-31E4CFC5B462" class="sect5"><span class="enumeration_section">25.1.3.2</span>执行基于备份的复制的技术</h5>
                     <div>
                        <p>有多种技术可用于执行基于备份的复制。</p>
                        <p>使用以下互斥技术之一执行基于备份的复制：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="rman-duplicating-databases.html#GUID-0497F367-261D-4863-912B-91138A72A6B0" title="在此方法中，您必须以TARGET身份连接到源数据库，并将AUXILIARY连接到辅助实例。">基于备份的目标连接复制</a></p>
                           </li>
                           <li>
                              <p><a href="rman-duplicating-databases.html#GUID-D38B96D6-72C5-4760-8253-7D5C474C7914" title="在此方法中，您将CATALOG连接到恢复目录数据库，并作为AUXILIARY连接到辅助实例。">没有目标连接的基于备份的复制</a></p>
                           </li>
                           <li>
                              <p><a href="rman-duplicating-databases.html#GUID-75463819-F48F-442F-904B-1B4CDB3711CC" title="在此方法中，没有与源数据库或恢复目录的连接。">没有目标数据库和恢复目录连接的基于备份的复制</a></p>
                           </li>
                        </ul>
                     </div>
                     <div class="sect5"><a id="GUID-0497F367-261D-4863-912B-91138A72A6B0" name="GUID-0497F367-261D-4863-912B-91138A72A6B0"></a><h6 id="BRADV-GUID-0497F367-261D-4863-912B-91138A72A6B0" class="sect6"><span class="enumeration_section">25.1.3.2.1</span>使用目标连接进行基于备份的复制</h6>
                        <div>
                           <p>在此方法中，您必须以<code class="codeph">TARGET</code>身份连接到源数据库，并将<code class="codeph">AUXILIARY</code>连接到辅助实例。
                           </p>
                           <p>下面的<a href="rman-duplicating-databases.html#GUID-0497F367-261D-4863-912B-91138A72A6B0__GUID-ED0E87AC-91FE-4E74-91A0-C8EC3F26A7E2">图25-1</a>说明<span class="italic">了</span>使用目标连接的基于备份的复制。您可以连接到恢复目录，但它不是必需的（不在图中）。RMAN使用源数据库的控制文件中的元数据来确定必须使用哪些备份或副本来执行复制。
                           </p>
                           <p>目标主机必须能够访问创建重复数据库所需的RMAN备份。</p>
                           <div class="figure" id="GUID-0497F367-261D-4863-912B-91138A72A6B0__GUID-ED0E87AC-91FE-4E74-91A0-C8EC3F26A7E2">
                              <p class="titleinfigure">图25-1使用目标连接进行基于备份的复制</p><img src="img/bradv047.gif" alt="下面是图25-1的描述" title="下面是图25-1的描述" longdesc="img_text/bradv047.html"><br><a href="img_text/bradv047.html">“图25-1使用目标连接进行基于备份的复制”的说明</a></div>
                           <!-- class="figure" -->
                        </div>
                     </div>
                     <div class="sect5"><a id="GUID-D38B96D6-72C5-4760-8253-7D5C474C7914" name="GUID-D38B96D6-72C5-4760-8253-7D5C474C7914"></a><h6 id="BRADV-GUID-D38B96D6-72C5-4760-8253-7D5C474C7914" class="sect6"><span class="enumeration_section">25.1.3.2.2</span>没有目标连接的基于备份的复制</h6>
                        <div>
                           <p>在此方法中，您将<code class="codeph">CATALOG</code>连接到恢复目录数据库，并作为<code class="codeph">AUXILIARY</code>连接到辅助实例。
                           </p>
                           <p><a href="rman-duplicating-databases.html#GUID-D38B96D6-72C5-4760-8253-7D5C474C7914__GUID-4A630386-8BE8-43AE-89BA-A0A2A3155F9A">图25-2</a>说明了<span class="italic">没有</span>目标连接的基于备份的复制。RMAN使用恢复目录中的元数据来确定执行复制所需的备份或副本。
                           </p>
                           <p>目标主机必须能够访问创建重复数据库所需的RMAN备份。</p>
                           <div class="figure" id="GUID-D38B96D6-72C5-4760-8253-7D5C474C7914__GUID-4A630386-8BE8-43AE-89BA-A0A2A3155F9A">
                              <p class="titleinfigure">图25-2没有目标连接的基于备份的复制</p><img src="img/bradv046.gif" alt="下面是图25-2的描述" title="下面是图25-2的描述" longdesc="img_text/bradv046.html"><br><a href="img_text/bradv046.html">“图25-2没有目标连接的基于备份的复制”的描述</a></div>
                           <!-- class="figure" -->
                        </div>
                     </div>
                     <div class="sect5"><a id="GUID-75463819-F48F-442F-904B-1B4CDB3711CC" name="GUID-75463819-F48F-442F-904B-1B4CDB3711CC"></a><h6 id="BRADV-GUID-75463819-F48F-442F-904B-1B4CDB3711CC" class="sect6"><span class="enumeration_section">25.1.3.2.3</span>没有目标数据库和恢复目录连接的基于备份的复制</h6>
                        <div>
                           <p>在此方法中，没有与源数据库或恢复目录的连接。</p>
                           <p><a href="rman-duplicating-databases.html#GUID-75463819-F48F-442F-904B-1B4CDB3711CC__GUID-713F546E-5F30-492B-8464-02EEFC94BD2F">图25-3</a>说明了基于备份的复制， <span class="italic">没有</span>与目标或恢复目录数据库实例的连接。通过连接到辅助实例并使用存储在目标主机上的磁盘位置中的源数据库的备份或副本来执行复制。RMAN从<code class="codeph">DUPLICATE</code>命令的<code class="codeph">BACKUP LOCATION</code>子句获取有关备份和副本所在<code class="codeph">BACKUP LOCATION</code>元数据。
                           </p>
                           <p>必须为目标主机提供包含复制所需的所有备份或副本的磁盘备份位置。</p>
                           <div class="infoboxnote" id="GUID-75463819-F48F-442F-904B-1B4CDB3711CC__GUID-EAE3ABC8-5F7C-4E35-AFCA-480DBE1607BB">
                              <p class="notep1">注意：</p>
                              <p>存储在磁带设备上的备份不支持此方法。</p>
                           </div>
                           <div class="figure" id="GUID-75463819-F48F-442F-904B-1B4CDB3711CC__GUID-713F546E-5F30-492B-8464-02EEFC94BD2F">
                              <p class="titleinfigure">图25-3没有目标连接或恢复目录连接的基于备份的复制</p><img src="img/bradv048.gif" alt="下面是图25-3的描述" title="下面是图25-3的描述" longdesc="img_text/bradv048.html"><br><a href="img_text/bradv048.html">“图25-3没有目标连接或恢复目录连接的基于备份的复制”的描述</a></div>
                           <!-- class="figure" -->
                        </div>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-2D2ED1CD-2582-4B4E-8363-681C59DB331F" name="GUID-2D2ED1CD-2582-4B4E-8363-681C59DB331F"></a><h5 id="BRADV-GUID-2D2ED1CD-2582-4B4E-8363-681C59DB331F" class="sect5"><span class="enumeration_section">25.1.3.3</span>活动数据库复制概述</h5>
                     <div>
                        <p>活动数据库复制不需要备份源数据库。它通过网络将数据库文件复制到辅助实例，将实时源数据库复制到目标主机。RMAN可以将所需文件复制为映像副本或备份集。</p>
                        <p>对于活动数据库复制，使用的复制技术确定哪个通道执行主要工作。使用备份集执行活动数据库复制时，复制的主要工作由辅助通道执行。使用图像副本时，主要工作由目标通道执行。</p>
                        <p>要执行活动数据库复制，需要连接到目标数据库。Oracle建议您一般使用活动数据库复制，除非源主机和目标主机之间的网络带宽是约束。活动数据库复制需要最少的设置，并且执行起来更简单。</p>
                        <div class="infoboxnote" id="GUID-2D2ED1CD-2582-4B4E-8363-681C59DB331F__GUID-145E22B6-1F08-4551-917B-A14459D5F571">
                           <p class="notep1">注意：</p>
                           <p>对于活动数据库复制，源数据库必须使用服务器参数文件。</p>
                        </div>
                        <div class="p">使用备份集的活动数据库复制可能比使用映像副本更受欢迎的一些方案是：<ul style="list-style-type:disc">
                              <li>
                                 <p>您希望在复制数据库时使用多节备份，压缩或加密。</p>
                              </li>
                              <li>
                                 <p>源数据库没有足够的网络资源来将所需的数据库文件传输到重复数据库。</p>
                              </li>
                              <li>
                                 <p>您希望最小化复制过程使用的资源。</p>
                                 <p>使用备份集的活动数据库复制使用源数据库上的最少资源。</p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-61834C69-9BC4-44D7-A8CC-437A2673BC32" name="GUID-61834C69-9BC4-44D7-A8CC-437A2673BC32"></a><h5 id="BRADV-GUID-61834C69-9BC4-44D7-A8CC-437A2673BC32" class="sect5"><span class="enumeration_section">25.1.3.4</span>执行活动数据库复制的技术</h5>
                     <div>
                        <p>有多种技术可用于执行活动数据库复制。</p>
                        <p>使用两种互斥方法之一来执行活动数据库复制：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="rman-duplicating-databases.html#GUID-F446FBAC-3BEE-474A-B421-1BE1F926BB9A" title="在此方法中，RMAN作为TARGET连接到源数据库，并作为AUXILIARY连接到辅助实例。然后，源数据库通过网络将所需的数据库文件传输到辅助实例。此方法称为基于推送的活动数据库复制方法。">使用映像副本进行活动数据库复制</a></p>
                           </li>
                           <li>
                              <p><a href="rman-duplicating-databases.html#GUID-685561E7-C3A5-4428-93F1-75846459CC74" title="使用备份集执行活动数据库复制也称为基于拉取的活动数据库复制方法。">使用备份集进行活动数据库复制</a></p>
                           </li>
                        </ul>
                     </div>
                     <div class="sect5"><a id="GUID-F446FBAC-3BEE-474A-B421-1BE1F926BB9A" name="GUID-F446FBAC-3BEE-474A-B421-1BE1F926BB9A"></a><h6 id="BRADV-GUID-F446FBAC-3BEE-474A-B421-1BE1F926BB9A" class="sect6"><span class="enumeration_section">25.1.3.4.1</span>使用映像副本进行活动数据库复制</h6>
                        <div>
                           <p>在此方法中，RMAN作为<code class="codeph">TARGET</code>连接到源数据库，并作为<code class="codeph">AUXILIARY</code>连接到辅助实例。然后，源数据库通过网络将所需的数据库文件传输到辅助实例。此方法称为<span class="bold">基于推送</span>的活动数据库复制<span class="bold">方法</span> 。
                           </p>
                           <p><a href="rman-duplicating-databases.html#GUID-F446FBAC-3BEE-474A-B421-1BE1F926BB9A__GUID-36527810-FCA2-45AC-B739-B9F142F48C37">图25-4</a>说明了使用映像副本的活动数据库复制。使用映像副本进行活动数据库复制可能需要源数据库上的其他资源。您可以配置其他目标通道以提高复制性能，如<a href="rman-duplicating-databases.html#GUID-F2ED1190-E3BF-4898-BDCC-B9FF0500C76B" title="数据库复制的主要工作由RMAN通道执行。每个通道对应于执行复制任务的Oracle数据库服务器会话。根据复制技术，RMAN使用辅助通道或目标通道。">配置RMAN通道以在复制中使用中所述</a> 。
                           </p>
                           <div class="figure" id="GUID-F446FBAC-3BEE-474A-B421-1BE1F926BB9A__GUID-36527810-FCA2-45AC-B739-B9F142F48C37">
                              <p class="titleinfigure">图25-4使用映像副本进行活动数据库复制</p><img src="img/bradv045.gif" alt="下面是图25-4的描述" title="下面是图25-4的描述" longdesc="img_text/bradv045.html"><br><a href="img_text/bradv045.html">“图25-4使用映像副本进行活动数据库复制”的说明</a></div>
                           <!-- class="figure" -->
                        </div>
                     </div>
                     <div class="sect5"><a id="GUID-685561E7-C3A5-4428-93F1-75846459CC74" name="GUID-685561E7-C3A5-4428-93F1-75846459CC74"></a><h6 id="BRADV-GUID-685561E7-C3A5-4428-93F1-75846459CC74" class="sect6"><span class="enumeration_section">25.1.3.4.2</span>使用备份集进行活动数据库复制</h6>
                        <div>
                           <p>使用备份集执行活动数据库复制也称为<span class="bold">基于拉取</span>的活动数据库复制<span class="bold">方法</span> 。
                           </p>
                           <p>在此方法中，RMAN作为<code class="codeph">TARGET</code>连接到源数据库，并作为<code class="codeph">AUXILIARY</code>连接到辅助实例。然后，辅助实例通过Oracle Net Services连接到源数据库，并通过网络从源数据库检索所需的数据库文件。<a href="rman-duplicating-databases.html#GUID-685561E7-C3A5-4428-93F1-75846459CC74__GUID-9CB71F93-1C8F-4C89-846A-4CBA251172CB">图25-5</a>说明了使用备份集的活动数据库复制。
                           </p>
                           <div class="figure" id="GUID-685561E7-C3A5-4428-93F1-75846459CC74__GUID-9CB71F93-1C8F-4C89-846A-4CBA251172CB">
                              <p class="titleinfigure">图25-5使用备份集进行活动数据库复制</p><img src="img/bradv045a.gif" alt="下面是图25-5的描述" title="下面是图25-5的描述" longdesc="img_text/bradv045a.html"><br><a href="img_text/bradv045a.html">“图25-5使用备份集进行活动数据库复制”的说明</a></div>
                           <!-- class="figure" -->
                           <div class="infoboxnote" id="GUID-685561E7-C3A5-4428-93F1-75846459CC74__GUID-F75B6170-09B6-411F-B9D5-73665F610975">
                              <p class="notep1">注意：</p>
                              <p>从Oracle Database 12 <span class="italic">c</span>第1版（12.1）开始，可以使用备份集执行活动数据库复制。
                              </p>
                           </div>
                           <p>使用备份集进行活动数据库复制具有以下优点：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>RMAN可以使用未使用的块压缩，从而减少必须通过网络传输的备份的大小。</p>
                              </li>
                              <li>
                                 <p>可以使用多节备份在源数据库上并行创建备份集。</p>
                              </li>
                              <li>
                                 <p>可以加密在源数据库上创建的备份集。</p>
                              </li>
                           </ul>
                           <div class="infoboxnotealso" id="GUID-685561E7-C3A5-4428-93F1-75846459CC74__GUID-986939CE-F105-4D41-80D0-70BD993768C6">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><a href="rman-duplicating-databases.html#GUID-DE4FBE49-E93B-4A47-9D47-19C1378D827F" title="使用备份集执行活动数据库复制时，RMAN可以使用备份压缩来最小化用于将文件从源数据库传输到目标主机的备份集的大小。因此，压缩可以增强复制过程的性能。">关于在活动数据库复制期间压缩备份集</a></p>
                                 </li>
                                 <li>
                                    <p><a href="rman-duplicating-databases.html#GUID-556C92BF-807D-483C-9CAB-A0E7B3ACA6A8" title="RMAN多节备份通过并行备份非常大的数据文件来提供更快的备份性能。创建多个备份片段，并为每个备份片段写入单独的通道。从Oracle Database 12c第1版（12.1）开始，您可以使用多节备份集来传输执行活动数据库复制所需的源文件。">关于在活动数据库复制期间并行化备份集的创建</a></p>
                                 </li>
                                 <li>
                                    <p><a href="rman-duplicating-databases.html#GUID-73681CB6-5AEB-40FA-923F-D59DF1A40EAF" title="RMAN可以使用备份集来传输需要复制的源数据库文件。备份集通过网络传输到辅助数据库。可以加密备份集以提高安全性。在DUPLICATE命令之前使用SET ENCRYPTION ALGORITHM命令指定加密算法。">关于在活动数据库复制期间加密备份集</a></p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-22CBD826-566F-4E3A-9FBE-538585CB9D6A" name="GUID-22CBD826-566F-4E3A-9FBE-538585CB9D6A"></a><h5 id="BRADV-GUID-22CBD826-566F-4E3A-9FBE-538585CB9D6A" class="sect5"><span class="enumeration_section">25.1.3.5</span>确定备份集或映像副本是否用于活动数据库复制的因素</h5>
                     <div>
                        <p>RMAN可以使用备份集或映像副本来执行活动数据库复制。</p>
                        <div class="p">当使用网络服务名称建立与目标数据库的连接并满足以下任一条件时，RMAN使用备份集执行活动数据库复制：<ul style="list-style-type:disc">
                              <li>
                                 <p><code class="codeph">DUPLICATE ...FROM ACTIVE DATABASE</code>命令包含<code class="codeph">USING BACKUPSET</code> ， <code class="codeph">USING COMPRESSED BACKUPSET</code>或<code class="codeph">SECTION SIZE</code>子句。
                                 </p>
                              </li>
                              <li>
                                 <p>分配的辅助信道的数量等于或大于分配的目标信道的数量。</p>
                              </li>
                           </ul>
                        </div>
                        <p>否则，RMAN使用映像副本执行活动数据库复制。</p>
                        <div class="infoboxnote" id="GUID-22CBD826-566F-4E3A-9FBE-538585CB9D6A__GUID-FB4DF220-EF91-4C48-B589-C5C0617985E6">
                           <p class="notep1">注意：</p>
                           <p>Oracle建议您使用备份集来执行活动数据库复制。</p>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-DC0A075D-82E3-4EC9-9FCF-51DB99F3EA03" name="GUID-DC0A075D-82E3-4EC9-9FCF-51DB99F3EA03"></a><h4 id="BRADV-GUID-DC0A075D-82E3-4EC9-9FCF-51DB99F3EA03" class="sect4"><span class="enumeration_section">25.1.4</span> RMAN如何复制数据库</h4>
                  <div>
                     <p>RMAN执行一组自动化步骤来复制数据库。</p>
                     <div class="section">步骤包括以下内容：</div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>如果满足以下条件，则为辅助实例创建默认服务器参数文件：</span><div>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>复制不涉及备用数据库</p>
                                 </li>
                                 <li>
                                    <p>服务器参数文件未被复制</p>
                                 </li>
                                 <li>
                                    <p>辅助实例未使用服务器参数文件启动</p>
                                 </li>
                              </ul>
                           </div>
                        </li>
                        <li class="stepexpand"><span>从活动数据库中备份或复制满足<code class="codeph">UNTIL</code>子句要求的最新控制文件。</span></li>
                        <li class="stepexpand"><span>使用还原的控制文件或从活动数据库复制的备份控制文件来装入辅助实例。</span></li>
                        <li class="stepexpand"><span>使用RMAN存储库中的元数据选择用于将数据文件还原到辅助实例的备份。此步骤适用于基于备份的复制。</span></li>
                        <li class="stepexpand"><span>将重复的数据库文件复制到目标主机，并使用增量备份和归档的重做日志文件将它们还原到非当前时间点。</span></li>
                        <li class="stepexpand"><span>在<code class="codeph">NOMOUNT</code>模式下关闭并重新启动目标主机上的辅助数据库实例。</span></li>
                        <li class="stepexpand"><span>创建一个新的控制文件，然后在数据文件中创建并存储新的DBID。</span></li>
                        <li class="stepexpand"><span>使用<code class="codeph">RESETLOGS</code>选项打开重复数据库，并为新数据库创建联机重做日志。如果您不想打开重复数据库，请使用<code class="codeph">DUPLICATE</code>语句中的<code class="codeph">NOOPEN</code>子句，如<a href="rman-duplicating-databases.html#GUID-608FAE46-DC28-43F3-83F6-0DEB73BB59ED" title="使用RMAN DUPLICATE命令时，将创建重复数据库并以RESETLOGS模式打开。您可以使用DUPLICATE命令中的NOOPEN子句指定不能打开重复数据库。">确定重复数据库的状态中所述</a> 。</span></li>
                     </ol>
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-DC0A075D-82E3-4EC9-9FCF-51DB99F3EA03__GUID-17F569C9-534E-4733-B101-0F736C307FCC">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="../rcmrf/DUPLICATE.html#GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4" target="_blank"><span><cite>Oracle数据库备份和恢复参考中</cite></span></a>的<code class="codeph">DUPLICATE</code>条目，其中包含将哪些文件复制到重复数据库的完整列表</p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-0667FB47-1E7D-42E8-9342-7E1DE3FF150F" name="GUID-0667FB47-1E7D-42E8-9342-7E1DE3FF150F"></a><h4 id="BRADV-GUID-0667FB47-1E7D-42E8-9342-7E1DE3FF150F" class="sect4"><span class="enumeration_section">25.1.5</span>重复数据库的内容</h4>
                  <div>
                     <p>重复数据库可以包含与源数据库相同的内容，也可以只包含源数据库中表空间的子集。</p>
                     <p>例如，您可以使用<code class="codeph">DUPLICATE</code>命令的<code class="codeph">TABLESPACE</code>选项仅复制指定的表空间，或使用<code class="codeph">SKIP READONLY</code>选项从重复数据库中排除只读表空间。
                     </p>
                  </div>
                  <div class="sect4"><a id="GUID-9B731309-38CC-4B56-8CB7-35BD7F1CE9B5" name="GUID-9B731309-38CC-4B56-8CB7-35BD7F1CE9B5"></a><h5 id="BRADV-GUID-9B731309-38CC-4B56-8CB7-35BD7F1CE9B5" class="sect5"><span class="enumeration_section">25.1.5.1</span>关于复制源数据库的子集</h5>
                     <div>
                        <p><code class="codeph">DUPLICATE</code>命令包含一些子句，使您可以复制整个源数据库的子集。
                        </p>
                        <p>并不总是需要复制数据库的所有表空间。例如，您可能计划生成仅需要源数据库中的一部分表空间的报表。</p>
                        <div class="p">下表说明了<code class="codeph">DUPLICATE</code>命令选项，用于指定重复数据库的表空间子集：<div class="tblformal" id="GUID-9B731309-38CC-4B56-8CB7-35BD7F1CE9B5__GUID-CE423060-0BD9-4152-9025-A4EC4B9DE3A2">
                              <p class="titleintable">表25-2为重复数据库指定表空间子集的选项</p>
                              <table cellpadding="4" cellspacing="0" class="Formal" title="为重复数据库指定表空间子集的选项" border="1" summary="This table describes the options used to duplicate a subset of the source database files" frame="hsides" rules="rows">
                                 <thead>
                                    <tr align="left" valign="top">
                                       <th align="left" valign="bottom" id="d109284e1211"><span class="bold">DUPLICATE选项</span></th>
                                       <th align="left" valign="bottom" id="d109284e1214"><span class="bold">说明</span></th>
                                    </tr>
                                 </thead>
                                 <tbody>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d109284e1219" headers="d109284e1211 "><code class="codeph">跳过READONLY</code></td>
                                       <td align="left" valign="top" headers="d109284e1219 d109284e1214 ">从重复数据库中排除只读表空间的数据文件。</td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d109284e1225" headers="d109284e1211 "><code class="codeph">SKIP TABLESPACE'tablespace_name <span class="codeinlineitalic">'，...</span></code></td>
                                       <td align="left" valign="top" headers="d109284e1225 d109284e1214 ">从重复数据库中排除指定的表空间。您不能排除<code class="codeph">SYSTEM</code>和<code class="codeph">SYSAUX</code>表空间，具有<code class="codeph">SYS</code>对象的表空间，撤消表空间，具有还原段的表空间，具有实例化视图的表空间或表空间，使得复制的表空间不是自包含的。
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d109284e1242" headers="d109284e1211 "><code class="codeph">TABLESPACE'tablespace_name <span class="codeinlineitalic">'，...</span></code></td>
                                       <td align="left" valign="top" headers="d109284e1242 d109284e1214 ">自动包含<code class="codeph">SYSTEM</code> ， <code class="codeph">SYSAUX</code>和undo表空间。包含的表空间必须是自包含的，并且生成的跳过表空间不得包含<code class="codeph">SYS</code>对象或物化视图。
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <!-- class="inftblhruleinformal" -->
                        </div>
                        <div class="infoboxnote" id="GUID-9B731309-38CC-4B56-8CB7-35BD7F1CE9B5__GUID-252B8BA8-EA10-4206-ADC1-357E32F5ED1C">
                           <p class="notep1">注意：</p>
                           <p>如果在<span class="italic">没有</span>目标连接或<span class="italic">没有</span>目标和恢复目录连接的<span class="italic">情况下</span>在基于备份的复制中排除表空间，则RMAN具有特殊的先决条件。有关详细信息，请参阅<a href="../rcmrf/DUPLICATE.html#GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4" target="_blank"><span><cite>Oracle数据库备份和恢复参考中</cite></span></a> <code class="codeph">DUPLICATE</code>命令的“先决条件”部分。
                           </p>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-89053F52-4EAF-424E-B106-3ABFA076521C" name="GUID-89053F52-4EAF-424E-B106-3ABFA076521C"></a><h4 id="BRADV-GUID-89053F52-4EAF-424E-B106-3ABFA076521C" class="sect4"><span class="enumeration_section">25.1.6</span>关于数据库复制的目标主机</h4>
                  <div>
                     <p>RMAN在指定的目标主机上创建重复数据库。目标主机可以与源主机相同或不同。</p>
                     <p>当同一台计算机用作源主机和目标主机时，复制称为复制到本地主机。当源主机和目标主机位于不同的计算机上时，复制称为复制到远程主机。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-89053F52-4EAF-424E-B106-3ABFA076521C__GUID-27A19451-DF63-401C-B6EB-4DA5B4307866">关于将数据库复制到本地主机</p>
                        <p>将数据库复制到本地主机时，必须使用与源数据库不同的目录结构存储重复的数据库文件。例如，如果源数据库文件存储在<code class="codeph">/disk1/oracle</code>目录中，则重复的数据库文件可以存储在<code class="codeph">/disk2/oracle</code>目录中。重复的数据库文件名可以与源数据库的文件名相同或不同。在<span class="q">“</span>为重复数据库<span class="q"><a href="rman-duplicating-databases.html#GUID-21627543-AD37-4144-9DEF-2C5AE9CC745C" title="根据您选择的方法，RMAN可以自动生成文件名或使用重复数据库文件的特定名称。数据库文件包括数据文件，控制文件，联机重做日志文件和临时文件。">生成数据库文件名的方法</a> ”</span>中描述了为重复数据库文件指定备用名称的技术。
                        </p>
                        <p></p>
                        <div class="infoboxnote" id="GUID-89053F52-4EAF-424E-B106-3ABFA076521C__GUID-1B01EF0A-823B-45FE-A620-75E4DDEE6477">
                           <p class="notep1">警告：</p>
                           <p>复制到本地主机时使用<code class="codeph">NOFILENAMECHECK</code>覆盖源数据库文件。
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-89053F52-4EAF-424E-B106-3ABFA076521C__GUID-F7E90131-287B-46B1-8EEF-8435C2CAE36C">关于将数据库复制到远程主机</p>
                        <div class="p">将数据库复制到远程主机时，重复的数据库文件可以使用与源数据库相同的目录结构和文件名，也可以使用不同的目录结构和文件名。如果选择以不同方式命名重复数据库文件，则必须使用“ <a href="rman-duplicating-databases.html#GUID-21627543-AD37-4144-9DEF-2C5AE9CC745C" title="根据您选择的方法，RMAN可以自动生成文件名或使用重复数据库文件的特定名称。数据库文件包括数据文件，控制文件，联机重做日志文件和临时文件。">为重复数据库生成数据库文件名的方法”中</a>所述的技术，以指定重复数据库文件的命名方式。
                           <div class="infoboxnote" id="GUID-89053F52-4EAF-424E-B106-3ABFA076521C__GUID-E94F55F0-A0D6-4D34-A48A-95FFACF69413">
                              <p class="notep1">注意：</p>
                              <p>复制到远程主机需要密码文件和与辅助实例的Oracle Net Services连接。</p>
                           </div>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-102FF47A-63D1-45CA-8C9F-4257E16BCA52" name="GUID-102FF47A-63D1-45CA-8C9F-4257E16BCA52"></a><h4 id="BRADV-GUID-102FF47A-63D1-45CA-8C9F-4257E16BCA52" class="sect4"><span class="enumeration_section">25.1.7</span>关于重复数据库文件名</h4>
                  <div>
                     <p>根据使用的目标主机和复制方案，重复的数据库文件可以使用与源数据库相同的名称或不同的名称。数据库文件包括数据文件，控制文件，联机重做日志文件和临时文件。</p>
                     <p>如果选择以不同方式命名重复的数据库文件，则必须指定用于命名这些文件的策略。</p>
                     <div class="infoboxnotealso" id="GUID-102FF47A-63D1-45CA-8C9F-4257E16BCA52__GUID-DAD5663C-5666-45C5-966D-A62BAEF95A8B">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="rman-duplicating-databases.html#GUID-5293AB47-97AA-45A2-9D64-BA1287D3F7B9" title="复制数据库时，RMAN会为重复数据库中的数据库文件生成名称。这包括控制文件，数据文件，临时文件和联机重做日志文件。">选择命名重复数据库文件的策略</a></p>
                           </li>
                           <li>
                              <p><a href="rman-duplicating-databases.html#GUID-89053F52-4EAF-424E-B106-3ABFA076521C" title="RMAN在指定的目标主机上创建重复数据库。目标主机可以与源主机相同或不同。">关于数据库复制的目标主机</a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-7154AD5C-A192-4502-B3AC-FCD6DB3CDEAD" name="GUID-7154AD5C-A192-4502-B3AC-FCD6DB3CDEAD"></a><h4 id="BRADV-GUID-7154AD5C-A192-4502-B3AC-FCD6DB3CDEAD" class="sect4"><span class="enumeration_section">25.1.8</span>关于将数据库复制到过去的时间点</h4>
                  <div>
                     <p>您可以在<code class="codeph">DUPLICATE</code>命令中使用子句将数据库复制到过去的时间点。
                     </p>
                     <div class="p">默认情况下， <code class="codeph">DUPLICATE</code>命令使用目标数据库的最新备份创建重复数据库，然后执行恢复到增量备份和归档重做日志中包含的最新一致点。但是，您可以使用以下方法之一将重复数据库恢复到过去的时间点：<ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">DUPLICATE … UNTIL</code>命令</p>
                           </li>
                           <li>
                              <p>在<code class="codeph">DUPLICATE</code>命令之前<code class="codeph">SET UNTIL</code>命令</p>
                           </li>
                        </ul>
                        <div class="infoboxnotealso" id="GUID-7154AD5C-A192-4502-B3AC-FCD6DB3CDEAD__GUID-A8702034-6E19-48A2-97BC-F134DA79E99C">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="../rcmrf/DUPLICATE.html#RCMRF-GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4" target="_blank"><span><cite>Oracle数据库备份和恢复参考</cite></span></a> ，以获取将数据库复制到过去时间点的示例</p>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-7FDB9916-8FB9-471A-8EFD-26E34FB8EA25" name="GUID-7FDB9916-8FB9-471A-8EFD-26E34FB8EA25"></a><h4 id="BRADV-GUID-7FDB9916-8FB9-471A-8EFD-26E34FB8EA25" class="sect4"><span class="enumeration_section">25.1.9</span>复制数据库的先决条件</h4>
                  <div>
                     <p>先决条件取决于正在执行的数据库重复的类型。某些先决条件对于所有类型的复制都是通用的，而其他先决条件则特定于特定类型的复制。</p>
                     <div class="p">
                        <div class="infoboxnotealso" id="GUID-7FDB9916-8FB9-471A-8EFD-26E34FB8EA25__GUID-160E5FB7-EA34-49CD-A005-4A7424C0EB01">
                           <p class="notep1">也可以看看：</p>
                           <p>有关每种复制技术的先决条件的详细信息，请<a href="../rcmrf/DUPLICATE.html#RCMRF-GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4" target="_blank"><span><cite>参见Oracle数据库备份和恢复参考</cite></span></a></p>
                        </div>
                     </div>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" name="GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B"></a><h3 id="BRADV-GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" class="sect3"><span class="enumeration_section">25.2</span>计划复制数据库</h3>
               <div>
                  <p>在复制数据库之前，您必须对复制过程做出一些决定。</p>
                  <p>计划复制数据库包括以下任务：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="rman-duplicating-databases.html#GUID-B01ED820-3E01-4044-87A1-C156E27E02E4" title="您的业务需求和数据库环境决定了哪种复制技术最适合您的情况。">选择复制技术</a></p>
                     </li>
                     <li>
                        <p><a href="rman-duplicating-databases.html#GUID-5293AB47-97AA-45A2-9D64-BA1287D3F7B9" title="复制数据库时，RMAN会为重复数据库中的数据库文件生成名称。这包括控制文件，数据文件，临时文件和联机重做日志文件。">选择命名重复数据库文件的策略</a></p>
                     </li>
                     <li>
                        <p><a href="rman-duplicating-databases.html#GUID-CB32BB0E-5E76-4D18-8D93-0227344A8652" title="当源主机和目标主机不同时，必须在目标主机上安装Oracle数据库软件，以便可以创建辅助实例。">在目标主机上安装Oracle数据库软件</a></p>
                     </li>
                     <li>
                        <p><a href="rman-duplicating-databases.html#GUID-608FAE46-DC28-43F3-83F6-0DEB73BB59ED" title="使用RMAN DUPLICATE命令时，将创建重复数据库并以RESETLOGS模式打开。您可以使用DUPLICATE命令中的NOOPEN子句指定不能打开重复数据库。">确定重复数据库的状态</a></p>
                     </li>
                     <li>
                        <p><a href="rman-duplicating-databases.html#GUID-08282A88-3810-4C70-91D6-5C7582D5787D" title="复制期间使用的备份名称存储在RMAN存储库或控制文件中。">使备份可访问重复实例</a></p>
                     </li>
                  </ul>
               </div>
               <div class="sect3"><a id="GUID-B01ED820-3E01-4044-87A1-C156E27E02E4" name="GUID-B01ED820-3E01-4044-87A1-C156E27E02E4"></a><h4 id="BRADV-GUID-B01ED820-3E01-4044-87A1-C156E27E02E4" class="sect4"><span class="enumeration_section">25.2.1</span>选择复制技术</h4>
                  <div>
                     <p>您的业务需求和数据库环境决定了哪种复制技术最适合您的情况。</p>
                     <div class="section">请考虑以下问题：<ul style="list-style-type:disc">
                           <li>
                              <p>您是否熟悉每种复制技术的先决条件？</p>
                              <p>查看<span class="italic">Oracle数据库备份和恢复参考中</span> <code class="codeph">DUPLICATE</code>命令描述的先决条件部分<span class="italic"> </span>获取完整清单。
                              </p>
                              <p>一些先决条件是特定的，取决于复制技术。例如，活动复制要求源和辅助实例使用与源数据库相同的密码，而基于备份的复制不连接目标数据库和恢复目录，只需要将所有备份和数据库副本驻留在单个位置。</p>
                           </li>
                           <li>
                              <p>是否存在源数据库的备份？</p>
                              <p>活动数据库复制的主要优点是它不需要源数据库备份。活动复制通过网络将安装或联机数据库文件复制到辅助实例。该技术的一个缺点是对网络的负面性能影响。另一个缺点是源数据库正在运行将文件传输到辅助主机所需的进程，从而影响源数据库和生产工作负载。</p>
                              <p>如果存在源数据库备份，并且如果对网络的影响不可接受，则基于备份的复制可能是更好的选择。您可以将备份复制到临时存储并将其手动传输到目标主机。如果通过与目标或恢复目录的连接进行复制，则目标主机上的备份文件必须具有与源主机上相同的文件规范。否则，这不是必需的。</p>
                           </li>
                           <li>
                              <p>是否有恢复目录？</p>
                              <p>如果存在恢复目录，则可以执行基于备份的复制，而无需将RMAN作为TARGET连接到源数据库。在从辅助主机到源数据库的网络连接受到限制或易于间歇性中断的情况下，该技术是有利的。在不使用目标连接的情况下执行复制时，源数据库不受复制的影响。</p>
                           </li>
                           <li>
                              <p>目标主机上有多少磁盘空间？</p>
                              <p>使用磁盘备份执行复制时，目标主机上的磁盘空间可能会出现问题。例如，如果源数据库是1 TB（TB），并且如果在<span class="italic">不</span>使用共享磁盘或网络文件系统（NFS）的<span class="italic">情况下</span>从磁盘备份复制数据库，则必须至少有2 TB的可用空间。目的地主机。在某些环境中，手动传输备份是必要的，因为NFS性能是一个瓶颈。
                              </p>
                           </li>
                           <li>
                              <p>源和目标主机是通过LAN还是WAN连接的？</p>
                              <p>在广域网（WAN）上，活动数据库复制的性能可能比在局域网（LAN）上慢。如果WAN上的性能下降是不可接受的，那么基于备份的复制可能是唯一可行的选择。</p>
                           </li>
                           <li>
                              <p>您何时计划复制数据库？</p>
                              <p>如果您必须在高用户活动期间复制数据库，则主动复制导致的网络吞吐量损失可能会成为问题，使基于备份的复制成为更好的选择。此外，在活动数据库复制中，将文件复制到辅助主机所需的RMAN通道可能会影响性能。</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-5293AB47-97AA-45A2-9D64-BA1287D3F7B9" name="GUID-5293AB47-97AA-45A2-9D64-BA1287D3F7B9"></a><h4 id="BRADV-GUID-5293AB47-97AA-45A2-9D64-BA1287D3F7B9" class="sect4"><span class="enumeration_section">25.2.2</span>选择命名重复数据库文件的策略</h4>
                  <div>
                     <p>复制数据库时，RMAN会为重复数据库中的数据库文件生成名称。这包括控制文件，数据文件，临时文件和联机重做日志文件。</p>
                     <div class="section">
                        <p>根据您的复制方案，您可以使用以下方法之一命名重复的数据库文件：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="rman-duplicating-databases.html#GUID-7D61A2DD-76EB-4DCE-A66B-C702A210A4AA" title="必须满足某些条件才能对源和重复数据库中的文件使用相同的名称。">在源数据库和重复数据库中为数据库文件使用相同的名称</a></p>
                           </li>
                           <li>
                              <p><a href="rman-duplicating-databases.html#GUID-D4D17387-BC1D-4731-8BC3-50285847153A" title="如果源主机和目标主机使用不同的目录结构，或者它们使用相同的目录结构但您希望以不同方式命名数据库文件，则必须指定RMAN应如何为重复的数据库文件生成名称。">在源数据库和重复数据库中为数据库文件使用不同的名称</a></p>
                           </li>
                        </ul>
                        <p></p>
                        <p>如果未指定为重复数据库文件生成名称的策略，则RMAN使用与重复数据库的源数据库相同的文件名和目录结构。仅当复制到远程主机时，使用<code class="codeph">NOFILENAMECHECK</code>子句指示当源和重复数据库中的数据库文件的名称相同时，RMAN不得显示错误。
                        </p>
                        <p>用于为重复数据库文件指定备用名称的某些方法可能会生成与源数据库使用的文件名相同的文件名。例如，如果您使用<code class="codeph">SET NEWNAME</code>或<code class="codeph">CONFIGURE AUXNAME</code>命令指定重复数据库文件的名称，则可能会发生这种情况。指定重复数据库的文件名时要小心，否则可能会错误地覆盖源数据库文件。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div><a id="BRADV298"></a><div class="sect4"><a id="GUID-7D61A2DD-76EB-4DCE-A66B-C702A210A4AA" name="GUID-7D61A2DD-76EB-4DCE-A66B-C702A210A4AA"></a><h5 id="BRADV-GUID-7D61A2DD-76EB-4DCE-A66B-C702A210A4AA" class="sect5"><span class="enumeration_section">25.2.2.1</span>在源数据库和重复数据库中为数据库文件使用相同的名称</h5>
                     <div>
                        <p>必须满足某些条件才能对源和重复数据库中的文件使用相同的名称。</p>
                        <div class="section">
                           <p></p>
                           <p>最简单的复制策略是将重复数据库配置为使用与源数据库相同的目录结构和文件名。只有在复制到远程主机时，才能使用相同的目录结构和名称。</p>
                           <div class="p">使用相同的目录结构和文件名意味着您的环境满足以下要求：<ul style="list-style-type:disc">
                                 <li>
                                    <p>如果源数据库使用ASM磁盘组，则重复数据库必须使用具有相同名称的ASM磁盘组。</p>
                                 </li>
                                 <li>
                                    <p>如果源数据库文件是Oracle Managed Files，则辅助实例必须将<code class="codeph">DB_CREATE_FILE_DEST</code>参数设置为与源数据库相同的目录位置。虽然源和目标主机上的目录相同，但Oracle数据库会选择重复文件的相对名称。
                                    </p>
                                 </li>
                                 <li>
                                    <p>如果源数据库中的数据库文件的名称包含路径，则此路径名在重复数据库中必须相同。</p>
                                 </li>
                                 <li>
                                    <p>对于Oracle Real Application Clusters（RAC）环境，请对源数据库和目标数据库的<code class="codeph">ORACLE_SID</code>参数使用相同的值。
                                    </p>
                                 </li>
                              </ul>
                           </div>
                           <p>按建议配置环境时，不需要其他配置来命名重复文件。</p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-D4D17387-BC1D-4731-8BC3-50285847153A" name="GUID-D4D17387-BC1D-4731-8BC3-50285847153A"></a><h5 id="BRADV-GUID-D4D17387-BC1D-4731-8BC3-50285847153A" class="sect5"><span class="enumeration_section">25.2.2.2</span>在源数据库和重复数据库中为数据库文件使用不同的名称</h5>
                     <div>
                        <p>如果源主机和目标主机使用不同的目录结构，或者它们使用相同的目录结构但您希望以不同方式命名数据库文件，则必须指定RMAN应如何为重复的数据库文件生成名称。</p>
                        <div class="section">
                           <div class="infoboxnote" id="GUID-D4D17387-BC1D-4731-8BC3-50285847153A__GUID-3A853027-FDC4-4553-A7B5-8F00A879B0DC">
                              <p class="notep1">注意：</p>
                              <p>建议您在源和重复数据库中为ASM磁盘组使用不同的名称。</p>
                           </div>
                           <div class="infoboxnotealso" id="GUID-D4D17387-BC1D-4731-8BC3-50285847153A__GUID-1E8F91AE-0DDC-4EE0-B007-5F5D846662ED">
                              <p class="notep1">也可以看看：</p>
                              <p><a href="rman-duplicating-databases.html#GUID-21627543-AD37-4144-9DEF-2C5AE9CC745C" title="根据您选择的方法，RMAN可以自动生成文件名或使用重复数据库文件的特定名称。数据库文件包括数据文件，控制文件，联机重做日志文件和临时文件。">为重复数据库生成数据库文件名的方法</a></p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-21627543-AD37-4144-9DEF-2C5AE9CC745C" name="GUID-21627543-AD37-4144-9DEF-2C5AE9CC745C"></a><h5 id="BRADV-GUID-21627543-AD37-4144-9DEF-2C5AE9CC745C" class="sect5"><span class="enumeration_section">25.2.2.3</span>为重复数据库生成数据库文件名的方法</h5>
                     <div>
                        <p>根据您选择的方法，RMAN可以自动生成文件名或使用重复数据库文件的特定名称。数据库文件包括数据文件，控制文件，联机重做日志文件和临时文件。</p>
                        <div class="section">
                           <div class="p">使用以下优先顺序列出的方法之一为重复数据库生成文件名：<ul style="list-style-type:disc">
                                 <li>
                                    <p><code class="codeph">SET NEWNAME</code>命令</p>
                                    <p>为重复的数据库文件提供特定名称。根据您的要求，使用<code class="codeph">SET NEWNAME FOR DATABASE</code> ，为数据<code class="codeph">SET NEWNAME FOR DATAFILE</code> <code class="codeph">SET NEWNAME FOR TABLESPACE</code> <code class="codeph">SET NEWNAME FOR TEMPFILE</code> ，或<code class="codeph">SET NEWNAME FOR TEMPFILE</code>命令<code class="codeph">SET NEWNAME FOR TEMPFILE</code> 。
                                    </p>
                                    <p>对于OMF和ASM数据库文件，您必须使用<code class="codeph">SET NEWNAME...TO NEW</code>命令，未明确提供数据库文件的名称。
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">CONFIGURE AUXNAME</code>命令</p>
                                    <p>为重复的数据库文件指定非OMF和非ASM备用名称。</p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">DUPLICATE</code>命令的<code class="codeph">SPFILE</code>子句</p>
                                    <p>设置与重复数据库文件名相关的所有必需初始化参数，但<code class="codeph">DB_FILE_NAME_CONVERT</code>参数除外。
                                    </p>
                                 </li>
                                 <li>
                                    <p>（仅限联机重做日志文件） <code class="codeph">DUPLICATE</code>命令的<code class="codeph">LOGFILE</code>子句</p>
                                    <p>在重复数据库中命名联机重做日志文件。创建备用数据库时不能使用此方法。</p>
                                    <div class="infoboxnote" id="GUID-21627543-AD37-4144-9DEF-2C5AE9CC745C__GUID-6F9F1620-401C-434E-969C-56AE421118F4">
                                       <p class="notep1">注意：</p>
                                       <p>在没有<code class="codeph">NOFILENAMECHECK</code>子句的情况下复制到本地主机或远程主机时，请确保不使用源数据库当前正在使用的联机重做日志文件的名称。
                                       </p>
                                    </div>
                                 </li>
                                 <li>
                                    <p><code class="codeph">DB_FILE_NAME_CONVERT</code>和<code class="codeph">LOG_FILE_NAME_CONVERT</code>初始化参数</p>
                                    <p>指定将源数据库中的文件名转换为重复数据库中的名称的规则。您可以指定多个转换对。</p>
                                    <p>对ASM文件名使用<code class="codeph">DB_FILE_NAME_CONVERT</code>参数时，只能更改磁盘组名称更改。
                                    </p>
                                    <div class="infoboxnote" id="GUID-21627543-AD37-4144-9DEF-2C5AE9CC745C__GUID-AC3A8CF0-D8CD-451C-AE19-A0757345D2E8">
                                       <p class="notep1">注意：</p>
                                       <p>如果源数据库使用Oracle Managed Files，则无法使用此方法为重复的数据库文件指定备用名称。</p>
                                    </div>
                                 </li>
                                 <li>
                                    <p><code class="codeph">DB_CREATE_FILE_DEST</code>和<code class="codeph">DB_CREATE_ONLINE_LOG_DEST</code> _n参数</p>
                                    <p>在这些参数指定的位置创建Oracle Managed Files。这是为OMF和ASM指定备用名称的推荐方法。</p>
                                 </li>
                              </ul>
                           </div>
                           <p>如果使用多个方法为重复的数据库文件指定备用名称，则优先顺序决定使用哪种技术命名文件。任何未通过特定方法重命名的文件都由其后面的方法重命名。例如，如果<code class="codeph">SET NEWNAME</code>命令中未包含两个数据文件，则使用<code class="codeph">DB_FILE_NAME_CONVERT</code>参数重命名这些数据文件。
                           </p>
                           <div class="infoboxnotealso" id="GUID-21627543-AD37-4144-9DEF-2C5AE9CC745C__GUID-4F1E3EEE-8115-45D4-BC98-99464FC03718">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><a href="rman-duplicating-databases-advanced.html#GUID-2D8041F5-A322-452F-980C-5E81E1902D1C" title="如果源数据库和重复数据库不对数据库文件使用相同的名称，则必须为重复文件选择备用命名策略。">为重复数据库文件指定备用名称</a></p>
                                 </li>
                                 <li>
                                    <p><a href="../rcmrf/DUPLICATE.html#RCMRF-GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4" target="_blank"><span><cite>Oracle数据库备份和恢复参考中</cite></span></a>的<code class="codeph">DUPLICATE</code>命令，用于<code class="codeph">LOGFILE</code>和<code class="codeph">SPFILE</code>子句</p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-21627543-AD37-4144-9DEF-2C5AE9CC745C__GUID-F05DAB01-423C-40CC-9E17-2719345AE2AB">在数据库复制期间阻止文件名检查</p>
                           <p><code class="codeph">CONFIGURE AUXNAME</code>命令， <code class="codeph">SET NEWNAME</code>命令或<code class="codeph">DB_FILE_NAME_CONVERT</code>参数可以生成目标数据库中已在使用的名称。在这种情况下，RMAN在复制期间显示错误。复制到远程主机时，请使用<code class="codeph">NOFILENAMECHECK</code>选项来避免此错误消息。
                           </p>
                           <p></p>
                           <div class="infoboxnote" id="GUID-21627543-AD37-4144-9DEF-2C5AE9CC745C__GUID-6F174AC1-4EA3-41DD-9011-7AE404673F87">
                              <p class="notep1">注意：</p>
                              <p>复制到本地主机时使用<code class="codeph">NOFILENAMECHECK</code>覆盖目标数据库文件。
                              </p>
                           </div>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-21627543-AD37-4144-9DEF-2C5AE9CC745C__GUID-73411970-0B03-4758-80DE-B96D046CA70D">为重复数据库中的控制文件生成名称</p>
                           <p>默认情况下，RMAN在重复数据库的默认位置创建控制文件。您可以指定备用文件名和目录名以存储重复的数据库控制文件。在为控制文件选择名称时，请确保不要错误地覆盖源数据库的控制文件。</p>
                           <div class="p">使用以优先顺序列出的以下技术之一来指定重复数据库控制文件的位置：<ul style="list-style-type:disc">
                                 <li>
                                    <p>在辅助实例的初始化参数文件中设置<code class="codeph">CONTROL_FILES</code>初始化参数。
                                    </p>
                                 </li>
                                 <li>
                                    <div class="p">在通过设置以下参数之一确定的位置创建基于OMF的控制文件：<ul style="list-style-type:disc">
                                          <li>
                                             <p><code class="codeph">位置DB_CREATE_ONLINE_LOG_DEST_n</code></p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">DB_CREATE_FILE_DEST</code></p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">DB_RECOVERY_FILE_DEST</code></p>
                                          </li>
                                       </ul>如果设置了多个这些参数，则使用的优先顺序是列出这些参数的顺序。
                                    </div>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-CB32BB0E-5E76-4D18-8D93-0227344A8652" name="GUID-CB32BB0E-5E76-4D18-8D93-0227344A8652"></a><h4 id="BRADV-GUID-CB32BB0E-5E76-4D18-8D93-0227344A8652" class="sect4"><span class="enumeration_section">25.2.3</span>在目标主机上安装Oracle数据库软件</h4>
                  <div>
                     <p>当源主机和目标主机不同时，必须在目标主机上安装Oracle数据库软件，以便可以创建辅助实例。</p>
                     <div class="section">
                        <div class="infoboxnote" id="GUID-CB32BB0E-5E76-4D18-8D93-0227344A8652__GUID-D47883B6-DA9F-4128-B4D3-B76981249C10">
                           <p class="notep1">注意：</p>
                           <p>确保在源主机和目标主机上安装具有相同修补程序级别的相同版本的Oracle数据库软件。</p>
                        </div>
                        <p>使用以下技术之一安装软件：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>使用Oracle Universal Installer（OUI）执行常规安装。</p>
                              <p>安装Oracle数据库，其版本号与源数据库的版本号相同。不要创建数据库;仅安装软件。应用所有必需的补丁。</p>
                           </li>
                           <li>
                              <p>克隆源Oracle主页。</p>
                              <p>使用OUI克隆源Oracle主目录。这可确保应用于源数据库的所有修补程序都存在于重复数据库中。</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-608FAE46-DC28-43F3-83F6-0DEB73BB59ED" name="GUID-608FAE46-DC28-43F3-83F6-0DEB73BB59ED"></a><h4 id="BRADV-GUID-608FAE46-DC28-43F3-83F6-0DEB73BB59ED" class="sect4"><span class="enumeration_section">25.2.4</span>确定重复数据库的状态</h4>
                  <div>
                     <p>使用RMAN <code class="codeph">DUPLICATE</code>命令时，将创建重复数据库并以<code class="codeph">RESETLOGS</code>模式打开。您可以使用<code class="codeph">DUPLICATE</code>命令中的<code class="codeph">NOOPEN</code>子句指定不能打开重复数据库。
                     </p>
                     <div class="section">
                        <div class="p">在以下情况下，您可能不希望在创建后立即打开重复数据库：<ul style="list-style-type:disc">
                              <li>
                                 <p>打开重复数据库可能会导致错误。</p>
                              </li>
                              <li>
                                 <p>您需要修改重复数据库的初始化参数。</p>
                                 <p>例如，您需要修改闪回数据库设置，配置快速增量备份或修改块更改跟踪。</p>
                              </li>
                              <li>
                                 <p>您正在创建新数据库作为升级过程的一部分。</p>
                                 <p>在升级期间，您无法使用<code class="codeph">RESETLOGS</code>选项打开数据库。<code class="codeph">NOOPEN</code>子句使您可以复制数据库，然后使其处于可以在升级模式下打开并随后执行升级脚本的状态。
                                 </p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="BRADV89931"></a><div class="sect3"><a id="GUID-08282A88-3810-4C70-91D6-5C7582D5787D" name="GUID-08282A88-3810-4C70-91D6-5C7582D5787D"></a><h4 id="BRADV-GUID-08282A88-3810-4C70-91D6-5C7582D5787D" class="sect4"><span class="enumeration_section">25.2.5</span>使备份可访问重复实例</h4>
                  <div>
                     <p>复制期间使用的备份名称存储在RMAN存储库或控制文件中。</p>
                     <div class="section">
                        <div class="infoboxnote" id="GUID-08282A88-3810-4C70-91D6-5C7582D5787D__GUID-50A7E65F-FEBF-449A-A5DF-67ED1EAA50CD">
                           <p class="notep1">注意：</p>
                           <p>如果要执行活动数据库复制，则不需要执行此步骤。</p>
                        </div>
                        <p>使用目标连接和恢复目录连接或仅使用目标连接进行复制时，RMAN使用RMAN存储库中的元数据来查找复制所需的备份和归档重做日志文件。如果RMAN连接到恢复目录，则RMAN将从目录中获取备份元数据。如果RMAN未连接到目录（例如，当您<span class="italic">使用</span>目标连接执行基于备份的复制<span class="italic">时）</span> ，则RMAN将从控制文件中获取元数据。
                        </p>
                        <p>除非您在没有与目标和恢复目录的连接的情况下进行复制，否则备份的名称必须与RMAN存储库中记录的名称相同。确保目标主机上的辅助通道可以访问所有数据文件备份和归档重做日志文件。这是将重复数据库还原并恢复到所需时间点所必需的。如果没有，重复失败。归档的重做日志文件可以作为映像副本或备份集使用。</p>
                        <div class="infoboxnote" id="GUID-08282A88-3810-4C70-91D6-5C7582D5787D__GUID-DD34CF8D-D0E9-4707-8CA1-8C12860719BC">
                           <p class="notep1">注意：</p>
                           <p>无需使用<code class="codeph">BACKUP DATABASE</code>命令生成数据库备份。您可以混合使用单个数据文件的完整备份和增量备份，但需要对每个数据文件进行完整备份。
                           </p>
                        </div>
                        <div class="infoboxnotealso" id="GUID-08282A88-3810-4C70-91D6-5C7582D5787D__GUID-5961B30B-7838-44BE-8EA4-AF63A3B4E5A7">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><a href="rman-duplicating-databases.html#GUID-0AA97FD4-9039-42AB-8BB9-15D2CC1D1323" title="使辅助实例可以访问SBT备份的步骤特定于您的介质管理器配置。">使SBT备份可以访问辅助实例</a></p>
                              </li>
                              <li>
                                 <p><a href="rman-duplicating-databases.html#GUID-28AA671E-C024-4DAD-B75A-6BD903C7E84A" title="当您使辅助实例可以访问磁盘备份时，您的策略取决于您是否在连接到目标或恢复目录时复制数据库。如果未连接到目标或恢复目录，则必须使用BACKUP LOCATION子句为复制指定备份位置。">使磁盘备份可以访问辅助实例</a></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div class="sect4"><a id="GUID-0AA97FD4-9039-42AB-8BB9-15D2CC1D1323" name="GUID-0AA97FD4-9039-42AB-8BB9-15D2CC1D1323"></a><h5 id="BRADV-GUID-0AA97FD4-9039-42AB-8BB9-15D2CC1D1323" class="sect5"><span class="enumeration_section">25.2.5.1</span>使SBT备份可以访问辅助实例</h5>
                     <div>
                        <p>使辅助实例可以访问SBT备份的步骤特定于您的介质管理器配置。</p>
                        <div class="section">
                           <p>要使辅助实例可以访问SBT备份：</p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>如有必要，请在目标主机上安装介质管理软件。</span></li>
                           <li class="stepexpand"><span>使备份可以访问目标主机的磁带。通常，您执行以下操作之一：</span><div>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p>将磁带物理移动到连接到远程主机的驱动器。</p>
                                    </li>
                                    <li>
                                       <p>使用可通过网络访问的磁带服务器。</p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li class="stepexpand"><span>如有必要，请通知远程媒体管理软件有关磁带的存在。</span></li>
                        </ol>
                     </div>
                  </div><a id="BRADV99993"></a><div class="sect4"><a id="GUID-28AA671E-C024-4DAD-B75A-6BD903C7E84A" name="GUID-28AA671E-C024-4DAD-B75A-6BD903C7E84A"></a><h5 id="BRADV-GUID-28AA671E-C024-4DAD-B75A-6BD903C7E84A" class="sect5"><span class="enumeration_section">25.2.5.2</span>使磁盘备份可以访问辅助实例</h5>
                     <div>
                        <p>当您使辅助实例可以访问磁盘备份时，您的策略取决于您是否在连接到目标或恢复目录时复制数据库。如果未连接到目标或恢复目录，则必须使用<code class="codeph">BACKUP LOCATION</code>子句为复制指定备份位置。
                        </p>
                        <div class="section">
                           <p>使用备份位置时，备份和副本可以驻留在共享位置，也可以移动到目标主机上的位置。在后一种情况下，您无需保留备份或副本的名称或原始路径。<code class="codeph">BACKUP LOCATION</code>选项中指定的<code class="codeph">BACKUP LOCATION</code>必须包含足够的备份集，映像副本和存档日志，以还原所有正在复制的文件，并将它们恢复到所需的时间点。
                           </p>
                           <p>并非所有备份都必须来自同一时间点，或者它们都是备份集或所有映像副本。数据文件备份可以作为映像副本或备份集提供。存档日志可以以其正常格式提供，也可以作为存档日志的备份集提供。</p>
                           <p>当您使用来自不同时间点的备份时，备份位置必须包含存档日志，其中包括从最早备份开始到所需恢复点的时间。</p>
                           <p>如果备份位置包含来自多个数据库的备份文件，则<code class="codeph">DATABASE</code>子句必须指定要复制的数据库的名称。如果备份位置包含来自具有相同名称的多个数据库的备份文件，则<code class="codeph">DATABASE</code>子句必须同时指定要复制的数据库的名称和<code class="codeph">DBID</code> 。
                           </p>
                           <p>源数据库的快速恢复区特别适合用作备份位置，因为它几乎总是包含复制所需的所有文件。要将快速恢复区用作备份位置，您可以从目标系统远程访问它，或将其内容复制到目标系统。</p>
                           <div class="p">如果不使用备份位置，则策略取决于以下互斥方案：<ul style="list-style-type:disc">
                                 <li>
                                    <p>源主机和目标主机的文件系统相同</p>
                                    <div class="p">这种情况最简单，Oracle推荐它。例如，假设源数据库的备份存储在<code class="codeph">/dsk1/bkp</code>目录中。在这种情况下，您可以通过以下任一方式使目标主机可以访问磁盘备份：<ul style="list-style-type:disc">
                                          <li>
                                             <p>将备份从源主机手动传输到目标主机中的相同路径。例如，如果备份位于源主机上的<code class="codeph">/dsk1/bkp</code>目录中，则使用FTP将它们传输到目标主机上的<code class="codeph">/dsk1/bkp</code>目录。
                                             </p>
                                          </li>
                                          <li>
                                             <p>使用NFS或共享磁盘，并确保在目标主机中可以访问相同的路径。例如，假设源主机可以访问<code class="codeph">/dsk1/bkp</code>目录，请使用NFS在目标主机上安装<code class="codeph">/dsk1/bkp</code>目录，并使用<code class="codeph">/dsk1/bkp</code>作为安装点名称。
                                             </p>
                                          </li>
                                       </ul>
                                    </div>
                                 </li>
                                 <li>
                                    <p>源主机和目标主机的不同文件系统</p>
                                    <div class="p">在这种情况下，您<span class="italic">不能</span>在目标主机上使用与在源主机上使用的目录名相同的目录名。您有以下选择：<ul style="list-style-type:disc">
                                          <li>
                                             <p>您可以使用共享磁盘进行备份。本节介绍共享磁盘技术。</p>
                                          </li>
                                          <li>
                                             <p>您无法使用共享磁盘来备份。<a href="rman-duplicating-databases-advanced.html#GUID-C575132F-23DE-47E5-8FFD-01F986F6CD13" title="You can use the shared disk technique to make backups available to the auxiliary instance. When NFS or shared disk is not an option, then the path that stores the backups must exist on both the source and destination hosts, unless the BACKUP LOCATION option is used for the DUPLICATE command without a target or recovery catalog connection.">在没有共享磁盘的</a>情况下<a href="rman-duplicating-databases-advanced.html#GUID-C575132F-23DE-47E5-8FFD-01F986F6CD13" title="您可以使用共享磁盘技术使备份可用于辅助实例。如果NFS或共享磁盘不是选项，则存储备份的路径必须同时存在于源主机和目标主机上，除非BACKUP LOCATION选项用于没有目标或恢复目录连接的DUPLICATE命令。">使磁盘备份可访问</a>描述了这种技术
                                             </p>
                                          </li>
                                       </ul>假设您有两个主机， <code class="codeph">srchost</code>和<code class="codeph">dsthost</code> ，以及对NFS或共享磁盘的访问权限。<code class="codeph">srchost</code>上的数据库名为<code class="codeph">srcdb</code> 。<code class="codeph">srcdb</code>的备份位于主机<code class="codeph">srchost</code>上的<code class="codeph">/dsk1/bkp</code>目录中。目录<code class="codeph">/dsk1/bkp</code>是在目标主机上使用，但目录<code class="codeph">/dsk2/dup</code>是不是在任一主机上使用。
                                    </div>
                                 </li>
                              </ul>
                           </div>
                           <p><span class="bold">要将备份从源主机传输到目标主机：</span></p>
                           <ol>
                              <li>
                                 <p>在源主机或目标主机中创建备份存储目录。</p>
                                 <p>对于此示例，请在目标主机上创建备份目录<code class="codeph">/dsk2/dup</code> 。
                                 </p>
                              </li>
                              <li>
                                 <p>将上一步中创建的目录挂载到另一台主机上，确保目录和挂载点名称相同。</p>
                                 <p>例如，如果在目标主机上创建了<code class="codeph">/dsk2/dup</code>目录，则使用NFS将此目录作为<code class="codeph">/dsk2/dup</code>安装在源主机上。
                                 </p>
                              </li>
                              <li>
                                 <div class="p">使备份在目标主机上的新位置可用。您可以使用以下任一技术：<ul style="list-style-type:disc">
                                       <li>
                                          <p>将RMAN作为TARGET连接到源数据库，并使用<code class="codeph">BACKUP</code>命令备份备份。例如，使用<code class="codeph">BACKUP COPY OF DATABASE</code>命令将源主机上<code class="codeph">/dsk2/dup</code> <code class="codeph">/dsk1/bkp</code>目录中的备份复制到目标主机上的<code class="codeph">/dsk2/dup</code>目录。在这种情况下，RMAN会自动对新位置中的备份进行编目。
                                          </p>
                                          <p>如果要复制PDB，请使用<code class="codeph">BACKUP COPY OF</code>命令的<code class="codeph">PLUGGABLE DATABASE</code>语法仅复制PDB的备份。</p>
                                       </li>
                                       <li>
                                          <p>使用操作系统实用程序将备份传输到新位置。例如，使用FTP来备份来自传输<code class="codeph">/dsk1/bkp</code>目录中的源主机向上<code class="codeph">/dsk2/dup</code>目录在目标主机上，或使用<code class="codeph">cp</code>命令到备份从复制<code class="codeph">/dsk1/bkp</code>上的目录源主机到目标主机上的<code class="codeph">/dsk2/dup</code>目录。然后，将RMAN作为TARGET连接到源数据库，并使用<code class="codeph">CATALOG</code>命令使用手动传输的备份的位置更新RMAN存储库。
                                          </p>
                                       </li>
                                    </ul>
                                 </div>
                              </li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-FCE67CCA-78B3-47E4-8D1B-75C8719BD51A" name="GUID-FCE67CCA-78B3-47E4-8D1B-75C8719BD51A"></a><h3 id="BRADV-GUID-FCE67CCA-78B3-47E4-8D1B-75C8719BD51A" class="sect3"><span class="enumeration_section">25.3</span>准备辅助实例</h3>
               <div>
                  <p>RMAN使用辅助实例来创建重复数据库。在开始复制之前，必须准备辅助实例。</p>
                  <p>根据您的复制方案，您需要执行本节中描述的某些操作或任务。准备辅助实例包括以下任务：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="rman-duplicating-databases.html#GUID-2ECA94F4-E8EB-43D7-9934-39F2BE281700" title="在目标主机上，必须创建用于在目标主机上存储重复数据库文件的目录。这包括存储数据文件，控制文件，联机重做日志文件和临时文件的目录。">为重复数据库创建目录</a></p>
                     </li>
                     <li>
                        <p><a href="rman-duplicating-databases.html#GUID-57888C11-63C3-4A7A-8488-2E623033A359" title="有多种方法可用于创建启动辅助实例所需的初始化参数文件。">为辅助实例创建初始化参数文件</a></p>
                     </li>
                     <li>
                        <p><a href="rman-duplicating-databases.html#GUID-A338B143-E321-4329-A2ED-2467C70C03DC" title="可以使用操作系统身份验证或密码文件身份验证来建立与辅助实例的连接。对于基于备份的复制，您可以创建密码文件或使用操作系统身份验证连接到辅助实例。对于活动数据库复制，您必须使用密码文件身份验证。">为辅助实例创建密码文件</a></p>
                     </li>
                     <li>
                        <p><a href="rman-duplicating-databases.html#GUID-460171C8-2E09-4D0E-9AC3-A4C28392A220" title="对于某些形式的复制，您必须能够在源数据库和辅助实例之间建立连接。">在源数据库和辅助实例之间建立Oracle Net Connectivity</a></p>
                     </li>
                     <li>
                        <p><a href="rman-duplicating-databases.html#GUID-7534941B-A211-4EA5-87AC-D657AE51839E" title="您创建的初始化参数文件用于启动辅助实例。">启动辅助实例</a></p>
                     </li>
                     <li>
                        <p><a href="rman-duplicating-databases.html#GUID-E016C2DC-1774-4057-8EAF-3F69E9A6322A" title="如果在源数据库上配置了透明加密，则必须确保源数据库中的Oracle软件密钥库可用于辅助实例。将密钥库从源数据库手动复制到目标主机。">使Oracle密钥库可用于目标主机</a></p>
                     </li>
                  </ul>
               </div>
               <div class="sect3"><a id="GUID-2ECA94F4-E8EB-43D7-9934-39F2BE281700" name="GUID-2ECA94F4-E8EB-43D7-9934-39F2BE281700"></a><h4 id="BRADV-GUID-2ECA94F4-E8EB-43D7-9934-39F2BE281700" class="sect4"><span class="enumeration_section">25.3.1</span>为复制数据库创建目录</h4>
                  <p>在目标主机上，必须创建用于在目标主机上存储重复数据库文件的目录。这包括存储数据文件，控制文件，联机重做日志文件和临时文件的目录。</p>
               </div><a id="BRADV167"></a><div class="sect3"><a id="GUID-57888C11-63C3-4A7A-8488-2E623033A359" name="GUID-57888C11-63C3-4A7A-8488-2E623033A359"></a><h4 id="BRADV-GUID-57888C11-63C3-4A7A-8488-2E623033A359" class="sect4"><span class="enumeration_section">25.3.2</span>为辅助实例创建初始化参数文件</h4>
                  <div>
                     <p>有多种方法可用于创建启动辅助实例所需的初始化参数文件。</p>
                     <div class="section">使用以下方法之一创建初始化参数文件：<ul style="list-style-type:disc">
                           <li>
                              <p>手动创建初始化参数文件。</p>
                              <p>如果源数据库不使用服务器参数文件，则必须在基于文本的初始化参数文件中为辅助实例设置所有必需参数。</p>
                           </li>
                           <li>
                              <p>直接RMAN使用源数据库的初始化参数文件作为辅助实例。</p>
                              <p>仅当源数据库使用服务器参数文件时，此技术才适用。当重复数据库必须使用与源相同的参数设置时，从源数据库复制初始化参数文件非常有用。</p>
                              <div class="infoboxnote" id="GUID-57888C11-63C3-4A7A-8488-2E623033A359__GUID-7B58B4DC-8F3F-4A1F-AA41-70DAE13147B3">
                                 <p class="notep1">注意：</p>
                                 <p>建议使用服务器参数文件而不是基于文本的初始化参数文件进行复制。</p>
                              </div>
                           </li>
                        </ul>
                        <p>辅助实例的客户端参数文件必须与执行复制的RMAN客户端位于同一主机上。</p>
                        <p>建议您在辅助实例的默认位置创建初始化参数文件。在Windows上，默认初始化参数文件是<span class="italic"><code class="codeph">ORACLE_HOME</code></span> <code class="codeph">/dbs/init</code> <span class="italic"><code class="codeph">ORACLE_SID</code></span> <code class="codeph">.ora</code> ，在Linux上，文件名是<span class="italic"><code class="codeph">ORACLE_HOME</code></span> <code class="codeph">\database\inti</code> <span class="italic"><code class="codeph">ORACLE_SID</code></span> <code class="codeph">.ora</code> 。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="rman-duplicating-databases.html#GUID-31F759B9-862C-4B97-B14B-843E82926074">辅助实例的初始化参数</a></li>
                           <li><a href="rman-duplicating-databases.html#GUID-13FE86AF-5D6B-4573-B0DF-D98CF57DB451">为辅助实例创建初始化参数文件的步骤</a></li>
                           <li><a href="rman-duplicating-databases.html#GUID-E7FCF631-6272-41FE-93A2-CFD7C1E0A2FE">从源数据库复制服务器参数文件</a></li>
                        </ul>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-13FE86AF-5D6B-4573-B0DF-D98CF57DB451" name="GUID-13FE86AF-5D6B-4573-B0DF-D98CF57DB451"></a><h5 id="BRADV-GUID-13FE86AF-5D6B-4573-B0DF-D98CF57DB451" class="sect5"><span class="enumeration_section">25.3.2.1</span>为辅助实例创建初始化参数文件的步骤</h5>
                     <div>
                        <p>辅助实例的初始化参数文件必须至少包含<code class="codeph">DB_NAME</code>和<code class="codeph">DB_DOMAIN</code>初始化参数。如果需要，可以指定附加参数。确保初始化参数文件与执行复制的RMAN客户端位于同一主机上。
                        </p>
                        <div class="section">
                           <div class="p">要为辅助实例创建初始化参数文件：<ol>
                                 <li>
                                    <div class="p">执行以下操作之一：<ul style="list-style-type:disc">
                                          <li>
                                             <p>将初始化参数文件从源主机复制到目标主机，将其置于特定于操作系统的默认位置，然后修改<code class="codeph">DB_NAME</code>和<code class="codeph">DB_DOMAIN</code>初始化参数。
                                             </p>
                                             <p>如果要复制CDB，请确保存在<code class="codeph">ENABLE_PLUGGABLE_DATABASE</code>参数并将其设置为<code class="codeph">TRUE</code> 。</p>
                                             <p>请参阅<a href="rman-duplicating-databases.html#GUID-E7FCF631-6272-41FE-93A2-CFD7C1E0A2FE" title="如果源数据库使用服务器参数文件，则在DUPLICATE命令中包含SPFILE选项会指示RMAN使用源数据库中的服务器参数文件作为辅助实例。">从源数据库复制服务器参数文件</a> 。
                                             </p>
                                          </li>
                                          <li>
                                             <p>完成以下步骤：</p>
                                             <ol type="a">
                                                <li>
                                                   <p>使用文本编辑器创建一个空文件，以用作基于文本的初始化参数文件，并将其保存在特定于操作系统的默认位置。</p>
                                                </li>
                                                <li>
                                                   <p>在参数文件中，设置<code class="codeph">DB_NAME</code>和<code class="codeph">DB_DOMAIN</code>初始化参数。这些是唯一必需的参数。
                                                   </p>
                                                   <p>通过设置<code class="codeph">DB_DOMAIN</code>参数，可以在使用网络服务名称连接时连接到默认数据库服务。
                                                   </p>
                                                </li>
                                                <li>
                                                   <div class="p">如果辅助实例是CDB，则设置以下参数：<pre class="pre codeblock"><code>ENABLE_PLUGGABLE_DATABASE = TRUE</code></pre></div>
                                                </li>
                                             </ol>
                                          </li>
                                       </ul>
                                    </div>
                                 </li>
                                 <li>
                                    <p>设置各种位置参数，例如<code class="codeph">CONTROL_FILES</code>和<code class="codeph">DB_RECOVERY_FILE_DEST</code> 。</p>
                                 </li>
                                 <li>
                                    <p>如有必要，请设置其他初始化参数，例如Oracle Real Application Clusters所需的参数。</p>
                                 </li>
                                 <li>
                                    <p>设置所需的环境变量，例如<code class="codeph">ORACLE_HOME</code>和<code class="codeph">ORACLE_SID</code> 。</p>
                                 </li>
                                 <li>
                                    <p>（可选）如果满足下列条件之一，则设置指定重复数据库文件位置的初始化参数：</p>
                                    <ul style="list-style-type:disc">
                                       <li>
                                          <p>源主机和目标主机是相同的（与本地主机重复）。</p>
                                       </li>
                                       <li>
                                          <p>重复数据库使用的目录结构与源主机的目录结构不同，以存储数据库文件。</p>
                                       </li>
                                    </ul>
                                    <p>根据用于为重复数据库文件指定备用名称的技术，请在初始化参数文件中包含以下一个或多个参数： <code class="codeph">CONTROL_FILES</code> ， <code class="codeph">DB_FILE_NAME_CONVERT</code> ， <code class="codeph">LOG_FILE_NAME_CONVERT</code> ， <code class="codeph">DB_CREATE_FILE_DEST</code> ， <code class="codeph">DB_CREATE_ONLINE_FILE_DEST</code> _ <span class="italic"><code class="codeph">n</code></span>和<code class="codeph">RECOVERY_FILE_DEST</code> 。</p>
                                    <div class="infoboxnote" id="GUID-13FE86AF-5D6B-4573-B0DF-D98CF57DB451__GUID-B61AA093-479F-449D-A9C1-76708C38757C">
                                       <p class="notep1">注意：</p>
                                       <p>建议您验证指定的所有路径是否可供目标主机和辅助实例的服务器会话访问。</p>
                                    </div>
                                    <p>请参见<span class="italic">“</span> <span><cite>Oracle数据库备份和恢复用户指南</cite></span> <span class="italic">”</span>中的<span class="italic">“为重复数据库生成数据库文件名</span> <span><cite>的方法”</cite></span> 。
                                    </p>
                                 </li>
                                 <li>
                                    <div class="p">启动SQL * Plus并以具有<code class="codeph">SYSDBA</code>或<code class="codeph">SYSBACKUP</code>权限的用户身份连接到辅助实例。以<code class="codeph">NOMOUNT</code>模式启动辅助实例。如果文件位于默认位置，则<code class="codeph">STARTUP</code>命令不需要<code class="codeph">PFILE</code>参数。<pre class="pre codeblock"><code>SQL&gt; STARTUP NOMOUNT;</code></pre></div>
                                 </li>
                              </ol>
                           </div>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-13FE86AF-5D6B-4573-B0DF-D98CF57DB451__GUID-5C664925-287C-4BB7-A3B7-1E4F001EC2E9">
                           <p class="titleinexample">例25-1 <span class="bold">辅助实例的样本初始化参数文件</span></p><pre class="oac_no_warn" dir="ltr">DB_NAME = dupdb CONTROL_FILES =（/ dup / oracle / oradata / prod / control01.ctl，dup / oracle / oradata / prod / control02.ctl）DB_FILE_NAME_CONVERT =（/ oracle / oradata / prod /，/ dup / oracle / oradata / prod /）LOG_FILE_NAME_CONVERT =（/ oracle / oradata / prod / redo，/ dup / oracle / oradata / prod / redo）</pre></div>
                        <!-- class="example" -->
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>相关话题</strong></p>
                           <ul>
                              <li><a href="rman-duplicating-databases.html#GUID-21627543-AD37-4144-9DEF-2C5AE9CC745C" title="根据您选择的方法，RMAN可以自动生成文件名或使用重复数据库文件的特定名称。数据库文件包括数据文件，控制文件，联机重做日志文件和临时文件。">为重复数据库生成数据库文件名的方法</a></li>
                           </ul>
                        </div>
                     </div>
                     
                  </div>
                  <div class="sect4"><a id="GUID-E7FCF631-6272-41FE-93A2-CFD7C1E0A2FE" name="GUID-E7FCF631-6272-41FE-93A2-CFD7C1E0A2FE"></a><h5 id="BRADV-GUID-E7FCF631-6272-41FE-93A2-CFD7C1E0A2FE" class="sect5"><span class="enumeration_section">25.3.2.2</span>从源数据库复制服务器参数文件</h5>
                     <div>
                        <p>如果源数据库使用服务器参数文件，则在<code class="codeph">DUPLICATE</code>命令中包含<code class="codeph">SPFILE</code>选项会指示RMAN使用源数据库中的服务器参数文件作为辅助实例。
                        </p>
                        <div class="section">
                           <p>对于基于备份的复制，将从备份还原服务器参数文件。对于活动数据库复制，将服务器参数文件从源数据库复制到辅助实例。</p>
                           <p>当源数据库使用基于文本的初始化参数文件时，请使用<code class="codeph">DUPLICATE</code>命令中的<code class="codeph">PFILE</code>子句将源数据库的初始化参数文件复制到辅助实例。
                           </p>
                           <p>您可以使用<code class="codeph">SPFILE</code>的<code class="codeph">PARAMETER_VALUE_CONVERT</code>选项或<code class="codeph">DUPLICATE</code>的<code class="codeph">SET</code>子句修改从源数据库的服务器参数文件复制或还原的值。例如，您可以使用<code class="codeph">SET</code>子句更改辅助实例的服务器参数文件中的<code class="codeph">DB_FILE_NAME_CONVERT</code>参数的值。
                           </p>
                           <p>如果源数据库不使用服务器参数文件或RMAN无法还原服务器参数文件的备份，则必须手动创建基于文本的初始化参数文件，如<a href="rman-duplicating-databases.html#GUID-13FE86AF-5D6B-4573-B0DF-D98CF57DB451" title="辅助实例的初始化参数文件必须至少包含DB_NAME和DB_DOMAIN初始化参数。如果需要，可以指定附加参数。确保初始化参数文件与执行复制的RMAN客户端位于同一主机上。">为辅助实例创建初始化参数文件的步骤中所述</a> 。
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-A338B143-E321-4329-A2ED-2467C70C03DC" name="GUID-A338B143-E321-4329-A2ED-2467C70C03DC"></a><h4 id="BRADV-GUID-A338B143-E321-4329-A2ED-2467C70C03DC" class="sect4"><span class="enumeration_section">25.3.3</span>为辅助实例创建密码文件</h4>
                  <div>
                     <p>可以使用操作系统身份验证或密码文件身份验证来建立与辅助实例的连接。对于基于备份的复制，您可以创建密码文件或使用操作系统身份验证连接到辅助实例。对于活动数据库复制，您必须使用密码文件身份验证。</p>
                     <div class="section">
                        <p>要使用密码文件身份验证连接到数据库，必须为数据库创建密码文件。复制到远程主机时，必须设置密码文件。密码文件的默认位置是Windows上的<code class="codeph"><span class="variable" translate="no">$ORACLE_BASE</span> \database</code>和Linux和UNIX上的<code class="codeph"><span class="variable" translate="no">$ORACLE_BASE</span> /dbs</code> 。</p>
                        <div class="infoboxnote" id="GUID-A338B143-E321-4329-A2ED-2467C70C03DC__GUID-13448E53-D0C8-4EDF-BD4E-CBEAF504090D">
                           <p class="notep1">注意：</p>
                           <p>使用RMAN复制创建备用数据库时，始终会复制密码文件。在所有其他情况下，仅当您在<code class="codeph">DUPLICATE</code>命令中指定<code class="codeph">PASSWORD FILE</code>选项时，才会复制<code class="codeph">PASSWORD FILE</code> 。
                           </p>
                        </div>
                        <p>使用以下选项之一为目标主机上的辅助实例创建密码文件：</p>
                     </div>
                     <!-- class="section" -->
                     <ul>
                        <li class="stepexpand"><span>使用特定于操作系统的实用程序将源数据库密码文件复制到目标主机，然后将其重命名以匹配辅助实例名称。仅当源主机和目标主机位于同一平台上时，此选项才适用。</span></li>
                        <li class="stepexpand"><span>手动创建密码文件。确保源数据库和辅助实例中<code class="codeph">SYSDBA</code>和<code class="codeph">SYSBACKUP</code>用户的密码相同。</span></li>
                        <li class="stepexpand"><span>使用<code class="codeph">orapwd</code>实用程序创建密码文件。<code class="codeph">SYSBACKUP</code>选项在新密码文件中创建<code class="codeph">SYSBACKUP</code>条目。</span><div>
                              <p>以下示例以12.2格式名称<code class="codeph">orapworcl</code>创建一个密码文件，该文件位于操作系统文件的默认位置：</p><pre class="pre codeblock"><code>orapwd FILE ='/ u01 / oracle / dbs / orapworcl'FORMAT = 12.2</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>在<code class="codeph">DUPLICATE...上指定<code class="codeph">PASSWORD FILE</code>选项<code class="codeph">DUPLICATE...FROM ACTIVE DATABASE</code>命令。</span><div>
                              <p>RMAN将源数据库密码文件复制到目标主机，并覆盖辅助实例的任何现有密码文件。如果源数据库密码文件具有多个密码以在重复数据库上可用，则此技术很有用。</p>
                              <p>使用活动数据库复制时，密码文件必须至少包含两个密码，用于<code class="codeph">SYS</code>用户和<code class="codeph">SYSBACKUP</code>用户。这些密码必须与源数据库中的密码匹配。
                              </p>
                              <div class="infoboxnote" id="GUID-A338B143-E321-4329-A2ED-2467C70C03DC__GUID-A12FD4AE-8131-41DA-A65A-4998CA01C6D6">
                                 <p class="notep1">注意：</p>
                                 <p>如果使用<code class="codeph">FROM ACTIVE DATABASE</code>选项创建备用数据库，则RMAN始终将密码文件复制到备用主机。
                                 </p>
                              </div>
                           </div>
                        </li>
                     </ul>
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-A338B143-E321-4329-A2ED-2467C70C03DC__GUID-C03B686F-02AA-416E-A90C-B898CDD898A9">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="../admin/getting-started-with-database-administration.html#ADMIN-GUID-26EC8D1B-7A2F-4F0A-9588-D92CBD610858" target="_blank"><span><cite>Oracle数据库管理员指南</cite></span></a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-460171C8-2E09-4D0E-9AC3-A4C28392A220" name="GUID-460171C8-2E09-4D0E-9AC3-A4C28392A220"></a><h4 id="BRADV-GUID-460171C8-2E09-4D0E-9AC3-A4C28392A220" class="sect4"><span class="enumeration_section">25.3.4</span>在源数据库和辅助实例之间建立Oracle Net Connectivity</h4>
                  <div>
                     <p>对于某些形式的复制，您必须能够在源数据库和辅助实例之间建立连接。</p>
                     <div class="section">如果满足以下任一条件，则必须通过Oracle Net Services提供辅助实例：<ul style="list-style-type:disc">
                           <li>
                              <p>RMAN客户端从目标主机以外的主机运行</p>
                           </li>
                           <li>
                              <p>选择的复制技术是活动数据库复制</p>
                           </li>
                           <li>
                              <p>目标主机与源主机不同</p>
                           </li>
                        </ul>
                        <p>要执行活动数据库复制，必须使用<code class="codeph">SYSDBA</code>或<code class="codeph">SYSBACKUP</code>权限并使用网络服务名称连接到辅助实例。RMAN连接到的源数据库作为<code class="codeph">TARGET</code>使用此网络服务名称直接连接到辅助数据库实例。
                        </p>
                        <p>要建立Oracle Net连接并设置静态侦听器：</p>
                     </div>
                     <!-- class="section" -->
                     <ul>
                        <li><span>按照<a href="configuring-rman-client-basic.html#GUID-30772A33-4C40-42D2-89AE-FDAC92DF44C9" target="_blank"><span><cite>Oracle数据库管理员指南</cite></span></a>中的说明配置客户端以连接到数据库并为侦听器添加静态服务信息。</span></li>
                     </ul>
                     <div class="example" id="GUID-460171C8-2E09-4D0E-9AC3-A4C28392A220__GUID-A77B761E-5FE2-4EE5-9377-D1AF79EF92B5">
                        <p class="titleinexample">示例25-2示例：在源数据库和辅助实例之间建立Oracle Net Connectivity</p>
                        <p>假设源数据库的<code class="codeph">DB_NAME</code>是<code class="codeph">src</code> ，源主机是<code class="codeph">src.example.com</code> 。辅助实例的<code class="codeph">DB_NAME</code>为<code class="codeph">dup</code> ，辅助实例在主机<code class="codeph">dup.example.com</code>上创建。
                        </p>
                        <div class="p">使用以下步骤在源数据库和辅助实例之间建立Oracle Net连接：<ol>
                              <li>
                                 <div class="p">在源数据库的<code class="codeph">tnanames.ora</code>文件中，添加与重复数据库对应的以下条目：<pre class="pre codeblock"><code>dupdb =（DESCRIPTION =（ADDRESS =（PROTOCOL = TCP）（HOST = dup.example.com）（PORT = 1521））（CONNECT_DATA =（SERVICE_NAME = dup）））</code></pre></div>
                              </li>
                              <li>
                                 <div class="p">在目标主机上，在<code class="codeph">$</code> <span class="italic"><code class="codeph">ORACLE_HOME</code></span> <code class="codeph">/admin/network</code>文件夹中创建<code class="codeph">tnsnames.ora</code>文件。添加与源数据库对应的以下条目。<pre class="pre codeblock"><code>srcdb =（DESCRIPTION =（ADDRESS =（PROTOCOL = TCP）（HOST = src.example.com）（PORT = 1521））（CONNECT_DATA =（SERVICE_NAME = src）））</code></pre></div>
                              </li>
                           </ol>
                        </div>
                     </div>
                     <!-- class="example" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-7534941B-A211-4EA5-87AC-D657AE51839E" name="GUID-7534941B-A211-4EA5-87AC-D657AE51839E"></a><h4 id="BRADV-GUID-7534941B-A211-4EA5-87AC-D657AE51839E" class="sect4"><span class="enumeration_section">25.3.5</span>启动辅助实例</h4>
                  <div>
                     <p>您创建的初始化参数文件用于启动辅助实例。</p>
                     <div class="section">RMAN关闭并重新启动辅助实例作为复制的一部分。因此，最好在默认位置为辅助实例创建服务器端初始化参数文件。如果在缺省位置没有服务器端初始化参数文件，则必须在<code class="codeph">DUPLICATE</code>命令中使用<code class="codeph">PFILE</code>参数指定客户端初始化参数文件。
                        <div class="infoboxnote" id="GUID-7534941B-A211-4EA5-87AC-D657AE51839E__GUID-655893EB-4C9F-4F74-BD84-D56807691215">
                           <p class="notep1">注意：</p>
                           <p>由于辅助实例还没有控制文件，因此只能以<code class="codeph">NOMOUNT</code>模式启动实例。不要创建控制文件或尝试装入或打开辅助实例。
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>要启动辅助实例：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>启动RMAN。</span><div><pre class="pre codeblock"><code>％rman</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>以具有<code class="codeph">SYSDBA</code>或<code class="codeph">SYSBACKUP</code>权限的用户身份连接到辅助实例。以下示例使用密码文件身份验证连接到辅助实例。</span><div><pre class="pre codeblock"><code>RMAN&gt; CONNECT SYS @ dupdb AS SYSDBA;</code></pre><div class="p">以下示例使用操作系统身份验证通过使用<code class="codeph">SYSBACKUP</code>权限连接到辅助实例。<pre class="pre codeblock"><code>RMAN&gt; CONNECT / AS SYSBACKUP;</code></pre></div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>以<code class="codeph">NOMOUNT</code>模式启动辅助实例。</span><div><pre class="pre codeblock"><code>RMAN&gt; STARTUP FORCE NOMOUNT;</code></pre></div>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="rman-duplicating-databases.html#GUID-57888C11-63C3-4A7A-8488-2E623033A359" title="有多种方法可用于创建启动辅助实例所需的初始化参数文件。">为辅助实例创建初始化参数文件</a></li>
                        </ul>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-E016C2DC-1774-4057-8EAF-3F69E9A6322A" name="GUID-E016C2DC-1774-4057-8EAF-3F69E9A6322A"></a><h4 id="BRADV-GUID-E016C2DC-1774-4057-8EAF-3F69E9A6322A" class="sect4"><span class="enumeration_section">25.3.6</span>使Oracle密钥库可用于目标主机</h4>
                  <div>
                     <p>如果在源数据库上配置了透明加密，则必须确保源数据库中的Oracle软件密钥库可用于辅助实例。将密钥库从源数据库手动复制到目标主机。</p>
                     <div class="section">
                        <p>Oracle软件密钥库包含用于以下内容的TDE主密钥：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>在执行基于备份的复制时解密加密的备份。</p>
                           </li>
                           <li>
                              <p>在执行TDE加密的数据库或表空间的活动数据库复制时解密数据库或表空间数据。</p>
                           </li>
                        </ul>
                        <p>以下是重复数据库中密钥库的要求：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>密钥库必须位于默认位置，或者位于<code class="codeph">sqlnet.ora</code>文件指示的位置。
                              </p>
                           </li>
                           <li>
                              <p>必须设置Oracle密钥库文件的权限，以便数据库可以访问该文件。</p>
                           </li>
                           <li>
                              <p>在复制期间，重新启动辅助实例，从而导致Oracle软件密钥库变得不可用。要确保辅助实例可以访问密钥库，请在<code class="codeph">sqlnet.ora</code>文件中设置<code class="codeph">ENCRYPTION_WALLET_LOCATION</code>参数，使其指向密钥库位置。
                              </p>
                              <p></p>
                              <p>Oracle Database 19c版中不推荐使用<code class="codeph">ENCRYPTION_WALLET_LOCATION</code> <code class="codeph">sqlnet.ora</code>参数。使用<code class="codeph">WALLET_ROOT</code>初始化参数与<code class="codeph">TDE_CONFIGURATION</code>初始化参数配置软件密钥存储的位置。
                              </p>
                           </li>
                           <li>
                              <p>使用Oracle Real Application Clusters（Oracle RAC），使用Oracle Grid Infrastructure侦听器静态注册辅助实例，并使用Oracle Grid home的<code class="codeph">sqlnet.ora</code>文件中的<code class="codeph">ENVS</code>参数指定设置密钥库位置和唯一名称的环境变量的数据库。
                              </p>
                              <p>以下示例在<code class="codeph">sqlnet.ora</code>设置<code class="codeph">ENVS</code>参数以指定密钥库位置和唯一数据库名称：</p><pre class="pre codeblock"><code>（ENVS =“ORACLE_UNQNAME = cdbrptl，ENCRYPTION_WALLET_LOCATION =（SOURCE =（METHOD = FILE）（METHOD_DATA =（DIRECTORY = / etc / ORACLE / WALLETS / cdbrpt1））））”</code></pre></li>
                           <li>
                              <p></p>
                              <p>如果源数据库使用基于密码的软件密钥库（而不是自动登录软件密钥库），则必须在开始复制之前提供密钥库密码。</p>
                              <p>使用带有<code class="codeph">DECRYPTION WALLET OPEN IDENTIFIED BY</code>子句的<code class="codeph">SET</code>命令指定必须用于打开密钥库的密码。
                              </p>
                              <div class="p">以下命令指定用于打开密钥库的<code class="codeph"><span class="variable" translate="no">password</span></code> （其中<code class="codeph"><span class="variable" translate="no">password</span></code>是您输入的实际密码的占位符）：<pre class="pre codeblock"><code>SET DECRYPTION WALLET OPEN由<span class="variable" translate="no">password</span>识别;</code></pre></div>
                           </li>
                        </ul>
                        <div class="infoboxnotealso" id="GUID-E016C2DC-1774-4057-8EAF-3F69E9A6322A__GUID-2FA38F77-85FA-4D0C-AEF8-D17F4ABA1395">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>有关在<code class="codeph">sqlnet.ora</code>指定Oracle密钥库位置的信息，请参见<a href="../asoag/using-sqlnet-ora-to-configure-tde-keystores.html#ASOAG-GUID-278422A5-1F77-4E82-B4A1-578F03AE30FD" target="_blank"><span><cite>“Oracle数据库高级安全性指南”</cite></span></a></p>
                              </li>
                              <li>
                                 <p>有关默认Oracle密钥库位置的信息，请参见<a href="../asoag/configuring-transparent-data-encryption.html#ASOAG-GUID-1FA85E9E-5666-4CF3-A3C7-1F8A9230B0C9" target="_blank"><span><cite>“Oracle数据库高级安全指南”</cite></span></a></p>
                              </li>
                              <li>
                                 <p>有关将标准Oracle密钥库转换为自动登录密钥库的信息，请参见<a href="../asoag/configuring-transparent-data-encryption.html#ASOAG-GUID-98BA94DA-571B-429C-8E7A-B6A1020E9420" target="_blank"><span><cite>“Oracle数据库高级安全性指南”</cite></span></a></p>
                              </li>
                              <li>
                                 <p>有关<code class="codeph">SET</code>命令的信息<a href="../rcmrf/SET.html#RCMRF-GUID-BC501B5C-4CD0-485D-AA18-27E2894024C3" target="_blank"><span><cite>，请参见Oracle数据库备份和恢复参考</cite></span></a></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="BRADV168"></a><div class="sect2"><a id="GUID-9AA25E86-888F-4E72-B0BC-E3849F39B76A" name="GUID-9AA25E86-888F-4E72-B0BC-E3849F39B76A"></a><h3 id="BRADV-GUID-9AA25E86-888F-4E72-B0BC-E3849F39B76A" class="sect3"><span class="enumeration_section">25.4</span>复制数据库</h3>
               <div>
                  <p>本节介绍如何执行数据库复制。复制CDB和PDB的步骤与用于非CDB的步骤略有不同。</p>
                  <div class="infoboxnote" id="GUID-9AA25E86-888F-4E72-B0BC-E3849F39B76A__GUID-32A1352A-6E24-40ED-8C9F-1E714099678B">
                     <p class="notep1">注意：</p>
                     <p>不支持使用相同的源数据库执行同时复制操作。</p>
                  </div>
                  <div class="infoboxnotealso" id="GUID-9AA25E86-888F-4E72-B0BC-E3849F39B76A__GUID-BA3FD858-271A-4E71-8FA6-543B27CED8CA">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="rman-duplicating-databases.html#GUID-CAC32870-C67F-465F-9449-EC87AC95BF95" title="使用DUPLICATE命令复制数据库。">复制整个数据库</a></p>
                        </li>
                        <li>
                           <p><a href="rman-duplicating-databases.html#GUID-37957032-254D-4F4F-93AD-428C1073931F" title="您可以在源数据库中复制指定的表空间。">复制源数据库表空间的子集</a></p>
                        </li>
                        <li>
                           <p><a href="rman-duplicating-databases.html#GUID-BCFE0E2F-5F5D-4D52-9749-2FC171F39BCF" title="复制Oracle Real Application Clusters（Oracle RAC）数据库的步骤包含与用于复制数据库的步骤相比较小的变化。">复制Oracle RAC数据库</a></p>
                        </li>
                        <li>
                           <p><a href="rman-duplicating-databases.html#GUID-563EFE61-1CD4-4796-97B8-80D0239EF2A5" title="稀疏数据库的复制过程以隐式还原开始，然后完成复制包含稀疏数据文件的数据库。">复制稀疏数据库</a></p>
                        </li>
                     </ul>
                  </div>
               </div><a id="BRADV89930"></a><div class="sect3"><a id="GUID-CAC32870-C67F-465F-9449-EC87AC95BF95" name="GUID-CAC32870-C67F-465F-9449-EC87AC95BF95"></a><h4 id="BRADV-GUID-CAC32870-C67F-465F-9449-EC87AC95BF95" class="sect4"><span class="enumeration_section">25.4.1</span>复制整个数据库</h4>
                  <div>
                     <p>使用<code class="codeph"><code class="codeph">DUPLICATE</code></code>命令复制数据库。
                     </p>
                     <div class="section">
                        <p><span class="bold"><span class="bold">要复制数据库：</span></span></p>
                        <ol>
                           <li>
                              <p>确保满足所选复制技术的先决条件。</p>
                              <p>请参阅<a href="rman-duplicating-databases.html#GUID-7FDB9916-8FB9-471A-8EFD-26E34FB8EA25" title="先决条件取决于正在执行的数据库重复的类型。某些先决条件对于所有类型的复制都是通用的，而其他先决条件则特定于特定类型的复制。">复制数据库的先决条件</a> 。
                              </p>
                           </li>
                           <li>
                              <p>在开始数据库复制之前，请完成所需的规划任务。</p>
                              <p>请参阅<a href="rman-duplicating-databases.html#GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" title="在复制数据库之前，您必须对复制过程做出一些决定。">规划复制数据库</a> 。
                              </p>
                           </li>
                           <li>
                              <p>准备创建重复数据库时使用的辅助实例。</p>
                              <p>请参阅<a href="rman-duplicating-databases.html#GUID-FCE67CCA-78B3-47E4-8D1B-75C8719BD51A" title="RMAN使用辅助实例来创建重复数据库。在开始复制之前，必须准备辅助实例。">准备辅助实例</a> 。
                              </p>
                           </li>
                           <li>
                              <p>启动RMAN并连接到所需的数据库。根据您的复制技术，您可能需要连接到以下一个或多个目标：目标数据库，辅助实例或恢复目录。</p>
                              <p>请参阅<a href="rman-duplicating-databases.html#GUID-CF2871A5-C9F7-4EAF-A583-8A8966264B05" title="您必须启动RMAN客户端并根据所选复制技术的要求连接到数据库实例。RMAN客户端可以位于任何主机上，只要它可以通过网络连接到必要的数据库。">启动RMAN和连接到数据库</a> 。
                              </p>
                           </li>
                           <li>
                              <p>将源数据库置于适当的状态（如有必要）。</p>
                              <p>请参阅<a href="rman-duplicating-databases.html#GUID-8204DB9C-2BEF-419A-B96E-1B1C977F5AFE" title="如果RMAN作为TARGET连接到源数据库，则源数据库必须处于正确的复制状态。">将源数据库置于正确状态</a> 。
                              </p>
                           </li>
                           <li>
                              <p>（可选）配置RMAN通道以提高复制性能。通道执行复制数据库的主要任务。 。</p>
                              <p>请参阅<a href="rman-duplicating-databases.html#GUID-F2ED1190-E3BF-4898-BDCC-B9FF0500C76B" title="数据库复制的主要工作由RMAN通道执行。每个通道对应于执行复制任务的Oracle数据库服务器会话。根据复制技术，RMAN使用辅助通道或目标通道。">配置RMAN通道以在复制中使用</a> 。
                              </p>
                           </li>
                           <li>
                              <p>使用<code class="codeph">DUPLICATE</code>命令复制源数据库。
                              </p>
                              <p>请参阅<a href="rman-duplicating-databases.html#GUID-571FD3C7-BF5A-4CF4-970A-9F8CAC3DF1F1" title="RMAN使用DUPLICATE命令为复制数据库提供了多个选项。">使用DUPLICATE命令复制数据库</a> 。
                              </p>
                           </li>
                        </ol>
                        <p>执行活动数据库复制时，可以加密或压缩用于将文件从源数据库传输到重复数据库的备份集。此外，您可以使用多节备份并行地在源数据库上创建备份集。</p>
                        <div class="infoboxnotealso" id="GUID-CAC32870-C67F-465F-9449-EC87AC95BF95__GUID-B3B25CBC-B58A-4992-B57B-B966C6105808">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="rman-duplicating-databases.html#GUID-3C3A10DE-A843-4F48-AB34-E6D0064FDE9F" title="在复制数据库之前，您必须了解一些基本概念。">数据库复制的基本概念</a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-37957032-254D-4F4F-93AD-428C1073931F" name="GUID-37957032-254D-4F4F-93AD-428C1073931F"></a><h4 id="BRADV-GUID-37957032-254D-4F4F-93AD-428C1073931F" class="sect4"><span class="enumeration_section">25.4.2</span>复制源数据库表空间的子集</h4>
                  <div>
                     <p>您可以在源数据库中复制指定的表空间。</p>
                     <div class="section">
                        <p><span class="bold">要复制数据库中的某些表空间：</span></p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>确保满足所选复制技术的先决条件。</span><div>
                              <p>请参阅<a href="rman-duplicating-databases.html#GUID-7FDB9916-8FB9-471A-8EFD-26E34FB8EA25" title="先决条件取决于正在执行的数据库重复的类型。某些先决条件对于所有类型的复制都是通用的，而其他先决条件则特定于特定类型的复制。">复制数据库的先决条件</a> 。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>在开始数据库复制之前，请完成所需的规划任务。</span><div>
                              <p>请参阅<a href="rman-duplicating-databases.html#GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" title="在复制数据库之前，您必须对复制过程做出一些决定。">规划复制数据库</a> 。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>准备创建重复数据库时使用的辅助实例。</span><div>
                              <p>请参阅<a href="rman-duplicating-databases.html#GUID-FCE67CCA-78B3-47E4-8D1B-75C8719BD51A" title="RMAN使用辅助实例来创建重复数据库。在开始复制之前，必须准备辅助实例。">准备辅助实例</a> 。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>启动RMAN并连接到所需的数据库。根据您的复制技术，您可能需要连接到以下一个或多个目标：目标数据库，辅助实例或恢复目录。</span><div>
                              <p>请参阅<a href="rman-duplicating-databases.html#GUID-CF2871A5-C9F7-4EAF-A583-8A8966264B05" title="您必须启动RMAN客户端并根据所选复制技术的要求连接到数据库实例。RMAN客户端可以位于任何主机上，只要它可以通过网络连接到必要的数据库。">启动RMAN和连接到数据库</a> 。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>将源数据库置于适当的状态（如有必要）。</span><div>
                              <p>请参阅<a href="rman-duplicating-databases.html#GUID-8204DB9C-2BEF-419A-B96E-1B1C977F5AFE" title="如果RMAN作为TARGET连接到源数据库，则源数据库必须处于正确的复制状态。">将源数据库置于正确状态</a> 。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>（可选）配置RMAN通道以提高复制性能。通道执行复制数据库的主要任务。</span><div>
                              <p>请参阅<a href="rman-duplicating-databases.html#GUID-F2ED1190-E3BF-4898-BDCC-B9FF0500C76B" title="数据库复制的主要工作由RMAN通道执行。每个通道对应于执行复制任务的Oracle数据库服务器会话。根据复制技术，RMAN使用辅助通道或目标通道。">配置RMAN通道以在复制中使用</a> 。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>使用<a href="rman-duplicating-databases.html#GUID-31F759B9-862C-4B97-B14B-843E82926074__GUID-F322CB44-D43D-4B1C-894B-30A4D80C1F1D" title="此表描述为辅助实例设置的初始化参数。">表25-1中的</a>一个或多个选项运行<code class="codeph">DUPLICATE</code>命令。</span><div>
                              <p>影响表空间复制的其他因素包括<code class="codeph">OFFLINE NORMAL</code>选项。如果在复制之前使用<code class="codeph">OFFLINE NORMAL</code>选项使表空间脱机，则RMAN不会复制关联的数据文件，并在复制数据库上为这些表空间发出<code class="codeph">DROP TABLESPACE</code>语句。因此，您不必指定用于排除这些表空间的选项。
                              </p>
                              <div class="infoboxnote" id="GUID-37957032-254D-4F4F-93AD-428C1073931F__GUID-7133B89B-EBB0-415D-97BA-DF66F30B2B68">
                                 <p class="notep1">注意：</p>
                                 <p>RMAN会使用除<code class="codeph">NORMAL</code>之外的任何其他选项重复脱机的表空间（除非它们在<code class="codeph">SKIP TABLESPACE</code>选项中命名）。仅自动跳过<code class="codeph">OFFLINE NORMAL</code>表空间。与联机表空间一样，当您使用基于备份的复制时，RMAN需要对这些表空间进行有效备份。
                                 </p>
                              </div>
                           </div>
                        </li>
                     </ol>
                     <div class="example" id="GUID-37957032-254D-4F4F-93AD-428C1073931F__GUID-3A35DB46-6C61-4C86-8744-8DA83B847D7F">
                        <p class="titleinexample">例25-3排除只读表空间</p>
                        <p>此示例显示如何在数据库复制期间跳过只读表空间</p><pre class="pre codeblock"><code>DUPLICATE目标数据库以自动数据库跳过重复数据库;</code></pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-37957032-254D-4F4F-93AD-428C1073931F__GUID-9ACA5983-AB52-4B72-941C-AC63D0435AFE">
                        <p class="titleinexample">示例25-4排除指定的表空间</p>
                        <p>此示例显示如何在数据库复制期间跳过名为<code class="codeph">tools</code>的表空间。
                        </p><pre class="pre codeblock"><code>DUPLICATE TARGET DATABASE to dupdb from ACTIVE DATABASE SKIP TABLESPACE工具;</code></pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-37957032-254D-4F4F-93AD-428C1073931F__GUID-FACF4A0C-2D1E-4CF1-9AB8-A4F51249E0CA">
                        <p class="titleinexample">例25-5包括指定的表空间</p>
                        <p>您可以使用<code class="codeph">TABLESPACE</code>选项指定要包含在指定数据库中的表空间。将跳过剩余的表空间。表空间的重复子集必须是自包含的。生成的跳过表空间集不得包含还原段或物化视图。
                        </p>
                        <p>此示例包括<code class="codeph">users</code>表空间，假定它是自包含的，并且排除了所有其他表空间，但<code class="codeph">SYSTEM</code>和<code class="codeph">SYSAUX</code>表空间以及具有还原段的表空间除外。
                        </p><pre class="pre codeblock"><code>DUPLICATE TARGET DATABASE to dupdb FROM ACTIVE DATABASE TABLESPACE用户;</code></pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-37957032-254D-4F4F-93AD-428C1073931F__GUID-2DD4743C-DB20-4F28-BFD3-60CF449EBF39">
                        <p class="titleinexample">示例25-6包括具有撤消段的指定表空间</p>
                        <p>此示例使用目标连接执行基于备份的复制，但没有恢复目录连接。您希望指定表空间的子集以进行复制。如果在此方案中未打开目标数据库，则RMAN无法获取具有还原段的表空间的名称。因此，您必须为这些表空间指定<code class="codeph">UNDO TABLESPACE</code>选项。<code class="codeph">users</code>表空间必须是自包含的。生成的跳过表空间集不得包含还原段或物化视图。
                        </p><pre class="pre codeblock"><code>DUPLICATE目标数据库到dupdb TABLESPACE用户UNDO TABLESPACE undotbs;</code></pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-BCFE0E2F-5F5D-4D52-9749-2FC171F39BCF" name="GUID-BCFE0E2F-5F5D-4D52-9749-2FC171F39BCF"></a><h4 id="BRADV-GUID-BCFE0E2F-5F5D-4D52-9749-2FC171F39BCF" class="sect4"><span class="enumeration_section">25.4.3</span>复制Oracle RAC数据库</h4>
                  <div>
                     <p>复制Oracle Real Application Clusters（Oracle RAC）数据库的步骤包含与用于复制数据库的步骤相比较小的变化。</p>
                     <ol>
                        <li class="stepexpand"><span>确保满足所选复制技术的先决条件。</span><div>
                              <p>请参阅<a href="rman-duplicating-databases.html#GUID-7FDB9916-8FB9-471A-8EFD-26E34FB8EA25" title="先决条件取决于正在执行的数据库重复的类型。某些先决条件对于所有类型的复制都是通用的，而其他先决条件则特定于特定类型的复制。">复制数据库的先决条件</a> 。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>在开始数据库复制之前，请完成所需的规划任务。</span><div>
                              <p>请参阅<a href="rman-duplicating-databases.html#GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" title="在复制数据库之前，您必须对复制过程做出一些决定。">规划复制数据库</a> 。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>准备创建重复数据库时使用的辅助实例。</span><div>
                              <p>复制Oracle Real Application Clusters（Oracle RAC）数据库时，请将辅助数据库上的<code class="codeph">CLUSTER_DATABASE</code>初始化参数设置为FALSE。复制完成后，此参数可以重置为TRUE。
                              </p>
                              <p>请参阅<a href="rman-duplicating-databases.html#GUID-FCE67CCA-78B3-47E4-8D1B-75C8719BD51A" title="RMAN使用辅助实例来创建重复数据库。在开始复制之前，必须准备辅助实例。">准备辅助实例</a> 。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>启动RMAN并连接到所需的数据库。根据您的复制技术，您可能需要连接到以下一个或多个目标：目标数据库，辅助实例或恢复目录。</span><div>
                              <p>请参阅<a href="rman-duplicating-databases.html#GUID-CF2871A5-C9F7-4EAF-A583-8A8966264B05" title="您必须启动RMAN客户端并根据所选复制技术的要求连接到数据库实例。RMAN客户端可以位于任何主机上，只要它可以通过网络连接到必要的数据库。">启动RMAN和连接到数据库</a> 。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>将源数据库置于适当的状态（如有必要）。</span><div>
                              <p>请参阅<a href="rman-duplicating-databases.html#GUID-8204DB9C-2BEF-419A-B96E-1B1C977F5AFE" title="如果RMAN作为TARGET连接到源数据库，则源数据库必须处于正确的复制状态。">将源数据库置于正确状态</a> 。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>（可选）配置RMAN通道以提高复制性能。通道执行复制数据库的主要任务。</span><div>
                              <p>请参阅<a href="rman-duplicating-databases.html#GUID-F2ED1190-E3BF-4898-BDCC-B9FF0500C76B" title="数据库复制的主要工作由RMAN通道执行。每个通道对应于执行复制任务的Oracle数据库服务器会话。根据复制技术，RMAN使用辅助通道或目标通道。">配置RMAN通道以在复制中使用</a> 。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>使用<code class="codeph">DUPLICATE</code>命令复制源数据库。</span><div>
                              <p>请参阅<a href="rman-duplicating-databases.html#GUID-571FD3C7-BF5A-4CF4-970A-9F8CAC3DF1F1" title="RMAN使用DUPLICATE命令为复制数据库提供了多个选项。">使用DUPLICATE命令复制数据库</a> 。
                              </p> 
                              <p></p>
                              <div class="infoboxnote" id="GUID-BCFE0E2F-5F5D-4D52-9749-2FC171F39BCF__GUID-03E71DA9-74D6-4780-B98A-70070FDA1505">
                                 <p class="notep1">注意：</p>
                                 <p>有关复制Oracle RAC数据库的更多信息，请参阅<a href="https://support.oracle.com/rs?type=doc&amp;id=1617946.1" target="_blank"><code class="codeph">https://support.oracle.com/rs?type=doc&amp;id=1617946.1</code></a> My Oracle Support说明1617946.1。</p>
                              </div>
                           </div>
                        </li>
                     </ol>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-563EFE61-1CD4-4796-97B8-80D0239EF2A5" name="GUID-563EFE61-1CD4-4796-97B8-80D0239EF2A5"></a><h4 id="BRADV-GUID-563EFE61-1CD4-4796-97B8-80D0239EF2A5" class="sect4"><span class="enumeration_section">25.4.4</span>复制稀疏数据库</h4>
                  <div>
                     <p>稀疏数据库的复制过程以隐式还原开始，然后完成复制包含稀疏数据文件的数据库。</p>
                     <div class="p">
                        <p>确保稀疏数据文件的后备文件可用于复制。</p>
                        <div class="infoboxnote" id="GUID-563EFE61-1CD4-4796-97B8-80D0239EF2A5__GUID-0A3623A6-B9BF-4306-A83C-C7FD06BBF163">
                           <p class="notep1">注意：</p>
                           <p>稀疏数据库不允许活动数据库复制。</p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-563EFE61-1CD4-4796-97B8-80D0239EF2A5__GUID-054E30D5-5A34-4A1D-AA1F-29CFF98382ED">要复制稀疏数据库：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>确保满足所选复制技术的先决条件。</span><div>
                              <p>请参阅<a href="rman-duplicating-databases.html#GUID-7FDB9916-8FB9-471A-8EFD-26E34FB8EA25" title="先决条件取决于正在执行的数据库重复的类型。某些先决条件对于所有类型的复制都是通用的，而其他先决条件则特定于特定类型的复制。">复制数据库的先决条件</a> 。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>在开始数据库复制之前，请完成所需的规划任务。</span><div>
                              <p>请参阅<a href="rman-duplicating-databases.html#GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" title="在复制数据库之前，您必须对复制过程做出一些决定。">规划复制数据库</a> 。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>准备创建重复数据库时使用的辅助实例。</span><div>
                              <p>复制Oracle Real Application Clusters（Oracle RAC）数据库时，请将辅助数据库上的<code class="codeph">CLUSTER_DATABASE</code>初始化参数设置为FALSE。复制完成后，此参数可以重置为TRUE。
                              </p>
                              <p>请参阅<a href="rman-duplicating-databases.html#GUID-FCE67CCA-78B3-47E4-8D1B-75C8719BD51A" title="RMAN使用辅助实例来创建重复数据库。在开始复制之前，必须准备辅助实例。">准备辅助实例</a> 。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>启动RMAN并连接到所需的数据库。根据您的复制技术，您可能需要连接到以下一个或多个目标：目标数据库，辅助实例或恢复目录。</span><div>
                              <p>请参阅<a href="rman-duplicating-databases.html#GUID-CF2871A5-C9F7-4EAF-A583-8A8966264B05" title="您必须启动RMAN客户端并根据所选复制技术的要求连接到数据库实例。RMAN客户端可以位于任何主机上，只要它可以通过网络连接到必要的数据库。">启动RMAN和连接到数据库</a> 。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>将源数据库置于适当的状态（如有必要）。</span><div>
                              <p>请参阅<a href="rman-duplicating-databases.html#GUID-8204DB9C-2BEF-419A-B96E-1B1C977F5AFE" title="如果RMAN作为TARGET连接到源数据库，则源数据库必须处于正确的复制状态。">将源数据库置于正确状态</a> 。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>（可选）配置RMAN通道以提高复制性能。通道执行复制数据库的主要任务。</span><div>
                              <p>请参阅<a href="rman-duplicating-databases.html#GUID-F2ED1190-E3BF-4898-BDCC-B9FF0500C76B" title="数据库复制的主要工作由RMAN通道执行。每个通道对应于执行复制任务的Oracle数据库服务器会话。根据复制技术，RMAN使用辅助通道或目标通道。">配置RMAN通道以在复制中使用</a> 。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>为稀疏数据库运行<code class="codeph">DUPLICATE</code>命令。</span><div>以下命令复制稀疏数据库<code class="codeph">db1</code> ：<pre class="oac_no_warn" dir="ltr">从SPARSE DATABASE'DB1'复制到'DUP1';</pre><div class="infoboxnote" id="GUID-563EFE61-1CD4-4796-97B8-80D0239EF2A5__GUID-121B0C3B-6048-40A6-B9D5-20A88AFA7B43">
                                 <p class="notep1">注意：</p>
                                 <p>稀疏数据库中的基本（只读）数据文件未加密。确保基础数据文件存储在受保护的存储中，并使用安全通信进行访问。</p>
                              </div>
                           </div>
                        </li>
                     </ol>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-F2ED1190-E3BF-4898-BDCC-B9FF0500C76B" name="GUID-F2ED1190-E3BF-4898-BDCC-B9FF0500C76B"></a><h4 id="BRADV-GUID-F2ED1190-E3BF-4898-BDCC-B9FF0500C76B" class="sect4"><span class="enumeration_section">25.4.5</span>配置RMAN通道用于复制</h4>
                  <div>
                     <p>数据库复制的主要工作由RMAN通道执行。每个通道对应于执行复制任务的Oracle数据库服务器会话。根据复制技术，RMAN使用辅助通道或目标通道。</p>
                     <div class="section">
                        <p>使用以下方法之一配置通道：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>使用<code class="codeph">CONFIGURE</code>命令自动分配通道</p>
                           </li>
                           <li>
                              <p>使用<code class="codeph">ALLOCATE</code>命令手动分配通道</p>
                           </li>
                        </ul>
                        <p>如果未配置自动通道，则可以在复制之前手动分配至少一个通道。分配通道的<code class="codeph">ALLOCATE</code>命令必须与<code class="codeph">DUPLICATE</code>命令位于同一个<code class="codeph">RUN</code>块中。
                        </p>
                        <p>即使源数据库通道未指定<code class="codeph">AUXILIARY</code>选项，RMAN也可以在源数据库上使用相同的通道配置在目标主机上进行复制。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-F2ED1190-E3BF-4898-BDCC-B9FF0500C76B__GUID-D7AA490F-CBFE-40F0-A271-F3D4D25ADB43">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><a href="rman-duplicating-databases.html#GUID-17D02072-3003-4003-AC6F-BE680B4F107D" title="对于基于备份的复制，复制的主要工作由辅助通道执行。辅助通道对应于目标主机上辅助实例上的服务器会话。RMAN使用通道还原辅助实例中的备份。">配置基于备份的复制的通道</a></p>
                              </li>
                              <li>
                                 <p><a href="rman-duplicating-databases.html#GUID-922BBA95-FCCD-4BEB-A69D-96C662F468E6" title="使用活动数据库复制，您无需更改源数据库通道配置或配置辅助通道。但是，您可能希望增加源数据库磁盘通道的并行度设置，以便RMAN并行通过网络复制文件。">配置活动数据库复制的通道</a></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div class="sect4"><a id="GUID-17D02072-3003-4003-AC6F-BE680B4F107D" name="GUID-17D02072-3003-4003-AC6F-BE680B4F107D"></a><h5 id="BRADV-GUID-17D02072-3003-4003-AC6F-BE680B4F107D" class="sect5"><span class="enumeration_section">25.4.5.1</span>配置基于备份的复制通道</h5>
                     <div>
                        <p>对于基于备份的复制，复制的主要工作由辅助通道执行。辅助通道对应于目标主机上辅助实例上的服务器会话。RMAN使用通道还原辅助实例中的备份。</p>
                        <div class="section">
                           <p>配置其他辅助通道以提高重复操作的性能。如果未明确配置辅助通道，则RMAN将使用源数据库上的相同通道配置在目标主机上进行复制。即使源数据库通道未指定<code class="codeph">AUXILIARY</code>选项，RMAN也可以使用这些配置。
                           </p>
                           <p>请注意以下其他注意事项：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>使用基于磁盘的备份，您可以通过分配其他通道来提高复制操作的速度。</p>
                                 <p>使用基于磁带的复制，您只能分配与可用磁带设备数量相同的通道数。</p>
                              </li>
                              <li>
                                 <p>辅助通道的通道类型（DISK或sbt）必须与备份介质匹配。通常，为磁盘备份分配的通道越多，复制的速度就越快。磁盘达到最大读/写速率后，无法提高复制速度。对于磁带备份，请将通道数限制为可用的设备数。</p>
                              </li>
                              <li>
                                 <p>如果辅助通道需要特殊参数（例如，指向不同的介质管理器），则可以使用<code class="codeph">CONFIGURE</code>命令的<code class="codeph">AUXILIARY</code>选项配置自动通道。
                                 </p>
                              </li>
                              <li>
                                 <p>在没有目标连接且没有恢复目录的情况下执行复制时，只能使用磁盘通道。如果未使用用户分配的通道，则只有一个通道最初恢复控制文件。安装控制文件后，分配的通道数取决于还原的控制文件中的配置。</p>
                              </li>
                              <li>
                                 <p>如果省略<code class="codeph">DUPLICATE</code>命令中的<code class="codeph">USING BACKUPSET</code>子句并且分配的辅助通道数大于或等于目标通道数，则RMAN仍使用与备份集的活动数据库复制。
                                 </p>
                              </li>
                              <li>
                                 <p>如果辅助通道无法访问所需数据文件和归档重做日志文件的备份，则复制将失败。</p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-17D02072-3003-4003-AC6F-BE680B4F107D__GUID-88FB37C9-5671-4BE0-8B6B-27AAD9A6B626">
                           <p class="titleinexample">示例25-7为基于磁盘的备份配置辅助通道</p>
                           <p>以下示例分配三个辅助通道以将数据库复制到磁盘。</p><pre class="oac_no_warn" dir="ltr">运行{ALLOCATE AUXILIARY CHANNEL c1 DEVICE TYPE磁盘; ALLOCATE AUXILIARY CHANNEL c2 DEVICE TYPE disk; ALLOCATE AUXILIARY CHANNEL c3 DEVICE TYPE磁盘; 。 。 。重复数据库。 。 。; }</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-922BBA95-FCCD-4BEB-A69D-96C662F468E6" name="GUID-922BBA95-FCCD-4BEB-A69D-96C662F468E6"></a><h5 id="BRADV-GUID-922BBA95-FCCD-4BEB-A69D-96C662F468E6" class="sect5"><span class="enumeration_section">25.4.5.2</span>配置主动数据库复制的通道</h5>
                     <div>
                        <p>使用活动数据库复制，您无需更改源数据库通道配置或配置辅助通道。但是，您可能希望增加源数据库磁盘通道的并行度设置，以便RMAN并行通过网络复制文件。</p>
                        <div class="section">
                           <p>使用的活动数据库复制技术的类型确定哪些通道执行复制的主要工作。使用映像副本执行活动数据库复制时，主要工作由目标通道执行。在源数据库上配置多个目标通道以提高复制性能。当使用备份集执行活动数据库复制时，复制的主要工作由辅助通道执行。因此，建议您分配其他辅助通道。辅助信道的数量必须大于或等于目标信道的数量。使用备份集进行主动复制还可以实现并行性，从而提高复制过程的速度。</p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-8204DB9C-2BEF-419A-B96E-1B1C977F5AFE" name="GUID-8204DB9C-2BEF-419A-B96E-1B1C977F5AFE"></a><h4 id="BRADV-GUID-8204DB9C-2BEF-419A-B96E-1B1C977F5AFE" class="sect4"><span class="enumeration_section">25.4.6</span>将源数据库置于适当的状态</h4>
                  <div>
                     <p>如果RMAN作为<code class="codeph">TARGET</code>连接到源数据库，则源数据库必须处于正确的复制状态。
                     </p>
                     <div class="section">
                        <div class="infoboxnote" id="GUID-8204DB9C-2BEF-419A-B96E-1B1C977F5AFE__GUID-DE741EB9-0DD8-4C44-9490-08D2E6FFCD9B">
                           <p class="notep1">注意：</p>
                           <p>如果在没有目标连接的情况下执行基于备份的复制，请跳至<a href="rman-duplicating-databases.html#GUID-CF2871A5-C9F7-4EAF-A583-8A8966264B05" title="您必须启动RMAN客户端并根据所选复制技术的要求连接到数据库实例。RMAN客户端可以位于任何主机上，只要它可以通过网络连接到必要的数据库。">启动RMAN并连接到数据库</a> 。
                           </p>
                        </div>
                        <p>要确保源数据库处于正确状态：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>如果未安装或打开源数据库实例，则装入或打开它。</span></li>
                        <li class="stepexpand"><span>如果要执行活动数据库复制，请确保满足以下附加要求：</span><div>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>如果源数据库已打开，则必须启用存档。</p>
                                 </li>
                                 <li>
                                    <p>如果源数据库未打开，则数据库不需要实例恢复。</p>
                                 </li>
                              </ul>
                           </div>
                        </li>
                     </ol>
                  </div>
               </div><a id="BRADV299"></a><div class="sect3"><a id="GUID-CF2871A5-C9F7-4EAF-A583-8A8966264B05" name="GUID-CF2871A5-C9F7-4EAF-A583-8A8966264B05"></a><h4 id="BRADV-GUID-CF2871A5-C9F7-4EAF-A583-8A8966264B05" class="sect4"><span class="enumeration_section">25.4.7</span>启动RMAN并连接到数据库</h4>
                  <div>
                     <p>您必须启动RMAN客户端并根据所选复制技术的要求连接到数据库实例。RMAN客户端可以位于任何主机上，只要它可以通过网络连接到必要的数据库。</p>
                     <div class="section">
                        <p>要启动RMAN并连接到目标和辅助实例：</p>
                        <ol>
                           <li>
                              <p>在可以连接到必要数据库实例的任何主机上启动RMAN客户端。</p>
                              <p>例如，在目标主机上的操作系统提示符处输入以下命令：</p>
                              <p><code class="codeph">％rman</code></p>
                           </li>
                           <li>
                              <p>在RMAN提示符下，为复制技术所需的数据库实例运行<code class="codeph">CONNECT</code>命令。
                              </p>
                              <div class="infoboxnote" id="GUID-CF2871A5-C9F7-4EAF-A583-8A8966264B05__GUID-4C2BBDBE-B565-4927-A650-87EA297171E0">
                                 <p class="notep1">注意：</p>
                                 <p>复制整个CDB或一个或多个PDB时，请连接到两个实例的根。</p>
                              </div>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>对于使用映像副本的活动数据库复制，必须以<code class="codeph">TARGET</code>身份连接到源数据库，并以辅助实例身份连接到<code class="codeph">AUXILIARY</code> 。您必须提供网络服务名称才能连接到<code class="codeph">AUXILIARY</code>实例。恢复目录连接是可选的。在这两个实例上，执行复制的用户的密码必须相同。具有<code class="codeph">SYSDBA</code>或<code class="codeph">SYSBACKUP</code>权限的任何用户都可以执行复制。
                                    </p>
                                 </li>
                                 <li>
                                    <p>对于使用备份集的活动数据库复制，必须使用网络服务名称以<code class="codeph">TARGET</code>身份连接到源数据库。辅助实例使用此网络服务名称连接到源数据库并检索复制所需的备份集。以<code class="codeph">AUXILIARY</code>连接到辅助实例。如果要远程连接到辅助实例或打算使用<code class="codeph">DUPLICATE</code>命令的<code class="codeph">PASSWORD FILE</code>选项，则使用网络服务名称连接到辅助实例。在这两个实例上，执行复制的用户的密码必须相同。具有<code class="codeph">SYSDBA</code>或<code class="codeph">SYSBACKUP</code>权限的任何用户都可以执行复制。恢复目录连接是可选的。
                                    </p>
                                 </li>
                                 <li>
                                    <p>对于<span class="italic">没有</span>目标连接的基于备份的复制，必须将辅助实例作为<code class="codeph">AUXILIARY</code>连接到辅助实例，并将恢复目录作为<code class="codeph">CATALOG</code> 。</p>
                                 </li>
                                 <li>
                                    <p>对于<span class="italic">使用</span>目标连接的基于备份的复制，必须以<code class="codeph">TARGET</code>身份连接到源数据库，并将辅助实例连接到<code class="codeph">AUXILIARY</code> 。恢复目录是可选的。
                                    </p>
                                 </li>
                                 <li>
                                    <p>对于没有目标和恢复目录连接的基于备份的复制，必须以<code class="codeph">AUXILIARY</code>身份连接到辅助实例。</p>
                                 </li>
                              </ul>
                              <div class="infoboxnote" id="GUID-CF2871A5-C9F7-4EAF-A583-8A8966264B05__GUID-897FB0DE-76F9-42F4-ABC2-169016C1596A">
                                 <p class="notep1">注意：</p>
                                 <p>您无法作为<code class="codeph">TARGET</code>连接到备用数据库。
                                 </p>
                              </div>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-CF2871A5-C9F7-4EAF-A583-8A8966264B05__GUID-14BC625E-BDFA-4B9E-B02E-D90870128153">示例：执行活动数据库复制时连接到所需的数据库</p>
                        <p>在此示例中，使用网络服务名称建立与源数据库和辅助实例的连接。源数据库的Net Service名称是<code class="codeph">srcdb</code> ，辅助实例的名称是<code class="codeph">dupdb</code> 。
                        </p>
                        <p>要从目标主机连接到所需的数据库：</p>
                        <ol>
                           <li>
                              <p>在目标主机上启动RMAN客户端。</p>
                              <p><code class="codeph">％rman</code></p>
                           </li>
                           <li>
                              <p>以<code class="codeph">TARGET</code>身份连接到源数据库。</p>
                              <p><code class="codeph">RMAN&gt; CONNECT TARGET sys @ srcdb;</code></p>
                              <p>出现提示时，在源数据库上输入<code class="codeph">SYS</code>用户的密码。
                              </p>
                           </li>
                           <li>
                              <p>以<code class="codeph">AUXILIARY</code>连接到辅助实例。</p>
                              <p><code class="codeph">RMAN&gt; CONNECT AUXILIARY sys @ dupdb;</code></p>
                              <p>出现提示时，在辅助实例上输入<code class="codeph">SYS</code>用户的密码。
                              </p>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-571FD3C7-BF5A-4CF4-970A-9F8CAC3DF1F1" name="GUID-571FD3C7-BF5A-4CF4-970A-9F8CAC3DF1F1"></a><h4 id="BRADV-GUID-571FD3C7-BF5A-4CF4-970A-9F8CAC3DF1F1" class="sect4"><span class="enumeration_section">25.4.8</span>使用DUPLICATE命令复制数据库</h4>
                  <div>
                     <p>RMAN使用<code class="codeph">DUPLICATE</code>命令为复制数据库提供了多个选项。
                     </p>
                     <div class="section">使用<code class="codeph">DUPLICATE</code>命令的以下选项之一：<ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">DUPLICATE DATABASE</code>或<code class="codeph">DUPLICATE...活动数据库</code></p>
                              <p>使用这些来复制非CDB和CDB。</p>
                           </li>
                           <li>
                              <p><code class="codeph">DUPLICATE DATABASE ...对于待机</code></p>
                              <p>使用此命令通过复制源数据库来创建备用数据库。</p>
                              <p></p>
                              <p>使用<code class="codeph">DUPLICATE DATABASE ...FOR FARSYNC</code>命令使用复制创建Oracle Data Guard远程同步实例。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">DUPLICATE PLUGGABLE DATABASE</code></p>
                              <p>使用此选项可在连接到根目录时复制一个或多个PDB。</p>
                           </li>
                        </ul>使用<code class="codeph">SET NEWNAME</code>命令为重复的数据库文件指定备用名称时，请确保将<code class="codeph">DUPLICATE</code>命令和<code class="codeph">SET NEWNAME</code>命令包含在<code class="codeph">RUN</code>块中。
                        <div class="infoboxnotealso" id="GUID-571FD3C7-BF5A-4CF4-970A-9F8CAC3DF1F1__GUID-B6E4B14E-402C-4FED-BDDE-ECAC3CC3FA89">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><a href="rman-duplicating-databases.html#GUID-EA6E8219-56BF-471C-AC5A-DFC55E760806" title="本节包含使用不同复制技术复制数据库的示例。">示例：复制数据库</a></p>
                              </li>
                              <li>
                                 <p>有关复制的其他示例，请<code class="codeph">DUPLICATE</code> <a href="../rcmrf/DUPLICATE.html#RCMRF-GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4" target="_blank"><span><cite>Oracle数据库备份和恢复参考中</cite></span></a>的<code class="codeph">DUPLICATE</code>命令</p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-D95D9275-5882-4D5B-846F-1A03304BC307" name="GUID-D95D9275-5882-4D5B-846F-1A03304BC307"></a><h3 id="BRADV-GUID-D95D9275-5882-4D5B-846F-1A03304BC307" class="sect3"><span class="enumeration_section">25.5</span>复制CDB和PDB</h3>
               <div>
                  <p>使用<code class="codeph">DUPLICATE</code>命令复制CDB，一个或多个PDB，稀疏CDB和稀疏PDB。复制CDB和PDB的步骤类似于复制非CDB的步骤，其中复制非CDB的过程有微小的变化。本节介绍如何复制CDB和PDB。
                  </p>
                  <div class="infoboxnotealso" id="GUID-D95D9275-5882-4D5B-846F-1A03304BC307__GUID-6E38E8B0-FD32-497B-B9BD-F2FD3F240F42">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="rman-duplicating-databases.html#GUID-1AE8E2DE-EC18-4EEE-95F9-F8068E490977" title="使用DUPLICATE命令复制CDB。">复制CDB</a></p>
                        </li>
                        <li>
                           <p><a href="rman-duplicating-databases.html#GUID-39518A32-0A6D-4D03-87B1-89EF864DEF54" title="使用DUPLICATE命令复制稀疏CDB。">复制稀疏CDB</a></p>
                        </li>
                        <li>
                           <p><a href="rman-duplicating-databases.html#GUID-68742310-3B60-4246-9431-6671697AB516" title="您可以将PDB复制到新的多租户容器数据库（CDB）或现有CDB。">复制PDB</a></p>
                        </li>
                        <li>
                           <p><a href="rman-duplicating-databases.html#GUID-37931808-C740-4216-A3BC-5D0716F9D890" title="您可以使用DUPLICATE命令将PDB中的一个或多个表空间复制到新CDB。">将PDB中的表空间复制到新CDB</a></p>
                        </li>
                     </ul>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-1AE8E2DE-EC18-4EEE-95F9-F8068E490977" name="GUID-1AE8E2DE-EC18-4EEE-95F9-F8068E490977"></a><h4 id="BRADV-GUID-1AE8E2DE-EC18-4EEE-95F9-F8068E490977" class="sect4"><span class="enumeration_section">25.5.1</span>复制CDB</h4>
                  <div>
                     <p>使用<code class="codeph">DUPLICATE</code>命令复制CDB。
                     </p>
                     <div class="section">复制整个CDB或一个或多个PDB只需要对复制非CDB的过程进行最小程度的调整，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-CAC32870-C67F-465F-9449-EC87AC95BF95" title="使用DUPLICATE命令复制数据库。">复制整个数据库</a> ”中所述</span> 。
                        <p>要复制CDB：</p>
                        <ol>
                           <li>
                              <p>完成<span class="q">“ <a href="rman-duplicating-databases.html#GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" title="在复制数据库之前，您必须对复制过程做出一些决定。">计划复制数据库</a> ”中</span>描述的计划任务，并进行以下更改：</p>
                              <p>在<span class="q">“ <a href="rman-duplicating-databases.html#GUID-08282A88-3810-4C70-91D6-5C7582D5787D" title="复制期间使用的备份名称存储在RMAN存储库或控制文件中。">使备份可访问重复实例</a> ”</span>和<span class="q">“ <a href="rman-duplicating-databases-advanced.html#GUID-C575132F-23DE-47E5-8FFD-01F986F6CD13" title="您可以使用共享磁盘技术使备份可用于辅助实例。如果NFS或共享磁盘不是选项，则存储备份的路径必须同时存在于源主机和目标主机上，除非BACKUP LOCATION选项用于没有目标或恢复目录连接的DUPLICATE命令。">使磁盘备份无法访问共享磁盘</a> ”中</span> ，请注意以下调整：</p>
                              <p>使用<code class="codeph">BACKUP</code>命令的<code class="codeph">PLUGGABLE DATABASE</code>语法仅复制特定PDB的备份。</p>
                              <p>以下命令传输整个CDB的备份文件：</p><pre class="pre codeblock"><code>备份数据库副本;</code></pre><p>以下命令仅传输PDB <code class="codeph">pdb3</code>的备份文件：</p><pre class="pre codeblock"><code>备份数据库的可插入数据库pdb3;</code></pre></li>
                           <li>
                              <p>确保满足所选复制技术的先决条件，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-7FDB9916-8FB9-471A-8EFD-26E34FB8EA25" title="先决条件取决于正在执行的数据库重复的类型。某些先决条件对于所有类型的复制都是通用的，而其他先决条件则特定于特定类型的复制。">复制数据库的先决条件</a> ”中所述</span> 。
                              </p>
                           </li>
                           <li>
                              <p>按照<span class="q">“ <a href="rman-duplicating-databases.html#GUID-FCE67CCA-78B3-47E4-8D1B-75C8719BD51A" title="RMAN uses an auxiliary instance to create the duplicate database. You must prepare the auxiliary instance before you begin the duplication.">准备辅助实例</a> ”中的说明<a href="rman-duplicating-databases.html#GUID-FCE67CCA-78B3-47E4-8D1B-75C8719BD51A" title="RMAN使用辅助实例来创建重复数据库。在开始复制之前，必须准备辅助实例。">准备辅助实例</a></span> ，并进行以下更改：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>您必须将辅助实例创建为CDB。为此，请在初始化参数文件中使用以下声明启动实例：</p>
                                    <p><code class="codeph">enable_pluggable_database = TRUE</code></p>
                                 </li>
                                 <li>
                                    <p>当指示为辅助实例创建初始化参数文件时，必须从源数据库复制该文件。这确保了辅助实例也是CDB。复制文件后，执行以下步骤：</p>
                                    <ul style="list-style-type:disc">
                                       <li>
                                          <p>修改<code class="codeph">DB_NAME</code>参数</p>
                                       </li>
                                       <li>
                                          <p>修改各种目标或位置参数</p>
                                       </li>
                                    </ul>
                                 </li>
                                 <li>
                                    <p>当指示连接到必要的实例时，以具有<code class="codeph">SYSDBA</code>或<code class="codeph">SYSBACKUP</code>权限的用户身份连接到root。在这两个实例上，执行复制的用户的密码必须相同。
                                    </p>
                                 </li>
                              </ul>
                           </li>
                           <li>
                              <p>启动RMAN并以具有<code class="codeph">SYSDBA</code>或<code class="codeph">SYSBACKUP</code>权限的用户身份连接到root。
                              </p>
                              <p>在辅助实例和目标数据库上，执行复制的用户的密码必须相同。</p>
                           </li>
                           <li>
                              <p>如有必要，将源数据库置于适当的状态，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-8204DB9C-2BEF-419A-B96E-1B1C977F5AFE" title="如果RMAN作为TARGET连接到源数据库，则源数据库必须处于正确的复制状态。">将源数据库置于适当状态</a> ”中所述</span> 。
                              </p>
                           </li>
                           <li>
                              <p>如有必要，配置RMAN通道，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-F2ED1190-E3BF-4898-BDCC-B9FF0500C76B" title="数据库复制的主要工作由RMAN通道执行。每个通道对应于执行复制任务的Oracle数据库服务器会话。根据复制技术，RMAN使用辅助通道或目标通道。">配置RMAN通道以用于复制</a> ”中所述</span> 。
                              </p>
                              <p>复制的主要任务由RMAN通道执行。配置其他通道可提高复制性能。</p>
                           </li>
                           <li>
                              <p>使用<code class="codeph">DUPLICATE</code>命令复制源CDB。</p>
                              <p>请参阅<span class="q">“ <a href="rman-duplicating-databases.html#GUID-571FD3C7-BF5A-4CF4-970A-9F8CAC3DF1F1" title="RMAN使用DUPLICATE命令为复制数据库提供了多个选项。">使用DUPLICATE命令复制数据库</a> ”</span> 。
                              </p>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-39518A32-0A6D-4D03-87B1-89EF864DEF54" name="GUID-39518A32-0A6D-4D03-87B1-89EF864DEF54"></a><h4 id="BRADV-GUID-39518A32-0A6D-4D03-87B1-89EF864DEF54" class="sect4"><span class="enumeration_section">25.5.2</span>复制稀疏CDB</h4>
                  <div>
                     <p>使用<code class="codeph">DUPLICATE</code>命令复制稀疏CDB。
                     </p>
                     <div class="section">复制稀疏CDB：</div>
                     <!-- class="section" -->
                     <div class="section">
                        <p></p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>完成<span class="q">“ <a href="rman-duplicating-databases.html#GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" title="在复制数据库之前，您必须对复制过程做出一些决定。">计划复制数据库</a> ”中</span>描述的计划任务，并进行以下更改：</span><div>
                              <p>在<span class="q">“ <a href="rman-duplicating-databases.html#GUID-08282A88-3810-4C70-91D6-5C7582D5787D" title="复制期间使用的备份名称存储在RMAN存储库或控制文件中。">使备份可访问重复实例</a> ”</span>和<span class="q">“ <a href="rman-duplicating-databases-advanced.html#GUID-C575132F-23DE-47E5-8FFD-01F986F6CD13" title="您可以使用共享磁盘技术使备份可用于辅助实例。如果NFS或共享磁盘不是选项，则存储备份的路径必须同时存在于源主机和目标主机上，除非BACKUP LOCATION选项用于没有目标或恢复目录连接的DUPLICATE命令。">使磁盘备份无法访问共享磁盘</a> ”中</span> ，请注意以下调整：</p>
                              <p>使用<code class="codeph">BACKUP</code>命令的<code class="codeph">PLUGGABLE DATABASE</code>语法仅复制特定PDB的备份。</p>
                              <p>以下命令传输整个CDB的备份文件：</p><pre class="pre codeblock"><code>备份数据库副本;</code></pre><p>以下命令仅传输PDB <code class="codeph">pdb3</code>的备份文件：</p><pre class="pre codeblock"><code>备份数据库的可插入数据库pdb3;</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>确保满足所选复制技术的先决条件，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-7FDB9916-8FB9-471A-8EFD-26E34FB8EA25" title="先决条件取决于正在执行的数据库重复的类型。某些先决条件对于所有类型的复制都是通用的，而其他先决条件则特定于特定类型的复制。">复制数据库的先决条件</a> ”中所述</span> 。</span></li>
                        <li class="stepexpand"><span>按照<span class="q">“ <a href="rman-duplicating-databases.html#GUID-FCE67CCA-78B3-47E4-8D1B-75C8719BD51A" title="RMAN uses an auxiliary instance to create the duplicate database. You must prepare the auxiliary instance before you begin the duplication.">准备辅助实例</a> ”中的说明<a href="rman-duplicating-databases.html#GUID-FCE67CCA-78B3-47E4-8D1B-75C8719BD51A" title="RMAN使用辅助实例来创建重复数据库。在开始复制之前，必须准备辅助实例。">准备辅助实例</a></span> ，并进行以下更改：</span><div>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>您必须将辅助实例创建为CDB。为此，请在初始化参数文件中使用以下声明启动实例：</p>
                                    <p><code class="codeph">enable_pluggable_database = TRUE</code></p>
                                 </li>
                                 <li>
                                    <p>当指示为辅助实例创建初始化参数文件时，必须从源数据库复制该文件。这确保了辅助实例也是CDB。复制文件后，执行以下步骤：</p>
                                    <ul style="list-style-type:disc">
                                       <li>
                                          <p>修改<code class="codeph">DB_NAME</code>参数</p>
                                       </li>
                                       <li>
                                          <p>修改各种目标/位置参数</p>
                                       </li>
                                    </ul>
                                 </li>
                                 <li>
                                    <p>当指示连接到必要的实例时，以具有<code class="codeph">SYSDBA</code>或<code class="codeph">SYSBACKUP</code>权限的用户身份连接到root。在这两个实例上，执行复制的用户的密码必须相同。
                                    </p>
                                 </li>
                              </ul>
                           </div>
                        </li>
                        <li class="stepexpand"><span>启动RMAN并以具有<code class="codeph">SYSDBA</code>或<code class="codeph">SYSBACKUP</code>权限的用户身份连接到root。</span><div>
                              <p>在辅助实例和目标数据库上，执行复制的用户的密码必须相同。</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>如有必要，将源数据库置于适当的状态，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-8204DB9C-2BEF-419A-B96E-1B1C977F5AFE" title="如果RMAN作为TARGET连接到源数据库，则源数据库必须处于正确的复制状态。">将源数据库置于适当状态</a> ”中所述</span> 。</span></li>
                        <li class="stepexpand"><span>如有必要，配置RMAN通道，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-F2ED1190-E3BF-4898-BDCC-B9FF0500C76B" title="数据库复制的主要工作由RMAN通道执行。每个通道对应于执行复制任务的Oracle数据库服务器会话。根据复制技术，RMAN使用辅助通道或目标通道。">配置RMAN通道以用于复制</a> ”中所述</span> 。</span><div>
                              <p>复制的主要任务由RMAN通道执行。配置其他通道可提高复制性能。</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>使用<code class="codeph">FROM SPARSE</code>选项运行<code class="codeph">DUPLICATE</code>命令。</span><div>
                              <p>例如，以下命令将CDB复制到<code class="codeph">cdb2</code> ：</p><pre class="pre codeblock"><code>从SPARSE到cdb2 DATABASE的DUPICATE;</code></pre></div>
                        </li>
                     </ol>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-68742310-3B60-4246-9431-6671697AB516" name="GUID-68742310-3B60-4246-9431-6671697AB516"></a><h4 id="BRADV-GUID-68742310-3B60-4246-9431-6671697AB516" class="sect4"><span class="enumeration_section">25.5.3</span>复制PDB</h4>
                  <div>
                     <p>您可以将PDB复制到新的多租户容器数据库（CDB）或现有CDB。</p>
                     <p></p>
                     <p><span class="bold">话题：</span></p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="rman-duplicating-databases.html#GUID-8AEC7767-8572-435C-9320-8B589CA4F224" title="您可以使用DUPLICATE命令复制PDB中的单个PDB，一组PDB或一组表空间。">关于复制PDB</a></p>
                        </li>
                        <li>
                           <p><a href="rman-duplicating-databases.html#GUID-539E89F6-C0BC-49CB-8D8C-CD8FF88BAF32" title="将PDB复制到现有CDB受到某些限制。">将PDB复制到现有CDB的限制</a></p>
                        </li>
                        <li>
                           <p><a href="rman-duplicating-databases.html#GUID-23205E75-CFA8-4BCE-AC50-3D39DF040512" title="使用DUPLICATE命令将一个或多个PDB复制到新CDB。">将PDB复制到新CDB</a></p>
                        </li>
                        <li>
                           <p><a href="rman-duplicating-databases.html#GUID-9E630E2C-3D1B-4594-B738-4B5B43E50C58" title="使用DUPLICATE命令将PDB复制到现有CDB。">将PDB复制到现有CDB</a></p>
                        </li>
                        <li>
                           <p><a href="rman-duplicating-databases.html#GUID-404AF578-13E3-4E78-A089-BFCF99F84BF6" title="使用DUPLICATE命令复制稀疏可插拔数据库（PDB）。">复制稀疏PDB</a></p>
                        </li>
                     </ul>
                  </div>
                  <div class="sect4"><a id="GUID-8AEC7767-8572-435C-9320-8B589CA4F224" name="GUID-8AEC7767-8572-435C-9320-8B589CA4F224"></a><h5 id="BRADV-GUID-8AEC7767-8572-435C-9320-8B589CA4F224" class="sect5"><span class="enumeration_section">25.5.3.1</span>关于复制PDB</h5>
                     <div>
                        <p>您可以使用<code class="codeph">DUPLICATE</code>命令复制PDB中的单个PDB，一组PDB或一组表空间。
                        </p>
                        <p></p>
                        <p>要复制PDB，您必须以具有<code class="codeph">SYSDBA</code>或<code class="codeph">SYSBACKUP</code>权限的用户身份登录CDB的根目录。将PDB复制到新CDB时，必须将辅助实例创建为CDB。为此，请在初始化参数文件中使用声明<code class="codeph">enable_pluggable_database=TRUE</code>启动辅助实例。
                        </p>
                        <p>当您复制一个或多个PDB时，RMAN还会复制根（ <code class="codeph">CDB$ROOT</code> ）和CDB种子（ <code class="codeph">PDB$SEED</code> ）。生成的重复数据库是一个功能齐全的CDB，它包含根，CDB种子和重复的PDB。
                        </p>
                        <div class="tblformal" id="GUID-8AEC7767-8572-435C-9320-8B589CA4F224__GUID-84A6A762-7577-4A4F-AEC7-ACF76EE12416">
                           <p class="titleintable">表25-3复制PDB的技术</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="复制PDB的技术" border="1" summary="This table describes the techniques for duplicating PDBs and the RMAN commands used." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" id="d109284e4544">技术</th>
                                    <th align="left" valign="bottom" id="d109284e4546">描述</th>
                                    <th align="left" valign="bottom" id="d109284e4548">附加信息</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" id="d109284e4552" headers="d109284e4544 ">
                                       <p>将PDB复制到现有CDB</p>
                                    </td>
                                    <td align="left" valign="top" headers="d109284e4552 d109284e4546 ">
                                       <p>要将PDB复制到现有CDB，请使用<code class="codeph">DUPLICATE PLUGGABLE DATABASE</code> <span class="italic"><code class="codeph">pdb_name</code></span> <code class="codeph">TO</code> <span class="italic"><code class="codeph">cdb_name</code></span>语法。这里， <span class="italic"><code class="codeph">cdb_name</code></span>是现有CDB的名称。</p>
                                    </td>
                                    <td align="left" valign="top" headers="d109284e4552 d109284e4548 ">
                                       <p><a href="rman-duplicating-databases.html#GUID-9E630E2C-3D1B-4594-B738-4B5B43E50C58" title="使用DUPLICATE命令将PDB复制到现有CDB。">将PDB复制到现有CDB</a></p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" id="d109284e4584" headers="d109284e4544 ">
                                       <p>将指定的PDB复制到新CDB</p>
                                    </td>
                                    <td align="left" valign="top" headers="d109284e4584 d109284e4546 ">
                                       <p>使用以下技术之一：</p>
                                       <ul style="list-style-type:disc">
                                          <li>
                                             <p>使用以下语法将指定的PDB复制到新CDB：</p>
                                             <p><code class="codeph">DUPLICATE DATABASE TO</code> <span class="italic"><code class="codeph">cdb_name</code></span> <code class="codeph">PLUGGABLE DATABASE</code> <span class="italic"><code class="codeph">pdb_name;</code></span></p>
                                             <p>使用逗号分隔的列表复制多个PDB。</p>
                                          </li>
                                          <li>
                                             <p>使用以下语法将除<span class="italic">pdb_name</span>指定的PDB之外的所有PDB复制到新CDB：</p>
                                             <p><code class="codeph">DUPLICATE DATABASE TO</code> <span class="italic"><code class="codeph">cdb_name</code></span> <code class="codeph">SKIP PLUGGABLE DATABASE <span class="codeinlineitalic">pdb_name</span></code></p>
                                             <p>使用逗号分隔的列表指定必须排除的多个PDB。</p>
                                          </li>
                                       </ul>
                                    </td>
                                    <td align="left" valign="top" headers="d109284e4584 d109284e4548 ">
                                       <p><a href="rman-duplicating-databases.html#GUID-23205E75-CFA8-4BCE-AC50-3D39DF040512" title="使用DUPLICATE命令将一个或多个PDB复制到新CDB。">将PDB复制到新CDB</a></p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" id="d109284e4639" headers="d109284e4544 ">
                                       <p>将PDB中的指定表空间复制到新CDB</p>
                                    </td>
                                    <td align="left" valign="top" headers="d109284e4639 d109284e4546 ">
                                       <p>使用以下技术之一：</p>
                                       <ul style="list-style-type:disc">
                                          <li>
                                             <p>使用以下语法将PDB中的指定表空间复制到新CDB：</p>
                                             <p><code class="codeph">DUPLICATE DATABASE TO</code> <span class="italic"><code class="codeph">cdb_name</code></span> <code class="codeph">TABLESPACE <span class="codeinlineitalic">pdb_name:tablespace_name</span> ;</code></p>
                                             <p>表空间名称必须以包含表空间的PDB的名称为前缀。如果省略PDB的名称，则将root作为默认值。</p>
                                          </li>
                                          <li>
                                             <p>使用以下语法将CDB中的所有表空间（除了指定的表空间）复制到新的CDB：</p>
                                             <p><code class="codeph">DUPLICATE DATABASE TO</code> <span class="italic"><code class="codeph">cdb_name</code></span> <code class="codeph">SKIP TABLESPACE <span class="codeinlineitalic">pdb_name:tablespace_name</span></code></p>
                                          </li>
                                       </ul>
                                    </td>
                                    <td align="left" valign="top" headers="d109284e4639 d109284e4548 ">
                                       <p><a href="rman-duplicating-databases.html#GUID-37931808-C740-4216-A3BC-5D0716F9D890" title="您可以使用DUPLICATE命令将PDB中的一个或多个表空间复制到新CDB。">将PDB中的表空间复制到新CDB</a></p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-539E89F6-C0BC-49CB-8D8C-CD8FF88BAF32" name="GUID-539E89F6-C0BC-49CB-8D8C-CD8FF88BAF32"></a><h5 id="BRADV-GUID-539E89F6-C0BC-49CB-8D8C-CD8FF88BAF32" class="sect5"><span class="enumeration_section">25.5.3.2</span>将PDB复制到现有CDB的限制</h5>
                     <div>
                        <p>将PDB复制到现有CDB受到某些限制。</p>
                        <div class="section">
                           <p></p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>仅支持活动数据库复制。</p>
                                 <p></p>
                              </li>
                              <li>
                                 <p>仅支持<code class="codeph">DUPLICATE</code>命令的以下子句： <code class="codeph">NORESUME</code> ， <code class="codeph">DB_FILE_NAME_CONVERT</code> ， <code class="codeph">SECTION SIZE</code>和<code class="codeph">USING COMPRESSED BACKUPSET</code> 。</p>
                              </li>
                              <li>
                                 <p>不支持<code class="codeph">DUPLICATE</code>命令的以下子句： <code class="codeph">SPFILE</code> ， <code class="codeph">NO STANDBY</code> ， <code class="codeph">FARSYNC STANDBY</code>和<code class="codeph">LOG_FILE_NAME_CONVERT</code> 。</p>
                              </li>
                              <li>
                                 <p>不支持将PDB复制到作为备用数据库的CDB。</p>
                              </li>
                              <li>
                                 <p>一次只能复制一个PDB。</p>
                              </li>
                              <li>
                                 <p>不支持部分PDB复制，仅支持完整的PDB复制。例如，在复制PDB时，不能包含或排除特定的表空间。</p>
                              </li>
                              <li>
                                 <p>不支持在现有CDB中复制非CDB作为PDB。</p>
                              </li>
                              <li>
                                 <p>不支持复制包含TDE加密表空间的PDB。</p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-9E630E2C-3D1B-4594-B738-4B5B43E50C58" name="GUID-9E630E2C-3D1B-4594-B738-4B5B43E50C58"></a><h5 id="BRADV-GUID-9E630E2C-3D1B-4594-B738-4B5B43E50C58" class="sect5"><span class="enumeration_section">25.5.3.3</span>将PDB复制到现有CDB</h5>
                     <div>
                        <p>使用<code class="codeph">DUPLICATE</code>命令将PDB复制到现有CDB。</p>
                        <div class="p">
                           <p></p>
                           <p>要将PDB复制到现有CDB：</p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>确保满足所需的先决条件。这包括以下内容：</span><div>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p>活动数据库复制的先决条件</p>
                                    </li>
                                    <li>
                                       <p>将PDB复制到现有CDB的其他先决条件</p>
                                    </li>
                                 </ul>
                                 <p>请参见<a href="../rcmrf/DUPLICATE.html#RCMRF-GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4" target="_blank"><span><cite>Oracle数据库备份和恢复参考</cite></span></a> 。
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>查看将PDB复制到现有CDB的<span class="q"><a href="rman-duplicating-databases.html#GUID-539E89F6-C0BC-49CB-8D8C-CD8FF88BAF32" title="Duplicating a PDB to an existing CDB is subject to certain restrictions.">限制</a></span> ，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-539E89F6-C0BC-49CB-8D8C-CD8FF88BAF32" title="将PDB复制到现有CDB受到某些限制。">将PDB复制到现有CDB的限制</a> ”中所述</span> 。</span></li>
                           <li class="stepexpand"><span>选择用于命名重复数据库文件的策略，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-5293AB47-97AA-45A2-9D64-BA1287D3F7B9" title="复制数据库时，RMAN会为重复数据库中的数据库文件生成名称。这包括控制文件，数据文件，临时文件和联机重做日志文件。">选择命名重复数据库文件的策略</a> ”中所述</span> 。</span></li>
                           <li class="stepexpand"><span>创建在目标CDB上存储重复数据库文件的目录，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-2ECA94F4-E8EB-43D7-9934-39F2BE281700" title="在目标主机上，必须创建用于在目标主机上存储重复数据库文件的目录。这包括存储数据文件，控制文件，联机重做日志文件和临时文件的目录。">为重复数据库创建目录</a> ”中所述</span> 。</span></li>
                           <li class="stepexpand"><span>在源CDB和目标CDB之间建立Oracle网络连接，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-460171C8-2E09-4D0E-9AC3-A4C28392A220" title="对于某些形式的复制，您必须能够在源数据库和辅助实例之间建立连接。">在源数据库和辅助实例之间建立Oracle网络连接</a> ”中所述</span> 。</span></li>
                           <li class="stepexpand"><span>启动RMAN并进行以下连接：</span><div>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p>将<code class="codeph">AS TARGET</code>作为具有<code class="codeph">SYSDBA</code>或<code class="codeph">SYSBACKUP</code>权限的公共用户连接到源CDB的根目录。
                                       </p>
                                    </li>
                                    <li>
                                       <p>将<code class="codeph">AS AUXILIARY</code>作为具有<code class="codeph">SYSDBA</code>或<code class="codeph">SYSBACKUP</code>权限的公共用户连接到目标CDB的根目录。
                                       </p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li class="stepexpand"><span>确保目标CDB以读写模式打开。</span></li>
                           <li class="stepexpand"><span>如有必要，配置RMAN通道，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-F2ED1190-E3BF-4898-BDCC-B9FF0500C76B" title="数据库复制的主要工作由RMAN通道执行。每个通道对应于执行复制任务的Oracle数据库服务器会话。根据复制技术，RMAN使用辅助通道或目标通道。">配置RMAN通道以用于复制</a> ”中所述</span> 。</span><div>
                                 <p>复制的主要任务由RMAN通道执行。配置其他通道可提高复制性能。</p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>使用<code class="codeph">DUPLICATE PLUGGABLE DATABASE</code>命令复制PDB。</span><div>
                                 <p>以下命令将PDB <code class="codeph">mypdb</code>复制到现有CDB <code class="codeph">cdb_sales</code> 。
                                 </p><pre class="pre codeblock"><code>DUPLICATE PLUGGABLE DATABASE mypdb to cdb_sales DB_FILE_NAME_CONVERT（'cdb1'，'pdb1'）FROM ACTIVE DATABASE SECTION SIZE 400M;</code></pre><p>要在目标（重复）数据库中为PDB使用其他名称，请使用<code class="codeph">PLUGGABLE DATABASE mypdb AS pdb_dup TO cdb_sales</code>语法。
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>删除作为复制的一部分还原到<code class="codeph">remote_recovery_file_dest</code>初始化参数指定的位置的外部归档重做日志文件。</span></li>
                        </ol>
                        <div class="section">
                           <div class="infoboxnote" id="GUID-9E630E2C-3D1B-4594-B738-4B5B43E50C58__GUID-9F12DADF-CFB8-4306-9BDB-D306D44F99A4">
                              <p class="notep1">注意：</p>
                              <p>从Oracle Database Release 18c开始，支持将PDB复制到现有CDB。</p>
                           </div>
                           <div class="infoboxnotealso" id="GUID-9E630E2C-3D1B-4594-B738-4B5B43E50C58__GUID-A9C7A86E-5027-4A03-AAF3-A83B1383F6C2">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><a href="rman-duplicating-databases.html#GUID-8AEC7767-8572-435C-9320-8B589CA4F224" title="您可以使用DUPLICATE命令复制PDB中的单个PDB，一组PDB或一组表空间。">关于复制PDB</a></p>
                                 </li>
                                 <li>
                                    <p><a href="rman-duplicating-databases.html#GUID-3E8DE9F7-4A62-46D2-A0AE-7F25DCF6DEC3" title="此示例描述如何使用活动数据库复制将PDB复制到现有CDB中。">示例：使用主动复制将PDB复制到现有CDB</a></p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="BRADV760"></a><div class="sect4"><a id="GUID-23205E75-CFA8-4BCE-AC50-3D39DF040512" name="GUID-23205E75-CFA8-4BCE-AC50-3D39DF040512"></a><h5 id="BRADV-GUID-23205E75-CFA8-4BCE-AC50-3D39DF040512" class="sect5"><span class="enumeration_section">25.5.3.4</span>将PDB复制到新CDB</h5>
                     <div>
                        <p>使用<code class="codeph">DUPLICATE</code>命令将一个或多个PDB复制到新CDB。</p>
                        <div class="section">
                           <p>要将PDB复制到新CDB：</p>
                           <ol>
                              <li>
                                 <p>完成<span class="q">“ <a href="rman-duplicating-databases.html#GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" title="在复制数据库之前，您必须对复制过程做出一些决定。">计划复制数据库</a> ”中</span>描述的计划任务，并进行以下更改：</p>
                                 <p>在<span class="q">“ <a href="rman-duplicating-databases.html#GUID-08282A88-3810-4C70-91D6-5C7582D5787D" title="复制期间使用的备份名称存储在RMAN存储库或控制文件中。">使备份可访问重复实例</a> ”</span>和<span class="q">“ <a href="rman-duplicating-databases-advanced.html#GUID-C575132F-23DE-47E5-8FFD-01F986F6CD13" title="您可以使用共享磁盘技术使备份可用于辅助实例。如果NFS或共享磁盘不是选项，则存储备份的路径必须同时存在于源主机和目标主机上，除非BACKUP LOCATION选项用于没有目标或恢复目录连接的DUPLICATE命令。">使磁盘备份无法访问共享磁盘</a> ”中</span> ，请注意以下调整：</p>
                                 <p>使用<code class="codeph">BACKUP</code>命令的<code class="codeph">PLUGGABLE DATABASE</code>语法仅复制特定PDB的备份。</p>
                                 <p>例如，以下命令仅传输PDB <code class="codeph">pdb3</code>的备份文件：</p>
                                 <p><code class="codeph">备份数据库的可插入数据库pdb3;</code></p>
                              </li>
                              <li>
                                 <p>确保满足所选复制技术的先决条件，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-7FDB9916-8FB9-471A-8EFD-26E34FB8EA25" title="先决条件取决于正在执行的数据库重复的类型。某些先决条件对于所有类型的复制都是通用的，而其他先决条件则特定于特定类型的复制。">复制数据库的先决条件</a> ”中所述</span> 。
                                 </p>
                              </li>
                              <li>
                                 <p>按照<span class="q">“ <a href="rman-duplicating-databases.html#GUID-FCE67CCA-78B3-47E4-8D1B-75C8719BD51A" title="RMAN uses an auxiliary instance to create the duplicate database. You must prepare the auxiliary instance before you begin the duplication.">准备辅助实例</a> ”中的说明<a href="rman-duplicating-databases.html#GUID-FCE67CCA-78B3-47E4-8D1B-75C8719BD51A" title="RMAN使用辅助实例来创建重复数据库。在开始复制之前，必须准备辅助实例。">准备辅助实例</a></span> ，并进行以下更改：</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p>您必须将辅助实例创建为CDB。为此，请在初始化参数文件中使用以下声明启动实例：</p>
                                       <p><code class="codeph">enable_pluggable_database = TRUE</code></p>
                                    </li>
                                    <li>
                                       <p>当指示为辅助实例创建初始化参数文件时，必须从源数据库复制该文件。这确保了辅助实例也是CDB。复制文件后，执行以下步骤：</p>
                                       <ul style="list-style-type:disc">
                                          <li>
                                             <p>修改<code class="codeph">DB_NAME</code>参数</p>
                                          </li>
                                          <li>
                                             <p>修改各种目标/位置参数</p>
                                          </li>
                                       </ul>
                                    </li>
                                    <li>
                                       <p>当指示连接到必要的实例时，以具有<code class="codeph">SYSDBA</code>或<code class="codeph">SYSBACKUP</code>权限的用户身份连接到root。在这两个实例上，执行复制的用户的密码必须相同。
                                       </p>
                                    </li>
                                 </ul>
                              </li>
                              <li>
                                 <p>启动RMAN并以具有<code class="codeph">SYSDBA</code>或<code class="codeph">SYSBACKUP</code>权限的用户身份连接到root。
                                 </p>
                                 <p>在辅助实例和目标数据库上，执行复制的用户的密码必须相同。</p>
                              </li>
                              <li>
                                 <p>如有必要，将源数据库置于适当的状态，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-8204DB9C-2BEF-419A-B96E-1B1C977F5AFE" title="如果RMAN作为TARGET连接到源数据库，则源数据库必须处于正确的复制状态。">将源数据库置于适当状态</a> ”中所述</span> 。
                                 </p>
                              </li>
                              <li>
                                 <p>如有必要，配置RMAN通道，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-F2ED1190-E3BF-4898-BDCC-B9FF0500C76B" title="数据库复制的主要工作由RMAN通道执行。每个通道对应于执行复制任务的Oracle数据库服务器会话。根据复制技术，RMAN使用辅助通道或目标通道。">配置RMAN通道以用于复制</a> ”中所述</span> 。
                                 </p>
                                 <p>复制的主要任务由RMAN通道执行。配置其他通道可提高复制性能。</p>
                              </li>
                              <li>
                                 <p>使用<code class="codeph">DUPLICATE … PLUGGABLE DATABASE</code>命令复制PDB。
                                 </p>
                              </li>
                           </ol>
                           <p><span class="bold">示例：复制PDB</span></p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>要将PDB <code class="codeph">pdb1</code>复制到CDB <code class="codeph">cdb1</code> ，请使用以下命令：</p>
                                 <p><code class="codeph">DUPLICATE DATABASE TO cdb1 PLUGGABLE DATABASE pdb1;</code></p>
                              </li>
                              <li>
                                 <p>要将PDB <code class="codeph">pdb1</code> ， <code class="codeph">pdb3</code>和<code class="codeph">pdb4</code>到数据库<code class="codeph">cdb1</code> ，请使用以下命令：</p>
                                 <p><code class="codeph">DUPLICATE DATABASE TO cdb1 PLUGGABLE DATABASE pdb1，pdb3，pdb4;</code></p>
                              </li>
                              <li>
                                 <p>要复制CDB中的所有PDB（PDB <code class="codeph">pdb3</code>除外），请使用以下命令：</p>
                                 <p><code class="codeph">DUPLICATE DATABASE TO cdb1 SKIP PLUGGABLE DATABASE pdb3;</code></p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <div class="infoboxnotealso" id="GUID-23205E75-CFA8-4BCE-AC50-3D39DF040512__GUID-60C70C79-413A-4EA0-990F-644F0382EA72">
                              <p class="notep1">也可以看看：</p>
                              <p><a href="rman-duplicating-databases.html#GUID-8AEC7767-8572-435C-9320-8B589CA4F224" title="您可以使用DUPLICATE命令复制PDB中的单个PDB，一组PDB或一组表空间。">关于复制PDB</a></p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-404AF578-13E3-4E78-A089-BFCF99F84BF6" name="GUID-404AF578-13E3-4E78-A089-BFCF99F84BF6"></a><h5 id="BRADV-GUID-404AF578-13E3-4E78-A089-BFCF99F84BF6" class="sect5"><span class="enumeration_section">25.5.3.5</span>复制稀疏PDB</h5>
                     <div>
                        <p>使用<code class="codeph">DUPLICATE</code>命令复制稀疏可插拔数据库（PDB）。
                        </p>
                        <div class="section"><span class="bold">复制稀疏PDB：</span></div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>完成<span class="q">“ <a href="rman-duplicating-databases.html#GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" title="在复制数据库之前，您必须对复制过程做出一些决定。">计划复制数据库</a> ”中</span>描述的计划任务，并进行以下更改：</span><div>
                                 <p>在<span class="q">“ <a href="rman-duplicating-databases.html#GUID-08282A88-3810-4C70-91D6-5C7582D5787D" title="复制期间使用的备份名称存储在RMAN存储库或控制文件中。">使备份可访问重复实例</a> ”</span>和<span class="q">“ <a href="rman-duplicating-databases-advanced.html#GUID-C575132F-23DE-47E5-8FFD-01F986F6CD13" title="您可以使用共享磁盘技术使备份可用于辅助实例。如果NFS或共享磁盘不是选项，则存储备份的路径必须同时存在于源主机和目标主机上，除非BACKUP LOCATION选项用于没有目标或恢复目录连接的DUPLICATE命令。">使磁盘备份无需共享磁盘</a> ”下</span> ，使用<code class="codeph">BACKUP</code>命令的<code class="codeph">PLUGGABLE DATABASE</code>语法仅复制特定PDB的备份。</p>
                                 <p>例如，以下命令仅传输PDB <code class="codeph">pdb3</code>的备份文件：</p>
                                 <p><code class="codeph">备份数据库的可插入数据库pdb3;</code></p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>确保满足所选复制技术的先决条件，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-7FDB9916-8FB9-471A-8EFD-26E34FB8EA25" title="先决条件取决于正在执行的数据库重复的类型。某些先决条件对于所有类型的复制都是通用的，而其他先决条件则特定于特定类型的复制。">复制数据库的先决条件</a> ”中所述</span> 。</span></li>
                           <li class="stepexpand"><span>按照<span class="q">“ <a href="rman-duplicating-databases.html#GUID-FCE67CCA-78B3-47E4-8D1B-75C8719BD51A" title="RMAN uses an auxiliary instance to create the duplicate database. You must prepare the auxiliary instance before you begin the duplication.">准备辅助实例</a> ”中的说明<a href="rman-duplicating-databases.html#GUID-FCE67CCA-78B3-47E4-8D1B-75C8719BD51A" title="RMAN使用辅助实例来创建重复数据库。在开始复制之前，必须准备辅助实例。">准备辅助实例</a></span> ，并进行以下更改：</span><div>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p>将辅助实例创建为CDB。为此，请在初始化参数文件中使用以下声明启动实例：</p>
                                       <p><code class="codeph">enable_pluggable_database = TRUE</code></p>
                                    </li>
                                    <li>
                                       <p>当指示为辅助实例创建初始化参数文件时，必须从源数据库复制该文件。这确保了辅助实例也是CDB。复制后，执行以下步骤：</p>
                                       <ul style="list-style-type:disc">
                                          <li>
                                             <p>修改<code class="codeph">DB_NAME</code>参数</p>
                                          </li>
                                          <li>
                                             <p>修改各种目标/位置参数</p>
                                          </li>
                                       </ul>
                                    </li>
                                    <li>
                                       <p>当指示连接到必要的实例时，以具有<code class="codeph">SYSDBA</code>或<code class="codeph">SYSBACKUP</code>权限的用户身份连接到root。在这两个实例上，执行复制的用户的密码必须相同。
                                       </p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li class="stepexpand"><span>启动RMAN并以具有<code class="codeph">SYSDBA</code>或<code class="codeph">SYSBACKUP</code>权限的用户身份连接到root。</span><div>
                                 <p>在辅助实例和目标数据库上，执行复制的用户的密码必须相同。</p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>将源数据库置于适当的状态（如有必要），如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-8204DB9C-2BEF-419A-B96E-1B1C977F5AFE" title="如果RMAN作为TARGET连接到源数据库，则源数据库必须处于正确的复制状态。">将源数据库置于适当状态</a> ”中所述</span> 。</span></li>
                           <li class="stepexpand"><span>（可选）配置RMAN通道以提高复制性能，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-F2ED1190-E3BF-4898-BDCC-B9FF0500C76B" title="数据库复制的主要工作由RMAN通道执行。每个通道对应于执行复制任务的Oracle数据库服务器会话。根据复制技术，RMAN使用辅助通道或目标通道。">配置RMAN通道以用于复制</a> ”中所述</span> 。</span></li>
                           <li class="stepexpand"><span>使用<code class="codeph">PLUGGABLE DATABASE</code>和<code class="codeph">FROM SPARSE</code>选项运行<code class="codeph">DUPLICATE</code>命令。</span><div>
                                 <p>要将PDB <code class="codeph">pdb1</code>复制到CDB <code class="codeph">cdb2</code> ，请运行以下命令：</p><pre class="pre codeblock"><code>从SPARSE重复到cdb2 PLUGGABLE DATABASE pdb1;</code></pre><div class="infoboxnote" id="GUID-404AF578-13E3-4E78-A089-BFCF99F84BF6__GUID-C4E36EE9-BE3A-4C27-AA7F-202EF48F8971">
                                    <p class="notep1">注意：</p>
                                    <p>稀疏数据库中的基本（只读）数据文件未加密。确保基础数据文件存储在受保护的存储中，并使用安全通信进行访问。</p>
                                 </div>
                              </div>
                           </li>
                        </ol>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-37931808-C740-4216-A3BC-5D0716F9D890" name="GUID-37931808-C740-4216-A3BC-5D0716F9D890"></a><h4 id="BRADV-GUID-37931808-C740-4216-A3BC-5D0716F9D890" class="sect4"><span class="enumeration_section">25.5.4</span>将PDB中的表空间复制到新CDB</h4>
                  <div>
                     <p>您可以使用<code class="codeph">DUPLICATE</code>命令将PDB中的一个或多个表空间复制到新CDB。
                     </p>
                     <div class="section">
                        <p>要在PDB中复制表空间：</p>
                        <ol>
                           <li>
                              <p>确保已完成<a href="rman-duplicating-databases.html#GUID-23205E75-CFA8-4BCE-AC50-3D39DF040512" title="使用DUPLICATE命令将一个或多个PDB复制到新CDB。">将PDB复制到新CDB的</a>步骤1到4。</p>
                           </li>
                           <li>
                              <p>使用<a href="rman-duplicating-databases.html#GUID-8AEC7767-8572-435C-9320-8B589CA4F224" title="您可以使用DUPLICATE命令复制PDB中的单个PDB，一组PDB或一组表空间。">关于复制PDB中</a>描述的<code class="codeph">TABLESPACE</code>选项运行<code class="codeph">DUPLICATE</code>命令。
                              </p>
                              <p>以下是复制PDB中包含的表空间的一些示例：</p>
                              <p>要复制属于PDB <code class="codeph">pdb1</code>的<code class="codeph">users</code>表空间，请使用以下命令：</p>
                              <p><code class="codeph">DUPLICATE DATABASE TO cdb1 TABLESPACE pdb1：users;</code></p>
                              <p>要复制PDB <code class="codeph">pdb1</code>和PDB用户表<code class="codeph">pdb2</code> ，请使用以下命令：</p>
                              <p><code class="codeph"><code class="codeph">DUPLICATE DATABASE TO cdb1 PLUGGABLE DATABASE pdb1 TABLESPACE pdb2：users;</code></code></p>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-46F814AD-1457-4C46-B603-19A9D617D01C" name="GUID-46F814AD-1457-4C46-B603-19A9D617D01C"></a><h3 id="BRADV-GUID-46F814AD-1457-4C46-B603-19A9D617D01C" class="sect3"><span class="enumeration_section">25.6将</span>数据库复制到Oracle Cloud</h3>
               <div>
                  <p>使用<code class="codeph">DUPLICATE</code>命令将内部部署数据库复制到Oracle Cloud。支持基于备份和主动复制。
                  </p>
                  <div class="section">
                     <p></p>
                     <p>Oracle Cloud上的Oracle数据库始终是加密的。因此，当您将数据库或数据库的一部分复制到Oracle Cloud时，即使在复制期间未指定加密子句，也会加密在Oracle Cloud中创建的任何表空间。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="p">源和Oracle Cloud数据库的<code class="codeph">COMPATIBLE</code>参数必须设置为18.0.0或更高。
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>确保满足所选复制技术的先决条件。建议您使用活动数据库复制。</span><div>
                           <p>请参阅<span class="q">“ <a href="rman-duplicating-databases.html#GUID-7FDB9916-8FB9-471A-8EFD-26E34FB8EA25" title="先决条件取决于正在执行的数据库重复的类型。某些先决条件对于所有类型的复制都是通用的，而其他先决条件则特定于特定类型的复制。">复制数据库的先决条件</a> ”</span> 。
                           </p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>配置Oracle数据库云备份模块。此备份模块是SBT接口，使您可以对Oracle Cloud执行备份和恢复操作。</span><div>
                           <p>有关安装Oracle数据库云备份模块的信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=CSDBB-GUID-483BAC13-854B-4044-9569-0FAD313AD126" target="_blank"><span class="italic">Oracle Cloud使用Oracle数据库备份服务</span></a></p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>完成计划任务，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" title="在复制数据库之前，您必须对复制过程做出一些决定。">计划复制数据库</a> ”中所述</span> 。</span></li>
                     <li class="stepexpand"><span>准备辅助实例，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-FCE67CCA-78B3-47E4-8D1B-75C8719BD51A" title="RMAN使用辅助实例来创建重复数据库。在开始复制之前，必须准备辅助实例。">准备辅助实例</a> ”中所述</span> ，在复制CDB时进行以下更改：</span><div>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>您必须将辅助实例创建为CDB。为此，请在初始化参数文件中使用以下声明启动实例：</p>
                                 <p><code class="codeph">enable_pluggable_database = TRUE</code></p>
                              </li>
                              <li>
                                 <p>当指示为辅助实例创建初始化参数文件时，必须从源数据库复制该文件。这确保了辅助实例也是CDB。复制文件后，执行以下步骤：</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p>修改<code class="codeph">DB_NAME</code>参数</p>
                                    </li>
                                    <li>
                                       <p>修改各种目标/位置参数</p>
                                    </li>
                                 </ul>
                              </li>
                              <li>
                                 <p>以<code class="codeph">NOMOUNT</code>模式启动辅助实例。
                                 </p>
                              </li>
                           </ul>
                           <div class="infoboxnote" id="GUID-46F814AD-1457-4C46-B603-19A9D617D01C__GUID-B6622F9E-57AE-44A5-AC03-5C14595925CC">
                              <p class="notep1">注意：</p>
                              <p>由于必须在Oracle Cloud上创建辅助实例，因此Oracle Cloud管理员必须执行准备辅助实例的步骤。</p>
                           </div>
                        </div>
                     </li>
                     <li class="stepexpand"><span>启动RMAN并以具有<code class="codeph">SYSDBA</code>或<code class="codeph">SYSBACKUP</code>权限的公共用户身份连接到root。</span><div>
                           <p>在辅助实例和目标数据库上，执行复制的用户的密码必须相同。</p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>如果源CDB使用加密，则打开包含源CDB上主密钥的Oracle密钥库。</span></li>
                     <li class="stepexpand"><span>如有必要，配置RMAN通道，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-F2ED1190-E3BF-4898-BDCC-B9FF0500C76B" title="数据库复制的主要工作由RMAN通道执行。每个通道对应于执行复制任务的Oracle数据库服务器会话。根据复制技术，RMAN使用辅助通道或目标通道。">配置RMAN通道以用于复制</a> ”中所述</span> 。</span><div>
                           <p>RMAN通道执行复制的主要任务。配置其他通道可提高复制性能。</p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>在目标CDB上，从源CDB打开Oracle密钥库。</span><div>
                           <p>如果目标CDB使用基于密码的软件密钥库，则必须指定用于打开此密钥库的密码。以下命令设置用于打开基于密码的软件密钥库的<span class="italic">密码（</span>使用密钥库密码替换密码）：</p><pre class="pre codeblock"><code>SET DECRYPTION钱包由' <span class="italic">密码</span> '识别;</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>使用<code class="codeph">DUPLICATE</code>命令复制源CDB。</span><div>
                           <p>请参阅<span class="q">“ <a href="rman-duplicating-databases.html#GUID-571FD3C7-BF5A-4CF4-970A-9F8CAC3DF1F1" title="RMAN使用DUPLICATE命令为复制数据库提供了多个选项。">使用DUPLICATE命令复制数据库</a> ”</span> 。
                           </p>
                        </div>
                     </li>
                  </ol>
                  <div class="section">
                     <div class="infoboxnote" id="GUID-46F814AD-1457-4C46-B603-19A9D617D01C__GUID-3D35CCCA-D8CA-4A13-9F92-052EA9836AA4">
                        <p class="notep1">注意：</p>
                        <p>不支持使用复制为Oracle Cloud创建备用数据库。</p>
                     </div>
                     <div class="infoboxnotealso" id="GUID-46F814AD-1457-4C46-B603-19A9D617D01C__GUID-7B587ACA-4378-4465-8342-A8794B36D90E">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="https://docs.us-phoenix-1.oraclecloud.com/Content/Database/Tasks/mig-rman-duplicate-active-database.htm#RMANDUPLICATEfromanActiveDatabase" target="_blank">RMAN从活动数据库复制，以</a>获取有关将数据库复制到Oracle Cloud Infrastructure的更多详细信息</p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
            <div class="sect2"><a id="GUID-4438284A-8177-4654-8C5C-0D60BEA7E857" name="GUID-4438284A-8177-4654-8C5C-0D60BEA7E857"></a><h3 id="BRADV-GUID-4438284A-8177-4654-8C5C-0D60BEA7E857" class="sect3"><span class="enumeration_section">25.7</span>将Oracle云数据库复制为内部部署数据库</h3>
               <div>
                  <p>使用<code class="codeph">DUPLICATE</code>命令将Oracle云数据库复制为内部部署数据库。支持基于备份和主动复制。
                  </p>
                  <div class="section">
                     <p></p>
                     <p>Oracle Cloud数据库始终是加密的。从Oracle Cloud复制数据库时，必须将存储主密钥的Oracle密钥库复制到内部部署数据库。需要此密钥才能解密从Oracle Cloud数据库复制的数据文件。重复数据库可能使用也可能不使用加密。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="p">源和目标数据库的<code class="codeph">COMPATIBLE</code>参数必须设置为18.0.0或更高。
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>确保满足所选复制技术的先决条件，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-7FDB9916-8FB9-471A-8EFD-26E34FB8EA25" title="先决条件取决于正在执行的数据库重复的类型。某些先决条件对于所有类型的复制都是通用的，而其他先决条件则特定于特定类型的复制。">复制数据库的先决条件</a> ”中所述</span> 。建议您使用活动数据库复制。</span></li>
                     <li class="stepexpand"><span>配置Oracle数据库云备份模块。此备份模块是SBT接口，使您可以对Oracle Cloud执行备份和恢复操作。</span><div>
                           <p>有关安装Oracle数据库云备份模块的信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=CSDBB-GUID-483BAC13-854B-4044-9569-0FAD313AD126" target="_blank"><span class="italic">Oracle Cloud使用Oracle数据库备份服务</span></a></p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>完成<span class="q">“ <a href="rman-duplicating-databases.html#GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" title="在复制数据库之前，您必须对复制过程做出一些决定。">计划复制数据库</a> ”中</span>描述的计划任务。</span></li>
                     <li class="stepexpand"><span>按照<span class="q">“ <a href="rman-duplicating-databases.html#GUID-FCE67CCA-78B3-47E4-8D1B-75C8719BD51A" title="RMAN uses an auxiliary instance to create the duplicate database. You must prepare the auxiliary instance before you begin the duplication.">准备辅助实例</a> ”中的说明<a href="rman-duplicating-databases.html#GUID-FCE67CCA-78B3-47E4-8D1B-75C8719BD51A" title="RMAN使用辅助实例来创建重复数据库。在开始复制之前，必须准备辅助实例。">准备辅助实例</a></span> ，并进行以下更改：</span><div>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>您必须将辅助实例创建为CDB。为此，请在初始化参数文件中使用以下声明启动实例：</p>
                                 <p><code class="codeph">enable_pluggable_database = TRUE</code></p>
                              </li>
                              <li>
                                 <p>当指示为辅助实例创建初始化参数文件时，必须从源数据库复制该文件。这确保了辅助实例也是CDB。复制文件后，执行以下步骤：</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p>修改<code class="codeph">DB_NAME</code>参数</p>
                                    </li>
                                    <li>
                                       <p>修改各种目标/位置参数</p>
                                    </li>
                                 </ul>
                              </li>
                              <li>
                                 <p>当指示连接到必要的实例时，启动RMAN并以具有<code class="codeph">SYSDBA</code>或<code class="codeph">SYSBACKUP</code>权限的公共用户身份连接到root。在这两个实例上，执行复制的用户的密码必须相同。
                                 </p>
                              </li>
                           </ul>
                        </div>
                     </li>
                     <li class="stepexpand"><span>将Oracle密钥库从Oracle Cloud复制到辅助实例。</span><div>
                           <p>辅助实例需要先解密Oracle云中的数据文件，然后再使用Oracle Cloud数据库中的Oracle密钥库对其进行加密。</p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>如有必要，配置RMAN通道，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-F2ED1190-E3BF-4898-BDCC-B9FF0500C76B" title="数据库复制的主要工作由RMAN通道执行。每个通道对应于执行复制任务的Oracle数据库服务器会话。根据复制技术，RMAN使用辅助通道或目标通道。">配置RMAN通道以用于复制</a> ”中所述</span> 。</span><div>
                           <p>复制的主要任务由RMAN通道执行。配置其他通道可提高复制性能。</p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>在辅助实例上，打开从源Oracle Cloud数据库复制的Oracle密钥库。</span><div>
                           <p>如果目标CDB使用基于密码的软件密钥库，则必须指定用于打开此密钥库的密码。以下命令设置用于打开基于密码的软件密钥库的<span class="italic">密码（</span>使用密钥库密码替换密码）：</p><pre class="pre codeblock"><code>SET DECRYPTION钱包由' <span class="italic">密码</span> '识别;</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>使用<code class="codeph">DUPLICATE</code>命令复制源CDB。</span><div>
                           <p>要创建不使用加密的重复数据库，请使用<code class="codeph">DUPLICATE</code>命令中的<code class="codeph">AS DECRYPTED</code>选项。例如：</p><pre class="pre codeblock"><code>DUPLICATE DATABASE到my_cdb FROM ACTIVE DATABASE as decryptED;</code></pre><p>请参阅<span class="q">“ <a href="rman-duplicating-databases.html#GUID-571FD3C7-BF5A-4CF4-970A-9F8CAC3DF1F1" title="RMAN使用DUPLICATE命令为复制数据库提供了多个选项。">使用DUPLICATE命令复制数据库</a> ”</span> 。
                           </p>
                        </div>
                     </li>
                  </ol>
                  <div class="section">
                     <div class="infoboxnote" id="GUID-4438284A-8177-4654-8C5C-0D60BEA7E857__GUID-FCFFECE0-B88F-42CA-A30D-33E555339064">
                        <p class="notep1">注意：</p>
                        <p>不支持使用<code class="codeph">AS ENCRYPTED</code>或<code class="codeph">AS DECRYPTED</code>复制<code class="codeph">AS STANDBY</code> 。
                        </p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
            <div class="sect2"><a id="GUID-4A9A4F04-0D65-4BC0-AE4B-EFBD453D017F" name="GUID-4A9A4F04-0D65-4BC0-AE4B-EFBD453D017F"></a><h3 id="BRADV-GUID-4A9A4F04-0D65-4BC0-AE4B-EFBD453D017F" class="sect3"><span class="enumeration_section">25.8</span>失败后重启DUPLICATE</h3>
               <div>
                  <p>RMAN自动优化<code class="codeph">DUPLICATE</code>命令，该命令是先前失败的<code class="codeph">DUPLICATE</code>命令的<code class="codeph">DUPLICATE</code> 。
                  </p>
                  <div class="section">repeat <code class="codeph">DUPLICATE</code>命令注意到之前成功复制了哪些数据文件，并且不再复制它们。这适用于所有形式的复制，无论它们是基于备份的（有或没有目标连接）或活动数据库复制。当在非常大的数据库的复制期间发生故障时， <code class="codeph">DUPLICATE</code>命令的自动优化尤其有用。
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>要重新启动重复操作：</p>
                     <ol>
                        <li>
                           <p>退出RMAN。</p>
                        </li>
                        <li>
                           <p>启动SQL * Plus并使用<code class="codeph">SYSDBA</code>或<code class="codeph">SYSBACKUP</code>权限连接到辅助实例。使用您最初使用的相同<code class="codeph">SPFILE</code>或<code class="codeph">PFILE</code>规范以<code class="codeph">NOMOUNT</code>模式启动辅助实例。如果您最初省略了此规范，则在此处再次省略它。
                           </p>
                           <p>此示例使用文件<code class="codeph">/home/my_pfile.ora</code>的参数启动辅助实例：</p><pre class="pre codeblock"><code>STARTUP FORCE PFILE = / home / my_pfile.ora</code></pre></li>
                        <li>
                           <p>退出SQL * Plus并启动RMAN。</p>
                        </li>
                        <li>
                           <p>最初连接到相同的数据库。</p>
                        </li>
                        <li>
                           <p>重复<code class="codeph">DUPLICATE</code>命令。
                           </p>
                           <div class="p">第二个<code class="codeph">DUPLICATE</code>操作：<ul style="list-style-type:disc">
                                 <li>
                                    <p>找到初始<code class="codeph">DUPLICATE</code>命令成功复制的数据文件。
                                    </p>
                                 </li>
                                 <li>
                                    <p>对于不需要再次复制的每个数据文件，显示类似于以下内容的消息：</p><pre class="pre codeblock"><code>RMAN-05560：使用先前的重复文件/oradata/new/data01.f作为数据文件1，检查点SCN为1654665</code></pre></li>
                                 <li>
                                    <p>仅还原丢失或不完整的数据文件，从而避免重新复制和还原所有数据文件。</p>
                                 </li>
                              </ul>如果您不希望RMAN从失败的<code class="codeph">DUPLICATE</code>操作中自动恢复，请指定关键字<code class="codeph">NORESUME</code>以禁用该功能。在第一次调用<code class="codeph">DUPLICATE</code>使用关键字<code class="codeph">NORESUME</code>可防止新数据库的后续<code class="codeph">DUPLICATE</code>命令使用此自动优化。
                           </div>
                        </li>
                     </ol>
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
            <div class="sect2"><a id="GUID-EA6E8219-56BF-471C-AC5A-DFC55E760806" name="GUID-EA6E8219-56BF-471C-AC5A-DFC55E760806"></a><h3 id="BRADV-GUID-EA6E8219-56BF-471C-AC5A-DFC55E760806" class="sect3"><span class="enumeration_section">25.9</span>示例：复制数据库</h3>
               <div>
                  <p>本节包含使用不同复制技术复制数据库的示例。</p>
                  <div class="infoboxnotealso" id="GUID-EA6E8219-56BF-471C-AC5A-DFC55E760806__GUID-9BF537AB-FF5A-432B-9800-BE012E6AC0FE">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="rman-duplicating-databases.html#GUID-187339D5-ABD1-472E-92C7-83CCD21DB8D8" title="此示例描述如何使用活动数据库复制将数据库复制到远程ASM主机。">示例：使用带备份集的活动数据库复制将数据库复制到远程ASM主机</a></p>
                        </li>
                        <li>
                           <p><a href="rman-duplicating-databases.html#GUID-815B6F9A-7B64-47B3-A68F-B62CECAE141D" title="此示例使用活动数据库复制和映像副本将数据库复制到远程主机。">示例：使用带有映像副本的活动数据库复制将数据库复制到远程主机</a></p>
                        </li>
                        <li>
                           <p><a href="rman-duplicating-databases.html#GUID-0AA76E9C-72CD-41CD-989E-BFA97857FC06" title="此示例描述如何在没有目标连接或恢复目录的情况下使用基于备份的复制来执行到远程主机的复制。">示例：使用基于备份的复制而不使用目标连接或恢复目录将数据库复制到远程主机</a></p>
                        </li>
                        <li>
                           <p><a href="rman-duplicating-databases.html#GUID-CDD05468-F1A7-4CCD-AE54-C5AF87965573" title="此示例介绍如何通过使用基于备份的复制与恢复目录来执行到远程主机的复制。">示例：使用基于备份的复制和恢复目录将数据库复制到远程主机</a></p>
                        </li>
                        <li>
                           <p><a href="rman-duplicating-databases.html#GUID-86A4A8B2-F699-474B-A29E-955DDCF78B56" title="此示例描述如何通过使用目标连接的基于备份的复制来执行到远程主机的复制。">示例：使用基于备份的目标连接复制将数据库复制到远程主机</a></p>
                        </li>
                        <li>
                           <p><a href="rman-duplicating-databases.html#GUID-E9A97E86-8E83-4205-B76E-6AD013CEFDED" title="此示例使用活动数据库复制将数据库复制到本地主机。">示例：使用活动数据库复制将数据库复制到本地主机</a></p>
                        </li>
                        <li>
                           <p><a href="rman-duplicating-databases.html#GUID-49C686AA-587F-4F1C-9053-B58EB5581B6E" title="此示例描述如何使用活动数据库复制将PDB复制到新CDB。">示例：使用活动数据库复制将PDB复制到新CDB</a></p>
                        </li>
                        <li>
                           <p><a href="rman-duplicating-databases.html#GUID-3E8DE9F7-4A62-46D2-A0AE-7F25DCF6DEC3" title="此示例描述如何使用活动数据库复制将PDB复制到现有CDB中。">示例：使用主动复制将PDB复制到现有CDB</a></p>
                        </li>
                        <li>
                           <p><a href="rman-duplicating-databases.html#GUID-915D2CB7-29AB-46E6-B923-3CF419F59362" title="RMAN使您可以使用DUPLICATE命令通过使用加密备份执行基于备份的复制。">示例：使用加密备份执行基于备份的复制</a></p>
                        </li>
                     </ul>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-187339D5-ABD1-472E-92C7-83CCD21DB8D8" name="GUID-187339D5-ABD1-472E-92C7-83CCD21DB8D8"></a><h4 id="BRADV-GUID-187339D5-ABD1-472E-92C7-83CCD21DB8D8" class="sect4"><span class="enumeration_section">25.9.1</span>示例：使用带备份集的活动数据库复制将数据库复制到远程ASM主机</h4>
                  <div>
                     <p>此示例描述如何使用活动数据库复制将数据库复制到远程ASM主机。</p>
                     <div class="section">此示例假定以下情形：<ul style="list-style-type:disc">
                           <li>
                              <p>源主机和目标主机是不同的。</p>
                           </li>
                           <li>
                              <p>源数据库和重复数据库都使用ASM管理数据库文件。</p>
                           </li>
                           <li>
                              <p>重复的数据库文件使用与源数据库不同的目录结构。</p>
                           </li>
                           <li>
                              <p>源主机上的网络带宽有限。</p>
                           </li>
                           <li>
                              <p>复制过程完成后，必须打开重复的数据库。</p>
                           </li>
                        </ul>
                        <p>使用以下步骤为此示例中描述的方案创建重复数据库：</p>
                        <ol>
                           <li>
                              <p>按照<span class="q">“ <a href="rman-duplicating-databases.html#GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" title="Before duplicating a database, you must make some decisions about the duplication process.">计划复制数据库</a> ”中的说明<a href="rman-duplicating-databases.html#GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" title="在复制数据库之前，您必须对复制过程做出一些决定。">规划复制</a></span> 。
                              </p>
                              <div class="p">这包括以下任务：<ul style="list-style-type:disc">
                                    <li>
                                       <p>选择适合场景和要求的复制技术。</p>
                                       <p>由于源主机上的网络带宽有限，因此将执行使用备份集的活动数据库复制。</p>
                                    </li>
                                    <li>
                                       <p>选择策略以命名重复的数据库文件。</p>
                                       <p>在此示例中， <code class="codeph">DB_CREATE_FILE_DEST</code>初始化参数用于指定重复数据库文件的位置。
                                       </p>
                                    </li>
                                    <li>
                                       <p>在辅助实例上配置六个辅助通道，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-F2ED1190-E3BF-4898-BDCC-B9FF0500C76B" title="数据库复制的主要工作由RMAN通道执行。每个通道对应于执行复制任务的Oracle数据库服务器会话。根据复制技术，RMAN使用辅助通道或目标通道。">配置RMAN通道以用于复制</a> ”中所述</span> 。
                                       </p>
                                       <p>在此示例中，源数据库上配置了两个目标通道。对于RMAN使用备份集执行活动数据库复制，辅助通道的数量必须等于或大于目标通道的数量。</p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li>
                              <p>确保满足所选复制技术的先决条件，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-7FDB9916-8FB9-471A-8EFD-26E34FB8EA25" title="先决条件取决于正在执行的数据库重复的类型。某些先决条件对于所有类型的复制都是通用的，而其他先决条件则特定于特定类型的复制。">复制数据库的先决条件</a> ”中所述</span> 。
                              </p>
                           </li>
                           <li>
                              <div class="p">准备辅助实例，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-FCE67CCA-78B3-47E4-8D1B-75C8719BD51A" title="RMAN使用辅助实例来创建重复数据库。在开始复制之前，必须准备辅助实例。">准备辅助实例</a> ”中所述</span> 。
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p>创建将数据库文件存储在目标主机上的磁盘组。</p>
                                       <p>如果它尚不存在，请创建<code class="codeph">+DGROUP2</code>磁盘组以存储重复的数据库文件。
                                       </p>
                                    </li>
                                    <li>
                                       <p>将密码文件从源数据库复制到目标数据库，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-A338B143-E321-4329-A2ED-2467C70C03DC" title="可以使用操作系统身份验证或密码文件身份验证来建立与辅助实例的连接。对于基于备份的复制，您可以创建密码文件或使用操作系统身份验证连接到辅助实例。对于活动数据库复制，您必须使用密码文件身份验证。">为辅助实例创建密码文件</a> ”中所述</span> 。
                                       </p>
                                    </li>
                                    <li>
                                       <p>使用静态侦听器在源数据库和辅助实例之间设置Oracle网络服务连接。</p>
                                    </li>
                                    <li>
                                       <p>将源数据库软件密钥库复制到目标主机。使用<code class="codeph">SET</code>命令指定必须用于打开基于密码的软件密钥库的密码。
                                       </p>
                                       <p>请参阅<span class="q">“ <a href="rman-duplicating-databases.html#GUID-E016C2DC-1774-4057-8EAF-3F69E9A6322A" title="如果在源数据库上配置了透明加密，则必须确保源数据库中的Oracle软件密钥库可用于辅助实例。将密钥库从源数据库手动复制到目标主机。">使Oracle密钥库可用于目标主机</a> ”</span> 。
                                       </p>
                                    </li>
                                    <li>以<code class="codeph">NOMOUNT</code>模式启动辅助实例，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-7534941B-A211-4EA5-87AC-D657AE51839E" title="您创建的初始化参数文件用于启动辅助实例。">启动辅助实例</a> ”中所述</span> 。
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li>
                              <p>启动RMAN并以<code class="codeph">TARGET</code>身份连接到源数据库，并以辅助实例身份连接到<code class="codeph">AUXILIARY</code> 。</p><pre class="pre codeblock"><code>％rman RMAN&gt; CONNECT TARGET sys @ srcdb as SYSDBA; RMAN&gt; CONNECT AUXILIARY sys @ dupdb AS SYSBACKUP;</code></pre><div class="infoboxnotealso" id="GUID-187339D5-ABD1-472E-92C7-83CCD21DB8D8__GUID-DB4DB45C-747A-4C03-A1BC-3C474E75CC37">
                                 <p class="notep1">也可以看看：</p>
                                 <p>对于活动数据库复制，与辅助实例的连接还必须使用密码文件身份验证。</p>
                              </div>
                           </li>
                           <li>
                              <p>使用<code class="codeph">DUPLICATE</code>命令复制数据库。
                              </p>
                              <p><code class="codeph">SPFILE</code>子句指示RMAN将服务器参数文件从源数据库复制到辅助实例。使用<code class="codeph">DB_CREATE_FILE_DEST</code>参数指定用于在重复数据库中存储重复数据库文件的磁盘组。
                              </p><pre class="pre codeblock"><code>DUPLICATE DATABASE到dupdb FROM ACTIVE DATABASE PASSWORD FILE SPFILE SET DB_CREATE_FILE_DEST ='+ DGROUP2';</code></pre></li>
                        </ol>
                        <div class="infoboxnotealso" id="GUID-187339D5-ABD1-472E-92C7-83CCD21DB8D8__GUID-C24B8C47-5907-4985-A787-5C04AF5FFA87">
                           <p class="notep1">也可以看看：</p><a href="rman-duplicating-databases.html#GUID-EA6E8219-56BF-471C-AC5A-DFC55E760806" title="本节包含使用不同复制技术复制数据库的示例。">示例：复制数据库</a></div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-815B6F9A-7B64-47B3-A68F-B62CECAE141D" name="GUID-815B6F9A-7B64-47B3-A68F-B62CECAE141D"></a><h4 id="BRADV-GUID-815B6F9A-7B64-47B3-A68F-B62CECAE141D" class="sect4"><span class="enumeration_section">25.9.2</span>示例：使用映像副本使用活动数据库复制将数据库复制到远程主机</h4>
                  <div>
                     <p>此示例使用活动数据库复制和映像副本将数据库复制到远程主机。</p>
                     <div class="section">此示例假定以下情形：<ul style="list-style-type:disc">
                           <li>
                              <p>源主机和目标主机是不同的。</p>
                           </li>
                           <li>
                              <p>重复的数据库文件使用的目录结构与源数据库的目录结构不同。</p>
                           </li>
                           <li>
                              <p>源数据库和重复数据库使用Oracle Managed Files（OMF）来创建数据库文件。</p>
                           </li>
                           <li>
                              <p>在复制过程中，源数据库必须可用。</p>
                           </li>
                           <li>
                              <p>复制过程完成后，必须打开重复的数据库。</p>
                           </li>
                        </ul>使用以下步骤为此示例中描述的方案创建重复数据库：<ol>
                           <li>
                              <div class="p">按照<span class="q">“ <a href="rman-duplicating-databases.html#GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" title="Before duplicating a database, you must make some decisions about the duplication process.">计划复制数据库</a> ”中的说明<a href="rman-duplicating-databases.html#GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" title="在复制数据库之前，您必须对复制过程做出一些决定。">规划复制</a></span> 。这包括以下任务：<ul style="list-style-type:disc">
                                    <li>
                                       <p>选择适合场景和要求的复制技术。</p>
                                       <p>由于源和目标之间的带宽有限，因此通过使用映像副本执行活动数据库复制。</p>
                                    </li>
                                    <li>
                                       <p>选择策略以命名重复的数据库文件。</p>
                                       <p>在此示例中， <code class="codeph">DB_FILE_NAME_CONVERT</code>和<code class="codeph">LOG_FILE_NAME_CONVERT</code>初始化参数用于指定源数据库文件名如何转换为重复的数据库文件名。
                                       </p>
                                    </li>
                                    <li>
                                       <p>使用映像副本执行活动数据库复制时，如果未配置辅助通道或辅助通道数小于目标通道数，RMAN将使用映像副本。因此，不需要配置其他通道来使用映像副本执行活动数据库复制。</p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li>
                              <p>确保满足所选复制技术的先决条件，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-7FDB9916-8FB9-471A-8EFD-26E34FB8EA25" title="先决条件取决于正在执行的数据库重复的类型。某些先决条件对于所有类型的复制都是通用的，而其他先决条件则特定于特定类型的复制。">复制数据库的先决条件</a> ”中所述</span> 。
                              </p>
                           </li>
                           <li>
                              <div class="p">准备辅助实例，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-FCE67CCA-78B3-47E4-8D1B-75C8719BD51A" title="RMAN使用辅助实例来创建重复数据库。在开始复制之前，必须准备辅助实例。">准备辅助实例</a> ”中所述</span> 。
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p>创建在目标主机上存储数据库文件的目录。</p>
                                       <p>在此示例中，创建<code class="codeph">/app/db_home2/database</code>目录以存储数据文件，控制文件和服务器参数文件以及<code class="codeph">/app/db_home2/logfiles</code>目录以存储联机重做日志文件。
                                       </p>
                                    </li>
                                    <li>
                                       <p>在目标主机上，为辅助实例创建最小初始化参数文件。该文件名为<code class="codeph">initdup.ora</code> ，位于<code class="codeph">/app/db_home1/database</code>目录中。它包含以下条目：</p><pre class="pre codeblock"><code>DB_NAME = dup DB_DOMAIN = dup.example.com</code></pre><p>请参阅<span class="q">“ <a href="rman-duplicating-databases.html#GUID-57888C11-63C3-4A7A-8488-2E623033A359" title="有多种方法可用于创建启动辅助实例所需的初始化参数文件。">为辅助实例创建初始化参数文件</a> ”</span> 。
                                       </p>
                                    </li>
                                    <li>将密码文件从源数据库复制到目标主机，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-A338B143-E321-4329-A2ED-2467C70C03DC" title="可以使用操作系统身份验证或密码文件身份验证来建立与辅助实例的连接。对于基于备份的复制，您可以创建密码文件或使用操作系统身份验证连接到辅助实例。对于活动数据库复制，您必须使用密码文件身份验证。">为辅助实例创建密码文件</a> ”中所述</span></li>
                                    <li>
                                       <p>使用静态侦听器在源数据库和辅助实例之间设置Oracle网络服务连接，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-460171C8-2E09-4D0E-9AC3-A4C28392A220" title="对于某些形式的复制，您必须能够在源数据库和辅助实例之间建立连接。">在源数据库和辅助实例之间建立Oracle网络连接</a> ”中所述</span> 。
                                       </p>
                                    </li>
                                    <li>
                                       <p>以<code class="codeph">NOMOUNT</code>模式启动辅助实例，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-7534941B-A211-4EA5-87AC-D657AE51839E" title="您创建的初始化参数文件用于启动辅助实例。">启动辅助实例</a> ”中所述</span> 。
                                       </p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li>
                              <p>启动RMAN并以<code class="codeph">TARGET</code>身份连接到源数据库，并以辅助实例身份连接到<code class="codeph">AUXILIARY</code> 。</p><pre class="pre codeblock"><code>％rman RMAN&gt; CONNECT TARGET sys @ srcdb as SYSDBA; RMAN&gt; CONNECT AUXILIARY sys @ dupdb AS SYSBACKUP;</code></pre><div class="infoboxnotealso" id="GUID-815B6F9A-7B64-47B3-A68F-B62CECAE141D__GUID-1487CE38-48EC-4BCB-8A09-27F10B83BFB8">
                                 <p class="notep1">也可以看看：</p>
                                 <p>对于活动数据库复制，与辅助实例的连接还必须使用密码文件身份验证。</p>
                              </div>
                           </li>
                           <li>
                              <p>使用<code class="codeph">DUPLICATE</code>命令复制数据库。包含带有<code class="codeph">DB_FILE_NAME_CONVERT</code>和<code class="codeph">LOG_FILE_NAME_CONVERT</code>参数的<code class="codeph">SPFILE</code>子句，以指定源数据库中的服务器参数文件必须用于辅助实例。
                              </p>
                              <p>使用OMF生成的名称将重复的数据库文件存储在重复数据库中。<code class="codeph">SPFILE</code>子句的<code class="codeph">PARAMETER_VALUE_CONVERT</code>选项指定路径名<code class="codeph">/app/db_home1</code>应转换为<code class="codeph">/app_db_home2</code> 。
                              </p><pre class="pre codeblock"><code>DUPLICATE DATABASE to dupdb FROM ACTIVE DATABASE PASSWORD FILE SPFILE PARAMETER_VALUE_CONVERT ='/ app / dbhome1'，'/ app / db_home2'Set db_file_name_convert ='/ app / dbhome1 / dbs'，'/ app / db_home2 / database / dbs'Set log_file_name_convert = '/应用程序/ dbhome1 /日志'， '/应用/ db_home2 /日志文件';</code></pre></li>
                        </ol>
                        <div class="infoboxnotealso" id="GUID-815B6F9A-7B64-47B3-A68F-B62CECAE141D__GUID-040F2BE0-BE85-48F5-9D19-3BA93375502C">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="rman-duplicating-databases.html#GUID-EA6E8219-56BF-471C-AC5A-DFC55E760806" title="本节包含使用不同复制技术复制数据库的示例。">示例：复制数据库</a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-0AA76E9C-72CD-41CD-989E-BFA97857FC06" name="GUID-0AA76E9C-72CD-41CD-989E-BFA97857FC06"></a><h4 id="BRADV-GUID-0AA76E9C-72CD-41CD-989E-BFA97857FC06" class="sect4"><span class="enumeration_section">25.9.3</span>示例：使用基于备份的复制在没有目标连接或恢复目录的情况下将数据库复制到远程主机</h4>
                  <div>
                     <p>此示例描述如何在没有目标连接或恢复目录的情况下使用基于备份的复制来执行到远程主机的复制。</p>
                     <div class="section">此示例使用以下方案：<ul style="list-style-type:disc">
                           <li>
                              <p>目标主机上的<code class="codeph">/backups/db_files</code>目录中提供了源数据库的完整备份，包括控制文件，数据文件和归档重做日志文件。
                              </p>
                           </li>
                           <li>
                              <p>与目标数据库或恢复目录的连接不可用。</p>
                           </li>
                           <li>
                              <p>源主机和目标主机是不同的。</p>
                           </li>
                           <li>
                              <p>重复数据库使用的目录结构与源数据库用于存储重复数据库文件的目录结构不同。重复数据库文件的数据文件和控制文件存储在<code class="codeph">/oracle2/database</code>目录中，联机重做日志文件存储在<code class="codeph">/oracle2/database/logs</code>目录中。
                              </p>
                           </li>
                           <li>
                              <p>源数据库的<code class="codeph">DB_NAME</code>是<code class="codeph">db12</code> ，重复数据库的<code class="codeph">DB_NAME</code>是<code class="codeph">dup</code> 。
                              </p>
                           </li>
                           <li>
                              <p>复制过程完成后，必须打开重复的数据库。</p>
                           </li>
                        </ul>
                        <p>使用以下步骤为此示例中描述的方案创建重复数据库：</p>
                        <ol>
                           <li>
                              <p>按照<span class="q">“ <a href="rman-duplicating-databases.html#GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" title="Before duplicating a database, you must make some decisions about the duplication process.">计划复制数据库</a> ”中的说明<a href="rman-duplicating-databases.html#GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" title="在复制数据库之前，您必须对复制过程做出一些决定。">规划复制</a></span> 。这包括以下任务：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>选择适合场景和要求的复制技术。</p>
                                    <p>在此示例中，执行没有目标连接或恢复目录连接的基于备份的复制。因此，我们使用<code class="codeph">BACKUP LOCATION</code>子句指定源数据库备份的位置。
                                    </p>
                                 </li>
                                 <li>
                                    <p>由于重复数据库使用的目录结构与源数据库不同，因此必须选择策略以生成重复的数据库文件名。</p>
                                    <p>在此示例中， <code class="codeph">SET NEWNAME FOR DATABASE</code>命令指定数据文件和控制文件的位置。<code class="codeph">DUPLICATE</code>命令的<code class="codeph">LOGFILE</code>子句指定联机重做日志文件的位置。
                                    </p>
                                 </li>
                                 <li>
                                    <p>使用源数据库上使用的相同目录结构将所需备份复制到目标主机。</p>
                                    <p>在此示例中，数据文件和归档重做日志文件的<code class="codeph">/backups/db_files</code>必须存储在<code class="codeph">/backups/db_files</code>中，控制文件和服务器参数文件的备份必须存储在目标主机上的<code class="codeph">/backups/cf</code> 。
                                    </p>
                                 </li>
                              </ul>
                           </li>
                           <li>
                              <p>确保满足所选复制技术的先决条件，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-7FDB9916-8FB9-471A-8EFD-26E34FB8EA25" title="先决条件取决于正在执行的数据库重复的类型。某些先决条件对于所有类型的复制都是通用的，而其他先决条件则特定于特定类型的复制。">复制数据库的先决条件</a> ”中所述</span> 。
                              </p>
                           </li>
                           <li>
                              <p>准备辅助实例。</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>创建将重复数据库文件存储在目标主机上的目录。</p>
                                    <p>在此示例中，您将创建<code class="codeph">/oracle2/database</code>目录以存储数据文件，控制文件和服务器参数文件。创建<code class="codeph">/oracle2/database/logs</code>目录以存储联机重做日志文件。
                                    </p>
                                 </li>
                                 <li>
                                    <p>为辅助实例创建最小初始化参数文件，如<span class="q">“</span>为辅助实例<span class="q"><a href="rman-duplicating-databases.html#GUID-57888C11-63C3-4A7A-8488-2E623033A359" title="有多种方法可用于创建启动辅助实例所需的初始化参数文件。">创建初始化参数文件</a> ”中所述</span> 。
                                    </p>
                                    <div class="p">该文件名为<code class="codeph">initdup.ora</code> ，位于<code class="codeph">/oracle2/database</code>目录中。除了任何其他特定设置，它还必须包含以下条目：<pre class="pre codeblock"><code>DB_NAME = dup DB_DOMAIN = dupdb.example.com</code></pre></div>
                                 </li>
                                 <li>
                                    <p>使用<code class="codeph">orapwd</code>实用程序为辅助实例创建密码文件。密码文件是必需的，因为正在远程主机上创建重复数据库。
                                    </p>
                                    <p>请参阅<span class="q">“ <a href="rman-duplicating-databases.html#GUID-A338B143-E321-4329-A2ED-2467C70C03DC" title="可以使用操作系统身份验证或密码文件身份验证来建立与辅助实例的连接。对于基于备份的复制，您可以创建密码文件或使用操作系统身份验证连接到辅助实例。对于活动数据库复制，您必须使用密码文件身份验证。">为辅助实例创建密码文件</a> ”</span> 。
                                    </p>
                                 </li>
                                 <li>
                                    <p>使用静态侦听器在源数据库和辅助实例之间设置Oracle Net Services连接，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-460171C8-2E09-4D0E-9AC3-A4C28392A220" title="对于某些形式的复制，您必须能够在源数据库和辅助实例之间建立连接。">在源数据库和辅助实例之间建立Oracle网络连接</a> ”中所述</span> 。
                                    </p>
                                    <p>这是必需的，因为此示例将数据库复制到远程主机。</p>
                                 </li>
                                 <li>
                                    <p>以<code class="codeph">NOMOUNT</code>模式启动辅助实例，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-7534941B-A211-4EA5-87AC-D657AE51839E" title="您创建的初始化参数文件用于启动辅助实例。">启动辅助实例</a> ”中所述</span> 。
                                    </p>
                                 </li>
                              </ul>
                           </li>
                           <li>
                              <p>启动RMAN并以<code class="codeph">TARGET</code>身份连接到源数据库，并以辅助实例身份连接到<code class="codeph">AUXILIARY</code> 。</p><pre class="pre codeblock"><code>％rman RMAN&gt; CONNECT TARGET / RMAN&gt; CONNECT AUXILIARY sys @ dup AS SYSBACKUP;</code></pre><p>出现提示时输入密码。</p>
                           </li>
                           <li>
                              <p>使用<code class="codeph">DUPLICATE</code>命令复制数据库。
                              </p>
                              <p>包括<code class="codeph">BACKUP LOCATION</code>子句以指定源数据库备份的位置。在<code class="codeph">RUN</code>块中包含<code class="codeph">SET NEWNAME FOR DATABASE</code>和<code class="codeph">DUPLICATE</code>命令。<code class="codeph">LOGFILE</code>子句指定联机重做日志文件的名称和位置。
                              </p><pre class="pre codeblock"><code>运行{将数据库的新名称设置为'/ oracle2 / database /％b';重复数据库'db12'到'dup'日志文件组1（'/ oracle2/database/logs/r1.f','/ oracle2 / database / logs / r2.f'）size 4m reuse，group 2（'/ oracle2 / database / logs / r3.f'，'/ oracle2 / database / logs / r4.f'）size 4m重用备份位置'/ backups / db_files'; }</code></pre></li>
                        </ol>
                        <div class="infoboxnotealso" id="GUID-0AA76E9C-72CD-41CD-989E-BFA97857FC06__GUID-BE060757-8FFC-4DA8-8136-961E7F9BDCFE">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="rman-duplicating-databases.html#GUID-EA6E8219-56BF-471C-AC5A-DFC55E760806" title="本节包含使用不同复制技术复制数据库的示例。">示例：复制数据库</a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-CDD05468-F1A7-4CCD-AE54-C5AF87965573" name="GUID-CDD05468-F1A7-4CCD-AE54-C5AF87965573"></a><h4 id="BRADV-GUID-CDD05468-F1A7-4CCD-AE54-C5AF87965573" class="sect4"><span class="enumeration_section">25.9.4</span>示例：使用基于备份的复制和恢复目录将数据库复制到远程主机</h4>
                  <div>
                     <p>此示例介绍如何通过使用基于备份的复制与恢复目录来执行到远程主机的复制。</p>
                     <div class="section">此示例假定以下情形：<ul style="list-style-type:disc">
                           <li>源主机上提供了源数据库的完整备份。数据文件和归档重做日志文件的备份存储在<code class="codeph">/bkups/db_files</code> 。控制文件和服务器参数文件的备份存储在<code class="codeph">/bkups/cf</code> 。
                           </li>
                           <li>与源数据库的连接不可用，但可以连接到恢复目录。</li>
                           <li>
                              <p>源主机和目标主机是不同的。目标主机使用OMF并安装了Oracle数据库软件。</p>
                           </li>
                           <li>
                              <p>重复数据库将数据库文件存储在与源数据库不同的目录结构中。重复数据库的数据库文件必须存储在<code class="codeph">/app/oracle2/dbs</code>目录中。
                              </p>
                           </li>
                           <li>
                              <p>源数据库的<code class="codeph">DB_NAME</code>是<code class="codeph">ora</code> ，其Net Service名称是<code class="codeph">oradb</code> 。重复数据库的<code class="codeph">DB_NAME</code>是<code class="codeph">dup</code> ，其Net Service名称是<code class="codeph">dupdb</code> 。
                              </p>
                           </li>
                           <li>
                              <p>必须从重复数据库中排除源数据库中的只读表空间。</p>
                           </li>
                           <li>
                              <p>复制过程完成后，不得打开重复数据库。</p>
                           </li>
                        </ul>使用以下步骤为此示例中描述的方案创建重复数据库：<ol>
                           <li>
                              <div class="p">计划复制。如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" title="在复制数据库之前，您必须对复制过程做出一些决定。">计划复制数据库</a> ”中所述</span> 。这包括以下任务：<ul style="list-style-type:disc">
                                    <li>
                                       <p>选择适合场景和要求的复制技术。</p>
                                       <p>在此示例中，执行使用恢复目录连接的基于备份的复制。</p>
                                    </li>
                                    <li>
                                       <p>选择生成重复数据库文件名的策略。</p>
                                       <p>由于重复数据库使用OMF，因此请使用辅助实例的初始化参数文件中的<code class="codeph">DB_CREATE_FILE_DEST</code>参数来指定存储重复数据库文件的目录。
                                       </p>
                                    </li>
                                    <li>使用<code class="codeph">DUPLICATE</code>命令的<code class="codeph">NOOPEN</code>子句指定在复制完成后不能使用<code class="codeph">RESETLOGS</code>打开重复数据库。
                                    </li>
                                    <li>
                                       <p>使用源数据库上使用的相同目录结构将所需备份复制到目标主机。</p>
                                       <p>在此示例中，数据文件和归档重做日志文件的备份必须存储在<code class="codeph">/scratch/db_files</code>中，控制文件和服务器参数文件的备份必须存储在目标主机上的<code class="codeph">/scratch/cf</code> 。
                                       </p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li>
                              <p>确保满足所选复制技术的先决条件，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-7FDB9916-8FB9-471A-8EFD-26E34FB8EA25" title="先决条件取决于正在执行的数据库重复的类型。某些先决条件对于所有类型的复制都是通用的，而其他先决条件则特定于特定类型的复制。">复制数据库的先决条件</a> ”中所述</span> 。
                              </p>
                           </li>
                           <li>
                              <div class="p">准备辅助实例，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-FCE67CCA-78B3-47E4-8D1B-75C8719BD51A" title="RMAN使用辅助实例来创建重复数据库。在开始复制之前，必须准备辅助实例。">准备辅助实例</a> ”中所述</span> 。
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p>创建将重复数据库文件存储在目标主机上的目录。</p>
                                       <p>在此示例中，您将创建<code class="codeph">/app/oracle2/dbs</code>目录以存储数据文件，控制文件，联机重做日志文件和服务器参数文件。
                                       </p>
                                    </li>
                                    <li>
                                       <p>为辅助实例创建初始化参数文件。该文件名为<code class="codeph">initdup.ora</code> ，位于<code class="codeph">/app/oracle2/dbs</code>目录中。除了任何其他特定设置，它还必须包含以下条目：</p><pre class="pre codeblock"><code>DB_NAME = dup DB_DOMAIN = dupdb.example.com DB_CREATE_FILE_DEST = / app / oracle2 / dbs</code></pre><p>请参阅<span class="q">“ <a href="rman-duplicating-databases.html#GUID-57888C11-63C3-4A7A-8488-2E623033A359" title="有多种方法可用于创建启动辅助实例所需的初始化参数文件。">为辅助实例创建初始化参数文件</a> ”</span> 。
                                       </p>
                                    </li>
                                    <li>
                                       <p>使用<code class="codeph">orapwd</code>实用程序为辅助实例创建密码文件。密码文件是必需的，因为正在远程主机上创建重复数据库。
                                       </p>
                                       <p>请参阅<span class="q">“ <a href="rman-duplicating-databases.html#GUID-A338B143-E321-4329-A2ED-2467C70C03DC" title="可以使用操作系统身份验证或密码文件身份验证来建立与辅助实例的连接。对于基于备份的复制，您可以创建密码文件或使用操作系统身份验证连接到辅助实例。对于活动数据库复制，您必须使用密码文件身份验证。">为辅助实例创建密码文件</a> ”</span> 。
                                       </p>
                                    </li>
                                    <li>
                                       <p>使用静态侦听器在源数据库和辅助实例之间设置Oracle网络服务连接。这是必需的，因为此示例将数据库复制到远程主机。</p>
                                       <p>请参阅<span class="q">“ <a href="rman-duplicating-databases.html#GUID-460171C8-2E09-4D0E-9AC3-A4C28392A220" title="对于某些形式的复制，您必须能够在源数据库和辅助实例之间建立连接。">在源数据库和辅助实例之间建立Oracle网络连接</a> ”</span> 。
                                       </p>
                                    </li>
                                    <li>
                                       <p>以<code class="codeph">NOMOUNT</code>模式启动辅助实例，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-7534941B-A211-4EA5-87AC-D657AE51839E" title="您创建的初始化参数文件用于启动辅助实例。">启动辅助实例</a> ”中所述</span> 。
                                       </p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li>
                              <p>启动RMAN并以<code class="codeph">TARGET</code>身份连接到源数据库，并以辅助实例身份连接到<code class="codeph">AUXILIARY</code> 。</p><pre class="pre codeblock"><code>％rman RMAN&gt; CONNECT TARGET sys @ oradb; RMAN&gt; CONNECT AUXILIARY sys @ dupdb;</code></pre><p>出现提示时输入密码。</p>
                           </li>
                           <li>
                              <p>使用<code class="codeph">DUPLICATE</code>命令复制数据库。
                              </p>
                              <p>包括<code class="codeph">SKIP READONLY</code>子句以从重复数据库中排除只读表空间。由于没有与目标数据库的连接，因此必须指定要复制的目标数据库的名称。
                              </p><pre class="pre codeblock"><code>DUPLICATE DATABASE db12 to READ SKIP READONLY;</code></pre></li>
                        </ol>
                        <div class="infoboxnotealso" id="GUID-CDD05468-F1A7-4CCD-AE54-C5AF87965573__GUID-6F23E7A4-9C85-483E-B25C-5F10012E0E93">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="rman-duplicating-databases.html#GUID-EA6E8219-56BF-471C-AC5A-DFC55E760806" title="本节包含使用不同复制技术复制数据库的示例。">示例：复制数据库</a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-86A4A8B2-F699-474B-A29E-955DDCF78B56" name="GUID-86A4A8B2-F699-474B-A29E-955DDCF78B56"></a><h4 id="BRADV-GUID-86A4A8B2-F699-474B-A29E-955DDCF78B56" class="sect4"><span class="enumeration_section">25.9.5</span>示例：使用基于备份的目标连接复制将数据库复制到远程主机</h4>
                  <div>
                     <p>此示例描述如何通过使用目标连接的基于备份的复制来执行到远程主机的复制。</p>
                     <div class="section">此示例使用以下方案：<ul style="list-style-type:disc">
                           <li>
                              <p>可以使用源数据库的完整备份，包括控制文件，数据文件和归档重做日志文件。</p>
                           </li>
                           <li>
                              <p>可以连接到源数据库。</p>
                           </li>
                           <li>
                              <p>源主机和目标主机是不同的。</p>
                           </li>
                           <li>
                              <p>源数据库配置为使用透明加密和基于密码的软件密钥库。</p>
                           </li>
                           <li>
                              <p>重复数据库使用与源数据库相同的目录结构和文件名来存储数据库文件。</p>
                              <p>在源主机上，数据文件，控制文件和服务器参数文件存储在<code class="codeph">/app/db_home1/database</code> ，联机重做日志文件存储在<code class="codeph">/app/db_home1/logfiles</code> 。
                              </p>
                           </li>
                           <li>
                              <p>源数据库的<code class="codeph">DB_NAME</code>是<code class="codeph">src</code> ，其Net Service名称是<code class="codeph">srcdb</code> 。重复数据库的<code class="codeph">DB_NAME</code>是<code class="codeph">dup</code> ，其Net Service名称是<code class="codeph">dupdb</code> 。
                              </p>
                           </li>
                           <li>
                              <p>在源主机上，数据文件和归档重做日志文件的备份存储在<code class="codeph">/bkups/oradata/db_files</code> 。控制文件和服务器参数文件的备份存储在<code class="codeph">/bkups/oradata/cf</code> 。
                              </p>
                           </li>
                           <li>
                              <p>必须从重复数据库中排除表空间<code class="codeph">HR</code>和<code class="codeph">SH</code> 。
                              </p>
                              <p>源数据库中的其余表空间是自包含的，并且没有指向<code class="codeph">hr</code>和<code class="codeph">sh</code>表空间的链接。
                              </p>
                           </li>
                           <li>
                              <p>复制过程完成后，必须打开重复的数据库。</p>
                           </li>
                        </ul>使用以下步骤为此示例中描述的方案创建重复数据库：<ol>
                           <li>
                              <div class="p">按照<span class="q">“ <a href="rman-duplicating-databases.html#GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" title="Before duplicating a database, you must make some decisions about the duplication process.">计划复制数据库</a> ”中的说明<a href="rman-duplicating-databases.html#GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" title="在复制数据库之前，您必须对复制过程做出一些决定。">规划复制</a></span> 。这包括以下任务：<ul style="list-style-type:disc">
                                    <li>
                                       <p>选择适合您的方案的复制技术。</p>
                                       <p>在此示例中，执行使用目标连接的基于备份的复制。</p>
                                    </li>
                                    <li>
                                       <p>由于重复数据库使用与源数据库相同的目录结构，因此无需指定备用文件命名策略。</p>
                                       <p>但是，请使用<code class="codeph">DUPLICATE</code>命令中的<code class="codeph">NOFILENAMECHECK</code>子句来阻止RMAN检查源数据库的数据文件和联机重做日志文件是否使用与重复数据库上相同的名称。
                                       </p>
                                    </li>
                                    <li>
                                       <p>配置三个附加辅助通道，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-F2ED1190-E3BF-4898-BDCC-B9FF0500C76B" title="数据库复制的主要工作由RMAN通道执行。每个通道对应于执行复制任务的Oracle数据库服务器会话。根据复制技术，RMAN使用辅助通道或目标通道。">配置RMAN通道以用于复制</a> ”中所述</span> 。使用额外的辅助通道可提高复制过程的性能</p>
                                    </li>
                                    <li>
                                       <p>使用源数据库上使用的相同目录结构将所需备份复制到目标主机。</p>
                                       <p>在此示例中，数据文件和归档重做日志文件的备份必须存储在<code class="codeph">/bkups/oradata/db_files</code>目录中，控制文件和服务器参数文件的备份必须存储在目标上的<code class="codeph">/bkups/oradata/cf</code>目录中主办。
                                       </p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li>
                              <p>确保满足所选复制技术的先决条件，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-7FDB9916-8FB9-471A-8EFD-26E34FB8EA25" title="先决条件取决于正在执行的数据库重复的类型。某些先决条件对于所有类型的复制都是通用的，而其他先决条件则特定于特定类型的复制。">复制数据库的先决条件</a> ”中所述</span> 。
                              </p>
                           </li>
                           <li>
                              <div class="p">准备辅助实例，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-FCE67CCA-78B3-47E4-8D1B-75C8719BD51A" title="RMAN使用辅助实例来创建重复数据库。在开始复制之前，必须准备辅助实例。">准备辅助实例</a> ”中所述</span> 。
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p>创建在目标主机上存储重复数据库文件的目录。</p>
                                       <p>在此示例中，源数据库和重复数据库使用相同的目录结构。创建<code class="codeph">/app/database</code>目录以存储数据文件，控制文件和服务器参数文件以及<code class="codeph">/app/logfiles</code>目录以存储联机重做日志文件。
                                       </p>
                                    </li>
                                    <li>
                                       <div class="p">为辅助实例创建最小初始化参数文件。该文件名为<code class="codeph">initdup.or</code> a，位于<code class="codeph">/app/database</code>目录中。它包含以下条目：<pre class="pre codeblock"><code>DB_NAME = dup DB_DOMAIN = dup.example.com</code></pre></div>
                                       <p>请参阅<span class="q">“ <a href="rman-duplicating-databases.html#GUID-57888C11-63C3-4A7A-8488-2E623033A359" title="有多种方法可用于创建启动辅助实例所需的初始化参数文件。">为辅助实例创建初始化参数文件</a> ”</span> 。
                                       </p>
                                    </li>
                                    <li>
                                       <p>通过将密码文件从源数据库复制到重复数据库<span class="q"><a href="rman-duplicating-databases.html#GUID-A338B143-E321-4329-A2ED-2467C70C03DC" title="Connections to the auxiliary instance can be established by using operating system authentication or password file authentication. For backup-based duplication, you can either create a password file or use operating system authentication to connect to the auxiliary instance. For active database duplication, you must use password file authentication.">来为辅助实例创建密码文件</a></span> ，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-A338B143-E321-4329-A2ED-2467C70C03DC" title="可以使用操作系统身份验证或密码文件身份验证来建立与辅助实例的连接。对于基于备份的复制，您可以创建密码文件或使用操作系统身份验证连接到辅助实例。对于活动数据库复制，您必须使用密码文件身份验证。">为辅助实例创建密码文件</a> ”中所述</span> 。
                                       </p>
                                    </li>
                                    <li>
                                       <p>使用静态侦听器在源数据库和辅助实例之间设置Oracle Net Services连接，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-460171C8-2E09-4D0E-9AC3-A4C28392A220" title="对于某些形式的复制，您必须能够在源数据库和辅助实例之间建立连接。">在源数据库和辅助实例之间建立Oracle网络连接</a> ”中所述</span> 。
                                       </p>
                                    </li>
                                    <li>
                                       <p>以<code class="codeph">NOMOUNT</code>模式启动辅助实例，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-7534941B-A211-4EA5-87AC-D657AE51839E" title="您创建的初始化参数文件用于启动辅助实例。">启动辅助实例</a> ”中所述</span></p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li>
                              <div class="p">启动RMAN并以<code class="codeph">TARGET</code>身份连接到源数据库，并以辅助实例身份连接到<code class="codeph">AUXILIARY</code> 。这些连接是从目标主机建立的，辅助连接使用操作系统身份验证。<pre class="pre codeblock"><code>％rman RMAN&gt; CONNECT TARGET sys @ dupdb AS SYSBACKUP; RMAN&gt; CONNECT AUXILIARY /</code></pre></div>
                           </li>
                           <li>
                              <p>使用<code class="codeph">DUPLICATE</code>命令复制数据库。
                              </p>
                              <p>包括<code class="codeph">SKIP TABLEPACE</code>子句以指定在复制过程中必须省略的表空间。使用<code class="codeph">SPFILE</code>子句指定必须还原源数据库中的服务器参数文件并将其复制到重复数据库。
                              </p><pre class="pre codeblock"><code>DUPLICATE DATABASE复制SPFILE SKIP TABLESPACE HR，SH NOFILENAMECHECK;</code></pre></li>
                        </ol>
                        <div class="infoboxnotealso" id="GUID-86A4A8B2-F699-474B-A29E-955DDCF78B56__GUID-E1013999-9440-43C5-9263-B6B946770DB2">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="rman-duplicating-databases.html#GUID-EA6E8219-56BF-471C-AC5A-DFC55E760806" title="本节包含使用不同复制技术复制数据库的示例。">示例：复制数据库</a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-E9A97E86-8E83-4205-B76E-6AD013CEFDED" name="GUID-E9A97E86-8E83-4205-B76E-6AD013CEFDED"></a><h4 id="BRADV-GUID-E9A97E86-8E83-4205-B76E-6AD013CEFDED" class="sect4"><span class="enumeration_section">25.9.6</span>示例：使用活动数据库复制将数据库复制到本地主机</h4>
                  <div>
                     <p>此示例使用活动数据库复制将数据库复制到本地主机。</p>
                     <div class="section">此示例假定以下情形：<ul style="list-style-type:disc">
                           <li>
                              <p>源主机和目标主机是相同的。</p>
                           </li>
                           <li>
                              <p>源数据库和重复数据库都使用Oracle Managed Files（OMF）管理数据库文件。</p>
                           </li>
                           <li>
                              <p>重复的数据库文件使用与源数据库不同的目录结构。</p>
                           </li>
                           <li>
                              <p>源数据库以<code class="codeph">ARCHIVELOG</code>模式运行，在复制过程中可用。
                              </p>
                           </li>
                           <li>
                              <p>源数据库<code class="codeph">dbsrc</code>的服务名称和重复数据库的服务名称是<code class="codeph">dbdup</code> 。源数据库使用服务器参数文件（spfile）。
                              </p>
                           </li>
                        </ul>
                        <p>使用以下步骤为此示例中描述的方案创建重复数据库：</p>
                        <ol>
                           <li>
                              <p>按照<span class="q">“ <a href="rman-duplicating-databases.html#GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" title="Before duplicating a database, you must make some decisions about the duplication process.">计划复制数据库</a> ”中的说明<a href="rman-duplicating-databases.html#GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" title="在复制数据库之前，您必须对复制过程做出一些决定。">规划复制</a></span> 。
                              </p>
                              <div class="p">这包括以下任务：<ul style="list-style-type:disc">
                                    <li>
                                       <p>选择适合场景和要求的复制技术</p>
                                       <p>由于源主机上的网络带宽有限，因此将执行使用备份集的活动数据库复制。</p>
                                    </li>
                                    <li>
                                       <p>选择策略以命名重复的数据库文件</p>
                                       <p>在此示例中， <code class="codeph">DB_CREATE_FILE_DEST</code>初始化参数用于指定重复数据库文件的位置。
                                       </p>
                                       <p>要确保不覆盖源数据库文件，请不要在<code class="codeph">DUPLICATE</code>命令中包含<code class="codeph">NOFILENAMECHECK</code>子句。
                                       </p>
                                    </li>
                                    <li>
                                       <p>在辅助实例上配置辅助通道</p>
                                       <p>在此示例中，源数据库上配置了三个目标通道。对于RMAN使用备份集执行活动数据库复制，辅助通道的数量必须等于或大于目标通道的数量。</p>
                                       <p>请参阅<span class="q">“ <a href="rman-duplicating-databases.html#GUID-F2ED1190-E3BF-4898-BDCC-B9FF0500C76B" title="数据库复制的主要工作由RMAN通道执行。每个通道对应于执行复制任务的Oracle数据库服务器会话。根据复制技术，RMAN使用辅助通道或目标通道。">配置RMAN通道以用于复制</a> ”</span> 。
                                       </p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li>
                              <p>确保满足所选复制技术的先决条件，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-7FDB9916-8FB9-471A-8EFD-26E34FB8EA25" title="先决条件取决于正在执行的数据库重复的类型。某些先决条件对于所有类型的复制都是通用的，而其他先决条件则特定于特定类型的复制。">复制数据库的先决条件</a> ”中所述</span> 。
                              </p>
                           </li>
                           <li>
                              <div class="p">准备辅助实例，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-FCE67CCA-78B3-47E4-8D1B-75C8719BD51A" title="RMAN使用辅助实例来创建重复数据库。在开始复制之前，必须准备辅助实例。">准备辅助实例</a> ”中所述</span> 。
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p>创建在目标主机上存储数据库文件的目录</p>
                                       <p>在此示例中，创建<code class="codeph">/app/db_home3/dbs</code>目录以存储数据文件，控制文件和服务器参数文件以及<code class="codeph">/app/db_home3/logfiles</code>目录以存储联机重做日志文件。
                                       </p>
                                    </li>
                                    <li>
                                       <p>将密码文件从源数据库复制到重复数据库，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-A338B143-E321-4329-A2ED-2467C70C03DC" title="可以使用操作系统身份验证或密码文件身份验证来建立与辅助实例的连接。对于基于备份的复制，您可以创建密码文件或使用操作系统身份验证连接到辅助实例。对于活动数据库复制，您必须使用密码文件身份验证。">为辅助实例创建密码文件</a> ”中所述</span> 。
                                       </p>
                                    </li>
                                    <li>
                                       <p>使用以下最小参数为辅助实例创建初始化参数文件： <code class="codeph">DB_NAME</code> ， <code class="codeph">CONTROL_FILES</code> ， <code class="codeph">DB_CREATE_FILE_DEST</code>和<code class="codeph">LOG_CREATE_FILE_DEST</code> 。</p>
                                    </li>
                                    <li>
                                       <p>使用静态侦听器在源数据库和辅助实例之间设置Oracle网络服务连接。</p>
                                    </li>
                                    <li>以<code class="codeph">NOMOUNT</code>模式启动辅助实例，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-7534941B-A211-4EA5-87AC-D657AE51839E" title="您创建的初始化参数文件用于启动辅助实例。">启动辅助实例</a> ”中所述</span> 。
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li>
                              <p>启动RMAN并以<code class="codeph">TARGET</code>身份连接到源数据库，并以辅助实例身份连接到<code class="codeph">AUXILIARY</code> 。两个连接都是用户网络服务名称
                              </p><pre class="pre codeblock"><code>％rman RMAN&gt; CONNECT TARGET sys @ srcdb as SYSDBA; RMAN&gt; CONNECT AUXILIARY sys @ dupdb AS SYSBACKUP;</code></pre><p><span class="bold">注意：</span>对于活动数据库复制，与辅助实例的连接还必须使用密码文件身份验证。
                              </p>
                           </li>
                           <li>
                              <p>使用<code class="codeph">DUPLICATE</code>命令复制数据库。
                              </p><pre class="pre codeblock"><code>DUPLICATE DATABASE到dbdup FROM ACTIVE DATABASE;</code></pre></li>
                        </ol>
                        <div class="infoboxnotealso" id="GUID-E9A97E86-8E83-4205-B76E-6AD013CEFDED__GUID-C24B8C47-5907-4985-A787-5C04AF5FFA87">
                           <p class="notep1">也可以看看：</p><a href="rman-duplicating-databases.html#GUID-EA6E8219-56BF-471C-AC5A-DFC55E760806" title="本节包含使用不同复制技术复制数据库的示例。">示例：复制数据库</a></div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-49C686AA-587F-4F1C-9053-B58EB5581B6E" name="GUID-49C686AA-587F-4F1C-9053-B58EB5581B6E"></a><h4 id="BRADV-GUID-49C686AA-587F-4F1C-9053-B58EB5581B6E" class="sect4"><span class="enumeration_section">25.9.7</span>示例：使用活动数据库复制将PDB复制到新CDB</h4>
                  <div>
                     <p>此示例描述如何使用活动数据库复制将PDB复制到新CDB。</p>
                     <div class="section">此示例假定以下情形：<ul style="list-style-type:disc">
                           <li>
                              <p>源主机和目标主机是不同的。</p>
                           </li>
                           <li>
                              <p>源数据库和重复数据库都使用OMF管理数据库文件。</p>
                           </li>
                           <li>
                              <p>源主机上的网络带宽有限。</p>
                           </li>
                           <li>
                              <p>重复的数据库文件使用与源数据库不同的目录结构。</p>
                           </li>
                        </ul>
                        <p>使用以下步骤为此示例中描述的方案创建重复数据库：</p>
                        <ol>
                           <li>
                              <div class="p">按照<span class="q">“ <a href="rman-duplicating-databases.html#GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" title="Before duplicating a database, you must make some decisions about the duplication process.">计划复制数据库</a> ”中的说明<a href="rman-duplicating-databases.html#GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" title="在复制数据库之前，您必须对复制过程做出一些决定。">规划复制</a></span> 。这包括以下任务：<ul style="list-style-type:disc">
                                    <li>
                                       <p>选择适合场景和要求的复制技术。</p>
                                       <p>由于源主机上的网络带宽有限，因此将执行使用备份集的活动数据库复制。</p>
                                    </li>
                                    <li>
                                       <p>选择策略以命名重复的数据库文件。</p>
                                       <p>在此示例中， <code class="codeph">DB_FILE_NAME_CONVERT</code>和<code class="codeph">LOG_FILE_NAME_CONVERT</code>初始化参数用于指定重复数据库文件的位置。
                                       </p>
                                    </li>
                                    <li>
                                       <p>在辅助实例上配置四个辅助通道，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-F2ED1190-E3BF-4898-BDCC-B9FF0500C76B" title="数据库复制的主要工作由RMAN通道执行。每个通道对应于执行复制任务的Oracle数据库服务器会话。根据复制技术，RMAN使用辅助通道或目标通道。">配置RMAN通道以用于复制</a> ”中所述</span> 。
                                       </p>
                                       <p>在此示例中，在源数据库上配置了两个目标通道。对于RMAN使用备份集执行活动数据库复制，辅助通道的数量必须等于或大于目标通道的数量。</p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li>
                              <p>确保满足所选复制技术的先决条件，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-7FDB9916-8FB9-471A-8EFD-26E34FB8EA25" title="先决条件取决于正在执行的数据库重复的类型。某些先决条件对于所有类型的复制都是通用的，而其他先决条件则特定于特定类型的复制。">复制数据库的先决条件</a> ”中所述</span> 。
                              </p>
                           </li>
                           <li>
                              <div class="p">准备辅助实例，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-FCE67CCA-78B3-47E4-8D1B-75C8719BD51A" title="RMAN使用辅助实例来创建重复数据库。在开始复制之前，必须准备辅助实例。">准备辅助实例</a> ”中所述</span> 。
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p>创建在目标主机上存储数据库文件的目录。</p>
                                       <p>在此示例中，创建<code class="codeph">/app/dbhome3/database</code>目录以存储数据文件，控制文件和服务器参数文件以及<code class="codeph">/app/dbhome3/logfiles</code>目录以存储联机重做日志文件。
                                       </p>
                                    </li>
                                    <li>
                                       <p>在目标主机上，为辅助实例创建最小初始化参数文件。该文件名为<code class="codeph">initdup.ora</code> ，包含以下条目：</p><pre class="pre codeblock"><code>ENABLE_PLUGGABLE_DATABASE = true DB_NAME = dup DB_DOMAIN = dup.example.com</code></pre></li>
                                    <li>
                                       <p>使用<code class="codeph">DUPLICATE</code>命令中的<code class="codeph">PASSWORD FILE</code>选项在目标数据库上创建密码文件。
                                       </p>
                                    </li>
                                    <li>
                                       <p>使用静态侦听器在源数据库和辅助实例之间设置Oracle网络服务连接。</p>
                                    </li>
                                    <li>以<code class="codeph">NOMOUNT</code>模式启动辅助实例，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-7534941B-A211-4EA5-87AC-D657AE51839E" title="您创建的初始化参数文件用于启动辅助实例。">启动辅助实例</a> ”中所述</span> 。使用<code class="codeph">SYSDBA</code>或<code class="codeph">SYSBACKUP</code>权限以普通用户身份连接到root用户。
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li>
                              <p>启动RMAN并以<code class="codeph">TARGET</code>身份连接到源数据库的根，并以辅助实例身份连接到<code class="codeph">AUXILIARY</code> 。</p><pre class="pre codeblock"><code>％rman RMAN&gt; CONNECT TARGET sys @ srcdb as SYSDBA; RMAN&gt; CONNECT AUXILIARY sys @ dupdb AS SYSBACKUP;</code></pre><p><span class="bold">注意：</span>对于活动数据库复制，与辅助实例的连接还必须使用密码文件身份验证。
                              </p>
                           </li>
                           <li>
                              <p>确保源CDB已打开或已安装。</p>
                           </li>
                           <li>
                              <p>使用<code class="codeph">DUPLICATE</code>命令复制数据库。
                              </p>
                              <p><code class="codeph">SPFILE</code>选项指示RMAN将服务器参数文件从源数据库复制到辅助实例。使用<code class="codeph">DB_CREATE_FILE_DEST</code>参数指定用于在重复数据库中存储重复数据库文件的磁盘组。
                              </p><pre class="pre codeblock"><code>DUPLICATE DATABASE到dupdb FROM ACTIVE PLUGGABLE DATABASE my_pdb PASSWORD FILE SET DB_FILE_NAME_CONVERT ='/ app / dbhome / database'，'/ app / dbhome3 / database'SET LOG_FILE_NAME_CONVERT ='/ app / dbhome / logfiles'，'/ app / dbhome3 / logfiles “;</code></pre></li>
                        </ol>
                        <div class="infoboxnotealso" id="GUID-49C686AA-587F-4F1C-9053-B58EB5581B6E__GUID-C24B8C47-5907-4985-A787-5C04AF5FFA87">
                           <p class="notep1">也可以看看：</p><a href="rman-duplicating-databases.html#GUID-EA6E8219-56BF-471C-AC5A-DFC55E760806" title="本节包含使用不同复制技术复制数据库的示例。">示例：复制数据库</a></div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-3E8DE9F7-4A62-46D2-A0AE-7F25DCF6DEC3" name="GUID-3E8DE9F7-4A62-46D2-A0AE-7F25DCF6DEC3"></a><h4 id="BRADV-GUID-3E8DE9F7-4A62-46D2-A0AE-7F25DCF6DEC3" class="sect4"><span class="enumeration_section">25.9.8</span>示例：使用主动复制将PDB复制到现有CDB</h4>
                  <div>
                     <p>此示例描述如何使用活动数据库复制将PDB复制到现有CDB中。</p>
                     <div class="section">
                        <p></p>
                        <p>该示例假定以下情形：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>源CDB， <code class="codeph">cdb_src</code>和目标CDB <code class="codeph">cdb_dest</code>位于不同的主机上。
                              </p>
                           </li>
                           <li>
                              <p>源CDB和目标CDB都使用OMF来管理数据库文件。</p>
                           </li>
                           <li>
                              <p>源CDB和目标CDB的兼容设置为18.0.0或更高。</p>
                           </li>
                           <li>
                              <p>源CDB和目标CDB使用本地撤消。</p>
                           </li>
                           <li>
                              <p>正在复制的PDB <code class="codeph">my_pdb</code>处于读写模式。
                              </p>
                           </li>
                           <li>
                              <p>源CDB和目标CDB以读写模式打开。</p>
                           </li>
                           <li>
                              <p>为目标CDB设置初始化参数<code class="codeph">REMOTE_RECOVERY_FILE_DEST</code> ，该参数确定恢复外部归档重做日志文件的位置。</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>按照<span class="q">“ <a href="rman-duplicating-databases.html#GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" title="Before duplicating a database, you must make some decisions about the duplication process.">计划复制数据库</a> ”中的说明<a href="rman-duplicating-databases.html#GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" title="在复制数据库之前，您必须对复制过程做出一些决定。">规划复制</a></span> 。这包括以下任务：</span><div>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>由于PDB正在复制到现有CDB，因此唯一可用的复制技术是主动复制。</p>
                                 </li>
                                 <li>
                                    <p>选择策略以命名重复的数据库文件。</p>
                                    <p>在此示例中， <code class="codeph">DB_FILE_NAME_CONVERT</code>初始化参数用于指定重复数据库文件的位置。
                                    </p>
                                 </li>
                                 <li>
                                    <p>在目标CDB上配置四个辅助通道，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-F2ED1190-E3BF-4898-BDCC-B9FF0500C76B" title="数据库复制的主要工作由RMAN通道执行。每个通道对应于执行复制任务的Oracle数据库服务器会话。根据复制技术，RMAN使用辅助通道或目标通道。">配置RMAN通道以用于复制</a> ”中所述</span> 。
                                    </p>
                                    <p>在此示例中，源数据库上配置了三个目标通道。对于RMAN使用备份集执行活动数据库复制，辅助通道的数量必须等于或大于目标通道的数量。</p>
                                 </li>
                              </ul>
                           </div>
                        </li>
                        <li class="stepexpand"><span>确保满足主动复制的先决条件以及将PDB复制到现有CDB的其他先决条件，如<a href="../rcmrf/DUPLICATE.html#RCMRF-GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4" target="_blank"><span><cite>Oracle数据库备份和恢复参考中所述</cite></span></a> 。</span></li>
                        <li class="stepexpand"><span>在源CDB和目标CDB之间建立Oracle网络连接，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-460171C8-2E09-4D0E-9AC3-A4C28392A220" title="对于某些形式的复制，您必须能够在源数据库和辅助实例之间建立连接。">在源数据库和辅助实例之间建立Oracle网络连接</a> ”中所述</span> 。</span></li>
                        <li class="stepexpand"><span>创建将重复数据库文件存储在目标主机上的目录，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-2ECA94F4-E8EB-43D7-9934-39F2BE281700" title="在目标主机上，必须创建用于在目标主机上存储重复数据库文件的目录。这包括存储数据文件，控制文件，联机重做日志文件和临时文件的目录。">为重复数据库创建目录</a> ”中所述</span> 。</span></li>
                        <li class="stepexpand"><span>启动RMAN并将<code class="codeph">TARGET</code>连接到源CDB的根目录，并作为<code class="codeph">AUXILIARY</code>到目标CDB的根目录。</span><div><pre class="pre codeblock"><code>％rman RMAN&gt; CONNECT TARGET sys @ cdbsrc as SYSDBA; RMAN&gt; CONNECT AUXILIARY sys @ cdbdup AS SYSBACKUP;</code></pre><p><span class="bold">注意：</span>对于活动数据库复制，与目标CDB的连接必须使用密码文件身份验证。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>使用<code class="codeph">DUPLICATE</code>命令复制数据库。</span><div>
                              <p>使用<code class="codeph">DB_CREATE_FILE_DEST</code>参数指定用于在重复数据库中存储重复数据库文件的磁盘组。
                              </p><pre class="pre codeblock"><code>DUPLICATE PLUGGABLE DATABASE my_pdb AS dup_pdb TO cdb_dest FROM ACTIVE DATABASE DB_FILE_NAME_CONVERT ='/ disk1 / oracle / dbs'，'disk2 / oracle / dbs';</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>删除作为复制的一部分还原到<code class="codeph">remote_recovery_file_dest</code>初始化参数指定的位置的外部归档重做日志文件。</span></li>
                     </ol>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-915D2CB7-29AB-46E6-B923-3CF419F59362" name="GUID-915D2CB7-29AB-46E6-B923-3CF419F59362"></a><h4 id="BRADV-GUID-915D2CB7-29AB-46E6-B923-3CF419F59362" class="sect4"><span class="enumeration_section">25.9.9</span>示例：使用加密备份执行基于备份的复制</h4>
                  <div>
                     <p>RMAN使您可以使用<code class="codeph">DUPLICATE</code>命令通过使用加密备份执行基于备份的复制。
                     </p>
                     <div class="section">
                        <p></p>
                        <p>此示例使用以下方案：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>源主机和目标主机是不同的。</p>
                           </li>
                           <li>
                              <p>源数据库和目标数据库都使用OMF来管理数据库文件名。但是，重复数据库使用的目录结构与源数据库的目录结构不同。</p>
                           </li>
                           <li>
                              <p>源数据库备份使用透明模式加密进行加密，加密密钥存储在基于密码的软件密钥库中。密钥库密码是使用以下命令设置的（其中<code class="codeph"><span class="codeinlineitalic">password</span></code>是您输入的实际密码的占位符）：</p><pre class="oac_no_warn" dir="ltr">通过<span class="italic">密码</span>识别的ALTER SYSTEM SET ENCRYPTION KEY;</pre></li>
                           <li>
                              <p>源数据库的完整备份（包括控制文件，数据文件和归档重做日志文件）存储在<code class="codeph">/oracle2/rman_backups</code>目录中。
                              </p>
                           </li>
                           <li>
                              <p>源数据库的<code class="codeph">DB_NAME</code>是<code class="codeph">db_src</code> ，重复数据库的<code class="codeph">DB_NAME</code>是<code class="codeph">dup_db</code> 。
                              </p>
                           </li>
                           <li>
                              <p>必须从重复数据库中排除<code class="codeph">EXAMPLE</code>和<code class="codeph">TOOLS</code>表空间。
                              </p>
                           </li>
                           <li>
                              <p>复制过程完成后，必须打开重复的数据库。</p>
                           </li>
                        </ul>
                        <p>要使用加密备份执行基于备份的数据库复制：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>按照<span class="q">“ <a href="rman-duplicating-databases.html#GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" title="Before duplicating a database, you must make some decisions about the duplication process.">计划复制数据库</a> ”中的说明<a href="rman-duplicating-databases.html#GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" title="在复制数据库之前，您必须对复制过程做出一些决定。">规划复制</a></span> 。这包括以下任务：</span><ol type="a">
                              <li class="substepexpand"><span>选择适合场景和要求的复制技术。</span><div>
                                    <p>在此示例中，执行没有目标连接或恢复目录连接的基于备份的复制。<code class="codeph">BACKUP LOCATION</code>选项用于指定源数据库备份的位置。
                                    </p>
                                 </div>
                              </li>
                              <li class="substepexpand"><span>选择生成重复数据库文件名的策略。</span><div>
                                    <p>由于重复数据库使用的目录结构与源数据库不同，因此请使用辅助实例的初始化参数文件中的<code class="codeph">DB_CREATE_FILE_DEST</code>参数来指定存储重复数据库文件的位置。
                                    </p>
                                 </div>
                              </li>
                              <li class="substepexpand"><span>使用源数据库上使用的相同目录结构将所需备份复制到目标主机。</span></li>
                           </ol>
                        </li>
                        <li class="stepexpand"><span>确保满足所选复制技术的先决条件，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-7FDB9916-8FB9-471A-8EFD-26E34FB8EA25" title="先决条件取决于正在执行的数据库重复的类型。某些先决条件对于所有类型的复制都是通用的，而其他先决条件则特定于特定类型的复制。">复制数据库的先决条件</a> ”中所述</span> 。</span></li>
                        <li class="stepexpand"><span>准备辅助实例。</span><ol type="a">
                              <li class="substepexpand"><span>创建在目标主机上存储数据库文件的目录。</span><div>
                                    <p>在此示例中，创建<code class="codeph">/app/db_home2/database</code>目录以存储数据文件，控制文件和服务器参数文件以及<code class="codeph">/app/db_home2/logfiles</code>目录以存储联机重做日志文件。
                                    </p>
                                 </div>
                              </li>
                              <li class="substepexpand"><span>为辅助实例创建最小初始化参数文件。</span><div>
                                    <p>该文件名为<code class="codeph">initdup.ora</code> ，位于<code class="codeph">/app/db_home2/database</code>目录中。它包含以下条目：</p><pre class="pre codeblock"><code><code class="codeph">DB_NAME=dup_db</code> <code class="codeph">DB_DOMAIN = dup.example.com</code> <code class="codeph">DB_CREATE_FILE_DEST = /app/db_home2/database</code></code></pre><p>请参阅<span class="q">“ <a href="rman-duplicating-databases.html#GUID-57888C11-63C3-4A7A-8488-2E623033A359" title="有多种方法可用于创建启动辅助实例所需的初始化参数文件。">为辅助实例创建初始化参数文件</a> ”</span> 。
                                    </p>
                                 </div>
                              </li>
                              <li class="substepexpand"><span>将密码文件从源数据库复制到目标主机，如<span class="q">“ <a href="rman-duplicating-databases.html#GUID-A338B143-E321-4329-A2ED-2467C70C03DC" title="可以使用操作系统身份验证或密码文件身份验证来建立与辅助实例的连接。对于基于备份的复制，您可以创建密码文件或使用操作系统身份验证连接到辅助实例。对于活动数据库复制，您必须使用密码文件身份验证。">为辅助实例创建密码文件</a> ”中所述</span> 。</span><div>
                                    <p>密码文件是必需的，因为正在远程主机上创建重复数据库。</p>
                                 </div>
                              </li>
                              <li class="substepexpand"><span>使用静态侦听器在源数据库和辅助实例之间设置Oracle网络服务连接。这是必需的，因为此示例将数据库复制到远程主机。</span><div>
                                    <p>请参阅<span class="q">“ <a href="rman-duplicating-databases.html#GUID-460171C8-2E09-4D0E-9AC3-A4C28392A220" title="对于某些形式的复制，您必须能够在源数据库和辅助实例之间建立连接。">在源数据库和辅助实例之间建立Oracle网络连接</a> ”</span> 。
                                    </p>
                                 </div>
                              </li>
                              <li class="substepexpand"><span>使用在步骤3b中创建的参数文件<code class="codeph">initdupdb.ora</code>以<code class="codeph">NOMOUNT</code>模式启动辅助实例。</span></li>
                           </ol>
                        </li>
                        <li class="stepexpand"><span>启动RMAN并以<code class="codeph">TARGET</code>身份连接到源数据库，并以辅助实例身份连接到<code class="codeph">AUXILIARY</code> 。</span><div><pre class="oac_no_warn" dir="ltr">％rman RMAN&gt; CONNECT TARGET / RMAN&gt; CONNECT AUXILIARY sys @ dup_db AS SYSBACKUP</pre><p>出现提示时输入密码。</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>由于用于复制数据库的源数据库备份是加密备份，因此请指定必须用于打开包含加密密钥的软件密钥库的密码（其中<code class="codeph"><span class="codeinlineitalic">password</span></code>是您输入的实际密码的占位符）。</span><div><pre class="oac_no_warn" dir="ltr">SET DECRYPTION WALLET OPEN由<span class="italic">密码</span>识别;</pre><p>请注意， <code class="codeph">SET</code>命令中指定的密码必须与使用<code class="codeph">ALTER SYSTEM SET ENCRYPTION KEY</code>命令在源数据库上<code class="codeph">SET</code>的密码相同。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>使用<code class="codeph">DUPLICATE</code>命令复制数据库。</span><div>
                              <p>在执行复制之前，必须指定必须用于解密RMAN备份的密码。</p><pre class="oac_no_warn" dir="ltr">DUPLICATE目标数据库到'dup_db'跳过TABLESPACE示例，工具PFILE'/ app / db_home2 / initdupdb.ora'BACKUP LOCATION'/ oracle2 / rman_backups';</pre></div>
                        </li>
                     </ol>
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-915D2CB7-29AB-46E6-B923-3CF419F59362__GUID-25044B8D-894B-4170-BA75-434378AEC53A">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="rman-duplicating-databases.html#GUID-EA6E8219-56BF-471C-AC5A-DFC55E760806" title="本节包含使用不同复制技术复制数据库的示例。">示例：复制数据库</a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-D65799A8-0921-4DFE-B407-21715911DA21" name="GUID-D65799A8-0921-4DFE-B407-21715911DA21"></a><h3 id="BRADV-GUID-D65799A8-0921-4DFE-B407-21715911DA21" class="sect3"><span class="enumeration_section">25.10</span>示例：使用基于备份的复制复制数据库的脚本</h3>
               <div>
                  <p>此示例显示如何使用脚本自动执行复制目标数据库的过程。</p>
                  <div class="section">
                     <div class="p">此示例假定以下内容：<ul style="list-style-type:disc">
                           <li>
                              <p>目标数据库的备份可供辅助实例使用。</p>
                           </li>
                           <li>
                              <p>可以使用包含目标数据库元数据的RMAN恢复目录的连接（不需要连接到目标数据库）。</p>
                           </li>
                           <li>
                              <p>源数据库和重复数据库都使用Oracle托管文件（OMF）。</p>
                           </li>
                           <li>
                              <p>使用的操作系统是Linux或UNIX。</p>
                           </li>
                           <li>
                              <p>审计目录在辅助数据库主机上创建。</p>
                           </li>
                           <li>
                              <p>满足基于备份的复制的先决条件。</p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <div class="p">此示例中提供的脚本执行以下任务：<ul style="list-style-type:disc">
                           <li>
                              <p>删除辅助数据库。</p>
                           </li>
                           <li>
                              <p>备份目标数据库。</p>
                           </li>
                           <li>
                              <p>创建一个虚拟辅助实例并以<code class="codeph">NOMOUNT</code>模式打开它。
                              </p>
                           </li>
                           <li>
                              <p>使用RMAN恢复目录中的目标数据库备份和元数据复制目标数据库。</p>
                              <p>重复的数据库控制文件存储为<code class="codeph">+REDO/</code> <span class="italic"><code class="codeph">ORACLE_SID</code></span> <code class="codeph">/CONTROLFILE/cf3.ctl</code> ，数据文件存储在<code class="codeph">+DATA</code>目录中。
                              </p>
                           </li>
                           <li>
                              <p>验证是否在重复数据库中创建了所需的对象。</p>
                           </li>
                        </ul>
                     </div>
                     <p>要在没有目标连接的情况下使用基于备份的复制来复制目标数据库：</p>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>为辅助实例创建参数文件（pfile）。pfile仅包含<code class="codeph">DB_NAME</code>初始化参数，该参数设置为重复数据库的SID。</span><div>
                           <p>以下名为<code class="codeph">init_dup.ora</code> pfile位于<code class="codeph">/home/oracle</code>目录中，用于设置<code class="codeph">DB_NAME</code>参数。将<span class="italic"><code class="codeph">dup_db</code></span>替换为重复数据库的SID：</p><pre class="pre codeblock"><code>* .db_name =' <span class="italic">dup_db</span> '</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>使用文本编辑器创建一个Shell脚本（在本例中称为<code class="codeph">dup_db.sh</code> ），其内容如下所示，并进行了以下修改：</span><div>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>将<code class="codeph">ORACLE_HOME</code>变量的值替换为辅助实例的Oracle主目录。
                                 </p>
                              </li>
                              <li>
                                 <p>将<code class="codeph">logdir</code>变量的值替换为要存储日志文件的目录。
                                 </p>
                              </li>
                              <li>
                                 <p>将以下占位符（以斜体显示）替换为适合您的复制方案的值：</p>
                                 <p><span class="italic"><code class="codeph">dup_db</code></span> ：辅助实例的SID和服务名称</p>
                                 <p><span class="italic"><code class="codeph">tgt_db</code></span> ：目标数据库的SID和服务名称</p>
                                 <p><span class="italic"><code class="codeph">sys_pswd</code></span> ：目标数据库的<code class="codeph">SYS</code>用户的密码</p>
                                 <p><span class="italic"><code class="codeph">rman_cat_user</code></span> ：RMAN目录用户的名称</p>
                                 <p><span class="italic"><code class="codeph">cat_user_pswd</code></span> ：RMAN目录用户<span class="italic"><code class="codeph">rman_cat_user</code></span>密码</p>
                                 <p><span class="italic"><code class="codeph">rman_catalog_db</code></span> ：RMAN目录数据库的SID</p>
                                 <p><span class="italic"><code class="codeph">system_pswd</code></span> ：目标数据库中<code class="codeph">SYSTEM</code>用户的密码</p>
                              </li>
                              <li>
                                 <p>如果要使用与<code class="codeph">+REDO/</code> <span class="italic"><code class="codeph">ORACLE_SID</code></span> <code class="codeph">/CONTROLFILE/cf3.ctl</code>不同的名称和位置存储重复的数据库控制文件，请将<code class="codeph">dup_aux_db</code>函数中的<code class="codeph">control_files</code>值替换为适合您的复制方案的值。
                                 </p>
                              </li>
                              <li>
                                 <p>如果要将重复数据文件存储在与<code class="codeph">+DATA</code>不同的目录中，请将<code class="codeph">dup_aux_db</code>函数中的<code class="codeph">db_create_file_dest</code>值替换为适合您的复制方案的值。
                                 </p>
                              </li>
                           </ul><pre class="pre codeblock"><code>＃！/ bin / bash export ORACLE_HOME = / u01 / app / oracle / product / 11.2.0.4 / dbhome_2 export ORACLE_BASE = / uo1 / app / oracle export ORACLE_SID = <span class="italic">dup_db</span> export PATH = $ PATH：$ HOME / bin：$ ORACLE_HOME / bin： $ ORACLE_HOME / Opatch export LD_LIBRARY_PATH = $ ORACLE_HOME / lib：$ ORACLE_HOME / rdbms / lib：/ lib：/ usr / lib; export LD_LIBRARY_PATH export logdir = / home / oracle / log export dt ='date +％y％m％d％H％M％S'export NLS_DATE_FORMAT ='DD-MM-YYYY HH24：MI：SS'函数drop_aux_db {export ORACLE_SID = <span class="italic">dup_db</span> $ ORACLE_HOME / bin / sqlplus -s'/ as sysdba'&lt;&lt; EOF2 set pagesize 999 linesize 999 av off off off feedback off select name，open_mode from v \ $ database;立即关机; startup mount exclusive restrict;丢弃数据库;出口; EOF2} echo“备份目标数据库”函数backup_source_db {$ ORACLE_HOME / bin / rman target sys / <span class="italic">sys_pswd</span> <span class="italic">@tgt_db</span> catalog <span class="italic">rman_cat_user</span> / <span class="italic">cat_user_pswd</span> @ <span class="italic">rman_catalog_db</span> &lt;&lt; EOF RUN {backup as backupset cumulative incremental level 1 database包括current controlfile plus archivelog not backed up delete input;} exit; EOF} sleep 120 echo“列出目标数据库的备份”函数check_source_db_backup {$ ORACLE_HOME / bin / rman target sys / <span class="italic">sys_pswd</span> <span class="italic">@tgt_db</span> catalog <span class="italic">rman_cat_user</span> / <span class="italic">cat_user_pswd</span> @ <span class="italic">rman_catalog_db</span> &lt;&lt; EOF LIST BACKUP OF DATABASE <span class="italic">ALLTER</span> ''（SYSDATE-1 / 24）'; EOF} echo“以FORCE NOMOUNT模式启动辅助数据库”函数nomount_aux_db {export ORACLE_SID = <span class="italic">dup_db</span> $ ORACLE_HOME / bin / rman target / &lt;&lt; EOF2 startup force nomount pfile ='/ home / oracle / init_dup.ora';出口; EOF2} echo“复制目标数据库”函数dup_aux_db {export ORACLE_SID = <span class="italic">dup_db</span> $ ORACLE_HOME / bin / rman catalog <span class="italic">rman_cat_user</span> / <span class="italic">cat_user_pswd</span> @ <span class="italic">rman_catalog_db</span> AUXILIARY / &lt;&lt; EOF duplicate database <span class="italic">tgt_db</span> to <span class="italic">dup_db</span> spfile set control_files'+ REDO / $ { <span class="italic">ORACLE_SID</span> } / CONTROLFILE / cf3.ctl'设置db_create_file_dest'+ DATA /';出口; EOF} echo“检查目标上的模式对象”函数check_source_db {$ ORACLE_HOME / bin / sqlplus -s system / <span class="italic">system_pswd</span> <span class="italic">@tgt_db</span> &lt;&lt; EOF2 set pagesize 999 linesize 999标题关闭反馈选择名称，来自v \ $ database的open_mode;选择table_name，num_rows来自dba_tables，其中owner ='SOE';出口; EOF2} echo“检查辅助上的模式对象”函数check_aux_db {export ORACLE_SID = <span class="italic">dup_db</span> $ ORACLE_HOME / bin / sqlplus -s'/ as sysdba'&lt;&lt; EOF2 set pagesize 999 linesize 999标题关闭反馈关闭选择名称，open_mode from v \ $数据库;选择table_name，num_rows来自dba_tables，其中owner ='SOE';出口; EOF2} drop_aux_db backup_source_db check_source_db_backup nomount_aux_db dup_aux_db check_source_db check_aux_db</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>使用<code class="codeph">chmod</code>命令为脚本<code class="codeph">dup_db.sh</code>设置执行权限。</span><div><code class="codeph">$ chmod + x dup_db.sh</code></div>
                     </li>
                     <li class="stepexpand"><span>在重复主机（承载重复数据库）上，运行<code class="codeph">dup_db.sh</code>脚本。</span><div>
                           <p>以下命令运行存储在<code class="codeph">/home/my_scripts/duplication</code>目录中的<code class="codeph">dup_db.sh</code>脚本：</p><code class="codeph">$。/家庭/ my_scripts /复制/ dup_db.sh</code></div>
                     </li>
                  </ol>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>