<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="Workload management includes load balancing, enabling clients for Oracle Real Application Clusters (Oracle RAC), distributed transaction processing, and services.">
      <meta name="description" content="Workload management includes load balancing, enabling clients for Oracle Real Application Clusters (Oracle RAC), distributed transaction processing, and services.">
      <title>Workload Management with Dynamic Database Services</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Real Application Clusters Administration and Deployment Guide">
      <meta property="og:description" content="Workload management includes load balancing, enabling clients for Oracle Real Application Clusters (Oracle RAC), distributed transaction processing, and services.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Real Application Clusters Administration and Deployment Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="real-application-clusters-administration-and-deployment-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-04-25T14:02:30-07:00">
      <meta name="dcterms.title" content="Real Application Clusters Administration and Deployment Guide">
      <meta name="dcterms.dateCopyrighted" content="1999, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E95728-03">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="administering-oracle-rac-one-node.html" title="Previous" type="text/html">
      <link rel="next" href="ensuring-application-continuity.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="RACAD">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="administering-oracle-rac-one-node.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="ensuring-application-continuity.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Real Application Clusters Administration and Deployment Guide</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Workload Management with Dynamic Database Services</li>
            </ol>
            <a id="GUID-8DC4D5E0-CA9D-47BC-BAD0-8769405AFEC5" name="GUID-8DC4D5E0-CA9D-47BC-BAD0-8769405AFEC5"></a><a id="RACAD076"></a>
            
            <h2 id="RACAD-GUID-8DC4D5E0-CA9D-47BC-BAD0-8769405AFEC5" class="sect2"><span class="enumeration_chapter">5 </span>Workload Management with Dynamic Database Services
            </h2>
         </header>
         <div class="ind"><script type="text/javascript">window.name='workload-management-with-dynamic-database-services'</script><script type="text/javascript">
    function footdisplay(footnum,footnote) {
    var msg = window.open('about:blank', 'NewWindow' + footnum,
        'directories=no,height=100,location=no,menubar=no,resizable=yes,' +
        'scrollbars=yes,status=no,toolbar=no,width=598');
    msg.document.open('text/html');
    msg.document.write('<!DOCTYPE html ');
    msg.document.write('PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" ');
    msg.document.write('"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">'); 
    msg.document.write('<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us" dir="ltr"><head><title>');
   
    msg.document.write('Footnote&nbsp; ' + footnum);
    msg.document.write('<\/title><meta http-equiv="Content-Type" ');
    msg.document.write('content="text/html; charset=utf-8" />');
    msg.document.write('<meta http-equiv="Content-Script-Type" ');
    msg.document.write('content="text/javascript" />');
    msg.document.write('<style type="text/css"> <![CDATA[ ');
    msg.document.write('h1 {text-align: center; font-size: 14pt;}');
    msg.document.write('fieldset {border: none;}');
    msg.document.write('form {text-align: center;}');
    msg.document.write(' ]]\u003e <\/style>');
    msg.document.write('<\/head><body><div id="footnote"><h1>Footnote&nbsp; ' + footnum + '<\/h1><p>');
    msg.document.write(footnote);
    msg.document.write('<\/p><form action="" method="post"><fieldset>');
    msg.document.write('<input type="button" value="OK" ');
    msg.document.write('onclick="window.close();" />');
    msg.document.write('<\/fieldset><\/form><\/div><\/body><\/html>');
    msg.document.close();
    setTimeout(function() {
        var height = msg.document.getElementById('footnote').offsetHeight;
        msg.resizeTo(598, height + 100);
    }
    , 100);
    msg.focus();
}
            </script><noscript>
               <p>The script content on this page is for navigation purposes only and does not alter the content in any way.</p>
            </noscript>
            <div>
               <p>Workload management includes load balancing, enabling clients for Oracle Real Application Clusters (Oracle RAC), distributed transaction processing, and services.</p>
               <p>This chapter includes the following topics:</p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p><a href="workload-management-with-dynamic-database-services.html#GUID-095B67FB-3E3A-44BE-84A4-321174015A08" title="Oracle Net Services provides the ability to distribute client connections across the instances in an Oracle RAC configuration.">Connection Load Balancing</a></p>
                  </li>
                  <li>
                     <p><a href="workload-management-with-dynamic-database-services.html#GUID-26E66434-7A68-4B63-B759-3E0A8CA14A8B" title="You can configure your environment to use the load balancing advisory by defining service-level goals for each service for which you want to enable load balancing.The load balancing advisory FAN events provide metrics for load balancing algorithms.">Load Balancing Advisory</a></p>
                  </li>
                  <li>
                     <p><a href="workload-management-with-dynamic-database-services.html#GUID-074729CB-8A91-419C-A6E1-3B9E4FD8D869" title="The overall goals of FAN are to enable end-to-end, lights-out recovery of applications and load balancing based on real transaction performance.Enabling Fast Connection Failover (FCF) for Universal Connection Pool and Oracle WebLogic Server Active GridLink for Oracle RAC enables the use of FAN HA and load balancing advisory events.You can enable FCF for Universal Connection Pool or Implicit Connection Cache.Run-time connection load balancing requires the use of an Oracle JDBC driver and an Oracle RAC database.The Replay data source (oracle.jdbc.replay.OracleDataSource) is a JDBC-thin data source that Application Continuity requires for Java.Transaction Guard provides a protocol and a generic tool for applications to use for at-most-once execution in case of planned and unplanned outages.As of Oracle Database 12c, OCI session pooling enables multiple threads of an application to use a dynamically managed set of pre-created database sessions.OCI supports FAN messages and Transaction Guard. FAN is designed to quickly notify an OCI-based application of outages at the node, database, instance, service, and public network levels.ODP.NET connection pools can subscribe to FAN HA notifications that indicate when nodes, services, and service members are down.When connecting to Oracle Database 12c and later, ODP.NET uses Oracle Notification Service, rather than Advanced Queuing.ODP.NET supports FAN messages and Transaction Guard. FAN is designed to quickly notify an ODP.NET-based application of outages at the node, database, instance, service, and public network levels.">Enabling Clients for Oracle RAC</a></p>
                  </li>
                  <li>
                     <p><a href="workload-management-with-dynamic-database-services.html#GUID-7948E56B-D455-4852-A3EF-20E4F59156A5">Distributed Transaction Processing in Oracle RAC</a></p>
                  </li>
                  <li>
                     <p><a href="workload-management-with-dynamic-database-services.html#GUID-C3CD2DCE-38BD-46BA-BC32-7A28CAC9A7FD" title="The Automatic Workload Repository (AWR) collects, processes, and maintains performance statistics for the database.">Automatic Workload Repository</a></p>
                  </li>
                  <li>
                     <p><a href="workload-management-with-dynamic-database-services.html#GUID-559FB230-857B-4D97-B36A-F4F76C3A1D47" title="Services add a new dimension for performance tuning because workloads are visible and measurable, and therefore resource consumption and wait times are attributable by application.">Measuring Performance by Service Using the Automatic Workload Repository</a></p>
                  </li>
                  <li>
                     <p><a href="workload-management-with-dynamic-database-services.html#GUID-27E6E869-570C-4B01-BF49-C147744D0D7D">Automatic Workload Repository Service Thresholds and Alerts</a></p>
                  </li>
                  <li>
                     <p><a href="workload-management-with-dynamic-database-services.html#GUID-4CC2D344-02D6-40E7-85B6-BB3AA7D6461A">Using Oracle Services</a></p>
                  </li>
                  <li>
                     <p><a href="workload-management-with-dynamic-database-services.html#GUID-6524637F-FE3E-46D9-8B47-887C0D7C562C" title="Oracle GoldenGate takes advantage of Oracle RAC features.When you use Oracle Clusterware to manage your database, you can configure startup options for each individual database service when you add the service using the srvctl add service command with the -policy parameter.If you configured Oracle Data Guard in your environment, then you can define a role for services when you add or modify a service using SRVCTL and the -role parameter with the appropriate command.When you define a service for an administrator-managed database, you define which instances normally support that service using SRVCTL with the -preferred parameter.Oracle RAC routes clients with the same COLOCATION_TAG to the same database instance, when possible.When you define services for a policy-managed database, you assign the service to a server pool in which the database is hosted using SRVCTL with the -serverpool parameter.Oracle Net Services provides connection load balancing to enable you to spread user connections across all of the instances that are supporting a service.This feature allows listener registration only from local IP addresses, by default, and provides the ability to configure and dynamically update a set of IP addresses or subnets from which registration requests are allowed by the listener.">Service Deployment Options</a></p>
                  </li>
                  <li>
                     <p><a href="workload-management-with-dynamic-database-services.html#GUID-2678C005-1B70-4B88-90E0-174A324F7DAA" title="When you create and administer services, you are dividing the work that your database performs into manageable units.The Cluster Managed Database Services page is the master page for beginning all tasks related to services.When you create a service using SRVCTL, you must start the service with a separate SRVCTL command.To create a service with SRVCTL, use the srvctl add service command on the command line.To configure services for Application Continuity, when you create a service using SRVCTL, set the -failovertype parameter to TRANSACTION and -commit_outcome to TRUE.">Administering Services</a></p>
                  </li>
                  <li>
                     <p><a href="workload-management-with-dynamic-database-services.html#GUID-4C9FACD5-E959-4C79-A962-EFACBBC46545" title="Oracle RAC supports database services and enables service-level workload management across instances in a single cluster.">Global Services</a></p>
                  </li>
                  <li>
                     <p><a href="workload-management-with-dynamic-database-services.html#GUID-6552E661-CB51-462C-8C0C-02CEE4E50001">Connecting to a Service: An Example</a></p>
                  </li>
               </ul>
            </div><a id="RACAD7122"></a><div class="sect2"><a id="GUID-095B67FB-3E3A-44BE-84A4-321174015A08" name="GUID-095B67FB-3E3A-44BE-84A4-321174015A08"></a><h3 id="RACAD-GUID-095B67FB-3E3A-44BE-84A4-321174015A08" class="sect3">Connection Load Balancing</h3>
               <div>
                  <p>Oracle Net Services provides the ability to distribute client connections across the instances in an Oracle RAC configuration.</p>
                  <p>There are two types of load balancing that you can implement: client-side and server-side load balancing. Client-side load balancing distributes the connection requests across the listeners, independently at each client. With server-side load balancing, the SCAN listener directs a connection request to the best instance currently providing the service, based on the <code class="codeph">-clbgoal</code> and <code class="codeph">-rlbgoal</code> settings for the service.
                  </p>
                  <p>The SCAN listener is aware of the HTTP protocol so that it can redirect HTTP clients to the appropriate handler, which can reside on different nodes in the cluster than the node on which the SCAN listener resides.</p>
                  <p>In an Oracle RAC database, client connections should use both types of connection load balancing.</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="workload-management-with-dynamic-database-services.html#GUID-523373FE-A5E0-4891-A1C6-76B7C35C4F6D">Server-Side Load Balancing</a></p>
                     </li>
                     <li>
                        <p><a href="workload-management-with-dynamic-database-services.html#GUID-02CF045D-EC05-4B4E-BB7D-41966BC700BD" title="Oracle Net Services enables you to add the CONNECT_TIMEOUT, RETRY_COUNT, and TRANSPORT_CONNECT_TIMEOUT parameters to the tnsnames.ora connection string.">Generic Database Clients</a></p>
                     </li>
                     <li>
                        <p><a href="workload-management-with-dynamic-database-services.html#GUID-10F7892A-92DD-482C-8D68-AE80CE956010">Client-Side Load Balancing</a></p>
                     </li>
                     <li>
                        <p><a href="workload-management-with-dynamic-database-services.html#GUID-5129AD20-E50A-47D4-95D5-99A8DE72294E" title="For OCI clients, create a local sqlnet.ora file on the client side.">Client-Side Connection Configuration for Older Clients</a></p>
                     </li>
                  </ul>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="../netag/identifying-and-accessing-database.html#NETAG-GUID-4872CA90-12EE-4909-B504-622122FFCDAE" target="_blank"><span><cite>Oracle Database Net Services Administrator's Guide</cite></span></a></li>
                     </ul>
                  </div>
               </div><a id="RACAD8280"></a><div class="sect3"><a id="GUID-523373FE-A5E0-4891-A1C6-76B7C35C4F6D" name="GUID-523373FE-A5E0-4891-A1C6-76B7C35C4F6D"></a><h4 id="RACAD-GUID-523373FE-A5E0-4891-A1C6-76B7C35C4F6D" class="sect4">Server-Side Load Balancing</h4>
                  <div>
                     <p>When you create an Oracle RAC database with DBCA, it automatically:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Configures and enables server-side load balancing</p>
                        </li>
                        <li>
                           <p>Creates a sample client-side load balancing connection definition in the <code class="codeph">tnsnames.ora</code> file on the server
                           </p>
                        </li>
                     </ul>
                     <p>The Oracle Clusterware Database Agent is responsible for managing the <code class="codeph">LISTENER_NETWORKS</code> parameter.
                     </p>
                     <div class="infoboxnote" id="GUID-523373FE-A5E0-4891-A1C6-76B7C35C4F6D__GUID-011F73AC-3E3D-4F89-8C3D-95B32798FD39">
                        <p class="notep1">Note:</p>
                        <p>Note: If you set the <code class="codeph">REMOTE_LISTENER</code> parameter manually, then set this parameter to <span class="italic"><code class="codeph">scan_name</code></span><code class="codeph">:</code><span class="italic"><code class="codeph">scan_port</code></span>.
                        </p>
                     </div>
                     <p>FAN, Fast Connection Failover, and the load balancing advisory depend on an accurate connection load balancing configuration that includes setting the connection load balancing goal for the service. You can use a goal of either <code class="codeph">LONG</code> or <code class="codeph">SHORT</code> for connection load balancing. These goals have the following characteristics:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><span class="bold">SHORT</span>: Use the <code class="codeph">SHORT</code> <a id="d17899e658" class="indexterm-anchor"></a>connection load balancing method for applications that use run-time load balancing. When using connection pools that are integrated with Load Balancing Advisory, set the <code class="codeph">CLB_GOAL</code> to <code class="codeph">SHORT</code>. The following example modifies the service known as <code class="codeph">oltpapp</code>, using SRVCTL to set the connection load balancing goal to <code class="codeph">SHORT</code>:
                           </p><pre class="oac_no_warn" dir="ltr">$ srvctl modify service -db <span class="italic">db_unique_name</span> -service oltpapp -clbgoal SHORT</pre></li>
                        <li>
                           <p><span class="bold">LONG</span>: Use the <code class="codeph">LONG</code> <a id="d17899e689" class="indexterm-anchor"></a>connection load balancing method if run-time load balancing is not required. This is typical for batch operations. <code class="codeph">LONG</code> is the default connection load balancing goal. The following is an example of modifying a service, <code class="codeph">batchconn</code>, using SRVCTL to define the connection load balancing goal for long-lived sessions:
                           </p><pre class="oac_no_warn" dir="ltr">$ srvctl modify service -db <span class="italic">db_unique_name</span> -service batchconn -clbgoal LONG</pre></li>
                     </ul>
                  </div>
               </div><a id="RACAD8276"></a><div class="sect3"><a id="GUID-02CF045D-EC05-4B4E-BB7D-41966BC700BD" name="GUID-02CF045D-EC05-4B4E-BB7D-41966BC700BD"></a><h4 id="RACAD-GUID-02CF045D-EC05-4B4E-BB7D-41966BC700BD" class="sect4">Generic Database Clients</h4>
                  <div>
                     <p>Oracle Net Services enables you to add the <code class="codeph">CONNECT_TIMEOUT</code>, <code class="codeph">RETRY_COUNT</code>, and <code class="codeph">TRANSPORT_CONNECT_TIMEOUT</code> parameters to the <code class="codeph">tnsnames.ora</code> connection string.
                     </p>
                     <p>For example, when using SCAN addresses for the remote listeners at the database:</p><pre class="pre codeblock"><code>jdbc:oracle:thin:@(DESCRIPTION =
 (TRANSPORT_CONNECT_TIMEOUT=3)(CONNECT_TIMEOUT=60)
 (RETRY_COUNT=3)(FAILOVER=ON)
 (ADDRESS_LIST =(ADDRESS=(PROTOCOL=tcp)
  (HOST=CLOUD-SCANVIP.example.com)(PORT=5221))
 (CONNECT_DATA=(SERVICE_NAME=orcl)))
Remote_listeners=CLOUD-SCANVIP.example.com:5221
</code></pre><p>For example, when using remote listeners pointing to VIPs at the database:</p><pre class="pre codeblock"><code>jdbc:oracle:thin:@(DESCRIPTION =
 (TRANSPORT_CONNECT_TIMEOUT=3)
 (CONNECT_TIMEOUT=60)(RETRY_COUNT=20)
 (RETRY_DELAY=3)(FAILOVER=ON)
 (ADDRESS_LIST=
 (ADDRESS=(PROTOCOL=tcp)(HOST=CLOUD-VIP1)(PORT=1521) )
 (ADDRESS=(PROTOCOL=tcp)(HOST=CLOUD-VIP2)(PORT=1521) )
 (ADDRESS=(PROTOCOL=tcp)(HOST=CLOUD-VIP3)(PORT=1521) ))
 (CONNECT_DATA=(SERVICE_NAME=GOLD)))
</code></pre><p>The value of these parameters is expressed in seconds. In the preceding examples, Oracle Net waits for 60 seconds for each full connection to receive a response, after which it assumes that a failure occurred and retries the next address in the <code class="codeph">ADDRESS_LIST</code>. Oracle Net retries the address list 3 times before it returns a failure message to the client. The <code class="codeph">TRANSPORT_CONNECT_TIMEOUT</code> parameter establishes the time to wait to establish a TCP connection to the database server.
                     </p>
                     <p>For SCAN, Oracle Net Services tries all three addresses (returned by the SCAN address) before returning a failure to the client. EZConnect with SCAN includes this connection failover feature.</p>
                     <p>This behavior is called Oracle Net <span class="italic">connection failover</span>. If an error is returned from a chosen address in the list, then Oracle Net Services tries the next address in the list until it is either successful or it has exhausted all addresses in its list.
                     </p>
                  </div>
               </div><a id="RACAD8277"></a><div class="sect3"><a id="GUID-5129AD20-E50A-47D4-95D5-99A8DE72294E" name="GUID-5129AD20-E50A-47D4-95D5-99A8DE72294E"></a><h4 id="RACAD-GUID-5129AD20-E50A-47D4-95D5-99A8DE72294E" class="sect4">Client-Side Connection Configuration for Older Clients</h4>
                  <div>
                     <p>In addition to client-side load balancing, Oracle Net Services include <span class="bold">connection failover</span>. If an error is returned from the chosen address in the list, Oracle Net Services tries the next address in the list until it is either successful or it has exhausted all addresses in its list. For SCAN, Oracle Net Services tries all three addresses before returning a failure to the client. EZConnect with SCAN includes this connection failover feature. 
                     </p>
                     <p>To increase availability, you can specify a timeout that specifies how long Oracle Net waits for a response from the listener before returning an error. The method of setting this timeout parameter depends on the type of client access. Oracle Net maintains these parameters for backward compatibility.</p>
                     <p>This section includes the following topics:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="workload-management-with-dynamic-database-services.html#GUID-325F6E12-B60B-4B22-9A8E-96813FCD4601">JDBC-Thin Clients</a></p>
                        </li>
                        <li>
                           <p><a href="workload-management-with-dynamic-database-services.html#GUID-32381119-7046-418A-A992-A18E8E55F316" title="For OCI clients, create a local sqlnet.ora file on the client side.">OCI Clients</a></p>
                        </li>
                     </ul>
                  </div><a id="RACAD8278"></a><div class="sect4"><a id="GUID-325F6E12-B60B-4B22-9A8E-96813FCD4601" name="GUID-325F6E12-B60B-4B22-9A8E-96813FCD4601"></a><h5 id="RACAD-GUID-325F6E12-B60B-4B22-9A8E-96813FCD4601" class="sect5">JDBC-Thin Clients</h5>
                     <div>
                        <p>You can avoid delays by setting the <code class="codeph">oracle.net.ns.SQLnetDef.TCP_CONNTIMEOUT_STR</code> property, as follows:
                        </p><pre class="oac_no_warn" dir="ltr">Properties prop = new Properties ();
prop.put (oracle.net.ns.SQLnetDef.TCP_CONNTIMEOUT_STR,
"" + (1 * 1000)); // 1 second
dbPools[ poolIndex ].setConnectionProperties ( prop );
</pre><p>The parameter value is specified in milliseconds. Therefore, it is possible to reduce the timeout to 500Ms if the application retries connecting.</p>
                     </div>
                  </div><a id="RACAD8279"></a><div class="sect4"><a id="GUID-32381119-7046-418A-A992-A18E8E55F316" name="GUID-32381119-7046-418A-A992-A18E8E55F316"></a><h5 id="RACAD-GUID-32381119-7046-418A-A992-A18E8E55F316" class="sect5">OCI Clients</h5>
                     <div>
                        <p>For OCI clients, create a local <code class="codeph">sqlnet.ora</code> file on the client side.
                        </p>
                        <p>Configure the connection timeout in this file by adding the following line:</p><pre class="pre codeblock"><code>sqlnet.outbound_connect_timeout = <span class="variable" translate="no">number_of_seconds</span></code></pre><p>The granularity of the timeout value for the OCI client is in seconds. The <code class="codeph">sqlnet.ora</code> file affects all connections using this client. 
                        </p>
                        <div class="infoboxnote" id="GUID-32381119-7046-418A-A992-A18E8E55F316__GUID-B3C15BA4-C878-4D99-AE24-6E544E063E03">
                           <p class="notep1">Note:</p>
                           <p>Do <span class="italic">not</span> configure the connection timeout in the <code class="codeph">sqlnet.ora</code> file on the server.
                           </p>
                        </div>
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>Related Topics</strong></p>
                           <ul>
                              <li><a href="../lnoci/instant-client.html#LNOCI-GUID-B3694EC0-637E-434F-A92F-C301CC133CA2" target="_blank"><span><cite>Oracle Call Interface Programmer's Guide</cite></span></a></li>
                           </ul>
                        </div>
                     </div>
                  </div>
               </div><a id="RACAD8275"></a><div class="sect3"><a id="GUID-10F7892A-92DD-482C-8D68-AE80CE956010" name="GUID-10F7892A-92DD-482C-8D68-AE80CE956010"></a><h4 id="RACAD-GUID-10F7892A-92DD-482C-8D68-AE80CE956010" class="sect4">Client-Side Load Balancing</h4>
                  <div>
                     <p>Client-side load balancing is defined in your client connection definition (<code class="codeph">tnsnames.ora</code> file, for example) by setting the parameter <code class="codeph">LOAD_BALANCE=ON</code>. When you set this parameter to <code class="codeph">ON</code>, Oracle Database randomly selects an address in the address list, and connects to that node's listener. This balances client connections across the available SCAN listeners in the cluster.
                     </p>
                     <p>If you configured SCAN for connection requests, then client-side load balancing is not relevant for those clients that support SCAN access. When clients connect using SCAN, Oracle Net automatically balances the load of client connection requests across the three IP addresses you defined for the SCAN, unless you are using EZConnect.</p>
                     <p>The SCAN listener redirects the connection request to the local listener of the instance that is least loaded (if <code class="codeph">-clbgoal</code> is set to <code class="codeph">SHORT</code>) and provides the requested service. When the listener receives the connection request, the listener connects the user to an instance that the listener knows provides the requested service. To see what services a listener supports, run the <code class="codeph">lsnrctl services</code> command.
                     </p>
                     <p>When clients connect using SCAN, Oracle Net automatically load balances client connection requests across the three IP addresses you defined for the SCAN, unless you are using EZConnect.</p>
                     <p>If you are using clients that do not support SCAN (for example, the client version is pre-Oracle Database 11<span class="italic">g</span> release 2 (11.2)), then, to use SCAN you must change the client <code class="codeph">tnsnames.ora</code> to include the SCAN VIPs, and set <code class="codeph">LOAD_BALANCE=ON</code> to balance requests across the VIPs. For example:
                     </p><pre class="pre codeblock"><code>Sales.example.com=(DESCRIPTION=
  (ADDRESS_LIST=(LOAD_BALANCE=ON)(FAILOVER=ON)
    (ADDRESS=(PROTOCOL=TCP)(HOST=172.22.67.192)(PORT=1521))
    (ADDRESS=(PROTOCOL=TCP)(HOST=172.22.67.193)(PORT=1521))
    (ADDRESS=(PROTOCOL=TCP)(HOST=172.22.67.194)(PORT=1521))
    (CONNECT_DATA=(SERVICE_NAME=salesservice.example.com))
  ))</code></pre><div class="infoboxnote" id="GUID-10F7892A-92DD-482C-8D68-AE80CE956010__GUID-4338FFA0-808B-46DF-91DA-67920AF35F6B">
                        <p class="notep1">Note:</p>
                        <p>If your database is not Oracle Database 11<span class="italic">g</span> release 2 (11.2), or later, and you want to use SCAN, then you must add SCAN VIPs to the <code class="codeph">REMOTE_LISTENER</code> parameter to enable correct listener cross-registration.
                        </p>
                     </div>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="../refrn/REMOTE_LISTENER.html#REFRN-GUID-FEE2E8B5-CE02-4158-A6B4-030E59316756" target="_blank"><span><cite>Oracle Database Reference</cite></span></a></li>
                        </ul>
                     </div>
                  </div>
               </div>
            </div><a id="RACAD7302"></a><div class="sect2"><a id="GUID-26E66434-7A68-4B63-B759-3E0A8CA14A8B" name="GUID-26E66434-7A68-4B63-B759-3E0A8CA14A8B"></a><h3 id="RACAD-GUID-26E66434-7A68-4B63-B759-3E0A8CA14A8B" class="sect3">Load Balancing Advisory</h3>
               <div>
                  <p>This section describes the <a id="d17899e1710" class="indexterm-anchor"></a>load balancing advisory under the following topics: 
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="workload-management-with-dynamic-database-services.html#GUID-FD9404EA-65B4-4972-96DF-C81A5DAF2768">Overview of the Load Balancing Advisory</a></p>
                     </li>
                     <li>
                        <p><a href="workload-management-with-dynamic-database-services.html#GUID-BA90E5A3-140D-40BB-97F7-466E994CA3E5" title="You can configure your environment to use the load balancing advisory by defining service-level goals for each service for which you want to enable load balancing.">Configuring Your Environment to Use the Load Balancing Advisory</a></p>
                     </li>
                     <li>
                        <p><a href="workload-management-with-dynamic-database-services.html#GUID-0EF444E4-6EC3-46A9-AF14-307995FEA664" title="The load balancing advisory FAN events provide metrics for load balancing algorithms.">Load Balancing Advisory FAN Events </a></p>
                     </li>
                     <li>
                        <p><a href="workload-management-with-dynamic-database-services.html#GUID-60D61506-EAAD-45D9-BE78-E93158B547FA">Monitoring Load Balancing Advisory FAN Events</a></p>
                     </li>
                  </ul>
               </div><a id="RACAD7303"></a><div class="sect3"><a id="GUID-FD9404EA-65B4-4972-96DF-C81A5DAF2768" name="GUID-FD9404EA-65B4-4972-96DF-C81A5DAF2768"></a><h4 id="RACAD-GUID-FD9404EA-65B4-4972-96DF-C81A5DAF2768" class="sect4">Overview of the Load Balancing Advisory</h4>
                  <div>
                     <p>Load balancing distributes work across all of the available Oracle RAC database instances. Oracle recommends that applications use connection pools with persistent connections that span the instances that offer a particular service. When using persistent connections, connections are created infrequently and exist for a long duration. Work comes into the system with high frequency, borrows these connections, and exists for a relatively short duration. The load balancing advisory provides advice about how to direct incoming work to the instances that provide the optimal quality of service for that work. This minimizes the need to relocate the work later.</p>
                     <p>By using the Load Balancing Advisory and run-time connection load balancing <a id="d17899e1885" class="indexterm-anchor"></a>goals, feedback is built in to the system. Work is routed to provide the best service times globally, and routing responds gracefully to changing system conditions. In a steady state, the system approaches equilibrium with improved throughput across all of the Oracle RAC instances.
                     </p>
                     <p>Standard architectures that can use the load balancing advisory include connection load balancing, transaction processing monitors, application servers, connection concentrators, hardware and software load balancers, job schedulers, batch schedulers, and message queuing systems. All of these applications can allocate work.</p>
                     <p>The <a id="d17899e1894" class="indexterm-anchor"></a>load balancing advisory is deployed with key Oracle clients, such as a listener, the JDBC universal connection pool, OCI session pool, Oracle WebLogic Server Active GridLink for Oracle RAC, and the ODP.NET Connection Pools. Third-party applications can also subscribe to load balancing advisory events by using JDBC and Oracle RAC FAN API or by using callbacks with OCI.
                     </p>
                  </div>
               </div><a id="RACAD7304"></a><div class="sect3"><a id="GUID-BA90E5A3-140D-40BB-97F7-466E994CA3E5" name="GUID-BA90E5A3-140D-40BB-97F7-466E994CA3E5"></a><h4 id="RACAD-GUID-BA90E5A3-140D-40BB-97F7-466E994CA3E5" class="sect4">Configuring Your Environment to Use the Load Balancing Advisory</h4>
                  <div>
                     <p>You can configure your environment to use the load balancing advisory by defining service-level goals for each service for which you want to enable load balancing.</p>
                     <p>Configuring a service-level goal enables the load balancing advisory and the publishing of FAN load balancing events for that service. There are two types of service-level goals for run-time connection load balancing:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><code class="codeph">SERVICE_TIME</code>: Attempts to direct work requests to instances according to response time. Load balancing advisory data is based on elapsed time for work done in the service plus available bandwidth to the service. An example for the use of <code class="codeph">SERVICE_TIME</code> is for workloads such as internet shopping where the rate of demand changes. The following example shows how to set the goal to <code class="codeph">SERVICE_TIME</code> for connections using the <code class="codeph">online</code> service:
                           </p><pre class="pre codeblock"><code>$ srvctl modify service -db <span class="variable" translate="no">db_unique_name</span> -service online
  -rlbgoal SERVICE_TIME -clbgoal SHORT
</code></pre></li>
                        <li>
                           <p><code class="codeph">THROUGHPUT</code>: Attempts to direct work requests according to throughput. The load balancing advisory is based on the rate that work is completed in the service plus available bandwidth to the service. An example for the use of <code class="codeph">THROUGHPUT</code> is for workloads such as batch processes, where the next job starts when the last job completes. The following example shows how to set the goal to <code class="codeph">THROUGHPUT</code> for connections using the <code class="codeph">sjob</code> service:
                           </p><pre class="pre codeblock"><code>$ srvctl modify service -db <span class="variable" translate="no">db_unique_name</span> -service sjob
  -rlbgoal THROUGHPUT -clbgoal LONG</code></pre></li>
                     </ul>
                     <p>Setting the run-time connection load balancing goal to <code class="codeph">NONE</code> disables load balancing for the service. You can see the goal settings for a service in the data dictionary by querying the <code class="codeph">DBA_SERVICES</code>, <code class="codeph">V$SERVICES</code>, and <code class="codeph">V$ACTIVE_SERVICES</code> views. You can also review the load balancing settings for a service using Oracle Enterprise Manager.
                     </p>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="workload-management-with-dynamic-database-services.html#GUID-2678C005-1B70-4B88-90E0-174A324F7DAA" title="When you create and administer services, you are dividing the work that your database performs into manageable units.The Cluster Managed Database Services page is the master page for beginning all tasks related to services.When you create a service using SRVCTL, you must start the service with a separate SRVCTL command.To create a service with SRVCTL, use the srvctl add service command on the command line.To configure services for Application Continuity, when you create a service using SRVCTL, set the -failovertype parameter to TRANSACTION and -commit_outcome to TRUE.">Administering Services</a></li>
                        </ul>
                     </div>
                  </div>
               </div><a id="RACAD7689"></a><a id="RACAD7305"></a><div class="sect3"><a id="GUID-0EF444E4-6EC3-46A9-AF14-307995FEA664" name="GUID-0EF444E4-6EC3-46A9-AF14-307995FEA664"></a><h4 id="RACAD-GUID-0EF444E4-6EC3-46A9-AF14-307995FEA664" class="sect4">Load Balancing Advisory FAN Events </h4>
                  <div>
                     <p>The load balancing advisory FAN events provide metrics for load balancing algorithms.</p>
                     <p>The easiest way to take advantage of these events is to use the run-time connection load balancing feature of an Oracle integrated client such as JDBC, Universal Connection Pool (or the deprecated Implicit Connection Cache), ODP.NET Connection Pools, OCI session pools, or Oracle WebLogic Server Active GridLink for Oracle RAC. Other client applications can take advantage of FAN programatically by using the Oracle RAC FAN API to subscribe to FAN events and execute event-handling actions upon receipt. <a href="workload-management-with-dynamic-database-services.html#GUID-0EF444E4-6EC3-46A9-AF14-307995FEA664__BABHJDGB" title="Event payload parameters and descriptions">Table 5-1</a> describes the load balancing advisory FAN event parameters.
                     </p>
                     <div class="infoboxnotealso" id="GUID-0EF444E4-6EC3-46A9-AF14-307995FEA664__GUID-15217374-F3F9-4572-A486-40A962F99672">
                        <p class="notep1">See Also:</p>
                        <p><span><cite>Oracle Database JDBC Developer’s Guide</cite></span> for more information about the Oracle RAC FAN API
                        </p>
                     </div>
                     <div class="tblformalwide" id="GUID-0EF444E4-6EC3-46A9-AF14-307995FEA664__BABHJDGB">
                        <p class="titleintable">Table 5-1 Load Balancing Advisory FAN Events</p>
                        <table cellpadding="4" cellspacing="0" class="FormalWide" title="Load Balancing Advisory FAN Events" summary="Event payload parameters and descriptions" width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="21%" id="d17899e2304">Parameter</th>
                                 <th align="left" valign="bottom" width="79%" id="d17899e2307">Description</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="21%" id="d17899e2312" headers="d17899e2304 "><pre class="oac_no_warn" dir="ltr">VERSION</pre></td>
                                 <td align="left" valign="top" width="79%" headers="d17899e2312 d17899e2307 ">
                                    <p>Version of the event record. Used to identify release changes. </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="21%" id="d17899e2319" headers="d17899e2304 "><pre class="oac_no_warn" dir="ltr">EVENT_TYPE</pre></td>
                                 <td align="left" valign="top" width="79%" headers="d17899e2319 d17899e2307 ">
                                    <p>A load balancing advisory event is always of the <code class="codeph">SERVICEMETRICS</code> event type.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="21%" id="d17899e2329" headers="d17899e2304 "><pre class="oac_no_warn" dir="ltr">SERVICE</pre></td>
                                 <td align="left" valign="top" width="79%" headers="d17899e2329 d17899e2307 ">
                                    <p>The service name; matches the value of <code class="codeph">NAME</code> in <code class="codeph">DBA_SERVICES</code>.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="21%" id="d17899e2342" headers="d17899e2304 "><pre class="oac_no_warn" dir="ltr">DATABASE</pre></td>
                                 <td align="left" valign="top" width="79%" headers="d17899e2342 d17899e2307 ">
                                    <p>The unique database supporting the service; matches the initialization parameter value for <code class="codeph">DB_UNIQUE_NAME</code>, which defaults to the value of the initialization parameter <code class="codeph">DB_NAME</code>.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="21%" id="d17899e2355" headers="d17899e2304 "><pre class="oac_no_warn" dir="ltr">INSTANCE</pre></td>
                                 <td align="left" valign="top" width="79%" headers="d17899e2355 d17899e2307 ">
                                    <p>The name of the instance that supports the service; matches the <code class="codeph">ORACLE_SID</code> value.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="21%" id="d17899e2365" headers="d17899e2304 "><pre class="oac_no_warn" dir="ltr">PERCENT</pre></td>
                                 <td align="left" valign="top" width="79%" headers="d17899e2365 d17899e2307 ">
                                    <p>The percentage of work requests to send to this database instance.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="21%" id="d17899e2372" headers="d17899e2304 "><pre class="oac_no_warn" dir="ltr">FLAG</pre></td>
                                 <td align="left" valign="top" width="79%" headers="d17899e2372 d17899e2307 ">
                                    <p>Indication of the service quality relative to the service goal. Valid values are <code class="codeph">GOOD</code>, <code class="codeph">VIOLATING</code>, <code class="codeph">NO DATA</code>, and <code class="codeph">BLOCKED</code>. 
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="21%" id="d17899e2391" headers="d17899e2304 "><pre class="oac_no_warn" dir="ltr">TIMESTAMP</pre></td>
                                 <td align="left" valign="top" width="79%" headers="d17899e2391 d17899e2307 ">
                                    <p>The local time zone to use when ordering notification events.</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <div class="infoboxnote" id="GUID-0EF444E4-6EC3-46A9-AF14-307995FEA664__GUID-998C07D5-3D9B-4469-A34C-CF8F6C7A4C4F">
                        <p class="notep1">Note:</p>
                        <p>The <code class="codeph">INSTANCE</code>, <code class="codeph">PERCENT</code>, and <code class="codeph">FLAG</code> event parameters are generated for each instance offering the service. Each set of instance data is enclosed within braces (<code class="codeph">{}</code>).
                        </p>
                     </div>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="../jjdbc/Oracle-RAC-FAN-API.html#JJDBC-GUID-672941ED-9553-4779-B1AD-7FEBC07603D6" target="_blank"><span><cite>Oracle Database JDBC Developer’s Guide</cite></span></a></li>
                        </ul>
                     </div>
                  </div>
               </div><a id="RACAD8281"></a><div class="sect3"><a id="GUID-60D61506-EAAD-45D9-BE78-E93158B547FA" name="GUID-60D61506-EAAD-45D9-BE78-E93158B547FA"></a><h4 id="RACAD-GUID-60D61506-EAAD-45D9-BE78-E93158B547FA" class="sect4">Monitoring Load Balancing Advisory FAN Events</h4>
                  <div>
                     <p>You can use the following query against the internal queue table for load balancing advisory FAN events to monitor load balancing advisory events generated for an instance:</p><pre class="oac_no_warn" dir="ltr">SET PAGES 60 COLSEP '|' LINES 132 NUM 8 VERIFY OFF FEEDBACK OFF
COLUMN user_data HEADING "AQ Service Metrics" FORMAT A60 WRAP
BREAK ON service_name SKIP 1
SELECT
 TO_CHAR(enq_time, 'HH:MI:SS') Enq_time, user_data
 FROM sys.sys$service_metrics_tab
 ORDER BY 1 ;
</pre><p>The results of this query contain rows similar to the following:</p><pre class="oac_no_warn" dir="ltr">02:56:05|SYS$RLBTYP('hr', 'VERSION=1.0 database=sales service=hr
   { {instance=sales_4 percent=38 flag=GOOD aff=TRUE}{instance=sales_1
   percent=62 flag=GOOD aff=TRUE} } timestamp=2012-07-16 07:56:05')
</pre><p>Following is an example of a load balancing advisory event for the <code class="codeph">lba_serv</code> service offered on two instances (<code class="codeph">orcl1</code> and <code class="codeph">orcl2</code>), as captured from Oracle Notification Service using the Oracle RAC FAN API:
                     </p><pre class="oac_no_warn" dir="ltr">Notification Type: database/event/servicemetrics/lba_serv.example.com
   VERSION=1.0 database=orcl service=lba_serv.example.com { {instance=orcl2
   percent=50 flag=UNKNOWN aff=FALSE}{instance=orcl1 percent=50 flag=UNKNOWN
   aff=FALSE} } timestamp=2012-07-06 13:19:12</pre><div class="infoboxnote" id="GUID-60D61506-EAAD-45D9-BE78-E93158B547FA__GUID-80A6B0B5-0FC1-4985-9A19-2C2FB36106B6">
                        <p class="notep1">Note:</p>
                        <p>The <code class="codeph">SERVICMETRICS</code> events are not visible through the FAN callout mechanism.
                        </p>
                     </div>
                  </div>
               </div>
            </div><a id="RACAD7134"></a><div class="sect2"><a id="GUID-074729CB-8A91-419C-A6E1-3B9E4FD8D869" name="GUID-074729CB-8A91-419C-A6E1-3B9E4FD8D869"></a><h3 id="RACAD-GUID-074729CB-8A91-419C-A6E1-3B9E4FD8D869" class="sect3">Enabling Clients for Oracle RAC</h3>
               <div>
                  <p>Oracle has integrated FAN with many of the common <a id="d17899e2726" class="indexterm-anchor"></a>client application environments that are used to connect to Oracle RAC databases. Therefore, the easiest way to use FAN is to use an integrated Oracle Client. 
                  </p>
                  <p>The following sections discuss how FAN is integrated with Oracle Clients and how to enable FAN events for the several specific client development environments:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="workload-management-with-dynamic-database-services.html#GUID-8CA1B780-FC7E-4050-8A11-468D27CBD308" title="The overall goals of FAN are to enable end-to-end, lights-out recovery of applications and load balancing based on real transaction performance.">Overview of Oracle Integrated Clients and FAN</a></p>
                     </li>
                     <li>
                        <p><a href="workload-management-with-dynamic-database-services.html#GUID-EE246927-2883-44EC-80F6-A3FCB019624E" title="Enabling Fast Connection Failover (FCF) for Universal Connection Pool and Oracle WebLogic Server Active GridLink for Oracle RAC enables the use of FAN HA and load balancing advisory events.">Enabling JDBC-Thin Clients for Fast Connection Failover</a></p>
                     </li>
                     <li>
                        <p><a href="workload-management-with-dynamic-database-services.html#GUID-C3061DB8-C974-4734-98EB-EDED23B79423" title="Run-time connection load balancing requires the use of an Oracle JDBC driver and an Oracle RAC database.">Enabling JDBC Clients for Run-time Connection Load Balancing</a></p>
                     </li>
                     <li>
                        <p><a href="workload-management-with-dynamic-database-services.html#GUID-CBD1ABAA-34B4-4486-BB8B-111BDA7FE44A" title="The Replay data source (oracle.jdbc.replay.OracleDataSource) is a JDBC-thin data source that Application Continuity requires for Java.">Configuring JDBC-Thin Clients for Application Continuity for Java</a></p>
                     </li>
                     <li>
                        <p><a href="workload-management-with-dynamic-database-services.html#GUID-F94A5DDE-4E87-4C6B-9DBB-1702E706B2D9" title="Transaction Guard provides a protocol and a generic tool for applications to use for at-most-once execution in case of planned and unplanned outages.">Configuring JDBC-Thin Clients for Transaction Guard</a></p>
                     </li>
                     <li>
                        <p><a href="workload-management-with-dynamic-database-services.html#GUID-C9BDC6E3-16A6-4175-8B0B-E15DFD07466E">Enabling OCI Clients for Fast Connection Failover</a></p>
                     </li>
                     <li>
                        <p><a href="workload-management-with-dynamic-database-services.html#GUID-AEEE07D0-057A-4617-A716-9957D98B593D" title="As of Oracle Database 12c, OCI session pooling enables multiple threads of an application to use a dynamically managed set of pre-created database sessions.">Enabling OCI Clients for Run-time Connection Load Balancing</a></p>
                     </li>
                     <li>
                        <p><a href="workload-management-with-dynamic-database-services.html#GUID-DDD78F92-BC57-472A-9729-CEFDBFB32142" title="OCI supports FAN messages and Transaction Guard. FAN is designed to quickly notify an OCI-based application of outages at the node, database, instance, service, and public network levels.">Configuring OCI Clients to use Transaction Guard</a></p>
                     </li>
                     <li>
                        <p><a href="workload-management-with-dynamic-database-services.html#GUID-1A7346B1-AFE3-4B17-AD7E-E35FE628CDF9" title="ODP.NET connection pools can subscribe to FAN HA notifications that indicate when nodes, services, and service members are down.">Enabling ODP.NET Clients to Receive FAN High Availability Events</a></p>
                     </li>
                     <li>
                        <p><a href="workload-management-with-dynamic-database-services.html#GUID-D779F756-F8EA-4BEF-8A54-94395B6B9AF6" title="When connecting to Oracle Database 12c and later, ODP.NET uses Oracle Notification Service, rather than Advanced Queuing.">Enabling ODP.NET Clients to Receive FAN Load Balancing Advisory Events</a></p>
                     </li>
                     <li>
                        <p><a href="workload-management-with-dynamic-database-services.html#GUID-34DB264E-3210-4C79-A104-AE0AAF269CDF" title="ODP.NET supports FAN messages and Transaction Guard. FAN is designed to quickly notify an ODP.NET-based application of outages at the node, database, instance, service, and public network levels.">Configuring ODP.NET Clients to use Transaction Guard</a></p>
                     </li>
                  </ul>
               </div><a id="RACAD8282"></a><div class="sect3"><a id="GUID-8CA1B780-FC7E-4050-8A11-468D27CBD308" name="GUID-8CA1B780-FC7E-4050-8A11-468D27CBD308"></a><h4 id="RACAD-GUID-8CA1B780-FC7E-4050-8A11-468D27CBD308" class="sect4">Overview of Oracle Integrated Clients and FAN</h4>
                  <div>
                     <p>The overall goals of FAN are to enable end-to-end, lights-out recovery of applications and load balancing based on real transaction performance.</p>
                     <p>Applications use the FAN high availability (HA) events to achieve very fast detection of failures, balancing of connection pools following failures, and distribution of connections again when the failed components are repaired.</p>
                     <p>The FAN events carrying load balancing advice help connection pools consistently deliver connections to available instances that provide the best service. FAN HA is integrated with the JDBC-thin and OCI drivers. FAN HA and FAN load balancing are both integrated with the JDBC Universal Connection Pool (and the deprecated Implicit Connection Cache), the OCI session pools, the ODP.NET connection pool, and Oracle WebLogic Server Active GridLink for Oracle RAC.</p>
                     <p>Due to the integration with FAN, Oracle integrated clients are more aware of the current status of an Oracle RAC cluster. This prevents client connections from waiting or trying to connect to instances or services that are no longer available. When instances start, Oracle RAC uses FAN to notify the connection pool so that the connection pool can create connections to the recently started instance and take advantage of the additional resources that this instance provides.</p>
                     <p>Oracle client drivers that are integrated with FAN can:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Remove terminated connections immediately when a service is declared <code class="codeph">DOWN</code> at an instance, and immediately when nodes are declared <code class="codeph">DOWN</code></p>
                        </li>
                        <li>
                           <p>Report errors to clients immediately when Oracle Database detects the <code class="codeph">NOT RESTARTING</code> state, instead of making the client wait while the service repeatedly attempts to restart
                           </p>
                        </li>
                     </ul>
                     <p>Oracle connection pools that are integrated with FAN can: </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Balance connections across all of the Oracle RAC instances when a service starts; this is preferable to directing the sessions that are defined for the connection pool to the first Oracle RAC instance that supports the service</p>
                        </li>
                        <li>
                           <p>Balance work requests at run time using load balancing advisory events</p>
                        </li>
                     </ul>
                     <p>The use of client drivers or connection pools and FAN requires that you properly configure the Oracle Notification Service to deliver the FAN events to the clients. In addition, for load balancing, configure database connection load balancing across all of the instances that provide the services used by the connection pool. Oracle recommends that you configure both client-side and server-side load balancing with Oracle Net Services. If you use DBCA to create your database, then both client-side and server-side load balancing are configured by default.</p>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="workload-management-with-dynamic-database-services.html#GUID-095B67FB-3E3A-44BE-84A4-321174015A08" title="Oracle Net Services provides the ability to distribute client connections across the instances in an Oracle RAC configuration.">Connection Load Balancing</a></li>
                        </ul>
                     </div>
                  </div>
               </div><a id="RACAD7135"></a><div class="sect3"><a id="GUID-EE246927-2883-44EC-80F6-A3FCB019624E" name="GUID-EE246927-2883-44EC-80F6-A3FCB019624E"></a><h4 id="RACAD-GUID-EE246927-2883-44EC-80F6-A3FCB019624E" class="sect4">Enabling JDBC-Thin Clients for Fast Connection Failover</h4>
                  <div>
                     <p>Enabling Fast Connection Failover (FCF) for Universal Connection Pool and Oracle WebLogic Server Active GridLink for Oracle RAC enables the use of FAN HA and load balancing advisory events.</p>
                     <p>For Universal Connection Pool to use FAN, your application can use the JDBC development environment for either JDBC OCI or JDBC Thin clients. The Java Database Connectivity Oracle Call Interface (JDBC/OCI) driver connection pooling functionality is part of the JDBC-thin client. This functionality is provided by the <code class="codeph">OracleOCIConnectionPool</code> class.
                     </p>
                     <p>To enable FCF for the JDBC-thin client, call the method <code class="codeph">setFastConnectionFailoverEnabled(true)</code> of the <code class="codeph">OracleDataSource</code> class in the <code class="codeph">oracle.jdbc.pool</code> package before making the first <code class="codeph">getConnection()</code> request. When you enable FCF for the JDBC-thin client, the failover property applies to every connection in the connection pool. Enabling FCF with JDBC-thin driver or JDBC/OCI clients enables the connection pool to receive and react to all FAN events.
                     </p>
                     <p>JDBC application developers can programmatically integrate with FAN by using a set of APIs introduced in Oracle Database 11<span class="italic">g</span> release 2 (11.2). The Oracle RAC FAN APIs enable application code to receive and respond to FAN event notifications sent by Oracle RAC in the following ways:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Listening for Oracle RAC service down, service up, and node down events</p>
                        </li>
                        <li>
                           <p>Listening for load balancing advisory events and responding to them</p>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="../jjdbc/Oracle-RAC-FAN-API.html#JJDBC-GUID-672941ED-9553-4779-B1AD-7FEBC07603D6" target="_blank"><span><cite>Oracle Database JDBC Developer’s Guide</cite></span></a></li>
                        </ul>
                     </div>
                  </div><a id="RACAD8283"></a><div class="sect4"><a id="GUID-E242A789-7118-45CD-82C8-2CB52248C47F" name="GUID-E242A789-7118-45CD-82C8-2CB52248C47F"></a><h5 id="RACAD-GUID-E242A789-7118-45CD-82C8-2CB52248C47F" class="sect5">Oracle Notification Service for JDBC-Thin Clients</h5>
                     <div>
                        <p><a id="d17899e3374" class="indexterm-anchor"></a>FCF relies on Oracle Notification Service to propagate database events between the connection pool and the Oracle RAC database. At run time, the connection pool must be able to setup an Oracle Notification Service environment. Oracle Notification Service (<code class="codeph">ons.jar</code>) is included as part of the Oracle Client software. Oracle Notification Service can be configured using either remote configuration or client-side Oracle Notification Service daemon configuration. Remote Oracle Notification Service subscription offers the following advantages:
                        </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Support for an All Java mid-tier software</p>
                           </li>
                           <li>
                              <p>An Oracle Notification Service daemon is not necessary on the client system, so you do not have to manage this process</p>
                           </li>
                           <li>
                              <p>Simple configuration by way of a <code class="codeph">DataSource</code> property
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div><a id="RACAD7306"></a><div class="sect4"><a id="GUID-5396E213-81D5-45AA-84C0-FA74D9CD24A4" name="GUID-5396E213-81D5-45AA-84C0-FA74D9CD24A4"></a><h5 id="RACAD-GUID-5396E213-81D5-45AA-84C0-FA74D9CD24A4" class="sect5">Configuring FCF for JDBC/OCI and JDBC-Thin Driver Clients</h5>
                     <div>
                        <p>You can enable FCF for Universal Connection Pool or Implicit Connection Cache.</p>
                        <p>Oracle recommends using the Universal Connection Pool for Java because the Implicit Connection Cache is deprecated. You can also use Oracle WebLogic Server Active GridLink for Oracle RAC.</p>
                        <p>This procedure explains how to enable FCF for JDBC. For JDBC/OCI clients, if you enable FCF, then do not use the method used with Oracle Database 11<span class="italic">g</span> release 2 (11.2) of enabling FAN for OCI clients (setting <code class="codeph">notification</code> to TRUE on the service), and do not configure TAF, either on the client or for the service. You can also configure Application Continuity and Transaction Guard.
                        </p>
                        <p>To enable FCF, you must first enable the Universal Connection Pool, as described in the following procedure:</p>
                        <ol>
                           <li>
                              <p>Create the connection pool and set <code class="codeph">setFastConnectionFailoverEnabled(true)</code>.
                              </p>
                              <p>The following example creates a connection pool and enables FCF. The <code class="codeph">ucp.jar</code> library must be included in the classpath of an application to use this example.
                              </p><pre class="pre codeblock"><code>PoolDataSource pds = PoolDataSourceFactory.getPoolDataSource();
pds.setFastConnectionFailoverEnabled(true);</code></pre></li>
                           <li>
                              <p>Determine the ports to use for Oracle Notification Service remote subscriptions.</p>
                              <p>Use the following command to view the Oracle Notification Service configuration on each node that is running Oracle Clusterware as in the following example:</p><pre class="pre codeblock"><code>srvctl config nodeapps -onsonly</code></pre><p>The output of this command lists the local and remote ports configured for Oracle Notification Service.</p>
                              <div class="infoboxnote" id="GUID-5396E213-81D5-45AA-84C0-FA74D9CD24A4__GUID-821ABBEB-2C02-47FF-95CC-46C1B94BE1D7">
                                 <p class="notep1">Note:</p>
                                 <p>Oracle Notification Service configuration should have been automatically completed during the Oracle Clusterware installation. </p>
                              </div>
                           </li>
                           <li>
                              <p>Configure the remote Oracle Notification Service subscription. </p>
                              <p>When using the Universal Connection Pool, an application calls <code class="codeph">setONSConfiguration</code> for an <code class="codeph">OracleDataSource</code> instance and specifies the nodes and port numbers to use. The port numbers used for each node are the same as the remote port displayed for each node in Step 2, as shown in the following example. The <code class="codeph">ons.jar</code> library must be included in the classpath of an application to use this example.
                              </p><pre class="pre codeblock"><code>pds.setONSConfiguration("nodes=racnode1:6200,racnode2:6200");</code></pre><p>Applications that use remote Oracle Notification Service configuration must set the <code class="codeph">oracle.ons.oraclehome</code> system property to the location of <code class="codeph">ORACLE_HOME</code> before starting the application, for example:
                              </p><pre class="pre codeblock"><code>java -Doracle.ons.oraclehome=$ORACLE_HOME ...</code></pre></li>
                           <li>
                              <p>Configure the connection URL.</p>
                              <p>A connection factory's connection URL must use the service name syntax when using FCF. The service name is used to map the connection pool to the service. The following example demonstrates configuring the connection URL:</p><pre class="pre codeblock"><code>pds.setConnectionFactoryClassName("oracle.jdbc.pool.OracleDataSource");
pds.setURL("jdbc:oracle:thin@//<span class="variable" translate="no">SCAN_name</span>:<span class="variable" translate="no">service_name</span>");...</code></pre></li>
                        </ol>
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>Related Topics</strong></p>
                           <ul>
                              <li><a href="../jjdbc/introducing-JDBC.html#JJDBC-GUID-864DB502-5E50-4044-8132-33D6AAF8927A" target="_blank"><span><cite>Oracle Database JDBC Developer’s Guide</cite></span></a></li>
                              <li><a href="../jjucp/fast-connection-failover.html#JJUCP-GUID-126F8C9B-C0B3-426B-B07D-4B127BBDD867" target="_blank"><span><cite>Oracle Universal Connection Pool Developer’s Guide</cite></span></a></li>
                           </ul>
                        </div>
                     </div>
                  </div>
               </div><a id="RACAD8284"></a><div class="sect3"><a id="GUID-C3061DB8-C974-4734-98EB-EDED23B79423" name="GUID-C3061DB8-C974-4734-98EB-EDED23B79423"></a><h4 id="RACAD-GUID-C3061DB8-C974-4734-98EB-EDED23B79423" class="sect4">Enabling JDBC Clients for Run-time Connection Load Balancing</h4>
                  <div>
                     <p>Run-time connection load balancing requires the use of an Oracle JDBC driver and an Oracle RAC database.</p>
                     <p>Oracle JDBC Universal Connection Pool and Oracle WebLogic Server Active GridLink for Oracle RAC leverage the load balancing functionality provided by an Oracle RAC database.</p>
                     <p>The Universal Connection Pool and Oracle WebLogic Server Active GridLink for Oracle RAC are integrated to take advantage of Load Balancing Advisory information. Oracle introduced the Universal Connection Pool for JDBC in Oracle Database 11<span class="italic">g</span> release 11.1.0.7.0. Consequently, Oracle deprecated the existing JDBC connection pool, the Implicit Connection Cache, which was introduced in Oracle Database 10<span class="italic">g</span> release 1 for use with Oracle RAC databases. In addition to Oracle Database 12<span class="italic">c</span>, you can also use the Universal Connection Pool with Oracle Database 10<span class="italic">g</span> or Oracle Database 11<span class="italic">g</span>.
                     </p>
                     <p>Run-time connection load balancing requires that FCF is enabled and configured properly. In addition, the Oracle RAC load balancing advisory must be configured with service-level goals for each service used by the connection pool. The connection load balancing goal should be set to <code class="codeph">SHORT</code>, for example:
                     </p><pre class="pre codeblock"><code>srvctl modify service -db <span class="variable" translate="no">db_unique_name</span> -service <span class="variable" translate="no">service_name</span>
   -rlbgoal SERVICE_TIME -clbgoal SHORT</code></pre></div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="workload-management-with-dynamic-database-services.html#GUID-5396E213-81D5-45AA-84C0-FA74D9CD24A4" title="You can enable FCF for Universal Connection Pool or Implicit Connection Cache.">Configuring FCF for JDBC/OCI and JDBC-Thin Driver Clients</a></li>
                           <li><a href="../jjucp/fast-connection-failover.html#JJUCP-GUID-126F8C9B-C0B3-426B-B07D-4B127BBDD867" target="_blank"><span><cite>Oracle Universal Connection Pool Developer’s Guide</cite></span></a></li>
                        </ul>
                     </div>
                  </div>
               </div><a id="RACAD8430"></a><a id="RACAD8429"></a><div class="sect3"><a id="GUID-CBD1ABAA-34B4-4486-BB8B-111BDA7FE44A" name="GUID-CBD1ABAA-34B4-4486-BB8B-111BDA7FE44A"></a><h4 id="RACAD-GUID-CBD1ABAA-34B4-4486-BB8B-111BDA7FE44A" class="sect4">Configuring JDBC-Thin Clients for Application Continuity for Java</h4>
                  <div>
                     <p>The Replay data source (<code class="codeph">oracle.jdbc.replay.OracleDataSource</code>) is a JDBC-thin data source that Application Continuity requires for Java.
                     </p>
                     <p>This data source serves as the connection factory that produces new physical JDBC connections, for both Universal Connection Pool and Oracle WebLogic Server Active GridLink for Oracle RAC data sources. The JDBC replay driver maintains a history of calls during a client conversation with Oracle Database 12<span class="italic">c</span>, in collaboration with Oracle Database. Following any outage of the session caused by a loss of database service, planned or unplanned, under the direction of the database, the JDBC replay driver attempts to rebuild the non-transactional and transactional database session states, so that the outage appears as a delayed execution.
                     </p>
                     <p>To use Application Continuity for Java and the JDBC replay driver, you must use an Oracle Database 12<span class="italic">c</span> client and connect to an Oracle Database 12<span class="italic">c</span> database. Application Continuity for Java is supported in the following configurations:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>JDBC applications using Oracle JDBC Replay data source and using neither Universal Connection Pool or Oracle WebLogic Server Active GridLink—typical third-party, JDBC-based connection pools</p>
                        </li>
                        <li>
                           <p>JDBC applications using Universal Connection Pool data sources—standalone or third-party application servers configured to use a Universal Connection Pool data source</p>
                        </li>
                        <li>
                           <p>JDBC applications using only Oracle WebLogic Server Active GridLink but not Universal Connection Pool data sources—typical Oracle WebLogic Server J2EE cases</p>
                        </li>
                     </ul>
                     <div class="section">
                        <p class="subhead3" id="GUID-CBD1ABAA-34B4-4486-BB8B-111BDA7FE44A__GUID-3FA235E0-CC7B-4491-8A35-654CBAFE41A4">To configure JDBC-thin clients to use the JDBC Replay Driver:</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li>
                           <p>Ensure that you are using an application that is certified for replay.</p>
                        </li>
                        <li>
                           <p>Use SRVCTL to create a service for use by the application, if one does not already exist. Set the <code class="codeph">-failovertype</code> parameter to <code class="codeph">TRANSACTION</code> and the <code class="codeph">-commit_outcome</code> parameter to <code class="codeph">TRUE</code> for this service.
                           </p>
                        </li>
                        <li>
                           <p>Configure the connection element using the <code class="codeph">PoolDataSource</code> object, as shown in the following example:
                           </p><pre class="pre codeblock"><code>PoolDataSource rds = PoolDataSourceFactory.getPoolDataSource();
rds.setConnnectionPoolName("replayExample");
rds.setONSConfiguration("nodes=racnode1:4200,racnode2:4200");
rds.setFastConnectionFailoverEnabled(true);
rds.setConnectionFactoryClassName("oracle.jdbc.replay.OracleDataSourceImpl");

Connection conn = rds.getConnection();</code></pre></li>
                        <li>
                           <p>When connecting to the database, use a URL that can access all instances offering the service.</p>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="ensuring-application-continuity.html#GUID-BD699AEB-9F85-42A8-8687-5A979918938D" title="Application Continuity masks many recoverable database outages (when replay is successful) from applications and users by restoring the database session: the full session, including all states, cursors, variables, and the last transaction if there is one.">About Application Continuity</a></li>
                           <li><a href="workload-management-with-dynamic-database-services.html#GUID-87EDF90F-1776-474A-AD9C-93F9CBE6CB31" title="To configure services for Application Continuity, when you create a service using SRVCTL, set the -failovertype parameter to TRANSACTION and -commit_outcome to TRUE.">Creating Services for Application Continuity and Transaction Guard</a></li>
                           <li><a href="workload-management-with-dynamic-database-services.html#GUID-5396E213-81D5-45AA-84C0-FA74D9CD24A4" title="You can enable FCF for Universal Connection Pool or Implicit Connection Cache.">Configuring FCF for JDBC/OCI and JDBC-Thin Driver Clients</a></li>
                           <li><a href="../jjdbc/application-continuity.html#JJDBC-GUID-AAC6F9B7-9B4C-4098-B0D5-312BF9A13928" target="_blank"><span><cite>Oracle Database JDBC Developer’s Guide</cite></span></a></li>
                           <li><a href="../jjucp/intro.html#JJUCP-GUID-82ACD002-4C5F-4BF7-99FF-46A2A97DD35D" target="_blank"><span><cite>Oracle Universal Connection Pool Developer’s Guide</cite></span></a></li>
                        </ul>
                     </div>
                     <div class="infoboxnotealso" id="GUID-CBD1ABAA-34B4-4486-BB8B-111BDA7FE44A__GUID-39DCAB9F-6154-477F-8B2B-B74B7C1082B1">
                        <p class="notep1">See Also:</p>
                        <p><span><cite>Oracle Database JDBC Developer’s Guide</cite></span> for information about configuring Transaction Guard without enabling Application Continuity
                        </p>
                     </div>
                  </div>
               </div><a id="RACAD8431"></a><div class="sect3"><a id="GUID-F94A5DDE-4E87-4C6B-9DBB-1702E706B2D9" name="GUID-F94A5DDE-4E87-4C6B-9DBB-1702E706B2D9"></a><h4 id="RACAD-GUID-F94A5DDE-4E87-4C6B-9DBB-1702E706B2D9" class="sect4">Configuring JDBC-Thin Clients for Transaction Guard</h4>
                  <div>
                     <p>Transaction Guard provides a protocol and a generic tool for applications to use for at-most-once execution in case of planned and unplanned outages.</p>
                     <p>Applications use the logical transaction ID to determine the outcome of the last transaction open in a database session following an outage. Without Transaction Guard, end users or applications that attempt to retry operations following outages can cause logical corruption by committing duplicate transactions or committing transactions out of order.</p>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="../jjdbc/application-continuity.html#JJDBC-GUID-AAC6F9B7-9B4C-4098-B0D5-312BF9A13928" target="_blank"><span><cite>Oracle Database JDBC Developer’s Guide</cite></span></a></li>
                           <li><a href="../adfns/transaction-guard.html#ADFNS-GUID-6C5880E5-C45F-4858-A069-A28BB25FD1DB" target="_blank"><span><cite>Oracle Database Development Guide</cite></span></a></li>
                           <li><a href="../lnoci/high-availability-in-oci.html#LNOCI-GUID-6A12DE3A-479A-4D06-8305-AA450BFF6B23" target="_blank"><span><cite>Oracle Call Interface Programmer's Guide</cite></span></a></li>
                        </ul>
                     </div>
                  </div>
               </div><a id="RACAD8285"></a><a id="RACAD7307"></a><div class="sect3"><a id="GUID-C9BDC6E3-16A6-4175-8B0B-E15DFD07466E" name="GUID-C9BDC6E3-16A6-4175-8B0B-E15DFD07466E"></a><h4 id="RACAD-GUID-C9BDC6E3-16A6-4175-8B0B-E15DFD07466E" class="sect4">Enabling OCI Clients for Fast Connection Failover</h4>
                  <div>
                     <p> OCI clients can enable FCF by registering to receive notifications for Oracle RAC high availability FAN events and responding when events occur. Using FCF improves the session failover response time in OCI applications and also removes connections to nonfunctioning instances from connection and session pools. FCF can be used in OCI applications that also use TAF, OCI drivers (including your own connection pools), OCI connection pool, and OCI session pools. FAN is posted over the Oracle Notification Service for both high availability and load balancing events.</p>
                     <p>To use FCF, you must use a service with FAN enabled. FAN is published over Oracle Notification Service. Client applications can also register callbacks that are used whenever an event occurs. This reduces the time that it takes to detect a connection failure.</p>
                     <p>During <code class="codeph">DOWN</code> event processing, OCI:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Terminates affected connections at the client and returns an error</p>
                        </li>
                        <li>
                           <p>Removes connections from the OCI connection pool and the OCI session pool—the session pool maps each session to a physical connection in the connection pool, and there can be multiple sessions for each connection</p>
                        </li>
                        <li>
                           <p>Fails over the connection if you have configured TAF. If TAF is not configured, then the client only receives an error if the instance it is connected to fails.</p>
                        </li>
                     </ul>
                     <p>If your application is using TAF, then you must enable the TAF properties for the service using SRVCTL or Oracle Enterprise Manager. Configure your OCI client applications to connect to an Oracle RAC database using the configured service. </p>
                     <div class="infoboxnote" id="GUID-C9BDC6E3-16A6-4175-8B0B-E15DFD07466E__GUID-6B4A007E-FDF1-4DCC-8912-8E083A22E1E0">
                        <p class="notep1">Note:</p>
                        <p>OCI does not manage <code class="codeph">UP</code> events. 
                        </p>
                     </div>
                     <div class="section">
                        <p class="subhead3" id="GUID-C9BDC6E3-16A6-4175-8B0B-E15DFD07466E__GUID-B1EE69A9-A88A-469E-8761-E7348390F0EC">Configuring FCF for OCI Clients</p>
                     </div>
                     <!-- class="section" -->
                     <p>OCI applications must connect to an Oracle RAC instance to enable HA event notification. Furthermore, these applications must perform the following steps to configure FCF for an OCI client:</p>
                     <ol>
                        <li>
                           <p>Configure the service for your OCI connection pool to enable FAN, connection load balancing, and run-time connection load balancing, as shown in the following example:</p><pre class="pre codeblock"><code>$ srvctl modify service -db crm -service ociapp.example.com -notification TRUE</code></pre></li>
                        <li>
                           <p>Link the application with a thread library.</p>
                        </li>
                        <li>
                           <p>After linking with the thread library, the applications can register a callback that is invoked whenever a FAN event occurs.</p>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="../netag/enabling-advanced-features.html#NETAG-GUID-8F532535-C401-4B51-BE0B-04FD74BB0621" target="_blank"><span><cite>Oracle Database Net Services Administrator's Guide</cite></span></a></li>
                           <li><a href="../lnoci/introduction.html#LNOCI-GUID-27645179-6957-4004-8BB8-38775266B038" target="_blank"><span><cite>Oracle Call Interface Programmer's Guide</cite></span></a></li>
                        </ul>
                     </div>
                  </div>
               </div><a id="RACAD8286"></a><a id="RACAD7308"></a><div class="sect3"><a id="GUID-AEEE07D0-057A-4617-A716-9957D98B593D" name="GUID-AEEE07D0-057A-4617-A716-9957D98B593D"></a><h4 id="RACAD-GUID-AEEE07D0-057A-4617-A716-9957D98B593D" class="sect4">Enabling OCI Clients for Run-time Connection Load Balancing</h4>
                  <div>
                     <p>As of Oracle Database 12<span class="italic">c</span>, OCI session pooling enables multiple threads of an application to use a dynamically managed set of pre-created database sessions.
                     </p>
                     <p>In connection pooling, the pool element is a connection, but in session pooling, the pool element is a session. Oracle Database continually reuses the sessions in the session pool to form nearly permanent channels to the instances, thus saving the overhead of creating and closing sessions every time applications need them.</p>
                     <p>Run-time connection load balancing is enabled by default in an Oracle Database 11<span class="italic">g</span> release 11.1, or later, client communicating with a server of Oracle Database 10<span class="italic">g</span> release 10.2, or later. For Oracle RAC environments, session pools use service metrics received from the Oracle RAC load balancing advisory<a id="fn_1" name="fn_1" href="#fn_1" onclick="footdisplay(1, "Run-time connection load balancing is basically routing work requests to sessions in a session pool that can best serve the work. It comes into effect when selecting a session from an existing session pool. Thus, run-time connection load balancing is a very frequent activity.")"><sup>Foot&nbsp;1</sup></a> through Fast Application Notification (FAN) events to balance application session requests. The work requests coming into the session pool can be distributed across the instances of Oracle RAC offering a service, using the current service performance.
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-AEEE07D0-057A-4617-A716-9957D98B593D__GUID-E1920701-C318-4A73-94A4-78B0A170D60A">Configuring OCI Clients to Receive Load Balancing Advisory FAN Events</p>
                     </div>
                     <!-- class="section" -->
                     <p>For Oracle RAC environments, session pools use service metrics received from the Oracle RAC load balancing advisory through Fast Application Notification (FAN) events to balance application session requests. To enable your application to receive the service metrics based on the service time, ensure that you configure FAN, the load balancing advisory goal (<code class="codeph">-rlbgoal</code> parameter), and the connection load balancing goal (<code class="codeph">-clbgoal</code> parameter) for a service that is used by the session pool, as shown in the following example:
                     </p><pre class="pre codeblock"><code>$ srvctl modify service -db crm -service ociapp.example.com -rlbgoal SERVICE_TIME
  -clbgoal SHORT -notification TRUE</code></pre></div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="../lnoci/introduction.html#LNOCI-GUID-27645179-6957-4004-8BB8-38775266B038" target="_blank"><span><cite>Oracle Call Interface Programmer's Guide</cite></span></a></li>
                        </ul>
                     </div>
                  </div>
               </div><a id="RACAD8432"></a><div class="sect3"><a id="GUID-DDD78F92-BC57-472A-9729-CEFDBFB32142" name="GUID-DDD78F92-BC57-472A-9729-CEFDBFB32142"></a><h4 id="RACAD-GUID-DDD78F92-BC57-472A-9729-CEFDBFB32142" class="sect4">Configuring OCI Clients to use Transaction Guard</h4>
                  <div>
                     <p>OCI supports FAN messages and Transaction Guard. FAN is designed to quickly notify an OCI-based application of outages at the node, database, instance, service, and public network levels.</p>
                     <p>Once notified of the failure, an application can leverage Transaction Guard to reliably determine the outcome of the last in-flight transaction.</p>
                     <p>Transaction Guard avoids the costs of ambiguous errors that lead to user frustration, customer support calls, and lost opportunities. Transaction Guard is safer and performs better, with lower overheads, than home grown solutions for a known outcome.</p>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="ensuring-application-continuity.html#GUID-EB0E1525-D3B3-469C-BE22-A569C76864A6" title="The Oracle RAC high availability framework monitors a database and its services and sends event notifications using Fast Application Notification (FAN).">Fast Application Notification</a></li>
                           <li><a href="workload-management-with-dynamic-database-services.html#GUID-074729CB-8A91-419C-A6E1-3B9E4FD8D869" title="The overall goals of FAN are to enable end-to-end, lights-out recovery of applications and load balancing based on real transaction performance.Enabling Fast Connection Failover (FCF) for Universal Connection Pool and Oracle WebLogic Server Active GridLink for Oracle RAC enables the use of FAN HA and load balancing advisory events.You can enable FCF for Universal Connection Pool or Implicit Connection Cache.Run-time connection load balancing requires the use of an Oracle JDBC driver and an Oracle RAC database.The Replay data source (oracle.jdbc.replay.OracleDataSource) is a JDBC-thin data source that Application Continuity requires for Java.Transaction Guard provides a protocol and a generic tool for applications to use for at-most-once execution in case of planned and unplanned outages.As of Oracle Database 12c, OCI session pooling enables multiple threads of an application to use a dynamically managed set of pre-created database sessions.OCI supports FAN messages and Transaction Guard. FAN is designed to quickly notify an OCI-based application of outages at the node, database, instance, service, and public network levels.ODP.NET connection pools can subscribe to FAN HA notifications that indicate when nodes, services, and service members are down.When connecting to Oracle Database 12c and later, ODP.NET uses Oracle Notification Service, rather than Advanced Queuing.ODP.NET supports FAN messages and Transaction Guard. FAN is designed to quickly notify an ODP.NET-based application of outages at the node, database, instance, service, and public network levels.">Enabling Clients for Oracle RAC</a></li>
                           <li><a href="../lnoci/user-defined-callback-functions.html#LNOCI-GUID-215B52BB-6769-4A53-A2DC-EDB36AE031B7" target="_blank"><span><cite>Oracle Call Interface Programmer's Guide</cite></span></a></li>
                        </ul>
                     </div>
                  </div>
               </div><a id="RACAD7136"></a><div class="sect3"><a id="GUID-1A7346B1-AFE3-4B17-AD7E-E35FE628CDF9" name="GUID-1A7346B1-AFE3-4B17-AD7E-E35FE628CDF9"></a><h4 id="RACAD-GUID-1A7346B1-AFE3-4B17-AD7E-E35FE628CDF9" class="sect4">Enabling ODP.NET Clients to Receive FAN High Availability Events</h4>
                  <div>
                     <p>ODP.NET connection pools can subscribe to FAN HA notifications that indicate when nodes, services, and service members are down.</p>
                     <p>After a <code class="codeph">DOWN</code> event, Oracle Database cleans up sessions in the connection pool that go to the instance and ODP.NET proactively removes connections that are no longer valid. ODP.NET establishes additional connections to existing Oracle RAC instances if the removal of invalid connections reduces the total number of connections to below the value for the <code class="codeph">Min Pool Size</code> parameter.
                     </p>
                     <p>When connecting to Oracle Database 12<span class="italic">c</span> and later, ODP.NET uses Oracle Notification Service, rather than Advanced Queuing.
                     </p>
                     <p>Enable Fast Connection Failover for ODP.NET connection pools by subscribing to FAN high availability events. To enable Fast Connection Failover, include "<code class="codeph">HA Events=true</code>" and "<code class="codeph">pooling=true</code>" (the default value) in the connection string, as shown in the following example where <code class="codeph"><span class="variable" translate="no">user_name</span></code> is the name of the database user and <code class="codeph"><span class="variable" translate="no">password</span></code> is the password for that user:
                     </p><pre class="pre codeblock"><code>con.ConnectionString =
   "User Id=<span class="variable" translate="no">user_name</span>;Password=<span class="variable" translate="no">password</span>;Data Source=odpnet;" +
   "Min Pool Size=10;Connection Lifetime=120;Connection Timeout=60;" +
   "HA Events=true;Incr Pool Size=5;Decr Pool Size=2";</code></pre></div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/racad&amp;id=ODPNT-GUID-0CFEB161-68EF-4BC2-8943-3BDFFB878602" target="_blank"><span><cite>Oracle Data Provider for .NET Developer's Guide for Microsoft Windows</cite></span></a></li>
                        </ul>
                     </div>
                  </div>
               </div><a id="RACAD7309"></a><div class="sect3"><a id="GUID-D779F756-F8EA-4BEF-8A54-94395B6B9AF6" name="GUID-D779F756-F8EA-4BEF-8A54-94395B6B9AF6"></a><h4 id="RACAD-GUID-D779F756-F8EA-4BEF-8A54-94395B6B9AF6" class="sect4">Enabling ODP.NET Clients to Receive FAN Load Balancing Advisory Events</h4>
                  <div>
                     <p>When connecting to Oracle Database 12<span class="italic">c</span> and later, ODP.NET uses Oracle Notification Service, rather than Advanced Queuing.
                     </p>
                     <p>Use the following procedure to enable ODP.NET clients or applications to receive FAN load balancing advisory events:</p>
                     <ol>
                        <li>
                           <p>Enable Oracle Notification Service notifications by using SRVCTL, and set the run-time load balancing goal, as shown in the following example:</p><pre class="pre codeblock"><code>$ srvctl modify service -db crm -service odpapp.example.com
  -notification TRUE -clbgoal LONG -rlbgoal SERVICE_TIME</code></pre></li>
                        <li>
                           <p>Ensure Oracle Notification Service (ONS) is configured for FAN events including run-time load balancing advice.</p>
                        </li>
                        <li>
                           <p>To take advantage of load balancing events with ODP.NET connection pools, set the load balancing attribute in the ConnectionString to <code class="codeph">TRUE</code> (the default is <code class="codeph">FALSE</code>). You can do this at connect time. This only works if you are using connection pools, or when the pooling attribute is set to <code class="codeph">TRUE</code> which is the default.
                           </p>
                           <p>The following example demonstrates how to configure the ConnectionString to enable load balancing, where <code class="codeph"><span class="variable" translate="no">user_name</span></code> is the name of the user and <code class="codeph"><span class="variable" translate="no">password</span></code> is the password:
                           </p><pre class="pre codeblock"><code>con.ConnectionString =
  "User Id=<span class="variable" translate="no">user_name</span>;Password=<span class="variable" translate="no">password</span>;Data Source=odpapp;" +
  "Min Pool Size=10;Connection Lifetime=120;Connection Timeout=60;" +
  "Load Balancing=true;Incr Pool Size=5;Decr Pool Size=2";</code></pre></li>
                     </ol>
                     <div class="infoboxnote" id="GUID-D779F756-F8EA-4BEF-8A54-94395B6B9AF6__GUID-E7E2658B-F504-433F-855C-B4B9489AC09A">
                        <p class="notep1">Note:</p>
                        <p>ODP.NET does not support connection redistribution when a node starts (UP events). However, if you have enabled failover on the server-side, then ODP.NET can migrate connections to newly available instances.</p>
                     </div>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="server-control-utility-reference.html#GUID-DCA45A3F-78AD-4259-A8C3-8FCE49A0F4BC" title="Modifies service configuration.">srvctl modify service</a></li>
                           <li><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/racad&amp;id=ODPNT-GUID-0CFEB161-68EF-4BC2-8943-3BDFFB878602" target="_blank"><span><cite>Oracle Data Provider for .NET Developer's Guide for Microsoft Windows</cite></span></a></li>
                        </ul>
                     </div>
                  </div>
               </div><a id="RACAD8434"></a><div class="sect3"><a id="GUID-34DB264E-3210-4C79-A104-AE0AAF269CDF" name="GUID-34DB264E-3210-4C79-A104-AE0AAF269CDF"></a><h4 id="RACAD-GUID-34DB264E-3210-4C79-A104-AE0AAF269CDF" class="sect4">Configuring ODP.NET Clients to use Transaction Guard</h4>
                  <div>
                     <p>ODP.NET supports FAN messages and Transaction Guard. FAN is designed to quickly notify an ODP.NET-based application of outages at the node, database, instance, service, and public network levels.</p>
                     <p>Once notified of the failure, an application can leverage Transaction Guard to reliably determine the outcome of the last in-flight transaction.</p>
                     <p>Transaction Guard avoids the costs of ambiguous errors that lead to user frustration, customer support calls, and lost opportunities. Transaction Guard is safer and performs better, with lower overheads, than home grown solutions for a known outcome.</p>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="ensuring-application-continuity.html#GUID-EB0E1525-D3B3-469C-BE22-A569C76864A6" title="The Oracle RAC high availability framework monitors a database and its services and sends event notifications using Fast Application Notification (FAN).">Fast Application Notification</a></li>
                           <li><a href="workload-management-with-dynamic-database-services.html#GUID-2678C005-1B70-4B88-90E0-174A324F7DAA" title="When you create and administer services, you are dividing the work that your database performs into manageable units.The Cluster Managed Database Services page is the master page for beginning all tasks related to services.When you create a service using SRVCTL, you must start the service with a separate SRVCTL command.To create a service with SRVCTL, use the srvctl add service command on the command line.To configure services for Application Continuity, when you create a service using SRVCTL, set the -failovertype parameter to TRANSACTION and -commit_outcome to TRUE.">Administering Services</a></li>
                           <li><a href="workload-management-with-dynamic-database-services.html#GUID-87EDF90F-1776-474A-AD9C-93F9CBE6CB31" title="To configure services for Application Continuity, when you create a service using SRVCTL, set the -failovertype parameter to TRANSACTION and -commit_outcome to TRUE.">Creating Services for Application Continuity and Transaction Guard</a></li>
                           <li><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/racad&amp;id=ODPNT-GUID-635BAE6C-7D0B-4CF2-ADD8-8DB531B9C52E" target="_blank"><span><cite>Oracle Data Provider for .NET Developer's Guide for Microsoft Windows</cite></span></a></li>
                        </ul>
                     </div>
                  </div>
               </div>
            </div><a id="RACAD7147"></a><div class="sect2"><a id="GUID-7948E56B-D455-4852-A3EF-20E4F59156A5" name="GUID-7948E56B-D455-4852-A3EF-20E4F59156A5"></a><h3 id="RACAD-GUID-7948E56B-D455-4852-A3EF-20E4F59156A5" class="sect3">Distributed Transaction Processing in Oracle RAC</h3>
               <div>
                  <p></p>
                  <p>The X/Open Distributed Transaction Processing (DTP) architecture defines a standard architecture or interface that enables multiple application programs (APs) to share resources provided by multiple, and possibly different, resource managers (RMs). It coordinates the work between APs and RMs into global transactions.</p>
                  <p>The following sections discuss how Oracle RAC supports global (XA) transactions and DTP processing:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="workload-management-with-dynamic-database-services.html#GUID-73F9A0B6-E8E9-4759-8452-BB38615A5877" title="A global (XA) transaction can span Oracle RAC instances by default, allowing any application that uses the Oracle XA library to take full advantage of the Oracle RAC environment to enhance the availability and scalability of the application.">Overview of XA Transactions and Oracle RAC</a></p>
                     </li>
                     <li>
                        <p><a href="workload-management-with-dynamic-database-services.html#GUID-CA948449-B4E1-40C0-80A4-1CE7827E5295" title="To provide improved application performance with distributed transaction processing (DTP) in Oracle RAC, you can take advantage of XA affinity.">Using Global Transactions and XA Affinity for XA Transactions</a></p>
                     </li>
                     <li>
                        <p><a href="workload-management-with-dynamic-database-services.html#GUID-31769276-FE2C-4331-B2F5-D4A4D77434F5" title="Most applications using XA on Oracle RAC can use uniform or (all preferred) services with XA affinity provided by the connection pool or transaction processing monitor.">Using Services with XA Transactions on Oracle RAC</a></p>
                     </li>
                     <li>
                        <p><a href="workload-management-with-dynamic-database-services.html#GUID-7A9D0A41-015F-4830-9BBA-73CD06596059">Configuring Services for XA Applications</a></p>
                     </li>
                     <li>
                        <p><a href="workload-management-with-dynamic-database-services.html#GUID-26060D52-5988-4272-84B2-73E63D0469D1" title="Beginning with Oracle Real Application Clusters 11g release 1 (11.1), global transactions and XA affinity replace the need for distributed transaction processing (DTP) services.">Relocating Services in Administrator-Managed Databases</a></p>
                     </li>
                  </ul>
               </div><a id="RACAD8287"></a><div class="sect3"><a id="GUID-73F9A0B6-E8E9-4759-8452-BB38615A5877" name="GUID-73F9A0B6-E8E9-4759-8452-BB38615A5877"></a><h4 id="RACAD-GUID-73F9A0B6-E8E9-4759-8452-BB38615A5877" class="sect4">Overview of XA Transactions and Oracle RAC</h4>
                  <div>
                     <p>A global (XA) transaction can span Oracle RAC instances by default, allowing any application that uses the Oracle XA library to take full advantage of the Oracle RAC environment to enhance the availability and scalability of the application.</p>
                     <p>GTX<span class="italic">n</span> background processes support XA transactions in an Oracle RAC environment. The <code class="codeph">GLOBAL_TXN_PROCESSES</code> initialization parameter, which is set to <code class="codeph">1</code> by default, specifies the initial number of GTX<span class="italic">n</span> background processes for each Oracle RAC instance. Use the default value for this parameter clusterwide to allow distributed transactions to span multiple Oracle RAC instances. Using the default value allows the units of work performed across these Oracle RAC instances to share resources and act as a single transaction (that is, the units of work are <span class="italic">tightly coupled</span>). It also allows 2PC requests to be sent to any node in the cluster.
                     </p>
                     <p>Before Oracle RAC 11<span class="italic">g</span> release 1 (11.1), the way to achieve tight coupling in Oracle RAC was to use distributed transaction processing (DTP) services, that is, services whose cardinality (one) ensured that all tightly-coupled branches landed on the same instance—regardless of whether load balancing was enabled. If the XA application does not use suspend and resume on the same transaction branch, and does not issue savepoints that span branches, then tightly coupled XA transactions no longer require the special type of singleton services to be deployed on Oracle RAC databases. If your application cannot determine whether a transaction branch has been suspended and resumed, then the application must continue to use DTP services or preferably use XA affinity.
                     </p>
                     <p>XA affinity (placing all branches of the same XA transaction at the same Oracle RAC instance) is a requirement when suspending and resuming the same XA branch or if using savepoints across branches. It also provides much better performance because different transactions can be balanced. XA affinity is available with Oracle WebLogic Server Active GridLink for Oracle RAC, JDBC Universal Connection Pool, and Oracle Tuxedo.</p>
                     <div class="infoboxnote" id="GUID-73F9A0B6-E8E9-4759-8452-BB38615A5877__GUID-7C3BC022-3A4B-4AA2-8543-615A55144E3B">
                        <p class="notep1">Note:</p>
                        <p>Occasionally, transaction processing monitors continue to require either XA affinity or DTP services because the applications that use them suspend and resume the same branch or use save points.</p>
                     </div>
                     <p>An external transaction manager, such as Oracle Services for Microsoft Transaction Server (OraMTS), coordinates XA transactions. However, an internal Oracle transaction manager coordinates distributed SQL transactions. They can both use singleton services or uniform services. Singleton services provide XA affinity and can be drained for maintenance, taking advantage of global transactions.</p>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="workload-management-with-dynamic-database-services.html#GUID-CA948449-B4E1-40C0-80A4-1CE7827E5295" title="To provide improved application performance with distributed transaction processing (DTP) in Oracle RAC, you can take advantage of XA affinity.">Using Global Transactions and XA Affinity for XA Transactions</a></li>
                           <li><a href="../refrn/GLOBAL_TXN_PROCESSES.html#REFRN-GUID-EDBA5E11-C2FB-4370-9CDC-A098D3951C7E" target="_blank"><span><cite>Oracle Database Reference</cite></span></a></li>
                        </ul>
                     </div>
                  </div>
               </div><a id="RACAD8288"></a><div class="sect3"><a id="GUID-CA948449-B4E1-40C0-80A4-1CE7827E5295" name="GUID-CA948449-B4E1-40C0-80A4-1CE7827E5295"></a><h4 id="RACAD-GUID-CA948449-B4E1-40C0-80A4-1CE7827E5295" class="sect4">Using Global Transactions and XA Affinity for XA Transactions</h4>
                  <div>
                     <p>To provide improved application performance with distributed transaction processing (DTP) in Oracle RAC, you can take advantage of XA affinity.</p>
                     <p>Using XA affinity, you can direct all branches of a distributed transaction to a single instance in the cluster. To implement XA affinity you can use an application server that provides XA affinity, such as WebLogic Server and Universal Connection Pool. If your application server does not have XA affinity, then you can also use singleton services across Oracle RAC.</p>
                     <p>Connection pools at the application server tier that load balance across multiple connections to an Oracle RAC database use XA affinity to ensure that all tightly-coupled branches of a global distributed transaction run on only one Oracle RAC instance. When using a connection pool with XA affinity, your services using XA can span Oracle RAC. This is also true in distributed transaction environments using protocols such as X/Open Distributed Transaction Processing or the Microsoft Distributed Transaction Coordinator.</p>
                     <p>To enhance the performance of distributed transactions, you use services to manage DTP environments. A singleton service runs on one Oracle RAC instance at time in an Oracle RAC database. This service still allows draining for maintenance, so has better high-availability characteristics than an older DTP service. To load balance across the cluster, it is better to have several groups of smaller application servers with each group directing its transactions to a single service, or set of services, than it is to have one or two larger application servers. Using singleton services, global distributed transactions performed through the services have their tightly-coupled branches running on a single Oracle RAC instance. This has the following benefits:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>The changes are available locally within one Oracle RAC instance when tightly coupled branches need information about changes made by each other</p>
                        </li>
                        <li>
                           <p>Relocation and failover of services are fully supported using global transactions</p>
                        </li>
                        <li>
                           <p>By using more singleton services than there are Oracle RAC instances, Oracle Database can balance the load by services across all of the Oracle RAC database instances</p>
                        </li>
                     </ul>
                     <div class="infoboxnote" id="GUID-CA948449-B4E1-40C0-80A4-1CE7827E5295__GUID-D698C726-C61D-426F-8794-6AC0A396A89F">
                        <p class="notep1">Note:</p>The DTP service attribute or XA affinity is required, if the application suspend and resumes the same XA branch.
                     </div>
                  </div>
               </div><a id="RACAD8289"></a><div class="sect3"><a id="GUID-31769276-FE2C-4331-B2F5-D4A4D77434F5" name="GUID-31769276-FE2C-4331-B2F5-D4A4D77434F5"></a><h4 id="RACAD-GUID-31769276-FE2C-4331-B2F5-D4A4D77434F5" class="sect4">Using Services with XA Transactions on Oracle RAC</h4>
                  <div>
                     <p>Most applications using XA on Oracle RAC can use uniform or (all preferred) services with XA affinity provided by the connection pool or transaction processing monitor.</p>
                     <p>The application may also use singleton services to provide XA affinity.</p>
                     <p>When using singleton services, to leverage all of the instances in a cluster, create one or more singleton services for each Oracle RAC instance that hosts distributed transactions. Choose different services for application servers to balance the workload among the Oracle RAC database instances. Because all of the branches of a distributed transaction are on one instance, you can leverage all of the instances to balance the load of many distributed transaction processing (DTP) transactions through multiple singleton services, thereby maximizing application throughput.</p>
                     <p>If you add or delete nodes from your cluster database, then you may have to identify and relocate services to ensure that you maintain optimum performance levels. Using singleton services, current work can complete. If you use DTP services, then current work is aborted.</p>
                     <p>You only need to use DTP services for XA applications that suspend and resume the same branch. When you are using DTP, the same approach applies as that for singletons, but you cannot drain the work when relocating services.</p>
                  </div>
               </div><a id="RACAD969"></a><div class="sect3"><a id="GUID-7A9D0A41-015F-4830-9BBA-73CD06596059" name="GUID-7A9D0A41-015F-4830-9BBA-73CD06596059"></a><h4 id="RACAD-GUID-7A9D0A41-015F-4830-9BBA-73CD06596059" class="sect4">Configuring Services for XA Applications</h4>
                  <div>
                     <p>To create distributed transaction processing (DTP) services for distributed transaction processing, perform the following steps:</p>
                     <ol>
                        <li>
                           <p>Create a singleton service using Oracle Enterprise Manager or SRVCTL.</p>
                           <p>For an administrator-managed database, define only one instance as the preferred instance. You can have as many available instances as you want, for example: </p><pre class="pre codeblock"><code>$ srvctl add service -db crm -service xa_01.example.com -preferred RAC01
  -available RAC02,RAC03</code></pre><p>For a policy-managed database, specify the server pool to use, and set the cardinality of the service to <code class="codeph">SINGLETON</code>, for example:
                           </p><pre class="pre codeblock"><code>$ srvctl add service -db crm -service xa_01.example.com -serverpool dtp_pool
  -cardinality SINGLETON</code></pre></li>
                        <li>
                           <p>Set the DTP parameter (<code class="codeph">-dtp</code>) for the service to <code class="codeph">TRUE</code> (the default value is <code class="codeph">FALSE)</code>. You can use Oracle Enterprise Manager or SRVCTL to modify the DTP property of the singleton service. The following example shows how to modify the <code class="codeph">xa_01.example.com</code> service using SRVCTL:
                           </p><pre class="pre codeblock"><code>$ srvctl modify service -db crm -service xa_01.example.com -dtp TRUE</code></pre><div class="infoboxnote" id="GUID-7A9D0A41-015F-4830-9BBA-73CD06596059__GUID-1643B33E-550D-4789-9CA1-1CB6B20595C3">
                              <p class="notep1">Note:</p>If the application does require DTP services, then use the <code class="codeph">-dtp</code> parameter. If not, then use the preceding example with no <code class="codeph">-dtp</code> parameter.
                           </div>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="server-control-utility-reference.html#GUID-EC1BA6D7-D538-4E11-9B31-C59389FDF93B" title="Adds services to a database and assigns them to instances.">srvctl add service</a></li>
                           <li><a href="server-control-utility-reference.html#GUID-DCA45A3F-78AD-4259-A8C3-8FCE49A0F4BC" title="Modifies service configuration.">srvctl modify service</a></li>
                        </ul>
                     </div>
                  </div>
               </div><a id="RACAD8290"></a><div class="sect3"><a id="GUID-26060D52-5988-4272-84B2-73E63D0469D1" name="GUID-26060D52-5988-4272-84B2-73E63D0469D1"></a><h4 id="RACAD-GUID-26060D52-5988-4272-84B2-73E63D0469D1" class="sect4">Relocating Services in Administrator-Managed Databases</h4>
                  <div>
                     <p>Beginning with Oracle Real Application Clusters 11<span class="italic">g</span> release 1 (11.1), global transactions and XA affinity replace the need for distributed transaction processing (DTP) services.
                     </p>
                     <p>Most XA deployments should be using global transactions with XA affinity for improved load balancing and flexibility rather than the DTP attribute.</p>
                     <p>If the instance that provides a DTP service, for example <code class="codeph">XA_01</code>, fails, then the service fails over in the same manner as any other service. Because there is a requirement that sessions exist on exactly one instance, however, the <code class="codeph">-f</code> (force kill) option for database sessions always applies.
                     </p>
                     <p>If services migrate to other instances, then you might have to force the relocation of the service back to the preferred instance after it is restarted to evenly re-balance the load on all of the available hardware. You can use data from the <code class="codeph">GV$ACTIVE_SERVICES</code> view to determine whether you need to relocate the DTP service.
                     </p>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-1100990E-18BD-4C92-A0C7-3C08C40AAD14" name="GUID-1100990E-18BD-4C92-A0C7-3C08C40AAD14"></a><h3 id="RACAD-GUID-1100990E-18BD-4C92-A0C7-3C08C40AAD14" class="sect3">Oracle RAC Sharding</h3>
               <div>
                  <p>Oracle RAC Sharding creates an affinity between table partitions and Oracle RAC instances, and routes database requests that specify a partitioning key to the instance that logically holds the corresponding partition.</p>
                  <p>Oracle routes database requests to Oracle RAC instances in such a way that each instance always gets requests for a disjoint subset of rows in the database, which creates affinity of rows with instances. The affinity leads to higher Oracle RAC performance and scalability because of improved cache locality and reduced inter-node synchronization and block pings.</p>
                  <p>Sharding for Oracle RAC affinity uses client and server-side support for key-based routing, which is part of the Oracle Database sharding. An application that supplies a sharding key in the database using the same API implemented for sharding support in Oracle connection pools (such as Universal Connection Pool, OCI), in the same way it is done for sharding, utilizes key-based routing and, by doing so, enables Oracle RAC affinity. </p>
                  <div class="p">Application changes that are required to supply the sharding key, do not have to affect all modules of the application. Changes can only be applied to a few frequently executed database requests. Requests that do not provide the sharding key in the connect string are routed based on the load-balancing policy. Keyless requests do not have any negative impact on data affinity because of the explicit mastership assignment of data objects to instances.
                     <div class="infoboxnote" id="GUID-1100990E-18BD-4C92-A0C7-3C08C40AAD14__GUID-DBCCD176-1C04-49B5-8CDF-BC6EE2359FE2">
                        <p class="notep1">Note:</p>Oracle only supports Oracle RAC affinity for partitioned tables. You can partition a table using any supported method without making changes to the database schema to enable this feature and then run the <code class="codeph">ALTER SYSTEM ENABLE AFFINITY</code> command.
                     </div>
                  </div>
                  <p>If you want to make changes to your applications to take advantage of affinity-enabling routing, then you may also take advantage of sharding when data is distributed across multiple independent databases. You can later move to distributed sharding if you require extreme scalability or fault isolation.</p>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="../sqlrf/ALTER-SYSTEM.html#SQLRF-GUID-2C638517-D73A-41CA-9D8E-A62D1A0B7ADB" target="_blank"><span><cite>Oracle Database SQL Language Reference</cite></span></a></li>
                        <li><a href="../netag/optimizing-performance.html#NETAG-GUID-5EC77A57-1DD5-49E7-85E6-5ABE57B18803" target="_blank"><span><cite>Oracle Database Net Services Administrator's Guide</cite></span></a></li>
                        <li><a href="../shard/sharding-overview.html#SHARD-GUID-3D41F762-BE04-486D-8018-C7A210D809F9" target="_blank"><span><cite>Using Oracle Sharding</cite></span></a></li>
                        <li><a href="../jjdbc/database-sharding.html#JJDBC-GUID-1D7795CA-79DC-452B-9FCC-0EF430F87461" target="_blank"><span><cite>Oracle Database JDBC Developer’s Guide</cite></span></a></li>
                        <li><a href="../lnoci/oci-interface-for-using-shards.html#LNOCI-GUID-C64136C2-CF65-4507-8811-9A03946CC817" target="_blank"><span><cite>Oracle Call Interface Programmer's Guide</cite></span></a></li>
                     </ul>
                  </div>
               </div>
            </div><a id="RACAD951"></a><div class="sect2"><a id="GUID-C3CD2DCE-38BD-46BA-BC32-7A28CAC9A7FD" name="GUID-C3CD2DCE-38BD-46BA-BC32-7A28CAC9A7FD"></a><h3 id="RACAD-GUID-C3CD2DCE-38BD-46BA-BC32-7A28CAC9A7FD" class="sect3">Automatic Workload Repository</h3>
               <div>
                  <p>The Automatic Workload Repository (AWR) collects, processes, and maintains performance statistics for the database.</p>
                  <p>The gathered data can be displayed in both reports and views. If you use services with your database, then AWR tracks <a href="glossary.html#GUID-3C591280-F8D5-4979-8134-152C2DF66F2F"><span class="xrefglossterm">metric</span></a>s at the service level.
                  </p>
                  <p>Metrics can be measured against a variety of units, including time, transactions, or database calls. For example, the number of database calls per second is a metric. Server generated alerts can be placed on these metrics when they exceed or fail to meet user-specified thresholds. The database or system administrator can then respond, for example, by:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Using the Oracle Database Resource Manager to configure the service level for one service to have priorities relative to other services</p>
                     </li>
                     <li>
                        <p>Stopping overloaded processes</p>
                     </li>
                     <li>
                        <p>Modifying a service level requirement</p>
                     </li>
                     <li>
                        <p>Implementing recovery scenarios in response to service quality changes</p>
                     </li>
                  </ul>
                  <p>Using AWR metrics and performance alerts enables you to maintain continued service availability despite service level changes. It also enables you to measure the quality of service provided by the database services.</p>
                  <p>The AWR ensures that the Oracle Clusterware workload management framework and the database resource manager have persistent and global representations of performance data. This information helps Oracle Database schedule job classes by service and to assign priorities to consumer groups. If necessary, you can rebalance workloads manually with either Oracle Enterprise Manager or SRVCTL. You can also disconnect a series of sessions, but leave the service running.</p>
                  <div class="infoboxnote" id="GUID-C3CD2DCE-38BD-46BA-BC32-7A28CAC9A7FD__GUID-16934B29-63E3-4194-B497-6657487299B5">
                     <p class="notep1">Note:</p>
                     <p>Oracle <span class="italic">does not</span> recommend using the DBMS_SERVICE package for use with services used by an Oracle RAC database. Use SRVCTL or Oracle Enterprise Manager to create database services for Oracle RAC.
                     </p>
                  </div>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="../tdppt/resolving-performance-degradation-over-time.html#TDPPT-GUID-2831079F-326B-4F10-8B4F-D90DC0FDE270" target="_blank"><span><cite>Oracle Database 2 Day + Performance Tuning Guide</cite></span></a></li>
                        <li><a href="../tgdba/comparing-database-performance-over-time.html#TGDBA-GUID-BEDBF986-1A69-459A-90F5-350B8A407516" target="_blank"><span><cite>Oracle Database Performance Tuning Guide</cite></span></a></li>
                        <li><a href="../arpls/DBMS_SERVICE.html#ARPLS-GUID-C11449DC-EEDE-4BB8-9D2C-0A45198C1928" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a></li>
                     </ul>
                  </div>
               </div>
            </div><a id="RACAD7127"></a><div class="sect2"><a id="GUID-559FB230-857B-4D97-B36A-F4F76C3A1D47" name="GUID-559FB230-857B-4D97-B36A-F4F76C3A1D47"></a><h3 id="RACAD-GUID-559FB230-857B-4D97-B36A-F4F76C3A1D47" class="sect3">Measuring Performance by Service Using the Automatic Workload Repository</h3>
               <div>
                  <p>Services add a new dimension for performance tuning because workloads are visible and measurable, and therefore resource consumption and wait times are attributable by application.</p>
                  <p>Tuning by using "service and SQL" replaces tuning by "session and SQL" in the majority of systems where all sessions are anonymous and shared.</p>
                  <p>The AWR maintains performance statistics that include information about response time, throughput, resource consumption, and wait events for all services and work that a database performs. Oracle Database also maintains metrics, statistics, wait events, wait classes, and SQL-level traces for services. You can optionally augment these statistics by defining modules within your application to monitor certain statistics. You can also define the actions within those modules that business critical transactions should execute in response to particular statistical values. </p>
                  <p>Enable module and action monitoring using the <code class="codeph">DBMS_MONITOR																	</code> PL/SQL package. For example, for connections that use the <code class="codeph">erp</code> service, the following command enables monitoring for the <code class="codeph">exceptions pay</code> action in the <code class="codeph">payroll</code> module:
                  </p><pre class="pre codeblock"><code>EXECUTE DBMS_MONITOR.SERV_MOD_ACT_STAT_ENABLE(SERVICE_NAME =&gt; 'ERP', 
   MODULE_NAME=&gt; 'PAYROLL', ACTION_NAME =&gt; 'EXCEPTIONS PAY');</code></pre><p>For connections that use the <code class="codeph">erp</code> service, the following command enables monitoring for all actions in the <code class="codeph">payroll</code> module:
                  </p><pre class="pre codeblock"><code>EXECUTE DBMS_MONITOR.SERV_MOD_ACT_STAT_ENABLE(SERVICE_NAME =&gt; 'ERP', 
   MODULE_NAME=&gt; 'PAYROLL', ACTION_NAME =&gt; NULL);</code></pre><p>Use the <code class="codeph">DBA_ENABLED_AGGREGATIONS</code> view to verify that you have enabled monitoring for application modules and actions.
                  </p>
                  <p>Statistics aggregation and tracing by service are global in scope for Oracle RAC databases. In addition, these statistic aggregations are persistent across instance restarts and service relocations for both Oracle RAC and noncluster Oracle databases.</p>
                  <p>The service, module, and action names are visible in <code class="codeph">V$SESSION</code>, <code class="codeph">V$ACTIVE_SESSION_HISTORY</code>, and <code class="codeph">V$SQL</code> views. The call times and performance statistics are visible in <code class="codeph">V$SERVICE_STATS</code>, <code class="codeph">V$SERVICE_EVENT</code>, <code class="codeph">V$SERVICE_WAIT_CLASS</code>, <code class="codeph">V$SERVICEMETRIC</code>, and <code class="codeph">V$SERVICEMETRIC_HISTORY</code>. When you enable statistics collection for an important transaction, you can see the call speed for each service, module, and action name at each database instance using the <code class="codeph">V$SERV_MOD_ACT_STATS</code> view. 
                  </p>
                  <p>The following sample SQL*Plus script provides service quality statistics for a five second interval. You can use these service quality statistics to monitor the quality of a service, to direct work, and to balance services across Oracle RAC instances:</p><pre class="pre codeblock"><code>SET PAGESIZE 60 COLSEP '|' NUMWIDTH 8 LINESIZE 132 VERIFY OFF FEEDBACK OFF
COLUMN service_name FORMAT A20 TRUNCATED HEADING 'Service'
COLUMN begin_time HEADING 'Begin Time' FORMAT A10
COLUMN end_time HEADING 'End Time' FORMAT A10
COLUMN instance_name HEADING 'Instance' FORMAT A10
COLUMN service_time HEADING 'Service Time|mSec/Call' FORMAT 999999999
COLUMN throughput HEADING 'Calls/sec'FORMAT 99.99 
BREAK ON service_name SKIP 1 
SELECT 
    service_name 
  , TO_CHAR(begin_time, 'HH:MI:SS') begin_time 
  , TO_CHAR(end_time, 'HH:MI:SS') end_time 
  , instance_name 
  , elapsedpercall  service_time
  ,  callspersec  throughput
FROM  
    gv$instance i     
  , gv$active_services s     
  , gv$servicemetric m 
WHERE s.inst_id = m.inst_id  
  AND s.name_hash = m.service_name_hash
  AND i.inst_id = m.inst_id
  AND m.group_id = 10
ORDER BY
   service_name
 , i.inst_id
 , begin_time ;</code></pre></div>
            </div><a id="RACAD7317"></a><div class="sect2"><a id="GUID-27E6E869-570C-4B01-BF49-C147744D0D7D" name="GUID-27E6E869-570C-4B01-BF49-C147744D0D7D"></a><h3 id="RACAD-GUID-27E6E869-570C-4B01-BF49-C147744D0D7D" class="sect3">Automatic Workload Repository Service Thresholds and Alerts</h3>
               <div>
                  <p>Service level <a id="d17899e7404" class="indexterm-anchor"></a><a id="d17899e7408" class="indexterm-anchor"></a>thresholds enable you to compare actual service levels against required levels of service. This provides accountability for the delivery or the failure to deliver an agreed service level. The end goal is a predictable system that achieves service levels. There is no requirement to perform as fast as possible with minimum resource consumption; the requirement is to meet the <span class="italic">quality</span> of service.
                  </p>
                  <p>AWR enables you to explicitly specify two performance thresholds for each service: the response time for calls (<code class="codeph">ELAPSED_TIME_PER_CALL</code>), and the CPU time for calls (<code class="codeph">CPU_TIME_PER_CALL</code>). The response time threshold indicates that the elapsed time for each user call for each service should not exceed a certain value, and the CPU time for calls threshold indicates that the time spent using the CPU for each call for each service should not exceed a certain value. Response time is a fundamental measure that reflects all delays and faults that might be blocking the call from running on behalf of the user. Response time can also indicate differences in node power across the nodes of an Oracle RAC database.
                  </p>
                  <p>You must set these thresholds on each instance of an Oracle RAC database. The elapsed time and CPU time are calculated as the moving average of the elapsed, server-side call time. The AWR monitors the elapsed time and CPU time and publishes AWR alerts when the performance exceeds the thresholds. You can schedule actions using <a id="d17899e7426" class="indexterm-anchor"></a>Oracle Enterprise Manager jobs for these alerts, or you can schedule actions to occur programmatically when the alert is received. You can respond to these alerts by changing the priority of a job, stopping overloaded processes, or by relocating, starting or stopping a service. This permits you to maintain service availability despite changes in demand.
                  </p>
                  <p>This section includes the following topics:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="workload-management-with-dynamic-database-services.html#GUID-CD8F12F3-E1B5-4E97-8443-414A651E1991">Example of Services and Thresholds Alerts </a></p>
                     </li>
                     <li>
                        <p><a href="workload-management-with-dynamic-database-services.html#GUID-11C4EEF9-CC32-42A5-B8FD-C8E41C8D2BFA">Enable Service_ Module_ and Action Monitoring</a></p>
                     </li>
                  </ul>
               </div><a id="RACAD7318"></a><div class="sect3"><a id="GUID-CD8F12F3-E1B5-4E97-8443-414A651E1991" name="GUID-CD8F12F3-E1B5-4E97-8443-414A651E1991"></a><h4 id="RACAD-GUID-CD8F12F3-E1B5-4E97-8443-414A651E1991" class="sect4">Example of Services and Thresholds Alerts </h4>
                  <div>
                     <p>In this scenario, you need to check the thresholds for the payroll service. You can use the AWR report to get this information. You should compare the results from reports run over several successive intervals during which time the system is running optimally. For example, assume that for servers accessed by a payroll application, the AWR report runs each Thursday during the peak usage times of 1:00 p.m. to 5:00 p.m. The AWR report contains the response time, or elapsed database time, and the CPU consumption time, or CPU time, for calls for each server, including the <code class="codeph">payroll</code> service. The AWR report also provides a breakdown of the work done and the wait times that are contributing to the response times. 
                     </p>
                     <p>Using <code class="codeph">DBMS_MONITOR</code>, you set a warning threshold for the elapsed time per call for the <code class="codeph">payroll</code> service at 0.5 seconds (500000 microseconds). You also set a critical threshold for the elapsed time per call for the <code class="codeph">payroll</code> service at 0.75 seconds (750000 microseconds). 
                     </p>
                     <p>In this example, thresholds are added for the <code class="codeph">payroll</code> service as follows: 
                     </p><pre class="oac_no_warn" dir="ltr">EXECUTE DBMS_SERVER_ALERT.SET_THRESHOLD( 
METRICS_ID =&gt; DBMS_SERVER_ALERT.ELAPSED_TIME_PER_CALL 
, warning_operator =&gt; DBMS_SERVER_ALERT.OPERATOR_GE 
, warning_value =&gt; '500000' 
, critical_operator =&gt; DBMS_SERVER_ALERT.OPERATOR_GE 
, critical_value =&gt; '750000' 
, observation_period =&gt; 30 
, consecutive_occurrences =&gt; 5 
, instance_name =&gt; NULL 
, object_type =&gt; DBMS_SERVER_ALERT.OBJECT_TYPE_SERVICE 
, object_name =&gt; 'payroll');
</pre><p>You can verify the threshold configuration is set on all the instances using the following <code class="codeph">SELECT</code> statement: 
                     </p><pre class="oac_no_warn" dir="ltr">SELECT METRICS_NAME, INSTANCE_NAME, WARNING_VALUE, CRITICAL_VALUE, 
OBSERVATION_PERIOD FROM dba_thresholds ;</pre></div>
               </div><a id="RACAD7319"></a><div class="sect3"><a id="GUID-11C4EEF9-CC32-42A5-B8FD-C8E41C8D2BFA" name="GUID-11C4EEF9-CC32-42A5-B8FD-C8E41C8D2BFA"></a><h4 id="RACAD-GUID-11C4EEF9-CC32-42A5-B8FD-C8E41C8D2BFA" class="sect4">Enable Service, Module, and Action Monitoring</h4>
                  <div>
                     <p>You can enable performance data tracing for important modules and actions within each service. The performance statistics are available in the <code class="codeph">V$SERV_MOD_ACT_STATS</code> view. For example, you might decide to set the following:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>For the <code class="codeph">ERP</code> service, enable monitoring for the <code class="codeph">exceptions pay</code> action in the <code class="codeph">payroll</code> module.
                           </p>
                        </li>
                        <li>
                           <p>For the <code class="codeph">ERP</code> service, enable monitoring for the all actions in the <code class="codeph">payroll</code> module. 
                           </p>
                        </li>
                        <li>
                           <p>For the <code class="codeph">HOT_BATCH</code> service, enable monitoring for all actions in the <code class="codeph">posting</code> module.
                           </p>
                        </li>
                     </ul>
                     <p>The following commands show how to enable the module and action monitoring for the services:</p><pre class="oac_no_warn" dir="ltr">EXECUTE DBMS_MONITOR.SERV_MOD_ACT_STAT_ENABLE(service_name =&gt; 'erp', module_name=&gt;
 'payroll', action_name =&gt; 'exceptions pay');
EXECUTE DBMS_MONITOR.SERV_MOD_ACT_STAT_ENABLE(service_name =&gt; 'erp', module_name=&gt;
 'payroll');
EXECUTE DBMS_MONITOR.SERV_MOD_ACT_STAT_ENABLE(service_name =&gt; 'hot_batch', 
module_name =&gt;'posting'); 
</pre><p>To verify monitoring is enabled for the service, module, and actions, use the following <code class="codeph">SELECT</code> statement: 
                     </p><pre class="oac_no_warn" dir="ltr">COLUMN AGGREGATION_TYPE FORMAT A21 TRUNCATED HEADING 'AGGREGATION'
COLUMN PRIMARY_ID FORMAT A20 TRUNCATED HEADING 'SERVICE'
COLUMN QUALIFIER_ID1 FORMAT A20 TRUNCATED HEADING 'MODULE'
COLUMN QUALIFIER_ID2 FORMAT A20 TRUNCATED HEADING 'ACTION'
SELECT * FROM DBA_ENABLED_AGGREGATIONS ; 
</pre><p>The output is similar to the following: </p><pre class="oac_no_warn" dir="ltr">AGGREGATION            SERVICE                MODULE        ACTION
------------           --------------------   ----------    -------------
SERVICE_MODULE_ACTION  erp                    payroll       exceptions pay
SERVICE_MODULE         erp                    payroll
SERVICE_MODULE         hot_batch              posting</pre></div>
               </div>
            </div><a id="RACAD841"></a><div class="sect2"><a id="GUID-4CC2D344-02D6-40E7-85B6-BB3AA7D6461A" name="GUID-4CC2D344-02D6-40E7-85B6-BB3AA7D6461A"></a><h3 id="RACAD-GUID-4CC2D344-02D6-40E7-85B6-BB3AA7D6461A" class="sect3">Using Oracle Services</h3>
               <div>
                  <p><a id="d17899e7943" class="indexterm-anchor"></a>To manage <a id="d17899e7948" class="indexterm-anchor"></a>workloads<a id="d17899e7953" class="indexterm-anchor"></a> or a group of applications, you can define services that you assign to a particular application or to a subset of an application's operations. You can also group work by type under services. For example, online users can use one service, while batch processing can use another and reporting can use yet another service to connect to the database.
                  </p>
                  <p><a id="d17899e7962" class="indexterm-anchor"></a>Oracle <a id="d17899e7967" class="indexterm-anchor"></a>recommends that all users who share a service have the same service level requirements. You can define specific characteristics for services and each service can represent a separate unit of work. There are many options that you can take advantage of when using services. Although you do not have to implement these options, using them helps optimize application performance.
                  </p>
               </div>
            </div><a id="RACAD7300"></a><div class="sect2"><a id="GUID-6524637F-FE3E-46D9-8B47-887C0D7C562C" name="GUID-6524637F-FE3E-46D9-8B47-887C0D7C562C"></a><h3 id="RACAD-GUID-6524637F-FE3E-46D9-8B47-887C0D7C562C" class="sect3">Service Deployment Options</h3>
               <div>
                  <p>This section describes the following service deployment topics: </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="workload-management-with-dynamic-database-services.html#GUID-156DFA50-D18D-45CE-9AC1-5A6C71157263" title="Oracle GoldenGate takes advantage of Oracle RAC features.">Service Usage in an Oracle RAC Database</a></p>
                     </li>
                     <li>
                        <p><a href="workload-management-with-dynamic-database-services.html#GUID-539C0211-6AA2-44A3-9699-8DE9FBD9867D" title="When you use Oracle Clusterware to manage your database, you can configure startup options for each individual database service when you add the service using the srvctl add service command with the -policy parameter.If you configured Oracle Data Guard in your environment, then you can define a role for services when you add or modify a service using SRVCTL and the -role parameter with the appropriate command.When you define a service for an administrator-managed database, you define which instances normally support that service using SRVCTL with the -preferred parameter.Oracle RAC routes clients with the same COLOCATION_TAG to the same database instance, when possible.When you define services for a policy-managed database, you assign the service to a server pool in which the database is hosted using SRVCTL with the -serverpool parameter.Oracle Net Services provides connection load balancing to enable you to spread user connections across all of the instances that are supporting a service.">Service Characteristics</a></p>
                     </li>
                     <li>
                        <p><a href="workload-management-with-dynamic-database-services.html#GUID-599AD3C2-6E55-4124-A7A5-094DA2593D50">Default Service Connections</a></p>
                     </li>
                     <li>
                        <p><a href="workload-management-with-dynamic-database-services.html#GUID-07E4A746-8C68-4279-8932-0C86A402D9AE" title="This feature allows listener registration only from local IP addresses, by default, and provides the ability to configure and dynamically update a set of IP addresses or subnets from which registration requests are allowed by the listener.">Restricted Service Registration</a></p>
                     </li>
                  </ul>
               </div><a id="RACAD8269"></a><div class="sect3"><a id="GUID-156DFA50-D18D-45CE-9AC1-5A6C71157263" name="GUID-156DFA50-D18D-45CE-9AC1-5A6C71157263"></a><h4 id="RACAD-GUID-156DFA50-D18D-45CE-9AC1-5A6C71157263" class="sect4">Service Usage in an Oracle RAC Database</h4>
                  <div>
                     <p>Services provide location transparency. A service name can identify multiple database instances, and an instance can belong to multiple services. Several database features use services for an Oracle RAC database:</p>
                     <p>This section includes the following topics:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="workload-management-with-dynamic-database-services.html#GUID-6D9E7A56-F3F5-414F-B205-7329BE5C9394">Oracle Clusterware Resources for a Service</a></p>
                        </li>
                        <li>
                           <p><a href="workload-management-with-dynamic-database-services.html#GUID-FAD4432C-E317-4902-9CE5-60279AEC1284">Database Resource Manager Consumer Group Mappings for Services</a></p>
                        </li>
                        <li>
                           <p><a href="workload-management-with-dynamic-database-services.html#GUID-3F445FCA-7825-4282-850F-B1234998DFB8">Performance Monitoring by Service with AWR</a></p>
                        </li>
                        <li>
                           <p><a href="workload-management-with-dynamic-database-services.html#GUID-538282FC-1607-42D7-91E8-C2C5253389E0">Parallel Operations and Services</a></p>
                        </li>
                        <li>
                           <p><a href="workload-management-with-dynamic-database-services.html#GUID-A55E430B-5AE0-4C93-9C3E-FD26A650758C" title="Oracle GoldenGate takes advantage of Oracle RAC features.">Oracle GoldenGate and Oracle RAC</a></p>
                        </li>
                     </ul>
                  </div><a id="RACAD8270"></a><div class="sect4"><a id="GUID-6D9E7A56-F3F5-414F-B205-7329BE5C9394" name="GUID-6D9E7A56-F3F5-414F-B205-7329BE5C9394"></a><h5 id="RACAD-GUID-6D9E7A56-F3F5-414F-B205-7329BE5C9394" class="sect5">Oracle Clusterware Resources for a Service</h5>
                     <div>
                        <p><a id="d17899e8472" class="indexterm-anchor"></a>Resource profiles are automatically created when you define a service. A resource profile describes how Oracle Clusterware should manage the service and which instance the service should failover to if the preferred instance stops. Resource profiles also define <a id="d17899e8477" class="indexterm-anchor"></a>service <a id="d17899e8482" class="indexterm-anchor"></a>dependencies for the instance and the database. Due to these dependencies, if you stop a database, then the instances and services are automatically stopped in the correct order.
                        </p>
                     </div>
                  </div><a id="RACAD8271"></a><div class="sect4"><a id="GUID-FAD4432C-E317-4902-9CE5-60279AEC1284" name="GUID-FAD4432C-E317-4902-9CE5-60279AEC1284"></a><h5 id="RACAD-GUID-FAD4432C-E317-4902-9CE5-60279AEC1284" class="sect5">Database Resource Manager Consumer Group Mappings for Services</h5>
                     <div>
                        <p>Services are integrated with Oracle <a id="d17899e8628" class="indexterm-anchor"></a>Resource Manager, which enables you to restrict the resources that users use to connect to an instance by using a service. Oracle Resource Manager enables you to map a consumer group to a service so that users who connect to an instance using that service are members of the specified consumer group. Oracle Resource Manager operates at an instance level.
                        </p>
                     </div>
                  </div><a id="RACAD8272"></a><div class="sect4"><a id="GUID-3F445FCA-7825-4282-850F-B1234998DFB8" name="GUID-3F445FCA-7825-4282-850F-B1234998DFB8"></a><h5 id="RACAD-GUID-3F445FCA-7825-4282-850F-B1234998DFB8" class="sect5">Performance Monitoring by Service with AWR</h5>
                     <div>
                        <p>The metric data generated by Automatic Workload Repository (AWR) is organized into various groups, such as event, event class, session, service, and tablespace metrics. Typically, you view the AWR data using Oracle Enterprise Manager or AWR reports.</p>
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>Related Topics</strong></p>
                           <ul>
                              <li><a href="../tgdba/comparing-database-performance-over-time.html#TGDBA-GUID-BEDBF986-1A69-459A-90F5-350B8A407516" target="_blank"><span><cite>Oracle Database Performance Tuning Guide</cite></span></a></li>
                           </ul>
                        </div>
                     </div>
                  </div><a id="RACAD8273"></a><div class="sect4"><a id="GUID-538282FC-1607-42D7-91E8-C2C5253389E0" name="GUID-538282FC-1607-42D7-91E8-C2C5253389E0"></a><h5 id="RACAD-GUID-538282FC-1607-42D7-91E8-C2C5253389E0" class="sect5">Parallel Operations and Services</h5>
                     <div>
                        <p><a id="d17899e8932" class="indexterm-anchor"></a><a id="d17899e8934" class="indexterm-anchor"></a><a id="d17899e8938" class="indexterm-anchor"></a><a id="d17899e8942" class="indexterm-anchor"></a><a id="d17899e8946" class="indexterm-anchor"></a>By default, in an Oracle RAC environment, a SQL statement executed in parallel can run across all of the nodes in the cluster. For this cross-node or inter-node parallel execution to perform well, the interconnect in the Oracle RAC environment must be sized appropriately because inter-node parallel execution may result in a lot of interconnect traffic. To limit inter-node parallel execution, you can control parallel execution in an Oracle RAC environment using the <code class="codeph">PARALLEL_FORCE_LOCAL</code> initialization parameter. By setting this parameter to <code class="codeph">TRUE</code>, the parallel execution servers can only execute on the same Oracle RAC node where the SQL statement was started.
                        </p>
                        <p>Services are used to limit the number of instances that participate in a parallel SQL operation. When the default database service is used, the parallel SQL operation can run on all available instances. You can create any number of services, each consisting of one or more instances. When a parallel SQL operation is started, the parallel execution servers are only spawned on instances which offer the specified service used in the initial database connection.</p>
                        <p> <code class="codeph">PARALLEL_INSTANCE_GROUP</code> is an Oracle RAC parameter that, when used with services, lets you restrict parallel query operations to a limited number of instances.To restrict parallel query operations to a limited number of instances, set the <code class="codeph">PARALLEL_INSTANCE_GROUP</code> initialization parameter to the name of a service. This does not affect other parallel operations such as parallel recovery or the processing of <code class="codeph">GV$</code> queries. 
                        </p>
                     </div>
                  </div><a id="RACAD8274"></a><div class="sect4"><a id="GUID-A55E430B-5AE0-4C93-9C3E-FD26A650758C" name="GUID-A55E430B-5AE0-4C93-9C3E-FD26A650758C"></a><h5 id="RACAD-GUID-A55E430B-5AE0-4C93-9C3E-FD26A650758C" class="sect5">Oracle GoldenGate and Oracle RAC</h5>
                     <div>
                        <p>Oracle GoldenGate takes advantage of Oracle RAC features.</p>
                        <p>When Oracle GoldenGate is configured in an Oracle RAC environment, each queue table has an owning instance. If the instance that hosts a queue table fails, another instance in the Oracle RAC database becomes the owning instance for the queue table, allowing Oracle GoldenGate to continue operating.</p>
                        <p>Also, on an Oracle RAC database, a service is created for each buffered queue. This service always runs on the owner instance of the destination queue and follows the ownership of this queue if the ownership switches because of instance startup, instance shutdown, and so on. This service is used by queue-to-queue propagations.</p>
                     </div>
                  </div>
               </div><a id="RACAD8256"></a><div class="sect3"><a id="GUID-539C0211-6AA2-44A3-9699-8DE9FBD9867D" name="GUID-539C0211-6AA2-44A3-9699-8DE9FBD9867D"></a><h4 id="RACAD-GUID-539C0211-6AA2-44A3-9699-8DE9FBD9867D" class="sect4">Service Characteristics</h4>
                  <div>
                     <p>When you create new services for your database, you should define the <a id="d17899e9260" class="indexterm-anchor"></a>automatic workload management characteristics for each service. The characteristics of a service include:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="workload-management-with-dynamic-database-services.html#GUID-9032F733-346E-4E39-8E63-46F72E13F511">Service Name</a></p>
                        </li>
                        <li>
                           <p><a href="workload-management-with-dynamic-database-services.html#GUID-FC672BC8-2FAD-49F7-8683-3998C350E415">Service Edition</a></p>
                        </li>
                        <li>
                           <p><a href="workload-management-with-dynamic-database-services.html#GUID-0573F51A-7DF9-40AC-AE6A-0997F7EEEF3F" title="When you use Oracle Clusterware to manage your database, you can configure startup options for each individual database service when you add the service using the srvctl add service command with the -policy parameter.">Service Management Policy</a></p>
                        </li>
                        <li>
                           <p><a href="workload-management-with-dynamic-database-services.html#GUID-785A51EA-2D3F-43BC-8D35-7BD7C24D08AD" title="If you configured Oracle Data Guard in your environment, then you can define a role for services when you add or modify a service using SRVCTL and the -role parameter with the appropriate command.">Database Role for a Service</a></p>
                        </li>
                        <li>
                           <p><a href="workload-management-with-dynamic-database-services.html#GUID-58636C69-C704-400C-A5C9-12A6BAC47E5A" title="When you define a service for an administrator-managed database, you define which instances normally support that service using SRVCTL with the -preferred parameter.">Instance Preference</a></p>
                        </li>
                        <li>
                           <p><a href="workload-management-with-dynamic-database-services.html#GUID-1249F5AD-068A-4CC2-9BC5-9BF8AF754841" title="When you define services for a policy-managed database, you assign the service to a server pool in which the database is hosted using SRVCTL with the -serverpool parameter.">Server Pool Assignment</a></p>
                        </li>
                        <li>
                           <p><a href="workload-management-with-dynamic-database-services.html#GUID-57EBCB43-10AF-4DC1-A376-69EC53B11CD2">Load Balancing Advisory Goal for Run-time Connection Load Balancing</a></p>
                        </li>
                        <li>
                           <p><a href="workload-management-with-dynamic-database-services.html#GUID-B3DBD542-5EB4-4A23-9E6A-A48742A4754E" title="Oracle Net Services provides connection load balancing to enable you to spread user connections across all of the instances that are supporting a service.">Connection Load Balancing Goal</a></p>
                        </li>
                        <li>
                           <p><a href="workload-management-with-dynamic-database-services.html#GUID-E71183DA-149D-49A9-8377-4B1B54CB3946">Distributed Transaction Processing</a></p>
                        </li>
                        <li>
                           <p><a href="ensuring-application-continuity.html#GUID-DEF850F6-27E9-428E-B8FC-530230D78AD2" title="When Oracle Net Services establishes a connection to an instance, the connection remains open until the client closes the connection, the instance is shutdown, or a failure occurs.">Failing Over OCI Clients with TAF</a></p>
                        </li>
                     </ul>
                  </div><a id="RACAD8257"></a><div class="sect4"><a id="GUID-9032F733-346E-4E39-8E63-46F72E13F511" name="GUID-9032F733-346E-4E39-8E63-46F72E13F511"></a><h5 id="RACAD-GUID-9032F733-346E-4E39-8E63-46F72E13F511" class="sect5">Service Name</h5>
                     <div>
                        <p>Each service has a service name. The service name is used by clients to connect to one or more instances. The service name must be unique throughout your system.</p>
                     </div>
                  </div><a id="RACAD8259"></a><div class="sect4"><a id="GUID-FC672BC8-2FAD-49F7-8683-3998C350E415" name="GUID-FC672BC8-2FAD-49F7-8683-3998C350E415"></a><h5 id="RACAD-GUID-FC672BC8-2FAD-49F7-8683-3998C350E415" class="sect5">Service Edition</h5>
                     <div>
                        <p>Edition-based redefinition of database objects enables you to upgrade an application's objects while these objects are in use. You can set the <a id="d17899e9633" class="indexterm-anchor"></a><a id="d17899e9639" class="indexterm-anchor"></a><span class="italic">edition</span> attribute of a database service when you create it, or modify an existing service to set the edition. When you set the service edition, connections that use this service use this edition as the initial session edition. If the service does not specify the edition name, then the initial session edition is the database default edition.
                        </p>
                        <p>You can set the service edition using SRVCTL, as follows:</p><pre class="oac_no_warn" dir="ltr">$ srvctl modify service &#x2013;db hr &#x2013;s crmsrv &#x2013;edition e2</pre></div>
                  </div><a id="RACAD8260"></a><div class="sect4"><a id="GUID-0573F51A-7DF9-40AC-AE6A-0997F7EEEF3F" name="GUID-0573F51A-7DF9-40AC-AE6A-0997F7EEEF3F"></a><h5 id="RACAD-GUID-0573F51A-7DF9-40AC-AE6A-0997F7EEEF3F" class="sect5">Service Management Policy</h5>
                     <div>
                        <p>When you use Oracle Clusterware to manage your database, you can configure startup options for each individual database service when you add the service using the <code class="codeph">srvctl add service</code> command with the <code class="codeph">-policy</code> parameter.
                        </p>
                        <p>If you set the management policy for a service to <code class="codeph">AUTOMATIC</code> (the default), then the service starts automatically when you start the database with SRVCTL. If you set the management policy to <code class="codeph">MANUAL</code>, then the service does not automatically start, and you must manually start it with SRVCTL. A <code class="codeph">MANUAL</code> setting does not prevent Oracle Clusterware from monitoring the service when it is running and restarting it if a failure occurs. Before Oracle RAC 11<span class="italic">g</span> release 2 (11.2), all services worked as though they were defined with a <code class="codeph">MANUAL</code> management policy.
                        </p>
                        <p>Using CRSCTL to stop and restart Oracle Clusterware is treated as a failure and the service is restarted if it was previously running.</p>
                        <div class="infoboxnote" id="GUID-0573F51A-7DF9-40AC-AE6A-0997F7EEEF3F__GUID-A4E8C63F-65B1-4851-90D7-7D6CF0126857">
                           <p class="notep1">Note:</p>
                           <p>When you use automatic services in an administrator-managed database, during planned database startup, services may start on the first instances to start rather than their preferred instances, provided that the started instances are in the (combined) preferred and available services list.</p>
                        </div>
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>Related Topics</strong></p>
                           <ul>
                              <li><a href="server-control-utility-reference.html#GUID-EC1BA6D7-D538-4E11-9B31-C59389FDF93B" title="Adds services to a database and assigns them to instances.">srvctl add service</a></li>
                           </ul>
                        </div>
                     </div>
                  </div><a id="RACAD8261"></a><div class="sect4"><a id="GUID-785A51EA-2D3F-43BC-8D35-7BD7C24D08AD" name="GUID-785A51EA-2D3F-43BC-8D35-7BD7C24D08AD"></a><h5 id="RACAD-GUID-785A51EA-2D3F-43BC-8D35-7BD7C24D08AD" class="sect5">Database Role for a Service</h5>
                     <div>
                        <p>If you configured Oracle Data Guard in your environment, then you can define a role for services when you add or modify a service using SRVCTL and the <code class="codeph">-role</code> parameter with the appropriate command.
                        </p>
                        <p>When you specify a role for a service, Oracle Clusterware automatically starts the service only when the database role matches the role you specified for the service. Valid roles are <code class="codeph">PRIMARY</code>, <code class="codeph">PHYSICAL_STANDBY</code>, <code class="codeph">LOGICAL_STANDBY</code>, and <code class="codeph">SNAPSHOT_STANDBY</code> and you can specify more than one role for a service.
                        </p>
                        <div class="infoboxnote" id="GUID-785A51EA-2D3F-43BC-8D35-7BD7C24D08AD__GUID-BA5CD69B-57C8-481E-8BDF-822E549352B3">
                           <p class="notep1">Note:</p>
                           <p>The service role only controls automatic startup of services. Using SRVCTL to manually start a service will succeed even if the roles do not match.</p>
                        </div>
                        <p>Redo Apply (physical standby database) can run on all or some standby instances that you can configure. This enables Redo Apply performance to scale, if necessary, by adding additional standby instances.</p>
                        <p>If multiple databases in the cluster offer the same service name, then Oracle RAC balances connections to that service across all such databases. This is useful for standby and active Oracle Data Guard databases, but if you want client connections to a service to be directed to a particular database, then the service name must be unique within the cluster (not offered by any other database).</p>
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>Related Topics</strong></p>
                           <ul>
                              <li><a href="../sbydb/configuring-data-guard-standby-databases-in-oracle-RAC.html#SBYDB-GUID-00B72AF1-0453-4FBD-901F-A3764631BE1F" target="_blank"><span><cite>Oracle Data Guard Concepts and Administration</cite></span></a></li>
                           </ul>
                        </div>
                     </div>
                  </div><a id="RACAD8262"></a><div class="sect4"><a id="GUID-58636C69-C704-400C-A5C9-12A6BAC47E5A" name="GUID-58636C69-C704-400C-A5C9-12A6BAC47E5A"></a><h5 id="RACAD-GUID-58636C69-C704-400C-A5C9-12A6BAC47E5A" class="sect5">Instance Preference</h5>
                     <div>
                        <p>When you define a service for an administrator-managed database, you define which instances normally support that service using SRVCTL with the <code class="codeph">-preferred</code> parameter.
                        </p>
                        <p>These are known as the <span class="italic">preferred</span> instances. You can also define other instances to support a service if the service's preferred instance fails using SRVCTL with the <code class="codeph">-available</code> parameter. These are known as <span class="italic">available</span> instances.
                        </p>
                        <p>When you specify preferred instances, you are specifying the number of instances on which a service normally runs. This is the <span class="italic">maximum cardinality</span> of the service. Oracle Clusterware attempts to ensure that the service always runs on the number of instances for which you have configured the service. Afterward, due to either instance failure or planned service relocations, a service may be running on an available instance.
                        </p>
                        <p>If an instance fails, then, because Oracle Clusterware interprets the preferred and available lists as ordered lists, you have some control to which available instance Oracle Clusterware relocates the services, if there are multiple instances in the lists. During a planned operation, however, you can manually direct the service to any instance in either the preferred or the available list not currently offering the service.</p>
                        <p>When a service moves to an available instance, Oracle Database does not automatically move the service back to the preferred instance when the preferred instance restarts because:</p>
                        <ul style="list-style-type: disc;">
                           <li>The service is running on the desired number of instances.</li>
                           <li>Maintaining the service on the current instance provides a higher level of service availability.</li>
                           <li>Not moving the service back to the initial preferred instance prevents a second outage.</li>
                        </ul>
                        <p>Starting with Oracle Database release 19.3, if you specify <code class="codeph">yes</code> for the <code class="codeph">-failback</code> attribute of a service, then, after failing over to an available instance when the last preferred instance went down, the service transfers back to a preferred instance when one becomes available. For earlier releases, you can automate fail back to the preferred instance by using FAN callouts.
                        </p>
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>Related Topics</strong></p>
                           <ul>
                              <li><a href="administering-database-instances-and-cluster-databases.html#GUID-4F468ADC-D3E6-4D6F-B3AE-19BE5E5837A5" title="The Server Control Utility (SRVCTL) is a command-line interface that you can use to manage Oracle Databases in a centralized manner.Oracle Enterprise Manager provides a central point of control for the Oracle RAC environment, allowing you to perform administrative tasks simultaneously on multiple cluster databases.Unlike SRVCTL or Oracle Enterprise Manager, SQL*Plus is an instance-oriented management tool.">Tools for Administering Oracle RAC</a></li>
                           </ul>
                        </div>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-8E0EE7C3-AE33-4BA4-88C3-47EF96F80564" name="GUID-8E0EE7C3-AE33-4BA4-88C3-47EF96F80564"></a><h5 id="RACAD-GUID-8E0EE7C3-AE33-4BA4-88C3-47EF96F80564" class="sect5">Service Co-location</h5>
                     <div>
                        <p>Oracle RAC routes clients with the same <code class="codeph">COLOCATION_TAG</code> to the same database instance, when possible.
                        </p>
                        <p>Co-location of sessions on the same instance can help decrease inter-instance communication and increase performance for workloads that benefit from being executed in the same instance. You configure the <code class="codeph">COLOCATION_TAG</code> in the <code class="codeph">CONNECT_DATA</code> parameter of the TNS connect string used by the service as described in <span><cite>Oracle Database Net Services Reference</cite></span>.
                        </p>
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>Related Topics</strong></p>
                           <ul>
                              <li><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/racad&amp;id=NETRF-GUID-9D06528E-BBC4-4629-A119-C216EBF70201" target="_blank">COLOCATION_TAG</a></li>
                           </ul>
                        </div>
                     </div>
                  </div><a id="RACAD8263"></a><div class="sect4"><a id="GUID-1249F5AD-068A-4CC2-9BC5-9BF8AF754841" name="GUID-1249F5AD-068A-4CC2-9BC5-9BF8AF754841"></a><h5 id="RACAD-GUID-1249F5AD-068A-4CC2-9BC5-9BF8AF754841" class="sect5">Server Pool Assignment</h5>
                     <div>
                        <p>When you define services for a policy-managed database, you assign the service to a server pool in which the database is hosted using SRVCTL with the <code class="codeph">-serverpool</code> parameter.
                        </p>
                        <p>You can define the service as either <code class="codeph">UNIFORM</code> (running on all instances in the server pool) or <code class="codeph">SINGLETON</code> (running on only one instance in the server pool) using the <code class="codeph">-cardinality</code> parameter. For singleton services, Oracle RAC chooses on which instance in the server pool the service is active. If that instance fails, then the service fails over to another instance in the server pool. A service can only run in one server pool and Oracle recommends that every server pool has at least one service.
                        </p>
                        <div class="infoboxnote" id="GUID-1249F5AD-068A-4CC2-9BC5-9BF8AF754841__GUID-75BA1C09-9449-4BE3-B595-2A0687034259">
                           <p class="notep1">Note:</p>Oracle Database Quality of Service Management (Oracle Database QoS Management) manages singleton services in a server pool, if the maximum size of that server pool is one.
                        </div>
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>Related Topics</strong></p>
                           <ul>
                              <li><a href="administering-database-instances-and-cluster-databases.html#GUID-4F468ADC-D3E6-4D6F-B3AE-19BE5E5837A5" title="The Server Control Utility (SRVCTL) is a command-line interface that you can use to manage Oracle Databases in a centralized manner.Oracle Enterprise Manager provides a central point of control for the Oracle RAC environment, allowing you to perform administrative tasks simultaneously on multiple cluster databases.Unlike SRVCTL or Oracle Enterprise Manager, SQL*Plus is an instance-oriented management tool.">Tools for Administering Oracle RAC</a></li>
                           </ul>
                        </div>
                     </div>
                  </div><a id="RACAD8264"></a><div class="sect4"><a id="GUID-57EBCB43-10AF-4DC1-A376-69EC53B11CD2" name="GUID-57EBCB43-10AF-4DC1-A376-69EC53B11CD2"></a><h5 id="RACAD-GUID-57EBCB43-10AF-4DC1-A376-69EC53B11CD2" class="sect5">Load Balancing Advisory Goal for Run-time Connection Load Balancing</h5>
                     <div>
                        <p>With <a id="d17899e10712" class="indexterm-anchor"></a>run-time connection load balancing, applications can use load balancing advisory events to provide better service to users. Oracle JDBC, Oracle Universal Connection Pool for Java, OCI session pool, ODP.NET, and Oracle WebLogic Server Active GridLink for Oracle RAC clients are automatically integrated to take advantage of load balancing advisory events. The load balancing advisory informs the client about the current service level that an instance is providing for a service. To enable the load balancing advisory, use SRVCTL with the <code class="codeph">-rlbgoal</code> parameter when creating or modifying the service.
                        </p>
                        <p><a id="d17899e10719" class="indexterm-anchor"></a>The load balancing advisory also recommends how much of the workload should be sent to that instance. The goal determines whether connections are made to the service based on best service quality (how efficiently a single transaction completes) or best throughput (how efficiently a complete job or long-running query completes).
                        </p>
                     </div>
                  </div><a id="RACAD8265"></a><div class="sect4"><a id="GUID-B3DBD542-5EB4-4A23-9E6A-A48742A4754E" name="GUID-B3DBD542-5EB4-4A23-9E6A-A48742A4754E"></a><h5 id="RACAD-GUID-B3DBD542-5EB4-4A23-9E6A-A48742A4754E" class="sect5">Connection Load Balancing Goal</h5>
                     <div>
                        <p>Oracle Net Services provides connection load balancing to enable you to spread user connections across all of the instances that are supporting a service.</p>
                        <p>For each service, you can use SRVCTL to define the method you want the listener to use for load balancing by setting the connection load balancing goal, specified with the <code class="codeph">-clbgoal</code> parameter. Connections are classified as <code class="codeph">LONG</code> (such as connection pools and SQL*FORMS), which tells the listener to use session count, or <code class="codeph">SHORT</code>, which tells the listener to use response-time or throughput statistics.
                        </p>
                        <p>If load balancing advisory is enabled (the <code class="codeph">-rlbgoal</code> parameter <span class="italic">does not</span> equal <code class="codeph">NONE</code>), then connection load balancing attempts to use load balancing advisory (whether it is set to <code class="codeph">SHORT</code> or <code class="codeph">LONG</code>). If load balancing advisory is set to <code class="codeph">SHORT</code>, then it will use the <code class="codeph">GOODNESS</code> value of a service to try to prevent all connection requests from going to one instance. If load balancing advisory is set to <code class="codeph">LONG</code>, then it uses <code class="codeph">run queue length</code> if the service is non-uniform, or <code class="codeph">session count</code> if there is uniform service distribution.
                        </p>
                     </div>
                  </div><a id="RACAD8266"></a><div class="sect4"><a id="GUID-E71183DA-149D-49A9-8377-4B1B54CB3946" name="GUID-E71183DA-149D-49A9-8377-4B1B54CB3946"></a><h5 id="RACAD-GUID-E71183DA-149D-49A9-8377-4B1B54CB3946" class="sect5">Distributed Transaction Processing</h5>
                     <div>
                        <p></p>
                        <p><a href="glossary.html#GUID-2CD48F9F-B395-4ECC-ABE3-0F67EC3639ED"><span class="xrefglossterm">Oracle XA</span></a> applications have unique requirements. Oracle provides global transactions across Oracle RAC. For best performance, use XA affinity (all branches at the same instance) for most transactions, and global transactions when needed. You can use XA affinity with connection pools, such as Universal Connection Pools and WebLogic Server. You can also use singleton services that you create using SRVCTL. Use SRVCTL, as well, to set the distributed transaction processing parameter (<code class="codeph">-dtp</code>) to <code class="codeph">TRUE</code> if you are suspending and resuming the same Oracle XA branch. Do not use this in general, however, because it does not offer rolling planned maintenance.
                        </p>
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>Related Topics</strong></p>
                           <ul>
                              <li><a href="workload-management-with-dynamic-database-services.html#GUID-7948E56B-D455-4852-A3EF-20E4F59156A5">Distributed Transaction Processing in Oracle RAC</a></li>
                              <li><a href="server-control-utility-reference.html#GUID-EC1BA6D7-D538-4E11-9B31-C59389FDF93B" title="Adds services to a database and assigns them to instances.">srvctl add service</a></li>
                           </ul>
                        </div>
                     </div>
                  </div>
               </div><a id="RACAD7123"></a><div class="sect3"><a id="GUID-599AD3C2-6E55-4124-A7A5-094DA2593D50" name="GUID-599AD3C2-6E55-4124-A7A5-094DA2593D50"></a><h4 id="RACAD-GUID-599AD3C2-6E55-4124-A7A5-094DA2593D50" class="sect4">Default Service Connections</h4>
                  <div>
                     <p>Your Oracle RAC database includes an Oracle database service identified by <code class="codeph">DB_UNIQUE_NAME</code>, if set, or <code class="codeph">DB_NAME</code> or <code class="codeph">PDB_NAME</code>, if not. This default service is always available on all instances in an Oracle RAC environment, unless an instance is in restricted mode. You cannot alter this service or its properties. Additionally, the database supports the following two internal services:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><code class="codeph">SYS$BACKGROUND</code> is used by the background processes only
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">SYS$USERS</code> is the default service for user sessions that are not associated with any application service
                           </p>
                        </li>
                     </ul>
                     <p>All of these services are used for internal management. You cannot stop or disable any of these internal services to do planned outages or to failover to Oracle Data Guard. Do not use these services for client connections.</p>
                     <div class="infoboxnote" id="GUID-599AD3C2-6E55-4124-A7A5-094DA2593D50__GUID-DB27C28D-20C2-48DE-B6AB-F8820014FF83">
                        <p class="notep1">Note:</p>
                        <p>You can explicitly manage only the services that you create. If a feature of the database creates an internal service, you cannot manage it using the information in this chapter.</p>
                     </div>
                  </div>
               </div><a id="RACAD8421"></a><div class="sect3"><a id="GUID-07E4A746-8C68-4279-8932-0C86A402D9AE" name="GUID-07E4A746-8C68-4279-8932-0C86A402D9AE"></a><h4 id="RACAD-GUID-07E4A746-8C68-4279-8932-0C86A402D9AE" class="sect4">Restricted Service Registration</h4>
                  <div>
                     <p>This feature allows listener registration only from local IP addresses, by default, and provides the ability to configure and dynamically update a set of IP addresses or subnets from which registration requests are allowed by the listener.</p>
                     <p>Security is a high priority to all enterprises, and network security and controlling access to the database is a critical component of overall security endeavours. Database Instance registration with a listener succeeds only when the request originates from a valid node. The network administrator can specify a list of valid nodes, excluded nodes, or disable valid node checking. The list of valid nodes explicitly lists the nodes and subnets that can register with the database. The list of excluded nodes explicitly lists the nodes that cannot register with the database. The control of dynamic registration results in increased manageability and security of Oracle RAC deployments.</p>
                     <p>By default, valid node checking for registration (VNCR) is enabled. In the default configuration, registration requests are only allowed from nodes within the cluster, because they are redirected to the private subnet, and only nodes within the cluster can access the private subnet. Non-SCAN listeners only accept registration from instances on the local node. You must manually include remote nodes or nodes outside the subnet of the SCAN listener on the list of valid nodes by using the <code class="codeph">registration_invited_nodes_<span class="variable" translate="no">alias</span></code> parameter in the <code class="codeph">listener.ora</code> file or by modifying the SCAN listener using SRVCTL, as follows:
                     </p><pre class="pre codeblock"><code>$ srvctl modify scan_listener -invitednodes <span class="variable" translate="no">node_list</span> -invitedsubnets <span class="variable" translate="no">subnet_list</span></code></pre></div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/racad&amp;id=NETAG-GUID-A7F49477-1F13-49E7-9B23-9A50A4627862" target="_blank"><span><cite>Oracle Database Net Services Administrator's Guide</cite></span></a></li>
                        </ul>
                     </div>
                  </div>
               </div>
            </div><a id="RACAD849"></a><div class="sect2"><a id="GUID-2678C005-1B70-4B88-90E0-174A324F7DAA" name="GUID-2678C005-1B70-4B88-90E0-174A324F7DAA"></a><h3 id="RACAD-GUID-2678C005-1B70-4B88-90E0-174A324F7DAA" class="sect3">Administering Services</h3>
               <div>
                  <p><a id="d17899e11584" class="indexterm-anchor"></a>You can create and <a id="d17899e11589" class="indexterm-anchor"></a><a id="d17899e11593" class="indexterm-anchor"></a>administer services<a id="d17899e11598" class="indexterm-anchor"></a><a id="d17899e11602" class="indexterm-anchor"></a> with Oracle Enterprise Manager and the SRVCTL utility. The following sections describe how to perform service-related tasks using these tools:
                  </p>
                  <p>This section includes the following topics:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="workload-management-with-dynamic-database-services.html#GUID-D594636D-17E5-42BC-A2B1-FD8FBEBCD06B" title="When you create and administer services, you are dividing the work that your database performs into manageable units.">Overview of Service Administration</a></p>
                     </li>
                     <li>
                        <p><a href="workload-management-with-dynamic-database-services.html#GUID-BE6E570F-FD1C-45B1-AA32-DE8B7405654E" title="The Cluster Managed Database Services page is the master page for beginning all tasks related to services.">Administering Services with Oracle Enterprise Manager</a></p>
                     </li>
                     <li>
                        <p><a href="workload-management-with-dynamic-database-services.html#GUID-CB82980F-8894-4142-8026-973895E03634" title="When you create a service using SRVCTL, you must start the service with a separate SRVCTL command.">Administering Services with SRVCTL</a></p>
                     </li>
                  </ul>
                  <div class="infoboxnote" id="GUID-2678C005-1B70-4B88-90E0-174A324F7DAA__GUID-7A61E309-3991-460C-9F63-3E2938100BB3">
                     <p class="notep1">Note:</p>
                     <p>You can also use the DBMS_SERVICE package to create or modify services and service attributes, but SRVCTL will override any settings made using this package. The DBMS_SERVICE package is not recommended for use with services used by an Oracle RAC database, nor when Oracle Restart is used, nor when Oracle Clusterware is managing a single-instance database.</p>
                  </div>
               </div><a id="RACAD7124"></a><div class="sect3"><a id="GUID-D594636D-17E5-42BC-A2B1-FD8FBEBCD06B" name="GUID-D594636D-17E5-42BC-A2B1-FD8FBEBCD06B"></a><h4 id="RACAD-GUID-D594636D-17E5-42BC-A2B1-FD8FBEBCD06B" class="sect4">Overview of Service Administration</h4>
                  <div>
                     <p>When you create and administer services, you are dividing the work that your database performs into manageable units.</p>
                     <p>The goal of using services is to achieve optimal utilization of your database infrastructure. You can create and deploy services based on business requirements. Oracle Database can measure the performance for each service. Using the <code class="codeph">DBMS_MONITOR</code> package, you can define both the application modules within a service and the individual actions for a module and monitor thresholds for these actions, enabling you to manage workloads to deliver capacity on demand.
                     </p>
                     <p>When you create new services for your database, you should define the automatic workload management characteristics for each service, as described in <span class="q">"<a href="workload-management-with-dynamic-database-services.html#GUID-539C0211-6AA2-44A3-9699-8DE9FBD9867D" title="When you use Oracle Clusterware to manage your database, you can configure startup options for each individual database service when you add the service using the srvctl add service command with the -policy parameter.If you configured Oracle Data Guard in your environment, then you can define a role for services when you add or modify a service using SRVCTL and the -role parameter with the appropriate command.When you define a service for an administrator-managed database, you define which instances normally support that service using SRVCTL with the -preferred parameter.Oracle RAC routes clients with the same COLOCATION_TAG to the same database instance, when possible.When you define services for a policy-managed database, you assign the service to a server pool in which the database is hosted using SRVCTL with the -serverpool parameter.Oracle Net Services provides connection load balancing to enable you to spread user connections across all of the instances that are supporting a service.">Service Characteristics</a>"</span>.
                     </p>
                     <div class="infoboxnotealso" id="GUID-D594636D-17E5-42BC-A2B1-FD8FBEBCD06B__GUID-7C30636F-91B7-4429-9525-DBF75220BCFB">
                        <p class="notep1">See Also:</p>
                        <p><span><cite>Oracle Database Quality of Service Management User's Guide</cite></span> if you are using Oracle Database QoS Management with your Oracle cluster for details on how to configure the database services
                        </p>
                     </div>
                     <p>In addition to creating services, you can:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><span class="bold">Delete a service</span>. You can delete services that you created. However, you cannot delete or modify the properties of the default database service that Oracle Database created.
                           </p>
                        </li>
                        <li>
                           <p><span class="bold">Check the status of a service</span>. A service can be assigned different roles among the available instances. In a complex database with many services, you may not remember the details of every service. Therefore, you may have to check the status on an instance or service basis. For example, you may have to know the status of a service for a particular instance before you make modifications to that instance or to the Oracle home from which it runs.
                           </p>
                        </li>
                        <li>
                           <p><span class="bold">Start or stop a service for a database or an instance</span>. A service must be started before it can be used for client connections to that instance. If you shut down your database, for example, by running the SRVCTL command <code class="codeph">srvctl stop database -db</code> <code class="codeph"><span class="variable" translate="no">db_unique_name</span></code> where <code class="codeph"><span class="variable" translate="no">db_unique_name</span></code> is the name of the database you want to stop, then Oracle Database stops all services for that database. Depending on the service management policy, you may have to manually restart the services when you start the database. Both the <code class="codeph">srvctl stop database</code> and <code class="codeph">srvctl stop service</code> commands accept the <code class="codeph">-force</code> option to forcibly disconnect connections. To drain sessions for planned outages do not use the <code class="codeph">-force</code> option.
                           </p>
                           <div class="infoboxnote" id="GUID-D594636D-17E5-42BC-A2B1-FD8FBEBCD06B__GUID-42F98ADF-40DC-4911-B308-D9E25FA93677">
                              <p class="notep1">Note:</p>
                              <p>If Oracle Database QoS Management is enabled for the Oracle RAC database, then the services are automatically restarted after they are stopped.</p>
                           </div>
                        </li>
                        <li>
                           <p><span class="bold">Map a service to a consumer group</span>. You can map services to Resource Manager Consumer groups to limit the amount of resources that services can use in an instance. You must create the consumer group and then map the service to the consumer group.
                           </p>
                        </li>
                        <li>
                           <p><span class="bold">Enable or disable a service for a database or an instance</span>. By default, Oracle Clusterware attempts to restart a service automatically after failures. You can prevent this behavior by disabling a service. Disabling a service is useful when you must perform database or instance maintenance, such as when you are performing an upgrade and you want to prevent connection requests from succeeding.
                           </p>
                        </li>
                        <li>
                           <p><span class="bold">Relocate a service to a different instance</span>. You can move a service from one instance to another instance to re-balance workloads, for example, after adding or deleting cluster nodes.
                           </p>
                        </li>
                     </ul>
                     <div class="infoboxnote" id="GUID-D594636D-17E5-42BC-A2B1-FD8FBEBCD06B__GUID-CD038D06-DDB7-4C34-B719-3D73748E36B3">
                        <p class="notep1">Note:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>When you use services, do not set a value for the <code class="codeph">SERVICE_NAMES</code> parameter; Oracle Database controls the setting for this parameter for the services that you create and for the default database service. The service features that this chapter describes are not directly related to the features that Oracle Database provides when you set <code class="codeph">SERVICE_NAMES</code>. In addition, setting a value for this parameter may override some benefits of using services.
                              </p>
                           </li>
                           <li>
                              <p>Service status information must be obtained from SRVCTL or from the service-related database views, such as <code class="codeph">dba_services</code>.
                              </p>
                           </li>
                           <li>
                              <p>If you specify a service using the <code class="codeph">DISPATCHERS</code> initialization parameter, it overrides any service in the <code class="codeph">SERVICE_NAMES</code> parameter, and cannot be managed. (For example, stopping the service with a SRVCTL command does not stop users connecting with the service.)
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="workload-management-with-dynamic-database-services.html#GUID-074729CB-8A91-419C-A6E1-3B9E4FD8D869" title="The overall goals of FAN are to enable end-to-end, lights-out recovery of applications and load balancing based on real transaction performance.Enabling Fast Connection Failover (FCF) for Universal Connection Pool and Oracle WebLogic Server Active GridLink for Oracle RAC enables the use of FAN HA and load balancing advisory events.You can enable FCF for Universal Connection Pool or Implicit Connection Cache.Run-time connection load balancing requires the use of an Oracle JDBC driver and an Oracle RAC database.The Replay data source (oracle.jdbc.replay.OracleDataSource) is a JDBC-thin data source that Application Continuity requires for Java.Transaction Guard provides a protocol and a generic tool for applications to use for at-most-once execution in case of planned and unplanned outages.As of Oracle Database 12c, OCI session pooling enables multiple threads of an application to use a dynamically managed set of pre-created database sessions.OCI supports FAN messages and Transaction Guard. FAN is designed to quickly notify an OCI-based application of outages at the node, database, instance, service, and public network levels.ODP.NET connection pools can subscribe to FAN HA notifications that indicate when nodes, services, and service members are down.When connecting to Oracle Database 12c and later, ODP.NET uses Oracle Notification Service, rather than Advanced Queuing.ODP.NET supports FAN messages and Transaction Guard. FAN is designed to quickly notify an ODP.NET-based application of outages at the node, database, instance, service, and public network levels.">Enabling Clients for Oracle RAC</a></li>
                           <li><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/racad&amp;id=ARPLS-GUID-9876C289-99E4-416B-AB6F-D8318642053E" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a></li>
                        </ul>
                     </div>
                  </div>
               </div><a id="RACAD7025"></a><div class="sect3"><a id="GUID-BE6E570F-FD1C-45B1-AA32-DE8B7405654E" name="GUID-BE6E570F-FD1C-45B1-AA32-DE8B7405654E"></a><h4 id="RACAD-GUID-BE6E570F-FD1C-45B1-AA32-DE8B7405654E" class="sect4">Administering Services with Oracle Enterprise Manager</h4>
                  <div>
                     <p>The Cluster Managed Database Services page is the master page for beginning all tasks related to services.</p>
                     <p>Access this page, as follows:</p>
                     <ol>
                        <li>
                           <p>In Oracle Enterprise Manager, go to the Cluster Database Home page.</p>
                           <div class="infoboxnotealso" id="GUID-BE6E570F-FD1C-45B1-AA32-DE8B7405654E__GUID-812647F9-10C0-445E-BC84-99C53CA15E3C">
                              <p class="notep1">See Also:</p>
                              <p><span><cite>Oracle Database 2 Day DBA</cite></span> for details on logging in to Oracle Enterprise Manager.
                              </p>
                           </div>
                        </li>
                        <li>
                           <p>From the <span class="bold">Availability</span> menu, select <span class="bold">Cluster Managed Database Services</span> to display the Cluster Managed Database Services page.
                           </p>
                        </li>
                        <li>
                           <p>Enter or confirm the credentials for the Oracle RAC database and host operating system and click <span class="bold">Continue</span> to display the Cluster Managed Database Services page.
                           </p>
                        </li>
                     </ol>
                     <p>From the Cluster Managed Database Services page you can drill down to perform the following tasks:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>View a list of services for the cluster</p>
                        </li>
                        <li>
                           <p>View the instances on which each service is currently running</p>
                        </li>
                        <li>
                           <p>View the server pool and nodes offering the service in a policy-managed environment</p>
                        </li>
                        <li>
                           <p>View the status for each service</p>
                        </li>
                        <li>
                           <p>Create or edit a service</p>
                        </li>
                        <li>
                           <p>Start or stop a service</p>
                        </li>
                        <li>
                           <p>Enable or disable a service</p>
                        </li>
                        <li>
                           <p>Perform instance-level tasks for a service</p>
                        </li>
                        <li>
                           <p>Delete a service</p>
                        </li>
                     </ul>
                     <div class="infoboxnote" id="GUID-BE6E570F-FD1C-45B1-AA32-DE8B7405654E__GUID-7AF68126-079E-4A19-9971-7A25846F3DC3">
                        <p class="notep1">Note:</p>
                        <p>You must have <code class="codeph">SYSDBA</code> credentials to access a cluster database. Cluster Managed Database Services does not permit you to connect as anything other than <code class="codeph">SYSDBA</code>. 
                        </p>
                     </div>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/racad&amp;id=ADMQS-GUID-BA75AD46-D22E-4914-A31E-C395CD6A2BBA" target="_blank"><span><cite>Oracle Database 2 Day DBA</cite></span></a></li>
                        </ul>
                     </div>
                     <div class="infoboxnotealso" id="GUID-BE6E570F-FD1C-45B1-AA32-DE8B7405654E__GUID-6B614B26-213C-49DC-A581-9820FE7912BF">
                        <p class="notep1">See Also:</p>
                        <p>Oracle Enterprise Manager online help for more information about administering services with Oracle Enterprise Manager</p>
                     </div>
                  </div>
               </div><a id="RACAD7026"></a><div class="sect3"><a id="GUID-CB82980F-8894-4142-8026-973895E03634" name="GUID-CB82980F-8894-4142-8026-973895E03634"></a><h4 id="RACAD-GUID-CB82980F-8894-4142-8026-973895E03634" class="sect4">Administering Services with SRVCTL</h4>
                  <div>
                     <p>When you create a service using SRVCTL, you must start the service with a separate SRVCTL command.</p>
                     <p>However, you may later have to manually stop or restart the service. You may also have to disable the service to prevent automatic restarts, to manually relocate the service, or obtain status information about the service. The following sections explain how to use SRVCTL to perform the following administrative tasks:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="workload-management-with-dynamic-database-services.html#GUID-FD53AE5D-7D2A-4AFC-8363-A2E0DD77863D" title="To create a service with SRVCTL, use the srvctl add service command on the command line.">Creating Services with SRVCTL</a></p>
                        </li>
                        <li>
                           <p><a href="workload-management-with-dynamic-database-services.html#GUID-87EDF90F-1776-474A-AD9C-93F9CBE6CB31" title="To configure services for Application Continuity, when you create a service using SRVCTL, set the -failovertype parameter to TRANSACTION and -commit_outcome to TRUE.">Creating Services for Application Continuity and Transaction Guard</a></p>
                        </li>
                        <li>
                           <p><a href="workload-management-with-dynamic-database-services.html#GUID-35D1F2C6-7A21-4B63-8ED9-69FCAECBA16C">Starting and Stopping Services with SRVCTL</a></p>
                        </li>
                        <li>
                           <p><a href="workload-management-with-dynamic-database-services.html#GUID-4DE433AE-AC47-4591-92A7-866DBE77A930">Enabling and Disabling Services with SRVCTL</a></p>
                        </li>
                        <li>
                           <p><a href="workload-management-with-dynamic-database-services.html#GUID-153EAA56-6E30-48BF-B152-7841E5640EF2">Relocating Services with SRVCTL</a></p>
                        </li>
                        <li>
                           <p><a href="workload-management-with-dynamic-database-services.html#GUID-506E7A9A-D204-4D30-A9CA-523C9FE58587">Obtaining the Status of Services with SRVCTL</a></p>
                        </li>
                        <li>
                           <p><a href="workload-management-with-dynamic-database-services.html#GUID-EBEFA349-1DD9-4978-B96B-0E0B092BE41D">Obtaining the Configuration of Services with SRVCTL</a></p>
                        </li>
                     </ul>
                  </div><a id="RACAD7126"></a><div class="sect4"><a id="GUID-FD53AE5D-7D2A-4AFC-8363-A2E0DD77863D" name="GUID-FD53AE5D-7D2A-4AFC-8363-A2E0DD77863D"></a><h5 id="RACAD-GUID-FD53AE5D-7D2A-4AFC-8363-A2E0DD77863D" class="sect5">Creating Services with SRVCTL</h5>
                     <div>
                        <p>To create a service with SRVCTL, use the <code class="codeph">srvctl add service</code> command on the command line.
                        </p>
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>Related Topics</strong></p>
                           <ul>
                              <li><a href="server-control-utility-reference.html#GUID-EC1BA6D7-D538-4E11-9B31-C59389FDF93B" title="Adds services to a database and assigns them to instances.">srvctl add service</a></li>
                           </ul>
                        </div>
                     </div>
                  </div><a id="RACAD8437"></a><a id="RACAD8438"></a><a id="RACAD8436"></a><div class="sect4"><a id="GUID-87EDF90F-1776-474A-AD9C-93F9CBE6CB31" name="GUID-87EDF90F-1776-474A-AD9C-93F9CBE6CB31"></a><h5 id="RACAD-GUID-87EDF90F-1776-474A-AD9C-93F9CBE6CB31" class="sect5">Creating Services for Application Continuity and Transaction Guard</h5>
                     <div>
                        <p>To configure services for Application Continuity, when you create a service using SRVCTL, set the <code class="codeph">-failovertype</code> parameter to <code class="codeph">TRANSACTION</code> and <code class="codeph">-commit_outcome</code> to <code class="codeph">TRUE</code>.
                        </p>
                        <p>When using Application Continuity and Transaction Guard with your applications, you must configure a service. This section describes how to configure these application services depending on the functionality you plan to implement.</p>
                        <div class="section">
                           <p class="subhead3" id="GUID-87EDF90F-1776-474A-AD9C-93F9CBE6CB31__GUID-7B531D6C-6766-4DD3-89E6-A5D9842E57AD">Creating Services for Application Continuity</p>
                        </div>
                        <!-- class="section" -->
                        <p>Additionally, you can set values for these other service parameters for Application Continuity and load balancing:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><code class="codeph">-replay_init_time</code>: Specifies how long, in seconds, you allow replay to start. Oracle recommends that you choose a value based on how long you will allow replay to be initiated. The default value is 300 seconds.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">-retention</code>: Specifies the time (in seconds) that the commit outcome information is stored in the database. The default value is 86400 (1 day).
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">-session_state</code>: After a COMMIT has executed, if the state was changed in that transaction, then it is not possible to replay the transaction to reestablish that state if the session is lost. When configuring Application Continuity, the applications are categorized depending on whether the session state after the initial setup is dynamic or static, and then whether it is correct to continue past a COMMIT operation within a request.
                              </p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p><span class="bold">Dynamic</span>: (default) A session has a dynamic state if the session state changes are not fully encapsulated by the initialization, and cannot be fully captured in a callback at failover. Once the first transaction in a request commits, failover is internally disabled until the next request begins. This is the default mode that almost <span class="italic">all</span> applications should use for requests.
                                    </p>
                                 </li>
                                 <li>
                                    <p><span class="bold">Static</span>: (special—on request) A session has a static state if all session state changes, such as NLS settings and PL/SQL package state, can be repeated in an initialization callback. This setting is used only for database diagnostic applications that do not change session state. Do not specify <code class="codeph">STATIC</code> if there are any non-transactional state changes in the request that cannot be reestablished by a callback. If you are unsure what state to specify, use <code class="codeph">DYNAMIC</code>.
                                    </p>
                                 </li>
                              </ul>
                           </li>
                           <li>
                              <p><code class="codeph">-failoverretry</code>: Number of connection retries for each connection attempt; recommended value is 30.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">-failoverdelay</code>: Delay in seconds between each connection attempt; recommended value is 10.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">-notification</code>: FAN is highly recommended—set this value to <code class="codeph">TRUE</code> to enable FAN for OCI and ODP.Net clients.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">-clbgoal</code>: For connection load balancing, use <code class="codeph">SHORT</code> when using run-time load balancing.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">-rlbgoal</code>: For run-time load balancing, set to <code class="codeph">SERVICE_TIME</code>.
                              </p>
                           </li>
                        </ul>
                        <p>To create a service for Application Continuity for a policy-managed Oracle RAC database, use a command similar to the following, where <code class="codeph">racdb</code> is the name of your Oracle RAC database, <code class="codeph">app2</code> is the name of the service you are modifying, and <code class="codeph">Svrpool1</code> is the name of the server pool in which the service is offered:
                        </p><pre class="pre codeblock"><code>$ srvctl add service -db racdb -service app2 -serverpool Srvpool1
  -failovertype TRANSACTION -commit_outcome TRUE -replay_init_time 1800
  -retention 86400 -notification TRUE -rlbgoal SERVICE_TIME -clbgoal SHORT
  -failoverretry 30 -failoverdelay 10</code></pre><p>You can use SRVCTL to modify an existing service for Application Continuity, similar to the following command, where <code class="codeph">racdb</code> is the name of your Oracle RAC database, and <code class="codeph">app1</code> is the name of the service you are modifying:
                        </p><pre class="pre codeblock"><code>$ srvctl modify service -db racdb -service app1 -clbgoal SHORT
  -rlbgoal SERVICE_TIME -failoverretry 30 -failoverdelay 10
  -failovertype TRANSACTION -commit_outcome TRUE -replay_init_time 1800
  -retention 86400 -notification TRUE</code></pre><div class="section">
                           <p class="subhead3" id="GUID-87EDF90F-1776-474A-AD9C-93F9CBE6CB31__GUID-60B8FD2C-824B-4A26-B214-94514108E3BF">Creating Services for Transaction Guard</p>
                        </div>
                        <!-- class="section" -->
                        <p>To enable Transaction Guard, but not Application Continuity, create the service using SRVCTL and set only <code class="codeph">-commit_outcome TRUE</code>.
                        </p>
                        <p>You can use SRVCTL to modify an existing service to enable Transaction Guard, similar to the following command, where <code class="codeph">racdb</code> is the name of your Oracle RAC database, and <code class="codeph">app2</code> is the name of the service you are modifying:
                        </p><pre class="pre codeblock"><code>$ srvctl modify service -db racdb -service app2 -commit_outcome TRUE
  -retention 86400 -notification TRUE</code></pre><p>In the preceding example, the <code class="codeph">-retention</code> parameter specifies how long, in seconds, to maintain the history. Additionally the <code class="codeph">&#x2013;notification</code> parameter is set to <code class="codeph">TRUE</code>, enabling FAN events.
                        </p>
                        <p>To use Transaction Guard, a DBA must grant permission, as follows:</p><pre class="pre codeblock"><code>GRANT EXECUTE ON DBMS_APP_CONT;</code></pre></div>
                     <div>
                        <div class="relinfo">
                           <p><strong>Related Topics</strong></p>
                           <ul>
                              <li><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/racad&amp;id=ADFNS-GUID-6C5880E5-C45F-4858-A069-A28BB25FD1DB" target="_blank"><span><cite>Oracle Database Development Guide</cite></span></a></li>
                           </ul>
                        </div>
                     </div>
                  </div><a id="RACAD7027"></a><div class="sect4"><a id="GUID-35D1F2C6-7A21-4B63-8ED9-69FCAECBA16C" name="GUID-35D1F2C6-7A21-4B63-8ED9-69FCAECBA16C"></a><h5 id="RACAD-GUID-35D1F2C6-7A21-4B63-8ED9-69FCAECBA16C" class="sect5">Starting and Stopping Services with SRVCTL</h5>
                     <div>
                        <p>For applications to connect using a server, the service must be started. If you stop a service, then it is temporarily unavailable, but is still subject to automatic restart and failover.</p>
                        <p>Enter the following SRVCTL syntax at the command line to start or stop a service: </p><pre class="oac_no_warn" dir="ltr">$ srvctl start service -db <span class="italic">db_unique_name</span> [-service <span class="italic"><code class="codeph">service_name_list</code></span>]
    [-instance <span class="italic"><code class="codeph">inst_name</code></span>] [-startoption <span class="italic"><code class="codeph">start_options</code></span>]
</pre><pre class="oac_no_warn" dir="ltr">$ srvctl stop service -db <span class="italic">db_unique_name</span> -service <span class="italic"><code class="codeph">service_name_list</code></span>
    [-instance <span class="italic"><code class="codeph">inst_name</code></span>] [-startoption <span class="italic"><code class="codeph">start_options</code></span>]</pre></div>
                  </div><a id="RACAD7028"></a><div class="sect4"><a id="GUID-4DE433AE-AC47-4591-92A7-866DBE77A930" name="GUID-4DE433AE-AC47-4591-92A7-866DBE77A930"></a><h5 id="RACAD-GUID-4DE433AE-AC47-4591-92A7-866DBE77A930" class="sect5">Enabling and Disabling Services with SRVCTL</h5>
                     <div>
                        <p>If you disable a service, then Oracle Clusterware does not consider the service for automatic startup, failover, or restart. You might disable a service when performing application maintenance, to ensure the service is not accidentally restarted by Oracle Clusterware until your maintenance operations are complete. To make the service available for normal operation again, you enable the service. </p>
                        <p>Use the following SRVCTL syntax from the command line to enable and disable services: </p><pre class="oac_no_warn" dir="ltr">$ srvctl enable service -db <span class="italic"><code class="codeph">db_unique_name</code></span> -service <span class="italic"><code class="codeph">service_name_list</code></span>
    [-instance <span class="italic"><code class="codeph">inst_name</code></span>]</pre><pre class="oac_no_warn" dir="ltr">$ srvctl disable service -db <span class="italic"><code class="codeph">db_unique_name</code></span> -service <span class="italic"><code class="codeph">service_name_list</code></span>
    [-instance <span class="italic"><code class="codeph">inst_name</code></span>]</pre></div>
                  </div><a id="RACAD7029"></a><div class="sect4"><a id="GUID-153EAA56-6E30-48BF-B152-7841E5640EF2" name="GUID-153EAA56-6E30-48BF-B152-7841E5640EF2"></a><h5 id="RACAD-GUID-153EAA56-6E30-48BF-B152-7841E5640EF2" class="sect5">Relocating Services with SRVCTL</h5>
                     <div>
                        <p>Run the <code class="codeph">srvctl relocate service</code> command from the command line to relocate a service. You might use this command when a service has failed over to an available instance, but you want to move it back to the preferred instance after that instance is restarted. 
                        </p>
                        <p>The following command relocates the <code class="codeph">crm</code> service from instance <code class="codeph">apps1</code> to instance <code class="codeph">apps3</code>: 
                        </p><pre class="oac_no_warn" dir="ltr">$ srvctl relocate service -db apps -service crm -oldinst apps1 -newinst apps3
</pre><p>The following command relocates the <code class="codeph">crm</code> service from <code class="codeph">node1</code> to <code class="codeph">node3</code> using node syntax:
                        </p><pre class="oac_no_warn" dir="ltr">$ srvctl relocate service -db apps -service crm -currentnode node1
    -targetnode node3</pre></div>
                  </div><a id="RACAD7030"></a><div class="sect4"><a id="GUID-506E7A9A-D204-4D30-A9CA-523C9FE58587" name="GUID-506E7A9A-D204-4D30-A9CA-523C9FE58587"></a><h5 id="RACAD-GUID-506E7A9A-D204-4D30-A9CA-523C9FE58587" class="sect5">Obtaining the Status of Services with SRVCTL</h5>
                     <div>
                        <p>Run the <code class="codeph">srvctl status service</code> command from the command line to obtain the status of a service. For example, the following command returns the status of the services that are running on the <code class="codeph">apps</code> database: 
                        </p><pre class="oac_no_warn" dir="ltr">$ srvctl status service -db apps

Service erp is running on nodes: apps02,apps03
Service hr is running on nodes: apps02,apps03
Service sales is running on nodes: apps01,apps04</pre></div>
                  </div><a id="RACAD7316"></a><div class="sect4"><a id="GUID-EBEFA349-1DD9-4978-B96B-0E0B092BE41D" name="GUID-EBEFA349-1DD9-4978-B96B-0E0B092BE41D"></a><h5 id="RACAD-GUID-EBEFA349-1DD9-4978-B96B-0E0B092BE41D" class="sect5">Obtaining the Configuration of Services with SRVCTL</h5>
                     <div>
                        <p>Run the <code class="codeph">srvctl config service</code> command from the command line to obtain the high availability configuration of a service. For example, the following command returns the configuration of the <code class="codeph">erp</code> service that is running on the <code class="codeph">apps</code> database:
                        </p><pre class="pre codeblock"><code><span class="bold">$ srvctl config service -db apps -service erp</span>

Service name: erp
Service is enabled
Server pool: pool1
Cardinality: 1
Disconnect: false
Service role: PRIMARY
Management policy: AUTOMATIC
DTP transaction: false
AQ HA notifications: true
Global: false
Commit Outcome: true
Failover type: TRANSACTION
Failover method: NONE
TAF failover retries: 30
TAF failover delay: 10
Connection Load Balancing Goal: LONG
Runtime Load Balancing Goal: SERVICE_TIME
TAF policy specification: NONE
Edition:
Pluggable database name:
Maximum lag time: ANY
SQL Translation Profile:
Retention: 86400 seconds
Replay Initiation Time: 1800 seconds
Session State Consistency: STATIC
Preferred instances: apps
Available instances:</code></pre></div>
                  </div>
               </div>
            </div><a id="RACAD8419"></a><div class="sect2"><a id="GUID-4C9FACD5-E959-4C79-A962-EFACBBC46545" name="GUID-4C9FACD5-E959-4C79-A962-EFACBBC46545"></a><h3 id="RACAD-GUID-4C9FACD5-E959-4C79-A962-EFACBBC46545" class="sect3">Global Services</h3>
               <div>
                  <p>Oracle RAC supports database services and enables service-level workload management across instances in a single cluster.</p>
                  <p>Global services provide dynamic load balancing, failover, and centralized service management for a set of replicated databases that offer common services. The set of databases may include Oracle RAC and non-clustered Oracle databases interconnected by Oracle Data Guard, Oracle GoldenGate, or any other replication technology.</p>
                  <p>When you create and use global services, the following workload management features are available:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Ability to specify preferred and available databases for a global service</p>
                     </li>
                     <li>
                        <p>Handling of replication lag</p>
                     </li>
                     <li>
                        <p>Geographical affinity between clients and servers</p>
                     </li>
                     <li>
                        <p>Connection load balancing</p>
                     </li>
                     <li>
                        <p>Run-time load balancing</p>
                     </li>
                     <li>
                        <p>Inter-database service failover</p>
                     </li>
                     <li>
                        <p>Fast connection failover</p>
                     </li>
                     <li>
                        <p>Connect-time failover</p>
                     </li>
                     <li>
                        <p>Application Continuity</p>
                     </li>
                     <li>
                        <p>Transaction Guard</p>
                     </li>
                     <li>
                        <p>Backward compatibility with existing clients</p>
                     </li>
                  </ul>
                  <div class="infoboxnote" id="GUID-4C9FACD5-E959-4C79-A962-EFACBBC46545__GUID-E742F3FE-0405-4BB5-A716-F85DA5A0B034">
                     <p class="notep1">Note:</p>
                     <p>You can manage instance placement of a global service within an Oracle RAC database with SRVCTL but you can only manage other global service attributes with GDSCTL.</p>
                  </div>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/racad&amp;id=GSMUG-GUID-04D33448-2CB4-40C7-9DA0-1CFC6EC5E101" target="_blank"><span><cite>Oracle Database Global Data Services Concepts and Administration Guide</cite></span></a></li>
                     </ul>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-20E8DA7D-EDE0-4B6D-9A4A-E54AD5B965A2" name="GUID-20E8DA7D-EDE0-4B6D-9A4A-E54AD5B965A2"></a><h3 id="RACAD-GUID-20E8DA7D-EDE0-4B6D-9A4A-E54AD5B965A2" class="sect3">Service-Oriented Buffer Cache Access</h3>
               <div>
                  <p>Service-oriented buffer cache access improves performance by managing data with the service to which the data belongs.</p>
                  <p>Access of an object, over time, through a service is mapped and persisted to the database, and this information can be used to improve performance. Blocks that are accessed through the service are cached in the instances where the services are running and, more importantly, the information is not cached where the services are not running.</p>
                  <p>This information can also be used to pre-warm the cache prior to a service starting. The service start-up can be triggered either by instance start-up or by service relocation. Service-oriented buffer cache access provides consistent performance to any user of that service because the blocks that the service user accesses are cached in the new relocated instance.</p>
               </div>
            </div><a id="RACAD8849"></a><a id="RACAD8850"></a><a id="RACAD8848"></a><div class="sect2"><a id="GUID-6552E661-CB51-462C-8C0C-02CEE4E50001" name="GUID-6552E661-CB51-462C-8C0C-02CEE4E50001"></a><h3 id="RACAD-GUID-6552E661-CB51-462C-8C0C-02CEE4E50001" class="sect3">Connecting to a Service: An Example</h3>
               <div>
                  <p>The following example illustrates how to create a service and then gives several examples of connecting to that service using different client methods.</p>
                  <p>In this example the service is enabled for run-time load balancing, as follows:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Service Name: <code class="codeph">HR.example.com</code></p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Running on database named CRM</p>
                           </li>
                           <li>
                              <p>The system consists of 4 nodes</p>
                           </li>
                        </ul>
                     </li>
                     <li>
                        <p>Specifying <code class="codeph">SERVICE_TIME</code> as the value for the <code class="codeph">-rlbgoal</code> parameter
                        </p>
                     </li>
                     <li>
                        <p>SCAN address of the listener is <code class="codeph">rws3010104-scan.example.com</code></p>
                     </li>
                     <li>
                        <p>Listener port is 1585</p>
                     </li>
                  </ul>
                  <p>The service has a cardinality of two, but if needed, can be offered by any of the CRM database instances. The service configuration is as follows:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Preferred Instances: CRM1, CRM2</p>
                     </li>
                     <li>
                        <p>Available Instances: CRM3, CRM4</p>
                     </li>
                     <li>
                        <p>Specifying <code class="codeph">SHORT</code> as the value for the <code class="codeph">-clbgoal</code> parameter
                        </p>
                     </li>
                  </ul>
                  <p>The application using this service takes advantage of Application Continuity, so you must set <code class="codeph">-failovertype</code> and <code class="codeph">-commit_outcome</code>. Use the default retention parameters, but set a 10 second delay between connection attempts, and up to 40 retries before failing to get a connection.
                  </p>
                  <div class="section">
                     <p class="subhead2" id="GUID-6552E661-CB51-462C-8C0C-02CEE4E50001__GUID-D7F85E96-023B-4278-B6DF-FC419D9A17E8">Creating the HR Service Using SRVCTL</p>
                  </div>
                  <!-- class="section" -->
                  <p>Create the HR service using SRVCTL, as follows:</p><pre class="pre codeblock"><code>$ srvctl add service &#x2013;db CRM &#x2013;service HR.example.com &#x2013;preferred CRM1,CRM2
  &#x2013;available CRM3,CRM4 &#x2013;clbgoal SHORT &#x2013;failovertype TRANSACTION
  &#x2013;commit_outcome TRUE &#x2013;failoverdelay 10 &#x2013;failoverretry 40</code></pre><p>Start the <code class="codeph">HR.example.com</code> service, as follows:
                  </p><pre class="pre codeblock"><code>$ srvctl start service &#x2013;db CRM &#x2013;service HR.example.com</code></pre><p>The service is now be available on up to two instances, and CRM1 and CRM2 are the preferred instances.</p>
                  <div class="section">
                     <p class="subhead2" id="GUID-6552E661-CB51-462C-8C0C-02CEE4E50001__GUID-4A2AEB8E-4F70-4552-AD48-8F2F97B92671">Connecting to the HR Service from a JDBC Application</p>
                  </div>
                  <!-- class="section" -->
                  <p>The application that connects to the HR service, in this example, is a JDBC application using the JDBC Universal Connection Pool with the JDBC thin driver.</p>
                  <p>In this example, a URL is constructed specifying the thin-style service name format for the database specifier. Fast Connection Failover is enabled, and remote Oracle Notification Service is configured, where the Oracle Notification Service daemon on the cluster listens on port 6200.</p><pre class="pre codeblock"><code>//import packages and register the driver
import java.sql.Connection;
import java.sql.SQLException;
import java.sql.Statement;
import oracle.ucp.jdbc.PoolDataSourceFactory;
import oracle.ucp.jdbc.PoolDataSource;

PoolDataSource  pds = PoolDataSourceFactory.getPoolDataSource();

//set the connection properties on the data source.
pds.setConnectionPoolName("FCFPool");
pds.setFastConnectionFailoverEnabled(true);
pds.setONSConfiguration("nodes=rws3010104-scan.example.com:6200");
pds.setConnectionFactoryClassName("oracle.jdbc.pool.OracleDataSource");
pds.setURL("jdbc:oracle:thin:@//rws3010104-scan.example.com:1585/HR.example.com");
pds.setUser("HR");
pds.setPassword("hr"); 
    
 
//Override any pool properties.
pds.setInitialPoolSize(5);
 
//Get a database connection from the datasource.
 
Connection conn = pds.getConnection();
 
// do some work
 
//return connection to pool
conn.close();
conn=null</code></pre></div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/racad&amp;id=JJUCP-GUID-82ACD002-4C5F-4BF7-99FF-46A2A97DD35D" target="_blank"><span><cite>Oracle Universal Connection Pool Developer’s Guide</cite></span></a></li>
                     </ul>
                  </div>
               </div>
            </div>
            <hr><br><p style="text-decoration:underline">Footnote Legend</p>Footnote&nbsp;1: 
            <p>Run-time connection load balancing is basically routing work requests to sessions in a session pool that can best serve the work. It comes into effect when selecting a session from an existing session pool. Thus, run-time connection load balancing is a very frequent activity.</p><br></div>
      </article>
   </body>
</html>