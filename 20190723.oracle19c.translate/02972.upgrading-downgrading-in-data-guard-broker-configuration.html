<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="Use these topics to upgrade or downgrade Oracle databases and Oracle Enterprise Manager Cloud Control (Cloud Control) in a broker configuration."></meta>
      <meta name="description" content="Use these topics to upgrade or downgrade Oracle databases and Oracle Enterprise Manager Cloud Control (Cloud Control) in a broker configuration."></meta>
      <title>Oracle Data Guard Broker升级和降级</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Broker "></meta>
      <meta property="og:description" content="Use these topics to upgrade or downgrade Oracle databases and Oracle Enterprise Manager Cloud Control (Cloud Control) in a broker configuration."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Broker"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="data-guard-broker.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-03-29T04:14:25-07:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="1999, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96245-02"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="troubleshooting-oracle-data-guard-broker.html" title="Previous" type="text/html"></link>
      <link rel="next" href="glossary.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Data Guard Broker"></meta>
    <meta name="dcterms.isVersionOf" content="DGBKR"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="troubleshooting-oracle-data-guard-broker.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="glossary.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">经纪人</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Oracle Data Guard Broker升级和降级</li>
            </ol>
            <a id="GUID-82682FF3-6052-471B-B581-5E91183A5432" name="GUID-82682FF3-6052-471B-B581-5E91183A5432"></a><a id="DGBKR1200"></a>
            
            <h2 id="DGBKR-GUID-82682FF3-6052-471B-B581-5E91183A5432" class="sect2"><span class="enumeration_chapter">一个</span> Oracle数据卫士代理升级和降级</h2>
         </header>
         <div class="ind">
            <div>
               <p>使用这些主题可以在代理配置中升级或降级Oracle数据库和Oracle Enterprise Manager云控制（云控制）。</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="upgrading-downgrading-in-data-guard-broker-configuration.html#GUID-3527435A-F658-48CE-8C0B-1A7642A273CA" title="如果您当前正在Oracle Database 9i第2版（9.2）中运行代理配置，则必须升级到Oracle Database 12c第1版（12.1）或Oracle Database 12c第2版（12.2），然后重新创建代理配置。">从Oracle Database 9i第2版（9.2）升级到Oracle Database 12c</a></p>
                  </li>
                  <li>
                     <p><a href="upgrading-downgrading-in-data-guard-broker-configuration.html#GUID-9B424C49-A005-4106-9EF8-CB7479F9ACB8" title="如果您当前正在Oracle Database 10g或Oracle Database 11g上运行Oracle Data Guard，则可以使用Oracle数据库安装文档将数据库软件升级到Oracle Database 12c第1版（12.1）或Oracle Database 12c第2版（12.2）。适合您的操作系统。">从Oracle数据库10g和Oracle Database 11g升级到Oracle Database 12c</a></p>
                  </li>
                  <li>
                     <p><a href="upgrading-downgrading-in-data-guard-broker-configuration.html#GUID-1BBDBE43-3227-43FF-BE71-0CE1CA9FEB96" title="如果已升级到Oracle Database 12c第1版（12.1）或Oracle Database 12c第2版（12.2）并希望降级到先前版本，则必须降级数据库版本并重新创建代理配置。">从Oracle Database 12c降级</a></p>
                  </li>
               </ul>
               <div class="infoboxnotealso" id="GUID-82682FF3-6052-471B-B581-5E91183A5432__GUID-3EAE7950-2714-42DF-AED2-4FBB2CCF94E2">
                  <p class="notep1">也可以看看：</p>
                  <p><a href="oracle-data-guard-broker-installation-requirements.html#GUID-21393DF3-FD7E-44AA-A90C-6533E03CBDDA" title="对于要添加到代理配置的所有成员，必须完成安装和配置任务。">Oracle Data Guard安装</a></p>
               </div>
            </div><a id="DGBKR1210"></a><div class="props_rev_3"><a id="GUID-3527435A-F658-48CE-8C0B-1A7642A273CA" name="GUID-3527435A-F658-48CE-8C0B-1A7642A273CA"></a><h3 id="DGBKR-GUID-3527435A-F658-48CE-8C0B-1A7642A273CA" class="sect3"><span class="enumeration_section">A.1</span>从Oracle Database 9 <span class="italic">i</span> Release 2（9.2）升级到Oracle Database 12 <span class="italic">c</span></h3>
               <div>
                  <p>如果您当前正在Oracle Database 9 <span class="italic">i</span>第2版（9.2）中运行代理配置，则必须升级到Oracle Database 12 <span class="italic">c</span>第1版（12.1）或Oracle Database 12 <span class="italic">c</span>第2版（12.2），然后重新创建经纪人配置。
                  </p>
                  <div class="section">
                     <p>以下步骤使用Oracle Database 12 <span class="italic">c</span>第2版（12.2），但您可以替换Oracle Database 12 <span class="italic">c</span>第1版（12.1）。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>删除（删除）Oracle Database 9 <span class="italic">i</span> Release 2（9.2）代理配置。例如，可以使用DGMGRL <code class="codeph">REMOVE CONFIGURATION</code>命令。要执行删除，您必须使用在Oracle Database 9 <span class="italic">i</span> Release 2（9.2）上运行的Oracle Data Guard Manager或DGMGRL。</span></li>
                     <li class="stepexpand"><span>如果使用DGMGRL，请使用<code class="codeph">ALTER SYSTEM SET LOG_ARCHIVE_DEST_</code> <span class="variable" translate="no">n</span> <code class="codeph">=" "</code> SQL * Plus命令清除<code class="codeph">LOG_ARCHIVE_DEST_</code> <span class="italic"><code class="codeph">n</code></span>初始化参数设置。</span></li>
                     <li class="stepexpand"><span>将数据库软件升级到Oracle Database 12 <span class="italic">c</span>第2版（12.2）。请参阅适用于您的操作系统的Oracle数据库安装文档。</span></li>
                     <li class="stepexpand"><span>在Oracle Database 9 <span class="italic">i</span> Release 2（9.2）上运行的Oracle Enterprise Manager和Oracle Data Guard Manager无法管理在Oracle Database 12 <span class="italic">c</span>第2版（12.2）上运行的代理配置。</span><div>
                           <div class="infoboxnotealso" id="GUID-3527435A-F658-48CE-8C0B-1A7642A273CA__GUID-EE3BE325-32C9-4646-8A33-B19D91DC43ED">
                              <p class="notep1">也可以看看：</p>
                              <p>有关在各种Oracle数据库版本中管理全套Oracle Data Guard功能所需的企业管理器云控制（以前称为网格控制）版本的信息，请参阅<a href="http://support.oracle.com" target="_blank"><code class="codeph">http://support.oracle.com</code></a> My Oracle Support说明787461.1。</p>
                           </div>
                        </div>
                     </li>
                     <li class="stepexpand"><span>如果您使用的是在Oracle Database 9 <span class="italic">i</span> Release 2（9.2）上运行的DGMGRL，则必须升级到在Oracle Database 12 <span class="italic">c</span> Release 2（12.2）上运行的DGMGRL：</span><div>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>在Oracle Database 9 <span class="italic">i</span> Release 2（9.2）上运行的DGMGRL与在Oracle Database 12 <span class="italic">c</span>第2版（12.2）上运行的Oracle Data Guard不兼容。
                                 </p>
                              </li>
                              <li>
                                 <p>在Oracle Database 12 <span class="italic">c</span> Release 2（12.2）上运行的DGMGRL与在Oracle Database 9 <span class="italic">i</span> Release 2（9.2）上运行的Oracle Data Guard不兼容。
                                 </p>
                                 <div class="infoboxnote" id="GUID-3527435A-F658-48CE-8C0B-1A7642A273CA__GUID-EB7C3A36-DF28-469C-A444-30CEA3FBD980">
                                    <p class="notep1">注意：</p>
                                    <p>Oracle9 <span class="italic">i</span>不支持Oracle Database <span class="italic">12c</span>命令行脚本。
                                    </p>
                                 </div>
                              </li>
                           </ul>
                        </div>
                     </li>
                     <li class="stepexpand"><span>调用Enterprise Manager或DGMGRL命令行界面，然后重新创建代理配置。</span></li>
                  </ol>
               </div>
            </div><a id="DGBKR1212"></a><div class="props_rev_3"><a id="GUID-9B424C49-A005-4106-9EF8-CB7479F9ACB8" name="GUID-9B424C49-A005-4106-9EF8-CB7479F9ACB8"></a><h3 id="DGBKR-GUID-9B424C49-A005-4106-9EF8-CB7479F9ACB8" class="sect3"><span class="enumeration_section">A.2</span>从Oracle Database <span class="italic">10g</span>和Oracle Database <span class="italic">11g</span>升级到Oracle Database 12 <span class="italic">c</span> 
               </h3>
               <div>
                  <p>如果当前在Oracle数据库<span class="italic">10g</span>或Oracle数据库<span class="italic">11克</span>运行Oracle数据卫士，则可以将数据库升级软件使用Oracle数据库Oracle数据库<span class="italic">12c的</span>版本1（12.1）或Oracle数据库<span class="italic">12c的</span>第2版（12.2）适用于您的操作系统的安装文档。
                  </p>
                  <div class="section">
                     <p></p>
                     <div class="infoboxnote" id="GUID-9B424C49-A005-4106-9EF8-CB7479F9ACB8__GUID-1117FF7B-BA49-44BC-90F9-3C9286F29341">
                        <p class="notep1">注意：</p>
                        <p>在Oracle Database <span class="italic">11g</span>第2版（11.2）之前，配置文件仅限于驻留在与最初创建文件时具有相同扇区大小（物理块大小）的磁盘上。这不是问题，因为在给定的代理配置中通常使用单个扇区大小。由于预期在给定代理配置中某处具有混合扇区大小，因此代理配置文件现在对基础扇区大小完全不敏感，只要扇区大小为4KB或更小。
                        </p>
                        <p>在下面的步骤5中的升级处理期间，将配置文件的转换发生为对基础扇区大小不敏感。</p>
                     </div>
                     <p>以下步骤使用Oracle Database 12 <span class="italic">c</span>第2版（12.2），但您可以替换Oracle Database 12 <span class="italic">c</span>第1版（12.1）。
                     </p>
                     <ol>
                        <li>
                           <p>发出以下DGMGRL命令以禁用快速启动故障转移：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt;禁用FAST_START FAILOVER;</pre></li>
                        <li>
                           <p>关闭10.n或11.n Oracle Data Guard代理，无论您运行的是哪个版本。</p>
                           <ol type="a">
                              <li>
                                 <p>发出以下DGMGRL命令以禁用代理在Oracle Data Guard配置中对数据库的主动管理：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt;禁用配置;</pre></li>
                              <li>
                                 <p>发出以下SQL * Plus语句以停止代理：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; ALTER SYSTEM SET DG_BROKER_START = FALSE;</pre></li>
                           </ol>
                        </li>
                        <li>
                           <p>制作当前代理配置文件的副本，如以下初始化参数所示： <code class="codeph">DG_BROKER_CONFIG_FILE1</code>和<code class="codeph">DG_BROKER_CONFIG_FILE2</code> 。
                           </p>
                        </li>
                        <li>
                           <p>将Oracle数据库软件升级到Oracle Database 12 <span class="italic">c</span>第2版（12.2）。有关逐步升级说明，请参阅适用于您的操作系统的Oracle数据库安装文档。
                           </p>
                           <p>还必须升级DGMGRL命令行界面，以便管理和监视在Oracle Database 12 <span class="italic">c</span>第2版（12.2）上运行的代理配置。在Oracle Database 12 <span class="italic">c</span> Release 2（12.2）上运行的DGMGRL不能用于管理在Oracle Database <span class="italic">10g</span>或Oracle Database <span class="italic">11g</span>上运行的Oracle Data Guard。
                           </p>
                           <div class="infoboxnote" id="GUID-9B424C49-A005-4106-9EF8-CB7479F9ACB8__GUID-E12902C8-160D-40B9-A54F-C7E824F83E86">
                              <p class="notep1">注意：</p>
                              <p>Oracle Database 12 <span class="italic">c</span>第2版（12.2）中提供的DGMGRL命令行界面支持Oracle Database <span class="italic">10g</span>和Oracle Database <span class="italic">11g的</span>现有DGMGRL命令行脚本。
                              </p>
                              <p>Oracle数据库<span class="italic">11克</span> DGMGRL命令行脚本不能保证由Oracle数据库<span class="italic">10g</span>支撑。
                              </p>
                           </div>
                        </li>
                        <li>
                           <p>升级到Oracle Database 12 <span class="italic">c</span>第2版（12.2）后，启动代理。例如：</p>
                           <ol type="a">
                              <li>
                                 <p>发出以下SQL * Plus语句以启动代理：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; ALTER SYSTEM SET DG_BROKER_START = TRUE;</pre></li>
                              <li>
                                 <p>发出以下DGMGRL命令以启用代理对Oracle Data Guard配置中的数据库的主动管理：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; ENABLE CONFIGURATION;</pre></li>
                           </ol>
                           <p>代理首次在Oracle Database 12 <span class="italic">c</span> Release 2（12.2）上启动时，它会检测到Oracle Database <span class="italic">10g</span>和Oracle Database 11 <span class="italic">g</span>代理配置文件的存在。它会自动升级它们以包含Oracle Database 12 <span class="italic">c</span>第2版（12.2）中引入的所有新属性。此自动转换是透明的，永久性的，并且只发生一次。
                           </p>
                           <div class="infoboxnote" id="GUID-9B424C49-A005-4106-9EF8-CB7479F9ACB8__GUID-9E1EB759-3F30-43DF-B63C-640C3F3B47F4">
                              <p class="notep1">注意：</p>
                              <p>从步骤5中发生的这种自动升级开始，配置文件此后可以驻留在具有任何支持的磁盘扇区大小（物理块大小）直到并包括4KB扇区的磁盘上。</p>
                           </div>
                        </li>
                     </ol>
                     <div class="infoboxnote" id="GUID-9B424C49-A005-4106-9EF8-CB7479F9ACB8__GUID-6AD5FEB9-0F82-4758-8297-BFC8A5D2B17E">
                        <p class="notep1">注意：</p>
                        <p>升级之前启动的观察器将自动停止，并且在升级完成后无法观察配置。您必须使用Oracle Database 12 <span class="italic">c</span>版本的Oracle Observer软件来观察在Oracle Database 12 <span class="italic">c</span>第2版（12.2）或更高版本上运行的Oracle数据库。
                        </p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="DGBKR1215"></a><div class="props_rev_3"><a id="GUID-1BBDBE43-3227-43FF-BE71-0CE1CA9FEB96" name="GUID-1BBDBE43-3227-43FF-BE71-0CE1CA9FEB96"></a><h3 id="DGBKR-GUID-1BBDBE43-3227-43FF-BE71-0CE1CA9FEB96" class="sect3"><span class="enumeration_section">A.3</span>从Oracle Database 12降级<span class="italic">c</span></h3>
               <div>
                  <p>如果已升级到Oracle Database 12 <span class="italic">c</span>第1版（12.1）或Oracle Database 12 <span class="italic">c</span>第2版（12.2）并希望降级到先前版本，则必须降级数据库版本并重新创建代理配置。
                  </p>
                  <div class="section">
                     <p>执行以下步骤（这些步骤使用Oracle Database 12c第2版（12.2），但您可以替换Oracle Database 12 <span class="italic">c</span>第1版（12.1））。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>使用在Oracle Database 12 <span class="italic">c</span>第2版（12.2）上运行的Enterprise Manager或DGMGRL删除（删除）Oracle Database 12 <span class="italic">c</span>第2版（12.2）代理配置。例如，可以使用DGMGRL <code class="codeph">REMOVE CONFIGURATION</code>命令。</span></li>
                     <li class="stepexpand"><span>将Oracle数据库软件降级到之前的Oracle版本。请参阅适用于您的操作系统的Oracle数据库文档。</span></li>
                     <li class="stepexpand"><span>您可以将Oracle Data Guard代理降级到Oracle Database <span class="italic">10g</span>或Oracle Database <span class="italic">11g</span> ，如下所示：</span><div>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>如果您确信在升级到Oracle Database 12 <span class="italic">c</span>第2版（12.2）后未对代理配置进行任何更改，则可以复制在升级过程中创建的代理配置文件（如<a href="upgrading-downgrading-in-data-guard-broker-configuration.html#GUID-9B424C49-A005-4106-9EF8-CB7479F9ACB8" title="如果您当前正在Oracle Database 10g或Oracle Database 11g上运行Oracle Data Guard，则可以使用Oracle数据库安装文档将数据库软件升级到Oracle Database 12c第1版（12.1）或Oracle Database 12c第2版（12.2）。适合您的操作系统。">从Oracle Database 10g升级和Oracle Database 11g到Oracle Database 12c</a> ）。然后，调用企业管理器或DGMGRL命令行界面，并重新启用您在复制时存在的代理配置。
                                 </p>
                              </li>
                              <li>
                                 <p>或者，您可以调用Enterprise Manager或DGMGRL命令行界面来重新创建代理配置。</p>
                              </li>
                           </ul>
                        </div>
                     </li>
                     <li class="stepexpand"><span>您可以将Oracle Data Guard代理降级到Oracle Database 9 <span class="italic">i</span> Release 2（9.2），如下所示：</span><div>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>如果您使用的是Oracle Enterprise Manager，则可以继续在Oracle Database <span class="italic">10g</span>第2版（10.2）上运行它来管理Oracle Database 9 <span class="italic">i</span> Release 2（9.2）代理配置。您还可以通过重新安装Oracle Database 9 <span class="italic">i</span> Release 2（9.2）企业管理器来降级到Oracle Data Guard Manager。
                                 </p>
                              </li>
                              <li>
                                 <p>调用Enterprise Manager，Oracle Data Guard Manager或DGMGRL命令行界面，然后重新创建代理配置。</p>
                              </li>
                           </ul>
                        </div>
                     </li>
                  </ol>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>