<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="You can use Oracle Database Vault in a multitenant container database (CDB)."></meta>
      <meta name="description" content="You can use Oracle Database Vault in a multitenant container database (CDB)."></meta>
      <title>将Oracle Database Vault与CDB一起使用</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Administrator’s Guide "></meta>
      <meta property="og:description" content="You can use Oracle Database Vault in a multitenant container database (CDB)."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Administrator’s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="multitenant-administrators-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-03-20T09:59:22-07:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2017, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96136-03"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="using-oracle-scheduler-with-a-cdb.html" title="Previous" type="text/html"></link>
      <link rel="next" href="using-xstream-with-a-cdb.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Multitenant Administrator&#39;s Guide"></meta>
    <meta name="dcterms.isVersionOf" content="MULTI"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="using-oracle-scheduler-with-a-cdb.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="using-xstream-with-a-cdb.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">管理员指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="using-oracle-features-in-a-multitenant-environment.html" property="item" typeof="WebPage"><span property="name">在多租户环境中使用Oracle功能</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">将Oracle Database Vault与CDB一起使用</li>
            </ol>
            <a id="GUID-5CD1D1E7-2435-4331-876F-34C5AE04BAD3" name="GUID-5CD1D1E7-2435-4331-876F-34C5AE04BAD3"></a>
            
            <h2 id="MULTI-GUID-5CD1D1E7-2435-4331-876F-34C5AE04BAD3" class="sect2"><span class="enumeration_chapter">24</span>将Oracle Database Vault与CDB一起使用</h2>
         </header>
         <div class="ind">
            <div>
               <p>您可以在多租户容器数据库（CDB）中使用Oracle Database Vault。</p>
               <p>本节包含以下主题：</p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-59526942-DC4F-489B-819E-D4F33BA17F9D">关于Oracle Database Vault</a><br>Oracle Database Vault安全控制可保护应用程序数据免受未经授权的访问，并符合隐私和法规要求。
                  </li>
                  <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-F4182518-DEFF-4433-9593-0D73315DF661">Oracle Database Vault如何在多租户环境中运行</a><br>为了提高整合的安全性，您可以将Oracle Database Vault与Oracle Multitenant一起使用。
                  </li>
                  <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-B5569AED-AC16-482C-BA6D-34E275F016D2">验证是否已配置并启用数据库保管库</a><br><code class="codeph">DBA_DV_STATUS</code> ， <code class="codeph">CDB_DV_STATUS</code> ， <code class="codeph">DBA_OLS_STATUS</code>和<code class="codeph">CDB_OLS_STATUS</code>数据字典视图验证是否已配置并启用Oracle数据库。
                  </li>
                  <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-68558E32-ABD0-4495-8677-4F9E09283E5D">在多租户环境中向Oracle数据库注册Oracle Database Vault</a><br>您可以基于多种方案在多租户环境中注册Oracle Database Vault。
                  </li>
                  <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-86DA4697-8BE2-4F27-92E3-C15843F9A3A6">配置领域</a><br>您可以围绕数据库对象创建领域以保护它们，然后设置授权以控制用户对此数据的访问。
                  </li>
                  <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-6308CB8B-6777-44AF-A523-F1A956591F6D">多租户环境中的规则集和规则</a><br>在多租户环境中，您可以在应用程序根目录中创建规则集及其关联规则。
                  </li>
                  <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-571C5AF1-909C-4A76-BE2B-9BAC5232FE84">多租户环境中的命令规则</a><br>在多租户环境中，您可以在CDB根目录或应用程序根目录中创建公共和本地命令规则。
                  </li>
                  <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-07513135-CB45-4788-A596-E5A71879BB81">多租户环境中的Oracle Database Vault策略</a><br>Oracle Database Vault策略仅在创建它们的可插拔数据库（PDB）本地。
                  </li>
                  <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-E04CBDD1-17F0-4942-BF78-21C340A4425F">使用Database Vault Operations Control限制多租户公共用户对本地PDB数据的访问</a><br>您可以通过CDB根公共用户（例如基础结构数据库管理员）控制PDB访问。
                  </li>
                  <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-517E9611-546B-43D9-8C54-37037AF0B198">将独立Oracle数据库转换为PDB并将其插入CDB</a><br>您可以将独立的Oracle Database Release 12c或更高版本的数据库转换为PDB，然后将此PDB插入CDB。</li>
               </ul>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>父主题：</strong> <a href="using-oracle-features-in-a-multitenant-environment.html#GUID-CE922DAA-66FB-430B-96E5-29FF50BFD2FF" title="您可以在多租户环境中使用Oracle数据库功能。">在多租户环境中使用Oracle功能</a></p>
                  </div>
               </div>
            </div>
            
            <div class="props_rev_3"><a id="GUID-59526942-DC4F-489B-819E-D4F33BA17F9D" name="GUID-59526942-DC4F-489B-819E-D4F33BA17F9D"></a><h3 id="MULTI-GUID-59526942-DC4F-489B-819E-D4F33BA17F9D" class="sect3"><span class="enumeration_section">24.1</span>关于Oracle Database Vault</h3>
               <div>
                  <p>Oracle Database Vault安全控制可保护应用程序数据免受未经授权的访问，并符合隐私和法规要求。</p>
                  <p>您可以部署控件以阻止对应用程序数据的特权帐户访问，并使用受信任路径授权控制数据库内的敏感操作。通过对特权和角色的分析，您可以使用最小特权最佳实践来提高现有应用程序的安全性。Oracle Database Vault透明地保护现有数据库环境，从而消除了代价高昂且耗时的应用程序更改。</p>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="../dvadm/introduction-to-oracle-database-vault.html#DVADM-GUID-0C8AF1B2-6CE9-4408-BFB3-7B2C7F9E7284" target="_blank"><span><cite>Oracle Database Vault管理员指南</cite></span></a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-5CD1D1E7-2435-4331-876F-34C5AE04BAD3" title="您可以在多租户容器数据库（CDB）中使用Oracle Database Vault。">将Oracle Database Vault与CDB一起使用</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="props_rev_3"><a id="GUID-F4182518-DEFF-4433-9593-0D73315DF661" name="GUID-F4182518-DEFF-4433-9593-0D73315DF661"></a><h3 id="MULTI-GUID-F4182518-DEFF-4433-9593-0D73315DF661" class="sect3"><span class="enumeration_section">24.2</span> Oracle Database Vault在多租户环境中的工作原理</h3>
               <div>
                  <p>为了提高整合的安全性，您可以将Oracle Database Vault与Oracle Multitenant一起使用。</p>
                  <p>Oracle Database Vault可以阻止可插拔数据库（PDB）内的特权用户访问以及PDB与容器数据库中的公共特权用户之间的特权用户访问。每个PDB都有自己的Database Vault元数据，例如领域，规则集，命令规则，默认策略（例如默认域）等。此外， <code class="codeph">DVSYS</code>和<code class="codeph">DVF</code>模式中的对象可自动用于任何子PDB。两种模式都是常见的用户模式。
                  </p>
                  <p>您只能在应用程序根目录中配置公共领域，但可以在应用程序根目录或CDB根目录中创建通用规则集和命令规则。应用程序根目录中的公共命令规则适用于其关联的PDB，CDB根目录中的公共命令规则适用于CDB环境中的所有PDB。通过创建通用领域和命令规则，您可以创建在整个CDB环境中使用共享领域，规则集或命令规则的策略，而不必为多租户环境中的每个PDB创建这些相同的组件。通用保护适用于与启用了Oracle Database Vault的应用程序根关联的所有PDB。</p>
                  <p>您可以为每个PDB创建单独的本地策略。使用Database Vault保护对象时，Database Vault会将公共对象的公共权限设置为与本地系统权限相同的强制规则。</p>
                  <p>配置启用了数据库保管库的PDB时， <code class="codeph">DVSYS</code>模式是存储在根目录中的公共用户模式。这意味着<code class="codeph">DVSYS</code>架构中的所有对象（表，数据字典视图，用户帐户，PL / SQL包，默认策略等）都受此架构可用的公共权限的约束。换句话说，您可以在根目录中创建领域，因子等，以保护根中的架构。在关联的PDB中配置Database Vault之前，请确保先在根目录中配置Database Vault。
                  </p>
                  <p>在CDB根目录中启用Oracle Database Vault时，可以选择常规模式或严格模式。设置根据您选择的设置在整个CDB中传播。例如，假设CDB包含启用了Database Vault的PDB和未启用Database Vault的PDB。如果使用常规模式启用Database Vault，则两种类型的PDB将继续正常运行。如果使用严格模式启用Database Vault，则禁用Database Vault的PDB将以受限模式运行。</p>
                  <p><a href="using-oracle-database-vault-with-a-cdb.html#GUID-F4182518-DEFF-4433-9593-0D73315DF661__CHDGHEHH">图24-1</a>说明了常规模式下的数据库如何允许对公共和本地数据库管理员进行不同的访问，具体取决于是否启用了Database Vault。在这种情况下，普通用户和本地用户都无法访问PDB1和PDB2中的域。普通用户和PDB3本地用户都可以访问PDB3中的自定义应用程序应用程序，其中未启用Database Vault。
                  </p>
                  <div class="figure" id="GUID-F4182518-DEFF-4433-9593-0D73315DF661__CHDGHEHH">
                     <p class="titleinfigure">图24-1具有常规模式的多租户环境中的Oracle Database Vault</p><img src="img/dvadm_vm_005c.png" alt="下面是图24-1的描述" title="下面是图24-1的描述" longdesc="img_text/dvadm_vm_005c.html"><br><a href="img_text/dvadm_vm_005c.html">“图24-1具有常规模式的多租户环境中的Oracle Database Vault”的说明</a></div>
                  <!-- class="figure" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="using-oracle-database-vault-with-a-cdb.html#GUID-72403156-3E91-43FD-8D06-859DBBC10568" title="在多租户环境中，您可以创建领域以保护应用程序根目录中的公共对象。">多租户环境中的领域</a></li>
                        <li><a href="using-oracle-database-vault-with-a-cdb.html#GUID-6308CB8B-6777-44AF-A523-F1A956591F6D" title="在多租户环境中，您可以在应用程序根目录中创建规则集及其关联规则。">多租户环境中的规则集和规则</a></li>
                        <li><a href="using-oracle-database-vault-with-a-cdb.html#GUID-571C5AF1-909C-4A76-BE2B-9BAC5232FE84" title="在多租户环境中，您可以在CDB根目录或应用程序根目录中创建公共和本地命令规则。">多租户环境中的命令规则</a></li>
                        <li><a href="using-oracle-database-vault-with-a-cdb.html#GUID-517E9611-546B-43D9-8C54-37037AF0B198" title="您可以将独立的Oracle Database Release 12c或更高版本的数据库转换为PDB，然后将此PDB插入CDB。">将独立Oracle数据库转换为PDB并将其插入CDB</a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-5CD1D1E7-2435-4331-876F-34C5AE04BAD3" title="您可以在多租户容器数据库（CDB）中使用Oracle Database Vault。">将Oracle Database Vault与CDB一起使用</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="props_rev_3"><a id="GUID-B5569AED-AC16-482C-BA6D-34E275F016D2" name="GUID-B5569AED-AC16-482C-BA6D-34E275F016D2"></a><h3 id="MULTI-GUID-B5569AED-AC16-482C-BA6D-34E275F016D2" class="sect3"><span class="enumeration_section">24.3</span>验证是否已配置并启用数据库保管库</h3>
               <div>
                  <p><code class="codeph">DBA_DV_STATUS</code> ， <code class="codeph">CDB_DV_STATUS</code> ， <code class="codeph">DBA_OLS_STATUS</code>和<code class="codeph">CDB_OLS_STATUS</code>数据字典视图验证是否已配置并启用Oracle数据库。
                  </p>
                  <div class="section">除Oracle Database Vault管理员外，Oracle Database <code class="codeph">SYS</code>用户和已被授予<code class="codeph">DBA</code>角色的用户可以查询这些视图。
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type:disc">
                        <li>
                           <p>对于Database Vault：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>如果要查找非多租户数据库的数据库保管库状态，或者仅在根目录或单个PDB的多租户环境中，请查询<code class="codeph">DBA_DV_STATUS</code> 。例如：</p><pre class="pre codeblock"><code>SELECT * FROM DBA_DV_STATUS;</code></pre><p>输出类似于以下内容：</p><pre class="pre codeblock"><code>NAME STATUS -------------------- ----------- DV_CONFIGURE_STATUS TRUE DV_ENABLE_STATUS TRUE</code></pre></li>
                              <li>
                                 <p>如果要在多租户环境中查找所有PDB的数据库保管库状态（作为具有管理权限的公共用户），请查询<code class="codeph">CDB_DV_STATUS</code> ，它提供了容器ID（ <code class="codeph">CON_ID</code> ）字段的添加。
                                 </p>
                              </li>
                           </ul>
                        </li>
                        <li>
                           <p>对于Oracle Label Security，请查询以下数据字典视图，这些视图与其Database Vault等效视图类似：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><code class="codeph">DBA_OLS_STATUS</code></p>
                              </li>
                              <li>
                                 <p><code class="codeph">CDB_OLS_STATUS</code></p>
                              </li>
                           </ul>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-5CD1D1E7-2435-4331-876F-34C5AE04BAD3" title="您可以在多租户容器数据库（CDB）中使用Oracle Database Vault。">将Oracle Database Vault与CDB一起使用</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="props_rev_3"><a id="GUID-68558E32-ABD0-4495-8677-4F9E09283E5D" name="GUID-68558E32-ABD0-4495-8677-4F9E09283E5D"></a><h3 id="MULTI-GUID-68558E32-ABD0-4495-8677-4F9E09283E5D" class="sect3"><span class="enumeration_section">24.4</span>在多租户环境中向Oracle数据库注册Oracle Database Vault</h3>
               <div>
                  <p>您可以基于多种方案在多租户环境中注册Oracle Database Vault。</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-5CC1B6F0-FDDB-4183-8233-0AC6B208667A">在CDB根目录中注册Database Vault</a><br>在多租户环境中，您向将使用CDB根目录中的数据库保管库强制角色的普通用户注册Oracle Database Vault。
                     </li>
                     <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-E30BC167-13D6-4C84-ABCC-28CBFF704193">注册Database Vault公共用户以管理特定PDB</a><br>在多租户环境中，您必须首先在根目录中注册Oracle Database Vault，然后在PDB中注册。
                     </li>
                     <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-75E90559-133D-4B5E-B658-D77810B590C6">注册Database Vault本地用户以管理特定PDB</a><br>在多租户环境中，您必须先在根目录中注册Oracle Database Vault，然后再在PDB中注册。
                     </li>
                     <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-54699671-483A-49EF-B900-81D286845E8E">插入启用Database Vault的PDB</a><br>在SQL * Plus中，在多租户环境中，您可以插入已启用Database Vault的数据库。
                     </li>
                     <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-9D1223B5-3B22-4343-B9DA-05B4BC72F260">在多租户环境中手动安装Oracle Database Vault</a><br>在某些情况下，对于多租户环境，您必须手动安装Oracle Database Vault。例如，没有Database Vault的11g Oracle数据库升级到版本12c，然后转换为PDB以插入12c Database Vault启用的数据库。
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-5CD1D1E7-2435-4331-876F-34C5AE04BAD3" title="您可以在多租户容器数据库（CDB）中使用Oracle Database Vault。">将Oracle Database Vault与CDB一起使用</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="props_rev_3"><a id="GUID-5CC1B6F0-FDDB-4183-8233-0AC6B208667A" name="GUID-5CC1B6F0-FDDB-4183-8233-0AC6B208667A"></a><h4 id="MULTI-GUID-5CC1B6F0-FDDB-4183-8233-0AC6B208667A" class="sect4"><span class="enumeration_section">24.4.1</span>在CDB根目录中注册Database Vault</h4>
                  <div>
                     <p>在多租户环境中，您向将使用CDB根目录中的数据库保管库强制角色的普通用户注册Oracle Database Vault。</p>
                     <ol>
                        <li class="stepexpand"><span>在多租户环境中，以具有创建用户权限并授予<code class="codeph">CREATE SESSION</code>和<code class="codeph">SET CONTAINER</code>权限的用户身份登录数据库实例的根目录。</span><div>
                              <p>例如：</p><pre class="pre codeblock"><code>sqlplus c ## dba_debra输入密码： <span class="italic">密码</span>
</code></pre></div>
                        </li>
                        <li class="stepexpand" id="GUID-5CC1B6F0-FDDB-4183-8233-0AC6B208667A__CHDGDEIB"><span>选择将用于数据库保管库所有者（ <code class="codeph">DV_OWNER</code>角色）和数据库保管库客户管理器（ <code class="codeph">DV_ACCTMGR</code>角色）帐户的用户帐户（或创建新用户）。</span><div>
                              <p>Oracle强烈建议您为每个角色维护两个帐户。一个帐户（主要命名的用户帐户）将在日常使用，另一个帐户将用作备份帐户，以防主帐户的密码丢失并且必须重置。</p>
                           </div>
                           <div>
                              <p>使用<code class="codeph">c##</code>或<code class="codeph">C##</code>这些帐户的名称。例如：</p><pre class="pre codeblock"><code>GRANT CREATE SESSION，SET CONTAINER to c ## sec_admin_owen IDENTIFIED BY <span class="italic">password</span> CONTAINER = ALL; GRANT CREATE SESSION，SET CONTAINER to c ## dbv_owner_root_backup IDENTIFIED BY <span class="italic">password</span> CONTAINER = ALL; GRANT CREATE SESSION，SET CONTAINER to c ## accts_admin_ace IDENTIFIED BY <span class="italic">password</span> CONTAINER = ALL; GRANT CREATE SESSION，SET CONTAINER to c ## dbv_acctmgr_root_backup IDENTIFIED BY <span class="italic">password</span> CONTAINER = ALL;</code></pre><p>在本规范中：</p>
                              <ul id="GUID-5CC1B6F0-FDDB-4183-8233-0AC6B208667A__UL_EFL_1LP_GFB" style="list-style-type:disc">
                                 <li>如果新角色<code class="codeph">DV_ADMIN</code>和<code class="codeph">DV_ACCTMGR</code>尚不存在，则创建主帐户（ <code class="codeph">c##sec_admin_owen</code>和<code class="codeph">c##accts_admin_ace</code> ）。</li>
                                 <li>使用安全密码替换<span class="italic"><code class="codeph">password</code></span> 。
                                 </li>
                              </ul>
                           </div>
                        </li>
                        <li class="stepexpand"><span>使用<code class="codeph">SYSDBA</code>管理权限以<code class="codeph">SYS</code>用户身份连接到root</span><div><pre class="pre codeblock"><code>CONN SYS AS SYSDBA输入密码： <span class="italic">密码</span>
</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>配置两个备份Database Vault用户帐户。</span><div>例如：<pre class="pre codeblock"><code>BEGIN CONFIGURE_DV（dvowner_uname =&gt;'c ## dbv_owner_root_backup'，dvacctmgr_uname =&gt;'c ## dbv_acctmgr_root_backup'，force_local_dvowner =&gt; FALSE）;结束; /</code></pre></div>
                           <div>在此示例中，将<code class="codeph">force_local_dvowner</code>设置为<code class="codeph">FALSE</code>可使公共用户具有与此CDB根关联的PDB的<code class="codeph">DV_OWNER</code>权限。将其设置为<code class="codeph">TRUE</code>限制公共<code class="codeph">DV_OWNER</code>用户仅具有CDB根的<code class="codeph">DV_OWNER</code>角色权限。如果您将<code class="codeph">DV_OWNER</code>本地授予CDB根公共用户，则该用户无法将<code class="codeph">DV_OWNER</code>角色共同授予任何其他用户。
                           </div>
                        </li>
                        <li class="stepexpand"><span>运行<code class="codeph">utlrp.sql</code>脚本以重新编译根目录中的无效对象。</span><div><pre class="pre codeblock"><code>@？/rdbms/admin/utlrp.sql</code></pre><p>如果脚本提供说明，请按照说明操作，然后再次运行脚本。如果脚本异常终止而未给出任何指示，则再次运行它。</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>作为刚刚配置的主Database Vault Owner用户连接到root。</span><div>
                              <p>例如：</p><pre class="pre codeblock"><code>CONNECT c ## sec_admin_owen输入密码： <span class="italic">密码</span>
</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>使用以下命令之一启用Oracle Database Vault：</span><div>
                              <ul id="GUID-5CC1B6F0-FDDB-4183-8233-0AC6B208667A__UL_LYQ_35D_R2B" style="list-style-type:disc">
                                 <li>
                                    <p>要使Oracle Database Vault能够使用常规模式：</p><pre class="pre codeblock"><code>EXEC DBMS_MACADM.ENABLE_DV;</code></pre></li>
                                 <li>
                                    <p>如果每个关联的PDB必须在此数据库中启用Database Vault，请使用以下命令。在重新启动数据库之后，未启用Database Vault的PDB将处于受限模式，直到PDB中启用了Database Vault：</p><pre class="pre codeblock"><code>EXEC DBMS_MACADM.ENABLE_DV（strict_mode =&gt;'y'）;</code></pre></li>
                              </ul>
                           </div>
                        </li>
                        <li class="stepexpand"><span>使用<code class="codeph">SYSDBA</code>管理权限进行连接。</span><div><pre class="pre codeblock"><code>CONNECT / AS SYSDBA</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>重启数据库。</span><div><pre class="pre codeblock"><code>关机立即启动</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>验证是否已安装并启用Oracle Database Vault和Oracle Label Security。</span><div><pre class="pre codeblock"><code>SELECT * FROM DBA_DV_STATUS; SELECT * FROM DBA_OLS_STATUS; SELECT * FROM CDB_DV_STATUS; SELECT * FROM CDB_OLS_STATUS;</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>以备份<code class="codeph">DV_OWNER</code>用户身份进行连接，然后将<code class="codeph">DV_OWNER</code>角色授予您之前创建的主<code class="codeph">DV_OWNER</code>用户。</span><div>
                              <p>例如：</p><pre class="pre codeblock"><code>CONNECT c ## dbv_owner_root_backup输入密码： <span class="italic">密码</span> GRANT DV_OWNER TO c ## sec_admin_owen WITH ADMIN OPTION;</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>作为备份<code class="codeph">DV_ACCTMGR</code>用户连接，然后将<code class="codeph">DV_ACCTMGR</code>角色授予备份<code class="codeph">DV_ACCTMGR</code>用户。</span><div>
                              <p>例如：</p><pre class="pre codeblock"><code>CONNECT c ## dbv_acctmgr_root_backup输入密码： <span class="italic">password</span> GRANT DV_ACCTMGR to c ## accts_admin_ace WITH ADMIN OPTION;</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>将两个备份帐户密码存储在安全位置，例如特权帐户管理（PAM）系统，以备将来需要时使用。</span></li>
                     </ol>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="using-oracle-database-vault-with-a-cdb.html#GUID-B5569AED-AC16-482C-BA6D-34E275F016D2" title="DBA_DV_STATUS，CDB_DV_STATUS，DBA_OLS_STATUS和CDB_OLS_STATUS数据字典视图验证是否已配置并启用Oracle数据库。">验证是否已配置并启用数据库保管库</a></li>
                           <li><a href="../dvadm/oracle-database-vault-schemas-roles-and-accounts.html#DVADM-GUID-4E1707B4-F9BB-4131-9D3E-90BB273F2832" target="_blank"><span><cite>Oracle Database Vault管理员指南</cite></span></a></li>
                           <li><a href="../dvadm/getting-started-with-oracle-database-vault.html#DVADM-GUID-FD5C6859-EF01-49F7-B6D6-4E5ACB7FC0C6" target="_blank"><span><cite>Oracle Database Vault管理员指南</cite></span></a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-68558E32-ABD0-4495-8677-4F9E09283E5D" title="您可以基于多种方案在多租户环境中注册Oracle Database Vault。">在多租户环境中向Oracle数据库注册Oracle Database Vault</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="props_rev_3"><a id="GUID-E30BC167-13D6-4C84-ABCC-28CBFF704193" name="GUID-E30BC167-13D6-4C84-ABCC-28CBFF704193"></a><h4 id="MULTI-GUID-E30BC167-13D6-4C84-ABCC-28CBFF704193" class="sect4"><span class="enumeration_section">24.4.2</span>注册Database Vault公共用户以管理特定PDB</h4>
                  <div>
                     <p>在多租户环境中，您必须首先在根目录中注册Oracle Database Vault，然后在PDB中注册。</p>
                     <div class="section">如果您首先尝试在PDB中注册，则会<code class="codeph">ORA-47503: Database Vault is not enabled on CDB$ROOT</code>错误<code class="codeph">ORA-47503: Database Vault is not enabled on CDB$ROOT</code> 。
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>如果尚未执行此操作，请标识或创建命名的公共用户帐户，以用作Database Vault帐户以及关联的备份帐户。</span></li>
                        <li class="stepexpand"><span>确保您已在CDB根目录中注册了Oracle Database Vault，并且<code class="codeph">DV_OWNER</code>角色已共同授予普通用户。</span></li>
                        <li class="stepexpand"><span>以PDB本地的管理员身份连接到PDB。</span><div>例如：<pre class="pre codeblock"><code>CONNECT dba_debra @ <span class="italic">pdb_name</span>输入密码： <span class="italic">密码</span>
</code></pre><p>要查找可用的PDB，请查询<code class="codeph">DBA_PDBS</code>数据字典视图。要检查当前PDB，请运行<code class="codeph">show con_name</code>命令。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>为此PDB的用户授予<code class="codeph">CREATE SESSION</code>和<code class="codeph">SET CONTAINER</code>权限。</span><div>例如：<pre class="pre codeblock"><code>GRANT CREATE SESSION，SET CONTAINER to c ## sec_admin_owen CONTAINER = CURRENT; GRANT CREATE SESSION，SET CONTAINER to c ## accts_admin_ace CONTAINER = CURRENT;</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>以<code class="codeph">SYS</code>用户身份连接<code class="codeph">SYSDBA</code>管理权限</span><div><pre class="pre codeblock"><code>CONNECT SYS @ <span class="italic">pdb_name</span> AS SYSDBA输入密码： <span class="italic">password</span>
</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>仍在PDB中时，配置两个备份Database Vault用户帐户。</span><div><pre class="pre codeblock"><code>BEGIN CONFIGURE_DV（dvowner_uname =&gt;'c ## dbv_owner_root_backup'，dvacctmgr_uname =&gt;'c ## dbv_acctmgr_root_backup'）;结束; /</code></pre><p>在此示例中，省略<code class="codeph">force_local_dvowner</code>参数，因为它是不必要的。在PDB中配置的所有普通用户都受限于PDB的范围。</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>运行<code class="codeph">utlrp.sql</code>脚本以重新编译此PDB中的无效对象。</span><div><pre class="pre codeblock"><code>@？/rdbms/admin/utlrp.sql</code></pre><p>如果脚本提供说明，请按照说明操作，然后再次运行脚本。如果脚本异常终止而未给出任何指示，则再次运行它。</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>作为您刚刚配置的备份Database Vault Owner用户连接到PDB。</span><div>例如：<pre class="pre codeblock"><code>CONNECT c ## dbv_owner_root_backup @ <span class="italic">pdb_name</span>输入密码： <span class="italic">password</span>
</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>在此PDB中启用Oracle Database Vault。</span><div><pre class="pre codeblock"><code>EXEC DBMS_MACADM.ENABLE_DV;</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>使用<code class="codeph">SYSDBA</code>管理权限连接到CDB。</span><div><pre class="pre codeblock"><code>CONNECT / AS SYSDBA</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>关闭并重新打开PDB。</span><div>例如：<pre class="pre codeblock"><code>ALTER PLUGGABLE DATABASE <span class="italic">pdb_name</span> CLOSE IMMEDIATE; ALTER PLUGGABLE DATABASE <span class="italic">pdb_name</span> OPEN;</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>验证是否已为Database Vault配置和启用PDB。</span><div><pre class="pre codeblock"><code>CONNECT SYS @ <span class="italic">pdb_name</span> AS SYSDBA输入密码： <span class="italic">password</span> SELECT * FROM DBA_DV_STATUS;</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>以备份<code class="codeph">DV_OWNER</code>用户身份进行连接，然后将<code class="codeph">DV_OWNER</code>角色授予您之前创建的主<code class="codeph">DV_OWNER</code>用户。</span><div>
                              <p>例如：</p><pre class="pre codeblock"><code>CONNECT c ## dbv_owner_backup输入密码： <span class="italic">密码</span> GRANT DV_OWNER TO c ## sec_admin_owen WITH ADMIN OPTION;</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>作为备份<code class="codeph">DV_ACCTMGR</code>用户连接，然后将<code class="codeph">DV_ACCTMGR</code>角色授予主<code class="codeph">DV_ACCTMGR</code>用户。</span><div>
                              <p>例如：</p><pre class="pre codeblock"><code>CONNECT c ## dbv_acctmgr_root_backup输入密码： <span class="italic">password</span> GRANT DV_ACCTMGR to c ## accts_admin_ace WITH ADMIN OPTION;</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>将两个备份帐户密码存储在安全位置，例如特权帐户管理（PAM）系统，以备将来需要时使用。</span></li>
                     </ol>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="using-oracle-database-vault-with-a-cdb.html#GUID-B5569AED-AC16-482C-BA6D-34E275F016D2" title="DBA_DV_STATUS，CDB_DV_STATUS，DBA_OLS_STATUS和CDB_OLS_STATUS数据字典视图验证是否已配置并启用Oracle数据库。">验证是否已配置并启用数据库保管库</a></li>
                           <li><a href="../dvadm/oracle-database-vault-schemas-roles-and-accounts.html#DVADM-GUID-4E1707B4-F9BB-4131-9D3E-90BB273F2832" target="_blank"><span><cite>Oracle Database Vault管理员指南</cite></span></a></li>
                           <li><a href="../dvadm/getting-started-with-oracle-database-vault.html#DVADM-GUID-FD5C6859-EF01-49F7-B6D6-4E5ACB7FC0C6" target="_blank"><span><cite>Oracle Database Vault管理员指南</cite></span></a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-68558E32-ABD0-4495-8677-4F9E09283E5D" title="您可以基于多种方案在多租户环境中注册Oracle Database Vault。">在多租户环境中向Oracle数据库注册Oracle Database Vault</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-75E90559-133D-4B5E-B658-D77810B590C6" name="GUID-75E90559-133D-4B5E-B658-D77810B590C6"></a><h4 id="MULTI-GUID-75E90559-133D-4B5E-B658-D77810B590C6" class="sect4"><span class="enumeration_section">24.4.3</span>注册Database Vault本地用户以管理特定PDB</h4>
                  <div>
                     <p>在多租户环境中，您必须先在根目录中注册Oracle Database Vault，然后再在PDB中注册。</p>
                     <div class="p">如果您首先尝试在PDB中注册，则会<code class="codeph">ORA-47503: Database Vault is not enabled on CDB$ROOT</code>错误<code class="codeph">ORA-47503: Database Vault is not enabled on CDB$ROOT</code> 。
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>在多租户环境中，以具有创建用户权限并授予<code class="codeph">CREATE SESSION</code>和<code class="codeph">SET CONTAINER</code>权限的用户身份登录PDB。</span><div>例如：<pre class="pre codeblock"><code>sqlplus sec_admin <span class="italic">@pdb_name</span>输入密码： <span class="italic">密码</span></code></pre></div>
                        </li>
                        <li class="stepexpand"><span>如果不使用现有的本地用户命名帐户来创建新的Database Vault角色，请创建新的命名本地用户帐户。</span><div>在这两种情况下，您必须创建备份帐户以保留数据库保管库角色，以防命名用户丢失或忘记其密码。</div>
                           <div><pre class="pre codeblock"><code>GRANT创建会话，将容器设置为sec_admin_owen通过<span class="italic">密码</span>识别; GRANT创建会话，将容器设置为dbv_owner_backup IDENTIFIED BY <span class="italic">password</span> ; GRANT创建会话，将容器设置为accts_admin_ace通过<span class="italic">密码</span>识别; GRANT创建会话，将容器设置为dbv_acctmgr_backup IDENTIFIED BY <span class="italic">密码</span> ;</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>确保您已在CDB根目录中注册了Oracle Database Vault。</span><div>暂时连接到根，然后查询<code class="codeph">DBA_DV_STATUS</code>视图。<pre class="pre codeblock"><code>CONNECT SYS / AS SYSDBA输入密码： <span class="italic">password</span> SELECT * FROM DBA_DV_STATUS;</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>使用<code class="codeph">SYSDBA</code>管理权限以<code class="codeph">SYS</code>用户身份连接到PDB。</span><div><pre class="pre codeblock"><code>CONNECT SYS @ <span class="italic">pdb_name</span> AS SYSDBA输入密码： <span class="italic">password</span>
</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>仍在PDB中时，配置两个备份Database Vault用户帐户。</span><div><pre class="pre codeblock"><code>BEGIN CONFIGURE_DV（dvowner_uname =&gt;'dbv_owner_backup'，dvacctmgr_uname =&gt;'dbv_acctmgr_backup'）;结束; /</code></pre><p>在此示例中，省略<code class="codeph">force_local_dvowner</code>参数，因为它是不必要的。在PDB中配置时，将在本地授予Database Vault角色。</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>运行<code class="codeph">utlrp.sql</code>脚本以重新编译此PDB中的无效对象。</span><div><pre class="pre codeblock"><code>@？/rdbms/admin/utlrp.sql</code></pre><p>如果脚本提供说明，请按照说明操作，然后再次运行脚本。如果脚本异常终止而未给出任何说明，请再次运行。</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>作为您刚刚配置的备份Database Vault Owner用户连接到PDB。</span><div>例如：<pre class="pre codeblock"><code>CONNECT dbv_owner_backup @ <span class="italic">pdb_name</span>输入密码： <span class="italic">password</span>
</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>在此PDB中启用Oracle Database Vault。</span><div><pre class="pre codeblock"><code>EXEC DBMS_MACADM.ENABLE_DV;</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>使用<code class="codeph">SYSDBA</code>管理权限连接到CDB。</span><div><pre class="pre codeblock"><code>CONNECT / AS SYSDBA</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>关闭并重新打开PDB。</span><div><pre class="pre codeblock"><code>ALTER PLUGGABLE DATABASE <span class="italic">pdb_name</span> CLOSE IMMEDIATE; ALTER PLUGGABLE DATABASE <span class="italic">pdb_name</span> OPEN;</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>验证是否已为Database Vault配置和启用PDB。</span><div><pre class="pre codeblock"><code>CONNECT SYS @ <span class="italic">pdb_name</span> AS SYSDBA输入密码： <span class="italic">password</span> SELECT * FROM DBA_DV_STATUS;</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>以备份<code class="codeph">DV_OWNER</code>用户身份进行连接，然后将<code class="codeph">DV_OWNER</code>角色授予您之前创建的主<code class="codeph">DV_OWNER</code>用户。</span><div>
                              <p>例如：</p><pre class="pre codeblock"><code>CONNECT dbv_owner_backup输入密码： <span class="italic">密码</span> GRANT DV_OWNER TO sec_admin_owen WITH ADMIN OPTION;</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>作为备份<code class="codeph">DV_ACCTMGR</code>用户连接，然后将<code class="codeph">DV_ACCTMGR</code>角色授予备份<code class="codeph">DV_ACCTMGR</code>用户。</span><div>
                              <p>例如：</p><pre class="pre codeblock"><code>CONNECT dbv_acctmgr_backup输入密码： <span class="italic">password</span> GRANT DV_ACCTMGR to c ## accts_admin_ace WITH ADMIN OPTION;</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>将两个备份帐户密码存储在安全位置，例如特权帐户管理（PAM）系统，以备将来需要时使用。</span></li>
                     </ol>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-68558E32-ABD0-4495-8677-4F9E09283E5D" title="您可以基于多种方案在多租户环境中注册Oracle Database Vault。">在多租户环境中向Oracle数据库注册Oracle Database Vault</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-54699671-483A-49EF-B900-81D286845E8E" name="GUID-54699671-483A-49EF-B900-81D286845E8E"></a><h4 id="MULTI-GUID-54699671-483A-49EF-B900-81D286845E8E" class="sect4"><span class="enumeration_section">24.4.4</span>插入启用Database Vault的PDB</h4>
                  <div>
                     <p>在SQL * Plus中，在多租户环境中，您可以插入已启用Database Vault的数据库。</p>
                     <p>在此方案中，插入的数据库具有自己的本地Database Vault帐户。请注意，如果将启用了Database Vault的数据库插入未启用Database Vault的CDB，则PDB将保持受限模式，直到您在CDB中启用Database Vault，然后重新启动CDB。如果将未启用Database Vault的PDB插入启用了Database Vault的CDB，则PDB将保持受限模式，直到您在PDB中启用Database Vault，然后重新启动PDB。仍然可以使用此插入的非Database Vault启用的PDB。但是，如果CDB是使用严格选项集启用的Database Vault，则PDB必须启用Database Vault。</p>
                     <p>在插入支持Database Vault的PDB并且将数据库保管库角色授予普通用户之前，请确保完全了解插入PDB对普通用户的影响。</p>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="../dbseg/managing-security-for-oracle-database-users.html#DBSEG-GUID-81D0494C-E838-4DD9-AC82-B56473F98D06" target="_blank"><span><cite>Oracle数据库安全指南</cite></span></a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-68558E32-ABD0-4495-8677-4F9E09283E5D" title="您可以基于多种方案在多租户环境中注册Oracle Database Vault。">在多租户环境中向Oracle数据库注册Oracle Database Vault</a></p>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-9D1223B5-3B22-4343-B9DA-05B4BC72F260" name="GUID-9D1223B5-3B22-4343-B9DA-05B4BC72F260"></a><h4 id="MULTI-GUID-9D1223B5-3B22-4343-B9DA-05B4BC72F260" class="sect4"><span class="enumeration_section">24.4.5</span>在多租户环境中手动安装Oracle Database Vault</h4>
                  <div>
                     <p>在某些情况下，对于多租户环境，您必须手动安装Oracle Database Vault。例如，没有Database Vault的11g Oracle数据库升级到版本12c，然后转换为PDB以插入12c Database Vault启用的数据库。</p>
                     <div class="section">如果在将PDB插入安装了Database Vault和Label Security的CDB时此PDB没有这些产品，则必须在PDB中手动安装Oracle Database Vault（和Oracle Label Security）。</div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>作为已被授予<code class="codeph">SYSDBA</code>管理权限的用户，请登录到要在其中安装Oracle Database Vault的PDB。</span><div>
                              <p>例如，要登录名为<code class="codeph">hr_pdb</code>的PDB：</p><pre class="pre codeblock"><code>sqlplus sec_admin @ hr_pdb as sysdba输入密码： <span class="italic">password</span></code></pre><p>要查找可用的PDB，请运行<code class="codeph">show pdbs</code>命令。要检查当前PDB，请运行<code class="codeph">show con_name</code>命令。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>如有必要，请检查此PDB上是否已安装Oracle Database Vault和Oracle Label Security。</span><div>如果存在<code class="codeph">DVSYS</code>帐户（用于Database Vault）和<code class="codeph">LBACSYS</code>帐户（用于标签安全性），则PDB上存在Database Vault和Label Security。</div>
                           <div><pre class="pre codeblock"><code>SELECT USERNAME FROM DBA_USERS WHERE USERNAME IN（'DVSYS'，'LBACSYS'）;</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>如果既未安装Database Vault也未安装Label Security，则通过执行<code class="codeph">catols.sql</code>脚本来安装Oracle Label Security。</span><div><pre class="pre codeblock"><code>@ $ ORACLE_HOME / RDBMS /管理/ catols.sql</code></pre><p>必须先安装Oracle Label Security，然后才能安装Oracle Database Vault。</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>通过执行<code class="codeph">catmac.sql</code>脚本来安装Oracle Database Vault。</span><div><pre class="pre codeblock"><code>@ $ ORACLE_HOME / RDBMS /管理/ catmac.sql</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>在<code class="codeph">Enter value for 1</code>提示符下，输入<code class="codeph">SYSTEM</code>作为表空间以安装<code class="codeph">DVSYS</code> 。</span></li>
                        <li class="stepexpand"><span>在<code class="codeph">Enter value for 2</code>提示符下，输入PDB的临时表空间。</span></li>
                     </ol>
                     <div class="section">安装完成后，您可以在PDB中注册Oracle Database Vault。如果数据库保管库尚未在CDB中注册，则必须先关闭PDB，然后才能在CDB根目录中注册Database Vault。数据库保管库必须先在CDB根目录中注册，然后才能在PDB中注册。数据库保管库在CDB根目录中注册并且数据库已重新启动后，您可以打开PDB并注册数据库保管库。</div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="../dvadm/getting-started-with-oracle-database-vault.html#DVADM-GUID-68558E32-ABD0-4495-8677-4F9E09283E5D" target="_blank"><span><cite>Oracle Database Vault管理员指南</cite></span></a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-68558E32-ABD0-4495-8677-4F9E09283E5D" title="您可以基于多种方案在多租户环境中注册Oracle Database Vault。">在多租户环境中向Oracle数据库注册Oracle Database Vault</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
            <div class="sect2"><a id="GUID-86DA4697-8BE2-4F27-92E3-C15843F9A3A6" name="GUID-86DA4697-8BE2-4F27-92E3-C15843F9A3A6"></a><h3 id="MULTI-GUID-86DA4697-8BE2-4F27-92E3-C15843F9A3A6" class="sect3"><span class="enumeration_section">24.5</span>配置领域</h3>
               <div>
                  <p>您可以围绕数据库对象创建领域以保护它们，然后设置授权以控制用户对此数据的访问。</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-D200353D-D15B-46AE-82DA-FE874D24800C">什么是领域？</a><br>Realms使您可以保护数据库对象，包括特定的对象类型。
                     </li>
                     <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-DA60AF6B-D669-4E17-94B4-043BB41FC673">多租户环境中的领域授权</a><br>在多租户环境中，常见域授权的规则和行为类似于其他常见对象的授权。
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-5CD1D1E7-2435-4331-876F-34C5AE04BAD3" title="您可以在多租户容器数据库（CDB）中使用Oracle Database Vault。">将Oracle Database Vault与CDB一起使用</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="props_rev_3"><a id="GUID-D200353D-D15B-46AE-82DA-FE874D24800C" name="GUID-D200353D-D15B-46AE-82DA-FE874D24800C"></a><h4 id="MULTI-GUID-D200353D-D15B-46AE-82DA-FE874D24800C" class="sect4"><span class="enumeration_section">24.5.1</span>什么是领域？
                  </h4>
                  <div>
                     <p>Realms使您可以保护数据库对象，包括特定的对象类型。</p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-5B043984-7C0F-49E3-8A0C-A983E4F12FD0">关于领域</a><br>领域是必须为给定应用程序保护的数据库模式，数据库对象和数据库角色的分组。
                        </li>
                        <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-72403156-3E91-43FD-8D06-859DBBC10568">多租户环境中的领域</a><br>在多租户环境中，您可以创建领域以保护应用程序根目录中的公共对象。
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-86DA4697-8BE2-4F27-92E3-C15843F9A3A6" title="您可以围绕数据库对象创建领域以保护它们，然后设置授权以控制用户对此数据的访问。">配置领域</a></p>
                        </div>
                     </div>
                  </div>
                  
                  <div class="props_rev_3"><a id="GUID-5B043984-7C0F-49E3-8A0C-A983E4F12FD0" name="GUID-5B043984-7C0F-49E3-8A0C-A983E4F12FD0"></a><h5 id="MULTI-GUID-5B043984-7C0F-49E3-8A0C-A983E4F12FD0" class="sect5"><span class="enumeration_section">24.5.1.1</span>关于领域</h5>
                     <div>
                        <p>领域是必须为给定应用程序保护的数据库模式，数据库对象和数据库角色的分组。</p>
                        <p>将领域视为数据库对象的保护区域。模式是数据库对象（如表，视图和包）的逻辑集合，而角色是特权的集合。通过将模式和角色安排到功能组中，您可以控制用户对这些组使用系统特权的能力，并防止数据库管理员或具有系统特权的其他强大用户访问未经授权的数据。Oracle Database Vault不会替换现有Oracle数据库中的自主访问控制模型。对于领域和命令规则，它在此模型的顶部充当层。</p>
                        <p>Oracle Database Vault提供两种类型的域：常规域和强制域。两种域类型都可以选择性地保护整个模式或模式中的关键对象，例如表和索引。对于常规领域，对象所有者或已被授予对象权限的用户可以在没有领域授权的情况下执行查询或DML操作，但必须具有领域授权才能执行DDL操作。强制领域为领域内的对象提供更强大的保护。强制域阻止基于对象权限和基于系统权限的访问，并且不允许具有对象权限的用户在没有域授权的情况下执行查询，DML或DDL操作。换句话说，如果对象受到强制领域的保护，即使对象所有者也无法在没有适当领域授权的情况下访问他或她自己的对象。</p>
                        <p>对于使用Oracle闪回技术的数据库，常规域和强制域都会对闪回表强制执行相同的行为。如果用户被授权到领域，则用户可以在受领域保护的表上执行<code class="codeph">FLASHBACK TABLE</code> SQL语句。
                        </p>
                        <p>对于使用信息生命周期管理（ILM）的数据库，Database Vault管理员可以使用<code class="codeph">DBMS_MACADM.AUTHORIZE_MAINTENANCE_USER</code>和<code class="codeph">DBMS_MACADM.UNAUTHORIZE_MAINTENANCE_USER</code>过程来控制谁可以对受域保护的对象执行ILM操作。
                        </p>
                        <p>您可以将模式，模式中特定类型的所有对象或模式中的单个对象注册到领域中。创建领域后，您可以注册一组架构对象或角色（安全对象）以进行领域保护，并授权一组用户或角色访问安全对象。受常规域保护的对象允许DML访问具有直接对象授权的用户。</p>
                        <p>例如，您可以创建领域以保护会计部门中使用的所有现有数据库模式。该领域禁止未经授权的任何用户使用系统权限来访问安全的记帐数据。当整个模式受到保护时，模式中的所有对象都受到保护，包括表，索引，过程和其他对象。</p>
                        <p>您可以在Oracle Database Vault中创建的域上运行报告。您可以在开发，测试甚至生产阶段使用模拟模式来仅记录域违规而不是阻止访问。这使您可以使用Database Vault领域快速测试应用程序。</p>
                        <p>您可以使用Oracle Enterprise Manager Cloud Control中的Oracle Database Vault Administrator页面配置域。或者，您可以使用Oracle Database Vault提供的PL / SQL接口和包来配置域。</p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-D200353D-D15B-46AE-82DA-FE874D24800C" title="Realms使您可以保护数据库对象，包括特定的对象类型。">什么是领域？</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
                  <div class="sect4"><a id="GUID-72403156-3E91-43FD-8D06-859DBBC10568" name="GUID-72403156-3E91-43FD-8D06-859DBBC10568"></a><h5 id="MULTI-GUID-72403156-3E91-43FD-8D06-859DBBC10568" class="sect5"><span class="enumeration_section">24.5.1.2</span>多租户环境中的领域</h5>
                     <div>
                        <p>在多租户环境中，您可以创建领域以保护应用程序根目录中的公共对象。</p>
                        <p>在应用程序根目录中创建领域而不是在单个可插拔数据库（PDB）中围绕这些对象创建大量对象和领域的优点是，您可以在一个位置（应用程序根目录）创建它们。这样，您就可以集中管理它们。</p>
                        <p>您无法在CDB根目录中创建公共领域。</p>
                        <p>Database Vault公共领域可以是常规领域或强制领域。领域仅保护应用程序根目录中的对象，而不保护PDB中的本地对象。 CDB根，应用程序根和任何受影响的PDB都必须启用Database Vault。</p>
                        <p>要配置公共领域，通常必须授予<code class="codeph">DV_OWNER</code>或<code class="codeph">DV_ADMIN</code>角色。要为公共领域授予通用授权，您必须位于应用程序根目录中。要将域传播到与应用程序根关联的PDB，必须同步应用程序根。例如，要同步名为<code class="codeph">saas_sales_app</code>的应用程序</p><pre class="pre codeblock"><code>ALTER PLUGGABLE DATABASE APPLICATION saas_sales_app SYNC;</code></pre></div>
                     <div>
                        <div class="relinfo">
                           <p><strong>相关话题</strong></p>
                           <ul>
                              <li><a href="../dvadm/configuring-realms.html#DVADM-GUID-18D6FFCB-42C2-49D1-9F53-BADE7B0754AB" target="_blank"><span><cite>Oracle Database Vault管理员指南</cite></span></a></li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-D200353D-D15B-46AE-82DA-FE874D24800C" title="Realms使您可以保护数据库对象，包括特定的对象类型。">什么是领域？</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div>
               <div class="sect3"><a id="GUID-DA60AF6B-D669-4E17-94B4-043BB41FC673" name="GUID-DA60AF6B-D669-4E17-94B4-043BB41FC673"></a><h4 id="MULTI-GUID-DA60AF6B-D669-4E17-94B4-043BB41FC673" class="sect4"><span class="enumeration_section">24.5.2</span>多租户环境中的域授权</h4>
                  <div>
                     <p>在多租户环境中，常见域授权的规则和行为类似于其他常见对象的授权。</p>
                     <p><span class="bold">共同领域的本地授权</span></p>
                     <p>对公共领域的本地授权是指用户对该用户正在访问的PDB的授权。</p>
                     <p>对共同领域的本地授权规则如下：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>通常被授予<code class="codeph">DV_OWNER</code>或<code class="codeph">DV_ADMIN</code>角色的用户可以向普通用户，公共角色，本地用户和本地角色授予本地授权。常见的<code class="codeph">DV_OWNER</code>或<code class="codeph">DV_ADMIN</code>用户还可以从PDB中的公共<code class="codeph">DV_OWNER</code>删除本地授权。</p>
                        </li>
                        <li>
                           <p>本地Database Vault管理员可以在PDB中本地授权（即，向本地用户和普通用户授予本地授权）。常见的Database Vault管理员还可以在每个PDB中授予授权。通用域授权只能由应用程序根目录中的公共Database Vault管理员授予。</p>
                        </li>
                        <li>
                           <p>公共Database Vault管理员可以在PDB中向公共领域添加或删除本地授权。</p>
                        </li>
                        <li>
                           <p>如果普通用户仅具有对公共领域的本地授权，则该用户无法访问除本地授权之外的任何其他PDB中的公共领域。</p>
                        </li>
                        <li>
                           <p>普通用户或共同角色可以同时具有对公共领域的本地授权和公共授权。从公共领域删除普通用户的本地授权不会影响普通用户的公共授权。从公共领域删除普通用户的公共授权不会影响普通用户的本地授权。</p>
                        </li>
                     </ul>
                     <p><span class="bold">共同领域的共同授权</span></p>
                     <p>公共领域的公共授权是指普通用户或公共角色在应用程序根目录中的授权，而授权在启用Database Vault的每个容器中生效。</p>
                     <p>对共同领域的本地授权规则如下：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>通常被授予<code class="codeph">DV_OWNER</code>或<code class="codeph">DV_ADMIN</code>角色的用户可以向应用程序根目录中的公共用户或角色授予公共领域授权。此通用Database Vault管理员可以在应用程序根目录中执行常见授权的删除。
                           </p>
                        </li>
                        <li>
                           <p>此通用授权适用于已在CDB中启用Database Vault的容器。</p>
                        </li>
                        <li>
                           <p>如果普通用户被授权到应用程序根目录中的公共领域，则该用户可以访问由应用程序根目录中的公共领域和任何应用程序PDB保护的对象。</p>
                        </li>
                        <li>
                           <p>与公共领域关联的任何规则集都必须是通用规则集。添加到与公共授权关联的公共规则集的规则不能涉及任何本地对象。</p>
                        </li>
                     </ul>
                     <p><span class="bold">领域的授权如何在应用程序根和单个PDB中工作</span></p>
                     <p>在容器中的Database Vault强制执行期间，当在PDB中本地使用时，公共领域执行与同一领域相同的强制执行行为。</p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-86DA4697-8BE2-4F27-92E3-C15843F9A3A6" title="您可以围绕数据库对象创建领域以保护它们，然后设置授权以控制用户对此数据的访问。">配置领域</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
            <div class="sect2"><a id="GUID-6308CB8B-6777-44AF-A523-F1A956591F6D" name="GUID-6308CB8B-6777-44AF-A523-F1A956591F6D"></a><h3 id="MULTI-GUID-6308CB8B-6777-44AF-A523-F1A956591F6D" class="sect3"><span class="enumeration_section">24.6</span>多租户环境中的规则集和规则</h3>
               <div>
                  <p>在多租户环境中，您可以在应用程序根目录中创建规则集及其关联规则。</p>
                  <p>当Database Vault评估关联的域或命令规则时，公共领域必须使用公共规则集。通用规则集及其规则只能在应用程序根目录中创建。创建公共规则集后，它将存在于与创建公共规则集的根关联的每个容器中。通用规则集只能包含通用规则。</p>
                  <p>要配置通用规则集及其规则，通常必须授予<code class="codeph">DV_OWNER</code>或<code class="codeph">DV_ADMIN</code>角色。
                  </p>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="using-oracle-database-vault-with-a-cdb.html#GUID-571C5AF1-909C-4A76-BE2B-9BAC5232FE84" title="在多租户环境中，您可以在CDB根目录或应用程序根目录中创建公共和本地命令规则。">多租户环境中的命令规则</a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-5CD1D1E7-2435-4331-876F-34C5AE04BAD3" title="您可以在多租户容器数据库（CDB）中使用Oracle Database Vault。">将Oracle Database Vault与CDB一起使用</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="props_rev_3"><a id="GUID-571C5AF1-909C-4A76-BE2B-9BAC5232FE84" name="GUID-571C5AF1-909C-4A76-BE2B-9BAC5232FE84"></a><h3 id="MULTI-GUID-571C5AF1-909C-4A76-BE2B-9BAC5232FE84" class="sect3"><span class="enumeration_section">24.7</span>多租户环境中的命令规则</h3>
               <div>
                  <p>在多租户环境中，您可以在CDB根目录或应用程序根目录中创建公共和本地命令规则。</p>
                  <p>通用命令规则只能与通用领域，规则集和规则相关联。本地命令规则只能与本地域，规则集和规则相关联。</p>
                  <p>要将这些命令规则应用于整个多租户环境，必须从CDB根目录或应用程序根目录执行命令规则过程，作为已被授予<code class="codeph">DVADM</code>或<code class="codeph">DVOWNER</code>角色的普通用户。在CDB根目录中创建的公共命令规则将应用于该CDB环境中的所有PDB。在应用程序根目录中创建的常用命令规则将仅应用于与此应用程序根目录关联的PDB。要将命令规则传播到与CDB根或应用程序根关联的PDB，必须同步PDB。例如，要将名为<code class="codeph">saas_sales_app</code>的应用程序根同步到其应用程序PDB：</p><pre class="pre codeblock"><code>ALTER PLUGGABLE DATABASE APPLICATION saas_sales_app SYNC;</code></pre><p>要将CDB根目录中的公共命令规则同步到PDB：</p><pre class="pre codeblock"><code>ALTER PLUGGABLE DATABASE APPLICATION APP $ CDB $ SYSTEM SYNC;</code></pre><p>您可以通过查询<code class="codeph">USER_ROLE_PRIVS</code>数据字典视图来检查用户的角色。要查找有关命令规则的信息，请查询<code class="codeph">DBA_DV_COMMAND_RULE</code>数据字典视图。
                  </p>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-5CD1D1E7-2435-4331-876F-34C5AE04BAD3" title="您可以在多租户容器数据库（CDB）中使用Oracle Database Vault。">将Oracle Database Vault与CDB一起使用</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-07513135-CB45-4788-A596-E5A71879BB81" name="GUID-07513135-CB45-4788-A596-E5A71879BB81"></a><h3 id="MULTI-GUID-07513135-CB45-4788-A596-E5A71879BB81" class="sect3"><span class="enumeration_section">24.8</span>多租户环境中的Oracle Database Vault策略</h3>
               <div>
                  <p>Oracle Database Vault策略仅在创建它们的可插拔数据库（PDB）本地。</p>
                  <p>也就是说，如果您在PDB中创建了策略，则只能向其添加本地域和命令规则。您无法创建可以具有公共领域或常用命令规则的Database Vault策略。</p>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-5CD1D1E7-2435-4331-876F-34C5AE04BAD3" title="您可以在多租户容器数据库（CDB）中使用Oracle Database Vault。">将Oracle Database Vault与CDB一起使用</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-E04CBDD1-17F0-4942-BF78-21C340A4425F" name="GUID-E04CBDD1-17F0-4942-BF78-21C340A4425F"></a><h3 id="MULTI-GUID-E04CBDD1-17F0-4942-BF78-21C340A4425F" class="sect3"><span class="enumeration_section">24.9</span>使用Database Vault Operations Control限制多租户公共用户对本地PDB数据的访问</h3>
               <div>
                  <p>您可以通过CDB根公共用户（例如基础结构数据库管理员）控制PDB访问。</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-1A67C2FE-A83C-4B5F-AB2E-1A7E96922064">关于使用Database Vault Operations Control</a><br>您可以自动限制普通用户访问自治，常规云或内部部署环境中的可插拔数据库（PDB）本地数据。
                     </li>
                     <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-9CC9C99D-7168-4C39-8380-81C1CBF1E8C3">启用Database Vault Operations Control</a><br>要启用Database Vault操作控制，请使用<code class="codeph">DBMS_MACADM.ENABLE_APP_PROTECTION</code> PL / SQL过程。
                     </li>
                     <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-00868C98-FC37-49BC-B867-558B9FB27B6A">将公共用户和包添加到例外列表</a><br>必须访问PDB本地数据的公共用户和应用程序可以添加到例外列表中。
                     </li>
                     <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-57584CE8-8BC0-40DA-A446-A45AFF882726">从例外列表中删除公共用户和包</a><br>可以从例外列表中删除不再需要访问PDB本地数据的用户和应用程序。
                     </li>
                     <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-D23A52A4-0556-4F71-9157-6CC081EF7819">禁用Database Vault Operations Control</a><br>要禁用Database Vault操作控制，请使用<code class="codeph">DBMS_MACADM.DISABLE_APP_PROTECTION</code> PL / SQL过程。
                     </li>
                  </ul>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="../dvadm/dba-operations-in-an-oracle-database-vault-environment.html#DVADM-GUID-17665902-E9F9-479A-B60A-29853672BB2B" target="_blank">Oracle Database Vault环境中的DBA操作<span><cite>Oracle Database Vault管理员指南</cite></span></a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-5CD1D1E7-2435-4331-876F-34C5AE04BAD3" title="您可以在多租户容器数据库（CDB）中使用Oracle Database Vault。">将Oracle Database Vault与CDB一起使用</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="sect3"><a id="GUID-1A67C2FE-A83C-4B5F-AB2E-1A7E96922064" name="GUID-1A67C2FE-A83C-4B5F-AB2E-1A7E96922064"></a><h4 id="MULTI-GUID-1A67C2FE-A83C-4B5F-AB2E-1A7E96922064" class="sect4"><span class="enumeration_section">24.9.1</span>关于使用Database Vault Operations Control</h4>
                  <div>
                     <p>您可以自动限制普通用户访问自治，常规云或内部部署环境中的可插拔数据库（PDB）本地数据。</p>
                     <p>要实现此目的，您可以使用Oracle Database Vault操作控制，该控制适用于普通用户（例如基础架构数据库管理员和应用程序）。</p>
                     <p>Database Vault操作控制对于数据库管理员必须以高权限用户身份登录CDB根目录但仍无法访问PDB客户数据的情况非常有用。数据库操作控制不会阻止PDB数据库管理员。要阻止这些用户，请在PDB中启用Oracle Database Vault，然后使用域库控制等数据库保险库功能来阻止这些用户。</p>
                     <p>对于公共用户或应用程序必须执行必须访问PDB上的本地数据的任务的情况，您可以为公共用户和程序包的Database Vault操作控制创建例外列表。您要为例外列表指定的普通用户类型的示例是<code class="codeph">CTXSYS</code>应用程序帐户，该帐户负责Oracle Text。通过在例外列表中指定包，您可以应用更细粒度的控件，而不是在例外列表中提供对用户的完全访问权限。
                     </p>
                     <p>使用Database Vault操作控制的一般过程如下：</p>
                     <ol id="GUID-1A67C2FE-A83C-4B5F-AB2E-1A7E96922064__OL_JMR_TFW_Q2B">
                        <li>启用Database Vault操作控制并为生产环境启用它。</li>
                        <li>在此阶段，无论PDB是否已启用Database Vault，Database Vault操作控制都适用于环境中的所有PDB。</li>
                        <li>要使特定用户和程序包能够访问PDB的本地模式，请将它们添加到例外列表中。当用户或包不再需要访问权限时，您可以从例外列表中删除它们。例如，如果数据库使用的是Oracle Text，则可以将<code class="codeph">CTXSYS</code>管理用户帐户和程序包添加到例外列表中。
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-E04CBDD1-17F0-4942-BF78-21C340A4425F" title="您可以通过CDB根公共用户（例如基础结构数据库管理员）控制PDB访问。">使用Database Vault Operations Control限制多租户公共用户对本地PDB数据的访问</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-9CC9C99D-7168-4C39-8380-81C1CBF1E8C3" name="GUID-9CC9C99D-7168-4C39-8380-81C1CBF1E8C3"></a><h4 id="MULTI-GUID-9CC9C99D-7168-4C39-8380-81C1CBF1E8C3" class="sect4"><span class="enumeration_section">24.9.2</span>启用Database Vault Operations Control</h4>
                  <div>
                     <p>要启用Database Vault操作控制，请使用<code class="codeph">DBMS_MACADM.ENABLE_APP_PROTECTION</code> PL / SQL过程。
                     </p>
                     <div class="section">
                        <p>Oracle建议，如果您选择对多租户生产服务器使用Database Vault操作控制，则应始终启用Database Vault操作控制。</p>在大多数情况下，您将为整个CDB启用数据库操作控制，而不仅仅是特定的PDB。如果需要为特定PDB禁用它（例如，用于故障排除），则可以在PDB上执行<code class="codeph">DBMS_MACADM.DISABLE_APP_PROTECTION</code>过程。完成PDB故障排除后，请重新启用它以进行Database Vault操作控制，如本主题中的示例所示。
                     </div>
                     <!-- class="section" -->
                     <div class="p">在启用Database Vault操作控制之前，必须在CDB根目录中启用并配置Database Vault。但是，不需要在PDB中启用Database Vault。</div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>以已被授予<code class="codeph">DV_OWNER</code>角色的普通用户身份登录CDB根目录。</span><div>例如：<pre class="pre codeblock"><code>sqlplus c ## sec_admin_owen_root输入密码： <span class="italic">密码</span>  </code></pre></div>
                        </li>
                        <li class="stepexpand"><span>执行<code class="codeph">DBMS_MACADM.ENABLE_APP_PROTECTION</code>过程。</span><ul id="GUID-9CC9C99D-7168-4C39-8380-81C1CBF1E8C3__CHOICES_YPW_BBS_R2B">
                              <li>要为CDB环境中的所有PDB启用Database Vault操作控制：<pre class="pre codeblock"><code>EXEC DBMS_MACADM.ENABLE_APP_PROTECTION;</code></pre></li>
                              <li>要为特定PBB启用Database Vault操作控制（例如， <code class="codeph">HRPDB</code> ）：<pre class="pre codeblock"><code>EXEC DBMS_MACADM.ENABLE_APP_PROTECTION（'HRPDB'）;</code></pre></li>
                           </ul>
                        </li>
                     </ol>
                     <div class="section">在此阶段，启用一个或所有PDB以进行Database Vault操作控制。如果特定的受信任公共用户或程序包必须能够访问这些PDB的本地模式以执行特殊操作，则可以使用<code class="codeph">DBMS_MACADM.ADD_APP_EXCEPTION</code>过程将用户或程序包添加到Database Vault操作控制的例外列表中。
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="../dvadm/dba-operations-in-an-oracle-database-vault-environment.html#DVADM-GUID-00868C98-FC37-49BC-B867-558B9FB27B6A" target="_blank">将公共用户和软件包添加到例外列表<span><cite>Oracle Database Vault管理员指南</cite></span></a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-E04CBDD1-17F0-4942-BF78-21C340A4425F" title="您可以通过CDB根公共用户（例如基础结构数据库管理员）控制PDB访问。">使用Database Vault Operations Control限制多租户公共用户对本地PDB数据的访问</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-00868C98-FC37-49BC-B867-558B9FB27B6A" name="GUID-00868C98-FC37-49BC-B867-558B9FB27B6A"></a><h4 id="MULTI-GUID-00868C98-FC37-49BC-B867-558B9FB27B6A" class="sect4"><span class="enumeration_section">24.9.3</span>将普通用户和包添加到例外列表</h4>
                  <div>
                     <p>必须访问PDB本地数据的公共用户和应用程序可以添加到例外列表中。</p>
                     <div class="section">如果程序包是用户帐户中唯一需要访问PDB本地数据的对象，请将用户程序包添加到例外列表中。这允许对放入例外列表的内容进行细粒度控制。您要添加到例外列表中的常见用户和包的类型是PDB运行所必需的。例如，如果您使用的是Oracle Spatial，则应将<code class="codeph">MDSYS</code>帐户添加到例外列表中。<code class="codeph">MDSYS</code>需要访问Oracle Spatial功能的客户PDB数据。要将公共用户和程序包添加到Database Vault操作控制例外列表，可以使用<code class="codeph">DBMS_MACADM.ADD_APP_EXCEPTION</code> PL / SQL过程。要查找现有异常，可以查询<code class="codeph">DBA_DV_APP_EXCEPTION</code>数据字典视图。
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>以已被授予<code class="codeph">DV_OWNER</code>角色的普通用户身份登录CDB根目录。</span><div>例如：<pre class="pre codeblock"><code>qlplus c ## sec_admin_owen_root输入密码： <span class="italic">密码</span></code></pre></div>
                        </li>
                        <li class="stepexpand"><span>确保您为普通用户指定的包满足以下要求：</span><div>
                              <ul id="GUID-00868C98-FC37-49BC-B867-558B9FB27B6A__UL_RMR_XVN_S2B" style="list-style-type:disc">
                                 <li>包必须由普通用户拥有。</li>
                                 <li>必须使用定义者权限过程创建用户创建的包。</li>
                              </ul>
                              <p>您可以通过查询<code class="codeph">DBA_OBJECTS</code>数据字典视图找到有关用户创建的包的更多信息。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>执行<code class="codeph">DBMS_MACADM.ADD_APP_EXCEPTION</code>过程。</span><div>例如：<pre class="pre codeblock"><code>DBMS_MACADM.ADD_APP_EXCEPTION（'MDSYS'，'PATCH_APP'）;</code></pre></div>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-E04CBDD1-17F0-4942-BF78-21C340A4425F" title="您可以通过CDB根公共用户（例如基础结构数据库管理员）控制PDB访问。">使用Database Vault Operations Control限制多租户公共用户对本地PDB数据的访问</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-57584CE8-8BC0-40DA-A446-A45AFF882726" name="GUID-57584CE8-8BC0-40DA-A446-A45AFF882726"></a><h4 id="MULTI-GUID-57584CE8-8BC0-40DA-A446-A45AFF882726" class="sect4"><span class="enumeration_section">24.9.4</span>从例外列表中删除公共用户和包</h4>
                  <div>
                     <p>可以从例外列表中删除不再需要访问PDB本地数据的用户和应用程序。</p>
                     <div class="section">要从Database Vault操作控制例外列表中删除公共用户和包，可以使用<code class="codeph">DBMS_MACADM.DELETE_APP_PROTECTION</code> PL / SQL过程。要查找现有异常，可以查询<code class="codeph">DBA_DV_APP_EXCEPTION</code>数据字典视图。
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>以已被授予<code class="codeph">DV_OWNER</code>角色的普通用户身份登录CDB根目录。</span><div>例如：<pre class="pre codeblock"><code>sqlplus c ## sec_admin_owen_root输入密码： <span class="italic">密码</span>  </code></pre></div>
                        </li>
                        <li class="stepexpand"><span>执行<code class="codeph">DBMS_MACADM.DELETE_APP_EXCEPTION</code>过程。</span><div>例如：<pre class="pre codeblock"><code>DBMS_MACADM.DELETE_APP_EXCEPTION（'MDSYS'，'PATCH_APP'）;</code></pre></div>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-E04CBDD1-17F0-4942-BF78-21C340A4425F" title="您可以通过CDB根公共用户（例如基础结构数据库管理员）控制PDB访问。">使用Database Vault Operations Control限制多租户公共用户对本地PDB数据的访问</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-D23A52A4-0556-4F71-9157-6CC081EF7819" name="GUID-D23A52A4-0556-4F71-9157-6CC081EF7819"></a><h4 id="MULTI-GUID-D23A52A4-0556-4F71-9157-6CC081EF7819" class="sect4"><span class="enumeration_section">24.9.5</span>禁用Database Vault Operations Control</h4>
                  <div>
                     <p>要禁用Database Vault操作控制，请使用<code class="codeph">DBMS_MACADM.DISABLE_APP_PROTECTION</code> PL / SQL过程。
                     </p>
                     <div class="section">在大多数情况下，您应该启用Database Vault操作控制。如果故障排除要求从Database Vault操作控制中删除PDB，则Oracle建议您临时禁用PDB的Database Vault操作控制（并维护其余PDB的操作控制）。完成故障排除后，您应该重新启用Database Vault操作控制。</div>
                     <!-- class="section" -->
                     <ol id="GUID-D23A52A4-0556-4F71-9157-6CC081EF7819__STEPS_HFJ_TSX_Q2B">
                        <li class="stepexpand"><span>以已被授予<code class="codeph">DV_OWNER</code>角色的普通用户身份登录CDB根目录。</span><div>例如：<pre class="pre codeblock"><code>sqlplus c ## sec_admin_owen_root输入密码： <span class="italic">密码</span>  </code></pre></div>
                        </li>
                        <li class="stepexpand"><span>执行<code class="codeph">DBMS_MACADM.DISABLE_APP_PROTECTION</code>过程。</span><ul id="GUID-D23A52A4-0556-4F71-9157-6CC081EF7819__CHOICES_YPW_BBS_R2B">
                              <li>要为CDB环境中的所有PDB禁用Database Vault操作控制：<pre class="pre codeblock"><code>EXEC DBMS_MACADM.DISABLE_APP_PROTECTION;</code></pre></li>
                              <li>要禁用特定PBB的Database Vault操作控制（例如， <code class="codeph">HRPDB</code> ）：<pre class="pre codeblock"><code>EXEC DBMS_MACADM.DISABLE_APP_PROTECTION（'HRPDB'）;</code></pre></li>
                           </ul>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-E04CBDD1-17F0-4942-BF78-21C340A4425F" title="您可以通过CDB根公共用户（例如基础结构数据库管理员）控制PDB访问。">使用Database Vault Operations Control限制多租户公共用户对本地PDB数据的访问</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
            <div class="props_rev_3"><a id="GUID-517E9611-546B-43D9-8C54-37037AF0B198" name="GUID-517E9611-546B-43D9-8C54-37037AF0B198"></a><h3 id="MULTI-GUID-517E9611-546B-43D9-8C54-37037AF0B198" class="sect3"><span class="enumeration_section">24.10</span>将独立Oracle数据库转换为PDB并将其插入CDB</h3>
               <div>
                  <p>您可以将独立的Oracle Database Release 12c或更高版本的数据库转换为PDB，然后将此PDB插入CDB。</p>
                  <ol>
                     <li class="stepexpand"><span>以已被授予<code class="codeph">DV_OWNER</code>角色的用户身份连接到root。</span><div>
                           <p>例如：</p><pre class="pre codeblock"><code>sqlplus c ## sec_admin输入密码： <span class="italic">密码</span>
</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>使用<code class="codeph">CONTAINER = CURRENT</code>将<code class="codeph">DV_PATCH_ADMIN</code>角色授予用户<code class="codeph">SYS</code> 。</span><div><pre class="pre codeblock"><code>GRANT DV_PATCH_ADMIN TO SYS CONTAINER = CURRENT;</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>在根目录中，以<code class="codeph">SYS</code>用户身份连接<code class="codeph">SYSOPER</code>系统特权。</span><div>
                           <p>例如：</p><pre class="pre codeblock"><code>将SYS作为SYSOPER连接<span class="italic">- 或者，连接SYS @hrpdb AS SYSOPER</span>输入密码： <span class="italic">password</span>
</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>以只读模式重新启动数据库。</span><div>
                           <p>例如：</p><pre class="pre codeblock"><code>SHUTDOWN立即启动安装ALTER DATABASE OPEN READ ONLY</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>以具有<code class="codeph">DV_OWNER</code>角色的用户身份连接到启用Database Vault的数据库。</span><div>
                           <p>例如：</p><pre class="pre codeblock"><code>CONNECT sec_admin @ dv_db</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>将<code class="codeph">DV_PATCH_ADMIN</code>角色授予此数据库上的用户<code class="codeph">SYS</code> 。</span><div><pre class="pre codeblock"><code>GRANT DV_PATCH_ADMIN TO SYS;</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>（可选）运行<code class="codeph">DBMS_PDB.CHECK_PLUG_COMPATIBILITY</code>函数以确定未插入的PDB是否与CDB兼容。</span><div>
                           <p>运行该功能时，请设置以下参数：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><code class="codeph">pdb_descr_file</code> ：将此参数设置为包含PDB描述的XML文件的完整路径。</p>
                              </li>
                              <li>
                                 <p><code class="codeph">store_report</code> ：设置此参数以指示在PDB与CDB不兼容时是否要生成报告。将其设置为<code class="codeph">TRUE</code>以生成报告，或将其设置为<code class="codeph">FALSE</code>以不生成报告。生成的报告存储在<code class="codeph">PDB_PLUG_IN_VIOLATIONS</code>临时表中，仅在PDB与CDB不兼容时生成。</p>
                              </li>
                           </ul>
                           <p>例如，要确定<code class="codeph">/disk1/usr/dv_db_pdb.xml</code>文件描述的PDB是否与当前CDB兼容，请运行以下PL / SQL块：</p><pre class="pre codeblock"><code>SET SERVEROUTPUT ON DECLARE兼容的CONSTANT VARCHAR2（3）：= CASE DBMS_PDB.CHECK_PLUG_COMPATIBILITY（pdb_descr_file =&gt;'/disk1 / usr / dv_db_pdb.xml'，store_report =&gt; TRUE）当为“是”时，“否”结束; BEGIN DBMS_OUTPUT.PUT_LINE（兼容）;结束; /</code></pre><p>如果输出为<code class="codeph">YES</code> ，则PDB兼容，您可以继续下一步。
                           </p>
                           <p>如果输出为<code class="codeph">NO</code> ，则PDB不兼容。您可以检查<code class="codeph">PDB_PLUG_IN_VIOLATIONS</code>临时表以查看它不兼容的原因。
                           </p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>创建描述PDB的XML文件。</span><div>
                           <p>例如：</p><pre class="pre codeblock"><code>BEGIN DBMS_PDB.DESCRIBE（pdb_descr_file =&gt;'/disk1 / oracle / dv_db.xml'）;结束; /</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>运行<code class="codeph">CREATE PLUGGABLE DATABASE</code>语句，并在<code class="codeph">USING</code>子句中指定XML文件。在需要时指定其他子句。</span><div>
                           <p>例如：</p><pre class="pre codeblock"><code>使用'dv_db.xml'NOCOPY创建可插入数据库dv_db_pdb AS CLONE;</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>使用<code class="codeph">SYSDBA</code>管理权限连接到您刚刚以<code class="codeph">SYS</code>用户身份创建的PDB。</span><div><pre class="pre codeblock"><code>CONNECT SYS @ dv_db_pdb AS SYSDBA</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>执行<code class="codeph">noncdb_to_pdb.sql</code>脚本。</span><div><pre class="pre codeblock"><code>@ $ ORACLE_HOME / RDBMS /管理/ noncdb_to_pdb.sql</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>以读/写限制模式打开此PDB。</span><div><pre class="pre codeblock"><code>ALTER PLUGGABLE DATABASE dv_db_pdb OPEN READ WRITE RESTRICTED;</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>运行以下过程以同步PDB：</span><div><pre class="pre codeblock"><code>EXECUTE DBMS_PDB.SYNC_PDB;</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>以已被授予<code class="codeph">DV_OWNER</code>角色的用户身份连接到root。</span><div><pre class="pre codeblock"><code>sqlplus c ## sec_admin输入密码： <span class="italic">密码</span>
</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>使用<code class="codeph">CONTAINER = CURRENT</code>从用户<code class="codeph">SYS</code>撤消<code class="codeph">DV_PATCH_ADMIN</code>角色。</span><div><pre class="pre codeblock"><code>从SYS CONTAINER RETROKE DV_PATCH_ADMIN = CURRENT;</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>使用具有<code class="codeph">SYSOPER</code>系统特权的用户<code class="codeph">SYS</code>连接到启用Database Vault的旧数据库。</span><div><pre class="pre codeblock"><code>作为SYSOPER连接SYS @ dv_db_pdb</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>重启此数据库。</span><div>
                           <p>例如：</p><pre class="pre codeblock"><code>关闭IMIMEDIATE STARUP</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>从用户<code class="codeph">SYS</code>撤消<code class="codeph">DV_PATCH_ADMIN</code>角色。</span><div><pre class="pre codeblock"><code>从SYS中撤消DV_PATCH_ADMIN;</code></pre></div>
                     </li>
                  </ol>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="creating-pdbs.html#GUID-9A250D93-5B3B-4643-BE85-F32CC7B0E413" title="您可以使用各种技术创建PDB，应用程序容器和应用程序种子。">创建和删除PDB和应用程序容器</a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-5CD1D1E7-2435-4331-876F-34C5AE04BAD3" title="您可以在多租户容器数据库（CDB）中使用Oracle Database Vault。">将Oracle Database Vault与CDB一起使用</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
         </div>
      </article>
   </body>
</html>