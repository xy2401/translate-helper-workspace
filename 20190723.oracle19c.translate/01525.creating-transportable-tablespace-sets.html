<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="This chapter explains how to use RMAN to create transportable tablespace sets by restoring backups."></meta>
      <meta name="description" content="This chapter explains how to use RMAN to create transportable tablespace sets by restoring backups."></meta>
      <title>创建可传输的表空间集</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Backup and Recovery User&#39;s Guide"></meta>
      <meta property="og:description" content="This chapter explains how to use RMAN to create transportable tablespace sets by restoring backups."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Backup and Recovery User&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="database-backup-and-recovery-users-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-09T05:20:45-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2003, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96241-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="rman-duplicating-databases-advanced.html" title="Previous" type="text/html"></link>
      <link rel="next" href="rman-transporting-data-across-platforms.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database Backup and Recovery User&#39;s Guide"></meta>
    <meta name="dcterms.isVersionOf" content="BRADV"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="rman-duplicating-databases-advanced.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="rman-transporting-data-across-platforms.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">备份和恢复用户指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="part-transfering-data-rman.html" property="item" typeof="WebPage"><span property="name">使用RMAN传输数据</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">创建可传输的表空间集</li>
            </ol>
            <a id="GUID-123F4E45-0324-4D1D-980F-E176A9E22C87" name="GUID-123F4E45-0324-4D1D-980F-E176A9E22C87"></a><a id="BRADV05141"></a>
            
            <h2 id="BRADV-GUID-123F4E45-0324-4D1D-980F-E176A9E22C87" class="sect2"><span class="enumeration_chapter">27</span>创建可传输表空间集</h2>
         </header>
         <div class="ind">
            <div>
               <p>本章介绍如何使用RMAN通过还原备份来创建可传输的表空间集。</p>
               <p>本章包含以下部分：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="creating-transportable-tablespace-sets.html#GUID-E118186B-AF31-4CD1-ABA7-2C9F1A07EB98" title="您可以使用RMAN或可传输表空间功能来创建可传输的表空间集。">创建可传输表空间集的概述</a></p>
                  </li>
                  <li>
                     <p><a href="creating-transportable-tablespace-sets.html#GUID-2FE8ECB5-8D0F-490F-889D-3B867D3F29ED" title="RMAN使您可以自定义用于辅助实例的初始化参数。">自定义辅助实例的初始化参数</a></p>
                  </li>
                  <li>
                     <p><a href="creating-transportable-tablespace-sets.html#GUID-B52E4D68-4F7F-4E4F-9F9E-53EEB1982047" title="此过程描述了TRANSPOR TTABLESPACE在最基本和自动化的情况下的使用。">创建可传输的表空间集</a></p>
                  </li>
                  <li>
                     <p><a href="creating-transportable-tablespace-sets.html#GUID-4486B94F-E39B-4E40-8D7D-9F6C65904E01" title="当RMAN TRANSPORT TABLESPACE命令失败时，失败的辅助实例文件在辅助实例目标中保持不变，以进行故障排除。">对可传输表空间集的创建进行故障诊断</a></p>
                  </li>
                  <li>
                     <p><a href="creating-transportable-tablespace-sets.html#GUID-8692A076-0EF0-4B98-8381-957D143D2CDC" title="您可以使用TRANSPORT TABLESPACE命令指定目标时间或SCN。在表空间传输操作期间，RMAN使用目标时间之前的备份还原辅助实例上的表空间，并在辅助数据库上执行指定目标时间的时间点恢复。必须提供此时间点恢复所需的备份和归档重做日志。您可以更改可传输集的数据泵导出转储文件的名称，目标数据库中使用的样本导入脚本，Data Pump Export生成的日志文件以及写入它们的目录。有几条规则适用于传输过程中创建的辅助实例文件的位置。您可以使用SET NEWNAME命令指定辅助数据文件的位置。您可以使用CONFIGURE AUXNAME命令为可传输表空间集或辅助集数据文件指定持久位置。在恢复之前，RMAN将已使用CONFIGURE AUXNAME命令的每个数据文件还原到指定位置。除非操作失败，否则RMAN会在操作完成时删除辅助设置数据文件。如果对TRANSPORT TABLESPACE命令使用AUXILIARY DESTINATION选项，则在TRANSPORT TABLESPACE操作期间，使用SET NEWNAME或CONFIGURE AUXNAME命令未移动到其他位置的任何辅助集文件都将存储在辅助目标中。您可以使用辅助实例参数文件中的LOG_FILE_NAME_CONVERT和DB_FILE_NAME_CONVERT初始化参数来确定辅助实例上的联机重做日志和其他数据库文件的名称。如果在TRANSPORT TABLESPACE命令中未指定AUXILIARY DESTINATION子句，则这些参数将确定未运行CONFIGURE AUXNAME或SET NEWNAME命令的任何文件的位置。">可传输表空间集方案</a></p>
                  </li>
               </ul>
            </div><a id="BRADV89959"></a><div class="props_rev_3"><a id="GUID-E118186B-AF31-4CD1-ABA7-2C9F1A07EB98" name="GUID-E118186B-AF31-4CD1-ABA7-2C9F1A07EB98"></a><h3 id="BRADV-GUID-E118186B-AF31-4CD1-ABA7-2C9F1A07EB98" class="sect3"><span class="enumeration_section">27.1</span>创建可传输表空间集的概述</h3>
               <div>
                  <p>您可以使用RMAN或可传输表空间功能来创建可传输的表空间集。</p>
                  <p>本节介绍从RMAN备份创建可传输表空间集所涉及的基本概念和任务。本章中的讨论假定您熟悉<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=ADMIN01101" target="_blank"><span><cite>Oracle数据库管理员指南中</cite></span></a>描述的可<a href="glossary.html#GUID-E843F9DE-6FCC-4614-BA56-486F6D9BBD25"><span class="xrefglossterm">传输表空间</span></a>过程。本章中的过程是生成可传输表空间集的替代技术。
                  </p>
               </div><a id="BRADV89960"></a><div class="props_rev_3"><a id="GUID-BA6B8057-FC2C-429F-BF76-E17245231E47" name="GUID-BA6B8057-FC2C-429F-BF76-E17245231E47"></a><h4 id="BRADV-GUID-BA6B8057-FC2C-429F-BF76-E17245231E47" class="sect4"><span class="enumeration_section">27.1.1</span>创建可传输表空间集的目的</h4>
                  <div>
                     <p>可传输表空间集包含一组表空间的数据文件和包含表空间集的结构元数据的导出文件。导出文件由Data Pump Export生成。</p>
                     <p>可传输表空间集的一个用途是创建表空间存储库。例如，如果您有一个数据库，其中一些表空间用于季度报告，则可以为这些表空间创建可传输集，以便存储在表空间存储库中。随后，可以从存储库请求表空间的版本并将其附加到另一个数据库以用于生成报告。</p>
                     <p>RMAN <code class="codeph">TRANSPORT TABLESPACE</code>命令的一个主要优点是它不需要从要传输的表空间访问实时数据文件。相反， <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=ADMIN01101" target="_blank"><span><cite>Oracle数据库管理员指南中</cite></span></a>描述的可传输表空间技术要求在传输过程中要传输的表空间是只读的。因此，从备份传输可提高数据库可用性，尤其是对于大型表空间，因为要传输的表空间可以在操作期间保持打开以进行写入。此外，将表空间置于只读模式可能需要很长时间，具体取决于当前的数据库活动。
                     </p>
                     <p>RMAN <code class="codeph">TRANSPORT TABLESPACE</code>命令还允许您在恢复窗口期间指定目标时间点，SCN或还原点，并传输当时存在的表空间数据。例如，如果您的<a href="glossary.html#GUID-ECF0ADBB-3255-43A2-A425-26850EA598EA"><span class="xrefglossterm">备份保留策略</span></a>保证1周的恢复窗口，并且您希望在该月的最后一天根据数据库的内容创建可传输的表空间，则RMAN可以在第一天的任何时间执行此任务下个月的一周。
                     </p>
                  </div>
               </div><a id="BRADV464"></a><a id="BRADV89961"></a><div class="props_rev_3"><a id="GUID-07595E7B-3712-4AEF-A5EC-EBF05B623B75" name="GUID-07595E7B-3712-4AEF-A5EC-EBF05B623B75"></a><h4 id="BRADV-GUID-07595E7B-3712-4AEF-A5EC-EBF05B623B75" class="sect4"><span class="enumeration_section">27.1.2可</span>传输表空间集的基本概念</h4>
                  <div>
                     <p>通过将RMAN连接到源数据库作为<code class="codeph">TARGET</code> ，然后执行<code class="codeph">TRANSPORT TABLESPACE</code>命令，可以创建可传输的表空间集。源数据库包含要传输的表空间。
                     </p>
                     <p>您必须备份所有必需的表空间和可供RMAN使用的归档重做日志文件，这些文件可以恢复到<code class="codeph">TRANSPORT TABLESPACE</code>操作的目标时间点。<a href="creating-transportable-tablespace-sets.html#GUID-07595E7B-3712-4AEF-A5EC-EBF05B623B75__CHDBFHBE">图27-1</a>说明了可传输表空间创建的基本过程。
                     </p>
                     <div class="figure" id="GUID-07595E7B-3712-4AEF-A5EC-EBF05B623B75__CHDBFHBE">
                        <p class="titleinfigure">图27-1备份中的RMAN可传输表空间：体系结构</p><img src="img/bradv037.gif" width="413" alt="下面是图27-1的描述" title="下面是图27-1的描述" longdesc="img_text/bradv037.html"><br><a href="img_text/bradv037.html">“图27-1备份中的RMAN可传输表空间：体系结构”的说明</a></div>
                     <!-- class="figure" -->
                     <p><a href="creating-transportable-tablespace-sets.html#GUID-07595E7B-3712-4AEF-A5EC-EBF05B623B75__CHDBFHBE">图27-1</a>中显示的过程发生在以下阶段：</p>
                     <ol>
                        <li>
                           <p>RMAN启动<a href="glossary.html#GUID-4B8BBEA0-2F0F-4C5E-AE69-F1EE4DBA1B46"><span class="xrefglossterm">辅助实例</span></a> 。
                           </p>
                           <p>RMAN在与源数据库相同的主机上创建辅助实例，以执行表空间的还原和恢复。RMAN自动为辅助实例创建初始化参数文件，并将其启动为<code class="codeph">NOMOUNT</code> 。</p>
                        </li>
                        <li>
                           <p>RMAN恢复源数据库控制文件的备份以用作辅助实例控制文件并安装此控制文件。</p>
                        </li>
                        <li>
                           <p>RMAN从源数据库的备份中恢复<a href="glossary.html#GUID-C83736EA-941E-40D5-9BC4-04AD86D5CDB2"><span class="xrefglossterm">辅助集</span></a>和可传输集数据文件。
                           </p>
                           <p>辅助集包括表空间传输所需的数据文件和其他文件，但它们本身不是可传输表空间集的一部分。辅助集通常包括<code class="codeph">SYSTEM</code>和<code class="codeph">SYSAUX</code>表空间，临时文件以及包含回滚或撤消段的数据文件。辅助实例具有与之关联的其他文件，例如其自己的控制文件，参数文件和联机日志，但它们不是辅助集的一部分。
                           </p>
                           <p>RMAN将辅助数据文件存储在所选的<a href="glossary.html#GUID-84F742CC-9172-4616-90AA-43CED507D4BB"><span class="xrefglossterm">辅助目标中</span></a> 。辅助目标是一个磁盘位置，RMAN可以在传输过程中存储辅助设置文件，如参数文件，数据文件（可传输集中的数据文件除外），控制文件和辅助实例的在线日志。如果传输成功，则RMAN将删除这些文件。
                           </p>
                           <p>RMAN将可传输集文件存储在<a href="glossary.html#GUID-D4C76365-E59D-4B5B-B62F-7E20F259BAA0"><span class="xrefglossterm">表空间目标中</span></a> 。表空间目标是一个磁盘位置，默认情况下，包含表空间传输命令完成时的数据文件副本和其他输出文件。
                           </p>
                        </li>
                        <li>
                           <p>RMAN在辅助实例上执行<a href="glossary.html#GUID-FCC8BB91-79B6-4AF1-974A-43E75CD161E3"><span class="xrefglossterm">数据库时间点恢复（DBPITR）</span></a> 。
                           </p>
                           <p>恢复将辅助和可传输的设置数据文件更新为其为<code class="codeph">TRANSPORT</code> <code class="codeph">TABLESPACE</code>命令指定的目标时间的内容。如果未指定目标时间，则RMAN将恢复所有可用的重做。RMAN在辅助目标（或其他位置）根据需要从备份还原已归档的重做日志，并在应用它们后将其删除。
                           </p>
                        </li>
                        <li>
                           <p>RMAN使用<code class="codeph">RESETLOGS</code>选项打开辅助数据库。
                           </p>
                           <p>数据文件现在反映表空间传输操作的目标SCN的表空间内容。</p>
                        </li>
                        <li>
                           <p>RMAN将辅助实例的可传输集合表空间置于只读模式。RMAN还以可传输的表空间模式调用Data Pump Export，以便为可传输集创建<a href="glossary.html#GUID-5C2A79F3-E089-41DC-B3F5-879FB6125CE5"><span class="xrefglossterm">导出转储文件</span></a> 。
                           </p>
                           <p>默认情况下，转储文件位于表空间目标中。您可以为转储文件指定备用位置。</p>
                           <p>RMAN还生成示例数据泵导入脚本，以便在插入目标数据库中的传输表空间时使用。此脚本的内容将写入表空间目标中名为<code class="codeph">impscript.sql</code>的文件中。该脚本的命令也包含在RMAN命令输出中。
                           </p>
                        </li>
                        <li>
                           <p>如果上述步骤成功，则RMAN将关闭辅助实例并删除在<code class="codeph">TRANSPORT</code> <code class="codeph">TABLESPACE</code>操作期间创建的所有文件，但可传输的set文件，Data Pump Export文件和示例导入脚本除外。
                           </p>
                        </li>
                     </ol>
                     <div class="infoboxnotealso" id="GUID-07595E7B-3712-4AEF-A5EC-EBF05B623B75__GUID-4D9E97EE-8FCC-4068-9A03-F0AF9E903519">
                        <p class="notep1">也可以看看：</p>
                        <p><span class="q">“ <a href="creating-transportable-tablespace-sets.html#GUID-4F402748-9F8E-4067-A579-F58A3399FE9A" title="您可以更改可传输集的数据泵导出转储文件的名称，目标数据库中使用的样本导入脚本，Data Pump Export生成的日志文件以及写入它们的目录。">指定数据泵文件的位置</a> ”</span></p>
                     </div>
                  </div>
               </div><a id="BRADV89962"></a><div class="props_rev_3"><a id="GUID-C558C7F8-9620-4E89-AC34-E65FEEF06D9F" name="GUID-C558C7F8-9620-4E89-AC34-E65FEEF06D9F"></a><h4 id="BRADV-GUID-C558C7F8-9620-4E89-AC34-E65FEEF06D9F" class="sect4"><span class="enumeration_section">27.1.3</span>创建可传输表空间集的基本步骤</h4>
                  <div>
                     <p>要创建可传输的表空间集，请在辅助实例初始化参数文件中设置所需的参数，然后使用<code class="codeph">TRANSPORT TABLESPACE</code>命令。
                     </p>
                     <div class="section">
                        <p>在创建可传输表空间集之前，必须满足几个先决条件。</p>
                        <p>创建可传输表空间集的基本步骤如下：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>启动RMAN客户端并连接到源数据库，如果使用，则连接到恢复目录。</span></li>
                        <li class="stepexpand"><span>确保满足<code class="codeph">TRANSPORT TABLESPACE</code>命令的先决条件。</span></li>
                        <li class="stepexpand"><span>如有必要，请在辅助实例参数文件中设置其他参数。</span><div>
                              <p><span class="q">“ <a href="creating-transportable-tablespace-sets.html#GUID-2FE8ECB5-8D0F-490F-889D-3B867D3F29ED" title="RMAN使您可以自定义用于辅助实例的初始化参数。">自定义辅助实例的初始化参数</a> ”中</span>介绍了此任务。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>执行<code class="codeph">TRANSPORT TABLESPACE</code>命令。</span><div>
                              <p><span class="q">“ <a href="creating-transportable-tablespace-sets.html#GUID-B52E4D68-4F7F-4E4F-9F9E-53EEB1982047" title="此过程描述了TRANSPOR TTABLESPACE在最基本和自动化的情况下的使用。">创建可传输表空间集</a> ”中</span>描述了这种基本技术。<span class="q">“可<a href="creating-transportable-tablespace-sets.html#GUID-8692A076-0EF0-4B98-8381-957D143D2CDC" title="您可以使用TRANSPORT TABLESPACE命令指定目标时间或SCN。在表空间传输操作期间，RMAN使用目标时间之前的备份还原辅助实例上的表空间，并在辅助数据库上执行指定目标时间的时间点恢复。必须提供此时间点恢复所需的备份和归档重做日志。您可以更改可传输集的数据泵导出转储文件的名称，目标数据库中使用的样本导入脚本，Data Pump Export生成的日志文件以及写入它们的目录。有几条规则适用于传输过程中创建的辅助实例文件的位置。您可以使用SET NEWNAME命令指定辅助数据文件的位置。您可以使用CONFIGURE AUXNAME命令为可传输表空间集或辅助集数据文件指定持久位置。在恢复之前，RMAN将已使用CONFIGURE AUXNAME命令的每个数据文件还原到指定位置。除非操作失败，否则RMAN会在操作完成时删除辅助设置数据文件。如果对TRANSPORT TABLESPACE命令使用AUXILIARY DESTINATION选项，则在TRANSPORT TABLESPACE操作期间，使用SET NEWNAME或CONFIGURE AUXNAME命令未移动到其他位置的任何辅助集文件都将存储在辅助目标中。您可以使用辅助实例参数文件中的LOG_FILE_NAME_CONVERT和DB_FILE_NAME_CONVERT初始化参数来确定辅助实例上的联机重做日志和其他数据库文件的名称。如果在TRANSPORT TABLESPACE命令中未指定AUXILIARY DESTINATION子句，则这些参数将确定未运行CONFIGURE AUXNAME或SET NEWNAME命令的任何文件的位置。">传输表空间集方案</a> ”</span>中描述了此技术的变体。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>如果<code class="codeph">TRANSPORT TABLESPACE</code>命令失败，请解决问题，然后重试该命令，直到成功为止。</span><div>
                              <p><span class="q">“可<a href="creating-transportable-tablespace-sets.html#GUID-4486B94F-E39B-4E40-8D7D-9F6C65904E01" title="当RMAN TRANSPORT TABLESPACE命令失败时，失败的辅助实例文件在辅助实例目标中保持不变，以进行故障排除。">传输表空间集的创建故障排除</a> ”中</span>描述了该技术。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>返回“ <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=ADMIN01101" target="_blank"><span><cite>Oracle数据库管理员指南”中</cite></span></a>描述的传输表空间的过程。</span></li>
                     </ol>
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-C558C7F8-9620-4E89-AC34-E65FEEF06D9F__GUID-DE3FE150-4979-40A2-8C90-C6376E7714FD">
                           <p class="notep1">也可以看看：</p>
                           <p>有关<code class="codeph">TRANSPORT TABLESPACE</code>命令先决条件的<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=RCMRF1919" target="_blank"><span><cite>Oracle数据库备份和恢复参考</cite></span></a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="BRADV89963"></a><div class="props_rev_3"><a id="GUID-2FE8ECB5-8D0F-490F-889D-3B867D3F29ED" name="GUID-2FE8ECB5-8D0F-490F-889D-3B867D3F29ED"></a><h3 id="BRADV-GUID-2FE8ECB5-8D0F-490F-889D-3B867D3F29ED" class="sect3"><span class="enumeration_section">27.2</span>自定义辅助实例的初始化参数</h3>
               <div>
                  <p>RMAN使您可以自定义用于辅助实例的初始化参数。</p>
                  <div class="section">
                     <p>当RMAN创建辅助实例时，它会创建初始化参数文件。默认值适用于大多数<code class="codeph">TRANSPORT TABLESPACE</code>情况，尤其是在<code class="codeph">TRANSPORT TABLESPACE</code>命令上指定<code class="codeph">AUXILIARY DESTINATION</code>选项时。RMAN还可以使用包含其他初始化参数值的辅助实例参数文件。这些值将覆盖默认初始化参数文件中定义的参数值。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <div class="infoboxnotealso" id="GUID-2FE8ECB5-8D0F-490F-889D-3B867D3F29ED__GUID-59227D84-8F37-4949-B460-A3F5031EE041">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="creating-transportable-tablespace-sets.html#GUID-E141DED6-91FA-4E3B-ABE5-E5E57BF43602" title="您可以使用辅助实例参数文件中的LOG_FILE_NAME_CONVERT和DB_FILE_NAME_CONVERT初始化参数来确定辅助实例上的联机重做日志和其他数据库文件的名称。如果在TRANSPORT TABLESPACE命令中未指定AUXILIARY DESTINATION子句，则这些参数将确定未运行CONFIGURE AUXNAME或SET NEWNAME命令的任何文件的位置。">使用初始化参数命名辅助文件</a></p>
                           </li>
                           <li>
                              <p><a href="creating-transportable-tablespace-sets.html#GUID-F7869B4D-4187-4B36-B34B-9938A581B4BF" title="RMAN为与可传输表空间一起使用的自动辅助实例定义某些基本初始化参数。">关于设置RMAN辅助实例的初始化参数</a></p>
                           </li>
                           <li>
                              <p><a href="creating-transportable-tablespace-sets.html#GUID-C5E00663-30F6-40BA-8076-B6994B26B8DE" title="默认情况下，RMAN在运行RMAN客户端的主机上的操作系统相关位置查找辅助初始化参数文件。此位置可能不在运行辅助实例的主机上。对于UNIX系统，这个位置是？/rdbms/admin/params_auxint.ora，问号（？）代表运行RMAN的主机上的ORACLE_HOME。如果在默认位置找不到文件，则RMAN不会生成错误。">设置辅助实例参数文件的位置</a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div><a id="BRADV465"></a><a id="BRADV89964"></a><div class="props_rev_3"><a id="GUID-F7869B4D-4187-4B36-B34B-9938A581B4BF" name="GUID-F7869B4D-4187-4B36-B34B-9938A581B4BF"></a><h4 id="BRADV-GUID-F7869B4D-4187-4B36-B34B-9938A581B4BF" class="sect4"><span class="enumeration_section">27.2.1</span>关于设置RMAN辅助实例的初始化参数</h4>
                  <div>
                     <p>RMAN为与可传输表空间一起使用的自动辅助实例定义某些基本初始化参数。</p>
                     <p>您可以使用辅助实例参数文件来包含其他参数，原因如下：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>如果Data Pump Export需要，请增加<code class="codeph">STREAMS_POOL_SIZE</code>和<code class="codeph">SHARED_POOL_SIZE</code> 。
                           </p>
                        </li>
                        <li>
                           <p>管理辅助实例数据文件的位置。例如，您不希望所有辅助实例数据文件都存储在磁盘上的相同位置，但您不希望单独指定每个文件的位置。</p>
                        </li>
                        <li>
                           <p>使用<code class="codeph">LOG_FILE_NAME_CONVERT</code>指定联机重做日志的名称。
                           </p>
                        </li>
                     </ul>
                     <p>辅助实例参数文件不是辅助实例的完整初始化参数文件。指定的任何参数都将添加或覆盖辅助实例的默认参数。没有必要在初始化文件中指定您不打算覆盖的参数。</p>
                     <p>下表描述了辅助实例的初始化参数。</p>
                     <div class="tblformal" id="GUID-F7869B4D-4187-4B36-B34B-9938A581B4BF__CHDDBDEH">
                        <p class="titleintable">表27-1辅助实例的默认初始化参数</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="辅助实例的默认初始化参数" width="100%" border="1" summary="Default initialization parameters" frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="29%" id="d125378e1029">初始化参数</th>
                                 <th align="left" valign="bottom" width="71%" id="d125378e1032">值</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="29%" id="d125378e1037" headers="d125378e1029 ">
                                    <p><code class="codeph">DB_NAME</code> 
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="71%" headers="d125378e1037 d125378e1032 ">
                                    <p>与源数据库的<code class="codeph">DB_NAME</code>相同。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="29%" id="d125378e1049" headers="d125378e1029 ">
                                    <p><code class="codeph">兼容</code></p>
                                 </td>
                                 <td align="left" valign="top" width="71%" headers="d125378e1049 d125378e1032 ">
                                    <p>与源数据库的兼容设置相同。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="29%" id="d125378e1057" headers="d125378e1029 ">
                                    <p><code class="codeph">DB_UNIQUE_NAME</code></p>
                                 </td>
                                 <td align="left" valign="top" width="71%" headers="d125378e1057 d125378e1032 ">
                                    <p>基于<code class="codeph">DB_NAME</code>生成的唯一值。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="29%" id="d125378e1068" headers="d125378e1029 ">
                                    <p><code class="codeph">DB_BLOCK_SIZE</code></p>
                                 </td>
                                 <td align="left" valign="top" width="71%" headers="d125378e1068 d125378e1032 ">
                                    <p>与源数据库的<code class="codeph">DB_BLOCK_SIZE</code>相同。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="29%" id="d125378e1079" headers="d125378e1029 ">
                                    <p><code class="codeph">DB_FILES</code></p>
                                 </td>
                                 <td align="left" valign="top" width="71%" headers="d125378e1079 d125378e1032 ">
                                    <p>与源数据库的<code class="codeph">DB_FILES</code>值相同</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="29%" id="d125378e1090" headers="d125378e1029 ">
                                    <p><code class="codeph">SGA_TARGET</code></p>
                                 </td>
                                 <td align="left" valign="top" width="71%" headers="d125378e1090 d125378e1032 ">
                                    <p>280M推荐值。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="29%" id="d125378e1098" headers="d125378e1029 ">
                                    <p><code class="codeph">DB_CREATE_FILE_DEST</code></p>
                                 </td>
                                 <td align="left" valign="top" width="71%" headers="d125378e1098 d125378e1032 ">
                                    <p>辅助目标（仅当设置了<code class="codeph">TRANSPORT TABLESPACE</code>的<code class="codeph">AUXILIARY DESTINATION</code>参数时）。RMAN在此位置创建Oracle托管控制文件和联机日志。
                                    </p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p>使用辅助实例参数文件中的不适当值覆盖基本初始化参数可能会导致<code class="codeph">TRANSPORT TABLESPACE</code>失败。如果遇到问题，请尝试将初始化参数返回到其默认值。
                     </p>
                     <div class="infoboxnotealso" id="GUID-F7869B4D-4187-4B36-B34B-9938A581B4BF__GUID-B534B6E2-EF72-4A06-8703-95C9A6235097">
                        <p class="notep1">也可以看看：</p>
                        <p><span class="q">“ <a href="creating-transportable-tablespace-sets.html#GUID-E141DED6-91FA-4E3B-ABE5-E5E57BF43602" title="您可以使用辅助实例参数文件中的LOG_FILE_NAME_CONVERT和DB_FILE_NAME_CONVERT初始化参数来确定辅助实例上的联机重做日志和其他数据库文件的名称。如果在TRANSPORT TABLESPACE命令中未指定AUXILIARY DESTINATION子句，则这些参数将确定未运行CONFIGURE AUXNAME或SET NEWNAME命令的任何文件的位置。">使用初始化参数命名辅助文件</a> ”</span>以了解如何使用<code class="codeph">DB_FILE_NAME_CONVERT</code>和<code class="codeph">LOG_FILE_NAME_CONVERT</code>命名文件</p>
                     </div>
                  </div>
               </div><a id="BRADV466"></a><a id="BRADV89965"></a><div class="props_rev_3"><a id="GUID-C5E00663-30F6-40BA-8076-B6994B26B8DE" name="GUID-C5E00663-30F6-40BA-8076-B6994B26B8DE"></a><h4 id="BRADV-GUID-C5E00663-30F6-40BA-8076-B6994B26B8DE" class="sect4"><span class="enumeration_section">27.2.2</span>设置辅助实例参数文件的位置</h4>
                  <div>
                     <p>默认情况下，RMAN在运行RMAN客户端的主机上的操作系统相关位置查找辅助初始化参数文件。此位置可能不在运行辅助实例的主机上。对于UNIX系统，这个位置是<code class="codeph">?/rdbms/admin/params_auxint.ora</code> ，问号（ <code class="codeph">?</code> ）代表运行RMAN的主机上的<code class="codeph">ORACLE_HOME</code> 。如果在默认位置找不到文件，则RMAN不会生成错误。
                     </p>
                     <div class="section">
                        <p>如果使用辅助实例的默认初始化参数，则在运行<code class="codeph">TRANSPORT TABLESPACE</code>之前检查辅助实例参数文件是否存在。
                        </p>
                        <p>要为辅助实例参数文件指定其他位置，可以在<code class="codeph">TRANSPORT TABLESPACE</code>命令之前在<code class="codeph">RUN</code>块中使用RMAN <code class="codeph">SET AUXILIARY INSTANCE PARAMETER FILE</code>命令。与辅助实例参数文件的缺省位置一样，使用<code class="codeph">SET AUXILIARY INSTANCE PARAMETER FILE</code>命令时指定的路径是客户端路径。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-C5E00663-30F6-40BA-8076-B6994B26B8DE__CHDJBFEI">
                        <p class="titleinexample">例27-1指定辅助实例参数文件</p>
                        <p>此示例描述了如何使用<code class="codeph">TRANSPORT TABLESPACE</code>使用初始化参数文件。</p>
                        <p>在运行RMAN客户端的主机上创建名为<code class="codeph">/tmp/auxinstparams.ora</code>的文件。该文件包含以下初始化参数：</p><pre class="oac_no_warn" dir="ltr">SHARED_POOL_SIZE = 150M;</pre><p>当RMAN创建辅助实例时，/ <code class="codeph">/tmp/auxinstparams.ora</code>的<code class="codeph">SHARED_POOL_SIZE</code>参数会覆盖用于<code class="codeph">SHARED_POOL_SIZE</code>的默认值。
                        </p>
                        <p>以下命令在创建可传输表空间时使用初始化参数文件。</p><pre class="oac_no_warn" dir="ltr">运行{SET AUXILIARY INSTANCE PARAMETER FILE到'/tmp/auxinstparams.ora'; TRANSPORT TABLESPACE tbs_2 TABLESPACE DESTINATION'/ disk1 / transportdest'AUXILIARY DESTINATION'/ disk1 / auxdest'; }</pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
            </div><a id="BRADV467"></a><a id="BRADV89966"></a><div class="props_rev_3"><a id="GUID-B52E4D68-4F7F-4E4F-9F9E-53EEB1982047" name="GUID-B52E4D68-4F7F-4E4F-9F9E-53EEB1982047"></a><h3 id="BRADV-GUID-B52E4D68-4F7F-4E4F-9F9E-53EEB1982047" class="sect3"><span class="enumeration_section">27.3</span>创建可传输的表空间集</h3>
               <div>
                  <p>此过程描述了<code class="codeph">TRANSPOR TTABLESPACE</code>在最基本和自动化的情况下的使用。
                  </p>
                  <div class="section">
                     <p>假设您已满足<code class="codeph">TRANSPORT TABLESPACE</code>命令所需的先决条件。<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=RCMRF1919" target="_blank"><span><cite>Oracle数据库备份和恢复参考</cite></span></a> 。还假定您已满足<a href="../admin/transporting-data.html#ADMIN01101" target="_blank"><span><cite>Oracle数据库管理员指南中</cite></span></a>描述的以下要求：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type:disc">
                        <li>
                           <p>确认源平台和目标平台之间支持表空间传输</p>
                        </li>
                        <li>
                           <p>确定了一组自包含的表空间，以包含在可传输集中</p>
                        </li>
                     </ul>
                     <p>要创建可传输的表空间集：</p>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>启动RMAN客户端并连接到源数据库，如果使用，则连接到恢复目录数据库。</span></li>
                     <li class="stepexpand"><span>在RMAN中运行<code class="codeph">TRANSPORT TABLESPACE</code>命令。</span><div>
                           <p>在最基本的情况下，您指定<code class="codeph">AUXILIARY DESTINATION</code>子句，该子句是可选的但建议使用。RMAN使用适用于大多数情况的默认值。如果未指定辅助位置，请确保为所有辅助实例文件指定了位置。请参阅<span class="q">“ <a href="creating-transportable-tablespace-sets.html#GUID-079E02A9-C25B-4520-9B8B-E2D16526A1DC" title="有几条规则适用于传输过程中创建的辅助实例文件的位置。">使用可传输表空间指定辅助文件位置</a> ”中</span>描述的规则以了解如何命名辅助文件。
                           </p>
                           <p>以下示例创建一个可传输的表空间集，其中包含表空间<code class="codeph">tbs_2</code>和<code class="codeph">tbs_3</code> 。
                           </p><pre class="oac_no_warn" dir="ltr">TRANSPORT TABLESPACE tbs_2，tbs_3 TABLESPACE DESTINATION'/ disk1 / transportdest'AUXILIARY DESTINATION'/ disk1 / auxdest';</pre><p>命令成功完成后，请注意以下结果：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>可传输集数据文件以其原始名称保留在位置<code class="codeph">/disk1/transportdest</code> 。<code class="codeph">TRANSPORT</code> <code class="codeph">TABLESPACE</code>不会将可传输表空间集数据文件自动转换为目标数据库的endian格式。如有必要，在创建可传输集后，使用RMAN <code class="codeph">CONVERT</code>命令将数据文件转换为目标数据库的endian格式。
                                 </p>
                              </li>
                              <li>
                                 <p>可传输集的数据泵<a href="glossary.html#GUID-5C2A79F3-E089-41DC-B3F5-879FB6125CE5"><span class="xrefglossterm">导出转储文件</span></a>名为<code class="codeph">dmpfile.dmp</code> ，导出日志名为<code class="codeph">explog.log</code> ，示例导入脚本名为<code class="codeph">impscrpt.sql</code> 。
                                 </p>
                                 <p>所有文件都在<code class="codeph">/disk1/transportdest</code>中创建。如果表空间目标中存在导出转储文件名称下的文件，则<code class="codeph">TRANSPORT TABLESPACE</code>在调用Data Pump Export时失败。如果要重复先前的<code class="codeph">TRANSPORT TABLESPACE</code>操作，请删除以前的输出文件，包括导出转储文件。
                                 </p>
                              </li>
                              <li>
                                 <p>辅助集文件将从<code class="codeph">/disk1/auxdest</code>中删除。</p>
                              </li>
                           </ul>
                        </div>
                     </li>
                     <li class="stepexpand"><span>如有必要，请编辑示例导入脚本。</span><div>
                           <p>示例导入脚本假定用于将表空间导入目标数据库的文件存储在<code class="codeph">TRANSPORT</code> <code class="codeph">TABLESPACE</code>创建它们的相同位置。如果在插入文件之前已将文件移动到新磁盘位置，则必须先使用文件的新位置更新示例脚本，然后再使用脚本插入传输的表空间。
                           </p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>返回到<a href="../admin/transporting-data.html#ADMIN01101" target="_blank"><span><cite>Oracle Database Administrator's Guide中</cite></span></a>描述的传输表空间的过程。</span></li>
                  </ol>
                  <div class="section">
                     <div class="infoboxnotealso" id="GUID-B52E4D68-4F7F-4E4F-9F9E-53EEB1982047__GUID-21DB67D9-672E-41A1-B8E2-973EFD073F9B">
                        <p class="notep1">也可以看看：</p>
                        <p><span class="q">“可<a href="creating-transportable-tablespace-sets.html#GUID-8692A076-0EF0-4B98-8381-957D143D2CDC" title="您可以使用TRANSPORT TABLESPACE命令指定目标时间或SCN。在表空间传输操作期间，RMAN使用目标时间之前的备份还原辅助实例上的表空间，并在辅助数据库上执行指定目标时间的时间点恢复。必须提供此时间点恢复所需的备份和归档重做日志。您可以更改可传输集的数据泵导出转储文件的名称，目标数据库中使用的样本导入脚本，Data Pump Export生成的日志文件以及写入它们的目录。有几条规则适用于传输过程中创建的辅助实例文件的位置。您可以使用SET NEWNAME命令指定辅助数据文件的位置。您可以使用CONFIGURE AUXNAME命令为可传输表空间集或辅助集数据文件指定持久位置。在恢复之前，RMAN将已使用CONFIGURE AUXNAME命令的每个数据文件还原到指定位置。除非操作失败，否则RMAN会在操作完成时删除辅助设置数据文件。如果对TRANSPORT TABLESPACE命令使用AUXILIARY DESTINATION选项，则在TRANSPORT TABLESPACE操作期间，使用SET NEWNAME或CONFIGURE AUXNAME命令未移动到其他位置的任何辅助集文件都将存储在辅助目标中。您可以使用辅助实例参数文件中的LOG_FILE_NAME_CONVERT和DB_FILE_NAME_CONVERT初始化参数来确定辅助实例上的联机重做日志和其他数据库文件的名称。如果在TRANSPORT TABLESPACE命令中未指定AUXILIARY DESTINATION子句，则这些参数将确定未运行CONFIGURE AUXNAME或SET NEWNAME命令的任何文件的位置。">传输表空间集方案</a> ”，</span>用于本节中描述的基本情况的变体。
                        </p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="BRADV89967"></a><div class="props_rev_3"><a id="GUID-4486B94F-E39B-4E40-8D7D-9F6C65904E01" name="GUID-4486B94F-E39B-4E40-8D7D-9F6C65904E01"></a><h3 id="BRADV-GUID-4486B94F-E39B-4E40-8D7D-9F6C65904E01" class="sect3"><span class="enumeration_section">27.4</span>创建可传输表空间集的故障排除</h3>
               <div>
                  <p>当RMAN <code class="codeph">TRANSPORT TABLESPACE</code>命令失败时，失败的辅助实例文件在辅助实例目标中保持不变，以进行故障排除。
                  </p>
                  <div class="section">
                     <p>如果<code class="codeph">SET NEWNAME</code> ， <code class="codeph">CONFIGURE AUXNAME</code>和<code class="codeph">DB_FILE_NAME_CONVERT</code>设置导致辅助或可传输表空间集中的多个文件具有相同的名称，则RMAN会在<code class="codeph">TRANSPORT TABLESPACE</code>命令期间报告错误。要更正此问题，请对这些参数使用不同的值，以确保不会创建重复的文件名。命名技术在<span class="q">“ <a href="creating-transportable-tablespace-sets.html#GUID-079E02A9-C25B-4520-9B8B-E2D16526A1DC" title="有几条规则适用于传输过程中创建的辅助实例文件的位置。">使用可传输表空间指定辅助文件位置</a> ”中</span>进行了描述。
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="BRADV89968"></a><div class="props_rev_3"><a id="GUID-8692A076-0EF0-4B98-8381-957D143D2CDC" name="GUID-8692A076-0EF0-4B98-8381-957D143D2CDC"></a><h3 id="BRADV-GUID-8692A076-0EF0-4B98-8381-957D143D2CDC" class="sect3"><span class="enumeration_section">27.5可</span>传输表空间集方案</h3>
               <div>
                  <p>本节包含以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="creating-transportable-tablespace-sets.html#GUID-6AE347E4-5364-4C67-B18D-EE30282F566D" title="您可以使用TRANSPORT TABLESPACE命令指定目标时间或SCN。在表空间传输操作期间，RMAN使用目标时间之前的备份还原辅助实例上的表空间，并在辅助数据库上执行指定目标时间的时间点恢复。必须提供此时间点恢复所需的备份和归档重做日志。">创建在指定时间或SCN设置的可传输表空间</a></p>
                     </li>
                     <li>
                        <p><a href="creating-transportable-tablespace-sets.html#GUID-4F402748-9F8E-4067-A579-F58A3399FE9A" title="您可以更改可传输集的数据泵导出转储文件的名称，目标数据库中使用的样本导入脚本，Data Pump Export生成的日志文件以及写入它们的目录。">指定数据泵文件的位置</a></p>
                     </li>
                     <li>
                        <p><a href="creating-transportable-tablespace-sets.html#GUID-079E02A9-C25B-4520-9B8B-E2D16526A1DC" title="有几条规则适用于传输过程中创建的辅助实例文件的位置。">使用可传输表空间指定辅助文件位置</a></p>
                     </li>
                  </ul>
               </div><a id="BRADV469"></a><a id="BRADV470"></a><a id="BRADV471"></a><a id="BRADV89969"></a><div class="props_rev_3"><a id="GUID-6AE347E4-5364-4C67-B18D-EE30282F566D" name="GUID-6AE347E4-5364-4C67-B18D-EE30282F566D"></a><h4 id="BRADV-GUID-6AE347E4-5364-4C67-B18D-EE30282F566D" class="sect4"><span class="enumeration_section">27.5.1</span>创建在指定时间或SCN设置的可传输表空间</h4>
                  <div>
                     <p>您可以使用<code class="codeph">TRANSPORT TABLESPACE</code>命令指定目标时间或SCN。在表空间传输操作期间，RMAN使用目标时间之前的备份还原辅助实例上的表空间，并在辅助数据库上执行指定目标时间的时间点恢复。必须提供此时间点恢复所需的备份和归档重做日志。
                     </p>
                     <div class="section"></div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-6AE347E4-5364-4C67-B18D-EE30282F566D__CHDJEAGI">
                        <p class="titleinexample">示例27-2指定结束SCN</p>
                        <p>此示例使用SCN（在当前化身或其祖先中）指定目标时间。</p><pre class="oac_no_warn" dir="ltr">TRANSPORT TABLESPACE tbs_2 TABLESPACE DESTINATION'/ disk1 / transportdest'AUXILIARY DESTINATION'/ disk1 / auxdest'UNTIL SCN 11379;</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-6AE347E4-5364-4C67-B18D-EE30282F566D__CHDGCBFH">
                        <p class="titleinexample">示例27-3指定结束还原点</p>
                        <p>此示例将还原点指定为可传输表空间集创建的目标时间。</p><pre class="oac_no_warn" dir="ltr">TRANSPORT TABLESPACE tbs_2 TABLESPACE DESTINATION'/ disk1 / transportdest'AUXILIARY DESTINATION'/ disk1 / auxdest'恢复点'before_upgrade';</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-6AE347E4-5364-4C67-B18D-EE30282F566D__CHDGAHBA">
                        <p class="titleinexample">示例27-4指定结束时间</p>
                        <p>此示例指定结束时间，该结束时间用作可传输表空间集创建的目标时间。</p><pre class="oac_no_warn" dir="ltr">TRANSPORT TABLESPACE tbs_2 TABLESPACE DESTINATION'/ disk1 / transportdest'AUXILIARY DESTINATION'/ disk1 / auxdest'UNTIL TIME'SYSDATE-1';</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="BRADV472"></a><a id="BRADV89970"></a><div class="props_rev_3"><a id="GUID-4F402748-9F8E-4067-A579-F58A3399FE9A" name="GUID-4F402748-9F8E-4067-A579-F58A3399FE9A"></a><h4 id="BRADV-GUID-4F402748-9F8E-4067-A579-F58A3399FE9A" class="sect4"><span class="enumeration_section">27.5.2</span>指定数据泵文件的位置</h4>
                  <div>
                     <p>您可以更改可传输集的数据泵导出转储文件的名称，目标数据库中使用的样本导入脚本，Data Pump Export生成的日志文件以及写入它们的目录。</p>
                     <div class="section">
                        <p>默认情况下，这些文件存储在表空间目标中，并按如下方式命名：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>数据泵<a href="glossary.html#GUID-5C2A79F3-E089-41DC-B3F5-879FB6125CE5"><span class="xrefglossterm">导出转储文件</span></a>名为<code class="codeph">dmpfile.dmp</code> 。
                              </p>
                           </li>
                           <li>
                              <p>导出日志文件名为<code class="codeph">explog.log</code> 。
                              </p>
                           </li>
                           <li>
                              <p>示例导入脚本名为<code class="codeph">impscrpt.sql</code> 。
                              </p>
                           </li>
                        </ul>
                        <p>您可以使用<code class="codeph">TRANSPORT TABLESPACE</code>命令的<code class="codeph">DATAPUMP DIRECTORY</code>子句将转储文件和导出日志放在不同的目录中，并传入数据库目录对象的名称。<code class="codeph">DATAPUMP DIRECTORY</code>子句使用的数据库目录对象不是实际文件系统目录的目录路径。传递的值对应于Data Pump Export的<code class="codeph">DIRECTORY</code>命令行参数。
                        </p>
                        <p>您可以使用<code class="codeph">DUMP FILE EXPORT LOG</code>和<code class="codeph">TRANSPORT TABLESPACE</code>命令的<code class="codeph">IMPORT SCRIPT</code>子句重命名这些文件。文件名不能包含带有目录名的完整文件路径。如果<code class="codeph">DUMP FILE</code>或<code class="codeph">EXPORT LOG</code>文件名指定文件路径，则<code class="codeph">TRANSPORT TABLESPACE</code>在尝试生成导出转储文件时失败。使用<code class="codeph">DATAPUMP DIRECTORY</code>子句指定数据库目录对象，该对象标识Data Pump Export输出的位置。
                        </p>
                        <p>以下方案说明了<code class="codeph">TRANSPORT TABLESPACE</code>与指定的<code class="codeph">DATAPUMP DIRECTORY</code> ， <code class="codeph">DUMP FILE</code> ， <code class="codeph">EXPORT LOG</code>和<code class="codeph">IMPORT SCRIPT</code>文件名的使用。假设您创建一个数据库目录对象，如下所示，以便与Data Pump Export一起使用：</p><pre class="oac_no_warn" dir="ltr">创建或替换目录mypumpdir为'/ datapumpdest';</pre></div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-4F402748-9F8E-4067-A579-F58A3399FE9A__CHDDBJCG">
                        <p class="titleinexample">示例27-5指定输出文件位置</p>
                        <p>此示例显示带有可选参数的<code class="codeph">TRANSPORT TABLESPACE</code>命令，该参数指定输出文件位置。
                        </p><pre class="oac_no_warn" dir="ltr">TRANSPORT TABLESPACE tbs_2 TABLESPACE DESTINATION'/ transportdest'AUXILIARY DESTINATION'/ auxdest'DATAPUMP DIRECTORY mypumpdir DUMP FILE'mydumpfile.dmp'ImpORT SCRIPT'myimportscript.sql'EXPORT LOG'myexportlog.log';</pre><p>运行成功后，RMAN清理辅助目标，在<code class="codeph">DATAPUMP DIRECTORY</code> （ <code class="codeph">/datapumpdest/mydumpfile.dmp</code>和<code class="codeph">/datapumpdest/myexportlog.log</code> ）引用的<code class="codeph">DATAPUMP DIRECTORY</code>创建数据泵导出转储文件和导出日志，并存储可传输的在<code class="codeph">/transportdest</code>设置数据文件。</p>
                     </div>
                     <!-- class="example" -->
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-4F402748-9F8E-4067-A579-F58A3399FE9A__GUID-540F8926-C3E1-44B3-9FF6-F25D910D3216">
                           <p class="notep1">也可以看看：</p>
                           <p>有关使用Data Pump Export的目录对象的更多详细信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=SUTIL100" target="_blank"><span><cite>Oracle数据库实用程序</cite></span></a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="BRADV39711"></a><div class="props_rev_3"><a id="GUID-079E02A9-C25B-4520-9B8B-E2D16526A1DC" name="GUID-079E02A9-C25B-4520-9B8B-E2D16526A1DC"></a><h4 id="BRADV-GUID-079E02A9-C25B-4520-9B8B-E2D16526A1DC" class="sect4"><span class="enumeration_section">27.5.3</span>使用可传输表空间指定辅助文件位置</h4>
                  <div>
                     <p>有几条规则适用于传输过程中创建的辅助实例文件的位置。</p>
                     <div class="section">
                        <p>如果RMAN确定由任何指定辅助文件位置的方法指定的任何辅助文件包含适合用于此传输操作的所需时间点的数据文件副本，则该数据文件副本为用来代替恢复数据文件。存在但不适合此传输操作的任何数据文件副本，因为它们比请求的时间点更新，或者未被识别为目标数据库的一部分，在还原数据文件时会被覆盖。</p>
                        <p>最简单的方法是使用<code class="codeph">TRANSPORT TABLESPACE</code>命令的<code class="codeph">AUXILIARY</code> <code class="codeph">DESTINATION</code>子句，让RMAN自动管理所有文件位置。
                        </p>
                        <p>下表列出了在重定位某些或所有辅助实例文件时按照RMAN使用的优先顺序指定文件位置的可用技术：</p>
                        <div class="tblformal" id="GUID-079E02A9-C25B-4520-9B8B-E2D16526A1DC__GUID-2F445C4A-22D6-4520-B87F-3F8DD277DB98">
                           <p class="titleintable">表27-2用于指定辅助文件位置的选项</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="用于指定辅助文件位置的选项" border="1" summary="This table describes the techniques available for specifying auxiliary file locations in the order of precedence in which they are taken." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="20%" id="d125378e2167">优先顺序</th>
                                    <th align="left" valign="bottom" width="20%" id="d125378e2169">辅助文件命名技术</th>
                                    <th align="left" valign="bottom" width="20%" id="d125378e2171">附加信息</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d125378e2175" headers="d125378e2167 ">1</td>
                                    <td align="left" valign="top" width="20%" headers="d125378e2175 d125378e2169 ">
                                       <p><code class="codeph">为DATAFILES设置NEWNAME</code></p>
                                       <p><code class="codeph">为TABLESPACE设置NEWNAME</code></p>
                                       <p><code class="codeph">为数据库设置NEWNAME</code></p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d125378e2175 d125378e2171 ">
                                       <p><span class="q">“ <a href="creating-transportable-tablespace-sets.html#GUID-F0AB00E6-0C3F-4302-9D4D-06FD3C417A69" title="您可以使用SET NEWNAME命令指定辅助数据文件的位置。">使用SET NEWNAME作为辅助数据文件</a> ”</span></p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d125378e2199" headers="d125378e2167 ">2</td>
                                    <td align="left" valign="top" width="20%" headers="d125378e2199 d125378e2169 ">
                                       <p><code class="codeph">配置AUXNAME</code></p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d125378e2199 d125378e2171 ">
                                       <p><span class="q">“ <a href="creating-transportable-tablespace-sets.html#GUID-1B04CB7B-39BF-4910-9925-8927BBB68FFD" title="您可以使用CONFIGURE AUXNAME命令为可传输表空间集或辅助集数据文件指定持久位置。在恢复之前，RMAN将已使用CONFIGURE AUXNAME命令的每个数据文件还原到指定位置。除非操作失败，否则RMAN会在操作完成时删除辅助设置数据文件。">对辅助数据文件使用CONFIGURE AUXNAME</a> ”</span></p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d125378e2220" headers="d125378e2167 ">3</td>
                                    <td align="left" valign="top" width="20%" headers="d125378e2220 d125378e2169 ">
                                       <p><code class="codeph">TRANSPORT TABLESPACE</code>命令的<code class="codeph">AUXILIARY DESTINATION</code>子句</p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d125378e2220 d125378e2171 ">
                                       <p><span class="q">“ <a href="creating-transportable-tablespace-sets.html#GUID-F9075274-D1B0-49AF-BB7C-E8D21482D232" title="如果对TRANSPORT TABLESPACE命令使用AUXILIARY DESTINATION选项，则在TRANSPORT TABLESPACE操作期间，使用SET NEWNAME或CONFIGURE AUXNAME命令未移动到其他位置的任何辅助集文件都将存储在辅助目标中。">使用AUXILIARY DESTINATION指定辅助文件的位置</a> ”</span></p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d125378e2254" headers="d125378e2167 ">4</td>
                                    <td align="left" valign="top" width="20%" headers="d125378e2254 d125378e2169 ">
                                       <p>初始化参数文件中的<code class="codeph">LOG_FILE_NAME_CONVERT</code>和<code class="codeph">DB_FILE_NAME_CONVERT</code></p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d125378e2254 d125378e2171 ">
                                       <p><span class="q">“ <a href="creating-transportable-tablespace-sets.html#GUID-E141DED6-91FA-4E3B-ABE5-E5E57BF43602" title="您可以使用辅助实例参数文件中的LOG_FILE_NAME_CONVERT和DB_FILE_NAME_CONVERT初始化参数来确定辅助实例上的联机重做日志和其他数据库文件的名称。如果在TRANSPORT TABLESPACE命令中未指定AUXILIARY DESTINATION子句，则这些参数将确定未运行CONFIGURE AUXNAME或SET NEWNAME命令的任何文件的位置。">使用初始化参数命名辅助文件</a> ”</span></p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                        <p>如果使用其中几个选项，则列表中适用于文件的第一个选项将确定文件名。</p>
                     </div>
                     <!-- class="section" -->
                  </div><a id="BRADV473"></a><a id="BRADV89972"></a><div class="props_rev_3"><a id="GUID-F0AB00E6-0C3F-4302-9D4D-06FD3C417A69" name="GUID-F0AB00E6-0C3F-4302-9D4D-06FD3C417A69"></a><h5 id="BRADV-GUID-F0AB00E6-0C3F-4302-9D4D-06FD3C417A69" class="sect5"><span class="enumeration_section">27.5.3.1</span>对辅助数据文件使用SET NEWNAME</h5>
                     <div>
                        <p>您可以使用<code class="codeph">SET NEWNAME</code>命令指定辅助数据文件的位置。
                        </p>
                        <div class="section">
                           <p>在<code class="codeph">RUN</code>块中使用以下<code class="codeph">SET NEWNAME</code>命令指定要在<code class="codeph">TRANSPORT TABLESPACE</code>命令中使用的文件名：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><code class="codeph">为数据文件设置NEWNAME</code></p>
                              </li>
                              <li>
                                 <p><code class="codeph">为数据库设置NEWNAME</code></p>
                              </li>
                              <li>
                                 <p><code class="codeph">为TABLESPACE设置NEWNAME</code></p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-F0AB00E6-0C3F-4302-9D4D-06FD3C417A69__CHDDGAID">
                           <p class="titleinexample">示例27-6使用SET NEWNAME FOR DATAFILE命名辅助数据文件</p>
                           <p>此示例中的<code class="codeph">SET NEWNAME FOR DATAFILE</code>命令导致辅助实例数据文件还原到命名的位置而不是<code class="codeph">/disk1/auxdest</code> 。</p><pre class="oac_no_warn" dir="ltr">RUN {SET NEWNAME FOR DATAFILE'/oracle/dbs/tbs_12.f'to'/bigdrive/auxdest/tbs_12.f';为数据文件设置NEWNAME'/oracle/dbs/tbs_11.f'to'/bigdrive/auxdest/tbs_11.f'; TRANSPORT TABLESPACE tbs_2 TABLESPACE DESTINATION'/ disk1 / transportdest'AUXILIARY DESTINATION'/ disk1 / auxdest'; }</pre><p><code class="codeph">SET NEWNAME</code>命令最适用于一次性操作。如果您希望定期为特定的一组表空间从备份创建可传输表空间，请考虑使用<code class="codeph">CONFIGURE AUXNAME</code>命令而不是<code class="codeph">SET NEWNAME</code>命令对辅助实例数据文件的位置进行持久设置。
                           </p>
                        </div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="BRADV89973"></a><div class="props_rev_3"><a id="GUID-1B04CB7B-39BF-4910-9925-8927BBB68FFD" name="GUID-1B04CB7B-39BF-4910-9925-8927BBB68FFD"></a><h5 id="BRADV-GUID-1B04CB7B-39BF-4910-9925-8927BBB68FFD" class="sect5"><span class="enumeration_section">27.5.3.2</span>对辅助数据文件使用CONFIGURE AUXNAME</h5>
                     <div>
                        <p>您可以使用<code class="codeph">CONFIGURE AUXNAME</code>命令为可传输表空间集或辅助集数据文件指定持久位置。在恢复之前，RMAN将已使用<code class="codeph">CONFIGURE AUXNAME</code>命令的每个数据文件还原到指定位置。除非操作失败，否则RMAN会在操作完成时删除辅助设置数据文件。
                        </p>
                        <div class="section">
                           <p>一个例子说明了<code class="codeph">CONFIGURE AUXNAME</code>和<code class="codeph">TRANSPORT ...之间的关系<code class="codeph">TRANSPORT ...AUXILIARY DESTINATION</code>命令。假设您要传输表空间<code class="codeph">tbs_11</code> 。包含数据文件<code class="codeph">tbs_12.f</code>的表空间<code class="codeph">tbs_12</code>是辅助集的一部分。您执行以下步骤：</p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>您使用<code class="codeph">CONFIGURE AUXNAME</code>语句为辅助集数据文件<code class="codeph">/oracle/dbs/tbs_12.f</code>设置持久性非默认位置。</span><div>
                                 <p>例如，您输入以下命令：</p><pre class="oac_no_warn" dir="ltr">为数据文件配置AUXNAME'/oracle/dbs/tbs_12.f'to'/disk1/auxdest/tbs_12.f';</pre></div>
                           </li>
                           <li class="stepexpand"><span>使用<code class="codeph">AUXILIARY DESTINATION</code>和<code class="codeph">TABLESPACE DESTINATION</code>选项执行<code class="codeph">TRANSPORT TABLESPACE</code>命令。</span><div>
                                 <p>例如，您输入以下命令：</p><pre class="oac_no_warn" dir="ltr">TRANSPORT TABLESPACE tbs_11 AUXILIARY DESTINATION'/ myauxdest'TABLESPACE DESTINATION'/ disk1 / transportdest';</pre></div>
                           </li>
                        </ol>
                        <div class="section">
                           <p>在上述方案中，RMAN将数据文件<code class="codeph">/oracle/dbs/tbs_12.f</code>的辅助集副本还原到<code class="codeph">/disk1/auxdest/tbs_12.f</code>而不是<code class="codeph">AUXILIARY DESTINATION</code>选项指定的位置。<code class="codeph">CONFIGURE AUXNAME</code>命令设置的优先顺序高于<code class="codeph">AUXILIARY DESTINATION</code>选项。
                           </p>
                           <div class="infoboxnote" id="GUID-1B04CB7B-39BF-4910-9925-8927BBB68FFD__GUID-56D4BC4A-545B-402E-9327-F8B0FB65866F">
                              <p class="notep1">注意：</p>
                              <p>您可以通过执行<code class="codeph">SHOW AUXNAME</code>命令来查看任何当前的<code class="codeph">CONFIGURE AUXNAME</code>设置，该命令在<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=RCMRF154" target="_blank"><span><cite>Oracle数据库备份和恢复参考中</cite></span></a>有所描述。
                              </p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="BRADV89974"></a><div class="props_rev_3"><a id="GUID-F9075274-D1B0-49AF-BB7C-E8D21482D232" name="GUID-F9075274-D1B0-49AF-BB7C-E8D21482D232"></a><h5 id="BRADV-GUID-F9075274-D1B0-49AF-BB7C-E8D21482D232" class="sect5"><span class="enumeration_section">27.5.3.3</span>使用AUXILIARY DESTINATION指定辅助文件的位置</h5>
                     <div>
                        <p>如果对<code class="codeph">TRANSPORT TABLESPACE</code>命令使用<code class="codeph">AUXILIARY DESTINATION</code>选项，则在<code class="codeph">TRANSPORT TABLESPACE</code>操作期间，使用<code class="codeph">SET NEWNAME</code>或<code class="codeph">CONFIGURE AUXNAME</code>命令未移动到其他位置的任何辅助集文件都将存储在辅助目标中。
                        </p>
                        <div class="section">
                           <p>如果不使用<code class="codeph">AUXILIARY DESTINATION</code>选项，则必须使用<code class="codeph">LOG_FILE_NAME_CONVERT</code>参数指定辅助实例的联机重做日志文件的位置。<code class="codeph">SET NEWNAME</code>和<code class="codeph">CONFIGURE AUXNAME</code>命令都不会影响辅助实例联机重做日志的位置。因此，如果您不使用<code class="codeph">AUXILIARY DESTINATION</code>选项或<code class="codeph">LOG_FILE_NAME_CONVERT</code>参数，则RMAN没有关于在何处创建联机重做日志的信息。
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="BRADV89975"></a><div class="props_rev_3"><a id="GUID-E141DED6-91FA-4E3B-ABE5-E5E57BF43602" name="GUID-E141DED6-91FA-4E3B-ABE5-E5E57BF43602"></a><h5 id="BRADV-GUID-E141DED6-91FA-4E3B-ABE5-E5E57BF43602" class="sect5"><span class="enumeration_section">27.5.3.4</span>使用初始化参数命名辅助文件</h5>
                     <div>
                        <p>您可以使用辅助实例参数文件中的<code class="codeph">LOG_FILE_NAME_CONVERT</code>和<code class="codeph">DB_FILE_NAME_CONVERT</code>初始化参数来确定辅助实例上的联机重做日志和其他数据库文件的名称。如果在<code class="codeph">TRANSPORT TABLESPACE</code>命令中未指定<code class="codeph">AUXILIARY DESTINATION</code>子句，则这些参数将确定未运行<code class="codeph">CONFIGURE AUXNAME</code>或<code class="codeph">SET NEWNAME</code>命令的任何文件的位置。
                        </p>
                        <div class="section">
                           <p>当原始文件是OMF文件时，您无法使用<code class="codeph">LOG_FILE_NAME_CONVERT</code>或<code class="codeph">DB_FILE_NAME_CONVERT</code>参数为辅助实例上的文件生成新的Oracle托管文件（OMF）名称。数据库管理每个OMF目标中唯一文件名的生成。必须使用<code class="codeph">AUXILIARY DESTINATION</code>子句来控制联机重做日志文件的位置。必须使用<code class="codeph">AUXILIARY DESTINATION</code>子句， <code class="codeph">SET NEWNAME</code>或<code class="codeph">CONFIGURE AUXNAME</code>命令或<code class="codeph">DB_CREATE_FILE_DEST</code>初始化参数来指定OMF数据文件的位置。
                           </p>
                           <div class="infoboxnotealso" id="GUID-E141DED6-91FA-4E3B-ABE5-E5E57BF43602__GUID-8DF269C6-9FF3-4F52-BD63-7AB07E6A86F9">
                              <p class="notep1">也可以看看：</p>
                              <p>有关<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=REFRN10098" target="_blank"><code class="codeph">LOG_FILE_NAME_CONVERT</code></a>和<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=REFRN10038" target="_blank"><code class="codeph">DB_FILE_NAME_CONVERT</code></a>初始化参数的更多详细信息，请<span><cite>参见Oracle数据库参考</cite></span></p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>