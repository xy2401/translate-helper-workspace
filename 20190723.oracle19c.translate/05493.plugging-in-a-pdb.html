<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="You can create a PDB by plugging an unplugged PDB into a CDB."></meta>
      <meta name="description" content="You can create a PDB by plugging an unplugged PDB into a CDB."></meta>
      <title>插入一个未插入的PDB</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Administrator’s Guide "></meta>
      <meta property="og:description" content="You can create a PDB by plugging an unplugged PDB into a CDB."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Administrator’s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="multitenant-administrators-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-03-20T09:59:22-07:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2017, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96136-03"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="relocating-a-pdb.html" title="Previous" type="text/html"></link>
      <link rel="next" href="creating-a-proxy-pdb.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Multitenant Administrator&#39;s Guide"></meta>
    <meta name="dcterms.isVersionOf" content="MULTI"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="relocating-a-pdb.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="creating-a-proxy-pdb.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">管理员指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="creating-pdbs.html" property="item" typeof="WebPage"><span property="name">创建和删除PDB和应用程序容器</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">插入一个未插入的PDB</li>
            </ol>
            <a id="GUID-3132C4E5-8734-458B-8B0C-EFC77A45FFA3" name="GUID-3132C4E5-8734-458B-8B0C-EFC77A45FFA3"></a>
            
            <h2 id="MULTI-GUID-3132C4E5-8734-458B-8B0C-EFC77A45FFA3" class="sect2"><span class="enumeration_chapter">9</span>插入未插入的PDB</h2>
         </header>
         <div class="ind">
            <div>
               <p>您可以通过将未插入的PDB插入CDB来创建PDB。</p>
               <p>本章包含以下主题：</p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="plugging-in-a-pdb.html#GUID-5CFC53B9-C457-460A-92A5-DAFDC472F458">关于插入一个未插入的PDB</a><br><code class="codeph">CREATE PLUGGABLE DATABASE</code>语句的<code class="codeph">USING</code>子句指定XML元数据文件或扩展名为.pdb的压缩归档文件。
                  </li>
                  <li class="ulchildlink"><a href="plugging-in-a-pdb.html#GUID-FEB1F7ED-33EA-4582-8861-52B18BC74A61">关于采用非CDB作为PDB</a><br>要生成描述非CDB的XML文件，请使用<code class="codeph">DBMS_PDB.DESCRIBE</code>过程。然后，在插入未插入的PDB时插入非CDB。</li>
                  <li class="ulchildlink"><a href="plugging-in-a-pdb.html#GUID-F23F5352-F456-48EE-AED7-71E3DEBAAED0">插入一个未插入的PDB</a><br>使用<code class="codeph">CREATE PLUGGABLE DATABASE ...插入PDB <code class="codeph">CREATE PLUGGABLE DATABASE ...USING</code>声明。
                  </li>
                  <li class="ulchildlink"><a href="plugging-in-a-pdb.html#GUID-EE58804F-A999-4F7C-93DE-D641B3C1047B">采用非CDB作为PDB</a><br>您可以使用<code class="codeph">DBMS_PDB.DESCRIBE</code>过程将非CDB（移动）到PDB中。
                  </li>
                  <li class="ulchildlink"><a href="plugging-in-a-pdb.html#GUID-E7122CD7-47CA-4A89-A419-8CDEE622AF70">插入未插入的PDB后</a><br>在插入未插入的PDB后，有关用户和表空间的某些规则适用。</li>
                  <li class="ulchildlink"><a href="plugging-in-a-pdb.html#GUID-2DB6E163-48F0-4458-8DC3-A88F89EFEA81">插入Unplugged PDB：示例</a><br>这些示例使用<code class="codeph">/disk1/usr/salespdb.xml</code>文件或<code class="codeph">/disk1/usr/sales.pdb</code>文件插入名为<code class="codeph">salespdb</code>的未插入PDB， <code class="codeph">/disk1/usr/sales.pdb</code>给出不同的因子。
                  </li>
               </ul>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>父主题：</strong> <a href="creating-pdbs.html#GUID-9A250D93-5B3B-4643-BE85-F32CC7B0E413" title="您可以使用各种技术创建PDB，应用程序容器和应用程序种子。">创建和删除PDB和应用程序容器</a></p>
                  </div>
               </div>
            </div>
            
            <div class="sect2"><a id="GUID-5CFC53B9-C457-460A-92A5-DAFDC472F458" name="GUID-5CFC53B9-C457-460A-92A5-DAFDC472F458"></a><h3 id="MULTI-GUID-5CFC53B9-C457-460A-92A5-DAFDC472F458" class="sect3"><span class="enumeration_section">9.1</span>关于插入未插入的PDB</h3>
               <div>
                  <p><code class="codeph">CREATE PLUGGABLE DATABASE</code>语句的<code class="codeph">USING</code>子句指定XML元数据文件或扩展名为.pdb的压缩归档文件。
                  </p>
                  <p>本节包含以下主题：</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="plugging-in-a-pdb.html#GUID-157624D9-7D38-4758-9FF2-645EC55106A9">关于XML文件和存档文件</a><br>XML元数据文件描述了未插入的PDB和与PDB关联的文件（例如数据文件和钱包文件）。存档文件包括XML元数据文件和PDB文件。
                     </li>
                     <li class="ulchildlink"><a href="plugging-in-a-pdb.html#GUID-1691A7A2-372E-4E51-8A4F-15DAC6AB0FC3">插入未插入的PDB时的源文件位置</a><br>使用<code class="codeph">CREATE PLUGGABLE DATABASE ...USING</code>声明将未插入的PDB插入CDB。</li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="plugging-in-a-pdb.html#GUID-3132C4E5-8734-458B-8B0C-EFC77A45FFA3" title="您可以通过将未插入的PDB插入CDB来创建PDB。">插入未插入的PDB</a></p>
                     </div>
                  </div>
               </div>
               <a id="ADMIN13753"></a><a id="ADMIN13573"></a><a id="ADMIN13553"></a><div class="props_rev_3"><a id="GUID-157624D9-7D38-4758-9FF2-645EC55106A9" name="GUID-157624D9-7D38-4758-9FF2-645EC55106A9"></a><h4 id="MULTI-GUID-157624D9-7D38-4758-9FF2-645EC55106A9" class="sect4"><span class="enumeration_section">9.1.1</span>关于XML文件和存档文件</h4>
                  <div>
                     <p>XML元数据文件描述了未插入的PDB和与PDB关联的文件（例如数据文件和钱包文件）。存档文件包括XML元数据文件和PDB文件。</p>
                     <p>指定XML元数据文件时，XML文件包含PDB文件的完整路径。指定.pdb存档文件时，XML元数据文件仅包含相关文件名。</p>
                     <p>下图说明了如何插入未插入的PDB。</p>
                     <div class="figure" id="GUID-157624D9-7D38-4758-9FF2-645EC55106A9__CEGHDJHJ">
                        <p class="titleinfigure">图9-1将未插入的PDB插入CDB根目录</p><img src="img/admin090.png" width="484" alt="下面是图9-1的描述" title="下面是图9-1的描述" longdesc="img_text/admin090.html"><br><a href="img_text/admin090.html">“图9-1将未插入的PDB插入CDB根”的说明</a></div>
                     <!-- class="figure" -->
                     <p>下图说明了此技术如何在应用程序容器中创建新的应用程序PDB。</p>
                     <div class="figure" id="GUID-157624D9-7D38-4758-9FF2-645EC55106A9__PLUGGINGANUNPLUGGEDPDBINTOANAPPLICA-8052B592">
                        <p class="titleinfigure">图9-2将未插入的PDB插入应用程序根目录</p><img src="img/admin117.png" alt="下面是图9-2的描述" title="下面是图9-2的描述" longdesc="img_text/admin117.html"><br><a href="img_text/admin117.html">“图9-2将未插入的PDB插入应用程序根”的说明</a></div>
                     <!-- class="figure" -->
                     <div class="infoboxnote" id="GUID-157624D9-7D38-4758-9FF2-645EC55106A9__GUID-2F036AD6-5FC7-45BB-87F4-A7ABAF345086">
                        <p class="notep1">注意：</p>不支持自动降级PDB。因此，如果源CDB是比目标CDB更高的Oracle数据库版本，则无法插入PDB。</div>
                     <p>插入未插入的PDB时，必须解决<a href="overview-of-pdb-creation.html#GUID-87F21FDE-7115-4207-954E-B229C1879EF6__GUID-57A2E4B5-E8EB-4294-95C2-A3E04AF93D8C" title="此表描述了每个子句以及何时使用每个子句。">表5-3中</a>插入未插入PDB的问题。该表描述了您必须根据不同因素指定的<code class="codeph">CREATE PLUGGABLE DATABASE</code>子句。
                     </p>
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-157624D9-7D38-4758-9FF2-645EC55106A9__GUID-6F112C5A-4677-4737-B697-3AF04A388C4B">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="q">“ <a href="overview-of-pdb-creation.html#GUID-59F42929-7237-4371-8934-921B46DB6F31" title="但是，如果选择创建PDB，则必须确定将存储数据的表空间和文件。">PDB存储</a> ”</span></p>
                           </li>
                           <li>
                              <p><span class="q">“ <a href="creating-removing-application-containers-seeds-with-sql-plus.html#GUID-88E61123-F651-47D7-9977-B589268EBD29" title="您可以通过运行CREATE PLUGGABLE DATABASE语句并将应用程序root作为当前容器来创建应用程序PDB。">创建应用程序PDB</a> ”</span></p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="plugging-in-a-pdb.html#GUID-5CFC53B9-C457-460A-92A5-DAFDC472F458" title="CREATE PLUGGABLE DATABASE语句的USING子句指定XML元数据文件或扩展名为.pdb的压缩归档文件。">关于插入未插入的PDB</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="ADMIN13564"></a><a id="ADMIN13563"></a><div class="props_rev_3"><a id="GUID-1691A7A2-372E-4E51-8A4F-15DAC6AB0FC3" name="GUID-1691A7A2-372E-4E51-8A4F-15DAC6AB0FC3"></a><h4 id="MULTI-GUID-1691A7A2-372E-4E51-8A4F-15DAC6AB0FC3" class="sect4"><span class="enumeration_section">9.1.2</span>插入未插入的PDB时的源文件位置</h4>
                  <div>
                     <p>使用<code class="codeph">CREATE PLUGGABLE DATABASE ...USING</code>声明将未插入的PDB插入CDB。</p>
                     <p>当您插入PDB时使用.pdb存档文件时，Oracle数据库会在您插入PDB时提取此文件，并将PDB文件放在与.pdb存档文件相同的目录中。因此，使用.pdb归档文件时，不需要指定源文件位置的子句。</p>
                     <p>在插入PDB时指定XML元数据文件时，此文件描述未插入的PDB源文件的名称和位置。如果将未插入的文件从一个存储系统传输到另一个存储系统，则XML文件可能无法准确描述这些文件的位置。这些文件位于新位置，但XML文件中的文件路径仍指示旧位置。</p>
                     <p>使用XML元数据文件（而不是.pdb归档文件）插入未插入的PDB时，请使用<code class="codeph">SOURCE_FILE_NAME_CONVERT</code>子句或<code class="codeph">SOURCE_FILE_DIRECTORY</code>子句。这些条款是相互排斥的。
                     </p>
                     <p>本节包含以下主题：</p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="plugging-in-a-pdb.html#GUID-CD341EDB-8B27-484B-9C55-CF206E2983DD">SOURCE_FILE_NAME_CONVERT条款</a><br><code class="codeph">SOURCE_FILE_NAME_CONVERT</code>子句指定当PDB文件驻留在与XML文件中指定的位置不同的位置时如何定位PDB文件。
                        </li>
                        <li class="ulchildlink"><a href="plugging-in-a-pdb.html#GUID-57A111DC-5D82-47D3-9239-9B8F604528FC">SOURCE_FILE_DIRECTORY条款</a><br><code class="codeph">SOURCE_FILE_DIRECTORY</code>子句指定将用于创建新PDB的文件的源目录。</li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="plugging-in-a-pdb.html#GUID-5CFC53B9-C457-460A-92A5-DAFDC472F458" title="CREATE PLUGGABLE DATABASE语句的USING子句指定XML元数据文件或扩展名为.pdb的压缩归档文件。">关于插入未插入的PDB</a></p>
                        </div>
                     </div>
                  </div>
                  
                  <div class="sect4"><a id="GUID-CD341EDB-8B27-484B-9C55-CF206E2983DD" name="GUID-CD341EDB-8B27-484B-9C55-CF206E2983DD"></a><h5 id="MULTI-GUID-CD341EDB-8B27-484B-9C55-CF206E2983DD" class="sect5"><span class="enumeration_section">9.1.2.1</span> SOURCE_FILE_NAME_CONVERT子句</h5>
                     <div>
                        <p><code class="codeph">SOURCE_FILE_NAME_CONVERT</code>子句指定当PDB文件驻留在与XML文件中指定的位置不同的位置时如何定位PDB文件。
                        </p>
                        <p>您可以使用此子句指定以下选项之一：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>一个或多个文件名模式和替换文件名模式，格式如下：</p><pre class="oac_no_warn" dir="ltr">' <span class="italic">string1</span> '，' <span class="italic">string2</span> '，' <span class="italic">string3</span> '，' <span class="italic">string4</span> '，...
</pre><p>该<span class="italic">字符串2</span>文件名模式替换<span class="italic">字符串1</span>文件名模式，以及<span class="italic">串，4</span>文件名模式替换<span class="italic">STRING3</span>文件名模式。您可以根据需要使用多对文件名模式和替换文件名模式字符串。
                              </p>
                              <p>使用此子句时，请确保要用于PDB的文件位于替换文件名模式中。如有必要，将文件移动或复制到这些位置。</p>
                           </li>
                           <li>
                              <p><code class="codeph">NONE</code>当没有文件名需要定位，因为PDB的XML文件准确地描述文件名。省略<code class="codeph">SOURCE_FILE_NAME_CONVERT</code>子句与指定<code class="codeph">NONE</code>相同。</p>
                           </li>
                        </ul>
                        <p>您只能在<code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code>语句中使用<code class="codeph">SOURCE_FILE_NAME_CONVERT</code>子句，该语句具有指定XML元数据文件的<code class="codeph">USING</code>子句。因此，只有在使用XML元数据文件插入未插入的PDB时，才能使用此子句。当您使用.pdb存档文件插入PDB时，不能使用此子句。
                        </p>
                        <div class="example" id="GUID-CD341EDB-8B27-484B-9C55-CF206E2983DD__GUID-72F60ACF-4573-4252-9993-AC08E183F617">
                           <p class="titleinexample">例9-1 SOURCE_FILE_NAME_CONVERT子句</p>
                           <p>此<code class="codeph">SOURCE_FILE_NAME_CONVERT</code>子句使用/ disk2 / oracle / pdb7目录中的文件而不是/ disk1 / oracle / pdb7目录中的文件。在这种情况下，描述PDB的XML文件指定/ disk1 / oracle / pdb7目录，但PDB应使用/ disk2 / oracle / pdb7目录中的文件。
                           </p><pre class="oac_no_warn" dir="ltr">SOURCE_FILE_NAME_CONVERT =（'/ disk1 / oracle / pdb7 /'，'/ disk2 / oracle / pdb7 /'）</pre></div>
                        <!-- class="example" -->
                     </div>
                     <div>
                        <div class="infoboxnotealso" id="GUID-CD341EDB-8B27-484B-9C55-CF206E2983DD__GUID-36424435-B7BE-4778-85F8-CF6EEE8C55F6">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><a href="plugging-in-a-pdb.html#GUID-3132C4E5-8734-458B-8B0C-EFC77A45FFA3" title="您可以通过将未插入的PDB插入CDB来创建PDB。">插入一个未插入的PDB</a></p>
                              </li>
                              <li>
                                 <p><a href="../sqlrf/CREATE-PLUGGABLE-DATABASE.html#SQLRF55794" target="_blank"><span class="italic">Oracle数据库SQL语言参考</span></a> ，了解<code class="codeph">SOURCE_FILE_NAME_CONVERT</code>子句的语法</p>
                              </li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="plugging-in-a-pdb.html#GUID-1691A7A2-372E-4E51-8A4F-15DAC6AB0FC3" title="使用CREATE PLUGGABLE DATABASE ...使用声明将未插入的PDB插入CDB。">插入未插入的PDB时的源文件位置</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
                  <div class="props_rev_3"><a id="GUID-57A111DC-5D82-47D3-9239-9B8F604528FC" name="GUID-57A111DC-5D82-47D3-9239-9B8F604528FC"></a><h5 id="MULTI-GUID-57A111DC-5D82-47D3-9239-9B8F604528FC" class="sect5"><span class="enumeration_section">9.1.2.2</span> SOURCE_FILE_DIRECTORY子句</h5>
                     <div>
                        <p><code class="codeph">SOURCE_FILE_DIRECTORY</code>子句指定将用于创建新PDB的文件的源目录。</p>
                        <p>该子句指定包含XML文件中列出的所有文件的目录。当您有许多数据文件并且为每个文件指定<code class="codeph">SOURCE_FILE_NAME_CONVERT</code>模式不可行时，使用此子句很方便。
                        </p>
                        <p>插入PDB时，如果源文件都存在于单个目录中，则可以在此子句中指定目录名称。扫描目录以根据未插入的PDB的XML文件查找相应的文件。</p>
                        <p>您可以使用此子句指定以下选项之一：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>源文件目录的绝对路径。</p>
                           </li>
                           <li>
                              <p><code class="codeph">NONE</code>当没有文件应该被复制或PDB创建过程中移动。省略<code class="codeph">SOURCE_FILE_DIRECTORY</code>子句与指定<code class="codeph">NONE</code>相同。</p>
                           </li>
                        </ul>
                        <p></p>
                        <p>您只能在<code class="codeph">CREATE PLUGGABLE DATABASE</code>语句中使用<code class="codeph">SOURCE_FILE_DIRECTORY</code>子句，该语句具有指定XML元数据文件的<code class="codeph">USING</code>子句。因此，只有在使用XML元数据文件插入未插入的PDB时，才能使用此子句。当您使用.pdb存档文件插入PDB时，不能使用此子句。
                        </p>
                        <p>您可以为使用Oracle Managed Files的配置和不使用Oracle Managed Files的配置指定此子句。</p>
                        <div class="example" id="GUID-57A111DC-5D82-47D3-9239-9B8F604528FC__GUID-079577AE-60A8-409A-A503-1287C2734DB3">
                           <p class="titleinexample">例9-2 SOURCE_FILE_DIRECTORY子句</p>
                           <p>此<code class="codeph">SOURCE_FILE_DIRECTORY</code>子句通过使用/ oracle / pdb5 /目录中的源文件为新PDB生成文件名。
                           </p><pre class="oac_no_warn" dir="ltr">SOURCE_FILE_DIRECTORY ='/ oracle / pdb5 /'</pre></div>
                        <!-- class="example" -->
                     </div>
                     <div>
                        <div class="infoboxnotealso" id="GUID-57A111DC-5D82-47D3-9239-9B8F604528FC__GUID-36424435-B7BE-4778-85F8-CF6EEE8C55F6">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><a href="plugging-in-a-pdb.html#GUID-3132C4E5-8734-458B-8B0C-EFC77A45FFA3" title="您可以通过将未插入的PDB插入CDB来创建PDB。">插入一个未插入的PDB</a></p>
                              </li>
                              <li>
                                 <p><a href="../sqlrf/CREATE-PLUGGABLE-DATABASE.html#SQLRF57048" target="_blank"><span class="italic">Oracle Database SQL语言参考</span></a> ，了解<code class="codeph">SOURCE_FILE_DIRECTORY</code>子句的语法</p>
                              </li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="plugging-in-a-pdb.html#GUID-1691A7A2-372E-4E51-8A4F-15DAC6AB0FC3" title="使用CREATE PLUGGABLE DATABASE ...使用声明将未插入的PDB插入CDB。">插入未插入的PDB时的源文件位置</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div>
            </div><a id="ADMIN13757"></a><a id="ADMIN13756"></a><div class="props_rev_3"><a id="GUID-FEB1F7ED-33EA-4582-8861-52B18BC74A61" name="GUID-FEB1F7ED-33EA-4582-8861-52B18BC74A61"></a><h3 id="MULTI-GUID-FEB1F7ED-33EA-4582-8861-52B18BC74A61" class="sect3"><span class="enumeration_section">9.2</span>关于采用非CDB作为PDB</h3>
               <div>
                  <p>要生成描述非CDB的XML文件，请使用<code class="codeph">DBMS_PDB.DESCRIBE</code>过程。然后，在插入未插入的PDB时插入非CDB。</p>
                  <p>使用<code class="codeph">CREATE PLUGGABLE DATABASE ...创建PDB <code class="codeph">CREATE PLUGGABLE DATABASE ...USING</code>声明。当非CDB插入CDB时，它是PDB。</p>
                  <div class="figure" id="GUID-FEB1F7ED-33EA-4582-8861-52B18BC74A61__GUID-1B3EDBBB-C6FB-4B0C-B11C-8429309B56DA">
                     <p class="titleinfigure">图9-3使用DBMS_PDB.DESCRIBE过程插入非CDB</p><img src="img/admin098.png" width="495" alt="下面是图9-3的描述" title="下面是图9-3的描述" longdesc="img_text/admin098.html"><br><a href="img_text/admin098.html">“图9-3使用DBMS_PDB.DESCRIBE过程插入非CDB”的说明</a></div>
                  <!-- class="figure" -->
                  <p>您可以使用相同的技术在应用程序容器中创建新的应用程序PDB。</p>
                  <div class="infoboxnote" id="GUID-FEB1F7ED-33EA-4582-8861-52B18BC74A61__GUID-8B8734D6-E5DB-4503-9889-94A596C4A75B">
                     <p class="notep1">注意：</p>
                     <p>要使用此技术，非CDB必须在发布<span>Oracle Database 12c</span>或更高版本。
                     </p>
                  </div>
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-FEB1F7ED-33EA-4582-8861-52B18BC74A61__GUID-71EA71C0-C6BB-4D56-87D3-C40B7A8BCE2B">
                     <p class="notep1">也可以看看：</p>
                     <p><span class="q">“ <a href="plugging-in-a-pdb.html#GUID-3132C4E5-8734-458B-8B0C-EFC77A45FFA3" title="您可以通过将未插入的PDB插入CDB来创建PDB。">插入一个不插电的PDB</a> ”</span></p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="plugging-in-a-pdb.html#GUID-3132C4E5-8734-458B-8B0C-EFC77A45FFA3" title="您可以通过将未插入的PDB插入CDB来创建PDB。">插入未插入的PDB</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="ADMIN13576"></a><a id="ADMIN13577"></a><a id="ADMIN13578"></a><a id="ADMIN13579"></a><a id="ADMIN13580"></a><a id="ADMIN13582"></a><a id="ADMIN13855"></a><div class="props_rev_3"><a id="GUID-F23F5352-F456-48EE-AED7-71E3DEBAAED0" name="GUID-F23F5352-F456-48EE-AED7-71E3DEBAAED0"></a><h3 id="MULTI-GUID-F23F5352-F456-48EE-AED7-71E3DEBAAED0" class="sect3"><span class="enumeration_section">9.3</span>插入未插入的PDB</h3>
               <div>
                  <p>使用<code class="codeph">CREATE PLUGGABLE DATABASE ...插入PDB <code class="codeph">CREATE PLUGGABLE DATABASE ...USING</code>声明。
                  </p>
                  <div class="section">
                     <p class="subhead2" id="GUID-F23F5352-F456-48EE-AED7-71E3DEBAAED0__GUID-3EF284D9-10F4-476C-B651-7C8DCEC75AC7">一般先决条件</p> 
                     <p>要插入未插入的PDB，必须满足以下先决条件：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>完成<span class="q">“ <a href="overview-of-pdb-creation.html#GUID-B26D56E1-B958-444F-864C-8AFDFF1566A6" title="Before creating a PDB, you must meet certain prerequisites.">PDB创建的一般先决</a></span>条件”中描述的先决<span class="q"><a href="overview-of-pdb-creation.html#GUID-B26D56E1-B958-444F-864C-8AFDFF1566A6" title="在创建PDB之前，您必须满足某些先决条件。">条件</a></span> 。
                           </p>
                        </li>
                        <li>
                           <p>描述PDB的XML文件或.pdb存档文件必须存在于CDB可访问的位置。</p>
                           <p><code class="codeph">USING</code>子句必须指定XML文件或.pdb归档文件。如果PDB的XML文件不可用或无法定位，则使用<code class="codeph">DBMS_PDB.RECOVER</code>过程使用PDB的数据文件生成XML文件。
                           </p>
                        </li>
                        <li>
                           <p>如果在<code class="codeph">USING</code>子句中指定了XML文件（不是.pdb文件），则与PDB关联的文件（例如数据文件和钱包文件）必须存在于CDB可访问的位置。</p>
                        </li>
                        <li>
                           <p>如果插件操作的目标数据库是Oracle Data Guard配置中的主数据库，则确保备用数据库可以找到插入的PDB的文件。</p>
                           <p>在备用数据库上，将<code class="codeph">STANDBY_PDB_SOURCE_FILE_DIRECTORY</code>初始化参数设置为包含用于实例化PDB的源数据文件的位置。如果找不到文件，则备用数据库会尝试在OMF位置找到文件。如果未在OMF位置找到，则必须将数据文件复制到备用数据库上的OMF位置，然后在备用数据库上重新启动redo apply。
                           </p>
                        </li>
                        <li>
                           <p>源CDB平台和目标CDB平台必须满足以下要求：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>它们必须具有相同的字节顺序。</p>
                              </li>
                              <li>
                                 <p>安装在源平台上的数据库选项必须与目标平台上安装的数据库选项相同或者是其子集。</p>
                              </li>
                           </ul>
                        </li>
                        <li>
                           <p>如果要创建应用程序PDB，则未插入的PDB的应用程序名称和版本必须与应用程序名称和插入应用程序PDB的应用程序容器的版本匹配。</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-F23F5352-F456-48EE-AED7-71E3DEBAAED0__GUID-F6E50620-9367-483B-BFE0-3A460F43FD70">字符集先决条件</p>
                     <p>您必须满足以下匹配字符集的先决条件：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>如果插入PDB的CDB的字符集不是AL32UTF8，则包含未插入的PDB和目标CDB的CDB必须具有兼容的字符集和国家字符集。为了兼容，字符集和国家字符集必须满足“ <a href="../nlspg/choosing-character-set.html#NLSPG1035" target="_blank"><span><cite>Oracle数据库全球化支持指南”中</cite></span></a>指定的要求。
                           </p>
                           <p>如果插入PDB的CDB的字符集是AL32UTF8，则此要求不适用。</p>
                        </li>
                        <li>
                           <p>如果要创建应用程序PDB，则应用程序PDB必须具有与应用程序容器相同的字符集和国家字符集。</p>
                           <p>如果CDB的数据库字符集是AL32UTF8，则应用程序容器的字符集和国家字符集可以与CDB不同。但是，应用程序容器中的所有应用程序PDB必须具有相同的字符集和国家字符集，与应用程序容器的字符集匹配。</p>
                        </li>
                     </ul>
                     <p>要确定是否满足上述要求，请使用<code class="codeph">DBMS_PDB.CHECK_PLUG_COMPATIBILITY</code>函数。以下步骤中的步骤2描述了使用此功能。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-F23F5352-F456-48EE-AED7-71E3DEBAAED0__GUID-86E17E9E-4BE0-4EB1-83B3-3832BA217576">插入PDB：</p>
                     <ol>
                        <li>
                           <p>在SQL * Plus中，确保当前容器是目标CDB的CDB根目录或应用程序根目录。</p>
                           <p>当前容器是CDB根时，PDB在CDB中创建。当前容器是应用程序根目录时，将在应用程序容器中创建应用程序PDB。</p>
                        </li>
                        <li id="GUID-F23F5352-F456-48EE-AED7-71E3DEBAAED0__OPTIONALRUNTHEDBMS_PDB.CHECK_PLUG_C-EF8AB1D3">
                           <p>（可选）运行<code class="codeph">DBMS_PDB.CHECK_PLUG_COMPATIBILITY</code>函数以确定未插入的PDB是否与CDB兼容。</p>
                           <ol type="a">
                              <li id="GUID-F23F5352-F456-48EE-AED7-71E3DEBAAED0__IFTHEPDBISNOTYETUNPLUGGEDTHENRUNTHE-EF8C495A">
                                 <p>如果尚未拔出PDB，则运行<code class="codeph">DBMS_PDB.DESCRIBE</code>过程以生成描述PDB的XML文件。</p>
                                 <p>如果已经拔下PDB，请继续执行步骤2b。</p>
                                 <p>例如，要在/ disk1 / oracle目录中生成名为<code class="codeph">salespdb.xml</code>的XML文件，请运行以下过程：</p><pre class="pre codeblock"><code>BEGIN DBMS_PDB.DESCRIBE（pdb_descr_file =&gt;'/disk1 / oracle /salespdb.xml'，pdb_name =&gt;'SALESPDB'）;结束; /</code></pre><p>如果PDB位于远程CDB中，则可以在<code class="codeph">pdb_name</code>参数中包含<code class="codeph">@</code> <span class="italic"><code class="codeph">database_link_name</code></span> ，其中<span class="italic"><code class="codeph">database_link_name</code></span>是指向远程CDB或PDB的有效数据库链接的名称。例如，如果远程CDB的数据库链接名称是<code class="codeph">rcdb</code> ，则将<code class="codeph">pdb_name</code>值设置为<code class="codeph">SALESPDB@rcdb</code> 。
                                 </p>
                              </li>
                              <li id="GUID-F23F5352-F456-48EE-AED7-71E3DEBAAED0__RUNTHEDBMS_PDB.CHECK_PLUG_COMPATIBI-EF8AA667">
                                 <p>运行<code class="codeph">DBMS_PDB.CHECK_PLUG_COMPATIBILITY</code>函数。
                                 </p>
                                 <p>运行该功能时，请设置以下参数：</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p><code class="codeph">pdb_descr_file</code> - 将此参数设置为XML文件的完整路径。
                                       </p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">pdb_name</code> - 指定新PDB的名称。如果省略此参数，则使用XML文件中的PDB名称。
                                       </p>
                                    </li>
                                 </ul>
                                 <p>例如，要确定<code class="codeph">/disk1/usr/salespdb.xml</code>文件描述的PDB是否与当前CDB兼容，请运行以下PL / SQL块：</p><pre class="pre codeblock"><code>SET SERVEROUTPUT ON DECLARE兼容的CONSTANT VARCHAR2（3）：= CASE DBMS_PDB.CHECK_PLUG_COMPATIBILITY（pdb_descr_file =&gt;'/disk1 / usr / sortpdb.xml'，pdb_name =&gt;'SALESPDB'）当为“是”时，“否”结束; BEGIN DBMS_OUTPUT.PUT_LINE（兼容）;结束; /</code></pre><p>如果输出为<code class="codeph">YES</code> ，则PDB兼容，您可以继续下一步。如果输出为<code class="codeph">NO</code> ，则PDB不兼容：检查<code class="codeph">PDB_PLUG_IN_VIOLATIONS</code>视图以查看其不兼容的原因。
                                 </p>
                              </li>
                           </ol>
                           <div class="infoboxnote" id="GUID-F23F5352-F456-48EE-AED7-71E3DEBAAED0__GUID-67313AF6-ED3D-4E06-A49E-453CFA5F69B5">
                              <p class="notep1">注意：</p>您可以在<code class="codeph">pdb_descr_file</code>参数中指定.pdb存档文件。
                           </div>
                        </li>
                        <li>
                           <p>如果未插入PDB，请拔下插头。</p>
                        </li>
                        <li>
                           <p>运行<code class="codeph">CREATE PLUGGABLE DATABASE ...USING</code>语句，在<code class="codeph">USING</code>子句中指定XML文件或.pdb归档文件。在需要时指定其他子句。
                           </p>
                           <p>创建PDB后，它处于挂载模式，其状态为<code class="codeph">NEW</code> 。您可以通过查询<code class="codeph">V$PDBS</code>视图中的<code class="codeph">OPEN_MODE</code>列来查看PDB的打开模式。您可以通过查询<code class="codeph">CDB_PDBS</code>或<code class="codeph">DBA_PDBS</code>视图的<code class="codeph">STATUS</code>列来查看PDB的<code class="codeph">STATUS</code> 。
                           </p>
                           <p>为PDB创建新的默认服务。该服务与PDB具有相同的名称，可用于访问PDB。必须正确配置Oracle Net Services才能使客户端访问此服务。</p>
                        </li>
                        <li>
                           <p>以读/写模式打开新PDB。</p>
                           <p>您必须在Oracle数据库的读/写模式下打开新的PDB，才能完成新PDB与CDB的集成。如果尝试以只读模式打开PDB，则会返回错误。在读/写模式下打开PDB后，其状态为<code class="codeph">NORMAL</code> 。</p>
                        </li>
                        <li>
                           <p>备份PDB。</p>
                           <p>除非备份PDB，否则无法恢复PDB。</p>
                        </li>
                     </ol>
                     <div class="infoboxnote" id="GUID-F23F5352-F456-48EE-AED7-71E3DEBAAED0__GUID-FB02CD3A-80EE-4501-9DBC-385DB12AA1E7">
                        <p class="notep1">注意：</p>
                        <p>如果在创建PDB期间返回错误，则正在创建的PDB可能处于<code class="codeph">UNUSABLE</code>状态。您可以通过查询<code class="codeph">CDB_PDBS</code>或<code class="codeph">DBA_PDBS</code>视图来检查PDB的状态，并通过检查警报日志了解有关PDB创建错误的更多信息。只能删除不可用的PDB，并且必须先删除它，然后才能创建与不可用的PDB同名的PDB。
                        </p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-F23F5352-F456-48EE-AED7-71E3DEBAAED0__GUID-061C1910-9739-429B-9392-775DF147253C">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><span class="q">“ <a href="removing-a-pdb.html#GUID-893E1D67-BD95-4757-B862-03AD13AFF722" title="就像您可以将PDB插入CDB一样，您可以从CDB上拔下PDB。">从CDB上拔掉PDB</a> ”</span></p>
                        </li>
                        <li><span class="q">“ <a href="administering-a-cdb-with-sql-plus.html#GUID-322C5C03-4C48-40CD-8230-0BA5F16BF96B" title="您可以使用ALTER PLUGGABLE DATABASE SQL语句或SQL * Plus STARTUP命令修改PDB的打开模式。">修改一个或多个PDB的开放模式</a> ”</span>以获取更多信息。
                        </li>
                        <li>
                           <p>有关备份PDB的信息，请参见<a href="../bradv/backing-up-database.html#BRADV428" target="_blank"><span><cite>“Oracle数据库备份和恢复用户指南”</cite></span></a> 。</p>
                        </li>
                        <li>
                           <p><a href="../sbydb/creating-oracle-data-guard-physical-standby.html#SBYDB-GUID-20D2DEAC-0355-4FBB-ADB8-37BF5F4328E2" target="_blank"><span><cite>Oracle Data Guard概念和管理，</cite></span></a>以了解有关在Oracle Data Guard环境中插入PDB的更多信息</p>
                        </li>
                        <li>
                           <p>有关<code class="codeph">PDB_FILE_NAME_CONVERT</code>初始化参数的信息，请<code class="codeph">PDB_FILE_NAME_CONVERT</code> <a href="../refrn/PDB_FILE_NAME_CONVERT.html#REFRN10322" target="_blank"><span><cite>Oracle数据库参考</cite></span></a></p>
                        </li>
                        <li>
                           <p>有关此过程的详细信息，请<a href="../arpls/DBMS_PDB.html#ARPLS73527" target="_blank"><span><cite>参见Oracle Database PL / SQL包和类型参考</cite></span></a> 。
                           </p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="plugging-in-a-pdb.html#GUID-3132C4E5-8734-458B-8B0C-EFC77A45FFA3" title="您可以通过将未插入的PDB插入CDB来创建PDB。">插入未插入的PDB</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="ADMIN13851"></a><div class="props_rev_3"><a id="GUID-EE58804F-A999-4F7C-93DE-D641B3C1047B" name="GUID-EE58804F-A999-4F7C-93DE-D641B3C1047B"></a><h3 id="MULTI-GUID-EE58804F-A999-4F7C-93DE-D641B3C1047B" class="sect3"><span class="enumeration_section">9.4</span>采用非CDB作为PDB</h3>
               <div>
                  <p>您可以使用<code class="codeph">DBMS_PDB.DESCRIBE</code>过程将非CDB（移动）到PDB中。
                  </p>
                  <div class="section">
                     <p class="subhead2" id="GUID-EE58804F-A999-4F7C-93DE-D641B3C1047B__GUID-0A3EC9AD-C344-4C3C-94E8-DC479F15D0DD">要使用<code class="codeph">DBMS_PDB</code>包将非CDB用作PDB：</p>
                     <ol>
                        <li>
                           <p>如果CDB不存在，请创建CDB。</p>
                        </li>
                        <li>
                           <p>确保非CDB处于事务一致状态。</p>
                        </li>
                        <li>
                           <p>将非CDB置于只读模式。</p>
                        </li>
                        <li>
                           <p>连接到非CDB，并运行<code class="codeph">DBMS_PDB.DESCRIBE</code>过程以构造描述非CDB的XML文件。</p>
                           <p>当前用户必须具有<code class="codeph">SYSDBA</code>管理权限。用户必须在连接时使用<code class="codeph">AS SYSDBA</code>行使权限。
                           </p>
                           <p>例如，要在<code class="codeph">/disk1/oracle</code>目录中生成名为<code class="codeph">ncdb.xml</code>的XML文件，请运行以下过程：</p><pre class="pre codeblock"><code>BEGIN DBMS_PDB.DESCRIBE（pdb_descr_file =&gt;'/ disk1 / oracle / ncdb.xml'）;结束; /</code></pre><p>该过程成功完成后，您可以使用XML文件和非CDB数据库文件将非CDB插入CDB。</p>
                        </li>
                        <li>
                           <p>运行<code class="codeph">DBMS_PDB.CHECK_PLUG_COMPATIBILITY</code>函数以确定非CDB是否与CDB兼容。</p>
                           <p>运行该功能时，请设置以下参数：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><code class="codeph">pdb_descr_file</code> - 将此参数设置为XML文件的完整路径。
                                 </p>
                              </li>
                              <li>
                                 <p><code class="codeph">pdb_name</code> - 指定新PDB的名称。如果省略此参数，则使用XML文件中的PDB名称。
                                 </p>
                              </li>
                           </ul>
                           <p>例如，要确定<code class="codeph">/disk1/oracle/ncdb.xml</code>文件描述的非CDB是否与当前CDB兼容，请运行以下PL / SQL块：</p><pre class="pre codeblock"><code>SET SERVEROUTPUT ON DECLARE兼容的CONSTANT VARCHAR2（3）：= CASE DBMS_PDB.CHECK_PLUG_COMPATIBILITY（pdb_descr_file =&gt;'/ disk1 / oracle / ncdb.xml'，pdb_name =&gt;'NCDB'）当为“是”时，“否”结束; BEGIN DBMS_OUTPUT.PUT_LINE（兼容）;结束; /</code></pre><p>如果输出为<code class="codeph">YES</code> ，则非CDB兼容，您可以继续下一步。如果输出为<code class="codeph">NO</code> ，则非CDB不兼容，您可以检查<code class="codeph">PDB_PLUG_IN_VIOLATIONS</code>视图以查看它不兼容的原因。在继续之前，必须纠正所有违规行为。例如，应通过运行升级或datapatch实用程序来解决任何版本或修补程序不匹配问题。纠正违规后，再次运行<code class="codeph">DBMS_PDB.CHECK_PLUG_COMPATIBILITY</code>以确保非CDB与CDB兼容。</p>
                        </li>
                        <li>
                           <p>关闭非CDB。</p>
                        </li>
                        <li>
                           <p>插入非CDB。</p>
                           <p>例如，以下SQL语句插入非CDB，将其文件复制到新位置，并且仅包含非CDB中的<code class="codeph">tbs3</code>用户表空间：</p><pre class="pre codeblock"><code>创建可插入的数据库ncdb使用'/disk1/oracle/ncdb.xml'COPY FILE_NAME_CONVERT =（'/ disk1 / oracle / dbs /'，'/ disk2 / oracle / ncdb /'）USER_TABLESPACES =（'tbs3'）;</code></pre><p>如果没有违规，则不要打开新的PDB。您将在以下步骤中打开它。</p>
                           <p><code class="codeph">USER_TABLESPACES</code>子句使您可以将用于非CDB中的多个租户的数据分隔到不同的PDB中。您可以在此子句中使用多个<code class="codeph">CREATE PLUGGABLE DATABASE</code>语句来创建其他PDB，其中包含非CDB中存在的其他表空间中的数据。</p>
                        </li>
                        <li>
                           <p>运行<code class="codeph"><span class="codeinlineitalic">ORACLE_HOME</span> /rdbms/admin/noncdb_to_pdb.sql</code>脚本。必须先运行此脚本，才能首次打开PDB。
                           </p>
                           <p>如果PDB不是非CDB，则不需要运行<code class="codeph">noncdb_to_pdb.sql</code>脚本。要运行<code class="codeph">noncdb_to_pdb.sql</code>脚本，请完成以下步骤：</p>
                           <ol type="a">
                              <li>
                                 <p>访问PDB。</p>
                                 <p>当前用户必须具有<code class="codeph">SYSDBA</code>管理权限，并且必须在PDB中共同授予或本地授予该权限。用户必须在连接时使用<code class="codeph">AS SYSDBA</code>行使权限。
                                 </p>
                              </li>
                              <li>
                                 <p>运行<code class="codeph">noncdb_to_pdb.sql</code>脚本：</p><pre class="pre codeblock"><code>@ $ ORACLE_HOME / RDBMS /管理/ noncdb_to_pdb.sql</code></pre></li>
                           </ol>
                           <p>该脚本在更改完成后打开PDB，执行更改并关闭PDB。</p>
                        </li>
                        <li id="GUID-EE58804F-A999-4F7C-93DE-D641B3C1047B__OPENTHENEWPDBINREADWRITEMODE.YOUMUS-EF8E3A86">
                           <p>以读/写模式打开新PDB。</p>
                           <p>您必须在Oracle数据库的读/写模式下打开新的PDB，才能完成新PDB与CDB的集成。如果尝试以只读模式打开PDB，则会返回错误。在读/写模式下打开PDB后，其状态为<code class="codeph">NORMAL</code> 。</p>
                        </li>
                        <li>
                           <p>备份PDB。</p>
                           <p>除非备份PDB，否则无法恢复PDB。</p>
                        </li>
                     </ol>
                     <div class="infoboxnote" id="GUID-EE58804F-A999-4F7C-93DE-D641B3C1047B__GUID-E9DD002C-0C50-487B-B857-6AA13F0DC51F">
                        <p class="notep1">注意：</p>
                        <p>如果在创建PDB期间返回错误，则正在创建的PDB可能处于<code class="codeph">UNUSABLE</code>状态。您可以通过查询<code class="codeph">CDB_PDBS</code>或<code class="codeph">DBA_PDBS</code>视图来检查PDB的状态，并通过检查警报日志了解有关PDB创建错误的更多信息。只能删除不可用的PDB，并且必须先删除它，然后才能创建与不可用的PDB同名的PDB。
                        </p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="plugging-in-a-pdb.html#GUID-F23F5352-F456-48EE-AED7-71E3DEBAAED0" title="使用CREATE PLUGGABLE DATABASE插入PDB ...使用声明。">插入一个未插入的PDB</a></li>
                        <li><a href="creating-and-configuring-a-cdb.html#GUID-77D4BBA7-2A64-46D9-A2B8-C56060772215" title="创建和配置多租户容器数据库（CDB）包括计划，创建CDB和可选配置EM Express等任务。">创建和配置CDB</a></li>
                        <li><a href="plugging-in-a-pdb.html#GUID-E7122CD7-47CA-4A89-A419-8CDEE622AF70" title="在插入未插入的PDB后，有关用户和表空间的某些规则适用。">插入未插入的PDB后</a></li>
                        <li><a href="../bradv/backing-up-database.html#BRADV-GUID-EB261F93-318D-4EBA-8E26-B0589703CC73" target="_blank"><span><cite>Oracle数据库备份和恢复用户指南</cite></span></a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="plugging-in-a-pdb.html#GUID-3132C4E5-8734-458B-8B0C-EFC77A45FFA3" title="您可以通过将未插入的PDB插入CDB来创建PDB。">插入未插入的PDB</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="ADMIN14168"></a><div class="props_rev_3"><a id="GUID-E7122CD7-47CA-4A89-A419-8CDEE622AF70" name="GUID-E7122CD7-47CA-4A89-A419-8CDEE622AF70"></a><h3 id="MULTI-GUID-E7122CD7-47CA-4A89-A419-8CDEE622AF70" class="sect3"><span class="enumeration_section">9.5</span>插入未插入的PDB后</h3>
               <div>
                  <p>在插入未插入的PDB后，有关用户和表空间的某些规则适用。</p>
                  <p>插入未插入的PDB后，以下内容适用：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>PDB中使用源PDB的默认临时表空间的用户帐户使用目标PDB的默认临时表空间。在源PDB中使用非默认临时表空间的用户帐户将继续在目标PDB中使用相同的本地临时表空间。</p>
                     </li>
                     <li>
                        <p>手动创建源CDB中但不存在于目标CDB中的公共用户帐户没有通常授予的权限。但是，如果目标CDB具有与PDB中的公共用户同名的公共用户，则后者链接到前者并且具有在目标CDB中授予该公共用户的特权。</p>
                        <p>如果克隆或插入的PDB具有目标CDB中不存在的公共用户帐户，并且该用户不拥有PDB中的对象，则Oracle数据库会在同步步骤中删除用户;否则，用户帐户被锁定在目标PDB中。您有关于锁定帐户的以下选项：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>关闭PDB，连接到根，并创建具有相同名称的公共用户帐户。在读/写模式下打开PDB时，将解决通常授予用户帐户的角色和权限的差异，您可以解锁该帐户。在此过程中，本地授予用户帐户的权限和角色保持不变。</p>
                           </li>
                           <li>
                              <p>在PDB中创建一个新的本地用户帐户，并使用Data Pump将锁定用户的数据导出/导入到新的本地用户的架构中。</p>
                           </li>
                           <li>
                              <p>保持用户帐户锁定。</p>
                           </li>
                           <li>
                              <p>删除用户帐户。</p>
                           </li>
                        </ul>
                     </li>
                  </ul>
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-E7122CD7-47CA-4A89-A419-8CDEE622AF70__GUID-BB96C2B0-E059-4CBA-903B-E957AD15836E">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><span class="q">“ <a href="administering-pdbs-with-sql-plus.html#GUID-6FDBCEFC-29DF-4CBB-A000-B105A7328955" title="您可以为PDB创建，修改或删除服务。">管理PDB服务</a> ”</span></p>
                        </li>
                        <li>
                           <p><span class="q">“ <a href="administering-a-cdb-with-sql-plus.html#GUID-B34BC55B-C734-4799-A54A-0BB04073D9D0" title="表空间是消耗存储空间的数据库对象（如表和索引）的逻辑存储容器。">关于管理CDB中的表空间</a> ”</span></p>
                        </li>
                        <li>
                           <p>有关常见用户和本地用户的信息，请参阅<a href="overview-of-the-multitenant-architecture.html#CNCPT89257" target="_blank"><span><cite>Oracle数据库概念</cite></span></a></p>
                        </li>
                        <li>
                           <p><a href="../dbseg/managing-security-for-oracle-database-users.html#DBSEG002" target="_blank"><span><cite>“Oracle数据库安全指南”</cite></span></a> ，了解有关在CDB中创建公共用户和本地用户的信息</p>
                        </li>
                        <li>
                           <p>有关将Oracle Data Pump与CDB一起使用的信息，请参见<a href="../sutil/oracle-data-pump-overview.html#SUTIL4334" target="_blank"><span><cite>Oracle数据库实用程序</cite></span></a></p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="plugging-in-a-pdb.html#GUID-3132C4E5-8734-458B-8B0C-EFC77A45FFA3" title="您可以通过将未插入的PDB插入CDB来创建PDB。">插入未插入的PDB</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-2DB6E163-48F0-4458-8DC3-A88F89EFEA81" name="GUID-2DB6E163-48F0-4458-8DC3-A88F89EFEA81"></a><h3 id="MULTI-GUID-2DB6E163-48F0-4458-8DC3-A88F89EFEA81" class="sect3"><span class="enumeration_section">9.6</span>插入未插入的PDB：示例</h3>
               <div>
                  <p>这些示例使用<code class="codeph">/disk1/usr/salespdb.xml</code>文件或<code class="codeph">/disk1/usr/sales.pdb</code>文件插入名为<code class="codeph">salespdb</code>的未插入PDB， <code class="codeph">/disk1/usr/sales.pdb</code>给出不同的因子。
                  </p>
                  <div class="section">
                     <p>在每个示例中，新PDB所属的根取决于运行<code class="codeph">CREATE PLUGGABLE DATABASE</code>语句时的当前容器：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>当前容器是CDB根时，将在CDB中创建新的PDB。</p>
                        </li>
                        <li>
                           <p>当前容器是应用程序根目录时，将在应用程序根目录的应用程序容器中创建新的应用程序PDB。</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-2DB6E163-48F0-4458-8DC3-A88F89EFEA81__CEGHJJEF">
                     <p class="titleinexample">例9-3使用NOCOPY子句插入未插入的PDB</p>
                     <p>此示例假定以下因素：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>新PDB不基于用于在CDB中创建现有PDB的相同未插入PDB。因此，不需要<code class="codeph">AS</code> <code class="codeph">CLONE</code>子句。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">PATH_PREFIX</code>子句不是必需的。
                           </p>
                        </li>
                        <li>
                           <p>XML文件准确描述了文件的当前位置。因此，不需要<code class="codeph">SOURCE_FILE_NAME_CONVERT</code>子句或<code class="codeph">SOURCE_FILE_DIRECTORY</code>子句。
                           </p>
                        </li>
                        <li>
                           <p>文件位于正确的位置。因此，包括<code class="codeph">NOCOPY</code> 。
                           </p>
                        </li>
                        <li>
                           <p>PDB不需要存储限制。因此，不需要<code class="codeph">STORAGE</code>子句。
                           </p>
                        </li>
                        <li>
                           <p>目标位置中存在与XML文件中指定的临时文件同名的文件。因此， <code class="codeph">TEMPFILE REUSE</code>子句是必需的。
                           </p>
                        </li>
                     </ul>
                     <p>鉴于上述因素，以下语句插入PDB：</p><pre class="pre codeblock"><code>CREATE PLUGGABLE DATABASE salespdb使用'/disk1/usr/salespdb.xml'NOCOPY TEMPFILE REUSE;</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-2DB6E163-48F0-4458-8DC3-A88F89EFEA81__CEGHGABE">
                     <p class="titleinexample">例9-4使用AS CLONE和NOCOPY子句插入未插入的PDB</p>
                     <p>此示例假定以下因素：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>新的PDB基于用于在CDB中创建现有PDB的相同的未插入PDB。因此， <code class="codeph">AS</code> <code class="codeph">CLONE</code>子句是必需的。<code class="codeph">AS</code> <code class="codeph">CLONE</code>子句确保新PDB具有唯一标识符。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">PATH_PREFIX</code>子句不是必需的。
                           </p>
                        </li>
                        <li>
                           <p>XML文件准确描述了文件的当前位置。因此，不需要<code class="codeph">SOURCE_FILE_NAME_CONVERT</code>子句或<code class="codeph">SOURCE_FILE_DIRECTORY</code>子句。
                           </p>
                        </li>
                        <li>
                           <p>文件位于正确的位置。因此，包括<code class="codeph">NOCOPY</code> 。
                           </p>
                        </li>
                        <li>
                           <p>PDB不需要存储限制。因此，不需要<code class="codeph">STORAGE</code>子句。
                           </p>
                        </li>
                        <li>
                           <p>目标位置中存在与XML文件中指定的临时文件同名的文件。因此， <code class="codeph">TEMPFILE REUSE</code>子句是必需的。
                           </p>
                        </li>
                     </ul>
                     <p>鉴于上述因素，以下语句插入PDB：</p><pre class="pre codeblock"><code>创建可插入数据库salespdb作为CLONE使用'/disk1/usr/salespdb.xml'NOCOPY TEMPFILE REUSE;</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-2DB6E163-48F0-4458-8DC3-A88F89EFEA81__CEGIHHBF">
                     <p class="titleinexample">示例9-5使用SOURCE_FILE_NAME_CONVERT，NOCOPY和STORAGE子句插入未插入的PDB</p>
                     <p>此示例假定以下因素：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>新PDB不基于用于在CDB中创建现有PDB的相同未插入PDB。因此，不需要<code class="codeph">AS</code> <code class="codeph">CLONE</code>子句。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">PATH_PREFIX</code>子句不是必需的。
                           </p>
                        </li>
                        <li>
                           <p>XML文件无法准确描述文件的当前位置。因此，需要<code class="codeph">SOURCE_FILE_NAME_CONVERT</code>子句或<code class="codeph">SOURCE_FILE_DIRECTORY</code>子句。在此示例中，XML文件指示文件位于/ disk1 / oracle / sales中，但文件位于/ disk2 / oracle / sales中，并使用<code class="codeph">SOURCE_FILE_NAME_CONVERT</code>子句。
                           </p>
                        </li>
                        <li>
                           <p>文件位于正确的位置。因此，包括<code class="codeph">NOCOPY</code> 。
                           </p>
                        </li>
                        <li>
                           <p>必须对PDB强制执行存储限制。因此，需要<code class="codeph">STORAGE</code>子句。具体而言，属于PDB的所有表空间不得超过2千兆字节。
                           </p>
                        </li>
                        <li>
                           <p>目标位置中存在与XML文件中指定的临时文件同名的文件。因此， <code class="codeph">TEMPFILE REUSE</code>子句是必需的。
                           </p>
                        </li>
                     </ul>
                     <p>鉴于上述因素，以下语句插入PDB：</p><pre class="pre codeblock"><code>CREATE PLUGGABLE DATABASE salespdb使用'/disk1/usr/salespdb.xml'SOURCE_FILE_NAME_CONVERT =（'/ disk1 / oracle / sales /'，'/ disk2 / oracle / sales /'）NOCOPY STORAGE（MAXSIZE 2G）TEMPFILE REUSE;</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-2DB6E163-48F0-4458-8DC3-A88F89EFEA81__CEGBBHIF">
                     <p class="titleinexample">示例9-6使用COPY，PATH_PREFIX和FILE_NAME_CONVERT子句插入未插入的PDB</p>
                     <p>此示例假定以下因素：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>新PDB不基于用于在CDB中创建现有PDB的相同未插入PDB。因此，不需要<code class="codeph">AS</code> <code class="codeph">CLONE</code>子句。
                           </p>
                        </li>
                        <li>
                           <p>必须将路径前缀添加到PDB的目录对象路径中。因此， <code class="codeph">PATH_PREFIX</code>子句是必需的。在此示例中，路径前缀/ disk2 / oracle / sales /被添加到PDB的目录对象路径中。
                           </p>
                        </li>
                        <li>
                           <p>XML文件准确描述了文件的当前位置。因此，不需要<code class="codeph">SOURCE_FILE_NAME_CONVERT</code>子句或<code class="codeph">SOURCE_FILE_DIRECTORY</code>子句。
                           </p>
                        </li>
                        <li>
                           <p>文件不在正确的位置。因此，必须包含<code class="codeph">COPY</code>或<code class="codeph">MOVE</code> 。在此示例中，将复制文件。
                           </p>
                           <p>未使用<code class="codeph">CREATE_FILE_DEST</code>子句，未启用Oracle Managed Files，并且未设置<code class="codeph">PDB_FILE_NAME_CONVERT</code>初始化参数。因此，需要<code class="codeph">FILE_NAME_CONVERT</code>子句。在此示例中，文件从/ disk1 / oracle / sales复制到/ disk2 / oracle / sales。
                           </p>
                        </li>
                        <li>
                           <p>PDB不需要存储限制。因此，不需要<code class="codeph">STORAGE</code>子句。
                           </p>
                        </li>
                        <li>
                           <p>没有与将在目标位置创建的新临时文件同名的文件。因此， <code class="codeph">TEMPFILE REUSE</code>子句。
                           </p>
                        </li>
                     </ul>
                     <p>鉴于上述因素，以下语句插入PDB：</p><pre class="pre codeblock"><code>CREATE PLUGGABLE DATABASE salespdb使用'/disk1/usr/salespdb.xml'COPY PATH_PREFIX ='/ disk2 / oracle / sales /'FILE_NAME_CONVERT =（'/ disk1 / oracle / sales /'，'/ disk2 / oracle / sales /'） ;</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-2DB6E163-48F0-4458-8DC3-A88F89EFEA81__CEGCFDEB">
                     <p class="titleinexample">示例9-7使用SOURCE_FILE_NAME_CONVERT，MOVE，FILE_NAME_CONVERT和STORAGE子句插入未插入的PDB</p>
                     <p>此示例假定以下因素：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>新PDB不基于用于在CDB中创建现有PDB的相同未插入PDB。因此，不需要<code class="codeph">AS</code> <code class="codeph">CLONE</code>子句。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">PATH_PREFIX</code>子句不是必需的。
                           </p>
                        </li>
                        <li>
                           <p>XML文件无法准确描述文件的当前位置。因此，需要<code class="codeph">SOURCE_FILE_NAME_CONVERT</code>子句或<code class="codeph">SOURCE_FILE_DIRECTORY</code>子句。在此示例中，XML文件指示文件位于/ disk1 / oracle / sales中，但文件位于/ disk2 / oracle / sales中，并使用<code class="codeph">SOURCE_FILE_NAME_CONVERT</code>子句。
                           </p>
                        </li>
                        <li>
                           <p>文件不在PDB的正确最终位置。因此，必须包含<code class="codeph">COPY</code>或<code class="codeph">MOVE</code> 。在此示例中，指定<code class="codeph">MOVE</code>以移动文件。
                           </p>
                           <p>未使用<code class="codeph">CREATE_FILE_DEST</code>子句，未启用Oracle Managed Files，并且未设置<code class="codeph">PDB_FILE_NAME_CONVERT</code>初始化参数。因此，需要<code class="codeph">FILE_NAME_CONVERT</code>子句。在此示例中，文件从/ disk2 / oracle / sales移动到/ disk3 / oracle / sales。
                           </p>
                        </li>
                        <li>
                           <p>必须对PDB强制执行存储限制。因此，需要<code class="codeph">STORAGE</code>子句。具体而言，属于PDB的所有表空间不得超过2千兆字节。
                           </p>
                        </li>
                        <li>
                           <p>没有与将在目标位置创建的新临时文件同名的文件。因此， <code class="codeph">TEMPFILE REUSE</code>子句。
                           </p>
                        </li>
                     </ul>
                     <p>鉴于上述因素，以下语句插入PDB：</p><pre class="pre codeblock"><code>CREATE PLUGGABLE DATABASE salespdb使用'/disk1/usr/salespdb.xml'SOURCE_FILE_NAME_CONVERT =（'/ disk1 / oracle / sales /'，'/ disk2 / oracle / sales /'）MOVE FILE_NAME_CONVERT =（'/ disk2 / oracle / sales / '，'/ disk3 / oracle / sales /'）STORAGE（MAXSIZE 2G）;</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-2DB6E163-48F0-4458-8DC3-A88F89EFEA81__GUID-25116949-7B46-4A58-8926-7F394CE495B6">
                     <p class="titleinexample">示例9-8使用SOURCE_FILE_DIRECTORY，MOVE，FILE_NAME_CONVERT和STORAGE子句插入未插入的PDB</p>
                     <p>此示例假定以下因素：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>新PDB不基于用于在CDB中创建现有PDB的相同未插入PDB。因此，不需要<code class="codeph">AS</code> <code class="codeph">CLONE</code>子句。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">PATH_PREFIX</code>子句不是必需的。
                           </p>
                        </li>
                        <li>
                           <p>XML文件无法准确描述文件的当前位置。因此，需要<code class="codeph">SOURCE_FILE_NAME_CONVERT</code>子句或<code class="codeph">SOURCE_FILE_DIRECTORY</code>子句。在此示例中，XML文件指示文件位于/ disk1 / oracle / sales中，但文件位于/ disk2 / oracle / sales中，并使用<code class="codeph">SOURCE_FILE_DIRECTORY</code>子句。
                           </p>
                        </li>
                        <li>
                           <p>文件不在PDB的正确最终位置。因此，必须包含<code class="codeph">COPY</code>或<code class="codeph">MOVE</code> 。在此示例中，指定<code class="codeph">MOVE</code>以移动文件。
                           </p>
                           <p>未使用<code class="codeph">CREATE_FILE_DEST</code>子句，未启用Oracle Managed Files，并且未设置<code class="codeph">PDB_FILE_NAME_CONVERT</code>初始化参数。因此，需要<code class="codeph">FILE_NAME_CONVERT</code>子句。在此示例中，文件从/ disk2 / oracle / sales移动到/ disk3 / oracle / sales。
                           </p>
                        </li>
                        <li>
                           <p>必须对PDB强制执行存储限制。因此，需要<code class="codeph">STORAGE</code>子句。具体而言，属于PDB的所有表空间不得超过2千兆字节。
                           </p>
                        </li>
                        <li>
                           <p>没有与将在目标位置创建的新临时文件同名的文件。因此， <code class="codeph">TEMPFILE REUSE</code>子句。
                           </p>
                        </li>
                     </ul>
                     <p>鉴于上述因素，以下语句插入PDB：</p><pre class="pre codeblock"><code>CREATE PLUGGABLE DATABASE salespdb使用'/disk1/usr/salespdb.xml'SOURCE_FILE_DIRECTORY ='/ disk2 / oracle / sales /'MOVE FILE_NAME_CONVERT =（'/ disk2 / oracle / sales /'，'/ disk3 / oracle / sales /'）存储（MAXSIZE 2G）;</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-2DB6E163-48F0-4458-8DC3-A88F89EFEA81__GUID-B39279E7-7C71-443D-AA65-4DCC2EBAF770">
                     <p class="titleinexample">例9-9使用存档文件插入未插入的PDB</p>
                     <p>此示例假定以下因素：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>未插入的PDB位于名为<code class="codeph">sales.pdb</code>的.pdb存档文件中。归档文件以压缩格式包含XML元数据文件和PDB的文件（如数据文件和钱包文件），并在运行<code class="codeph">CREATE PLUGGABLE DATABASE</code>语句时将这些文件解压缩到.pdb归档文件的当前目录。
                           </p>
                        </li>
                        <li>
                           <p>新PDB不基于用于在CDB中创建现有PDB的相同未插入PDB。因此，不需要<code class="codeph">AS</code> <code class="codeph">CLONE</code>子句。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">PATH_PREFIX</code>子句不是必需的。
                           </p>
                        </li>
                        <li>
                           <p>必须对PDB强制执行存储限制。因此，需要<code class="codeph">STORAGE</code>子句。具体而言，属于PDB的所有表空间不得超过2千兆字节。
                           </p>
                        </li>
                        <li>
                           <p>没有与将在目标位置创建的新临时文件同名的文件。因此， <code class="codeph">TEMPFILE REUSE</code>子句。
                           </p>
                        </li>
                     </ul>
                     <p>鉴于上述因素，以下语句使用存档文件插入PDB：</p><pre class="pre codeblock"><code>一世</code></pre></div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="plugging-in-a-pdb.html#GUID-3132C4E5-8734-458B-8B0C-EFC77A45FFA3" title="您可以通过将未插入的PDB插入CDB来创建PDB。">插入未插入的PDB</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
         </div>
      </article>
   </body>
</html>