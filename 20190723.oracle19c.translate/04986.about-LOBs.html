<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>的LOB</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Programmer&#39;s Guide"></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Programmer&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="c-c-programmers-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-11T03:52:01-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96467-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="Oracle-dynamic-SQL-method-4.html" title="Previous" type="text/html"></link>
      <link rel="next" href="about-Objects.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Pro*C/C++ Programmer&#39;s Guide"></meta>
    <meta name="dcterms.isVersionOf" content="LNPCC"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="Oracle-dynamic-SQL-method-4.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="about-Objects.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">程序员指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="applications.html" property="item" typeof="WebPage"><span property="name">应用</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">的LOB</li>
            </ol>
            <a id="GUID-DEBB0C35-161B-4725-BE0D-A209B64B98A2" name="GUID-DEBB0C35-161B-4725-BE0D-A209B64B98A2"></a><a id="LNPCC016"></a>
            
            <h2 id="LNPCC-GUID-DEBB0C35-161B-4725-BE0D-A209B64B98A2" class="sect2"><span class="enumeration_chapter">16个</span> LOB</h2>
         </header>
         <div class="ind"><script type="text/javascript">window.name='about-LOBs'</script><script type="text/javascript">
    function footdisplay(footnum,footnote) {
    var msg = window.open('about:blank', 'NewWindow' + footnum,
        'directories=no,height=100,location=no,menubar=no,resizable=yes,' +
        'scrollbars=yes,status=no,toolbar=no,width=598');
    msg.document.open('text/html');
    msg.document.write('<!DOCTYPE html ');
    msg.document.write('PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" ');
    msg.document.write('"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">'); 
    msg.document.write('<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us" dir="ltr"><head><title>');
   
    msg.document.write('Footnote&nbsp; ' + footnum);
    msg.document.write('<\/title><meta http-equiv="Content-Type" ');
    msg.document.write('content="text/html; charset=utf-8" />');
    msg.document.write('<meta http-equiv="Content-Script-Type" ');
    msg.document.write('content="text/javascript" />');
    msg.document.write('<style type="text/css"> <![CDATA[ ');
    msg.document.write('h1 {text-align: center; font-size: 14pt;}');
    msg.document.write('fieldset {border: none;}');
    msg.document.write('form {text-align: center;}');
    msg.document.write(' ]]u003e </style>');
    msg.document.write('<\/head><body><div id="footnote"><h1>Footnote&nbsp; ' + footnum + '<\/h1><p>');
    msg.document.write(footnote);
    msg.document.write('<\/p><form action="" method="post"><fieldset>');
    msg.document.write('<input type="button" value="OK" ');
    msg.document.write('onclick="window.close();" />');
    msg.document.write('<\/fieldset><\/form><\/div><\/body><\/html>');
    msg.document.close();
    setTimeout(function() {
        var height = msg.document.getElementById('footnote').offsetHeight;
        msg.resizeTo(598, height + 100);
    }
    , 100);
    msg.focus();
}
            </script><noscript>
               <p>此页面上的脚本内容仅用于导航目的，不会以任何方式更改内容。</p>
            </noscript>
            <div>
               <p>本章介绍嵌入式SQL语句为LOB（大对象）数据类型提供的支持。</p>
               <p>引入了四种类型的LOB，并与较旧的LONG和LONG RAW数据类型进行了比较。</p>
               <p>Pro * C / C ++中的嵌入式SQL接口显示为提供与Oracle Call Interface API和PL / SQL语言类似的功能。</p>
               <p>将显示LOB语句及其选项和主机变量。</p>
               <p>最后，使用LOB接口的Pro * C / C ++程序示例作为简单的使用说明。</p>
               <p>本章包含以下主题：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="about-LOBs.html#GUID-3ADDFEBF-C413-4D62-9B55-1B530D37A4B3">什么是LOB？</a></p>
                  </li>
                  <li>
                     <p><a href="about-LOBs.html#GUID-1727FAEE-BE2F-44EF-BCCB-7F8C0EE84600">如何在您的程序中使用LOB</a></p>
                  </li>
                  <li>
                     <p><a href="about-LOBs.html#GUID-B1C0344B-7859-4EE0-BFA0-775590E34184">LOB声明规则</a></p>
                  </li>
                  <li>
                     <p><a href="about-LOBs.html#GUID-6A12C55F-E5A3-41F9-96E8-8F1B7671B1C6">LOB声明</a></p>
                  </li>
                  <li>
                     <p><a href="about-LOBs.html#GUID-5DA7FD4D-FC6E-416E-A8E6-AD80E3882D70">LOB和导航界面</a></p>
                  </li>
                  <li>
                     <p><a href="about-LOBs.html#GUID-8FC2E666-EA9B-4202-BB84-007CC31988C0">LOB程序示例</a></p>
                  </li>
               </ul>
            </div><a id="LNPCC4195"></a><div class="props_rev_3"><a id="GUID-3ADDFEBF-C413-4D62-9B55-1B530D37A4B3" name="GUID-3ADDFEBF-C413-4D62-9B55-1B530D37A4B3"></a><h3 id="LNPCC-GUID-3ADDFEBF-C413-4D62-9B55-1B530D37A4B3" class="sect3"><span class="enumeration_section">16.1</span>什么是LOB？
               </h3>
               <div>
                  <p>使用LOB（大对象）列来存储大量数据（最大大小为4千兆字节），例如ASCII文本，国家字符文本，各种图形格式的文件和声波形式。</p>
               </div><a id="LNPCC4196"></a><div class="props_rev_3"><a id="GUID-8ED14C11-193E-44F9-B154-E43F3028B775" name="GUID-8ED14C11-193E-44F9-B154-E43F3028B775"></a><h4 id="LNPCC-GUID-8ED14C11-193E-44F9-B154-E43F3028B775" class="sect4"><span class="enumeration_section">16.1.1</span>内部LOB</h4>
                  <div>
                     <p>内部LOB（BLOB，CLOB，NCLOB）存储在数据库表空间中，并具有数据库服务器的事务支持（Commit，Rollback等等。与它们一起工作）。</p>
                     <p>BLOB（二进制LOB）存储非结构化二进制（也称为“原始”）数据，例如视频剪辑。</p>
                     <p>CLOB（字符LOB）存储来自数据库字符集的大块字符数据。</p>
                     <p>NCLOB（国家字符LOB）存储来自国家字符集的大块字符数据。</p>
                  </div>
               </div><a id="LNPCC4197"></a><div class="props_rev_3"><a id="GUID-5834BC49-4053-40FF-BE39-B14342B1201E" name="GUID-5834BC49-4053-40FF-BE39-B14342B1201E"></a><h4 id="LNPCC-GUID-5834BC49-4053-40FF-BE39-B14342B1201E" class="sect4"><span class="enumeration_section">16.1.2</span>外部LOB</h4>
                  <div>
                     <p>外部LOB是数据库表空间之外的操作系统文件，它们没有来自数据库服务器的事务支持。</p>
                     <p><code class="codeph">BFILEs</code> （二进制文件）将数据存储在外部二进制文件中。BFILE可以是GIF，JPEG，MPEG，MPEG2，文本或其他格式。
                     </p>
                  </div>
               </div><a id="LNPCC4198"></a><div class="props_rev_3"><a id="GUID-D2A25E48-965A-4647-8345-B780F29C0FE9" name="GUID-D2A25E48-965A-4647-8345-B780F29C0FE9"></a><h4 id="LNPCC-GUID-D2A25E48-965A-4647-8345-B780F29C0FE9" class="sect4"><span class="enumeration_section">16.1.3</span> BFILE的安全性</h4>
                  <div>
                     <p>DIRECTORY对象用于访问和使用BFILE。DIRECTORY是包含该文件的服务器文件系统中的实际物理目录的逻辑别名（存储在服务器中）。仅当授予DIRECTORY对象的访问权限时，才允许用户访问该文件。</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>DDL（数据定义语言）SQL语句CREATE，REPLACE，ALTER和DROP与DIRECTORY数据库对象一起使用。</p>
                        </li>
                        <li>
                           <p>DML（数据管理语言）SQL语句用于GRANT和REVOKE DIRECTORY对象的READ系统和对象权限。</p>
                        </li>
                     </ul>
                     <p>CREATE DIRECTORY指令的示例是：</p><pre class="oac_no_warn" dir="ltr">EXEC SQL创建或替换目录“Mydir”AS'/ usr / home / mydir';</pre><p>仅当您使用DML（数据操作语言）语句（例如GRANT）授予其权限时，其他用户或角色才能读取该目录。例如，允许用户<code class="codeph">scott</code>读取目录<code class="codeph">/usr/home/mydir</code> BFILES：</p><pre class="oac_no_warn" dir="ltr">EXEC SQL GRANT阅读目录“Mydir”TO scott;</pre><p>一次会话中最多可同时打开10个BFILES。可以通过设置SESSION_MAX_OPEN_FILES参数来更改此默认值。</p>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="../adfns/index.html" target="_blank"><span><cite>Oracle数据库开发指南</cite></span></a></li>
                           <li><a href="../sqlrf/GRANT.html#SQLRF-GUID-20B4E2C0-A7F8-4BC8-A5E8-BE61BDC41AC3" target="_blank"><span class="italic">GRANT</span></a></li>
                        </ul>
                     </div>
                  </div>
               </div><a id="LNPCC4199"></a><div class="props_rev_3"><a id="GUID-78ECA1B5-9D68-4EA9-934E-E8521D53B993" name="GUID-78ECA1B5-9D68-4EA9-934E-E8521D53B993"></a><h4 id="LNPCC-GUID-78ECA1B5-9D68-4EA9-934E-E8521D53B993" class="sect4"><span class="enumeration_section">16.1.4</span> LOB与长期和长期的比较</h4>
                  <div>
                     <p>LOB在许多方面与旧的LONG和LONG RAW数据类型不同。</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>LOB和LONG RAW的最大LOB大小为4千兆字节，而2千兆字节。</p>
                        </li>
                        <li>
                           <p>您可以在LOB上使用随机和顺序访问方法;您只能在LONG和LONG RAW上使用顺序访问方法。</p>
                        </li>
                        <li>
                           <p>LOB（NCLOB除外）可以是您定义的对象类型的属性。</p>
                        </li>
                        <li>
                           <p>表可以有多个LOB列，但只能有一个LONG或LONG RAW列。</p>
                        </li>
                     </ul>
                     <p>Oracle建议将现有的LONG和LONG Raw属性迁移到LOB。甲骨文计划在未来的版本中终止对LONG和LONG RAW的支持。有关<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/lnpcc&amp;id=DRDAA" target="_blank"><span class="italic">迁移</span></a>的详细信息，请参见“ <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/lnpcc&amp;id=DRDAA" target="_blank"><span class="italic">Oracle®数据库迁移指南”</span></a>
                     </p>
                  </div>
               </div><a id="LNPCC4200"></a><div class="props_rev_3"><a id="GUID-E4862409-98BA-4613-BBDB-B8A759061793" name="GUID-E4862409-98BA-4613-BBDB-B8A759061793"></a><h4 id="LNPCC-GUID-E4862409-98BA-4613-BBDB-B8A759061793" class="sect4"><span class="enumeration_section">16.1.5</span> LOB定位器</h4>
                  <div>
                     <p>LOB定位符指向实际的LOB内容。检索LOB时返回定位器，而不是LOB的内容。LOB定位器无法保存在一个事务或会话中，并在以后的事务或会话中再次使用。</p>
                  </div>
               </div><a id="LNPCC4201"></a><div class="props_rev_3"><a id="GUID-44CE1B4D-3CBD-4A13-9A72-49B1DBC659B0" name="GUID-44CE1B4D-3CBD-4A13-9A72-49B1DBC659B0"></a><h4 id="LNPCC-GUID-44CE1B4D-3CBD-4A13-9A72-49B1DBC659B0" class="sect4"><span class="enumeration_section">16.1.6</span>临时LOB</h4>
                  <div>
                     <p>您可以创建<span class="italic">临时</span> LOB，就像本地变量一样，以帮助您使用数据库LOB。临时LOB不与任何表关联，只能由其创建者访问，具有定位器（访问方式），并在会话结束时删除。
                     </p>
                     <p>临时BFILES不支持。临时LOB仅允许在INSERT，UPDATE或DELETE语句的WHERE子句中作为输入变量（IN值）。它们也被允许作为INSERT语句插入的值或UPDATE语句的SET子句中的值。临时LOB没有来自数据库服务器的事务支持，这意味着您不能对它们执行COMMITS或ROLLBACK。</p>
                     <p>临时LOB定位器可以跨越事务。当服务器异常终止时，以及从数据库SQL操作返回错误时，它们也会被删除。</p>
                  </div>
               </div><a id="LNPCC4202"></a><div class="props_rev_3"><a id="GUID-296D35A7-747A-4E8D-AE60-C49DDA8DA86B" name="GUID-296D35A7-747A-4E8D-AE60-C49DDA8DA86B"></a><h4 id="LNPCC-GUID-296D35A7-747A-4E8D-AE60-C49DDA8DA86B" class="sect4"><span class="enumeration_section">16.1.7</span> LOB缓冲子系统</h4>
                  <div>
                     <p>LBS（LOB缓冲子系统）是用户存储器的一个区域，用作客户端地址空间中一个或多个LOB的缓冲区。</p>
                     <p>缓冲具有这些优点，特别是对于客户端上的应用程序，它对LOB的特定区域执行许多小的读取和写入：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>LBS减少了到服务器的往返次数，因为您通过对LOB进行多次读/写来填充缓冲区，然后在执行FLUSH指令时写入服务器。</p>
                        </li>
                        <li>
                           <p>缓冲还减少了服务器上LOB更新的总数。这可以创建更好的LOB性能并节省磁盘空间。</p>
                        </li>
                     </ul>
                     <p>Oracle提供了一个简单的缓冲子系统不是缓存。Oracle不保证缓冲区的内容始终与服务器LOB值同步。使用FLUSH语句实际在服务器LOB中写入更新。</p>
                     <p>通过其定位器执行LOB的缓冲读/写。启用缓冲的定位器提供LOB的一致读取版本，直到您通过该定位器执行写入。</p>
                     <p>在用于缓冲的WRITE之后，定位器成为更新的定位器，并提供对<span class="italic">通过缓冲子系统看到</span>的最新LOB版本的访问。所有进一步缓冲的写入LOB只能通过此更新的定位器完成。涉及缓冲LOB操作的事务无法跨用户会话进行迁移。
                     </p>
                     <p>LBS由用户管理，用户负责通过使用FLUSH语句更新服务器LOB值。它是单用户和单线程。使用ROLLBACK和SAVEPOINT操作来保证服务器LOB中的正确性。Oracle不保证对缓冲LOB操作的事务支持。要确保缓冲LOB更新的事务语义，必须维护逻辑保存点以在发生错误时执行回滚。</p>
                  </div>
               </div>
            </div><a id="LNPCC4203"></a><div class="props_rev_3"><a id="GUID-1727FAEE-BE2F-44EF-BCCB-7F8C0EE84600" name="GUID-1727FAEE-BE2F-44EF-BCCB-7F8C0EE84600"></a><h3 id="LNPCC-GUID-1727FAEE-BE2F-44EF-BCCB-7F8C0EE84600" class="sect3"><span class="enumeration_section">16.2</span>如何在程序中使用LOB</h3>
               <div>
                  <p>本节介绍与Pro * C / C ++应用程序中LOB的使用相关的一些重要编程问题。</p>
               </div><a id="LNPCC4205"></a><a id="LNPCC4204"></a><div class="props_rev_3"><a id="GUID-48463601-7D88-4168-A89C-FFF7ECB2492E" name="GUID-48463601-7D88-4168-A89C-FFF7ECB2492E"></a><h4 id="LNPCC-GUID-48463601-7D88-4168-A89C-FFF7ECB2492E" class="sect4"><span class="enumeration_section">16.2.1</span>访问LOB的三种方法</h4>
                  <div>
                     <div class="section">
                        <p>在Pro * C / C ++中访问LOB的三种方法是：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>PL / SQL块中的DBMS_LOB包。</p>
                           </li>
                           <li>
                              <p>OCI（Oracle Call Interface）函数调用。</p>
                           </li>
                           <li>
                              <p>嵌入式SQL语句。</p>
                           </li>
                        </ul>
                        <p>SQL语句旨在为用户提供与PL / SQL接口等效的功能，同时避免OCI接口的复杂性。</p>
                        <p>下表比较了Pro * C / C ++中的OCI函数调用，PL / SQL和Pro * C / C ++中嵌入式SQL语句的LOB访问。空框表示缺少功能。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="tblformal" id="GUID-48463601-7D88-4168-A89C-FFF7ECB2492E__GUID-5393F0A3-0B57-46CE-A07B-68910EA04CD7">
                        <p class="titleintable">表16-1 LOB访问方法</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="LOB访问方法" width="100%" border="1" summary="LOB Access Methods" frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="38%" id="d87166e460">OCI（1）</th>
                                 <th align="left" valign="bottom" width="29%" id="d87166e467">PL / SQL（2）</th>
                                 <th align="left" valign="bottom" width="33%" id="d87166e474">Pro * C / C ++嵌入式SQL</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d87166e480" headers="d87166e460 ">
                                    <p>-</p>
                                 </td>
                                 <td align="left" valign="top" width="29%" headers="d87166e480 d87166e467 ">
                                    <p>相比（）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d87166e480 d87166e474 ">
                                    <p>-</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d87166e490" headers="d87166e460 ">
                                    <p>-</p>
                                 </td>
                                 <td align="left" valign="top" width="29%" headers="d87166e490 d87166e467 ">
                                    <p>INSTR（）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d87166e490 d87166e474 ">
                                    <p>-</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d87166e500" headers="d87166e460 ">
                                    <p>-</p>
                                 </td>
                                 <td align="left" valign="top" width="29%" headers="d87166e500 d87166e467 ">
                                    <p>SUBSTR（）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d87166e500 d87166e474 ">
                                    <p>-</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d87166e510" headers="d87166e460 ">
                                    <p>OCILobAppend</p>
                                 </td>
                                 <td align="left" valign="top" width="29%" headers="d87166e510 d87166e467 ">
                                    <p>附加（）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d87166e510 d87166e474 ">
                                    <p>附加</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d87166e520" headers="d87166e460 ">
                                    <p>OCILobAssign</p>
                                 </td>
                                 <td align="left" valign="top" width="29%" headers="d87166e520 d87166e467 ">
                                    <p>：=</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d87166e520 d87166e474 ">
                                    <p>分配</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d87166e530" headers="d87166e460 ">
                                    <p>OCILobCharSetForm</p>
                                 </td>
                                 <td align="left" valign="top" width="29%" headers="d87166e530 d87166e467 ">
                                    <p>-</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d87166e530 d87166e474 ">
                                    <p>-</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d87166e540" headers="d87166e460 ">
                                    <p>OCICharSetId</p>
                                 </td>
                                 <td align="left" valign="top" width="29%" headers="d87166e540 d87166e467 ">
                                    <p>-</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d87166e540 d87166e474 ">
                                    <p>-</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d87166e550" headers="d87166e460 ">
                                    <p>OCILobClose</p>
                                 </td>
                                 <td align="left" valign="top" width="29%" headers="d87166e550 d87166e467 ">
                                    <p>关（）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d87166e550 d87166e474 ">
                                    <p>关</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d87166e560" headers="d87166e460 ">
                                    <p>OCILobCopy</p>
                                 </td>
                                 <td align="left" valign="top" width="29%" headers="d87166e560 d87166e467 ">
                                    <p>复制（）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d87166e560 d87166e474 ">
                                    <p>复制</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d87166e570" headers="d87166e460 ">
                                    <p>OCILobCreateTemporary</p>
                                 </td>
                                 <td align="left" valign="top" width="29%" headers="d87166e570 d87166e467 ">
                                    <p>CREATETEMPORARY（）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d87166e570 d87166e474 ">
                                    <p>创建临时</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d87166e580" headers="d87166e460 ">
                                    <p>OCILobDisableBuffering</p>
                                 </td>
                                 <td align="left" valign="top" width="29%" headers="d87166e580 d87166e467 ">
                                    <p>-</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d87166e580 d87166e474 ">
                                    <p>禁用缓冲</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d87166e591" headers="d87166e460 ">
                                    <p>OCILobEnableBuffering</p>
                                 </td>
                                 <td align="left" valign="top" width="29%" headers="d87166e591 d87166e467 ">
                                    <p>-</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d87166e591 d87166e474 ">
                                    <p>启用缓冲</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d87166e601" headers="d87166e460 ">
                                    <p>OCILobErase</p>
                                 </td>
                                 <td align="left" valign="top" width="29%" headers="d87166e601 d87166e467 ">
                                    <p>ERASE（）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d87166e601 d87166e474 ">
                                    <p>ERASE</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d87166e611" headers="d87166e460 ">
                                    <p>OCILobGetChunkSize</p>
                                 </td>
                                 <td align="left" valign="top" width="29%" headers="d87166e611 d87166e467 ">
                                    <p>GETCHUNKSIZE（）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d87166e611 d87166e474 ">
                                    <p>描述</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d87166e621" headers="d87166e460 ">
                                    <p>OCILobIsOpen</p>
                                 </td>
                                 <td align="left" valign="top" width="29%" headers="d87166e621 d87166e467 ">
                                    <p>开了（）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d87166e621 d87166e474 ">
                                    <p>描述</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d87166e631" headers="d87166e460 ">
                                    <p>OCILobFileClose</p>
                                 </td>
                                 <td align="left" valign="top" width="29%" headers="d87166e631 d87166e467 ">
                                    <p>FILECLOSE（）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d87166e631 d87166e474 ">
                                    <p>关</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d87166e641" headers="d87166e460 ">
                                    <p>OCILobFileCloseAll</p>
                                 </td>
                                 <td align="left" valign="top" width="29%" headers="d87166e641 d87166e467 ">
                                    <p>FILECLOSEALL（）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d87166e641 d87166e474 ">
                                    <p>文件关闭所有</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d87166e651" headers="d87166e460 ">
                                    <p>OCILobFileExists</p>
                                 </td>
                                 <td align="left" valign="top" width="29%" headers="d87166e651 d87166e467 ">
                                    <p>文件已存在（）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d87166e651 d87166e474 ">
                                    <p>描述</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d87166e661" headers="d87166e460 ">
                                    <p>OCILobFileGetName</p>
                                 </td>
                                 <td align="left" valign="top" width="29%" headers="d87166e661 d87166e467 ">
                                    <p>FILEGETNAME（）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d87166e661 d87166e474 ">
                                    <p>描述</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d87166e671" headers="d87166e460 ">
                                    <p>OCILobFileIsOpen</p>
                                 </td>
                                 <td align="left" valign="top" width="29%" headers="d87166e671 d87166e467 ">
                                    <p>FILEISOPEN（）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d87166e671 d87166e474 ">
                                    <p>描述</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d87166e681" headers="d87166e460 ">
                                    <p>OCILobFileOpen</p>
                                 </td>
                                 <td align="left" valign="top" width="29%" headers="d87166e681 d87166e467 ">
                                    <p>FILEOPEN（）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d87166e681 d87166e474 ">
                                    <p>打开</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d87166e691" headers="d87166e460 ">
                                    <p>OCILobFileSetName</p>
                                 </td>
                                 <td align="left" valign="top" width="29%" headers="d87166e691 d87166e467 ">
                                    <p>BFILENAME（）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d87166e691 d87166e474 ">
                                    <p>文件设置<a id="fn_3" name="fn_3" href="#fn_3" the="" bfilename()="" built="" in="" sql="" function="" may="" also="" be="" used=")" ="" onclick="footdisplay(3, "><sup>脚3</sup></a></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d87166e707" headers="d87166e460 ">
                                    <p>OCILobFlushBuffer</p>
                                 </td>
                                 <td align="left" valign="top" width="29%" headers="d87166e707 d87166e467 ">
                                    <p>-</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d87166e707 d87166e474 ">
                                    <p>冲洗缓冲器</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d87166e717" headers="d87166e460 ">
                                    <p>OCILobFreeTemporary</p>
                                 </td>
                                 <td align="left" valign="top" width="29%" headers="d87166e717 d87166e467 ">
                                    <p>FREETEMPORARY（）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d87166e717 d87166e474 ">
                                    <p>免费临时</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d87166e727" headers="d87166e460 ">
                                    <p>OCILobGetLength</p>
                                 </td>
                                 <td align="left" valign="top" width="29%" headers="d87166e727 d87166e467 ">
                                    <p>GETLENGTH（）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d87166e727 d87166e474 ">
                                    <p>描述</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d87166e737" headers="d87166e460 ">
                                    <p>OCILobIsEqual</p>
                                 </td>
                                 <td align="left" valign="top" width="29%" headers="d87166e737 d87166e467 ">
                                    <p>=</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d87166e737 d87166e474 ">
                                    <p>-</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d87166e747" headers="d87166e460 ">
                                    <p>OCILobIsTemporary</p>
                                 </td>
                                 <td align="left" valign="top" width="29%" headers="d87166e747 d87166e467 ">
                                    <p>方法isTemporary（）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d87166e747 d87166e474 ">
                                    <p>描述</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d87166e757" headers="d87166e460 ">
                                    <p>OCILobLoadFromFile</p>
                                 </td>
                                 <td align="left" valign="top" width="29%" headers="d87166e757 d87166e467 ">
                                    <p>LOADFROMFILE（）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d87166e757 d87166e474 ">
                                    <p>从文件中加载</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d87166e767" headers="d87166e460 ">
                                    <p>OCILobLocatorIsInit</p>
                                 </td>
                                 <td align="left" valign="top" width="29%" headers="d87166e767 d87166e467 ">
                                    <p>-</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d87166e767 d87166e474 ">
                                    <p>-</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d87166e777" headers="d87166e460 ">
                                    <p>OCILobOpen</p>
                                 </td>
                                 <td align="left" valign="top" width="29%" headers="d87166e777 d87166e467 ">
                                    <p>打开（）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d87166e777 d87166e474 ">
                                    <p>打开</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d87166e787" headers="d87166e460 ">
                                    <p>OCILobRead</p>
                                 </td>
                                 <td align="left" valign="top" width="29%" headers="d87166e787 d87166e467 ">
                                    <p>读（）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d87166e787 d87166e474 ">
                                    <p>读</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d87166e797" headers="d87166e460 ">
                                    <p>OCILobTrim</p>
                                 </td>
                                 <td align="left" valign="top" width="29%" headers="d87166e797 d87166e467 ">
                                    <p>修剪（）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d87166e797 d87166e474 ">
                                    <p>修剪</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d87166e807" headers="d87166e460 ">
                                    <p>OCILobWrite</p>
                                 </td>
                                 <td align="left" valign="top" width="29%" headers="d87166e807 d87166e467 ">
                                    <p>写（）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d87166e807 d87166e474 ">
                                    <p>写</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d87166e818" headers="d87166e460 ">
                                    <p>OCILobWriteAppend</p>
                                 </td>
                                 <td align="left" valign="top" width="29%" headers="d87166e818 d87166e467 ">
                                    <p>WRITEAPPEND（）</p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d87166e818 d87166e474 ">
                                    <p>写</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p class="tablefootnote"><sup class="tablefootnote">脚注1仅</sup>适用于C / C ++用户。这些函数的原型在ociap.h中。
                     </p>
                     <p class="tablefootnote"><sup class="tablefootnote">脚注2</sup>来自dbmslob.sql。所有例程都以“DBMS_LOB”为前缀。除了BFILENAME。</p>
                     <p class="tablefootnote"><sup class="tablefootnote">脚注3</sup></p><p><span class="bold">也可以使用内置SQL函数的BFILENAME（）。</span></p>
                     <p></p>
                     <div class="section">
                        <div class="infoboxnote" id="GUID-48463601-7D88-4168-A89C-FFF7ECB2492E__GUID-683C1821-D778-4ABD-BFB1-40B86C6327CE">
                           <p class="notep1">注意：</p>
                           <p>在使用以任何方式修改或更改LOB的任何新语句之前，必须显式锁定该行。可以修改LOB值的操作是APPEND，COPY，ERASE，LOAD FROM FILE，TRIM和WRITE。</p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="LNPCC4206"></a><div class="props_rev_3"><a id="GUID-6C8C852C-00EC-474C-A64B-547BA6F31022" name="GUID-6C8C852C-00EC-474C-A64B-547BA6F31022"></a><h4 id="LNPCC-GUID-6C8C852C-00EC-474C-A64B-547BA6F31022" class="sect4"><span class="enumeration_section">16.2.2</span>应用程序中的LOB定位器</h4>
                  <div>
                     <p>要在Pro * C / C ++应用程序中使用LOB定位器，请包含oci.h头文件并声明指向BLOB类型的OCIBlobLocator，CLOB和NCLOB的OCIClobLocator或BFILE的OCIBFileLocator。</p>
                     <p>对于NCLOB，您必须要么</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>在C / C ++声明中使用子句'CHARACTER SET IS NCHAR_CS'，</p>
                        </li>
                        <li>
                           <p>或者，您必须已在命令行或配置文件中使用NLS_CHAR预编译器选项来设置NLS_NCHAR环境变量。</p>
                        </li>
                     </ul>
                     <p>以下是它的完成方式：</p><pre class="oac_no_warn" dir="ltr">/ *在预编译器程序中* / #include &lt;oci.h&gt; ...OCIClobLocator CHARACTER SET是NCHAR_CS * a_nclob;</pre><p>或者，如果您在调用Pro * C / C ++时已经以这种方式设置了预编译器选项NLS_CHAR：</p><pre class="oac_no_warn" dir="ltr">NLS_CHAR =（a_nclob）</pre><p>您可以在代码中省略CHARACTER SET子句：</p><pre class="oac_no_warn" dir="ltr">#include &lt;oci.h&gt; ...OCIClobLocator * a_nclob;</pre><p>其他声明很简单：</p><pre class="oac_no_warn" dir="ltr">/ *在预编译器程序中* / #include &lt;oci.h&gt; ...OCIBlobLocator * a_blob; OCIClobLocator * a_clob; OCIBFileLocator * a_bfile;</pre></div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="precompiler-options.html#GUID-80E4B2B6-C246-4B10-BE90-971CF6FAC15F">NLS_CHAR</a></li>
                        </ul>
                     </div>
                  </div>
                  
               </div><a id="LNPCC4207"></a><div class="props_rev_3"><a id="GUID-51BD3BB2-3407-4AD4-B588-61ECACC75879" name="GUID-51BD3BB2-3407-4AD4-B588-61ECACC75879"></a><h4 id="LNPCC-GUID-51BD3BB2-3407-4AD4-B588-61ECACC75879" class="sect4"><span class="enumeration_section">16.2.3</span>初始化LOB</h4>
                  <div>
                     <p>有不同的技术用于初始化不同类型的LOB。每个都在本节中描述。</p>
                  </div><a id="LNPCC4208"></a><div class="props_rev_3"><a id="GUID-7312A92E-0F90-4436-8C38-8E4B68CB67DD" name="GUID-7312A92E-0F90-4436-8C38-8E4B68CB67DD"></a><h5 id="LNPCC-GUID-7312A92E-0F90-4436-8C38-8E4B68CB67DD" class="sect5"><span class="enumeration_section">16.2.3.1</span>内部LOB</h5>
                     <div>
                        <p>要将BLOB初始化为空，请使用<code class="codeph">EMPTY_BLOB()</code>函数，或使用ALLOCATE SQL语句。对于CLOB和NCLOB，请使用<code class="codeph">EMPTY_CLOB()</code>函数<span class="italic">。</span> 有关<code class="codeph">EMPTY_BLOB()</code>和<code class="codeph">EMPTY_CLOB()</code>更多信息，请参见<a href="../sqlrf/index.html" target="_blank"><span class="italic">Oracle数据库SQL语言参考</span></a> 。
                        </p>
                        <p>这些函数仅在INSERT语句的VALUES子句中或在UPDATE语句中作为SET子句的源允许。</p>
                        <p>例如：</p><pre class="oac_no_warn" dir="ltr">EXEC SQL INSERT INTO lob_table（a_blob，a_clob）VALUES（EMPTY_BLOB（），EMPTY_CLOB（））;</pre><p>ALLOCATE语句分配LOB定位器并将其初始化为空。因此，以下代码等同于前面的示例：</p><pre class="oac_no_warn" dir="ltr">#include &lt;oci.h&gt; ...OCIBlobLocator * blob; OCIClobLocator * clob; EXEC SQL ALLOCATE：blob; EXEC SQL ALLOCATE：clob; EXEC SQL INSERT INTO lob_table（a_blob，a_clob）VALUES（：blob，：clob）;</pre></div>
                  </div><a id="LNPCC4209"></a><div class="props_rev_3"><a id="GUID-1DFA76A4-327B-44F8-BDC7-37035CE6E371" name="GUID-1DFA76A4-327B-44F8-BDC7-37035CE6E371"></a><h5 id="LNPCC-GUID-1DFA76A4-327B-44F8-BDC7-37035CE6E371" class="sect5"><span class="enumeration_section">16.2.3.2</span>外部LOB</h5>
                     <div>
                        <p>使用LOB FILE SET语句以这种方式初始化BFILE和FILENAME的DIRECTORY别名：</p><pre class="oac_no_warn" dir="ltr">#include &lt;oci.h&gt; ...char * alias =“lob_dir”; char * filename =“image.gif”; OCIBFileLocator * bfile; EXEC SQL ALLOCATE：bfile; EXEC SQL LOB FILE SET：bfile DIRECTORY =：alias，FILENAME =：filename; EXEC SQL INSERT INTO file_table（a_bfile）VALUES（：bfile）;</pre><p>有关DIRECTORY对象命名约定和DIRECTORY对象特权的完整说明，请参阅<a href="../adfns/index.html" target="_blank"><span class="italic">Oracle数据库高级应用程序开发人员指南</span></a> 。
                        </p>
                        <p>或者，您可以在INSERT或UPDATE语句中使用BFILENAME（'directory'，'filename'）函数来初始化特定行的BFILE列或属性，并提供实际物理目录和文件名的名称：</p><pre class="oac_no_warn" dir="ltr">EXEC SQL INSERT INTO file_table（a_bfile）VALUES（BFILENAME（'lob_dir'，'image.gif'））RETURNING a_bfile INTO：bfile;</pre><div class="infoboxnote" id="GUID-1DFA76A4-327B-44F8-BDC7-37035CE6E371__GUID-AAE0BE6B-69A0-44F4-BB4C-4F7E7BBAD294">
                           <p class="notep1">注意：</p>
                           <p>BFILENAME（）不检查目录或文件名的权限，或物理目录是否确实存在。使用BFILE定位器的后续文件访问将执行这些检查，并在文件不可访问时返回错误。</p>
                        </div>
                     </div>
                  </div><a id="LNPCC4210"></a><div class="props_rev_3"><a id="GUID-066CAA1C-B941-4A64-9DB0-D2941C257C5E" name="GUID-066CAA1C-B941-4A64-9DB0-D2941C257C5E"></a><h5 id="LNPCC-GUID-066CAA1C-B941-4A64-9DB0-D2941C257C5E" class="sect5"><span class="enumeration_section">16.2.3.3</span>临时LOB</h5>
                     <div>
                        <p>使用嵌入式SQL LOB CREATE TEMPORARY语句首次创建临时LOB时，它将初始化为空。EMPTY_BLOB（）和EMPTY_CLOB（）函数不能与临时LOB一起使用。</p>
                     </div>
                  </div><a id="LNPCC4211"></a><div class="props_rev_3"><a id="GUID-AA70DA28-6882-478D-9C02-73EF502C5E20" name="GUID-AA70DA28-6882-478D-9C02-73EF502C5E20"></a><h5 id="LNPCC-GUID-AA70DA28-6882-478D-9C02-73EF502C5E20" class="sect5"><span class="enumeration_section">16.2.3.4</span>释放LOB</h5>
                     <div>
                        <p>FREE语句用于释放ALLOCATE语句保留的内存：</p><pre class="oac_no_warn" dir="ltr">EXEC SQL FREE：a_blob;</pre></div>
                  </div>
               </div>
            </div><a id="LNPCC4212"></a><div class="props_rev_3"><a id="GUID-B1C0344B-7859-4EE0-BFA0-775590E34184" name="GUID-B1C0344B-7859-4EE0-BFA0-775590E34184"></a><h3 id="LNPCC-GUID-B1C0344B-7859-4EE0-BFA0-775590E34184" class="sect3"><span class="enumeration_section">16.3</span> LOB声明规则</h3>
               <div>
                  <p>以下是使用LOB语句的规则：</p>
               </div><a id="LNPCC4213"></a><div class="props_rev_3"><a id="GUID-F2A45D45-6B23-4DA9-A199-B3B288671B58" name="GUID-F2A45D45-6B23-4DA9-A199-B3B288671B58"></a><h4 id="LNPCC-GUID-F2A45D45-6B23-4DA9-A199-B3B288671B58" class="sect4"><span class="enumeration_section">16.3.1</span>对于所有LOB语句</h4>
                  <div>
                     <p>当使用SQL LOB语句操作LOB时，这些一般限制和限制适用：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>EXEC SQL LOB语句中不允许使用FOR子句，因为在这些语句中只能使用一个LOB定位符。</p>
                        </li>
                        <li>
                           <p>不支持分布式LOB。虽然您可以在任何新的嵌入式SQL LOB语句中使用AT数据库子句，但是不能在同一SQL LOB语句中混合使用不同数据库连接创建的LOB定位符或ALLOCATEd。</p>
                        </li>
                        <li>
                           <p>对于LOB READ和WRITE操作，OCI提供了一种回调机制，客户端可以指定一个回调函数，该函数将在每次读取或写入一段LOB值时执行。嵌入式SQL LOB方法不支持此功能。</p>
                        </li>
                        <li>
                           <p>OCI提供了一种机制，允许用户创建和指定自己的持续时间，可以在创建临时LOB时使用。还有一种机制可以指定缓冲区高速缓存用于临时LOB上的READ和WRITE操作。此接口不支持这些功能。</p>
                        </li>
                     </ul>
                  </div>
               </div><a id="LNPCC4214"></a><div class="props_rev_3"><a id="GUID-2FB2D06E-1C6E-46F7-A111-3C1688DDAFF1" name="GUID-2FB2D06E-1C6E-46F7-A111-3C1688DDAFF1"></a><h4 id="LNPCC-GUID-2FB2D06E-1C6E-46F7-A111-3C1688DDAFF1" class="sect4"><span class="enumeration_section">16.3.2</span>对于LOB缓冲子系统</h4>
                  <div>
                     <p>对于LBS，必须遵循以下规则：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>读取或写入访问中的错误在下次访问服务器时报告。因此，错误恢复必须由您（用户）编码。</p>
                        </li>
                        <li>
                           <p>使用缓冲写入更新LOB时，请勿使用绕过LOB缓冲子系统的方法更新相同的LOB。</p>
                        </li>
                        <li>
                           <p>启用缓冲的更新LOB定位器可以作为IN参数传递给PL / SQL过程，但不能作为IN OUT或OUT参数传递。返回错误，当尝试返回更新的定位符时，也会返回错误。</p>
                        </li>
                        <li>
                           <p>不允许使用<span class="italic">已更新的</span>定位器的ASSIGN来缓冲到另一个定位器。
                           </p>
                        </li>
                        <li>
                           <p>您可以使用缓冲写入附加到LOB值，但起始偏移量必须是LOB结束后的一个字符。 LBS不允许APPEND语句在数据库服务器的LOB中产生零字节填充或空格。</p>
                        </li>
                        <li>
                           <p>主机定位器绑定变量的字符集，数据库服务器CLOB必须相同。</p>
                        </li>
                        <li>
                           <p>只有ASSIGN，READ和WRITE语句才能与启用缓冲的定位器一起使用。</p>
                        </li>
                        <li>
                           <p>与启用缓冲的定位器一起使用时，以下语句会导致错误：APPEND，COPY，ERASE，DESCRIBE（仅限LENGTH）和TRIM。如果将这些语句与未启用缓冲的定位器一起使用，如果定位器指向的LOB正由另一个定位器以缓冲模式访问，则也会返回错误。</p>
                           <div class="infoboxnote" id="GUID-2FB2D06E-1C6E-46F7-A111-3C1688DDAFF1__GUID-82E1064A-843A-4304-BB21-EE10BDAC8EE5">
                              <p class="notep1">注意：</p>
                              <p>必须在之前由LOB缓冲子系统启用的LOB上使用FLUSH语句。</p>
                           </div>
                        </li>
                        <li>
                           <p>提交交易。</p>
                        </li>
                        <li>
                           <p>从当前事务迁移到另一个事务。</p>
                        </li>
                        <li>
                           <p>禁用LOB上的缓冲区操作。</p>
                        </li>
                        <li>
                           <p>从外部过程执行返回到PL / SQL例程。</p>
                           <div class="infoboxnote" id="GUID-2FB2D06E-1C6E-46F7-A111-3C1688DDAFF1__GUID-B2A9EF2D-E253-4823-BE75-AE7E0CA89AF7">
                              <p class="notep1">注意：</p>
                              <p>如果从带有locator参数的PL / SQL块调用外部callout，则所有缓冲（包括ENABLE语句）都应在外部过程中完成。</p>
                           </div>
                        </li>
                     </ul>
                     <p>请遵循以下食谱：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>呼叫外部标注。</p>
                        </li>
                        <li>
                           <p>启用定位器进行缓冲。</p>
                        </li>
                        <li>
                           <p>使用定位器读取或写入。</p>
                        </li>
                        <li>
                           <p>FLUSH LOB（LOB永远不会被隐式刷新）。</p>
                        </li>
                        <li>
                           <p>禁用定位器进行缓冲。</p>
                        </li>
                        <li>
                           <p>返回PL / SQL中的函数/ procedure /方法。</p>
                        </li>
                     </ul>
                     <p>你必须明确地FLUSH一个LOB。</p>
                  </div>
               </div><a id="LNPCC4215"></a><div class="props_rev_3"><a id="GUID-B635DB46-39C8-494A-8B2E-0441B82FB714" name="GUID-B635DB46-39C8-494A-8B2E-0441B82FB714"></a><h4 id="LNPCC-GUID-B635DB46-39C8-494A-8B2E-0441B82FB714" class="sect4"><span class="enumeration_section">16.3.3</span>对于主机变量</h4>
                  <div>
                     <p>对LOB语句使用以下规则和注释：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><span class="italic">src</span>和<span class="italic">dst</span>可以引用内部或外部LOB定位器，但<span class="italic">file</span>仅指外部定位器。
                           </p>
                        </li>
                        <li>
                           <p>数字主机值（ <code class="codeph">amt, src_offset, dst_offset</code>等）声明<code class="codeph">as</code> 4字节无符号整数变量。值限制在0到4千兆字节之间。
                           </p>
                        </li>
                        <li>
                           <p>NULL的概念是LOB定位器的一部分。LOB语句中不需要指示符变量。NULL不能与数值变量（如<code class="codeph">amt, src_offset</code> ，从而导致错误。
                           </p>
                        </li>
                        <li>
                           <p>偏移值<code class="codeph">src_offset</code>和<code class="codeph">dst_offset</code>默认值为1。
                           </p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div><a id="LNPCC03017"></a><div class="props_rev_3"><a id="GUID-6A12C55F-E5A3-41F9-96E8-8F1B7671B1C6" name="GUID-6A12C55F-E5A3-41F9-96E8-8F1B7671B1C6"></a><h3 id="LNPCC-GUID-6A12C55F-E5A3-41F9-96E8-8F1B7671B1C6" class="sect3"><span class="enumeration_section">16.4</span> LOB声明</h3>
               <div>
                  <p>这些陈述按字母顺序排列。在出现的所有语句中， <span class="italic">数据库</span>指的是数据库连接</p>
               </div><a id="LNPCC4217"></a><a id="LNPCC4218"></a><a id="LNPCC4219"></a><a id="LNPCC4220"></a><a id="LNPCC4216"></a><div class="props_rev_3"><a id="GUID-5A29D936-C8E3-45AB-8E4B-DAA265DAFAD0" name="GUID-5A29D936-C8E3-45AB-8E4B-DAA265DAFAD0"></a><h4 id="LNPCC-GUID-5A29D936-C8E3-45AB-8E4B-DAA265DAFAD0" class="sect4"><span class="enumeration_section">16.4.1</span>附录</h4>
                  <div>
                     <div class="section">
                        <p class="subhead3" id="GUID-5A29D936-C8E3-45AB-8E4B-DAA265DAFAD0__GUID-E83199B6-6925-4525-96C5-CE5AEC121C71">目的</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>此语句在另一个LOB的末尾附加一个LOB值。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-5A29D936-C8E3-45AB-8E4B-DAA265DAFAD0__GUID-391BD6C1-0F76-4207-96F4-9AE630FDAD67">句法</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">EXEC SQL [AT [：] <span class="italic">database</span> ] LOB APPEND： <span class="italic">src</span> TO： <span class="italic">dst</span> ;</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-5A29D936-C8E3-45AB-8E4B-DAA265DAFAD0__GUID-D056F0C3-F7E7-4844-8698-85DF93C1E1B3">主机变量</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>src（IN）</p>
                        <p>内部LOB定位器，唯一引用源LOB。</p>
                        <p>dst（IN OUT）</p>
                        <p>唯一引用目标LOB的内部LOB定位器。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-5A29D936-C8E3-45AB-8E4B-DAA265DAFAD0__GUID-10D9ED9C-DB89-4EC1-9117-F53D092F4246">使用说明</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>数据从源LOB复制到目标LOB的末尾，将目标LOB扩展到最大4千兆字节。如果LOB超出4千兆字节，则会发生错误。</p>
                        <p>源和目标LOB必须已存在，并且必须初始化目标LOB。</p>
                        <p>源LOB和目标LOB都必须具有相同的内部LOB类型。为任一类型的定位器启用LOB缓冲是错误的。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="LNPCC4222"></a><a id="LNPCC4223"></a><a id="LNPCC4224"></a><a id="LNPCC4225"></a><a id="LNPCC4221"></a><div class="props_rev_3"><a id="GUID-9969F2E4-4C1A-4882-A152-2D417D80BFF5" name="GUID-9969F2E4-4C1A-4882-A152-2D417D80BFF5"></a><h4 id="LNPCC-GUID-9969F2E4-4C1A-4882-A152-2D417D80BFF5" class="sect4"><span class="enumeration_section">16.4.2</span>分配</h4>
                  <div>
                     <div class="section">
                        <p class="subhead3" id="GUID-9969F2E4-4C1A-4882-A152-2D417D80BFF5__GUID-95D794FE-B0C1-426F-B709-C5DFF359D11B">目的</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>将LOB或BFILE定位器分配给另一个。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-9969F2E4-4C1A-4882-A152-2D417D80BFF5__GUID-3A12CFF3-35E8-4D4C-A7E5-A25539BBC78F">句法</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">EXEC SQL [AT [：] <span class="italic">database</span> ] LOB ASSIGN： <span class="italic">src</span> to： <span class="italic">dst</span> ;</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-9969F2E4-4C1A-4882-A152-2D417D80BFF5__GUID-34F81F9F-0EB1-4A65-984E-185685802F02">主机变量</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>src（IN）</p>
                        <p>从中复制LOB或BFILE定位器源。</p>
                        <p>dst（IN OUT）</p>
                        <p>LOB或BFILE定位器复制到。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-9969F2E4-4C1A-4882-A152-2D417D80BFF5__GUID-ED277499-3419-4E1C-8D4A-92BE894AD76B">使用说明</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>赋值后，两个定位器都引用相同的LOB值。目标LOB定位器必须是有效的初始化（ALLOCATEd）定位器。</p>
                        <p>对于内部LOB，仅当目标定位器存储在表中时，源定位器的LOB值才会复制到目标定位器的LOB值。对于Pro * C / C ++，发出包含目标定位符的对象的FLUSH将复制LOB值。</p>
                        <p>将BFILE定位器分配给内部LOB定位器时会返回错误，反之亦然。如果<span class="italic">src</span>和<span class="italic">dst</span> LOB的类型不同，也是一个错误。
                        </p>
                        <p>如果源定位器用于已启用缓冲的内部LOB，并且源定位器已用于通过LOB缓冲子系统修改LOB值，并且缓冲区自WRITE以来未被FLUSHed，则源定位器不能是分配给目标定位器。这是因为每个LOB只有一个定位器可以通过LOB缓冲子系统修改LOB值。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="LNPCC4227"></a><a id="LNPCC4228"></a><a id="LNPCC4229"></a><a id="LNPCC4230"></a><a id="LNPCC4226"></a><div class="props_rev_3"><a id="GUID-D806C647-01FC-4202-895B-300B19559A4C" name="GUID-D806C647-01FC-4202-895B-300B19559A4C"></a><h4 id="LNPCC-GUID-D806C647-01FC-4202-895B-300B19559A4C" class="sect4"><span class="enumeration_section">16.4.3</span>关闭（对于LOB）</h4>
                  <div>
                     <div class="section">
                        <p class="subhead3" id="GUID-D806C647-01FC-4202-895B-300B19559A4C__GUID-49241115-CC55-4DDE-9B25-71333FE7DB18">目的</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>关闭一个打开的LOB或BFILE。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-D806C647-01FC-4202-895B-300B19559A4C__GUID-6E4AFB36-D0E8-478F-A47E-AD0031DD68FA">句法</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">EXEC SQL [AT [：] <span class="italic">database</span> ] LOB CLOSE： <span class="italic">src;</span></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-D806C647-01FC-4202-895B-300B19559A4C__GUID-91CAC8FB-B8F5-4547-9C71-BFD66FA8D6C2">主机变量</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>src（IN OUT）</p>
                        <p>要关闭的LOB或BFILE的定位器。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-D806C647-01FC-4202-895B-300B19559A4C__GUID-2BF71907-56E7-4140-8F19-B20760EF2EBF">使用说明</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>使用不同的定位器或使用相同的定位器关闭相同的LOB两次是错误的。对于外部LOB，如果BFILE存在但尚未打开，则不会产生错误。</p>
                        <p>在关闭所有先前打开的LOB之前执行COMMIT是一个错误。在事务ROLLBACK时，所有仍处于打开状态的LOB将在不先关闭的情况下被丢弃。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="LNPCC4232"></a><a id="LNPCC4233"></a><a id="LNPCC4234"></a><a id="LNPCC4235"></a><a id="LNPCC4231"></a><div class="props_rev_3"><a id="GUID-501927B6-3DD5-4340-ACE2-EC575FCCC98A" name="GUID-501927B6-3DD5-4340-ACE2-EC575FCCC98A"></a><h4 id="LNPCC-GUID-501927B6-3DD5-4340-ACE2-EC575FCCC98A" class="sect4"><span class="enumeration_section">16.4.4</span>复制</h4>
                  <div>
                     <div class="section">
                        <p class="subhead3" id="GUID-501927B6-3DD5-4340-ACE2-EC575FCCC98A__GUID-41D523FA-5EA4-439F-A59C-8C746F9CDB9E">目的</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>将全部或部分LOB值复制到第二个LOB中。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-501927B6-3DD5-4340-ACE2-EC575FCCC98A__GUID-155191BE-7DF4-4E9F-B79B-09DCF42803B0">句法</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">EXEC SQL [AT [：] <span class="italic">database</span> ] LOB COPY： <span class="italic">amt</span> FROM： <span class="italic">src</span> [AT： <span class="italic">src_offset</span> ] TO： <span class="italic">dst</span> [AT： <span class="italic">dst_offset</span> ];</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-501927B6-3DD5-4340-ACE2-EC575FCCC98A__GUID-99CE78EB-0307-412A-BCF2-02632B436E04">主机变量</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>amt（IN）</p>
                        <p>要复制的BLOB或CLOB和NCLOB的字符的最大字节数。</p>
                        <p>src（IN）</p>
                        <p>源LOB的定位器。</p>
                        <p>src_offset（IN）</p>
                        <p>这是CLOB或NCLOB的字符数，以及BLOB的字节数，从LOB开头的1开始。</p>
                        <p>dst（IN）</p>
                        <p>目标LOB的定位器。</p>
                        <p>dst_offset（IN）</p>
                        <p>目的地偏移量。与src_offset相同的规则。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-501927B6-3DD5-4340-ACE2-EC575FCCC98A__GUID-3676B848-8FA8-4B7B-AC41-1E386118AEF9">使用说明</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>如果数据已经存在于目标的偏移量以及更远的位置，则会被源数据覆盖。如果目标的偏移量超出当前数据的末尾，则从当前数据的末尾到源的新写入数据的开头，将零字节填充符（BLOB）或空格（CLOB）写入目标LOB。</p>
                        <p>如果目标LOB超出目标LOB的当前长度，则扩展目标LOB以容纳新写入的数据。将此LOB扩展到4 GB以上是一个运行时错误。</p>
                        <p>尝试从未初始化的LOB进行复制也是错误的。</p>
                        <p>源LOB和目标LOB都必须属于同一类型。不能为任何一个定位器启用LOB缓冲。</p>
                        <p><code class="codeph">amt</code>变量表示要复制的最大数量。如果在复制指定的数量之前到达源LOB的末尾，则操作将以<code class="codeph">ORA-22993</code>错误终止。
                        </p>
                        <p>要使临时LOB永久化，必须使用COPY语句将临时LOB明确复制为永久LOB。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="LNPCC4237"></a><a id="LNPCC4238"></a><a id="LNPCC4239"></a><a id="LNPCC4240"></a><a id="LNPCC4236"></a><div class="props_rev_3"><a id="GUID-588C9F89-04A6-4C63-9129-6F635D7C1BED" name="GUID-588C9F89-04A6-4C63-9129-6F635D7C1BED"></a><h4 id="LNPCC-GUID-588C9F89-04A6-4C63-9129-6F635D7C1BED" class="sect4"><span class="enumeration_section">16.4.5</span>创建临时</h4>
                  <div>
                     <div class="section">
                        <p class="subhead3" id="GUID-588C9F89-04A6-4C63-9129-6F635D7C1BED__GUID-AC4205DB-803B-43C3-B9C9-106A850638BF">目的</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>创建一个临时LOB。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-588C9F89-04A6-4C63-9129-6F635D7C1BED__GUID-31753095-875C-4691-95E9-DBDB6ABF9568">句法</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">EXEC SQL [AT [：] <span class="italic">database</span> ] LOB CREATE TEMPORARY： <span class="italic">src;</span></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-588C9F89-04A6-4C63-9129-6F635D7C1BED__GUID-C59F63FD-D541-48DD-9E7B-B9577152E917">主机变量</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>src（IN OUT）</p>
                        <p>在执行之前，当IN， <code class="codeph">src</code>是一个LOB定位器之前是ALLOCATEd。</p>
                        <p>执行后，当OUT， <code class="codeph">src</code>是一个LOB定位器，它将指向一个新的空临时LOB。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-588C9F89-04A6-4C63-9129-6F635D7C1BED__GUID-DB9EBD5E-1197-4AD7-A6A4-4048EF826645">使用说明</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>成功执行后，定位器指向新创建的临时LOB，该临时LOB独立于表驻留在数据库服务器上。临时LOB为空，长度为零。</p>
                        <p>在会话结束时，释放所有临时LOB。对临时LOB的READ和WRITE永远不会通过缓冲区缓存。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="LNPCC4242"></a><a id="LNPCC4243"></a><a id="LNPCC4244"></a><a id="LNPCC4245"></a><a id="LNPCC4241"></a><div class="props_rev_3"><a id="GUID-1BEDA56A-5F4F-4F36-9465-1A61CE0F8A21" name="GUID-1BEDA56A-5F4F-4F36-9465-1A61CE0F8A21"></a><h4 id="LNPCC-GUID-1BEDA56A-5F4F-4F36-9465-1A61CE0F8A21" class="sect4"><span class="enumeration_section">16.4.6</span>禁用<span class="enumeration_section">缓冲</span></h4>
                  <div>
                     <div class="section">
                        <p class="subhead3" id="GUID-1BEDA56A-5F4F-4F36-9465-1A61CE0F8A21__GUID-43ADFFAA-C23B-4DAB-8013-08376243CED7">目的</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>禁用LOB定位器的LOB缓冲。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-1BEDA56A-5F4F-4F36-9465-1A61CE0F8A21__GUID-ECC646A2-63EF-4114-BEF1-CD48CD7D6D3E">句法</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">EXEC SQL [AT [：] <span class="italic">database</span> ] LOB DISABLE BUFFERING： <span class="italic">src;</span></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-1BEDA56A-5F4F-4F36-9465-1A61CE0F8A21__GUID-AF3E054B-FF5D-4EA4-A64A-19D67675E2B8">主变量</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>src（IN OUT）</p>
                        <p>内部LOB定位器。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-1BEDA56A-5F4F-4F36-9465-1A61CE0F8A21__GUID-E5EDED99-88FF-4526-8D46-CD8139CB004E">使用说明</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>该语句不支持BFILE。后续的读取或写入不会通过LBS完成。</p>
                        <div class="infoboxnote" id="GUID-1BEDA56A-5F4F-4F36-9465-1A61CE0F8A21__GUID-BDCA0595-25BB-4C42-9001-BBBA6CB5704E">
                           <p class="notep1">注意：</p>
                           <p>使用FLUSH BUFFER命令永久更改，因为此语句不会隐式刷新LOB缓冲子系统中所做的更改。</p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="LNPCC4247"></a><a id="LNPCC4248"></a><a id="LNPCC4249"></a><a id="LNPCC4250"></a><a id="LNPCC4246"></a><div class="props_rev_3"><a id="GUID-D761EC52-AB7B-445E-9B5C-0188BEC8E5DD" name="GUID-D761EC52-AB7B-445E-9B5C-0188BEC8E5DD"></a><h4 id="LNPCC-GUID-D761EC52-AB7B-445E-9B5C-0188BEC8E5DD" class="sect4"><span class="enumeration_section">16.4.7</span>启用缓冲</h4>
                  <div>
                     <div class="section">
                        <p class="subhead3" id="GUID-D761EC52-AB7B-445E-9B5C-0188BEC8E5DD__GUID-1E452EE2-40C3-4769-9F29-EB1886B5E806">目的</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>为LOB定位器启用LOB缓冲。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-D761EC52-AB7B-445E-9B5C-0188BEC8E5DD__GUID-A5A7F680-F562-49CE-ADAA-253AF175C5E4">句法</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">EXEC SQL [AT [：] <span class="italic">database</span> ] LOB ENABLE BUFFERING： <span class="italic">src;</span></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-D761EC52-AB7B-445E-9B5C-0188BEC8E5DD__GUID-D6FD95C8-5532-49E2-9ACF-9AAFD1284C5D">主变量</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>src（IN OUT）</p>
                        <p>内部LOB定位器。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-D761EC52-AB7B-445E-9B5C-0188BEC8E5DD__GUID-1FF2A8AC-4C06-4FCA-AA61-02F92E1E705F">使用说明</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>该语句不支持BFILE。随后的读取和写入通过LBS完成。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="LNPCC4252"></a><a id="LNPCC4253"></a><a id="LNPCC4254"></a><a id="LNPCC4255"></a><a id="LNPCC4251"></a><div class="props_rev_3"><a id="GUID-BFFB09CA-539F-4909-8E23-8EEE129F95CA" name="GUID-BFFB09CA-539F-4909-8E23-8EEE129F95CA"></a><h4 id="LNPCC-GUID-BFFB09CA-539F-4909-8E23-8EEE129F95CA" class="sect4"><span class="enumeration_section">16.4.8</span>删除</h4>
                  <div>
                     <div class="section">
                        <p class="subhead3" id="GUID-BFFB09CA-539F-4909-8E23-8EEE129F95CA__GUID-0B21274F-CC23-4793-8115-195F8ADD4EA0">目的</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>从给定的偏移量开始擦除给定数量的LOB数据。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-BFFB09CA-539F-4909-8E23-8EEE129F95CA__GUID-2E8DC19C-E621-4B5F-892C-DE84F5E88485">句法</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">EXEC SQL [AT [：] <span class="italic">database</span> ] LOB ERASE： <span class="italic">amt</span> FROM： <span class="italic">src</span> [AT： <span class="italic">src_offset</span> ];</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-BFFB09CA-539F-4909-8E23-8EEE129F95CA__GUID-1EF2B6A2-B205-4D5F-B0F6-F599D8A92959">主机变量</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>amt（IN OUT）</p>
                        <p>输入是要擦除的字节数或字符数。返回的输出是擦除的实际数字。</p>
                        <p>src（IN OUT）</p>
                        <p>内部LOB定位器。</p>
                        <p>src_offset（IN）</p>
                        <p>从LOB开始的偏移量，从1开始。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-BFFB09CA-539F-4909-8E23-8EEE129F95CA__GUID-55D8A2A9-91B9-44B0-8720-9CA224F75425">使用说明</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>该语句不支持BFILE。</p>
                        <p>执行后， <code class="codeph">amt</code>返回已擦除的实际字符数/字节数。如果在擦除所请求的字符/字节数之前达到LOB值的末尾，则实际数量和请求的数量将不同。如果LOB是空的， <code class="codeph">amt</code>将表明，0个字符/字节都被擦除。
                        </p>
                        <p>对于BLOB，擦除意味着零字节填充程序覆盖现有的LOB值。对于CLOB，擦除意味着空格会覆盖现有的LOB值。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="LNPCC4257"></a><a id="LNPCC4258"></a><a id="LNPCC4259"></a><a id="LNPCC4256"></a><div class="props_rev_3"><a id="GUID-662AB254-7CFE-46D5-B93E-DF1C72E41ACD" name="GUID-662AB254-7CFE-46D5-B93E-DF1C72E41ACD"></a><h4 id="LNPCC-GUID-662AB254-7CFE-46D5-B93E-DF1C72E41ACD" class="sect4"><span class="enumeration_section">16.4.9</span>文件关闭全部</h4>
                  <div>
                     <div class="section">
                        <p class="subhead3" id="GUID-662AB254-7CFE-46D5-B93E-DF1C72E41ACD__GUID-499FFBB8-C005-43E5-9B1A-4DB57A5080E3">目的</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>关闭当前会话中打开的所有BFILES。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-662AB254-7CFE-46D5-B93E-DF1C72E41ACD__GUID-B12C4AC6-3988-4E7F-8617-40B47A98C046">句法</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">EXEC SQL [AT [：] <span class="italic">database</span> ] LOB FILE CLOSE ALL;</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-662AB254-7CFE-46D5-B93E-DF1C72E41ACD__GUID-9DEB6087-0319-4204-BAC8-E23A6B887A00">使用说明</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>如果会话中的任何打开文件的闭包未得到正确处理，则可以使用FILE CLOSE ALL语句关闭会话中打开的所有文件，并从头开始恢复文件操作。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="LNPCC4261"></a><a id="LNPCC4262"></a><a id="LNPCC4263"></a><a id="LNPCC4264"></a><a id="LNPCC4260"></a><div class="props_rev_3"><a id="GUID-1F2E0067-F94A-4D5A-92E6-7D4B6255C501" name="GUID-1F2E0067-F94A-4D5A-92E6-7D4B6255C501"></a><h4 id="LNPCC-GUID-1F2E0067-F94A-4D5A-92E6-7D4B6255C501" class="sect4"><span class="enumeration_section">16.4.10</span>文件集</h4>
                  <div>
                     <div class="section">
                        <p class="subhead3" id="GUID-1F2E0067-F94A-4D5A-92E6-7D4B6255C501__GUID-7D34C548-75E4-4115-B38B-319F0ABAA66C">目的</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>在BFILE定位器中设置DIRECTORY别名和FILENAME。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-1F2E0067-F94A-4D5A-92E6-7D4B6255C501__GUID-6F6D82A5-B02B-4ACA-9EAB-C6A3E8CEABA1">句法</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">EXEC SQL [AT [：] <span class="italic">database</span> ] LOB FILE SET： <span class="italic">file</span> DIRECTORY =： <span class="italic">alias</span> ，FILENAME =： <span class="italic">filename;</span></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-1F2E0067-F94A-4D5A-92E6-7D4B6255C501__GUID-1601547F-3556-4175-B4D5-6B870E931F57">主机变量</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>文件（IN OUT）</p>
                        <p>BFILE定位器，其中设置了DIRECTORY别名和FILENAME。</p>
                        <p>别名（IN）</p>
                        <p>要设置的DIRECTORY别名。</p>
                        <p>文件名（IN）</p>
                        <p>要设置的FILENAME。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-1F2E0067-F94A-4D5A-92E6-7D4B6255C501__GUID-0CE15AAD-B757-4B02-A6F2-DDAA4ACB7092">使用说明</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>给定的BFILE定位器在此语句中使用之前必须首先进行ALLOCATEd。</p>
                        <p>必须提供DIRECTORY别名和FILENAME。</p>
                        <p>DIRECTORY别名的最大长度为128个字节。FILENAME的最大长度为255个字节。</p>
                        <p>支持与DIRECTORY别名和FILENAME属性一起使用的唯一外部数据类型是CHARZ，STRING，VARCHAR，VARCHAR2和CHARF。</p>
                        <p>将此语句与除外部LOB定位符之外的任何内容一起使用是错误的。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="LNPCC4266"></a><a id="LNPCC4267"></a><a id="LNPCC4268"></a><a id="LNPCC4269"></a><a id="LNPCC4265"></a><div class="props_rev_3"><a id="GUID-1E57E226-9AE7-4326-97BD-37F0405CFA1F" name="GUID-1E57E226-9AE7-4326-97BD-37F0405CFA1F"></a><h4 id="LNPCC-GUID-1E57E226-9AE7-4326-97BD-37F0405CFA1F" class="sect4"><span class="enumeration_section">16.4.11</span>冲洗缓冲器</h4>
                  <div>
                     <div class="section">
                        <p class="subhead3" id="GUID-1E57E226-9AE7-4326-97BD-37F0405CFA1F__GUID-A52A09D6-B319-412C-8C89-3C1A4ED46338">目的</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>将此LOB的缓冲区写入数据库服务器。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-1E57E226-9AE7-4326-97BD-37F0405CFA1F__GUID-48C1BD05-F78E-42F4-81ED-0E0096007BD4">句法</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">EXEC SQL [AT [：] <span class="italic">database</span> ] LOB FLUSH BUFFER： <span class="italic">src</span> [FREE];</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-1E57E226-9AE7-4326-97BD-37F0405CFA1F__GUID-6656BB45-B824-43CB-A8D2-038339B131B4">主机变量</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>src（IN OUT）</p>
                        <p>内部LOB定位器。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-1E57E226-9AE7-4326-97BD-37F0405CFA1F__GUID-DDCA7D01-2363-4B1C-A472-A2737BA24F48">使用说明</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>将缓冲区数据从输入定位器引用的LOB写入服务器中的数据库LOB。</p>
                        <p>必须已为输入LOB定位器启用LOB缓冲。</p>
                        <p>默认情况下，FLUSH操作不会释放缓冲区资源以重新分配到另一个缓冲的LOB操作。但是，如果要显式释放缓冲区，可以包含可选的FREE关键字以表示。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="LNPCC4271"></a><a id="LNPCC4272"></a><a id="LNPCC4273"></a><a id="LNPCC4274"></a><a id="LNPCC4270"></a><div class="props_rev_3"><a id="GUID-9332F672-F4AB-4A05-A9F9-8C38E3B122D6" name="GUID-9332F672-F4AB-4A05-A9F9-8C38E3B122D6"></a><h4 id="LNPCC-GUID-9332F672-F4AB-4A05-A9F9-8C38E3B122D6" class="sect4"><span class="enumeration_section">16.4.12</span>免费临时</h4>
                  <div>
                     <div class="section">
                        <p class="subhead3" id="GUID-9332F672-F4AB-4A05-A9F9-8C38E3B122D6__GUID-41597369-65FB-4FF1-95D5-B0D7A827D8B0">目的</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>释放LOB定位器的临时空间。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-9332F672-F4AB-4A05-A9F9-8C38E3B122D6__GUID-3B7AC1E5-3420-4DC6-BF6D-A4210581B2AF">句法</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">EXEC SQL [AT [：] <span class="italic">database</span> ] LOB FREE TEMPORARY： <span class="italic">src;</span></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-9332F672-F4AB-4A05-A9F9-8C38E3B122D6__GUID-9FC4BF0F-E9BB-4CEE-8ABA-79B8DD4A8721">主变量</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>src（IN OUT）</p>
                        <p>LOB定位器指向临时LOB。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-9332F672-F4AB-4A05-A9F9-8C38E3B122D6__GUID-550F35DF-7911-48C6-BB62-BEFDDB1AB673">使用说明</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>输入定位器必须指向临时LOB。输出定位器标记为未初始化，可以在后续LOB语句中使用。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="LNPCC4276"></a><a id="LNPCC4277"></a><a id="LNPCC4278"></a><a id="LNPCC4279"></a><a id="LNPCC4275"></a><div class="props_rev_3"><a id="GUID-885516E0-21AD-4A5F-A479-AEF5391B86E1" name="GUID-885516E0-21AD-4A5F-A479-AEF5391B86E1"></a><h4 id="LNPCC-GUID-885516E0-21AD-4A5F-A479-AEF5391B86E1" class="sect4"><span class="enumeration_section">16.4.13</span>从文件加载</h4>
                  <div>
                     <div class="section">
                        <p class="subhead3" id="GUID-885516E0-21AD-4A5F-A479-AEF5391B86E1__GUID-FFB1FCD8-FDC3-49C2-B15E-2FEC5F7C9D54">目的</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>将全部或部分BFILE复制到内部LOB中。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-885516E0-21AD-4A5F-A479-AEF5391B86E1__GUID-0B4610D2-72B3-4537-A05F-F8A6687E482F">句法</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">EXEC SQL [AT [：] <span class="italic">database</span> ] LOB LOAD： <span class="italic">amt</span> FROM FILE： <span class="italic">file</span> [AT： <span class="italic">src_offset</span> ] INTO： <span class="italic">dst</span> [AT： <span class="italic">dst_offset</span> ];</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-885516E0-21AD-4A5F-A479-AEF5391B86E1__GUID-5606ACE1-5D71-409B-9CB2-16A144FCB5B7">主机变量</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>amt（IN）</p>
                        <p>要加载的最大字节数。</p>
                        <p>文件（IN OUT）</p>
                        <p>源BFILE定位器。</p>
                        <p>src_offset（IN）</p>
                        <p>从文件开头偏移的字节数，从1开始。</p>
                        <p>dst（IN OUT）</p>
                        <p>目标LOB定位器，可以是BLOB，CLOB，是NCLOB。</p>
                        <p>dst_offset（IN）</p>
                        <p>从写入开始的目标LOB开始的字节数（对于BLOB）或字符（CLOB和NCLOB）。它从1开始。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-885516E0-21AD-4A5F-A479-AEF5391B86E1__GUID-19DC6580-0401-40F4-88ED-3D1650A725A1">使用说明</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>数据从源BFILE复制到目标内部LOB。将BFILE数据复制到CLOB或NCLOB时，不执行字符集转换。因此，BFILE数据必须已与数据库中的CLOB或NCLOB位于相同的字符集中。</p>
                        <p>源和目标LOB必须已存在。如果数据已存在于目的地的起始位置，则会被源数据覆盖。如果目标的起始位置超出当前数据的末尾，则将零字节填充符（BLOB）或空格（CLOB和NCLOB）写入目标LOB。填充程序从数据末尾写入目标LOB，直到从源写入新数据的开头。</p>
                        <p>如果目标LOB超出目标LOB的当前长度，则扩展目标LOB以容纳新写入的数据。将此LOB扩展到4千兆字节是错误的。</p>
                        <p>从未初始化的BFILE复制也是错误的。</p>
                        <p>amount参数表示要加载的最大数量。如果在加载指定数量之前到达源BFILE的末尾，则操作将以<code class="codeph">ORA-22993</code>错误终止。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="LNPCC4281"></a><a id="LNPCC4282"></a><a id="LNPCC4283"></a><a id="LNPCC4284"></a><a id="LNPCC4280"></a><div class="props_rev_3"><a id="GUID-4B1BEEEF-9BBF-40A6-A296-254CA63E41FF" name="GUID-4B1BEEEF-9BBF-40A6-A296-254CA63E41FF"></a><h4 id="LNPCC-GUID-4B1BEEEF-9BBF-40A6-A296-254CA63E41FF" class="sect4"><span class="enumeration_section">16.4.14</span> OPEN（对于LOB）</h4>
                  <div>
                     <div class="section">
                        <p class="subhead3" id="GUID-4B1BEEEF-9BBF-40A6-A296-254CA63E41FF__GUID-56C23C85-37F7-4D8C-8015-77C4795A975D">目的</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>打开LOB或BFILE以进行读取或读/写访问。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-4B1BEEEF-9BBF-40A6-A296-254CA63E41FF__GUID-FB487AFC-7432-4DAA-A1D6-F73FC2DCC512">句法</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">EXEC SQL [AT [：] <span class="italic">database</span> ] LOB OPEN： <span class="italic">src</span> [READ ONLY | READ WRITE];</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-4B1BEEEF-9BBF-40A6-A296-254CA63E41FF__GUID-3CA4C58A-4E2D-4B63-92B1-479D5A99DCC5">主机变量</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>src（IN OUT）</p>
                        <p>LOB或BFILE的LOB定位器。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-4B1BEEEF-9BBF-40A6-A296-254CA63E41FF__GUID-4D52638E-E9F6-4EAF-A9FD-1B12E7CCFF26">使用说明</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>可以打开LOB或BFILE的默认模式是READ ONLY访问。</p>
                        <p>对于内部LOB，OPEN与LOB相关联，而不是定位器。将已打开的定位器分配给另一个定位器不会计为打开新的LOB。相反，两个定位器都引用相同的LOB。对于BFILE，OPEN与定位器相关联。</p>
                        <p>任何时候都只能打开32个LOB。第33个LOB打开时将返回错误。</p>
                        <p>不支持可写BFILE。因此，当您在READ WRITE模式下打开BFILE时，将返回错误。</p>
                        <p>在READ ONLY模式下打开LOB然后尝试写入LOB也是错误的。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="LNPCC4285"></a><a id="LNPCC4286"></a><a id="LNPCC4287"></a><a id="LNPCC4288"></a><a id="LNPCC4289"></a><a id="LNPCC03018"></a><div class="props_rev_3"><a id="GUID-476D22DC-B4E6-4A71-A891-75B3765B01BC" name="GUID-476D22DC-B4E6-4A71-A891-75B3765B01BC"></a><h4 id="LNPCC-GUID-476D22DC-B4E6-4A71-A891-75B3765B01BC" class="sect4"><span class="enumeration_section">16.4.15</span>阅读</h4>
                  <div>
                     <div class="section">
                        <p class="subhead3" id="GUID-476D22DC-B4E6-4A71-A891-75B3765B01BC__GUID-C7DE5ED3-3683-4D83-9C62-2C6899DFEDFC">目的</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>将全部或部分LOB或BFILE读入缓冲区。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-476D22DC-B4E6-4A71-A891-75B3765B01BC__GUID-32B2121A-2F46-4C65-8915-6EE42DF07B82">句法</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">EXEC SQL [AT [：] <span class="italic">database</span> ] LOB READ：amt FROM： <span class="italic">src</span> [AT： <span class="italic">src_offset</span> ] INTO： <span class="italic">buffer</span> [WITH LENGTH： <span class="italic">buflen</span> ];</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-476D22DC-B4E6-4A71-A891-75B3765B01BC__GUID-7278CC09-0D55-41E0-87BE-2296BC3D1EBC">主机变量</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>amt（IN OUT）</p>
                        <p>输入是要读取的字符数或字节数。输出是读取的实际字符数或字节数。</p>
                        <p>如果要读取的字节数大于缓冲区长度，则假定LOB在轮询模式下处于READ状态。在输入时，如果该值为0，则将以轮询模式从输入偏移量读取数据，直到LOB结束。</p>
                        <p>实际读取的字节数或字符数以<code class="codeph">amt.</code>形式返回<code class="codeph">amt.</code> 如果数据是以片段形式读取的，则<code class="codeph">amt</code>将始终包含最后一页读取的长度。
                        </p>
                        <p>当到达LOB的末尾时， <code class="codeph">ORA-1403: no data found</code>错误。
                        </p>
                        <p>在轮询模式下读取时，应用程序必须重复调用LOB READ以读取更多LOB片段，直到不再有数据为止。使用WHENEVER指令中的NOT FOUND条件控制轮询模式的使用，以捕获<code class="codeph">ORA-1403</code>错误。
                        </p>
                        <p>src（IN）</p>
                        <p>LOB或BFILE定位器。</p>
                        <p>src_offset（IN）</p>
                        <p>这是从LOB值的开头到开始读取的绝对偏移量。对于字符LOB，它是从LOB开始的字符数。对于二进制LOB或BFILE，它是字节数。第一个位置是1。</p>
                        <p>缓冲区（IN / OUT）</p>
                        <p>一个缓冲区，LOB数据将被读入其中。缓冲区的外部数据类型仅限于几种类型，具体取决于源LOB的类型。缓冲区的最大长度取决于用于存储LOB值的外部数据类型。下表总结了合法的外部数据类型及其按源LOB类型分类的相应最大长度：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="tblformal" id="GUID-476D22DC-B4E6-4A71-A891-75B3765B01BC__GUID-AD3F6363-0764-4565-92EE-F467094C4A96">
                        <p class="titleintable">表16-2源LOB和预编译器数据类型</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="源LOB和预编译器数据类型" width="100%" border="1" summary="Source LOB and Precompiler Datatypes" frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="13%" id="d87166e2482">外部LOB（4）</th>
                                 <th align="left" valign="bottom" width="15%" id="d87166e2489">内部LOB</th>
                                 <th align="left" valign="bottom" width="23%" id="d87166e2493">预编译器外部数据类型</th>
                                 <th align="left" valign="bottom" width="18%" id="d87166e2497">预编译器最大长度（5）</th>
                                 <th align="left" valign="bottom" width="18%" id="d87166e2504">PL / SQL数据类型</th>
                                 <th align="left" valign="bottom" width="15%" id="d87166e2507">PL / SQL最大长度</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="13%" id="d87166e2512" headers="d87166e2482 ">
                                    <p></p>
                                    <p></p>
                                    <p></p>
                                    <p>BFILE</p>
                                 </td>
                                 <td align="left" valign="top" width="15%" headers="d87166e2512 d87166e2489 ">
                                    <p>BLOB</p>
                                 </td>
                                 <td align="left" valign="top" width="23%" headers="d87166e2512 d87166e2493 ">
                                    <p>生的</p>
                                    <p>VARRAW</p>
                                    <p>LONG RAW</p>
                                    <p>LONG VARRAW</p>
                                 </td>
                                 <td align="left" valign="top" width="18%" headers="d87166e2512 d87166e2497 ">
                                    <p>65535</p>
                                    <p>65533</p>
                                    <p>2147483647</p>
                                    <p>2147483643</p>
                                 </td>
                                 <td align="left" valign="top" width="18%" headers="d87166e2512 d87166e2504 ">
                                    <p>生的</p>
                                 </td>
                                 <td align="left" valign="top" width="15%" headers="d87166e2512 d87166e2507 ">
                                    <p>32767</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="13%" id="d87166e2546" headers="d87166e2482 ">
                                    <p>BFILE</p>
                                 </td>
                                 <td align="left" valign="top" width="15%" headers="d87166e2546 d87166e2489 ">
                                    <p>CLOB</p>
                                 </td>
                                 <td align="left" valign="top" width="23%" headers="d87166e2546 d87166e2493 ">
                                    <p>VARCHAR2</p>
                                    <p>VARCHAR</p>
                                    <p>LONG VARCHAR</p>
                                 </td>
                                 <td align="left" valign="top" width="18%" headers="d87166e2546 d87166e2497 ">
                                    <p>65535</p>
                                    <p>65533</p>
                                    <p>2147483643</p>
                                 </td>
                                 <td align="left" valign="top" width="18%" headers="d87166e2546 d87166e2504 ">
                                    <p>VARCHAR2</p>
                                 </td>
                                 <td align="left" valign="top" width="15%" headers="d87166e2546 d87166e2507 ">
                                    <p>32767</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="13%" id="d87166e2573" headers="d87166e2482 ">
                                    <p>BFILE</p>
                                 </td>
                                 <td align="left" valign="top" width="15%" headers="d87166e2573 d87166e2489 ">
                                    <p>NCLOB</p>
                                 </td>
                                 <td align="left" valign="top" width="23%" headers="d87166e2573 d87166e2493 ">
                                    <p>NVARCHAR2</p>
                                 </td>
                                 <td align="left" valign="top" width="18%" headers="d87166e2573 d87166e2497 ">
                                    <p>4000</p>
                                 </td>
                                 <td align="left" valign="top" width="18%" headers="d87166e2573 d87166e2504 ">
                                    <p>NVARCHAR2</p>
                                 </td>
                                 <td align="left" valign="top" width="15%" headers="d87166e2573 d87166e2507 ">
                                    <p>4000</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p class="tablefootnote"><sup class="tablefootnote">脚注4显示的</sup>任何外部数据类型都可以与BFILES一起使用。</p>
                     <p class="tablefootnote"><sup class="tablefootnote">脚注5</sup>长度以字节为单位，而不是字符。
                     </p>
                     <div class="section">
                        <p>buflen（IN）</p>
                        <p>指定给定缓冲区的长度，否则无法确定。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-476D22DC-B4E6-4A71-A891-75B3765B01BC__GUID-495169DF-574F-4F91-97A1-CE01736E8C36">使用说明</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>BFILE必须已存在于数据库服务器上，并且必须已使用输入定位器打开它。数据库必须具有读取文件的权限，并且您（用户）必须具有该目录的读取权限。</p>
                        <p>尝试从未初始化的LOB或BFILE读取是错误的。</p>
                        <p>缓冲区的长度以这种方式确定：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>从<code class="codeph">buflen</code> ，当出现WITH LENGTH子句时。
                              </p>
                           </li>
                           <li>
                              <p>在没有WITH LENGTH子句的情况下，通过在OUT模式下处理缓冲区主变量来确定长度。</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="datatypes-and-host-variables.html#GUID-2CCB3206-DE6F-4C67-B44E-83BB14C09BF3">全球化支持</a></li>
                           <li><a href="about-LOBs.html#GUID-53930ECD-FAD0-447B-BAC3-DAAC3BFF645C">阅读BLOB，编写文件示例</a></li>
                        </ul>
                     </div>
                  </div>
                  
               </div><a id="LNPCC4291"></a><a id="LNPCC4292"></a><a id="LNPCC4293"></a><a id="LNPCC4294"></a><a id="LNPCC4290"></a><div class="props_rev_3"><a id="GUID-752305E8-8C5C-44FB-8881-1B962D15B05A" name="GUID-752305E8-8C5C-44FB-8881-1B962D15B05A"></a><h4 id="LNPCC-GUID-752305E8-8C5C-44FB-8881-1B962D15B05A" class="sect4"><span class="enumeration_section">16.4.16</span> TRIM</h4>
                  <div>
                     <div class="section">
                        <p class="subhead3" id="GUID-752305E8-8C5C-44FB-8881-1B962D15B05A__GUID-FBC45873-46F6-4259-B559-E852CB2AB3AD">目的</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>截断LOB值。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-752305E8-8C5C-44FB-8881-1B962D15B05A__GUID-528AD95D-8632-474B-89DC-AC7C424B755B">句法</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">EXEC SQL [AT [：] <span class="italic">database</span> ] LOB TRIM： <span class="italic">src</span> TO： <span class="italic">newlen;</span></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-752305E8-8C5C-44FB-8881-1B962D15B05A__GUID-6011EAAC-49E1-4F64-8988-23B5E7F50B16">主机变量</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>src（IN OUT）</p>
                        <p>内部LOB的LOB定位器。</p>
                        <p>纽伦（印第安纳州）</p>
                        <p>LOB值的新长度。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-752305E8-8C5C-44FB-8881-1B962D15B05A__GUID-4DCFC451-C495-45B2-BBA4-2AD4DED702A5">使用说明</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>本声明不适用于BFILES。新长度不能大于当前长度，否则返回错误。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="LNPCC4296"></a><a id="LNPCC4297"></a><a id="LNPCC4298"></a><a id="LNPCC4299"></a><a id="LNPCC4295"></a><div class="props_rev_3"><a id="GUID-0A3ADF87-1F21-4D32-8EBF-1B3180C9BB37" name="GUID-0A3ADF87-1F21-4D32-8EBF-1B3180C9BB37"></a><h4 id="LNPCC-GUID-0A3ADF87-1F21-4D32-8EBF-1B3180C9BB37" class="sect4"><span class="enumeration_section">16.4.17</span>写</h4>
                  <div>
                     <div class="section">
                        <p class="subhead3" id="GUID-0A3ADF87-1F21-4D32-8EBF-1B3180C9BB37__GUID-2D6159F6-0E3E-4938-80C8-055FD2073CF4">目的</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>将缓冲区的内容写入LOB。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-0A3ADF87-1F21-4D32-8EBF-1B3180C9BB37__GUID-1469F802-3BAA-49D6-875D-AC4DB15A0D96">句法</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">EXEC SQL [AT [：] <span class="italic">database</span> ] LOB WRITE [APPEND] [FIRST |下一步|最后| ONE]： <span class="italic">amt</span> FROM： <span class="italic">buffer</span> [WITH LENGTH： <span class="italic">buflen</span> ] INTO： <span class="italic">dst</span> [AT： <span class="italic">dst_offset</span> ];</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-0A3ADF87-1F21-4D32-8EBF-1B3180C9BB37__GUID-3AD3311D-80A7-4802-AFBB-ED1D90B4B749">主机变量</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <dl>
                           <dt class="dlterm"><a name="GUID-0A3ADF87-1F21-4D32-8EBF-1B3180C9BB37__GUID-D6E89B7F-6BC1-4768-B622-8ACFB8EFAB70"><!-- --></a> amt（IN OUT）</dt>
                           <dd>
                              <p>输入是要写入的字符数或字节数。</p>
                              <p>输出是写入的实际字符数或字节数。</p>
                              <p>使用轮询方法写入时， <code class="codeph">amt</code>将返回执行WRITE LAST后为执行WRITE语句而写入的累计总长度。如果WRITE语句被中断，则<code class="codeph">amt</code>将是未定义的。
                              </p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-0A3ADF87-1F21-4D32-8EBF-1B3180C9BB37__GUID-3FB301EF-949C-49B2-87DF-FF47709D92C5"><!-- --></a>缓冲区（IN）</dt>
                           <dd>
                              <p>用于写入LOB数据的缓冲区。</p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-0A3ADF87-1F21-4D32-8EBF-1B3180C9BB37__GUID-6D85494D-B7BA-495F-9FB6-116195E5DB8D"><!-- --></a> dst（IN OUT）</dt>
                           <dd>
                              <p>LOB定位器。</p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-0A3ADF87-1F21-4D32-8EBF-1B3180C9BB37__GUID-C59C0076-E723-4052-8D57-F4F7F3F40E53"><!-- --></a> dst_offset（IN）</dt>
                           <dd>
                              <p>从LOB开头（从1开始计算）的偏移量，以CLOB和NCLOB的字符为单位，以BLOB为单位。</p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-0A3ADF87-1F21-4D32-8EBF-1B3180C9BB37__GUID-C7FAD585-2618-4024-B5FC-BE19FC383778"><!-- --></a> buflen（IN）</dt>
                           <dd>
                              <p>无法以任何其他方式计算的缓冲区长度。</p>
                           </dd>
                        </dl>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-0A3ADF87-1F21-4D32-8EBF-1B3180C9BB37__GUID-3E179C40-BE4C-4389-89D1-9F3A0269F15E">使用说明</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>如果LOB数据已存在，则会被存储在缓冲区中的数据覆盖。如果指定的偏移量超出了当前LOB中数据的末尾，则将零字节填充符或空格插入到LOB中。</p>
                        <p>在WRITE语句中指定关键字APPEND会导致数据自动写入LOB的末尾。指定APPEND时，假定目标偏移量是LOB的结尾。在WRITE语句中使用APPEND选项时指定目标偏移量是错误的。</p>
                        <p>缓冲区可以整体写入LOB（使用默认的ONE方向），也可以使用标准轮询方法逐段提供。</p>
                        <p>通过使用FIRST开始轮询，然后使用NEXT编写后续部分。LAST关键字用于写入终止写入的最终部分。</p>
                        <p>使用这种分段写入模式，如果片段具有不同的大小和不同的位置，则缓冲区和长度在每次调用中可以是不同的。</p>
                        <p>如果传递给Oracle的数据总量小于执行所有写入后<code class="codeph">amt</code>参数指定的数量，则会产生错误。
                        </p>
                        <p>相同的规则适用于确定缓冲区长度，如READ语句中所示。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="about-LOBs.html#GUID-476D22DC-B4E6-4A71-A891-75B3765B01BC">读</a></li>
                           <li><a href="about-LOBs.html#GUID-53930ECD-FAD0-447B-BAC3-DAAC3BFF645C">阅读BLOB，编写文件示例</a></li>
                        </ul>
                     </div>
                  </div>
                  
               </div><a id="LNPCC4301"></a><a id="LNPCC4302"></a><a id="LNPCC4303"></a><a id="LNPCC4304"></a><a id="LNPCC4305"></a><a id="LNPCC4306"></a><a id="LNPCC4300"></a><div class="props_rev_3"><a id="GUID-9782538E-ED92-4169-9E60-8440FD4BD746" name="GUID-9782538E-ED92-4169-9E60-8440FD4BD746"></a><h4 id="LNPCC-GUID-9782538E-ED92-4169-9E60-8440FD4BD746" class="sect4"><span class="enumeration_section">16.4.18</span>描述</h4>
                  <div>
                     <div class="section">
                        <p class="subhead3" id="GUID-9782538E-ED92-4169-9E60-8440FD4BD746__GUID-862DB23E-31AA-4479-9DAB-0780E7CC9B2A">目的</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>这是一个等同于几个OCI和PL / SQL语句的语句（这就是它为最后保存的原因）。使用LOB DESCRIBE SQL语句从LOB检索属性。此功能类似于OCI和PL / SQL过程。LOB DESCRIBE语句具有以下格式：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-9782538E-ED92-4169-9E60-8440FD4BD746__GUID-72C29907-D435-4D69-A390-45468EA89698">句法</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">EXEC SQL [AT [：] <span class="italic">database</span> ] LOB DESCRIBE： <span class="italic">src</span> GET <span class="italic">attribute1</span> [{， <span class="italic">attributeN</span> }] INTO： <span class="italic">hv1</span> [[INDICATOR]： <span class="italic">hv_ind1</span> ] [{，： <span class="italic">hvN</span> [[INDICATOR]： <span class="italic">hv_indN</span> ]}];</pre><p>其中属性可以是以下任何选项：</p><pre class="oac_no_warn" dir="ltr">CHUNKSIZE |目录| FILEEXISTS | FILENAME | ISOPEN | ISTEMPORARY |长度</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-9782538E-ED92-4169-9E60-8440FD4BD746__GUID-136E7702-FA70-4C26-8D61-D7BC3AAECC2F">主机变量</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>src（IN）</p>
                        <p>内部或外部LOB的LOB定位器。</p>
                        <p>hv1 ... hvN ......（OUT）</p>
                        <p>按属性名称列表中指定的顺序接收属性值的主变量。</p>
                        <p>hv_ind1 ... hv_indN ......（OUT）</p>
                        <p>可选的主机变量，按属性名称列表的顺序接收指示符NULL状态。</p>
                        <p>此表描述了与之关联的LOB以及应该读取它们的C类型的属性：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="tblformal" id="GUID-9782538E-ED92-4169-9E60-8440FD4BD746__GUID-7F267B80-B69E-48E1-AC9E-38FBD518BD29">
                        <p class="titleintable">表16-3 LOB属性</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="LOB属性" width="100%" border="1" summary="LOB Attributes" frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="21%" id="d87166e2933">LOB属性</th>
                                 <th align="left" valign="bottom" width="46%" id="d87166e2937">属性描述</th>
                                 <th align="left" valign="bottom" width="19%" id="d87166e2941">限制</th>
                                 <th align="left" valign="bottom" width="13%" id="d87166e2945">C型</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="21%" id="d87166e2951" headers="d87166e2933 ">
                                    <p>CHUNKSIZE</p>
                                 </td>
                                 <td align="left" valign="top" width="46%" headers="d87166e2951 d87166e2937 ">
                                    <p>LOB块中用于存储LOB值的空间量（以字节为单位的BLOB和CLOB / NCLOB的字符）。如果使用此块大小的倍数发出READ / WRITE请求，则可以提高性能。如果所有WRITE都以块为基础完成，则不会进行额外/过量版本控制，也不会重复。用户可以批量写入WRITE，直到它们具有足够的块而不是为相同的CHUNK发出多个WRITE调用。</p>
                                 </td>
                                 <td align="left" valign="top" width="19%" headers="d87166e2951 d87166e2941 ">
                                    <p>仅限BLOB，CLOB和NCLOB</p>
                                 </td>
                                 <td align="left" valign="top" width="13%" headers="d87166e2951 d87166e2945 ">
                                    <p>unsigned int</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="21%" id="d87166e2964" headers="d87166e2933 ">
                                    <p>目录</p>
                                 </td>
                                 <td align="left" valign="top" width="46%" headers="d87166e2964 d87166e2937 ">
                                    <p>BFILE的DIRECTORY别名的名称。最大长度为128个字节。</p>
                                 </td>
                                 <td align="left" valign="top" width="19%" headers="d87166e2964 d87166e2941 ">
                                    <p>仅限文件LOB</p>
                                 </td>
                                 <td align="left" valign="top" width="13%" headers="d87166e2964 d87166e2945 ">
                                    <p>char * <a id="fn_6" name="fn_6" href="#fn_6" for="" directory="" and="" filename="" attributes,="" the="" only="" external="" datatypes="" that="" will="" be="" supported="" are="" charz,="" string,="" varchar,="" varchar2="" charf=")" ="" onclick="footdisplay(6, "><sup>脚6</sup></a></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="21%" id="d87166e2980" headers="d87166e2933 ">
                                    <p>文件已存在</p>
                                 </td>
                                 <td align="left" valign="top" width="46%" headers="d87166e2980 d87166e2937 ">
                                    <p>确定服务器操作系统的文件系统上是否存在BFILE。当FILEEXISTS非零时，它是真的;当它等于0时为false。</p>
                                 </td>
                                 <td align="left" valign="top" width="19%" headers="d87166e2980 d87166e2941 ">
                                    <p>仅限文件LOB</p>
                                 </td>
                                 <td align="left" valign="top" width="13%" headers="d87166e2980 d87166e2945 ">
                                    <p>签名int</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="21%" id="d87166e2993" headers="d87166e2933 ">
                                    <p>文件名</p>
                                 </td>
                                 <td align="left" valign="top" width="46%" headers="d87166e2993 d87166e2937 ">
                                    <p>BFILE的名称。最大长度为255个字节。</p>
                                 </td>
                                 <td align="left" valign="top" width="19%" headers="d87166e2993 d87166e2941 ">
                                    <p>仅限文件LOB</p>
                                 </td>
                                 <td align="left" valign="top" width="13%" headers="d87166e2993 d87166e2945 ">
                                    <p>char *</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="21%" id="d87166e3006" headers="d87166e2933 ">
                                    <p>开了</p>
                                 </td>
                                 <td align="left" valign="top" width="46%" headers="d87166e3006 d87166e2937 ">
                                    <p>对于BFILE，如果从未在OPEN语句中使用输入BFILE定位符，则此定位器认为BFILE不会打开。但是，不同的BFILE定位器可能已打开BFILE。可以使用不同的定位器在同一个BFILE上执行多个OPEN。对于LOB，如果不同的定位器打开LOB，则输入定位器仍然认为LOB是OPEN。ISOPEN在非零时是正确的;当它等于0时为false。</p>
                                 </td>
                                 <td align="left" valign="top" width="19%" headers="d87166e3006 d87166e2941 ">
                                    <p>-</p>
                                 </td>
                                 <td align="left" valign="top" width="13%" headers="d87166e3006 d87166e2945 ">
                                    <p>签名int</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="21%" id="d87166e3019" headers="d87166e2933 ">
                                    <p>方法isTemporary</p>
                                 </td>
                                 <td align="left" valign="top" width="46%" headers="d87166e3019 d87166e2937 ">
                                    <p>确定输入LOB定位符是否引用临时LOB。ISTEMPORARY在非零时是真的;当它等于0时为false。</p>
                                 </td>
                                 <td align="left" valign="top" width="19%" headers="d87166e3019 d87166e2941 ">
                                    <p>仅限BLOB，CLOB和NCLOB</p>
                                 </td>
                                 <td align="left" valign="top" width="13%" headers="d87166e3019 d87166e2945 ">
                                    <p>签名int</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="21%" id="d87166e3032" headers="d87166e2933 ">
                                    <p>长度</p>
                                 </td>
                                 <td align="left" valign="top" width="46%" headers="d87166e3032 d87166e2937 ">
                                    <p>BLOB和BFILE的长度，以字节为单位，CLOB和NCLOB以字符为单位。对于BFILE，长度包括EOF（如果存在）。空内部LOB的长度为零。未初始化的LOB / BFILE具有未定义的长度。</p>
                                 </td>
                                 <td align="left" valign="top" width="19%" headers="d87166e3032 d87166e2941 ">
                                    <p>-</p>
                                 </td>
                                 <td align="left" valign="top" width="13%" headers="d87166e3032 d87166e2945 ">
                                    <p>unsigned int</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p class="tablefootnote"><sup class="tablefootnote">脚注6</sup></p><p>对于DIRECTORY和FILENAME属性，将支持的唯一外部数据类型是CHARZ，STRING，VARCHAR，VARCHAR2和CHARF。</p>
                     <p></p>
                     <div class="section">
                        <p class="subhead3" id="GUID-9782538E-ED92-4169-9E60-8440FD4BD746__GUID-23CDC664-6307-4534-9A0E-D5A1AD676FFA">使用说明</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>指标变量应宣布为简短。执行完成后，sqlca.sqlerrd [2]包含检索到的没有错误的属性数。如果存在执行错误，则发生它的属性比sqlca.sqlerrd [2]的内容多一个。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-9782538E-ED92-4169-9E60-8440FD4BD746__GUID-9B6151E3-2B39-4F7F-A1CA-FACDBD8B2D37">DESCRIBE示例</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>这是一个简单的Pro * C / C ++示例，它提取给定BFILE的DIRECTORY和FILENAME属性：</p>
                        <p>正确的类型解析和以下OCIBFileLocator声明的编译需要oci.h头文件：</p><pre class="oac_no_warn" dir="ltr">#include &lt;oci.h&gt; ...OCIBFileLocator * bfile; char目录[31]，filename [256];短d_ind，f_ind;</pre><p>最后，从某个LOB表中选择一个BFILE定位器并执行DESCRIBE：</p><pre class="oac_no_warn" dir="ltr">EXEC SQL ALLOCATE：bfile; EXEC SQL SELECT a_bfile INTO：bfile FROM lob_table WHERE ...; EXEC SQL LOB DESCRIBE：bfile GET DIRECTORY，FILENAME INTO：directory：d_ind，：filename：f_ind;</pre><p>指标变量仅对DIRECTORY和FILENAME属性有效。这些属性是字符串，如果用于保存其值的主机变量缓冲区不够大，则其值可能会被截断。发生截断时，指标的值将设置为属性的原始长度。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="LNPCC4307"></a><div class="props_rev_3"><a id="GUID-5DA7FD4D-FC6E-416E-A8E6-AD80E3882D70" name="GUID-5DA7FD4D-FC6E-416E-A8E6-AD80E3882D70"></a><h3 id="LNPCC-GUID-5DA7FD4D-FC6E-416E-A8E6-AD80E3882D70" class="sect3"><span class="enumeration_section">16.5</span> LOB和导航界面</h3>
               <div>
                  <p>导航界面还可用于处理包含LOB作为属性的对象类型。</p>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="about-Objects.html#GUID-3E124735-91D3-495D-9080-2BB9B776B279">对对象的导航访问</a></li>
                     </ul>
                  </div>
               </div>
               <a id="LNPCC4308"></a><div class="props_rev_3"><a id="GUID-C3BD7223-D88D-4BF4-A350-3B3ACAE74DF7" name="GUID-C3BD7223-D88D-4BF4-A350-3B3ACAE74DF7"></a><h4 id="LNPCC-GUID-C3BD7223-D88D-4BF4-A350-3B3ACAE74DF7" class="sect4"><span class="enumeration_section">16.5.1</span>瞬态对象</h4>
                  <div>
                     <p>使用OBJECT CREATE语句创建具有LOB属性的瞬态和持久对象。您可以将临时LOB分配给临时对象的LOB属性，然后将该值复制到持久对象的永久LOB或LOB属性以保存数据。或者，将临时LOB分配给LOB属性，并使用FLUSH将值写入数据库。</p>
                     <p>您可以使用BFILE属性创建临时对象，并从磁盘上的BFILE读取数据。请记住，不支持临时BFILE。</p>
                  </div>
               </div><a id="LNPCC4309"></a><div class="props_rev_3"><a id="GUID-C78E9FFC-C73D-4692-9C37-DF0BF1DBA44D" name="GUID-C78E9FFC-C73D-4692-9C37-DF0BF1DBA44D"></a><h4 id="LNPCC-GUID-C78E9FFC-C73D-4692-9C37-DF0BF1DBA44D" class="sect4"><span class="enumeration_section">16.5.2</span>持久对象</h4>
                  <div>
                     <p>在包含内部LOB属性的对象缓存中创建持久对象时，LOB属性将隐式设置为空。您必须首先使用OBJECT FLUSH语句刷新此对象，从而在表中插入一行并创建一个空LOB。在对象缓存中刷新对象后（使用VERSION = LATEST选项），将真实定位器读入属性。</p>
                     <p>使用BFILE属性创建对象时，BFILE设置为NULL。必须先使用有效的目录别名和文件名进行更新，然后才能读取BFILE。</p>
                     <p>可以将临时LOB分配给持久对象的LOB属性。刷新对象时将复制实际的LOB值。用户还可以使用临时LOB定位符和COPY语句中LOB属性的定位符，将临时LOB的值显式复制到持久对象的LOB属性。</p>
                  </div>
               </div><a id="LNPCC4310"></a><div class="props_rev_3"><a id="GUID-DE4ED88D-67A3-41D4-91AD-E427046E84E6" name="GUID-DE4ED88D-67A3-41D4-91AD-E427046E84E6"></a><h4 id="LNPCC-GUID-DE4ED88D-67A3-41D4-91AD-E427046E84E6" class="sect4"><span class="enumeration_section">16.5.3</span>导航接口示例</h4>
                  <div>
                     <p>使用OBJECT GET和SET语句通过导航界面处理LOB。</p>
                     <p>您可以检索作为对象类型属性的LOB定位器，并在任何新的嵌入式SQL LOB语句中使用它。使用OBJECT SET语句将LOB定位符作为属性放回对象类型中。</p>
                     <p>这样做与直接LOB ASSIGN操作相同。相同的规则适用于对象类型的OBJECT GET或LOB属性，如果已经执行了LOB ASSIGN，则该对象类型将适用，包括类型强制。</p>
                     <p>例如，假设我们有这个简单的类型定义</p><pre class="oac_no_warn" dir="ltr">CREATE TYPE lob_type AS OBJECT（a_blob BLOB）;</pre><p>此示例假定该类型是数据库中具有有效（和初始化）BLOB属性的列。</p>
                     <p>Pro * C / C ++可用的OTT生成的C结构如下所示：</p><pre class="oac_no_warn" dir="ltr">struct lob_type {OCIBlobLocator * a_blob; }; typedef struct lob_type lob_type;</pre><p>您可以编写Pro * C / C ++程序来提取BLOB属性并在DESCRIBE语句中检索BLOB的当前长度。然后，您可以将BLOB的大小调整为其大小的一半，使用SET OBJECT设置属性，然后使用OBJECT FLUSH使更改成为永久更改。</p>
                     <p>首先包括oci.h并制作一些局部变量声明：</p><pre class="oac_no_warn" dir="ltr">#include &lt;oci.h&gt; lob_type * lob_type_p; OCIBlobLocator * blob =（OCIBlobLocator *）0; unsigned int length;</pre><p>从对象中选择BLOB属性，执行OBJECT GET，并执行DESCRIBE以获取BLOB的当前长度：</p><pre class="oac_no_warn" dir="ltr">EXEC SQL ALLOCATE：blob; EXEC SQL SELECT a_column INTO：lob_type_p FROM a_table WHERE ...更新; EXEC SQL OBJECT获取a_blob FROM：lob_type_p INTO：blob; EXEC SQL LOB DESCRIBE：blob GET LENGTH INTO：length;</pre><p>将长度减半并将BLOB修剪到新的长度：</p><pre class="oac_no_warn" dir="ltr">length =（unsigned int）（length / 2）; EXEC SQL LOB TRIM：blob TO：length;</pre><p>更改BLOB后，将BLOB属性设置回对象，将更改恢复到服务器，然后提交：</p><pre class="oac_no_warn" dir="ltr">EXEC SQL OBJECT SET a_blob OF：lob_type_p TO：blob; EXEC SQL OBJECT FLUSH：lob_type_p; EXEC SQL FREE：blob; EXEC SQL COMMIT WORK;</pre><div class="infoboxnotealso" id="GUID-DE4ED88D-67A3-41D4-91AD-E427046E84E6__GUID-82650A57-394B-45E3-B00C-161519032867">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="the-Object-type.html#GUID-502C3781-C88E-46B8-9EB2-9A93E0B4E7AE">对象类型转换器，</a>用于为OTT创建INTYPE文件和运行OTT的信息。</p>
                     </div>
                  </div>
               </div>
            </div><a id="LNPCC4311"></a><div class="props_rev_3"><a id="GUID-8FC2E666-EA9B-4202-BB84-007CC31988C0" name="GUID-8FC2E666-EA9B-4202-BB84-007CC31988C0"></a><h3 id="LNPCC-GUID-8FC2E666-EA9B-4202-BB84-007CC31988C0" class="sect3"><span class="enumeration_section">16.6</span> LOB程序示例</h3>
               <div>
                  <p>以下是两个示例，说明如何读取和写入BFILE和BLOB。</p>
               </div><a id="LNPCC4312"></a><div class="props_rev_3"><a id="GUID-53930ECD-FAD0-447B-BAC3-DAAC3BFF645C" name="GUID-53930ECD-FAD0-447B-BAC3-DAAC3BFF645C"></a><h4 id="LNPCC-GUID-53930ECD-FAD0-447B-BAC3-DAAC3BFF645C" class="sect4"><span class="enumeration_section">16.6.1</span>读取BLOB，编写文件示例</h4>
                  <div>
                     <p>在这个例子中，我们将从具有未知任意长度的BLOB中读取数据到缓冲区中，然后将数据从缓冲区写入外部文件。我们的缓冲区很小，因此根据我们正在读取的BLOB的大小，我们可以在单个READ语句中将BLOB值读入缓冲区，或者我们可能需要使用标准轮询方法。</p>
                     <p>首先，我们从oci.h和一些简单的局部变量声明开始</p><pre class="oac_no_warn" dir="ltr">#include &lt;oci.h&gt; OCIBlobLocator * blob; FILE * fp; unsigned int amt，offset = 1;</pre><p>现在我们需要一个缓冲区来存储BLOB值，然后从以下位置写入文件：</p><pre class="oac_no_warn" dir="ltr">#define MAXBUFLEN 5000 unsigned char buffer [MAXBUFLEN]; EXEC SQL VAR缓冲区IS RAW（MAXBUFLEN）;</pre><p>分配BLOB主机变量并选择我们将读取的BLOB：</p><pre class="oac_no_warn" dir="ltr">EXEC SQL ALLOCATE：blob; EXEC SQL SELECT a_blob INTO：blob FROM lob_table WHERE ...;</pre><p>然后我们可以打开我们将写入BLOB值的外部文件：</p><pre class="oac_no_warn" dir="ltr">fp = fopen（（const char *）“image.gif”，（const char *）“w”）;</pre><p>如果缓冲区可以在单个READ中保存整个LOB值，我们需要捕获NOT FOUND条件以发信号通知LOB READ终止：</p><pre class="oac_no_warn" dir="ltr">EXEC SQL WHENEVER NOT FOUND GOTO end_of_lob;</pre><p>现在做我们的第一次阅读。我们将金额设置为4千兆字节的最大值。它比我们的缓冲区大，所以如果LOB不适合我们将使用轮询模式READ：</p><pre class="oac_no_warn" dir="ltr">amt = 4294967295; EXEC SQL LOB READ：amt FROM：blob AT：offset INTO：buffer;</pre><p>如果我们到达那么这意味着缓冲区不足以容纳整个LOB值，所以我们必须使用二进制I / O编写我们所拥有的并继续读取：</p><pre class="oac_no_warn" dir="ltr">（void）fwrite（（void *）buffer，（size_t）MAXBUFLEN，（size_t）1，fp）;</pre><p>我们使用标准轮询方法继续读取无限循环内的LOB READ。我们可以设置NOT FOUND条件来终止循环：</p><pre class="oac_no_warn" dir="ltr">EXEC SQL WHENEVER NOT FOUND DO break; while（TRUE）{</pre><p>在轮询期间，不使用偏移量，因此我们可以在随后的LOB READ中省略它。但是，我们需要这个数量，因为它会告诉我们在上一次READ调用中读取了多少</p><pre class="oac_no_warn" dir="ltr">EXEC SQL LOB READ：amt FROM：blob INTO：buffer; （void）fwrite（（void *）buffer，（size_t）MAXBUFLEN，（size_t）1，fp）; }</pre><p>在这里，我们已达到LOB值的末尾。金额包含最后一件READ的金额。在轮询期间，每个临时片的数量设置为MAXBUFLEN，或者我们缓冲区的最大大小：</p><pre class="oac_no_warn" dir="ltr">end_of_lob：（void）fwrite（（void *）buffer，（size_t）amt，（size_t）1，fp）;</pre><p>此代码的基本结构应允许任意长度的内部LOB读入本地缓冲区，然后写入外部文件。它是在OCI和PL / SQL之后建模的。</p>
                  </div>
               </div><a id="LNPCC4313"></a><div class="props_rev_3"><a id="GUID-D79C46CF-3486-4816-A5C4-0EB2CAE3AB81" name="GUID-D79C46CF-3486-4816-A5C4-0EB2CAE3AB81"></a><h4 id="LNPCC-GUID-D79C46CF-3486-4816-A5C4-0EB2CAE3AB81" class="sect4"><span class="enumeration_section">16.6.2</span>读取文件，写一个BLOB示例</h4>
                  <div>
                     <p>在这个例子中，我们将从具有已知任意长度的文件中的数据读入缓冲区，然后将数据从缓冲区写入内部BLOB。我们的缓冲区很小，因此根据我们正在读取的文件的大小，我们可能能够在单个WRITE中将文件数据写入LOB，或者我们可能需要使用标准轮询方法。</p>
                     <p>首先，我们从oci.h和一些简单的局部变量声明开始</p><pre class="oac_no_warn" dir="ltr">#include &lt;oci.h&gt; OCIBlobLocator * blob; FILE * fp; unsigned int amt，offset = 1; unsigned filelen，remainder，nbytes;布尔最后;</pre><p>我们需要一个缓冲区来存储文件数据，然后写入LOB：</p><pre class="oac_no_warn" dir="ltr">#define MAXBUFLEN 5000 unsigned char buffer [MAXBUFLEN]; EXEC SQL VAR缓冲区IS RAW（MAXBUFLEN）;</pre><p>我们在空表中初始化一个空BLOB并将该BLOB检索到ALLOCATEd定位器中，然后用文件中的数据填充它：</p><pre class="oac_no_warn" dir="ltr">EXEC SQL ALLOCATE：blob; EXEC SQL INSERT INTO lob_table（a_blob）VALUES（EMPTY_BLOB（））返回a_blob INTO：blob;</pre><p>打开二进制文件并确定其长度。我们写入BLOB的总量是二进制文件的实际长度：</p><pre class="oac_no_warn" dir="ltr">fp = fopen（（const char *）“image.gif”，（const char *）“r”）; （void）fseek（fp，0L，SEEK_END）; filelen =（unsigned int）ftell（fp）; amt = filelen;</pre><p>设置我们对文件的初始读取，根据缓冲区大小确定要读取的字节数：</p><pre class="oac_no_warn" dir="ltr">if（filelen&gt; MAXBUFLEN）nbytes = MAXBUFLEN;否则nbytes = filelen;</pre><p>发出文件I / O操作，从我们的文件<code class="codeph">fp</code>读取<code class="codeph">n</code>个字节的数据到我们的缓冲区中，并确定剩余的读取量。从文件开头开始阅读：</p><pre class="oac_no_warn" dir="ltr">（void）fseek（fp，0L，SEEK_SET）; （void）fread（（void *）buffer，（size_t）nbytes，（size_t）1，fp）; remainder = filelen  -  nbytes;</pre><p>根据剩下的内容，将缓冲区写入单个部分或启动轮询以将文件中的数据写入几个较小的部分：</p><pre class="oac_no_warn" dir="ltr">if（remainder == 0）{</pre><p>在这种情况下，我们可以将数据写成一个整体：</p><pre class="oac_no_warn" dir="ltr">EXEC SQL LOB WRITE ONE：amt FROM：buffer INTO：blob AT：offset; } else {</pre><p>启动轮询方法，将数据分段写入LOB。首先，为了启动轮询方法，我们在初始WRITE上使用FIRST方向：</p><pre class="oac_no_warn" dir="ltr">EXEC SQL LOB WRITE FIRST：amt FROM：buffer INTO：blob AT：offset;</pre><p>设置一个简单的循环来实现轮询方法：</p><pre class="oac_no_warn" dir="ltr">last = FALSE;执行SQL WHENEVER SQLERROR DO break;做{</pre><p>计算从文件中读取的字节数，然后再写入目标LOB。还要确定这是否是我们的最后一篇：</p><pre class="oac_no_warn" dir="ltr">if（余数&gt; MAXBUFLEN）nbytes = MAXBUFLEN; else {nbytes = remainder; last = TRUE; }</pre><p>再次从文件系统上的文件中读取下一个<code class="codeph">nbytes</code>到我们的缓冲区中。如果在读取文件期间发生任何错误，我们会自动将下一个WRITE设置为最后一个：</p><pre class="oac_no_warn" dir="ltr">if fread（（void *）buffer，（size_t）nbytes，（size_t）1，fp）！= 1）last = TRUE;</pre><p>此时，要么写入最后一块，要么是临时NEXT块，这表示仍有数据需要从文件中处理：</p><pre class="oac_no_warn" dir="ltr">if（last）{EXEC SQL LOB WRITE LAST：amt FROM：buffer INTO：blob; } else {EXEC SQL LOB WRITE NEXT：amt FROM：buffer INTO：blob; } remainder  -  = nbytes;而（！最后&amp;&amp;！feof（fp））;</pre><p>此代码示例允许将任意长度的文件读入本地缓冲区，然后写入LOB。它是在OCI示例之后建模的。</p>
                  </div>
               </div><a id="LNPCC4314"></a><div class="props_rev_3"><a id="GUID-572493C3-B00E-4D38-A0BE-BCBC2EDE6B20" name="GUID-572493C3-B00E-4D38-A0BE-BCBC2EDE6B20"></a><h4 id="LNPCC-GUID-572493C3-B00E-4D38-A0BE-BCBC2EDE6B20" class="sect4"><span class="enumeration_section">16.6.3</span> lobdemo1.pc</h4>
                  <div>
                     <div class="section">
                        <p>该程序<code class="codeph">lobdemo1.pc</code>说明了几个LOB嵌入式SQL语句。源代码位于<code class="codeph">demo</code>目录中。该应用程序使用名为<code class="codeph">license_table</code>的表，其<code class="codeph">license_table</code>社会安全号，名称和包含驱动违规行为的文本的CLOB。对典型机动车部门的几个简化的SQL操作进行了建模。<a id="d87166e3433" class="indexterm-anchor"></a></p>
                        <p>可能的行动是：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>添加新记录。</p>
                           </li>
                           <li>
                              <p>按社会安全号码列出记录。</p>
                           </li>
                           <li>
                              <p>在给定社会安全号码的情况下列出记录中的信息。</p>
                           </li>
                           <li>
                              <p>将新的流量违规附加到现有CLOB的内容。</p>
                           </li>
                        </ul>
                        <p></p><pre class="oac_no_warn" dir="ltr">/ ******************* **************************情景：我们考虑用于存储驾驶执照的数据库示例。许可证存储为包含三列的表的行：一个人的sss号，他在文本中的名称以及在他的许可中找到的信息的文本摘要。sss号码是司机唯一的社会安全号码。该名称是其身份证上的驾驶员姓名。文本摘要是关于驾驶员信息的摘要，包括他的驾驶记录，其可以是任意长的并且可以包含关于该人的驾驶能力的评论和数据。应用程序概述：此示例演示了Pro * C客户端如何通过PL / SQL例程处理新的LOB数据类型。演示了通过dbms_lob包提供的存储过程访问和存储lobs到表并操纵LOB的机制。************************************************** ************************** / / ********************** ************************************************** ***运行演示：1。在SQL * Plus 2中执行脚本lobdemo1c.sql。使用Pro * C / C ++预处理proc lobdemo1 user = scott / tiger sqlcheck = full 3。编译/链接（此步骤是特定于平台的）**************************************** ************************************ / / ***以下内容将添加到创建脚本中对于这个例子*** ***这个代码可以在lobdemo1c.sql中找到*** connect scott / tiger; set serveroutput on; Rem确保数据库没有license_table浮动drop table license_table; Rem ABSTRACTION：Rem许可证表将驾驶执照的概念减少为三个Rem不同的组件 - 唯一的社会安全号码（sss），Rem名称（名称）和杂项信息的文本摘要。Rem IMPLEMENTATION：Rem我们的实现遵循这个抽象创建表license_table（sss char（9），name varchar2（50），txt_summary clob）;插入license_table值（'971517006'，'Dennis Kernighan'，'穿着亮橙色衬衫 -  1996年10月31日'）;插入license_table值（'555001212'，'Eight H. Number'，'在影响下驾驶 -  1997年1月1日'）;插入license_table值（'010101010'，'P。Doughboy'，'冒充Oracle员工 -  1997年1月10日'）;插入license_table值（'555377012'，'Calvin N. Hobbes'，'在影响下驾驶 -  1996年11月30日'）;从license_table中选择count（*）; Rem承诺保存提交; ************************************************** ************************** / / ********************** **** *开始lobdemo1.pc代码* ************************** / #define EX_SUCCESS 0 #define EX_FAILURE 1 #ifndef STDIO＃ include &lt;stdio.h&gt; #endif / * STDIO * / #ifndef SQLCA_ORACLE #include &lt;sqlca.h&gt; #endif / * SQLCA_ORACLE * / #ifndef OCI_ORACLE #include &lt;oci.h&gt; #endif / * OCI_ORACLE * / #include &lt; time.h&gt; #include &lt;string.h&gt; #include &lt;stdlib.h&gt; #include &lt;ctype.h&gt; #ifndef LOBDEMO1_ORACLE #include“lobdemo1.h”#endif / * LOBDEMO1_ORACLE * / / ******* **** *定义* *********** / #define SSS_LENGTH 12 #define NAME_LENGTH 50 / *对应表格中名称的最大长度* / #define BUFLEN 1024 #define MAXCRIME 5 #define DATELENGTH 12 / *********** * Globals * *********** / char * CrimeList [MAXCRIME] = {“在影响下驾驶”，“侠盗猎车手”，“没有许可证驾驶“，”模仿甲骨文员工“，”穿着亮橙色衬衫“}; char curdate [DATELENGTH]; / *********************** *功能原型* ********************** * / #if defined（__ STDC__）void GetDate（void）; void PrintSQLError（void）; void Driver（void）; void ListRecords（void）; void PrintCrime（OCIClobLocator * a_clob）; void GetRecord（void）; void NewRecord（void）; char * NewCrime（无效）; void GetName（char * name_holder）; void AppendToClob（OCIClobLocator * a_clob，char * charbuf）; void AddCrime（void）; void ReadClob（OCIClobLocator * a_clob）; boolean GetSSS（char * suggested_sss）; #else void GetDate（）; void PrintSQLError（）; void Driver（）; void ListRecords（）; void PrintCrime（/ * OCIClobLocator * a_clob * /）; void GetRecord（）; void NewRecord（）; char * NewCrime（）; void GetName（/ * char * name_holder * /）; void AppendToClob（/ * OCIClobLocator * a_clob，char * charbuf * /）; void AddCrime（）; boolean GetSSS（/ * char * suggested_sss * /）; #endif / * * NAME * GetDate * DESCRIPTION *从用户获取日期* LOB FEATURES * none * / void GetDate（）{time_t now; now = time（NULL）; strftime（curdate，100，“ - ％d％b％Y”，localtime（＆now））; } main（）{char * uid =“scott / tiger”;执行SQL WHENEVER SQLERROR DO PrintSQLError（）; printf（“连接到许可证数据库帐户：％s \ n”，uid）; EXEC SQL CONNECT：uid; GETDATE（）;的printf（ “\吨******************************* \ n”）; printf（“\ t *欢迎来到DMV数据库* \ n”）;的printf（ “\吨******************************* \ n \ n”）; printf（“今天的日期是％s \ n”，curdate）;驱动器（）; EXEC SQL COMMIT RELEASE; return（EX_SUCCESS）; } / * * NAME * Driver * DESCRIPTION *命令调度例程* LOB特征*无* / void驱动程序（）{char choice [20]; boolean done = FALSE;而（！完成）{printf（“\ n许可选项：\ n”）; printf（“\ t（L）是SSS编号的可用记录\ n”）; printf（“\ t（G）et特定记录的信息\ n”）; printf（“\ t（A）dd犯罪记录\ n”）; printf（“\ t（I）将新记录插入数据库\ n”）;的printf（ “\吨（Q）UIT \ n”）; printf（“输入你的选择：”）; fgets（choice，20，stdin）; switch（toupper（choice [0]））{case'L'：ListRecords（）;打破; case'G'：GetRecord（）;打破; case'A'：AddCrime（）;打破; case'I'：NewRecord（）;打破; case'Q'：done = TRUE;打破;默认值：break; } * * * NAME * ListRecords * DESCRIPTION *按sss编号列出可用记录* LOB FEATURES * none * / void ListRecords（）{char * select_sss =“SELECT SSS FROM LICENSE_TABLE”; char sss [10]; EXEC SQL PREPARE sss_exec FROM：select_sss;执行SQL DECLARE sss_cursor CURSOR for sss_exec; EXEC SQL OPEN sss_cursor; printf（“可用记录：\ n”）; EXEC SQL WHENEVER NOT FOUND DO break; while（TRUE）{EXEC SQL FETCH sss_cursor INTO：sss; printf（“\ t％s \ n”，sss）; } EXEC SQL WHENEVER NOT FOUND CONTINUE; EXEC SQL CLOSE sss_cursor; } / * * NAME * PrintCrime * DESCRIPTION *测试clob的正确性* LOB特征* OCIlobRead和OCILobGetLength * / void PrintCrime（a_clob）OCIClobLocator * a_clob; {ub4 lenp;的printf（ “\ n”）;的printf（ “===================== \ n”）; printf（“CRIME SHEET SUMMARY \ n”）;的printf（ “===================== \ n \ n”）; EXEC SQL LOB DESCRIBE：a_clob GET LENGTH INTO：lenp; if（lenp == 0）/ *文件上没有犯罪* / {printf（“Record is clean \ n”）; } else {ub4 amt = lenp; varchar * the_string =（varchar *）malloc（2 + lenp）; the_string-&gt; len =（ub2）lenp; EXEC SQL WHENEVER NOT FOUND CONTINUE; EXEC SQL LOB READ：amt FROM：a_clob INTO：the_string WITH LENGTH：lenp; printf（“％。* s \ n”，the_string-&gt; len，the_string-&gt; arr）;自由（the_string）; * * * * NAME * GetRecord *说明*获取单个人的许可证* LOB功能*分配和选择blob和clob * / void GetRecord（）{char sss [SSS_LENGTH]; if（GetSSS（sss）== TRUE）{OCIClobLocator * license_txt; char name [NAME_LENGTH] = {'\ 0'}; EXEC SQL ALLOCATE：license_txt; EXEC SQL SELECT name，txt_summary INTO：name，：license_txt FROM license_table WHERE sss =：sss;的printf（“=============================================== ========= \ n \ n“）; printf（“NAME：％s \ tSSS：％s \ n”，name，sss）; PrintCrime（license_txt）;的printf（“\ n \ n =========================================== ============= \ n“）; EXEC SQL FREE：license_txt; } else {printf（“未找到SSS编号\ n”）; } * / * NAME * NewRecord * DESCRIPTION *在数据库中创建新记录* LOB FEATURES * EMPTY_CLOB（）和OCILobWrite * / void NewRecord（）{char sss [SSS_LENGTH]，name [NAME_LENGTH] = {'\ 0'}; if（GetSSS（sss）== TRUE）{printf（“记录该sss号已存在。\ n”）;返回; } else {OCIClobLocator * license_txt; EXEC SQL ALLOCATE：license_txt;的GetName（名）; EXEC SQL INSERT INTO license_table VALUES（：sss，：name，empty_clob（））; EXEC SQL SELECT TXT_SUMMARY INTO：license_txt FROM LICENSE_TABLE，其中SSS =：sss;的printf（“=============================================== ========= \ n \ n“）; printf（“NAME：％s \ tSSS：％s \ n”，name，sss）; PrintCrime（license_txt）;的printf（“\ n \ n =========================================== ============= \ n“）; EXEC SQL FREE：license_txt; } * * * NAME * NewCrime *说明*查询新犯罪的用户* LOB功能*无* / char * NewCrime（）{int SuggestedCrimeNo; int i; char crime [10]; printf（“从以下选择：\ n”）; for（i = 1; i &lt;= MAXCRIME; i ++）printf（“（％d）％s \ n”，i，CrimeList [i-1]）; printf（“犯罪（1-5）：”）; fgets（犯罪，10，标准差）; SuggestedCrimeNo = atoi（犯罪）; while（（SuggestedCrimeNo &lt;1）||（SuggestedCrimeNo&gt; MAXCRIME））{printf（“无效选择\ n”）; printf（“犯罪（1-5）：”）; fgets（犯罪，10，标准差）; SuggestedCrimeNo = atoi（犯罪）; }返回CrimeList [SuggestedCrimeNo-1]; } / * * NAME * AppendToClob * DESCRIPTION *按以下方式将字符串charbuf附加到Clob：*如果clob a_clob的内容为&lt;foo&gt;且charbuf的*内容为&lt;bar&gt;，则在追加a_clob *之后包含：&lt;foo&gt; \ n &lt;bar&gt;  -  &lt;curdate&gt; *其中&lt;curdate&gt;是* GetDate过程获得的今天的日期。* LOB功能* OCILobWrite *注意* charbuf可能是一个非常大的字符串缓冲区。*此外，应该注意的是，lobs和lob *性能是针对大数据而设计的。因此，鼓励*用户读取和写入大块*数据到lobs。* / void AppendToClob（a_clob，charbuf）OCIClobLocator * a_clob; char * charbuf; {ub4 ClobLen，WriteAmt，Offset; int CharLen = strlen（charbuf）; int NewCharbufLen = CharLen + DATELENGTH + 4; varchar * NewCharbuf; NewCharbuf =（varchar *）malloc（2 + NewCharbufLen）; NewCharbuf-&gt; arr [0] ='\ n'; NewCharbuf-&gt; arr [1] ='\ 0'; strcat（（char *）NewCharbuf-&gt; arr，charbuf）; NewCharbuf-&gt; arr [CharLen + 1] ='\ 0'; strcat（（char *）NewCharbuf-&gt; arr，curdate）; NewCharbuf-&gt; len = NewCharbufLen; EXEC SQL LOB DESCRIBE：a_clob GET LENGTH INTO：ClobLen; WriteAmt = NewCharbufLen;偏移= ClobLen + 1; EXEC SQL LOB WRITE ONE：WriteAmt FROM：NewCharbuf WITH LENGTH：NewCharbufLen INTO：a_clob AT：Offset;自由（NewCharbuf）; } / * * NAME * AddCrime * DESCRIPTION *向公民犯罪档案添加犯罪* LOB功能* OCILobWrite * / void AddCrime（）{char sss [SSS_LENGTH]; if（GetSSS（sss）== TRUE）{OCIClobLocator * license_txt; char * crimebuf; char name [NAME_LENGTH] = {'\ 0'}; EXEC SQL ALLOCATE：license_txt; EXEC SQL SELECT txt_summary INTO：license_txt FROM license_table WHERE sss =：sss FOR UPDATE; crimebuf = NewCrime（）; printf（“将％s添加到CrimeList \ n”，crimebuf）; AppendToClob（license_txt，crimebuf）; EXEC SQL SELECT name INTO：name FROM license_table WHERE sss =：sss; printf（“NAME：％s SSS：％s \ n”，name，sss）; PrintCrime（license_txt）; EXEC SQL COMMIT; EXEC SQL FREE：license_txt; } else {printf（“未找到SSS编号\ n”）; } * * * NAME * GetSSS *说明*使用客户端提供的社会安全号码填充传递的缓冲区*如果sss不对应于数据库中的任何条目，则返回FALSE，* else返回TRUE * LOB FEATURES * none * / boolean GetSSS（suggested_sss）char * suggested_sss; {int count = 0; int i; printf（“社会安全号码：”）; fgets（suggested_sss，SSS_LENGTH，stdin）; for（i = 0;（（recommended_sss [i]！='\ 0'）&amp;&amp;（i &lt;SSS_LENGTH））; i ++）{if（suggested_sss [i] =='\ n'）suggested_sss [i] ='\ 0'; EXEC SQL SELECT COUNT（*）INTO：count FROM license_table WHERE sss =：suggested_sss;回来（伯爵！= 0）; } / * * NAME * GetName * DESCRIPTION *从用户获取名称。* * LOB FEATURES * none * / void GetName（name_holder）char * name_holder; {int count = 0; int i; printf（“输入名称：”）; fgets（name_holder，NAME_LENGTH + 1，stdin）; for（i = 0; name_holder [i]！='\ 0'; i ++）{if（name_holder [i] =='\ n'）name_holder [i] ='\ 0'; } return; } / * * NAME * PrintSQLError * DESCRIPTION *使用sqlca中的info打印错误消息并调用exit。* COLLECTION FEATURES * none * / void PrintSQLError（）{EXEC SQL WHENEVER SQLERROR CONTINUE; printf（“发生SQL错误...... \ n”）; printf（“％。* s \ n”，（int）sqlca.sqlerrm.sqlerrml，（CONST char *）sqlca.sqlerrm.sqlerrmc）; EXEC SQL ROLLBACK RELEASE;出口（EX_FAILURE）; }</pre></div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>