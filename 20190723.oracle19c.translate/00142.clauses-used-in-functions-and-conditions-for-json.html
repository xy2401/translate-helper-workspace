<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="Clauses RETURNING, wrapper, error, and empty-field are described. Each is used in one or more of the SQL functions and conditions json_value, json_query, json_table, json_serialize, json_mergepatch, is json, is not json, json_exists, and json_equal."></meta>
      <meta name="description" content="Clauses RETURNING, wrapper, error, and empty-field are described. Each is used in one or more of the SQL functions and conditions json_value, json_query, json_table, json_serialize, json_mergepatch, is json, is not json, json_exists, and json_equal."></meta>
      <title>SQL查询函数和条件中使用的子句</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="JSON Developer&#39;s Guide"></meta>
      <meta property="og:description" content="Clauses RETURNING, wrapper, error, and empty-field are described. Each is used in one or more of the SQL functions and conditions json_value, json_query, json_table, json_serialize, json_mergepatch, is json, is not json, json_exists, and json_equal."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="JSON Developer&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="json-developers-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-02-22T10:58:31-08:00"></meta>
      <meta name="dcterms.title" content="JSON Developer&#39;s Guide"></meta>
      <meta name="dcterms.dateCopyrighted" content="2015, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96227-03"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="json-path-expressions.html" title="Previous" type="text/html"></link>
      <link rel="next" href="condition-JSON_EXISTS.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="ADJSN"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="json-path-expressions.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="condition-JSON_EXISTS.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">JSON开发人员指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="query-json-data.html" property="item" typeof="WebPage"><span property="name">查询JSON数据</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">SQL查询函数和条件中使用的子句</li>
            </ol>
            <a id="GUID-941C5E44-75C7-4BF1-BB0A-18AD48EDE9EB" name="GUID-941C5E44-75C7-4BF1-BB0A-18AD48EDE9EB"></a>
            
            <h2 id="ADJSN-GUID-941C5E44-75C7-4BF1-BB0A-18AD48EDE9EB" class="sect2">SQL查询函数和条件中使用的<span class="enumeration_chapter">14个</span>子句</h2>
         </header>
         <div class="ind">
            <div>
               <p>描述了<code class="codeph">RETURNING</code> ，包装器，错误和空字段。每个用于一个或多个SQL函数和条件<code class="codeph">json_value</code> ， <code class="codeph">json_query</code> ， <code class="codeph">json_table</code> ， <code class="codeph">json_serialize</code> ， <code class="codeph">json_mergepatch</code> ， <code class="codeph">is json</code> ， <code class="codeph">is not json</code> ， <code class="codeph">json_exists</code>和<code class="codeph">json_equal</code> 。
               </p>
               <div class="section"></div>
               <!-- class="section" -->
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="clauses-used-in-functions-and-conditions-for-json.html#GUID-DE9F29D3-1C23-4271-9DCD-E585866576D2">SQL查询函数的RETURNING子句</a><br>SQL函数<code class="codeph">json_value</code> ， <code class="codeph">json_query</code> ， <code class="codeph">json_serialize</code>和<code class="codeph">json_mergepatch</code>接受一个可选的<span class="bold"><code class="codeph">RETURNING</code></span>子句，它指定由该函数返回的值的数据类型。此处描述了此子句和默认行为（无<code class="codeph">RETURNING</code>子句）。
                  </li>
                  <li class="ulchildlink"><a href="clauses-used-in-functions-and-conditions-for-json.html#GUID-9079CD9C-3783-4857-9F6B-84D746C91317">SQL / JSON查询函数的包装子句JSON_QUERY和JSON_TABLE</a><br>SQL / JSON查询函数<code class="codeph">json_query</code>和<code class="codeph">json_table</code>接受一个可选的包装子句，它指定<code class="codeph">json_query</code>返回的值的形式或用于<code class="codeph">json_table</code>列中的数据。此处描述了此子句和默认行为（无包装子句）。提供了示例。
                  </li>
                  <li class="ulchildlink"><a href="clauses-used-in-functions-and-conditions-for-json.html#GUID-55344240-B1F0-490A-89BF-1526FA0546D4">SQL查询函数和条件的错误子句</a><br>某些SQL查询函数和条件接受可选的错误子句，该子句指定处理由函数或条件引发的运行时错误。此处总结了此子句和默认行为（无错误子句）。
                  </li>
                  <li class="ulchildlink"><a href="clauses-used-in-functions-and-conditions-for-json.html#GUID-3176ECEA-BBCE-4C7C-AB24-7FCE250B8443">SQL / JSON查询函数的空字段子句</a><br>SQL / JSON查询函数<code class="codeph">json_value</code> ， <code class="codeph">json_query</code>和<code class="codeph">json_table</code>接受可选的<span class="bold"><code class="codeph">ON EMPTY</code></span>子句，该子句指定在查询的数据中不存在目标JSON字段时要使用的处理。此处描述了此子句和默认行为（无<code class="codeph">ON EMPTY</code>子句）。
                  </li>
                  <li class="ulchildlink"><a href="clauses-used-in-functions-and-conditions-for-json.html#GUID-21FE887D-5D7B-43BB-A1A8-B26B8924B290">关于JSON_VALUE的MISMATCH子句</a><br>当<code class="codeph">RETURNING</code>子句指定用户定义的对象类型或集合类型实例时，函数<code class="codeph">json_value</code>接受可选的<span class="bold"><code class="codeph">ON MISMATCH</code></span> <code class="codeph">json_value</code>子句，该子句指定在目标JSON值与指定的SQL返回值不匹配时使用的处理。此处描述了此子句及其默认行为（无<code class="codeph">ON MISMATCH</code>子句）。
                  </li>
               </ul>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>父主题：</strong> <a href="query-json-data.html#GUID-119E5069-77F2-45DC-B6F0-A1B312945590" title="您可以使用简单的点表示法查询JSON数据，或者，对于更多功能，使用SQL / JSON函数和条件。您可以创建和查询数据指南，该指南汇总了一组JSON文档的结构和类型信息。">查询JSON数据</a></p>
                  </div>
               </div>
            </div>
            <a id="ADXDB6375"></a><div class="props_rev_3"><a id="GUID-DE9F29D3-1C23-4271-9DCD-E585866576D2" name="GUID-DE9F29D3-1C23-4271-9DCD-E585866576D2"></a><h3 id="ADJSN-GUID-DE9F29D3-1C23-4271-9DCD-E585866576D2" class="sect3"><span class="enumeration_section">14.1</span> SQL查询函数的RETURNING子句</h3>
               <div>
                  <p>SQL函数<code class="codeph">json_value</code> ， <code class="codeph">json_query</code> ， <code class="codeph">json_serialize</code>和<code class="codeph">json_mergepatch</code>接受一个可选的<span class="bold"><code class="codeph">RETURNING</code></span>子句，它指定由该函数返回的值的数据类型。此处描述了此子句和默认行为（无<code class="codeph">RETURNING</code>子句）。
                  </p>
                  <div class="section">
                     <p>对于<code class="codeph">json_value</code> ，您可以在任何正在使用的这些预定义的SQL数据类型的<code class="codeph">RETURNING</code>子句： <code class="codeph">VARCHAR2</code> ， <code class="codeph">NUMBER</code> ， <code class="codeph">DATE</code> ， <code class="codeph">TIMESTAMP</code> ， <code class="codeph">TIMESTAMP WITH TIME ZONE</code> ， <code class="codeph">SDO_GEOMETRY</code>和<code class="codeph">CLOB</code> 。您还可以使用用户定义的对象类型或集合类型。
                     </p>
                     <div class="infoboxnote" id="GUID-DE9F29D3-1C23-4271-9DCD-E585866576D2__GUID-9A783CEB-AB8F-42C2-9710-64FDB57B9C3A">
                        <p class="notep1">注意：</p>
                        <p>Oracle SQL数据类型<code class="codeph">DATE</code>的实例可以包括时间组件。在您的JSON数据中，您可以使用表示ISO 8601日期与时间值的字符串，也就是说，它可以具有时间组件。但是<code class="codeph">json_value</code> <span class="bold"><code class="codeph">RETURNING DATE</code></span> <code class="codeph">json_value</code>总是返回一个<span class="italic">ANSI</span> <code class="codeph">DATE</code>值，该值是<span class="italic">ANSI日期</span> ，也就是说，该值<span class="italic">没有时间组件</span> 。
                        </p>
                        <p>要返回具有时间组件的SQL <code class="codeph">DATE</code>值，请使用<span class="bold"><code class="codeph">RETURNING TIMESTAMP</code></span> ，然后<span class="italic">将</span>返回的值<span class="bold"><code class="codeph">RETURNING TIMESTAMP</code></span>为<code class="codeph">DATE</code> 。例如：</p><pre class="pre codeblock"><code>SELECT <span class="bold">铸造</span> （json_value（ '{ “一个”： <span class="bold">“2019-01-02T12：34：56”}'，</span> '$ .A'返回<span class="bold">时间戳</span> <span class="bold">）AS DATE）FROM</span> DUAL;</code></pre></div>
                     <p>对于<code class="codeph">json_query</code> ， <code class="codeph">json_serialize</code>和<code class="codeph">json_mergepatch</code>您可以使用<code class="codeph">VARCHAR2</code> ， <code class="codeph">CLOB</code>或<code class="codeph">BLOB</code> 。 <code class="codeph">BLOB</code>结果在AL32UTF8字符集中。无论<code class="codeph">json_serialize</code>返回什么数据类型，返回的数据都代表文本JSON数据。
                     </p>
                     <p>您可以选择指定<code class="codeph">VARCHAR2</code>的长度（默认值： <code class="codeph">4000</code> ）以及<code class="codeph">NUMBER</code>的精度和比例。</p>
                     <p>默认行为（无<code class="codeph">RETURNING</code>子句）是使用<code class="codeph">VARCHAR2(4000)</code> 。
                
                     </p>
                     <p>数据类型<code class="codeph">SDO_GEOMETRY</code>用于Oracle Spatial和Graph数据。特别是，这意味着您可以将<code class="codeph">json_value</code>与GeoJSON数据一起使用，GeoJSON数据是一种用于在JSON中编码地理数据的格式。</p>
                     <p><code class="codeph">RETURNING</code>子句还接受两个可选关键字<code class="codeph">PRETTY</code>和<code class="codeph">ASCII</code> 。如果两者都存在，则<code class="codeph">PRETTY</code>必须在<code class="codeph">ASCII</code>之前。 <code class="codeph">json_value</code>不允许使用关键字<code class="codeph">PRETTY</code> 。
                     </p>
                     <p>关键字<span class="bold"><code class="codeph">PRETTY</code></span>的作用是通过插入换行符和缩进来漂亮打印返回的数据。默认行为不是漂亮的打印。
                     </p>
                     <p>关键字<span class="bold"><code class="codeph">ASCII</code></span>的作用是使用标准ASCII Unicode转义序列自动转义返回数据中的所有非ASCII Unicode字符。默认行为是不转义非ASCII Unicode字符。
                     </p>
                     <div class="infobox-tip" id="GUID-DE9F29D3-1C23-4271-9DCD-E585866576D2__GUID-3F6DAB52-5AFE-409C-91FB-EDCF78888340">
                        <p class="notep1">小费：</p>
                        <p>您可以通过仅使用<code class="codeph">$</code>作为路径表达式来打印整个上下文项。
                        </p>
                     </div>
                     <p>如果在<code class="codeph">RETURNING</code>子句中指定了<code class="codeph">VARCHAR2</code> ，则值中的标量表示如下：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>布尔值由小写字符串<code class="codeph">"true"</code>和<code class="codeph">"false"</code> 。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">null</code>值由SQL <code class="codeph">NULL</code>表示。</p>
                        </li>
                        <li>
                           <div class="p">JSON编号以规范形式表示。因此，它可以在输出字符串中与其在文本输入数据中的表示不同。以规范形式表示时：<ul style="list-style-type:disc">
                                 <li>
                                    <p>它可能受SQL <code class="codeph">NUMBER</code>的精度和范围限制。</p>
                                 </li>
                                 <li>
                                    <div class="p">如果它不受SQL <code class="codeph">NUMBER</code>限制：<ul style="list-style-type:disc">
                                          <li>
                                             <p>精度限制为四十（40）位。</p>
                                          </li>
                                          <li>
                                             <p>可选指数限制为九（9）位加上符号（ <code class="codeph">+</code>或<code class="codeph">-</code> ）。
                                             </p>
                                          </li>
                                          <li>
                                             <p>整个文本，包括可能的符号（ <code class="codeph">-</code> ， <code class="codeph">+</code> ），小数点（ <code class="codeph">.</code> ）和指数指示符（ <code class="codeph">E</code> ），限制为48个字符。
                                             </p>
                                          </li>
                                       </ul>
                                    </div>
                                 </li>
                              </ul>
                           </div>
                           <p>JSON编号的<strong class="term">规范形式</strong> ：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>是JSON号码。（它可以作为数字在JSON数据中解析。）</p>
                              </li>
                              <li>
                                 <p>没有前导加号（ <code class="codeph">+</code> ）。
                                 </p>
                              </li>
                              <li>
                                 <p>有一个小数点（ <code class="codeph">.</code> ）只在必要时。
                                 </p>
                              </li>
                              <li>
                                 <p>如果数字是一个分数（在0和1之间），则在小数点前有一个零（ <code class="codeph">0</code> ）。
                                 </p>
                              </li>
                              <li>
                                 <p>仅在必要时使用指数表示法（ <code class="codeph">E</code> ）。特别地，这可以是这种情况，如果输出字符的数目太有限（由小<code class="codeph"><span class="codeinlineitalic">N</span></code>为<code class="codeph">VARCHAR2( <span class="codeinlineitalic">N</span> )</code>
                                 </p>
                              </li>
                           </ul>
                        </li>
                     </ul>
                     <p>当返回数据类型为<code class="codeph">VARCHAR2( <span class="codeinlineitalic">N</span> )</code> ，Oracle通过在数据类型之后立即允许可选关键字<code class="codeph"><span class="bold">TRUNCATE</span></code>扩展SQL / JSON标准。当<code class="codeph">TRUNCATE</code>存在且要返回的值大于<code class="codeph"><span class="codeinlineitalic">N</span></code> ，该值将被截断 - 仅返回前<code class="codeph"><span class="codeinlineitalic">N</span></code>字符。如果缺少<code class="codeph">TRUNCATE</code> ，则将此情况视为错误，通常由错误子句或默认错误处理行为处理。
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="clauses-used-in-functions-and-conditions-for-json.html#GUID-55344240-B1F0-490A-89BF-1526FA0546D4" title="某些SQL查询函数和条件接受可选的错误子句，该子句指定处理由函数或条件引发的运行时错误。此处总结了此子句和默认行为（无错误子句）。">SQL查询函数和条件的错误子句</a></li>
                        <li><a href="function-JSON_VALUE.html#GUID-622170D8-7BAD-4F5F-86BF-C328451FC3BE" title="您可以使用SQL / JSON函数json_value来实例化用户定义的SQL对象类型或集合类型的实例。您可以通过在路径表达式中定位JSON对象或数组并分别在RETURNING子句中指定对象或集合类型来执行此操作。">使用JSON_VALUE实例化用户定义的对象类型实例</a></li>
                     </ul>
                  </div>
                  <div class="infoboxnotealso" id="GUID-DE9F29D3-1C23-4271-9DCD-E585866576D2__GUID-951909CB-055A-4427-8BA7-578C14742C55">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>有关SQL数据类型<code class="codeph">DATE</code>和<code class="codeph">TIMESTAMP</code>信息，请<a href="../sqlrf/Data-Types.html#SQLRF-GUID-7690645A-0EE3-46CA-90DE-C96DF5A01F8F" target="_blank"><span><cite>参见Oracle数据库SQL语言参考</cite></span></a></p>
                        </li>
                        <li>
                           <p>有关SQL数据类型<code class="codeph">NUMBER</code>信息，请<a href="../sqlrf/Data-Types.html#SQLRF-GUID-75209AF6-476D-4C44-A5DC-5FA70D701B78" target="_blank"><span><cite>参见Oracle数据库SQL语言参考</cite></span></a></p>
                        </li>
                        <li>
                           <p>
                              <a href="../spatl/spatial-concepts.html#SPATL-GUID-D703DF4D-57D1-4990-8F53-CAAA9C8FCB2F" target="_blank"><span><cite>Oracle Spatial and Graph Developer's Guide</cite></span></a> ，了解有关使用Oracle Spatial和Graph数据的信息</p>
                        </li>
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=geojson_org" target="_blank">GeoJSON.org</a></p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="clauses-used-in-functions-and-conditions-for-json.html#GUID-941C5E44-75C7-4BF1-BB0A-18AD48EDE9EB" title="描述了RETURNING，包装器，错误和空字段。每个用于一个或多个SQL函数和条件json_value，json_query，json_table，json_serialize，json_mergepatch，是json，不是json，json_exists和json_equal。">SQL查询函数和条件中使用的子句</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="ADXDB6285"></a><a id="ADXDB6376"></a><div class="props_rev_3"><a id="GUID-9079CD9C-3783-4857-9F6B-84D746C91317" name="GUID-9079CD9C-3783-4857-9F6B-84D746C91317"></a><h3 id="ADJSN-GUID-9079CD9C-3783-4857-9F6B-84D746C91317" class="sect3"><span class="enumeration_section">14.2</span> SQL / JSON查询函数的包装子句JSON_QUERY和JSON_TABLE</h3>
               <div>
                  <p>SQL / JSON查询函数<code class="codeph">json_query</code>和<code class="codeph">json_table</code>接受一个可选的包装子句，它指定<code class="codeph">json_query</code>返回的值的形式或用于<code class="codeph">json_table</code>列中的数据。此处描述了此子句和默认行为（无包装子句）。提供了示例。
                  </p>
                  <div class="section">
                     <p>wrapper子句采用以下形式之一：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><span class="bold"><code class="codeph">WITH WRAPPER</code></span> - 使用表示包含与路径表达式匹配的<span class="italic">所有</span> JSON值的JSON数组的字符串值。未指定数组元素的顺序。
                           </p>
                        </li>
                        <li>
                           <p><span class="bold"><code class="codeph">WITHOUT WRAPPER</code></span> - 使用表示与路径表达式匹配的<span class="italic">单个</span> JSON <span class="italic">对象</span>或<span class="italic">数组</span>的字符串值。如果路径表达式与标量值（不是对象或数组）或多个值匹配，则引发错误。
                           </p>
                        </li>
                        <li>
                           <p><span class="bold"><code class="codeph">WITH CONDITIONAL WRAPPER</code></span> - 使用表示与路径表达式匹配的<span class="italic">所有</span> JSON值的字符串值。对于零值，单个标量值或多个值， <code class="codeph">WITH CONDITIONAL WRAPPER</code> <code class="codeph">WITH WRAPPER</code>相同。对于单个JSON对象或数组值，它与<code class="codeph">WITHOUT WRAPPER</code>相同。</p>
                        </li>
                     </ul>
                     <p>默认行为是<code class="codeph">WITHOUT WRAPPER</code> 。</p>
                     <p>你可以在关键字<code class="codeph">WITH</code>之后立即添加可选关键字<span class="bold"><code class="codeph">UNCONDITIONAL</code></span> ，如果你发现它更清楚： <code class="codeph">WITH WRAPPER</code>和<code class="codeph">WITH UNCONDITIONAL WRAPPER</code>意味着同样的事情。
                     </p>
                     <p>您可以在关键字<code class="codeph">WRAPPER</code>之前添加可选关键字<span class="bold"><code class="codeph">ARRAY</code></span> ，如果您发现它更清晰： <code class="codeph">WRAPPER</code>和<code class="codeph">ARRAY WRAPPER</code>意味着相同的事情。
                     </p>
                     <p><a href="clauses-used-in-functions-and-conditions-for-json.html#GUID-9079CD9C-3783-4857-9F6B-84D746C91317__CACFFGGH" title="此4列表显示了JSON_QUERY包装子句示例。第1列列出了与路径表达式匹配的JSON值。第2列显示了包装器的值。第3列显示没有包装器的值。第4列显示了带条件包装器的值。">表14-1</a>说明了包装子句的可能性。数组包装器以<span class="bold"><code class="codeph">bold</code></span> 。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="tblformal" id="GUID-9079CD9C-3783-4857-9F6B-84D746C91317__CACFFGGH">
                     <p class="titleintable">表14-1 JSON_QUERY包装器子句示例</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="JSON_QUERY包装器子句示例" width="100%" border="1" summary="This 4 column table shows JSON_QUERY wrapper clause examples. Column 1 lists JSON Values matching path expression. Column 2 shows values with a wrapper. Column 3 shows values without a wrapper. Column 4 shows values with a conditional wrapper." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="23%" id="d15223e810">JSON值匹配路径表达式</th>
                              <th align="left" valign="bottom" width="23%" id="d15223e813">用包装纸</th>
                              <th align="left" valign="bottom" width="27%" id="d15223e816">没有包装纸</th>
                              <th align="left" valign="bottom" width="26%" id="d15223e819">带有条件的包装纸</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="23%" id="d15223e824" headers="d15223e810 ">
                                 <p><code class="codeph">{"id": 38327}</code> （单个对象）</p>
                              </td>
                              <td align="left" valign="top" width="23%" headers="d15223e824 d15223e813 ">
                                 <p><span class="bold"><code class="codeph">[</code></span> <code class="codeph">{"id": 38327}</code> <span class="bold"><code class="codeph">]</code></span></p>
                              </td>
                              <td align="left" valign="top" width="27%" headers="d15223e824 d15223e816 ">
                                 <p><code class="codeph">{“id”：38327}</code></p>
                              </td>
                              <td align="left" valign="top" width="26%" headers="d15223e824 d15223e819 ">
                                 <p><code class="codeph">{“id”：38327}</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="23%" id="d15223e848" headers="d15223e810 ">
                                 <p><code class="codeph">[42, "a", true]</code> （单个数组）</p>
                              </td>
                              <td align="left" valign="top" width="23%" headers="d15223e848 d15223e813 ">
                                 <p><span class="bold"><code class="codeph">[</code></span> <code class="codeph">[42, "a", true]</code> <span class="bold"><code class="codeph">]</code></span></p>
                              </td>
                              <td align="left" valign="top" width="27%" headers="d15223e848 d15223e816 ">
                                 <p><code class="codeph">[42，“a”，true]</code></p>
                              </td>
                              <td align="left" valign="top" width="26%" headers="d15223e848 d15223e819 ">
                                 <p><code class="codeph">[42，“a”，true]</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="23%" id="d15223e872" headers="d15223e810 ">
                                 <p><code class="codeph">42</code></p>
                              </td>
                              <td align="left" valign="top" width="23%" headers="d15223e872 d15223e813 ">
                                 <p><span class="bold"><code class="codeph">[</code></span> <code class="codeph">42</code> <span class="bold"><code class="codeph">]</code></span></p>
                              </td>
                              <td align="left" valign="top" width="27%" headers="d15223e872 d15223e816 ">
                                 <p>错误（标量）</p>
                              </td>
                              <td align="left" valign="top" width="26%" headers="d15223e872 d15223e819 ">
                                 <p><span class="bold"><code class="codeph">[</code></span> <code class="codeph">42</code> <span class="bold"><code class="codeph">]</code></span></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="23%" id="d15223e900" headers="d15223e810 ">
                                 <p><code class="codeph">42</code> ， <code class="codeph">"a"</code> ， <code class="codeph">true</code></p>
                              </td>
                              <td align="left" valign="top" width="23%" headers="d15223e900 d15223e813 ">
                                 <p><span class="bold"><code class="codeph">[</code></span> <code class="codeph">42, "a", true</code> <span class="bold"><code class="codeph">]</code></span></p>
                              </td>
                              <td align="left" valign="top" width="27%" headers="d15223e900 d15223e816 ">
                                 <p>错误（多个值）</p>
                              </td>
                              <td align="left" valign="top" width="26%" headers="d15223e900 d15223e819 ">
                                 <p><span class="bold"><code class="codeph">[</code></span> <code class="codeph">42, "a", true</code> <span class="bold"><code class="codeph">]</code></span></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="23%" id="d15223e934" headers="d15223e810 ">
                                 <p>没有</p>
                              </td>
                              <td align="left" valign="top" width="23%" headers="d15223e934 d15223e813 ">
                                 <p><span class="bold"><code class="codeph">[]</code></span></p>
                              </td>
                              <td align="left" valign="top" width="27%" headers="d15223e934 d15223e816 ">
                                 <p>错误（没有值）</p>
                              </td>
                              <td align="left" valign="top" width="26%" headers="d15223e934 d15223e819 ">
                                 <p><span class="bold"><code class="codeph">[]</code></span></p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p>例如，考虑使用<code class="codeph">json_query</code>查询来检索JSON对象。如果路径表达式匹配JSON标量值而不是对象，或者它匹配多个JSON值（任何类型），会发生什么？您可能希望检索匹配的值而不是引发错误。例如，您可能希望选择一个作为对象的值，以便进一步处理。使用数组包装器可以实现此目的。
                     </p>
                     <p>如果使用包装器的唯一原因是条件包装器可以方便地避免引发错误，并且您不需要将这些错误情况与非错误情况区分开来。如果您的应用程序正在查找单个对象或数组，并且路径表达式匹配的数据就是这样，那么就不需要在单例数组中包含该预期值。</p>
                     <p>另一方面，使用无条件包装器，您知道结果数组始终是包装器 - 您的应用程序可以依赖它。如果使用条件包装器，则应用程序可能需要额外的处理来解释返回的数组。例如，在<a href="clauses-used-in-functions-and-conditions-for-json.html#GUID-9079CD9C-3783-4857-9F6B-84D746C91317__CACFFGGH" title="此4列表显示了JSON_QUERY包装子句示例。第1列列出了与路径表达式匹配的JSON值。第2列显示了包装器的值。第3列显示没有包装器的值。第4列显示了带条件包装器的值。">表14-1中</a> ，请注意，对于与该数组匹配的路径表达式的非常不同的情况以及与其每个元素匹配的路径表达式，返回相同的数组（ <code class="codeph">[42, "a", true]</code> ）。
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="clauses-used-in-functions-and-conditions-for-json.html#GUID-941C5E44-75C7-4BF1-BB0A-18AD48EDE9EB" title="描述了RETURNING，包装器，错误和空字段。每个用于一个或多个SQL函数和条件json_value，json_query，json_table，json_serialize，json_mergepatch，是json，不是json，json_exists和json_equal。">SQL查询函数和条件中使用的子句</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="ADXDB6377"></a><div class="props_rev_3"><a id="GUID-55344240-B1F0-490A-89BF-1526FA0546D4" name="GUID-55344240-B1F0-490A-89BF-1526FA0546D4"></a><h3 id="ADJSN-GUID-55344240-B1F0-490A-89BF-1526FA0546D4" class="sect3"><span class="enumeration_section">14.3</span> SQL查询函数和条件的错误子句</h3>
               <div>
                  <p>某些SQL查询函数和条件接受可选的错误子句，该子句指定处理由函数或条件引发的运行时错误。此处总结了此子句和默认行为（无错误子句）。</p>
                  <div class="section">
                     <p>默认情况下，JSON的SQL函数和条件可避免引发运行时错误。例如，当JSON数据在语法上无效时， <code class="codeph">json_exists</code>和<code class="codeph">json_equal</code>返回false， <code class="codeph">json_value</code>返回<code class="codeph">NULL</code> 。</p>
                     <p>但在某些情况下，您还可以指定一个错误子句，该子句会覆盖默认行为。您可以指定的错误处理各不相同，但允许您指定错误处理的JSON的每个SQL函数和条件至少支持引发错误的<code class="codeph">ERROR ON ERROR</code>行为。
                     </p>
                     <p>可选的错误子句可以采用以下形式：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><span class="bold"><code class="codeph">ERROR ON ERROR</code></span> - 提高错误（无特殊处理）。
                           </p>
                        </li>
                        <li>
                           <p><span class="bold"><code class="codeph">NULL ON ERROR</code></span> - 返回<code class="codeph">NULL</code>而不是引发错误。
                           </p>
                           <p><span class="italic">不适</span>用于<code class="codeph">json_exists</code> 。
                           </p>
                        </li>
                        <li>
                           <p><span class="bold"><code class="codeph">FALSE ON ERROR</code></span> - 返回false而不是引发错误。
                           </p>
                           <p><span class="italic">仅</span>适用于<code class="codeph">json_exists</code>和<code class="codeph">json_equal</code> ，它是<span class="italic">默认值</span> 。
                           </p>
                        </li>
                        <li>
                           <p><span class="bold"><code class="codeph">TRUE ON ERROR</code></span> - 返回true而不是引发错误。
                           </p>
                           <p><span class="italic">仅</span>适用于<code class="codeph">json_exists</code>和<code class="codeph">json_equal</code> 。
                           </p>
                        </li>
                        <li>
                           <p><span class="bold"><code class="codeph">EMPTY OBJECT ON ERROR</code></span> - 返回空对象（ <code class="codeph">{}</code> ）而不是引发错误。
                           </p>
                           <p><span class="italic">仅</span>适用于<code class="codeph">json_query</code> 。
                           </p>
                        </li>
                        <li>
                           <p><span class="bold"><code class="codeph">EMPTY ARRAY ON ERROR</code></span> - 返回一个空数组（ <code class="codeph">[]</code> ）而不是引发错误。
                           </p>
                           <p><span class="italic">仅</span>适用于<code class="codeph">json_query</code> 。
                           </p>
                        </li>
                        <li>
                           <p><span class="bold"><code class="codeph">EMPTY ON ERROR</code></span> - 与<code class="codeph">EMPTY ARRAY ON ERROR</code>相同。</p>
                        </li>
                        <li>
                           <p><span class="bold"><code class="codeph">DEFAULT '</code></span> <span class="italic"><code class="codeph">literal_return_value</code></span> <span class="bold"><code class="codeph">' ON ERROR</code></span> -返回提高了错误的指定值来代替。在查询编译时，该值必须是常量。
                           </p>
                           <p><span class="italic">不</span>适用：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>对于<code class="codeph">json_exists</code> ， <code class="codeph">json_equal</code> ， <code class="codeph">json_serialize</code> ， <code class="codeph">json_mergepatch</code>或具有<code class="codeph">json_exists</code>行为的<code class="codeph">json_table</code>列值子句</p>
                              </li>
                              <li>
                                 <p>对于具有<code class="codeph">json_query</code>行为的<code class="codeph">json_query</code>或<code class="codeph">json_table</code>列值子句</p>
                              </li>
                              <li>
                                 <p>对于<code class="codeph">json_table</code> <span class="italic">行</span>级错误处理</p>
                              </li>
                              <li>
                                 <p>当<code class="codeph">SDO_GEOMETRY</code>被指定或者作为<code class="codeph">RETURNING</code> for语句数据类型<code class="codeph">json_value</code>或作为<code class="codeph">json_table</code> <span class="italic">列</span>的数据类型</p>
                              </li>
                           </ul>
                        </li>
                     </ul>
                     <p>除了条件<code class="codeph">json_exists</code>和<code class="codeph">json_equal</code>之外， <span class="italic">默认</span>行为是<code class="codeph">NULL ON ERROR</code> 。
                     </p>
                     <div class="infoboxnote" id="GUID-55344240-B1F0-490A-89BF-1526FA0546D4__GUID-F1D594C9-055A-45E5-90A0-DC3E240037F2">
                        <p class="notep1">注意：</p>
                        <p><code class="codeph">json_table</code>有两个级别的错误处理，对应于它的两个级别的路径表达式：行和列。如果存在，列错误处理程序将覆盖行级错误处理。两个级别的默认错误处理程序是<code class="codeph">NULL ON ERROR</code> 。</p>
                     </div>
                     <div class="infoboxnote" id="GUID-55344240-B1F0-490A-89BF-1526FA0546D4__GUID-B01FAA37-CA25-4DC2-820A-1FF2A210C1DA">
                        <p class="notep1">注意：</p>
                        <p><code class="codeph">ON EMPTY</code>子句会覆盖<code class="codeph">ON ERROR</code>指定的行为，以查找尝试匹配缺少字段的错误。
                        </p>
                     </div>
                     <div class="infoboxnote" id="GUID-55344240-B1F0-490A-89BF-1526FA0546D4__GUID-F142C4B2-1D3E-4570-BAFF-E55CD0658B84">
                        <p class="notep1">注意：</p>
                        <p><code class="codeph">ON ERROR</code>子句仅对语法正确的SQL / JSON路径表达式与JSON数据匹配时出现的运行时错误生效。语法错误的路径表达式导致编译时语法错误;它不是由<code class="codeph">ON ERROR</code>子句处理的。
                        </p>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section"></div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="clauses-used-in-functions-and-conditions-for-json.html#GUID-3176ECEA-BBCE-4C7C-AB24-7FCE250B8443" title="SQL / JSON查询函数json_value，json_query和json_table接受可选的ON EMPTY子句，该子句指定在查询的数据中不存在目标JSON字段时要使用的处理。此处描述了此子句和默认行为（无ON EMPTY子句）。">SQL / JSON查询函数的空字段子句</a></li>
                        <li><a href="function-JSON_TABLE.html#GUID-0172660F-CE29-4765-BF2C-C405BDE8369A" title="SQL / JSON函数json_table将特定的JSON数据投影到各种SQL数据类型的列。您可以使用它将JSON文档的各个部分映射到新虚拟表的行和列中，您也可以将其视为内联视图。">SQL / JSON函数JSON_TABLE</a></li>
                        <li><a href="function-JSON_QUERY.html#GUID-D64C7BE9-335D-449C-916D-1123539BF1FB" title="SQL / JSON函数json_query从JSON数据中选择一个或多个值，并返回表示JSON值的字符串（VARCHAR2，CLOB或BLOB实例）。因此，您可以使用json_query来检索JSON文档的片段。">SQL / JSON函数JSON_QUERY</a></li>
                        <li><a href="function-JSON_VALUE.html#GUID-0565F0EE-5F13-44DD-8321-2AC142959215" title="SQL / JSON函数json_value选择JSON数据并返回SQL标量或用户定义的SQL对象类型或SQL集合类型（varray，嵌套表）的实例。">SQL / JSON函数JSON_VALUE</a></li>
                        <li><a href="oracle-sql-function-json_serialize.html#GUID-667D37FF-F5FB-465D-B8AE-DAE88F191B2F" title="Oracle SQL函数json_serialize将JSON数据（任何SQL数据类型）作为输入，并返回它的文本表示。">Oracle SQL函数JSON_SERIALIZE</a></li>
                        <li><a href="condition-JSON_EXISTS.html#GUID-D60A7E52-8819-4D33-AEDB-223AB7BDE60A" title="SQL / JSON条件json_exists允许您使用SQL / JSON路径表达式作为行筛选器，以根据JSON文档的内容选择行。您可以在CASE表达式或SELECT语句的WHERE子句中使用条件json_exists。">SQL / JSON条件JSON_EXISTS</a></li>
                        <li><a href="clauses-used-in-functions-and-conditions-for-json.html#GUID-21FE887D-5D7B-43BB-A1A8-B26B8924B290" title="当RETURNING子句指定用户定义的对象类型或集合类型实例时，函数json_value接受可选的ON MISMATCH子句，该子句指定在目标JSON值与指定的SQL返回值不匹配时使用的处理。此处描述了此子句及其默认行为（无ON MISMATCH子句）。">关于JSON_VALUE的MISMATCH子句</a></li>
                     </ul>
                  </div>
                  <div class="infoboxnotealso" id="GUID-55344240-B1F0-490A-89BF-1526FA0546D4__GUID-D1EC21AE-A1CD-4F2C-9E90-6A3744507ADD">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>有关JSON的SQL函数的错误子句的详细信息，请<a href="../sqlrf/Single-Row-Functions.html#SQLRF-GUID-C13171B3-C070-4137-AC71-7A30BD26F380" target="_blank"><span><cite>参见Oracle数据库SQL语言参考</cite></span></a></p>
                        </li>
                        <li>
                           <p>有关JSON的SQL条件的错误子句的详细信息，请参阅<a href="../sqlrf/SQL-JSON-Conditions.html#SQLRF-GUID-08C75404-6E58-4EBE-A8B4-0B6041B0DB63" target="_blank"><span><cite>Oracle数据库SQL语言参考</cite></span></a></p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="clauses-used-in-functions-and-conditions-for-json.html#GUID-941C5E44-75C7-4BF1-BB0A-18AD48EDE9EB" title="描述了RETURNING，包装器，错误和空字段。每个用于一个或多个SQL函数和条件json_value，json_query，json_table，json_serialize，json_mergepatch，是json，不是json，json_exists和json_equal。">SQL查询函数和条件中使用的子句</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-3176ECEA-BBCE-4C7C-AB24-7FCE250B8443" name="GUID-3176ECEA-BBCE-4C7C-AB24-7FCE250B8443"></a><h3 id="ADJSN-GUID-3176ECEA-BBCE-4C7C-AB24-7FCE250B8443" class="sect3"><span class="enumeration_section">14.4</span> SQL / JSON查询函数的空字段子句</h3>
               <div>
                  <p>SQL / JSON查询函数<code class="codeph">json_value</code> ， <code class="codeph">json_query</code>和<code class="codeph">json_table</code>接受可选的<span class="bold"><code class="codeph">ON EMPTY</code></span>子句，该子句指定在查询的数据中不存在目标JSON字段时要使用的处理。此处描述了此子句和默认行为（无<code class="codeph">ON EMPTY</code>子句）。
                  </p>
                  <div class="section">
                     <p>您通常使用错误子句（ <code class="codeph">ON ERROR</code> ）处理SQL / JSON函数和条件的错误。但是，有一种特殊情况，您可能需要对此常规错误处理进行不同的处理：查询以匹配数据中缺少的给定JSON字段。有时您不希望仅因为缺少匹配的字段而引发错误。（丢失的字段通常被视为错误。）
                     </p>
                     <p>您通常将<code class="codeph">NULL ON EMPTY</code>子句与附带的<code class="codeph">ON ERROR</code>子句结合使用。此组合指定根据<code class="codeph">ON ERROR</code>子句处理其他错误，但尝试匹配缺少字段的错误仅通过返回<code class="codeph">NULL</code>来处理。如果不存在<code class="codeph">ON EMPTY</code>子句，则<code class="codeph">ON ERROR</code>子句也处理缺失字段的情况。
                     </p>
                     <p>除了<code class="codeph">NULL ON EMPTY</code>之外，还有<code class="codeph">ERROR ON EMPTY</code>和<code class="codeph">DEFAULT</code> ...<code class="codeph">ON EMPTY</code> ，类似于类似命名的<code class="codeph">ON ERROR</code>子句。
                     </p>
                     <p>如果仅存在<code class="codeph">ON EMPTY</code>子句（无<code class="codeph">ON ERROR</code>子句），则<code class="codeph">ON EMPTY</code>子句指定了缺失字段行为，并且其他错误的处理方式与存在<code class="codeph">NULL ON ERROR</code>相同（默认为<code class="codeph">ON ERROR</code> ）。如果两个子句都不存在，则仅使用<code class="codeph">NULL ON ERROR</code> 。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-3176ECEA-BBCE-4C7C-AB24-7FCE250B8443__USENULLONEMPTYFORANINDEXCREATEDONJS-38D4389A">
                     <p class="subhead2" id="GUID-3176ECEA-BBCE-4C7C-AB24-7FCE250B8443__USENULLONEMPTYFORANINDEXCREATEDONJS-38D43B2B">对JSON_VALUE上创建的索引使用NULL ON EMPTY</p>
                     <p>对于在<code class="codeph">json_value</code>表达式上创建的功能索引的情况， <code class="codeph">NULL ON EMPTY</code>特别有用。该子句对索引是否或何时被拾取没有影响，但它有效地允许一些数据被索引，否则将不会因为它缺少<code class="codeph">json_value</code>表达式所针对的字段。
                     </p>
                     <p>您通常希望对填充索引的查询使用<code class="codeph">ERROR ON ERROR</code> ，以便导致多个值或复杂值的查询路径表达式引发错误。但是，有时您不希望仅因为路径表达式所针对的字段缺失而引发错误 - 您希望将数据编入索引。<a href="indexes-for-json-data.html#GUID-FEE83855-780A-424B-9916-B899BFF2077B__GUID-A257EAA2-C71C-4F6B-A76F-CA539EACD555">例26-5</a>说明了在<code class="codeph">json_value</code>表达式上创建索引时使用<code class="codeph">NULL ON EMPTY</code> 。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section"></div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="indexes-for-json-data.html#GUID-FEE83855-780A-424B-9916-B899BFF2077B" title="您可以为SQL / JSON函数json_value创建基于函数的索引。您可以使用标准语法，显式指定函数json_value，也可以使用简单的点符号语法。以这两种方式之一创建的索引可以与点符号查询和json_value查询一起使用。">创建基于函数的JSON_VALUE索引</a></li>
                        <li><a href="clauses-used-in-functions-and-conditions-for-json.html#GUID-55344240-B1F0-490A-89BF-1526FA0546D4" title="某些SQL查询函数和条件接受可选的错误子句，该子句指定处理由函数或条件引发的运行时错误。此处总结了此子句和默认行为（无错误子句）。">SQL查询函数和条件的错误子句</a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="clauses-used-in-functions-and-conditions-for-json.html#GUID-941C5E44-75C7-4BF1-BB0A-18AD48EDE9EB" title="描述了RETURNING，包装器，错误和空字段。每个用于一个或多个SQL函数和条件json_value，json_query，json_table，json_serialize，json_mergepatch，是json，不是json，json_exists和json_equal。">SQL查询函数和条件中使用的子句</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-21FE887D-5D7B-43BB-A1A8-B26B8924B290" name="GUID-21FE887D-5D7B-43BB-A1A8-B26B8924B290"></a><h3 id="ADJSN-GUID-21FE887D-5D7B-43BB-A1A8-B26B8924B290" class="sect3"><span class="enumeration_section">14.5</span> JSON_VALUE的MISMATCH子句</h3>
               <div>
                  <p>当<code class="codeph">RETURNING</code>子句指定用户定义的对象类型或集合类型实例时，函数<code class="codeph">json_value</code>接受可选的<span class="bold"><code class="codeph">ON MISMATCH</code></span> <code class="codeph">json_value</code>子句，该子句指定在目标JSON值与指定的SQL返回值不匹配时使用的处理。此处描述了此子句及其默认行为（无<code class="codeph">ON MISMATCH</code>子句）。
                  </p>
                  <div class="section">
                     <div class="infoboxnote" id="GUID-21FE887D-5D7B-43BB-A1A8-B26B8924B290__GUID-47D5A0BC-DE63-4087-BCAC-E5AD1B989E75">
                        <p class="notep1">注意：</p>
                        <p>仅当没有JSON数据与路径表达式匹配时，才会应用<code class="codeph">ON ERROR</code>和<code class="codeph">ON EMPTY</code>子句。当与路径表达式匹配的JSON数据与指定的对象或集合返回类型不匹配时，将应用<code class="codeph">ON MISMATCH</code>子句。只有当返回类型是用户定义的对象类型或集合类型的实例时，才允许使用子句<code class="codeph">ON MISMATCH</code> 。如果将其与其他返回类型一起使用，则会引发查询编译时错误。
                        </p>
                     </div>
                     <p>当您返回反映函数<code class="codeph">json_value</code>针对的JSON数据的SQL对象或集合类型的实例时，该目标数据的定义和要返回的对象或集合必须匹配，否则将应用查询编译时错误。
                     </p>
                     <p>这种错误的<span class="italic">默认</span>处理只是<span class="italic">忽略</span>它。但是，您可以通过提供一个或多个<code class="codeph">ON MISMATCH</code>子句以各种方式处理此类错误，如下所示：</p>
                     <ul id="GUID-21FE887D-5D7B-43BB-A1A8-B26B8924B290__UL_AZW_GNJ_2GB" style="list-style-type:disc">
                        <li>
                           <p><code class="codeph"><span class="bold">IGNORE ON MISMATCH</span></code> - 明确指定默认行为：忽略不匹配。返回的对象或集合实例可能包含一个或多个SQL <code class="codeph">NULL</code>值，因为它们与目标JSON数据不匹配。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph"><span class="bold">NULL ON MISMATCH</span></code> - 返回SQL <code class="codeph">NULL</code>作为object-type或collection-type值。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph"><span class="bold">ERROR ON MISMATCH</span></code>错误 - 针对不匹配<code class="codeph"><span class="bold">ERROR ON MISMATCH</span></code>查询编译时错误。
                           </p>
                        </li>
                     </ul>
                     <p>每个<code class="codeph">ON MISMATCH</code>子句类型也可以在括号（ <code class="codeph"><span class="bold">(</span></code> ... <code class="codeph"><span class="bold">)</span></code> ）中由一个或多个子句跟随，每个子句表示要处理的一种不匹配，用逗号（ <code class="codeph"><span class="bold">,</span></code> ）分隔。这些是可能的不匹配类型：</p>
                     <ul id="GUID-21FE887D-5D7B-43BB-A1A8-B26B8924B290__UL_N5F_YQJ_2GB" style="list-style-type:disc">
                        <li>
                           <p><code class="codeph"><span class="bold">MISSING DATA</span></code> - 需要一些JSON数据来匹配对象类型或集合类型数据，但它缺失了。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph"><span class="bold">EXTRA DATA</span></code> - 一个或多个JSON字段没有对应的对象类型或集合类型数据。例如，对于JSON字段<code class="codeph">address</code> ，没有具有相同名称的object-type属性（默认情况下不区分大小写）。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph"><span class="bold">TYPE ERROR</span></code> -  JSON标量值的数据类型与相应的返回SQL标量数据类型不兼容。这可能是由于类型不兼容，如<a href="function-JSON_VALUE.html#GUID-622170D8-7BAD-4F5F-86BF-C328451FC3BE__TABLE_VTC_315_YFB" title="该表显示了哪些JSON和SQL数据类型兼容。列是JSON类型（源），SQL类型（目标）和Notes。">表16-1所示</a> ，或者因为SQL数据类型过于约束（例如， <code class="codeph">VARCHAR(2)</code>是JSON字符串<code class="codeph">"hello"</code>两个简称）。
                           </p>
                        </li>
                     </ul>
                     <p>如果给定处理程序不存在这种类型的不匹配子句（例如<code class="codeph">EXTRA DATA</code> ）（例如， <code class="codeph">NULL ON MISMATCH</code> ），则该处理程序适用于所有类型的不匹配。
                     </p>
                     <p>您可以拥有任意数量的不同类型的<code class="codeph">ON MISMATCH</code>子句，但如果两个或更多这样的子句相互矛盾，则会引发查询编译时错误。
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="function-JSON_VALUE.html#GUID-622170D8-7BAD-4F5F-86BF-C328451FC3BE" title="您可以使用SQL / JSON函数json_value来实例化用户定义的SQL对象类型或集合类型的实例。您可以通过在路径表达式中定位JSON对象或数组并分别在RETURNING子句中指定对象或集合类型来执行此操作。">使用JSON_VALUE实例化用户定义的对象类型实例</a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="clauses-used-in-functions-and-conditions-for-json.html#GUID-941C5E44-75C7-4BF1-BB0A-18AD48EDE9EB" title="描述了RETURNING，包装器，错误和空字段。每个用于一个或多个SQL函数和条件json_value，json_query，json_table，json_serialize，json_mergepatch，是json，不是json，json_exists和json_equal。">SQL查询函数和条件中使用的子句</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
         </div>
      </article>
   </body>
</html>