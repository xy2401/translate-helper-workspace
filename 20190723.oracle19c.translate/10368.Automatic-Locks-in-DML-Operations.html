<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>DML操作中的自动锁定</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="SQL Language Reference "></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="SQL Language Reference"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="sql-language-reference.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-02-12T15:36:36-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96310-02"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="Automatic-and-Manual-Locking-Mechanisms-During-SQL-Operations.html" title="Previous" type="text/html"></link>
      <link rel="next" href="Automatic-Locks-in-DDL-Operations.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="SQL Language Reference"></meta>
    <meta name="dcterms.isVersionOf" content="SQLRF"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="Automatic-and-Manual-Locking-Mechanisms-During-SQL-Operations.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="Automatic-Locks-in-DDL-Operations.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">SQL语言参考</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="Automatic-and-Manual-Locking-Mechanisms-During-SQL-Operations.html" property="item" typeof="WebPage"><span property="name">SQL操作期间的自动和手动锁定机制</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">DML操作中的自动锁定</li>
            </ol>
            <a id="GUID-3D57596F-8B73-4C80-8F4D-79A12F781EFD" name="GUID-3D57596F-8B73-4C80-8F4D-79A12F781EFD"></a><a id="SQLRF55503"></a><a id="SQLRF55504"></a><a id="SQLRF55505"></a><a id="SQLRF55506"></a><a id="SQLRF55507"></a><a id="SQLRF55508"></a><a id="SQLRF55502"></a>
            
            <h2 id="SQLRF-GUID-3D57596F-8B73-4C80-8F4D-79A12F781EFD" class="sect2">DML操作中的自动锁定</h2>
         </header>
         <div class="ind"><script type="text/javascript">window.name='Automatic-Locks-in-DML-Operations'</script><script type="text/javascript">
    function footdisplay(footnum,footnote) {
    var msg = window.open('about:blank', 'NewWindow' + footnum,
        'directories=no,height=100,location=no,menubar=no,resizable=yes,' +
        'scrollbars=yes,status=no,toolbar=no,width=598');
    msg.document.open('text/html');
    msg.document.write('<!DOCTYPE html ');
    msg.document.write('PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" ');
    msg.document.write('"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">'); 
    msg.document.write('<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us" dir="ltr"><head><title>');
   
    msg.document.write('Footnote&nbsp; ' + footnum);
    msg.document.write('<\/title><meta http-equiv="Content-Type" ');
    msg.document.write('content="text/html; charset=utf-8" />');
    msg.document.write('<meta http-equiv="Content-Script-Type" ');
    msg.document.write('content="text/javascript" />');
    msg.document.write('<style type="text/css"> <![CDATA[ ');
    msg.document.write('h1 {text-align: center; font-size: 14pt;}');
    msg.document.write('fieldset {border: none;}');
    msg.document.write('form {text-align: center;}');
    msg.document.write(' ]]u003e </style>');
    msg.document.write('<\/head><body><div id="footnote"><h1>Footnote&nbsp; ' + footnum + '<\/h1><p>');
    msg.document.write(footnote);
    msg.document.write('<\/p><form action="" method="post"><fieldset>');
    msg.document.write('<input type="button" value="OK" ');
    msg.document.write('onclick="window.close();" />');
    msg.document.write('<\/fieldset><\/form><\/div><\/body><\/html>');
    msg.document.close();
    setTimeout(function() {
        var height = msg.document.getElementById('footnote').offsetHeight;
        msg.resizeTo(598, height + 100);
    }
    , 100);
    msg.focus();
}
            </script><noscript>
               <p>此页面上的脚本内容仅用于导航目的，不会以任何方式更改内容。</p>
            </noscript>
            <div>
               <div class="section">
                  <p><a id="d448581e123" class="indexterm-anchor"></a><a id="d448581e127" class="indexterm-anchor"></a> DML锁的目的，也称为<span class="bold">数据锁</span> ，是为了保证多个用户同时访问的数据的完整性。例如，DML锁定可以防止多个客户购买在线书商提供的书籍的最后一个副本。DML锁可防止同时冲突的DML或DDL操作的破坏性干扰。
                  </p>
                  <p>DML语句自动获取表级和行级的锁。在后面的部分中，每种类型的锁定或锁定模式后括号中的首字母缩写词是Oracle Enterprise Manager的锁定监视器中使用的缩写。企业管理器可能会为任何表锁显示“TM”，而不是指示表锁的模式（例如RS或SRX）。</p>
                  <p>这里总结了行和表锁的类型。有关行和表锁类型的更完整讨论，请参阅<a href="../cncpt/data-concurrency-and-consistency.html#CNCPT1339" target="_blank"><span class="italic">Oracle数据库概念</span></a> 。
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-3D57596F-8B73-4C80-8F4D-79A12F781EFD__GUID-0D4FB99A-8654-4369-A618-F10DE05CBBD5">行锁（TX）</p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p><a id="d448581e149" class="indexterm-anchor"></a><a id="d448581e151" class="indexterm-anchor"></a><a id="d448581e155" class="indexterm-anchor"></a><a id="d448581e157" class="indexterm-anchor"></a><a id="d448581e161" class="indexterm-anchor"></a><a id="d448581e165" class="indexterm-anchor"></a> <span class="bold">行锁</span> （也称为<span class="bold">TX锁</span> ）是表的单行上的锁。事务获取由以下语句之一修改的每一行的行锁： <code class="codeph">INSERT</code> ， <code class="codeph">UPDATE</code> ， <code class="codeph">DELETE</code> ， <code class="codeph">MERGE</code>和<code class="codeph">SELECT</code> ...<code class="codeph">FOR</code> <code class="codeph">UPDATE</code> 。行锁定存在，直到事务提交或回滚。
                  </p>
                  <p>当事务获取行的行锁时，该事务还会获取该行所在表的表锁。表锁可防止冲突的DDL操作，这些操作将覆盖当前事务中的数据更改。</p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-3D57596F-8B73-4C80-8F4D-79A12F781EFD__GUID-D8DC4534-13A5-44E7-A275-0615E2453BFA">表锁（TM）</p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p><a id="d448581e206" class="indexterm-anchor"></a><a id="d448581e210" class="indexterm-anchor"></a>使用以下语句修改表时，事务会自动获取表锁（ <span class="bold">TM锁</span> ）： <code class="codeph">INSERT</code> ， <code class="codeph">UPDATE</code> ， <code class="codeph">DELETE</code> ， <code class="codeph">MERGE</code>和<code class="codeph">SELECT</code> ...<code class="codeph">FOR</code> <code class="codeph">UPDATE</code> 。这些DML操作需要表锁来代表事务保留对表的DML访问，并防止与事务冲突的DDL操作。您可以使用<code class="codeph">LOCK</code> <code class="codeph">TABLE</code>语句显式获取表锁，如<span class="q">“ <a href="Manual-Data-Locking.html#GUID-B1DE7D59-7FD1-4971-B98D-B69529DF7688">手动数据锁定</a> ”中所述</span> 。
                  </p>
                  <p>表锁可以采用以下任何一种模式进行保存：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><span class="bold">行共享锁（RS）</span> （也称为子<span class="bold">共享表锁（SS））</span>指示持有表上锁的事务已锁定表中的行并打算更新它们。SS锁是表锁的最少限制模式，为表提供最高程度的并发性。
                        </p>
                     </li>
                     <li>
                        <p><span class="bold">行独占锁（RX）</span> ，也称为<span class="bold">子</span> <span class="bold">独占</span> <span class="bold">表锁（SX）</span> ，表示持有锁的事务已更新表行或发出<code class="codeph">SELECT</code> ...<code class="codeph">FOR</code> <code class="codeph">UPDATE</code> 。 SX锁允许其他事务在同一个表中同时查询，插入，更新，删除或锁定行。因此，SX锁允许多个事务为同一个表获取同时的SX和SS锁。
                        </p>
                     </li>
                     <li>
                        <p>一个事务持有的<span class="bold">共享表锁（S）</span>允许其他事务查询表（不使用<code class="codeph">SELECT</code> ...<code class="codeph">FOR</code> <code class="codeph">UPDATE</code> ）但仅在单个事务持有共享表锁时才允许更新。多个事务可能同时持有共享表锁，因此保持此锁定不足以确保事务可以修改表。
                        </p>
                     </li>
                     <li>
                        <p><span class="bold">共享行独占表锁（SRX）</span> （也称为<span class="bold">共享 - 子</span> <span class="bold">独占表锁（</span> <span class="bold">SSX））</span>比共享表锁更具限制性。一次只有一个事务可以获取给定表上的SSX锁。事务持有的SSX锁允许其他事务查询表（ <code class="codeph">SELECT</code> ...除外）<code class="codeph">FOR</code> <code class="codeph">UPDATE</code> ）但不更新表。
                        </p>
                     </li>
                     <li>
                        <p><span class="bold">独占表锁（X）</span>是<span class="bold">表锁</span>的最严格模式，允许持有锁的事务对表进行独占写访问。只有一个事务可以获取表的X锁。
                        </p>
                     </li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-3D57596F-8B73-4C80-8F4D-79A12F781EFD__GUID-D097DF33-6008-4C7E-8ACC-11E31F763208">
                     <p class="notep1">也可以看看：</p>
                     <p><span class="q">“ <a href="Manual-Data-Locking.html#GUID-B1DE7D59-7FD1-4971-B98D-B69529DF7688">手动数据锁定</a> ”</span></p>
                  </div>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-3D57596F-8B73-4C80-8F4D-79A12F781EFD__GUID-956E97D1-633E-4682-9287-B1A9710986EE">锁定DML操作</p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p>Oracle数据库代表DML操作自动获取行级和表级锁。操作类型决定了锁定行为。<a href="Automatic-Locks-in-DML-Operations.html#GUID-3D57596F-8B73-4C80-8F4D-79A12F781EFD__BABCJIAJ" title="表锁摘要">表B-1</a>总结了本节中的信息。
                  </p>
                  <div class="infoboxnote" id="GUID-3D57596F-8B73-4C80-8F4D-79A12F781EFD__GUID-F115A6CC-36D7-451D-8556-ADAEF0F25295">
                     <p class="notep1">注意：</p>
                     <p>由于约束的副作用， <a href="Automatic-Locks-in-DML-Operations.html#GUID-3D57596F-8B73-4C80-8F4D-79A12F781EFD__BABCJIAJ" title="表锁摘要">表B-1</a>中为DML语句显示的隐式SX锁有时可能是短时间的独占（X）锁。
                     </p>
                  </div>
               </div>
               <!-- class="section" -->
               <div class="tblformal" id="GUID-3D57596F-8B73-4C80-8F4D-79A12F781EFD__BABCJIAJ">
                  <p class="titleintable">表B-1 DML语句获得的锁的摘要</p>
                  <table cellpadding="4" cellspacing="0" class="Formal" title="DML声明获得的锁定摘要" width="100%" border="1" summary="Summary of Table Locks" frame="hsides" rules="rows">
                     <thead>
                        <tr align="left" valign="top">
                           <th align="left" valign="bottom" width="46%" id="d448581e360">SQL语句</th>
                           <th align="left" valign="bottom" width="9%" id="d448581e363">行锁</th>
                           <th align="left" valign="bottom" width="9%" id="d448581e366">表锁模式</th>
                           <th align="left" valign="bottom" width="7%" id="d448581e369">RS</th>
                           <th align="left" valign="bottom" width="7%" id="d448581e372">RX</th>
                           <th align="left" valign="bottom" width="7%" id="d448581e375">小号</th>
                           <th align="left" valign="bottom" width="7%" id="d448581e378">SRX</th>
                           <th align="left" valign="bottom" width="7%" id="d448581e381">X</th>
                        </tr>
                     </thead>
                     <tbody>
                        <tr align="left" valign="top">
                           <td align="left" valign="top" width="46%" id="d448581e386" headers="d448581e360 ">
                              <p><code class="codeph">SELECT</code> ......<code class="codeph">FROM</code> <span class="italic"><code class="codeph">table</code></span> <code class="codeph">...</code></p>
                           </td>
                           <td align="left" valign="top" width="9%" headers="d448581e386 d448581e363 ">
                              <p>-</p>
                           </td>
                           <td align="left" valign="top" width="9%" headers="d448581e386 d448581e366 ">
                              <p>没有</p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e386 d448581e369 ">
                              <p>ÿ</p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e386 d448581e372 ">
                              <p>ÿ</p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e386 d448581e375 ">
                              <p>ÿ</p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e386 d448581e378 ">
                              <p>ÿ</p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e386 d448581e381 ">
                              <p>ÿ</p>
                           </td>
                        </tr>
                        <tr align="left" valign="top">
                           <td align="left" valign="top" width="46%" id="d448581e421" headers="d448581e360 ">
                              <p><code class="codeph">INSERT</code> <code class="codeph">INTO</code> <span class="italic"><code class="codeph">table</code></span> ...
                              </p>
                           </td>
                           <td align="left" valign="top" width="9%" headers="d448581e421 d448581e363 ">
                              <p>是</p>
                           </td>
                           <td align="left" valign="top" width="9%" headers="d448581e421 d448581e366 ">
                              <p>SX</p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e421 d448581e369 ">
                              <p>ÿ</p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e421 d448581e372 ">
                              <p>ÿ</p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e421 d448581e375 ">
                              <p>ñ</p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e421 d448581e378 ">
                              <p>ñ</p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e421 d448581e381 ">
                              <p>ñ</p>
                           </td>
                        </tr>
                        <tr align="left" valign="top">
                           <td align="left" valign="top" width="46%" id="d448581e455" headers="d448581e360 ">
                              <p><code class="codeph">UPDATE</code> <span class="italic"><code class="codeph">table</code></span> ...
                              </p>
                           </td>
                           <td align="left" valign="top" width="9%" headers="d448581e455 d448581e363 ">
                              <p>是</p>
                           </td>
                           <td align="left" valign="top" width="9%" headers="d448581e455 d448581e366 ">
                              <p>SX</p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e455 d448581e369 ">
                              <p>Y <a id="GUID-3D57596F-8B73-4C80-8F4D-79A12F781EFD__BABHAJFD" name="GUID-3D57596F-8B73-4C80-8F4D-79A12F781EFD__BABHAJFD" href="#GUID-3D57596F-8B73-4C80-8F4D-79A12F781EFD__BABHAJFD" yes,="" if="" no="" conflicting="" row="" locks="" are="" held="" by="" another="" transaction.="" otherwise,="" waits="" occur=")" ="" onclick="footdisplay(1, "><sup>脚1</sup></a></p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e455 d448581e372 ">
                              <p>Y <a id="fnsrc_d448581e479" name="fnsrc_d448581e479" href="#fnsrc_d448581e479" yes,="" if="" no="" conflicting="" row="" locks="" are="" held="" by="" another="" transaction.="" otherwise,="" waits="" occur=")" ="" onclick="footdisplay(1, "><sup>Footref 1</sup></a></p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e455 d448581e375 ">
                              <p>ñ</p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e455 d448581e378 ">
                              <p>ñ</p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e455 d448581e381 ">
                              <p>ñ</p>
                           </td>
                        </tr>
                        <tr align="left" valign="top">
                           <td align="left" valign="top" width="46%" id="d448581e491" headers="d448581e360 ">
                              <p><code class="codeph">MERGE</code> <code class="codeph">INTO</code> <span class="italic"><code class="codeph">table</code></span> ......
                              </p>
                           </td>
                           <td align="left" valign="top" width="9%" headers="d448581e491 d448581e363 ">
                              <p>是</p>
                           </td>
                           <td align="left" valign="top" width="9%" headers="d448581e491 d448581e366 ">
                              <p>SX</p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e491 d448581e369 ">
                              <p>ÿ</p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e491 d448581e372 ">
                              <p>ÿ</p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e491 d448581e375 ">
                              <p>ñ</p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e491 d448581e378 ">
                              <p>ñ</p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e491 d448581e381 ">
                              <p>ñ</p>
                           </td>
                        </tr>
                        <tr align="left" valign="top">
                           <td align="left" valign="top" width="46%" id="d448581e525" headers="d448581e360 ">
                              <p><code class="codeph">FROM</code> <span class="italic"><code class="codeph">table</code></span> <code class="codeph">DELETE</code> ...
                              </p>
                           </td>
                           <td align="left" valign="top" width="9%" headers="d448581e525 d448581e363 ">
                              <p>是</p>
                           </td>
                           <td align="left" valign="top" width="9%" headers="d448581e525 d448581e366 ">
                              <p>SX</p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e525 d448581e369 ">
                              <p>Y <a id="fnsrc_d448581e546" name="fnsrc_d448581e546" href="#fnsrc_d448581e546" yes,="" if="" no="" conflicting="" row="" locks="" are="" held="" by="" another="" transaction.="" otherwise,="" waits="" occur=")" ="" onclick="footdisplay(1, "><sup>Footref 1</sup></a></p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e525 d448581e372 ">
                              <p>Y <a id="fnsrc_d448581e551" name="fnsrc_d448581e551" href="#fnsrc_d448581e551" yes,="" if="" no="" conflicting="" row="" locks="" are="" held="" by="" another="" transaction.="" otherwise,="" waits="" occur=")" ="" onclick="footdisplay(1, "><sup>Footref 1</sup></a></p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e525 d448581e375 ">
                              <p>ñ</p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e525 d448581e378 ">
                              <p>ñ</p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e525 d448581e381 ">
                              <p>ñ</p>
                           </td>
                        </tr>
                        <tr align="left" valign="top">
                           <td align="left" valign="top" width="46%" id="d448581e563" headers="d448581e360 ">
                              <p><code class="codeph">SELECT</code> ......<code class="codeph">FROM</code> <span class="italic"><code class="codeph">table</code></span> <code class="codeph">FOR</code> <code class="codeph">UPDATE</code> <code class="codeph">OF</code> ...
                              </p>
                           </td>
                           <td align="left" valign="top" width="9%" headers="d448581e563 d448581e363 ">
                              <p>是</p>
                           </td>
                           <td align="left" valign="top" width="9%" headers="d448581e563 d448581e366 ">
                              <p>SX</p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e563 d448581e369 ">
                              <p>Y <a id="fnsrc_d448581e593" name="fnsrc_d448581e593" href="#fnsrc_d448581e593" yes,="" if="" no="" conflicting="" row="" locks="" are="" held="" by="" another="" transaction.="" otherwise,="" waits="" occur=")" ="" onclick="footdisplay(1, "><sup>Footref 1</sup></a></p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e563 d448581e372 ">
                              <p>Y <a id="fnsrc_d448581e598" name="fnsrc_d448581e598" href="#fnsrc_d448581e598" yes,="" if="" no="" conflicting="" row="" locks="" are="" held="" by="" another="" transaction.="" otherwise,="" waits="" occur=")" ="" onclick="footdisplay(1, "><sup>Footref 1</sup></a></p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e563 d448581e375 ">
                              <p>ñ</p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e563 d448581e378 ">
                              <p>ñ</p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e563 d448581e381 ">
                              <p>ñ</p>
                           </td>
                        </tr>
                        <tr align="left" valign="top">
                           <td align="left" valign="top" width="46%" id="d448581e610" headers="d448581e360 ">
                              <p><code class="codeph">LOCK</code> <code class="codeph">TABLE</code> <span class="italic"><code class="codeph">table</code></span> <code class="codeph">IN</code> ...
                              </p>
                           </td>
                           <td align="left" valign="top" width="9%" headers="d448581e610 d448581e363 ">
                              <p>-</p>
                           </td>
                           <td align="left" valign="top" width="9%" headers="d448581e610 d448581e366 ">
                              <p></p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e610 d448581e369 ">
                              <p></p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e610 d448581e372 ">
                              <p></p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e610 d448581e375 ">
                              <p></p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e610 d448581e378 ">
                              <p></p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e610 d448581e381 ">
                              <p></p>
                           </td>
                        </tr>
                        <tr align="left" valign="top">
                           <td align="left" valign="top" width="46%" id="d448581e641" headers="d448581e360 ">
                              <p>   <code class="codeph">ROW</code> <code class="codeph">SHARE</code> <code class="codeph">MODE</code></p>
                           </td>
                           <td align="left" valign="top" width="9%" headers="d448581e641 d448581e363 ">
                              <p></p>
                           </td>
                           <td align="left" valign="top" width="9%" headers="d448581e641 d448581e366 ">
                              <p>SS</p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e641 d448581e369 ">
                              <p>ÿ</p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e641 d448581e372 ">
                              <p>ÿ</p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e641 d448581e375 ">
                              <p>ÿ</p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e641 d448581e378 ">
                              <p>ÿ</p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e641 d448581e381 ">
                              <p>ñ</p>
                           </td>
                        </tr>
                        <tr align="left" valign="top">
                           <td align="left" valign="top" width="46%" id="d448581e673" headers="d448581e360 ">
                              <p>   <code class="codeph">ROW</code> <code class="codeph">EXCLUSIVE</code> <code class="codeph">MODE</code></p>
                           </td>
                           <td align="left" valign="top" width="9%" headers="d448581e673 d448581e363 ">
                              <p></p>
                           </td>
                           <td align="left" valign="top" width="9%" headers="d448581e673 d448581e366 ">
                              <p>SX</p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e673 d448581e369 ">
                              <p>ÿ</p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e673 d448581e372 ">
                              <p>ÿ</p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e673 d448581e375 ">
                              <p>ñ</p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e673 d448581e378 ">
                              <p>ñ</p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e673 d448581e381 ">
                              <p>ñ</p>
                           </td>
                        </tr>
                        <tr align="left" valign="top">
                           <td align="left" valign="top" width="46%" id="d448581e705" headers="d448581e360 ">
                              <p>   <code class="codeph">SHARE</code> <code class="codeph">MODE</code></p>
                           </td>
                           <td align="left" valign="top" width="9%" headers="d448581e705 d448581e363 ">
                              <p></p>
                           </td>
                           <td align="left" valign="top" width="9%" headers="d448581e705 d448581e366 ">
                              <p>小号</p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e705 d448581e369 ">
                              <p>ÿ</p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e705 d448581e372 ">
                              <p>ñ</p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e705 d448581e375 ">
                              <p>ÿ</p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e705 d448581e378 ">
                              <p>ñ</p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e705 d448581e381 ">
                              <p>ñ</p>
                           </td>
                        </tr>
                        <tr align="left" valign="top">
                           <td align="left" valign="top" width="46%" id="d448581e734" headers="d448581e360 ">
                              <p>   <code class="codeph">SHARE</code> <code class="codeph">ROW</code> <code class="codeph">EXCLUSIVE</code> <code class="codeph">MODE</code></p>
                           </td>
                           <td align="left" valign="top" width="9%" headers="d448581e734 d448581e363 ">
                              <p></p>
                           </td>
                           <td align="left" valign="top" width="9%" headers="d448581e734 d448581e366 ">
                              <p>SSX</p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e734 d448581e369 ">
                              <p>ÿ</p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e734 d448581e372 ">
                              <p>ñ</p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e734 d448581e375 ">
                              <p>ñ</p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e734 d448581e378 ">
                              <p>ñ</p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e734 d448581e381 ">
                              <p>ñ</p>
                           </td>
                        </tr>
                        <tr align="left" valign="top">
                           <td align="left" valign="top" width="46%" id="d448581e770" headers="d448581e360 ">
                              <p>   <code class="codeph">EXCLUSIVE</code> <code class="codeph">MODE</code></p>
                           </td>
                           <td align="left" valign="top" width="9%" headers="d448581e770 d448581e363 ">
                              <p></p>
                           </td>
                           <td align="left" valign="top" width="9%" headers="d448581e770 d448581e366 ">
                              <p>X</p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e770 d448581e369 ">
                              <p>ñ</p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e770 d448581e372 ">
                              <p>ñ</p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e770 d448581e375 ">
                              <p>ñ</p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e770 d448581e378 ">
                              <p>ñ</p>
                           </td>
                           <td align="left" valign="top" width="7%" headers="d448581e770 d448581e381 ">
                              <p>ñ</p>
                           </td>
                        </tr>
                     </tbody>
                  </table>
               </div>
               <!-- class="inftblhruleinformal" -->
               <p class="tablefootnote"><sup class="tablefootnote">脚注1</sup></p><p>是的，如果另一个事务没有保留冲突的行锁。否则，等待发生。</p>
               <p></p>
               <div class="section">
                  <p class="subhead1" id="GUID-3D57596F-8B73-4C80-8F4D-79A12F781EFD__GUID-08155532-E89C-4290-86CA-D3B3C9FE4CB7">查询行时锁定</p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p><a id="d448581e803" class="indexterm-anchor"></a>查询可以是显式的，如在<code class="codeph">SELECT</code>语句中，也可以是隐式的，如在大多数<code class="codeph">INSERT</code> ， <code class="codeph">MERGE</code> ， <code class="codeph">UPDATE</code>和<code class="codeph">DELETE</code>语句中一样。唯一不一定包含查询组件的DML语句是带有<code class="codeph">VALUES</code>子句的<code class="codeph">INSERT</code>语句。因为查询只读取数据，所以它们是最不可能干扰其他SQL语句的SQL语句。
                  </p>
                  <p>以下特征适用于<span class="italic">没有</span> <code class="codeph">FOR</code> <code class="codeph">UPDATE</code>子句的查询：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>查询不获取数据锁。因此，其他事务可以查询和更新正在查询的表，包括正在查询的特定行。因为没有<code class="codeph">FOR</code> <code class="codeph">UPDATE</code>子句的查询不会获取任何数据锁来阻止其他操作，所以此类查询通常称为<span class="bold">非阻塞查询</span> 。
                        </p>
                     </li>
                     <li>
                        <p>查询不必等待释放任何数据锁。因此，查询始终可以继续。此规则的一个例外是查询可能必须在某些特定的待处理分布式事务的情况下等待数据锁定。</p>
                     </li>
                  </ul>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-3D57596F-8B73-4C80-8F4D-79A12F781EFD__GUID-4E58A092-C37C-4787-AAC1-1034F2F199E9">行修改时锁定</p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p>某些数据库使用锁管理器来维护内存中的锁列表。相反，Oracle数据库将锁信息存储在包含锁定行的数据块中。每个行锁仅影响一行。</p>
                  <p>Oracle数据库使用排队机制来获取行锁。如果事务需要行锁定，并且该行尚未锁定，则事务会在行的数据块中获取锁定。事务本身在块头的<span class="bold">感兴趣的事务列表（ITL）</span>部分中有一个条目。此事务修改的每一行都指向存储在ITL中的事务ID的副本。因此，由单个事务修改的同一块中的100行需要100个行锁，但是所有100行引用单个事务ID。</p>
                  <p>当事务结束时，事务ID保留在数据块头的ITL部分中。如果新事务要修改行，则它使用事务ID来确定锁是否处于活动状态。如果锁是活动的，那么新事务的会话要求在释放锁时通知;否则，新交易获得锁定。</p>
                  <p><code class="codeph">INSERT</code> ， <code class="codeph">UPDATE</code> ， <code class="codeph">DELETE</code>和<code class="codeph">SELECT</code> ......<code class="codeph">FOR</code> <code class="codeph">UPDATE</code>语句如下：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>包含DML语句的事务在由语句修改的行上获取独占行锁。因此，在锁定事务提交或回滚之前，其他事务无法更新或删除锁定的行。</p>
                     </li>
                     <li>
                        <p>除了这些行锁之外，包含修改数据的DML语句的事务还需要在包含受影响行的表上至少包含一个子例外表锁（SX）。如果事务已经拥有表的S，SRX或X表锁（比SX锁更严格），则不需要SX锁，也不会获取。但是，如果包含的事务只包含SS锁，则Oracle数据库会自动将SS锁转换为SX锁。</p>
                     </li>
                     <li>
                        <p>包含DML语句的事务不需要对子查询或隐式查询选择的任何行执行行锁定。</p>
                        <p>在以下示例<code class="codeph">UPDATE</code>语句中，括号中的<code class="codeph">SELECT</code>语句是子查询，而<code class="codeph">WHERE a &gt; 5</code>子句是隐式查询：</p><pre class="oac_no_warn" dir="ltr">UPDATE t SET x =（SELECT y FROM t2 WHERE t2.z = tz）WHERE a&gt; 5;</pre><p>DML语句中的子查询或隐式查询保证在查询开始时是一致的，并且不会看到它构成其一部分的DML语句的效果。</p>
                     </li>
                     <li>
                        <p>事务中的查询可以查看先前DML语句在同一事务中所做的更改，但不能查看其他事务的未提交更改。</p>
                     </li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-3D57596F-8B73-4C80-8F4D-79A12F781EFD__GUID-C56E4549-25CE-495E-AA90-FB46AAE986E3">
                     <p class="notep1">也可以看看：</p>
                     <p>有关外键锁定的信息，请参阅<a href="../cncpt/data-concurrency-and-consistency.html#CNCPT1359" target="_blank"><span class="italic">Oracle数据库概念</span></a></p>
                  </div>
               </div>
               <!-- class="section" -->
            </div>
         </div>
      </article>
   </body>
</html>