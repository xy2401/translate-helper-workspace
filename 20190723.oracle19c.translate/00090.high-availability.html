<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>高可用性</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Database Development Guide"></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Database Development Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="database-development-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-31T23:23:15-08:00"></meta>
      <meta name="dcterms.title" content="Database Development Guide"></meta>
      <meta name="dcterms.dateCopyrighted" content="1996, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96334-02"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="security.html" title="Previous" type="text/html"></link>
      <link rel="next" href="advanced_plsql_features.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="ADFNS"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="security.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="advanced_plsql_features.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">数据库开发指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="fundamentals.html" property="item" typeof="WebPage"><span property="name">数据库开发基础</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">高可用性</li>
            </ol>
            <a id="GUID-9DB4AA4F-8273-4761-9A51-7FAD6F8298F0" name="GUID-9DB4AA4F-8273-4761-9A51-7FAD6F8298F0"></a><a id="ADFNS916"></a><a id="ADFNS915"></a>
            
            <h2 id="ADFNS-GUID-9DB4AA4F-8273-4761-9A51-7FAD6F8298F0" class="sect2"><span class="enumeration_chapter">6</span>高可用性</h2>
         </header>
         <div class="ind">
            <div>
               <p>本章介绍如何在数据库和数据库应用程序中设计高可用性。</p>
               <div class="section">
                  <p class="subhead1" id="GUID-9DB4AA4F-8273-4761-9A51-7FAD6F8298F0__GUID-212D94F0-7D69-4361-BF34-7C3BECDBA50B">话题：</p>
               </div>
               <!-- class="section" -->
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="high-availability.html#GUID-96599425-9BDA-483C-9BA2-4A4D13013A37">透明应用程序故障转移（TAF）</a></p>
                  </li>
                  <li>
                     <p><a href="high-availability.html#GUID-1F5A0587-3BCD-492C-BF86-ECBF7EE07A3E" title="此功能允许在Traffic Director模式下配置Oracle数据库连接管理器（CMAN），以便为连接到不同数据库服务的客户端提供服务，HA和性能功能可在路由器级别进行配置，从而使所有连接的客户端受益。">流量控制器模式下的Oracle连接管理器</a></p>
                  </li>
                  <li>
                     <p><a href="high-availability.html#GUID-F3FBE48B-468B-4393-8B0C-D5C8E0E4374D">快速应用程序通知（FAN）和快速连接故障转移（FCF）</a></p>
                  </li>
                  <li>
                     <p><a href="high-availability.html#GUID-4A142A4C-088F-42F5-84C2-C3883052CF67" title="应用程序连续性是用于故障转移的DBA功能。Transaction Guard是一种用于自行编码故障转移的开发人员功能。">应用程序连续性和事务保护</a></p>
                  </li>
                  <li>
                     <p><a href="high-availability.html#GUID-799A6C37-32B5-4785-AEB0-49C9AFA6F4EE">数据库云的服务和负载管理</a></p>
                  </li>
               </ul>
            </div>
            <div class="props_rev_3"><a id="GUID-96599425-9BDA-483C-9BA2-4A4D13013A37" name="GUID-96599425-9BDA-483C-9BA2-4A4D13013A37"></a><h3 id="ADFNS-GUID-96599425-9BDA-483C-9BA2-4A4D13013A37" class="sect3">透明应用程序故障转移（TAF）</h3>
               <div>
                  <p>本节介绍透明应用程序故障转移（TAF）是什么，如何配置TAF，以及使用TAF回调在生成事件时通知应用程序。</p>
                  <div class="section">
                     <p class="subhead2" id="GUID-96599425-9BDA-483C-9BA2-4A4D13013A37__GUID-8EEAC49E-2259-41BA-B2A9-6B54F0335F47">话题：</p>
                  </div>
                  <!-- class="section" -->
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="high-availability.html#GUID-AF2A0A43-6B38-40DD-8954-55BF02BB9703">关于透明应用程序故障转移</a></p>
                     </li>
                     <li>
                        <p><a href="high-availability.html#GUID-3A7D4F7E-6E1C-41ED-B39F-86837E4A2B70">配置透明应用程序故障转移</a></p>
                     </li>
                     <li>
                        <p><a href="high-availability.html#GUID-8DAB53D8-5761-42A5-BF4C-B38FDE9D7C1E">使用透明应用程序故障转移回调</a></p>
                     </li>
                  </ul>
               </div>
               <div class="props_rev_3"><a id="GUID-AF2A0A43-6B38-40DD-8954-55BF02BB9703" name="GUID-AF2A0A43-6B38-40DD-8954-55BF02BB9703"></a><h4 id="ADFNS-GUID-AF2A0A43-6B38-40DD-8954-55BF02BB9703" class="sect4">关于透明应用程序故障转移</h4>
                  <div>
                     <p>透明应用程序故障转移（TAF）是OCI，OCCI，Java数据库连接（JDBC）OCI驱动程序和ODP.NET的客户端功能，旨在最大程度地减少由于实例或网络导致数据库连接失败时发生的对最终用户应用程序的中断失败。TAF可以在各种系统配置上实施，包括Oracle Real Application Clusters（Oracle RAC），Oracle Data Guard物理备用数据库，以及重启后的单实例系统（例如，在进行修复时）。</p>
                     <p>TAF使客户端应用程序能够自动（透明地）重新连接到预配置的辅助实例，从而创建新连接，但与在第一个原始实例上建立的连接相同。也就是说，无论连接如何丢失，连接属性都与早期连接的属性相同。在这种情况下，活动事务回滚。此外，应用程序在尝试失败后尝试使用的所有语句也会进行故障转移。</p>
                     <div class="infoboxnotealso" id="GUID-AF2A0A43-6B38-40DD-8954-55BF02BB9703__GUID-68A9DDF5-2ABB-496E-9E6F-93AF99D4CA18">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>有关OCI TAF的更多信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNOCI16679" target="_blank"><span class="italic">Oracle Call Interface Programmer's Guide</span></a></p>
                           </li>
                           <li>
                              <p>有关OCCI TAF的更多信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNCPP20011" target="_blank"><span class="italic">Oracle C ++调用接口程序员指南</span></a></p>
                           </li>
                           <li>
                              <p>有关JDBC TAF的更多信息，请参见<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=JJDBC27000" target="_blank"><span class="italic">“Oracle数据库JDBC开发人员指南”</span></a></p>
                           </li>
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=ODPNT-GUID-0A08E9F6-AE33-4AB0-B2D1-31EB263C3544" target="_blank"><span><cite>适用于.NET的Oracle数据提供程序开发人员指南（适用于Microsoft Windows）</cite></span></a> ，以获取有关ODP.NET TAF的更多信息</p>
                           </li>
                           <li>
                              <p>有关TAF客户端配置的更多信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=NETRF279" target="_blank"><span class="italic">Oracle数据库网络服务参考</span></a> （连接数据部分）</p>
                           </li>
                           <li>
                              <p>有关TAF（ <code class="codeph">DBMS_SERVICE</code> ）服务器端配置的更多信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=ARPLS092" target="_blank"><span class="italic">Oracle数据库PL / SQL包和类型参考</span></a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-3A7D4F7E-6E1C-41ED-B39F-86837E4A2B70" name="GUID-3A7D4F7E-6E1C-41ED-B39F-86837E4A2B70"></a><h4 id="ADFNS-GUID-3A7D4F7E-6E1C-41ED-B39F-86837E4A2B70" class="sect4">配置透明应用程序故障转移</h4>
                  <div>
                     <div class="section">
                        <p>可以在客户端和服务器端配置TAF，如果配置了客户端和服务器端，则服务器端优先。在客户端，通过在连接描述符的<code class="codeph">CONNECT_DATA</code>部分中包含<code class="codeph">FAILOVER_MODE</code>参数来配置TAF。在服务器端，通过使用<code class="codeph">DBMS_SERVICE.MODIFY_SERVICE</code>打包过程修改目标服务来配置TAF。
                        </p>
                        <div class="p">
                           <div class="infoboxnotealso" id="GUID-3A7D4F7E-6E1C-41ED-B39F-86837E4A2B70__GUID-5A98A467-CCAF-4291-8A05-805529D7B14E">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><a href="high-availability.html#GUID-AF2A0A43-6B38-40DD-8954-55BF02BB9703">关于透明应用程序故障转移</a>有关配置的更多信息</p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-8DAB53D8-5761-42A5-BF4C-B38FDE9D7C1E" name="GUID-8DAB53D8-5761-42A5-BF4C-B38FDE9D7C1E"></a><h4 id="ADFNS-GUID-8DAB53D8-5761-42A5-BF4C-B38FDE9D7C1E" class="sect4">使用透明应用程序故障转移回调</h4>
                  <div>
                     <div class="section">
                        <p>TAF回调是在故障转移时注册的回调，在故障转移期间调用，以在生成事件时通知应用程序。在重新建立用户会话时，会多次调用它们。</p>
                        <p>作为应用程序开发人员，您可能希望通知用户故障转移正在进行中，因为故障转移过程会略有延迟。对回调的第一次调用执行该功能。此外，当故障转移成功并且重新建立连接时，您可能希望通知用户已发生故障转移，然后您可能希望重播<code class="codeph">ALTER SESSION</code>命令，因为这些命令不会在第二个实例上自动重播。随后对回调的调用将执行该功能。此外，如果故障转移不成功，则您希望通知应用程序无法进行故障转移。对回调的第三次调用也执行此功能。
                        </p>
                        <p>使用TAF回调可以：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p>在整个故障转移过程中通知用户故障转移的状态;故障转移正在进行时，故障转移成功时以及故障转移失败时</p>
                           </li>
                           <li>
                              <p>需要时重播<code class="codeph">ALTER SESSION</code>命令</p>
                           </li>
                           <li>
                              <p>每次会话在新连接上开始时，重新验证主句柄旁边的用户句柄。由于每个用户句柄代表服务器端会话，因此客户端可能希望重播该会话的<code class="codeph">ALTER SESSION</code>命令。
                              </p>
                           </li>
                        </ul>
                        <div class="infoboxnotealso" id="GUID-8DAB53D8-5761-42A5-BF4C-B38FDE9D7C1E__GUID-B552CC12-189B-41B6-95EC-B3F5B7F7C1C7">
                           <p class="notep1">也可以看看：</p>
                           <p> 为每个接口的特定回调注册信息<a href="high-availability.html#GUID-3A7D4F7E-6E1C-41ED-B39F-86837E4A2B70">配置透明应用程序故障转移</a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-1F5A0587-3BCD-492C-BF86-ECBF7EE07A3E" name="GUID-1F5A0587-3BCD-492C-BF86-ECBF7EE07A3E"></a><h3 id="ADFNS-GUID-1F5A0587-3BCD-492C-BF86-ECBF7EE07A3E" class="sect3">流量控制器模式下的Oracle连接管理器</h3>
               <div>
                  <p>此功能允许在Traffic Director模式下配置Oracle数据库连接管理器（CMAN），以便为连接到不同数据库服务的客户端提供服务，HA和性能功能可在路由器级别进行配置，从而使所有连接的客户端受益。</p>
                  <p>从Oracle Database 18.1发布开始，流量控制器模式下的Oracle Connection Manager提供以下支持：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>透明的性能增强和连接多路复用</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>通过Traffic Director模式实例中的多个CMAN，应用程序可通过客户端连接时负载平衡或负载均衡器（BIG-IP，NGINX等）提高可扩展性</p>
                           </li>
                        </ul>
                     </li>
                     <li>
                        <p>零应用程序停机时间包括：计划数据库维护或可插拔数据库（PDB）重定位和计划外数据库中断，用于主要读取工作负载。</p>
                     </li>
                     <li>
                        <p>流量控制器模式下CMAN的高可用性，以避免单点故障。</p>
                     </li>
                     <li>
                        <p>安全性和隔离性：交通指挥模式下的CMAN提供：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>数据库代理支持传输控制协议/传输控制协议安全（TCP / TCPS）和协议转换</p>
                           </li>
                           <li>
                              <p>防火墙基于IP地址，服务名称和安全套接字层/传输层安全性（SSL / TLS）钱包</p>
                           </li>
                           <li>
                              <p>多租户环境中的租户隔离</p>
                           </li>
                           <li>
                              <p>防止拒绝服务和模糊测试攻击</p>
                           </li>
                           <li>
                              <p>跨Oracle数据库本地和Oracle Cloud安全地隧道传输数据库流量</p>
                           </li>
                        </ul>
                     </li>
                  </ul>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=DBSEG-GUID-0C753164-99C5-49A6-9EF3-428B187C6511" title="有关CONNECT THROUGH的更多信息" target="_blank"><span><cite>Oracle数据库安全指南</cite></span> </a></li>
                        <li><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=NETAG-GUID-E599547C-2AE3-4383-93A4-DC45C707467D" title="有关cman.ora文件的更多信息" target="_blank"><span><cite>Oracle数据库网络服务管理员指南</cite></span></a></li>
                        <li><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=NETAG-GUID-B5682078-2DAB-4925-86F6-F66704FB0CCD" title="有关cman.ora日志参数的详细信息" target="_blank"><span><cite>Oracle数据库网络服务管理员指南</cite></span></a></li>
                        <li><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=NETAG-GUID-18E96DB7-00D4-44C6-B541-0B61B488A2DF" title="有关cman.ora日志参数的详细信息" target="_blank"><span><cite>Oracle数据库网络服务管理员指南</cite></span></a></li>
                     </ul>
                  </div>
               </div>
            </div><a id="ADFNS537"></a><a id="ADFNS923"></a><div class="props_rev_3"><a id="GUID-F3FBE48B-468B-4393-8B0C-D5C8E0E4374D" name="GUID-F3FBE48B-468B-4393-8B0C-D5C8E0E4374D"></a><h3 id="ADFNS-GUID-F3FBE48B-468B-4393-8B0C-D5C8E0E4374D" class="sect3">快速应用程序通知（FAN）和快速连接故障转移（FCF）</h3>
               <div>
                  <p>本节介绍快速应用程序通知（FAN）和快速连接故障转移（FCF）以及应用程序如何响应高可用性环境中的FAN事件以及如何在故障转移后使用FCF重新定位连接。</p>
                  <div class="section">
                     <p class="subhead2" id="GUID-F3FBE48B-468B-4393-8B0C-D5C8E0E4374D__GUID-AF40E280-E7E0-4CBC-83E5-ECF84E6008C0">话题：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="high-availability.html#GUID-336F5782-977E-4876-AC7E-AF2F566D91FA">关于快速申请通知（FAN）</a></p>
                        </li>
                        <li>
                           <p><a href="high-availability.html#GUID-978B5085-9A7D-42AF-8D81-DA674F9F63B8">关于接收FAN事件通知</a></p>
                        </li>
                        <li>
                           <p><a href="high-availability.html#GUID-A6E073A2-9D3E-4A05-90F4-5AB51291484F">关于快速连接故障转移（FCF）</a></p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div><a id="ADFNS538"></a><div class="props_rev_3"><a id="GUID-336F5782-977E-4876-AC7E-AF2F566D91FA" name="GUID-336F5782-977E-4876-AC7E-AF2F566D91FA"></a><h4 id="ADFNS-GUID-336F5782-977E-4876-AC7E-AF2F566D91FA" class="sect4">关于快速申请通知（FAN）</h4>
                  <div>
                     <p>高可用性的一个重要组成部分是称为快速应用程序通知（FAN）的通知机制。FAN通知其他进程有关包括服务状态更改的配置和服务级别信息，例如UP或DOWN事件。应用程序可以响应FAN事件并立即采取措施。FAN UP和DOWN事件可以应用于实例，服务和节点。</p>
                     <p>FAN提供在实例或服务器发生故障时立即终止活动事务的功能。FAN集成Oracle客户端接收事件并做出响应。应用程序可以通过将错误传播给用户或通过重新提交事务并从应用程序用户屏蔽错误来响应。发生DOWN事件时，FAN集成客户端会立即清除与已终止数据库的连接。发生UP事件时，FAN集成客户端会创建与新主数据库实例的新连接。</p>
                     <p>Oracle已将FAN与许多常见的Oracle客户端驱动程序集成在一起。因此，使用FAN的最简单方法是使用以下集成Oracle客户端之一：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>OCI会话池</p>
                        </li>
                        <li>
                           <p>Java的通用连接池</p>
                        </li>
                        <li>
                           <p>精简JDBC驱动程序（12.2及更高版本）</p>
                        </li>
                        <li>
                           <p>ODP.NET托管和非托管提供商</p>
                        </li>
                        <li>
                           <p>所有WebLogic服务器数据源和Oracle Tuxedo</p>
                        </li>
                     </ul>
                     <p>总体目标是使应用程序能够随时始终获得与可用主数据库的连接。</p>
                     <p>使用Oracle Notification Service发布FAN事件。发布机制自动配置为Oracle RAC安装的一部分。此处，Oracle RAC安装意味着使用Oracle RAC，Oracle RAC One Node，Oracle Data Guard（快速启动故障转移）或带有Oracle Clusterware的Oracle Data Guard单一实例安装任何Oracle Clusterware。从Oracle Database <span class="italic">12c</span>第1版（12.1）开始，ONS是新客户端（Oracle Database <span class="italic">12c</span>第1版（12.1））和新服务器（Oracle Database <span class="italic">12c</span>第1版（12.1））的主要通知机制，而的AQ HA通知功能已被废弃，仅保持或当存在一个较旧的或OCI ODP.NET管理的客户端的向后兼容性（预Oracle数据库12 <span class="italic">c</span>解除1（12.1））或旧的服务器（预Oracle数据库12 <span class="italic">c</span>解除1 （12.1））。
                     </p>
                     <p>使用JDBC或Oracle Database 12 <span class="italic">c</span>第1版（12.1.0.1）OCI或ODP.NET客户端时，将使用您的TNS自动配置Oracle Notification Service。使用基于OCI的客户端时，请为您的服务设置HA通知（ <code class="codeph">-notification = TRUE</code> ），并在<code class="codeph">oraccess.xml</code>设置EVENTS。
                     </p>
                     <div class="infoboxnotealso" id="GUID-336F5782-977E-4876-AC7E-AF2F566D91FA__GUID-B0CF9D99-82F7-47DD-910E-FFCCD973E654">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>有关FAN的更多信息，请参见<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=RACAD7128" target="_blank"><span class="italic">“Oracle Real Application Clusters管理和部署指南”</span></a></p>
                           </li>
                           <li>
                              <p>有关在Oracle Restart环境中启用FAN事件的信息，请参见<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=ADMIN13312" target="_blank"><span class="italic">“Oracle数据库管理员指南”</span></a></p>
                           </li>
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNOCI09100" target="_blank"><span class="italic">“Oracle调用接口程序员指南”</span></a> ，了解有关接收运行时连接负载平衡的更多信息建议FAN事件，以平衡Oracle RAC环境中的应用程序会话请求，并设置和启用Oracle Clusterware</p>
                           </li>
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNCPP20028" target="_blank"><span class="italic">Oracle C ++调用接口程序员指南</span></a> ，了解有关使用Oracle RAC负载平衡通报分发的服务指标的无状态连接池的运行时负载平衡的更多信息</p>
                           </li>
                           <li>
                              <p>有关快速连接故障转移的详细信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=JJDBC26000" target="_blank"><span class="italic">参见Oracle数据库JDBC开发人员指南</span></a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-978B5085-9A7D-42AF-8D81-DA674F9F63B8" name="GUID-978B5085-9A7D-42AF-8D81-DA674F9F63B8"></a><h4 id="ADFNS-GUID-978B5085-9A7D-42AF-8D81-DA674F9F63B8" class="sect4">关于接收FAN事件通知</h4>
                  <div>
                     <p></p>
                     <p>从Oracle Database 12c第2版（12.2）开始，如果不将通用连接池或Oracle WebLogic Server与Active Grid一起使用，则Oracle RAC FAN API提供了利用Oracle数据库的高可用性（HA）功能的替代方案。链接（AGL）。此功能取决于Oracle Notification System（ONS）消息传输机制。</p>
                     <p>此功能需要将系统，服务器和客户端配置为使用ONS。要使用Oracle RAC快速应用程序通知，必须在<code class="codeph">CLASSPATH</code>存在<code class="codeph">simplefan.jar</code>文件，并且必须在<code class="codeph">CLASSPATH</code>存在<code class="codeph">ons.jar</code>文件，或者必须在客户端中安装并运行Oracle Notification Services（ONS）客户端系统。
                     </p>
                     <div class="infoboxnotealso" id="GUID-978B5085-9A7D-42AF-8D81-DA674F9F63B8__GUID-17E4382B-3FE2-49D5-8D1D-08A912D8A1D5">
                        <p class="notep1">也可以看看：</p>
                        <p>有关Oracle RAC FAN API的更多信息，请参见<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=JJDBC-GUID-672941ED-9553-4779-B1AD-7FEBC07603D6" target="_blank"><span><cite>“Oracle数据库JDBC开发人员指南”</cite></span></a> 。</p>
                     </div>
                  </div>
               </div><a id="ADFNS539"></a><div class="props_rev_3"><a id="GUID-A6E073A2-9D3E-4A05-90F4-5AB51291484F" name="GUID-A6E073A2-9D3E-4A05-90F4-5AB51291484F"></a><h4 id="ADFNS-GUID-A6E073A2-9D3E-4A05-90F4-5AB51291484F" class="sect4">关于快速连接故障转移（FCF）</h4>
                  <div>
                     <p>在具有备用数据库的配置中，在将Oracle Notification Services（ONS）添加到Oracle Restart配置并为您的服务启用Oracle Advanced Queuing（AQ）HA通知之后，您可以启用客户端以进行快速连接故障转移（FCF）。然后，客户端接收FAN事件，并在Oracle Data Guard故障转移后重新定位到当前主数据库的连接。从Oracle Database <span class="italic">12c</span>第1版（12.1）开始，ONS是新客户端（Oracle Database <span class="italic">12c</span>第1版（12.1））和新服务器（Oracle Database <span class="italic">12c</span>第1版（12.1））的主要通知机制，而不建议使用AQ HA通知功能，以便在存在旧客户端（Oracle Database <span class="italic">12c之前</span>版本1（12.1））或旧服务器（Oracle Database <span class="italic">12c之前</span>版本1（12.1））时向后兼容。
                     </p>
                     <p>对于未配置备用数据库的数据库，您仍可以配置客户端FAN事件。发生中断（计划内或计划外）时，可以将客户端配置为重试与数据库的连接。由于Oracle Restart重新启动发生故障的数据库，因此客户端可以在数据库重新启动时重新连接。</p>
                     <p>必须启用FAN事件，才能在没有备用数据库的Oracle Data Guard或独立环境中为FCF提供FAN集成客户端支持。</p>
                     <p>FCF为Java数据库连接（JDBC）应用程序提供了一种独立于驱动程序的方式，以利用Oracle数据库提供的连接故障转移功能。FCF与隐式连接缓存和Oracle RAC集成，以提供高可用性事件通知。</p>
                     <p>OCI客户端可以通过注册接收有关Oracle Restart高可用性FAN事件的通知来启用FCF，并在事件发生时进行响应。这样可以改善OCI中的会话故障转移响应时间，并从连接和会话池中删除已终止的连接。此功能适用于OCI应用程序，包括使用透明应用程序故障转移（TAF），连接池或会话池的应用程序。</p>
                     <div class="infoboxnotealso" id="GUID-A6E073A2-9D3E-4A05-90F4-5AB51291484F__GUID-0C395ECD-FEF9-4D21-8D2A-2DCDFA175F9A">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNCPP20028" target="_blank"><span class="italic">Oracle C ++调用接口程序员指南</span></a> ，了解有关使用Oracle RAC负载平衡通报分发的服务指标的无状态连接池的运行时负载平衡的更多信息</p>
                           </li>
                           <li>
                              <p>有关快速连接故障转移的详细信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=JJDBC26000" target="_blank"><span class="italic">参见Oracle数据库JDBC开发人员指南</span></a></p>
                           </li>
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=JJUAR" target="_blank"><span class="italic">用于JDBC Java API参考的Oracle通用连接池</span></a></p>
                           </li>
                           <li>
                              <p>有关为JDBC客户端启用FCF的信息，请参见<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=ADMIN13194" target="_blank"><span class="italic">“Oracle数据库管理员指南”</span></a></p>
                           </li>
                           <li>
                              <p>有关为OCI客户端启用FCF的信息，请参见<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=ADMIN13195" target="_blank"><span class="italic">“Oracle数据库管理员指南”</span></a></p>
                           </li>
                           <li>
                              <p>有关为ODP.NET客户端启用FCF的信息，请参见<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=ADMIN13196" target="_blank"><span class="italic">“Oracle数据库管理员指南”</span></a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div>
            </div><a id="ADFNS924"></a><div class="props_rev_3"><a id="GUID-4A142A4C-088F-42F5-84C2-C3883052CF67" name="GUID-4A142A4C-088F-42F5-84C2-C3883052CF67"></a><h3 id="ADFNS-GUID-4A142A4C-088F-42F5-84C2-C3883052CF67" class="sect3">应用程序连续性和事务保护</h3>
               <div>
                  <p>应用程序连续性是用于故障转移的DBA功能。Transaction Guard是一种用于自行编码故障转移的开发人员功能。</p>
                  <p>在Oracle高可用性框架中，JDBC客户端，OCI客户端和ODP.NET客户端支持快速应用程序通知（FAN）消息。FAN旨在快速通知应用程序在节点，数据库，实例，服务和公共网络级别中断。在收到故障通知后，应用程序可以在幸存的实例上重新建立失败的连接。</p>
                  <p>应用程序连续性对应用程序是透明的。此功能由Oracle Database 12 <span class="italic">c</span>和Oracle驱动程序提供。通过在数据库服务上设置属性来启用它。
                  </p>
                  <div class="infoboxnotealso" id="GUID-4A142A4C-088F-42F5-84C2-C3883052CF67__GUID-886D9B98-6306-46A0-95D4-235B828859B1">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>有关应用程序连续性的更多信息<a href="../racad/ensuring-application-continuity.html#RACAD-GUID-BD699AEB-9F85-42A8-8687-5A979918938D" target="_blank"><span class="italic">，请参见“Oracle Real Application Clusters管理和部署指南”</span></a></p>
                        </li>
                        <li>
                           <p><a href="transaction-guard.html#GUID-6C5880E5-C45F-4858-A069-A28BB25FD1DB" title="如果您使用的是Oracle RAC或Oracle RAC One，请使用srvctl命令创建和修改服务。如果您使用的是Oracle RAC或Oracle RAC One，请使用srvctl命令创建和修改服务。">使用事务卫队</a>有关事务卫队的更多信息</p>
                        </li>
                        <li>
                           <p>有关OCI，事务防护和应用程序连续性的更多信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNOCI80660" target="_blank"><span class="italic">Oracle调用接口程序员指南</span></a></p>
                        </li>
                        <li>
                           <p>有关JDBC，事务防护和应用程序连续性的更多信息，请参见<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=JJDBC27000" target="_blank"><span class="italic">“Oracle数据库JDBC开发人员指南”</span></a></p>
                        </li>
                     </ul>
                  </div>
               </div><a id="ADFNS317"></a><div class="props_rev_3"><a id="GUID-7950B60E-E05A-4B96-ACFC-777074B768F2" name="GUID-7950B60E-E05A-4B96-ACFC-777074B768F2"></a><h4 id="ADFNS-GUID-7950B60E-E05A-4B96-ACFC-777074B768F2" class="sect4">应用程序连续性概述</h4>
                  <div>
                     <p>应用程序连续性通过尝试重建数据库会话事务和非事务状态来屏蔽计划内或计划外中断（导致数据库会话不可用），因此中断对用户来说只不过是延迟执行。</p>
                     <p>Application Continuity与Oracle Database <span class="italic">12c</span>及更高版本的服务器配合使用，以确定是否可以重播数据库会话。当发生使数据库会话不可用的可恢复错误时，会将错误消息发送回应用程序。驱动程序接收FAN消息（关闭或中断）并中止死会话。
                     </p>
                     <p>如果上次提交已启用重播，则<code class="codeph">12c</code>驱动程序准备重播提交并重播请求的已保存语句。 Application Continuity通过使用Transaction Guard准备重播，以确定接收错误的会话提交的上一个操作的结果。如果提交并完成提交，则新会话将此结果返回给应用程序，并在<code class="codeph">SESSION_STATE_CONSISTENCY</code>模式为<code class="codeph">STATIC</code>继续建立非事务状态，或者在<code class="codeph">SESSION_STATE_CONSISTENCY</code>模式为<code class="codeph">DYNAMIC</code>退出。 <code class="codeph">DYNAMIC</code>会话状态一致性适用于大多数应用程序。
                     </p>
                     <p>如果<code class="codeph">FAILOVER_RESTORE</code>为<code class="codeph">LEVEL1</code>或已设置回调，则客户端（JDBC重放驱动程序，ODP.NET或OCI）初始化连接以恢复初始非事务会话状态（NTSS）。重放时，如果已授予权限，则会恢复保留的可变数据。验证在服务器上执行，以确保客户端可见结果与原始提交相同。当重放完成时，应用程序继续其应用程序逻辑返回到运行时模式，就好像所有发生的都是执行延迟类似于在负载下发生的延迟。
                     </p>
                     <p>在某些情况下，重放无法恢复客户端可能做出决策的数据。然后，重放将原始错误返回给应用程序，并显示为延迟错误。</p>
                     <p>Application Continuity支持针对具有相同DBID（正向转发）的数据库副本或Active Data Guard场内的数据库不可用导致的任何中断。这可能是Oracle RAC One，Oracle Real Application Clusters，在Active Data Guard中，Multitenant使用PDB重定位RAC或跨RAC或跨越Active Data Guard（ADG）。</p>
                     <div class="infoboxnotealso" id="GUID-7950B60E-E05A-4B96-ACFC-777074B768F2__GUID-0F2E620C-55E3-4A8E-96D8-617192B9D08C">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>有关应用程序连续性的更多信息<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=RACAD-GUID-BD699AEB-9F85-42A8-8687-5A979918938D" target="_blank"><span class="italic">，请参见“Oracle Real Application Clusters管理和部署指南”</span></a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="ADFNS316"></a><div class="props_rev_3"><a id="GUID-F7E968E4-EE8F-4563-91F3-CD44B5D2E747" name="GUID-F7E968E4-EE8F-4563-91F3-CD44B5D2E747"></a><h4 id="ADFNS-GUID-F7E968E4-EE8F-4563-91F3-CD44B5D2E747" class="sect4">交易保护概述</h4>
                  <div>
                     <p>Transaction Guard是一个可靠的协议和接口，当错误或超时返回给客户端时，它返回当前正在进行的事务的提交结果。应用程序可以利用Transaction Guard接口来编码优雅的可恢复错误处理。在中断期间提供明确的消息极大地改善了用户体验。</p>
                     <p>Transaction Guard引入了<span class="italic">最多一次事务语义</span>的概念，也称为事务幂等性。当应用程序使用此服务打开与数据库的连接时，逻辑事务ID（LTXID）将在身份验证时生成，并存储在数据库的会话句柄和客户端驱动程序的副本中。这是一个全局唯一的ID，它从应用程序的角度标识数据库事务。应用程序使用Transaction Guard接口在可恢复的错误之后获取已知的提交结果。
                     </p>
                     <p>当发生中断时，使用Transaction Guard的应用程序可以从先前失败的会话句柄中检索LTXID，并使用它来确定在会话失败之前处于活动状态的事务的结果。如果确定LTXID是<code class="codeph">UNCOMMITTED</code> ，则应用程序可以将<code class="codeph">UNCOMMITTED</code>结果返回给用户以决定采取什么操作，或者可选地，应用程序可以重放未提交的事务。如果确定LTXID是<code class="codeph">COMMITTED</code> ，则提交事务，并且应用程序可以将此结果返回给最终用户，并且可能能够建立新连接并继续。Transaction Guard还会报告上次用户调用是否不仅是<code class="codeph">COMMITTED</code> ，还是它是否已完成更改所需的非事务状态 - 请参阅<code class="codeph">USER_CALL_COMPLETED</code> 。</p>
                     <div class="infoboxnotealso" id="GUID-F7E968E4-EE8F-4563-91F3-CD44B5D2E747__GUID-3145D7A7-9A63-4B24-B3A9-2B825E0A7ED0">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="transaction-guard.html#GUID-6C5880E5-C45F-4858-A069-A28BB25FD1DB" title="如果您使用的是Oracle RAC或Oracle RAC One，请使用srvctl命令创建和修改服务。如果您使用的是Oracle RAC或Oracle RAC One，请使用srvctl命令创建和修改服务。">使用Transaction Guard</a></p>
                     </div>
                  </div>
               </div>
            </div><a id="ADFNS540"></a><a id="ADFNS925"></a><div class="props_rev_3"><a id="GUID-799A6C37-32B5-4785-AEB0-49C9AFA6F4EE" name="GUID-799A6C37-32B5-4785-AEB0-49C9AFA6F4EE"></a><h3 id="ADFNS-GUID-799A6C37-32B5-4785-AEB0-49C9AFA6F4EE" class="sect3">数据库云的服务和负载管理</h3>
               <div>
                  <div class="section">
                     <p class="subhead2" id="GUID-799A6C37-32B5-4785-AEB0-49C9AFA6F4EE__GUID-C9DFBECF-768E-4A3A-AE71-6CF7D64CC062">话题：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p><a href="high-availability.html#GUID-42CBF2B4-D3C3-486F-B51E-5E39A5F42906">关于数据库云的服务和负载管理</a></p>
                  </div>
                  <!-- class="section" -->
               </div><a id="ADFNS541"></a><div class="props_rev_3"><a id="GUID-42CBF2B4-D3C3-486F-B51E-5E39A5F42906" name="GUID-42CBF2B4-D3C3-486F-B51E-5E39A5F42906"></a><h4 id="ADFNS-GUID-42CBF2B4-D3C3-486F-B51E-5E39A5F42906" class="sect4">关于数据库云的服务和负载管理</h4>
                  <div>
                     <p>数据库云是由服务和负载管理框架集成的独立数据库系统，可确保高性能，可用性和资源的最佳利用。该框架提供了跨分布式数据库的处理工作负载的有效平衡，这些数据库在本地和地理上不同的区域数据中心维护多个同步副本。副本可以是Oracle RAC环境中的实例，也可以是使用Oracle Data Guard，Oracle Golden Gate或支持复制技术的任何组合互连的单个实例。因此，服务和负载管理框架为这些复制数据库提供动态负载平衡，故障转移和集中服务管理。</p>
                     <p>全局服务是由多个数据库提供的数据库服务，这些数据库通过某种形式的数据复制同步，满足服务的服务质量要求。这允许将客户端对服务的请求转发到提供该服务的任何数据库。</p>
                     <p>数据库云中的数据库池由提供属于同一管理域的相同全局服务的所有数据库组成。数据库云分区为多个数据库池，以简化服务管理，并通过允许每个池由不同的管理员进行管理来提供更高级别的安全性。</p>
                     <p>全球服务管理器（GSM）是一种软件组件，可在数据库云中提供服务级负载平衡和服务集中管理。负载平衡在连接和运行时完成。GSM提供的其他功能包括服务的创建，配置，启动，停止和重新定位，以及维护基数和区域位置等全局服务属性。区域是称为数据中心的逻辑边界，其包含被认为彼此足够接近的数据库客户端和服务器，以便将网络延迟降低到访问这些数据中心的应用程序所需的级别。</p>
                     <p>GSM可以在单独的主机上运行，也可以与数据库实例共存。每个区域必须至少运行一个GSM实例。为了实现高可用性，Oracle建议您在一个区域中部署多个GSM实例。GSM实例仅属于一个特定区域;但是，它管理与此区域关联的所有数据库池中的全局服务。</p>
                     <p>从应用程序开发人员的角度来看，客户端程序连接到区域全局服务管理器（GSM）并请求连接到全局服务。客户端无需指定所需的数据库或实例。GSM将客户端的请求转发到提供服务的数据库云中的数据库池中的最佳实例。</p>
                     <p>从Oracle Database 12 <span class="italic">c</span>第1版（12.1.0.1）开始，DBA可以使用Oracle Net字符串为全局数据服务（GDS）框架中的数据库服务配置客户端连接字符串。
                     </p>
                     <p>在Oracle Database 12 <span class="italic">c</span>第1版（12.1.0.1）中引入，逻辑事务ID（LTXID）最初在身份验证时生成并存储在会话句柄中，用于从应用程序角度识别数据库事务。逻辑事务ID是全局唯一的，并标识高可用性（HA）基础结构内的事务。
                     </p>
                     <p>使用HA Framework，客户端应用程序（JDBC，OCI和ODP.NET）支持快速应用程序通知（FAN）消息。FAN旨在快速通知应用程序在节点，数据库，实例，服务和公共网络级别中断。在收到中断通知后，应用程序可以在幸存的实例上重新建立失败的连接。</p>
                     <p>从Oracle数据库12开始<span class="italic">c</span>解除1（12.1.0.1），DBA可以为所使用的应用程序以支持应用连续性为Java和交易员的数据库服务配置服务器端设置。
                     </p>
                     <div class="infoboxnotealso" id="GUID-42CBF2B4-D3C3-486F-B51E-5E39A5F42906__GUID-F12F209B-BB09-4A55-B00D-C198B0EA740F">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=CNCPT89330" target="_blank"><span class="italic">Oracle Database Concepts</span></a> ，概述全局服务管理以及服务和负载管理框架的物理和逻辑组件的描述</p>
                           </li>
                           <li>
                              <p>有关数据库云中全局服务管理的更多信息，请参见<a href="../gsmug/intro-global-data-services.html#GSMUG107" target="_blank"><span class="italic">“Oracle数据库全球数据服务概念和管理指南”</span></a></p>
                           </li>
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=GSMUG650" target="_blank"><span class="italic">“Oracle数据库全局数据服务概念和管理指南”</span></a> ，以获取有关配置数据库客户端以连接到全局数据服务（GDS）框架的更多信息。
                              </p>
                           </li>
                           <li>
                              <p>有关OCI，应用程序连续性和事务防护的更多信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNOCI72990" target="_blank"><span class="italic">Oracle调用接口程序员指南</span></a></p>
                           </li>
                           <li>
                              <p>有关JDBC，应用程序连续性和事务防护的更多信息，请参见<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=JJDBC27000" target="_blank"><span class="italic">“Oracle数据库JDBC开发人员指南”</span></a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>