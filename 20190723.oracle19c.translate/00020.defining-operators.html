<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>定义运算符</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Data Cartridge Developer&#39;s Guide"></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Data Cartridge Developer&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="data-cartridge-developers-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-10T07:34:53-08:00"></meta>
      <meta name="dcterms.title" content="Data Cartridge Developer&#39;s Guide"></meta>
      <meta name="dcterms.dateCopyrighted" content="1996, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96431-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="building-domain-indexes.html" title="Previous" type="text/html"></link>
      <link rel="next" href="using-extensible-optimizer.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="ADDCI"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="building-domain-indexes.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="using-extensible-optimizer.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">数据盒式开发人员指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="building-data-cartridges.html" property="item" typeof="WebPage"><span property="name">构建数据磁带</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">定义运算符</li>
            </ol>
            <a id="GUID-E10C1C49-E5DA-45E9-959D-E203DD964FBF" name="GUID-E10C1C49-E5DA-45E9-959D-E203DD964FBF"></a><a id="ADDCI2100"></a>
            
            <h2 id="ADDCI-GUID-E10C1C49-E5DA-45E9-959D-E203DD964FBF" class="sect2"><span class="enumeration_chapter">9</span>定义运算符</h2>
         </header>
         <div class="ind">
            <div>
               <p>您可以定义运算符，并在有和没有索引类型的情况下使用它们。</p>
            </div><a id="ADDCI4508"></a><div class="props_rev_3"><a id="GUID-D5B0203B-F2E2-4A42-8D03-E29CC9727616" name="GUID-D5B0203B-F2E2-4A42-8D03-E29CC9727616"></a><h3 id="ADDCI-GUID-D5B0203B-F2E2-4A42-8D03-E29CC9727616" class="sect3"><span class="enumeration_section">9.1</span>用户定义的运算符</h3>
               <div>
                  <p>一个<a id="d28333e108" class="indexterm-anchor"></a> <strong class="term">用户定义的运算符</strong>是顶级架构对象。在许多方面，用户定义的运算符就像内置运算符一样，如&lt;，&gt;和=;例如，可以在所有相同的情况下调用它们。它们通过简化SQL语句有助于简化使用，使它们更短，更易读。
                  </p>
                  <p>用户定义的运算符是：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>由名称标识，名称与表，视图，类型和独立函数位于同一名称空间中</p>
                     </li>
                     <li>
                        <p>绑定到函数，这些函数在指定的上下文中定义操作符行为</p>
                     </li>
                     <li>
                        <p>由权限控制，表示可以使用每个操作员的情况</p>
                     </li>
                     <li>
                        <p>通常与索引类型相关联，索引类型可用于定义未构建到数据库中的索引</p>
                     </li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-D5B0203B-F2E2-4A42-8D03-E29CC9727616__GUID-007E69AB-7B7C-4F21-8355-9EAD7ACACB99">
                     <p class="notep1">也可以看看：</p>
                     <p>有关语法和特权的详细信息，请<span class="italic">参见Oracle数据库SQL语言参考</span></p>
                  </div>
               </div><a id="ADDCI4509"></a><div class="props_rev_3"><a id="GUID-D491F7E8-F700-4592-99A1-15E42C9E6D29" name="GUID-D491F7E8-F700-4592-99A1-15E42C9E6D29"></a><h4 id="ADDCI-GUID-D491F7E8-F700-4592-99A1-15E42C9E6D29" class="sect4"><span class="enumeration_section">9.1.1</span>运算符绑定</h4>
                  <div>
                     <p>运算符<strong class="term">绑定</strong>将运算符与实现运算符的函数的<strong class="term">签名</strong>相关联。签名由函数参数的数据类型列表（按发生顺序）和函数的返回类型组成。运算符绑定告诉Oracle在调用运算符时要执行哪个函数。如果每个函数具有不同的签名，则运算符可以绑定到多个函数。要被视为不同，函数必须具有不同的参数列表。参数列表匹配但返回数据类型不匹配的函数不会被视为不同，并且不能绑定到同一运算符。
                     </p>
                     <p>运营商可以绑定到：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>独立功能</p>
                        </li>
                        <li>
                           <p>包装功能</p>
                        </li>
                        <li>
                           <p>用户定义的类型成员方法</p>
                        </li>
                     </ul>
                     <p>操作符可以绑定到任何可访问模式中的函数和方法。每个操作员在创建时必须至少有一个绑定。如果尝试指定非唯一操作员绑定，则Oracle服务器会引发错误。</p>
                  </div>
               </div><a id="ADDCI4510"></a><div class="props_rev_3"><a id="GUID-F7BECA82-B1F8-4F6E-88E3-8DD5DBD3547E" name="GUID-F7BECA82-B1F8-4F6E-88E3-8DD5DBD3547E"></a><h4 id="ADDCI-GUID-F7BECA82-B1F8-4F6E-88E3-8DD5DBD3547E" class="sect4"><span class="enumeration_section">9.1.2</span>运营商权限</h4>
                  <div>
                     <p>要创建运算符及其绑定，您必须具有：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">CREATE</code> <code class="codeph">OPERATOR</code>或<code class="codeph">CREATE</code> <code class="codeph">ANY</code> <code class="codeph">OPERATOR</code>权限</p>
                        </li>
                        <li>
                           <p>对引用的函数，运算符，包或类型的<code class="codeph">EXECUTE</code>特权</p>
                        </li>
                     </ul>
                     <p>要删除用户定义的运算符，您必须拥有运算符或具有<code class="codeph">DROP</code> <code class="codeph">ANY</code> <code class="codeph">OPERATOR</code>权限。
                     </p>
                     <p>要在表达式中调用用户定义的运算符，您必须拥有运算符或具有<code class="codeph">EXECUTE</code>特权。
                     </p>
                  </div>
               </div><a id="ADDCI4512"></a><a id="ADDCI4511"></a><div class="props_rev_3"><a id="GUID-E59706C5-6BD4-43CB-9731-047984EB4278" name="GUID-E59706C5-6BD4-43CB-9731-047984EB4278"></a><h4 id="ADDCI-GUID-E59706C5-6BD4-43CB-9731-047984EB4278" class="sect4"><span class="enumeration_section">9.1.3</span>创建运算符</h4>
                  <div>
                     <div class="section">
                        <p>要创建运算符，请使用<code class="codeph">CREATE OPERATOR</code>语句指定其名称及其绑定。<a href="defining-operators.html#GUID-E59706C5-6BD4-43CB-9731-047984EB4278__CHDCGBDC">例9-1</a>创建了运算符<code class="codeph">Contains()</code> ，将其绑定到在Text和Spatial域中提供实现的函数。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-E59706C5-6BD4-43CB-9731-047984EB4278__CHDCGBDC">
                        <p class="titleinexample">示例9-1创建运算符</p><pre class="oac_no_warn" dir="ltr">CREATE OPERATOR包含BINDING（VARCHAR2，VARCHAR2）返回数字使用text.contains，（空间。地理，空间。Geo）使用Spatial.contains返回数字;</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADDCI4514"></a><a id="ADDCI4515"></a><a id="ADDCI4513"></a><div class="props_rev_3"><a id="GUID-4BF1D52C-13FB-4E5B-9ACE-E23BA28A183A" name="GUID-4BF1D52C-13FB-4E5B-9ACE-E23BA28A183A"></a><h4 id="ADDCI-GUID-4BF1D52C-13FB-4E5B-9ACE-E23BA28A183A" class="sect4"><span class="enumeration_section">9.1.4</span>丢弃运营商</h4>
                  <div>
                     <div class="section">
                        <p>要删除运算符及其所有绑定，请使用<code class="codeph">DROP</code> <code class="codeph">OPERATOR</code>语句指定其名称。<a href="defining-operators.html#GUID-4BF1D52C-13FB-4E5B-9ACE-E23BA28A183A__CHDIFGFI">例9-2</a>删除了运算符<code class="codeph">Contains()</code> 。
                        </p>
                        <p>默认的<code class="codeph">DROP</code>行为是<code class="codeph">DROP</code> <code class="codeph">RESTRICT</code> ：如果有任何操作符绑定的依赖索引类型或辅助运算符，则不允许<code class="codeph">DROP</code>操作。
                        </p>
                        <p>要覆盖默认行为，请使用<code class="codeph">FORCE</code>选项。<a href="defining-operators.html#GUID-4BF1D52C-13FB-4E5B-9ACE-E23BA28A183A__CHDCDEBA">例9-3</a>删除了运算符及其所有绑定，并标记了任何依赖的indextype对象，并且依赖的辅助运算符无效。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-4BF1D52C-13FB-4E5B-9ACE-E23BA28A183A__CHDIFGFI">
                        <p class="titleinexample">例9-2删除操作员;限制选项</p><pre class="oac_no_warn" dir="ltr">DROP OPERATOR包含;</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-4BF1D52C-13FB-4E5B-9ACE-E23BA28A183A__CHDCDEBA">
                        <p class="titleinexample">例9-3删除操作员; FORCE选项</p><pre class="oac_no_warn" dir="ltr">DROP OPERATOR包含FORCE;</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADDCI4517"></a><a id="ADDCI4516"></a><div class="props_rev_3"><a id="GUID-CBDCD80C-E171-424D-9040-AA3CD755F594" name="GUID-CBDCD80C-E171-424D-9040-AA3CD755F594"></a><h4 id="ADDCI-GUID-CBDCD80C-E171-424D-9040-AA3CD755F594" class="sect4"><span class="enumeration_section">9.1.5</span>改变运营商</h4>
                  <div>
                     <div class="section">
                        <p>您可以使用<code class="codeph">ALTER OPERATOR</code>语句向现有运算符添加绑定或删除绑定。<a href="defining-operators.html#GUID-CBDCD80C-E171-424D-9040-AA3CD755F594__CHDCBJJE">例9-4</a>为运算符<code class="codeph">Contains().</code>添加了一个绑定<code class="codeph">Contains().</code></p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-CBDCD80C-E171-424D-9040-AA3CD755F594__CHDCBJJE">
                        <p class="titleinexample">示例9-4向运算符添加绑定</p><pre class="oac_no_warn" dir="ltr">ALTER OPERATOR包含ADD BINDING（music.artist，music.artist）返回NUMBER使用music.contains;</pre></div>
                     <!-- class="example" -->
                  </div>
                  <div class="props_rev_3"><a id="GUID-ADF5C920-B3AC-4A85-B79C-1D43886EDA43" name="GUID-ADF5C920-B3AC-4A85-B79C-1D43886EDA43"></a><h5 id="ADDCI-GUID-ADF5C920-B3AC-4A85-B79C-1D43886EDA43" class="sect5"><span class="enumeration_section">9.1.5.1</span> ALTER OPERATOR的必要特权</h5>
                     <div>
                        <div class="section">
                           <p>要更改运算符，运算符必须位于您自己的架构中，或者您必须具有<code class="codeph">ALTER ANY OPERATOR</code>权限。您还必须对引用的运算符和函数具有<code class="codeph">EXECUTE</code>特权。
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
                  <div class="props_rev_3"><a id="GUID-302F97DB-4007-4294-AA89-E926A4603339" name="GUID-302F97DB-4007-4294-AA89-E926A4603339"></a><h5 id="ADDCI-GUID-302F97DB-4007-4294-AA89-E926A4603339" class="sect5"><span class="enumeration_section">9.1.5.2</span> ALTER OPERATOR的限制</h5>
                     <div>
                        <div class="section">
                           <p>以下限制适用于<code class="codeph">ALTER OPERATOR</code>语句：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>您只能发出与现有运算符相关的<code class="codeph">ALTER OPERATOR</code>语句。
                                 </p>
                              </li>
                              <li>
                                 <p>您只能在每个<code class="codeph">ALTER OPERATOR</code>语句中添加或删除一个绑定。
                                 </p>
                              </li>
                              <li>
                                 <p>您不能删除操作员与<code class="codeph">ALTER OPERATOR</code>的唯一绑定;使用<code class="codeph">DROP OPERATOR</code>语句删除运算符。没有任何绑定，操作员不能存在。
                                 </p>
                              </li>
                              <li>
                                 <p>如果向与indextype关联的运算符添加绑定，则绑定不与indextype关联，除非您还发出<code class="codeph">ALTER INDEXTYPE ADD OPERATOR</code>语句</p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div><a id="ADDCI4519"></a><a id="ADDCI4518"></a><div class="props_rev_3"><a id="GUID-126833A5-8CCD-47B3-989E-7919B808ED30" name="GUID-126833A5-8CCD-47B3-989E-7919B808ED30"></a><h4 id="ADDCI-GUID-126833A5-8CCD-47B3-989E-7919B808ED30" class="sect4"><span class="enumeration_section">9.1.6</span>评论运营商</h4>
                  <div>
                     <div class="section">
                        <p>要向操作员添加注释文本，请使用<code class="codeph">COMMENT</code>语句指定名称和文本。<a href="defining-operators.html#GUID-126833A5-8CCD-47B3-989E-7919B808ED30__CHDBGIBB">例9-5</a>提供了有关<code class="codeph">Contains()</code>运算符的信息：</p>
                        <p>有关运算符的注释可通过以下视图在数据字典中找到：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">USER_OPERATOR_COMMENTS</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">ALL_OPERATOR_COMMENTS</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">DBA_OPERATOR_COMMENTS</code></p>
                           </li>
                        </ul>
                        <p>除非您具有<code class="codeph">COMMENT ANY OPERATOR</code>权限，否则您只能在自己的架构中<code class="codeph">COMMENT ANY OPERATOR</code> 。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-126833A5-8CCD-47B3-989E-7919B808ED30__CHDBGIBB">
                        <p class="titleinexample">示例9-5向操作员添加COMMENT</p><pre class="oac_no_warn" dir="ltr">对操作者的评论包含IS'一个数字，表示文本是否包含密钥';</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADDCI4520"></a><div class="props_rev_3"><a id="GUID-B4A841A6-3251-478B-9805-2CB8FF75D5F4" name="GUID-B4A841A6-3251-478B-9805-2CB8FF75D5F4"></a><h4 id="ADDCI-GUID-B4A841A6-3251-478B-9805-2CB8FF75D5F4" class="sect4"><span class="enumeration_section">9.1.7</span>关于调用操作符</h4>
                  <div>
                     <p>与内置运算符一样，只要表达式发生，就可以调用用户定义的运算符。例如，用户定义的运算符可用于：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">SELECT</code>命令的选择列表。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">WHERE</code>子句的条件。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">ORDER</code> <code class="codeph">BY</code>和<code class="codeph">GROUP</code> <code class="codeph">BY</code>子句。
                           </p>
                        </li>
                     </ul>
                     <p>调用运算符时，Oracle通过执行绑定到它的函数来评估运算符。当多个函数绑定到运算符时，Oracle执行其参数数据类型与调用的函数匹配的函数（在任何隐式类型转换之后）。调用具有与该运算符绑定的任何函数的签名不匹配的参数列表的运算符会导致引发错误。因为用户定义的运算符可以有多个绑定，所以它们可以用作重载函数。</p>
                     <p>假设<a href="defining-operators.html#GUID-402BA522-4394-4B6E-AAD3-AF51305A4A97__CHDEFCGA">示例9-6</a>创建运算符<code class="codeph">Contains()</code> 。
                     </p>
                     <p>如果在<a href="defining-operators.html#GUID-1E5DCD14-40EE-4BF1-BE5A-0E836CB5DFDF__CHDFIEGI">例9-7中</a>使用<code class="codeph">Contains()</code> ，则运算符调用<code class="codeph">Contains(resume,</code> <code class="codeph">'Oracle')</code>会导致Oracle执行函数<code class="codeph">text.contains(resume,</code> <span class="italic"> </span> <code class="codeph">'Oracle')</code>因为函数的签名与运算符参数的数据类型匹配。类似地，运算符调用<code class="codeph">Contains(location</code> <span class="italic">，</span> <code class="codeph">:bay_area)</code>执行函数<code class="codeph">spatial.contains(location</code> <span class="italic">，</span> <code class="codeph">:bay_area)</code> 。
                     </p>
                     <p>执行<a href="defining-operators.html#GUID-1556E7BD-1B14-4FE4-897B-0471202712A6__CHDIHJFG">例9-8中</a>的语句会引发错误，因为没有任何运算符绑定满足参数数据类型。
                     </p>
                  </div><a id="ADDCI4521"></a><div class="props_rev_3"><a id="GUID-402BA522-4394-4B6E-AAD3-AF51305A4A97" name="GUID-402BA522-4394-4B6E-AAD3-AF51305A4A97"></a><h5 id="ADDCI-GUID-402BA522-4394-4B6E-AAD3-AF51305A4A97" class="sect5"><span class="enumeration_section">9.1.7.1</span>创建Contains（）运算符</h5>
                     <div>
                        <div class="example" id="GUID-402BA522-4394-4B6E-AAD3-AF51305A4A97__CHDEFCGA">
                           <p class="titleinexample">示例9-6创建Contains（）运算符</p><pre class="oac_no_warn" dir="ltr">CREATE OPERATOR包含BINDING（VARCHAR2，VARCHAR2）返回数字使用text.contains，（spatial.geo，spatial.geo）返回NUMBER使用spatial.contains;</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="ADDCI4522"></a><div class="props_rev_3"><a id="GUID-1E5DCD14-40EE-4BF1-BE5A-0E836CB5DFDF" name="GUID-1E5DCD14-40EE-4BF1-BE5A-0E836CB5DFDF"></a><h5 id="ADDCI-GUID-1E5DCD14-40EE-4BF1-BE5A-0E836CB5DFDF" class="sect5"><span class="enumeration_section">9.1.7.2</span>在查询中使用Contains（）运算符</h5>
                     <div>
                        <div class="example" id="GUID-1E5DCD14-40EE-4BF1-BE5A-0E836CB5DFDF__CHDFIEGI">
                           <p class="titleinexample">示例9-7在查询中使用运算符包含（）</p><pre class="oac_no_warn" dir="ltr">SELECT * FROM MyEmployees WHERE Contains（resume，'Oracle'）= 1 AND Contains（location，：bay_area）= 1;</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="ADDCI4523"></a><div class="props_rev_3"><a id="GUID-1556E7BD-1B14-4FE4-897B-0471202712A6" name="GUID-1556E7BD-1B14-4FE4-897B-0471202712A6"></a><h5 id="ADDCI-GUID-1556E7BD-1B14-4FE4-897B-0471202712A6" class="sect5"><span class="enumeration_section">9.1.7.3</span>错误地使用Contains（）运算符</h5>
                     <div>
                        <div class="example" id="GUID-1556E7BD-1B14-4FE4-897B-0471202712A6__CHDIHJFG">
                           <p class="titleinexample">例9-8运算符包含错误的使用（）</p><pre class="oac_no_warn" dir="ltr">SELECT * FROM MyEmployees WHERE Contains（address，employee_addr_type（'123 Main Street'，'Anytown'，'CA'，'90001'））= 1;</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div>
               </div>
            </div><a id="ADDCI4524"></a><div class="props_rev_3"><a id="GUID-CAD6F288-5E9F-4385-8627-0D29F8B9CCE8" name="GUID-CAD6F288-5E9F-4385-8627-0D29F8B9CCE8"></a><h3 id="ADDCI-GUID-CAD6F288-5E9F-4385-8627-0D29F8B9CCE8" class="sect3"><span class="enumeration_section">9.2</span>运算符和索引类型</h3>
               <div>
                  <p>通常会定义运算符<a id="d28333e1148" class="indexterm-anchor"></a>索引类型。在使用其功能实现创建运算符之后，您可以创建一个索引类型，该索引类型支持使用索引扫描对这些运算符进行评估。
                  </p>
                  <p>在<code class="codeph">WHERE</code>子句之外出现的运算符实际上是实现它们的函数的替身;这种运算符的含义取决于其功能实现。<code class="codeph">WHERE</code>子句中出现的运算符有时使用函数实现进行求值;在其他时候，它们通过索引扫描进行评估。
                  </p>
               </div><a id="ADDCI4525"></a><div class="props_rev_3"><a id="GUID-D374E180-CEBA-4A95-866E-34B4F88E04E2" name="GUID-D374E180-CEBA-4A95-866E-34B4F88E04E2"></a><h4 id="ADDCI-GUID-D374E180-CEBA-4A95-866E-34B4F88E04E2" class="sect4"><span class="enumeration_section">9.2.1</span> WHERE子句中的运算符</h4>
                  <div>
                     <p>可以使用indextype提供的扫描方法通过索引扫描有效地评估出现在<code class="codeph">WHERE</code>子句中的运算符。该过程涉及以下步骤。
                     </p>
                     <ol>
                        <li>
                           <p>创建支持运算符求值的索引类型</p>
                        </li>
                        <li>
                           <p>识别某种形式的运算符谓词</p>
                        </li>
                        <li>
                           <p>选择域索引</p>
                        </li>
                        <li>
                           <p>设置适当的索引扫描</p>
                        </li>
                        <li>
                           <p>执行索引扫描方法</p>
                        </li>
                     </ol>
                  </div><a id="ADDCI4527"></a><a id="ADDCI4526"></a><div class="props_rev_3"><a id="GUID-B3F6B9FC-3A36-48C5-BD5A-229610708FA1" name="GUID-B3F6B9FC-3A36-48C5-BD5A-229610708FA1"></a><h5 id="ADDCI-GUID-B3F6B9FC-3A36-48C5-BD5A-229610708FA1" class="sect5"><span class="enumeration_section">9.2.1.1</span>使用运算符谓词</h5>
                     <div>
                        <div class="section">
                           <p>索引类型支持对运算符谓词的有效求值，运算符谓词可以由运算符返回值的一系列下限和上限表示。具体而言， <a href="defining-operators.html#GUID-B3F6B9FC-3A36-48C5-BD5A-229610708FA1__CHDFDBCI">实施例9-9</a>中列出的形式的谓词是基于索引扫描的评估的候选者。
                           </p>
                           <p>运算符谓词Oracle可以在内部转换为<a href="defining-operators.html#GUID-B3F6B9FC-3A36-48C5-BD5A-229610708FA1__CHDFDBCI">示例9-9中的</a>一种形式，也可以使用基于索引扫描的评估。
                           </p>
                           <p>在表达式中使用运算符（例如<code class="codeph">op(...) + 2 = 3</code> ）会排除基于索引扫描的评估。
                           </p>
                           <p>使用功能实现来评估形式<code class="codeph">op() is NULL</code>谓词。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-B3F6B9FC-3A36-48C5-BD5A-229610708FA1__CHDFDBCI">
                           <p class="titleinexample">例9-9运算符谓词</p><pre class="oac_no_warn" dir="ltr">OP（...）LIKE <span class="italic">value_expression</span> op（...） <span class="italic">relop</span> <span class="italic">value_expression</span></pre><p>其中<span class="italic"><code class="codeph">value_expression</code></span>必须求值为可用作域索引键的常量（不是列），而<span class="italic"><code class="codeph">relop</code></span>是<code class="codeph">&lt;</code> ， <code class="codeph">&lt;=</code> ， <code class="codeph">=</code> ， <code class="codeph">&gt;=</code>或<code class="codeph">&gt;</code></p>
                        </div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="ADDCI4529"></a><a id="ADDCI4530"></a><a id="ADDCI4528"></a><div class="props_rev_3"><a id="GUID-FA782F59-86A5-4B78-9F4E-0036AA0E68BA" name="GUID-FA782F59-86A5-4B78-9F4E-0036AA0E68BA"></a><h5 id="ADDCI-GUID-FA782F59-86A5-4B78-9F4E-0036AA0E68BA" class="sect5"><span class="enumeration_section">9.2.1.2</span>使用Contains（）运算符解析查询结果</h5>
                     <div>
                        <div class="section">
                           <p>仅当运算符应用于由indextype索引的列或对象属性时，才可以对运算符进行基于索引扫描的评估。优化器在索引实现和功能实现之间做出最终决定，同时在生成查询执行计划时考虑选择性和成本。</p>
                           <p>考虑<a href="defining-operators.html#GUID-FA782F59-86A5-4B78-9F4E-0036AA0E68BA__CHDFDCBC">例9-10中</a>的查询。
                           </p>
                           <p>优化器可以选择在评估<code class="codeph">Contains()</code>运算符时使用域索引if</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><code class="codeph">resume</code>列有一个已定义的索引。
                                 </p>
                              </li>
                              <li>
                                 <p>索引的类型为<code class="codeph">TextIndexType</code> 。
                                 </p>
                              </li>
                              <li>
                                 <p><code class="codeph">TextIndexType</code>支持相应的<code class="codeph">Contains()</code>运算符。
                                 </p>
                              </li>
                           </ul>
                           <p>如果这些条件中的任何一个不成立，Oracle将对<code class="codeph">MyEmployees</code>表执行完整扫描，并将<code class="codeph">Contains()</code>的功能实现应用为后置过滤器。但是，如果满足所有这些条件，优化程序将使用选择性和成本函数来比较基于索引的评估和全表扫描的成本，并生成相应的执行计划。
                           </p>
                           <p>请考虑<a href="defining-operators.html#GUID-FA782F59-86A5-4B78-9F4E-0036AA0E68BA__CHDCEIDE">示例9-11中</a>略有不同的查询。
                           </p>
                           <p>在这里，您可以通过<code class="codeph">id</code>列上的索引， <code class="codeph">resume</code>列上的索引或两者的位图合并来访问<code class="codeph">MyEmployees</code>表。优化程序估计三个计划的成本，并选择最便宜的变量一，可以使用<code class="codeph">id</code>上的索引并在结果行上应用<code class="codeph">Contains()</code>运算符。在这种情况下，Oracle将使用<code class="codeph">Contains()</code>的功能实现而不是域索引。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-FA782F59-86A5-4B78-9F4E-0036AA0E68BA__CHDFDCBC">
                           <p class="titleinexample">示例9-10在简单查询中使用Contains（）运算符</p><pre class="oac_no_warn" dir="ltr">SELECT * FROM MyEmployees WHERE Contains（resume，'Oracle'）= 1;</pre></div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-FA782F59-86A5-4B78-9F4E-0036AA0E68BA__CHDCEIDE">
                           <p class="titleinexample">示例9-11在复杂查询中使用Contains（）运算符</p><pre class="oac_no_warn" dir="ltr">SELECT * FROM MyEmployees WHERE Contains（resume，'Oracle'）= 1 AND id = 100;</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="ADDCI4531"></a><div class="props_rev_3"><a id="GUID-D0B58284-7999-44BF-BE99-A3A9F9D4CC61" name="GUID-D0B58284-7999-44BF-BE99-A3A9F9D4CC61"></a><h5 id="ADDCI-GUID-D0B58284-7999-44BF-BE99-A3A9F9D4CC61" class="sect5"><span class="enumeration_section">9.2.1.3</span>设置索引扫描</h5>
                     <div>
                        <div class="section">
                           <p>如果选择域索引用于评估运算符谓词，则为索引<a id="d28333e1535" class="indexterm-anchor"></a>扫描已设置。索引扫描由扫描方法<code class="codeph">ODCIIndexStart()</code> ， <code class="codeph">ODCIIndexFetch()</code>和<code class="codeph">ODCIIndexClose()</code> ，指定为相应索引类型实现的一部分。使用与运算符相关的信息调用<code class="codeph">ODCIIndexStart()</code>方法，包括名称和参数以及描述谓词的下限和上限。在<code class="codeph">ODCIIndexStart()</code>调用之后，执行一系列提取以获取满足谓词的行的行标识符，最后在销毁SQL游标时调用<code class="codeph">ODCIIndexClose()</code> 。
                           </p>
                           <div class="infoboxnotealso" id="GUID-D0B58284-7999-44BF-BE99-A3A9F9D4CC61__GUID-A6418CE2-4B9C-46C0-BC77-023B6BFCF068">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><a href="extensible-indexing-interface.html#GUID-2F49CDE4-C064-4644-948C-BBF014FDD8C8">ODCIIndexClose（）</a></p>
                                 </li>
                                 <li>
                                    <p><a href="extensible-indexing-interface.html#GUID-BB601420-A858-46E3-A9AC-3433220D4F82">ODCIIndexFetch（）</a></p>
                                 </li>
                                 <li>
                                    <p><a href="extensible-indexing-interface.html#GUID-53F2321C-B0F8-4783-AC1B-056372A0C073">ODCIIndexStart（）</a></p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="ADDCI4532"></a><div class="props_rev_3"><a id="GUID-BDBC368B-0329-49AF-838C-93A2EA5FCF8E" name="GUID-BDBC368B-0329-49AF-838C-93A2EA5FCF8E"></a><h5 id="ADDCI-GUID-BDBC368B-0329-49AF-838C-93A2EA5FCF8E" class="sect5"><span class="enumeration_section">9.2.1.4</span>索引扫描方法的执行模型</h5>
                     <div>
                        <div class="section">
                           <p>要实现索引扫描例程，您必须了解它们的调用方式以及如何组合多组调用。</p>
                           <p>例如，请考虑<a href="defining-operators.html#GUID-DBDC35BB-8EAB-4DF4-A345-56B8FD524455__CHDBBGGJ">示例9-12中</a>的查询。
                           </p>
                           <p>如果优化器选择在两个表的<code class="codeph">resume</code>列上使用域索引，则可以<a href="defining-operators.html#GUID-2F7E1E8C-7E95-4C2B-8229-E3DE4A3F1680__CHDDDGFD">按例9-13中</a>演示的顺序调用indextype例程。
                           </p>
                           <p>在此示例中，对于<code class="codeph">Contains()</code>运算符的不同实例，会多次调用单个indextype例程。可能通过相同的索引类型例程同时评估许多运算符。通过其参数获取所需信息的例程（例如<code class="codeph">CREATE</code>例程）不会在调用之间保持任何状态，因此同时评估多个运算符不是问题。必须在调用之间保持状态的其他例程（如<code class="codeph">FETCH</code>例程）必须知道接下来要返回哪一行。这些例程应该在传递给每个调用的<code class="codeph">SELF</code>参数中维护状态信息。<code class="codeph">SELF</code>参数是实现类型的一个实例，可用于存储整个状态或存储状态的游标持续时间内存的句柄（如果状态信息很大）。
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="ADDCI4533"></a><div class="props_rev_3"><a id="GUID-DBDC35BB-8EAB-4DF4-A345-56B8FD524455" name="GUID-DBDC35BB-8EAB-4DF4-A345-56B8FD524455"></a><h5 id="ADDCI-GUID-DBDC35BB-8EAB-4DF4-A345-56B8FD524455" class="sect5"><span class="enumeration_section">9.2.1.5</span>使用Contains（）运算符过滤多个表查询</h5>
                     <div>
                        <div class="example" id="GUID-DBDC35BB-8EAB-4DF4-A345-56B8FD524455__CHDBBGGJ">
                           <p class="titleinexample">示例9-12在多表查询中使用Contains（）运算符</p><pre class="oac_no_warn" dir="ltr">SELECT * FROM MyEmployees1，MyEmployees2 WHERE Contains（MyEmployees1.resume，'Oracle'）= 1 AND Contains（MyEmployees2.resume，'UNIX'）= 1 AND MyEmployees1.employee_id = MyEmployees2.employee_id;</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="ADDCI4534"></a><div class="props_rev_3"><a id="GUID-2F7E1E8C-7E95-4C2B-8229-E3DE4A3F1680" name="GUID-2F7E1E8C-7E95-4C2B-8229-E3DE4A3F1680"></a><h5 id="ADDCI-GUID-2F7E1E8C-7E95-4C2B-8229-E3DE4A3F1680" class="sect5"><span class="enumeration_section">9.2.1.6</span>为Contains（）运算符调用Indextrype例程</h5>
                     <div>
                        <div class="example" id="GUID-2F7E1E8C-7E95-4C2B-8229-E3DE4A3F1680__CHDDDGFD">
                           <p class="titleinexample">示例9-13为Contains（）运算符查询调用Indextype例程</p><pre class="oac_no_warn" dir="ltr">开始（ctx1，...）; / * corr。 to Contains（MyEmployees1.resume，'Oracle'）* / start（ctx2，...）; / * corr。 to Contains（MyEmployees2.resume，'UNIX'）;获取（ctx1，...）;获取（ctx2，...）;获取（ctx1，...）; ...关闭（CTX1）;关闭（ctx2）;</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div>
               </div><a id="ADDCI4536"></a><a id="ADDCI4535"></a><div class="props_rev_3"><a id="GUID-52B70980-69B5-4636-B551-E808481DF702" name="GUID-52B70980-69B5-4636-B551-E808481DF702"></a><h4 id="ADDCI-GUID-52B70980-69B5-4636-B551-E808481DF702" class="sect4"><span class="enumeration_section">9.2.2</span>在WHERE子句之外使用运算符</h4>
                  <div>
                     <p>在<code class="codeph">WHERE</code>子句之外使用的运算符使用功能实现进行评估。为了执行该语句<a href="defining-operators.html#GUID-52B70980-69B5-4636-B551-E808481DF702__CHDEJFJD">例9-14</a> ，甲骨文扫描<code class="codeph">MyEmployees</code>表和调用功能的实施<code class="codeph">Contains()</code>上的每个实例<code class="codeph">resume</code> ，向它传递的实际值<code class="codeph">resume</code> ，文本数据，目前排。请注意，此函数不会使用在<code class="codeph">resume</code>列上构建的任何域索引。
                     </p>
                     <p>因为功能实现可以使用域索引，所以请考虑如何编写使用域索引的函数以及系统如何调用它们。</p>
                     <div class="example" id="GUID-52B70980-69B5-4636-B551-E808481DF702__CHDEJFJD">
                        <p class="titleinexample">示例9-14在WHERE子句外使用运算符</p><pre class="oac_no_warn" dir="ltr">SELECT包含（简历，'Oracle'）FROM MyEmployees;</pre></div>
                     <!-- class="example" -->
                  </div><a id="ADDCI4537"></a><div class="props_rev_3"><a id="GUID-478436F7-A7CC-4594-B60E-0379A8AAA8F0" name="GUID-478436F7-A7CC-4594-B60E-0379A8AAA8F0"></a><h5 id="ADDCI-GUID-478436F7-A7CC-4594-B60E-0379A8AAA8F0" class="sect5"><span class="enumeration_section">9.2.2.1</span>创建基于索引的功能实现</h5>
                     <div>
                        <p>对于许多特定于域的运算符，例如<code class="codeph">Contains()</code> ，功能实现有两个选项：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>如果运算符正在对具有域索引的列或<code class="codeph">OBJECT</code>属性进行操作，则该函数可以通过查看索引数据而不是实际参数值来评估运算符。
                              </p>
                              <p>例如，当在<code class="codeph">MyEmployees</code>表的特定行上调用<code class="codeph">Contains(resume</code> ， <code class="codeph">'Oracle')</code> ，函数更容易查找<code class="codeph">resume</code>列上定义的文本域索引，并根据行标识符评估运算符对于包含<code class="codeph">resume</code>的行而不是处理<code class="codeph">resume</code>文本数据参数。
                              </p>
                           </li>
                           <li>
                              <p>如果运算符正在对未在其上定义适当域索引的列进行操作，或者如果使用文字值（非列）调用运算符，则功能实现将根据参数值评估运算符。这是所有操作员绑定的默认行为。</p>
                           </li>
                        </ul>
                        <p>要使运算符处理这两个选项，请提供一个功能实现，除了运算符的原始参数外，还有三个参数：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>索引上下文：域索引信息和正在评估运算符的行的行标识符</p>
                           </li>
                           <li>
                              <p>扫描上下文：一个上下文值，用于与在表的其他行上运行的同一运算符的后续调用共享状态</p>
                           </li>
                           <li>
                              <p>扫描标志：指示当前调用是否是最后一次调用，在此调用期间应执行所有清除操作</p>
                           </li>
                        </ul>
                        <p><a href="defining-operators.html#GUID-4A0BCE7E-7CA2-4CFA-951B-77B2C62A1765__CHDHHDDI">例9-15中</a>的函数<code class="codeph">TextContains()</code>为<code class="codeph">Contains()</code>运算符提供了基于索引的功能实现。
                        </p>
                        <p><code class="codeph">Contains()</code>运算符绑定到功能实现，如<a href="defining-operators.html#GUID-D6AC4B25-2A23-4920-BA74-E3E452F7C765__CHDBFEHA">例9-16所示</a> 。
                        </p>
                        <p><code class="codeph">WITH INDEX CONTEXT</code>子句指定功能实现可以使用任何适用的域索引。<code class="codeph">SCAN CONTEXT</code>指定扫描上下文参数的数据类型，该参数必须与支持此运算符的索引类型的实现类型相同。
                        </p>
                     </div>
                  </div><a id="ADDCI4538"></a><div class="props_rev_3"><a id="GUID-4A0BCE7E-7CA2-4CFA-951B-77B2C62A1765" name="GUID-4A0BCE7E-7CA2-4CFA-951B-77B2C62A1765"></a><h5 id="ADDCI-GUID-4A0BCE7E-7CA2-4CFA-951B-77B2C62A1765" class="sect5"><span class="enumeration_section">9.2.2.2</span>在基于索引的函数中实现Contains（）运算符</h5>
                     <div>
                        <div class="example" id="GUID-4A0BCE7E-7CA2-4CFA-951B-77B2C62A1765__CHDHHDDI">
                           <p class="titleinexample">示例9-15在基于索引的函数中实现Contains（）运算符</p><pre class="oac_no_warn" dir="ltr">CREATE FUNCTION TextContains（Text IN VARCHAR2，Key IN VARCHAR2，indexctx IN ODCIIndexCtx，scanctx IN OUT TextIndexMethods，scanflg IN NUMBER）返回数字为BEGIN .......END TextContains;</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="ADDCI4539"></a><div class="props_rev_3"><a id="GUID-D6AC4B25-2A23-4920-BA74-E3E452F7C765" name="GUID-D6AC4B25-2A23-4920-BA74-E3E452F7C765"></a><h5 id="ADDCI-GUID-D6AC4B25-2A23-4920-BA74-E3E452F7C765" class="sect5"><span class="enumeration_section">9.2.2.3</span>将Contains（）运算符绑定到功能实现</h5>
                     <div>
                        <div class="example" id="GUID-D6AC4B25-2A23-4920-BA74-E3E452F7C765__CHDBFEHA">
                           <p class="titleinexample">示例9-16将Contains（）运算符绑定到功能实现</p><pre class="oac_no_warn" dir="ltr">CREATE OPERATOR包含BINDING（VARCHAR2，VARCHAR2）RETURN NUMBER WITH INDEX CONTEXT，SCAN语境TextIndexMethods使用TextContains;</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="ADDCI4540"></a><div class="props_rev_3"><a id="GUID-CDFA26DA-2481-4D9B-9467-4EEC8D6A1ABC" name="GUID-CDFA26DA-2481-4D9B-9467-4EEC8D6A1ABC"></a><h5 id="ADDCI-GUID-CDFA26DA-2481-4D9B-9467-4EEC8D6A1ABC" class="sect5"><span class="enumeration_section">9.2.2.4</span>运营商解决方案</h5>
                     <div>
                        <p>如果运算符出现在<code class="codeph">WHERE</code>子句之外，Oracle会调用运算符的函数实现。如果功能实现是基于索引的，或者定义为使用索引类型，则附加索引信息作为参数传递，但前提是操作符的第一个参数是具有相应索引类型的域索引的列或对象属性。
                        </p>
                        <p>例如，在查询<code class="codeph">SELECT Contains(resume, 'Oracle &amp; Unix') FROM MyEmployees</code> ，Oracle使用基于索引的功能实现来评估运算符<code class="codeph">Contains()</code> ，并在<code class="codeph">resume</code>列上传递有关域索引的索引信息，而不是<code class="codeph">resume</code>数据。
                        </p>
                     </div>
                  </div><a id="ADDCI4541"></a><div class="props_rev_3"><a id="GUID-1C024DAF-5C6D-4D12-AF38-3DCD89B8FCF3" name="GUID-1C024DAF-5C6D-4D12-AF38-3DCD89B8FCF3"></a><h5 id="ADDCI-GUID-1C024DAF-5C6D-4D12-AF38-3DCD89B8FCF3" class="sect5"><span class="enumeration_section">9.2.2.5</span>操作员执行</h5>
                     <div>
                        <p>为了执行基于索引的功能实现，Oracle以下列方式设置参数：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>初始参数集与用户为运算符指定的参数集相同。</p>
                           </li>
                           <li>
                              <p>如果第一个参数不是列，则<code class="codeph">ODCIIndexCtx</code>属性设置为<code class="codeph">NULL</code> 。</p>
                           </li>
                           <li>
                              <p>如果第一个参数是列，则<code class="codeph">ODCIIndexCtx</code>属性设置如下。
                              </p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>如果存在适用的域索引，则<code class="codeph">ODCIIndexInfo</code>属性包含有关它的信息;否则该属性设置为<code class="codeph">NULL</code> 。</p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">rowid</code>属性保存正在操作的行的行标识符。
                                    </p>
                                 </li>
                              </ul>
                           </li>
                           <li>
                              <p>在第一次调用运算符时，扫描上下文设置为<code class="codeph">NULL</code> 。因为它是<code class="codeph">IN</code> / <code class="codeph">OUT</code>参数，所以第一次调用的返回值将传递给第二次调用，依此类推。
                              </p>
                           </li>
                           <li>
                              <p>对于运营商的所有正常调用，扫描标志设置为<code class="codeph">RegularCall</code> 。在最后一次调用之后，再次调用功能实现，此时可以执行任何清理操作。在此调用期间，扫描标志设置为<code class="codeph">CleanupCall</code> ，除扫描上下文之外的所有其他参数都设置为<code class="codeph">NULL</code> 。</p>
                           </li>
                        </ul>
                        <p>传入索引信息时，实现可以使用行标识符作为键来使用域索引查找来计算运算符值。索引元数据用于标识与域索引关联的索引结构。扫描上下文通常用于与同一运算符的后续调用共享状态。</p>
                        <p>如果没有支持运算符的索引类型，或者传递给运算符的列上没有域索引作为其第一个参数，则索引上下文参数为null。但是，扫描上下文参数仍然可用。因此，即使查询未使用索引，操作员也可以在调用之间维护状态。</p>
                     </div>
                  </div>
               </div><a id="ADDCI4543"></a><a id="ADDCI4542"></a><div class="props_rev_3"><a id="GUID-86CBAE69-64D2-4A2D-944F-67388FFD1DF8" name="GUID-86CBAE69-64D2-4A2D-944F-67388FFD1DF8"></a><h4 id="ADDCI-GUID-86CBAE69-64D2-4A2D-944F-67388FFD1DF8" class="sect4"><span class="enumeration_section">9.2.3</span>返回辅助数据的运算符</h4>
                  <div>
                     <p>除了过滤行之外， <code class="codeph">WHERE</code>子句中的运算符有时必须返回辅助数据。辅助数据被建模为一个或多个运算符，每个运算符都有</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>单个文字数字参数，它将其与相应的主操作符绑定</p>
                        </li>
                        <li>
                           <p>一种功能实现，可访问由主运算符的基于索引扫描的实现生成的状态</p>
                        </li>
                     </ul>
                     <p>在<a href="defining-operators.html#GUID-86CBAE69-64D2-4A2D-944F-67388FFD1DF8__CHDIFCGD">例9-17</a>的查询中，可以使用索引扫描来评估主运算符<code class="codeph">Contains()</code> ，索引扫描确定哪些行满足谓词，并计算每行的分数值。<code class="codeph">Score</code>运算符的功能实现访问索引扫描生成的状态，以获取由其行标识符标识的给定行的分数。文字参数<code class="codeph">1</code>将辅助运算符<code class="codeph">Score</code>与主运算符<code class="codeph">Contains()</code>相关联，后者生成辅助数据。
                     </p>
                     <p>辅助运算符的功能实现可以使用域索引或主运算符生成的状态。调用时，函数实现会传递三个额外的参数：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>索引上下文，包含域索引信息</p>
                        </li>
                        <li>
                           <p>扫描上下文，提供对主操作员生成的状态的访问</p>
                        </li>
                        <li>
                           <p>扫描标志，指示是否最后一次调用功能实现</p>
                        </li>
                     </ul>
                     <p>考虑如何定义和调用对辅助数据建模的运算符。</p>
                     <div class="example" id="GUID-86CBAE69-64D2-4A2D-944F-67388FFD1DF8__CHDIFCGD">
                        <p class="titleinexample">示例9-17使用Contains（）运算符访问辅助数据</p><pre class="oac_no_warn" dir="ltr">SELECT Score（1）FROM MyEmployees WHERE Contains（resume，'OCI＆UNIX'，1）= 1;</pre></div>
                     <!-- class="example" -->
                  </div><a id="ADDCI4545"></a><a id="ADDCI4546"></a><a id="ADDCI4544"></a><div class="props_rev_3"><a id="GUID-4477D845-0029-4E2B-B369-F2934E43F220" name="GUID-4477D845-0029-4E2B-B369-F2934E43F220"></a><h5 id="ADDCI-GUID-4477D845-0029-4E2B-B369-F2934E43F220" class="sect5"><span class="enumeration_section">9.2.3.1</span>计算辅助数据的运算符绑定</h5>
                     <div>
                        <p>计算辅助数据的运算符绑定称为a <a id="d28333e2452" class="indexterm-anchor"></a> <strong class="term">主要约束力</strong> 。<a href="defining-operators.html#GUID-4477D845-0029-4E2B-B369-F2934E43F220__CHDHBIBJ">例9-18</a>定义了运算符<code class="codeph">Contains()</code>的主绑定。
                        </p>
                        <p>此定义为<code class="codeph">Contains()</code>注册两个绑定：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">CONTAINS(VARCHAR2</code> ， <code class="codeph">VARCHAR2)</code> ，在不需要辅助数据时使用</p>
                           </li>
                           <li>
                              <p><code class="codeph">CONTAINS(VARCHAR2</code> ， <code class="codeph">VARCHAR2</code> ， <code class="codeph">NUMBER)</code> ，在需要辅助数据时使用（ <code class="codeph">NUMBER</code>参数将此绑定与辅助运算符绑定相关联）</p>
                           </li>
                        </ul>
                        <p>这两个绑定具有单个功能实现，如<a href="defining-operators.html#GUID-4477D845-0029-4E2B-B369-F2934E43F220__CHDGEJDJ">例9-19</a>所示：</p>
                        <div class="example" id="GUID-4477D845-0029-4E2B-B369-F2934E43F220__CHDHBIBJ">
                           <p class="titleinexample">示例9-18比较辅助数据与Contains（）运算符</p><pre class="oac_no_warn" dir="ltr">CREATE OPERATOR包含BINDING（VARCHAR2，VARCHAR2）RETURN NUMBER WITH INDEX CONTEXT，SCAN语境TextIndexMethods使用TextContains计算辅助数据;</pre></div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-4477D845-0029-4E2B-B369-F2934E43F220__CHDGEJDJ">
                           <p class="titleinexample">示例9-19为计算实现绑定</p><pre class="oac_no_warn" dir="ltr"><code class="codeph">TextContains(VARCHAR2,</code> <code class="codeph">VARCHAR2</code> ， <code class="codeph">ODCIIndexCtx</code> ， <code class="codeph">TextIndexMethods, NUMBER</code> ）。</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="ADDCI4548"></a><a id="ADDCI4549"></a><a id="ADDCI4547"></a><div class="props_rev_3"><a id="GUID-857F0B5F-CDA7-4CD7-823E-FD0B23E67BA1" name="GUID-857F0B5F-CDA7-4CD7-823E-FD0B23E67BA1"></a><h5 id="ADDCI-GUID-857F0B5F-CDA7-4CD7-823E-FD0B23E67BA1" class="sect5"><span class="enumeration_section">9.2.3.2</span>模拟辅助数据的运算符绑定</h5>
                     <div>
                        <p>对辅助数据建模的运算符绑定称为<a id="d28333e2572" class="indexterm-anchor"></a> <strong class="term">辅助绑定</strong> 。辅助数据运算符的功能实现类似于基于索引的功能实现。定义函数后，使用附加的<code class="codeph">ANCILLARY</code> <code class="codeph">TO</code>属性将其绑定到运算符，指示功能实现必须与主运算符绑定共享其状态。
                        </p>
                        <p>请注意，辅助运算符绑定的功能实现必须与主运算符绑定的功能实现具有相同的签名。</p>
                        <p><a href="defining-operators.html#GUID-857F0B5F-CDA7-4CD7-823E-FD0B23E67BA1__CHDHHHCD">例9-20</a>演示了如何在<code class="codeph">TextScore</code> （）函数中评估辅助运算符。
                        </p>
                        <p>使用<code class="codeph">TextScore()</code>定义，您可以创建辅助绑定，如<a href="defining-operators.html#GUID-857F0B5F-CDA7-4CD7-823E-FD0B23E67BA1__CHDCJEBH">例9-21所示</a> 。
                        </p>
                        <p><code class="codeph">ANCILLARY</code> <code class="codeph">TO</code>子句指定<code class="codeph">Score</code>与主操作符绑定<code class="codeph">CONTAINS(VARCHAR2</code> ， <code class="codeph">VARCHAR2)</code>共享状态。
                        </p>
                        <p>使用单个文字数参数调用辅助运算符绑定，例如<code class="codeph">Score</code> （1）， <code class="codeph">Score</code> （2）等。
                        </p>
                        <div class="example" id="GUID-857F0B5F-CDA7-4CD7-823E-FD0B23E67BA1__CHDHHHCD">
                           <p class="titleinexample">例9-20评估辅助操作员</p><pre class="oac_no_warn" dir="ltr">创建函数TextScore（文本IN VARCHAR2，键入IN VARCHAR2，indexctx IN ODCIIndexCtx，scanctx IN OUT TextIndexMethods，scanflg IN NUMBER）返回数字开始.......结束TextScore;</pre></div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-857F0B5F-CDA7-4CD7-823E-FD0B23E67BA1__CHDCJEBH">
                           <p class="titleinexample">示例9-21创建辅助运算符绑定</p><pre class="oac_no_warn" dir="ltr">创建运算符分数绑定（数字）使用TextScore返回包含的数字（VARCHAR2，VARCHAR2）;</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="ADDCI4550"></a><div class="props_rev_3"><a id="GUID-1505D347-6D21-47A4-8870-ED57BF845AFF" name="GUID-1505D347-6D21-47A4-8870-ED57BF845AFF"></a><h5 id="ADDCI-GUID-1505D347-6D21-47A4-8870-ED57BF845AFF" class="sect5"><span class="enumeration_section">9.2.3.3</span>运营商解决方案</h5>
                     <div>
                        <p>用户使用单个数字参数调用与辅助数据相对应的运算符。此数字参数在辅助操作和主操作符调用中都必须是文字，以便可以在查询编译时完成操作员关联。</p>
                        <p>为了确定相应的主运算符，Oracle将传递给辅助运算符的数字与作为主运算符的最后一个参数传递的数字进行匹配。找到零个或多个匹配的主运算符调用是错误的。找到匹配的主操作符调用后，</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>主运算符的参数成为辅助运算符的操作数。</p>
                           </li>
                           <li>
                              <p>辅助和主要操作员执行传递相同的扫描上下文。</p>
                           </li>
                        </ul>
                        <p>例如，在<a href="defining-operators.html#GUID-86CBAE69-64D2-4A2D-944F-67388FFD1DF8__CHDIFCGD">例9-17</a>查询中，根据数字参数<code class="codeph">1</code>确定<code class="codeph">Score</code>的调用是<code class="codeph">Contains()</code>的辅助， <code class="codeph">Score</code>的功能实现获取操作数<code class="codeph">(resume</code> ， <code class="codeph">'Oracle&amp;Unix'</code> ， <code class="codeph">indexctx</code> ， <code class="codeph">scanctx, scanflg)</code> ，其中<code class="codeph">scanctx</code>与<code class="codeph">Contains()</code>的调用共享。
                        </p>
                     </div>
                  </div><a id="ADDCI4551"></a><div class="props_rev_3"><a id="GUID-70701FED-2C43-4E38-A6D4-7F330284A21C" name="GUID-70701FED-2C43-4E38-A6D4-7F330284A21C"></a><h5 id="ADDCI-GUID-70701FED-2C43-4E38-A6D4-7F330284A21C" class="sect5"><span class="enumeration_section">9.2.3.4</span>操作员执行</h5>
                     <div>
                        <p>运算符执行使用索引扫描来处理<code class="codeph">Contains()</code>运算符。对于索引扫描的<code class="codeph">fetch()</code>调用返回的每一行，通过向其传递<code class="codeph">ODCIIndexCtx</code>参数来调用<code class="codeph">Score</code>的功能实现，该参数包含索引信息，行标识符和索引扫描状态的句柄。功能实现可以使用索引扫描状态的句柄来计算分数。
                        </p>
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>