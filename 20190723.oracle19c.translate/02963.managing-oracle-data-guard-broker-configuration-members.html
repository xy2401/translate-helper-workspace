<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="Learn how to manage broker configuration members, and monitor the state of each member of the configuration."></meta>
      <meta name="description" content="Learn how to manage broker configuration members, and monitor the state of each member of the configuration."></meta>
      <title>管理代理配置的成员</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Broker "></meta>
      <meta property="og:description" content="Learn how to manage broker configuration members, and monitor the state of each member of the configuration."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Broker"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="data-guard-broker.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-03-29T04:14:25-07:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="1999, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96245-02"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="managing-oracle-data-guard-broker-configurations.html" title="Previous" type="text/html"></link>
      <link rel="next" href="using-data-guard-broker-to-manage-switchovers-failovers.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Data Guard Broker"></meta>
    <meta name="dcterms.isVersionOf" content="DGBKR"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="managing-oracle-data-guard-broker-configurations.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="using-data-guard-broker-to-manage-switchovers-failovers.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">经纪人</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">管理代理配置的成员</li>
            </ol>
            <a id="GUID-0CD70A29-4F51-4CC1-88EB-2D8AA29F75D7" name="GUID-0CD70A29-4F51-4CC1-88EB-2D8AA29F75D7"></a><a id="DGBKR135"></a>
            
            <h2 id="DGBKR-GUID-0CD70A29-4F51-4CC1-88EB-2D8AA29F75D7" class="sect2"><span class="enumeration_chapter">4</span>管理代理配置的成员</h2>
         </header>
         <div class="ind"><script type="text/javascript">window.name='managing-oracle-data-guard-broker-configuration-members'</script><script type="text/javascript">
    function footdisplay(footnum,footnote) {
    var msg = window.open('about:blank', 'NewWindow' + footnum,
        'directories=no,height=100,location=no,menubar=no,resizable=yes,' +
        'scrollbars=yes,status=no,toolbar=no,width=598');
    msg.document.open('text/html');
    msg.document.write('<!DOCTYPE html ');
    msg.document.write('PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" ');
    msg.document.write('"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">'); 
    msg.document.write('<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us" dir="ltr"><head><title>');
   
    msg.document.write('Footnote&nbsp; ' + footnum);
    msg.document.write('<\/title><meta http-equiv="Content-Type" ');
    msg.document.write('content="text/html; charset=utf-8" />');
    msg.document.write('<meta http-equiv="Content-Script-Type" ');
    msg.document.write('content="text/javascript" />');
    msg.document.write('<style type="text/css"> <![CDATA[ ');
    msg.document.write('h1 {text-align: center; font-size: 14pt;}');
    msg.document.write('fieldset {border: none;}');
    msg.document.write('form {text-align: center;}');
    msg.document.write(' ]]u003e </style>');
    msg.document.write('<\/head><body><div id="footnote"><h1>Footnote&nbsp; ' + footnum + '<\/h1><p>');
    msg.document.write(footnote);
    msg.document.write('<\/p><form action="" method="post"><fieldset>');
    msg.document.write('<input type="button" value="OK" ');
    msg.document.write('onclick="window.close();" />');
    msg.document.write('<\/fieldset><\/form><\/div><\/body><\/html>');
    msg.document.close();
    setTimeout(function() {
        var height = msg.document.getElementById('footnote').offsetHeight;
        msg.resizeTo(598, height + 100);
    }
    , 100);
    msg.focus();
}
            </script><noscript>
               <p>此页面上的脚本内容仅用于导航目的，不会以任何方式更改内容。</p>
            </noscript>
            <div>
               <p>了解如何管理代理配置成员，以及监视配置的每个成员的状态。</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="managing-oracle-data-guard-broker-configuration-members.html#GUID-679ACCCD-309C-49A3-ADCF-8A3D8635ADCA" title="代理使用其配置文件中的信息来管理和监视配置的每个成员的状态。">管理代理配置成员</a></p>
                  </li>
                  <li>
                     <p><a href="managing-oracle-data-guard-broker-configuration-members.html#GUID-7430128F-D79C-4F6A-8932-8830478B83AB" title="配置的成员可以处于各种状态，在启用的配置中，这些状态确定Oracle Data Guard的行为。">管理代理配置成员的状态</a></p>
                  </li>
                  <li>
                     <p><a href="managing-oracle-data-guard-broker-configuration-members.html#GUID-5CA7C5EC-DE39-482D-8E54-2C3126651271" title="有两种类型的数据库属性：可监视和可配置。">管理数据库属性</a></p>
                  </li>
                  <li>
                     <p><a href="managing-oracle-data-guard-broker-configuration-members.html#GUID-6DC53E53-63F3-42D7-865E-C7689AEBD44A" title="要管理重做传输服务，请在每个配置成员上指定可配置属性。">管理重做传输服务</a></p>
                  </li>
                  <li>
                     <p><a href="managing-oracle-data-guard-broker-configuration-members.html#GUID-845BE719-CC15-4D6C-BD91-FF935CAE605A" title="零数据丢失恢复设备（恢复设备）的重做传输服务的管理方式与备用数据库相同。">管理恢复设备的重做传输服务</a></p>
                  </li>
                  <li>
                     <p><a href="managing-oracle-data-guard-broker-configuration-members.html#GUID-6753936C-E2E3-471E-BCC5-0C4697AD4255" title="您可以使用与log apply相关的数据库属性在物理和逻辑备用数据库上管理Redo Apply和SQL Apply。">管理日志应用服务</a></p>
                  </li>
                  <li>
                     <p><a href="managing-oracle-data-guard-broker-configuration-members.html#GUID-994BE350-859F-41DC-A1D3-B6E8D5EEF2C8" title="您可以使用代理设置具有任何不同数据保护模式的配置。">管理数据保护模式</a></p>
                  </li>
                  <li>
                     <p><a href="managing-oracle-data-guard-broker-configuration-members.html#GUID-247E7C1E-EEC0-42CA-AC9F-E73948F5EDC1" title="Oracle Data Guard远程同步实例是一个重做传输目标，它接受来自主数据库的重做，并将该重做转发到配置中的一个或多个重做目标。">管理远程同步实例</a></p>
                  </li>
                  <li>
                     <p><a href="managing-oracle-data-guard-broker-configuration-members.html#GUID-E2C40F7E-8ACC-4A75-AAAA-52E54F39F488" title="您可以启用快速启动故障转移，以允许代理确定是否需要进行故障转移，以及从一个或多个预先指定的目标备用数据库的列表启动到备用数据库的故障转移。">管理快速启动故障转移</a></p>
                  </li>
                  <li>
                     <p><a href="managing-oracle-data-guard-broker-configuration-members.html#GUID-0F7CA42F-1FE4-437E-9A2E-3FD3D2738BC1" title="您可以使用DGMGRL CONVERT DATABASE命令将物理备用数据库转换为快照备用数据库。">管理数据库转换</a></p>
                  </li>
                  <li>
                     <p><a href="managing-oracle-data-guard-broker-configuration-members.html#GUID-85D20060-248B-42A1-B78D-15C23AAA2F59" title="通常，代理通过验证实际数据库状态和设置是否与代理配置文件中描述的相匹配来检查数据库的运行状况。">数据库状态</a></p>
                  </li>
               </ul>
            </div><a id="DGBKR140"></a><div class="props_rev_3"><a id="GUID-679ACCCD-309C-49A3-ADCF-8A3D8635ADCA" name="GUID-679ACCCD-309C-49A3-ADCF-8A3D8635ADCA"></a><h3 id="DGBKR-GUID-679ACCCD-309C-49A3-ADCF-8A3D8635ADCA" class="sect3"><span class="enumeration_section">4.1</span>管理代理配置成员</h3>
               <div>
                  <p>代理使用其配置文件中的信息来管理和监视配置的每个成员的状态。</p>
                  <p>代理在代理配置中区分不同类型的成员。每种类型的成员都有一组适合该类型成员的状态和属性。</p>
               </div>
            </div><a id="DGBKR3530"></a><a id="DGBKR145"></a><div class="props_rev_3"><a id="GUID-7430128F-D79C-4F6A-8932-8830478B83AB" name="GUID-7430128F-D79C-4F6A-8932-8830478B83AB"></a><h3 id="DGBKR-GUID-7430128F-D79C-4F6A-8932-8830478B83AB" class="sect3"><span class="enumeration_section">4.2</span>管理代理配置成员的状态</h3>
               <div>
                  <p>配置的成员可以处于各种状态，在启用的配置中，这些状态确定Oracle Data Guard的行为。</p>
                  <p>下表描述了各种状态。</p>
                  <p>此表中未列出快照备用数据库，因为它们没有状态;他们只收到重做数据。</p>
                  <p>远程同步实例也不包含在此表中，因为它们没有状态;他们只接收重做并将其转发到备用数据库。</p>
                  <p>零数据丢失恢复设备未包含在此表中，因为它们没有状态。</p>
                  <div class="tblformal" id="GUID-7430128F-D79C-4F6A-8932-8830478B83AB__G1037265">
                     <p class="titleintable">表4-1数据库状态和说明</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="数据库状态和说明" width="100%" border="1" summary="This 3 column table describes all of the primary and standby database states. Column 1 is the database role. Column 2 is the state. Column 3 is a description of the state." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="21%" id="d7524e207">数据库角色</th>
                              <th align="left" valign="bottom" width="28%" id="d7524e210">州名</th>
                              <th align="left" valign="bottom" width="51%" id="d7524e213">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="21%" id="d7524e218" headers="d7524e207 ">
                                 <p>主</p>
                              </td>
                              <td align="left" valign="top" width="28%" headers="d7524e218 d7524e210 ">
                                 <p><code class="codeph">运输-ON</code></p>
                              </td>
                              <td align="left" valign="top" width="51%" headers="d7524e218 d7524e213 ">
                                 <p>重做传输服务设置为在主数据库打开以进行读/写访问时将重做数据传输到备用数据库或远程同步实例。</p>
                                 <p>如果这是Oracle RAC数据库，则以读/写模式打开的所有实例都将运行重做传输服务。</p>
                                 <p>这是第一次启用主数据库时的默认状态。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="21%" id="d7524e233" headers="d7524e207 ">
                                 <p>主</p>
                              </td>
                              <td align="left" valign="top" width="28%" headers="d7524e233 d7524e210 ">
                                 <p><code class="codeph">运输-OFF</code></p>
                              </td>
                              <td align="left" valign="top" width="51%" headers="d7524e233 d7524e213 ">
                                 <p>重做传输服务在主数据库上停止。</p>
                                 <p>如果这是Oracle RAC数据库，则重做传输服务不会在任何实例上运行。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="21%" id="d7524e246" headers="d7524e207 ">
                                 <p>物理待机</p>
                              </td>
                              <td align="left" valign="top" width="28%" headers="d7524e246 d7524e210 ">
                                 <p><code class="codeph">应用于</code></p>
                              </td>
                              <td align="left" valign="top" width="51%" headers="d7524e246 d7524e213 ">
                                 <p>重做应用在物理备用数据库上启动。</p>
                                 <p>如果备用数据库是Oracle RAC数据库，则代理会在一个名为apply instance的备用实例上启动Redo Apply。如果此实例失败，则代理会自动选择另一个已挂载或以只读方式打开的实例。然后，这个新实例成为apply实例。</p>
                                 <p>如Oracle数据库<span class="italic">12c的</span>第2版（12.2.0.1）的，重做应用可以被设置在每个有源运行物理备用实例运行。如果已设置数据库以在多个实例上运行Redo Apply，则可以使用Data Guard代理属性<code class="codeph">ApplyInstances</code>来限制Oracle RAC物理备用数据库上的重做应用中涉及的实例数。
                                 </p>
                                 <p><code class="codeph">APPLY-ON</code>是物理备用数据库第一次启用时的默认状态。
                                 </p>
                                 <p>如果已购买Oracle Active Data Guard选件的许可证，则可以在Redo Apply处于活动状态时打开物理备用数据库。此功能称为实时查询。有关更多详细信息，请参阅<a href="../sbydb/managing-oracle-data-guard-physical-standby-databases.html#SBYDB00706" target="_blank"><span class="italic">Oracle Data Guard概念和管理</span></a> 。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="21%" id="d7524e278" headers="d7524e207 ">
                                 <p>物理待机</p>
                              </td>
                              <td align="left" valign="top" width="28%" headers="d7524e278 d7524e210 ">
                                 <p><code class="codeph">适用-OFF</code></p>
                              </td>
                              <td align="left" valign="top" width="51%" headers="d7524e278 d7524e213 ">
                                 <p>重做应用已停止。</p>
                                 <p>如果这是Oracle RAC数据库，则在将数据库状态更改为<code class="codeph">APPLY-ON</code>之前，没有运行Apply Services的实例。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="21%" id="d7524e294" headers="d7524e207 ">
                                 <p>逻辑备用</p>
                              </td>
                              <td align="left" valign="top" width="28%" headers="d7524e294 d7524e210 ">
                                 <p><code class="codeph">应用于</code></p>
                              </td>
                              <td align="left" valign="top" width="51%" headers="d7524e294 d7524e213 ">
                                 <p>SQL Apply在逻辑备用数据库打开并且逻辑备用数据库防护打开时在其上启动。</p>
                                 <p>如果这是Oracle RAC数据库，则SQL Apply正在一个实例上运行，即apply实例。如果此实例失败，则代理会自动选择另一个打开的实例。这个新实例成为apply实例。</p>
                                 <p>这是第一次启用逻辑备用数据库时的默认状态。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="21%" id="d7524e309" headers="d7524e207 ">
                                 <p>逻辑备用</p>
                              </td>
                              <td align="left" valign="top" width="28%" headers="d7524e309 d7524e210 ">
                                 <p><code class="codeph">适用-OFF</code></p>
                              </td>
                              <td align="left" valign="top" width="51%" headers="d7524e309 d7524e213 ">
                                 <p>SQL Apply已停止。逻辑备用数据库防护已打开。</p>
                                 <p>如果这是Oracle RAC数据库，则在将状态更改为<code class="codeph">APPLY-ON</code>之前，没有运行SQL Apply的实例。</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
               </div><a id="DGBKR3531"></a><a id="DGBKR3532"></a><a id="DGBKR3534"></a><a id="DGBKR150"></a><div class="props_rev_3"><a id="GUID-D8E8E357-C19D-49AD-AF6E-162B97C3B7B6" name="GUID-D8E8E357-C19D-49AD-AF6E-162B97C3B7B6"></a><h4 id="DGBKR-GUID-D8E8E357-C19D-49AD-AF6E-162B97C3B7B6" class="sect4"><span class="enumeration_section">4.2.1</span>数据库状态转换</h4>
                  <div>
                     <p>您可以使用DGMGRL <code class="codeph">EDIT DATABASE</code>命令显式更改数据库的状态。
                     </p>
                     <p>例如，以下示例中的<code class="codeph">EDIT DATABASE</code>命令将<code class="codeph">North_Sales</code>数据库的状态更改为<code class="codeph">TRANSPORT-OFF</code> 。</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt;编辑数据库'North_Sales'Set STATE ='TRANSPORT-OFF';成功了。</pre><p>以下部分更详细地描述了主数据库和备用数据库的可能状态转换。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-D8E8E357-C19D-49AD-AF6E-162B97C3B7B6__GUID-F6EBAC2F-B13A-43B1-84BD-4D351F1EE66D">主数据库状态转换</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>将主数据库转换为<code class="codeph">TRANSPORT-ON</code>状态时，代理使用配置成员的重做传输相关属性和主数据库中的<code class="codeph">RedoRoutes</code>属性设置重做传输服务。重做传输服务的设置是通过设置完成<code class="codeph">LOG_ARCHIVE_DEST_</code> <span class="variable" translate="no">n</span>和<code class="codeph">LOG_ARCHIVE_DEST_STATE_</code> <span class="variable" translate="no">n</span>主数据库上的初始化参数，以及<code class="codeph">LOG_ARCHIVE_CONFIG</code>初始化参数上的所有数据库（主或备用），远远同步的情况。如有必要，代理还会设置数据库的数据保护模式，以匹配代理配置文件中记录的保护模式。最后，如果数据库已打开，则代理会为每个线程切换日志以启动重做传输服务。
                        </p>
                        <p>将主数据库转换为<code class="codeph">TRANSPORT-OFF</code>状态时，代理通过重置<code class="codeph">LOG_ARCHIVE_DEST_STATE_</code> <span class="variable" translate="no">n</span>初始化参数来关闭重做传输服务到所有代理管理的备用数据库。停止向所有经纪人管理的备用数据库传输重做数据。日志文件继续在主数据库中存档。
                        </p>
                        <p>如果主数据库是Oracle RAC数据库，则代理将使用完全相同的设置在所有主实例上配置重做传输服务。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-D8E8E357-C19D-49AD-AF6E-162B97C3B7B6__GUID-EAA85C02-2619-4AD0-BB4F-3EEF1F399CE7">物理备用数据库状态转换</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>将物理备用数据库转换为<code class="codeph">APPLY-ON</code>状态时，代理将使用与重做应用相关的属性指定的选项启动重做应用。如果备用数据库是Oracle RAC数据库，则代理在一个称为应用实例的备用实例上启动Redo Apply。
                        </p>
                        <p>如Oracle数据库<span class="italic">12c的</span>第2版（12.2.0.1）的，重做应用可设置为在多个活动运行物理备用实例运行。（此功能要求备用数据库具有Oracle Active Data Guard选项的许可证。）如果已设置数据库以在多个实例上运行Redo Apply，则可以使用Data Guard代理属性<code class="codeph">ApplyInstances</code>来限制Oracle RAC物理备用数据库上的重做应用中涉及的实例数。
                        </p>
                        <p>如果已购买Oracle Active Data Guard选件的许可证，则可以在Redo Apply处于活动状态时打开物理备用数据库。此功能称为实时查询。有关更多详细信息，请参阅<a href="../sbydb/managing-oracle-data-guard-physical-standby-databases.html#SBYDB00706" target="_blank"><span class="italic">Oracle Data Guard概念和管理</span></a> 。
                        </p>
                        <p>如果打开任何其他实例，则必须在启动重做应用之前打开apply实例。</p>
                        <p>转换到<code class="codeph">APPLY-OFF</code>状态时，代理会停止重做应用。
                        </p>
                        <div class="infoboxnote" id="GUID-D8E8E357-C19D-49AD-AF6E-162B97C3B7B6__GUID-3CCF9B95-3921-4F15-9F63-B1F7D871170E">
                           <p class="notep1">注意：</p>
                           <p>如果在物理备用数据库上使用Oracle RAC One节点执行联机数据库重定位，则新实例将以与当前运行实例相同的模式启动。因此，如果数据库安装在原始实例上，则数据库将安装在新实例上。同样，如果数据库在原始实例上打开，则数据库将在新实例上打开。这可能导致新实例以与Oracle Clusterware为数据库记录的启动选项不匹配的模式启动。</p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-D8E8E357-C19D-49AD-AF6E-162B97C3B7B6__GUID-D7E02CBE-2576-4FB3-B37D-BFA35E855971">逻辑备用数据库状态转换</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>将逻辑备用数据库转换为<code class="codeph">APPLY-ON</code>状态时，代理将等待数据库打开，然后启用数据库防护以防止修改逻辑备用数据库中的表，并使用日志指定的选项启动SQL Apply与申请相关的财产。如果逻辑备用数据库是Oracle RAC数据库，则代理在一个备用实例（应用实例）上启动SQL Apply。
                        </p>
                        <p>转换到<code class="codeph">APPLY-OFF</code>状态时，代理会停止SQL Apply。
                        </p>
                        <div class="infoboxnotealso" id="GUID-D8E8E357-C19D-49AD-AF6E-162B97C3B7B6__GUID-DB8B530E-007E-47AF-ACB6-FFB9664F7075">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><a href="managing-oracle-data-guard-broker-configuration-members.html#GUID-6753936C-E2E3-471E-BCC5-0C4697AD4255" title="您可以使用与log apply相关的数据库属性在物理和逻辑备用数据库上管理Redo Apply和SQL Apply。">管理Log Apply Services</a>以获取有关管理SQL Apply的信息</p>
                              </li>
                              <li>
                                 <p><a href="managing-oracle-data-guard-broker-configuration-members.html#GUID-6DC53E53-63F3-42D7-865E-C7689AEBD44A" title="要管理重做传输服务，请在每个配置成员上指定可配置属性。">管理重做传输服务</a>以获取有关管理重做传输服务的更多详细信息以及与重做传输相关的属性列表</p>
                              </li>
                              <li>
                                 <p>有关数据库防护的信息，请参阅<a href="../sbydb/managing-oracle-data-guard-logical-standby-databases.html#SBYDB4827" target="_blank"><span class="italic">Oracle Data Guard概念和管理</span></a></p>
                              </li>
                              <li>
                                 <p>有关<code class="codeph">EDIT DATABASE</code>命令的完整信息，请参阅<a href="oracle-data-guard-broker-commands.html#GUID-E7889124-C414-466F-9FBB-B8F035881F89" title="使用命令参考了解如何使用Data Guard代理命令行界面（DGMGRL）来管理代理配置。">Oracle Data Guard命令行界面参考</a> 。
                                 </p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="DGBKR3535"></a><a id="DGBKR155"></a><div class="props_rev_3"><a id="GUID-5CA7C5EC-DE39-482D-8E54-2C3126651271" name="GUID-5CA7C5EC-DE39-482D-8E54-2C3126651271"></a><h3 id="DGBKR-GUID-5CA7C5EC-DE39-482D-8E54-2C3126651271" class="sect3"><span class="enumeration_section">4.3</span>管理数据库属性</h3>
               <div>
                  <p>有两种类型的数据库属性：可监视和可配置。</p>
                  <p>可监视和可配置属性都可以进一步划分为具有数据库范围或特定于实例的范围的属性。</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>只有在启用关联数据库时，才能查看可监视属性值。</p>
                        <p>可监视属性允许您查看与数据库相关的运行时信息，但不能更改这些属性的值。</p>
                     </li>
                     <li>
                        <p>可以查看和动态更新可配置的属性值。</p>
                        <p>可配置属性会影响代理的操作或配置。您可以使用DGMGRL或Cloud Control更改这些属性的值。无论是启用还是禁用配置及其成员，都可以编辑属性。但是，如果禁用配置成员，则在您根据需要启用配置或成员之前，新属性值不会生效。</p>
                        <div class="infoboxnotealso" id="GUID-5CA7C5EC-DE39-482D-8E54-2C3126651271__GUID-62CD8E34-1D42-446A-BED7-97DCA9ACE99C">
                           <p class="notep1">也可以看看：</p>
                           <p> <a href="oracle-data-guard-broker-properties.html#GUID-1966A317-DD75-4385-8A64-ADEC75662F7E" title="使用Oracle Data Guard代理属性来管理实例或整个配置。">Oracle Data Guard Broker属性</a> ，提供所有数据库属性的详细列表</p>
                        </div>
                     </li>
                  </ul>
                  <p>要查看这些属性，可以使用Cloud Control中的DGMGRL <code class="codeph">SHOW</code>命令或“编辑属性”页面。<a href="managing-oracle-data-guard-broker-configuration-members.html#GUID-5CA7C5EC-DE39-482D-8E54-2C3126651271__CHDEBGGH">示例4-1</a>使用<code class="codeph">SHOW DATABASE VERBOSE</code>命令显示有关<code class="codeph">North_Sales</code>数据库的信息。
                  </p>
                  <div class="infoboxnotealso" id="GUID-5CA7C5EC-DE39-482D-8E54-2C3126651271__GUID-4780B6F6-4D94-4D3E-9DC1-AFF1A112A38D">
                     <p class="notep1">也可以看看：</p>
                     <p>有关DGMGRL命令行界面的完整信息，请参阅<a href="oracle-data-guard-broker-commands.html#GUID-E7889124-C414-466F-9FBB-B8F035881F89" title="使用命令参考了解如何使用Data Guard代理命令行界面（DGMGRL）来管理代理配置。">Oracle Data Guard命令行界面参考</a></p>
                  </div>
                  <div class="example" id="GUID-5CA7C5EC-DE39-482D-8E54-2C3126651271__CHDEBGGH">
                     <p class="titleinexample">示例4-1使用SHOW DATABASE VERBOSE命令显示属性</p>
                     <p></p><pre class="pre codeblock"><code>显示数据库VERBOSE'North_Sales';数据库 -  North_Sales角色：PRIMARY目标状态：TRANSPORT-ON实例：North_sales1属性：DGConnectIdentifier ='North_Sales.example.com'ObserverConnectIdentifier =''FastStartFailoverTarget =''PreferredObserverHosts =''LogShipping ='ON'RedoRoutes ='' LogXptMode ='ASYNC'DelayMins ='0'Binding ='optional'MaxFailure ='0'ReopenSecs ='30'NetTimeout ='300'RedoCompression ='DISABLE'AdferredApplyInstance =''ApplyInstanceTimeout ='0'ApplyLagThreshold ='0'TransportLagThreshold ='0'TransportDisconnectedThreshold ='0'ApplyParallel ='auto'ApplyInstances ='0'BestbyFileManagement =''ArchiveLagTarget ='0'LogArchiveMaxProcesses ='0'LogArchiveMinSucceedDest ='0'DataGuardSyncLatency ='0'LogArchiveTrace = 255 LogArchiveFormat ='db1r_ ％d_％t_％s_％R.arc'DbFileNameConvert ='dbs / cdb2_，dbs / cdb1_，dbs / bt，dbs / t，dbs / cdb4_，dbs / cdb1_，dbs / dt，dbs / t'LogFileNameConvert ='dbs / cdb2_，dbs / cdb1_，dbs / bt，dbs / t，dbs / cdb4_，dbs / cdb1_，dbs / dt，dbs / t'Archi veLocation =''AlternateLocation =''StandbyArchiveLocation =''StandbyAlternateLocation =''InconsistentProperties ='（monitor）'InconsistentLogXptProps ='（monitor）'LogXptStatus ='（monitor）'SendQEntries ='（monitor）'RecvQEntries ='（monitor） 'HostName ='North_Sales.example.com'StaticConnectIdentifier ='（DESCRIPTION =（ADDRESS =（PROTOCOL = tcp）（HOST = North_Sales.example.com）（PORT = 2840））（CONNECT_DATA =（SERVICE_NAME = North_Sales_DGMGRL.example.com） ）（INSTANCE_NAME = north_sales1）（SERVER = DEDICATED）））'TopWaitEvents ='（监视器）'SidName ='（监视器）'日志文件位置：警报日志：/ dev / oracle / log / diag / rdbms / North_Sales / north1 / trace / alert_north1.log Data Guard Broker日志：/dev/oracle/log/diag/rdbms/North_Sales/north1/trace/drcnorth1.log数据库状态：成功</code></pre></div>
                  <!-- class="example" -->
               </div><a id="DGBKR160"></a><div class="props_rev_3"><a id="GUID-3A5DC529-0C67-4EBF-8771-C7C3281F1553" name="GUID-3A5DC529-0C67-4EBF-8771-C7C3281F1553"></a><h4 id="DGBKR-GUID-3A5DC529-0C67-4EBF-8771-C7C3281F1553" class="sect4"><span class="enumeration_section">4.3.1可</span>监视（只读）属性</h4>
                  <div>
                     <p>可监视属性允许您查看与配置成员相关的信息，但不能更改属性值。</p>
                     <p>当您尝试诊断代理配置中的问题时，可监视属性非常有用。例如，您可以查看<code class="codeph">InconsistentLogXptProps</code> monitorable属性，以确定代理配置文件与数据库当前使用的实际值之间的重做传输服务属性存在差异的位置。
                     </p>
                     <p>您可以使用DGMGRL <code class="codeph">SHOW DATABASE VERBOSE</code>命令列出所有可监视的属性。使用<code class="codeph">SHOW DATABASE</code>命令获取有关特定属性的更多详细信息。例如，以下显示<code class="codeph">InconsistentLogXptProps</code>属性：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; SHOW DATABASE'North_Sales''InconsistentLogXptProps';不一致的日志传输属性INSTANCE_NAME STANDBY_NAME PROPERTY_NAME MEMORY_VALUE BROKER_VALUE south_sales1 South_Sales ReopenSecs 600 300</pre><p>Cloud Control在“编辑属性”页面上显示从这些属性获取的信息。</p>
                  </div>
               </div><a id="DGBKR165"></a><div class="props_rev_3"><a id="GUID-58646FFF-47E4-40DC-A7DA-C4AB33CDB16B" name="GUID-58646FFF-47E4-40DC-A7DA-C4AB33CDB16B"></a><h4 id="DGBKR-GUID-58646FFF-47E4-40DC-A7DA-C4AB33CDB16B" class="sect4"><span class="enumeration_section">4.3.2可</span>配置（可更改）属性</h4>
                  <div>
                     <p>可配置属性会影响数据库或远程同步实例的操作或配置。</p>
                     <p>使用DGMGRL或Cloud Control创建主数据库并将现有备用数据库和远程同步实例导入新代理配置时，最初会从数据库或远程同步实例设置导入属性值。</p>
                     <p>禁用或启用配置成员时，可以更新许多属性值。将新成员添加到配置中时，代理将连接到该成员，并从当前成员设置导入成员属性的初始值。例如：</p>
                     <p></p><pre class="pre codeblock"><code>DGMGRL&gt; SHOW DATABASE'North_Sales'LogXptMode; LogXptMode = ASYNC DGMGRL&gt; EDIT DATABASE'North_Sales'Set PROPERTY LogXptMode ='SYNC';属性“LogXptMode”更新了DGMGRL&gt; SHOW DATABASE'North_Sales'LogXptMode; LogXptMode = SYNC</code></pre><p></p>
                     <p>启用配置后，对于与重做传输相关的属性，代理会使代理配置文件中的成员属性值与成员使用的值保持一致。代理不再维护配置文件中与初始化参数相关的属性的值。请注意，保持一致性没有问题。虽然代理不再维护这些属性的值，但仍可以使用代理CLI更新和检查这些属性的值。由于用户操作，系统全局区域（SGA）中的参数值可能与服务器参数文件中的参数值不同。这不会被标记为不一致，只表示服务器参数文件值将在下次重新启动数据库时生效。必须可以访问指定的数据库才能进行这些属性更改。</p>
                     <div class="infoboxnote" id="GUID-58646FFF-47E4-40DC-A7DA-C4AB33CDB16B__GUID-7A55C027-EB6E-4A21-805A-911AFA59DFC4">
                        <p class="notep1">注意：</p>
                        <p>即使您可以在禁用配置时更改属性值，除非启用配置，否则更改不会对配置成员生效。另请注意，某些属性值只能在禁用状态下更改。</p>
                     </div>
                  </div><a id="DGBKR3660"></a><div class="props_rev_3"><a id="GUID-43C85B63-339E-4431-A0CB-6BADE9298E2D" name="GUID-43C85B63-339E-4431-A0CB-6BADE9298E2D"></a><h5 id="DGBKR-GUID-43C85B63-339E-4431-A0CB-6BADE9298E2D" class="sect5"><span class="enumeration_section">4.3.2.1将</span>代理可配置属性重置为默认值</h5>
                     <div>
                        <p>大多数代理可配置属性都有一个默认值，但您可以指定一个不同的值来覆盖它。</p>
                        <p>在Oracle Database 12 <span class="italic">c</span>第1版（12.1）之前的版本中，一旦您更改了默认值，即使您稍后将该属性设置回其以前的默认值，代理也会将其视为用户提供的值。
                        </p>
                        <p>从Oracle Database <span class="italic">12c</span>第1版（12.1）开始，代理会识别何时为属性恢复了默认值，并且不再将其视为用户提供的值。这在升级方案中是有利的，因为如果属性的默认值在不同版本之间发生更改，则新的默认值将在升级完成后自动生效。被视为用户提供的值不会自动升级。
                        </p>
                        <p>您无需知道实际的默认值即可重置它。您可以在配置，配置成员或实例级别重置默认值。</p>
                        <div class="infoboxnotealso" id="GUID-43C85B63-339E-4431-A0CB-6BADE9298E2D__GUID-0678BEF5-8527-42CA-B8B5-B8B871974376">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><span class="q">“ <a href="oracle-data-guard-broker-commands.html#GUID-CD715676-43D3-4EBF-AFCB-50729C68CDE7" title="EDIT CONFIGURATION RESET PROPERTY命令将指定的配置属性重置为其默认值。">EDIT CONFIGURATION RESET（Property）</a> ”</span></p>
                              </li>
                              <li>
                                 <p><span class="q">“ <a href="oracle-data-guard-broker-commands.html#GUID-57834E6A-990F-44FF-82BF-C221D8FA3400" title="EDIT DATABASE RESET（属性）命令将指定数据库的指定属性重置为其默认值。">EDIT DATABASE RESET（Property）</a> ”</span></p>
                              </li>
                              <li>
                                 <p><span class="q">“ <a href="oracle-data-guard-broker-commands.html#GUID-80730A07-6245-48FC-8A7B-2802A93E9EC7" title="EDIT FAR_SYNC RESET（属性）命令将指定的远程同步实例的指定属性重置为其默认值。">EDIT FAR_SYNC RESET（物业）</a> ”</span></p>
                              </li>
                              <li>
                                 <p><a href="oracle-data-guard-broker-commands.html#GUID-E61C8F4A-5F76-425B-A107-B7ABD1AD4B38" title="EDIT RECOVERY_APPLIANCE RESET（属性）命令将指定的恢复设备的指定属性重置为其默认值。">EDIT RECOVERY_APPLIANCE RESET（物业）</a></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div>
               </div>
            </div><a id="DGBKR170"></a><div class="props_rev_3"><a id="GUID-6DC53E53-63F3-42D7-865E-C7689AEBD44A" name="GUID-6DC53E53-63F3-42D7-865E-C7689AEBD44A"></a><h3 id="DGBKR-GUID-6DC53E53-63F3-42D7-865E-C7689AEBD44A" class="sect3"><span class="enumeration_section">4.4</span>管理重做传输服务</h3>
               <div>
                  <p>要管理重做传输服务，请在每个配置成员上指定可配置属性。</p>
                  <p>您指定的属性如下： <a id="d7524e865" class="indexterm-anchor"></a><a id="d7524e869" class="indexterm-anchor"></a> ：</p>
                  <p></p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><code class="codeph">DGConnectIdentifier</code></p>
                     </li>
                     <li>
                        <p><code class="codeph">StandbyAlternateLocation</code></p>
                     </li>
                     <li>
                        <p><code class="codeph">捆绑</code></p>
                     </li>
                     <li>
                        <p><code class="codeph">Encryption</code> （此属性只能在恢复设备上设置）</p>
                     </li>
                     <li>
                        <p><code class="codeph">LogShipping</code></p>
                     </li>
                     <li>
                        <p><code class="codeph">LogXptMode</code></p>
                     </li>
                     <li>
                        <p><code class="codeph">MaxFailure</code></p>
                     </li>
                     <li>
                        <p><code class="codeph">NetTimeout</code></p>
                     </li>
                     <li>
                        <p><code class="codeph">RedoCompression</code></p>
                     </li>
                     <li>
                        <p><code class="codeph">RedoRoutes</code></p>
                     </li>
                     <li>
                        <p><code class="codeph">ReopenSecs</code></p>
                     </li>
                     <li>
                        <p><code class="codeph">StandbyArchiveLocation</code></p>
                     </li>
                  </ul>
                  <p>您可以使用这些属性指定代理如何为备用数据库配置重做传输服务。实际的重做传输设置（例如设置<code class="codeph">LOG_ARCHIVE_DEST_</code> <span class="variable" translate="no">n</span>初始化参数）由主数据库上的代理执行（ <code class="codeph">StandbyArchiveLocation</code>属性除外）。如果更改属性要求您更改<code class="codeph">LOG_ARCHIVE_DEST_</code> <span class="variable" translate="no">n</span>初始化参数属性，则代理会强制每个线程上的日志切换，以便主数据库立即采用新设置。
                  </p>
                  <p>您还应在主数据库上预设这些属性，以便将其切换到备用数据库。</p>
               </div><a id="DGBKR3396"></a><div class="props_rev_3"><a id="GUID-A21F8635-0F5B-41C3-8B7E-EF604B4C1C98" name="GUID-A21F8635-0F5B-41C3-8B7E-EF604B4C1C98"></a><h4 id="DGBKR-GUID-A21F8635-0F5B-41C3-8B7E-EF604B4C1C98" class="sect4"><span class="enumeration_section">4.4.1</span>设置重做传输</h4>
                  <div>
                     <p>使用Oracle Net将重做数据传输到备用数据库。</p>
                     <div class="section">
                        <p>使用<code class="codeph">LOG_ARCHIVE_DEST_n</code>初始化参数的<code class="codeph">SERVICE</code>属性指定Oracle Net服务名称，该名称用于将重做数据传输到备用数据库。Oracle Net服务名称将转换为连接描述符，其中包含连接到备用数据库所需的信息。
                        </p>
                        <p>可以使用<code class="codeph">DGConnectIdentifier</code>数据库属性设置或更改<code class="codeph">SERVICE</code>属性。首次将数据库添加到配置时，将设置<code class="codeph">DGConnectIdentifier</code>属性。其初始值是<code class="codeph">ADD DATABASE</code>命令的可选<code class="codeph">CONNECT IDENTIFIER IS</code>子句中指定的连接标识符。
                        </p>
                        <p><code class="codeph">DGConnectIdentifier</code>属性值还用于设置<code class="codeph">FAL_SERVER</code>初始化参数。如果更改了任何数据库的<code class="codeph">DGConnectIdentifier</code>属性，则还将更改相应<code class="codeph">LOG_ARCHIVE_DEST_n</code>初始化参数的<code class="codeph">SERVICE</code>属性。此外，还将在配置中的每个已启用的备用数据库上更新<code class="codeph">FAL_SERVER</code>初始化参数。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="DGBKR3536"></a><a id="DGBKR3537"></a><a id="DGBKR3661"></a><a id="DGBKR175"></a><div class="props_rev_3"><a id="GUID-5BFCC986-BB38-47CF-86CE-9F54E2539CBF" name="GUID-5BFCC986-BB38-47CF-86CE-9F54E2539CBF"></a><h4 id="DGBKR-GUID-5BFCC986-BB38-47CF-86CE-9F54E2539CBF" class="sect4"><span class="enumeration_section">4.4.2</span>管理数据保护模式的重做传输服务</h4>
                  <div>
                     <p>作为整体配置保护模式的一部分，您必须确保为您选择的数据保护模式正确设置重做传输服务。</p>
                     <p><a href="managing-oracle-data-guard-broker-configuration-members.html#GUID-994BE350-859F-41DC-A1D3-B6E8D5EEF2C8" title="您可以使用代理设置具有任何不同数据保护模式的配置。">管理数据保护模式</a>描述了代理如何处理数据保护模式。
                     </p>
                     <p>您可以使用<code class="codeph">LogXptMode</code>或<code class="codeph">RedoRoutes</code>数据库属性为重做传输服务设置<code class="codeph">SYNC</code> ， <code class="codeph">ASYNC</code>或<code class="codeph">FASTSYNC</code>模式。
                     </p>
                     <p>支持以下重做传输模式：</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-5BFCC986-BB38-47CF-86CE-9F54E2539CBF__GUID-A1AD379C-140C-43E1-844C-31474C0431ED">同步</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>使用<code class="codeph">LOG_ARCHIVE_DEST_</code> <span class="variable" translate="no">n</span>初始化参数的<code class="codeph">SYNC</code>和<code class="codeph">AFFIRM</code>属性为此备用数据库配置重做传输服务。在最大保护模式或最大可用性模式下运行的配置需要此模式以及备用重做日志文件。此重做传输服务可为主数据库提供最高级别的数据保护，但也可能产生更高的性能影响。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-5BFCC986-BB38-47CF-86CE-9F54E2539CBF__GUID-213FC368-FD94-4008-9AB8-F1E70364EE8E">异步</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>使用<code class="codeph">LOG_ARCHIVE_DEST_</code> <span class="variable" translate="no">n</span>初始化参数的<code class="codeph">ASYNC</code>和<code class="codeph">NOAFFIRM</code>属性为此备用数据库配置重做传输服务。此模式以及备用重做日志文件可为主数据库提供中等级别的保护，并降低性能影响。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-5BFCC986-BB38-47CF-86CE-9F54E2539CBF__GUID-F9E8EB77-6C6A-41FD-AF30-3F15A358EAF9">FASTSYNC</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>使用<code class="codeph">LOG_ARCHIVE_DEST_</code> <span class="italic"><code class="codeph">n</code></span>初始化参数的<code class="codeph">SYNC</code>和<code class="codeph">NOAFFIRM</code>属性为此备用数据库配置重做传输服务。此模式仅在最大可用性保护模式下可用。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="DGBKR3932"></a><a id="DGBKR3933"></a><a id="DGBKR3852"></a><div class="props_rev_3"><a id="GUID-81DE5E90-C544-410C-942E-6172E7BB4205" name="GUID-81DE5E90-C544-410C-942E-6172E7BB4205"></a><h4 id="DGBKR-GUID-81DE5E90-C544-410C-942E-6172E7BB4205" class="sect4"><span class="enumeration_section">4.4.3</span>高级重做传输设置</h4>
                  <div>
                     <p>您可以使用<code class="codeph">RedoRoutes</code>属性覆盖主数据库将其重做发送到配置中每个可能的重做传输目标的默认行为。
                     </p>
                     <p>除默认值之外的重做传输拓扑的示例将是物理备用或远程同步实例将从主数据库接收的重做转发到一个或多个目的地，或者用于给定目的地的重做传输模式的重做传输拓扑的示例。取决于哪个数据库是主要角色。</p>
                     <div class="infoboxnotealso" id="GUID-81DE5E90-C544-410C-942E-6172E7BB4205__GUID-D9DD8190-E8E5-4332-98A2-2735D9E753AD">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="oracle-data-guard-broker-properties.html#GUID-FB1A96ED-5E6D-43FE-BFC4-6A808E589410" title="RedoRoutes属性允许您覆盖主数据库将其生成的重做发送到配置中的每个其他重做传输目标的默认行为。">RedoRoutes</a>有关使用<code class="codeph">RedoRoutes</code>属性时重做路由规则的信息</p> 
                           </li>
                        </ul>
                     </div>
                     <div class="example" id="GUID-81DE5E90-C544-410C-942E-6172E7BB4205__GUID-621A2C97-A225-4874-8061-C9AB80972484">
                        <p class="titleinexample">示例4-2使用RedoRoutes属性进行实时级联</p>
                        <p>考虑具有主数据库（ <code class="codeph">North_Sales</code> ）和两个物理备用数据库（ <code class="codeph">Local_Sales</code>和<code class="codeph">Remote_Sales</code> ）的配置。出于高可用性目的， <code class="codeph">Local_Sales</code>数据库与主数据库位于同一数据中心。<code class="codeph">Remote_Sales</code>数据库位于远程数据中心，用于灾难恢复。可以使用<code class="codeph">RedoRoutes</code>属性来配置实时级联，而不是主要必须将其重做发送到两个数据库，其中本地物理备用数据库将重做从<code class="codeph">North_Sales</code>转发到远程物理备用数据库<code class="codeph">Remote_Sales</code> 。要实现此目的，必须按如下方式设置<code class="codeph">RedoRoutes</code>属性：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>在<code class="codeph">North_Sales</code>数据库上， <code class="codeph">RedoRoutes</code>属性必须指定如果<code class="codeph">North_Sales</code>位于主角色中，则它应使用同步传输模式将重做发送到<code class="codeph">Local_Sales</code>数据库。此规则可防止主数据库将重做数据直接传送到<code class="codeph">Remote_Sales</code>数据库。
                              </p>
                           </li>
                           <li>
                              <p>在<code class="codeph">Local_Sales</code>数据库上， <code class="codeph">RedoRoutes</code>属性必须指定如果<code class="codeph">North_Sales</code>位于主角色中，则<code class="codeph">Local_Sales</code>应将从<code class="codeph">North_Sales</code>接收的重做转发到<code class="codeph">Remote_Sales</code> 。
                              </p>
                           </li>
                        </ul><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; EDIT DATABASE'North_Sales'Set PROPERTY'RedoRoutes'='（LOCAL：Local_Sales SYNC）'; DGMGRL&gt; EDIT DATABASE'Local_Sales'Set PROPERTY'RedoRoutes'='（North_Sales：Remote_Sales ASYNC）';</pre><p>要查看运行时<code class="codeph">RedoRoutes</code>配置，请使用<code class="codeph">SHOW</code> <code class="codeph">CONFIGURATION</code>命令。例如：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; SHOW CONFIGURATION;配置 -  Sales_Configuration保护模式：MaxAvailability成员：North_Sales  - 主数据库Local_Sales  - 物理备用数据库Remote_Sales  - 物理备用数据库（接收当前重做）快速启动故障转移：禁用配置状态：成功</pre><p>请注意，在<code class="codeph">Remote_Sales</code>目标的重做路由规则中明确指定了<code class="codeph">ASYNC</code>重做传输属性，以实现重做到该目标的实时级联。（实时级联需要Oracle Active Data Guard选项的许可证。）
                        </p>
                        <p>要禁用重做的实时级联，请不要指定<code class="codeph">ASYNC</code>重做传输属性。例如：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt;编辑数据库'Local_Sales'Set PROPERTY'RedoRoutes'='（North_Sales：Remote_Sales）';</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-81DE5E90-C544-410C-942E-6172E7BB4205__GUID-2DF34135-CAC2-494C-8A06-006A98902881">
                        <p class="titleinexample">示例4-3将RedoRoutes属性用于远程备用目标</p>
                        <p><code class="codeph">RedoRoutes</code>属性还可用于设置远程备用目标，以便即使从其接收重做数据的成员失败，终端成员仍可以接收重做数据。使用前面的示例，如果<code class="codeph">Local_Sales</code>备用数据库失败，则可以让主数据库<code class="codeph">North_Sales</code>直接将重做数据发送到<code class="codeph">Remote_Sales</code> 。使用<code class="codeph">PRIORITY</code>属性也可以对其进行设置，以便在解决了<code class="codeph">Local_Sales</code>故障后，可以继续将重做传送到<code class="codeph">Remote_Sales</code> 。
                        </p><pre class="pre codeblock"><code>DGMGRL&gt;编辑数据库'North_Sales'设置属性'RedoRoutes'='（本地：（Local_Sales ASYNC PRIORITY = 1，Remote_Sales ASYNC PRIORITY = 2））';属性“RedoRoutes”更新了DGMGRL&gt; EDIT DATABASE'Local_Sales'Set PROPERTY'RedoRoutes'='（North_Sales：Remote_Sales ASYNC）';物业“RedoRoutes”更新DGMGRL&gt; SHOW CONFIGURATION;配置 -  Sales_Configuration保护模式：MaxPerformance成员：North_Sales  - 主数据库Local_Sales  - 物理备用数据库Remote_Sales  - 物理备用数据库快速启动故障转移：DISABLED配置状态：成功</code></pre><p>要查看完整的<code class="codeph">RedoRoutes</code>配置，请使用<code class="codeph">SHOW</code> <code class="codeph">CONFIGURATION</code> <code class="codeph">VERBOSE</code>命令。例如：</p><pre class="pre codeblock"><code>DGMGRL&gt; SHOW CONFIGURATION VERBOSE;配置 -  Sales_Configuration保护模式：MaxPerformance成员：North_Sales  - 主数据库Local_Sales  - 物理备用数据库Remote_Sales  - 物理备用数据库Remote_Sales  - 物理备用数据库（Local_Sales的备用）属性：FastStartFailoverThreshold ='180'ReperationTimeout ='30'TraceLevel ='USER' FastStartFailoverLagLimit ='300'CommunicationTimeout ='180'ObserverReconnect ='0'FastStartFailoverAutoReinstate ='TRUE'FastStartFailoverPmyShutdown ='TRUE'BeopledersFollowRoleChange ='ALL'ObserverOverride ='FALSE'ExternalDestination1 =''ExternalDestination2 =''PrimaryLostWriteAction ='CONTINUE'ConfigurationWideServiceName = 'c0_CFG'快速启动故障转移：禁用配置状态：成功</code></pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="DGBKR3538"></a><a id="DGBKR3539"></a><a id="DGBKR180"></a><div class="props_rev_3"><a id="GUID-407D7187-93B3-4DAB-A31E-4D5302265A48" name="GUID-407D7187-93B3-4DAB-A31E-4D5302265A48"></a><h4 id="DGBKR-GUID-407D7187-93B3-4DAB-A31E-4D5302265A48" class="sect4"><span class="enumeration_section">4.4.4</span>打开和关闭重做传输服务</h4>
                  <div>
                     <p>您可以通过设置主数据库的状态来打开和关闭重做传输服务。</p>
                     <div class="section">
                        <p><a id="d7524e1358" class="indexterm-anchor"></a>将主数据库状态设置为<code class="codeph">TRANSPORT-ON</code>将在主数据库中启动重做传输服务，并将主数据库状态设置为<code class="codeph">TRANSPORT-OFF</code>停止主数据库上的重做传输服务。
                        </p>
                        <div class="infoboxnote" id="GUID-407D7187-93B3-4DAB-A31E-4D5302265A48__GUID-1C47EA3F-6BE4-48DC-AC90-002936181462">
                           <p class="notep1">注意：</p>
                           <p>Oracle建议不要将重做传输服务关闭到所有备用数据库。如果主数据库发生故障，这会增加数据丢失的风险。</p>
                        </div>
                        <p>使用备用数据库上的<code class="codeph">LogShipping</code>数据库属性打开和关闭重做传输服务到单个备用数据库。<code class="codeph">LogShipping</code>属性接受值<code class="codeph">ON</code>和<code class="codeph">OFF</code> 。如果为备用数据库将<code class="codeph">LogShipping</code>属性设置为<code class="codeph">OFF</code> ，则会关闭到此备用数据库的重做传输服务，而不会影响到其他数据库的重做传输服务。您可以将<code class="codeph">LogShipping</code>设置为<code class="codeph">ON</code>以将重做传输服务重新设置为备用数据库。
                        </p>
                        <p>设置主数据库状态和设置<code class="codeph">LogShipping</code>属性之间的关系如下：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p>如果主数据库状态设置为<code class="codeph">TRANSPORT-OFF</code> ，则无论各个备用数据库的<code class="codeph">LogShipping</code>属性值如何，都将停止对所有备用数据库的重做传输服务。
                              </p>
                           </li>
                           <li>
                              <p>如果主数据库状态设置为<code class="codeph">TRANSPORT-ON</code> ，则每个备用数据库的重做传输服务由该数据库的<code class="codeph">LogShipping</code>属性确定。
                              </p>
                           </li>
                        </ul>
                        <p><a href="managing-oracle-data-guard-broker-configuration-members.html#GUID-407D7187-93B3-4DAB-A31E-4D5302265A48__I1029225">例4-4</a>和<a href="managing-oracle-data-guard-broker-configuration-members.html#GUID-407D7187-93B3-4DAB-A31E-4D5302265A48__I1029241">例4-5</a>显示了如何关闭<a id="d7524e1429" class="indexterm-anchor"></a>两种不同场景下的重做传输服务。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-407D7187-93B3-4DAB-A31E-4D5302265A48__I1029225">
                        <p class="titleinexample">示例4-4关闭重做传输服务到所有备用数据库</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt;编辑数据库'North_Sales'Set STATE ='TRANSPORT-OFF'; DGMGRL&gt; SHOW DATABASE'North_Sales';数据库 -  North_Sales角色：PRIMARY预期状态：TRANSPORT-OFF实例：north_sales1数据库状态：成功</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-407D7187-93B3-4DAB-A31E-4D5302265A48__I1029241">
                        <p class="titleinexample">示例4-5关闭重做传输服务到特定备用数据库</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt;编辑数据库'South_Sales'Set PROPERTY'LogShipping'='OFF';属性“LogShipping”更新了DGMGRL&gt; SHOW DATABASE'South_Sales''LogShipping'; LogShipping ='OFF'</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="DGBKR185"></a><div class="props_rev_3"><a id="GUID-E58A6D1D-19BF-4C47-A0A3-DD228A77DB2D" name="GUID-E58A6D1D-19BF-4C47-A0A3-DD228A77DB2D"></a><h4 id="DGBKR-GUID-E58A6D1D-19BF-4C47-A0A3-DD228A77DB2D" class="sect4"><span class="enumeration_section">4.4.5</span>指定存档重做日志文件的位置</h4>
                  <div>
                     <p>您可以使用代理可配置属性来设置位置，以存储存档的备用重做日志文件和存档的联机重做日志文件。</p>
                     <p>对于联机重做日志文件，请在主，逻辑或快照备用数据库上使用<code class="codeph">ArchiveLocation</code>和<code class="codeph">AlternateLocation</code>属性。
                     </p>
                     <p>对于备用重做日志文件，请在备用数据库上使用<code class="codeph">StandbyArchiveLocation</code>和<code class="codeph">StandbyAlternateLocation</code>属性。如果未设置<code class="codeph">StandbyArchiveLocation</code> ，则<code class="codeph">ArchiveLocation</code>或<code class="codeph">AlternateLocation</code>指定联机和备用重做日志文件的归档位置。如果设置了<code class="codeph">StandbyArchiveLocation</code> ，则ArchiveLocation和AlternateLocation指定联机重做日志文件的归档位置。
                     </p>
                     <p><code class="codeph">StandbyArchiveLocation</code>属性指定存储归档重做日志文件的位置。代理使用该位置仅存储从主数据库接收的归档重做日志文件。对于在数据库是主数据库，逻辑备用数据库或快照备用数据库时在本地生成的归档重做日志文件，您需要指定<code class="codeph">ArchiveLocation</code>属性。代理允许<code class="codeph">StandbyArchiveLocation</code>和<code class="codeph">ArchiveLocation</code>属性的值与您为本地生成的日志设置的位置相同，在这种情况下，代理会相应地设置目标的<code class="codeph">VALID_FOR</code>属性，以便它可以用于存档从主数据库接收的重做日志文件和本地生成的归档重做日志文件。当某个位置用于联机和备用重做日志文件时，必须将<code class="codeph">ArchiveLocation</code>属性配置为共享位置，并将<code class="codeph">StandbyArchiveLocation</code>属性保留为空。
                     </p>
                     <p>您还可以使用<code class="codeph">StandbyAlternateLocation</code>和<code class="codeph">AlternateLocation</code>属性设置备用位置来存储归档重做日志文件。如果原始归档位置（由<code class="codeph">StandbyArchiveLocation</code>或<code class="codeph">Archivelocation</code>指定）失败，则这些属性指定的备用位置是存储归档重做日志文件的位置。代理使用<code class="codeph">LOG_ARCHIVE_DEST_ <span class="codeinlineitalic">n</span></code>初始化参数的<code class="codeph">ALTERNATE</code>属性正确设置备用位置。
                     </p>
                     <div class="infoboxnote" id="GUID-E58A6D1D-19BF-4C47-A0A3-DD228A77DB2D__GUID-C23AC892-16F3-49E5-BFAC-E61BA0F46BA0">
                        <p class="notep1">注意：</p>
                        <p>您可以使用数据库恢复区域在备用数据库上存储已归档的重做日志文件。在这种情况下， <code class="codeph">StandbyArchiveLocation</code>或<code class="codeph">ArchiveLocation</code>属性的值可以设置为<code class="codeph">USE_DB_RECOVERY_FILE_DEST</code> 。</p>
                        <p>如果未使用数据库恢复区，则在逻辑备用数据库上，Oracle建议<code class="codeph">ArchiveLocation</code>属性与<code class="codeph">StandbyArchiveLocation</code>属性的值不同。
                        </p>
                     </div>
                     <div class="example" id="GUID-E58A6D1D-19BF-4C47-A0A3-DD228A77DB2D__GUID-F6252CA2-4B44-421A-919E-2E96FA68F9D7">
                        <p class="titleinexample">示例4-6为备用重做日志文件和联机重做日志文件使用相同的存档位置</p>
                        <p>以下示例对联机重做日志文件和备用重做日志文件使用相同的归档位置。</p><pre class="pre codeblock"><code>ArchiveLocation = '/ archfs /拱'</code></pre><p></p>
                     </div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-E58A6D1D-19BF-4C47-A0A3-DD228A77DB2D__GUID-696EDEBB-0F6E-4A41-94ED-7310C43FD2CD">
                        <p class="titleinexample">示例4-7为存档的备用和联机重做日志文件指定备用位置</p>
                        <p>以下示例对联机重做日志文件和备用重做日志文件使用相同的归档位置。如果<code class="codeph">ArchiveLocation</code>属性指定的位置不可用，则配置<code class="codeph">AlternateLocation</code>属性可确保共享的备用位置可用于存储备用重做日志文件。
                        </p><pre class="pre codeblock"><code>ArchiveLocation ='/ archfs / arch'AlternateLocation ='/ archfs / alt'</code></pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-E58A6D1D-19BF-4C47-A0A3-DD228A77DB2D__GUID-F0D54779-9EF6-4CC0-A9E6-253C6D7DB756">
                        <p class="titleinexample">示例4-8为联机和备用重做日志文件指定单独的存档位置</p>
                        <p>此示例为备用重做日志文件和联机重做日志文件配置单独的归档位置。此外，分别使用<code class="codeph">AlternateLocation</code>和<code class="codeph">StandbyAlternateLocation</code>属性为联机和备用重做日志文件配置备用归档位置。</p><pre class="pre codeblock"><code>ArchiveLocation ='/ archfs / arch / online'AlternateLocation ='/ archfs / alt / online'StandbyArchiveLocation ='/ archfs / arch / standby'StandbyAlternateLocation ='/ archfs / alt / standby'</code></pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="DGBKR195"></a><div class="props_rev_3"><a id="GUID-C44B11B8-B607-4514-AE7B-AB4F86FD1641" name="GUID-C44B11B8-B607-4514-AE7B-AB4F86FD1641"></a><h4 id="DGBKR-GUID-C44B11B8-B607-4514-AE7B-AB4F86FD1641" class="sect4"><span class="enumeration_section">4.4.6</span>其他重做传输设置</h4>
                  <div>
                     <p>您可以使用数据库属性来调整重做传输服务的性能并设置重做传输服务失败策略。</p>
                     <p></p>
                     <p>使用的属性包括： <code class="codeph">Binding</code> ， <code class="codeph">MaxFailure</code> ， <code class="codeph">NetTimeout</code> ， <code class="codeph">RedoCompression</code>和<code class="codeph">ReopenSecs</code> <a id="d7524e1656" class="indexterm-anchor"></a><a id="d7524e1660" class="indexterm-anchor"></a><a id="d7524e1664" class="indexterm-anchor"></a> 。这些属性对应于<code class="codeph">LOG_ARCHIVE_DEST_</code> <span class="variable" translate="no">n</span>初始化参数上的属性。
                     </p>
                     <div class="infoboxnotealso" id="GUID-C44B11B8-B607-4514-AE7B-AB4F86FD1641__GUID-23FF658E-E8BE-4B74-895C-AFDD21673A0C">
                        <p class="notep1">也可以看看：</p>
                        <p>有关这些数据库属性的完整信息，请参阅<a href="oracle-data-guard-broker-properties.html#GUID-1966A317-DD75-4385-8A64-ADEC75662F7E" title="使用Oracle Data Guard代理属性来管理实例或整个配置。">Oracle Data Guard Broker属性</a></p>
                     </div>
                  </div>
               </div><a id="DGBKR205"></a><div class="props_rev_3"><a id="GUID-81371C7E-2D13-4CAB-A9AF-2CC6E2D954C7" name="GUID-81371C7E-2D13-4CAB-A9AF-2CC6E2D954C7"></a><h4 id="DGBKR-GUID-81371C7E-2D13-4CAB-A9AF-2CC6E2D954C7" class="sect4"><span class="enumeration_section">4.4.7</span> Oracle RAC数据库环境中的重做传输服务</h4>
                  <div>
                     <p>如果主数据库是Oracle RAC数据库，则代理会确保在每个主数据库实例上以相同方式设置重做传输服务。</p>
                     <p>每个实例具有相同的远程目标，并且对于每个远程目标，所有实例在重做传输服务，性能相关设置，联机重做日志的本地存档等方面设置相同。如果实例具有不同的设置，则代理会在该特定实例上引发运行状况检查警告</p>
                     <p>相对于重做传输服务的设置将作为属性保存在代理配置文件中。在备用数据库上更新与重做传输相关的属性时，代理会自动对所有主数据库实例上的<code class="codeph">LOG_ARCHIVE_DEST_</code> <span class="variable" translate="no">n</span>初始化参数进行相应的更改。如果主数据库上出现新实例，则代理使用当前由代理管理的所有配置成员的重做传输相关属性为新实例设置重做传输服务。在为活动打开新实例后，在此实例上生成的所有归档重做日志文件开始传输到配置成员。
                     </p>
                     <div class="infoboxnote" id="GUID-81371C7E-2D13-4CAB-A9AF-2CC6E2D954C7__GUID-A08BBE1E-FDC3-40CA-878B-874D64AEE897">
                        <p class="notep1">也可以看看：</p>
                        <p>有关<code class="codeph">LOG_ARCHIVE_DEST_</code> <span class="variable" translate="no">n</span>初始化参数的其他信息，请参阅<a href="../sbydb/LOG_ARCHIVE_DEST_n-parameter-attributes.html#SBYDB01100" target="_blank"><span class="italic">Oracle Data Guard概念和管理</span></a></p>
                     </div>
                  </div>
               </div><a id="DGBKR3635"></a><div class="props_rev_3"><a id="GUID-376B5C8C-C922-4AED-A8BB-1E5D362551A6" name="GUID-376B5C8C-C922-4AED-A8BB-1E5D362551A6"></a><h4 id="DGBKR-GUID-376B5C8C-C922-4AED-A8BB-1E5D362551A6" class="sect4"><span class="enumeration_section">4.4.8</span>运输滞后</h4>
                  <div>
                     <p>传输延迟是衡量重做到备用数据库或远程同步实例的传输程度落后于主数据库上的重做生成的程度的度量。</p>
                     <p>如果备用数据库或远程同步实例上有一个或多个重做间隙，则计算传输延迟，就好像在最早的重做间隙开始后没有收到重做一样。</p>
                     <p>Cloud Control和DGMGRL客户端都显示每个托管备用或远程同步实例的重做传输延迟。Cloud Control在Oracle Data Guard主页上显示传输延迟。DGMGRL客户端在<code class="codeph">SHOW DATABASE</code>输出中显示传输延迟。主数据库没有显示传输延迟。例如：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt;显示数据库'South_Sales';数据库 -  South_Sales角色：PHYSICAL STANDBY预期状态：APPLY-ON <span class="bold">传输延迟：0秒（计算0秒前）</span>应用滞后：0秒（计算0秒前）应用率：255.00 KByte / s实时查询：关闭实例（s ）：south_sales1数据库状态：成功</pre><p></p>
                     <p>从Oracle Database Release 19c开始， <code class="codeph">SHOW CONFIGURATION LAG</code>命令显示代理配置的摘要和所有备用数据库的传输延迟。
                     </p>
                     <p>传输延迟可以帮助您识别重做传输服务可能存在的任何问题。</p>
                     <p>当重做数据到备用数据库或远程同步实例的传输滞后于主数据库上的重做数据生成时，可以设置<code class="codeph">TransportLagThreshold</code>数据库可配置属性以生成运行状况检查警告。
                     </p>
                     <p>以下命令将<code class="codeph">TransportLagThreshold</code>属性设置为15秒：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt;编辑数据库'South_Sales'Set PROPERTY'TransportLagThreshold'= 15; Property TransportLagThreshold已更新</pre><p>此外，如果备用或远程同步实例发现它没有与主数据库进行任何与重做传输相关的通信，则可以设置<code class="codeph">TransportDisconnectedThreshold</code>数据库可配置属性以生成运行状况检查警告。该属性的默认值为30秒。
                     </p>
                     <p>以下命令将<code class="codeph">TransportDisconnectedThreshold</code>属性设置为15秒：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; EDIT DATABASE'South_Sales'Set PROPERTY'TransportDisconnectedThreshold'= 15;属性TransportDisconnectedThreshold已更新</pre></div>
               </div>
            </div>
            <div class="props_rev_3"><a id="GUID-845BE719-CC15-4D6C-BD91-FF935CAE605A" name="GUID-845BE719-CC15-4D6C-BD91-FF935CAE605A"></a><h3 id="DGBKR-GUID-845BE719-CC15-4D6C-BD91-FF935CAE605A" class="sect3"><span class="enumeration_section">4.5</span>管理恢复设备的重做传输服务</h3>
               <div>
                  <p>零数据丢失恢复设备（恢复设备）的重做传输服务的管理方式与备用数据库相同。</p>
                  <div class="section">
                     <p>您可以使用代理从配置中的任何成员管理到恢复设备的重做传输服务。例如，要将恢复设备添加到代理配置然后启用它，您将执行以下步骤：</p>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>将恢复设备添加到代理配置。</span><div><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; ADD RECOVERY_APPLIANCE EnterpriseRecoveryAppliance AS CONNECT IDENTIFIER是EnterpriseRecoveryAppliance.example.com; Oracle Recovery Appliance“EnterpriseRecoveryAppliance”添加了DGMGRL&gt; SHOW RECOVERY_APPLIANCE'EnterpriseRecoveryAppliance'; Oracle Recovery Server  -  EnterpriseRecoveryAppliance传输延迟：0秒重做源：North_Sales Oracle恢复设备状态：已禁用</pre></div>
                     </li>
                     <li class="stepexpand"><span>启用恢复设备。</span><div><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; ENABLE RECOVERY_APPLIANCE'EnterpriseRecoveryAppliance'; DGMGRL&gt; SHOW RECOVERY_APPLIANCE'EnterpriseRecoveryAppliance'; Oracle Recovery Server  -  EnterpriseRecoveryAppliance传输延迟：0秒重做源：North_Sales Oracle恢复设备状态：成功</pre></div>
                     </li>
                     <li class="stepexpand"><span>设置传输延迟阈值。</span><div>
                           <p>设置<code class="codeph">TransportLagThreshold</code>数据库可配置属性，以便在将重做数据传输到恢复设备时滞后于源数据库上的重做数据生成时生成运行状况检查警告。此步骤是可选的，但如果未指定传输延迟阈值，则使用默认值0秒，如果存在传输延迟，则不会生成警告。
                           </p>
                           <p>以下命令将<code class="codeph">TransportLagThreshold</code>属性设置为15秒：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; EDIT RECOVERY_APPLIANCE'EnterpriseRecoveryAppliance'SET PROPERTY'TransportLagThreshold'= 15; Property TransportLagThreshold已更新</pre></div>
                     </li>
                  </ol>
                  <div class="example" id="GUID-845BE719-CC15-4D6C-BD91-FF935CAE605A__BABBEGEI">
                     <p class="titleinexample">示例4-9设置从物理待机到恢复设备的重做传输</p>
                     <p>考虑具有主数据库（ <code class="codeph">North_Sales</code> ），物理备用数据库（ <code class="codeph">South_Sales</code> ）和恢复设备（ <code class="codeph">EnterpriseRecoveryAppliance</code> ）的配置。您可以设置<code class="codeph">RedoRoutes</code>属性，使主服务器仅将重做发送到物理备用数据库，然后物理备用数据库将该重做转发到恢复设备，而不是主服务器必须将其重做发送到备用服务器和恢复设备。要实现此目的，必须按如下方式设置<code class="codeph">RedoRoutes</code>属性：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>在<code class="codeph">North_Sales</code>数据库上， <code class="codeph">RedoRoutes</code>属性必须指定如果<code class="codeph">North_Sales</code>位于主角色中，则它应使用同步传输模式将重做发送到<code class="codeph">South_Sales</code>数据库。此规则可防止主数据库直接将重做数据传输到恢复设备<code class="codeph">EnterpriseRecoveryAppliance</code> 。
                           </p>
                        </li>
                        <li>
                           <p>在<code class="codeph">South_Sales</code>数据库上， <code class="codeph">RedoRoutes</code>属性必须指定如果<code class="codeph">North_Sales</code>属于主角色，则<code class="codeph">South_Sales</code>应将从<code class="codeph">North_Sales</code>接收的重做转发到<code class="codeph">EnterpriseRecoveryAppliance</code> 。
                           </p>
                        </li>
                     </ul><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; EDIT DATABASE'North_Sales'Set PROPERTY'RedoRoutes'='（LOCAL：South_Sales SYNC）'; DGMGRL&gt;编辑数据库'South_Sales'Set PROPERTY'RedoRoutes'='（North_Sales：EnterpriseRecoveryAppliance ASYNC）';</pre><p>请注意，在<code class="codeph">EnterpriseRecoveryAppliance</code>目标的重做路由规则中明确指定了<code class="codeph">ASYNC</code>重做传输属性，以实现重做到该目标的实时级联。
                     </p>
                  </div>
                  <!-- class="example" -->
                  <div class="section">
                     <p>将恢复设备添加到代理配置后，它可以从主数据库或备用数据库接收重做。<a href="managing-oracle-data-guard-broker-configuration-members.html#GUID-845BE719-CC15-4D6C-BD91-FF935CAE605A__BABBEGEI">示例4-9</a>显示了如何设置恢复设备以从物理备用数据库接收重做。
                     </p>
                     <div class="infoboxnotealso" id="GUID-845BE719-CC15-4D6C-BD91-FF935CAE605A__GUID-05A1FCB1-557C-46DD-8289-9BA1E94ACD26">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="managing-oracle-data-guard-broker-configuration-members.html#GUID-6DC53E53-63F3-42D7-865E-C7689AEBD44A" title="要管理重做传输服务，请在每个配置成员上指定可配置属性。">管理重做传输服务</a>以获取有关管理重做传输服务的信息</p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="DGBKR210"></a><div class="props_rev_3"><a id="GUID-6753936C-E2E3-471E-BCC5-0C4697AD4255" name="GUID-6753936C-E2E3-471E-BCC5-0C4697AD4255"></a><h3 id="DGBKR-GUID-6753936C-E2E3-471E-BCC5-0C4697AD4255" class="sect3"><span class="enumeration_section">4.6</span>管理日志应用服务</h3>
               <div>
                  <p>您可以使用与log apply相关的数据库属性在物理和逻辑备用数据库上管理Redo Apply和SQL Apply。</p>
                  <p>与log apply相关的数据库属性如下：<a id="d7524e1973" class="indexterm-anchor"></a><a id="d7524e1977" class="indexterm-anchor"></a></p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>Redo Apply和SQL Apply通用的属性</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">ApplyInstanceTimeout</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">DelayMins</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">PreferredApplyInstance</code></p>
                           </li>
                        </ul>
                     </li>
                     <li>
                        <p>特定于重做应用的属性</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">ApplyParallel</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">ApplyInstances</code></p>
                           </li>
                        </ul>
                     </li>
                     <li>
                        <p>SQL Apply特有的属性</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">LsbyMaxEventsRecorded</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">LsbyPreserveCommitOrder</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">LsbyRecordSkipErrors</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">LsbyRecordSkipDdl</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">LsbyRecordAppliedDdl</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">LsbyMaxSga</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">LsbyMaxServers</code></p>
                           </li>
                        </ul>
                        <p>有一些与SQL Apply相关的属性，如果当前数据库状态为<code class="codeph">APPLY-ON</code> ，则可能需要重新启动SQL Apply。请参阅<a href="oracle-data-guard-broker-properties.html#GUID-1966A317-DD75-4385-8A64-ADEC75662F7E" title="Use Oracle Data Guard broker properties to manage instances or the entire configuration.">Oracle Data Guard Broker属性中</a>有关与SQL Apply相关的<a href="oracle-data-guard-broker-properties.html#GUID-1966A317-DD75-4385-8A64-ADEC75662F7E" title="使用Oracle Data Guard代理属性来管理实例或整个配置。">属性的</a>信息，以确定哪些需要重新启动SQL Apply。
                        </p>
                        <p>如果当前数据库状态为<code class="codeph">APPLY-OFF</code> ，则属性更改将在下次将数据库状态更改为<code class="codeph">APPLY-ON</code> 。</p>
                     </li>
                  </ul>
               </div><a id="DGBKR220"></a><div class="props_rev_3"><a id="GUID-5562D067-BAF8-45FA-9F49-BCF1C0BFB76A" name="GUID-5562D067-BAF8-45FA-9F49-BCF1C0BFB76A"></a><h4 id="DGBKR-GUID-5562D067-BAF8-45FA-9F49-BCF1C0BFB76A" class="sect4"><span class="enumeration_section">4.6.1</span>管理延迟申请</h4>
                  <div>
                     <p>您可以设置Apply Services，以便延迟重做到备用数据库的应用程序。</p>
                     <p>这允许备用数据库滞后于主数据库，并且如果在此窗口期间发生用户错误（例如，丢弃表），备用数据库仍将包含可以传输回主数据库的正确数据修复数据。</p>
                     <p>默认情况下，不会配置任何延迟，并且会尽快在备用数据库上应用重做数据。如果备用数据库配置了备用重做日志，则代理将启用实时应用。当Redo Apply和SQL Apply实时应用重做时，重做数据将在备用重做日志文件填充时直接从备用重做日志文件中恢复。这意味着在从归档重做日志文件应用重做数据之前，备用数据库不必等待归档日志文件。这最小化了主要和备用之间的事务延迟。</p>
                     <p>使用<code class="codeph">DelayMins</code>数据库属性指定在将重做数据应用于备用数据库之前，日志应用服务必须等待的分钟数。请注意，只有备用数据库上的日志应用服务会延迟。主数据库上的重做传输服务不会延迟，因此主数据库数据仍然受备用数据库的良好保护。
                     </p>
                     <div class="infoboxnote" id="GUID-5562D067-BAF8-45FA-9F49-BCF1C0BFB76A__GUID-81AD90CB-4BBA-476B-964D-0A032A2AC5FA">
                        <p class="notep1">警告：</p>
                        <p>由于代理自动启用对备用数据库的实时应用，因此Oracle建议您将所有数据库配置为使用闪回数据库。</p>
                     </div>
                  </div>
               </div><a id="DGBKR225"></a><div class="props_rev_3"><a id="GUID-BD2898F5-9BF4-444B-A0B5-3965F53C995D" name="GUID-BD2898F5-9BF4-444B-A0B5-3965F53C995D"></a><h4 id="DGBKR-GUID-BD2898F5-9BF4-444B-A0B5-3965F53C995D" class="sect4"><span class="enumeration_section">4.6.2</span>使用重做应用管理并行应用</h4>
                  <div>
                     <p>对于Redo Apply，您可以使用<code class="codeph">ApplyParallel</code>数据库属性配置是否使用多个并行进程来应用从主数据库接收的重做数据。
                     </p>
                     <p>默认情况下启用并行，这意味着Redo Apply会根据系统中的CPU数自动选择最佳并行进程数。（这相当于将<code class="codeph">ApplyParallel</code>属性设置为<code class="codeph">AUTO</code> 。）您可以通过将<code class="codeph">ApplyParallel</code>属性设置为<code class="codeph">NO</code>来禁用并行性。
                     </p>
                     <div class="infoboxnote" id="GUID-BD2898F5-9BF4-444B-A0B5-3965F53C995D__GUID-C871854B-35E6-48D2-9B6C-9F13B8E2C49C">
                        <p class="notep1">注意：</p>Parallel Redo Apply与多实例重做应用不同。Parallel Redo Apply表示每个实例有多个Redo Apply从站;使用代理<code class="codeph">ApplyParallel</code>属性设置此值。多实例重做应用意味着有多个实例正在运行重做应用;此值是使用代理<code class="codeph">ApplyInstances</code>属性设置的。这两个属性可以一起用于控制在多实例应用中运行apply的每个实例上的Redo Apply从属。在多实例应用配置中， <code class="codeph">ApplyParallel</code>属性指定的并行从属数量在每个实例上都是相同的。
                     </div>
                     <div class="infoboxnotealso" id="GUID-BD2898F5-9BF4-444B-A0B5-3965F53C995D__GUID-B9C95C91-63C6-468E-BB37-ECE28183348E">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="oracle-data-guard-broker-properties.html#GUID-1E8E8B1D-A138-4B31-8F8C-C5E4CC4F2E8C" title="ApplyParallel可配置属性指定Redo Apply是否应使用多个进程将重做数据应用于物理备用数据库。">ApplyParallel</a></p>
                        <p><a href="oracle-data-guard-broker-properties.html#GUID-E887A076-74A1-4970-8ED9-EF643D60DB0D" title="ApplyInstances属性允许您指定运行重做应用的物理备用实例的数量。">ApplyInstances</a></p>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-A0CC5489-FD5D-4B08-BD95-0319A1E958EA" name="GUID-A0CC5489-FD5D-4B08-BD95-0319A1E958EA"></a><h4 id="DGBKR-GUID-A0CC5489-FD5D-4B08-BD95-0319A1E958EA" class="sect4"><span class="enumeration_section">4.6.3</span>管理多实例重做应用</h4>
                  <div>
                     <p>对于Oracle RAC数据库中的重做应用，您可以通过<code class="codeph">ApplyInstances</code>属性值配置可以进行恢复的实例数。
                     </p>
                     <p>默认情况下，恢复活动中只涉及一个实例。但是，可以将<code class="codeph">ApplyInstances</code>属性设置为指示特定数量的实例或值<code class="codeph">ALL</code> ，以指示所有实例。启动恢复后，它会检查是否有足够的实例可用于启动恢复。如果没有，则代理延迟启动恢复一分钟以允许其他实例启动然后开始恢复。
                     </p>
                     <p>在定期运行状况检查期间，代理会检查是否有更多实例已启动，可能会进行恢复。如果是，则代理停止并重新启动恢复以启用其他实例。</p>
                     <p>更改<code class="codeph">ApplyInstances</code>属性值的值会导致使用新值重新启动恢复。
                     </p>
                     <p>所有实例必须处于相同状态（打开或挂载）才能在恢复中使用该实例。</p>
                  </div>
               </div><a id="DGBKR250"></a><div class="props_rev_3"><a id="GUID-AD180341-C7FD-4965-8826-E32372F10F27" name="GUID-AD180341-C7FD-4965-8826-E32372F10F27"></a><h4 id="DGBKR-GUID-AD180341-C7FD-4965-8826-E32372F10F27" class="sect4"><span class="enumeration_section">4.6.4</span>在Oracle RAC数据库环境中应用服务</h4>
                  <div>
                     <p>当备用数据库是Oracle RAC数据库时，SQL Apply和Redo Apply使用apply实例。</p>
                     <p>SQL Apply可以随时仅在Oracle RAC数据库的一个实例上运行。此实例称为apply实例。</p>
                     <p>Redo Apply可以同时在Oracle RAC数据库的所有实例上运行，但只有一个实例是应用协调器，这是代理认为是应用实例的实例。此功能要求将<code class="codeph">ApplyInstances</code>数据库可配置属性（仅在物理备用数据库上有效）设置为非零值。请参阅<a href="oracle-data-guard-broker-properties.html#GUID-E887A076-74A1-4970-8ED9-EF643D60DB0D" title="ApplyInstances属性允许您指定运行重做应用的物理备用实例的数量。">ApplyInstances</a> 。
                     </p>
                     <p>如果apply实例失败，则代理会根据需要在其他实例上自动重新启动SQL Apply或Redo Apply协调器。这称为应用实例故障转移（请参阅<a href="managing-oracle-data-guard-broker-configuration-members.html#GUID-EFAD8D8F-4BFB-418F-893B-F8B6548543B7" title="为了容忍应用实例的故障，代理通过自动将日志应用服务故障转移到其他备用实例来利用Oracle RAC备用数据库的可用性。">应用实例故障转移</a> ）。
                     </p>
                  </div><a id="DGBKR255"></a><div class="props_rev_3"><a id="GUID-F46F089F-F256-426B-B84A-4E1D25A469C7" name="GUID-F46F089F-F256-426B-B84A-4E1D25A469C7"></a><h5 id="DGBKR-GUID-F46F089F-F256-426B-B84A-4E1D25A469C7" class="sect5"><span class="enumeration_section">4.6.4.1</span>选择“应用实例”</h5>
                     <div>
                        <p>如果您没有偏好哪个实例是Oracle RAC备用数据库中的应用实例，则代理会随机选择一个应用实例。如果要选择特定实例作为应用实例，则有两种方法可以执行此操作。</p>
                        <div class="section">
                           <div class="infoboxnote" id="GUID-F46F089F-F256-426B-B84A-4E1D25A469C7__GUID-B08199AA-E64E-422B-962F-B3C835B500E0">
                              <p class="notep1">注意：</p>
                              <p>本节中的信息不适用于快照备用数据库或远程同步实例。</p>
                           </div>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>第一种方法是将<code class="codeph">PreferredApplyInstance</code>数据库属性的值设置为要作为应用实例的实例的名称（请参阅<code class="codeph">InstanceName</code>属性）。如果尚未在Oracle RAC备用数据库中选择应用实例，则代理将在该实例上启动日志应用服务。在首次启用备用数据库之前，或者如果应用实例刚刚失败且代理即将执行应用实例故障转移，或者Oracle RAC数据库当前是主数据库并且您要指定它的应用实例准备切换。选择应用实例后，只要应用实例仍在运行，代理就会忽略<code class="codeph">PreferredApplyInstance</code>属性的值，即使您更改它也是如此。
                                 </p>
                              </li>
                              <li>
                                 <p>第二种方法是在已经选择并运行应用实例时更改应用实例。要更改apply实例，请发出DGMGRL <code class="codeph">SET STATE</code>命令，将备用数据库状态设置为<code class="codeph">APPLY-ON</code> ，并使用特定的apply instance参数。<code class="codeph">SET STATE</code>命令将<code class="codeph">PreferredApplyInstance</code>属性更新为新的应用实例值，然后将日志应用服务移动到新实例。例如，使用DGMGRL <code class="codeph">SHOW</code>命令显示备用数据库的可用实例，然后发出<code class="codeph">EDIT DATABASE</code>命令以将日志应用服务移动到新实例：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; SHOW DATABASE'South_Sales'数据库 -  South_Sales角色：PHYSICAL STANDBY预期状态：APPLY-ON运输延迟：0秒（计算1秒前）应用滞后：0秒（计算1秒钟前）申请率：1017.00 KByte / s Real时间查询：OFF实例：south_sales1（应用实例）south_sales2数据库状态：成功</pre><pre class="oac_no_warn" dir="ltr">DGMGRL&gt;编辑数据库'South_Sales'ET STATE ='APPLY-ON'，带有APPLENT INSTANCE ='south_sales2';成功了。DGMGRL&gt; SHOW DATABASE'South_Sales''的PreferredApplyInstance'; PreferredApplyInstance ='south_sales2'</pre><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; SHOW DATABASE'South_Sales'数据库 -  South_Sales角色：PHYSICAL STANDBY预期状态：APPLY-ON运输延迟：0秒（计算1秒前）应用滞后：0秒（计算1秒钟前）申请率：1017.00 KByte / s Real时间查询：OFF实例：south_sales1 south_sales2（应用实例）数据库状态：成功</pre></li>
                           </ul>
                           <p>发出命令时，确保新的apply实例正在运行。否则，apply实例保持不变。</p>
                           <p>选择应用实例后，代理会继续在代理配置文件中应用实例信息，以便即使关闭并重新启动备用数据库，代理仍会选择相同的实例来启动日志应用服务。应用实例在用户更改之前保持不变，或者由于任何原因而失败，并且代理决定执行应用实例故障转移。</p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="DGBKR260"></a><div class="props_rev_3"><a id="GUID-EFAD8D8F-4BFB-418F-893B-F8B6548543B7" name="GUID-EFAD8D8F-4BFB-418F-893B-F8B6548543B7"></a><h5 id="DGBKR-GUID-EFAD8D8F-4BFB-418F-893B-F8B6548543B7" class="sect5"><span class="enumeration_section">4.6.4.2</span>应用实例故障转移</h5>
                     <div>
                        <p>为了容忍应用实例的故障，代理通过自动将日志应用服务故障转移到其他备用实例来利用Oracle RAC备用数据库的可用性。</p>
                        <p>代理提供的应用实例故障转移功能可增强数据保护。</p>
                        <p>要设置应用实例故障转移，请设置<code class="codeph">ApplyInstanceTimeout</code>数据库属性以指定代理在检测到应用实例故障之后和启动应用实例故障转移之前将等待的时间段。要选择适当的超时值，您需要考虑：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>如果群集中有另一种机制（例如Oracle Clusterware）将尝试恢复失败的应用实例。</p>
                           </li>
                           <li>
                              <p>您的企业可以容忍多长时间不在备用数据库上应用重做数据。</p>
                           </li>
                           <li>
                              <p>与移动日志相关联的开销将服务应用于其他实例。开销可以包括从主数据库重传在失败的应用实例上累积的所有日志文件，如果这些日志文件没有保存在可以从其他备用实例访问的共享文件系统中，则还没有应用。</p>
                           </li>
                        </ul>
                        <p><code class="codeph">ApplyInstanceTimeout</code>属性的代理默认值为0秒，表示应在检测到当前应用实例失败时立即发生应用实例故障转移。
                        </p>
                        <p>在代理启动应用实例故障转移后，代理会根据以下规则选择新的应用实例：如果<code class="codeph">PreferredApplyInstance</code>属性指示当前正在运行的实例，请将其选为新的应用实例;否则选择当前正在运行的随机实例作为新的应用实例。
                        </p>
                        <p>此外，如果物理备用数据库在应用实例失败时以实时查询模式运行，则在Oracle恢复清理完成后，代理将打开已自动关闭的所有实例。如果失败的apply实例是唯一打开的实例，则在开始应用服务之前打开选择作为新应用实例的实例，以便实时查询再次生效。</p>
                        <div class="infoboxnotealso" id="GUID-EFAD8D8F-4BFB-418F-893B-F8B6548543B7__GUID-E9311EAE-B8B3-415C-9C10-AE1F3EF46DD6">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>有关实时查询模式的详细信息，请参阅<a href="../sbydb/managing-oracle-data-guard-physical-standby-databases.html#SBYDB00707" target="_blank"><span class="italic">Oracle Data Guard概念和管理</span></a></p>
                              </li>
                              <li>
                                 <p>有关在Oracle Active Data Guard Oracle RAC备用数据库中应用实例故障的其他信息，请访问<a href="http://support.oracle.com" target="_blank"><code class="codeph">http://support.oracle.com</code></a>的My Oracle Support说明1357597.1</p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div>
               </div><a id="DGBKR3636"></a><div class="props_rev_3"><a id="GUID-EBA4925E-4580-4D06-9355-20DF777E5DCA" name="GUID-EBA4925E-4580-4D06-9355-20DF777E5DCA"></a><h4 id="DGBKR-GUID-EBA4925E-4580-4D06-9355-20DF777E5DCA" class="sect4"><span class="enumeration_section">4.6.5</span>应用滞后</h4>
                  <div>
                     <p>应用延迟是衡量备用数据库或远程同步实例中的数据滞后于主数据库中数据的程度的一种度量，因为传播和应用重做的延迟。</p>
                     <p>Cloud Control和DGMGRL客户端都显示每个托管备用数据库和远程同步实例的应用延迟。Cloud Control在Oracle Data Guard主页上显示应用延迟。DGMGRL客户端在<code class="codeph">SHOW DATABASE</code>输出中显示应用延迟。主数据库没有显示应用延迟。例如：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; SHOW DATABASE'South_Sales';数据库 -  South_Sales角色：PHYSICAL STANDBY预期状态：APPLY-ON传输延迟：0秒（计算0秒前） <span class="bold">应用滞后：0秒（计算0秒前）</span>应用率：255.00 KByte / s实时查询：关闭实例（s ）：south_sales1数据库状态：成功</pre><p></p>
                     <p>从Oracle Database Release 19c开始， <code class="codeph">SHOW CONFIGURATION LAG</code>命令显示代理配置的摘要和所有备用数据库的应用延迟。
                     </p>
                     <p>应用延迟可以帮助您识别重做传输服务和日志应用服务可能存在的任何问题。</p>
                     <p>您可以设置<code class="codeph">ApplyLagThreshold</code>数据库可配置属性，以便在备用数据库或远程同步实例滞后于主数据库中的数据时生成运行状况检查警告。
                     </p>
                     <p>以下命令将<code class="codeph">ApplyLagThreshold</code>属性设置为15秒：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt;编辑数据库'South_Sales'设置属性'ApplyLagThreshold'= 15;属性ApplyLagThreshold已更新</pre></div>
               </div>
            </div><a id="DGBKR265"></a><div class="props_rev_3"><a id="GUID-994BE350-859F-41DC-A1D3-B6E8D5EEF2C8" name="GUID-994BE350-859F-41DC-A1D3-B6E8D5EEF2C8"></a><h3 id="DGBKR-GUID-994BE350-859F-41DC-A1D3-B6E8D5EEF2C8" class="sect3"><span class="enumeration_section">4.7</span>管理数据保护模式</h3>
               <div>
                  <p>您可以使用代理设置具有任何不同数据保护模式的配置。</p>
                  <p>可用的数据保护模式包括：最大保护，最大可用性和最高性能。<a id="d7524e2564" class="indexterm-anchor"></a></p>
                  <p>本节包含以下主题，可帮助您为配置配置适当的保护：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="managing-oracle-data-guard-broker-configuration-members.html#GUID-A938EA13-B128-4D54-8A99-6871D93F01CE" title="以下是为配置设置保护模式的步骤。">设置配置的保护模式</a></p>
                     </li>
                     <li>
                        <p><a href="managing-oracle-data-guard-broker-configuration-members.html#GUID-4F9446D8-AB6E-4917-BED2-058126654DA0" title="这些主题描述了Oracle Data Guard配置的保护模式和重做传输服务如何影响切换，故障转移以及禁用或启用配置等操作。">保护模式如何影响经纪人的运作</a></p>
                     </li>
                  </ul>
               </div><a id="DGBKR270"></a><div class="props_rev_3"><a id="GUID-A938EA13-B128-4D54-8A99-6871D93F01CE" name="GUID-A938EA13-B128-4D54-8A99-6871D93F01CE"></a><h4 id="DGBKR-GUID-A938EA13-B128-4D54-8A99-6871D93F01CE" class="sect4"><span class="enumeration_section">4.7.1</span>设置配置的保护模式</h4>
                  <div>
                     <p>以下是为配置设置保护模式的步骤。</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="managing-oracle-data-guard-broker-configuration-members.html#GUID-6ABD41B9-E96A-40EE-B9A2-E963616F9DC0" title="每种数据保护模式都提供了数据保护，数据可用性和数据库性能的不同平衡。">设置保护模式任务1：确定要使用的数据保护模式</a></p>
                        </li>
                        <li>
                           <p><a href="managing-oracle-data-guard-broker-configuration-members.html#GUID-FA6A798E-4C1A-45C4-89EE-BA8918A8DD9C" title="无论您使用何种保护模式，都必须在所有备用数据库上添加备用重做日志文件。">设置保护模式任务2：设置备用重做日志文件</a></p>
                        </li>
                        <li>
                           <p><a href="managing-oracle-data-guard-broker-configuration-members.html#GUID-72DB59E4-097E-4821-9C7C-98B8389BA8F1" title="如果数据保护模式要求您更改任何备用数据库使用的重做传输模式，则更改每个备用数据库上的LogXptMode数据库属性，或者在主数据库或远程同步实例上设置RedoRoutes属性。直接连接到备用数据库。">设置保护模式任务3：设置重做传输模式</a></p>
                        </li>
                        <li>
                           <p><a href="managing-oracle-data-guard-broker-configuration-members.html#GUID-A8DE2A69-A808-48F9-AA43-BB12ED534A11" title="这些步骤描述了如何使用DGMGRL命令或Cloud Control设置保护模式。">设置保护模式任务4：使用DGMGRL或云控制</a></p>
                        </li>
                     </ul>
                  </div><a id="DGBKR285"></a><a id="DGBKR275"></a><a id="DGBKR280"></a><div class="props_rev_3"><a id="GUID-6ABD41B9-E96A-40EE-B9A2-E963616F9DC0" name="GUID-6ABD41B9-E96A-40EE-B9A2-E963616F9DC0"></a><h5 id="DGBKR-GUID-6ABD41B9-E96A-40EE-B9A2-E963616F9DC0" class="sect5"><span class="enumeration_section">4.7.1.1</span>设置保护模式任务1：确定要使用的数据保护模式</h5>
                     <div>
                        <p>每种数据保护模式都提供了数据保护，数据可用性和数据库性能的不同平衡。</p>
                        <div class="section">
                           <p>要选择满足业务需求的数据保护模式，请仔细考虑数据保护要求和用户的性能预期。</p>
                           <div class="infoboxnote" id="GUID-6ABD41B9-E96A-40EE-B9A2-E963616F9DC0__GUID-B662D377-B93C-434D-800A-64C87339217F">
                              <p class="notep1">注意：</p>
                              <p>在以下情况下不能使用最大保护模式：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>如果配置中唯一的备用数据库是快照备用数据库</p>
                                 </li>
                                 <li>
                                    <p>如果远程同步实例是从主数据库以同步模式接收重做的唯一配置成员</p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-6ABD41B9-E96A-40EE-B9A2-E963616F9DC0__GUID-8056395E-0703-44F1-B25C-0B7FD0121F50">最高可用性</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>此保护模式可提供最高级别的数据保护，而不会影响主数据库的可用性。在恢复这些事务所需的所有重做数据已写入联机重做日志和至少一个同步备用数据库上的备用重做日志之前，事务不会提交。如果主数据库无法将其重做流写入至少一个同步备用数据库，则它的运行方式就像它处于最高性能模式一样，以保持主数据库可用性，直到它再次能够将其重做流写入同步备用数据库。</p>
                           <p>此模式可确保在主数据库发生故障时不会发生数据丢失，但仅当第二个故障不会阻止从主数据库向至少一个备用数据库发送完整的重做数据集时。</p>
                           <p>如果保护模式为最大可用性，则可以启用快速启动故障转移。</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-6ABD41B9-E96A-40EE-B9A2-E963616F9DC0__GUID-53935982-E64E-49C1-8A31-455907C281A2">最高性能</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>此保护模式提供最高级别的数据保护，而不会影响主数据库的性能。这是通过允许事务在这些事务生成的所有重做数据写入在线日志后立即提交来实现的。重做数据也会写入一个或多个备用数据库，但这是在事务承诺方面异步完成的，因此主数据库性能不会受到将重做数据写入备用数据库的延迟的影响。</p>
                           <p>与最大可用性模式相比，此保护模式提供的数据保护略少，对主数据库性能的影响最小。</p>
                           <p>这是默认保护模式。</p>
                           <p>如果保护模式是最高性能，则可以启用快速启动故障转移。</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-6ABD41B9-E96A-40EE-B9A2-E963616F9DC0__GUID-0329DF7B-6FE4-436F-9950-EF8D520DD220">最大保护</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>此保护模式可确保在主数据库发生故障时不会发生数据丢失。为了提供这种级别的保护，在事务提交之前，必须将恢复事务所需的重做数据写入至少一个同步备用数据库的联机重做日志和备用重做日志。为确保不会发生数据丢失，如果主数据库无法将其重做流写入至少一个同步备用数据库，则主数据库将关闭，而不是继续处理事务。</p>
                           <p>一旦Oracle Data Guard将重做数据写入备用重做日志文件中的永久存储，主要事务就被视为受保护。完成后，确认将快速返回主数据库，以便它可以继续进行下一个事务。这最大限度地减少了同步传输对主数据库吞吐量和响应时间的影响。要在备用数据库中完全受益于完整的Oracle Data Guard验证，请确保以实时应用模式运行，以便重新更改以尽可能快的速度应用于备用数据库。Oracle Data Guard会发出任何检测到的损坏信号，以便立即采取纠正措施。</p>
                           <p>由于此数据保护模式优先考虑主数据库可用性的数据保护，因此Oracle建议至少使用两个备用数据库来保护以最大保护模式运行的主数据库，以防止单个数据库故障导致主数据库关闭。如果只有一个备用数据库支持最大保护模式，则Oracle Data Guard代理将禁止关闭apply实例。这可以防止主数据库关闭。</p>
                           <p>如果保护模式是最大保护，则可以启用快速启动故障转移。</p>
                           <div class="infoboxnotealso" id="GUID-6ABD41B9-E96A-40EE-B9A2-E963616F9DC0__GUID-12697183-7CB5-4BE9-8FAE-554C8AEB65F2">
                              <p class="notep1">也可以看看：</p>
                              <p></p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><a href="using-data-guard-broker-to-manage-switchovers-failovers.html#GUID-995CED84-BEA1-4675-9C68-B37CB996924F" title="Fast-start failover allows the broker to automatically fail over to a previously chosen standby database in the event of loss of the primary database.">快速启动故障转移，</a>以获取有关快速启动故障<a href="using-data-guard-broker-to-manage-switchovers-failovers.html#GUID-995CED84-BEA1-4675-9C68-B37CB996924F" title="快速启动故障转移允许代理在丢失主数据库时自动故障转移到先前选择的备用数据库。">转移</a>的信息</p>
                                 </li>
                                 <li>
                                    <p>有关数据保护模式的完整信息，请参阅<a href="../sbydb/introduction-to-oracle-data-guard-concepts.html#SBYDB00439" target="_blank"><span class="italic">Oracle Data Guard概念和管理</span></a></p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
                  <div class="props_rev_3"><a id="GUID-FA6A798E-4C1A-45C4-89EE-BA8918A8DD9C" name="GUID-FA6A798E-4C1A-45C4-89EE-BA8918A8DD9C"></a><h5 id="DGBKR-GUID-FA6A798E-4C1A-45C4-89EE-BA8918A8DD9C" class="sect5"><span class="enumeration_section">4.7.1.2</span>设置保护模式任务2：设置备用重做日志文件</h5>
                     <div>
                        <p>无论您使用何种保护模式，都必须在所有备用数据库上添加备用重做日志文件。</p>
                        <div class="section">
                           <p>此外，Oracle要求您在主数据库上添加备用重做日志文件，以便为将来的切换或故障转移做好准备。如果要启用快速启动故障转移，则主数据库上需要备用重做日志文件。</p>
                           <p>Cloud Control会自动提示您在配置中选择一个或多个备用数据库，并在它们和主数据库上设置备用重做日志（SRL）文件，以便为将来的角色更改做准备。</p>
                           <div class="infoboxnotealso" id="GUID-FA6A798E-4C1A-45C4-89EE-BA8918A8DD9C__GUID-422521AE-E2DB-41EA-BCDE-F802A32AC619">
                              <p class="notep1">也可以看看：</p>
                              <p>如果你正在使用<a id="d7524e2794" class="indexterm-anchor"></a><a id="d7524e2798" class="indexterm-anchor"></a> DGMGRL命令行界面，按照<a href="../sbydb/creating-oracle-data-guard-physical-standby.html#SBYDB00426" target="_blank"><span class="italic">Oracle Data Guard概念和管理</span></a>中的说明配置备用重做日志文件。
                              </p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="DGBKR3540"></a><div class="props_rev_3"><a id="GUID-72DB59E4-097E-4821-9C7C-98B8389BA8F1" name="GUID-72DB59E4-097E-4821-9C7C-98B8389BA8F1"></a><h5 id="DGBKR-GUID-72DB59E4-097E-4821-9C7C-98B8389BA8F1" class="sect5"><span class="enumeration_section">4.7.1.3</span>设置保护模式任务3：设置重做传输模式</h5>
                     <div>
                        <p>如果数据保护模式要求您更改任何备用数据库使用的重做传输模式，则更改每个备用数据库上的<code class="codeph">LogXptMode</code>数据库属性，或者在主数据库或远程同步实例上设置<code class="codeph">RedoRoutes</code>属性。直接连接到备用数据库。
                        </p>
                        <div class="section">
                           <p>有关设置<a href="managing-oracle-data-guard-broker-configuration-members.html#GUID-6DC53E53-63F3-42D7-865E-C7689AEBD44A" title="To manage redo transport services, you specify configurable properties on each configuration member.">重做传输服务</a>的详细信息，请参阅<a href="managing-oracle-data-guard-broker-configuration-members.html#GUID-6DC53E53-63F3-42D7-865E-C7689AEBD44A" title="要管理重做传输服务，请在每个配置成员上指定可配置属性。">管理</a>重做传输服务。<a href="managing-oracle-data-guard-broker-configuration-members.html#GUID-72DB59E4-097E-4821-9C7C-98B8389BA8F1__G1046794" title="这是一个4列表，显示了保护模式以及相应的日志传输模式和SQL语句。第1列是保护模式。第2列是重做传输。第3列显示是否需要备用重做日志文件。第4列指示模式是否可用于快速启动故障转移。">表4-2</a>显示了保护模式和相应的重做传输服务。
                           </p>
                           <p>Cloud Control会自动在主数据库上指定正确的重做传输服务，以便为将来的切换做准备。</p>
                           <div class="tblformal" id="GUID-72DB59E4-097E-4821-9C7C-98B8389BA8F1__G1046794">
                              <p class="titleintable">表4-2 Oracle Data Guard保护模式和要求</p>
                              <table cellpadding="4" cellspacing="0" class="Formal" title="Oracle Data Guard保护模式和要求" width="100%" border="1" summary="The is a 4 column table showing the protection mode and the corresponding log transport mode and SQL statement. Column 1 is the protection mode. Column 2 is the Redo Transport. Column 3 shows if standby redo log files are needed. Column 4 indicates if the mode is usable with Fast-Start Failover." frame="hsides" rules="rows">
                                 <thead>
                                    <tr align="left" valign="top">
                                       <th align="left" valign="bottom" width="26%" id="d7524e2865">保护模式</th>
                                       <th align="left" valign="bottom" width="21%" id="d7524e2868">重做运输</th>
                                       <th align="left" valign="bottom" width="24%" id="d7524e2871">需要备用重做日志文件吗？</th>
                                       <th align="left" valign="bottom" width="29%" id="d7524e2874">可用于快速启动故障转移？</th>
                                    </tr>
                                 </thead>
                                 <tbody>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="26%" id="d7524e2879" headers="d7524e2865 ">
                                          <p><code class="codeph">MAXPROTECTION</code></p>
                                       </td>
                                       <td align="left" valign="top" width="21%" headers="d7524e2879 d7524e2868 ">
                                          <p><code class="codeph">同步</code></p>
                                       </td>
                                       <td align="left" valign="top" width="24%" headers="d7524e2879 d7524e2871 ">
                                          <p>是</p>
                                       </td>
                                       <td align="left" valign="top" width="29%" headers="d7524e2879 d7524e2874 ">
                                          <p>是</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="26%" id="d7524e2894" headers="d7524e2865 ">
                                          <p><code class="codeph">MAXAVAILABILITY</code></p>
                                       </td>
                                       <td align="left" valign="top" width="21%" headers="d7524e2894 d7524e2868 ">
                                          <p><code class="codeph">SYNC</code> ， <code class="codeph">FASTSYNC</code></p>
                                       </td>
                                       <td align="left" valign="top" width="24%" headers="d7524e2894 d7524e2871 ">
                                          <p>是</p>
                                       </td>
                                       <td align="left" valign="top" width="29%" headers="d7524e2894 d7524e2874 ">
                                          <p>是<a id="fn_1" name="fn_1" href="#fn_1" data="" because="" fastsync="" transport="" mode="" uses="" the="" noaffirm="" attribute="" of="" log_archive_dest_n="" parameter,="" loss="" is="" possible.="" this="" means="" that="" a="" fast-start="" failover="" cannot="" be="" initiated="" when="" used="" and="" standby="" missing="" redo="" ="" ="" onclick="footdisplay(1, "><sup>脚1</sup></a></p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="26%" id="d7524e2927" headers="d7524e2865 ">
                                          <p><code class="codeph">MAXPERFORMANCE</code></p>
                                       </td>
                                       <td align="left" valign="top" width="21%" headers="d7524e2927 d7524e2868 ">
                                          <p><code class="codeph">异步</code></p>
                                       </td>
                                       <td align="left" valign="top" width="24%" headers="d7524e2927 d7524e2871 ">
                                          <p>是</p>
                                       </td>
                                       <td align="left" valign="top" width="29%" headers="d7524e2927 d7524e2874 ">
                                          <p>是</p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <!-- class="inftblhruleinformal" -->
                           <p class="tablefootnote"><sup class="tablefootnote">脚注1</sup></p><p>由于<code class="codeph">FASTSYNC</code>传输模式使用<code class="codeph">LOG_ARCHIVE_DEST_n</code>参数的<code class="codeph">NOAFFIRM</code>属性，因此可能会丢失数据。这意味着当使用<code class="codeph">FASTSYNC</code>且备用数据库缺少重做数据时，无法启动快速启动故障转移。
                              </p>
                           <p></p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
                  <div class="props_rev_3"><a id="GUID-A8DE2A69-A808-48F9-AA43-BB12ED534A11" name="GUID-A8DE2A69-A808-48F9-AA43-BB12ED534A11"></a><h5 id="DGBKR-GUID-A8DE2A69-A808-48F9-AA43-BB12ED534A11" class="sect5"><span class="enumeration_section">4.7.1.4</span>设置保护模式任务4：使用DGMGRL或云控制</h5>
                     <div>
                        <p>这些步骤描述了如何使用DGMGRL命令或Cloud Control设置保护模式。</p>
                        <div class="section">
                           <p><span class="bold">使用DGMGRL：</span></p>
                           <ol>
                              <li>
                                 <p>使用<code class="codeph">EDIT DATABASE (property)</code>命令并指定备用数据库，其重做传输服务应更改为与您计划设置的保护模式相对应。例如，如果计划将整个Oracle Data Guard配置设置为在最大可用性模式下运行，则必须使用<code class="codeph">EDIT DATABASE</code>命令为重做传输服务设置<code class="codeph">SYNC</code>模式。例如：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt;编辑数据库'South_Sales'Set PROPERTY LogXptMode ='SYNC';</pre><p>对配置中的主数据库或其他备用数据库也执行此操作，以确保它可以在切换后支持所选的保护模式。</p>
                                 <p>您还可以使用<code class="codeph">RedoRoutes</code>属性，如下所示：</p><pre class="oac_no_warn" dir="ltr">EDIT DATABASE'North_Sales'Set PROPERTY RedoRoutes ='（LOCAL：South_Sales SYNC）';</pre></li>
                              <li>
                                 <p>使用<code class="codeph">EDIT CONFIGURATION SET PROTECTION MODE AS</code> <span class="italic"><code class="codeph">protection-mode</code></span>命令设置整体配置保护模式。例如：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt;编辑配置集保护模式为最大可用性;</pre></li>
                           </ol>
                           <p>请参阅<a href="examples-using-data-guard-broker-DGMGRL-utility.html#GUID-82319941-58E8-4672-8609-7CC496D3DC29" title="You can change the protection mode of the configuration at any time.">场景4：</a>为DGMGRL场景<a href="examples-using-data-guard-broker-DGMGRL-utility.html#GUID-82319941-58E8-4672-8609-7CC496D3DC29" title="您可以随时更改配置的保护模式。">设置配置保护模式</a> ，以显示如何设置保护模式。
                           </p>
                           <p><span class="bold">使用云控制：</span></p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li><span>在Oracle Data Guard概述页面上，单击Protection Mode标签右侧的链接。</span></li>
                           <li><span>选择最大保护，最高可用性或最高性能，然后单击继续。</span></li>
                           <li><span>如果出现提示，请使用<code class="codeph">SYSDG</code>或<code class="codeph">SYSDBA</code>权限登录数据库，然后单击“登录”。</span></li>
                           <li><span>选择一个或多个备用数据库以支持您选择的保护模式。如果需要备用重做日志文件，请验证日志文件的名称。单击确定。</span></li>
                           <li><span>在“确认”页面上，单击“是”。</span></li>
                        </ol>
                        <div class="section">
                           <p>代理不允许保护模式直接从最高性能模式升级到最大保护模式。您必须先从最高性能更改为最大可用性，然后再进行最大程度的保护。</p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div><a id="DGBKR290"></a><div class="props_rev_3"><a id="GUID-4F9446D8-AB6E-4917-BED2-058126654DA0" name="GUID-4F9446D8-AB6E-4917-BED2-058126654DA0"></a><h4 id="DGBKR-GUID-4F9446D8-AB6E-4917-BED2-058126654DA0" class="sect4"><span class="enumeration_section">4.7.2</span>保护模式如何影响经纪人操作</h4>
                  <div>
                     <p>这些主题描述了Oracle Data Guard配置的保护模式和重做传输服务如何影响切换，故障转移以及禁用或启用配置等操作。</p>
                     <p>本节此部分包含以下部分：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="managing-oracle-data-guard-broker-configuration-members.html#GUID-37E01064-2FD0-4206-B737-37D28066E722">升级或降级电流保护模式</a></p>
                        </li>
                        <li>
                           <p><a href="managing-oracle-data-guard-broker-configuration-members.html#GUID-65830C4F-A603-4D69-AAC8-54EA08C1172C">切换操作</a></p>
                        </li>
                        <li>
                           <p><a href="managing-oracle-data-guard-broker-configuration-members.html#GUID-C7F2658B-1097-4F0A-B6D8-D1E82F9FEF9A">故障转移操作</a></p>
                        </li>
                        <li>
                           <p><a href="managing-oracle-data-guard-broker-configuration-members.html#GUID-4AE4576C-6106-467C-A6EF-88F6CBAF5E4C">禁用和启用操作</a></p>
                        </li>
                        <li>
                           <p><a href="managing-oracle-data-guard-broker-configuration-members.html#GUID-522A06B1-28DA-4E5A-9657-8E9FB990C98A">从配置中删除数据库的要求</a></p>
                        </li>
                        <li>
                           <p><a href="managing-oracle-data-guard-broker-configuration-members.html#GUID-B94E0996-ABDC-47F7-82FB-6C6E3A1FC638">其他业务要求</a></p>
                        </li>
                     </ul>
                  </div><a id="DGBKR295"></a><div class="props_rev_3"><a id="GUID-37E01064-2FD0-4206-B737-37D28066E722" name="GUID-37E01064-2FD0-4206-B737-37D28066E722"></a><h5 id="DGBKR-GUID-37E01064-2FD0-4206-B737-37D28066E722" class="sect5"><span class="enumeration_section">4.7.2.1</span>升级或降级当前保护模式</h5>
                     <div>
                        <p>将当前Oracle Data Guard保护模式升级到最大可用性或降级当前Oracle Data Guard保护模式时，无需重新启动。升级或降级Oracle Data Guard保护模式时，请遵循以下建议：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>在升级保护模式时，请在升级整体保护模式之前升级重做传输服务。在更改保护模式或重置备用数据库的重做传输服务时，代理会验证配置中是否至少有一个备用数据库可以支持所需的保护等级。如果不是，则代理不会更改保护模式并返回错误。
                              </p>
                           </li>
                           <li>
                              <p>什么时候<a id="d7524e3138" class="indexterm-anchor"></a>降级保护模式， <a id="d7524e3145" class="indexterm-anchor"></a><a id="d7524e3149" class="indexterm-anchor"></a>首先降级保护模式，然后更改重做传输服务（如有必要）。如果这样做会使当前的整体保护模式无效，则代理将禁止更改重做传输服务。
                              </p>
                           </li>
                        </ul>
                        <p>如果从最高性能模式升级保护模式，则代理会确保至少有一个备用数据库通过<code class="codeph">SYNC</code>传输直接或通过远程同步实例接收重做。此外，为了升级到最大保护模式，代理确保备用数据库上的重做数据没有间隙。如果配置中没有满足这些要求的备用数据库，则会拒绝升级保护模式的请求并显示错误。
                        </p>
                        <p>如果启用快速启动故障转移，则无法更改保护模式。例外情况是，在最大保护模式下启用快速启动故障切换时，允许降级到最大可用性模式。</p>
                     </div>
                  </div><a id="DGBKR300"></a><div class="props_rev_3"><a id="GUID-65830C4F-A603-4D69-AAC8-54EA08C1172C" name="GUID-65830C4F-A603-4D69-AAC8-54EA08C1172C"></a><h5 id="DGBKR-GUID-65830C4F-A603-4D69-AAC8-54EA08C1172C" class="sect5"><span class="enumeration_section">4.7.2.2</span>切换操作</h5>
                     <div>
                        <p>转换<a id="d7524e3184" class="indexterm-anchor"></a>不会更改整体Oracle Data Guard保护模式。保护模式与切换前保持一致。
                        </p>
                        <p>这要求在切换完成后，正确配置备用数据库以支持当前保护模式。这可以是配置中的另一个备用数据库，也可以是切换完成后将成为备用数据库的当前主数据库。</p>
                        <p>在执行切换之前，如有必要，可以添加备用重做日志文件，并将当前主数据库或配置中的其他备用数据库上的重做传输属性设置为支持Oracle Data Guard保护所需的传输模式模式。然后，当切换开始时：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>代理验证每个备用数据库和当前主数据库上是否存在备用重做日志文件和重做传输服务设置。</p>
                           </li>
                           <li>
                              <p>代理验证目标备用数据库上存在的重做数据没有间隙。</p>
                           </li>
                        </ul>
                        <p>如果验证成功，则切换继续;否则，切换失败，数据库角色和代理配置文件保持不变。</p>
                        <div class="infoboxnotewarn" id="GUID-65830C4F-A603-4D69-AAC8-54EA08C1172C__GUID-F67990C2-A622-4064-BBD5-5A4D9956A999">
                           <p class="notep1">警告：</p>
                           <p></p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>如果切换目标是物理备用数据库，则代理将关闭并重新启动主数据库。</p>
                              </li>
                           </ul>
                        </div>
                        <div class="infoboxnotealso" id="GUID-65830C4F-A603-4D69-AAC8-54EA08C1172C__GUID-25CA688E-58E9-4D75-BD20-368388A7D09F">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="using-data-guard-broker-to-manage-switchovers-failovers.html#GUID-AC6A6D2B-1112-422B-8A41-02FAC40E2078" title="切换是主数据库与其中一个备用数据库之间的角色转换。">切换</a>有关切换的更多信息</p>
                        </div>
                     </div>
                  </div><a id="DGBKR305"></a><div class="props_rev_3"><a id="GUID-C7F2658B-1097-4F0A-B6D8-D1E82F9FEF9A" name="GUID-C7F2658B-1097-4F0A-B6D8-D1E82F9FEF9A"></a><h5 id="DGBKR-GUID-C7F2658B-1097-4F0A-B6D8-D1E82F9FEF9A" class="sect5"><span class="enumeration_section">4.7.2.3</span>故障转移操作</h5>
                     <div>
                        <p>执行手册后<a id="d7524e3241" class="indexterm-anchor"></a><a id="d7524e3247" class="indexterm-anchor"></a><a id="d7524e3251" class="indexterm-anchor"></a>如果保护模式处于最大保护状态，则Oracle Data Guard保护模式将降级为最高性能模式。如有必要，您可以稍后升级保护模式。如果保护模式处于最大可用性或最大性能，则保持模式保持不变。备用数据库的重做传输服务保持不变。
                        </p>
                        <p>如果发生快速启动故障转移，则代理会保留在快速启动故障转移之前生效的保护模式。如果保护模式是最大保护，则保留配置保护模式，但新主数据库设置为最大可用性以允许实例打开。当备用数据库可用时支持最大保护模式（因为恢复了旧的主数据库或由于配置中存在另一个备用数据库），数据库保护模式将提升以匹配最大保护的配置保护模式。</p>
                        <div class="infoboxnotealso" id="GUID-C7F2658B-1097-4F0A-B6D8-D1E82F9FEF9A__GUID-0757800D-4C2F-433F-A795-82B6850B6A34">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="using-data-guard-broker-to-manage-switchovers-failovers.html#GUID-9A988501-7E18-4A62-8CD6-4BDDFA355C98" title="In a manual failover, you convert a standby database to a primary database because the original primary database failed and there is no possibility of recovering the primary database in a timely manner.">手动故障转移</a>和<a href="using-data-guard-broker-to-manage-switchovers-failovers.html#GUID-995CED84-BEA1-4675-9C68-B37CB996924F" title="Fast-start failover allows the broker to automatically fail over to a previously chosen standby database in the event of loss of the primary database.">快速启动故障</a>转移分别有关手动故障<a href="using-data-guard-broker-to-manage-switchovers-failovers.html#GUID-9A988501-7E18-4A62-8CD6-4BDDFA355C98" title="在手动故障转移中，您将备用数据库转换为主数据库，因为原始主数据库失败，并且不可能及时恢复主数据库。">转移</a>和<a href="using-data-guard-broker-to-manage-switchovers-failovers.html#GUID-995CED84-BEA1-4675-9C68-B37CB996924F" title="快速启动故障转移允许代理在丢失主数据库时自动故障转移到先前选择的备用数据库。">快速启动故障转移</a>的详细信息</p>
                        </div>
                     </div>
                  </div><a id="DGBKR310"></a><div class="props_rev_3"><a id="GUID-4AE4576C-6106-467C-A6EF-88F6CBAF5E4C" name="GUID-4AE4576C-6106-467C-A6EF-88F6CBAF5E4C"></a><h5 id="DGBKR-GUID-4AE4576C-6106-467C-A6EF-88F6CBAF5E4C" class="sect5"><span class="enumeration_section">4.7.2.4</span>禁用和启用操作</h5>
                     <div>
                        <p>当你<a id="d7524e3298" class="indexterm-anchor"></a>禁用代理数据库的代理管理，代理检查是否仍可以通过任何剩余的备用数据库满足整体保护模式。如果不是，则代理拒绝禁用操作。否则，只要未启用快速启动故障切换，代理就会允许禁用操作继续。如果已启用，则仅当备用数据库不是用于快速启动故障转移的目标备用数据库时，代理才允许禁用操作继续。
                        </p>
                        <div class="infoboxnotewarn" id="GUID-4AE4576C-6106-467C-A6EF-88F6CBAF5E4C__GUID-CAC7E3DB-FEE7-4924-BD9F-E08E5EFFDD0D">
                           <p class="notep1">警告：</p>
                           <p>如果在代理配置中禁用备用数据库的代理管理，则在丢失主数据库时，代理不能将该备用数据库用作故障转移目标。</p>
                        </div>
                        <p>只要未启用快速启动故障切换，您就可以禁用整个配置，而不管保护模式如何。如果启用了快速启动故障转移，则无法禁用配置。有关详细信息，请参阅<a href="using-data-guard-broker-to-manage-switchovers-failovers.html#GUID-3DAD4204-B8FB-425D-9D22-0602C62FA89A" title="此列表描述启用快速启动故障转移时的限制。">启用快速启动故障转移时的限制</a> 。
                        </p>
                        <p>什么时候<a id="d7524e3319" class="indexterm-anchor"></a>在启用代理管理整个配置时，代理首先检查将启用的备用数据库的重做传输设置是否满足保护模式。如果不是，则启用操作失败，配置保持禁用状态。否则，启用操作将成功启用配置，代理将使用代理配置文件中保存的设置启用数据库。
                        </p>
                     </div>
                  </div><a id="DGBKR315"></a><div class="props_rev_3"><a id="GUID-522A06B1-28DA-4E5A-9657-8E9FB990C98A" name="GUID-522A06B1-28DA-4E5A-9657-8E9FB990C98A"></a><h5 id="DGBKR-GUID-522A06B1-28DA-4E5A-9657-8E9FB990C98A" class="sect5"><span class="enumeration_section">4.7.2.5</span>从配置中删除数据库的要求</h5>
                     <div>
                        <p>什么时候<a id="d7524e3349" class="indexterm-anchor"></a><a id="d7524e3353" class="indexterm-anchor"></a>去除<a id="d7524e3358" class="indexterm-anchor"></a>代理配置中的备用数据库，代理检查是否仍将满足保护模式。如果操作失败：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>删除数据库会破坏保护模式</p>
                           </li>
                           <li>
                              <p>启用快速启动故障转移，并尝试删除作为快速启动故障转移目标的备用数据库</p>
                           </li>
                           <li>
                              <p>要删除的配置成员将其<code class="codeph">RedoRoutes</code>配置属性设置为非空值</p>
                           </li>
                        </ul>
                        <p>您可以随时删除配置，除非启用了快速启动故障转移。</p>
                     </div>
                  </div><a id="DGBKR320"></a><div class="props_rev_3"><a id="GUID-B94E0996-ABDC-47F7-82FB-6C6E3A1FC638" name="GUID-B94E0996-ABDC-47F7-82FB-6C6E3A1FC638"></a><h5 id="DGBKR-GUID-B94E0996-ABDC-47F7-82FB-6C6E3A1FC638" class="sect5"><span class="enumeration_section">4.7.2.6</span>其他操作要求</h5>
                     <div>
                        <p>在代理配置中发生的某些操作（尤其是与重做传输服务相关的操作）可能会影响整体保护模式。这些操作包括：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>停止主数据库上的重做传输服务</p>
                           </li>
                           <li>
                              <p>停止重做传输服务到单个备用数据库</p>
                           </li>
                           <li>
                              <p>将重做传输模式从<code class="codeph">SYNC</code>降级到<code class="codeph">ASYNC</code>再到支持在最大可用性模式或最大保护模式下运行的配置的唯一备用数据库</p>
                           </li>
                        </ul>
                        <p>在任何这些操作可以继续之前，代理会在操作完成后检查备用数据库上的重做传输服务设置是否支持保护模式。如果不是，代理将失败该操作并返回错误。</p>
                     </div>
                  </div>
               </div>
            </div><a id="DGBKR3854"></a><div class="props_rev_3"><a id="GUID-247E7C1E-EEC0-42CA-AC9F-E73948F5EDC1" name="GUID-247E7C1E-EEC0-42CA-AC9F-E73948F5EDC1"></a><h3 id="DGBKR-GUID-247E7C1E-EEC0-42CA-AC9F-E73948F5EDC1" class="sect3"><span class="enumeration_section">4.8</span>管理远程同步实例</h3>
               <div>
                  <p>Oracle Data Guard远程同步实例是一个重做传输目标，它接受来自主数据库的重做，并将该重做转发到配置中的一个或多个重做目标。</p>
                  <p>它类似于物理备用数据库，因为它具有控制文件，将重做接收到备用重做日志文件（SRL），并将这些SRL归档到本地存档重做日志（ARL）。但与备用数据库不同，远程同步实例没有数据文件，无法打开，也无法应用接收到的重做。这些限制产生了使用更少磁盘和处理资源的好处。更重要的是，远程同步实例提供了故障转移到终端数据库的能力，如果它使用同步传输模式接收重做数据并且配置保护模式设置为最大可用性，则不会丢失数据。</p>
                  <p>以下示例显示如何将远程同步实例添加到代理配置。</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; ADD FAR_SYNC FS1 AS CONNECT IDENTIFIER是FS1.example.com;远程同步FS1添加了DGMGRL&gt; ENABLE FAR_SYNC FS1;启用。DGMGRL&gt; SHOW CONFIGURATION;配置 -  DRSolution保护模式：MaxPerformance成员：North_Sales  - 主数据库FS1  - 远程同步South_Sales  - 物理备用数据库快速启动故障转移：禁用配置状态：成功</pre><p>将远程同步实例添加到配置后，设置重做传输以支持最大可用性，然后升级保护模式：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; EDIT DATABASE'North_Sales'Set PROPERTY'RedoRoutes'='（LOCAL：FS1 SYNC）'; DGMGRL&gt;编辑FAR_SYNC'FS1'设置属性'RedoRoutes'='（North_Sales：South_Sales ASYNC）'; DGMGRL&gt;编辑配置设置保护模式为MaxAvailability; DGMGRL&gt; SHOW CONFIGURATION;配置 -  DRSolution保护模式：MaxAvailability成员：North_Sales  - 主数据库FS1  - 远程同步South_Sales  - 物理备用数据库快速启动故障转移：禁用配置状态：成功</pre><p>为确保在<code class="codeph">South_Sales</code>为主数据库时可以保持最大可用性保护模式，在切换或故障转移后，将第二个远程同步实例添加到配置中，以便<code class="codeph">South_Sales</code>可以在同步模式下发送重做，然后将重做发送到新的终端数据库， <code class="codeph">North_Sales,</code>角色转换后。
                  </p>
                  <p>以下示例显示如何将第二个远程同步实例添加到代理配置：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; ADD FAR_SYNC FS2 AS CONNECT IDENTIFIER是FS2.example.com;远程同步FS2添加了DGMGRL&gt;编辑FAR_SYNC'FS2'设置属性'RedoRoutes'='（South_Sales：North_Sales ASYNC）'; DGMGRL&gt; ENABLE FAR_SYNC FS2;启用。DGMGRL&gt; EDIT DATABASE'South_Sales'Set PROPERTY'RedoRoutes'='（LOCAL：FS2 SYNC）'; DGMGRL&gt; SHOW CONFIGURATION;配置 -  DRSolution保护模式：MaxAvailability成员：North_Sales  - 主数据库FS1  - 远程同步South_Sales  - 物理备用数据库FS2  - 远程同步（非活动）快速启动故障转移：禁用配置状态：成功</pre><p>如果Oracle Clusterware监视远程同步实例的可用性（例如，在Oracle Restart，Oracle Real Application Clusters（Oracle RAC）或Oracle RAC One Node安装中），则使用SRVCTL实用程序指定默认的打开模式安装。您可以使用如下命令：</p><pre class="oac_no_warn" dir="ltr">srvctl修改数据库-d &lt;db_unique_name&gt; -startoption MOUNT</pre><div class="infoboxnotealso" id="GUID-247E7C1E-EEC0-42CA-AC9F-E73948F5EDC1__GUID-38D89FD8-07EA-4C8C-A73C-339441919134">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>有关创建远程同步实例和重做传输的详细信息，请参阅<a href="../sbydb/creating-oracle-data-guard-far-sync-instance.html#SBYDB5416" target="_blank"><span class="italic">Oracle Data Guard概念和管理</span></a></p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div><a id="DGBKR00677"></a><div class="props_rev_3"><a id="GUID-E2C40F7E-8ACC-4A75-AAAA-52E54F39F488" name="GUID-E2C40F7E-8ACC-4A75-AAAA-52E54F39F488"></a><h3 id="DGBKR-GUID-E2C40F7E-8ACC-4A75-AAAA-52E54F39F488" class="sect3"><span class="enumeration_section">4.9</span>管理快速启动故障转移</h3>
               <div>
                  <p>您可以启用<span class="bold">快速启动故障转移，</span>以允许代理确定是否需要进行故障转移，以及从一个或多个预先指定的目标备用数据库的列表启动到备用数据库的故障转移。
                  </p>
                  <p>可以将故障转移设置为无数据丢失或可配置的数据丢失量。此外，您还可以指定要在哪些条件或错误下启动故障转移。Oracle还提供<code class="codeph">DBMS_DG</code> PL / SQL程序包，以允许应用程序请求快速启动故障转移。
                  </p>
                  <p>您可以使用代理配置属性来控制快速启动故障转移的行为。您还可以使用Cloud Control或DGMGRL <code class="codeph">ENABLE FAST_START FAILOVER CONDITION</code>和<code class="codeph">DISABLE FAST_START FAILOVER CONDITION</code>命令来指定应该进行快速启动故障转移的条件。
                  </p>
               </div><a id="DGBKR3397"></a><div class="props_rev_3"><a id="GUID-E4B19583-762C-4F07-A3B5-566A3481B254" name="GUID-E4B19583-762C-4F07-A3B5-566A3481B254"></a><h4 id="DGBKR-GUID-E4B19583-762C-4F07-A3B5-566A3481B254" class="sect4"><span class="enumeration_section">4.9.1</span>配置属性以调整快速启动故障转移</h4>
                  <div>
                     <p>您可以设置各种属性以调整快速启动故障转移的行为方式。</p>
                     <p>快速启动故障转移的可配置属性包括：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">FastStartFailoverThreshold</code> 
                           </p>
                           <p>设置<code class="codeph">FastStartFailoverThreshold</code>配置属性以指定在启动故障转移之前，观察者和目标备用数据库要等待的秒数（在检测到主数据库不可用之后）。有关更多信息和示例，请参阅<a href="using-data-guard-broker-to-manage-switchovers-failovers.html#GUID-D26D79F2-0093-4C0E-98CD-224A5C8CBFA4" title="您可以在连接到代理配置中的任何数据库时从任何站点启用快速启动故障转移。">启用快速启动故障转移</a> 。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">FastStartFailoverPmyShutdown</code></p>
                           <p><code class="codeph">FastStartFailoverPmyShutdown</code>配置属性控制是否在停止重做生成（ <code class="codeph">V$DATABASE</code> <code class="codeph">FS_FAILOVER_STATUS</code>列包含值<code class="codeph">STALLED</code> ）时主数据库是否将关闭，并且主数据库与观察者和目标备用数据库的连接丢失的时间超过了数量<code class="codeph">FastStartFailoverThreshold</code>配置属性指定的秒数。FastStartFailoverPmyShutdown的默认值为<code class="codeph">TRUE</code> 。</p>
                           <div class="infoboxnote" id="GUID-E4B19583-762C-4F07-A3B5-566A3481B254__GUID-F21DDBB9-F044-4EED-A8F3-E7D1D6DC3529">
                              <p class="notep1">注意：</p>
                              <p>如果检测到用户可配置的快速启动故障转移条件，或者应用程序通过调用<code class="codeph">DBMS_DG.INITIATE_FS_FAILOVER</code>函数启动了快速启动故障转移，则始终会关闭主数据库。
                              </p>
                           </div>
                        </li>
                        <li>
                           <p><code class="codeph">FastStartFailoverLagLimit</code></p>
                           <p></p>
                           <p>可以在以最高性能模式运行的数据库上配置快速启动故障转移功能。在<code class="codeph">ASYNC</code>模式下接收重做的目标将是可接受的快速启动故障转移目标备用数据库，并且这些目标可以在接收和应用的重做方面落后于主要目标。可以通过<code class="codeph">FastStartFailoverLagLimit</code>配置属性指定可配置的基于时间的限制。如果备用数据库的应用重做点位于主要重做生成点的这么多秒内，则允许快速启动故障转移。如果其应用点超出此限制，则不允许快速启动故障转移。
                           </p>
                           <p>如果在配置以最大可用性模式运行时启用快速启动故障转移，也可以使用<code class="codeph">FastStartFailoverLagLimit</code>配置属性。当配置在最大保护模式下运行时，不能使用它。当<code class="codeph">FastStartFailoverLagLimit</code>设置为非零值且配置在最大可用性模式下运行时，可能会出现零数据丢失故障转移或数据丢失故障转移。如果执行数据丢失故障转移，则数据丢失量不会超过<code class="codeph">FastStartFailoverLagLimit</code>配置属性指定的秒数。请注意，当为<code class="codeph">FastStartFailoverLagLimit</code>属性指定非零值且保护模式为最大可用性模式时，必须将目标备用数据库的重做传输模式设置为<code class="codeph">SYNC</code>或<code class="codeph">FASTSYNC</code>值。<code class="codeph">ASYNC</code>目标只是在最高性能模式下运行的配置中的有效快速启动故障转移目标。如果要将保护模式或重做传输模式更改为<code class="codeph">SYNC</code>或<code class="codeph">FASTSYNC</code> ，则必须先禁用快速启动故障转移。同样，将保护模式从最大可用性模式更改为最高性能模式将需要首先禁用快速启动故障转移并更改用于将重做发送到主备用数据库和目标备用数据库的重做传输模式到<code class="codeph">ASYNC</code> 。在快速启动故障转移到<code class="codeph">ASYNC</code>目标备用数据库之后，可以恢复旧的主数据库。如果观察者重新发现旧的主要，它将自动恢复旧的主要，并且在指定的延迟内生成的任何重做都将丢失。
                           </p>
                           <div class="infoboxnotealso" id="GUID-E4B19583-762C-4F07-A3B5-566A3481B254__GUID-7A88D3B9-D245-484A-A5A3-90F94526A716">
                              <p class="notep1">也可以看看：</p>
                              <p>有关更多信息，请<a href="oracle-data-guard-broker-properties.html#GUID-1966A317-DD75-4385-8A64-ADEC75662F7E" title="使用Oracle Data Guard代理属性来管理实例或整个配置。">参见Oracle Data Guard Broker属性</a></p>
                           </div>
                        </li>
                        <li>
                           <p><code class="codeph">FastStartFailoverAutoReinstate</code></p>
                           <p><code class="codeph">FastStartFailoverAutoReinstate</code>配置属性控制是否在发生快速启动故障转移时自动恢复以前的主数据库，因为主数据库崩溃或停止的时间超过<code class="codeph">FastStartFailoverThreshold</code>秒。<code class="codeph">FastStartFailoverAutoReinstate</code>的默认值为<code class="codeph">TRUE</code> 。</p>
                           <p>如果要在故障转移完成后执行诊断或修复工作，可以通过将<code class="codeph">FastStartFailoverAutoReinstate</code>配置属性设置为<code class="codeph">FALSE</code>来避免自动恢复。</p>
                           <div class="infoboxnote" id="GUID-E4B19583-762C-4F07-A3B5-566A3481B254__GUID-69505E1E-B3DE-459F-ADEB-C8CDB4AE1611">
                              <p class="notep1">注意：</p>
                              <p>如果由于检测到用户可配置的快速启动故障转移条件或者应用程序通过调用<code class="codeph">DBMS_DG.INITIATE_FS_FAILOVER</code>函数启动了快速启动故障转移，则在发生快速启动故障转移时，以前的主数据库永远不会自动恢复。
                              </p>
                           </div>
                        </li>
                        <li>
                           <p><code class="codeph">FastStartFailoverTarget</code></p>
                           <p><code class="codeph">FastStartFailoverTarget</code>配置属性指定当此数据库是主数据库时有资格成为快速启动故障转移目标的数据库的<code class="codeph">DB_UNIQUE_NAME</code>值。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">ObserverReconnect</code></p>
                           <p><code class="codeph">ObserverReconnect</code>配置属性指定观察者建立与主数据库的新连接的频率。当此属性设置为默认值0时，它会阻止观察者定期与主数据库建立新连接。虽然这消除了与定期建立与主数据库的新观察者连接相关联的处理开销，但它也阻止观察者检测到不可能创建到主数据库的新连接。Oracle建议将此属性设置为足够小的值，以便及时检测主数据库中的故障，但大到足以将与定期观察者连接相关的开销限制在可接受的级别。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">ObserverOverride</code></p>
                           <p><code class="codeph">ObserverOverride</code>配置属性设置为<code class="codeph">TRUE</code> ，允许在观察者失去与主服务器的连接时进行自动故障转移，即使备用服务器与主服务器具有健康的连接也是如此。
                           </p>
                        </li>
                     </ul>
                  </div>
               </div><a id="DGBKR3398"></a><div class="props_rev_3"><a id="GUID-BE851289-11B0-4B08-83C5-9A54AB14AD3B" name="GUID-BE851289-11B0-4B08-83C5-9A54AB14AD3B"></a><h4 id="DGBKR-GUID-BE851289-11B0-4B08-83C5-9A54AB14AD3B" class="sect4"><span class="enumeration_section">4.9.2</span>配置快速启动故障切换的条件</h4>
                  <div>
                     <p>默认情况下，在经过配置的时间阈值（ <code class="codeph">FastStartFailoverThreshold</code> ）后观察者和备用数据库都无法到达主数据库时，将完成快速启动故障转移。
                     </p>
                     <p>还有其他条件可能需要快速启动故障转移。</p>
                     <p>可配置条件分为两类：通过数据库运行状况检查机制检测到的类和通过Oracle服务器引发的错误检测到的类（如ORA错误）。发生指定条件时，观察者将启动快速启动故障转移，而不等待<code class="codeph">FastStartFailoverThreshold</code>到期，假设备用数据库处于有效状态以接受故障转移。
                     </p>
                     <p>可以单独启用或禁用每个条件。Oracle Data Guard配置在代理配置文件中保留所有用户指定的可配置快速启动故障转移条件。</p>
                     <p>假设备用数据库处于有效的快速启动故障转移状态（观察并同步或在滞后限制内），观察者将检测主数据库何时发出任何已启用的运行状况检查条件，并立即启动快速启动故障转移接受故障转移。</p>
                     <p>对于指定的Oracle ORA-Error条件，主数据库将通知观察者是否发出错误信号并且观察者将立即启动快速启动故障转移，假设备用数据库处于有效的快速启动故障转移状态（观察并同步或在滞后限制内）接受故障转移。</p>
                     <div class="infoboxnote" id="GUID-BE851289-11B0-4B08-83C5-9A54AB14AD3B__GUID-3740004F-D8A6-4265-B183-DF80CC33737F">
                        <p class="notep1">注意：</p>
                        <p>主数据库将关闭，观察者将不会尝试自动恢复以前的主数据库。</p>
                     </div>
                     <div class="infoboxnotealso" id="GUID-BE851289-11B0-4B08-83C5-9A54AB14AD3B__GUID-176E4AFF-1214-4144-9715-73589361658C">
                        <p class="notep1">也可以看看：</p>
                        <p></p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>Cloud Control在线帮助</p>
                           </li>
                           <li>
                              <p><a href="oracle-data-guard-broker-commands.html#GUID-B70D6C87-242B-4657-9C95-DFE750679671" title="ENABLE FAST_START FAILOVER CONDITION命令指定应执行快速启动故障转移的其他条件。">启用FAST_START故障转移条件</a> 
                              </p>
                           </li>
                           <li>
                              <p><a href="oracle-data-guard-broker-commands.html#GUID-CF212C5D-FCBD-4BB9-99A9-02774885C394" title="DISABLE FAST_START FAILOVER CONDITION命令允许您删除应执行快速启动故障转移的条件。">禁用FAST_START FAILOVER条件</a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="DGBKR3399"></a><div class="props_rev_3"><a id="GUID-D9E5FC78-657B-4C66-8EB7-D56880665861" name="GUID-D9E5FC78-657B-4C66-8EB7-D56880665861"></a><h4 id="DGBKR-GUID-D9E5FC78-657B-4C66-8EB7-D56880665861" class="sect4"><span class="enumeration_section">4.9.3</span>应用程序启动的快速启动故障转移</h4>
                  <div>
                     <p>您可以使用<code class="codeph">DBMS_DG</code> PL / SQL包来允许应用程序在遇到特定条件时指示快速启动故障转移。
                     </p>
                     <p>请参阅<span class="q">“ <a href="using-data-guard-broker-to-manage-switchovers-failovers.html#GUID-C98DB3F7-2894-4855-9BBD-E3593E59383C" title="您可以使用DBMS_DG PL / SQL程序包为特定应用程序自定义快速启动故障转移设置。">从应用程序指示快速启动故障转移</a> ”</span> 。
                     </p>
                  </div>
               </div>
            </div><a id="DGBKR3400"></a><div class="props_rev_3"><a id="GUID-0F7CA42F-1FE4-437E-9A2E-3FD3D2738BC1" name="GUID-0F7CA42F-1FE4-437E-9A2E-3FD3D2738BC1"></a><h3 id="DGBKR-GUID-0F7CA42F-1FE4-437E-9A2E-3FD3D2738BC1" class="sect3"><span class="enumeration_section">4.10</span>管理数据库转换</h3>
               <div>
                  <p>您可以使用DGMGRL <code class="codeph">CONVERT DATABASE</code>命令将物理备用数据库转换为快照备用数据库。
                  </p>
                  <p>快照备用数据库是完全可更新的备用数据库。</p>
                  <p>与物理或逻辑备用数据库一样，快照备用数据库从主数据库接收和归档重做数据。但是，与物理或逻辑备用数据库不同，快照备用数据库不应用它接收的重做数据。在首次丢弃对快照备用数据库进行的任何本地更新之后，快照备用数据库转换回物理备用数据库之前，不应用快照备用数据库接收的重做数据。</p>
                  <p>要将物理备用数据库转换为快照备用数据库，必须启用闪回数据库。以下示例显示如何将物理备用数据库转换为快照备用数据库：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; CONVERT DATABASE'South_Sales'来快照待机;</pre><p>准备好将快照转换回物理备用<code class="codeph">CONVERT DATABASE</code> ，请使用DGMGRL <code class="codeph">CONVERT DATABASE</code>命令，如下所示：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; CONVERT DATABASE'South_Sales'到物理待命;</pre></div>
            </div><a id="DGBKR325"></a><div class="props_rev_3"><a id="GUID-85D20060-248B-42A1-B78D-15C23AAA2F59" name="GUID-85D20060-248B-42A1-B78D-15C23AAA2F59"></a><h3 id="DGBKR-GUID-85D20060-248B-42A1-B78D-15C23AAA2F59" class="sect3"><span class="enumeration_section">4.11</span>数据库状态</h3>
               <div>
                  <p>通常，代理通过验证实际数据库状态和设置是否与代理配置文件中描述的相匹配来检查数据库的运行状况。</p>
                  <p>这是通过检查Oracle Data Guard配置的任何组件是否运行不正确（例如，重做传输服务是否有错误）以及检查是否正确设置了其他必需的数据库设置（例如，服务器参数文件）来完成的如果<code class="codeph">ARCHIVELOG</code>模式已打开，则可用。以下是代理在主数据库和备用数据库上检查的内容的详细列表。<a id="d7524e3904" class="indexterm-anchor"></a><a id="d7524e3908" class="indexterm-anchor"></a><a id="d7524e3912" class="indexterm-anchor"></a></p>
                  <p>在一个<a id="d7524e3918" class="indexterm-anchor"></a><a id="d7524e3922" class="indexterm-anchor"></a><a id="d7524e3926" class="indexterm-anchor"></a>主数据库，运行状况检查确定是否满足以下条件：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>数据库处于用户指定的状态，如代理配置文件中记录的那样</p>
                     </li>
                     <li>
                        <p>数据库处于正确的数据保护模式</p>
                     </li>
                     <li>
                        <p>数据库正在使用服务器参数文件</p>
                     </li>
                     <li>
                        <p>数据库处于<code class="codeph">ARCHIVELOG</code>模式</p>
                     </li>
                     <li>
                        <p>数据库防护已关闭</p>
                     </li>
                     <li>
                        <p>当配置中存在逻辑备用数据库时，将启用补充日志记录</p>
                     </li>
                     <li>
                        <p>重做传输服务没有任何错误</p>
                     </li>
                     <li>
                        <p>数据库设置与代理可配置属性指定的设置相匹配</p>
                     </li>
                     <li>
                        <p>重做传输设置与备用数据库的重做传输相关属性指定的设置相匹配</p>
                     </li>
                     <li>
                        <p>当前数据保护级别与配置的数据保护模式一致</p>
                     </li>
                     <li>
                        <p>主数据库能够解决所有备用数据库的所有空白</p>
                     </li>
                  </ul>
                  <p>在一个<a id="d7524e3970" class="indexterm-anchor"></a><a id="d7524e3974" class="indexterm-anchor"></a><a id="d7524e3978" class="indexterm-anchor"></a>在备用数据库中，运行状况检查确定是否满足以下条件：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>数据库处于用户指定的状态，如代理配置文件中记录的那样</p>
                     </li>
                     <li>
                        <p>数据库正在使用服务器参数文件</p>
                     </li>
                     <li>
                        <p>数据库设置与代理可配置属性指定的设置相匹配</p>
                     </li>
                     <li>
                        <p>当数据库是逻辑备用数据库时，将打开数据库保护</p>
                     </li>
                     <li>
                        <p>如果启用了快速启动故障切换，则主数据库和目标备用数据库将同步或在滞后限制内</p>
                     </li>
                  </ul>
               </div><a id="DGBKR3662"></a><div class="props_rev_3"><a id="GUID-F538BD81-9767-4844-BCCA-6B699026D572" name="GUID-F538BD81-9767-4844-BCCA-6B699026D572"></a><h4 id="DGBKR-GUID-F538BD81-9767-4844-BCCA-6B699026D572" class="sect4"><span class="enumeration_section">4.11.1</span>查询数据库状态</h4>
                  <div>
                     <p>某些可监视的属性可用于查询数据库状态。</p>
                     <p></p>
                     <p>可通过DGMGRL命令行界面直接访问以下属性：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">LogXptStatus</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">InconsistentLogXptProps</code></p>
                           <div class="infoboxnote" id="GUID-F538BD81-9767-4844-BCCA-6B699026D572__GUID-09E25029-FEEA-4717-98F0-1296297A88A5">
                              <p class="notep1">注意：</p>
                              <p>Cloud Control重新排列这些属性的值，以便在GUI中显示。</p>
                           </div>
                        </li>
                     </ul>
                     <p>您可以使用<code class="codeph">SHOW DATABASE &lt;db_unique_name&gt;</code>命令获取数据库的简要说明（名称，角色等），数据库状态以及有关任何运行状况检查问题的信息。例如，以下<code class="codeph">SHOW DATABASE</code>命令的输出显示两个问题：一些重做传输服务错误和一个不一致的重做传输相关属性</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; SHOW DATABASE'North_Sales';数据库 -  North_Sales角色：PRIMARY预期状态：TRANSPORT-OFF实例：north_sales1错误：ORA-16737：备用数据库“South_Sales”的重做传输服务有错误north_sales2错误：ORA-16737：备用重做传输服务数据库“South_Sales”有一个错误警告：ORA-16715：重做传输相关属性备用“South_Sales”的ReopenSecs不一致数据库状态：错误</pre><p>要进一步检查有关数据库状态的详细信息，可以使用以下可监视属性：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">LogXptStatus</code> - 列出在主数据库的所有实例上检测到的所有日志传输错误。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">InconsistentLogXptProps</code> - 列出在代理配置文件和重做传输设置之间具有不一致值的备用数据库的所有与重做传输相关的属性。
                           </p>
                        </li>
                     </ul>
                     <p>发出以下<code class="codeph">SHOW DATABASE</code>命令以获取有关问题的更多详细信息。
                     </p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; SHOW DATABASE'North_Sales''LogXptStatus';日志传输状态PRIMARY_INSTANCE_NAME STANDBY_DATABASE_NAME状态north_sales1 South_Sales ORA-12541：TNS：没有侦听器north_sales2 South_Sales ORA-12541：TNS：没有侦听器DGMGRL&gt; SHOW DATABASE'North_Sales''InconsistentLogXptProps';不一致的日志传输属性INSTANCE_NAME STANDBY_NAME PROPERTY_NAME MEMORY_VALUE BROKER_VALUE north_sales2 South_Sales ReopenSecs 600 300</pre><div class="infoboxnotealso" id="GUID-F538BD81-9767-4844-BCCA-6B699026D572__GUID-DA6A1887-03F8-4B49-9F69-86E2FB7BE9F5">
                        <p class="notep1">也可以看看：</p>
                        <p>有关数据库属性的详细信息，请参阅<a href="oracle-data-guard-broker-properties.html#GUID-1966A317-DD75-4385-8A64-ADEC75662F7E" title="使用Oracle Data Guard代理属性来管理实例或整个配置。">Oracle Data Guard Broker属性</a></p>
                     </div>
                  </div>
               </div><a id="DGBKR3855"></a><div class="props_rev_3"><a id="GUID-055762DD-33BC-426D-AA35-7217B8A77D0E" name="GUID-055762DD-33BC-426D-AA35-7217B8A77D0E"></a><h4 id="DGBKR-GUID-055762DD-33BC-426D-AA35-7217B8A77D0E" class="sect4"><span class="enumeration_section">4.11.2</span>在角色更改之前验证数据库</h4>
                  <div>
                     <p>您可以使用<code class="codeph">VALIDATE</code> <code class="codeph">DATABASE</code>命令在执行角色更改之前执行一整套数据库检查。
                     </p>
                     <p>该命令检查以下项目：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>是否在备用数据库上缺少重做数据</p>
                        </li>
                        <li>
                           <p>是否启用闪回</p>
                        </li>
                        <li>
                           <p>配置的临时表空间文件数</p>
                        </li>
                        <li>
                           <p>是否正在进行在线数据文件移动</p>
                        </li>
                        <li>
                           <p>是否为物理备用数据库清除联机重做日志</p>
                        </li>
                        <li>
                           <p>是否为主数据库清除备用重做日志</p>
                        </li>
                        <li>
                           <p>在线日志文件配置</p>
                        </li>
                        <li>
                           <p>备用日志文件配置</p>
                        </li>
                        <li>
                           <p>与应用相关的属性设置</p>
                        </li>
                        <li>
                           <p>与运输相关的财产设置</p>
                        </li>
                        <li>
                           <p>自动诊断存储库中是否存在任何错误（例如，控制文件损坏，系统数据文件问题，用户数据文件问题）</p>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-055762DD-33BC-426D-AA35-7217B8A77D0E__GUID-BA2E10DA-2B05-49CE-BEED-4B82E25EDA36">
                        <p class="notep1">也可以看看：</p>
                        <p></p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="q">“ <a href="oracle-data-guard-broker-commands.html#GUID-06ED8F7F-4547-4D4D-9D1A-4A84FF234A12" title="VALIDATE DATABASE命令在角色更改之前执行一组全面的数据库检查。">VALIDATE DATABASE</a> ”</span>用于命令的描述以及显示各种方案的命令输出的示例</p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-DA0698C3-FC1F-4B81-93B6-A6C330F02F9C" name="GUID-DA0698C3-FC1F-4B81-93B6-A6C330F02F9C"></a><h4 id="DGBKR-GUID-DA0698C3-FC1F-4B81-93B6-A6C330F02F9C" class="sect4"><span class="enumeration_section">4.11.3</span>在角色更改之前验证服务器参数文件</h4>
                  <div>
                     <p>使用<code class="codeph">VALIDATE DATABASE SPFILE</code>命令比较主数据库和备用数据库之间的服务器参数文件（SPFILE）的内容。
                     </p>
                     <div class="p">通过比较主数据库和备用数据库，可以确定数据库的SPFILE中是否存在任何缺少的参数，或者条目是否包含不同的值。
                        <div class="infoboxnotealso" id="GUID-DA0698C3-FC1F-4B81-93B6-A6C330F02F9C__GUID-A8E7BF98-E494-4B9A-A718-A75A9BF20423">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><a href="oracle-data-guard-broker-commands.html#GUID-D8A6F0CF-959E-490D-9384-B746821836B4" title="VALIDATE DATABASE SPFILE命令执行主数据库与指定备用数据库之间的服务器参数文件（SPFILE）条目的比较。">VALIDATE DATABASE SPFILE</a>以获取命令的描述以及显示命令输出的示例</p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-98AF0DE7-0D50-4F78-9625-563EBF430BD8" name="GUID-98AF0DE7-0D50-4F78-9625-563EBF430BD8"></a><h4 id="DGBKR-GUID-98AF0DE7-0D50-4F78-9625-563EBF430BD8" class="sect4"><span class="enumeration_section">4.11.4</span>在角色更改之前验证网络配置</h4>
                  <div>
                     <p>使用<code class="codeph">VALIDATE NETWORK CONFIGURATION</code>命令在<code class="codeph">VALIDATE NETWORK CONFIGURATION</code>成员之间执行网络连接检查。
                     </p>
                     <p>执行网络连接检查可在尝试更改角色之前识别潜在的网络配置问题。</p>
                     <div class="infoboxnotealso" id="GUID-98AF0DE7-0D50-4F78-9625-563EBF430BD8__GUID-9ABFA0A7-8E9F-4096-87E5-F2700661B7EA">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="managing-oracle-data-guard-broker-configuration-members.html#GUID-98AF0DE7-0D50-4F78-9625-563EBF430BD8" title="使用VALIDATE NETWORK CONFIGURATION命令在配置成员之间执行网络连接检查。">在角色更改之前验证网络配置</a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-75625C54-0312-46AD-A366-63FE146A03A7" name="GUID-75625C54-0312-46AD-A366-63FE146A03A7"></a><h4 id="DGBKR-GUID-75625C54-0312-46AD-A366-63FE146A03A7" class="sect4"><span class="enumeration_section">4.11.5</span>在角色更改之前验证静态连接标识符</h4>
                  <div>
                     <p>未配置Oracle Restart的单实例数据库必须具有向侦听器注册的静态服务，以便DGMGRL CLI可以在必要时自动启动实例（例如，切换后的新备用数据库）。</p>
                     <p>代理为使用该静态服务的<code class="codeph">StaticConnectIdentifier</code>属性设置默认值（假设<code class="codeph"><span class="codeinlineitalic">db_unique_name</span> _DGMGRL</code>的默认值用于静态服务名称）。此连接标识符用于重新启动。
                     </p>
                     <p>使用<code class="codeph">VALIDATE STATIC CONNECT IDENTIFIER</code>命令确认可以使用<code class="codeph">StaticConnectIdentifier</code>属性指定的连接标识符来重新启动实例。该命令不会重新启动数据库，而是检查连接标识符中指定的服务是否已向侦听器注册。
                     </p>
                     <div class="infoboxnotealso" id="GUID-75625C54-0312-46AD-A366-63FE146A03A7__GUID-946FCDB1-2FDC-4005-89B2-5BEF08F1F47F">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="oracle-data-guard-broker-commands.html#GUID-C3E2884B-E0A7-492A-9A42-EEB4D6CCCBE6" title="VALIDATE STATIC CONNECT IDENTIFIER命令验证数据库的静态连接标识符。">VALIDATE STATIC CONNECT IDENTIFIER</a>用于命令的描述和显示命令输出的示例</p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>