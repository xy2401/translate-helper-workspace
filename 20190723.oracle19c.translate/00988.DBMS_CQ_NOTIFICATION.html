<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="The DBMS_CQ_NOTIFICATION package is part of the database change notification feature that provides the functionality to create registration on queries designated by a client application and so to receive notifications in response to DML or DDL changes on the objects associated with the queries. The notifications are published by the database when the DML or DDL transaction commits."></meta>
      <meta name="description" content="The DBMS_CQ_NOTIFICATION package is part of the database change notification feature that provides the functionality to create registration on queries designated by a client application and so to receive notifications in response to DML or DDL changes on the objects associated with the queries. The notifications are published by the database when the DML or DDL transaction commits."></meta>
      <title>DBMS_CQ_NOTIFICATION</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="PL/SQL Packages and Types Reference"></meta>
      <meta property="og:description" content="The DBMS_CQ_NOTIFICATION package is part of the database change notification feature that provides the functionality to create registration on queries designated by a client application and so to receive notifications in response to DML or DDL changes on the objects associated with the queries. The notifications are published by the database when the DML or DDL transaction commits."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="PL/SQL Packages and Types Reference"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="database-pl-sql-packages-and-types-reference.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-03-25T11:24:34-07:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96430-03"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="DBMS_CONNECTION_POOL.html" title="Previous" type="text/html"></link>
      <link rel="next" href="DBMS_CREDENTIAL.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database PL/SQL Packages and Types Reference"></meta>
    <meta name="dcterms.isVersionOf" content="ARPLS"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="DBMS_CONNECTION_POOL.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="DBMS_CREDENTIAL.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">PL / SQL包和类型参考</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">DBMS_CQ_NOTIFICATION</li>
            </ol>
            <a id="GUID-02733C2D-4C40-4558-9988-3486DF0FA268" name="GUID-02733C2D-4C40-4558-9988-3486DF0FA268"></a><a id="ARPLS201"></a><a id="ARPLS201"></a>
            
            <h2 id="ARPLS-GUID-02733C2D-4C40-4558-9988-3486DF0FA268" class="sect2"><span class="enumeration_chapter">37</span> DBMS_CQ_NOTIFICATION</h2>
         </header>
         <div class="ind">
            <div>
               <p><code class="codeph">The DBMS_CQ_NOTIFICATION</code>包是数据库更改通知功能的一部分，该功能提供了对客户端应用程序指定的查询创建注册的功能，以便接收通知以响应与查询关联的对象的DML或DDL更改。当DML或DDL事务提交时，通知由数据库发布。
               </p>
               <div class="infoboxnotealso" id="GUID-02733C2D-4C40-4558-9988-3486DF0FA268__GUID-6ADCF549-5D34-470A-9F71-64C0894BA83E">
                  <p class="notep1">也可以看看：</p>
                  <p>有关实施数据库更改通知的<a href="../adfns/cqn.html#ADFNS018" target="_blank"><span class="italic">Oracle数据库开发指南</span></a>
                  </p>
               </div>
               <p>本章包含以下主题：<a id="d186645e95" class="indexterm-anchor"></a></p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="DBMS_CQ_NOTIFICATION.html#GUID-181A77A5-BCA3-4050-B31E-9AC092294CF3" title="DBMS_CQ_NOTIFICATION包提供基于PL / SQL的注册接口。客户端可以使用此接口基于感兴趣的对象在查询上创建注册，并指定PL / SQL回调处理程序以接收通知。在对象级别注册的情况下，当事务更改与已注册查询和| COMMIT | s关联的任何对象时，将调用在注册这些对象期间指定的PL / SQL回调。应用程序可以在其PL / SQL回调处理程序的实现中定义特定于客户端的处理。">概观</a></p>
                  </li>
                  <li>
                     <p><a href="DBMS_CQ_NOTIFICATION.html#GUID-299A450B-5DF0-48B6-9795-C5E3913716B9" title="DBMS_CQ_NOTIFICATION包要求用户具有CHANGE NOTIFICATION系统特权才能接收通知，并被授予DBMS_CQ_NOTIFICATION包的EXECUTE特权。">安全模型</a></p>
                  </li>
                  <li>
                     <p><a href="DBMS_CQ_NOTIFICATION.html#GUID-766AE3C6-D1ED-4B7E-B346-82EC6C8C77ED" title="DBMS_CQ_NOTIFICATION常量在注册期间或在通知期间接收时用作标志参数。">常量</a></p>
                  </li>
                  <li>
                     <p><a href="DBMS_CQ_NOTIFICATION.html#GUID-359BFA35-64EF-477D-B98D-96E5373888E6" title="以下是DBMS_CQ_NOTIFICATION操作说明。">操作说明</a></p>
                  </li>
                  <li>
                     <p><a href="DBMS_CQ_NOTIFICATION.html#GUID-A252A88A-6B2D-49F9-8CB8-4F790F2B2534" title="假设中间层应用程序在HR.EMPLOYEES表上有很多查询。如果不经常更新EMPLOYEES表，则可以通过缓存表中的行来获得更好的性能，因为这样可以避免后端数据库服务器的往返和服务器端执行延迟。我们假设应用程序已实现了一个中间层HTTP侦听器，该侦听器侦听通知并更新中间层缓存以响应通知。">例子</a></p>
                  </li>
                  <li>
                     <p><a href="DBMS_CQ_NOTIFICATION.html#GUID-542B69EF-9E64-4E9B-A15F-C69BE5747622" title="DBMS_CQ_NOTIFICATION包定义了几种OBJECT类型。">数据结构</a></p>
                  </li>
                  <li>
                     <p><a href="DBMS_CQ_NOTIFICATION.html#GUID-5F2171F0-D166-4BE2-B2D0-F5C370979FBC" title="该表列出了DBMS_CQ_NOTIFICATION子程序并简要描述了它们。">DBMS_CQ_NOTIFICATION子程序摘要</a></p>
                  </li>
               </ul>
            </div><a id="ARPLS65635"></a><a id="ARPLS65636"></a><a id="ARPLS65636"></a><a id="ARPLS65635"></a><div class="props_rev_3"><a id="GUID-181A77A5-BCA3-4050-B31E-9AC092294CF3" name="GUID-181A77A5-BCA3-4050-B31E-9AC092294CF3"></a><h3 id="ARPLS-GUID-181A77A5-BCA3-4050-B31E-9AC092294CF3" class="sect3"><span class="enumeration_section">37.1</span> DBMS_CQ_NOTIFICATION概述</h3>
               <div>
                  <p><code class="codeph">The DBMS_CQ_NOTIFICATION</code>包提供基于PL / SQL的注册接口。客户端可以使用此接口基于感兴趣的对象在查询上创建注册，并指定PL / SQL回调处理程序以接收通知。在对象级别注册的情况下，当事务更改与已注册查询和| COMMIT | s关联的任何对象时，将调用在注册这些对象期间指定的PL / SQL回调。应用程序可以在其PL / SQL回调处理程序的实现中定义特定于客户端的处理。
                  </p>
                  <div class="section">
                     <p>该界面允许您定义注册块（使用类似于<code class="codeph">BEGIN-END</code>块的机制）。可以在BEGIN阶段指定通知的接收者，即PL / SQL回调处理程序的名称和一些其他注册属性（如超时）。随后执行的任何查询（在注册块内）被认为是“有趣的查询”，并且在查询执行期间由这些查询引用的对象被注册。注册是通过<code class="codeph">END</code>注册块完成的。通过注册块，您可以创建新注册或向现有注册添加对象。
                     </p>
                     <p>通过PL / SQL接口创建注册时，RDBMS会为注册分配唯一的注册ID。客户端应用程序可以使用注册ID来跟踪它创建的注册。当RDBMS发布通知时，注册ID将成为通知的一部分。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-181A77A5-BCA3-4050-B31E-9AC092294CF3__GUID-550C89A9-A1C4-45DB-BEB9-54B457945773">典型应用</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>例如，此功能对于在中间层中的大多数只读对象上缓存查询结果集的应用程序非常有用，以避免网络往返数据库。这样的应用程序可以在对缓存感兴趣的查询上创建注册。在对这些查询中引用的对象的更改时，数据库会在基础事务提交时发布通知。响应该通知，中间层应用程序可以通过重新执行查询/查询来刷新其缓存。</p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="ARPLS65637"></a><a id="ARPLS65637"></a><div class="props_rev_3"><a id="GUID-299A450B-5DF0-48B6-9795-C5E3913716B9" name="GUID-299A450B-5DF0-48B6-9795-C5E3913716B9"></a><h3 id="ARPLS-GUID-299A450B-5DF0-48B6-9795-C5E3913716B9" class="sect3"><span class="enumeration_section">37.2</span> DBMS_CQ_NOTIFICATION安全模型</h3>
               <div>
                  <p><code class="codeph">The DBMS_CQ_NOTIFICATION</code>包要求用户具有<code class="codeph">CHANGE</code> <code class="codeph">NOTIFICATION</code>系统特权才能接收通知，并被授予<code class="codeph">DBMS_CQ_NOTIFICATION</code>包的<code class="codeph">EXECUTE</code>特权。
                  </p>
                  <div class="section">
                     <p>此外，要求用户对要注册的所有对象具有<code class="codeph">SELECT</code>或<code class="codeph">READ</code>权限。请注意，如果对象的<code class="codeph">SELECT</code>或<code class="codeph">READ</code>权限在创建注册时被授予但随后丢失（由于撤销），则将清除注册并发布有关该效果的通知。
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="ARPLS65638"></a><a id="ARPLS65639"></a><a id="ARPLS65639"></a><a id="ARPLS65638"></a><div class="props_rev_3"><a id="GUID-766AE3C6-D1ED-4B7E-B346-82EC6C8C77ED" name="GUID-766AE3C6-D1ED-4B7E-B346-82EC6C8C77ED"></a><h3 id="ARPLS-GUID-766AE3C6-D1ED-4B7E-B346-82EC6C8C77ED" class="sect3"><span class="enumeration_section">37.3</span> DBMS_CQ_NOTIFICATION常量</h3>
               <div>
                  <p>DBMS_CQ_NOTIFICATION常量在注册期间或在通知期间接收时用作标志参数。</p>
                  <div class="section">
                     <p><code class="codeph">DBMS_CQ_NOTIFICATION</code>包有一组常量：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">EVENT_STARTUP</code> ， <code class="codeph">EVENT_SHUTDOWN</code> ， <code class="codeph">EVENT_SHUTDOWN_ANY</code> ， <code class="codeph">EVENT_DEREG</code>描述数据库发布的通知的类型。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">INSERTOP</code> ， <code class="codeph">DELETEOP</code> ， <code class="codeph">UPDATEOP</code> ， <code class="codeph">ALTEROP</code> ， <code class="codeph">DROPOP</code>和<code class="codeph">UNKNOWNOP</code>描述了表上的操作类型（在数据库发布的通知期间）。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">QOS_RELIABLE</code> ， <code class="codeph">QOS_DEREG_NFY</code> ， <code class="codeph">QOS_ROWIDs</code>描述了客户端所需的注册服务质量属性。这些是在注册期间指定的。
                           </p>
                        </li>
                     </ul>
                     <p>常量如下表所示。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="tblformal" id="GUID-766AE3C6-D1ED-4B7E-B346-82EC6C8C77ED__CIHHIGIG">
                     <p class="titleintable">表37-1 DBMS_CQ_NOTIFICATION常量</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="DBMS_CQ_NOTIFICATION常量" width="100%" border="1" summary="This table describes the Constants used by DBMS_CQ_NOTIFICATION subprograms." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="27%" id="d186645e565">名称</th>
                              <th align="left" valign="bottom" width="22%" id="d186645e568">类型</th>
                              <th align="left" valign="bottom" width="8%" id="d186645e571">值</th>
                              <th align="left" valign="bottom" width="43%" id="d186645e574">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="27%" id="d186645e579" headers="d186645e565 ">
                                 <p><code class="codeph">ALL_OPERATIONS</code></p>
                              </td>
                              <td align="left" valign="top" width="22%" headers="d186645e579 d186645e568 ">
                                 <p><code class="codeph">BINARY_INTEGER</code></p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d186645e579 d186645e571 ">
                                 <p><code class="codeph">0</code></p>
                              </td>
                              <td align="left" valign="top" width="43%" headers="d186645e579 d186645e574 ">
                                 <p>有兴趣收到所有操作的通知，在注册期间指定为参数</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="27%" id="d186645e595" headers="d186645e565 ">
                                 <p><code class="codeph">ALL_ROWS</code></p>
                              </td>
                              <td align="left" valign="top" width="22%" headers="d186645e595 d186645e568 ">
                                 <p><code class="codeph">BINARY_INTEGER</code></p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d186645e595 d186645e571 ">
                                 <p><code class="codeph">1</code></p>
                              </td>
                              <td align="left" valign="top" width="43%" headers="d186645e595 d186645e574 ">
                                 <p>表中的所有行都可能已被修改</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="27%" id="d186645e611" headers="d186645e565 ">
                                 <p><code class="codeph">EVENT_STARTUP</code></p>
                              </td>
                              <td align="left" valign="top" width="22%" headers="d186645e611 d186645e568 ">
                                 <p><code class="codeph">BINARY_INTEGER</code></p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d186645e611 d186645e571 ">
                                 <p><code class="codeph">1</code></p>
                              </td>
                              <td align="left" valign="top" width="43%" headers="d186645e611 d186645e574 ">
                                 <p>实例启动通知</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="27%" id="d186645e627" headers="d186645e565 ">
                                 <p><code class="codeph">EVENT_SHUTDOWN</code></p>
                              </td>
                              <td align="left" valign="top" width="22%" headers="d186645e627 d186645e568 ">
                                 <p><code class="codeph">BINARY_INTEGER</code></p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d186645e627 d186645e571 ">
                                 <p><code class="codeph">2</code></p>
                              </td>
                              <td align="left" valign="top" width="43%" headers="d186645e627 d186645e574 ">
                                 <p>实例关闭通知</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="27%" id="d186645e643" headers="d186645e565 ">
                                 <p><code class="codeph">EVENT_SHUTDOWN_ANY</code></p>
                              </td>
                              <td align="left" valign="top" width="22%" headers="d186645e643 d186645e568 ">
                                 <p><code class="codeph">BINARY_INTEGER</code></p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d186645e643 d186645e571 ">
                                 <p><code class="codeph">3</code></p>
                              </td>
                              <td align="left" valign="top" width="43%" headers="d186645e643 d186645e574 ">
                                 <p>运行Oracle Real Application Clusters（Oracle RAC）时关闭的任何实例</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="27%" id="d186645e659" headers="d186645e565 ">
                                 <p><code class="codeph">EVENT_DEREG</code></p>
                              </td>
                              <td align="left" valign="top" width="22%" headers="d186645e659 d186645e568 ">
                                 <p><code class="codeph">BINARY_INTEGER</code></p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d186645e659 d186645e571 ">
                                 <p><code class="codeph">五</code></p>
                              </td>
                              <td align="left" valign="top" width="43%" headers="d186645e659 d186645e574 ">
                                 <p>注册已被删除</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="27%" id="d186645e675" headers="d186645e565 ">
                                 <p><code class="codeph">EVENT_OBJCHANGE</code></p>
                              </td>
                              <td align="left" valign="top" width="22%" headers="d186645e675 d186645e568 ">
                                 <p><code class="codeph">BINARY_INTEGER</code></p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d186645e675 d186645e571 ">
                                 <p><code class="codeph">6</code></p>
                              </td>
                              <td align="left" valign="top" width="43%" headers="d186645e675 d186645e574 ">
                                 <p>对象更改通知</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="27%" id="d186645e691" headers="d186645e565 ">
                                 <p><code class="codeph">EVENT_QUERYCHANGE</code></p>
                              </td>
                              <td align="left" valign="top" width="22%" headers="d186645e691 d186645e568 ">
                                 <p><code class="codeph">BINARY_INTEGER</code></p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d186645e691 d186645e571 ">
                                 <p><code class="codeph">7</code></p>
                              </td>
                              <td align="left" valign="top" width="43%" headers="d186645e691 d186645e574 ">
                                 <p>查询结果集更改通知</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="27%" id="d186645e707" headers="d186645e565 ">
                                 <p><code class="codeph">INSERTOP</code></p>
                              </td>
                              <td align="left" valign="top" width="22%" headers="d186645e707 d186645e568 ">
                                 <p><code class="codeph">BINARY_INTEGER</code></p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d186645e707 d186645e571 ">
                                 <p><code class="codeph">2</code></p>
                              </td>
                              <td align="left" valign="top" width="43%" headers="d186645e707 d186645e574 ">
                                 <p>插入操作</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="27%" id="d186645e723" headers="d186645e565 ">
                                 <p><code class="codeph">UPDATEOP</code></p>
                              </td>
                              <td align="left" valign="top" width="22%" headers="d186645e723 d186645e568 ">
                                 <p><code class="codeph">BINARY_INTEGER</code></p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d186645e723 d186645e571 ">
                                 <p><code class="codeph">4</code></p>
                              </td>
                              <td align="left" valign="top" width="43%" headers="d186645e723 d186645e574 ">
                                 <p>更新操作</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="27%" id="d186645e739" headers="d186645e565 ">
                                 <p><code class="codeph">DELETEOP</code></p>
                              </td>
                              <td align="left" valign="top" width="22%" headers="d186645e739 d186645e568 ">
                                 <p><code class="codeph">BINARY_INTEGER</code></p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d186645e739 d186645e571 ">
                                 <p><code class="codeph">8</code></p>
                              </td>
                              <td align="left" valign="top" width="43%" headers="d186645e739 d186645e574 ">
                                 <p>删除操作</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="27%" id="d186645e756" headers="d186645e565 ">
                                 <p><code class="codeph">ALTEROP</code></p>
                              </td>
                              <td align="left" valign="top" width="22%" headers="d186645e756 d186645e568 ">
                                 <p><code class="codeph">BINARY_INTEGER</code></p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d186645e756 d186645e571 ">
                                 <p><code class="codeph">16</code></p>
                              </td>
                              <td align="left" valign="top" width="43%" headers="d186645e756 d186645e574 ">
                                 <p>表改变了</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="27%" id="d186645e772" headers="d186645e565 ">
                                 <p><code class="codeph">DROPOP</code></p>
                              </td>
                              <td align="left" valign="top" width="22%" headers="d186645e772 d186645e568 ">
                                 <p><code class="codeph">BINARY_INTEGER</code></p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d186645e772 d186645e571 ">
                                 <p><code class="codeph">32</code></p>
                              </td>
                              <td align="left" valign="top" width="43%" headers="d186645e772 d186645e574 ">
                                 <p>表丢了</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="27%" id="d186645e788" headers="d186645e565 ">
                                 <p><code class="codeph">UNKNOWNOP</code></p>
                              </td>
                              <td align="left" valign="top" width="22%" headers="d186645e788 d186645e568 ">
                                 <p><code class="codeph">BINARY_INTEGER</code></p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d186645e788 d186645e571 ">
                                 <p><code class="codeph">64</code></p>
                              </td>
                              <td align="left" valign="top" width="43%" headers="d186645e788 d186645e574 ">
                                 <p>未知的操作</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="27%" id="d186645e804" headers="d186645e565 ">
                                 <p><code class="codeph">QOS_RELIABLE</code></p>
                              </td>
                              <td align="left" valign="top" width="22%" headers="d186645e804 d186645e568 ">
                                 <p><code class="codeph">BINARY_INTEGER</code></p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d186645e804 d186645e571 ">
                                 <p><code class="codeph">1</code></p>
                              </td>
                              <td align="left" valign="top" width="43%" headers="d186645e804 d186645e574 ">
                                 <p>可靠或持久的通知。还意味着通知将通过提交事务以原子方式插入到持久存储中，从而导致对象发生更改。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="27%" id="d186645e820" headers="d186645e565 ">
                                 <p><code class="codeph">QOS_DEREG_NFY</code></p>
                              </td>
                              <td align="left" valign="top" width="22%" headers="d186645e820 d186645e568 ">
                                 <p><code class="codeph">BINARY_INTEGER</code></p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d186645e820 d186645e571 ">
                                 <p><code class="codeph">2</code></p>
                              </td>
                              <td align="left" valign="top" width="43%" headers="d186645e820 d186645e574 ">
                                 <p>首次通知时清除注册</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="27%" id="d186645e836" headers="d186645e565 ">
                                 <p><code class="codeph">QOS_ROWIDS</code></p>
                              </td>
                              <td align="left" valign="top" width="22%" headers="d186645e836 d186645e568 ">
                                 <p><code class="codeph">BINARY_INTEGER</code></p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d186645e836 d186645e571 ">
                                 <p><code class="codeph">4</code></p>
                              </td>
                              <td align="left" valign="top" width="43%" headers="d186645e836 d186645e574 ">
                                 <p>需要已修改行的rowid</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="27%" id="d186645e852" headers="d186645e565 ">
                                 <p><code class="codeph">QOS_QUERY</code></p>
                              </td>
                              <td align="left" valign="top" width="22%" headers="d186645e852 d186645e568 ">
                                 <p><code class="codeph">BINARY_INTEGER</code></p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d186645e852 d186645e571 ">
                                 <p><code class="codeph">8</code></p>
                              </td>
                              <td align="left" valign="top" width="43%" headers="d186645e852 d186645e574 ">
                                 <p>以查询粒度注册</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="27%" id="d186645e868" headers="d186645e565 ">
                                 <p><code class="codeph">QOS_BEST_EFFORT</code></p>
                              </td>
                              <td align="left" valign="top" width="22%" headers="d186645e868 d186645e568 ">
                                 <p><code class="codeph">BINARY_INTEGER</code></p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d186645e868 d186645e571 ">
                                 <p><code class="codeph">16</code></p>
                              </td>
                              <td align="left" valign="top" width="43%" headers="d186645e868 d186645e574 ">
                                 <p>尽力评估</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="27%" id="d186645e884" headers="d186645e565 ">
                                 <p><code class="codeph">NTFN_GROUPING_CLASS_TIME</code></p>
                              </td>
                              <td align="left" valign="top" width="22%" headers="d186645e884 d186645e568 ">
                                 <p><code class="codeph">BINARY_INTEGER</code></p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d186645e884 d186645e571 ">
                                 <p><code class="codeph">1</code></p>
                              </td>
                              <td align="left" valign="top" width="43%" headers="d186645e884 d186645e574 ">
                                 <p>按时间分组通知</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="27%" id="d186645e900" headers="d186645e565 ">
                                 <p><code class="codeph">NTFN_GROUPING_TYPE_SUMMARY</code></p>
                              </td>
                              <td align="left" valign="top" width="22%" headers="d186645e900 d186645e568 ">
                                 <p><code class="codeph">BINARY_INTEGER</code></p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d186645e900 d186645e571 ">
                                 <p><code class="codeph">1</code></p>
                              </td>
                              <td align="left" valign="top" width="43%" headers="d186645e900 d186645e574 ">
                                 <p>通知摘要分组</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="27%" id="d186645e916" headers="d186645e565 ">
                                 <p><code class="codeph">NTFN_GROUPING_TYPE_LAST</code></p>
                              </td>
                              <td align="left" valign="top" width="22%" headers="d186645e916 d186645e568 ">
                                 <p><code class="codeph">BINARY_INTEGER</code></p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d186645e916 d186645e571 ">
                                 <p><code class="codeph">2</code></p>
                              </td>
                              <td align="left" valign="top" width="43%" headers="d186645e916 d186645e574 ">
                                 <p>组中的最后通知</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="27%" id="d186645e933" headers="d186645e565 ">
                                 <p><code class="codeph">NTFN_GROUPING_FOREVER</code></p>
                              </td>
                              <td align="left" valign="top" width="22%" headers="d186645e933 d186645e568 ">
                                 <p><code class="codeph">BINARY_INTEGER</code></p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d186645e933 d186645e571 ">
                                 <p><code class="codeph">-1</code></p>
                              </td>
                              <td align="left" valign="top" width="43%" headers="d186645e933 d186645e574 ">
                                 <p>永远重复通知</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
               </div>
            </div><a id="ARPLS65640"></a><a id="ARPLS65641"></a><a id="ARPLS65641"></a><a id="ARPLS65640"></a><div class="props_rev_3"><a id="GUID-359BFA35-64EF-477D-B98D-96E5373888E6" name="GUID-359BFA35-64EF-477D-B98D-96E5373888E6"></a><h3 id="ARPLS-GUID-359BFA35-64EF-477D-B98D-96E5373888E6" class="sect3"><span class="enumeration_section">37.4</span> DBMS_CQ_NOTIFICATION操作说明</h3>
               <div>
                  <p>以下是DBMS_CQ_NOTIFICATION操作说明。</p>
                  <div class="section">
                     <p class="subhead2" id="GUID-359BFA35-64EF-477D-B98D-96E5373888E6__GUID-00698BF2-D839-4F0C-8115-E0D18EA32480">对象级注册</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>当事务更改已注册的对象和<code class="codeph">COMMIT</code>时，数据库将发布通知。
                           </p>
                        </li>
                        <li>
                           <p>从上一个<code class="codeph">NEW_REG_START</code>或<code class="codeph">ENABLE_REG</code>到<code class="codeph">REG_END</code>开始在注册块内执行的查询中引用的所有对象都被视为有趣的对象并添加到注册中。
                           </p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-359BFA35-64EF-477D-B98D-96E5373888E6__GUID-F17C53B8-36CA-43B5-AF02-930776C0636B">查询结果更改注册</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>当事务更改已注册查询和<code class="codeph">COMMIT</code>的结果集时，数据库将发布通知。
                           </p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-359BFA35-64EF-477D-B98D-96E5373888E6__GUID-ECFDD301-D261-465C-B30F-F1C733C6B380">故障排除</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>如果您已创建注册，并且在更改基础表时似乎没有收到通知，请检查以下内容。</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">job_queue_processes</code>参数是否设置为非零值？需要将此参数配置为非零值，以便通过处理程序接收PL / SQL通知。
                           </p>
                        </li>
                        <li>
                           <p>注册是否作为非<code class="codeph">SYS</code>用户创建？
                           </p>
                        </li>
                        <li>
                           <p>如果你正在尝试注册对象上DML变化，你<code class="codeph">COMMIT</code>荷兰国际集团的交易？请注意，通知是事务性的，并且将在事务<code class="codeph">COMMIT</code>时生成。
                           </p>
                        </li>
                        <li>
                           <p>由于实现错误，在执行PL / SQL回调期间可能存在运行时错误。如果是这样，它们将被记录到尝试执行该过程的<code class="codeph">JOBQ</code>进程的跟踪文件中。跟踪文件通常命名为&lt; <code class="codeph">ORACLE_SID</code> &gt; <code class="codeph">_j*_</code> &lt; <code class="codeph">PID</code> &gt;。 <code class="codeph">trc</code> 。“</p>
                           <p>例如，如果ORACLE_SID为“dbs1”且进程为12483，则跟踪文件可能命名为“ <code class="codeph">dbs1_j000_12483</code> 。 <code class="codeph">trc</code> 。
                           </p>
                           <p>假设使用' <code class="codeph">chnf_callback</code>作为通知处理程序并使用<code class="codeph">registration_id</code> 100创建<code class="codeph">registration_id</code> 。让我们假设用户忘记定义<code class="codeph">chnf_callback</code>过程。然后<code class="codeph">JOBQ</code>跟踪文件可能包含以下形式的消息。
                           </p><pre class="oac_no_warn" dir="ltr">执行PL / SQL时的运行时错误cnk chnf_callback for reg CHNF100 msgid的PLSQL通知错误：队列：使用者名称：PLSQL函数：chnf_callback异常发生，错误消息：ORA-00604：递归SQL级别2 ORA-06550发生错误：第1行第7列：PLS-00201：必须声明标识符'CHNF_CALLBACK'ORA-06550：第1行第7列：PL / SQL：语句被忽略</pre></li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-359BFA35-64EF-477D-B98D-96E5373888E6__GUID-09496318-F1CD-492E-AC22-AD1DBCF87FE9">
                        <p class="notep1">也可以看看：</p>
                        <p>有关数据库更改通知疑难解答的详细信息，请参阅<a href="../adfns/cqn.html#ADFNS1020" target="_blank"><span class="italic">Oracle数据库开发指南</span></a> 。
                        </p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="ARPLS73675"></a><a id="ARPLS73676"></a><a id="ARPLS73677"></a><a id="ARPLS73676"></a><a id="ARPLS73677"></a><a id="ARPLS73675"></a><div class="props_rev_3"><a id="GUID-A252A88A-6B2D-49F9-8CB8-4F790F2B2534" name="GUID-A252A88A-6B2D-49F9-8CB8-4F790F2B2534"></a><h3 id="ARPLS-GUID-A252A88A-6B2D-49F9-8CB8-4F790F2B2534" class="sect3"><span class="enumeration_section">37.5</span> DBMS_CQ_NOTIFICATION示例</h3>
               <div>
                  <p>假设中间层应用程序在<code class="codeph">HR</code>上有很多查询。 <code class="codeph">EMPLOYEES</code>表。如果不经常更新<code class="codeph">EMPLOYEES</code>表，则可以通过缓存表中的行来获得更好的性能，因为这样可以避免后端数据库服务器的往返和服务器端执行延迟。我们假设应用程序已实现了一个中间层HTTP侦听器，该侦听器侦听通知并更新中间层缓存以响应通知。
                  </p>
                  <div class="section">
                     <p class="subhead2" id="GUID-A252A88A-6B2D-49F9-8CB8-4F790F2B2534__GUID-DA4B45EB-A08C-4D4C-B3CB-2B60ED14B760">对象更改注册示例</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>在此方案中，可以使用<code class="codeph">DBMS_CQ_NOTIFICATION</code>包通过以下步骤发送有关表更改的通知：</p>
                     <ol>
                        <li>
                           <p>实现缓存管理系统的中间层侦听器组件（例如，使用HTTP），该组件侦听从数据库发送的通知消息，并刷新中间层缓存以响应通知。</p>
                        </li>
                        <li>
                           <p>创建服务器端存储过程以处理通知</p><pre class="oac_no_warn" dir="ltr">CONNECT系统;输入密码： <span class="italic">密码</span> GRANT CHANGE NOTIFICATION TO hr; DBMS_CQ_NOTIFICATION到hr的GRANT EXECUTE; Rem启用作业队列进程以接收通知。ALTER SYSTEM SET“job_queue_processes”= 2;连接小时;输入密码： <span class="italic">密码</span> Rem创建一个表来记录通知事件CREATE TABLE nfevents（regid number，event_type number）; Rem创建一个表来记录已注册表的更改CREATE TABLE nftablechanges（regid number，table_name varchar2（100），table_operation number）; Rem创建一个表来记录已更改行的rowid。CREATE TABLE nfrowchanges（regid number，table_name varchar2（100），row_id varchar2（30））; Rem创建一个PL / SQL回调处理程序来处理通知。创建或替换程序chnf_callback（ntfnds IN SYS.CHNF $ _DESC）是注册号码; tbname VARCHAR2（60）; event_type NUMBER; numtables NUMBER; operation_type NUMBER; numrows NUMBER; row_id VARCHAR2（20）; BEGIN regid：= ntfnds.registration_id; numtables：= ntfnds.numtables; event_type：= ntfnds.event_type; INSERT INTO nfevents VALUES（regid，event_type）; IF（event_type = DBMS_CQ_NOTIFICATION.EVENT_OBJCHANGE）那么for i IN 1..numtables LOOP tbname：= ntfnds.table_desc_array（i）.table_name; operation_type：= ntfnds.table_desc_array（I）。Opflags; INSERT INTO nftablechanges VALUES（regid，tbname，operation_type）; / *使用UTL_HTTP将表名和operation_type发送到客户端侦听器* / / *如果对rowid感兴趣，请按以下方式获取它们* / IF（bitand（operation_type，DBMS_CQ_NOTIFICATION.ALL_ROWS）= 0）THEN numrows：= ntfnds.table_desc_array （ⅰ）.numrows; ELSE numrows：= 0; / * ROWID INFO NOT AVAILABLE * / END IF; / *当numrows为ZERO * / FOR j IN 1时，不执行循环体。读取LOOP Row_id：= ntfnds.table_desc_array（i）.row_desc_array（j）.row_id; INSERT INTO nfrowchanges VALUES（regid，tbname，Row_id）; / *可选择使用UTL_HTTP将row_id发送到客户端侦听器; * / END LOOP;结束循环;万一;承诺;结束; /</pre><p>在<span>第2步</span> <span> </span>我们可以根据从通知描述符获得的信息，发送与中间层应用程序需要的无效信息一样多的信息。
                           </p>
                           <p>笔记</p>
                           <ol type="a">
                              <li>
                                 <p>在上面的示例中，在<code class="codeph">EMPLOYEES</code>表上创建了一个注册，其中“ <code class="codeph">chnf_callback</code> ”作为通知的PL / SQL处理程序。在注册期间，客户端指定了可靠的通知（ <code class="codeph">QOS_RELIABLE</code> ）和rowid通知（ <code class="codeph">QOS_ROWIDS</code> ）</p>
                              </li>
                              <li>
                                 <p>仅当通知类型为<code class="codeph">EVENT_OBJCHANGE</code> ，处理程序才从通知描述符访问表描述符数组。在所有其他情况下（例如<code class="codeph">EVENT_DEREG</code> ， <code class="codeph">EVENT_SHUTDOWN</code> ），不应访问表描述符数组。
                                 </p>
                              </li>
                              <li>
                                 <p>仅当表操作标志中未设置<code class="codeph">ALL_ROWS</code>位时，处理程序才从表通知描述符访问行描述符数组。如果在表操作标志中设置了<code class="codeph">ALL_ROWS</code>位，则表示表中的所有行都可能已被修改。除了影响表中所有行的<code class="codeph">TRUNCATE</code>操作之外，如果单个rowid已累计到FULL表失效中，也可以设置此位。
                                 </p>
                                 <p>如果在单个事务中的给定表上修改了太多行（超过80个），或者由于RDBMS上的rowid导致的总共享内存消耗过大（超过动态共享池大小的1％），则会发生这种情况。在这种情况下，收件人必须保守地假设整个表已经失效，并且回调/应用程序必须能够处理这种情况。</p>
                                 <p>另请注意，用户定义的回调的实现取决于开发人员。在上面的示例中，回调用于将事件详细信息记录到数据库表中。应用程序还可以使用<code class="codeph">UTL_HTTP</code>将通知详细信息发送到其缓存管理系统的中间层<code class="codeph">HTTP</code>侦听器（如示例中所示）。然后，侦听器可以通过从后端数据库查询来刷新其缓存。
                                 </p>
                              </li>
                           </ol>
                        </li>
                        <li>
                           <p>在我们希望收到通知的表上创建注册。我们传入先前定义的过程名称（ <code class="codeph">chnf_callback</code> ）作为生成通知时要执行的服务器端PL / SQL过程的名称。
                           </p><pre class="oac_no_warn" dir="ltr">Rem在EMPLOYEES TABLE DECLARE REGDS SYS.CHNF $ _REG_INFO上创建注册;注册号码; mgr_id NUMBER; dept_id NUMBER; qosflags NUMBER; BEGIN qosflags：= DBMS_CQ_NOTIFICATION.QOS_RELIABLE + DBMS_CQ_NOTIFICATION.QOS_ROWIDS; REGDS：= SYS.CHNF $ _REG_INFO（'chnf_callback'，qosflags，0,0,0）; regid：= DBMS_CQ_NOTIFICATION.NEW_REG_START（REGDS）; SELECT manager_id INTO mgr_id FROM EMPLOYEES WHERE employee_id = 200; DBMS_CQ_NOTIFICATION.REG_END;结束; /</pre><p>一旦在上面的步骤3中创建了注册，就执行步骤2中定义的服务器端PL / SQL过程以响应对<code class="codeph">HR</code>任何<code class="codeph">COMMIT</code> ted改变。 <code class="codeph">EMPLOYEES</code>表。作为示例，我们假设在employees表上执行了以下更新。
                           </p><pre class="oac_no_warn" dir="ltr">UPDATE员工SET薪水=薪水* 1.05 WHERE employee_id = 203; COMMIT;</pre><p>处理完通知后，您会在<code class="codeph">nfevents</code> ， <code class="codeph">nftablechanges</code>和<code class="codeph">nfrowchanges</code>表中找到可能如下所示的行。
                           </p><pre class="oac_no_warn" dir="ltr">SQL&gt; SELECT * FROM nfevents; REGID EVENT_TYPE --------------------------- 20045 6 SQL&gt; SELECT * FROM nftablechanges; REGID TABLE_NAME TABLE_OPERATION ------------------------------------------- 20045 HR.EMPLOYEES 4 SQL&gt; select * from nfrowchanges; REGID TABLE_NAME ROW_ID ----------------------------------------------- ------- 20045 HR.EMPLOYEES AAAKB / AABAAAJ8zAAF</pre></li>
                     </ol>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-A252A88A-6B2D-49F9-8CB8-4F790F2B2534__GUID-48DC7885-7821-40CA-8331-8EACF4403780">查询结果更改注册示例</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ol>
                        <li>
                           <p>创建回调</p><pre class="oac_no_warn" dir="ltr">CONNECT系统;输入密码： <span class="italic">密码</span> GRANT CHANGE NOTIFICATION TO hr; DBMS_CQ_NOTIFICATION到hr的GRANT EXECUTE;连接小时;输入密码： <span class="italic">密码</span> Rem创建一个表来记录通知事件CREATE TABLE nfevents（regid NUMBER，event_type NUMBER）; Rem创建一个表来记录通知查询CREATE TABLE nfqueries（qid NUMBER，qop NUMBER）; Rem创建一个表来记录已注册表的更改CREATE TABLE nftablechanges（qid NUMBER，table_name VARCHAR2（100），table_operation NUMBER）; Rem创建一个表来记录已更改行的rowid。CREATE TABLE nfrowchanges（qid NUMBER，table_name VARCHAR2（100），row_id VARCHAR2（2000））;创建或替换程序chnf_callback（ntfnds IN CQ_NOTIFICATION $ _DESCRIPTOR）是注册号码; tbname VARCHAR2（60）; event_type NUMBER; numtables NUMBER; operation_type NUMBER; numrows NUMBER; row_id VARCHAR2（2000）; numqueries NUMBER; qid NUMBER; qop NUMBER; BEGIN regid：= ntfnds.registration_id; event_type：= ntfnds.event_type; INSERT INTO nfevents VALUES（regid，event_type）; numqueries：= 0; IF（event_type = DBMS_CQ_NOTIFICATION.EVENT_QUERYCHANGE）那么numqueries：= ntfnds.query_desc_array.count; FOR i in 1..numqueries LOOP qid：= ntfnds。QUERY_DESC_ARRAY（ⅰ）.queryid; qop：= ntfnds。QUERY_DESC_ARRAY（ⅰ）.queryop; INSERT INTO nfqueries VALUES（qid，qop）; numtables：= 0; numtables：= ntfnds。QUERY_DESC_ARRAY（ⅰ）.table_desc_array.count; FOR j IN 1..numtables LOOP tbname：= ntfnds。QUERY_DESC_ARRAY（ⅰ）.table_desc_array（J）.table_name; operation_type：= ntfnds。QUERY_DESC_ARRAY（I）.table_desc_array（J）。Opflags; INSERT INTO nftablechanges VALUES（qid，tbname，operation_type）; IF（bitand（operation_type，DBMS_CQ_NOTIFICATION.ALL_ROWS）= 0）THEN numrows：= ntfnds.query_desc_array（i）.table_desc_array（j）.numrows; ELSE numrows：= 0; / * ROWID INFO NOT AVAILABLE * / END IF; / *当numrows为ZERO * / FOR k IN 1时，不执行循环体。读取LOOP Row_id：= ntfnds.query_desc_array（i）.table_desc_array（j）.row_desc_array（k）.row_id; INSERT INTO nfrowchanges VALUES（qid，tbname，Row_id）;结束循环; / *循环行* / END LOOP; / *循环表* / END LOOP; / *循环查询* / END IF;承诺;结束; /</pre></li>
                        <li>
                           <p>创建查询注册</p><pre class="oac_no_warn" dir="ltr">DECLARE reginfo cq_notification $ _reg_info; mgr_id NUMBER; dept_id NUMBER; v_cursor SYS_REFCURSOR;注册号码; qosflags NUMBER; BEGIN / *为结果集更改通知注册两个查询：* / / * 1。构建注册信息。'chnf_callback'是通知处理程序的名称。QOS_QUERY指定结果集更改通知。* / qosflags：= DBMS_CQ_NOTIFICATION.QOS_QUERY + DBMS_CQ_NOTIFICATION.QOS_ROWIDS; reginfo：= cq_notification $ _reg_info（'chnf_callback'，qosflags，0,0,0）; / * 2。创建注册* / regid：= DBMS_CQ_NOTIFICATION.NEW_REG_START（reginfo）; OPEN v_cursor FOR SELECT DBMS_CQ_NOTIFICATION.CQ_NOTIFICATION_QUERYID，manager_id FROM HR.employees WHERE employee_id = 7902;关闭v_cursor; OPEN v_cursor用于SELECT DBMS_CQ_NOTIFICATION.CQ_NOTIFICATION_QUERYID，department_id FROM HR.departments WHERE department_name ='IT';关闭v_cursor; DBMS_CQ_NOTIFICATION.REG_END;结束; /</pre></li>
                        <li>
                           <p>创建查询注册后， <code class="codeph">USER_CQ_NOTIFICATION_QUERIES</code>的输出将如下所示。
                           </p><pre class="oac_no_warn" dir="ltr">SQL&gt; SELECT queryid，regid，to_char（querytext）FROM user_cq_notification_queries; QUERYID REGID ---------- ---------- TO_CHAR（QUERYTEXT）------------------------ -------------------------------------------------- ------ 22 41选择HR.DEPARTMENTS.DEPARTMENT_ID来自HR.DEPARTMENTS HREREDEPARTMENTS。 DEPARTMENT_NAME ='IT'21 41选择HR.EMPLOYEES.MANAGER_ID来自HR.EMPLOYEES WHERE HR.EMPLOYEES.EMPLOYEE_ ID = 7902现在，让我们通过重命名名为'的部门来执行更新查询结果的UPDATE IT'到财务。 SQL&gt;更新部门设置department_name ='FINANCE'，其中department_name ='IT'; 1行更新。SQL&gt; commit;提交完成。现在我们可以查询我们在回调中记录的通知。SQL&gt; select * from nfevents; REGID EVENT_TYPE ---------- ---------- 61 7事件类型7对应于EVENT_QUERYCHANGE SQL&gt; select * from nfqueries; QID QOP ---------- ---------- 42 7事件类型7对应于EVENT_QUERYCHANGE SQL&gt; select * from nftablechanges; SQL&gt; select * from nftablechanges; REGID ---------- TABLE_NAME -------------------------------------- ------------------------------------------ TABLE_OPERATION ------- -------- 42 HR.DEPARTMENTS 4 TABLE_OPERATION 4对应于UPDATEOP SQL&gt; select * from nfrowchanges; REGID ---------- TABLE_NAME -------------------------------------- ------------------------------------------ ROW_ID ------- -------------------------------------------------- ----------------------- 61 HR.DEPARTMENTS AAANkdAABAAALinAAF</pre></li>
                     </ol>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="ARPLS65645"></a><a id="ARPLS65645"></a><div class="props_rev_3"><a id="GUID-542B69EF-9E64-4E9B-A15F-C69BE5747622" name="GUID-542B69EF-9E64-4E9B-A15F-C69BE5747622"></a><h3 id="ARPLS-GUID-542B69EF-9E64-4E9B-A15F-C69BE5747622" class="sect3"><span class="enumeration_section">37.6</span> DBMS_CQ_NOTIFICATION数据结构</h3>
               <div>
                  <p><code class="codeph">DBMS_CQ_NOTIFICATION</code>包定义了几种<code class="codeph">OBJECT</code>类型。
                  </p>
                  <div class="section">
                     <p class="subhead2" id="GUID-542B69EF-9E64-4E9B-A15F-C69BE5747622__GUID-F54B4BBB-C9A0-4754-A34A-1174D4959AA2">对象类型</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="DBMS_CQ_NOTIFICATION.html#GUID-4FCD5A6C-D1EE-45A6-95D4-8C82D6319217" title="这是顶级更改通知描述符类型。它是SYS.CHNF $ _DESC类型的同义词。">CQ_NOTIFICATION $ _DESCRIPTOR对象类型</a></p>
                        </li>
                        <li>
                           <p><a href="DBMS_CQ_NOTIFICATION.html#GUID-808CBE68-12DC-40E9-8EEC-DDDB9073E6B5" title="对象类型描述由事件（例如事务提交）引起的对查询结果的更改。">CQ_NOTIFICATION $ _QUERY对象类型</a></p>
                        </li>
                        <li>
                           <p><a href="DBMS_CQ_NOTIFICATION.html#GUID-7D75D705-33A3-4169-8F70-978F2DA36808" title="此类型对应于CQ_NOTIFICATION $ _QUERY对象的数组。它是SYS.CHNF $ _QUERY_ARRAY类型的同义词。">CQ_NOTIFICATION $ _QUERY_ARRAY对象（数组）类型</a></p>
                        </li>
                        <li>
                           <p><a href="DBMS_CQ_NOTIFICATION.html#GUID-8080C006-03AE-4475-96AA-16EB6A028E04" title="此描述符类型描述对表的更改，并嵌入EVENT_OBJCHANGE事件类型的顶级更改通知描述符类型中。对于查询结果集更改（事件类型将设置为EVENT_QUERYCHANGE），表描述符数组嵌入在每个查询更改描述符中。">CQ_NOTIFICATION $ _TABLE对象类型</a></p>
                        </li>
                        <li>
                           <p><a href="DBMS_CQ_NOTIFICATION.html#GUID-0465C1A2-178A-4C08-87E0-9DCAD11A03FB" title="此类型对应于CQ_NOTIFICATION $ _TABLE对象的数组。它是SYS.CHNF $ _TDESC_ARRAY类型的同义词。">CQ_NOTIFICATION $ _TABLE_ARRAY对象（数组）类型</a></p>
                        </li>
                        <li>
                           <p><a href="DBMS_CQ_NOTIFICATION.html#GUID-20407C5F-E147-47C0-B092-5E8A88E813BA" title="如果在注册时选择了QOS_ROWIDS选项并且未在表更改描述符的opflags字段中设置ALL_ROWS位，则CQ_NOTIFICATION $ _ROW数组嵌入CQ_NOTIFICATION $ _TABLE（表更改描述符）中。">CQ_NOTIFICATION $ _ROW对象类型</a></p>
                        </li>
                        <li>
                           <p><a href="DBMS_CQ_NOTIFICATION.html#GUID-72159DCF-5C34-4B42-838B-A2C441261CDF" title="此对象类型对应于CQ_NOTIFICATION $ _ROW对象的数组。如果在注册期间指定了QOS_ROWIDS并且未在表更改描述符的opflags字段中设置ALL_ROWS位，则它嵌入在CQ_NOTIFICATION $ _TABLE内。">CQ_NOTIFICATION $ _ROW_ARRAY对象（数组）类型</a></p>
                        </li>
                        <li>
                           <p><a href="DBMS_CQ_NOTIFICATION.html#GUID-1732CD12-503B-43EA-8BB7-522C1FA235CA" title="对象类型描述与创建新注册相关联的属性。它是以前名为SYS.CHNF $ _REG_INFO的类型的同义词。">CQ_NOTIFICATION $ _REG_INFO对象类型</a></p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div><a id="ARPLS65646"></a><a id="ARPLS65647"></a><a id="ARPLS65647"></a><a id="ARPLS65646"></a><div class="props_rev_3"><a id="GUID-4FCD5A6C-D1EE-45A6-95D4-8C82D6319217" name="GUID-4FCD5A6C-D1EE-45A6-95D4-8C82D6319217"></a><h4 id="ARPLS-GUID-4FCD5A6C-D1EE-45A6-95D4-8C82D6319217" class="sect4"><span class="enumeration_section">37.6.1</span> CQ_NOTIFICATION $ _DESCRIPTOR对象类型</h4>
                  <div>
                     <p>这是顶级更改通知描述符类型。它是<code class="codeph">SYS.CHNF$_DESC</code>类型的同义词。
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-4FCD5A6C-D1EE-45A6-95D4-8C82D6319217__GUID-80E2D688-737C-4661-89EE-F0832CA352DE">句法</p><pre class="oac_no_warn" dir="ltr">TYPE SYS.CHNF $ _DESC是OBJECT（registration_id NUMBER，transaction_id RAW（8），dbname VARCHAR2（30），event_type NUMBER，numtables NUMBER，table_desc_array CQ_NOTIFICATION $ _TABLE_ARRAY，query_desc_array CQ_NOTIFICATION $ _QUERY_ARRAY）;</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-4FCD5A6C-D1EE-45A6-95D4-8C82D6319217__GUID-C3B14A4C-8387-4600-BB87-4E0D551BB509">属性</p>
                        <div class="tblformal" id="GUID-4FCD5A6C-D1EE-45A6-95D4-8C82D6319217__GUID-F67417F1-3A54-4F64-A316-A5153E5BAD56">
                           <p class="titleintable">表37-2 CQ_NOTIFICATION $ _DESCRIPTOR对象类型</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="CQ_NOTIFICATION $ _DESCRIPTOR对象类型" width="100%" border="1" summary="This table liststhe attributes of the CHNF$_DESC object type and briefly describes them." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="31%" id="d186645e1719">属性</th>
                                    <th align="left" valign="bottom" width="69%" id="d186645e1722">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d186645e1727" headers="d186645e1719 ">
                                       <p><code class="codeph">registration_id</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d186645e1727 d186645e1722 ">
                                       <p>注册时返回注册ID</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d186645e1735" headers="d186645e1719 ">
                                       <p><code class="codeph">TRANSACTION_ID</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d186645e1735 d186645e1722 ">
                                       <p>交易ID。进行更改的<code class="codeph">transaction_id</code>的transaction_id。除非event_type是<code class="codeph">EVENT_OBJCHANGE</code>或<code class="codeph">EVENT_QUERYCHANGE</code>否则<code class="codeph">EVENT_OBJCHANGE</code> <code class="codeph">NULL</code> 。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d186645e1755" headers="d186645e1719 ">
                                       <p><code class="codeph">DBNAME</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d186645e1755 d186645e1722 ">
                                       <p>数据库名称</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d186645e1763" headers="d186645e1719 ">
                                       <p><code class="codeph">事件类型</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d186645e1763 d186645e1722 ">
                                       <p>与通知关联的数据库事件。可以是<code class="codeph">EVENT_OBJCHANGE</code> （更改为已注册对象）， <code class="codeph">EVENT_STARTUP</code>或<code class="codeph">EVENT_QUERYCHANGE</code> ， <code class="codeph">EVENT_SHUTDOWN</code>或<code class="codeph">EVENT_DEREG</code> （由于超时或其他原因已删除注册）</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d186645e1786" headers="d186645e1719 ">
                                       <p><code class="codeph">numtables</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d186645e1786 d186645e1722 ">
                                       <p>修改表的数量。除非<code class="codeph">event_type</code>是<code class="codeph">EVENT_OBJCHANGE</code>否则<code class="codeph">EVENT_OBJCHANGE</code> <code class="codeph">NULL</code> 。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d186645e1803" headers="d186645e1719 ">
                                       <p><code class="codeph">table_desc_array</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d186645e1803 d186645e1722 ">
                                       <p>表描述符数组。除非<code class="codeph">event_type</code>是<code class="codeph">EVENT_OBJCHANGE</code>否则<code class="codeph">EVENT_OBJCHANGE</code> <code class="codeph">NULL</code> 。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d186645e1820" headers="d186645e1719 ">
                                       <p><code class="codeph">query_desc_array</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d186645e1820 d186645e1722 ">
                                       <p>查询数组已更改。除非event_type是<code class="codeph">EVENT_QUERYCHANGE</code>否则这将为<code class="codeph">NULL</code> 
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ARPLS65648"></a><a id="ARPLS65649"></a><a id="ARPLS65649"></a><a id="ARPLS65648"></a><div class="props_rev_3"><a id="GUID-808CBE68-12DC-40E9-8EEC-DDDB9073E6B5" name="GUID-808CBE68-12DC-40E9-8EEC-DDDB9073E6B5"></a><h4 id="ARPLS-GUID-808CBE68-12DC-40E9-8EEC-DDDB9073E6B5" class="sect4"><span class="enumeration_section">37.6.2</span> CQ_NOTIFICATION $ _QUERY对象类型</h4>
                  <div>
                     <p>对象类型描述由事件（例如事务提交）引起的对查询结果的更改。</p>
                     <div class="section">
                        <p>的阵列<code class="codeph">CQ_NOTIFICATION$_QUERY</code>描述符被嵌入顶层通知描述符（内部<code class="codeph">CQ_NOTIFICATION$_DESCRIPTOR</code> ），用于类型的事件<code class="codeph">EVENT_QUERYCHANGE</code> 。该阵列对应于<code class="codeph">SET</code>其被无效的事件的结果queryids的。
                        </p>
                        <p>这是基本类型<code class="codeph">SYS.CHNF$_QDESC</code> 。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-808CBE68-12DC-40E9-8EEC-DDDB9073E6B5__GUID-0A1EA12F-0414-47AB-8F3C-904D47A215C6">句法</p><pre class="oac_no_warn" dir="ltr">TYPE SYS.CHNF $ _QDESC是OBJECT（queryid NUMBER，queryop NUMBER，table_desc_array CQ_NOTIFICATION $ _TABLE_ARRAY）;</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-808CBE68-12DC-40E9-8EEC-DDDB9073E6B5__GUID-090DA591-8C35-41AA-B4A5-34F06D5157B3">属性</p>
                        <div class="tblformal" id="GUID-808CBE68-12DC-40E9-8EEC-DDDB9073E6B5__GUID-B4FF435A-C663-4953-819D-EB101467D7CE">
                           <p class="titleintable">表37-3 TYPE SYS.CQ_NOTIFICATION $ _QUERY对象类型</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="TYPE SYS.CQ_NOTIFICATION $ _QUERY对象类型" width="100%" border="1" summary="This table describes the fields of the Object Type CQ_NOTIFICATION$_QUERY and briefly describes them" frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="40%" id="d186645e1964">属性</th>
                                    <th align="left" valign="bottom" width="60%" id="d186645e1967">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="40%" id="d186645e1972" headers="d186645e1964 ">
                                       <p><code class="codeph">queryid</code></p>
                                    </td>
                                    <td align="left" valign="top" width="60%" headers="d186645e1972 d186645e1967 ">
                                       <p>已更改查询的QueryId</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="40%" id="d186645e1980" headers="d186645e1964 ">
                                       <p><code class="codeph">queryop</code></p>
                                    </td>
                                    <td align="left" valign="top" width="60%" headers="d186645e1980 d186645e1967 ">
                                       <p>描述对查询的更改的操作</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="40%" id="d186645e1988" headers="d186645e1964 ">
                                       <p><code class="codeph">table_desc_array</code></p>
                                    </td>
                                    <td align="left" valign="top" width="60%" headers="d186645e1988 d186645e1967 ">
                                       <p>导致查询结果集更改的表更改数组</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ARPLS65650"></a><a id="ARPLS65650"></a><div class="props_rev_3"><a id="GUID-7D75D705-33A3-4169-8F70-978F2DA36808" name="GUID-7D75D705-33A3-4169-8F70-978F2DA36808"></a><h4 id="ARPLS-GUID-7D75D705-33A3-4169-8F70-978F2DA36808" class="sect4"><span class="enumeration_section">37.6.3</span> CQ_NOTIFICATION $ _QUERY_ARRAY对象（数组）类型</h4>
                  <div>
                     <p>此类型对应于<code class="codeph">CQ_NOTIFICATION$_QUERY</code>对象的数组。它是<code class="codeph">SYS.CHNF$_QUERY_ARRAY</code>类型的同义词。
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-7D75D705-33A3-4169-8F70-978F2DA36808__GUID-BF6497F2-22BB-42F9-8414-933DAA13006D">句法</p><pre class="oac_no_warn" dir="ltr">类型CQ_NOTIFICATION $ _TABLE_ARRAY是VARRAY（1073741824）OF <code class="codeph">CQ_NOTIFICATION$_TABLE</code> ;</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ARPLS65651"></a><a id="ARPLS65652"></a><a id="ARPLS65652"></a><a id="ARPLS65651"></a><div class="props_rev_3"><a id="GUID-8080C006-03AE-4475-96AA-16EB6A028E04" name="GUID-8080C006-03AE-4475-96AA-16EB6A028E04"></a><h4 id="ARPLS-GUID-8080C006-03AE-4475-96AA-16EB6A028E04" class="sect4"><span class="enumeration_section">37.6.4</span> CQ_NOTIFICATION $ _TABLE对象类型</h4>
                  <div>
                     <p>此描述符类型描述对表的更改，并嵌入<code class="codeph">EVENT_OBJCHANGE</code>事件类型的顶级更改通知描述符类型中。对于查询结果集更改（事件类型将设置为<code class="codeph">EVENT_QUERYCHANGE</code> ），表描述符数组嵌入在每个查询更改描述符中。
                     </p>
                     <div class="section">
                        <p>请注意，这是<code class="codeph">previously named SYS.CHNF$_TDESC</code>的类型的同义词。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-8080C006-03AE-4475-96AA-16EB6A028E04__GUID-F27375A8-A4F2-42E5-8B9F-415D898745EC">句法</p><pre class="oac_no_warn" dir="ltr">TYPE SYS.CHNF $ _TDESC是OBJECT（opflags NUMBER，table_name VARCHAR2（2 * M_IDEN + 1），numrows NUMBER，row_desc_array CQ_NOTIFICATION $ _ROW_ARRAY）</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-8080C006-03AE-4475-96AA-16EB6A028E04__GUID-791967B5-EF8C-4954-B1C6-854EFBF72012">属性</p>
                        <div class="tblformal" id="GUID-8080C006-03AE-4475-96AA-16EB6A028E04__GUID-0019038C-CB0C-430E-A915-838CE8FA78A4">
                           <p class="titleintable">表37-4 TYPE SYS.CQ_NOTIFICATION $ _TABLE对象类型</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="TYPE SYS.CQ_NOTIFICATION $ _TABLE对象类型" width="100%" border="1" summary="This table describes the fields of the Object Type SYS.CQ_NOTIFICATION$_TABLE and briefly describes them" frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="40%" id="d186645e2221">属性</th>
                                    <th align="left" valign="bottom" width="60%" id="d186645e2224">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="40%" id="d186645e2229" headers="d186645e2221 ">
                                       <p>opflags</p>
                                    </td>
                                    <td align="left" valign="top" width="60%" headers="d186645e2229 d186645e2224 ">
                                       <p>表级操作标志。这是一个标志字段（位向量），用于描述表上发生的操作。它可以是以下位字段的<code class="codeph">OR</code> - <code class="codeph">INSERTOP</code> ， <code class="codeph">UPDATEOP</code> ， <code class="codeph">DELETEOP</code> ， <code class="codeph">DROPOP</code> ， <code class="codeph">ALTEROP</code> ， <code class="codeph">ALL_ROWS</code> 。如果设置了<code class="codeph">ALL_ROWS</code> （0x1）位，则意味着整个表被修改（例如， <code class="codeph">DELETE</code> * <code class="codeph">FROM</code> <code class="codeph">t</code> ）或者通知中没有请求或不提供行级粒度信息，并且接收方必须保守地假设整个表已失效。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="40%" id="d186645e2270" headers="d186645e2221 ">
                                       <p><code class="codeph">TABLE_NAME</code></p>
                                    </td>
                                    <td align="left" valign="top" width="60%" headers="d186645e2270 d186645e2224 ">
                                       <p>修改表的名称</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="40%" id="d186645e2278" headers="d186645e2221 ">
                                       <p><code class="codeph">numRows行</code></p>
                                    </td>
                                    <td align="left" valign="top" width="60%" headers="d186645e2278 d186645e2224 ">
                                       <p>表中已修改的行数。 numrows将为<code class="codeph">NULL</code> ，因此如果在表更改描述符中设置了<code class="codeph">ALL_ROWS</code>位，则不应访问它们。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="40%" id="d186645e2292" headers="d186645e2221 ">
                                       <p><code class="codeph">row_desc_array</code></p>
                                    </td>
                                    <td align="left" valign="top" width="60%" headers="d186645e2292 d186645e2224 ">
                                       <p>行描述符数组。此字段为<code class="codeph">NULL</code> ，如果<code class="codeph">ALL_ROWS</code>位被设置<code class="codeph">opflags</code> 。
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ARPLS65653"></a><a id="ARPLS65653"></a><div class="props_rev_3"><a id="GUID-0465C1A2-178A-4C08-87E0-9DCAD11A03FB" name="GUID-0465C1A2-178A-4C08-87E0-9DCAD11A03FB"></a><h4 id="ARPLS-GUID-0465C1A2-178A-4C08-87E0-9DCAD11A03FB" class="sect4"><span class="enumeration_section">37.6.5</span> CQ_NOTIFICATION $ _TABLE_ARRAY对象（数组）类型</h4>
                  <div>
                     <p>此类型对应于<code class="codeph">CQ_NOTIFICATION$_TABLE</code>对象的数组。它是<code class="codeph">SYS.CHNF$_TDESC_ARRAY</code>类型的同义词。
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-0465C1A2-178A-4C08-87E0-9DCAD11A03FB__GUID-D3029FAE-23E7-4E12-B2A9-E535A53540CD">句法</p><pre class="oac_no_warn" dir="ltr">类型CQ_NOTIFICATION $ _TABLE_ARRAY是VARRAY（1073741824）OF <code class="codeph">CQ_NOTIFICATION$_TABLE</code> ;</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ARPLS65654"></a><a id="ARPLS65655"></a><a id="ARPLS65655"></a><a id="ARPLS65654"></a><div class="props_rev_3"><a id="GUID-20407C5F-E147-47C0-B092-5E8A88E813BA" name="GUID-20407C5F-E147-47C0-B092-5E8A88E813BA"></a><h4 id="ARPLS-GUID-20407C5F-E147-47C0-B092-5E8A88E813BA" class="sect4"><span class="enumeration_section">37.6.6</span> CQ_NOTIFICATION $ _ROW对象类型</h4>
                  <div>
                     <p>如果在注册时选择了<code class="codeph">QOS_ROWIDS</code>选项并且未在表更改描述符的<code class="codeph">opflags</code>字段中设置<code class="codeph">ALL_ROWS</code>位，则<code class="codeph">CQ_NOTIFICATION$_ROW</code>数组嵌入在<code class="codeph">CQ_NOTIFICATION$_TABLE</code> （表更改描述符）中。
                     </p>
                     <div class="section">
                        <p>请注意，这是<code class="codeph">previously named</code> <code class="codeph">SYS.CHNF$_RDESC</code>的类型的同义词。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-20407C5F-E147-47C0-B092-5E8A88E813BA__GUID-DD5959D0-684A-4518-9252-A8E6102B7050">句法</p><pre class="oac_no_warn" dir="ltr">TYPE SYS.CHNF $ _RDESC是OBJECT（opflags NUMBER，row_id VARCAHR2（2000））;</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-20407C5F-E147-47C0-B092-5E8A88E813BA__GUID-0361588E-894E-45A3-AB27-6446FE89C97E">属性</p>
                        <div class="tblformal" id="GUID-20407C5F-E147-47C0-B092-5E8A88E813BA__GUID-46214F6E-FECF-48C9-9132-6CCDA2F32836">
                           <p class="titleintable">表37-5 TYPE SYS.CQ_NOTIFICATION $ _ROW对象类型</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="TYPE SYS.CQ_NOTIFICATION $ _ROW对象类型" width="100%" border="1" summary="This table describes the fields of the Object Type SYS.CQ_NOTIFICATION$_ROW and briefly describes them" frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="40%" id="d186645e2546">属性</th>
                                    <th align="left" valign="bottom" width="60%" id="d186645e2549">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="40%" id="d186645e2554" headers="d186645e2546 ">
                                       <p>opflags</p>
                                    </td>
                                    <td align="left" valign="top" width="60%" headers="d186645e2554 d186645e2549 ">
                                       <p>行级操作标志。标志字段（位向量）描述行中的操作（可以是<code class="codeph">INSERTOP</code> ， <code class="codeph">UPDATEOP</code>或<code class="codeph">DELETEOP</code> ）。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="40%" id="d186645e2570" headers="d186645e2546 ">
                                       <p><code class="codeph">ROW_ID</code></p>
                                    </td>
                                    <td align="left" valign="top" width="60%" headers="d186645e2570 d186645e2549 ">
                                       <p>修改行的rowid</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ARPLS65656"></a><a id="ARPLS65656"></a><div class="props_rev_3"><a id="GUID-72159DCF-5C34-4B42-838B-A2C441261CDF" name="GUID-72159DCF-5C34-4B42-838B-A2C441261CDF"></a><h4 id="ARPLS-GUID-72159DCF-5C34-4B42-838B-A2C441261CDF" class="sect4"><span class="enumeration_section">37.6.7</span> CQ_NOTIFICATION $ _ROW_ARRAY对象（数组）类型</h4>
                  <div>
                     <p>此对象类型对应于<code class="codeph">CQ_NOTIFICATION$_ROW</code>对象的数组。它嵌入在里面<code class="codeph">CQ_NOTIFICATION$_TABLE</code>如果<code class="codeph">QOS_ROWIDS</code>注册过程中指定和<code class="codeph">ALL_ROWS</code>位没有在设置<code class="codeph">opflags</code>表变化的描述符的领域。
                     </p>
                     <div class="section">
                        <p>此类型是<code class="codeph">SYS.CHNF$_RDESC_ARRAY</code>类型的同义词。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-72159DCF-5C34-4B42-838B-A2C441261CDF__GUID-521FCD5B-66EE-4D83-8C4A-1FAC517F2D5C">句法</p><pre class="oac_no_warn" dir="ltr">类型CQ_NOTIFICATION $ _ROW_ARRAY是VARRAY（1073741824）OF CQ_NOTIFICATION $ _ROW;</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ARPLS65657"></a><a id="ARPLS65658"></a><a id="ARPLS65658"></a><a id="ARPLS65657"></a><div class="props_rev_3"><a id="GUID-1732CD12-503B-43EA-8BB7-522C1FA235CA" name="GUID-1732CD12-503B-43EA-8BB7-522C1FA235CA"></a><h4 id="ARPLS-GUID-1732CD12-503B-43EA-8BB7-522C1FA235CA" class="sect4"><span class="enumeration_section">37.6.8</span> CQ_NOTIFICATION $ _REG_INFO对象类型</h4>
                  <div>
                     <p>对象类型描述与创建新注册相关联的属性。它是以前名为<code class="codeph">SYS.CHNF$_REG_INFO</code>的类型的同义词。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-1732CD12-503B-43EA-8BB7-522C1FA235CA__GUID-86ED62F1-3D1E-4BD9-BC7F-D43520C5253C">句法</p><pre class="oac_no_warn" dir="ltr">TYPE SYS.CHNF $ _REG_INFO是对象（回调VARCHAR2（20），qosflags NUMBER，超时NUMBER，operations_filter NUMBER，transaction_lag NUMBER，ntfn_grouping_class NUMBER，ntfn_grouping_value NUMBER，ntfn_grouping_type NUMBER，ntfn_grouping_start_time TIMESTAMP WITH TIME ZONE，ntfn_grouping_repeat_count NUMBER）;</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-1732CD12-503B-43EA-8BB7-522C1FA235CA__GUID-E77DE6A5-3169-4B4C-9FE3-1C341E442232">属性</p>
                        <div class="tblformal" id="GUID-1732CD12-503B-43EA-8BB7-522C1FA235CA__GUID-974E7848-EDC2-44B2-B74D-A310E416D3F3">
                           <p class="titleintable">表37-6 TYPE CQ_NOTIFICATION $ _REG_INFO对象类型</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="TYPE CQ_NOTIFICATION $ _REG_INFO对象类型" width="100%" border="1" summary="This table describes the fields of the Object Type CQ_NOTIFICATION$_REG_INFO and briefly describes them" frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="40%" id="d186645e2803">属性</th>
                                    <th align="left" valign="bottom" width="60%" id="d186645e2806">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="40%" id="d186645e2811" headers="d186645e2803 ">
                                       <p><code class="codeph">打回来</code></p>
                                    </td>
                                    <td align="left" valign="top" width="60%" headers="d186645e2811 d186645e2806 ">
                                       <p>要在通知上执行的服务器端PL / SQL过程的名称。原型是<code class="codeph">&lt;call_backname&gt;(ntfnds IN SYS.chnf$_desc)</code></p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="40%" id="d186645e2821" headers="d186645e2803 ">
                                       <p><code class="codeph">qosflags</code></p>
                                    </td>
                                    <td align="left" valign="top" width="60%" headers="d186645e2821 d186645e2806 ">
                                       <p>服务质量标志。可以设置为以下值的<code class="codeph">OR</code> ：</p>
                                       <ul style="list-style-type:disc">
                                          <li>
                                             <p><code class="codeph">QOS_RELIABLE</code> （ <code class="codeph">0x1</code> ）：通知是可靠的（持久的）并且可以在实例死亡后继续存在。这意味着，在Oracle RAC集群中的实例死亡时，幸存的实例将能够传递任何排队的失效。同样，在单实例配置中，可以在实例重新启动时传递挂起的失效。缺点是在将无效消息插入持久性存储时涉及CPU成本/延迟。如果此参数为false，则服务器端CPU和延迟最小化，因为失效被缓冲到内存队列中，但客户端可能会在实例关闭时丢失失效消息。
                                             </p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">QOS_DEREG_NFY</code> （ <code class="codeph">0x2</code> ）：注册将在第一个通知中被清除</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">QOS_ROWIDS</code> （ <code class="codeph">0x4</code> ）：通知需要包含有关已修改的rowid的信息</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">QOS_QUERY</code> <code class="codeph">(0x8)</code> ：指定查询结果更改通知而不是对象更改通知</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">QOS_BEST_EFFORT (0x10)</code>或<code class="codeph">QOS_BEST_EFFORT (0x16)</code> ：可以注册查询的简化版本，并通过一些误报最小化评估。
                                             </p>
                                          </li>
                                       </ul>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="40%" id="d186645e2873" headers="d186645e2803 ">
                                       <p><code class="codeph">超时</code></p>
                                    </td>
                                    <td align="left" valign="top" width="60%" headers="d186645e2873 d186645e2806 ">
                                       <p>如果设置为非零值，则指定数据库自动清除注册的时间（以秒为单位）。如果为零/ <code class="codeph">NULL</code> ，则注册将一直存在，直到明确注销。请注意， <code class="codeph">timeout</code>选项也可以与通知清除（QOS_DEREG_NFY）选项结合使用。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="40%" id="d186645e2887" headers="d186645e2803 ">
                                       <p><code class="codeph">operations_filter</code></p>
                                    </td>
                                    <td align="left" valign="top" width="60%" headers="d186645e2887 d186645e2806 ">
                                       <p>如果非零，则指定要在某些操作上有选择地通知的过滤器。这些标志可用于根据特定的操作类型进行过滤：</p>
                                       <ul style="list-style-type:disc">
                                          <li>
                                             <p>0：通知所有操作（ <code class="codeph">DBMS_CQ_NOTIFICATION</code> 。 <code class="codeph">ALL_OPERATIONS</code> ）</p>
                                          </li>
                                          <li>
                                             <p>0X2：通知上的每个<code class="codeph">INSERT</code> （ <code class="codeph">DBMS_CQ_NOTIFICATION</code> 。 <code class="codeph">INSERTOP</code> ）</p>
                                          </li>
                                          <li>
                                             <p>为0x4：通知上的每个<code class="codeph">UPDATE</code> （ <code class="codeph">DBMS_CQ_NOTIFICATION</code> 。 <code class="codeph">UPDATEOP</code> ）</p>
                                          </li>
                                          <li>
                                             <p>0x8中：通知上的每个<code class="codeph">DELETE</code> （ <code class="codeph">DBMS_CQ_NOTIFICATION</code> 。 <code class="codeph">DELETEOP</code> ）</p>
                                          </li>
                                       </ul>
                                       <p>可以使用按位<code class="codeph">OR</code>指定操作的组合。</p>
                                       <p>警告：此参数将用于对象级别注册，但会忽略查询结果更改注册。要在11g中实现通知流控制，应用程序可以使用“ <code class="codeph">GROUPING</code>通知”选项。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="40%" id="d186645e2951" headers="d186645e2803 ">
                                       <p><code class="codeph">transaction_lag</code></p>
                                    </td>
                                    <td align="left" valign="top" width="60%" headers="d186645e2951 d186645e2806 ">
                                       <p>以交易为单位的连续通知之间存在滞后。可用于指定客户端愿意滞后于数据库的事务/数据库更改的数量。如果为0，则表示客户端需要在生成后立即收到失效消息。</p>
                                       <p><span class="bold">警告</span> ：此参数将用于对象级别注册，但会在查询结果更改通知注册时被忽略。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="40%" id="d186645e2963" headers="d186645e2803 ">
                                       <p><code class="codeph">ntfn_grouping_class</code></p>
                                    </td>
                                    <td align="left" valign="top" width="60%" headers="d186645e2963 d186645e2806 ">
                                       <p>对通知进行分组时，基于该组派生的类。目前，唯一允许的值是<code class="codeph">DBMS_CQ_NOTIFICATION</code> 。 <code class="codeph">NTFN_GROUPING_CLASS_TIME</code>通过该时间将通知分组。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="40%" id="d186645e2977" headers="d186645e2803 ">
                                       <p><code class="codeph">ntfn_grouping_value</code> 
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="60%" headers="d186645e2977 d186645e2806 ">
                                       <p>分组值。这描述了以秒为单位定义组的时间间隔。例如，如果将其设置为900，则意味着每15分钟间隔生成的通知将组合在一起。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="40%" id="d186645e2986" headers="d186645e2803 ">
                                       <p><code class="codeph">ntfn_grouping_type</code> 
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="60%" headers="d186645e2986 d186645e2806 ">
                                       <p>所需的分组类型。它可以是两个允许值之一</p>
                                       <ul style="list-style-type:disc">
                                          <li>
                                             <p><code class="codeph">DBMS_CQ_NOTIFICATION</code> 。 <code class="codeph">NTFN_GROUPING_TYPE_SUMMARY</code> - 组中的所有通知都汇总到一个通知中</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">DBMS_CQ_NOTIFICATION</code> 。 <code class="codeph">NTFN_GROUPING_TYPE_LAST</code> - 仅发布组中的最后一个通知，并丢弃先前的通知</p>
                                          </li>
                                       </ul>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="40%" id="d186645e3012" headers="d186645e2803 ">
                                       <p><code class="codeph">ntfn_grouping_start_time</code> 
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="60%" headers="d186645e3012 d186645e2806 ">
                                       <p>何时开始生成通知。如果指定为<code class="codeph">NULL</code> ，则默认为当前系统生成的时间。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="40%" id="d186645e3024" headers="d186645e2803 ">
                                       <p><code class="codeph">ntfn_grouping_repeat_count</code> 
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="60%" headers="d186645e3024 d186645e2806 ">
                                       <p>通知应重复多少次。将其设置为<code class="codeph">DBMS_CQ_NOTIFICATION</code> 。 <code class="codeph">NTFN_GROUPING_FOREVER</code>接收注册生命周期的通知。如果在注册的生命周期中只需要一定数量的通知，则设置为非零值。
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-1732CD12-503B-43EA-8BB7-522C1FA235CA__GUID-C70B10CA-31A0-45DA-8EBC-CA57669DFF21">使用说明</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>类型声明包含三个其他替代构造函数。在第一种情况下，所有其他参数都默认为其默认值。</p><pre class="oac_no_warn" dir="ltr">TYPE CQ_NOTIFICATION $ _REG_INFO IS OBJECT（回调VARCHAR2（20），qosflags NUMBER，超时NUMBER）;</pre><p>第二个选项适用于先前版本中定义的类型构造函数，并且为了向后兼容性而保留：</p><pre class="oac_no_warn" dir="ltr">TYPE CQ_NOTIFICATION $ _REG_INFO IS OBJECT（回调VARCHAR2（20），qosflags NUMBER，超时NUMBER，operations_filter NUMBER，transaction_lag NUMBER）;</pre><p>第三个定义包含除了不推荐使用的<code class="codeph">transaction_lag</code>之外的所有类型的成员：</p><pre class="oac_no_warn" dir="ltr">TYPE CQ_NOTIFICATION $ _REG_INFO IS OBJECT（回调VARCHAR2（20），qosflags NUMBER，超时NUMBER，operations_filter NUMBER，ntfn_grouping_class NUMBER，ntfn_grouping_value NUMBER，ntfn_grouping_type NUMBER，ntfn_grouping_start_time TIMESTAMP WITH TIME ZONE，ntfn_grouping_repeat_count NUMBER）;</pre></li>
                           <li>
                              <p>响应于数据库更改，执行由“回调”指定的服务器端PL / SQL过程。必须以格式<code class="codeph">s</code> <code class="codeph">chema_name.procedure_name</code>指定PL / SQL过程名称。该程序必须具有以下签名：</p><pre class="oac_no_warn" dir="ltr">程序&lt;procedure_name&gt;（ntfnds IN SYS.chnf $ _desc）</pre><p><code class="codeph">CHNF$_DESC</code>描述了更改通知描述符。
                              </p>
                           </li>
                           <li>
                              <p>必须将init.ora参数<code class="codeph">job_queue_processes</code>设置为非零值才能接收PL / SQL通知，因为在生成通知时，会在作业队列进程内执行指定的过程。
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="ARPLS65659"></a><a id="ARPLS65660"></a><a id="ARPLS65660"></a><a id="ARPLS65659"></a><div class="props_rev_3"><a id="GUID-5F2171F0-D166-4BE2-B2D0-F5C370979FBC" name="GUID-5F2171F0-D166-4BE2-B2D0-F5C370979FBC"></a><h3 id="ARPLS-GUID-5F2171F0-D166-4BE2-B2D0-F5C370979FBC" class="sect3"><span class="enumeration_section">37.7</span> DBMS_CQ_NOTIFICATION子程序摘要</h3>
               <div>
                  <p>该表列出了<code class="codeph">DBMS_CQ_NOTIFICATION</code>子程序并简要描述了它们。
                  </p>
                  <div class="tblformal" id="GUID-5F2171F0-D166-4BE2-B2D0-F5C370979FBC__GUID-0F2E9C0B-2C64-43A9-8D26-AF00158AC204">
                     <p class="titleintable">表37-7 DBMS_CQ_NOTIFICATION包子程序</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="DBMS_CQ_NOTIFICATION包子程序" width="100%" border="1" summary="This table lists the DBMS_CQ_NOTIFICATION subprograms in alphabetical order and briefly describes them." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="31%" id="d186645e3179">子程序</th>
                              <th align="left" valign="bottom" width="69%" id="d186645e3182">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d186645e3187" headers="d186645e3179 ">
                                 <p><a href="DBMS_CQ_NOTIFICATION.html#GUID-C620AA0E-DC5F-43E5-8338-EE7FF0604166" title="此函数返回尝试在注册块中注册的最新查询的queryid。">CQ_NOTIFICATION_QUERYID功能</a></p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d186645e3187 d186645e3182 ">
                                 <p>返回尝试在注册块中注册的最新查询的queryid</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d186645e3199" headers="d186645e3179 ">
                                 <p><a href="DBMS_CQ_NOTIFICATION.html#GUID-A89399FD-CCE6-4B01-83A1-77DD3296EF12" title="此过程描述具有指定注册标识符（ID）的客户端。">注册程序</a></p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d186645e3199 d186645e3182 ">
                                 <p>使用提供的注册标识符（ID）取消订阅客户端</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d186645e3211" headers="d186645e3179 ">
                                 <p><a href="DBMS_CQ_NOTIFICATION.html#GUID-1207FB2C-D487-49C4-A629-2E7155478AC7" title="此过程将对象添加到现有注册标识符（ID）。">ENABLE_REG程序</a></p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d186645e3211 d186645e3182 ">
                                 <p>使用现有注册标识符（ID）开始注册块</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d186645e3223" headers="d186645e3179 ">
                                 <p><a href="DBMS_CQ_NOTIFICATION.html#GUID-C92C877D-5795-4DB4-8C50-E694A15E27FA" title="此过程开始新的注册块。">NEW_REG_START功能</a></p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d186645e3223 d186645e3182 ">
                                 <p>开始新的注册区块</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d186645e3235" headers="d186645e3179 ">
                                 <p><a href="DBMS_CQ_NOTIFICATION.html#GUID-16A5ABD4-2949-498D-ABE3-98AFF9AF3A5F" title="此过程标志着注册块的结束。不会跟踪新执行的查询。">REG_END程序</a></p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d186645e3235 d186645e3182 ">
                                 <p>结束注册边界</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d186645e3247" headers="d186645e3179 ">
                                 <p><a href="DBMS_CQ_NOTIFICATION.html#GUID-B64F324A-89C9-4E5C-9694-16D56E995798" title="如果在事务中修改了表的行，则此过程将配置更改通知中发布的表的最大行数。">SET_ROWID_THRESHOLD过程</a></p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d186645e3247 d186645e3182 ">
                                 <p>如果在事务中修改了表的行，则配置在更改通知中发布的表的最大行数</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
               </div><a id="ARPLS65661"></a><a id="ARPLS65661"></a><div class="props_rev_3"><a id="GUID-C620AA0E-DC5F-43E5-8338-EE7FF0604166" name="GUID-C620AA0E-DC5F-43E5-8338-EE7FF0604166"></a><h4 id="ARPLS-GUID-C620AA0E-DC5F-43E5-8338-EE7FF0604166" class="sect4"><span class="enumeration_section">37.7.1</span> CQ_NOTIFICATION_QUERYID函数</h4>
                  <div>
                     <p>此函数返回尝试在注册块中注册的最新查询的queryid。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-C620AA0E-DC5F-43E5-8338-EE7FF0604166__GUID-F1EE2DFB-0040-4C3D-BECC-64F78E6122B3">句法</p><pre class="oac_no_warn" dir="ltr">DBMS_CQ_NOTIFICATION.CQ_NOTIFICATION_QUERYID返回号码;</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-C620AA0E-DC5F-43E5-8338-EE7FF0604166__GUID-9F2497D0-5775-421E-92BD-E10E0E7A894A">返回值</p>
                        <p>返回最近注册的查询的queryid。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ARPLS65662"></a><a id="ARPLS65663"></a><a id="ARPLS65663"></a><a id="ARPLS65662"></a><div class="props_rev_3"><a id="GUID-A89399FD-CCE6-4B01-83A1-77DD3296EF12" name="GUID-A89399FD-CCE6-4B01-83A1-77DD3296EF12"></a><h4 id="ARPLS-GUID-A89399FD-CCE6-4B01-83A1-77DD3296EF12" class="sect4"><span class="enumeration_section">37.7.2</span>注册程序</h4>
                  <div>
                     <p>此过程描述具有指定注册标识符（ID）的客户端。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-A89399FD-CCE6-4B01-83A1-77DD3296EF12__GUID-89AF8F48-C54C-4F56-BA5A-3F014FD62AE5">句法</p><pre class="oac_no_warn" dir="ltr">DBMS_CQ_NOTIFICATION.DEREGISTER（注册号码）;</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-A89399FD-CCE6-4B01-83A1-77DD3296EF12__GUID-1DECCC99-562D-4D19-99FC-B61A8539B133">参数</p>
                        <div class="tblformal" id="GUID-A89399FD-CCE6-4B01-83A1-77DD3296EF12__GUID-FFF2B2FA-52A4-4B03-9E6A-EBD876D48B47">
                           <p class="titleintable">表37-8 DEREGISTER过程参数</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="DEREGISTER过程参数" width="100%" border="1" summary="This table describes the parameters of DBMS_CQ_NOTIFICATION.DEREGISTER." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="31%" id="d186645e3469">参数</th>
                                    <th align="left" valign="bottom" width="69%" id="d186645e3472">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d186645e3477" headers="d186645e3469 ">
                                       <p><code class="codeph">REGID</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d186645e3477 d186645e3472 ">
                                       <p>客户注册ID</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-A89399FD-CCE6-4B01-83A1-77DD3296EF12__GUID-E4A113F6-CFCA-46FF-A51E-0BCF02C57870">使用说明</p>
                        <p>只有创建注册的用户（或<code class="codeph">SYS</code>用户）才能够取消订阅注册。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ARPLS65664"></a><a id="ARPLS65665"></a><a id="ARPLS65665"></a><a id="ARPLS65664"></a><div class="props_rev_3"><a id="GUID-1207FB2C-D487-49C4-A629-2E7155478AC7" name="GUID-1207FB2C-D487-49C4-A629-2E7155478AC7"></a><h4 id="ARPLS-GUID-1207FB2C-D487-49C4-A629-2E7155478AC7" class="sect4"><span class="enumeration_section">37.7.3</span> ENABLE_REG程序</h4>
                  <div>
                     <p>此过程将对象添加到现有注册标识符（ID）。</p>
                     <div class="section">
                        <p>它类似于创建新注册的界面，除了它需要一个现有的<code class="codeph">regid</code>来添加对象。后续执行查询会导致将查询中引用的对象添加到指定的<code class="codeph">regid</code> ，并在调用<a href="DBMS_CQ_NOTIFICATION.html#GUID-16A5ABD4-2949-498D-ABE3-98AFF9AF3A5F" title="此过程标志着注册块的结束。不会跟踪新执行的查询。">REG_END过程时</a>完成注册。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-1207FB2C-D487-49C4-A629-2E7155478AC7__GUID-ED87B4FD-92A4-4E6B-AEAB-204701858E9A">句法</p><pre class="oac_no_warn" dir="ltr">DBMS_CQ_NOTIFICATION.ENABLE_REG（注册号码）;</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-1207FB2C-D487-49C4-A629-2E7155478AC7__GUID-B847AF91-2E09-4568-BDD5-BC0EE92A3EA1">参数</p>
                        <div class="tblformal" id="GUID-1207FB2C-D487-49C4-A629-2E7155478AC7__GUID-BDE381BF-2F81-4967-9FBD-B6CF894B7CFC">
                           <p class="titleintable">表37-9 ENABLE_REG过程参数</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="ENABLE_REG过程参数" width="100%" border="1" summary="This table describes the parameters of DBMS_CQ_NOTIFICATION.ENABLE_REG.ENABLE_REG." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="31%" id="d186645e3618">参数</th>
                                    <th align="left" valign="bottom" width="69%" id="d186645e3621">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d186645e3626" headers="d186645e3618 ">
                                       <p><code class="codeph">REGID</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d186645e3626 d186645e3621 ">
                                       <p>客户注册ID</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-1207FB2C-D487-49C4-A629-2E7155478AC7__GUID-C2CD1888-A395-4C1E-9A13-FC0EA3A8B890">使用说明</p>
                        <p>只有创建注册的用户才能在注册中添加更多对象。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ARPLS65666"></a><a id="ARPLS65667"></a><a id="ARPLS65667"></a><a id="ARPLS65666"></a><div class="props_rev_3"><a id="GUID-C92C877D-5795-4DB4-8C50-E694A15E27FA" name="GUID-C92C877D-5795-4DB4-8C50-E694A15E27FA"></a><h4 id="ARPLS-GUID-C92C877D-5795-4DB4-8C50-E694A15E27FA" class="sect4"><span class="enumeration_section">37.7.4</span> NEW_REG_START功能</h4>
                  <div>
                     <p>此过程开始新的注册块。</p>
                     <div class="section">
                        <p>在注册块内执行的查询引用的任何对象都被视为有趣的对象并添加到注册中。注册块在调用<code class="codeph">REG_END</code>过程时结束。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-C92C877D-5795-4DB4-8C50-E694A15E27FA__GUID-3DB055C2-796F-476C-86F9-F73834B722A0">句法</p><pre class="oac_no_warn" dir="ltr">DBMS_CQ_NOTIFICATION.NEW_REG_START（regds IN sys.chnf $ _reg_info）返回号码;</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-C92C877D-5795-4DB4-8C50-E694A15E27FA__GUID-33413E35-365B-422C-BED8-BA7487262B83">参数</p>
                        <div class="tblformal" id="GUID-C92C877D-5795-4DB4-8C50-E694A15E27FA__GUID-10612A33-CCC4-4A64-95D1-D97FAC6DDA92">
                           <p class="titleintable">表37-10 NEW_REG_START功能参数</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="NEW_REG_START功能参数" width="100%" border="1" summary="This table describes the parameters of DBMS_CQ_NOTIFICATION.NEW_REG_START." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="31%" id="d186645e3750">参数</th>
                                    <th align="left" valign="bottom" width="69%" id="d186645e3753">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d186645e3758" headers="d186645e3750 ">
                                       <p><code class="codeph">sys.chnf $ _reg_info</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d186645e3758 d186645e3753 ">
                                       <p>注册描述符描述通知处理程序和注册的其他属性</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-C92C877D-5795-4DB4-8C50-E694A15E27FA__GUID-6E8786D7-7C75-42F4-A2D5-EE138144605E">返回值</p>
                        <p>该过程返回一个registration-id，它是数据库为此注册分配的唯一整数。注册ID将在收到的每个注册通知中回显。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-C92C877D-5795-4DB4-8C50-E694A15E27FA__GUID-7377B3AE-7A20-4A4F-B871-1A88FDEE66C0">使用说明</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>注册块内允许的唯一操作是查询（用户希望注册的查询）。不允许DML和DDL操作。</p>
                           </li>
                           <li>
                              <p>注册块是会话属性，并在退出会话时隐式终止。虽然注册块是会话属性，但注册本身是持久数据库实体。一旦创建，注册将一直存在，直到客户端应用程序显式注销或由于某些其他原因（例如权限丢失）而被数据库超时或删除。</p>
                           </li>
                           <li>
                              <p>用户必须具有<code class="codeph">CHANGE NOTIFICATION</code>系统特权以及要注册的任何对象的<code class="codeph">SELECT</code>或<code class="codeph">READ</code>权限。
                              </p>
                           </li>
                           <li>
                              <p>不允许<code class="codeph">SYS</code>用户创建新注册。
                              </p>
                           </li>
                           <li>
                              <p>不允许嵌套注册块。</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ARPLS65668"></a><a id="ARPLS65668"></a><div class="props_rev_3"><a id="GUID-16A5ABD4-2949-498D-ABE3-98AFF9AF3A5F" name="GUID-16A5ABD4-2949-498D-ABE3-98AFF9AF3A5F"></a><h4 id="ARPLS-GUID-16A5ABD4-2949-498D-ABE3-98AFF9AF3A5F" class="sect4"><span class="enumeration_section">37.7.5</span> REG_END程序</h4>
                  <div>
                     <p>此过程标志着注册块的结束。不会跟踪新执行的查询。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-16A5ABD4-2949-498D-ABE3-98AFF9AF3A5F__GUID-E5784804-10B6-4D5C-AF12-242C4CBCCB59">句法</p><pre class="oac_no_warn" dir="ltr">DBMS_CQ_NOTIFICATION.REG_END;</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ARPLS73678"></a><a id="ARPLS73679"></a><a id="ARPLS73679"></a><a id="ARPLS73678"></a><div class="props_rev_3"><a id="GUID-B64F324A-89C9-4E5C-9694-16D56E995798" name="GUID-B64F324A-89C9-4E5C-9694-16D56E995798"></a><h4 id="ARPLS-GUID-B64F324A-89C9-4E5C-9694-16D56E995798" class="sect4"><span class="enumeration_section">37.7.6</span> SET_ROWID_THRESHOLD过程</h4>
                  <div>
                     <p>如果在事务中修改了表的行，则此过程将配置更改通知中发布的表的最大行数。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-B64F324A-89C9-4E5C-9694-16D56E995798__GUID-28387C9D-6F51-4ACB-8101-A81A7299BC49">句法</p><pre class="oac_no_warn" dir="ltr">DBMS_CQ_NOTIFICATION.SET_ROWID_THRESHOLD（tbname IN VARCHAR2，阈值IN NUMBER）;</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-B64F324A-89C9-4E5C-9694-16D56E995798__GUID-5F63C10B-AD56-4453-8238-DD76394F6693">参数</p>
                        <div class="tblformal" id="GUID-B64F324A-89C9-4E5C-9694-16D56E995798__GUID-CB15802B-A442-4EA2-A27B-C1BC4A3EA2D6">
                           <p class="titleintable">表37-11 SET_ROWID_THRESHOLD过程参数</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="SET_ROWID_THRESHOLD过程参数" width="100%" border="1" summary="This table describes the parameters of DBMS_CHANGE_NOTIFICATION.SET_ROWID_THRESHOLD." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="31%" id="d186645e4007">参数</th>
                                    <th align="left" valign="bottom" width="69%" id="d186645e4010">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d186645e4015" headers="d186645e4007 ">
                                       <p><code class="codeph">tbname</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d186645e4015 d186645e4010 ">
                                       <p>表名由<code class="codeph">schemaname.tablename</code>形式的模式名限定</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d186645e4025" headers="d186645e4007 ">
                                       <p><code class="codeph">阈</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d186645e4025 d186645e4010 ">
                                       <p>要在更改通知中发布的表的最大修改行数</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-B64F324A-89C9-4E5C-9694-16D56E995798__GUID-40D18071-93DA-4D83-A900-3E1C80FAC27E">使用说明</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>需要以对象更改粒度或查询结果集粒度注册表以进行更改通知。</p>
                           </li>
                           <li>
                              <p>通过此子程序设置的阈值仅适用于该实例，并且不会在实例启动/关闭期间持续存在。</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>