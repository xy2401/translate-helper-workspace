<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="Oracle Clusterware includes two important components that manage configuration and node membership: Oracle Cluster Registry (OCR), which also includes the local component Oracle Local Registry (OLR), and voting files."></meta>
      <meta name="description" content="Oracle Clusterware includes two important components that manage configuration and node membership: Oracle Cluster Registry (OCR), which also includes the local component Oracle Local Registry (OLR), and voting files."></meta>
      <title>管理Oracle Cluster Registry和Voting Files</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Clusterware Administration and Deployment Guide"></meta>
      <meta property="og:description" content="Oracle Clusterware includes two important components that manage configuration and node membership: Oracle Cluster Registry (OCR), which also includes the local component Oracle Local Registry (OLR), and voting files."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Clusterware Administration and Deployment Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="clusterware-administration-and-deployment-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-04-24T07:05:38-07:00"></meta>
      <meta name="dcterms.title" content="Clusterware Administration and Deployment Guide"></meta>
      <meta name="dcterms.dateCopyrighted" content="2007, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E95727-05"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="rapid-home-provisioning.html" title="Previous" type="text/html"></link>
      <link rel="next" href="adding-and-deleting-cluster-nodes.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="CWADD"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="rapid-home-provisioning.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="adding-and-deleting-cluster-nodes.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">“Clusterware管理和部署指南”</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">管理Oracle Cluster Registry和Voting Files</li>
            </ol>
            <a id="GUID-70E524E1-0FAD-4962-9B9F-0691EAEE7A9F" name="GUID-70E524E1-0FAD-4962-9B9F-0691EAEE7A9F"></a><a id="CWADD92368"></a>
            
            <h2 id="CWADD-GUID-70E524E1-0FAD-4962-9B9F-0691EAEE7A9F" class="sect2"><span class="enumeration_chapter">6</span>管理Oracle Cluster Registry and Voting Files</h2>
         </header>
         <div class="ind">
            <div>
               <p>Oracle Clusterware包括两个管理配置和节点成员资格的重要组件：Oracle Cluster Registry（OCR），它还包括本地组件Oracle Local Registry（OLR）和投票文件。</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p>OCR存储Oracle Clusterware和Oracle RAC数据库配置信息</p>
                  </li>
                  <li>
                     <p>OLR驻留在集群中的每个节点上，并管理每个特定节点的Oracle Clusterware配置信息</p>
                  </li>
                  <li>
                     <p>投票文件存储有关节点成员资格的信息。群集中的所有节点都必须可以访问每个投票文件，以使节点成为群集的成员</p>
                  </li>
               </ul>
               <p></p>
               <div class="infoboxnote" id="GUID-70E524E1-0FAD-4962-9B9F-0691EAEE7A9F__GUID-966156EE-A381-46C5-A60F-9C911005ACCF">
                  <p class="notep1">笔记：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>Oracle Clusterware 12 <span class="italic">c</span>不支持使用原始设备或块设备。要升级到Oracle集群从以前的Oracle集群件12 <span class="italic">c。</span>关于您所使用的原料或块设备，必须迁移OCR和表决文件到Oracle自动存储管理（Oracle ASM的），或在升级前的共享文件系统。
                        </p>
                     </li>
                     <li>
                        <p>您可以在Oracle ASM上存储OCR和投票文件，也可以在独立群集上存储共享文件系统。</p>
                        <p>在Oracle Database 12c第2版（12.2）中，不支持将OCR和Voting磁盘文件直接放置在共享文件系统上。从Oracle Database 19c（19.3）开始，该独立集群的desupport被取消。对于Oracle域服务群集，您必须继续将OCR和表决磁盘文件放在由Oracle ASM管理的磁盘组中。</p>
                     </li>
                  </ul>
               </div>
               <p>Oracle建议您在Oracle Clusterware安装期间配置多个投票文件以提高可用性。如果选择将表决文件放入Oracle ASM磁盘组，则Oracle ASM会确保在使用普通或高冗余磁盘组时配置多个表决文件。如果选择将投票文件存储在共享文件系统上，则选择配置多个投票文件的选项，在这种情况下，您必须根据不同的磁盘指定三个不同的文件系统。</p>
               <p>如有必要，您可以在完成Oracle Clusterware安装过程后动态添加或替换投票文件，而无需停止群集。</p>
               <p>本章包括以下主题：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-20101C89-B87C-49C9-BA63-634376EDB62E" title="使用OCRCONFIG，OCRDUMP和OCRCHECK来管理OCR和Oracle本地注册表（OLR）。">管理Oracle Cluster Registry和Oracle Local Registry</a></p>
                  </li>
                  <li>
                     <p><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-00137A43-61A5-446B-BFEA-D7EFDA535E81" title="如果选择将表决文件存储在Oracle ASM中，则Oracle ASM会将群集的所有表决文件存储在您选择的磁盘组中。作为任何配置更改的一部分，Oracle Clusterware会自动备份OCR中的投票文件数据，并自动将数据还原到您添加的任何投票文件。">管理投票文件</a></p>
                  </li>
               </ul>
            </div><a id="CWADD70700"></a><div class="props_rev_3"><a id="GUID-20101C89-B87C-49C9-BA63-634376EDB62E" name="GUID-20101C89-B87C-49C9-BA63-634376EDB62E"></a><h3 id="CWADD-GUID-20101C89-B87C-49C9-BA63-634376EDB62E" class="sect3">管理Oracle Cluster Registry和Oracle Local Registry</h3>
               <div>
                  <p>使用OCRCONFIG，OCRDUMP和OCRCHECK来管理OCR和Oracle本地注册表（OLR）。</p>
                  <p>OCR包含有关群集中所有Oracle资源的信息。</p>
                  <p>OLR是一个类似于位于群集中每个节点上的OCR的注册表，但包含特定于每个节点的信息。它包含有关Oracle Clusterware的可管理性信息，包括各种服务之间的依赖关系。Oracle High Availability Services使用此信息。OLR位于群集中每个节点上的本地存储上。其默认位置位于<code class="codeph"><span class="variable" translate="no">Grid_home</span> /cdata <span class="variable" translate="no">host_name</span> .olr</code>路径中，其中<code class="codeph"><span class="variable" translate="no">Grid_home</span></code>是Oracle Grid Infrastructure主目录， <code class="codeph"><span class="variable" translate="no">host_name</span></code>是节点的主机名。
                  </p>
                  <p>管理OCR在以下主题中描述：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-94CE3710-770D-45BB-B67B-0A2BC6DBE3AC" title="借助驻留在Oracle ASM磁盘组中的Oracle Clusterware存储，您可以使用Oracle Enterprise Manager管理数据库和集群件存储。">将Oracle Cluster Registry迁移到Oracle自动存储管理</a></p>
                     </li>
                     <li>
                        <p><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-BFBBF4EC-5227-4413-98E0-93B62AA44034" title="使用OCRCONFIG管理OCR位置。">添加_替换_修复_并删除Oracle集群注册表位置</a></p>
                     </li>
                     <li>
                        <p><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-8554ACE4-44DF-4DB5-A939-1DC6D62BAE60">备份Oracle Cluster Registry</a></p>
                     </li>
                     <li>
                        <p><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-648BB199-AFB9-416A-8438-E0331C255E78" title="为您的平台恢复OCR的过程。">还原Oracle Cluster Registry</a></p>
                     </li>
                     <li>
                        <p><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-D3B9559B-054A-4574-854E-9865FEDF5EDD" title="使用OCRDUMP和OCRCHECK实用程序诊断OCR问题。">诊断Oracle Cluster Registry问题</a></p>
                     </li>
                     <li>
                        <p><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-7B87F4D6-4146-4EB0-BD2F-17AED8C5F72E" title="使用此过程在Linux或UNIX系统上导入OCR。使用此过程在Windows系统上导入OCR。">使用导出和导入命令管理Oracle Cluster Registry</a></p>
                     </li>
                     <li>
                        <p><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-4DEA42E9-8E97-474B-AAD8-E5E626FB8B07">Oracle Local Registry</a></p>
                     </li>
                     <li>
                        <p><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-1D3FDBE6-03ED-49B9-A181-2463C59331DA">升级和降级Oracle Cluster Registry Configuration</a></p>
                     </li>
                  </ul>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="oracle-cluster-registry-utility-reference.html#GUID-D881BC9C-74F0-44A5-91EC-0341C1C81ED4" title="使用ocrconfig命令管理OCR。使用此实用程序，您可以导入，导出，添加，删除，还原，覆盖，备份，修复，替换，移动，升级或降级OCR。">关于OCRCONFIG</a></li>
                        <li><a href="oracle-cluster-registry-utility-reference.html#GUID-AAEF4603-0943-434D-8152-5A71BD6976B1">Oracle Cluster Registry故障排除</a></li>
                     </ul>
                  </div>
               </div><a id="CWADD91099"></a><div class="props_rev_3"><a id="GUID-94CE3710-770D-45BB-B67B-0A2BC6DBE3AC" name="GUID-94CE3710-770D-45BB-B67B-0A2BC6DBE3AC"></a><h4 id="CWADD-GUID-94CE3710-770D-45BB-B67B-0A2BC6DBE3AC" class="sect4">将Oracle Cluster Registry迁移到Oracle自动存储管理</h4>
                  <div>
                     <p>借助驻留在Oracle ASM磁盘组中的Oracle Clusterware存储，您可以使用Oracle Enterprise Manager管理数据库和集群件存储。</p>
                     <div class="section">
                        <p>为了提高Oracle Clusterware存储的可管理性，默认情况下，OCR配置为在Oracle Database 12 <span class="italic">c中</span>使用Oracle ASM。但是，如果从先前版本的Oracle Clusterware升级，则可以将OCR迁移到驻留在Oracle ASM上，并利用管理Oracle Clusterware存储的改进。
                        </p>
                        <div class="infoboxnote" id="GUID-94CE3710-770D-45BB-B67B-0A2BC6DBE3AC__GUID-66A5C727-16DC-4472-AB00-6E292BA62DC5">
                           <p class="notep1">注意：</p>
                           <p>如果您从以前版本的Oracle集群到Oracle集群<span class="italic">12c的</span>升级，要存储OCR的Oracle ASM磁盘组中，则必须将<span class="bold">ASM兼容性</span>兼容性属性设置为<code class="codeph">11.2.0.2</code> ，或更高版本。
                           </p>
                        </div>
                        <p>使用OCRCONFIG将OCR迁移到Oracle ASM：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>确保已完成对Oracle Clusterware 12 <span class="italic">c</span>的升级。运行以下命令以验证当前运行的版本：</span><div><pre class="pre codeblock"><code>$ crsctl查询crs activeversion</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>使用Oracle ASM Configuration Assistant（ASMCA）在群集中的所有节点上配置和启动Oracle ASM。</span><div></div>
                        </li>
                        <li class="stepexpand"><span>使用ASMCA创建至少与现有OCR大小相同且至少具有正常冗余的Oracle ASM磁盘组。</span><div>
                              <div class="infoboxnote" id="GUID-94CE3710-770D-45BB-B67B-0A2BC6DBE3AC__GUID-F34C5E10-56DE-40B5-BBE1-C8BAA9F54E0E">
                                 <p class="notep1">注意：</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p>如果OCR存储在具有外部冗余的Oracle ASM磁盘组中，则Oracle建议您将另一个OCR位置添加到另一个磁盘组，以避免在磁盘组中磁盘发生故障时丢失OCR。</p>
                                       <p>Oracle不支持同时在不同的存储类型上存储OCR，例如在Oracle ASM和共享文件系统上存储OCR，但迁移期间除外。</p>
                                    </li>
                                    <li>
                                       <p>如果任何节点上的Oracle ASM实例失败，则该特定节点上的OCR将变为不可用。</p>
                                       <p>如果受Oracle ASM实例故障影响的节点上运行的CRSD进程是<a href="glossary.html#GUID-20E48152-87E0-4668-B8E6-3B0CF469B544"><span class="xrefglossterm">OCR编写器</span></a> ，则大多数OCR位置存储在Oracle ASM中，并且在Oracle ASM实例关闭期间在OCR上尝试I / O此节点，然后CRSD停止并变得不可操作。现在，此特定节点上的群集管理受到影响。
                                       </p>
                                       <p>在任何情况下，一个节点上的一个Oracle ASM实例的故障都不会影响整个集群。</p>
                                    </li>
                                    <li>
                                       <p>确保您创建的Oracle ASM磁盘组已安装在群集中的所有节点上。</p>
                                    </li>
                                 </ul>
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>要将OCR添加到Oracle ASM磁盘组，请确保<a href="glossary.html#GUID-C1F07478-A146-48E0-94E2-A93F6ED7B34A"><span class="xrefglossterm">Oracle Clusterware堆栈</span></a>正在运行并以<code class="codeph">root</code>身份运行以下命令：</span><div><pre class="pre codeblock"><code><span class="variable" translate="no">new_disk_group</span> -add + <span class="variable" translate="no">new_disk_group</span></code></pre><p>如果添加多个OCR位置，则可以多次运行此命令。您最多可以有五个OCR位置。但是，每次连续运行必须指向不同的磁盘组。</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>要删除不再使用的存储配置，请以<code class="codeph">root</code>身份运行以下命令：</span><div><pre class="pre codeblock"><code><span class="variable" translate="no">old_storage_location</span> -delete <span class="variable" translate="no">old_storage_location</span></code></pre><p>对每个配置的OCR运行此命令。</p>
                           </div>
                        </li>
                     </ol>
                     <div class="section">
                        <p>以下示例说明如何使用OCRCONFIG将两个OCR迁移到Oracle ASM。</p><pre class="pre codeblock"><code><span class="variable" translate="no">new_disk_group</span> -add + <span class="variable" translate="no">new_disk_group</span> ＃ocrconfig -delete / ocrdata / ocr_1＃ocrconfig -delete / ocrdata / ocr_2</code></pre><div class="infoboxnote" id="GUID-94CE3710-770D-45BB-B67B-0A2BC6DBE3AC__GUID-88CE998C-0FE6-4468-B3A3-E829ABAC7929">
                           <p class="notep1">注意：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>OCR继承了磁盘组的冗余。如果要为OCR提供高冗余，则必须在创建磁盘组时配置具有高冗余的磁盘组。</p>
                              </li>
                              <li>
                                 <p>Oracle建议您将SPFILE for Oracle ASM放在这个新创建的OCR位置。</p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="../ostmg/diskgroup-compatibility.html#OSTMG-GUID-FBB5AA72-5208-48E1-BD8D-0FD4C6876F34" target="_blank"><span><cite>Oracle自动存储管理管理员指南</cite></span></a></li>
                           <li><a href="../ostmg/manage-asm-asmca.html#OSTMG-GUID-C29F444F-C440-450B-A13B-84CC2147826F" target="_blank"><span><cite>Oracle自动存储管理管理员指南</cite></span></a></li>
                           <li><a href="../ostmg/asmcmd-instance-commands.html#OSTMG-GUID-8946D285-8EAF-4466-8985-BDE95EE5B0C7" target="_blank"><span><cite>Oracle自动存储管理管理员指南</cite></span></a></li>
                           <li><a href="../install-and-upgrade.html" target="_blank"><span><cite>Oracle Grid Infrastructure安装和升级指南</cite></span></a></li>
                        </ul>
                     </div>
                  </div><a id="CWADD91101"></a><div class="props_rev_3"><a id="GUID-45585A36-F1D3-49AC-B2FB-4EE0F608C6DF" name="GUID-45585A36-F1D3-49AC-B2FB-4EE0F608C6DF"></a><h5 id="CWADD-GUID-45585A36-F1D3-49AC-B2FB-4EE0F608C6DF" class="sect5">将Oracle Cluster Registry从Oracle ASM迁移到其他类型的存储</h5>
                     <div>
                        <div class="section">
                           <p>至<a id="d37753e788" class="indexterm-anchor"></a><a id="d37753e792" class="indexterm-anchor"></a><a id="d37753e798" class="indexterm-anchor"></a>将OCR从Oracle ASM迁移到另一种存储类型：</p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>确保已完成对Oracle Clusterware 12 <span class="italic">c</span>的升级。运行以下命令以验证当前运行的版本：</span><div><pre class="oac_no_warn" dir="ltr">$ crsctl查询crs activeversion</pre></div>
                           </li>
                           <li class="stepexpand"><span>使用以下权限在共享或群集文件系统中创建文件： <code class="codeph">root</code> ， <code class="codeph">oinstall</code> ， <code class="codeph">640</code> 。</span><div>
                                 <div class="infoboxnote" id="GUID-45585A36-F1D3-49AC-B2FB-4EE0F608C6DF__GUID-E97B52AF-AF87-49A0-8F2C-1193840235DB">
                                    <p class="notep1">注意：</p>
                                    <p>创建主存储位置的至少两个镜像，以消除OCR的单点故障。 OCR最多支持五个位置。</p>
                                 </div>
                              </div>
                           </li>
                           <li class="stepexpand"><span>确保安装分区上至少有500 MB的空间。</span></li>
                           <li class="stepexpand"><span>确保您创建的文件在群集中的所有节点上都可见。</span></li>
                           <li class="stepexpand"><span>要将文件添加为OCR位置，请确保Oracle Clusterware堆栈正在运行并以<code class="codeph">root</code>身份运行以下命令：</span><div><pre class="oac_no_warn" dir="ltr"><span class="italic">#ocrconfig</span> -add <span class="italic">file_location</span>
</pre><p>如果添加多个OCR位置，则可以多次运行此命令。此命令的每次连续运行必须指向不同的文件位置。</p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>确保未在Oracle ASM磁盘组上配置OCR备份位置。</span><div>
                                 <p>要将OCR备份位置迁移到文件系统，请以<code class="codeph">root</code>身份运行以下命令：</p><pre class="oac_no_warn" dir="ltr"><span class="italic">#ocrconfig</span> -backuploc <span class="italic">file_location</span>
</pre></div>
                           </li>
                           <li class="stepexpand"><span>要删除不再使用的存储配置，请以<code class="codeph">root</code>身份运行以下命令：</span><div><pre class="oac_no_warn" dir="ltr"><span class="italic">#ocrconfig</span> -delete + <span class="italic">asm_disk_group</span>
</pre><p>如果配置了多个OCR位置，则可以多次运行此命令。</p>
                              </div>
                           </li>
                        </ol>
                        <div class="section">
                           <p>以下示例说明如何使用OCRCONFIG将OCR从Oracle ASM迁移到NAS。</p><pre class="oac_no_warn" dir="ltr">#ocrconfig -add / nas / ocr</pre><p>对于未存储在Oracle ASM上的OCR，Oracle建议您在不同设备上镜像OCR。</p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div><a id="CWADD90964"></a><div class="props_rev_3"><a id="GUID-BFBBF4EC-5227-4413-98E0-93B62AA44034" name="GUID-BFBBF4EC-5227-4413-98E0-93B62AA44034"></a><h4 id="CWADD-GUID-BFBBF4EC-5227-4413-98E0-93B62AA44034" class="sect4">添加，替换，修复和删除Oracle Cluster Registry Locations</h4>
                  <div>
                     <p>使用OCRCONFIG管理OCR位置。</p>
                     <p>Oracle Clusterware的Oracle安装过程为您提供了自动镜像OCR的选项。您可以手动将镜像OCR放在共享网络文件系统（NFS）上，也可以放在Oracle认证的任何群集文件系统上。或者，您可以将OCR放在Oracle ASM上，并允许它自动创建镜像，具体取决于您选择的冗余选项。</p>
                     <p>如果您执行以下操作，则可以按照<span class="italic">添加Oracle Cluster Registry Location</span>部分中的说明手动镜像OCR：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>升级到Oracle Clusterware 12 <span class="italic">c</span>但未在升级期间选择镜像OCR</p>
                        </li>
                        <li>
                           <p>在Oracle Clusterware安装期间仅创建一个OCR位置</p>
                        </li>
                     </ul>
                     <p>Oracle建议您配置：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>如果在非镜像或非冗余存储上配置OCR，则至少有三个OCR位置。如果底层存储不是RAID，Oracle强烈建议您镜像OCR。镜像可以帮助防止OCR成为单点故障。</p>
                        </li>
                        <li>
                           <p>如果在Oracle ASM磁盘组上配置了OCR，则至少有两个OCR位置。您应该在两个独立的磁盘组中配置OCR。通常，这是工作区域和恢复区域。</p>
                        </li>
                        <li>
                           <p>如果在镜像硬件或第三方镜像卷上配置了OCR，则至少有两个OCR位置。</p>
                        </li>
                     </ul>
                     <div class="infoboxnote" id="GUID-BFBBF4EC-5227-4413-98E0-93B62AA44034__GUID-5DE55C88-31DB-4FD8-AB66-05624BAEB92C">
                        <p class="notep1">注意：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>如果原始OCR位置不存在，则必须在运行<code class="codeph">ocrconfig -add</code>或<code class="codeph">ocrconfig -replace</code>命令之前创建具有适当权限的空（0字节）OCR位置。
                              </p>
                           </li>
                           <li>
                              <p>确保您在OCR配置中指定的OCR设备存在且这些OCR设备有效。</p>
                           </li>
                           <li>
                              <p>确保您指定的Oracle ASM磁盘组存在且已装入。</p>
                           </li>
                           <li>
                              <p>必须可以从群集中的所有活动节点访问新的OCR文件，设备或磁盘组。</p>
                           </li>
                        </ul>
                     </div>
                     <p>除镜像OCR位置外，管理OCR位置还包括：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-582CE178-A9C2-4685-81BC-E31F1DDBE60C">添加Oracle Cluster Registry Location</a></p>
                        </li>
                        <li>
                           <p><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-7B9D91BC-7E40-4643-AF7A-37D695875BF8">删除Oracle Cluster Registry Location</a></p>
                        </li>
                        <li>
                           <p><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-699F70A0-254C-4FF5-A5AA-334EE9E29FC6">替换Oracle Cluster Registry Location</a></p>
                        </li>
                        <li>
                           <p><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-D8EB7441-378F-41A6-863A-A1706CC48680" title="如果在该节点停止且此节点是群集中的唯一成员时，如果群集配置发生更改，则可能需要修复OCR。">修复本地节点上的Oracle Cluster Registry配置</a></p>
                        </li>
                        <li>
                           <p><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-32DC0B83-6EA9-4FF2-BC39-4EC54728C392">覆盖Oracle Cluster Registry数据丢失保护机制</a></p>
                        </li>
                     </ul>
                     <div class="infoboxnote" id="GUID-BFBBF4EC-5227-4413-98E0-93B62AA44034__GUID-8847F4A1-6D0C-4E3F-9AA3-7DB5A0D85647">
                        <p class="notep1">注意：</p>
                        <p>本节中的操作会影响整个集群中的OCR：操作会更改Linux和UNIX系统上的<code class="codeph">ocr.loc</code>文件中的OCR配置信息以及Windows系统上的注册表项。但是， <code class="codeph">ocrconfig</code>命令无法修改已关闭的节点或未运行Oracle Clusterware的节点的OCR配置信息。
                        </p>
                     </div>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="../install-and-upgrade.html" target="_blank"><span><cite>Oracle Grid Infrastructure安装和升级指南</cite></span></a></li>
                           <li><a href="../ostmg/admin-asm-diskgroups.html#OSTMG-GUID-C455CEB1-0FC3-4DF4-9CD4-25EFA4D2BE01" target="_blank"><span><cite>Oracle自动存储管理管理员指南</cite></span></a></li>
                        </ul>
                     </div>
                  </div><a id="CWADD90965"></a><div class="props_rev_3"><a id="GUID-582CE178-A9C2-4685-81BC-E31F1DDBE60C" name="GUID-582CE178-A9C2-4685-81BC-E31F1DDBE60C"></a><h5 id="CWADD-GUID-582CE178-A9C2-4685-81BC-E31F1DDBE60C" class="sect5">添加Oracle Cluster Registry Location</h5>
                     <div>
                        <div class="section">
                           <p><a id="d37753e1251" class="indexterm-anchor"></a>使用本节中的过程添加OCR位置。Oracle Clusterware最多可以管理五个冗余OCR位置。
                           </p>
                           <div class="infoboxnote" id="GUID-582CE178-A9C2-4685-81BC-E31F1DDBE60C__GUID-37BB2B35-FF05-43BE-ACEB-42ED10626323">
                              <p class="notep1">注意：</p>
                              <p>如果OCR驻留在群集文件系统文件或网络文件系统上，请在执行本节中的过程之前创建一个空（0字节）OCR位置文件。</p>
                           </div>
                           <p>以<code class="codeph">root</code>用户身份运行以下命令，将OCR位置添加到Oracle ASM或其他存储设备：</p><pre class="oac_no_warn" dir="ltr"><span class="italic">#ocrconfig</span> -add + <span class="italic">asm_disk_group</span> | <span class="italic">文件名</span></pre><div class="infoboxnote" id="GUID-582CE178-A9C2-4685-81BC-E31F1DDBE60C__GUID-38E63004-BB3F-44D9-B5C4-BEF799EB241E">
                              <p class="notep1">注意：</p>
                              <p>在Linux和UNIX系统上，您必须是<code class="codeph">root</code>才能运行<code class="codeph">ocrconfig</code>命令。在Windows系统上，用户必须是管理员组的成员。
                              </p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="CWADD90968"></a><div class="props_rev_3"><a id="GUID-7B9D91BC-7E40-4643-AF7A-37D695875BF8" name="GUID-7B9D91BC-7E40-4643-AF7A-37D695875BF8"></a><h5 id="CWADD-GUID-7B9D91BC-7E40-4643-AF7A-37D695875BF8" class="sect5">删除Oracle Cluster Registry Location</h5>
                     <div>
                        <div class="section">
                           <p>要删除OCR位置或失败的OCR位置，至少有一个其他OCR必须在线。<a id="d37753e1400" class="indexterm-anchor"></a>您可以删除OCR位置以减少与OCR相关的开销或停止镜像OCR，因为您已将OCR移至冗余存储（如RAID）。</p>
                           <p>以<code class="codeph">root</code>用户身份执行以下过程以从Oracle Clusterware环境中删除OCR位置：</p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>确保您要删除的OCR位置以外的<span class="italic">至少一个</span> OCR位置处于联机状态。</span><div>
                                 <div class="infoboxnote" id="GUID-7B9D91BC-7E40-4643-AF7A-37D695875BF8__GUID-7D6108A3-07D5-42D4-8417-E263772F5E62">
                                    <p class="notep1">警告：</p>
                                    <p>除非有至少一个其他活性OCR位置网上<span class="italic">不要</span>执行此OCR取出过程。
                                    </p>
                                 </div>
                              </div>
                           </li>
                           <li class="stepexpand"><span>在群集中的任何节点上运行以下命令，以从Oracle ASM或其他位置删除OCR位置：</span><div><pre class="oac_no_warn" dir="ltr"><span class="italic">#ocrconfig</span> -delete + <span class="italic">ASM_disk_group</span> | <span class="italic">文件名</span>
</pre><p><span class="italic"><code class="codeph">file_name</code></span>变量可以是设备名称或文件名。此命令更新运行Oracle Clusterware的所有节点上的OCR配置。
                                 </p>
                                 <div class="infoboxnote" id="GUID-7B9D91BC-7E40-4643-AF7A-37D695875BF8__GUID-A2F356E2-35C3-449F-B959-269047EDC389">
                                    <p class="notep1">注意：</p>
                                    <p>无法删除唯一配置的Oracle ASM OCR位置，该位置位于与Oracle ASM OCR备份位置不同的Oracle ASM磁盘组上。</p>
                                 </div>
                              </div>
                           </li>
                        </ol>
                     </div>
                  </div><a id="CWADD91264"></a><a id="CWADD90966"></a><div class="props_rev_3"><a id="GUID-699F70A0-254C-4FF5-A5AA-334EE9E29FC6" name="GUID-699F70A0-254C-4FF5-A5AA-334EE9E29FC6"></a><h5 id="CWADD-GUID-699F70A0-254C-4FF5-A5AA-334EE9E29FC6" class="sect5">替换Oracle Cluster Registry Location</h5>
                     <div>
                        <div class="section">
                           <p>如果必须更改现有OCR位置，或将失败的OCR位置更改为工作位置，则可以使用以下过程（如果所有剩余的OCR位置保持联机状态）。<code class="codeph">ocrconfig -replace</code>命令要求至少配置两个OCR位置。
                           </p>
                           <p><span class="bold">要更改Oracle Cluster Registry位置：</span></p>
                           <p>完成以下过程：</p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>使用OCRCHECK实用程序使用以下命令验证除了要替换的OCR之外的OCR副本是否<span class="italic">在线</span> ：</span><div><pre class="pre codeblock"><code>$ ocrcheck</code></pre><p>OCRCHECK显示已注册的所有OCR位置以及它们是否可用（在线）。如果OCR位置突然变得不可用，则Oracle Clusterware可能需要很短的时间才能显示状态的变化。</p>
                                 <div class="infoboxnote" id="GUID-699F70A0-254C-4FF5-A5AA-334EE9E29FC6__GUID-ADDAFD5F-2790-4346-B361-ACB3B2A9E50D">
                                    <p class="notep1">注意：</p>
                                    <p>您要<span class="italic">替换</span>的OCR位置可以是在线或离线。
                                    </p>
                                 </div>
                              </div>
                           </li>
                           <li class="stepexpand"><span>使用以下命令验证Oracle Clusterware是否在要执行替换操作的节点上运行：</span><div><pre class="pre codeblock"><code>$ crsctl check crs</code></pre></div>
                           </li>
                           <li class="stepexpand"><span>以<code class="codeph">root</code>身份运行以下命令，使用<code class="codeph"><span class="variable" translate="no">destination_file</span></code>或<code class="codeph">+ <span class="variable" translate="no">ASM_disk_group</span></code>替换当前OCR位置，以指示当前和目标OCR位置：</span><div><pre class="pre codeblock"><code><span class="variable" translate="no">new_OCR_location</span> -replace <span class="variable" translate="no">current_OCR_location</span> -replacement <span class="variable" translate="no">new_OCR_location</span></code></pre><p>如果配置的OCR位置少于两个，则上述命令将失败。</p>
                                 <p>如果您只配置了一个OCR位置并在线，则必须先添加新位置，然后删除失败位置，如下所示：</p><pre class="pre codeblock"><code><span class="variable" translate="no">new_OCR_location</span> -add <span class="variable" translate="no">new_OCR_location</span> ＃ocrconfig -delete <span class="variable" translate="no">current_OCR_location</span></code></pre><div class="infoboxnote" id="GUID-699F70A0-254C-4FF5-A5AA-334EE9E29FC6__GUID-732E1A96-DB40-47ED-B2E8-E5C739059BA3">
                                    <p class="notep1">注意：</p>
                                    <p>如果在停止OCR所在的节点时集群配置发生更改，并且Oracle Clusterware堆栈正在其他节点上运行，则OCR会检测配置更改并通过更改<code class="codeph">ocr.loc</code>文件的内容来自行更正配置。
                                    </p>
                                 </div>
                              </div>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>相关话题</strong></p>
                           <ul>
                              <li><a href="../ostmg/asm-migration-rman.html#OSTMG-GUID-EE232095-823A-4717-8629-75E6A750FCDB" target="_blank"><span><cite>Oracle自动存储管理管理员指南</cite></span></a></li>
                           </ul>
                        </div>
                     </div>
                  </div><a id="CWADD90967"></a><div class="props_rev_3"><a id="GUID-D8EB7441-378F-41A6-863A-A1706CC48680" name="GUID-D8EB7441-378F-41A6-863A-A1706CC48680"></a><h5 id="CWADD-GUID-D8EB7441-378F-41A6-863A-A1706CC48680" class="sect5">修复本地节点上的Oracle Cluster Registry配置</h5>
                     <div>
                        <p>如果在该节点停止且此节点是群集中的唯一成员时，如果群集配置发生更改，则可能需要修复OCR。</p>
                        <div class="section">
                           <p>修复OCR涉及添加，删除或替换OCR位置。例如，如果关闭了当前Oracle RAC集群中的任何节点，则必须更新已停止节点上的OCR配置，以便在重新启动节点后让该节点重新加入集群。在重新启动的节点上以<code class="codeph">root</code>身份使用以下命令语法，您可以使用<code class="codeph"><span class="variable" translate="no">destination_file</span></code>或<code class="codeph">+ <span class="variable" translate="no">ASM_disk_group</span></code>来指示当前和目标OCR位置：</p><pre class="pre codeblock"><code>#ocrconfig -repair -replace <span class="variable" translate="no">current_OCR_location</span> -replacement <span class="variable" translate="no">target_OCR_location</span></code></pre><p>此操作仅更改运行此命令的节点上的OCR。例如，如果OCR位置是<code class="codeph">/dev/sde1</code> ，则在此节点上使用命令语法<code class="codeph">ocrconfig -repair -add /dev/sde1</code>来修复该节点上的OCR。
                           </p>
                           <div class="infoboxnote" id="GUID-D8EB7441-378F-41A6-863A-A1706CC48680__GUID-A74E483B-E875-44D4-B578-E085C4F07095">
                              <p class="notep1">注意：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>您无法在运行Oracle Cluster Ready Service守护程序的节点上修复OCR配置。</p>
                                 </li>
                                 <li>
                                    <p>使用<code class="codeph">ocrconfig -repair</code>在停止的节点上修复OCR时，必须提供与其他节点上的OCR文件名相同的OCR文件名（应区分大小写）。
                                    </p>
                                 </li>
                                 <li>
                                    <p>如果你运行<code class="codeph">ocrconfig -add | -repair | -replace</code>命令，然后必须可以访问要添加的设备，文件或Oracle ASM磁盘组。这意味着必须存在设备。您必须创建一个空（0字节）OCR位置，或者必须存在并装入Oracle ASM磁盘组。
                                    </p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>相关话题</strong></p>
                           <ul>
                              <li><a href="oracle-cluster-registry-utility-reference.html#GUID-2029B8DE-F140-43EF-B4F8-26CC7D31D179" title="将OCR位置添加到Oracle自动存储管理（Oracle ASM）磁盘组。指定OCR备份目录位置。将OCR备份文件从一个位置复制到另一个位置。删除OCR设备或文件。只有root脚本才能使用此命令将OCR降级到较早指定的版本。将OCR的内容导出到目标文件。将导出OCR内容的目标文件的内容导入OCR。根据需要将OCR备份到特定位置。使用当前OCR配置信息覆盖OCR元数据中的OCR配置，该信息位于运行此命令的节点上。在运行此命令的节点上修复OCR配置。将OCR位置替换为Oracle自动存储管理（Oracle ASM）磁盘组。从自动创建的OCR备份文件中恢复OCR。显示所有可用备份。显示OCR和OLR备份文件的备份位置。从先前版本升级OCR。">OCRCONFIG命令参考</a></li>
                              <li><a href="../ostmg/admin-asm-diskgroups.html#OSTMG-GUID-C455CEB1-0FC3-4DF4-9CD4-25EFA4D2BE01" target="_blank"><span><cite>Oracle自动存储管理管理员指南</cite></span></a></li>
                           </ul>
                        </div>
                     </div>
                  </div><a id="CWADD90969"></a><div class="props_rev_3"><a id="GUID-32DC0B83-6EA9-4FF2-BC39-4EC54728C392" name="GUID-32DC0B83-6EA9-4FF2-BC39-4EC54728C392"></a><h5 id="CWADD-GUID-32DC0B83-6EA9-4FF2-BC39-4EC54728C392" class="sect5">覆盖Oracle Cluster Registry数据丢失保护机制</h5>
                     <div>
                        <div class="section">
                           <p>OCR <a id="d37753e1959" class="indexterm-anchor"></a>有一种机制可以防止意外覆盖造成的数据丢失。如果配置镜像OCR，并且Oracle Clusterware无法访问镜像OCR位置，并且无法验证可用OCR位置是否包含最新配置，则Oracle Clusterware会阻止对可用OCR位置的进一步修改。此外，该过程通过禁止Oracle Clusterware在只有一个OCR可用的节点上启动来防止覆盖。在这种情况下，Oracle数据库会在Oracle Enterprise Manager，Oracle Clusterware警报日志文件或两者中显示警报消息。如果此问题仅对一个节点是本地问题，则可以使用其他节点启动集群数据库。
                           </p>
                           <p>但是，如果您无法在环境中启动任何群集节点，并且既无法修复OCR也无法恢复对所有OCR位置的访问，则可以覆盖保护机制。通过以下列表中描述的过程，您可以使用可用的OCR位置启动集群。但是，覆盖保护机制可能会导致在创建先前已知的良好状态时丢失的数据丢失。</p>
                           <div class="infoboxnote" id="GUID-32DC0B83-6EA9-4FF2-BC39-4EC54728C392__GUID-E2952B5E-2C4D-4B31-8721-26221FBB6400">
                              <p class="notep1">警告：</p>
                              <p>使用以下过程覆盖OCR可能导致在对当前可访问的OCR进行的最后一次已知良好OCR更新时间与执行覆盖的时间之间进行的OCR更新丢失。换句话说，如果用于执行覆盖的OCR位置不包含群集环境的最新配置更新，则运行<code class="codeph">ocrconfig -overwrite</code>命令可能会导致数据丢失。
                              </p>
                           </div>
                           <p>如果节点无法启动<span class="italic">且</span>警报日志包含，请执行以下过程以覆盖OCR <a id="d37753e1977" class="indexterm-anchor"></a> CLSD-1009和<a id="d37753e1982" class="indexterm-anchor"></a> CLSD-1011消息。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>尝试解决CLSD-1009和CLSD-1011消息的原因。</span><div>
                                 <p>将节点的OCR配置（Linux和UNIX系统上的<code class="codeph">ocr.loc</code>和Windows系统上的Registry）与运行Oracle Clusterware的其他节点进行比较。
                                 </p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p>如果配置不匹配，请运行<code class="codeph">ocrconfig -repair</code> 。
                                       </p>
                                    </li>
                                    <li>
                                       <p>如果配置匹配，请确保该节点可以通过在Linux和UNIX系统上运行<code class="codeph">ls</code>命令来访问所有已配置的OCR。在Windows上，如果OCR位置是文件，请使用<code class="codeph">dir</code>命令并运行<code class="codeph">GuiOracleObjectManager.exe</code>以验证具有该名称的群集部分是否存在。
                                       </p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li class="stepexpand"><span>确保最新的OCR包含最新的OCR更新。</span><div>
                                 <p>查看<code class="codeph">ocrdump</code>命令的输出并确定它是否具有最新更新。
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>如果无法解决导致CLSD消息的问题，请运行命令<code class="codeph">ocrconfig -overwrite</code>以启动节点。</span></li>
                        </ol>
                     </div>
                  </div>
               </div><a id="CWADD90970"></a><div class="props_rev_3"><a id="GUID-8554ACE4-44DF-4DB5-A939-1DC6D62BAE60" name="GUID-8554ACE4-44DF-4DB5-A939-1DC6D62BAE60"></a><h4 id="CWADD-GUID-8554ACE4-44DF-4DB5-A939-1DC6D62BAE60" class="sect4">备份Oracle Cluster Registry</h4>
                  <div>
                     <p>本节介绍<a id="d37753e2149" class="indexterm-anchor"></a>如何备份OCR内容并将其用于恢复。第一种方法使用自动生成的OCR副本，第二种方法允许您手动发出备份命令：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><span class="bold">自动备份</span> ： <a id="d37753e2160" class="indexterm-anchor"></a> Oracle Clusterware每四个小时自动创建一次OCR备份。在任何时候，Oracle数据库始终保留OCR的最后三个备份副本。创建备份的CRSD进程还会为每个<span class="italic">完整日期</span>和<span class="italic">每周后</span>创建并保留OCR备份。您无法自定义备份频率或Oracle数据库保留的文件数。
                           </p>
                        </li>
                        <li>
                           <p><span class="bold">手动备份</span> ：运行<a id="d37753e2176" class="indexterm-anchor"></a>在Oracle Clusterware堆栈启动并运行的节点上的<code class="codeph">ocrconfig -manualbackup</code>命令，以强制Oracle Clusterware随时执行OCR备份，而不是等待自动备份。您必须以具有管理权限的用户身份运行该命令。当您希望按需获取二进制备份时（例如在更改OCR之前），- <code class="codeph">-manualbackup</code>选项特别有用。 OLR仅支持手动备份。
                           </p>
                        </li>
                     </ul>
                     <p>当群集中的所有节点上的集群件堆栈关闭时， <code class="codeph">ocrconfig -showbackup</code>命令列出的备份可能因节点而异。
                     </p>
                     <div class="infoboxnote" id="GUID-8554ACE4-44DF-4DB5-A939-1DC6D62BAE60__GUID-2E25EC79-BC7D-4B7A-902A-914A9061E834">
                        <p class="notep1">注意：</p>
                        <p>在节点上安装或升级Oracle Clusterware或向集群添加节点后，当<code class="codeph">root.sh</code>脚本完成后，它将备份OLR。</p>
                     </div>
                     <p>本节包括以下主题：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-6921B0DB-4C97-48D6-9128-373544663DCF">列出备份文件</a></p>
                        </li>
                        <li>
                           <p><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-619A16D6-AF79-4A48-950B-673F2A496408">更改备份位置</a></p>
                        </li>
                     </ul>
                  </div>
                  <div class="props_rev_3"><a id="GUID-6921B0DB-4C97-48D6-9128-373544663DCF" name="GUID-6921B0DB-4C97-48D6-9128-373544663DCF"></a><h5 id="CWADD-GUID-6921B0DB-4C97-48D6-9128-373544663DCF" class="sect5">列出备份文件</h5>
                     <div>
                        <div class="section">
                           <p>运行以下命令列出备份文件：</p><pre class="oac_no_warn" dir="ltr">ocrconfig -showbackup</pre><p><code class="codeph">ocrconfig -showbackup</code>命令显示Oracle Clusterware创建的备份文件的备份位置，时间戳和原始节点名称。默认情况下， <code class="codeph">-showbackup</code>选项显示自动和手动备份的信息，但您可以包括<code class="codeph">auto</code>或<code class="codeph">manual</code>标志，分别仅显示自动备份信息或仅显示手动备份信息。
                           </p>
                           <p>运行以下命令以检查内容并验证备份文件的完整性：</p><pre class="oac_no_warn" dir="ltr">ocrdump -backupfile <span class="italic">backup_file_name</span>
</pre><p>您可以使用任何备份软件将每天至少一次自动生成的备份文件复制到主OCR所在的其他设备。</p>
                           <p>从Oracle Clusterware 12 <span class="italic">c第</span> 2版（12.2）开始，生成备份的默认位置是Oracle ASM磁盘组，您可以在Oracle ASM磁盘组之间进行更改，但<span class="italic">无法</span>更改为本地文件系统。Oracle建议您使用标准操作系统或第三方工具将使用OCRCONFIG实用程序创建的备份文件包含在操作系统备份中。
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
                  <div class="props_rev_3"><a id="GUID-619A16D6-AF79-4A48-950B-673F2A496408" name="GUID-619A16D6-AF79-4A48-950B-673F2A496408"></a><h5 id="CWADD-GUID-619A16D6-AF79-4A48-950B-673F2A496408" class="sect5">更改备份位置</h5>
                     <div>
                        <div class="section">
                           <p>运行以下命令以更改OCR创建备份的位置：</p><pre class="pre codeblock"><code>#ocrconfig -backuploc <span class="variable" translate="no">file_name</span></code></pre><p>上述命令中的<code class="codeph"><span class="variable" translate="no">file_name</span></code>变量可以是所有节点都可以访问的完整目录路径名，也可以是安装在所有节点上的Oracle ASM磁盘组。在将OCR备份位置更改为Oracle ASM磁盘组之前，必须将OCR迁移到Oracle ASM。仅当单独磁盘组中至少有一个Oracle ASM OCR位置时，才能将OCR备份位置更改为Oracle ASM磁盘组。
                           </p>
                           <p>例如，要在目录中指定OCR备份位置：</p><pre class="pre codeblock"><code><span class="variable" translate="no">Grid_home</span> -backuploc <span class="variable" translate="no">Grid_home</span> / cdata / cluster3</code></pre><p>要在Oracle ASM磁盘组中指定OCR备份位置，请执行以下操作：</p><pre class="pre codeblock"><code>#ocrconfig -backuploc + bkupdg</code></pre><div class="infoboxnote" id="GUID-619A16D6-AF79-4A48-950B-673F2A496408__GUID-341FAD09-B726-48BC-8F44-5A5D7299304C">
                              <p class="notep1">注意：</p>
                              <p>在Linux和UNIX系统上，您必须是<code class="codeph">root</code>用户才能运行大多数但不是所有<code class="codeph">ocrconfig</code>命令选项。在Windows系统上，用户必须是管理员组的成员。
                              </p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>相关话题</strong></p>
                           <ul>
                              <li><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-7B87F4D6-4146-4EB0-BD2F-17AED8C5F72E" title="使用此过程在Linux或UNIX系统上导入OCR。使用此过程在Windows系统上导入OCR。">使用导出和导入命令管理Oracle Cluster Registry</a></li>
                              <li><a href="oracle-cluster-registry-utility-reference.html#GUID-2029B8DE-F140-43EF-B4F8-26CC7D31D179" title="将OCR位置添加到Oracle自动存储管理（Oracle ASM）磁盘组。指定OCR备份目录位置。将OCR备份文件从一个位置复制到另一个位置。删除OCR设备或文件。只有root脚本才能使用此命令将OCR降级到较早指定的版本。将OCR的内容导出到目标文件。将导出OCR内容的目标文件的内容导入OCR。根据需要将OCR备份到特定位置。使用当前OCR配置信息覆盖OCR元数据中的OCR配置，该信息位于运行此命令的节点上。在运行此命令的节点上修复OCR配置。将OCR位置替换为Oracle自动存储管理（Oracle ASM）磁盘组。从自动创建的OCR备份文件中恢复OCR。显示所有可用备份。显示OCR和OLR备份文件的备份位置。从先前版本升级OCR。">OCRCONFIG命令参考</a></li>
                           </ul>
                        </div>
                     </div>
                  </div>
               </div><a id="CWADD92002"></a><div class="props_rev_3"><a id="GUID-648BB199-AFB9-416A-8438-E0331C255E78" name="GUID-648BB199-AFB9-416A-8438-E0331C255E78"></a><h4 id="CWADD-GUID-648BB199-AFB9-416A-8438-E0331C255E78" class="sect4">还原Oracle Cluster Registry</h4>
                  <div>
                     <p>为您的平台恢复OCR的过程。</p>
                     <p>如果资源出现故障，则在尝试还原OCR之前，请重新启动资源。作为OCR失败的确定验证，运行<code class="codeph">ocrcheck</code>并且如果命令返回失败消息，则主OCR和OCR镜像都失败。
                     </p>
                     <div class="infoboxnote" id="GUID-648BB199-AFB9-416A-8438-E0331C255E78__GUID-9C9E0B85-EE30-4845-A0BF-7D7A7BB4A0C8">
                        <p class="notep1">注意：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>您<span class="italic">无法</span>使用<code class="codeph">-import</code>选项从OCR备份文件还原配置，该选项在<span class="q">“使用导出和导入命令管理Oracle Cluster Registry”中进行了说明</span> 。您<span class="italic">必须</span>使用<code class="codeph">-restore</code>选项，如以下部分所述。
                              </p>
                           </li>
                           <li>
                              <p>如果将OCR存储在Oracle ASM磁盘组上且磁盘组不可用，则必须恢复并装入Oracle ASM磁盘组。</p>
                           </li>
                        </ul>
                     </div>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-3ADF0C33-9B4C-4FC5-88C5-4C736159E988" title="使用此过程可在Linux或UNIX系统上还原OCR。">在Linux或UNIX系统上还原Oracle Cluster Registry</a></p>
                        </li>
                        <li>
                           <p><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-7372F903-4BC0-4FB1-80AA-33B7BBD726EB" title="使用此过程在Windows系统上还原OCR。">在Windows系统上还原Oracle Cluster Registry</a></p>
                        </li>
                        <li>
                           <p><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-F15F9F72-90F3-456D-8E55-5E3FA0959392" title="使用此过程在Oracle Restart环境中还原OCR。">在Oracle Restart Environment中恢复Oracle Cluster Registry</a></p>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-7B87F4D6-4146-4EB0-BD2F-17AED8C5F72E" title="使用此过程在Linux或UNIX系统上导入OCR。使用此过程在Windows系统上导入OCR。">使用导出和导入命令管理Oracle Cluster Registry</a></li>
                           <li><a href="../ostmg/admin-asm-diskgroups.html#OSTMG-GUID-C455CEB1-0FC3-4DF4-9CD4-25EFA4D2BE01" target="_blank"><span><cite>Oracle自动存储管理管理员指南</cite></span></a></li>
                        </ul>
                     </div>
                  </div>
                  <div class="props_rev_3"><a id="GUID-3ADF0C33-9B4C-4FC5-88C5-4C736159E988" name="GUID-3ADF0C33-9B4C-4FC5-88C5-4C736159E988"></a><h5 id="CWADD-GUID-3ADF0C33-9B4C-4FC5-88C5-4C736159E988" class="sect5">在Linux或UNIX系统上还原Oracle Cluster Registry</h5>
                     <div>
                        <p>使用此过程可在Linux或UNIX系统上还原OCR。</p>
                        <div class="section">
                           <p>如果要在Oracle ASM磁盘组上存储OCR，并且该磁盘组已损坏，则必须使用Oracle ASM实用程序还原Oracle ASM磁盘组，然后在恢复OCR之前再次装入磁盘组。按照以下过程中的说明运行<code class="codeph">ocrconfig -restore</code>命令恢复OCR。
                           </p>
                           <div class="infoboxnote" id="GUID-3ADF0C33-9B4C-4FC5-88C5-4C736159E988__GUID-BC1A351D-E254-47B0-9E1F-20728249A8DE">
                              <p class="notep1">注意：</p>
                              <p>如果原始OCR位置不存在，则必须在运行<code class="codeph">ocrconfig -restore</code>命令之前创建一个与原始OCR位置同名的空（0字节）OCR位置。
                              </p>
                           </div>
                           <p>使用以下过程在Linux或UNIX系统上还原OCR：</p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>通过在一个节点上运行以下命令来列出群集中的节点：</span><div><pre class="pre codeblock"><code>$ olsnodes</code></pre></div>
                           </li>
                           <li class="stepexpand"><span>根据OCR是位于Oracle ASM磁盘组还是位于网络连接存储（NAS）上，通过在所有节点上以root用户身份运行以下命令之一来停止Oracle Clusterware：</span><div>
                                 <p>如果OCR位于Oracle ASM磁盘组中，请停止Oracle Clusterware守护程序：</p><pre class="pre codeblock"><code>#crsctl停止crs</code></pre><p>如果上述命令由于OCR损坏而返回任何错误，则通过在所有节点上以<code class="codeph">root</code>身份运行以下命令来强制停止Oracle Clusterware：</p><pre class="pre codeblock"><code>#crsctl stop crs -f</code></pre></div>
                           </li>
                           <li class="stepexpand"><span>如果要将OCR还原到群集文件系统或网络文件系统，请以<code class="codeph">root</code>身份运行以下命令以使用可在<span class="q">“列出备份文件”中</span>标识的OCR备份还原OCR：</span><div><pre class="pre codeblock"><code>#ocrconfig -restore <span class="variable" translate="no">file_name</span></code></pre><div class="infoboxnote" id="GUID-3ADF0C33-9B4C-4FC5-88C5-4C736159E988__GUID-CB3047A5-9646-4C48-B2EA-F0658F23A30B">
                                    <p class="notep1">注意：</p>
                                    <p>如果OCR备份文件位于Oracle ASM磁盘组中，请确保磁盘组存在且已装入。</p>
                                 </div>
                                 <p>完成此步骤后，请继续执行步骤<a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-3ADF0C33-9B4C-4FC5-88C5-4C736159E988__CHDCIGEE">11</a> 。
                                 </p>
                                 <p>如果<span class="italic">不</span>将OCR还原到群集文件系统或网络文件系统，请继续执行下一步。
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>通过以<code class="codeph">root</code>身份运行以下命令，以独占模式在一个节点上启动Oracle Clusterware堆栈：</span><div><pre class="pre codeblock"><code>#crsctl start crs -excl -nocrs</code></pre><p><code class="codeph">-nocrs</code>选项可确保CRSD进程和OCR不会从Oracle Clusterware堆栈的其余部分开始。
                                 </p>
                                 <p>忽略显示的任何错误。</p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>通过运行以下命令检查CRSD是否正在运行：</span><div><pre class="pre codeblock"><code>$ crsctl status resource ora.crsd -init</code></pre><p>如果CRSD正在运行，请以<code class="codeph">root</code>身份运行以下命令来停止它：</p><pre class="pre codeblock"><code>#crsctl stop resource ora.crsd -init</code></pre><div class="infoboxnote" id="GUID-3ADF0C33-9B4C-4FC5-88C5-4C736159E988__GUID-A1CDB843-0497-4251-8FE9-FB71879AF66B">
                                    <p class="notep1">警告：</p>
                                    <p><span class="italic">不要</span>将<code class="codeph">-init</code>标志与任何其他命令一起使用，除非My Oracle Support指示这样做。
                                    </p>
                                 </div>
                              </div>
                           </li>
                           <li class="stepexpand"><span>要将OCR还原到Oracle ASM磁盘组，必须首先使用与要还原的磁盘组同名的SQL * Plus创建磁盘组，然后将其装入本地节点。</span><div>
                                 <p>如果无法在本地装入磁盘组，请运行以下SQL * Plus命令：</p><pre class="pre codeblock"><code>SQL&gt; drop diskgroup <span class="variable" translate="no">disk_group_name</span> force包含内容;</code></pre></div>
                           </li>
                           <li class="stepexpand"><span>使用OCR备份还原OCR，您可以通过以<code class="codeph">root</code>身份运行以下命令在<span class="q">“列出备份文件”中</span>进行识别：</span><div><pre class="pre codeblock"><code>#ocrconfig -restore <span class="variable" translate="no">file_name</span></code></pre><div class="infoboxnote" id="GUID-3ADF0C33-9B4C-4FC5-88C5-4C736159E988__GUID-3F136B1E-8331-4E8D-96F0-8BD82A11B8A5">
                                    <p class="notep1">注意：</p>
                                    <ul style="list-style-type:disc">
                                       <li>
                                          <p>如果原始OCR位置不存在，则必须在运行<code class="codeph">ocrconfig -restore</code>命令之前创建一个空（0字节）OCR位置。
                                          </p>
                                       </li>
                                       <li>
                                          <p>确保您在OCR配置中指定的OCR设备存在且这些OCR设备有效。</p>
                                       </li>
                                       <li>
                                          <p>如果在Oracle ASM磁盘组中配置了OCR，请确保存在并装入Oracle ASM磁盘组。</p>
                                       </li>
                                       <li>
                                          <p>如果OCR备份文件位于Oracle ASM磁盘组中，请确保磁盘组存在且已装入。</p>
                                       </li>
                                    </ul>
                                 </div>
                                 <div class="infoboxnotealso" id="GUID-3ADF0C33-9B4C-4FC5-88C5-4C736159E988__GUID-4EBBE40F-34D3-45EB-A050-0091E2D33DDA">
                                    <p class="notep1">也可以看看：</p>
                                    <p>有关创建OCR的信息，请参阅<span><cite>“Oracle Grid Infrastructure安装和升级指南”</cite></span></p>
                                 </div>
                              </div>
                           </li>
                           <li class="stepexpand"><span>验证OCR的完整性：</span><div><pre class="pre codeblock"><code>#ocrcheck</code></pre></div>
                           </li>
                           <li class="stepexpand"><span>在独占模式下运行的节点上停止Oracle Clusterware：</span><div><pre class="pre codeblock"><code>#crsctl stop crs -f</code></pre></div>
                           </li>
                           <li class="stepexpand"><span>在<span class="italic">没有</span>运行<code class="codeph">ocrconfig -restore</code>命令的集群中的所有节点上以<code class="codeph">root</code> <code class="codeph">ocrconfig -repair -replace</code>运行<code class="codeph">ocrconfig -repair -replace</code>命令。例如，如果在四节点群集的节点1上运行<code class="codeph">ocrconfig -restore</code>命令，则必须在节点2,3和4上运行<code class="codeph">ocrconfig -repair -replace</code>命令。</span></li>
                           <li class="stepexpand" id="GUID-3ADF0C33-9B4C-4FC5-88C5-4C736159E988__CHDCIGEE"><span>通过在所有节点上以<code class="codeph">root</code>身份运行以下命令，开始启动Oracle Clusterware：</span><div><pre class="pre codeblock"><code>#crsctl start crs</code></pre></div>
                           </li>
                           <li class="stepexpand"><span>通过运行以下CVU命令，验证配置为群集一部分的所有群集节点的OCR完整性：</span><div><pre class="pre codeblock"><code>$ cluvfy comp ocr -n all -verbose</code></pre></div>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>相关话题</strong></p>
                           <ul>
                              <li><a href="../ostmg/asmcmd-diskgroup-commands.html#OSTMG-GUID-FEA13FA9-4FB3-4C4B-B728-99AD2452888A" target="_blank"><span><cite>Oracle自动存储管理管理员指南</cite></span></a></li>
                              <li><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-6921B0DB-4C97-48D6-9128-373544663DCF">列出备份文件</a></li>
                              <li><a href="../ostmg/admin-asm-diskgroups.html#OSTMG-GUID-C455CEB1-0FC3-4DF4-9CD4-25EFA4D2BE01" target="_blank"><span><cite>Oracle自动存储管理管理员指南</cite></span></a></li>
                              <li><a href="../install-and-upgrade.html" target="_blank"><span><cite>Oracle Grid Infrastructure安装和升级指南</cite></span></a></li>
                              <li><a href="cluster-verification-utility-reference.html#GUID-B445A858-9F00-4423-990E-109545AC11C3" title="CVU可以在操作阶段或阶段验证主要群集组件。下表包含已弃用和不支持的CLUVFY命令：本节列出并描述了CVU命令。检查群集中所有节点上的Oracle自动存储管理群集文件系统（Oracle ACFS）的完整性。在您在节点列表中指定的所有节点上检查-o参数指定的操作所需的管理权限。检查群集中特定节点上的Oracle自动存储管理（Oracle ASM）的完整性。捕获系统和群集配置信息以创建基准。检查节点列表中所有节点的时钟同步。检查节点列表中节点上的集群管理器子组件或Oracle集群同步服务（CSS）的完整性。检查指定节点上的Cluster Ready Services（CRS）守护程序的完整性。验证网络上是否存在DHCP服务器，并且它可以提供所需数量的IP地址。验证是否已在域名服务（DNS）服务器中正确设置了网格命名服务（GNS）子域委派。检查Oracle Clusterware主存储中可用的可用空间，并确保至少有5％的可用空间。验证群集上的网格命名服务（GNS）的完整性。检查群集中节点列表上的网格即插即用的完整性。检查本地节点上Oracle Restart的完整性。检查Oracle Clusterware和Oracle数据库安装是否符合强制性要求和最佳实践指南，并确保它们正常运行。检查所有指定节点上是否存在节点应用程序，即VIP，NETWORK和ONS。检查节点列表中指定的节点之间的连接。如果提供接口列表，则CVU仅使用指定的接口检查连接。确定源节点是否可以与其他特定节点通信。检查所有指定节点上的Oracle Cluster Registry（OCR）的完整性。检查Oracle High Availability Services守护程序的完整性。检查本地节点上的Oracle Local Registry（OLR）的完整性。检查指定节点与引用节点的兼容性和属性。检查单客户端访问名称（SCAN）配置。检查随Oracle软件一起安装的文件和属性。检查在所有指定节点上的-l参数中指定的位置的可用磁盘空间。使用cluvfy comp ssa component verification命令发现并检查指定存储位置的共享。CVU检查节点列表中节点的共享。检查所有指定节点上的指定产品是否满足最低系统要求。检查所有指定节点上的投票文件的投票文件配置和udev设置。在配置Oracle自动存储管理群集文件系统（Oracle ACFS）之前，请使用cluvfy stage -pre acfscfg命令验证群集节点是否已正确设置。配置Oracle ACFS后，使用cluvfy stage -post acfscfg检查现有集群。对所有节点上的Oracle Clusterware应用程序集群安装执行相应的后期检查。在配置OCFS2之前，使用cluvfy stage -pre cfs stage verification命令验证是否正确设置了集群节点。使用cluvfy stage -post cfs stage verification命令在配置OCFS2后对指定节点执行相应的检查。在安装或升级Oracle Clusterware之前，请使用带有-file，-n，-flex或-upgrade参数的cluvfy stage -pre crsinst命令检查指定的节点。使用cluvfy stage -post crsinst命令在安装Oracle Clusterware后检查指定的节点。在配置Oracle RAC数据库之前检查指定的节点，以验证您的系统是否满足创建数据库或更改数据库配置的所有条件。在安装或创建Oracle RAC数据库之前检查指定的节点，以验证您的系统是否满足安装或创建Oracle RAC数据库的所有条件。配置Oracle Restart后检查本地节点。在安装Oracle软件之前，请检查群集中指定节点上的网络和存储。此命令还检查支持的存储类型，并检查每个类型以进行共享。使用cluvfy stage -pre nodeadd命令在将指定节点添加到现有集群之前验证它们是否已正确配置，并在添加节点之前验证集群的完整性。使用cluvfy stage -post nodeadd命令验证指定的节点是否已成功添加到网络，共享存储和集群件级别的集群中。验证是否已从群集中成功删除特定节点。通常，此命令将验证是否已删除特定于节点的接口配置详细信息，节点不再是群集配置的一部分，并且已执行正确的Oracle ASM清理。">群集验证实用程序参考</a></li>
                           </ul>
                        </div>
                     </div>
                  </div>
                  <div class="props_rev_3"><a id="GUID-7372F903-4BC0-4FB1-80AA-33B7BBD726EB" name="GUID-7372F903-4BC0-4FB1-80AA-33B7BBD726EB"></a><h5 id="CWADD-GUID-7372F903-4BC0-4FB1-80AA-33B7BBD726EB" class="sect5">在Windows系统上还原Oracle Cluster Registry</h5>
                     <div>
                        <p>使用此过程在Windows系统上还原OCR。</p>
                        <div class="section">
                           <p>如果要在Oracle ASM磁盘组上存储OCR，并且该磁盘组已损坏，则必须使用Oracle ASM实用程序还原Oracle ASM磁盘组，然后在恢复OCR之前再次装入磁盘组。通过运行<code class="codeph">ocrconfig -restore</code>命令恢复OCR。
                           </p>
                           <div class="infoboxnote" id="GUID-7372F903-4BC0-4FB1-80AA-33B7BBD726EB__GUID-1F0EE3ED-BB74-46E3-A4E1-7BA586EABF96">
                              <p class="notep1">注意：</p>
                              <p>如果原始OCR位置不存在，则必须在运行<code class="codeph">ocrconfig -restore</code>命令之前创建一个与原始OCR位置同名的空（0字节）OCR位置。
                              </p>
                           </div>
                           <p>使用以下过程在Windows系统上还原OCR：</p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>通过在一个节点上运行以下命令来列出群集中的节点：</span><div><pre class="pre codeblock"><code>C：\&gt; olsnodes</code></pre></div>
                           </li>
                           <li class="stepexpand"><span>通过在所有节点上以Administrators组成员身份运行以下命令来停止Oracle Clusterware：</span><div><pre class="pre codeblock"><code>C：\&gt; crsctl停止crs</code></pre><p>如果上述命令由于OCR损坏而返回任何错误，请通过在所有节点上以Administrators组成员身份运行以下命令来停止Oracle Clusterware：</p><pre class="pre codeblock"><code>C：\&gt; crsctl stop crs -f</code></pre></div>
                           </li>
                           <li class="stepexpand"><span>通过以Administrators组成员身份运行以下命令，以独占模式在一个节点上启动Oracle Clusterware堆栈：</span><div><pre class="pre codeblock"><code>C：\&gt; crsctl start crs -excl -nocrs</code></pre><p><code class="codeph">-nocrs</code>选项可确保CRSD进程和OCR不会从Oracle Clusterware堆栈的其余部分开始。
                                 </p>
                                 <p>忽略显示的任何错误。</p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>通过以管理员组成员身份运行以下命令，使用您在<span class="q">“列出备份文件”中</span>标识的OCR备份文件恢复OCR：</span><div><pre class="pre codeblock"><code>C：\&gt; ocrconfig -restore <span class="variable" translate="no">file_name</span></code></pre><p>确保您在OCR配置中指定的OCR设备存在且这些OCR设备有效。</p>
                                 <div class="infoboxnote" id="GUID-7372F903-4BC0-4FB1-80AA-33B7BBD726EB__GUID-4DEDA6FF-538D-46EF-BC57-CFCE4E117877">
                                    <p class="notep1">注意：</p>
                                    <ul style="list-style-type:disc">
                                       <li>
                                          <p>确保您在OCR配置中指定的OCR设备存在且这些OCR设备有效。</p>
                                       </li>
                                       <li>
                                          <p>确保您指定的Oracle ASM磁盘组存在且已装入。</p>
                                       </li>
                                    </ul>
                                 </div>
                                 <div class="infoboxnotealso" id="GUID-7372F903-4BC0-4FB1-80AA-33B7BBD726EB__GUID-8B945264-FB4B-405F-9DB1-56060B613EE0">
                                    <p class="notep1">也可以看看：</p>
                                    <p>有关创建OCR的信息，请参阅<span><cite>“Oracle Grid Infrastructure安装和升级指南”</cite></span></p>
                                 </div>
                              </div>
                           </li>
                           <li class="stepexpand"><span>验证OCR的完整性：</span><div><pre class="pre codeblock"><code>C：\&gt; ocrcheck</code></pre></div>
                           </li>
                           <li class="stepexpand"><span>在独占模式下运行的节点上停止Oracle Clusterware：</span><div><pre class="pre codeblock"><code>C：\&gt; crsctl stop crs -f</code></pre></div>
                           </li>
                           <li class="stepexpand"><span>通过在所有节点上以Administrators组成员的身份运行以下命令，开始启动Oracle Clusterware：</span><div><pre class="pre codeblock"><code>C：\&gt; crsctl start crs</code></pre></div>
                           </li>
                           <li class="stepexpand"><span>运行以下Cluster Verification Utility（CVU）命令以验证群集数据库中所有节点的OCR完整性：</span><div><pre class="pre codeblock"><code>C：\&gt; cluvfy comp ocr -n all -verbose</code></pre></div>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>相关话题</strong></p>
                           <ul>
                              <li><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-6921B0DB-4C97-48D6-9128-373544663DCF">列出备份文件</a></li>
                              <li><a href="../install-and-upgrade.html" target="_blank"><span><cite>Oracle Grid Infrastructure安装和升级指南</cite></span></a></li>
                              <li><a href="../ostmg/admin-asm-diskgroups.html#OSTMG-GUID-C455CEB1-0FC3-4DF4-9CD4-25EFA4D2BE01" target="_blank"><span><cite>Oracle自动存储管理管理员指南</cite></span></a></li>
                              <li><a href="cluster-verification-utility-reference.html#GUID-B445A858-9F00-4423-990E-109545AC11C3" title="CVU可以在操作阶段或阶段验证主要群集组件。下表包含已弃用和不支持的CLUVFY命令：本节列出并描述了CVU命令。检查群集中所有节点上的Oracle自动存储管理群集文件系统（Oracle ACFS）的完整性。在您在节点列表中指定的所有节点上检查-o参数指定的操作所需的管理权限。检查群集中特定节点上的Oracle自动存储管理（Oracle ASM）的完整性。捕获系统和群集配置信息以创建基准。检查节点列表中所有节点的时钟同步。检查节点列表中节点上的集群管理器子组件或Oracle集群同步服务（CSS）的完整性。检查指定节点上的Cluster Ready Services（CRS）守护程序的完整性。验证网络上是否存在DHCP服务器，并且它可以提供所需数量的IP地址。验证是否已在域名服务（DNS）服务器中正确设置了网格命名服务（GNS）子域委派。检查Oracle Clusterware主存储中可用的可用空间，并确保至少有5％的可用空间。验证群集上的网格命名服务（GNS）的完整性。检查群集中节点列表上的网格即插即用的完整性。检查本地节点上Oracle Restart的完整性。检查Oracle Clusterware和Oracle数据库安装是否符合强制性要求和最佳实践指南，并确保它们正常运行。检查所有指定节点上是否存在节点应用程序，即VIP，NETWORK和ONS。检查节点列表中指定的节点之间的连接。如果提供接口列表，则CVU仅使用指定的接口检查连接。确定源节点是否可以与其他特定节点通信。检查所有指定节点上的Oracle Cluster Registry（OCR）的完整性。检查Oracle High Availability Services守护程序的完整性。检查本地节点上的Oracle Local Registry（OLR）的完整性。检查指定节点与引用节点的兼容性和属性。检查单客户端访问名称（SCAN）配置。检查随Oracle软件一起安装的文件和属性。检查在所有指定节点上的-l参数中指定的位置的可用磁盘空间。使用cluvfy comp ssa component verification命令发现并检查指定存储位置的共享。CVU检查节点列表中节点的共享。检查所有指定节点上的指定产品是否满足最低系统要求。检查所有指定节点上的投票文件的投票文件配置和udev设置。在配置Oracle自动存储管理群集文件系统（Oracle ACFS）之前，请使用cluvfy stage -pre acfscfg命令验证群集节点是否已正确设置。配置Oracle ACFS后，使用cluvfy stage -post acfscfg检查现有集群。对所有节点上的Oracle Clusterware应用程序集群安装执行相应的后期检查。在配置OCFS2之前，使用cluvfy stage -pre cfs stage verification命令验证是否正确设置了集群节点。使用cluvfy stage -post cfs stage verification命令在配置OCFS2后对指定节点执行相应的检查。在安装或升级Oracle Clusterware之前，请使用带有-file，-n，-flex或-upgrade参数的cluvfy stage -pre crsinst命令检查指定的节点。使用cluvfy stage -post crsinst命令在安装Oracle Clusterware后检查指定的节点。在配置Oracle RAC数据库之前检查指定的节点，以验证您的系统是否满足创建数据库或更改数据库配置的所有条件。在安装或创建Oracle RAC数据库之前检查指定的节点，以验证您的系统是否满足安装或创建Oracle RAC数据库的所有条件。配置Oracle Restart后检查本地节点。在安装Oracle软件之前，请检查群集中指定节点上的网络和存储。此命令还检查支持的存储类型，并检查每个类型以进行共享。使用cluvfy stage -pre nodeadd命令在将指定节点添加到现有集群之前验证它们是否已正确配置，并在添加节点之前验证集群的完整性。使用cluvfy stage -post nodeadd命令验证指定的节点是否已成功添加到网络，共享存储和集群件级别的集群中。验证是否已从群集中成功删除特定节点。通常，此命令将验证是否已删除特定于节点的接口配置详细信息，节点不再是群集配置的一部分，并且已执行正确的Oracle ASM清理。">群集验证实用程序参考</a></li>
                           </ul>
                        </div>
                     </div>
                  </div>
                  <div class="props_rev_3"><a id="GUID-F15F9F72-90F3-456D-8E55-5E3FA0959392" name="GUID-F15F9F72-90F3-456D-8E55-5E3FA0959392"></a><h5 id="CWADD-GUID-F15F9F72-90F3-456D-8E55-5E3FA0959392" class="sect5">在Oracle Restart Environment中恢复Oracle Cluster Registry</h5>
                     <div>
                        <p>使用此过程在Oracle Restart环境中还原OCR。</p>
                        <div class="section">
                           <div class="infoboxnote" id="GUID-F15F9F72-90F3-456D-8E55-5E3FA0959392__GUID-F6F7178A-5A04-4A25-9FD4-309F79C18B4F">
                              <p class="notep1">注意：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>OCR用于向后兼容。</p>
                                 </li>
                                 <li>
                                    <p>创建OCR位置后，它不会在Oracle Restart环境中更新。</p>
                                 </li>
                                 <li>
                                    <p>如果已备份Oracle Restart主目录，并且出现故障，则还原Oracle Restart主目录会还原OCR。</p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>通过在所有节点上以<code class="codeph">root</code>身份运行以下命令来停止Oracle高可用性服务：</span><div><pre class="pre codeblock"><code>#crsctl stop有[-f]</code></pre></div>
                           </li>
                           <li class="stepexpand"><span>运行<code class="codeph">ocrcheck -config</code>命令以确定OCR位置，然后在该位置创建一个具有适当权限的空（0字节）OCR位置。</span></li>
                           <li class="stepexpand"><span>通过以<code class="codeph">root</code>身份运行以下命令来还原OCR：</span><div><pre class="pre codeblock"><code>#crsctl pin css -n <span class="variable" translate="no">host_name</span></code></pre><div class="infoboxnote" id="GUID-F15F9F72-90F3-456D-8E55-5E3FA0959392__GUID-E91D4120-BD84-41EB-B5DB-7FFCD773F85A">
                                    <p class="notep1">注意：</p>
                                    <p>确保您在OCR配置中指定的OCR设备存在且这些OCR设备有效。</p>
                                 </div>
                                 <div class="infoboxnotealso" id="GUID-F15F9F72-90F3-456D-8E55-5E3FA0959392__GUID-D75CA63F-4D83-4636-8C44-EE2A760601D7">
                                    <p class="notep1">也可以看看：</p>
                                    <p>有关创建OCR的信息，请参阅<span><cite>“Oracle Grid Infrastructure安装和升级指南”</cite></span></p>
                                 </div>
                              </div>
                           </li>
                           <li class="stepexpand"><span>运行<code class="codeph">ocrcheck</code>命令以验证OCR的完整性：</span></li>
                           <li class="stepexpand"><span>通过在所有节点上运行以下命令来启动Oracle高可用性服务：</span><div><pre class="pre codeblock"><code>$ crsctl start有</code></pre></div>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>相关话题</strong></p>
                           <ul>
                              <li><a href="../install-and-upgrade.html" target="_blank"><span><cite>Oracle Grid Infrastructure安装和升级指南</cite></span></a></li>
                           </ul>
                        </div>
                     </div>
                  </div>
               </div><a id="CWADD90974"></a><div class="props_rev_3"><a id="GUID-D3B9559B-054A-4574-854E-9865FEDF5EDD" name="GUID-D3B9559B-054A-4574-854E-9865FEDF5EDD"></a><h4 id="CWADD-GUID-D3B9559B-054A-4574-854E-9865FEDF5EDD" class="sect4">诊断Oracle Cluster Registry问题</h4>
                  <p>使用OCRDUMP和OCRCHECK实用程序诊断OCR问题。</p>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="oracle-cluster-registry-utility-reference.html#GUID-F4CE8CF1-24FD-43FA-BF62-70718955B386">OCRDUMP实用程序语法和选项</a></li>
                           <li><a href="oracle-cluster-registry-utility-reference.html#GUID-458233B3-54A8-4D2E-A9B5-1D3BF6ADEAE5" title="OCRCHECK实用程序显示OCR块格式的版本，可用空间和已用空间，OCRID以及已配置的OCR位置。">使用OCRCHECK实用程序</a></li>
                        </ul>
                     </div>
                  </div>
               </div><a id="CWADD834"></a><div class="props_rev_3"><a id="GUID-7B87F4D6-4146-4EB0-BD2F-17AED8C5F72E" name="GUID-7B87F4D6-4146-4EB0-BD2F-17AED8C5F72E"></a><h4 id="CWADD-GUID-7B87F4D6-4146-4EB0-BD2F-17AED8C5F72E" class="sect4">使用导出和导入命令管理Oracle Cluster Registry</h4>
                  <div>
                     <p><a id="d37753e3893" class="indexterm-anchor"></a>除了使用自动创建的OCR备份文件之外，还应在进行重要配置更改之前和之后导出OCR内容，例如在环境中添加或删除节点，修改Oracle Clusterware资源以及升级，降级或创建数据库。通过使用<code class="codeph">ocrconfig -export</code>命令执行此操作，该命令将OCR内容导出为文件格式。
                     </p>
                     <div class="infoboxnote" id="GUID-7B87F4D6-4146-4EB0-BD2F-17AED8C5F72E__GUID-B5864A03-9AE3-4345-9996-F67600461A23">
                        <p class="notep1">警告：</p>
                        <p>请注意以下恢复OCR的限制：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">ocrconfig -restore</code>生成的文件格式与<code class="codeph">ocrconfig -export</code>生成的文件格式不兼容。<code class="codeph">ocrconfig -export</code>和<code class="codeph">ocrconfig -import</code>命令是兼容的。<code class="codeph">ocrconfig -manualbackup</code>和<code class="codeph">ocrconfig -restore</code>命令是兼容的。这两种文件格式不兼容，不得互换使用。
                              </p>
                           </li>
                           <li>
                              <p>导出OCR时，Oracle建议在名称字符串中包含“ <code class="codeph">ocr</code> ”，群集名称和时间戳。例如：</p><pre class="oac_no_warn" dir="ltr">ocr_mycluster1_20090521_2130_export</pre></li>
                        </ul>
                     </div>
                     <p><a id="d37753e3936" class="indexterm-anchor"></a><a id="d37753e3940" class="indexterm-anchor"></a>如果配置更改导致错误，则使用<code class="codeph">ocrconfig -export</code>命令还可以使用<code class="codeph">-import</code>选项还原OCR。例如，如果你有<a id="d37753e3951" class="indexterm-anchor"></a>您无法解决的配置问题，或者在此类更改后无法重新启动Oracle Clusterware，然后使用适用于您的平台的过程还原配置。
                     </p>
                     <p>Oracle建议您使用自动或手动备份，并使用<code class="codeph">ocrconfig -restore</code>命令而不是<code class="codeph">ocrconfig -export</code>和<code class="codeph">ocrconfig -import</code>命令来恢复OCR，原因如下：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>备份是OCR的一致快照，而导出则不是。</p>
                        </li>
                        <li>
                           <p>系统联机时会创建备份。您必须在群集中的所有节点上关闭Oracle Clusterware，才能使用<code class="codeph">ocrconfig -export</code>命令获取一致的快照。
                           </p>
                        </li>
                        <li>
                           <p>您可以使用OCRDUMP实用程序检查备份。您无法检查导出的内容。</p>
                        </li>
                        <li>
                           <p>您可以使用<code class="codeph">ocrconfig -showbackup</code>命令列出备份，而<span class="italic">您</span>必须跟踪所有生成的导出。
                           </p>
                        </li>
                     </ul>
                     <p>本节包括以下主题：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-257FAFEE-51BE-4472-96F3-22DF84023793" title="使用此过程在Linux或UNIX系统上导入OCR。">在Linux或UNIX系统上导入Oracle Cluster Registry Content</a></p>
                        </li>
                        <li>
                           <p><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-DBF6C260-369E-47B3-B8F2-495A703ABC8E" title="使用此过程在Windows系统上导入OCR。">在Windows系统上导入Oracle Cluster Registry Content</a></p>
                        </li>
                     </ul>
                     <div class="infoboxnote" id="GUID-7B87F4D6-4146-4EB0-BD2F-17AED8C5F72E__GUID-3D39B776-87C6-40D5-9B8C-2D8E9F233C80">
                        <p class="notep1">注意：</p>
                        <p>您所做的大多数配置更改不仅会更改OCR内容，配置更改还会导致创建文件和数据库对象。恢复OCR时，通常无法恢复其中一些更改。如果某些配置更改失败，请不要将OCR恢复为恢复到先前配置的更正。这可能导致OCR位置的内容与系统其余部分的状态不匹配。</p>
                     </div>
                  </div><a id="CWADD90977"></a><div class="props_rev_3"><a id="GUID-257FAFEE-51BE-4472-96F3-22DF84023793" name="GUID-257FAFEE-51BE-4472-96F3-22DF84023793"></a><h5 id="CWADD-GUID-257FAFEE-51BE-4472-96F3-22DF84023793" class="sect5">在Linux或UNIX系统上导入Oracle Cluster Registry Content</h5>
                     <div>
                        <p>使用此过程在Linux或UNIX系统上导入OCR。</p>
                        <div class="section">
                           <div class="infoboxnote" id="GUID-257FAFEE-51BE-4472-96F3-22DF84023793__GUID-397DBF26-DA77-43D6-A909-9ADD2A77F839">
                              <p class="notep1">注意：</p>
                              <p>此过程假定在群集中启用了Oracle Clusterware自动启动的所有节点上默认安装Oracle Clusterware。</p>
                           </div>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>通过在一个节点上运行以下命令来列出群集中的节点：</span><div><pre class="pre codeblock"><code>$ olsnodes</code></pre></div>
                           </li>
                           <li class="stepexpand"><span>通过在所有节点上以<code class="codeph">root</code>身份运行以下命令来停止Oracle Clusterware：</span><div><pre class="pre codeblock"><code>#crsctl停止crs</code></pre><p>如果上述命令由于OCR损坏而返回任何错误，请通过在所有节点上以<code class="codeph">root</code>身份运行以下命令来停止Oracle Clusterware：</p><pre class="pre codeblock"><code>#crsctl stop crs -f</code></pre></div>
                           </li>
                           <li class="stepexpand"><span>通过以<code class="codeph">root</code>身份运行以下命令，以独占模式在一个节点上启动Oracle Clusterware堆栈：</span><div><pre class="pre codeblock"><code>#crsctl start crs -excl</code></pre><p>忽略显示的任何错误。</p>
                                 <p>检查CRSD是否正在运行。如果是，请以<code class="codeph">root</code>身份运行以下命令来停止它：</p><pre class="pre codeblock"><code>#crsctl stop resource ora.crsd -init</code></pre><div class="infoboxnote" id="GUID-257FAFEE-51BE-4472-96F3-22DF84023793__GUID-9035DE83-4A8F-4B22-A4F3-892FD5256DD8">
                                    <p class="notep1">警告：</p>
                                    <p><span class="italic">不要</span>将<code class="codeph">-init</code>标志与任何其他命令一起使用。
                                    </p>
                                 </div>
                              </div>
                           </li>
                           <li class="stepexpand"><span>以<code class="codeph">root</code>身份运行以下命令导入OCR：</span><div><pre class="pre codeblock"><code>#ocrconfig -import <span class="variable" translate="no">file_name</span></code></pre><p>如果要将OCR导入群集或网络文件系统，请跳至步骤<a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-257FAFEE-51BE-4472-96F3-22DF84023793__BGBIJGAI">7</a> 。
                                 </p>
                                 <div class="infoboxnote" id="GUID-257FAFEE-51BE-4472-96F3-22DF84023793__GUID-B12EC987-97CC-4525-92E7-C7DB2E2C28A1">
                                    <p class="notep1">注意：</p>
                                    <ul style="list-style-type:disc">
                                       <li>
                                          <p>如果原始OCR位置不存在，则必须在运行<code class="codeph">ocrconfig -import</code>命令之前创建一个空（0字节）OCR位置。
                                          </p>
                                       </li>
                                       <li>
                                          <p>确保您在OCR配置中指定的OCR设备存在且这些OCR设备有效。</p>
                                       </li>
                                       <li>
                                          <p>如果在Oracle ASM磁盘组中配置了OCR，请确保存在并装入Oracle ASM磁盘组。</p>
                                       </li>
                                    </ul>
                                 </div>
                                 <div class="infoboxnotealso" id="GUID-257FAFEE-51BE-4472-96F3-22DF84023793__GUID-F784FF21-BF8F-45C2-9D45-D086D077E213">
                                    <p class="notep1">也可以看看：</p>
                                    <p>有关创建OCR的信息，请参阅<span><cite>“Oracle Grid Infrastructure安装和升级指南”</cite></span></p>
                                 </div>
                              </div>
                           </li>
                           <li class="stepexpand"><span>验证OCR的完整性：</span><div><pre class="pre codeblock"><code>#ocrcheck</code></pre></div>
                           </li>
                           <li class="stepexpand"><span>在独占模式下运行的节点上停止Oracle Clusterware：</span><div><pre class="pre codeblock"><code>#crsctl stop crs -f</code></pre></div>
                           </li>
                           <li class="stepexpand" id="GUID-257FAFEE-51BE-4472-96F3-22DF84023793__BGBIJGAI"><span>通过在所有节点上以<code class="codeph">root</code>身份运行以下命令，开始启动Oracle Clusterware：</span><div><pre class="pre codeblock"><code>#crsctl start crs</code></pre></div>
                           </li>
                           <li class="stepexpand"><span>通过运行以下CVU命令，验证配置为群集一部分的所有群集节点的OCR完整性：</span><div><pre class="pre codeblock"><code>$ cluvfy comp ocr -n all -verbose</code></pre></div>
                           </li>
                        </ol>
                        <div class="section">
                           <div class="infoboxnote" id="GUID-257FAFEE-51BE-4472-96F3-22DF84023793__GUID-97C8B82D-8ADD-412F-8D86-11CBFFA01BFC">
                              <p class="notep1">注意：</p>
                              <p>您<span class="italic">只能</span>导入导出的OCR。要从备份还原OCR，必须使用<code class="codeph">-restore</code>选项，如<span class="q">“备份Oracle Cluster Registry”中所述</span> 。
                              </p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>相关话题</strong></p>
                           <ul>
                              <li><a href="../install-and-upgrade.html" target="_blank"><span><cite>Oracle Grid Infrastructure安装和升级指南</cite></span></a></li>
                              <li><a href="../ostmg/admin-asm-diskgroups.html#OSTMG-GUID-C455CEB1-0FC3-4DF4-9CD4-25EFA4D2BE01" target="_blank"><span><cite>Oracle自动存储管理管理员指南</cite></span></a></li>
                              <li><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-8554ACE4-44DF-4DB5-A939-1DC6D62BAE60">备份Oracle Cluster Registry</a></li>
                              <li><a href="cluster-verification-utility-reference.html#GUID-B445A858-9F00-4423-990E-109545AC11C3" title="CVU可以在操作阶段或阶段验证主要群集组件。下表包含已弃用和不支持的CLUVFY命令：本节列出并描述了CVU命令。检查群集中所有节点上的Oracle自动存储管理群集文件系统（Oracle ACFS）的完整性。在您在节点列表中指定的所有节点上检查-o参数指定的操作所需的管理权限。检查群集中特定节点上的Oracle自动存储管理（Oracle ASM）的完整性。捕获系统和群集配置信息以创建基准。检查节点列表中所有节点的时钟同步。检查节点列表中节点上的集群管理器子组件或Oracle集群同步服务（CSS）的完整性。检查指定节点上的Cluster Ready Services（CRS）守护程序的完整性。验证网络上是否存在DHCP服务器，并且它可以提供所需数量的IP地址。验证是否已在域名服务（DNS）服务器中正确设置了网格命名服务（GNS）子域委派。检查Oracle Clusterware主存储中可用的可用空间，并确保至少有5％的可用空间。验证群集上的网格命名服务（GNS）的完整性。检查群集中节点列表上的网格即插即用的完整性。检查本地节点上Oracle Restart的完整性。检查Oracle Clusterware和Oracle数据库安装是否符合强制性要求和最佳实践指南，并确保它们正常运行。检查所有指定节点上是否存在节点应用程序，即VIP，NETWORK和ONS。检查节点列表中指定的节点之间的连接。如果提供接口列表，则CVU仅使用指定的接口检查连接。确定源节点是否可以与其他特定节点通信。检查所有指定节点上的Oracle Cluster Registry（OCR）的完整性。检查Oracle High Availability Services守护程序的完整性。检查本地节点上的Oracle Local Registry（OLR）的完整性。检查指定节点与引用节点的兼容性和属性。检查单客户端访问名称（SCAN）配置。检查随Oracle软件一起安装的文件和属性。检查在所有指定节点上的-l参数中指定的位置的可用磁盘空间。使用cluvfy comp ssa component verification命令发现并检查指定存储位置的共享。CVU检查节点列表中节点的共享。检查所有指定节点上的指定产品是否满足最低系统要求。检查所有指定节点上的投票文件的投票文件配置和udev设置。在配置Oracle自动存储管理群集文件系统（Oracle ACFS）之前，请使用cluvfy stage -pre acfscfg命令验证群集节点是否已正确设置。配置Oracle ACFS后，使用cluvfy stage -post acfscfg检查现有集群。对所有节点上的Oracle Clusterware应用程序集群安装执行相应的后期检查。在配置OCFS2之前，使用cluvfy stage -pre cfs stage verification命令验证是否正确设置了集群节点。使用cluvfy stage -post cfs stage verification命令在配置OCFS2后对指定节点执行相应的检查。在安装或升级Oracle Clusterware之前，请使用带有-file，-n，-flex或-upgrade参数的cluvfy stage -pre crsinst命令检查指定的节点。使用cluvfy stage -post crsinst命令在安装Oracle Clusterware后检查指定的节点。在配置Oracle RAC数据库之前检查指定的节点，以验证您的系统是否满足创建数据库或更改数据库配置的所有条件。在安装或创建Oracle RAC数据库之前检查指定的节点，以验证您的系统是否满足安装或创建Oracle RAC数据库的所有条件。配置Oracle Restart后检查本地节点。在安装Oracle软件之前，请检查群集中指定节点上的网络和存储。此命令还检查支持的存储类型，并检查每个类型以进行共享。使用cluvfy stage -pre nodeadd命令在将指定节点添加到现有集群之前验证它们是否已正确配置，并在添加节点之前验证集群的完整性。使用cluvfy stage -post nodeadd命令验证指定的节点是否已成功添加到网络，共享存储和集群件级别的集群中。验证是否已从群集中成功删除特定节点。通常，此命令将验证是否已删除特定于节点的接口配置详细信息，节点不再是群集配置的一部分，并且已执行正确的Oracle ASM清理。">群集验证实用程序参考</a></li>
                           </ul>
                        </div>
                     </div>
                  </div><a id="CWADD90978"></a><div class="props_rev_3"><a id="GUID-DBF6C260-369E-47B3-B8F2-495A703ABC8E" name="GUID-DBF6C260-369E-47B3-B8F2-495A703ABC8E"></a><h5 id="CWADD-GUID-DBF6C260-369E-47B3-B8F2-495A703ABC8E" class="sect5">在Windows系统上导入Oracle Cluster Registry Content</h5>
                     <div>
                        <p>使用此过程在Windows系统上导入OCR。</p>
                        <div class="section">
                           <div class="infoboxnote" id="GUID-DBF6C260-369E-47B3-B8F2-495A703ABC8E__GUID-2E1B0179-6501-4D84-B6FF-2AA4866EFF4F">
                              <p class="notep1">注意：</p>
                              <p>此过程假定在群集中启用了Oracle Clusterware自动启动的所有节点上默认安装Oracle Clusterware。</p>
                           </div>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>通过在一个节点上运行以下命令来列出群集中的节点：</span><div><pre class="pre codeblock"><code>C：\&gt; olsnodes</code></pre></div>
                           </li>
                           <li class="stepexpand"><span>通过在所有节点上以Administrators组成员身份运行以下命令来停止Oracle Clusterware：</span><div><pre class="pre codeblock"><code>C：\&gt; crsctl停止crs</code></pre><p>如果上述命令由于OCR损坏而返回任何错误，请通过在所有节点上以Administrators组成员身份运行以下命令来停止Oracle Clusterware：</p><pre class="pre codeblock"><code>C：\&gt; crsctl stop crs -f</code></pre></div>
                           </li>
                           <li class="stepexpand"><span>通过以Administrators组成员身份运行以下命令，以独占模式在一个节点上启动Oracle Clusterware堆栈：</span><div><pre class="pre codeblock"><code>C：\&gt; crsctl start crs -excl</code></pre><p>忽略显示的任何错误。</p>
                                 <p>检查CRSD是否正在运行。如果是，请通过以管理员组成员身份运行以下命令来停止它：</p><pre class="pre codeblock"><code>C：\&gt; crsctl停止资源ora.crsd -init</code></pre><div class="infoboxnote" id="GUID-DBF6C260-369E-47B3-B8F2-495A703ABC8E__GUID-8F2E6637-4378-4602-BEF9-7FB4989FAD2F">
                                    <p class="notep1">警告：</p>
                                    <p><span class="italic">不要</span>在任何其他命令中使用<code class="codeph">-init</code>标志。
                                    </p>
                                 </div>
                              </div>
                           </li>
                           <li class="stepexpand"><span>通过以Administrators组成员身份运行以下命令来导入OCR：</span><div><pre class="pre codeblock"><code>C：\&gt; ocrconfig -import <span class="variable" translate="no">file_name</span></code></pre><p>确保您在OCR配置中指定的OCR设备存在且这些OCR设备有效。</p>
                                 <div class="infoboxnote" id="GUID-DBF6C260-369E-47B3-B8F2-495A703ABC8E__GUID-66408D96-B1B7-498F-9302-1BA50A47C8C4">
                                    <p class="notep1">注意：</p>
                                    <ul style="list-style-type:disc">
                                       <li>
                                          <p>如果原始OCR位置不存在，则必须在运行<code class="codeph">ocrconfig -import</code>命令之前创建一个空（0字节）OCR位置。
                                          </p>
                                       </li>
                                       <li>
                                          <p>确保您在OCR配置中指定的OCR设备存在且这些OCR设备有效。</p>
                                       </li>
                                       <li>
                                          <p>确保您指定的Oracle ASM磁盘组存在且已装入。</p>
                                       </li>
                                    </ul>
                                 </div>
                              </div>
                           </li>
                           <li class="stepexpand"><span>验证OCR的完整性：</span><div><pre class="pre codeblock"><code>C：\&gt; ocrcheck</code></pre></div>
                           </li>
                           <li class="stepexpand"><span>在独占模式下运行的节点上停止Oracle Clusterware：</span><div><pre class="pre codeblock"><code>C：\&gt; crsctl stop crs -f</code></pre></div>
                           </li>
                           <li class="stepexpand"><span>通过在所有节点上以Administrators组成员的身份运行以下命令，开始启动Oracle Clusterware：</span><div><pre class="pre codeblock"><code>C：\&gt; crsctl start crs</code></pre></div>
                           </li>
                           <li class="stepexpand"><span>运行以下Cluster Verification Utility（CVU）命令以验证群集数据库中所有节点的OCR完整性：</span><div><pre class="pre codeblock"><code>C：\&gt; cluvfy comp ocr -n all -verbose</code></pre></div>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>相关话题</strong></p>
                           <ul>
                              <li><a href="../ostmg/admin-asm-diskgroups.html#OSTMG-GUID-C455CEB1-0FC3-4DF4-9CD4-25EFA4D2BE01" target="_blank"><span><cite>Oracle自动存储管理管理员指南</cite></span></a></li>
                              <li><a href="cluster-verification-utility-reference.html#GUID-B445A858-9F00-4423-990E-109545AC11C3" title="CVU可以在操作阶段或阶段验证主要群集组件。下表包含已弃用和不支持的CLUVFY命令：本节列出并描述了CVU命令。检查群集中所有节点上的Oracle自动存储管理群集文件系统（Oracle ACFS）的完整性。在您在节点列表中指定的所有节点上检查-o参数指定的操作所需的管理权限。检查群集中特定节点上的Oracle自动存储管理（Oracle ASM）的完整性。捕获系统和群集配置信息以创建基准。检查节点列表中所有节点的时钟同步。检查节点列表中节点上的集群管理器子组件或Oracle集群同步服务（CSS）的完整性。检查指定节点上的Cluster Ready Services（CRS）守护程序的完整性。验证网络上是否存在DHCP服务器，并且它可以提供所需数量的IP地址。验证是否已在域名服务（DNS）服务器中正确设置了网格命名服务（GNS）子域委派。检查Oracle Clusterware主存储中可用的可用空间，并确保至少有5％的可用空间。验证群集上的网格命名服务（GNS）的完整性。检查群集中节点列表上的网格即插即用的完整性。检查本地节点上Oracle Restart的完整性。检查Oracle Clusterware和Oracle数据库安装是否符合强制性要求和最佳实践指南，并确保它们正常运行。检查所有指定节点上是否存在节点应用程序，即VIP，NETWORK和ONS。检查节点列表中指定的节点之间的连接。如果提供接口列表，则CVU仅使用指定的接口检查连接。确定源节点是否可以与其他特定节点通信。检查所有指定节点上的Oracle Cluster Registry（OCR）的完整性。检查Oracle High Availability Services守护程序的完整性。检查本地节点上的Oracle Local Registry（OLR）的完整性。检查指定节点与引用节点的兼容性和属性。检查单客户端访问名称（SCAN）配置。检查随Oracle软件一起安装的文件和属性。检查在所有指定节点上的-l参数中指定的位置的可用磁盘空间。使用cluvfy comp ssa component verification命令发现并检查指定存储位置的共享。CVU检查节点列表中节点的共享。检查所有指定节点上的指定产品是否满足最低系统要求。检查所有指定节点上的投票文件的投票文件配置和udev设置。在配置Oracle自动存储管理群集文件系统（Oracle ACFS）之前，请使用cluvfy stage -pre acfscfg命令验证群集节点是否已正确设置。配置Oracle ACFS后，使用cluvfy stage -post acfscfg检查现有集群。对所有节点上的Oracle Clusterware应用程序集群安装执行相应的后期检查。在配置OCFS2之前，使用cluvfy stage -pre cfs stage verification命令验证是否正确设置了集群节点。使用cluvfy stage -post cfs stage verification命令在配置OCFS2后对指定节点执行相应的检查。在安装或升级Oracle Clusterware之前，请使用带有-file，-n，-flex或-upgrade参数的cluvfy stage -pre crsinst命令检查指定的节点。使用cluvfy stage -post crsinst命令在安装Oracle Clusterware后检查指定的节点。在配置Oracle RAC数据库之前检查指定的节点，以验证您的系统是否满足创建数据库或更改数据库配置的所有条件。在安装或创建Oracle RAC数据库之前检查指定的节点，以验证您的系统是否满足安装或创建Oracle RAC数据库的所有条件。配置Oracle Restart后检查本地节点。在安装Oracle软件之前，请检查群集中指定节点上的网络和存储。此命令还检查支持的存储类型，并检查每个类型以进行共享。使用cluvfy stage -pre nodeadd命令在将指定节点添加到现有集群之前验证它们是否已正确配置，并在添加节点之前验证集群的完整性。使用cluvfy stage -post nodeadd命令验证指定的节点是否已成功添加到网络，共享存储和集群件级别的集群中。验证是否已从群集中成功删除特定节点。通常，此命令将验证是否已删除特定于节点的接口配置详细信息，节点不再是群集配置的一部分，并且已执行正确的Oracle ASM清理。">群集验证实用程序参考</a></li>
                           </ul>
                        </div>
                     </div>
                  </div>
               </div><a id="CWADD90963"></a><div class="props_rev_3"><a id="GUID-4DEA42E9-8E97-474B-AAD8-E5E626FB8B07" name="GUID-4DEA42E9-8E97-474B-AAD8-E5E626FB8B07"></a><h4 id="CWADD-GUID-4DEA42E9-8E97-474B-AAD8-E5E626FB8B07" class="sect4">Oracle Local Registry</h4>
                  <div>
                     <p>在Oracle集群<span class="italic">12c</span>中，集群中的每个节点具有用于节点特定的资源的本地注册表中，称为<a id="d37753e4746" class="indexterm-anchor"></a><a id="d37753e4750" class="indexterm-anchor"></a> Oracle Clusterware（OLR），在Oracle Clusterware安装OCR时安装和配置。无论Oracle Clusterware是运行还是完全正常运行，每个节点上的多个进程都可以同时对OLR进行读写访问，特别是对其所在的节点。
                     </p>
                     <p>默认情况下，OLR位于每个节点上的<span class="italic"><code class="codeph">Grid_home</code></span> <code class="codeph">/cdata/</code> <span class="italic"><code class="codeph">host_name</code></span> <code class="codeph">.olr</code> 。
                     </p>
                     <p>使用OCRCHECK，OCRDUMP和OCRCONFIG实用程序以<code class="codeph">root</code>身份使用<code class="codeph">-local</code>选项管理OLR。
                     </p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>您可以使用以下命令检查本地节点上OLR的状态<a id="d37753e4780" class="indexterm-anchor"></a><a id="d37753e4784" class="indexterm-anchor"></a> OCRCHECK实用程序，如下：</p><pre class="oac_no_warn" dir="ltr">#ocrcheck -local Oracle Cluster Registry的状态如下：版本：3总空间（kbytes）：262132已用空间（kbytes）：9200可用空间（kbytes）：252932 ID：604793089设备/文件名：/ private2 / crs / cdata / localhost / dglnx6.olr设备/文件完整性检查成功本地OCR完整性检查成功</pre></li>
                        <li>
                           <p>您可以使用本地节点将OLR的内容显示到启动程序的文本终端<a id="d37753e4794" class="indexterm-anchor"></a><a id="d37753e4798" class="indexterm-anchor"></a> OCRDUMP实用程序，如下：</p><pre class="oac_no_warn" dir="ltr">#ocrdump -local -stdout</pre></li>
                        <li>
                           <p>您可以使用在本地节点上的OLR上执行管理任务<a id="d37753e4808" class="indexterm-anchor"></a><a id="d37753e4812" class="indexterm-anchor"></a> OCRCONFIG实用程序。
                           </p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><a id="d37753e4820" class="indexterm-anchor"></a>要将OLR导出到文件：</p><pre class="oac_no_warn" dir="ltr">#ocrconfig -local -export <span class="italic">file_name</span></pre><div class="infoboxnote" id="GUID-4DEA42E9-8E97-474B-AAD8-E5E626FB8B07__GUID-4B8A6070-237E-4DC6-A15F-F4DE5EB44351">
                                    <p class="notep1">注意：</p>
                                    <p></p>
                                    <ul style="list-style-type:disc">
                                       <li>
                                          <p>Oracle建议您使用<code class="codeph">-manualbackup</code>和<code class="codeph">-restore</code>命令，而不是<code class="codeph">-import</code>和<code class="codeph">-export</code>命令。
                                          </p>
                                       </li>
                                       <li>
                                          <p>导出OLR时，Oracle建议在名称字符串中包含“ <code class="codeph">olr</code> ”，主机名和时间戳。例如：</p><pre class="oac_no_warn" dir="ltr">olr_myhost1_20090603_0130_export</pre></li>
                                    </ul>
                                 </div>
                              </li>
                              <li>
                                 <p><a id="d37753e4857" class="indexterm-anchor"></a>要将指定文件导入OLR：</p><pre class="oac_no_warn" dir="ltr">#ocrconfig -local -import <span class="italic">file_name</span>
</pre></li>
                              <li>
                                 <p><a id="d37753e4869" class="indexterm-anchor"></a>要手动备份OLR：</p><pre class="oac_no_warn" dir="ltr">#ocrconfig -local -manualbackup</pre><div class="infoboxnote" id="GUID-4DEA42E9-8E97-474B-AAD8-E5E626FB8B07__GUID-4DFA5399-F9B0-4353-B34C-978950F80703">
                                    <p class="notep1">注意：</p>
                                    <p>Oracle Clusterware在安装或升级后备份OLR，并且默认情况下会定期备份OLR。在初始备份后的任何时候，您都可以手动备份OLR。</p>
                                    <p>Oracle还建议您在将OCR从Oracle ASM迁移到其他存储时，或者将OCR从其他存储迁移到Oracle ASM时创建新备份。</p>
                                    <p>OLR的默认备份位置位于<span class="italic"><code class="codeph">Grid_home</code></span> <code class="codeph">/cdata/</code> <span class="italic"><code class="codeph">host_name</code></span>路径中。
                                    </p>
                                 </div>
                              </li>
                              <li>
                                 <p><a id="d37753e4894" class="indexterm-anchor"></a>要查看OLR备份文件的内容：</p><pre class="oac_no_warn" dir="ltr">ocrdump -local -backupfile <span class="italic">olr_backup_file_name</span>
</pre></li>
                              <li>
                                 <p>要更改OLR备份位置：</p><pre class="oac_no_warn" dir="ltr">ocrconfig -local -backuploc <span class="italic">new_olr_backup_path</span>
</pre></li>
                              <li>
                                 <p><a id="d37753e4914" class="indexterm-anchor"></a>要恢复OLR：</p><pre class="oac_no_warn" dir="ltr">#crsctl stop crs＃ocrconfig -local -restore <span class="italic">file_name</span> ＃ocrcheck -local #crsctl start crs $ cluvfy comp olr</pre></li>
                           </ul>
                        </li>
                     </ul>
                  </div>
               </div><a id="CWADD837"></a><div class="props_rev_3"><a id="GUID-1D3FDBE6-03ED-49B9-A181-2463C59331DA" name="GUID-1D3FDBE6-03ED-49B9-A181-2463C59331DA"></a><h4 id="CWADD-GUID-1D3FDBE6-03ED-49B9-A181-2463C59331DA" class="sect4">升级和降级Oracle Cluster Registry Configuration</h4>
                  <div>
                     <div class="section">
                        <p><a id="d37753e5043" class="indexterm-anchor"></a><a id="d37753e5047" class="indexterm-anchor"></a>升级Oracle Clusterware时，它会自动运行<code class="codeph">ocrconfig -upgrade</code>命令。要降级，请遵循每个组件的降级说明，并使用<code class="codeph">ocrconfig -downgrade</code>命令降级OCR。如果要升级OCR，则可以使用OCRCHECK实用程序验证OCR的完整性。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="CWADD833"></a><div class="props_rev_3"><a id="GUID-00137A43-61A5-446B-BFEA-D7EFDA535E81" name="GUID-00137A43-61A5-446B-BFEA-D7EFDA535E81"></a><h3 id="CWADD-GUID-00137A43-61A5-446B-BFEA-D7EFDA535E81" class="sect3">管理投票文件</h3>
               <div>
                  <p>本节包括以下有关管理群集中的投票文件的主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-7680E1EB-C91F-4B32-82B8-80AC5D57D13C" title="如果选择将表决文件存储在Oracle ASM中，则Oracle ASM会将群集的所有表决文件存储在您选择的磁盘组中。">在Oracle ASM上存储投票文件</a></p>
                     </li>
                     <li>
                        <p><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-6F5C4029-78F0-4A06-ADC7-70E1E2C597C8" title="作为任何配置更改的一部分，Oracle Clusterware会自动备份OCR中的投票文件数据，并自动将数据还原到您添加的任何投票文件。">备份投票文件</a></p>
                     </li>
                     <li>
                        <p><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-D977F7F1-94FB-425C-A284-F45C102CE6C1">恢复投票文件</a></p>
                     </li>
                     <li>
                        <p><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-044D58CA-6392-40A1-AB31-C84A2A5A5CE6">添加_删除_或迁移投票文件</a></p>
                     </li>
                  </ul>
                  <div class="infoboxnote" id="GUID-00137A43-61A5-446B-BFEA-D7EFDA535E81__GUID-1E8B8703-4B81-46B8-B353-3CA22CB48159">
                     <p class="notep1">警告：</p>
                     <p>该<code class="codeph">dd</code>用于备份和恢复表决文件Oracle集群件的早期版本中的命令在Oracle集群件<span class="italic">12c</span>中不被支持。恢复使用<code class="codeph">dd</code>或<code class="codeph">cp</code>命令复制的投票文件可能会阻止Oracle Clusterware 12 <span class="italic">c</span>堆栈启动。使用本章中介绍的备份和还原过程可确保正确的投票文件功能。
                     </p>
                  </div>
                  <div class="infoboxnote" id="GUID-00137A43-61A5-446B-BFEA-D7EFDA535E81__GUID-B7A4CAE8-5323-4A41-B880-2BFDF118E95A">
                     <p class="notep1">注意：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>投票文件管理需要有效且有效的OCR。在添加，删除，替换或恢复投票文件之前，请以<code class="codeph">root</code>身份运行<code class="codeph">ocrcheck</code>命令。如果OCR不可用或已损坏，则必须按照<span class="q">“还原Oracle Cluster Registry”中的说明</span>恢复OCR。
                           </p>
                        </li>
                        <li>
                           <p>如果您从以前版本的Oracle集群到Oracle集群<span class="italic">12c的</span>升级，要存储的Oracle ASM磁盘组中投票的文件，则必须将<span class="bold">ASM兼容性</span> （设置<code class="codeph">COMPATIBLE.ASM</code> ）的兼容性属性为<code class="codeph">12.1.0.0</code> 。
                           </p>
                        </li>
                     </ul>
                  </div>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-648BB199-AFB9-416A-8438-E0331C255E78" title="为您的平台恢复OCR的过程。">还原Oracle Cluster Registry</a></li>
                        <li><a href="../ostmg/diskgroup-compatibility.html#OSTMG-GUID-FBB5AA72-5208-48E1-BD8D-0FD4C6876F34" target="_blank"><span><cite>Oracle自动存储管理管理员指南</cite></span></a></li>
                     </ul>
                  </div>
               </div><a id="CWADD91889"></a><div class="props_rev_3"><a id="GUID-7680E1EB-C91F-4B32-82B8-80AC5D57D13C" name="GUID-7680E1EB-C91F-4B32-82B8-80AC5D57D13C"></a><h4 id="CWADD-GUID-7680E1EB-C91F-4B32-82B8-80AC5D57D13C" class="sect4">在Oracle ASM上存储投票文件</h4>
                  <div>
                     <p>如果选择将表决文件存储在Oracle ASM中，则Oracle ASM会将群集的所有表决文件存储在您选择的磁盘组中。</p>
                     <p>Oracle ASM管理投票文件的方式与其存储的其他文件不同。您不能使用存储在Oracle ASM中的投票文件和未存储在同一集群中的Oracle ASM中的投票文件。</p>
                     <p>在Oracle ASM上配置投票文件后，您只能使用<code class="codeph">crsctl replace votedisk</code>命令更改投票文件的配置。即使在没有工作投票文件的情况下也是如此。尽管<code class="codeph">crsctl query css votedisk</code>报告使用了零投票磁盘，但Oracle Clusterware还记得Oracle ASM正在使用中，并且需要<code class="codeph">replace</code>谓词。只有在使用<code class="codeph">replace</code>动词将表决文件移回非Oracle ASM存储之后，动词<code class="codeph">add css votedisk</code>并<code class="codeph">delete css votedisk</code>再次可用。
                     </p>
                     <p>可以存储在特定Oracle ASM磁盘组中的表决文件数取决于磁盘组的冗余。</p>
                     <p>默认情况下，Oracle ASM将每个投票文件放在磁盘组中的自己的故障组中。故障组是磁盘组中磁盘的子集。故障组定义共享组件的磁盘，这样如果一个组件出现故障，则共享该组件的其他磁盘也可能会失败。您可能定义为故障组的示例是一组共享同一SCSI控制器的SCSI磁盘。故障组用于确定用于存储冗余数据的Oracle ASM磁盘。例如，如果为文件指定了双向镜像，则文件范围的冗余副本必须存储在单独的故障组中。</p>
                     <p>您为Oracle ASM磁盘组选择的冗余级别确定Oracle ASM如何镜像磁盘组中的文件，并确定所需的磁盘数和磁盘空间量。如果表决文件位于磁盘组中，则包含Oracle Clusterware文件（OCR和表决文件）的磁盘组具有比其他磁盘组更低的最小故障组数，因为表决文件存储在仲裁失败组中。</p>
                     <p>仲裁失败组是一种特殊类型的故障组，用于存储Oracle Clusterware投票文件。仲裁失败组用于确保指定故障组的法定数量可用。当Oracle ASM安装包含Oracle Clusterware文件的磁盘组时，仲裁失败组用于确定在丢失一个或多个故障组时是否可以装入磁盘组。仲裁失败组中的磁盘不包含用户数据，因此在确定存储用户数据的冗余要求时不考虑仲裁失败组。</p>
                     <p>Oracle ASM Flex磁盘组是支持Oracle ASM文件组和配额组的磁盘组类型。通常，除磁盘组级别外，灵活磁盘组还允许用户以数据库的粒度管理存储。</p>
                     <p>冗余级别包括：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><span class="bold">外部冗余</span> ：外部冗余磁盘组至少需要一个磁盘设备。外部冗余磁盘组中的有效磁盘空间是其所有设备中磁盘空间的总和。
                           </p>
                           <p>由于Oracle ASM不镜像外部冗余磁盘组中的数据，因此Oracle建议您对存储设备（如RAID）或其他提供自己的数据保护机制的类似设备使用外部冗余。</p>
                        </li>
                        <li>
                           <p><span class="bold">正常冗余</span> ：正常冗余磁盘组至少需要两个磁盘设备（或两个故障组）。普通冗余磁盘组中的有效磁盘空间是其所有设备中磁盘空间总和的一半。
                           </p>
                           <p>对于Oracle Clusterware文件，正常冗余磁盘组至少需要三个磁盘设备（故障组使用三个磁盘中的两个，仲裁故障组使用所有三个磁盘）并提供三个投票文件和一个OCR和镜像OCR。使用普通冗余磁盘组时，群集可以在丢失一个故障组后继续运行。</p>
                        </li>
                        <li>
                           <p><span class="bold">高冗余</span> ：在高冗余磁盘组中，Oracle ASM使用三向镜像来提高性能并提供最高级别的可靠性。高冗余磁盘组至少需要三个磁盘设备（或三个故障组）。高冗余磁盘组中的有效磁盘空间是其所有设备中磁盘空间总和的三分之一。
                           </p>
                           <p>对于Oracle Clusterware文件，高冗余磁盘组至少需要五个磁盘设备（故障组使用五个磁盘中的三个，仲裁故障组使用所有五个磁盘）并提供五个投票文件和一个OCR和两个OCR的镜像。通过高冗余，群集可以在丢失两个故障组后继续存在。</p>
                        </li>
                     </ul>
                     <p>使用<code class="codeph">crsctl replace votedisk</code>命令，您可以将一组给定的投票文件从一个Oracle ASM磁盘组移动到另一个，或者移动到经过认证的文件系统上。如果将表决文件从一个Oracle ASM磁盘组移动到另一个Oracle ASM磁盘组，则可以通过将表决文件放在与前一个磁盘组不同的冗余级别的磁盘组中来更改表决文件的数量。
                     </p>
                     <div class="infoboxnote" id="GUID-7680E1EB-C91F-4B32-82B8-80AC5D57D13C__GUID-A64F98A4-44B1-4CBD-87D9-51B30C52BB33">
                        <p class="notep1">注意：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>您无法直接影响一个磁盘组中的投票文件数。</p>
                           </li>
                           <li>
                              <p>你不能使用<code class="codeph">crsctl add | delete votedisk</code>存储在Oracle ASM磁盘组中的投票文件的<code class="codeph">crsctl add | delete votedisk</code>命令，因为Oracle ASM根据磁盘组的冗余级别管理投票文件的数量。
                              </p>
                           </li>
                           <li>
                              <p>如果投票文件存储在Oracle ASM磁盘组中，则无法将投票文件添加到群集文件系统。Oracle不支持在Oracle ASM中同时使用投票文件，也不支持同时在同一集群的集群文件系统上使用投票文件。</p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="../ostmg/diskgroup-compatibility.html#OSTMG-GUID-FBB5AA72-5208-48E1-BD8D-0FD4C6876F34" target="_blank"><span><cite>Oracle自动存储管理管理员指南</cite></span></a></li>
                           <li><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-044D58CA-6392-40A1-AB31-C84A2A5A5CE6">添加，删除或迁移投票文件</a></li>
                        </ul>
                     </div>
                  </div>
               </div><a id="CWADD90960"></a><div class="props_rev_3"><a id="GUID-6F5C4029-78F0-4A06-ADC7-70E1E2C597C8" name="GUID-6F5C4029-78F0-4A06-ADC7-70E1E2C597C8"></a><h4 id="CWADD-GUID-6F5C4029-78F0-4A06-ADC7-70E1E2C597C8" class="sect4">备份投票文件</h4>
                  <div>
                     <p>作为任何配置更改的一部分，Oracle Clusterware会自动备份OCR中的投票文件数据，并自动将数据还原到您添加的任何投票文件。</p>
                     <div class="section">
                        <p>但是，如果所有投票文件都已损坏，您可以按照<span class="q">“恢复投票文件”中的说明</span>恢复它们。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-D977F7F1-94FB-425C-A284-F45C102CE6C1">恢复投票文件</a></li>
                        </ul>
                     </div>
                  </div>
               </div><a id="CWADD90961"></a><div class="props_rev_3"><a id="GUID-D977F7F1-94FB-425C-A284-F45C102CE6C1" name="GUID-D977F7F1-94FB-425C-A284-F45C102CE6C1"></a><h4 id="CWADD-GUID-D977F7F1-94FB-425C-A284-F45C102CE6C1" class="sect4">恢复投票文件</h4>
                  <div>
                     <div class="section">
                        <p>如果所有投票文件都已损坏，则可以将其还原，如下所示：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>如有必要，按<span class="q">“还原Oracle Cluster Registry”中的说明</span>还原OCR。</span><div>
                              <p>仅当OCR也已损坏或无法使用时，此步骤才是必需的，例如，如果OCR位于Oracle ASM上且磁盘组不再可用。</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>仅从一个节点以<code class="codeph">root</code>身份运行以下命令，以独占模式启动Oracle Clusterware堆栈，这不需要投票文件存在或可用：</span><div><pre class="pre codeblock"><code>#crsctl start crs -excl</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>运行<code class="codeph">crsctl query css votedisk</code>命令以检索当前定义的投票文件列表，类似于以下内容：</span><div><pre class="pre codeblock"><code>$ crsctl query css votedisk  -  ----- ----------------- --------- --------- ## STATE文件通用ID文件名磁盘组1。在线6f57843d89464c46ea747362e8a3fa43（/ dev / sdb1）[DATA] 2。在线7c54856e98474f61bf349401e7c9fb95（/ dev / sdc1）[DATA] 3。在线9c46232b76234f61fc934673d5c8ec59（/ dev / sdd1）[DATA]</code></pre><p>如果所有投票文件都已损坏，则此列表可能为空，或者可能具有标记为状态<code class="codeph">3</code>或<code class="codeph">OFF</code>条目。</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>根据您存储投票文件的位置，执行以下操作之一：</span><div>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>如果表决文件存储在Oracle ASM中，则运行以下命令将表决文件迁移到您指定的Oracle ASM磁盘组：</p><pre class="pre codeblock"><code>crsctl替换votedisk + <span class="variable" translate="no">asm_disk_group</span></code></pre><p>迁移表决文件的Oracle ASM磁盘组必须存在于Oracle ASM中。无论投票文件是存储在Oracle ASM还是其他存储设备中，都可以使用此命令。</p>
                                 </li>
                                 <li>
                                    <p>如果未在Oracle ASM中存储投票文件，请使用上一步中获取的文件通用标识符（FUID）运行以下命令：</p><pre class="pre codeblock"><code>$ crsctl删除css votedisk <span class="variable" translate="no">FUID</span></code></pre><p>添加投票文件，如下所示：</p><pre class="pre codeblock"><code>$ crsctl add css votedisk <span class="variable" translate="no">path_to_voting_disk</span></code></pre></li>
                              </ul>
                           </div>
                        </li>
                        <li class="stepexpand"><span>以<code class="codeph">root</code>身份停止Oracle Clusterware堆栈：</span><div><pre class="pre codeblock"><code>#crsctl停止crs</code></pre><div class="infoboxnote" id="GUID-D977F7F1-94FB-425C-A284-F45C102CE6C1__GUID-E8268B76-35CA-4299-8D0A-98A6C11A1637">
                                 <p class="notep1">注意：</p>
                                 <p>如果Oracle Clusterware堆栈以独占模式运行，则使用<code class="codeph">-f</code>选项强制关闭堆栈。
                                 </p>
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>以<code class="codeph">root</code>身份以正常模式重新启动Oracle Clusterware堆栈：</span><div><pre class="pre codeblock"><code>#crsctl start crs</code></pre></div>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-648BB199-AFB9-416A-8438-E0331C255E78" title="为您的平台恢复OCR的过程。">还原Oracle Cluster Registry</a></li>
                           <li><a href="../ostmg/admin-asm-diskgroups.html#OSTMG-GUID-C455CEB1-0FC3-4DF4-9CD4-25EFA4D2BE01" target="_blank"><span><cite>Oracle自动存储管理管理员指南</cite></span></a></li>
                        </ul>
                     </div>
                  </div>
               </div><a id="CWADD90962"></a><div class="props_rev_3"><a id="GUID-044D58CA-6392-40A1-AB31-C84A2A5A5CE6" name="GUID-044D58CA-6392-40A1-AB31-C84A2A5A5CE6"></a><h4 id="CWADD-GUID-044D58CA-6392-40A1-AB31-C84A2A5A5CE6" class="sect4">添加，删除或迁移投票文件</h4>
                  <div>
                     <p><a id="d37753e5993" class="indexterm-anchor"></a><a id="d37753e5997" class="indexterm-anchor"></a><a id="d37753e6001" class="indexterm-anchor"></a>安装Oracle Clusterware后，您可以添加，删除和迁移投票文件。请注意，用于执行此操作的命令是不同的，具体取决于您的投票文件是位于Oracle ASM中还是位于另一个存储选项中。
                     </p>
                  </div>
                  <div class="props_rev_3"><a id="GUID-168E2ACA-185B-48B7-AC17-49422A43A32D" name="GUID-168E2ACA-185B-48B7-AC17-49422A43A32D"></a><h5 id="CWADD-GUID-168E2ACA-185B-48B7-AC17-49422A43A32D" class="sect5">修改Oracle ASM中存储的投票文件</h5>
                     <div>
                        <div class="section">
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>至<a id="d37753e6132" class="indexterm-anchor"></a>显示投票文件FUID和每个当前投票文件的文件路径，运行<code class="codeph">crsctl query css votedisk</code>命令显示类似如下的输出：</p><pre class="oac_no_warn" dir="ltr">$ crsctl query css votedisk  -  ----- ----------------- --------- --------- ## STATE文件通用ID文件名磁盘组1。在线6f57843d89464c46ea747362e8a3fa43（/ dev / sdb1）[DATA] 2。在线7c54856e98474f61bf349401e7c9fb95（/ dev / sdc1）[DATA] 3。在线9c46232b76234f61fc934673d5c8ec59（/ dev / sdd1）[DATA]</pre><p>此命令返回磁盘序列号，磁盘状态，FUID，磁盘路径以及存储磁盘的Oracle ASM磁盘组的名称。</p>
                              </li>
                              <li>
                                 <p><a id="d37753e6148" class="indexterm-anchor"></a>要将表决文件从Oracle ASM迁移到备用存储设备，请使用以下命令指定要用其替换Oracle ASM磁盘组的非Oracle ASM存储设备的路径：</p><pre class="oac_no_warn" dir="ltr">$ crsctl替换votedisk <span class="italic">path_to_voting_disk</span>
</pre><p>您可以在群集中的任何节点上运行此命令。</p>
                              </li>
                              <li>
                                 <p>至<a id="d37753e6163" class="indexterm-anchor"></a>使用Oracle ASM磁盘组中由Oracle ASM管理的投票文件替换未存储在Oracle ASM中的所有投票文件，运行以下命令：</p><pre class="oac_no_warn" dir="ltr">$ crsctl替换votedisk + <span class="italic">asm_disk_group</span></pre></li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
                  <div class="props_rev_3"><a id="GUID-C5843B47-5815-4D64-B455-D27A2752A7A4" name="GUID-C5843B47-5815-4D64-B455-D27A2752A7A4"></a><h5 id="CWADD-GUID-C5843B47-5815-4D64-B455-D27A2752A7A4" class="sect5">修改Oracle ASM上未存储的投票文件</h5>
                     <div>
                        <div class="section">
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>至<a id="d37753e6298" class="indexterm-anchor"></a>显示每个当前投票文件的投票文件FUID和文件路径，运行以下命令：</p><pre class="oac_no_warn" dir="ltr">$ crsctl query css votedisk ## STATE File Universal Id文件名磁盘组 -  ----- ----------------- ---------  - ------- 1。在线7c54856e98474f61bf349401e7c9fb95（/ cfs / host09_vd3）[]</pre><p>此命令返回磁盘序列号，磁盘状态，FUID和磁盘路径，而不返回Oracle ASM磁盘组的名称。</p>
                              </li>
                              <li>
                                 <p>至<a id="d37753e6312" class="indexterm-anchor"></a>添加一个或多个投票文件，运行以下命令，将<span class="italic"><code class="codeph">path_to_voting_disk</code></span>变量替换为要添加的投票文件的一个或多个以空格分隔的完整路径：</p><pre class="oac_no_warn" dir="ltr">$ crsctl add css votedisk <span class="italic">path_to_voting_disk</span> [...]
</pre></li>
                              <li>
                                 <p>至<a id="d37753e6329" class="indexterm-anchor"></a>用投票文件B替换投票文件A，必须添加投票文件B，然后删除投票文件A.要添加新磁盘并删除现有磁盘，请运行以下命令，将<span class="italic"><code class="codeph">path_to_voting_diskB</code></span>变量替换为完全限定的路径名投票文件B：</p><pre class="oac_no_warn" dir="ltr">$ crsctl add css votedisk <span class="italic">path_to_voting_diskB</span> -purge</pre><p><code class="codeph">-purge</code>选项删除现有的投票文件。
                                 </p>
                              </li>
                              <li>
                                 <p>至<a id="d37753e6351" class="indexterm-anchor"></a>删除投票文件，运行以下命令，指定一个或多个以空格分隔的投票文件FUID或逗号分隔的目录路径到要删除的投票文件：</p><pre class="oac_no_warn" dir="ltr">$ crsctl删除css votedisk { <span class="italic">FUID</span> | <span class="italic">path_to_voting_disk</span> [...]}</pre></li>
                           </ul>
                           <div class="infoboxnote" id="GUID-C5843B47-5815-4D64-B455-D27A2752A7A4__GUID-1C98D09D-3B2D-4D56-AAAA-A2558A1E3AC4">
                              <p class="notep1">注意：</p>
                              <p>如果群集已关闭且由于丢失的投票文件而无法重新启动，则必须通过以<code class="codeph">root</code>身份运行以下命令以独占模式启动CSS：</p><pre class="oac_no_warn" dir="ltr">#crsctl start crs -excl</pre><p>在独占模式下启动CSS后，您可以替换投票文件，如下所示：</p><pre class="oac_no_warn" dir="ltr">#crsctl replace votedisk <span class="italic">path_to_voting_disk</span></pre></div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
                  <div class="props_rev_3"><a id="GUID-B2F1E3CA-AD08-41C2-AC07-746F45EFDE3E" name="GUID-B2F1E3CA-AD08-41C2-AC07-746F45EFDE3E"></a><h5 id="CWADD-GUID-B2F1E3CA-AD08-41C2-AC07-746F45EFDE3E" class="sect5">将投票文件迁移到Oracle ASM</h5>
                     <div>
                        <div class="section">
                           <p>至<a id="d37753e6497" class="indexterm-anchor"></a>将表决文件迁移到Oracle ASM，在以下命令中指定Oracle ASM磁盘组名称：</p><pre class="oac_no_warn" dir="ltr">$ crsctl替换votedisk + <span class="italic">asm_disk_group</span>
</pre><p>您可以在群集中的任何节点上运行此命令。</p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
                  <div class="props_rev_3"><a id="GUID-3CFFB9B4-9DD2-45F1-B4AF-90CB5FB51095" name="GUID-3CFFB9B4-9DD2-45F1-B4AF-90CB5FB51095"></a><h5 id="CWADD-GUID-3CFFB9B4-9DD2-45F1-B4AF-90CB5FB51095" class="sect5">验证投票文件位置</h5>
                     <div>
                        <div class="section">
                           <p>修改投票文件后，验证投票文件位置，如下所示：</p><pre class="pre codeblock"><code>$ crsctl查询css votedisk</code></pre></div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>相关话题</strong></p>
                           <ul>
                              <li><a href="oracle-clusterware-control-crsctl-utility-reference.html#GUID-D8EE89D2-BC62-4C16-A157-BFFAD80295F8" title="显示群集同步服务使用的投票文件，投票文件的状态以及磁盘的位置，无论它们是存储在Oracle ASM中还是存储在其他位置。">crsctl查询css votedisk</a></li>
                           </ul>
                        </div>
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>