<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="This procedure provides steps for upgrading non-CDB architecture Oracle Databases.">
      <meta name="description" content="This procedure provides steps for upgrading non-CDB architecture Oracle Databases.">
      <title>Manually Upgrading Non-CDB Architecture Oracle Databases</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Upgrading Non-CDBs on the Same System">
      <meta property="og:description" content="This procedure provides steps for upgrading non-CDB architecture Oracle Databases.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Upgrading Non-CDBs on the Same System">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="upgrading-non-cdbs-same-system.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-01-08T17:30:30-08:00">
      <meta name="dcterms.title" content="Upgrading Non-CDBs on the Same System">
      <meta name="dcterms.dateCopyrighted" content="2018, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="F10896-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="using-dbua-to-upgrade-the-database.html" title="Previous" type="text/html">
      <link rel="next" href="post-upgrde-tasks.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="SPUSS">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="using-dbua-to-upgrade-the-database.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="post-upgrde-tasks.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Upgrading Non-CDBs on the Same System</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="upgrading-db.html" property="item" typeof="WebPage"><span property="name">Upgrading Oracle Database</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Manually Upgrading Non-CDB Architecture Oracle Databases</li>
            </ol>
            <a id="GUID-D6F6D375-B021-47E0-B0C8-B2C0B191AC0D" name="GUID-D6F6D375-B021-47E0-B0C8-B2C0B191AC0D"></a>
            
            <h2 id="SPUSS-GUID-D6F6D375-B021-47E0-B0C8-B2C0B191AC0D" class="sect2">Manually Upgrading Non-CDB Architecture Oracle Databases</h2>
         </header>
         <div class="ind">
            <div>
               <p>This procedure provides steps for upgrading non-CDB architecture Oracle Databases. </p>
               <div class="infoboxnote" id="GUID-D6F6D375-B021-47E0-B0C8-B2C0B191AC0D__GUID-D5B93270-2FC7-49B6-8D0D-3781B096AB7D">
                  <p class="notep1">Note:</p>
                  <p>Starting with Oracle Database 12c Release 1 (12.1), non-CDB architecture is deprecated. It can be desupported in a future release.</p>
               </div>
               <p>Before using this procedure, complete the following steps:</p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p>Install the Oracle Database software</p>
                  </li>
                  <li>
                     <p>Prepare the new Oracle home</p>
                  </li>
                  <li>
                     <p> Run the Pre-Upgrade Information Tool</p>
                  </li>
               </ul>
               <p>Steps:</p>
               <ol>
                  <li>
                     <p>If you have not done so, run the Pre-Upgrade Information Tool. Review the Pre-Upgrade Information Tool output and correct all issues noted in the output before proceeding. </p>
                     <p>For example, on Linux or Unix systems:</p><pre class="pre codeblock"><code> $ORACLE_HOME/jdk/bin/java -jar /opt/oracle/product/19.0.0/rdbms/admin/preupgrade.jar FILE TEXT</code></pre></li>
                  <li>
                     <p>Ensure that you have a proper backup strategy in place.</p>
                  </li>
                  <li>
                     <p>If you have not done so, prepare the new Oracle home.</p>
                  </li>
                  <li>
                     <p>(Conditional) For Oracle RAC environments only, enter the following commands to set the initialization parameter value for CLUSTER_DATABASE to FALSE:</p><pre class="pre codeblock"><code>ALTER SYSTEM SET CLUSTER_DATABASE=FALSE SCOPE=SPFILE;</code></pre></li>
                  <li>
                     <div class="p">Shut down the database. For example:<pre class="pre codeblock"><code>SQL&gt; SHUTDOWN IMMEDIATE
</code></pre></div>
                  </li>
                  <li>
                     <p>If your operating system is Windows, then complete the following steps:</p>
                     <ol type="a">
                        <li>
                           <p>Stop the <code class="codeph">OracleService<span class="variable" translate="no">SID</span></code> Oracle service of the database you are upgrading, where <code class="codeph"><span class="variable" translate="no">SID</span></code> is the instance name. For example, if your <code class="codeph"><span class="variable" translate="no">SID</span></code> is <code class="codeph">ORCL</code>, then enter the following at a command prompt:
                           </p><pre class="pre codeblock"><code>C:\&gt; NET STOP OracleServiceORCL
</code></pre></li>
                        <li>
                           <p>Delete the Oracle service at a command prompt using <code class="codeph">ORADIM</code>. Refer to your platform guide for a complete list of the <code class="codeph">ORADIM</code> syntax and commands.
                           </p>
                           <p>For example, if your <code class="codeph"><span class="variable" translate="no">SID</span></code> is <code class="codeph">ORCL</code>, then enter the following command. 
                           </p><pre class="pre codeblock"><code>C:\&gt; ORADIM -DELETE -SID ORCL
</code></pre></li>
                        <li>
                           <p>Create the service for the new release Oracle Database at a command prompt using the <code>ORADIM</code> command of the new Oracle Database release.
                           </p>
                           <p>Use the following syntax, where <code class="codeph"><span class="variable" translate="no">SID</span></code> is your database SID, <code class="codeph"><span class="variable" translate="no">PASSWORD</span></code> is your system password, <code class="codeph"><span class="variable" translate="no">USERS</span></code> is the value you want to set for maximum number of users, and <code class="codeph"><span class="variable" translate="no">ORACLE_HOME</span></code> is your Oracle home:
                           </p><pre class="pre codeblock"><code>C:\&gt; ORADIM -NEW -SID <span class="variable" translate="no">SID</span> -SYSPWD <span class="variable" translate="no">PASSWORD</span> -MAXUSERS <span class="variable" translate="no">USERS</span>
     -STARTMODE AUTO -PFILE <span class="variable" translate="no">ORACLE_HOME</span>\DATABASE\INIT<span class="variable" translate="no">SID</span>.ORA
</code></pre><p>Most Oracle Database services log on to the system using the privileges of the Oracle software installation owner. The service runs with the privileges of this user. The <code>ORADIM</code> command prompts you to provide the password to this user account. You can specify other options using <code>ORADIM</code>.
                           </p>
                           <p>In the following example, if your <code class="codeph"><span class="variable" translate="no">SID</span></code> is <code class="codeph">ORCL</code>, your <code class="codeph"><span class="variable" translate="no">password</span></code> (<code class="codeph">SYSPWD</code>) is <code class="codeph">TWxy5791</code>, the maximum number of users (<code class="codeph">MAXUSERS</code>) is 10, and the Oracle home path is <code>C:\ORACLE\PRODUCT\19.0.0\DB</code>, then enter the following command:
                           </p><pre class="pre codeblock"><code>C:\&gt; ORADIM -NEW -SID ORCL -SYSPWD TWxy5791 -MAXUSERS 10
-STARTMODE AUTO -PFILE C:\ORACLE\PRODUCT\19.0.0\DB\DATABASE\INITORCL.ORA
</code></pre><p><code>ORADIM</code> writes a log file to the <code>ORACLE_HOME\database</code> directory. 
                           </p>
                           <div class="infoboxnote" id="GUID-D6F6D375-B021-47E0-B0C8-B2C0B191AC0D__GUID-E08A3EC2-BA3E-407A-B3CD-0261C8F6DAEA">
                              <p class="notep1">Note:</p>If you use an Oracle Home User account to own the Oracle home, then the ORADIM command prompts you for that user name and password. 
                           </div>
                        </li>
                     </ol>
                  </li>
                  <li>
                     <p>If your operating system is Linux or UNIX, then perform the following checks:</p>
                     <ol type="a">
                        <li>
                           <p>Your <code class="codeph">ORACLE_SID</code> is set correctly
                           </p>
                        </li>
                        <li>
                           <p>The <code class="codeph">oratab</code> file points to the new Oracle home
                           </p>
                        </li>
                        <li>
                           <p>The following environment variables point to the new Oracle Database directories:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><code class="codeph">ORACLE_HOME</code></p>
                              </li>
                              <li>
                                 <p><code class="codeph">PATH</code></p>
                              </li>
                           </ul>
                        </li>
                        <li>
                           <p>Any scripts that clients use to set the <code class="codeph">$ORACLE_HOME</code> environment variable must point to the new Oracle home.
                           </p>
                        </li>
                     </ol>
                     <div class="infoboxnote" id="GUID-D6F6D375-B021-47E0-B0C8-B2C0B191AC0D__GUID-53B6CC78-A7E6-4D97-8EB4-570FEFA1CECD">
                        <p class="notep1">Note:</p>
                        <p>If you are upgrading an Oracle Real Application Clusters database, then perform these checks on all Oracle Grid Infrastructure nodes where the Oracle Real Application Clusters database has instances configured.</p>
                     </div>
                  </li>
                  <li>
                     <p>Log in to the system as the Oracle installation owner for the new Oracle Database release.</p>
                  </li>
                  <li>
                     <p>Start SQL*Plus in the new Oracle home from the admin directory in the new Oracle home directory.</p>
                     <p>For example:</p><pre class="pre codeblock"><code>$ cd $ORACLE_HOME/rdbms/admin
$ pwd
/u01/app/oracle/product/19.0.0/dbhome_1/rdbms/admin
$ sqlplus</code></pre></li>
                  <li>
                     <p>Copy the SPFILE.ORA or INIT.ORA file from the old Oracle home to the new Oracle home.</p>
                  </li>
                  <li>
                     <div class="p">Connect to the database that you want to upgrade using an account with SYSDBA privileges:<pre class="pre codeblock"><code>SQL&gt; connect / as sysdba
</code></pre></div>
                  </li>
                  <li>
                     <p>Start the non-CDB Oracle Database in upgrade mode:</p><pre class="pre codeblock"><code>SQL&gt; startup upgrade</code></pre><p>If errors appear listing desupported initialization parameters, then make a note of the desupported initialization parameters and continue with the upgrade. Remove the desupported initialization parameters the next time you shut down the database.</p>
                     <div class="infoboxnote" id="GUID-D6F6D375-B021-47E0-B0C8-B2C0B191AC0D__GUID-789184BA-E5B6-4888-9D32-EB9460C2B3E5">
                        <p class="notep1">Note:</p>
                        <p>Starting up the database in <code class="codeph">UPGRADE</code> mode enables you to open a database based on an earlier Oracle Database release. It also restricts log-ins to <code class="codeph">AS SYSDBA</code> sessions, disables system triggers, and performs additional operations that prepare the environment for the upgrade.
                        </p>
                     </div>
                  </li>
                  <li>
                     <p>Exit SQL*Plus.</p>
                     <p>For example:</p><pre class="pre codeblock"><code>SQL&gt; EXIT</code></pre></li>
                  <li>
                     <p>Run the Parallel Upgrade Utility (<code>catctl.pl</code>) script, using the upgrade options that you require for your upgrade.
                     </p>
                     <p>You can run the Parallel Upgrade Utility as a command-line shell command by using the <code class="codeph">dbupgrade</code> shell command, which is located in <code class="codeph"><span class="variable" translate="no">Oracle_home</span>/bin</code>. If you set the PATH environment variable to include <code class="codeph">Oracle_home/bin</code>, then you can run the command directly from your command line. For example:
                     </p><pre class="pre codeblock"><code>$ dbupgrade -d /u01/app/oracle/12.2.0/dbhome_1</code></pre><div class="infoboxnote" id="GUID-D6F6D375-B021-47E0-B0C8-B2C0B191AC0D__GUID-477CE03E-EE8B-41BE-9BE5-695D23ED54F9">
                        <p class="notep1">Note:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>When you run the Parallel Upgrade Utility command, use the <code class="codeph">-d</code> option to specify the filepath for the target Oracle home. Use the<code class="codeph"> -l</code> option to specify the directory that you want to use for spool log files.
                              </p>
                           </li>
                        </ul>
                     </div>
                  </li>
                  <li>
                     <p>The database is shut down after a successful upgrade. Restart the instance so that you reinitialize the system parameters for normal operation. For example:</p><pre class="pre codeblock"><code>SQL&gt; STARTUP
</code></pre><p>This restart, following the database shutdown, flushes all caches, clears buffers, and performs other housekeeping activities. These measures are an important final step to ensure the integrity and consistency of the upgraded Oracle Database software.</p>
                     <div class="infoboxnote" id="GUID-D6F6D375-B021-47E0-B0C8-B2C0B191AC0D__GUID-818FA355-75BB-4CCD-8A90-D3DF53A44330">
                        <p class="notep1">Note:</p>
                        <p>If you encountered a message listing desupported initialization parameters when you started the database, then remove the desupported initialization parameters from the parameter file before restarting it. If necessary, convert the <code class="codeph">SPFILE</code> to a <code class="codeph">PFILE</code>, so that you can edit the file to delete parameters. 
                        </p>
                     </div>
                  </li>
                  <li>
                     <p>Run <code>catcon.pl</code> to start <code>utlrp.sql</code>, and to recompile any remaining invalid objects. 
                     </p>
                     <p>For example: </p><pre class="pre codeblock"><code>$ORACLE_HOME/perl/bin/perl catcon.pl -n 1 -e -b utlrp -d '''.''' utlrp.sql
</code></pre><p>Because you run the command using <code class="codeph">-b utlrp</code>, the log file <code class="codeph">utlrp0.log</code> is generated as the script is run. The log file provides results of the recompile.
                     </p>
                  </li>
                  <li>
                     <p>Run <code>postupgrade_fixups.sql</code>. For example:
                     </p><pre class="pre codeblock"><code>SQL&gt; @postupgrade_fixups.sql</code></pre><div class="infoboxnote" id="GUID-D6F6D375-B021-47E0-B0C8-B2C0B191AC0D__GUID-65C5046E-A9C9-4E07-95D1-2D27D0968BCF">
                        <p class="notep1">Note:</p>
                        <p>If you did not specify to place the script in a different location, then it is in the default path <code class="codeph"><span class="variable" translate="no">Oracle_base</span>/cfgtoollogs/<span class="variable" translate="no">SID</span>/preupgrade</code>, where <code class="codeph"><span class="variable" translate="no">Oracle_base</span></code> is your Oracle base home path, and <code class="codeph"><span class="variable" translate="no">SID</span></code> is your unique database name.
                        </p>
                     </div>
                  </li>
                  <li>
                     <p>Run <code>utlusts.sql</code>. The script verifies that all issues are fixed. 
                     </p>
                     <p>For example:</p><pre class="pre codeblock"><code>SQL&gt; @$ORACLE_HOME/rdbms/admin/utllu122s.sql
</code></pre><p>The log file <code class="codeph">utlu122s0.log</code> is generated as the script is run, which provides the upgrade results. You can also review the upgrade report in <code class="codeph">upg_summary.log</code>.
                     </p>
                     <p>To see information about the state of the database, run <code>utlusts.sql</code> as many times as you want, at any time after the upgrade is completed. If the <code>utlusts.sql</code> script returns errors, or shows components that do not have the status <code class="codeph">VALID</code>, or if the version listed for the component is not the most recent release, then refer to the troubleshooting section in this guide.
                     </p>
                  </li>
                  <li>
                     <p>Ensure that the time zone data files are current by using the <code class="codeph">DBMS_DST PL/SQL</code> package to upgrade the time zone file. You can also adjust the time zone data files after the upgrade. 
                     </p>
                  </li>
                  <li>
                     <p>Exit from SQL*Plus</p>
                     <p>For example:</p><pre class="pre codeblock"><code>SQL&gt; EXIT
</code></pre></li>
                  <li>
                     <p>(Conditional) If you are upgrading an Oracle Real Application Clusters database, then use the following command syntax to upgrade the database configuration in Oracle Clusterware:</p><pre class="pre codeblock"><code>srvctl upgrade database -db <span class="variable" translate="no">db-unique-name</span> -oraclehome <span class="variable" translate="no">oraclehome</span></code></pre><p>In this syntax example, <code class="codeph"><span class="variable" translate="no">db-unique-name</span></code> is the database name (not the instance name), and <code class="codeph"><span class="variable" translate="no">oraclehome</span></code> is the Oracle home location in which the database is being upgraded. The <code>SRVCTL</code> utility supports long GNU-style options, in addition to short command-line interface (CLI) options used in earlier releases.
                     </p>
                  </li>
                  <li>
                     <p>(Conditional) For Oracle RAC environments only, after you have upgraded all nodes, enter the following commands to set the initialization parameter value for CLUSTER_DATABASE to TRUE, and start the database, where <code class="codeph"><span class="variable" translate="no">db_unique_name</span></code> is the name of the Oracle RAC database: 
                     </p><pre class="pre codeblock"><code>ALTER SYSTEM SET CLUSTER_DATABASE=TRUE SCOPE=SPFILE;
srvctl start database -db <span class="variable" translate="no">db_unique_name</span></code></pre></li>
               </ol>
               <p>Your database is now upgraded. You are ready to complete post-upgrade procedures. </p>
               <div class="infoboxnote" id="GUID-D6F6D375-B021-47E0-B0C8-B2C0B191AC0D__GUID-ACC577D0-471E-4AF2-8EBC-B6FAD500DAF1">
                  <p class="notep1">Caution:</p>
                  <p>If you retain the old Oracle software, then never start the upgraded database with the old software. Only start Oracle Database using the start command in the new Oracle Database home. </p>
                  <p>Before you remove the old Oracle environment, relocate any data files in that environment to the new Oracle Database environment. </p>
               </div>
               <div class="infoboxnotealso" id="GUID-D6F6D375-B021-47E0-B0C8-B2C0B191AC0D__GUID-4FD7BF4A-F3A5-4914-9645-22387E206000">
                  <p class="notep1">See Also:</p>
                  <p><a href="../admin/managing-data-files-and-temp-files.html#ADMIN012" target="_blank"><span><cite>Oracle Database Administrator’s Guide</cite></span></a> for information about relocating data files
                  </p>
               </div>
               <p></p>
            </div>
            <div>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>Parent topic:</strong> <a href="upgrading-db.html#GUID-A5C44D47-D082-4284-A370-C3DA100BEADB" title="Oracle offers several methods to upgrade your database, which support the complexities of your enterprise.">Upgrading Oracle Database</a></p>
                  </div>
               </div>
            </div>
            
         </div>
      </article>
   </body>
</html>