<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="Review these topics to understand the upgrade scenarios and procedures for non-CDB Oracle Databases"></meta>
      <meta name="description" content="Review these topics to understand the upgrade scenarios and procedures for non-CDB Oracle Databases"></meta>
      <title>非CDB Oracle数据库的升级方案</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Database Upgrade Guide"></meta>
      <meta property="og:description" content="Review these topics to understand the upgrade scenarios and procedures for non-CDB Oracle Databases"></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Database Upgrade Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="database-upgrade-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-04-25T08:26:31-07:00"></meta>
      <meta name="dcterms.title" content="Database Upgrade Guide"></meta>
      <meta name="dcterms.dateCopyrighted" content="1996, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96252-05"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="upgrading-oracle-database-upgrade-assistant-dbua.html" title="Previous" type="text/html"></link>
      <link rel="next" href="example-manual-upgrade-windows-non-cdb-11203-to-122.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="UPGRD"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="upgrading-oracle-database-upgrade-assistant-dbua.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="example-manual-upgrade-windows-non-cdb-11203-to-122.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">数据库升级指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="upgrading-oracle-database.html" property="item" typeof="WebPage"><span property="name">升级Oracle数据库</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">非CDB Oracle数据库的升级方案</li>
            </ol>
            <a id="GUID-B9505420-7D07-4260-BC2E-D677180365A7" name="GUID-B9505420-7D07-4260-BC2E-D677180365A7"></a>
            
            <h2 id="UPGRD-GUID-B9505420-7D07-4260-BC2E-D677180365A7" class="sect2">非CDB Oracle数据库的升级方案</h2>
         </header>
         <div class="ind">
            <div>
               <p>查看这些主题以了解非CDB Oracle数据库的升级方案和过程</p>
               <div class="infoboxnote" id="GUID-B9505420-7D07-4260-BC2E-D677180365A7__GUID-D88B47E9-6758-4C05-82D0-8D109C7CFD34">
                  <p class="notep1">注意：</p>
                  <p>从Oracle Database 12 <span class="italic">c</span> （第1版（12.1））开始，不推荐使用非CDB体系结构。它可以在将来的版本中得到支持。使用多租户架构部署的Oracle数据库是默认配置选项。早于Oracle Database 12 <span class="italic">c第</span> 1版（12.1.0.1）的所有Oracle数据库版本都使用非CDB架构。
                  </p>
               </div>
               <div class="infoboxnote" id="GUID-B9505420-7D07-4260-BC2E-D677180365A7__GUID-3A52DDB5-E542-4DC6-AE37-2801FF7DF201">
                  <p class="notep1">警告：</p>
                  <p>将兼容的初始化参数设置为12.1.0.2后，无法降级数据库。只有兼容性设置为12.1.0.1时，才可以进行可插拔数据库（PDB）降级。降级可能还有其他限制。</p>
                  <p>在开始升级或降级之前，Oracle强烈建议您将源数据库和目标数据库升级到最新的季度发布更新（更新），发行更新修订（修订），捆绑补丁或补丁集更新（BP或PSU）。</p>
               </div>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="upgrade-scenarios-non-cdb-oracle-databases.html#GUID-B3C0441E-A1F3-47D9-925C-6BFC07B13A54">关于升级非CDB Oracle数据库</a><br>您可以使用Oracle数据库升级助手（DBUA）或使用手动升级过程升级非CDB Oracle数据库。
                  </li>
                  <li class="ulchildlink"><a href="upgrade-scenarios-non-cdb-oracle-databases.html#GUID-D6F6D375-B021-47E0-B0C8-B2C0B191AC0D">手动升级非CDB架构Oracle数据库</a><br>此过程提供了升级非CDB体系结构Oracle数据库的步骤。
                  </li>
                  <li class="ulchildlink"><a href="upgrade-scenarios-non-cdb-oracle-databases.html#GUID-2E5D091C-8578-49EE-92BF-002D8A28BBE7">将非CDB Oracle数据库升级到CDB上的PDB</a><br>使用此过程升级早期版本的非CDB体系结构Oracle数据库，使其成为可插拔数据库（PDB）并将PDB插入容器数据库（CDB）。
                  </li>
                  <li class="ulchildlink"><a href="upgrade-scenarios-non-cdb-oracle-databases.html#GUID-9456CC2B-46D0-4083-93F3-3B20A00D5A79">使用Fleet补丁和配置升级Oracle数据库</a><br>在Oracle Database 12c第2版（12.2）及更高版本中，您可以使用Fleet Patching和Provisioning升级早期版本的Oracle数据库。
                  </li>
                  <li class="ulchildlink"><a href="upgrade-scenarios-non-cdb-oracle-databases.html#GUID-9CA1706D-77B5-441A-A62C-0737C3C38214">在Windows上升级Oracle数据库时使用ORADIM的变量</a><br>如果要使用ORADIM实用程序在Windows系统上升级Oracle数据库，请查看这些变量。
                  </li>
               </ul>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>父主题：</strong> <a href="upgrading-oracle-database.html#GUID-CC88F262-3370-4FFA-8604-EDA9F20F56D9" title="Oracle提供了一套全面的工具，用于以最短的停机时间升级Oracle数据库，以及将应用程序迁移到新版本。">升级Oracle数据库</a></p>
                  </div>
               </div>
            </div>
            <a id="UPGRD60155"></a><div class="props_rev_3"><a id="GUID-B3C0441E-A1F3-47D9-925C-6BFC07B13A54" name="GUID-B3C0441E-A1F3-47D9-925C-6BFC07B13A54"></a><h3 id="UPGRD-GUID-B3C0441E-A1F3-47D9-925C-6BFC07B13A54" class="sect3">关于升级非CDB Oracle数据库</h3>
               <div>
                  <p>您可以使用Oracle数据库升级助手（DBUA）或使用手动升级过程升级非CDB Oracle数据库。</p>
                  <p>非CDB体系结构Oracle数据库无法使用多租户体系结构，也不包含可插拔数据库（PDB）。您可以使用Oracle数据库升级助手（DBUA）或执行手动升级来升级数据库。</p>
                  <p></p>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="upgrading-oracle-database-upgrade-assistant-dbua.html#GUID-BBF591A5-EB02-405A-9F99-572429838C73">使用Oracle数据库升级助手（DBUA）进行升级</a></li>
                        <li><a href="upgrade-scenarios-non-cdb-oracle-databases.html#GUID-D6F6D375-B021-47E0-B0C8-B2C0B191AC0D">手动升级非CDB架构Oracle数据库</a></li>
                        <li><a href="downgrading-oracle-db-after-upgrade.html#GUID-CAD9888A-2E6E-48F8-938C-B3E861738606">将Oracle数据库降级为早期版本</a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="upgrade-scenarios-non-cdb-oracle-databases.html#GUID-B9505420-7D07-4260-BC2E-D677180365A7" title="查看这些主题以了解非CDB Oracle数据库的升级方案和过程">非CDB Oracle数据库的升级方案</a></p>
                     </div>
                  </div>
               </div>
            </div>
            <div class="props_rev_3"><a id="GUID-D6F6D375-B021-47E0-B0C8-B2C0B191AC0D" name="GUID-D6F6D375-B021-47E0-B0C8-B2C0B191AC0D"></a><h3 id="UPGRD-GUID-D6F6D375-B021-47E0-B0C8-B2C0B191AC0D" class="sect3">手动升级非CDB架构Oracle数据库</h3>
               <div>
                  <p>此过程提供了升级非CDB体系结构Oracle数据库的步骤。</p>
                  <div class="infoboxnote" id="GUID-D6F6D375-B021-47E0-B0C8-B2C0B191AC0D__GUID-D5B93270-2FC7-49B6-8D0D-3781B096AB7D">
                     <p class="notep1">注意：</p>
                     <p>从Oracle Database 12c第1版（12.1）开始，不推荐使用非CDB体系结构。它可以在将来的版本中得到支持。</p>
                  </div>
                  <p>在使用此过程之前，请完成以下步骤：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>安装Oracle数据库软件</p>
                     </li>
                     <li>
                        <p>准备新的Oracle主页</p>
                     </li>
                     <li>
                        <p>运行升级前信息工具</p>
                     </li>
                  </ul>
                  <p>脚步：</p>
                  <ol>
                     <li>
                        <p>如果尚未执行此操作，请运行升级前信息工具。在继续之前，请查看升级前信息工具输出并更正输出中记录的所有问题。</p>
                        <p>例如，在Linux或Unix系统上：</p><pre class="pre codeblock"><code>$ ORACLE_HOME / jdk / bin / java -jar /opt/oracle/product/19.0.0/rdbms/admin/preupgrade.jar文件文本</code></pre></li>
                     <li>
                        <p>确保您有适当的备份策略。</p>
                     </li>
                     <li>
                        <p>如果您还没有这样做，请准备新的Oracle主目录。</p>
                     </li>
                     <li>
                        <p>（视情况而定）仅对于Oracle RAC环境，输入以下命令将CLUSTER_DATABASE的初始化参数值设置为FALSE：</p><pre class="pre codeblock"><code>ALTER SYSTEM SET CLUSTER_DATABASE = FALSE SCOPE = SPFILE;</code></pre></li>
                     <li>
                        <div class="p">关闭数据库。例如：<pre class="pre codeblock"><code>SQL&gt; SHUTDOWN IMMEDIATE</code></pre></div>
                     </li>
                     <li>
                        <p>如果您的操作系统是Windows，请完成以下步骤：</p>
                        <ol type="a">
                           <li>
                              <p>停止要升级的数据库的<code class="codeph">OracleService <span class="variable" translate="no">SID</span></code> Oracle服务，其中<code class="codeph"><span class="variable" translate="no">SID</span></code>是实例名称。例如，如果您的<code class="codeph"><span class="variable" translate="no">SID</span></code>是<code class="codeph">ORCL</code> ，则在命令提示符处输入以下内容：</p><pre class="pre codeblock"><code>C：\&gt; NET STOP OracleServiceORCL</code></pre></li>
                           <li>
                              <p>使用<code class="codeph">ORADIM</code>在命令提示符处删除Oracle服务。有关<code class="codeph">ORADIM</code>语法和命令的完整列表，请参阅平台指南。
                              </p>
                              <p>例如，如果您的<code class="codeph"><span class="variable" translate="no">SID</span></code>是<code class="codeph">ORCL</code> ，则输入以下命令。
                              </p><pre class="pre codeblock"><code>C：\&gt; ORADIM -DELETE -SID ORCL</code></pre></li>
                           <li>
                              <p>使用新Oracle Database发行版的<code>ORADIM</code>命令在命令提示符处为新版本Oracle Database创建服务。
                              </p>
                              <p>使用以下语法，其中<code class="codeph"><span class="variable" translate="no">SID</span></code>是您的数据库SID， <code class="codeph"><span class="variable" translate="no">PASSWORD</span></code>是您的系统密码， <code class="codeph"><span class="variable" translate="no">USERS</span></code>是您要为最大用户数设置的值， <code class="codeph"><span class="variable" translate="no">ORACLE_HOME</span></code>是您的Oracle主目录：</p><pre class="pre codeblock"><code>C：\&gt; ORADIM -NEW -SID <span class="variable" translate="no">SID</span> -SYSPWD <span class="variable" translate="no">PASSWORD</span> -MAXUSERS <span class="variable" translate="no">USERS</span> -STARTMODE AUTO -PILE <span class="variable" translate="no">ORACLE_HOME</span> \ DATABASE \ INIT <span class="variable" translate="no">SID</span> .ORA</code></pre><p>大多数Oracle数据库服务使用Oracle软件安装所有者的权限登录系统。该服务以该用户的权限运行。<code>ORADIM</code>命令会提示您为此用户帐户提供密码。您可以使用<code>ORADIM</code>指定其他选项。</p>
                              <p>在以下示例中，如果您的<code class="codeph"><span class="variable" translate="no">SID</span></code>是<code class="codeph">ORCL</code> ，则您的<code class="codeph"><span class="variable" translate="no">password</span></code> （ <code class="codeph">SYSPWD</code> ）是<code class="codeph">TWxy5791</code> ，最大用户数（ <code class="codeph">MAXUSERS</code> ）是10，Oracle主路径是<code>C:\ORACLE\PRODUCT\19.0.0\DB</code> ，然后输入以下命令：</p><pre class="pre codeblock"><code>C：\&gt; ORADIM -NEW -SID ORCL -SYSPWD TWxy5791 -MAXUSERS 10 -STARTMODE AUTO -PFILE C：\ ORACLE \ PRODUCT \ 19.0.0 \ DB \ DATABASE \ INITORCL.ORA</code></pre><p><code>ORADIM</code>将日志文件写入<code>ORACLE_HOME\database</code>目录。
                              </p>
                              <div class="infoboxnote" id="GUID-D6F6D375-B021-47E0-B0C8-B2C0B191AC0D__GUID-E08A3EC2-BA3E-407A-B3CD-0261C8F6DAEA">
                                 <p class="notep1">注意：</p>如果您使用Oracle Home User帐户拥有Oracle主目录，则ORADIM命令会提示您输入该用户名和密码。
                              </div>
                           </li>
                        </ol>
                     </li>
                     <li>
                        <p>如果您的操作系统是Linux或UNIX，请执行以下检查：</p>
                        <ol type="a">
                           <li>
                              <p>您的<code class="codeph">ORACLE_SID</code>设置正确</p>
                           </li>
                           <li>
                              <p><code class="codeph">oratab</code>文件指向新的Oracle主目录</p>
                           </li>
                           <li>
                              <p>以下环境变量指向新的Oracle数据库目录：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><code class="codeph">ORACLE_HOME</code></p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">路径</code></p>
                                 </li>
                              </ul>
                           </li>
                           <li>
                              <p>客户端用于设置<code class="codeph">$ORACLE_HOME</code>环境变量的任何脚本都必须指向新的Oracle主目录。
                              </p>
                           </li>
                        </ol>
                        <div class="infoboxnote" id="GUID-D6F6D375-B021-47E0-B0C8-B2C0B191AC0D__GUID-53B6CC78-A7E6-4D97-8EB4-570FEFA1CECD">
                           <p class="notep1">注意：</p>
                           <p>如果要升级Oracle Real Application Clusters数据库，请在Oracle Real Application Clusters数据库配置了实例的所有Oracle Grid Infrastructure节点上执行这些检查。</p>
                        </div>
                     </li>
                     <li>
                        <p>以新Oracle Database版本的Oracle安装所有者身份登录系统。</p>
                     </li>
                     <li>
                        <p>从新Oracle主目录中的admin目录启动新Oracle主目录中的SQL * Plus。</p>
                        <p>例如：</p><pre class="pre codeblock"><code>$ cd $ ORACLE_HOME / rdbms / admin $ pwd /u01/app/oracle/product/19.0.0/dbhome_1/rdbms/admin $ sqlplus</code></pre></li>
                     <li>
                        <p>将SPFILE.ORA或INIT.ORA文件从旧的Oracle主目录复制到新的Oracle主目录。</p>
                     </li>
                     <li>
                        <div class="p">使用具有SYSDBA权限的帐户连接到要升级的数据库：<pre class="pre codeblock"><code>SQL&gt; connect / as sysdba</code></pre></div>
                     </li>
                     <li>
                        <p>以升级模式启动非CDB Oracle数据库：</p><pre class="pre codeblock"><code>SQL&gt;启动升级</code></pre><p>如果出现列出不支持的初始化参数的错误，请记下不支持的初始化参数并继续升级。下次关闭数据库时删除不支持的初始化参数。</p>
                        <div class="infoboxnote" id="GUID-D6F6D375-B021-47E0-B0C8-B2C0B191AC0D__GUID-789184BA-E5B6-4888-9D32-EB9460C2B3E5">
                           <p class="notep1">注意：</p>
                           <p>以<code class="codeph">UPGRADE</code>模式启动数据库使您可以基于早期的Oracle数据库版本打开数据库。它还将登录限制为<code class="codeph">AS SYSDBA</code>会话，禁用系统触发器，并执行其他操作以准备升级环境。
                           </p>
                        </div>
                     </li>
                     <li>
                        <p>退出SQL * Plus。</p>
                        <p>例如：</p><pre class="pre codeblock"><code>SQL&gt; EXIT</code></pre></li>
                     <li>
                        <p>使用升级所需的升级选项运行并行升级实用程序（ <code>catctl.pl</code> ）脚本。
                        </p>
                        <p>您可以使用<code class="codeph">dbupgrade</code> shell命令将并行升级实用程序作为命令行shell命令运行，该命令位于<code class="codeph"><span class="variable" translate="no">Oracle_home</span> /bin</code> 。如果将PATH环境变量设置为包含<code class="codeph">Oracle_home/bin</code> ，则可以直接从命令行运行该命令。例如：</p><pre class="pre codeblock"><code>$ dbupgrade -d /u01/app/oracle/19.1.0/dbhome_1</code></pre><div class="infoboxnote" id="GUID-D6F6D375-B021-47E0-B0C8-B2C0B191AC0D__GUID-477CE03E-EE8B-41BE-9BE5-695D23ED54F9">
                           <p class="notep1">注意：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>运行Parallel Upgrade Utility命令时，请使用<code class="codeph">-d</code>选项指定目标Oracle主目录的文件路径。使用<code class="codeph">-l</code>选项指定要用于假脱机日志文件的目录。
                                 </p>
                              </li>
                           </ul>
                        </div>
                     </li>
                     <li>
                        <p>成功升级后，数据库将关闭。重新启动实例，以便重新初始化系统参数以进行正常操作。例如：</p><pre class="pre codeblock"><code>SQL&gt; STARTUP</code></pre><p>在数据库关闭后重新启动，刷新所有缓存，清除缓冲区并执行其他内务处理活动。这些措施是确保升级的Oracle数据库软件的完整性和一致性的重要最后一步。</p>
                        <div class="infoboxnote" id="GUID-D6F6D375-B021-47E0-B0C8-B2C0B191AC0D__GUID-818FA355-75BB-4CCD-8A90-D3DF53A44330">
                           <p class="notep1">注意：</p>
                           <p>如果在启动数据库时遇到列出不支持的初始化参数的消息，则在重新启动之前从参数文件中删除不支持的初始化参数。如有必要，将<code class="codeph">SPFILE</code>转换为<code class="codeph">PFILE</code> ，以便您可以编辑该文件以删除参数。
                           </p>
                        </div>
                     </li>
                     <li>
                        <p>运行<code>catcon.pl</code>以启动<code>utlrp.sql</code> ，并重新编译任何剩余的无效对象。
                        </p>
                        <p>例如：</p><pre class="pre codeblock"><code>$ ORACLE_HOME / perl / bin / perl catcon.pl -n 1 -e -b utlrp -d'''。'''utlrp.sql</code></pre><p>因为使用<code class="codeph">-b utlrp</code>运行命令，所以在脚本运行时会生成日志文件<code class="codeph">utlrp0.log</code> 。日志文件提供重新编译的结果。
                        </p>
                     </li>
                     <li>
                        <p>运行<code>postupgrade_fixups.sql</code> 。例如：</p><pre class="pre codeblock"><code>SQL&gt; @ postupgrade_fixups.sql</code></pre><div class="infoboxnote" id="GUID-D6F6D375-B021-47E0-B0C8-B2C0B191AC0D__GUID-65C5046E-A9C9-4E07-95D1-2D27D0968BCF">
                           <p class="notep1">注意：</p>
                           <p>如果您未指定将脚本放在其他位置，则它位于默认路径<code class="codeph"><span class="variable" translate="no">Oracle_base</span> /cfgtoollogs/ <span class="variable" translate="no">SID</span> /preupgrade</code> ，其中<code class="codeph"><span class="variable" translate="no">Oracle_base</span></code>是您的Oracle基本主路径， <code class="codeph"><span class="variable" translate="no">SID</span></code>是您唯一的数据库名称。
                           </p>
                        </div>
                     </li>
                     <li>
                        <p>运行<code>utlusts.sql</code> 。该脚本验证所有问题是否已修复。
                        </p>
                        <p>例如：</p><pre class="pre codeblock"><code>SQL&gt; @ $ ORACLE_HOME / rdbms / admin / utlusts.sql</code></pre><p>运行脚本时会生成日志文件<code class="codeph">utlrp0.log</code> ，提供升级结果。您还可以在<code class="codeph">upg_summary.log</code>查看升级报告。
                        </p>
                        <p>要查看有关数据库状态的信息，请在升级完成后随时多次运行<code>utlusts.sql</code> 。如果<code>utlusts.sql</code>脚本返回错误，或显示状态为<code class="codeph">VALID</code>的组件，或者为该组件列出的版本不是最新版本，请参阅本指南中的故障排除部分。
                        </p>
                     </li>
                     <li>
                        <p>使用<code class="codeph">DBMS_DST PL/SQL</code>程序包升级时区文件，确保时区数据文件是最新的。您还可以在升级后调整时区数据文件。
                        </p>
                     </li>
                     <li>
                        <p>退出SQL * Plus</p>
                        <p>例如：</p><pre class="pre codeblock"><code>SQL&gt; EXIT</code></pre></li>
                     <li>
                        <p>（视情况而定）如果要升级Oracle Real Application Clusters数据库，请使用以下命令语法升级Oracle Clusterware中的数据库配置：</p><pre class="pre codeblock"><code>srvctl升级数据库-db <span class="variable" translate="no">db-unique-name</span> -oraclehome <span class="variable" translate="no">oraclehome</span></code></pre><p>在此语法示例中， <code class="codeph"><span class="variable" translate="no">db-unique-name</span></code>是数据库名称（而不是实例名称）， <code class="codeph"><span class="variable" translate="no">oraclehome</span></code>是升级数据库的Oracle主目录位置。除了早期版本中使用的简短命令行界面（CLI）选项之外， <code>SRVCTL</code>实用程序还支持长GNU样式选项。
                        </p>
                     </li>
                     <li>
                        <p>（视情况而定）仅对于Oracle RAC环境，在升级所有节点后，输入以下命令将CLUSTER_DATABASE的初始化参数值设置为TRUE，并启动数据库，其中<code class="codeph"><span class="variable" translate="no">db_unique_name</span></code>是Oracle RAC数据库的名称：</p><pre class="pre codeblock"><code>ALTER SYSTEM SET CLUSTER_DATABASE = TRUE SCOPE = SPFILE; srvctl start database -db <span class="variable" translate="no">db_unique_name</span></code></pre></li>
                  </ol>
                  <p>您的数据库现已升级。您已准备好完成升级后的过程。</p>
                  <div class="infoboxnote" id="GUID-D6F6D375-B021-47E0-B0C8-B2C0B191AC0D__GUID-ACC577D0-471E-4AF2-8EBC-B6FAD500DAF1">
                     <p class="notep1">警告：</p>
                     <p>如果您保留旧的Oracle软件，则永远不要使用旧软件启动升级的数据库。仅使用新Oracle Database主目录中的start命令启动Oracle数据库。</p>
                     <p>在删除旧的Oracle环境之前，请将该环境中的所有数据文件重定位到新的Oracle数据库环境。</p>
                  </div>
                  <div class="infoboxnotealso" id="GUID-D6F6D375-B021-47E0-B0C8-B2C0B191AC0D__GUID-4FD7BF4A-F3A5-4914-9645-22387E206000">
                     <p class="notep1">也可以看看：</p>
                     <p>有关重定位数据文件的信息，请参见<a href="../admin/managing-data-files-and-temp-files.html#ADMIN012" target="_blank"><span><cite>“Oracle数据库管理员指南”</cite></span></a></p>
                  </div>
                  <p></p>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="upgrade-scenarios-non-cdb-oracle-databases.html#GUID-B9505420-7D07-4260-BC2E-D677180365A7" title="查看这些主题以了解非CDB Oracle数据库的升级方案和过程">非CDB Oracle数据库的升级方案</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="props_rev_3"><a id="GUID-2E5D091C-8578-49EE-92BF-002D8A28BBE7" name="GUID-2E5D091C-8578-49EE-92BF-002D8A28BBE7"></a><h3 id="UPGRD-GUID-2E5D091C-8578-49EE-92BF-002D8A28BBE7" class="sect3">将非CDB Oracle数据库升级到CDB上的PDB</h3>
               <div>
                  <p>使用此过程升级早期版本的非CDB体系结构Oracle数据库，使其成为可插拔数据库（PDB）并将PDB插入容器数据库（CDB）。</p>
                  <p>您可以使用DBUA或并行升级实用程序升级早期版本的Oracle数据库，然后将升级后的数据库设置为可插拔数据库（PDB）。然后，您可以将升级的数据库插入多租户容器数据库（CDB）。</p>
                  <p>以下过程假定以下条件：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>您已完成操作系统的Oracle数据库文档中描述的所有升级前过程。</p>
                     </li>
                     <li>
                        <p>较早的数据库和升级的数据库位于同一系统上。</p>
                     </li>
                     <li>
                        <p>升级前后数据文件保留在同一位置。</p>
                        <p>如果数据文件已复制到其他位置（例如，与Oracle ASM一起存储），则必须在步骤8中指定参数<code class="codeph">SOURCE_FILE_NAME_CONVERT</code> 。
                        </p>
                     </li>
                  </ul>
                  <ol>
                     <li>
                        <p>安装新的Oracle Database 19c软件。</p>
                     </li>
                     <li>
                        <p>按照本指南中的说明升级数据库。</p>
                     </li>
                     <li>
                        <p>如果您尚未在升级过程中执行此操作，请将<span class="parmname" translate="no">COMPATIBLE</span>参数设置为19.0.0。
                        </p>
                     </li>
                     <li>
                        <p>使用以下SQL命令确保数据库处于只读模式：</p><pre class="pre codeblock"><code>SQL&gt; startup mount SQL&gt; alter database open read only;</code></pre></li>
                     <li>
                        <p>确保满足插入未插入PDB的先决条件。</p>
                     </li>
                     <li>
                        <p>为PDB创建XML文件。 XML文件的根名称与PDB的名称匹配。在以下语法示例中， <span class="variable" translate="no">path</span>的值是保存XML的位置， <span class="variable" translate="no">myPDB</span> .xml是可插入数据库文件的名称。您可以选择要放置文件的位置。
                        </p><pre class="pre codeblock"><code>SQL&gt; exec DBMS_PDB.DESCRIBE（' <span class="variable" translate="no">path</span> / <span class="variable" translate="no">myPDB</span> .xml'）;</code></pre><p>例如， <span class="variable" translate="no">path</span>是<code>/home/oracle</code> ， <span class="variable" translate="no">myPDB</span>是<code>salespdb</code> ：</p><pre class="pre codeblock"><code>SQL&gt; exec DBMS_PDB.DESCRIBE（'/ home / oracle / salespdb.xml'）;</code></pre></li>
                     <li>
                        <p>使用以下命令关闭旧（源）Oracle主目录中的数据库：</p><pre class="pre codeblock"><code>SQL&gt; SHUTDOWN IMMEDIATE</code></pre></li>
                     <li>
                        <p>将目录更改为新的Oracle主目录，然后运行DBMS_PDB.CHECK_PLUG_COMPATIBILITY函数。</p>
                        <p>运行该功能时，请设置以下参数：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code>pdb_descr_file</code>将此参数设置为XML文件的完整路径。
                              </p>
                           </li>
                           <li>
                              <p><code>pdb_name</code>指定新PDB的名称。如果省略此参数，则使用XML文件中的PDB名称。
                              </p>
                           </li>
                        </ul>
                        <p></p>
                        <p>例如，要确定文件<code>/disk1/usr/salespdb.xml</code>描述的PDB是否与当前CDB兼容，请从新的Oracle主目录运行以下PL / SQL块：</p><pre class="pre codeblock"><code>sqlplus / as sysdba SQL&gt;在SQL上设置serveroutput&gt; r 1 DECLARE 2兼容CONSTANT VARCHAR2（3）：= 3 CASE DBMS_PDB.CHECK_PLUG_COMPATIBILITY（4 pdb_descr_file =&gt;'/ home / oracle / ORAOP2.xml'，5 pdb_name =&gt;'SALESPDB '）6如果是，那么'是'7'否''8结束; 9 BEGIN 10 DBMS_OUTPUT.PUT_LINE（兼容）; 11 * END; YES PL / SQL过程成功完成。</code></pre><p>如果输出为<samp class="sysout">YES</samp> ，则PDB兼容，您可以继续下一步。
                        </p>
                        <p>如果输出为<samp class="sysout">NO</samp> ，则PDB不兼容，您可以检查PDB_PLUG_IN_VIOLATIONS视图以查看它不兼容的原因。
                        </p>
                     </li>
                     <li>
                        <p>使用以下命令语法创建可插拔数据库，并将数据库插入CDB：</p><pre class="pre codeblock"><code>SQL&gt; CREATE PLUGGABLE DATABASE SALESPDB使用' <span class="variable" translate="no">path</span> <span class="variable" translate="no">myPDB</span> .xml'NOCOPY TEMPFILE REUSE;</code></pre><p>以下示例显示了创建可插拔数据库<code class="codeph">salespdb</code>的命令：</p><pre class="pre codeblock"><code>SQL&gt; CREATE PLUGGABLE DATABASE salespdb使用'/home/oracle/salespdb.xml'NOCOPY TEMPFILE REUSE;</code></pre><p>您可以为PDB使用任何名称，但您使用的名称在此CDB中必须是唯一的。 <code class="codeph">TEMPFILE REUSE</code>指定可以重用现有的<code class="codeph">TEMP</code>表空间。
                        </p>
                        <p>此SQL命令完成时，应显示以下消息：</p><pre class="pre codeblock"><code>可插拔数据库已创建。</code></pre><p>升级后的数据库现在是PDB，您可以将其放入CDB中。</p>
                        <div class="infoboxnote" id="GUID-2E5D091C-8578-49EE-92BF-002D8A28BBE7__GUID-01D6D612-2C06-461E-8DB3-24C2F15A5E1C">
                           <p class="notep1">警告：</p>
                           <p>在您使用NOCOPY选项之前，Oracle强烈建议您使用有效的备份。如果此命令失败，无论出于何种原因，那么您的数据库可能会损坏且无法恢复。</p>
                        </div>
                     </li>
                     <li>
                        <p>使用以下命令连接到PDB：</p><pre class="pre codeblock"><code>SQL&gt; ALTER SESSION set container = salespdb;</code></pre></li>
                     <li>
                        <p>将字典转换为PDB类型。从<code class="codeph">admin</code>目录中，运行<code>noncdb_to_pdb.sql</code>脚本。您必须先运行此脚本，然后才能首次打开PDB。
                        </p>
                        <p>例如：</p><pre class="pre codeblock"><code>@ $ ORACLE_HOME / RDBMS /管理/ noncdb_to_pdb.sql</code></pre><div class="infoboxnote" id="GUID-2E5D091C-8578-49EE-92BF-002D8A28BBE7__GUID-A1D45F80-036D-44AB-BFFF-84332B320A0A">
                           <p class="notep1">注意：</p>
                           <p>请注意，此脚本的运行时间可能从几分钟到一个多小时不等，具体取决于必须转换的新PDB字典中对象的数量和类型。</p>
                        </div>
                     </li>
                     <li>
                        <p>以读/写模式启动并打开新的PDB。您必须在Oracle数据库的读/写模式下打开新的PDB，才能完成新PDB与CDB的集成。</p>
                        <p>例如，因为您已将PDB容器设置为<code class="codeph">salespdb</code> ，请输入以下命令以启动PDB：</p><pre class="pre codeblock"><code>SQL&gt; STARTUP</code></pre></li>
                     <li>
                        <p>使用RMAN（恢复管理器）备份PDB。</p>
                        <p>Oracle强烈建议您使用RMAN执行PDB备份，因为在将数据库转换为PDB之前，您无法再使用从数据库中获取的ARCHIVELOG和备份。</p>
                        <div class="infoboxnote" id="GUID-2E5D091C-8578-49EE-92BF-002D8A28BBE7__GUID-EAA907D9-880C-498D-9BC7-E8179BDB7647">
                           <p class="notep1">警告：</p>
                           <p>您必须执行立即备份以确保可恢复性。</p>
                        </div>
                     </li>
                  </ol>
                  <div class="section">
                     <p></p>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="../bradv/backing-up-database.html#BRADV428" target="_blank"><span><cite>Oracle数据库备份和恢复用户指南</cite></span></a></li>
                        <li><a href="../admin/index.html" target="_blank"><span><cite>Oracle数据库管理员指南</cite></span></a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="upgrade-scenarios-non-cdb-oracle-databases.html#GUID-B9505420-7D07-4260-BC2E-D677180365A7" title="查看这些主题以了解非CDB Oracle数据库的升级方案和过程">非CDB Oracle数据库的升级方案</a></p>
                     </div>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-9456CC2B-46D0-4083-93F3-3B20A00D5A79" name="GUID-9456CC2B-46D0-4083-93F3-3B20A00D5A79"></a><h3 id="UPGRD-GUID-9456CC2B-46D0-4083-93F3-3B20A00D5A79" class="sect3">使用Fleet补丁和配置升级Oracle数据库</h3>
               <div>
                  <p>在Oracle Database 12c第2版（12.2）及更高版本中，您可以使用Fleet Patching和Provisioning升级早期版本的Oracle数据库。</p>
                  <div class="section">
                     <p>通过创建新Oracle数据库发行版的副本，并使用命令<code>rhpctl upgrade database</code>升级早期版本的Oracle数据库，可以使用Fleet Patching和Provisioning升级数据库。升级是不合适的升级。升级完成后，侦听器和其他初始化变量将设置为指向新的Oracle主目录。有关如何创建Fleet Patching和Provisioning映像的详细信息，请参阅“ <cite>Oracle Clusterware管理和部署指南”</cite> 。
                     </p>
                     <p>使用此步骤概述了解如何使用Rapid Home Provisioning升级Oracle Database 11g第2版（11.2.0.3）：</p>
                     <ol>
                        <li>
                           <p>安装新的Oracle数据库版本。</p>
                        </li>
                        <li>
                           <p>根据标准操作环境（SOE）的规范修补，测试和配置数据库。</p>
                        </li>
                        <li>
                           <p>从SOE版本的Oracle数据库主页创建一个Fleet Patching and Provisioning Gold Image。</p>
                        </li>
                        <li>
                           <p>在要升级的数据库所在的服务器上完成对新的Oracle Grid Infrastructure版本的升级。您可以使用Fleet Patching and Provisioning完成此升级。（注意：您的Oracle Grid Infrastraucture软件必须始终与Oracle数据库软件相同或更新。）</p>
                        </li>
                        <li>
                           <p>将新版本Oracle Database Fleet Patching and Provisioning gold image的副本部署到具有您要升级的早期版本Oracle数据库的服务器。</p>
                        </li>
                        <li>
                           <p>运行Fleet Patching and Provisioning命令<code>rhpctl upgrade database</code> 。此命令使用新版本的Fleet Patching和Provisioning黄金映像来升级早期版本的数据库。您可以在使用新版Oracle数据库黄金映像配置的服务器上升级一个，多个或所有早期版本的Oracle数据库实例。
                           </p>
                        </li>
                     </ol>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="../cwadd/rapid-home-provisioning.html#CWADD92402" target="_blank"><span><cite>“Oracle Clusterware管理和部署指南”</cite></span></a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="upgrade-scenarios-non-cdb-oracle-databases.html#GUID-B9505420-7D07-4260-BC2E-D677180365A7" title="查看这些主题以了解非CDB Oracle数据库的升级方案和过程">非CDB Oracle数据库的升级方案</a></p>
                     </div>
                  </div>
               </div>
            </div>
            <div class="props_rev_3"><a id="GUID-9CA1706D-77B5-441A-A62C-0737C3C38214" name="GUID-9CA1706D-77B5-441A-A62C-0737C3C38214"></a><h3 id="UPGRD-GUID-9CA1706D-77B5-441A-A62C-0737C3C38214" class="sect3">在Windows上升级Oracle数据库时使用ORADIM的变量</h3>
               <div>
                  <p>如果要使用ORADIM实用程序在Windows系统上升级Oracle数据库，请查看这些变量。</p>
                  <div class="section">
                     <p>在Windows平台上， <code class="codeph">ORADIM</code>提供了一个命令行界面，用于手动执行Windows数据库和服务的管理任务。Database Configuration Assistant（DBCA）提供了一个图形用户界面来执行相同的任务。升级Oracle数据库时必须了解的ORADIM变量包括要升级的数据库的SID，新的Oracle主目录位置以及新数据库实例的密码。此外， <code class="codeph">ORADIM</code>将日志文件写入<code class="codeph">ORACLE_HOME\database</code>目录。
                     </p>
                     <p>下表描述了升级时使用<code class="codeph">ORADIM</code>的变量：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="tblformal" id="GUID-9CA1706D-77B5-441A-A62C-0737C3C38214__GUID-1D65BBAE-E895-470A-A3E9-03515D331A83">
                     <p class="titleintable">表4-3 ORADIM变量和函数</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="ORADIM变量和函数" width="100%" border="1" summary="ORADIM variables and their functions" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="20%" id="d32466e1260">ORADIM变量</th>
                              <th align="left" valign="bottom" width="20%" id="d32466e1262">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d32466e1266" headers="d32466e1260 "><span class="variable" translate="no">SID</span></td>
                              <td align="left" valign="top" width="20%" headers="d32466e1266 d32466e1262 ">与要升级的数据库的SID相同的SID名称</td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d32466e1272" headers="d32466e1260 "><span class="variable" translate="no">密码</span></td>
                              <td align="left" valign="top" width="20%" headers="d32466e1272 d32466e1262 ">
                                 <p>新Oracle Database 12 <span class="italic">c</span>数据库实例的密码。这是与<code class="codeph">SYSDBA</code>权限连接的用户的密码。<code class="codeph">-SYSPWD</code>选项是必需的。
                                 </p>
                                 <p>默认的Oracle Database 12 <span class="italic">c</span>安全设置要求密码必须至少为八个字符。您不得使用<code class="codeph">welcome</code>和<code class="codeph">oracle</code>等密码。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d32466e1299" headers="d32466e1260 "><span class="variable" translate="no">USERS</span></td>
                              <td align="left" valign="top" width="20%" headers="d32466e1299 d32466e1262 ">
                                 <p>新Oracle Database 12 <span class="italic">c</span>数据库实例的密码。这是与<code class="codeph">SYSDBA</code>权限连接的用户的密码。<code class="codeph">-SYSPWD</code>选项是必需的。
                                 </p>
                                 <p>默认的Oracle Database 12 <span class="italic">c</span>安全设置要求密码必须至少为八个字符。您不得使用<code class="codeph">welcome</code>和<code class="codeph">oracle</code>等密码。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d32466e1326" headers="d32466e1260 "><span class="variable" translate="no">ORACLE_HOME</span></td>
                              <td align="left" valign="top" width="20%" headers="d32466e1326 d32466e1262 ">
                                 <p>Oracle Database 12的Oracle主目录位置<span class="italic">c</span> 。确保使用<code class="codeph">-PFILE</code>选项指定完整路径名，包括Oracle主目录位置的驱动器号。
                                 </p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section"></div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-9CA1706D-77B5-441A-A62C-0737C3C38214__GUID-CAA96A54-B351-4DDE-A233-CAABEC41389A">
                     <p class="notep1">也可以看看：</p>
                     <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/upgrd&amp;id=NTQRF070" target="_blank"><span class="italic">适用于Microsoft Windows的Oracle数据库平台指南，</span></a>以获取有关使用ORADIM管理数据库实例的完整信息</p>
                     <p>有关安全设置的详细信息，请<a href="../dbseg/keeping-your-oracle-database-secure.html#DBSEG10005" target="_blank"><span class="italic">参见“Oracle数据库安</span></a>
                     </p>
                     <p>有关在启动时指定初始化参数和初始化参数文件的信息，请参见<a href="../admin/starting-up-and-shutting-down.html#ADMIN12825" target="_blank"><span class="italic">“Oracle数据库管理员指南”</span></a></p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="upgrade-scenarios-non-cdb-oracle-databases.html#GUID-B9505420-7D07-4260-BC2E-D677180365A7" title="查看这些主题以了解非CDB Oracle数据库的升级方案和过程">非CDB Oracle数据库的升级方案</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
         </div>
      </article>
   </body>
</html>