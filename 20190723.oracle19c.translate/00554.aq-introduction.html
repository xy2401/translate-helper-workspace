<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="Advanced Queuing (AQ) is a robust and feature-rich message queuing system integrated with Oracle Database. These topics discuss Oracle Database Advanced Queuing (AQ) and the requirements for complex information handling in an integrated environment."></meta>
      <meta name="description" content="Advanced Queuing (AQ) is a robust and feature-rich message queuing system integrated with Oracle Database. These topics discuss Oracle Database Advanced Queuing (AQ) and the requirements for complex information handling in an integrated environment."></meta>
      <title>Oracle数据库高级队列简介</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Advanced Queuing User&#39;s Guide "></meta>
      <meta property="og:description" content="Advanced Queuing (AQ) is a robust and feature-rich message queuing system integrated with Oracle Database. These topics discuss Oracle Database Advanced Queuing (AQ) and the requirements for complex information handling in an integrated environment."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Advanced Queuing User&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="oracle-database-advanced-queuing.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-02-12T10:53:09-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96511-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="rel-changes.html" title="Previous" type="text/html"></link>
      <link rel="next" href="aq-basic-components.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Oracle® Database Advanced Queuing"></meta>
    <meta name="dcterms.isVersionOf" content="ADQUE"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="rel-changes.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="aq-basic-components.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">高级排队用户指南</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Oracle数据库高级队列简介</li>
            </ol>
            <a id="GUID-95868022-ECDA-4685-9D0A-52ED7663C84B" name="GUID-95868022-ECDA-4685-9D0A-52ED7663C84B"></a><a id="ADQUE0100"></a>
            
            <h2 id="ADQUE-GUID-95868022-ECDA-4685-9D0A-52ED7663C84B" class="sect2"><span class="enumeration_chapter">1</span> Oracle数据库高级队列简介</h2>
         </header>
         <div class="ind">
            <div>
               <p>高级队列（AQ）是一个与Oracle数据库集成的功能强大且功能丰富的消息队列系统。这些主题讨论了Oracle数据库高级队列（AQ）以及集成环境中复杂信息处理的要求。</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="aq-introduction.html#GUID-9714FE10-9721-4C78-93C6-0A3C4D9F5CBD" title="高级队列将用户消息存储在称为队列的抽象存储单元中。当基于Web的业务应用程序相互通信时，生产者应用程序将消息和消费者应用程序排队，从而使消息出列。">什么是排队？</a></p>
                  </li>
                  <li>
                     <p><a href="aq-introduction.html#GUID-344EBAAB-BF98-4E99-8D27-0A56409050E7" title="Oracle数据库高级队列提供了数据库集成的消息队列功能。此功能利用Oracle数据库的功能，以便可以持久存储消息，在不同计算机和数据库的队列之间传播消息，并使用Oracle Net Services和HTTP（S）进行传输。">Oracle数据库高级队列利用Oracle数据库</a></p>
                  </li>
                  <li>
                     <p><a href="aq-introduction.html#GUID-CFCB0EAA-952D-4149-8E6F-3A39809D5D3D" title="Oracle Database Advanced Queuing提供应用程序集成所需的消息管理和通信。在集成环境中，消息在Oracle数据库服务器，应用程序和用户之间传输。">集成应用程序环境中的Oracle数据库高级队列</a></p>
                  </li>
                  <li>
                     <p><a href="aq-introduction.html#GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27" title="缓冲消息传递结合了该产品始终提供的丰富功能和更快的排队实现。缓冲消息传递非常适合不需要Oracle数据库高级队列持久消息传递的可靠性和事务支持的应用程序。">缓冲消息</a></p>
                  </li>
                  <li>
                     <p><a href="aq-introduction.html#GUID-537FBC2D-0A4E-4ED7-9484-EECE0C66E271" title="异步通知允许客户端接收感兴趣的消息的通知。">异步通知</a></p>
                  </li>
                  <li>
                     <p><a href="aq-introduction.html#GUID-83F68756-B358-45ED-8C21-1DE6E87DCF7A" title="本主题描述了排队功能，排队消息数组，关联标识符，排队中的消息优先级和排序，消息分组，发件人标识以及时间规范和调度。">入队功能</a></p>
                  </li>
                  <li>
                     <p><a href="aq-introduction.html#GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A" title="本主题讨论出列特征并发出列，出列方法，出列模式，出列消息，消息状态，出列消息导航，等待消息，带延迟的重试，可选事务保护和异常队列。">出列功能</a></p>
                  </li>
                  <li>
                     <p><a href="aq-introduction.html#GUID-329A6279-925C-435B-A6F1-76835EF20C40" title="消息可以从一个队列传播到另一个队列，允许应用程序相互通信，而无需连接到同一个数据库或同一个队列。目标队列可以位于同一数据库中，也可以位于远程数据库中。">传播特征</a></p>
                  </li>
                  <li>
                     <p><a href="aq-introduction.html#GUID-8BBB3111-EFC4-44CE-8A73-76EC5D479EF9" title="应用程序通常使用不同格式的数据。转换定义了从一种Oracle数据类型到另一种Oracle数据类型的映射。">消息格式转换</a></p>
                  </li>
                  <li>
                     <p><a href="aq-introduction.html#GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F" title="本主题介绍AQ功能队列监视器协调器，与Oracle Internet Directory的集成，与Oracle Enterprise Manager的集成，保留和消息历史记录，清理消息队列，跟踪和事件日志，不可否认性以及Internet集成。">其他Oracle数据库高级队列功能</a></p>
                  </li>
                  <li>
                     <p><a href="aq-introduction.html#GUID-AA3B4276-F202-45BD-9177-B68FF6B0F327" title="您可以通过本主题中列出的接口访问Oracle数据库高级队列功能。">Oracle Database Advanced Queuing的接口</a></p>
                  </li>
               </ul>
            </div><a id="ADQUE2418"></a><div class="props_rev_3"><a id="GUID-9714FE10-9721-4C78-93C6-0A3C4D9F5CBD" name="GUID-9714FE10-9721-4C78-93C6-0A3C4D9F5CBD"></a><h3 id="ADQUE-GUID-9714FE10-9721-4C78-93C6-0A3C4D9F5CBD" class="sect3"><span class="enumeration_section">1.1</span>什么是排队？
               </h3>
               <div>
                  <p>高级队列将用户消息存储在称为队列的抽象存储单元中。当基于Web的业务应用程序相互通信时，生产者应用程序将消息和消费者应用程序排队，从而使消息出列。</p>
                  <p>在最基本的排队级别，一个生产者将一个或多个消息排入一个队列。每个<a href="glossary.html#GUID-2028AECF-DB3E-40E2-99B6-A35674C08038"><span class="xrefglossterm">消息</span></a>都由一个消费者出列并处理一次。消息将保留在<a href="glossary.html#GUID-583DEF67-C9BC-4B83-B8DC-2375A5BE08BB"><span class="xrefglossterm">队列中，</span></a>直到消费者将其出列或消息过期为止。<a href="glossary.html#GUID-B9E1FDFC-EDA0-4D9C-8D65-FE429EF9043C"><span class="xrefglossterm">生产者</span></a>可以在消息可用之前规定延迟，以及消息到期之后的时间。同样，如果没有可用的消息， <a href="glossary.html#GUID-B9071BDE-395F-4686-B2D2-A1B83F986BCC"><span class="xrefglossterm">消费者</span></a>可以在尝试使消息<a href="glossary.html#GUID-BC8D60E8-953A-4C6C-8163-F7AE187B768B"><span class="xrefglossterm">出列</span></a>时等待。代理程序或应用程序既可以充当生产者，也可以充当消费者。
                  </p>
                  <p>生产者可以<a href="glossary.html#GUID-B21E60F7-4BFA-42A2-9A8F-B781C2A55ED9"><span class="xrefglossterm">排队</span></a>以任何顺序的消息。消息不一定按入队的顺序出列。消息可以排队而不会出列。
                  </p>
                  <p>在稍高的复杂程度下，许多生产者将消息排入队列，所有这些消息都由一个消费者处理。或者许多生产者将消息排队，每个消息由不同的消费者处理，具体取决于类型和相关标识符。</p>
                  <p>当排队的消息在另一个队列上再现时，它们被传播，这些队列可以位于同一个数据库或远程数据库中。</p>
                  <p>应用程序通常使用不同格式的数据。<a href="glossary.html#GUID-A668A987-B1D3-4330-97FD-0589DB780225"><span class="xrefglossterm">转换</span></a>定义了从一种数据类型到另一种数据类型的映射。转换由SQL函数表示，该函数将源数据类型作为输入并返回目标数据类型的对象。您可以安排在邮件入队，出列时或将其传播到远程<a href="glossary.html#GUID-3E2C69B7-A56C-4F86-8997-5A708E1F14F3"><span class="xrefglossterm">订阅服务器时进行转换</span></a> 。
                  </p>
               </div>
            </div><a id="ADQUE2420"></a><a id="ADQUE2421"></a><a id="ADQUE2422"></a><a id="ADQUE2423"></a><a id="ADQUE2424"></a><a id="ADQUE2425"></a><a id="ADQUE2426"></a><a id="ADQUE2427"></a><a id="ADQUE2428"></a><a id="ADQUE2429"></a><a id="ADQUE2430"></a><a id="ADQUE2419"></a><div class="props_rev_3"><a id="GUID-344EBAAB-BF98-4E99-8D27-0A56409050E7" name="GUID-344EBAAB-BF98-4E99-8D27-0A56409050E7"></a><h3 id="ADQUE-GUID-344EBAAB-BF98-4E99-8D27-0A56409050E7" class="sect3"><span class="enumeration_section">1.2</span> Oracle数据库高级队列利用Oracle数据库</h3>
               <div>
                  <p>Oracle数据库高级队列提供了数据库集成的消息队列功能。此功能利用Oracle数据库的功能，以便可以持久存储消息，在不同计算机和数据库的队列之间传播消息，并使用Oracle Net Services和HTTP（S）进行传输。</p>
                  <p>由于Oracle数据库高级队列是在数据库表中实现的，因此高可用性，可伸缩性和可靠性的所有操作优势也适用于队列数据。Oracle数据库高级队列支持标准数据库功能，如恢复，重新启动和安全性。您可以使用Oracle Enterprise Manager等数据库开发和管理工具来监视队列。与其他数据库表一样，可以导入和导出队列表。同样，Oracle Data Guard支持高级队列以实现高可用性，这对于在使用无状态中间层时保留消息至关重要。通过在数据库中，可以将入队和出队合并到数据库事务中，而不需要分布式事务。例如，Oracle XA。</p>
                  <p>可以使用标准SQL查询消息。这意味着您可以使用SQL来访问消息属性，消息历史记录和有效负载。使用SQL访问，您还可以审核和跟踪消息。所有可用的SQL技术（如索引）都可用于优化对消息的访问。</p>
                  <div class="infoboxnote" id="GUID-344EBAAB-BF98-4E99-8D27-0A56409050E7__GUID-E3412EE6-692A-44A8-BB07-5C88EAD1773A">
                     <p class="notep1">注意：</p>
                     <p>Oracle数据库高级队列不支持对队列表或关联的<a href="glossary.html#GUID-3F72FEC8-8EA0-4762-8383-D99020876B61"><span class="xrefglossterm">索引组织表</span></a> （IOT）执行<a href="glossary.html#GUID-940A74C4-9569-478E-B320-E968214F47F6"><span class="xrefglossterm">数据操作语言</span></a> （DML）操作，也不支持分片队列使用的关联系统分区表（如果有）。唯一受支持的修改队列表的方法是通过提供的API。如果对它们执行DML操作，则队列表和IOT可能变得不一致并因此被破坏。
                     </p>
                  </div>
                  <div class="section">
                     <p class="subhead2" id="GUID-344EBAAB-BF98-4E99-8D27-0A56409050E7__GUID-30254C01-4271-4F44-92AB-C2889D93DF1C">系统级访问控制</p>
                     <p>Oracle Database Advanced Queuing支持所有排队操作的系统级访问控制，允许应用程序开发人员或DBA将用户指定为队列管理员。队列管理员可以在数据库中的任何队列上调用Oracle数据库高级队列管理和操作接口。这简化了管理工作，因为可以在一个模式下管理数据库中队列的所有管理脚本。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-344EBAAB-BF98-4E99-8D27-0A56409050E7__GUID-3835CF26-FF93-4400-BEF6-3D13519D18B4">队列级访问控制</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>Oracle数据库高级队列支持对入队和出队操作进行队列级访问控制。此功能允许应用程序开发人员保护在一个模式中创建的队列与在其他模式中运行的应用程序。应用程序开发人员只能为在队列模式之外运行的应用程序授予最小访问权限。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-344EBAAB-BF98-4E99-8D27-0A56409050E7__GUID-E32ED8AB-53B2-45C2-A101-5E144A3E4197">性能</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>服务请求必须与服务提供分开，以提高效率并实现复杂的调度。Oracle Database Advanced Queuing具有高性能，测量方法如下：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>每秒排队和出列的消息数</p>
                        </li>
                        <li>
                           <p>是时候评估消息仓库上的复杂查询了</p>
                        </li>
                        <li>
                           <p>发生故障后恢复和重新启动消息传递过程的时间</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-344EBAAB-BF98-4E99-8D27-0A56409050E7__GUID-3C6AA811-1837-4DEA-9630-EA7C86E99324">可扩展性</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>排队系统必须是可扩展的。当使用应用程序的程序数量增加，消息数量增加以及消息仓库大小增加时，Oracle数据库高级队列表现出高性能。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-344EBAAB-BF98-4E99-8D27-0A56409050E7__GUID-652D5C8E-94DE-4C00-9D0A-E6BF0803670E">坚持安全</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>构成服务请求的消息必须持久存储并处理一次，以便延迟执行，以便在出现网络，计算机和应用程序故障时正常工作。Oracle数据库高级队列可以满足以下情况下的要求：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>应用程序没有资源来处理从外部客户端或应用程序内部程序同时到达的多个未处理消息。</p>
                        </li>
                        <li>
                           <p>数据库之间的通信链接始终不可用或保留用于其他目的。如果系统无法立即处理这些消息，那么应用程序必须能够存储消息，直到可以处理它们。</p>
                        </li>
                        <li>
                           <p>外部客户端或内部程序尚未准备好接收已处理的消息。</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-344EBAAB-BF98-4E99-8D27-0A56409050E7__GUID-4C245CEB-43FD-4CE4-AE12-A5EB084BC559">调度的持久性</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>排队系统必须处理优先级，这些优先级可能会发生变化：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>稍后到达的消息可能比先前到达的消息具有更高的优先级。</p>
                        </li>
                        <li>
                           <p>消息可能会在执行操作之前等待以后的消息。</p>
                        </li>
                        <li>
                           <p>不同的进程可以访问相同的消息。</p>
                        </li>
                        <li>
                           <p>特定队列中的消息可能变得更加重要，因此必须以较少的延迟或来自其他队列中的消息的干扰进行处理。</p>
                        </li>
                        <li>
                           <p>发送到某些目的地的消息可能比其他目的地更高。</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-344EBAAB-BF98-4E99-8D27-0A56409050E7__GUID-5BE7FFD4-799E-4EC0-B0C7-11064A3AD813">持久访问和分析元数据</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>排队系统必须保留消息元数据，这与有效负载数据一样重要。例如，收到或发送消息的时间对于商业和法律原因至关重要。借助Oracle数据库高级队列的持久性功能，您可以分析需求最大的时段或评估接收和完成订单之间的延迟。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-344EBAAB-BF98-4E99-8D27-0A56409050E7__CHDEADFG">
                     <p class="subhead2" id="GUID-344EBAAB-BF98-4E99-8D27-0A56409050E7__GUID-2A6F4368-F605-4D63-9059-A56884F75FED">对象类型支持</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>Oracle Database Advanced Queuing支持队列类型为抽象数据类型<a href="glossary.html#GUID-4F65D487-125E-466A-8127-6EB40749DCA3"><span class="xrefglossterm">ADT的入</span></a>队，出队和传播操作。如果类型是基本ADT的继承类型，它还支持入队和出队操作。不支持从基本ADT继承类型的两个队列之间的传播。
                     </p>
                     <p>Oracle数据库高级队列还支持<code class="codeph">ANYDATA</code>队列，这使得应用程序能够将单个队列中的不同消息类型排入队列。Oracle Database Advanced Queuing支持从12c版本1（12.1）开始的<code class="codeph">LONG VARCHAR</code>数据类型。
                     </p>
                     <p>如果计划对用户定义的类型消息进行入队，传播或出列，则这些消息中使用的每种类型必须存在于可以将消息排入队列的每个数据库中。某些环境使用定向网络在到达目的地之前通过中间数据库路由消息。在此类环境中，类型必须存在于每个中间数据库中，即使此类消息从未在特定中间数据库中排队或出列。</p>
                     <p>此外，这些类型必须满足以下要求：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>每个数据库的类型名称必须相同。</p>
                        </li>
                        <li>
                           <p>类型必须位于每个数据库的相同模式中。</p>
                        </li>
                        <li>
                           <p>类型的形状必须与每个数据库完全匹配。</p>
                        </li>
                        <li>
                           <p>Type不能在任何数据库中使用继承或类型evolution。</p>
                        </li>
                        <li>
                           <p>Type不能包含varrays，嵌套表，LOB，rowid或urowids。</p>
                        </li>
                     </ul>
                     <p>对象标识符不需要在每个数据库中匹配。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-344EBAAB-BF98-4E99-8D27-0A56409050E7__GUID-9AB4E206-A63A-45A7-9807-DD69AA2ABA9F">结构化和XMLType有效负载</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>您可以使用对象类型来构造和管理消息有效负载。关系数据库系统通常具有比消息系统更丰富的打字系统。由于Oracle数据库是一个对象关系数据库系统，因此它支持传统的关系类型和用户定义类型。由于具有强类型内容（例如，其格式由外部类型系统定义的内容），因此启用了许多强大的功能。这些包括：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>基于内容的路由</p>
                           <p>Oracle数据库高级队列可以检查内容并根据内容自动将消息路由到另一个队列。</p>
                        </li>
                        <li>
                           <p>基于内容的订阅</p>
                           <p>发布和订阅系统构建在消息传递系统之上，以便您可以基于内容创建订阅。</p>
                        </li>
                        <li>
                           <p>查询</p>
                           <p>对邮件内容运行查询的功能可启用邮件仓库。</p>
                        </li>
                     </ul>
                     <p>您可以创建使用新的opaque类型<code class="codeph">XMLType.</code>队列<code class="codeph">XMLType.</code> 这些队列可用于传输和存储XML文档的消息。使用<code class="codeph">XMLType</code> ，您可以执行以下操作：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>将任何类型的消息存储在队列中</p>
                        </li>
                        <li>
                           <p>商店<code class="codeph">m</code>比在队列中的一个的有效载荷类型的矿石</p>
                        </li>
                        <li>
                           <p>使用运算符<code class="codeph">ExistsNode()</code>查询XMLType列</p>
                        </li>
                        <li>
                           <p>在订户规则或出列条件中指定运算符</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-344EBAAB-BF98-4E99-8D27-0A56409050E7__GUID-31355B27-5940-4951-856C-197899FFF80F">与Oracle Internet Directory集成</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>您可以使用Oracle Internet Directory在队列中注册系统事件，用户事件和通知。系统事件是数据库启动，数据库关闭和系统错误事件。用户事件包括用户登录和用户注销，DDL语句（创建，删除，更改）和<a href="glossary.html#GUID-86C2F323-8484-41FB-8E51-BF0462F041DF"><span class="xrefglossterm">DML</span></a>语句触发器。队列上的通知包括OCI通知，PL / SQL通知和电子邮件通知。
                     </p>
                     <p>您还可以在Oracle Internet Directory中为Oracle Database Advanced Queuing代理创建别名。执行Oracle数据库高级队列排队，出队和通知操作时，可以指定这些别名。当您不想公开内部代理名称时，这非常有用。</p>
                     <div class="infoboxnote" id="GUID-344EBAAB-BF98-4E99-8D27-0A56409050E7__GUID-E4032675-35E0-40CE-B978-72ACED2D9C55">
                        <p class="notep1">注意：</p>Sharded Queues在12 <span class="italic">c</span> Release 2（12.2.0.1）中不支持OCI和厚驱动程序。
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-344EBAAB-BF98-4E99-8D27-0A56409050E7__CHDIJAIJ">
                     <p class="subhead2" id="GUID-344EBAAB-BF98-4E99-8D27-0A56409050E7__GUID-D1C8B756-197F-4A55-A0A9-5BD02670FE4B">支持Oracle Real Application Clusters（Oracle RAC）</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>通过允许不同的队列管理不同的队列，Oracle Real Application Clusters可用于提高Oracle数据库高级队列性能。您可以通过为存储队列的队列表指定不同的实例关联（首选项）来完成此操作。这允许不同队列上的队列操作（入队和出队）并行发生。对于在多个Oracle RAC实例上具有入队或出列队列的应用程序，建议使用分片队列。有关更多信息，请参阅<a href="aq-performance-scalability.html#GUID-1B18AD7E-2F02-4208-A059-6B4531586C75">Sharded Queues和Oracle Real Application Clusters（Oracle RAC）</a> 。
                     </p>
                     <p><a id="d6697e572" class="indexterm-anchor"></a>如果将兼容性设置为Oracle8 <span class="italic">i</span> 8.1.5或更高版本，则应用程序可以为队列表指定实例关联。当Oracle数据库高级队列与Oracle RAC和多个实例一起使用时，此信息用于在实例之间对队列表进行分区以进行队列监视器调度，也用于传播。队列表由用户指定的实例的队列监视器监视。如果队列表的所有者终止，则辅助实例或某个可用实例将接管队列表的所有权。
                     </p>
                     <p>如果未指定实例关联，则在可用实例之间任意分区队列表。这可能导致访问队列表的应用程序与监视它的队列监视器之间的ping。指定实例关联可防止此情况，但不会阻止应用程序从其他实例访问队列表及其队列。</p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="ADQUE2432"></a><a id="ADQUE2431"></a><div class="props_rev_3"><a id="GUID-CFCB0EAA-952D-4149-8E6F-3A39809D5D3D" name="GUID-CFCB0EAA-952D-4149-8E6F-3A39809D5D3D"></a><h3 id="ADQUE-GUID-CFCB0EAA-952D-4149-8E6F-3A39809D5D3D" class="sect3"><span class="enumeration_section">1.3</span>集成应用程序环境中的Oracle数据库高级排队</h3>
               <div>
                  <div><span>Oracle Database Advanced Queuing提供应用程序集成所需的消息管理和通信。在集成环境中，消息在Oracle数据库服务器，应用程序和用户之间传输。</span><a href="aq-introduction.html#GUID-CFCB0EAA-952D-4149-8E6F-3A39809D5D3D__I1008337">如图1-1</a>所示。
                  </div>
                  <p></p>
                  <div class="figure" id="GUID-CFCB0EAA-952D-4149-8E6F-3A39809D5D3D__I1008337">
                     <p class="titleinfigure">图1-1使用Oracle数据库高级队列的集成应用程序环境</p><img src="img/adque437.gif" width="584" alt="下面是图1-1的描述" title="下面是图1-1的描述" longdesc="img_text/adque437.html"><br><a href="img_text/adque437.html">“图1-1使用Oracle数据库高级队列的集成应用程序环境”的说明</a></div>
                  <!-- class="figure" -->
                  <p><a id="d6697e649" class="indexterm-anchor"></a><a id="d6697e653" class="indexterm-anchor"></a>使用Oracle Net Services在客户端和Oracle数据库服务器之间或两个Oracle数据库服务器之间交换消息。Oracle Net Services还将消息从一个Oracle数据库队列传播到另一个Oracle数据库队列。或者， <a href="aq-introduction.html#GUID-CFCB0EAA-952D-4149-8E6F-3A39809D5D3D__I1008337">如图1-1</a>所示，您可以使用HTTP（S）在Internet上执行Oracle数据库高级排队操作。在这种情况下，客户端，用户或Internet应用程序生成结构化XML消息。在通过Internet <a href="glossary.html#GUID-DE5B852F-823C-4DC8-B6BB-4825D688A00A"><span class="xrefglossterm">传播</span></a>期间，Oracle数据库服务器也使用结构化XML进行通信。
                  </p>
                  <p><a id="d6697e665" class="indexterm-anchor"></a><a id="d6697e669" class="indexterm-anchor"></a>应用程序集成还涉及异构消息传递系统的集成。Oracle Database Advanced Queuing通过Messaging Gateway与现有的非Oracle数据库消息系统（如IBM WebSphere MQ）无缝集成，从而允许将现有的基于WebSphere MQ的应用程序集成到Oracle Database Advanced Queuing环境中。
                  </p>
                  <p>话题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="aq-introduction.html#GUID-2B4C7691-0C91-4447-ADEA-6F65C2B9EED2" title="Oracle数据库高级队列提供了客户端/服务器应用程序通常运行的同步方式的异步替代方法。">Oracle数据库高级队列客户端/服务器通信</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-5B6B013D-A646-4895-B929-970CBFB8C46D" title="Oracle数据库高级队列为队列订户和邮件收件人提供了允许多个使用者将相同的邮件出列的情况。">Multiconsumer出列相同的消息</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-EADF9494-1C2A-4346-81B5-39FE4AC6BC06" title="Oracle Database Advanced Queuing允许我们实现工作流，也称为链式应用程序事务。">Oracle数据库高级队列实现工作流程</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-4237239B-1603-4F10-9B41-4D527994FDFA" title="点对点消息针对特定目标。发送者和接收者决定在哪个队列中交换消息。每条消息仅由一个接收者使用。">发布/订阅的Oracle数据库高级队列实现</a></p>
                     </li>
                  </ul>
               </div><a id="ADQUE2434"></a><a id="ADQUE2433"></a><div class="props_rev_3"><a id="GUID-2B4C7691-0C91-4447-ADEA-6F65C2B9EED2" name="GUID-2B4C7691-0C91-4447-ADEA-6F65C2B9EED2"></a><h4 id="ADQUE-GUID-2B4C7691-0C91-4447-ADEA-6F65C2B9EED2" class="sect4"><span class="enumeration_section">1.3.1</span> Oracle数据库高级队列客户端/服务器通信</h4>
                  <div>
                     <div><span>Oracle数据库高级队列提供了客户端/服务器应用程序通常运行的同步方式的异步替代方法。</span>此图举例说明了使用Oracle数据库高级队列的客户端/服务器通信。
                     </div>
                     <p>在此示例中，应用程序B（服务器）使用请求/响应队列向应用程序A（客户端）提供服务。</p>
                     <div class="figure" id="GUID-2B4C7691-0C91-4447-ADEA-6F65C2B9EED2__CHDIAHBF">
                        <p class="titleinfigure">图1-2使用Oracle Database Advanced Queuing进行客户端/服务器通信</p><img src="img/adque035.gif" width="240" alt="下面是图1-2的描述" title="下面是图1-2的描述" longdesc="img_text/adque035.html"><br><a href="img_text/adque035.html">“图1-2使用Oracle数据库高级队列进行客户端/服务器通信”的说明</a></div>
                     <!-- class="figure" -->
                     <p>应用程序A将请求排入请求队列。在不同的事务中，应用程序B将请求出列并处理。应用程序B将结果排入响应队列，而在另一个事务中，应用程序A将其排队。</p>
                     <p>客户端无需等待与服务器建立连接，服务器按照自己的节奏使消息出列。当服务器处理完消息后，客户端无需等待接收结果。双延期过程可以释放客户端和服务器。</p>
                  </div>
               </div><a id="ADQUE2436"></a><a id="ADQUE2437"></a><a id="ADQUE2438"></a><a id="ADQUE2439"></a><a id="ADQUE2435"></a><div class="props_rev_3"><a id="GUID-5B6B013D-A646-4895-B929-970CBFB8C46D" name="GUID-5B6B013D-A646-4895-B929-970CBFB8C46D"></a><h4 id="ADQUE-GUID-5B6B013D-A646-4895-B929-970CBFB8C46D" class="sect4"><span class="enumeration_section">1.3.2</span>同一消息的多消息队列出列</h4>
                  <div>
                     <div>消息一次只能排入一个队列。如果生产者必须将相同的消息插入到几个队列中以便到达不同的消费者，那么这将需要管理非常大量的队列。<span>Oracle数据库高级队列为队列订户和邮件收件人提供了允许多个使用者将相同的邮件出列的情况。</span></div>
                     <p>要允许<a href="glossary.html#GUID-3E2C69B7-A56C-4F86-8997-5A708E1F14F3"><span class="xrefglossterm">订阅者</span></a>和<a href="glossary.html#GUID-F50CE039-717A-4D4C-B4D9-62EB3191885A"><span class="xrefglossterm">收件人</span></a>列表，队列必须驻留在使用multiple consumer选项创建的<a href="glossary.html#GUID-45894F1F-4871-4A00-9171-2743821BAD3A"><span class="xrefglossterm">队列表</span></a>中。每条消息都保留在队列中，直到被所有预期的消费者使用。
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-5B6B013D-A646-4895-B929-970CBFB8C46D__GUID-3F0F17A2-3434-4383-9395-5E458E4315B9">队列订阅者</p>
                        <p>可以是应用程序或其他队列的多个使用者可以作为订阅者与队列相关联。这使得队列中排队的所有消息都可供每个队列订户使用。可以动态更改队列的订户，而无需对消息或消息生成器进行任何更改。</p>
                        <p>您无法将订阅添加到单个使用者队列或异常队列。作为订户添加到队列的使用者只能将添加订户后排队的消息出列。没有两个订户可以拥有相同的名称，地址和协议值。对于两个订户，这些属性中的至少一个必须是不同的。</p>
                        <p><a id="d6697e876" class="indexterm-anchor"></a>由于订户之间没有优先权，因此不知道哪个订户将首先，第二等出列哪个消息。更正式地说，订户出列的顺序是不确定的。
                        </p>
                        <p>订阅者也可以基于规则。与SQL查询的<code class="codeph">WHERE</code>子句的语法类似，规则以表示消息属性或消息内容的属性表示。针对传入消息评估这些订户规则，并且匹配的那些规则用于确定消息接收者。
                        </p>
                        <p>在<a href="aq-introduction.html#GUID-5B6B013D-A646-4895-B929-970CBFB8C46D__CHDEIABI">图1-3中</a> ，应用程序B和应用程序C都需要由应用程序A生成的消息，因此多消费者队列特别配置为应用程序B和应用程序C作为队列订户。每个接收队列中的每条消息。
                        </p>
                        <div class="figure" id="GUID-5B6B013D-A646-4895-B929-970CBFB8C46D__CHDEIABI">
                           <p class="titleinfigure">图1-3使用Multiconsumer队列进行通信</p><img src="img/adque037.gif" width="320" alt="下面是图1-3的描述" title="下面是图1-3的描述" longdesc="img_text/adque037.html"><br><a href="img_text/adque037.html">“图1-3使用多消息队列进行通信”的描述</a></div>
                        <!-- class="figure" -->
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-5B6B013D-A646-4895-B929-970CBFB8C46D__GUID-F225DE48-60FD-4CC5-80AD-301A1FE74A35">消息收件人</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>消息生成器可以在将消息排入非分片队列时提交收件人列表。这允许队列中每条消息的唯一收件人集。与消息关联的收件人列表将覆盖与队列关联的订户列表（如果有）。收件人不必在订户列表中。但是，可以从订户中选择收件人。</p>
                        <p>收件人只能通过其名称指定，在这种情况下，收件人必须从邮件入队的队列中将邮件出列。它可以通过名称和协议值为0的地址来指定。该地址应该是同一数据库中的另一个队列的名称或Oracle数据库的另一个安装（由数据库链接标识），在这种情况下，消息将传播到指定的队列，并且可以由具有指定名称的使用者出列。如果收件人的名称为NULL，则消息将传播到地址中的指定队列，并且可以由地址中指定的队列的订户队列出列。如果协议字段非零，则系统不会解释名称和地址，并且消息可以由特殊使用者出列。</p>
                        <p>订阅队列就像订阅杂志一样：每个订阅者都可以将放入特定队列的所有消息出列，就像每个杂志订阅者都可以访问其所有文章一样。然而，作为收件人，就像收到一封信：每个收件人都是特定邮件的指定目标。</p>
                        <p><a href="aq-introduction.html#GUID-5B6B013D-A646-4895-B929-970CBFB8C46D__CHDBDGHJ">图1-4</a>显示了Oracle数据库高级队列如何适应两种类型的消费者。应用程序A将消息排入队列。应用B和应用C是订户。但是消息也可以明确地指向诸如应用程序D的接收者，其可以是或可以不是队列的订户。给定消息的此类收件人列表在该消息的队列调用中指定。它会覆盖该队列的订户列表。
                        </p>
                        <div class="figure" id="GUID-5B6B013D-A646-4895-B929-970CBFB8C46D__CHDBDGHJ">
                           <p class="titleinfigure">图1-4消息的显式和隐式收件人</p><img src="img/adque039.gif" width="336" alt="下面是图1-4的描述" title="下面是图1-4的描述" longdesc="img_text/adque039.html"><br><a href="img_text/adque039.html">“图1-4消息的显式和隐式接收者”的描述</a></div>
                        <!-- class="figure" -->
                        <div class="infoboxnote" id="GUID-5B6B013D-A646-4895-B929-970CBFB8C46D__GUID-57130F36-ED95-407D-997B-E50511B84621">
                           <p class="notep1">注意：</p>
                           <p>多个制作者可以同时将针对不同目标接收者的消息排入队列。</p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADQUE2441"></a><a id="ADQUE2440"></a><div class="props_rev_3"><a id="GUID-EADF9494-1C2A-4346-81B5-39FE4AC6BC06" name="GUID-EADF9494-1C2A-4346-81B5-39FE4AC6BC06"></a><h4 id="ADQUE-GUID-EADF9494-1C2A-4346-81B5-39FE4AC6BC06" class="sect4"><span class="enumeration_section">1.3.3</span> Oracle数据库高级队列工作流的实现</h4>
                  <div>
                     <div><span>Oracle Database Advanced Queuing允许我们实现工作流，也称为链式应用程序事务。</span>该图说明了如何使用Oracle数据库高级队列实现工作流。
                     </div>
                     <ol>
                        <li>
                           <p>应用程序A通过排队消息1开始<a href="glossary.html#GUID-F361FADC-D1DD-49BE-8C73-37C4A241F0C8"><span class="xrefglossterm">工作流程</span></a> 。
                           </p>
                        </li>
                        <li>
                           <p>应用程序B使其出列，执行所需的任何活动，并将消息2排入队列。</p>
                        </li>
                        <li>
                           <p>应用程序C使消息2出列并生成消息3。</p>
                        </li>
                        <li>
                           <p>应用程序D，即工作流程的最后一步，将其出列。</p>
                        </li>
                     </ol>
                     <div class="figure" id="GUID-EADF9494-1C2A-4346-81B5-39FE4AC6BC06__CHDHEIBE">
                        <p class="titleinfigure">图1-5使用Oracle Database Advanced Queuing实现工作流程</p><img src="img/adque040.gif" width="408" alt="下面是图1-5的描述" title="下面是图1-5的描述" longdesc="img_text/adque040.html"><br><a href="img_text/adque040.html">“图1-5使用Oracle Database Advanced Queuing实现工作流”的描述</a></div>
                     <!-- class="figure" -->
                     <div class="infoboxnote" id="GUID-EADF9494-1C2A-4346-81B5-39FE4AC6BC06__GUID-E411A314-C6AB-41A5-89AD-B3BB93F78101">
                        <p class="notep1">注意：</p>
                        <p>消息1,2和3的内容可以相同或不同。即使它们不同，消息也可以包含先前消息的部分内容。</p>
                     </div>
                     <p>队列用于缓冲业务流程的不同处理阶段之间的信息流。通过指定消息的延迟间隔和到期时间，可以为每个应用程序提供执行窗口。</p>
                     <p>从工作流的角度来看，消息流的数量和时间的知识是与有效载荷数据的价值完全不同的商业资产。Oracle数据库高级队列通过支持可选的消息保留来分析历史模式和预测未来趋势，帮助您获得这些知识。</p>
                  </div>
               </div><a id="ADQUE2443"></a><a id="ADQUE2444"></a><a id="ADQUE2445"></a><a id="ADQUE2442"></a><div class="props_rev_3"><a id="GUID-4237239B-1603-4F10-9B41-4D527994FDFA" name="GUID-4237239B-1603-4F10-9B41-4D527994FDFA"></a><h4 id="ADQUE-GUID-4237239B-1603-4F10-9B41-4D527994FDFA" class="sect4"><span class="enumeration_section">1.3.4</span>发布/订阅的Oracle数据库高级排队实现</h4>
                  <div>
                     <p>点对点消息针对特定目标。发送者和接收者决定在哪个队列中交换消息。每条消息仅由一个接收者使用。</p>
                     <p><a href="aq-introduction.html#GUID-4237239B-1603-4F10-9B41-4D527994FDFA__CHDEABII">图1-6</a>显示每个应用程序都有自己的消息队列，称为单用户队列。
                     </p>
                     <div class="figure" id="GUID-4237239B-1603-4F10-9B41-4D527994FDFA__CHDEABII">
                        <p class="titleinfigure">图1-6点对点消息传递</p><img src="img/adque250.gif" width="496" alt="下面描述图1-6" title="下面描述图1-6" longdesc="img_text/adque250.html"><br><a href="img_text/adque250.html">“图1-6点对点消息”的描述</a></div>
                     <!-- class="figure" -->
                     <p>多个接收者可以使用<a href="glossary.html#GUID-C1099A1A-C20D-4C9C-AD73-BBF6BC8939B5"><span class="xrefglossterm">发布/订阅</span></a>消息， <a href="aq-introduction.html#GUID-4237239B-1603-4F10-9B41-4D527994FDFA__CHDICBHA">如图1-7</a>所示。发布/订阅消息传递具有称为<a href="glossary.html#GUID-1D647CEA-1D00-4F25-BE39-4269938CD96F"><span class="xrefglossterm">广播的</span></a>广泛传播模式和称为<a href="glossary.html#GUID-1EE8EF1B-B684-4A0E-B64E-21749F7AF1AA"><span class="xrefglossterm">多播</span></a>的更窄目标模式。
                     </p>
                     <p><a id="d6697e1082" class="indexterm-anchor"></a><a id="d6697e1086" class="indexterm-anchor"></a>广播就像一个广播电台，不知道观众对于给定节目到底是谁。dequeuers是多消费者队列的订户。相比之下，多播就像杂志出版商一样知道订阅者是谁。多播也称为点对多点，因为单个发布者将消息发送到多个接收者，称为接收者，他们可能是也可能不是作为交换机制的队列的订阅者。
                     </p>
                     <div class="figure" id="GUID-4237239B-1603-4F10-9B41-4D527994FDFA__CHDICBHA">
                        <p class="titleinfigure">图1-7发布/订阅模式</p><img src="img/adque249.gif" width="496" alt="下面是图1-7的描述" title="下面是图1-7的描述" longdesc="img_text/adque249.html"><br><a href="img_text/adque249.html">“图1-7发布/订阅模式”的说明</a></div>
                     <!-- class="figure" -->
                     <p>发布/订阅描述了一种情况，即发布者应用程序匿名将消息排入队列（未指定收件人）。然后根据每个应用程序指定的<a href="glossary.html#GUID-99CB47E5-833C-41C3-965F-5115B1F1203E"><span class="xrefglossterm">规则</span></a>将消息传递给订户应用程序。可以在消息属性，消息数据内容或两者上定义规则。
                     </p>
                     <p><a id="d6697e1103" class="indexterm-anchor"></a>您可以使用Oracle Database Advanced Queuing实现通信的发布/订阅模型，如下所示：</p>
                     <ol>
                        <li>
                           <p>设置一个或多个队列来保存邮件。这些队列应代表感兴趣的区域或主题。例如，队列可用于表示结算订单。</p>
                        </li>
                        <li>
                           <p>设置一组基于规则的订户。每个订户可以指定一个规则，该规则表示订户希望接收的消息的规范。空规则表示订户希望接收所有消息。</p>
                        </li>
                        <li>
                           <p>发布者应用程序通过调用enqueue调用将消息发布到队列。</p>
                        </li>
                        <li>
                           <p>订户应用程序可以通过出列呼叫接收消息。这将检索与订阅条件匹配的邮件。</p>
                        </li>
                        <li>
                           <p><a id="d6697e1123" class="indexterm-anchor"></a>订阅者应用程序还可以使用侦听调用来监视多个队列，以便在不同队列上进行订阅。在订户应用程序订阅了许多队列并希望接收到达任何队列的消息的情况下，这是一种更具可扩展性的解决方案。
                           </p>
                        </li>
                        <li>
                           <p>订户应用程序还可以使用Oracle调用接口（OCI）通知机制。这允许推送消息传递模式。订户应用程序注册从中接收消息的队列（以及指定为订阅代理的订阅）。这将记录与订阅匹配的消息到达时要调用的回调。</p>
                        </li>
                     </ol>
                     <p><a href="aq-introduction.html#GUID-4237239B-1603-4F10-9B41-4D527994FDFA__CHDJEHDI">图1-8</a>说明了使用Oracle数据库高级队列实现发布者应用程序A与订阅者应用程序B，C和D之间的发布/订阅关系：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>应用程序B订阅规则“priority = 1”。</p>
                        </li>
                        <li>
                           <p>应用程序C订阅规则“priority&gt; 1”。</p>
                        </li>
                        <li>
                           <p>应用程序D订阅规则“priority = 3”。</p>
                        </li>
                     </ul>
                     <div class="figure" id="GUID-4237239B-1603-4F10-9B41-4D527994FDFA__CHDJEHDI">
                        <p class="titleinfigure">图1-8使用Oracle Database Advanced Queuing实现发布/预订</p><img src="img/adque041.gif" width="336" alt="下面是图1-8的描述" title="下面是图1-8的描述" longdesc="img_text/adque041.html"><br><a href="img_text/adque041.html">“图1-8使用Oracle数据库高级队列实现发布/预订”的说明</a></div>
                     <!-- class="figure" -->
                     <p>如果应用程序A分别将优先级为1,2和3的三条消息排入队列，则消息将按如下方式传递：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>应用程序B接收单个消息（优先级1）。</p>
                        </li>
                        <li>
                           <p>应用程序C接收两条消息（优先级2,3）。</p>
                        </li>
                        <li>
                           <p>应用程序D接收单个消息（优先级3）。</p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div><a id="ADQUE2446"></a><a id="ADQUE2447"></a><a id="ADQUE2448"></a><a id="ADQUE2449"></a><a id="ADQUE2450"></a><a id="ADQUE2451"></a><a id="ADQUE2452"></a><a id="ADQUE0102"></a><div class="props_rev_3"><a id="GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27" name="GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27"></a><h3 id="ADQUE-GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27" class="sect3"><span class="enumeration_section">1.4</span>缓冲消息</h3>
               <div>
                  <p>缓冲消息传递结合了该产品始终提供的丰富功能和更快的排队实现。缓冲消息传递非常适合不需要Oracle数据库高级队列持久消息传递的可靠性和事务支持的应用程序。</p>
                  <p>缓冲消息传递比持久消息传递更快，因为它的消息驻留在共享内存中。它们通常仅在缓冲消息的总内存消耗接近可用共享内存限制时写入磁盘。</p>
                  <div class="infoboxnote" id="GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__GUID-C05D4671-027A-4856-8C19-C66410963739">
                     <p class="notep1">注意：</p>
                     <p>将缓冲的消息存储在存储器中的队列部分有时被称为缓冲队列。</p>
                  </div>
                  <p>缓冲消息传递不支持消息保留。</p>
                  <p>使用缓冲消息传递时，Oracle建议您执行以下操作之一：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a id="d6697e1302" class="indexterm-anchor"></a>设置参数<code class="codeph">streams_pool_size</code> 
                        </p>
                        <p>此参数控制Oracle Database Advanced Queuing可用的共享内存大小。如果未指定，则可以从数据库缓存为Oracle数据库高级队列池分配高达10％的共享池大小。</p>
                        <p>有关为具有分片队列的缓冲消息传递设置消息缓存的详细信息，请参阅<a href="aq-performance-scalability.html#GUID-AE1B40DA-FCEE-4EBB-8B83-96477C47DD49__MANUALLYTUNINGSHARDEDQUEUESSHARDEDQ-0508F585">手动调整分片</a>队列。
                        </p>
                     </li>
                     <li>
                        <p>打开SGA自动调谐</p>
                        <p>Oracle将根据Oracle数据库高级队列的使用情况以及使用SGA的其他组件的使用情况，自动从SGA中为Oracle数据库高级队列分配适当的内存量。此类其他组件的示例是缓冲区高速缓存和库高速缓存。如果指定了<code class="codeph">streams_pool_size</code> ，则将其用作下限。
                        </p>
                     </li>
                  </ul>
                  <p>话题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="aq-introduction.html#GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__CHDFICID">排队缓冲消息</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__CHDIJDFH">出列缓冲消息</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__CHDHFACF">传播缓冲消息</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__CHDDBCFA">流量控制</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__CHDFJCAC">Oracle Real Application Clusters（Oracle RAC）的缓冲消息传递</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__CHDHGAGE">缓冲消息传递限制</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__CHDFCFBF">错误处理</a></p>
                     </li>
                  </ul>
                  <div class="section" id="GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__CHDFICID">
                     <p class="subhead2" id="GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__GUID-2DD11F01-5523-47B3-9C3A-2195065A3521">排队缓冲消息</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>缓冲和持久消息使用相同的单消费者或多消费者队列以及相同的管理和操作接口。它们通过传递模式参数相互区分，该参数由应用程序在将消息排入Oracle数据库高级队列队列时设置。</p>
                     <p>缓冲消息队列支持收件人列表。</p>
                     <p>使用兼容性8.1或更高版本创建的所有队列表都支持缓冲消息传递。此版本中的缓冲消息不支持事务分组队列和数组队列。您仍然可以使用数组排队过程来排队缓冲的消息，但必须将数组大小设置为1。</p>
                     <p><a id="d6697e1368" class="indexterm-anchor"></a>可以使用<code class="codeph">AQ$</code> <span class="italic"><code class="codeph">Queue_Table_Name</code></span>视图查询缓冲的消息。它们以状态<code class="codeph">IN-MEMORY</code>或<code class="codeph">SPILLED</code> 。</p>
                     <p><a id="d6697e1386" class="indexterm-anchor"></a><a id="d6697e1390" class="indexterm-anchor"></a>缓冲消息传递的队列类型可以是<code class="codeph">ADT</code> ， <code class="codeph">XML</code> ， <code class="codeph">ANYDATA</code>或<code class="codeph">RAW</code> 。对于具有<code class="codeph">LOB</code>属性的<code class="codeph">ADT</code>类型，只能将具有空<code class="codeph">LOB</code>属性的缓冲消息排入队列。
                     </p>
                     <p><a id="d6697e1418" class="indexterm-anchor"></a><a id="d6697e1424" class="indexterm-anchor"></a>可用于持久消息的所有排序方案也可用于缓冲消息，但仅适用于每个消息类。目前不支持在同一会话中排队的持久和缓冲消息之间进行排序。
                     </p>
                     <p><a id="d6697e1430" class="indexterm-anchor"></a><a id="d6697e1434" class="indexterm-anchor"></a> enqueue和dequeue缓冲消息传递操作都必须具有<code class="codeph">IMMEDIATE</code>可见性模式。因此，它们不能成为另一个交易的一部分。排队缓冲消息时无法指定延迟。
                     </p>
                     <div class="infoboxnotealso" id="GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__GUID-8D4141DE-90B3-4A93-85BF-D03088F41035">
                        <p class="notep1">也可以看看：</p>
                        <div class="p">
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><span class="q">“ <a href="aq-operations-using-pl-sql.html#GUID-1CEA86B9-4FDF-445F-93C1-67E21C033D35" title="此过程将消息添加到指定的队列。">排队留言</a> ”</span></p>
                              </li>
                              <li>
                                 <p><span class="q">“ <a href="aq-messaging-gateway-views.html#GUID-78CC1D99-D2DD-4B80-BC38-4BBF39E05EFA" title="AQ $ &lt;Queue_Table_Name&gt;视图描述了存储消息数据的队列表。">AQ $ &lt;Queue_Table_Name&gt;：队列表中的消息</a> ”</span></p>
                              </li>
                              <li>
                                 <p><span class="q">“ <a href="aq-introduction.html#GUID-83F68756-B358-45ED-8C21-1DE6E87DCF7A__CHDIAGFG">入队中消息的优先级和排序</a> ”</span></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__CHDIJDFH">
                     <p class="subhead2" id="GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__GUID-55430D8B-B4D7-41DB-9B49-81AF455D80DA">出列缓冲消息</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>缓冲消息传递支持基于规则的订阅。添加订户的过程得到增强，允许应用程序仅表达对持久消息，仅缓冲消息或两者的兴趣。</p>
                     <p>对于非分片队列，缓冲消息传递不支持数组出列，但您仍可以通过将数组大小设置为一条消息来使用数组出列过程。</p>
                     <p><a id="d6697e1481" class="indexterm-anchor"></a><a id="d6697e1487" class="indexterm-anchor"></a>出列应用程序可以选择仅将持久性消息，仅缓冲消息或两种类型出列。必须将可见性设置为<code class="codeph">IMMEDIATE</code>才能使缓冲的消息出列。支持以下所有出列选项：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>出队模式<code class="codeph">BROWSE</code> ， <code class="codeph">LOCK</code> ， <code class="codeph">REMOVE</code>和<code class="codeph">REMOVE_NO_DATA</code></p>
                        </li>
                        <li>
                           <p>导航模式<code class="codeph">FIRST_MESSAGE</code>和<code class="codeph">NEXT_MESSAGE</code></p>
                        </li>
                        <li>
                           <p>相关标识符</p>
                        </li>
                        <li>
                           <p>出队条件</p>
                        </li>
                        <li>
                           <p>消息标识符</p>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__GUID-20E502B5-1F97-46DE-8E56-68940910E8FC">
                        <p class="notep1">也可以看看：</p>
                        <div class="p">
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><span class="q">“ <a href="aq-administrative-interface.html#GUID-5FB46C6A-BB22-4CDE-B7D6-E242DC8808D8" title="DBMS_AQADM.ADD_SUBSCRIBER将默认订户添加到队列。">添加订阅者</a> ”</span></p>
                              </li>
                              <li>
                                 <p><span class="q">“ <a href="aq-operations-using-pl-sql.html#GUID-5F84DA85-7D5B-4EEC-9785-80877F3FCA54__CHDBBGGE">出列选项</a> ”</span></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__CHDHFACF">
                     <p class="subhead2" id="GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__GUID-744382CF-0E3C-47ED-ACB4-C2DE5416BD0F">传播缓冲消息</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>支持缓冲消息的传播。单个传播计划用于持久消息和缓冲消息。<code class="codeph">DBA_QUEUE_SCHEDULES</code>视图显示统计信息和错误信息。
                     </p>
                     <p>Oracle Database AQ在传输到远程站点后删除缓冲的消息。如果接收站点在消耗这些消息之前失败，则这些消息将丢失。源站点将无法重新发送它们。也可以重复传递消息。</p>
                     <div class="infoboxnotealso" id="GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__GUID-2050BD3D-332F-4E59-BD6E-0DB47EB610A2">
                        <p class="notep1">也可以看看：</p>
                        <div class="p">
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><span class="q">“ <a href="aq-messaging-gateway-views.html#GUID-536EE7B0-B37E-48D2-9336-119742F34468" title="DBA_QUEUE_SCHEDULES视图描述了数据库中用于传播消息的所有当前计划。">DBA_QUEUE_SCHEDULES：所有传播计划</a> ”</span></p>
                              </li>
                              <li>
                                 <p><span class="q">“ <a href="aq-introduction.html#GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__CHDFJCAC">使用Oracle Real Application Clusters（Oracle RAC）缓冲消息传递</a> ”</span></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__CHDDBCFA">
                     <p class="subhead2" id="GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__GUID-75AA8BA0-740E-4945-82FE-BC7BABA04F27">流量控制</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>Oracle数据库高级队列实现了一个流控制系统，可以防止应用程序使用消息充斥共享内存。如果每个发件人的未完成邮件数超过系统定义的阈值，则enqueue调用将阻止并超时并显示错误消息。消息发送方由enqueue选项中的<span class="italic">sender_id.name</span>标识。由于队列上的流控制而被阻止的发件人不会影响其他邮件发件人。解决方案是使消息出列，从而解决流控制，之后可以将新消息排入队列。
                     </p>
                     <p>流量控制阈值随内存压力而变化，如果流池使用率变得显着，则可能降至系统定义的限制。消息发送者将阻止事件<code class="codeph">Streams AQ: enqueue blocked due to flow control</code>而<code class="codeph">Streams AQ: enqueue blocked due to flow control</code>并且如果流量控制未解决则超时<code class="codeph">ORA-25307</code> 。应用程序应该处理此错误，并重新排队失败的消息。
                     </p>
                     <p>即使使用流量控制，多消费者队列的慢消费者也可以使存储在内存中的消息数量无限制地增长。如果至少有一个订户保持同步，则较旧的消息将溢出到磁盘并从池中移除以释放内存。这确保了较慢的消费者支付磁盘访问的成本，并且更快的订户可以不受阻碍地进行。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__CHDFJCAC">
                     <p class="subhead2" id="GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__GUID-917D4532-EF7B-40EB-A0AE-E4500A8DDDB3">Oracle Real Application Clusters（Oracle RAC）的缓冲消息传递</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>分片和非分片队列使用Oracle RAC处理缓冲消息传递的方式不同。</p>
                     <p>分片队列执行跨实例通信，但避免跨Oracle RAC实例同时写入同一块。通常，出现在消息的入队实例本地的分片上，但在某些情况下，Oracle将有效地跨实例转发消息以在另一个实例上出列。例如，如果分片队列在一个Oracle RAC实例上具有单个入队会话而在另一个实例上具有单个出队会话，则分片队列将在Oracle RAC实例之间转发消息。消息的转发是与排队事务异步完成的，以提高性能。如果Dequeuers连接到其分片没有消息的实例，则可以获得ORA-25228。</p>
                     <p>对于非分片队列，只要应用程序使用基于密码的身份验证连接到数据库，应用程序就可以将来自任何Oracle RAC实例的缓冲消息入队并出列。缓冲消息传递所需的结构在一个Oracle RAC实例上实现。实现缓冲消息传递结构的实例是包含队列的队列表的<code class="codeph">OWNER_INSTANCE</code> 。在其他实例接收的入队和出队请求将通过互连转发到<code class="codeph">OWNER_INSTANCE</code> 。还必须将<code class="codeph">listener.ora</code>的<code class="codeph">REMOTE_LISTENER</code>参数设置为启用将缓冲的消息传递请求转发到正确的实例。在内部，Oracle RAC上的缓冲队列可以在实例之间使用<code class="codeph">dblinks</code> 。在Oracle RAC上排队或出列到缓冲队列的Definer权限包必须向包的用户授予<code class="codeph">INHERIT REMOTE PRIVILEGES</code> 。
                     </p>
                     <p><a id="d6697e1627" class="indexterm-anchor"></a>服务名称与Oracle RAC中的每个队列相关联，并显示在<code class="codeph">DBA_QUEUES</code>和<code class="codeph">USER_QUEUES</code>视图中。此服务名称始终指向具有最有效访问缓冲消息传递的实例，从而最大限度地减少实例之间的ping。OCI客户端可以使用服务名称进行缓冲消息传递操作。
                     </p>
                     <p><a id="d6697e1639" class="indexterm-anchor"></a><a id="d6697e1645" class="indexterm-anchor"></a> Oracle建议您在使用具有队列到队列传播的缓冲消息传递时指定实例关联。这会在将消息传播到目标Oracle RAC系统时导致透明的故障转移。如果主AQ Oracle RAC实例失败，则无需重新指向数据库链接。
                     </p>
                     <div class="infoboxnotealso" id="GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__GUID-E84392EC-8955-428D-8CFA-9D660EC51625">
                        <p class="notep1">也可以看看：</p>
                        <div class="p">
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><span class="q">“ <a href="aq-messaging-gateway-views.html#GUID-2947DA74-D002-4559-962E-84A33DD9DA45" title="此视图描述了当前用户可访问的队列表。">ALL_QUEUE_TABLES：当前用户可访问的队列表</a> ”</span>以获取有关<code class="codeph">OWNER_INSTANCE</code>更多信息</p>
                              </li>
                              <li>
                                 <p>有关设置<code class="codeph">REMOTE_LISTENER</code>参数的详细信息，请参阅<a href="../refrn/REMOTE_LISTENER.html#REFRN10183" target="_blank"><span class="italic">Oracle数据库参考中的</span></a> “REMOTE_LISTENER”</p>
                              </li>
                              <li>
                                 <p><span class="q">“ <a href="aq-messaging-gateway-views.html#GUID-CBC9895E-04E3-4FFA-9006-849910547742" title="DBA_QUEUES视图指定数据库中每个队列的操作特征。">DBA_QUEUES：数据库中的所有队列</a> ”</span>或<span class="q">“ <a href="aq-messaging-gateway-views.html#GUID-225DB096-8267-41EE-92DF-3747AD7C0362" title="USER_QUEUES视图与DBA_QUEUES相同，但它仅显示用户模式中的队列。">USER_QUEUES：用户架构中的队列</a> ”</span></p>
                              </li>
                              <li>
                                 <p><span class="q">“ <a href="aq-introduction.html#GUID-344EBAAB-BF98-4E99-8D27-0A56409050E7__CHDIJAIJ">支持Oracle Real Application Clusters（Oracle RAC）</a> ”</span></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__CHDHGAGE">
                     <p class="subhead2" id="GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__GUID-59D63259-17BD-4006-9CDB-B196D56E27C7">缓冲消息传递限制</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>以下Oracle数据库高级队列功能仅支持分片队列上的缓冲消息传递：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>消息延迟</p>
                        </li>
                        <li>
                           <p>数组入队</p>
                        </li>
                        <li>
                           <p>阵列出列</p>
                        </li>
                        <li>
                           <p>PL / SQL通知</p>
                        </li>
                     </ul>
                     <p>缓冲消息传递当前不支持以下Oracle数据库高级队列功能：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>留言保留</p>
                        </li>
                        <li>
                           <p>交易分组</p>
                        </li>
                        <li>
                           <p>消息导出和导入</p>
                        </li>
                        <li>
                           <p>消息网关</p>
                        </li>
                        <li>
                           <p>OCI通知</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__CHDFCFBF">
                     <p class="subhead2" id="GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__GUID-CF2825DE-D7B4-4A0F-A96D-72B583B250F6">错误处理</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>缓冲消息不支持重试计数和重试延迟。支持邮件过期。当缓冲消息在队列超过其有效期之后，它将作为持久消息移入异常队列。</p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="ADQUE2453"></a><a id="ADQUE2454"></a><a id="ADQUE2455"></a><a id="ADQUE2456"></a><a id="ADQUE2457"></a><a id="ADQUE2458"></a><a id="ADQUE2459"></a><a id="ADQUE0101"></a><div class="props_rev_3"><a id="GUID-537FBC2D-0A4E-4ED7-9484-EECE0C66E271" name="GUID-537FBC2D-0A4E-4ED7-9484-EECE0C66E271"></a><h3 id="ADQUE-GUID-537FBC2D-0A4E-4ED7-9484-EECE0C66E271" class="sect3"><span class="enumeration_section">1.5</span>异步通知</h3>
               <div>
                  <p>异步通知允许客户端接收感兴趣的消息的通知。</p>
                  <p>客户端可以使用这些通知来监视多个订阅。客户端无需连接到数据库即可接收有关其订阅的通知。缓冲消息支持异步通知。消息的传递模式在通知描述符的消息描述符中可用。</p>
                  <p>客户端指定为每条消息运行的回调函数。异步通知不能用于调用可执行文件，但回调函数可以调用存储过程。</p>
                  <p>客户端可以使用PL / SQL，Java消息服务（JMS）或OCI回调函数以程序方式接收通知，或者客户端可以通过电子邮件或HTTP帖子接收通知。客户端还可以将通知的表示指定为<code class="codeph">RAW</code>或<code class="codeph">XML</code> 。</p>
                  <div class="infoboxnote" id="GUID-537FBC2D-0A4E-4ED7-9484-EECE0C66E271__GUID-0252006A-4D5D-4F7D-BB6B-8177ECDEE851">
                     <p class="notep1">注意：</p>
                     <p>分片队列仅支持PL / SQL通知。</p>
                  </div>
                  <p>对于JMS队列，出队是作为通知的一部分完成的;显式出列不是必需的。对于RAW队列，客户端可以指定有效负载传递;但他们仍然必须在<code class="codeph">REMOVE_NO_DATA</code>模式下将消息出<code class="codeph">REMOVE_NO_DATA</code> 。对于所有其他持久性队列，通知仅包含消息属性;客户端明确地出列以接收消息。
                  </p>
                  <div class="section">
                     <p class="subhead2" id="GUID-537FBC2D-0A4E-4ED7-9484-EECE0C66E271__GUID-33D1B431-729C-43A3-BD17-712F08426AAB">RAW队列的有效负载交付</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>对于RAW队列，Oracle数据库高级队列客户端现在可以指定传递消息有效负载及其通知。</p>
                     <div class="infoboxnotealso" id="GUID-537FBC2D-0A4E-4ED7-9484-EECE0C66E271__GUID-D4F1A3EC-8843-44DA-B956-FB12E06E0330">
                        <p class="notep1">也可以看看：</p>
                        <p><span class="q">“ <a href="aq-basic-components.html#GUID-94CBE09C-EE8C-4874-A30D-CCBE1F8D862E" title="该组件标识消息的生产者或消费者。">AQ注册信息类型</a> ”</span></p>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-537FBC2D-0A4E-4ED7-9484-EECE0C66E271__GUID-80311020-37A6-4B2F-B372-A4F9F35AF5B1">可靠的通知</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>客户端可以指定持久性消息通知。如果Oracle RAC实例失败，则其通知由另一个Oracle RAC节点提供。如果独立实例失败，则在实例重新启动时会传递其通知。</p>
                     <div class="infoboxnote" id="GUID-537FBC2D-0A4E-4ED7-9484-EECE0C66E271__GUID-D9526A19-850A-4807-B2F3-8909239BD41F">
                        <p class="notep1">注意：</p>
                        <p>通知可靠性仅指服务器故障。如果Oracle数据库高级队列由于任何其他原因无法提供客户端通知，则通知将随客户端注册一起被清除。</p>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-537FBC2D-0A4E-4ED7-9484-EECE0C66E271__GUID-C9F17A4F-5BCB-4350-AE05-29BB4A87D463">指定端口通知</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>对于非分片队列，Oracle数据库高级队列客户端可以使用OCI预订句柄属性<code class="codeph">OCI_ATTR_SUBSCR_PORTNO</code>来指定传递通知的端口。这对于防火墙后面的计算机上的客户端尤其有用。可以使用环境句柄中的属性在第一次注册之前指定侦听器线程的端口。线程在第一次调用<code class="codeph">OCISubscriptionRegister</code>时启动。如果客户端尝试使用不同的环境句柄在另一个端口上启动另一个线程，则Oracle Database Advanced Queuing将返回错误。
                     </p>
                     <div class="infoboxnote" id="GUID-537FBC2D-0A4E-4ED7-9484-EECE0C66E271__GUID-389FE6E5-F156-41F2-8D3C-F9A25F2E86BD">
                        <p class="notep1">注意：</p>
                        <p>指定端口通知和IP地址通知仅适用于OCI客户端。</p>
                     </div>
                     <div class="infoboxnotealso" id="GUID-537FBC2D-0A4E-4ED7-9484-EECE0C66E271__GUID-28FEECC8-5057-4485-B066-59C3C7F8D76F">
                        <p class="notep1">也可以看看：</p>
                        <p>“ <a href="../lnoci/session-and-connection-pooling.html#LNOCI090" target="_blank"><span class="italic">Oracle调用接口程序员指南</span></a> ”中的“在OCI中发布 - 订阅注册函数<a href="../lnoci/session-and-connection-pooling.html#LNOCI090" target="_blank"><span class="italic">”</span></a></p>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-537FBC2D-0A4E-4ED7-9484-EECE0C66E271__GUID-166B7371-05F6-4A91-A77C-F0969741F908">IPv6合规性和指定的IP支持</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>对于非分片队列，Oracle数据库AQ支持IPv6，Oracle数据库AQ客户端可以使用OCI预订句柄属性<code class="codeph">OCI_ATTR_SUBSCR_IPADDR</code>来指定传递通知的IP地址。这对于具有多个网络接口卡或IP地址的计算机上的客户端尤其有用。可以在第一次注册之前使用环境句柄中的属性指定侦听器线程的IP地址。线程在第一次调用<code class="codeph">OCISubscriptionRegister</code>时启动。如果客户端尝试使用不同的环境句柄在另一个IP地址上启动另一个线程，Oracle Database AQ将返回错误。如果未指定IP地址，Oracle Database AQ将在客户端所在的计算机的所有IP地址上发送通知。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-537FBC2D-0A4E-4ED7-9484-EECE0C66E271__GUID-26A115DA-546F-4B25-B1EA-F86D357E6F34">注册超时</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>在早期版本的Oracle数据库高级队列中，通知注册一直存在，直到客户端明确删除或在客户端发生故障时被清除。从Oracle数据库高级队列<span class="italic">10g</span>第2版（10.2）开始，客户端可以注册指定的时间，然后自动清除注册。
                     </p>
                     <p>清除注册后，Oracle数据库高级队列会向客户端发送通知，因此客户端可以调用其回调并执行任何必要的操作。</p>
                     <div class="infoboxnotealso" id="GUID-537FBC2D-0A4E-4ED7-9484-EECE0C66E271__GUID-F11D5899-3929-46F2-96BC-AD485EB3261F">
                        <p class="notep1">也可以看看：</p>
                        <p><span class="q">“ <a href="aq-basic-components.html#GUID-94CBE09C-EE8C-4874-A30D-CCBE1F8D862E" title="该组件标识消息的生产者或消费者。">AQ注册信息类型</a> ”</span>有关<code class="codeph">timeout</code>参数的信息</p>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-537FBC2D-0A4E-4ED7-9484-EECE0C66E271__GUID-DDC7403F-6FD0-4267-96B2-669122A0C067">清除通知</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>客户也可以注册只接收第一个通知，然后自动清除注册。</p>
                     <p>通知清除有用的示例是等待队列启动的客户端。在这种情况下，只有第一个通知是有用的;后续通知不提供其他信息。以前，这个客户端一旦入队就要求取消注册;现在注册可以配置为自动消失。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-537FBC2D-0A4E-4ED7-9484-EECE0C66E271__GUID-45A1093C-23DB-4FAF-97C1-1397596A53C0">缓冲消息通知</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>客户端可以注册缓冲消息的通知。注册请求适用于缓冲和持久消息。随PL / SQL或OCI通知一起提供的消息属性指定消息是缓冲的还是持久的。</p>
                     <div class="infoboxnotealso" id="GUID-537FBC2D-0A4E-4ED7-9484-EECE0C66E271__GUID-4E363589-CD4D-430D-83E6-2C96DF39C42D">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="q">“ <a href="aq-operations-using-pl-sql.html#GUID-DBBE096A-EEA0-4E1E-AC3F-6E1B492D1FB5" title="此过程注册电子邮件地址，用户定义的PL / SQL过程或HTTP URL以进行消息通知。">注册通知</a> ”</span>以获取有关PL / SQL通知的更多信息</p>
                           </li>
                           <li>
                              <p>附录C，“OCI示例”，仅出现在本指南的HTML版本中，用于OCI通知的示例</p>
                           </li>
                        </ul>
                     </div>
                     <p>不支持可靠的通知。</p>
                  </div>
                  <!-- class="section" -->
               </div><a id="ADQUE2460"></a><div class="props_rev_3"><a id="GUID-B5FC0BA8-C1F0-444F-A7BE-13797C65E57C" name="GUID-B5FC0BA8-C1F0-444F-A7BE-13797C65E57C"></a><h4 id="ADQUE-GUID-B5FC0BA8-C1F0-444F-A7BE-13797C65E57C" class="sect4"><span class="enumeration_section">1.5.1</span>注册意见</h4>
                  <div>
                     <p>字典视图<code class="codeph">DBA_SUBSCR_REGISTRATIONS</code>和<code class="codeph">USER_SUBSCR_REGISTRATIONS</code>显示系统中的各种注册。
                     </p>
                     <p>诊断视图<code class="codeph">GV$SUBSCR_REGISTRATION_STATS</code>可用于监视通知统计和性能。
                     </p>
                  </div>
               </div><a id="ADQUE2461"></a><div class="props_rev_3"><a id="GUID-7A2AFB2D-E9F3-4769-8374-27D93CE7E0DF" name="GUID-7A2AFB2D-E9F3-4769-8374-27D93CE7E0DF"></a><h4 id="ADQUE-GUID-7A2AFB2D-E9F3-4769-8374-27D93CE7E0DF" class="sect4"><span class="enumeration_section">1.5.2</span>基于事件的通知</h4>
                  <div>
                     <p>基于事件的通知由一组协调器（ <code class="codeph">EMNC</code> ）和从属进程处理。
                     </p>
                     <p>事件通知负载分布在这些进程中。这些进程并行处理系统通知，提供处理更大量通知的功能，更快的响应时间以及用于登台通知的更低共享内存使用。</p>
                  </div>
               </div><a id="ADQUE2462"></a><div class="props_rev_3"><a id="GUID-4F8204C1-E161-43B0-9CA2-C0A571C133A1" name="GUID-4F8204C1-E161-43B0-9CA2-C0A571C133A1"></a><h4 id="ADQUE-GUID-4F8204C1-E161-43B0-9CA2-C0A571C133A1" class="sect4"><span class="enumeration_section">1.5.3</span>按时间分组的通知</h4>
                  <div>
                     <p>通知应用程序可以注册以接收针对在指定时间间隔内发生的所有事件的单个通知。通知客户端可以指定通知的开始时间。此外，他们必须将时间指定为分组类，将时间间隔指定为分组值。</p>
                     <p>重复计数可用于限制传递的通知数量。客户端可以接收两种类型的分组事件：摘要或最后。摘要通知是订阅的所有消息的消息标识符列表。如果将last指定为分组类型，则通知将包含有关通知间隔中最后一条消息的信息。还会发送间隔中的消息数。PLSQL和OCI中的注册接口允许在<code class="codeph">AQ$_REGISTRATION_INFO</code>和OCI订阅句柄中指定<code class="codeph">START_TIME</code> ， <code class="codeph">REPEAT_COUNT</code> ， <code class="codeph">GROUPING CLASS</code> ， <code class="codeph">GROUPING VALUE</code> ， <code class="codeph">GROUPING TYPE</code> 。
                     </p>
                     <p>由客户端发起的AQ通知接收的通知描述符提供关于消息标识符组和该组中的通知数量的信息。</p>
                     <div class="infoboxnotealso" id="GUID-4F8204C1-E161-43B0-9CA2-C0A571C133A1__GUID-3767C5FD-A82D-4A90-9156-C570301C0A99">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="../arpls/advanced-queuing-AQ-types.html#ARPLS301" target="_blank"><span class="italic">Oracle数据库PL / SQL包和类型参考</span></a></p>
                           </li>
                           <li>
                              <p><a href="../lnoci/performance-topics.html#LNOCI092" target="_blank"><span class="italic">Oracle调用接口程序员指南</span></a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div>
            </div><a id="ADQUE2464"></a><a id="ADQUE2465"></a><a id="ADQUE2466"></a><a id="ADQUE2467"></a><a id="ADQUE2468"></a><a id="ADQUE2469"></a><a id="ADQUE2463"></a><div class="props_rev_3"><a id="GUID-83F68756-B358-45ED-8C21-1DE6E87DCF7A" name="GUID-83F68756-B358-45ED-8C21-1DE6E87DCF7A"></a><h3 id="ADQUE-GUID-83F68756-B358-45ED-8C21-1DE6E87DCF7A" class="sect3"><span class="enumeration_section">1.6入队</span>功能</h3>
               <div>
                  <p>本主题描述了排队功能，排队消息数组，关联标识符，排队中的消息优先级和排序，消息分组，发件人标识以及时间规范和调度。</p>
                  <p>以下功能适用于排队邮件：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="aq-introduction.html#GUID-83F68756-B358-45ED-8C21-1DE6E87DCF7A__CHDDIFAC">排队一组消息</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-83F68756-B358-45ED-8C21-1DE6E87DCF7A__CHDHBIBH">相关标识符</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-83F68756-B358-45ED-8C21-1DE6E87DCF7A__CHDIAGFG">入队中消息的优先级和排序</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-83F68756-B358-45ED-8C21-1DE6E87DCF7A__CHDFEHHB">消息分组</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-83F68756-B358-45ED-8C21-1DE6E87DCF7A__CHDCHGII">发件人识别</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-83F68756-B358-45ED-8C21-1DE6E87DCF7A__CHDFFCIA">时间规范和调度</a></p>
                     </li>
                  </ul>
                  <div class="section" id="GUID-83F68756-B358-45ED-8C21-1DE6E87DCF7A__CHDDIFAC">
                     <p class="subhead2" id="GUID-83F68756-B358-45ED-8C21-1DE6E87DCF7A__GUID-D8729C56-43E6-4E85-A010-C081F3CE9C86">排队一组消息</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>将消息排入队列时，您可以同时对一组消息进行操作，而不是一次对一条消息进行操作。这可以提高排队操作的性能。将消息数组排入队列时，每条消息共享相同的排队选项，但每条消息可以具有不同的消息属性。您可以使用PL / SQL或OCI执行数组排队操作。</p>
                     <p>此版本中的缓冲消息不支持阵列入队。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-83F68756-B358-45ED-8C21-1DE6E87DCF7A__CHDHBIBH">
                     <p class="subhead2" id="GUID-83F68756-B358-45ED-8C21-1DE6E87DCF7A__GUID-0666E55F-80BA-4064-B84B-E9E8E14B2924">相关标识符</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>您可以为每条消息分配一个标识符，从而提供一种在以后检索特定消息的方法。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-83F68756-B358-45ED-8C21-1DE6E87DCF7A__CHDIAGFG">
                     <p class="subhead2" id="GUID-83F68756-B358-45ED-8C21-1DE6E87DCF7A__GUID-D392B8F0-14E1-4FD6-AE46-2422F780C563">入队中消息的优先级和排序</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>您可以指定排队消息的优先级及其在队列中的确切位置。这意味着用户可以通过三种方式指定消息的使用顺序：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>可以为每条消息分配优先级。</p>
                        </li>
                        <li>
                           <p>排序顺序指定用于对队列中的所有消息进行排序的属性。这是在创建队列表时设置的，无法更改。您可以选择按优先级，排队时间或提交时间对邮件进行排序。</p>
                           <div class="infoboxnotealso" id="GUID-83F68756-B358-45ED-8C21-1DE6E87DCF7A__GUID-0ECD94E1-67AA-42D6-93A1-9E85BAA7BEE2">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><span class="q">“ <a href="aq-administrative-interface.html#GUID-7A35067E-0A52-4EC2-B0F8-3540E8554E41" title="DBMS_AQADM.CREATE_QUEUE_TABLE为预定义类型的消息创建非分片队列表。">创建队列表</a> ”</span>以获取有关排序顺序的更多信息</p>
                                 </li>
                              </ul>
                           </div>
                        </li>
                        <li>
                           <p>序列偏差将消息与其他消息相关联。</p>
                        </li>
                     </ul>
                     <div class="infoboxnote" id="GUID-83F68756-B358-45ED-8C21-1DE6E87DCF7A__GUID-BCE3B9E6-B37B-4534-81D9-FC4793FDD2A6">
                        <p class="notep1">注意：</p>
                        <p>序列偏差功能在10 <span class="italic">g</span>版本2（10.2）中已弃用。
                        </p>
                     </div>
                     <p>如果多个消费者在同一队列上行动，则每个消费者获得可立即消费的第一个消息。将跳过正在被另一个消费者使用的消息。</p>
                     <p>通过将优先级，排队时间指定为排序顺序来实现消息的优先级排序。如果选择了优先级排序，则每个消息在入队代理的入队时间被分配优先级。在出队时，消息按指定的优先级顺序出列。如果两条消息具有相同的优先级，则它们出队的顺序由入队时间决定。还可以通过将排队时间，优先级指定为消息的排序顺序来创建先进先出（FIFO）优先级队列。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-83F68756-B358-45ED-8C21-1DE6E87DCF7A__CHDFEHHB">
                     <p class="subhead2" id="GUID-83F68756-B358-45ED-8C21-1DE6E87DCF7A__GUID-E048BBBD-508D-4ADD-9091-7BE91F37A556">消息分组</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>属于一个队列的消息可以被分组以形成一个只能由一个用户一次消费的集合。这要求在启用了消息分组的队列表中创建队列。属于组的所有消息必须在同一事务中创建，并且在一个事务中创建的所有消息都属于同一组。</p>
                     <p>此功能允许用户将复杂消息分段为简单消息。例如，指向包含发票的队列的消息可以构造为以标题消息开头的一组消息，后面是表示细节的消息，后跟预告片消息。</p>
                     <p>如果消息有效负载包含可以分割为较小对象的复杂大对象（如图像和视频），则消息分组也很有用。</p>
                     <p>组消息属性优先级，延迟和到期仅由为组中第一条消息指定的消息属性确定，而不管为组中的后续消息指定了哪些属性。</p>
                     <p>消息分组属性在传播过程中保留。但是，还必须启用传播消息的目标队列以进行事务分组。如果要在为启用事务分组的队列中出列消息时保留消息分组属性，则必须记住一些限制。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-83F68756-B358-45ED-8C21-1DE6E87DCF7A__CHDCHGII">
                     <p class="subhead2" id="GUID-83F68756-B358-45ED-8C21-1DE6E87DCF7A__GUID-73E6EC91-DA2A-4E5D-9470-26659E246BEF">发件人识别</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>应用程序可以使用自定义标识标记它们发送的消息。Oracle数据库高级队列还会自动识别消息从中出列的队列。这允许应用程序在同一数据库中跟踪传播消息或字符串消息的路径。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-83F68756-B358-45ED-8C21-1DE6E87DCF7A__CHDFFCIA">
                     <p class="subhead2" id="GUID-83F68756-B358-45ED-8C21-1DE6E87DCF7A__GUID-99606B68-B9D2-4EB7-865D-7483992394E2">时间规范和调度</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>消息可以入队，其到期时间指定消息可用于出列的时间间隔。到期的默认值永远不会。当邮件过期时，它将移至异常队列。到期处理要求队列监视器正在运行。</p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="ADQUE2471"></a><a id="ADQUE2472"></a><a id="ADQUE2473"></a><a id="ADQUE2474"></a><a id="ADQUE2475"></a><a id="ADQUE2476"></a><a id="ADQUE2477"></a><a id="ADQUE2478"></a><a id="ADQUE2479"></a><a id="ADQUE0104"></a><a id="ADQUE2470"></a><div class="props_rev_3"><a id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A" name="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A"></a><h3 id="ADQUE-GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A" class="sect3"><span class="enumeration_section">1.7</span>出列功能</h3>
               <div>
                  <p>本主题讨论出列特征并发出列，出列方法，出列模式，出列消息，消息状态，出列消息导航，等待消息，带延迟的重试，可选事务保护和异常队列。</p>
                  <p>以下功能适用于使消息出列：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="aq-introduction.html#GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__CHDIJCEE">同时出局</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__CHDCEJDG">出列方法</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__CHDCEDDG">出列模式</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__CHDIBGDA">将消息数组出列</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__CHDIECFG">消息国家</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__CHDEDCCI">出列队列中的消息导航</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__CHDCBGHJ">等待消息</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__CHDFCFEA">延迟重试</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__CHDBAEED">可选的交易保护</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__CHDICJFH">异常队列</a></p>
                     </li>
                  </ul>
                  <div class="section" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__CHDIJCEE">
                     <p class="subhead2" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__GUID-B8DF7262-16C2-4BEA-B164-6DB0FD498F9D">同时出局</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>当有多个进程从单用户队列中出队或在多用户队列上为单个用户出列时，不同的进程会跳过并发进程正在处理的消息。这允许多个进程在同一消费者的不同消息上同时工作。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__CHDCEJDG">
                     <p class="subhead2" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__GUID-AE44B0AA-19C7-4ACD-B460-6EC7AA8E5FCD">出列方法</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>可以使用以下出列方法之一将消息出列：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>指定相关标识符</p>
                           <p><a id="d6697e2755" class="indexterm-anchor"></a><a id="d6697e2761" class="indexterm-anchor"></a>相关标识符是用户定义的消息属性。具有相同相关标识符的多个消息可以存在于队列中，这意味着消息之间的排序（排队顺序）可能不会在出队呼叫中保留。
                           </p>
                        </li>
                        <li>
                           <p>指定消息标识符</p>
                           <p><a id="d6697e2770" class="indexterm-anchor"></a><a id="d6697e2776" class="indexterm-anchor"></a>消息标识符是系统分配的值（ <code class="codeph">RAW</code>数据类型）。队列中只能出现一条带有给定消息标识符的消息。
                           </p>
                        </li>
                        <li>
                           <p>指定出队条件</p>
                           <p>出列条件以消息属性或消息内容表示，并且在语法上类似于SQL查询的<code class="codeph">WHERE</code>子句。根据条件评估队列中的消息，并返回满足给定条件的消息。当使用出列条件时，出列的消息的顺序是不确定的，并且不遵守队列的排序顺序。
                           </p>
                        </li>
                        <li>
                           <p>默认出队</p>
                           <p>默认的dequeue检索第一个可用消息。</p>
                        </li>
                     </ul>
                     <div class="infoboxnote" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__GUID-EEA0AE50-F950-4AB8-ACED-AE8C056F1A3D">
                        <p class="notep1">注意：</p>
                        <p>使用相关标识符，消息标识符或出列条件进行出列不会保留消息分组属性。</p>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__CHDCEDDG">
                     <p class="subhead2" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__GUID-A82EB285-9726-41C7-B40D-88503FBF4BF7">出列模式</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>出列请求可以浏览消息，删除消息或删除消息而无需数据。如果浏览了消息，则它仍可用于进一步处理。如果删除或删除了没有数据的消息，则它不再可用于出列请求。根据队列属性，可以在队列表中保留已删除的消息。只有在为其队列指定了保留时间后，消息才会在消耗后保留在队列表中。</p>
                     <p>浏览模式有三种风险。首先，无法保证消息在浏览后可以再次出列，因为来自并发用户的出列呼叫可能已删除该消息。要防止已查看的消息被并发用户出列，您应该以锁定模式查看该消息。</p>
                     <p>其次，如果指定了非零等待时间并且导航位置到达队列末尾，则浏览模式下的出队位置将自动更改为队列的开头。如果在浏览模式下使用<code class="codeph">NEXT_MESSAGE</code>导航选项和非零等待时间重复出列呼叫，则最终可以反复出现相同的消息。Oracle建议您在会话中对队列中的第一个出列调用使用非零等待时间，然后使用零等待时间和<code class="codeph">NEXT_MESSAGE</code>导航选项进行后续出列调用。如果出列调用获得“队列结束”错误消息，则可以使用<code class="codeph">FIRST_MESSAGE</code>导航选项通过队列开头的出列调用显式设置出队位置，然后可以再次浏览队列中的消息。
                     </p>
                     <p>第三，如果队列的排序顺序是<code class="codeph">ENQ_TIME</code> ， <code class="codeph">PRIORITY</code>或这两者的组合，那么从一个浏览到下一个浏览的结果可能是不可重复的。如果必须具有一致的浏览结果，则应使用<a href="glossary.html#GUID-F4FC927D-BBFE-451D-9CCA-96C7387A39B0"><span class="xrefglossterm">提交时队列</span></a> 。
                     </p>
                     <div class="infoboxnotealso" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__GUID-F2ADD023-19FA-407C-96DF-D7551C169F37">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="q">“ <a href="aq-administrative-interface.html#GUID-7A35067E-0A52-4EC2-B0F8-3540E8554E41" title="DBMS_AQADM.CREATE_QUEUE_TABLE为预定义类型的消息创建非分片队列表。">创建队列表</a> ”</span></p>
                           </li>
                        </ul>
                     </div>
                     <p>当使用<code class="codeph">REMOVE_NODATA</code>模式将消息出队时，不会检索消息的有效负载。当用户已经检查过消息有效负载时，该模式可能很有用，可能是通过先前的<code class="codeph">BROWSE</code>出队。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__CHDIBGDA">
                     <p class="subhead2" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__GUID-435C0408-69E1-4E42-BF22-266CA2EE875D">将消息数组出列</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>从队列中出列消息时，您可以同时对一组消息进行操作，而不是一次对一条消息进行操作。这可以改善出列操作的性能。如果从事务队列中出列，则可以通过单个调用将事务的所有消息出列，这使应用程序编程更容易。</p>
                     <p>从队列中出列消息数组时，每条消息共享相同的出列选项，但每条消息可以具有不同的消息属性。您可以使用PL / SQL或OCI执行数组入队和数组出列操作。</p>
                     <p>此版本中的缓冲消息不支持阵列出列。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__CHDIECFG">
                     <p class="subhead2" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__GUID-B9D7FAAD-95CB-4508-B5E1-DF068222C565">消息国家</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>多个进程或操作系统线程可以使用相同的使用者名称从队列中并发地出列。在这种情况下，Oracle数据库高级队列提供了第一个未锁定的消息，该消息位于队列的头部并且是供消费者使用的。除非在出列期间指定特定消息的消息标识符，否则消费者可以使处于<code class="codeph">READY</code>状态的消息出列。
                     </p>
                     <p>消息被认为是<code class="codeph">PROCESSED</code>只有当所有预期的消费者已经成功出队的消息。如果一个或多个消费者在<code class="codeph">EXPIRATION</code>时间之前没有将消息出列，则认为消息已<code class="codeph">EXPIRED</code> 。消息过期后，将其移至异常队列。
                     </p>
                     <p>来自多个消费者队列的过期消息不能由消息的预期接收者出列。但是，通过在出队选项中指定<code class="codeph">NULL</code>使用者名称，它们可以在<code class="codeph">REMOVE</code>模式中出列一次。
                     </p>
                     <div class="infoboxnote" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__GUID-0A009B61-AD6E-4243-9EED-6ABFFAA8CBA2">
                        <p class="notep1">注意：</p>
                        <p>如果在<code class="codeph">compatible</code>参数设置为<code class="codeph">8.0</code>的队列表中创建了多消费者异常队列，则只能通过指定消息标识符来使过期消息出列。
                        </p>
                        <p>在Oracle数据库高级队列<span class="italic">10g</span>第2版（10.2）中不推荐使用<code class="codeph">compatible</code>设置为<code class="codeph">8.0</code>的队列表中创建的队列（在本指南中称为8.0样式的队列）。Oracle建议您创建的任何新队列都是8.1样式或更新，并且您可以在方便的时候迁移现有的8.0样式队列。
                        </p>
                     </div>
                     <p>从Oracle Database Advanced Queuing版本8.1.6开始，只有队列监视器从多个消息队列中删除消息。这允许dequeuers通过不将消息锁定在队列表中来完成出队操作。由于队列监视器大约每分钟从大型消费者队列中删除所有消费者已处理的消息，因此用户可以看到消息完全处理的时间与从队列中物理删除消息之间的延迟。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__CHDEDCCI">
                     <p class="subhead2" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__GUID-086355B6-2B94-40D9-80D2-09F19CAB2A5E">出列队列中的消息导航</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>您有多种选择从队列中选择消息。您可以使用<code class="codeph">FIRST_MESSAGE</code>导航选项选择第一条消息。或者，一旦您选择了一条消息并在队列中建立了它的位置，您就可以使用<code class="codeph">NEXT_MESSAGE</code>导航选项检索下一条消息。
                     </p>
                     <p><code class="codeph">FIRST_MESSAGE</code>导航选项在队列上执行<code class="codeph">SELECT</code> 。该<code class="codeph">NEXT_MESSAGE</code>导航选项从结果获取<code class="codeph">SELECT</code>在运行<code class="codeph">FIRST_MESSAGE</code>导航。因此，性能得到优化，因为后续的出列不需要再次运行整个<code class="codeph">SELECT</code> 。
                     </p>
                     <p>如果为事务分组启用了队列，则导航选项的工作方式略有不同。如果请求<code class="codeph">FIRST_MESSAGE</code> ，则出队位置仍将重置为队列的开头。但是，如果请求<code class="codeph">NEXT_MESSAGE</code> ，则将位置设置为同一<span class="italic">事务中</span>的下一条消息。事务分组还提供<code class="codeph">NEXT_TRANSACTION</code>选项。它将出列位置设置为下一个事务的第一条消息。
                     </p>
                     <p><a id="d6697e2961" class="indexterm-anchor"></a><a id="d6697e2965" class="indexterm-anchor"></a>如果您通过指定相关标识符或消息标识符出列，或者如果您将某些事务的消息出列然后提交，则事务分组无效。
                     </p>
                     <p>如果在使用<code class="codeph">NEXT_MESSAGE</code>或<code class="codeph">NEXT_TRANSACTION</code>选项时到达队列<code class="codeph">NEXT_TRANSACTION</code> ，并且指定了非零等待时间，则导航位置将自动更改为队列的开头。如果指定了零等待时间，则可以在到达队列末尾时获得异常。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__CHDCBGHJ">
                     <p class="subhead2" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__GUID-3DE663E5-F464-499E-AF23-5FE11D30637F">等待消息</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>Oracle数据库高级队列允许应用程序阻止一个或多个队列等待新排队的消息或准备就绪的消息到达。您可以使用<code class="codeph">DEQUEUE</code>操作等待消息到达单个队列，或使用<code class="codeph">LISTEN</code>操作等待消息到达多个队列。
                     </p>
                     <div class="infoboxnote" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__GUID-CE074C3B-E9DA-4A04-BAF6-D00BE92380E8">
                        <p class="notep1">注意：</p>
                        <p>应用程序还可以对异常队列执行阻塞队列，以等待<code class="codeph">EXPIRED</code>消息的到达。
                        </p>
                     </div>
                     <p>当阻塞<code class="codeph">DEQUEUE</code>调用返回时，它返回消息属性和消息有效负载。当阻塞<code class="codeph">LISTEN</code>调用返回时，它仅公开消息已到达的队列的名称。需要后续的<code class="codeph">DEQUEUE</code>操作来使消息出列。
                     </p>
                     <p>当代理列表中有多个代理的消息时， <code class="codeph">LISTEN</code>将返回第一个有消息的代理。为防止一个代理程序使其他代理程序缺少消息，应用程序可以更改代理程序列表中代理程序的顺序。
                     </p>
                     <p>应用程序可以选择指定零或更多秒的超时，以指示Oracle数据库高级队列必须等待消息到达的时间。默认值是永远等待，直到消息到达队列。这消除了持续轮询来自应用程序的消息的负担，并且它节省了CPU和网络资源，因为应用程序保持阻塞状态，直到新消息入队或在<code class="codeph">DELAY</code>时间后变为<code class="codeph">READY</code> 。
                     </p>
                     <p>如果新消息没有<code class="codeph">DELAY</code>或者在<code class="codeph">DELAY</code>或<code class="codeph">EXPIRATION</code>时间过去后被队列监视器进程唤醒，则出队阻塞的应用程序要么由enqueuer直接唤醒。如果应用程序正在等待消息到达远程队列，则Oracle数据库高级队列传播器会在传播消息后唤醒阻塞的dequeuer。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__CHDFCFEA">
                     <p class="subhead2" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__GUID-C87C4418-8812-4CB0-9EC8-1EE2CAA3D6A9">延迟重试</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>如果从队列中使消息出列的事务失败，则认为它是消费该消息的不成功尝试。Oracle数据库高级队列记录在消息历史记录中使用消息的失败尝试次数。应用程序可以查询队列表视图的<code class="codeph">RETRY_COUNT</code>列，以查找对消息的不成功尝试次数。此外，Oracle数据库高级队列允许应用程序在队列级别指定队列中消息的最大重试次数。最大重试次数的默认值为5。如果删除邮件的失败尝试次数超过此数量，则邮件将移至异常队列，并且不再可供应用程序使用。
                     </p>
                     <div class="infoboxnote" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__GUID-BAD0C00F-9BE3-4B94-803D-70F1DFDA7216">
                        <p class="notep1">注意：</p>
                        <p>如果由于服务器进程在实例上死亡（包括<code class="codeph">ALTER</code> <code class="codeph">SYSTEM</code> <code class="codeph">KILL</code> <code class="codeph">SESSION</code> ）或<code class="codeph">SHUTDOWN</code> <code class="codeph">ABORT</code>而导致dequeue事务失败，则<code class="codeph">RETRY_COUNT</code>不会递增。
                        </p>
                     </div>
                     <p>不良状况可能导致事务接收消息结束。Oracle数据库高级队列允许用户在指定的重试延迟间隔内隐藏错误消息，在此期间它处于WAITING状态。在重试延迟之后，失败的消息再次可用于出队。Oracle数据库高级队列时间管理器强制执行重试延迟属性。重试延迟的默认值为0。</p>
                     <p><a id="d6697e3068" class="indexterm-anchor"></a>如果多个会话同时从队列中出列消息，则可能无法始终正确更新<code class="codeph">RETRY_COUNT</code>信息。如果会话1将消息出列并回滚事务，则Oracle数据库AQ会注意到必须更新此消息的<code class="codeph">RETRY_COUNT</code>信息。但是，在第一个会话完成回滚之前， <code class="codeph">RETRY_COUNT</code>不能递增。如果会话2在会话1完成回滚之后但在其递增<code class="codeph">RETRY_COUNT</code>之前尝试使相同的消息出<code class="codeph">RETRY_COUNT</code> ，则会话2的出列成功。当会话1尝试递增<code class="codeph">RETRY_COUNT</code> ，它会发现消息被会话2锁定，并且<code class="codeph">RETRY_COUNT</code>不会递增。然后在<code class="codeph">USER_DUMP_DESTINATION</code>为实例生成跟踪文件，并显示以下消息：</p><pre class="oac_no_warn" dir="ltr">回滚时出错：ORA-25263：队列<span class="italic">schema.qname中</span>没有带消息ID的消息...
</pre><div class="infoboxnote" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__GUID-3E394308-99E0-4F6C-A44A-04D0DFF91470">
                        <p class="notep1">注意：</p>
                        <p>8.0风格的多消费者队列不提供最大重试次数和重试延迟。</p>
                        <p>在Oracle数据库高级队列<span class="italic">10g</span>第2版（10.2）中不推荐使用<code class="codeph">compatible</code>设置为<code class="codeph">8.0</code>的队列表中创建的队列（在本指南中称为8.0样式的队列）。Oracle建议您创建的任何新队列都是8.1样式或更新，并且您可以在方便的时候迁移现有的8.0样式队列。
                        </p>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__CHDBAEED">
                     <p class="subhead2" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__GUID-202BEAC7-FAD6-4E44-8C1D-51F0F6624F24">可选的交易保护</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>入队和出队请求通常是包含请求的事务的一部分，从而提供所需的<a href="glossary.html#GUID-4956C594-EE49-498B-A9DD-7371518B4EBA"><span class="xrefglossterm">事务</span></a>操作。但是，您可以指定特定请求本身是一个事务，使该请求的结果立即对其他事务可见。这意味着当应用enqueue或dequeue语句时或在提交事务之后，可以使消息对外部世界可见。
                     </p>
                     <div class="infoboxnote" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__GUID-838D7EF6-8D21-43D5-BA1A-68C234C750D2">
                        <p class="notep1">注意：</p>
                        <p>缓冲消息传递不支持事务保护。</p>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__CHDICJFH">
                     <p class="subhead2" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__GUID-7016AE91-28BB-4BD2-80E4-BA4E91159DF0">异常队列</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>异常队列是过期或不可用消息的存储库。应用程序无法直接排入异常队列。此外，多消费者异常队列不能具有与之关联的订户。但是，打算处理这些过期或无法使用的消息的应用程序可以使用删除模式将它们从异常队列中正好出列一次。出列时指定的使用者名称应为null。还可以通过指定消息标识符将消息从异常队列中取出。</p>
                     <div class="infoboxnote" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__GUID-9666108C-71F8-4EB3-AFB7-E513BF125942">
                        <p class="notep1">注意：</p>
                        <p>过期或不可用的缓冲消息作为持久消息移动到异常队列。</p>
                        <p>用于单用户队列或用于8.0样式的多消费者队列的消息只有在消息被移动到异常队列后才能通过其消息标识符出列。</p>
                        <p>在Oracle数据库高级队列<span class="italic">10g</span>第2版（10.2）中不推荐使用<code class="codeph">compatible</code>设置为<code class="codeph">8.0</code>的队列表中创建的队列（在本指南中称为8.0样式的队列）。Oracle建议您创建的任何新队列都是8.1样式或更新，并且您可以在方便的时候迁移现有的8.0样式队列。
                        </p>
                     </div>
                     <p>将消息移动到异常队列后，无法在移动到异常队列之前识别消息所在的队列。如果此信息很重要，则应用程序必须将此信息保存在消息本身中。</p>
                     <p>异常队列是可以在排队时间内指定的消息属性。如果未指定异常队列，则使用缺省异常队列。创建队列表时会自动创建缺省异常队列。</p>
                     <p>在以下条件下，消息将移至异常队列：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>它未在指定的到期时间间隔内出列。</p>
                           <p>对于打算用于多个收件人的邮件，如果一个或多个预期收件人无法在指定的到期时间间隔内将邮件出列，则将邮件移动到例外队列。默认的到期时间间隔永远不会，这意味着邮件不会过期。</p>
                        </li>
                        <li>
                           <p>消息已成功出列，但由于在处理消息时出现错误，使其出列的应用程序回滚了事务。如果消息已出列但已回滚超过重试限制指定的次数，则消息将移至异常队列。</p>
                           <p>对于针对多个收件人的邮件，将为每个收件人保留单独的重试计数。仅当邮件的所有收件人的重试计数超过指定的重试限制时，邮件才会移至例外队列。</p>
                           <p>单用户队列和8.1式多用户队列的默认重试限制为5。8.0风格的多消费者队列不支持重试限制，这在Oracle数据库高级队列<span class="italic">10g</span>第2版（10.2）中已弃用。
                           </p>
                           <div class="infoboxnote" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__GUID-6736B024-8977-4333-91FA-8616DE777B2F">
                              <p class="notep1">注意：</p>
                              <p>如果由于服务器进程在实例上死亡（包括<code class="codeph">ALTER</code> <code class="codeph">SYSTEM</code> <code class="codeph">KILL</code> <code class="codeph">SESSION</code> ）或<code class="codeph">SHUTDOWN</code> <code class="codeph">ABORT</code>而导致dequeue事务失败，则<code class="codeph">RETRY_COUNT</code>不会递增。
                              </p>
                           </div>
                        </li>
                        <li>
                           <p>客户端处理的语句包含一个成功的dequeue，但由于异常，语句本身稍后被撤消。</p>
                           <p>如果出列过程成功但PL / SQL过程引发异常，则Oracle数据库高级队列会增加出列过程返回的消息的重试次数。</p>
                        </li>
                        <li>
                           <p>客户端程序成功使消息出列但在提交事务之前终止。</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="ADQUE2481"></a><a id="ADQUE2482"></a><a id="ADQUE2483"></a><a id="ADQUE2484"></a><a id="ADQUE2485"></a><a id="ADQUE2486"></a><a id="ADQUE2487"></a><a id="ADQUE2488"></a><a id="ADQUE2489"></a><a id="ADQUE2490"></a><a id="ADQUE2491"></a><a id="ADQUE2492"></a><a id="ADQUE2480"></a><div class="props_rev_3"><a id="GUID-329A6279-925C-435B-A6F1-76835EF20C40" name="GUID-329A6279-925C-435B-A6F1-76835EF20C40"></a><h3 id="ADQUE-GUID-329A6279-925C-435B-A6F1-76835EF20C40" class="sect3"><span class="enumeration_section">1.8</span>传播特征</h3>
               <div>
                  <p>消息可以从一个队列传播到另一个队列，允许应用程序相互通信，而无需连接到同一个数据库或同一个队列。目标队列可以位于同一数据库中，也可以位于远程数据库中。</p>
                  <p>通过传播，您可以将消息扇出到大量收件人，而无需全部将消息从单个队列中出列。您还可以使用传播将来自不同队列的消息组合到单个队列中。这称为合成或漏斗消息。</p>
                  <div class="infoboxnote" id="GUID-329A6279-925C-435B-A6F1-76835EF20C40__GUID-4A6BE513-8096-4DE9-8A00-4CF1C12237DA">
                     <p class="notep1">注意：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>您可以将消息从多个使用者队列传播到单个使用者队列。无法从单用户队列传播到多用户队列。</p>
                        </li>
                        <li>
                           <p>对于非分片队列，您可以将消息从多个使用者队列传播到单个使用者非分片队列。不可能从单用户队列传播到多用户非非串行队列。</p>
                           <p></p>
                        </li>
                        <li>
                           <p>对于分片队列，您可以在单消费者和多消费者分片队列之间传播。</p>
                        </li>
                        <li>
                           <p>您无法在分片和非分片队列之间传播。</p>
                        </li>
                     </ul>
                  </div>
                  <p>消息传播后，消息在源队列中被标记为已处理，即使消费者尚未在远程队列中使消息出列。同样，当传播的消息在远程队列中到期时，消息将移动到远程队列的异常队列，而不是移动到本地队列的异常队列。Oracle Database Advanced Queuing当前不会将异常传播到源队列。</p>
                  <p>为了实现传播，为要传播消息的队列定义一个或多个订户，并为要从队列传播消息的每个目的地定义调度。</p>
                  <p>Oracle Database Advanced Queuing自动检查远程队列的类型是否在结构上等同于创建它们的字符集的上下文中的本地队列的类型。然后，传播在源队列中排队的消息，并自动将其用于在目标队列或队列中出列队列。</p>
                  <p>当消息到达目标队列时，基于源队列模式名称的会话用于将新到达的消息排入目标队列。这意味着您必须将源队列的模式授予目标队列的入队权限。</p>
                  <p>传播作为Oracle Scheduler作业运行。在后台进程中， <code class="codeph">JOB_QUEUE_PROCESS</code>将运行该作业。传播调度可以是一个专用的进程，可以连续运行而且没有结束，或者它可以是事件驱动的，在这种情况下，它只在有传播消息时运行。
                  </p>
                  <p>Oracle数据库高级队列提供两种传播：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>队列到数据链路的传播</p>
                     </li>
                     <li>
                        <p>队列到队列的传播</p>
                     </li>
                  </ul>
                  <p><a id="d6697e3466" class="indexterm-anchor"></a>队列到数据链路的传播将消息或事件从源队列传递到dblink标识的目标数据库中的所有预订队列。
                  </p>
                  <p>单个传播调度用于将消息传播到所有订阅队列。因此，对此计划所做的任何更改都将影响到所有订阅队列的消息传递。</p>
                  <p><a id="d6697e3477" class="indexterm-anchor"></a>队列到队列的传播将消息或事件从源队列传递到dblink上标识的特定目标队列。这允许用户对用于消息传递的传播调度进行细粒度控制。
                  </p>
                  <p>传播到目标Oracle RAC系统时，此新传播模式还支持透明故障转移。通过队列到队列传播，如果队列的所有者实例在Oracle RAC上失败，则不再需要重新指向数据库链接。</p>
                  <p>Oracle Database Advanced Queuing提供有关传播的消息和计划本身的详细统计信息。此信息可用于调整传播计划以获得最佳性能。</p>
                  <div class="section">
                     <p class="subhead2" id="GUID-329A6279-925C-435B-A6F1-76835EF20C40__GUID-423BF50A-A164-437A-BA76-1A89ABB70565">远程消费者</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>多消费者队列中的消息的消费者可以是本地的或远程的。本地消费者将生成器排入消息的相同队列中的消息出列。本地消费者在其代理描述中有一个名称但没有地址或协议。</p>
                     <p>远程使用者从与队列排队的队列不同的队列中出队。远程消费者分为三类：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>地址指的是同一数据库中的队列。</p>
                           <p>在这种情况下，使用者将消息从同一数据库中的不同队列中出列。这些地址的格式为<code class="codeph">[schema]</code> 。 <code class="codeph">queue_name</code> 。如果未指定架构，则使用当前用户的架构。
                           </p>
                        </li>
                        <li>
                           <p>地址指的是不同数据库中的队列。</p>
                           <p>在这种情况下，必须使用数据库链接访问数据库，并且协议必须为<code class="codeph">NULL</code>或0。这些地址的格式为<code class="codeph">[schema]</code> 。 <code class="codeph">queue_name@dblink</code> 。如果未指定架构，则使用当前用户的架构。如果数据库链接未指定域名，则指定<code class="codeph">DB_DOMAIN</code> <code class="codeph">init</code>指定的默认域。 <code class="codeph">ora</code>参数。
                           </p>
                        </li>
                        <li>
                           <p>地址指的是第三方协议可以到达的目的地。</p>
                           <p>您必须参考第三方软件的文档来确定如何指定地址和协议数据库链接以及计划传播。</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-329A6279-925C-435B-A6F1-76835EF20C40__GUID-7EDAACA7-A291-4069-9AD8-8C3313C64368">向远程用户传播</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>Oracle Database Advanced Queuing在计划运行时验证传播计划中指定的数据库链接，但在创建计划时不验证。因此，可以在创建其关联的数据库链接之前创建队列到dblink或队列到队列的传播。此外，如果删除数据库链接，则不会禁用传播计划。</p>
                     <p>Oracle Database AQ提供两种传播方式：</p>
                     <p>A） <span class="bold">队列到数据链路传播</span> - 通过提供（源）队列和（目标）数据库<span class="bold">链路来</span>指定。来自dblink指定的目标上的任何队列的源队列的消息将由此传播处理。
                     </p>
                     <p>在这种情况下，我们不能从源队列进行多次传播，dblinks连接到同一个数据库。因此，如果两个dblink连接到同一个数据库，则（q1，dblink1）和（q1，dblink2）不能共存。但是（q1，dblink1）和（q2，dblink1）OR（q1，dblink1）和（q2，dblink2）可以共存，因为源队列不同。</p>
                     <p>B） <span class="bold">队列到队列传播</span> - 通过提供（源）队列，（目的地）dblink和（目的地）队列来指定。来自目标dblink的指示队列的源队列的消息将由此传播处理。这里，（q1，dblink1，dq1），（q1，dblink1，dq2）OR（q1，dblink1，dq1），（q1，dblink2，dq2）成功。此策略有效，因为即使源队列相同且dblink连接到同一数据库，目标队列也不同。
                     </p>
                     <p>在这种情况下，即使使用不同的dblink，我们也不能在源队列，目标队列之间进行多次传播：（q1，dblink1，q2）和（q1，dblink2，q2）不能共存，如果dblink1和dblink2指向相同的数据库。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-329A6279-925C-435B-A6F1-76835EF20C40__GUID-3A0D37F1-7397-4BE3-B66C-4A29DD4CE175">传播中消息的优先级和排序</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>延迟，到期和优先级参数在队列到dblink和队列到队列传播中同样适用于本地和远程使用者。Oracle Database Advanced Queuing通过相应地调整延迟和到期参数来解决传播的任何延迟。例如，如果到期时间设置为一小时，并且消息在15分钟后传播，则远程队列中的到期时间设置为45分钟。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-329A6279-925C-435B-A6F1-76835EF20C40__GUID-2813B90B-1FD8-4096-B2B0-5509F3A3D85A">收件箱和发件箱</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p><a href="aq-introduction.html#GUID-329A6279-925C-435B-A6F1-76835EF20C40__CHDHCDCH">图1-9</a>说明了使用Oracle Database Advanced Queuing进行通信的不同数据库上的应用程序。每个应用程序都有一个用于处理传入消息的收件箱和一个用于处理传出消息的发件箱。每当应用程序将消息排入队列时，无论消息目的地如何，它都会进入其发件箱。同样，无论消息来自何处，应用程序都会从其收件箱中将消息从队列中取消。
                     </p>
                     <div class="figure" id="GUID-329A6279-925C-435B-A6F1-76835EF20C40__CHDHCDCH">
                        <p class="titleinfigure">图1-9 Oracle数据库高级队列中的消息传播</p><img src="img/adque042.gif" width="400" alt="下面是图1-9的描述" title="下面是图1-9的描述" longdesc="img_text/adque042.html"><br><a href="img_text/adque042.html">“图1-9 Oracle数据库高级队列中的消息传播”的描述</a></div>
                     <!-- class="figure" -->
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-329A6279-925C-435B-A6F1-76835EF20C40__GUID-93E4E1BB-813B-438F-8120-C4E1EC2EF5CF">传播调度</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p><a id="d6697e3583" class="indexterm-anchor"></a><a id="d6697e3589" class="indexterm-anchor"></a>为一对源和目标数据库链接定义了队列到dblink的传播调度。为一对源和目标队列定义了队列到队列的传播调度。如果队列具有要传播到多个队列的消息，则必须为每个目标队列定义调度。通过队列到数据链路传播，特定远程数据库的所有调度具有相同的频率。通过队列到队列传播，可以独立于其他调度来调整每个调度的频率</p>
                     <p>计划表示消息可以从源队列传播的时间范围。此时间范围可能取决于多种因素，例如网络流量，源数据库的负载和目标数据库的负载。如果未指定持续时间，则时间范围是无限单个窗口。如果必须周期性地重复窗口，则指定有限持续时间以及定义连续窗口之间的周期性间隔的<code class="codeph">NEXT_TIME</code>函数。
                     </p>
                     <p>创建计划后，作业将自动提交到作业队列工具以处理传播。</p>
                     <p><a id="d6697e3604" class="indexterm-anchor"></a>可以在队列生命周期的任何时间更改或删除为队列定义的传播计划。您也可以暂时禁用计划而不是删除计划。无论计划是否有效，都可以进行所有管理呼叫。如果计划处于活动状态，则需要几秒钟才能处理呼叫。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-329A6279-925C-435B-A6F1-76835EF20C40__GUID-0C75E443-0AA6-4863-B8E2-AFA659407B06">使用LOB传播消息</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>可以使用Oracle Database Advanced Queuing使用两种方法传播大对象：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>来自<code class="codeph">RAW</code>队列的传播</p>
                           <p>在<code class="codeph">RAW</code>队列中，消息有效负载存储为BLOB。这允许用户在使用PL / SQL接口时存储多达32KB的数据，以及在使用OCI时由客户端连续分配的数据。 8.0.4之后的所有版本都支持此方法。
                           </p>
                        </li>
                        <li>
                           <p>来自具有LOB属性的对象队列的传播</p>
                           <p>用户可以填充<code class="codeph">LOB</code> ，并从阅读<code class="codeph">LOB</code>使用Oracle数据库<code class="codeph">LOB</code>处理例程。<code class="codeph">LOB</code>属性可以是<code class="codeph">BLOB</code>或<code class="codeph">CLOB</code> （不是NCLOB）。如果属性是<code class="codeph">CLOB</code> ，则Oracle数据库高级队列会自动在源队列和目标队列之间执行任何必要的字符集转换。8.1.3的所有版本都支持此方法。
                           </p>
                           <div class="infoboxnote" id="GUID-329A6279-925C-435B-A6F1-76835EF20C40__GUID-3A71A99E-90A0-4B2D-BF25-6143B4DD25D8">
                              <p class="notep1">注意：</p>
                              <p>包含LOB的有效负载要求用户在队列表上授予显式的“ <code class="codeph">Select</code> ，“ <code class="codeph">Insert</code>和“ <code class="codeph">Update</code>权限，以进行排队和出列。
                              </p>
                           </div>
                           <div class="infoboxnotealso" id="GUID-329A6279-925C-435B-A6F1-76835EF20C40__GUID-B10BBFC7-EEDA-411E-8B41-39E35BA6E97C">
                              <p class="notep1">也可以看看：</p>
                              <p><a href="../adlob/index.html" target="_blank"><span class="italic">Oracle Database SecureFiles和大对象开发人员指南</span></a></p>
                           </div>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-329A6279-925C-435B-A6F1-76835EF20C40__GUID-600FE086-5209-4D40-B23C-850FF60BD6D9">传播统计</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>收集有关传播的详细运行时信息，并将其存储在<code class="codeph">DBA_QUEUE_SCHEDULES</code>视图中，以用于每个传播计划。队列设计者和管理员可以使用此信息来修复问题或调整性能。同样，视图报告的错误可用于诊断和修复问题。该视图还描述了其他信息，例如处理传播的会话的会话ID以及处理传播的作业队列进程的进程名称。
                     </p>
                     <p>对于每个计划，维护详细的传播统计信息：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>计划中传播的消息总数</p>
                        </li>
                        <li>
                           <p>计划中传播的总字节数</p>
                        </li>
                        <li>
                           <p>窗口中传播的最大消息数</p>
                        </li>
                        <li>
                           <p>窗口中传播的最大字节数</p>
                        </li>
                        <li>
                           <p>窗口中传播的平均消息数</p>
                        </li>
                        <li>
                           <p>传播消息的平均大小</p>
                        </li>
                        <li>
                           <p>传播消息的平均时间</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-329A6279-925C-435B-A6F1-76835EF20C40__GUID-8F5E84CA-8880-4812-8D26-82F23494F34D">传播错误处理</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>传播具有处理故障和报告错误的内置支持。例如，如果指定的数据库链接无效，如果远程数据库不可用，或者未启用远程队列进行排队，则会报告相应的错误消息。传播使用线性退避方案来重试来自遇到故障的计划的传播。</p>
                     <p>如果时间表连续遇到故障，则第一次重试在30秒后发生，第二次在60秒后发生，第三次在120秒后发生，依此类推。如果重试时间超出当前窗口的到期时间，则在下一个窗口的开始时间尝试下一次重试。最多尝试16次重试，之后将自动禁用计划。</p>
                     <div class="infoboxnote" id="GUID-329A6279-925C-435B-A6F1-76835EF20C40__GUID-E088C1F5-92CC-4BA9-8A07-AF3C21DF9F62">
                        <p class="notep1">注意：</p>
                        <p>一旦重试尝试滑入下一个传播窗口，它将始终这样做;指数退避方案不再支配重试调度。如果在指定的日期功能<code class="codeph">next_time</code>的参数<code class="codeph">DBMS_AQADM.SCHEDULE_PROPAGATION</code>结果在窗口之间的短的时间间隔，然后不成功重试尝试的数目能很快达到16，禁用时间表。
                        </p>
                     </div>
                     <p>由于故障而自动禁用计划时，相关信息将写入警报日志。检查调度失败表明：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>遇到了多少次连续失败</p>
                        </li>
                        <li>
                           <p>指示失败原因的错误消息</p>
                        </li>
                        <li>
                           <p>遇到上次失败的时间</p>
                        </li>
                     </ul>
                     <p>通过检查此信息，队列管理员可以修复故障并启用计划。如果在重试期间传播成功，则将失败次数重置为0。</p>
                     <p>在某些表示队列到数据链路传播中的应用程序错误的情况下，Oracle数据库高级队列将消息标记为<code class="codeph">UNDELIVERABLE</code>并在<code class="codeph">alert.log</code>记录消息。此类错误的示例是当远程队列不存在或源队列与远程队列之间存在类型不匹配时。<code class="codeph">background_dump_dest</code>目录中的跟踪文件可以提供有关错误的其他信息。
                     </p>
                     <p><a id="d6697e3750" class="indexterm-anchor"></a>当新的作业队列进程启动时，它会清除不匹配的类型错误，以便可以重新验证类型。如果您已限制作业队列进程数并且传播仍然繁忙，那么您可能不希望等待作业队列进程终止并重新启动。可以使用<code class="codeph">DBMS_AQADM.VERIFY_QUEUE_TYPES</code>随时重新验证队列类型。</p>
                     <div class="infoboxnote" id="GUID-329A6279-925C-435B-A6F1-76835EF20C40__GUID-CC5B8025-7EDA-4847-AF58-C93642304CF7">
                        <p class="notep1">注意：</p>
                        <p>在队列到队列传播中检测到类型不匹配时，传播将停止并引发错误。在这种情况下，您必须查询<code class="codeph">DBA_SCHEDULES</code>视图以确定在传播到特定目标期间发生的最后一个错误。邮件未标记为<code class="codeph">UNDELIVERABLE</code> 。</p>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-329A6279-925C-435B-A6F1-76835EF20C40__GUID-00DD78E1-795F-43C5-B3EB-DDBD78B04ADC">与Oracle Real Application Clusters的传播</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>传播支持内置Oracle Real Application Clusters。它对用户和队列管理员是透明的。处理传播的作业将提交给与队列所在队列表的所有者相同的实例。</p>
                     <p>如果实例发生故障并且存储源队列的队列表迁移到其他实例，则传播作业也会迁移到新实例。这最小化了实例之间的ping，从而提供了更好的性能。</p>
                     <p><a id="d6697e3776" class="indexterm-anchor"></a><a id="d6697e3782" class="indexterm-anchor"></a>目标可以通过数据库链接或目标队列名称来标识。指定目标数据库会导致队列到数据链路的传播。如果将消息传播到另一个数据库中的多个队列，则对该数据库的所有队列到dblink的传播都具有相同的频率。指定目标队列名称会导致队列到队列的传播。如果将消息传播到另一个数据库中的多个队列，则队列到队列传播使您可以独立于其他队列调整每个调度的频率。您甚至可以启用或禁用单个传播。
                     </p>
                     <p>传播到目标Oracle RAC系统时，这种新的队列到队列传播模式还支持透明故障转移。通过队列到队列传播，如果队列的所有者实例在Oracle RAC上失败，则不再需要重新指向数据库链接。</p>
                     <div class="infoboxnotealso" id="GUID-329A6279-925C-435B-A6F1-76835EF20C40__GUID-88B65EF4-2E9C-4683-AD9A-329C6642A8B2">
                        <p class="notep1">也可以看看：</p>
                        <p>有关队列到队列传播的更多信息，请<span class="q">“ <a href="aq-administrative-interface.html#GUID-3B8E1DFE-0A6A-4CF2-8069-8DAECB5359A2" title="DBMS_AQADM.SCHEDULE_PROPAGATION计划消息的传播。">调度队列传播</a> ”</span></p>
                     </div>
                     <p>传播已设计为处理任意数量的并发计划。作业队列进程的数量限制为最多1000个，其中一些可用于处理与传播无关的作业。因此，传播具有对多任务和负载平衡的内置支持。</p>
                     <p>设计传播算法使得单个作业队列过程可以处理多个调度。作业队列进程上的传播负载可能会根据不同源队列中消息的到达率而发生偏差。</p>
                     <p>如果一个进程因多个活动计划负担过重而另一个进程负载较少，则会有很多被动计划，则传播会自动重新分配计划，以便统一加载它们。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-329A6279-925C-435B-A6F1-76835EF20C40__GUID-574E1439-F5EE-49A6-BE7F-88813147F834">第三方支持</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>如果收件人的协议号在128  -  255范围内，则Oracle Database Advanced Queuing不会解释收件人的地址，并且Oracle Database Advanced Queuing系统不会传播该消息。相反，第三方传播者可以通过在出列操作中指定保留的使用者名称来使消息出列。保留的使用者名称的格式为<code class="codeph">AQ$_P</code> <span class="italic"><code class="codeph">protocol_number</code></span> 。例如，消费者名称<code class="codeph">AQ$_P128</code>可用于使协议号为128的接收者的消息出列。具有特定协议号的消息的收件人列表将在dequeue上的<code class="codeph">recipient_list</code>消息属性中返回。
                     </p>
                     <p>Oracle Database Advanced Queuing与第三方邮件系统之间传播邮件的另一种方法是通过Messaging Gateway。Messaging Gateway将来自Oracle数据库高级队列队列的消息从队列中取消，并保证向支持的第三方消息传递系统的传递。Messaging Gateway还可以将来自这些系统的消息出列，并将它们排入Oracle Database Advanced Queuing队列。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-329A6279-925C-435B-A6F1-76835EF20C40__GUID-91C7E07E-DF8F-4E9D-93C0-D65B29B65700">使用HTTP进行传播</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>在Oracle Database <span class="italic">10g中，</span>您可以通过HTTP和HTTPS（HTTP over SSL）设置Oracle数据库高级队列传播。HTTP传播使用Internet访问基础结构，并要求部署连接到目标数据库的Oracle数据库高级队列servlet。必须使用指示Web服务器地址和端口的连接字符串创建数据库链接，并指示HTTP作为协议。必须创建源数据库才能运行Java和XML。否则，HTTP传播的设置与Oracle Net Services传播大致相同。
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="ADQUE2494"></a><a id="ADQUE2495"></a><a id="ADQUE2493"></a><div class="props_rev_3"><a id="GUID-8BBB3111-EFC4-44CE-8A73-76EC5D479EF9" name="GUID-8BBB3111-EFC4-44CE-8A73-76EC5D479EF9"></a><h3 id="ADQUE-GUID-8BBB3111-EFC4-44CE-8A73-76EC5D479EF9" class="sect3"><span class="enumeration_section">1.9</span>消息格式转换</h3>
               <div>
                  <p>应用程序通常使用不同格式的数据。转换定义了从一种Oracle数据类型到另一种Oracle数据类型的映射。</p>
                  <p><a href="glossary.html#GUID-A668A987-B1D3-4330-97FD-0589DB780225"><span class="xrefglossterm">转换</span></a>由SQL函数表示，该函数将源数据类型作为输入并返回目标数据类型的对象。仅支持一对一的消息转换。
                  </p>
                  <p>要在队列期间转换消息，请在enqueue选项中指定映射。要在出列期间转换消息，请在出队选项或添加订户时指定映射。出列映射会覆盖订户映射。要在传播期间转换消息，请在添加订户时指定映射。</p>
                  <p>您可以通过创建单个PL / SQL函数或为每个目标类型属性创建表达式来创建转换。PL / SQL函数返回目标类型的对象或目标类型的构造函数。这种表示对于简单的变换或者不容易分解为每个属性的独立变换的表示是优选的。</p>
                  <p>为目标类型的每个属性创建单独的表达式可简化目标类型的各个属性的转换映射创建和管理。当目标类型具有许多属性时，它很有用。</p>
                  <p><a href="aq-introduction.html#GUID-8BBB3111-EFC4-44CE-8A73-76EC5D479EF9__i1008572">如图1-10</a>所示，排队，路由和转换是集成应用程序架构的基本构建块。该图显示了如何在集成中心中路由和转换CRM应用程序的Out队列中的数据，然后将其传播到Web应用程序的In队列中。转换引擎将消息从Out队列的格式映射到In队列的格式。
                  </p>
                  <div class="figure" id="GUID-8BBB3111-EFC4-44CE-8A73-76EC5D479EF9__i1008572">
                     <p class="titleinfigure">图1-10应用程序集成中的转换</p><img src="img/adque448.gif" width="600" alt="下面是图1-10的描述" title="下面是图1-10的描述" longdesc="img_text/adque448.html"><br><a href="img_text/adque448.html">“图1-10应用程序集成中的转换”的描述</a></div>
                  <!-- class="figure" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-8BBB3111-EFC4-44CE-8A73-76EC5D479EF9__GUID-E88328B3-1CB9-482C-AE3D-270FB79FCF1A">XML数据转换</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>您可以使用<code class="codeph">XMLType</code>支持的<code class="codeph">extract()</code>方法转换XML数据，以在应用提供的<code class="codeph">XPath</code>表达式后返回<code class="codeph">XMLType</code>对象。您还可以使用程序包<code class="codeph">XSLPROCESSOR</code>创建一个PL / SQL函数，该函数通过对其应用XSLT转换来转换<code class="codeph">XMLType</code>对象。</p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="ADQUE2497"></a><a id="ADQUE2498"></a><a id="ADQUE2499"></a><a id="ADQUE2500"></a><a id="ADQUE2501"></a><a id="ADQUE2502"></a><a id="ADQUE2503"></a><a id="ADQUE2504"></a><a id="ADQUE2505"></a><a id="ADQUE2496"></a><div class="props_rev_3"><a id="GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F" name="GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F"></a><h3 id="ADQUE-GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F" class="sect3"><span class="enumeration_section">1.10</span>其他Oracle数据库高级排队功能</h3>
               <div>
                  <p>本主题介绍AQ功能队列监视器协调器，与Oracle Internet Directory的集成，与Oracle Enterprise Manager的集成，保留和消息历史记录，清理消息队列，跟踪和事件日志，不可否认性以及Internet集成。</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="aq-introduction.html#GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__CHDHCDAH">队列监视协调员</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__CHDCAFEJ">与Oracle Internet Directory集成</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__CHDIHIHF">与Oracle Enterprise Manager集成</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__CHDJHHHI">保留和消息历史记录</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__CHDHCGIB">清理消息队列</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__CHDIGIDI">跟踪和事件期刊</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__CHDBGIGB">不可否认</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__CHDDEDHD">互联网整合</a></p>
                     </li>
                  </ul>
                  <div class="section" id="GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__CHDHCDAH">
                     <p class="subhead2" id="GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__GUID-609E4ED4-CF2A-43EC-967B-0EC30522A330">队列监视协调员</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>在<span class="italic">10g</span>第1版（10.1）之前，Oracle数据库高级队列时间管理器进程称为队列监视器（ <code class="codeph">QMNn</code> ），后台进程通过设置动态<code class="codeph">init.ora</code>参数<code class="codeph">AQ_TM_PROCESSES</code> 。从<span class="italic">10g</span>第1版（10.1）开始，时间管理和许多其他后台进程由称为队列监视协调器（ <code class="codeph">QMNC</code> ）的协调器 - 从属体系结构<code class="codeph">QMNC</code> 。<code class="codeph">QMNC</code> <code class="codeph">qXXX depending</code>系统负载动态生成名为<code class="codeph">qXXX depending</code>从站。奴隶提供以下机制：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>消息延迟</p>
                        </li>
                        <li>
                           <p>消息到期</p>
                        </li>
                        <li>
                           <p>重试延迟</p>
                        </li>
                        <li>
                           <p>队列表的垃圾收集</p>
                        </li>
                        <li>
                           <p>缓冲消息的内存管理任务</p>
                        </li>
                     </ul>
                     <p>由于进程数自动确定并经常调整，因此您<code class="codeph">AQ_TM_PROCESSES</code>使用<code class="codeph">AQ_TM_PROCESSES</code>进行设置的麻烦。</p>
                     <p>虽然不再需要设置<code class="codeph">init.ora</code>参数<code class="codeph">AQ_TM_PROCESSES</code> ，但仍然支持它。如果您确实设置了它（最多40个），那么QMNC仍会自动调整进程数。但是至少可以保证持久队列的设置进程数。但是， <a href="glossary.html#GUID-4FE49D89-66C7-46AB-8628-23A241EB1DA4"><span class="xrefglossterm">缓冲队列的</span></a>进程不受此参数的影响。
                     </p>
                     <div class="infoboxnote" id="GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__GUID-39F372A1-0460-40B7-8EBE-7FBF2D29A55A">
                        <p class="notep1">注意：</p>
                        <p>如果要禁用队列监视器协调器，则必须在<code class="codeph">pfile</code>或<code class="codeph">spfile</code>设置<code class="codeph">AQ_TM_PROCESSES = 0</code> 。Oracle强烈建议您不要设置<code class="codeph">AQ_TM_PROCESSES = 0</code> 。
                        </p>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__CHDCAFEJ">
                     <p class="subhead2" id="GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__GUID-616E3BC6-B48B-4F92-8A4C-379B1138A88C">与Oracle Internet Directory集成</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>Oracle Internet Directory是基于Oracle数据库构建的本机LDAPv3目录服务，可集中处理各种信息，包括电子邮件地址，电话号码，密码，安全证书以及许多类型的联网设备的配置数据。您可以从一个位置（Oracle Internet Directory）查找企业范围的排队信息队列，订阅和事件。有关更多信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adque&amp;id=OIDAG002" target="_blank"><span class="italic">Oracle Internet Middle Directory</span></a>的<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adque&amp;id=OIDAG002" target="_blank"><span class="italic">Oracle融合中间件管理员指南</span></a> 。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__CHDIHIHF">
                     <p class="subhead2" id="GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__GUID-3C97A709-6DD3-4E99-B45C-D4DF5C36B745">与Oracle Enterprise Manager集成</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>您可以使用Oracle Enterprise Manager来：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>创建和管理队列，队列表，传播计划和转换</p>
                        </li>
                        <li>
                           <p>使用数据库和队列级别的拓扑以及查看队列错误以及队列和会话统计信息来监控Oracle数据库高级排队环境</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__CHDJHHHI">
                     <p class="subhead2" id="GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__GUID-DD8103BE-69AC-4110-BA33-5CDD3E26BA78">保留和消息历史记录</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>系统管理员指定保留持续时间以在消费后保留消息。Oracle数据库高级队列存储有关每条消息的历史记录的信息，保留发往本地或远程接收方的消息的延迟，到期和保留的队列和消息属性。该信息包含入队时间和出队时间以及执行每个请求的事务的标识。这允许用户保留相关消息的历史记录。历史记录可用于跟踪，数据仓库，数据挖掘操作以及特定的审计功能。</p>
                     <p>缓冲消息传递不支持消息保留。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__CHDHCGIB">
                     <p class="subhead2" id="GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__GUID-42D65A2C-A72F-4696-995D-D310C2E71D71">清理消息队列</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>Oracle数据库高级队列保留功能可用于在消费后用户指定的持续时间后自动清除消息。</p>
                     <p>如果消息意外插入到错误订户的队列中，您可以使用订户名称或消息标识符将它们出列。这会消耗在保留时间到期后清除的消息。</p>
                     <p>要清除特定订户的消息，您可以删除订户并再次添加订户。删除订户会删除该订户的所有消息。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__CHDIGIDI">
                     <p class="subhead2" id="GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__GUID-6C3AB684-A797-4E60-87EC-BA23420D7024">跟踪和事件期刊</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>保留的消息可以彼此相关以形成序列。这些序列代表事件日志，它们通常由应用程序构建。Oracle Database Advanced Queuing旨在让应用程序自动创建事件日志。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__CHDBGIGB">
                     <p class="subhead2" id="GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__GUID-3FCB4D52-6057-4FCE-8505-6AD90CEA959D">不可否认</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>Oracle Database Advanced Queuing维护有关消息的完整信息历史记录以及消息本身。该信息用作发送和接收消息的证据，并且可以用于发送者的不可否认性和接收者的不可否认性。</p>
                     <p>以下信息保留在队列中，用于不可否认的enqueuer：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>Oracle数据库高级队列代理执行入队</p>
                        </li>
                        <li>
                           <p>数据库用户进行排队</p>
                        </li>
                        <li>
                           <p>入队时间</p>
                        </li>
                        <li>
                           <p>进行入队的交易的交易ID</p>
                        </li>
                     </ul>
                     <p>以下信息保留在dequeue，以便不可否认dequeuer：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>Oracle数据库高级队列代理执行出列</p>
                        </li>
                        <li>
                           <p>数据库用户出列队列</p>
                        </li>
                        <li>
                           <p>出队时间</p>
                        </li>
                        <li>
                           <p>出列交易的交易的交易ID</p>
                        </li>
                     </ul>
                     <p>传播之后，传播的目标队列中的<code class="codeph">ORIGINAL_MSGID</code>字段对应于源消息的消息ID。该字段可用于关联传播的消息。这对于传播消息的dequeuer的不可否认性是有用的。
                     </p>
                     <p>通过在使用该消息入队时将发送者的数字签名加入队列并且在出队时存储出队者的数字签名，可以实现更强的不可否认性。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__CHDDEDHD">
                     <p class="subhead2" id="GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__GUID-790D5F6A-69A5-4420-9911-BB870DD3E810">互联网整合</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>您可以使用<a href="glossary.html#GUID-E7071131-B116-41B7-B9D8-F54E36AE982F"><span class="xrefglossterm">简单对象访问协议</span></a> （SOAP）通过Internet访问Oracle数据库高级队列。<a href="glossary.html#GUID-DDF7D235-94BE-4294-A4DC-811C06EF06F3"><span class="xrefglossterm">Internet数据访问演示</span></a> （IDAP）是Oracle数据库高级队列操作的SOAP规范。IDAP定义SOAP请求主体的XML消息结构。</p>
                     <p>IDAP消息以XML格式封装Oracle数据库高级队列请求和响应。 IDAP用于执行Oracle数据库高级排队操作，例如入队，出队，发送通知，注册通知以及通过Internet标准传输-HTTP和电子邮件进行传播。此外，IDAP还封装了请求的事务，安全性，转换和字符集ID。</p>
                     <p>您可以在Oracle Internet Directory中为Oracle Database Advanced Queuing代理创建别名，然后使用通过Internet发送的IDAP文档中的别名来执行Oracle Database Advanced Queuing操作。使用别名可防止公开Oracle Database Advanced Queuing代理的内部名称。</p>
                     <p><a href="aq-introduction.html#GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__I1009521">图1-11</a>显示了通过HTTP执行Oracle Database Advanced Queuing操作的体系结构。主要组成部分是：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>Oracle数据库高级队列客户端程序</p>
                        </li>
                        <li>
                           <p>托管Oracle Database Advanced Queuing <a href="glossary.html#GUID-06CAA1CB-595D-492E-9543-7F003B45839A"><span class="xrefglossterm">servlet的</span></a> Web服务器/ servlet <a href="glossary.html#GUID-06CAA1CB-595D-492E-9543-7F003B45839A"><span class="xrefglossterm">运行器</span></a></p>
                        </li>
                        <li>
                           <p>Oracle数据库服务器</p>
                        </li>
                     </ul>
                     <p>Oracle数据库高级队列客户机程序将XML消息（符合IDAP）发送到Oracle数据库高级队列servlet，后者了解XML消息并执行Oracle数据库高级队列操作。可以使用任何HTTP客户端，例如Web浏览器。托管Oracle数据库高级队列servlet的Web服务器/ servlet运行器，例如Apache / Jserv或Tomcat，解释传入的XML消息。Oracle数据库高级队列servlet连接到Oracle数据库服务器并对用户队列执行操作。</p>
                     <div class="infoboxnote" id="GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__GUID-077DB237-918F-4E19-9C2F-0A4F27CAD4EB">
                        <p class="notep1">注意：</p>
                        <p>此功能经过认证可与Apache一起使用，以及Tomcat或Jserv servlet执行引擎。但是，代码不会阻止servlet与支持Java Servlet 2.0或更高版本接口的其他Web服务器和servlet执行引擎一起工作。</p>
                     </div>
                     <div class="figure" id="GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__I1009521">
                        <p class="titleinfigure">图1-11使用HTTP执行Oracle数据库高级排队操作的体系结构</p><img src="img/adque430.gif" width="464" alt="下面是图1-11的描述" title="下面是图1-11的描述" longdesc="img_text/adque430.html"><br><a href="img_text/adque430.html">“图1-11使用HTTP执行Oracle数据库高级排队操作的体系结构”的说明</a></div>
                     <!-- class="figure" -->
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="ADQUE2506"></a><div class="props_rev_3"><a id="GUID-AA3B4276-F202-45BD-9177-B68FF6B0F327" name="GUID-AA3B4276-F202-45BD-9177-B68FF6B0F327"></a><h3 id="ADQUE-GUID-AA3B4276-F202-45BD-9177-B68FF6B0F327" class="sect3"><span class="enumeration_section">1.11</span> Oracle Database Advanced Queuing的接口</h3>
               <div>
                  <p>您可以通过本主题中列出的接口访问Oracle数据库高级队列功能。</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>使用<code class="codeph">DBMS_AQ</code> ， <code class="codeph">DBMS_AQADM</code>和<code class="codeph">DBMS_AQELM</code> PL / SQL 
                        </p>
                     </li>
                     <li>
                        <p>使用<code class="codeph">oracle.jms</code> Java包的Java消息服务（JMS）</p>
                     </li>
                     <li>
                        <p>使用HTTP（S）访问Internet</p>
                        <div class="infoboxnote" id="GUID-AA3B4276-F202-45BD-9177-B68FF6B0F327__GUID-C6BC4EEE-0595-4D06-B66F-CC6B2C8BA846">
                           <p class="notep1">注意：</p>
                           <p><code class="codeph">oracle.Oracle数据库高级队列<span class="italic">10g</span>第1版（10.1）中不推荐使用AQ</code> Java包。Oracle建议您将现有Java AQ应用程序迁移到Oracle JMS，并使用Oracle JMS设计未来的Java AQ应用程序。
                           </p>
                        </div>
                        <div class="infoboxnotealso" id="GUID-AA3B4276-F202-45BD-9177-B68FF6B0F327__GUID-76F99657-0AD5-4EBE-ADB3-93C9AA4356E1">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><a href="../arpls/index.html" target="_blank"><span class="italic">Oracle数据库PL / SQL包和类型参考</span></a></p>
                              </li>
                           </ul>
                        </div>
                     </li>
                  </ul>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>