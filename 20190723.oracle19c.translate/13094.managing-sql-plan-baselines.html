<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="This chapter explains the concepts and tasks relating to SQL plan management using the DBMS_SPM package.">
      <meta name="description" content="This chapter explains the concepts and tasks relating to SQL plan management using the DBMS_SPM package.">
      <title>Managing SQL Plan Baselines</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="SQL Tuning Guide">
      <meta property="og:description" content="This chapter explains the concepts and tasks relating to SQL plan management using the DBMS_SPM package.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="SQL Tuning Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="sql-tuning-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-01-31T14:57:08-08:00">
      <meta name="dcterms.title" content="SQL Tuning Guide">
      <meta name="dcterms.dateCopyrighted" content="2013, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96095-03">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="overview-of-sql-plan-management.html" title="Previous" type="text/html">
      <link rel="next" href="migrating-stored-outlines.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="TGSQL">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="overview-of-sql-plan-management.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="migrating-stored-outlines.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">SQL Tuning Guide</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="sql-controls.html" property="item" typeof="WebPage"><span property="name">SQL Management Objects</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Managing SQL Plan Baselines</li>
            </ol>
            <a id="GUID-7024369A-F98D-48E4-921C-C899485C954F" name="GUID-7024369A-F98D-48E4-921C-C899485C954F"></a>
            
            <h2 id="TGSQL-GUID-7024369A-F98D-48E4-921C-C899485C954F" class="sect2"><span class="enumeration_chapter">28 </span>Managing SQL Plan Baselines
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>This chapter explains the concepts and tasks relating to SQL plan management using the <code class="codeph">DBMS_SPM</code> package.
               </p>
               <p>This chapter contains the following topics:</p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="managing-sql-plan-baselines.html#GUID-3D822F44-06C5-452F-8967-EBC12BA38036">About Managing SQL Plan Baselines</a><br>This topic describes the available interfaces and basic tasks for SQL plan management.
                  </li>
                  <li class="ulchildlink"><a href="managing-sql-plan-baselines.html#GUID-3D701147-1371-4604-8127-F9199EA0EDE0">Configuring SQL Plan Management</a><br>You can configure the capture and use of SQL plan baselines, and the SPM Evolve Advisor task.
                  </li>
                  <li class="ulchildlink"><a href="managing-sql-plan-baselines.html#GUID-582BC3FB-2F52-4190-B807-16B79346B776">Displaying Plans in a SQL Plan Baseline</a><br>To view the plans stored in the SQL plan baseline for a specific statement, use the <code class="codeph">DBMS_XPLAN.DISPLAY_SQL_PLAN_BASELINE</code> function. This function uses plan information stored in the plan history to display the plans. 
                  </li>
                  <li class="ulchildlink"><a href="managing-sql-plan-baselines.html#GUID-C6AC4856-3C8C-42D8-A7FD-629974E98D36">Loading SQL Plan Baselines</a><br>Using <code class="codeph">DBMS_SPM</code>, you can initiate the bulk load of a set of existing plans into a SQL plan baseline. 
                  </li>
                  <li class="ulchildlink"><a href="managing-sql-plan-baselines.html#GUID-19E6FFB0-BC7A-4CDB-AE36-6D67C15C7332">Evolving SQL Plan Baselines Manually</a><br>You can use PL/SQL or Cloud Control to manually evolve an unaccepted plan to determine whether it performs better than any plan currently in the plan baseline.
                  </li>
                  <li class="ulchildlink"><a href="managing-sql-plan-baselines.html#GUID-BA19EA4E-AFEF-4677-B08F-854DE59ED932">Dropping SQL Plan Baselines</a><br>You can remove some or all plans from a SQL plan baseline. This technique is sometimes useful when testing SQL plan management.
                  </li>
                  <li class="ulchildlink"><a href="managing-sql-plan-baselines.html#GUID-DE976D2B-DBAD-498F-B933-D16B06CA9D2A">Managing the SQL Management Base</a><br>The SQL management base is a part of the data dictionary that resides in the <code class="codeph">SYSAUX</code> tablespace. It stores statement logs, plan histories, SQL plan baselines, and SQL profiles.
                  </li>
               </ul>
               <div class="infoboxnotealso" id="GUID-7024369A-F98D-48E4-921C-C899485C954F__GUID-404127B5-FBB7-4ECB-BD68-00A13F85A8FD">
                  <p class="notep1">See Also:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><span class="q">"<a href="migrating-stored-outlines.html#GUID-E1CBB4DA-2F83-4F4D-845B-CAAA8333DF1A" title="Stored outline migration is the user-initiated process of converting stored outlines to SQL plan baselines. A SQL plan baseline is a set of plans proven to provide optimal performance.">Migrating Stored Outlines to SQL Plan Baselines</a>"</span></p>
                     </li>
                     <li>
                        <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tgsql&amp;id=ARPLS-GUID-D6EC284C-053D-417D-B887-94422BCB4E3A" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> to learn more about <code class="codeph">DBMS_SPM</code></p>
                     </li>
                  </ul>
               </div>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>Parent topic:</strong> <a href="sql-controls.html#GUID-2889EBC8-1FAD-412F-9779-865028473607" title="A SQL management object is a feature that stabilizes the execution plans of individual SQL statements. SQL profiles and SQL plan baselines are SQL management objects.">SQL Management Objects</a></p>
                  </div>
               </div>
            </div>
            <a id="TGSQL94621"></a><div class="sect2"><a id="GUID-3D822F44-06C5-452F-8967-EBC12BA38036" name="GUID-3D822F44-06C5-452F-8967-EBC12BA38036"></a><h3 id="TGSQL-GUID-3D822F44-06C5-452F-8967-EBC12BA38036" class="sect3"><span class="enumeration_section">28.1 </span>About Managing SQL Plan Baselines
               </h3>
               <div>
                  <p>This topic describes the available interfaces and basic tasks for SQL plan management.</p>
                  <p>This section contains the following topics:</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="managing-sql-plan-baselines.html#GUID-00CFEAE0-32D8-43FC-AF4F-A3CB3062E374">User Interfaces for SQL Plan Management</a><br>You can access the <code class="codeph">DBMS_SPM</code> package through Cloud Control or through the command line.
                     </li>
                     <li class="ulchildlink"><a href="managing-sql-plan-baselines.html#GUID-C79E7420-053B-4DCE-A219-072BDE488E21">Basic Tasks in SQL Plan Management</a><br>This topic explains the basic tasks in using SQL plan management to prevent performance regressions and enable the optimizer to consider new execution plans.
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="managing-sql-plan-baselines.html#GUID-7024369A-F98D-48E4-921C-C899485C954F" title="This chapter explains the concepts and tasks relating to SQL plan management using the DBMS_SPM package.">Managing SQL Plan Baselines</a></p>
                     </div>
                  </div>
               </div>
               <a id="TGSQL618"></a><div class="props_rev_3"><a id="GUID-00CFEAE0-32D8-43FC-AF4F-A3CB3062E374" name="GUID-00CFEAE0-32D8-43FC-AF4F-A3CB3062E374"></a><h4 id="TGSQL-GUID-00CFEAE0-32D8-43FC-AF4F-A3CB3062E374" class="sect4"><span class="enumeration_section">28.1.1 </span>User Interfaces for SQL Plan Management
                  </h4>
                  <div>
                     <p>You can access the <code class="codeph">DBMS_SPM</code> package through Cloud Control or through the command line.
                     </p>
                     <p>This section contains the following topics:</p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="managing-sql-plan-baselines.html#GUID-9BB06D27-4A3F-4DBA-A7EB-85B5C4EA0631">Accessing the SQL Plan Baseline Page in Cloud Control</a><br>The SQL Plan Control page in Cloud Control is a GUI that shows information about SQL profiles, SQL patches, and SQL plan baselines.
                        </li>
                        <li class="ulchildlink"><a href="managing-sql-plan-baselines.html#GUID-AE8CB28A-79CB-4B5F-BAE7-FF54E2EF6330">DBMS_SPM Package</a><br>On the command line, use the <code class="codeph">DBMS_SPM</code> and <code class="codeph">DBMS_XPLAN</code> PL/SQL packages to perform most SQL plan management tasks. 
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-sql-plan-baselines.html#GUID-3D822F44-06C5-452F-8967-EBC12BA38036" title="This topic describes the available interfaces and basic tasks for SQL plan management.">About Managing SQL Plan Baselines</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="TGSQL94646"></a><a id="TGSQL94614"></a><div class="props_rev_3"><a id="GUID-9BB06D27-4A3F-4DBA-A7EB-85B5C4EA0631" name="GUID-9BB06D27-4A3F-4DBA-A7EB-85B5C4EA0631"></a><h5 id="TGSQL-GUID-9BB06D27-4A3F-4DBA-A7EB-85B5C4EA0631" class="sect5"><span class="enumeration_section">28.1.1.1 </span>Accessing the SQL Plan Baseline Page in Cloud Control
                     </h5>
                     <div>
                        <p>The SQL Plan Control page in Cloud Control is a GUI that shows information about SQL profiles, SQL patches, and SQL plan baselines.</p>
                        <div class="section">
                           <p class="subhead3" id="GUID-9BB06D27-4A3F-4DBA-A7EB-85B5C4EA0631__GUID-42BC32A5-2D03-484A-914D-FF5C637C3787">To access the SQL Plan Baseline page:</p>
                           <ol>
                              <li>
                                 <p>Log in to Cloud Control with the appropriate credentials.</p>
                              </li>
                              <li>
                                 <p>Under the <span class="bold">Targets</span> menu, select <span class="bold">Databases</span>.
                                 </p>
                              </li>
                              <li>
                                 <p>In the list of database targets, select the target for the Oracle Database instance that you want to administer.</p>
                              </li>
                              <li>
                                 <p>If prompted for database credentials, then enter the minimum credentials necessary for the tasks you intend to perform.</p>
                              </li>
                              <li>
                                 <p>From the <span class="bold">Performance</span> menu, select <span class="bold">SQL</span>, then <span class="bold">SQL Plan Control</span>.
                                 </p>
                                 <p>The SQL Plan Control page appears.</p>
                              </li>
                              <li>
                                 <p>Click <span class="bold">Files</span> to view the SQL Plan Baseline subpage, shown in <a href="managing-sql-plan-baselines.html#GUID-9BB06D27-4A3F-4DBA-A7EB-85B5C4EA0631__CDEBHHEI">Figure 28-1</a>.
                                 </p>
                                 <div class="figure" id="GUID-9BB06D27-4A3F-4DBA-A7EB-85B5C4EA0631__CDEBHHEI">
                                    <p class="titleinfigure">Figure 28-1 SQL Plan Baseline Subpage</p><img src="img/sql_plan_control.gif" alt="Description of Figure 28-1 follows" title="Description of Figure 28-1 follows" longdesc="img_text/sql_plan_control.html"><br><a href="img_text/sql_plan_control.html">Description of "Figure 28-1 SQL Plan Baseline Subpage"</a></div>
                                 <!-- class="figure" -->
                                 <p>You can perform most SQL plan management tasks in this page or in pages accessed through this page.</p>
                              </li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                        <div class="section"></div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="infoboxnotealso" id="GUID-9BB06D27-4A3F-4DBA-A7EB-85B5C4EA0631__GUID-D48C76F1-6B5A-4E1F-959A-7E462E930035">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>Cloud Control context-sensitive online help to learn about the options on the SQL Plan Baseline subpage</p>
                              </li>
                              <li>
                                 <p><span class="q">"<a href="managing-sql-plan-baselines.html#GUID-A94CFA49-910A-4237-A7BB-39BFA94E227E" title="SPM Evolve Advisor is a SQL advisor that evolves plans that have recently been added to the SQL plan baseline. The advisor simplifies plan evolution by eliminating the requirement to do it manually.">Managing the SPM Evolve Advisor Task</a>"</span></p>
                              </li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="managing-sql-plan-baselines.html#GUID-00CFEAE0-32D8-43FC-AF4F-A3CB3062E374" title="You can access the DBMS_SPM package through Cloud Control or through the command line.">User Interfaces for SQL Plan Management</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="TGSQL620"></a><a id="TGSQL94615"></a><div class="props_rev_3"><a id="GUID-AE8CB28A-79CB-4B5F-BAE7-FF54E2EF6330" name="GUID-AE8CB28A-79CB-4B5F-BAE7-FF54E2EF6330"></a><h5 id="TGSQL-GUID-AE8CB28A-79CB-4B5F-BAE7-FF54E2EF6330" class="sect5"><span class="enumeration_section">28.1.1.2 </span>DBMS_SPM Package
                     </h5>
                     <div>
                        <p>On the command line, use the <code class="codeph">DBMS_SPM</code> and <code class="codeph">DBMS_XPLAN</code> PL/SQL packages to perform most SQL plan management tasks. 
                        </p>
                        <div class="section">
                           <p>The following table describes the most relevant <code class="codeph">DBMS_SPM</code> procedures and functions for creating, dropping, and loading SQL plan baselines.
                           </p>
                           <div class="tblformal" id="GUID-AE8CB28A-79CB-4B5F-BAE7-FF54E2EF6330__CDEFGAIE">
                              <p class="titleintable">Table 28-1 DBMS_SPM Procedures and Functions</p>
                              <table cellpadding="4" cellspacing="0" class="Formal" title="DBMS_SPM Procedures and Functions" summary="This 3 column table describes DBMS_SPM procedures and functions. Column 1 is the package. Column 2 is the procedure or function. Column 3 describes the procure or function. " width="100%" frame="hsides" border="1" rules="rows">
                                 <thead>
                                    <tr align="left" valign="top">
                                       <th align="left" valign="bottom" id="d140998e809">Package</th>
                                       <th align="left" valign="bottom" id="d140998e812">Procedure or Function</th>
                                       <th align="left" valign="bottom" id="d140998e815">Description</th>
                                    </tr>
                                 </thead>
                                 <tbody>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d140998e820" headers="d140998e809 ">
                                          <p><code class="codeph">DBMS_SPM</code></p>
                                       </td>
                                       <td align="left" valign="top" headers="d140998e820 d140998e812 ">
                                          <p><code class="codeph">CONFIGURE</code></p>
                                       </td>
                                       <td align="left" valign="top" headers="d140998e820 d140998e815 ">
                                          <p>This procedure changes configuration options for the SMB in name/value format.</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d140998e832" headers="d140998e809 ">
                                          <p><code class="codeph">DBMS_SPM</code></p>
                                       </td>
                                       <td align="left" valign="top" headers="d140998e832 d140998e812 ">
                                          <p><code class="codeph">CREATE_STGTAB_BASELINE</code></p>
                                       </td>
                                       <td align="left" valign="top" headers="d140998e832 d140998e815 ">
                                          <p>This procedure creates a staging table that enables you to transport SQL plan baselines from one database to another.</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d140998e844" headers="d140998e809 ">
                                          <p><code class="codeph">DBMS_SPM</code></p>
                                       </td>
                                       <td align="left" valign="top" headers="d140998e844 d140998e812 ">
                                          <p><code class="codeph">DROP_SQL_PLAN_BASELINE</code></p>
                                       </td>
                                       <td align="left" valign="top" headers="d140998e844 d140998e815 ">
                                          <p>This function drops some or all plans in a plan baseline.</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d140998e856" headers="d140998e809 ">
                                          <p><code class="codeph">DBMS_SPM</code></p>
                                       </td>
                                       <td align="left" valign="top" headers="d140998e856 d140998e812 ">
                                          <p><code class="codeph">LOAD_PLANS_FROM_CURSOR_CACHE</code></p>
                                       </td>
                                       <td align="left" valign="top" headers="d140998e856 d140998e815 ">
                                          <p>This function loads plans in the shared SQL area (also called the <span class="bold">cursor cache</span>) into SQL plan baselines.
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d140998e871" headers="d140998e809 ">
                                          <p><code class="codeph">DBMS_SPM</code></p>
                                       </td>
                                       <td align="left" valign="top" headers="d140998e871 d140998e812 ">
                                          <p><code class="codeph">LOAD_PLANS_FROM_SQLSET</code></p>
                                       </td>
                                       <td align="left" valign="top" headers="d140998e871 d140998e815 ">
                                          <p>This function loads plans in an STS into SQL plan baselines.</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d140998e883" headers="d140998e809 ">
                                          <p><code class="codeph">DBMS_SPM</code></p>
                                       </td>
                                       <td align="left" valign="top" headers="d140998e883 d140998e812 ">
                                          <p><code class="codeph">LOAD_PLANS_FROM_AWR</code></p>
                                       </td>
                                       <td align="left" valign="top" headers="d140998e883 d140998e815 ">
                                          <p>This function loads plans from AWR into SQL plan baselines.</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d140998e895" headers="d140998e809 ">
                                          <p><code class="codeph">DBMS_SPM</code></p>
                                       </td>
                                       <td align="left" valign="top" headers="d140998e895 d140998e812 ">
                                          <p><code class="codeph">PACK_STGTAB_BASELINE</code></p>
                                       </td>
                                       <td align="left" valign="top" headers="d140998e895 d140998e815 ">
                                          <p>This function packs SQL plan baselines, which means that it copies them from the SMB into a staging table.</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d140998e907" headers="d140998e809 ">
                                          <p><code class="codeph">DBMS_SPM</code></p>
                                       </td>
                                       <td align="left" valign="top" headers="d140998e907 d140998e812 ">
                                          <p><code class="codeph">UNPACK_STGTAB_BASELINE</code></p>
                                       </td>
                                       <td align="left" valign="top" headers="d140998e907 d140998e815 ">
                                          <p>This function unpacks SQL plan baselines, which means that it copies SQL plan baselines from a staging table into the SMB.</p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <!-- class="inftblhruleinformal" -->
                           <p>Also, you can use <code class="codeph">DBMS_XPLAN.DISPLAY_SQL_PLAN_BASELINE</code> to show one or more execution plans for the SQL statement identified by SQL handle.
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="infoboxnotealso" id="GUID-AE8CB28A-79CB-4B5F-BAE7-FF54E2EF6330__GUID-ADA03D0B-66B3-496D-B870-CA0325D01B6F">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><span class="q">"<a href="managing-sql-plan-baselines.html#GUID-15A23B74-8B43-49EA-83CE-14F2C209C9A9" title="This topic describes the most relevant DBMS_SPM functions for managing plan evolution. Execute evolution tasks manually or schedule them to run automatically.">About the DBMS_SPM Evolve Functions</a>"</span> describes the functions related to SQL plan evolution.
                                 </p>
                              </li>
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tgsql&amp;id=ARPLS150" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> to learn about the <code class="codeph">DBMS_SPM</code> and <code class="codeph">DBMS_XPLAN</code> packages
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="managing-sql-plan-baselines.html#GUID-00CFEAE0-32D8-43FC-AF4F-A3CB3062E374" title="You can access the DBMS_SPM package through Cloud Control or through the command line.">User Interfaces for SQL Plan Management</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div><a id="TGSQL621"></a><div class="props_rev_3"><a id="GUID-C79E7420-053B-4DCE-A219-072BDE488E21" name="GUID-C79E7420-053B-4DCE-A219-072BDE488E21"></a><h4 id="TGSQL-GUID-C79E7420-053B-4DCE-A219-072BDE488E21" class="sect4"><span class="enumeration_section">28.1.2 </span>Basic Tasks in SQL Plan Management
                  </h4>
                  <div>
                     <p>This topic explains the basic tasks in using SQL plan management to prevent performance regressions and enable the optimizer to consider new execution plans.</p>
                     <p>The tasks are as follows:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Set initialization parameters to control whether the database captures and uses SQL plan baselines, and whether it evolves new plans.</p>
                           <p>See <span class="q">"<a href="managing-sql-plan-baselines.html#GUID-3D701147-1371-4604-8127-F9199EA0EDE0" title="You can configure the capture and use of SQL plan baselines, and the SPM Evolve Advisor task.">Configuring SQL Plan Management</a>"</span>.
                           </p>
                        </li>
                        <li>
                           <p>Display plans in a SQL plan baseline.</p>
                           <p>See <span class="q">"<a href="managing-sql-plan-baselines.html#GUID-582BC3FB-2F52-4190-B807-16B79346B776" title="To view the plans stored in the SQL plan baseline for a specific statement, use the DBMS_XPLAN.DISPLAY_SQL_PLAN_BASELINE function. This function uses plan information stored in the plan history to display the plans.">Displaying Plans in a SQL Plan Baseline</a>"</span>.
                           </p>
                        </li>
                        <li>
                           <p>Manually load plans into SQL plan baselines.</p>
                           <p>Load plans from AWR, SQL tuning sets, the shared SQL area, a staging table, or stored outlines.</p>
                           <p>See <span class="q">"<a href="managing-sql-plan-baselines.html#GUID-C6AC4856-3C8C-42D8-A7FD-629974E98D36" title="Using DBMS_SPM, you can initiate the bulk load of a set of existing plans into a SQL plan baseline.">Loading SQL Plan Baselines</a>"</span>.
                           </p>
                        </li>
                        <li>
                           <p>Manually evolve plans into SQL plan baselines.</p>
                           <p>Use PL/SQL to verify the performance of specified plans and add them to plan baselines.</p>
                           <p>See <span class="q">"<a href="managing-sql-plan-baselines.html#GUID-19E6FFB0-BC7A-4CDB-AE36-6D67C15C7332" title="You can use PL/SQL or Cloud Control to manually evolve an unaccepted plan to determine whether it performs better than any plan currently in the plan baseline.">Evolving SQL Plan Baselines Manually</a>"</span>.
                           </p>
                        </li>
                        <li>
                           <p>Drop all or some plans in SQL plan baselines.</p>
                           <p>See <span class="q">"<a href="managing-sql-plan-baselines.html#GUID-BA19EA4E-AFEF-4677-B08F-854DE59ED932" title="You can remove some or all plans from a SQL plan baseline. This technique is sometimes useful when testing SQL plan management.">Dropping SQL Plan Baselines</a>"</span>.
                           </p>
                        </li>
                        <li>
                           <p>Manage the SMB.</p>
                           <p>Alter disk space limits and change the length of the plan retention policy.</p>
                           <p>See <span class="q">"<a href="managing-sql-plan-baselines.html#GUID-DE976D2B-DBAD-498F-B933-D16B06CA9D2A" title="The SQL management base is a part of the data dictionary that resides in the SYSAUX tablespace. It stores statement logs, plan histories, SQL plan baselines, and SQL profiles.">Managing the SQL Management Base</a>"</span>.
                           </p>
                        </li>
                        <li>
                           <p>Migrate stored outlines to SQL plan baselines.</p>
                           <p>See <span class="q">"<a href="migrating-stored-outlines.html#GUID-E1CBB4DA-2F83-4F4D-845B-CAAA8333DF1A" title="Stored outline migration is the user-initiated process of converting stored outlines to SQL plan baselines. A SQL plan baseline is a set of plans proven to provide optimal performance.">Migrating Stored Outlines to SQL Plan Baselines</a>"</span>.
                           </p>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-sql-plan-baselines.html#GUID-3D822F44-06C5-452F-8967-EBC12BA38036" title="This topic describes the available interfaces and basic tasks for SQL plan management.">About Managing SQL Plan Baselines</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="TGSQL94647"></a><div class="props_rev_3"><a id="GUID-3D701147-1371-4604-8127-F9199EA0EDE0" name="GUID-3D701147-1371-4604-8127-F9199EA0EDE0"></a><h3 id="TGSQL-GUID-3D701147-1371-4604-8127-F9199EA0EDE0" class="sect3"><span class="enumeration_section">28.2 </span>Configuring SQL Plan Management
               </h3>
               <div>
                  <p>You can configure the capture and use of SQL plan baselines, and the SPM Evolve Advisor task.</p>
                  <p>This section contains the following topics:</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="managing-sql-plan-baselines.html#GUID-C357AC4E-20CF-4995-A8C1-491FF26C19BC">Configuring the Capture and Use of SQL Plan Baselines</a><br>You control SQL plan management with the initialization parameters <code class="codeph">OPTIMIZER_CAPTURE_SQL_PLAN_BASELINES</code> and <code class="codeph">OPTIMIZER_USE_SQL_PLAN_BASELINES</code>.
                     </li>
                     <li class="ulchildlink"><a href="managing-sql-plan-baselines.html#GUID-A94CFA49-910A-4237-A7BB-39BFA94E227E">Managing the SPM Evolve Advisor Task</a><br>SPM Evolve Advisor is a SQL advisor that evolves plans that have recently been added to the SQL plan baseline. The advisor simplifies plan evolution by eliminating the requirement to do it manually.
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="managing-sql-plan-baselines.html#GUID-7024369A-F98D-48E4-921C-C899485C954F" title="This chapter explains the concepts and tasks relating to SQL plan management using the DBMS_SPM package.">Managing SQL Plan Baselines</a></p>
                     </div>
                  </div>
               </div>
               <a id="TGSQL640"></a><div class="props_rev_3"><a id="GUID-C357AC4E-20CF-4995-A8C1-491FF26C19BC" name="GUID-C357AC4E-20CF-4995-A8C1-491FF26C19BC"></a><h4 id="TGSQL-GUID-C357AC4E-20CF-4995-A8C1-491FF26C19BC" class="sect4"><span class="enumeration_section">28.2.1 </span>Configuring the Capture and Use of SQL Plan Baselines
                  </h4>
                  <div>
                     <p>You control SQL plan management with the initialization parameters <code class="codeph">OPTIMIZER_CAPTURE_SQL_PLAN_BASELINES</code> and <code class="codeph">OPTIMIZER_USE_SQL_PLAN_BASELINES</code>.
                     </p>
                     <p>The default values are as follows:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><code class="codeph">OPTIMIZER_CAPTURE_SQL_PLAN_BASELINES=false</code></p>
                           <p>For any repeatable SQL statement that does not already exist in the plan history, the database does <span class="italic">not</span> automatically create an initial SQL plan baseline for the statement.
                           </p>
                           <p>If <code class="codeph">OPTIMIZER_CAPTURE_SQL_PLAN_BASELINES=true</code>, then you can use the <code class="codeph">DBMS_SPM.CONFIGURE</code> procedure to configure filters that determine which statements are eligible for plan capture. By default, no filters are configured, which means that all repeatable statements are eligible for plan capture.
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">OPTIMIZER_USE_SQL_PLAN_BASELINES=true</code></p>
                           <p>For any SQL statement that has an existing SQL plan baseline, the database automatically adds new plans to the SQL plan baseline as unaccepted plans.</p>
                        </li>
                     </ul>
                     <div class="infoboxnote" id="GUID-C357AC4E-20CF-4995-A8C1-491FF26C19BC__GUID-AE7524ED-119E-43C1-867A-CBF009D0FD32">
                        <p class="notep1">Note:</p>
                        <p>The settings of the preceding parameters are independent of each other. For example, if  <code class="codeph">OPTIMIZER_CAPTURE_SQL_PLAN_BASELINES</code> is <code class="codeph">true</code>, then the database creates initial plan baselines for new statements even if <code class="codeph">OPTIMIZER_USE_SQL_PLAN_BASELINES</code> is <code class="codeph">false</code>.
                        </p>
                     </div>
                     <p>If the default behavior is what you intend, then skip this section.</p>
                     <p>The following sections explain how to change the default parameter settings from the command line. If you use Cloud Control, then set these parameters in the SQL Plan Baseline subpage. This section contains the following topics:</p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="managing-sql-plan-baselines.html#GUID-B3262755-C4A0-4B37-891B-6B3C2ACC6C45">Enabling Automatic Initial Plan Capture for SQL Plan Management</a><br>Setting the <code class="codeph">OPTIMIZER_CAPTURE_SQL_PLAN_BASELINES</code> initialization parameter to <code class="codeph">true</code> is all that is necessary for the database to automatically create an initial SQL plan baseline for any eligible SQL statement not already in the plan history.
                        </li>
                        <li class="ulchildlink"><a href="managing-sql-plan-baselines.html#GUID-82EFB280-8868-47E1-8360-6A9CA995BD56">Configuring Filters for Automatic Plan Capture</a><br>If <code class="codeph">OPTIMIZER_CAPTURE_SQL_PLAN_BASELINES=true</code>, then you can use the <code class="codeph">DBMS_SPM.CONFIGURE</code> procedure to create an <span class="bold">automatic capture filter</span> for repeatable statements. 
                        </li>
                        <li class="ulchildlink"><a href="managing-sql-plan-baselines.html#GUID-4D5A5D5F-7B6A-416A-8108-E1FD82825A4D">Disabling All SQL Plan Baselines</a><br>When you set the <code class="codeph">OPTIMIZER_USE_SQL_PLAN_BASELINES</code> initialization parameter to <code class="codeph">false</code>, the database does not use <span class="italic">any</span> plan baselines in the database. 
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-C357AC4E-20CF-4995-A8C1-491FF26C19BC__GUID-22F690DD-A2AF-44D1-8B90-8A15FFBEB1FC">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><span class="q">"<a href="managing-sql-plan-baselines.html#GUID-9BB06D27-4A3F-4DBA-A7EB-85B5C4EA0631__CDEBHHEI">Figure 28-1</a>"</span></p>
                           </li>
                           <li>
                              <p><span class="q">"<a href="overview-of-sql-plan-management.html#GUID-5A1E6CF4-70E5-4C26-A67B-EFDBB93EC621" title="When enabled, the database checks whether executed SQL statements are eligible for automatic capture.">Automatic Initial Plan Capture</a>"</span></p>
                           </li>
                           <li>
                              <p> <span class="q">"<a href="overview-of-sql-plan-management.html#GUID-67A76171-62CB-49A5-B5BD-CFFE26511E90" title="SQL plan selection is the optimizer ability to detect plan changes based on stored plan history, and the use of SQL plan baselines to select plans to avoid potential performance regressions.">Plan Selection</a>"</span></p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-sql-plan-baselines.html#GUID-3D701147-1371-4604-8127-F9199EA0EDE0" title="You can configure the capture and use of SQL plan baselines, and the SPM Evolve Advisor task.">Configuring SQL Plan Management</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="TGSQL641"></a><div class="props_rev_3"><a id="GUID-B3262755-C4A0-4B37-891B-6B3C2ACC6C45" name="GUID-B3262755-C4A0-4B37-891B-6B3C2ACC6C45"></a><h5 id="TGSQL-GUID-B3262755-C4A0-4B37-891B-6B3C2ACC6C45" class="sect5"><span class="enumeration_section">28.2.1.1 </span>Enabling Automatic Initial Plan Capture for SQL Plan Management
                     </h5>
                     <div>
                        <p>Setting the <code class="codeph">OPTIMIZER_CAPTURE_SQL_PLAN_BASELINES</code> initialization parameter to <code class="codeph">true</code> is all that is necessary for the database to automatically create an initial SQL plan baseline for any eligible SQL statement not already in the plan history.
                        </p>
                        <div class="section">
                           <p>By default, the database considers all repeatable SQL statements as eligible for capture, with the following exceptions:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><code class="codeph">CREATE TABLE</code> when the <code class="codeph">AS SELECT</code> clause is <span class="italic">not</span> specified
                                 </p>
                              </li>
                              <li>
                                 <p><code class="codeph">DROP TABLE</code></p>
                              </li>
                              <li>
                                 <p><code class="codeph">INSERT INTO ... VALUES</code></p>
                              </li>
                           </ul>
                           <div class="infoboxnote" id="GUID-B3262755-C4A0-4B37-891B-6B3C2ACC6C45__GUID-E65A7E68-BBB4-40B0-B9F1-7C58F0B3D40B">
                              <p class="notep1">Caution:</p>
                              <p>By default, when automatic baseline capture is enabled, the database creates a SQL plan baseline for <span class="italic">every</span> eligible repeatable statement, including all recursive SQL and monitoring SQL. Thus, automatic capture may result in the creation of an extremely large number of plan baselines. To limit the statements that are eligible for plan baselines, configure filters using the <code class="codeph">DBMS_SPM.CONFIGURE</code> procedure.
                              </p>
                           </div>
                           <p>The <code class="codeph">OPTIMIZER_CAPTURE_SQL_PLAN_BASELINES</code> parameter does not control the automatic addition of newly discovered plans to a previously created SQL plan baseline.
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-B3262755-C4A0-4B37-891B-6B3C2ACC6C45__GUID-0997778D-E06F-4470-AF78-EA695CF29878">To enable automatic initial plan capture for SQL plan management:</p>
                           <ol>
                              <li>
                                 <p>In SQL*Plus, log in to the database with the necessary privileges.</p>
                              </li>
                              <li>
                                 <p>Show the current settings for SQL plan management.</p>
                                 <p>For example, connect SQL*Plus to the database with administrator privileges and execute the following command (sample output included):</p><pre class="pre codeblock"><code>SHOW PARAMETER SQL_PLAN
</code></pre><p>The following sample output shows that automatic initial plan capture is disabled:</p><pre class="pre codeblock"><code>NAME                                 TYPE        VALUE
------------------------------------ ----------- -----
optimizer_capture_sql_plan_baselines boolean     FALSE
optimizer_use_sql_plan_baselines     boolean     TRUE</code></pre><p>If the parameters are set as you intend, then skip the remaining steps.</p>
                              </li>
                              <li>
                                 <p>To enable the automatic recognition of repeatable SQL statements and the generation of SQL plan baselines for these statements, enter the following statement:</p><pre class="pre codeblock"><code>ALTER SYSTEM SET OPTIMIZER_CAPTURE_SQL_PLAN_BASELINES=true;</code></pre></li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="infoboxnotealso" id="GUID-B3262755-C4A0-4B37-891B-6B3C2ACC6C45__GUID-2D6EA7BA-B334-4204-9510-C1CB07143D9A">
                           <p class="notep1">See Also:</p>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tgsql&amp;id=GUID-A562069E-BD44-4ABB-A987-0A13078F4E90" target="_blank"><span><cite>Oracle Database Reference</cite></span></a> to learn more about <code class="codeph">OPTIMIZER_CAPTURE_SQL_PLAN_BASELINES</code></p>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="managing-sql-plan-baselines.html#GUID-C357AC4E-20CF-4995-A8C1-491FF26C19BC" title="You control SQL plan management with the initialization parameters OPTIMIZER_CAPTURE_SQL_PLAN_BASELINES and OPTIMIZER_USE_SQL_PLAN_BASELINES.">Configuring the Capture and Use of SQL Plan Baselines</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
                  <div class="sect4"><a id="GUID-82EFB280-8868-47E1-8360-6A9CA995BD56" name="GUID-82EFB280-8868-47E1-8360-6A9CA995BD56"></a><h5 id="TGSQL-GUID-82EFB280-8868-47E1-8360-6A9CA995BD56" class="sect5"><span class="enumeration_section">28.2.1.2 </span>Configuring Filters for Automatic Plan Capture
                     </h5>
                     <div>
                        <p>If <code class="codeph">OPTIMIZER_CAPTURE_SQL_PLAN_BASELINES=true</code>, then you can use the <code class="codeph">DBMS_SPM.CONFIGURE</code> procedure to create an <span class="bold">automatic capture filter</span> for repeatable statements. 
                        </p>
                        <div class="section">
                           <p>An automatic filter enables you to capture only statements that you want, and exclude noncritical statements. This technique saves space in the <code class="codeph">SYSAUX</code> tablespace.
                           </p>
                           <p>The following table describes the relevant parameters of the <code class="codeph">DBMS_SPM.CONFIGURE</code> procedure.
                           </p>
                           <div class="tblformal" id="GUID-82EFB280-8868-47E1-8360-6A9CA995BD56__BEIIHDDJ">
                              <p class="titleintable">Table 28-2 DBMS_SPM.CONFIGURE Parameters</p>
                              <table cellpadding="4" cellspacing="0" class="Formal" title="DBMS_SPM.CONFIGURE Parameters" summary="This 2 column tables lists the relevant parameters for the DBMS_SPM.CONFIGURE procedure. Column 1 is the parameter. Column 2 describes that parameter. " width="100%" frame="hsides" border="1" rules="rows">
                                 <thead>
                                    <tr align="left" valign="top">
                                       <th align="left" valign="bottom" id="d140998e1933">Parameter</th>
                                       <th align="left" valign="bottom" id="d140998e1936">Description</th>
                                    </tr>
                                 </thead>
                                 <tbody>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d140998e1941" headers="d140998e1933 ">
                                          <p><code class="codeph">parameter_name</code></p>
                                       </td>
                                       <td align="left" valign="top" headers="d140998e1941 d140998e1936 ">
                                          <p>The type of filter for automatic capture. </p>
                                          <p>Possible values are <code class="codeph">AUTO_CAPTURE_SQL_TEXT</code>, <code class="codeph">AUTO_CAPTURE_PARSING_SCHEMA_NAME</code>, <code class="codeph">AUTO_CAPTURE_MODULE</code>, and <code class="codeph">AUTO_CAPTURE_ACTION</code>.
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d140998e1963" headers="d140998e1933 ">
                                          <p><code class="codeph">parameter_value</code></p>
                                       </td>
                                       <td align="left" valign="top" headers="d140998e1963 d140998e1936 ">
                                          <p>The search criteria for the automatic capture filter. </p>
                                          <p>When <code class="codeph">parameter_name</code> is set to <code class="codeph">AUTO_CAPTURE_SQL_TEXT</code>, the search pattern depends on the <code class="codeph">allow</code> setting:
                                          </p>
                                          <ul style="list-style-type: disc;">
                                             <li>
                                                <p><code class="codeph">LIKE</code></p>
                                                <p>The parameter uses this pattern when <code class="codeph">allow=&gt;true</code>.
                                                </p>
                                             </li>
                                             <li>
                                                <p><code class="codeph">NOT LIKE</code></p>
                                                <p>The parameter uses this pattern when <code class="codeph">allow=&gt;false</code>.
                                                </p>
                                             </li>
                                          </ul>
                                          <p>For all other non-null <code class="codeph">parameter_name</code> values, the search pattern depends on the <code class="codeph">allow</code> setting: 
                                          </p>
                                          <ul style="list-style-type: disc;">
                                             <li>
                                                <p><code class="codeph">=</code></p>
                                                <p>The parameter uses this pattern when <code class="codeph">allow=&gt;true</code>.
                                                </p>
                                             </li>
                                             <li>
                                                <p><code class="codeph">&lt;&gt;</code></p>
                                                <p>The parameter uses this pattern when <code class="codeph">allow=&gt;false</code>.
                                                </p>
                                             </li>
                                          </ul>
                                          <p>A null value removes the filter for <code class="codeph">parameter_name</code> entirely.
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d140998e2033" headers="d140998e1933 "><code class="codeph">allow</code></td>
                                       <td align="left" valign="top" headers="d140998e2033 d140998e1936 ">Whether to include (<code class="codeph">true</code>) or exclude (<code class="codeph">false</code>) matching SQL statements and plans. If null, then the procedure ignores the specified parameter.
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <!-- class="inftblhruleinformal" -->
                           <p>You can configure multiple parameters of different types. Also, you can specify multiple values for the same parameter in separate statements, which the database combines. The settings are additive: one parameter setting does not override a previous setting. For example, the following filter captures SQL in the parsing schema <code class="codeph">SYS</code> or <code class="codeph">SYSTEM</code>:
                           </p><pre class="pre codeblock"><code>EXEC DBMS_SPM.CONFIGURE('AUTO_CAPTURE_PARSING_SCHEMA_NAME','SYS',true);
EXEC DBMS_SPM.CONFIGURE('AUTO_CAPTURE_PARSING_SCHEMA_NAME','SYSTEM',true);</code></pre><p>However, you cannot configure multiple values for the same parameter in the same procedure. For example, you cannot specify multiple SQL text strings for <code class="codeph">AUTO_CAPTURE_SQL_TEXT</code>. 
                           </p>
                           <p>The <code class="codeph">DBA_SQL_MANAGEMENT_CONFIG</code> view shows the current parameter values.
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="p">
                           <p>This tutorial assumes the following:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>The <code class="codeph">OPTIMIZER_CAPTURE_SQL_PLAN_BASELINES</code> initialization parameter is set to <code class="codeph">true</code>.
                                 </p>
                              </li>
                              <li>
                                 <p>You want to include only statements parsed in the <code class="codeph">sh</code> schema to be eligible for baselines.
                                 </p>
                              </li>
                              <li>
                                 <p>You want to exclude statements that contain the text <code class="codeph">TEST_ONLY</code>.
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-82EFB280-8868-47E1-8360-6A9CA995BD56__GUID-1C79ECDD-7724-439A-BB75-F1C148C2B50F">To filter out all statements except those parsed in the sh schema:</p>
                           <ol>
                              <li>
                                 <p>Connect SQL*Plus to the database with the appropriate privileges.</p>
                              </li>
                              <li>
                                 <p>To remove any existing filters for parsing schema and SQL text, execute the following PL/SQL programs:</p><pre class="pre codeblock"><code>EXEC DBMS_SPM.CONFIGURE('AUTO_CAPTURE_PARSING_SCHEMA_NAME',null,true);
EXEC DBMS_SPM.CONFIGURE('AUTO_CAPTURE_SQL_TEXT',null,true);</code></pre></li>
                              <li>
                                 <p>Include only statements parsed in the <code class="codeph">sh</code> schema for consideration for automatic capture:
                                 </p><pre class="pre codeblock"><code>EXEC DBMS_SPM.CONFIGURE('AUTO_CAPTURE_PARSING_SCHEMA_NAME','sh',true);</code></pre></li>
                              <li>
                                 <p>Exclude any statement that contains the text <code class="codeph">TEST_ONLY</code>  from consideration for automatic capture:
                                 </p><pre class="pre codeblock"><code>EXEC DBMS_SPM.CONFIGURE('AUTO_CAPTURE_SQL_TEXT','%TEST_ONLY%',false);</code></pre></li>
                              <li>
                                 <p>Optionally, to confirm the filters, query <code class="codeph">DBA_SQL_MANAGEMENT_CONFIG</code>.
                                 </p>
                                 <p>For example, use the following query (sample output included):</p><pre class="pre codeblock"><code>COL PARAMETER_NAME FORMAT a32
COL PARAMETER_VALUE FORMAT a32

SELECT PARAMETER_NAME, PARAMETER_VALUE 
FROM   DBA_SQL_MANAGEMENT_CONFIG 
WHERE  PARAMETER_NAME LIKE '%AUTO%';

PARAMETER_NAME                   PARAMETER_VALUE
-------------------------------- --------------------------------
AUTO_CAPTURE_PARSING_SCHEMA_NAME parsing_schema IN (SH)
AUTO_CAPTURE_MODULE
AUTO_CAPTURE_ACTION
AUTO_CAPTURE_SQL_TEXT            (sql_text NOT LIKE %TEST_ONLY%)</code></pre></li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="infoboxnotealso" id="GUID-82EFB280-8868-47E1-8360-6A9CA995BD56__GUID-909290F4-AB4D-4663-9EA7-ADA6A3A8A34B">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><span class="q">"<a href="overview-of-sql-plan-management.html#GUID-5A1E6CF4-70E5-4C26-A67B-EFDBB93EC621" title="When enabled, the database checks whether executed SQL statements are eligible for automatic capture.">Automatic Initial Plan Capture</a>"</span></p>
                              </li>
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tgsql&amp;id=ARPLS-GUID-D855D4B9-D071-4BB2-A554-38479867DE76" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> to learn more about the <code class="codeph">DBMS_SPM.CONFIGURE</code> procedure
                                 </p>
                              </li>
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tgsql&amp;id=REFRN-GUID-4E9C3D2A-93B8-49C5-9169-C54A9EB7431C" target="_blank"><span><cite>Oracle Database Reference</cite></span></a> to learn more about the <code class="codeph">DBA_SQL_MANAGEMENT_CONFIG</code> view
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="managing-sql-plan-baselines.html#GUID-C357AC4E-20CF-4995-A8C1-491FF26C19BC" title="You control SQL plan management with the initialization parameters OPTIMIZER_CAPTURE_SQL_PLAN_BASELINES and OPTIMIZER_USE_SQL_PLAN_BASELINES.">Configuring the Capture and Use of SQL Plan Baselines</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="TGSQL642"></a><div class="props_rev_3"><a id="GUID-4D5A5D5F-7B6A-416A-8108-E1FD82825A4D" name="GUID-4D5A5D5F-7B6A-416A-8108-E1FD82825A4D"></a><h5 id="TGSQL-GUID-4D5A5D5F-7B6A-416A-8108-E1FD82825A4D" class="sect5"><span class="enumeration_section">28.2.1.3 </span>Disabling All SQL Plan Baselines
                     </h5>
                     <div>
                        <p>When you set the <code class="codeph">OPTIMIZER_USE_SQL_PLAN_BASELINES</code> initialization parameter to <code class="codeph">false</code>, the database does not use <span class="italic">any</span> plan baselines in the database. 
                        </p>
                        <div class="section">
                           <p>Typically, you might want to disable one or two plan baselines, but not all of them. A possible use case might be testing the benefits of SQL plan management.</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-4D5A5D5F-7B6A-416A-8108-E1FD82825A4D__GUID-5792D450-672B-4775-B835-5836C1B201CD">To disable all SQL plan baselines in the database:</p>
                           <ol>
                              <li>
                                 <p>Connect SQL*Plus to the database with the appropriate privileges, and then show the current settings for SQL plan management.</p>
                                 <p>For example, connect SQL*Plus to the database with administrator privileges and execute the following command (sample output included):</p><pre class="pre codeblock"><code>SQL&gt; SHOW PARAMETER SQL_PLAN
 
NAME                                 TYPE        VALUE
------------------------------------ ----------- -----
optimizer_capture_sql_plan_baselines boolean     FALSE
optimizer_use_sql_plan_baselines     boolean     TRUE
</code></pre><p>If the parameters are set as you intend, then skip the remaining steps.</p>
                              </li>
                              <li>
                                 <p>To ignore all existing plan baselines enter the following statement:</p><pre class="pre codeblock"><code>SQL&gt; ALTER SYSTEM SET OPTIMIZER_USE_SQL_PLAN_BASELINES=false</code></pre></li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                        <div class="section"></div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="infoboxnotealso" id="GUID-4D5A5D5F-7B6A-416A-8108-E1FD82825A4D__GUID-C0CA18EB-37A5-4406-8B32-EB5625B51AAD">
                           <p class="notep1">See Also:</p>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tgsql&amp;id=REFRN10292" target="_blank"><span><cite>Oracle Database Reference</cite></span></a> to learn about the SQL plan baseline initialization parameters
                           </p>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="managing-sql-plan-baselines.html#GUID-C357AC4E-20CF-4995-A8C1-491FF26C19BC" title="You control SQL plan management with the initialization parameters OPTIMIZER_CAPTURE_SQL_PLAN_BASELINES and OPTIMIZER_USE_SQL_PLAN_BASELINES.">Configuring the Capture and Use of SQL Plan Baselines</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div><a id="TGSQL94648"></a><div class="props_rev_3"><a id="GUID-A94CFA49-910A-4237-A7BB-39BFA94E227E" name="GUID-A94CFA49-910A-4237-A7BB-39BFA94E227E"></a><h4 id="TGSQL-GUID-A94CFA49-910A-4237-A7BB-39BFA94E227E" class="sect4"><span class="enumeration_section">28.2.2 </span>Managing the SPM Evolve Advisor Task
                  </h4>
                  <div>
                     <p>SPM Evolve Advisor is a SQL advisor that evolves plans that have recently been added to the SQL plan baseline. The advisor simplifies plan evolution by eliminating the requirement to do it manually.</p>
                     <p>This section contains the following topics:</p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="managing-sql-plan-baselines.html#GUID-6D284A90-3761-4BC1-AC3E-DF39EE727FC7">About the SPM Evolve Advisor Task</a><br>By default, <code class="codeph">SYS_AUTO_SPM_EVOLVE_TASK</code> runs daily in the scheduled maintenance window.
                        </li>
                        <li class="ulchildlink"><a href="managing-sql-plan-baselines.html#GUID-0D221783-C6C3-470E-8022-60ADF87E2473">Enabling and Disabling the SPM Evolve Advisor Task</a><br>No separate scheduler client exists for the Automatic SPM Evolve Advisor task. 
                        </li>
                        <li class="ulchildlink"><a href="managing-sql-plan-baselines.html#GUID-541EBA4B-4F7D-42DD-A152-C06BDE69D828">Configuring the Automatic SPM Evolve Advisor Task</a><br>Configure automatic plan evolution by specifying the task parameters using the <code class="codeph">DBMS_SPM.SET_EVOLVE_TASK_PARAMETER</code> procedure. 
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-sql-plan-baselines.html#GUID-3D701147-1371-4604-8127-F9199EA0EDE0" title="You can configure the capture and use of SQL plan baselines, and the SPM Evolve Advisor task.">Configuring SQL Plan Management</a></p>
                        </div>
                     </div>
                  </div>
                  
                  <div class="sect4"><a id="GUID-6D284A90-3761-4BC1-AC3E-DF39EE727FC7" name="GUID-6D284A90-3761-4BC1-AC3E-DF39EE727FC7"></a><h5 id="TGSQL-GUID-6D284A90-3761-4BC1-AC3E-DF39EE727FC7" class="sect5"><span class="enumeration_section">28.2.2.1 </span>About the SPM Evolve Advisor Task
                     </h5>
                     <div>
                        <p>By default, <code class="codeph">SYS_AUTO_SPM_EVOLVE_TASK</code> runs daily in the scheduled maintenance window.
                        </p>
                        <p>A SQL plan baseline prevents performance regressions caused by suboptimal plans. If a SQL statement does not have a SQL plan baseline, and if the <code class="codeph">alternate_plan_baseline</code> parameter is set to <code class="codeph">AUTO</code>, then SQM Evolve Advisor can sometimes resolve such performance regressions automatically. The advisor compares all available plans and chooses the best-performing plan as the baseline.
                        </p>
                        <p>The following figure shows the workflow for Automatic SPM Evolve Advisor:</p>
                        <div class="figure" id="GUID-6D284A90-3761-4BC1-AC3E-DF39EE727FC7__GUID-D1BF22A6-DD30-44F1-995C-B51B15A482CF">
                           <p class="titleinfigure">Figure 28-2 Automatic SPM Evolve Advisor</p><img src="img/auto_spm.png" alt="Description of Figure 28-2 follows" title="Description of Figure 28-2 follows" longdesc="img_text/auto_spm.html"><br><a href="img_text/auto_spm.html">Description of "Figure 28-2 Automatic SPM Evolve Advisor"</a></div>
                        <!-- class="figure" -->
                        <p>Whenever it runs in the maintenance window, SPM Evolve Advisor performs the following tasks:</p>
                        <ol>
                           <li>
                              <p>Checks AWR for top SQL</p>
                              <p>AWR stores the most resource-intensive SQL statements. SPM Evolve Advisor searches AWR for statements that are most likely to benefit from SQL plan baselines, and then adds plans for these statements to the baselines.</p>
                           </li>
                           <li>
                              <p>Looks for alternative plans in all available sources</p>
                              <p>By default (<code class="codeph">alternate_plan_source=AUTO</code>), the automatic task searches all available repositories for plans that are not yet in the SMB plan history. The setting for <code class="codeph">alternate_plan_source</code> is shown in the <code class="codeph">DBA_ADVISORS_PARAMETERS</code> view.
                              </p>
                           </li>
                           <li>
                              <p>Adds unaccepted plans to the plan history</p>
                              <p>These plans are not yet in the SQL plan baseline for any SQL statement.</p>
                           </li>
                           <li>
                              <p>Tests the execution of as many plans as possible during the maintenance window</p>
                              <p>For every alternative plan, the database test executes the statement and records the performance statistics. The goal is to use a cost-based algorithm to compare the performance of every alternative plan with the plan that the optimizer would otherwise choose.</p>
                           </li>
                           <li>
                              <p>Performs either of the following actions, depending on whether the alternative plan performs better than the current plan:</p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>If performance is better, then SPM Evolve Advisor accepts the plan. The alternative plan is now in the baseline.</p>
                                 </li>
                                 <li>
                                    <p>If performance is worse, then the plan remains in the statement history, but not the baseline.</p>
                                 </li>
                              </ul>
                           </li>
                        </ol>
                        <div class="example" id="GUID-6D284A90-3761-4BC1-AC3E-DF39EE727FC7__GUID-621C37AD-28BC-4966-8EB4-BB20E412DA24">
                           <p class="titleinexample">Example 28-1 Out-of-Range Query</p>
                           <p>Assume that an application issues a new, long-running query of <code class="codeph">sh.products</code>. The query references the <code class="codeph">prod_list_price</code> column using a bind variable. The database performs the following steps:
                           </p>
                           <ol id="GUID-6D284A90-3761-4BC1-AC3E-DF39EE727FC7__OL_XZQ_DRC_VFB">
                              <li>
                                 <p>The optimizer chooses an optimal plan for this query based on fresh statistics, which show <code class="codeph">prod_list_price</code> with a maximum list price of $1299.99. The optimal plan resides in AWR.
                                 </p>
                              </li>
                              <li>
                                 <p>An application adds more products to the <code class="codeph">sh.products</code> table, and changes the list prices of many products.
                                 </p>
                              </li>
                              <li>
                                 <p>The application issues the original query, which the optimizer reparses.</p>
                                 <p>In this execution of the query, the bind variable sets the list price to $1500, which is higher than the $1299.99 maximum value recorded in the table statistics. This is known as an <span class="italic">out-of-range query</span>.
                                 </p>
                              </li>
                              <li>
                                 <p>The optimizer chooses a suboptimal plan for the out-of-range query, causing a performance regression. </p>
                                 <p>The optimizer attempts to avoid performance regressions by allowing for out-of-range conditions, but is sometimes unsuccessful, as in this example. The result is a suboptimal plan.</p>
                              </li>
                              <li>
                                 <p> The database resolves the performance regression as follows:</p>
                                 <ul style="list-style-type: disc;" id="GUID-6D284A90-3761-4BC1-AC3E-DF39EE727FC7__UL_JRX_TBY_VFB">
                                    <li>
                                       <p>SPM Evolve Advisor identifies the long-running query as a candidate for a SQL plan baseline.</p>
                                    </li>
                                    <li>
                                       <p>SPM Evolve Advisor finds both plans, the original plan in AWR and the suboptimal plan for the out-of-range query, and determines that the original plan performs better.</p>
                                    </li>
                                    <li>
                                       <p>SQL plan management adds the original plan for the query to the SQL plan baseline. Consequently, the optimizer will not use the regressed plan.</p>
                                    </li>
                                 </ul>
                              </li>
                           </ol>
                        </div>
                        <!-- class="example" -->
                     </div>
                     <div>
                        <div class="infoboxnotealso" id="GUID-6D284A90-3761-4BC1-AC3E-DF39EE727FC7__GUID-2A0B676C-08D4-46C7-AE83-2DB8A231B06F">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type: disc;" id="GUID-6D284A90-3761-4BC1-AC3E-DF39EE727FC7__UL_PV3_3VD_VFB">
                              <li>
                                 <p><span><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tgsql&amp;id=DBLIC-GUID-0F9EB85D-4610-4EDF-89C2-4916A0E7AC87" target="_blank"><span><cite>Oracle Database Licensing Information User Manual</cite></span></a> for details on which features are supported for different editions and services</span></p>
                              </li>
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tgsql&amp;id=ARPLS-GUID-E95C833E-9352-457A-A360-8D7E567EF2F5" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> to learn more about the <code class="codeph">DBMS_SPM.SET_EVOLVE_TASK_PARAMETER</code> procedure
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="managing-sql-plan-baselines.html#GUID-A94CFA49-910A-4237-A7BB-39BFA94E227E" title="SPM Evolve Advisor is a SQL advisor that evolves plans that have recently been added to the SQL plan baseline. The advisor simplifies plan evolution by eliminating the requirement to do it manually.">Managing the SPM Evolve Advisor Task</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="TGSQL94649"></a><div class="props_rev_3"><a id="GUID-0D221783-C6C3-470E-8022-60ADF87E2473" name="GUID-0D221783-C6C3-470E-8022-60ADF87E2473"></a><h5 id="TGSQL-GUID-0D221783-C6C3-470E-8022-60ADF87E2473" class="sect5"><span class="enumeration_section">28.2.2.2 </span>Enabling and Disabling the SPM Evolve Advisor Task
                     </h5>
                     <div>
                        <p>No separate scheduler client exists for the Automatic SPM Evolve Advisor task. </p>
                        <div class="section">
                           <p>One client controls both Automatic SQL Tuning Advisor and Automatic SPM Evolve Advisor. Thus, the same task enables or disables both.</p>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="infoboxnotealso" id="GUID-0D221783-C6C3-470E-8022-60ADF87E2473__GUID-CB91827F-AB2C-497F-AC2B-D796D44A58BD">
                           <p class="notep1">See Also:</p>
                           <p><span class="q">"<a href="sql-tuning-advisor.html#GUID-581888AA-B9EF-4471-ABDF-1FF9C0264412" title="You can enable or disable the Automatic SQL Tuning task using Cloud Control (preferred) or a command-line interface.">Enabling and Disabling the Automatic SQL Tuning Task</a>"</span> to learn how to enable and disable Automatic SPM Evolve Advisor
                           </p>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="managing-sql-plan-baselines.html#GUID-A94CFA49-910A-4237-A7BB-39BFA94E227E" title="SPM Evolve Advisor is a SQL advisor that evolves plans that have recently been added to the SQL plan baseline. The advisor simplifies plan evolution by eliminating the requirement to do it manually.">Managing the SPM Evolve Advisor Task</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="TGSQL94969"></a><a id="TGSQL94650"></a><div class="props_rev_3"><a id="GUID-541EBA4B-4F7D-42DD-A152-C06BDE69D828" name="GUID-541EBA4B-4F7D-42DD-A152-C06BDE69D828"></a><h5 id="TGSQL-GUID-541EBA4B-4F7D-42DD-A152-C06BDE69D828" class="sect5"><span class="enumeration_section">28.2.2.3 </span>Configuring the Automatic SPM Evolve Advisor Task
                     </h5>
                     <div>
                        <p>Configure automatic plan evolution by specifying the task parameters using the <code class="codeph">DBMS_SPM.SET_EVOLVE_TASK_PARAMETER</code> procedure. 
                        </p>
                        <div class="section">
                           <p>Because the <code class="codeph">SYS_AUTO_SPM_EVOLVE_TASK</code> task is owned by <code class="codeph">SYS</code>, only <code class="codeph">SYS</code> can set task parameters.
                           </p>
                           <p>The following table describes some of the procedure parameters.</p>
                           <div class="tblformalwide" id="GUID-541EBA4B-4F7D-42DD-A152-C06BDE69D828__BEIIHDDJ">
                              <p class="titleintable">Table 28-3 DBMS_SPM.SET_EVOLVE_TASK_PARAMETER Parameters</p>
                              <table cellpadding="4" cellspacing="0" class="FormalWide" title="DBMS_SPM.SET_EVOLVE_TASK_PARAMETER Parameters" summary="This 2 column table lists the parameters for SPM Evolve Advisor task. Column 1 is the parameter. Column 2 describes that parameter. " width="100%" frame="hsides" border="1" rules="rows">
                                 <thead>
                                    <tr align="left" valign="top">
                                       <th align="left" valign="bottom" id="d140998e2999">Parameter</th>
                                       <th align="left" valign="bottom" id="d140998e3002">Description</th>
                                       <th align="left" valign="bottom" id="d140998e3005">Default</th>
                                    </tr>
                                 </thead>
                                 <tbody>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d140998e3010" headers="d140998e2999 ">
                                          <p><code class="codeph">alternate_plan_source</code></p>
                                       </td>
                                       <td align="left" valign="top" headers="d140998e3010 d140998e3002 ">
                                          <p>Determines which sources to search for additional plans: <code class="codeph">CURSOR_CACHE</code>, <code class="codeph">AUTOMATIC_WORKLOAD_REPOSITORY</code>, or <code class="codeph">SQL_TUNING_SET</code>. Combine multiple values with the plus sign (<code class="codeph">+</code>).
                                          </p>
                                       </td>
                                       <td align="left" valign="top" headers="d140998e3010 d140998e3005 ">
                                          <p>The default depends on whether the SPM Evolve Advisor task is automated or manual:</p>
                                          <ul style="list-style-type: disc;">
                                             <li>
                                                <p>If automated, the default is <code class="codeph">AUTO</code>.
                                                </p>
                                             </li>
                                             <li>
                                                <p>If manual, the default is <code class="codeph">CURSOR_CACHE+AUTOMATIC_WORKLOAD_REPOSITORY</code>.
                                                </p>
                                             </li>
                                          </ul>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d140998e3046" headers="d140998e2999 ">
                                          <p><code class="codeph">alternate_plan_baseline</code></p>
                                       </td>
                                       <td align="left" valign="top" headers="d140998e3046 d140998e3002 ">
                                          <p>Determines which alternative plans should be loaded:</p>
                                          <ul style="list-style-type: disc;">
                                             <li>
                                                <p><code class="codeph">AUTO</code> gives the database autonomy to choose whether to load plans for statements with or without baselines.
                                                </p>
                                             </li>
                                             <li>
                                                <p><code class="codeph">EXISTING</code> loads alternate plans with for statements with existing baselines.
                                                </p>
                                             </li>
                                             <li>
                                                <p><code class="codeph">NEW</code> loads alternative plans for statements without a baseline, in which case a new baseline is created.
                                                </p>
                                             </li>
                                          </ul>
                                          <p>You can combine multiple values with the plus sign (<code class="codeph">+</code>), as in <code class="codeph">EXISTING+NEW</code>.
                                          </p>
                                       </td>
                                       <td align="left" valign="top" headers="d140998e3046 d140998e3005 ">
                                          <p>The default depends on whether the SPM Evolve Advisor task is automated or manual:</p>
                                          <ul style="list-style-type: disc;">
                                             <li>
                                                <p>If automated, the default is <code class="codeph">AUTO</code>.
                                                </p>
                                             </li>
                                             <li>
                                                <p>If manual, the default is <code class="codeph">EXISTING</code>.
                                                </p>
                                             </li>
                                          </ul>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d140998e3094" headers="d140998e2999 ">
                                          <p><code class="codeph">alternate_plan_limit</code></p>
                                       </td>
                                       <td align="left" valign="top" headers="d140998e3094 d140998e3002 ">
                                          <p>Specifies the maximum number of plans to load in total (that is, not the limit for each SQL statement). </p>
                                       </td>
                                       <td align="left" valign="top" headers="d140998e3094 d140998e3005 ">
                                          <p>The default depends on whether the SPM Evolve Advisor task is automated or manual:</p>
                                          <ul style="list-style-type: disc;">
                                             <li>
                                                <p>If automated, the default is <code class="codeph">UNLIMITED</code>.
                                                </p>
                                             </li>
                                             <li>
                                                <p>If manual, the default is <code class="codeph">10</code>.
                                                </p>
                                             </li>
                                          </ul>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d140998e3118" headers="d140998e2999 ">
                                          <p><code class="codeph">accept_plans</code></p>
                                       </td>
                                       <td align="left" valign="top" headers="d140998e3118 d140998e3002 ">
                                          <p>Specifies whether to accept recommended plans automatically.</p>
                                          <p>When <code class="codeph">ACCEPT_PLANS</code> is <code class="codeph">true</code>, SQL plan management automatically accepts all plans recommended by the task. When set to <code class="codeph">false</code>, the task verifies the plans and then generates a report of its findings, but does not evolve the plans.
                                          </p>
                                       </td>
                                       <td align="left" valign="top" headers="d140998e3118 d140998e3005 ">
                                          <p>The default is <code class="codeph">true</code> whether the advisor is run automatically or manually.
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <!-- class="inftblhruleinformal" -->
                        </div>
                        <!-- class="section" -->
                        <div class="p">
                           <p>The tutorial in this section assumes the following:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>You want the database to accept plans automatically.</p>
                              </li>
                              <li>
                                 <p>You want the task to time out after 1200 seconds per execution.</p>
                              </li>
                              <li>
                                 <p>You want the evolve task to look for up to a maximum of 500 plans in the shared SQL area and AWR repository</p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-541EBA4B-4F7D-42DD-A152-C06BDE69D828__GUID-5369639D-AFC5-4022-B1FA-C1E37C440C39">To set automatic evolution task parameters:</p>
                           <ol>
                              <li>
                                 <p>Start SQL*Plus, and then log in to the database as <code class="codeph">SYS</code>.
                                 </p>
                              </li>
                              <li>
                                 <p>Query the current parameter settings for <code class="codeph">SYS_AUTO_SPM_EVOLVE_TASK</code>.
                                 </p>
                                 <p>For example, connect SQL*Plus to the database with administrator privileges and execute the following query:</p><pre class="pre codeblock"><code>COL PARAMETER_NAME FORMAT a25
COL VALUE FORMAT a42
SELECT PARAMETER_NAME, PARAMETER_VALUE AS "VALUE"
FROM   DBA_ADVISOR_PARAMETERS
WHERE  ( (TASK_NAME = 'SYS_AUTO_SPM_EVOLVE_TASK') AND
         ( (PARAMETER_NAME = 'ACCEPT_PLANS') OR
           (PARAMETER_NAME LIKE '%ALT%') OR
           (PARAMETER_NAME = 'TIME_LIMIT') ) );</code></pre><p>Sample output appears as follows:</p><pre class="pre codeblock"><code>PARAMETER_NAME            VALUE
------------------------- ------------------------------------------
ALTERNATE_PLAN_LIMIT      0
ALTERNATE_PLAN_SOURCE     CURSOR_CACHE+AUTOMATIC_WORKLOAD_REPOSITORY
ALTERNATE_PLAN_BASELINE   EXISTING
ACCEPT_PLANS              true
TIME_LIMIT                3600
</code></pre></li>
                              <li>
                                 <p>Set parameters using PL/SQL code of the following form:</p><pre class="pre codeblock"><code>BEGIN
  DBMS_SPM.SET_EVOLVE_TASK_PARAMETER(
    task_name =&gt; 'SYS_AUTO_SPM_EVOLVE_TASK'
,   parameter =&gt; <span class="italic">parameter_name</span>
,   value     =&gt; <span class="italic">value</span>
);
END;
/
</code></pre><p>For example, the following PL/SQL block configures the <code class="codeph">SYS_AUTO_SPM_EVOLVE_TASK</code> task to automatically accept plans, seek up a maximum of 500 plans in the shared SQL area and AWR repository, and time out after 20 minutes:
                                 </p><pre class="pre codeblock"><code>BEGIN
  DBMS_SPM.SET_EVOLVE_TASK_PARAMETER(
    task_name =&gt; 'SYS_AUTO_SPM_EVOLVE_TASK'
,   parameter =&gt; 'TIME_LIMIT'
,   value     =&gt; '1200'
);
  DBMS_SPM.SET_EVOLVE_TASK_PARAMETER(
    task_name =&gt; 'SYS_AUTO_SPM_EVOLVE_TASK'
,   parameter =&gt; 'ACCEPT_PLANS'
,   value     =&gt; 'true'
);
  DBMS_SPM.SET_EVOLVE_TASK_PARAMETER(
    task_name =&gt; 'SYS_AUTO_SPM_EVOLVE_TASK'
,   parameter =&gt; 'ALTERNATE_PLAN_LIMIT'
,   value     =&gt; '500'
);
END;
/</code></pre></li>
                              <li>
                                 <p>Optionally, confirm your changes by querying the current parameter settings for <code class="codeph">SYS_AUTO_SPM_EVOLVE_TASK</code>.
                                 </p>
                                 <p>For example, execute the following query:</p><pre class="pre codeblock"><code>SELECT PARAMETER_NAME, PARAMETER_VALUE AS "VALUE"
FROM   DBA_ADVISOR_PARAMETERS
WHERE  ( (TASK_NAME = 'SYS_AUTO_SPM_EVOLVE_TASK') AND
         ( (PARAMETER_NAME = 'ACCEPT_PLANS') OR
           (PARAMETER_NAME LIKE '%ALT%') OR
           (PARAMETER_NAME = 'TIME_LIMIT') ) );</code></pre><p>Sample output appears as follows:</p><pre class="pre codeblock"><code>PARAMETER_NAME            VALUE
------------------------- ------------------------------------------
ALTERNATE_PLAN_LIMIT      500
ALTERNATE_PLAN_SOURCE     CURSOR_CACHE+AUTOMATIC_WORKLOAD_REPOSITORY
ALTERNATE_PLAN_BASELINE   EXISTING
ACCEPT_PLANS              true
TIME_LIMIT                1200
</code></pre></li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                        <div class="section"></div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="infoboxnotealso" id="GUID-541EBA4B-4F7D-42DD-A152-C06BDE69D828__GUID-B51E96A0-4EF1-4D3D-B525-EB72955EA06A">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tgsql&amp;id=ARPLS68398" target="_blank"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for complete reference information for <code class="codeph">DBMS_SPM.SET_EVOLVE_TASK_PARAMETER</code></p>
                              </li>
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tgsql&amp;id=GUID-B1D969D7-E8B6-4DEE-9B6D-0B9E9E66D764" target="_blank"><span><cite>Oracle Database Reference</cite></span></a> to learn more about the <code class="codeph">DBA_ADVISOR_PARAMETERS</code> view
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="managing-sql-plan-baselines.html#GUID-A94CFA49-910A-4237-A7BB-39BFA94E227E" title="SPM Evolve Advisor is a SQL advisor that evolves plans that have recently been added to the SQL plan baseline. The advisor simplifies plan evolution by eliminating the requirement to do it manually.">Managing the SPM Evolve Advisor Task</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div>
            </div><a id="TGSQL644"></a><a id="TGSQL643"></a><div class="props_rev_3"><a id="GUID-582BC3FB-2F52-4190-B807-16B79346B776" name="GUID-582BC3FB-2F52-4190-B807-16B79346B776"></a><h3 id="TGSQL-GUID-582BC3FB-2F52-4190-B807-16B79346B776" class="sect3"><span class="enumeration_section">28.3 </span>Displaying Plans in a SQL Plan Baseline
               </h3>
               <div>
                  <p>To view the plans stored in the SQL plan baseline for a specific statement, use the <code class="codeph">DBMS_XPLAN.DISPLAY_SQL_PLAN_BASELINE</code> function. This function uses plan information stored in the plan history to display the plans. 
                  </p>
                  <div class="section">
                     <p>The following table describes the relevant parameters for the <code class="codeph">DBMS_XPLAN.DISPLAY_SQL_PLAN_BASELINE</code> function.
                     </p>
                     <div class="tblformal" id="GUID-582BC3FB-2F52-4190-B807-16B79346B776__CDEBDFIH">
                        <p class="titleintable">Table 28-4 DBMS_XPLAN.DISPLAY_SQL_PLAN_BASELINE Parameters</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="DBMS_XPLAN.DISPLAY_SQL_PLAN_BASELINE Parameters" summary="This 2 column table lists the parameters for the DBMS_XPLAN.DISPLAY_SQL_PLAN_BASELINE function. Column 1 lists the parameters. Column 2 describes the parameters. " width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" id="d140998e3370">Function Parameter</th>
                                 <th align="left" valign="bottom" id="d140998e3373">Description</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d140998e3378" headers="d140998e3370 ">
                                    <p><code class="codeph">sql_handle</code></p>
                                 </td>
                                 <td align="left" valign="top" headers="d140998e3378 d140998e3373 ">
                                    <p>SQL handle of the statement. Retrieve the SQL handle by joining the <code class="codeph">V$SQL.SQL_PLAN_BASELINE</code> and <code class="codeph">DBA_SQL_PLAN_BASELINES</code> views on the <code class="codeph">PLAN_NAME</code> columns.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d140998e3395" headers="d140998e3370 ">
                                    <p><code class="codeph">plan_name</code></p>
                                 </td>
                                 <td align="left" valign="top" headers="d140998e3395 d140998e3373 ">
                                    <p>Name of the plan for the statement.</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p>This section explains how to show plans in a baseline from the command line. If you use Cloud Control, then display plan baselines from the SQL Plan Baseline subpage shown in <a href="managing-sql-plan-baselines.html#GUID-9BB06D27-4A3F-4DBA-A7EB-85B5C4EA0631__CDEBHHEI">Figure 28-1</a>.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-582BC3FB-2F52-4190-B807-16B79346B776__GUID-0CAE792D-BBCD-4489-B587-B4AC40260A35">To display plans in a SQL plan baselines:</p>
                     <ol>
                        <li>
                           <p>Connect SQL*Plus to the database with the appropriate privileges, and then obtain the SQL ID of the query whose plan you want to display.</p>
                           <p>For example, assume that a SQL plan baseline exists for a <code class="codeph">SELECT</code> statement with the SQL ID <code class="codeph">31d96zzzpcys9</code>.
                           </p>
                        </li>
                        <li>
                           <p>Query the plan by SQL ID.</p>
                           <p>The following query displays execution plans for the statement with the SQL ID <code class="codeph">31d96zzzpcys9</code>:
                           </p><pre class="pre codeblock"><code>SELECT PLAN_TABLE_OUTPUT
FROM   V$SQL s, DBA_SQL_PLAN_BASELINES b, 
       TABLE(
       DBMS_XPLAN.DISPLAY_SQL_PLAN_BASELINE(b.sql_handle,b.plan_name,'basic') 
       ) t
WHERE  s.EXACT_MATCHING_SIGNATURE=b.SIGNATURE
AND    b.PLAN_NAME=s.SQL_PLAN_BASELINE
AND    s.SQL_ID='<span class="bold">31d96zzzpcys9</span>';
</code></pre><p>The sample query results are as follows:</p><pre class="pre codeblock"><code>PLAN_TABLE_OUTPUT
---------------------------------------------------------------------------
 
---------------------------------------------------------------------------
SQL handle: SQL_513f7f8a91177b1a
SQL text: select * from hr.employees where employee_id=100
---------------------------------------------------------------------------

---------------------------------------------------------------------------
Plan name: SQL_PLAN_52gvzja8jfysuc0e983c6         Plan id: 3236529094
Enabled: YES     Fixed: NO      Accepted: YES     Origin: AUTO-CAPTURE
---------------------------------------------------------------------------
 
Plan hash value: 3236529094
 
-----------------------------------------------------
| Id  | Operation                   | Name          |
-----------------------------------------------------
|   0 | SELECT STATEMENT            |               |
|   1 |  TABLE ACCESS BY INDEX ROWID| EMPLOYEES     |
|   2 |   INDEX UNIQUE SCAN         | EMP_EMP_ID_PK |
-----------------------------------------------------
</code></pre><p>The results show that the plan for SQL ID <code class="codeph">31d96zzzpcys</code> is named <code class="codeph">SQL_PLAN_52gvzja8jfysuc0e983c6</code> and was captured automatically.
                           </p>
                        </li>
                     </ol>
                  </div>
                  <!-- class="section" -->
                  <div class="section"></div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-582BC3FB-2F52-4190-B807-16B79346B776__GUID-070BBDCB-D2D5-46AD-B348-8FCA11795DB6">
                     <p class="notep1">See Also:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><span class="q">"<a href="overview-of-sql-plan-management.html#GUID-EA548FAC-B350-4F31-96E9-8541AA8AC267" title="The SQL management base (SMB) is a logical repository in the data dictionary.">SQL Management Base</a>"</span></p>
                        </li>
                        <li>
                           <p><a href="../arpls/DBMS_XPLAN.html#ARPLS378" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> to learn about additional parameters used by the <code class="codeph">DISPLAY_SQL_PLAN_BASELINE</code> function
                           </p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="managing-sql-plan-baselines.html#GUID-7024369A-F98D-48E4-921C-C899485C954F" title="This chapter explains the concepts and tasks relating to SQL plan management using the DBMS_SPM package.">Managing SQL Plan Baselines</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="TGSQL645"></a><div class="props_rev_3"><a id="GUID-C6AC4856-3C8C-42D8-A7FD-629974E98D36" name="GUID-C6AC4856-3C8C-42D8-A7FD-629974E98D36"></a><h3 id="TGSQL-GUID-C6AC4856-3C8C-42D8-A7FD-629974E98D36" class="sect3"><span class="enumeration_section">28.4 </span>Loading SQL Plan Baselines
               </h3>
               <div>
                  <p>Using <code class="codeph">DBMS_SPM</code>, you can initiate the bulk load of a set of existing plans into a SQL plan baseline. 
                  </p>
                  <p>This section contains the following topics:</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="managing-sql-plan-baselines.html#GUID-16A42019-4CAB-44F1-8F07-48BAE2B58A99">About Loading SQL Plan Baselines</a><br>The <code class="codeph">DBMS_SPM</code> package enables you to load plans from multiple sources.
                     </li>
                     <li class="ulchildlink"><a href="managing-sql-plan-baselines.html#GUID-42801E63-0BEE-4F81-B0D5-CCF006D891F4">Loading Plans from AWR</a><br>This topic explains how to load plans from AWR using PL/SQL.
                     </li>
                     <li class="ulchildlink"><a href="managing-sql-plan-baselines.html#GUID-C7C5AEF7-5833-4780-81CF-C40CE6B43571">Loading Plans from the Shared SQL Area</a><br>This topic explains how to load plans from the shared SQL area, also called the cursor cache, using PL/SQL.
                     </li>
                     <li class="ulchildlink"><a href="managing-sql-plan-baselines.html#GUID-93DCD1D7-DCAA-4135-97B3-6CDAB37AC73B">Loading Plans from a SQL Tuning Set</a><br>A <strong class="term">SQL tuning set</strong> (STS) is a database object that includes one or more SQL statements, execution statistics, and execution context. This topic explains how to load plans from an STS.
                     </li>
                     <li class="ulchildlink"><a href="managing-sql-plan-baselines.html#GUID-406BA5D3-29DE-4AF7-B5D2-8B488297023F">Loading Plans from a Staging Table</a><br>You may want to transfer optimal plans from a source database to a different destination database. 
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="managing-sql-plan-baselines.html#GUID-7024369A-F98D-48E4-921C-C899485C954F" title="This chapter explains the concepts and tasks relating to SQL plan management using the DBMS_SPM package.">Managing SQL Plan Baselines</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="sect3"><a id="GUID-16A42019-4CAB-44F1-8F07-48BAE2B58A99" name="GUID-16A42019-4CAB-44F1-8F07-48BAE2B58A99"></a><h4 id="TGSQL-GUID-16A42019-4CAB-44F1-8F07-48BAE2B58A99" class="sect4"><span class="enumeration_section">28.4.1 </span>About Loading SQL Plan Baselines
                  </h4>
                  <div>
                     <p>The <code class="codeph">DBMS_SPM</code> package enables you to load plans from multiple sources.
                     </p>
                     <p>The goal of this task is to load plans from the following sources:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>AWR</p>
                           <p>Load plans from Automatic Workload Repository (AWR) snapshots. You must specify the beginning and ending of the snapshot range. Optionally, you can apply a filter to load only plan that meet specified criteria. By default, the optimizer uses the loaded plans the next time that the database executes the SQL statements.</p>
                        </li>
                        <li>
                           <p>Shared SQL area</p>
                           <p>Load plans for statements directly from the shared SQL area, which is in the shared pool of the SGA. By applying a filter on the module name, the schema, or the SQL ID you identify the SQL statement or set of SQL statements to capture. The optimizer uses the plans the next time that the database executes the SQL statements.</p>
                           <p>Loading plans directly from the shared SQL area is useful when application SQL has been hand-tuned using hints. Because you probably cannot change the SQL to include the hint, populating the SQL plan baseline ensures that the application SQL uses optimal plans.</p>
                        </li>
                        <li>
                           <p>SQL tuning set (STS)</p>
                           <p>Capture the plans for a SQL workload into an STS, and then load the plans into the SQL plan baselines. The optimizer uses the plans the next time that the database executes the SQL statements. Bulk loading execution plans from an STS is an effective way to prevent plan regressions after a database upgrade.</p>
                        </li>
                        <li>
                           <p>Staging table</p>
                           <p>Use the <code class="codeph">DBMS_SPM</code> package to define a staging table, <code class="codeph">DBMS_SPM.PACK_STGTAB_BASELINE</code> to copy the baselines into a staging table, and Oracle Data Pump to transfer the table to another database. On the destination database, use <code class="codeph">DBMS_SPM.UNPACK_STGTAB_BASELINE</code> to unpack the plans from the staging table and put the baselines into the SMB.
                           </p>
                           <p>A use case is the introduction of new SQL statements into the database from a new application module. A vendor can ship application software with SQL plan baselines for the new SQL. In this way, the new SQL uses plans that are known to give optimal performance under a standard test configuration. Alternatively, if you develop or test an application in-house, export the correct plans from the test database and import them into the production database.</p>
                        </li>
                        <li>
                           <p>Stored outline</p>
                           <p>Migrate stored outlines to SQL plan baselines. After the migration, you maintain the same plan stability that you had using stored outlines while being able to use the more advanced features provided by SQL Plan Management, such as plan evolution. See .</p>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-16A42019-4CAB-44F1-8F07-48BAE2B58A99__GUID-56F756F7-B664-4BDA-A5AE-8FA41F3842F3">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><span class="q">"<a href="migrating-stored-outlines.html#GUID-E1CBB4DA-2F83-4F4D-845B-CAAA8333DF1A" title="Stored outline migration is the user-initiated process of converting stored outlines to SQL plan baselines. A SQL plan baseline is a set of plans proven to provide optimal performance.">Migrating Stored Outlines to SQL Plan Baselines</a>"</span></p>
                           </li>
                           <li>
                              <p><a href="../arpls/DBMS_SPM.html#ARPLS68172" target="_blank"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> to learn about the <code class="codeph">DBMS_SPM.PACK_STGTAB_BASELINE</code> Function
                              </p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-sql-plan-baselines.html#GUID-C6AC4856-3C8C-42D8-A7FD-629974E98D36" title="Using DBMS_SPM, you can initiate the bulk load of a set of existing plans into a SQL plan baseline.">Loading SQL Plan Baselines</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="props_rev_3"><a id="GUID-42801E63-0BEE-4F81-B0D5-CCF006D891F4" name="GUID-42801E63-0BEE-4F81-B0D5-CCF006D891F4"></a><h4 id="TGSQL-GUID-42801E63-0BEE-4F81-B0D5-CCF006D891F4" class="sect4"><span class="enumeration_section">28.4.2 </span>Loading Plans from AWR
                  </h4>
                  <div>
                     <p>This topic explains how to load plans from AWR using PL/SQL.</p>
                     <div class="section">
                        <p>Load plans with the <code class="codeph">LOAD_PLANS_FROM_AWR</code> function of the <code class="codeph">DBMS_SPM</code> package. The following table describes some function parameters.
                        </p>
                        <div class="tblformal" id="GUID-42801E63-0BEE-4F81-B0D5-CCF006D891F4__CDEJCBCC">
                           <p class="titleintable">Table 28-5 LOAD_PLANS_FROM_AWR Parameters</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="LOAD_PLANS_FROM_AWR Parameters" summary="This 2 column table describes LOAD_PLANS_FROM_AWR function parameters. Column 1 is the function parameter. Column 2 describes that column. " width="100%" frame="hsides" border="1" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" id="d140998e3966">Function Parameter</th>
                                    <th align="left" valign="bottom" id="d140998e3969">Description</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" id="d140998e3974" headers="d140998e3966 ">
                                       <p><code class="codeph">begin_snap</code></p>
                                    </td>
                                    <td align="left" valign="top" headers="d140998e3974 d140998e3969 ">
                                       <p>Number of the beginning snapshot in the range. Required.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" id="d140998e3982" headers="d140998e3966 ">
                                       <p><code class="codeph">end_snap</code></p>
                                    </td>
                                    <td align="left" valign="top" headers="d140998e3982 d140998e3969 ">
                                       <p>Number of the ending snapshot in the range. Required.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" id="d140998e3990" headers="d140998e3966 ">
                                       <p><code class="codeph">basic_filter</code></p>
                                    </td>
                                    <td align="left" valign="top" headers="d140998e3990 d140998e3969 ">
                                       <p>A filter applied to AWR to select only qualifying plans to be loaded. The default null means that all plans in AWR are selected. The filter can take the form of any <code class="codeph">WHERE</code> clause predicate that can be specified against the column <code class="codeph">DBA_HIST_SQLTEXT.SQL_TEXT</code>. An example is <code class="codeph">basic_filter =&gt; 'sql_text like ''SELECT /*LOAD_STS*/%'''</code>.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" id="d140998e4007" headers="d140998e3966 ">
                                       <p><code class="codeph">fixed</code> 
                                       </p>
                                    </td>
                                    <td align="left" valign="top" headers="d140998e4007 d140998e3969 ">
                                       <p>Default <code class="codeph">NO</code> means the loaded plans are used as nonfixed plans. <code class="codeph">YES</code> means the loaded plans are fixed plans. <span class="q">"<a href="overview-of-sql-plan-management.html#GUID-67A76171-62CB-49A5-B5BD-CFFE26511E90" title="SQL plan selection is the optimizer ability to detect plan changes based on stored plan history, and the use of SQL plan baselines to select plans to avoid potential performance regressions.">Plan Selection</a>"</span> explains that the optimizer chooses a fixed plan in the plan baseline over a nonfixed plan.
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                        <p>This section explains how to load plans using the command line. In Cloud Control, go to the SQL Plan Baseline subpage (shown in <a href="managing-sql-plan-baselines.html#GUID-9BB06D27-4A3F-4DBA-A7EB-85B5C4EA0631__CDEBHHEI">Figure 28-1</a>) and click <span class="bold">Load</span> to load plan baselines from AWR.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="p">
                        <p>This tutorial assumes the following:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>You want to load plans for the following query into the SMB:</p><pre class="pre codeblock"><code>SELECT /*LOAD_AWR*/ *
FROM   sh.sales
WHERE  quantity_sold &gt; 40
ORDER BY prod_id;
</code></pre></li>
                           <li>
                              <p>You want the loaded plans to be nonfixed.</p>
                           </li>
                           <li>
                              <p>The user <code class="codeph">sh</code> has privileges to query <code class="codeph">DBA_HIST_SNAPSHOT</code> and <code class="codeph">DBA_SQL_PLAN_BASELINES</code>, execute <code class="codeph">DBMS_WORKLOAD_REPOSITORY.CREATE_SNAPSHOT</code>, and execute <code class="codeph">DBMS_SPM.LOAD_PLANS_FROM_AWR</code>.
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-42801E63-0BEE-4F81-B0D5-CCF006D891F4__GUID-E9DB1607-25F9-483D-8A9B-30573954E5CB">To load plans from the shared SQL area:</p>
                        <ol>
                           <li>
                              <p>Log in to the database with the appropriate privileges, and then query the most recent 3 AWR snapshots.</p>
                              <p>For example, query <code class="codeph">DBA_HIST_SNAPSHOT</code> as follows:
                              </p><pre class="pre codeblock"><code>SELECT *
FROM   (SELECT SNAP_ID, SNAP_LEVEL, 
               TO_CHAR(BEGIN_INTERVAL_TIME, 'DD/MM/YY HH24:MI:SS') BEGIN
        FROM   DBA_HIST_SNAPSHOT
        ORDER BY SNAP_ID DESC)
WHERE   ROWNUM &lt;= 3;

   SNAP_ID SNAP_LEVEL BEGIN
---------- ---------- -----------------
       212	    1 10/12/15 06:00:02
       211	    1 10/12/15 05:00:11
       210	    1 10/12/15 04:00:59
</code></pre></li>
                           <li>
                              <p>Query <code class="codeph">sh.sales</code>, using the <code class="codeph">LOAD_AWR</code> tag to identify the SQL statement.
                              </p>
                              <p>For example, use the following query:</p><pre class="pre codeblock"><code>SELECT /*LOAD_AWR*/ *
FROM   sh.sales
WHERE  quantity_sold &gt; 40
ORDER BY prod_id;
</code></pre></li>
                           <li>
                              <p>Take a new AWR snapshot.</p>
                              <p>For example, use the following program:</p><pre class="pre codeblock"><code>EXEC DBMS_WORKLOAD_REPOSITORY.CREATE_SNAPSHOT;</code></pre></li>
                           <li>
                              <p>Query the most recent 3 AWR snapshots to confirm that a new snapshot was taken.</p>
                              <p>For example, query <code class="codeph">DBA_HIST_SNAPSHOT</code> as follows:
                              </p><pre class="pre codeblock"><code>SELECT *
FROM   (SELECT SNAP_ID, SNAP_LEVEL, 
               TO_CHAR(BEGIN_INTERVAL_TIME, 'DD/MM/YY HH24:MI:SS') BEGIN
        FROM   DBA_HIST_SNAPSHOT
        ORDER BY SNAP_ID DESC)
WHERE   ROWNUM &lt;= 3;

   SNAP_ID SNAP_LEVEL BEGIN
---------- ---------- -----------------
       213	    1 10/12/15 06:24:53
       212	    1 10/12/15 06:00:02
       211	    1 10/12/15 05:00:11</code></pre></li>
                           <li>
                              <p>Load the plans for the most recent 2 snapshots from AWR.</p>
                              <p>For example, execute the <code class="codeph">LOAD_PLANS_FROM_AWR</code> function in SQL*Plus to load the plans from snapshot <code class="codeph">212</code> to <code class="codeph">213</code>:
                              </p><pre class="pre codeblock"><code>VARIABLE v_plan_cnt NUMBER
EXEC :v_plan_cnt := DBMS_SPM.LOAD_PLANS_FROM_AWR(begin_snap =&gt; 212, end_snap =&gt; 213);</code></pre><p>In the preceding example, the variable <code class="codeph">v_plan_cnt</code> contains the number of plans that were loaded.
                              </p>
                           </li>
                           <li>
                              <p>Query the data dictionary to ensure that the plans were loaded into the baseline for the <code class="codeph">LOAD_AWR</code> statement.
                              </p>
                              <p>The following statement queries <code class="codeph">DBA_SQL_PLAN_BASELINES</code> (sample output included):
                              </p><pre class="pre codeblock"><code>COL SQL_HANDLE FORMAT a20
COL SQL_TEXT FORMAT a20
COL PLAN_NAME FORMAT a30
COL ORIGIN FORMAT a20

SELECT SQL_HANDLE, SQL_TEXT, PLAN_NAME,
       ORIGIN, ENABLED, ACCEPTED
FROM   DBA_SQL_PLAN_BASELINES
WHERE SQL_TEXT LIKE '%LOAD_AWR%';

SQL_HANDLE           SQL_TEXT          PLAN_NAME                      ORIGIN               ENA ACC
-------------------- ----------------- ------------------------------ -------------------- --- ---
SQL_495d29c5f4612cda SELECT /*LOAD_AWR SQL_PLAN_4kr99sru62b6u54bc8843 MANUAL-LOAD-FROM-AWR YES YES
                     */ * FROM 
                     sh.sales WHERE  
                     quantity_sold 
                     &gt; 40
                     ORDER BY prod_id</code></pre><p>The output shows that the plan is accepted, which means that it is in the plan baseline for the statement. Also, the origin is <code class="codeph">MANUAL-LOAD-FROM-AWR</code>, which means that the statement was loaded manually from AWR rather than automatically captured.
                              </p>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-42801E63-0BEE-4F81-B0D5-CCF006D891F4__GUID-00BA708C-2663-44E3-811D-3F31AD82EF76">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p> <span class="q">"<a href="overview-of-sql-plan-management.html#GUID-B51FBAA9-EE95-4F19-AD4B-F5F4C2910688" title="A fixed plan is an accepted plan that is marked as preferred, so that the optimizer considers only the fixed plans in the baseline. Fixed plans influence the plan selection process of the optimizer.">Fixed Plans</a>"</span></p>
                           </li>
                           <li>
                              <p><a href="../arpls/DBMS_SPM.html#ARPLS150" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> to learn how to use the <code class="codeph">DBMS_SPM.LOAD_PLANS_FROM_AWR</code> function
                              </p>
                           </li>
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tgsql&amp;id=REFRN23714" target="_blank"><span><cite>Oracle Database Reference</cite></span></a> to learn more about the <code class="codeph">DBA_SQL_PLAN_BASELINES</code> view
                              </p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-sql-plan-baselines.html#GUID-C6AC4856-3C8C-42D8-A7FD-629974E98D36" title="Using DBMS_SPM, you can initiate the bulk load of a set of existing plans into a SQL plan baseline.">Loading SQL Plan Baselines</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TGSQL650"></a><a id="TGSQL94971"></a><a id="TGSQL651"></a><a id="TGSQL649"></a><div class="props_rev_3"><a id="GUID-C7C5AEF7-5833-4780-81CF-C40CE6B43571" name="GUID-C7C5AEF7-5833-4780-81CF-C40CE6B43571"></a><h4 id="TGSQL-GUID-C7C5AEF7-5833-4780-81CF-C40CE6B43571" class="sect4"><span class="enumeration_section">28.4.3 </span>Loading Plans from the Shared SQL Area
                  </h4>
                  <div>
                     <p>This topic explains how to load plans from the shared SQL area, also called the cursor cache, using PL/SQL.</p>
                     <div class="section">
                        <p>Load plans with the <code class="codeph">LOAD_PLANS_FROM_CURSOR_CACHE</code> function of the <code class="codeph">DBMS_SPM</code> package. The following table describes some function parameters.
                        </p>
                        <div class="tblformal" id="GUID-C7C5AEF7-5833-4780-81CF-C40CE6B43571__CDEJCBCC">
                           <p class="titleintable">Table 28-6 LOAD_PLANS_FROM_CURSOR_CACHE Parameters</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="LOAD_PLANS_FROM_CURSOR_CACHE Parameters" summary="This 2 column table describes LOAD_PLANS_FROM_CURSOR_CACHE function parameters. Column 1 is the parameter. Column 2 describes that parameter. " width="100%" frame="hsides" border="1" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" id="d140998e4328">Function Parameter</th>
                                    <th align="left" valign="bottom" id="d140998e4331">Description</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" id="d140998e4336" headers="d140998e4328 ">
                                       <p><code class="codeph">sql_id</code></p>
                                    </td>
                                    <td align="left" valign="top" headers="d140998e4336 d140998e4331 ">
                                       <p>SQL statement identifier. Identifies a SQL statement in the shared SQL area.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" id="d140998e4344" headers="d140998e4328 ">
                                       <p><code class="codeph">fixed</code> 
                                       </p>
                                    </td>
                                    <td align="left" valign="top" headers="d140998e4344 d140998e4331 ">
                                       <p>Default <code class="codeph">NO</code> means the loaded plans are used as nonfixed plans. <code class="codeph">YES</code> means the loaded plans are fixed plans. <span class="q">"<a href="overview-of-sql-plan-management.html#GUID-67A76171-62CB-49A5-B5BD-CFFE26511E90" title="SQL plan selection is the optimizer ability to detect plan changes based on stored plan history, and the use of SQL plan baselines to select plans to avoid potential performance regressions.">Plan Selection</a>"</span> explains that the optimizer chooses a fixed plan in the plan baseline over a nonfixed plan.
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                        <p>This section explains how to load plans using the command line. In Cloud Control, go to the SQL Plan Baseline subpage (shown in <a href="managing-sql-plan-baselines.html#GUID-9BB06D27-4A3F-4DBA-A7EB-85B5C4EA0631__CDEBHHEI">Figure 28-1</a>) and click <span class="bold">Load</span> to load plan baselines from the shared SQL area.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="p">
                        <p>This tutorial assumes the following:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>You have executed the following query:</p><pre class="pre codeblock"><code>SELECT /*LOAD_CC*/ *
FROM   sh.sales
WHERE  quantity_sold &gt; 40
ORDER BY prod_id;
</code></pre></li>
                           <li>
                              <p>You want the loaded plans to be nonfixed.</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-C7C5AEF7-5833-4780-81CF-C40CE6B43571__GUID-E9DB1607-25F9-483D-8A9B-30573954E5CB">To load plans from the shared SQL area:</p>
                        <ol>
                           <li>
                              <p>Connect SQL*Plus to the database with the appropriate privileges, and then determine the SQL IDs of the relevant statements in the shared SQL area.</p>
                              <p>For example, query <code class="codeph">V$SQL</code> for the SQL ID of the <code class="codeph">sh.sales</code> query (sample output included):
                              </p><pre class="pre codeblock"><code>SELECT   SQL_ID, CHILD_NUMBER AS "Child Num",
         PLAN_HASH_VALUE AS "Plan Hash",
         OPTIMIZER_ENV_HASH_VALUE AS "Opt Env Hash"
FROM     V$SQL
WHERE    SQL_TEXT LIKE 'SELECT /*LOAD_CC*/%';
 
SQL_ID         Child Num  Plan Hash Opt Env Hash
------------- ---------- ---------- ------------
27m0sdw9snw59          0 1421641795   3160571937
</code></pre><p>The preceding output shows that the SQL ID of the statement is <code class="codeph">27m0sdw9snw59</code>.
                              </p>
                           </li>
                           <li>
                              <p>Load the plans for the specified statements into the SQL plan baseline.</p>
                              <p>For example, execute the <code class="codeph">LOAD_PLANS_FROM_CURSOR_CACHE</code> function in SQL*Plus to load the plan for the statement with the SQL ID <code class="codeph">27m0sdw9snw59</code>:
                              </p><pre class="pre codeblock"><code>VARIABLE v_plan_cnt NUMBER
EXECUTE :v_plan_cnt := DBMS_SPM.LOAD_PLANS_FROM_CURSOR_CACHE(sql_id =&gt; '27m0sdw9snw59');
</code></pre><p>In the preceding example, the variable <code class="codeph">v_plan_cnt</code> contains the number of plans that were loaded.
                              </p>
                           </li>
                           <li>
                              <p>Query the data dictionary to ensure that the plans were loaded into the baseline for the statement.</p>
                              <p>The following statement queries <code class="codeph">DBA_SQL_PLAN_BASELINES</code> (sample output included):
                              </p><pre class="pre codeblock"><code>SELECT SQL_HANDLE, SQL_TEXT, PLAN_NAME,
       ORIGIN, ENABLED, ACCEPTED
FROM   DBA_SQL_PLAN_BASELINES;
 
SQL_HANDLE            SQL_TEXT             PLAN_NAME             ORIGIN              ENA ACC
--------------------- -------------------- --------------------- ------------------- --- ---
SQL_a8632bd857a4a25e  SELECT /*LOAD_CC*/   SQL_PLAN_gdkvzfhrgkda MANUAL-LOAD-FROM-CC YES YES
                      *                    71694fc6b
                      FROM sh.sales
                      WHERE quantity_sold
                      &gt; 40                           
                      ORDER BY prod_id</code></pre><p>The output shows that the plan is accepted, which means that it is in the plan baseline for the statement. Also, the origin is <code class="codeph">MANUAL-LOAD-FROM-CC</code>, which means that the statement was loaded manually from the shared SQL area rather than automatically captured.
                              </p>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-C7C5AEF7-5833-4780-81CF-C40CE6B43571__GUID-00BA708C-2663-44E3-811D-3F31AD82EF76">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><span class="q">"<a href="overview-of-sql-plan-management.html#GUID-B51FBAA9-EE95-4F19-AD4B-F5F4C2910688" title="A fixed plan is an accepted plan that is marked as preferred, so that the optimizer considers only the fixed plans in the baseline. Fixed plans influence the plan selection process of the optimizer.">Fixed Plans</a>"</span></p>
                           </li>
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tgsql&amp;id=ARPLS150" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> to learn how to use the <code class="codeph">DBMS_SPM.LOAD_PLANS_FROM_CURSOR_CACHE</code> function
                              </p>
                           </li>
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tgsql&amp;id=REFRN23714" target="_blank"><span><cite>Oracle Database Reference</cite></span></a> to learn more about the <code class="codeph">DBA_SQL_PLAN_BASELINES</code> view
                              </p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-sql-plan-baselines.html#GUID-C6AC4856-3C8C-42D8-A7FD-629974E98D36" title="Using DBMS_SPM, you can initiate the bulk load of a set of existing plans into a SQL plan baseline.">Loading SQL Plan Baselines</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TGSQL647"></a><a id="TGSQL94970"></a><a id="TGSQL648"></a><a id="TGSQL646"></a><div class="props_rev_3"><a id="GUID-93DCD1D7-DCAA-4135-97B3-6CDAB37AC73B" name="GUID-93DCD1D7-DCAA-4135-97B3-6CDAB37AC73B"></a><h4 id="TGSQL-GUID-93DCD1D7-DCAA-4135-97B3-6CDAB37AC73B" class="sect4"><span class="enumeration_section">28.4.4 </span>Loading Plans from a SQL Tuning Set 
                  </h4>
                  <div>
                     <p>A <strong class="term">SQL tuning set</strong> (STS) is a database object that includes one or more SQL statements, execution statistics, and execution context. This topic explains how to load plans from an STS.
                     </p>
                     <div class="section">
                        <p>Load plans with the <code class="codeph">DBMS_SPM.LOAD_PLANS_FROM_SQLSET</code> function or using Cloud Control. The following table describes some function parameters.
                        </p>
                        <div class="tblformal" id="GUID-93DCD1D7-DCAA-4135-97B3-6CDAB37AC73B__CDEGJHGG">
                           <p class="titleintable">Table 28-7 LOAD_PLANS_FROM_SQLSET Parameters</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="LOAD_PLANS_FROM_SQLSET Parameters" summary="This 2 column table lists the parameters for DBMS_SPM.LOAD_PLANS_FROM_SQLSET. Column 1 is the parameter. Column 2 describes that parameter." width="100%" frame="hsides" border="1" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="20%" id="d140998e4622">Function Parameter</th>
                                    <th align="left" valign="bottom" width="80%" id="d140998e4625">Description</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d140998e4630" headers="d140998e4622 ">
                                       <p><code class="codeph">sqlset_name</code></p>
                                    </td>
                                    <td align="left" valign="top" width="80%" headers="d140998e4630 d140998e4625 ">
                                       <p>Name of the STS from which the plans are loaded into SQL plan baselines.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d140998e4638" headers="d140998e4622 ">
                                       <p><code class="codeph">basic_filter</code></p>
                                    </td>
                                    <td align="left" valign="top" width="80%" headers="d140998e4638 d140998e4625 ">
                                       <p>A filter applied to the STS to select only qualifying plans to be loaded. The filter can take the form of any <code class="codeph">WHERE</code> clause predicate that can be specified against the view <code class="codeph">DBA_SQLSET_STATEMENTS</code>. An example is <code class="codeph">basic_filter =&gt; 'sql_text like ''SELECT /*LOAD_STS*/%'''</code>.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d140998e4655" headers="d140998e4622 ">
                                       <p><code class="codeph">fixed</code> 
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="80%" headers="d140998e4655 d140998e4625 ">
                                       <p>Default <code class="codeph">NO</code> means the loaded plans are used as nonfixed plans. <code class="codeph">YES</code> means the loaded plans are fixed plans. <span class="q">"<a href="overview-of-sql-plan-management.html#GUID-67A76171-62CB-49A5-B5BD-CFFE26511E90" title="SQL plan selection is the optimizer ability to detect plan changes based on stored plan history, and the use of SQL plan baselines to select plans to avoid potential performance regressions.">Plan Selection</a>"</span> explains that the optimizer chooses a fixed plan in the plan baseline over a nonfixed plan.
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                        <p>This section explains how to load plans from the command line. In Cloud Control, go to the SQL Plan Baseline subpage (shown in <a href="managing-sql-plan-baselines.html#GUID-9BB06D27-4A3F-4DBA-A7EB-85B5C4EA0631__CDEBHHEI">Figure 28-1</a>) and click <span class="bold">Load</span> to load plan baselines from SQL tuning sets.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-93DCD1D7-DCAA-4135-97B3-6CDAB37AC73B__GUID-C8BF29AC-C2CB-43BD-B65A-3E280900BB62">Assumptions</p>
                        <p>This tutorial assumes the following:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>You want the loaded plans to be nonfixed.</p>
                           </li>
                           <li>
                              <p>You have executed the following query:</p><pre class="pre codeblock"><code>SELECT /*LOAD_STS*/ *
FROM   sh.sales
WHERE  quantity_sold &gt; 40
ORDER BY prod_id;
</code></pre></li>
                           <li>
                              <p>You have loaded the plan from the shared SQL area into the SQL tuning set named <code class="codeph">SPM_STS</code>, which is owned by user <code class="codeph">SPM</code>.
                              </p>
                           </li>
                           <li>
                              <p>After the operation, you want to drop the STS using <code class="codeph">DBMS_SQLTUNE.DROP_SQLSET</code> rather than the equivalent D<code class="codeph">BMS_SQLSET.DROP_SQLSET</code>.
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-93DCD1D7-DCAA-4135-97B3-6CDAB37AC73B__GUID-75217461-205E-4793-8975-216E157DFA11">To load plans from a SQL tuning set:</p>
                        <ol>
                           <li>
                              <p>Connect SQL*Plus to the database with the appropriate privileges, and then verify which plans are in the SQL tuning set.</p>
                              <p>For example, query <code class="codeph">DBA_SQLSET_STATEMENTS</code> for the STS name (sample output included):
                              </p><pre class="pre codeblock"><code>SELECT SQL_TEXT
FROM   DBA_SQLSET_STATEMENTS
WHERE  SQLSET_NAME = 'SPM_STS';
 
SQL_TEXT
--------------------
SELECT /*LOAD_STS*/
*
FROM sh.sales
WHERE quantity_sold
&gt; 40
ORDER BY prod_id
</code></pre><p>The output shows that the plan for the <code class="codeph">select /*LOAD_STS*/</code> statement is in the STS.
                              </p>
                           </li>
                           <li>
                              <p>Load the plan from the STS into the SQL plan baseline.</p>
                              <p>For example, in SQL*Plus execute the function as follows:</p><pre class="pre codeblock"><code>VARIABLE v_plan_cnt NUMBER
EXECUTE :v_plan_cnt := DBMS_SPM.LOAD_PLANS_FROM_SQLSET( -
           sqlset_name  =&gt; 'SPM_STS', -
           basic_filter =&gt; 'sql_text like ''SELECT /*LOAD_STS*/%''' );
</code></pre><p>The <code class="codeph">basic_filter</code> parameter specifies a <code class="codeph">WHERE</code> clause that loads only the plans for the queries of interest. The variable <code class="codeph">v_plan_cnt</code> stores the number of plans loaded from the STS.
                              </p>
                           </li>
                           <li>
                              <p>Query the data dictionary to ensure that the plan was loaded into the baseline for the statement.</p>
                              <p> The following statement queries the <code class="codeph">DBA_SQL_PLAN_BASELINES</code> view (sample output included).
                              </p><pre class="pre codeblock"><code>SQL&gt; SELECT SQL_HANDLE, SQL_TEXT, PLAN_NAME,
  2         ORIGIN, ENABLED, ACCEPTED
  3  FROM   DBA_SQL_PLAN_BASELINES;

SQL_HANDLE            SQL_TEXT        PLAN_NAME        ORIGIN               ENA ACC
--------------------- --------------- ---------------- -------------------- --- ---
SQL_a8632bd857a4a25e  SELECT          SQL_PLAN_ahstb   MANUAL-LOAD-FROM-STS YES <span class="bold">YES</span>
                      /*LOAD_STS*/*   v1bu98ky1694fc6b
                      FROM sh.sales
                      WHERE 
                      quantity_sold 
                      &gt; 40 ORDER BY                    
                      prod_id</code></pre><p>The output shows that the plan is accepted, which means that it is in the plan baseline. Also, the origin is <code class="codeph">MANUAL-LOAD-FROM-STS</code>, which means that the plan was loaded manually from a SQL tuning set rather than automatically captured.
                              </p>
                           </li>
                           <li>
                              <p>Optionally, drop the STS.</p>
                              <p>For example, execute <code class="codeph">DBMS_SQLTUNE.DROP_SQLSET</code> to drop the <code class="codeph">SPM_STS</code> tuning set as follows:
                              </p><pre class="pre codeblock"><code>EXEC SYS.DBMS_SQLTUNE.DROP_SQLSET( sqlset_name  =&gt; 'SPM_STS', -
                                   sqlset_owner =&gt; 'SPM' );</code></pre></li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-93DCD1D7-DCAA-4135-97B3-6CDAB37AC73B__GUID-7813B9D9-DB9B-4CA6-B67A-872196B369CD">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><span class="q">"<a href="managing-sql-tuning-sets.html#GUID-236DF69A-6370-4A56-9BF1-384C7CB865B1" title="On the command line, you can use the DBMS_SQLTUNE or DBMS_SQLSET packages to manage SQL tuning sets.">Command-Line Interface to SQL Tuning Sets</a>"</span></p>
                           </li>
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tgsql&amp;id=REFRN23470" target="_blank"><span><cite>Oracle Database Reference</cite></span></a> to learn about the <code class="codeph">DBA_SQL_PLAN_BASELINES</code> view
                              </p>
                           </li>
                           <li>
                              <p><a href="../arpls/DBMS_SPM.html#ARPLS68170" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> to learn about the <code class="codeph">DBMS_SPM.LOAD_PLANS_FROM_SQLSET</code> function
                              </p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-sql-plan-baselines.html#GUID-C6AC4856-3C8C-42D8-A7FD-629974E98D36" title="Using DBMS_SPM, you can initiate the bulk load of a set of existing plans into a SQL plan baseline.">Loading SQL Plan Baselines</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TGSQL94972"></a><a id="TGSQL652"></a><div class="props_rev_3"><a id="GUID-406BA5D3-29DE-4AF7-B5D2-8B488297023F" name="GUID-406BA5D3-29DE-4AF7-B5D2-8B488297023F"></a><h4 id="TGSQL-GUID-406BA5D3-29DE-4AF7-B5D2-8B488297023F" class="sect4"><span class="enumeration_section">28.4.5 </span>Loading Plans from a Staging Table
                  </h4>
                  <div>
                     <p>You may want to transfer optimal plans from a source database to a different destination database. </p>
                     <div class="section">
                        <p>For example, you may have investigated a set of plans on a test database and confirmed that they have performed well. You may then want to load these plans into a production database.</p>
                        <p>A staging table is a table that, for the duration of its existence, stores plans so that the plans do not disappear from the table while you are unpacking them. Use the <code class="codeph">DBMS_SPM.CREATE_STGTAB_BASELINE</code> procedure to create a staging table. To pack (insert row into) and unpack (extract rows from) the staging table, use the <code class="codeph">PACK_STGTAB_BASELINE</code> and <code class="codeph">UNPACK_STGTAB_BASELINE</code> functions of the <code class="codeph">DBMS_SPM</code> package. Oracle Data Pump Import and Export enable you to copy the staging table to a different database.
                        </p>
                        <div class="figure" id="GUID-406BA5D3-29DE-4AF7-B5D2-8B488297023F__GUID-FFFE50DB-912E-4A75-AF90-8944A1C9CAE5">
                           <p class="titleinfigure">Figure 28-3 Loading Plans from a Staging Table</p><img src="img/tgsql_vm_006.png" alt="Description of Figure 28-3 follows" title="Description of Figure 28-3 follows" longdesc="img_text/tgsql_vm_006.html"><br><a href="img_text/tgsql_vm_006.html">Description of "Figure 28-3 Loading Plans from a Staging Table"</a></div>
                        <!-- class="figure" -->
                        <p>Export plans with the <code class="codeph">PACK_STGTAB_BASELINE</code> function of the <code class="codeph">DBMS_SPM</code> package, and then import them with <code class="codeph">UNPACK_STGTAB_BASELINE</code>. The following table describes some function parameters.
                        </p>
                        <div class="tblformal" id="GUID-406BA5D3-29DE-4AF7-B5D2-8B488297023F__CDEJCBCC">
                           <p class="titleintable">Table 28-8 PACK_STGTAB_BASELINE and UNPACK_STGTAB_BASELINE Parameters</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="PACK_STGTAB_BASELINE and UNPACK_STGTAB_BASELINE Parameters" summary="This 2 column table describes function parameters. Column 1 is the function parameter, Column 2 is a description. " width="100%" frame="hsides" border="1" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" id="d140998e4987">Function Parameter</th>
                                    <th align="left" valign="bottom" id="d140998e4990">Description</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" id="d140998e4995" headers="d140998e4987 ">
                                       <p><code class="codeph">table_name</code></p>
                                    </td>
                                    <td align="left" valign="top" headers="d140998e4995 d140998e4990 ">
                                       <p>Specifies the table to be imported or exported.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" id="d140998e5003" headers="d140998e4987 ">
                                       <p><code class="codeph">origin</code> 
                                       </p>
                                    </td>
                                    <td align="left" valign="top" headers="d140998e5003 d140998e4990 ">
                                       <p>Origin of SQL plan baseline. These procedures accept all possible values of <code class="codeph">DBA_SQL_PLAN_BASELINES.ORIGIN</code> as the <code class="codeph">origin</code> argument. For example, the <code class="codeph">origin</code> parameter permits <code class="codeph">MANUAL-LOAD-FROM-STS</code>, <code class="codeph">MANUAL-LOAD-FROM-AWR</code>, and <code class="codeph">MANUAL-LOAD-FROM-CC</code>.
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                     <div class="p">
                        <p>This tutorial assumes the following:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>You want to create a staging table named <code class="codeph">stage1</code> in the source database.
                              </p>
                           </li>
                           <li>
                              <p>You want to load all plans owned by user <code class="codeph">spm</code> into the staging table.
                              </p>
                           </li>
                           <li>
                              <p>You want to transfer the staging table to a destination database.</p>
                           </li>
                           <li>
                              <p>You want to load the plans in <code class="codeph">stage1</code> as fixed plans.
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-406BA5D3-29DE-4AF7-B5D2-8B488297023F__GUID-E2283534-5314-4F82-9FC4-465A95FBAA3A">To transfer a set of SQL plan baselines from one database to another:</p>
                        <ol>
                           <li>
                              <p>Connect SQL*Plus to the source database with the appropriate privileges, and then create a staging table using the <code class="codeph">CREATE_STGTAB_BASELINE</code> procedure.
                              </p>
                              <p>The following example creates a staging table named <code class="codeph">stage1</code>:
                              </p><pre class="pre codeblock"><code>BEGIN
  DBMS_SPM.CREATE_STGTAB_BASELINE (
    table_name =&gt; 'stage1');
END;
/
</code></pre></li>
                           <li>
                              <p>On the source database, pack the SQL plan baselines you want to export from the SQL management base into the staging table.</p>
                              <p>The following example packs enabled plan baselines created by user <code class="codeph">spm</code> into staging table <code class="codeph">stage1</code>. Select SQL plan baselines using the plan name (<code class="codeph">plan_name</code>), SQL handle (<code class="codeph">sql_handle</code>), or any other plan criteria. The <code class="codeph">table_name</code> parameter is mandatory.
                              </p><pre class="pre codeblock"><code>DECLARE
  v_plan_cnt NUMBER;
BEGIN
  v_plan_cnt := DBMS_SPM.PACK_STGTAB_BASELINE (
    table_name =&gt; 'stage1'
,   enabled    =&gt; 'yes'
,   creator    =&gt; 'spm'
);
END;
/
</code></pre></li>
                           <li>
                              <p>Export the staging table <code class="codeph">stage1</code> into a dump file using Oracle Data Pump Export.
                              </p>
                           </li>
                           <li>
                              <p>Transfer the dump file to the host of the destination database.</p>
                           </li>
                           <li>
                              <p>On the destination database, import the staging table <code class="codeph">stage1</code> from the dump file using the Oracle Data Pump Import utility.
                              </p>
                           </li>
                           <li>
                              <p>On the destination database, unpack the SQL plan baselines from the staging table into the SQL management base.</p>
                              <p>The following example unpacks all fixed plan baselines stored in the staging table <code class="codeph">stage1</code>:
                              </p><pre class="pre codeblock"><code>DECLARE
  v_plan_cnt NUMBER;
BEGIN
  v_plan_cnt := DBMS_SPM.UNPACK_STGTAB_BASELINE (
    table_name =&gt; 'stage1'
,   fixed      =&gt; 'yes'
);
END;
/</code></pre></li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-406BA5D3-29DE-4AF7-B5D2-8B488297023F__GUID-CD28EF75-6A13-431A-90CB-3ABD93BCB70B">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="../arpls/DBMS_SPM.html#ARPLS150" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> for more information about using the <code class="codeph">DBMS_SPM</code> package
                              </p>
                           </li>
                           <li>
                              <p><a href="../refrn/DBA_SQL_PLAN_BASELINES.html#REFRN23714" target="_blank"><span><cite>Oracle Database Reference</cite></span></a> to learn more about the <code class="codeph">DBA_SQL_PLAN_BASELINES</code> view
                              </p>
                           </li>
                           <li>
                              <p><a href="../sutil/oracle-data-pump-overview.html#SUTIL100" target="_blank"><span><cite>Oracle Database Utilities</cite></span></a> for detailed information about using the Data Pump Export and Import utilities
                              </p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-sql-plan-baselines.html#GUID-C6AC4856-3C8C-42D8-A7FD-629974E98D36" title="Using DBMS_SPM, you can initiate the bulk load of a set of existing plans into a SQL plan baseline.">Loading SQL Plan Baselines</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="TGSQL653"></a><div class="props_rev_3"><a id="GUID-19E6FFB0-BC7A-4CDB-AE36-6D67C15C7332" name="GUID-19E6FFB0-BC7A-4CDB-AE36-6D67C15C7332"></a><h3 id="TGSQL-GUID-19E6FFB0-BC7A-4CDB-AE36-6D67C15C7332" class="sect3"><span class="enumeration_section">28.5 </span>Evolving SQL Plan Baselines Manually
               </h3>
               <div>
                  <p>You can use PL/SQL or Cloud Control to manually evolve an unaccepted plan to determine whether it performs better than any plan currently in the plan baseline.</p>
                  <p>This section contains the following topics:</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="managing-sql-plan-baselines.html#GUID-15A23B74-8B43-49EA-83CE-14F2C209C9A9">About the DBMS_SPM Evolve Functions</a><br>This topic describes the most relevant <code class="codeph">DBMS_SPM</code> functions for managing plan evolution. Execute evolution tasks manually or schedule them to run automatically.
                     </li>
                     <li class="ulchildlink"><a href="managing-sql-plan-baselines.html#GUID-528D51FD-E109-488A-B1EF-9B736E78901A">Managing an Evolve Task</a><br>This topic describes a typical use case in which you create and execute a task, and then implement its recommendations. 
                     </li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-19E6FFB0-BC7A-4CDB-AE36-6D67C15C7332__GUID-981975F8-72CE-403A-8F93-152FF4AB7DD4">
                     <p class="notep1">See Also:</p>
                     <p><span class="q">"<a href="managing-sql-plan-baselines.html#GUID-A94CFA49-910A-4237-A7BB-39BFA94E227E" title="SPM Evolve Advisor is a SQL advisor that evolves plans that have recently been added to the SQL plan baseline. The advisor simplifies plan evolution by eliminating the requirement to do it manually.">Managing the SPM Evolve Advisor Task</a>"</span></p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="managing-sql-plan-baselines.html#GUID-7024369A-F98D-48E4-921C-C899485C954F" title="This chapter explains the concepts and tasks relating to SQL plan management using the DBMS_SPM package.">Managing SQL Plan Baselines</a></p>
                     </div>
                  </div>
               </div>
               <a id="TGSQL94616"></a><a id="TGSQL94652"></a><a id="TGSQL94651"></a><div class="props_rev_3"><a id="GUID-15A23B74-8B43-49EA-83CE-14F2C209C9A9" name="GUID-15A23B74-8B43-49EA-83CE-14F2C209C9A9"></a><h4 id="TGSQL-GUID-15A23B74-8B43-49EA-83CE-14F2C209C9A9" class="sect4"><span class="enumeration_section">28.5.1 </span>About the DBMS_SPM Evolve Functions
                  </h4>
                  <div>
                     <p>This topic describes the most relevant <code class="codeph">DBMS_SPM</code> functions for managing plan evolution. Execute evolution tasks manually or schedule them to run automatically.
                     </p>
                     <p></p>
                     <div class="tblformal" id="GUID-15A23B74-8B43-49EA-83CE-14F2C209C9A9__CDEGCFDF">
                        <p class="titleintable">Table 28-9 DBMS_SPM Functions and Procedures for Managing Plan Evolution Tasks</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="DBMS_SPM Functions and Procedures for Managing Plan Evolution Tasks" summary="This 3 column table lists the procedures and functions for managing plan evolution. Column 1 is the procedure or function. Column 2 is a description. " width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="49%" id="d140998e5424">Procedure or Function</th>
                                 <th align="left" valign="bottom" width="51%" id="d140998e5427">Description</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d140998e5432" headers="d140998e5424 ">
                                    <p><code class="codeph">ACCEPT_SQL_PLAN_BASELINE</code></p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d140998e5432 d140998e5427 ">
                                    <p>This function accepts one recommendation to evolve a single plan into a SQL plan baseline.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d140998e5440" headers="d140998e5424 ">
                                    <p><code class="codeph">CREATE_EVOLVE_TASK</code></p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d140998e5440 d140998e5427 ">
                                    <p>This function creates an advisor task to prepare the <a href="glossary.html#GUID-EB0CDE30-5FFF-4F51-A06D-AB60811B242F"><span class="xrefglossterm">plan evolution</span></a> of one or more plans for a specified SQL statement. The input parameters can be a <a href="glossary.html#GUID-73B75657-B353-4201-8465-796B20C1A6C6"><span class="xrefglossterm">SQL handle</span></a>, plan name or a list of plan names, time limit, task name, and description.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d140998e5454" headers="d140998e5424 ">
                                    <p><code class="codeph">EXECUTE_EVOLVE_TASK</code></p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d140998e5454 d140998e5427 ">
                                    <p>This function executes an evolution task. The input parameters can be the task name, execution name, and execution description. If not specified, the advisor generates the name, which is returned by the function.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d140998e5462" headers="d140998e5424 ">
                                    <p><code class="codeph">IMPLEMENT_EVOLVE_TASK</code></p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d140998e5462 d140998e5427 ">
                                    <p>This function implements all recommendations for an evolve task. Essentially, this function is equivalent to using <code class="codeph">ACCEPT_SQL_PLAN_BASELINE</code> for all recommended plans. Input parameters include task name, plan name, owner name, and execution name.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d140998e5473" headers="d140998e5424 ">
                                    <p><code class="codeph">REPORT_EVOLVE_TASK</code></p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d140998e5473 d140998e5427 ">
                                    <p>This function displays the results of an evolve task as a <code class="codeph">CLOB</code>. Input parameters include the task name and section of the report to include.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d140998e5484" headers="d140998e5424 ">
                                    <p><code class="codeph">SET_EVOLVE_TASK_PARAMETER</code></p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d140998e5484 d140998e5427 ">
                                    <p>This function updates the value of an evolve task parameter. </p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p>Oracle recommends that you configure SPM Evolve Advisor to run automatically. You can also evolve SQL plan baselines manually. The following graphic shows the basic workflow for managing SQL plan management tasks.</p>
                     <div class="figure" id="GUID-15A23B74-8B43-49EA-83CE-14F2C209C9A9__CDEGEHCC">
                        <p class="titleinfigure">Figure 28-4 Evolving SQL Plan Baselines</p><img src="img/tgsql_vm_022.png" alt="Description of Figure 28-4 follows" title="Description of Figure 28-4 follows" longdesc="img_text/tgsql_vm_022.html"><br><a href="img_text/tgsql_vm_022.html">Description of "Figure 28-4 Evolving SQL Plan Baselines"</a></div>
                     <!-- class="figure" -->
                     <p>Typically, you manage SQL plan evolution tasks in the following sequence:</p>
                     <ol>
                        <li>
                           <p>Create an evolve task</p>
                        </li>
                        <li>
                           <p>Optionally, set evolve task parameters</p>
                        </li>
                        <li>
                           <p>Execute the evolve task</p>
                        </li>
                        <li>
                           <p>Implement the recommendations in the task</p>
                        </li>
                        <li>
                           <p>Report on the task outcome</p>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-15A23B74-8B43-49EA-83CE-14F2C209C9A9__GUID-61EF304D-E301-459F-B819-1085D09BF8DE">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><span class="q">"<a href="managing-sql-plan-baselines.html#GUID-541EBA4B-4F7D-42DD-A152-C06BDE69D828" title="Configure automatic plan evolution by specifying the task parameters using the DBMS_SPM.SET_EVOLVE_TASK_PARAMETER procedure.">Configuring the Automatic SPM Evolve Advisor Task</a>"</span> to learn about <code class="codeph">SET_EVOLVE_TASK_PARAMETER</code></p>
                           </li>
                           <li>
                              <p><a href="../arpls/DBMS_SPM.html#ARPLS150" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> for more information about the <code class="codeph">DBMS_SPM</code> package
                              </p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-sql-plan-baselines.html#GUID-19E6FFB0-BC7A-4CDB-AE36-6D67C15C7332" title="You can use PL/SQL or Cloud Control to manually evolve an unaccepted plan to determine whether it performs better than any plan currently in the plan baseline.">Evolving SQL Plan Baselines Manually</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TGSQL654"></a><a id="TGSQL94973"></a><a id="TGSQL655"></a><a id="TGSQL656"></a><a id="TGSQL94810"></a><a id="TGSQL94653"></a><div class="props_rev_3"><a id="GUID-528D51FD-E109-488A-B1EF-9B736E78901A" name="GUID-528D51FD-E109-488A-B1EF-9B736E78901A"></a><h4 id="TGSQL-GUID-528D51FD-E109-488A-B1EF-9B736E78901A" class="sect4"><span class="enumeration_section">28.5.2 </span>Managing an Evolve Task
                  </h4>
                  <div>
                     <p>This topic describes a typical use case in which you create and execute a task, and then implement its recommendations. </p>
                     <div class="section">
                        <p>The following table describes some parameters of the <code class="codeph">CREATE_EVOLVE_TASK</code> function.
                        </p>
                        <div class="tblformal" id="GUID-528D51FD-E109-488A-B1EF-9B736E78901A__CDEFCHHA">
                           <p class="titleintable">Table 28-10 DBMS_SPM.CREATE_EVOLVE_TASK Parameters</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="DBMS_SPM.CREATE_EVOLVE_TASK Parameters" summary="This 2 column table lists the parameters for the CREATE_EVOLVE_TASK function. Column 1 is the parameter. Column 2 describes that parameter. " width="100%" frame="hsides" border="1" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="25%" id="d140998e5688">Function Parameter</th>
                                    <th align="left" valign="bottom" width="75%" id="d140998e5691">Description</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="25%" id="d140998e5696" headers="d140998e5688 ">
                                       <p><code class="codeph">sql_handle</code></p>
                                    </td>
                                    <td align="left" valign="top" width="75%" headers="d140998e5696 d140998e5691 ">
                                       <p>SQL handle of the statement. The default <code class="codeph">NULL</code> considers all SQL statements with unaccepted plans.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="25%" id="d140998e5707" headers="d140998e5688 ">
                                       <p><code class="codeph">plan_name</code> 
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="75%" headers="d140998e5707 d140998e5691 ">
                                       <p>Plan identifier. The default <code class="codeph">NULL</code> means consider all unaccepted plans of the specified SQL handle or all SQL statements if the SQL handle is <code class="codeph">NULL</code>.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="25%" id="d140998e5722" headers="d140998e5688 ">
                                       <p><code class="codeph">time_limit</code> 
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="75%" headers="d140998e5722 d140998e5691 ">
                                       <p>Time limit in number of minutes. The time limit for first unaccepted plan equals the input value. The time limit for the second unaccepted plan equals the input value minus the time spent in first plan verification, and so on. The default <code class="codeph">DBMS_SPM.AUTO_LIMIT</code> means let the system choose an appropriate time limit based on the number of plan verifications required to be done.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="25%" id="d140998e5734" headers="d140998e5688 ">
                                       <p><code class="codeph">task_name</code> 
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="75%" headers="d140998e5734 d140998e5691 ">
                                       <p>User-specified name of the evolution task.</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                        <p>This section explains how to evolve plan baselines from the command line. In Cloud Control, from the SQL Plan Baseline subpage, select a plan, and then click <span class="bold">Evolve</span>.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="p">
                        <p>This tutorial assumes the following:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>You do not have the automatic evolve task enabled.</p>
                           </li>
                           <li>
                              <p>You want to create a SQL plan baseline for the following query:</p><pre class="pre codeblock"><code>SELECT /* q1_group_by */ prod_name, sum(quantity_sold)
FROM   products p, sales s
WHERE  p.prod_id = s.prod_id
AND    p.prod_category_id =203
GROUP BY prod_name;
</code></pre></li>
                           <li>
                              <p>You want to create two indexes to improve the query performance, and then evolve the plan that uses these indexes if it performs better than the plan currently in the plan baseline.</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-528D51FD-E109-488A-B1EF-9B736E78901A__GUID-623A8624-1755-4997-B851-CCFEA5A9DFD3">To evolve a specified plan:</p>
                        <ol>
                           <li>
                              <p>Perform the initial setup as follows:</p>
                              <ol type="a">
                                 <li>
                                    <p>Connect SQL*Plus to the database with administrator privileges, and then prepare for the tutorial by flushing the shared pool and the buffer cache:</p><pre class="pre codeblock"><code>ALTER SYSTEM FLUSH SHARED_POOL;
ALTER SYSTEM FLUSH BUFFER_CACHE;
</code></pre></li>
                                 <li>
                                    <p>Enable the automatic capture of SQL plan baselines.</p>
                                    <p>For example, enter the following statement:</p><pre class="pre codeblock"><code>ALTER SYSTEM SET OPTIMIZER_CAPTURE_SQL_PLAN_BASELINES=true;
</code></pre></li>
                                 <li>
                                    <p>Connect to the database as user <code class="codeph">sh</code>, and then set SQL*Plus display parameters:
                                    </p><pre class="pre codeblock"><code>CONNECT sh
-- enter password
SET PAGES 10000 LINES 140
SET SERVEROUTPUT ON
COL SQL_TEXT FORMAT A20
COL SQL_HANDLE FORMAT A20
COL PLAN_NAME FORMAT A30
COL ORIGIN FORMAT A12
SET LONGC 60535
SET LONG 60535
SET ECHO ON
</code></pre></li>
                              </ol>
                           </li>
                           <li>
                              <p>Execute the <code class="codeph">SELECT</code> statements so that SQL plan management captures them:
                              </p>
                              <ol type="a">
                                 <li>
                                    <p>Execute the <code class="codeph">SELECT /* q1_group_by */</code> statement for the first time.
                                    </p>
                                    <p>Because the database only captures plans for repeatable statements, the plan baseline for this statement is empty.</p>
                                 </li>
                                 <li>
                                    <p>Query the data dictionary to confirm that no plans exist in the plan baseline.</p>
                                    <p>For example, execute the following query (sample output included):</p><pre class="pre codeblock"><code>SELECT SQL_HANDLE, SQL_TEXT, PLAN_NAME, ORIGIN, ENABLED, 
       ACCEPTED, FIXED, AUTOPURGE
FROM   DBA_SQL_PLAN_BASELINES
WHERE  SQL_TEXT LIKE '%q1_group%';

no rows selected
</code></pre><p>SQL plan management only captures repeatable statements, so this result is expected.</p>
                                 </li>
                                 <li>
                                    <p>Execute the <code class="codeph">SELECT /* q1_group_by */</code> statement for the second time.
                                    </p>
                                 </li>
                              </ol>
                           </li>
                           <li>
                              <p>Query the data dictionary to ensure that the plans were loaded into the plan baseline for the statement.</p>
                              <p>The following statement queries <code class="codeph">DBA_SQL_PLAN_BASELINES</code> (sample output included):
                              </p><pre class="pre codeblock"><code>SELECT SQL_HANDLE, SQL_TEXT, PLAN_NAME,
       ORIGIN, ENABLED, ACCEPTED, FIXED 
FROM   DBA_SQL_PLAN_BASELINES
WHERE  SQL_TEXT LIKE '%q1_group%';
 
SQL_HANDLE           SQL_TEXT         PLAN_NAME                      ORIGIN       ENA ACC FIX
-------------------- ---------------- ------------------------------ ------------ --- --- ---
SQL_07f16c76ff893342 SELECT /* q1_gro SQL_PLAN_0gwbcfvzskcu242949306 <span class="bold">AUTO-CAPTURE</span> YES <span class="bold">YES</span> NO
                     up_by */ prod_na
                     me, sum(quantity
                     _sold) FROM 
                     products p, 
                     sales s WHERE 
                     p.prod_id = 
                     s.prod_id AND
                     p.prod_category
                     _id =203 GROUP
                     BY prod_name
</code></pre><p>The output shows that the plan is accepted, which means that it is in the plan baseline for the statement. Also, the origin is <code class="codeph">AUTO-CAPTURE</code>, which means that the statement was automatically captured and not manually loaded.
                              </p>
                           </li>
                           <li>
                              <p>Explain the plan for the statement and verify that the optimizer is using this plan.</p>
                              <p>For example, explain the plan as follows, and then display it:</p><pre class="pre codeblock"><code>EXPLAIN PLAN FOR  
  SELECT /* q1_group_by */ prod_name, sum(quantity_sold)
  FROM   products p, sales s
  WHERE  p.prod_id = s.prod_id
  AND    p.prod_category_id =203
  GROUP BY prod_name;

SELECT * FROM TABLE(DBMS_XPLAN.DISPLAY(null, null, 'basic +note'));
</code></pre><p>Sample output appears below:</p><pre class="pre codeblock"><code>Plan hash value: 1117033222
 
------------------------------------------
| Id  | Operation             | Name     |
------------------------------------------
|   0 | SELECT STATEMENT      |          |
|   1 |  HASH GROUP BY        |          |
|   2 |   HASH JOIN           |          |
|   3 |    TABLE ACCESS FULL  | PRODUCTS |
|   4 |    PARTITION RANGE ALL|          |
|   5 |     TABLE ACCESS FULL | SALES    |
------------------------------------------
 
Note
-----
   - SQL plan baseline "SQL_PLAN_0gwbcfvzskcu242949306" used for this statement
</code></pre><p>The note indicates that the optimizer is using the plan shown with the plan name listed in the previous step.</p>
                           </li>
                           <li>
                              <p>Create two indexes to improve the performance of the <code class="codeph">SELECT /* q1_group_by */</code> statement. 
                              </p>
                              <p>For example, use the following statements:</p><pre class="pre codeblock"><code>CREATE INDEX ind_prod_cat_name 
  ON products(prod_category_id, prod_name, prod_id);
CREATE INDEX ind_sales_prod_qty_sold 
  ON sales(prod_id, quantity_sold);
</code></pre></li>
                           <li>
                              <p>Execute the <code class="codeph">select /* q1_group_by */</code> statement again.
                              </p>
                              <p>Because automatic capture is enabled, the plan baseline is populated with the new plan for this statement.</p>
                           </li>
                           <li>
                              <p>Query the data dictionary to ensure that the plan was loaded into the SQL plan baseline for the statement.</p>
                              <p>The following statement queries <code class="codeph">DBA_SQL_PLAN_BASELINES</code> (sample output included).
                              </p><pre class="pre codeblock"><code>SELECT SQL_HANDLE, SQL_TEXT, PLAN_NAME, ORIGIN, ENABLED, ACCEPTED
FROM   DBA_SQL_PLAN_BASELINES
WHERE  SQL_HANDLE IN ('SQL_07f16c76ff893342')
ORDER BY SQL_HANDLE, ACCEPTED;

SQL_HANDLE           SQL_TEXT             PLAN_NAME                      ORIGIN       ENA ACC
-------------------- -------------------- ------------------------------ ------------ --- ---
SQL_07f16c76ff893342 SELECT /* q1_group_b SQL_PLAN_0gwbcfvzskcu20135fd6c AUTO-CAPTURE YES <span class="bold">NO</span>
                     y */ prod_name, sum(
                     quantity_sold)
                     FROM   products p, s
                     ales s
                     WHERE  p.prod_id = s
                     .prod_id
                     AND    p.prod_catego
                     ry_id =203
                     GROUP BY prod_name
 
SQL_07f16c76ff893342 SELECT /* q1_group_b SQL_PLAN_0gwbcfvzskcu242949306 AUTO-CAPTURE YES YES
                     y */ prod_name, sum(
                     quantity_sold)
                     FROM   products p, s
                     ales s
                     WHERE  p.prod_id = s
                     .prod_id
                     AND    p.prod_catego
                     ry_id =203
                     GROUP BY prod_name
</code></pre><p>The output shows that the new plan is unaccepted, which means that it is in the statement history but not the SQL plan baseline.</p>
                           </li>
                           <li>
                              <p>Explain the plan for the statement and verify that the optimizer is using the original unindexed plan.</p>
                              <p>For example, explain the plan as follows, and then display it:</p><pre class="pre codeblock"><code>EXPLAIN PLAN FOR
  SELECT /* q1_group_by */ prod_name, sum(quantity_sold)
  FROM   products p, sales s
  WHERE  p.prod_id = s.prod_id
  AND    p.prod_category_id =203
  GROUP BY prod_name;
SELECT * FROM TABLE(DBMS_XPLAN.DISPLAY(null, null, 'basic +note'));
</code></pre><p>Sample output appears below:</p><pre class="pre codeblock"><code>Plan hash value: 1117033222
 
------------------------------------------
| Id  | Operation             | Name     |
------------------------------------------
|   0 | SELECT STATEMENT      |          |
|   1 |  HASH GROUP BY        |          |
|   2 |   HASH JOIN           |          |
|   3 |    TABLE ACCESS FULL  | PRODUCTS |
|   4 |    PARTITION RANGE ALL|          |
|   5 |     TABLE ACCESS FULL | SALES    |
------------------------------------------
 
Note
-----
   - SQL plan baseline "SQL_PLAN_0gwbcfvzskcu242949306" used for this statement
</code></pre><p>The note indicates that the optimizer is using the plan shown with the plan name listed in Step 3.</p>
                           </li>
                           <li>
                              <p>Connect as an administrator, and then create an evolve task that considers all SQL statements with unaccepted plans.</p>
                              <p>For example, execute the <code class="codeph">DBMS_SPM.CREATE_EVOLVE_TASK</code> function and then obtain the name of the task:
                              </p><pre class="pre codeblock"><code>CONNECT / AS SYSDBA
VARIABLE cnt NUMBER
VARIABLE tk_name VARCHAR2(50)
VARIABLE exe_name VARCHAR2(50)
VARIABLE evol_out CLOB
 
EXECUTE :tk_name := DBMS_SPM.CREATE_EVOLVE_TASK( 
  sql_handle =&gt; 'SQL_07f16c76ff893342', 
  plan_name  =&gt; 'SQL_PLAN_0gwbcfvzskcu20135fd6c');
 
SELECT :tk_name FROM DUAL;
</code></pre><p>The following sample output shows the name of the task:</p><pre class="pre codeblock"><code>:EVOL_OUT
--------------------------------------------------------------------------
TASK_11
</code></pre><p>Now that the task has been created and has a unique name, execute the task.</p>
                           </li>
                           <li>
                              <p>Execute the task.</p>
                              <p>For example, execute the <code class="codeph">DBMS_SPM.EXECUTE_EVOLVE_TASK</code> function (sample output included):
                              </p><pre class="pre codeblock"><code>EXECUTE :exe_name :=DBMS_SPM.EXECUTE_EVOLVE_TASK(task_name=&gt;:tk_name); 
SELECT :exe_name FROM DUAL;

:EXE_NAME
---------------------------------------------------------------------------
EXEC_1
</code></pre></li>
                           <li>
                              <p>View the report.</p>
                              <p>For example, execute the <code class="codeph">DBMS_SPM.REPORT_EVOLVE_TASK</code> function (sample output included):
                              </p><pre class="pre codeblock"><code>EXECUTE :evol_out := DBMS_SPM.REPORT_EVOLVE_TASK( task_name=&gt;:tk_name, execution_name=&gt;:exe_name );
SELECT :evol_out FROM DUAL;

GENERAL INFORMATION SECTION
--------------------------------------------------------------------------
 
 Task Information:
 ---------------------------------------------
 Task Name            : TASK_11
 Task Owner           : SYS
 Execution Name       : EXEC_1
 Execution Type       : SPM EVOLVE
 Scope                : COMPREHENSIVE
 Status               : COMPLETED
 Started              : 01/09/2012 12:21:27
 Finished             : 01/09/2012 12:21:29
 Last Updated         : 01/09/2012 12:21:29
 Global Time Limit    : 2147483646
 Per-Plan Time Limit  : UNUSED
 Number of Errors     : 0
---------------------------------------------------------------------------
 
SUMMARY SECTION
---------------------------------------------------------------------------
  Number of plans processed  : 1
  Number of findings         : 1
  Number of recommendations  : 1
  Number of errors           : 0
---------------------------------------------------------------------------
 
DETAILS SECTION
---------------------------------------------------------------------------
 Object ID         : 2
 Test Plan Name    : SQL_PLAN_0gwbcfvzskcu20135fd6c
 Base Plan Name    : SQL_PLAN_0gwbcfvzskcu242949306
 SQL Handle        : SQL_07f16c76ff893342
 Parsing Schema    : SH
 Test Plan Creator : SH
 SQL Text          : SELECT /*q1_group_by*/ prod_name, 
                     sum(quantity_sold) 
                     FROM products p, sales s 
                     WHERE p.prod_id=s.prod_id AND p.prod_category_id=203 
                     GROUP BY prod_name
 
Execution Statistics:
-----------------------------
                    Base Plan                     Test Plan
                    ----------------------------  ------------------------
 Elapsed Time (s):  .044336                       .012649
 CPU Time (s):      .044003                       .012445
 Buffer Gets:       360                           99
 Optimizer Cost:    924                           891
 Disk Reads:        341                           82
 Direct Writes:     0                             0
 Rows Processed:    4                             2
 Executions:        5                             9
 
 
FINDINGS SECTION
---------------------------------------------------------------------------
 
<span class="bold">Findings</span> <span class="bold">(1):</span>
<span class="bold">-----------------------------</span>
<span class="bold"> 1.</span> <span class="bold">The plan was verified in 2.18 seconds. It passed the benefit criterion</span>
    <span class="bold">because its verified performance was 2.01 times better than that of the</span>
    <span class="bold">baseline plan.</span>
 
Recommendation:
-----------------------------
 Consider accepting the plan. Execute
 dbms_spm.accept_sql_plan_baseline(task_name =&gt; 'TASK_11', object_id =&gt; 2,
 task_owner =&gt; 'SYS');
 
EXPLAIN PLANS SECTION
---------------------------------------------------------------------------
 
Baseline Plan
-----------------------------
 Plan Id          : 1
 Plan Hash Value  : 1117033222
 
---------------------------------------------------------------------------
| Id| Operation               | Name     | Rows | Bytes   |Cost | Time    |
---------------------------------------------------------------------------
| 0 | SELECT STATEMENT        |          |   21 |     861 | 924 | 00:00:12|
| 1 |   HASH GROUP BY         |          |   21 |     861 | 924 | 00:00:12|
| *2|    HASH JOIN            |          |267996|10987836 | 742 | 00:00:09|
| *3|     TABLE ACCESS FULL   | PRODUCTS |   21 |     714 |   2 | 00:00:01|
| 4 |     PARTITION RANGE ALL |          |918843| 6431901 | 662 | 00:00:08|
| 5 |      TABLE ACCESS FULL  | SALES    |918843| 6431901 | 662 | 00:00:08|
---------------------------------------------------------------------------
 
Predicate Information (identified by operation id):
------------------------------------------
* 2 - access("P"."PROD_ID"="S"."PROD_ID")
* 3 - filter("P"."PROD_CATEGORY_ID"=203)
  
Test Plan
-----------------------------
 Plan Id          : 2
 Plan Hash Value  : 20315500
 
---------------------------------------------------------------------------
|Id| Operation            | Name             | Rows | Bytes  | Cost| Time |
---------------------------------------------------------------------------
| 0|SELECT STATEMENT      |                  |    21|     861|891|00:00:11|
| 1|  SORT GROUP BY NOSORT|                  |    21|     861|891|00:00:11|
| 2|   NESTED LOOPS       |                  |267996|10987836|891|00:00:11|
|*3|    INDEX RANGE SCAN  |IND_PROD_CAT_NAME |    21|     714|  1|00:00:01|
|*4|    INDEX RANGE SCAN  |IND_SALES_PROD_QTY| 12762|   89334| 42|00:00:01|
---------------------------------------------------------------------------
 
Predicate Information (identified by operation id):
------------------------------------------
* 3 - access("P"."PROD_CATEGORY_ID"=203)
* 4 - access("P"."PROD_ID"="S"."PROD_ID")
</code></pre><p>This report indicates that the new execution plan, which uses the two new indexes, performs better than the original plan.</p>
                           </li>
                           <li>
                              <p>Implement the recommendations of the evolve task.</p>
                              <p>For example, execute the <code class="codeph">IMPLEMENT_EVOLVE_TASK</code> function:
                              </p><pre class="pre codeblock"><code>EXECUTE :cnt := DBMS_SPM.IMPLEMENT_EVOLVE_TASK( task_name=&gt;:tk_name, execution_name=&gt;:exe_name );
</code></pre></li>
                           <li>
                              <p>Query the data dictionary to ensure that the new plan is accepted.</p>
                              <p>The query provides the following sample output:</p><pre class="pre codeblock"><code>SELECT SQL_HANDLE, SQL_TEXT, PLAN_NAME, ORIGIN, ENABLED, ACCEPTED
FROM   DBA_SQL_PLAN_BASELINES
WHERE  SQL_HANDLE IN ('SQL_07f16c76ff893342')
ORDER BY SQL_HANDLE, ACCEPTED;

SQL_HANDLE           SQL_TEXT             PLAN_NAME                      ORIGIN       ENA ACC
-------------------- -------------------- ------------------------------ ------------ --- ---
SQL_07f16c76ff893342 SELECT /* q1_group_b SQL_PLAN_0gwbcfvzskcu20135fd6c AUTO-CAPTURE YES <span class="bold">YES</span>
                     y */ prod_name, sum(
                     quantity_sold)
                     FROM   products p, s
                     ales s
                     WHERE  p.prod_id = s
                     .prod_id
                     AND    p.prod_catego
                     ry_id =203
                     GROUP BY prod_name
 
SQL_07f16c76ff893342 SELECT /* q1_group_b SQL_PLAN_0gwbcfvzskcu242949306 AUTO-CAPTURE YES YES
                     y */ prod_name, sum(
                     quantity_sold)
                     FROM   products p, s
                     ales s
                     WHERE  p.prod_id = s
                     .prod_id
                     AND    p.prod_catego
                     ry_id =203
                     GROUP BY prod_name
</code></pre><p>The output shows that the new plan is accepted.</p>
                           </li>
                           <li>
                              <p>Clean up after the example.</p>
                              <p>For example, enter the following statements:</p><pre class="pre codeblock"><code>EXEC :cnt := DBMS_SPM.DROP_SQL_PLAN_BASELINE('SQL_07f16c76ff893342');
EXEC :cnt := DBMS_SPM.DROP_SQL_PLAN_BASELINE('SQL_9049245213a986b3');
EXEC :cnt := DBMS_SPM.DROP_SQL_PLAN_BASELINE('SQL_bb77077f5f90a36b');
EXEC :cnt := DBMS_SPM.DROP_SQL_PLAN_BASELINE('SQL_02a86218930bbb20');
DELETE FROM SQLLOG$;
CONNECT sh
-- enter password
DROP INDEX IND_SALES_PROD_QTY_SOLD;
DROP INDEX IND_PROD_CAT_NAME;</code></pre></li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-528D51FD-E109-488A-B1EF-9B736E78901A__GUID-E3A8F265-C0B4-4E93-B365-124E924F0C21">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p> <span class="q">"<a href="managing-sql-plan-baselines.html#GUID-A94CFA49-910A-4237-A7BB-39BFA94E227E" title="SPM Evolve Advisor is a SQL advisor that evolves plans that have recently been added to the SQL plan baseline. The advisor simplifies plan evolution by eliminating the requirement to do it manually.">Managing the SPM Evolve Advisor Task</a>"</span></p>
                           </li>
                           <li>
                              <p><a href="../arpls/DBMS_SPM.html#ARPLS150" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> to learn more about the <code class="codeph">DBMS_SPM</code> evolve functions
                              </p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-sql-plan-baselines.html#GUID-19E6FFB0-BC7A-4CDB-AE36-6D67C15C7332" title="You can use PL/SQL or Cloud Control to manually evolve an unaccepted plan to determine whether it performs better than any plan currently in the plan baseline.">Evolving SQL Plan Baselines Manually</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="TGSQL659"></a><a id="TGSQL94974"></a><a id="TGSQL660"></a><a id="TGSQL658"></a><div class="props_rev_3"><a id="GUID-BA19EA4E-AFEF-4677-B08F-854DE59ED932" name="GUID-BA19EA4E-AFEF-4677-B08F-854DE59ED932"></a><h3 id="TGSQL-GUID-BA19EA4E-AFEF-4677-B08F-854DE59ED932" class="sect3"><span class="enumeration_section">28.6 </span>Dropping SQL Plan Baselines
               </h3>
               <div>
                  <p>You can remove some or all plans from a SQL plan baseline. This technique is sometimes useful when testing SQL plan management.</p>
                  <div class="section">
                     <p>Drop plans with the <code class="codeph">DBMS_SPM.DROP_SQL_PLAN_BASELINE</code> function. This function returns the number of dropped plans. The following table describes input parameters.
                     </p>
                     <div class="tblformal" id="GUID-BA19EA4E-AFEF-4677-B08F-854DE59ED932__GUID-84D20EAF-6112-4C56-8AD1-E4156BB48927">
                        <p class="titleintable">Table 28-11 DROP_SQL_PLAN_BASELINE Parameters</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="DROP_SQL_PLAN_BASELINE Parameters" summary="This 2 column table lists DROP_SQL_PLAN_BASELINE Parameters. Column 1 is the parameter. Column 2 describes that parameter. " width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="23%" id="d140998e6152">Function Parameter</th>
                                 <th align="left" valign="bottom" width="77%" id="d140998e6155">Description</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="23%" id="d140998e6160" headers="d140998e6152 ">
                                    <p><code class="codeph">sql_handle</code></p>
                                 </td>
                                 <td align="left" valign="top" width="77%" headers="d140998e6160 d140998e6155 ">
                                    <p>SQL statement identifier.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="23%" id="d140998e6168" headers="d140998e6152 ">
                                    <p><code class="codeph">plan_name</code> 
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="77%" headers="d140998e6168 d140998e6155 ">
                                    <p>Name of a specific plan. Default <code class="codeph">NULL</code> drops all plans associated with the SQL statement identified by <code class="codeph">sql_handle</code>.
                                    </p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p>This section explains how to drop baselines from the command line. In Cloud Control, from the SQL Plan Baseline subpage, select a plan, and then click <span class="bold">Drop</span>.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="p">
                     <p>This tutorial assumes that you want to drop all plans for the following SQL statement, effectively dropping the SQL plan baseline:</p><pre class="pre codeblock"><code>SELECT /* repeatable_sql */ COUNT(*) FROM hr.jobs;
</code></pre></div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-BA19EA4E-AFEF-4677-B08F-854DE59ED932__GUID-212DA14C-1BE8-4CC0-A017-6B500B176B7F">To drop a SQL plan baseline:</p>
                     <ol>
                        <li>
                           <p>Connect SQL*Plus to the database with the appropriate privileges, and then query the data dictionary for the plan baseline.</p>
                           <p>The following statement queries <code class="codeph">DBA_SQL_PLAN_BASELINES</code> (sample output included):
                           </p><pre class="pre codeblock"><code>SQL&gt; SELECT SQL_HANDLE, SQL_TEXT, PLAN_NAME, ORIGIN,
  2         ENABLED, ACCEPTED
  3  FROM   DBA_SQL_PLAN_BASELINES
  4  WHERE  SQL_TEXT LIKE 'SELECT /* repeatable_sql%';
 
SQL_HANDLE           SQL_TEXT             PLAN_NAME                      ORIGIN         ENA ACC
-------------------- -------------------- ------------------------------ -------------- --- ---
SQL_b6b0d1c71cd1807b SELECT /* repeatable SQL_PLAN_bdc6jswfd303v2f1e9c20 AUTO-CAPTURE   YES YES
                     _sql */ count(*) fro
                     m hr.jobs
</code></pre></li>
                        <li>
                           <p>Drop the SQL plan baseline for the statement.</p>
                           <p>The following example drops the plan baseline with the SQL handle <code class="codeph">SQL_b6b0d1c71cd1807b</code>, and returns the number of dropped plans. Specify plan baselines using the plan name (<code class="codeph">plan_name</code>), SQL handle (<code class="codeph">sql_handle</code>), or any other plan criteria. The <code class="codeph">table_name</code> parameter is mandatory.
                           </p><pre class="pre codeblock"><code>DECLARE
  v_dropped_plans number;
BEGIN
  v_dropped_plans := DBMS_SPM.DROP_SQL_PLAN_BASELINE (
     sql_handle =&gt; 'SQL_b6b0d1c71cd1807b'
);
  DBMS_OUTPUT.PUT_LINE('dropped ' || v_dropped_plans || ' plans');
END;
/
</code></pre></li>
                        <li>
                           <p>Confirm that the plans were dropped.</p>
                           <p>For example, execute the following query:</p><pre class="pre codeblock"><code>SELECT SQL_HANDLE, SQL_TEXT, PLAN_NAME, ORIGIN,
       ENABLED, ACCEPTED
FROM   DBA_SQL_PLAN_BASELINES
WHERE  SQL_TEXT LIKE 'SELECT /* repeatable_sql%';
 
no rows selected</code></pre></li>
                     </ol>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-BA19EA4E-AFEF-4677-B08F-854DE59ED932__GUID-138F46C2-FC36-4AB4-AF7D-442F50352549">
                     <p class="notep1">See Also:</p>
                     <p><a href="../arpls/DBMS_SPM.html#ARPLS68164" target="_blank"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> to learn about the <code class="codeph">DROP_SQL_PLAN_BASELINE</code> function
                     </p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="managing-sql-plan-baselines.html#GUID-7024369A-F98D-48E4-921C-C899485C954F" title="This chapter explains the concepts and tasks relating to SQL plan management using the DBMS_SPM package.">Managing SQL Plan Baselines</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="TGSQL662"></a><a id="TGSQL661"></a><div class="props_rev_3"><a id="GUID-DE976D2B-DBAD-498F-B933-D16B06CA9D2A" name="GUID-DE976D2B-DBAD-498F-B933-D16B06CA9D2A"></a><h3 id="TGSQL-GUID-DE976D2B-DBAD-498F-B933-D16B06CA9D2A" class="sect3"><span class="enumeration_section">28.7 </span>Managing the SQL Management Base
               </h3>
               <div>
                  <p>The SQL management base is a part of the data dictionary that resides in the <code class="codeph">SYSAUX</code> tablespace. It stores statement logs, plan histories, SQL plan baselines, and SQL profiles.
                  </p>
                  <div class="section">
                     <p>This section contains the following topics:</p>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="managing-sql-plan-baselines.html#GUID-3B560F69-E021-409E-9EA0-9902EEEEC6FD">About Managing the SMB</a><br>Use the <code class="codeph">DBMS_SPM.CONFIGURE</code> procedure to set configuration options for the SMB and the maintenance of SQL plan baselines.
                     </li>
                     <li class="ulchildlink"><a href="managing-sql-plan-baselines.html#GUID-DF2EC31E-7BAB-45BB-B3B4-F1D1A4A13019">Changing the Disk Space Limit for the SMB</a><br>A weekly background process measures the total space occupied by the SMB.
                     </li>
                     <li class="ulchildlink"><a href="managing-sql-plan-baselines.html#GUID-D5F66DF0-3D41-4E78-9FAE-62ECC9F22F1F">Changing the Plan Retention Policy in the SMB</a><br>A weekly scheduled purging task manages disk space used by SQL plan management.
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="managing-sql-plan-baselines.html#GUID-7024369A-F98D-48E4-921C-C899485C954F" title="This chapter explains the concepts and tasks relating to SQL plan management using the DBMS_SPM package.">Managing SQL Plan Baselines</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="sect3"><a id="GUID-3B560F69-E021-409E-9EA0-9902EEEEC6FD" name="GUID-3B560F69-E021-409E-9EA0-9902EEEEC6FD"></a><h4 id="TGSQL-GUID-3B560F69-E021-409E-9EA0-9902EEEEC6FD" class="sect4"><span class="enumeration_section">28.7.1 </span>About Managing the SMB
                  </h4>
                  <div>
                     <p>Use the <code class="codeph">DBMS_SPM.CONFIGURE</code> procedure to set configuration options for the SMB and the maintenance of SQL plan baselines.
                     </p>
                     <p>The <code class="codeph">DBA_SQL_MANAGEMENT_CONFIG</code> view shows the current configuration settings for the SMB. The following table describes the parameters in the <code class="codeph">PARAMETER_NAME</code> column.
                     </p>
                     <div class="tblformal" id="GUID-3B560F69-E021-409E-9EA0-9902EEEEC6FD__CDEGBJCA">
                        <p class="titleintable">Table 28-12 Parameters in DBA_SQL_MANAGEMENT_CONFIG.PARAMETER_NAME</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="Parameters in DBA_SQL_MANAGEMENT_CONFIG.PARAMETER_NAME" summary="This table lists initialization parameters in DBA_SQL_MANAGEMENT_CONFIG.PARAMETER_NAME. Column 1 lists the parameters. Column 2 describes the parameters. " width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="37%" id="d140998e6541">Parameter</th>
                                 <th align="left" valign="bottom" width="63%" id="d140998e6544">Description</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="37%" id="d140998e6549" headers="d140998e6541 ">
                                    <p><code class="codeph">SPACE_BUDGET_PERCENT</code></p>
                                 </td>
                                 <td align="left" valign="top" width="63%" headers="d140998e6549 d140998e6544 ">
                                    <p>Maximum percent of <code class="codeph">SYSAUX</code> space that the SQL management base can use. The default is 10. The allowable range for this limit is between 1% and 50%.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="37%" id="d140998e6560" headers="d140998e6541 ">
                                    <p><code class="codeph">PLAN_RETENTION_WEEKS</code> 
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="63%" headers="d140998e6560 d140998e6544 ">
                                    <p>Number of weeks to retain unused plans before they are purged. The default is 53.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="37%" id="d140998e6569" headers="d140998e6541 "><code class="codeph">AUTO_CAPTURE_PARSING_SCHEMA_NAME</code></td>
                                 <td align="left" valign="top" width="63%" headers="d140998e6569 d140998e6544 ">A list of the form <code class="codeph">(% LIKE <span class="codeinlineitalic">a</span> OR % LIKE <span class="codeinlineitalic">b</span> ...) AND (% NOT LIKE <span class="codeinlineitalic">c</span> AND % NOT LIKE <span class="codeinlineitalic">d</span> ...)</code>, which is the internal representation of the parsing schema name filter. If no parsing schema filters exist, then one side of the outer conjunction will be absent.
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="37%" id="d140998e6590" headers="d140998e6541 "><code class="codeph">AUTO_CAPTURE_MODULE</code></td>
                                 <td align="left" valign="top" width="63%" headers="d140998e6590 d140998e6544 ">A list of the form <code class="codeph">(% LIKE <span class="codeinlineitalic">a</span> OR % LIKE <span class="codeinlineitalic">b</span> ...) AND (% NOT LIKE <span class="codeinlineitalic">c</span> AND % NOT LIKE <span class="codeinlineitalic">d</span> ...)</code>, which is the internal representation of the module filter. If no module filters exist, then one side of the outer conjunction will be absent.
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="37%" id="d140998e6611" headers="d140998e6541 "><code class="codeph">AUTO_CAPTURE_ACTION</code></td>
                                 <td align="left" valign="top" width="63%" headers="d140998e6611 d140998e6544 ">A list of the form <code class="codeph">(% LIKE <span class="codeinlineitalic">a</span> OR % LIKE <span class="codeinlineitalic">b</span> ...) AND (% NOT LIKE <span class="codeinlineitalic">c</span> AND % NOT LIKE <span class="codeinlineitalic">d</span> ...)</code>, which is the internal representation of the action filter. If no action filters exist, then one side of the outer conjunction will be absent.
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="37%" id="d140998e6632" headers="d140998e6541 "><code class="codeph">AUTO_CAPTURE_SQL_TEXT</code></td>
                                 <td align="left" valign="top" width="63%" headers="d140998e6632 d140998e6544 ">A list of the form <code class="codeph">(% LIKE <span class="codeinlineitalic">a</span> OR % LIKE <span class="codeinlineitalic">b</span> ...) AND (% NOT LIKE <span class="codeinlineitalic">c</span> AND % NOT LIKE <span class="codeinlineitalic">d</span> ...)</code>, which is the internal representation of the SQL text filter. If no SQL text filters exist, then one side of the outer conjunction will be absent.
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-3B560F69-E021-409E-9EA0-9902EEEEC6FD__GUID-E4BA7E94-E42D-4470-B0B1-4E8153E410DD">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><span class="q">"<a href="overview-of-sql-plan-management.html#GUID-A3A528EB-CC02-426D-90F7-3AE9FCBDC201" title="To be eligible for automatic plan capture, an executed statement must be repeatable, and it must not be excluded by any capture filters.">Eligibility for Automatic Initial Plan Capture</a>"</span></p>
                           </li>
                           <li>
                              <p><a href="../refrn/DBA_SQL_MANAGEMENT_CONFIG.html#REFRN-GUID-4E9C3D2A-93B8-49C5-9169-C54A9EB7431C" target="_blank"><span><cite>Oracle Database Reference</cite></span></a> to learn more about <code class="codeph">DBA_SQL_MANAGEMENT_CONFIG</code></p>
                           </li>
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tgsql&amp;id=ARPLS-GUID-D855D4B9-D071-4BB2-A554-38479867DE76" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> to learn more about <code class="codeph">DBMS_SPM.CONFIGURE</code></p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-sql-plan-baselines.html#GUID-DE976D2B-DBAD-498F-B933-D16B06CA9D2A" title="The SQL management base is a part of the data dictionary that resides in the SYSAUX tablespace. It stores statement logs, plan histories, SQL plan baselines, and SQL profiles.">Managing the SQL Management Base</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TGSQL94975"></a><a id="TGSQL663"></a><div class="props_rev_3"><a id="GUID-DF2EC31E-7BAB-45BB-B3B4-F1D1A4A13019" name="GUID-DF2EC31E-7BAB-45BB-B3B4-F1D1A4A13019"></a><h4 id="TGSQL-GUID-DF2EC31E-7BAB-45BB-B3B4-F1D1A4A13019" class="sect4"><span class="enumeration_section">28.7.2 </span>Changing the Disk Space Limit for the SMB
                  </h4>
                  <div>
                     <p>A weekly background process measures the total space occupied by the SMB.</p>
                     <div class="section">
                        <p>When the defined limit is exceeded, the process writes a warning to the alert log. The database generates alerts weekly until either the SMB space limit is increased, the size of the <code class="codeph">SYSAUX</code> tablespace is increased, or the disk space used by the SMB is decreased by purging SQL management objects (SQL plan baselines or SQL profiles). This task explains how to change the limit with the <code class="codeph">DBMS_SPM.CONFIGURE</code> procedure.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-DF2EC31E-7BAB-45BB-B3B4-F1D1A4A13019__GUID-71ADC834-0CB1-4287-9A5D-FA349D17D1B2">Assumptions</p>
                        <p>This tutorial assumes the following:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>The current SMB space limit is the default of 10%.</p>
                           </li>
                           <li>
                              <p>You want to change the percentage limit to 30%</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-DF2EC31E-7BAB-45BB-B3B4-F1D1A4A13019__GUID-8B92934F-56A0-40D5-94A7-D31C98943C67">To change the percentage limit of the SMB:</p>
                        <ol>
                           <li>
                              <p>Connect SQL*Plus to the database with the appropriate privileges, and then query the data dictionary to see the current space budget percent.</p>
                              <p>For example, execute the following query (sample output included):</p><pre class="pre codeblock"><code>SELECT PARAMETER_NAME, PARAMETER_VALUE AS "%_LIMIT", 
       ( SELECT sum(bytes/1024/1024) FROM DBA_DATA_FILES 
         WHERE TABLESPACE_NAME = 'SYSAUX' ) AS SYSAUX_SIZE_IN_MB,
       PARAMETER_VALUE/100 * 
       ( SELECT sum(bytes/1024/1024) FROM DBA_DATA_FILES 
         WHERE TABLESPACE_NAME = 'SYSAUX' ) AS "CURRENT_LIMIT_IN_MB"
FROM DBA_SQL_MANAGEMENT_CONFIG
WHERE PARAMETER_NAME = 'SPACE_BUDGET_PERCENT';

PARAMETER_NAME          %_LIMIT SYSAUX_SIZE_IN_MB CURRENT_LIMIT_IN_MB
-------------------- ---------- ----------------- -------------------
SPACE_BUDGET_PERCENT         10          211.4375            21.14375
</code></pre></li>
                           <li>
                              <p>Change the percentage setting.</p>
                              <p>For example, execute the following command to change the setting to 30%:</p><pre class="pre codeblock"><code>EXECUTE DBMS_SPM.CONFIGURE('space_budget_percent',30);
</code></pre></li>
                           <li>
                              <p>Query the data dictionary to confirm the change.</p>
                              <p>For example, execute the following join (sample output included):</p><pre class="pre codeblock"><code>SELECT PARAMETER_NAME, PARAMETER_VALUE AS "%_LIMIT", 
       ( SELECT sum(bytes/1024/1024) FROM DBA_DATA_FILES 
         WHERE TABLESPACE_NAME = 'SYSAUX' ) AS SYSAUX_SIZE_IN_MB,
       PARAMETER_VALUE/100 * 
       ( SELECT sum(bytes/1024/1024) FROM DBA_DATA_FILES 
         WHERE TABLESPACE_NAME = 'SYSAUX' ) AS "CURRENT_LIMIT_IN_MB"
FROM   DBA_SQL_MANAGEMENT_CONFIG
WHERE  PARAMETER_NAME = 'SPACE_BUDGET_PERCENT';

PARAMETER_NAME          %_LIMIT SYSAUX_SIZE_IN_MB CURRENT_LIMIT_IN_MB
-------------------- ---------- ----------------- -------------------
SPACE_BUDGET_PERCENT         <span class="bold">30</span>          211.4375            63.43125</code></pre></li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-DF2EC31E-7BAB-45BB-B3B4-F1D1A4A13019__GUID-B8531588-E06C-40D4-A976-F897213235AC">
                        <p class="notep1">See Also:</p>
                        <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tgsql&amp;id=ARPLS68159" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> to learn more about the <code class="codeph">DBMS_SPM.CONFIGURE</code> procedure
                        </p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-sql-plan-baselines.html#GUID-DE976D2B-DBAD-498F-B933-D16B06CA9D2A" title="The SQL management base is a part of the data dictionary that resides in the SYSAUX tablespace. It stores statement logs, plan histories, SQL plan baselines, and SQL profiles.">Managing the SQL Management Base</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TGSQL664"></a><div class="props_rev_3"><a id="GUID-D5F66DF0-3D41-4E78-9FAE-62ECC9F22F1F" name="GUID-D5F66DF0-3D41-4E78-9FAE-62ECC9F22F1F"></a><h4 id="TGSQL-GUID-D5F66DF0-3D41-4E78-9FAE-62ECC9F22F1F" class="sect4"><span class="enumeration_section">28.7.3 </span>Changing the Plan Retention Policy in the SMB
                  </h4>
                  <div>
                     <p>A weekly scheduled purging task manages disk space used by SQL plan management.</p>
                     <div class="section">
                        <p>The task runs as an automated task in the maintenance window. The database purges plans that have not been used for longer than the plan retention period, as identified by the <code class="codeph">LAST_EXECUTED</code> timestamp stored in the SMB for that plan. The default retention period is 53 weeks. The period can range between 5 and 523 weeks.
                        </p>
                        <p>This task explains how to change the plan retention period with the <code class="codeph">DBMS_SPM.CONFIGURE</code> procedure. In Cloud Control, set the plan retention policy in the SQL Plan Baseline subpage (shown in <a href="managing-sql-plan-baselines.html#GUID-9BB06D27-4A3F-4DBA-A7EB-85B5C4EA0631__CDEBHHEI">Figure 28-1</a>).
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-D5F66DF0-3D41-4E78-9FAE-62ECC9F22F1F__GUID-28FCB4F5-5009-433B-A5F6-B34AD2A01ADE">To change the plan retention period for the SMB:</p>
                        <ol>
                           <li>
                              <p>Connect SQL*Plus to the database with the appropriate privileges, and then query the data dictionary to see the current plan retention period.</p>
                              <p>For example, execute the following query (sample output included):</p><pre class="pre codeblock"><code>SQL&gt; SELECT PARAMETER_NAME, PARAMETER_VALUE
  2  FROM   DBA_SQL_MANAGEMENT_CONFIG
  3  WHERE  PARAMETER_NAME = 'PLAN_RETENTION_WEEKS';
 
PARAMETER_NAME                 PARAMETER_VALUE
------------------------------ ---------------
PLAN_RETENTION_WEEKS                        53
</code></pre></li>
                           <li>
                              <p>Change the retention period.</p>
                              <p>For example, execute the <code class="codeph">CONFIGURE</code> procedure to change the period to 105 weeks:
                              </p><pre class="pre codeblock"><code>EXECUTE DBMS_SPM.CONFIGURE('plan_retention_weeks',105);
</code></pre></li>
                           <li>
                              <p>Query the data dictionary to confirm the change.</p>
                              <p>For example, execute the following query:</p><pre class="pre codeblock"><code>SQL&gt; SELECT PARAMETER_NAME, PARAMETER_VALUE
  2  FROM   DBA_SQL_MANAGEMENT_CONFIG
  3  WHERE  PARAMETER_NAME = 'PLAN_RETENTION_WEEKS';
 
PARAMETER_NAME                 PARAMETER_VALUE
------------------------------ ---------------
PLAN_RETENTION_WEEKS                       <span class="bold">105</span></code></pre></li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-D5F66DF0-3D41-4E78-9FAE-62ECC9F22F1F__GUID-EC1F2994-7CAC-4023-B51B-5E30818CBB52">
                        <p class="notep1">See Also:</p>
                        <p><a href="../arpls/DBMS_SPM.html#ARPLS68159" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> to learn more about the <code class="codeph">CONFIGURE</code> procedure
                        </p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-sql-plan-baselines.html#GUID-DE976D2B-DBAD-498F-B933-D16B06CA9D2A" title="The SQL management base is a part of the data dictionary that resides in the SYSAUX tablespace. It stores statement logs, plan histories, SQL plan baselines, and SQL profiles.">Managing the SQL Management Base</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
         </div>
      </article>
   </body>
</html>