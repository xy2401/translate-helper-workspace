<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="These topics describe how to use Oracle Recovery Manager to create a standby database."></meta>
      <meta name="description" content="These topics describe how to use Oracle Recovery Manager to create a standby database."></meta>
      <title>使用Recovery Manager创建备用数据库</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Concepts and Administration "></meta>
      <meta property="og:description" content="These topics describe how to use Oracle Recovery Manager to create a standby database."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Concepts and Administration"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="data-guard-concepts-and-administration.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-02-12T10:50:21-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="1999, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96244-02"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="configuring-data-guard-standby-databases-in-oracle-RAC.html" title="Previous" type="text/html"></link>
      <link rel="next" href="setting-LOG_ARCHIVE_TRACE-initialization-parameter.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Data Guard Concepts and Administration"></meta>
    <meta name="dcterms.isVersionOf" content="SBYDB"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="configuring-data-guard-standby-databases-in-oracle-RAC.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="setting-LOG_ARCHIVE_TRACE-initialization-parameter.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">概念和管理</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="oracle-data-guard-supplemental-information.html" property="item" typeof="WebPage"><span property="name">附录</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">使用Recovery Manager创建备用数据库</li>
            </ol>
            <a id="GUID-82731D59-A20F-45DD-A235-267B3B0E38C5" name="GUID-82731D59-A20F-45DD-A235-267B3B0E38C5"></a><a id="SBYDB01500"></a>
            
            <h2 id="SBYDB-GUID-82731D59-A20F-45DD-A235-267B3B0E38C5" class="sect2"><span class="enumeration_chapter">E</span>使用Recovery Manager创建备用数据库</h2>
         </header>
         <div class="ind">
            <div>
               <p>这些主题描述了如何使用Oracle Recovery Manager创建备用数据库。</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="creating-data-guard-standby-database-using-RMAN.html#GUID-BFD2D916-17D6-4CC1-8BC0-2F333C54516D" title="在使用RMAN创建备用数据库之前，您应该熟悉数据库复制。">先决条件</a></p>
                  </li>
                  <li>
                     <p><a href="creating-data-guard-standby-database-using-RMAN.html#GUID-CAEE94C8-6C1A-4021-B93F-E9C65384418A" title="阅读本节以获取有关使用RMAN创建备用数据库所涉及的目的和基本概念的信息。">使用RMAN创建备用数据库概述</a></p>
                  </li>
                  <li>
                     <p><a href="creating-data-guard-standby-database-using-RMAN.html#GUID-D1694762-4B53-4828-B094-874DB1A6FC81" title="创建备用数据库的过程与RMAN重复过程基本相同。">使用DUPLICATE命令创建备用数据库</a></p>
                  </li>
               </ul>
            </div><a id="SBYDB4978"></a><div class="props_rev_3"><a id="GUID-BFD2D916-17D6-4CC1-8BC0-2F333C54516D" name="GUID-BFD2D916-17D6-4CC1-8BC0-2F333C54516D"></a><h3 id="SBYDB-GUID-BFD2D916-17D6-4CC1-8BC0-2F333C54516D" class="sect3"><span class="enumeration_section">E.1</span>先决条件</h3>
               <div>
                  <p>在使用RMAN创建备用数据库之前，您应该熟悉数据库复制。</p>
                  <p>因为您使用<code class="codeph">DUPLICATE</code>命令来创建具有RMAN的备用数据库，所以您还应该熟悉<code class="codeph">DUPLICATE</code>命令。
                  </p>
                  <p><span class="italic">在</span>尝试使用RMAN创建备用数据库<span class="italic">之前，</span>还要熟悉如何创建备用数据库。</p>
                  <div class="infoboxnotealso" id="GUID-BFD2D916-17D6-4CC1-8BC0-2F333C54516D__GUID-25AD1A68-D835-4098-8B61-FC215803136D">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>有关数据库复制的信息<a href="../bradv/rman-duplicating-databases.html#BRADV010" target="_blank"><span><cite>，请参见“Oracle数据库备份和恢复用户指南”</cite></span></a></p>
                        </li>
                        <li>
                           <p>有关RMAN <code class="codeph">DUPLICATE</code>命令的说明，请<a href="../rcmrf/DUPLICATE.html#RCMRF126" target="_blank"><span><cite>参见Oracle数据库备份和恢复参考</cite></span></a></p>
                        </li>
                        <li>
                           <p><a href="creating-oracle-data-guard-physical-standby.html#GUID-B511FB6E-E3E7-436D-94B5-071C37550170" title="您可以使用异步重做传输和实时应用（默认的Oracle Data Guard配置）以最高性能模式手动创建物理备用数据库。">创建物理备用数据库</a></p>
                        </li>
                        <li>
                           <p><a href="creating-oracle-data-guard-logical-standby.html#GUID-3666CA35-D993-44B6-8D70-A2B8B9EC8B2E" title="创建逻辑备用数据库涉及许多步骤，包括先决条件和创建后任务。">创建逻辑备用数据库</a></p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div><a id="SBYDB4979"></a><div class="props_rev_3"><a id="GUID-CAEE94C8-6C1A-4021-B93F-E9C65384418A" name="GUID-CAEE94C8-6C1A-4021-B93F-E9C65384418A"></a><h3 id="SBYDB-GUID-CAEE94C8-6C1A-4021-B93F-E9C65384418A" class="sect3"><span class="enumeration_section">E.2</span>使用RMAN创建备用数据库概述</h3>
               <div>
                  <p>阅读本节以获取有关使用RMAN创建备用数据库所涉及的目的和基本概念的信息。</p>
               </div><a id="SBYDB4980"></a><div class="props_rev_3"><a id="GUID-9864EED2-AE6E-4378-BA7C-1FB3971649E5" name="GUID-9864EED2-AE6E-4378-BA7C-1FB3971649E5"></a><h4 id="SBYDB-GUID-9864EED2-AE6E-4378-BA7C-1FB3971649E5" class="sect4"><span class="enumeration_section">E.2.1</span>使用RMAN创建备用数据库的目的</h4>
                  <div>
                     <p>您可以使用手动技术或RMAN <code class="codeph">DUPLICATE</code>命令从主数据库的备份创建备用数据库。
                     </p>
                     <p>您可以使用手动技术或RMAN <code class="codeph">DUPLICATE</code>命令从主数据库的备份创建备用数据库。使用RMAN创建备用数据库与手动技术相比具有以下优势：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>RMAN可以通过复制主数据库当前使用的文件来创建备用数据库。无需备份。</p>
                        </li>
                        <li>
                           <p>RMAN可以通过将主数据库的备份还原到备用站点来创建备用数据库。因此，在创建备用数据库期间，主数据库不受影响。</p>
                        </li>
                        <li>
                           <p>RMAN自动重命名文件，包括Oracle托管文件（OMF）和目录结构。</p>
                        </li>
                        <li>
                           <p>RMAN从备份还原存档的重做日志文件并执行介质恢复，以便同步备用数据库和主数据库。</p>
                        </li>
                     </ul>
                  </div>
               </div><a id="SBYDB4981"></a><div class="props_rev_3"><a id="GUID-C055CE69-9410-4B71-92B6-93C9B6F63197" name="GUID-C055CE69-9410-4B71-92B6-93C9B6F63197"></a><h4 id="SBYDB-GUID-C055CE69-9410-4B71-92B6-93C9B6F63197" class="sect4"><span class="enumeration_section">E.2.2</span>使用RMAN创建备用数据库的基本概念</h4>
                  <div>
                     <p>使用RMAN创建备用数据库的过程与创建重复数据库的过程几乎相同。</p>
                     <p>您需要修改“ <a href="../bradv/rman-duplicating-databases.html#BRADV89930" target="_blank"><span class="italic">Oracle数据库备份和恢复用户指南”中</span></a>描述的复制过程，以解决备用数据库特有的问题。
                     </p>
                     <p>要使用<code class="codeph">DUPLICATE</code>命令创建备用数据库，必须将目标连接到主数据库并指定<code class="codeph">FOR STANDBY</code>选项。您无法连接到备用数据库并创建其他备用数据库。RMAN通过还原和装入控制文件来创建备用数据库。RMAN可以使用主数据库控制文件的现有备份，因此您无需为备用数据库创建控制文件备份。
                     </p>
                     <p>与<span class="italic">没有</span> <code class="codeph">FOR</code> <code class="codeph">STANDBY</code> <code class="codeph">OPTION</code>的<code class="codeph">DUPLICATE</code>创建的重复数据库不同，备用数据库不会获得新的DBID。因此，请勿在备份数据库中注册恢复目录。
                     </p>
                  </div><a id="SBYDB4982"></a><div class="props_rev_3"><a id="GUID-DDC82FDB-86B6-4FF0-8C1A-7F3611C7F4F9" name="GUID-DDC82FDB-86B6-4FF0-8C1A-7F3611C7F4F9"></a><h5 id="SBYDB-GUID-DDC82FDB-86B6-4FF0-8C1A-7F3611C7F4F9" class="sect5"><span class="enumeration_section">E.2.2.1</span>活动数据库和基于备份的复制</h5>
                     <div>
                        <p>使用RMAN创建备用数据库时，必须在主动和基于备份的复制之间进行选择。</p>
                        <p>如果指定<code class="codeph">FROM ACTIVE DATABASE</code> ，则RMAN将数据文件直接从主数据库复制到备用数据库。必须安装或打开主数据库。
                        </p>
                        <p>如果未指定<code class="codeph">FROM ACTIVE DATABASE</code> ，则RMAN将执行基于备份的复制。RMAN将主数据文件的备份还原到备用数据库。创建和恢复备用数据库所需的所有备份和归档重做日志文件必须可由备用主机上的服务器会话访问。除非执行<code class="codeph">SET UNTIL</code>命令，否则RMAN将还原最新的数据文件。
                        </p>
                     </div>
                  </div><a id="SBYDB4983"></a><div class="props_rev_3"><a id="GUID-AC0FF3B1-456C-4EF5-BD3E-08014927B7B4" name="GUID-AC0FF3B1-456C-4EF5-BD3E-08014927B7B4"></a><h5 id="SBYDB-GUID-AC0FF3B1-456C-4EF5-BD3E-08014927B7B4" class="sect5"><span class="enumeration_section">E.2.2.2</span> RMAN环境中的DB_UNIQUE_NAME值</h5>
                     <div>
                        <p>与没有<code class="codeph">FOR STANDBY</code>选项的<code class="codeph">DUPLICATE</code>创建的重复数据库不同，备用数据库不会获得新的DBID。</p>
                        <p>在Oracle Data Guard环境中使用RMAN时，请将其连接到恢复目录。恢复目录可以存储环境中所有主数据库和备用数据库的元数据。不要在恢复目录中显式注册备用数据库。</p>
                        <p>Oracle Data Guard环境中的数据库通过初始化参数文件中的<code class="codeph">DB_UNIQUE_NAME</code>参数进行唯一标识。<code class="codeph">DB_UNIQUE_NAME</code>在具有相同DBID的所有数据库中必须是唯一的，以便RMAN在Oracle Data Guard环境中正常工作。
                        </p>
                        <div class="infoboxnotealso" id="GUID-AC0FF3B1-456C-4EF5-BD3E-08014927B7B4__GUID-F65661B2-E78E-4953-877D-F7E029C29F3A">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="../bradv/rman-architecture.html#BRADV89379" target="_blank"><span class="italic">Oracle数据库备份和恢复用户指南</span></a> ，概述Oracle Data Guard环境中的RMAN操作</p>
                        </div>
                     </div>
                  </div><a id="SBYDB4984"></a><div class="props_rev_3"><a id="GUID-A75EBEE4-CFD7-4205-B3D0-24AFFC1331AF" name="GUID-A75EBEE4-CFD7-4205-B3D0-24AFFC1331AF"></a><h5 id="SBYDB-GUID-A75EBEE4-CFD7-4205-B3D0-24AFFC1331AF" class="sect5"><span class="enumeration_section">E.2.2.3</span>恢复备用数据库</h5>
                     <div>
                        <p>默认情况下，RMAN在创建后不会恢复备用数据库。</p>
                        <p>RMAN将挂起备用数据库，但不会将备用数据库置于手动或受管恢复模式。RMAN断开连接并且不执行备用数据库的介质恢复。</p>
                        <p>要使RMAN在创建备用数据库后恢复备用数据库，备用控制文件必须可用于恢复。必须满足以下条件：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>备用数据库的结束恢复时间必须大于或等于备用控制文件的检查点SCN。</p>
                           </li>
                           <li>
                              <p>必须在备用站点上提供包含备用控制文件的检查点SCN的归档重做日志文件以进行恢复。</p>
                           </li>
                        </ul>
                        <p>确保满足这些条件的一种方法是在备份主数据库上的控制文件后发出<code class="codeph">ALTER</code> <code class="codeph">SYSTEM</code> <code class="codeph">ARCHIVE</code> <code class="codeph">LOG</code> <code class="codeph">CURRENT</code>语句。此语句归档主数据库的联机重做日志文件。然后，使用RMAN备份最新的归档重做日志文件，或将归档的重做日志文件移动到备用站点。
                        </p>
                        <p>使用<code class="codeph">DUPLICATE</code>命令的<code class="codeph">DORECOVER</code>选项指定您希望RMAN恢复备用数据库。创建备用数据库文件后，RMAN执行以下步骤：</p>
                        <ol>
                           <li>
                              <p>RMAN开始媒体恢复。如果恢复需要存档的重做日志文件，并且日志文件尚未存在于磁盘上，则RMAN会尝试还原备份。</p>
                           </li>
                           <li>
                              <p>RMAN将备用数据库恢复到指定的时间，系统更改号（SCN）或日志文件序列号，或者恢复到最新的归档重做日志文件（如果未指定前面的任何一个）。</p>
                           </li>
                           <li>
                              <p>RMAN离开后安装介质恢复备用数据库完成，但<span class="italic">没有</span>放置在手动或管理恢复模式的备用数据库。
                              </p>
                           </li>
                        </ol>
                     </div><a id="SBYDB4985"></a><div class="props_rev_3"><a id="GUID-730789B8-813C-433F-BF49-D34B4077DE77" name="GUID-730789B8-813C-433F-BF49-D34B4077DE77"></a><h6 id="SBYDB-GUID-730789B8-813C-433F-BF49-D34B4077DE77" class="sect6"><span class="enumeration_section">E.2.2.3.1</span>备用数据库重做日志文件</h6>
                        <div>
                           <p>RMAN自动在备用数据库上创建备用重做日志文件。</p>
                           <p>创建日志文件后，备用数据库会根据日志文件的常规规则维护和归档它们。</p>
                           <p>如果使用基于备份的复制，则在备用数据库上命名备用重做日志文件时，唯一的选项是日志文件的文件名，如备用控制文件中所指定。如果备用数据库上的日志文件名必须与主文件名不同，则一个选项是通过设置<code class="codeph">LOG_FILE_NAME_CONVERT</code>为备用重做日志指定文件名<a id="d68220e890" class="indexterm-anchor"></a><a id="d68220e894" class="indexterm-anchor"></a><a id="d68220e900" class="indexterm-anchor"></a>在备用初始化参数文件中。
                           </p>
                           <p>在备用数据库上指定备用重做日志文件的文件名时，请注意以下限制：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>如果主数据库和备用数据库对日志文件使用不同的命名约定，则必须使用<code class="codeph">LOG_FILE_NAME_CONVERT</code>参数来命名备用重做日志文件。
                                 </p>
                              </li>
                              <li>
                                 <p>你不能使用<code class="codeph"></code> <code class="codeph">SET</code> <code class="codeph">NEWNAME</code>或<code class="codeph"></code> <code class="codeph">CONFIGURE</code> <code class="codeph">AUXNAME</code>命令重命名备用重做日志文件。
                                 </p>
                              </li>
                              <li>
                                 <p>您不能使用<code class="codeph">DUPLICATE</code>命令的<code class="codeph">LOGFILE</code>子句为备用重做日志文件指定文件名。
                                 </p>
                              </li>
                              <li>
                                 <p>要使备用数据库上的备用重做日志文件名与主要重做日志文件名相同，必须指定<code class="codeph">DUPLICATE</code>命令的<code class="codeph">NOFILENAMECHECK</code>子句。否则，即使备用数据库是在其他主机上创建的，RMAN也会发出错误信号。
                                 </p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div><a id="SBYDB4986"></a><div class="props_rev_3"><a id="GUID-70DD3082-8678-4A06-92F0-7121ACAEBBE9" name="GUID-70DD3082-8678-4A06-92F0-7121ACAEBBE9"></a><h5 id="SBYDB-GUID-70DD3082-8678-4A06-92F0-7121ACAEBBE9" class="sect5"><span class="enumeration_section">E.2.2.4</span>备用数据库的密码文件</h5>
                     <div>
                        <p>如果使用活动数据库复制，则RMAN始终将密码文件复制到备用主机，因为备用数据库上的密码文件必须是目标数据库上密码文件的精确副本。</p>
                        <p>如果使用活动数据库复制，则RMAN始终将密码文件复制到备用主机，因为备用数据库上的密码文件必须是目标数据库上密码文件的精确副本。在这种情况下， <code class="codeph">PASSWORD FILE</code>子句不是必需的。RMAN会覆盖辅助实例的任何现有密码文件。对于基于备份的复制，您必须将主数据库上使用的密码文件复制到备用数据库，以便Oracle Data Guard发送日志。
                        </p>
                     </div>
                  </div>
               </div>
            </div><a id="SBYDB4987"></a><div class="props_rev_3"><a id="GUID-D1694762-4B53-4828-B094-874DB1A6FC81" name="GUID-D1694762-4B53-4828-B094-874DB1A6FC81"></a><h3 id="SBYDB-GUID-D1694762-4B53-4828-B094-874DB1A6FC81" class="sect3"><span class="enumeration_section">E.3</span>使用DUPLICATE命令创建备用数据库</h3>
               <div>
                  <p>创建备用数据库的过程与RMAN重复过程基本相同。</p>
                  <p>有关RMAN复制过程的信息，请参见“ <a href="../bradv/rman-duplicating-databases.html#BRADV168" target="_blank"><span class="italic">Oracle数据库备份和恢复用户指南”</span></a> 。
                  </p>
               </div><a id="SBYDB4988"></a><div class="props_rev_3"><a id="GUID-C713FD5C-3375-45E4-A78F-4063006DAC5B" name="GUID-C713FD5C-3375-45E4-A78F-4063006DAC5B"></a><h4 id="SBYDB-GUID-C713FD5C-3375-45E4-A78F-4063006DAC5B" class="sect4"><span class="enumeration_section">E.3.1</span>使用活动数据库复制创建备用数据库或远程同步实例</h4>
                  <div>
                     <p>您可以使用活动数据库复制来创建备用数据库或远程同步实例。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-C713FD5C-3375-45E4-A78F-4063006DAC5B__GUID-1D1E1A8A-DA98-4E70-A44D-48AABC584190">使用活动数据库复制创建备用数据库</p>
                        <div class="p">要使用RMAN <code class="codeph">DUPLICATE</code>命令从主数据库中处于活动状态的文件创建备用数据库，必须同时指定<code class="codeph">FOR STANDBY</code>和<code class="codeph">FROM ACTIVE DATABASE</code>选项。您也可以指定其他选项，例如<code class="codeph">DORECOVER</code> 。例如：<pre class="pre codeblock"><code>用于备用活动数据库多路复用器的重复目标数据库;</code></pre></div>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-C713FD5C-3375-45E4-A78F-4063006DAC5B__GUID-78EE8BDC-1F18-49BE-9BFA-6D39EA4EDA62">使用活动数据库复制创建远程同步实例</p>
                        <div class="p">从Oracle Database 12 <span class="italic">c</span>版本12.2（12.2.0.1）开始，您还可以使用RMAN <code class="codeph">DUPLICATE</code>命令从主数据库中处于活动状态的文件创建远程同步实例。为此， <code class="codeph">FARSYNC</code>在命令行上用<code class="codeph">FARSYNC</code>代替<code class="codeph">STANDBY</code> （不要指定<code class="codeph">DORECOVER</code>选项;远程同步实例不允许使用它）。例如：<pre class="pre codeblock"><code>来自活动数据库的FARSYNC的重复目标数据库;</code></pre></div>
                        <p><span class="bold">使用活动数据库复制创建备用数据库或远程同步实例的步骤</span></p>
                        <p>以下步骤从活动数据库文件创建备用数据库，但您也可以使用这些步骤从活动数据库文件创建远程同步实例。这些步骤假定备用主机（或远程同步实例）和主数据库主机具有相同的目录结构。</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>按照“ <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=BRADV167" target="_blank"><span class="italic">Oracle数据库备份和恢复用户指南”中的</span></a>说明准备辅助数据库实例。</span><div>
                              <p>由于您使用的是活动数据库复制，因此必须为辅助实例创建密码文件并建立Oracle Net连接。这是临时密码文件，在重复操作期间会被覆盖。</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>确定如何为备用控制文件，数据文件，联机重做日志和临时文件提供名称。“ <a href="../bradv/rman-duplicating-databases.html#BRADV298" target="_blank"><span class="italic">Oracle数据库备份和恢复用户指南”中</span></a>介绍了此步骤。</span><div>
                              <p>在此方案中，备用数据库文件的名称与主数据库文件的名称相同。</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>按照“ <a href="../bradv/rman-duplicating-databases.html#BRADV299" target="_blank"><span class="italic">Oracle数据库备份和恢复用户指南”中的</span></a>说明启动和配置RMAN。</span></li>
                        <li class="stepexpand"><span>执行<code class="codeph">DUPLICATE</code>命令。</span><div>
                              <div class="p">以下示例说明如何使用<code class="codeph">DUPLICATE</code>进行主动复制。此示例需要<code class="codeph">NOFILENAMECHECK</code>选项，因为主数据库文件与备用数据库文件具有相同的名称。日志传送正常工作需要<code class="codeph">SPFILE</code>的<code class="codeph">SET</code>子句。必须设置<code class="codeph">db_unique_name</code>以确保目录和Oracle Data Guard可以将此数据库标识为与主数据库不同。（可选）指定<code class="codeph">DORECOVER</code>选项以在备用数据库创建后恢复数据库（ <code class="codeph">DORECOVER</code>不是远程同步实例的有效选项）。<pre class="pre codeblock"><code>来自活动数据库的备用目标数据库DORECOVER SPFILE SET“db_unique_name”=“foou”COMMENT“是重复的”SET LOG_ARCHIVE_DEST_2 =“service = inst3 ASYNC REGISTER VALID_FOR =（online_logfile，primary_role）”SET FAL_SERVER =“inst1”COMMENT“Is初级“NOFILENAMECHECK;</code></pre></div>
                              <p>RMAN自动将服务器参数文件复制到备用主机，使用服务器参数文件启动辅助实例，还原备份控制文件，并通过网络将所有必需的数据库文件和归档重做日志复制到备用主机。RMAN恢复备用数据库，但不将其置于手动或受管恢复模式。</p>
                              <div class="p">如果您正在创建远程同步实例而不是备用数据库，则命令将是相同的，除了用<code class="codeph">FARSYNC</code>替换<code class="codeph">STANDBY</code> ，如下所示：<pre class="pre codeblock"><code>来自活动数据库SPFILE的FARSYNC的重复目标数据库“db_unique_name”=“foou”COMMENT“是重复的”SET LOG_ARCHIVE_DEST_2 =“service = inst3 ASYNC REGISTER VALID_FOR =（online_logfile，primary_role）”SET FAL_SERVER =“inst1”COMMENT“是主要的“NOFILENAMECHECK;</code></pre></div>
                              <div class="infoboxnote" id="GUID-C713FD5C-3375-45E4-A78F-4063006DAC5B__GUID-07151B0C-0F85-4BCF-9C82-983EEEB56052">
                                 <p class="notep1">注意：</p>如果主数据库是Oracle Real Application Clusters（Oracle RAC）数据库，并且目标备用数据库或远程同步实例将是单实例Oracle数据库，则将命令<code class="codeph">SET CLUSTER_DATABASE="FALSE"</code>到先前的RMAN示例。
                              </div>
                           </div>
                        </li>
                     </ol>
                  </div>
               </div><a id="SBYDB4989"></a><div class="props_rev_3"><a id="GUID-E9FBCFA9-20A2-49DD-8060-AA39100D7751" name="GUID-E9FBCFA9-20A2-49DD-8060-AA39100D7751"></a><h4 id="SBYDB-GUID-E9FBCFA9-20A2-49DD-8060-AA39100D7751" class="sect4"><span class="enumeration_section">E.3.2</span>使用基于备份的复制创建备用数据库</h4>
                  <div>
                     <p>您可以使用基于备份的复制来创建备用数据库或远程同步实例。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-E9FBCFA9-20A2-49DD-8060-AA39100D7751__GUID-766B6590-2EEA-4D5E-A4B3-E1D97CE95C17">使用基于备份的复制创建备用数据库</p>
                        <div class="p">要从备份创建备用数据库，请指定<code class="codeph">FOR STANDBY</code>但不指定<code class="codeph">FROM ACTIVE DATABASE</code> 。您也可以指定其他选项，例如<code class="codeph">DORECOVER</code> 。例如：<pre class="pre codeblock"><code>用于待机备份位置的重复目标数据库'+数据/备份'DORECOVER;</code></pre></div>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-E9FBCFA9-20A2-49DD-8060-AA39100D7751__GUID-C1F2097D-CCA9-4BC1-9C7A-C5BE693AC289">使用基于备份的复制创建远程同步实例</p>
                        <div class="p">从Oracle Database 12 <span class="italic">c</span>版本12.2（12.2.0.1）开始，您还可以使用基于备份的复制来使用RMAN <code class="codeph">DUPLICATE</code>命令创建Data Guard远程同步实例。为此， <code class="codeph">FARSYNC</code>在命令行上用<code class="codeph">FARSYNC</code>代替<code class="codeph">STANDBY</code> （不要指定<code class="codeph">DORECOVER</code>选项;远程同步实例不允许使用它）。例如：<pre class="pre codeblock"><code>FARSYNC BACKUP LOCATION'+ DATA / BACKUP'的重复目标数据库;</code></pre></div>
                        <p><span class="bold">从备份创建备用数据库或远程同步实例的步骤：</span></p>
                        <p>以下步骤从备份文件创建备用数据库，但您也可以使用这些步骤从备份文件创建远程同步实例。这些步骤假定备用主机（或远程同步实例）和主数据库主机具有相同的目录结构。</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>如<a href="../bradv/rman-duplicating-databases.html#BRADV89931" target="_blank"><span class="italic">Oracle数据库备份和恢复用户指南中</span></a>所述，使数据库备份和归档重做日志可用于重复主机上的辅助实例。</span></li>
                        <li class="stepexpand"><span>按照“ <a href="../bradv/rman-duplicating-databases.html#BRADV167" target="_blank"><span class="italic">Oracle数据库备份和恢复用户指南”中的</span></a>说明准备辅助数据库实例。</span></li>
                        <li class="stepexpand"><span>确定如何为备用控制文件，数据文件，联机重做日志和临时文件提供名称。“ <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=BRADV298" target="_blank"><span class="italic">Oracle数据库备份和恢复用户指南”中</span></a>介绍了此步骤。</span><div>
                              <p>在此方案中，备用数据库文件的名称与主数据库文件的名称相同。</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>按照“ <a href="../bradv/rman-duplicating-databases.html#BRADV299" target="_blank"><span class="italic">Oracle数据库备份和恢复用户指南”中的</span></a>说明启动和配置RMAN。</span></li>
                        <li class="stepexpand"><span>执行<code class="codeph">DUPLICATE</code>命令。</span><div>
                              <p>以下示例说明了如何将<code class="codeph">DUPLICATE</code>用于基于备份的复制。此示例需要<code class="codeph">NOFILENAMECHECK</code>选项，因为主数据库文件与备用数据库文件具有相同的名称。（可选）指定<code class="codeph">DORECOVER</code>选项以在备用数据库创建后恢复数据库（ <code class="codeph">DORECOVER</code>不是远程同步实例的有效选项）。
                              </p><pre class="pre codeblock"><code>STANDBY DORECOVER SPFILE SET的重复目标数据库“db_unique_name”=“foou”COMMENT“重复”SET LOG_ARCHIVE_DEST_2 =“service = inst3 ASYNC REGISTER VALID_FOR =（online_logfile，primary_role）”SET FAL_SERVER =“inst1”COMMENT“是主要的”NOFILENAMECHECK ;</code></pre><p>RMAN自动将服务器参数文件复制到备用主机，使用服务器参数文件启动辅助实例，并将所有必需的数据库文件和归档重做日志还原到备用主机。RMAN恢复备用数据库，但不将其置于手动或受管恢复模式。</p>
                           </div>
                        </li>
                     </ol>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>