<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="Oracle Automatic Storage Management (Oracle ASM) can be deployed using SQL*Plus."></meta>
      <meta name="description" content="Oracle Automatic Storage Management (Oracle ASM) can be deployed using SQL*Plus."></meta>
      <title>使用SQL * Plus在Oracle ASM中创建数据库文件</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Administrator&#39;s Guide"></meta>
      <meta property="og:description" content="Oracle Automatic Storage Management (Oracle ASM) can be deployed using SQL*Plus."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Administrator&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="automatic-storage-management-administrators-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-04-23T18:56:15-07:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2007, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96198-03"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="administer-filter-driver.html" title="Previous" type="text/html"></link>
      <link rel="next" href="glossary.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Automatic Storage Management Administrator&#39;s Guide"></meta>
    <meta name="dcterms.isVersionOf" content="OSTMG"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="administer-filter-driver.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="glossary.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">管理员指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="part-advanced-topics.html" property="item" typeof="WebPage"><span property="name">高级主题</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">使用SQL * Plus在Oracle ASM中创建数据库文件</li>
            </ol>
            <a id="GUID-321251DC-DC32-4461-940D-0C513A3CEC30" name="GUID-321251DC-DC32-4461-940D-0C513A3CEC30"></a><a id="OSTMG1390"></a>
            
            <h2 id="OSTMG-GUID-321251DC-DC32-4461-940D-0C513A3CEC30" class="sect2"><span class="enumeration_chapter">21</span>使用SQL * Plus在Oracle ASM中创建数据库文件</h2>
         </header>
         <div class="ind">
            <div>
               <p>可以使用SQL * Plus部署Oracle自动存储管理（Oracle ASM）。</p>
               <p>本节包含以下主题：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="create-db-asm-sqlplus.html#GUID-41FA8A5D-70D4-4CE7-A1A2-00220DE9B8F8">创建使用Oracle ASM的数据库</a></p>
                  </li>
                  <li>
                     <p><a href="create-db-asm-sqlplus.html#GUID-47E5C33B-17E0-4CDC-82AE-D0107269A1BA">在Oracle ASM中创建表空间</a></p>
                  </li>
                  <li>
                     <p><a href="create-db-asm-sqlplus.html#GUID-42519F90-AB27-46A8-9E59-18393C56C375">在Oracle ASM中创建重做日志</a></p>
                  </li>
                  <li>
                     <p><a href="create-db-asm-sqlplus.html#GUID-F134D595-7A9E-463E-9B46-548451484350">在Oracle ASM中创建控制文件</a></p>
                  </li>
                  <li>
                     <p><a href="create-db-asm-sqlplus.html#GUID-5CDC239C-7A50-4239-B95F-AE977F553B69">在Oracle ASM中创建存档日志文件</a></p>
                     <div class="infoboxnotealso" id="GUID-321251DC-DC32-4461-940D-0C513A3CEC30__GUID-FA15011A-4BB7-4298-A410-5016DC752E97">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="../admin/using-oracle-managed-files.html#ADMIN003" target="_blank"><span class="italic"><span><cite>Oracle数据库管理员指南</cite></span></span></a> ，了解有关使用Oracle托管文件（OMF）的信息</p>
                     </div>
                  </li>
               </ul>
            </div><a id="OSTMG13940"></a><div class="props_rev_3"><a id="GUID-41FA8A5D-70D4-4CE7-A1A2-00220DE9B8F8" name="GUID-41FA8A5D-70D4-4CE7-A1A2-00220DE9B8F8"></a><h3 id="OSTMG-GUID-41FA8A5D-70D4-4CE7-A1A2-00220DE9B8F8" class="sect3">创建使用Oracle ASM的数据库</h3>
               <div>
                  <p><a id="d216727e315" class="indexterm-anchor"></a><a id="d216727e317" class="indexterm-anchor"></a>建议创建数据库的方法是使用Database Configuration Assistant（DBCA）。但是，如果使用<code class="codeph">CREATE DATABASE</code>语句手动<code class="codeph">CREATE DATABASE</code> ，则Oracle ASM使您能够以最少的输入创建数据库及其所有基础文件。
                  </p>
                  <p>以下示例显示了<code class="codeph">CREATE DATABASE</code>语句的使用，其中Oracle ASM自动创建和管理数据库文件。 <a id="d216727e330" class="indexterm-anchor"></a>此示例使用以下Oracle ASM文件创建数据库：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>磁盘组<code class="codeph">data</code> <code class="codeph">SYSTEM</code>表空间数据文件。
                        </p>
                     </li>
                     <li>
                        <p>磁盘组<code class="codeph">data</code> <code class="codeph">SYSAUX</code>表空间数据文件。表空间在本地管理，具有自动段空间管理功能。
                        </p>
                     </li>
                     <li>
                        <p>具有两个在线日志组的多路复用联机重做日志，每个组在<code class="codeph">data</code>和<code class="codeph">fra</code> （快速恢复区域）中各有一个。
                        </p>
                     </li>
                     <li>
                        <p>如果启用了自动撤消管理模式，则在目录<code class="codeph">data</code>删除表空间数据文件。
                        </p>
                     </li>
                     <li>
                        <p>如果没有为<code class="codeph">CONTROL_FILES</code>初始化参数指定值，则为两个控制文件，一个在<code class="codeph">data</code> ，另一个在<code class="codeph">fra</code> （快速恢复区域）中。<code class="codeph">data</code>中的控制文件是主控制文件。
                        </p>
                     </li>
                  </ul>
                  <p>初始化参数文件中包含以下初始化参数设置：</p><pre class="oac_no_warn" dir="ltr">DB_CREATE_FILE_DEST = + data DB_RECOVERY_FILE_DEST = + fra DB_RECOVERY_FILE_DEST_SIZE = 10G</pre><p>可以在SQL提示符下运行以下语句：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; CREATE DATABASE orcl;</pre></div>
            </div><a id="OSTMG13950"></a><div class="props_rev_3"><a id="GUID-47E5C33B-17E0-4CDC-82AE-D0107269A1BA" name="GUID-47E5C33B-17E0-4CDC-82AE-D0107269A1BA"></a><h3 id="OSTMG-GUID-47E5C33B-17E0-4CDC-82AE-D0107269A1BA" class="sect3">在Oracle ASM中创建表空间</h3>
               <div>
                  <p><a id="d216727e531" class="indexterm-anchor"></a><a id="d216727e535" class="indexterm-anchor"></a>当Oracle ASM为永久表空间（或临时表空间的临时文件）创建数据文件时，数据文件将设置为自动可扩展，具有无限的最大大小和100 MB的默认大小。您可以使用<code class="codeph">AUTOEXTEND</code>子句覆盖此默认扩展性，使用<code class="codeph">SIZE</code>子句覆盖默认大小。
                  </p>
                  <p>Oracle ASM将属性应用于数据文件，如数据文件的系统默认模板中所指定，如<span class="q">“ <a href="asm-files-directories-templates.html#GUID-5C902590-C607-44E8-B32D-9505E9B8C3EE" title="模板用于设置在Oracle ASM磁盘组中创建的文件的属性。">管理磁盘组模板</a> ”</span>中的表所示。您还可以创建和指定自己的模板。
                  </p>
                  <p>由于表空间历史记录，表空间中的文件可能位于Oracle ASM文件和非Oracle ASM文件中。RMAN命令可以将非Oracle ASM文件重定位到Oracle ASM磁盘组，并使Oracle ASM文件可以作为非Oracle ASM文件重新定位。</p>
                  <p>例如，如果存在名为<code class="codeph">data</code>的磁盘组，则可以使用以下SQL语句在该磁盘组中创建表空间<code class="codeph">tblspace</code> ：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; CREATE TABLESPACE tblspace DATAFILE'+ data';</pre><p>以下示例说明了默认情况下Oracle ASM的用法。此示例使Oracle ASM能够为您创建和管理表空间数据文件，使用适用于大多数情况的Oracle提供的默认值。</p>
                  <p>假设以下初始化参数设置：</p><pre class="oac_no_warn" dir="ltr">DB_CREATE_FILE_DEST = +数据</pre><p>以下语句创建表空间及其数据文件：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; CREATE TABLESPACE tblspace;</pre></div>
            </div><a id="OSTMG13960"></a><div class="props_rev_3"><a id="GUID-42519F90-AB27-46A8-9E59-18393C56C375" name="GUID-42519F90-AB27-46A8-9E59-18393C56C375"></a><h3 id="OSTMG-GUID-42519F90-AB27-46A8-9E59-18393C56C375" class="sect3">在Oracle ASM中创建重做日志</h3>
               <div>
                  <p>可以在多个磁盘组中创建联机重做日志，可以隐式在初始化参数文件中创建，也可以在<code class="codeph">ALTER DATABASE...显式创建<code class="codeph">ALTER DATABASE...ADD LOGFILE</code>语句。每个联机日志在多个磁盘组中应该有一个日志成员。将自动生成日志文件成员的文件名。由于系统错误而创建的所有部分创建的重做日志文件都将自动删除。
                  </p>
                  <p>例如，如果存在名为<code class="codeph">data1</code>和<code class="codeph">data2</code>磁盘组，则可以使用以下SQL语句创建每个磁盘组中包含成员的日志文件：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; ALTER DATABASE ADD LOGFILE（'+ data1'，'+ data2'）;</pre><p>以下示例创建一个日志文件，其中包含每个磁盘组<code class="codeph">data1</code>和<code class="codeph">data2</code> 。这些参数设置包含在初始化参数文件中：</p><pre class="oac_no_warn" dir="ltr">DB_CREATE_ONLINE_LOG_DEST_1 = + data1 DB_CREATE_ONLINE_LOG_DEST_2 = + data2</pre><p>可以在SQL提示符下运行以下语句：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; ALTER DATABASE ADD LOGFILE;</pre></div>
            </div><a id="OSTMG13970"></a><div class="props_rev_3"><a id="GUID-F134D595-7A9E-463E-9B46-548451484350" name="GUID-F134D595-7A9E-463E-9B46-548451484350"></a><h3 id="OSTMG-GUID-F134D595-7A9E-463E-9B46-548451484350" class="sect3">在Oracle ASM中创建控制文件</h3>
               <div>
                  <p>可以在多个磁盘组中显式创建控制文件。将自动生成控制文件的文件名。</p>
                  <p>如果必须按名称指定控制文件，则可以使用别名文件名来引用Oracle ASM文件并使用易于理解的名称。在创建控件文件的规范中使用别名使您可以稍后使用用户指定的名称引用控件文件。也可以在<code class="codeph">CONTROL_FILES</code>初始化参数中将别名指定为控制文件名。
                  </p>
                  <p>创建控制文件时，应使用其Oracle ASM文件名的文件引用形式将存储在Oracle ASM磁盘组中的数据文件和日志文件提供给<code class="codeph">CREATE</code> <code class="codeph">CONTROLFILE</code>命令。但是，使用<code class="codeph">RESETLOGS</code>选项需要使用文件创建表单来指定日志文件。
                  </p>
                  <div class="example" id="GUID-F134D595-7A9E-463E-9B46-548451484350__CIHFHCBD">
                     <p class="titleinexample">示例21-1使用NORESETLOGS在Oracle ASM中创建控制文件</p>
                     <p>以下示例中的SQL语句由<code class="codeph">ALTER</code> <code class="codeph">DATABASE</code> <code class="codeph">BACKUP</code> <code class="codeph">CONTROLFILE</code> <code class="codeph">TO</code> <code class="codeph">TRACE</code>命令生成，该命令用于在磁盘组<code class="codeph">data</code>和<code class="codeph">fra</code>上创建数据文件和日志文件的数据库：</p><pre class="oac_no_warn" dir="ltr">创建CONTROLFILE重新使用数据库“ORCL”NORESETLOGS ARCHIVELOG MAXLOGFILES 16 MAXLOGMEMBERS 3 MAXDATAFILES 100 MAXINSTANCES 8 MAXLOGHISTORY 292 LOGFILE GROUP 1（'+ DATA / orcl / onlinelog / group_1.261.685366203'，'+ FRA / orcl / onlinelog / group_1.257.685366205'）SIZE 50M BLOCKSIZE 512，GROUP 2（'+ DATA / orcl / onlinelog / group_2.262.685366207'，'+ FRA / orcl / onlinelog / group_2.258.685366211'）SIZE 50M BLOCKSIZE 512，GROUP 3（'+ DATA / orcl / onlinelog / group_3 .263.685366213'，'+ FRA / orcl / onlinelog / group_3.259.685366215'）SIZE 50M BLOCKSIZE 512  -  STANDBY LOGFILE DATAFILE'+ DATA / orcl / datafile / system.256.685366089'，'+ DATA / orcl / datafile / sysaux.257.685366089 '，'+ DATA / orcl / datafile / undotbs1.258.685366091'，'+ DATA / orcl / datafile / users.259.685366091'字符集WE8MSWIN1252;</pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-F134D595-7A9E-463E-9B46-548451484350__CIHGBDFF">
                     <p class="titleinexample">示例21-2使用RESETLOGS在Oracle ASM中创建控制文件</p>
                     <p>以下示例是具有数据文件的数据库的<code class="codeph">CREATE</code> <code class="codeph">CONTROLFILE</code> SQL语句，但使用<code class="codeph">RESETLOGS</code>子句，该子句使用日志文件的创建表单：</p><pre class="oac_no_warn" dir="ltr">CREATE CONTROLFILE REUSE DATABASE“ORCL”RESETLOGS ARCHIVELOG MAXLOGFILES 16 MAXLOGMEMBERS 3 MAXDATAFILES 100 MAXINSTANCES 8 MAXLOGHISTORY 292 LOGFILE GROUP 1（'+ DATA / orcl / onlinelog / group_1.261.685366203'，'+ FRA / orcl / onlinelog / group_1.257.685366205'）SIZE 50M BLOCKSIZE 512，GROUP 2（'+ DATA / orcl / onlinelog / group_2.262.685366207'，'+ FRA / orcl / onlinelog / group_2.258.685366211'）SIZE 50M BLOCKSIZE 512，GROUP 3（'+ DATA / orcl / onlinelog / group_3 .263.685366213'，'+ FRA / orcl / onlinelog / group_3.259.685366215'）SIZE 50M BLOCKSIZE 512  -  STANDBY LOGFILE DATAFILE'+ DATA / orcl / datafile / system.256.685366089'，'+ DATA / orcl / datafile / sysaux.257.685366089 '，'+ DATA / orcl / datafile / undotbs1.258.685366091'，'+ DATA / orcl / datafile / users.259.685366091'字符集WE8MSWIN1252;</pre></div>
                  <!-- class="example" -->
               </div>
            </div><a id="OSTMG95747"></a><a id="OSTMG13980"></a><div class="props_rev_3"><a id="GUID-5CDC239C-7A50-4239-B95F-AE977F553B69" name="GUID-5CDC239C-7A50-4239-B95F-AE977F553B69"></a><h3 id="OSTMG-GUID-5CDC239C-7A50-4239-B95F-AE977F553B69" class="sect3">在Oracle ASM中创建存档日志文件</h3>
               <div>
                  <p><a id="d216727e1111" class="indexterm-anchor"></a><a id="d216727e1115" class="indexterm-anchor"></a>可以在<code class="codeph">LOG_ARCHIVE_DEST</code>和<code class="codeph">LOG_ARCHIVE_DEST_n</code>初始化参数中将磁盘组指定为归档日志目标。以这种方式指定目标时，将在具有唯一名称的默认子目录中创建存档日志文件名。但是，所有<code class="codeph">LOG_ARCHIVE_DEST_n</code>参数都必须具有唯一的字符串。要多次输入同一磁盘组，必须使用子目录。例如，您可以按如下方式设置<code class="codeph">LOG_ARCHIVE_DEST_n</code> ：</p><pre class="oac_no_warn" dir="ltr">LOG_ARCHIVE_DEST_1 ='LOCATION = + FRA / orcl / arc_1'LOG_ARCHIVE_DEST_2 ='LOCATION = + FRA / orcl / arc_2'...
</pre><p>如果<code class="codeph">LOG_ARCHIVE_DEST</code>设置为磁盘组名称，则忽略<code class="codeph">LOG_ARCHIVE_FORMAT</code> 。归档日志的唯一文件名由Oracle数据库在默认子目录下自动创建。如果<code class="codeph">LOG_ARCHIVE_DEST</code>设置为磁盘组中的目录，则<code class="codeph">LOG_ARCHIVE_FORMAT</code>具有文件别名的正常语义。仍在具有系统生成名称的磁盘组的默认目录中生成基础文件。
                  </p>
                  <p>您还可以将<code class="codeph">DB_RECOVERY_FILE_DEST</code>初始化参数设置为磁盘组目标。在<a href="create-db-asm-sqlplus.html#GUID-5CDC239C-7A50-4239-B95F-AE977F553B69__CIHHIGFC">例21-3中</a> ，在启用<code class="codeph">ARCHIVELOG</code>模式， <code class="codeph">DB_RECOVERY_FILE_DEST</code>设置为<code class="codeph">+FRA</code>磁盘组的情况下生成存档日志文件， <code class="codeph">ORCL</code>是<code class="codeph">DB_UNIQUE_NAME</code>参数的值。
                  </p>
                  <div class="infoboxnotealso" id="GUID-5CDC239C-7A50-4239-B95F-AE977F553B69__GUID-DE40F7E0-9A24-4AFC-A11F-0A9E1629D714">
                     <p class="notep1">也可以看看：</p>
                     <p>有关管理归档重做日志文件的信息，请参见<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/ostmg&amp;id=ADMIN008" target="_blank"><span class="italic">“Oracle数据库管理员指南”</span></a></p>
                  </div>
                  <div class="example" id="GUID-5CDC239C-7A50-4239-B95F-AE977F553B69__CIHHIGFC">
                     <p class="titleinexample">示例21-3 Oracle ASM磁盘组中的已归档日志文件</p><pre class="oac_no_warn" dir="ltr">SQL&gt; SHOW PARAMETER DB_RECOVERY_FILE_DEST NAME TYPE VALUE ------------------------------------ ------ ----- ------------------------------ db_recovery_file_dest string + FRA SQL&gt; SELECT SUBSTR（name，1,64） name FROM V $ ARCHIVED_LOG;名称  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  - - --------------- + FRA / ORCL / ARCHIVELOG / 2013_06_24 / thread_1_seq_112.260.818960623 + FRA / ORCL / ARCHIVELOG / 2013_06_24 / thread_1_seq_113.261.818978423 + FRA / ORCL / ARCHIVELOG / 2013_06_25 / thread_1_seq_114。 262.818993031 + FRA / ORCL / ARCHIVELOG / 2013_06_25 / thread_1_seq_115.263.819032439 + FRA / ORCL / ARCHIVELOG / 2013_06_25 / thread_1_seq_116.264.819047121 + FRA / ORCL / ARCHIVELOG / 2013_06_25 / thread_1_seq_117.265.819064815 + FRA / ORCL / ARCHIVELOG / 2013_06_26 / thread_1_seq_118.266.819079417。 ..</pre></div>
                  <!-- class="example" -->
               </div>
            </div>
         </div>
      </article>
   </body>
</html>