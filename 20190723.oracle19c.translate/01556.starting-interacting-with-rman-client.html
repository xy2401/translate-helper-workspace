<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>启动并与RMAN客户端交互</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Backup and Recovery User&#39;s Guide"></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Backup and Recovery User&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="database-backup-and-recovery-users-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-09T05:20:45-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2003, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96241-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="rman-architecture.html" title="Previous" type="text/html"></link>
      <link rel="next" href="configuring-rman-client-basic.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database Backup and Recovery User&#39;s Guide"></meta>
    <meta name="dcterms.isVersionOf" content="BRADV"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="rman-architecture.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="configuring-rman-client-basic.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">备份和恢复用户指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="part-starting-configuring-rman.html" property="item" typeof="WebPage"><span property="name">启动和配置RMAN和闪回数据库</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">启动并与RMAN客户端交互</li>
            </ol>
            <a id="GUID-E4E287F5-5F36-431A-B069-F360A5B4BC7C" name="GUID-E4E287F5-5F36-431A-B069-F360A5B4BC7C"></a><a id="BRADV005"></a>
            
            <h2 id="BRADV-GUID-E4E287F5-5F36-431A-B069-F360A5B4BC7C" class="sect2"><span class="enumeration_chapter">4</span>启动并与RMAN客户端交互</h2>
         </header>
         <div class="ind">
            <div>
               <p>本章介绍如何启动RMAN命令行界面并建立数据库连接。本章包含以下主题：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="starting-interacting-with-rman-client.html#GUID-92CF0473-8B35-48A8-BA49-4DC52A7ECBC0" title="RMAN可执行文件随数据库自动安装，通常与其他数据库可执行文件位于同一目录中。例如，Linux上的RMAN客户端位于$ ORACLE_HOME / bin中。">启动和退出RMAN</a></p>
                  </li>
                  <li>
                     <p><a href="starting-interacting-with-rman-client.html#GUID-E07231B2-F213-4F8F-8D02-E410A6DAE94C" title="您可以从RMAN客户端或操作系统命令行创建数据库连接。可以使用密码文件或操作系统身份验证对这些数据库连接进行身份验证。">使用RMAN建立数据库连接</a></p>
                  </li>
                  <li>
                     <p><a href="starting-interacting-with-rman-client.html#GUID-507D61EC-3D28-4C67-8013-BE724AD89FFD" title="默认情况下，RMAN将命令输出写入标准输出。要将输出重定向到日志文件，请在启动RMAN时在命令行上输入LOG参数。">指定RMAN输出的位置</a></p>
                  </li>
                  <li>
                     <p><a href="starting-interacting-with-rman-client.html#GUID-F600535A-D46A-4BB1-88FD-266396ECE795" title="在调用RMAN之前，设置NLS_DATE_FORMAT和NLS_LANG环境变量可能很有用。这些变量确定RMAN命令（如RESTORE，RECOVER和REPORT）中时间参数的格式。">为RMAN设置全球化支持环境变量</a></p>
                  </li>
                  <li>
                     <p><a href="starting-interacting-with-rman-client.html#GUID-D7BEDDA1-26CF-47E0-B55F-85E3CA238ECA" title="当RMAN客户端为命令做好准备时，它会显示命令提示符对于重复性任务，您可以创建包含RMAN命令的文本文件，并使用@参数启动RMAN客户端，然后使用文件名。RMAN中的注释字符是井号（＃）。从井号到行尾的所有文本都将被忽略。运行命令文件时，可以在USING子句中指定一个或多个值，以便在命令文件中的替换变量中使用。通过这种方式，您可以使命令文件动态化。您可以在不执行它们的情况下测试RMAN命令的语法正确性。使用命令行参数CHECKSYNTAX以一种模式启动RMAN客户端，在该模式下，它仅解析您输入的命令，并为不合法的RMAN语法的命令返回RMAN-00558错误。您可以交互式检查RMAN命令的语法，而无需实际执行命令。要在命令文件中测试命令，请使用CHECKSYNTAX参数启动RMAN，并使用@命令命名要传递的命令文件。">输入RMAN命令</a></p>
                  </li>
                  <li>
                     <p><a href="starting-interacting-with-rman-client.html#GUID-2273E896-C08B-498F-B96C-55400CCD1A17" title="RMAN管道接口是向RMAN发出命令并从这些命令接收输出的另一种方法。使用此接口，可以将可移植的编程接口写入RMAN。">使用RMAN管道接口</a></p>
                  </li>
               </ul>
            </div><a id="BRADV8121"></a><div class="props_rev_3"><a id="GUID-92CF0473-8B35-48A8-BA49-4DC52A7ECBC0" name="GUID-92CF0473-8B35-48A8-BA49-4DC52A7ECBC0"></a><h3 id="BRADV-GUID-92CF0473-8B35-48A8-BA49-4DC52A7ECBC0" class="sect3"><span class="enumeration_section">4.1</span>启动和退出RMAN</h3>
               <div>
                  <p>RMAN可执行文件随数据库自动安装，通常与其他数据库可执行文件位于同一目录中。例如，Linux上的RMAN客户端位于<code class="codeph">$ORACLE_HOME/bin</code> 。
                  </p>
                  <div class="section">
                     <p>您有以下启动RMAN的基本选项：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type:disc">
                        <li>
                           <p>在操作系统命令行中启动RMAN可执行文件，而不指定任何连接选项，如以下示例所示：</p><pre class="oac_no_warn" dir="ltr">％rman</pre><p>请参阅<span class="q">“ <span><a href="starting-interacting-with-rman-client.html#GUID-E40A23BB-BE65-4665-B57D-F0D11FFDD305" title="如果在操作系统命令行上启动没有连接字符串的RMAN，则必须在RMAN提示符下发出CONNECT TARGET命令以连接到目标数据库。">从RMAN提示符进行数据库连接</a></span> ”</span> 。
                           </p>
                        </li>
                        <li>
                           <p>在操作系统命令行中启动RMAN可执行文件，如以下示例所示：</p><pre class="oac_no_warn" dir="ltr">％rman TARGET /％rman TARGET sbu @ prod NOCATALOG</pre><p>请参阅<span class="q">“ <span><a href="starting-interacting-with-rman-client.html#GUID-241D7D37-D905-4E52-99B6-3FD57AE1717B" title="要从操作系统命令行连接到目标数据库，请输入rman命令，然后输入连接信息。您可以在显示RMAN提示后开始执行命令。">从操作系统命令行进行RMAN数据库连接</a></span> ”</span> 。
                           </p>
                        </li>
                     </ul>
                     <p>要退出RMAN并终止程序，请在RMAN提示符下输入<code class="codeph">EXIT</code>或<code class="codeph">QUIT</code> ：</p><pre class="oac_no_warn" dir="ltr">RMAN&gt;退出</pre><div class="infoboxnotealso" id="GUID-92CF0473-8B35-48A8-BA49-4DC52A7ECBC0__GUID-9283C17C-0D6E-407B-B7B7-55E7776BE872">
                        <p class="notep1">也可以看看：</p>
                        <p>适用于RMAN命令行语法的<span class="italic"><span><a href="../rcmrf/RMAN.html#RCMRF111" target="_blank">Oracle数据库备份和恢复参考</a></span></span></p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="BRADV8123"></a><div class="props_rev_3"><a id="GUID-E07231B2-F213-4F8F-8D02-E410A6DAE94C" name="GUID-E07231B2-F213-4F8F-8D02-E410A6DAE94C"></a><h3 id="BRADV-GUID-E07231B2-F213-4F8F-8D02-E410A6DAE94C" class="sect3"><span class="enumeration_section">4.2</span>使用RMAN建立数据库连接</h3>
               <div>
                  <p>您可以从RMAN客户端或操作系统命令行创建数据库连接。可以使用密码文件或操作系统身份验证对这些数据库连接进行身份验证。</p>
                  <p>本节包含以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="starting-interacting-with-rman-client.html#GUID-10B522E4-BA12-4B74-A77A-E189BFF6E59C" title="要执行有用的工作，RMAN客户端必须连接到数据库。">关于RMAN数据库连接类型</a></p>
                     </li>
                     <li>
                        <p><a href="starting-interacting-with-rman-client.html#GUID-BF676275-B5A4-46BE-8CDC-544906C416D2" title="与RMAN连接到目标或辅助数据库的用户需要SYSDBA或SYSBACKUP系统特权。">关于RMAN数据库连接的身份验证</a></p>
                     </li>
                     <li>
                        <p><span><a href="starting-interacting-with-rman-client.html#GUID-E40A23BB-BE65-4665-B57D-F0D11FFDD305" title="如果在操作系统命令行上启动没有连接字符串的RMAN，则必须在RMAN提示符下发出CONNECT TARGET命令以连接到目标数据库。">从RMAN提示符进行数据库连接</a></span></p>
                     </li>
                     <li>
                        <p><span><a href="starting-interacting-with-rman-client.html#GUID-241D7D37-D905-4E52-99B6-3FD57AE1717B" title="要从操作系统命令行连接到目标数据库，请输入rman命令，然后输入连接信息。您可以在显示RMAN提示后开始执行命令。">从操作系统命令行进行RMAN数据库连接</a></span></p>
                     </li>
                     <li>
                        <p><span><a href="starting-interacting-with-rman-client.html#GUID-067E6833-4A5B-46E4-89F0-D3C3B4FD1D75" title="要使用DUPLICATE命令，必须连接到辅助实例。执行表空间时间点恢复（TSPITR）可能还需要连接到辅助实例。">将RMAN连接到辅助数据库</a></span></p>
                     </li>
                     <li>
                        <p><span><a href="starting-interacting-with-rman-client.html#GUID-B397ADD8-D9CF-4DDA-B6AC-8C5FF04447AD" title="您可以将RMAN客户端连接到多租户容器数据库（CDB）和可插拔数据库（PDB）。">与CDB建立RMAN连接</a></span></p>
                     </li>
                     <li>
                        <p><span><a href="starting-interacting-with-rman-client.html#GUID-243F06D7-4CEC-4472-BA6B-79D8C9EEF07F" title="您可以通过创建包含CONNECT命令的RMAN命令文件来建立数据库连接。">在命令文件中建立RMAN数据库连接</a></span></p>
                     </li>
                     <li>
                        <p><span><a href="starting-interacting-with-rman-client.html#GUID-B7F7CDF4-3F34-4D20-AD36-10E2067DD7C6" title="在诊断RMAN在连接目标，目录和辅助数据库时遇到的错误时，请考虑使用SQL * Plus直接连接到数据库。此操作可以揭示连接信息或数据库的潜在问题。">诊断RMAN连接问题</a></span></p>
                     </li>
                  </ul>
               </div><a id="BRADV151"></a><a id="BRADV89390"></a><div class="props_rev_3"><a id="GUID-10B522E4-BA12-4B74-A77A-E189BFF6E59C" name="GUID-10B522E4-BA12-4B74-A77A-E189BFF6E59C"></a><h4 id="BRADV-GUID-10B522E4-BA12-4B74-A77A-E189BFF6E59C" class="sect4"><span class="enumeration_section">4.2.1</span>关于RMAN数据库连接类型</h4>
                  <div>
                     <p>要执行有用的工作，RMAN客户端必须连接到数据库。</p>
                     <p><a href="starting-interacting-with-rman-client.html#GUID-10B522E4-BA12-4B74-A77A-E189BFF6E59C__CEGHGAFD" title="RMAN数据库连接的类型">表4-1</a>介绍了可以使用RMAN进行的数据库连接类型。</p>
                     <div class="tblformal" id="GUID-10B522E4-BA12-4B74-A77A-E189BFF6E59C__CEGHGAFD">
                        <p class="titleintable">表4-1 RMAN数据库连接概述</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="RMAN数据库连接概述" width="100%" border="1" summary="Types of RMAN database connections" frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="29%" id="d19045e569">数据库连接的类型</th>
                                 <th align="left" valign="bottom" width="14%" id="d19045e572">关键词</th>
                                 <th align="left" valign="bottom" width="57%" id="d19045e575">描述</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="29%" id="d19045e580" headers="d19045e569 ">
                                    <p><a href="glossary.html#GUID-272C4366-303F-4629-9679-1379AAC3FBC1"><span class="xrefglossterm">目标数据库</span></a></p>
                                 </td>
                                 <td align="left" valign="top" width="14%" headers="d19045e580 d19045e572 ">
                                    <p><code class="codeph">目标</code></p>
                                 </td>
                                 <td align="left" valign="top" width="57%" headers="d19045e580 d19045e575 ">
                                    <p>RMAN备份或恢复的数据库</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="29%" id="d19045e593" headers="d19045e569 ">
                                    <p><a href="glossary.html#GUID-C54D9858-2461-412B-95FF-80FBACD58AB0"><span class="xrefglossterm">恢复目录数据库</span></a></p>
                                 </td>
                                 <td align="left" valign="top" width="14%" headers="d19045e593 d19045e572 ">
                                    <p><code class="codeph">目录</code></p>
                                 </td>
                                 <td align="left" valign="top" width="57%" headers="d19045e593 d19045e575 ">
                                    <p>一种数据库，除控制文件外，还为RMAN存储库提供可选的备份存储。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="29%" id="d19045e606" headers="d19045e569 ">
                                    <p><a href="glossary.html#GUID-4B8BBEA0-2F0F-4C5E-AE69-F1EE4DBA1B46"><span class="xrefglossterm">辅助实例</span></a>或<a href="glossary.html#GUID-C179BB7F-F134-4D10-AADB-335526DB2BBA"><span class="xrefglossterm">辅助数据库</span></a></p>
                                 </td>
                                 <td align="left" valign="top" width="14%" headers="d19045e606 d19045e572 ">
                                    <p><code class="codeph">辅助</code></p>
                                 </td>
                                 <td align="left" valign="top" width="57%" headers="d19045e606 d19045e575 ">
                                    <p><a href="glossary.html#GUID-009B3F56-8C1E-4CF6-AF0F-A9D2C2E4B9C2"><span class="xrefglossterm">物理备用数据库</span></a>或为执行特定任务而创建的数据库实例，例如创建<a href="glossary.html#GUID-FFB6CFD5-300C-4290-B3C0-BFD930ACA30C"><span class="xrefglossterm">重复数据库</span></a> ，传输表空间或执行<a href="glossary.html#GUID-8A257409-B3DC-41FD-A2AF-D47560FF9F18"><span class="xrefglossterm">表空间时间点恢复（TSPITR）</span></a> 。
                                    </p>
                                    <p>对于使用辅助数据库的许多任务，RMAN会创建一个自动辅助实例，以便在任务期间使用，连接到它，执行任务，然后在任务完成时销毁它。您不提供任何显式命令来连接到自动辅助实例。</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div>
               </div><a id="BRADV89391"></a><div class="props_rev_3"><a id="GUID-BF676275-B5A4-46BE-8CDC-544906C416D2" name="GUID-BF676275-B5A4-46BE-8CDC-544906C416D2"></a><h4 id="BRADV-GUID-BF676275-B5A4-46BE-8CDC-544906C416D2" class="sect4"><span class="enumeration_section">4.2.2</span>关于RMAN数据库连接的身份验证</h4>
                  <div>
                     <p>与RMAN连接到目标或辅助数据库的用户需要<code class="codeph">SYSDBA</code>或<code class="codeph">SYSBACKUP</code>系统特权。
                     </p>
                     <p>连接到恢复目录时不需要这些权限。您必须将<code class="codeph">RECOVERY_CATALOG_OWNER</code>角色授予目录架构所有者。用户还可以使用恢复目录所有者创建的VPC凭据连接到恢复目录。
                     </p>
                     <p>RMAN提供了SQL * Plus可用的相同身份验证选项。使用目标数据库和辅助数据库进行身份验证的最常用方法是：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>操作系统认证</p>
                           <p>用于使用操作系统认证连接的先决条件描述于<span class="q">“ <a href="starting-interacting-with-rman-client.html#GUID-703C639F-D05F-4130-8489-02E2BA6F1D26" title="可以使用操作系统身份验证来建立到目标或辅助数据库的RMAN连接。">验证使用操作系统</a> ”。</span>
                           </p>
                        </li>
                        <li>
                           <p>密码文件验证</p>
                           <p>使用密码文件认证连接的先决条件<span class="q">“</span>中描述<span class="q"><a href="starting-interacting-with-rman-client.html#GUID-45C00A07-B22E-4199-BCCA-91D02FCABF8D" title="使用密码文件进行本地或远程访问。如果数据库使用密码文件对管理用户进行身份验证，则RMAN可以使用密码进行连接。">的身份验证使用密码文件</a> ”。</span>
                           </p>
                        </li>
                     </ul>
                     <p>这两种方法都不需要打开数据库。操作系统身份验证仅用于本地连接。密码文件身份验证可用于本地或远程连接。</p>
                     <div class="infoboxnotealso" id="GUID-BF676275-B5A4-46BE-8CDC-544906C416D2__GUID-EA573EA5-7154-4ED5-8AFC-0CC60546C206">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="../admin/getting-started-with-database-administration.html#ADMIN-GUID-7842AF72-DA25-4559-A8E7-9883D0C63BF2" target="_blank"><span><cite>Oracle数据库管理员指南</cite></span></a> ，了解使用SQL * Plus时的数据库连接选项</p>
                           </li>
                           <li>
                              <p>有关<code class="codeph">SYSDBA</code>和<code class="codeph">SYSBACKUP</code>系统特权的详细信息，请参见“ <a href="../dbseg/configuring-privilege-and-role-authorization.html#DBSEG785" target="_blank"><span><cite>Oracle数据库安全指南”</cite></span></a></p>
                           </li>
                        </ul>
                     </div>
                  </div><a id="BRADV638"></a><a id="BRADV639"></a><a id="BRADV661"></a><a id="BRADV90309"></a><div class="props_rev_3"><a id="GUID-703C639F-D05F-4130-8489-02E2BA6F1D26" name="GUID-703C639F-D05F-4130-8489-02E2BA6F1D26"></a><h5 id="BRADV-GUID-703C639F-D05F-4130-8489-02E2BA6F1D26" class="sect5"><span class="enumeration_section">4.2.2.1</span>使用操作系统进行身份验证</h5>
                     <div>
                        <p>可以使用操作系统身份验证来建立到目标或辅助数据库的RMAN连接。</p>
                        <div class="section">
                           <p>以下是使用操作系统身份验证（OS身份验证）连接到数据库的先决条件：</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>您必须设置<code class="codeph">ORACLE_SID</code>环境变量，指定数据库的系统标识符（SID）。
                                 </p>
                                 <p>例如，要在某些UNIX shell中将SID设置为<code class="codeph">prod</code> ，请输入：</p><pre class="oac_no_warn" dir="ltr">％ORACLE_SID = prod;导出ORACLE_SID</pre></li>
                              <li>
                                 <p>您必须是OSDBA操作系统组的成员才能连接<code class="codeph">SYSDBA</code>权限或OSBACKUPDBA操作系统组以连接<code class="codeph">SYSBACKUP</code>权限。
                                 </p>
                                 <p>在UNIX和Linux上，OSDBA组通常命名为<code class="codeph">dba</code> ，OSBACKUPDBA组通常命名为<code class="codeph">backupdba</code> 。在数据库安装期间分配这些名称。
                                 </p>
                              </li>
                           </ul>
                           <p>以下示例说明如何使用操作系统身份验证连接到目标数据库。</p>
                           <div class="infoboxnotealso" id="GUID-703C639F-D05F-4130-8489-02E2BA6F1D26__GUID-AF5076A7-EA39-4DD7-9B20-B49C2F43A924">
                              <p class="notep1">也可以看看：</p>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=ADMIN11053" target="_blank"><span class="italic">“Oracle数据库管理员指南”，</span></a>用于讨论操作系统组</p>
                           </div>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-703C639F-D05F-4130-8489-02E2BA6F1D26__GUID-51A530F9-E2B6-423C-B27A-35909FFB5502">
                           <p class="titleinexample">示例4-1具有SYSDBA权限的OS身份验证 - 显式</p><pre class="oac_no_warn" dir="ltr">％rman target'“/ as sysdba”'</pre></div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-703C639F-D05F-4130-8489-02E2BA6F1D26__GUID-E6DF9A7D-9BA1-4DD0-8A9B-7C6D27602294">
                           <p class="titleinexample">示例4-2使用SYSBACKUP权限的OS身份验证 - 显式</p><pre class="oac_no_warn" dir="ltr">％rman target'“/ as sysbackup”'</pre></div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-703C639F-D05F-4130-8489-02E2BA6F1D26__GUID-40F466F4-7510-4A7B-BDFF-545ADAD1B315">
                           <p class="titleinexample">示例4-3具有SYSDBA权限的OS身份验证 - 隐式</p><pre class="oac_no_warn" dir="ltr">rman目标/</pre><p>如果在连接字符串中既未指定<code class="codeph">AS SYSBACKUP</code>也未指定<code class="codeph">AS SYSDBA</code> ，则使用的默认值为<code class="codeph">AS SYSDBA</code> 。</p>
                        </div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="BRADV662"></a><a id="BRADV663"></a><a id="BRADV664"></a><a id="BRADV90306"></a><div class="props_rev_3"><a id="GUID-45C00A07-B22E-4199-BCCA-91D02FCABF8D" name="GUID-45C00A07-B22E-4199-BCCA-91D02FCABF8D"></a><h5 id="BRADV-GUID-45C00A07-B22E-4199-BCCA-91D02FCABF8D" class="sect5"><span class="enumeration_section">4.2.2.2</span>使用密码文件进行身份验证</h5>
                     <div>
                        <p>使用密码文件进行本地或远程访问。如果数据库使用密码文件对管理用户进行身份验证，则RMAN可以使用密码进行连接。</p>
                        <div class="section">
                           <p>数据库必须使用<a href="glossary.html#GUID-AFB3C6E2-4C77-460F-A64D-A980EBF628EB"><span class="xrefglossterm">密码文件</span></a>才能使用网络服务名远程连接。
                           </p>
                           <div class="infoboxnote" id="GUID-45C00A07-B22E-4199-BCCA-91D02FCABF8D__GUID-DF96C77B-2DE4-4A80-A3D8-8DFF1AD61763">
                              <p class="notep1">警告：</p>
                              <p>良好的安全性要求不要在命令行上以纯文本形式输入密码。仅在RMAN提示请求时在RMAN中输入密码。请参阅<a href="../dbseg/configuring-authentication.html#DBSEG0032" target="_blank"><span class="italic">Oracle数据库安全指南</span></a>以了解密码保护。
                              </p>
                           </div>
                           <p>将<code class="codeph">SYSDBA</code>或<code class="codeph">SYSBACKUP</code>权限授予用户时，数据库会在密码文件中创建一个条目。然后，即使数据库未打开，您也可以以此用户身份连接到目标或辅助数据库。
                           </p>
                           <p>要支持通过密码文件与<code class="codeph">SYSBACKUP</code>权限进行连接，必须在Oracle Database 12 <span class="italic">c</span>第1版（12.1）或更高版本的格式中创建或升级密码文件。
                           </p>
                           <p>如果在连接字符串中既未指定<code class="codeph">AS SYSBACKUP</code>也未指定<code class="codeph">AS SYSDBA</code> ，则使用的默认值为<code class="codeph">AS SYSDBA</code> 。在这种情况下，不需要附上引号。
                           </p>
                           <div class="infoboxnotealso" id="GUID-45C00A07-B22E-4199-BCCA-91D02FCABF8D__GUID-34DE1A91-6906-4DDE-899F-EB7675F14886">
                              <p class="notep1">也可以看看：</p>
                              <p><a href="../admin/getting-started-with-database-administration.html#ADMIN11056" target="_blank"><span class="italic">Oracle数据库管理员指南</span></a> ，了解密码文件</p>
                           </div>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-45C00A07-B22E-4199-BCCA-91D02FCABF8D__GUID-DE1E5ADD-DDC7-43FD-B624-7DC03E5CDFAE">
                           <p class="titleinexample">示例4-4密码文件身份验证为SYSDBA  - 显式</p>
                           <p>在此示例中， <code class="codeph">sdba</code>用户已被授予<code class="codeph">SYSDBA</code>权限：</p><pre class="oac_no_warn" dir="ltr">％rman target'“sdba @ prod1 as sysdba”'target database密码：连接到目标数据库的<span class="italic">密码</span> ：PROD1（DBID = 39525561）</pre></div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-45C00A07-B22E-4199-BCCA-91D02FCABF8D__GUID-AC37F03B-9694-4441-A07C-DBFD69CE0C46">
                           <p class="titleinexample">示例4-5密码文件身份验证为SYSBACKUP  - 显式</p>
                           <p>在此示例中， <code class="codeph">sbu</code>用户在目标数据库中被授予<code class="codeph">SYSBACKUP</code>权限：</p><pre class="oac_no_warn" dir="ltr">％rman target'“sbu @ prod1 as sysbackup”'target database密码： <span class="italic">密码</span>连接到目标数据库：PROD1（DBID = 39525561）</pre></div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-45C00A07-B22E-4199-BCCA-91D02FCABF8D__GUID-30F46410-1428-470B-8E2D-F3311430D42F">
                           <p class="titleinexample">示例4-6密码文件身份验证为SYSDBA  - 隐式</p><pre class="oac_no_warn" dir="ltr">％rman target sbu @ prod1 target database密码：连接到目标数据库的<span class="italic">密码</span> ：PROD1（DBID = 39525561）</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div>
               </div><a id="BRADV564"></a><a id="BRADV666"></a><a id="BRADV667"></a><a id="BRADV668"></a><a id="BRADV669"></a><a id="BRADV89393"></a><div class="props_rev_3"><a id="GUID-E40A23BB-BE65-4665-B57D-F0D11FFDD305" name="GUID-E40A23BB-BE65-4665-B57D-F0D11FFDD305"></a><h4 id="BRADV-GUID-E40A23BB-BE65-4665-B57D-F0D11FFDD305" class="sect4"><span class="enumeration_section">4.2.3</span>从RMAN提示符进行数据库连接</h4>
                  <div>
                     <p>如果在操作系统命令行上启动没有连接字符串的RMAN，则必须在RMAN提示符下发出<code class="codeph">CONNECT TARGET</code>命令以连接到目标数据库。
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-E40A23BB-BE65-4665-B57D-F0D11FFDD305__GUID-6E4997EF-B511-4B95-A710-5AD4E28CA842">要从RMAN提示符建立数据库连接：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>在操作系统命令行上，启动RMAN客户端而不进行数据库连接。</span><div><pre class="oac_no_warn" dir="ltr">％rman RMAN&gt;</pre></div>
                        </li>
                        <li class="stepexpand"><span>在RMAN提示符下，输入一个或多个<span><code class="codeph">CONNECT</code></span>命令。</span></li>
                     </ol>
                     <div class="example" id="GUID-E40A23BB-BE65-4665-B57D-F0D11FFDD305__GUID-9A4A3808-0461-4DC2-B2D0-D6E15E2D7FB8">
                        <p class="titleinexample">示例4-7使用OS身份验证进行连接 - 隐式</p><pre class="oac_no_warn" dir="ltr">RMAN&gt;连接目标/</pre><p>由于未指定系统特权，因此假定为<span><code class="codeph">AS</code></span> <span><code class="codeph">SYSDBA</code></span> 。
                        </p>
                     </div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-E40A23BB-BE65-4665-B57D-F0D11FFDD305__GUID-897C3FAD-3098-41AC-98DF-2F460553C3FC">
                        <p class="titleinexample">示例4-8使用OS身份验证进行连接 - 显式</p><pre class="oac_no_warn" dir="ltr">RMAN&gt;连接目标“/ as sysdba”</pre><p>包含系统特权时，需要带括号的引号（单引号或双引号）。</p>
                     </div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-E40A23BB-BE65-4665-B57D-F0D11FFDD305__GUID-C868A577-6A88-42E3-A4E1-DEA3416EC1CC">
                        <p class="titleinexample">示例4-9连接密码文件验证</p><pre class="oac_no_warn" dir="ltr">RMAN&gt;连接目标“sbu @ prod AS SYSBACKUP”目标数据库密码：连接到目标数据库的密码：PROD（DBID = 39525561）</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-E40A23BB-BE65-4665-B57D-F0D11FFDD305__GUID-6BDE5844-E75F-465C-B068-3645DBAA2F40">
                        <p class="titleinexample">示例4-10连接到目标和恢复目录</p>
                        <p>在此示例中，目标连接使用操作系统身份验证，恢复目录数据库连接使用网络服务名称和密码文件身份验证。恢复目录所有者是用户<span><code class="codeph">rco</code></span> 。RMAN提示输入恢复目录用户的密码。
                        </p><pre class="oac_no_warn" dir="ltr">RMAN&gt;连接目标/ RMAN&gt;连接目录rco @ catdb恢复目录数据库密码：连接到恢复目录数据库的密码</pre></div>
                     <!-- class="example" -->
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-E40A23BB-BE65-4665-B57D-F0D11FFDD305__GUID-64D3E2BC-1157-4B18-A852-4F36D6C6C4EF">
                           <p class="notep1">也可以看看：</p>
                           <p><span class="italic"><span><a href="../rcmrf/CONNECT.html#RCMRF114" target="_blank">Oracle数据库备份和恢复参考</a></span></span>了解<span><code class="codeph">CONNECT</code></span>命令</p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="BRADV153"></a><a id="BRADV563"></a><a id="BRADV155"></a><a id="BRADV89392"></a><div class="props_rev_3"><a id="GUID-241D7D37-D905-4E52-99B6-3FD57AE1717B" name="GUID-241D7D37-D905-4E52-99B6-3FD57AE1717B"></a><h4 id="BRADV-GUID-241D7D37-D905-4E52-99B6-3FD57AE1717B" class="sect4"><span class="enumeration_section">4.2.4</span>从操作系统命令行进行RMAN数据库连接</h4>
                  <div>
                     <p>要从操作系统命令行连接到目标数据库，请输入<code class="codeph">rman</code>命令，然后输入连接信息。您可以在显示RMAN提示后开始执行命令。
                     </p>
                     <div class="section">
                        <p>使用<code class="codeph">CATALOG</code>关键字连接到恢复目录。您也可以在不指定<code class="codeph">NOCATALOG</code>或<code class="codeph">CATALOG</code>情况下启动RMAN。如果未在命令行上指定<code class="codeph">NOCATALOG</code> ，并且在RMAN启动后未指定<a href="../rcmrf/CONNECT.html#RCMRF114" target="_blank"><code class="codeph">CONNECT CATALOG</code></a> ，则在第一次运行需要使用RMAN存储库的命令时，RMAN默认为<code class="codeph">NOCATALOG</code>模式。
                        </p>
                        <div class="infoboxnote" id="GUID-241D7D37-D905-4E52-99B6-3FD57AE1717B__GUID-74F8AC49-CE11-4835-89D5-EB5B6B9692A8">
                           <p class="notep1">注意：</p>
                           <p>在<code class="codeph">NOCATALOG</code>模式下执行使用RMAN存储库的命令后，必须退出并重新启动RMAN才能连接到恢复目录。
                           </p>
                        </div>
                        <p>如果在操作系统命令行上连接到目标数据库，则可以在显示RMAN提示后开始执行命令。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-241D7D37-D905-4E52-99B6-3FD57AE1717B__CHDHAFFI">
                        <p class="titleinexample">示例4-11从系统提示符连接到目标数据库</p>
                        <p>此示例说明了与使用操作系统身份验证的目标数据库的连接。<code class="codeph">NOCATALOG</code>选项表示会话中未使用恢复目录。
                        </p><pre class="oac_no_warn" dir="ltr">％rman TARGET / NOCATALOG连接到目标数据库：PROD（DBID = 39525561）使用目标数据库控制文件而不是恢复目录RMAN&gt;</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-241D7D37-D905-4E52-99B6-3FD57AE1717B__CHDIGBFC">
                        <p class="titleinexample">示例4-12使用网络服务名称从系统提示符连接到目标数据库</p>
                        <p>此示例说明了与使用网络服务名称和密码文件身份验证的目标数据库的连接。RMAN提示输入密码。</p><pre class="oac_no_warn" dir="ltr">％rman TARGET sbu @ prod NOCATALOG目标数据库密码：连接到目标数据库的<span class="italic">密码</span> ：PROD（DBID = 39525561）RMAN&gt;</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-241D7D37-D905-4E52-99B6-3FD57AE1717B__BABJAFDA">
                        <p class="titleinexample">示例4-13从系统提示符连接到目标和恢复目录</p>
                        <p>此示例说明了对目标和恢复目录数据库使用Oracle Net身份验证的连接。在这两种情况下，RMAN都会提示输入密码。</p><pre class="oac_no_warn" dir="ltr">％rman TARGET sbu @ prod CATALOG rco @ catdb目标数据库密码：连接到目标数据库的<span class="italic">密码</span> ：PROD（DBID = 39525561）恢复目录数据库密码：连接到恢复目录数据库的<span class="italic">密码</span> RMAN&gt;</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="BRADV671"></a><div class="props_rev_3"><a id="GUID-B397ADD8-D9CF-4DDA-B6AC-8C5FF04447AD" name="GUID-B397ADD8-D9CF-4DDA-B6AC-8C5FF04447AD"></a><h4 id="BRADV-GUID-B397ADD8-D9CF-4DDA-B6AC-8C5FF04447AD" class="sect4"><span class="enumeration_section">4.2.5</span>与CDB建立RMAN连接</h4>
                  <div>
                     <p>您可以将RMAN客户端连接到多租户容器数据库（CDB）和可插拔数据库（PDB）。</p>
                     <p>本节包含以下主题：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="starting-interacting-with-rman-client.html#GUID-01DF892F-FED5-4ADE-9152-9C3CF0921DBA" title="您可以在整个CDB，仅root用户或一个或多个PDB上执行RMAN操作。">关于在CDB和PDB上执行操作</a></p>
                        </li>
                        <li>
                           <p><a href="starting-interacting-with-rman-client.html#GUID-7CB295E4-C934-4C87-A08E-7E502C8AD9AA" title="直接连接到可插拔数据库（PDB）时，某些限制适用：">连接到PDB时的限制</a></p>
                        </li>
                        <li>
                           <p><a href="starting-interacting-with-rman-client.html#GUID-43239E2D-0AFD-455D-89AB-87EDBC0E497D" title="有几种方法可以将目标连接到根目录。">作为目标连接到根</a></p>
                        </li>
                        <li>
                           <p><a href="starting-interacting-with-rman-client.html#GUID-E95C5C27-C036-4773-B77C-E4120526F422" title="您可以从RMAN提示符或操作系统命令行连接到PDB。">作为目标连接到PDB</a></p>
                        </li>
                     </ul>
                  </div><a id="BRADV672"></a><div class="props_rev_3"><a id="GUID-01DF892F-FED5-4ADE-9152-9C3CF0921DBA" name="GUID-01DF892F-FED5-4ADE-9152-9C3CF0921DBA"></a><h5 id="BRADV-GUID-01DF892F-FED5-4ADE-9152-9C3CF0921DBA" class="sect5"><span class="enumeration_section">4.2.5.1</span>关于在CDB和PDB上执行操作</h5>
                     <div>
                        <p>您可以在整个CDB，仅root用户或一个或多个PDB上执行RMAN操作。</p>
                        <p>根据以下规则与CDB建立RMAN连接：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>要在整个CDB上执行操作（例如，备份整个CDB），请将目标连接到根目录。</p>
                           </li>
                           <li>
                              <p>要仅对根执行操作（例如，备份根），请将目标连接到根目录。</p>
                           </li>
                           <li>
                              <p>要在单个PDB上执行操作，您可以将目标连接到根目录或直接连接到PDB。</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>如果连接到root，则必须在RMAN命令中使用<code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code>语法。例如，要备份PDB，请使用<code class="codeph">BACKUP</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code>命令。
                                    </p>
                                 </li>
                                 <li>
                                    <p>如果您直接连接到PDB，则可以使用连接到<a href="glossary.html#GUID-62A96A52-3B97-455A-A443-75B999DCAC94"><span class="xrefglossterm">非CDB</span></a>时使用的相同命令。例如，要备份PDB，可以使用<code class="codeph">BACKUP</code> <code class="codeph">DATABASE</code>命令。
                                    </p>
                                 </li>
                              </ul>
                           </li>
                           <li>
                              <p>要使用单个命令对两个或多个PDB执行操作，请将目标连接到根目录。</p>
                              <p>例如，要备份<code class="codeph">sales</code>和<code class="codeph">hr</code> PDB，请连接到root并提交以下命令：</p><pre class="oac_no_warn" dir="ltr">BACKUP PLUGGABLE DATABASE销售额，小时;</pre></li>
                        </ul>
                        <div class="infoboxnote" id="GUID-01DF892F-FED5-4ADE-9152-9C3CF0921DBA__GUID-E1777870-69B4-4B2B-AE2C-FA5A1FC95E35">
                           <p class="notep1">注意：</p>
                           <p>如果使用操作系统身份验证将目标连接到CDB，则会连接到根目录。</p>
                        </div>
                     </div>
                  </div><a id="BRADV673"></a><div class="props_rev_3"><a id="GUID-7CB295E4-C934-4C87-A08E-7E502C8AD9AA" name="GUID-7CB295E4-C934-4C87-A08E-7E502C8AD9AA"></a><h5 id="BRADV-GUID-7CB295E4-C934-4C87-A08E-7E502C8AD9AA" class="sect5"><span class="enumeration_section">4.2.5.2</span>连接到PDB时的限制</h5>
                     <div>
                        <p>直接连接到可插拔数据库（PDB）时，某些限制适用：</p>
                        <p>将目标直接连接到PDB时，以下操作不可用：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>备份存档日志</p>
                           </li>
                           <li>
                              <p>删除存档日志</p>
                           </li>
                           <li>
                              <p>删除存档的日志备份</p>
                           </li>
                           <li>
                              <p>还原存档日志（RMAN会在介质恢复期间根据需要还原存档日志。）</p>
                           </li>
                           <li>
                              <p>使用共享撤消模式时的时间点恢复（PITR）</p>
                           </li>
                           <li>
                              <p>使用共享撤消模式时的TSPITR</p>
                           </li>
                           <li>
                              <p>使用共享撤消模式时的表恢复</p>
                           </li>
                           <li>
                              <p>使用共享撤消模式时重复数据库</p>
                           </li>
                           <li>
                              <p>使用共享撤消模式时的闪回操作</p>
                           </li>
                           <li>
                              <p>运行Data Recovery Advisor</p>
                           </li>
                           <li>
                              <p>报告/删除已过时</p>
                           </li>
                           <li>
                              <p>注册数据库</p>
                           </li>
                           <li>
                              <p>导入目录</p>
                           </li>
                           <li>
                              <p>重置数据库</p>
                           </li>
                           <li>
                              <p>配置RMAN环境（使用<code class="codeph">CONFIGURE</code>命令）</p>
                           </li>
                        </ul>
                     </div>
                  </div><a id="BRADV675"></a><a id="BRADV676"></a><a id="BRADV677"></a><a id="BRADV674"></a><div class="props_rev_3"><a id="GUID-43239E2D-0AFD-455D-89AB-87EDBC0E497D" name="GUID-43239E2D-0AFD-455D-89AB-87EDBC0E497D"></a><h5 id="BRADV-GUID-43239E2D-0AFD-455D-89AB-87EDBC0E497D" class="sect5"><span class="enumeration_section">4.2.5.3</span>将目标连接到根目录</h5>
                     <div>
                        <p>有几种方法可以将目标连接到根目录。</p>
                        <div class="section">
                           <p>三种最常见的方式如下：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>作为普通用户在本地连接，如<a href="starting-interacting-with-rman-client.html#GUID-43239E2D-0AFD-455D-89AB-87EDBC0E497D__CEGDEDBA">例4-14</a>所示</p>
                              </li>
                              <li>
                                 <p>连接操作系统认证，如<a href="starting-interacting-with-rman-client.html#GUID-43239E2D-0AFD-455D-89AB-87EDBC0E497D__CEGEEBBD">例4-15</a>所示</p>
                              </li>
                              <li>
                                 <p>使用网络服务名称通过Oracle Net Services以普通用户身份连接，如<a href="starting-interacting-with-rman-client.html#GUID-43239E2D-0AFD-455D-89AB-87EDBC0E497D__CEGGHBDB">例4-16</a>所示</p>
                              </li>
                           </ul>
                           <p>在所有情况下，您必须以具有<code class="codeph">SYSDBA</code>或<code class="codeph">SYSBACKUP</code>权限的用户身份进行连接。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-43239E2D-0AFD-455D-89AB-87EDBC0E497D__CEGDEDBA">
                           <p class="titleinexample">示例4-14本地连接到根</p>
                           <p>此示例使用<code class="codeph">SYS</code>用户本地连接到根， <code class="codeph">SYS</code>用户是普通用户。使用<code class="codeph">SYSDBA</code>权限建立连接。
                           </p><pre class="oac_no_warn" dir="ltr">rman target sys target database密码：连接到目标数据库的<span class="italic">密码</span> ：CDB（DBID = 659628168）</pre></div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-43239E2D-0AFD-455D-89AB-87EDBC0E497D__CEGEEBBD">
                           <p class="titleinexample">示例4-15使用操作系统身份验证连接到根目录</p>
                           <p>此示例使用操作系统身份验证在本地连接到根。连接建立为具有<code class="codeph">SYSDBA</code>权限的<code class="codeph">SYS</code>用户。
                           </p><pre class="oac_no_warn" dir="ltr">rman目标/连接到目标数据库：CDB（DBID = 659628168）</pre></div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-43239E2D-0AFD-455D-89AB-87EDBC0E497D__CEGGHBDB">
                           <p class="titleinexample">示例4-16使用网络服务名称连接到根目录</p>
                           <p>此示例假定存在一个<code class="codeph">sales</code>网络服务名称，该名称解析为根目录的数据库服务，并且有一个名为<code class="codeph">c##bkuser</code>的公共用户具有<code class="codeph">SYSBACKUP</code>权限。
                           </p><pre class="oac_no_warn" dir="ltr">rman target c ## bkuser @ sales target database密码：连接到目标数据库的<span class="italic">密码</span> ：CDB（DBID = 659628168）</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="BRADV701"></a><a id="BRADV678"></a><div class="props_rev_3"><a id="GUID-E95C5C27-C036-4773-B77C-E4120526F422" name="GUID-E95C5C27-C036-4773-B77C-E4120526F422"></a><h5 id="BRADV-GUID-E95C5C27-C036-4773-B77C-E4120526F422" class="sect5"><span class="enumeration_section">4.2.5.4</span>作为目标连接到PDB</h5>
                     <div>
                        <p>您可以从RMAN提示符或操作系统命令行连接到PDB。</p>
                        <div class="p">
                           <p>要将目标连接到PDB，您必须：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>使用解析为该PDB的数据库服务的网络服务名称进行连接。</p>
                              </li>
                              <li>
                                 <p>使用<code class="codeph">SYSDBA</code>权限以<a href="glossary.html#GUID-43EA1A4C-E5EB-4926-99EC-1DDA0E74A07C"><span class="xrefglossterm">本地用户</span></a>或<a href="glossary.html#GUID-2B102186-15BD-443C-B375-8CB0D442CF5F"><span class="xrefglossterm">普通用户</span></a>身份进行连接。
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-E95C5C27-C036-4773-B77C-E4120526F422__CEGDIEHF">
                           <p class="titleinexample">示例4-17将目标连接到PDB</p>
                           <p>此示例说明了与PDB的连接。它假设如下</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>您希望在名为<code class="codeph">hrpdb</code>的PDB上执行RMAN操作。
                                 </p>
                              </li>
                              <li>
                                 <p>网络服务名称<code class="codeph">hrpdb</code>解析为<code class="codeph">hrpdb</code> PDB的数据库服务。</p>
                              </li>
                              <li>
                                 <p>本地用户<code class="codeph">hrbkup</code>是在<code class="codeph">hrpdb</code> PDB中创建的， <code class="codeph">hrpdb</code>授予<code class="codeph">SYSDBA</code>权限。
                                 </p>
                              </li>
                           </ul><pre class="oac_no_warn" dir="ltr">rman target hrbkup @hrpdb target database密码：连接到目标数据库的<span class="italic">密码</span> ：CDB（DBID = 659628168）</pre></div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-E95C5C27-C036-4773-B77C-E4120526F422__GUID-A1D3D7A6-ADEB-4CF8-B011-D106678EEA38">
                           <p class="titleinexample">示例4-18连接到PDB和恢复目录</p>
                           <p></p>
                           <p>此示例说明了与PDB和恢复目录的连接。它假设如下：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>您想要在名为<code class="codeph">salespdb</code>的PDB上执行操作。<code class="codeph">SYSBACKUP</code>用户用于连接PDB。</p>
                              </li>
                              <li>
                                 <p>网络服务名称<code class="codeph">salespdb</code>解析为<code class="codeph">salespdb</code> PDB的数据库服务。</p>
                              </li>
                              <li>
                                 <p>使用恢复目录所有者<code class="codeph">rco</code>创建与恢复目录的<code class="codeph">rco</code> 。恢复目录数据库的网络服务名称是<code class="codeph">catdb</code> 。
                                 </p>
                              </li>
                           </ul>
                           <p>出现提示时，输入<code class="codeph">sysbackup</code>和<code class="codeph">rco</code>用户的密码。
                           </p><pre class="pre codeblock"><code>RMAN&gt;连接目标“sys @ salespdb as sysdba”目标数据库密码：连接到目标数据库：DBMAIN：SALESPDB（DBID = 1661283172）RMAN&gt;连接目录rco @ catdb恢复目录数据库密码：连接到恢复目录数据库</code></pre></div>
                        <!-- class="example" -->
                     </div>
                  </div>
               </div><a id="BRADV129"></a><div class="props_rev_3"><a id="GUID-243F06D7-4CEC-4472-BA6B-79D8C9EEF07F" name="GUID-243F06D7-4CEC-4472-BA6B-79D8C9EEF07F"></a><h4 id="BRADV-GUID-243F06D7-4CEC-4472-BA6B-79D8C9EEF07F" class="sect4"><span class="enumeration_section">4.2.6</span>在命令文件中建立RMAN数据库连接</h4>
                  <div>
                     <p>您可以通过创建包含<code class="codeph">CONNECT</code>命令的RMAN命令文件来建立数据库连接。
                     </p>
                     <div class="section">
                        <p>如果创建使用带有数据库级凭据（用户名和密码）的<a href="../rcmrf/CONNECT.html#RCMRF114" target="_blank"><code class="codeph">CONNECT</code></a>命令的RMAN命令文件，则对此文件具有读访问权限的任何人都可以学习密码。没有安全的方法将<code class="codeph">CONNECT</code>字符串与密码合并到命令文件中。
                        </p>
                        <p>如果创建使用<code class="codeph">CONNECT</code>命令的RMAN命令文件，则在使用<a href="../rcmrf/at-sign.html#RCMRF100" target="_blank"><code class="codeph">@</code></a>命令运行命令文件时，RMAN不会回显连接字符串。此行为可防止连接字符串出现在包含RMAN输出的任何日志文件中。例如，假设您创建命令文件<code class="codeph">listbkup.rman</code> ，如下所示：</p><pre class="oac_no_warn" dir="ltr">cat&gt; listbkup.rman &lt;&lt; EOF CONNECT TARGET / LIST BACKUP; EOF</pre><p>您可以通过使用<code class="codeph">@</code>命令行选项运行RMAN来执行此脚本，如下所示：</p><pre class="oac_no_warn" dir="ltr">％rman @ listbkup.rman</pre><p>执行命令文件时，RMAN用星号替换连接字符串，如以下输出所示：</p><pre class="oac_no_warn" dir="ltr">RMAN&gt; CONNECT TARGET * 2&gt; LIST BACKUP; 3&gt;连接到目标数据库：RDBMS（DBID = 771530996）使用目标数据库控制文件而不是恢复目录备份集列表===================。 。 。</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="BRADV565"></a><a id="BRADV670"></a><a id="BRADV128"></a><div class="props_rev_3"><a id="GUID-067E6833-4A5B-46E4-89F0-D3C3B4FD1D75" name="GUID-067E6833-4A5B-46E4-89F0-D3C3B4FD1D75"></a><h4 id="BRADV-GUID-067E6833-4A5B-46E4-89F0-D3C3B4FD1D75" class="sect4"><span class="enumeration_section">4.2.7</span>将RMAN连接到辅助数据库</h4>
                  <div>
                     <p>要使用<code class="codeph">DUPLICATE</code>命令，必须连接到辅助实例。执行表空间时间点恢复（TSPITR）可能还需要连接到辅助实例。
                     </p>
                     <div class="section">
                        <p>辅助连接的形式与目标数据库连接相同，只是您使用<code class="codeph">AUXILIARY</code>关键字而不是<code class="codeph">TARGET</code>关键字。
                        </p>
                        <div class="infoboxnote" id="GUID-067E6833-4A5B-46E4-89F0-D3C3B4FD1D75__GUID-B547AB32-C47E-4F95-A2D2-52C0371A79FA">
                           <p class="notep1">注意：</p>
                           <p>当你使用<code class="codeph">DUPLICATE ...FROM ACTIVE DATABASE</code>命令，需要一个网络服务名称。有关详细信息，请参阅<span class="q">“ <span><a href="rman-duplicating-databases.html#GUID-57888C11-63C3-4A7A-8488-2E623033A359" title="有多种方法可用于创建启动辅助实例所需的初始化参数文件。">为辅助实例创建初始化参数文件</a></span> ”</span> 。
                           </p>
                        </div>
                        <div class="infoboxnotealso" id="GUID-067E6833-4A5B-46E4-89F0-D3C3B4FD1D75__GUID-3DFB19B7-3BD7-4AA5-B1B9-0953800D5575">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><span><a href="rman-duplicating-databases.html#GUID-F31F9FCE-B610-49EB-B9DB-44B9AA4E838F" title="本章介绍如何使用DUPLICATE命令创建独立运行的数据库副本。">复制数据库</a></span>以获取有关使用<span><a href="../rcmrf/DUPLICATE.html#RCMRF126" target="_blank"><code class="codeph">DUPLICATE</code></a></span>命令的更多详细信息</p>
                              </li>
                              <li>
                                 <p><span><a href="performing-rman-tspitr.html#GUID-CAACDB53-7C3A-45B4-8249-C5D855D47571" title="要有效地使用RMAN表空间时间点恢复（TSPITR），了解它可以解决的问题类型，组件，RMAN在TSPITR期间所执行的操作以及对何时以及如何进行的各种限制和限制很有帮助。跑。本节介绍运行RMAN的基本概念，准备任务和运行模式TSPITR。恢复管理器（RMAN）TSPITR可以将数据库中的一个或多个表空间快速恢复到较早的时间，而不会影响数据库中的其余表空间和对象。了解RMAN TSPITR的概念，例如使用的术语和模式。本节定义了RMAN TSPITR使用的一些常见实体。有几种运行RMAN TSPITR的模式。各种操作模式之间的差异对应于您的环境中需要多少自动化与自定义。在执行完全自动化的RMAN TSPITR（默认）之前，从恢复集，辅助目标和目标时间中选择表空间。由于某些限制和限制，TSPITR无法解决某些数据库问题。在执行TSPITR时需要考虑一些限制。在TSPITR期间不使用恢复目录时要注意某些预防措施。准备执行TSPITR时必须完成某些步骤。为您选择正确的目标时间或SCN非常重要。 TSPITR。请注意，在TSPITR之后将表空间联机后，您不能在使表空间联机的时间之前使用任何备份。最初，恢复集包括要恢复的表空间的数据文件。但是，如果表空间中的对象需要与其他表空间中的对象建立关系（例如约束），则必须先考虑这些关系才能执行TSPITRRMAN TSPITR要求正在恢复的表空间是自包含的，并且没有SYS拥有的对象驻留在表空间中。在表空间上执行RMAN TSPITR时，在目标恢复时间之后创建的对象将丢失。您可以通过在TSPITR之前使用数据泵导出实用程序导出这些对象并在之后使用数据泵导入重新导入这些对象来保留这些对象。在默认模式下，RMAN在目标数据库上尽可能多地使用TSPITR的配置。您可以自定义RMAN TSPITR的某些方面，同时仍然主要执行完全自动化的RMAN TSPITR的过程。您可能不希望恢复集数据文件在其原始位置恢复和恢复。SET NEWNAME命令可用于指定新目标。为恢复集指定新目标时，RMAN不会删除表空间的原始数据文件。与通常存储在其原始位置的恢复集数据文件不同，辅助集数据文件不得覆盖目标数据库中的相应原始文件。如果未指定与其原始位置不同的辅助集文件位置，则TSPITR将失败。当RMAN尝试覆盖原始数据库中的相应文件并发现正在使用的文件时，会发生故障。辅助集数据文件可以在目标中具有Oracle管理文件（OMF），并且可以使用自动存储管理（ASM）或非ASM存储。当设置了DB_FILE_NAME_CONVERT初始化参数且OMF文件位于ASM或非ASM存储中时，TSPITR以不同方式执行名称转换。您可以使用辅助数据库的DB_FILE_NAME_CONVERT和LOG_FILE_NAME_CONVERT初始化参数来指定磁盘组的转换。RMAN使用该模式转换ASM磁盘组名称，并在转换后的磁盘组中生成有效的OMF文件名。有多种方法可用于重命名辅助数据库的OMF（非ASM）文件名。要为辅助集数据文件指定新名称，可以将RECOVER TABLESPACE包含在RUN命令中，并使用RUN块中的SET NEWNAME命令重命名该文件。如果您不想为所有辅助集数据文件使用辅助目标，但又不想单独命名每个文件，则可以在辅助数据库使用的初始化参数文件中包含DB_FILE_NAME_CONVERT初始化参数。临时文件被视为数据库辅助集的一部分。在实例化辅助数据库时，RMAN将重新创建目标数据库的临时表空间，并使用辅助数据文件名的常规规则生成其名称。通过重定向RMAN以使用恢复集和辅助集数据文件的现有映像副本，可以增强TSPITR性能。在这种情况下，RMAN不需要从备份还原数据文件。使用SET NEWNAME命令可以在使用映像副本执行TSPITR时指定映像副本的位置。CONFIGURE AUXNAME命令为辅助集数据文件映像副本设置持久备用位置，而SET NEWNAME命令为RUN命令的持续时间设置备用位置。使用映像副本执行TSPITR时，此过程使用CONFIGURE AUXNAME。自动辅助数据库使用一组默认初始化参数。如果需要，您可以添加其他参数。如果使用初始化参数文件，则可以使用CONTROL_FILES初始化参数为辅助数据库的控制文件指定自己的位置要在辅助数据库上恢复它们后对辅助和恢复集执行恢复，RMAN可能需要还原存档日志。使用辅助目标时，存档日志将还原到该位置。如果在辅助数据库参数文件中指定LOG_FILE_NAME_CONVERT初始化参数，并且参数成功转换目标的联机重做日志的名称，则此参数将确定联机重做日志位置。虽然Oracle建议您让RMAN管理辅助数据库的所有方面，但有时您可能必须创建和管理自己的辅助数据库。如果选择此模式，则负责设置，启动，停止和清理TSPITR中使用的辅助数据库。创建适合用作辅助数据库的Oracle实例需要执行一组步骤。有多种方法可以为辅助数据库创建密码文件。使用文本编辑器为目标数据库主机上的辅助数据库创建初始化参数文件。辅助数据库必须具有有效的网络服务名称。在继续之前，请使用SQL * Plus确保您可以与辅助数据库建立SYSBACKUP或SYSDBA连接。使用您自己的辅助实例执行TSPITR时，请记住某些准则。可以覆盖使用自己的辅助数据库进行TSPITR时通道的默认行为。您可能希望使用SET NEWNAME命令来引用辅助集文件的现有映像副本以提高TSPITR性能，或者为TSPITR之后的恢复集文件分配新名称。如有必要，请计划这些命令，并将它们添加到为TSPITR运行的命令序列中。完成先决条件，然后按照本节中的步骤使用您自己的辅助数据库执行TSPITR。在开始RMAN TSPITR之前，必须启动辅助数据库。由于辅助数据库还没有控制文件，因此只能以NOMOUNT模式启动实例。启动RMAN并连接到目标数据库和手动创建的辅助数据库。使用RECOVER TABLESPACE命令使用您自己的辅助实例执行TSPITR。此过程使用RECOVER TABLESPACE ...UNTIL命令执行TSPITR。各种问题都可能导致RMAN TSPITR失败。必须确定并修复问题。目标数据库中的文件，SET NEWNAME或CONFIGURE AUXNAME命令分配的文件名以及DB_FILE_NAME_CONVERT参数的效果生成的文件名之间可能会发生名称冲突。在TSPITR期间，RMAN需要有关哪些表空间在TSPITR目标时间具有还原段的信息。如果使用此信息，通常可在恢复目录中使用此信息。如果您正在管理自己的辅助数据库并且TSPITR失败，请不要尝试在不解决错误的情况下重新运行TSPITR。">执行RMAN表空间时间点恢复（TSPITR）</a></span>以获取有关执行TSPITR的更多详细信息</p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-067E6833-4A5B-46E4-89F0-D3C3B4FD1D75__BABIABJA">
                        <p class="titleinexample">示例4-19从RMAN提示符连接到目标和辅助数据库</p>
                        <p>此示例说明使用操作系统身份验证连接到目标数据库，辅助数据库连接使用网络服务名称和密码文件身份验证。</p><pre class="oac_no_warn" dir="ltr">％rman RMAN&gt; CONNECT TARGET / RMAN&gt; CONNECT AUXILIARY sbu @ aux辅助数据库密码：连接到辅助数据库的<span class="italic">密码</span> ：AUX（DBID = 30472568）</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-067E6833-4A5B-46E4-89F0-D3C3B4FD1D75__CEGHDGEE">
                        <p class="titleinexample">示例4-20从系统提示符连接到目标和辅助数据库</p>
                        <p>此示例说明了从系统提示符到目标数据库和辅助数据库的连接。目标连接使用操作系统身份验证，辅助连接使用网络服务名称和密码文件身份验证。</p><pre class="oac_no_warn" dir="ltr">％rman目标/辅助sbu @ aux辅助数据库密码：连接到辅助数据库的<span class="italic">密码</span> ：AUX（DBID = 30472568）</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="BRADV89394"></a><div class="props_rev_3"><a id="GUID-B7F7CDF4-3F34-4D20-AD36-10E2067DD7C6" name="GUID-B7F7CDF4-3F34-4D20-AD36-10E2067DD7C6"></a><h4 id="BRADV-GUID-B7F7CDF4-3F34-4D20-AD36-10E2067DD7C6" class="sect4"><span class="enumeration_section">4.2.8</span>诊断RMAN连接问题</h4>
                  <div>
                     <p>在诊断RMAN在连接目标，目录和辅助数据库时遇到的错误时，请考虑使用SQL * Plus直接连接到数据库。此操作可以揭示连接信息或数据库的潜在问题。</p>
                     <p>本节包含以下主题：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="starting-interacting-with-rman-client.html#GUID-E7230A40-996A-4D20-86E8-C636F85DA98E" title="RMAN使用SYSDBA或SYSBACKUP权限连接到目标数据库和辅助数据库。因此，当您使用SQL * Plus诊断目标或辅助数据库的连接问题时，请求SYSDBA或SYSBACKUP连接以重现RMAN行为。">诊断目标和辅助数据库连接问题</a></p>
                        </li>
                        <li>
                           <p><a href="starting-interacting-with-rman-client.html#GUID-88350C4F-36B9-4B8C-8F53-6320A6E7036B" title="使用SQL * Plus诊断恢复目录连接问题。">诊断恢复目录连接问题</a></p>
                        </li>
                     </ul>
                  </div><a id="BRADV89395"></a><div class="props_rev_3"><a id="GUID-E7230A40-996A-4D20-86E8-C636F85DA98E" name="GUID-E7230A40-996A-4D20-86E8-C636F85DA98E"></a><h5 id="BRADV-GUID-E7230A40-996A-4D20-86E8-C636F85DA98E" class="sect5"><span class="enumeration_section">4.2.8.1</span>诊断目标和辅助数据库连接问题</h5>
                     <div>
                        <p>RMAN使用<code class="codeph">SYSDBA</code>或<code class="codeph">SYSBACKUP</code>权限连接到目标数据库和辅助数据库。因此，当您使用SQL * Plus诊断目标或辅助数据库的连接问题时，请求<code class="codeph">SYSDBA</code>或<code class="codeph">SYSBACKUP</code>连接以重现RMAN行为。
                        </p>
                        <div class="section">
                           <p>例如，假设以下RMAN命令遇到连接错误：</p><pre class="oac_no_warn" dir="ltr">RMAN&gt; CONNECT TARGET /</pre><p>您使用SQL * Plus命令重现前面的连接尝试，如下所示：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; CONNECT / AS SYSBACKUP</pre></div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="BRADV89396"></a><div class="props_rev_3"><a id="GUID-88350C4F-36B9-4B8C-8F53-6320A6E7036B" name="GUID-88350C4F-36B9-4B8C-8F53-6320A6E7036B"></a><h5 id="BRADV-GUID-88350C4F-36B9-4B8C-8F53-6320A6E7036B" class="sect5"><span class="enumeration_section">4.2.8.2</span>诊断恢复目录连接问题</h5>
                     <div>
                        <p>使用SQL * Plus诊断恢复目录连接问题。</p>
                        <div class="section">
                           <p>当RMAN连接到恢复目录数据库时，它不使用<code class="codeph">SYSDBA</code>或<code class="codeph">SYSBACKUP</code>权限。使用SQL * Plus诊断恢复目录数据库的连接问题时，必须输入与在RMAN中输入完全相同的数据库连接字符串。不要指定<code class="codeph">AS SYSBACKUP</code>或<code class="codeph">AS SYSDBA</code> 。</p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div>
            </div><a id="BRADV89382"></a><div class="props_rev_3"><a id="GUID-507D61EC-3D28-4C67-8013-BE724AD89FFD" name="GUID-507D61EC-3D28-4C67-8013-BE724AD89FFD"></a><h3 id="BRADV-GUID-507D61EC-3D28-4C67-8013-BE724AD89FFD" class="sect3"><span class="enumeration_section">4.3</span>指定RMAN输出的位置</h3>
               <div>
                  <p>默认情况下，RMAN将命令输出写入标准输出。要将输出重定向到日志文件，请在启动RMAN时在命令行上输入<code class="codeph">LOG</code>参数。</p>
                  <div class="section">
                     <p>以下示例将RMAN命令输出写入文件<code class="codeph">rman.log:</code></p><pre class="oac_no_warn" dir="ltr">％rman LOG /tmp/rman.log</pre><p>在这种情况下，RMAN显示命令输入但不显示RMAN输出。将RMAN输出发送到日志文件和标准输出的最简单方法是使用Linux <code class="codeph">tee</code>命令或其等效命令。例如，以下技术使输入和输出在RMAN命令行界面中可见：</p><pre class="oac_no_warn" dir="ltr">％rman | tee rman.log RMAN&gt;</pre><div class="infoboxnotealso" id="GUID-507D61EC-3D28-4C67-8013-BE724AD89FFD__GUID-06B4D6E7-E0B0-4B1F-803E-D8E42DFEA7B3">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="../rcmrf/RMAN.html#RCMRF111" target="_blank"><span class="italic">Oracle数据库备份和恢复参考</span></a>了解RMAN命令行选项</p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="BRADV8122"></a><div class="props_rev_3"><a id="GUID-F600535A-D46A-4BB1-88FD-266396ECE795" name="GUID-F600535A-D46A-4BB1-88FD-266396ECE795"></a><h3 id="BRADV-GUID-F600535A-D46A-4BB1-88FD-266396ECE795" class="sect3"><span class="enumeration_section">4.4</span>为RMAN设置全球化支持环境变量</h3>
               <div>
                  <p>在调用RMAN之前，设置<code class="codeph">NLS_DATE_FORMAT</code>和<code class="codeph">NLS_LANG</code>环境变量可能很有用。这些变量确定RMAN命令（如<code class="codeph">RESTORE</code> ， <code class="codeph">RECOVER</code>和<code class="codeph">REPORT</code>时间参数的格式。</p>
                  <div class="section">
                     <p>以下示例显示了典型的语言和日期格式设置：</p><pre class="oac_no_warn" dir="ltr">NLS_LANG =美国NLS_DATE_FORMAT ='Mon DD YYYY HH24：MI：SS'</pre><p>如果要使用RMAN连接到已卸载的数据库并在RMAN仍处于连接状态时安装数据库，则设置<code class="codeph">NLS_LANG</code>环境变量，以便它还指定数据库使用的字符集。
                     </p>
                     <p>未安装的数据库采用默认字符集，即<code class="codeph">US7ASCII</code> 。如果您的字符集与默认字符集不同，则RMAN会在装入数据库后返回错误。例如，如果字符集是<code class="codeph">WE8DEC</code> ，那么为了避免错误，您可以按如下方式设置<code class="codeph">NLS_LANG</code>变量：</p><pre class="oac_no_warn" dir="ltr">NLS_LANG = american_america.we8dec</pre><p>对于要应用的环境变量<a href="../refrn/NLS_DATE_FORMAT.html#REFRN10119" target="_blank"><code class="codeph">NLS_DATE_FORMAT</code></a>并覆盖服务器初始化文件中为服务器设置的缺省值，还必须设置环境变量<code class="codeph">NLS_LANG</code> 。
                     </p>
                     <div class="infoboxnotealso" id="GUID-F600535A-D46A-4BB1-88FD-266396ECE795__GUID-DBEF3432-12AB-4B27-93DF-BE054C10D710">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>有关<code class="codeph">NLS_LANG</code>和<code class="codeph">NLS_DATE_FORMAT</code>参数的详细信息，请<a href="../refrn/index.html" target="_blank"><span class="italic">参见Oracle数据库参考</span></a></p>
                           </li>
                           <li>
                              <p><a href="../nlspg/setting-up-globalization-support-environment.html#NLSPG003" target="_blank"><span class="italic">Oracle数据库全球化支持指南</span></a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="BRADV89383"></a><div class="props_rev_3"><a id="GUID-D7BEDDA1-26CF-47E0-B55F-85E3CA238ECA" name="GUID-D7BEDDA1-26CF-47E0-B55F-85E3CA238ECA"></a><h3 id="BRADV-GUID-D7BEDDA1-26CF-47E0-B55F-85E3CA238ECA" class="sect3"><span class="enumeration_section">4.5</span>输入RMAN命令</h3>
               <div>
                  <p>您可以直接从RMAN提示输入RMAN命令，也可以从文本文件中读取它们。</p>
                  <p>本节包含以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="starting-interacting-with-rman-client.html#GUID-924C370B-C300-4FCF-A164-45EF1AAC4AE4" title="当RMAN客户端准备好您的命令时，它会显示命令提示符">在RMAN提示符下输入RMAN命令</a></p>
                     </li>
                     <li>
                        <p><a href="starting-interacting-with-rman-client.html#GUID-5FF51A4E-BC27-41A9-AA83-FF6E761C2535" title="对于重复性任务，您可以创建包含RMAN命令的文本文件，并使用@参数启动RMAN客户端，然后使用文件名。">将命令文件与RMAN一起使用</a></p>
                     </li>
                     <li>
                        <p><a href="starting-interacting-with-rman-client.html#GUID-95DBA7A2-8D4F-428D-8ABC-A104FC064ABC" title="RMAN中的注释字符是井号（＃）。从井号到行尾的所有文本都将被忽略。">在RMAN命令文件中输入注释</a></p>
                     </li>
                     <li>
                        <p><a href="starting-interacting-with-rman-client.html#GUID-A9321B2D-6CFF-4616-B629-67960A8F87DD" title="运行命令文件时，可以在USING子句中指定一个或多个值，以便在命令文件中的替换变量中使用。通过这种方式，您可以使命令文件动态化。">在命令文件中使用替换变量</a></p>
                     </li>
                     <li>
                        <p><a href="starting-interacting-with-rman-client.html#GUID-86BB8661-9779-4057-93A5-1ADC09C896CE" title="您可以在不执行它们的情况下测试RMAN命令的语法正确性。使用命令行参数CHECKSYNTAX以一种模式启动RMAN客户端，在该模式下，它仅解析您输入的命令，并为不合法的RMAN语法的命令返回RMAN-00558错误。">检查RMAN语法</a></p>
                     </li>
                  </ul>
               </div><a id="BRADV89384"></a><div class="props_rev_3"><a id="GUID-924C370B-C300-4FCF-A164-45EF1AAC4AE4" name="GUID-924C370B-C300-4FCF-A164-45EF1AAC4AE4"></a><h4 id="BRADV-GUID-924C370B-C300-4FCF-A164-45EF1AAC4AE4" class="sect4"><span class="enumeration_section">4.5.1</span>在RMAN提示符下输入RMAN命令</h4>
                  <div>
                     <p>当RMAN客户端准备好您的命令时，它会显示命令提示符</p>
                     <div class="section">
                        <p>以下是RMAN命令提示符的示例：</p><pre class="oac_no_warn" dir="ltr">RMAN&gt;</pre><p>输入要执行的RMAN命令。例如：</p><pre class="oac_no_warn" dir="ltr">RMAN&gt; CONNECT TARGET RMAN&gt; BACKUP DATABASE;</pre><p>大多数RMAN命令都有几个参数，必须以分号结尾。某些命令（如<a href="../rcmrf/STARTUP.html#RCMRF158" target="_blank"><code class="codeph">STARTUP</code></a> ， <a href="../rcmrf/SHUTDOWN.html#RCMRF155" target="_blank"><code class="codeph">SHUTDOWN</code></a>和<a href="../rcmrf/CONNECT.html#RCMRF114" target="_blank"><code class="codeph">CONNECT</code></a> ）可以使用或不使用分号。
                        </p>
                        <p>当您输入不是完整命令的文本行时，RMAN会提示输入带有行号的继续输入。例如：</p><pre class="oac_no_warn" dir="ltr">RMAN&gt; BACKUP DATABASE 2&gt; INCLUDE CURRENT 3&gt; CONTROLFILE 4&gt;;</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="BRADV89385"></a><div class="props_rev_3"><a id="GUID-5FF51A4E-BC27-41A9-AA83-FF6E761C2535" name="GUID-5FF51A4E-BC27-41A9-AA83-FF6E761C2535"></a><h4 id="BRADV-GUID-5FF51A4E-BC27-41A9-AA83-FF6E761C2535" class="sect4"><span class="enumeration_section">4.5.2</span>在RMAN中使用命令文件</h4>
                  <div>
                     <p>对于重复性任务，您可以创建包含RMAN命令的文本文件，并使用<code class="codeph">@</code>参数启动RMAN客户端，然后使用文件名。
                     </p>
                     <div class="section">
                        <p>例如，在当前目录中创建一个包含一行文本的文本文件<code class="codeph">cmdfile1</code> ，如下所示：</p><pre class="oac_no_warn" dir="ltr">BACKUP DATABASE PLUS ARCHIVELOG;</pre><p>您可以从命令行运行此命令文件，如此示例所示，并执行其中包含的命令：</p><pre class="oac_no_warn" dir="ltr">％rman TARGET / @ cmdfile1</pre><p>命令完成后，RMAN退出。</p>
                        <p>您还可以在RMAN命令提示符下使用<a href="../rcmrf/at-sign.html#RCMRF100" target="_blank"><code class="codeph">@</code></a>命令在<a href="glossary.html#GUID-01D29658-41E1-4D45-9C7F-A761D56885B9"><span class="xrefglossterm">RMAN会话</span></a>期间执行命令文件的内容。RMAN读取文件并执行其中的命令。例如：</p><pre class="oac_no_warn" dir="ltr">RMAN&gt; @ cmdfile1</pre><p>执行命令文件内容后，RMAN显示以下消息：</p><pre class="oac_no_warn" dir="ltr">RMAN&gt; **文件结束**</pre><p>与从操作系统命令行执行命令文件的情况不同，RMAN不会退出。</p>
                        <div class="infoboxnotealso" id="GUID-5FF51A4E-BC27-41A9-AA83-FF6E761C2535__GUID-0EC863A4-0B8F-4A64-BE86-31E7B9FDFE78">
                           <p class="notep1">也可以看看：</p>
                           <p>适用于RMAN命令行语法的<a href="../rcmrf/RMAN.html#RCMRF111" target="_blank"><span class="italic">Oracle数据库备份和恢复参考</span></a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="BRADV99960"></a><div class="props_rev_3"><a id="GUID-95DBA7A2-8D4F-428D-8ABC-A104FC064ABC" name="GUID-95DBA7A2-8D4F-428D-8ABC-A104FC064ABC"></a><h4 id="BRADV-GUID-95DBA7A2-8D4F-428D-8ABC-A104FC064ABC" class="sect4"><span class="enumeration_section">4.5.3</span>在RMAN命令文件中输入注释</h4>
                  <div>
                     <p>RMAN中的注释字符是井号（ <code class="codeph">#</code> ）。从井号到行尾的所有文本都将被忽略。
                     </p>
                     <div class="section">
                        <p>例如，以下命令文件的内容备份数据库和归档重做日志文件并包含注释：</p><pre class="oac_no_warn" dir="ltr">＃命令文件名：mybackup.rman＃以下命令备份数据库BACKUP DATABASE; ＃以下命令备份存档的重做日志BACKUP ARCHIVELOG ALL;</pre><p>以下示例显示如何跨多行中断单个RMAN命令：</p><pre class="oac_no_warn" dir="ltr">RMAN&gt; BACKUP＃这是评论2&gt; SPFILE;</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="BRADV561"></a><a id="BRADV89386"></a><div class="props_rev_3"><a id="GUID-A9321B2D-6CFF-4616-B629-67960A8F87DD" name="GUID-A9321B2D-6CFF-4616-B629-67960A8F87DD"></a><h4 id="BRADV-GUID-A9321B2D-6CFF-4616-B629-67960A8F87DD" class="sect4"><span class="enumeration_section">4.5.4</span>在命令文件中使用替换变量</h4>
                  <div>
                     <p>运行命令文件时，可以在<code class="codeph">USING</code>子句中指定一个或多个值，以便在命令文件中的替换变量中使用。通过这种方式，您可以使命令文件动态化。
                     </p>
                     <div class="section">
                        <p>与SQL * Plus一样， <code class="codeph">&amp;1</code>表示放置第一个值的位置， <code class="codeph">&amp;2</code>表示放置第二个值的位置，依此类推。替换变量语法是<code class="codeph">&amp;</code> <span class="italic"><code class="codeph">integer</code></span>后跟可选的句点，例如<code class="codeph">&amp;1.3</code> 。可选句点是变量的一部分，并替换为值，从而使替换文本后面紧跟另一个整数。例如，如果将值<code class="codeph">mybackup</code>传递给包含变量<code class="codeph">&amp;1.3</code>的命令文件，则替换的结果为<code class="codeph">mybackup3</code> 。
                        </p>
                        <p>以下过程说明如何创建和使用调用包含替换变量的命令文件的动态shell脚本。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-A9321B2D-6CFF-4616-B629-67960A8F87DD__GUID-4C8CDAD8-CFE9-47BE-A6DB-2347B4F9B16E">要创建和使用动态shell脚本：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>创建使用替换变量的RMAN命令文件。</span><div>
                              <p>以下示例显示了名为<code class="codeph">quarterly_backup.cmd</code>的命令文件的内容，该文件每季度运行一次。该脚本使用替换变量作为磁带集的名称， <code class="codeph">FORMAT</code>规范中的字符串以及要创建的还原点的名称。
                              </p><pre class="oac_no_warn" dir="ltr">#quartly_backup.cmd CONNECT TARGET / RUN {ALLOCATE CHANNEL c1 DEVICE TYPE sbt PARMS'ENV =（OB_MEDIA_FAMILY =＆1）'; BACKUP DATABASE TAG＆2 FORMAT'/disk2/bck/&amp;1%U.bck'KEEP FOREVER RESTORE POINT＆3; } 出口;</pre></div>
                        </li>
                        <li class="stepexpand"><span>创建可用于运行上一步中创建的RMAN命令文件的shell脚本。</span><div>
                              <p>以下示例创建名为<code class="codeph">runbackup.sh</code>的shell脚本。该示例为格式和还原点名称创建shell变量，并接受这些变量的值作为脚本的命令行参数。
                              </p><pre class="oac_no_warn" dir="ltr">＃！/ bin / tcsh #name：runbackup.sh＃usage：使用标签名称和副本数量作为参数设置media_family = $ argv [1] set format = $ argv [2] set restore_point = $ argv [3] rman @' /disk1/scripts/quarterly_backup.cmd'使用$ media_family $ format $ restore_point</pre></div>
                        </li>
                        <li class="stepexpand"><span>执行上一步中创建的shell脚本，在命令行上指定所需的参数。</span><div>
                              <p>以下示例运行<code class="codeph">runbackup.sh</code> shell脚本，并将<code class="codeph">archival_backup</code>作为媒体系列名称传递， <code class="codeph">bck0906</code>作为格式字符串，将<code class="codeph">FY06Q3</code>作为还原点名称<code class="codeph">FY06Q3</code> 。
                              </p><pre class="oac_no_warn" dir="ltr">％runbackup.sh archival_backup bck0906 FY06Q3</pre></div>
                        </li>
                     </ol>
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-A9321B2D-6CFF-4616-B629-67960A8F87DD__GUID-AD3A08A6-E27C-4CF1-B619-696C0121BD52">
                           <p class="notep1">也可以看看：</p>
                           <p><code class="codeph">@</code>语法的<a href="../rcmrf/at-sign.html#RCMRF100" target="_blank"><span class="italic">Oracle数据库备份和恢复参考</span></a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="BRADV89387"></a><div class="props_rev_3"><a id="GUID-86BB8661-9779-4057-93A5-1ADC09C896CE" name="GUID-86BB8661-9779-4057-93A5-1ADC09C896CE"></a><h4 id="BRADV-GUID-86BB8661-9779-4057-93A5-1ADC09C896CE" class="sect4"><span class="enumeration_section">4.5.5</span>检查RMAN语法</h4>
                  <div>
                     <p>您可以在不执行它们的情况下测试RMAN命令的语法正确性。使用命令行参数<span><code class="codeph">CHECKSYNTAX</code></span>以一种模式启动RMAN客户端，在该模式下，它仅解析您输入的命令，并为不合法的RMAN语法的命令返回<span><code class="codeph">RMAN-00558</code></span>错误。
                     </p>
                     <p>您可以在命令行或命令文件中检查RMAN命令的语法。</p>
                     <div class="infoboxnotealso" id="GUID-86BB8661-9779-4057-93A5-1ADC09C896CE__GUID-9D5C4FCA-AFD7-4C80-873A-B4150D62D25D">
                        <p class="notep1">也可以看看：</p>
                        <p><span><a href="../rcmrf/RMAN.html#RCMRF111" target="_blank">Oracle数据库备份和恢复参考，</a></span>以了解<span><code class="codeph">CHECKSYNTAX</code></span>命令行选项</p>
                     </div>
                  </div><a id="BRADV562"></a><a id="BRADV89388"></a><div class="props_rev_3"><a id="GUID-E7549936-0286-46EC-A6B2-EAC3B538AE19" name="GUID-E7549936-0286-46EC-A6B2-EAC3B538AE19"></a><h5 id="BRADV-GUID-E7549936-0286-46EC-A6B2-EAC3B538AE19" class="sect5"><span class="enumeration_section">4.5.5.1</span>在命令行中检查RMAN语法</h5>
                     <div>
                        <p>您可以交互式检查RMAN命令的语法，而无需实际执行命令。</p>
                        <div class="section">
                           <p class="subhead3" id="GUID-E7549936-0286-46EC-A6B2-EAC3B538AE19__GUID-C9332211-5DA6-4B83-8035-3A0707A2A756">要在命令行中检查RMAN语法：</p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>使用<code class="codeph">CHECKSYNTAX</code>参数启动RMAN：</span><div><pre class="oac_no_warn" dir="ltr">％rman CHECKSYNTAX</pre></div>
                           </li>
                           <li class="stepexpand"><span>输入要测试的RMAN命令。</span></li>
                        </ol>
                        <div class="section">
                           <p>以下示例显示了一个示例交互式会话，用户输入的文本以粗体显示。</p><pre class="oac_no_warn" dir="ltr">RMAN&gt; <span class="bold">运行[备份数据库; ]</span> RMAN-00571：============================================= ============== RMAN-00569：===============错误信息堆栈跟踪============= == RMAN-00571：============================================ =============== RMAN-00558：解析输入命令时遇到错误RMAN-01006：在解析RMAN-02001期间发出错误信号：无法识别的标点符号“[”RMAN&gt; <span class="bold">运行{备份数据库; }</span>该命令没有语法错误RMAN&gt;</pre></div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="BRADV149"></a><a id="BRADV150"></a><a id="BRADV89389"></a><div class="props_rev_3"><a id="GUID-F8ADDD5A-CAB0-4128-8DDD-9B8FD524362E" name="GUID-F8ADDD5A-CAB0-4128-8DDD-9B8FD524362E"></a><h5 id="BRADV-GUID-F8ADDD5A-CAB0-4128-8DDD-9B8FD524362E" class="sect5"><span class="enumeration_section">4.5.5.2</span>检查命令文件中的RMAN语法</h5>
                     <div>
                        <p>要在命令文件中测试命令，请使用<code class="codeph">CHECKSYNTAX</code>参数启动RMAN，并使用<code class="codeph">@</code>命令命名要传递的命令文件。
                        </p>
                        <div class="section">
                           <p class="subhead3" id="GUID-F8ADDD5A-CAB0-4128-8DDD-9B8FD524362E__GUID-DE8A51DC-7837-4366-B992-AC0E1EA25339">要在命令文件中测试命令：</p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>使用文本编辑器创建命令文件。</span><div>
                                 <p>假设您使用以下内容创建<code class="codeph">/tmp/goodcmdfile</code> ：</p><pre class="oac_no_warn" dir="ltr">＃命令文件，包含合法语法RESTORE DATABASE;恢复数据库;</pre><p>假设您使用以下内容创建另一个命令文件<code class="codeph">/tmp/badcmdfile</code> ：</p><pre class="oac_no_warn" dir="ltr">＃命令文件包含错误的语法命令RESTORE DATABASE RECOVER DATABASE</pre></div>
                           </li>
                           <li class="stepexpand"><span>以下列格式从RMAN提示符运行命令文件，其中<span class="italic"><code class="codeph">filename</code></span>是命令文件的名称：</span><div><pre class="oac_no_warn" dir="ltr">％rman CHECKSYNTAX @ <span class="italic">filename</span>
</pre></div>
                           </li>
                        </ol>
                        <div class="example" id="GUID-F8ADDD5A-CAB0-4128-8DDD-9B8FD524362E__BABCBGJD">
                           <p class="titleinexample">示例4-21使用正确的语法检查命令文件的语法</p>
                           <p>此示例显示使用<code class="codeph">CHECKSYNTAX</code>运行<code class="codeph">/tmp/goodcmdfile</code>时的<code class="codeph">CHECKSYNTAX</code> ：</p><pre class="oac_no_warn" dir="ltr">RMAN&gt;＃命令文件，具有合法语法2&gt;恢复数据库; 3&gt;恢复数据库; 4&gt; cmdfile没有语法错误Recovery Manager完成。
</pre></div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-F8ADDD5A-CAB0-4128-8DDD-9B8FD524362E__GUID-3074D89B-6848-4047-9E46-EB62A1684FA7">
                           <p class="titleinexample">示例4-22检查语法错误的命令文件语法</p>
                           <p>此示例显示使用<span><code class="codeph">CHECKSYNTAX</code></span>运行<span><code class="codeph">/tmp/badcmdfile</code></span>时的<span><code class="codeph">CHECKSYNTAX</code></span> ：</p><pre class="oac_no_warn" dir="ltr">RMAN&gt; #command文件，语法错误2&gt;恢复数据库3&gt;恢复RMAN-00571：=============================== ============================ RMAN-00569：=============== ERROR MESSAGE STACK跟随=============== RMAN-00571：============================== ============================= RMAN-00558：解析输入命令时遇到错误RMAN-01005：语法错误：找到“recover” ：期待以下之一：“archivelog，channel，check，controlfile，clone，database，datafile，device，from，force，high，（，preview，;，skip，spfile，standby，tablespace，until，validate”）RMAN-01007：在第3行第1列文件：/ tmp / badcmdfile</pre></div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-F8ADDD5A-CAB0-4128-8DDD-9B8FD524362E__GUID-088542B2-E796-447D-B4F9-3ABAAA2EEBB3">
                           <p class="titleinexample">示例4-23检查包含替换变量的命令文件的语法</p>
                           <p>通过包含替换变量，可以使命令文件动态化。检查包含替换变量的命令文件的语法时，RMAN会提示您输入值。此示例说明了在检查动态命令文件的语法时输入无效值时会发生什么。粗体文本表示在提示符下输入的文本。</p><pre class="oac_no_warn" dir="ltr">RMAN&gt; CONNECT TARGET * 2&gt; BACKUP TAG输入值1： <span class="bold">mybackup</span> abc COPIES输入值2： <span class="bold">mybackup</span> abc RMAN-00571：====================== ===================================== RMAN-00569：========= ======错误信息堆栈跟踪=============== RMAN-00571：===================== ====================================== RMAN-00558：解析输入命令时遇到错误RMAN- 01009：语法错误：找到“identifier”：期望以下之一：“integer”RMAN-01008：错误标识符为：mybackup RMAN-01007：第2行第25列文件：/tmp/whole_db.cmd</pre><p>RMAN表示语法错误，因为字符串<span><code class="codeph">mybackup</code></span>不是<span><code class="codeph">COPIES</code></span>的有效参数。</p>
                        </div>
                        <!-- class="example" -->
                     </div>
                  </div>
               </div>
            </div><a id="BRADV1130"></a><div class="props_rev_3"><a id="GUID-2273E896-C08B-498F-B96C-55400CCD1A17" name="GUID-2273E896-C08B-498F-B96C-55400CCD1A17"></a><h3 id="BRADV-GUID-2273E896-C08B-498F-B96C-55400CCD1A17" class="sect3"><span class="enumeration_section">4.6</span>使用RMAN管道接口</h3>
               <div>
                  <p>RMAN管道接口是向RMAN发出命令并从这些命令接收输出的另一种方法。使用此接口，可以将可移植的编程接口写入RMAN。</p>
                  <p>通过管道接口，RMAN使用<code class="codeph">DBMS_PIPE</code> PL / SQL包而不是操作系统shell获取命令并发送输出。通过使用RMAN客户端的<code class="codeph">PIPE</code>命令行参数来调用管道接口。RMAN使用两个私有管道：一个用于接收命令，另一个用于发送输出。管道的名称是从<code class="codeph">PIPE</code>参数的值派生的。例如，您可以使用以下命令调用RMAN：</p><pre class="oac_no_warn" dir="ltr">％rman PIPE abc TARGET /</pre><p>RMAN打开目标数据库中的两个管道： <code class="codeph">ORA$RMAN_ABC_IN</code> （RMAN用于接收用户命令）和<code class="codeph">ORA$RMAN_ABC_OUT</code> （RMAN用于将所有输出发送回RMAN）。输入和输出管道上的所有消息都是<code class="codeph">VARCHAR2</code>类型。
                  </p>
                  <p>RMAN不允许管道接口与公共管道一起使用，因为它们是潜在的安全问题。使用公共管道，任何知道管道名称的用户都可以向RMAN发送命令并拦截其输出。</p>
                  <p>如果管道未初始化，则RMAN将它们创建为专用管道。如果要在启动RMAN之前将命令放在输入管道上，则必须首先通过调用<code class="codeph">DBMS_PIPE.CREATE_PIPE</code>创建管道。每当未明确将管道创建为专用管道时，对管道的第一次访问会自动将其创建为公共管道，如果告知管道使用公共管道，则RMAN会返回错误。
                  </p>
                  <div class="infoboxnote" id="GUID-2273E896-C08B-498F-B96C-55400CCD1A17__GUID-0CDC83B2-0F0E-49A9-AE04-5813A686F0A0">
                     <p class="notep1">注意：</p>
                     <p>如果可以针对目标数据库运行多个RMAN会话，则必须为每个<a href="glossary.html#GUID-01D29658-41E1-4D45-9C7F-A761D56885B9"><span class="xrefglossterm">RMAN会话</span></a>使用唯一的管道名称。<code class="codeph">DBMS_PIPE.UNIQUE_SESSION_NAME</code>函数是一种可用于生成唯一管道名称的方法。
                     </p>
                  </div>
                  <p>本节包含以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="starting-interacting-with-rman-client.html#GUID-2C7C92ED-41ED-4A51-848E-34E695B107D4" title="此示例假定控制RMAN的应用程序想要连续运行多个命令。在每个命令沿管道发送并执行并返回输出后，RMAN暂停并等待下一个命令。">通过管道连续执行多个RMAN命令：示例</a></p>
                     </li>
                     <li>
                        <p><a href="starting-interacting-with-rman-client.html#GUID-5C6E3722-C0EC-4F1E-9D21-8205C5804C1F" title="此示例假定控制RMAN的应用程序想要将一个或多个命令作为单个作业运行。运行管道上的命令后，RMAN退出。">通过管道在单个作业中执行RMAN命令：示例</a></p>
                     </li>
                  </ul>
               </div><a id="BRADV158"></a><a id="BRADV89397"></a><div class="props_rev_3"><a id="GUID-2C7C92ED-41ED-4A51-848E-34E695B107D4" name="GUID-2C7C92ED-41ED-4A51-848E-34E695B107D4"></a><h4 id="BRADV-GUID-2C7C92ED-41ED-4A51-848E-34E695B107D4" class="sect4"><span class="enumeration_section">4.6.1</span>通过管道连续执行多个RMAN命令：示例</h4>
                  <div>
                     <p>此示例假定控制RMAN的应用程序想要连续运行多个命令。在每个命令沿管道发送并执行并返回输出后，RMAN暂停并等待下一个命令。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-2C7C92ED-41ED-4A51-848E-34E695B107D4__GUID-D9DFD470-F56B-4D68-BBF7-07E6ABF3155A">要通过管道执行RMAN命令：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>通过连接到目标数据库（必需）并指定<code class="codeph">PIPE</code>选项来启动RMAN。例如，输入：</span><div><pre class="oac_no_warn" dir="ltr">％rman PIPE abc TARGET /</pre><p>您还可以指定<code class="codeph">TIMEOUT</code>选项，如果在指定的秒数内没有从输入管道接收任何输入，则强制RMAN自动退出。例如，输入：</p><pre class="oac_no_warn" dir="ltr">％rman PIPE abc TARGET / TIMEOUT 60</pre></div>
                        </li>
                        <li class="stepexpand"><span>连接到目标数据库，并使用<code class="codeph">DBMS_PIPE.PACK_MESSAGE</code>和<code class="codeph">DBMS_PIPE.SEND_MESSAGE</code>将所需命令放在输入管道上。在管道模式下，RMAN在准备好接受输入而不是显示标准RMAN提示时发出消息<code class="codeph">RMAN-00572</code> 。</span></li>
                        <li class="stepexpand"><span>使用<code class="codeph">DBMS_PIPE.RECEIVE_MESSAGE</code>和<code class="codeph">DBMS_PIPE.UNPACK_MESSAGE</code>从输出管道读取RMAN输出。</span></li>
                        <li class="stepexpand"><span>重复步骤2和3，使用在步骤1中启动的相同RMAN实例执行更多命令。</span></li>
                        <li class="stepexpand"><span>如果在启动RMAN时使用了<code class="codeph">TIMEOUT</code>选项，则RMAN会在指定的时间长度内未收到任何输入后自动终止。要强制RMAN立即终止，请发送<code class="codeph">EXIT</code>命令。</span></li>
                     </ol>
                  </div>
               </div><a id="BRADV159"></a><a id="BRADV89398"></a><div class="props_rev_3"><a id="GUID-5C6E3722-C0EC-4F1E-9D21-8205C5804C1F" name="GUID-5C6E3722-C0EC-4F1E-9D21-8205C5804C1F"></a><h4 id="BRADV-GUID-5C6E3722-C0EC-4F1E-9D21-8205C5804C1F" class="sect4"><span class="enumeration_section">4.6.2</span>通过管道在单个作业中执行RMAN命令：示例</h4>
                  <div>
                     <p>此示例假定控制RMAN的应用程序想要将一个或多个命令作为单个作业运行。运行管道上的命令后，RMAN退出。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-5C6E3722-C0EC-4F1E-9D21-8205C5804C1F__GUID-ED0EBBD3-A129-4760-8F8E-45856EE2457D">要通过管道在单个作业中执行RMAN命令：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>连接到目标数据库后，创建一个管道（如果它在名称<code class="codeph">ORA$RMAN_</code> <span class="italic">pipe</span> <code class="codeph">_IN</code>下不存在）。</span></li>
                        <li class="stepexpand"><span>将所需命令放在输入管道上。在管道模式下，RMAN在准备好接受输入而不是显示标准RMAN提示时发出消息<code class="codeph">RMAN-00572</code> 。</span></li>
                        <li class="stepexpand"><span>使用<code class="codeph">PIPE</code>选项启动RMAN，并指定<code class="codeph">TIMEOUT</code> <code class="codeph">0</code> 。例如，输入：</span><div><pre class="oac_no_warn" dir="ltr">％rman PIPE abc TARGET / TIMEOUT 0</pre></div>
                        </li>
                        <li class="stepexpand"><span>RMAN读取放在管道上的命令，并使用<code class="codeph">DBMS_PIPE.PACK_MESSAGE</code>和<code class="codeph">DBMS_PIPE.SEND_MESSAGE</code>执行它们。当它已经耗尽输入管道时，RMAN立即退出。</span></li>
                        <li class="stepexpand"><span>使用<code class="codeph">DBMS_PIPE.RECEIVE_MESSAGE</code>和<code class="codeph">DBMS_PIPE.UNPACK_MESSAGE</code>从输出管道读取RMAN输出。</span><div>
                              <div class="infoboxnotealso" id="GUID-5C6E3722-C0EC-4F1E-9D21-8205C5804C1F__GUID-DD748A83-B525-4264-A5BD-0BCFA09C1636">
                                 <p class="notep1">也可以看看：</p>
                                 <p>有关<code class="codeph">DBMS_PIPE</code>包的文档，请<code class="codeph">DBMS_PIPE</code> <a href="../arpls/DBMS_PIPE.html#ARPLS038" target="_blank"><span class="italic">Oracle Database PL / SQL包和类型参考</span></a></p>
                              </div>
                           </div>
                        </li>
                     </ol>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>