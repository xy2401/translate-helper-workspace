<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>序列伪列</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="SQL Language Reference "></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="SQL Language Reference"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="sql-language-reference.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-02-12T15:36:36-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96310-02"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="Hierarchical-Query-Pseudocolumns.html" title="Previous" type="text/html"></link>
      <link rel="next" href="Version-Query-Pseudocolumns.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="SQL Language Reference"></meta>
    <meta name="dcterms.isVersionOf" content="SQLRF"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="Hierarchical-Query-Pseudocolumns.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="Version-Query-Pseudocolumns.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">SQL语言参考</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="Pseudocolumns.html" property="item" typeof="WebPage"><span property="name">伪列</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">序列伪列</li>
            </ol>
            <a id="GUID-693B576A-191D-45F5-B7CB-88D0EA821B44" name="GUID-693B576A-191D-45F5-B7CB-88D0EA821B44"></a><a id="SQLRF00253"></a>
            
            <h2 id="SQLRF-GUID-693B576A-191D-45F5-B7CB-88D0EA821B44" class="sect2">序列伪列</h2>
         </header>
         <div class="ind">
            <div>
               <div class="section">
                  <p><span class="bold">序列</span>是可以生成唯一顺序值的架构对象。这些值通常用于主键和唯一键。您可以使用以下伪列来引用SQL语句中的序列值：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><code class="codeph">CURRVAL</code> ：返回序列的当前值</p>
                     </li>
                     <li>
                        <p><code class="codeph">NEXTVAL</code> ：递增序列并返回下一个值</p>
                     </li>
                  </ul>
                  <p>您必须使用序列名称限定<code class="codeph">CURRVAL</code>和<code class="codeph">NEXTVAL</code> ：</p><pre class="oac_no_warn" dir="ltr"><span class="italic">序列</span> 。CURRVAL <span class="italic">序列</span> 。NEXTVAL</pre><p>要在另一个用户的模式中引用序列的当前值或下一个值，必须已为序列或<code class="codeph">SELECT</code> <code class="codeph">ANY</code> <code class="codeph">SEQUENCE</code>系统特权授予<code class="codeph">SELECT</code>对象特权，并且必须使用包含它的模式限定序列：</p><pre class="oac_no_warn" dir="ltr"><span class="italic">架构</span> 。 <span class="italic">序列</span> 。CURRVAL <span class="italic">架构</span> 。 <span class="italic">序列</span> 。NEXTVAL</pre><p>要引用远程数据库上序列的值，必须使用数据库链接的完整或部分名称限定序列：</p><pre class="oac_no_warn" dir="ltr"><span class="italic">架构</span> 。 <span class="italic">序列</span> 。CURRVAL @ <span class="italic">dblink</span> <span class="italic">架构</span> 。 <span class="italic">序列</span> 。NEXTVAL @ <span class="italic">dblink</span>
</pre><p>许多用户可以同时访问序列而无需等待或锁定。</p>
                  <div class="infoboxnotealso" id="GUID-693B576A-191D-45F5-B7CB-88D0EA821B44__GUID-9547801A-8966-489C-8022-260DA5B72DA9">
                     <p class="notep1">也可以看看：</p>
                     <p>有关引用数据库链接的更多信息，请参阅<a href="Syntax-for-Schema-Objects-and-Parts-in-SQL-Statements.html#GUID-61D0B206-A5EA-473F-AD04-7067D6E3914C">远程数据库中的对象</a></p>
                  </div>
               </div>
               <!-- class="section" -->
            </div><a id="SQLRF50945"></a><a id="SQLRF50944"></a><div class="props_rev_3"><a id="GUID-D438E28B-3E30-4B12-8D52-8DA5CFE2E0FF" name="GUID-D438E28B-3E30-4B12-8D52-8DA5CFE2E0FF"></a><h3 id="SQLRF-GUID-D438E28B-3E30-4B12-8D52-8DA5CFE2E0FF" class="sect3">在哪里使用序列值</h3>
               <div>
                  <div class="section">
                     <p>您可以在以下位置使用<code class="codeph">CURRVAL</code>和<code class="codeph">NEXTVAL</code> ：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>未包含在子查询，物化视图或视图中的<code class="codeph">SELECT</code>语句的选择列表</p>
                        </li>
                        <li>
                           <p><code class="codeph">INSERT</code>语句中子查询的选择列表</p>
                        </li>
                        <li>
                           <p><code class="codeph">INSERT</code>语句的<code class="codeph">VALUES</code>子句</p>
                        </li>
                        <li>
                           <p><code class="codeph">UPDATE</code>语句的<code class="codeph">SET</code>子句</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-D438E28B-3E30-4B12-8D52-8DA5CFE2E0FF__GUID-BD1CED16-081E-4053-BAC4-21999B8DB9F1">序列值的限制</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>您不能在以下构造中使用<code class="codeph">CURRVAL</code>和<code class="codeph">NEXTVAL</code> ：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">DELETE</code> ， <code class="codeph">SELECT</code>或<code class="codeph">UPDATE</code>语句中的子查询</p>
                        </li>
                        <li>
                           <p>查询视图或物化视图</p>
                        </li>
                        <li>
                           <p>带有<code class="codeph">DISTINCT</code>运算符的<code class="codeph">SELECT</code>语句</p>
                        </li>
                        <li>
                           <p>带有<code class="codeph">GROUP</code> <code class="codeph">BY</code>子句或<code class="codeph">ORDER</code> <code class="codeph">BY</code>子句的<code class="codeph">SELECT</code>语句</p>
                        </li>
                        <li>
                           <p>一个<code class="codeph">SELECT</code>与另一个合并报表<code class="codeph">SELECT</code>用语句<code class="codeph">UNION</code> ， <code class="codeph">INTERSECT</code> ，或者<code class="codeph">MINUS</code>集合运算符</p>
                        </li>
                        <li>
                           <p><code class="codeph">SELECT</code>语句的<code class="codeph">WHERE</code>子句</p>
                        </li>
                        <li>
                           <p><code class="codeph">CHECK</code>约束的条件</p>
                        </li>
                     </ul>
                     <p>在使用<code class="codeph">CURRVAL</code>或<code class="codeph">NEXTVAL</code>的单个SQL语句中，所有引用的<code class="codeph">LONG</code>列，更新的表和锁定的表必须位于同一数据库中。
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="SQLRF50947"></a><a id="SQLRF50948"></a><a id="SQLRF50949"></a><a id="SQLRF50946"></a><div class="props_rev_3"><a id="GUID-55228D7B-9CF1-4496-8524-3CD1DD4773FD" name="GUID-55228D7B-9CF1-4496-8524-3CD1DD4773FD"></a><h3 id="SQLRF-GUID-55228D7B-9CF1-4496-8524-3CD1DD4773FD" class="sect3">如何使用序列值</h3>
               <div>
                  <div class="section">
                     <p>创建序列时，可以定义其初始值以及其值之间的增量。对<code class="codeph">NEXTVAL</code>的第一个引用返回序列的初始值。对<code class="codeph">NEXTVAL</code>后续引用按定义的增量递增序列值并返回新值。对<code class="codeph">CURRVAL</code>任何引用始终返回序列的当前值，该值是最后一次引用<code class="codeph">NEXTVAL</code>返回的值。</p>
                     <p>在将<code class="codeph">CURRVAL</code>用于会话中的序列之前，必须首先使用<code class="codeph">NEXTVAL</code>初始化序列。有关序列的信息，请参阅<a href="CREATE-SEQUENCE.html#GUID-E9C78A8C-615A-4757-B2A8-5E6EFB130571">CREATE SEQUENCE</a> 。
                     </p>
                     <p>在包含对<code class="codeph">NEXTVAL</code>的引用的单个SQL语句中，Oracle将序列递增一次：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>对于<code class="codeph">SELECT</code>语句的外部查询块返回的每一行。这样的查询块可以出现在以下位置：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>顶级<code class="codeph">SELECT</code>语句</p>
                              </li>
                              <li>
                                 <p><code class="codeph">INSERT</code> ......<code class="codeph">SELECT</code>语句（单表或多表）。对于多表插入，对<code class="codeph">NEXTVAL</code>的引用必须出现在<code class="codeph">VALUES</code>子句中，并且对于子查询返回的每一行，序列都会更新一次，即使可以在多表插入的多个分支中引用<code class="codeph">NEXTVAL</code> 。
                                 </p>
                              </li>
                              <li>
                                 <p><code class="codeph">CREATE</code> <code class="codeph">TABLE</code> ...<code class="codeph">AS</code> <code class="codeph">SELECT</code>语句</p>
                              </li>
                              <li>
                                 <p>一个<code class="codeph">CREATE</code> <code class="codeph">MATERIALIZED</code> <code class="codeph">VIEW</code> ...<code class="codeph">AS</code> <code class="codeph">SELECT</code>语句</p>
                              </li>
                           </ul>
                        </li>
                        <li>
                           <p>对于<code class="codeph">UPDATE</code>语句中更新的每一行</p>
                        </li>
                        <li>
                           <p>对于包含<code class="codeph">VALUES</code>子句的每个<code class="codeph">INSERT</code>语句</p>
                        </li>
                        <li>
                           <p>对于每个<code class="codeph">INSERT</code> ......[ <code class="codeph">ALL</code> | <code class="codeph">FIRST</code> ]声明（多表插入）。多表插入被视为单个SQL语句。因此，对序列的<code class="codeph">NEXTVAL</code>的引用将仅对来自语句的<code class="codeph">SELECT</code>部分的每个输入记录增加一次序列。如果在<code class="codeph">INSERT</code>任何部分中多次指定<code class="codeph">NEXTVAL</code> ...[ <code class="codeph">ALL</code> | <code class="codeph">FIRST</code> ]语句，然后对于所有插入分支，该值将是相同的，无论可能插入给定记录的频率如何。
                           </p>
                        </li>
                        <li>
                           <p>对于<code class="codeph">MERGE</code>语句合并的每一行。对<code class="codeph">NEXTVAL</code>的引用可以出现在<span class="italic"><code class="codeph">merge_insert_clause</code></span>或<span class="italic"><code class="codeph">merge_update_clause</code></span>或两者中。对于每个更新的行以及插入的每一行， <code class="codeph">NEXTVALUE</code>值都会递增，即使在更新或插入操作中实际未使用序列号也是如此。如果在任何这些位置中指定了<code class="codeph">NEXTVAL</code>多次，则对于每一行，序列递增一次，并为该行的所有<code class="codeph">NEXTVAL</code>返回相同的值。
                           </p>
                        </li>
                        <li>
                           <p>对于多表<code class="codeph">INSERT</code> <code class="codeph">ALL</code>语句中的每个输入行。<code class="codeph">NEXTVAL</code> <span class="italic"><code class="codeph">insert_into_clause</code></span>查询返回的每一行递增一次，无论<span class="italic"><code class="codeph">insert_into_clause</code></span>映射到每一行的次数是<span class="italic"><code class="codeph">insert_into_clause</code></span> 。
                           </p>
                        </li>
                     </ul>
                     <p>如果这些位置中的任何一个包含多个对<code class="codeph">NEXTVAL</code>引用，则Oracle会将序列递增一次，并为所有出现的<code class="codeph">NEXTVAL</code>返回相同的值。</p>
                     <p>如果这些位置中的任何一个包含对<code class="codeph">CURRVAL</code>和<code class="codeph">NEXTVAL</code>引用，则Oracle会递增序列并为<code class="codeph">CURRVAL</code>和<code class="codeph">NEXTVAL</code>返回相同的值。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-55228D7B-9CF1-4496-8524-3CD1DD4773FD__GUID-70BEA950-CD8F-4FEA-B5E7-6B77E7BD6725">查找序列的下一个值：示例</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>此示例选择示例模式<code class="codeph">hr</code>员工序列的下一个值：</p><pre class="oac_no_warn" dir="ltr">SELECT employees_seq.nextval FROM DUAL;</pre></div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-55228D7B-9CF1-4496-8524-3CD1DD4773FD__GUID-161466B6-7D71-4E79-A541-10619FABA743">将序列值插入表中：示例</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>此示例递增员工序列，并将其值用于插入到示例表<code class="codeph">hr.employees</code>的新员工：</p><pre class="oac_no_warn" dir="ltr">INSERT INTO员工VALUES（employees_seq.nextval，'John'，'Doe'，'jdoe'，'555-1212'，TO_DATE（SYSDATE），'PU_CLERK'，2500，null，null，30）;</pre></div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-55228D7B-9CF1-4496-8524-3CD1DD4773FD__GUID-DDF42FC8-B251-4578-BB90-A41EC375B84E">重用序列的当前值：示例</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>此示例将具有下一个订单号的新订单添加到主订单表。然后，它会将具有此编号的子订单添加到详细订单表：</p><pre class="oac_no_warn" dir="ltr">INSERT INTO订单（order_id，order_date，customer_id）VALUES（orders_seq.nextval，TO_DATE（SYSDATE），106）; INSERT INTO order_items（order_id，line_item_id，product_id）VALUES（orders_seq.currval，1,2359）; INSERT INTO order_items（order_id，line_item_id，product_id）VALUES（orders_seq.currval，2,3290）; INSERT INTO order_items（order_id，line_item_id，product_id）VALUES（orders_seq.currval，3,2381）;</pre></div>
                  <!-- class="section" -->
               </div>
            </div>
         </div>
      </article>
   </body>
</html>