<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>建议失败</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Backup and Recovery Reference"></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Backup and Recovery Reference"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="database-backup-and-recovery-reference.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-09T19:31:58-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2003, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96242-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="double-at-sign.html" title="Previous" type="text/html"></link>
      <link rel="next" href="ALLOCATE-CHANNEL.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database Backup and Recovery Reference"></meta>
    <meta name="dcterms.isVersionOf" content="RCMRF"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="double-at-sign.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="ALLOCATE-CHANNEL.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">备份和恢复参考</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="rman-commands-at-sign-to-quit.html" property="item" typeof="WebPage"><span property="name">RMAN命令：@（at符号）到QUIT</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">建议失败</li>
            </ol>
            <a id="GUID-40985161-61A8-4C0A-9BEF-1DEECBCDF49C" name="GUID-40985161-61A8-4C0A-9BEF-1DEECBCDF49C"></a><a id="RCMRF89984"></a><a id="RCMRF89985"></a><a id="RCMRF89986"></a><a id="RCMRF89987"></a><a id="RCMRF89988"></a><a id="RCMRF89989"></a><a id="RCMRF89990"></a><a id="RCMRF166"></a>
            
            <h2 id="RCMRF-GUID-40985161-61A8-4C0A-9BEF-1DEECBCDF49C" class="sect2"><span class="enumeration_section">2.3建议</span>失败</h2>
         </header>
         <div class="ind">
            <div>
               <div class="section">
                  <p class="subhead1" id="GUID-40985161-61A8-4C0A-9BEF-1DEECBCDF49C__GUID-F9D5974B-3417-47C8-8076-4A1D4F9C50F8">目的</p>
                  <p><a id="d9849e96" class="indexterm-anchor"></a><a id="d9849e98" class="indexterm-anchor"></a><a id="d9849e100" class="indexterm-anchor"></a><a id="d9849e102" class="indexterm-anchor"></a>使用<code class="codeph">ADVISE FAILURE</code>命令显示指定故障的修复选项。此命令打印Data Recovery Advisor识别的故障摘要，并隐式关闭所有已修复的打开故障。
                  </p>
                  <p>建议的工作流程是在RMAN会话中运行以下命令： <code class="codeph"><a href="LIST.html#GUID-2BAB704C-A3C9-4F76-8D96-4BD961FBEF2E">LIST</a></code> <code class="codeph">FAILURE</code>显示故障， <code class="codeph">ADVISE FAILURE</code>显示修复选项， <code class="codeph"><a href="REPAIR-FAILURE.html#GUID-8BF5A460-940A-41D0-9A8B-C14A303DEA98">REPAIR FAILURE</a></code>修复故障。
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-40985161-61A8-4C0A-9BEF-1DEECBCDF49C__GUID-ADD0FC9C-2ADB-4452-A3D1-FD7E716C1AD8">先决条件</p>
                  <p>RMAN必须连接到目标数据库。请参阅<code class="codeph"><a href="CONNECT.html#GUID-64ECF1B8-4F70-413E-BEBE-1D5E8CD48B67">CONNECT</a></code>和<code class="codeph"><a href="RMAN.html#GUID-E5514ACB-59F6-4DB0-B4DB-64DF4C87CDE7">RMAN</a></code>命令以了解如何以<code class="codeph">TARGET</code>身份连接到数据库。</p>
                  <p>必须启动目标数据库实例。目标数据库必须是单实例数据库，并且不能是物理备用数据库，尽管它可以是逻辑备用数据库。</p>
                  <p>在当前版本中，Data Recovery Advisor仅支持单实例数据库。不支持Oracle Real Application Clusters（Oracle RAC）数据库。</p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-40985161-61A8-4C0A-9BEF-1DEECBCDF49C__GUID-35D8E348-2F1D-45DC-875F-F188F624D92D">使用说明</p>
                  <p>在提出修复策略之前，Data Recovery Advisor会验证修复可行性。例如，Data Recovery Advisor会检查介质恢复所需的所有备份和归档重做日志文件是否可用。<code class="codeph">ADVISE FAILURE</code>输出指示Data Recovery Advisor认为对于给定的一组故障最佳的修复策略。<code class="codeph">ADVISE FAILURE</code>命令可以生成手动和自动修复选项。
                  </p>
                  <p><span class="bold">手动修复选项</span></p>
                  <p>手动修复选项是强制性的或可选的。可选操作可以比自动修复更快速或更容易地修复故障。例如，Data Recovery Advisor可能会建议将故障转移到备用数据库，以替代主数据库修复。</p>
                  <p>在其他情况下，唯一的选择是手动，因为自动修复是不可行的。例如，I / O故障通常无法自动修复。此外，有时无法诊断故障，因为操作系统或磁盘子系统返回的数据不足。</p>
                  <p><span class="bold">自动修复选项</span></p>
                  <p>每个自动修复选项都是单个修复或一组修复步骤（有关命令输出的说明，请参阅<a href="ADVISE-FAILURE.html#GUID-40985161-61A8-4C0A-9BEF-1DEECBCDF49C__CHDFDEEA" title="描述ADVISE FAILURE命令的表格输出">表2-1</a> ）。当修复选项具有包含多个修复步骤的脚本时， <code class="codeph">ADVISE FAILURE</code>生成脚本，以便修复步骤的顺序正确。单个维修始终将关键故障一起修复。您必须修复关键故障，但您也可以同时修复非关键故障。您可以按随机顺序，逐个或成组修复非关键故障。
                  </p>
                  <p id="GUID-40985161-61A8-4C0A-9BEF-1DEECBCDF49C__CHDECAJH"><span class="bold">Oracle RAC和Data Recovery Advisor</span></p>
                  <p>如果数据故障导致Oracle RAC数据库的所有实例关闭，则可以在单实例模式下装入数据库，并使用Data Recovery Advisor检测和修复控制文件， <code class="codeph">SYSTEM</code>数据文件和字典故障。您还可以启动运行状况检查以测试其他数据库组件的数据故障。此方法不会检测其他群集实例本地的数据故障，例如，无法访问的数据文件。
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-40985161-61A8-4C0A-9BEF-1DEECBCDF49C__GUID-F9850143-F2B5-4B62-976C-1BD803883F7F">句法</p>
                  <p><span class="bold"><span class="italic">提醒:: =</span></span></p>
                  <div class="figure" id="GUID-40985161-61A8-4C0A-9BEF-1DEECBCDF49C__GUID-19CB6A08-29EC-4C4F-9A13-CD7BD1DFC873"><img src="img/advise.gif" alt="advise.eps的描述如下" title="advise.eps的描述如下" longdesc="img_text/advise.html"><br><a href="img_text/advise.html">说明advise.eps的说明</a></div>
                  <!-- class="figure" -->
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-40985161-61A8-4C0A-9BEF-1DEECBCDF49C__GUID-C2895B2D-535F-4615-8996-E956592CB3D1">语义</p>
                  <p id="GUID-40985161-61A8-4C0A-9BEF-1DEECBCDF49C__CHDFAGJC"><span class="bold"><span class="italic">劝告</span></span></p>
                  <div class="tblformalwide" id="GUID-40985161-61A8-4C0A-9BEF-1DEECBCDF49C__GUID-1140B04A-81FA-4DBC-B1B6-093C0A4B0A66">
                     <table cellpadding="4" cellspacing="0" class="FormalWide" title="" width="100%" border="1" summary="Describes ADVISE FAILURE command parameters" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="29%" id="d9849e212">语法元素</th>
                              <th align="left" valign="bottom" width="71%" id="d9849e215">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d9849e220" headers="d9849e212 ">
                                 <p><code class="codeph">建议失败</code></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d9849e220 d9849e215 ">
                                 <p><a id="d9849e226" class="indexterm-anchor"></a><a id="d9849e228" class="indexterm-anchor"></a>显示自动诊断存储库中记录的所有<code class="codeph">CRITICAL</code>和<code class="codeph">HIGH</code>优先级故障的信息。
                                 </p>
                                 <p>当前会话中先前执行了<code class="codeph">LIST FAILURE</code>命令时，您只能使用<code class="codeph">ADVISE FAILURE</code>而没有选项。
                                 </p>
                                 <p><span class="bold">注意：</span>如果自当前RMAN会话中的上一个<code class="codeph"><a href="LIST.html#GUID-2BAB704C-A3C9-4F76-8D96-4BD961FBEF2E">LIST</a></code> <code class="codeph">FAILURE</code>命令以来在诊断存储库中记录了新故障，则RMAN会在建议<code class="codeph">CRITICAL</code>和<code class="codeph">HIGH</code>故障之前发出警告。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d9849e264" headers="d9849e212 ">
                                 <p><code class="codeph">所有</code></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d9849e264 d9849e215 ">
                                 <p>列出一起修复所有打开故障的选项。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d9849e272" headers="d9849e212 ">
                                 <p><code class="codeph">危急</code></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d9849e272 d9849e215 ">
                                 <p>列出仅修复严重故障的选项。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d9849e280" headers="d9849e212 ">
                                 <p><code class="codeph">高</code></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d9849e280 d9849e215 ">
                                 <p>这仅修复与故障列表选择<code class="codeph">HIGH</code>优先级。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d9849e291" headers="d9849e212 ">
                                 <p><code class="codeph">低</code></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d9849e291 d9849e215 ">
                                 <p>列出仅修复<code class="codeph">LOW</code>优先级故障的选项。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d9849e302" headers="d9849e212 ">
                                 <p><code class="codeph">未知</code></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d9849e302 d9849e215 ">
                                 <p>列出仅修复在装入数据库之前无法确定优先级的故障的选项。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d9849e310" headers="d9849e212 ">
                                 <p><span class="italic"><code class="codeph">failureNumber</code></span></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d9849e310 d9849e215 ">
                                 <p>列出仅修复指定故障的选项。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d9849e319" headers="d9849e212 "><code class="codeph">EXCLUDE FAILURE</code> <span class="italic"><code class="codeph">failureNumber</code></span></td>
                              <td align="left" valign="top" width="71%" headers="d9849e319 d9849e215 ">
                                 <p>从列表中排除指定的失败。</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-40985161-61A8-4C0A-9BEF-1DEECBCDF49C__GUID-A76C7C74-E774-45F1-9B29-C1B746D8EF47">ADVISE FAILURE命令输出</p>
                  <p><code class="codeph">ADVISE FAILURE</code>输出包括<code class="codeph"><a href="LIST.html#GUID-2BAB704C-A3C9-4F76-8D96-4BD961FBEF2E">LIST</a></code> <code class="codeph">FAILURE</code>输出，如<a href="LIST.html#GUID-2BAB704C-A3C9-4F76-8D96-4BD961FBEF2E__CHDIJEIG" title="描述故障的LIST输出">表2-27所示</a> 。样本输出见<a href="ADVISE-FAILURE.html#GUID-40985161-61A8-4C0A-9BEF-1DEECBCDF49C__CHDICJCI">例2-5</a> 。
                  </p>
                  <p>RMAN在无序列表中显示强制和可选的手动操作。如果存在手动选项，则它们会出现在自动选项之前。<a href="ADVISE-FAILURE.html#GUID-40985161-61A8-4C0A-9BEF-1DEECBCDF49C__CHDFDEEA" title="描述ADVISE FAILURE命令的表格输出">表2-1</a>描述了自动修复选项的输出。
                  </p>
                  <div class="tblformalwide" id="GUID-40985161-61A8-4C0A-9BEF-1DEECBCDF49C__CHDFDEEA">
                     <p class="titleintable">表2-1自动修复选项</p>
                     <table cellpadding="4" cellspacing="0" class="FormalWide" title="自动修复选项" width="100%" border="1" summary="Describes the tabular output of the ADVISE FAILURE command" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="25%" id="d9849e369">柱</th>
                              <th align="left" valign="bottom" width="75%" id="d9849e372">指示</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="25%" id="d9849e377" headers="d9849e369 ">
                                 <p><code class="codeph">选项</code></p>
                              </td>
                              <td align="left" valign="top" width="75%" headers="d9849e377 d9849e372 ">
                                 <p>自动修复选项的标识符。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="25%" id="d9849e385" headers="d9849e369 ">
                                 <p><code class="codeph">战略</code></p>
                              </td>
                              <td align="left" valign="top" width="75%" headers="d9849e385 d9849e372 ">
                                 <p>使用<code class="codeph"><a href="REPAIR-FAILURE.html#GUID-8BF5A460-940A-41D0-9A8B-C14A303DEA98">REPAIR FAILURE</a></code>命令<code class="codeph"><a href="REPAIR-FAILURE.html#GUID-8BF5A460-940A-41D0-9A8B-C14A303DEA98">REPAIR FAILURE</a></code>策略。
                                 </p>
                                 <p>Data Recovery Advisor始终提供自动修复选项，尽可能不丢失数据。自动修复选项分为以下基本类别：</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p>修复没有数据丢失</p>
                                    </li>
                                    <li>
                                       <p>修复数据丢失，例如闪回数据库</p>
                                    </li>
                                 </ul>
                                 <p><span class="bold">注意：</span> <code class="codeph">ADVISE</code>命令将一组故障映射到Data Recovery Advisor认为最佳的一组修复步骤。如果可能，Data Recovery Advisor会将多个修复步骤合并到一个修复中。例如，如果数据库已损坏数据文件，缺少控制文件和丢失的当前重做日志组，则Data Recovery Advisor将建议单个整合的修复计划来还原数据库并执行时间点恢复。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="25%" id="d9849e414" headers="d9849e369 ">
                                 <p><code class="codeph">修理说明</code></p>
                              </td>
                              <td align="left" valign="top" width="75%" headers="d9849e414 d9849e372 ">
                                 <p>建议修理的说明。例如，建议的修复可以是恢复和恢复数据文件17。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="25%" id="d9849e422" headers="d9849e369 ">
                                 <p><code class="codeph">修复脚本</code></p>
                              </td>
                              <td align="left" valign="top" width="75%" headers="d9849e422 d9849e372 ">
                                 <p>包含所有修复操作和注释的可编辑脚本的位置。如果您未选择自动修复，则可以查看此脚本并对其进行编辑，以便在手动恢复策略中使用。</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-40985161-61A8-4C0A-9BEF-1DEECBCDF49C__GUID-85AC806E-A9D0-4E00-B104-2BB2E9E6438B">例子</p>
               </div>
               <!-- class="section" -->
               <div class="example" id="GUID-40985161-61A8-4C0A-9BEF-1DEECBCDF49C__CHDICJCI">
                  <p class="titleinexample">示例2-5显示所有故障的修复选项</p>
                  <p>此示例显示Recovery Data Advisor已知的所有故障的修复选项。该示例表示两个故障：丢失数据文件和具有损坏块的数据文件。</p><pre class="oac_no_warn" dir="ltr">RMAN&gt; LIST FAILURE;数据库故障列表=========================故障ID优先级状态检测时间摘要---------- ---- ---- --------- ------------- ------- 142 HIGH OPEN 23-APR-13缺少一个或多个非系统数据文件101 HIGH OPEN 23-APR-13数据文件1：'/ disk1 / oddata / prod / system01.dbf'包含一个或多个损坏的块RMAN&gt; ADVISE FAILURE;数据库故障列表=========================故障ID优先级状态检测时间摘要---------- ---- ---- --------- ------------- ------- 142 HIGH OPEN 23-APR-13缺少一个或多个非系统数据文件101 HIGH OPEN 23-APR-13数据文件1：'/ disk1 / oddata / prod / system01.dbf'包含一个或多个分析自动修复选项的损坏块;这可能需要一些时间使用通道ORA_DISK_1分析自动修复选项完成强制手动操作========================没有可用的手动操作可选手动操作=== ==================== 1。如果无意中重命名或移动了文件/disk1/oradata/prod/users01.dbf，请将其恢复为自动修复选项========================选项修复说明------ ------------------ 1恢复和恢复数据文件28;在文件1中执行块56416的块介质恢复策略：修复包括完整的介质恢复，没有数据丢失修复脚本：/disk1/oracle/log/diag/rdbms/prod/prod/hm/reco_660500184.hm</pre></div>
               <!-- class="example" -->
            </div>
         </div>
      </article>
   </body>
</html>