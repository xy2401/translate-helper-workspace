<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="An explanation is given of how to use advanced features of the XSQL pages publishing framework."></meta>
      <meta name="description" content="An explanation is given of how to use advanced features of the XSQL pages publishing framework."></meta>
      <title>使用XSQL Pages发布框架：高级主题</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Programmer&#39;s Guide"></meta>
      <meta property="og:description" content="An explanation is given of how to use advanced features of the XSQL pages publishing framework."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Programmer&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="xml-developers-kit-programmers-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-11T05:58:48-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2001, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96292-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="using-XSQL-pages-publishing-framework.html" title="Previous" type="text/html"></link>
      <link rel="next" href="XDK-for-C-plus-plus.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="XML Developers Kit Programmers Guide"></meta>
    <meta name="dcterms.isVersionOf" content="ADXDK"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="using-XSQL-pages-publishing-framework.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="XDK-for-C-plus-plus.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">程序员指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="XDK-for-Java.html" property="item" typeof="WebPage"><span property="name">Oracle XML Developer's Kit for Java</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">使用XSQL Pages发布框架：高级主题</li>
            </ol>
            <a id="GUID-02EA5758-7A8F-4FD7-B9F1-F346E759CD79" name="GUID-02EA5758-7A8F-4FD7-B9F1-F346E759CD79"></a><a id="ADXDK1026"></a><a id="ADXDK090"></a>
            
            <h2 id="ADXDK-GUID-02EA5758-7A8F-4FD7-B9F1-F346E759CD79" class="sect2"><span class="enumeration_chapter">25</span>使用XSQL页面发布框架：高级主题</h2>
         </header>
         <div class="ind">
            <div>
               <p>解释了如何使用XSQL页面发布框架的高级功能。</p>
               <div class="section"> </div>
               <!-- class="section" -->
            </div>
            <div>
               <div class="relinfo">
                  <p><strong>相关话题</strong></p>
                  <ul>
                     <li><a href="using-XSQL-pages-publishing-framework.html#GUID-A1834D2F-B962-4881-AE7A-F323FF11384D" title="下面介绍如何使用XSQL页面发布框架的基本功能。">使用XSQL Pages Publishing Framework</a></li>
                  </ul>
               </div>
               <div class="infoboxnotealso" id="GUID-02EA5758-7A8F-4FD7-B9F1-F346E759CD79__GUID-0B517870-1FD9-4127-A5FC-E740678183F8">
                  <p class="notep1">也可以看看：</p>
                  <p><a href="using-XSQL-pages-publishing-framework.html#GUID-A1834D2F-B962-4881-AE7A-F323FF11384D" title="下面介绍如何使用XSQL页面发布框架的基本功能。">使用XSQL Pages Publishing Framework</a>获取有关基本功能的信息</p>
               </div>
            </div>
            <a id="ADXDK19642"></a><div class="props_rev_3"><a id="GUID-2B89944D-0FF0-41C7-9547-C3F363718DF6" name="GUID-2B89944D-0FF0-41C7-9547-C3F363718DF6"></a><h3 id="ADXDK-GUID-2B89944D-0FF0-41C7-9547-C3F363718DF6" class="sect3">自定义XSQL配置文件名</h3>
               <div>
                  <p>默认情况下，XSQL页面框架要求将配置文件命名为<code class="codeph">XSQLConfig.xml</code> 。在开发，测试和生产环境之间移动时，您可以在配置文件的不同版本之间切换。要覆盖XSQL页面处理器读取的配置文件的名称，请设置系统属性<code class="codeph">xsql.config</code> 。
                  </p>
                  <div class="section">
                     <p>最简单的方法是通过定义名为<code class="codeph">xsql.config</code>的servlet初始化参数来指定Java虚拟机（JVM）命令行标志，例如<code class="codeph">-Dxsql.config=</code> <span class="italic"><code class="codeph">MyConfigFile.xml</code></span> 。将<code class="codeph">&lt;init-param&gt;</code>元素添加到<code class="codeph">web.xml</code>文件中，作为定义XSQL Servlet的<code class="codeph">&lt;servlet&gt;</code>标记的一部分：</p><pre class="oac_no_warn" dir="ltr">&lt;servlet&gt; &lt;servlet-name&gt; XSQL &lt;/ servlet-name&gt; &lt;servlet-class&gt; oracle.xml.xsql。XSQLServlet &lt;/ servlet-class&gt; &lt;init-param&gt; &lt;param-name&gt; xsql.config &lt;/ param-name&gt; &lt;param-value&gt; MyConfigFile.xml &lt;/ param-value&gt; &lt;description&gt;请使用MyConfigFile.xml而不是XSQLConfig.xml &lt;/ description&gt; &lt;/ init-param&gt; &lt;/ servlet&gt;</pre><p>servlet初始化参数仅适用于基于servlet的XSQL引擎。使用<code class="codeph">XSQLCommandLine</code>或<code class="codeph">XSQLRequest</code>编程接口时，请改用<code class="codeph">System</code>参数。
                     </p>
                     <div class="infoboxnote" id="GUID-2B89944D-0FF0-41C7-9547-C3F363718DF6__GUID-DBDBCC92-551C-47DE-9577-37078DFC028F">
                        <p class="notep1">注意：</p>
                        <p>始终从<code class="codeph">CLASSPATH</code>读取配置文件。例如，如果指定名为<code class="codeph">MyConfigFile.xml</code>的自定义配置参数文件，则XSQL处理器会尝试从<code class="codeph">CLASSPATH</code>读取XML文件作为资源。在Java平台企业版（Java EE）等servlet环境中，必须将<code class="codeph">MyConfigFile.xml</code>放在<code class="codeph">.\WEB-INF\classes</code>目录（或<code class="codeph">CLASSPATH</code>上的另一个顶级目录）。如果同时提供了servlet初始化参数和<code class="codeph">System</code>参数，则使用servlet初始化参数值。
                        </p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="ADXDK1027"></a><a id="ADXDK19643"></a><div class="props_rev_3"><a id="GUID-3C0CC5DB-60EB-4093-996C-E0E0463401D1" name="GUID-3C0CC5DB-60EB-4093-996C-E0E0463401D1"></a><h3 id="ADXDK-GUID-3C0CC5DB-60EB-4093-996C-E0E0463401D1" class="sect3">控制样式表的处理方式</h3>
               <div>
                  <p>这里的主题包括客户端样式表的概述，控制内容类型，动态分配样式表，在客户端处理样式表以及提供多个样式表。</p>
                  <div class="section"> </div>
                  <!-- class="section" -->
               </div><a id="ADXDK19644"></a><div class="props_rev_3"><a id="GUID-EE8B7B0D-B5E4-4B95-9CBB-7B7C4D747980" name="GUID-EE8B7B0D-B5E4-4B95-9CBB-7B7C4D747980"></a><h4 id="ADXDK-GUID-EE8B7B0D-B5E4-4B95-9CBB-7B7C4D747980" class="sect4">覆盖客户端样式表</h4>
                  <div>
                     <p>如果当前请求的XSQL页面允许，您可以在请求中提供可扩展样式表语言转换（XSLT）样式表URL。此技术允许您覆盖默认样式表或应用默认情况下不应用任何样式表的样式表。</p>
                     <div class="section">
                        <p>通过提供<code class="codeph">xml-stylesheet</code>参数作为请求的一部分来提供客户端启动的样式表URL。此参数的有效值为：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p>相对于正在处理的XSQL页面解释的任何相对URL。</p>
                           </li>
                           <li>
                              <p>任何使用HTTP协议方案的绝对URL，前提是它引用了XSQL配置文件中定义的可信主机。</p>
                           </li>
                           <li>
                              <p>字面值<code class="codeph">none</code> 。在开发期间设置<code class="codeph">xml-stylesheet=none</code>非常有用，可以暂时“短路”XSLT样式表处理，以确定样式表所看到的XML数据报。使用此技术可确定样式表未产生预期结果的原因。
                              </p>
                           </li>
                        </ul>
                        <p>您可以通过以下方式允许客户端覆盖XSQL页面的样式表：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>在XSQL配置文件中将<code class="codeph">allow-client-style</code>配置参数设置为<code class="codeph">no</code></p>
                           </li>
                           <li>
                              <p>在任何XSQL页面的文档元素上明确包含<code class="codeph">allow-client-style="no"</code>属性</p>
                           </li>
                        </ul>
                        <p>如果默认情况下在XSQL配置文件中全局禁用了样式表的客户端覆盖，则任何页面仍然可以通过在该页面的文档元素上包含<code class="codeph">allow-client-style="yes"</code>属性来显式启用客户端覆盖。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADXDK19646"></a><a id="ADXDK19645"></a><div class="props_rev_3"><a id="GUID-92BEFB8C-8AB0-4B03-80FE-C1C18B88310B" name="GUID-92BEFB8C-8AB0-4B03-80FE-C1C18B88310B"></a><h4 id="ADXDK-GUID-92BEFB8C-8AB0-4B03-80FE-C1C18B88310B" class="sect4">控制返回文档的内容类型</h4>
                  <div>
                     <p>设置所提供数据的内容类型可使请求客户端正确解释您返回的数据。如果样式表使用<code class="codeph">&lt;xsl:output&gt;</code>元素，则XSQL处理器会根据<code class="codeph">&lt;xsl:output&gt;</code>的<code class="codeph">media-type</code>和<code class="codeph">encoding</code>属性推断媒体类型和返回文档的<code class="codeph">encoding</code> 。
                     </p>
                     <div class="section">
                        <p><a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-92BEFB8C-8AB0-4B03-80FE-C1C18B88310B__BABGFJAC">例25-1中</a>的样式表使用<code class="codeph">&lt;xsl:output&gt;</code>上的<code class="codeph">media-type="application/vnd.ms-excel"</code>属性。此指令将包含<code class="codeph">hr.employees</code>表的标准查询的XSQL页面的结果转换为Microsoft Excel格式。
                        </p>
                        <p>以下XSQL页面使用<a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-92BEFB8C-8AB0-4B03-80FE-C1C18B88310B__BABGFJAC">示例25-1中</a>的样式表：</p><pre class="oac_no_warn" dir="ltr">&lt;？xml版本=“1.0”？&gt; &lt;？xml-stylesheet href =“empToExcel.xsl”type =“text / xsl”？&gt; <span class="bold">&lt;xsql：query connection =“hr”xmlns：xsql =“urn：oracle-xsql”&gt;</span> SELECT employee_id，email，salary FROM employees ORDER BY salary DESC &lt;/ xsql：query&gt;</pre></div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-92BEFB8C-8AB0-4B03-80FE-C1C18B88310B__BABGFJAC">
                        <p class="titleinexample">例25-1 empToExcel.xsl</p><pre class="oac_no_warn" dir="ltr">&lt;？xml版本=“1.0”？&gt; &lt;xsl：stylesheet version =“1.0”xmlns：xsl =“http://www.w3.org/1999/XSL/Transform”&gt; &lt;xsl：output method =“html”media-type =“application / vnd。 ms-excel“/&gt; &lt;xsl：template match =”/“&gt; &lt;html&gt; &lt;table&gt; &lt;tr&gt; &lt;th&gt; Id &lt;/ th&gt; &lt;th&gt;电子邮件&lt;/ th&gt; &lt;th&gt;薪水&lt;/ th&gt; &lt; / tr&gt; &lt;xsl：for-each select =“ROWSET / ROW”&gt; &lt;tr&gt; &lt;td&gt; &lt;xsl：value-of select =“EMPLOYEE_ID”/&gt; &lt;/ td&gt; &lt;td&gt; &lt;xsl：value-of select =“EMAIL”/&gt; &lt;/ td&gt; &lt;td&gt; &lt;xsl：value-of select =“SALARY”/&gt; &lt;/ td&gt; &lt;/ tr&gt; &lt;/ xsl：for-each&gt; &lt;/ table&gt; &lt;/ html&gt; &lt;/ xsl：template&gt; &lt;/ xsl：stylesheet&gt;</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADXDK19648"></a><a id="ADXDK19649"></a><a id="ADXDK19647"></a><div class="props_rev_3"><a id="GUID-61EA0E25-8824-4223-98C0-E839EAC130BA" name="GUID-61EA0E25-8824-4223-98C0-E839EAC130BA"></a><h4 id="ADXDK-GUID-61EA0E25-8824-4223-98C0-E839EAC130BA" class="sect4">动态分配样式表</h4>
                  <div>
                     <p>如果你包含<code class="codeph">&lt;?xml样式表？&gt;</code> <code class="codeph">.xsql</code>文件顶部的指令，然后XSQL页面处理器认为它用于转换生成的XML数据报。
                     </p>
                     <div class="section">
                        <p>考虑<a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-61EA0E25-8824-4223-98C0-E839EAC130BA__BABBEJCD">例25-2中</a>显示的<code class="codeph">emp_test.xsql</code>页面。
                        </p>
                        <p><a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-61EA0E25-8824-4223-98C0-E839EAC130BA__BABBEJCD">例25-2中</a>的页面使用<code class="codeph">emp.xsl</code>样式表在将响应返回给请求者之前转换服务器层中<code class="codeph">employees</code>查询的结果。处理器通过<code class="codeph">&lt;? <code class="codeph">href</code>伪属性中提供的URL访问样式表<code class="codeph">&lt;?xml样式表？&gt;</code>处理指令。
                        </p>
                        <p>例如，要根据传递给XSQL servlet的参数动态更改XSLT样式表，可以在<code class="codeph">xml-stylesheet</code>处理指令的<code class="codeph">href</code>属性中使用lexical参数，如以下示例指令所示：</p><pre class="oac_no_warn" dir="ltr">&lt;？xml-stylesheet type =“text / xsl” <span class="bold">href =“{@ filename} .xsl</span> ”？&gt;</pre><p>然后，您可以将<code class="codeph">filename</code>参数的值作为URL请求的一部分传递给XSQL servlet。
                        </p>
                        <p>您还可以使用XSQL页面中的<a href="XSQL-pages-reference.html#GUID-002F1541-47DD-4C9B-A0D3-8F45A5D3A51F" title="描述了元素&lt;xsql：set-page-param&gt;。">&lt;xsql：set-page-param&gt;</a>元素，根据SQL查询设置参数的值。例如， <a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-61EA0E25-8824-4223-98C0-E839EAC130BA__BABIEJED">例25-3中</a>的XSQL页面通过分配page-private参数的值来选择要在表中使用的样式表的名称。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-61EA0E25-8824-4223-98C0-E839EAC130BA__BABBEJCD">
                        <p class="titleinexample">例25-2 emp_test.xsql</p><pre class="oac_no_warn" dir="ltr">&lt;？xml版本=“1.0”？&gt; <span class="bold">&lt;？xml-stylesheet type =“text / xsl”href =“emp.xsl”？&gt;</span> &lt;page connection =“demo”xmlns：xsql =“urn：oracle-xsql”&gt; &lt;xsql：query&gt; SELECT * FROM employees ORDER BY salary DESC &lt;/ xsql：query&gt; &lt;/ page&gt;</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-61EA0E25-8824-4223-98C0-E839EAC130BA__BABIEJED">
                        <p class="titleinexample">例25-3 \ temp_test_dynamic.xsql</p><pre class="oac_no_warn" dir="ltr">&lt;？xml版本=“1.0”？&gt; &lt;？xml-stylesheet type =“text / xsl”href =“ <span class="bold">{@ sheet}</span> .xsl”？&gt; &lt;page connection =“demo”xmlns：xsql =“urn：oracle-xsql”&gt; &lt;xsql：set-page-param bind-params =“UserCookie” <span class="bold">name =“sheet”</span> &gt; SELECT stylesheet_name FROM user_prefs WHERE username =？&lt;/ xsql：set-page-param&gt; &lt;xsql：query&gt; SELECT * FROM employees ORDER BY salary DESC &lt;/ xsql：query&gt; &lt;/ page&gt;</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADXDK19650"></a><div class="props_rev_3"><a id="GUID-4CFA584A-4454-4E2A-A957-03BF39050E0C" name="GUID-4CFA584A-4454-4E2A-A957-03BF39050E0C"></a><h4 id="ADXDK-GUID-4CFA584A-4454-4E2A-A957-03BF39050E0C" class="sect4">在客户端中处理XSLT样式表</h4>
                  <div>
                     <p>描述了如何在客户端中处理XSLT样式表。</p>
                     <div class="section">
                        <p>某些浏览器支持在客户端中处理XSLT样式表。这些浏览器使用<code class="codeph">&lt;?识别要为XML文档处理的样式表<code class="codeph">&lt;?xml样式表？&gt;</code>处理指令。使用<code class="codeph">&lt;?xml样式表？&gt;</code>为此目的，是1999年6月29日题为“将样式表与XML文档关联，版本1.0”的W3C建议书的一部分。
                        </p>
                        <p>默认情况下，XSQL页面处理器在服务器中执行XSLT转换。通过将<code class="codeph">client="yes"</code>添加到您的<code class="codeph">&lt;?xml样式表？&gt;</code>在XSQL页面中处理指令，但是，您可以将XSLT处理推迟到客户端。处理器使用当前<code class="codeph">&lt;?提供XML数据报“raw” <code class="codeph">&lt;?xml样式表？&gt;</code>元素位于文档的顶部。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADXDK19653"></a><a id="ADXDK19652"></a><a id="ADXDK19651"></a><div class="props_rev_3"><a id="GUID-5DC69499-8476-48C7-9368-7AFA8D92EF21" name="GUID-5DC69499-8476-48C7-9368-7AFA8D92EF21"></a><h4 id="ADXDK-GUID-5DC69499-8476-48C7-9368-7AFA8D92EF21" class="sect4">提供多个样式表</h4>
                  <div>
                     <p>你可以包含多个<code class="codeph">&lt;?xml样式表？&gt;</code>处理XSQL页面顶部的指令。
                     </p>
                     <div class="section">
                        <p>指令可以包含可选的<code class="codeph">media</code>伪属性。如果指定，则处理器不区分大小写地将<code class="codeph">media</code>伪属性的值与HTTP标头中的User-Agent字符串的值进行比较。如果<code class="codeph">media</code>伪属性的值与User-Agent字符串的一部分匹配，则处理器选择当前的<code class="codeph">&lt;?xml样式表？&gt;</code>使用说明。否则，处理器忽略该指令并继续查找。处理器按文档顺序使用第一个匹配处理指令。<span class="italic">没有</span> <code class="codeph">media</code>伪属性的指令匹配所有用户代理。
                        </p>
                        <p><a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-5DC69499-8476-48C7-9368-7AFA8D92EF21__BABBBEBB">例25-4</a>显示了XSQL文件顶部的多个处理指令。该处理器采用<code class="codeph">doyouxml-lynx.xsl</code>为山猫浏览器， <code class="codeph">doyouxml-ie.xsl</code>用于Internet Explorer 5.0或5.5浏览器，并<code class="codeph">doyouxml.xsl</code>为所有其他人。
                        </p>
                        <p><a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-5DC69499-8476-48C7-9368-7AFA8D92EF21__G1043042" title="该表总结了&lt;？允许的受支持的伪属性。xml样式表？&gt;处理指令。属性名称和描述是列。">表25-1</a>总结了<code class="codeph">&lt;?允许的支持的伪属性<code class="codeph">&lt;?xml样式表？&gt;</code>处理指令。
                        </p>
                        <div class="tblformalwide" id="GUID-5DC69499-8476-48C7-9368-7AFA8D92EF21__G1043042">
                           <p class="titleintable">表25-1 &lt;？的伪属性xml-stylesheet？&gt;</p>
                           <table cellpadding="4" cellspacing="0" class="FormalWide" title="&lt;？的伪属性xml-stylesheet？&gt;" width="100%" border="1" summary="This table summarizes the supported pseudo-attributes allowed on the &lt;?xml-stylesheet?&gt; processing instruction. Attribute Name and Description are the columns." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="23%" id="d104050e980">属性名称</th>
                                    <th align="left" valign="bottom" width="77%" id="d104050e983">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="23%" id="d104050e988" headers="d104050e980 "><pre class="oac_no_warn" dir="ltr">type =“string”</pre></td>
                                    <td align="left" valign="top" width="77%" headers="d104050e988 d104050e983 ">
                                       <p>表示关联样式表的多用途Internet邮件扩展（MIME）类型。对于XSLT样式表，必须将此属性设置为字符串<code class="codeph">text/xsl</code> 。
                                       </p>
                                       <p>使用<code class="codeph">serializer</code>属性时，此属性可能存在<span class="italic">或</span>不存在，具体取决于在调用序列化程序之前是否必须执行XSLT样式表。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="23%" id="d104050e1006" headers="d104050e980 "><pre class="oac_no_warn" dir="ltr">href =“URL”</pre></td>
                                    <td align="left" valign="top" width="77%" headers="d104050e1006 d104050e983 ">
                                       <p>指示要使用的XSLT样式表的相对或绝对URL。如果提供使用<code class="codeph">http</code>协议方案的绝对URL，则资源的IP地址必须是XSQL配置文件中列出的可信主机（默认情况下，名为<code class="codeph">XSQLConfig.xml</code> ）。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="23%" id="d104050e1019" headers="d104050e980 "><pre class="oac_no_warn" dir="ltr">media =“string”</pre></td>
                                    <td align="left" valign="top" width="77%" headers="d104050e1019 d104050e983 ">
                                       <p>对请求设备发送的HTTP头中的<code class="codeph">User-Agent</code>字符串执行<span class="italic">不区分大小写的</span>匹配。此属性是可选的。目前<code class="codeph">&lt;?xml样式表？&gt;</code>仅当<code class="codeph">User-Agent</code>字符串包含<code class="codeph">media</code>属性的值时，才使用&gt;</code>处理指令;否则会被忽略。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="23%" id="d104050e1041" headers="d104050e980 "><pre class="oac_no_warn" dir="ltr">client =“boolean”</pre></td>
                                    <td align="left" valign="top" width="77%" headers="d104050e1041 d104050e983 ">
                                       <p>如果设置为<code class="codeph">yes</code> ，则将关联的XSLT样式表的处理推迟到客户端。原始XML数据报以当前<code class="codeph">&lt;?发送到客户端<code class="codeph">&lt;?xml样式表？&gt;</code>文档顶部的说明。如果未指定，则默认为在服务器中执行转换。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="23%" id="d104050e1054" headers="d104050e980 "><pre class="oac_no_warn" dir="ltr">serializer =“string”</pre></td>
                                    <td align="left" valign="top" width="77%" headers="d104050e1054 d104050e983 ">
                                       <p>默认情况下，XSQL页面处理器使用：</p>
                                       <ul style="list-style-type:disc">
                                          <li>
                                             <p>如果没有使用XSLT样式表，则为XML文档对象模型（DOM）序列化程序</p>
                                          </li>
                                          <li>
                                             <p>如果使用XSLT样式表，则为XSLT处理器序列化程序</p>
                                          </li>
                                       </ul>
                                       <p>指定此伪属性表示必须使用自定义序列化程序实现。</p>
                                       <p>有效值是在XSQL配置文件的<code class="codeph">&lt;serializerdefs&gt;</code>部分中定义的自定义序列化程序的名称或字符串<code class="codeph">java:fully.qualified.Classname</code> 。如果同时存在XSLT样式表和序列化程序属性，则处理器首先执行XSLT转换，然后调用自定义序列化程序将最终结果呈现给<code class="codeph">OutputStream</code>或<code class="codeph">PrintWriter</code> 。
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-5DC69499-8476-48C7-9368-7AFA8D92EF21__BABBBEBB">
                        <p class="titleinexample">例25-4多个&lt;？xml-stylesheet？&gt;加工说明</p><pre class="oac_no_warn" dir="ltr">&lt;？xml版本=“1.0”？&gt; &lt;？xml-stylesheet type =“text / xsl”media =“lynx”href =“doyouxml-lynx.xsl”？&gt; &lt;？xml-stylesheet type =“text / xsl”media =“msie 5”href =“doyouxml-ie.xsl”？&gt; &lt;？xml-stylesheet type =“text / xsl”href =“doyouxml.xsl”？&gt; &lt;page xmlns：xsql =“urn：oracle-xsql”connection =“demo”&gt;</pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
            </div><a id="ADXDK1028"></a><a id="ADXDK19654"></a><div class="props_rev_3"><a id="GUID-9AE06DA9-6F80-4182-896A-DA902ADC57D1" name="GUID-9AE06DA9-6F80-4182-896A-DA902ADC57D1"></a><h3 id="ADXDK-GUID-9AE06DA9-6F80-4182-896A-DA902ADC57D1" class="sect3">使用数组值参数</h3>
               <div>
                  <p>这里的主题包括使用参数的数组值，包括SQL或PL / SQL代码中的页面或会话参数和参数</p>
                  <div class="section"> </div>
                  <!-- class="section" -->
               </div><a id="ADXDK19656"></a><a id="ADXDK19655"></a><div class="props_rev_3"><a id="GUID-26DC324B-D279-4894-BF15-61CF8137522C" name="GUID-26DC324B-D279-4894-BF15-61CF8137522C"></a><h4 id="ADXDK-GUID-26DC324B-D279-4894-BF15-61CF8137522C" class="sect4">为数组值参数提供值</h4>
                  <div>
                     <p>请求参数，会话参数和页面私有参数可以将字符串数组作为值。要将参数的值视为数组，请在其名称末尾添加两个空方括号。</p>
                     <div class="section">
                        <p>例如，如果发布了一个HTML表单，其中出现了四次名为<code class="codeph">productid</code>的输入控件，则使用符号<code class="codeph">productid[]</code>来引用数组值的<code class="codeph">productid</code>参数。如果在不使用数组括号表示法的情况下引用数组值参数，则XSQL处理器将使用第一个数组条目的值。
                        </p>
                        <div class="infoboxnote" id="GUID-26DC324B-D279-4894-BF15-61CF8137522C__GUID-FA0D55C1-1240-4918-862E-924EAA476063">
                           <p class="notep1">注意：</p>
                           <p>XSQL处理器不支持在数组括号内使用数字。也就是说，您可以参考<code class="codeph">productid</code>或<code class="codeph">productid[]</code> ，但不能参考<code class="codeph">productid[2]</code> 。
                           </p>
                        </div>
                        <p>假设您将一个数组值参数引用为动作处理程序属性值内或动作处理程序元素内容中的词法替换参数。XSQL页面处理器将其值转换为逗号分隔的非空和非空字符串列表，这些字符串存在于数组中。<a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-26DC324B-D279-4894-BF15-61CF8137522C__BABEGJHI">例25-5</a>显示了一个带有数组值参数的XSQL页面。
                        </p>
                        <p>您可以调用XSQL命令行实用程序为<code class="codeph">Page.xsql</code>的<code class="codeph">productid</code>参数提供多个值：</p><pre class="oac_no_warn" dir="ltr">xsql Page.xsql productid = 111 productid = 222 productid = 333 productid = 444</pre><p>上述命令将<code class="codeph">productid[]</code>数组值参数设置为值{“ <code class="codeph">111</code> ”，“ <code class="codeph">222</code> ”，“ <code class="codeph">333</code> ”，“ <code class="codeph">444</code> ”}。XSQL页面处理器用字符串“111,222,333,444”替换查询中的<code class="codeph">{@productid[]}</code>表达式。
                        </p>
                        <p>您还可以通过<code class="codeph">XSQLRequest</code>应用程序编程接口（API）以编程方式传递多值参数，该接口接受<code class="codeph">java.util.命名参数Dictionary</code> 。您可以使用<code class="codeph">Hashtable</code>并调用其<code class="codeph">put(name,value)</code>方法将<code class="codeph">String</code> -valued参数添加到请求中。要添加多值参数，请输入<code class="codeph">String[]</code>类型的值，而不是<code class="codeph">String</code>类型。
                        </p>
                        <div class="infoboxnote" id="GUID-26DC324B-D279-4894-BF15-61CF8137522C__GUID-7FF8435E-0F70-4262-9E5D-33283B9601FC">
                           <p class="notep1">注意：</p>
                           <p>只有请求参数，页面私有参数和会话参数才能使用字符串数组。<a href="XSQL-pages-reference.html#GUID-69D0F80D-6C91-458B-B19A-41E2FD4F3400" title="描述了元素&lt;xsql：set-stylesheet-param&gt;。">&lt;xsql：set-stylesheet-param&gt;</a>和<a href="XSQL-pages-reference.html#GUID-AAD3692A-5322-4167-9F20-0BEB81413765" title="描述了元素&lt;xsql：set-cookie&gt;。">&lt;xsql：set-cookie&gt;</a>操作仅支持将参数作为简单字符串值使用。要在XSLT样式表中引用多值参数，请使用<a href="XSQL-pages-reference.html#GUID-7E25FEC6-00BE-4CDB-8841-35B4FF82D4AC" title="描述了元素&lt;xsql：include-param&gt;。">&lt;xsql：include-param&gt;</a>将多值参数包含到XSQL数据页中，然后在样式表中使用XPath表达式来引用数据页中的值。
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-26DC324B-D279-4894-BF15-61CF8137522C__BABEGJHI">
                        <p class="titleinexample">示例25-5在XSQL页面中使用数组值参数</p><pre class="oac_no_warn" dir="ltr">&lt;page xmlns：xsql =“urn：oracle-xsql”&gt; &lt;xsql：query&gt; SELECT description FROM product WHERE productid in（{@ productid []}）/ *使用词法参数* / &lt;/ xsql：query&gt; &lt;/ page &gt;</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADXDK19657"></a><div class="props_rev_3"><a id="GUID-942C03B8-1201-44CA-94A5-A23AC1B17960" name="GUID-942C03B8-1201-44CA-94A5-A23AC1B17960"></a><h4 id="ADXDK-GUID-942C03B8-1201-44CA-94A5-A23AC1B17960" class="sect4">从字符串设置数组值页面或会话参数</h4>
                  <div>
                     <p>您可以从字符串设置page-private参数或会话参数的值。</p>
                     <div class="section">
                        <p>您可以通过在名称上使用数组括号表示法将page-private参数的值设置为字符串数组值：</p><pre class="oac_no_warn" dir="ltr">&lt;！ -  param name包含数组括号 - &gt; &lt;xsql：set-page-param name =“names []”value =“Tom Jane Joe”/&gt;</pre><p>您可以为会话参数设置类似值，如下例所示：</p><pre class="oac_no_warn" dir="ltr">&lt;xsql：set-session-param name =“dates []”value =“12-APR-1962 15-JUL-1968”/&gt;</pre><p>默认情况下，当参数的名称使用数组括号时，XSQL处理器会将该值视为以空格或逗号分隔的列表并对其进行标记。</p>
                        <p>生成的字符串数组值包含这些单独的标记。在前面的例子中，参数<code class="codeph">names[]</code>是字符串数组{“ <code class="codeph">Tom</code> ”，“ <code class="codeph">Jane</code> ”，“ <code class="codeph">Joe</code> ”}和参数<code class="codeph">dates[]</code>是字符串数组{“ <code class="codeph">12-APR-1962</code> ”，“ <code class="codeph">15-JUL-1968</code> “}。
                        </p>
                        <p>要处理包含空格的字符串，标记化算法首先检查字符串是否存在逗号。如果在字符串中找到至少一个逗号，则使用逗号作为标记分隔符。例如，此操作将<code class="codeph">names[]</code>参数的值设置为字符串数组{“ <code class="codeph">Tom Jones</code> ”，“ <code class="codeph">Jane York</code> ”}：</p><pre class="oac_no_warn" dir="ltr">&lt;！ -  param name包含数组括号 - &gt; &lt;xsql：set-page-param name =“names []”value =“Tom Jones，Jane York”/&gt;</pre><p>默认情况下，当您设置名称不以数组括号结尾的参数时，则不会发生字符串标记化。因此，此操作将参数<code class="codeph">names</code>设置为文字字符串“ <code class="codeph">Tom Jones,Jane York</code> ”：</p><pre class="oac_no_warn" dir="ltr">&lt;！ -  param name不包含数组括号 - &gt; &lt;xsql：set-page-param name =“names”value =“Tom Jones，Jane York”/&gt;</pre><p>您可以通过在<a href="XSQL-pages-reference.html#GUID-002F1541-47DD-4C9B-A0D3-8F45A5D3A51F" title="描述了元素&lt;xsql：set-page-param&gt;。">&lt;xsql：set-page-param&gt;</a>或<a href="XSQL-pages-reference.html#GUID-95912581-8779-4BF5-8B48-7BD49919AFE5" title="描述了元素&lt;xsql：set-session-param&gt;。">&lt;xsql：set-session-param&gt;</a>操作中包含<code class="codeph">treat-list-as-array="yes"</code>属性来强制对字符串进行标记。设置此属性后，XSQL处理器会将标记化值的逗号分隔字符串分配给参数。例如，此操作将<code class="codeph">names</code>参数设置为文字字符串“ <code class="codeph">Tom,Jane,Joe</code> ”：</p><pre class="oac_no_warn" dir="ltr">&lt;！ -  param name不包含数组括号 - &gt; &lt;xsql：set-page-param name =“names”value =“Tom Jane Joe”treat-list-as-array =“yes”/&gt;</pre><p>当您设置一个简单的字符串值参数的值并且您使用<code class="codeph">treat-list-as-array="yes"</code>对该值进行标记时，可以包含<code class="codeph">quote-array-values="yes"</code>属性以包围逗号 - 带单引号的定界值。因此，此操作将文字字符串值“ <code class="codeph">'Tom Jones','Jane York','Jimmy'</code> ”分配给<code class="codeph">names</code>参数：</p><pre class="oac_no_warn" dir="ltr">&lt;！ -  param name不包含数组括号 - &gt; &lt;xsql：set-page-param name =“names”value =“Tom Jones，Jane York，Jimmy”treat-list-as-array =“yes”引用-array值= “是”/&gt;</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADXDK19659"></a><a id="ADXDK19660"></a><a id="ADXDK19661"></a><a id="ADXDK19658"></a><div class="props_rev_3"><a id="GUID-81F6D961-7250-4527-82E3-E0100E399292" name="GUID-81F6D961-7250-4527-82E3-E0100E399292"></a><h4 id="ADXDK-GUID-81F6D961-7250-4527-82E3-E0100E399292" class="sect4">SQL和PL / SQL语句中的绑定数组值参数</h4>
                  <div>
                     <p>在XSQL页面中支持字符串值标量绑定变量的地方，您还可以绑定数组值参数。在为属性<code class="codeph">bind-params</code>提供的参数名称列表中使用数组参数名称，例如<code class="codeph">myparam[]</code> 。此技术允许您在SQL语句和PL / SQL过程中处理数组值参数。
                     </p>
                     <div class="section">
                        <p></p>
                        <p>XSQL处理器将数组值参数绑定为名为<code class="codeph">XSQL_TABLE_OF_VARCHAR</code>的嵌套表对象类型。您必须使用此DDL语句在当前架构中创建此类型：</p><pre class="oac_no_warn" dir="ltr">CREATE TYPE xsql_table_of_varchar AS TABLE OF VARCHAR2（2000）;</pre><p>虽然类型必须具有名称<code class="codeph">xsql_table_of_varchar</code> ，但您可以根据需要更改<code class="codeph">VARCHAR2</code>字符串的维度。您必须为您希望在数组值字符串参数中处理的任何字符串值设置足够长的维度。
                        </p>
                        <p>考虑<a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-81F6D961-7250-4527-82E3-E0100E399292__BABHBICE">例25-6中</a>所示的PL / SQL函数。
                        </p>
                        <p><a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-81F6D961-7250-4527-82E3-E0100E399292__BABFJGDH">例25-7</a>中的XSQL页面显示了如何在使用<code class="codeph">testTableFunction</code>的SQL语句中绑定两个数组值参数。
                        </p>
                        <p>在<a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-81F6D961-7250-4527-82E3-E0100E399292__BABFJGDH">例25-7中</a>执行XSQL页面<a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-81F6D961-7250-4527-82E3-E0100E399292__BABFJGDH">会</a>生成以下数据报：</p><pre class="oac_no_warn" dir="ltr">&lt;page someNames =“aa，bb，cc”someValues =“11,22,33”&gt; &lt;ROWSET&gt; &lt;ROW num =“1”&gt; &lt;EXAMPLE&gt; aa = 11：bb = 22：cc = 33 &lt;/ EXAMPLE&gt; &lt;/ ROW&gt; &lt;/ ROWSET&gt; &lt;/ page&gt;</pre><p>此技术显示XSQL处理器将数组值<code class="codeph">someNames[]</code>和<code class="codeph">someValues[]</code>参数绑定为表集合类型。它迭代这些值并连接它们以产生“ <code class="codeph">aa=11:bb=22:cc=33</code> ”字符串值作为PL / SQL函数的返回值。
                        </p>
                        <p>您可以在bind-params字符串中混合任意数量的常规参数和数组值参数。使用数组括号表示法将参数绑定为数组。</p>
                        <div class="infoboxnote" id="GUID-81F6D961-7250-4527-82E3-E0100E399292__GUID-871921D0-7228-4172-A515-197120A522FE">
                           <p class="notep1">注意：</p>
                           <p>如果您运行<a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-81F6D961-7250-4527-82E3-E0100E399292__BABFJGDH">示例25-7中</a>的页面但尚未创建之前显示的<code class="codeph">XSQL_TABLE_OF_VARCHAR</code>类型，则会收到错误，例如：</p><pre class="oac_no_warn" dir="ltr">&lt;page someNames =“aa，bb，cc”someValues =“11,22,33”&gt; &lt;xsql-error code =“17074”action =“xsql：query”&gt; &lt;statement&gt; select testTableFunction（？，？）例如来自双&lt;/ statement&gt; &lt;message&gt;无效的名称模式：SCOTT.XSQL_TABLE_OF_VARCHAR &lt;/ message&gt; &lt;/ xsql-error&gt; &lt;/ page&gt;</pre></div>
                        <p>由于XSQL处理器将数组参数绑定为嵌套表集合类型，因此可以将<code class="codeph">TABLE()</code>运算符与SQL中的<code class="codeph">CAST()</code>运算符一起使用，以将嵌套表绑定变量值视为值表。然后，您可以查询此表。此技术在子查询中特别有用。<a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-81F6D961-7250-4527-82E3-E0100E399292__BABJDBIB">例25-8中</a>的页面使用包含员工ID的数组值参数来限制从<code class="codeph">hr.employees</code>查询的行。
                        </p>
                        <p><a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-81F6D961-7250-4527-82E3-E0100E399292__BABJDBIB">例25-8中</a>的XSQL页面生成一个数据报，例如：</p><pre class="oac_no_warn" dir="ltr">&lt;page&gt; &lt;ROWSET&gt; &lt;ROW num =“1”&gt; &lt;NAME&gt; Alana Walsh &lt;/ NAME&gt; &lt;SALARY&gt; 3100 &lt;/ SALARY&gt; &lt;/ ROW&gt; &lt;ROW num =“2”&gt; &lt;NAME&gt; Kevin Feeny &lt;/ NAME&gt; &lt;SALARY&gt; 3000 &lt;/ SALARY&gt; &lt;/ ROW&gt; &lt;/ ROWSET&gt; &lt;/ page&gt;</pre><p><a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-81F6D961-7250-4527-82E3-E0100E399292__BABFJGDH">例25-7</a>和<a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-81F6D961-7250-4527-82E3-E0100E399292__BABJDBIB">例25-8</a>显示了如何将<code class="codeph">bind-params</code>与<a href="XSQL-pages-reference.html#GUID-A54C8FC8-D81E-466F-8DE9-E425387A6563" title="描述了元素&lt;xsql：query&gt;。">&lt;xsql：query&gt;一起使用</a> ，但这些技术适用于<a href="XSQL-pages-reference.html#GUID-B44BC32C-50EF-480F-834E-062BD5AE4866" title="描述了元素&lt;xsql：dml&gt;。">&lt;xsql：dml&gt;</a> ， <a href="XSQL-pages-reference.html#GUID-7F7A66D1-BFBB-402A-A2DD-C2A98349CAA7" title="描述了元素&lt;xsql：include-owa&gt;。">&lt;xsql：include-owa&gt;</a> ， <a href="XSQL-pages-reference.html#GUID-0E5978EA-0322-45EC-8B22-EA0F3C41D9B8" title="描述了元素&lt;xsql：ref-cursor-function&gt;。">&lt;xsql：ref-cursor-function &gt;</a> ，以及接受SQL或PL / SQL语句的其他操作。
                        </p>
                        <p>PL / SQL索引表使用OCI JDBC驱动程序，但不使用JDBC瘦驱动程序。通过使用嵌套表集合类型<code class="codeph">XSQL_TABLE_OF_VARCHAR</code> ，可以将数组值参数与任一驱动程序一起使用。这样可以避免在PL / SQL中失去使用数组值的编程灵活性。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-81F6D961-7250-4527-82E3-E0100E399292__BABHBICE">
                        <p class="titleinexample">例25-6 testTableFunction</p><pre class="oac_no_warn" dir="ltr">功能testTableFunction（p_name XSQL_TABLE_OF_VARCHAR，p_value XSQL_TABLE_OF_VARCHAR）RETURN VARCHAR2 IS lv_ret VARCHAR2（4000）; lv_numElts INTEGER; BEGIN如果p_name不为NULL，那么lv_numElts：= p_name。计数; FOR j IN 1..lv_numElts LOOP IF（j&gt; 1）那么lv_ret：= lv_ret ||'：';万一; lv_ret：= lv_ret || p_name（j）||'='|| p_value（j）;结束循环;万一;返回lv_ret;结束;</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-81F6D961-7250-4527-82E3-E0100E399292__BABFJGDH">
                        <p class="titleinexample">示例25-7具有数组值参数的XSQL页面</p><pre class="oac_no_warn" dir="ltr">&lt;page xmlns：xsql =“urn：oracle-xsql”connection =“demo”someNames =“aa，bb，cc”someValues =“11,22,33”&gt; &lt;xsql：query bind-params =“someNames [] someValues []“&gt; SELECT testTableFunction（？，？）例如FROM双&lt;/ xsql：query&gt; &lt;/ page&gt;</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-81F6D961-7250-4527-82E3-E0100E399292__BABJDBIB">
                        <p class="titleinexample">示例25-8使用数组值参数来限制行</p><pre class="oac_no_warn" dir="ltr">&lt;page xmlns：xsql =“urn：oracle-xsql”connection =“hr”&gt; &lt;xsql：set-page-param name =“someEmployees []”value =“196,197”/&gt; &lt;xsql：query bind-params =“ someEmployees []“&gt; SELECT first_name ||' '|| last_name AS名称，薪水FROM employees WHERE employee_id IN（SELECT * FROM TABLE（CAST（？AS xsql_table_of_varchar）））&lt;/ xsql：query&gt; &lt;/ page&gt;</pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
            </div><a id="ADXDK19663"></a><a id="ADXDK19662"></a><div class="props_rev_3"><a id="GUID-399504CA-5039-4004-9500-EBAF0A516928" name="GUID-399504CA-5039-4004-9500-EBAF0A516928"></a><h3 id="ADXDK-GUID-399504CA-5039-4004-9500-EBAF0A516928" class="sect3">在内置动作中设置错误参数</h3>
               <div>
                  <p>当操作报告非致命错误时，您可以在内置XSQL操作上设置page-private参数。</p>
                  <div class="section">
                     <p>XSQL页面处理器确定操作在执行期间是否遇到非致命错误。例如，尝试插入行或调用存储过程可能会失败，并且数据库异常会作为<code class="codeph">&lt;xsql-error&gt;</code>元素包含在XSQL数据页中。
                     </p>
                     <p>当操作报告非致命错误时，在操作上使用属性<code class="codeph">error-param</code>来设置内置XSQL操作的页面私有参数。例如，要在action <a href="XSQL-pages-reference.html#GUID-B44BC32C-50EF-480F-834E-062BD5AE4866" title="描述了元素&lt;xsql：dml&gt;。">&lt;xsql：dml&gt;中</a>的语句遇到数据库<code class="codeph">dml-error</code>时设置参数<code class="codeph">dml-error</code> ，可以使用<a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-399504CA-5039-4004-9500-EBAF0A516928__BABFDBEB">例25-9中</a>所示的技术。
                     </p>
                     <p>如果执行action <code class="codeph">&lt;xsql:dml&gt;</code>遇到错误，则XSQL处理器将page-private参数<code class="codeph">dml-error</code>设置为字符串<code class="codeph">"Error"</code> 。如果执行成功，则XSQL处理器不会为error参数赋值。在<a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-399504CA-5039-4004-9500-EBAF0A516928__BABFDBEB">例25-9中</a> ，如果page-private参数<code class="codeph">dml-error</code>已经存在，那么它将保留其当前值。如果它不存在则继续不存在。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-399504CA-5039-4004-9500-EBAF0A516928__BABFDBEB">
                     <p class="titleinexample">示例25-9设置错误参数</p><pre class="pre codeblock"><code>&lt;xsql：dml error-param =“dml-error”bind-params =“val”&gt; INSERT INTO yourtable（somecol）VALUES（？）&lt;/ XSQL：DML&gt;</code></pre></div>
                  <!-- class="example" -->
               </div><a id="ADXDK19665"></a><a id="ADXDK19664"></a><div class="props_rev_3"><a id="GUID-12DFFF06-F092-4FFB-8EF1-AA3B3C0D6255" name="GUID-12DFFF06-F092-4FFB-8EF1-AA3B3C0D6255"></a><h4 id="ADXDK-GUID-12DFFF06-F092-4FFB-8EF1-AA3B3C0D6255" class="sect4">使用带有错误参数的条件逻辑</h4>
                  <div>
                     <p>描述了如何在XSQL页面模板中获取条件行为。</p>
                     <div class="section">
                        <p>通过将error参数与<a href="XSQL-pages-reference.html#GUID-7B3A4D36-BB66-4FB0-85F9-33BC84CE6613" title="描述了元素&lt;xsql：if-param&gt;。">&lt;xsql：if-param&gt;</a>结合使用，可以在XSQL页面模板中实现条件行为。例如，假设您的连接定义在XSQL配置文件中名为<code class="codeph">demo</code>的连接上将<code class="codeph">AUTOCOMMIT</code>标志设置为<code class="codeph">false</code> 。<a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-12DFFF06-F092-4FFB-8EF1-AA3B3C0D6255__BABJGFFA">例25-10中</a>显示的XSQL页面显示了如果后续操作遇到错误，您可以回滚上一个操作所做的更改。
                        </p>
                        <p>如果您编写了自定义操作处理程序，并且您的自定义操作调用<code class="codeph">reportMissingAttribute()</code> ， <code class="codeph">reportError()</code>或<code class="codeph">reportErrorIncludingStatement()</code>来报告非致命操作错误，那么它们也会自动获取此功能。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-12DFFF06-F092-4FFB-8EF1-AA3B3C0D6255__BABJGFFA">
                        <p class="titleinexample">示例25-10使用错误参数实现条件行为</p><pre class="pre codeblock"><code>&lt;！ - 注意：连接“demo”不能设置为autocommit！ - &gt; &lt;page connection =“demo”xmlns：xsql =“urn：oracle-xsql”&gt; &lt;xsql：dml error-param =“dml-error”bind-params =“val”&gt; INSERT INTO yourtable（somecol）VALUES （？）&lt;/ xsql：dml&gt; &lt;！ - 如果成功，第二个语句将提交 - &gt; &lt;xsql：dml commit =“yes”error-param =“dml-error”bind-params =“val2”&gt; INSERT INTO anothertable （另一个）VALUES（？）&lt;/ xsql：dml&gt; &lt;xsql：if-param name =“dml-error”exists =“yes”&gt; &lt;xsql：dml&gt; ROLLBACK &lt;/ xsql：dml&gt; &lt;/ xsql：if-param&gt; &lt;/ page&gt;</code></pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADXDK19667"></a><a id="ADXDK19666"></a><div class="props_rev_3"><a id="GUID-52292147-F1A3-4C5D-942A-41CBDAC5499D" name="GUID-52292147-F1A3-4C5D-942A-41CBDAC5499D"></a><h4 id="ADXDK-GUID-52292147-F1A3-4C5D-942A-41CBDAC5499D" class="sect4">格式化XSQL操作处理程序错误</h4>
                  <div>
                     <p>处理XSQL操作元素引发的错误以统一的方式报告为XML元素。这一事实使XSLT样式表能够检测它们的存在，并可选择格式化它们以进行表示。</p>
                     <div class="section">
                        <p></p>
                        <p>错误中的action元素在页面中被此元素替换：</p><pre class="oac_no_warn" dir="ltr">&lt;xsql-error action =“xxx”&gt;</pre><p>根据错误， <code class="codeph">&lt;xsql-error&gt;</code>元素包含：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p>嵌套的<code class="codeph">&lt;message&gt;</code>元素</p>
                           </li>
                           <li>
                              <p>带有违规SQL语句的<code class="codeph">&lt;statement&gt;</code>元素</p>
                           </li>
                        </ul>
                        <p><a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-52292147-F1A3-4C5D-942A-41CBDAC5499D__BABDCABJ">例25-11</a>显示了一个XSLT样式表，它使用此信息在屏幕上显示错误信息。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-52292147-F1A3-4C5D-942A-41CBDAC5499D__BABDCABJ">
                        <p class="titleinexample">例25-11 XSLT样式表</p><pre class="oac_no_warn" dir="ltr">&lt;xsl：if test =“// xsql-error”&gt; &lt;table style =“background：yellow”&gt; &lt;xsl：for-each select =“// xsql-error”&gt; &lt;tr&gt; &lt;td&gt; &lt;b&gt;动作&lt;/ b&gt; &lt;/ td&gt; &lt;td&gt; &lt;xsl：value-of select =“@ action”/&gt; &lt;/ td&gt; &lt;/ tr&gt; &lt;tr valign =“top”&gt; &lt;td&gt; &lt;b&gt;消息&lt;/ b&gt; &lt;/ td&gt; &lt;td&gt; &lt;xsl：value-of select =“message”/&gt; &lt;/ td&gt; &lt;/ tr&gt; &lt;/ xsl：for-each&gt; &lt;/ table&gt; &lt;/ xsl：if&gt;</pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
            </div><a id="ADXDK19669"></a><a id="ADXDK19670"></a><a id="ADXDK19671"></a><a id="ADXDK19672"></a><a id="ADXDK19673"></a><a id="ADXDK19668"></a><div class="props_rev_3"><a id="GUID-77A49187-C2FD-4799-A3C3-EB209BE75F8B" name="GUID-77A49187-C2FD-4799-A3C3-EB209BE75F8B"></a><h3 id="ADXDK-GUID-77A49187-C2FD-4799-A3C3-EB209BE75F8B" class="sect3">在XSQL页面中包含XMLType查询结果</h3>
               <div>
                  <p>Oracle数据库支持<code class="codeph">XMLType</code>用于存储和查询基于XML的数据库内容。
                  </p>
                  <div class="section">
                     <p>您可以使用以下技术之一利用数据库XML功能生成XML数据以包含在XSQL页面中：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="XSQL-pages-reference.html#GUID-A54C8FC8-D81E-466F-8DE9-E425387A6563" title="描述了元素&lt;xsql：query&gt;。">&lt;xsql：query&gt;</a>处理任何查询，包括<code class="codeph">XMLType</code>类型的列，但它将<code class="codeph">CLOB</code>和<code class="codeph">VARCHAR2</code>列中的XML标记作为文本文本处理。
                           </p>
                        </li>
                        <li>
                           <p><a href="XSQL-pages-reference.html#GUID-AE499EA9-A8C5-4274-98C6-8499ADF7ED55" title="描述了元素&lt;xsql：include-xml&gt;。">&lt;xsql：include-xml&gt;</a> parses并包含从查询中检索的单个<code class="codeph">CLOB</code>或基于字符串的XML文档。
                           </p>
                        </li>
                     </ul>
                     <p>前面的方法之间的一个区别是<code class="codeph">&lt;xsql:include-xml&gt;</code>根据需要解析出现在CLOB或字符串值中的文字XML，以将其转换为元素和属性树。相反， <code class="codeph">&lt;xsql:query&gt;</code>将<code class="codeph">CLOB</code>或字符串值列中的XML标记<code class="codeph">CLOB</code>为文本文本。
                     </p>
                     <p>另一个区别是，虽然<code class="codeph">&lt;xsql:query&gt;</code>可以处理任意数量的列和行的查询结果，但<code class="codeph">&lt;xsql:include-xml&gt;</code>可以处理单行的单个列。因此，在使用<code class="codeph">&lt;xsql:include-xml&gt;</code> ，其中的<code class="codeph">SELECT</code>语句将返回包含单个列的单个行。该列可以是包含格式良好的XML文档的<code class="codeph">CLOB</code>或<code class="codeph">VARCHAR2</code>值。XSQL引擎解析XML文档并将其包含在XSQL页面中。
                     </p>
                     <p><a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-77A49187-C2FD-4799-A3C3-EB209BE75F8B__BABCEICG">示例25-12</a>使用嵌套的<code class="codeph">XmlAgg()</code>函数来聚合包含部门和嵌套员工的动态构造的XML文档的结果。函数将文档聚合到包含在<code class="codeph">&lt;DepartmentList&gt;</code>元素中的单个“结果”文档中。
                     </p>
                     <p>在另一个示例中，假设您有许多<code class="codeph">&lt;Movie&gt;</code> XML文档存储在名为<code class="codeph">movies.</code>的<code class="codeph">XMLType</code>表中<code class="codeph">movies.</code> 每个文档可能类似于<a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-77A49187-C2FD-4799-A3C3-EB209BE75F8B__BABEGAFH">例25-13中</a>所示的<a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-77A49187-C2FD-4799-A3C3-EB209BE75F8B__BABEGAFH">文档</a> 。
                     </p>
                     <p>您可以使用内置的XPath查询功能从数据库中的任何影片中提取已获得奥斯卡奖项的所有演员的聚合列表。<a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-77A49187-C2FD-4799-A3C3-EB209BE75F8B__BABFHAFD">例25-14</a>显示了一个示例查询。
                     </p>
                     <p>要在XSQL页面中包含此<code class="codeph">XMLType</code>查询结果，请将查询粘贴到<code class="codeph">&lt;xsql:query&gt;</code>元素中。确保包含查询表达式的别名，如<a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-77A49187-C2FD-4799-A3C3-EB209BE75F8B__BABBHBFF">例25-15</a>所示。
                     </p>
                     <p>您可以使用<code class="codeph">XmlElement()</code>和<code class="codeph">XmlAgg()</code>的组合使数据库将查询标识的所有XML片段聚合到单个格式良好的XML文档中。这些函数可以产生如下结构良好的结果：</p><pre class="oac_no_warn" dir="ltr">&lt;AwardedActors&gt; &lt;Actor&gt; ... &lt;/ Actor&gt; &lt;女演员&gt; ...... &lt;/女演员&gt; &lt;/ AwardedActors&gt;</pre><p>如果将绑定变量连接到表达式中，则可以在XPath表达式的中间使用标准XSQL绑定变量功能。例如，要将值<code class="codeph">Oscar</code>参数化为名为<code class="codeph">award-from</code>的参数，可以使用如<a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-77A49187-C2FD-4799-A3C3-EB209BE75F8B__BABIEIIH">示例25-16中</a>所示的XSQL页面。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-77A49187-C2FD-4799-A3C3-EB209BE75F8B__BABCEICG">
                     <p class="titleinexample">示例25-12聚合动态构造的XML文档</p><pre class="oac_no_warn" dir="ltr">&lt;xsql：query connection =“hr”xmlns：xsql =“urn：oracle-xsql”&gt; SELECT XmlElement（“DepartmentList”，XmlAgg（XmlElement（“Department”，XmlAttributes（department_id AS“Id”），XmlForest（department_name AS“）名称“），（SELECT XmlElement（”Employees“，XmlAgg（XmlElement（”Employee“，XmlAttributes（employee_id AS”Id“），XmlForest（first_name ||''|| last_name AS”Name“，salary AS”Salary“， job_id AS“Job”））））FROM employees e WHERE e.department_id = d.department_id））））AS结果来自部门d ORDER BY department_name &lt;/ xsql：query&gt;</pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-77A49187-C2FD-4799-A3C3-EB209BE75F8B__BABEGAFH">
                     <p class="titleinexample">例25-13电影XML文档</p><pre class="oac_no_warn" dir="ltr">&lt;电影标题=“才华横溢的Mr.Ripley”RunningTime =“139”评级=“R”&gt; &lt;导演&gt; &lt;第一&gt;安东尼&lt;/ First&gt; &lt;Last&gt; Minghella &lt;/ Last&gt; &lt;/ Director&gt; &lt;演员&gt; &lt;演员Role =“Tom Ripley”&gt; &lt;First&gt; Matt &lt;/ First&gt; &lt;Last&gt; Damon &lt;/ Last&gt; &lt;/ Actor&gt; &lt;女演员角色=“Marge Sherwood”&gt; &lt;First&gt; Gwyneth &lt;/ First&gt; &lt;Last&gt; Paltrow &lt;/最后&gt; &lt;/女演员&gt; &lt;演员角色=“Dickie Greenleaf”&gt; &lt;First&gt; Jude &lt;/ First&gt; &lt;Last&gt; Law &lt;/ Last&gt; &lt;Award From =“BAFTA”Category =“Best Supporting Actor”/&gt; &lt;/ Actor &gt; &lt;/ Cast&gt; &lt;/ Movie&gt;</pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-77A49187-C2FD-4799-A3C3-EB209BE75F8B__BABFHAFD">
                     <p class="titleinexample">示例25-14使用XPath提取聚合列表</p><pre class="oac_no_warn" dir="ltr">SELECT XMLELEMENT（“AwardedActors”，XMLAGG（EXTRACT（VALUE（m），'/ Movie / Cast / * [Award [@ From =“Oscar”]]'）））FROM movies m</pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-77A49187-C2FD-4799-A3C3-EB209BE75F8B__BABBHBFF">
                     <p class="titleinexample">示例25-15包括XMLType查询结果</p><pre class="oac_no_warn" dir="ltr">&lt;xsql：query connection =“demo”xmlns：xsql =“urn：oracle-xsql”&gt; SELECT XMLELEMENT（“AwardedActors”，XMLAGG（EXTRACT（VALUE（m），'/ Movie / Cast / * [Award [@ From = = “奥斯卡”]]'）））AS结果来自电影m &lt;/ xsql：query&gt;</pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-77A49187-C2FD-4799-A3C3-EB209BE75F8B__BABIEIIH">
                     <p class="titleinexample">示例25-16在XPath表达式中使用XSQL绑定变量</p><pre class="oac_no_warn" dir="ltr">&lt;xsql：query connection =“orcl92”xmlns：xsql =“urn：oracle-xsql”award-from =“Oscar”bind-params =“award-from”&gt; / *在XPath表达式中使用绑定变量* / SELECT XMLELEMENT（“AwardedActors”，XMLAGG（EXTRACT（VALUE（m），'/ Movie / Cast / * [Award [@From =“'||？||'“]]'）））AS结果来自电影m &lt;/ xsql：query&gt;</pre></div>
                  <!-- class="example" -->
               </div>
            </div><a id="ADXDK19674"></a><div class="props_rev_3"><a id="GUID-4DCCB6F2-01D9-442A-BE70-D8EC70884D67" name="GUID-4DCCB6F2-01D9-442A-BE70-D8EC70884D67"></a><h3 id="ADXDK-GUID-4DCCB6F2-01D9-442A-BE70-D8EC70884D67" class="sect3">处理发布的XML内容</h3>
               <div>
                  <p>除了简化XML内容的组装和转换之外，XSQL页面框架还可以帮助您处理发布的XML内容。</p>
                  <div class="section">
                     <p>内置操作提供以下优势：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type:disc">
                        <li>
                           <p>简化XML文档和HTML表单中发布数据的处理</p>
                        </li>
                        <li>
                           <p>使用XSU将数据直接发布到数据库表中</p>
                        </li>
                     </ul>
                     <p>XSU可以基于规范形式的XML文档内容为目标表或视图执行数据库插入，更新和删除。对于指定的表，其数据的规范XML形式由<code class="codeph">SELECT *</code>查询的一行XML输出给出。当以这种形式给出XML文档时，XSU可以自动执行DML操作。
                     </p>
                     <p>通过将XSU与XSLT相结合，您可以将任何格式的XML转换为给定表所期望的规范格式。然后，XSU可以对生成的规范XML执行DML。</p>
                     <p>以下内置的XSQL操作使您可以在XSQL页面中利用此功能：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="XSQL-pages-reference.html#GUID-A45E6112-F904-4665-959B-1AF39413E2F7" title="描述了元素&lt;xsql：insert-request&gt;。">&lt;XSQL：插入请求&gt;</a></p>
                           <p>将在请求中发布的可选转换的XML文档插入表中。</p>
                        </li>
                        <li>
                           <p><a href="XSQL-pages-reference.html#GUID-5514ECD7-5E7E-49D9-B52B-C8374404EC5B" title="描述了元素&lt;xsql：update-request&gt;。">&lt;XSQL：更新请求&gt;</a></p>
                           <p>将在请求中发布的可选转换的XML文档更新到表或视图中。</p>
                        </li>
                        <li>
                           <p><a href="XSQL-pages-reference.html#GUID-87E28D28-C22E-4468-BA26-3EE5801C14B4" title="描述了元素&lt;xsql：delete-request&gt;。">&lt;XSQL：删除请求&gt;</a></p>
                           <p>从表或视图中删除在请求中发布的可选转换的XML文档。</p>
                        </li>
                        <li>
                           <p><a href="XSQL-pages-reference.html#GUID-E21DCCD0-AE99-47FA-A5D5-DD064D6E74CB" title="描述了元素&lt;xsql：insert-param&gt;。">&lt;XSQL：嵌件PARAM&gt;</a></p>
                           <p>将作为请求参数的值发布的可选转换的XML文档插入表或视图中。</p>
                        </li>
                     </ul>
                     <p>如果使用插入来定位数据库视图，则可以在视图上创建<code class="codeph">INSTEAD OF INSERT</code>触发器，以进一步自动处理发布的信息。例如，视图上的<code class="codeph">INSTEAD OF INSERT</code>触发器可以使用PL / SQL检查是否存在记录，并根据此检查的结果智能地选择是执行<code class="codeph">INSERT</code>还是<code class="codeph">UPDATE</code> 。
                     </p>
                  </div>
                  <!-- class="section" -->
               </div><a id="ADXDK19676"></a><a id="ADXDK19675"></a><div class="props_rev_3"><a id="GUID-56E150D2-3FE9-4ED4-A39B-9374B5CC4351" name="GUID-56E150D2-3FE9-4ED4-A39B-9374B5CC4351"></a><h4 id="ADXDK-GUID-56E150D2-3FE9-4ED4-A39B-9374B5CC4351" class="sect4">了解XML发布选项</h4>
                  <div>
                     <p>提供XML发布选项的概述。</p>
                     <p>XSQL页面框架可以处理这些场景中的发布数据：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>客户端程序发送针对XSQL页面的HTTP <code class="codeph">POST</code>消息。请求正文包含XML文档; HTTP标头报告<code class="codeph">ContentType</code>为“ <code class="codeph">text/xml</code> ”。
                           </p>
                           <p>在这种情况下， <code class="codeph">&lt;xsql:insert-request&gt;</code> ， <code class="codeph">&lt;xsql:update-request&gt;</code>或<code class="codeph">&lt;xsql:delete-request&gt;</code>可以插入，更新或删除目标表中已发布XML的内容。如果使用XSLT转换发布的XML，则发布的文档是转换的源。
                           </p>
                        </li>
                        <li>
                           <p>客户端程序发送XSQL页面的HTTP <code class="codeph">GET</code>请求，其中一个参数包含XML文档。
                           </p>
                           <p>在这种情况下，您可以使用<code class="codeph">&lt;xsql:insert-param&gt;</code>操作将已发布的XML参数值的内容插入目标表中。如果使用XSLT转换发布的XML文档，则参数值中的XML文档是此转换的源文档。
                           </p>
                        </li>
                        <li>
                           <p>浏览器使用<code class="codeph">method</code> = <code class="codeph">"POST"</code>提交HTML表单，其操作以XSQL页面为目标。HTTP <code class="codeph">POST</code>消息的请求主体包含表单字段和值的编码版本，其<code class="codeph">ContentType</code>为“ <code class="codeph">application/x-www-form-urlencoded</code> ”。
                           </p>
                           <p>在这种情况下，请求不包含XML文档，而是包含表单参数的编码版本。但是，为了使所有这三种情况统一，XSQL页面处理器根据请求中包含的表单参数，会话变量和cookie按需实现XML文档。 XSLT处理器使用<code class="codeph">&lt;xsql:insert&gt;</code> ， <code class="codeph">&lt;xsql:update-request&gt;</code>或<code class="codeph">&lt;xsql:delete-request&gt;</code>将此动态实现的XML文档转换为DML的规范形式。
                           </p>
                        </li>
                     </ul>
                     <p>使用已发布的HTML表单时，动态实现的XML文档的格式如<a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-56E150D2-3FE9-4ED4-A39B-9374B5CC4351__BABBACHJ">例25-17</a>所示。
                     </p>
                     <p>如果使用相同名称发布多个参数，则XSQL处理器会自动创建多个<code class="codeph">&lt;row&gt;</code>元素，以便于后续处理。假设请求发布或包含以下参数和值：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">id</code> = <code class="codeph">101</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">name</code> = <code class="codeph">Steve</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">id</code> = <code class="codeph">102</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">name</code> = <code class="codeph">Sita</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">operation</code> = <code class="codeph">update</code></p>
                        </li>
                     </ul>
                     <p>XSQL页面处理器创建一组参数，如下所示：</p><pre class="oac_no_warn" dir="ltr">&lt;request&gt; &lt;parameters&gt; &lt;row&gt; &lt;id&gt; 101 &lt;/ id&gt; &lt;name&gt; Steve &lt;/ name&gt; &lt;/ row&gt; &lt;row&gt; &lt;id&gt; 102 &lt;/ id&gt; &lt;name&gt; Sita &lt;/ name&gt; &lt;/ row&gt; &lt;operation&gt; update &lt;/ operation&gt; &lt;/ parameters&gt; ...&lt;/请求&gt;</pre><p>您必须提供一个XSLT样式表，将包含请求参数的实体化XML文档转换为目标表的规范格式。因此，您可以构建一个XSQL页面：</p><pre class="oac_no_warn" dir="ltr">&lt;！ -  | ShowRequestDocument.xsql |显示HTML表单的实体化XML文档+  - &gt; &lt;xsql：include-request-params xmlns：xsql =“urn：oracle-xsql”/&gt;</pre><p>有了这个页面，您可以临时修改HTML表单以发布到<code class="codeph">ShowRequestDocument.xsql</code>页面。在浏览器中，您可以看到物化XML请求文档的“原始”XML，您可以将其保存并用于开发XSL转换。
                     </p>
                     <div class="example" id="GUID-56E150D2-3FE9-4ED4-A39B-9374B5CC4351__BABBACHJ">
                        <p class="titleinexample">示例25-17从HTML表单生成的XML文档</p><pre class="oac_no_warn" dir="ltr">&lt;request&gt; &lt;parameters&gt; &lt;firstparamname&gt; firstparamvalue &lt;/ firstparamname&gt; ...&lt;lastparamname&gt; lastparamvalue &lt;/ lastparamname&gt; &lt;/ parameters&gt; &lt;session&gt; &lt;firstparamname&gt; firstsessionparamvalue &lt;/ firstparamname&gt; ...&lt;lastparamname&gt; lastsessionparamvalue &lt;/ lastparamname&gt; &lt;/ session&gt; &lt;cookies&gt; &lt;firstcookie&gt; firstcookievalue &lt;/ firstcookiename&gt; ...&lt;lastcookie&gt; firstcookievalue &lt;/ lastcookiename&gt; &lt;/ cookies&gt; &lt;/ request&gt;</pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
            </div><a id="ADXDK19678"></a><a id="ADXDK19677"></a><div class="props_rev_3"><a id="GUID-AD1462CE-B917-48FF-B33A-37F0CA95AB17" name="GUID-AD1462CE-B917-48FF-B33A-37F0CA95AB17"></a><h3 id="ADXDK-GUID-AD1462CE-B917-48FF-B33A-37F0CA95AB17" class="sect3">使用FOP Serializer生成PDF输出</h3>
               <div>
                  <p>使用XSQL页面框架支持自定义序列化程序， <code class="codeph">oracle.xml.xsql.serializers.XSQLFOPSerializer</code>类提供与Apache格式化对象处理器（FOP）的集成。FOP处理器从包含XSL格式化对象的XML文档中呈现PDF文档。
                  </p>
                  <div class="section">
                     <p>如<a href="using-XSQL-pages-publishing-framework.html#GUID-2F3D4C05-7E99-4E7D-994B-09A15331D01B__CHECIJCH" title="此表列出了演示子目录并解释了包含的演示。演示名称和描述是列。">表24-1</a>中所述，演示目录包括<code class="codeph">emptablefo.xsl</code>样式表和<code class="codeph">emptable.xsql</code>页面作为插图。如果在尝试使用FOP序列化程序时出错，那么可能是<code class="codeph">CLASSPATH</code>没有所有必需的JAR文件。 <code class="codeph">XSQLFOPSerializer</code>类驻留在单独的<code class="codeph">xml.jar</code>文件中，该文件必须包含在<code class="codeph">CLASSPATH</code>才能使用FOP集成。您还必须将这些额外的Java归档添加到<code class="codeph">CLASSPATH</code> ：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">fop.jar</code> - 来自Apache，版本0.20.3或更高版本</p>
                        </li>
                        <li>
                           <p><code class="codeph">batik.jar</code>来自FOP发行版</p>
                        </li>
                        <li>
                           <p><code class="codeph">avalon-framework-4.0.jar</code> -from FOP发行版</p>
                        </li>
                        <li>
                           <p>l <code class="codeph">ogkit-1.0.jar</code> -from FOP发行版</p>
                        </li>
                     </ul>
                     <p>如果您想自定义实现，本<a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-AD1462CE-B917-48FF-B33A-37F0CA95AB17__BABJCBHC">例中</a>提供的FOP序列化程序的源代码如<a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-AD1462CE-B917-48FF-B33A-37F0CA95AB17__BABJCBHC">例25-18</a>所示。
                     </p>
                     <div class="infoboxnotealso" id="GUID-AD1462CE-B917-48FF-B33A-37F0CA95AB17__GUID-0563D88A-BF5B-442A-99A6-11A62938C015">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adxdk&amp;id=apache_org_fop" target="_blank"><span class="italic">Apache FOP</span></a></p>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-AD1462CE-B917-48FF-B33A-37F0CA95AB17__BABJCBHC">
                     <p class="titleinexample">例25-18 FOP Serializer的源代码</p><pre class="oac_no_warn" dir="ltr">package oracle.xml.xsql.serializers; import org.w3c.dom。文献; import org.apache.log。记录仪; import org.apache.log。层次结构; import org.apache.fop.messaging。的MessageHandler; import org.apache.log。LOGTARGET; import oracle.xml.xsql。XSQLPageRequest; import oracle.xml.xsql。XSQLDocumentSerializer; import org.apache.fop.apps。驱动程序; import org.apache.log.output。NullOutputLogTarget; / ** *从2002年1月19日发布的FOP 0.20.3RC版本进行测试* / public class XSQLFOPSerializer实现XSQLDocumentSerializer {private static final String PDFMIME =“application / pdf”; public void serialize（Document doc，XSQLPageRequest env）throws Throwable {try {//首先确保我们可以加载驱动程序FOPDriver = new Driver（）; //默认情况下告诉FOP不要吐出任何消息。//您可以修改此代码以创建您自己的FOP Serializer //使用Apache LogKit API Logger logger = Hierarchy.getDefaultHierarchy（）。getLoggerFor（“XSQLServlet”）;将输出记录到许多不同的记录器目标之一// logger.setLogTargets（new LogTarget [] {new NullOutputLogTarget（）}）; FOPDriver.setLogger（记录器）; // FOP的一些消息似乎仍然使用MessageHandler。MessageHandler.setOutputMethod（的MessageHandler。没有）; //然后在获取阅读器env.setContentType（PDFMIME）之前设置内容类型; FOPDriver.setOutputStream（env.getOutputStream（））; FOPDriver.setRenderer（FOPDriver。RENDER_PDF）; FOPDriver.render（DOC）; } catch（例外e）{//无论如何都无法为错误编写PDF输出。//所以也许这个堆栈跟踪将是有用的信息e.printStackTrace（System.err）; }}}</pre></div>
                  <!-- class="example" -->
               </div>
            </div><a id="ADXDK1029"></a><a id="ADXDK19679"></a><div class="props_rev_3"><a id="GUID-D39E450F-9C2C-4240-A5E3-C5FCC4D57A42" name="GUID-D39E450F-9C2C-4240-A5E3-C5FCC4D57A42"></a><h3 id="ADXDK-GUID-D39E450F-9C2C-4240-A5E3-C5FCC4D57A42" class="sect3">执行XSQL自定义</h3>
               <div>
                  <p>提供了XSQL自定义主题。</p>
                  <div class="section"> </div>
                  <!-- class="section" -->
               </div><a id="ADXDK19680"></a><div class="props_rev_3"><a id="GUID-26A83890-40B5-4D18-86A7-E72CCD97D2AC" name="GUID-26A83890-40B5-4D18-86A7-E72CCD97D2AC"></a><h4 id="ADXDK-GUID-26A83890-40B5-4D18-86A7-E72CCD97D2AC" class="sect4">编写自定义XSQL操作处理程序</h4>
                  <div>
                     <p>XSQL页面引擎通过查找<code class="codeph">xsql</code>命名空间中的操作元素并调用适当的操作元素处理程序类来处理每个操作来处理XSQL页面。处理器支持实现<code class="codeph">XSQLActionHandler</code>接口的任何操作。所有内置操作都实现此接口。
                     </p>
                     <div class="section">
                        <p>当任务需要自定义处理时， <a href="XSQL-pages-reference.html#GUID-A87F53F2-87BB-4422-90EF-4032D97C54BE__BJEFBDGB" title="此表列出了XSQL配置文件设置。配置设置名称和描述是列。">表33-2</a>中列出的所有内置操作都不能完全满足您的需要，您可以编写自己的操作。
                        </p>
                        <p></p>
                        <p>XSQL引擎以下列方式处理页面中的操作。对于页面中的每个操作，引擎都会执行以下步骤：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li><span>使用默认构造函数构造操作处理程序类的实例</span></li>
                        <li><span>通过调用<code class="codeph">init(Element actionElt,XSQLPageRequest context</code> ）方法，使用action元素对象和页面处理器上下文初始化处理程序实例</span></li>
                        <li><span>调用允许处理程序处理动作<code class="codeph">handleAction</code> （ <code class="codeph">Node</code>结果）</span></li>
                     </ol>
                     <div class="section">
                        <p>对于内置操作，引擎可以将XSQL操作元素名称映射到实现操作处理程序的Java类。<a href="XSQL-pages-reference.html#GUID-A87F53F2-87BB-4422-90EF-4032D97C54BE__BJEFBDGB" title="此表列出了XSQL配置文件设置。配置设置名称和描述是列。">表33-2</a>列出了内置操作及其相应的类。
                        </p>
                        <p>对于用户定义的操作，请使用此内置操作，替换<code class="codeph">fully.qualified.带有您的类名称的Classname</code> ：</p><pre class="pre codeblock"><code>&lt;xsql：action handler =“fully.qualified。分类名称“... /&gt;</code></pre><p><code class="codeph">handler</code>属性提供实现自定义操作处理程序的Java类的完全限定名称。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div><a id="ADXDK19682"></a><a id="ADXDK19683"></a><a id="ADXDK19684"></a><a id="ADXDK19681"></a><div class="props_rev_3"><a id="GUID-DFBE1960-184A-4C15-9F8D-2FC08633EF4F" name="GUID-DFBE1960-184A-4C15-9F8D-2FC08633EF4F"></a><h5 id="ADXDK-GUID-DFBE1960-184A-4C15-9F8D-2FC08633EF4F" class="sect5">实现XSQLActionHandler接口</h5>
                     <div>
                        <p>要创建自定义操作处理程序，请提供实现的类要创建自定义操作处理程序，请提供实现<code class="codeph">oracle.xml.xsql.的类<code class="codeph">oracle.xml.xsql.XSQLActionHandler</code>接口XSQLActionHandler</code> <code class="codeph">oracle.xml.xsql.XSQLActionHandler</code> 。大多数自定义操作处理程序都扩展了<code class="codeph">oracle.xml.xsql.XSQLActionHandlerImpl</code> ，它提供<code class="codeph">init()</code>方法的默认实现，并提供有用的辅助方法。
                        </p>
                        <div class="section">
                           <p>当XSQL页面处理器调用动作处理程序的<code class="codeph">handleAction()</code>方法时，DOM片段将传递给动作实现。操作处理程序将返回到页面的任何动态创建的XML内容附加到根节点。
                           </p>
                           <p>XSQL处理器在概念上用这个文档片段的内容替换XSQL页面中的action元素。如果没有要添加到页面的XML内容，则动作处理程序不向该片段添加任何内容是合法的。</p>
                           <p>在编写自定义操作处理程序时， <code class="codeph">XSQLActionHandlerImpl</code>类的某些方法很有帮助。<a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-DFBE1960-184A-4C15-9F8D-2FC08633EF4F__G1043068" title="此表有助于XSQLActionHandlerImpl类中的方法。方法名称和描述是列。">表25-2</a>列出了这些方法。
                           </p>
                           <div class="tblformalwide" id="GUID-DFBE1960-184A-4C15-9F8D-2FC08633EF4F__G1043068">
                              <p class="titleintable">表25-2 XSQLActionHandlerImpl类中的有用方法</p>
                              <table cellpadding="4" cellspacing="0" class="FormalWide" title="XSQLActionHandlerImpl类中的有用方法" width="100%" border="1" summary="This table helpful methods in the XSQLActionHandlerImpl class. Method Name and Description are the columns." frame="hsides" rules="rows">
                                 <thead>
                                    <tr align="left" valign="top">
                                       <th align="left" valign="bottom" width="31%" id="d104050e3246">方法名称</th>
                                       <th align="left" valign="bottom" width="69%" id="d104050e3249">描述</th>
                                    </tr>
                                 </thead>
                                 <tbody>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="31%" id="d104050e3254" headers="d104050e3246 "><pre class="oac_no_warn" dir="ltr">getActionElement</pre></td>
                                       <td align="left" valign="top" width="69%" headers="d104050e3254 d104050e3249 ">
                                          <p>返回正在处理的当前操作元素。</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="31%" id="d104050e3261" headers="d104050e3246 "><pre class="oac_no_warn" dir="ltr">getActionElementContent</pre></td>
                                       <td align="left" valign="top" width="69%" headers="d104050e3261 d104050e3249 ">
                                          <p>返回当前操作元素的文本内容，并适当替换所有词法参数。</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="31%" id="d104050e3268" headers="d104050e3246 "><pre class="oac_no_warn" dir="ltr">getPageRequest</pre></td>
                                       <td align="left" valign="top" width="69%" headers="d104050e3268 d104050e3249 ">
                                          <p>返回当前XSQL页面处理器上下文。使用此对象，您可以这样做：</p>
                                          <ul style="list-style-type:disc">
                                             <li>
                                                <p><code class="codeph">setPageParam（）</code></p>
                                                <p>设置页面参数值。</p>
                                             </li>
                                             <li>
                                                <p><code class="codeph">getPostedDocument（）/ setPostedDocument（）</code></p>
                                                <p>获取或设置发布的XML文档。</p>
                                             </li>
                                             <li>
                                                <p><code class="codeph">translateURL（）</code></p>
                                                <p>将相对URL转换为绝对URL。</p>
                                             </li>
                                             <li>
                                                <p><code class="codeph">getRequestObject（）/ setRequestObject（）</code></p>
                                                <p>在页面请求上下文中获取或设置对象，这些对象可以在单个页面中的操作之间共享。</p>
                                             </li>
                                             <li>
                                                <p><code class="codeph">getJDBCConnection（）</code></p>
                                                <p>获取此页面正在使用的JDBC连接（如果未使用连接，则可能为null）。</p>
                                             </li>
                                             <li>
                                                <p><code class="codeph">getRequestType（）</code></p>
                                                <p>检测您是在Servlet，命令行还是程序化上下文中运行。例如，如果请求类型是Servlet，那么您可以将<code class="codeph">XSQLPageRequest</code>对象<code class="codeph">XSQLPageRequest</code>转换为更具体的<code class="codeph">XSQLServletPageRequest</code>以访问特定于servlet的方法，例如<code class="codeph">getHttpServletRequest</code> ， <code class="codeph">getHttpServletResponse</code>和<code class="codeph">getServletContext</code> 。
                                                </p>
                                                <p></p>
                                             </li>
                                          </ul>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="31%" id="d104050e3328" headers="d104050e3246 "><pre class="oac_no_warn" dir="ltr">getAttributeAllowingParam</pre></td>
                                       <td align="left" valign="top" width="69%" headers="d104050e3328 d104050e3249 ">
                                          <p>从元素中检索属性值，解析可能出现在属性值中的任何XSQL词法参数引用。通常，此方法应用于action元素本身，但它对于访问子元素的属性也很有用。要在不允许词法参数的情况下访问属性值，请在DOM <code class="codeph">Element</code>接口上使用标准的<code class="codeph">getAttribute()</code>方法。
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="31%" id="d104050e3341" headers="d104050e3246 "><pre class="oac_no_warn" dir="ltr">appendSecondaryDocument</pre></td>
                                       <td align="left" valign="top" width="69%" headers="d104050e3341 d104050e3249 ">
                                          <p>将外部XML文档的内容追加到操作处理程序结果内容的根目录。</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="31%" id="d104050e3348" headers="d104050e3246 "><pre class="oac_no_warn" dir="ltr">addResultElement</pre></td>
                                       <td align="left" valign="top" width="69%" headers="d104050e3348 d104050e3249 ">
                                          <p>简化将带有文本内容的单个元素附加到操作处理程序结果内容的根目录。</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="31%" id="d104050e3355" headers="d104050e3246 "><pre class="oac_no_warn" dir="ltr">firstColumnOfFirstRow</pre></td>
                                       <td align="left" valign="top" width="69%" headers="d104050e3355 d104050e3249 ">
                                          <p>返回SQL语句第一行的第一列值。要求当前页面在其文档元素上具有连接属性，否则将返回错误。</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="31%" id="d104050e3362" headers="d104050e3246 "><pre class="oac_no_warn" dir="ltr">getBindVariableCount</pre></td>
                                       <td align="left" valign="top" width="69%" headers="d104050e3362 d104050e3249 ">
                                          <p>返回以空格分隔的<code class="codeph">bind-params</code>列表中的标记数。此数字表示预期绑定参数的数量。
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="31%" id="d104050e3372" headers="d104050e3246 "><pre class="oac_no_warn" dir="ltr">handleBindVariables</pre></td>
                                       <td align="left" valign="top" width="69%" headers="d104050e3372 d104050e3249 ">
                                          <p>使用当前操作元素的<code class="codeph">bind-params</code>属性中指定的参数值管理<code class="codeph">bind-params</code>准备语句中出现的JDBC绑定变量的<code class="codeph">bind-params</code> 。如果在调用此方法之前语句已在使用多个绑定变量，则还可以传递正在使用的现有绑定变量槽的数量。
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="31%" id="d104050e3382" headers="d104050e3246 "><pre class="oac_no_warn" dir="ltr">reportErrorIncludingStatement</pre></td>
                                       <td align="left" valign="top" width="69%" headers="d104050e3382 d104050e3249 ">
                                          <p>报告错误。该错误包括导致该问题的违规（SQL）语句，并且可选地包括数字错误代码。</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="31%" id="d104050e3389" headers="d104050e3246 "><pre class="oac_no_warn" dir="ltr">reportFatalError</pre></td>
                                       <td align="left" valign="top" width="69%" headers="d104050e3389 d104050e3249 ">
                                          <p>报告致命错误。</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="31%" id="d104050e3397" headers="d104050e3246 "><pre class="oac_no_warn" dir="ltr">reportMissingAttribute</pre></td>
                                       <td align="left" valign="top" width="69%" headers="d104050e3397 d104050e3249 ">
                                          <p>使用<code class="codeph">&lt;xsql-error&gt;</code>元素报告缺少必需的操作处理程序属性<code class="codeph">&lt;xsql-error&gt;</code> 。
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="31%" id="d104050e3407" headers="d104050e3246 "><pre class="oac_no_warn" dir="ltr">reportStatus</pre></td>
                                       <td align="left" valign="top" width="69%" headers="d104050e3407 d104050e3249 ">
                                          <p>使用<code class="codeph">&lt;xsql-status&gt;</code>元素报告操作处理程序状态。
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="31%" id="d104050e3417" headers="d104050e3246 "><pre class="oac_no_warn" dir="ltr">requiredConnectionProvided</pre></td>
                                       <td align="left" valign="top" width="69%" headers="d104050e3417 d104050e3249 ">
                                          <p>检查连接是否可用于此请求，如果没有可用连接，则将错误报告输出到页面中。</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="31%" id="d104050e3424" headers="d104050e3246 "><pre class="oac_no_warn" dir="ltr">variableValue</pre></td>
                                       <td align="left" valign="top" width="69%" headers="d104050e3424 d104050e3249 ">
                                          <p>返回词法参数的值，同时考虑可能确定其默认值的所有作用域规则。</p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <!-- class="inftblhruleinformal" -->
                           <p><a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-DFBE1960-184A-4C15-9F8D-2FC08633EF4F__BABDHCCI">例25-19</a>显示了一个名为<code class="codeph">MyIncludeXSQLHandler</code>的自定义操作处理程序，它利用了内置的操作处理程序。它使用任意Java代码修改此处理程序返回的XML片段，然后将其结果附加到XSQL页面。
                           </p>
                           <p>您可能必须根据是通过XSQL servlet，XSQL命令行实用程序还是通过<code class="codeph">XSQLRequest</code>类以编程方式请求页面来编写自定义操作处理程序。您可以在动作处理程序实现中调用<code class="codeph">getPageRequest()</code>以获取对当前页面请求的<code class="codeph">XSQLPageRequest</code>接口的引用。通过在<code class="codeph">XSQLPageRequest</code>对象上调用<code class="codeph">getRequestType()</code> ，可以确定请求是来自Servlet，命令行还是编程路由。如果返回值是<code class="codeph">Servlet</code> ，则可以访问HTTP servlet请求，响应和servlet上下文对象，如<a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-DFBE1960-184A-4C15-9F8D-2FC08633EF4F__BABDDIGI">例25-20</a>所示。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-DFBE1960-184A-4C15-9F8D-2FC08633EF4F__BABDHCCI">
                           <p class="titleinexample">例25-19 MyIncludeXSQLHandler.java</p><pre class="oac_no_warn" dir="ltr">import oracle.xml.xsql。*; import oracle.xml.xsql.actions。XSQLIncludeXSQLHandler; import org.w3c.dom。*; import java.sql。的SQLException;公共类MyIncludeXSQLHandler扩展XSQLActionHandlerImpl {XSQLActionHandler nestedHandler = null; public void init（XSQLPageRequest req，Element action）{super.init（req，action）; //通过//传递当前请求/操作，创建XSQLIncludeXSQLHandler和init（）处理程序的实例。这假定XSQLIncludeXSQLHandler //将从当前操作元素中获取其href =“xxx.xsql”属性。nestedHandler = new XSQLIncludeXSQLHandler（）; nestedHandler.init（REQ，动作）; public void handleAction（Node result）抛出SQLException {DocumentFragment df = result.getOwnerDocument（）。createDocumentFragment（）; nestedHandler.handleAction（DF）; //在将最终修改后的文档附加到结果节点之前，此处的自定义Java代码可以处理返回的文档片段。//例如，向第一个子项添加属性。元素e =（元素）df.getFirstChild（）;如果（e！= null）{e.setAttribute（“ExtraAttribute”，“SomeValue”）; } result.appendChild（df）; }}</pre></div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-DFBE1960-184A-4C15-9F8D-2FC08633EF4F__BABDDIGI">
                           <p class="titleinexample">示例25-20测试Servlet请求</p><pre class="oac_no_warn" dir="ltr">XSQLServletPageRequest xspr =（XSQLServletPageRequest）getPageRequest（）; if（xspr.getRequestType（）。equals（“Servlet”））{HttpServletRequest req = xspr.getHttpServletRequest（）; HttpServletResponse resp = xspr.getHttpServletResponse（）; ServletContext cont = xspr.getServletContext（）; //在这里用req，resp或cont做一些事情。请注意，直接从处理程序写入响应//会产生意外结果。所有servlet或你的//自定义序列化程序在处理完所有动作元素后立即写入servlet响应输出流。}</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="ADXDK19685"></a><div class="props_rev_3"><a id="GUID-84654614-3CE1-4A4F-891E-94B145257B56" name="GUID-84654614-3CE1-4A4F-891E-94B145257B56"></a><h5 id="ADXDK-GUID-84654614-3CE1-4A4F-891E-94B145257B56" class="sect5">在自定义XSQL操作中使用多值参数</h5>
                     <div>
                        <p><code class="codeph">XSQLActionHandlerImpl</code>是自定义XSQL操作的基类。
                        </p>
                        <div class="section">
                           <p>它支持：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>以数组命名的词法参数替换</p>
                              </li>
                              <li>
                                 <p>数组命名的绑定变量</p>
                              </li>
                              <li>
                                 <p>简单值参数</p>
                              </li>
                           </ul>
                           <p>如果您的自定义操作使用此基类中的<code class="codeph">getAttributeAllowingParam()</code> ， <code class="codeph">getActionElementContent()</code>或<code class="codeph">handleBindVariables()</code>方法，则可以在自定义操作中免费获取多值参数功能。
                           </p>
                           <p>使用<code class="codeph">XSQLPageRequest</code>接口上的<code class="codeph">getParameterValues()</code>方法显式获取参数值作为<code class="codeph">String[]</code> 。<code class="codeph">XSQLActionHandlerImpl</code>的辅助方法<code class="codeph">variableValues()</code>使您可以在自定义操作处理程序中使用此功能（如果必须以编程方式执行此操作）。
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div><a id="ADXDK19687"></a><a id="ADXDK19686"></a><div class="props_rev_3"><a id="GUID-9A5E5942-FA04-4C9D-BF46-3FBA294C5E33" name="GUID-9A5E5942-FA04-4C9D-BF46-3FBA294C5E33"></a><h4 id="ADXDK-GUID-9A5E5942-FA04-4C9D-BF46-3FBA294C5E33" class="sect4">实现自定义XSQL序列化程序</h4>
                  <div>
                     <p>您可以实现用户定义的序列化程序类来控制最终XSQL数据页面如何序列化为文本或二进制流。用户定义的序列化程序必须实现接口<code class="codeph">oracle.xml.xsql.XSQLDocumentSerializer</code> 。
                     </p>
                     <div class="section">
                        <p>接口<code class="codeph">oracle.xml.xsql.XSQLDocumentSerializer</code>包含以下单个方法：</p><pre class="pre codeblock"><code>void serialize（org.w3c.dom。文档doc，XSQLPageRequest env）抛出Throwable;</code></pre><p>仅支持基于DOM的序列化程序。自定义序列化程序类应执行以下步骤：</p>
                        <ol>
                           <li>
                              <p>在将任何内容写入输出<code class="codeph">PrintWriter</code> （或<code class="codeph">OutputStream</code> ）之前设置序列化流的内容类型。
                              </p>
                              <p>通过在传递给序列化程序的<code class="codeph">XSQLPageRequest</code>上调用<code class="codeph">setContentType()</code>来设置类型。设置内容类型时，您可以设置MIME类型：</p><pre class="oac_no_warn" dir="ltr">env.setContentType（ “text / html的”）;</pre><p>或者，您可以使用显式输出编码字符集设置MIME类型：</p><pre class="oac_no_warn" dir="ltr">env.setContentType（ “text / html的;字符集= SHIFT_JIS”）;</pre></li>
                           <li>
                              <p>在<code class="codeph">XSQLPageRequest</code>上调用<code class="codeph">getWriter()</code>或<code class="codeph">getOutputStream()</code> （但不是两者）以获取用于序列化内容的相应<code class="codeph">PrintWriter</code>或<code class="codeph">OutputStream</code> 。
                              </p>
                           </li>
                        </ol>
                        <p><a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-9A5E5942-FA04-4C9D-BF46-3FBA294C5E33__BABDGGCJ">例25-21</a>中的自定义序列化程序显示了一个简单的实现，它序列化包含当前XSQL数据页的文档元素名称的HTML文档。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-9A5E5942-FA04-4C9D-BF46-3FBA294C5E33__BABDGGCJ">
                        <p class="titleinexample">示例25-21自定义序列化程序</p><pre class="oac_no_warn" dir="ltr">package oracle.xml.xsql.serializers; import org.w3c.dom。文献; import java.io.PrintWriter的; import oracle.xml.xsql。*;公共类XSQLSampleSerializer实现XSQLDocumentSerializer {public void serialize（Document doc，XSQLPageRequest env）throws Throwable {String encoding = env.getPageEncoding（）; //使用与XSQL页面//模板相同的编码。如果需要，设置为特定的//编码String mimeType =“text / html”; //将此设置为适当的内容类型//（1）使用XSQLPageRequest上的setContentType设置内容类型if（encoding！= null &amp;&amp;！encoding.equals（“”））{env.setContentType（mimeType +“; charset =”+ encoding）; } else {env.setContentType（mimeType）; } //（2）从XSQLPageRequest PrintWriter获取输出编写器e = env.getWriter（）; //（3）将文档序列化为编写者e.println（“&lt;html&gt;文档元素是&lt;b&gt;”+ doc.getDocumentElement（）。getNodeName（）+“&lt;/ b&gt; &lt;/ html&gt;”）; }}</pre></div>
                     <!-- class="example" -->
                  </div><a id="ADXDK19688"></a><div class="props_rev_3"><a id="GUID-7BC3B483-F753-48D5-82C0-D738095CE8CE" name="GUID-7BC3B483-F753-48D5-82C0-D738095CE8CE"></a><h5 id="ADXDK-GUID-7BC3B483-F753-48D5-82C0-D738095CE8CE" class="sect5">使用自定义序列化程序的技巧</h5>
                     <div>
                        <p>有两种方法可以使用自定义序列化程序，具体取决于在序列化之前是否必须首先执行XSLT转换。</p>
                        <div class="section">
                           <p>要在使用自定义序列化程序之前执行XSLT转换，请添加<code class="codeph">serializer="java:fully.qualified.ClassName"</code>在<code class="codeph">&lt;?xml样式表？&gt;</code>页面顶部的处理说明。以下示例显示了此技术：</p><pre class="oac_no_warn" dir="ltr">&lt;？xml版本=“1.0？&gt; &lt;？xml-stylesheet type =“text / xsl”href =“mystyle.xsl”serializer =“java：my.pkg。MySerializer“？&gt;</pre><p>如果只需要自定义序列化程序，请省略<code class="codeph">type</code>和<code class="codeph">href</code>属性。以下示例显示了此技术：</p><pre class="oac_no_warn" dir="ltr">&lt;？xml版本=“1.0？&gt; &lt;？xml-stylesheet serializer =“java：my.pkg。MySerializer“？&gt;</pre></div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="ADXDK19690"></a><a id="ADXDK19691"></a><a id="ADXDK19689"></a><div class="props_rev_3"><a id="GUID-759AE99A-23BA-4CCE-AEF7-F4B3F77892E7" name="GUID-759AE99A-23BA-4CCE-AEF7-F4B3F77892E7"></a><h5 id="ADXDK-GUID-759AE99A-23BA-4CCE-AEF7-F4B3F77892E7" class="sect5">为自定义序列化程序指定短名称</h5>
                     <div>
                        <p>您可以在XSQL配置文件的<code class="codeph">&lt;serializerdefs&gt;</code>部分中为自定义序列化程序指定一个短名称。然后，您可以使用序列化程序属性中的短名称来保存键入内容。短名称区分大小写。
                        </p>
                        <div class="section">
                           <p>假设您在XSQL配置文件中具有<a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-759AE99A-23BA-4CCE-AEF7-F4B3F77892E7__BABJGEEH">示例25-22</a>中显示的信息。您可以在样式表说明中使用短名称“Sample”或“FOP”：</p><pre class="oac_no_warn" dir="ltr">&lt;？xml-stylesheet type =“text / xsl”href =“emp-to-xslfo.xsl”serializer =“FOP”？&gt; &lt;？xml-stylesheet serializer =“Sample”？&gt;</pre><p><code class="codeph">XSQLPageRequest</code>接口支持<code class="codeph">getWriter()</code>和<code class="codeph">getOutputStream()</code>方法。自定义序列化程序可以调用<code class="codeph">getOutputStream()</code>以返回可以序列化二进制数据的<code class="codeph">OutputStream</code>实例。使用XSQL servlet时，写入此输出流会将二进制信息写入servlet输出流。
                           </p>
                           <p><a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-759AE99A-23BA-4CCE-AEF7-F4B3F77892E7__BABEJAHC">例25-23中</a>显示的串行器显示了写入动态GIF图像的示例。在此示例中，GIF图像是静态“ok”图标，但它显示了更复杂的图像序列化程序必须使用的基本技术。
                           </p>
                           <p>使用XSQL命令行实用程序，二进制信息将写入目标输出文件。使用<code class="codeph">XSQLRequest</code> API，存在两个允许调用者提供目标<code class="codeph">OutputStream</code>以用于页面处理结果的构造函数。
                           </p>
                           <p>您的序列化程序必须为文本输出调用<code class="codeph">getWriter()</code>或为二进制输出调用<code class="codeph">getOutputStream()</code> ，但不能同时调用两者。在同一请求中调用两者都会引发错误。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-759AE99A-23BA-4CCE-AEF7-F4B3F77892E7__BABJGEEH">
                           <p class="titleinexample">示例25-22为自定义序列化程序分配短名称</p><pre class="oac_no_warn" dir="ltr">&lt;XSQLConfig&gt; &lt;！ - 等等。 - &gt; &lt;serializerdefs&gt; &lt;serializer&gt; &lt;name&gt; Sample &lt;/ name&gt; &lt;class&gt; oracle.xml.xsql.serializers。XSQLSampleSerializer &lt;/ class&gt; &lt;/ serializer&gt; &lt;serializer&gt; &lt;name&gt; FOP &lt;/ name&gt; &lt;class&gt; oracle.xml.xsql.serializers。XSQLFOPSerializer &lt;/ class&gt; &lt;/ serializer&gt; &lt;/ serializerdefs&gt; &lt;/ XSQLConfig&gt;</pre></div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-759AE99A-23BA-4CCE-AEF7-F4B3F77892E7__BABEJAHC">
                           <p class="titleinexample">示例25-23编写动态GIF图像</p><pre class="oac_no_warn" dir="ltr">package oracle.xml.xsql.serializers; import org.w3c.dom。文献; import java.io.*; import oracle.xml.xsql。*;公共类XSQLSampleImageSerializer实现XSQLDocumentSerializer {//字节数组表示一个小的“ok”GIF图像私有静态字节[] okGif = {（字节）0x47，（字节）0x49，（字节）0x46，（字节）0x38，（字节）0x39 ，（byte）0x61，（byte）0xB，（byte）0x0，（byte）0x9，（byte）0x0，（byte）0xFFFFFF80，（byte）0x0，（byte）0x0，（byte）0x0，（byte）0x0 ，（byte）0x0，（byte）0xFFFFFFFF，（byte）0xFFFFFFFF，（byte）0xFFFFFFFF，（byte）0x2C，（byte）0x0，（byte）0x0，（byte）0x0，（byte）0x0，（byte）0xB ，（byte）0x0，（byte）0x9，（byte）0x0，（byte）0x0，（byte）0x2，（byte）0x14，（byte）0xFFFFFF8C，（byte）0xF，（byte）0xFFFFFFA7，（byte）0xFFFFFFB8 ，（byte）0xFFFFFF9B，（byte）0xA，（byte）0xFFFFFFA2，（byte）0x79，（byte）0xFFFFFFE9，（byte）0xFFFFFF85，（byte）0x7A，（byte）0x27，（byte）0xFFFFFF93，（byte）0x5A ，（byte）0xFFFFFFE3，（byte）0xFFFFFFEC，（byte）0x75，（byte）0x11，（byte）0xFFFFFF85，（byte）0x14，（byte）0x0，（byte）0x3B}; public void serialize（Document doc，XSQLPageRequest env）throws Throwable {env.setContentType（“image / gif”）; OutputStream os = env.getOutputStream（）; os.write（okGif，0，okGif.length）; os.flush（）; }}</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div>
               </div><a id="ADXDK19692"></a><div class="props_rev_3"><a id="GUID-DCB347E9-A50A-4EB2-A419-CAC9E21C60AF" name="GUID-DCB347E9-A50A-4EB2-A419-CAC9E21C60AF"></a><h4 id="ADXDK-GUID-DCB347E9-A50A-4EB2-A419-CAC9E21C60AF" class="sect4">使用自定义XSQL连接管理器为JDBC数据源</h4>
                  <div>
                     <p>作为在XSQL配置文件中定义命名连接的替代方法，您可以使用提供的两个<code class="codeph">XSQLConnectionManager</code>实现之一。这些允许您使用servlet容器的JDBC数据源实现和相关的连接池功能。
                     </p>
                     <div class="section">
                        <p>此XSQL页面框架提供了此替代连接管理器实现：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">oracle.xml.xsql。XSQLDatasourceConnectionManager</code></p>
                              <p>请考虑使用此连接管理器，如果你的servlet容器的数据源实现<span class="italic">不</span>使用Oracle JDBC驱动程序。当您不使用Oracle JDBC驱动程序时，XSQL页面系统的功能（如<code class="codeph">&lt;xsql:ref-cursor-function&gt;</code>和<code class="codeph">&lt;xsql:include-owa&gt;</code>不可用。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">oracle.xml.xsql。XSQLOracleDatasourceConnectionManager</code></p>
                              <p>当数据源实现返回实现<code class="codeph">oracle.jdbc. JDBC <code class="codeph">PreparedStatement</code>和<code class="codeph">CallableStatement</code>对象时，请考虑使用此连接管理器<code class="codeph">oracle.jdbc.PreparedStatement</code>和<code class="codeph">oracle.jdbc.CallableStatement</code>接口。Oracle WebLogic Server具有执行此任务的数据源实现。
                              </p>
                           </li>
                        </ul>
                        <p>使用上述任一备用连接管理器实现时，XSQL页面模板中连接属性的值是用于查找所需数据源的Java命名和目录接口（JNDI）名称。例如，connection属性的值可能如下所示：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">JDBC / scottDS</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">的java：comp / env的/ JDBC / MyDatasource</code></p>
                           </li>
                        </ul>
                        <p>如果您未使用默认的XSQL页面连接管理器，则必须由备用连接管理器实现提供所需的连接池功能。对于基于JDBC数据源的前两个选项，必须正确配置servlet容器以提供连接池。有关如何正确配置数据源以提供池化连接的说明，请参阅servlet容器文档。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADXDK19693"></a><div class="sect3"><a id="GUID-C01D126B-2CF1-46AB-92A6-62A83471A1E8" name="GUID-C01D126B-2CF1-46AB-92A6-62A83471A1E8"></a><h4 id="ADXDK-GUID-C01D126B-2CF1-46AB-92A6-62A83471A1E8" class="sect4">编写自定义XSQL连接管理器</h4>
                  <div>
                     <p>您可以提供自定义连接管理器来替换内置连接管理机制。</p>
                     <p>要提供自定义连接管理器实现，您必须执行以下步骤：</p>
                     <ol>
                        <li>
                           <p>编写实现<code class="codeph">oracle.xml.xsql.的连接管理器工厂类<code class="codeph">oracle.xml.xsql.XSQLConnectionManagerFactory</code>接口。
                           </p>
                        </li>
                        <li>
                           <p>编写实现<code class="codeph">oracle.xml.xsql.的连接管理器类<code class="codeph">oracle.xml.xsql.XSQLConnectionManager</code>接口。
                           </p>
                        </li>
                        <li>
                           <p>在XSQL配置文件中更改<code class="codeph">XSQLConnectionManagerFactory</code>类的名称。
                           </p>
                        </li>
                     </ol>
                     <p>XSQL servlet使用您的连接管理方案而不是XSQL页面的默认方案。</p>
                     <p>您可以通过在XSQL配置文件中提供类名来将自定义连接管理器工厂设置为默认连接管理器工厂。在此部分设置工厂：</p><pre class="pre codeblock"><code>&lt;！ -  |设置XSQL连接管理器工厂的名称实现。该类必须实现| oracle.xml.xsql。XSQLConnectionManagerFactory接口。|如果未设置，则默认使用内置连接|经理实施在oracle.xml.xsql。XSQLConnectionManagerFactoryImpl +  - &gt; &lt;connection-manager&gt; &lt;factory&gt; oracle.xml.xsql。XSQLConnectionManagerFactoryImpl &lt;/ factory&gt; &lt;/ connection-manager&gt;</code></pre><p>除了指定默认的连接管理器工厂之外，您还可以使用提供的API将自定义连接工厂与<code class="codeph">XSQLRequest</code>对象相关联。
                     </p>
                     <p>该负责<code class="codeph">XSQLConnectionManagerFactory</code>是返回一个实例<code class="codeph">XSQLConnectionManager</code>当前请求使用。在诸如servlet引擎的多线程环境中， <code class="codeph">XSQLConnectionManager</code>对象必须确保两个不同的线程不使用单个<code class="codeph">XSQLConnection</code>实例。通过将连接标记为<code class="codeph">getConnection()</code>和<code class="codeph">releaseConnection()</code>方法调用之间的时间来实现此目标。默认的XSQL连接管理器实现自动对命名连接进行池化并遵循此线程安全策略。
                     </p>
                     <p>如果您的<code class="codeph">XSQLConnectionManager</code>的自定义实现实现了可选的<code class="codeph">XSQLConnectionManager</code> <code class="codeph">oracle.xml.xsql.XSQLConnectionManagerCleanup</code>接口，然后您的连接管理器可以清理它已分配的任何资源。例如，如果您的servlet容器调用<code class="codeph">XSQLServlet</code> servlet上的<code class="codeph">destroy()</code>方法<code class="codeph">destroy()</code>例如，在servlet的联机管理期间可能发生这种情况），则连接管理器有机会在servlet销毁过程中清理资源。
                     </p>
                  </div><a id="ADXDK19694"></a><div class="props_rev_3"><a id="GUID-2CEAD8D1-7014-49DF-94E9-0E2A68275DFE" name="GUID-2CEAD8D1-7014-49DF-94E9-0E2A68275DFE"></a><h5 id="ADXDK-GUID-2CEAD8D1-7014-49DF-94E9-0E2A68275DFE" class="sect5">在自定义连接管理器中访问身份验证信息</h5>
                     <div>
                        <p>要使用HTTP身份验证机制获取用于连接数据库的用户名和密码，请编写自定义连接管理器。然后，您可以调用<code class="codeph">getConnection()</code>方法来获取所需的信息。
                        </p>
                        <div class="section">
                           <p>您可以编写遵循以下步骤的Java程序：</p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li><span>传递<code class="codeph">oracle.xml.xsql.的实例<code class="codeph">oracle.xml.xsql.XSQLPageRequest</code>接口到<code class="codeph">getConnection()</code>方法。</span></li>
                           <li><span>调用<code class="codeph">getRequestType()</code>以确保请求类型是<code class="codeph">Servlet</code> 。</span></li>
                           <li><span>将<code class="codeph">XSQLPageRequest</code>对象转换为<code class="codeph">XSQLServletPageRequest</code> 。</span></li>
                           <li><span>对前一步骤的结果调用<code class="codeph">getHttpServletRequest()</code> 。</span></li>
                           <li><span>从<code class="codeph">javax.servlet.http.获取身份验证信息<code class="codeph">javax.servlet.http.上次调用返回的HttpServletResponse</code>对象。</span></li>
                        </ol>
                     </div>
                  </div>
               </div><a id="ADXDK19696"></a><a id="ADXDK19695"></a><div class="props_rev_3"><a id="GUID-0D913A5C-2BCF-4647-BACC-7DC1A329A8D4" name="GUID-0D913A5C-2BCF-4647-BACC-7DC1A329A8D4"></a><h4 id="ADXDK-GUID-0D913A5C-2BCF-4647-BACC-7DC1A329A8D4" class="sect4">实现自定义XSQLErrorHandler</h4>
                  <div>
                     <p>您可以通过实现接口<code class="codeph">oracle.xml.xsql.来控制向用户报告页面处理器错误（例如不可用连接）的严重程度<code class="codeph">oracle.xml.xsql.XSQLErrorHandler</code> 。
                     </p>
                     <div class="section">
                        <p>该接口包含此单一方法签名：</p><pre class="oac_no_warn" dir="ltr">public interface XSQLErrorHandler {public void handleError（XSQLError err，XSQLPageRequest env）; }</pre><p>您可以提供一个实现<code class="codeph">XSQLErrorHandler</code>接口的类来自定义XSQL页面处理器如何写入错误消息。新的<code class="codeph">XSQLError</code>对象封装了错误信息，并提供对错误代码，格式化错误消息等的访问。
                        </p>
                        <p><a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-0D913A5C-2BCF-4647-BACC-7DC1A329A8D4__BABEHDDD">实施例25-24</a>示出的样本实现<code class="codeph">XSQLErrorHandler</code> 。
                        </p>
                        <p>您可以通过以下不同方式控制使用哪个自定义<code class="codeph">XSQLErrorHandler</code>实现：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>在XSQL配置文件中定义自定义<code class="codeph">XSQLErrorHandler</code>实现类的名称。您必须提供错误处理程序类的完全限定类名作为<code class="codeph">/XSQLConfig/processor/error-handler/class</code>条目的值。
                              </p>
                              <p>如果XSQL处理器可以加载此类，并且它正确实现了<code class="codeph">XSQLErrorHandler</code>接口，那么它将此类用作单例，并在报告页面处理器错误的任何地方全局替换默认实现。
                              </p>
                           </li>
                           <li>
                              <p>通过在页面的document元素上使用<code class="codeph">errorHandler</code> （或<code class="codeph">xsql:errorHandler</code> ）属性，在每页的基础上覆盖错误编写器。属性值是实现<code class="codeph">XSQLErrorHandler</code>接口的类的完全限定类名。此类仅报告此页面的错误。页面引擎在每个页面请求上实例化该类。
                              </p>
                           </li>
                        </ul>
                        <p>如果需要，您可以结合使用上述方法。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-0D913A5C-2BCF-4647-BACC-7DC1A329A8D4__BABEHDDD">
                        <p class="titleinexample">例25-24 myErrorHandler类</p><pre class="oac_no_warn" dir="ltr">包装示例; import oracle.xml.xsql。*; import java.io.*;公共类myErrorHandler实现XSQLErrorHandler {public void logError（XSQLError err，XSQLPageRequest env）{//必须在写入任何内容之前设置内容类型env.setContentType（“text / html”）; PrintWriter pw = env.getErrorWriter（）; pw.println（ “&lt;H1&gt; ERROR &lt;/ H1&gt; &lt;HR&gt;” + err.getMessage（））; }}</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADXDK19698"></a><a id="ADXDK19699"></a><a id="ADXDK19700"></a><a id="ADXDK19697"></a><div class="props_rev_3"><a id="GUID-2571E21E-CB76-4B80-8233-E4ACB4D81EB8" name="GUID-2571E21E-CB76-4B80-8233-E4ACB4D81EB8"></a><h4 id="ADXDK-GUID-2571E21E-CB76-4B80-8233-E4ACB4D81EB8" class="sect4">提供自定义XSQL记录器实现</h4>
                  <div>
                     <p>您可以选择注册自定义代码来处理每个XSQL页面请求的开始和结束的日志记录。您的自定义记录器代码必须提供接口<code class="codeph">oracle.xml.xsql.的实现<code class="codeph">oracle.xml.xsql.XSQLLoggerFactory</code>和XSQLLoggerFactory</code> <code class="codeph">oracle.xml.xsql.XSQLLogger</code> 。
                     </p>
                     <div class="section">
                        <p><code class="codeph">XSQLLoggerFactory</code>接口包含以下单个方法：</p><pre class="oac_no_warn" dir="ltr">public interface XSQLLoggerFactory {public XSQLLogger create（XSQLPageRequest env）; }</pre><p>您可以提供一个实现<code class="codeph">XSQLLoggerFactory</code>接口的类来决定如何创建（或重用） <code class="codeph">XSQLLogger</code>对象以进行日志记录。XSQL处理器在页面请求期间保存对工厂返回的<code class="codeph">XSQLLogger</code>对象的引用。处理器使用它通过调用<code class="codeph">logRequestStart()</code>和<code class="codeph">logRequestEnd()</code>方法来记录每个页面请求的开始和结束。
                        </p>
                        <p><code class="codeph">XSQLLogger</code>接口是：</p><pre class="oac_no_warn" dir="ltr">public interface XSQLLogger {public void logRequestStart（XSQLPageRequest env）; public void logRequestEnd（XSQLPageRequest env）; }</pre><p><a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-2571E21E-CB76-4B80-8233-E4ACB4D81EB8__BABEGBFA">例25-25</a>和<a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-2571E21E-CB76-4B80-8233-E4ACB4D81EB8__BABBDEGD">例25-26中的类</a>显示了自定义记录器的简单实现。<a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-2571E21E-CB76-4B80-8233-E4ACB4D81EB8__BABEGBFA">例25-25中</a>的<code class="codeph">XSQLLogger</code>实现记录了页面请求开始的时间。然后，它通过将页面请求的名称和已用时间打印到<code class="codeph">System.out</code>来记录页面请求结束。
                        </p>
                        <p>工厂实现如<a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-2571E21E-CB76-4B80-8233-E4ACB4D81EB8__BABBDEGD">例25-26</a>所示。
                        </p>
                        <p>要注册自定义记录器工厂，请编辑<code class="codeph">XSQLConfig.xml</code>文件，并提供自定义记录器工厂类的名称作为<code class="codeph">/XSQLConfig/processor/logger/factory</code>元素的内容。<a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-2571E21E-CB76-4B80-8233-E4ACB4D81EB8__BABHCGBD">例25-27</a>显示了这种技术。
                        </p>
                        <p>默认情况下， <code class="codeph">&lt;logger&gt;</code>部分已注释掉。没有默认记录器。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-2571E21E-CB76-4B80-8233-E4ACB4D81EB8__BABEGBFA">
                        <p class="titleinexample">例25-25 SampleCustomLogger类</p><pre class="oac_no_warn" dir="ltr">包装示例; import oracle.xml.xsql。*;公共类SampleCustomLogger实现XSQLLogger {long start = 0; public void logRequestStart（XSQLPageRequest env）{start = System.currentTimeMillis（）; public void logRequestEnd（XSQLPageRequest env）{long secs = System.currentTimeMillis（） -  start; System.out.println（“Request for”+ env.getSourceDocumentURI（）+“take”+ secs +“ms”）; }}</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-2571E21E-CB76-4B80-8233-E4ACB4D81EB8__BABBDEGD">
                        <p class="titleinexample">示例25-26 SampleCustomLoggerFactory类</p><pre class="oac_no_warn" dir="ltr">包装示例; import oracle.xml.xsql。*;公共类SampleCustomLoggerFactory实现XSQLLoggerFactory {public XSQLLogger create（XSQLPageRequest env）{return new SampleCustomLogger（）; }}</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-2571E21E-CB76-4B80-8233-E4ACB4D81EB8__BABHCGBD">
                        <p class="titleinexample">示例25-27注册自定义记录器工厂</p><pre class="oac_no_warn" dir="ltr">&lt;XSQLConfig&gt;：&lt;processor&gt;：&lt;logger&gt; &lt;factory&gt;示例。SampleCustomLoggerFactory &lt;/ factory&gt; &lt;/ logger&gt;：&lt;/ processor&gt; &lt;/ XSQLConfig&gt;</pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>