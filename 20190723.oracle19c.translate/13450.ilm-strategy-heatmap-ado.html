<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="To implement an Information Lifecycle Management (ILM) strategy for data movement in your database, you can use Heat Map and Automatic Data Optimization (ADO) features."></meta>
      <meta name="description" content="To implement an Information Lifecycle Management (ILM) strategy for data movement in your database, you can use Heat Map and Automatic Data Optimization (ADO) features."></meta>
      <title>使用热图和ADO实现ILM策略</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="VLDB and Partitioning Guide"></meta>
      <meta property="og:description" content="To implement an Information Lifecycle Management (ILM) strategy for data movement in your database, you can use Heat Map and Automatic Data Optimization (ADO) features."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="VLDB and Partitioning Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="vldb-and-partitioning-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-04-23T18:05:22-07:00"></meta>
      <meta name="dcterms.title" content="VLDB and Partitioning Guide"></meta>
      <meta name="dcterms.dateCopyrighted" content="2008, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96199-03"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="manage-data-db-ilm.html" title="Previous" type="text/html"></link>
      <link rel="next" href="control-validity-visibility-data.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="VLDBG"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="manage-data-db-ilm.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="control-validity-visibility-data.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">VLDB和分区指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="time-based-info.html" property="item" typeof="WebPage"><span property="name">管理和维护基于时间的信息</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">使用热图和ADO实现ILM策略</li>
            </ol>
            <a id="GUID-1E510486-2ED8-467A-A5BA-045F4F3AC324" name="GUID-1E510486-2ED8-467A-A5BA-045F4F3AC324"></a><a id="VLDBG14183"></a>
            
            <h2 id="VLDBG-GUID-1E510486-2ED8-467A-A5BA-045F4F3AC324" class="sect2">使用热图和ADO实现ILM策略</h2>
         </header>
         <div class="ind">
            <div>
               <p>要在数据库中实现数据移动的信息生命周期管理（ILM）策略，您可以使用热图和自动数据优化（ADO）功能。</p>
               <div class="infoboxnote" id="GUID-1E510486-2ED8-467A-A5BA-045F4F3AC324__GUID-635731B3-7F01-4359-9954-8F809F5CFED0">
                  <p class="notep1">注意：</p>
                  <p>Oracle Database 12 <span class="italic">c</span>第2版多租户环境支持热图和ADO。
                  </p>
               </div>
               <p>本节包含以下主题：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="ilm-strategy-heatmap-ado.html#GUID-FB83C140-B7E7-4EF8-959A-A990ECE20369" title="要实施ILM策略，可以使用Oracle数据库中的热图来跟踪数据访问和修改。">使用热图</a></p>
                  </li>
                  <li>
                     <p><a href="ilm-strategy-heatmap-ado.html#GUID-59C132D6-D36B-4B5E-B0CA-948C1B0E6836" title="要实施ILM策略，可以使用自动数据优化（ADO）在数据库中的不同存储层之间自动压缩和移动数据。">使用自动数据优化</a></p>
                  </li>
                  <li>
                     <p><a href="ilm-strategy-heatmap-ado.html#GUID-85EF8DD3-B372-4D5A-8941-FD7A0AF9C364" title="本主题讨论了与ADO和热图相关的限制和限制。">ADO和热图的限制和限制</a></p>
                  </li>
               </ul>
               <div class="infoboxnotealso" id="GUID-1E510486-2ED8-467A-A5BA-045F4F3AC324__ORACLEDATABASEVAULTADMINISTRATORSGU-01396A1D">
                  <p class="notep1">也可以看看：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="heatmap-ado-em.html#GUID-94F6D36D-DEA5-442B-919C-3690CB89A072" title="您可以使用Oracle Enterprise Manager云控制来管理热图和自动数据优化。">使用Oracle Enterprise Manager管理ILM热图和ADO，</a>以获取有关通过热图和ADO使用Oracle企业管理器云控制的信息</p>
                     </li>
                     <li>
                        <p><a href="../dvadm/dba-operations-in-an-oracle-database-vault-environment.html#DVADM-GUID-886F7C9A-74A1-476F-85A4-300269EAF5CA" target="_blank"><span><cite>“Oracle Database Vault管理员指南”</cite></span></a> ，了解有关将信息生命周期管理（ILM）与Oracle Database Vault领域和命令规则一起使用的信息，包括授予使ADO管理用户能够对受Database Vault保护的对象执行ILM操作的授权。
                        </p>
                     </li>
                  </ul>
               </div>
            </div><a id="VLDBG14124"></a><div class="props_rev_3"><a id="GUID-FB83C140-B7E7-4EF8-959A-A990ECE20369" name="GUID-FB83C140-B7E7-4EF8-959A-A990ECE20369"></a><h3 id="VLDBG-GUID-FB83C140-B7E7-4EF8-959A-A990ECE20369" class="sect3">使用热图</h3>
               <div>
                  <p>要实施ILM策略，可以使用Oracle数据库中的热图来跟踪数据访问和修改。</p>
                  <p>热图提供了段级别的数据访问跟踪和段级别和行级别的数据修改跟踪。您可以使用<code class="codeph">HEAT_MAP</code>初始化参数启用此功能。
                  </p>
                  <p>热图数据可以帮助自动数据优化（ADO）使用ADO策略管理内存中列存储（IM列存储）的内容。使用热图数据（包括列统计信息和其他相关统计信息），IM列存储可以确定它几乎已满（在内存压力下）。如果确定<span class="italic">几乎</span> <span class="italic">已满</span> ，则如果有更频繁访问的段将受益于IM列存储中的填充，则可以驱逐非活动段。
                  </p>
                  <p>本节包含以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="ilm-strategy-heatmap-ado.html#GUID-FB038F5C-3243-4B20-A4C6-48935F0F3F95" title="您可以使用HEAT_MAP子句使用ALTER SYSTEM或ALTER SESSION语句在系统或会话级别启用和禁用热图跟踪。">启用和禁用热图</a></p>
                     </li>
                     <li>
                        <p><a href="ilm-strategy-heatmap-ado.html#GUID-1E3F8295-56EE-4798-BDC0-BFC626168828" title="使用V $ *，ALL *，DBA *和USER *热图视图查看热图跟踪数据。">用视图显示热图跟踪数据</a></p>
                     </li>
                     <li>
                        <p><a href="ilm-strategy-heatmap-ado.html#GUID-90A61B99-5195-4D0B-BF77-FD82EBD1C423" title="DBMS_HEAT_MAP包为使用DBMS_HEAT_MAP子程序显示热图数据提供了额外的灵活性。">使用DBMS_HEAT_MAP子程序管理热图数据</a></p>
                     </li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-FB83C140-B7E7-4EF8-959A-A990ECE20369__ORACLEDATABASEIN-MEMORYGUIDEFORINFO-FB6A8A21">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>有关启用和调整内存中列存储的信息，请参见“ <a href="../inmem/enabling-the-im-column-store.html#INMEM-GUID-3CC8549A-A394-49CC-A907-AEB471A19CB3" target="_blank"><span><cite>Oracle数据库内存指南”</cite></span></a></p>
                        </li>
                     </ul>
                  </div>
               </div><a id="VLDBG14175"></a><div class="props_rev_3"><a id="GUID-FB038F5C-3243-4B20-A4C6-48935F0F3F95" name="GUID-FB038F5C-3243-4B20-A4C6-48935F0F3F95"></a><h4 id="VLDBG-GUID-FB038F5C-3243-4B20-A4C6-48935F0F3F95" class="sect4">启用和禁用热图</h4>
                  <div>
                     <p>您可以使用<code class="codeph">HEAT_MAP</code>子句使用<code class="codeph">ALTER</code> <code class="codeph">SYSTEM</code>或<code class="codeph">ALTER</code> <code class="codeph">SESSION</code>语句在系统或会话级别启用和禁用热图跟踪。
                     </p>
                     <div class="section">
                        <p></p>
                        <p>例如，以下SQL语句为数据库实例启用热图跟踪。</p><pre class="oac_no_warn" dir="ltr">ALTER SYSTEM SET HEAT_MAP = ON;</pre><p>启用热图后，内存中活动跟踪模块将跟踪所有访问。不跟踪<code class="codeph">SYSTEM</code>和<code class="codeph">SYSAUX</code>表空间中的对象。
                        </p>
                        <p>以下SQL语句禁用热图跟踪。</p><pre class="oac_no_warn" dir="ltr">ALTER SYSTEM SET HEAT_MAP = OFF;</pre><p>禁用热图时，内存中活动跟踪模块不会跟踪访问。<code class="codeph">HEAT_MAP</code>初始化参数的默认值为<code class="codeph">OFF</code> 。</p>
                        <p><code class="codeph">HEAT_MAP</code>初始化参数还启用和禁用自动数据优化（ADO）。对于ADO，必须在系统级别启用热图。
                        </p>
                        <div class="infoboxnotealso" id="GUID-FB038F5C-3243-4B20-A4C6-48935F0F3F95__GUID-C2167A00-EF61-449C-8F31-E767AA44B465">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><a href="ilm-strategy-heatmap-ado.html#GUID-59C132D6-D36B-4B5E-B0CA-948C1B0E6836" title="要实施ILM策略，可以使用自动数据优化（ADO）在数据库中的不同存储层之间自动压缩和移动数据。">使用自动数据优化</a>获取有关ADO的更多信息</p>
                              </li>
                              <li>
                                 <p>有关<code class="codeph">HEAT_MAP</code>初始化参数的信息，请<code class="codeph">HEAT_MAP</code> <a href="../refrn/HEAT_MAP.html#REFRN10342" target="_blank"><span><cite>Oracle数据库参考</cite></span></a></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="VLDBG14177"></a><a id="VLDBG14176"></a><div class="props_rev_3"><a id="GUID-1E3F8295-56EE-4798-BDC0-BFC626168828" name="GUID-1E3F8295-56EE-4798-BDC0-BFC626168828"></a><h4 id="VLDBG-GUID-1E3F8295-56EE-4798-BDC0-BFC626168828" class="sect4">用视图显示热图跟踪数据</h4>
                  <div>
                     <p>使用<code class="codeph">V$*</code> ， <code class="codeph">ALL*</code> ， <code class="codeph">DBA*</code>和<code class="codeph">USER*</code>热图视图查看热图跟踪数据。
                     </p>
                     <div class="section">
                        <p></p>
                        <p><a href="ilm-strategy-heatmap-ado.html#GUID-1E3F8295-56EE-4798-BDC0-BFC626168828__CHDJIIFC">例5-1</a>显示了由热图视图提供的信息的示例。<code class="codeph">V$HEAT_MAP_SEGMENT</code>视图显示实时段访问信息。<code class="codeph">ALL_</code> ， <code class="codeph">DBA_</code>和<code class="codeph">USER_HEAT_MAP_SEGMENT</code>视图显示用户可见的所有段的最新段访问时间。<code class="codeph">ALL_</code> ， <code class="codeph">DBA_</code>和<code class="codeph">USER_HEAT_MAP_SEG_HISTOGRAM</code>视图显示用户可见的所有段的段访问信息。<code class="codeph">DBA_HEATMAP_TOP_OBJECTS</code>视图显示最活跃对象的热图信息。<code class="codeph">DBA_HEATMAP_TOP_TABLESPACES</code>视图显示最活跃的表空间的热图信息。
                        </p>
                        <div class="infoboxnotealso" id="GUID-1E3F8295-56EE-4798-BDC0-BFC626168828__GUID-402B8E85-A469-46BD-82A2-D9DB5C371986">
                           <p class="notep1">也可以看看：</p>
                           <p>有关热图视图的信息，请参阅<a href="../refrn/about-static-data-dictionary-views.html#REFRN002" target="_blank"><span><cite>Oracle数据库参考</cite></span></a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-1E3F8295-56EE-4798-BDC0-BFC626168828__CHDJIIFC">
                        <p class="titleinexample">示例5-1热图视图</p><pre class="oac_no_warn" dir="ltr">/ *如果需要，启用热图跟踪* / SELECT SUBSTR（OBJECT_NAME，1,20），SUBSTR（SUBOBJECT_NAME，1,20），TRACK_TIME，SEGMENT_WRITE，FULL_SCAN，LOOKUP_SCAN来自V $ HEAT_MAP_SEGMENT; SUBSTR（OBJECT_NAME，1 SUBSTR（SUBOBJECT_NAM TRACK_TIM SEG FUL LOO -------------------- ------------------ -  --------- --- --- --- SALES SALES_Q1_1998 01-NOV-12 NO NO NO SALES SALES_Q3_1998 01-NOV-12 NO NO NO SALES SALES_Q2_2000 01-NOV-12 NO NO NO SALES SALES_Q3_1999 01-NOV-12 NO NO NO SALES SALES_Q2_1998 01-NOV-12 NO NO NO SALES SALES_Q2_1999 01-NOV-12 NO NO NO SALES SALES_Q4_2001 01-NOV-12 NO NO NO SALES SALES_Q1_1999 01-NOV-12 NO NO NO SALES SALES_Q4_1998 01-NOV-12 NO NO NO SALES SALES_Q1_2000 01-NOV-12 NO NO NO SALES SALES_Q1_2001 01-NOV-12 NO NO NO SALES SALES_Q2_2001 01-NOV-12 NO NO NO SALES SALES_Q3_2000 01-NOV-12 NO NO NO SALES SALES_Q4_2000 01-NOV-12 NO NO NO EMPLOYEES 01-NOV-12 NO NO NO ...选择SUBSTR（OBJECT_NAME，1,20），SUBSTR（SUBOBJECT_NAME，1,20），SEGMENT_WRITE_TIME，SEGMENT_READ_TIME，FULL_SCAN，LOOKUP_SCAN来自USER_HEAT_MAP_SEGMENT; SUBSTR（OBJECT_NAME，1 SUBSTR（SUBOBJECT_NAM SEGMENT_W SEGMENT_R FULL_SCAN LOOKUP_SC -------------------- ------------------ -  --------- --------- --------- --------- SALES SALES_Q1_1998 30-OCT-12 01-NOV-12 SALES SALES_Q1_1998 30-OCT-12 01-NOV-12 SALES SALES_Q1_1998 30-OCT-12 01-NOV-12 SALES SALES_Q1_1998 30-OCT-12 01-NOV-12 SALES SALES_Q1_1998 30-OCT-12 01-NOV-12 SALES SALES_Q1_1998 30-OCT-12 01-NOV-12 ......从USER_HEAT_MAP_SEG_HISTOGRAM中选择SUBSTR（OBJECT_NAME，1,20），SUBSTR（SUBOBJECT_NAME，1,20），TRACK_TIME，SEGMENT_WRITE，FULL_SCAN，LOOKUP_SCAN; SUBSTR（OBJECT_NAME，1 SUBSTR（SUBOBJECT_NAM TRACK_TIM SEG FUL LOO -------------------- ------------------ -  --------- --- --- --- SALES SALES_Q1_1998 31-OCT-12否否销售SALES_Q1_1998 01-NOV-12否否销售SALES_Q1_1998 30-OCT-12否是是销售SALES_Q2_1998 01-NOV-12否否销售SALES_Q2_1998 31-OCT-12否否销售SALES_Q2_1998 30-OCT-12否是是销售SALES_Q3_1998 01-NOV-12否否销售SALES_Q3_1998 30-OCT-12否是是销售SALES_Q3_1998 31-OCT-12否否销售SALES_Q4_1998 01-NOV-12否否销售SALES_Q4_1998 31-OCT-12否否销售SALES_Q4_1998 30-OCT-12否是是销售SALES_Q1_1999 01-NOV-12否否是SALES SALES_Q1_1999 31-OCT-12 NO NO YES ...SELECT SUBSTR（OWNER，1,20），SUBSTR（OBJECT_NAME，1,20），OBJECT_TYPE，SUBSTR（TABLESPACE_NAME，1,20），SEGMENT_COUNT来自DBA_HEATMAP_TOP_OBJECTS按SEGMENT_COUNT DESC排序; SUBSTR（OWNER，1,20）SUBSTR（OBJECT_NAME，1 OBJECT_TYPE SUBSTR（TABLESPACE_NA SEGMENT_COUNT -------------------- ------------ -------- ------------------ -------------------- ---- --------- SH销售表示例96 SH成本表示例48 PM ONLINE_MEDIA表示例22 OE购买表示例18 PM PRINT_MEDIA表示例15 OE客户表示例10 OE WAREHOUSES表示例9 HR员工表示例7 OE LINEITEM_TABLE表示例6 IX STREAMS_QUEUE_TABLE表示例6 SH FWEEK_PSCAT_SALES_MV表示例5 SH客户表示例5 HR位置表示例5 HR JOB_HISTORY表示例5 SH产品表示例5 ...SELECT SUBSTR（TABLESPACE_NAME，1,20），SEGMENT_COUNT来自DBA_HEATMAP_TOP_TABLESPACES订购SEGMENT_COUNT DESC; SUBSTR（TABLESPACE_NA SEGMENT_COUNT -------------------- ------------- Example 351 USERS 11 SELECT COUNT（*）FROM DBA_HEATMAP_TOP_OBJECTS; COUNT （*）---------- 64 SELECT COUNT（*）FROM DBA_HEATMAP_TOP_TABLESPACES; COUNT（*）---------- 2</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="VLDBG14179"></a><a id="VLDBG14178"></a><div class="props_rev_3"><a id="GUID-90A61B99-5195-4D0B-BF77-FD82EBD1C423" name="GUID-90A61B99-5195-4D0B-BF77-FD82EBD1C423"></a><h4 id="VLDBG-GUID-90A61B99-5195-4D0B-BF77-FD82EBD1C423" class="sect4">使用DBMS_HEAT_MAP子程序管理热图数据</h4>
                  <div>
                     <p><code class="codeph">DBMS_HEAT_MAP</code>包为使用<code class="codeph">DBMS_HEAT_MAP</code>子程序显示热图数据提供了额外的灵活性。
                     </p>
                     <div class="section">
                        <p> <code class="codeph">DBMS_HEAT_MAP</code>包括一组API，用于在各种存储级别（例如块，范围，段，对象和表空间）外部化热图;第二组API外部化由顶部表空间的后台进程实现的热图。
                        </p>
                        <p><a href="ilm-strategy-heatmap-ado.html#GUID-90A61B99-5195-4D0B-BF77-FD82EBD1C423__CHDGCIEJ">例5-2</a>显示了使用<code class="codeph">DBMS_HEAT_MAP</code>程序的示例。
                        </p>
                        <div class="infoboxnotealso" id="GUID-90A61B99-5195-4D0B-BF77-FD82EBD1C423__GUID-96E4978A-A3CC-4388-BE6A-0BA230D183D2">
                           <p class="notep1">也可以看看：</p>
                           <p>有关<code class="codeph">DBMS_HEAT_MAP</code>包的信息，请<code class="codeph">DBMS_HEAT_MAP</code> <a href="../arpls/DBMS_HEAT_MAP.html#ARPLS74860" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-90A61B99-5195-4D0B-BF77-FD82EBD1C423__CHDGCIEJ">
                        <p class="titleinexample">示例5-2使用DBMS_HEAT_MAP程序包子程序</p><pre class="oac_no_warn" dir="ltr">SELECT SUBSTR（segment_name，1,10）Segment，min_writetime，min_ftstime FROM TABLE（DBMS_HEAT_MAP.OBJECT_HEAT_MAP（'SH'，'SALES'））; SELECT SUBSTR（tablespace_name，1,16）Tblspace，min_writetime，min_ftstime FROM TABLE（DBMS_HEAT_MAP.TABLESPACE_HEAT_MAP（'EXAMPLE'））; SELECT relative_fno，block_id，blocks，TO_CHAR（min_writetime，'mm-dd-yy hh-mi-ss'）Mintime，TO_CHAR（max_writetime，'mm-dd-yy hh-mi-ss'）Maxtime，TO_CHAR（avg_writetime，' mm-dd-yy hh-mi-ss'）Avgtime FROM TABLE（DBMS_HEAT_MAP.EXTENT_HEAT_MAP（'SH'，'SALES'））WHERE ROWNUM &lt;10; SELECT SUBSTR（owner，1,10）Owner，SUBSTR（segment_name，1,10）Segment，SUBSTR（partition_name，1,16）Partition，SUBSTR（tablespace_name，1,16）Tblspace，segment_type，segment_size FROM TABLE（DBMS_HEAT_MAP.OBJECT_HEAT_MAP （ 'SH'， 'SALES'））;所有者分区划分TBLSPACE SEGMENT_TYPE SEGMENT_SIZE ---------- ---------- ---------------- -------- -------- -------------------- ------------ SH SALES SALES_Q1_1998示例表分区8388608 SH SALES SALES_Q2_1998示例表分区8388608 SH SALES SALES_Q3_1998示例表分区8388608 SH SALES SALES_Q4_1998示例表分区8388608 SH SALES SALES_Q1_1999示例表分区8388608 ...
</pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
            </div><a id="VLDBG14117"></a><div class="props_rev_3"><a id="GUID-59C132D6-D36B-4B5E-B0CA-948C1B0E6836" name="GUID-59C132D6-D36B-4B5E-B0CA-948C1B0E6836"></a><h3 id="VLDBG-GUID-59C132D6-D36B-4B5E-B0CA-948C1B0E6836" class="sect3">使用自动数据优化</h3>
               <div>
                  <p>要实施ILM策略，可以使用自动数据优化（ADO）在数据库中的不同存储层之间自动压缩和移动数据。</p>
                  <p>该功能包括创建为每个层指定不同压缩级别的策略，以及控制数据移动发生的时间。</p>
                  <p>本节包含以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="ilm-strategy-heatmap-ado.html#GUID-B011D86F-DCDE-4BF5-9C47-24B9650EFCA8" title="在使用SQL语句创建和更改表时，可以在行，段和表空间粒度级别为ADO指定策略。">管理自动数据优化的策略</a></p>
                     </li>
                     <li>
                        <p><a href="ilm-strategy-heatmap-ado.html#GUID-8385C12B-DFB7-4407-81F7-64F9CAD5952D" title="将ILM ADD POLICY子句与CREATE TABLE语句一起使用以创建具有ILM ADO策略的表。">使用ILM ADO策略创建表</a></p>
                     </li>
                     <li>
                        <p><a href="ilm-strategy-heatmap-ado.html#GUID-DE4C9EB5-FBDC-4621-AA7B-17EBD11FBF27" title="将ILM ADD POLICY子句与ALTER TABLE语句一起使用可将ILM ADO策略添加到表中。">添加ILM ADO策略</a></p>
                     </li>
                     <li>
                        <p><a href="ilm-strategy-heatmap-ado.html#GUID-811423E6-3F43-4B95-AF9E-119AC71FB0D0" title="将ILM DISABLE POLICY或ILM DELETE POLICY子句与ALTER TABLE语句一起使用可禁用或删除ILM ADO策略。">禁用和删除ILM ADO策略</a></p>
                     </li>
                     <li>
                        <p><a href="ilm-strategy-heatmap-ado.html#GUID-DF9A2DDC-A5D3-4147-A2AB-DAE4C4FC99D7" title="您可以使用段级压缩分层策略在表中的段级别指定压缩。">使用ADO指定段级压缩和存储分层</a></p>
                     </li>
                     <li>
                        <p><a href="ilm-strategy-heatmap-ado.html#GUID-B3543DEF-885D-483A-9167-F414834F6779" title="除基本和高级压缩外，自动数据优化（ADO）策略还支持混合列压缩（HCC）。">使用ADO指定行级压缩分层</a></p>
                     </li>
                     <li>
                        <p><a href="ilm-strategy-heatmap-ado.html#GUID-1C87CC45-14E2-4AE0-849C-3324DF94A4EA" title="您可以使用在DBMS_ILM_ADMIN PL / SQL包中使用CUSTOMIZE_ILM过程设置的ILM ADO参数来自定义ADO环境。">管理ILM ADO参数</a></p>
                     </li>
                     <li>
                        <p><a href="ilm-strategy-heatmap-ado.html#GUID-EFA918BC-3430-486B-B936-C3DAA41572F0" title="您可以使用PL / SQL DBMS_ILM和DBMS_ILM_ADMIN程序包进行高级策略管理和自定义，以实现更复杂的ADO方案，并控制策略何时主动移动和压缩数据。">使用PL / SQL函数进行策略管理</a></p>
                     </li>
                     <li>
                        <p><a href="ilm-strategy-heatmap-ado.html#GUID-E97A72F8-C023-4C49-AC9F-D052F3B4586D" title="您可以使用DBA_ILM *和USER_ILM *视图查看和监视与数据库对象关联的ADO策略，从而可以根据需要更轻松地更改策略。">使用视图监视ADO的策略</a></p>
                     </li>
                  </ul>
                  <p>要使用自动数据优化，必须在系统级别启用热图。您可以使用<code class="codeph">HEAT_MAP</code>初始化参数启用此功能。有关设置<code class="codeph">HEAT_MAP</code>初始化参数的信息，请参阅<a href="ilm-strategy-heatmap-ado.html#GUID-FB038F5C-3243-4B20-A4C6-48935F0F3F95" title="您可以使用HEAT_MAP子句使用ALTER SYSTEM或ALTER SESSION语句在系统或会话级别启用和禁用热图跟踪。">启用和禁用热图</a> 。
                  </p>
               </div><a id="VLDBG14118"></a><div class="props_rev_3"><a id="GUID-B011D86F-DCDE-4BF5-9C47-24B9650EFCA8" name="GUID-B011D86F-DCDE-4BF5-9C47-24B9650EFCA8"></a><h4 id="VLDBG-GUID-B011D86F-DCDE-4BF5-9C47-24B9650EFCA8" class="sect4">管理自动数据优化的策略</h4>
                  <div>
                     <p>在使用SQL语句创建和更改表时，可以在行，段和表空间粒度级别为ADO指定策略。</p>
                     <p>通过为ADO指定策略，您可以在数据库中的不同存储层之间自动执行数据移动。这些策略还允许您为每个层指定不同的压缩级别，并控制数据移动的发生时间。</p>
                     <p>SQL <code class="codeph">CREATE</code>和<code class="codeph">ALTER</code> <code class="codeph">TABLE</code>语句的ILM子句使您可以为ADO创建，删除，启用或禁用策略。 ILM策略子句确定压缩或存储分层策略，并包含其他子句，例如<code class="codeph">AFTER</code>和<code class="codeph">ON</code>子句，用于指定策略操作发生时的条件。创建表时，可以为ADO添加新策略。您可以更改表以添加更多策略或启用，禁用或删除现有策略。您可以将策略添加到整个表或表的分区。将ADO策略添加到表的表或分区时，只能为<code class="codeph">AFTER</code>子句指定一种条件类型。ILM ADO策略被赋予系统生成的名称，例如<code class="codeph">P1</code> ， <code class="codeph">P2</code> ，等等到<code class="codeph">P</code> <span class="italic"><code class="codeph">n</code></span> 。
                     </p>
                     <p>段级别策略仅执行一次。策略成功执行后，它将被禁用，不会再次进行评估。但是，您可以再次明确启用该策略。行级策略继续执行，并且在成功执行后不会禁用。</p>
                     <p>可以使用关键字<code class="codeph">GROUP</code> ， <code class="codeph">ROW</code>或<code class="codeph">SEGMENT</code>为一组相关对象或段或行级别指定ADO策略的范围。</p>
                     <p>可应用于组策略的压缩的默认映射是：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>堆表上的<code class="codeph">COMPRESS</code> <code class="codeph">ADVANCED</code>映射到索引的标准压缩和LOB段的<code class="codeph">LOW</code> 。
                           </p>
                        </li>
                        <li>
                           <p>堆表上的<code class="codeph">COMPRESS</code> <code class="codeph">FOR</code> <code class="codeph">QUERY</code> <code class="codeph">LOW</code> / <code class="codeph">QUERY</code> <code class="codeph">HIGH</code>映射到索引的标准压缩和LOB段的<code class="codeph">MEDIUM</code> 。
                           </p>
                        </li>
                        <li>
                           <p>堆表上的<code class="codeph">COMPRESS</code> <code class="codeph">FOR</code> <code class="codeph">ARCHIVE</code> <code class="codeph">LOW</code> / <code class="codeph">ARCHIVE</code> <code class="codeph">HIGH</code>映射到索引的标准压缩和LOB段的<code class="codeph">HIGH</code> 。
                           </p>
                        </li>
                     </ul>
                     <p>压缩映射无法更改。<code class="codeph">GROUP</code>只能应用于细分级别策略。存储分层策略仅适用于段级别，不能在行级别指定。
                     </p>
                     <p>自动数据优化（ADO）支持具有<code class="codeph">INMEMORY</code> ， <code class="codeph">INMEMORY</code> <code class="codeph">MECOMPRESS</code>和<code class="codeph">NO</code> <code class="codeph">INMEMORY</code>策略类型的内存中列存储（IM列存储）。
                     </p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>要在In-Memory列存储中启用填充对象， <code class="codeph">INMEMORY</code>在<code class="codeph">ADD</code> <code class="codeph">POLICY</code>子句中包含<code class="codeph">INMEMORY</code> 。
                           </p>
                        </li>
                        <li>
                           <p>要增加IM列存储中对象的压缩级别， <code class="codeph">MEMCOMPRESS</code>在<code class="codeph">ADD</code> <code class="codeph">POLICY</code>子句中包含<code class="codeph">INMEMORY</code> <code class="codeph">MEMCOMPRESS</code> 。
                           </p>
                        </li>
                        <li>
                           <p>要明确驱逐从IM列存储中受益最少的对象， <code class="codeph">INMEMORY</code>在<code class="codeph">ADD</code> <code class="codeph">POLICY</code>子句中包含<code class="codeph">NO</code> <code class="codeph">INMEMORY</code> 。例如：</p>
                        </li>
                     </ul>
                     <p>以下是使用<code class="codeph">NO</code> <code class="codeph">INMEMORY</code>子句从IM列存储中逐出对象的示例。
                     </p><pre class="oac_no_warn" dir="ltr">ALTER TABLE sales_2015 ILM添加政策在没有访问的7天之后没有任何内容;</pre><p>具有内存中列存储子句的ADO策略只能是段级策略。<code class="codeph">USER/DBA_ILMDATAMOVEMENTPOLICIES</code>和<code class="codeph">V$HEAT_MAP_SEGMENT</code>视图包含有关内存中列存储的ADO策略的信息。<code class="codeph">V$IM_ADOTASKS</code>和<code class="codeph">V$IM_ADOTASKDETAILS</code>视图包含有关内存中列存储的ADO组件的操作的审核信息。
                     </p>
                     <p></p>
                     <p>您可以使用<code class="codeph">ON</code> <code class="codeph">PL/SQL_function</code>选项自定义策略，该选项可以确定何时应执行策略。<code class="codeph">ON</code> <code class="codeph">PL/SQL_function</code>选项仅适用于段级策略。例如：</p><pre class="oac_no_warn" dir="ltr">创建或替换函数my_custom_ado_rules（objn IN NUMBER）RETURN BOOLEAN; ALTER TABLE sales_custom ILM ADD政策压缩my_custom_ado_rules上的高级部分;</pre><div class="section">
                        <div class="infoboxnotealso" id="GUID-B011D86F-DCDE-4BF5-9C47-24B9650EFCA8__GUID-CB9B2149-A507-46BC-8940-267A8B3B6B68">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>有关内存中列存储和ADO支持的信息，请<a href="../inmem/configuring-memory-management.html#INMEM-GUID-562D95E0-0B2E-4B0A-A75E-C44052FB3BE1" target="_blank"><span><cite>参见“Oracle数据库内存指南”</cite></span></a></p>
                              </li>
                              <li>
                                 <p>有关SQL语句中ILM子句语法的信息，请<a href="../sqlrf/CREATE-TABLE.html#SQLRF01402" target="_blank"><span><cite>参见Oracle数据库SQL语言参考</cite></span></a></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="VLDBG14148"></a><div class="props_rev_3"><a id="GUID-8385C12B-DFB7-4407-81F7-64F9CAD5952D" name="GUID-8385C12B-DFB7-4407-81F7-64F9CAD5952D"></a><h4 id="VLDBG-GUID-8385C12B-DFB7-4407-81F7-64F9CAD5952D" class="sect4">使用ILM ADO策略创建表</h4>
                  <div>
                     <p>将<code class="codeph">ILM</code> <code class="codeph">ADD</code> <code class="codeph">POLICY</code>子句与<code class="codeph">CREATE</code> <code class="codeph">TABLE</code>语句一起使用以创建具有ILM ADO策略的表。
                     </p>
                     <div class="section">
                        <p><a href="ilm-strategy-heatmap-ado.html#GUID-8385C12B-DFB7-4407-81F7-64F9CAD5952D__CHDBEIAI">例5-3中</a>的SQL语句创建了一个表并添加了一个ILM策略。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-8385C12B-DFB7-4407-81F7-64F9CAD5952D__CHDBEIAI">
                        <p class="titleinexample">示例5-3使用ILM ADO策略创建表</p><pre class="oac_no_warn" dir="ltr">/ *创建一个带有ILM ADO策略的示例表* / CREATE TABLE sales_ado（PROD_ID NUMBER NOT NULL，CUST_ID NUMBER NOT NULL，TIME_ID DATE NOT NULL，CHANNEL_ID NUMBER NOT NULL，PROMO_ID NUMBER NOT NULL，QUANTITY_SOLD NUMBER（10,2）NOT NOT NULL，AMOUNT_SOLD NUMBER（10,2）NOT NULL）PARTITION BY RANGE（time_id）（PARTITION sales_q1_2012 VALUE少于（TO_DATE（'01 -APR-2012'，'dd-MON-yyyy'）），PARTITION sales_q2_2012 VALUE少于（TO_DATE（'01 -JUL-2012'，'dd-MON-yyyy'）），PARTITION sales_q3_2012价值不到（截止日期（'01 -OCT-2012'，'dd-MON-yyyy'）），PARTITION sales_q4_2012 VALUES不到（截止日期（'01 -JAN-2013'，'dd-MON-yyyy'）））ILM添加政策压缩在12个月无法访问之后存档的高级别; / *查看现有的ILM ADO策略* / SELECT SUBSTR（policy_name，1,24）POLICY_NAME，policy_type，启用FROM USER_ILMPOLICIES; POLICY_NAME POLICY_TYPE ENABLE ------------------------ ------------- ------ P1 DATA MOVEMENT YES</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="VLDBG14201"></a><div class="props_rev_3"><a id="GUID-DE4C9EB5-FBDC-4621-AA7B-17EBD11FBF27" name="GUID-DE4C9EB5-FBDC-4621-AA7B-17EBD11FBF27"></a><h4 id="VLDBG-GUID-DE4C9EB5-FBDC-4621-AA7B-17EBD11FBF27" class="sect4">添加ILM ADO策略</h4>
                  <div>
                     <p>将<code class="codeph">ILM</code> <code class="codeph">ADD</code> <code class="codeph">POLICY</code>子句与<code class="codeph">ALTER</code> <code class="codeph">TABLE</code>语句一起使用可将ILM ADO策略添加到表中。
                     </p>
                     <div class="section">
                        <p><a href="ilm-strategy-heatmap-ado.html#GUID-DE4C9EB5-FBDC-4621-AA7B-17EBD11FBF27__CHDBBJJG">例5-4中</a>的SQL语句提供了将ILM策略添加到<code class="codeph">sales</code>表的分区的示例。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-DE4C9EB5-FBDC-4621-AA7B-17EBD11FBF27__CHDBBJJG">
                        <p class="titleinexample">示例5-4添加ILM ADO策略</p><pre class="oac_no_warn" dir="ltr">/ *在没有修改30天后添加行级压缩策略* / ALTER TABLE sales MODIFY PARTITION sales_q1_2002 ILM ADD POLICY ROW STORE COMPRESS ADVANCED ROW在30天之后没有修改; / *在没有修改6个月后为数据添加段级别压缩策略* / ALTER TABLE销售修改分区sales_q1_2001 ILM添加政策压缩在未修改6个月后存档的高级别; / *在无法访问12个月后为数据添加段级别压缩策略* / ALTER TABLE销售修改分区sales_q1_2000 ILM ADD政策压缩为12个月后无法访问的存档高级别; / *添加存储层策略以将旧数据移动到低成本存储介质上的不同表空间* / / * * / ALTER TABLE sales MODIFY PARTITION sales_q1_1999 ILM ADD POLICY TIER TO my_low_cost_sales_tablespace; / *查看现有的策略* / SELECT SUBSTR（policy_name，1,24）POLICY_NAME，policy_type，启用FROM USER_ILMPOLICIES; POLICY_NAME POLICY_TYPE ENABLE ------------------------ ------------- ------ P1 DATA MOVEMENT YES P2 DATA MOVEMENT YES P3数据移动是P4数据移动是P5数据移动是</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="VLDBG14149"></a><div class="props_rev_3"><a id="GUID-811423E6-3F43-4B95-AF9E-119AC71FB0D0" name="GUID-811423E6-3F43-4B95-AF9E-119AC71FB0D0"></a><h4 id="VLDBG-GUID-811423E6-3F43-4B95-AF9E-119AC71FB0D0" class="sect4">禁用和删除ILM ADO策略</h4>
                  <div>
                     <p>将<code class="codeph">ILM</code> <code class="codeph">DISABLE</code> <code class="codeph">POLICY</code>或<code class="codeph">ILM</code> <code class="codeph">DELETE</code> <code class="codeph">POLICY</code>子句与<code class="codeph">ALTER</code> <code class="codeph">TABLE</code>语句一起使用可禁用或删除ILM ADO策略。
                     </p>
                     <div class="section">
                        <p>您可以禁用或删除ADO的ILM策略，如<a href="ilm-strategy-heatmap-ado.html#GUID-811423E6-3F43-4B95-AF9E-119AC71FB0D0__CHDDJJIJ">示例5-5</a>中的SQL语句所示。有时，如果这些策略与您要添加的新策略冲突，则可能需要删除现有的ILM策略。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-811423E6-3F43-4B95-AF9E-119AC71FB0D0__CHDDJJIJ">
                        <p class="titleinexample">示例5-5禁用和删除ILM ADO策略</p><pre class="oac_no_warn" dir="ltr">/ *您可以使用以下* / ALTER TABLE sales_ado ILM DISABLE POLICY P1禁用或删除表中的ADO策略; ALTER TABLE sales_ado ILM DELETE POLICY P1; / *您可以使用以下* / ALTER TABLE sales_ado ILM DISABLE_ALL禁用或删除表中的所有ADO策略; ALTER TABLE sales_ado ILM DELETE_ALL; / *您可以使用以下* / ALTER TABLE销售来禁用或删除分区中的ADO策略。销售修改分区sales_q1_2002 ILM DISABLE POLICY P2; ALTER TABLE销售MODIFY PARTITION sales_q1_2002 ILM DELETE POLICY P2; / *您可以使用以下内容禁用或删除分区中的所有ADO策略* / ALTER TABLE sales MODIFY PARTITION sales_q1_2000 ILM DISABLE_all; ALTER TABLE sales MODIFY PARTITION sales_q1_2000 ILM DELETE_ALL;</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="VLDBG14150"></a><a id="VLDBG14119"></a><div class="props_rev_3"><a id="GUID-DF9A2DDC-A5D3-4147-A2AB-DAE4C4FC99D7" name="GUID-DF9A2DDC-A5D3-4147-A2AB-DAE4C4FC99D7"></a><h4 id="VLDBG-GUID-DF9A2DDC-A5D3-4147-A2AB-DAE4C4FC99D7" class="sect4">使用ADO指定段级压缩和存储分层</h4>
                  <div>
                     <p>您可以使用段级压缩分层策略在表中的段级别指定压缩。</p>
                     <div class="section">
                        <p>结合行级压缩分层策略，您可以对数据库中数据的存储和管理方式进行细粒度控制。</p>
                        <p><a href="ilm-strategy-heatmap-ado.html#GUID-DF9A2DDC-A5D3-4147-A2AB-DAE4C4FC99D7__CHDJGECI">示例5-6</a>说明了如何为ADO创建策略以在<code class="codeph">sales_ado</code>表上实施压缩和存储分层策略，从而反映以下业务要求：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ol>
                           <li>
                              <p>批量加载数据</p>
                           </li>
                           <li>
                              <p>运行OLTP工作负载</p>
                           </li>
                           <li>
                              <p>六个月后没有更新，压缩存档高</p>
                           </li>
                           <li>
                              <p>转向低成本存储</p>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-DF9A2DDC-A5D3-4147-A2AB-DAE4C4FC99D7__CHDJGECI">
                        <p class="titleinexample">示例5-6使用段级压缩和存储分层</p><pre class="oac_no_warn" dir="ltr">/ *在6个月没有变化后添加段级别压缩策略* / ALTER TABLE sales_ado ILM ADD政策压缩为6个月后没有修改的存档高级别;表改变了。/ *添加存储层策略* / ALTER TABLE sales_ado ILM ADD POLICY TIER到my_low_cost_tablespace; SELECT SUBSTR（policy_name，1,24）POLICY_NAME，policy_type，已启用FROM USER_ILMPOLICIES; POLICY_NAME POLICY_TYPE ENABLED ------------------------ ------------- ------- ...P6数据移动是P7数据移动是</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="VLDBG14151"></a><a id="VLDBG14120"></a><div class="props_rev_3"><a id="GUID-B3543DEF-885D-483A-9167-F414834F6779" name="GUID-B3543DEF-885D-483A-9167-F414834F6779"></a><h4 id="VLDBG-GUID-B3543DEF-885D-483A-9167-F414834F6779" class="sect4">使用ADO指定行级压缩分层</h4>
                  <div>
                     <p>除基本和高级压缩外，自动数据优化（ADO）策略还支持混合列压缩（HCC）。</p>
                     <div class="section">
                        <p>无论表的压缩类型如何，都可以在任何表上定义HCC行级策略。当在段的其他部分存在DML活动时，来自冷块的行可以用HCC压缩。</p>
                        <p>对于非HCC表的HCC策略，如果行在HCC压缩单元（CU）中，则在更新期间可能存在行移动。此外，与行移动的其他用例类似，索引维护是更新引用已移动行的索引条目所必需的。</p>
                        <p>Oracle Database 12 <span class="italic">c</span>第1版（12.1）支持行级策略：但是，数据库必须具有12.2或更高的兼容性才能使用HCC行级压缩策略。
                        </p>
                        <div class="infoboxnotealso" id="GUID-B3543DEF-885D-483A-9167-F414834F6779__ORACLEDATABASEADMINISTRATORSGUIDEFO-01265F85">
                           <p class="notep1">也可以看看：</p>
                           <p>有关表压缩的信息，请参见<a href="../admin/managing-tables.html#ADMIN-GUID-34D15DD1-0925-4C9A-BE8A-3EE91671E526" target="_blank"><span><cite>“Oracle数据库管理员指南”</cite></span></a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-B3543DEF-885D-483A-9167-F414834F6779__GUID-0FEC5A84-D4AD-4028-B0D0-DC79E7806AD7">
                        <p class="titleinexample">示例5-7使用行级混合列压缩创建ADO策略</p>
                        <p><a href="ilm-strategy-heatmap-ado.html#GUID-B3543DEF-885D-483A-9167-F414834F6779__GUID-0FEC5A84-D4AD-4028-B0D0-DC79E7806AD7">例5-7中</a>的SQL语句在表<code class="codeph">employees_ilm</code>的行上使用HCC创建策略。
                        </p><pre class="oac_no_warn" dir="ltr">ALTER TABLE employees_ilm ILM ADD POLICY COLUMN STORE COMPRESS for FORERY ROW 30天后没有任何修改;</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-B3543DEF-885D-483A-9167-F414834F6779__CHDJFGGG">
                        <p class="titleinexample">示例5-8使用行级高级压缩创建ADO策略</p>
                        <p><a href="ilm-strategy-heatmap-ado.html#GUID-B3543DEF-885D-483A-9167-F414834F6779__CHDJFGGG">例5-8中</a>的SQL语句使用表<code class="codeph">sales_ado</code>的行创建一个使用高级压缩的策略。
                        </p><pre class="oac_no_warn" dir="ltr">ALTER TABLE sales_ado ILM ADD POLICY ROW STORE COMPRESS ADVANCED ROW在60天之后没有任何修改; SELECT policy_name，policy_type，启用FROM USER_ILMPOLICIES; POLICY_NAME POLICY_TYPE ENABLE ------------------------ ------------- ------- ...P8数据移动是</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="VLDBG14203"></a><a id="VLDBG14202"></a><div class="props_rev_3"><a id="GUID-1C87CC45-14E2-4AE0-849C-3324DF94A4EA" name="GUID-1C87CC45-14E2-4AE0-849C-3324DF94A4EA"></a><h4 id="VLDBG-GUID-1C87CC45-14E2-4AE0-849C-3324DF94A4EA" class="sect4">管理ILM ADO参数</h4>
                  <div>
                     <p>您可以<code class="codeph">CUSTOMIZE_ILM</code>在<code class="codeph">DBMS_ILM_ADMIN</code> PL / SQL包中<code class="codeph">CUSTOMIZE_ILM</code>过程设置的ILM ADO参数来自定义ADO环境。
                     </p>
                     <div class="section">
                        <p><a href="ilm-strategy-heatmap-ado.html#GUID-1C87CC45-14E2-4AE0-849C-3324DF94A4EA__CHDFBBCB" title="ILM与ADO相关的参数">表5-2</a>中描述了各种ILM ADO参数。
                        </p>
                        <div class="tblformalwide" id="GUID-1C87CC45-14E2-4AE0-849C-3324DF94A4EA__CHDFBBCB">
                           <p class="titleintable">表5-2 ILM ADO参数</p>
                           <table cellpadding="4" cellspacing="0" class="FormalWide" title="ILM ADO参数" width="100%" border="1" summary="ILM ADO-related parameters" frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="22%" id="d42519e1974">名称</th>
                                    <th align="left" valign="bottom" width="78%" id="d42519e1977">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="22%" id="d42519e1982" headers="d42519e1974 ">
                                       <p><code class="codeph">ABSOLUTE</code> <code class="codeph">JOB</code> <code class="codeph">LIMIT</code></p>
                                    </td>
                                    <td align="left" valign="top" width="78%" headers="d42519e1982 d42519e1977 ">
                                       <p><code class="codeph">ABSOLUTE</code> <code class="codeph">JOB</code> <code class="codeph">LIMIT</code>的值限制并发ADO作业的绝对数量。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="22%" id="d42519e2003" headers="d42519e1974 ">
                                       <p><code class="codeph">DEGREE</code> <code class="codeph">OF</code> <code class="codeph">PARALLELISM</code></p>
                                    </td>
                                    <td align="left" valign="top" width="78%" headers="d42519e2003 d42519e1977 ">
                                       <p><code class="codeph">DEGREE</code> <code class="codeph">OF</code> <code class="codeph">PARALLELISM</code>的值决定了ADO策略作业运行的并行度。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="22%" id="d42519e2024" headers="d42519e1974 ">
                                       <p><code class="codeph">启用</code></p>
                                    </td>
                                    <td align="left" valign="top" width="78%" headers="d42519e2024 d42519e1977 ">
                                       <p><code class="codeph">ENABLED</code>参数控制ADO后台评估和执行。默认设置为启用（ <code class="codeph">TRUE</code>或<code class="codeph">1</code> ）。
                                       </p>
                                       <p><code class="codeph">ENABLED</code>和<code class="codeph">HEAT_MAP</code>初始化参数的设置交互如下：</p>
                                       <ul style="list-style-type:disc">
                                          <li>
                                             <p>如果<code class="codeph">HEAT_MAP</code>初始化参数设置为<code class="codeph">ON</code>且<code class="codeph">ENABLED</code>参数设置为<code class="codeph">FALSE</code> （ <code class="codeph">0</code> ），则会收集热图统计信息，但ADO不会自动对统计信息执行操作。
                                             </p>
                                          </li>
                                          <li>
                                             <p>如果<code class="codeph">HEAT_MAP</code>初始化参数设置为<code class="codeph">OFF</code>并且<code class="codeph">ENABLED</code>参数设置为<code class="codeph">TRUE</code> （ <code class="codeph">1</code> ），则不会收集热图统计信息，并且由于ADO不能依赖热图统计信息，因此ADO不执行任何操作。ADO的行为就像<code class="codeph">ENABLED</code>设置为<code class="codeph">FALSE</code> 。</p>
                                          </li>
                                       </ul>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="22%" id="d42519e2093" headers="d42519e1974 ">
                                       <p><code class="codeph">EXECUTION</code> <code class="codeph">MODE</code></p>
                                    </td>
                                    <td align="left" valign="top" width="78%" headers="d42519e2093 d42519e1977 ">
                                       <p><code class="codeph">EXECUTION</code> <code class="codeph">MODE</code>的值控制ADO是在在线还是离线模式下执行。默认为在线（ <code class="codeph">2</code> ）。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="22%" id="d42519e2113" headers="d42519e1974 ">
                                       <p><code class="codeph">EXECUTION</code> <code class="codeph">INTERVAL</code></p>
                                    </td>
                                    <td align="left" valign="top" width="78%" headers="d42519e2113 d42519e1977 ">
                                       <p><code class="codeph">EXECUTION</code> <code class="codeph">INTERVAL</code>的值确定ADO启动后台评估的频率。默认值为<code class="codeph">15</code>分钟。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="22%" id="d42519e2133" headers="d42519e1974 ">
                                       <p><code class="codeph">JOB</code> <code class="codeph">LIMIT</code></p>
                                    </td>
                                    <td align="left" valign="top" width="78%" headers="d42519e2133 d42519e1977 ">
                                       <p><code class="codeph">JOB</code> <code class="codeph">LIMIT</code>的值随时控制ADO作业的最大数量。最大并发ADO作业数计算为（ <code class="codeph">JOB</code> <code class="codeph">LIMIT</code> ）*（实例数）*（每个实例的CPU数）。默认值为<code class="codeph">2</code> 。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="22%" id="d42519e2159" headers="d42519e1974 ">
                                       <p><code class="codeph">POLICY</code> <code class="codeph">TIME</code></p>
                                    </td>
                                    <td align="left" valign="top" width="78%" headers="d42519e2159 d42519e1977 ">
                                       <p><code class="codeph">POLICY</code> <code class="codeph">TIME</code>的值确定是否以秒或天指定ADO策略。<code class="codeph">1</code>表示秒或<code class="codeph">0</code>表示天（默认值）。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="22%" id="d42519e2182" headers="d42519e1974 ">
                                       <p><code class="codeph">RETENTION</code> <code class="codeph">TIME</code></p>
                                    </td>
                                    <td align="left" valign="top" width="78%" headers="d42519e2182 d42519e1977 ">
                                       <p><code class="codeph">RETENTION</code> <code class="codeph">TIME</code>的值指定在清除数据之前保留已完成的ADO任务的数据的时间长度。默认值为<code class="codeph">30</code>天。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="22%" id="d42519e2202" headers="d42519e1974 ">
                                       <p><code class="codeph">TBS</code> <code class="codeph">PERCENT</code> <code class="codeph">USED</code></p>
                                    </td>
                                    <td align="left" valign="top" width="78%" headers="d42519e2202 d42519e1977 ">
                                       <p><code class="codeph">TBS_PERCENT_USED</code>参数的值指定表空间被视为已满时表空间配额的百分比。默认值为<code class="codeph">85</code> ％。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="22%" id="d42519e2222" headers="d42519e1974 ">
                                       <p><code class="codeph">TBS</code> <code class="codeph">PERCENT</code> <code class="codeph">FREE</code></p>
                                    </td>
                                    <td align="left" valign="top" width="78%" headers="d42519e2222 d42519e1977 ">
                                       <p><code class="codeph">TBS_PERCENT_FREE</code>参数的值指定表空间的目标可用百分比。默认值为<code class="codeph">25</code> ％。
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                        <p>对于<code class="codeph">TBS_PERCENT</code> *参数的值，ADO尽最大努力，但不是保证。当表空间配额的百分比达到<code class="codeph">TBS_PERCENT_USED</code>的值时，ADO开始移动数据，以使表空间配额的百分比接近<code class="codeph">TBS_PERCENT_FREE</code>的值。例如，假设<code class="codeph">TBS_PERCENT_USED</code>设置为85并且<code class="codeph">TBS_PERCENT_FREE</code>设置为<code class="codeph">25</code> ，并且表空间变为<code class="codeph">90</code> ％已满。然后，ADO启动移动数据的操作，以便表空间配额至少有<code class="codeph">25</code> ％可用，这也可以解释为使用表空间配额的比例少于<code class="codeph">75</code> ％。
                        </p>
                        <p>您可以使用<code class="codeph">DBA_ILMPARAMETERS</code>视图显示参数。例如，以下查询显示ADO相关参数的值。
                        </p><pre class="oac_no_warn" dir="ltr">SQL&gt; SELECT NAME，VALUE FROM DBA_ILMPARAMETERS; -------------------------------------------------- -------------- ----------启用1保留时间30工时限制2执行模式2执行间隔15 TBS百分比使用85 TBS百分比25政策时间0绝对工作限制10度并行4 ...</pre><div class="infoboxnotealso" id="GUID-1C87CC45-14E2-4AE0-849C-3324DF94A4EA__GUID-46AA99C8-3D13-46E2-A6FD-1A187834E3AD">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><a href="ilm-strategy-heatmap-ado.html#GUID-EFA918BC-3430-486B-B936-C3DAA41572F0__CHDCGJEJ">示例5-9</a> ，显示如何<code class="codeph">CUSTOMIZE_ILM</code> <code class="codeph">DBMS_ILM_ADMIN</code> PL / SQL包中的<code class="codeph">CUSTOMIZE_ILM</code>过程设置ILM ADO参数的<code class="codeph">DBMS_ILM_ADMIN</code></p>
                              </li>
                              <li>
                                 <p><a href="heatmap-ado-em.html#GUID-94F6D36D-DEA5-442B-919C-3690CB89A072" title="您可以使用Oracle Enterprise Manager云控制来管理热图和自动数据优化。">使用Oracle Enterprise Manager管理ILM热图和ADO，</a>以获取有关使用Oracle Enterprise Manager云控制设置ILM ADO参数的信息</p>
                              </li>
                              <li>
                                 <p><a href="../arpls/DBMS_ILM_ADMIN.html#ARPLS74889" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a>有关ILM ADO参数的完整列表</p>
                              </li>
                              <li>
                                 <p>有关<code class="codeph">DBMS_ILM_ADMIN</code>包的信息，请<code class="codeph">DBMS_ILM_ADMIN</code> <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/vldbg&amp;id=ARPLS74887" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="VLDBG14204"></a><a id="VLDBG14122"></a><div class="props_rev_3"><a id="GUID-EFA918BC-3430-486B-B936-C3DAA41572F0" name="GUID-EFA918BC-3430-486B-B936-C3DAA41572F0"></a><h4 id="VLDBG-GUID-EFA918BC-3430-486B-B936-C3DAA41572F0" class="sect4">使用PL / SQL函数进行策略管理</h4>
                  <div>
                     <p>您可以使用PL / SQL <code class="codeph">DBMS_ILM</code>和<code class="codeph">DBMS_ILM_ADMIN</code>程序包进行高级策略管理和自定义，以实现更复杂的ADO方案，并控制策略何时主动移动和压缩数据。
                     </p>
                     <div class="section">
                        <p>使用PL / SQL <code class="codeph">DBMS_ILM</code>和<code class="codeph">DBMS_ILM_ADMIN</code>包，您可以管理ADO的ILM活动，以便它们不会对重要的生产工作负载产生负面影响。必须将数据库兼容性设置为最低12.0才能使用这些软件包。
                        </p>
                        <p><code class="codeph">DBMS_ILM</code>程序包的<code class="codeph">EXECUTE_ILM</code>过程创建并计划作业以强制执行ADO策略。无论先前调度的ILM作业如何， <code class="codeph">EXECUTE_ILM()</code>过程都提供此功能。创建所有作业并安排立即运行;但是，它们是否立即运行取决于使用调度程序排队的作业数。
                        </p>
                        <p>如果在执行ILM作业时需要更多控制，并且不想等到下一个维护窗口，则可以使用<code class="codeph">EXECUTE_ILM</code>过程。
                        </p>
                        <p>该<code class="codeph">STOP_ILM</code>的议事<code class="codeph">DBMS_ILM</code>包停止所有工作，所有正在运行的作业，作业基于任务ID，或特定的工作。
                        </p>
                        <p><code class="codeph">DBMS_ILM_ADMIN</code> PL / SQL包中的<code class="codeph">CUSTOMIZE_ILM</code>过程使您可以自定义ADO的设置，如<a href="ilm-strategy-heatmap-ado.html#GUID-EFA918BC-3430-486B-B936-C3DAA41572F0__CHDCGJEJ">例5-9</a>所示。
                        </p>
                        <p>例如，您可以设置<code class="codeph">TBS_PERCENT_USED</code>和<code class="codeph">TBS_PERCENT_FREE</code> ILM参数的值，或设置<code class="codeph">ABS_JOBLIMIT</code> ILM参数。<code class="codeph">TBS_PERCENT_USED</code>和<code class="codeph">TBS_PERCENT_FREE</code>根据表空间配额确定何时移动数据，并且<code class="codeph">ABS_JOBLIMIT</code>设置并发ADO作业的绝对数量。
                        </p>
                        <p>您还可以使用<code class="codeph">DBMS_METADATA</code> PL / SQL包重新创建包含策略的对象。
                        </p>
                        <div class="infoboxnotealso" id="GUID-EFA918BC-3430-486B-B936-C3DAA41572F0__GUID-21ACF689-E640-434B-9FEC-B68CEA50BD31">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><a href="ilm-strategy-heatmap-ado.html#GUID-1C87CC45-14E2-4AE0-849C-3324DF94A4EA" title="您可以使用在DBMS_ILM_ADMIN PL / SQL包中使用CUSTOMIZE_ILM过程设置的ILM ADO参数来自定义ADO环境。">管理ILM ADO参数</a>有关ILM ADO参数的信息</p>
                              </li>
                              <li>
                                 <p>有关<code class="codeph">DBMS_ILM</code> ， <code class="codeph">DBMS_ILM_ADMIN</code>和<code class="codeph">DBMS_METADATA</code>包的信息，请<code class="codeph">DBMS_ILM_ADMIN</code> <a href="../arpls/DBMS_ILM.html#ARPLS73513" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-EFA918BC-3430-486B-B936-C3DAA41572F0__CHDCGJEJ">
                        <p class="titleinexample">示例5-9使用CUSTOMIZE_ILM自定义ADO设置</p><pre class="oac_no_warn" dir="ltr">SQL&gt; BEGIN 2 DBMS_ILM_ADMIN.CUSTOMIZE_ILM（DBMS_ILM_ADMIN.TBS_PERCENT_USED，85）; 3 DBMS_ILM_ADMIN.CUSTOMIZE_ILM（DBMS_ILM_ADMIN.TBS_PERCENT_FREE，25）; 4结束; 5 / SQL&gt; BEGIN 2 DBMS_ILM_ADMIN.CUSTOMIZE_ILM（DBMS_ILM_ADMIN.ABS_JOBLIMIT，10）; 3结束; 4 /</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="VLDBG14123"></a><div class="props_rev_3"><a id="GUID-E97A72F8-C023-4C49-AC9F-D052F3B4586D" name="GUID-E97A72F8-C023-4C49-AC9F-D052F3B4586D"></a><h4 id="VLDBG-GUID-E97A72F8-C023-4C49-AC9F-D052F3B4586D" class="sect4">使用视图监视ADO的策略</h4>
                  <div>
                     <p>您可以使用<code class="codeph">DBA_ILM*</code>和<code class="codeph">USER_ILM*</code>视图查看和监视与数据库对象关联的ADO策略，从而可以根据需要更轻松地更改策略。
                     </p>
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">DBA/USER_ILMDATAMOVEMENTPOLICIES</code>视图显示特定于ADO的ILM策略的数据移动相关属性的信息。</p>
                           </li>
                           <li>
                              <p><code class="codeph">DBA/USER_ILMTASKS</code>视图显示过程<code class="codeph">EXECUTE_ILM</code>的任务ID。每次用户调用过程<code class="codeph">EXECUTE_ILM</code> ，都会返回任务ID以跟踪此特定调用。还生成任务ID以跟踪数据库的定期内部ILM任务。此视图包含有关ADO的所有ILM任务的信息。</p>
                           </li>
                           <li>
                              <p><code class="codeph">DBA/USER_ILMEVALUATIONDETAILS</code>视图显示针对特定任务考虑的策略的详细信息。它还显示在选择策略进行评估时执行策略的作业的名称。如果策略未执行，此视图也提供了一个原因。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">DBA/USER_ILMOBJECTS</code>视图显示数据库中ADO的所有对象和策略。许多对象通过其父对象继承策略，或者因为它们是在特定的表空间中创建的。此视图提供策略和对象之间的映射。对于继承的策略，此视图还指示继承策略的级别。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">DBA/USER_ILMPOLICIES</code>视图显示有关数据库中ADO的所有策略的详细信息。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">DBA/USER_ILMRESULTS</code>视图显示有关数据库中ADO的数据移动相关作业的信息。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">DBA_ILMPARAMETERS</code>视图显示有关ADO相关参数的信息。
                              </p>
                           </li>
                        </ul>
                        <div class="infoboxnotealso" id="GUID-E97A72F8-C023-4C49-AC9F-D052F3B4586D__GUID-A2F81537-7D7C-4744-AD98-AC25D3ACB1A2">
                           <p class="notep1">也可以看看：</p>
                           <p>有关<code class="codeph">ILM</code>视图的信息，请参阅<a href="../refrn/about-static-data-dictionary-views.html#REFRN002" target="_blank"><span><cite>Oracle数据库参考</cite></span></a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="VLDBG14152"></a><div class="props_rev_3"><a id="GUID-85EF8DD3-B372-4D5A-8941-FD7A0AF9C364" name="GUID-85EF8DD3-B372-4D5A-8941-FD7A0AF9C364"></a><h3 id="VLDBG-GUID-85EF8DD3-B372-4D5A-8941-FD7A0AF9C364" class="sect3">ADO和热图的限制和限制</h3>
               <div>
                  <p>本主题讨论了与ADO和热图相关的限制和限制。</p>
                  <p>与ADO和热图相关的限制和限制包括：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>对于时间有效性，支持分区级ADO和压缩，但行级ADO策略除外，这些策略将压缩超过其有效时间（访问或修改）的行。</p>
                     </li>
                     <li>
                        <p>如果在<code class="codeph">ORA_ARCHIVE_STATE</code>列上进行分区，则支持数据库内归档的分区级ADO和压缩。
                        </p>
                     </li>
                     <li>
                        <p>如果策略默认为表空间级别，则不支持ADO的自定义策略（用户定义的函数）。</p>
                     </li>
                     <li>
                        <p>使用存储分层时，ADO不会对目标表空间中的存储空间执行检查。</p>
                     </li>
                     <li>
                        <p>具有对象类型或物化视图的表不支持ADO。</p>
                     </li>
                     <li>
                        <p>索引组织表或集群不支持ADO。</p>
                     </li>
                     <li>
                        <p>ADO并发（ADO的并发策略作业数）取决于Oracle调度程序的并发性。如果ADO的策略作业失败超过两次，则作业将标记为已禁用，并且必须稍后手动启用该作业。</p>
                     </li>
                     <li>
                        <p>ADO具有与移动表和表分区相关的限制。</p>
                        <div class="infoboxnotealso" id="GUID-85EF8DD3-B372-4D5A-8941-FD7A0AF9C364__GUID-92C80724-CDC9-408E-BEFD-161588EC4F49">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>有关移动表限制的信息，请<a href="../sqlrf/ALTER-TABLE.html#SQLRF01001" target="_blank"><span><cite>参见Oracle数据库SQL语言参考</cite></span></a></p>
                              </li>
                              <li>
                                 <p>有关移动表分区限制的信息，请<a href="../sqlrf/ALTER-TABLE.html#SQLRF01001" target="_blank"><span><cite>参见Oracle数据库SQL语言参考</cite></span></a></p>
                              </li>
                           </ul>
                        </div>
                     </li>
                  </ul>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>