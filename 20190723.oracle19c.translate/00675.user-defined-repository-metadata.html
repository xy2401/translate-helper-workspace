<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="You can create your own metadata to associate with XML data stored in Oracle XML DB Repository."></meta>
      <meta name="description" content="You can create your own metadata to associate with XML data stored in Oracle XML DB Repository."></meta>
      <title>用户定义的存储库元数据</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Developer&#39;s Guide "></meta>
      <meta property="og:description" content="You can create your own metadata to associate with XML data stored in Oracle XML DB Repository."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Developer&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="xml-db-developers-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-03-30T12:32:42-07:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2002, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96222-03"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="repository-access-using-protocols.html" title="Previous" type="text/html"></link>
      <link rel="next" href="XML-DB-repository-events.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="XML DB Developer&#39;s Guide"></meta>
    <meta name="dcterms.isVersionOf" content="ADXDB"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="repository-access-using-protocols.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="XML-DB-repository-events.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">开发人员指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="XML-DB-repository.html" property="item" typeof="WebPage"><span property="name">Oracle XML DB存储库</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">用户定义的存储库元数据</li>
            </ol>
            <a id="GUID-74BCC51E-2E7C-4DB6-8DCF-F65122FE132E" name="GUID-74BCC51E-2E7C-4DB6-8DCF-F65122FE132E"></a><a id="ADXDB2560"></a>
            
            <h2 id="ADXDB-GUID-74BCC51E-2E7C-4DB6-8DCF-F65122FE132E" class="sect2"><span class="enumeration_chapter">29</span>用户定义的存储库元数据</h2>
         </header>
         <div class="ind">
            <div>
               <p>您可以创建自己的元数据以与存储在Oracle XML DB Repository中的XML数据相关联。</p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="user-defined-repository-metadata.html#GUID-812175D3-2558-4A84-A038-DF8FD932B7E6">元数据和XML概述</a><br>您使用的数据通常与不属于内容的其他信息相关联。要以不同方式处理它，您可以使用此类<strong class="term">元数据</strong>对<strong class="term">数据</strong>进行分组或分类。
                  </li>
                  <li class="ulchildlink"><a href="user-defined-repository-metadata.html#GUID-D299AF6E-5A5B-4757-B424-B558D0B5B227">使用XML模式定义资源元数据</a><br>在向照片资源添加用户元数据之前，必须使用XML Schema定义此类元数据的结构。为照片资源元数据的每种（技术，类别）创建并注册XML模式。
                  </li>
                  <li class="ulchildlink"><a href="user-defined-repository-metadata.html#GUID-351751BE-25B8-4F4A-9706-5D54A1D93D4C">资源元数据的添加，修改和删除</a><br>您可以使用包<code class="codeph">DBMS_XDB_REPOS</code> ，SQL DML语句<code class="codeph">INSERT</code> ， <code class="codeph">UPDATE</code>和<code class="codeph">DELETE</code>或WebDAV协议方法<code class="codeph">PROPPATCH</code> PL / SQL过程添加，更新和删除用户定义的资源元数据。</li>
                  <li class="ulchildlink"><a href="user-defined-repository-metadata.html#GUID-71218C70-98BE-4336-A63D-129A1B4BD30A">查询基于XML模式的资源元数据</a><br>您可以在查询资源元数据时使用元数据列<code class="codeph">RESID</code> ，以使用关联数据加入元数据。
                  </li>
                  <li class="ulchildlink"><a href="user-defined-repository-metadata.html#GUID-BB7CA0E0-E4A8-496C-BECF-46150BF27865">二进制图像元数据中的XML图像元数据</a><br>数码相机包括图像元数据作为它们产生的图像文件的一部分。
                  </li>
                  <li class="ulchildlink"><a href="user-defined-repository-metadata.html#GUID-9D74E515-7FB4-4FE4-B503-3F920AF3071C">添加基于非架构的资源元数据</a><br>您存储，是<span class="italic">不是</span>基于XML Schema作为用户定义的资源元数据<code class="codeph">CLOB</code>下实例<code class="codeph">Resource</code>相关的资源要素。
                  </li>
                  <li class="ulchildlink"><a href="user-defined-repository-metadata.html#GUID-C224ED8C-338C-41D5-B714-4B9D403E600E">PL / SQL程序影响资源元数据</a><br>您可以使用PL / SQL程序<code class="codeph">DBMS_XMLSCHEMA.registerSchema</code> ， <code class="codeph">DBMS_XDBZ.enable_hierarchy</code> ， <code class="codeph">DBMS_XDBZ.disable_hierarchy</code> ， <code class="codeph">DBMS_XDBZ.is_hierarchy_enabled</code> ， <code class="codeph">DBMS_XDB_REPOS.appendResourceMetadata</code> ， <code class="codeph">DBMS_XDB_REPOS.deleteResourceMetadata</code> ， <code class="codeph">DBMS_XDB_REPOS.purgeResourceMetadata</code>和<code class="codeph">DBMS_XDB_REPOS.updateResourceMetadata</code>执行资源元数据操作。
                  </li>
               </ul>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>父主题：</strong> <a href="XML-DB-repository.html#GUID-840EBE35-8FC8-4150-9FC8-78442FD1B12B" title="Oracle XML DB Repository允许您对数据进行版本控制，实现和管理安全性，并使用API来访问和操作存储库资源。">Oracle XML DB存储库</a></p>
                  </div>
               </div>
            </div>
            <a id="ADXDB5569"></a><div class="props_rev_3"><a id="GUID-812175D3-2558-4A84-A038-DF8FD932B7E6" name="GUID-812175D3-2558-4A84-A038-DF8FD932B7E6"></a><h3 id="ADXDB-GUID-812175D3-2558-4A84-A038-DF8FD932B7E6" class="sect3"><span class="enumeration_section">29.1</span>元数据和XML概述</h3>
               <div>
                  <p>您使用的数据通常与不属于内容的其他信息相关联。要以不同方式处理它，您可以使用此类<strong class="term">元数据</strong>对<strong class="term">数据</strong>进行分组或分类。
                  </p>
                  <p>例如，您可能拥有一组数码照片，您可能会将元数据与每张照片相关联，例如有关照片特征（颜色构成，焦距）或背景（位置，主题类型：风景，人物）的信息。</p>
                  <p>Oracle XML DB存储库<strong class="term">资源</strong>是包含元数据和数据的XML文档。数据是元素<code class="codeph">Contents</code> 。资源中的所有其他元素都包含元数据。资源的数据可以是XML，但不一定是。
                  </p>
                  <p>您可以将Oracle XML DB存储库中的资源与您定义的元数据相关联。除了此类<span class="italic">用户定义的元数据之外</span> ，每个存储库资源还具有Oracle XML DB自动创建并使用（透明地）管理资源的关联元数据。此类<span class="italic">系统定义的元数据</span>包括诸如每个资源的所有者和创建日期之类的属性。
                  </p>
                  <p>除系统定义的元数据外，您可以决定应将哪些资源信息视为数据，哪些资源信息应视为元数据。对于照片资源，关于照片的补充信息通常不被认为是照片数据的一部分，照片数据是二进制图像。但是，对于文本，您有时可以选择是否在资源内容（数据）中包含特定信息或将其保持独立并将其与内容作为元数据相关联 - 该选择通常受使用或生成数据的应用程序的影响。</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="user-defined-repository-metadata.html#GUID-A8AB40C5-A1ED-4FC5-8377-01EEA7A4E8FC">元数据的种类 - 术语的使用</a><br>术语“元数据”以各种方式在XML的上下文中使用，包括XML模式定义，XML标记和补充资源内容的Oracle XML DB存储库资源信息。
                     </li>
                     <li class="ulchildlink"><a href="user-defined-repository-metadata.html#GUID-CAE23F8E-CF58-429A-BF69-21B5F49C5E98">用户定义的资源元数据</a><br><span class="italic">用户定义的资源元数据</span>本身<span class="italic">表示为XML</span> ：它是与其他XML数据相关联的XML数据，描述它或提供补充的相关信息。
                     </li>
                     <li class="ulchildlink"><a href="user-defined-repository-metadata.html#GUID-24ED504A-B966-422A-8A8C-9CD94C85C8BA">场景：照片集的元数据</a><br>用于说明基于模式的资源元数据的使用的场景使用与存储在存储库资源中的摄影图像文件相关联的元数据。您可以创建任意数量的不同类型的元数据以与同一资源相关联。
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="user-defined-repository-metadata.html#GUID-74BCC51E-2E7C-4DB6-8DCF-F65122FE132E" title="您可以创建自己的元数据以与存储在Oracle XML DB Repository中的XML数据相关联。">用户定义的存储库元数据</a></p>
                     </div>
                  </div>
               </div>
               <a id="ADXDB5570"></a><div class="props_rev_3"><a id="GUID-A8AB40C5-A1ED-4FC5-8377-01EEA7A4E8FC" name="GUID-A8AB40C5-A1ED-4FC5-8377-01EEA7A4E8FC"></a><h4 id="ADXDB-GUID-A8AB40C5-A1ED-4FC5-8377-01EEA7A4E8FC" class="sect4"><span class="enumeration_section">29.1.1</span>元数据的种类 - 术语的使用</h4>
                  <div>
                     <p>术语“元数据”以各种方式在XML的上下文中使用，包括XML模式定义，XML标记和补充资源内容的Oracle XML DB存储库资源信息。</p>
                     <p>除资源元数据（系统定义和用户定义）外，术语“元数据”有时用于指代以下内容：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>XML <span class="italic">模式</span>是描述一类XML文档的元数据。
                           </p>
                        </li>
                        <li>
                           <p>XML <span class="italic">标记</span> （元素或属性名称）是用于标记和组织元素内容或属性值的元数据。
                           </p>
                        </li>
                     </ul>
                     <p>您可以通过以下任何方式将元数据与作为存储库资源内容的XML文档相关联：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>您可以将包含元数据信息的其他XML元素添加到资源<span class="italic">内容中</span> 。例如，您可以将数字图像数据包装在XML文档中，该文档还包含描述照片的元素。在这种情况下，数据及其元数据通过位于同一资源的内容中而相关联。应用程序将两者分开并正确关联它们。
                           </p>
                        </li>
                        <li>
                           <p>您可以将特定资源的元数据信息作为<span class="italic">单独资源</span>的内容添加到存储库。在这种情况下，应用程序将此资源视为元数据并将其与数据相关联。
                           </p>
                        </li>
                        <li>
                           <p>您可以将<span class="italic">资源的元</span>数据信息添加为存储库<span class="italic">资源元数据</span> 。在这种情况下，Oracle XML DB会识别元数据。应用程序可以通过查询存储库来<span class="italic">发现</span>此元数据。他们不需要单独告知其存在及其与数据的关联。
                           </p>
                        </li>
                     </ul>
                     <div class="section"></div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="accessing-XML-DB-repository-data.html#GUID-950100D2-51D0-490F-B82A-A0C45BCCE8AD" title="Oracle XML DB资源库资源符合Oracle XML DB XML架构XDBResource.xsd。资源中的元素包括持久存储WebDAV定义的属性所需的元素，例如创建日期，修改日期，WebDAV锁，所有者，ACL，语言和字符集。">Oracle XML DB资源库资源</a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="user-defined-repository-metadata.html#GUID-812175D3-2558-4A84-A038-DF8FD932B7E6" title="您使用的数据通常与不属于内容的其他信息相关联。要以不同方式处理它，您可以使用此类元数据对数据进行分组或分类。">元数据和XML概述</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="ADXDB5571"></a><div class="props_rev_3"><a id="GUID-CAE23F8E-CF58-429A-BF69-21B5F49C5E98" name="GUID-CAE23F8E-CF58-429A-BF69-21B5F49C5E98"></a><h4 id="ADXDB-GUID-CAE23F8E-CF58-429A-BF69-21B5F49C5E98" class="sect4"><span class="enumeration_section">29.1.2</span>用户定义的资源元数据</h4>
                  <div>
                     <p><span class="italic">用户定义的资源元数据</span>本身<span class="italic">表示为XML</span> ：它是与其他XML数据相关联的XML数据，描述它或提供补充的相关信息。
                     </p>
                     <p>用户定义的资源元数据可以是基于XML模式的，也可以不是：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><span class="italic">基于模式的</span>资源元数据存储在单独的（外联）表中。这些资源与资源OID相关，资源OID存储在元数据表的隐藏对象列<code class="codeph">RESID</code>中。
                           </p>
                        </li>
                        <li>
                           <p><span class="italic">不是</span>基于模式，即资源元数据被存储在资源表，资源文件的一部分<code class="codeph">XDB.XDB$RESOURCE</code> 。</p>
                        </li>
                     </ul>
                     <p>您可以利用基于模式的元数据，尤其是对资源执行高效查询和DML操作。在本章中，您将学习如何执行涉及基于模式的资源元数据的以下任务：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>创建并注册定义特定类型资源的元数据的<span class="italic">XML模式</span> 。
                           </p>
                        </li>
                        <li>
                           <p><span class="italic">将</span>元数据<span class="italic">添加</span>到存储库资源，并<span class="italic">更新</span> （修改）此类元数据。
                           </p>
                        </li>
                        <li>
                           <p><span class="italic">查询</span>资源元数据以查找关联的内容。
                           </p>
                        </li>
                        <li>
                           <p><span class="italic">删除</span>与资源关联的特定元数据，并<span class="italic">清除</span>与资源关联的所有元数据。
                           </p>
                        </li>
                     </ul>
                     <p>此外，您还将学习如何将非基于模式的元数据添加到资源。</p>
                     <p>您通常可以像使用资源数据一样使用用户定义的资源元数据。特别是，版本控制和访问控制管理适用。</p>
                     <p>资源元数据的典型用途包括工作流应用程序，强制用户权限管理，跟踪资源所有权以及控制资源有效性日期。</p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="user-defined-repository-metadata.html#GUID-812175D3-2558-4A84-A038-DF8FD932B7E6" title="您使用的数据通常与不属于内容的其他信息相关联。要以不同方式处理它，您可以使用此类元数据对数据进行分组或分类。">元数据和XML概述</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="ADXDB5572"></a><div class="props_rev_3"><a id="GUID-24ED504A-B966-422A-8A8C-9CD94C85C8BA" name="GUID-24ED504A-B966-422A-8A8C-9CD94C85C8BA"></a><h4 id="ADXDB-GUID-24ED504A-B966-422A-8A8C-9CD94C85C8BA" class="sect4"><span class="enumeration_section">29.1.3</span>场景：照片集的元数据</h4>
                  <div>
                     <p>用于说明基于模式的资源元数据的使用的场景使用与存储在存储库资源中的摄影图像文件相关联的元数据。您可以创建任意数量的不同类型的元数据以与同一资源相关联。</p>
                     <p>对于图像文件，示例创建元数据以获取有关以下内容的信息：1）照片的技术方面和2）照片主题或照片可能放置的用途。这两种关联的元数据用于查询照片资源。</p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="user-defined-repository-metadata.html#GUID-812175D3-2558-4A84-A038-DF8FD932B7E6" title="您使用的数据通常与不属于内容的其他信息相关联。要以不同方式处理它，您可以使用此类元数据对数据进行分组或分类。">元数据和XML概述</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="ADXDB5574"></a><a id="ADXDB5575"></a><a id="ADXDB5573"></a><div class="props_rev_3"><a id="GUID-D299AF6E-5A5B-4757-B424-B558D0B5B227" name="GUID-D299AF6E-5A5B-4757-B424-B558D0B5B227"></a><h3 id="ADXDB-GUID-D299AF6E-5A5B-4757-B424-B558D0B5B227" class="sect3"><span class="enumeration_section">29.2</span>使用XML模式定义资源元数据</h3>
               <div>
                  <p>在向照片资源添加用户元数据之前，必须使用XML Schema定义此类元数据的结构。为照片资源元数据的每种（技术，类别）创建并注册XML模式。</p>
                  <div class="section">
                     <div class="infoboxnotealso" id="GUID-D299AF6E-5A5B-4757-B424-B558D0B5B227__GUID-8BB4B7B5-9538-46CE-908D-16AC79E09828">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="user-defined-repository-metadata.html#GUID-24ED504A-B966-422A-8A8C-9CD94C85C8BA" title="用于说明基于模式的资源元数据的使用的场景使用与存储在存储库资源中的摄影图像文件相关联的元数据。您可以创建任意数量的不同类型的元数据以与同一资源相关联。">场景：照片集的元数据，</a>用于获取有关示例用户定义的元数据场景的一般信息</p>
                     </div>
                     <p><a href="user-defined-repository-metadata.html#GUID-D299AF6E-5A5B-4757-B424-B558D0B5B227__BABCEEAA">例29-1中</a>的XML模式定义了用于描述照片图像文件技术方面的元数据。它使用PL / SQL过程<code class="codeph">DBMS_XMLSCHEMA.registerSchema</code>来注册XML模式。要将此模式标识为定义存储库资源<span class="italic">元数据</span> ，它使用<code class="codeph">ENABLE_HIERARCHY_RESMETADATA</code>作为参数<code class="codeph">enableHierarchy</code>的值。资源内容（数据）是使用值<code class="codeph">ENABLE_HIERARCHY_CONTENTS</code> （默认值）定义的。
                     </p>
                     <p><a href="user-defined-repository-metadata.html#GUID-D299AF6E-5A5B-4757-B424-B558D0B5B227__BABCEEAA">例29-1</a>中定义的属性是图像高度，宽度，颜色深度，标题和简要说明。
                     </p>
                     <p><a href="user-defined-repository-metadata.html#GUID-D299AF6E-5A5B-4757-B424-B558D0B5B227__BABHHHFC">示例29-2中</a>的XML模式定义了用于对照片图像文件进行分类的元数据：描述其内容或可能的用途。这个简单的示例定义了一个名为<code class="codeph">Category</code>的单一通用属性。
                     </p>
                     <p>请注意，元数据的XML模式定义中没有任何内容限制该信息与任何特定类型的数据相关联。您可以将任何类型的元数据与任何类型的资源相关联。并且多种类型的元数据可以与同一资源相关联。</p>
                     <p>另请注意，XML模式本身并未将其关联数据定义为元数据 - 通过<code class="codeph">enableHierarchy</code>值<code class="codeph">ENABLE_HIERARCHY_RESMETADATA</code>进行此表征的模式<span class="italic">注册</span> 。如果使用<code class="codeph">enableHierarchy</code>值<code class="codeph">ENABLE_HIERARCHY_CONTENTS</code> （默认值）注册了相同的模式，那么它将不定义资源的元数据，而是定义具有相同信息的资源<span class="italic">内容</span> 。相同的XML模式不能在同一名称下多次注册。
                     </p>
                     <div class="infoboxnote" id="GUID-D299AF6E-5A5B-4757-B424-B558D0B5B227__GUID-2773A2E9-886B-4425-BB59-567D29899CE6">
                        <p class="notep1">注意：</p>
                        <p>默认情况下，如果用户元数据是基于XML模式的， <code class="codeph">CLOB</code>对象关系存储;如果是非基于XML模式，则作为<code class="codeph">CLOB</code>实例存储。您可以通过将XML模式注册的<code class="codeph">OPTIONS</code>参数设置为<code class="codeph">REGISTER_BINARYXML</code>来存储为二进制XML。</p>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-D299AF6E-5A5B-4757-B424-B558D0B5B227__BABCEEAA">
                     <p class="titleinexample">示例29-1为技术照片信息注册XML架构</p><pre class="oac_no_warn" dir="ltr">BEGIN DBMS_XMLSCHEMA.registerSchema（SCHEMAURL =&gt;' <span class="bold">imagetechnique.xsd</span> '，SCHEMADOC =&gt;'&lt;xsd：schema targetNamespace =“inamespace”xmlns：xsd =“http://www.w3.org/2001/XMLSchema”xmlns：xdb = “http://xmlns.oracle.com/xdb”xmlns =“inamespace”&gt; &lt;xsd：element name =“ <span class="bold">ImgTechMetadata</span> ”xdb：defaultTable =“ <span class="bold">IMGTECHMETADATATABLE</span> ”&gt; &lt;xsd：complexType&gt; &lt;xsd：sequence&gt; &lt;xsd：element name =“ <span class="bold">Height</span> ”type =“xsd：float”/&gt; &lt;xsd：element name =“ <span class="bold">Width</span> ”type =“xsd：float”/&gt; &lt;xsd：element name =“ <span class="bold">ColorDepth</span> ”type =“xsd：integer”/&gt; &lt;xsd：element name =“ <span class="bold">Title</span> ”type =“xsd：string”/&gt; &lt;xsd：element name =“ <span class="bold">Description</span> ”type =“xsd：string”/&gt; &lt;/ xsd：sequence&gt; &lt;/ xsd：complexType&gt; &lt;/ XSD：元件&gt; &lt;/ XSD：架构&gt;”，enableHierarchy =&gt; DBMS_XMLSCHEMA <span class="bold">ENABLE_HIERARCHY_RESMETADATA）;</span>结束; /</pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-D299AF6E-5A5B-4757-B424-B558D0B5B227__BABHHHFC">
                     <p class="titleinexample">示例29-2注册用于照片分类的XML模式</p><pre class="oac_no_warn" dir="ltr">BEGIN DBMS_XMLSCHEMA.registerSchema（SCHEMAURL =&gt;' <span class="bold">imagecategories.xsd</span> '，SCHEMADOC =&gt;'&lt;xsd：schema targetNamespace =“ <span class="bold">cnamespace</span> ”xmlns：xsd =“http://www.w3.org/2001/XMLSchema”xmlns：xdb = “http://xmlns.oracle.com/xdb”xmlns =“cnamespace”&gt; &lt;xsd：element name =“ <span class="bold">ImgCatMetadata</span> ”xdb：defaultTable =“ <span class="bold">IMGCATMETADATATABLE</span> ”&gt; &lt;xsd：complexType&gt; &lt;xsd：sequence&gt; &lt;xsd：element name =“ <span class="bold">Categories</span> ”type =“CategoriesType”/&gt; &lt;/ xsd：sequence&gt; &lt;/ xsd：complexType&gt; &lt;/ xsd：element&gt; &lt;xsd：complexType name =“CategoriesType”&gt; &lt;xsd：sequence&gt; &lt;xsd：element name =“ <span class="bold">Category</span> ”type =“xsd：string”maxOccurs =“unbounded”/&gt; &lt;/ xsd：sequence&gt; &lt;/ xsd：complexType&gt; &lt;/ xsd：schema&gt;'，enableHierarchy =&gt; DBMS_XMLSCHEMA.ENABLE_HIERARCHY_RESMETADATA）;结束; /</pre></div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="user-defined-repository-metadata.html#GUID-74BCC51E-2E7C-4DB6-8DCF-F65122FE132E" title="您可以创建自己的元数据以与存储在Oracle XML DB Repository中的XML数据相关联。">用户定义的存储库元数据</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="ADXDB5576"></a><div class="props_rev_3"><a id="GUID-351751BE-25B8-4F4A-9706-5D54A1D93D4C" name="GUID-351751BE-25B8-4F4A-9706-5D54A1D93D4C"></a><h3 id="ADXDB-GUID-351751BE-25B8-4F4A-9706-5D54A1D93D4C" class="sect3"><span class="enumeration_section">29.3</span>资源元数据的添加，修改和删除</h3>
               <div>
                  <p>您可以使用包<code class="codeph">DBMS_XDB_REPOS</code> ，SQL DML语句<code class="codeph">INSERT</code> ， <code class="codeph">UPDATE</code>和<code class="codeph">DELETE</code>或WebDAV协议方法<code class="codeph">PROPPATCH</code> PL / SQL过程添加，更新和删除用户定义的资源元数据。</p>
                  <p>您可以通过以下任何方式添加，更新和删除用户定义的资源元数据：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>在<code class="codeph">DBMS_XDB_REPOS</code>包中使用PL / SQL过程：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">appendResourceMetadata</code> - 向资源添加元数据</p>
                           </li>
                           <li>
                              <p><code class="codeph">updateResourceMetadata</code> - 修改资源元数据</p>
                           </li>
                           <li>
                              <p><code class="codeph">deleteResourceMetadata</code> - 从资源中删除特定元数据</p>
                           </li>
                           <li>
                              <p><code class="codeph">purgeResourceMetadata</code> - 从资源中删除<span class="italic">所有</span>元数据</p>
                           </li>
                        </ul>
                     </li>
                     <li>
                        <p>使用SQL DML语句<code class="codeph">INSERT</code> ， <code class="codeph">UPDATE</code>和<code class="codeph">DELETE</code>直接更新资源</p>
                     </li>
                     <li>
                        <p>使用WebDAV协议方法<code class="codeph">PROPPATCH</code></p>
                     </li>
                  </ul>
                  <p>您可以使用SQL DM语句和WebDAV方法<code class="codeph">PROPPATCH</code>以与添加元数据相同的方式更新或删除元数据。如果为其中一个操作提供完整的<code class="codeph">Resource</code>元素，请记住每个资源元数据属性必须是元素<code class="codeph">Resource</code>的子元素（不仅仅是子元素） - 如果您想要多个相同类型的元数据元素，则必须收集它们作为单个父元数据元素的子元素。此类顶级用户定义的资源元数据属性之间的顺序并不重要，并且不一定由Oracle XML DB维护。</p>
                  <p><code class="codeph">DBMS_XDB_REPOS</code>包中的单独PL / SQL过程的<code class="codeph">DBMS_XDB_REPOS</code>类似。每个都可以与基于XML模式或非基于模式的元数据一起使用。某些过程的某些表单（签名）仅适用于基于模式的元数据。程序<code class="codeph">appendResourceMetadata</code>和<code class="codeph">deleteResourceMetadata</code>在此处举例说明。
                  </p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="user-defined-repository-metadata.html#GUID-F2E53FE2-75E7-4CBE-AA66-D5A5176001F0">使用APPENDRESOURCEMETADATA添加元数据</a><br>您可以使用过程<code class="codeph">DBMS_XDB_REPOS.appendResourceMetadata</code>将用户定义的元数据添加到资源。
                     </li>
                     <li class="ulchildlink"><a href="user-defined-repository-metadata.html#GUID-15C67AA1-B53C-4B4E-A768-46236D528593">使用DELETERESOURCEMETADATA删除元数据</a><br>您可以使用过程<code class="codeph">DBMS_XDB_REPOS.deleteResourceMetadata</code>删除与资源关联的特定元数据。要删除与资源关联的<span class="italic">所有</span>元数据，可以使用过程<code class="codeph">DBMS_XDB_REPOS.purgeResourceMetadata</code> 。
                     </li>
                     <li class="ulchildlink"><a href="user-defined-repository-metadata.html#GUID-2A4F858D-D2C1-49AC-8A2C-87AA419D9596">使用SQL DML添加元数据</a><br>使用过程<code class="codeph">DBMS_XDB_REPOS.appendResourceMetadata</code>添加，更新或删除资源元数据的替代方法是使用DML语句<code class="codeph">INSERT</code>和<code class="codeph">UPDATE</code>直接更新<code class="codeph">RESOURCE_VIEW</code> 。</li>
                     <li class="ulchildlink"><a href="user-defined-repository-metadata.html#GUID-065AB9FE-AC85-4AA3-861E-A97AE739E1FD">使用WebDAV PROPPATCH添加元数据</a><br>使用过程<code class="codeph">DBMS_XDB_REPOS.appendResourceMetadata</code>添加资源元数据的替代方法是使用WebDAV方法<code class="codeph">PROPPATCH</code> 。</li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-351751BE-25B8-4F4A-9706-5D54A1D93D4C__GUID-A393D061-0F6B-4DE9-80B1-E209AA525198">
                     <p class="notep1">也可以看看：</p>
                     <p>有关PL / SQL包<code class="codeph">DBMS_XDB_REPOS</code>的过程的信息，请参阅<a href="../arpls/DBMS_XDB_REPOS.html#ARPLS74188" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="user-defined-repository-metadata.html#GUID-74BCC51E-2E7C-4DB6-8DCF-F65122FE132E" title="您可以创建自己的元数据以与存储在Oracle XML DB Repository中的XML数据相关联。">用户定义的存储库元数据</a></p>
                     </div>
                  </div>
               </div>
               <a id="ADXDB5578"></a><a id="ADXDB5579"></a><a id="ADXDB5577"></a><div class="props_rev_3"><a id="GUID-F2E53FE2-75E7-4CBE-AA66-D5A5176001F0" name="GUID-F2E53FE2-75E7-4CBE-AA66-D5A5176001F0"></a><h4 id="ADXDB-GUID-F2E53FE2-75E7-4CBE-AA66-D5A5176001F0" class="sect4"><span class="enumeration_section">29.3.1</span>使用APPENDRESOURCEMETADATA添加元数据</h4>
                  <div>
                     <p>您可以使用过程<code class="codeph">DBMS_XDB_REPOS.appendResourceMetadata</code>将用户定义的元数据添加到资源。
                     </p>
                     <div class="section">
                        <p><a href="user-defined-repository-metadata.html#GUID-F2E53FE2-75E7-4CBE-AA66-D5A5176001F0__CIACFBID">示例29-3</a>创建了一个照片资源，并向其添加了类型为<code class="codeph">ImgTechMetadata</code>的基于XML模式的元数据，记录了有关该照片的技术信息。
                        </p>
                        <p><a href="user-defined-repository-metadata.html#GUID-F2E53FE2-75E7-4CBE-AA66-D5A5176001F0__CIACDCJD">示例29-4</a>将类型为<code class="codeph">ImgTechMetadata</code>元数据添加到与<a href="user-defined-repository-metadata.html#GUID-F2E53FE2-75E7-4CBE-AA66-D5A5176001F0__CIACFBID">示例29-3</a>相同的资源中，将照片放在多个用户定义的内容类别中。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-F2E53FE2-75E7-4CBE-AA66-D5A5176001F0__CIACFBID">
                        <p class="titleinexample">示例29-3向资源添加元数据 - 技术照片信息</p><pre class="oac_no_warn" dir="ltr">DECLARE returnbool BOOLEAN; BEGIN returnbool：= DBMS_XDB_REPOS.createResource（'/ public /horse_with_pig.jpg'，bfilename（'MYDIR'，'horse_with_pig.jpg'））; DBMS_XDB_REPOS。 <span class="bold">appendResourceMetadata</span> （'/ public <span class="bold">/horse_with_pig.jpg'，XMLType（'&lt;i：ImgTechMetadata</span> xmlns：i =“inamespace”xmlns：xsi =“http://www.w3.org/2001/XMLSchema-instance”xsi：schemaLocation = “inamespace <span class="bold">imagetechnique.xsd</span> ”&gt; &lt;高度&gt; 1024 &lt;/高度&gt; &lt;宽度&gt; 768 &lt;/宽度&gt; &lt;ColorDepth&gt; 24 &lt;/ ColorDepth&gt; &lt;标题&gt;猪骑马&lt;/ Title&gt; &lt;描述&gt;骑猪的图片马在海滩上，在酒店窗外拍摄。&lt;/ Description&gt; &lt;/ i：ImgTechMetadata&gt;'））;结束; /</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-F2E53FE2-75E7-4CBE-AA66-D5A5176001F0__CIACDCJD">
                        <p class="titleinexample">示例29-4向资源添加元数据 - 照片内容类别</p><pre class="oac_no_warn" dir="ltr">BEGIN DBMS_XDB_REPOS.appendResourceMetadata（'/ public <span class="bold">/horse_with_pig.jpg'，XMLType（'&lt;c：ImgCatMetadata</span> xmlns：c =“cnamespace”xmlns：xsi =“http://www.w3.org/2001/XMLSchema-instance”xsi ：schemaLocation =“cnamespace <span class="bold">imagecategories.xsd</span> ”&gt; &lt;Categories&gt; &lt;Category&gt; Vacation &lt;/ Category&gt; &lt;Category&gt; Animals &lt;/ Category&gt; &lt;Category&gt;幽默&lt;/ Category&gt; &lt;Category&gt; 2005 &lt;/ Category&gt; &lt;/ Categories&gt; &lt; / C：ImgCatMetadata&gt;'））;结束; / PL / SQL过程成功完成。SELECT * FROM imgcatmetadatatable; SYS_NC_ROWINFO $ ------------------------------------------------ -------------------------------- &lt;c：ImgCatMetadata xmlns：c =“cnamespace”xmlns：xsi =“http： //www.w3.org/2001/XMLSche ma-instance“xsi：schemaLocation =”cnamespace imagecategories.xsd“&gt; &lt;Categories&gt; &lt;Category&gt; Vacation &lt;/ Category&gt; &lt;Category&gt; Animals &lt;/ Category&gt; &lt;Category&gt;幽默&lt; / Category&gt; &lt;Category&gt; 2005 &lt;/ Category&gt; &lt;/ Categories&gt; &lt;/ c：ImgCatMetadata&gt;选择了1行。</pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="user-defined-repository-metadata.html#GUID-351751BE-25B8-4F4A-9706-5D54A1D93D4C" title="您可以使用包DBMS_XDB_REPOS，SQL DML语句INSERT，UPDATE和DELETE或WebDAV协议方法PROPPATCH中的PL / SQL过程添加，更新和删除用户定义的资源元数据。">资源元数据的添加，修改和删除</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="ADXDB5581"></a><a id="ADXDB5580"></a><div class="props_rev_3"><a id="GUID-15C67AA1-B53C-4B4E-A768-46236D528593" name="GUID-15C67AA1-B53C-4B4E-A768-46236D528593"></a><h4 id="ADXDB-GUID-15C67AA1-B53C-4B4E-A768-46236D528593" class="sect4"><span class="enumeration_section">29.3.2</span>使用DELETERESOURCEMETADATA删除元数据</h4>
                  <div>
                     <p>您可以使用过程<code class="codeph">DBMS_XDB_REPOS.deleteResourceMetadata</code>删除与资源关联的特定元数据。要删除与资源关联的<span class="italic">所有</span>元数据，可以使用过程<code class="codeph">DBMS_XDB_REPOS.purgeResourceMetadata</code> 。
                     </p>
                     <div class="section">
                        <p><a href="user-defined-repository-metadata.html#GUID-15C67AA1-B53C-4B4E-A768-46236D528593__BABEJIGD">例29-5</a>删除了<a href="user-defined-repository-metadata.html#GUID-F2E53FE2-75E7-4CBE-AA66-D5A5176001F0__CIACDCJD">例29-4中</a>添加到照片资源的类别元数据。默认情况下，将删除元数据的资源链接（ <code class="codeph">REF</code> ）和该链接标识的元数据表。可选参数可用于指定仅删除链接。然后保留元数据表，但与资源无关。在此示例中，使用默认行为。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-15C67AA1-B53C-4B4E-A768-46236D528593__BABEJIGD">
                        <p class="titleinexample">示例29-5从资源中删除特定元数据</p><pre class="pre codeblock"><code>BEGIN DBMS_XDB_REPOS。 <span class="bold">deleteResourceMetadata</span> （'/public/horse_with_pig.jpg'，'cnamespace'，'ImgCatMetadata'）;结束; / PL / SQL过程成功完成。SELECT * FROM imgcatmetadatatable;没有选择任何行</code></pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="user-defined-repository-metadata.html#GUID-351751BE-25B8-4F4A-9706-5D54A1D93D4C" title="您可以使用包DBMS_XDB_REPOS，SQL DML语句INSERT，UPDATE和DELETE或WebDAV协议方法PROPPATCH中的PL / SQL过程添加，更新和删除用户定义的资源元数据。">资源元数据的添加，修改和删除</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="ADXDB5583"></a><a id="ADXDB5582"></a><div class="props_rev_3"><a id="GUID-2A4F858D-D2C1-49AC-8A2C-87AA419D9596" name="GUID-2A4F858D-D2C1-49AC-8A2C-87AA419D9596"></a><h4 id="ADXDB-GUID-2A4F858D-D2C1-49AC-8A2C-87AA419D9596" class="sect4"><span class="enumeration_section">29.3.3</span>使用SQL DML添加元数据</h4>
                  <div>
                     <p>使用过程<code class="codeph">DBMS_XDB_REPOS.appendResourceMetadata</code>添加，更新或删除资源元数据的替代方法是使用DML语句<code class="codeph">INSERT</code>和<code class="codeph">UPDATE</code>直接更新<code class="codeph">RESOURCE_VIEW</code> 。</p>
                     <div class="section">
                        <p><a href="user-defined-repository-metadata.html#GUID-2A4F858D-D2C1-49AC-8A2C-87AA419D9596__CIAGJEDB">例29-6</a>说明了以这种方式添加资源元数据。它通过使用SQL语句<code class="codeph">UPDATE</code>将元数据直接插入<code class="codeph">RESOURCE_VIEW</code>来说明如何完成与<a href="user-defined-repository-metadata.html#GUID-F2E53FE2-75E7-4CBE-AA66-D5A5176001F0__CIACFBID">例29-3</a>相同的<a href="user-defined-repository-metadata.html#GUID-F2E53FE2-75E7-4CBE-AA66-D5A5176001F0__CIACFBID">操作</a> 。可以类似地使用其他SQL DML语句。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-2A4F858D-D2C1-49AC-8A2C-87AA419D9596__CIAGJEDB">
                        <p class="titleinexample">示例29-6使用带有RESOURCE_VIEW的DML向元数据添加元数据</p><pre class="pre codeblock"><code>UPDATE RESOURCE_VIEW SET RES = XMLQuery（'declare namespace r =“http://xmlns.oracle.com/xdb/XDBResource.xsd”;（：:) declare namespace c =“cnamespace”;（：:) copy $ tmp：修改插入节点&lt;c：ImgCatMetadata xmlns：c =“cnamespace”xmlns：xsi =“http://www.w3.org/2001/XMLSchema-instance”xsi：schemaLocation =“cnamespace imagecategories.xsd”&gt; &lt;Categories &gt; &lt;Category&gt;假期&lt;/ Category&gt; &lt;Category&gt;动物&lt;/ Category&gt; &lt;Category&gt;幽默&lt;/ Category&gt; &lt;Category&gt; 2005 &lt;/ Category&gt; &lt;/ Categories&gt; &lt;/ c：ImgCatMetadata&gt; into $ tmp / r：Resource return $ tmp'PASSING RES RETURNING CONTENT）WHERE equals_path（RES，'/ public / horses_with_pig.jpg'）= 1; / SELECT * FROM imgcatmetadatatable; SYS_NC_ROWINFO $ ------------------------------------------------ -------------------------------- &lt;c：ImgCatMetadata xmlns：c =“cnamespace”xmlns：xsi =“http： //www.w3.org/2001/XMLSche ma-instance“xsi：schemaLocation =”cnamespace imagecategories.xsd“&gt; &lt;Categories&gt; &lt;Category&gt; Vacation &lt;/ Category&gt; &lt;Category&gt; Animals &lt;/ Category&gt; &lt;Category&gt;幽默&lt; / Category&gt; &lt;Category&gt; 2005 &lt;/ Category&gt; &lt;/ Categories&gt; &lt;/ c：ImgCatMetadata&gt;选择了1行。
</code></pre><p>以下查询使用<code class="codeph">RESOURCE_VIEW</code>提取插入的元数据，而不是直接使用元数据表<code class="codeph">imgcatmetadatatable</code> 。（为清楚起见，此处显示的结果非常清晰。）
                        </p><pre class="pre codeblock"><code>SELECT XMLQuery（'declare namespace r =“http://xmlns.oracle.com/xdb/XDBResource.xsd”;（：:) declare namespace c =“cnamespace”;（：:) / r：Resource / c：ImgCatMetadata来自RESOURCE_VIEW的'传递RES返回内容'WHERE equals_path（RES，'/ public / guard_with_pig.jpg'）= 1; XMLQUERY（'DECLARENAMESPACER =“HTTP://XMLNS.ORACLE.COM/XDB/XDBRESOURCE.XSD”;（：:) DE ---------------------- -------------------------------------------------- -------- &lt;c：ImgCatMetadata xmlns：c =“cnamespace”xmlns：xsi =“http://www.w3.org/2001/XMLSchema-instance”xsi：schemaLocation =“cnamespace imagecategories.xsd” &gt; &lt;Categories&gt; &lt;Category&gt; Vacation &lt;/ Category&gt; &lt;Category&gt; Animals &lt;/ Category&gt; &lt;Category&gt; Humor &lt;/ Category&gt; &lt;Category&gt; 2005 &lt;/ Category&gt; &lt;/ Categories&gt; &lt;/ c：ImgCatMetadata&gt;选择1行。</code></pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="user-defined-repository-metadata.html#GUID-351751BE-25B8-4F4A-9706-5D54A1D93D4C" title="您可以使用包DBMS_XDB_REPOS，SQL DML语句INSERT，UPDATE和DELETE或WebDAV协议方法PROPPATCH中的PL / SQL过程添加，更新和删除用户定义的资源元数据。">资源元数据的添加，修改和删除</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="ADXDB5584"></a><a id="ADXDB2565"></a><div class="props_rev_3"><a id="GUID-065AB9FE-AC85-4AA3-861E-A97AE739E1FD" name="GUID-065AB9FE-AC85-4AA3-861E-A97AE739E1FD"></a><h4 id="ADXDB-GUID-065AB9FE-AC85-4AA3-861E-A97AE739E1FD" class="sect4"><span class="enumeration_section">29.3.4</span>使用WebDAV PROPPATCH添加元数据</h4>
                  <div>
                     <p>使用过程<code class="codeph">DBMS_XDB_REPOS.appendResourceMetadata</code>添加资源元数据的替代方法是使用WebDAV方法<code class="codeph">PROPPATCH</code> 。</p>
                     <div class="section">
                        <p>这在<a href="user-defined-repository-metadata.html#GUID-065AB9FE-AC85-4AA3-861E-A97AE739E1FD__CIAJIIEF">例29-7中</a>说明。您可以类似地更新和删除元数据。
                        </p>
                        <p><a href="user-defined-repository-metadata.html#GUID-065AB9FE-AC85-4AA3-861E-A97AE739E1FD__CIAJIIEF">例29-7</a>显示了如何通过使用WebDAV方法<code class="codeph">PROPPATCH</code>插入元数据来完成与<a href="user-defined-repository-metadata.html#GUID-F2E53FE2-75E7-4CBE-AA66-D5A5176001F0__CIACDCJD">例子29-4</a>相同的<a href="user-defined-repository-metadata.html#GUID-F2E53FE2-75E7-4CBE-AA66-D5A5176001F0__CIACDCJD">操作</a> 。使用适当的工具，您的应用程序会创建这样一个<code class="codeph">PROPPATCH</code> WebDAV请求，并将其发送到WebDAV服务器进行处理。
                        </p>
                        <p>要更新用户定义的元数据，请以相同的方式继续。要<span class="italic">删除</span>用户定义的元数据，WebDAV请求类似，但它有<code class="codeph">D:remove</code>代替<code class="codeph">D:set</code> 。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-065AB9FE-AC85-4AA3-861E-A97AE739E1FD__CIAJIIEF">
                        <p class="titleinexample">示例29-7使用WebDAV PROPPATCH添加元数据</p><pre class="pre codeblock"><code>PROPPATCH /public/horse_with_pig.jpg HTTP / 1.1主机：www.example.com Content-Type：text / xml; charset =“utf-8”内容长度：609授权：基本dGRhZHhkYl9tZXRhOnRkYWR4ZGJfbWV0YQ ==连接：关闭&lt;？xml version =“1.0”encoding =“utf-8”？&gt; &lt;D： <span class="bold">propertyupdate</span> xmlns：D =“ <span class="bold">DAV：</span> ”xmlns：Z =“http://www.w3.com/standards/z39.50/”&gt; &lt;D： <span class="bold">set</span> &gt; &lt;D： <span class="bold">prop</span> &gt; &lt;c：ImgCatMetadata xmlns：c =“cnamespace”xmlns：xsi =“http://www.w3.org/2001/XMLSchema-instance”xsi：schemaLocation =“cnamespace imagecategories.xsd”&gt; &lt;Categories&gt; &lt;Category&gt; Vacation &lt;/ Category&gt; &lt;Category&gt;动物&lt;/ Category&gt; &lt;Category&gt;幽默&lt;/ Category&gt; &lt;Category&gt; 2005 &lt;/ Category&gt; &lt;/ Categories&gt; &lt;/ c：ImgCatMetadata&gt; &lt;/ D：prop&gt; &lt;/ D：set&gt; &lt;/ D： propertyupdate&gt;</code></pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="user-defined-repository-metadata.html#GUID-351751BE-25B8-4F4A-9706-5D54A1D93D4C" title="您可以使用包DBMS_XDB_REPOS，SQL DML语句INSERT，UPDATE和DELETE或WebDAV协议方法PROPPATCH中的PL / SQL过程添加，更新和删除用户定义的资源元数据。">资源元数据的添加，修改和删除</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="ADXDB5586"></a><a id="ADXDB5585"></a><div class="props_rev_3"><a id="GUID-71218C70-98BE-4336-A63D-129A1B4BD30A" name="GUID-71218C70-98BE-4336-A63D-129A1B4BD30A"></a><h3 id="ADXDB-GUID-71218C70-98BE-4336-A63D-129A1B4BD30A" class="sect3"><span class="enumeration_section">29.4</span>查询基于XML模式的资源元数据</h3>
               <div>
                  <p>您可以在查询资源元数据时使用元数据列<code class="codeph">RESID</code> ，以使用关联数据加入元数据。
                  </p>
                  <div class="section">
                     <p>使用<code class="codeph">enableHierarchy</code>值<code class="codeph">ENABLE_HIERARCHY_RESMETADATA</code>注册XML模式时，会自动将另一列<code class="codeph">RESID</code>添加到用于存储元数据的<code class="codeph">XMLType</code>表中。此列存储与元数据关联的资源的对象标识符（OID）。查询元数据时可以使用列<code class="codeph">RESID</code> ，以使用关联数据加入元数据。
                     </p>
                     <p>您可以通过以下方式查询元数据：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type:disc">
                        <li>
                           <p>查询<code class="codeph">RESOURCE_VIEW</code>以获取元数据。例如：</p><pre class="pre codeblock"><code>SELECT count（*）FROM RESOURCE_VIEW WHERE XMLExists（'declare namespace r =“http://xmlns.oracle.com/xdb/XDBResource.xsd”;（：:) declare namespace c =“cnamespace”;（：:) / r：资源/ c：ImgCatMetadata / Categories / Category [text（）=“Vacation”]'PASSING RES）; COUNT（*）----------选择了1行。
</code></pre></li>
                        <li>
                           <p>直接在基于XML模式的表中查询用户定义的元数据，并将此元数据连接回资源表，确定要选择的资源。使用元数据表的列<code class="codeph">RESID</code>执行此操作。例如：</p><pre class="pre codeblock"><code>SELECT COUNT（*）FROM RESOURCE_VIEW rs， <span class="bold">imgcatmetadatatable ct</span> WHERE XMLExists（'declare namespace r =“http://xmlns.oracle.com/xdb/XDBResource.xsd”;（：:) declare namespace c =“cnamespace”;（ ：:) / r：资源/ c：ImgCatMetadata / Categories / Category'PASSING RES）和<span class="bold">rs。RESID = ct。RESID</span> ; COUNT（*）----------选择了1行。
</code></pre></li>
                     </ul>
                     <p>出于性能原因，Oracle建议直接查询用户定义的元数据。所述的直接查询<code class="codeph">RESOURCE_VIEW</code> <span class="italic">不能</span>单独使用XPath重写<span class="italic">进行优化</span> ，因为没有办法确定是否指定类似的元件<code class="codeph">Category</code>被存储在<code class="codeph">CLOB</code>值或外的线的表。
                     </p>
                     <p>要进一步提高性能，请在要查询的每个元数据列上创建索引。</p>
                     <p><a href="user-defined-repository-metadata.html#GUID-71218C70-98BE-4336-A63D-129A1B4BD30A__BABEHBGB">示例29-8</a>查询两种照片资源元数据，检索被分类为度假照片的资源的路径并且具有标题“Pig Riding Horse”。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-71218C70-98BE-4336-A63D-129A1B4BD30A__BABEHBGB">
                     <p class="titleinexample">示例29-8查询基于XML模式的资源元数据</p><pre class="pre codeblock"><code>SELECT ANY_PATH FROM RESOURCE_VIEW rs，imgcatmetadatatable ct，imgtechmetadatatable tt WHERE XMLExists（'declare namespace r =“http://xmlns.oracle.com/xdb/XDBResource.xsd”;（：:) declare namespace c =“cnamespace”;（ ：:) / r：资源/ c：ImgCatMetadata / Categories / Category [text（）=“Vacation”]'PASSING RES）和XMLExists（'declare namespace r =“http://xmlns.oracle.com/xdb/XDBResource .xsd“;（：:)声明命名空间i =”inamespace“;（：:) / r：资源/ i：ImgTechMetadata / Title [text（）=”Pig Riding Horse“]'PASSING RES）和rs。RESID = ct。RESID和rs。RESID = tt。渣油; ANY_PATH -------------------------- /public/horse_with_pig.jpg选择了1行。</code></pre></div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="user-defined-repository-metadata.html#GUID-74BCC51E-2E7C-4DB6-8DCF-F65122FE132E" title="您可以创建自己的元数据以与存储在Oracle XML DB Repository中的XML数据相关联。">用户定义的存储库元数据</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="ADXDB5587"></a><div class="props_rev_3"><a id="GUID-BB7CA0E0-E4A8-496C-BECF-46150BF27865" name="GUID-BB7CA0E0-E4A8-496C-BECF-46150BF27865"></a><h3 id="ADXDB-GUID-BB7CA0E0-E4A8-496C-BECF-46150BF27865" class="sect3"><span class="enumeration_section">29.5</span>二进制图像元数据的XML图像元数据</h3>
               <div>
                  <p>数码相机包括图像元数据作为它们产生的图像文件的一部分。</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>EXIF  - 可交换图像文件格式</p>
                     </li>
                     <li>
                        <p>IPTC-NAA IIM  - 国际新闻电信委员会 - 美国报业协会信息交换模型</p>
                     </li>
                     <li>
                        <p>XMP  - 可扩展元数据平台</p>
                     </li>
                  </ul>
                  <p>EXIF是数码相机的元数据标准。EXIF元数据存储在TIFF和JPEG图像文件中。IPTC和XMP元数据通常由桌面图像处理软件嵌入到图像文件中。</p>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="user-defined-repository-metadata.html#GUID-74BCC51E-2E7C-4DB6-8DCF-F65122FE132E" title="您可以创建自己的元数据以与存储在Oracle XML DB Repository中的XML数据相关联。">用户定义的存储库元数据</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="ADXDB5589"></a><a id="ADXDB5588"></a><div class="props_rev_3"><a id="GUID-9D74E515-7FB4-4FE4-B503-3F920AF3071C" name="GUID-9D74E515-7FB4-4FE4-B503-3F920AF3071C"></a><h3 id="ADXDB-GUID-9D74E515-7FB4-4FE4-B503-3F920AF3071C" class="sect3"><span class="enumeration_section">29.6</span>添加基于非模式的资源元数据</h3>
               <div>
                  <p>您存储，是<span class="italic">不是</span>基于XML Schema作为用户定义的资源元数据<code class="codeph">CLOB</code>下实例<code class="codeph">Resource</code>相关的资源要素。
                  </p>
                  <div class="section">
                     <p>资源的默认XML模式具有顶级元素<span class="bold"><code class="codeph">any</code></span> （使用<code class="codeph">maxOccurs= "unbounded"</code> ），它允许任何有效的XML数据作为资源表<code class="codeph">XDB.XDB$RESOURCE</code>资源文档的一部分。</p>
                     <p>以下框架显示了非基于模式的资源元数据的结构和位置：</p><pre class="pre codeblock"><code>&lt;资源xmlns =“http://xmlns.oracle.com/xdb/XDBResource.xsd”&lt;所有者&gt; DESELBY &lt;/ Owner&gt; ... &lt;！ - 其他系统定义的元数据 - &gt; &lt;！ - 内容资源&gt; &lt;目录&gt; ...&lt;/ Contents&gt; &lt;！ - 用户定义的元数据（出现在不同的命名空间中） - &gt; <span class="bold">&lt;MyOwnMetadata xmlns =“http://www.example.com/custommetadata”&gt;</span> <span class="bold">&lt;MyElement1&gt; value1 &lt;/ MyElement1&gt;</span> <span class="bold">&lt;MyElement2&gt; value2 &lt;/ MyElement2&gt;</span> <span class="bold">&lt;/ MyOwnMetadata&gt;</span> &lt;/ Resource&gt;</code></pre><p>您可以使用前面介绍的用于访问基于XML模式的资源元数据的任何方法来设置和访问属于除<code class="codeph">XDBResource.xsd</code>的命名空间的非基于模式的资源元数据。
                     </p>
                     <p><a href="user-defined-repository-metadata.html#GUID-9D74E515-7FB4-4FE4-B503-3F920AF3071C__BABEDFFF">例29-9</a>说明了SQL DML操作的情况，将用户定义的元数据直接添加到<code class="codeph">&lt;RESOURCE&gt;</code> <span class="italic">文档</span> 。它显示了如何使用SQL DML将非基于模式的元数据添加到资源。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-9D74E515-7FB4-4FE4-B503-3F920AF3071C__BABEDFFF">
                     <p class="titleinexample">示例29-9将非基于模式的元数据添加到资源</p><pre class="pre codeblock"><code>DECLARE res BOOLEAN; BEGIN res：= DBMS_XDB_REPOS.createResource（'/ public / NurseryRhyme.txt'，bfilename（'MYDIR'，'tdadxdb-xdb_repos_meta-011.txt'），nls_charset_id（'AL32UTF8'））; UPDATE RESOURCE_VIEW SET RES = XMLQuery（'declare namespace r =“http://xmlns.oracle.com/xdb/XDBResource.xsd”;（：:) declare namespace n =“nurserynamespace”;（：:) copy $ tmp： =。修改插入节点&lt;n：NurseryMetadata&gt; &lt;Author&gt; Mother Goose &lt;/ Author&gt; &lt;/ n：NurseryMetadata&gt;到$ tmp / r：资源返回$ tmp'PASSING RES RETURNING CONTENT）WHERE equals_path（RES，'/ public / NurseryRhyme.txt'）= 1;结束; / PL / SQL过程成功完成。SELECT XMLSerialize（DOCUMENT rs。RES AS CLOB）FROM RESOURCE_VIEW rs WHERE equals_path（RES，'/ public / NurseryRhyme.txt'）= 1; XMLSERIALIZE（DOCUMENTRS.RESASCLOB）-------------------------------------------- ------------------------------------ &lt;Resource xmlns =“http://xmlns.oracle.com /xdb/XDBResource.xsd“Hidden =”false“Inv alid =”false“Container =”false“CustomRslv =”false“VersionHistory =”false“StickyR ef =”true“&gt; &lt;CreationDate&gt; 2005-05-24T13：51 ：48.043234 &lt;/ CreationDate&gt; &lt;ModificationDate&gt; 2005-05-24T13：51：48.290144 &lt;/ ModificationDate&gt; &lt;DisplayName&gt; NurseryRhyme.txt &lt;/ DisplayName&gt; &lt;Language&gt; en-US &lt;/ Language&gt; &lt;CharacterSet&gt; UTF-8 &lt;/ CharacterSet&gt; &lt;ContentType&gt; text / plain &lt;/ ContentType&gt; &lt;RefCount&gt; 1 &lt;/ RefCount&gt; &lt;ACL&gt; &lt;acl description =“Public：PUBLIC的所有权限”xmlns =“http：//xmlns.oracl e.com/xdb /acl.xsd“xmlns：xsi =”http://www.w3.org/2001/XMLSchema-instance“xsi：sch emaLocation =”http://xmlns.oracle.com/xdb/acl.xsd http：/ /xmlns.oracle.com/xdb/acl.xsd“shared =”true“&gt; &lt;ace&gt; &lt;principal&gt; PUBLIC &lt;/ principal&gt; &lt;grant&gt; true &lt;/ grant&gt; &lt;privilege&gt; &lt;all /&gt; &lt;/ privilege&gt; &lt; / ace&gt; &lt;/ acl&gt; &lt;/ ACL&gt; &lt;Owner&gt; TDADXDB_META &lt;/ Owner&gt; &lt;Creator&gt; TDADXDB_META &lt;/ Creator&gt; &lt;LastModifier&gt; TDADXDB_META &lt;/ LastModifier&gt; &lt;SchemaElement&gt; http://xmlns.oracle.com/xdb/XDBSchema.xsd#text &lt;/ SchemaElement&gt; &lt;Contents&gt; &lt;text&gt;玛丽有一只小羊羔它的羊毛是白色如雪，玛丽去的地方，羊羔肯定要去&lt;/ text&gt; &lt;/ Contents&gt; &lt;n：NurseryMetadata xmlns：n =“nurserynamespace”&gt; &lt;作者xmlns =“”&gt;鹅妈妈&lt;/ Author&gt; &lt;/ n ：NurseryMetadata&gt; &lt;/ Resource&gt;选择1行。</code></pre></div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="user-defined-repository-metadata.html#GUID-74BCC51E-2E7C-4DB6-8DCF-F65122FE132E" title="您可以创建自己的元数据以与存储在Oracle XML DB Repository中的XML数据相关联。">用户定义的存储库元数据</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="ADXDB5590"></a><div class="props_rev_3"><a id="GUID-C224ED8C-338C-41D5-B714-4B9D403E600E" name="GUID-C224ED8C-338C-41D5-B714-4B9D403E600E"></a><h3 id="ADXDB-GUID-C224ED8C-338C-41D5-B714-4B9D403E600E" class="sect3"><span class="enumeration_section">29.7</span>影响资源元数据的PL / SQL过程</h3>
               <div>
                  <p>您可以使用PL / SQL程序<code class="codeph">DBMS_XMLSCHEMA.registerSchema</code> ， <code class="codeph">DBMS_XDBZ.enable_hierarchy</code> ， <code class="codeph">DBMS_XDBZ.disable_hierarchy</code> ， <code class="codeph">DBMS_XDBZ.is_hierarchy_enabled</code> ， <code class="codeph">DBMS_XDB_REPOS.appendResourceMetadata</code> ， <code class="codeph">DBMS_XDB_REPOS.deleteResourceMetadata</code> ， <code class="codeph">DBMS_XDB_REPOS.purgeResourceMetadata</code>和<code class="codeph">DBMS_XDB_REPOS.updateResourceMetadata</code>执行资源元数据操作。
                  </p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><code class="codeph">DBMS_XMLSCHEMA.registerSchema</code> - 注册XML模式。参数<code class="codeph">ENABLEHIERARCHY</code>会影响资源元数据。
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">DBMS_XDBZ.enable_hierarchy</code> - 为<code class="codeph">XMLType</code>表或视图启用存储库支持。使用参数<code class="codeph">HIERARCHY_TYPE</code> ，其值为<code class="codeph">DBMS_XDBZ.ENABLE_HIERARCHY_RESMETADATA</code>以启用资源元数据。这会添加列<code class="codeph">RESID</code>以跟踪与元数据关联的资源。
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">DBMS_XDBZ.disable_hierarchy</code> - 禁用<code class="codeph">XMLType</code>表或视图的所有存储库支持。
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">DBMS_XDBZ.is_hierarchy_enabled</code> - 使用参数<code class="codeph">HIERARCHY_TYPE</code>测试当前是否为指定的<code class="codeph">XMLType</code>表或视图启用了指定的层次结构类型。<code class="codeph">HIERARCHY_TYPE</code>值<code class="codeph">DBMS_XDBZ.IS_ENABLED_RESMETADATA</code>测试是否启用了资源元数据。
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">DBMS_XDB_REPOS.appendResourceMetadata</code> - 向资源添加元数据。
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">DBMS_XDB_REPOS.deleteResourceMetadata</code> - 从资源中删除指定的元数据。
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">DBMS_XDB_REPOS.purgeResourceMetadata</code> - 从资源中删除所有用户定义的元数据。对于基于模式的资源，除了取消链接之外，可以使用可选参数<code class="codeph">DELETE_OPTION</code>来指定是否删除元数据信息。
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">DBMS_XDB_REPOS.updateResourceMetadata</code> - 更新资源的元数据。
                        </p>
                     </li>
                  </ul>
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-C224ED8C-338C-41D5-B714-4B9D403E600E__GUID-002227CC-7A19-4613-B874-449BD20F2CCB">
                     <p class="notep1">也可以看看：</p>
                     <p>有关这些PL / SQL过程的详细信息，请<a href="../arpls/DBMS_XDB_REPOS.html#ARPLS74188" target="_blank"><span><cite>参见Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="user-defined-repository-metadata.html#GUID-74BCC51E-2E7C-4DB6-8DCF-F65122FE132E" title="您可以创建自己的元数据以与存储在Oracle XML DB Repository中的XML数据相关联。">用户定义的存储库元数据</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
         </div>
      </article>
   </body>
</html>