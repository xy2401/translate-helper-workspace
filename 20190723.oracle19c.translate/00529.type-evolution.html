<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>Type Evolution</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Object-Relational Developer's Guide ">
      <meta property="og:description" content="">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Object-Relational Developer's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="object-relational-developers-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-01-11T02:05:10-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96436-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="creating-indexes-on-typeids-or-attributes.html" title="Previous" type="text/html">
      <link rel="next" href="storing-XMLTypes-and-LOBs-in-an-ANYDATA-column.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Object-Relational Developer's Guide">
    <meta name="dcterms.isVersionOf" content="ADOBJ">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="creating-indexes-on-typeids-or-attributes.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="storing-XMLTypes-and-LOBs-in-an-ANYDATA-column.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Object-Relational Developer's Guide </span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="advanced-topics-for-oracle-objects.html" property="item" typeof="WebPage"><span property="name"> Advanced Topics for Oracle Objects </span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Type Evolution</li>
            </ol>
            <a id="GUID-AD083363-701A-4CE4-8795-C55D7EBCCB47" name="GUID-AD083363-701A-4CE4-8795-C55D7EBCCB47"></a><a id="ADOBJ00603"></a>
            
            <h2 id="ADOBJ-GUID-AD083363-701A-4CE4-8795-C55D7EBCCB47" class="sect2"><span class="enumeration_section">8.3 </span>Type Evolution
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>Type evolution is the process of changing a object type.</p>
               <p>Topics:</p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p><a href="type-evolution.html#GUID-DD8B0488-CA01-4A3B-8DB9-43BEF5352F41">About Type Evolution</a></p>
                  </li>
                  <li>
                     <p><a href="type-evolution.html#GUID-30872941-6F8F-4E1D-80EE-F766130A9407">Type Evolution and Dependent Schema Objects</a></p>
                  </li>
                  <li>
                     <p><a href="type-evolution.html#GUID-F81E640C-F0FC-48D6-8FB0-CA97E56FE32B">Options for Updating Data</a></p>
                  </li>
                  <li>
                     <p><a href="type-evolution.html#GUID-12447517-9047-4DA3-8489-27C9AC2271A1">Effects of Structural Changes to Types</a></p>
                  </li>
                  <li>
                     <p><a href="type-evolution.html#GUID-A996DB5F-B19B-4EC1-B537-3438F24562CE">Altering a Type by Adding and Dropping Attributes</a></p>
                  </li>
                  <li>
                     <p><a href="type-evolution.html#GUID-B7C97F03-5476-4661-8113-CADDF5D1963D">Altering a Type by Adding a Nested Table Attribute</a></p>
                  </li>
                  <li>
                     <p><a href="type-evolution.html#GUID-0CFB36EF-6576-4FDB-9B66-294A8AFB3F9F">About Validating Types That Have Been Altered</a></p>
                  </li>
                  <li>
                     <p><a href="type-evolution.html#GUID-EBA7E55C-0D72-4CBA-908B-B4B7B55E306B">ALTER TYPE Statement for Type Evolution</a></p>
                  </li>
                  <li>
                     <p><a href="type-evolution.html#GUID-A9527438-B790-4E35-A36F-3507F6C2A00A">ALTER TABLE Statement for Type Evolution</a></p>
                  </li>
               </ul>
            </div>
            <div class="props_rev_3"><a id="GUID-DD8B0488-CA01-4A3B-8DB9-43BEF5352F41" name="GUID-DD8B0488-CA01-4A3B-8DB9-43BEF5352F41"></a><h3 id="ADOBJ-GUID-DD8B0488-CA01-4A3B-8DB9-43BEF5352F41" class="sect3"><span class="enumeration_section">8.3.1 </span>About Type Evolution
               </h3>
               <div>
                  <p>You can make the following changes to evolve an object type:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Add and drop attributes </p>
                     </li>
                     <li>
                        <p>Add and drop methods</p>
                     </li>
                     <li>
                        <p>Modify a numeric attribute to increase its length, precision, or scale</p>
                     </li>
                     <li>
                        <p>Modify a varying length character attribute to increase its length</p>
                     </li>
                     <li>
                        <p>Change the <code class="codeph">FINAL</code> and <code class="codeph">INSTANTIABLE</code> properties of a type 
                        </p>
                     </li>
                     <li>
                        <p>Modify limit and size of <code class="codeph">VARRAY</code>s
                        </p>
                     </li>
                     <li>
                        <p>Modify length, precision, and scale of collection elements</p>
                     </li>
                  </ul>
                  <p>Changes to a type affect things that reference the type. For example, if you add a new attribute to a type, data in a column of that type must be presented so as to include the new attribute.</p>
               </div>
            </div><a id="ADOBJ7657"></a><div class="props_rev_3"><a id="GUID-30872941-6F8F-4E1D-80EE-F766130A9407" name="GUID-30872941-6F8F-4E1D-80EE-F766130A9407"></a><h3 id="ADOBJ-GUID-30872941-6F8F-4E1D-80EE-F766130A9407" class="sect3"><span class="enumeration_section">8.3.2 </span>Type Evolution and Dependent Schema Objects
               </h3>
               <div>
                  <p>Dependent schema objects of a type are objects that directly or indirectly reference the type and are affected by a change to it. </p>
                  <p>A type can have these kinds of dependent schema objects: tables; types or subtypes; program units (PL/SQL blocks) such as procedures, functions, packages, and triggers; indextypes; views (including object views); function-based indexes; and operators.</p>
                  <p>How a dependent schema object is affected by a change to a type depends on the object and on the nature of the change. </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Dependent program units, views, operators, and indextypes are marked invalid when the type is modified. The next time one of these invalid schema objects is referenced, it is revalidated using the new type definition. If the object recompiles successfully, it becomes valid and can be used again. </p>
                     </li>
                     <li>
                        <p>Dependent function-based indexes may be dropped or disabled, depending on the type change, and must be rebuilt.</p>
                     </li>
                     <li>
                        <p>Dependent tables have one or more internal columns added for each attribute added to the type, depending on the attribute type. New attributes are added with <code class="codeph">NULL</code> values. For each dropped attribute, the columns associated with that attribute are dropped. For each modified attribute, the length, precision, or scale of its associated column is changed accordingly. 
                        </p>
                     </li>
                  </ul>
                  <p>These changes mainly involve updating the metadata of the tables and can be performed quickly. However, the data in those tables must be updated to the format of the new type version as well, as discussed in <span class="q">"<a href="type-evolution.html#GUID-F81E640C-F0FC-48D6-8FB0-CA97E56FE32B">Options for Updating Data</a>"</span>. 
                  </p>
               </div>
            </div><a id="ADOBJ7658"></a><div class="props_rev_3"><a id="GUID-F81E640C-F0FC-48D6-8FB0-CA97E56FE32B" name="GUID-F81E640C-F0FC-48D6-8FB0-CA97E56FE32B"></a><h3 id="ADOBJ-GUID-F81E640C-F0FC-48D6-8FB0-CA97E56FE32B" class="sect3"><span class="enumeration_section">8.3.3 </span>Options for Updating Data
               </h3>
               <div>
                  <p>Depending on the amount of data, updating can be time-consuming, so the <code class="codeph">ALTER TYPE</code> command has options to let you choose whether to convert all dependent table data immediately or to leave it in the old format to be converted piecemeal as it is updated in the course of business. 
                  </p>
                  <p>The <code class="codeph">CASCADE</code> option for <code class="codeph">ALTER TYPE</code> propagates a type change to dependent types and tables. <code class="codeph">CASCADE</code> itself has the following options that let you choose whether or not to convert table data to the new type format as part of the propagation:
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><code class="codeph">INCLUDING TABLE DATA</code>: converts the data (default)
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">NOT INCLUDING TABLE DATA</code> : does not convert data 
                        </p>
                     </li>
                  </ul>
                  <p>By default, the <code class="codeph">CASCADE</code> option converts the data. In either case, table data is always returned in the format of the latest type version. If the table data is stored in the format of an earlier type version, the database converts the data to the format of the latest version before returning it, even though the format in which the data is actually stored is not changed until the data is rewritten.
                  </p>
                  <p>You can retrieve the definition of the latest type from the system view <code class="codeph">USER_SOURCE</code>. You can view definitions of all versions of a type in the <code class="codeph">USER_TYPE_VERSIONS</code> view.
                  </p>
                  <div class="infoboxnotealso" id="GUID-F81E640C-F0FC-48D6-8FB0-CA97E56FE32B__GUID-A362984E-F3F5-4CB1-9EEA-98411220671C">
                     <p class="notep1">See Also:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><span class="q">"<a href="type-evolution.html#GUID-EBA7E55C-0D72-4CBA-908B-B4B7B55E306B">ALTER TYPE Statement for Type Evolution</a>"</span>.
                           </p>
                        </li>
                        <li>
                           <p>See <a href="../lnpls/CREATE-TYPE-statement.html#LNPLS01375" target="_blank"><span><cite>Oracle Database PL/SQL Language Reference</cite></span></a> for details about type specification and body compilation
                           </p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div><a id="ADOBJ7398"></a><div class="props_rev_3"><a id="GUID-12447517-9047-4DA3-8489-27C9AC2271A1" name="GUID-12447517-9047-4DA3-8489-27C9AC2271A1"></a><h3 id="ADOBJ-GUID-12447517-9047-4DA3-8489-27C9AC2271A1" class="sect3"><span class="enumeration_section">8.3.4 </span>Effects of Structural Changes to Types
               </h3>
               <div>
                  <p>Structural changes to a type affect dependent data and require the data to be converted. This is not true for changes that are confined to method definitions or behavior (implementation) of the type. </p>
                  <p>These possible changes to a type are structural: </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Add or drop an attribute</p>
                     </li>
                     <li>
                        <p>Modify the length, precision, or scale of an attribute</p>
                     </li>
                     <li>
                        <p>Change the finality of a type from <code class="codeph">FINAL</code> to <code class="codeph">NOT FINAL</code> or the reverse
                        </p>
                     </li>
                  </ul>
                  <p>These changes result in new versions of the altered type and all its dependent types and require the system to add, drop, or modify internal columns of dependent tables as part of the process of converting to the new version. </p>
                  <p>When you make any of these kinds of changes to a type that has dependent types or tables, the effects of propagating the change are not confined only to metadata but also affect data storage arrangements and require data conversion.</p>
                  <p>Besides converting data, you may also need to make other changes. For example, if a new attribute is added to a type, and the type body invokes the constructor of the type, then each constructor in the type body must be modified to specify a value for the new attribute. Similarly, if a new method is added, then the type body must be replaced to add the implementation of the new method. The type body can be modified by using the <code class="codeph">CREATE OR REPLACE TYPE BODY</code> statement.
                  </p>
               </div>
            </div><a id="ADOBJ7399"></a><a id="ADOBJ7659"></a><div class="props_rev_3"><a id="GUID-A996DB5F-B19B-4EC1-B537-3438F24562CE" name="GUID-A996DB5F-B19B-4EC1-B537-3438F24562CE"></a><h3 id="ADOBJ-GUID-A996DB5F-B19B-4EC1-B537-3438F24562CE" class="sect3"><span class="enumeration_section">8.3.5 </span>Altering a Type by Adding and Dropping Attributes
               </h3>
               <div>
                  <div class="section">
                     <p>You can make a simple change to a type by adding one attribute and dropping another.</p>
                     <p><a href="type-evolution.html#GUID-A996DB5F-B19B-4EC1-B537-3438F24562CE__CJGFFICH">Example 8-5</a>makes such a change to <code class="codeph">person_type</code>. The <code class="codeph">CASCADE</code> keyword propagates the type change to dependent types and tables, but the phrase <code class="codeph">NOT</code> <code class="codeph">INCLUDING</code> <code class="codeph">TABLE</code> <code class="codeph">DATA</code> prevents conversion of the related data. 
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-A996DB5F-B19B-4EC1-B537-3438F24562CE__CJGFFICH">
                     <p class="titleinexample">Example 8-5 Altering an Object Type by Adding and Dropping an Attribute</p><pre class="oac_no_warn" dir="ltr">-- Drop person_typ and person_obj_table if they exist
CREATE TYPE person_typ AS OBJECT (
  idno           NUMBER,
  name           VARCHAR2(30),
  phone          VARCHAR2(20));
/
CREATE TABLE person_obj_table OF person_typ;

INSERT INTO person_obj_table 
  VALUES (person_typ(12, 'Bob Jones', '650-555-0130'));

SELECT value(p) FROM person_obj_table p;
</pre></div>
                  <!-- class="example" -->
                  <div class="section"><pre class="pre codeblock"><code>VALUE(P)(IDNO, NAME, PHONE)
--------------------------------------------
PERSON_TYP(12, 'Bob Jones', '650-555-0130')</code></pre><p>You can add the email attribute and drop the phone attribute as follows:</p><pre class="oac_no_warn" dir="ltr">ALTER TYPE person_typ
  <span class="bold">ADD ATTRIBUTE</span> (email VARCHAR2(80)), 
  <span class="bold">DROP ATTRIBUTE</span> phone <span class="bold">CASCADE NOT INCLUDING TABLE DATA</span>;
</pre><p>Then you can disconnect and reconnect to accommodate the type change:</p><pre class="oac_no_warn" dir="ltr">connect oe/oe;
connect hr/&lt;password&gt;;
ALTER SESSION SET PLSQL_WARNINGS = 'enable:all';
-- The data of table person_obj_table has not been converted yet, but
-- when the data is retrieved, Oracle returns the data based on
-- the latest type version. The new attribute is initialized to NULL.
SELECT value(p) FROM person_obj_table p;
</pre><pre class="pre codeblock"><code>VALUE(P)(IDNO, NAME, EMAIL)
---------------------------------
PERSON_TYP(12, 'Bob Jones', NULL)</code></pre><p>During <code class="codeph">SELECT</code> statements, even though column data may be converted to the latest type version, the converted data is not written back to the column. If you retrieve a particular user-defined type column in a table often, consider converting that data to the latest type version to eliminate redundant data conversions. Converting is especially beneficial if the column contains <code class="codeph">VARRAY</code> attributes which typically take more time to convert than objects or nested table columns.
                     </p>
                     <p>You can convert a column of data by issuing an <code class="codeph">UPDATE</code> statement to set the column to itself, as indicated in the following code snippet, which is unrelated to previous code. 
                     </p><pre class="oac_no_warn" dir="ltr">UPDATE dept_tab SET <span class="bold">emp_array_col</span> = <span class="bold">emp_array_col</span>;
</pre><p>You can convert all columns in a table by using <code class="codeph">ALTER</code> <code class="codeph">TABLE</code> with the <code class="codeph">UPGRADE</code> <code class="codeph">INCLUDING</code> <code class="codeph">DATA</code>. For example:
                     </p><pre class="oac_no_warn" dir="ltr">ALTER TYPE person_typ ADD ATTRIBUTE (photo BLOB)
  CASCADE NOT INCLUDING TABLE DATA;
<span class="bold">ALTER TABLE</span> person_obj_table <span class="bold">UPGRADE INCLUDING DATA</span>;
</pre><p>The <code class="codeph">ALTER</code> <code class="codeph">TABLE</code> line converts only the table listed. The <code class="codeph">CASCADE</code> option prevents conversion of other tables or dependents. 
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="ADOBJ7400"></a><div class="props_rev_3"><a id="GUID-B7C97F03-5476-4661-8113-CADDF5D1963D" name="GUID-B7C97F03-5476-4661-8113-CADDF5D1963D"></a><h3 id="ADOBJ-GUID-B7C97F03-5476-4661-8113-CADDF5D1963D" class="sect3"><span class="enumeration_section">8.3.6 </span>Altering a Type by Adding a Nested Table Attribute
               </h3>
               <div>
                  <div class="section">
                     <p>You can add a nested table attribute to an object type that is included in a nested table. </p>
                     <p>The following steps are required to make this complex change to a type. </p>
                     <p>The steps require this initial schema which is then altered by the code in Step 1.</p>
                     <p><span class="bold">Initial Schema</span></p><pre class="oac_no_warn" dir="ltr">-- Drop existing person_typ, department_type, people_typ objects or tables
CREATE TYPE person_typ AS OBJECT (
  idno           NUMBER,
  name           VARCHAR2(30),
  phone          VARCHAR2(20));
/
-- creating a nested table type
CREATE TYPE people_typ AS TABLE OF person_typ;/
CREATE TYPE department_typ AS OBJECT (
  manager    person_typ,
  employee   people_typ);  // a nested table/
CREATE TABLE department OF department_typ
  NESTED TABLE employee STORE AS employee_store_nt;
</pre></div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>The code example in Step 1 starts by creating a new object <code class="codeph">tasks_typ</code> and a nested table type to hold it, <code class="codeph">tasks_nttab</code>. 
                     </p>
                     <p>The following steps, both in the code example in Step 1, and in other programs, are necessary to add the nested table <code class="codeph">tasks</code> as an attribute to the object type <code class="codeph">person_typ</code>, which is already included in the nested table <code class="codeph">people_typ</code>.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>.</span><div>
                           <p><span class="bold">Altering an Object Type by Adding a Nested Table Attribute</span></p><pre class="oac_no_warn" dir="ltr">-- Requires Ex. 8-6
CREATE TYPE tasks_typ AS OBJECT (
  priority       VARCHAR2(2),
  description    VARCHAR2(30));
/

CREATE TYPE tasks_nttab AS TABLE OF tasks_typ;
/

-- Propagate the change to employee_store_nt
-- Specify a storage name for the new nested table
<span class="bold">ALTER TABLE</span> employee_store_nt
  <span class="bold">UPGRADE</span> NESTED TABLE tasks <span class="bold">STORE AS</span> tasks_nt;
</pre></div>
                     </li>
                     <li class="stepexpand"><span>Use <code class="codeph">CREATE OR REPLACE TYPE BODY</code> for <code class="codeph">person_typ</code> to update the corresponding type body to make it current with the new type definition, <span class="italic">if necessary</span>.</span></li>
                     <li class="stepexpand"><span>Upgrade the dependent tables to the latest type version and convert the data in the tables. This validates the table and allow for data access again.</span><div><pre class="oac_no_warn" dir="ltr">ALTER TABLE department UPGRADE INCLUDING DATA;
</pre></div>
                     </li>
                     <li class="stepexpand"><span>Alter dependent PL/SQL program units as needed to take account of changes to the type.</span></li>
                     <li class="stepexpand"><span>Use Oracle Type Translator (OTT) to generate new header files for applications, depending on whether the application is written in C or Java.</span><div>
                           <p>Adding a new attribute to a supertype also increases the number of attributes in all its subtypes because these inherit the new attribute. Inherited attributes always precede declared (locally defined) attributes, so adding a new attribute to a supertype causes the ordinal position of all declared attributes of any subtype to be incremented by one recursively.</p>
                           <p>You must update the mappings of the altered type to include the new attributes. Use Oracle Type Translator (OTT) to do this. If you use another tool, you must be sure that the type headers are properly synchronized with the type definition in the server; otherwise, unpredictable behavior may result.</p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>Modify application code as needed and rebuild the application.</span></li>
                  </ol>
               </div>
            </div><a id="ADOBJ7404"></a><a id="ADOBJ7405"></a><a id="ADOBJ7406"></a><a id="ADOBJ7407"></a><a id="ADOBJ7661"></a><a id="ADOBJ7403"></a><div class="props_rev_3"><a id="GUID-0CFB36EF-6576-4FDB-9B66-294A8AFB3F9F" name="GUID-0CFB36EF-6576-4FDB-9B66-294A8AFB3F9F"></a><h3 id="ADOBJ-GUID-0CFB36EF-6576-4FDB-9B66-294A8AFB3F9F" class="sect3"><span class="enumeration_section">8.3.7 </span>About Validating Types That Have Been Altered
               </h3>
               <div>
                  <p>When the system executes an <code class="codeph">ALTER TYPE</code> statement, it first validates the requested type change syntactically and semantically to make sure it is legal. 
                  </p>
                  <p>The system performs the same validations as for a <code class="codeph">CREATE TYPE</code> statement plus some additional ones. If the new specification of the target type or any of its dependent types fails the type validations, the <code class="codeph">ALTER TYPE</code> statement aborts. No new type version is created, and all dependent objects remain unchanged.
                  </p>
                  <p>If dependent tables exist, further checking ensures that restrictions relating to the tables and indexes are observed. For example, it ensures that an attribute being dropped is not used as a partitioning key. Again, if the <code class="codeph">ALTER TYPE</code> statement fails the check of table-related restrictions, then the type change is aborted, and no new version of the type is created. 
                  </p>
                  <p>When a single <code class="codeph">ALTER TYPE</code> statement adds multiple attributes, it is done in the order specified. Multiple type changes can be specified in the same <code class="codeph">ALTER TYPE</code> statement, but no attribute name or method signature can be specified more than once in the statement. For example, adding and modifying the same attribute in a single statement is not allowed. 
                  </p>
                  <p>The following sections contain other notes on type changes including:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="type-evolution.html#GUID-0CFB36EF-6576-4FDB-9B66-294A8AFB3F9F__CHDJEFBB">Dropping an Attribute</a></p>
                     </li>
                     <li>
                        <p><a href="type-evolution.html#GUID-0CFB36EF-6576-4FDB-9B66-294A8AFB3F9F__CHDDFCEG">Modifying the Length, Precision, or Scale of an Attribute Type</a></p>
                     </li>
                     <li>
                        <p><a href="type-evolution.html#GUID-0CFB36EF-6576-4FDB-9B66-294A8AFB3F9F__CHDIAAEH">Dropping a Method</a></p>
                     </li>
                     <li>
                        <p><a href="type-evolution.html#GUID-0CFB36EF-6576-4FDB-9B66-294A8AFB3F9F__CHDEEHAF">Modifying the INSTANTIABLE Property</a></p>
                     </li>
                  </ul>
                  <div class="section" id="GUID-0CFB36EF-6576-4FDB-9B66-294A8AFB3F9F__CHDJEFBB">
                     <p class="subhead2" id="GUID-0CFB36EF-6576-4FDB-9B66-294A8AFB3F9F__GUID-74229697-2252-48AF-990F-12F08D00C4AD">Dropping an Attribute</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Dropping all attributes from a root type is not allowed. Instead, you must drop the type. Because a subtype inherits all the attributes from its supertype, dropping all the attributes from a subtype does not reduce its attribute count to zero; therefore, dropping all attributes declared locally in a subtype is allowed.</p>
                        </li>
                        <li>
                           <p>Only an attribute declared locally in the target type can be dropped. You cannot drop an inherited attribute from a subtype. Instead, drop the attribute from the type where it is locally declared.</p>
                        </li>
                        <li>
                           <p>Dropping an attribute which is part of a table partitioning or sub-partitioning key in a table is not allowed.</p>
                        </li>
                        <li>
                           <p>When an attribute is dropped, the column corresponding to the dropped attribute is dropped.</p>
                        </li>
                        <li>
                           <p>When an attribute is dropped, any indexes, statistics, constraints, and referential integrity constraints that reference it are removed.</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-0CFB36EF-6576-4FDB-9B66-294A8AFB3F9F__CHDDFCEG">
                     <p class="subhead2" id="GUID-0CFB36EF-6576-4FDB-9B66-294A8AFB3F9F__GUID-EB17057C-8CCF-4B51-8A02-943CE9C6B66D">Modifying the Length, Precision, or Scale of an Attribute Type</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>You are not allowed to expand the length of an attribute referenced in a function-based index, clustered key or domain index on a dependent table.</p>
                        </li>
                        <li>
                           <p>You are not allowed to decrease the length, precision, or scale of an attribute.</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-0CFB36EF-6576-4FDB-9B66-294A8AFB3F9F__CHDIAAEH">
                     <p class="subhead2" id="GUID-0CFB36EF-6576-4FDB-9B66-294A8AFB3F9F__GUID-51C36373-36DD-487F-97DF-833E4A99062D">Dropping a Method</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>You can only drop a method from the type in which the method is defined (or redefined): You cannot drop an inherited method from a subtype, and you cannot drop an redefined method from a supertype.</p>
                        </li>
                        <li>
                           <p>If a method is not redefined, dropping it using the <code class="codeph">CASCADE</code> option removes the method from the target type and all subtypes. However, if a method is redefined in a subtype, the <code class="codeph">CASCADE</code> will fail and roll back. For the <code class="codeph">CASCADE</code> to succeed, you must first drop each redefined method from the subtype that defines it and then drop the method from the supertype.
                           </p>
                           <p>You can consult the <code class="codeph">USER_DEPENDENCIES</code> table to find all the schema objects, including types, that depend on a given type. You can also run the <code class="codeph">DBMS_UTILITY.GET_DEPENDENCY</code> utility to find the dependencies of a type.
                           </p>
                        </li>
                        <li>
                           <p>You can use the <code class="codeph">INVALIDATE</code> option to drop a method that has been redefined, but the redefined versions in the subtypes must still be dropped manually. The subtypes will remain in an invalid state until they are explicitly altered to drop the redefined versions. Until then, an attempt to recompile the subtypes for revalidation will produce the error <code class="codeph">Method does not override</code>.
                           </p>
                           <p>Unlike <code class="codeph">CASCADE</code>, <code class="codeph">INVALIDATE</code> bypasses all the type and table checks and simply invalidates all schema objects dependent on the type. The objects are revalidated the next time they are accessed. This option is faster than using <code class="codeph">CASCADE</code>, but you must be certain that no problems occur when revalidating dependent types and tables. Table data cannot be accessed while a table is invalid; if a table cannot be validated, its data remains inaccessible. 
                           </p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-0CFB36EF-6576-4FDB-9B66-294A8AFB3F9F__CHDEEHAF">
                     <p class="subhead2" id="GUID-0CFB36EF-6576-4FDB-9B66-294A8AFB3F9F__GUID-02FE925A-44E3-4B8A-BF84-9E9A888DDC23">Modifying the INSTANTIABLE Property</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Altering an object type from <code class="codeph">INSTANTIABLE</code> to <code class="codeph">NOT INSTANTIABLE</code> is allowed only if the type has no table dependents.
                           </p>
                        </li>
                        <li>
                           <p>Altering an object type from <code class="codeph">NOT INSTANTIABLE</code> to <code class="codeph">INSTANTIABLE</code> is allowed anytime. This change does not affect tables.
                           </p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-0CFB36EF-6576-4FDB-9B66-294A8AFB3F9F__GUID-015958F2-E005-4DC7-BC39-C9DE060D7F3E">Modifying the FINAL Property</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Altering an object type from <code class="codeph">NOT FINAL</code> to <code class="codeph">FINAL</code> is only allowed if the target type has no subtypes.
                           </p>
                        </li>
                        <li>
                           <p>When you alter an object type from <code class="codeph">FINAL</code> to <code class="codeph">NOT FINAL</code> or vice versa, you must use <code class="codeph">CASCADE</code> to convert data in dependent columns and tables immediately. You may not use the <code class="codeph">CASCADE</code> option <code class="codeph">NOT INCLUDING TABLE DATA</code> to defer converting data.
                           </p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>From <code class="codeph">NOT FINAL</code> to <code class="codeph">FINAL</code>, you must use <code class="codeph">CASCADE INCLUDING TABLE DATA</code>. 
                                 </p>
                              </li>
                              <li>
                                 <p>From <code class="codeph">FINAL</code> to <code class="codeph">NOT FINAL</code>, you may use either <code class="codeph">CASCADE INCLUDING TABLE DATA</code> or <code class="codeph">CASCADE CONVERT TO SUBSTITUTABLE</code>. 
                                 </p>
                                 <p>When you alter a type from <code class="codeph">FINAL</code> to <code class="codeph">NOT</code> <code class="codeph">FINAL</code>, select the <code class="codeph">CASCADE</code> option based on whether or not you want to insert new subtypes of the altered types into existing columns and tables.
                                 </p>
                              </li>
                           </ul>
                           <p>By default, altering a type from <code class="codeph">FINAL</code> to <code class="codeph">NOT</code> <code class="codeph">FINAL</code> enables you to create new substitutable tables and columns of that type, but it does not automatically make existing columns (or object tables) of that type substitutable. In fact, just the opposite happens: existing columns and tables of the type are marked <code class="codeph">NOT SUBSTITUTABLE</code> <code class="codeph">AT</code> <code class="codeph">ALL</code> <code class="codeph">LEVELS</code>. If any embedded attribute of these columns is substitutable, an error is generated. New subtypes of the altered type cannot be inserted into these preexisting columns and tables.
                           </p>
                           <p>To alter an object type to <code class="codeph">NOT</code> <code class="codeph">FINAL</code> in a way that makes existing columns and tables of the type substitutable (assuming that they are not marked <code class="codeph">NOT</code> <code class="codeph">SUBSTITUTABLE</code>), use the <code class="codeph">CASCADE</code> option <code class="codeph">CONVERT TO SUBSTITUTABLE</code>. 
                           </p>
                           <p>The following example shows the use of <code class="codeph">CASCADE</code> with the option <code class="codeph">CONVERT TO SUBSTITUTABLE</code>:
                           </p><pre class="oac_no_warn" dir="ltr">CREATE TYPE shape AS OBJECT (
    name VARCHAR2(30),
    area NUMBER)
    FINAL;/
ALTER TYPE shape NOT FINAL CASCADE <span class="bold">CONVERT TO SUBSTITUTABLE</span>;</pre><p>This <code class="codeph">CASCADE</code> option marks each existing column as <code class="codeph">SUBSTITUTABLE AT ALL LEVELS</code> and causes a new, hidden column to be added for the TypeId of instances stored in the column. The column can then store subtype instances of the altered type.
                           </p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="ADOBJ7411"></a><a id="ADOBJ7410"></a><div class="props_rev_3"><a id="GUID-EBA7E55C-0D72-4CBA-908B-B4B7B55E306B" name="GUID-EBA7E55C-0D72-4CBA-908B-B4B7B55E306B"></a><h3 id="ADOBJ-GUID-EBA7E55C-0D72-4CBA-908B-B4B7B55E306B" class="sect3"><span class="enumeration_section">8.3.8 </span>ALTER TYPE Statement for Type Evolution
               </h3>
               <div>
                  <div class="section">
                     <p><a href="type-evolution.html#GUID-EBA7E55C-0D72-4CBA-908B-B4B7B55E306B__G1011839" title="options in the ALTER TYPE statement for altering type attributes or methods">Table 8-1</a> lists some of the important options in the <code class="codeph">ALTER</code> <code class="codeph">TYPE</code> and <code class="codeph">ALTER</code> <code class="codeph">TYPE</code><code class="codeph">...CASCADE</code> statements for altering the attribute or method definition of a type.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="tblformal" id="GUID-EBA7E55C-0D72-4CBA-908B-B4B7B55E306B__G1011839">
                     <p class="titleintable">Table 8-1 ALTER TYPE Options for Type Evolution</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="ALTER TYPE Options for Type Evolution" summary="options in the ALTER TYPE statement for altering type attributes or methods" width="100%" frame="hsides" border="1" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="29%" id="d29876e1218">Option</th>
                              <th align="left" valign="bottom" width="71%" id="d29876e1221">Description</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d29876e1226" headers="d29876e1218 ">
                                 <p><code class="codeph">CASCADE </code></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d29876e1226 d29876e1221 ">
                                 <p>Propagates the type change to dependent types and tables. The statement aborts if an error is found in dependent types or tables unless the <code class="codeph">FORCE</code> option is specified.
                                 </p>
                                 <p>If <code class="codeph">CASCADE</code> is specified without other options, then the <code class="codeph">INCLUDING TABLE DATA</code> option for <code class="codeph">CASCADE</code> is implied, and the database converts all table data to the latest type version.
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d29876e1248" headers="d29876e1218 ">
                                 <p><code class="codeph">INCLUDING TABLE DATA </code>(Option of <code class="codeph">CASCADE</code>)
                                 </p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d29876e1248 d29876e1221 ">
                                 <p>Converts data stored in all user-defined columns to the most recent version of the column type.</p>
                                 <p>For each new attribute added to the column type, a new attribute is added to the data and is initialized to <code class="codeph">NULL</code>. For each attribute dropped from the referenced type, the corresponding attribute data is removed from the table. All tablespaces containing the table data must be in read-write mode; otherwise, the statement will not succeed.
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d29876e1265" headers="d29876e1218 ">
                                 <p><code class="codeph">NOT INCLUDING TABLE DATA </code>(Option of <code class="codeph">CASCADE</code>)
                                 </p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d29876e1265 d29876e1221 ">
                                 <p>Leaves column data as is, does not change type version. If an attribute is dropped from a type referenced by a table, the corresponding column of the dropped attribute is not removed from the table. However, the metadata of the column is marked unused. If the dropped attribute is stored out-of-line (for example, <code class="codeph">VARRAY</code>, <code class="codeph">LOB</code>, or nested table attribute), the out-of-line data is not removed. (Unused columns can be removed afterward by using an <code class="codeph">ALTER TABLE DROP UNUSED COLUMNS</code> statement.)
                                 </p>
                                 <p>This option is useful when you have many large tables and may run out of rollback segments if you convert them all in one transaction. This option enables you to convert the data of each dependent table later in a separate transaction (using an <code class="codeph">ALTER TABLE UPGRADE INCLUDING DATA</code> statement).
                                 </p>
                                 <p>Specifying this option speeds up the table upgrade because the table data remains in the format of the old type version. However, selecting data from this table requires converting the images stored in the column to the latest type version. This is likely to affect performance during subsequent <code class="codeph">SELECT</code> statements.
                                 </p>
                                 <p>Because this option only requires updating the table metadata, it does not require that all tablespaces be on-line in read/write mode for the statement to succeed.</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d29876e1298" headers="d29876e1218 ">
                                 <p><code class="codeph">FORCE </code>(Option of <code class="codeph">CASCADE</code>)
                                 </p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d29876e1298 d29876e1221 ">
                                 <p>Forces the system to ignore errors from dependent tables and indexes. Errors are logged in a specified exception table so that they can be queried afterward. Use this option with caution because dependent tables can become inaccessible if some table errors occur.</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d29876e1310" headers="d29876e1218 ">
                                 <p><code class="codeph">CONVERT TO SUBSTITUTABLE </code>(Option of <code class="codeph">CASCADE</code>)
                                 </p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d29876e1310 d29876e1221 ">
                                 <p>For use when altering a type from <code class="codeph">FINAL</code> to <code class="codeph">NOT</code> <code class="codeph">FINAL</code>: Converts data stored in all user-defined columns to the most recent version of the column type and then marks these existing columns and object tables of the type <code class="codeph">SUBSTITUTABLE AT ALL LEVELS</code> so that they can store any newly created subtypes of the type. 
                                 </p>
                                 <p>If the type is altered to <code class="codeph">NOT FINAL</code> without specifying this option, existing columns and tables of the type are marked <code class="codeph">NOT SUBSTITUTABLE AT ALL LEVELS</code>, and new subtypes of the type cannot be stored in them. You can only store these subtypes in columns and tables created after the type was altered.
                                 </p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <div class="infoboxnotealso" id="GUID-EBA7E55C-0D72-4CBA-908B-B4B7B55E306B__GUID-4219A46E-2ED7-4F51-A062-4063842C7B42">
                        <p class="notep1">See Also:</p>
                        <p><a href="../sqlrf/ALTER-TYPE.html#SQLRF01102" target="_blank"><span><cite>Oracle Database SQL Language Reference</cite></span></a> for further information about <code class="codeph">ALTER</code> <code class="codeph">TYPE</code> options
                        </p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="ADOBJ7413"></a><div class="props_rev_3"><a id="GUID-A9527438-B790-4E35-A36F-3507F6C2A00A" name="GUID-A9527438-B790-4E35-A36F-3507F6C2A00A"></a><h3 id="ADOBJ-GUID-A9527438-B790-4E35-A36F-3507F6C2A00A" class="sect3"><span class="enumeration_section">8.3.9 </span>ALTER TABLE Statement for Type Evolution
               </h3>
               <div>
                  <div class="section">
                     <p>You can use <code class="codeph">ALTER</code> <code class="codeph">TABLE</code> to convert table data to the latest version of referenced types. For an example, see <span class="q">"<a href="type-evolution.html#GUID-B7C97F03-5476-4661-8113-CADDF5D1963D">Altering a Type by Adding a Nested Table Attribute</a>"</span>. 
                     </p>
                     <div class="infoboxnotealso" id="GUID-A9527438-B790-4E35-A36F-3507F6C2A00A__GUID-C11C811B-A5E4-4989-9725-DBA3248C9BBF">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="type-evolution.html#GUID-EBA7E55C-0D72-4CBA-908B-B4B7B55E306B__G1011839" title="options in the ALTER TYPE statement for altering type attributes or methods">Table 8-1</a> for a discussion of the <code class="codeph">INCLUDING</code> <code class="codeph">DATA</code> option.
                              </p>
                           </li>
                           <li>
                              <p><a href="../sqlrf/SQL-Statements-ALTER-SYNONYM-to-COMMENT.html#SQLRF010" target="_blank"><span><cite>Oracle Database SQL Language Reference</cite></span></a> for information about <code class="codeph">ALTER</code> <code class="codeph">TABLE</code> options
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
         </div>
      </article>
   </body>
</html>