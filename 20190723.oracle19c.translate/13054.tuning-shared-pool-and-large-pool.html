<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>调整共享池和大池</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Database Performance Tuning Guide"></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Database Performance Tuning Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="database-performance-tuning-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-03-12T22:26:14-07:00"></meta>
      <meta name="dcterms.title" content="Database Performance Tuning Guide"></meta>
      <meta name="dcterms.dateCopyrighted" content="2007, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96347-03"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="tuning-database-buffer-cache.html" title="Previous" type="text/html"></link>
      <link rel="next" href="tuning-result-cache.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="TGDBA"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="tuning-database-buffer-cache.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="tuning-result-cache.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">数据库性能调优指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="part-III-tuning-database-memory.html" property="item" typeof="WebPage"><span property="name">调整数据库内存</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">调整共享池和大池</li>
            </ol>
            <a id="GUID-2EB3A7A0-881D-42AA-A299-DD118FF2BB92" name="GUID-2EB3A7A0-881D-42AA-A299-DD118FF2BB92"></a><a id="TGDBA558"></a>
            
            <h2 id="TGDBA-GUID-2EB3A7A0-881D-42AA-A299-DD118FF2BB92" class="sect2"><span class="enumeration_chapter">14</span>调整共享池和大池</h2>
         </header>
         <div class="ind">
            <div>
               <p>本章介绍如何调整共享池和大型池。如果使用自动内存管理来管理系统上的数据库内存，或使用自动共享内存管理来配置共享全局区域（SGA），则无需手动调整共享池和大型池，如本章所述。</p>
               <p>本章包含以下主题：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="tuning-shared-pool-and-large-pool.html#GUID-861E86EA-60DB-431A-BE3A-7AEFA2E27F94">关于共享池</a></p>
                  </li>
                  <li>
                     <p><a href="tuning-shared-pool-and-large-pool.html#GUID-901C4010-2B6A-4E50-A02E-77830BB7E70D">使用共享池</a></p>
                  </li>
                  <li>
                     <p><a href="tuning-shared-pool-and-large-pool.html#GUID-5823285C-A728-4006-8813-41BB92928F73">配置共享池</a></p>
                  </li>
                  <li>
                     <p><a href="tuning-shared-pool-and-large-pool.html#GUID-096F2CDD-B3EE-4124-BBE3-F60400600972">配置大池</a></p>
                  </li>
               </ul>
            </div><a id="TGDBA559"></a><div class="props_rev_3"><a id="GUID-861E86EA-60DB-431A-BE3A-7AEFA2E27F94" name="GUID-861E86EA-60DB-431A-BE3A-7AEFA2E27F94"></a><h3 id="TGDBA-GUID-861E86EA-60DB-431A-BE3A-7AEFA2E27F94" class="sect3"><span class="enumeration_section">14.1</span>关于共享池</h3>
               <div>
                  <p>Oracle数据库使用共享池来缓存许多不同类型的数据。缓存数据包括PL / SQL块和SQL语句的文本和可执行形式，字典缓存数据，结果缓存数据和其他数据。</p>
                  <p>本节介绍共享池，包含以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="tuning-shared-pool-and-large-pool.html#GUID-1C8D7788-CBDA-4951-9F79-9C0550EE935E">使用共享池的好处</a></p>
                     </li>
                     <li>
                        <p><a href="tuning-shared-pool-and-large-pool.html#GUID-E33B69A7-C052-4DBB-AD31-424ECC871C6B">共享池概念</a></p>
                     </li>
                  </ul>
               </div><a id="TGDBA560"></a><div class="props_rev_3"><a id="GUID-1C8D7788-CBDA-4951-9F79-9C0550EE935E" name="GUID-1C8D7788-CBDA-4951-9F79-9C0550EE935E"></a><h4 id="TGDBA-GUID-1C8D7788-CBDA-4951-9F79-9C0550EE935E" class="sect4"><span class="enumeration_section">14.1.1</span>使用共享池的好处</h4>
                  <div>
                     <p>正确使用和调整共享池可以至少以四种方式减少资源消耗：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>如果SQL语句位于共享池中，则会避免解析开销，从而导致系统上的CPU资源减少以及最终用户的已用时间。</p>
                        </li>
                        <li>
                           <p>锁定资源使用量显着降低，从而提高了可扩展性。</p>
                        </li>
                        <li>
                           <p>减少了共享池内存需求，因为所有应用程序都使用相同的SQL语句池和字典资源。</p>
                        </li>
                        <li>
                           <p>I / O减少了，因为共享池中的字典元素不需要磁盘访问。</p>
                        </li>
                     </ul>
                  </div>
               </div><a id="TGDBA561"></a><div class="props_rev_3"><a id="GUID-E33B69A7-C052-4DBB-AD31-424ECC871C6B" name="GUID-E33B69A7-C052-4DBB-AD31-424ECC871C6B"></a><h4 id="TGDBA-GUID-E33B69A7-C052-4DBB-AD31-424ECC871C6B" class="sect4"><span class="enumeration_section">14.1.2</span>共享池概念</h4>
                  <div>
                     <p>共享池的主要组件包括：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>库缓存</p>
                           <p>库高速缓存存储最近引用的SQL和PL / SQL代码的可执行（解析或编译）形式。</p>
                        </li>
                        <li>
                           <p>数据字典缓存</p>
                           <p>数据字典高速缓存存储从数据字典引用的数据。</p>
                        </li>
                        <li>
                           <p>服务器结果缓存（取决于配置）</p>
                           <p>服务器结果缓存是一个可选缓存，用于在共享池中存储查询和PL / SQL函数结果。有关服务器结果缓存的信息，请参阅<span class="q">“ <a href="tuning-result-cache.html#GUID-9C00174C-9046-4EB1-BC1C-5E7FA03FB9AA">关于结果缓存</a> ”</span> 。
                           </p>
                        </li>
                     </ul>
                     <p>共享池中的许多高速缓存（包括库高速缓存和字典高速缓存）会根据需要自动增大或减小大小。当共享池空间不足时，旧条目会老化以容纳新条目。</p>
                     <p>库缓存或数据字典缓存上的缓存未命中比缓冲缓存上的未命中更昂贵。因此，应调整共享池的大小以确保缓存经常使用的数据。</p>
                     <p>多个功能需要共享池中的大量内存分配，例如共享服务器，并行查询或Recovery Manager。Oracle建议使用单独的内存区域 - 大型池 - 来隔离这些功能使用的系统全局区域（SGA）内存。</p>
                     <p>共享池中的内存分配是以块的形式执行的。此分块可以将大对象（超过5 KB）加载到缓存中，而无需单个连续区域。通过这种方式，数据库减少了由于碎片而耗尽连续内存的可能性。</p>
                     <p>Java，PL / SQL或SQL游标有时可能会从共享池中进行大于5 KB的分配。为了使这些分配更有效地发生，Oracle Database隔离了少量的共享池。如果共享池空间不足，则使用称为保留池的隔离内存。</p>
                     <p>以下部分提供有关共享池主要组件的更多详细信息：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="tuning-shared-pool-and-large-pool.html#GUID-CB999004-AA94-47FB-A7A1-662239450959">库缓存概念</a></p>
                        </li>
                        <li>
                           <p><a href="tuning-shared-pool-and-large-pool.html#GUID-ECD8D7C1-02C2-45B1-8D75-1F42F85FB673">数据字典缓存概念</a></p>
                        </li>
                        <li>
                           <p><a href="tuning-shared-pool-and-large-pool.html#GUID-BE6DFC00-A436-4908-A711-9127FABB6809">SQL共享标准</a></p>
                        </li>
                     </ul>
                  </div><a id="TGDBA562"></a><div class="props_rev_3"><a id="GUID-CB999004-AA94-47FB-A7A1-662239450959" name="GUID-CB999004-AA94-47FB-A7A1-662239450959"></a><h5 id="TGDBA-GUID-CB999004-AA94-47FB-A7A1-662239450959" class="sect5"><span class="enumeration_section">14.1.2.1</span>库高速缓存概念</h5>
                     <div>
                        <p>库高速缓存存储SQL游标，PL / SQL程序和Java类的可执行形式，它们统称为应用程序代码。本节重点介绍与应用程序代码相关的调优。</p>
                        <p>执行应用程序代码时，如果先前已执行并且可以共享现有代码，则Oracle数据库会尝试重用现有代码。如果SQL语句的解析表示存在于库高速缓存中并且可以共享，则数据库将重用现有代码。这称为软解析或库缓存命中。如果Oracle数据库无法使用现有代码，则数据库必须构建应用程序代码的新可执行版本。这称为硬解析或库缓存未命中。有关何时可以共享SQL和PL / SQL语句的信息，请参阅<span class="q">“ <a href="tuning-shared-pool-and-large-pool.html#GUID-BE6DFC00-A436-4908-A711-9127FABB6809">SQL共享标准</a> ”</span> 。
                        </p>
                        <p>为了执行硬解析，Oracle数据库使用的资源多于软解析期间的资源。用于软解析的资源包括CPU和库高速缓存锁存器获取。硬解析所需的资源包括额外的CPU，库缓存锁存器获取和共享池锁存器获取。在处理SQL语句时，解析步骤或执行步骤可能会发生硬解析。</p>
                        <p>当应用程序对SQL语句进行解析调用时，如果库缓存中不存在语句的解析表示，则Oracle数据库会解析该语句并将解析后的表单存储在共享池中。要减少解析调用上的库缓存未命中，请确保尽可能将所有可共享SQL语句存储在共享池中。</p>
                        <p>当应用程序对SQL语句执行调用时，如果SQL语句的可执行部分从库高速缓存中老化（或取消分配）以为另一个语句腾出空间，则Oracle数据库会隐式重新声明该语句以创建新的共享SQL区域，并执行该语句。这也导致难以解析。要减少执行调用中的库高速缓存未命中，请为库高速缓存分配更多内存。</p>
                        <p>有关硬解析和软解析的详细信息，请参阅<span class="q">“ <a href="designing-and-developing-for-performance.html#GUID-B95920ED-53C2-42A7-A53D-9083974A7A1D">SQL执行效率</a> ”</span> 。
                        </p>
                     </div>
                  </div><a id="TGDBA563"></a><div class="props_rev_3"><a id="GUID-ECD8D7C1-02C2-45B1-8D75-1F42F85FB673" name="GUID-ECD8D7C1-02C2-45B1-8D75-1F42F85FB673"></a><h5 id="TGDBA-GUID-ECD8D7C1-02C2-45B1-8D75-1F42F85FB673" class="sect5"><span class="enumeration_section">14.1.2.2</span>数据字典高速缓存概念</h5>
                     <div>
                        <p>存储在数据字典缓存中的信息包括：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>用户名</p>
                           </li>
                           <li>
                              <p>细分信息</p>
                           </li>
                           <li>
                              <p>档案数据</p>
                           </li>
                           <li>
                              <p>表空间信息</p>
                           </li>
                           <li>
                              <p>序号</p>
                           </li>
                        </ul>
                        <p>数据字典高速缓存还存储关于模式对象的描述性信息或元数据。Oracle数据库在解析SQL游标或PL / SQL程序编译期间使用此元数据。</p>
                     </div>
                  </div><a id="TGDBA564"></a><div class="props_rev_3"><a id="GUID-BE6DFC00-A436-4908-A711-9127FABB6809" name="GUID-BE6DFC00-A436-4908-A711-9127FABB6809"></a><h5 id="TGDBA-GUID-BE6DFC00-A436-4908-A711-9127FABB6809" class="sect5"><span class="enumeration_section">14.1.2.3</span> SQL共享标准</h5>
                     <div>
                        <p>Oracle数据库自动确定发出的SQL语句或PL / SQL块是否与共享池中当前的另一个语句相同。</p>
                        <p>要将SQL语句的文本与共享池中的现有SQL语句进行比较，Oracle数据库将执行以下步骤：</p>
                        <ol>
                           <li>
                              <p>SQL语句的文本经过哈希处理。</p>
                              <p>如果没有匹配的哈希值，则共享池中当前不存在SQL语句，并执行硬分析。</p>
                           </li>
                           <li>
                              <p>如果共享池中的现有SQL语句存在匹配的哈希值，则会将匹配语句的文本与哈希语句的文本进行比较，以验证它们是否相同。</p>
                              <p>SQL语句或PL / SQL块的文本必须相同，字符为字符，包括空格，大小写和注释。例如，以下语句不能使用相同的共享SQL区域：</p><pre class="oac_no_warn" dir="ltr">SELECT * FROM员工; SELECT * FROM Employees; SELECT * FROM员工;</pre><p>此外，仅在文字中不同的SQL语句不能使用相同的共享SQL区域。例如，以下语句不会解析为相同的SQL区域：</p><pre class="oac_no_warn" dir="ltr">SELECT count（1）FROM employees WHERE manager_id = 121; SELECT count（1）FROM employees WHERE manager_id = 247;</pre><p>此规则的唯一例外是当<code class="codeph">CURSOR_SHARING</code>参数设置为<code class="codeph">FORCE</code> ，在这种情况下类似的语句可以共享SQL区域。有关游标共享所涉及的成本和收益的信息，请参阅<span class="q">“ <a href="tuning-shared-pool-and-large-pool.html#GUID-40A8C949-9B20-4217-A730-FE8A910B358F">共享游标</a> ”</span> 。
                              </p>
                           </li>
                           <li>
                              <p>将已发布语句中引用的对象与共享池中所有现有语句的引用对象进行比较，以确保它们完全相同。</p>
                              <p>对SQL语句或PL / SQL块中的模式对象的引用必须解析为同一模式中的同一对象。例如，如果两个用户分别发出以下SQL语句但它们各自都有自己的<code class="codeph">employees</code>表，则该语句不会被视为相同，因为该语句为每个用户引用了不同的表：</p><pre class="oac_no_warn" dir="ltr">SELECT * FROM员工;</pre></li>
                           <li>
                              <p>SQL语句中的绑定变量必须在名称，数据类型和长度方面匹配。</p>
                              <p>例如，以下语句不能使用相同的共享SQL区域，因为绑定变量名称不同：</p><pre class="oac_no_warn" dir="ltr">SELECT * FROM employees WHERE department_id =：department_id; SELECT * FROM employees WHERE department_id =：dept_id;</pre><p>许多Oracle产品（例如Oracle Forms和预编译器）在将语句传递到数据库之前转换SQL。字符统一更改为大写，压缩空格，并重命名绑定变量，以便生成一组一致的SQL语句。</p>
                           </li>
                           <li>
                              <p>会话的环境必须相同。</p>
                              <p>例如，必须使用相同的优化目标优化SQL语句。</p>
                           </li>
                        </ol>
                        <div class="infoboxnotealso" id="GUID-BE6DFC00-A436-4908-A711-9127FABB6809__GUID-F540CE9A-05E8-4B4D-8FCC-E39FF54709A9">
                           <p class="notep1">也可以看看：</p>
                           <p>有关<code class="codeph">CURSOR_SHARING</code>初始化参数的信息，请<a href="../refrn/CURSOR_SHARING.html#REFRN-GUID-455358F8-D657-49A2-B32B-13A1DC53E7D2" target="_blank"><span class="italic">参见Oracle数据库参考</span></a></p>
                        </div>
                     </div>
                  </div>
               </div>
            </div><a id="TGDBA565"></a><div class="props_rev_3"><a id="GUID-901C4010-2B6A-4E50-A02E-77830BB7E70D" name="GUID-901C4010-2B6A-4E50-A02E-77830BB7E70D"></a><h3 id="TGDBA-GUID-901C4010-2B6A-4E50-A02E-77830BB7E70D" class="sect3"><span class="enumeration_section">14.2</span>使用共享池</h3>
               <div>
                  <p>共享池的一个重要目的是缓存SQL和PL / SQL语句的可执行版本。这使得可以执行相同SQL或PL / SQL代码的多次执行，而无需硬解析所需的资源，从而显着减少CPU，内存和锁存器使用。</p>
                  <p>共享池还能够支持数据仓库应用程序中的非共享SQL，这些应用程序执行低并发，高资源的SQL语句。在这种情况下，建议使用带有文字值的非共享SQL。使用文字值而不是绑定变量使优化器能够进行良好的列选择性估计，从而提供最佳的数据访问计划。</p>
                  <p>在高货币在线事务处理（OLTP）系统中，有效使用共享池可显着降低与解析相关的应用程序可伸缩性问题的可能性。有几种方法可以确保在OLTP系统中有效使用共享池和相关资源：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="tuning-shared-pool-and-large-pool.html#GUID-5E75A07B-6A65-47E9-BD77-78C9BC93B2FB">使用共享游标</a></p>
                     </li>
                     <li>
                        <p><a href="tuning-shared-pool-and-large-pool.html#GUID-CA892C0A-60BB-4E45-AC8D-D80092BEA13A">使用单用户登录和限定表引用</a></p>
                     </li>
                     <li>
                        <p><a href="tuning-shared-pool-and-large-pool.html#GUID-E3F2ADA0-18DB-47C2-B1CD-4DEE8E9DEF85">使用PL / SQL</a></p>
                     </li>
                     <li>
                        <p><a href="tuning-shared-pool-and-large-pool.html#GUID-9FEE657D-0CB1-451B-8CD3-4FC15E95C9E2">避免执行DDL操作</a></p>
                     </li>
                     <li>
                        <p><a href="tuning-shared-pool-and-large-pool.html#GUID-2951BB9C-FCCE-47C8-B48A-FCCBB63AC141">缓存序列号</a></p>
                     </li>
                     <li>
                        <p><a href="tuning-shared-pool-and-large-pool.html#GUID-25C7A1B1-CA7F-4812-97E2-95EA558AC778">控制光标访问</a></p>
                     </li>
                     <li>
                        <p><a href="tuning-shared-pool-and-large-pool.html#GUID-A2FF092A-18CE-46E0-903C-039105272CDC">保持持久连接</a></p>
                     </li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-901C4010-2B6A-4E50-A02E-77830BB7E70D__GUID-A32CBF4C-5373-45BF-A251-289782B138EC">
                     <p class="notep1">也可以看看：</p>
                     <p><a href="../vldbg/parameters-parallel-exec.html#VLDBG-GUID-8189FBCD-0A9D-4B4D-ACE9-864B2778EE07" target="_blank"><span class="italic">“Oracle数据库VLDB和分区指南”，</span></a>以获取有关并行查询执行对共享池的影响的信息</p>
                  </div>
               </div><a id="TGDBA566"></a><div class="props_rev_3"><a id="GUID-5E75A07B-6A65-47E9-BD77-78C9BC93B2FB" name="GUID-5E75A07B-6A65-47E9-BD77-78C9BC93B2FB"></a><h4 id="TGDBA-GUID-5E75A07B-6A65-47E9-BD77-78C9BC93B2FB" class="sect4"><span class="enumeration_section">14.2.1</span>使用共享游标</h4>
                  <div>
                     <p>对运行相同应用程序的多个用户重用共享SQL可避免硬解析。软解析可显着减少资源的使用，例如共享池和库高速缓存锁存器。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-5E75A07B-6A65-47E9-BD77-78C9BC93B2FB__GUID-2790BADD-F641-44BE-9A6E-BF7EDBB12CBD">要使用共享游标：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>尽可能在SQL语句中使用绑定变量而不是文字。</p>
                              <p>例如，以下两个SQL语句不能使用相同的共享区域，因为它们与字符的字符不匹配：</p><pre class="oac_no_warn" dir="ltr">SELECT employee_id FROM employees WHERE department_id = 10; SELECT employee_id FROM employees WHERE department_id = 20;</pre><p>用绑定变量替换文字只会导致一个可以执行两次的SQL语句：</p><pre class="oac_no_warn" dir="ltr">SELECT employee_id FROM employees WHERE department_id =：dept_id;</pre><p>对于不能重写代码以使用绑定变量的现有应用程序，请使用<a id="d41928e724" class="indexterm-anchor"></a> <code class="codeph">CURSOR_SHARING</code>初始化参数，以避免一些硬分析开销，如<span class="q">“ <a href="tuning-shared-pool-and-large-pool.html#GUID-40A8C949-9B20-4217-A730-FE8A910B358F">共享游标</a> ”中所述</span> 。
                              </p>
                           </li>
                           <li>
                              <p>避免导致大量用户发布动态非共享SQL语句的应用程序设计。</p>
                              <p>通常，使用预设查询可以满足大多数用户所需的大多数数据。使用需要此类功能的动态SQL。</p>
                           </li>
                           <li>
                              <p>确保应用程序的用户不会更改其各个会话的优化方法和目标。</p>
                           </li>
                           <li>
                              <p>为应用程序开发人员建立以下策略：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>标准化绑定变量的命名约定和SQL语句和PL / SQL块的间距约定。</p>
                                 </li>
                                 <li>
                                    <p>尽可能考虑使用存储过程。</p>
                                    <p>发出相同存储过程的多个用户自动使用相同的共享PL / SQL区域。因为存储过程以解析的形式存储，所以它们的使用减少了运行时解析。</p>
                                 </li>
                              </ul>
                           </li>
                           <li>
                              <p>对于相同但未共享的SQL语句，请查询<code class="codeph">V$SQL_SHARED_CURSOR</code>视图以确定不共享游标的原因。
                              </p>
                              <p>这包括优化器设置和绑定变量不匹配。</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-5E75A07B-6A65-47E9-BD77-78C9BC93B2FB__GUID-41BB419C-DEC9-4921-89C5-2C0BCCC2AB25">
                           <p class="notep1">也可以看看：</p>
                           <p>有关游标共享的详细信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tgdba&amp;id=TGSQL-GUID-971F4652-3950-4662-82DE-713DDEED317C" target="_blank"><span class="italic">参见“Oracle数据库SQL调优指南”</span></a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="TGDBA567"></a><div class="props_rev_3"><a id="GUID-CA892C0A-60BB-4E45-AC8D-D80092BEA13A" name="GUID-CA892C0A-60BB-4E45-AC8D-D80092BEA13A"></a><h4 id="TGDBA-GUID-CA892C0A-60BB-4E45-AC8D-D80092BEA13A" class="sect4"><span class="enumeration_section">14.2.2</span>使用单用户登录和限定表引用</h4>
                  <div>
                     <p>在用户使用自己的用户登录登录数据库的大型OLTP系统中，显式限定段所有者而不是使用公共同义词会显着减少字典高速缓存中的条目数。</p>
                     <p>限定表名的替代方法是通过单个用户登录连接到数据库，而不是单个用户登录。用户级验证可以在中间层本地进行。</p>
                  </div>
               </div><a id="TGDBA568"></a><div class="props_rev_3"><a id="GUID-E3F2ADA0-18DB-47C2-B1CD-4DEE8E9DEF85" name="GUID-E3F2ADA0-18DB-47C2-B1CD-4DEE8E9DEF85"></a><h4 id="TGDBA-GUID-E3F2ADA0-18DB-47C2-B1CD-4DEE8E9DEF85" class="sect4"><span class="enumeration_section">14.2.3</span>使用PL / SQL</h4>
                  <div>
                     <p>使用存储的PL / SQL包可以克服具有数千个用户的系统的许多可伸缩性问题，每个用户都具有单独的用户登录和公共同义词。这是因为包作为所有者而不是调用者执行，这大大减少了字典缓存负载。</p>
                     <div class="infoboxnote" id="GUID-E3F2ADA0-18DB-47C2-B1CD-4DEE8E9DEF85__GUID-91D40304-7A45-476C-8895-3DBEE5D8C1D7">
                        <p class="notep1">注意：</p>
                        <p>Oracle鼓励使用definer权限包来克服可伸缩性问题。减少字典缓存加载的好处不如调用者的权限包那么好。</p>
                     </div>
                  </div>
               </div><a id="TGDBA569"></a><div class="props_rev_3"><a id="GUID-9FEE657D-0CB1-451B-8CD3-4FC15E95C9E2" name="GUID-9FEE657D-0CB1-451B-8CD3-4FC15E95C9E2"></a><h4 id="TGDBA-GUID-9FEE657D-0CB1-451B-8CD3-4FC15E95C9E2" class="sect4"><span class="enumeration_section">14.2.4</span>避免执行DDL操作</h4>
                  <div>
                     <p>避免在高峰时段对高使用率段执行DDL操作。对这些段执行DDL操作通常会导致依赖SQL失效并在以后的执行中重新解析。</p>
                  </div>
               </div><a id="TGDBA570"></a><div class="props_rev_3"><a id="GUID-2951BB9C-FCCE-47C8-B48A-FCCBB63AC141" name="GUID-2951BB9C-FCCE-47C8-B48A-FCCBB63AC141"></a><h4 id="TGDBA-GUID-2951BB9C-FCCE-47C8-B48A-FCCBB63AC141" class="sect4"><span class="enumeration_section">14.2.5</span>缓存序列号</h4>
                  <div>
                     <p>为频繁更新的序列号分配足够的缓存空间可显着降低字典缓存锁定的频率，从而提高可伸缩性。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-2951BB9C-FCCE-47C8-B48A-FCCBB63AC141__GUID-E2D8AC78-5183-49E8-90E2-1B23726C316B">要配置每个序列的缓存条目数：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>在<code class="codeph">CREATE</code> <code class="codeph">SEQUENCE</code>或<code class="codeph">ALTER</code> <code class="codeph">SEQUENCE</code>语句中使用<code class="codeph">CACHE</code>关键字。
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="TGDBA571"></a><div class="props_rev_3"><a id="GUID-25C7A1B1-CA7F-4812-97E2-95EA558AC778" name="GUID-25C7A1B1-CA7F-4812-97E2-95EA558AC778"></a><h4 id="TGDBA-GUID-25C7A1B1-CA7F-4812-97E2-95EA558AC778" class="sect4"><span class="enumeration_section">14.2.6</span>控制光标访问</h4>
                  <div>
                     <p><a id="d41928e1053" class="indexterm-anchor"></a><a id="d41928e1057" class="indexterm-anchor"></a><a id="d41928e1061" class="indexterm-anchor"></a>根据您的应用程序工具，您可以通过控制游标访问来控制应用程序执行解析调用的频率。
                     </p>
                     <p>应用程序关闭游标或重新使用现有游标以获取新SQL语句的频率会影响会话使用的内存量，通常会影响该会话执行的解析量。关闭游标或重用游标（用于不同的SQL语句）的应用程序不需要像保持游标打开的应用程序那样多的会话内存。相反，相同的应用程序可能需要使用更多的CPU和数据库资源来执行更多的解析调用</p>
                     <p>与未经常执行的SQL语句关联的游标可以关闭或重用于其他语句，因为重新执行（和重新分析）该语句的可能性很低。当包含将重新执行的SQL语句的游标关闭或重用于另一个语句时，需要额外的解析调用。如果光标保持打开状态，它可能已经被重用而没有发出解析调用的开销。</p>
                     <p>控制游标访问的方式取决于您的应用程序开发工具。本节介绍用于Oracle数据库工具的方法：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="tuning-shared-pool-and-large-pool.html#GUID-F3588C24-9678-4B7D-AF51-AF8D8277089A">使用OCI控制光标访问</a></p>
                        </li>
                        <li>
                           <p><a href="tuning-shared-pool-and-large-pool.html#GUID-CCB48FA6-C4FE-4853-9CE6-0826433ED341">使用Oracle预编译器控制游标访问</a></p>
                        </li>
                        <li>
                           <p><a href="tuning-shared-pool-and-large-pool.html#GUID-46E76F9C-71A7-4229-BCCE-A617E74CB2F6">使用SQLJ控制游标访问</a></p>
                        </li>
                        <li>
                           <p><a href="tuning-shared-pool-and-large-pool.html#GUID-E83799DC-CA41-4E44-B463-1D4E4A470591">使用JDBC控制游标访问</a></p>
                        </li>
                        <li>
                           <p><a href="tuning-shared-pool-and-large-pool.html#GUID-F79E99F4-B75A-4066-8CA8-BA37BDC1A119">使用Oracle Forms控制游标访问</a></p>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-25C7A1B1-CA7F-4812-97E2-95EA558AC778__GUID-0B7DC4A1-39C5-4EFC-A9B1-D5AE0D719272">
                        <p class="notep1">也可以看看：</p>
                        <p>有关每个工具的信息的工具特定文档</p>
                     </div>
                  </div><a id="TGDBA572"></a><div class="props_rev_3"><a id="GUID-F3588C24-9678-4B7D-AF51-AF8D8277089A" name="GUID-F3588C24-9678-4B7D-AF51-AF8D8277089A"></a><h5 id="TGDBA-GUID-F3588C24-9678-4B7D-AF51-AF8D8277089A" class="sect5"><span class="enumeration_section">14.2.6.1</span>使用OCI控制光标访问</h5>
                     <div>
                        <p>使用Oracle调用接口（OCI）时，请不要关闭并重新打开将要重新执行的游标。相反，保持游标打开，并在执行之前更改绑定变量中的文字值。</p>
                        <p>当将来重新执行现有SQL语句时，避免重用新SQL语句的语句句柄。</p>
                     </div>
                  </div><a id="TGDBA573"></a><div class="props_rev_3"><a id="GUID-CCB48FA6-C4FE-4853-9CE6-0826433ED341" name="GUID-CCB48FA6-C4FE-4853-9CE6-0826433ED341"></a><h5 id="TGDBA-GUID-CCB48FA6-C4FE-4853-9CE6-0826433ED341" class="sect5"><span class="enumeration_section">14.2.6.2</span>使用Oracle预编译<span class="enumeration_section">器</span>控制游标访问</h5>
                     <div>
                        <p>使用时<a id="d41928e1205" class="indexterm-anchor"></a> Oracle预编译器，您可以通过设置预编译器子句来控制何时关闭游标。在Oracle模式下，子句如下：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">HOLD_CURSOR =是</code> <a id="d41928e1216" class="indexterm-anchor"></a></p>
                           </li>
                           <li>
                              <p><code class="codeph">RELEASE_CURSOR = NO</code> <a id="d41928e1223" class="indexterm-anchor"></a></p>
                           </li>
                           <li>
                              <p><code class="codeph">MAXOPENCURSORS =</code> <span class="italic"><code class="codeph">desired_value</code></span> <a id="d41928e1233" class="indexterm-anchor"></a> 
                              </p>
                           </li>
                        </ul>
                        <p>可以在预编译器命令行或预编译器程序中指定预编译器子句。Oracle建议您不要使用ANSI模式，其中切换<code class="codeph">HOLD_CURSOR</code>和<code class="codeph">RELEASE_CURSOR</code>的值。
                        </p>
                        <div class="infoboxnotealso" id="GUID-CCB48FA6-C4FE-4853-9CE6-0826433ED341__GUID-4697CE18-FDDD-4ABE-97C8-28C477A6FE35">
                           <p class="notep1">也可以看看：</p>
                           <p>有关这些子句的信息，请参阅语言的预编译器手册</p>
                        </div>
                     </div>
                  </div><a id="TGDBA574"></a><div class="props_rev_3"><a id="GUID-46E76F9C-71A7-4229-BCCE-A617E74CB2F6" name="GUID-46E76F9C-71A7-4229-BCCE-A617E74CB2F6"></a><h5 id="TGDBA-GUID-46E76F9C-71A7-4229-BCCE-A617E74CB2F6" class="sect5"><span class="enumeration_section">14.2.6.3</span>使用SQLJ控制光标访问</h5>
                     <div>
                        <p>准备SQL语句，然后使用绑定变量的新值重新执行该语句。光标在会话期间保持打开状态。</p>
                        <div class="infoboxnote" id="GUID-46E76F9C-71A7-4229-BCCE-A617E74CB2F6__GUID-D3E6AC5B-352E-4468-A014-5416C1C630A3">
                           <p class="notep1">注意：</p>从Oracle Database 12 <span class="italic">c</span>第2版（12.2）开始，不支持服务器端SQLJ代码，也就是说，不能在存储过程，函数和触发器中使用SQLJ代码。
                        </div>
                     </div>
                  </div><a id="TGDBA575"></a><div class="props_rev_3"><a id="GUID-E83799DC-CA41-4E44-B463-1D4E4A470591" name="GUID-E83799DC-CA41-4E44-B463-1D4E4A470591"></a><h5 id="TGDBA-GUID-E83799DC-CA41-4E44-B463-1D4E4A470591" class="sect5"><span class="enumeration_section">14.2.6.4</span>使用JDBC控制游标访问</h5>
                     <div>
                        <p>如果将重新执行游标，则避免关闭游标，因为新的文本值可以绑定到游标以便重新执行。或者，JDBC使用<code class="codeph">setStmtCacheSize()</code>方法在JDBC客户端中提供SQL语句高速缓存。使用此方法，JDBC将创建一个JDBC语句本地的SQL语句高速缓存。
                        </p>
                        <div class="infoboxnotealso" id="GUID-E83799DC-CA41-4E44-B463-1D4E4A470591__GUID-829B7453-EAAC-43BE-8901-C9F4738D6E32">
                           <p class="notep1">也可以看看：</p>
                           <p>有关使用JDBC SQL语句高速缓存的信息，请参见<a href="../jjdbc/statement-and-resultset-caching.html#JJDBC-GUID-F3F4BB63-356A-4F65-81B1-5C84FC35A16D" target="_blank"><span class="italic">“Oracle数据库JDBC开发人员指南”</span></a></p>
                        </div>
                     </div>
                  </div><a id="TGDBA576"></a><div class="props_rev_3"><a id="GUID-F79E99F4-B75A-4066-8CA8-BA37BDC1A119" name="GUID-F79E99F4-B75A-4066-8CA8-BA37BDC1A119"></a><h5 id="TGDBA-GUID-F79E99F4-B75A-4066-8CA8-BA37BDC1A119" class="sect5"><span class="enumeration_section">14.2.6.5</span>使用Oracle Forms控制游标访问</h5>
                     <div>
                        <p>同<a id="d41928e1416" class="indexterm-anchor"></a><a id="d41928e1420" class="indexterm-anchor"></a>在Oracle Forms中，可以在运行时控制游标访问的某些方面，触发级别或表单级别。
                        </p>
                     </div>
                  </div>
               </div><a id="TGDBA577"></a><div class="props_rev_3"><a id="GUID-A2FF092A-18CE-46E0-903C-039105272CDC" name="GUID-A2FF092A-18CE-46E0-903C-039105272CDC"></a><h4 id="TGDBA-GUID-A2FF092A-18CE-46E0-903C-039105272CDC" class="sect4"><span class="enumeration_section">14.2.7</span>维护持久连接</h4>
                  <div>
                     <p>具有中间层的大型OLTP应用程序应保持连接，而不是为每个数据库请求连接和断开连接。维护持久连接可节省CPU资源和数据库资源，例如锁存器。</p>
                  </div>
               </div>
            </div><a id="TGDBA578"></a><div class="props_rev_3"><a id="GUID-5823285C-A728-4006-8813-41BB92928F73" name="GUID-5823285C-A728-4006-8813-41BB92928F73"></a><h3 id="TGDBA-GUID-5823285C-A728-4006-8813-41BB92928F73" class="sect3"><span class="enumeration_section">14.3</span>配置共享池</h3>
               <div>
                  <p>本节介绍如何配置共享池，并包含以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="tuning-shared-pool-and-large-pool.html#GUID-278E124D-F24B-4D55-A556-4DC098320654">调整共享池的大小</a></p>
                     </li>
                     <li>
                        <p><a href="tuning-shared-pool-and-large-pool.html#GUID-B1867602-00BF-43CD-9FAB-3C9829358CDD">释放游标</a></p>
                     </li>
                     <li>
                        <p><a href="tuning-shared-pool-and-large-pool.html#GUID-C13EE398-F162-4A23-8393-393D71133004">缓存会话游标</a></p>
                     </li>
                     <li>
                        <p><a href="tuning-shared-pool-and-large-pool.html#GUID-40A8C949-9B20-4217-A730-FE8A910B358F">共享游标</a></p>
                     </li>
                     <li>
                        <p><a href="tuning-shared-pool-and-large-pool.html#GUID-E0D415CA-C4A7-4588-ADF2-4E302CE25849">保持大型物体防止老化</a></p>
                     </li>
                     <li>
                        <p><a href="tuning-shared-pool-and-large-pool.html#GUID-7FD646B3-FCE3-4D3C-B988-C8D138FFD514">配置保留池</a></p>
                     </li>
                  </ul>
               </div><a id="TGDBA579"></a><div class="props_rev_3"><a id="GUID-278E124D-F24B-4D55-A556-4DC098320654" name="GUID-278E124D-F24B-4D55-A556-4DC098320654"></a><h4 id="TGDBA-GUID-278E124D-F24B-4D55-A556-4DC098320654" class="sect4"><span class="enumeration_section">14.3.1</span>调整共享池的大小</h4>
                  <div>
                     <p>配置新数据库实例时，很难知道共享池缓存的正确大小。通常，DBA首先估计缓存大小，然后在实例上运行代表性工作负载，并检查相关统计信息以查看缓存是否配置不足或配置过多。</p>
                     <p>对于大多数OLTP应用程序，共享池大小是应用程序性能的重要因素。对于发布数量非常有限的离散SQL语句的应用程序（如决策支持系统（DSS）），共享池大小不太重要。</p>
                     <p>如果共享池太小，则使用额外资源来管理有限的可用空间量。这会消耗CPU和锁存资源，并导致争用。理想情况下，共享池应该足够大，以便缓存经常访问的对象。共享池中有大量可用内存是浪费内存。在数据库运行后检查统计信息时，请确保工作负载中不存在任何这些错误。</p>
                     <p>本节介绍如何调整共享池的大小，并包含以下主题：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="tuning-shared-pool-and-large-pool.html#GUID-B3D48D5B-D19D-4E0F-84F0-1276FA113581">使用库缓存统计信息</a></p>
                        </li>
                        <li>
                           <p><a href="tuning-shared-pool-and-large-pool.html#GUID-835D3E6D-1FF9-44ED-B22A-44C4101A4A9C">使用共享池咨询统计信息</a></p>
                        </li>
                        <li>
                           <p><a href="tuning-shared-pool-and-large-pool.html#GUID-BA84D70F-4325-4229-AEC9-06DF7059F1FB">使用字典缓存统计</a></p>
                        </li>
                        <li>
                           <p><a href="tuning-shared-pool-and-large-pool.html#GUID-220BC80E-FD16-4259-A7C1-E1967C510CAE">增加分配给共享池的内存</a></p>
                        </li>
                        <li>
                           <p><a href="tuning-shared-pool-and-large-pool.html#GUID-813F1711-5A90-45BE-B113-C0CEF6DD3048">减少分配给共享池的内存</a></p>
                        </li>
                     </ul>
                  </div><a id="TGDBA580"></a><div class="props_rev_3"><a id="GUID-B3D48D5B-D19D-4E0F-84F0-1276FA113581" name="GUID-B3D48D5B-D19D-4E0F-84F0-1276FA113581"></a><h5 id="TGDBA-GUID-B3D48D5B-D19D-4E0F-84F0-1276FA113581" class="sect5"><span class="enumeration_section">14.3.1.1</span>使用库缓存统计信息</h5>
                     <div>
                        <p>调整共享池的大小时，目标是缓存在库高速缓存中多次执行的SQL语句，而不会过度分配内存。要完成此目标，请检查以下库高速缓存统计信息：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">重装</code></p>
                              <p><code class="codeph">V$LIBRARYCACHE</code>视图中的<code class="codeph">RELOADS</code>列显示了从缓存中老化的先前缓存的SQL语句的重新加载（或重新分析）的数量。如果应用程序有效地重用SQL并在具有最佳共享池大小的系统上运行，则此统计信息应具有接近零的值。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">废票</code></p>
                              <p><code class="codeph">V$LIBRARYCACHE</code>视图中的<code class="codeph">INVALIDATIONS</code>列显示库高速缓存数据无效并且必须重新分析的次数。此统计信息的值应接近零，尤其是在峰值负载期间的OLTP系统上。这意味着可以共享的SQL语句由某些操作（例如DDL）无效。
                              </p>
                           </li>
                           <li>
                              <p>库缓存命中率</p>
                              <p>库高速缓存命中率是库高速缓存运行状况的广泛指示。应该将此值与其他统计信息一起考虑，例如硬解析速率以及是否存在任何共享池或库高速缓存锁存器争用。</p>
                           </li>
                           <li>
                              <p>共享池中的可用内存量</p>
                              <p>要查看共享池中的可用内存量，请查询<code class="codeph">V$SGASTAT</code>性能视图。理想情况下，可用内存应尽可能低，而不会导致系统上的任何重新分析。
                              </p>
                           </li>
                        </ul>
                        <p>以下部分描述了如何查看和检查这些库高速缓存统计信息：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="tuning-shared-pool-and-large-pool.html#GUID-0A2DD50D-D1D3-4B70-BCE7-74CB51DD6B36">使用V $ LIBRARYCACHE视图</a></p>
                           </li>
                           <li>
                              <p><a href="tuning-shared-pool-and-large-pool.html#GUID-CB036110-C43F-4265-8084-C721FEA037E0">计算库高速缓存命中率</a></p>
                           </li>
                           <li>
                              <p><a href="tuning-shared-pool-and-large-pool.html#GUID-8CA2015B-91BB-4730-B3C0-4BA90DD3C6FB">查看共享池中的可用内存量</a></p>
                           </li>
                        </ul>
                     </div><a id="TGDBA582"></a><a id="TGDBA581"></a><div class="props_rev_3"><a id="GUID-0A2DD50D-D1D3-4B70-BCE7-74CB51DD6B36" name="GUID-0A2DD50D-D1D3-4B70-BCE7-74CB51DD6B36"></a><h6 id="TGDBA-GUID-0A2DD50D-D1D3-4B70-BCE7-74CB51DD6B36" class="sect6"><span class="enumeration_section">14.3.1.1.1</span>使用V $ LIBRARYCACHE视图</h6>
                        <div>
                           <div class="section">
                              <p>使用<code class="codeph">V$LIBRARYCACHE</code>视图监视反映库缓存活动的统计信息。这些统计信息反映了最新数据库实例启动后的所有库缓存活动。
                              </p>
                              <p>此视图中的每一行都包含库缓存中保留的一种项目的统计信息。每行描述的项目由<code class="codeph">NAMESPACE</code>的值标识<a id="d41928e1809" class="indexterm-anchor"></a><a id="d41928e1813" class="indexterm-anchor"></a>柱。具有以下<code class="codeph">NAMESPACE</code>值的行反映了SQL语句和PL / SQL块的库高速缓存活动：</p>
                           </div>
                           <!-- class="section" -->
                           <div class="section">
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><code class="codeph">SQL</code> <code class="codeph">AREA</code></p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">表/程序</code></p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">身体</code></p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">触发</code></p>
                                 </li>
                              </ul>
                              <p>具有其他<code class="codeph">NAMESPACE</code>值的行反映了Oracle数据库用于依赖项维护的对象定义的库高速缓存活动。
                              </p>
                              <p><a href="tuning-shared-pool-and-large-pool.html#GUID-0A2DD50D-D1D3-4B70-BCE7-74CB51DD6B36__BABGHDDI">示例14-1</a>显示了此视图的查询，以单独检查每个命名空间。
                              </p>
                           </div>
                           <!-- class="section" -->
                           <div class="example" id="GUID-0A2DD50D-D1D3-4B70-BCE7-74CB51DD6B36__BABGHDDI">
                              <p class="titleinexample">示例14-1查询V $ LIBRARYCACHE视图</p><pre class="oac_no_warn" dir="ltr">SELECT命名空间，引脚，pinhits，重载，失效FROM V $ LIBRARYCACHE ORDER BY namespace;</pre><p>此查询的输出可能如下所示：</p><pre class="oac_no_warn" dir="ltr">NAMESPACE PINS PINHITS RELOADS INVALIDATIONS --------------- ---------- ---------- ---------- ------------- BODY 8870 8819 0 0 CLUSTER 393 380 0 0 INDEX 29 0 0 0 OBJECT 0 0 0 0 PIPE 55265 55263 0 0 SQL AREA 21536413 21520516 11204 2表/过程10775684 10774401 0 0 TRIGGER 1852 1844 0 0</pre><p>在此示例中，输出显示：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>对于<code class="codeph">SQL AREA</code>命名空间，有21,536,413次执行。
                                    </p>
                                 </li>
                                 <li>
                                    <p>这些执行中有11,204个导致库高速缓存未命中，要求数据库隐式重新分析语句或块，或者重新加载对象定义，因为它已从库高速缓存中老化。</p>
                                 </li>
                                 <li>
                                    <p>SQL语句失效两次，再次导致库缓存未命中。</p>
                                 </li>
                              </ul>
                              <div class="infoboxnote" id="GUID-0A2DD50D-D1D3-4B70-BCE7-74CB51DD6B36__GUID-6DB7DAED-1410-4C35-8380-CB2E0009C273">
                                 <p class="notep1">注意：</p>
                                 <p>此查询从实例启动返回数据。使用间隔收集的统计信息可以更好地识别问题。有关在一定时间间隔内收集信息的信息，请参阅<a href="automatic-performance-diagnostics.html#GUID-843A596D-2D8B-422D-9C8D-73C0EF52739D" title="从Oracle Database 12c开始，默认情况下在多租户容器数据库（CDB）的根容器中启用ADDM。从Oracle Database 19c开始，您还可以在可插拔数据库（PDB）中使用ADDM。默认情况下，ADDM在可插拔数据库（PDB）中不起作用，因为默认情况下在PDB中禁用自动AWR快照。要在PDB中使用ADDM，必须通过将AWR_PDB_AUTOFLUSH_ENABLED初始化参数设置为TRUE且AWR快照间隔大于0来在PDB中启用自动AWR快照。">自动性能诊断</a> 。
                                 </p>
                              </div>
                              <div class="infoboxnotealso" id="GUID-0A2DD50D-D1D3-4B70-BCE7-74CB51DD6B36__GUID-E7D8C47B-1921-4AA9-9B27-F8BBD453E6F5">
                                 <p class="notep1">也可以看看：</p>
                                 <p> 有关<code class="codeph">V$LIBRARYCACHE</code>视图的信息，请<a href="../refrn/V-LIBRARYCACHE.html#REFRN-GUID-3BE0F434-A392-42C9-BD77-FD2A7B72D6DB" target="_blank"><span class="italic">参见Oracle数据库参考</span></a></p>
                              </div>
                           </div>
                           <!-- class="example" -->
                        </div>
                     </div><a id="TGDBA583"></a><div class="props_rev_3"><a id="GUID-CB036110-C43F-4265-8084-C721FEA037E0" name="GUID-CB036110-C43F-4265-8084-C721FEA037E0"></a><h6 id="TGDBA-GUID-CB036110-C43F-4265-8084-C721FEA037E0" class="sect6"><span class="enumeration_section">14.3.1.1.2</span>计算库高速缓存命中率</h6>
                        <div>
                           <div class="section">
                              <p>要计算库高速缓存命中率，请使用以下公式：</p><pre class="oac_no_warn" dir="ltr">库高速缓存命中率=总和（pinhits）/ sum（引脚）</pre><p>将库高速缓存命中率公式应用于<a href="tuning-shared-pool-and-large-pool.html#GUID-0A2DD50D-D1D3-4B70-BCE7-74CB51DD6B36__BABGHDDI">示例14-1会</a>导致以下库高速缓存命中率：</p><pre class="oac_no_warn" dir="ltr">SUM（PINHITS）/ SUM（PINS）---------------------- .999466248</pre><p>在此示例中，命中百分比约为99.94％，这意味着只有.06％的执行导致重新分析。</p>
                           </div>
                           <!-- class="section" -->
                        </div>
                     </div><a id="TGDBA585"></a><a id="TGDBA584"></a><div class="props_rev_3"><a id="GUID-8CA2015B-91BB-4730-B3C0-4BA90DD3C6FB" name="GUID-8CA2015B-91BB-4730-B3C0-4BA90DD3C6FB"></a><h6 id="TGDBA-GUID-8CA2015B-91BB-4730-B3C0-4BA90DD3C6FB" class="sect6"><span class="enumeration_section">14.3.1.1.3</span>查看共享池中的<span class="enumeration_section">可用</span>内存量</h6>
                        <div>
                           <div class="section">
                              <p>在<code class="codeph">V$SGASTAT</code>视图中报告共享池中的可用内存量。
                              </p>
                              <p><a href="tuning-shared-pool-and-large-pool.html#GUID-8CA2015B-91BB-4730-B3C0-4BA90DD3C6FB__BABCHDBJ">例14-2</a>显示了该视图的查询。
                              </p>
                           </div>
                           <!-- class="section" -->
                           <div class="example" id="GUID-8CA2015B-91BB-4730-B3C0-4BA90DD3C6FB__BABCHDBJ">
                              <p class="titleinexample">例14-2查询V $ SGASTAT视图</p><pre class="oac_no_warn" dir="ltr">SELECT * FROM V $ SGASTAT WHERE name ='free memory'AND pool ='shared pool';</pre><p>此查询的输出可能如下所示：</p><pre class="oac_no_warn" dir="ltr">POOL NAME BYTES ----------- -------------------------- ----------共享池可用内存4928280</pre><p>如果共享池中始终提供可用内存，则增加其大小几乎不会带来任何好处。然而，仅仅因为共享池已满，并不一定意味着存在问题。它可能表示配置良好的系统。</p>
                           </div>
                           <!-- class="example" -->
                        </div>
                     </div>
                  </div><a id="TGDBA586"></a><div class="props_rev_3"><a id="GUID-835D3E6D-1FF9-44ED-B22A-44C4101A4A9C" name="GUID-835D3E6D-1FF9-44ED-B22A-44C4101A4A9C"></a><h5 id="TGDBA-GUID-835D3E6D-1FF9-44ED-B22A-44C4101A4A9C" class="sect5"><span class="enumeration_section">14.3.1.2</span>使用共享池咨询统计信息</h5>
                     <div>
                        <p>可用于库高速缓存的内存量可能会极大地影响Oracle数据库的解析速率。为了帮助您正确调整库高速缓存的大小，Oracle数据库提供了以下共享池顾问视图：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">V $ SHARED_POOL_ADVICE</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">V $ LIBRARY_CACHE_MEMORY</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">V $ JAVA_POOL_ADVICE</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">V $ JAVA_LIBRARY_CACHE_MEMORY</code></p>
                           </li>
                        </ul>
                        <p>这些共享池顾问视图提供有关库高速缓存内存的信息，使您能够预测更改共享池大小如何影响共享池中对象的老化。这些视图中的共享池顾问统计信息跟踪库高速缓存对共享池内存的使用，并预测库高速缓存在不同大小的共享池中的行为方式。使用这些视图可以确定：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>库缓存使用了多少内存</p>
                           </li>
                           <li>
                              <p>当前固定了多少内存</p>
                           </li>
                           <li>
                              <p>共享池的最近最少使用（LRU）列表中有多少内存</p>
                           </li>
                           <li>
                              <p>通过更改共享池的大小可能会丢失或获得多少时间</p>
                           </li>
                        </ul>
                        <p>启用共享池通报时，这些视图显示共享池通报统计信息。禁用通报时重置统计信息。</p>
                        <p>以下部分更详细地描述了这些视图：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="tuning-shared-pool-and-large-pool.html#GUID-55833338-4B36-4742-8BBA-336DC130C481">关于V $ SHARED_POOL_ADVICE视图</a></p>
                           </li>
                           <li>
                              <p><a href="tuning-shared-pool-and-large-pool.html#GUID-C7190867-D593-4C78-9B3B-500CFC756076">关于V $ LIBRARY_CACHE_MEMORY视图</a></p>
                           </li>
                           <li>
                              <p><a href="tuning-shared-pool-and-large-pool.html#GUID-A1A06734-2F03-42A7-951C-BEC88691BFC9">关于V $ JAVA_POOL_ADVICE和V $ JAVA_LIBRARY_CACHE_MEMORY视图</a></p>
                           </li>
                        </ul>
                     </div><a id="TGDBA587"></a><div class="props_rev_3"><a id="GUID-55833338-4B36-4742-8BBA-336DC130C481" name="GUID-55833338-4B36-4742-8BBA-336DC130C481"></a><h6 id="TGDBA-GUID-55833338-4B36-4742-8BBA-336DC130C481" class="sect6"><span class="enumeration_section">14.3.1.2.1</span>关于V $ SHARED_POOL_ADVICE视图</h6>
                        <div>
                           <p>该<a id="d41928e2185" class="indexterm-anchor"></a> <code class="codeph">V$SHARED_POOL_ADVICE</code>视图显示有关不同池大小的共享池中估计的分析时间的信息。大小范围从当前共享池大小的10％或固定库高速缓存内存量（以较高者为准）到当前共享池大小的200％，等间隔。间隔的值取决于共享池的当前大小。
                           </p>
                           <div class="infoboxnotealso" id="GUID-55833338-4B36-4742-8BBA-336DC130C481__GUID-9CF63C0B-2590-4494-9820-92664E824A9B">
                              <p class="notep1">也可以看看：</p>
                              <p>有关<code class="codeph">V$SHARED_POOL_ADVICE</code>视图的更多信息，请<span class="italic"><a href="../refrn/V-SHARED_POOL_ADVICE.html#REFRN-GUID-A88630F5-B271-48B5-B863-32A58F22E2C1" target="_blank">参见Oracle数据库参考</a></span></p>
                           </div>
                        </div>
                     </div><a id="TGDBA588"></a><div class="props_rev_3"><a id="GUID-C7190867-D593-4C78-9B3B-500CFC756076" name="GUID-C7190867-D593-4C78-9B3B-500CFC756076"></a><h6 id="TGDBA-GUID-C7190867-D593-4C78-9B3B-500CFC756076" class="sect6"><span class="enumeration_section">14.3.1.2.2</span>关于V $ LIBRARY_CACHE_MEMORY视图</h6>
                        <div>
                           <p>该<a id="d41928e2251" class="indexterm-anchor"></a> <code class="codeph">V$LIBRARY_CACHE_MEMORY</code>视图显示有关分配给不同命名空间中的库高速缓存内存对象的内存的信息。内存对象是内存的内存分组，用于高效管理。库高速缓存对象可以包括一个或多个存储器对象。
                           </p>
                           <div class="infoboxnotealso" id="GUID-C7190867-D593-4C78-9B3B-500CFC756076__GUID-9CF63C0B-2590-4494-9820-92664E824A9B">
                              <p class="notep1">也可以看看：</p>
                              <p>有关<code class="codeph">V$LIBRARY_CACHE_MEMORY</code>视图的更多信息，请<span class="italic"><a href="../refrn/V-LIBRARY_CACHE_MEMORY.html#REFRN-GUID-BCA78008-713C-46F2-9E15-A068A2199841" target="_blank">参见Oracle数据库参考</a></span></p>
                           </div>
                        </div>
                     </div><a id="TGDBA589"></a><div class="props_rev_3"><a id="GUID-A1A06734-2F03-42A7-951C-BEC88691BFC9" name="GUID-A1A06734-2F03-42A7-951C-BEC88691BFC9"></a><h6 id="TGDBA-GUID-A1A06734-2F03-42A7-951C-BEC88691BFC9" class="sect6"><span class="enumeration_section">14.3.1.2.3</span>关于V $ JAVA_POOL_ADVICE和V $ JAVA_LIBRARY_CACHE_MEMORY视图</h6>
                        <div>
                           <p>该<a id="d41928e2318" class="indexterm-anchor"></a><a id="d41928e2320" class="indexterm-anchor"></a> <code class="codeph">V$JAVA_POOL_ADVICE</code>和<code class="codeph">V$JAVA_LIBRARY_CACHE_MEMORY</code>视图包含Java池<code class="codeph">V$JAVA_LIBRARY_CACHE_MEMORY</code>统计信息，这些统计信息跟踪有关用于Java的库高速缓存内存的信息，并预测更改Java池大小如何影响分析率。
                           </p>
                           <p><code class="codeph">V$JAVA_POOL_ADVICE</code>视图显示有关不同池大小的Java池中估计的分析时间的信息。大小范围从当前Java池大小的10％或固定Java库高速缓存内存量 - 以当前Java池大小的高到200％为单位，等间隔。间隔的值取决于Java池的当前大小。
                           </p>
                           <div class="infoboxnotealso" id="GUID-A1A06734-2F03-42A7-951C-BEC88691BFC9__GUID-9CF63C0B-2590-4494-9820-92664E824A9B">
                              <p class="notep1">也可以看看：</p>
                              <p>有关<span class="q">“ <a href="../refrn/V-JAVA_POOL_ADVICE.html#REFRN-GUID-5F080CE2-96F7-41FB-8731-82C892E6EB18" target="_blank">V $ JAVA_POOL_ADVICE</a> ”</span>和<span class="q">“ <a href="../refrn/V-JAVA_LIBRARY_CACHE_MEMORY.html#REFRN-GUID-349DD31C-A425-4015-9827-D49F64273B00" target="_blank">V $ JAVA_LIBRARY_CACHE_MEMORY</a> ”</span>视图的更多信息，请<span class="italic">参见Oracle数据库参考</span></p>
                           </div>
                        </div>
                     </div>
                  </div><a id="TGDBA591"></a><a id="TGDBA592"></a><a id="TGDBA590"></a><div class="props_rev_3"><a id="GUID-BA84D70F-4325-4229-AEC9-06DF7059F1FB" name="GUID-BA84D70F-4325-4229-AEC9-06DF7059F1FB"></a><h5 id="TGDBA-GUID-BA84D70F-4325-4229-AEC9-06DF7059F1FB" class="sect5"><span class="enumeration_section">14.3.1.3</span>使用字典缓存统计信息</h5>
                     <div>
                        <div class="section">
                           <p>通常，如果共享池的大小足以满足库高速缓存的要求，则它对于字典高速缓存数据来说也足够大。</p>
                           <p>在某些情况下，可能会错过数据字典缓存。数据库实例启动时，数据字典缓存不包含任何数据。因此，发出的任何SQL语句都可能导致缓存未命中。随着更多数据被读入缓存，缓存未命中的可能性降低。最终，数据库达到稳定状态，其中最常用的字典数据在缓存中。此时，很少发生缓存未命中。</p>
                           <p>中的每一行<a id="d41928e2407" class="indexterm-anchor"></a> <code class="codeph">V$ROWCACHE</code>视图包含单一类型的数据字典项的统计信息。这些统计信息反映了自最近实例启动以来的所有数据字典活动。
                           </p>
                           <p><a href="tuning-shared-pool-and-large-pool.html#GUID-BA84D70F-4325-4229-AEC9-06DF7059F1FB__BABJDEAC" title="此表描述了V $ ROWCACHE视图中反映数据字典高速缓存的用法和有效性的列。">表14-1</a>列出了<code class="codeph">V$ROWCACHE</code>视图中反映数据字典高速缓存的用法和有效性的列。
                           </p>
                           <div class="tblformal" id="GUID-BA84D70F-4325-4229-AEC9-06DF7059F1FB__BABJDEAC">
                              <p class="titleintable">表14-1 V $ ROWCACHE视图中的数据字典列</p>
                              <table cellpadding="4" cellspacing="0" class="Formal" title="V $ ROWCACHE视图中的数据字典列" width="100%" border="1" summary="This table describes the columns in the V$ROWCACHE view that reflect the use and effectiveness of the data dictionary cache." frame="hsides" rules="rows">
                                 <thead>
                                    <tr align="left" valign="top">
                                       <th align="left" valign="bottom" width="32%" id="d41928e2433">柱</th>
                                       <th align="left" valign="bottom" width="68%" id="d41928e2436">描述</th>
                                    </tr>
                                 </thead>
                                 <tbody>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="32%" id="d41928e2441" headers="d41928e2433 ">
                                          <p><code class="codeph">参数</code></p>
                                       </td>
                                       <td align="left" valign="top" width="68%" headers="d41928e2441 d41928e2436 ">
                                          <p>标识特定数据字典项。对于每一行，此列中的值是以<code class="codeph">dc_</code>为前缀的<code class="codeph">dc_</code> 。例如，在包含文件描述统计信息的行中，此列包含值<code class="codeph">dc_files</code> 。
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="32%" id="d41928e2455" headers="d41928e2433 ">
                                          <p><code class="codeph">GETS</code></p>
                                       </td>
                                       <td align="left" valign="top" width="68%" headers="d41928e2455 d41928e2436 ">
                                          <p>显示有关相应项目的信息请求总数。例如，在包含文件描述统计信息的行中，此列包含文件描述数据的请求总数。</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="32%" id="d41928e2463" headers="d41928e2433 ">
                                          <p><code class="codeph">GETMISSES</code></p>
                                       </td>
                                       <td align="left" valign="top" width="68%" headers="d41928e2463 d41928e2436 ">
                                          <p>显示缓存不满足的数据请求数，并且需要I / O.</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="32%" id="d41928e2471" headers="d41928e2433 ">
                                          <p><code class="codeph">MODIFICATIONS</code></p>
                                       </td>
                                       <td align="left" valign="top" width="68%" headers="d41928e2471 d41928e2436 ">
                                          <p>显示更新字典高速缓存中的数据的次数。</p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <!-- class="inftblhruleinformal" -->
                           <p><a href="tuning-shared-pool-and-large-pool.html#GUID-BA84D70F-4325-4229-AEC9-06DF7059F1FB__BABDJEAC">示例14-3</a>显示了此视图的查询，以监视应用程序运行期间的统计信息。派生列<code class="codeph">PCT_SUCC_GETS</code>可以被视为项目特定命中率。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-BA84D70F-4325-4229-AEC9-06DF7059F1FB__BABDJEAC">
                           <p class="titleinexample">示例14-3查询V $ ROWCACHE视图</p><pre class="oac_no_warn" dir="ltr">列参数格式a21列pct_succ_gets格式999.9列更新格式999,999,999 SELECT参数，sum（gets），sum（getmisses），100 * sum（gets  -  getmisses）/ sum（gets）pct_succ_gets，sum（修改）更新FROM V $ ROWCACHE WHERE gets&gt; 0 GROUP BY参数;</pre><p>此查询的输出可能如下所示：</p><pre class="oac_no_warn" dir="ltr">PARAMETER SUM（GETS）SUM（GETMISSES）PCT_SUCC_GETS UPDATES --------------------- ---------- -------- ------ ------------- ------------ dc_database_links 81 1 98.8 0 dc_free_extents 44876 20301 54.8 40,453 dc_global_oids 42 9 78.6 0 dc_histogram_defs 9419 651 93.1 0 dc_object_ids 29854 239 99.2 52 dc_objects 33600 590 98.2 53 dc_profiles 19001 1 100.0 0 dc_rollback_segments 47244 16 100.0 19 dc_segments 100467 19042 81.0 40,272 dc_sequence_grants 119 16 86.6 0 dc_sequences 26973 16 99.9 26,811 dc_synonyms 6617 168 97.5 0 dc_tablespace_quotas 120 7 94.2 51 dc_tablespaces 581248 10 100.0 0 dc_used_extents 51418 20249 60.6 42,811 dc_user_grants 76082 18 100.0 0 dc_usernames 216860 12 100.0 0 dc_users 376895 22 100.0 0</pre><p>在此示例中，输出显示以下内容：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>对于已使用的扩展区，可用扩展区和段，存在大量未命中和更新。这意味着数据库实例具有大量的动态空间扩展。</p>
                              </li>
                              <li>
                                 <p>将成功获取的百分比与实际获取数量进行比较表明共享池足够大，足以存储字典缓存数据。</p>
                              </li>
                           </ul>
                           <p>您还可以使用以下查询计算整个字典缓存命中率;但是，总结所有缓存上的数据将失去更精细的数据粒度：</p><pre class="oac_no_warn" dir="ltr">SELECT（SUM（gets  -  getmisses  -  fixed））/ SUM（gets）“row cache”FROM V $ ROWCACHE;</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="TGDBA593"></a><div class="props_rev_3"><a id="GUID-220BC80E-FD16-4259-A7C1-E1967C510CAE" name="GUID-220BC80E-FD16-4259-A7C1-E1967C510CAE"></a><h5 id="TGDBA-GUID-220BC80E-FD16-4259-A7C1-E1967C510CAE" class="sect5"><span class="enumeration_section">14.3.1.4</span>增加分配给共享池的内存</h5>
                     <div>
                        <div class="section">
                           <p>增加共享池的内存量会增加库高速缓存，字典高速缓存和结果高速缓存可用的内存量。在此之前，请查看共享池统计信息并检查：</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>如果是<code class="codeph">V$LIBRARYCACHE</code>的值。 <code class="codeph">RELOADS</code>列接近于零</p>
                              </li>
                              <li>
                                 <p>如果总比例为<code class="codeph">V$ROWCACHE</code> 。 <code class="codeph">GETMISSES</code>列总计为<code class="codeph">V$ROWCACHE</code> 。对于经常访问的字典缓存， <code class="codeph">GETS</code>小于10％或15％，具体取决于应用程序</p>
                              </li>
                           </ul>
                           <p>如果满足这两个条件，则共享池的大小足够大，增加其内存可能无法提高性能。另一方面，如果未满足其中任何一个条件，并且应用程序正在有效地使用共享池，如<span class="q">“ <a href="tuning-shared-pool-and-large-pool.html#GUID-901C4010-2B6A-4E50-A02E-77830BB7E70D">使用共享池</a> ”中所述</span> ，则考虑增加共享池的内存。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-220BC80E-FD16-4259-A7C1-E1967C510CAE__GUID-4F148652-F9C5-43D1-A20B-E122D89E8048">要增加共享池的大小：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>增加价值<a id="d41928e2598" class="indexterm-anchor"></a> <code class="codeph">SHARED_POOL_SIZE</code>初始化参数，直到满足条件。
                                 </p>
                                 <p>此参数的最大值取决于您的操作系统。此措施可减少执行时SQL语句和PL / SQL块的隐式重新分析。</p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>IC  - 需要链接到“使用Init参数管理服务器结果缓存内存”</p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="TGDBA594"></a><div class="props_rev_3"><a id="GUID-813F1711-5A90-45BE-B113-C0CEF6DD3048" name="GUID-813F1711-5A90-45BE-B113-C0CEF6DD3048"></a><h5 id="TGDBA-GUID-813F1711-5A90-45BE-B113-C0CEF6DD3048" class="sect5"><span class="enumeration_section">14.3.1.5</span>减少分配给共享池的内存</h5>
                     <div>
                        <div class="section">
                           <p>如果是<code class="codeph">V$LIBRARYCACHE</code>的值。 <code class="codeph">RELOADS</code>列接近于零，并且共享池中有少量可用内存，然后共享池的大小足以存储最常访问的数据。如果共享池中总是有大量可用内存，并且您希望在其他位置分配此内存，请考虑减少共享池大小。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-813F1711-5A90-45BE-B113-C0CEF6DD3048__GUID-C6A87447-6CFC-413C-8872-8F219737D3E9">减小共享池的大小</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>降低价值<a id="d41928e2673" class="indexterm-anchor"></a> <code class="codeph">SHARED_POOL_SIZE</code>初始化参数，同时确保维持良好的性能。
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div><a id="TGDBA595"></a><div class="props_rev_3"><a id="GUID-B1867602-00BF-43CD-9FAB-3C9829358CDD" name="GUID-B1867602-00BF-43CD-9FAB-3C9829358CDD"></a><h4 id="TGDBA-GUID-B1867602-00BF-43CD-9FAB-3C9829358CDD" class="sect4"><span class="enumeration_section">14.3.2</span>释放游标</h4>
                  <div>
                     <p>如果没有库缓存未命中，则考虑设置该值的值<a id="d41928e2729" class="indexterm-anchor"></a> <code class="codeph">CURSOR_SPACE_FOR_TIME</code>初始化参数为<code class="codeph">TRUE</code>以加速执行调用。此参数指定是否可以从库高速缓存中取消分配游标，以便为新的SQL语句腾出空间。
                     </p>
                     <p>如果<code class="codeph">CURSOR_SPACE_FOR_TIME</code>参数设置为：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">FALSE</code> （默认值），无论是否打开与其SQL语句关联的应用程序游标，都可以从库高速缓存中释放游标。
                           </p>
                           <p>在这种情况下，Oracle数据库必须验证包含SQL语句的游标是否在库高速缓存中。</p>
                        </li>
                        <li>
                           <p><code class="codeph">TRUE</code> ，只有当与其语句关联的所有应用程序游标都关闭时，才能释放游标。
                           </p>
                           <p>在这种情况下，Oracle数据库不需要验证游标是否在库高速缓存中，因为在与其关联的应用程序游标打开时无法释放游标。</p>
                        </li>
                     </ul>
                     <p>将参数值设置为<code class="codeph">TRUE</code>可以节省Oracle数据库一小部分时间，并且可以略微提高执行调用的性能。此值还可以防止游标的重新分配，直到关闭相关的应用程序游标。
                     </p>
                     <p>如果出现以下情况，请勿将<code class="codeph">CURSOR_SPACE_FOR_TIME</code>参数的值设置为<code class="codeph">TRUE</code> ：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>在执行调用中找到库缓存未命中</p>
                           <p>库高速缓存未命中表示共享池不足以容纳所有同时打开的游标的共享SQL区域。如果共享池没有足够的空间用于新的SQL语句，并且此参数的值设置为<code class="codeph">TRUE</code> ，则无法解析该语句，Oracle Database将返回错误，指示没有足够的共享内存。
                           </p>
                        </li>
                        <li>
                           <p>私有SQL区域的每个用户可用的内存量很少</p>
                           <p>此值还可以防止释放与打开游标关联的私有SQL区域。如果所有并发打开游标的私有SQL区域填充可用内存，以便没有新SQL语句的空间，则无法解析该语句，Oracle Database将返回错误，指示内存不足。</p>
                        </li>
                     </ul>
                     <p>如果共享池没有足够的空间用于新的SQL语句，并且此参数的值设置为<code class="codeph">FALSE</code> ，则Oracle数据库将释放现有游标。虽然释放游标可能会导致后续库高速缓存未命中（如果重新执行游标），但这比暂停应用程序的错误更可取，因为无法解析SQL语句。
                     </p>
                  </div>
               </div><a id="TGDBA596"></a><div class="props_rev_3"><a id="GUID-C13EE398-F162-4A23-8393-393D71133004" name="GUID-C13EE398-F162-4A23-8393-393D71133004"></a><h4 id="TGDBA-GUID-C13EE398-F162-4A23-8393-393D71133004" class="sect4"><span class="enumeration_section">14.3.3</span>缓存会话游标</h4>
                  <div>
                     <p>会话游标缓存包含SQL和PL / SQL的封闭会话游标，包括递归SQL。此缓存对使用Oracle Forms的应用程序很有用，因为从一种形式切换到另一种形式会关闭与第一种形式关联的所有会话游标。如果应用程序在同一组SQL语句上重复发出解析调用，则重新打开会话游标会降低性能。通过重用游标，数据库可以缩短解析时间，从而缩短整体执行时间。</p>
                     <p>本节介绍会话游标缓存，包含以下主题：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="tuning-shared-pool-and-large-pool.html#GUID-3789E54B-CF19-4575-AD75-DB706DCBB9CD">关于会话游标缓存</a></p>
                        </li>
                        <li>
                           <p><a href="tuning-shared-pool-and-large-pool.html#GUID-5D16C1CC-CFD3-4DD1-B1D1-60F3BD4AA374">启用会话游标缓存</a></p>
                        </li>
                        <li>
                           <p><a href="tuning-shared-pool-and-large-pool.html#GUID-419F056F-2EE0-431E-BEAD-D13A77B2AA7D">调整会话游标缓存的大小</a></p>
                        </li>
                     </ul>
                  </div><a id="TGDBA597"></a><div class="props_rev_3"><a id="GUID-3789E54B-CF19-4575-AD75-DB706DCBB9CD" name="GUID-3789E54B-CF19-4575-AD75-DB706DCBB9CD"></a><h5 id="TGDBA-GUID-3789E54B-CF19-4575-AD75-DB706DCBB9CD" class="sect5"><span class="enumeration_section">14.3.3.1</span>关于会话游标缓存</h5>
                     <div>
                        <p>会话游标表示共享子游标的实例化，该共享子游标存储在共享池中，用于特定会话。每个会话游标都存储对它已实例化的子游标的引用。</p>
                        <p>Oracle数据库检查库高速缓存以确定是否已对给定语句发出了三个以上的解析请求。如果游标已关闭三次，则Oracle数据库假定应缓存与该语句关联的会话游标，并将游标移动到会话游标缓存中。</p>
                        <p>通过同一会话解析SQL语句的后续请求将搜索指向共享游标的指针的数组。如果找到指针，则数据库取消引用指针以确定共享游标是否存在。为了重用缓存中的游标，缓存管理器检查游标的缓存状态是否与当前会话和系统环境匹配。</p>
                        <div class="infoboxnote" id="GUID-3789E54B-CF19-4575-AD75-DB706DCBB9CD__GUID-D6D6137B-E45D-40F8-8157-2D5DB2126281">
                           <p class="notep1">注意：</p>
                           <p>重新使用缓存的游标仍然会注册为解析，即使它不是一个硬解析。</p>
                        </div>
                        <p>LRU算法删除会话游标缓存中的条目，以便在需要时为新条目腾出空间。缓存还使用内部基于时间的算法来老化已经空闲了一段时间的游标。</p>
                     </div>
                  </div><a id="TGDBA598"></a><div class="props_rev_3"><a id="GUID-5D16C1CC-CFD3-4DD1-B1D1-60F3BD4AA374" name="GUID-5D16C1CC-CFD3-4DD1-B1D1-60F3BD4AA374"></a><h5 id="TGDBA-GUID-5D16C1CC-CFD3-4DD1-B1D1-60F3BD4AA374" class="sect5"><span class="enumeration_section">14.3.3.2</span>启用会话游标缓存</h5>
                     <div>
                        <div class="section">
                           <p>以下初始化参数与会话游标缓存有关：</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><code class="codeph">SESSION_CACHED_CURSORS</code></p>
                                 <p>此参数设置每个会话的最大缓存关闭游标数。默认值为50。使用此参数可以从缓存中重用在同一会话中重复执行的语句的游标。</p>
                              </li>
                              <li>
                                 <p><code class="codeph">OPEN_CURSORS</code></p>
                                 <p>此参数指定会话可以同时打开的最大游标数。例如，如果其值设置为1000，则每个会话一次最多可打开1000个游标。</p>
                              </li>
                           </ul>
                           <p>这些参数是独立的。例如，您可以将<code class="codeph">SESSION_CACHED_CURSORS</code>参数的值设置为高于<code class="codeph">OPEN_CURSORS</code>参数的值，因为会话游标未在打开状态下缓存。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-5D16C1CC-CFD3-4DD1-B1D1-60F3BD4AA374__GUID-A8D3FA1B-F9A3-48AB-A916-DF7E366D5933">要启用会话游标缓存：</p>
                           <ol>
                              <li>
                                 <p>确定要保留在缓存中的最大会话游标数。</p>
                              </li>
                              <li>
                                 <p>执行以下操作之一：</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p>要启用静态缓存，请将<code class="codeph">SESSION_CACHED_CURSORS</code>参数的值设置为上一步中确定的数字。
                                       </p>
                                    </li>
                                    <li>
                                       <p>要启用动态高速缓存，请执行以下语句：</p><pre class="oac_no_warn" dir="ltr">ALTER SESSION SET SESSION_CACHED_CURSORS = <span class="italic">value</span> ;</pre></li>
                                 </ul>
                              </li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="TGDBA600"></a><a id="TGDBA599"></a><div class="props_rev_3"><a id="GUID-419F056F-2EE0-431E-BEAD-D13A77B2AA7D" name="GUID-419F056F-2EE0-431E-BEAD-D13A77B2AA7D"></a><h5 id="TGDBA-GUID-419F056F-2EE0-431E-BEAD-D13A77B2AA7D" class="sect5"><span class="enumeration_section">14.3.3.3</span>调整会话游标缓存的大小</h5>
                     <div>
                        <div class="section">
                           <p>使用<code class="codeph">V$SESSTAT</code>视图确定会话游标高速缓存是否适合数据库实例。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-419F056F-2EE0-431E-BEAD-D13A77B2AA7D__GUID-A75D9802-9BED-40E7-ADCC-F4581081FF85">要调整会话游标缓存的大小：</p>
                           <ol>
                              <li>
                                 <p>查询<code class="codeph">V$SESSTAT</code>视图以确定特定会话中当前缓存的游标数量。
                                 </p>
                              </li>
                              <li>
                                 <p>查询<code class="codeph">V$SESSTAT</code>视图以查找在会话游标缓存中找到游标的解析调用的百分比。
                                 </p>
                              </li>
                              <li>
                                 <p>如果满足以下条件，请考虑增加<code class="codeph">SESSION_CACHED_CURSORS</code>参数的值：</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p>会话游标缓存计数接近最大值</p>
                                    </li>
                                    <li>
                                       <p>会话游标缓存命中的百分比相对于总分析而言较低</p>
                                    </li>
                                    <li>
                                       <p>应用程序重复执行相同查询的解析调用</p>
                                    </li>
                                 </ul>
                              </li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p><a href="tuning-shared-pool-and-large-pool.html#GUID-419F056F-2EE0-431E-BEAD-D13A77B2AA7D__CIHJEBIH">例14-4</a>显示了该视图的两个查询。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-419F056F-2EE0-431E-BEAD-D13A77B2AA7D__CIHJEBIH">
                           <p class="titleinexample">示例14-4查询V $ SESSTAT视图</p>
                           <p>以下查询查找当前在特定会话中缓存的游标数：</p><pre class="oac_no_warn" dir="ltr">SELECT a.value curr_cached，p.value max_cached，s.username，s.sid，s.serial＃FROM v $ sesstat a，v $ statname b，v $ session s，v $ parameter2 p WHERE a.statistic＃= b .statistic＃和s.sid = a.sid和a.sid =＆sid AND p.name ='session_cached_cursors'AND b.name ='session cursor cache count';</pre><p>此查询的输出可能如下所示：</p><pre class="oac_no_warn" dir="ltr">CURR_CACHED MAX_CACHED USERNAME SID SERIAL＃----------- ---------- -------- ----- ---------- 49 50 APP 35 263</pre><p>此输出显示当前为会话35缓存的游标数接近最大值。</p>
                           <p>以下查询查找在会话游标缓存中找到游标的解析调用的百分比：</p><pre class="oac_no_warn" dir="ltr">SELECT cach.value cache_hits，prs.value all_parses，round（（cach.value / prs.value）* 100,2）as“cache in cache”FROM v $ sesstat cach，v $ sesstat prs，v $ statname nm1， v $ statname nm2 WHERE cach.statistic＃= nm1.statistic＃AND nm1.name ='session cursor cache hits'AND prs.statistic＃= nm2.statistic＃AND nm2.name ='parse count（total）'AND cach。 sid =＆sid和prs.sid = cach.sid;</pre><p>此查询的输出可能如下所示：</p><pre class="oac_no_warn" dir="ltr">在缓存中找到CACHE_HITS ALL_PARSES％---------- ---------- ---------------- 34 700 4.57</pre><p>此输出显示会话35的会话游标缓存中的命中数与解析总数相比较低。</p>
                           <p>在此示例中，将<code class="codeph">SESSION_CACHED_CURSORS</code>参数的值设置为100可能有助于提高性能。
                           </p>
                        </div>
                        <!-- class="example" -->
                     </div>
                  </div>
               </div><a id="TGDBA601"></a><div class="props_rev_3"><a id="GUID-40A8C949-9B20-4217-A730-FE8A910B358F" name="GUID-40A8C949-9B20-4217-A730-FE8A910B358F"></a><h4 id="TGDBA-GUID-40A8C949-9B20-4217-A730-FE8A910B358F" class="sect4"><span class="enumeration_section">14.3.4</span>共享游标</h4>
                  <div>
                     <p>在SQL解析的上下文中，相同的语句是一个SQL语句，其文本与另一个语句相同，即字符的字符，包括空格，大小写和注释。除了一些文字的值之外，类似的陈述是相同的。</p>
                     <p>解析阶段将语句文本与共享池中的语句进行比较，以确定是否可以共享语句。如果<code class="codeph">CURSOR_SHARING</code>初始化参数的值设置为<code class="codeph">EXACT</code> （默认值），并且共享池中的语句不相同，则数据库不共享SQL区域。相反，每个SQL语句都有自己的父光标和基于语句中文字的自己的执行计划。
                     </p>
                     <p>本节介绍如何共享游标，并包含以下主题：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="tuning-shared-pool-and-large-pool.html#GUID-B5897767-3DE1-45A8-9909-375D84FC550A">关于光标共享</a></p>
                        </li>
                        <li>
                           <p><a href="tuning-shared-pool-and-large-pool.html#GUID-8FAB86AA-36ED-45C9-AD83-72143F09344B">强制光标共享</a></p>
                        </li>
                     </ul>
                  </div><a id="TGDBA602"></a><div class="props_rev_3"><a id="GUID-B5897767-3DE1-45A8-9909-375D84FC550A" name="GUID-B5897767-3DE1-45A8-9909-375D84FC550A"></a><h5 id="TGDBA-GUID-B5897767-3DE1-45A8-9909-375D84FC550A" class="sect5"><span class="enumeration_section">14.3.4.1</span>关于光标共享</h5>
                     <div>
                        <p>当SQL语句使用文字而不是绑定变量时，将<code class="codeph">CURSOR_SHARING</code>初始化参数的值设置为<code class="codeph">FORCE</code>可使数据库使用系统生成的绑定变量替换文字。使用此技术，数据库可以减少共享SQL区域中父游标的数量。
                        </p>
                        <p>当<code class="codeph">CURSOR_SHARING</code>参数的值设置为<code class="codeph">FORCE</code> ，数据库在分析阶段执行以下步骤：</p>
                        <ol>
                           <li>
                              <p>在共享池中搜索相同的语句。</p>
                              <p>如果找到相同的语句，则数据库跳过下一步并继续执行步骤3。否则，数据库继续下一步。</p>
                           </li>
                           <li>
                              <p>在共享池中搜索类似的语句。</p>
                              <p>如果<span class="italic">没有</span>找到类似的声明，则数据库执行硬分析。<span class="italic">如果</span>发现了类似的声明，则数据库进行到下一个步骤。
                              </p>
                           </li>
                           <li id="GUID-B5897767-3DE1-45A8-9909-375D84FC550A__BABEBAEI">
                              <p>继续执行解析阶段的其余步骤，以确保现有语句的执行计划适用于新语句。</p>
                              <p>如果计划不适用，则数据库执行硬解析。如果该计划适用，则数据库继续下一步。</p>
                           </li>
                           <li>
                              <p>共享语句的SQL区域。</p>
                           </li>
                        </ol>
                        <p>有关数据库执行的各种检查的详细信息，请参阅<span class="q">“ <a href="tuning-shared-pool-and-large-pool.html#GUID-BE6DFC00-A436-4908-A711-9127FABB6809">SQL共享标准</a> ”</span> 。
                        </p>
                     </div>
                  </div><a id="TGDBA603"></a><div class="props_rev_3"><a id="GUID-8FAB86AA-36ED-45C9-AD83-72143F09344B" name="GUID-8FAB86AA-36ED-45C9-AD83-72143F09344B"></a><h5 id="TGDBA-GUID-8FAB86AA-36ED-45C9-AD83-72143F09344B" class="sect5"><span class="enumeration_section">14.3.4.2</span>强制光标共享</h5>
                     <div>
                        <p>最佳实践是编写可共享的SQL，并使用默认值<code class="codeph">EXACT</code>作为<code class="codeph">CURSOR_SHARING</code>初始化参数。默认情况下，Oracle数据库使用自适应游标共享来启用包含绑定变量的单个SQL语句以使用多个执行计划。但是，对于具有许多使用文字而不是绑定变量的类似语句的应用程序，将<code class="codeph">CURSOR_SHARING</code>参数的值设置为<code class="codeph">FORCE</code>可以改善游标共享，从而减少内存使用，更快地解析和减少锁存器争用。当共享池中的语句仅在文字的值上不同时，以及由于大量的库高速缓存未命中而导致响应时间较差时，请考虑此方法。在这种情况下，将<code class="codeph">CURSOR_SHARING</code>参数的值设置为<code class="codeph">FORCE</code>最大化游标共享，并利用自适应游标共享来根据不同的文字值范围生成多个执行计划。
                        </p>
                        <p>如果使用<code class="codeph">CURSOR_SHARING</code>参数的值设置为<code class="codeph">EXACT</code>生成存储的轮廓，则数据库不使用使用文字生成的存储轮廓。为了避免这个问题，产生与轮廓<code class="codeph">CURSOR_SHARING</code>设置为<code class="codeph">FORCE</code>和使用<code class="codeph">CREATE_STORED_OUTLINES</code>参数。
                        </p>
                        <p>将<code class="codeph">CURSOR_SHARING</code>参数的值设置为<code class="codeph">FORCE</code>具有以下缺点：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>数据库必须在软解析期间执行额外的工作，以在共享池中查找类似的语句。</p>
                           </li>
                           <li>
                              <p>在<code class="codeph">SELECT</code>语句中包含文字的任何选定表达式的最大长度（由<code class="codeph">DESCRIBE</code>返回）都会增加。但是，返回的数据的实际长度不会改变。
                              </p>
                           </li>
                           <li>
                              <p>不支持星形转换。</p>
                           </li>
                        </ul>
                        <p>当<code class="codeph">CURSOR_SHARING</code>参数的值设置为<code class="codeph">FORCE</code> ，数据库对每个不同的SQL语句使用一个父游标和一个子游标。每次执行同一语句时都使用相同的计划。例如，请考虑以下SQL语句：</p><pre class="oac_no_warn" dir="ltr">SELECT * FROM hr.employees WHERE employee_id = 101;</pre><p>如果<code class="codeph">CURSOR_SHARING</code>参数的值设置为<code class="codeph">FORCE</code> ，则数据库会优化此语句，就好像它包含绑定变量并使用bind peeking来估计基数。
                        </p>
                        <div class="infoboxnote" id="GUID-8FAB86AA-36ED-45C9-AD83-72143F09344B__GUID-008FDA99-14F1-488F-AECD-C864B545422E">
                           <p class="notep1">注意：</p>
                           <p>从Oracle Database <span class="italic">11g</span>第2版开始，将<code class="codeph">CURSOR_SHARING</code>参数的值设置为<code class="codeph">SIMILAR</code>已过时。请考虑使用自适应游标共享。
                           </p>
                        </div>
                        <div class="infoboxnotealso" id="GUID-8FAB86AA-36ED-45C9-AD83-72143F09344B__GUID-8CB97A89-FB9C-46E2-BDDA-99543CAEDB8F">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>有关<code class="codeph">CURSOR_SHARING</code>初始化参数的信息，请<a href="../refrn/CURSOR_SHARING.html#REFRN10025" target="_blank"><span class="italic">参见Oracle数据库参考</span></a></p>
                              </li>
                              <li>
                                 <p>有关自适应游标共享的信息，请<a href="../tgsql/improving-rwp-cursor-sharing.html#TGSQL848" target="_blank"><span class="italic">参见“Oracle数据库SQL调整指南</span></a></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div>
               </div><a id="TGDBA604"></a><div class="props_rev_3"><a id="GUID-E0D415CA-C4A7-4588-ADF2-4E302CE25849" name="GUID-E0D415CA-C4A7-4588-ADF2-4E302CE25849"></a><h4 id="TGDBA-GUID-E0D415CA-C4A7-4588-ADF2-4E302CE25849" class="sect4"><span class="enumeration_section">14.3.5</span>保持大物体防止老化</h4>
                  <div>
                     <div class="section">
                        <p>将条目加载到共享池后，无法移动它。有时，随着条目的加载和老化，可用内存可能会碎片化。根据与数据库缓冲区类似的LRU算法，共享SQL和PL / SQL区域在共享池中老化。要提高性能并避免重新分析，请防止大型SQL或PL / SQL区域从共享池中老化。</p>
                        <p>该<a id="d41928e3523" class="indexterm-anchor"></a> <code class="codeph">DBMS_SHARED_POOL</code>包使您可以将对象保留在共享内存中，这样它们就不会使用正常的LRU机制老化。通过使用<code class="codeph">DBMS_SHARED_POOL</code>包在内存碎片发生之前加载SQL和PL / SQL区域，可以将对象保留在内存中。这可确保内存可用，并防止在老化后访问SQL和PL / SQL区域时发生的用户响应时间突然减慢。
                        </p>
                        <p>考虑使用<code class="codeph">DBMS_SHARED_POOL</code>包：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p>加载大型PL / SQL对象时，例如<code class="codeph">STANDARD</code>和<code class="codeph">DIUTIL</code>包。
                              </p>
                              <p>加载大型PL / SQL对象时，如果较小的对象必须从共享池中老化以便为较大的对象腾出空间，则可能会影响用户响应时间。在某些情况下，可能没有足够的内存来加载大对象。</p>
                           </li>
                           <li>
                              <p>将已编译的触发器保留在共享池中的常用表上。</p>
                           </li>
                           <li>
                              <p>支持序列。</p>
                              <p>当序列从共享池中老化时，序列号将丢失。<code class="codeph">DBMS_SHARED_POOL</code>包将序列保存在共享池中，从而防止丢失序列号。
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-E0D415CA-C4A7-4588-ADF2-4E302CE25849__GUID-022E6DC4-51FA-4EAC-AC92-94C356A15BEB">要在共享内存中保留SQL或PL / SQL区域：</p>
                        <ol>
                           <li>
                              <p>确定要保留在内存中的包或游标。</p>
                           </li>
                           <li>
                              <p>启动数据库。</p>
                           </li>
                           <li>
                              <p>调用<code class="codeph">DBMS_SHARED_POOL</code> 。 <code class="codeph">KEEP</code>包装以固定物体。
                              </p>
                              <p>此过程可确保在加载固定对象之前系统不会耗尽共享内存。在数据库实例的生命周期的早期固定对象可以防止因将大部分内存保留在共享池中间而导致的内存碎片。</p>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-E0D415CA-C4A7-4588-ADF2-4E302CE25849__GUID-D2A4117E-0200-41EB-87C5-F65CBC6AEC1C">
                           <p class="notep1">也可以看看：</p>
                           <p>有关使用<code class="codeph">DBMS_SHARED_POOL</code>过程的信息，请<code class="codeph">DBMS_SHARED_POOL</code> <a href="../arpls/DBMS_SHARED_POOL.html#ARPLS-GUID-AF8E502A-F2C6-4015-9742-DC19AEA92E1C" target="_blank"><span class="italic">Oracle Database PL / SQL包和类型参考</span></a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="TGDBA605"></a><div class="props_rev_3"><a id="GUID-7FD646B3-FCE3-4D3C-B988-C8D138FFD514" name="GUID-7FD646B3-FCE3-4D3C-B988-C8D138FFD514"></a><h4 id="TGDBA-GUID-7FD646B3-FCE3-4D3C-B988-C8D138FFD514" class="sect4"><span class="enumeration_section">14.3.6</span>配置保留池</h4>
                  <div>
                     <p>尽管Oracle数据库将非常大的内存请求分解为较小的块，但在某些系统上可能需要找到连续的内存块（例如超过5 KB，默认的最小保留池分配为4,400字节）。</p>
                     <p>如果共享池中没有足够的可用空间，则Oracle数据库必须搜索并释放足够的内存以满足此请求。该操作可以将锁存资源保持相当长的时间段，从而对存储器分配的其他并发尝试造成轻微中断。</p>
                     <p>为避免这种情况，Oracle数据库内部默认在共享池中保留一个小内存区域，如果共享池没有足够的空间，数据库可以使用该区域。这个保留池使大块的分配更有效。数据库可以将此内存用于PL / SQL和触发器编译等操作，或者在加载Java对象时用于临时空间。从保留池分配的内存被释放后，它将返回到保留池。</p>
                     <p>对于大型分配，Oracle数据库尝试按以下顺序在共享池中分配空间：</p>
                     <ol>
                        <li>
                           <p>从共享池的未预留部分。</p>
                        </li>
                        <li>
                           <p>从保留的游泳池。</p>
                           <p>如果共享池的未预留部分中没有足够的空间，则Oracle数据库会检查保留池是否有足够的空间。</p>
                        </li>
                        <li>
                           <p>从记忆里。</p>
                           <p>如果共享池的未保留和保留部分中没有足够的空间，则Oracle数据库会尝试释放足够的内存以进行分配。然后，数据库将重试共享池的未保留和保留部分。</p>
                        </li>
                     </ol>
                     <p>本节介绍如何配置保留池，并包含以下主题：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="tuning-shared-pool-and-large-pool.html#GUID-F09B2C77-CBEA-4845-8878-FF42169BE128">调整预留池的大小</a></p>
                        </li>
                        <li>
                           <p><a href="tuning-shared-pool-and-large-pool.html#GUID-F7D9790A-DF64-4FCD-B0B3-3E44AFA4500D">增加分配给预留池的内存</a></p>
                        </li>
                        <li>
                           <p><a href="tuning-shared-pool-and-large-pool.html#GUID-0713CB0A-A804-4612-B0E4-EE9796BC0B82">减少分配给预留池的内存</a></p>
                        </li>
                     </ul>
                  </div><a id="TGDBA606"></a><div class="props_rev_3"><a id="GUID-F09B2C77-CBEA-4845-8878-FF42169BE128" name="GUID-F09B2C77-CBEA-4845-8878-FF42169BE128"></a><h5 id="TGDBA-GUID-F09B2C77-CBEA-4845-8878-FF42169BE128" class="sect5"><span class="enumeration_section">14.3.6.1</span>调整保留池的大小</h5>
                     <div>
                        <div class="section">
                           <p>通常，没有必要更改Oracle数据库为保留池保留的默认空间量。但是，在某些情况下，您可能需要在共享池中留出空间，以获得异常大的内存分配。</p>
                           <p>您可以通过设置<code class="codeph">SHARED_POOL_RESERVED_SIZE</code>初始化参数的值来设置保留池大小。为默认值<code class="codeph">SHARED_POOL_RESERVED_SIZE</code>参数是5％ <code class="codeph">SHARED_POOL_SIZE</code>参数。
                           </p>
                           <p>如果将值设置<code class="codeph">SHARED_POOL_RESERVED_SIZE</code>参数比的一半以上<code class="codeph">SHARED_POOL_SIZE</code>参数，那么因为数据库不允许您保留太多的内存为保留池中Oracle数据库返回一个错误。可用的操作系统内存量也可能会限制共享池的大小。在一般情况下，的值设置<code class="codeph">SHARED_POOL_RESERVED_SIZE</code>参数到不高于10％ <code class="codeph">SHARED_POOL_SIZE</code>参数。在大多数系统上，如果共享池得到充分调整，则此值就足够了。如果增加此值，则数据库会从共享池中获取额外的内存，并减少可用于较小分配的未保留共享池内存量。
                           </p>
                           <p>调整这些参数时，请使用来自的统计信息<a id="d41928e3763" class="indexterm-anchor"></a> <code class="codeph">V$SHARED_POOL_RESERVED</code>视图。在具有足够可用内存以增加SGA大小的系统上， <code class="codeph">REQUEST_MISSES</code>统计信息的值应等于零。如果系统受操作系统内存约束，那么目标是使<code class="codeph">REQUEST_FAILURES</code>统计量等于零，或者至少阻止其值增加。如果无法实现这些目标值，则增加<code class="codeph">SHARED_POOL_RESERVED_SIZE</code>参数的值。此外，将<code class="codeph">SHARED_POOL_SIZE</code>参数的值增加相同的量，因为保留列表是从共享池中获取的。
                           </p>
                           <p><code class="codeph">V$SHARED_POOL_RESERVED</code>固定视图还可以指示<code class="codeph">SHARED_POOL_SIZE</code>参数的值何时太小。如果<code class="codeph">REQUEST_FAILURES</code>统计量大于零且增加，则可能出现这种情况。如果启用了保留列表，则减小<code class="codeph">SHARED_POOL_RESERVED_SIZE</code>参数的值。如果未启用保留列表，则增加<code class="codeph">SHARED_POOL_SIZE</code>参数的值，如<span class="q">“ <a href="tuning-shared-pool-and-large-pool.html#GUID-220BC80E-FD16-4259-A7C1-E1967C510CAE">增加分配给共享池的内存</a> ”中所述</span> 。
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="TGDBA607"></a><div class="props_rev_3"><a id="GUID-F7D9790A-DF64-4FCD-B0B3-3E44AFA4500D" name="GUID-F7D9790A-DF64-4FCD-B0B3-3E44AFA4500D"></a><h5 id="TGDBA-GUID-F7D9790A-DF64-4FCD-B0B3-3E44AFA4500D" class="sect5"><span class="enumeration_section">14.3.6.2</span>增加分配给保留池的内存</h5>
                     <div>
                        <div class="section">
                           <p>如果<code class="codeph">REQUEST_FAILURES</code>统计信息的值高于零并且增加，则保留池太小。在这种情况下，请增加保留池可用的内存量。
                           </p>
                           <div class="infoboxnote" id="GUID-F7D9790A-DF64-4FCD-B0B3-3E44AFA4500D__GUID-8F7E3F07-58AB-4E7D-BED8-1570C82BE575">
                              <p class="notep1">注意：</p>
                              <p>增加保留列表中可用的内存量不会影响不从保留列表中分配内存的用户。</p>
                           </div>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-F7D9790A-DF64-4FCD-B0B3-3E44AFA4500D__GUID-522389B6-11A9-4BDA-BB11-72414E4B26F3">要增加保留池的大小：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>相应地增加<code class="codeph">SHARED_POOL_RESERVED_SIZE</code>和<code class="codeph">SHARED_POOL_SIZE</code>初始化参数的值。
                                 </p>
                                 <p>您为这些参数选择的值取决于系统的SGA大小约束，如<span class="q">“ <a href="tuning-shared-pool-and-large-pool.html#GUID-F09B2C77-CBEA-4845-8878-FF42169BE128">调整保留池大小</a> ”中所述</span> 。
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="TGDBA608"></a><div class="props_rev_3"><a id="GUID-0713CB0A-A804-4612-B0E4-EE9796BC0B82" name="GUID-0713CB0A-A804-4612-B0E4-EE9796BC0B82"></a><h5 id="TGDBA-GUID-0713CB0A-A804-4612-B0E4-EE9796BC0B82" class="sect5"><span class="enumeration_section">14.3.6.3</span>减少分配给保留池的内存</h5>
                     <div>
                        <div class="section">
                           <p>如果：保留池太大了：</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><code class="codeph">REQUEST_MISSES</code>统计为零或不增加</p>
                              </li>
                              <li>
                                 <p><code class="codeph">FREE_SPACE</code>统计信息大于或等于<code class="codeph">SHARED_POOL_RESERVED_SIZE</code>最小值的50％</p>
                              </li>
                           </ul>
                           <p>如果这些条件中的任何一个为真，则减少可用于保留池的内存量。</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-0713CB0A-A804-4612-B0E4-EE9796BC0B82__GUID-96A5A81F-D937-4921-914C-F85CCB56EB31">要减小保留池的大小：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>减小<code class="codeph">SHARED_POOL_RESERVED_SIZE</code>初始化参数的值。
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div>
            </div><a id="TGDBA609"></a><div class="props_rev_3"><a id="GUID-096F2CDD-B3EE-4124-BBE3-F60400600972" name="GUID-096F2CDD-B3EE-4124-BBE3-F60400600972"></a><h3 id="TGDBA-GUID-096F2CDD-B3EE-4124-BBE3-F60400600972" class="sect3"><span class="enumeration_section">14.4</span>配置大池</h3>
               <div>
                  <p>与共享池不同，大型池没有LRU列表。Oracle数据库不会尝试将对象置于大池之外。如果数据库实例使用以下任何Oracle数据库功能，请考虑配置大型池：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>共享服务器</p>
                        <p>在共享服务器体系结构中，每个客户端进程的会话内存都包含在共享池中。</p>
                     </li>
                     <li>
                        <p>并行查询</p>
                        <p>并行查询使用共享池内存来缓存并行执行消息缓冲区。</p>
                     </li>
                     <li>
                        <p>恢复管理器</p>
                        <p>Recovery Manager（RMAN）使用共享池在备份和还原操作期间缓存I / O缓冲区。对于I / O服务器进程，备份和还原操作，Oracle数据库分配大小为几百KB的缓冲区。</p>
                     </li>
                  </ul>
                  <p>本节介绍如何为共享服务器体系结构配置大型池，并包含以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="tuning-shared-pool-and-large-pool.html#GUID-43589254-52A2-495F-B01A-04D0885A9E0D">为共享服务器体系结构配置大型池</a></p>
                     </li>
                     <li>
                        <p><a href="tuning-shared-pool-and-large-pool.html#GUID-98BE477D-35FE-435B-B05C-0A99C5F516B5">配置大型池以进行并行查询</a></p>
                     </li>
                     <li>
                        <p><a href="tuning-shared-pool-and-large-pool.html#GUID-C155964B-7F66-49C4-9F88-916F0217303D">确定大型游泳池的大小</a></p>
                     </li>
                     <li>
                        <p><a href="tuning-shared-pool-and-large-pool.html#GUID-2354F7EE-7E3B-4399-B4D9-646BDB00E162">限制用户会话的内存使用</a></p>
                     </li>
                     <li>
                        <p><a href="tuning-shared-pool-and-large-pool.html#GUID-8ABD6078-F667-46A9-8289-89B5D4FF18B6">使用三层连接减少内存使用</a></p>
                     </li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-096F2CDD-B3EE-4124-BBE3-F60400600972__GUID-02CAC01D-38EE-4BBE-BEA4-F1FF86F632F3">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>有关大型池的信息，请<a href="../cncpt/memory-architecture.html#CNCPT-GUID-1ECB5213-AC4E-4BB4-9113-91C761676B34" target="_blank"><span class="italic">参见Oracle数据库概念</span></a></p>
                        </li>
                        <li>
                           <p>有关使用Recovery Manager调整大型池大小的信息，请参见“ <a href="../bradv/tuning-rman-performance.html#BRADV89857" target="_blank"><span class="italic">Oracle数据库备份和恢复用户指南”</span></a></p>
                        </li>
                     </ul>
                  </div>
               </div><a id="TGDBA610"></a><div class="props_rev_3"><a id="GUID-43589254-52A2-495F-B01A-04D0885A9E0D" name="GUID-43589254-52A2-495F-B01A-04D0885A9E0D"></a><h4 id="TGDBA-GUID-43589254-52A2-495F-B01A-04D0885A9E0D" class="sect4"><span class="enumeration_section">14.4.1</span>配置共享服务器体系结构的大型池</h4>
                  <div>
                     <p>当Oracle数据库为共享服务器会话分配共享池内存时，库高速缓存和数据字典高速缓存可用的共享池内存量会减少。如果从其他池分配共享服务器会话内存，则可以保留共享池以缓存共享SQL。</p>
                     <p>Oracle建议使用大型池来分配<a id="d41928e4125" class="indexterm-anchor"></a><a id="d41928e4129" class="indexterm-anchor"></a>用户全局区域（UGA）用于共享服务器体系结构。使用大型池而不是共享池可以减少共享池的碎片，并消除缩小共享SQL缓存所带来的性能开销。
                     </p>
                     <p>默认情况下，未配置大型池。如果未配置大型池，则Oracle数据库将共享池用于共享服务器用户会话内存。如果配置了大型池，则在使用共享服务器体系结构时，Oracle数据库仍会为共享池中的每个已配置会话分配固定数量的内存（大约10K）。在任何一种情况下，请考虑相应地增加共享池的大小。</p>
                     <div class="infoboxnote" id="GUID-43589254-52A2-495F-B01A-04D0885A9E0D__GUID-66FDEB1C-B2DC-4158-A87C-AE54EAB39192">
                        <p class="notep1">注意：</p>
                        <p>即使共享内存的使用随着共享服务器的增加而增加，但内存使用总量也会减少。这是因为进程较少;因此，Oracle数据库使用较少<a id="d41928e4139" class="indexterm-anchor"></a>与专用服务器环境相比，具有共享服务器的PGA内存。
                        </p>
                     </div>
                     <div class="infobox-tip" id="GUID-43589254-52A2-495F-B01A-04D0885A9E0D__GUID-53A14D55-B25C-4CC7-9E18-CBD1D4ACB03B">
                        <p class="notep1">小费：</p>
                        <p>要指定数据库允许的最大并发共享服务器会话数，请使用<code class="codeph">CIRCUITS</code>初始化参数。
                        </p>
                     </div>
                     <div class="infobox-tip" id="GUID-43589254-52A2-495F-B01A-04D0885A9E0D__GUID-374BC232-1252-4622-9647-7D52AD4E832F">
                        <p class="notep1">小费：</p>
                        <p>为了使用共享服务器进行排序操作以获得最佳性能，请将<code class="codeph">SORT_AREA_SIZE</code>和<code class="codeph">SORT_AREA_RETAINED_SIZE</code>初始化参数的值设置为相同的值。这样可以将排序结果保存在大型池中，而不是将其写入磁盘。
                        </p>
                     </div>
                  </div>
               </div><a id="TGDBA95399"></a><div class="props_rev_3"><a id="GUID-98BE477D-35FE-435B-B05C-0A99C5F516B5" name="GUID-98BE477D-35FE-435B-B05C-0A99C5F516B5"></a><h4 id="TGDBA-GUID-98BE477D-35FE-435B-B05C-0A99C5F516B5" class="sect4"><span class="enumeration_section">14.4.2</span>配置并行查询的大型池</h4>
                  <div>
                     <p>当未启用自动内存管理或自动共享内存管理时，并行查询使用共享池内存来缓存并行执行消息缓冲区。在共享池中缓存并行执行消息缓冲区会增加其工作负载并可能导致碎片。</p>
                     <p>为避免可能对性能产生负面影响，Oracle建议您在使用并行查询时不要手动管理SGA内存。相反，您应启用自动内存管理或自动共享内存管理，以确保将使用大型池来缓存并行执行内存缓冲区。</p>
                     <div class="infoboxnotealso" id="GUID-98BE477D-35FE-435B-B05C-0A99C5F516B5__GUID-6AD0AE9B-80E5-4E58-8318-40E512E5B20C">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="q">“ <a href="database-memory-allocation.html#GUID-4433AFDE-47AB-41D5-9DE0-E26CBDD4576D">自动内存管理</a> ”</span></p>
                           </li>
                           <li>
                              <p><span class="q">“ <a href="database-memory-allocation.html#GUID-F082EAF9-1B65-4F82-BA33-4137768DB5BC">自动共享内存管理</a> ”</span></p>
                           </li>
                           <li>
                              <p><a href="../vldbg/parameters-parallel-exec.html#VLDBG-GUID-7ED3242C-D2FF-4279-AF8A-C7CFB7ED5F2A" target="_blank"><span class="italic">Oracle数据库VLDB和分区指南</span></a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="TGDBA612"></a><a id="TGDBA613"></a><a id="TGDBA611"></a><div class="props_rev_3"><a id="GUID-C155964B-7F66-49C4-9F88-916F0217303D" name="GUID-C155964B-7F66-49C4-9F88-916F0217303D"></a><h4 id="TGDBA-GUID-C155964B-7F66-49C4-9F88-916F0217303D" class="sect4"><span class="enumeration_section">14.4.3</span>确定大型池的大小</h4>
                  <div>
                     <div class="section">
                        <p>在大型池中存储与共享服务器相关的UGA时，Oracle数据库使用的UGA的确切数量取决于应用程序。每个应用程序都需要不同的内存量来存储会话信息，大型池的配置应该反映内存需求。</p>
                        <p>Oracle数据库收集会话使用的内存统计信息并将其存储在<a id="d41928e4289" class="indexterm-anchor"></a> <code class="codeph">V$SESSTAT</code>视图。<a href="tuning-shared-pool-and-large-pool.html#GUID-C155964B-7F66-49C4-9F88-916F0217303D__BABJDAAJ" title="此表描述了在V $ SESSTAT视图中收集的统计信息，以了解所使用的总内存。">表14-2</a>列出了此视图中反映会话UGA内存的统计信息。
                        </p>
                        <div class="tblformal" id="GUID-C155964B-7F66-49C4-9F88-916F0217303D__BABJDAAJ">
                           <p class="titleintable">表14-2 V $ SESSTAT视图中的内存统计信息</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="V $ SESSTAT视图中的内存统计信息" width="100%" border="1" summary="This table describes the statistics collected in the V$SESSTAT view for total memory used." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="29%" id="d41928e4309">统计</th>
                                    <th align="left" valign="bottom" width="71%" id="d41928e4312">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="29%" id="d41928e4317" headers="d41928e4309 ">
                                       <p><a id="d41928e4319" class="indexterm-anchor"></a><a id="d41928e4321" class="indexterm-anchor"></a><code class="codeph">session UGA memory</code></p>
                                    </td>
                                    <td align="left" valign="top" width="71%" headers="d41928e4317 d41928e4312 ">
                                       <p>显示分配给会话的内存量（以字节为单位）。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="29%" id="d41928e4331" headers="d41928e4309 ">
                                       <p><a id="d41928e4333" class="indexterm-anchor"></a><a id="d41928e4337" class="indexterm-anchor"></a><code class="codeph">session UGA memory max</code></p>
                                    </td>
                                    <td align="left" valign="top" width="71%" headers="d41928e4331 d41928e4312 ">
                                       <p>显示分配给会话的最大内存量（以字节为单位）。</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                        <p>有两种方法可以使用此视图来确定大型池的正确大小。一种方法是根据同时活动的会话数配置大型池的大小。为此，请观察典型用户的UGA内存使用情况，并将此数量乘以估计的用户会话数。例如，如果共享服务器需要200K到300K来存储典型用户会话的会话信息，并且您预期同时有100个活动用户会话，则将大型池配置为30 MB。</p>
                        <p>另一种方法是计算所有用户会话使用的总内存和最大内存。<a href="tuning-shared-pool-and-large-pool.html#GUID-C155964B-7F66-49C4-9F88-916F0217303D__BABDFFIB">例14-5</a>显示了<code class="codeph">V$SESSTAT</code>和<code class="codeph">V$STATNAME</code>视图的两个查询来执行此操作。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-C155964B-7F66-49C4-9F88-916F0217303D__BABDFFIB">
                        <p class="titleinexample">示例14-5查询V $ SESSTAT和V $ STATNAME视图</p>
                        <p>在应用程序运行时，发出以下查询：</p><pre class="oac_no_warn" dir="ltr">SELECT SUM（value）|| 'bytes'“所有会话的总内存”FROM V $ SESSTAT，V $ STATNAME WHERE name ='session uga memory'AND V $ SESSTAT.STATISTIC＃= V $ STATNAME.STATISTIC＃;</pre><pre class="oac_no_warn" dir="ltr">SELECT SUM（value）|| 'bytes'“所有会话的总max mem”FROM V $ SESSTAT，V $ STATNAME WHERE name ='session uga memory max'AND V $ SESSTAT.STATISTIC＃= V $ STATNAME.STATISTIC＃;</pre><p>这些查询还从<code class="codeph">V$STATNAME</code>视图中进行选择，以获取<code class="codeph">session memory</code>和<code class="codeph">max session memory</code>内部标识符。
                        </p>
                        <p>这些查询的输出可能如下所示：</p><pre class="oac_no_warn" dir="ltr">所有会议的总记忆----------------------------- 157125 BYTES</pre><pre class="oac_no_warn" dir="ltr">所有会议的总MAX MEM ------------------------------ 417381 BYTES</pre><p>第一个查询的结果显示当前分配给所有会话的内存为157,125个字节。此值是具有位置的总内存，该位置取决于会话连接到数据库的方式。如果会话连接到专用服务器进程，则此内存是用户进程的内存的一部分。如果会话连接到共享服务器进程，则此内存是共享池的一部分。</p>
                        <p>第二个查询的结果显示所有会话的最大内存大小总和为417,381字节。第二个结果大于第一个结果，因为一些会话已经释放了内存，因为分配了它们的最大数量。</p>
                        <p>使用任一查询的结果来确定共享池的正确大小。除非您希望所有会话同时达到其最大分配，否则第一个值可能比第二个值更好。</p>
                        <div class="p"><span class="bold">要调整大型池的大小：</span><ol>
                              <li>
                                 <p>通过检查<code class="codeph">V$SGASTAT</code>视图中的<code class="codeph">POOL</code>列，验证对象内存所在的池（共享池或大型池）。
                                 </p>
                              </li>
                              <li>
                                 <p>设置一个值<a id="d41928e4405" class="indexterm-anchor"></a> <code class="codeph">LARGE_POOL_SIZE</code>初始化参数。
                                 </p>
                                 <p>此参数的最小值为300K。</p>
                              </li>
                           </ol>
                        </div>
                     </div>
                     <!-- class="example" -->
                  </div>
               </div><a id="TGDBA614"></a><div class="props_rev_3"><a id="GUID-2354F7EE-7E3B-4399-B4D9-646BDB00E162" name="GUID-2354F7EE-7E3B-4399-B4D9-646BDB00E162"></a><h4 id="TGDBA-GUID-2354F7EE-7E3B-4399-B4D9-646BDB00E162" class="sect4"><span class="enumeration_section">14.4.4</span>限制用户会话的内存使用</h4>
                  <div>
                     <div class="section">
                        <p>要限制每个客户端会话使用的内存与SGA，请使用<code class="codeph">PRIVATE_SGA</code>设置资源限制。</p>
                        <p><code class="codeph">PRIVATE_SGA</code>定义会话从SGA使用的内存字节数。但是，此参数很少使用，因为大多数DBA不会逐个用户地限制SGA消耗。
                        </p>
                        <div class="infoboxnotealso" id="GUID-2354F7EE-7E3B-4399-B4D9-646BDB00E162__GUID-5ABBE044-FB25-4ADF-9607-61E8D6370A54">
                           <p class="notep1">也可以看看：</p>
                           <p><span class="italic"> </span>有关设置<code class="codeph">PRIVATE_SGA</code>资源限制的信息，请<a href="../sqlrf/ALTER-RESOURCE-COST.html#SQLRF00814" target="_blank"><span class="italic">参见Oracle数据库SQL语言参考</span></a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="TGDBA615"></a><div class="props_rev_3"><a id="GUID-8ABD6078-F667-46A9-8289-89B5D4FF18B6" name="GUID-8ABD6078-F667-46A9-8289-89B5D4FF18B6"></a><h4 id="TGDBA-GUID-8ABD6078-F667-46A9-8289-89B5D4FF18B6" class="sect4"><span class="enumeration_section">14.4.5</span>使用三层连接减少内存使用</h4>
                  <div>
                     <p>如果存在大量连接用户，则考虑通过实现三层连接来减少内存使用量。使用事务处理（TP）监视器仅对纯事务模型是可行的，因为在调用之间不能保持锁定和未提交的DML操作。</p>
                     <p>使用共享服务器环境：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>与TP监视器相比，应用程序设计的限制性要小得多。</p>
                        </li>
                        <li>
                           <p>通过允许用户共享服务器池，显着减少操作系统进程数和上下文切换。</p>
                        </li>
                        <li>
                           <p>尽管在共享服务器模式下使用了更多SGA，但实质上减少了整体内存使用量。</p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>