<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>嵌入式PL / SQL</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Programmer&#39;s Guide"></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Programmer&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="cobol-programmers-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-11T02:40:40-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96466-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="embedded-SQL.html" title="Previous" type="text/html"></link>
      <link rel="next" href="host-tables.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Pro*COBOL Programmer&#39;s Guide"></meta>
    <meta name="dcterms.isVersionOf" content="LNPCB"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="embedded-SQL.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="host-tables.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">程序员指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="introduction-and-concepts.html" property="item" typeof="WebPage"><span property="name">介绍和概念</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">嵌入式PL / SQL</li>
            </ol>
            <a id="GUID-7E17F1C4-BAF4-42A8-8D5C-9A5F3477C91F" name="GUID-7E17F1C4-BAF4-42A8-8D5C-9A5F3477C91F"></a><a id="LNPCB006"></a>
            
            <h2 id="LNPCB-GUID-7E17F1C4-BAF4-42A8-8D5C-9A5F3477C91F" class="sect2"><span class="enumeration_chapter">6</span>嵌入式PL / SQL</h2>
         </header>
         <div class="ind">
            <div>
               <p>本章介绍如何通过在程序中嵌入PL / SQL事务处理块来提高性能。本章包括以下部分：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="embedded-PLSQL.html#GUID-5875AEF0-38CC-4BA3-A480-491B91164D66">嵌入PL / SQL</a></p>
                  </li>
                  <li>
                     <p><a href="embedded-PLSQL.html#GUID-E650544F-77AB-40AC-AC1B-46063E12354C">PL / SQL的优点</a></p>
                  </li>
                  <li>
                     <p><a href="embedded-PLSQL.html#GUID-4E2650AD-0169-4550-A756-BB649BFF04BA">嵌入PL / SQL块</a></p>
                  </li>
                  <li>
                     <p><a href="embedded-PLSQL.html#GUID-B5776E2F-BD5E-4CD2-8CBC-C266498B006B">主机变量和PL / SQL</a></p>
                  </li>
                  <li>
                     <p><a href="embedded-PLSQL.html#GUID-1C3A5AAA-B45D-4CFE-A086-BFDCD942EB9F">指标变量和PL / SQL</a></p>
                  </li>
                  <li>
                     <p><a href="embedded-PLSQL.html#GUID-F737A34F-47BC-4E36-A264-C26165B3EE19">主机表和PL / SQL</a></p>
                  </li>
                  <li>
                     <p><a href="embedded-PLSQL.html#GUID-FDFEDCF5-F2C0-4624-A303-6B54038371B1">嵌入式PL / SQL中的游标用法</a></p>
                  </li>
                  <li>
                     <p><a href="embedded-PLSQL.html#GUID-0CE314F6-4867-44C3-B14F-9580BDB621FC">存储的PL / SQL和Java子程序</a></p>
                  </li>
                  <li>
                     <p><a href="embedded-PLSQL.html#GUID-8516DBAD-41AE-4A03-8331-6DEF3A2DE831">示例程序9：调用存储过程</a></p>
                  </li>
                  <li>
                     <p><a href="embedded-PLSQL.html#GUID-78B25FD8-15B5-4253-BC9C-5C7C907DE354">游标变量</a> 
                     </p>
                  </li>
               </ul>
            </div><a id="LNPCB398"></a><div class="props_rev_3"><a id="GUID-5875AEF0-38CC-4BA3-A480-491B91164D66" name="GUID-5875AEF0-38CC-4BA3-A480-491B91164D66"></a><h3 id="LNPCB-GUID-5875AEF0-38CC-4BA3-A480-491B91164D66" class="sect3"><span class="enumeration_section">6.1</span>嵌入PL / SQL</h3>
               <div>
                  <p>Pro * COBOL将PL / SQL块视为单个嵌入式SQL语句。您可以将PL / SQL块放在可以放置SQL语句的主机程序中的任何位置。<a id="d38166e98" class="indexterm-anchor"></a><a id="d38166e102" class="indexterm-anchor"></a></p>
                  <p>要在主机程序中嵌入PL / SQL块，请声明要与PL / SQL共享的变量，并将PL / SQL块与EXEC SQL EXECUTE和END-EXEC关键字括起来。<a id="d38166e108" class="indexterm-anchor"></a></p>
               </div><a id="LNPCB399"></a><div class="props_rev_3"><a id="GUID-7C917325-F581-4308-9633-FF1972F4F8C3" name="GUID-7C917325-F581-4308-9633-FF1972F4F8C3"></a><h4 id="LNPCB-GUID-7C917325-F581-4308-9633-FF1972F4F8C3" class="sect4"><span class="enumeration_section">6.1.1</span>主机变量</h4>
                  <div>
                     <p>在PL / SQL块中，主变量对整个块是全局的，并且可以在允许PL / SQL变量的任何地方使用。与SQL语句中的主变量一样，PL / SQL块中的主机变量必须以冒号为前缀。冒号设置除PL / SQL变量和数据库对象之外的主变量。<a id="d38166e136" class="indexterm-anchor"></a><a id="d38166e140" class="indexterm-anchor"></a></p>
                  </div>
               </div><a id="LNPCB400"></a><div class="props_rev_3"><a id="GUID-9F511045-8D92-4BA2-AEAC-CE4BD7CBA3BE" name="GUID-9F511045-8D92-4BA2-AEAC-CE4BD7CBA3BE"></a><h4 id="LNPCB-GUID-9F511045-8D92-4BA2-AEAC-CE4BD7CBA3BE" class="sect4"><span class="enumeration_section">6.1.2</span> VARCHAR变量</h4>
                  <div>
                     <p>进入PL / SQL块时，Oracle会自动检查VARCHAR主机变量的长度字段。因此，必须<span class="italic">在</span>输入块<span class="italic">之前</span>设置长度字段。对于输入变量，将长度字段设置为存储在字符串字段中的值的长度。对于输出变量，将长度字段设置为字符串字段允许的最大长度。<a id="d38166e171" class="indexterm-anchor"></a><a id="d38166e175" class="indexterm-anchor"></a></p>
                  </div>
               </div><a id="LNPCB401"></a><div class="props_rev_3"><a id="GUID-D897BA41-8C02-4B21-BF7D-0E6C33268FCB" name="GUID-D897BA41-8C02-4B21-BF7D-0E6C33268FCB"></a><h4 id="LNPCB-GUID-D897BA41-8C02-4B21-BF7D-0E6C33268FCB" class="sect4"><span class="enumeration_section">6.1.3</span>指标变量</h4>
                  <div>
                     <p>在PL / SQL块中，您不能单独引用指标变量;它必须附加到其关联的主变量。此外，如果您使用其指示符变量引用主变量，则必须始终在同一块中以该方式引用它。<a id="d38166e204" class="indexterm-anchor"></a><a id="d38166e208" class="indexterm-anchor"></a></p>
                  </div><a id="LNPCB402"></a><div class="props_rev_3"><a id="GUID-FEFE1D9C-2490-43D1-8ABF-56286883AAD7" name="GUID-FEFE1D9C-2490-43D1-8ABF-56286883AAD7"></a><h5 id="LNPCB-GUID-FEFE1D9C-2490-43D1-8ABF-56286883AAD7" class="sect5"><span class="enumeration_section">6.1.3.1</span>处理NULL</h5>
                     <div>
                        <p>输入块时，如果指示符变量的值为-1，则PL / SQL会自动为主变量分配NULL。退出块时，如果主变量为NULL，PL / SQL会自动为指示符变量赋值-1。<a id="d38166e236" class="indexterm-anchor"></a><a id="d38166e242" class="indexterm-anchor"></a></p>
                     </div>
                  </div><a id="LNPCB403"></a><div class="props_rev_3"><a id="GUID-EDB24807-508C-434D-83CF-0907751997AD" name="GUID-EDB24807-508C-434D-83CF-0907751997AD"></a><h5 id="LNPCB-GUID-EDB24807-508C-434D-83CF-0907751997AD" class="sect5"><span class="enumeration_section">6.1.3.2</span>处理截断值</h5>
                     <div>
                        <p>将截断的字符串值分配给主机变量时，PL / SQL不会引发异常。但是，如果使用指示符变量，PL / SQL会将其设置为字符串的原始长度。<a id="d38166e270" class="indexterm-anchor"></a><a id="d38166e274" class="indexterm-anchor"></a></p>
                     </div>
                  </div>
               </div><a id="LNPCB404"></a><div class="props_rev_3"><a id="GUID-10E4FE55-5F1C-4C58-860A-666085A14E41" name="GUID-10E4FE55-5F1C-4C58-860A-666085A14E41"></a><h4 id="LNPCB-GUID-10E4FE55-5F1C-4C58-860A-666085A14E41" class="sect4"><span class="enumeration_section">6.1.4</span> SQLCHECK</h4>
                  <div>
                     <p>在使用嵌入式PL / SQL块预编译程序时，必须指定SQLCHECK = SEMANTICS。您还必须使用USERID选项。</p>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="precompiler-options.html#GUID-B0794F03-C488-4F87-92D2-6B4BEF74EBFB">预编译器选项</a></li>
                        </ul>
                     </div>
                  </div>
               </div>
            </div><a id="LNPCB405"></a><div class="props_rev_3"><a id="GUID-E650544F-77AB-40AC-AC1B-46063E12354C" name="GUID-E650544F-77AB-40AC-AC1B-46063E12354C"></a><h3 id="LNPCB-GUID-E650544F-77AB-40AC-AC1B-46063E12354C" class="sect3"><span class="enumeration_section">6.2</span> PL / SQL的优点</h3>
               <div>
                  <p>本节介绍PL / SQL提供的一些功能和优点，例如：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>更好的性能</p>
                     </li>
                     <li>
                        <p>与Oracle集成</p>
                     </li>
                     <li>
                        <p>游标FOR循环</p>
                     </li>
                     <li>
                        <p>程序和功能</p>
                     </li>
                     <li>
                        <p>包</p>
                     </li>
                     <li>
                        <p>PL / SQL表</p>
                     </li>
                     <li>
                        <p>用户定义的记录</p>
                     </li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-E650544F-77AB-40AC-AC1B-46063E12354C__GUID-0CF846CE-3511-473F-B07B-B0F8BCE56C1F">
                     <p class="notep1">也可以看看：</p>有关PL / SQL的更多信息，请<a href="../lnpls/index.html" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a> 。</div>
               </div><a id="LNPCB406"></a><div class="props_rev_3"><a id="GUID-B15FA86A-5C5B-40DD-8D2D-119D37554C62" name="GUID-B15FA86A-5C5B-40DD-8D2D-119D37554C62"></a><h4 id="LNPCB-GUID-B15FA86A-5C5B-40DD-8D2D-119D37554C62" class="sect4"><span class="enumeration_section">6.2.1</span>更好的表现</h4>
                  <div>
                     <p>PL / SQL可以帮助您减少开销，提高性能并提高工作效率。例如，如果没有PL / SQL，Oracle必须一次处理一个SQL语句。每个SQL语句都会导致对服务器的另一次调用以及更高的开销。但是，使用PL / SQL，您可以将整个SQL语句块发送到服务器。这可以最大限度地减少应用程序和服务器之间的通<a id="d38166e383" class="indexterm-anchor"></a></p>
                  </div>
               </div><a id="LNPCB407"></a><div class="props_rev_3"><a id="GUID-FE1148A5-B0B7-4B35-ADCE-212AB849353F" name="GUID-FE1148A5-B0B7-4B35-ADCE-212AB849353F"></a><h4 id="LNPCB-GUID-FE1148A5-B0B7-4B35-ADCE-212AB849353F" class="sect4"><span class="enumeration_section">6.2.2</span>与Oracle集成</h4>
                  <div>
                     <p>PL / SQL与服务器紧密集成。例如，大多数PL / SQL数据类型都是数据字典的原生数据类型。此外，您可以使用％TYPE属性将变量声明基于存储在数据字典中的列定义，如以下示例所示： <a id="d38166e411" class="indexterm-anchor"></a><a id="d38166e415" class="indexterm-anchor"></a> 
                     </p><pre class="oac_no_warn" dir="ltr">job_title emp.job％TYPE;</pre><p>这样，您无需知道列的确切数据类型。此外，如果列定义发生更改，则变量声明会相应地自动更改。这提供了数据独立性，降低了维护成本，并允许程序随着数据库的变化而适应。</p>
                  </div>
               </div><a id="LNPCB408"></a><div class="props_rev_3"><a id="GUID-41A875C7-C367-48B9-890C-ED82B6A9B758" name="GUID-41A875C7-C367-48B9-890C-ED82B6A9B758"></a><h4 id="LNPCB-GUID-41A875C7-C367-48B9-890C-ED82B6A9B758" class="sect4"><span class="enumeration_section">6.2.3</span>游标FOR循环</h4>
                  <div>
                     <p>使用PL / SQL，您无需使用DECLARE，OPEN，FETCH和CLOSE语句来定义和操作游标。相反，您可以使用游标FOR循环，它隐式声明其循环索引作为记录，打开与给定查询关联的游标，重复从游标中取出数据到记录中，然后关闭游标。一个例子如下： <a id="d38166e449" class="indexterm-anchor"></a><a id="d38166e453" class="indexterm-anchor"></a> 
                     </p><pre class="oac_no_warn" dir="ltr">宣布 ...BEGIN FOR emprec IN（SELECT empno，sal，comm FROM emp）LOOP IF emprec.comm / emprec.sal&gt; 0.25 THEN ......结束循环;结束;</pre><p>请注意，您使用点表示法来引用记录中的字段。</p>
                  </div>
               </div><a id="LNPCB409"></a><div class="props_rev_3"><a id="GUID-2BADA87D-DA15-4218-BA7E-C1512A5EB942" name="GUID-2BADA87D-DA15-4218-BA7E-C1512A5EB942"></a><h4 id="LNPCB-GUID-2BADA87D-DA15-4218-BA7E-C1512A5EB942" class="sect4"><span class="enumeration_section">6.2.4</span>子程序</h4>
                  <div>
                     <p>PL / SQL有两种类型的子程序，称为<span class="italic">过程</span>和<span class="italic">函数</span> ，它们通过让您隔离操作来帮助开发应用程序。通常，您使用过程来执行操作，使用函数来计算值。<a id="d38166e492" class="indexterm-anchor"></a><a id="d38166e496" class="indexterm-anchor"></a><a id="d38166e500" class="indexterm-anchor"></a></p>
                     <p>程序和功能提供了<span class="italic">可扩展性</span> 。也就是说，它们可以让您定制PL / SQL语言以满足您的需求。例如，如果您需要一个创建新部门的过程，您可以编写自己的部门，如下所示：</p><pre class="oac_no_warn" dir="ltr">PROCEDURE create_dept（new_dname IN CHAR（14），new_loc IN CHAR（13），new_deptno OUT NUMBER（2））IS BEGIN SELECT deptno_seq。NEXTVAL INTO new_deptno FROM dual; INSERT INTO dept VALUES（new_deptno，new_dname，new_loc）; END create_dept;</pre><p>调用时，此过程接受新的部门名称和位置，选择部门编号数据库序列中的下一个值，将新编号，名称和位置插入到<span class="italic">dept</span>表中，然后将新编号返回给调用者。
                     </p>
                     <p>您可以在数据库中存储子程序（使用CREATE FUNCTION和CREATE PROCEDURE），这些子程序可以从多个应用程序调用，而无需每次都重新编译。</p>
                  </div><a id="LNPCB410"></a><div class="props_rev_3"><a id="GUID-6A6B5E5A-7255-4C75-9C33-3E688BDD215B" name="GUID-6A6B5E5A-7255-4C75-9C33-3E688BDD215B"></a><h5 id="LNPCB-GUID-6A6B5E5A-7255-4C75-9C33-3E688BDD215B" class="sect5"><span class="enumeration_section">6.2.4.1</span>参数模式</h5>
                     <div>
                        <p>您可以使用<span class="italic">参数模式</span>来定义形式参数的行为。有三种参数模式：IN（默认值），OUT和IN OUT。 IN参数允许您将值传递给被调用的子程序。OUT参数允许您将值返回给子程序的调用者。IN OUT参数允许您将初始值传递给被调用的子程序，并将更新的值返回给调用者。 <a id="d38166e543" class="indexterm-anchor"></a><a id="d38166e545" class="indexterm-anchor"></a><a id="d38166e547" class="indexterm-anchor"></a><a id="d38166e549" class="indexterm-anchor"></a><a id="d38166e551" class="indexterm-anchor"></a> 
                        </p>
                        <p>每个实际参数的数据类型必须可转换为其相应形式参数的数据类型。<a href="embedded-PLSQL.html#GUID-F737A34F-47BC-4E36-A264-C26165B3EE19__BEIDDGEA" title="q">表6-1</a>显示了数据类型之间的合法转换。
                        </p>
                     </div>
                  </div>
               </div><a id="LNPCB411"></a><div class="props_rev_3"><a id="GUID-C1BEF847-BA1F-414E-B5CE-EAAB36BAD7F5" name="GUID-C1BEF847-BA1F-414E-B5CE-EAAB36BAD7F5"></a><h4 id="LNPCB-GUID-C1BEF847-BA1F-414E-B5CE-EAAB36BAD7F5" class="sect4"><span class="enumeration_section">6.2.5</span>包</h4>
                  <div>
                     <p>PL / SQL允许您将逻辑上相关的类型，程序对象和子程序捆绑到一个<span class="italic">包中</span> 。包可以编译并存储在数据库中，其中的内容可以由多个应用程序共享。<a id="d38166e588" class="indexterm-anchor"></a><a id="d38166e592" class="indexterm-anchor"></a></p>
                     <p>包通常包含两部分：规范和正文。<span class="italic">规范</span>是应用程序的接口;它声明了可供使用的类型，常量，变量，异常，游标和子程序。<span class="italic">正文</span>定义了游标和子程序，因此实现了规范。以下示例“打包”两个雇佣程序：</p><pre class="oac_no_warn" dir="ltr">PACKAGE emp_actions IS  - 包规范PROCEDURE hire_employee（empno NUMBER，ename CHAR，...）;程序fire_employee（emp_id NUMBER）; END emp_actions; PACKAGE BODY emp_actions IS  - 包体PROCEDURE hire_employee（empno NUMBER，ename CHAR，...）是开始插入emp VALUES（empno，ename，...）; END hire_employee;程序fire_employee（emp_id NUMBER）从emp WHERE empno = emp_id开始删除;结束fire_employee; END emp_actions;</pre><p>只有包规范中的声明可见且可供应用程序访问。包体中的实现细节是隐藏的，无法访问。</p>
                  </div>
               </div><a id="LNPCB412"></a><div class="props_rev_3"><a id="GUID-992D2D7E-7387-40F8-94EA-E8F90DB57932" name="GUID-992D2D7E-7387-40F8-94EA-E8F90DB57932"></a><h4 id="LNPCB-GUID-992D2D7E-7387-40F8-94EA-E8F90DB57932" class="sect4"><span class="enumeration_section">6.2.6</span> PL / SQL表</h4>
                  <div>
                     <p>PL / SQL提供名为TABLE的复合数据类型。 TABLE类型的对象称为<span class="italic">PL / SQL表</span> ，它们被建模为（但不是相同的）数据库表。PL / SQL表只有一列，并使用主键为您提供类似行的行访问。该列可以属于任何标量类型（例如CHAR，DATE或NUMBER），但主键必须属于BINARY_INTEGER，PLS_INTEGER或VARCHAR2类型。 <a id="d38166e636" class="indexterm-anchor"></a><a id="d38166e638" class="indexterm-anchor"></a> 
                     </p>
                     <p>您可以在任何块，过程，函数或包的声明部分中声明PL / SQL表类型。以下示例声明了一个名为<span class="italic">NumTabTyp</span>的TABLE类型：</p><pre class="oac_no_warn" dir="ltr">DECLARE TYPE NumTabTyp是BINARY_INTEGER的数字索引表; ...开始 ...结束;</pre><p>定义类型<span class="italic">NumTabTyp后</span> ，可以声明该类型的PL / SQL表，如下一个示例所示：</p><pre class="oac_no_warn" dir="ltr">num_tab NumTabTyp;</pre><p>标识符<span class="italic">num_tab</span>表示整个PL / SQL表。
                     </p>
                     <p>使用类似数组的语法引用PL / SQL表中的行以指定主键值。例如，您引用名为<span class="italic">num_tab</span>的PL / SQL表中的第九行，如下所示：</p><pre class="oac_no_warn" dir="ltr">num_tab（9）......</pre></div>
               </div><a id="LNPCB413"></a><div class="props_rev_3"><a id="GUID-9852B57C-505E-4DBE-BFEC-E0793CF18AA9" name="GUID-9852B57C-505E-4DBE-BFEC-E0793CF18AA9"></a><h4 id="LNPCB-GUID-9852B57C-505E-4DBE-BFEC-E0793CF18AA9" class="sect4"><span class="enumeration_section">6.2.7</span>用户定义的记录</h4>
                  <div>
                     <p>您可以使用％ROWTYPE属性声明一条记录，该记录表示数据库表中的行或游标提取的行。但是，您无法在记录中指定字段的数据类型，也无法定义自己的字段数据类型。复合数据类型RECORD解除了这些限制。 <a id="d38166e693" class="indexterm-anchor"></a><a id="d38166e695" class="indexterm-anchor"></a><a id="d38166e697" class="indexterm-anchor"></a><a id="d38166e701" class="indexterm-anchor"></a> 
                     </p>
                     <p>RECORD类型的对象称为<span class="italic">记录</span> 。与PL / SQL表不同，记录具有唯一命名的字段，这些字段可以属于不同的数据类型。例如，假设您有关于员工的不同类型的数据，例如姓名，工资，雇用日期等。这些数据在类型上不同但在逻辑上相关。包含员工姓名，工资和雇用日期等字段的记录可让您将数据视为逻辑单元。
                     </p>
                     <p>您可以在任何块，过程，函数或包的声明部分中声明记录类型和对象。以下示例声明了一个名为<span class="italic">DeptRecTyp</span>的RECORD类型：</p><pre class="oac_no_warn" dir="ltr">DECLARE TYPE DeptRecTyp是RECORD（deptno NUMBER（4）NOT NULL：= 10， - 必须初始化dname CHAR（9），loc CHAR（14））;</pre><p>请注意，字段声明类似于变量声明。每个字段都有唯一的名称和特定的数据类型。您可以将NOT NULL选项添加到任何字段声明中，从而防止将NULL分配给该字段。但是，您必须初始化NOT NULL字段。</p>
                     <p>一旦定义了类型<span class="italic">DeptRecTyp</span> ，就可以声明该类型的记录，如下一个示例所示：</p><pre class="oac_no_warn" dir="ltr">dept_rec DeptRecTyp;</pre><p>标识符<span class="italic">dept_rec</span>表示整个记录。
                     </p>
                     <p>您使用点表示法来引用记录中的各个字段。例如，您在<span class="italic">dept_rec</span>记录中引用<span class="italic">dname</span>字段，如下所示：</p><pre class="oac_no_warn" dir="ltr">dept_rec.dname ...</pre></div>
               </div>
            </div><a id="LNPCB414"></a><div class="props_rev_3"><a id="GUID-4E2650AD-0169-4550-A756-BB649BFF04BA" name="GUID-4E2650AD-0169-4550-A756-BB649BFF04BA"></a><h3 id="LNPCB-GUID-4E2650AD-0169-4550-A756-BB649BFF04BA" class="sect3"><span class="enumeration_section">6.3</span>嵌入PL / SQL块</h3>
               <div>
                  <p>Pro * COBOL将PL / SQL块视为单个嵌入式SQL语句。因此，您可以将PL / SQL块放在可以放置SQL语句的主机程序中的任何位置。 <a id="d38166e767" class="indexterm-anchor"></a><a id="d38166e771" class="indexterm-anchor"></a> 
                  </p>
                  <p>要在主机程序中嵌入PL / SQL块，只需将PL / SQL块与关键字EXEC SQL EXECUTE和END-EXEC括起来，如下所示：</p><pre class="oac_no_warn" dir="ltr">EXEC SQL EXECUTE DECLARE ...开始 ...结束; END-EXEC。</pre><p>当程序嵌入PL / SQL块时，必须指定预编译器选项SQLCHECK = SEMANTICS，因为PL / SQL必须由Pro * COBOL解析。要连接到服务器，还必须指定选项USERID。<a id="d38166e782" class="indexterm-anchor"></a><a id="d38166e786" class="indexterm-anchor"></a></p>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="precompiler-options.html#GUID-4FAE1823-EDA0-4A86-B904-FC7FA3CD472B">使用Pro * COBOL预编译器选项</a></li>
                     </ul>
                  </div>
               </div>
            </div><a id="LNPCB415"></a><div class="props_rev_3"><a id="GUID-B5776E2F-BD5E-4CD2-8CBC-C266498B006B" name="GUID-B5776E2F-BD5E-4CD2-8CBC-C266498B006B"></a><h3 id="LNPCB-GUID-B5776E2F-BD5E-4CD2-8CBC-C266498B006B" class="sect3"><span class="enumeration_section">6.4</span>主机变量和PL / SQL</h3>
               <div>
                  <p>主机变量是主机语言和PL / SQL块之间通信的关键。主机变量可以与PL / SQL共享，这意味着PL / SQL可以设置和引用主机变量。</p>
                  <p>例如，您可以提示用户输入信息并使用主机变量将该信息传递给PL / SQL块。然后，PL / SQL可以访问数据库并使用主机变量将结果传递回主机程序。 <a id="d38166e821" class="indexterm-anchor"></a> 
                  </p>
                  <p>在PL / SQL块中，主变量被视为整个块的全局变量，可以在允许PL / SQL变量的任何地方使用。与SQL语句中的主变量一样，PL / SQL块中的主机变量必须以冒号为前缀。冒号设置除PL / SQL变量和数据库对象之外的主变量。</p>
               </div><a id="LNPCB416"></a><div class="props_rev_3"><a id="GUID-9BEF31AA-DA7E-4642-8C22-FE3EC8118657" name="GUID-9BEF31AA-DA7E-4642-8C22-FE3EC8118657"></a><h4 id="LNPCB-GUID-9BEF31AA-DA7E-4642-8C22-FE3EC8118657" class="sect4"><span class="enumeration_section">6.4.1</span> PL / SQL示例</h4>
                  <div>
                     <p>以下示例说明了使用PL / SQL的主机变量。程序会提示用户输入员工编号，然后显示该员工的职位，雇用日期和工资。 <a id="d38166e858" class="indexterm-anchor"></a> 
                     </p><pre class="oac_no_warn" dir="ltr">EXEC SQL BEGIN DECLARE SECTION END-EXEC。 01 USERNAME PIC X（20）变化。 01 PASSWORD PIC X（20）变化。 01 EMP-NUMBER PIC S9（4）COMP。 01 JOB-TITLE PIC X（20）变化。 01 HIRE-DATE PIC X（9）变化。 01 SALARY PIC S9（6）V99显示标志领先独立。 EXEC SQL END DECLARE SECTION END-EXEC。 EXEC SQL包含SQLCA END-EXEC。 ...显示'连接到Oracle'。执行显示'员工编号（0到结束）？'如果EMP-NUMBER = 0 EXEC SQL COMMIT WORK RELEASE END-EXEC DISPLAY'退出程序'停止运行结束-IF，则没有进阶EMP-NUMBER。 * ----------------开始PL / SQL块----------------- EXEC SQL EXECUTE BEGIN SELECT job，hiredate，sal INTO ：JOB-TITLE，：HIRE-DATE，：EMPNO = EMP-NUMBER的EMP SALARY;结束; END-EXEC。 * ----------------结束PL / SQL块----------------- DISPLAY'号码职位聘用日期薪水'。显示'------------------------------------'。显示EMP-NUMBER，JOB-TITLE，HIRE-DATE，SALARY。 END-PERFORM。 ...SQL-ERROR。执行SQL WHENEVER SQLERROR CONTINUE END-EXEC。 EXEC SQL ROLLBACK工作发布END-EXEC。显示'处理错误'。停止运行。</pre><p>请注意，在输入PL / SQL块之前设置主机变量<span class="italic">EMP-NUMBER</span> ，并在块内设置主机变量<span class="italic">JOB-TITLE，HIRE-DATE</span>和<span class="italic">SALARY</span> 。
                     </p>
                  </div>
               </div><a id="LNPCB417"></a><div class="props_rev_3"><a id="GUID-8919B1B9-30CB-4231-A032-8CCE74E28C2C" name="GUID-8919B1B9-30CB-4231-A032-8CCE74E28C2C"></a><h4 id="LNPCB-GUID-8919B1B9-30CB-4231-A032-8CCE74E28C2C" class="sect4"><span class="enumeration_section">6.4.2</span>更复杂的PL / SQL示例</h4>
                  <div>
                     <p>在以下示例中，将提示用户输入银行帐号，交易类型和交易金额。然后该帐户被记入借方或贷方。如果该帐户不存在，则会引发异常。交易完成后，将显示其状态。 <a id="d38166e900" class="indexterm-anchor"></a> 
                     </p><pre class="oac_no_warn" dir="ltr">EXEC SQL BEGIN DECLARE SECTION END-EXEC。 01 USERNAME PIC X（20）变化。 01 ACCT-NUM PIC S9（4）COMP。 01 TRANS-TYPE PIC X（1）。01 TRANS-AMT PIC PIC S9（6）V99显示标志领先分离。 01状态PIC X（80）变化。 EXEC SQL END DECLARE SECTION END-EXEC。 EXEC SQL包含SQLCA END-EXEC。显示'用户名？'没有进步。接受用户名。显示'密码？”。接受密码。执行SQL WHENEVER SQLERROR执行SQL-ERROR。 EXEC SQL CONNECT：USERNAME IDENTIFIED BY：PASSWORD。 PERFORM DISPLAY'帐号（0到结束）？'没有进阶ACCE_NUM如果ACCT-NUM = 0 EXEC SQL COMMIT WORK RELEASE END-EXEC DISPLAY'退出程序'没有高级停止运行结束-IF。显示'交易类型 -  D）ebit或C）redit？'没有先进的接受转型显示'交易金额？'接受trans_amt * ---------------------开始PL / SQL块-------------------执行SQL EXECUTE DECLARE old_bal NUMBER（9,2）; err_msg CHAR（70）;不存在的例外; BEGIN IF：TRANS-TYP-TYPE ='C'那么 - 记入账户UPDATE accts SET bal = bal +：TRANS-AMT WHERE acctid =：acct-num;如果SQL％ROWCOUNT = 0那么 - 没有影响RAISE的行不存在; ELSE：STATUs：='Credit applied';万一; ELSIF：TRANS-TYPe ='D'那么 - 借记帐户SELECT bal INTO old_bal FROM accts WHERE acctid =：ACCT-NUM;如果old_bal&gt; =：TRANS-AMT THEN  - 足够的资金UPDATE accts SET bal = bal  - ：TRANS-AMT WHERE acctid =：ACCT-NUM; ：STATUS：='借记已申请'; ELSE：STATUS：='资金不足';万一; ELSE：STATUS：='无效类型：'|| ：TRANS-TYPE;万一;承诺; NO_DATA_FOUND或不存在时的异常那么：STATUS：='不存在的帐户';当其他的时候，err_msg：= SUBSTR（SQLERRM，1,70）; ：STATUS：='错误：'|| ERR_MSG;结束; END-EXEC。 * -------------------结束PL / SQL块----------------------- DISPLAY'状态：'，状态结束 - 执行。 ...SQL-ERROR。执行SQL WHENEVER SQLERROR CONTINUE END-EXEC。 EXEC SQL ROLLBACK工作发布END-EXEC。显示'处理错误'。停止运行。</pre></div>
               </div><a id="LNPCB418"></a><div class="props_rev_3"><a id="GUID-823348E3-97F8-4020-91F2-4B1F087C62DB" name="GUID-823348E3-97F8-4020-91F2-4B1F087C62DB"></a><h4 id="LNPCB-GUID-823348E3-97F8-4020-91F2-4B1F087C62DB" class="sect4"><span class="enumeration_section">6.4.3</span> VARCHAR Pseudotype</h4>
                  <div>
                     <p>回想一下，您可以使用VARCHAR假型来声明可变长度的字符串。如果VARCHAR是输入主变量，则必须告诉Pro * COBOL期望的长度。因此，将长度字段设置为存储在字符串字段中的值的实际长度。</p>
                     <p>如果VARCHAR是输出主变量，Pro * COBOL会自动设置长度字段。但是，要在PL / SQL块中使用VARCHAR输出主机变量，必须<span class="italic">在</span>进入块<span class="italic">之前</span>初始化长度字段。因此，将length字段设置为VARCHAR的声明（最大）长度，如以下示例所示： <a id="d38166e937" class="indexterm-anchor"></a><a id="d38166e941" class="indexterm-anchor"></a> 
                     </p><pre class="oac_no_warn" dir="ltr">EXEC SQL BEGIN DECLARE SECTION END-EXEC。 01 EMP-NUM PIC S9（4）COMP。 01 EMP-NAME PIC X（10）变化。 01 SALARY PIC S9（6）V99显示标志领先独立。 ...EXEC SQL END DECLARE SECTION END-EXEC。程序部门。 ...*  - 初始化长度字段MOVE 10 TO EMP-NAME-LEN。 EXEC SQL EXECUTE BEGIN SELECT ename，sal INTO：EMP-NAME，：SALARY FROM emp WHERE empno =：EMP-NUM; ...结束; END-EXEC。</pre></div>
               </div>
            </div><a id="LNPCB419"></a><div class="props_rev_3"><a id="GUID-1C3A5AAA-B45D-4CFE-A086-BFDCD942EB9F" name="GUID-1C3A5AAA-B45D-4CFE-A086-BFDCD942EB9F"></a><h3 id="LNPCB-GUID-1C3A5AAA-B45D-4CFE-A086-BFDCD942EB9F" class="sect3"><span class="enumeration_section">6.5</span>指标变量和PL / SQL</h3>
               <div>
                  <p>PL / SQL不需要指示符变量，因为它可以操作NULL。例如，在PL / SQL中，您可以使用IS NULL运算符来测试NULL，如下所示：<a id="d38166e972" class="indexterm-anchor"></a></p><pre class="oac_no_warn" dir="ltr">IF变量IS NULL那么......
</pre><p>您可以使用赋值运算符（：=）来分配NULL，如下所示：</p><pre class="oac_no_warn" dir="ltr">变量：= NULL;</pre><p>但是，宿主语言需要指示符变量，因为它们无法操作NULL。嵌入式PL / SQL通过允许您使用指示符变量来满足此需求：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>接受来自主程序的NULL输入</p>
                     </li>
                     <li>
                        <p>将NULL或截断值输出到宿主程序</p>
                     </li>
                  </ul>
                  <p>在PL / SQL块中使用时，指示符变量遵循以下规则：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>如果引用带有指示符变量的主变量，则必须始终在同一块中以相同的方式引用它。</p>
                     </li>
                  </ul>
                  <p>在下面的示例中，指示符变量<span class="italic">IND-COMM</span>在SELECT语句中显示其主机变量<span class="italic">COMMISSION</span> ，因此它必须以这种方式出现在IF语句中：</p><pre class="oac_no_warn" dir="ltr">EXEC SQL EXECUTE BEGIN SELECT ename，comm INTO：EMP-NAME，：COMMISSION：IND-COMM FROM emp WHERE empno =：EMP-NUM;如果：委托：IND-COMM是空的那么.........结束; END-EXEC。</pre><p>请注意，PL / SQL对待<span class="italic">：COMMISSION：IND-COMM</span>与任何其他简单变量一样。虽然您不能直接引用PL / SQL块中的指示符变量，但PL / SQL在进入块时会检查指示符变量的值，并在退出块时正确设置值。
                  </p>
               </div><a id="LNPCB420"></a><div class="props_rev_3"><a id="GUID-188BFFC2-65EE-4787-A817-094DC0B2F24B" name="GUID-188BFFC2-65EE-4787-A817-094DC0B2F24B"></a><h4 id="LNPCB-GUID-188BFFC2-65EE-4787-A817-094DC0B2F24B" class="sect4"><span class="enumeration_section">6.5.1</span>处理NULL</h4>
                  <div>
                     <p>输入块时，如果指示符变量的值为-1，则PL / SQL会自动为主变量分配NULL。退出块时，如果主变量为NULL，PL / SQL会自动为指示符变量赋值-1。在下一个示例中，如果在输入PL / SQL块之前<span class="italic">IND-SAL</span>的值为-1，则引发<span class="italic">salary_missing</span>异常。一个<span class="italic">例外</span>是命名错误条件。<a id="d38166e1045" class="indexterm-anchor"></a><a id="d38166e1047" class="indexterm-anchor"></a></p><pre class="oac_no_warn" dir="ltr">EXEC SQL EXECUTE BEGIN IF：SALARY：IND-SAL为NULL，然后提高salary_missing;万一; ...结束; END-EXEC。</pre></div>
               </div><a id="LNPCB421"></a><div class="props_rev_3"><a id="GUID-DB2A26EF-30A1-4BBE-ACB0-BBC540657042" name="GUID-DB2A26EF-30A1-4BBE-ACB0-BBC540657042"></a><h4 id="LNPCB-GUID-DB2A26EF-30A1-4BBE-ACB0-BBC540657042" class="sect4"><span class="enumeration_section">6.5.2</span>处理截断值</h4>
                  <div>
                     <p>将截断的字符串值分配给主机变量时，PL / SQL不会引发异常。但是，如果使用指示符变量，PL / SQL会将其设置为字符串的原始长度。以下示例主机程序将通过检查<span class="italic">IND-NAME</span>的值来判断是否为<span class="italic">EMP-NAME</span>分配了截断值：<a id="d38166e1083" class="indexterm-anchor"></a></p><pre class="oac_no_warn" dir="ltr">EXEC SQL EXECUTE DECLARE ...new_name CHAR（10）;开始 ...：EMP_NAME：IND-NAME：= new_name; ...结束; END-EXEC。</pre></div>
               </div>
            </div><a id="LNPCB423"></a><a id="LNPCB422"></a><div class="props_rev_3"><a id="GUID-F737A34F-47BC-4E36-A264-C26165B3EE19" name="GUID-F737A34F-47BC-4E36-A264-C26165B3EE19"></a><h3 id="LNPCB-GUID-F737A34F-47BC-4E36-A264-C26165B3EE19" class="sect3"><span class="enumeration_section">6.6</span>主机表和PL / SQL</h3>
               <div>
                  <p>您可以将输入主机表和指示符表传递给PL / SQL块。它们可以由BINARY_INTEGER或PLS_INTEGER类型的PL / SQL变量索引;不允许使用VARCHAR2键类型。通常，整个主机表都传递给PL / SQL，但您可以使用ARRAYLEN语句（稍后讨论）来指定较小的表维度。</p>
                  <p>此外，您可以使用子程序调用将主机表中的所有值分配给PL / SQL表中的行。假设表下标范围是<span class="italic">m</span> .. <span class="italic">n</span> ，则相应的PL / SQL表索引范围始终为1 .. <span class="italic">（n</span> - <span class="italic">m</span> + 1）。例如，如果表下标范围是5 .. 10，则相应的PL / SQL表索引范围是1 ..（10  -  5 + 1）或1 ..6。
                  </p>
                  <p><span class="bold">注意：</span> Pro * COBOL不会检查您对主机表的使用情况。例如，不进行索引范围检查。
                  </p>
                  <p>在以下示例中，将名为<span class="italic">salary</span>的主机表传递给PL / SQL块，该块在函数调用中使用主机表。该函数名为<span class="italic">median，</span>因为它在一系列数字中找到中间值。其形式参数包括名为<span class="italic">num_tab</span>的PL / SQL表。函数调用将实际参数<span class="italic">salary</span>中的所有值分配给formal参数<span class="italic">num_tab</span>中的行。
                  </p><pre class="oac_no_warn" dir="ltr">EXEC SQL BEGIN DECLARE SECTION END-EXEC。 ...01 SALARY COTS 100次PIC S9（6）V99 COMP-3。01 MEDIAN-SALARY PIC S9（6）V99 COMP-3。EXEC SQL END DECLARE SECTION END-EXEC。 *  - 填充主机表EXEC SQL EXECUTE DECLARE TYPE NumTabTyp IS TABLE OF REAL INDEX BY BINARY_INTEGER; n BINARY_INTEGER; ...功能中位数（num_tab NumTabTyp，n INTEGER）返回实数是开始*  - 计算中位数END;开始n：= 100; ：MEDIAN-SALARY：=中位数（：SALARY END; END-EXEC。</pre><p>您还可以使用子程序调用将PL / SQL表中的所有行值分配给主机表中的相应元素。有关示例，请参阅<span class="q">“ <a href="embedded-PLSQL.html#GUID-0CE314F6-4867-44C3-B14F-9580BDB621FC">存储的PL / SQL和Java子程序</a> ”</span> 。
                  </p>
                  <p>Host Tables和PL / SQL之间的接口严格控制数据类型。PIC X的默认外部类型是CHARF（固定长度字符串），这只能映射到CHAR类型的PL / SQL表。</p>
                  <p><a href="embedded-PLSQL.html#GUID-F737A34F-47BC-4E36-A264-C26165B3EE19__BEIDDGEA" title="q">表6-1</a>显示了PL / SQL表中的行值与主机表中的元素之间的合法转换。最值得注意的事实是，您不能将PIC X变量传递给VARCHAR2类型的表，而不使用数据类型等效变量到VARCHAR2，或者在命令行上使用PICX = VARCHAR2。
                  </p>
                  <div class="tblformalwide" id="GUID-F737A34F-47BC-4E36-A264-C26165B3EE19__BEIDDGEA">
                     <p class="titleintable">表6-1法定数据类型转换</p>
                     <table cellpadding="4" cellspacing="0" class="FormalWide" title="法律数据类型转换" width="100%" border="1" summary="q" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="15%" id="d38166e1182">PL / SQL表</th>
                              <th align="left" valign="bottom" width="8%" id="d38166e1185">-</th>
                              <th align="left" valign="bottom" width="9%" id="d38166e1188">-</th>
                              <th align="left" valign="bottom" width="11%" id="d38166e1191">-</th>
                              <th align="left" valign="bottom" width="13%" id="d38166e1194">-</th>
                              <th align="left" valign="bottom" width="12%" id="d38166e1197">-</th>
                              <th align="left" valign="bottom" width="8%" id="d38166e1200">-</th>
                              <th align="left" valign="bottom" width="11%" id="d38166e1203">-</th>
                              <th align="left" valign="bottom" width="13%" id="d38166e1206">-</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="15%" id="d38166e1211" headers="d38166e1182 ">
                                 <p>主持人表</p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d38166e1211 d38166e1185 ">
                                 <p>CHAR</p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d38166e1211 d38166e1188 ">
                                 <p>日期</p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d38166e1211 d38166e1191 ">
                                 <p>长</p>
                              </td>
                              <td align="left" valign="top" width="13%" headers="d38166e1211 d38166e1194 ">
                                 <p>LONG RAW</p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d38166e1211 d38166e1197 ">
                                 <p>数</p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d38166e1211 d38166e1200 ">
                                 <p>生的</p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d38166e1211 d38166e1203 ">
                                 <p>ROWID</p>
                              </td>
                              <td align="left" valign="top" width="13%" headers="d38166e1211 d38166e1206 ">
                                 <p>VARCHAR2</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="15%" id="d38166e1239" headers="d38166e1182 ">
                                 <p>CHARF</p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d38166e1239 d38166e1185 ">
                                 <p>X</p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d38166e1239 d38166e1188 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d38166e1239 d38166e1191 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="13%" headers="d38166e1239 d38166e1194 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d38166e1239 d38166e1197 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d38166e1239 d38166e1200 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d38166e1239 d38166e1203 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="13%" headers="d38166e1239 d38166e1206 ">
                                 <p>-</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="15%" id="d38166e1267" headers="d38166e1182 ">
                                 <p>CHARZ</p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d38166e1267 d38166e1185 ">
                                 <p>X</p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d38166e1267 d38166e1188 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d38166e1267 d38166e1191 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="13%" headers="d38166e1267 d38166e1194 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d38166e1267 d38166e1197 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d38166e1267 d38166e1200 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d38166e1267 d38166e1203 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="13%" headers="d38166e1267 d38166e1206 ">
                                 <p>-</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="15%" id="d38166e1295" headers="d38166e1182 ">
                                 <p>日期</p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d38166e1295 d38166e1185 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d38166e1295 d38166e1188 ">
                                 <p>X</p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d38166e1295 d38166e1191 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="13%" headers="d38166e1295 d38166e1194 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d38166e1295 d38166e1197 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d38166e1295 d38166e1200 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d38166e1295 d38166e1203 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="13%" headers="d38166e1295 d38166e1206 ">
                                 <p>-</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="15%" id="d38166e1323" headers="d38166e1182 ">
                                 <p>DECIMAL</p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d38166e1323 d38166e1185 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d38166e1323 d38166e1188 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d38166e1323 d38166e1191 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="13%" headers="d38166e1323 d38166e1194 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d38166e1323 d38166e1197 ">
                                 <p>X</p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d38166e1323 d38166e1200 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d38166e1323 d38166e1203 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="13%" headers="d38166e1323 d38166e1206 ">
                                 <p>-</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="15%" id="d38166e1351" headers="d38166e1182 ">
                                 <p>显示</p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d38166e1351 d38166e1185 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d38166e1351 d38166e1188 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d38166e1351 d38166e1191 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="13%" headers="d38166e1351 d38166e1194 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d38166e1351 d38166e1197 ">
                                 <p>X</p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d38166e1351 d38166e1200 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d38166e1351 d38166e1203 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="13%" headers="d38166e1351 d38166e1206 ">
                                 <p>-</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="15%" id="d38166e1379" headers="d38166e1182 ">
                                 <p>浮动</p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d38166e1379 d38166e1185 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d38166e1379 d38166e1188 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d38166e1379 d38166e1191 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="13%" headers="d38166e1379 d38166e1194 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d38166e1379 d38166e1197 ">
                                 <p>X</p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d38166e1379 d38166e1200 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d38166e1379 d38166e1203 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="13%" headers="d38166e1379 d38166e1206 ">
                                 <p>-</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="15%" id="d38166e1407" headers="d38166e1182 ">
                                 <p>整数</p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d38166e1407 d38166e1185 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d38166e1407 d38166e1188 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d38166e1407 d38166e1191 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="13%" headers="d38166e1407 d38166e1194 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d38166e1407 d38166e1197 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d38166e1407 d38166e1200 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d38166e1407 d38166e1203 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="13%" headers="d38166e1407 d38166e1206 ">
                                 <p>-</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="15%" id="d38166e1435" headers="d38166e1182 ">
                                 <p>长</p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d38166e1435 d38166e1185 ">
                                 <p>X</p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d38166e1435 d38166e1188 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d38166e1435 d38166e1191 ">
                                 <p>X</p>
                              </td>
                              <td align="left" valign="top" width="13%" headers="d38166e1435 d38166e1194 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d38166e1435 d38166e1197 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d38166e1435 d38166e1200 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d38166e1435 d38166e1203 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="13%" headers="d38166e1435 d38166e1206 ">
                                 <p>-</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="15%" id="d38166e1463" headers="d38166e1182 ">
                                 <p>LONG VARCHAR</p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d38166e1463 d38166e1185 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d38166e1463 d38166e1188 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d38166e1463 d38166e1191 ">
                                 <p>X</p>
                              </td>
                              <td align="left" valign="top" width="13%" headers="d38166e1463 d38166e1194 ">
                                 <p>X</p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d38166e1463 d38166e1197 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d38166e1463 d38166e1200 ">
                                 <p>X</p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d38166e1463 d38166e1203 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="13%" headers="d38166e1463 d38166e1206 ">
                                 <p>X</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="15%" id="d38166e1491" headers="d38166e1182 ">
                                 <p>LONG VARRAW</p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d38166e1491 d38166e1185 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d38166e1491 d38166e1188 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d38166e1491 d38166e1191 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="13%" headers="d38166e1491 d38166e1194 ">
                                 <p>X</p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d38166e1491 d38166e1197 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d38166e1491 d38166e1200 ">
                                 <p>X</p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d38166e1491 d38166e1203 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="13%" headers="d38166e1491 d38166e1206 ">
                                 <p>-</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="15%" id="d38166e1520" headers="d38166e1182 ">
                                 <p>数</p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d38166e1520 d38166e1185 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d38166e1520 d38166e1188 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d38166e1520 d38166e1191 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="13%" headers="d38166e1520 d38166e1194 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d38166e1520 d38166e1197 ">
                                 <p>X</p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d38166e1520 d38166e1200 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d38166e1520 d38166e1203 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="13%" headers="d38166e1520 d38166e1206 ">
                                 <p>-</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="15%" id="d38166e1547" headers="d38166e1182 ">
                                 <p>生的</p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d38166e1547 d38166e1185 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d38166e1547 d38166e1188 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d38166e1547 d38166e1191 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="13%" headers="d38166e1547 d38166e1194 ">
                                 <p>X</p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d38166e1547 d38166e1197 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d38166e1547 d38166e1200 ">
                                 <p>X</p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d38166e1547 d38166e1203 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="13%" headers="d38166e1547 d38166e1206 ">
                                 <p>-</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="15%" id="d38166e1575" headers="d38166e1182 ">
                                 <p>ROWID</p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d38166e1575 d38166e1185 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d38166e1575 d38166e1188 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d38166e1575 d38166e1191 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="13%" headers="d38166e1575 d38166e1194 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d38166e1575 d38166e1197 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d38166e1575 d38166e1200 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d38166e1575 d38166e1203 ">
                                 <p>X</p>
                              </td>
                              <td align="left" valign="top" width="13%" headers="d38166e1575 d38166e1206 ">
                                 <p>-</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="15%" id="d38166e1603" headers="d38166e1182 ">
                                 <p>串</p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d38166e1603 d38166e1185 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d38166e1603 d38166e1188 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d38166e1603 d38166e1191 ">
                                 <p>X</p>
                              </td>
                              <td align="left" valign="top" width="13%" headers="d38166e1603 d38166e1194 ">
                                 <p>X</p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d38166e1603 d38166e1197 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d38166e1603 d38166e1200 ">
                                 <p>X</p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d38166e1603 d38166e1203 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="13%" headers="d38166e1603 d38166e1206 ">
                                 <p>X</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="15%" id="d38166e1631" headers="d38166e1182 ">
                                 <p>UNSIGNED</p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d38166e1631 d38166e1185 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d38166e1631 d38166e1188 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d38166e1631 d38166e1191 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="13%" headers="d38166e1631 d38166e1194 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d38166e1631 d38166e1197 ">
                                 <p>X</p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d38166e1631 d38166e1200 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d38166e1631 d38166e1203 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="13%" headers="d38166e1631 d38166e1206 ">
                                 <p>-</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="15%" id="d38166e1659" headers="d38166e1182 ">
                                 <p>VARCHAR</p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d38166e1659 d38166e1185 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d38166e1659 d38166e1188 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d38166e1659 d38166e1191 ">
                                 <p>X</p>
                              </td>
                              <td align="left" valign="top" width="13%" headers="d38166e1659 d38166e1194 ">
                                 <p>X</p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d38166e1659 d38166e1197 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d38166e1659 d38166e1200 ">
                                 <p>X</p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d38166e1659 d38166e1203 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="13%" headers="d38166e1659 d38166e1206 ">
                                 <p>X</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="15%" id="d38166e1687" headers="d38166e1182 ">
                                 <p>VARCHAR2</p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d38166e1687 d38166e1185 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d38166e1687 d38166e1188 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d38166e1687 d38166e1191 ">
                                 <p>X</p>
                              </td>
                              <td align="left" valign="top" width="13%" headers="d38166e1687 d38166e1194 ">
                                 <p>X</p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d38166e1687 d38166e1197 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d38166e1687 d38166e1200 ">
                                 <p>X</p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d38166e1687 d38166e1203 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="13%" headers="d38166e1687 d38166e1206 ">
                                 <p>X</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="15%" id="d38166e1715" headers="d38166e1182 ">
                                 <p>VARNUM</p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d38166e1715 d38166e1185 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d38166e1715 d38166e1188 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d38166e1715 d38166e1191 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="13%" headers="d38166e1715 d38166e1194 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d38166e1715 d38166e1197 ">
                                 <p>X</p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d38166e1715 d38166e1200 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d38166e1715 d38166e1203 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="13%" headers="d38166e1715 d38166e1206 ">
                                 <p>-</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="15%" id="d38166e1743" headers="d38166e1182 ">
                                 <p>VARRAW</p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d38166e1743 d38166e1185 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d38166e1743 d38166e1188 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d38166e1743 d38166e1191 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="13%" headers="d38166e1743 d38166e1194 ">
                                 <p>X</p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d38166e1743 d38166e1197 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="8%" headers="d38166e1743 d38166e1200 ">
                                 <p>X</p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d38166e1743 d38166e1203 ">
                                 <p>-</p>
                              </td>
                              <td align="left" valign="top" width="13%" headers="d38166e1743 d38166e1206 ">
                                 <p>-</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
               </div><a id="LNPCB424"></a><div class="props_rev_3"><a id="GUID-FD098D13-2067-40A8-99E6-F99DDC475CFE" name="GUID-FD098D13-2067-40A8-99E6-F99DDC475CFE"></a><h4 id="LNPCB-GUID-FD098D13-2067-40A8-99E6-F99DDC475CFE" class="sect4"><span class="enumeration_section">6.6.1</span> ARRAYLEN声明</h4>
                  <div>
                     <p>假设您必须将输入主机表传递给PL / SQL块进行处理。默认情况下，绑定此类主机表时，Pro * COBOL使用其声明的维度。但是，您可能不希望处理整个表。在这种情况下，您可以使用ARRAYLEN语句指定较小的表维度。ARRAYLEN将主机表与主变量相关联，主变量存储较小的维度。语句语法是： <a id="d38166e1794" class="indexterm-anchor"></a> 
                     </p><pre class="oac_no_warn" dir="ltr">EXEC SQL ARRAYLEN host_array（dimension）EXECUTE END-EXEC。</pre><p>其中<span class="italic">dimension</span>是一个4字节的整数主变量， <span class="italic">而不是</span>文字或表达式。
                     </p>
                     <p>ARRAYLEN语句必须出现在<span class="italic">host_array</span>和<span class="italic">dimension</span>声明之后的某处。您无法在主机表中指定偏移量。但是，您可以将COBOL功能用于此目的。
                     </p>
                     <p>以下示例使用ARRAYLEN覆盖名为<span class="italic">BONUS</span>的主机表的默认维度：</p><pre class="oac_no_warn" dir="ltr">EXEC SQL BEGIN DECLARE SECTION END-EXEC。 01奖励发生100次PIC S9（6）V99显示标志领先分离。 01 MY-DIM PIC S9（9）COMP。 ...EXEC SQL ARRAYLEN BONUS（MY-DIM）END-EXEC。 EXEC SQL END DECLARE SECTION END-EXEC。 *  - 填充主机表...*  - 设置较小的表尺寸MOVE 25 TO MY-DIM。 EXEC SQL EXECUTE DECLARE TYPE NumTabTyp是BINARY_INTEGER的实际索引表; median_bonus REAL;功能中位数（num_tab NumTabTyp，n INTEGER）返回实数是开始*  - 计算中位数END; BEGIN median_bonus：=中位数（：BONUS，：MY-DIM）; ...结束; END-EXEC。</pre><p>只有25个表元素传递给PL / SQL块，因为ARRAYLEN将主机表从100个元素减少到25个元素。因此，当PL / SQL块被发送到服务器执行时，会发送一个小得多的主机表。这节省了时间，并且在网络环境中减少了网络流量。</p>
                  </div><a id="LNPCB425"></a><div class="props_rev_3"><a id="GUID-695A2355-3097-44EB-AAE9-69E7097575D1" name="GUID-695A2355-3097-44EB-AAE9-69E7097575D1"></a><h5 id="LNPCB-GUID-695A2355-3097-44EB-AAE9-69E7097575D1" class="sect5"><span class="enumeration_section">6.6.1.1</span>可选关键字EXECUTE到ARRAYLEN语句</h5>
                     <div>
                        <p>在动态SQL方法2语句中使用的主机表（请参阅<span class="q">“ <a href="Oracle-dynamic-SQL.html#GUID-0C0E313A-0142-4B10-8A29-BF59AFEE52D3">使用方法2</a> ”</span> ）可能有两种不同的解释，基于是否存在关键字来执行ARRAYLEN语句。 。
                        </p>
                        <p>如果缺少EXECUTE关键字：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>PL / SQL块将被执行多次，实际数量由使用的ARRAYLEN的最小尺寸确定。</p>
                           </li>
                           <li>
                              <p>主机阵列不能绑定到PL / SQL表。</p>
                           </li>
                        </ul>
                        <p>如果存在EXECUTE：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>主机表必须绑定到索引表。</p>
                           </li>
                           <li>
                              <p>PL / SQL块将执行一次。</p>
                           </li>
                           <li>
                              <p>EXEC SQL EXECUTE语句中指定的所有主机变量必须：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>在ARRAYLEN中指定......EXECUTE语句，或</p>
                                 </li>
                                 <li>
                                    <p>是一个标量。</p>
                                 </li>
                              </ul>
                           </li>
                        </ul>
                        <p>以下Pro * COBOL示例演示了如何使用主机表来确定执行给定PL / SQL块的次数。在这种情况下，PL / SQL块将执行3次，导致<span class="italic">emp</span>表中有3个新行。
                        </p><pre class="oac_no_warn" dir="ltr">...01 DYNSTMT PIC X（80）变化。 01 EMPNOTAB PIC S9（4）计算时间5次。 01 ENAMETAB PIC X（10）发生3次。 ...移动1111到EMPNOTAB（1）。移动2222到EMPNOTAB（2）。移动3333到EMPNOTAB（3）。移动4444到EMPNOTAB（4）。移动5555到EMPNOTAB（5）。将“MICKEY”移至ENAMETAB（1）。将“MINNIE”移至ENAMETAB（2）。将“GOOFY”移至ENAMETAB（3）。移动“BEGIN INSERT INTO emp（empno，ename）VALUES：b1，：b2; END;”到DYNSTMT-ARR。移动57到DYNSTMT-LEN。 EXEC SQL PREPARE s1 FROM：DYNSTMT END-EXEC。 EXEC SQL EXECUTE s1使用：EMPNOTAB，：ENAMETAB END-EXEC。 ...
  </pre><p>给定以下PL / SQL过程：</p><pre class="oac_no_warn" dir="ltr">创建或替换包装pkg AS TYPE选项卡是数字表（5）索引由BINARY_INTEGER; PROCEDURE proc1（parm1 tab，parm2 NUMBER，parm3 tab）;结束;</pre><p>以下Pro * COBOL示例演示了如何通过动态方法2将主机表绑定到PL / SQL索引表。注意ARRAYLEN的存在......EXECUTE语句，用于EXEC SQL EXECUTE语句中指定的所有主机数组。</p><pre class="oac_no_warn" dir="ltr">...01 DYNSTMT PIC X（80）变化。 01 II PIC S9（4）COMP值2。01 INTTAB PIC S9（9）COMP发生3次。 01 DIM PIC S9（9）COMP VALUE 3。EXEC SQL ARRAYLEN INTTAB（DIM）EXECUTE END-EXEC。 ...移动1到INTTAB（1）。移动2到INTTAB（2）。移动3到INTTAB（3）。移动“BEGIN pkg.proc1（：v1，：v2，：v3）;结束;”;到DYNSTMT-ARR。移动37到DYNSTMT-LEN。 EXEC SQL PREPARE s1 FROM：DYNSTMT END-EXEC。 EXEC SQL EXECUTE s1使用：INTTAB，：II，：INTTAB END-EXEC。 ...
  </pre><p>但是，以下Pro * COBOL示例将导致预编译时错误，因为没有ARRAYLEN ...INTTAB2的EXECUTE语句。</p><pre class="oac_no_warn" dir="ltr">...01 DYNSTMT PIC X（80）变化。 01 INTTAB PIC S9（9）COMP发生3次。 01 INTTAB2 PIC S9（9）COMP发生3次。 01 DIM PIC S9（9）COMP VALUE 3。EXEC SQL ARRAYLEN INTTAB（DIM）EXECUTE END-EXEC。 ...移动1到INTTAB（1）。移动2到INTTAB（2）。移动3到INTTAB（3）。移动“BEGIN pkg.proc1（：v1，：v2，：v3）;结束;”;到DYNSTMT-ARR。移动37到DYNSTMT-LEN。 EXEC SQL PREPARE s1 FROM：DYNSTMT END-EXEC。 EXEC SQL EXECUTE s1使用：INTTAB，：INTTAB2，：INTTAB END-EXEC。 ...</pre></div>
                  </div>
               </div>
            </div><a id="LNPCB427"></a><a id="LNPCB426"></a><div class="props_rev_3"><a id="GUID-FDFEDCF5-F2C0-4624-A303-6B54038371B1" name="GUID-FDFEDCF5-F2C0-4624-A303-6B54038371B1"></a><h3 id="LNPCB-GUID-FDFEDCF5-F2C0-4624-A303-6B54038371B1" class="sect3"><span class="enumeration_section">6.7</span>嵌入式PL / SQL中的游标用法</h3>
               <div>
                  <p>程序可以同时使用的最大游标数由数据库初始化参数OPEN_CURSORS决定。通常，为防止超出OPEN_CURSORS，预编译器允许管理语句游标。使用预编译器选项HOLD_CURSOR，RELEASE_CURSOR和MAXOPENCURSORS。在执行嵌入式PL / SQL块时，将有一个游标（父游标）与整个PL / SQL块相关联，并且在执行PL / SQL块期间执行的每个语句都有一个单独的子游标。由于PL / SQL块被传递到服务器以供执行，因此预编译器运行时库只能跟踪父光标。因此，以这种方式使用大量游标的应用程序可能超过OPEN_CURSORS。 <a href="embedded-PLSQL.html#GUID-FDFEDCF5-F2C0-4624-A303-6B54038371B1__I24512">图6-1</a>显示了如何计算使用的最大游标数。
                  </p>
                  <div class="figure" id="GUID-FDFEDCF5-F2C0-4624-A303-6B54038371B1__I24512">
                     <p class="titleinfigure">图6-1使用中的最大光标</p><img src="img/pco81054.gif" alt="下面是图6-1的描述" title="下面是图6-1的描述" longdesc="img_text/pco81054.html"><br><a href="img_text/pco81054.html">“图6-1使用中的最大光标”的说明</a></div>
                  <!-- class="figure" -->
                  <p>开发人员应该了解这种情况，并在OPEN_CURSORS和MAXOPENCURSORS的设置中对此进行规划。</p>
                  <p>如果出现此问题，您可能希望在执行SQL语句后释放所有子游标。</p>
                  <p>这可以通过设置RELEASE_CURSOR = YES和HOLD_CURSOR = NO来实现。由于使用整个程序的第一个设置可能会对性能产生影响，因此您可以按如下方式设置这些选项：</p><pre class="oac_no_warn" dir="ltr">EXEC ORACLE选项（RELEASE_CURSOR = YES）END-EXEC。 *  - 第一个嵌入式PL / SQL块EXEC ORACLE OPTION（RELEASE_CURSOR = NO）END-EXEC。 *  - 嵌入式SQL语句EXEC ORACLE OPTION（RELEASE_CURSOR = YES）END-EXEC。 *  - 第二个嵌入式PL / SQL块EXEC ORACLE OPTION（RELEASE_CURSOR = NO）END-EXEC。 *  - 嵌入式SQL语句</pre></div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="performance-tuning.html#GUID-96CB266B-EDFD-458B-B43F-B278D6BCE866">嵌入式PL / SQL注意事项</a></li>
                     </ul>
                  </div>
               </div>
            </div><a id="LNPCB428"></a><div class="props_rev_3"><a id="GUID-0CE314F6-4867-44C3-B14F-9580BDB621FC" name="GUID-0CE314F6-4867-44C3-B14F-9580BDB621FC"></a><h3 id="LNPCB-GUID-0CE314F6-4867-44C3-B14F-9580BDB621FC" class="sect3"><span class="enumeration_section">6.8</span>存储的PL / SQL和Java子程序</h3>
               <div>
                  <p>与匿名块，PL / SQL子程序（过程和函数）和<a id="d38166e1974" class="indexterm-anchor"></a><a id="d38166e1978" class="indexterm-anchor"></a> Java方法可以单独编译，存储在数据库中，也可以调用。
                  </p>
                  <p>使用Oracle工具（如SQL * Plus）显式创建的子程序称为<span class="italic">存储</span>子程序。一旦编译并存储在数据字典中，它就是一个数据库对象，可以重新执行而无需重新编译。<a id="d38166e1988" class="indexterm-anchor"></a><a id="d38166e1990" class="indexterm-anchor"></a></p>
                  <p>当PL / SQL块或存储的子程序中的子程序被应用程序发送到数据库时，它被称为<span class="bold">内联</span>子程序，由数据库编译。Pro * COBOL将语句发送到服务器以供执行。 <a id="d38166e1997" class="indexterm-anchor"></a> 
                  </p>
                  <p>程序包中定义的子程序被视为程序包的一部分，因此称为<span class="bold">打包的</span>子程序。未在包中定义的存储子程序称为<span class="bold">独立</span>子程序。 <a id="d38166e2008" class="indexterm-anchor"></a> 
                  </p>
               </div><a id="LNPCB429"></a><div class="props_rev_3"><a id="GUID-C54B632A-9A73-4ED5-B982-09608A149306" name="GUID-C54B632A-9A73-4ED5-B982-09608A149306"></a><h4 id="LNPCB-GUID-C54B632A-9A73-4ED5-B982-09608A149306" class="sect4"><span class="enumeration_section">6.8.1</span>创建存储的子程序</h4>
                  <div>
                     <p>您可以在COBOL程序中嵌入SQL语句CREATE FUNCTION，CREATE PROCEDURE和CREATE PACKAGE，如以下示例所示： <a id="d38166e2037" class="indexterm-anchor"></a><a id="d38166e2041" class="indexterm-anchor"></a> 
                     </p><pre class="oac_no_warn" dir="ltr">EXEC SQL CREATE FUNCTION sal_ok（salary REAL，title CHAR）RETURN BOOLEAN as min_sal REAL; max_sal REAL; BEGIN SELECT losal，hisal INTO min_sal，max_sal FROM sals WHERE job = title;返回（工资&gt; = min_sal）AND（工资&lt;= max_sal）;结束sal_ok; END-EXEC。</pre><p>请注意嵌入的CREATE {FUNCTION |程序| PACKAGE}语句是混合语句。与所有其他嵌入式CREATE语句一样，它以关键字EXEC SQL（不是EXEC SQL EXECUTE）开头。</p>
                     <p>如果是嵌入式CREATE {FUNCTION |程序| PACKAGE}语句失败，Oracle生成警告，而不是错误。</p>
                     <div class="infoboxnotealso" id="GUID-C54B632A-9A73-4ED5-B982-09608A149306__GUID-2BB13F5D-35A6-42E1-871A-F94023896999">
                        <p class="notep1">也可以看看：</p><a href="../sqlrf/index.html" target="_blank"><span class="italic">Oracle数据库SQL语言参考。</span></a>获取CREATE语句的完整语法。
                     </div>
                  </div>
               </div><a id="LNPCB430"></a><div class="props_rev_3"><a id="GUID-4C1FD863-5957-4C22-9D68-9F01F436702E" name="GUID-4C1FD863-5957-4C22-9D68-9F01F436702E"></a><h4 id="LNPCB-GUID-4C1FD863-5957-4C22-9D68-9F01F436702E" class="sect4"><span class="enumeration_section">6.8.2</span>调用存储的PL / SQL或Java子程序</h4>
                  <div>
                     <p>要从主程序调用存储的子程序，可以使用匿名PL / SQL块或CALL嵌入式SQL语句。</p>
                  </div><a id="LNPCB431"></a><div class="props_rev_3"><a id="GUID-C6673F11-CD6F-46D7-AA61-DFA8B566FD0D" name="GUID-C6673F11-CD6F-46D7-AA61-DFA8B566FD0D"></a><h5 id="LNPCB-GUID-C6673F11-CD6F-46D7-AA61-DFA8B566FD0D" class="sect5"><span class="enumeration_section">6.8.2.1</span>匿名PL / SQL块</h5>
                     <div>
                        <p>以下示例调用名为<span class="italic">raise_salary</span>的独立过程： <a id="d38166e2107" class="indexterm-anchor"></a> 
                        </p><pre class="oac_no_warn" dir="ltr">EXEC SQL EXECUTE BEGIN raise_salary（：emp_id，：increase）;结束; END-EXEC。</pre><p>请注意，存储的子程序可以采用参数。在此示例中，实际参数<span class="italic">emp_id</span>和<span class="italic">increase</span>是主变量。
                        </p>
                        <p>在下一个示例中，过程<span class="italic">raise_salary</span>存储在名为<span class="italic">emp_actions</span>的包中，因此必须使用点表示法来完全限定过程调用：</p><pre class="oac_no_warn" dir="ltr">EXEC SQL EXECUTE BEGIN emp_actions.raise_salary（：emp_id，：increase）;结束; END-EXEC。</pre><p>实际的IN参数可以是文字，主机变量，主机表，PL / SQL常量或变量，PL / SQL表，PL / SQL用户定义的记录，子程序调用或表达式。但是，实际的OUT参数不能是文字，子程序调用或表达式。</p>
                        <p>必须将预编译器选项SQLCHECK = SEMANTICS与嵌入式PL / SQL块一起使用。</p>
                     </div>
                  </div><a id="LNPCB432"></a><div class="props_rev_3"><a id="GUID-263CF6A4-7092-44C2-BC8B-ED72FDCD631B" name="GUID-263CF6A4-7092-44C2-BC8B-ED72FDCD631B"></a><h5 id="LNPCB-GUID-263CF6A4-7092-44C2-BC8B-ED72FDCD631B" class="sect5"><span class="enumeration_section">6.8.2.2</span> CALL声明</h5>
                     <div>
                        <p>前面介绍的嵌入式PL / SQL块的概念适用于CALL语句。CALL嵌入式SQL语句具有以下形式：</p><pre class="oac_no_warn" dir="ltr">EXEC SQL CALL [schema。] [package。] stored_proc [@db_link]（arg1，...）[INTO：ret_var [[INDICATOR]：ret_ind]] END-EXEC。</pre><p>哪里：</p><pre class="oac_no_warn" dir="ltr">模式</pre><p>包含该过程的模式</p><pre class="oac_no_warn" dir="ltr">包</pre><p>包含程序的包</p><pre class="oac_no_warn" dir="ltr">stored_proc</pre><p>是要调用的Java或PL / SQL存储过程</p><pre class="oac_no_warn" dir="ltr">db_link</pre><p>是可选的远程数据库链接</p><pre class="oac_no_warn" dir="ltr">ARG1 ...</pre><p>是传递的参数（变量，文字或表达式）的列表，</p><pre class="oac_no_warn" dir="ltr">ret_var</pre><p>是接收结果的可选主变量</p><pre class="oac_no_warn" dir="ltr">ind_var</pre><p>ret_var的可选指示符变量。</p>
                        <p>您可以使用SQLCHECK = SYNTAX或SQLCHECK = SEMANTICS与CALL语句。</p>
                     </div>
                  </div><a id="LNPCB433"></a><div class="props_rev_3"><a id="GUID-71FBBD2E-17F7-47A3-B787-7E91247281C1" name="GUID-71FBBD2E-17F7-47A3-B787-7E91247281C1"></a><h5 id="LNPCB-GUID-71FBBD2E-17F7-47A3-B787-7E91247281C1" class="sect5"><span class="enumeration_section">6.8.2.3</span> CALL示例</h5>
                     <div>
                        <p>如果您已经创建了一个PL / SQL函数<code class="codeph">fact</code> （保存在包装<code class="codeph">mathpkg</code> ），其采用整数作为输入和一个整数返回其阶乘：</p><pre class="oac_no_warn" dir="ltr">EXEC SQL CREATE或REPLACE PACKAGE BODY mathpkg as function fact（n IN INTEGER）RETURN INTEGER as BEGIN IF（n &lt;= 0）然后返回1; ELSE返回n * fact（n  -  1）;万一;结论;结束mathpkge; END-EXEC。</pre><p>然后在Pro * COBOL应用程序中使用<code class="codeph">fact</code> ：</p>
                        <p>...</p><pre class="oac_no_warn" dir="ltr">01 N PIC S9（4）COMP。 01 FACT PIC S9（9）COMP。 ...EXEC SQL CALL mathpkge.fact（：N）INTO：FACT END-EXEC。 ...
</pre><div class="infoboxnotealso" id="GUID-71FBBD2E-17F7-47A3-B787-7E91247281C1__GUID-1CB0C3CE-443F-4407-A296-6E5AD2FEB676">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><span class="q">“ <a href="embedded-SQL-statements-and-precompiler-directives.html#GUID-C5814720-95DF-45AB-89D0-9A355D03F040">CALL（可执行嵌入式SQL）</a> ”</span>以获取有关CALL语句的更多信息。
                                 </p>
                              </li>
                              <li>
                                 <p><a href="../adfns/external-procedures.html#ADFNS-GUID-230B2B41-2A6F-4756-AEC0-DBC99DCA8A37" target="_blank">使用多种编程语言开发应用程序</a> ，以完整解释传递参数和其他问题。
                                 </p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div>
               </div><a id="LNPCB434"></a><div class="props_rev_3"><a id="GUID-B8F64E19-0350-4AF9-B8A5-C85C7897DF32" name="GUID-B8F64E19-0350-4AF9-B8A5-C85C7897DF32"></a><h4 id="LNPCB-GUID-B8F64E19-0350-4AF9-B8A5-C85C7897DF32" class="sect4"><span class="enumeration_section">6.8.3</span>使用动态PL / SQL</h4>
                  <div>
                     <p>回想一下，Pro * COBOL将整个PL / SQL块视为单个SQL语句。因此，您可以将PL / SQL块存储在字符串主变量中。然后，如果块不包含主机变量，则可以使用动态SQL方法1来执行PL / SQL字符串。或者，如果块包含已知数量的主机变量，则可以使用动态SQL方法2来准备和执行PL / SQL字符串。如果块包含未知数量的主机变量，则必须使用动态SQL方法4。<a id="d38166e2291" class="indexterm-anchor"></a></p>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="Oracle-dynamic-SQL.html#GUID-C325218F-3DFF-4551-A5EB-483ADB24E324">Oracle动态SQL</a></li>
                           <li><a href="ANSI-dynamic-SQL.html#GUID-D6E9ACBE-EFF4-42F6-A855-B510004F4164">ANSI动态SQL</a></li>
                           <li><a href="Oracle-dynamic-SQL-method-4.html#GUID-C6256169-5928-466C-B7C7-960D20705EED">Oracle动态SQL：方法4</a></li>
                        </ul>
                     </div>
                  </div>
               </div><a id="LNPCB435"></a><div class="props_rev_3"><a id="GUID-90FCE22F-0F78-426F-B638-6EE5735BD8EF" name="GUID-90FCE22F-0F78-426F-B638-6EE5735BD8EF"></a><h4 id="LNPCB-GUID-90FCE22F-0F78-426F-B638-6EE5735BD8EF" class="sect4"><span class="enumeration_section">6.8.4</span>子程序限制</h4>
                  <div>
                     <p>在动态SQL方法4中，主机表不能绑定到具有TABLE类型参数的PL / SQL过程。</p>
                  </div>
               </div>
            </div><a id="LNPCB436"></a><div class="props_rev_3"><a id="GUID-8516DBAD-41AE-4A03-8331-6DEF3A2DE831" name="GUID-8516DBAD-41AE-4A03-8331-6DEF3A2DE831"></a><h3 id="LNPCB-GUID-8516DBAD-41AE-4A03-8331-6DEF3A2DE831" class="sect3"><span class="enumeration_section">6.9</span>示例程序9：调用存储过程</h3>
               <div>
                  <div class="section">
                     <p>在尝试示例程序之前，必须通过运行以下脚本来创建名为<span class="italic">calldemo</span>的PL / SQL包，该脚本名为CALLDEMO.SQL，它随Pro * COBOL提供。该脚本可以在Pro * COBOL演示库中找到。检查系统特定的Oracle文档，以获取脚本名称的准确拼写。<a id="d38166e2371" class="indexterm-anchor"></a><a id="d38166e2375" class="indexterm-anchor"></a></p><pre class="oac_no_warn" dir="ltr">创建或替换包装calldemo AS TYPE name_array IS表格emp.ename％type INDEX BY BINARY_INTEGER; TYPE job_array IS TABLE of emp.job％type INDEX BY BINARY_INTEGER; TYPE sal_array IS TABLE of emp.sal％type INDEX BY BINARY_INTEGER;程序get_employees（dept_number IN号， - 部门查询batch_size IN INTEGER， - 行一次找到IN OUT INTEGER， - 行实际返回done_fetch OUT INTEGER， - 所有已完成标志emp_name OUT name_array，job OUT job_array，sal OUT sal_array）; END calldemo; / CREATE OR REPLACE PACKAGE BODY calldemo AS CURSOR get_emp（dept_number IN number）IS SELECT ename，job，sal FROM emp WHERE deptno = dept_number; - 过程“get_employees”获取一批雇员 - 行（批处理大小由过程的客户端/调用者确定）。它可以从其他存储过程或客户端应用程序中调用。- 如果光标不是 - 已打开，则会打开光标，提取一批行，然后 - 返回实际检索的行数。在获取结束时，该过程将关闭游标。程序get_employees（dept_number IN号，batch_size IN INTEGER，找到IN OUT INTEGER，done_fetch OUT INTEGER，emp_name OUT name_array，job OUT job_array，sal OUT sal_array）IS BEGIN如果不是get_emp％ISOPEN那么 - 如果OPEN get_emp（dept_number）打开游标）; - 尚未开放END IF; - 将“batch_size”行提取到PL / SQL表中 - 计算检索到的行。当所有行都被提取时，关闭光标并退出 - 循环，只返回找到的最后一组行。done_fetch：= 0; - 设置完成标志FALSE：= 0; FOR i IN 1..batch_size LOOP FETCH get_emp INTO emp_name（i），job（i），sal（i）;如果get_emp％NOTFOUND那么 - 如果没有找到行CLOSE get_emp; done_fetch：= 1; - 表示所有已完成退出; ELSE发现：=找到+ 1; - 计数行END IF;结束循环;结束;结束; /</pre><p>以下示例程序连接到数据库，提示用户输入部门编号，然后调用名为<span class="italic">get_employees</span>的PL / SQL过程，该过程存储在包<span class="italic">calldemo中</span> 。该过程将三个PL / SQL表声明为OUT形式参数，然后将一批员工数据提取到PL / SQL表中。匹配的实际参数是主机表。该过程完成后，PL / SQL表中的行值将自动分配给主机表中的相应元素。程序重复调用该过程，显示每批员工数据，直到找不到更多数据。
                     </p><pre class="oac_no_warn" dir="ltr">************************************************** *************** *示例程序9：调用存储过程* *此程序连接到ORACLE，提示用户输入*部门编号，然后调用名为的PL / SQL存储过程* GET_EMPLOYEES，存储在CALLDEMO包中。*过程声明了三个PL / SQL表和OUT OUT formal *参数，然后将一批员工数据提取到* PL / SQL表中。匹配的实际参数是主机表。*当过程完成时，它会自动将PL / SQL表中的所有row *值分配给* host表中的相应元素。程序重复调用该过程，*显示每批员工数据，直到找不到更多数据*。*在预编译此示例程序时使用选项picx = varchar2。************************************************** ***************识别部门。 PROGRAM-ID。 CALL存储-PROC。环境部门。数据部门。工作储存部分。 EXEC SQL BEGIN DECLARE SECTION END-EXEC。 01 USERNAME PIC X（15）变化。 01 PASSWD PIC X（15）变化。 01 DEPT-NUM PIC S9（9）COMP。 01 EMP-TABLES。 05 EMP-NAME发生10次PIC X（10）。05职业生涯10次PIC X（10）。05年薪水发生10次COMP-2。01 DONE-FLAG PIC S9（9）COMP。 01表格大小PIC S9（9）COMP值10。01 NUM-RET PIC S9（9）COMP。 01 SQLCODE PIC S9（9）COMP。 EXEC SQL END DECLARE SECTION END-EXEC。 01计数器PIC S9（9）COMP。 01 DISPLAY-VARIABLES。 05 D-EMP-NAME PIC X（10）。05 D-JOB-TITLE PIC X（10）。05 D-SALARY PIC Z（5）9。05 D-DEPT-NUM PIC 9（2）。EXEC SQL包含SQLCA END-EXEC。程序部门。 BEGIN-PGM。执行SQL WHENEVER SQLERROR执行SQL-ERROR END-EXEC。表演登录。表现形式从1比1到1比10不等。执行GET-DEPT-NUM。执行显示 - 标题。移动零到完成标志。移动到NUM-RET。执行FETCH-BATCH直到DONE-FLAG = 1。执行LOGOFF。 INIT桌。将空间移动到EMP-NAME（COUNTER）。移动空间到工作标题（计数器）。移动零到SALARY（COUNTER）。GET-DEPT-NUM。移动零到DEPT-NUM。显示“”。显示“输入部门号码：”没有任何进展。接受D-DEPT-NUM。将D-DEPT-NUM移动到DEPT-NUM。 DISPLAY-标题。显示“”。显示“员工职业标题薪酬”。显示“-------- --------- ------”。FETCH批次。 EXEC SQL EXECUTE BEGIN CALLDEMO.GET_EMPLOYEES（：DEPT-NUM，：TABLE-SIZE，：NUM-RET，：DONE-FLAG，：EMP-NAME，：JOB-TITLE，：SALARY）;结束; END-EXEC。执行打印行改变计数器从1比1直到计数器&gt; NUM-RET。 PRINT-行。将EMP-NAME（COUNTER）移动到D-EMP-NAME。将JOB-TITLE（COUNTER）转移到D-JOB-TITLE。将薪水（计数器）转移到D-SALARY。显示D-EMP-NAME，“”，D-JOB-TITLE，“”，D-SALARY。登录。将“SCOTT”移至USERNAME-ARR。移动5到USERNAME-LEN。将“TIGER”转移到PASSWD-ARR。移动5到PASSWD-LEN。 EXEC SQL CONNECT：USERNAME IDENTIFIED BY：PASSWD END-EXEC。显示“”。显示“连接到ORACLE作为用户：”，USERNAME-ARR。注销。显示“”。显示“有一个好日子。”显示“”。EXEC SQL COMMIT WORK RELEASE END-EXEC。停止运行。 SQL-ERROR。执行SQL WHENEVER SQLERROR CONTINUE END-EXEC。显示“”。显示“ORACLE ERROR DETECTED：”。显示“”。显示SQLERRMC。 EXEC SQL ROLLBACK工作发布END-EXEC。停止运行。</pre><p>请记住，每个实际参数的数据类型必须可以转换为其相应形式参数的数据类型。此外，在存储的子程序退出之前，必须为所有OUT形式参数赋值。否则，相应的实际参数的值是不确定的。</p>
                  </div>
                  <!-- class="section" -->
               </div><a id="LNPCB437"></a><div class="props_rev_3"><a id="GUID-0F3CFCF3-D63F-4148-85F8-AE5E2625FEF5" name="GUID-0F3CFCF3-D63F-4148-85F8-AE5E2625FEF5"></a><h4 id="LNPCB-GUID-0F3CFCF3-D63F-4148-85F8-AE5E2625FEF5" class="sect4"><span class="enumeration_section">6.9.1</span>远程访问</h4>
                  <div>
                     <p>PL / SQL允许您通过<span class="italic">数据库链接</span>访问远程数据库。通常，数据库链接由DBA建立并存储在数据字典中。数据库链接告诉您的程序远程数据库的位置，路径，以及要使用的用户名和密码。以下示例使用数据库链接<span class="italic">dallas</span>来调用<span class="italic">raise_salary</span>过程：</p><pre class="oac_no_warn" dir="ltr">EXEC SQL EXECUTE BEGIN raise_salary @dallas（：emp_id，：increase）;结束; END-EXEC。</pre><p>您可以创建同义词以提供远程子程序的位置透明度，如以下示例所示：</p><pre class="oac_no_warn" dir="ltr">CREATE PUBLIC SYNONYM raise_salary FOR raise_salary @dallas;</pre><p></p>
                  </div>
               </div>
            </div><a id="LNPCB438"></a><div class="props_rev_3"><a id="GUID-78B25FD8-15B5-4253-BC9C-5C7C907DE354" name="GUID-78B25FD8-15B5-4253-BC9C-5C7C907DE354"></a><h3 id="LNPCB-GUID-78B25FD8-15B5-4253-BC9C-5C7C907DE354" class="sect3"><span class="enumeration_section">6.10</span>光标变量</h3>
               <div>
                  <p>您可以在Pro * COBOL程序中使用<span class="italic">游标变量</span>来使用静态嵌入式SQL处理多行查询。游标变量使用PL / SQL标识在数据库服务器上定义和打开的<span class="italic">游标引用</span> 。<a id="d38166e2463" class="indexterm-anchor"></a><a id="d38166e2465" class="indexterm-anchor"></a></p>
                  <p>与游标一样，游标变量指向多行查询的活动集中的当前行。游标与常量与变量的不同之处不同于游标变量。当游标是静态的时，游标变量是动态的，因为它不依赖于特定的查询。您可以为任何类型兼容的查询打开游标变量。<a id="d38166e2471" class="indexterm-anchor"></a></p>
                  <p>您可以为游标变量分配新值，并将其作为参数传递给子程序，包括存储在数据库中的子程序。这为您提供了一种集中数据检索的便捷方式。</p>
                  <p>首先，声明游标变量。声明变量后，使用这些语句来控制游标变量：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>分配</p>
                     </li>
                     <li>
                        <p>打开......对于</p>
                     </li>
                     <li>
                        <p>取</p>
                     </li>
                     <li>
                        <p>关</p>
                     </li>
                     <li>
                        <p>自由</p>
                     </li>
                  </ul>
                  <p>声明游标变量并为其分配内存后，必须将其作为输入主机变量（绑定变量）传递给PL / SQL，打开它以便在服务器端进行多行查询，在客户端进行FETCH查询然后在两边关闭它。</p>
                  <p>游标变量的优点是</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>易于维护。查询在打开游标变量的存储过程中集中。如果需要更改光标，只需在一个位置进行更改：存储过程。无需更改每个应用程序。</p>
                     </li>
                     <li>
                        <p>提高安全性。应用程序的用户（Pro * COBOL应用程序连接到数据库时的用户名）必须对打开游标的存储过程具有执行权限。但是，此用户不需要对查询中使用的表具有读取权限。此功能可用于限制对表中列的访问。</p>
                     </li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-78B25FD8-15B5-4253-BC9C-5C7C907DE354__GUID-E0794108-9D32-4570-9765-3295CB1A28DD">
                     <p class="notep1">也可以看看：</p><a href="../lnpls/static-sql.html#LNPLS-GUID-4A6E054A-4002-418D-A1CA-DE849CD7E6D5" target="_blank">有关游标变量</a>的完整信息的游标变量。
                  </div>
               </div><a id="LNPCB439"></a><div class="props_rev_3"><a id="GUID-A5C78F81-DF3A-4028-A931-3DE556BF0195" name="GUID-A5C78F81-DF3A-4028-A931-3DE556BF0195"></a><h4 id="LNPCB-GUID-A5C78F81-DF3A-4028-A931-3DE556BF0195" class="sect4"><span class="enumeration_section">6.10.1</span>声明游标变量</h4>
                  <div>
                     <div class="section">
                        <p>使用SQL-CURSOR伪型声明Pro * COBOL游标变量。例如：<a id="d38166e2534" class="indexterm-anchor"></a><a id="d38166e2538" class="indexterm-anchor"></a></p><pre class="oac_no_warn" dir="ltr">工作储存部分。 ...EXEC SQL BEGIN DECLARE SECTION END-EXEC。 ...01 CUR-VAR SQL-CURSOR。 ...EXEC SQL END DECLARE SECTION END-EXEC。</pre><p>SQL-CURSOR变量在Pro * COBOL生成的代码中实现为COBOL组项。游标变量就像任何其他Pro * COBOL主变量一样。<a id="d38166e2546" class="indexterm-anchor"></a><a id="d38166e2550" class="indexterm-anchor"></a></p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="LNPCB440"></a><div class="props_rev_3"><a id="GUID-6951AC37-66EA-423D-B536-CCB1646B0B62" name="GUID-6951AC37-66EA-423D-B536-CCB1646B0B62"></a><h4 id="LNPCB-GUID-6951AC37-66EA-423D-B536-CCB1646B0B62" class="sect4"><span class="enumeration_section">6.10.2</span>分配游标变量</h4>
                  <div>
                     <div class="section">
                        <p>在从游标变量进行OPEN或FETCH之前，必须使用Pro * COBOL ALLOCATE命令对其进行初始化。例如，要初始化上一节中声明的游标变量CUR-VAR，请编写以下语句：<span class="bold"></span></p><pre class="oac_no_warn" dir="ltr">EXEC SQL ALLOCATE：CUR-VAR END-EXEC。</pre><p>分配游标变量<span class="italic">并不</span>需要对服务器的呼叫，可以在预编译或运行时。
                        </p>
                        <p>AT子句不能在ALLOCATE语句中使用。</p>
                        <p><span class="bold">警告：</span>分配游标变量<span class="italic">确实</span>会导致使用堆内存。因此，请避免在程序循环中分配游标变量。<a id="d38166e2608" class="indexterm-anchor"></a><a id="d38166e2612" class="indexterm-anchor"></a></p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="LNPCB441"></a><div class="props_rev_3"><a id="GUID-FBAD94C3-302E-433C-B8AE-4D8377AA9CC6" name="GUID-FBAD94C3-302E-433C-B8AE-4D8377AA9CC6"></a><h4 id="LNPCB-GUID-FBAD94C3-302E-433C-B8AE-4D8377AA9CC6" class="sect4"><span class="enumeration_section">6.10.3</span>打开游标变量</h4>
                  <div>
                     <div class="section">
                        <p>必须使用嵌入式匿名PL / SQL块在数据库服务器上打开游标变量。匿名PL / SQL块可以通过调用打开游标的PL / SQL存储过程（并在同一语句中定义）或直接从Pro * COBOL程序间接打开游标。<a id="d38166e2642" class="indexterm-anchor"></a></p>
                     </div>
                     <!-- class="section" -->
                  </div><a id="LNPCB442"></a><div class="props_rev_3"><a id="GUID-5EF600D0-4E0A-4BDD-93E9-C3A270602D41" name="GUID-5EF600D0-4E0A-4BDD-93E9-C3A270602D41"></a><h5 id="LNPCB-GUID-5EF600D0-4E0A-4BDD-93E9-C3A270602D41" class="sect5"><span class="enumeration_section">6.10.3.1</span>通过存储的PL / SQL过程间接打开</h5>
                     <div>
                        <div class="section">
                           <p>考虑存储在数据库中的以下PL / SQL包：<a id="d38166e2669" class="indexterm-anchor"></a><a id="d38166e2675" class="indexterm-anchor"></a><a id="d38166e2681" class="indexterm-anchor"></a></p><pre class="oac_no_warn" dir="ltr">CREATE PACKAGE demo_cur_pkg AS TYPE EmpName IS RECORD（名称VARCHAR2（10））; TYPE cur_type IS REF CURSOR RETURN EmpName; PROCEDURE open_emp_cur（curs IN OUT curtype，dept_num IN number）;结束; CREATE PACKAGE BODY demo_cur_pkg AS CREATE PROCEDURE open_emp_cur（curs IN OUT curtype，dept_num IN number）IS BEGIN OPEN curs FOR SELECT ename FROM emp WHERE deptno = dept_num ORDER BY ename ASC;结束;结束;</pre><p>这个包已经被存储后，您可以首先从你的PRO * COBOL程序调用<span class="italic">open_emp_cur</span>存储过程，然后从发行程序中的游标变量emp_cursor一个FETCH打开游标<span class="italic">小人</span> 。例如： <span class="italic"> </span></p><pre class="oac_no_warn" dir="ltr">工作储存部分。 EXEC SQL BEGIN DECLARE SECTION END-EXEC。 01 emp_cursor sql-cursor。01 DEPT-NUM PIC S9（4）。01 EMP-NAME PIC X（10）变化。 EXEC SQL END DECLARE SECTION END-EXEC。 ...程序部门。 ...*分配游标变量。EXEC SQL ALLOCATE：emp-cursor END-EXEC。 ...移动30到dept_num。*打开Oracle Server上的光标。EXEC SQL EXECUTE开始demo_cur_pkg.open_emp_cur（：emp-cursor，：dept-num）;结束; END-EXEC。 EXEC SQL无法找到执行签名END-EXEC。 FETCH-LOOP。 EXEC SQL FETCH：emp_cursor INTO：EMP-NAME END-EXEC。显示“员工姓名：”，：EMP-NAME。去FETCH-LOOP。 ...登出。 ...</pre></div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="LNPCB443"></a><div class="props_rev_3"><a id="GUID-838E3DBA-11C4-4A53-8FAD-EE0A22698483" name="GUID-838E3DBA-11C4-4A53-8FAD-EE0A22698483"></a><h5 id="LNPCB-GUID-838E3DBA-11C4-4A53-8FAD-EE0A22698483" class="sect5"><span class="enumeration_section">6.10.3.2</span>直接从Pro * COBOL应用程序打开</h5>
                     <div>
                        <div class="section">
                           <p>要在Pro * COBOL程序中使用PL / SQL匿名块打开游标，请在匿名块中定义游标。请考虑以下示例：<a id="d38166e2724" class="indexterm-anchor"></a><a id="d38166e2730" class="indexterm-anchor"></a></p><pre class="oac_no_warn" dir="ltr">程序部门。 ...EXEC SQL EXECUTE开始OPEN：emp_cursor FOR SELECT ename FROM emp WHERE deptno =：DEPT-NUM;结束; END-EXEC。 ...</pre></div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div><a id="LNPCB444"></a><div class="props_rev_3"><a id="GUID-41D6F6FB-03BF-4A1F-BD9B-DBE5B7FB9E98" name="GUID-41D6F6FB-03BF-4A1F-BD9B-DBE5B7FB9E98"></a><h4 id="LNPCB-GUID-41D6F6FB-03BF-4A1F-BD9B-DBE5B7FB9E98" class="sect4"><span class="enumeration_section">6.10.4</span>从游标变量中获取</h4>
                  <div>
                     <div class="section">
                        <p>打开多行查询的游标变量后，可以像使用静态游标一样使用FETCH语句来检索行。语法如下：<a id="d38166e2763" class="indexterm-anchor"></a><a id="d38166e2767" class="indexterm-anchor"></a></p><pre class="oac_no_warn" dir="ltr">EXEC SQL FETCH cursor_variable_name INTO {record_name | variable_name [，variable_name，...]}END-EXEC。</pre><p>游标变量返回的每个列值都分配给INTO子句中的相应字段或变量，前提是它们的数据类型是兼容的。<a id="d38166e2775" class="indexterm-anchor"></a></p>
                        <p>必须在客户端执行FETCH语句。以下示例将行提取到名为<span class="italic">EMP-REC</span>的主机记录中：</p><pre class="oac_no_warn" dir="ltr">*  - 完成提取后退出循环执行EXEC SQL WHENEVER NOT FOUND DO NOTFORM NOT-MORE END-EXEC。 PERFORM *  - 将行读入记录EXEC SQL FETCH：EMP-CUR INTO：EMP-REC END-EXEC *  - 测试转出失循...*  - 处理数据......END-PERFORM。 ...不再。 ...
</pre><p>使用嵌入式SQL FETCH ....INTO命令用于检索打开游标变量时选择的行。例如：<a id="d38166e2786" class="indexterm-anchor"></a></p><pre class="oac_no_warn" dir="ltr">EXEC SQL FETCH：emp_cursor INTO：EMP-INFO：EMP-INFO-IND END-EXEC。</pre><p>在从游标变量进行FETCH之前，必须初始化并打开该变量。您无法从未打开的游标变量进行FETCH。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="LNPCB445"></a><div class="props_rev_3"><a id="GUID-2329DD40-53A6-40F4-A7E0-09DD8CC8134F" name="GUID-2329DD40-53A6-40F4-A7E0-09DD8CC8134F"></a><h4 id="LNPCB-GUID-2329DD40-53A6-40F4-A7E0-09DD8CC8134F" class="sect4"><span class="enumeration_section">6.10.5</span>关闭游标变量</h4>
                  <div>
                     <div class="section">
                        <p>使用嵌入式SQL CLOSE语句关闭游标变量。此时，其活动集变为未定义。语法如下：<a id="d38166e2819" class="indexterm-anchor"></a><a id="d38166e2823" class="indexterm-anchor"></a></p><pre class="oac_no_warn" dir="ltr">EXEC SQL CLOSE cursor_variable_name END-EXEC。</pre><p>CLOSE语句可以在客户端或服务器端执行。以下示例在处理最后一行时关闭游标变量<span class="italic">CUR-VAR</span> ：</p><pre class="oac_no_warn" dir="ltr">工作储存部分。 EXEC SQL BEGIN DECLARE SECTION END-EXEC。 *声明游标变量。01 CUR-VAR SQL-CURSOR。 ...EXEC SQL END DECLARE SECTION END-EXEC。程序部门。 *分配并打开游标变量，然后*获取一行或多行。...*关闭游标变量。EXEC SQL CLOSE：CUR-VAR END-EXEC。</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="LNPCB446"></a><div class="props_rev_3"><a id="GUID-0BAED95B-F1FF-4323-A9B9-4B2E20552194" name="GUID-0BAED95B-F1FF-4323-A9B9-4B2E20552194"></a><h4 id="LNPCB-GUID-0BAED95B-F1FF-4323-A9B9-4B2E20552194" class="sect4"><span class="enumeration_section">6.10.6</span>释放游标变量</h4>
                  <div>
                     <div class="section">
                        <p>要释放为游标变量<span class="italic">CUR-VAR</span>分配的内存<span class="italic">，请</span>在CLOSE之后使用FREE语句：</p><pre class="oac_no_warn" dir="ltr">*释放游标变量记忆。EXEC SQL FREE：CUR-VAR END-EXEC。</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="LNPCB447"></a><div class="props_rev_3"><a id="GUID-892A17BA-2AAE-4F3D-A2D4-CEE0D8EEFA22" name="GUID-892A17BA-2AAE-4F3D-A2D4-CEE0D8EEFA22"></a><h4 id="LNPCB-GUID-892A17BA-2AAE-4F3D-A2D4-CEE0D8EEFA22" class="sect4"><span class="enumeration_section">6.10.7</span>游标变量的限制</h4>
                  <div>
                     <div class="section">
                        <p>以下限制适用于游标变量的使用：<span class="bold"></span></p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>动态SQL不支持游标变量。</p>
                           </li>
                           <li>
                              <p>您只能将游标变量与ALLOCATE，FETCH，FREE和CLOSE命令一起使用。该declare cursor命令<span class="italic">并不</span>适用于游标变量。
                              </p>
                           </li>
                           <li>
                              <p>您不能将AT子句与ALLOCATE命令一起使用。</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="LNPCB448"></a><div class="props_rev_3"><a id="GUID-5D3A4E72-61A1-463F-918E-D1A015B7EEF7" name="GUID-5D3A4E72-61A1-463F-918E-D1A015B7EEF7"></a><h4 id="LNPCB-GUID-5D3A4E72-61A1-463F-918E-D1A015B7EEF7" class="sect4"><span class="enumeration_section">6.10.8</span>示例程序11：游标变量</h4>
                  <div>
                     <div class="section">
                        <p>以下示例程序 - 一个SQL脚本（SAMPLE11.sql）和一个Pro * COBOL程序（SAMPLE11.pco） - 演示了如何在Pro * COBOL中使用游标变量。<a id="d38166e2957" class="indexterm-anchor"></a><a id="d38166e2961" class="indexterm-anchor"></a></p>
                     </div>
                     <!-- class="section" -->
                  </div><a id="LNPCB449"></a><div class="props_rev_3"><a id="GUID-C1988AA8-26D7-48AB-B1F8-864BFFCBF503" name="GUID-C1988AA8-26D7-48AB-B1F8-864BFFCBF503"></a><h5 id="LNPCB-GUID-C1988AA8-26D7-48AB-B1F8-864BFFCBF503" class="sect5"><span class="enumeration_section">6.10.8.1</span> SAMPLE11。SQL</h5>
                     <div>
                        <div class="section">
                           <p>以下是用于创建声明并打开游标变量的包的PL / SQL源代码：<a id="d38166e2990" class="indexterm-anchor"></a></p><pre class="oac_no_warn" dir="ltr">CONNECT SCOTT / TIGER创建或替换包装emp_demo_pkg AS TYPE emp_cur_type IS REF CURSOR RETURN emp％ROWTYPE; PROCEDURE open_cur（光标IN OUT emp_cur_type，dept_num IN编号）; END emp_demo_pkg; / CREATE OR REPLACE PACKAGE BODY emp_demo_pkg AS PROCEDURE open_cur（游标IN OUT emp_cur_type，dept_num IN编号）IS BEGIN OPEN游标FOR SELECT * FROM emp WHERE deptno = dept_num ORDER BY ename ASC;结束; END emp_demo_pkg; /</pre></div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="LNPCB450"></a><div class="props_rev_3"><a id="GUID-B0D9357F-9FD3-4FC9-AD82-343751D3C485" name="GUID-B0D9357F-9FD3-4FC9-AD82-343751D3C485"></a><h5 id="LNPCB-GUID-B0D9357F-9FD3-4FC9-AD82-343751D3C485" class="sect5"><span class="enumeration_section">6.10.8.2</span> SAMPLE11。PCO</h5>
                     <div>
                        <div class="section">
                           <p>以下是Pro * COBOL示例程序SAMPLE11。PCO，它使用SAMPLE11.sql示例中声明的游标变量从EMP表中获取员工姓名，工资和佣金：</p><pre class="oac_no_warn" dir="ltr">************************************************** *************** *示例程序11：游标变量操作* * * *此程序登录到ORACLE，分配并打开游标* *变量获取名称，工资和佣金所有* *销售人员，显示结果，然后关闭光标。* ************************************************* ****************身份识别部门。 PROGRAM-ID。游标变量。环境部门。数据部门。工作储存部分。 EXEC SQL BEGIN DECLARE SECTION END-EXEC。 01 USERNAME PIC X（15）变化。 01 PASSWD PIC X（15）变化。 01主持人PIC X（15）变化。 01 EMP-CUR SQL-CURSOR。 01 EMP-INFO。 05 EMP-NUM PIC S9（4）COMP。 05 EMP-NAM PIC X（10）变化。 05 EMP-JOB PIC X（10）变化。 05 EMP-MGR PIC S9（4）COMP。 05 EMP-DAT PIC X（10）变化。 05 EMP-SAL PIC S9（6）V99显示标志领先独立。 05 EMP-COM PIC S9（6）V99显示标志领先分离。 05 EMP-DEP PIC S9（4）COMP。 01 EMP-INFO-IND。 05 EMP-NUM-IND PIC S9（4）COMP。 05 EMP-NAM-IND PIC S9（4）COMP。 05 EMP-JOB-IND PIC S9（4）COMP。 05 EMP-MGR-IND PIC S9（4）COMP。 05 EMP-DAT-IND PIC S9（4）COMP。 05 EMP-SAL-IND PIC S9（4）COMP。 05 EMP-COM-IND PIC S9（4）COMP。 05 EMP-DEP-IND PIC S9（4）COMP。 EXEC SQL END DECLARE SECTION END-EXEC。 EXEC SQL包含SQLCA END-EXEC。01 DISPLAY-VARIABLES。 05 D-DEP-NUM PIC Z（3）9。05 D-EMP-NAM PIC X（10）。05 D-EMP-SAL PIC Z（4）9.99。05 D-EMP-COM PIC Z（4）9.99。05 D-EMP-DEP PIC 9（2）。程序部门。 BEGIN-PGM。执行SQL WHENEVER SQLERROR执行SQL-ERROR END-EXEC。表演登录。 EXEC SQL ALLOCATE：EMP-CUR END-EXEC。显示“输入部门编号（0退出）：”没有进展。接受D-EMP-DEP。将D-EMP-DEP移至EMP-DEP。如果EMP-DEP &lt;= 0，则转到注销结束-IF。将EMP-DEP移至D-DEP-NUM。 EXEC SQL EXECUTE BEGIN emp_demo_pkg.open_cur（：EMP-CUR，：EMP-DEP）;结束; END-EXEC。显示“”。显示“对于部门”，D-DEP-NUM，“：”。显示“”。展示“员工薪酬委员会”。显示“---------- ---------- ----------”。FETCH-LOOP。 EXEC SQL WHENEVER未找到GOTO CLOSE-UP END-EXEC。向EMP-NAM-ARR移动空间。 EXEC SQL FETCH：EMP-CUR INTO：EMP-NUM：EMP-NUM-IND，：EMP-NAM：EMP-NAM-IND，：EMP-JOB：EMP-JOB-IND，：EMP-MGR：EMP-MGR- IND，：EMP-DAT：EMP-DAT-IND，：EMP-SAL：EMP-SAL-IND，：EMP-COM：EMP-COM-IND，：EMP-DEP：EMP-DEP-IND END-EXEC。将EMP-SAL转移到D-EMP-SAL。如果EMP-COM-IND = 0将EMP-COM移动到D-EMP-COM显示EMP-NAM-ARR，“”，D-EMP-SAL，“”，D-EMP-COM ELSE显示EMP-NAM-ARR， “”，D-EMP-SAL，“N / A”END-IF。去FETCH-LOOP。登录。将“SCOTT”移至USERNAME-ARR。移动5到USERNAME-LEN。将“TIGER”转移到PASSWD-ARR。移动5到PASSWD-LEN。将“INST1_ALIAS”移至主持人ARR。移动11到主持人。 EXEC SQL CONNECT：USERNAME IDENTIFIED BY：PASSWD END-EXEC。显示“”。显示“连接到ORACLE作为用户：”，USERNAME-ARR。特写。 EXEC SQL CLOSE：EMP-CUR END-EXEC。 EXEC SQL FREE：EMP-CUR END-EXEC。登出。显示“”。显示“有一个好日子。”显示“”。EXEC SQL COMMIT WORK RELEASE END-EXEC。停止运行。 SQL-ERROR。执行SQL WHENEVER SQLERROR CONTINUE END-EXEC。显示“”。显示“ORACLE ERROR DETECTED：”。显示“”。显示SQLERRMC。 EXEC SQL ROLLBACK工作发布END-EXEC。停止运行。</pre></div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>