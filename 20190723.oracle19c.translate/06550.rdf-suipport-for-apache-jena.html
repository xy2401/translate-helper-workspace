<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="RDF Semantic Graph support for Apache Jena (also referred to here as support for Apache Jena) provides a Java-based interface to Oracle Spatial and Graph RDF Semantic Graph by implementing the well-known Jena Graph, Model, and DatasetGraph APIs."></meta>
      <meta name="description" content="RDF Semantic Graph support for Apache Jena (also referred to here as support for Apache Jena) provides a Java-based interface to Oracle Spatial and Graph RDF Semantic Graph by implementing the well-known Jena Graph, Model, and DatasetGraph APIs."></meta>
      <title>Apache Jena的RDF语义图支持</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="RDF Knowledge Graph Developer&#39;s Guide "></meta>
      <meta property="og:description" content="RDF Semantic Graph support for Apache Jena (also referred to here as support for Apache Jena) provides a Java-based interface to Oracle Spatial and Graph RDF Semantic Graph by implementing the well-known Jena Graph, Model, and DatasetGraph APIs."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="RDF Knowledge Graph Developer&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="spatial-and-graph-rdf-knowledge-graph-developers-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-10T10:56:26-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2005, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E94798-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="fine-grained-access-control-rdf.html" title="Previous" type="text/html"></link>
      <link rel="next" href="user-defined-inferencing.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Spatial and Graph RDF Knowledge Graph Developer&#39;s Guide"></meta>
    <meta name="dcterms.isVersionOf" content="RDFRM"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="fine-grained-access-control-rdf.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="user-defined-inferencing.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">RDF知识图开发人员指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="part-concept-usage.html" property="item" typeof="WebPage"><span property="name">概念和使用信息</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Apache Jena的RDF语义图支持</li>
            </ol>
            <a id="GUID-3F437E3E-3B74-4CCF-9F16-B2B07B3899E8" name="GUID-3F437E3E-3B74-4CCF-9F16-B2B07B3899E8"></a><a id="RDFRM234"></a>
            
            <h2 id="RDFRM-GUID-3F437E3E-3B74-4CCF-9F16-B2B07B3899E8" class="sect2"><span class="enumeration_chapter">6</span> Apache Jena的RDF语义图支持</h2>
         </header>
         <div class="ind">
            <div>
               <p>Apache Jena的RDF语义图支持（这里也称为对Apache Jena的支持）通过实现着名的Jena Graph，Model和DatasetGraph API为Oracle Spatial和Graph RDF语义图提供了基于Java的接口。</p>
               <div class="infoboxnote" id="GUID-3F437E3E-3B74-4CCF-9F16-B2B07B3899E8__GUID-B557CA44-3766-4D22-BAB5-9F2AAD668F71">
                  <p class="notep1">注意：</p>
                  <p>此功能以前称为<span class="italic">适用于Oracle数据库</span>的<span class="italic">Jena适配器</span>和<span class="italic">Jena适配器</span> 。
                  </p>
               </div>
               <p>对Apache Jena的支持扩展了Oracle Database RDF / OWL的语义数据管理功能。</p>
               <p>（Apache Jena是一个开源框架。有关许可和版权条件，请<a href="http://www.apache.org/licenses/" target="_blank"><code class="codeph">http://www.apache.org/licenses/</code></a>和<a href="http://www.apache.org/licenses/LICENSE-2.0" target="_blank"><code class="codeph">http://www.apache.org/licenses/LICENSE-2.0</code></a> 。）</p>
               <p>DatasetGraph API用于管理命名图形数据，也称为<span class="bold">四边形</span> 。此外，Apache Jena的RDF语义图支持通过与Oracle Spatial and Graph网络数据模型图功能集成，在语义数据之上提供网络分析功能。
               </p>
               <p>本章假定您熟悉<a href="rdf-semantic-graph-overview.html#GUID-F422BB9F-8473-4980-9D6C-848F708C10E0" title="Oracle Spatial and Graph对语义技术的支持主要包括资源描述框架（RDF）和Web Ontology Language（OWL）的子集。这些功能称为Oracle Spatial and Graph的RDF知识图功能。">RDF语义图概述</a>和<a href="owl-concepts.html#GUID-3EC5F30E-9175-4B7B-946C-3117BC30610A" title="You should understand key concepts related to the support for a subset of the Web Ontology Language (OWL).">OWL概念中</a>解释的主要<a href="owl-concepts.html#GUID-3EC5F30E-9175-4B7B-946C-3117BC30610A" title="您应该了解与支持Web Ontology Language（OWL）子集相关的关键概念。">概念</a> 。它还假定您熟悉Jena Java框架的整体功能和使用。有关Jena框架的信息，请参阅<a href="http://jena.apache.org/" target="_blank"><code class="codeph">http://jena.apache.org/</code></a> ，尤其是Jena文档页面。如果使用网络分析功能，则还应熟悉网络数据模型图功能，该功能在<a href="../topol/network-data-model-graph-overview.html#TOPOL700" target="_blank"><span class="italic">Oracle空间和图形拓扑数据模型和网络数据模型图开发人员指南中有说明</span></a> 。
               </p>
               <div class="infoboxnote" id="GUID-3F437E3E-3B74-4CCF-9F16-B2B07B3899E8__GUID-4F882250-0987-48C0-BE7D-5B3BA0C3F1C4">
                  <p class="notep1">注意：</p>
                  <p>Apache Jena版本的当前RDF语义图支持已针对Apache Jena 2.11.1和Joseki 3.4.4进行了测试。由于开源项目的性质，您不应该将此支持用于更高版本的Jena或Joseki的Apache Jena。</p>
               </div>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-17E0C43D-2625-4D69-BBD7-1BCF204684EA">设置软件环境</a><br>要使用对Apache Jena的支持，必须首先确保系统环境具有必要的软件，包括Oracle Database <span class="italic">11g</span>第2版或更高版本，其中包含Spatial and Graph and Partitioning选项以及启用了RDF语义图支持的Apache Jena 2.11。 1，JDK 1.6或更高版本。
                  </li>
                  <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-BD74255C-3534-4019-979B-C43817B4C58D">设置SPARQL服务</a><br>本节介绍如何通过在WebLogic Server中部署<code class="codeph">joseki.war</code>文件来设置SPARQL Web服务端点。
                  </li>
                  <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-0C92F16E-897F-4BA5-9072-A3632A1A9847">设置动态SPARQL端点</a><br>您可以使用Apache Jena Joseki和Apache Jena Fuseki设置动态SPARQL Web服务端点。
                  </li>
                  <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-4ED474AE-8D92-4389-9106-87997729030A">为Joseki Servlet添加跨站点请求伪造（CSRF）保护</a><br>您可以向Joseki servlet添加跨站点请求伪造（CSRF）保护。
                  </li>
                  <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-74757671-5D3E-4813-B8ED-035834F05307">设置RDF语义图环境</a><br>要使用对Apache Jena的支持来执行查询，您可以以任何用户（具有适当的权限）进行连接，并使用语义网络中的任何模型。
                  </li>
                  <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-4FF1C4D8-B1CE-4E88-8E84-703EBBAC2222">Apache Jena查询的SEM_MATCH和RDF语义图支持比较</a><br>有两种方法可以查询存储在Oracle数据库中的语义数据：基于SEM_MATCH的SQL语句和SPARQL查询，通过对Apache Jena的支持。
                  </li>
                  <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-996A56E5-868C-4A78-8BF7-3B51921F1DCD">从SEM_MATCH或基于SQL的查询结果中检索用户友好的Java对象</a><br>您可以使用以下任何方法查询语义图。
                  </li>
                  <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-F6416355-45C1-4FAF-83E4-7EBFA902EA7A">优化处理SPARQL查询</a><br>本节介绍了可以增强SPARQL查询处理的Apache Jena支持的一些与性能相关的功能。默认情况下会自动执行这些功能。
                  </li>
                  <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-9B0B74F2-9733-491E-A97C-BB485D33518C">添加SPARQL语法以支持其他功能</a><br>Apache Jena的RDF语义图支持允许您传递提示和其他查询选项。它通过使用包含查询选项的特定于Oracle的命名空间重载SPARQL命名空间前缀语法来实现这些功能。
                  </li>
                  <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-D7D68CA5-24BF-4546-8679-8AF4AA96C38C">SPARQL查询中支持的函数通过RDF语义图支持Apache Jena</a><br>通过支持Apache Jena的SPARQL查询可以使用以下几种功能。
                  </li>
                  <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-C94D34A5-436A-4ED7-97D0-BE315755F7AE">SPARQL更新支持</a><br>Apache Jena的RDF语义图支持支持SPARQL更新（ <code class="codeph">http://www.w3.org/TR/sparql11-update/</code> ），也称为SPARUL。</li>
                  <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-828999B9-6B4D-4BA1-AC00-953D20212F24">RDF数据的分析函数</a><br>您可以使用<code class="codeph">oracle.spatial.rdf.client.jena</code>包中的<code class="codeph">SemNetworkAnalyst</code>类对RDF数据执行分析功能。
                  </li>
                  <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-CBBCF550-832C-402A-89D2-0CDA62D27F0C">支持服务器端API</a><br>本节描述了RDF语义图支持Apache Jena所展示的一些RDF语义图功能。
                  </li>
                  <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-1109AB37-AFD5-4172-B7E5-6F279782A22E">使用RDF语义图支持Apache Jena进行批量加载</a><br>要将数千到数十万个RDF / OWL数据文件加载到Oracle数据库中，可以使用<code class="codeph">OracleBulkUpdateHandler</code> Java类中的<code class="codeph">prepareBulk</code>和<code class="codeph">completeBulk</code>方法来简化任务。
                  </li>
                  <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-7EF14C6C-9D85-4BE8-8F51-732822CA178E">自动变量重命名</a><br>自动变量重命名可以启用以前无法成功运行的某些查询。
                  </li>
                  <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-5A76E641-BF3D-435C-969E-17A61E775806">JavaScript对象表示法（JSON）格式支持</a><br>SPARQL查询响应支持JavaScript Object Notation（JSON）格式。JSON数据格式简单，紧凑，非常适合JavaScript程序。
                  </li>
                  <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-78916DE5-15D7-4E6B-B8CA-23DF0D89423C">其他建议和指南</a><br>本节包含与SPARQL查询相关的各种建议和其他信息。
                  </li>
                  <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-9F748C0E-437D-4EBD-80CF-BFA91F3CFE3A">使用Apache Jena的RDF语义图支持的示例查询</a><br>本节包括使用Apache Jena支持的示例查询。每个示例都是自包含的：它通常创建模型，创建三元组，执行可能涉及推理的查询，显示结果并删除模型。
                  </li>
                  <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-649269C9-6EB8-489C-B139-073CB8BA768E">SPARQL网关和语义数据</a><br>SPARQL Gateway是一个J2EE Web应用程序，包含在Apache Jena的支持中。它旨在使语义数据（RDF / OWL / SKOS）易于用于运行关系数据和XML数据的应用程序，包括Oracle商业智能企业版（OBIEE）11 <span class="italic">g</span> 。
                  </li>
                  <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-2F00FBFD-B3F4-4E49-9476-25E5F364A9D7">在Apache Tomcat或JBoss中部署Joseki</a><br>如果您选择不在Oracle WebLogic Server中部署Joseki，则可以将其部署在Apache Tomcat或JBoss中。
                  </li>
               </ul>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>父主题：</strong> <a href="part-concept-usage.html#GUID-FC153F2D-D51D-4498-A6E1-30B80D540FD6">概念和使用信息</a></p>
                  </div>
               </div>
            </div>
            <a id="RDFRM235"></a><div class="props_rev_3"><a id="GUID-17E0C43D-2625-4D69-BBD7-1BCF204684EA" name="GUID-17E0C43D-2625-4D69-BBD7-1BCF204684EA"></a><h3 id="RDFRM-GUID-17E0C43D-2625-4D69-BBD7-1BCF204684EA" class="sect3"><span class="enumeration_section">6.1</span>设置软件环境</h3>
               <div>
                  <p>要使用对Apache Jena的支持，必须首先确保系统环境具有必要的软件，包括Oracle Database <span class="italic">11g</span>第2版或更高版本，其中包含Spatial and Graph and Partitioning选项以及启用了RDF语义图支持的Apache Jena 2.11。 1，JDK 1.6或更高版本。
                  </p>
                  <p>您可以通过执行以下操作来设置软件环境：</p>
                  <ol>
                     <li>
                        <p>使用Oracle Spatial and Graph和Partitioning Options安装Oracle数据库企业版。</p>
                     </li>
                     <li>
                        <p>如果尚未安装Oracle Database 11.2.0.3或更高版本，请安装适用于Oracle数据库服务器的11.2.0.2修补程序集（ <a href="https://updates.oracle.com/Orion/PatchDetails/process_form?patch_num=10098816" target="_blank"><code class="codeph">https://updates.oracle.com/Orion/PatchDetails/process_form?patch_num=10098816</code></a> ）。</p>
                     </li>
                     <li>
                        <p>启用对RDF语义图的支持，如<a href="enabling-downgrading-removing-rdf.html#GUID-8B3D00C9-E2B8-4074-BE88-055DD5E157BF" title="在当前Oracle数据库发行版中使用与RDF语义图支持相关的任何类型，同义词或PL / SQL包之前，必须在新的Oracle数据库安装中安装这些功能，或者从先前版本升级功能。您还必须确保安装了Spatial和Graph，并启用了Partitioning选项。">启用RDF语义图支持中所述</a> 。
                        </p>
                     </li>
                     <li>
                        <p>从<a href="http://support.oracle.com/" target="_blank"><code class="codeph">http://support.oracle.com/</code></a> My Oracle Support下载Apache Jena的RDF语义图支持。在知识库中搜索错误标识符17241927。
                        </p>
                        <p>可以从OTN <a href="http://www.oracle.com/technetwork/database-options/spatialandgraph/" target="_blank"><code class="codeph">http://www.oracle.com/technetwork/database-options/spatialandgraph/</code></a>下载对Apache Jena的RDF语义图支持的完整评估版本。单击“ <span class="bold">下载”</span>选项卡，然后在“许可软件”下单击“ <span class="bold">RDF语义图许可软件”</span> 。
                        </p>
                     </li>
                     <li>
                        <p>将工具包解压缩到临时目录中，例如（在Linux系统上） <code class="codeph">/tmp/jena_adapter</code> 。（如果此临时目录尚不存在，请在解压缩操作之前创建它。）
                        </p>
                        <p>Apache Jena的RDF语义图支持具有以下顶级目录：</p><pre class="oac_no_warn" dir="ltr">|  -  META-INF |  - 示例|  -  jar |  -  javadoc |  -  joseki |  -  joseki_web_app |  -  protege_plugin |  -  sparqlgateway |  -  sparqlgateway_web_app |  -  fuseki |  -  web</pre></li>
                     <li>
                        <p>如果尚未安装JDK 1.6或更高版本，请安装它。</p>
                     </li>
                     <li>
                        <p>如果JAVA_HOME环境变量尚未引用JDK 1.6或更高版本的安装，请相应地进行定义。例如：</p><pre class="oac_no_warn" dir="ltr">setenv JAVA_HOME / usr / local / packages / jdk16 /</pre></li>
                     <li>
                        <p>如果未设置支持SPARQL协议的SPARQL服务，请按照<a href="rdf-suipport-for-apache-jena.html#GUID-BD74255C-3534-4019-979B-C43817B4C58D" title="This section explains how to set up a SPARQL web service endpoint by deploying the joseki.war file in WebLogic Server.">设置SPARQL服务中的</a>说明进行<a href="rdf-suipport-for-apache-jena.html#GUID-BD74255C-3534-4019-979B-C43817B4C58D" title="本节介绍如何通过在WebLogic Server中部署joseki.war文件来设置SPARQL Web服务端点。">设置</a> 。
                        </p>
                     </li>
                  </ol>
                  <p>设置软件环境后，请确保您的RDF语义图环境可以使您支持Apache Jena执行查询，如<a href="rdf-suipport-for-apache-jena.html#GUID-74757671-5D3E-4813-B8ED-035834F05307" title="要使用对Apache Jena的支持来执行查询，您可以以任何用户（具有适当的权限）进行连接，并使用语义网络中的任何模型。">设置RDF语义图环境中所述</a> 。
                  </p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-BDD428CF-5B6F-4DD7-92B2-96C1B45C33AE">如果您使用以前版本的Apache Jena支持</a><br></li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-3F437E3E-3B74-4CCF-9F16-B2B07B3899E8" title="Apache Jena的RDF语义图支持（这里也称为对Apache Jena的支持）通过实现着名的Jena Graph，Model和DatasetGraph API为Oracle Spatial和Graph RDF语义图提供了基于Java的接口。">Apache Jena的RDF语义图支持</a></p>
                     </div>
                  </div>
               </div>
               <a id="RDFRM742"></a><div class="props_rev_3"><a id="GUID-BDD428CF-5B6F-4DD7-92B2-96C1B45C33AE" name="GUID-BDD428CF-5B6F-4DD7-92B2-96C1B45C33AE"></a><h4 id="RDFRM-GUID-BDD428CF-5B6F-4DD7-92B2-96C1B45C33AE" class="sect4"><span class="enumeration_section">6.1.1</span>如果您使用以前版本的Apache Jena支持</h4>
                  <div>
                     <p>如果您使用了以前版本的Apache Jena支持，请注意此版本的以下重要更改：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">com.hp.hpl.jena.sparql.core。DataSourceImpl</code>由<code class="codeph">com.hp.hpl.jena.sparql.core.替换<code class="codeph">com.hp.hpl.jena.sparql.core.DatasetImpl</code> 。
                           </p>
                           <p>如果你有<code class="codeph">import com.hp.hpl.jena.sparql.core.在Java源代码中使用DataSourceImpl</code> ，您需要更新它以<code class="codeph">import com.hp.hpl.jena.sparql.core.DatasetImpl</code> 。
                           </p>
                           <p>如果您的Java源代码中有<code class="codeph">DataSourceImpl.wrap</code> ，则需要将其更新为<code class="codeph">DatasetImpl.wrap"</code> 。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">joseki-config.ttl</code>在下方移动<code class="codeph">WEB-INF/classes</code>的目录<code class="codeph">joseki.war</code> 。此配置文件以前位于<code class="codeph">joseki.war</code>的顶级目录下。以下示例显示了新的展示位置：</p><pre class="oac_no_warn" dir="ltr">％/ usr / local / packages / jdk16 / bin / jar tf joseki.war application.xml index.html joseki-config-ttl_now_under_WEB-INF_classes META-INF / META-INF / MANIFEST.MF ojdbc6.jar StyleSheets / StyleSheets / joseki。 css update.html WEB-INF / WEB-INF / lib / WEB-INF / lib / sdordfclient.jar WEB-INF / lib / jena-arq-2.11.1.jar WEB-INF / lib / log4j-1.2.16。 jar WEB-INF / lib / jcl-over-slf4j-1.6.4.jar WEB-INF / lib / httpclient-4.2.3.jar WEB-INF / lib / commons-codec-1.6.jar WEB-INF / lib / slf4j-log4j12-1.6.4.jar WEB-INF / lib / servlet-api-2.5-20081211.jar WEB-INF / lib / xercesImpl-2.11.0.jar WEB-INF / lib / slf4j-api-1.6.4 .jar WEB-INF / lib / jena-tdb-1.0.1.jar WEB-INF / lib / jena-core-2.11.1.jar WEB-INF / lib / httpcore-4.2.2.jar WEB-INF / lib /joseki-3.4.4.oracle_build_jena211.jar WEB-INF / lib / jena-iri-1.0.1.jar WEB-INF / lib / sdordf.jar WEB-INF / lib / xml-apis-1.4.01.jar WEB -INF / web.xml WEB-INF / classes / <span class="bold">WEB-INF / classes / joseki-config.ttl</span> xml-to-html.xsl</pre></li>
                     </ul>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-17E0C43D-2625-4D69-BBD7-1BCF204684EA" title="要使用对Apache Jena的支持，必须首先确保系统环境具有必要的软件，包括Oracle Database 11g第2版或更高版本，其中包含空间和图形和分区选项以及启用了RDF语义图支持，Apache Jena 2.11.1 ，以及JDK 1.6或更高版本。">设置软件环境</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="RDFRM236"></a><div class="props_rev_3"><a id="GUID-BD74255C-3534-4019-979B-C43817B4C58D" name="GUID-BD74255C-3534-4019-979B-C43817B4C58D"></a><h3 id="RDFRM-GUID-BD74255C-3534-4019-979B-C43817B4C58D" class="sect3"><span class="enumeration_section">6.2</span>设置SPARQL服务</h3>
               <div>
                  <p>本节介绍如何通过在WebLogic Server中部署<code class="codeph">joseki.war</code>文件来设置SPARQL Web服务端点。
                  </p>
                  <div class="infoboxnote" id="GUID-BD74255C-3534-4019-979B-C43817B4C58D__GUID-609CD577-6663-4D5E-95F9-F088013E1CA7">
                     <p class="notep1">注意：</p>
                     <p>在从SPARQL服务到Oracle数据库的第一次连接之前，数据库用户必须具有CREATE PROCEDURE权限。例如，如果您的数据库用户是SCOTT，并且如果它没有此权限，请从特权帐户输入以下内容：</p><pre class="pre codeblock"><code>SQL&gt; GRANT CREATE PROCEDURE TO scott;</code></pre><p>第一次从SPARQL服务到Oracle数据库建立连接时，会在用户模式中自动创建一些PL / SQL帮助程序子程序，这需要用户具有CREATE PROCEDURE权限。</p>
                  </div>
                  <div class="infoboxnote" id="GUID-BD74255C-3534-4019-979B-C43817B4C58D__GUID-BEA4FFAD-DADB-4D4E-9E23-D54678BA86F7">
                     <p class="notep1">注意：</p>
                     <p>如果要在Apache Tomcat或JBoss而不是WebLogic Server中<a href="rdf-suipport-for-apache-jena.html#GUID-2F00FBFD-B3F4-4E49-9476-25E5F364A9D7" title="If you choose not to deploy Joseki in Oracle WebLogic Server , you can deploy it in Apache Tomcat or JBoss.">部署Joseki</a> ，请参阅<a href="rdf-suipport-for-apache-jena.html#GUID-2F00FBFD-B3F4-4E49-9476-25E5F364A9D7" title="如果您选择不在Oracle WebLogic Server中部署Joseki，则可以将其部署在Apache Tomcat或JBoss中。">在Apache Tomcat或JBoss中部署Joseki</a> 。
                     </p>
                  </div>
                  <ol>
                     <li>
                        <p>下载并安装Oracle WebLogic Server 11g或更高版本。</p>
                     </li>
                     <li>
                        <p>确保安装了Java 6或更高版本，因为它是Joseki 3.4.4所要求的。</p>
                     </li>
                     <li>
                        <p>使用WebLogic Server管理控制台，创建名为<span class="italic">OracleSemDS</span>的J2EE数据源。在数据源创建期间，您可以为数据库模式指定用户和密码，该模式包含要执行SPARQL查询的相关语义数据。
                        </p>
                        <p>如果在创建此数据源时需要帮助，请参阅<a href="rdf-suipport-for-apache-jena.html#GUID-CC0618F7-318D-4F21-A78D-29CF31FDDB7F">使用WebLogic Server创建所需的数据源</a> 。
                        </p>
                     </li>
                     <li>
                        <p>转到WebLogic Server的<code class="codeph">autodeploy</code>目录并复制文件，如下所示。（有关在开发域中自动部署应用程序的信息，请参阅： <a href="http://docs.oracle.com/cd/E24329_01/web.1211/e24443/autodeploy.htm" target="_blank"><code class="codeph">http://docs.oracle.com/cd/E24329_01/web.1211/e24443/autodeploy.htm</code></a> ： <a href="http://docs.oracle.com/cd/E24329_01/web.1211/e24443/autodeploy.htm" target="_blank"><code class="codeph">http://docs.oracle.com/cd/E24329_01/web.1211/e24443/autodeploy.htm</code></a> ）</p><pre class="oac_no_warn" dir="ltr">cd <span class="italic">&lt;domain_name&gt;</span> / autodeploy cp -rf /tmp/jena_adapter/joseki_web_app/joseki.war <span class="italic">&lt;domain_name&gt;</span> / autodeploy</pre><p>在前面的示例中， <span class="italic">&lt;domain_name&gt;</span>是WebLogic Server域的名称。
                        </p>
                        <p>请注意，虽然您可以在两种不同的模式（开发和生产）中运行WebLogic Server域，但只有开发模式允许您使用自动部署功能。</p>
                     </li>
                     <li>
                        <p>使用Web浏览器以下列格式连接到URL来验证部署（假设Web应用程序部署在端口7001）： <code class="codeph">http://</code> <span class="italic"><code class="codeph">&lt;hostname&gt;</code></span> <code class="codeph">:7001/joseki</code></p>
                        <p>您应该<span class="italic">使用Joseki</span>看到标题为<span class="italic">Oracle SPARQL Service Endpoint</span>的页面，第一个文本框应包含示例SPARQL查询。
                        </p>
                     </li>
                     <li>
                        <p>单击<span class="bold">提交查询</span> 。
                        </p>
                        <p>您应该看到一个标题为<span class="italic">Oracle SPARQL Endpoint Query Results</span>的页面。可能有也可能没有任何结果，具体取决于执行查询的基础语义模型。
                        </p>
                     </li>
                  </ol>
                  <p>默认情况下， <code class="codeph">joseki-config.ttl</code>文件包含使用名为<code class="codeph">M_NAMED_GRAPHS</code>的模型的<code class="codeph">oracle:Dataset</code>定义。以下代码段显示了配置。<code class="codeph">oracle:allGraphs</code>谓词表示SPARQL服务端点将使用存储在<code class="codeph">M_NAMED_GRAPHS</code>模型中的所有图形来提供查询。
                  </p><pre class="oac_no_warn" dir="ltr">&lt;#oracle&gt; rdf：type oracle：Dataset; joseki：poolSize 1; ##允许此数据集的并发连接数。oracle：connection [oracle：OracleConnection; ]。 oracle：allGraphs [oracle：firstModel“M_NAMED_GRAPHS”]。
</pre><p>在第一个SPARQL查询请求时，将自动创建<code class="codeph">M_NAMED_GRAPHS</code>模型（如果它尚不存在）。您可以添加一些示例三元组和四元组来测试命名图形函数;例如：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; CONNECT <span class="italic">用户名/密码</span> SQL&gt; INSERT INTO m_named_graphs_tpl VALUES（sdo_rdf_triple_s（'m_named_graphs'，'&lt;urn：s&gt;'，'&lt;urn：p&gt;'，'&lt;urn：o&gt;'））; SQL&gt; INSERT INTO m_named_graphs_tpl VALUES（sdo_rdf_triple_s（'m_named_graphs：&lt;urn：G1&gt;'，'&lt;urn：g1_s&gt;'，'&lt;urn：g1_p&gt;'，'&lt;urn：g1_o&gt;'））; SQL&gt; INSERT INTO m_named_graphs_tpl VALUES（sdo_rdf_triple_s（'m_named_graphs：&lt;urn：G2&gt;'，'&lt;urn：g2_s&gt;'，'&lt;urn：g2_p&gt;'，'&lt;urn：g2_o&gt;'））; SQL&gt; COMMIT;</pre><p>插入行后，转到<code class="codeph">http://</code> <span class="italic"><code class="codeph">&lt;hostname&gt;</code></span> <code class="codeph">:7001/joseki</code> ，键入以下SPARQL查询，然后单击<span class="bold">Submit Query</span> ：</p><pre class="oac_no_warn" dir="ltr">选择 ？G ？s？p？o {GRAPH？G { ？s？p？o}}</pre><p>结果应该是一个包含四列和两组结果绑定的HTML表。</p>
                  <p><code class="codeph">http://</code> <span class="italic"><code class="codeph">&lt;hostname&gt;</code></span> <code class="codeph">:7001/joseki</code>页面还包含<span class="bold">JSON输出</span>选项。如果选择（启用）此选项，则SPARQL查询响应将转换为JSON格式。
                  </p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-CC0618F7-318D-4F21-A78D-29CF31FDDB7F">使用WebLogic Server创建所需的数据源</a><br></li>
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-266D140C-5D26-49EA-B723-7ECE12293369">配置基于Joseki的SPARQL服务</a><br></li>
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-3EB5694D-7BCF-45A7-A7C1-0EC0044C38CD">配置基于Fuseki的SPARQL服务</a><br>本主题简要介绍如何配置和设置连接到Oracle数据库的基于Fuseki的SPARQL服务。
                     </li>
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-3B337ACC-28E7-45DF-A7BC-3D01A1337552">终止长时间运行的SPARQL查询</a><br></li>
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-E9E1A6CA-1753-4213-AF84-6B2B881529E4">非ASCII字符的N-Triples编码</a><br></li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-3F437E3E-3B74-4CCF-9F16-B2B07B3899E8" title="Apache Jena的RDF语义图支持（这里也称为对Apache Jena的支持）通过实现着名的Jena Graph，Model和DatasetGraph API为Oracle Spatial和Graph RDF语义图提供了基于Java的接口。">Apache Jena的RDF语义图支持</a></p>
                     </div>
                  </div>
               </div>
               <a id="RDFRM237"></a><div class="props_rev_3"><a id="GUID-CC0618F7-318D-4F21-A78D-29CF31FDDB7F" name="GUID-CC0618F7-318D-4F21-A78D-29CF31FDDB7F"></a><h4 id="RDFRM-GUID-CC0618F7-318D-4F21-A78D-29CF31FDDB7F" class="sect4"><span class="enumeration_section">6.2.1</span>使用WebLogic Server创建所需的数据源</h4>
                  <div>
                     <div class="section">
                        <p>如果需要使用WebLogic Server管理控制台创建所需J2EE数据源的帮助，可以按照以下步骤操作：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>登录到： <code class="codeph">http://</code> <span class="italic"><code class="codeph">&lt;hostname&gt;</code></span> <code class="codeph">:7001/console</code></span></li>
                        <li class="stepexpand"><span>在“域结构”面板中，单击“ <span class="bold">服务”</span> 。</span></li>
                        <li class="stepexpand"><span>单击<span class="bold">JDBC</span></span></li>
                        <li class="stepexpand"><span>单击“ <span class="bold">数据源”</span> 。</span></li>
                        <li class="stepexpand"><span>在“JDBC数据源摘要”面板中，单击<span class="bold">“</span>数据源”表下的“ <span class="bold">新建</span> ”。</span></li>
                        <li class="stepexpand"><span>在“创建新的JDBC数据源”面板中，输入或选择以下值。</span><div>
                              <p><span class="bold">名称</span> ： <code class="codeph">OracleSemDS</code></p>
                              <p><span class="bold">JNDI名称</span> ： <code class="codeph">OracleSemDS</code></p>
                              <p><span class="bold">数据库类型</span> ： <code class="codeph">Oracle</code></p>
                              <p><span class="bold">数据库驱动程序</span> ： <code class="codeph">Oracle's Driver (Thin) Versions: 9.0.1,9.2.0,10,11</code></p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>单击<span class="bold">下一步</span>两次。</span></li>
                        <li class="stepexpand"><span>在“连接属性”面板中，为“ <span class="bold">数据库名称”</span> ，“ <span class="bold">主机名”</span> ，“ <span class="bold">端口”</span> ，“ <span class="bold">数据库用户名”</span> （包含语义数据的架构），“ <span class="bold">密码”</span>字段输入相应的值。</span></li>
                        <li class="stepexpand"><span>单击<span class="bold">下一步</span> 。</span></li>
                        <li class="stepexpand"><span>选择（选中）要将此<code class="codeph">OracleSemDS</code>数据源部署到的目标服务器。</span></li>
                        <li class="stepexpand"><span>单击<span class="bold">完成</span> 。</span><div>
                              <p>您应该看到一条消息，表明所有更改都已激活，无需重新启动。</p>
                           </div>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-BD74255C-3534-4019-979B-C43817B4C58D" title="本节介绍如何通过在WebLogic Server中部署joseki.war文件来设置SPARQL Web服务端点。">设置SPARQL服务</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="RDFRM238"></a><div class="props_rev_3"><a id="GUID-266D140C-5D26-49EA-B723-7ECE12293369" name="GUID-266D140C-5D26-49EA-B723-7ECE12293369"></a><h4 id="RDFRM-GUID-266D140C-5D26-49EA-B723-7ECE12293369" class="sect4"><span class="enumeration_section">6.2.2</span>配置基于Joseki的SPARQL服务</h4>
                  <div>
                     <p>默认情况下，SPARQL服务端点假定将针对具有预设名称的语义模型执行查询。此语义模型由J2EE数据源中指定的模式拥有，其默认JNDI名称为<span class="italic">OracleSemDS</span> 。请注意，您不需要使用PL / SQL或Java显式创建此模型;如果网络中不存在该模型，则会自动创建该模型以及必要的应用程序表和索引。
                     </p>
                     <div class="infoboxnote" id="GUID-266D140C-5D26-49EA-B723-7ECE12293369__GUID-9B4BE5A2-DAFA-4DAC-8332-862185B12A82">
                        <p class="notep1">注意：</p>
                        <p>在2011年11月支持Apache Jena版本时，应用程序表索引（ <span class="italic">&lt;</span> model_name <span class="italic">&gt;</span> _idx）定义已更改为适应命名图形数据（四边形）。
                        </p>
                        <p>对于由旧版本的Apache Jena支持创建的现有模型，您可以使用<code class="codeph">oracle.spatial.rdf.client.jena</code>的<code class="codeph">static OracleUtils.migrateApplicationTableIndex(oracle, graph, dop)</code>方法迁移应用程序表索引名称和定义<code class="codeph">oracle.spatial.rdf.client.jena</code>包。（有关更多信息，请参阅Javadoc。）请注意，新索引定义<span class="italic">对于</span>针对应用程序表的DML操作的性能<span class="italic">至关重要</span> 。
                        </p>
                     </div>
                     <p>要更改默认JNDI名称或使用默认语义模型，可以通过编辑<code class="codeph">joseki-config.ttl</code>配置文件来配置SPARQL服务，该文件嵌入在预构建应用程序<code class="codeph">joseki_web_app/joseki.war</code>的<code class="codeph">WEB-INF/classes</code>目录<code class="codeph">joseki_web_app/joseki.war</code> 。（如果您使用了以前版本的Apache Jena支持，请注意， <code class="codeph">joseki-config.ttl</code>现在位于<code class="codeph">WEB-INF/classes</code>目录下，而不是Web应用程序的顶级目录下。）
                     </p>
                     <p>提供的<code class="codeph">joseki-config.ttl</code>文件包含与Oracle数据集类似的部分：</p><pre class="oac_no_warn" dir="ltr">### Datasets＃[] ja：loadClass“oracle.spatial.rdf.client.jena.assembler。OracleAssemblerVocab“。oracle：Dataset rdfs：subClassOf ja：RDFDataset。&lt;#oracle&gt; rdf：type oracle：Dataset; joseki：poolSize 1; ##允许此数据集的并发连接数。oracle：connection [oracle：OracleConnection; oracle：dataSourceName“OracleSemDS”]; oracle：defaultModel [oracle：firstModel“TEST_MODEL”]。
</pre><p>在该文件的此部分中，您可以：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>修改<code class="codeph">joseki:poolSize</code>值，该值指定允许此Oracle数据集（ <code class="codeph">&lt;#oracle&gt; rdf:type oracle:Dataset;</code> ）的并发连接数，它指向数据库中的各种RDF模型。
                           </p>
                        </li>
                        <li>
                           <p>自定义数据源的名称。可以根据应用程序要求更改<span class="italic">OracleSemDS</span>的默认名称。但是，该名称必须与<a href="rdf-suipport-for-apache-jena.html#GUID-CC0618F7-318D-4F21-A78D-29CF31FDDB7F">使用WebLogic Server创建所需数据源中</a>指定的数据源名称相匹配。
                           </p>
                        </li>
                        <li>
                           <p>修改名称（或对象值<code class="codeph">oracle:firstModel</code>谓词）的的<code class="codeph">defaultModel</code> ，用于查询不同的语义模型。您还可以为此<code class="codeph">defaultModel</code>指定多个模型和一个或多个规则库。
                           </p>
                           <p>例如，下面指定了两个模型（名为<code class="codeph">ABOX</code>和<code class="codeph">TBOX</code> ）和默认模式的OWLPRIME规则库。请注意，使用<code class="codeph">oracle:modelName</code>谓词指定的模型必须存在;它们<span class="italic">不会</span>自动创建。
                           </p><pre class="oac_no_warn" dir="ltr">&lt;#oracle&gt; rdf：type oracle：Dataset; joseki：poolSize 1; ##允许此数据集的并发连接数。oracle：connection [oracle：OracleConnection; oracle：dataSourceName“OracleSemDS”]; oracle：defaultModel [oracle：firstModel“ABOX”; oracle：modelName“TBOX”; oracle：rulebaseName“OWLPRIME”]。
</pre></li>
                        <li>
                           <p>在数据集中指定命名图。例如，您可以根据两个Oracle模型和一个蕴涵创建名为<code class="codeph">&lt;http://G1&gt;</code>的命名图，如下所示。
                           </p><pre class="oac_no_warn" dir="ltr">&lt;#oracle&gt; rdf：type oracle：Dataset; joseki：poolSize 1; ##允许此数据集的并发连接数。oracle：connection [oracle：OracleConnection; ]。 oracle：namedModel [oracle：firstModel“ABOX”; oracle：modelName“TBOX”; oracle：rulebaseName“OWLPRIME”; <span class="bold">oracle：namedModelURI &lt;http：// G1&gt;</span> ]。
</pre><p><code class="codeph">namedModel</code>的对象可以采用与<code class="codeph">defaultModel</code>相同的规范，因此这里也支持虚拟模型（另请参见下一项）。
                           </p>
                        </li>
                        <li>
                           <p>通过添加<code class="codeph">oracle:useVM "TRUE"</code>将虚拟模型用于查询，如以下示例所示。请注意，如果指定的虚拟模型不存在， <span class="italic">将</span>根据需要自动创建。
                           </p><pre class="oac_no_warn" dir="ltr">&lt;#oracle&gt; rdf：type oracle：Dataset; joseki：poolSize 1; ##允许此数据集的并发连接数。oracle：connection [oracle：OracleConnection; ]。 oracle：defaultModel [oracle：firstModel“ABOX”; oracle：modelName“TBOX”; oracle：rulebaseName“OWLPRIME”; <span class="bold">oracle：useVM“TRUE”</span> ]。
</pre><p>有关更多信息，请参阅<a href="rdf-suipport-for-apache-jena.html#GUID-449AF064-7F23-4E4D-8155-06BBBADFADCA">虚拟模型支持</a> 。
                           </p>
                        </li>
                        <li>
                           <p>使用谓词<code class="codeph">oracle:virtualModelName</code>指定虚拟模型作为回答SPARQL查询的默认模型，如以下示例所示，其中虚拟模型名为<code class="codeph">TRIPLE_DATA_VM_0</code> ：</p><pre class="oac_no_warn" dir="ltr">oracle：defaultModel [oracle：virtualModelName“TRIPLE_DATA_VM_0”]。
</pre><p>如果底层数据由四边形组成，则可以将<code class="codeph">oracle:virtualModelName</code>与<code class="codeph">oracle:allGraphs</code> 。存在<code class="codeph">oracle:allGraphs</code>导致的一个实例<code class="codeph">DatasetGraphOracleSem</code>对象回答名为graph查询。一个例子如下：</p><pre class="oac_no_warn" dir="ltr">oracle：allGraphs [oracle：virtualModelName“QUAD_DATA_VM_0”]。
</pre><p>请注意，当虚拟模型名称被指定为默认图形时，端点只能提供查询请求;不支持SPARQL更新操作。</p>
                        </li>
                        <li>
                           <p>设置<code class="codeph">queryOptions</code>和<code class="codeph">inferenceMaintenance</code>属性以更改查询行为和推理更新模式。（有关<code class="codeph">QueryOptions</code>和<code class="codeph">InferenceMaintenanceMode</code>信息，请参阅Javadoc。）
                           </p>
                           <p>默认情况下， <code class="codeph">QueryOptions.ALLOW_QUERY_INVALID_AND_DUP</code>和<code class="codeph">InferenceMaintenanceMode.设置NO_UPDATE</code> ，以获得最大的查询灵活性和效率。
                           </p>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-9A2D924D-47EC-4D27-8B86-B2AD49290A91">客户标识符</a><br></li>
                        <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-3949377A-BE8B-40CD-98D4-C959A593FBF3">对应用程序表和临时表使用OLTP压缩</a><br></li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-BD74255C-3534-4019-979B-C43817B4C58D" title="本节介绍如何通过在WebLogic Server中部署joseki.war文件来设置SPARQL Web服务端点。">设置SPARQL服务</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="RDFRM239"></a><div class="props_rev_3"><a id="GUID-9A2D924D-47EC-4D27-8B86-B2AD49290A91" name="GUID-9A2D924D-47EC-4D27-8B86-B2AD49290A91"></a><h5 id="RDFRM-GUID-9A2D924D-47EC-4D27-8B86-B2AD49290A91" class="sect5"><span class="enumeration_section">6.2.2.1</span>客户端标识符</h5>
                     <div>
                        <p>对于Apache Jena支持创建或使用的每个数据库连接，客户端标识符与该连接相关联。客户端标识符可能很有用，尤其是在Real Application Cluster（Oracle RAC）环境中，用于在执行性能分析和调优时将Apache Jena相关活动的RDF语义图支持与其他数据库活动隔离开来。</p>
                        <p>默认情况下，分配的客户端标识是<code class="codeph">JenaAdapter</code> 。但是，您可以通过使用以下格式设置Java VM <code class="codeph">clientIdentifier</code>属性来指定其他值：</p><pre class="oac_no_warn" dir="ltr">-Doracle.spatial.rdf.client.jena.clientIdentifier = <span class="italic">&lt;identificationString&gt;</span>
</pre><p>要在数据库端仅开始跟踪与Apache Jena相关的活动的RDF语义图支持，可以使用DBMS_MONITOR.CLIENT_ID_TRACE_ENABLE过程。例如：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; EXECUTE DBMS_MONITOR.CLIENT_ID_TRACE_ENABLE（'JenaAdapter'，true，true）;</pre></div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-266D140C-5D26-49EA-B723-7ECE12293369">配置基于Joseki的SPARQL服务</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="RDFRM458"></a><div class="props_rev_3"><a id="GUID-3949377A-BE8B-40CD-98D4-C959A593FBF3" name="GUID-3949377A-BE8B-40CD-98D4-C959A593FBF3"></a><h5 id="RDFRM-GUID-3949377A-BE8B-40CD-98D4-C959A593FBF3" class="sect5"><span class="enumeration_section">6.2.2.2</span>对应用程序表和临时表使用OLTP压缩</h5>
                     <div>
                        <p>默认情况下，对Apache Jena的<a href="rdf-suipport-for-apache-jena.html#GUID-1109AB37-AFD5-4172-B7E5-6F279782A22E" title="To load thousands to hundreds of thousands of RDF/OWL data files into an Oracle database, you can use the prepareBulk and completeBulk methods in the OracleBulkUpdateHandler Java class to simplify the task.">支持</a>使用基本表压缩和以下语法创建应用程序表和任何登台表（后者用于批量加载，如<a href="rdf-suipport-for-apache-jena.html#GUID-1109AB37-AFD5-4172-B7E5-6F279782A22E" title="要将数千到数十万个RDF / OWL数据文件加载到Oracle数据库中，可以使用OracleBulkUpdateHandler Java类中的prepareBulk和completeBulk方法来简化任务。">使用对Apache Jena的RDF语义图支持批量加载中所述</a> ）：</p><pre class="oac_no_warn" dir="ltr">创建表....（... <span class="italic">列定义</span> ...）...压缩;</pre><p>但是，如果您被许可使用Oracle Advanced Compression选项而不使用数据库，则可以设置以下JVM属性以打开OLTP压缩，该压缩会在所有DML操作期间压缩基础应用程序表和登台表的数据：</p><pre class="oac_no_warn" dir="ltr">-Doracle.spatial.rdf.client.jena.advancedCompression =“compress for oltp”</pre></div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-266D140C-5D26-49EA-B723-7ECE12293369">配置基于Joseki的SPARQL服务</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div>
               <div class="sect3"><a id="GUID-3EB5694D-7BCF-45A7-A7C1-0EC0044C38CD" name="GUID-3EB5694D-7BCF-45A7-A7C1-0EC0044C38CD"></a><h4 id="RDFRM-GUID-3EB5694D-7BCF-45A7-A7C1-0EC0044C38CD" class="sect4"><span class="enumeration_section">6.2.3</span>配置基于Fuseki的SPARQL服务</h4>
                  <div>
                     <p>本主题简要介绍如何配置和设置连接到Oracle数据库的基于Fuseki的SPARQL服务。</p>
                     <p>使用基于Fuseki的SPARQL服务的概念和操作与基于Joseki的SPARQL服务的概念和操作类似，如<a href="rdf-suipport-for-apache-jena.html#GUID-266D140C-5D26-49EA-B723-7ECE12293369">配置基于Joseki的SPARQL服务中所述</a> 。该主题中有关客户端标识符和OLTP压缩的信息也适用于基于Fuseki的SPARQL服务， <code class="codeph">defaultModel</code>和<code class="codeph">allGraphs</code>的方法相同。
                     </p>
                     <p><code class="codeph">config-oracle.ttl</code>文件中提供了基于Fuseki的服务的示例<code class="codeph">oracle</code>服务。有关详细信息，请参阅“Fuseki：通过HTTP提供RDF数据”（ <a href="http://jena.apache.org/documentation/serving_data/" target="_blank"><code class="codeph">http://jena.apache.org/documentation/serving_data/</code></a> ）。</p>
                     <p>要启动连接到Oracle数据库的基于Fuseki的SPARQL服务，请输入以下命令：</p><pre class="pre codeblock"><code>cd fuseki /% ./fuseki-server --config config-oracle.ttl</code></pre><p>当Fuseki运行时，您可以通过以下格式转到URL来检查状态： <code class="codeph">http://your-hostname:3030/</code></p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-BD74255C-3534-4019-979B-C43817B4C58D" title="本节介绍如何通过在WebLogic Server中部署joseki.war文件来设置SPARQL Web服务端点。">设置SPARQL服务</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="RDFRM240"></a><div class="props_rev_3"><a id="GUID-3B337ACC-28E7-45DF-A7BC-3D01A1337552" name="GUID-3B337ACC-28E7-45DF-A7BC-3D01A1337552"></a><h4 id="RDFRM-GUID-3B337ACC-28E7-45DF-A7BC-3D01A1337552" class="sect4"><span class="enumeration_section">6.2.4</span>终止长时间运行的SPARQL查询</h4>
                  <div>
                     <p>由于某些应用程序需要能够终止长时间运行的SPARQL查询，因此引入了一个中止框架，其中包含对Apache Jena和Joseki设置的RDF语义图支持。基本上，对于可能需要很长时间才能运行的查询，您必须使用唯一的查询ID（qid）值标记每个查询。</p>
                     <p>例如，以下SPARQL查询选择所有三元组的主题。设置查询ID（qid），以便可以根据请求终止此查询。</p><pre class="oac_no_warn" dir="ltr">PREFIX ORACLE_SEM_FS_NS：&lt;http://example.com/semtech#qid=8761&gt; SELECT？主题WHERE {？学科 ？财产？对象}</pre><p><code class="codeph">qid</code>属性值是长整数类型。您可以根据自己的应用程序需求为特定查询选择<code class="codeph">qid</code>的值。
                     </p>
                     <p>要终止已使用qid值提交的SPARQL查询，应用程序可以按以下格式向servlet发送中止请求，并指定匹配的QID值</p><pre class="oac_no_warn" dir="ltr">http：// <span class="italic">&lt;主机名&gt;</span> ：7001 / joseki / querymgt？abortqid = 8761</pre></div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-BD74255C-3534-4019-979B-C43817B4C58D" title="本节介绍如何通过在WebLogic Server中部署joseki.war文件来设置SPARQL Web服务端点。">设置SPARQL服务</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="RDFRM241"></a><div class="props_rev_3"><a id="GUID-E9E1A6CA-1753-4213-AF84-6B2B881529E4" name="GUID-E9E1A6CA-1753-4213-AF84-6B2B881529E4"></a><h4 id="RDFRM-GUID-E9E1A6CA-1753-4213-AF84-6B2B881529E4" class="sect4"><span class="enumeration_section">6.2.5</span>非ASCII字符的N-Triples编码</h4>
                  <div>
                     <p>对于RDF资源的词汇表示中的任何非ASCII字符，在将字符插入Oracle数据库时使用<code class="codeph">\uHHHH</code> N-Triples编码。（有关N-Triples编码的详细信息，请参阅<a href="http://www.w3.org/TR/rdf-testcases/#ntrip_grammar" target="_blank"><code class="codeph">http://www.w3.org/TR/rdf-testcases/#ntrip_grammar</code></a>查询中的常量资源的编码以类似的方式处理。
                     </p>
                     <p>使用<code class="codeph">\uHHHH</code> N-Triples编码可以在Oracle数据库中支持国际字符，例如混合使用挪威语和瑞典语字符，即使未使用受支持的Unicode字符集也是如此。
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-BD74255C-3534-4019-979B-C43817B4C58D" title="本节介绍如何通过在WebLogic Server中部署joseki.war文件来设置SPARQL Web服务端点。">设置SPARQL服务</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
            <div class="props_rev_3"><a id="GUID-0C92F16E-897F-4BA5-9072-A3632A1A9847" name="GUID-0C92F16E-897F-4BA5-9072-A3632A1A9847"></a><h3 id="RDFRM-GUID-0C92F16E-897F-4BA5-9072-A3632A1A9847" class="sect3"><span class="enumeration_section">6.3</span>设置动态SPARQL端点</h3>
               <div>
                  <p>您可以使用Apache Jena Joseki和Apache Jena Fuseki设置动态SPARQL Web服务端点。</p>
                  <p>动态SPARQL端点扩展了SPARQL查询和更新服务，以处理超出配置文件中明确指定的图形或模型。这样，SPARQL服务不需要重新启动即可从配置文件中读取更新的配置。RDF语义图动态SPARQL端点功能适用于物理模型，虚拟模型，混合图和RDB2RDF。</p>
                  <p>要确保动态SPARQL端点仅提供对授权图的访问，可以在SPARQL服务的配置文件中指定黑名单和白名单条目。黑名单和白名单条目是使用Java正则表达式定义的一组模式，用于指定禁止或允许与动态SPARQL端点一起使用的模型名称列表。这样，只有名称与白名单中至少一个模式匹配且黑名单中没有匹配的模型才能通过动态SPARQL端点访问。</p>
                  <p>如果同时指定了黑名单和白名单条目，则黑名单条目始终优先。特别：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>如果模型名称与任何黑名单模式匹配，则不会公开。</p>
                     </li>
                     <li>
                        <p>如果型号名称与任何黑名单模式不匹配，但它也与任何白名单模式都不匹配，则不会公开。</p>
                     </li>
                     <li>
                        <p>如果型号名称不匹配任何黑名单模式<span class="italic"><span class="bold">，</span></span>它匹配的一个或多个白名单模式，那么它<span class="bold"><span class="italic">被</span></span>暴露。
                        </p>
                     </li>
                  </ul>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-E56824AB-B0DC-464F-BE0B-F9FF630C6B20">在Fuseki Server中配置动态SPARQL端点</a><br></li>
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-75391C6C-7FD9-4325-9CBB-2D03D5FDF709">在Joseki Servlet中配置动态SPARQL端点</a><br></li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-3F437E3E-3B74-4CCF-9F16-B2B07B3899E8" title="Apache Jena的RDF语义图支持（这里也称为对Apache Jena的支持）通过实现着名的Jena Graph，Model和DatasetGraph API为Oracle Spatial和Graph RDF语义图提供了基于Java的接口。">Apache Jena的RDF语义图支持</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="props_rev_3"><a id="GUID-E56824AB-B0DC-464F-BE0B-F9FF630C6B20" name="GUID-E56824AB-B0DC-464F-BE0B-F9FF630C6B20"></a><h4 id="RDFRM-GUID-E56824AB-B0DC-464F-BE0B-F9FF630C6B20" class="sect4"><span class="enumeration_section">6.3.1</span>在Fuseki Server中配置动态SPARQL端点</h4>
                  <div>
                     <p>要在Fuseki中配置动态SPARQL端点，必须在<code class="codeph">config-oracle.ttl</code>文件中定义两个新服务： <code class="codeph">oracle/model/*</code>用于SPARQL Query， <code class="codeph">oracle/updatemodel/*</code>用于SPARQL Update。通过动态SPARQL Web服务端点访问模型时将使用这些服务。此外，您需要定义将与图形（模型）名称匹配的黑名单和白名单模式。
                     </p>
                     <p>要添加这些服务和列表模式：</p>
                     <ol>
                        <li>
                           <p>停止Fuseki服务器。</p>
                        </li>
                        <li>
                           <p>将这些附加的三元组与<code class="codeph">model/*</code>和<code class="codeph">updatemodel/*</code> services一起插入到services部分的<code class="codeph">config-oracle.ttl</code>配置文件中。该部分应如下所示：</p><pre class="oac_no_warn" dir="ltr">&lt;＃service1&gt; rdf：type fuseki：Service; ...＃动态SPARQL端点查询服务fuseki：serviceQuery“model / *”; ...＃动态SPARQL端点更新服务fuseki：serviceUpdate“updatemodel / *”; ...fuseki：dataset &lt;#oracle&gt;; 。
</pre></li>
                        <li>
                           <p>定义将与模型名称匹配的黑名单和白名单模式。要配置这些模式，请在<code class="codeph">config-oracle.ttl</code>文件中插入带有<code class="codeph">oracle:blackListRegex</code>和<code class="codeph">oracle:whiteListRegex</code>谓词的三元组。以下代码段显示了一些示例模式，这些模式仅允许访问包含“nice”，“ok”或“showme”的模型，并且不会在其名称中包含要通过动态SPARQL端点公开的“禁止”和“机密”。
                           </p><pre class="oac_no_warn" dir="ltr">&lt;#oracle&gt; oracle：blackListRegex“。* forbidden。*”; oracle：blackListRegex“。* secret。*”; oracle：whiteListRegex“。* ok。*”; oracle：whiteListRegex“。* nice。*”; oracle：whiteListRegex“。* showme。*”。
</pre></li>
                        <li>
                           <p>重启Fuseki服务器。</p>
                        </li>
                     </ol>
                     <p>使用此附加配置，您现在可以访问模型<code class="codeph">mynicegraph</code>即使它未在配置文件的“数据集”部分中明确定义，只要白名单和黑名单模式允许它，并使用类似于以下SPARQL查询的URL：</p><pre class="pre codeblock"><code>http：// &lt;hostname：port&gt; / oracle / <span class="bold">model / mynicegraph</span></code></pre><p>对于SPARQL Update，请使用如下URL：</p><pre class="pre codeblock"><code>http：// &lt;hostname：port&gt; / oracle / <span class="bold">updatemodel / mynicegraph</span></code></pre></div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-0C92F16E-897F-4BA5-9072-A3632A1A9847" title="您可以使用Apache Jena Joseki和Apache Jena Fuseki设置动态SPARQL Web服务端点。">设置动态SPARQL端点</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="props_rev_3"><a id="GUID-75391C6C-7FD9-4325-9CBB-2D03D5FDF709" name="GUID-75391C6C-7FD9-4325-9CBB-2D03D5FDF709"></a><h4 id="RDFRM-GUID-75391C6C-7FD9-4325-9CBB-2D03D5FDF709" class="sect4"><span class="enumeration_section">6.3.2</span>在Joseki Servlet中配置动态SPARQL端点</h4>
                  <div>
                     <p>要在Joseki中配置Dynamic SPARQL Endpoint，必须在<code class="codeph">joseki-config.ttl</code>文件中定义两个新服务： <code class="codeph">oracle/model/*</code>用于SPARQL Query， <code class="codeph">oracle/updatemodel/*</code>用于SPARQL Update。通过动态SPARQL Web服务端点访问模型时将使用这些服务。此外，您需要定义将与图形（模型）名称匹配的黑名单和白名单模式</p>
                     <p>要添加这些服务和列表模式：</p>
                     <ol>
                        <li>
                           <p>停止运行Joseki服务的Web服务器。</p>
                        </li>
                        <li>
                           <p>从<code class="codeph">joseki.war</code>文件中，将<code class="codeph">joseki-config.ttl</code>文件解压缩到临时位置。例如：</p><pre class="pre codeblock"><code>cd / tmp / jena_adapter / war cp &lt;your_directory&gt; /joseki.war / tmp / jena_adapter / war / jar -xf joseki.war WEB-INF / classes / joseki-config.ttl</code></pre></li>
                        <li>
                           <p>要在Joseki中配置Dynamic SPARQL查询服务，请在配置joseki-config.ttl文件中包含一组主题为&lt;#serviceDynamicQuery&gt;和&lt;#serviceDynamicUpdate&gt;的三元组，类似于已定义的服务。</p>
                           <p>这些三元组将定义oracle / model / *和oracle / updatemodel / *服务。谓词joseki：serviceRef表示oracle / model / * SPARQL服务端点将提供查询，oracle / updatemodel / * SPARQL服务端点将使用URL编码中的任何模型名称提供更新。动态SPARQL查询服务部分应如下所示：</p><pre class="oac_no_warn" dir="ltr">#Dynamic SPARQL查询服务&lt;#serviceDynamicQuery&gt; rdf：type joseki：Service; rdfs：标签“模型SPARQL与Oracle语义数据管理”; joseki：serviceRef“oracle / model / *”; #web.xml必须将此名称路由到Joseki＃dataset part joseki：dataset &lt;#oracle&gt;; ＃服务部分。＃此处理器不允许协议＃和查询指定数据集。Joseki：处理器joseki：ProcessorSPARQL_FixedDS; 。
</pre><p>Dynamic SPARQL Update部分应如下所示：</p><pre class="oac_no_warn" dir="ltr">#Dynamic SPARQL Update Service &lt;#serviceDynamicUpdate&gt; rdf：type joseki：Service; rdfs：label“SPARQL / Update”; joseki：serviceRef“oracle / updatemodel / *”; #datat part joseki：dataset &lt;#oracle&gt;; ＃服务部分。＃此处理器不允许协议＃和查询指定数据集。joseki：处理器joseki：ProcessorSPARQLUpdate。
</pre></li>
                        <li>
                           <p>定义将与模型名称匹配的黑名单和白名单模式。要配置这些模式，请在<code class="codeph">joseki-config.ttl</code>文件中插入带有<code class="codeph">oracle:blackListRegex</code>和<code class="codeph">oracle:whiteListRegex</code>谓词的<code class="codeph">joseki-config.ttl</code> 。
                           </p>
                           <p>以下代码段显示了一些示例模式，这些模式仅允许访问包含单词“cool”或“good”的模型，并且不会在其名称中包含要通过动态SPARQL端点公开的单词“banned”或“test”。如果用户尝试通过动态查询或更新服务访问任何其他模型，则将返回一条错误消息，指出该模型不可用。</p><pre class="oac_no_warn" dir="ltr">&lt;#oracle&gt; oracle：blackListRegex“。* banned。*”; oracle：blackListRegex“。* test。*”; oracle：whiteListRegex“。* cool。*”; oracle：whiteListRegex“。* good。*”。

</pre></li>
                        <li>
                           <p>更新<code class="codeph">.ttl</code>文件中的<code class="codeph">.ttl</code>配置文件。例如：</p><pre class="pre codeblock"><code>jar -uf joseki.war WEB-INF / classes / joseki-config.ttl</code></pre></li>
                        <li>
                           <p>从<code class="codeph">joseki.war</code>文件中，将Web描述符文件解压缩到临时位置：例如：</p><pre class="pre codeblock"><code>cd / tmp / jena_adapter / war / jar -xf joseki.war WEB-INF / web.xml</code></pre></li>
                        <li>
                           <p>将Web描述符中的<code class="codeph">model/*</code>和<code class="codeph">updatemodel/*</code> URL路由<code class="codeph">updatemodel/*</code>到Joseki servlet。在<code class="codeph">web.xml</code>文件中插入新的servlet映射。servlet映射部分应如下所示：</p><pre class="oac_no_warn" dir="ltr">...&lt;servlet&gt; &lt;servlet-name&gt; SPARQL服务处理器&lt;/ servlet-name&gt; &lt;servlet-class&gt; org.joseki.http。Servlet &lt;/ servlet-class&gt; &lt;init-param&gt; &lt;param-name&gt; org.joseki.rdfserver.config &lt;/ param-name&gt; &lt;param-value&gt; joseki-oracle-config.ttl &lt;/ param-value&gt; &lt;/ init-param&gt; &lt;/ servlet&gt; ...&lt;servlet&gt; &lt;servlet-name&gt; SPARQL /更新服务处理器&lt;/ servlet-name&gt; &lt;servlet-class&gt; org.joseki.http。ServletUpdate &lt;/ servlet-class&gt; &lt;init-param&gt; &lt;param-name&gt; org.joseki.rdfserver.config &lt;/ param-name&gt; &lt;param-value&gt; joseki-oracle-config.ttl &lt;/ param-value&gt; &lt;/ init-param&gt; &lt;/ servlet&gt; ...&lt;servlet-mapping&gt; &lt;servlet-name&gt; SPARQL服务处理器&lt;/ servlet-name&gt; &lt;url-pattern&gt; / oracle / model / * &lt;/ url-pattern&gt; &lt;/ servlet-mapping&gt; ...&lt;servlet-mapping&gt; &lt;servlet-name&gt; SPARQL /更新服务处理器&lt;/ servlet-name&gt; &lt;url-pattern&gt; / oracle / updatemodel / * &lt;/ url-pattern&gt; &lt;/ servlet-mapping&gt; ...
</pre></li>
                        <li>
                           <p>更新war文件中的Web描述符文件。例如：</p><pre class="pre codeblock"><code>jar -uf joseki.war web.xml</code></pre></li>
                        <li>
                           <p>将<code class="codeph">joseki.war</code>文件重新部署到同一J2EE容器中。
                           </p>
                        </li>
                     </ol>
                     <p>使用此附加配置，您现在可以访问模型<code class="codeph">mycoolgraph</code>即使它未在配置文件的“数据集”部分中明确定义，只要白名单和黑名单模式允许它，并使用类似于以下SPARQL查询的URL：</p><pre class="pre codeblock"><code>http：// &lt;hostname：port&gt; / joseki / oracle / <span class="bold">model / mycoolgraph</span></code></pre><p>对于SPARQL Update，请使用如下URL：</p><pre class="pre codeblock"><code>http：// &lt;hostname：port&gt; / joseki / oracle / <span class="bold">updatemodel / mycoolgraph</span></code></pre></div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-0C92F16E-897F-4BA5-9072-A3632A1A9847" title="您可以使用Apache Jena Joseki和Apache Jena Fuseki设置动态SPARQL Web服务端点。">设置动态SPARQL端点</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
            <div class="props_rev_3"><a id="GUID-4ED474AE-8D92-4389-9106-87997729030A" name="GUID-4ED474AE-8D92-4389-9106-87997729030A"></a><h3 id="RDFRM-GUID-4ED474AE-8D92-4389-9106-87997729030A" class="sect3"><span class="enumeration_section">6.4</span>为Joseki Servlet添加跨站点请求伪造（CSRF）保护</h3>
               <div>
                  <p>您可以向Joseki servlet添加跨站点请求伪造（CSRF）保护。</p>
                  <p>跨站点请求伪造（CSRF，或有时称为XSRF）攻击是一种利用，其中未经授权的和无意的请求被发送到网站。这些未经授权的请求来自已经过身份验证的用户或网站信任的用户，因此无法将其与有效请求区分开来。此类攻击也称为一键攻击或会话，即使Web应用程序使用SSL加密（HTTPS）也可能发生此类攻击。</p>
                  <p>Oracle Spatial and Graph RDF语义图允许您通过实现<a href="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet#Double_Submit_Cookie" target="_blank">双提交cookie模式</a>来启用针对Joseki servlet的CSRF攻击防护。此安全模式确保仅在请求包含安全性令牌作为参数且此安全性令牌与应用程序使用和设置的cookie中指定的安全性令牌匹配时才接受更新请求。为了向后兼容，默认情况下不启用CSRF保护。
                  </p>
                  <p>实现双提交cookie模式的应用程序必须生成并设置安全性令牌作为cookie中的值。在RDF语义图实现中，此任务由servlet <code class="codeph">org.joseki.http.执行<code class="codeph">org.joseki.http.CookieTokenSetter</code> 。同样，向受CSRF攻击保护的应用程序提交请求的客户端必须从cookie中检索此值，并将其设置为其请求中的附加参数。RDF语义图功能使用<code class="codeph">_RDF_AUTH_TOKEN_HIDDEN</code>作为特殊参数，通过在<code class="codeph">update.html</code>文件中使用JavaScript将有效请求发送到服务器。
                  </p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-0ED9FC59-DBA8-48D0-9970-FDE22EAA3AF1">配置Joseki服务器以添加跨站点请求伪造保护</a><br></li>
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-B7671FD3-C2C5-4FEB-9E29-53F71B4894B7">配置Joseki客户端以添加跨站点请求伪造保护</a><br></li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-3F437E3E-3B74-4CCF-9F16-B2B07B3899E8" title="Apache Jena的RDF语义图支持（这里也称为对Apache Jena的支持）通过实现着名的Jena Graph，Model和DatasetGraph API为Oracle Spatial和Graph RDF语义图提供了基于Java的接口。">Apache Jena的RDF语义图支持</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="props_rev_3"><a id="GUID-0ED9FC59-DBA8-48D0-9970-FDE22EAA3AF1" name="GUID-0ED9FC59-DBA8-48D0-9970-FDE22EAA3AF1"></a><h4 id="RDFRM-GUID-0ED9FC59-DBA8-48D0-9970-FDE22EAA3AF1" class="sect4"><span class="enumeration_section">6.4.1</span>配置Joseki Server添加跨站点请求伪造保护</h4>
                  <div>
                     <p>要在Joseki服务中启用跨站点请求伪造（CSRF）保护：</p>
                     <ol>
                        <li>
                           <p>停止运行Joseki服务的Web服务器。</p>
                        </li>
                        <li>
                           <p>从<code class="codeph">joseki.war</code>文件中，将Web描述符文件的提取解压缩到临时位置。例如：</p><pre class="pre codeblock"><code>cd / tmp / jena_adapter / war jar -xf joseki.war WEB-INF / web.xml</code></pre></li>
                        <li>
                           <p>指定servlet <code class="codeph">org.joseki.http.Web描述符中的CookieTokenSetter</code> 。此servlet将生成安全的随机令牌，以保护SPARQL端点免受CSRF攻击。<code class="codeph">web.xml</code>文件应包含以下代码段：</p><pre class="oac_no_warn" dir="ltr">&lt;！ -  RDF AUTH TOKEN COOKIE  - &gt; &lt;servlet&gt; &lt;servlet-name&gt; OracleRdfCookieTokenSetter &lt;/ servlet-name&gt; &lt;servlet-class&gt; org.joseki.http。CookieTokenSetter &lt;/ servlet-class&gt; &lt;/ servlet&gt; ...&lt;servlet-mapping&gt; &lt;servlet-name&gt; OracleRdfCookieTokenSetter &lt;/ servlet-name&gt; &lt;url-pattern&gt; / oracle / getCookie &lt;/ url-pattern&gt; &lt;/ servlet-mapping&gt;</pre></li>
                        <li>
                           <p>更新war文件中的Web描述符文件。例如：</p><pre class="pre codeblock"><code>jar -uf joseki.war WEB-INF / web.xml</code></pre></li>
                        <li>
                           <p>将joseki.war重新部署到同一个J2EE容器中。</p>
                        </li>
                        <li>
                           <p>启用Java属性<code class="codeph">oracle.spatial.rdf.client.jena. <span class="bold">enableCsrfProtection</span></code>在运行Joseki SPARQL服务之前<code class="codeph"><span class="bold">oracle.spatial.rdf.client.jena. enableCsrfProtection</span></code> ：</p><pre class="oac_no_warn" dir="ltr">-Doracle.spatial.rdf.client.jena。 <span class="bold">enableCsrfProtection =真</span></pre></li>
                        <li>
                           <p>重新启动服务器。Joseki服务现在将受到保护，免受CSRF攻击。</p>
                        </li>
                     </ol>
                     <div class="p">您现在可以使用首选客户端应用程序在Joseki servlet中以下列格式访问URL，并且将自动设置带有安全令牌的cookie：<pre class="oac_no_warn" dir="ltr">http：// hostname：port / joseki / oracle / <span class="bold">getCookie</span></pre></div>
                     <p><a href="rdf-suipport-for-apache-jena.html#GUID-B7671FD3-C2C5-4FEB-9E29-53F71B4894B7">配置Joseki客户端以添加跨站点请求伪造保护</a>描述了如何配置客户端以检索和使用此令牌。
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-4ED474AE-8D92-4389-9106-87997729030A" title="您可以向Joseki servlet添加跨站点请求伪造（CSRF）保护。">向Joseki Servlet添加跨站点请求伪造（CSRF）保护</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="props_rev_3"><a id="GUID-B7671FD3-C2C5-4FEB-9E29-53F71B4894B7" name="GUID-B7671FD3-C2C5-4FEB-9E29-53F71B4894B7"></a><h4 id="RDFRM-GUID-B7671FD3-C2C5-4FEB-9E29-53F71B4894B7" class="sect4"><span class="enumeration_section">6.4.2</span>配置Joseki客户端添加跨站点请求伪造保护</h4>
                  <div>
                     <p>为了能够将有效请求发送到受CSRF保护的Joseki服务，您还需要在客户端应用程序中进行一些额外配置。</p>
                     <p>本主题描述了一个示例流，用于配置和使用客户端应用程序向受保护的Joseki服务器发送有效请求。只要安全令牌在<code class="codeph">_RDF_AUTH_TOKEN_HIDDEN</code>参数<span class="bold">和</span> cookie中发送，您就可以使用不同的方式。请注意，在此示例流程中，客户端应用程序实际上是一个HTML页面，它提供了一个简单的SPARQL更新接口。此客户端应用程序也捆绑在相同的<code class="codeph">joseki.war</code>文件中。
                     </p>
                     <ol>
                        <li>
                           <p>停止运行Joseki的Web服务器。</p>
                        </li>
                        <li>
                           <p>从<code class="codeph">joseki.war</code>文件中，将<code class="codeph">update.html</code>文件<code class="codeph">update.html</code>压缩到临时位置。例如：</p><pre class="pre codeblock"><code>cd / tmp / jena_adapter / war jar -xf joseki.war update.html</code></pre></li>
                        <li>
                           <p>编辑update.html文件，删除提交输入，并将其替换为调用自定义JavaScript函数的按钮输入。该文件应包含如下代码段：</p><pre class="oac_no_warn" dir="ltr">&lt;form id =“formSPARQLUpdate”action =“update / service”method =“post”&gt; &lt;p&gt;输入您的SPARQL /更新请求&lt;/ p&gt; &lt;p&gt; &lt;textarea style =“background-color：＃F0F0F0;” name =“request”cols =“70”rows =“20”&gt; &lt;/ textarea&gt; &lt;br/&gt; &lt;input type =“hidden”name =“_ RDF_AUTH_TOKEN_HIDDEN”id =“_ RDF_AUTH_TOKEN_HIDDEN”value =“”/&gt; &lt;！ -  -  &lt;input type =“submit”value =“执行SPARQL更新”/&gt;  - &gt; &lt;input type =“button”value =“执行SPARQL更新”onclick =“postSPARQLUpdate（）”&gt; &lt;/ p&gt; &lt;/ form&gt;</pre></li>
                        <li>
                           <p>使用自定义函数将脚本添加到<code class="codeph">update.html</code>文件，该函数将向Joseki servlet提交POST请求。此函数必须从cookie值读取安全令牌，并在发送请求之前将其设置为<code class="codeph">_RDF_AUTH_TOKEN_HIDDEN</code>参数。该脚本应包含如下代码段：</p><pre class="oac_no_warn" dir="ltr">&lt;script type =“text / javascript”&gt; function postSPARQLUpdate（）{var form = document.getElementById（“formSPARQLUpdate”）; var token = getCookie（'RDF_AUTH_TOKEN_COOKIE'）; document.getElementById（'_ RDF_AUTH_TOKEN_HIDDEN'）。value = token; form.submit（）;函数getCookie（cname）{var name = cname +“=”; var ca = document.cookie.split（';'）; for（var i = 0; i &lt;ca.length; i ++）{var c = ca [i]; while（c.charAt（0）==''）c = c.substring（1）; if（c.indexOf（name）== 0）返回c.substring（name.length，c.length）; } return“”; } &lt;/ script&gt;</pre></li>
                        <li>
                           <p>更新<code class="codeph">update.html</code>文件中的<code class="codeph">update.html</code>文件。例如：</p><pre class="pre codeblock"><code>jar -uf joseki.war update.html</code></pre></li>
                        <li>
                           <p>将<code class="codeph">joseki.war</code>文件重新部署到选定的J2EE容器中。
                           </p>
                        </li>
                        <li>
                           <p>重新启动Web服务器。</p>
                        </li>
                     </ol>
                     <p>通过这些修改，Joseki中的简单SPARQL更新客户端应用程序将能够在以下网站上正确使用受CSRF保护的Joseki服务。（请注意，如果您愿意，可以实现并使用其他客户端。）</p><pre class="oac_no_warn" dir="ltr">http：// hostname：port / joseki / <span class="bold">update.html</span></pre></div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-4ED474AE-8D92-4389-9106-87997729030A" title="您可以向Joseki servlet添加跨站点请求伪造（CSRF）保护。">向Joseki Servlet添加跨站点请求伪造（CSRF）保护</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="RDFRM242"></a><div class="props_rev_3"><a id="GUID-74757671-5D3E-4813-B8ED-035834F05307" name="GUID-74757671-5D3E-4813-B8ED-035834F05307"></a><h3 id="RDFRM-GUID-74757671-5D3E-4813-B8ED-035834F05307" class="sect3"><span class="enumeration_section">6.5</span>设置RDF语义图环境</h3>
               <div>
                  <div><span>要使用对Apache Jena的支持来执行查询，您可以以任何用户（具有适当的权限）进行连接，并使用语义网络中的任何模型。</span></div>
                  <div class="section">
                     <p>如果您的RDF语义图环境已满足要求，您可以直接编译和运行使用Apache Jena支持的Java代码。如果您的RDF语义图环境尚未设置为能够使用对Apache Jena的支持，则可以执行类似于以下示例步骤的操作：</p>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>以SYS身份连接SYSDBA角色：</span><div><pre class="oac_no_warn" dir="ltr">sqlplus sys / <span class="italic">&lt;password-for-sys&gt;</span> as sysdba</pre></div>
                     </li>
                     <li class="stepexpand"><span>为系统表创建表空间。例如：</span><div><pre class="oac_no_warn" dir="ltr">CREATE TABLESPACE rdf_users数据文件'rdf_users01.dbf'大小128M在下一个64M maxsize无限段空间管理自动重用autoextend;</pre></div>
                     </li>
                     <li class="stepexpand"><span>创建语义网络。例如：</span><div><pre class="oac_no_warn" dir="ltr">执行sem_apis.create_sem_network（'RDF_USERS'）;</pre></div>
                     </li>
                     <li class="stepexpand"><span>创建数据库用户（用于连接数据库以使用语义网络和对Apache Jena的支持）。例如：</span><div><pre class="oac_no_warn" dir="ltr">CREATE USER rdfusr由&lt;password-for-udfusr&gt; DEFAULT TABLESPACE rdf_users标识;</pre></div>
                     </li>
                     <li class="stepexpand"><span>为此数据库用户授予必要的权限。例如：</span><div><pre class="oac_no_warn" dir="ltr">GRANT connect，资源TO rdfusr;</pre></div>
                     </li>
                     <li class="stepexpand"><span>要使用您自己的语义数据支持Apache Jena，请执行相应的步骤来存储数据，创建模型和创建数据库索引，如<a href="rdf-semantic-graph-overview.html#GUID-7F590F2D-F382-4CD6-A95A-757010BB148F" title="要在Oracle数据库中使用语义数据，请遵循以下常规步骤。">“使用语义数据快速入门”中所述</a> 。然后通过编译和运行Java代码来执行查询;请参阅<a href="rdf-suipport-for-apache-jena.html#GUID-9F748C0E-437D-4EBD-80CF-BFA91F3CFE3A" title="本节包括使用Apache Jena支持的示例查询。每个示例都是自包含的：它通常创建模型，创建三元组，执行可能涉及推理的查询，显示结果并删除模型。">示例查询使用RDF语义图支持Apache Jena</a>以获取有关示例查询的信息。</span><div>
                           <p>要使用提供的示例数据支持Apache Jena，请参阅<a href="rdf-suipport-for-apache-jena.html#GUID-9F748C0E-437D-4EBD-80CF-BFA91F3CFE3A" title="本节包括使用Apache Jena支持的示例查询。每个示例都是自包含的：它通常创建模型，创建三元组，执行可能涉及推理的查询，显示结果并删除模型。">使用Apache Jena的RDF语义图支持的示例查询</a> 。
                           </p>
                        </div>
                     </li>
                  </ol>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-3F437E3E-3B74-4CCF-9F16-B2B07B3899E8" title="Apache Jena的RDF语义图支持（这里也称为对Apache Jena的支持）通过实现着名的Jena Graph，Model和DatasetGraph API为Oracle Spatial和Graph RDF语义图提供了基于Java的接口。">Apache Jena的RDF语义图支持</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="RDFRM243"></a><div class="props_rev_3"><a id="GUID-4FF1C4D8-B1CE-4E88-8E84-703EBBAC2222" name="GUID-4FF1C4D8-B1CE-4E88-8E84-703EBBAC2222"></a><h3 id="RDFRM-GUID-4FF1C4D8-B1CE-4E88-8E84-703EBBAC2222" class="sect3"><span class="enumeration_section">6.6</span> Apache Jena查询的SEM_MATCH和RDF语义图支持比较</h3>
               <div>
                  <p>有两种方法可以查询存储在Oracle数据库中的语义数据：基于SEM_MATCH的SQL语句和SPARQL查询，通过对Apache Jena的支持。</p>
                  <p>使用每种方法的查询外观相似，但存在重要的行为差异。为了确保一致的应用程序行为，您必须了解差异并在处理来自SEM_MATCH查询和SPARQL查询的查询结果时小心谨慎。</p>
                  <p>以下简单示例显示了这两种方法。</p>
                  <p><span class="bold">查询1（基于SEM_MATCH）</span></p><pre class="oac_no_warn" dir="ltr">从表中选择s，p，o（sem_match（'{？s？p？o}'，sem_models（'Test_Model'），....））
</pre><p><span class="bold">查询2（通过支持Apache Jena进行SPARQL查询）</span></p><pre class="oac_no_warn" dir="ltr">选择 ？s？p？o哪里{？s？p？Ø}</pre><p>这两个查询执行相同类型的功能;但是，有一些重要的区别。查询1（基于SEM_MATCH）：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>从<code class="codeph">Test_Model</code>读取所有三元组。
                        </p>
                     </li>
                     <li>
                        <p>不区分URI，bNode，普通文字和类型文字，并且它不处理长文字。</p>
                     </li>
                     <li>
                        <p>不会忽略某些字符（例如<code class="codeph">'\n'</code> ）。
                        </p>
                     </li>
                  </ul>
                  <p>查询2（通过对Apache Jena的支持执行的SPARQL查询）也读取<code class="codeph">Test_Model</code>所有三元组（假设它执行了对<code class="codeph">ModelOracleSem</code>的调用，引用了相同的底层<code class="codeph">Test_Model</code> ）。但是，查询2：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>读取其他列（而不是使用SEM_MATCH表函数的<code class="codeph">s</code> ， <code class="codeph">p</code>和<code class="codeph">o</code>列），以区分URI，bNodes，普通文字，类型文字和长文字。这是为了确保正确创建Jena Node对象。
                        </p>
                     </li>
                     <li>
                        <p>Unescapes存储在Oracle数据库中时转义的那些字符</p>
                     </li>
                  </ul>
                  <p>空白节点处理是两种方法之间的另一个区别：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>在基于SEM_MATCH的查询中，空白节点始终被视为常量。</p>
                     </li>
                     <li>
                        <p>在SPARQL查询中，当通过对Apache Jena的支持执行查询时， <span class="italic">未</span>包含在<code class="codeph">&lt;</code>和<code class="codeph">&gt;</code>内的空白节点将<span class="italic">被</span>视为变量。这与SPARQL标准语义相匹配。但是，在执行查询时，包含在<code class="codeph">&lt;</code>和<code class="codeph">&gt;</code>内的空白节点将<span class="italic">被</span>视为常量，并且对Apache Jena的支持会根据基础数据建模的要求为空白节点标签添加正确的前缀。
                        </p>
                     </li>
                  </ul>
                  <p>使用对Apache Jena API的支持创建的语义模型名称的最大长度为22个字符。</p>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-3F437E3E-3B74-4CCF-9F16-B2B07B3899E8" title="Apache Jena的RDF语义图支持（这里也称为对Apache Jena的支持）通过实现着名的Jena Graph，Model和DatasetGraph API为Oracle Spatial和Graph RDF语义图提供了基于Java的接口。">Apache Jena的RDF语义图支持</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="RDFRM785"></a><a id="RDFRM786"></a><a id="RDFRM787"></a><a id="RDFRM71234"></a><div class="props_rev_3"><a id="GUID-996A56E5-868C-4A78-8BF7-3B51921F1DCD" name="GUID-996A56E5-868C-4A78-8BF7-3B51921F1DCD"></a><h3 id="RDFRM-GUID-996A56E5-868C-4A78-8BF7-3B51921F1DCD" class="sect3"><span class="enumeration_section">6.7</span>从SEM_MATCH或基于SQL的查询结果中检索用户友好的Java对象</h3>
               <div>
                  <p>您可以使用以下任何方法查询语义图。</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>SPARQL（通过Java方法或Web服务端点）</p>
                     </li>
                     <li>
                        <p>SEM_MATCH（嵌入了SPARQL查询的表函数）</p>
                     </li>
                     <li>
                        <p>SQL（通过查询MDSYS.RDFM_ <span class="italic">&lt;model&gt;</span>视图并加入MDSYS.RDF_VALUE $和/或其他表）</p>
                     </li>
                  </ul>
                  <p>对于Java开发人员来说，第一种方法的结果很容易消耗。但是，对于Java开发人员来说，第二种和第三种方法的结果可能很难，因为您必须解析各种列以获取从类型化的RDF文字映射的正确类型的Java对象。Apache Jena的RDF语义图支持支持多种方法和辅助函数，以简化从JDBC结果集中获取正确类型的Java对象的任务。以下示例中显示了这些方法和帮助程序函数：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="rdf-suipport-for-apache-jena.html#GUID-996A56E5-868C-4A78-8BF7-3B51921F1DCD__BGBGIBAE">例6-1</a></p>
                     </li>
                     <li>
                        <p><a href="rdf-suipport-for-apache-jena.html#GUID-996A56E5-868C-4A78-8BF7-3B51921F1DCD__BGBCBDFC">例6-2</a></p>
                     </li>
                     <li>
                        <p><a href="rdf-suipport-for-apache-jena.html#GUID-996A56E5-868C-4A78-8BF7-3B51921F1DCD__BGBHEEBA">例6-3</a></p>
                     </li>
                  </ul>
                  <p>这些示例使用测试表TGRAPH_TPL（以及基于它的模型TGRAPH），其中添加了一组类型文字，如下面的代码所示：</p><pre class="oac_no_warn" dir="ltr">create table tgraph_tpl（triple sdo_rdf_triple_s）; exec sem_apis.create_sem_model（'tgraph'，'tgraph_tpl'，'triple'）; truncate table tgraph_tpl; - 在tgraph_tpl值中添加一些三元组插入（sdo_rdf_triple_s（'tgraph'，'&lt;urn：s1&gt;'，'&lt;urn：p1&gt;'，'&lt;urn：o1&gt;'））;插入tgraph_tpl值（sdo_rdf_triple_s（'tgraph'，'&lt;urn：s2&gt;'，'&lt;urn：p2&gt;'，'“hello world”'））;插入tgraph_tpl值（sdo_rdf_triple_s（'tgraph'，'&lt;urn：s3&gt;'，'&lt;urn：p3&gt;'，'“hello world”@en'））;插入tgraph_tpl值（sdo_rdf_triple_s（'tgraph'，'&lt;urn：s4&gt;'，'&lt;urn：p4&gt;'，'“o1o”^^ &lt;http://www.w3.org/2001/XMLSchema#string&gt; “））;插入tgraph_tpl值（sdo_rdf_triple_s（'tgraph'，'&lt;urn：s4&gt;'，'&lt;urn：p4&gt;'，'“xyz”^^ &lt;http：// mytype&gt;'））;插入tgraph_tpl值（sdo_rdf_triple_s（'tgraph'，'&lt;urn：s5&gt;'，'&lt;urn：p5&gt;'，'“123”^^ &lt;http://www.w3.org/2001/XMLSchema#integer&gt; “））;插入tgraph_tpl值（sdo_rdf_triple_s（'tgraph'，'&lt;urn：s5&gt;'，'&lt;urn：p5&gt;'，'“123.456”^^ &lt;http://www.w3.org/2001/XMLSchema#double&gt; “））;插入tgraph_tpl值（sdo_rdf_triple_s（'tgraph'，'&lt;urn：s6&gt;'，'&lt;urn：p6&gt;'，'_：bn1'））; - 在tgraph_tpl值中添加一些四边形插入（sdo_rdf_triple_s（'tgraph：&lt;urn：g1&gt;'，'&lt;urn：s1&gt;'，'&lt;urn：p1&gt;'，'&lt;urn：o1&gt;'））;插入tgraph_tpl值（sdo_rdf_triple_s（'tgraph：&lt;urn：g2&gt;'，'&lt;urn：s1&gt;'，'&lt;urn：p1&gt;'，'&lt;urn：o1&gt;'））;插入tgraph_tpl值（sdo_rdf_triple_s（'tgraph：&lt;urn：g2&gt;'，'&lt;urn：s2&gt;'，'&lt;urn：p2&gt;'，'“hello world”'））;插入tgraph_tpl值（sdo_rdf_triple_s（'tgraph：&lt;urn：g2&gt;'，'&lt;urn：s3&gt;'，'&lt;urn：p3&gt;'，'“hello world”@en'））;插入tgraph_tpl值（sdo_rdf_triple_s（'tgraph：&lt;urn：g2&gt;'，'&lt;urn：s4&gt;'，'&lt;urn：p4&gt;'，'“o1o”^^ &lt;http://www.w3.org/ 2001 / XMLSchema的＃字符串&gt;'））;插入tgraph_tpl值（sdo_rdf_triple_s（'tgraph：&lt;urn：g2&gt;'，'&lt;urn：s4&gt;'，'&lt;urn：p4&gt;'，'“xyz”^^ &lt;http：// mytype&gt;'））;插入tgraph_tpl值（sdo_rdf_triple_s（'tgraph：&lt;urn：g2&gt;'，'&lt;urn：s5&gt;'，'&lt;urn：p5&gt;'，'“123”^^ &lt;http://www.w3.org/ 2001 / XMLSchema的＃整数&gt;'））;插入tgraph_tpl值（sdo_rdf_triple_s（'tgraph：&lt;urn：g2&gt;'，'&lt;urn：s5&gt;'，'&lt;urn：p5&gt;'，'“123.456”^^ &lt;http://www.w3.org/ 2001 / XMLSchema的＃双&gt;'））;插入tgraph_tpl值（sdo_rdf_triple_s（'tgraph：&lt;urn：g2&gt;'，'&lt;urn：s6&gt;'，'&lt;urn：p6&gt;'，'_：bn1'））;插入tgraph_tpl值（sdo_rdf_triple_s（'tgraph：&lt;urn：g2&gt;'，'&lt;urn：s7&gt;'，'&lt;urn：p7&gt;'，'“2002-10-10T12：00：00-05：00”^ ^ &lt;http://www.w3.org/2001/XMLSchema#dateTime&gt;'））;</pre><div class="example" id="GUID-996A56E5-868C-4A78-8BF7-3B51921F1DCD__BGBGIBAE">
                     <p class="titleinexample">例6-1基于SQL的图形查询</p>
                     <p><a href="rdf-suipport-for-apache-jena.html#GUID-996A56E5-868C-4A78-8BF7-3B51921F1DCD__BGBGIBAE">例6-1</a>运行纯SQL基础图查询并构造Jena对象。
                     </p><pre class="oac_no_warn" dir="ltr">iTimeout = 0; //没有时间iDOP = 1; //并行度iStartColPos = 2; queryString =“select'hello'|| rownum as extra，o。VALUE_TYPE，邻。LITERAL_TYPE，邻。LANGUAGE_TYPE，邻。LONG_VALUE，邻。来自mdsys.rdfm_tgraph的VALUE_NAME“+”，mdsys.rdf_value $ o其中g.canon_end_node_id = o.value_id“; rs = oracle.executeQuery（queryString，iTimeout，iDOP，bindValues）; while（rs.next（））{node = OracleSemIterator.retrieveNodeFromRS（rs，iStartColPos，OracleSemQueryPlan。CONST_FIVE_COL，翻译）; System.out.println（“Result”+ node.getClass（）。getName（）+“=”+ node +“”+ rs.getString（1））; }</pre><p><a href="rdf-suipport-for-apache-jena.html#GUID-996A56E5-868C-4A78-8BF7-3B51921F1DCD__BGBGIBAE">例6-1</a>可能会生成以下输出：</p><pre class="oac_no_warn" dir="ltr">结果com.hp.hpl.jena.graph。Node_URI = urn：o1 hello1结果com.hp.hpl.jena.graph。Node_URI = urn：o1 hello2结果com.hp.hpl.jena.graph。Node_Literal =“hello world”hello3结果com.hp.hpl.jena.graph。Node_Literal =“hello world”@en hello4结果com.hp.hpl.jena.graph。Node_Literal =“o1o”hello5结果com.hp.hpl.jena.graph。Node_Literal =“xyz”hello6结果com.hp.hpl.jena.graph。Node_Literal =“123”^^ http：//www.w3.org/2001/XMLSchema#decimal hello7结果com.hp.hpl.jena.graph。Node_Literal =“1.23456E2”^^ http：//www.w3.org/2001/XMLSchema#double hello8结果com.hp.hpl.jena.graph。Node_Blank = m8g3C75726E3A67323Egmbn1 hello9结果com.hp.hpl.jena.graph。Node_Literal =“2002-10-10T17：00：00Z”^^ http：//www.w3.org/2001/XMLSchema#dateTime hello10结果com.hp.hpl.jena.graph。Node_Literal =“1.23456E2”^^ http：//www.w3.org/2001/XMLSchema#double hello11结果com.hp.hpl.jena.graph。Node_URI = urn：o1 hello12结果com.hp.hpl.jena.graph。Node_Literal =“hello world”hello13结果com.hp.hpl.jena.graph。Node_Literal =“hello world”@en hello14结果com.hp.hpl.jena.graph。Node_Literal =“o1o”hello15结果com.hp.hpl.jena.graph。Node_Literal =“xyz”hello16结果com.hp.hpl.jena.graph。Node_Literal =“123”^^ http：//www.w3.org/2001/XMLSchema#decimal hello17结果com.hp.hpl.jena.graph。Node_Blank = m8mbn1 hello18</pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-996A56E5-868C-4A78-8BF7-3B51921F1DCD__BGBCBDFC">
                     <p class="titleinexample">示例6-2混合查询将SEM_MATCH与常规SQL构造混合使用</p>
                     <p><a href="rdf-suipport-for-apache-jena.html#GUID-996A56E5-868C-4A78-8BF7-3B51921F1DCD__BGBCBDFC">示例6-2</a>使用<code class="codeph">OracleSemIterator.retrieveNodeFromRS</code> API通过读取连续五列（按值类型，文字类型，语言类型，长值和值名称的确切顺序）以及执行必要的转义来构造Jena对象和对象实例化。此示例绕过SEM_MATCH并直接将图形视图与MDSYS.RDF_VALUE $连接。
                     </p><pre class="oac_no_warn" dir="ltr">iStartColPos = 1; queryString =“从表格中选择g $ RDFVTYP，g，count（1）作为cnt”+“（sem_match（'{GRAPH？G { ？s？p？o。 '，'sem_models（'tgraph'），null，null，null，null，null））“+”组由g $ RDFVTYP，g“; rs = oracle.executeQuery（queryString，iTimeout，iDOP，bindValues）;而（rs.next（））{node = OracleSemIterator.retrieveNodeFromRS（rs，iStartColPos，OracleSemQueryPlan。CONST_TWO_COL，翻译）; System.out.println（“Result”+ node.getClass（）。getName（）+“=”+ node +“”+ rs.getInt（iStartColPos + 2））; }</pre><p><a href="rdf-suipport-for-apache-jena.html#GUID-996A56E5-868C-4A78-8BF7-3B51921F1DCD__BGBCBDFC">例6-2</a>可能会生成以下输出：</p><pre class="oac_no_warn" dir="ltr">结果com.hp.hpl.jena.graph。Node_URI = urn：g2 9结果com.hp.hpl.jena.graph。Node_URI = urn：g1 1</pre><p>在<a href="rdf-suipport-for-apache-jena.html#GUID-996A56E5-868C-4A78-8BF7-3B51921F1DCD__BGBCBDFC">例6-2中</a> ：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">Oracle</code>类中的辅助函数<code class="codeph">executeQuery</code>用于运行SQL语句， <code class="codeph">OracleSemIterator.retrieveNodeFromRS</code> API（也在<a href="rdf-suipport-for-apache-jena.html#GUID-996A56E5-868C-4A78-8BF7-3B51921F1DCD__BGBGIBAE">示例6-1</a>中使用）用于构造Jena对象。
                           </p>
                        </li>
                        <li>
                           <p>输出中只使用了两列：值类型（g $ RDFVTYP）和值名称（g），众所周知，此g变量永远不能是文字RDF资源。</p>
                        </li>
                        <li>
                           <p>列顺序很重要。对于双列变量，第一列必须是值类型，第二列必须是值名称。</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-996A56E5-868C-4A78-8BF7-3B51921F1DCD__BGBHEEBA">
                     <p class="titleinexample">例6-3 SEM_MATCH查询</p>
                     <p><a href="rdf-suipport-for-apache-jena.html#GUID-996A56E5-868C-4A78-8BF7-3B51921F1DCD__BGBHEEBA">例6-3</a>运行SEM_MATCH查询并构造一个返回Jena对象列表的迭代器（ <code class="codeph">OracleSemIterator</code>实例）。
                     </p><pre class="oac_no_warn" dir="ltr">queryString =“从表格中选择g $ RDFVTYP，g，s $ RDFVTYP，s，p $ RDFVTYP，p，o $ RDFVTYP，o $ RDFLTYP，o $ RDFLANG，o $ RDFCLOB，o”+“（sem_match（'{GRAPH ？G { ？s？p？o。 '，'sem_models（'tgraph'），null，null，null，null，null））“; guide = new ArrayList &lt;String&gt;（）; guide.add（OracleSemQueryPlan。CONST_TWO_COL）; guide.add（OracleSemQueryPlan。CONST_TWO_COL）; guide.add（OracleSemQueryPlan。CONST_TWO_COL）; guide.add（OracleSemQueryPlan。CONST_FIVE_COL）; rs = oracle.executeQuery（queryString，iTimeout，iDOP，bindValues）; osi = new OracleSemIterator（rs）; osi.setGuide（引导）; osi.setTranslator（译者）; while（osi.hasNext（））{result = osi.next（）; System.out.println（“Result”+ result.getClass（）。getName（）+“=”+ result）; }</pre><p><a href="rdf-suipport-for-apache-jena.html#GUID-996A56E5-868C-4A78-8BF7-3B51921F1DCD__BGBHEEBA">例6-3</a>可能会生成以下输出：</p><pre class="oac_no_warn" dir="ltr">结果com.hp.hpl.jena.graph.query。Domain = [urn：g1，urn：s1，urn：p1，urn：o1]结果com.hp.hpl.jena.graph.query。Domain = [urn：g2，urn：s1，urn：p1，urn：o1]结果com.hp.hpl.jena.graph.query。Domain = [urn：g2，urn：s2，urn：p2，“hello world”]结果com.hp.hpl.jena.graph.query。Domain = [urn：g2，urn：s3，urn：p3，“hello world”@en]结果com.hp.hpl.jena.graph.query。Domain = [urn：g2，urn：s4，urn：p4，“o1o”]结果com.hp.hpl.jena.graph.query。Domain = [urn：g2，urn：s4，urn：p4，“xyz”]结果com.hp.hpl.jena.graph.query。Domain = [urn：g2，urn：s5，urn：p5，“123”^^ http：//www.w3.org/2001/XMLSchema#decimal]结果com.hp.hpl.jena.graph.query。Domain = [urn：g2，urn：s5，urn：p5，“1.23456E2”^^ http：//www.w3.org/2001/XMLSchema#double]结果com.hp.hpl.jena.graph.query。Domain = [urn：g2，urn：s6，urn：p6，m8g3C75726E3A67323Egmbn1]结果com.hp.hpl.jena.graph.query。Domain = [urn：g2，urn：s7，urn：p7，“2002-10-10T17：00：00Z”^^ http：//www.w3.org/2001/XMLSchema#dateTime]</pre><p>在<a href="rdf-suipport-for-apache-jena.html#GUID-996A56E5-868C-4A78-8BF7-3B51921F1DCD__BGBHEEBA">例6-3中</a> ：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">OracleSemIterator</code>接受JDBC结果集。<code class="codeph">OracleSemIterator</code>需要有关解析表示SPARQL变量绑定值的所有列的指导。指南只是字符串值的列表。已经定义了两个常量来区分2列变量（主题或谓词位置）和5列变量（对象位置）。还需要翻译。
                           </p>
                        </li>
                        <li>
                           <p>输出中使用了四个变量。前三个变量不是RDF文字资源，因此使用CONST_TWO_COL作为指导。最后一个变量可以是RDF文字资源，因此CONST_FIVE_COL用作其指南。</p>
                        </li>
                        <li>
                           <p>列顺序很重要，必须如示例所示。</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-3F437E3E-3B74-4CCF-9F16-B2B07B3899E8" title="Apache Jena的RDF语义图支持（这里也称为对Apache Jena的支持）通过实现着名的Jena Graph，Model和DatasetGraph API为Oracle Spatial和Graph RDF语义图提供了基于Java的接口。">Apache Jena的RDF语义图支持</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="RDFRM244"></a><div class="props_rev_3"><a id="GUID-F6416355-45C1-4FAF-83E4-7EBFA902EA7A" name="GUID-F6416355-45C1-4FAF-83E4-7EBFA902EA7A"></a><h3 id="RDFRM-GUID-F6416355-45C1-4FAF-83E4-7EBFA902EA7A" class="sect3"><span class="enumeration_section">6.8</span> SPARQL查询的优化处理</h3>
               <div>
                  <p>本节介绍了可以增强SPARQL查询处理的Apache Jena支持的一些与性能相关的功能。默认情况下会自动执行这些功能。</p>
                  <p>它假定您熟悉SPARQL，包括CONSTRUCT功能和属性路径。</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-981B14F0-2943-47A7-89F5-95828176E69C">将SPARQL查询编译为单个SEM_MATCH调用</a><br></li>
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-A9B1E88D-11C7-4C7F-B787-5D8EEC0D4D8A">物业路径的优化处理</a><br></li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-3F437E3E-3B74-4CCF-9F16-B2B07B3899E8" title="Apache Jena的RDF语义图支持（这里也称为对Apache Jena的支持）通过实现着名的Jena Graph，Model和DatasetGraph API为Oracle Spatial和Graph RDF语义图提供了基于Java的接口。">Apache Jena的RDF语义图支持</a></p>
                     </div>
                  </div>
               </div>
               <a id="RDFRM245"></a><div class="props_rev_3"><a id="GUID-981B14F0-2943-47A7-89F5-95828176E69C" name="GUID-981B14F0-2943-47A7-89F5-95828176E69C"></a><h4 id="RDFRM-GUID-981B14F0-2943-47A7-89F5-95828176E69C" class="sect4"><span class="enumeration_section">6.8.1</span>将SPARQL查询编译为单个SEM_MATCH调用</h4>
                  <div>
                     <p>涉及DISTINCT，OPTIONAL，FILTER，UNION，ORDER BY和LIMIT的SPARQL查询将转换为单个Oracle SEM_MATCH表函数。如果查询无法直接转换为SEM_MATCH，因为它使用SEM_MATCH不支持的SPARQL功能（例如，CONSTRUCT），则对Apache Jena的支持采用混合方法，并尝试使用单个SEM_MATCH函数执行查询的最大部分。使用Jena ARQ查询引擎执行其余的操作。</p>
                     <p>例如，以下SPARQL查询直接转换为单个SEM_MATCH表函数：</p><pre class="oac_no_warn" dir="ltr">PREFIX dc：&lt;http://purl.org/dc/elements/1.1/&gt; PREFIX rdf：&lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt; PREFIX foaf：&lt; http://xmlns.com/foaf/0.1/&gt; SELECT？人？名称WHERE {{？alice foaf：知道吗？人UNION {？人？p？名称。可选的 { ？人？X ？name1}}}</pre><p>但是，由于CONSTRUCT关键字，以下示例查询无法直接转换为单个SEM_MATCH表函数：</p><pre class="oac_no_warn" dir="ltr">PREFIX vcard：&lt;http://www.w3.org/2001/vcard-rdf/3.0#&gt; CONSTRUCT {&lt;http://example.org/person#Alice&gt; vcard：FN？obj} WHERE {{？x &lt;http：// pred / a&gt;？OBJ。}UNION {？x &lt;http：// pred / b&gt;？OBJ。}}</pre><p>在这种情况下，对Apache Jena的支持将内部UNION查询转换为单个SEM_MATCH表函数，然后将结果集传递给Jena ARQ查询引擎以进行进一步评估。</p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-F6416355-45C1-4FAF-83E4-7EBFA902EA7A" title="本节介绍了可以增强SPARQL查询处理的Apache Jena支持的一些与性能相关的功能。默认情况下会自动执行这些功能。">SPARQL查询的优化处理</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="RDFRM246"></a><div class="props_rev_3"><a id="GUID-A9B1E88D-11C7-4C7F-B787-5D8EEC0D4D8A" name="GUID-A9B1E88D-11C7-4C7F-B787-5D8EEC0D4D8A"></a><h4 id="RDFRM-GUID-A9B1E88D-11C7-4C7F-B787-5D8EEC0D4D8A" class="sect4"><span class="enumeration_section">6.8.2</span>物业路径的优化处理</h4>
                  <div>
                     <p>如Jena中所定义，属性路径是通过两个图节点之间的RDF图的可能路径。属性路径是SPARQL的扩展，并且比基本的图形模式查询更具表现力，因为正则表达式可以用于模式匹配RDF图的属性。有关属性路径的更多信息，请参阅Jena ARQ查询引擎的文档。</p>
                     <p>Apache Jena的RDF语义图支持通过与Jena ARQ查询引擎的集成支持所有Jena属性路径类型，但它将一些常见的路径类型直接转换为本机SQL分层查询（不基于SEM_MATCH）以提高性能。在处理三重数据时，Apache Jena支持将以下类型的属性路径直接转换为SQL：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>谓词替代:( p1 | p2 | ... | p <span class="italic">n</span> ）其中p <span class="italic">i</span>是属性URI</p>
                        </li>
                        <li>
                           <p>谓词序列：（p1 / p2 / ... / p <span class="italic">n</span> ）其中p <span class="italic">i</span>是属性URI</p>
                        </li>
                        <li>
                           <p>反向路径：（^ p）其中p是谓词URI</p>
                        </li>
                        <li>
                           <p>复杂路径：p +，p *，p {0， <span class="italic">n</span> }其中p可以是替代，序列，反向路径或属性URI</p>
                        </li>
                     </ul>
                     <p>无法在此语法中捕获的路径表达式不会被Apache Jena的支持直接转换为SQL，并且可以使用Jena查询引擎来回答它们。</p>
                     <p>以下示例包含使用带路径序列的属性路径表达式的代码段：</p><pre class="oac_no_warn" dir="ltr">String m =“PROP_PATH”; ModelOracleSem model = ModelOracleSem.createOracleSemModel（oracle，m）; GraphOracleSem graph = new GraphOracleSem（oracle，m）; //填充RDF Graph graph.add（Triple.create（Node.createURI（“http：// a”），Node.createURI（“http：// p1”），Node.createURI（“http：// b） “）））; graph.add（Triple.create（Node.createURI（“http：// b”），Node.createURI（“http：// p2”），Node.createURI（“http：// c”）））; graph.add（Triple.create（Node.createURI（“http：// c”），Node.createURI（“http：// p5”），Node.createURI（“http：// d”）））;字符串查询=“SELECT？s“+”WHERE {？s（&lt;http：// p1&gt; / &lt;http：// p2&gt; / &lt;http：// p5&gt;）+ &lt;http：// d&gt;。}“; QueryExecution qexec = QueryExecutionFactory.create（QueryFactory.create（query ，Syntax.syntaxARQ），model）; try {ResultSet results = qexec.execSelect（）; ResultSetFormatter.out（System.out，results）;} finally {if（qexec！= null）qexec.close（）; } OracleUtils.dropSemanticModel（oracle，m）; model.close（）;</pre></div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-F6416355-45C1-4FAF-83E4-7EBFA902EA7A" title="本节介绍了可以增强SPARQL查询处理的Apache Jena支持的一些与性能相关的功能。默认情况下会自动执行这些功能。">SPARQL查询的优化处理</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="RDFRM248"></a><div class="props_rev_3"><a id="GUID-9B0B74F2-9733-491E-A97C-BB485D33518C" name="GUID-9B0B74F2-9733-491E-A97C-BB485D33518C"></a><h3 id="RDFRM-GUID-9B0B74F2-9733-491E-A97C-BB485D33518C" class="sect3"><span class="enumeration_section">6.9</span>添加SPARQL语法以支持其他功能</h3>
               <div>
                  <p>Apache Jena的RDF语义图支持允许您传递提示和其他查询选项。它通过使用包含查询选项的特定于Oracle的命名空间重载SPARQL命名空间前缀语法来实现这些功能。</p>
                  <p>命名空间的格式为<span class="italic"><code class="codeph">PREFIX ORACLE_SEM_</code></span> xx <code class="codeph">_NS</code> ，其中<span class="italic">xx</span>表示要素的类型（例如<code class="codeph">HT</code>用于提示或<code class="codeph">AP</code>用于其他谓词）</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-4532E905-83AD-4903-8A27-458C0D261D25">SQL提示</a><br></li>
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-69EA9BB5-1703-4B38-8E7E-02A128D62F1D">在SPARQL查询中使用绑定变量</a><br></li>
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-7F91AD9F-31F5-4B99-8300-B9F0844EC270">附加WHERE子句谓词</a><br></li>
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-88A33746-DFB2-4968-9A66-90C124BCDDC6">其他查询选项</a><br></li>
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-AF240C2D-C4B3-4AD7-B593-D481400DF489">Midtier资源缓存</a><br></li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-3F437E3E-3B74-4CCF-9F16-B2B07B3899E8" title="Apache Jena的RDF语义图支持（这里也称为对Apache Jena的支持）通过实现着名的Jena Graph，Model和DatasetGraph API为Oracle Spatial和Graph RDF语义图提供了基于Java的接口。">Apache Jena的RDF语义图支持</a></p>
                     </div>
                  </div>
               </div>
               <a id="RDFRM249"></a><div class="props_rev_3"><a id="GUID-4532E905-83AD-4903-8A27-458C0D261D25" name="GUID-4532E905-83AD-4903-8A27-458C0D261D25"></a><h4 id="RDFRM-GUID-4532E905-83AD-4903-8A27-458C0D261D25" class="sect4"><span class="enumeration_section">6.9.1</span> SQL提示</h4>
                  <div>
                     <p>SQL提示可以传递给SEM_MATCH查询，包括以下形式的行：</p><pre class="oac_no_warn" dir="ltr">PREFIX ORACLE_SEM_ <span class="bold">HT</span> _NS：&lt;http://oracle.com/semtech# <span class="italic">暗示</span> &gt;</pre><p><span class="italic">提示</span>可以是SEM_MATCH支持的任何提示。例如：</p><pre class="oac_no_warn" dir="ltr">PREFIX ORACLE_SEM_HT_NS：&lt;http://oracle.com/semtech#leading(t0,t1)&gt; SELECT？书？标题？isbn WHERE {？书&lt;http：// title&gt;？标题。 ？书&lt;http：// ISBN&gt;？isbn}</pre><p>在该示例中， <code class="codeph">t0,t1</code>指的是查询中的第一和第二模式。
                     </p>
                     <p>注意与SEM_MATCH比较时指定提示的细微差别。由于命名空间值语法的限制<code class="codeph">,</code>必须使用逗号（ <code class="codeph">,</code> ）来分隔<code class="codeph">t0</code>和<code class="codeph">t1</code> （或其他提示组件）而不是空格。
                     </p>
                     <p>有关使用SQL提示的更多信息，请参阅<a href="rdf-semantic-graph-overview.html#GUID-71464CC4-1C03-48A4-9A4C-0E671FF8F16E" title="要查询语义数据，请使用SEM_MATCH表函数。">使用SEM_MATCH表函数查询语义数据</a> ，特别是有关<code class="codeph">options</code>属性中<code class="codeph">HINT0</code>关键字的材料。
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-9B0B74F2-9733-491E-A97C-BB485D33518C" title="Apache Jena的RDF语义图支持允许您传递提示和其他查询选项。它通过使用包含查询选项的特定于Oracle的命名空间重载SPARQL命名空间前缀语法来实现这些功能。">添加SPARQL语法以支持其他功能</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="RDFRM250"></a><div class="props_rev_3"><a id="GUID-69EA9BB5-1703-4B38-8E7E-02A128D62F1D" name="GUID-69EA9BB5-1703-4B38-8E7E-02A128D62F1D"></a><h4 id="RDFRM-GUID-69EA9BB5-1703-4B38-8E7E-02A128D62F1D" class="sect4"><span class="enumeration_section">6.9.2</span>在SPARQL查询中使用绑定变量</h4>
                  <div>
                     <p>在Oracle数据库中，使用绑定变量可以减少查询解析时间并提高查询效率和并发性。SPARQL查询中的绑定变量支持是通过类似于ORACLE_SEM_FS_NS的命名空间编译指示规范提供的。</p>
                     <p>考虑应用程序运行两个SPARQL查询的情况，其中第二个（查询2）取决于第一个（查询1）的部分或完整结果。一些不涉及绑定变量的方法包括：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>迭代查询1的结果并生成一组查询。（但是，此方法需要与查询1的结果数一样多的查询。）</p>
                        </li>
                        <li>
                           <p>根据查询1的结果构造SPARQL过滤器表达式。</p>
                        </li>
                        <li>
                           <p>将查询1视为子查询。</p>
                        </li>
                     </ul>
                     <p>在这种情况下，另一种方法是使用绑定变量，如以下示例场景中所示：</p><pre class="oac_no_warn" dir="ltr"><span class="bold">查询1</span> ：SELECT？x WHERE {... <span class="italic">&lt;一些复杂的查询&gt;</span> ...}; <span class="bold">问题2</span> ：SELECT？学科 ？x WHERE {？主题&lt;urn：related&gt;？X 。};</pre><p>以下示例显示了查询2，其中包含使用绑定变量和Apache Jena支持的语法：</p><pre class="oac_no_warn" dir="ltr">PREFIX ORACLE_SEM_FS_NS：&lt;http://oracle.com/semtech#no_fall_back,s2s&gt; PREFIX <span class="bold">ORACLE_SEM_UEAP_NS</span> ：&lt;http://oracle.com/semtech#x$RDFVID%20in（ <span class="bold">？，？，？</span> ）&gt; PREFIX <span class="bold">ORACLE_SEM_UEPJ_NS</span> ：&lt;http ：//oracle.com/semtech#x <span class="bold">$ RDFVID</span> &gt; PREFIX <span class="bold">ORACLE_SEM_UEBV_NS</span> ：&lt;http://oracle.com/semtech# <span class="bold">1,2,3</span> &gt; SELECT？学科 ？x WHERE {？主题&lt;urn：related&gt;？X };</pre><p>此语法包括使用以下命名空间：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>ORACLE_SEM_UEAP_NS与ORACLE_SEM_AP_NS类似，但ORACLE_SEM_UEAP_NS的值部分是URL编码。在使用值部分之前，必须对其进行URL解码，然后将其视为SPARQL查询的附加谓词。</p>
                           <p>在此示例中，在URL解码之后，此ORACLE_SEM_UEAP_NS前缀的值部分（在<code class="codeph">#</code>字符后面）变为“ <code class="codeph">x$RDFVID in(?,?,?)</code>”。这三个问号意味着对来自查询1的三个值的绑定。
                           </p>
                        </li>
                        <li>
                           <p>ORACLE_SEM_UEPJ_NS指定所涉及的其他预测。在这种情况下，因为ORACLE_SEM_UEAP_NS引用了x $ RDFVID列，该列未出现在查询的SELECT子句中，所以必须指定它。多个投影以逗号分隔。</p>
                        </li>
                        <li>
                           <p>ORACLE_SEM_UEBV_NS指定首先进行URL编码的绑定值列表，然后用逗号连接和分隔。</p>
                        </li>
                     </ul>
                     <p>从概念上讲，前面的示例查询等效于以下非SPARQL语法查询，其中1,2和3被视为绑定值：</p><pre class="oac_no_warn" dir="ltr">选择 ？学科 ？x WHERE {？主题&lt;urn：related&gt;？x} AND？x $ RDFVID in（1,2,3）;</pre><p>在前面的查询2的SPARQL示例中，三个整数1,2和3来自查询1。您可以使用<code class="codeph">oext:build-uri-for-id</code>函数为RDF资源生成此类内部整数ID。以下示例从Query 1获取内部整数ID：</p><pre class="oac_no_warn" dir="ltr">PREFIX oext：&lt;http://oracle.com/semtech/jena-adaptor/ext/function#&gt; SELECT？x（ <span class="bold">oext：build-uri-for-id（？x）</span>为<span class="bold">？xid</span> ）WHERE {... <span class="italic">&lt;一些复杂的查询&gt;</span> ...};</pre><p>价值观<code class="codeph">?xid</code>的格式为&lt;rdfvid： <span class="italic">integer-value</span> &gt;。应用程序可以删除尖括号和“rdfvid：”字符串以获取整数值并将它们传递给查询2。
                     </p>
                     <p>考虑另一种情况，使用单个查询结构但可能有许多不同的常量。例如，以下SPARQL查询查找具有业余爱好并登录到应用程序的每个用户的爱好。显然，不同的用户将为此SPARQL查询提供不同的&lt;uri&gt;值，因为应用程序的用户使用不同的URI表示。</p><pre class="oac_no_warn" dir="ltr">选择 ？爱好在哪里{&lt;uri&gt; &lt;urn：hasHobby&gt;？爱好};</pre><p>一种不使用绑定变量的方法是为每个不同的&lt;uri&gt;值生成不同的SPARQL查询。例如，用户Jane Doe可能会触发执行以下SPARQL查询：</p><pre class="oac_no_warn" dir="ltr">选择 ？hobby {&lt;http://www.example.com/Jane_Doe&gt; &lt;urn：hasHobby&gt;？爱好};</pre><p>但是，另一种方法是使用绑定变量，如下面的示例指定用户Jane Doe：</p><pre class="oac_no_warn" dir="ltr">PREFIX ORACLE_SEM_FS_NS：&lt;http://oracle.com/semtech#no_fall_back,s2s&gt; PREFIX ORACLE_SEM_UEAP_NS：&lt;http://oracle.com/semtech#subject$RDFVID%20in（ORACLE_ORARDF_RES2VID（？））&gt; PREFIX ORACLE_SEM_UEPJ_NS：&lt;http： //oracle.com/semtech#subject$RDFVID&gt; PREFIX ORACLE_SEM_UEBV_NS：&lt;http://oracle.com/semtech#http%3a%2f%2fwww.example.com%2fJohn_Doe&gt; SELECT？学科 ？爱好哪里{？subject &lt;urn：hasHobby&gt;？爱好};</pre><p>从概念上讲，前面的示例查询等效于以下非SPARQL语法查询，其中<code class="codeph">http://www.example.com/Jane_Doe</code>被视为绑定变量：</p><pre class="oac_no_warn" dir="ltr">选择 ？学科 ？爱好哪里{？subject &lt;urn：hasHobby&gt;？爱好}和？subject $ RDFVID in（ORACLE_ORARDF_RES2VID（'http://www.example.com/Jane_Doe'））;</pre><p>在此示例中，ORACLE_ORARDF_RES2VID是将URI和文字转换为其内部整数ID表示的函数。当使用Apache Jena支持连接到Oracle数据库时，将自动创建此函数。</p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-9B0B74F2-9733-491E-A97C-BB485D33518C" title="Apache Jena的RDF语义图支持允许您传递提示和其他查询选项。它通过使用包含查询选项的特定于Oracle的命名空间重载SPARQL命名空间前缀语法来实现这些功能。">添加SPARQL语法以支持其他功能</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="RDFRM251"></a><div class="props_rev_3"><a id="GUID-7F91AD9F-31F5-4B99-8300-B9F0844EC270" name="GUID-7F91AD9F-31F5-4B99-8300-B9F0844EC270"></a><h4 id="RDFRM-GUID-7F91AD9F-31F5-4B99-8300-B9F0844EC270" class="sect4"><span class="enumeration_section">6.9.3</span>附加WHERE子句谓词</h4>
                  <div>
                     <p>SEM_MATCH <code class="codeph">filter</code>属性可以将不同的选择条件指定为WHERE子句形式的字符串，而不使用WHERE关键字。可以将其他WHERE子句谓词传递给SEM_MATCH查询，该查询包括以下格式的行：</p><pre class="oac_no_warn" dir="ltr">PREFIX ORACLE_SEM_ <span class="bold">AP</span> _NS：&lt;http://oracle.com/semtech# <span class="italic">pred</span> &gt;</pre><p>其中<span class="italic">pred</span>反映了要附加到查询的WHERE子句内容。例如：</p><pre class="oac_no_warn" dir="ltr">PREFIX rdfs：&lt;http://www.w3.org/2000/01/rdf-schema#&gt; PREFIX ORACLE_SEM_AP_NS：&lt;http://www.oracle.com/semtech#label$RDFLANG='fr'&gt; SELECT DISTINCT？inst？标签WHERE {？inst a &lt;http：// someCLass&gt;。 ？inst rdfs：label？标签 。ORDER BY（？标签）限制20</pre><p>在此示例中，向查询添加限制，标签变量的语言类型必须为<code class="codeph">'fr'</code> 。
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-9B0B74F2-9733-491E-A97C-BB485D33518C" title="Apache Jena的RDF语义图支持允许您传递提示和其他查询选项。它通过使用包含查询选项的特定于Oracle的命名空间重载SPARQL命名空间前缀语法来实现这些功能。">添加SPARQL语法以支持其他功能</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="RDFRM252"></a><div class="props_rev_3"><a id="GUID-88A33746-DFB2-4968-9A66-90C124BCDDC6" name="GUID-88A33746-DFB2-4968-9A66-90C124BCDDC6"></a><h4 id="RDFRM-GUID-88A33746-DFB2-4968-9A66-90C124BCDDC6" class="sect4"><span class="enumeration_section">6.9.4</span>其他查询选项</h4>
                  <div>
                     <p>其他查询选项可以传递给SEM_MATCH查询，包括以下格式的行：</p><pre class="oac_no_warn" dir="ltr">PREFIX ORACLE_SEM_ <span class="bold">FS</span> _NS：&lt;http://oracle.com/semtech# <span class="italic">option</span> &gt;</pre><p>其中<span class="italic">option</span>反映了要附加到查询的查询选项（或由逗号分隔的多个查询选项）。例如：</p><pre class="oac_no_warn" dir="ltr">PREFIX ORACLE_SEM_FS_NS：&lt;http://oracle.com/semtech#timeout=3,dop=4,INF_ONLY,ORDERED,ALLOW_DUP=T&gt; SELECT * WHERE {？学科 ？财产？对象}</pre><p>支持以下查询选项：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">ALLOW_DUP=t</code>选择更快的方式来查询多个语义模型，尽管可能会出现重复的结果。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">BEST_EFFORT_QUERY=t</code> ，当与<code class="codeph">TIMEOUT=</code> <span class="italic"><code class="codeph">n</code></span>选项一起使用时，返回SPARQL查询在<span class="italic">n</span>秒内找到的所有匹配项。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">DEGREE=</code> <span class="italic">n</span>在语句级别指定查询的并行度（ <span class="italic">n</span> ）。对于多核或多CPU处理器，尝试使用不同的<code class="codeph">DOP</code>值（例如4或8）可以提高性能。
                           </p>
                           <p>对比<code class="codeph">DEGREE</code>与<code class="codeph">DOP</code> ，指定在会话级并行性。建议使用<code class="codeph">DEGREE</code>而不是<code class="codeph">DOP</code> ，以支持Apache Jena，因为<code class="codeph">DEGREE</code>涉及较少的处理开销。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">DOP=</code> <span class="italic">n</span>在会话级别指定查询的并行度（ <span class="italic">n</span> ）。对于多核或多CPU处理器，尝试使用不同的<code class="codeph">DOP</code>值（例如4或8）可以提高性能。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">INF_ONLY</code>仅导致查询推断的模型。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">JENA_EXECUTOR</code>禁止将SPARQL查询编译为SEM_MATCH（或本机SQL）;相反，将使用Jena本机查询执行程序。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">JOIN=</code> <span class="italic"><code class="codeph">n</code></span>指定从SPARQL SERVICE调用到联合查询的结果如何与查询的其他部分连接。有关联合查询和<code class="codeph">JOIN</code>选项的信息，请参阅<a href="rdf-suipport-for-apache-jena.html#GUID-4082C47A-EBE9-4659-B24B-C97624CD96A1">JOIN选项和联合查询</a> 。
                           </p>
                        </li>
                        <li>
                           <p>如果发生SQL异常， <code class="codeph">NO_FALL_BACK</code>会导致底层查询执行引擎不依赖于Jena执行机制。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">ODS=</code> <span class="italic"><code class="codeph">n</code></span>在语句级别指定动态采样的级别。（有关动态采样的说明，请参阅“ <a href="../tgsql/options-for-optimizer-statistics-gathering.html#TGSQL450" target="_blank"><span class="italic">Oracle数据库SQL调优指南”中</span></a>有关使用动态采样估计统计信息的部分。）<span class="italic">n的</span>有效值为1到10。例如，您可以尝试使用<code class="codeph">ODS=3</code>进行复杂查询。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">ORDERED</code>被转换为查询三元模式连接的LEADING SQL提示，同时最后执行必要的RDF_VALUE $连接。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">PLAIN_SQL_OPT=F</code>禁用查询的本机编译直接到SQL。</p>
                        </li>
                        <li>
                           <p><code class="codeph">QID=</code> <span class="italic">n</span>指定查询ID号;如果查询没有响应，此功能可用于取消查询。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">RESULT_CACHE</code>使用Oracle RESULT_CACHE指令进行查询。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">REWRITE=F</code>禁用SEM_MATCH表函数的ODCI_Table_Rewrite。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">S2S</code> （SPARQL到纯SQL）导致基于SEM_MATCH的查询或基于SPARQL查询生成的查询在<span class="italic"><span class="bold">不</span></span>使用SEM_MATCH表函数的<span class="italic"><span class="bold">情况下</span></span>进一步转换为SQL查询。生成的SQL查询由Oracle基于成本的优化器执行，结果由Apache Jena支持处理，然后传递给客户端。有关<code class="codeph">S2S</code>选项的更多信息，包括优势和使用信息，请参阅<a href="rdf-suipport-for-apache-jena.html#GUID-892FF8C6-4DCE-4568-A3AD-3B674D98EC2F">S2S选件优点和使用信息</a> 。
                           </p>
                           <p>默认情况下，为所有SPARQL查询启用<code class="codeph">S2S</code> 。如果要禁用<code class="codeph">S2S</code> ，请设置以下JVM系统属性：</p><pre class="oac_no_warn" dir="ltr">-Doracle.spatial.rdf.client.jena.defaultS2S = FALSE</pre></li>
                        <li>
                           <p><code class="codeph">SKIP_CLOB=T</code>导致不为查询返回CLOB值。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">STRICT_DEFAULT=F</code>允许默认图形在命名图形中包含三元组。（默认情况下，当未指定数据集信息时， <code class="codeph">STRICT_DEFAULT=T</code>将默认图形限制为未命名的三元组。）
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">TIMEOUT=</code> <span class="italic"><code class="codeph">n</code></span> （查询超时）指定查询在终止之前将运行的秒数（ <span class="italic">n</span> ）。从SPARQL查询生成的基础SQL可以返回许多匹配，并且可以使用子查询和分配等功能，所有这些都可能需要相当长的时间。<code class="codeph">TIMEOUT</code>和<code class="codeph">BEST_EFFORT_QUERY=t</code>选项可用于防止您认为查询的处理时间过长。
                           </p>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-4082C47A-EBE9-4659-B24B-C97624CD96A1">JOIN选项和联合查询</a><br></li>
                        <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-892FF8C6-4DCE-4568-A3AD-3B674D98EC2F">S2S选项权益和使用信息</a><br></li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-9B0B74F2-9733-491E-A97C-BB485D33518C" title="Apache Jena的RDF语义图支持允许您传递提示和其他查询选项。它通过使用包含查询选项的特定于Oracle的命名空间重载SPARQL命名空间前缀语法来实现这些功能。">添加SPARQL语法以支持其他功能</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="RDFRM253"></a><div class="props_rev_3"><a id="GUID-4082C47A-EBE9-4659-B24B-C97624CD96A1" name="GUID-4082C47A-EBE9-4659-B24B-C97624CD96A1"></a><h5 id="RDFRM-GUID-4082C47A-EBE9-4659-B24B-C97624CD96A1" class="sect5"><span class="enumeration_section">6.9.4.1</span> JOIN选项和联合查询</h5>
                     <div>
                        <p>如W3C文档中所述，SPARQL联合查询是“通过分布式数据”的查询，其需要“查询一个源并使用所获取的信息来约束下一个源的查询”。有关更多信息，请参阅<span class="italic">SPARQL 1.1 Federation Extensions</span> （ <a href="http://www.w3.org/2009/sparql/docs/fed/service" target="_blank"><code class="codeph">http://www.w3.org/2009/sparql/docs/fed/service</code></a> ）。</p>
                        <p>您可以在使用Apache Jena支持的联合查询中使用JOIN选项（在<a href="rdf-suipport-for-apache-jena.html#GUID-88A33746-DFB2-4968-9A66-90C124BCDDC6">Additional Query Options中</a>描述）和SERVICE关键字。例如，假设以下查询：</p><pre class="oac_no_warn" dir="ltr">选择 ？s？s1？在哪里{？s1？p1？s。{SERVICE &lt;http://sparql.org/books&gt; {？s？p？o}}}</pre><p>如果是<span class="italic">本地</span>查询部分（ <code class="codeph">?s1？p1？s,</code> ）非常有选择性，你可以指定<code class="codeph">join=2</code> ，如下面的查询所示：</p><pre class="oac_no_warn" dir="ltr">PREFIX ORACLE_SEM_FS_NS：&lt;http://oracle.com/semtech# <span class="bold">join = 2</span> &gt; SELECT？s？s1？在哪里{？s1？p1？s。{SERVICE &lt;http://sparql.org/books&gt; {？s？p？o}}}</pre><p>在这种情况下，本地查询部分（ <code class="codeph">?s1？p1？s,</code> ）在本地针对Oracle数据库执行。每个绑定<code class="codeph">?然后将结果中的s</code>推送到SERVICE部分（远程查询部分），并调用指定的服务端点。从概念上讲，这种方法有点像嵌套循环连接。
                        </p>
                        <p>如果<span class="italic">远程</span>查询部分（ <code class="codeph">?s？s1？o</code> ）非常有选择性，你可以指定<code class="codeph">join=3</code> ，如下面的查询所示，这样首先执行远程部分，结果用于驱动本地部分的执行：</p><pre class="oac_no_warn" dir="ltr">PREFIX ORACLE_SEM_FS_NS：&lt;http://oracle.com/semtech# <span class="bold">join = 3</span> &gt; SELECT？s？s1？在哪里{？s1？p1？s。{SERVICE &lt;http://sparql.org/books&gt; {？s？p？o}}}</pre><p>在这种情况下，对远程服务端点进行单次调用并且每次绑定<code class="codeph">?s</code>触发本地查询。与<code class="codeph">join=2</code> ，此方法在概念上是基于嵌套循环的连接，但不同之处在于切换顺序。
                        </p>
                        <p>如果本地查询部分和远程查询部分都没有选择性，那么我们可以选择join = 1，如下面的查询所示：</p><pre class="oac_no_warn" dir="ltr">PREFIX ORACLE_SEM_FS_NS：&lt;http://oracle.com/semtech# <span class="bold">join = 1</span> &gt; SELECT？s？s1？在哪里{？s1？p1？s。{SERVICE &lt;http://sparql.org/books&gt; {？s？p？o}}}</pre><p>在这种情况下，远程查询部分和本地部分是独立执行的，结果由Jena连接在一起。从概念上讲，这种方法有点像散列连接。</p>
                        <p>要调试或跟踪联合查询，可以使用Oracle JDeveloper中的HTTP Analyzer查看基础SERVICE调用。</p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-88A33746-DFB2-4968-9A66-90C124BCDDC6">其他查询选项</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="RDFRM254"></a><div class="props_rev_3"><a id="GUID-892FF8C6-4DCE-4568-A3AD-3B674D98EC2F" name="GUID-892FF8C6-4DCE-4568-A3AD-3B674D98EC2F"></a><h5 id="RDFRM-GUID-892FF8C6-4DCE-4568-A3AD-3B674D98EC2F" class="sect5"><span class="enumeration_section">6.9.4.2</span> S2S选项权益和使用信息</h5>
                     <div>
                        <p><a href="rdf-suipport-for-apache-jena.html#GUID-88A33746-DFB2-4968-9A66-90C124BCDDC6">附加查询选项中</a>描述的<code class="codeph">S2S</code>选项提供以下潜在优势：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>它适用于<code class="codeph">RESULT_CACHE</code>选项以提高查询性能。使用<code class="codeph">S2S</code>和<code class="codeph">RESULT_CACHE</code>选项对于频繁执行的查询特别有用。
                              </p>
                           </li>
                           <li>
                              <p>它减少了SEM_MATCH表函数的解析时间，这对涉及许多动态生成的SPARQL查询的应用程序很有帮助。</p>
                           </li>
                           <li>
                              <p>它消除了查询主体（SEM_MATCH表函数的第一个参数）的4000字节限制，这意味着支持更长，更复杂的查询。</p>
                           </li>
                        </ul>
                        <p>S2S选项导致内部内存缓存用于转换的SQL查询语句。此内部缓存的默认大小为1024（即1024个SQL查询）;但是，您可以使用以下Java VM属性调整大小：</p><pre class="oac_no_warn" dir="ltr">-Doracle.spatial.rdf.client.jena.queryCacheSize = <span class="italic">&lt;size&gt;</span></pre></div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-88A33746-DFB2-4968-9A66-90C124BCDDC6">其他查询选项</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div><a id="RDFRM255"></a><div class="props_rev_3"><a id="GUID-AF240C2D-C4B3-4AD7-B593-D481400DF489" name="GUID-AF240C2D-C4B3-4AD7-B593-D481400DF489"></a><h4 id="RDFRM-GUID-AF240C2D-C4B3-4AD7-B593-D481400DF489" class="sect4"><span class="enumeration_section">6.9.5</span>中间资源缓存</h4>
                  <div>
                     <p>当存储语义数据时，将所有资源值散列为ID，这些ID存储在三元组表中。从值ID到完整资源值的映射存储在MDSYS.RDF_VALUE $表中。在查询时，对于每个选定的变量，Oracle数据库必须与RDF_VALUE $表执行连接以检索资源。</p>
                     <p>但是，要减少连接数，可以使用midtier缓存选项，这会导致中间层上的内存缓存用于存储值ID和资源值之间的映射。要使用此功能，请在SPARQL查询中包含以下PREFIX编译指示：</p><pre class="oac_no_warn" dir="ltr">PREFIX ORACLE_SEM_FS_NS：&lt;http://oracle.com/semtech#midtier_cache&gt;</pre><p>要控制内存高速缓存的最大大小（以字节为单位），请使用<code class="codeph">oracle.spatial.rdf.client.jena.cacheMaxSize</code>系统属性。默认缓存最大大小为1GB。</p>
                     <p>对于使用ORDER BY或DISTINCT（或两者）构造的查询或具有多个投影变量的查询，中间层资源缓存最有效。中间缓存可以与<a href="rdf-suipport-for-apache-jena.html#GUID-88A33746-DFB2-4968-9A66-90C124BCDDC6">其他查询选项中</a>指定的其他选项组合使用。
                     </p>
                     <p>如果你想预填充所有资源的高速缓存中的模型，使用<code class="codeph">GraphOracleSem.populateCache</code>或<code class="codeph">DatasetGraphOracleSem.populateCache</code>方法。两种方法都使用一个参数来指定用于构建内部中间层缓存的线程数。并行运行任一方法都可以显着提高具有多个CPU（内核）的计算机上的缓存构建性能。
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-9B0B74F2-9733-491E-A97C-BB485D33518C" title="Apache Jena的RDF语义图支持允许您传递提示和其他查询选项。它通过使用包含查询选项的特定于Oracle的命名空间重载SPARQL命名空间前缀语法来实现这些功能。">添加SPARQL语法以支持其他功能</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="RDFRM256"></a><div class="props_rev_3"><a id="GUID-D7D68CA5-24BF-4546-8679-8AF4AA96C38C" name="GUID-D7D68CA5-24BF-4546-8679-8AF4AA96C38C"></a><h3 id="RDFRM-GUID-D7D68CA5-24BF-4546-8679-8AF4AA96C38C" class="sect3"><span class="enumeration_section">6.10</span> SPARQL查询支持的功能通过RDF语义图支持Apache Jena</h3>
               <div>
                  <p>通过支持Apache Jena的SPARQL查询可以使用以下几种功能。</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>Jena ARQ查询引擎的函数库中的函数</p>
                     </li>
                     <li>
                        <p>用于投影变量的原生Oracle数据库函数</p>
                     </li>
                     <li>
                        <p>用户定义的函数</p>
                     </li>
                  </ul>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-353E37B3-DBF6-4BDF-B722-9384FB75DDD3">ARQ函数库中的函数</a><br></li>
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-4952479F-822D-444E-93EC-F06D40BC422C">用于投影变量的原生Oracle数据库函数</a><br></li>
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-199B0235-0ACC-43CD-842E-C3A8891E9197">用户定义的函数</a><br></li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-3F437E3E-3B74-4CCF-9F16-B2B07B3899E8" title="Apache Jena的RDF语义图支持（这里也称为对Apache Jena的支持）通过实现着名的Jena Graph，Model和DatasetGraph API为Oracle Spatial和Graph RDF语义图提供了基于Java的接口。">Apache Jena的RDF语义图支持</a></p>
                     </div>
                  </div>
               </div>
               <a id="RDFRM257"></a><div class="props_rev_3"><a id="GUID-353E37B3-DBF6-4BDF-B722-9384FB75DDD3" name="GUID-353E37B3-DBF6-4BDF-B722-9384FB75DDD3"></a><h4 id="RDFRM-GUID-353E37B3-DBF6-4BDF-B722-9384FB75DDD3" class="sect4"><span class="enumeration_section">6.10.1</span> ARQ函数库中的函数</h4>
                  <div>
                     <p>通过对Apache Jena的支持，SPARQL查询可以使用Jena ARQ查询引擎的函数库中的函数。这些查询在中间层执行。</p>
                     <p>以下示例使用<code class="codeph">upper-case</code>和<code class="codeph">namespace</code>函数。在这些示例中，前缀<code class="codeph">fn</code>是<code class="codeph">&lt;http://www.w3.org/2005/xpath-functions#&gt;</code> ，前缀<code class="codeph">afn</code>是<code class="codeph">&lt;http://jena.hpl.hp.com/ARQ/function#&gt;</code> 。</p><pre class="oac_no_warn" dir="ltr">PREFIX fn：&lt;http://www.w3.org/2005/xpath-functions#&gt; PREFIX afn：&lt;http://jena.hpl.hp.com/ARQ/function#&gt; SELECT（fn：upper-case（ ？对象）为？object1）WHERE {？主题DC：标题？对象} PREFIX fn：&lt;http://www.w3.org/2005/xpath-functions#&gt; PREFIX afn：&lt;http://jena.hpl.hp.com/ARQ/function#&gt; SELECT？subject（afn：namespace（？对象）为？object1）WHERE {？主题&lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#type&gt;？对象}</pre></div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-D7D68CA5-24BF-4546-8679-8AF4AA96C38C" title="通过支持Apache Jena的SPARQL查询可以使用以下几种功能。">SPARQL查询中支持的功能通过RDF对Apache Jena的语义图支持</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="RDFRM258"></a><div class="props_rev_3"><a id="GUID-4952479F-822D-444E-93EC-F06D40BC422C" name="GUID-4952479F-822D-444E-93EC-F06D40BC422C"></a><h4 id="RDFRM-GUID-4952479F-822D-444E-93EC-F06D40BC422C" class="sect4"><span class="enumeration_section">6.10.2</span>预测变量的本机Oracle数据库函数</h4>
                  <div>
                     <p>通过对Apache Jena的支持，SPARQL查询可以将本机Oracle数据库函数用于预计变量。这些查询和函数在数据库中执行。请注意，本节中描述的功能不应与ARQ功能一起使用（ <a href="rdf-suipport-for-apache-jena.html#GUID-353E37B3-DBF6-4BDF-B722-9384FB75DDD3">在ARQ功能库</a>中的<a href="rdf-suipport-for-apache-jena.html#GUID-353E37B3-DBF6-4BDF-B722-9384FB75DDD3">功能中进行了</a>介绍）。
                     </p>
                     <p>本节列出了支持的本机函数，并提供了一些示例。在示例中，前缀<code class="codeph">oext</code>是<code class="codeph">&lt;http://oracle.com/semtech/jena-adaptor/ext/function#&gt;</code> 。</p>
                     <div class="infoboxnote" id="GUID-4952479F-822D-444E-93EC-F06D40BC422C__GUID-2EA8D15C-93ED-4FF5-B71F-4B2007017E99">
                        <p class="notep1">注意：</p>
                        <p>在前面的URL中，请注意拼写<code class="codeph">jena-adapt</code> <span class="bold"><code class="codeph">or</code></span> ，为了与现有应用程序兼容而保留，并且必须在查询中使用。在<span class="italic">适应</span> <span class="italic"><span class="bold">ER</span></span>拼写在常规文本中，按照Oracle文档风格指南。
                        </p>
                     </div>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><span class="bold"><code class="codeph">oext:upper-literal</code></span>将文字值（长文字除外）转换为大写。例如：</p><pre class="oac_no_warn" dir="ltr">PREFIX oext：&lt;http://oracle.com/semtech/jena-adaptor/ext/function#&gt; SELECT（oext：upper-literal（？对象）为？object1）WHERE {？主题DC：标题？对象}</pre></li>
                        <li>
                           <p><span class="bold"><code class="codeph">oext:lower-literal</code></span>将文字值（长文字除外）转换为小写。例如：</p><pre class="oac_no_warn" dir="ltr">PREFIX oext：&lt;http://oracle.com/semtech/jena-adaptor/ext/function#&gt; SELECT（oext：lower-literal（？对象）为？object1）WHERE {？主题DC：标题？对象}</pre></li>
                        <li>
                           <p><span class="bold"><code class="codeph">oext:build-uri-for-id</code></span>将URI，bNode或literal的值ID转换为URI表单。例如：</p><pre class="oac_no_warn" dir="ltr">PREFIX oext：&lt;http://oracle.com/semtech/jena-adaptor/ext/function#&gt; SELECT（oext：build-uri-for-id（？对象）为？object1）WHERE {？主题DC：标题？对象}</pre><p>输出的示例可能是： <code class="codeph">&lt;rdfvid:1716368199350136353&gt;</code></p>
                           <p>此函数的一个用途是允许Java应用程序在内存中维护这些值ID到URI，bNode或文字的词法形式的映射。MDSYS.RDF_VALUE $表在Oracle数据库中提供了这样的映射。</p>
                           <p>对于给定的变量<code class="codeph">?var</code> ，如果只有<code class="codeph">oext:build-uri-for-id(?var)</code>是预测的，查询性能可能会更快，因为需要更少的内部表连接操作来回答查询。
                           </p>
                        </li>
                        <li>
                           <p><span class="bold"><code class="codeph">oext:literal-strlen</code></span>返回文字值的长度（长文字除外）。例如：</p><pre class="oac_no_warn" dir="ltr">PREFIX oext：&lt;http://oracle.com/semtech/jena-adaptor/ext/function#&gt; SELECT（oext：literal-strlen（？对象）为？objlen）哪里{？主题DC：标题？对象}</pre></li>
                     </ul>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-D7D68CA5-24BF-4546-8679-8AF4AA96C38C" title="通过支持Apache Jena的SPARQL查询可以使用以下几种功能。">SPARQL查询中支持的功能通过RDF对Apache Jena的语义图支持</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="RDFRM260"></a><a id="RDFRM259"></a><div class="props_rev_3"><a id="GUID-199B0235-0ACC-43CD-842E-C3A8891E9197" name="GUID-199B0235-0ACC-43CD-842E-C3A8891E9197"></a><h4 id="RDFRM-GUID-199B0235-0ACC-43CD-842E-C3A8891E9197" class="sect4"><span class="enumeration_section">6.10.3</span>用户定义的函数</h4>
                  <div>
                     <p>通过对Apache Jena的支持，SPARQL查询可以使用存储在数据库中的用户定义函数。</p>
                     <p>在下面的示例中，假设您要定义一个字符串长度函数（ <code class="codeph">my_strlen</code> ）来处理长文字（CLOB）以及短文字。在SPARQL查询端，可以在<code class="codeph">ouext</code>的命名空间下引用此函数，该命名空间为<code class="codeph">http://oracle.com/semtech/jena-adaptor/ext/user-def-function#</code> 。</p><pre class="oac_no_warn" dir="ltr">PREFIX ouext：&lt;http://oracle.com/semtech/jena-adaptor/ext/user-def-function#&gt; SELECT？学科 ？对象（ouext：my_strlen（？对象）为？obj1）WHERE {？主题DC：标题？对象}</pre><p>在数据库内部，定义了包括<code class="codeph">my_strlen</code> ， <code class="codeph">my_strlen_cl</code> ， <code class="codeph">my_strlen_la</code> ， <code class="codeph">my_strlen_lt</code>和<code class="codeph">my_strlen_vt</code>的函数来实现此功能。从概念上讲，这些函数的返回值如<a href="rdf-suipport-for-apache-jena.html#GUID-199B0235-0ACC-43CD-842E-C3A8891E9197__CBBJIJEE" title="my_strlen示例的函数和返回值的映射">表6-1</a>所示进行映射。
                     </p>
                     <div class="tblformal" id="GUID-199B0235-0ACC-43CD-842E-C3A8891E9197__CBBJIJEE">
                        <p class="titleintable">表6-1 my_strlen的函数和返回值示例</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="my_strlen示例的函数和返回值" width="100%" border="1" summary="Mapping of functions and return values for my_strlen example" frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="27%" id="d44532e4236">功能名称</th>
                                 <th align="left" valign="bottom" width="73%" id="d44532e4239">回报价值</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="27%" id="d44532e4244" headers="d44532e4236 ">
                                    <p>my_strlen</p>
                                 </td>
                                 <td align="left" valign="top" width="73%" headers="d44532e4244 d44532e4239 ">
                                    <p>&lt;VAR&gt;</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="27%" id="d44532e4251" headers="d44532e4236 ">
                                    <p>my_strlen_cl</p>
                                 </td>
                                 <td align="left" valign="top" width="73%" headers="d44532e4251 d44532e4239 ">
                                    <p>&lt;VAR&gt; $ RDFCLOB</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="27%" id="d44532e4258" headers="d44532e4236 ">
                                    <p>my_strlen_la</p>
                                 </td>
                                 <td align="left" valign="top" width="73%" headers="d44532e4258 d44532e4239 ">
                                    <p>&lt;VAR&gt; $ RDFLANG</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="27%" id="d44532e4265" headers="d44532e4236 ">
                                    <p>my_strlen_lt</p>
                                 </td>
                                 <td align="left" valign="top" width="73%" headers="d44532e4265 d44532e4239 ">
                                    <p>&lt;VAR&gt; $ RDFLTYP</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="27%" id="d44532e4272" headers="d44532e4236 ">
                                    <p>my_strlen_vt</p>
                                 </td>
                                 <td align="left" valign="top" width="73%" headers="d44532e4272 d44532e4239 ">
                                    <p>&lt;VAR&gt; $ RDFVTYP</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p>一组函数（总共五个）用于实现可以从SPARQL引用的用户定义函数，因为这与RDF资源的内部表示（在MDSYS.RDF_VALUE $中）对齐。根据其值，语言，文字类型，长值和值类型，有五个主要列描述RDF资源，可以使用SEM_MATCH选择这五个列。在此上下文中，用户定义的函数只是将一个由五列表示的RDF资源转换为另一个RDF资源。</p>
                     <p>这些功能定义如下：</p><pre class="oac_no_warn" dir="ltr">创建或替换函数<span class="bold">my_strlen</span> （varchar2中的rdfvtyp，varchar2中的rdfltyp，varchar2中的rdflang，clob中的rdfclob，varchar2中的值）return varchar2 as ret_val varchar2（4000）; begin  -  value if（rdfvtyp ='LIT'）then if（rdfclob为null）则返回length（value）; else返回dbms_lob.getlength（rdfclob）;万一; else  - 为非文字值指定-1，以便应用程序可以 - 轻松区分返回'-1';万一;结束; /创建或替换函数<span class="bold">my_strlen_cl</span> （varchar2中的rdfvtyp，varchar2中的rdfltyp，varchar2中的rdflang，clob中的rdfclob，varchar2中的值）return clob as begin return null;结束; /创建或替换函数<span class="bold">my_strlen_la</span> （varchar2中的rdfvtyp，varchar2中的rdfltyp，varchar2中的rdflang，clob中的rdfclob，varchar2中的值）return varchar2 as begin return null;结束; / create或replace函数<span class="bold">my_strlen_lt</span> （varchar2中的rdfvtyp，varchar2中的rdfltyp，varchar2中的rdflang，clob中的rdfclob，varchar2中的值）return varchar2 as ret_val varchar2（4000）; begin  -  literal type return'http：//www.w3.org/2001/XMLSchema#integer';结束; /创建或替换函数<span class="bold">my_strlen_vt</span> （varchar2中的rdfvtyp，varchar2中的rdfltyp，varchar2中的rdflang，clob中的rdfclob，varchar2中的值）将varchar2作为ret_val返回varchar2（3）;开始返回'LIT';结束; /</pre><p>用户定义的函数也可以接受VARCHAR2类型的参数。以下五个函数一起定义了一个<code class="codeph">my_shorten_str</code>函数，该函数接受子字符串长度的整数（以VARCHAR2形式）并返回子字符串。（此示例中的子字符串为12个字符，且不得超过4000个字节。）
                     </p><pre class="oac_no_warn" dir="ltr">-  SPARQL查询，返回文字值的前12个字符。-  PREFIX ouext：&lt;http://oracle.com/semtech/jena-adaptor/ext/user-def-function#&gt; SELECT（ouext：my_shorten_str（？对象，“12”）为？obj1）？主题WHERE {？主题DC：标题？object}创建或替换函数<span class="bold">my_shorten_str</span> （varchar2中的rdfvtyp，varchar2中的rdfltyp，varchar2中的rdflang，clob中的rdfclob，varchar2中的值，varchar2中的arg）return varchar2 as ret_val varchar2（4000）; begin  -  value if（rdfvtyp ='LIT'）then if（rdfclob为null）则返回substr（value，1，to_number（arg））; else返回dbms_lob.substr（rdfclob，to_number（arg），1）;万一; else返回null;万一;结束; /创建或替换函数<span class="bold">my_shorten_str_cl</span> （varchar2中的rdfvtyp，varchar2中的rdfltyp，varchar2中的rdflang，clob中的rdfclob，varchar2中的值，varchar2中的arg）将clob作为ret_val clob返回; begin  -  lob return null;结束; /创建或替换函数<span class="bold">my_shorten_str_la</span> （varchar2中的rdfvtyp，varchar2中的rdfltyp，varchar2中的rdflang，clob中的rdfclob，varchar2中的值，varchar2中的arg）将varchar2作为ret_val返回varchar2（4000）; begin  -  lang if（rdfvtyp ='LIT'）然后返回rdflang; else返回null;万一;结束; / create或replace函数<span class="bold">my_shorten_str_lt</span> （varchar2中的rdfvtyp，varchar2中的rdfltyp，varchar2中的rdflang，clob中的rdfclob，varchar2中的值，varchar2中的arg）return varchar2 as ret_val varchar2（4000）; begin  -  literal type ret_val：= rdfltyp; return ret_val;结束; /创建或替换函数<span class="bold">my_shorten_str_vt</span> （varchar2中的rdfvtyp，varchar2中的rdfltyp，varchar2中的rdflang，clob中的rdfclob，varchar2中的值，varchar2中的arg）将varchar2作为ret_val返回varchar2（3）;开始返回'LIT';结束; /</pre></div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-D7D68CA5-24BF-4546-8679-8AF4AA96C38C" title="通过支持Apache Jena的SPARQL查询可以使用以下几种功能。">SPARQL查询中支持的功能通过RDF对Apache Jena的语义图支持</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="RDFRM460"></a><a id="RDFRM461"></a><a id="RDFRM459"></a><div class="props_rev_3"><a id="GUID-C94D34A5-436A-4ED7-97D0-BE315755F7AE" name="GUID-C94D34A5-436A-4ED7-97D0-BE315755F7AE"></a><h3 id="RDFRM-GUID-C94D34A5-436A-4ED7-97D0-BE315755F7AE" class="sect3"><span class="enumeration_section">6.11</span> SPARQL更新支持</h3>
               <div>
                  <p>Apache Jena的RDF语义图支持支持SPARQL更新（ <code class="codeph">http://www.w3.org/TR/sparql11-update/</code> ），也称为SPARUL。</p>
                  <p>主编程API涉及耶拿类<code class="codeph">UpdateAction</code> （在包<code class="codeph">com.hp.hpl.jena.update</code> ）和RDF语义图支持为Apache耶拿类<code class="codeph">GraphOracleSem</code>和<code class="codeph">DatasetGraphOracleSem</code> 。<a href="rdf-suipport-for-apache-jena.html#GUID-C94D34A5-436A-4ED7-97D0-BE315755F7AE__BGBCBEDB">示例6-4</a>显示了SPARQL Update操作从存储在数据库中的相关模型中删除了命名图<code class="codeph">&lt;http://example/graph&gt;</code>中的所有三元组。
                  </p>
                  <div class="example" id="GUID-C94D34A5-436A-4ED7-97D0-BE315755F7AE__BGBCBEDB">
                     <p class="titleinexample">示例6-4简单SPARQL更新</p><pre class="oac_no_warn" dir="ltr">GraphOracleSem graphOracleSem = ....; DatasetGraphOracleSem dsgos = DatasetGraphOracleSem.createFrom（graphOracleSem）; // SPARQL更新操作String szUpdateAction =“DROP GRAPH &lt;http：// example / graph&gt;”; //对DatasetGraph实例执行更新（也可以是Jena模型）UpdateAction.parseExecute（szUpdateAction，dsgos）;</pre><p>请注意，Oracle数据库不保留有关空命名图的任何信息。这意味着如果在不向此图中添加任何三元组的情况下调用CREATE GRAPH <span class="italic">&lt;graph_name&gt;</span> ，则不会在应用程序表或基础RDF_LINK $表中创建其他行。对于Oracle数据库，您可以安全地跳过CREATE GRAPH步骤，如<a href="rdf-suipport-for-apache-jena.html#GUID-C94D34A5-436A-4ED7-97D0-BE315755F7AE__BGBCBEDB">例6-4中</a>的情况。
                     </p>
                  </div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-C94D34A5-436A-4ED7-97D0-BE315755F7AE__BGBHAHII">
                     <p class="titleinexample">示例6-5带插入和删除操作的SPARQL更新</p>
                     <p><a href="rdf-suipport-for-apache-jena.html#GUID-C94D34A5-436A-4ED7-97D0-BE315755F7AE__BGBHAHII">例6-5</a>显示了涉及多个插入和删除操作的SPARQL更新操作（来自ARQ 2.8.8）。
                     </p><pre class="oac_no_warn" dir="ltr">PREFIX：&lt;http：// example /&gt; CREATE GRAPH &lt;http：// example / graph&gt;; INSERT DATA {：r：p 123}; INSERT DATA {：r：p 1066};删除数据{：r：p 1066}; INSERT DATA {GRAPH &lt;http：// example / graph&gt; {：r：p 123。 ：r：p 1066}};删除数据{GRAPH &lt;http：// example / graph&gt; {：r：p 123}}</pre><p>在<a href="rdf-suipport-for-apache-jena.html#GUID-C94D34A5-436A-4ED7-97D0-BE315755F7AE__BGBHAHII">示例6-5中</a>针对空<code class="codeph">DatasetGraphOracleSem</code>运行更新操作后，运行SPARQL查询<code class="codeph">SELECT ?s？p？在哪里{？s？p？o}</code>生成以下响应：</p><pre class="oac_no_warn" dir="ltr">-------------------------------------------------- --------------------------------------------- | s | p | o | ================================================== ============================================= | &lt;http：// example / r&gt; | &lt;http：// example / p&gt; | “123”^^ &lt;http://www.w3.org/2001/XMLSchema#decimal&gt; | -------------------------------------------------- ---------------------------------------------</pre><p>使用相同的数据，运行SPARQL查询<code class="codeph">SELECT ?G ？s？p？o {GRAPH？G {？s？p？o}}</code>生成以下响应：</p><pre class="oac_no_warn" dir="ltr">-------------------------------------------------- -------------------------------------------------- --------------------- | g | s | p | o | ================================================== ================================================== ===================== | &lt;http：// example / graph&gt; | &lt;http：// example / r&gt; | &lt;http：// example / p&gt; | “1066”^^ &lt;http://www.w3.org/2001/XMLSchema#decimal&gt; | -------------------------------------------------- -------------------------------------------------- ---------------------</pre><p>除了使用Java API进行SPARQL更新操作之外，您还可以通过删除<code class="codeph">joseki-config.ttl</code>文件中以下行开头的注释（ <code class="codeph">##</code> ）字符来配置Joseki以接受SPARQL更新操作。
                     </p><pre class="oac_no_warn" dir="ltr">## &lt;#serviceUpdate&gt; ## rdf：输入joseki：Service; ## rdfs：label“SPARQL / Update”; ## joseki：serviceRef“update / service”; ##＃dataset part ## joseki：dataset &lt;#oracle&gt;; ###服务部分。###此处理器不允许协议，##＃和查询指定数据集。## joseki：processor joseki：ProcessorSPARQLUpdate ##。## ## &lt;#serviceRead&gt; ## rdf：输入joseki：服务; ## rdfs：label“SPARQL”; ## joseki：serviceRef“sparql / read”; ##＃dataset part ## joseki：dataset &lt;#oracle&gt;; ##相同数据集##＃服务部分。###此处理器不允许协议，##＃和查询指定数据集。## joseki：processor joseki：ProcessorSPARQL_FixedDS; ##。
</pre><p>编辑<code class="codeph">joseki-config.ttl</code>文件后，必须重新启动Joseki Web应用程序。然后，您可以尝试一个简单的更新操作，如下所示：</p>
                     <ol>
                        <li>
                           <p>在浏览器中，转到： <code class="codeph">http://</code> <span class="italic"><code class="codeph">&lt;hostname&gt;</code></span> <code class="codeph">:7001/joseki/update.html</code></p>
                        </li>
                        <li>
                           <p>在文本框中键入或粘贴以下内容：</p><pre class="oac_no_warn" dir="ltr">PREFIX：&lt;http：// example /&gt; INSERT DATA {GRAPH &lt;http：// example / g1&gt; {：r：p 455}}</pre></li>
                        <li>
                           <p>单击“ <span class="bold">执行SPARQL更新”</span> 。
                           </p>
                        </li>
                     </ol>
                     <p>要验证更新操作是否成功，请转至<code class="codeph">http://</code> <span class="italic"><code class="codeph">&lt;hostname&gt;</code></span> <code class="codeph">:7001/joseki</code>并输入以下查询：</p><pre class="oac_no_warn" dir="ltr">SELECT * WHERE {GRAPH &lt;http：// example / g1&gt; {？s？p？ö}};</pre><p>响应应包含以下三元组：</p><pre class="oac_no_warn" dir="ltr">&lt;http：// example / r&gt; &lt;http：// example / p&gt;“455”^^ &lt;http://www.w3.org/2001/XMLSchema#decimal&gt;</pre><p>还可以使用HTTP POST操作将SPARQL更新发送到<code class="codeph">http://</code> <span class="italic"><code class="codeph">&lt;hostname&gt;</code></span> <code class="codeph">:7001/joseki/update/</code> service。例如，您可以使用<code class="codeph">curl</code> （ <a href="http://en.wikipedia.org/wiki/CURL" target="_blank"><code class="codeph">http://en.wikipedia.org/wiki/CURL</code></a> ）发送HTTP POST请求以执行更新操作：</p><pre class="oac_no_warn" dir="ltr">curl --data“request = PREFIX％20％3A％20％3Chttp％3A％2F％2Fexample％2F％3E％20％0AINSERT％20DATA％20％7B％0A％20％20GRAPH％20％3Chttp％3A％2F ％2Fexample％2Fg1％3E％20％7B％20％3Ar％20％3Ap％20888％20％7D％0A％7D％0A“http：// <span class="italic">hostname</span> ：7001 / joseki / update / service</pre><p>在前面的示例中，URL编码的字符串是对命名图的简单INSERT操作。解码后，内容如下：</p><pre class="oac_no_warn" dir="ltr">PREFIX：&lt;http：// example /&gt; INSERT DATA {GRAPH &lt;http：// example / g1&gt; {：r：p 888}</pre></div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-3F437E3E-3B74-4CCF-9F16-B2B07B3899E8" title="Apache Jena的RDF语义图支持（这里也称为对Apache Jena的支持）通过实现着名的Jena Graph，Model和DatasetGraph API为Oracle Spatial和Graph RDF语义图提供了基于Java的接口。">Apache Jena的RDF语义图支持</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="RDFRM463"></a><a id="RDFRM464"></a><a id="RDFRM462"></a><div class="props_rev_3"><a id="GUID-828999B9-6B4D-4BA1-AC00-953D20212F24" name="GUID-828999B9-6B4D-4BA1-AC00-953D20212F24"></a><h3 id="RDFRM-GUID-828999B9-6B4D-4BA1-AC00-953D20212F24" class="sect3"><span class="enumeration_section">6.12</span> RDF数据的分析函数</h3>
               <div>
                  <p>您可以使用<code class="codeph">oracle.spatial.rdf.client.jena</code>包中的<code class="codeph">SemNetworkAnalyst</code>类对RDF数据执行分析功能。
                  </p>
                  <p>此支持将网络数据模型图逻辑与底层RDF数据结构集成在一起。因此，要在RDF数据上使用分析函数，您必须熟悉网络数据模型图功能，该功能在<a href="../topol/network-data-model-graph-overview.html#TOPOL700" target="_blank"><span class="italic">Oracle空间和图形拓扑数据模型和网络数据模型图开发人员指南中有记录</span></a> 。
                  </p>
                  <p>所需的NDM Java库（包括<code class="codeph">sdonm.jar</code>和<code class="codeph">sdoutl.jar</code> ）位于<code class="codeph">$ORACLE_HOME/md/jlib</code> 。请注意， <code class="codeph">xmlparserv2.jar</code> （在<code class="codeph">$ORACLE_HOME/xdk/lib</code> ）必须包含在<code class="codeph">classpath</code>定义中。
                  </p>
                  <div class="example" id="GUID-828999B9-6B4D-4BA1-AC00-953D20212F24__BGBDIHEA">
                     <p class="titleinexample">例6-6对RDF数据执行分析功能</p>
                     <p><a href="rdf-suipport-for-apache-jena.html#GUID-828999B9-6B4D-4BA1-AC00-953D20212F24__BGBDIHEA">例6-6</a>使用<code class="codeph">SemNetworkAnalyst</code>类，该类在内部使用NDM <code class="codeph">NetworkAnalyst</code> API</p><pre class="oac_no_warn" dir="ltr">Oracle oracle = new Oracle（jdbcUrl，user，password）; GraphOracleSem graph = new GraphOracleSem（oracle，modelName）;节点nodeA = Node.createURI（“http：// A”）;节点nodeB = Node.createURI（“http：// B”）;节点nodeC = Node.createURI（“http：// C”）;节点nodeD = Node.createURI（“http：// D”）;节点nodeE = Node.createURI（“http：// E”）;节点nodeF = Node.createURI（“http：// F”）;节点nodeG = Node.createURI（“http：// G”）;节点nodeX = Node.createURI（“http：// X”）; //匿名节点节点ano = Node.createAnon（new AnonId（“m1”））; Node relL = Node.createURI（“http：// likes”）; Node relD = Node.createURI（“http：// dislikes”）; Node relK = Node.createURI（“http：// knows”）; Node relC = Node.createURI（“http：// differ”）; graph.add（new Triple（nodeA，relL，nodeB））; graph.add（new Triple（nodeA，relC，nodeD））; graph.add（new Triple（nodeB，relL，nodeC））; graph.add（new Triple（nodeA，relD，nodeC））; graph.add（new Triple（nodeB，relD，ano））; graph.add（new Triple（nodeC，relL，nodeD））; graph.add（new Triple（nodeC，relK，nodeE））; graph.add（new Triple（ano，relL，nodeD））; graph.add（new Triple（ano，relL，nodeF））; graph.add（new Triple（ano，relD，nodeB））; // X只喜欢自己的graph.add（new Triple（nodeX，relL，nodeX））; graph.commitTransaction（）; HashMap &lt;Node，Double&gt; costMap = new HashMap &lt;Node，Double&gt;（）; costMap.put（relL，Double.valueOf（（double）0.5））; costMap.put（relD，Double.valueOf（（double）1.5））; costMap.put（relC，Double.valueOf（（double）5.5））; graph.setDOP（4）; //这允许并行创建基础LINK / NODE表//和索引。SemNetworkAnalyst sna = SemNetworkAnalyst.getInstance（graph，//网络数据源true，//有向图true，//清理现有NODE和LINK表costMap）; psOut.println（“从nodeA到nodeC”）; Node [] nodeArray = sna.shortestPathDijkstra（nodeA，nodeC）; printNodeArray（nodeArray，psOut）; psOut.println（“从nodeA到nodeD”）; nodeArray = sna.shortestPathDijkstra（nodeA，nodeD）; printNodeArray（nodeArray，psOut）; psOut.println（“从nodeA到nodeF”）; nodeArray = sna.shortestPathAStar（nodeA，nodeF）; printNodeArray（nodeArray，psOut）; psOut.println（“从ano到nodeC”）; nodeArray = sna.shortestPathAStar（ano，nodeC）; printNodeArray（nodeArray，psOut）; psOut.println（“从ano到nodeX”）; nodeArray = sna.shortestPathAStar（ano，nodeX）; printNodeArray（nodeArray，psOut）; graph.close（）; oracle.dispose（）; ......//用于打印路径的辅助函数public static void printNodeArray（Node [] nodeArray，PrintStream psOut）{if（nodeArray == null）{psOut.println（“Node Array is null”）;返回; } if（nodeArray.length == 0）{psOut.println（“Node Array为空”）; } int iFlag = 0; psOut.println（“printNodeArray：full path starts”）; for（int iHops = 0; iHops &lt;nodeArray.length; iHops ++）{psOut.println（“printNodeArray：full path item”+ iHops +“=”+（（iFlag == 0）？“[n]”：“[e]”）+ nodeArray [iHops]）; iFlag = 1  -  iFlag; }}</pre><p>在<a href="rdf-suipport-for-apache-jena.html#GUID-828999B9-6B4D-4BA1-AC00-953D20212F24__BGBDIHEA">例6-6中</a> ：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>甲<code class="codeph">GraphOracleSem</code>对象被构造和一些三元组被添加到<code class="codeph">GraphOracleSem</code>对象。这些三元组描述了几个人和他们的关系，包括<span class="italic">喜欢</span> ， <span class="italic">不喜欢</span> ， <span class="italic">知道</span>和<span class="italic">不同</span> 。
                           </p>
                        </li>
                        <li>
                           <p>构造成本映射以将数字成本值分配给（RDF图的）不同链接/谓词。在这种情况下，0.5,1.5和5.5分别分配给谓词<span class="italic">喜欢</span> ， <span class="italic">不喜欢</span>和<span class="italic">不同</span> 。此成本映射是可选的。如果不存在映射，则将为所有谓词分配相同的成本1。指定成本映射时，不需要完成此映射;对于未包含在成本映射中的谓词，将分配默认值1。
                           </p>
                        </li>
                     </ul>
                     <p><a href="rdf-suipport-for-apache-jena.html#GUID-828999B9-6B4D-4BA1-AC00-953D20212F24__BGBDIHEA">例6-6</a>的输出如下。在此输出中，列出了给定开始和结束节点的最短路径。请注意， <code class="codeph">sna.shortestPathAStar(ano, nodeX)</code>的返回值为null，因为这两个节点之间没有路径。
                     </p><pre class="oac_no_warn" dir="ltr">从nodeA到nodeC printNodeArray：完整路径启动printNodeArray：完整路径项0 = [n] http：// A ##“n”表示节点printNodeArray：完整路径项1 = [e] http：//赞##“e “表示Edge（链接）printNodeArray：完整路径项目2 = [n] http：// B printNodeArray：完整路径项3 = [e] http：// likes printNodeArray：完整路径项4 = [n] http：// C从nodeA到nodeD printNodeArray：完整路径启动printNodeArray：完整路径项0 = [n] http：// printNodeArray：完整路径项1 = [e] http：// likes printNodeArray：完整路径项2 = [n] http：// B printNodeArray：完整路径项3 = [e] http：// likes printNodeArray：完整路径项4 = [n] http：// C printNodeArray：完整路径项5 = [e] http：// likes printNodeArray：完整路径项6 = [n] http：// D从nodeA到nodeF printNodeArray：完整路径启动printNodeArray：完整路径项0 = [n] http：// printNodeArray：完整路径项1 = [e] http ：// likes printNodeArray：完整路径项2 = [n] http：// B printNodeArray：完整路径项3 = [e] http：// disl ikes printNodeArray：完整路径项4 = [n] m1 printNodeArray：完整路径项5 = [e] http：// likes printNodeArray：完整路径项6 = [n] http：// F从ano到nodeC printNodeArray：完整路径启动printNodeArray：完整路径项0 = [n] m1 printNodeArray：完整路径项1 = [e] http：//不喜欢printNodeArray：完整路径项2 = [n] http：// B printNodeArray：完整路径项3 = [ e] http：//喜欢printNodeArray：完整路径项4 = [n] http：// C从ano到nodeX节点数组为空</pre><p>底层RDF图形视图（SEMM_ <span class="italic">&lt;</span> model_name <span class="italic">&gt;</span>或RDFM_ <span class="italic">&lt;</span> model_name <span class="italic">&gt;</span> ）不能由NDM函数直接使用，因此<code class="codeph">SemNetworkAnalyst</code>创建必要的表，其中包含从给定RDF图派生的节点和链接。当RDF图改变时，这些表不会自动更新;相反，您可以将<code class="codeph">SemNetworkAnalyst.getInstance</code>的<code class="codeph">cleanup</code>参数设置为<code class="codeph">true</code> ，以删除旧节点和链接表并重建更新的表。
                     </p>
                  </div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-828999B9-6B4D-4BA1-AC00-953D20212F24__BGBHAABI">
                     <p class="titleinexample">例6-7在语义数据之上实现NDM nearestNeighbors函数</p>
                     <p><a href="rdf-suipport-for-apache-jena.html#GUID-828999B9-6B4D-4BA1-AC00-953D20212F24__BGBHAABI">例6-7</a>在语义数据之上实现了NDM <code class="codeph">nearestNeighbors</code>函数。这将从<code class="codeph">SemNetworkAnalyst</code>实例获取<code class="codeph">NetworkAnalyst</code>对象，获取节点ID，创建<code class="codeph">PointOnNet</code>对象，并处理<code class="codeph">LogicalSubPath</code>对象。
                     </p><pre class="oac_no_warn" dir="ltr">％cat TestNearestNeighbor.java import java.io.*; import java.util。*; import com.hp.hpl.jena.query。*; import com.hp.hpl.jena.rdf.model。模型; import com.hp.hpl.jena.util。文件管理器; import com.hp.hpl.jena.util.iterator。*; import com.hp.hpl.jena.graph。*; import com.hp.hpl.jena.update。*; import com.hp.hpl.jena.sparql.core。DatasetImpl; import oracle.spatial.rdf.client.jena。*; import oracle.spatial.rdf.client.jena。SemNetworkAnalyst; import oracle.spatial.network.lod。LODGoalNode; import oracle.spatial.network.lod。LODNetworkConstraint; import oracle.spatial.network.lod.NetworkAnalyst; import oracle.spatial.network.lod。PointOnNet; import oracle.spatial.network.lod。LogicalSubPath; / ** *此类使用SemNetworkAnalyst和Oracle Spatial NDM * / public class TestNearestNeighbor {public static void main（String [] args）中提供的公共API在语义数据*之上实现nearestNeighbors函数抛出Exception {String szJdbcURL = args [ 0]; String szUser = args [1]; String szPasswd = args [2]; PrintStream psOut = System.out; Oracle oracle = new Oracle（szJdbcURL，szUser，szPasswd）; String szModelName =“test_nn”; //首先构造一个TBox并加载几个公理ModelOracleSem model = ModelOracleSem.createOracleSemModel（oracle，szModelName）; String insertString =“PREFIX my：&lt;http://my.com/&gt;”+“INSERT DATA”+“{my：A my：likes my：B。”+“my：A my：like my：C。” +“我：我的：知道我的：D。”+“我的：我的：不喜欢我的：X。”+“我的：我的：不喜欢我的：Y。”+“我的：C我的：喜欢我的：E “+”我的：C我的：喜欢我的：F。“+”我的：C我的：不喜欢我的：M。“+”我的：D我的：喜欢我的：G。“+”我的：D我的：喜欢我的：H。“+”my：F my：喜欢我：M。“+”}“; UpdateAction.parseExecute（insertString，model）; GraphOracleSem g = model.getGraph（）; g.commitTransaction（）; g.setDOP（4）; HashMap &lt;Node，Double&gt; costMap = new HashMap &lt;Node，Double&gt;（）; costMap.put（Node.createURI（“http://my.com/likes”），Double.valueOf（1.0））; costMap.put（Node.createURI（“http://my.com/dislikes”），Double.valueOf（4.0））; costMap.put（Node.createURI（“http://my.com/knows”），Double.valueOf（2.0））; SemNetworkAnalyst sna = SemNetworkAnalyst.getInstance（g，//源RDF图为true，//有向图为true，//清理旧节点/链接表costMap）; Node nodeStart = Node.createURI（“http://my.com/A”）; long origNodeID = sna.getNodeID（nodeStart）; long [] lIDs = {origNodeID}; //从原始ID转换为long nodeID =（sna.mapNodeIDs（lIDs））[0]; NetworkAnalyst networkAnalyst = sna.getEmbeddedNetworkAnalyst（）; LogicalSubPath [] lsps = networkAnalyst.nearestNeighbors（new PointOnNet（nodeID），// startPoint 6，// numberOfNeighbors 1，// searchLinkLevel 1，// targetLinkLevel（LODNetworkConstraint）null，// constraint（LODGoalNode）null // goalNodeFilter）;如果（lsps！= null）{for（int idx = 0; idx &lt;lsps.length; idx ++）{LogicalSubPath lsp = lsps [idx]; Node [] nodePath = sna.processLogicalSubPath（lsp，nodeStart）; psOut.println（“Path”+ idx）; printNodeArray（nodePath，psOut）; g.close（）; sna.close（）; oracle.dispose（）; public static void printNodeArray（Node [] nodeArray，PrintStream psOut）{if（nodeArray == null）{psOut.println（“Node Array is null”）;返回; } if（nodeArray.length == 0）{psOut.println（“Node Array is empty”）; } int iFlag = 0; psOut.println（“printNodeArray：full path starts”）; for（int iHops = 0; iHops &lt;nodeArray.length; iHops ++）{psOut.println（“printNodeArray：full path item”+ iHops +“=”+（（iFlag == 0）？“[n]”：“[e]”）+ nodeArray [iHops]）; iFlag = 1  -  iFlag; }}}</pre><p><a href="rdf-suipport-for-apache-jena.html#GUID-828999B9-6B4D-4BA1-AC00-953D20212F24__BGBHAABI">例6-7</a>的输出如下。
                     </p><pre class="oac_no_warn" dir="ltr">路径0 printNodeArray：完整路径启动printNodeArray：完整路径项0 = [n] http://my.com/A printNodeArray：完整路径项1 = [e] http://my.com/likes printNodeArray：完整路径项2 = [n] http://my.com/C Path 1 printNodeArray：完整路径启动printNodeArray：完整路径项0 = [n] http://my.com/A printNodeArray：完整路径项1 = [e] http://my.com/likes printNodeArray：完整路径项2 = [n] http://my.com/B路径2 printNodeArray：完整路径启动printNodeArray：完整路径项0 = [n] http：// my .com / A printNodeArray：完整路径项1 = [e] http://my.com/knows printNodeArray：完整路径项2 = [n] http://my.com/D路径3 printNodeArray：完整路径启动printNodeArray ：完整路径项0 = [n] http://my.com/A printNodeArray：完整路径项1 = [e] http://my.com/likes printNodeArray：完整路径项2 = [n] http：/ /my.com/C printNodeArray：完整路径项3 = [e] http://my.com/likes printNodeArray：完整路径项4 = [n] http://my.com/E路径4 printNodeArray：完整路径启动printNodeA rray：完整路径项0 = [n] http://my.com/A printNodeArray：完整路径项1 = [e] http://my.com/likes printNodeArray：完整路径项2 = [n] http： //my.com/C printNodeArray：完整路径项3 = [e] http://my.com/likes printNodeArray：完整路径项4 = [n] http://my.com/F路径5 printNodeArray：完整path starts printNodeArray：full path item 0 = [n] http://my.com/A printNodeArray：full path item 1 = [e] http://my.com/knows printNodeArray：full path item 2 = [n] http://my.com/D printNodeArray：完整路径项3 = [e] http://my.com/likes printNodeArray：完整路径项4 = [n] http://my.com/H</pre></div>
                  <!-- class="example" -->
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-90A00E71-C53F-45DA-9F52-3B16C0EEA32C">生成关于图中路径的上下文信息</a><br></li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-3F437E3E-3B74-4CCF-9F16-B2B07B3899E8" title="Apache Jena的RDF语义图支持（这里也称为对Apache Jena的支持）通过实现着名的Jena Graph，Model和DatasetGraph API为Oracle Spatial和Graph RDF语义图提供了基于Java的接口。">Apache Jena的RDF语义图支持</a></p>
                     </div>
                  </div>
               </div>
               <a id="RDFRM467"></a><a id="RDFRM465"></a><div class="props_rev_3"><a id="GUID-90A00E71-C53F-45DA-9F52-3B16C0EEA32C" name="GUID-90A00E71-C53F-45DA-9F52-3B16C0EEA32C"></a><h4 id="RDFRM-GUID-90A00E71-C53F-45DA-9F52-3B16C0EEA32C" class="sect4"><span class="enumeration_section">6.12.1</span>生成图中路径的上下文信息</h4>
                  <div>
                     <p>除了路径本身之外，有时查看有关图中路径的上下文信息也很有用。<code class="codeph">SemNetworkAnalyst</code>类中的<code class="codeph">buildSurroundingSubGraph</code>方法可以将DOT文件（图形描述语言文件，扩展名<code class="codeph">.gv</code> ）输出到指定的<code class="codeph">Writer</code>对象中。对于路径中的每个节点，最多使用十个直接邻居来生成路径的周围子图。以下示例显示了使用上下文信息生成DOT文件的用法，特别是<a href="rdf-suipport-for-apache-jena.html#GUID-828999B9-6B4D-4BA1-AC00-953D20212F24__BGBDIHEA">示例6-6中</a>使用的分析函数的输出。
                     </p><pre class="oac_no_warn" dir="ltr">nodeArray = sna.shortestPathDijkstra（nodeA，nodeD）; printNodeArray（nodeArray，psOut）; FileWriter dotWriter = new FileWriter（“Shortest_Path_A_to_D.gv”）; sna.buildSurroundingSubGraph（nodeArray，dotWriter）;</pre><p>前面示例中生成的输出DOT文件很简单，如以下示例所示：</p><pre class="oac_no_warn" dir="ltr">％cat Shortest_Path_A_to_D.gv有向图{rankdir = LR;字符集= “UTF-8”; “Rhttp：// A”[label =“http：// A”shape = rectangle，color = red，style = filled，]; “Rhttp：// B”[label =“http：// B”shape = rectangle，color = red，style = filled，]; “Rhttp：// A” - &gt;“Rhttp：// B”[label =“http：// likes”color = red，style = bold，]; “Rhttp：// C”[label =“http：// C”shape = rectangle，color = red，style = filled，]; “Rhttp：// A” - &gt;“Rhttp：// C”[label =“http：//不喜欢”]; “Rhttp：// D”[label =“http：// D”shape = rectangle，color = red，style = filled，]; “Rhttp：// A” - &gt;“Rhttp：// D”[label =“http：// differ”]; “Rhttp：// B” - &gt;“Rhttp：// C”[label =“http：// likes”color = red，style = bold，]; “Rm1”[label =“m1”shape = ellipse，color = blue，]; “Rhttp：// B” - &gt;“Rm1”[label =“http：//不喜欢”]; “Rm1” - &gt;“Rhttp：// B”[label =“http：//不喜欢”]; “Rhttp：// C” - &gt;“Rhttp：// D”[label =“http：// likes”color = red，style = bold，]; “Rhttp：// E”[label =“http：// E”shape = ellipse，color = blue，]; “Rhttp：// C” - &gt;“Rhttp：// E”[label =“http：// knows”]; “Rm1” - &gt;“Rhttp：// D”[label =“http：// likes”]; }</pre><p>您还可以使用<code class="codeph">SemNetworkAnalyst</code>和<code class="codeph">GraphOracleSem</code>类中的方法来生成分析函数输出的更复杂的可视化。
                     </p>
                     <p>您可以将前面的DOT文件转换为各种图像格式。<a href="rdf-suipport-for-apache-jena.html#GUID-90A00E71-C53F-45DA-9F52-3B16C0EEA32C__BGBECIFH">图6-1</a>是表示前一个DOT文件中的信息的图像。
                     </p>
                     <div class="figure" id="GUID-90A00E71-C53F-45DA-9F52-3B16C0EEA32C__BGBECIFH">
                        <p class="titleinfigure">图6-1分析函数输出的可视化表示</p><img src="img/shortest_a_to_d.jpg" width="615" alt="下面是图6-1的描述" title="下面是图6-1的描述" longdesc="img_text/shortest_a_to_d.html"><br><a href="img_text/shortest_a_to_d.html">“图6-1分析函数输出的可视化表示”的描述</a></div>
                     <!-- class="figure" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-828999B9-6B4D-4BA1-AC00-953D20212F24" title="您可以使用oracle.spatial.rdf.client.jena包中的SemNetworkAnalyst类对RDF数据执行分析功能。">RDF数据的分析函数</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="RDFRM261"></a><div class="props_rev_3"><a id="GUID-CBBCF550-832C-402A-89D2-0CDA62D27F0C" name="GUID-CBBCF550-832C-402A-89D2-0CDA62D27F0C"></a><h3 id="RDFRM-GUID-CBBCF550-832C-402A-89D2-0CDA62D27F0C" class="sect3"><span class="enumeration_section">6.13</span>支持服务器端API</h3>
               <div>
                  <p>本节描述了RDF语义图支持Apache Jena所展示的一些RDF语义图功能。</p>
                  <p>有关支持可用功能的API调用的综合文档，请参阅Apache Jena参考信息（Javadoc）的RDF语义图支持。有关Apache Jena支持所公开的服务器端功能的其他信息，请参阅本手册中的相关章节。</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-449AF064-7F23-4E4D-8155-06BBBADFADCA">虚拟模型支持</a><br></li>
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-070FC139-0675-4A54-832A-01B8E4025DA1">连接池支持</a><br></li>
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-C22BE3A3-04CB-479D-96AD-221F25FC257D">语义模型PL / SQL接口</a><br></li>
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-9D4EE34E-FD90-46ED-9E6B-4BC1CDF4DE55">推理选项</a><br></li>
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-5DA9FC7D-DF28-43A0-826C-819D958A5724">PelletInfGraph类支持已弃用</a><br></li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-3F437E3E-3B74-4CCF-9F16-B2B07B3899E8" title="Apache Jena的RDF语义图支持（这里也称为对Apache Jena的支持）通过实现着名的Jena Graph，Model和DatasetGraph API为Oracle Spatial和Graph RDF语义图提供了基于Java的接口。">Apache Jena的RDF语义图支持</a></p>
                     </div>
                  </div>
               </div>
               <a id="RDFRM262"></a><div class="props_rev_3"><a id="GUID-449AF064-7F23-4E4D-8155-06BBBADFADCA" name="GUID-449AF064-7F23-4E4D-8155-06BBBADFADCA"></a><h4 id="RDFRM-GUID-449AF064-7F23-4E4D-8155-06BBBADFADCA" class="sect4"><span class="enumeration_section">6.13.1</span>虚拟模型支持</h4>
                  <div>
                     <p>虚拟模型（在<a href="rdf-semantic-graph-overview.html#GUID-8B957406-5ED1-4579-9C23-0EDE2FDF2964">虚拟模型中</a>解释）在<code class="codeph">GraphOracleSem</code>构造函数中指定，并且它们是透明处理的。如果模型 - 规则库组合存在虚拟模型，则将其用于查询应答;如果这样的虚拟模型不存在，则在数据库中创建。
                     </p>
                     <div class="infoboxnote" id="GUID-449AF064-7F23-4E4D-8155-06BBBADFADCA__GUID-59A0734B-5328-4629-822B-5CAE563976E2">
                        <p class="notep1">注意：</p>
                        <p>通过对Apache Jena的支持提供的虚拟模型支持仅适用于Oracle Database 11.2或更高版本。</p>
                     </div>
                     <p>以下示例重用现有虚拟模型。</p><pre class="oac_no_warn" dir="ltr">String modelName =“EX”;字符串m1 =“EX_1”; ModelOracleSem defaultModel = ModelOracleSem.createOracleSemModel（oracle，modelName）; //创建这些模型以防它们不存在ModelOracleSem model1 = ModelOracleSem.createOracleSemModel（oracle，m1）; String vmName =“VM_”+ modelName; //创建一个包含EX和EX_1的虚拟模型oracle.executeCall（“begin sem_apis.create_virtual_model（？，sem_models（'”+ m1 +“'，'”+ modelName +“'），null）; end;”，vmName）; String [] modelNames = {m1}; String [] rulebaseNames = {};附件附件= Attachment.createInstance（modelNames，rulebaseNames，InferenceMaintenanceMode。NO_UPDATE，QueryOptions。ALLOW_QUERY_VALID_AND_DUP）; // vmName被传递给构造函数，因此GraphOracleSem将使用名为vmname的虚拟//模型（如果当前用户具有读权限） <span class="bold">GraphOracleSem graph = new GraphOracleSem（oracle，modelName，attachment，vmName）;</span> graph.add（Triple.create（Node.createURI（“urn：alice”），Node.createURI（“http://xmlns.com/foaf/0.1/mbox”），Node.createURI（“mailto：alice @ example” “）））; ModelOracleSem model = new ModelOracleSem（graph）; String queryString =“SELECT？学科 ？对象WHERE {？学科 ？p？对象}“;查询查询= QueryFactory.create（queryString）; QueryExecution qexec = QueryExecutionFactory.create（query，model）; try {ResultSet results = qexec.execSelect（）; for（; results.hasNext（）;）{QuerySolution soln = results.nextSolution（）; psOut.println（“soln”+ soln）;}} finally {qexec.close（）;} OracleUtils.dropSemanticModel（oracle，modelName）; OracleUtils.dropSemanticModel（oracle，m1）; oracle.dispose （）;</pre><p>您还可以使用GraphOracleSem构造函数创建虚拟模型，如以下示例所示：</p><pre class="oac_no_warn" dir="ltr">GraphOracleSem graph = new GraphOracleSem（oracle，modelName，attachment， <span class="bold">true</span> ）;</pre><p>在此示例中，第四个参数（ <code class="codeph">true</code> ）指定需要为指定的<code class="codeph">modelName</code>和<code class="codeph">attachment</code>创建虚拟模型。
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-CBBCF550-832C-402A-89D2-0CDA62D27F0C" title="本节描述了RDF语义图支持Apache Jena所展示的一些RDF语义图功能。">支持服务器端API</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="RDFRM263"></a><div class="props_rev_3"><a id="GUID-070FC139-0675-4A54-832A-01B8E4025DA1" name="GUID-070FC139-0675-4A54-832A-01B8E4025DA1"></a><h4 id="RDFRM-GUID-070FC139-0675-4A54-832A-01B8E4025DA1" class="sect4"><span class="enumeration_section">6.13.2</span>连接池支持</h4>
                  <div>
                     <p>Oracle数据库连接池是通过对Apache Jena <code class="codeph">OraclePool</code>类的支持提供的。初始化此类后，它可以将Oracle对象从其可用连接池中返回。Oracle对象本质上是数据库连接包装器。在Oracle对象上调用<code class="codeph">dispose</code>后，连接将返回到池。有关使用<code class="codeph">OraclePool</code>更多信息，请参阅API参考信息（Javadoc）。
                     </p>
                     <p>以下示例设置具有五（5）个初始连接的OraclePool对象。</p><pre class="oac_no_warn" dir="ltr">public static void main（String [] args）throws Exception {String szJdbcURL = args [0]; String szUser = args [1]; String szPasswd = args [2]; String szModelName = args [3]; //使用连接属性java.util进行测试。属性prop = new java.util。属性（）; prop.setProperty（“MinLimit”，“2”）; //缓存大小至少为2 prop.setProperty（“MaxLimit”，“10”）; prop.setProperty（“InitialLimit”，“2”）; //在启动时创建2个连接prop.setProperty（“InactivityTimeout”，“1800”）; // seconds prop.setProperty（“AbandonedConnectionTimeout”，“900”）; // seconds prop.setProperty（“MaxStatementsLimit”，“10”）; prop.setProperty（“PropertyCheckInterval”，“60”）; //秒System.out.println（“创建OraclePool”）; <span class="bold">OraclePool op = new OraclePool（szJdbcURL，szUser，szPasswd，prop，</span> <span class="bold">“OracleSemConnPool”）;</span> System.out.println（“完成创建OraclePool”）; //抓住Oracle并使用它做一些事情System.out.println（“从OraclePool获取Oracle”）; Oracle oracle = op.getOracle（）;的System.out.println（ “完成”）; System.out.println（“是逻辑连接：”+ oracle.getConnection（）。isLogicalConnection（））; GraphOracleSem g = new GraphOracleSem（oracle，szModelName）; g.add（Triple.create（Node.createURI（“u：John”），Node.createURI（“u：parentOf”），Node.createURI（“u：Mary”）））; g.close（）; //将Oracle返回池oracle.dispose（）; //抓住另一个Oracle并执行其他操作System.out.println（“从OraclePool获取Oracle”）; oracle = op.getOracle（）;的System.out.println（ “完成”）; System.out.println（“是逻辑连接：”+ oracle.getConnection（）。isLogicalConnection（））; g = new GraphOracleSem（oracle，szModelName）; g.add（Triple.create（Node.createURI（“u：John”），Node.createURI（“u：parentOf”），Node.createURI（“u：Jack”）））; g.close（）; OracleUtils.dropSemanticModel（oracle，szModelName）; //将Oracle对象返回池oracle.dispose（）; }</pre></div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-CBBCF550-832C-402A-89D2-0CDA62D27F0C" title="本节描述了RDF语义图支持Apache Jena所展示的一些RDF语义图功能。">支持服务器端API</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="RDFRM265"></a><a id="RDFRM264"></a><div class="props_rev_3"><a id="GUID-C22BE3A3-04CB-479D-96AD-221F25FC257D" name="GUID-C22BE3A3-04CB-479D-96AD-221F25FC257D"></a><h4 id="RDFRM-GUID-C22BE3A3-04CB-479D-96AD-221F25FC257D" class="sect4"><span class="enumeration_section">6.13.3</span>语义模型PL / SQL接口</h4>
                  <div>
                     <p>通过对Apache Jena的支持，可以使用几个语义PL / SQL子程序。<a href="rdf-suipport-for-apache-jena.html#GUID-C22BE3A3-04CB-479D-96AD-221F25FC257D__CBBJFIFG" title="Pl / SQL子程序和相应的Jena适配器Java类和方法">表6-2</a>列出了子程序及其相应的Java类和方法。
                     </p>
                     <div class="tblformal" id="GUID-C22BE3A3-04CB-479D-96AD-221F25FC257D__CBBJFIFG">
                        <p class="titleintable">表6-2 Apache Jena Java类和方法的PL / SQL子程序和相应的RDF语义图支持</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="Apache Jena Java类和方法的PL / SQL子程序和相应的RDF语义图支持" width="100%" border="1" summary="Pl/SQL Subprograms and Corresponding Jena Adaptor Java Class and Methods" frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="46%" id="d44532e5141">PL / SQL子程序</th>
                                 <th align="left" valign="bottom" width="54%" id="d44532e5144">对应的Java类和方法</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="46%" id="d44532e5149" headers="d44532e5141 ">
                                    <p><a href="SEM_APIS-reference.html#GUID-9A9A58D0-314B-4775-B55E-B939B6606AD8">SEM_APIS.DROP_SEM_MODEL</a></p>
                                 </td>
                                 <td align="left" valign="top" width="54%" headers="d44532e5149 d44532e5144 ">
                                    <p>OracleUtils.dropSemanticModel</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="46%" id="d44532e5158" headers="d44532e5141 ">
                                    <p><a href="SEM_APIS-reference.html#GUID-47CAA34C-3284-4665-BB9B-D65EBF07ED4E">SEM_APIS.MERGE_MODELS</a></p>
                                 </td>
                                 <td align="left" valign="top" width="54%" headers="d44532e5158 d44532e5144 ">
                                    <p>OracleUtils.mergeModels</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="46%" id="d44532e5167" headers="d44532e5141 ">
                                    <p><a href="SEM_APIS-reference.html#GUID-15186D10-9EDF-494F-B8CD-D5B77D9CC522">SEM_APIS.SWAP_NAMES</a></p>
                                 </td>
                                 <td align="left" valign="top" width="54%" headers="d44532e5167 d44532e5144 ">
                                    <p>OracleUtils.swapNames</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="46%" id="d44532e5176" headers="d44532e5141 ">
                                    <p><a href="SEM_APIS-reference.html#GUID-F5D87A18-2285-49B3-BB10-673DC61732F9">SEM_APIS.REMOVE_DUPLICATES</a></p>
                                 </td>
                                 <td align="left" valign="top" width="54%" headers="d44532e5176 d44532e5144 ">
                                    <p>OracleUtils.removeDuplicates</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="46%" id="d44532e5185" headers="d44532e5141 ">
                                    <p><a href="SEM_APIS-reference.html#GUID-D4E93775-083A-4625-BB37-CA169669C24A">SEM_APIS.RENAME_MODEL</a></p>
                                 </td>
                                 <td align="left" valign="top" width="54%" headers="d44532e5185 d44532e5144 ">
                                    <p>OracleUtils.renameModels</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p>有关这些PL / SQL实用程序子程序的信息，请参阅<a href="SEM_APIS-reference.html#GUID-F42AB976-445A-4DCD-974C-3B9ED810E3D5" title="SEM_APIS包中包含用于在Oracle数据库中使用资源描述框架（RDF）和Web本体语言（OWL）的子程序（函数和过程）。">SEM_APIS包子程序中</a>的参考信息。有关相应Java类和方法的信息，请参阅Apache Jena API参考文档（Javadoc）的RDF语义图支持。
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-CBBCF550-832C-402A-89D2-0CDA62D27F0C" title="本节描述了RDF语义图支持Apache Jena所展示的一些RDF语义图功能。">支持服务器端API</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="RDFRM468"></a><a id="RDFRM266"></a><div class="props_rev_3"><a id="GUID-9D4EE34E-FD90-46ED-9E6B-4BC1CDF4DE55" name="GUID-9D4EE34E-FD90-46ED-9E6B-4BC1CDF4DE55"></a><h4 id="RDFRM-GUID-9D4EE34E-FD90-46ED-9E6B-4BC1CDF4DE55" class="sect4"><span class="enumeration_section">6.13.4</span>推理选项</h4>
                  <div>
                     <p>您可以使用<code class="codeph">Attachment</code>类中的以下方法（在包<code class="codeph">oracle.spatial.rdf.client.jena</code> ）向entailment调用添加选项：</p><pre class="oac_no_warn" dir="ltr">public void setUseLocalInference（boolean useLocalInference）public boolean getUseLocalInference（）public void setDefGraphForLocalInference（String defaultGraphName）public String getDefGraphForLocalInference（）public String getInferenceOption（）public void setInferenceOption（String inferenceOption）</pre><div class="example" id="GUID-9D4EE34E-FD90-46ED-9E6B-4BC1CDF4DE55__BGBDCIID">
                        <p class="titleinexample">示例6-8指定推理选项</p>
                        <p>有关这些方法的更多信息，请参阅Javadoc。</p>
                        <p><a href="rdf-suipport-for-apache-jena.html#GUID-9D4EE34E-FD90-46ED-9E6B-4BC1CDF4DE55__BGBDCIID">示例6-8</a>在创建蕴涵时启用并行推断（度数为4）和RAW格式。该示例还使用<code class="codeph">performInference</code>方法创建entailment（与使用<a href="SEM_APIS-reference.html#GUID-BF52CEC0-1BD9-4908-9EF1-F001B0527257">SEM_APIS.CREATE_ENTAILMENT</a> PL / SQL过程相当）。
                        </p><pre class="oac_no_warn" dir="ltr">import java.io.*; import com.hp.hpl.jena.query。*; import com.hp.hpl.jena.rdf.model。模型; import com.hp.hpl.jena.util。文件管理器; import com.hp.hpl.jena.util.iterator。*; import oracle.spatial.rdf.client.jena。*; import com.hp.hpl.jena.graph。*; import com.hp.hpl.jena.update。*; import com.hp.hpl.jena.sparql.core。DatasetImpl; public class TestNewInference {public static void main（String [] args）throws Exception {String szJdbcURL = args [0]; String szUser = args [1]; String szPasswd = args [2]; PrintStream psOut = System.out; Oracle oracle = new Oracle（szJdbcURL，szUser，szPasswd）; String szTBoxName =“test_new_tbox”; {//首先构造一个TBox并加载几个公理ModelOracleSem modelTBox = ModelOracleSem.createOracleSemModel（oracle，szTBoxName）; String insertString =“PREFIX my：&lt;http://my.com/&gt;”+“PREFIX rdfs：&lt;http://www.w3.org/2000/01/rdf-schema#&gt;”+“INSERT DATA”+ “{my：C1 rdfs：subClassOf my：C2。”+“my：C2 rdfs：subClassOf my：C3。”+“my：C3 rdfs：subClassOf my：C4。”+“}”; UpdateAction.parseExecute（insertString，modelTBox）; modelTBox.close（）; } String szABoxName =“test_new_abox”; {//构造一个ABox并加载一些四边形ModelOracleSem modelABox = ModelOracleSem.createOracleSemModel（oracle，szABoxName）; DatasetGraphOracleSem dataset = DatasetGraphOracleSem.createFrom（modelABox.getGraph（））; modelABox.close（）; String insertString =“PREFIX my：&lt;http://my.com/&gt;”+“PREFIX rdf：&lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt;”+“ INSERT DATA“+”{GRAPH my：G1 {my：I1 rdf：type my：C1。“+”my：I2 rdf：type my：C2。“+”}“+”};“+”INSERT DATA“+ “{GRAPH my：G2 {my：J1 rdf：type my：C3。”+“}”+“}”; UpdateAction.parseExecute（insertString，dataset）; dataset.close（）; } String [] attachedModels = new String [1]; attachedModels [0] = szTBoxName; String [] attachedRBs = {“OWL2RL”};附件附件= Attachment.createInstance（attachedModels，attachedRBs，InferenceMaintenanceMode。NO_UPDATE，QueryOptions。ALLOW_QUERY_INVALID）; //我们将运行基于命名图的本地推理attachment.setUseLocalInference（true）; //设置默认图形（TBox）attachment.setDefGraphForLocalInference（szTBoxName）; //设置推理选项以使用平行推理//度为4和RAW格式。
    <span class="bold">attachment.setInferenceOption（ “DOP = 4，RAW8 = T”）;</span> GraphOracleSem graph = new GraphOracleSem（oracle，szABoxName，attachment）; DatasetGraphOracleSem dsgos = DatasetGraphOracleSem.createFrom（graph）; graph.close（）; //调用create_entailment PL / SQL API <span class="bold">dsgos.performInference（）;</span> psOut.println（“TestNewInference：#offerred graph”+ Long.toString（dsgos.getInferredGraphSize（）））; String queryString =“SELECT？G ？s？p？o {GRAPH？G {？s？p？o}}“;查询查询= QueryFactory.create（queryString，Syntax.syntaxARQ）; QueryExecution qexec = QueryExecutionFactory.create（query，DatasetImpl.wrap（dsgos））; ResultSet results = qexec.execSelect（）; ResultSetFormatter.out（psOut） ，结果）; dsgos.close（）; oracle.dispose（）;}}</pre><p><a href="rdf-suipport-for-apache-jena.html#GUID-9D4EE34E-FD90-46ED-9E6B-4BC1CDF4DE55__BGBDCIID">例6-8</a>的输出如下。
                        </p><pre class="oac_no_warn" dir="ltr">TestNewInference：推断图9的数量------------------------------------------- -------------------------------------------------- ----------------------- | g | s | p | o | ================================================== ================================================== ================ | &lt;http://my.com/G1&gt; | &lt;http://my.com/I2&gt; | &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#type&gt; | &lt;http://my.com/C3&gt; | | &lt;http://my.com/G1&gt; | &lt;http://my.com/I2&gt; | &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#type&gt; | &lt;http://my.com/C2&gt; | | &lt;http://my.com/G1&gt; | &lt;http://my.com/I2&gt; | &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#type&gt; | &lt;http://my.com/C4&gt; | | &lt;http://my.com/G1&gt; | &lt;http://my.com/I1&gt; | &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#type&gt; | &lt;http://my.com/C3&gt; | | &lt;http://my.com/G1&gt; | &lt;http://my.com/I1&gt; | &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#type&gt; | &lt;http://my.com/C1&gt; | | &lt;http://my.com/G1&gt; | &lt;http://my.com/I1&gt; | &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#type&gt; | &lt;http://my.com/C2&gt; | | &lt;http://my.com/G1&gt; | &lt;http://my.com/I1&gt; | &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#type&gt; | &lt;http://my.com/C4&gt; | | &lt;http://my.com/G2&gt; | &lt;http://my.com/J1&gt; | &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#type&gt; | &lt;http://my.com/C3&gt; | | &lt;http://my.com/G2&gt; | &lt;http://my.com/J1&gt; | &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#type&gt; | &lt;http://my.com/C4&gt; | -------------------------------------------------- -------------------------------------------------- ----------------</pre><p>有关使用OWL推理的信息，请参阅<a href="owl-concepts.html#GUID-30145814-CB5E-45ED-B220-677515F91AA9" title="您可以使用蕴涵规则来执行本机OWL推理。">使用OWL推理</a> 。
                        </p>
                     </div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-CBBCF550-832C-402A-89D2-0CDA62D27F0C" title="本节描述了RDF语义图支持Apache Jena所展示的一些RDF语义图功能。">支持服务器端API</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="RDFRM267"></a><div class="props_rev_3"><a id="GUID-5DA9FC7D-DF28-43A0-826C-819D958A5724" name="GUID-5DA9FC7D-DF28-43A0-826C-819D958A5724"></a><h4 id="RDFRM-GUID-5DA9FC7D-DF28-43A0-826C-819D958A5724" class="sect4"><span class="enumeration_section">6.13.5</span> PelletInfGraph类支持已弃用</h4>
                  <div>
                     <p>不推荐支持Apache Jena支持<code class="codeph">PelletInfGraph</code>类。您应该通过适用于Oracle数据库的PelletDb OWL 2推理器使用更优化的Oracle / Pellet集成。
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-CBBCF550-832C-402A-89D2-0CDA62D27F0C" title="本节描述了RDF语义图支持Apache Jena所展示的一些RDF语义图功能。">支持服务器端API</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="RDFRM269"></a><a id="RDFRM270"></a><a id="RDFRM271"></a><a id="RDFRM469"></a><a id="RDFRM268"></a><div class="props_rev_3"><a id="GUID-1109AB37-AFD5-4172-B7E5-6F279782A22E" name="GUID-1109AB37-AFD5-4172-B7E5-6F279782A22E"></a><h3 id="RDFRM-GUID-1109AB37-AFD5-4172-B7E5-6F279782A22E" class="sect3"><span class="enumeration_section">6.14</span>使用Apache Jena的RDF语义图支持批量加载</h3>
               <div>
                  <p>要将数千到数十万个RDF / OWL数据文件加载到Oracle数据库中，可以使用<code class="codeph">OracleBulkUpdateHandler</code> Java类中的<code class="codeph">prepareBulk</code>和<code class="codeph">completeBulk</code>方法来简化任务。
                  </p>
                  <p><code class="codeph">OracleBulkUpdateHandler</code>类中的<code class="codeph">addInBulk</code>方法可以以批量加载方式将图形或模型的三元组加载到Oracle数据库中。如果图形或模型是Jena内存中的图形或模型，则操作受物理内存大小的限制。<code class="codeph">prepareBulk</code>方法绕过Jena内存中的图形或模型，并将直接输入流转换为RDF数据文件，解析数据，并将三元组加载到基础临时表中。如果临时表和用于存储长文字的附表尚不存在，则会自动创建它们。
                  </p>
                  <p>可以多次调用<code class="codeph">prepareBulk</code>方法，以将多个数据文件加载到同一个基础登台表中。假设硬件系统是平衡的并且有多个CPU内核和足够的I / O容量，它也可以同时调用。
                  </p>
                  <p>一旦所有数据文件都由<code class="codeph">prepareBulk</code>方法处理，您就可以调用<code class="codeph">completeBulk</code>将所有数据加载到语义网络中。
                  </p>
                  <div class="example" id="GUID-1109AB37-AFD5-4172-B7E5-6F279782A22E__BGBIAHIJ">
                     <p class="titleinexample">示例6-9将数据加载到临时表（prepareBulk）</p>
                     <p><a href="rdf-suipport-for-apache-jena.html#GUID-1109AB37-AFD5-4172-B7E5-6F279782A22E__BGBIAHIJ">示例6-9</a>显示了如何将目录<code class="codeph">dir_1</code>所有数据文件<code class="codeph">dir_1</code>到基础登台表中。支持长文字，并将存储在单独的表中。可以使用GZIP压缩数据文件以节省存储空间，如果使用GZIP压缩数据文件， <code class="codeph">prepareBulk</code>方法可以自动检测。
                     </p><pre class="oac_no_warn" dir="ltr">Oracle oracle = new Oracle（szJdbcURL，szUser，szPasswd）; GraphOracleSem graph = new GraphOracleSem（oracle，szModelName）; PrintStream psOut = System.out; String dirname =“dir_1”;文件fileDir = new File（dirname）; String [] szAllFiles = fileDir.list（）; //循环遍历目录中的所有文件（int idx = 0; idx &lt;szAllFiles.length; idx ++）{String szIndFileName = dirname + File.separator + szAllFiles [idx]; psOut.println（“process to [ID =”+ idx +“] file”+ szIndFileName）; psOut.flush（）; try {InputStream is = new FileInputStream（szIndFileName）; graph.getBulkUpdateHandler（）。prepareBulk（is，//输入流“http://example.com”，//基本URI“RDF / XML”，//数据文件类型：可以是RDF / XML，N-TRIPLE，等等“SEMTS”，// tablespace null，// flags null，// listener null // staging table name。）; is.close（）; } catch（Throwable t）{psOut.println（“Hit exception”+ t.getMessage（））; graph.close（）; oracle.dispose（）;</pre><p><a href="rdf-suipport-for-apache-jena.html#GUID-1109AB37-AFD5-4172-B7E5-6F279782A22E__BGBIAHIJ">例6-9中</a>的代码，从创建新的Oracle对象开始到以处置Oracle对象结束，可以并行执行。假设数据库硬件系统上有四核CPU和足够的I / O容量;您可以将所有数据文件分开并将它们保存到四个单独的目录中： <code class="codeph">dir_1</code> ， <code class="codeph">dir_2</code> ， <code class="codeph">dir_3</code>和<code class="codeph">dir_4</code> 。可以启动四个进程的Java线程，分别和并发地处理这些目录。（有关更多信息，请参阅<a href="rdf-suipport-for-apache-jena.html#GUID-143C26AB-2A65-4B6D-BE64-87A903D91ABD">并行（多线程）模式下使用prepareBulk</a> 。）
                     </p>
                  </div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-1109AB37-AFD5-4172-B7E5-6F279782A22E__BGBCCJJE">
                     <p class="titleinexample">示例6-10将临时表中的数据加载到语义网络（completeBulk）</p>
                     <p>处理<code class="codeph">completeBulk</code>所有数据文件后，您只需调用一次<code class="codeph">completeBulk</code>方法即可将登台表中的数据加载到语义网络中，如<a href="rdf-suipport-for-apache-jena.html#GUID-1109AB37-AFD5-4172-B7E5-6F279782A22E__BGBCCJJE">例6-10</a>所示。还将加载具有长文字的三元组。
                     </p><pre class="oac_no_warn" dir="ltr">graph.getBulkUpdateHandler（）。completeBulk（null，//用于调用SEM_APIS.bulk_load_from_staging_table的标志// //登台表名称）;</pre><p><code class="codeph">prepareBulk</code>方法也可以将Jena模型作为输入数据源，在这种情况下，Jena模型中的三元组被加载到底层的临时表中。有关更多信息，请参阅Javadoc。
                     </p>
                  </div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-1109AB37-AFD5-4172-B7E5-6F279782A22E__BGBEBAED">
                     <p class="titleinexample">示例6-11将prepareBulk与RDFa一起使用</p>
                     <p><a id="d44532e5497" class="indexterm-anchor"></a><a id="d44532e5501" class="indexterm-anchor"></a>除了从Jena模型和数据文件加载三元组之外， <code class="codeph">prepareBulk</code>方法还支持RDFa，如<a href="rdf-suipport-for-apache-jena.html#GUID-1109AB37-AFD5-4172-B7E5-6F279782A22E__BGBEBAED">例6-11</a>所示。（RDFa在<a href="http://www.w3.org/TR/xhtml-rdfa-primer/" target="_blank"><code class="codeph">http://www.w3.org/TR/xhtml-rdfa-primer/</code></a>有解释。）</p><pre class="oac_no_warn" dir="ltr">graph.getBulkUpdateHandler（）。prepareBulk（rdfaUrl，// url到使用RDFa“SEMTS”的网页，// tablespace null，// flags null，// listener null // staging table name）;</pre><p>要解析RDFa，必须在类路径中包含相关的<code class="codeph">java-rdfa</code>库。无需其他设置或API调用。（有关java-rdfa的信息，请参阅<a href="http://www.rootdev.net/maven/projects/java-rdfa/" target="_blank"><code class="codeph">http://www.rootdev.net/maven/projects/java-rdfa/</code></a>以及项目信息下的其他主题。）
                     </p>
                     <p>请注意，如果<code class="codeph">rdfaUrl</code>位于防火墙之外，则可能需要设置以下与HTTP代理相关的Java VM属性：</p><pre class="oac_no_warn" dir="ltr">-Dhttp.proxyPort = ...-Dhttp.proxyHost = ...
</pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-1109AB37-AFD5-4172-B7E5-6F279782A22E__BGBFBJEF">
                     <p class="titleinexample">示例6-12将Quad加载到DatasetGraph中</p>
                     <p>本节中的上述示例将三重数据加载到单个图形中。加载一个可以跨多个命名图（例如在NQUADS格式数据）跨越四倍数据需要使用的<code class="codeph">DatasetGraphOracleSem</code>类。所述<code class="codeph">DatasetGraphOracleSem</code>类不使用<code class="codeph">BulkUpdateHandler</code> API，但提供类似的<code class="codeph">prepareBulk</code>和<code class="codeph">completeBulk</code>接口，如图<a href="rdf-suipport-for-apache-jena.html#GUID-1109AB37-AFD5-4172-B7E5-6F279782A22E__BGBFBJEF">例6-12</a> 。
                     </p><pre class="oac_no_warn" dir="ltr">Oracle oracle = new Oracle（szJdbcURL，szUser，szPasswd）; //只能从现有的GraphOracleSem GraphOracleSem graph = new GraphOracleSem（oracle，szModelName）创建DatasetGraphOracleSem; DatasetGraphOracleSem dataset = DatasetGraphOracleSem.createFrom（graph）; //不再需要图形，关闭它以释放资源graph.close（）; try {InputStream is = new FileInputStream（szFileName）; //将NQUADS文件加载到临时表中。这个文件可以是gzipp'ed。dataset.prepareBulk（是，//输入流“http：//my.base/”，//基URI“N-QUADS”，//数据文件类型;可以是“TRIG”“SEMTS”，// tablespace null ，// flags null，// listener null，// staging table name false //在加载前截断登台表）; //从登台表加载四边形到数据集dataset.completeBulk（null，// flags;在四核机器上可以是“PARSE PARALLEL_CREATE_INDEX PARALLEL = 4 // mbv_method = shadow”// //登台表名）; } catch（Throwable t）{System.out.println（“Hit exception”+ t.getMessage（））; } finally {dataset.close（）; oracle.dispose（）; }</pre></div>
                  <!-- class="example" -->
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-143C26AB-2A65-4B6D-BE64-87A903D91ABD">在并行（多线程）模式下使用prepareBulk</a><br></li>
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-3E030B40-C8C5-45B7-BA12-D925AAAF4D0B">在数据加载期间处理非法语法</a><br></li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-3F437E3E-3B74-4CCF-9F16-B2B07B3899E8" title="Apache Jena的RDF语义图支持（这里也称为对Apache Jena的支持）通过实现着名的Jena Graph，Model和DatasetGraph API为Oracle Spatial和Graph RDF语义图提供了基于Java的接口。">Apache Jena的RDF语义图支持</a></p>
                     </div>
                  </div>
               </div>
               <a id="RDFRM471"></a><a id="RDFRM470"></a><div class="props_rev_3"><a id="GUID-143C26AB-2A65-4B6D-BE64-87A903D91ABD" name="GUID-143C26AB-2A65-4B6D-BE64-87A903D91ABD"></a><h4 id="RDFRM-GUID-143C26AB-2A65-4B6D-BE64-87A903D91ABD" class="sect4"><span class="enumeration_section">6.14.1</span>并行（多线程）模式使用prepareBulk</h4>
                  <div>
                     <p><a href="rdf-suipport-for-apache-jena.html#GUID-1109AB37-AFD5-4172-B7E5-6F279782A22E__BGBIAHIJ">例6-9</a>提供了一种将文件系统目录下的一组文件顺序加载到Oracle数据库表（登台表）的方法。<a href="rdf-suipport-for-apache-jena.html#GUID-143C26AB-2A65-4B6D-BE64-87A903D91ABD__BGBDJCHC">例6-13</a>同时将一组文件加载到Oracle表（登台表）。并行度由输入参数<code class="codeph">iMaxThreads</code> 。
                     </p>
                     <p>在具有4个或更多CPU内核的平衡硬件设置中，将<code class="codeph">iMaxThreads</code>设置为8（或16）可以在需要处理许多数据文件时显着提高<code class="codeph">prepareBulk</code>操作的速度。
                     </p>
                     <div class="example" id="GUID-143C26AB-2A65-4B6D-BE64-87A903D91ABD__BGBDJCHC">
                        <p class="titleinexample">示例6-13将prepareBulk与iMaxThreads一起使用</p><pre class="oac_no_warn" dir="ltr">public void testPrepareInParallel（String jdbcUrl，String user，String password，String modelName，String lang，String tbs，String dirname，int iMaxThreads，PrintStream psOut）抛出SQLException，IOException，InterruptedException {File dir = new File（dirname）; File [] files = dir.listFiles（）; //创建一组物理Oracle连接和图形对象Oracle [] oracles = new Oracle [iMaxThreads]; GraphOracleSem [] graphs = new GraphOracleSem [iMaxThreads]; for（int idx = 0; idx &lt;iMaxThreads; idx ++）{oracles [idx] = new Oracle（jdbcUrl，user，password）; graphs [idx] = new GraphOracleSem（oracles [idx]，modelName）; } PrepareWorker [] workers = new PrepareWorker [iMaxThreads]; Thread [] threads = new Thread [iMaxThreads]; for（int idx = 0; idx &lt;iMaxThreads; idx ++）{workers [idx] = new PrepareWorker（graphs [idx]，files，idx，iMaxThreads，lang，tbs，psOut）; threads [idx] = new Thread（workers [idx]，workers [idx] .getName（））; psOut.println（“testPrepareInParallel：PrepareWorker”+ idx +“running”）;线程[IDX]。开始（）; } psOut.println（“testPrepareInParallel：所有线程都已启动”）; for（int idx = 0; idx &lt;iMaxThreads; idx ++）{threads [idx] .join（）; for（int idx = 0; idx &lt;iMaxThreads; idx ++）{graphs [idx] .close（）;预言[IDX] .dispose（）;静态类PrepareWorker实现Runnable {GraphOracleSem graph = null; int idx; int线程; File [] files = null; String lang = null; String tbs = null; PrintStream psOut; public void run（）{long lStartTime = System.currentTimeMillis（）; for（int idxFile = idx; idxFile &lt;files.length; idxFile + = threads）{File file = files [idxFile];尝试{FileInputStream fis = new FileInputStream（file）; graph.getBulkUpdateHandler（）。prepareBulk（fis，“http://base.com/”，lang，tbs，null，//标记新的MyListener（psOut），// listener null //表名）; fis.close（）; } catch（异常e）{psOut.println（“PrepareWorker：thread [”+ getName（）+“] error”+ e.getMessage（））; } psOut.println（“PrepareWorker：thread [”+ getName（）+“]完成”+ idxFile +“，file =”+ file.toString（）+“in（ms）”+（System.currentTimeMillis（） - lStartTime））; public PrepareWorker（GraphOracleSem graph，File [] files，int idx，int threads，String lang，String tbs，PrintStream psOut）{this.graph = graph; this.files = files; this.psOut = psOut; this.idx = idx; this.threads = threads; this.files = files; this.lang = lang; this.tbs = tbs; public String getName（）{return“PrepareWorker”+ idx;静态类MyListener实现StatusListener {PrintStream m_ps = null; public MyListener（PrintStream ps）{m_ps = ps; } long lLastBatch = 0; public void statusChanged（long count）{if（count  -  lLastBatch&gt; = 10000）{m_ps.println（“process to”+ Long.toString（count））; lLastBatch = count; public int illegalStmtEncountered（Node graphNode，Triple triple，long count）{m_ps.println（“hit object statement with object”+ triple.getObject（）。toString（））;返回0; // 跳过它 } }</pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-1109AB37-AFD5-4172-B7E5-6F279782A22E" title="要将数千到数十万个RDF / OWL数据文件加载到Oracle数据库中，可以使用OracleBulkUpdateHandler Java类中的prepareBulk和completeBulk方法来简化任务。">使用Apache Jena的RDF语义图支持批量加载</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="RDFRM473"></a><a id="RDFRM472"></a><div class="props_rev_3"><a id="GUID-3E030B40-C8C5-45B7-BA12-D925AAAF4D0B" name="GUID-3E030B40-C8C5-45B7-BA12-D925AAAF4D0B"></a><h4 id="RDFRM-GUID-3E030B40-C8C5-45B7-BA12-D925AAAF4D0B" class="sect4"><span class="enumeration_section">6.14.2</span>在数据加载过程中处理非法语法</h4>
                  <div>
                     <p>使用<code class="codeph">prepareBulk</code>时，您可以跳过非法三元组和四元组。如果源RDF数据可能包含语法错误，则此功能非常有用。在<a href="rdf-suipport-for-apache-jena.html#GUID-3E030B40-C8C5-45B7-BA12-D925AAAF4D0B__BGBHCIIA">例6-14中</a> ， <code class="codeph">StatusListener</code>接口的自定义实现（在包<code class="codeph">oracle.spatial.rdf.client.jena</code>定义）作为参数传递给prepareBulk。在此示例中， <code class="codeph">illegalStmtEncountered</code>方法打印非法三元组的对象字段，并返回0，以便<code class="codeph">prepareBulk</code>可以跳过该非法三元组并继续前进。
                     </p>
                     <div class="example" id="GUID-3E030B40-C8C5-45B7-BA12-D925AAAF4D0B__BGBHCIIA">
                        <p class="titleinexample">例6-14使用非法语法跳过三元组</p><pre class="oac_no_warn" dir="ltr">....Oracle oracle = new Oracle（jdbcUrl，user，password）; GraphOracleSem graph = new GraphOracleSem（oracle，modelName）; PrintStream psOut = System.err; graph.getBulkUpdateHandler（）。prepareBulk（new FileInputStream（rdfDataFilename），“http://base.com/”，// base lang，//数据格式，可以是“N-TRIPLES”“RDF / XML”......tbs，// tablespace name null，// flags new MyListener（psOut），//回调显示进度并处理非法三元组/四元组null，// tableName，如果null使用默认名称false //截断现有登台表） ; graph.close（）; oracle.dispose（）; ....//自定义StatusListener接口实现公共类MyListener实现StatusListener {PrintStream m_ps = null; public MyListener（PrintStream ps）{m_ps = ps; public void statusChanged（long count）{// m_ps.println（“process to”+ Long.toString（count））; public int illegalStmtEncountered（Node graphNode，Triple triple，long count）{m_ps.println（“hit object statement with object”+ triple.getObject（）。toString（））;返回0; // 跳过它 } }</pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-1109AB37-AFD5-4172-B7E5-6F279782A22E" title="要将数千到数十万个RDF / OWL数据文件加载到Oracle数据库中，可以使用OracleBulkUpdateHandler Java类中的prepareBulk和completeBulk方法来简化任务。">使用Apache Jena的RDF语义图支持批量加载</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="RDFRM474"></a><div class="props_rev_3"><a id="GUID-7EF14C6C-9D85-4BE8-8F51-732822CA178E" name="GUID-7EF14C6C-9D85-4BE8-8F51-732822CA178E"></a><h3 id="RDFRM-GUID-7EF14C6C-9D85-4BE8-8F51-732822CA178E" class="sect3"><span class="enumeration_section">6.15</span>自动变量重命名</h3>
               <div>
                  <p>自动变量重命名可以启用以前无法成功运行的某些查询。</p>
                  <p>以前，SPARQL查询中使用的变量名称作为SQL语句的一部分直接传递到Oracle数据库。如果变量名称包含SQL或PL / SQL保留关键字，则查询无法执行。例如，以下SPARQL查询过去因为单词date作为Oracle数据库SQL处理引擎的特殊含义而失败。</p><pre class="oac_no_warn" dir="ltr">选择 ？date {：event：happenOn？日期}</pre><p>目前，此查询不会失败，因为在将查询发送到Oracle数据库以供执行之前，执行“智能扫描”并对某些保留变量名称（或非常长的变量名称）进行自动替换。替换基于保留关键字列表，这些关键字存储在<code class="codeph">sdordfclient.jar</code>嵌入的以下文件中：</p><pre class="oac_no_warn" dir="ltr">ORACLE /空间/ RDF /客户端/耶拿/ oracle_sem_reserved_keywords.lst</pre><p>此文件包含100多个条目，您可以编辑该文件以在必要时添加条目。</p>
                  <p>以下是使用SQL或PL / SQL保留关键字作为变量的SPARQL查询的示例，并且由于自动变量重命名而成功：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>使用<code class="codeph">SELECT</code>作为变量名进行查询：</p><pre class="oac_no_warn" dir="ltr">PREFIX foaf：&lt;http://xmlns.com/foaf/0.1/&gt;选择？选择 ？z哪里{？SELECT foaf：名字？年。可选的 {？SELECT foaf：知道吗？ž。}}</pre></li>
                     <li>
                        <p>使用<code class="codeph">ARRAY</code>和<code class="codeph">DATE</code>作为变量名进行查询：</p><pre class="oac_no_warn" dir="ltr">PREFIX x：&lt;http：//example.com#&gt; construct {？ARRAY x：约会？约会。在哪里{？ARRAY x：happenOn？约会。}</pre></li>
                  </ul>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-3F437E3E-3B74-4CCF-9F16-B2B07B3899E8" title="Apache Jena的RDF语义图支持（这里也称为对Apache Jena的支持）通过实现着名的Jena Graph，Model和DatasetGraph API为Oracle Spatial和Graph RDF语义图提供了基于Java的接口。">Apache Jena的RDF语义图支持</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="RDFRM475"></a><div class="props_rev_3"><a id="GUID-5A76E641-BF3D-435C-969E-17A61E775806" name="GUID-5A76E641-BF3D-435C-969E-17A61E775806"></a><h3 id="RDFRM-GUID-5A76E641-BF3D-435C-969E-17A61E775806" class="sect3"><span class="enumeration_section">6.16</span> JavaScript对象表示法（JSON）格式支持</h3>
               <div>
                  <p>SPARQL查询响应支持JavaScript Object Notation（JSON）格式。JSON数据格式简单，紧凑，非常适合JavaScript程序。</p>
                  <p>例如，假设以下Java代码段，它调用<code class="codeph">ResultSetFormatter.outputAsJSON</code>方法：</p><pre class="oac_no_warn" dir="ltr">Oracle oracle = new Oracle（jdbcUrl，user，password）; GraphOracleSem graph = new GraphOracleSem（oracle，modelName）; ModelOracleSem model = new ModelOracleSem（graph）; graph.add（new Triple（Node.createURI（“http：// ds1”），Node.createURI（“http：// dp1”），Node.createURI（“http：// do1”）））; graph.add（new Triple（Node.createURI（“http：// ds2”），Node.createURI（“http：// dp2”），Node.createURI（“http：// do2”）））; graph.commitTransaction（）;查询q = QueryFactory.create（“选择？s？p？o哪里{？s？p？o}“，Syntax.syntaxARQ）; QueryExecution qexec = QueryExecutionFactory.create（q，model）; ResultSet results = qexec.execSelect（）; <span class="bold">ResultSetFormatter.outputAsJSON（System.out，results）;</span>
</pre><p>JSON输出如下：</p><pre class="oac_no_warn" dir="ltr">{“head”：{“vars”：[“s”，“p”，“o”]}，“results”：{“bindings”：[{“s”：{“type”：“uri”，“值“：”http：// ds1“}，”p“：{”type“：”uri“，”value“：”http：// dp1“}，”o“：{”type“：”uri“ ，“value”：“http：// do1”}}，{“s”：{“type”：“uri”，“value”：“http：// ds2”}，“p”：{“type” ：“uri”，“value”：“http：// dp2”}，“o”：{“type”：“uri”，“value”：“http：// do2”}}]}}</pre><p>可以按如下方式更改上述示例，以查询远程SPARQL端点，而不是直接查询Oracle数据库。（如果远程SPARQL端点位于防火墙之外，则可能需要设置HTTP代理。）</p><pre class="oac_no_warn" dir="ltr">查询q = QueryFactory.create（“选择？s？p？o哪里{？s？p？o，“，Syntax.syntaxARQ）; QueryExecution qe = QueryExecutionFactory.sparqlService（sparqlURL，q）; ResultSet results = qexec.execSelect（）; ResultSetFormatter.outputAsJSON（System.out，results）;</pre><p>要将此部分中的第一个示例扩展为命名图，以下代码段将两个四元组添加到同一Oracle模型，执行基于命名图形的SPARQL查询，并将查询输出序列化为JSON格式：</p><pre class="oac_no_warn" dir="ltr">DatasetGraphOracleSem dsgos = DatasetGraphOracleSem.createFrom（graph）; graph.close（）; dsgos.add（new Quad（Node.createURI（“http：// g1”），Node.createURI（“http：// s1”），Node.createURI（“http：// p1”），Node.createURI（ “http：// o1”）））; dsgos.add（new Quad（Node.createURI（“http：// g2”），Node.createURI（“http：// s2”），Node.createURI（“http：// p2”），Node.createURI（ “http：// o2”）））;查询q1 = QueryFactory.create（“选择？G ？s？p？o {GRAPH？G {？s？p？o}}“）; QueryExecution qexec1 = QueryExecutionFactory.create（q1，DatasetImpl.wrap（dsgos））; ResultSet results1 = qexec1.execSelect（）; <span class="bold">ResultSetFormatter.outputAsJSON（System.out，</span> results1 <span class="bold">）;</span> dsgos.close（）; oracle .dispose（）;</pre><p>JSON输出如下：</p><pre class="oac_no_warn" dir="ltr">{“head”：{“vars”：[“g”，“s”，“p”，“o”]}，“results”：{“bindings”：[{“g”：{“type”：“ uri“，”value“：”http：// g1“}，”s“：{”type“：”uri“，”value“：”http：// s1“}，”p“：{”type“ ：“uri”，“value”：“http：// p1”}，“o”：{“type”：“uri”，“value”：“http：// o1”}}，{“g”： {“type”：“uri”，“value”：“http：// g2”}，“s”：{“type”：“uri”，“value”：“http：// s2”}，“p “：{”type“：”uri“，”value“：”http：// p2“}，”o“：{”type“：”uri“，”value“：”http：// o2“}} ]}}</pre><p>您还可以通过HTTP针对基于Joseki的SPARQL端点获取JSON响应，如以下示例所示。通常，在对SPARQL Web服务端点执行SPARQL查询时， <code class="codeph">Accept request-head</code>字段设置为<code class="codeph">application/sparql-results+xm</code> l。对于JSON输出格式，将<code class="codeph">Accept request-head</code>字段替换为<code class="codeph">application/sparql-results+json</code> 。
                  </p><pre class="oac_no_warn" dir="ltr">http：// <span class="italic">hostname</span> ：7001 / joseki / oracle？query = &lt;URL_ENCODED_SPARQL_QUERY&gt; <span class="bold">＆output = json</span></pre></div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-3F437E3E-3B74-4CCF-9F16-B2B07B3899E8" title="Apache Jena的RDF语义图支持（这里也称为对Apache Jena的支持）通过实现着名的Jena Graph，Model和DatasetGraph API为Oracle Spatial和Graph RDF语义图提供了基于Java的接口。">Apache Jena的RDF语义图支持</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="RDFRM476"></a><div class="props_rev_3"><a id="GUID-78916DE5-15D7-4E6B-B8CA-23DF0D89423C" name="GUID-78916DE5-15D7-4E6B-B8CA-23DF0D89423C"></a><h3 id="RDFRM-GUID-78916DE5-15D7-4E6B-B8CA-23DF0D89423C" class="sect3"><span class="enumeration_section">6.17</span>其他建议和指南</h3>
               <div>
                  <p>本节包含与SPARQL查询相关的各种建议和其他信息。</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-E73236FF-6302-426F-8F93-F7A9E75A69AC">BOUND或！BOUND而不是EXISTS或NOT EXISTS</a><br></li>
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-3224D3F5-C6FE-4B67-8E26-E9145C5A0E15">SPARQL 1.1 SELECT表达式</a><br></li>
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-BFF7D4AB-BE8C-4B1A-B057-5522917C9B50">涉及Bnodes的语法（空白节点）</a><br></li>
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-13FA5D35-7AD2-4DB8-A10E-120459C1761E">服务条款中的限制</a><br></li>
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-84DF816D-B216-414E-BB47-A0068C7DCC04">OracleGraphWrapperForOntModel类以获得更好的性能</a><br></li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-3F437E3E-3B74-4CCF-9F16-B2B07B3899E8" title="Apache Jena的RDF语义图支持（这里也称为对Apache Jena的支持）通过实现着名的Jena Graph，Model和DatasetGraph API为Oracle Spatial和Graph RDF语义图提供了基于Java的接口。">Apache Jena的RDF语义图支持</a></p>
                     </div>
                  </div>
               </div>
               <a id="RDFRM477"></a><div class="props_rev_3"><a id="GUID-E73236FF-6302-426F-8F93-F7A9E75A69AC" name="GUID-E73236FF-6302-426F-8F93-F7A9E75A69AC"></a><h4 id="RDFRM-GUID-E73236FF-6302-426F-8F93-F7A9E75A69AC" class="sect4"><span class="enumeration_section">6.17.1</span> BOUND或！BOUND而不是EXISTS或NOT EXISTS</h4>
                  <div>
                     <p>为了获得更好的性能，请使用<code class="codeph">BOUND</code>或<code class="codeph">!BOUND</code>而不是<code class="codeph">EXISTS</code>或<code class="codeph">NOT EXISTS</code> 。</p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-78916DE5-15D7-4E6B-B8CA-23DF0D89423C" title="本节包含与SPARQL查询相关的各种建议和其他信息。">其他建议和指南</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="RDFRM478"></a><div class="props_rev_3"><a id="GUID-3224D3F5-C6FE-4B67-8E26-E9145C5A0E15" name="GUID-3224D3F5-C6FE-4B67-8E26-E9145C5A0E15"></a><h4 id="RDFRM-GUID-3224D3F5-C6FE-4B67-8E26-E9145C5A0E15" class="sect4"><span class="enumeration_section">6.17.2</span> SPARQL 1.1 SELECT表达式</h4>
                  <div>
                     <p>即使Oracle数据库中当前不支持该功能，也可以使用SPARQL 1.1 SELECT表达式而不会产生任何显着的性能开销。示例包括以下内容：</p><pre class="oac_no_warn" dir="ltr">- 使用MD5和SHA1函数查询PREFIX foaf：&lt;http://xmlns.com/foaf/0.1/&gt; PREFIX xsd：&lt;http://www.w3.org/2001/XMLSchema#&gt; PREFIX例如：&lt;http： //biometrics.example/ns#&gt; SELECT？名字（md5（？名称）为？name_in_md5）（sha1（？电子邮件）？sha1）WHERE {？x foaf：名字？名称 ;例如：电子邮件？邮件。使用CONCAT函数查询PREFIX foaf：&lt;http://xmlns.com/foaf/0.1/&gt; SELECT（CONCAT（？G， ” ”， ？S）AS？姓名）WHERE {？P foaf：givenName？G ; foaf：姓？S}</pre></div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-78916DE5-15D7-4E6B-B8CA-23DF0D89423C" title="本节包含与SPARQL查询相关的各种建议和其他信息。">其他建议和指南</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="RDFRM479"></a><div class="props_rev_3"><a id="GUID-BFF7D4AB-BE8C-4B1A-B057-5522917C9B50" name="GUID-BFF7D4AB-BE8C-4B1A-B057-5522917C9B50"></a><h4 id="RDFRM-GUID-BFF7D4AB-BE8C-4B1A-B057-5522917C9B50" class="sect4"><span class="enumeration_section">6.17.3</span>涉及Bnode的语法（空节点）</h4>
                  <div>
                     <p>涉及bnodes的语法可以在查询模式中自由使用。例如，解析器级别支持以下与bnode相关的语法，因此每个语法都等同于其完整的基于三重查询模式的版本。</p><pre class="oac_no_warn" dir="ltr">：x：q [：p“v”]。（1？x 3 4）：p“w”。（1 [：p：q]（2））。</pre></div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-78916DE5-15D7-4E6B-B8CA-23DF0D89423C" title="本节包含与SPARQL查询相关的各种建议和其他信息。">其他建议和指南</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="RDFRM480"></a><div class="props_rev_3"><a id="GUID-13FA5D35-7AD2-4DB8-A10E-120459C1761E" name="GUID-13FA5D35-7AD2-4DB8-A10E-120459C1761E"></a><h4 id="RDFRM-GUID-13FA5D35-7AD2-4DB8-A10E-120459C1761E" class="sect4"><span class="enumeration_section">6.17.4</span>服务条款的限制</h4>
                  <div>
                     <p>编写SPARQL 1.1联合查询时，可以在SERVICE子句内的子查询中设置对返回行的限制。这可以有效地限制在本地存储库和远程SPARQL端点之间传输的数据量。</p>
                     <p>例如，以下查询指定SERVICE子句中子查询中的<code class="codeph">limit 100</code> ：</p><pre class="oac_no_warn" dir="ltr">PREFIX：&lt;http://example.com/&gt; SELECT？s？在哪里{？s：名称“CA” <span class="bold">SERVICE</span> &lt;http：// REMOTE_SPARQL_ENDPOINT_HERE&gt; {select？s？o {？s：信息？o} <span class="bold">限制100</span> }}</pre></div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-78916DE5-15D7-4E6B-B8CA-23DF0D89423C" title="本节包含与SPARQL查询相关的各种建议和其他信息。">其他建议和指南</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="RDFRM482"></a><a id="RDFRM483"></a><a id="RDFRM481"></a><div class="props_rev_3"><a id="GUID-84DF816D-B216-414E-BB47-A0068C7DCC04" name="GUID-84DF816D-B216-414E-BB47-A0068C7DCC04"></a><h4 id="RDFRM-GUID-84DF816D-B216-414E-BB47-A0068C7DCC04" class="sect4"><span class="enumeration_section">6.17.5</span> OracleGraphWrapperForOntModel类以获得更好的性能</h4>
                  <div>
                     <p>Jena <code class="codeph">OntModel</code>类允许您创建，修改和分析存储在Jena模型中的本体。但是， <code class="codeph">OntModel</code>实现未针对存储在数据库中的语义数据进行优化。当将<code class="codeph">OntModel</code>与Oracle模型一起使用时，这会导致性能欠佳。因此，已创建类<code class="codeph">OracleGraphWrapperForOntModel</code>以缓解此性能问题。
                     </p>
                     <p><code class="codeph">OracleGraphWrapperForOntModel</code>类实现Jena <code class="codeph">Graph</code>接口，并表示由Oracle RDF / OWL模型支持的图形，该模型旨在与Jena <code class="codeph">OntModel</code> API一起使用。 <code class="codeph">OracleGraphWrapperForOntModel</code>类在混合方法中使用两个语义存储来持久更改和响应查询。两个语义存储都包含相同的数据，但一个驻留在内存中，而另一个驻留在Oracle数据库中。
                     </p>
                     <p>通过<code class="codeph">OntModel</code>查询时， <code class="codeph">OracleGraphWrapperForOntModel</code>图形会针对内存存储运行查询以提高性能。但是， <code class="codeph">OracleGraphWrapperForOntModel</code>类通过对两个存储应用更改来<code class="codeph">OracleGraphWrapperForOntModel</code>通过<code class="codeph">OntModel</code>所做的更改，例如添加或删除类。
                     </p>
                     <p>由于其混合方法， <code class="codeph">OracleGraphWrapperForOntModel</code>图要求为JVM分配足够的内存以在内存中存储本体的副本。在内部实验中，发现具有大约300万个三元组的本体需要6或更多GB的物理存储器。
                     </p>
                     <div class="example" id="GUID-84DF816D-B216-414E-BB47-A0068C7DCC04__BGBCIBHF">
                        <p class="titleinexample">示例6-15将OntModel与存储在Oracle数据库中的Ontology一起使用</p>
                        <p><a href="rdf-suipport-for-apache-jena.html#GUID-84DF816D-B216-414E-BB47-A0068C7DCC04__BGBCIBHF">示例6-15</a>显示了如何将<code class="codeph">OntModel</code> API与存储在Oracle模型中的现有本体一起使用。
                        </p><pre class="oac_no_warn" dir="ltr">//建立与Oracle语义存储和Oracle模型的连接//包含本体Oracle oracle = new Oracle（szJdbcURL，szUser，szPasswd）; GraphOracleSem oracleGraph = new GraphOracleSem（oracle，szModelName）; //使用oracle图创建一个新的混合图以保持//更改。此方法将所有来自oracle图形//的数据复制到内存中，这可能会显着增加JVM内存的使用量。Graph hybridGraph = OracleGraphWrapperForOntModel.getInstance（oracleGraph）; //围绕混合图构建模型，并使用Jena的// OntModel Model model = ModelFactory.createModelForGraph（hybridGraph）包装模型; OntModel ontModel = ModelFactory.createOntologyModel（ontModelSpec，model）; //在本体上执行操作OntClass personClass = ontModel.createClass（“&lt;http：// someuri / person&gt;”）; ontModel.createIndividual（personClass）; //关闭资源（也将关闭oracleGraph）！hybridGraph.close（）; ontModel.close（）;</pre><p>请注意，使用<code class="codeph">OracleGraphWrapperForOntModel</code>创建的任何<code class="codeph">OntModel</code>对象都不会反映另一个进程，底层<code class="codeph">OntModel</code>或引用相同底层模型的单独Oracle图对底层Oracle模型所做的更改。对本体的所有更改都应该通过单个<code class="codeph">OntModel</code>对象及其底层<code class="codeph">OracleGraphWrapperForOntModel</code>图，直到模型或图形关闭为止。
                        </p>
                     </div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-84DF816D-B216-414E-BB47-A0068C7DCC04__BGBBFEHH">
                        <p class="titleinexample">示例6-16使用自定义内存图</p>
                        <p>如果<code class="codeph">OracleGraphWrapperForOntModel</code>使用的默认内存中语义存储不足以用于本体和系统，则该类提供用于指定用作内存存储的自定义图形的接口。<a href="rdf-suipport-for-apache-jena.html#GUID-84DF816D-B216-414E-BB47-A0068C7DCC04__BGBBFEHH">例6-16</a>显示了如何创建<code class="codeph">OracleGraphWrapperForOntModel</code> ，它使用自定义内存中的图来回答来自<code class="codeph">OntModel</code>查询。
                        </p><pre class="oac_no_warn" dir="ltr">//建立与Oracle语义存储和Oracle模型的连接//包含本体Oracle oracle = new Oracle（szJdbcURL，szUser，szPasswd）; GraphOracleSem oracleGraph = new GraphOracleSem（oracle，szModelName）; //创建一个自定义的内存中图形，而不是使用默认的// Jena内存中的图形来快速回答OntModel查询。//请注意，此图表不需要*在内存中，但在内存中//是首选。GraphBase queryGraph = new CustomInMemoryGraphImpl（）; //使用oracle图创建一个新的混合图以保持//更改和自定义内存中图以回答查询。//还设置将数据从oracle图表复制到查询图表时要使用的并行度。int degreeOfParallelism = 4; Graph hybridGraph = OracleGraphWrapperForOntModel.getInstance（oracleGraph，queryGraph，degreeOfParallelism）; //使用Jena的OntModel Model model = ModelFactory.createModelForGraph（hybridGraph）构建模型并包装模型; OntModel ontModel = ModelFactory.createOntologyModel（ontModelSpec，model）; //对本体进行操作// ...//关闭资源（将关闭oracleGraph和queryGraph）！hybridGraph.close（）; ontModel.close（）;</pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-78916DE5-15D7-4E6B-B8CA-23DF0D89423C" title="本节包含与SPARQL查询相关的各种建议和其他信息。">其他建议和指南</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="RDFRM272"></a><div class="props_rev_3"><a id="GUID-9F748C0E-437D-4EBD-80CF-BFA91F3CFE3A" name="GUID-9F748C0E-437D-4EBD-80CF-BFA91F3CFE3A"></a><h3 id="RDFRM-GUID-9F748C0E-437D-4EBD-80CF-BFA91F3CFE3A" class="sect3"><span class="enumeration_section">6.18</span>使用Apache Jena的RDF语义图支持的示例查询</h3>
               <div>
                  <p>本节包括使用Apache Jena支持的示例查询。每个示例都是自包含的：它通常创建模型，创建三元组，执行可能涉及推理的查询，显示结果并删除模型。</p>
                  <p>此部分包含执行以下操作的查询：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>在一个示例“大学”本体中计算断言三元组和断言加上推断的三元组，通过URL引用本体并通过从本地文件批量加载本体</p>
                     </li>
                     <li>
                        <p>使用“系列”本体运行多个SPARQL查询，包括LIMIT，OFFSET，TIMEOUT，DOP（并行度），ASK，DESCRIBE，CONSTRUCT，GRAPH，ALLOW_DUP（具有多个模型的重复三元组）等特征，SPARUL（插入数据）</p>
                     </li>
                     <li>
                        <p>使用ARQ内置功能</p>
                     </li>
                     <li>
                        <p>使用SELECT强制转换查询</p>
                     </li>
                     <li>
                        <p>使用OracleConnection实例化Oracle数据库</p>
                     </li>
                     <li>
                        <p>使用Oracle数据库连接池</p>
                     </li>
                  </ul>
                  <p>要运行查询，您必须执行以下操作：</p>
                  <ol>
                     <li>
                        <p>将代码包含在Java源文件中。本节中使用的示例在Apache Jena下载支持的<code class="codeph">examples</code>目录中的文件中提供。
                        </p>
                     </li>
                     <li>
                        <p>编译Java源文件。例如：</p><pre class="oac_no_warn" dir="ltr">&gt; javac -classpath ../jar/'*'Test.java</pre><div class="infoboxnote" id="GUID-9F748C0E-437D-4EBD-80CF-BFA91F3CFE3A__GUID-2A9BF448-91E3-403D-B00A-61DBDA510A53">
                           <p class="notep1">注意：</p>
                           <p><code class="codeph">javac</code>和<code class="codeph">java</code>命令必须都在一个命令行中。
                           </p>
                        </div>
                     </li>
                     <li>
                        <p>运行已编译的文件。例如：</p><pre class="oac_no_warn" dir="ltr">&gt; java -classpath。/:../jar/'*'测试jdbc：oracle：thin：@localhost：1521：orcl scott <span class="italic">&lt;password-for-scott&gt;</span> M1</pre></li>
                  </ol>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-8A46A12A-0F46-4CFB-A3A2-1C7665BD05EF">Test.java：查询系列关系</a><br></li>
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-C736617D-BB68-4E5F-88D7-01D8521970FC">Test6.java：加载OWL本体并执行OWLPrime推理</a><br></li>
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-94180C4E-ED1F-4C18-86C7-54F9655975F5">Test7.java：批量加载OWL本体并执行OWLPrime推理</a><br></li>
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-74FAF9E7-2A45-4C07-A9C1-C4E074C9207A">Test8.java:SPARQL可选查询</a><br></li>
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-BA93593D-EA10-4688-820B-B726B80FA665">Test9.java：使用LIMIT和OFFSET的SPARQL查询</a><br></li>
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-FA8847E4-18A3-40D3-B62C-A5E3C10E3ECF">Test10.java：带有TIMEOUT和DOP的SPARQL查询</a><br></li>
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-175B2596-AEC0-4E7D-A2E0-1F642062625C">Test11.java：包含命名图的查询</a><br></li>
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-AEAC5A2F-BBEF-4778-8ABF-E951DB4FB8C4">Test12.java:SPARQL ASK查询</a><br></li>
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-AF589F89-86C1-4286-9364-EDD05217C9D9">Test13.java:SPARQL DESCRIBE查询</a><br></li>
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-55F97EB6-141A-46DC-AF20-4DB69AA83B49">Test14.java:SPARQL CONSTRUCT查询</a><br></li>
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-7B164F3A-550F-4363-B3F4-27EE2A43D6B6">Test15.java：查询多个模型并指定“允许重复”</a><br></li>
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-325FB548-0E9A-48A8-8DDA-71B37497938A">Test16.java:SPARQL更新</a><br></li>
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-13A02D52-426D-436C-90AF-73B1AB44FA0F">Test17.java:SPARQL查询与ARQ内置函数</a><br></li>
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-58FFA706-81FB-45E7-B6E1-61D6D43A054C">Test18.java：SELECT Cast Query</a><br></li>
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-92E455B0-DC5C-485C-A412-C28D898C8D0D">Test19.java：使用OracleConnection实例化Oracle数据库</a><br></li>
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-15F4439C-C1A5-4634-87CB-11F5347F25F9">Test20.java:Oracle数据库连接池</a><br></li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-3F437E3E-3B74-4CCF-9F16-B2B07B3899E8" title="Apache Jena的RDF语义图支持（这里也称为对Apache Jena的支持）通过实现着名的Jena Graph，Model和DatasetGraph API为Oracle Spatial和Graph RDF语义图提供了基于Java的接口。">Apache Jena的RDF语义图支持</a></p>
                     </div>
                  </div>
               </div>
               <a id="RDFRM274"></a><a id="RDFRM273"></a><div class="props_rev_3"><a id="GUID-8A46A12A-0F46-4CFB-A3A2-1C7665BD05EF" name="GUID-8A46A12A-0F46-4CFB-A3A2-1C7665BD05EF"></a><h4 id="RDFRM-GUID-8A46A12A-0F46-4CFB-A3A2-1C7665BD05EF" class="sect4"><span class="enumeration_section">6.18.1</span> Test.java：查询族关系</h4>
                  <div>
                     <div class="example" id="GUID-8A46A12A-0F46-4CFB-A3A2-1C7665BD05EF__CBBHGFFA">
                        <p class="titleinexample">示例6-17查询系列关系</p>
                        <p><a href="rdf-suipport-for-apache-jena.html#GUID-8A46A12A-0F46-4CFB-A3A2-1C7665BD05EF__CBBHGFFA">例6-17</a>指定John是Mary的父亲，它选择并显示每个<code class="codeph">fatherOf</code>关系中的主题和对象</p><pre class="oac_no_warn" dir="ltr">import oracle.spatial.rdf.client.jena。*; import com.hp.hpl.jena.rdf.model。模型; import com.hp.hpl.jena.graph。*; import com.hp.hpl.jena.query。*; public class Test {public static void main（String [] args）throws Exception {String szJdbcURL = args [0]; String szUser = args [1]; String szPasswd = args [2]; String szModelName = args [3]; Oracle oracle = new Oracle（szJdbcURL，szUser，szPasswd）; Model model = ModelOracleSem.createOracleSemModel（oracle，szModelName）; model.getGraph（）。add（Triple.create（Node.createURI（“http://example.com/John”），Node.createURI（“http://example.com/fatherOf”），Node.createURI（ “http://example.com/Mary”）））;查询查询= QueryFactory.create（“选择？F ？k WHERE {？f &lt;http://example.com/fatherOf&gt;？k。}“）; QueryExecution qexec = QueryExecutionFactory.create（query，model）; ResultSet results = qexec.execSelect（）; ResultSetFormatter.out（System.out，results，query）; model.close（）; oracle.dispose（ ）;}}</pre><p>以下是编译和运行<a href="rdf-suipport-for-apache-jena.html#GUID-8A46A12A-0F46-4CFB-A3A2-1C7665BD05EF__CBBHGFFA">例6-17</a>的命令，以及<code class="codeph">java</code>命令的预期输出。
                        </p><pre class="oac_no_warn" dir="ltr">javac -classpath ../jar/'*'Test.java java -classpath。/:../jar/'*'测试jdbc：oracle：thin：@localhost：1521：orcl scott <span class="italic">&lt;password-for-scott&gt;</span> M1 ------------------ --------------------------------------- | f | k | ================================================== ======= | &lt;http://example.com/John&gt; | &lt;http://example.com/Mary&gt; | -------------------------------------------------- -------</pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-9F748C0E-437D-4EBD-80CF-BFA91F3CFE3A" title="本节包括使用Apache Jena支持的示例查询。每个示例都是自包含的：它通常创建模型，创建三元组，执行可能涉及推理的查询，显示结果并删除模型。">使用Apache Jena的RDF语义图支持的示例查询</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="RDFRM276"></a><a id="RDFRM275"></a><div class="props_rev_3"><a id="GUID-C736617D-BB68-4E5F-88D7-01D8521970FC" name="GUID-C736617D-BB68-4E5F-88D7-01D8521970FC"></a><h4 id="RDFRM-GUID-C736617D-BB68-4E5F-88D7-01D8521970FC" class="sect4"><span class="enumeration_section">6.18.2</span> Test6.java：加载OWL本体并执行OWLPrime推理</h4>
                  <div>
                     <p><a href="rdf-suipport-for-apache-jena.html#GUID-C736617D-BB68-4E5F-88D7-01D8521970FC__CBBGDAED">例6-18</a>加载OWL本体并执行OWLPrime推理。请注意，OWL本体是RDF / XML格式，在加载到Oracle后，它将以N-TRIPLE格式序列化。该示例还查询断言和推断的三元组的数量。
                     </p>
                     <p>可以从<a href="http://swat.cse.lehigh.edu/onto/univ-bench.owl" target="_blank"><code class="codeph">http://swat.cse.lehigh.edu/onto/univ-bench.owl</code></a>检索此示例中的本体，它描述了大学环境中的角色，资源和关系。
                     </p>
                     <div class="example" id="GUID-C736617D-BB68-4E5F-88D7-01D8521970FC__CBBGDAED">
                        <p class="titleinexample">示例6-18加载OWL本体并执行OWLPrime推理</p><pre class="oac_no_warn" dir="ltr">import java.io.*; import com.hp.hpl.jena.query。*; import com.hp.hpl.jena.rdf.model。模型; import com.hp.hpl.jena.util。文件管理器; import oracle.spatial.rdf.client.jena。*; public class Test6 {public static void main（String [] args）throws Exception {String szJdbcURL = args [0]; String szUser = args [1]; String szPasswd = args [2]; String szModelName = args [3]; Oracle oracle = new Oracle（szJdbcURL，szUser，szPasswd）; Model model = ModelOracleSem.createOracleSemModel（oracle，szModelName）; //加载UNIV本体InputStream in = FileManager.get（）。open（“./ univ-bench.owl”）; model.read（in，null）; OutputStream os = new FileOutputStream（“./ univ-bench.nt”）; model.write（os，“N-TRIPLE”）; os.close（）; String queryString =“SELECT？学科 ？道具？对象WHERE {？学科 ？道具？对象}“;查询查询= QueryFactory.create（queryString）; QueryExecution qexec = QueryExecutionFactory.create（query，model）; try {int iTriplesCount = 0; ResultSet results = qexec.execSelect（）; for（; results.hasNext（） ;）{QuerySolution soln = results.nextSolution（）; iTriplesCount ++;} System.out.println（“Asserted triples count：”+ iTriplesCount）;} finally {qexec.close（）;} Attachment attachment = Attachment.createInstance（new String [] {}，“OWLPRIME”，InferenceMaintenanceMode。NO_UPDATE，QueryOptions。默认）; GraphOracleSem graph = new GraphOracleSem（oracle，szModelName，attachment）; graph.analyze（）; graph.performInference（）; query = QueryFactory.create（queryString）; qexec = QueryExecutionFactory.create（query，new ModelOracleSem（graph））; try {int iTriplesCount = 0; ResultSet results = qexec.execSelect（）; for（; results.hasNext（）;）{QuerySolution soln = results.nextSolution（）; iTriplesCount ++; System.out.println（“Asserted + Infered triples count：”+ iTriplesCount）; } finally {qexec.close（）; } model.close（）; OracleUtils.dropSemanticModel（oracle，szModelName）; oracle.dispose（）; }}</pre><p>以下是编译和运行<a href="rdf-suipport-for-apache-jena.html#GUID-C736617D-BB68-4E5F-88D7-01D8521970FC__CBBGDAED">例6-18</a>的命令，以及<code class="codeph">java</code>命令的预期输出。
                        </p><pre class="oac_no_warn" dir="ltr">javac -classpath ../jar/'*'Test6.java java -classpath。/:../jar/'*'test6 jdbc：oracle：thin：@localhost：1521：orcl scott <span class="italic">&lt;password-for-scott&gt;</span> M1断言三元组数：293断言+推理三元组数：340</pre><p>请注意，此输出反映了旧版本的LUBM本体。该本体的最新版本有更多三元组。</p>
                     </div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-9F748C0E-437D-4EBD-80CF-BFA91F3CFE3A" title="本节包括使用Apache Jena支持的示例查询。每个示例都是自包含的：它通常创建模型，创建三元组，执行可能涉及推理的查询，显示结果并删除模型。">使用Apache Jena的RDF语义图支持的示例查询</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="RDFRM278"></a><a id="RDFRM277"></a><div class="props_rev_3"><a id="GUID-94180C4E-ED1F-4C18-86C7-54F9655975F5" name="GUID-94180C4E-ED1F-4C18-86C7-54F9655975F5"></a><h4 id="RDFRM-GUID-94180C4E-ED1F-4C18-86C7-54F9655975F5" class="sect4"><span class="enumeration_section">6.18.3</span> Test7.java：批量加载OWL本体并执行OWLPrime推理</h4>
                  <div>
                     <p><a href="rdf-suipport-for-apache-jena.html#GUID-94180C4E-ED1F-4C18-86C7-54F9655975F5__CBBFBCDB">示例6-19</a>加载与<a href="rdf-suipport-for-apache-jena.html#GUID-C736617D-BB68-4E5F-88D7-01D8521970FC">Test6.java中</a>相同的OWL本体<a href="rdf-suipport-for-apache-jena.html#GUID-C736617D-BB68-4E5F-88D7-01D8521970FC">：加载OWL本体并执行OWLPrime推理</a> ，但使用批量加载器存储在本地文件中。也可以使用增量和批量加载器加载本体;这两个方法也在完整性示例中列出。
                     </p>
                     <div class="example" id="GUID-94180C4E-ED1F-4C18-86C7-54F9655975F5__CBBFBCDB">
                        <p class="titleinexample">示例6-19批量加载OWL本体并执行OWLPrime推理</p><pre class="oac_no_warn" dir="ltr">import java.io.*; import com.hp.hpl.jena.query。*; import com.hp.hpl.jena.graph。*; import com.hp.hpl.jena.rdf.model。*; import com.hp.hpl.jena.util。*; import oracle.spatial.rdf.client.jena。*; public class Test7 {public static void main（String [] args）throws Exception {String szJdbcURL = args [0]; String szUser = args [1]; String szPasswd = args [2]; String szModelName = args [3]; //在内存中Jena Model Model model = ModelFactory.createDefaultModel（）; InputStream = FileManager.get（）。open（“./ univ-bench.owl”）; model.read（是，“”，“RDF / XML”）; is.close（）; Oracle oracle = new Oracle（szJdbcURL，szUser，szPasswd）; ModelOracleSem modelDest = ModelOracleSem.createOracleSemModel（oracle，szModelName）; GraphOracleSem g = modelDest.getGraph（）; g.dropApplicationTableIndex（）; int方法= 2; //尝试批量加载器String tbs =“SYSAUX”; //可以自定义if（method == 0）{System.out.println（“start incremental”）; modelDest.add（模型）; System.out.println（“end size”+ modelDest.size（））; } else if（method == 1）{System.out.println（“start batch load”）; g.getBulkUpdateHandler（）。addInBatch（GraphUtil.findAll（model.getGraph（）），tbs）; System.out.println（“end size”+ modelDest.size（））; } else {System.out.println（“start bulk load”）; g.getBulkUpdateHandler（）。addInBulk（GraphUtil.findAll（model.getGraph（）），tbs）; System.out.println（“end size”+ modelDest.size（））; } g.rebuildApplicationTableIndex（）; long lCount = g.getCount（三倍。任何）; System.out.println（“断言三元组计数：”+ lCount）; model.close（）; OracleUtils.dropSemanticModel（oracle，szModelName）; oracle.dispose（）; }}</pre><p>以下是编译和运行<a href="rdf-suipport-for-apache-jena.html#GUID-94180C4E-ED1F-4C18-86C7-54F9655975F5__CBBFBCDB">示例6-19</a>的命令，以及<code class="codeph">java</code>命令的预期输出。
                        </p><pre class="oac_no_warn" dir="ltr">javac -classpath ../jar/'*'Test7.java java -classpath。/:../jar/'*'test7 jdbc：oracle：thin：@localhost：1521：orcl scott <span class="italic">&lt;password-for-scott&gt;</span> M1开始批量加载结束大小293断言三元组数：293</pre><p>请注意，此输出反映了旧版本的LUBM本体。该本体的最新版本有更多三元组。</p>
                     </div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-9F748C0E-437D-4EBD-80CF-BFA91F3CFE3A" title="本节包括使用Apache Jena支持的示例查询。每个示例都是自包含的：它通常创建模型，创建三元组，执行可能涉及推理的查询，显示结果并删除模型。">使用Apache Jena的RDF语义图支持的示例查询</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="RDFRM280"></a><a id="RDFRM279"></a><div class="props_rev_3"><a id="GUID-74FAF9E7-2A45-4C07-A9C1-C4E074C9207A" name="GUID-74FAF9E7-2A45-4C07-A9C1-C4E074C9207A"></a><h4 id="RDFRM-GUID-74FAF9E7-2A45-4C07-A9C1-C4E074C9207A" class="sect4"><span class="enumeration_section">6.18.4</span> Test8.java：SPARQL可选查询</h4>
                  <div>
                     <p><a href="rdf-suipport-for-apache-jena.html#GUID-74FAF9E7-2A45-4C07-A9C1-C4E074C9207A__CBBDCIJJ">例6-20</a>显示了SPARQL OPTIONAL查询。它插入三元组，假设如下：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>约翰是玛丽的父母。</p>
                        </li>
                        <li>
                           <p>约翰是杰克的父母。</p>
                        </li>
                        <li>
                           <p>玛丽是吉尔的父母。</p>
                        </li>
                     </ul>
                     <p>然后它找到父子关系，可选地包括任何孙子（gkid）关系。</p>
                     <div class="example" id="GUID-74FAF9E7-2A45-4C07-A9C1-C4E074C9207A__CBBDCIJJ">
                        <p class="titleinexample">示例6-20 SPARQL可选查询</p><pre class="oac_no_warn" dir="ltr">import java.io.*; import com.hp.hpl.jena.query。*; import com.hp.hpl.jena.rdf.model。模型; import com.hp.hpl.jena.util。文件管理器; import oracle.spatial.rdf.client.jena。*; import com.hp.hpl.jena.graph。*; public class Test8 {public static void main（String [] args）throws Exception {String szJdbcURL = args [0]; String szUser = args [1]; String szPasswd = args [2]; String szModelName = args [3]; Oracle oracle = new Oracle（szJdbcURL，szUser，szPasswd）; ModelOracleSem model = ModelOracleSem.createOracleSemModel（oracle，szModelName）; GraphOracleSem g = model.getGraph（）; g.add（Triple.create（Node.createURI（“u：John”），Node.createURI（“u：parentOf”），Node.createURI（“u：Mary”）））; g.add（Triple.create（Node.createURI（“u：John”），Node.createURI（“u：parentOf”），Node.createURI（“u：Jack”）））; g.add（Triple.create（Node.createURI（“u：Mary”），Node.createURI（“u：parentOf”），Node.createURI（“u：Jill”）））; String queryString =“SELECT？s？o？gkid“+”WHERE {？s &lt;u：parentOf&gt;？o。<span class="bold">可选</span> {？o &lt;u：parentOf&gt;？gkid}}“;查询查询= QueryFactory.create（queryString）; QueryExecution qexec = QueryExecutionFactory.create（query，model）; try {int iMatchCount = 0; ResultSet results = qexec.execSelect（）; ResultSetFormatter.out（System.out ，结果，查询）;} finally {qexec.close（）;} model.close（）; OracleUtils.dropSemanticModel（oracle，szModelName）; oracle.dispose（）;}}</pre><p>以下是编译和运行<a href="rdf-suipport-for-apache-jena.html#GUID-74FAF9E7-2A45-4C07-A9C1-C4E074C9207A__CBBDCIJJ">示例6-20</a>的命令，以及<code class="codeph">java</code>命令的预期输出。
                        </p><pre class="oac_no_warn" dir="ltr">javac -classpath ../jar/'*'Test8.java java -classpath。/:../jar/'*'test8 jdbc：oracle：thin：@localhost：1521：orcl scott <span class="italic">&lt;password-for-scott&gt;</span> M1 ------------------ ---------------- | s | o | gkid | ================================== | &lt;u：John&gt; | &lt;u：玛丽&gt; | &lt;u：吉尔&gt; | | &lt;u：玛丽&gt; | &lt;u：吉尔&gt; | | | &lt;u：John&gt; | &lt;u：杰克&gt; | | ----------------------------------</pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-9F748C0E-437D-4EBD-80CF-BFA91F3CFE3A" title="本节包括使用Apache Jena支持的示例查询。每个示例都是自包含的：它通常创建模型，创建三元组，执行可能涉及推理的查询，显示结果并删除模型。">使用Apache Jena的RDF语义图支持的示例查询</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="RDFRM282"></a><a id="RDFRM281"></a><div class="props_rev_3"><a id="GUID-BA93593D-EA10-4688-820B-B726B80FA665" name="GUID-BA93593D-EA10-4688-820B-B726B80FA665"></a><h4 id="RDFRM-GUID-BA93593D-EA10-4688-820B-B726B80FA665" class="sect4"><span class="enumeration_section">6.18.5</span> Test9.java：带LIMIT和OFFSET的SPARQL查询</h4>
                  <div>
                     <p><a href="rdf-suipport-for-apache-jena.html#GUID-BA93593D-EA10-4688-820B-B726B80FA665__CBBJFJFB">例6-21</a>显示了使用LIMIT和OFFSET的SPARQL查询。它插入三元组，假设如下：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>约翰是玛丽的父母。</p>
                        </li>
                        <li>
                           <p>约翰是杰克的父母。</p>
                        </li>
                        <li>
                           <p>玛丽是吉尔的父母。</p>
                        </li>
                     </ul>
                     <p>然后它找到一个父子关系（LIMIT 1），跳过遇到的前两个父子关系（OFFSET 2），并且可选地包括找到的一个孙子（gkid）关系。</p>
                     <div class="example" id="GUID-BA93593D-EA10-4688-820B-B726B80FA665__CBBJFJFB">
                        <p class="titleinexample">示例6-21使用LIMIT和OFFSET的SPARQL查询</p><pre class="oac_no_warn" dir="ltr">import java.io.*; import com.hp.hpl.jena.query。*; import com.hp.hpl.jena.rdf.model。模型; import com.hp.hpl.jena.util。文件管理器; import oracle.spatial.rdf.client.jena。*; import com.hp.hpl.jena.graph。*; public class Test9 {public static void main（String [] args）throws Exception {String szJdbcURL = args [0]; String szUser = args [1]; String szPasswd = args [2]; String szModelName = args [3]; Oracle oracle = new Oracle（szJdbcURL，szUser，szPasswd）; ModelOracleSem model = ModelOracleSem.createOracleSemModel（oracle，szModelName）; GraphOracleSem g = model.getGraph（）; g.add（Triple.create（Node.createURI（“u：John”），Node.createURI（“u：parentOf”），Node.createURI（“u：Mary”）））; g.add（Triple.create（Node.createURI（“u：John”），Node.createURI（“u：parentOf”），Node.createURI（“u：Jack”）））; g.add（Triple.create（Node.createURI（“u：Mary”），Node.createURI（“u：parentOf”），Node.createURI（“u：Jill”）））; String queryString =“SELECT？s？o？gkid“+”WHERE {？s &lt;u：parentOf&gt;？o。<span class="bold">可选</span> {？o &lt;u：parentOf&gt;？gkid}}“+” <span class="bold">LIMIT 1 OFFSET 2</span> “;查询查询= QueryFactory.create（queryString）; QueryExecution qexec = QueryExecutionFactory.create（query，model）; int iMatchCount = 0; ResultSet results = qexec.execSelect（）; ResultSetFormatter。 out（System.out，results，query）; qexec.close（）; model.close（）; OracleUtils.dropSemanticModel（oracle，szModelName）; oracle.dispose（）;}}</pre><p>以下是编译和运行<a href="rdf-suipport-for-apache-jena.html#GUID-BA93593D-EA10-4688-820B-B726B80FA665__CBBJFJFB">示例6-21</a>的命令，以及<code class="codeph">java</code>命令的预期输出。
                        </p><pre class="oac_no_warn" dir="ltr">javac -classpath ../jar/'*'Test9.java java -classpath。/:../jar/'*'Test9 jdbc：oracle：thin：@localhost：1521：orcl scott <span class="italic">&lt;password-for-scott&gt;</span> M1 ------------------ ------------ | s | o | gkid | ============================== | &lt;u：John&gt; | &lt;u：杰克&gt; | | ------------------------------</pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-9F748C0E-437D-4EBD-80CF-BFA91F3CFE3A" title="本节包括使用Apache Jena支持的示例查询。每个示例都是自包含的：它通常创建模型，创建三元组，执行可能涉及推理的查询，显示结果并删除模型。">使用Apache Jena的RDF语义图支持的示例查询</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="RDFRM284"></a><a id="RDFRM283"></a><div class="props_rev_3"><a id="GUID-FA8847E4-18A3-40D3-B62C-A5E3C10E3ECF" name="GUID-FA8847E4-18A3-40D3-B62C-A5E3C10E3ECF"></a><h4 id="RDFRM-GUID-FA8847E4-18A3-40D3-B62C-A5E3C10E3ECF" class="sect4"><span class="enumeration_section">6.18.6</span> Test10.java：使用TIMEOUT和DOP的SPARQL查询</h4>
                  <div>
                     <p><a href="rdf-suipport-for-apache-jena.html#GUID-FA8847E4-18A3-40D3-B62C-A5E3C10E3ECF__CBBECFAE">例6-22</a>显示了来自<a href="rdf-suipport-for-apache-jena.html#GUID-BA93593D-EA10-4688-820B-B726B80FA665">Test9.java的SPARQL查询：带有LIMIT和OFFSET的SPARQL查询以及</a>其他功能，包括超时设置（TIMEOUT = 1，以秒为单位）和并行执行设置（DOP = 4）。
                     </p>
                     <div class="example" id="GUID-FA8847E4-18A3-40D3-B62C-A5E3C10E3ECF__CBBECFAE">
                        <p class="titleinexample">示例6-22使用TIMEOUT和DOP的SPARQL查询</p><pre class="oac_no_warn" dir="ltr">import java.io.*; import com.hp.hpl.jena.query。*; import com.hp.hpl.jena.rdf.model。模型; import com.hp.hpl.jena.util。文件管理器; import oracle.spatial.rdf.client.jena。*; import com.hp.hpl.jena.graph。*; public class Test10 {public static void main（String [] args）throws Exception {String szJdbcURL = args [0]; String szUser = args [1]; String szPasswd = args [2]; String szModelName = args [3]; Oracle oracle = new Oracle（szJdbcURL，szUser，szPasswd）; ModelOracleSem model = ModelOracleSem.createOracleSemModel（oracle，szModelName）; GraphOracleSem g = model.getGraph（）; g.add（Triple.create（Node.createURI（“u：John”），Node.createURI（“u：parentOf”），Node.createURI（“u：Mary”）））; g.add（Triple.create（Node.createURI（“u：John”），Node.createURI（“u：parentOf”），Node.createURI（“u：Jack”）））; g.add（Triple.create（Node.createURI（“u：Mary”），Node.createURI（“u：parentOf”），Node.createURI（“u：Jill”）））; String queryString =“PREFIX ORACLE_SEM_FS_NS：&lt;http://oracle.com/semtech# <span class="bold">dop = 4，timeout = 1</span> &gt;”+“SELECT？s？o？gkid WHERE {？s &lt;u：parentOf&gt;？o。 “+”可选{？o &lt;u：parentOf&gt;？gkid}}“+”LIMIT 1 OFFSET 2“;查询查询= QueryFactory.create（queryString）; QueryExecution qexec = QueryExecutionFactory.create（query，model）; int iMatchCount = 0; ResultSet results = qexec.execSelect（）; ResultSetFormatter。 out（System.out，results，query）; qexec.close（）; model.close（）; OracleUtils.dropSemanticModel（oracle，szModelName）; oracle.dispose（）;}}</pre><p>以下是编译和运行<a href="rdf-suipport-for-apache-jena.html#GUID-FA8847E4-18A3-40D3-B62C-A5E3C10E3ECF__CBBECFAE">例6-22</a>的命令，以及<code class="codeph">java</code>命令的预期输出。
                        </p><pre class="oac_no_warn" dir="ltr">javac -classpath ../jar/'*'Test10.java java -classpath。/:../jar/'*'Test10 jdbc：oracle：thin：@localhost：1521：orcl scott <span class="italic">&lt;password-for-scott&gt;</span> M1 ------------------ ------------ | s | o | gkid | ============================== | &lt;u：John&gt; | &lt;u：杰克&gt; | | ------------------------------</pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-9F748C0E-437D-4EBD-80CF-BFA91F3CFE3A" title="本节包括使用Apache Jena支持的示例查询。每个示例都是自包含的：它通常创建模型，创建三元组，执行可能涉及推理的查询，显示结果并删除模型。">使用Apache Jena的RDF语义图支持的示例查询</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="RDFRM286"></a><a id="RDFRM285"></a><div class="props_rev_3"><a id="GUID-175B2596-AEC0-4E7D-A2E0-1F642062625C" name="GUID-175B2596-AEC0-4E7D-A2E0-1F642062625C"></a><h4 id="RDFRM-GUID-175B2596-AEC0-4E7D-A2E0-1F642062625C" class="sect4"><span class="enumeration_section">6.18.7</span> Test11.java：包含命名图的查询</h4>
                  <div>
                     <p><a href="rdf-suipport-for-apache-jena.html#GUID-175B2596-AEC0-4E7D-A2E0-1F642062625C__CBBDDEJG">例6-23</a>显示了涉及命名图的查询。它涉及一个默认图表，其中包含有关命名图形URI及其发布者的信息。查询查找图名称及其发布者，并在每个命名图中使用<code class="codeph">foaf:mbox</code>谓词查找邮箱值。
                     </p>
                     <div class="example" id="GUID-175B2596-AEC0-4E7D-A2E0-1F642062625C__CBBDDEJG">
                        <p class="titleinexample">示例6-23基于命名图的查询</p><pre class="oac_no_warn" dir="ltr">import java.io.*; import com.hp.hpl.jena.graph。*; import com.hp.hpl.jena.sparql.core。*; import com.hp.hpl.jena.query。*; import oracle.spatial.rdf.client.jena。*; public class Test11 {public static void main（String [] args）throws Exception {String szJdbcURL = args [0]; String szUser = args [1]; String szPasswd = args [2]; String szModelName = args [3]; Oracle oracle = new Oracle（szJdbcURL，szUser，szPasswd）; GraphOracleSem graph = new GraphOracleSem（oracle，szModelName）; DatasetGraphOracleSem dataset = DatasetGraphOracleSem.createFrom（graph）; //不再需要GraphOracleSem，释放资源graph.close（）; //将数据添加到默认图表dataset.add（新Quad（Quad.defaultGraphIRI，//指定默认图Node.createURI（“http://example.org/bob”），Node.createURI（“http：// purl.org/dc/elements/1.1/publisher“），Node.createLiteral（”Bob Hacker“）））; dataset.add（new Quad（Quad.defaultGraphIRI，//指定默认图Node.createURI（“http://example.org/alice”），Node.createURI（“http://purl.org/dc/elements/ 1.1 / publisher“），Node.createLiteral（”alice Hacker“）））; //将数据添加到名为graph dataset.add的bob（new Quad（Node.createURI（“http://example.org/bob”），//图名称Node.createURI（“urn：bob”），Node。 createURI（“http://xmlns.com/foaf/0.1/name”），Node.createLiteral（“Bob”）））; dataset.add（new Quad（Node.createURI（“http://example.org/bob”），//图名称Node.createURI（“urn：bob”），Node.createURI（“http：// xmlns。 com / foaf / 0.1 / mbox“），Node.createURI（”mailto：bob @ example“）））; //将数据添加到名为graph dataset.add的alice（new Quad（Node.createURI（“http://example.org/alice”），//图名称Node.createURI（“urn：alice”），Node。 createURI（“http://xmlns.com/foaf/0.1/name”），Node.createLiteral（“Alice”）））; dataset.add（new Quad（Node.createURI（“http://example.org/alice”），//图名称Node.createURI（“urn：alice”），Node.createURI（“http：// xmlns。 com / foaf / 0.1 / mbox“），Node.createURI（”mailto：alice @ example“）））; DataSource ds = DatasetFactory.create（dataset）; String queryString =“PREFIX foaf：&lt;http://xmlns.com/foaf/0.1/&gt;”+“PREFIX dc：&lt;http://purl.org/dc/elements/1.1/&gt;”+“SELECT？谁 ？图？mbox“+”FROM NAMED &lt;http://example.org/alice&gt;“+”FROM NAMED &lt;http://example.org/bob&gt;“+”WHERE“+”{“+”？图dc：发布者？谁 。 “+”GRAPH？图{？x foaf：mbox？mbox}“+”}“;查询查询= QueryFactory.create（queryString）; QueryExecution qexec = QueryExecutionFactory.create（query，ds）; ResultSet results = qexec.execSelect（）; ResultSetFormatter.out（System.out，results，query ）; qexec.close（）; dataset.close（）; oracle.dispose（）;}}</pre><p>以下是编译和运行<a href="rdf-suipport-for-apache-jena.html#GUID-175B2596-AEC0-4E7D-A2E0-1F642062625C__CBBDDEJG">示例6-23</a>的命令，以及<code class="codeph">java</code>命令的预期输出。
                        </p><pre class="oac_no_warn" dir="ltr">javac -classpath。/:./jena-2.6.4.jar:./sdordfclient.jar:./ojdbc6.jar:./slf4j-api-1.5.8.jar:./slf4j-log4j12-1.5.8.jar:./ arq-2.8.8.jar：./ xercesImpl-2.7.1.jar Test11.java java -classpath。/:../jar/'*'test11 jdbc：oracle：thin：@localhost：1521：orcl scott &lt;password-for-scott&gt; M1 ------------------ -------------------------------------------------- ---- |谁|图表| mbox | ================================================== ====================== | “alice Hacker”| &lt;http://example.org/alice&gt; | &lt;mailto：alice @ example&gt; | | “Bob Hacker”| &lt;http://example.org/bob&gt; | &lt;mailto：bob @ example&gt; | -------------------------------------------------- ----------------------</pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-9F748C0E-437D-4EBD-80CF-BFA91F3CFE3A" title="本节包括使用Apache Jena支持的示例查询。每个示例都是自包含的：它通常创建模型，创建三元组，执行可能涉及推理的查询，显示结果并删除模型。">使用Apache Jena的RDF语义图支持的示例查询</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="RDFRM288"></a><a id="RDFRM287"></a><div class="props_rev_3"><a id="GUID-AEAC5A2F-BBEF-4778-8ABF-E951DB4FB8C4" name="GUID-AEAC5A2F-BBEF-4778-8ABF-E951DB4FB8C4"></a><h4 id="RDFRM-GUID-AEAC5A2F-BBEF-4778-8ABF-E951DB4FB8C4" class="sect4"><span class="enumeration_section">6.18.8</span> Test12.java:SPARQL ASK查询</h4>
                  <div>
                     <p><a href="rdf-suipport-for-apache-jena.html#GUID-AEAC5A2F-BBEF-4778-8ABF-E951DB4FB8C4__CBBCFIAJ">例6-24</a>显示了SPARQL ASK查询。它插入一个三元组，假定John是Mary的父母。然后它会发现约翰是否是玛丽的父母。
                     </p>
                     <div class="example" id="GUID-AEAC5A2F-BBEF-4778-8ABF-E951DB4FB8C4__CBBCFIAJ">
                        <p class="titleinexample">示例6-24 SPARQL ASK查询</p><pre class="oac_no_warn" dir="ltr">import java.io.*; import com.hp.hpl.jena.query。*; import com.hp.hpl.jena.rdf.model。模型; import com.hp.hpl.jena.util。文件管理器; import oracle.spatial.rdf.client.jena。*; import com.hp.hpl.jena.graph。*; public class Test12 {public static void main（String [] args）throws Exception {String szJdbcURL = args [0]; String szUser = args [1]; String szPasswd = args [2]; String szModelName = args [3]; Oracle oracle = new Oracle（szJdbcURL，szUser，szPasswd）; ModelOracleSem model = ModelOracleSem.createOracleSemModel（oracle，szModelName）; GraphOracleSem g = model.getGraph（）; g.add（Triple.create（Node.createURI（“u：John”），Node.createURI（“u：parentOf”），Node.createURI（“u：Mary”）））; String queryString =“ <span class="bold">ASK</span> {&lt;u：John&gt; &lt;u：parentOf&gt; &lt;u：Mary&gt;}”;查询查询= QueryFactory.create（queryString）; QueryExecution qexec = QueryExecutionFactory.create（query，model）; boolean b = qexec.execAsk（）; System.out.println（“ask result =”+（（b）？“真假”））; qexec.close（）; model.close（）; OracleUtils.dropSemanticModel（oracle，szModelName）; oracle.dispose（）; }}</pre><p>以下是编译和运行<a href="rdf-suipport-for-apache-jena.html#GUID-AEAC5A2F-BBEF-4778-8ABF-E951DB4FB8C4__CBBCFIAJ">示例6-24</a>的命令，以及<code class="codeph">java</code>命令的预期输出。
                        </p><pre class="oac_no_warn" dir="ltr">javac -classpath ../jar/'*'Test12.java java -classpath。/:../jar/'*'test12 jdbc：oracle：thin：@localhost：1521：orcl scott <span class="italic">&lt;password-for-scott&gt;</span> M1 ask result = TRUE</pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-9F748C0E-437D-4EBD-80CF-BFA91F3CFE3A" title="本节包括使用Apache Jena支持的示例查询。每个示例都是自包含的：它通常创建模型，创建三元组，执行可能涉及推理的查询，显示结果并删除模型。">使用Apache Jena的RDF语义图支持的示例查询</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="RDFRM290"></a><a id="RDFRM289"></a><div class="props_rev_3"><a id="GUID-AF589F89-86C1-4286-9364-EDD05217C9D9" name="GUID-AF589F89-86C1-4286-9364-EDD05217C9D9"></a><h4 id="RDFRM-GUID-AF589F89-86C1-4286-9364-EDD05217C9D9" class="sect4"><span class="enumeration_section">6.18.9</span> Test13.java:SPARQL DESCRIBE查询</h4>
                  <div>
                     <p><a href="rdf-suipport-for-apache-jena.html#GUID-AF589F89-86C1-4286-9364-EDD05217C9D9__CBBCDBJH">例6-25</a>显示了SPARQL DESCRIBE查询。它插入三元组，假设如下：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>约翰是玛丽的父母。</p>
                        </li>
                        <li>
                           <p>约翰是杰克的父母。</p>
                        </li>
                        <li>
                           <p>艾米是杰克的父母。</p>
                        </li>
                     </ul>
                     <p>然后它找到涉及杰克父母的所有关系。</p>
                     <div class="example" id="GUID-AF589F89-86C1-4286-9364-EDD05217C9D9__CBBCDBJH">
                        <p class="titleinexample">示例6-25 SPARQL DESCRIBE查询</p><pre class="oac_no_warn" dir="ltr">import java.io.*; import com.hp.hpl.jena.query。*; import com.hp.hpl.jena.rdf.model。模型; import com.hp.hpl.jena.util。文件管理器; import oracle.spatial.rdf.client.jena。*; import com.hp.hpl.jena.graph。*; public class Test13 {public static void main（String [] args）throws Exception {String szJdbcURL = args [0]; String szUser = args [1]; String szPasswd = args [2]; String szModelName = args [3]; Oracle oracle = new Oracle（szJdbcURL，szUser，szPasswd）; ModelOracleSem model = ModelOracleSem.createOracleSemModel（oracle，szModelName）; GraphOracleSem g = model.getGraph（）; g.add（Triple.create（Node.createURI（“u：John”），Node.createURI（“u：parentOf”），Node.createURI（“u：Mary”）））; g.add（Triple.create（Node.createURI（“u：John”），Node.createURI（“u：parentOf”），Node.createURI（“u：Jack”）））; g.add（Triple.create（Node.createURI（“u：Amy”），Node.createURI（“u：parentOf”），Node.createURI（“u：Jack”）））; String queryString =“ <span class="bold">DESCRIBE</span> ？x WHERE {？x &lt;u：parentOf&gt; &lt;u：Jack&gt;}“;查询查询= QueryFactory.create（queryString）; QueryExecution qexec = QueryExecutionFactory.create（query，model）; Model m = qexec.execDescribe（）; System.out.println （“describe result =”+ m.toString（））; qexec.close（）; model.close（）; OracleUtils.dropSemanticModel（oracle，szModelName）; oracle.dispose（）;}}</pre><p>以下是编译和运行<a href="rdf-suipport-for-apache-jena.html#GUID-AF589F89-86C1-4286-9364-EDD05217C9D9__CBBCDBJH">示例6-25</a>的命令，以及<code class="codeph">java</code>命令的预期输出。
                        </p><pre class="oac_no_warn" dir="ltr">javac -classpath ../jar/'*'test13.java java -classpath。/:../jar/'*'test13 jdbc：oracle：thin：@localhost：1521：orcl scott <span class="italic">&lt;password-for-scott&gt;</span> M1描述结果= &lt;ModelCom {u：Amy @u：parentOf u：Jack;你：John @u：parentOf u：Jack;你：John @u：parentOf u：Mary} | [你们：艾米，你们：父母，你们：杰克] [你们：约翰，你们：父母，你们：杰克] [你们：约翰，你们：父母，你们：玛丽]&gt;</pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-9F748C0E-437D-4EBD-80CF-BFA91F3CFE3A" title="本节包括使用Apache Jena支持的示例查询。每个示例都是自包含的：它通常创建模型，创建三元组，执行可能涉及推理的查询，显示结果并删除模型。">使用Apache Jena的RDF语义图支持的示例查询</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="RDFRM292"></a><a id="RDFRM291"></a><div class="props_rev_3"><a id="GUID-55F97EB6-141A-46DC-AF20-4DB69AA83B49" name="GUID-55F97EB6-141A-46DC-AF20-4DB69AA83B49"></a><h4 id="RDFRM-GUID-55F97EB6-141A-46DC-AF20-4DB69AA83B49" class="sect4"><span class="enumeration_section">6.18.10</span> Test14.java:SPARQL CONSTRUCT查询</h4>
                  <div>
                     <p><a href="rdf-suipport-for-apache-jena.html#GUID-55F97EB6-141A-46DC-AF20-4DB69AA83B49__CBBEAHCH">例6-26</a>显示了SPARQL CONSTRUCT查询。它插入三元组，假设如下：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>约翰是玛丽的父母。</p>
                        </li>
                        <li>
                           <p>约翰是杰克的父母。</p>
                        </li>
                        <li>
                           <p>艾米是杰克的父母。</p>
                        </li>
                        <li>
                           <p>每个父母都爱他们所有的孩子。</p>
                        </li>
                     </ul>
                     <p>然后，它构建一个RDF图，其中包含有关谁爱谁的信息。</p>
                     <div class="example" id="GUID-55F97EB6-141A-46DC-AF20-4DB69AA83B49__CBBEAHCH">
                        <p class="titleinexample">示例6-26 SPARQL CONSTRUCT查询</p><pre class="oac_no_warn" dir="ltr">import java.io.*; import com.hp.hpl.jena.query。*; import com.hp.hpl.jena.rdf.model。模型; import com.hp.hpl.jena.util。文件管理器; import oracle.spatial.rdf.client.jena。*; import com.hp.hpl.jena.graph。*; public class Test14 {public static void main（String [] args）throws Exception {String szJdbcURL = args [0]; String szUser = args [1]; String szPasswd = args [2]; String szModelName = args [3]; Oracle oracle = new Oracle（szJdbcURL，szUser，szPasswd）; ModelOracleSem model = ModelOracleSem.createOracleSemModel（oracle，szModelName）; GraphOracleSem g = model.getGraph（）; g.add（Triple.create（Node.createURI（“u：John”），Node.createURI（“u：parentOf”），Node.createURI（“u：Mary”）））; g.add（Triple.create（Node.createURI（“u：John”），Node.createURI（“u：parentOf”），Node.createURI（“u：Jack”）））; g.add（Triple.create（Node.createURI（“u：Amy”），Node.createURI（“u：parentOf”），Node.createURI（“u：Jack”）））; String queryString =“ <span class="bold">CONSTRUCT</span> {？s &lt;u：loves&gt;？o}哪里{？s &lt;u：parentOf&gt;？o}“;查询查询= QueryFactory.create（queryString）; QueryExecution qexec = QueryExecutionFactory.create（query，model）; Model m = qexec.execConstruct（）; System.out.println（”Construct result =“+ m.toString （））; qexec.close（）; model.close（）; OracleUtils.dropSemanticModel（oracle，szModelName）; oracle.dispose（）;}}</pre><p>以下是编译和运行<a href="rdf-suipport-for-apache-jena.html#GUID-55F97EB6-141A-46DC-AF20-4DB69AA83B49__CBBEAHCH">示例6-26</a>的命令，以及<code class="codeph">java</code>命令的预期输出。
                        </p><pre class="oac_no_warn" dir="ltr">javac -classpath ../jar/'*'test14.java java -classpath。/:../jar/'*'test14 jdbc：oracle：thin：@localhost：1521：orcl scott <span class="italic">&lt;password-for-scott&gt;</span> M1 Construct result = &lt;ModelCom {u：Amy @u：loves u：Jack;你：John @u：爱你：杰克;你：约翰@u：爱你：玛丽} | [你：艾米，你：爱，你：杰克] [你：约翰，你：爱，你：杰克] [你：约翰，你：爱，你：玛丽]&gt;</pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-9F748C0E-437D-4EBD-80CF-BFA91F3CFE3A" title="本节包括使用Apache Jena支持的示例查询。每个示例都是自包含的：它通常创建模型，创建三元组，执行可能涉及推理的查询，显示结果并删除模型。">使用Apache Jena的RDF语义图支持的示例查询</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="RDFRM294"></a><a id="RDFRM293"></a><div class="props_rev_3"><a id="GUID-7B164F3A-550F-4363-B3F4-27EE2A43D6B6" name="GUID-7B164F3A-550F-4363-B3F4-27EE2A43D6B6"></a><h4 id="RDFRM-GUID-7B164F3A-550F-4363-B3F4-27EE2A43D6B6" class="sect4"><span class="enumeration_section">6.18.11</span> Test15.java：查询多个模型并指定“允许重复”</h4>
                  <div>
                     <p><a href="rdf-suipport-for-apache-jena.html#GUID-7B164F3A-550F-4363-B3F4-27EE2A43D6B6__CBBDECHB">例6-27</a>查询多个模型并使用“allow duplicates”选项。它插入三元组，假设如下：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>约翰是杰克的父母（模特1）。</p>
                        </li>
                        <li>
                           <p>玛丽是杰克的父母（模特2）。</p>
                        </li>
                        <li>
                           <p>每个父母都爱他们所有的孩子。</p>
                        </li>
                     </ul>
                     <p>然后它找出谁爱谁。它搜索两个模型并允许模型中出现重复三元组的可能性（尽管在这个例子中没有重复）。</p>
                     <div class="example" id="GUID-7B164F3A-550F-4363-B3F4-27EE2A43D6B6__CBBDECHB">
                        <p class="titleinexample">示例6-27查询多个模型并指定“允许重复”</p><pre class="oac_no_warn" dir="ltr">import java.io.*; import com.hp.hpl.jena.query。*; import com.hp.hpl.jena.rdf.model。模型; import com.hp.hpl.jena.util。文件管理器; import oracle.spatial.rdf.client.jena。*; import com.hp.hpl.jena.graph。*; public class Test15 {public static void main（String [] args）throws Exception {String szJdbcURL = args [0]; String szUser = args [1]; String szPasswd = args [2]; String szModelName1 = args [3]; String szModelName2 = args [4]; Oracle oracle = new Oracle（szJdbcURL，szUser，szPasswd）; ModelOracleSem model1 = ModelOracleSem.createOracleSemModel（oracle，szModelName1）; model1.getGraph（）。add（Triple.create（Node.createURI（“u：John”），Node.createURI（“u：parentOf”），Node.createURI（“u：Jack”）））; model1.close（）; ModelOracleSem model2 = ModelOracleSem.createOracleSemModel（oracle，szModelName2）; model2.getGraph（）。add（Triple.create（Node.createURI（“u：Mary”），Node.createURI（“u：parentOf”），Node.createURI（“u：Jack”）））; model2.close（）; String [] modelNamesList = {szModelName2}; String [] rulebasesList = {};附件附件= Attachment.createInstance（modelNamesList，rulebasesList，InferenceMaintenanceMode。NO_UPDATE， <span class="bold">QueryOptions。ALLOW_QUERY_VALID_AND_DUP</span> ）; GraphOracleSem graph = new GraphOracleSem（oracle，szModelName1，attachment）; ModelOracleSem model = new ModelOracleSem（graph）; String queryString =“CONSTRUCT {？s &lt;u：loves&gt;？o}哪里{？s &lt;u：parentOf&gt;？o}“;查询查询= QueryFactory.create（queryString）; QueryExecution qexec = QueryExecutionFactory.create（query，model）; Model m = qexec.execConstruct（）; System.out.println（”Construct result =“+ m.toString （））; qexec.close（）; model.close（）; OracleUtils.dropSemanticModel（oracle，szModelName1）; OracleUtils.dropSemanticModel（oracle，szModelName2）; oracle.dispose（）;}}</pre><p>以下是编译和运行<a href="rdf-suipport-for-apache-jena.html#GUID-7B164F3A-550F-4363-B3F4-27EE2A43D6B6__CBBDECHB">Example 6-27</a>的命令，以及<code class="codeph">java</code>命令的预期输出。
                        </p><pre class="oac_no_warn" dir="ltr">javac -classpath ../jar/'*'test15.java java -classpath。/:../jar/'*'test15 jdbc：oracle：thin：@localhost：1521：orcl scott <span class="italic">&lt;password-for-scott&gt;</span> M1 M2 Construct result = &lt;ModelCom {u：Mary @u：loves u：Jack;你：约翰@u：爱你：杰克} | [你：玛丽，你：爱，你：杰克] [你：约翰，你：爱，你：杰克]&gt;</pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-9F748C0E-437D-4EBD-80CF-BFA91F3CFE3A" title="本节包括使用Apache Jena支持的示例查询。每个示例都是自包含的：它通常创建模型，创建三元组，执行可能涉及推理的查询，显示结果并删除模型。">使用Apache Jena的RDF语义图支持的示例查询</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="RDFRM296"></a><a id="RDFRM295"></a><div class="props_rev_3"><a id="GUID-325FB548-0E9A-48A8-8DDA-71B37497938A" name="GUID-325FB548-0E9A-48A8-8DDA-71B37497938A"></a><h4 id="RDFRM-GUID-325FB548-0E9A-48A8-8DDA-71B37497938A" class="sect4"><span class="enumeration_section">6.18.12</span> Test16.java:SPARQL更新</h4>
                  <div>
                     <p><a href="rdf-suipport-for-apache-jena.html#GUID-325FB548-0E9A-48A8-8DDA-71B37497938A__CBBFJAHG">例6-28</a>将两个三元组插入模型中。
                     </p>
                     <div class="example" id="GUID-325FB548-0E9A-48A8-8DDA-71B37497938A__CBBFJAHG">
                        <p class="titleinexample">示例6-28 SPARQL更新</p><pre class="oac_no_warn" dir="ltr">import java.io.*; import com.hp.hpl.jena.query。*; import com.hp.hpl.jena.rdf.model。模型; import com.hp.hpl.jena.util。文件管理器; import com.hp.hpl.jena.util.iterator。*; import oracle.spatial.rdf.client.jena。*; import com.hp.hpl.jena.graph。*; import com.hp.hpl.jena.update。*; public class Test16 {public static void main（String [] args）throws Exception {String szJdbcURL = args [0]; String szUser = args [1]; String szPasswd = args [2]; String szModelName = args [3]; Oracle oracle = new Oracle（szJdbcURL，szUser，szPasswd）; ModelOracleSem model = ModelOracleSem.createOracleSemModel（oracle，szModelName）; GraphOracleSem g = model.getGraph（）; String insertString =“PREFIX dc：&lt;http://purl.org/dc/elements/1.1/&gt;”+“INSERT DATA”+“{{http：// example / book3&gt; dc：title \”一本新书“;”+“dc：creator \”ANOther \“。”+“}”; UpdateAction.parseExecute（insertString，model）; ExtendedIterator ei = GraphUtil.findAll（g）; while（ei.hasNext（））{System.out.println（“Triple”+ ei.next（）。toString（））; } model.close（）; OracleUtils.dropSemanticModel（oracle，szModelName）; oracle.dispose（）; }}</pre><p>以下是编译和运行<a href="rdf-suipport-for-apache-jena.html#GUID-325FB548-0E9A-48A8-8DDA-71B37497938A__CBBFJAHG">示例6-28</a>的命令，以及<code class="codeph">java</code>命令的预期输出。
                        </p><pre class="oac_no_warn" dir="ltr">javac -classpath ../jar/'*'test16.java java -classpath。/:../jar/'*'test16 jdbc：oracle：thin：@localhost：1521：orcl scott <span class="italic">&lt;password-for-scott&gt;</span> M1 Triple http：// example / book3 @dc：title“A new book”Triple http：// example / book3 @dc：creator“ANOther”</pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-9F748C0E-437D-4EBD-80CF-BFA91F3CFE3A" title="本节包括使用Apache Jena支持的示例查询。每个示例都是自包含的：它通常创建模型，创建三元组，执行可能涉及推理的查询，显示结果并删除模型。">使用Apache Jena的RDF语义图支持的示例查询</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="RDFRM298"></a><a id="RDFRM297"></a><div class="props_rev_3"><a id="GUID-13A02D52-426D-436C-90AF-73B1AB44FA0F" name="GUID-13A02D52-426D-436C-90AF-73B1AB44FA0F"></a><h4 id="RDFRM-GUID-13A02D52-426D-436C-90AF-73B1AB44FA0F" class="sect4"><span class="enumeration_section">6.18.13</span> Test17.java：带ARQ内置函数的SPARQL查询</h4>
                  <div>
                     <p><a href="rdf-suipport-for-apache-jena.html#GUID-13A02D52-426D-436C-90AF-73B1AB44FA0F__CBBBFAHI">例6-29</a>插入了有关两本书的数据，它以全部大写字符和每个标题字符串的长度显示书名。
                     </p>
                     <div class="example" id="GUID-13A02D52-426D-436C-90AF-73B1AB44FA0F__CBBBFAHI">
                        <p class="titleinexample">示例6-29使用ARQ内置函数的SPARQL查询</p><pre class="oac_no_warn" dir="ltr">import java.io.*; import com.hp.hpl.jena.query。*; import com.hp.hpl.jena.rdf.model。模型; import com.hp.hpl.jena.util。文件管理器; import com.hp.hpl.jena.util.iterator。*; import oracle.spatial.rdf.client.jena。*; import com.hp.hpl.jena.graph。*; import com.hp.hpl.jena.update。*; public class Test17 {public static void main（String [] args）throws Exception {String szJdbcURL = args [0]; String szUser = args [1]; String szPasswd = args [2]; String szModelName = args [3]; Oracle oracle = new Oracle（szJdbcURL，szUser，szPasswd）; ModelOracleSem model = ModelOracleSem.createOracleSemModel（oracle，szModelName）; GraphOracleSem g = model.getGraph（）; String insertString =“PREFIX dc：&lt;http://purl.org/dc/elements/1.1/&gt;”+“INSERT DATA”+“{{http：// example / book3&gt; dc：title \”一本新书“;”+“dc：creator \”ANOther \“。”+“&lt;http：// example / book4&gt; dc：title \”Semantic Web Rocks \“;”+“dc：creator \”TB \“。” +“}”; UpdateAction.parseExecute（insertString，model）; String queryString =“PREFIX dc：&lt;http://purl.org/dc/elements/1.1/&gt;”+“PREFIX fn：&lt;http://www.w3.org/2005/xpath-functions#&gt;”+“选择 ？主题（ <span class="bold">fn：大写</span> （？对象）为？object1）“+”（ <span class="bold">fn：string-length</span> （？对象）为？strlen）“+”WHERE {？主题DC：标题？对象}“;查询查询= QueryFactory.create（queryString，Syntax.syntaxARQ）; QueryExecution qexec = QueryExecutionFactory.create（query，model）; ResultSet results = qexec.execSelect（）; ResultSetFormatter.out（System.out，results，query ）; model.close（）; OracleUtils.dropSemanticModel（oracle，szModelName）; oracle.dispose（）;}}</pre><p>以下是编译和运行<a href="rdf-suipport-for-apache-jena.html#GUID-13A02D52-426D-436C-90AF-73B1AB44FA0F__CBBBFAHI">示例6-29</a>的命令，以及<code class="codeph">java</code>命令的预期输出。
                        </p><pre class="oac_no_warn" dir="ltr">javac -classpath ../jar/'*'Test17.java java -classpath。/:../jar/'*'test17 jdbc：oracle：thin：@localhost：1521：orcl scott <span class="italic">&lt;password-for-scott&gt;</span> M1 ------------------ ---------------------------------------- |主题| object1 | strlen | ================================================== ======== | &lt;http：// example / book3&gt; | “一本新书”| 10 | | &lt;http：// example / book4&gt; | “SEMANTIC WEB ROCKS”| 18 | -------------------------------------------------- --------</pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-9F748C0E-437D-4EBD-80CF-BFA91F3CFE3A" title="本节包括使用Apache Jena支持的示例查询。每个示例都是自包含的：它通常创建模型，创建三元组，执行可能涉及推理的查询，显示结果并删除模型。">使用Apache Jena的RDF语义图支持的示例查询</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="RDFRM300"></a><a id="RDFRM299"></a><div class="props_rev_3"><a id="GUID-58FFA706-81FB-45E7-B6E1-61D6D43A054C" name="GUID-58FFA706-81FB-45E7-B6E1-61D6D43A054C"></a><h4 id="RDFRM-GUID-58FFA706-81FB-45E7-B6E1-61D6D43A054C" class="sect4"><span class="enumeration_section">6.18.14</span> Test18.java：SELECT Cast Query</h4>
                  <div>
                     <p><a href="rdf-suipport-for-apache-jena.html#GUID-58FFA706-81FB-45E7-B6E1-61D6D43A054C__CBBBBIJG">实施例6-30</a>将两个华氏温度（18.1和32.0）“转化”至摄氏温度。
                     </p>
                     <div class="example" id="GUID-58FFA706-81FB-45E7-B6E1-61D6D43A054C__CBBBBIJG">
                        <p class="titleinexample">示例6-30 SELECT Cast查询</p><pre class="oac_no_warn" dir="ltr">import java.io.*; import com.hp.hpl.jena.query。*; import com.hp.hpl.jena.rdf.model。模型; import com.hp.hpl.jena.util。文件管理器; import com.hp.hpl.jena.util.iterator。*; import oracle.spatial.rdf.client.jena。*; import com.hp.hpl.jena.graph。*; import com.hp.hpl.jena.update。*; public class Test18 {public static void main（String [] args）throws Exception {String szJdbcURL = args [0]; String szUser = args [1]; String szPasswd = args [2]; String szModelName = args [3]; Oracle oracle = new Oracle（szJdbcURL，szUser，szPasswd）; ModelOracleSem model = ModelOracleSem.createOracleSemModel（oracle，szModelName）; GraphOracleSem g = model.getGraph（）; String insertString =“PREFIX xsd：&lt;http://www.w3.org/2001/XMLSchema#&gt;”+“INSERT DATA”+“{&lt;u：Object1&gt; &lt;u：temp&gt; \”18.1 \“^^ xsd ：float;“+”&lt;u：name&gt; \“Foo ... \”。“+”&lt;u：Object2&gt; &lt;u：temp&gt; \“32.0 \”^^ xsd：float;“+”&lt;u： name&gt; \“Bar ... \”。“+”}“; UpdateAction.parseExecute（insertString，model）; String queryString =“PREFIX fn：&lt;http://www.w3.org/2005/xpath-functions#&gt;”+“SELECT？学科 （（？temp  -  32.0）* 5/9为？celsius_temp）“+”WHERE {？主题&lt;u：temp&gt;？temp}“;查询查询= QueryFactory.create（queryString，Syntax.syntaxARQ）; QueryExecution qexec = QueryExecutionFactory.create（query，model）; ResultSet results = qexec.execSelect（）; ResultSetFormatter.out（System.out，results，query ）; model.close（）; OracleUtils.dropSemanticModel（oracle，szModelName）; oracle.dispose（）;}}</pre><p>以下是编译和运行<a href="rdf-suipport-for-apache-jena.html#GUID-58FFA706-81FB-45E7-B6E1-61D6D43A054C__CBBBBIJG">示例6-30</a>的命令，以及<code class="codeph">java</code>命令的预期输出。
                        </p><pre class="oac_no_warn" dir="ltr">javac -classpath ../jar/'*'Test18.java java -classpath。/:../jar/'*'test18 jdbc：oracle：thin：@localhost：1521：orcl scott <span class="italic">&lt;password-for-scott&gt;</span> M1 ------------------ -------------------------------------------------- ---- |主题| celsius_temp | ================================================== ====================== | &lt;u：Object1&gt; | “-7.7222223”^^ &lt;http://www.w3.org/2001/XMLSchema#float&gt; | | &lt;u：Object2&gt; | “0.0”^^ &lt;http://www.w3.org/2001/XMLSchema#float&gt; | -------------------------------------------------- ----------------------</pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-9F748C0E-437D-4EBD-80CF-BFA91F3CFE3A" title="本节包括使用Apache Jena支持的示例查询。每个示例都是自包含的：它通常创建模型，创建三元组，执行可能涉及推理的查询，显示结果并删除模型。">使用Apache Jena的RDF语义图支持的示例查询</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="RDFRM302"></a><a id="RDFRM301"></a><div class="props_rev_3"><a id="GUID-92E455B0-DC5C-485C-A412-C28D898C8D0D" name="GUID-92E455B0-DC5C-485C-A412-C28D898C8D0D"></a><h4 id="RDFRM-GUID-92E455B0-DC5C-485C-A412-C28D898C8D0D" class="sect4"><span class="enumeration_section">6.18.15</span> Test19.java：使用OracleConnection实例化Oracle数据库</h4>
                  <div>
                     <p><a href="rdf-suipport-for-apache-jena.html#GUID-92E455B0-DC5C-485C-A412-C28D898C8D0D__CBBFBDEJ">示例6-31</a>显示了使用给定<code class="codeph">OracleConnection</code>对象实例化Oracle对象的不同方法。（在J2EE Web应用程序中，用户通常可以从J2EE数据源获取<code class="codeph">OracleConnection</code>对象。）
                     </p>
                     <div class="example" id="GUID-92E455B0-DC5C-485C-A412-C28D898C8D0D__CBBFBDEJ">
                        <p class="titleinexample">示例6-31使用OracleConnection实例化Oracle数据库</p><pre class="oac_no_warn" dir="ltr">import java.io.*; import com.hp.hpl.jena.query。*; import com.hp.hpl.jena.rdf.model。模型; import com.hp.hpl.jena.util。文件管理器; import com.hp.hpl.jena.util.iterator。*; import com.hp.hpl.jena.graph。*; import com.hp.hpl.jena.update。*; import oracle.spatial.rdf.client.jena。*; import oracle.jdbc.pool。*; import oracle.jdbc。*; public class Test19 {public static void main（String [] args）throws Exception {String szJdbcURL = args [0]; String szUser = args [1]; String szPasswd = args [2]; String szModelName = args [3]; OracleDataSource ds = new OracleDataSource（）; ds.setURL（szJdbcURL）; ds.setUser（szUser）; ds.setPassword（szPasswd）; OracleConnection conn =（OracleConnection）ds.getConnection（）; Oracle oracle = new Oracle（conn）; ModelOracleSem model = ModelOracleSem.createOracleSemModel（oracle，szModelName）; GraphOracleSem g = model.getGraph（）; g.add（Triple.create（Node.createURI（“u：John”），Node.createURI（“u：parentOf”），Node.createURI（“u：Mary”）））; g.add（Triple.create（Node.createURI（“u：John”），Node.createURI（“u：parentOf”），Node.createURI（“u：Jack”）））; g.add（Triple.create（Node.createURI（“u：Mary”），Node.createURI（“u：parentOf”），Node.createURI（“u：Jill”）））; String queryString =“SELECT？s？在哪里{？s &lt;u：parentOf&gt;？o。}“;查询查询= QueryFactory.create（queryString）; QueryExecution qexec = QueryExecutionFactory.create（query，model）; ResultSet results = qexec.execSelect（）; ResultSetFormatter.out（System.out，results，query）; qexec .close（）; model.close（）; OracleUtils.dropSemanticModel（oracle，szModelName）; oracle.dispose（）;}}</pre><p>以下是编译和运行<a href="rdf-suipport-for-apache-jena.html#GUID-92E455B0-DC5C-485C-A412-C28D898C8D0D__CBBFBDEJ">示例6-31</a>的命令，以及<code class="codeph">java</code>命令的预期输出。
                        </p><pre class="oac_no_warn" dir="ltr">javac -classpath ../jar/'*'Test19.java java -classpath。/:../jar/'*'test19 jdbc：oracle：thin：@localhost：1521：orcl scott <span class="italic">&lt;password-for-scott&gt;</span> M1 ------------------ ----- | s | o | ======================= | &lt;u：John&gt; | &lt;u：玛丽&gt; | | &lt;u：John&gt; | &lt;u：杰克&gt; | | &lt;u：玛丽&gt; | &lt;u：吉尔&gt; | -----------------------</pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-9F748C0E-437D-4EBD-80CF-BFA91F3CFE3A" title="本节包括使用Apache Jena支持的示例查询。每个示例都是自包含的：它通常创建模型，创建三元组，执行可能涉及推理的查询，显示结果并删除模型。">使用Apache Jena的RDF语义图支持的示例查询</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="RDFRM304"></a><a id="RDFRM303"></a><div class="props_rev_3"><a id="GUID-15F4439C-C1A5-4634-87CB-11F5347F25F9" name="GUID-15F4439C-C1A5-4634-87CB-11F5347F25F9"></a><h4 id="RDFRM-GUID-15F4439C-C1A5-4634-87CB-11F5347F25F9" class="sect4"><span class="enumeration_section">6.18.16</span> Test20.java：Oracle数据库连接池</h4>
                  <div>
                     <p><a href="rdf-suipport-for-apache-jena.html#GUID-15F4439C-C1A5-4634-87CB-11F5347F25F9__CBBGHEEI">示例6-32</a>使用Oracle数据库连接池。
                     </p>
                     <div class="example" id="GUID-15F4439C-C1A5-4634-87CB-11F5347F25F9__CBBGHEEI">
                        <p class="titleinexample">示例6-32 Oracle数据库连接池</p><pre class="oac_no_warn" dir="ltr">import java.io.*; import com.hp.hpl.jena.query。*; import com.hp.hpl.jena.rdf.model。模型; import com.hp.hpl.jena.util。文件管理器; import com.hp.hpl.jena.util.iterator。*; import com.hp.hpl.jena.graph。*; import com.hp.hpl.jena.update。*; import oracle.spatial.rdf.client.jena。*; import oracle.jdbc.pool。*; import oracle.jdbc。*; public class Test20 {public static void main（String [] args）throws Exception {String szJdbcURL = args [0]; String szUser = args [1]; String szPasswd = args [2]; String szModelName = args [3]; //使用连接属性测试（取自一些示例）java.util。属性prop = new java.util。属性（）; prop.setProperty（“MinLimit”，“2”）; //缓存大小至少为2 prop.setProperty（“MaxLimit”，“10”）; prop.setProperty（“InitialLimit”，“2”）; //在启动时创建2个连接prop.setProperty（“InactivityTimeout”，“1800”）; // seconds prop.setProperty（“AbandonedConnectionTimeout”，“900”）; // seconds prop.setProperty（“MaxStatementsLimit”，“10”）; prop.setProperty（“PropertyCheckInterval”，“60”）; //秒System.out.println（“创建OraclePool”）; OraclePool op = new OraclePool（szJdbcURL，szUser，szPasswd，prop，“OracleSemConnPool”）; System.out.println（“完成创建OraclePool”）; //抓住Oracle并使用它做一些事情System.out.println（“从OraclePool获取Oracle”）; Oracle oracle = op.getOracle（）;的System.out.println（ “完成”）; System.out.println（“是逻辑连接：”+ oracle.getConnection（）。isLogicalConnection（））; GraphOracleSem g = new GraphOracleSem（oracle，szModelName）; g.add（Triple.create（Node.createURI（“u：John”），Node.createURI（“u：parentOf”），Node.createURI（“u：Mary”）））; g.close（）; //将Oracle返回池oracle.dispose（）; //抓住另一个Oracle并执行其他操作System.out.println（“从OraclePool获取Oracle”）; oracle = op.getOracle（）;的System.out.println（ “完成”）; System.out.println（“是逻辑连接：”+ oracle.getConnection（）。isLogicalConnection（））; g = new GraphOracleSem（oracle，szModelName）; g.add（Triple.create（Node.createURI（“u：John”），Node.createURI（“u：parentOf”），Node.createURI（“u：Jack”）））; g.close（）; OracleUtils.dropSemanticModel（oracle，szModelName）; //将Oracle返回池oracle.dispose（）; }}</pre><p>以下是编译和运行<a href="rdf-suipport-for-apache-jena.html#GUID-15F4439C-C1A5-4634-87CB-11F5347F25F9__CBBGHEEI">示例6-32</a>的命令，以及<code class="codeph">java</code>命令的预期输出。
                        </p><pre class="oac_no_warn" dir="ltr">javac -classpath ../jar/'*'Test20.java java -classpath。/:../jar/'*'Test20 jdbc：oracle：thin：@localhost：1521：orcl scott <span class="italic">&lt;password-for-scott&gt;</span> M1创建OraclePool完成创建OraclePool从OraclePool获取Oracle完成逻辑连接：true获取OraclePool完成的Oracle是逻辑连接：true</pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-9F748C0E-437D-4EBD-80CF-BFA91F3CFE3A" title="本节包括使用Apache Jena支持的示例查询。每个示例都是自包含的：它通常创建模型，创建三元组，执行可能涉及推理的查询，显示结果并删除模型。">使用Apache Jena的RDF语义图支持的示例查询</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="RDFRM484"></a><div class="props_rev_3"><a id="GUID-649269C9-6EB8-489C-B139-073CB8BA768E" name="GUID-649269C9-6EB8-489C-B139-073CB8BA768E"></a><h3 id="RDFRM-GUID-649269C9-6EB8-489C-B139-073CB8BA768E" class="sect3"><span class="enumeration_section">6.19</span> SPARQL网关和语义数据</h3>
               <div>
                  <p>SPARQL Gateway是一个J2EE Web应用程序，包含在Apache Jena的支持中。它旨在使语义数据（RDF / OWL / SKOS）易于用于运行关系数据和XML数据的应用程序，包括Oracle商业智能企业版（OBIEE）11 <span class="italic">g</span> 。
                  </p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-39A0D5BE-8F6C-468D-9164-4C6B7431A7B9">SPARQL网关功能和优点概述</a><br></li>
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-C7E88D7F-642A-49D7-AB3D-FBEFFC176CD6">安装和配置SPARQL Gateway</a><br></li>
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-5C5AD7B1-7601-431D-9026-2AACDC6A48DE">将SPARQL网关与语义数据结合使用</a><br></li>
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-B51AE2DD-2BD3-46BE-997F-240CDE0DCC2E">自定义默认XSLT文件</a><br></li>
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-62BFFBF3-55E2-42A1-977D-576DB3A55431">使用SPARQL Gateway Java API</a><br></li>
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-81166E14-3CA8-45A7-A15B-EBDD11497AB6">使用SPARQL Gateway图形Web界面</a><br></li>
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-66E24387-35FA-4F55-9E93-88F4570C6A54">使用SPARQL Gateway作为OBIEE的XML数据源</a><br></li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-3F437E3E-3B74-4CCF-9F16-B2B07B3899E8" title="Apache Jena的RDF语义图支持（这里也称为对Apache Jena的支持）通过实现着名的Jena Graph，Model和DatasetGraph API为Oracle Spatial和Graph RDF语义图提供了基于Java的接口。">Apache Jena的RDF语义图支持</a></p>
                     </div>
                  </div>
               </div>
               <a id="RDFRM485"></a><div class="props_rev_3"><a id="GUID-39A0D5BE-8F6C-468D-9164-4C6B7431A7B9" name="GUID-39A0D5BE-8F6C-468D-9164-4C6B7431A7B9"></a><h4 id="RDFRM-GUID-39A0D5BE-8F6C-468D-9164-4C6B7431A7B9" class="sect4"><span class="enumeration_section">6.19.1</span> SPARQL网关功能和优点概述</h4>
                  <div>
                     <p>SPARQL Gateway处理将语义数据暴露给非语义应用程序时的若干挑战：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>必须了解RDF语法，SPARQL查询语法和SPARQL协议。</p>
                        </li>
                        <li>
                           <p>必须了解SPARQL查询响应语法。</p>
                        </li>
                        <li>
                           <p>转换必须将SPARQL查询响应转换为应用程序可以使用的内容。</p>
                        </li>
                     </ul>
                     <p>为了应对这些挑战，SPARQL Gateway管理SPARQL查询和XSLT操作，针对任何符合标准的任意SPARQL端点执行SPARQL查询，并在将响应传递回应用程序之前执行必要的XSL转换。然后，应用程序可以使用语义数据，就像它来自现有数据源一样。</p>
                     <p>不同的三重商店或四元商店通常具有不同的功能。例如，Oracle数据库支持的SPARQL端点，支持Apache Jena和Joseki的RDF语义图，除了解析和应答的核心功能外，还允许并行执行，查询超时，动态采样，结果缓存和其他功能。给定的符合标准的SPARQL查询。但是，这些功能可能无法从其他给定的语义数据存储中获得。</p>
                     <p>使用RDF语义图SPARQL网关，您可以获得某些非常理想的功能，例如在长时间运行的查询上设置超时的能力以及在给定时间内从复杂查询中获取部分结果的能力。无限期地等待查询完成对最终用户来说是一个挑战，具有响应时间约束的应用程序也是如此。SPARQL Gateway在SPARQL端点上提供超时和尽力而为查询功能。这有效地消除了通过SPARQL查询执行消耗语义数据的一些不确定性。（请参阅<a href="rdf-suipport-for-apache-jena.html#GUID-839B32F5-1F75-46BC-8ECD-2A3CC4F4F439">指定超时值</a>并<a href="rdf-suipport-for-apache-jena.html#GUID-4E44DB12-68EA-441D-8269-8C5E5B02D68F">指定最佳努力查询执行</a> 。）
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-649269C9-6EB8-489C-B139-073CB8BA768E" title="SPARQL Gateway是一个J2EE Web应用程序，包含在Apache Jena的支持中。它旨在使语义数据（RDF / OWL / SKOS）易于用于运行关系和XML数据的应用程序，包括Oracle商业智能企业版（OBIEE）11g。">SPARQL网关和语义数据</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="RDFRM486"></a><div class="props_rev_3"><a id="GUID-C7E88D7F-642A-49D7-AB3D-FBEFFC176CD6" name="GUID-C7E88D7F-642A-49D7-AB3D-FBEFFC176CD6"></a><h4 id="RDFRM-GUID-C7E88D7F-642A-49D7-AB3D-FBEFFC176CD6" class="sect4"><span class="enumeration_section">6.19.2</span>安装和配置SPARQL网关</h4>
                  <div>
                     <p>要安装和配置SPARQL Gateway，请遵循以下主要步骤，这些步骤在他们自己的主题中进行了说明：</p>
                     <ol>
                        <li>
                           <p><a href="rdf-suipport-for-apache-jena.html#GUID-6083DBEE-5A3C-473A-83FB-CC533B85C7CA">下载Apache Jena .zip文件的RDF语义图支持（如果尚未完成）</a></p>
                        </li>
                        <li>
                           <p><a href="rdf-suipport-for-apache-jena.html#GUID-31483449-5E99-4400-8F37-3DBCCD74F10F">在WebLogic Server中部署SPARQL Gateway</a></p>
                        </li>
                        <li>
                           <p><a href="rdf-suipport-for-apache-jena.html#GUID-1B2C9D7D-6350-4A4D-8AE9-5D2770BCF6BD">如有必要，修改代理服务器设置_</a></p>
                        </li>
                        <li>
                           <p><a href="rdf-suipport-for-apache-jena.html#GUID-B8F3817F-59B1-48C2-8EC5-7675251AD651">如有必要，配置OracleSGDS数据源</a></p>
                        </li>
                        <li>
                           <p><a href="rdf-suipport-for-apache-jena.html#GUID-E635224C-8499-462A-8F9C-E3EB7B8DF6F8">如果需要，添加并配置SparqlGatewayAdminGroup Group_</a></p>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-6083DBEE-5A3C-473A-83FB-CC533B85C7CA">下载Apache Jena .zip文件的RDF语义图支持（如果尚未完成）</a><br></li>
                        <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-31483449-5E99-4400-8F37-3DBCCD74F10F">在WebLogic Server中部署SPARQL Gateway</a><br></li>
                        <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-1B2C9D7D-6350-4A4D-8AE9-5D2770BCF6BD">如有必要，修改代理设置</a><br></li>
                        <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-B8F3817F-59B1-48C2-8EC5-7675251AD651">如有必要，配置OracleSGDS数据源</a><br></li>
                        <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-E635224C-8499-462A-8F9C-E3EB7B8DF6F8">如果需要，添加并配置SparqlGatewayAdminGroup组</a><br></li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-649269C9-6EB8-489C-B139-073CB8BA768E" title="SPARQL Gateway是一个J2EE Web应用程序，包含在Apache Jena的支持中。它旨在使语义数据（RDF / OWL / SKOS）易于用于运行关系和XML数据的应用程序，包括Oracle商业智能企业版（OBIEE）11g。">SPARQL网关和语义数据</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="RDFRM487"></a><div class="props_rev_3"><a id="GUID-6083DBEE-5A3C-473A-83FB-CC533B85C7CA" name="GUID-6083DBEE-5A3C-473A-83FB-CC533B85C7CA"></a><h5 id="RDFRM-GUID-6083DBEE-5A3C-473A-83FB-CC533B85C7CA" class="sect5"><span class="enumeration_section">6.19.2.1</span>下载Apache Jena .zip文件的RDF语义图支持（如果尚未完成）</h5>
                     <div>
                        <p>如果您还没有这样做，请从RDF语义图页面下载Apache Jena文件的RDF语义图支持，并将其解压缩到临时目录中，如<a href="rdf-suipport-for-apache-jena.html#GUID-17E0C43D-2625-4D69-BBD7-1BCF204684EA" title="要使用对Apache Jena的支持，必须首先确保系统环境具有必要的软件，包括Oracle Database 11g第2版或更高版本，其中包含空间和图形和分区选项以及启用了RDF语义图支持，Apache Jena 2.11.1 ，以及JDK 1.6或更高版本。">设置软件环境中所述</a> 。
                        </p>
                        <p>请注意，SPARQL Gateway Java类实现嵌入在<code class="codeph">sdordfclient.jar</code> （请参阅<a href="rdf-suipport-for-apache-jena.html#GUID-62BFFBF3-55E2-42A1-977D-576DB3A55431">使用SPARQL Gateway Java API</a> ）。
                        </p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-C7E88D7F-642A-49D7-AB3D-FBEFFC176CD6">安装和配置SPARQL Gateway</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="RDFRM488"></a><div class="props_rev_3"><a id="GUID-31483449-5E99-4400-8F37-3DBCCD74F10F" name="GUID-31483449-5E99-4400-8F37-3DBCCD74F10F"></a><h5 id="RDFRM-GUID-31483449-5E99-4400-8F37-3DBCCD74F10F" class="sect5"><span class="enumeration_section">6.19.2.2</span>在WebLogic Server中部署SPARQL网关</h5>
                     <div>
                        <p>在Oracle WebLogic Server中部署SPARQL Gateway，如下所示：</p>
                        <ol>
                           <li>
                              <p>转到WebLogic Server的autodeploy目录，并复制预先构建的<code class="codeph">sparqlgateway.war</code>文件，如下所示。（有关在开发域中自动部署应用程序的信息，请参阅： <a href="http://docs.oracle.com/cd/E11035_01/wls100/deployment/autodeploy.html" target="_blank"><code class="codeph">http://docs.oracle.com/cd/E11035_01/wls100/deployment/autodeploy.html</code></a> ： <a href="http://docs.oracle.com/cd/E11035_01/wls100/deployment/autodeploy.html" target="_blank"><code class="codeph">http://docs.oracle.com/cd/E11035_01/wls100/deployment/autodeploy.html</code></a> ）</p><pre class="oac_no_warn" dir="ltr">cp -rf /tmp/jena_adapter/sparqlgateway_web_app/sparqlgateway.war <span class="italic">&lt;domain_name&gt;</span> /autodeploy/sparqgateway.war</pre><p>在此示例中， <span class="italic">&lt;domain_name&gt;</span>是WebLogic Server域的名称。
                              </p>
                              <p>您可以通过以下方式自定义预构建的应用程序：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>根据需要修改<code class="codeph">sparqlgateway_web_app/sparqlgateway.war</code>嵌入的<code class="codeph">WEB-INF/web.xml</code>文件。确保为<code class="codeph">sparql_gateway_repository_filedir</code>和<code class="codeph">sparql_gateway_repository_url</code>参数指定适当的值。
                                    </p>
                                 </li>
                                 <li>
                                    <p>如有必要，将XSLT文件或SPARQL查询文件添加到<code class="codeph">sparqlgateway_web_app/sparqlgateway.war</code>的顶级目录中。
                                    </p>
                                    <p>Oracle在该目录中提供了以下文件： <code class="codeph">default.xslt</code> ， <code class="codeph">noop.xslt</code>和<code class="codeph">qb1.sparql</code> 。<code class="codeph">default.xslt</code>文件主要用于将SPARQL查询响应（XML）转换为Oracle可接受的格式。
                                    </p>
                                    <p>（这些文件在<a href="rdf-suipport-for-apache-jena.html#GUID-668EAD23-D36E-4098-B3B9-BB1586AC9734">存储SPARQL查询和XSL转换中</a>进行了描述;在<a href="rdf-suipport-for-apache-jena.html#GUID-66E24387-35FA-4F55-9E93-88F4570C6A54">使用SPARQL网关作为OBIEE的XML数据源时，将使用</a>带有OBIEE的SPARQL网关进行了说明。）
                                    </p>
                                 </li>
                              </ul>
                           </li>
                           <li>
                              <p>使用Web浏览器以下列格式连接到URL来验证部署（假设Web应用程序部署在端口7001）：</p><pre class="oac_no_warn" dir="ltr">http：// <span class="italic">&lt;hostname&gt;</span> ：7001 / sparqlgateway</pre></li>
                        </ol>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-C7E88D7F-642A-49D7-AB3D-FBEFFC176CD6">安装和配置SPARQL Gateway</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="RDFRM489"></a><div class="props_rev_3"><a id="GUID-1B2C9D7D-6350-4A4D-8AE9-5D2770BCF6BD" name="GUID-1B2C9D7D-6350-4A4D-8AE9-5D2770BCF6BD"></a><h5 id="RDFRM-GUID-1B2C9D7D-6350-4A4D-8AE9-5D2770BCF6BD" class="sect5"><span class="enumeration_section">6.19.2.3</span>如有必要，修改代理设置</h5>
                     <div>
                        <p>如果您的SPARQL网关位于防火墙后面，并且您希望SPARQL Gateway与Internet上的SPARQL端点以及防火墙内的SPARQL端点进行通信，则可能需要使用以下JVM设置：</p><pre class="oac_no_warn" dir="ltr">-Dhttp.proxyHost = &lt; <span class="italic">your_proxy_host&gt;</span> -Dhttp.proxyPort = <span class="italic">&lt;your_proxy_port&gt;</span> -Dhttp.nonProxyHosts = 127.0.0.1 | <span class="italic">&lt;hostname_1_for_sparql_endpoint_inside_firewall&gt;</span> | <span class="italic">&lt;hostname_2_for_sparql_endpoint_inside_firewall&gt;</span> | ... | <span class="italic">&lt;hostname_n_for_sparql_endpoint_inside_firewall&gt;</span>
</pre><p>您可以在<code class="codeph">startWebLogic.sh</code>脚本中指定这些设置。
                        </p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-C7E88D7F-642A-49D7-AB3D-FBEFFC176CD6">安装和配置SPARQL Gateway</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="RDFRM490"></a><div class="props_rev_3"><a id="GUID-B8F3817F-59B1-48C2-8EC5-7675251AD651" name="GUID-B8F3817F-59B1-48C2-8EC5-7675251AD651"></a><h5 id="RDFRM-GUID-B8F3817F-59B1-48C2-8EC5-7675251AD651" class="sect5"><span class="enumeration_section">6.19.2.4</span>如有必要，配置OracleSGDS数据源</h5>
                     <div>
                        <p>如果Oracle数据库用于存储和访问SPARQL查询的SPARQL查询和XSL转换，则必须配置名为<code class="codeph">OracleSGDS</code>的数据源。</p>
                        <p>要创建此数据源，请按照<a href="rdf-suipport-for-apache-jena.html#GUID-CC0618F7-318D-4F21-A78D-29CF31FDDB7F">使用WebLogic Server创建所需数据源中</a>的说明进行操作;但是，请将<span class="bold"><code class="codeph">OracleSGDS</code></span>指定为数据源名称而不是<code class="codeph">OracleSemDS</code> 。</p>
                        <p>如果<code class="codeph">OracleSGDS</code>数据源已配置且可用，则SPARQL Gateway servlet将在初始化时自动创建所有必需的表和索引。
                        </p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-C7E88D7F-642A-49D7-AB3D-FBEFFC176CD6">安装和配置SPARQL Gateway</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="RDFRM491"></a><div class="props_rev_3"><a id="GUID-E635224C-8499-462A-8F9C-E3EB7B8DF6F8" name="GUID-E635224C-8499-462A-8F9C-E3EB7B8DF6F8"></a><h5 id="RDFRM-GUID-E635224C-8499-462A-8F9C-E3EB7B8DF6F8" class="sect5"><span class="enumeration_section">6.19.2.5</span>如果<span class="enumeration_section">需要，</span>添加并配置SparqlGatewayAdminGroup组</h5>
                     <div>
                        <p>SPARQL Gateway中的以下JSP文件可以帮助您查看，编辑和更新存储在Oracle数据库中的SPARQL查询和XSL转换：</p><pre class="oac_no_warn" dir="ltr">http：// <span class="italic">&lt;host&gt;</span> ：7001 / sparqlgateway / admin / sparql.jsp http：// <span class="italic">&lt;host&gt;</span> ：7001 / sparqlgateway / admin / xslt.jsp</pre><p>这些文件受HTTP基本身份验证保护。在<code class="codeph">WEB-INF/weblogic.xml</code> ，定义了名为<code class="codeph">SparqlGatewayAdminGroup</code>的主体。
                        </p>
                        <p>要能够登录这些JSP页面中的任何一个，必须使用WebLogic Server添加名为<code class="codeph">SparqlGatewayAdminGroup</code>的组，并创建新用户或将现有用户分配给该组。
                        </p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-C7E88D7F-642A-49D7-AB3D-FBEFFC176CD6">安装和配置SPARQL Gateway</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div><a id="RDFRM492"></a><div class="props_rev_3"><a id="GUID-5C5AD7B1-7601-431D-9026-2AACDC6A48DE" name="GUID-5C5AD7B1-7601-431D-9026-2AACDC6A48DE"></a><h4 id="RDFRM-GUID-5C5AD7B1-7601-431D-9026-2AACDC6A48DE" class="sect4"><span class="enumeration_section">6.19.3</span>将SPARQL网关与语义数据配合使用</h4>
                  <div>
                     <p>应用程序与SPARQL Gateway交互的主要接口是通过具有以下格式的URL：</p><pre class="oac_no_warn" dir="ltr">HTTP：//主机：端口/ sparqlgateway / SG？ <span class="italic">&lt;SPARQL_ENDPOINT&gt;</span> ＆ <span class="italic">&lt;SPARQL_QUERY&gt;</span> ＆ <span class="italic">&lt;XSLT&gt;</span>
</pre><p>在上面的格式中：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><span class="italic">&lt;SPARQL_ENDPOINT&gt;</span>指定<code class="codeph">ee</code>参数，该参数包含SPARQL端点的URL编码形式。
                           </p>
                           <p>例如， <code class="codeph">ee=http%3A%2F%2Fsparql.org%2Fbooks</code>是SPARQL端点<code class="codeph">http://sparql.org/books</code>的URL编码字符串。这意味着要对端点<code class="codeph">http://sparql.org/books</code>执行SPARQL查询。</p>
                        </li>
                        <li>
                           <p><span class="italic">&lt;SPARQL_QUERY&gt;</span>指定SPARQL查询或SPARQL查询的位置。
                           </p>
                           <p>如果应用程序可以接受非常长的URL，则可以编码整个SPARQL查询并在URL中设置<code class="codeph">eq=</code> <span class="italic"><code class="codeph">&lt;encoded_SPARQL_query&gt;</code></span>如果应用程序无法接受非常长的URL，则可以存储SPARQL使用<a href="rdf-suipport-for-apache-jena.html#GUID-668EAD23-D36E-4098-B3B9-BB1586AC9734">存储SPARQL查询和XSL转换中</a>描述的方法之一查询并使它们可用于SPARQL Gateway。
                           </p>
                        </li>
                        <li>
                           <p><span class="italic">&lt;XSLT&gt;</span>指定XSL转换或XSL转换的位置。
                           </p>
                           <p>如果应用程序可以接受非常长的URL，则可以对整个XSL转换进行编码并在URL中设置<code class="codeph">ex=</code> <span class="italic"><code class="codeph">&lt;encoded_XSLT&gt;</code></span>如果应用程序无法接受非常长的URL，则可以存储XSL转换并使用<a href="rdf-suipport-for-apache-jena.html#GUID-668EAD23-D36E-4098-B3B9-BB1586AC9734">存储SPARQL查询和XSL转换中</a>描述的方法之一将它们提供给SPARQL Gateway。
                           </p>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-668EAD23-D36E-4098-B3B9-BB1586AC9734">存储SPARQL查询和XSL转换</a><br></li>
                        <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-839B32F5-1F75-46BC-8ECD-2A3CC4F4F439">指定超时值</a><br></li>
                        <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-4E44DB12-68EA-441D-8269-8C5E5B02D68F">指定最佳努力查询执行</a><br></li>
                        <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-096AD341-4C69-4643-A56E-FC18605024CA">指定除text / xml之外的内容类型</a><br></li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-649269C9-6EB8-489C-B139-073CB8BA768E" title="SPARQL Gateway是一个J2EE Web应用程序，包含在Apache Jena的支持中。它旨在使语义数据（RDF / OWL / SKOS）易于用于运行关系和XML数据的应用程序，包括Oracle商业智能企业版（OBIEE）11g。">SPARQL网关和语义数据</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="RDFRM493"></a><div class="props_rev_3"><a id="GUID-668EAD23-D36E-4098-B3B9-BB1586AC9734" name="GUID-668EAD23-D36E-4098-B3B9-BB1586AC9734"></a><h5 id="RDFRM-GUID-668EAD23-D36E-4098-B3B9-BB1586AC9734" class="sect5"><span class="enumeration_section">6.19.3.1</span>存储SPARQL查询和XSL转换</h5>
                     <div>
                        <p>如果应用程序无法接受非常长的URL，则可以在<a href="rdf-suipport-for-apache-jena.html#GUID-5C5AD7B1-7601-431D-9026-2AACDC6A48DE">使用带语义数据的SPARQL网关中</a>描述的URL格式的<span class="italic">&lt;SPARQL_QUERY&gt;</span>和<span class="italic">&lt;XSLT&gt;</span>部分中指定SPARQL查询和XSL转换的位置，使用以下任何一种方法：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>将SPARQL查询和XSL转换存储在SPARQL Gateway Web应用程序本身中。</p>
                              <p>为此，请解压缩<code class="codeph">sparqlgateway.war</code>文件，并将SPARQL查询和XSL转换存储在顶级目录中;然后打包<code class="codeph">sparqlgateway.war</code>文件并重新部署它。
                              </p>
                              <p><code class="codeph">sparqlgateway.war</code>文件包含以下示例文件： <code class="codeph">qb1.sparql</code> （SPARQL查询）和<code class="codeph">default.xslt</code> （XSL转换）。
                              </p>
                              <div class="infobox-tip" id="GUID-668EAD23-D36E-4098-B3B9-BB1586AC9734__GUID-D69075CD-8481-4CC4-B9D1-FE5F28C22022">
                                 <p class="notep1">小费：</p>
                                 <p>使用文件扩展名<code class="codeph">.sparql</code>为SPARQL查询文件和文件扩展名<code class="codeph">.xslt</code>为XSL转换文件。
                                 </p>
                              </div>
                              <p>指定这些文件的语法（使用提供的示例文件名）对于SPARQL查询文件是<span class="bold"><code class="codeph">wq</code></span> <code class="codeph">=qb1</code> .sparql，对于XSL转换文件是<span class="bold"><code class="codeph">wx</code></span> <code class="codeph">=default.xslt</code> 。
                              </p>
                              <p>如果要自定义默认XSL转换，请参阅<a href="rdf-suipport-for-apache-jena.html#GUID-B51AE2DD-2BD3-46BE-997F-240CDE0DCC2E">自定义默认XSLT文件中</a>的示例。
                              </p>
                              <p>如果指定<code class="codeph">wx=noop.xslt</code> ，则不执行XSL转换，并且“按原样”将SPARQL响应返回给客户端。
                              </p>
                           </li>
                           <li>
                              <p>将SPARQL查询和XSL转换存储在文件系统目录中，并确保已部署的SPARQL Gateway Web应用程序可以访问该目录。</p>
                              <p>默认情况下，目录设置为<code class="codeph">/tmp</code> ，如以下<code class="codeph">&lt;init-param&gt;</code>设置所示：</p><pre class="oac_no_warn" dir="ltr">&lt;init-param&gt; &lt;param-name&gt; sparql_gateway_repository_ <span class="bold">filedir</span> &lt;/ param-name&gt; &lt;param-value&gt; <span class="bold">/ tmp /</span> &lt;/ param-value&gt; &lt;/ init-param&gt;</pre><p>建议您在部署SPARQL Gateway之前自定义此目录。要更改目录设置，请编辑<code class="codeph">&lt;param-value&gt;</code>和<code class="codeph">&lt;/param-value&gt;</code>标记之间的文本。
                              </p>
                              <p>以下示例指定SPARQL查询文件和XSL转换文件，这些文件位于<code class="codeph">sparql_gateway_repository_filedir</code>的<code class="codeph">&lt;init-param&gt;</code>元素中指定的目录中：</p><pre class="oac_no_warn" dir="ltr"><span class="bold">fq</span> = qb1.sparql <span class="bold">fx</span> = myxslt1.xslt</pre></li>
                           <li>
                              <p>使网站可以访问SPARQL查询和XSL转换。</p>
                              <p>默认情况下，网站目录设置为<code class="codeph">http://127.0.0.1/queries/</code> ，如以下<code class="codeph">&lt;init-param&gt;</code>设置所示：</p><pre class="oac_no_warn" dir="ltr">&lt;init-param&gt; &lt;param-name&gt; sparql_gateway_repository_ <span class="bold">url</span> &lt;/ param-name&gt; &lt;param-value&gt; <span class="bold">http://127.0.0.1/queries/</span> &lt;/ param-value&gt; &lt;/ init-param&gt;</pre><p>在部署SPARQL Gateway之前自定义此目录。要更改网站设置，请编辑<code class="codeph">&lt;param-value&gt;</code>和<code class="codeph">&lt;/param-value&gt;</code>标记之间的文本。
                              </p>
                              <p>以下示例指定SPARQL查询文件和XSL转换文件，这些文件位于<code class="codeph">sparql_gateway_repository_url</code>的<code class="codeph">&lt;init-param&gt;</code>元素中指定的URL中。
                              </p><pre class="oac_no_warn" dir="ltr"><span class="bold">uq</span> = qb1.sparql <span class="bold">ux</span> = myxslt1.xslt</pre><p>在内部，SPARQL Gateway计算相应的完整URL，获取内容，启动查询执行，并将XSL转换应用于查询响应XML。</p>
                           </li>
                           <li>
                              <p>将SPARQL查询和XSL转换存储在Oracle数据库中。</p>
                              <p>此方法要求定义J2EE数据源<code class="codeph">OracleSGDS</code> 。在SPARQL Gateway从OracleSGDS数据源检索数据库连接后，将使用提供的整数ID从数据库表ORACLE_ORARDF_SG_QUERY中读取SPARQL查询。
                              </p>
                              <p>从Oracle数据库获取SPARQL查询的语法是<span class="bold"><code class="codeph">dq=</code></span> <code class="codeph">&lt;integer-id&gt;</code> ，从Oracle数据库获取XSL转换的语法是<span class="bold"><code class="codeph">dx=</code></span> <code class="codeph">&lt;integer-id&gt;</code> 。
                              </p>
                              <p>在servlet初始化时，如果它们尚不存在，则会自动创建以下表（您不需要手动创建它们）：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>ORACLE_ORARDF_SG_QUERY，主键为QID（整数类型）</p>
                                 </li>
                                 <li>
                                    <p>ORACLE_ORARDF_SG_XSLT，主键为XID（整数类型）</p>
                                 </li>
                              </ul>
                           </li>
                        </ul>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-5C5AD7B1-7601-431D-9026-2AACDC6A48DE">将SPARQL网关与语义数据一起使用</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="RDFRM494"></a><div class="props_rev_3"><a id="GUID-839B32F5-1F75-46BC-8ECD-2A3CC4F4F439" name="GUID-839B32F5-1F75-46BC-8ECD-2A3CC4F4F439"></a><h5 id="RDFRM-GUID-839B32F5-1F75-46BC-8ECD-2A3CC4F4F439" class="sect5"><span class="enumeration_section">6.19.3.2</span>指定超时值</h5>
                     <div>
                        <p>使用“ <a href="rdf-suipport-for-apache-jena.html#GUID-5C5AD7B1-7601-431D-9026-2AACDC6A48DE">使用带语义数据的SPARQL网关”中</a>所述的URL格式提交可能长时间运行的查询时，可以通过指定超时值（以毫秒为单位）来限制执行时间。例如，以下显示了SPARQL查询从SPARQL Gateway开始执行的URL格式和超时规范将在1000毫秒（1秒）后结束：</p><pre class="oac_no_warn" dir="ltr">http：// <span class="italic">host：port</span> / sparqlgateway / sg？ <span class="italic">&lt;SPARQL_ENDPOINT&gt;</span> ＆ <span class="italic">&lt;SPARQL_QUERY&gt;</span> ＆ <span class="italic">&lt;XSLT&gt;</span> <span class="bold">＆t = 1000</span>
</pre><p>如果在发生超时时查询未完成，则SPARQL Gateway将构造一个空的SPARQL响应。</p>
                        <p>请注意，即使SPARQL Gateway在HTTP连接级别超时查询，查询仍可能在服务器端运行。实际行为将取决于供应商。</p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-5C5AD7B1-7601-431D-9026-2AACDC6A48DE">将SPARQL网关与语义数据一起使用</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="RDFRM495"></a><div class="props_rev_3"><a id="GUID-4E44DB12-68EA-441D-8269-8C5E5B02D68F" name="GUID-4E44DB12-68EA-441D-8269-8C5E5B02D68F"></a><h5 id="RDFRM-GUID-4E44DB12-68EA-441D-8269-8C5E5B02D68F" class="sect5"><span class="enumeration_section">6.19.3.3</span>指定尽力而为的查询执行</h5>
                     <div>
                        <div class="infoboxnote" id="GUID-4E44DB12-68EA-441D-8269-8C5E5B02D68F__GUID-D9F91EA8-67D7-419E-A0E8-1A3FC339646D">
                           <p class="notep1">注意：</p>
                           <p>仅当您还指定了超时值（在“ <a href="rdf-suipport-for-apache-jena.html#GUID-839B32F5-1F75-46BC-8ECD-2A3CC4F4F439">指定</a>超时值”中描述）时，才可以指定尽力而为查询执行。
                           </p>
                        </div>
                        <p>使用“ <a href="rdf-suipport-for-apache-jena.html#GUID-5C5AD7B1-7601-431D-9026-2AACDC6A48DE">使用带语义数据的SPARQL网关”中</a>所述的URL格式提交可能长时间运行的查询时，如果指定超时值，则还可以为查询指定“尽力而为”限制。例如，以下显示的URL格式的超时规格为1000毫秒（1秒）和尽力而为规范（ <code class="codeph">&amp;b=t</code> ）：</p><pre class="oac_no_warn" dir="ltr">http：// <span class="italic">host：port</span> / sparqlgateway / sg？ <span class="italic">&lt;SPARQL_ENDPOINT&gt;</span> ＆ <span class="italic">&lt;SPARQL_QUERY&gt;</span> ＆ <span class="italic">&lt;XSLT&gt;</span> <span class="bold">＆t = 1000</span> <span class="bold">＆b = t</span>
</pre><p>web.xml文件包含两个影响尽力选项行为的参数设置： <code class="codeph">sparql_gateway_besteffort_maxrounds</code>和<code class="codeph">sparql_gateway_besteffort_maxthreads</code> 。以下显示默认定义：</p><pre class="oac_no_warn" dir="ltr">&lt;init-param&gt; &lt;param-name&gt; sparql_gateway_besteffort_maxrounds &lt;/ param-name&gt; &lt;param-value&gt; 10 &lt;/ param-value&gt; &lt;/ init-param&gt; &lt;init-param&gt; &lt;param-name&gt; sparql_gateway_besteffort_maxthreads &lt;/ param- name&gt; &lt;param-value&gt; 3 &lt;/ param-value&gt; &lt;/ init-param&gt;</pre><p>当以尽力而为的方式执行SPARQL SELECT查询时，将在SPARQL查询正文中使用增加的LIMIT值设置执行一系列查询。（核心思想是基于观察到SPARQL查询以较小的LIMIT设置运行得更快。）SPARQL Gateway以“LIMIT 1”设置启动查询执行。理想情况下，此查询可以在超时到期之前完成。假设是这种情况，下一个查询将增加其LIMIT设置，并且后续查询具有更高的限制。查询执行的最大数量由<code class="codeph">sparql_gateway_besteffort_maxrounds</code>参数控制。
                        </p>
                        <p>如果可以并行运行一系列查询，则<code class="codeph">sparql_gateway_besteffort_maxthreads</code>参数控制并行度。
                        </p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-5C5AD7B1-7601-431D-9026-2AACDC6A48DE">将SPARQL网关与语义数据一起使用</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="RDFRM496"></a><div class="props_rev_3"><a id="GUID-096AD341-4C69-4643-A56E-FC18605024CA" name="GUID-096AD341-4C69-4643-A56E-FC18605024CA"></a><h5 id="RDFRM-GUID-096AD341-4C69-4643-A56E-FC18605024CA" class="sect5"><span class="enumeration_section">6.19.3.4</span>指定text / xml <span class="enumeration_section">以外</span>的内容类型</h5>
                     <div>
                        <p>默认情况下，SPARQL Gateway假定XSL转换生成XML，因此为HTTP响应设置的默认内容类型为<code class="codeph">text/xml</code> 。但是，如果您的应用程序需要XML以外的响应格式，则可以使用以下格式在其他URL参数（语法<code class="codeph">&amp;rt=</code> ）中指定格式：</p><pre class="oac_no_warn" dir="ltr">http：// <span class="italic">host</span> ： <span class="italic">port</span> / sparqlgateway / sg？ <span class="italic">&lt;SPARQL_ENDPOINT&gt;</span> ＆ <span class="italic">&lt;SPARQL_QUERY&gt;</span> ＆&lt;XSLT&gt; <span class="bold">＆rt =</span> <span class="italic"><span class="bold">&lt;content_type&gt;</span></span>
</pre><p>请注意， <span class="italic">&lt;content_type&gt;</span>必须是URL编码的。
                        </p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-5C5AD7B1-7601-431D-9026-2AACDC6A48DE">将SPARQL网关与语义数据一起使用</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div><a id="RDFRM497"></a><div class="props_rev_3"><a id="GUID-B51AE2DD-2BD3-46BE-997F-240CDE0DCC2E" name="GUID-B51AE2DD-2BD3-46BE-997F-240CDE0DCC2E"></a><h4 id="RDFRM-GUID-B51AE2DD-2BD3-46BE-997F-240CDE0DCC2E" class="sect4"><span class="enumeration_section">6.19.4</span>自定义默认XSLT文件</h4>
                  <div>
                     <p>您可以自定义默认的XSL转换文件（使用<code class="codeph">wx=default.xslt</code>引用的文件）。本节介绍自定义的一些示例。
                     </p>
                     <p>以下示例实现此命名空间前缀替换逻辑：如果变量绑定返回以<code class="codeph">http://purl.org/goodrelations/v1#</code>开头的URI，则该部分将替换为<code class="codeph">gr:</code> ;如果变量绑定返回以<code class="codeph">http://www.w3.org/2000/01/rdf-schema#</code>开头的URI，则该部分将替换为<code class="codeph">rdfs:</code> .
                     </p><pre class="oac_no_warn" dir="ltr">&lt;xsl：when test =“starts-with（text（），'http：//purl.org/goodrelations/v1#'）”&gt; &lt;xsl：value-of select =“concat（'gr：'，substring-之后（text（），'http：//purl.org/goodrelations/v1#'））“/&gt; &lt;/ xsl：when&gt; ...&lt;xsl：when test =“starts-with（text（），'http：//www.w3.org/2000/01/rdf-schema#'）”&gt; &lt;xsl：value-of select =“concat（' rdfs：'，substring-after（text（），'http：//www.w3.org/2000/01/rdf-schema#'））“/&gt; &lt;/ xsl：when&gt;</pre><p>以下示例实现了修剪前导<code class="codeph">http://localhost/</code>或前导<code class="codeph">http://127.0.0.1/</code>逻辑。</p><pre class="oac_no_warn" dir="ltr">&lt;xsl：when test =“starts-with（text（），'http：// localhost /'）”&gt; &lt;xsl：value-of select =“substring-after（text（），'http：// localhost / '）“/&gt; &lt;/ xsl：when&gt; &lt;xsl：when test =”starts-with（text（），'http：//127.0.0.1/'）“&gt; &lt;xsl：value-of select =”substring- after（text（），'http：//127.0.0.1/'）“/&gt; &lt;/ xsl：when&gt;</pre></div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-649269C9-6EB8-489C-B139-073CB8BA768E" title="SPARQL Gateway是一个J2EE Web应用程序，包含在Apache Jena的支持中。它旨在使语义数据（RDF / OWL / SKOS）易于用于运行关系和XML数据的应用程序，包括Oracle商业智能企业版（OBIEE）11g。">SPARQL网关和语义数据</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="RDFRM499"></a><a id="RDFRM501"></a><a id="RDFRM502"></a><a id="RDFRM498"></a><div class="props_rev_3"><a id="GUID-62BFFBF3-55E2-42A1-977D-576DB3A55431" name="GUID-62BFFBF3-55E2-42A1-977D-576DB3A55431"></a><h4 id="RDFRM-GUID-62BFFBF3-55E2-42A1-977D-576DB3A55431" class="sect4"><span class="enumeration_section">6.19.5</span>使用SPARQL Gateway Java API</h4>
                  <div>
                     <p>除了Web界面之外，SPARQL Gateway管理服务还提供了一个方便的Java应用程序编程接口（API），用于管理SPARQL查询及其关联的XSL转换。Java API包含在Apache Jena库的<code class="codeph">sdordfclient.jar</code>的RDF语义图支持中。
                     </p>
                     <p>Java API参考信息位于SPARQL Gateway .zip文件中包含的<code class="codeph">javadoc_sparqlgateway.zip</code>文件中（在<a href="rdf-suipport-for-apache-jena.html#GUID-6083DBEE-5A3C-473A-83FB-CC533B85C7CA">下载Apache Jena .zip文件的RDF语义图支持（如果尚未完成）中进行了描述</a> ）。
                     </p>
                     <p>此API的主要入口点是<code class="codeph">oracle.spatial.rdf.client.jena.SGDBHandler</code>类（SPARQL网关数据库处理程序），它提供以下用于管理查询和转换的静态方法：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">deleteSparqlQuery（Connection，int）</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">deleteXslt（Connection，int）</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">insertSparqlQuery（Connection，int，String，String，boolean）</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">insertXslt（Connection，int，String，String，boolean）</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">getSparqlQuery（Connection，int，StringBuilder，StringBuilder）</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">getXslt（Connection，int，StringBuilder，StringBuilder）</code></p>
                        </li>
                     </ul>
                     <p>这些方法操作和检索存储在Oracle数据库实例中的SPARQL网关关联表中的条目。要使用这些方法，必须已存在必要的关联表。如果表不存在，请在Web服务器上部署SPARQL Gateway，并使用以下格式访问URL：</p><pre class="oac_no_warn" dir="ltr">http：// <span class="italic">&lt;host&gt;</span> ： <span class="italic">&lt;port&gt;</span> / sparqlgateway / sg？</pre><p>其中<span class="italic">&lt;host&gt;</span>是Web服务器的主机名， <span class="italic">&lt;port&gt;</span>是Web服务器的侦听端口。访问此URL将自动创建必要的表（如果它们尚不存在）。
                     </p>
                     <p>通过Java API进行的任何更改都会影响SPARQL Gateway Web服务，其方式与通过管理Web界面所做的更改相同。这提供了使用您最方便的界面管理查询和转换的灵活性。</p>
                     <p>请注意，Java API提供的插入方法不会替换存储在表中的现有查询或转换。尝试替换现有查询或转换将失败。要替换查询或转换，必须使用其中一种删除方法删除表中的现有条目，然后使用其中一种插入方法插入新查询或转换。</p>
                     <p>以下示例演示了如何使用Java API执行常见管理任务。这些示例假定已经建立了与支持SPARQL Gateway的基础Oracle数据库实例的连接。</p>
                     <div class="example" id="GUID-62BFFBF3-55E2-42A1-977D-576DB3A55431__BGBJHJCH">
                        <p class="titleinexample">示例6-33存储SPARQL查询和XSL转换</p>
                        <p><a href="rdf-suipport-for-apache-jena.html#GUID-62BFFBF3-55E2-42A1-977D-576DB3A55431__BGBJHJCH">例6-33</a>向支持SPARQL网关的数据库添加了查询和XSL转换。添加查询和转换后，其他程序可以通过在请求URL中指定相应的查询ID（ <code class="codeph">qid</code> ）和XSL转换ID（ <code class="codeph">xid</code> ）来使用通过网关的查询和转换。</p>
                        <p>请注意，尽管<a href="rdf-suipport-for-apache-jena.html#GUID-62BFFBF3-55E2-42A1-977D-576DB3A55431__BGBJHJCH">示例6-33同时</a>插入了查询和转换，但查询和转换不一定相关，在访问SPARQL Gateway时不需要一起使用。在向SPARQL Gateway提交请求时，数据库中的任何查询都可以与数据库中的任何转换一起使用。
                        </p><pre class="oac_no_warn" dir="ltr">字符串查询=“PREFIX ...SELECT ...“; //完整的SPARQL查询文本字符串xslt =”&lt;？xml ...&gt; ...“; //完整的XSLT转换文本字符串queryDesc =”会议与会者信息“; // SPARQL查询的描述字符串xsltDesc =”BIEE表窗口小部件转换“; // XSLT转换的描述int queryId = queryIdCounter ++; //为此查询分配唯一ID int xsltId = xsltIdCounter ++; //为此转换分配唯一ID //如果表已包含//具有相同ID的条目，则插入查询或转换将失败。将此布尔值设置为true将忽略这些//异常（但表将保持不变）。在这里，我们指定//如果遇到重复ID，我们想要抛出异常。 boolean ignoreDupException = false; //添加查询try {//删除查询（如果已存在此ID）（如果不存在此条目，则<span class="bold">不会</span>抛出//错误）SGDBHandler.deleteSparqlQuery（connection，queryId）; SGDBHandler.insertSparqlQuery（connection，queryId，query，queryDesc，ignoreDupException）; } catch（SQLException sqle）{//句柄异常} catch（QueryException qe）{//处理查询语法异常} //添加XSLT try {//删除xslt（如果已存在此ID）（这<span class="bold">不会</span>抛出/ /如果不存在此类条目，则出错）SGDBHandler.deleteXslt（connection，xsltId）; SGDBHandler.insertXslt（connection，xsltId，xslt，xsltDesc，ignoreDupException）; } catch（SQLException sqle）{//处理数据库异常} catch（TransformerConfigurationException tce）{//处理XSLT语法异常}</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-62BFFBF3-55E2-42A1-977D-576DB3A55431__BGBFGBGJ">
                        <p class="titleinexample">示例6-34修改查询</p>
                        <p><a href="rdf-suipport-for-apache-jena.html#GUID-62BFFBF3-55E2-42A1-977D-576DB3A55431__BGBFGBGJ">例6-34</a>从数据库中检索现有查询，对其进行修改，然后将更新后的查询版本存储回数据库中。这些步骤模拟编辑查询并保存更改。（请注意，如果查询不存在，则抛出异常。）
                        </p><pre class="oac_no_warn" dir="ltr">StringBuilder查询; StringBuilder描述; //使用查询文本和数据库中的描述填充这些查询= new StringBuilder（）; description = new StringBuilder（）; //从数据库中获取查询try {SGDBHandler.getSparqlQuery（connection，queryId，query，description）; } catch（SQLException sqle）{//句柄异常//注意：如果不存在具有指定ID的查询，则抛出异常} //应立即填充查询和描述//修改查询字符串updatedQuery = query.toString（） .replaceAll（“邀请”，“与会者”）; //将查询重新插入数据库boolean ignoreDup = false; try {//首先必须删除旧查询SGDBHandler.deleteSparqlQuery（connection，queryId）; //现在我们可以添加SGDBHandler.insertSparqlQuery（connection，queryId，updatedQuery，description.toString（），ignoreDup）; } catch（SQLException sqle）{//句柄异常} catch（QueryException qe）{//处理查询语法异常}</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-62BFFBF3-55E2-42A1-977D-576DB3A55431__BGBDCGFC">
                        <p class="titleinexample">示例6-35检索和打印XSL转换</p>
                        <p><a href="rdf-suipport-for-apache-jena.html#GUID-62BFFBF3-55E2-42A1-977D-576DB3A55431__BGBDCGFC">例6-35</a>检索现有的XSL转换并将其打印到标准输出。（请注意，如果转换不存在，则抛出异常。）
                        </p><pre class="oac_no_warn" dir="ltr">StringBuilder xslt; StringBuilder描述; //使用数据库中的XSLT文本和描述填充它们xslt = new StringBuilder（）; description = new StringBuilder（）;试试{SGDBHandler.getXslt（connection，xsltId，xslt，description）; } catch（SQLException sqle）{//句柄异常//注意：如果不存在具有指定ID的转换，则抛出异常} //将其打印到标准输出System.out.printf（“XSLT description：％s \ n”， description.toString（））; System.out.printf（“XSLT body：\ n％s \ n”，xslt.toString（））;</pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-649269C9-6EB8-489C-B139-073CB8BA768E" title="SPARQL Gateway是一个J2EE Web应用程序，包含在Apache Jena的支持中。它旨在使语义数据（RDF / OWL / SKOS）易于用于运行关系和XML数据的应用程序，包括Oracle商业智能企业版（OBIEE）11g。">SPARQL网关和语义数据</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="RDFRM503"></a><div class="props_rev_3"><a id="GUID-81166E14-3CA8-45A7-A15B-EBDD11497AB6" name="GUID-81166E14-3CA8-45A7-A15B-EBDD11497AB6"></a><h4 id="RDFRM-GUID-81166E14-3CA8-45A7-A15B-EBDD11497AB6" class="sect4"><span class="enumeration_section">6.19.6</span>使用SPARQL Gateway图形Web界面</h4>
                  <div>
                     <p>SPARQL Gateway提供了几个基于浏览器的界面，可帮助您测试查询，导航语义数据以及管理SPQARQL查询和XSLT文件。</p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-D63AD358-38E1-4454-B0AE-45EE258F0AEB">主页（index.html）</a><br></li>
                        <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-8F019E81-641B-4E97-ABC0-4E403FD7F408">导航和浏览页面（browse.jsp）</a><br></li>
                        <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-2F97F4B1-0E02-4EE2-A8EA-9FF113B4E26A">XSLT管理页面（xslt.jsp）</a><br></li>
                        <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-CC661535-E62C-493A-A4A7-3AA0F008E6CE">SPARQL管理页面（sparql.jsp）</a><br></li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-649269C9-6EB8-489C-B139-073CB8BA768E" title="SPARQL Gateway是一个J2EE Web应用程序，包含在Apache Jena的支持中。它旨在使语义数据（RDF / OWL / SKOS）易于用于运行关系和XML数据的应用程序，包括Oracle商业智能企业版（OBIEE）11g。">SPARQL网关和语义数据</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="RDFRM505"></a><a id="RDFRM506"></a><a id="RDFRM504"></a><div class="props_rev_3"><a id="GUID-D63AD358-38E1-4454-B0AE-45EE258F0AEB" name="GUID-D63AD358-38E1-4454-B0AE-45EE258F0AEB"></a><h5 id="RDFRM-GUID-D63AD358-38E1-4454-B0AE-45EE258F0AEB" class="sect5"><span class="enumeration_section">6.19.6.1</span>主页面（index.html）</h5>
                     <div>
                        <p><code class="codeph">http://</code> <span class="italic"><code class="codeph">&lt;host&gt;:&lt;port&gt;</code></span> <code class="codeph">/sparqlgateway/index.html</code>提供了一个简单的接口，用于执行SPARQL查询，然后将default.xslt文件中的转换应用于响应。<a href="rdf-suipport-for-apache-jena.html#GUID-D63AD358-38E1-4454-B0AE-45EE258F0AEB__BGBHAFBF">图6-2</a>显示了用于执行查询的此接口。
                        </p>
                        <div class="figure" id="GUID-D63AD358-38E1-4454-B0AE-45EE258F0AEB__BGBHAFBF">
                           <p class="titleinfigure">图6-2图形界面主页（index.html）</p><img src="img/spgateway_index_11.jpg" width="615" alt="下面是图6-2的描述" title="下面是图6-2的描述" longdesc="img_text/spgateway_index_11.html"><br><a href="img_text/spgateway_index_11.html">“图6-2图形界面主页（index.html）”的说明</a></div>
                        <!-- class="figure" -->
                        <p>输入或选择<span class="bold">SPARQL端点</span> ，指定<span class="bold">SPARQL SELECT Query Body，</span>然后按<span class="bold">Submit Query</span> 。
                        </p>
                        <p>例如，如果将<code class="codeph">http://dbpedia.org/sparql</code>指定为SPARQL端点并使用<a href="rdf-suipport-for-apache-jena.html#GUID-D63AD358-38E1-4454-B0AE-45EE258F0AEB__BGBHAFBF">图6-2中</a>的SPARQL查询主体，则响应将类似于<a href="rdf-suipport-for-apache-jena.html#GUID-D63AD358-38E1-4454-B0AE-45EE258F0AEB__BGBDHAAF">图6-3</a> 。请注意，默认转换（在<code class="codeph">default.xslt</code> ）已应用于此图中的XML输出。
                        </p>
                        <div class="figure" id="GUID-D63AD358-38E1-4454-B0AE-45EE258F0AEB__BGBDHAAF">
                           <p class="titleinfigure">图6-3 SPARQL查询主页响应</p><img src="img/spgateway_index_21.jpg" width="615" alt="下面是图6-3的描述" title="下面是图6-3的描述" longdesc="img_text/spgateway_index_21.html"><br><a href="img_text/spgateway_index_21.html">“图6-3 SPARQL查询主页响应”的说明</a></div>
                        <!-- class="figure" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-81166E14-3CA8-45A7-A15B-EBDD11497AB6">使用SPARQL Gateway图形Web界面</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="RDFRM508"></a><a id="RDFRM509"></a><a id="RDFRM510"></a><a id="RDFRM507"></a><div class="props_rev_3"><a id="GUID-8F019E81-641B-4E97-ABC0-4E403FD7F408" name="GUID-8F019E81-641B-4E97-ABC0-4E403FD7F408"></a><h5 id="RDFRM-GUID-8F019E81-641B-4E97-ABC0-4E403FD7F408" class="sect5"><span class="enumeration_section">6.19.6.2</span>导航和浏览页面（browse.jsp）</h5>
                     <div>
                        <p><code class="codeph">http://&lt;host&gt;:&lt;port&gt;/sparqlgateway/browse.jsp</code>提供语义数据的导航和浏览功能。它适用于任何符合标准的SPARQL端点。<a href="rdf-suipport-for-apache-jena.html#GUID-8F019E81-641B-4E97-ABC0-4E403FD7F408__BGBBDEBF">图6-4</a>显示了用于执行查询的此接口。
                        </p>
                        <div class="figure" id="GUID-8F019E81-641B-4E97-ABC0-4E403FD7F408__BGBBDEBF">
                           <p class="titleinfigure">图6-4图形界面导航和浏览页面（browse.jsp）</p><img width="543" src="img/spgateway_browse_11.jpg" alt="下面是图6-4的描述" title="下面是图6-4的描述" longdesc="img_text/spgateway_browse_11.html"><br><a href="img_text/spgateway_browse_11.html">“图6-4图形界面导航和浏览页面（browse.jsp）”的说明</a></div>
                        <!-- class="figure" -->
                        <p>输入或选择<span class="bold">SPARQL端点</span> ，指定<span class="bold">SPARQL SELECT Query Body，</span>可选择指定<span class="bold">Timeout（ms）</span>值（以毫秒为单位）和<span class="bold">Best Effort</span>选项，然后按<span class="bold">Submit Query</span> 。
                        </p>
                        <p>解析SPARQL响应，然后以表格形式呈现， <a href="rdf-suipport-for-apache-jena.html#GUID-8F019E81-641B-4E97-ABC0-4E403FD7F408__BGBIHACE">如图6-5</a>所示。
                        </p>
                        <div class="figure" id="GUID-8F019E81-641B-4E97-ABC0-4E403FD7F408__BGBIHACE">
                           <p class="titleinfigure">图6-5浏览和导航页面：响应</p><img width="595" src="img/spgateway_browse_1a1.jpg" alt="下面是图6-5的描述" title="下面是图6-5的描述" longdesc="img_text/spgateway_browse_1a1.html"><br><a href="img_text/spgateway_browse_1a1.html">“图6-5浏览和导航页面：响应”的描述</a></div>
                        <!-- class="figure" -->
                        <p>在<a href="rdf-suipport-for-apache-jena.html#GUID-8F019E81-641B-4E97-ABC0-4E403FD7F408__BGBIHACE">图6-5中</a> ，请注意URI可以单击以允许导航，并且当用户将光标移动到URI上时，会显示针对URI的工具提示，这些URI已被缩短以便于阅读（如<code class="codeph">http://purl.org.dc/elements/1.1/title</code>显示为图中<code class="codeph">dc:title</code>的工具提示。
                        </p>
                        <p>如果在<a href="rdf-suipport-for-apache-jena.html#GUID-8F019E81-641B-4E97-ABC0-4E403FD7F408__BGBIHACE">图6-5中</a>显示的输出中单击URI <code class="codeph">http://example.org/book/book5</code> ，则会自动生成并执行新的SPARQL查询。生成的SPARQL查询有三种查询模式，使用此特定URI作为主题，谓词和对象， <a href="rdf-suipport-for-apache-jena.html#GUID-8F019E81-641B-4E97-ABC0-4E403FD7F408__BGBCHGIF">如图6-6</a>所示。这样的查询可以让您了解如何使用此URI以及它与数据集中其他资源的关联方式。
                        </p>
                        <div class="figure" id="GUID-8F019E81-641B-4E97-ABC0-4E403FD7F408__BGBCHGIF">
                           <p class="titleinfigure">图6-6单击URI链接的查询和响应</p><img width="578" src="img/spgateway_browse_31.jpg" alt="下面是图6-6的描述" title="下面是图6-6的描述" longdesc="img_text/spgateway_browse_31.html"><br><a href="img_text/spgateway_browse_31.html">“图6-6点击URI链接的查询和响应”的描述</a></div>
                        <!-- class="figure" -->
                        <p><a id="d44532e9631" class="indexterm-anchor"></a>如果查询有多个匹配项，则结果将按页面组织，您可以单击任何页面。默认情况下，页面大小为50个结果。要在浏览和导航页面（ <code class="codeph">browse.jsp</code> ）的响应中显示更多（或更少）每页50行，您可以在URL中指定<code class="codeph">&amp;resultsPerPage</code>参数。例如，要允许每页100行，请在URL中包含以下内容：</p><pre class="oac_no_warn" dir="ltr">＆resultsPerPage = 100</pre></div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-81166E14-3CA8-45A7-A15B-EBDD11497AB6">使用SPARQL Gateway图形Web界面</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="RDFRM512"></a><a id="RDFRM511"></a><div class="props_rev_3"><a id="GUID-2F97F4B1-0E02-4EE2-A8EA-9FF113B4E26A" name="GUID-2F97F4B1-0E02-4EE2-A8EA-9FF113B4E26A"></a><h5 id="RDFRM-GUID-2F97F4B1-0E02-4EE2-A8EA-9FF113B4E26A" class="sect5"><span class="enumeration_section">6.19.6.3</span> XSLT管理页面（xslt.jsp）</h5>
                     <div>
                        <p><code class="codeph">http://</code> <span class="italic"><code class="codeph">&lt;host&gt;:&lt;port&gt;</code></span> <code class="codeph">/sparqlgateway/admin/xslt.jsp</code>提供了一个简单的XSLT管理界面。您可以输入XSLT ID（整数）并单击<span class="bold">Get XSLT</span>以检索Description和XSLT Body。您可以修改XSLT Body文本，然后单击<span class="bold">Save XSLT</span>保存更改。请注意，有一个预览器可帮助您在可用的XSLT定义中导航。
                        </p>
                        <p>XSLT管理页面<a href="rdf-suipport-for-apache-jena.html#GUID-2F97F4B1-0E02-4EE2-A8EA-9FF113B4E26A__BGBFJFEA">如图6-7</a>所示。
                        </p>
                        <div class="figure" id="GUID-2F97F4B1-0E02-4EE2-A8EA-9FF113B4E26A__BGBFJFEA">
                           <p class="titleinfigure">图6-7 XSLT管理页面</p><img src="img/spgateway_xslt1.jpg" width="615" alt="下面是图6-7的描述" title="下面是图6-7的描述" longdesc="img_text/spgateway_xslt1.html"><br><a href="img_text/spgateway_xslt1.html">“图6-7 XSLT管理页面”的描述</a></div>
                        <!-- class="figure" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-81166E14-3CA8-45A7-A15B-EBDD11497AB6">使用SPARQL Gateway图形Web界面</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="RDFRM514"></a><a id="RDFRM513"></a><div class="props_rev_3"><a id="GUID-CC661535-E62C-493A-A4A7-3AA0F008E6CE" name="GUID-CC661535-E62C-493A-A4A7-3AA0F008E6CE"></a><h5 id="RDFRM-GUID-CC661535-E62C-493A-A4A7-3AA0F008E6CE" class="sect5"><span class="enumeration_section">6.19.6.4</span> SPARQL管理页面（sparql.jsp）</h5>
                     <div>
                        <p><code class="codeph">http://</code> <span class="italic"><code class="codeph">&lt;host&gt;:&lt;port&gt;</code></span> <code class="codeph">/sparqlgateway/admin/xslt.jsp</code>提供了一个简单的SPARQL管理界面。您可以输入SPARQL ID（整数）并单击<span class="bold">Get SPARQL</span>以检索Description和SPARQL Body。您可以修改SPARQL正文文本，然后单击“ <span class="bold">保存SPARQL”</span>保存更改。请注意，有一个预览器可帮助您在可用的SPARQL查询中导航。
                        </p>
                        <p>SPARQL管理页面<a href="rdf-suipport-for-apache-jena.html#GUID-CC661535-E62C-493A-A4A7-3AA0F008E6CE__BGBHIJEB">如图6-8</a>所示。
                        </p>
                        <div class="figure" id="GUID-CC661535-E62C-493A-A4A7-3AA0F008E6CE__BGBHIJEB">
                           <p class="titleinfigure">图6-8 SPARQL管理页面</p><img src="img/spgateway_sparql_mgmt1.jpg" width="615" alt="下面是图6-8的描述" title="下面是图6-8的描述" longdesc="img_text/spgateway_sparql_mgmt1.html"><br><a href="img_text/spgateway_sparql_mgmt1.html">“图6-8 SPARQL管理页面”的说明</a></div>
                        <!-- class="figure" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-81166E14-3CA8-45A7-A15B-EBDD11497AB6">使用SPARQL Gateway图形Web界面</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div><a id="RDFRM516"></a><a id="RDFRM517"></a><a id="RDFRM518"></a><a id="RDFRM515"></a><div class="props_rev_3"><a id="GUID-66E24387-35FA-4F55-9E93-88F4570C6A54" name="GUID-66E24387-35FA-4F55-9E93-88F4570C6A54"></a><h4 id="RDFRM-GUID-66E24387-35FA-4F55-9E93-88F4570C6A54" class="sect4"><span class="enumeration_section">6.19.7</span>使用SPARQL Gateway作为OBIEE的XML数据源</h4>
                  <div>
                     <div class="section">
                        <p>本节介绍如何使用SPARQL Gateway作为桥接器将OBIEE与RDF集成，从而为Oracle业务智能企业版（OBIEE）创建XML数据源。（具体步骤和插图反映了Oracle BI管理工具版本11.1.1.3.0.100806.0408.000。）</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>启动Oracle BI管理工具。</span></li>
                        <li class="stepexpand"><span>单击<span class="bold">文件</span> ，然后单击<span class="bold">导入元数据</span> 。将显示“导入元数据”向导的第一页， <a href="rdf-suipport-for-apache-jena.html#GUID-66E24387-35FA-4F55-9E93-88F4570C6A54__BGBDEFCG">如图6-9</a>所示。</span><div>
                              <div class="figure" id="GUID-66E24387-35FA-4F55-9E93-88F4570C6A54__BGBDEFCG">
                                 <p class="titleinfigure">图6-9导入元数据 - 选择数据源</p><img width="615" src="img/obiee_impmeta_datasource1.jpg" alt="下面是图6-9的描述" title="下面是图6-9的描述" longdesc="img_text/obiee_impmeta_datasource1.html"><br><a href="img_text/obiee_impmeta_datasource1.html">“图6-9导入元数据 - 选择数据源”的说明</a></div>
                              <!-- class="figure" -->
                              <p><span class="bold">连接类型</span> ：选择<code class="codeph">XML</code> 。</p>
                              <p><span class="bold">URL</span> ：应用程序与SPARQL Gateway交互的URL，如<a href="rdf-suipport-for-apache-jena.html#GUID-5C5AD7B1-7601-431D-9026-2AACDC6A48DE">使用带语义数据的SPARQL网关中所述</a> 。您还可以包括超时和尽力而为选项。
                              </p>
                              <p>忽略<span class="bold">用户名</span>和<span class="bold">密码</span>字段。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>单击<span class="bold">下一步</span> 。将显示“导入元数据”向导的第二页， <a href="rdf-suipport-for-apache-jena.html#GUID-66E24387-35FA-4F55-9E93-88F4570C6A54__BGBCCHFH">如图6-10</a>所示。</span><div>
                              <div class="figure" id="GUID-66E24387-35FA-4F55-9E93-88F4570C6A54__BGBCCHFH">
                                 <p class="titleinfigure">图6-10导入元数据 - 选择元数据类型</p><img width="615" src="img/obiee_impmeta_metatypes1.jpg" alt="下面是图6-10的描述" title="下面是图6-10的描述" longdesc="img_text/obiee_impmeta_metatypes1.html"><br><a href="img_text/obiee_impmeta_metatypes1.html">“图6-10导入元数据 - 选择元数据类型”的描述</a></div>
                              <!-- class="figure" -->
                              <p>选择要导入的所需元数据类型。确保所选类型中包含<span class="bold">表</span> 。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>单击<span class="bold">下一步</span> 。将显示“导入元数据”向导的第三页， <a href="rdf-suipport-for-apache-jena.html#GUID-66E24387-35FA-4F55-9E93-88F4570C6A54__BGBHEEIG">如图6-11</a>所示。</span><div>
                              <div class="figure" id="GUID-66E24387-35FA-4F55-9E93-88F4570C6A54__BGBHEEIG">
                                 <p class="titleinfigure">图6-11导入元数据 - 选择元数据对象</p><img width="615" src="img/obiee_impmeta_metaobjects1.jpg" alt="下面是图6-11的描述" title="下面是图6-11的描述" longdesc="img_text/obiee_impmeta_metaobjects1.html"><br><a href="img_text/obiee_impmeta_metaobjects1.html">“图6-11导入元数据 - 选择元数据对象”的说明</a></div>
                              <!-- class="figure" -->
                              <p>在“ <span class="bold">数据源视图”中</span> ，展开具有表图标的节点，选择列名称（从SPARQL SELECT语句中定义的投影变量映射），然后单击右箭头（ <span class="bold">&gt;</span> ）按钮将所选列移动到<span class="bold">存储库查看</span> 。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>单击<span class="bold">完成</span> 。</span></li>
                        <li class="stepexpand"><span>完成常规BI业务模型工作和映射和表示定义工作的其余步骤，这些步骤并非特定于SPARQL网关或RDF数据。</span></li>
                     </ol>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-649269C9-6EB8-489C-B139-073CB8BA768E" title="SPARQL Gateway是一个J2EE Web应用程序，包含在Apache Jena的支持中。它旨在使语义数据（RDF / OWL / SKOS）易于用于运行关系和XML数据的应用程序，包括Oracle商业智能企业版（OBIEE）11g。">SPARQL网关和语义数据</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="RDFRM743"></a><div class="props_rev_3"><a id="GUID-2F00FBFD-B3F4-4E49-9476-25E5F364A9D7" name="GUID-2F00FBFD-B3F4-4E49-9476-25E5F364A9D7"></a><h3 id="RDFRM-GUID-2F00FBFD-B3F4-4E49-9476-25E5F364A9D7" class="sect3"><span class="enumeration_section">6.20</span>在Apache Tomcat或JBoss中部署Joseki</h3>
               <div>
                  <p>如果您选择不在Oracle WebLogic Server中部署Joseki，则可以将其部署在Apache Tomcat或JBoss中。</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-38F73B74-30F0-44D6-B933-8F12E473FAB5">在Apache Tomcat 6.0.29或7.0.42中部署Joseki</a><br></li>
                     <li class="ulchildlink"><a href="rdf-suipport-for-apache-jena.html#GUID-A18AD59B-10B6-41E3-8791-EF9A8DE4A1F6">在JBoss 7.1.1中部署Joseki</a><br></li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-3F437E3E-3B74-4CCF-9F16-B2B07B3899E8" title="Apache Jena的RDF语义图支持（这里也称为对Apache Jena的支持）通过实现着名的Jena Graph，Model和DatasetGraph API为Oracle Spatial和Graph RDF语义图提供了基于Java的接口。">Apache Jena的RDF语义图支持</a></p>
                     </div>
                  </div>
               </div>
               <a id="RDFRM744"></a><div class="props_rev_3"><a id="GUID-38F73B74-30F0-44D6-B933-8F12E473FAB5" name="GUID-38F73B74-30F0-44D6-B933-8F12E473FAB5"></a><h4 id="RDFRM-GUID-38F73B74-30F0-44D6-B933-8F12E473FAB5" class="sect4"><span class="enumeration_section">6.20.1</span>部署在定式的Apache Tomcat 6.0.29或7.0.42</h4>
                  <div>
                     <div class="section">
                        <p>要在Apache Tomcat 6.0.29或7.0.42中部署Joseki，请按照下列步骤操作。</p>
                        <ol>
                           <li>
                              <p>下载并安装Apache Tomcat 6.0.29或7.0.42。</p>
                              <p>Apache Tomcat安装的目录根将在这些说明中称为$ CATALINA_HOME。</p>
                           </li>
                           <li>
                              <p>使用以下示例设置环境变量：</p><pre class="oac_no_warn" dir="ltr">setenv JAVA_HOME &lt; <span class="italic">your_path_here&gt;</span> / jdk16 / setenv PATH <span class="italic">&lt;your_path_here&gt;</span> / jdk16 / bin /：$ PATH setenv CATALINA_HOME <span class="italic">&lt;your_path_here&gt;</span> /apache-tomcat-6.0.29 <span class="italic"><span class="bold">OR</span></span> setenv CATALINA_HOME <span class="italic">&lt;your_path_here&gt;</span> /apache-tomcat-7.0.42</pre></li>
                           <li>
                              <p>将<code class="codeph">ojdbc6.jar</code>复制到<code class="codeph">${CATALINA_HOME}/lib</code> 。
                              </p>
                           </li>
                           <li>
                              <p>修改<code class="codeph">tomcat-users.xml</code> ，使其包含以下内容：</p><pre class="oac_no_warn" dir="ltr">&lt;tomcat-users&gt; &lt;role rolename =“tomcat”/&gt; &lt;role rolename =“role1”/&gt; &lt;user username =“tomcat”password =“ <span class="italic">&lt;tomcat-password&gt;</span> ”roles =“tomcat，manager”/&gt; &lt;user username =“both”password =“ <span class="italic">&lt;tomcat-password&gt;</span> ”roles =“tomcat，role1”/&gt; &lt;user username =“role1”password =“ <span class="italic">&lt;tomcat-password&gt;</span> ”roles =“role1”/&gt; &lt;/ tomcat-用户&gt;</pre><p>但是，如果您使用的是Apache Tomcat V7.0.42，请在前面的代码中将roles =“tomcat，manager”替换为roles =“tomcat， <span class="bold">manager-gui</span> ”。
                              </p>
                           </li>
                           <li>
                              <p>启动Tomcat：</p><pre class="oac_no_warn" dir="ltr">$ CATALINA_HOME / bin中/ startup.sh</pre><p>如果此文件没有可执行权限，请输入以下命令，然后再次尝试启动Tomcat：</p><pre class="oac_no_warn" dir="ltr">chmod u + x $ CATALINA_HOME / bin / startup.sh</pre></li>
                           <li>
                              <p>在浏览器中转到： <code class="codeph">http://hostname:8080/manager/html</code></p>
                              <p>如果需要身份验证，请为该用户输入<code class="codeph">tomcat</code> ，然后输入Tomcat密码。
                              </p>
                           </li>
                           <li>
                              <p>在Tomcat部署Joseki。</p>
                              <ol type="a">
                                 <li>
                                    <p>在Tomcat Manager页面（ <code class="codeph">http://</code> <span class="italic"><code class="codeph">hostname</code></span> ： <code class="codeph">8080/manager/html</code> ）中，选择<code class="codeph">Deploy directory or WAR file located on server</code> 。
                                    </p>
                                 </li>
                                 <li>
                                    <p>对于<span class="bold">Context Path</span> ，请输入： <span class="bold">/ joseki</span> 
                                    </p>
                                 </li>
                                 <li>
                                    <p>对于<span class="bold">WAR或Directory UR</span> L，输入<code class="codeph">joseki.war</code>的路径，例如： <code class="codeph">/tmp/jena_adapter/joseki_web_app/joseki.war</code> 
                                    </p>
                                 </li>
                                 <li>
                                    <p>单击“ <span class="bold">部署”</span> 。
                                    </p>
                                 </li>
                              </ol>
                              <p>在<code class="codeph">apache-tomcat-6.0.29/webapps</code>或<code class="codeph">apache-tomcat-7.0.42/webapps</code>下创建了一个名为<code class="codeph">joseki</code>的目录。该目录将被称为JOSEKI_HOME。</p>
                           </li>
                           <li>
                              <p>通过以下方式验证Joseki是否已正确安装：</p><pre class="oac_no_warn" dir="ltr">http：// <span class="italic">&lt;主机名&gt;</span> ：8080 / joseki</pre></li>
                           <li>
                              <p>创建名为<span class="italic">OracleSemDS</span>的J2EE数据源。</p>
                              <p>在数据源创建期间，您可以为数据库模式指定用户和密码，该模式包含要执行SPARQL查询的相关语义数据。要在Tomcat中创建数据源，请进行以下更改：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>在全局<code class="codeph">$CATALINA_HOME/conf/server.xml</code>文件中，在GlobalNamingResources中添加以下资源（在需要时自定义）：</p><pre class="oac_no_warn" dir="ltr">&lt;Resource name =“OracleSemDS”auth =“Container”type =“oracle.jdbc.pool。OracleDataSource“driverClassName =”oracle.jdbc。OracleDriver“factory =”oracle.jdbc.pool。OracleDataSourceFactory“url =”jdbc：oracle：thin：@hostname：port：sid“user =”username“password =”password“maxActive =”30“maxIdle =”10“maxWait =” -  1“/&gt;</pre></li>
                                 <li>
                                    <p>在全局<code class="codeph">$CATALINA_HOME/conf/context.xml</code>文件中，添加以下链接：</p><pre class="oac_no_warn" dir="ltr">&lt;ResourceLink global =“OracleSemDS”name =“OracleSemDS”type =“oracle.jdbc.pool。OracleDataSource“/&gt;</pre></li>
                              </ul>
                              <p>有关设置数据源的更多信息，请参阅Tomcat文档。</p>
                           </li>
                           <li>
                              <p>关闭并重新启动Tomcat：</p><pre class="oac_no_warn" dir="ltr">$ CATALINA_HOME / bin / shutdown.sh $ CATALINA_HOME / bin / startup.sh</pre></li>
                           <li>
                              <p>通过转到（假设Web应用程序部署在端口8080）来验证您的部署：</p><pre class="oac_no_warn" dir="ltr">http：// <span class="italic">&lt;主机名&gt;</span> ：8080 / joseki / querymgt？abortqid = 0</pre><p>您应该看到一个XML响应，它表明Joseki的成功部署以及对Apache Jena查询管理servlet的RDF语义图支持。</p>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-2F00FBFD-B3F4-4E49-9476-25E5F364A9D7" title="如果您选择不在Oracle WebLogic Server中部署Joseki，则可以将其部署在Apache Tomcat或JBoss中。">在Apache Tomcat或JBoss中部署Joseki</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="RDFRM745"></a><div class="props_rev_3"><a id="GUID-A18AD59B-10B6-41E3-8791-EF9A8DE4A1F6" name="GUID-A18AD59B-10B6-41E3-8791-EF9A8DE4A1F6"></a><h4 id="RDFRM-GUID-A18AD59B-10B6-41E3-8791-EF9A8DE4A1F6" class="sect4"><span class="enumeration_section">6.20.2</span>在JBoss 7.1.1中部署Joseki</h4>
                  <div>
                     <div class="section">
                        <p>要在JBoss 7.1.1中部署Joseki，请按照下列步骤操作。（这些步骤也已针对红帽JBoss企业应用平台6.1.0进行了测试，并根据需要进行了修改。）</p>
                        <ol>
                           <li>
                              <p>下载并安装JBoss Application Server 7.1.1。</p>
                              <p>这些指令假定<code class="codeph">jboss-as-7.1.1.Final/</code>是JBoss安装的顶级目录。
                              </p>
                           </li>
                           <li>
                              <p>安装JDBC驱动程序：</p><pre class="oac_no_warn" dir="ltr">创建目录jboss-as-7.1.1。最终/模块/ ORACLE / JDBC /主/</pre></li>
                           <li>
                              <p>将<code class="codeph">ojdbc6.jar</code>复制到此目录中</p>
                           </li>
                           <li>
                              <p>使用以下内容在此目录中创建<code class="codeph">module.xml</code> ：</p><pre class="oac_no_warn" dir="ltr">&lt;？xml version =“1.0”encoding =“UTF-8”？&gt; &lt;module xmlns =“urn：jboss：module：1.0”name =“oracle.jdbc”&gt; &lt;resources&gt; &lt;resource-root path =“ojdbc6.jar”/&gt; &lt;/ resources&gt; &lt;dependencies&gt; &lt;module name =“ javax.api“/&gt; &lt;module name =”javax.transaction.api“/&gt; &lt;/ dependencies&gt; &lt;/ module&gt;</pre></li>
                           <li>
                              <p>修改<code class="codeph">jboss-as-7.1.1.Final/standalone/configuration/standalone.xml</code>通过添加以下行：</p><pre class="oac_no_warn" dir="ltr">&lt;driver name =“OracleJDBCDriver”module =“oracle.jdbc”/&gt;</pre><p>修改后的<code class="codeph">standalone.xml</code>文件应包含以下内容：</p><pre class="oac_no_warn" dir="ltr">...&lt;drivers&gt; &lt;driver name =“OracleJDBCDriver”module =“oracle.jdbc”/&gt; &lt;driver name =“h2”module =“com.h2database.h2”&gt; &lt;xa-datasource-class&gt; org.h2.jdbcx。JdbcDataSource &lt;/ xa-datasource-class&gt; &lt;/ driver&gt; &lt;/ drivers&gt; ...
</pre></li>
                           <li>
                              <p>创建必要的数据源。</p>
                              <ol type="a">
                                 <li>
                                    <p>登录JBoss AS管理控制台：</p><pre class="oac_no_warn" dir="ltr">http：// <span class="italic">&lt;主机名&gt;</span> ：9990 / console / App.html＃server-overview</pre></li>
                                 <li>
                                    <p>单击“ <span class="bold">数据源”</span> 。
                                    </p>
                                 </li>
                                 <li>
                                    <p>点击<span class="bold">个人资料</span>
                                    </p>
                                 </li>
                                 <li>
                                    <p>单击“ <span class="bold">添加”</span> ，然后输入以下内容：</p>
                                    <p><span class="bold">名称</span> ： <code class="codeph">OracleSemDS</code></p>
                                    <p><span class="bold">JNDI名称</span> ： <code class="codeph">java:jboss/datasources/OracleSemDS</code></p>
                                 </li>
                                 <li>
                                    <p>选择<span class="bold">OracleJDBCDriver</span> 。
                                    </p>
                                 </li>
                                 <li>
                                    <p>单击<span class="bold">下一步</span> 。
                                    </p>
                                    <p>显示以下信息：</p><pre class="oac_no_warn" dir="ltr">连接URL：jdbc：oracle：thin：@hostname：port：sid注意：自定义用户名：scott注意：自定义密码：tiger注意：自定义安全域:(留空）</pre></li>
                                 <li>
                                    <p>根据需要自定义信息并将“安全域”留空，然后单击<span class="bold">“完成”</span> 。
                                    </p>
                                 </li>
                              </ol>
                           </li>
                           <li>
                              <p>突出显示此新数据源，单击“ <span class="bold">启用”</span> ，然后单击“ <span class="bold">确认”</span> 。
                              </p>
                           </li>
                           <li>
                              <p>使用JBoss管理控制台部署<code class="codeph">joseki.war</code>文件。
                              </p>
                              <ol type="a">
                                 <li>
                                    <p>转到以下页面：</p><pre class="oac_no_warn" dir="ltr">HTTP：// &lt;主机名&gt;：9990 /控制台/ App.html＃部署</pre></li>
                                 <li>
                                    <p>单击“ <span class="bold">部署”</span> 。
                                    </p>
                                 </li>
                                 <li>
                                    <p>单击“ <span class="bold">管理部署”</span> 。
                                    </p>
                                 </li>
                                 <li>
                                    <p>单击“ <span class="bold">添加”</span>并指定<code class="codeph">joseki.war</code>文件。
                                    </p>
                                 </li>
                              </ol>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="rdf-suipport-for-apache-jena.html#GUID-2F00FBFD-B3F4-4E49-9476-25E5F364A9D7" title="如果您选择不在Oracle WebLogic Server中部署Joseki，则可以将其部署在Apache Tomcat或JBoss中。">在Apache Tomcat或JBoss中部署Joseki</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
         </div>
      </article>
   </body>
</html>