<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>Oracle RAC故障排除</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Real Application Clusters Administration and Deployment Guide"></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Real Application Clusters Administration and Deployment Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="real-application-clusters-administration-and-deployment-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-04-25T14:02:30-07:00"></meta>
      <meta name="dcterms.title" content="Real Application Clusters Administration and Deployment Guide"></meta>
      <meta name="dcterms.dateCopyrighted" content="1999, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E95728-03"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="server-control-utility-reference.html" title="Previous" type="text/html"></link>
      <link rel="next" href="glossary.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="RACAD"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="server-control-utility-reference.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="glossary.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Real Application Clusters管理和部署指南</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Oracle RAC故障排除</li>
            </ol>
            <a id="GUID-F23CDEC1-ECA1-4963-8D31-2E8F0857EE24" name="GUID-F23CDEC1-ECA1-4963-8D31-2E8F0857EE24"></a><a id="RACAD025"></a>
            
            <h2 id="RACAD-GUID-F23CDEC1-ECA1-4963-8D31-2E8F0857EE24" class="sect2"><span class="enumeration_appendix">B</span> Oracle RAC故障排除</h2>
         </header>
         <div class="ind">
            <div>
               <p>本附录解释了如何<a id="d101556e139" class="indexterm-anchor"></a><a id="d101556e143" class="indexterm-anchor"></a>使用跟踪和日志文件诊断Oracle Real Application Clusters（Oracle RAC）组件的问题。本节包括以下主题：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="troubleshooting-oracle-rac.html#GUID-EC8F3486-98CC-4350-B5F8-8BEFB5607EA5">在何处查找用于分析错误的文件</a></p>
                  </li>
                  <li>
                     <p><a href="troubleshooting-oracle-rac.html#GUID-89F3158D-8383-4EAF-9B15-95EC9E828462" title="跨越Oracle RAC实例的问题可能是最难诊断的问题类型。">管理Oracle RAC中的诊断数据</a></p>
                  </li>
                  <li>
                     <p><a href="troubleshooting-oracle-rac.html#GUID-6E1B17DD-C6B0-4B2B-96CF-F0FF35FA5544">在Oracle RAC中使用特定于实例的警报文件</a></p>
                  </li>
                  <li>
                     <p><a href="troubleshooting-oracle-rac.html#GUID-1FDCAB67-46C2-4F21-A1EA-B833C624A6EF" title="通过执行与工具或实用程序同名的脚本来调用Oracle RAC中可用的所有基于Java的工具和实用程序。">在Oracle RAC中启用对基于Java的工具和实用程序的跟踪</a></p>
                  </li>
                  <li>
                     <p><a href="troubleshooting-oracle-rac.html#GUID-564C9A02-A143-4537-BCAA-E0CCB7D4A55F">解决待决关机问题</a></p>
                  </li>
                  <li>
                     <p><a href="troubleshooting-oracle-rac.html#GUID-A66CDC09-8AB1-4022-80FC-F7A618C8B4ED">如何确定Oracle RAC实例是否正在使用专用网络</a></p>
                  </li>
               </ul>
               <div class="infoboxnote" id="GUID-F23CDEC1-ECA1-4963-8D31-2E8F0857EE24__GUID-58DE7D0D-4DCC-45A6-B51C-A5D7F8D7DF49">
                  <p class="notep1">注意：</p>
                  <p>跟踪和日志文件类似于为Oracle数据库与Oracle RAC生成的跟踪和日志文件，也可用于Oracle Clusterware组件。对于Oracle Clusterware，Oracle数据库将这些存储在统一的目录日志结构中。</p>
                  <p>有关对<a href="../cwadd/troubleshooting-oracle-clusterware.html#CWADD025" target="_blank"><span class="italic">Oracle Clusterware</span></a>进行故障排除的详细信息，请参阅“ <a href="../cwadd/troubleshooting-oracle-clusterware.html#CWADD025" target="_blank"><span class="italic">Oracle Clusterware管理和部署指南”</span></a> 。
                  </p>
               </div>
            </div><a id="RACAD512"></a><div class="sect2"><a id="GUID-EC8F3486-98CC-4350-B5F8-8BEFB5607EA5" name="GUID-EC8F3486-98CC-4350-B5F8-8BEFB5607EA5"></a><h3 id="RACAD-GUID-EC8F3486-98CC-4350-B5F8-8BEFB5607EA5" class="sect3">在何处查找用于分析错误的文件</h3>
               <div>
                  <p>Oracle数据库在跟踪文件中记录有关Oracle RAC环境中发生的重要事件的信息。Oracle RAC的跟踪文件与非群集Oracle数据库中的跟踪文件相同。作为最佳实践，请定期监视和备份所有实例的跟踪文件，以保留其内容以供将来进行故障排除。</p>
                  <p>有关<code class="codeph">ORA-600</code>错误的信息显示在<code class="codeph">alert_ <span class="variable" translate="no">SID</span> .log</code>文件中，其中<code class="codeph"><span class="variable" translate="no">SID</span></code>是实例标识符的每个实例。
                  </p>
                  <p>警报日志以及后台和服务器进程的所有跟踪文件将写入自动诊断存储库，您可以使用<code class="codeph">DIAGNOSTIC_DEST</code>初始化参数指定其位置。例如：</p><pre class="pre codeblock"><code>$ ORACLE_BASE /诊断/ RDBMS / $ DBNAME / $ SID_NAME /跟踪</code></pre><p>Oracle数据库为每个后台线程创建不同的跟踪文件。Oracle RAC后台线程使用跟踪文件来记录数据库操作和数据库错误。这些跟踪日志有助于排除故障，并使Oracle支持人员能够更有效地调试<a href="glossary.html#GUID-5D32446E-2961-496F-BDE1-FE5E9C119DA0"><span class="xrefglossterm">群集数据库</span></a>配置问题。跟踪文件的名称是特定于操作系统的，但每个文件通常包括写入文件的进程的名称（例如LGWR和RECO）。对于Linux，UNIX和Windows系统，后台进程的跟踪文件名为<code class="codeph">SID_ <span class="variable" translate="no">process_name</span> _ <span class="variable" translate="no">process_identifier</span> .trc</code> 。
                  </p>
                  <div class="infoboxnotealso" id="GUID-EC8F3486-98CC-4350-B5F8-8BEFB5607EA5__GUID-15373B3F-E342-4558-ABDA-0D3BE969B154">
                     <p class="notep1">也可以看看：</p>
                     <p>有关监视跟踪文件中的错误和警报的详细信息，请参见<a href="../admin/monitoring-the-database.html#ADMIN005" target="_blank"><span class="italic">“Oracle数据库管理员指南”</span></a></p>
                  </div>
                  <p>如果设置<code class="codeph">DIAGNOSTIC_DEST</code>初始化参数，还会为用户进程创建跟踪文件。用户进程跟踪文件名的格式为<code class="codeph"><span class="variable" translate="no">SID</span> _ora_ <span class="variable" translate="no">process_identifier</span> / <span class="variable" translate="no">thread_identifier</span> .trc</code> ，其中<code class="codeph"><span class="variable" translate="no">process_identifier</span></code>是一个5位数字，表示Linux和UNIX系统上的进程标识符（PID）， <code class="codeph"><span class="variable" translate="no">thread_identifier</span></code>是Windows系统上的线程标识符。
                  </p>
               </div>
            </div><a id="RACAD7590"></a><div class="sect2"><a id="GUID-89F3158D-8383-4EAF-9B15-95EC9E828462" name="GUID-89F3158D-8383-4EAF-9B15-95EC9E828462"></a><h3 id="RACAD-GUID-89F3158D-8383-4EAF-9B15-95EC9E828462" class="sect3">管理Oracle RAC中的诊断数据</h3>
               <div>
                  <p>跨越Oracle RAC实例的问题可能是最难诊断的问题类型。</p>
                  <p>例如，您可能需要关联多个实例中的跟踪文件，并合并跟踪文件。Oracle Database 12c <span class="italic">第</span> 2版（12.2）包括用于收集和管理诊断数据的高级故障诊断基础结构，并使用基于自动诊断存储库（ADR）文件的存储库来存储数据库诊断数据。在共享磁盘上创建ADR基础时，可以在同一ADR Base下为同一Oracle RAC数据库的所有实例放置ADR主目录。使用共享存储：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>您可以使用ADRCI命令行工具关联所有实例的诊断。</p>
                        <p>ADRCI是一个命令行工具，使您可以在ADR中查看诊断数据，并将事件和问题信息打包到zip文件中，以便传输到Oracle Support。诊断数据包括事件和问题描述，跟踪文件，转储，运行状况监视器报告，警报日志条目等。</p>
                        <div class="infoboxnotealso" id="GUID-89F3158D-8383-4EAF-9B15-95EC9E828462__GUID-6D36F72F-4CD3-40E6-8C12-371A5FE0AC45">
                           <p class="notep1">也可以看看：</p>
                           <p>有关使用ADRCI的信息，请参见<a href="../sutil/oracle-adr-command-interpreter-adrci.html#SUTIL700" target="_blank"><span><cite>Oracle数据库实用程序</cite></span></a></p>
                        </div>
                     </li>
                     <li>
                        <p>您可以使用Data Recovery Advisor来帮助诊断和修复损坏的数据块，损坏或丢失的文件以及其他数据故障。</p>
                        <p>Data Recovery Advisor是一个Oracle数据库基础架构，可根据您的请求自动诊断持久性数据故障，提供修复选项和修复问题。</p>
                        <div class="infoboxnotealso" id="GUID-89F3158D-8383-4EAF-9B15-95EC9E828462__GUID-1CDB70F0-A8C1-4FFA-A3C5-C540C52FDB5D">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="../admin/diagnosing-and-resolving-problems.html#ADMIN11007" target="_blank"><span><cite>“Oracle数据库管理员指南”</cite></span></a> ，了解有关管理诊断数据的信息</p>
                        </div>
                     </li>
                  </ul>
               </div>
            </div><a id="RACAD527"></a><div class="sect2"><a id="GUID-6E1B17DD-C6B0-4B2B-96CF-F0FF35FA5544" name="GUID-6E1B17DD-C6B0-4B2B-96CF-F0FF35FA5544"></a><h3 id="RACAD-GUID-6E1B17DD-C6B0-4B2B-96CF-F0FF35FA5544" class="sect3">在Oracle RAC中使用特定于实例的警报文件</h3>
               <div>
                  <p>Oracle RAC数据库中的每个实例都有一个警报文件。每个实例的警报文件， <span class="italic"><code class="codeph">alert.SID.log</code></span>包含有关在数据库操作期间发生的错误消息和异常的重要信息。每次启动实例时，信息都会附加到警报文件中。所有进程线程都可以写入实例的警报文件。
                  </p>
                  <p><span class="italic"><code class="codeph">alert_SID</code></span> <code class="codeph">.log</code>文件位于<code class="codeph">DIAGNOSTIC_DEST</code>初始化参数指定的目录中。
                  </p>
               </div>
            </div><a id="RACAD534"></a><div class="sect2"><a id="GUID-1FDCAB67-46C2-4F21-A1EA-B833C624A6EF" name="GUID-1FDCAB67-46C2-4F21-A1EA-B833C624A6EF"></a><h3 id="RACAD-GUID-1FDCAB67-46C2-4F21-A1EA-B833C624A6EF" class="sect3">在Oracle RAC中启用对基于Java的工具和实用程序的跟踪</h3>
               <div>
                  <p>通过执行与工具或实用程序同名的脚本来调用Oracle RAC中可用的所有基于Java的工具和实用程序。</p>
                  <p>这包括Cluster Verification Utility（CVU），Database Configuration Assistant（DBCA），Net Configuration Assistant（NETCA）和Server Control Utility（SRVCTL）。例如，要运行DBCA，请输入命令<code class="codeph">dbca</code> 。
                  </p>
                  <p>默认情况下，Oracle数据库为DBCA和数据库升级助手（DBUA）启用跟踪。对于CVU和SRVCTL，可以将<code class="codeph">SRVM_TRACE</code>环境变量设置为<code class="codeph">TRUE</code>以使Oracle数据库生成跟踪。Oracle数据库将跟踪写入日志文件。例如，Oracle数据库分别将跟踪写入<code class="codeph"><span class="variable" translate="no">Oracle_base</span> /cfgtoollogs/dbca</code>和<code class="codeph"><span class="variable" translate="no">Oracle_base</span> /cfgtoollogs/dbua</code>日志文件，分别用于DBCA和DBUA。
                  </p>
               </div>
            </div><a id="RACAD529"></a><div class="sect2"><a id="GUID-564C9A02-A143-4537-BCAA-E0CCB7D4A55F" name="GUID-564C9A02-A143-4537-BCAA-E0CCB7D4A55F"></a><h3 id="RACAD-GUID-564C9A02-A143-4537-BCAA-E0CCB7D4A55F" class="sect3">解决待决关机问题</h3>
               <div>
                  <p><a id="d101556e1138" class="indexterm-anchor"></a><a id="d101556e1140" class="indexterm-anchor"></a>在某些情况下， <code class="codeph">SHUTDOWN IMMEDIATE</code>可能正在等待，Oracle数据库不会快速响应重复的关闭请求。这是因为Oracle Clusterware可能正在处理当前的关闭请求。在这种情况下，使用SQL * Plus发出<code class="codeph">SHUTDOWN ABORT</code>以用于后续关闭请求。
                  </p>
               </div>
            </div><a id="RACAD7591"></a><div class="sect2"><a id="GUID-A66CDC09-8AB1-4022-80FC-F7A618C8B4ED" name="GUID-A66CDC09-8AB1-4022-80FC-F7A618C8B4ED"></a><h3 id="RACAD-GUID-A66CDC09-8AB1-4022-80FC-F7A618C8B4ED" class="sect3">如何确定Oracle RAC实例是否正在使用专用网络</h3>
               <div>
                  <p>本节介绍如何手动确定Oracle RAC实例是否正在使用专用网络。但是，此任务的最佳实践是使用Oracle Enterprise Manager云控制图形用户界面（GUI）检查互连。</p>
                  <p><a id="d101556e1306" class="indexterm-anchor"></a><a id="d101556e1308" class="indexterm-anchor"></a><a id="d101556e1310" class="indexterm-anchor"></a><a id="d101556e1312" class="indexterm-anchor"></a>对于大多数网络协议，您可以发出<code class="codeph">oradebug ipc</code>命令以查看数据库正在使用的互连。例如：</p><pre class="oac_no_warn" dir="ltr">oradebug <span class="variable" translate="no">setmypid</span> oradebug ipc</pre><p>这些命令将跟踪文件转储到<code class="codeph">DIAGNOSTIC_DEST</code>初始化参数指定的位置。输出可能类似于以下内容：</p><pre class="oac_no_warn" dir="ltr">SSKGXPT 0x1a2932c标记网络0套接字的SSKGXPT_READPENDING信息没有10 IP 172.16.193.1 UDP 43749 sflags网络1套接字的SSKGXPT_WRITESSKGXPT_UP信息否0 IP 0.0.0.0 UDP 0 ...
</pre><p>在该示例中，您可以看到数据库正在使用带有用户的IP 172.16.193.1 <a id="d101556e1332" class="indexterm-anchor"></a>数据报协议（UDP）协议。此外，您可以发出<code class="codeph">oradebug tracefile_name</code>命令以打印写入输出的跟踪位置。
                  </p>
                  <p>此外，您可以查询<code class="codeph">V$CLUSTER_INTERCONNECTS</code>视图以查看有关专用互连的信息。例如：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; SELECT * FROM V $ CLUSTER_INTERCONNECTS;名称IP_ADDRESS IS_ SOURCE ----- -------------------------- --- ------------ ------------------- eth0 138.2.236.114 NO Oracle Cluster Repository</pre></div>
            </div>
         </div>
      </article>
   </body>
</html>