<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="You can use the DBMS_CRYPTO PL/SQL package to manually encrypt data."></meta>
      <meta name="description" content="You can use the DBMS_CRYPTO PL/SQL package to manually encrypt data."></meta>
      <title>手动加密数据</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Security Guide "></meta>
      <meta property="og:description" content="You can use the DBMS_CRYPTO PL/SQL package to manually encrypt data."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Security Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="database-security-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-02-28T14:57:12-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96299-04"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="encrypt-sensitive-data.html" title="Previous" type="text/html"></link>
      <link rel="next" href="part_4.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database Security Guide"></meta>
    <meta name="dcterms.isVersionOf" content="DBSEG"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="encrypt-sensitive-data.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="part_4.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">安全指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="part_3.html" property="item" typeof="WebPage"><span property="name">控制对数据的访问</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">手动加密数据</li>
            </ol>
            <a id="GUID-B90F0869-1F69-45D9-A835-4985A19F7AB5" name="GUID-B90F0869-1F69-45D9-A835-4985A19F7AB5"></a><a id="DBSEG008"></a>
            
            <h2 id="DBSEG-GUID-B90F0869-1F69-45D9-A835-4985A19F7AB5" class="sect2"><span class="enumeration_chapter">15</span>手动加密数据</h2>
         </header>
         <div class="ind">
            <div>
               <p>您可以使用<code class="codeph">DBMS_CRYPTO</code> PL / SQL包手动加密数据。
               </p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="manually-encrypting-data.html#GUID-4E2F3704-CD79-4F60-AEEB-31FDA6F5124C">加密无法解决的安全问题</a><br>虽然加密数据有很多好的理由，但有很多理由不加密数据。
                  </li>
                  <li class="ulchildlink"><a href="manually-encrypting-data.html#GUID-069CA05C-54F6-4ED0-8BC2-746A1740D8AF">数据加密挑战</a><br>在加密可以提供额外安全性的情况下，存在一些相关的技术挑战。
                  </li>
                  <li class="ulchildlink"><a href="manually-encrypting-data.html#GUID-1AE01705-7C92-443E-983E-D26CB5749EEE">使用DBMS_CRYPTO包进行数据加密存储</a><br><code class="codeph">DBMS_CRYPTO</code>包提供了几种解决安全问题的方法。
                  </li>
                  <li class="ulchildlink"><a href="manually-encrypting-data.html#GUID-40DE97DD-7CD5-486C-B9FB-959408BF6081">在Oracle Database Release 11g中使用OFB模式下加密的密文</a><br>在Oracle Database Release 11g中，配置为使用输出反馈（OFB）的密文使用电子密码本（ECB）模式。
                  </li>
                  <li class="ulchildlink"><a href="manually-encrypting-data.html#GUID-1A99FC75-E08B-46AA-BDB2-EDCCDBA714D1">使用数据加密API的示例</a><br>使用数据加密API的示例包括使用<code class="codeph">DBMS_CRYPTO.SQL</code>过程，加密AES 256位数据以及加密BLOB数据。
                  </li>
                  <li class="ulchildlink"><a href="manually-encrypting-data.html#GUID-FE23ADE1-8140-4695-AC92-FE5085C16D6C">加密数据的数据字典视图</a><br>Oracle数据库提供数据字典视图以查找有关加密数据的信息。
                  </li>
               </ul>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>父主题：</strong> <a href="part_3.html" title="第III部分介绍了如何控制对数据的访问。">控制对数据的访问</a></p>
                  </div>
               </div>
            </div>
            <a id="DBSEG80083"></a><div class="props_rev_3"><a id="GUID-4E2F3704-CD79-4F60-AEEB-31FDA6F5124C" name="GUID-4E2F3704-CD79-4F60-AEEB-31FDA6F5124C"></a><h3 id="DBSEG-GUID-4E2F3704-CD79-4F60-AEEB-31FDA6F5124C" class="sect3">加密无法解决的安全问题</h3>
               <div>
                  <p>虽然加密数据有很多好的理由，但有很多理由不加密数据。</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="manually-encrypting-data.html#GUID-1A747F99-1E02-4D6D-A250-54482BC2A3A0">原则1：加密不能解决访问控制问题</a><br>加密数据时，您应该知道加密不得干扰配置访问控制的方式。
                     </li>
                     <li class="ulchildlink"><a href="manually-encrypting-data.html#GUID-DE0FAE79-4C46-44F5-9E04-FB3DC8D11E9B">原则2：加密不能防止恶意管理员</a><br>您可以使用其他Oracle功能（如Oracle Database Vault）保护您的数据库免受恶意数据库管理员的攻击。
                     </li>
                     <li class="ulchildlink"><a href="manually-encrypting-data.html#GUID-5EE3BC9E-1E46-4620-905D-5D7AAFF31D55">原则3：加密所有内容不会使数据安全</a><br>一个常见的错误是认为如果加密某些数据可以增强安全性，那么加密所有内容会使所有数据都安全。
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="manually-encrypting-data.html#GUID-B90F0869-1F69-45D9-A835-4985A19F7AB5" title="您可以使用DBMS_CRYPTO PL / SQL包手动加密数据。">手动加密数据</a></p>
                     </div>
                  </div>
               </div>
               <a id="DBSEG314"></a><div class="props_rev_3"><a id="GUID-1A747F99-1E02-4D6D-A250-54482BC2A3A0" name="GUID-1A747F99-1E02-4D6D-A250-54482BC2A3A0"></a><h4 id="DBSEG-GUID-1A747F99-1E02-4D6D-A250-54482BC2A3A0" class="sect4">原则1：加密不能解决访问控制问题</h4>
                  <div>
                     <p>加密数据时，您应该知道加密不得干扰配置访问控制的方式。</p>
                     <p>大多数组织必须限制需要查看此数据的用户的数据访问权限。例如，人力资源系统可以限制员工仅查看他们自己的就业记录，同时允许员工的经理查看下属的就业记录。人力资源专家可能还需要查看多名员工的员工记录。</p>
                     <p>通常，您可以使用访问控制机制来解决限制对需要查看数据的人的数据访问的安全策略。多年来，Oracle数据库一直提供强大的，独立评估的访问控制机制。它通过虚拟专用数据库实现了精确的粒度级别的访问控制实施。</p>
                     <p>由于人力资源记录被视为敏感信息，因此很容易认为应加密所有信息以提高安全性。但是，加密不能强制执行细粒度访问控制，并且可能会妨碍数据访问。例如，员工，他的经理和人力资源职员都可能需要访问员工记录。如果所有员工数据都已加密，则所有这三个数据都必须能够以未加密的形式访问数据。因此，员工，经理和人力资源职员必须共享相同的加密密钥来解密数据。因此，加密在更好的访问控制意义上不会提供任何额外的安全性，并且加密可能会妨碍应用程序的正常或有效运行。另一个问题是难以在系统的多个用户之间安全地传输和共享加密密钥。</p>
                     <p>加密存储数据背后的基本原则是它不得干扰访问控制。例如，对<code class="codeph">emp</code>具有<code class="codeph">SELECT</code>特权的用户不应受加密机制的限制，不能看到他允许查看的所有数据。同样，如果用户需要查看表中的所有加密数据，使用一个密钥加密表的一部分和使用另一个密钥加密表的一部分几乎没有什么好处。在这种情况下，加密会增加在用户可以读取数据之前解密数据的开销。如果很好地实现了访问控制，那么加密在数据库本身中几乎不增加额外的安全性。具有访问数据库中数据的权限的用户由于加密而没有更多或更少的权限。因此，您永远不应该使用加密来解决访问控制问题。
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="manually-encrypting-data.html#GUID-4E2F3704-CD79-4F60-AEEB-31FDA6F5124C" title="虽然加密数据有很多好的理由，但有很多理由不加密数据。">加密无法解决的安全问题</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DBSEG315"></a><div class="props_rev_3"><a id="GUID-DE0FAE79-4C46-44F5-9E04-FB3DC8D11E9B" name="GUID-DE0FAE79-4C46-44F5-9E04-FB3DC8D11E9B"></a><h4 id="DBSEG-GUID-DE0FAE79-4C46-44F5-9E04-FB3DC8D11E9B" class="sect4">原则2：加密不能防止恶意管理员</h4>
                  <div>
                     <p>您可以使用其他Oracle功能（如Oracle Database Vault）保护您的数据库免受恶意数据库管理员的攻击。</p>
                     <p>一些组织担心恶意用户可能通过猜测密码获得提升（数据库管理员）权限，例如加密存储数据以防止此威胁的想法。</p>
                     <p>但是，此问题的正确解决方案是保护数据库管理员帐户，并更改其他特权帐户的默认密码。进入数据库的最简单方法是使用管理员允许保持不变的特权帐户的默认密码。一个例子是<code class="codeph">SYS</code> / <code class="codeph">CHANGE_ON_INSTALL</code> 。</p>
                     <p>虽然恶意用户在获得<code class="codeph">DBA</code>权限后可以对数据库执行许多破坏性操作，但加密并不能防止其中的许多内容。示例包括破坏或删除数据，将用户数据导出到文件系统以将数据通过电子邮件发送给自己以在其上运行密码破解程序，等等。
                     </p>
                     <p>一些组织担心数据库管理员（通常具有所有权限）能够查看数据库中的所有数据。这些组织认为数据库管理员应该管理数据库，但是不应该能够看到数据库包含的数据。一些组织还担心将一个人的特权集中在一个人身上，并且更愿意对DBA功能进行分区，或者强制执行双人访问规则。</p>
                     <p>人们很容易认为加密所有数据（或大量数据）可以解决这些问题，但有更好的方法来防范这些威胁。例如，Oracle数据库支持有限的<code class="codeph">DBA</code>权限分区。Oracle数据库为<code class="codeph">SYSDBA</code>和<code class="codeph">SYSOPER</code>用户提供本机支持。<code class="codeph">SYSDBA</code>具有所有权限，但<code class="codeph">SYSOPER</code>具有有限的权限集（例如数据库的启动和关闭）。
                     </p>
                     <p>此外，您可以创建包含多个系统特权的较小角色。<code class="codeph">jr_dba</code>角色可能不包括所有系统权限，但只包括适用于初级数据库管理员的权限（例如<code class="codeph">CREATE TABLE</code> ， <code class="codeph">CREATE USER</code>等）。
                     </p>
                     <p>Oracle数据库还支持审核<code class="codeph">SYS</code> （或<code class="codeph">SYS</code>特权用户）所采取的操作，并将该审计跟踪存储在安全的操作系统位置。使用此模型，对操作系统具有root权限的单独审计员可以审计<code class="codeph">SYS</code>所有操作，使审计员能够让所有数据库管理员对其操作负责。
                     </p>
                     <p>您还可以使用Oracle Database Vault微调数据库管理员的访问和控制。</p>
                     <p>数据库管理员功能是受信任的位置。即使具有最敏感数据的组织（例如情报机构）通常也不会对数据库管理员功能进行分区。相反，他们强烈地管理他们的数据库管理员，因为它是一个信任的位置。定期审计可以帮助发现不适当的活动。</p>
                     <p>存储数据的加密不得干扰数据库的管理，否则可能导致更大的安全问题。例如，如果通过加密数据破坏数据，则会产生安全问题，数据本身无法解释，并且可能无法恢复。</p>
                     <p>您可以使用加密来限制数据库管理员或其他特权用户查看数据库中数据的能力。但是，它不能替代正确管理数据库管理员权限，也不能用于控制强大系统权限的使用。如果不值得信任的用户拥有重要权限，那么他们可能会对组织构成多个威胁，其中一些威胁远远超过查看未加密的信用卡号码。</p>
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-DE0FAE79-4C46-44F5-9E04-FB3DC8D11E9B__GUID-65099AD4-DE49-45EB-A3F4-EED2007C9CE2">
                        <p class="notep1">也可以看看：</p>有关使用Oracle Database Vault微调数据库管理员具有的访问权限和控制权的详细信息，请<a href="../dvadm/introduction-to-oracle-database-vault.html#DVADM001" target="_blank"><span><cite>参见“Oracle Database Vault管理员指南”</cite></span></a></div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="manually-encrypting-data.html#GUID-4E2F3704-CD79-4F60-AEEB-31FDA6F5124C" title="虽然加密数据有很多好的理由，但有很多理由不加密数据。">加密无法解决的安全问题</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DBSEG316"></a><div class="props_rev_3"><a id="GUID-5EE3BC9E-1E46-4620-905D-5D7AAFF31D55" name="GUID-5EE3BC9E-1E46-4620-905D-5D7AAFF31D55"></a><h4 id="DBSEG-GUID-5EE3BC9E-1E46-4620-905D-5D7AAFF31D55" class="sect4">原则3：加密所有内容不会使数据安全</h4>
                  <div>
                     <p>一个常见的错误是认为如果加密某些数据可以增强安全性，那么加密所有内容会使所有数据都安全。</p>
                     <p>正如前两个原则的讨论所示，加密并不能很好地解决访问控制问题，加密不会干扰正常的访问控制。此外，加密整个生产数据库意味着必须解密所有数据以进行读取，更新或删除。加密本质上是一种性能密集型操作;加密所有数据将显着影响性能。</p>
                     <p>可用性是安全性的关键方面。如果加密数据使数据不可用，或者通过降低性能对可用性产生负面影响，那么加密所有内容将产生新的安全问题。当加密密钥发生变化时，数据库无法访问时，可用性也会受到不利影响，因为良好的安全实践需要定期进行。当要更改密钥时，在使用新密钥或密钥解密和重新加密数据时，数据库不可访问。</p>
                     <p>加密离线存储的数据可能是有利的。例如，组织可以在远程位置存储离线6个月到一年的备份。当然，第一道保护是通过建立物理访问控制来保护存储数据的设施。在存储数据之前对其进行加密可以提供额外的好处。由于无法在线访问，因此无需考虑性能。虽然Oracle数据库不提供此功能，但有些供应商提供加密服务。在着手对备份数据进行大规模加密之前，考虑采用这种方法的组织应该彻底测试该过程。必须验证在脱机存储之前加密的数据是否可以成功解密和重新导入。</p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="manually-encrypting-data.html#GUID-4E2F3704-CD79-4F60-AEEB-31FDA6F5124C" title="虽然加密数据有很多好的理由，但有很多理由不加密数据。">加密无法解决的安全问题</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="DBSEG317"></a><div class="props_rev_3"><a id="GUID-069CA05C-54F6-4ED0-8BC2-746A1740D8AF" name="GUID-069CA05C-54F6-4ED0-8BC2-746A1740D8AF"></a><h3 id="DBSEG-GUID-069CA05C-54F6-4ED0-8BC2-746A1740D8AF" class="sect3">数据加密挑战</h3>
               <div>
                  <p>在加密可以提供额外安全性的情况下，存在一些相关的技术挑战。</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="manually-encrypting-data.html#GUID-46789413-3368-472E-A311-C6E70B059ABB">加密的索引数据</a><br>加密数据编入索引时会出现特殊困难。
                     </li>
                     <li class="ulchildlink"><a href="manually-encrypting-data.html#GUID-E8A70864-5DED-4C05-916B-8BE6AAA94703">生成的加密密钥</a><br>加密数据仅与用于加密的密钥一样安全。
                     </li>
                     <li class="ulchildlink"><a href="manually-encrypting-data.html#GUID-4D8F9A4F-E93F-40AF-BC23-C380D28FEC17">传输的加密密钥</a><br>如果应用程序将加密密钥传递给数据库，则必须对其进行加密。
                     </li>
                     <li class="ulchildlink"><a href="manually-encrypting-data.html#GUID-0EE7496E-14F2-4BAC-A2CC-02F7117C784A">存储加密密钥</a><br>您可以将加密密钥存储在数据库或操作系统中。
                     </li>
                     <li class="ulchildlink"><a href="manually-encrypting-data.html#GUID-C1B633FD-8320-4EF4-86A4-1071F07ABECF">更改加密密钥的重要性</a><br>谨慎的安全措施要求您定期更改加密密钥。
                     </li>
                     <li class="ulchildlink"><a href="manually-encrypting-data.html#GUID-DF2A3FDC-8B24-4D20-8833-56EB007D741F">二进制大对象的加密</a><br>某些数据类型需要更多工作才能加密。
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="manually-encrypting-data.html#GUID-B90F0869-1F69-45D9-A835-4985A19F7AB5" title="您可以使用DBMS_CRYPTO PL / SQL包手动加密数据。">手动加密数据</a></p>
                     </div>
                  </div>
               </div>
               <a id="DBSEG318"></a><div class="props_rev_3"><a id="GUID-46789413-3368-472E-A311-C6E70B059ABB" name="GUID-46789413-3368-472E-A311-C6E70B059ABB"></a><h4 id="DBSEG-GUID-46789413-3368-472E-A311-C6E70B059ABB" class="sect4">加密的索引数据</h4>
                  <div>
                     <p>加密数据编入索引时会出现特殊困难。</p>
                     <p></p>
                     <p>例如，假设公司使用国家身份编号（例如美国社会安全号码（SSN））作为其员工的员工编号。公司将员工编号视为敏感数据，因此希望加密<code class="codeph">employees</code>表的<code class="codeph">employee_number</code>列中的数据。因为<code class="codeph">employee_number</code>包含唯一值，所以数据库设计者希望在其上有索引以获得更好的性能。
                     </p>
                     <p>但是，如果使用<code class="codeph">DBMS_CRYPTO</code> （或其他机制）来加密列中的数据，则该列上的索引也将包含加密值。虽然索引可以用于相等性检查（例如， <code class="codeph">SELECT * FROM emp WHERE employee_number = '987654321'</code> ），但如果该列上的索引包含加密值，则索引基本上不能用于任何其他目的。您不应加密索引数据。
                     </p>
                     <p>Oracle建议您不要将国家身份号码用作唯一ID。而是使用<code class="codeph">CREATE SEQUENCE</code>语句生成唯一的标识号。避免使用国民身份号码的理由如下：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>存在与过度使用国民身份号码相关的隐私问题（例如，身份盗用）。</p>
                        </li>
                        <li>
                           <p>有时，与美国社会保障号码一样，国民身份号码可能会有重复。</p>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="manually-encrypting-data.html#GUID-069CA05C-54F6-4ED0-8BC2-746A1740D8AF" title="在加密可以提供额外安全性的情况下，存在一些相关的技术挑战。">数据加密挑战</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DBSEG319"></a><div class="props_rev_3"><a id="GUID-E8A70864-5DED-4C05-916B-8BE6AAA94703" name="GUID-E8A70864-5DED-4C05-916B-8BE6AAA94703"></a><h4 id="DBSEG-GUID-E8A70864-5DED-4C05-916B-8BE6AAA94703" class="sect4">生成的加密密钥</h4>
                  <div>
                     <p>加密数据仅与用于加密的密钥一样安全。</p>
                     <p>必须使用安全加密密钥生成安全地生成加密密钥。Oracle数据库通过<code class="codeph">RANDOMBYTES</code>功能提供对安全随机数生成的<code class="codeph">DBMS_CRYPTO</code> 。 （此函数替换了早期<code class="codeph">DBMS_OBFUSCATION_TOOLKIT</code>的<code class="codeph">GetKey</code>过程提供的功能，该过程已被弃用。）<code class="codeph">DBMS_CRYPTO</code>调用先前由RSA Security认证的安全随机数生成器（RNG）。
                     </p>
                     <div class="infoboxnote" id="GUID-E8A70864-5DED-4C05-916B-8BE6AAA94703__GUID-E5DE5041-DF8A-4568-9C95-A59FE2196C21">
                        <p class="notep1">注意：</p>
                        <p>不要使用<code class="codeph">DBMS_RANDOM</code>包。<code class="codeph">DBMS_RANDOM</code>包生成伪随机数，随着安全性随机性建议（RFC-1750）规定使用伪随机过程生成秘密量可能导致伪安全性。
                        </p>
                     </div>
                     <p>加密密钥值时，请确保提供正确的字节数。例如，您必须为<code class="codeph">ENCRYPT_AES128</code>加密算法提供16字节密钥。
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="manually-encrypting-data.html#GUID-069CA05C-54F6-4ED0-8BC2-746A1740D8AF" title="在加密可以提供额外安全性的情况下，存在一些相关的技术挑战。">数据加密挑战</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DBSEG320"></a><div class="props_rev_3"><a id="GUID-4D8F9A4F-E93F-40AF-BC23-C380D28FEC17" name="GUID-4D8F9A4F-E93F-40AF-BC23-C380D28FEC17"></a><h4 id="DBSEG-GUID-4D8F9A4F-E93F-40AF-BC23-C380D28FEC17" class="sect4">传输的加密密钥</h4>
                  <div>
                     <p>如果应用程序将加密密钥传递给数据库，则必须对其进行加密。</p>
                     <p>否则，入侵者可以在传输密钥时访问密钥。网络数据加密可保护传输中的所有数据免受修改或拦截，包括加密密钥。</p>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="configuring-network-data-encryption-and-integrity.html#GUID-7F12066A-2BA1-476C-809B-BB95A3F727CF" title="您可以为服务器和客户端配置本机Oracle Net Services数据加密和数据完整性。">配置Oracle数据库本机网络加密和数据完整性</a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="manually-encrypting-data.html#GUID-069CA05C-54F6-4ED0-8BC2-746A1740D8AF" title="在加密可以提供额外安全性的情况下，存在一些相关的技术挑战。">数据加密挑战</a></p>
                        </div>
                     </div>
                  </div>
               </div><a id="DBSEG321"></a><div class="props_rev_3"><a id="GUID-0EE7496E-14F2-4BAC-A2CC-02F7117C784A" name="GUID-0EE7496E-14F2-4BAC-A2CC-02F7117C784A"></a><h4 id="DBSEG-GUID-0EE7496E-14F2-4BAC-A2CC-02F7117C784A" class="sect4">存储加密密钥</h4>
                  <div>
                     <p>您可以将加密密钥存储在数据库或操作系统中。</p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="manually-encrypting-data.html#GUID-3D496FBB-DCFA-443C-A0C4-2F1BFD1218CA">关于存储加密密钥</a><br>存储加密密钥是加密中最重要但最困难的方面之一。
                        </li>
                        <li class="ulchildlink"><a href="manually-encrypting-data.html#GUID-CF618441-D340-4F17-A3D9-F115F310DA76">在数据库中存储加密密钥</a><br>在数据库中存储加密密钥并不总是阻止数据库管理员访问加密数据。
                        </li>
                        <li class="ulchildlink"><a href="manually-encrypting-data.html#GUID-2A795A3E-1917-471C-B5A8-607726E36F7C">在操作系统中存储加密密钥</a><br>将加密密钥存储在操作系统平面文件中时，可以从PL / SQL发出标注以检索这些加密密钥。
                        </li>
                        <li class="ulchildlink"><a href="manually-encrypting-data.html#GUID-8144AB67-F6A8-4D4B-AA95-02AE6FCD28A8">用户管理自己的加密密钥</a><br>让用户提供密钥假定用户将负责密钥。
                        </li>
                        <li class="ulchildlink"><a href="manually-encrypting-data.html#GUID-C9F979FE-7A42-44EB-9A9A-3CF933130159">使用透明数据库加密和表空间加密的手动加密</a><br>透明数据库加密和表空间加密为加密表和表空间提供安全加密和自动密钥管理。
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="manually-encrypting-data.html#GUID-069CA05C-54F6-4ED0-8BC2-746A1740D8AF" title="在加密可以提供额外安全性的情况下，存在一些相关的技术挑战。">数据加密挑战</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="DBSEG1077"></a><div class="props_rev_3"><a id="GUID-3D496FBB-DCFA-443C-A0C4-2F1BFD1218CA" name="GUID-3D496FBB-DCFA-443C-A0C4-2F1BFD1218CA"></a><h5 id="DBSEG-GUID-3D496FBB-DCFA-443C-A0C4-2F1BFD1218CA" class="sect5">关于存储加密密钥</h5>
                     <div>
                        <p>存储加密密钥是加密中最重要但最困难的方面之一。</p>
                        <p>要恢复使用对称密钥加密的数据，授权应用程序或寻求解密数据的用户必须可以访问该密钥。同时，对于恶意尝试访问他本不应该看到的加密数据的人来说，密钥必须是不可访问的。</p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="manually-encrypting-data.html#GUID-0EE7496E-14F2-4BAC-A2CC-02F7117C784A" title="您可以将加密密钥存储在数据库或操作系统中。">存储加密密钥</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG322"></a><div class="props_rev_3"><a id="GUID-CF618441-D340-4F17-A3D9-F115F310DA76" name="GUID-CF618441-D340-4F17-A3D9-F115F310DA76"></a><h5 id="DBSEG-GUID-CF618441-D340-4F17-A3D9-F115F310DA76" class="sect5">在数据库中存储加密密钥</h5>
                     <div>
                        <p>在数据库中存储加密密钥并不总是阻止数据库管理员访问加密数据。</p>
                        <p>所有特权数据库管理员仍然可以访问包含加密密钥的表。但是，它通常可以提供良好的安全性，以防止随意的好奇用户或攻击操作系统上的数据库文件的人。</p>
                        <p>作为一个简单的例子，假设您创建一个包含员工数据的表（ <code class="codeph">EMP</code> ）。您希望加密存储在其中一列中的员工社会安全号码（SSN）。您可以使用存储在单独列中的密钥加密员工SSN。但是，对整个表具有<code class="codeph">SELECT</code>访问权限的任何人都可以检索加密密钥并解密匹配的SSN。</p>
                        <p>虽然这种加密方案似乎很容易被打败，但只需稍加努力就可以创建一个更难破解的解决方案。例如，您可以使用在<code class="codeph">employee_number</code>上执行一些额外数据转换的技术来加密SSN，然后再使用它来加密SSN。这种技术可能就像在<code class="codeph">employee_number</code>上使用<code class="codeph">XOR</code>操作和<code class="codeph">employee_number</code>的出生日期一样简单，以确定值的有效性。
                        </p>
                        <p>作为额外保护，可以包装执行加密的PL / SQL源代码（使用<code class="codeph">WRAP</code>实用程序），该代码模糊（加密）代码。<code class="codeph">WRAP</code>实用程序处理输入SQL文件并对其中的PL / SQL单元进行模糊处理。例如，以下命令使用<code class="codeph">keymanage.sql</code>文件作为输入：</p><pre class="oac_no_warn" dir="ltr">wrap iname = / mydir / keymanage.sql</pre><p>随后，开发人员可以在包调用中<code class="codeph">DBMS_CRYPTO</code>包装包中包含的密钥调用<code class="codeph">DBMS_CRYPTO</code>包中的函数。
                        </p>
                        <p>Oracle数据库使您可以混淆动态生成的PL / SQL代码。<code class="codeph">DBMS_DDL</code>包中包含两个子程序，允许您对动态生成的PL / SQL程序单元进行模糊处理。例如，以下块使用<code class="codeph">DBMS_DDL.CREATE_WRAPPED</code>过程来包装动态生成的PL / SQL代码。
                        </p><pre class="oac_no_warn" dir="ltr">开始 ......SYS.DBMS_DDL.CREATE_WRAPPED（ <span class="italic">function_returning_PLSQL_code</span> （））; ......结束;</pre><p>虽然包装不是不可破坏的，但它使入侵者更难以访问加密密钥。即使在为每个加密数据值提供不同密钥的情况下，也不应将密钥值嵌入到包中。而是包装执行密钥管理的包（即数据转换或填充）。</p>
                        <div class="infoboxnotealso" id="GUID-CF618441-D340-4F17-A3D9-F115F310DA76__GUID-9519CF11-27F9-4087-81C3-F807F01F4CFF">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="../lnpls/plsql-source-text-wrapping.html#LNPLS016" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a>有关<code class="codeph">WRAP</code>命令行实用程序和用于动态包装的<code class="codeph">DBMS_DDL</code>子程序的其他信息</p>
                        </div>
                        <p>包装数据的另一种方法是使用一个单独的表来存储加密密钥，并使用过程将调用封装到密钥表中。可以使用主键与外键关系将键表连接到数据表。例如， <code class="codeph">employee_number</code>是<code class="codeph">employees</code>表中存储员工信息和加密SSN的主键。 <code class="codeph">employee_number</code>列是<code class="codeph">ssn_keys</code>表的外键，用于存储员工SSN的加密密钥。存储在<code class="codeph">ssn_keys</code>表中的密钥也可以在使用前进行转换（通过使用<code class="codeph">XOR</code>操作），因此密钥本身不会以未加密的方式存储。如果您包装该过程，那么可以隐藏在使用之前转换键的方式。
                        </p>
                        <p>这种方法的优点是：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>具有直接表访问权限的用户无法看到未加密的敏感数据，也无法检索用于解密数据的密钥。</p>
                           </li>
                           <li>
                              <p>可以通过选择加密数据的过程来控制对解密数据的访问，从密钥表中检索解密密钥，并在它可用于解密数据之前对其进行转换。</p>
                           </li>
                           <li>
                              <p>通过包装过程来隐藏数据转换算法以防止偶然监听，该过程混淆了过程代码。</p>
                           </li>
                           <li>
                              <p>对数据表和密钥表的<code class="codeph">SELECT</code>访问不保证具有此访问权限的用户可以解密数据，因为密钥在使用前已经转换。
                              </p>
                           </li>
                        </ul>
                        <p>这种方法的缺点是，对密钥表和数据表具有<code class="codeph">SELECT</code>访问权限，并且可以导出密钥转换算法的用户可以破坏加密方案。
                        </p>
                        <p>前面的方法并非绝对可靠，但它足以防止轻松检索以明文形式存储的敏感信息。</p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="manually-encrypting-data.html#GUID-0EE7496E-14F2-4BAC-A2CC-02F7117C784A" title="您可以将加密密钥存储在数据库或操作系统中。">存储加密密钥</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG323"></a><div class="props_rev_3"><a id="GUID-2A795A3E-1917-471C-B5A8-607726E36F7C" name="GUID-2A795A3E-1917-471C-B5A8-607726E36F7C"></a><h5 id="DBSEG-GUID-2A795A3E-1917-471C-B5A8-607726E36F7C" class="sect5">在操作系统中存储加密密钥</h5>
                     <div>
                        <p>将加密密钥存储在操作系统平面文件中时，可以从PL / SQL发出标注以检索这些加密密钥。</p>
                        <p>但是，如果将密钥存储在操作系统中并对其进行标注，则您的数据仅与操作系统上的保护一样安全。</p>
                        <p>如果您的主要安全问题是数据库可以从操作系统中分离出来，那么将密钥存储在操作系统中会使入侵者更容易检索加密数据，而不是将密钥存储在数据库本身中。</p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="manually-encrypting-data.html#GUID-0EE7496E-14F2-4BAC-A2CC-02F7117C784A" title="您可以将加密密钥存储在数据库或操作系统中。">存储加密密钥</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG324"></a><div class="props_rev_3"><a id="GUID-8144AB67-F6A8-4D4B-AA95-02AE6FCD28A8" name="GUID-8144AB67-F6A8-4D4B-AA95-02AE6FCD28A8"></a><h5 id="DBSEG-GUID-8144AB67-F6A8-4D4B-AA95-02AE6FCD28A8" class="sect5">用户管理自己的加密密钥</h5>
                     <div>
                        <p>让用户提供密钥假定用户将负责密钥。</p>
                        <p>考虑到40％的服务台呼叫来自忘记密码的用户，您可以看到让用户管理加密密钥的风险。用户很可能会忘记加密密钥，或者将密钥写下来，这会产生安全漏洞。如果用户忘记加密密钥或离开公司，则您的数据无法恢复。</p>
                        <p>如果您决定使用用户提供的密钥或用户管理的密钥，则需要确保使用本机网络加密，以便密钥不会以明文形式从客户端传递到服务器。您还必须开发密钥存档机制，这也是一个棘手的安全问题。密钥存档和后门创建了加密试图解决的安全漏洞。</p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="manually-encrypting-data.html#GUID-0EE7496E-14F2-4BAC-A2CC-02F7117C784A" title="您可以将加密密钥存储在数据库或操作系统中。">存储加密密钥</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG325"></a><div class="props_rev_3"><a id="GUID-C9F979FE-7A42-44EB-9A9A-3CF933130159" name="GUID-C9F979FE-7A42-44EB-9A9A-3CF933130159"></a><h5 id="DBSEG-GUID-C9F979FE-7A42-44EB-9A9A-3CF933130159" class="sect5">使用透明数据库加密和表空间加密的手动加密</h5>
                     <div>
                        <p>透明数据库加密和表空间加密为加密表和表空间提供安全加密和自动密钥管理。</p>
                        <p>如果应用程序需要保护存储在介质上的敏感列数据，那么这两种类型的加密是实现此目的的一种简单而快速的方法。</p>
                     </div>
                     <div>
                        <div class="infoboxnotealso" id="GUID-C9F979FE-7A42-44EB-9A9A-3CF933130159__GUID-DC67FFA8-A3AC-42A6-98E6-E95C7490E498">
                           <p class="notep1">也可以看看：</p>
                           <p>有关透明数据加密的详细信息，请参见<a href="../asoag/asopart1.html#ASOAG600" target="_blank"><span><cite>Oracle数据库高级安全性指南</cite></span></a></p>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="manually-encrypting-data.html#GUID-0EE7496E-14F2-4BAC-A2CC-02F7117C784A" title="您可以将加密密钥存储在数据库或操作系统中。">存储加密密钥</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div><a id="DBSEG326"></a><div class="props_rev_3"><a id="GUID-C1B633FD-8320-4EF4-86A4-1071F07ABECF" name="GUID-C1B633FD-8320-4EF4-86A4-1071F07ABECF"></a><h4 id="DBSEG-GUID-C1B633FD-8320-4EF4-86A4-1071F07ABECF" class="sect4">更改加密密钥的重要性</h4>
                  <div>
                     <p>谨慎的安全措施要求您定期更改加密密钥。</p>
                     <p>对于存储的数据，这需要定期取消加密数据，然后使用另一个精心选择的密钥重新加密。</p>
                     <p>您很可能在未访问数据时更改加密密钥，这会产生另一个挑战。对于加密信用卡号的基于Web的应用程序尤其如此，因为您不希望在切换加密密钥时关闭整个应用程序。</p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="manually-encrypting-data.html#GUID-069CA05C-54F6-4ED0-8BC2-746A1740D8AF" title="在加密可以提供额外安全性的情况下，存在一些相关的技术挑战。">数据加密挑战</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DBSEG327"></a><div class="props_rev_3"><a id="GUID-DF2A3FDC-8B24-4D20-8833-56EB007D741F" name="GUID-DF2A3FDC-8B24-4D20-8833-56EB007D741F"></a><h4 id="DBSEG-GUID-DF2A3FDC-8B24-4D20-8833-56EB007D741F" class="sect4">二进制大对象的加密</h4>
                  <div>
                     <p>某些数据类型需要更多工作才能加密。</p>
                     <p>例如，Oracle数据库支持存储二进制大对象（BLOB），它在数据库中存储非常大的对象（例如，数千兆字节）。BLOB既可以作为列存储在内部，也可以存储在外部文件中。</p>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="manually-encrypting-data.html#GUID-63CCAA8B-180C-4456-881F-F9F31A3D94AE" title="您可以加密BLOB数据。">示例：BLOB数据的加密和解密过程</a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="manually-encrypting-data.html#GUID-069CA05C-54F6-4ED0-8BC2-746A1740D8AF" title="在加密可以提供额外安全性的情况下，存在一些相关的技术挑战。">数据加密挑战</a></p>
                        </div>
                     </div>
                  </div>
               </div>
            </div><a id="DBSEG328"></a><a id="DBSEG80084"></a><div class="props_rev_3"><a id="GUID-1AE01705-7C92-443E-983E-D26CB5749EEE" name="GUID-1AE01705-7C92-443E-983E-D26CB5749EEE"></a><h3 id="DBSEG-GUID-1AE01705-7C92-443E-983E-D26CB5749EEE" class="sect3">使用DBMS_CRYPTO包进行数据加密存储</h3>
               <div>
                  <p><code class="codeph">DBMS_CRYPTO</code>包提供了几种解决安全问题的方法。
                  </p>
                  <p>虽然加密不是解决多种安全威胁的理想解决方案，但很明显，在数据库中存储之前有选择地加密敏感数据确实可以提高安全性。此类数据的示例可包括：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>信用卡号码</p>
                     </li>
                     <li>
                        <p>国民身份证号码</p>
                     </li>
                  </ul>
                  <p>Oracle数据库提供PL / SQL包<code class="codeph">DBMS_CRYPTO</code>来加密和解密存储的数据。该软件包支持多种行业标准加密和散列算法，包括高级加密标准（AES）加密算法。AES被美国国家标准与技术研究院（NIST）批准用于取代数据加密标准（DES）。
                  </p>
                  <p><code class="codeph">DBMS_CRYPTO</code>程序包支持常见Oracle数据库数据类型的加密和解密，包括<code class="codeph">RAW</code>和大对象（LOB），如图像和声音。具体来说，它支持BLOB和CLOB。此外，它还提供全球化支持，用于跨不同数据库字符集加密数据。
                  </p>
                  <p>支持以下加密算法：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>高级加密标准（AES）</p>
                     </li>
                     <li>
                        <p>SHA-2加密哈希设置：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">HASH_SH256</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">HASH_SH384</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">HASH_SH512</code></p>
                           </li>
                        </ul>
                     </li>
                     <li>
                        <p>SHA-2消息认证码（MAC）</p>
                     </li>
                  </ul>
                  <p><code class="codeph">DBMS_CRYPTO</code>也提供了分组密码修饰符。您可以选择多种填充选项，包括公钥加密标准（PKCS）＃5，以及四种分组密码链模式，包括密码块链接（CBC）。填充必须以八个字节的倍数完成。
                  </p>
                  <div class="infoboxnote" id="GUID-1AE01705-7C92-443E-983E-D26CB5749EEE__GUID-6518FC8B-6CF0-4503-94F8-8F428E687359">
                     <p class="notep1">注意：</p>
                     <p></p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>美国国家标准与技术研究院（NIST）不再推荐使用DES。</p>
                        </li>
                        <li>
                           <p>SHA-1的使用比MD5更安全。</p>
                        </li>
                        <li>
                           <p>SHA-2的使用比SHA-1更安全。</p>
                        </li>
                        <li>
                           <p>键控MD5不容易受到攻击。</p>
                        </li>
                     </ul>
                  </div>
                  <p><a href="manually-encrypting-data.html#GUID-1AE01705-7C92-443E-983E-D26CB5749EEE__G1009632" title="此表将DBMS_CRYPTO程序包的功能与DBMS_OBFUSCATION_TOOLKIT程序包的功能进行了比较。">表15-1</a>总结了<code class="codeph">DBMS_CRYPTO</code>程序包的功能。
                  </p>
                  <div class="tblformal" id="GUID-1AE01705-7C92-443E-983E-D26CB5749EEE__G1009632">
                     <p class="titleintable">表15-1 DBMS_CRYPTO程序包功能摘要</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="DBMS_CRYPTO包功能摘要" width="100%" border="1" summary="This table compares the features of the DBMS_CRYPTO package with the features of the DBMS_OBFUSCATION_TOOLKIT package." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="39%" id="d114414e2667">特征</th>
                              <th align="left" valign="bottom" width="61%" id="d114414e2670">DBMS_CRYPTO支持的功能</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="39%" id="d114414e2675" headers="d114414e2667 ">
                                 <p>加密算法</p>
                              </td>
                              <td align="left" valign="top" width="61%" headers="d114414e2675 d114414e2670 ">
                                 <p>AES</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="39%" id="d114414e2682" headers="d114414e2667 ">
                                 <p>填充表格</p>
                              </td>
                              <td align="left" valign="top" width="61%" headers="d114414e2682 d114414e2670 ">
                                 <p>PKCS5，零</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="39%" id="d114414e2689" headers="d114414e2667 ">
                                 <p>分组密码链模式</p>
                              </td>
                              <td align="left" valign="top" width="61%" headers="d114414e2689 d114414e2670 ">
                                 <p>CBC，CFB，ECB，OFB</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="39%" id="d114414e2696" headers="d114414e2667 ">
                                 <p>加密哈希算法</p>
                              </td>
                              <td align="left" valign="top" width="61%" headers="d114414e2696 d114414e2670 ">
                                 <p>SHA-1，SHA-2，MD4，MD5，HASH_SH256，HASH_SH384，HASH_SH512</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="39%" id="d114414e2703" headers="d114414e2667 ">
                                 <p>密钥散列（MAC）算法</p>
                              </td>
                              <td align="left" valign="top" width="61%" headers="d114414e2703 d114414e2670 ">
                                 <p>HMAC_MD5，HMAC_SH1，HMAC_SH256，HMAC_SH384，HMAC_SH512</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="39%" id="d114414e2710" headers="d114414e2667 ">
                                 <p>密码伪随机数发生器</p>
                              </td>
                              <td align="left" valign="top" width="61%" headers="d114414e2710 d114414e2670 ">
                                 <p><code class="codeph">RAW</code> ， <code class="codeph">NUMBER</code> ， <code class="codeph">BINARY_INTEGER</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="39%" id="d114414e2724" headers="d114414e2667 ">
                                 <p>数据库类型</p>
                              </td>
                              <td align="left" valign="top" width="61%" headers="d114414e2724 d114414e2670 ">
                                 <p><code class="codeph">RAW</code> ， <code class="codeph">CLOB</code> ， <code class="codeph">BLOB</code></p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <p><code class="codeph">DBMS_CRYPTO</code>支持一系列适用于新系统和现有系统的算法。虽然提供3DES_2KEY和MD4是为了向后兼容，但使用3DES，AES或SHA-1可以获得更好的安全性。因此，不建议使用3DES_2KEY。
                  </p>
                  <p><code class="codeph">DBMS_CRYPTO</code>程序包包括加密校验和功能（MD5），可用于比较，以及生成安全随机数（ <code class="codeph">RANDOMBYTES</code>功能）的功能。安全随机数生成是密码学的重要组成部分;可预测的键是容易猜到的键;并且容易猜到的密钥可能导致数据的轻松解密。大多数密码分析是通过查找弱密钥或存储不良密钥来完成的，而不是通过强力分析（循环遍历所有可能的密钥）。
                  </p>
                  <div class="infoboxnote" id="GUID-1AE01705-7C92-443E-983E-D26CB5749EEE__GUID-AA71C7CF-2B58-456A-96B5-90139BDB1281">
                     <p class="notep1">注意：</p>
                     <p>不要使用<code class="codeph">DBMS_RANDOM</code> ，因为它不适合加密密钥生成。
                     </p>
                  </div>
                  <p>密钥管理是程序化的。也就是说，应用程序（或函数的调用者）必须提供加密密钥。这意味着应用程序开发人员必须找到一种安全存储和检索密钥的方法。各种关键管理技术的相对优势和劣势将在后面的章节中讨论。DES算法本身的有效密钥长度为56位。</p>
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-1AE01705-7C92-443E-983E-D26CB5749EEE__GUID-91AB199E-7849-4567-BD5E-7898AA9A17A0">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>有关<code class="codeph">DBMS_CRYPTO</code>程序包的详细信息，请<code class="codeph">DBMS_CRYPTO</code> <a href="../arpls/DBMS_CRYPTO.html#ARPLS664" target="_blank"><span><cite>Oracle Database PL / SQL程序包和类型参考</cite></span></a></p>
                        </li>
                        <li>
                           <p>有关<code class="codeph">UTL_RAW</code>包的详细信息，请<code class="codeph">UTL_RAW</code> <a href="../arpls/UTL_RAW.html#ARPLS072" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="manually-encrypting-data.html#GUID-B90F0869-1F69-45D9-A835-4985A19F7AB5" title="您可以使用DBMS_CRYPTO PL / SQL包手动加密数据。">手动加密数据</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-40DE97DD-7CD5-486C-B9FB-959408BF6081" name="GUID-40DE97DD-7CD5-486C-B9FB-959408BF6081"></a><h3 id="DBSEG-GUID-40DE97DD-7CD5-486C-B9FB-959408BF6081" class="sect3">在Oracle Database Release 11g中使用OFB模式下加密的密文</h3>
               <div>
                  <p>在Oracle Database Release 11g中，配置为使用输出反馈（OFB）的密文使用电子密码本（ECB）模式。</p>
                  <div class="section">在Oracle Database Release <span class="italic">11g中</span> ，如果设置<code class="codeph">DBMS_CRYPTO.CHAIN_OFB</code>块密码链修改器以配置密文加密以使用输出反馈（OFB）模式，那么由于Oracle Bug 13001552，结果是配置使用了电子密码本（ECB）模式错误。Oracle Database 12c中已修复此错误。因此，在从Oracle数据库版本11g升级到版本12c之后，在版本11g中使用OFB模式加密的密文将不再在Oracle Database 12c或更高版本中更正的OFB模式下正确解密。
                     <p>要解决此问题：</p>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li><span>以具有<code class="codeph">DBMS_CRYPTO</code> PL / SQL包的<code class="codeph">EXECUTE</code>特权的用户身份登录数据库。</span></li>
                     <li><span>使用<code class="codeph">DBMS_CRYPTO.CHAIN_ECB</code>块密码链接修饰符解密密码。</span></li>
                  </ol>
                  <div class="example" id="GUID-40DE97DD-7CD5-486C-B9FB-959408BF6081__GUID-3D280050-F5F1-4124-B360-CA35AAAE3EF2">
                     <p>下面的例子， <code class="codeph">dbmscrypto11.sql</code> ，显示了在Oracle数据库版本将<span class="italic">11g</span>该错误行为：</p><pre class="pre codeblock"><code>dbmscrypto11.sql：在declare l_mod_ofb上设置serveroutput pls_integer; l_mod_ecb pls_integer; v_key raw（32）; v_iv raw（16）; v_test_in raw（16）; v_ciphertext raw（16）; v_test_out_ECB raw（16）; v_test_out_OFB raw（16）; begin l_mod_ofb：= dbms_crypto。ENCRYPT_AES256 + dbms_crypto。CHAIN_OFB + DBMS_CRYPTO.PAD_NONE; l_mod_ecb：= dbms_crypto。ENCRYPT_AES256 + dbms_crypto。CHAIN_ECB + DBMS_CRYPTO.PAD_NONE; v_key：= hextoraw（'603deb1015ca71be2b73aef0857d77811f352c073b6108d72d9810a30914dff4'）; v_iv：= hextoraw（'000102030405060708090A0B0C0D0E0F'）; v_test_in：= hextoraw（'6bc1bee22e409f96e93d7e117393172a'）; v_ciphertext：= dbms_crypto.encrypt（src =&gt; v_test_in，TYP =&gt; l_mod_ofb，key =&gt; v_key，iv =&gt; v_iv）; v_test_out_ECB：= dbms_crypto.decrypt（src =&gt; v_ciphertext，TYP =&gt; l_mod_ecb，key =&gt; v_key，iv =&gt; v_iv）; v_test_out_OFB：= dbms_crypto.decrypt（src =&gt; v_ciphertext，TYP =&gt; l_mod_ofb，key =&gt; v_key，iv =&gt; v_iv）; dbms_output.put_line（'输入明文：'|| rawtohex（v_test_in））; dbms_output.put_line（'11g：密文（在OFB模式下加密）：'|| rawtohex（v_ciphertext））; dbms_output.put_line（'11g：ECB模式下的解密输出：'|| rawtohex（v_test_out_ECB））; dbms_output.put_line（'11g：OFB模式下的解密输出：'|| rawtohex（v_test_out_OFB））;结束; /</code></pre><p>结果输出如下：</p><pre class="pre codeblock"><code>SQL&gt; @ dbmscrypto11.sql输入明文：6BC1BEE22E409F96E93D7E117393172A11克：密文（加密在OFB模式）：F3EED1BDB5D2A03C064B5A7E3DB181F811克：在ECB模式的解密输出：6BC1BEE22E409F96E93D7E117393172A11克：在OFB模式解密的输出：6BC1BEE22E409F96E93D7E117393172A</code></pre><p>此输出说明在Oracle数据库版本11 <span class="italic">g中</span> ，OFB模式是错误的ECB模式，因此在OFB或ECB模式下解密会产生正确的明文。
                     </p>
                     <p>下一个示例<code class="codeph">dbmscrypto12from11.sql</code>显示，在从Oracle数据库版本11 <span class="italic">g</span>升级到版本12 <span class="italic">c之后</span> ，必须使用ECB模式而不是OFB模式才能正确解密版本11 <span class="italic">g中</span>以OFB模式加密的密文。
                     </p><pre class="pre codeblock"><code>dbmscrypto12from11.sql：在declare l_mod_ofb上设置serveroutput pls_integer; l_mod_ecb pls_integer; v_key raw（32）; v_iv raw（16）; v_test_in raw（16）; v_ciphertext11 raw（16）; v_test_out_ECB raw（16）; v_test_out_OFB raw（16）; begin l_mod_ofb：= dbms_crypto。ENCRYPT_AES256 + dbms_crypto。CHAIN_OFB + DBMS_CRYPTO.PAD_NONE; l_mod_ecb：= dbms_crypto。ENCRYPT_AES256 + dbms_crypto。CHAIN_ECB + DBMS_CRYPTO.PAD_NONE; v_key：= hextoraw（'603deb1015ca71be2b73aef0857d77811f352c073b6108d72d9810a30914dff4'）; v_iv：= hextoraw（'000102030405060708090A0B0C0D0E0F'）; v_test_in：= hextoraw（'6bc1bee22e409f96e93d7e117393172a'）; v_ciphertext11：= hextoraw（'F3EED1BDB5D2A03C064B5A7E3DB181F8'）; v_test_out_ECB：= dbms_crypto.decrypt（src =&gt; v_ciphertext11，TYP =&gt; l_mod_ecb，key =&gt; v_key，iv =&gt; v_iv）; v_test_out_OFB：= dbms_crypto.decrypt（src =&gt; v_ciphertext11，TYP =&gt; l_mod_ofb，key =&gt; v_key，iv =&gt; v_iv）; dbms_output.put_line（'输入明文（至11g）：'|| rawtohex（v_test_in））; dbms_output.put_line（'11g：密文（在OFB模式下加密）：'|| rawtohex（v_ciphertext11））; dbms_output.put_line（'12c：ECB模式下的解密输出：'|| rawtohex（v_test_out_ECB））; dbms_output.put_line（'12c：OFB模式下的解密输出：'|| rawtohex（v_test_out_OFB））;结束; /</code></pre><p>结果输出如下：</p><pre class="pre codeblock"><code>SQL&gt; @ dbmscrypto12from11.sql输入明文（到11g）：6BC1BEE22E409F96E93D7E117393172A11克：密文（加密在OFB模式）：F3EED1BDB5D2A03C064B5A7E3DB181F8 12C：在ECB模式的解密输出：6BC1BEE22E409F96E93D7E117393172A 12C：在OFB模式解密的输出：4451EBE041EB29E191BBA0E9D67FAEB2</code></pre><p>如果您正准备从Oracle数据库版本<span class="italic">11克</span>升级到版本<span class="italic">12℃，</span>然后编辑，你可能有在OFB模式中指定，这样解密操作使用ECB模式的任何脚本。这样，脚本将在版本11g和版本12c及更高版本中工作，从而确保业务连续性。
                     </p>
                  </div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="manually-encrypting-data.html#GUID-B90F0869-1F69-45D9-A835-4985A19F7AB5" title="您可以使用DBMS_CRYPTO PL / SQL包手动加密数据。">手动加密数据</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="DBSEG80087"></a><div class="props_rev_3"><a id="GUID-1A99FC75-E08B-46AA-BDB2-EDCCDBA714D1" name="GUID-1A99FC75-E08B-46AA-BDB2-EDCCDBA714D1"></a><h3 id="DBSEG-GUID-1A99FC75-E08B-46AA-BDB2-EDCCDBA714D1" class="sect3">使用数据加密API的示例</h3>
               <div>
                  <p>使用数据加密API的示例包括使用<code class="codeph">DBMS_CRYPTO.SQL</code>过程，加密AES 256位数据以及加密BLOB数据。
                  </p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="manually-encrypting-data.html#GUID-572BC836-0F6A-4D1C-A5E0-15DB1FC551B5">示例：数据加密过程</a><br><code class="codeph">DBMS_CRYPTO.SQL</code> PL / SQL程序可用于加密数据。
                     </li>
                     <li class="ulchildlink"><a href="manually-encrypting-data.html#GUID-415A7D89-DE8F-438C-ABF5-49C3B90388E6">示例：AES 256位数据加密和解密过程</a><br>您可以使用PL / SQL块来加密和解密预定义变量。
                     </li>
                     <li class="ulchildlink"><a href="manually-encrypting-data.html#GUID-63CCAA8B-180C-4456-881F-F9F31A3D94AE">示例：BLOB数据的加密和解密过程</a><br>您可以加密BLOB数据。
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="manually-encrypting-data.html#GUID-B90F0869-1F69-45D9-A835-4985A19F7AB5" title="您可以使用DBMS_CRYPTO PL / SQL包手动加密数据。">手动加密数据</a></p>
                     </div>
                  </div>
               </div>
               <a id="DBSEG335"></a><div class="props_rev_3"><a id="GUID-572BC836-0F6A-4D1C-A5E0-15DB1FC551B5" name="GUID-572BC836-0F6A-4D1C-A5E0-15DB1FC551B5"></a><h4 id="DBSEG-GUID-572BC836-0F6A-4D1C-A5E0-15DB1FC551B5" class="sect4">示例：数据加密过程</h4>
                  <div>
                     <p><code class="codeph">DBMS_CRYPTO.SQL</code> PL / SQL程序可用于加密数据。
                     </p>
                     <p>此示例代码执行以下操作：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>首先将其转换为<code class="codeph">RAW</code>数据类型后，使用DES加密字符串（ <code class="codeph">VARCHAR2</code>类型）。
                           </p>
                           <p>此步骤是必需的，因为<code class="codeph">DBMS_CRYPTO</code>包中的加密和解密函数和过程<code class="codeph">DBMS_CRYPTO</code>适用于<code class="codeph">RAW</code>数据类型。
                           </p>
                        </li>
                        <li>
                           <p>演示如何使用SHA-1算法创建160位哈希。</p>
                        </li>
                        <li>
                           <p>演示如何使用MD5算法计算MAC（一种依赖于密钥的单向散列）。</p>
                        </li>
                     </ul>
                     <p><code class="codeph">DBMS_CRYPTO.SQL</code>过程如下：</p><pre class="oac_no_warn" dir="ltr">DECLARE input_string VARCHAR2（16）：='tigertigertigert'; raw_input RAW（128）：= UTL_RAW.CAST_TO_RAW（CONVERT（input_string，'AL32UTF8'，'US7ASCII'））; key_string VARCHAR2（8）：='scottsco'; raw_key RAW（128）：= UTL_RAW.CAST_TO_RAW（CONVERT（key_string，'AL32UTF8'，'US7ASCII'））; encrypted_raw RAW（2048）; encrypted_string VARCHAR2（2048）; decrypted_raw RAW（2048）; decrypted_string VARCHAR2（2048）; <span class="bold">- 开始测试加密：</span> BEGIN dbms_output.put_line（'&gt;输入字符串：'|| CONVERT（UTL_RAW.CAST_TO_VARCHAR2（raw_input），'US7ASCII'，'AL32UTF8'））; dbms_output.put_line（'&gt; ========= BEGIN TEST Encrypt ========='）; encrypted_raw：= dbms_crypto。加密（src =&gt; raw_input，typ =&gt; DBMS_CRYPTO.DES_CBC_PKCS5，key =&gt; raw_key）; dbms_output.put_line（'&gt;加密的十六进制值：'|| rawtohex（UTL_RAW.CAST_TO_RAW（encrypted_raw）））; decrypted_raw：= dbms_crypto。解密（src =&gt; encrypted_raw，typ =&gt; DBMS_CRYPTO.DES_CBC_PKCS5，key =&gt; raw_key）; decrypted_string：= CONVERT（UTL_RAW.CAST_TO_VARCHAR2（decrypted_raw），'US7ASCII'，'AL32UTF8'）; dbms_output.put_line（'&gt; Decrypted string output：'|| decrypted_string）; if input_string = decrypted_string THEN dbms_output.put_line（'&gt; String DES Encyption and Decryption successful'）;万一; DBMS_OUTPUT.PUT_LINE（ ''）; dbms_output.put_line（'&gt; ========= BEGIN TEST Hash ========='）; encrypted_raw：= dbms_crypto。哈希（src =&gt; raw_input，typ =&gt; DBMS_CRYPTO.HASH_SH1）; dbms_output.put_line（'&gt;输入字符串的哈希值：'|| rawtohex（UTL_RAW.CAST_TO_RAW（encrypted_raw）））; dbms_output.put_line（'&gt; ========= BEGIN TEST Mac ========='）; encrypted_raw：= dbms_crypto。Mac（src =&gt; raw_input，typ =&gt; DBMS_CRYPTO.HMAC_MD5，key =&gt; raw_key）; dbms_output.put_line（'&gt;消息验证码：'|| rawtohex（UTL_RAW.CAST_TO_RAW（encrypted_raw）））; DBMS_OUTPUT.PUT_LINE（ ''）; dbms_output.put_line（'&gt; DBMS_CRYPTO测试结束'）;结束; /</pre></div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="manually-encrypting-data.html#GUID-1A99FC75-E08B-46AA-BDB2-EDCCDBA714D1" title="使用数据加密API的示例包括使用DBMS_CRYPTO.SQL过程，加密AES 256位数据以及加密BLOB数据。">使用Data Encryption API的示例</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DBSEG336"></a><div class="props_rev_3"><a id="GUID-415A7D89-DE8F-438C-ABF5-49C3B90388E6" name="GUID-415A7D89-DE8F-438C-ABF5-49C3B90388E6"></a><h4 id="DBSEG-GUID-415A7D89-DE8F-438C-ABF5-49C3B90388E6" class="sect4">示例：AES 256位数据加密和解密过程</h4>
                  <div>
                     <p>您可以使用PL / SQL块来加密和解密预定义变量。</p>
                     <p>对于以下示例，预定义变量名为<code class="codeph">input_string</code> ，它使用带有密码块链接和PKCS＃5填充的AES 256位算法：</p><pre class="oac_no_warn" dir="ltr">declare input_string VARCHAR2（200）：='Secret Message'; output_string VARCHAR2（200）; encrypted_raw RAW（2000）; <span class="italic">- 存储加密的二进制文本</span> decrypted_raw RAW（2000）; <span class="italic">- 存储解密的二进制文本</span> num_key_bytes NUMBER：= 256/8; <span class="italic">- 密钥长度256位（32字节）</span> key_bytes_raw RAW（32）; <span class="italic">- 存储256位加密密钥</span> encryption_type PLS_INTEGER：= <span class="italic">- 总加密类型</span> DBMS_CRYPTO.ENCRYPT_AES256 + DBMS_CRYPTO.CHAIN_CBC + DBMS_CRYPTO.PAD_PKCS5;开始DBMS_OUTPUT.PUT_LINE（'原始字符串：'|| input_string）; key_bytes_raw：= DBMS_CRYPTO.RANDOMBYTES（num_key_bytes）; encrypted_raw：= DBMS_CRYPTO.ENCRYPT（src =&gt; UTL_I18N.STRING_TO_RAW（input_string，'AL32UTF8'），typ =&gt; encryption_type，key =&gt; key_bytes_raw）; <span class="bold">- 这里可以使用encrypted_raw变量中的加密值</span> ：decrypted_raw：= DBMS_CRYPTO.DECRYPT（src =&gt; encrypted_raw，typ =&gt; encryption_type，key =&gt; key_bytes_raw）; output_string：= UTL_I18N.RAW_TO_CHAR（decrypted_raw，'AL32UTF8'）; DBMS_OUTPUT.PUT_LINE（'Decrypted string：'|| output_string）;结束;</pre></div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="manually-encrypting-data.html#GUID-1A99FC75-E08B-46AA-BDB2-EDCCDBA714D1" title="使用数据加密API的示例包括使用DBMS_CRYPTO.SQL过程，加密AES 256位数据以及加密BLOB数据。">使用Data Encryption API的示例</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DBSEG337"></a><div class="props_rev_3"><a id="GUID-63CCAA8B-180C-4456-881F-F9F31A3D94AE" name="GUID-63CCAA8B-180C-4456-881F-F9F31A3D94AE"></a><h4 id="DBSEG-GUID-63CCAA8B-180C-4456-881F-F9F31A3D94AE" class="sect4">示例：BLOB数据的加密和解密过程</h4>
                  <div>
                     <p>您可以加密BLOB数据。</p>
                     <p>以下示例PL / SQL程序（ <code class="codeph">blob_test.sql</code> ）显示了如何加密和解密BLOB数据。此示例代码执行以下操作，并在每个步骤中打印出其进度（或问题）：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>为BLOB列创建一个表</p>
                        </li>
                        <li>
                           <p>将原始值插入该表中</p>
                        </li>
                        <li>
                           <p>加密原始数据</p>
                        </li>
                        <li>
                           <p>解密加密数据</p>
                        </li>
                     </ul>
                     <p><code class="codeph">blob_test.sql</code>过程如下：</p><pre class="oac_no_warn" dir="ltr"><span class="bold">-  1。为BLOB列创建一个表：</span> create table table_lob（id number，loc blob）; <span class="bold"> -  2。为src / enc / dec插入3个空的</span> lobs ：</span>插入table_lob值（1，EMPTY_BLOB（））;插入table_lob值（2，EMPTY_BLOB（））;插入table_lob值（3，EMPTY_BLOB（））;在declare srcdata RAW（1000）上设置set serveroutput上的echo; srcblob BLOB; encrypblob BLOB; encrypraw RAW（1000）;包围BINARY_INTEGER; decrypblob BLOB; decrypraw RAW（1000）; decrawlen BINARY_INTEGER; leng INTEGER; begin  -  RAW输入数据16字节srcdata：= hextoraw（'6D6D6D6D6D6D6D6D6D6D6D6D6D6D6D6D'）; DBMS_OUTPUT.PUT_LINE（ '---'）; dbms_output.put_line（'input is'|| srcdata）; DBMS_OUTPUT.PUT_LINE（ '---'）; - 为src / enc / dec选择空的lob定位器从table_lob中选择loc到srcblob，其中id = 1;从table_lob中选择loc into encrypblob，其中id = 2;从table_lob中选择loc into decrypblob，其中id = 3; dbms_output.put_line（'Created Empty LOBS'）; DBMS_OUTPUT.PUT_LINE（ '---'）; leng：= DBMS_LOB.GETLENGTH（srcblob）; IF leng IS NULL那么dbms_output.put_line（'Source BLOB Len NULL'）; ELSE dbms_output.put_line（'Source BLOB Len'|| leng）;万一; leng：= DBMS_LOB.GETLENGTH（encrypblob）; IF leng IS NULL那么dbms_output.put_line（'Encrypt BLOB Len NULL'）; ELSE dbms_output.put_line（'加密BLOB Len'|| leng）;万一; leng：= DBMS_LOB.GETLENGTH（decrypblob）; IF leng IS NULL那么dbms_output.put_line（'Decrypt BLOB Len NULL'）; ELSE dbms_output.put_line（'Decrypt BLOB Len'|| leng）;万一; <span class="bold"> -  3。将源原始数据写入blob：</span> DBMS_LOB.OPEN（srcblob，DBMS_LOB.lob_readwrite）; DBMS_LOB.WRITEAPPEND（srcblob，16，srcdata）; DBMS_LOB.CLOSE（srcblob）; dbms_output.put_line（'源原始数据写入源blob'）; DBMS_OUTPUT.PUT_LINE（ '---'）; leng：= DBMS_LOB.GETLENGTH（srcblob）; IF leng IS NULL那么dbms_output.put_line（'source BLOB Len NULL'）; ELSE dbms_output.put_line（'Source BLOB Len'|| leng）;万一; / * * Procedure Encrypt * Arguments：srcblob  - &gt; Source BLOB * encrypblob  - &gt;输出BLOB用于加密数据* DBMS_CRYPTO.AES_CBC_PKCS5  - &gt; Algo：AES * Chaining：CBC * Padding：PKCS5 * 256位密钥用于AES传递为RAW *  - &gt; HEXTORAW（ '000102030405060708090A0B0C0D0E0F101112131415161718191A1B1C1D1E1F'）* IV（初始化向量）的AES算法中作为RAW传递*  - &gt; HEXTORAW（ '00000000000000000000000000000000'）* / DBMS_CRYPTO.Encrypt（encrypblob，srcblob，DBMS_CRYPTO.AES_CBC_PKCS5，HEXTORAW（ '000102030405060708090A0B0C0D0E0F101112131415161718191A1B1C1D1E1F'），HEXTORAW （ '00000000000000000000000000000000'））; dbms_output.put_line（'Encryption Done'）; DBMS_OUTPUT.PUT_LINE（ '---'）; leng：= DBMS_LOB.GETLENGTH（encrypblob）; IF leng IS NULL那么dbms_output.put_line（'Encrypt BLOB Len NULL'）; ELSE dbms_output.put_line（'加密BLOB Len'|| leng）;万一; <span class="bold"> -  4。将encrypblob读取为raw：</span> encrawlen：= 999; DBMS_LOB.OPEN（encrypblob，DBMS_LOB.lob_readwrite）; DBMS_LOB.READ（encrypblob，encrawlen，1，encrypraw）; DBMS_LOB.CLOSE（encrypblob）; dbms_output.put_line（'读取加密blob到raw'）; DBMS_OUTPUT.PUT_LINE（ '---'）; dbms_output.put_line（'加密数据是（256位密钥）'|| encrypraw）; DBMS_OUTPUT.PUT_LINE（ '---'）; / * * Procedure Decrypt *参数：encrypblob  - &gt;加密BLOB解密* decrypblob  - &gt;输出BLOB用于RAW中的解密数据* DBMS_CRYPTO.AES_CBC_PKCS5  - &gt; Algo：AES *链接：CBC *填充：用于AES的PKCS5 * 256位密钥作为RAW（与加密期间使用的相同）*  - &gt; hextoraw（'000102030405060708090A0B0C0D0E0F101112131415161718191A1B1C1D1E1F'）*用于AES算法的IV（初始化向量）作为RAW传递（与加密期间使用的相同）*  - &gt; hextoraw（'00000000000000000000000000000000'）* / DBMS_CRYPTO。解密（decrypblob，encrypblob，DBMS_CRYPTO.AES_CBC_PKCS5，hextoraw（'000102030405060708090A0B0C0D0E0F101112131415161718191A1B1C1D1E1F'），hextoraw（'00000000000000000000000000000000'））; leng：= DBMS_LOB.GETLENGTH（decrypblob）; IF leng IS NULL那么dbms_output.put_line（'Decrypt BLOB Len NULL'）; ELSE dbms_output.put_line（'Decrypt BLOB Len'|| leng）;万一; - 将decrypblob读取为原始decrawlen：= 999; DBMS_LOB.OPEN（decrypblob，DBMS_LOB.lob_readwrite）; DBMS_LOB.READ（decrypblob，decrawlen，1，decrypraw）; DBMS_LOB.CLOSE（decrypblob）; dbms_output.put_line（'解密数据为（256位密钥）'|| decrypraw）; DBMS_OUTPUT.PUT_LINE（ '---'）; DBMS_LOB.OPEN（srcblob，DBMS_LOB.lob_readwrite）; DBMS_LOB.TRIM（srcblob，0）; DBMS_LOB.CLOSE（srcblob）; DBMS_LOB.OPEN（encrypblob，DBMS_LOB.lob_readwrite）; DBMS_LOB.TRIM（encrypblob，0）; DBMS_LOB.CLOSE（encrypblob）; DBMS_LOB.OPEN（decrypblob，DBMS_LOB.lob_readwrite）; DBMS_LOB.TRIM（decrypblob，0）; DBMS_LOB.CLOSE（decrypblob）;结束; / truncate table table_lob; drop table table_lob;</pre></div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="manually-encrypting-data.html#GUID-1A99FC75-E08B-46AA-BDB2-EDCCDBA714D1" title="使用数据加密API的示例包括使用DBMS_CRYPTO.SQL过程，加密AES 256位数据以及加密BLOB数据。">使用Data Encryption API的示例</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="DBSEG339"></a><a id="DBSEG338"></a><div class="props_rev_3"><a id="GUID-FE23ADE1-8140-4695-AC92-FE5085C16D6C" name="GUID-FE23ADE1-8140-4695-AC92-FE5085C16D6C"></a><h3 id="DBSEG-GUID-FE23ADE1-8140-4695-AC92-FE5085C16D6C" class="sect3">加密数据的数据字典视图</h3>
               <div>
                  <p>Oracle数据库提供数据字典视图以查找有关加密数据的信息。</p>
                  <p><a href="manually-encrypting-data.html#GUID-FE23ADE1-8140-4695-AC92-FE5085C16D6C__CHDGJHEG" title="加密视图">表15-2</a>列出了这些数据字典视图。
                  </p>
                  <div class="tblformalwide" id="GUID-FE23ADE1-8140-4695-AC92-FE5085C16D6C__CHDGJHEG">
                     <p class="titleintable">表15-2显示有关加密数据的信息的数据字典视图</p>
                     <table cellpadding="4" cellspacing="0" class="FormalWide" title="显示有关加密数据的信息的数据字典视图" width="100%" border="1" summary="Encryption Views" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="35%" id="d114414e3718">视图</th>
                              <th align="left" valign="bottom" width="65%" id="d114414e3721">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="35%" id="d114414e3726" headers="d114414e3718 ">
                                 <p><code class="codeph">ALL_ENCRYPTED_COLUMNS</code> 
                                 </p>
                              </td>
                              <td align="left" valign="top" width="65%" headers="d114414e3726 d114414e3721 ">
                                 <p>描述用户可访问的所有表中所有加密列的加密算法信息</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="35%" id="d114414e3735" headers="d114414e3718 ">
                                 <p><code class="codeph">DBA_ENCRYPTED_COLUMNS</code></p>
                              </td>
                              <td align="left" valign="top" width="65%" headers="d114414e3735 d114414e3721 ">
                                 <p>描述数据库中所有加密列的加密算法信息</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="35%" id="d114414e3743" headers="d114414e3718 ">
                                 <p><code class="codeph">USER_ENCRYPTED_COLUMNS</code></p>
                              </td>
                              <td align="left" valign="top" width="65%" headers="d114414e3743 d114414e3721 ">
                                 <p>描述用户模式中所有表中所有加密列的加密算法信息</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="35%" id="d114414e3751" headers="d114414e3718 ">
                                 <p><code class="codeph">V $ ENCRYPTED_TABLESPACES</code> 
                                 </p>
                              </td>
                              <td align="left" valign="top" width="65%" headers="d114414e3751 d114414e3721 ">
                                 <p>显示有关加密的当前可插拔数据库（PDB）表空间的信息</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="35%" id="d114414e3760" headers="d114414e3718 ">
                                 <p><code class="codeph">V $ ENCRYPTION_WALLET</code> 
                                 </p>
                              </td>
                              <td align="left" valign="top" width="65%" headers="d114414e3760 d114414e3721 ">
                                 <p>显示有关透明数据加密的钱包状态和钱包位置的信息;仅适用于当前的PDB</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="35%" id="d114414e3769" headers="d114414e3718 ">
                                 <p><code class="codeph">V $ RMAN_ENCRYPTION_ALGORITHMS</code></p>
                              </td>
                              <td align="left" valign="top" width="65%" headers="d114414e3769 d114414e3721 ">
                                 <p>显示当前PDB支持的加密算法</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-FE23ADE1-8140-4695-AC92-FE5085C16D6C__GUID-217EFD56-E5D1-4140-8B5E-1126917B5B61">
                     <p class="notep1">也可以看看：</p><a href="../refrn/index.html" target="_blank"><span><cite>Oracle Database Reference</cite></span></a>有关这些视图的详细信息</div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="manually-encrypting-data.html#GUID-B90F0869-1F69-45D9-A835-4985A19F7AB5" title="您可以使用DBMS_CRYPTO PL / SQL包手动加密数据。">手动加密数据</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
         </div>
      </article>
   </body>
</html>