<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>配置RMAN环境</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Backup and Recovery User&#39;s Guide"></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Backup and Recovery User&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="database-backup-and-recovery-users-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-09T05:20:45-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2003, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96241-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="starting-interacting-with-rman-client.html" title="Previous" type="text/html"></link>
      <link rel="next" href="configuring-rman-client-advanced.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database Backup and Recovery User&#39;s Guide"></meta>
    <meta name="dcterms.isVersionOf" content="BRADV"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="starting-interacting-with-rman-client.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="configuring-rman-client-advanced.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">备份和恢复用户指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="part-starting-configuring-rman.html" property="item" typeof="WebPage"><span property="name">启动和配置RMAN和闪回数据库</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">配置RMAN环境</li>
            </ol>
            <a id="GUID-5155F8E6-6E35-4261-9CC1-F12DAA9FAC5B" name="GUID-5155F8E6-6E35-4261-9CC1-F12DAA9FAC5B"></a><a id="BRADV8002"></a>
            
            <h2 id="BRADV-GUID-5155F8E6-6E35-4261-9CC1-F12DAA9FAC5B" class="sect2"><span class="enumeration_chapter">5</span>配置RMAN环境</h2>
         </header>
         <div class="ind">
            <div>
               <p>本章介绍配置RMAN所涉及的最基本任务。本章包含以下主题：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="configuring-rman-client-basic.html#GUID-AD92E09D-0788-4AB5-8792-5F969C8D237A" title="RMAN为执行基本备份和恢复所需的大多数参数提供合理的默认值。您可以修改默认参数的值或覆盖特定会话的这些值。">关于为RMAN备份配置环境</a></p>
                  </li>
                  <li>
                     <p><a href="configuring-rman-client-basic.html#GUID-215D0081-288D-4A90-92C2-1E9CA8AF0CAB" title="在大多数平台上，要备份到磁带等顺序介质并从中恢复，必须将介质管理软件与Oracle数据库集成。您可以将支持数据库和文件系统备份的Oracle Secure Backup用作磁带，作为媒体管理器。">配置RMAN以备份到介质管理器</a></p>
                  </li>
                  <li>
                     <p><a href="configuring-rman-client-basic.html#GUID-6F28089E-6D4E-4D6B-B96E-043C35D029D5" title="RMAN命令可用于将目标数据库备份到零数据丢失恢复设备（恢复设备）。将恢复设备用作目标数据库备份的集中存储库需要某些配置步骤。">配置RMAN以备份到恢复设备</a></p>
                  </li>
                  <li>
                     <p><a href="configuring-rman-client-basic.html#GUID-302339EC-EE0F-45FB-9862-BB2BA138AA13" title="快速恢复区域功能使您可以设置磁盘区域，数据库可以在该区域中创建和管理与备份和恢复相关的各种文件。强烈建议使用快速恢复区域。考虑将快速恢复区域配置为实施备份策略的第一步。">配置快速恢复区</a></p>
                  </li>
                  <li>
                     <p><a href="configuring-rman-client-basic.html#GUID-03DE4CF6-9D9F-4806-B5CA-CAA4CF5F2133" title="备份保留策略指定必须保留哪些备份以满足您的数据恢复要求。">配置备份保留策略</a></p>
                  </li>
                  <li>
                     <p><a href="configuring-rman-client-basic.html#GUID-914A65A7-872E-465B-95E5-0FD5ADAF6A9C" title="运行RMAN CONFIGURE命令以启用和禁用备份优化。如果备份了相同的文件或相同版本的文件，则备份优化会在某些情况下跳过文件备份。">备份优化和CONFIGURE命令</a></p>
                  </li>
                  <li>
                     <p><a href="configuring-rman-client-basic.html#GUID-FA142760-8ACB-43DA-939C-8407618D2D0F" title="您可以使用RMAN创建一个持久性配置，以管理归档重做日志何时有资格从磁盘中删除。">配置存档重做日志删除策略</a></p>
                  </li>
                  <li>
                     <p><a href="configuring-rman-client-basic.html#GUID-FDA66A53-B2AA-4C59-A142-C2F04016FAEF" title="如果在Data Guard环境中使用RMAN，则可以使用CONFIGURE命令在此环境中注册和配置物理数据库的设置。">在Data Guard环境中配置RMAN</a></p>
                  </li>
               </ul>
               <div class="infoboxnotealso" id="GUID-5155F8E6-6E35-4261-9CC1-F12DAA9FAC5B__GUID-4B47A9AA-4F10-4507-93C8-575ADE31B584">
                  <p class="notep1">也可以看看：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="configuring-rman-client-advanced.html#GUID-2210B194-FDA8-4BB4-BC1E-DBE7DBEACB4A" title="CONFIGURE CHANNEL命令用于配置RMAN通道选项。无论是手动分配通道还是使用自动通道分配，都可以使用通道命令和选项来控制行为。除了配置适用于特定类型的所有通道的参数外，还可以使用CONFIGURE命令配置适用于特定通道的参数。PARALLELISM设置不受特定配置通道数量的限制。备份选项使您可以控制备份大小，备份压缩和备份加密等方面。CONFIGURE MAXSETSIZE命令限制在通道上创建的备份集的大小。当使用BACKUP命令创建备份集时，此CONFIGURE设置适用于任何通道，无论是手动分配还是已配置。默认值以字节为单位，向下舍入为最低千字节值。当备份片大小超过文件系统或媒体管理软件允许的最大文件大小时，它是一个问题。您可以使用CONFIGURE CHANNEL或ALLOCATE CHANNEL命令的MAXPIECESIZE参数来限制备份片的大小。使用配置...BACKUP COPIES命令指定在指定类型的文件的指定设备类型上创建每个备份片的副本数。此类备份称为双工备份集。有时，您可能希望从常规备份计划的一部分中省略指定的表空间。使用CONFIGURE命令配置表空间排除。RMAN支持预压缩处理和备份集的二进制压缩。CONFIGURE COMPRESSION ALGORITHM命令可以配置压缩选项。通过合并每个数据块中的可用空间并将该空闲空间设置为二进制零来实现更好的备份压缩比。对于已经成为许多删除和插入操作主题的数据块，此预压缩处理阶段具有最大优势。相反，它对仍处于初始加载状态的数据块没有影响。Oracle数据库提供两类压缩算法：默认压缩算法和Oracle Advanced Compression选项提供的一组压缩算法。使用CONFIGURE命令配置默认压缩算法，该算法不需要Oracle Advanced Compression选项。为了提高安全性，您可以为RMAN备份集配置备份加密。如果未经授权的用户获取加密备份，则无法读取这些备份。V $ RMAN_ENCRYPTION_ALGORITHMS视图包含RMAN支持的加密算法列表。如果未指定加密算法，则默认加密算法为128位高级加密标准（AES）。如果所需的Oracle密钥管理基础结构可用，则透明加密可以在没有DBA干预的情况下创建和恢复加密备份。密码加密要求DBA在创建和还原加密备份时提供密码。恢复密码加密的备份需要使用与创建备份相同的密码。可以透明地或通过指定密码来恢复双模式加密备份。您可以使用CONFIGURE命令持久配置备份的透明加密。您可以使用CONFIGURE命令持久配置在编写备份集时用于加密的默认算法。在执行诸如数据文件表空间时间点恢复（TSPITR）或使用RMAN进行数据传输等操作时，您可能希望在辅助实例中设置数据文件的名称。在启动TSPITR或数据库复制之前设置这些名称。当RMAN需要控制文件的读取一致版本时，它会创建临时快照控制文件。在与恢复目录重新同步时或在备份当前控制文件时，RMAN需要快照控制文件。您可以通过运行SHOW命令查看当前快照位置。使用CONFIGURE SNAPSHOT CONTROLFILE NAME命令&#39;filepath&#39;命令更改快照控制文件的名称和路径。RMAN创建的后续快照控制文件使用指定的名称和路径。RMAN无法通过共享服务器调度程序连接到目标数据库。RMAN需要专用的服务器进程。当I / O子系统确认块写入完成时，会发生数据块丢失写入，但写入未在持久存储中发生。在随后的块读取中，I / O子系统返回数据块的陈旧版本，该版本可能用于更新数据库的其他块，从而破坏它。影子丢失写保护提供快速检测和对数据块丢失重写的即时响应，从而最大限度地减少数据丢失和数据库修复时间。使用影子丢失写保护不是必需的备用数据库。">配置RMAN环境：高级主题</a>以了解本章未涉及的配置选项，包括备份压缩和加密</p>
                     </li>
                     <li>
                        <p>有关为Oracle Secure Backup（OSB）云模块配置RMAN的信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=RCMRF90489" target="_blank"><span class="italic">Oracle数据库备份和恢复参考</span></a>中的附录C.
                        </p>
                     </li>
                  </ul>
               </div>
            </div><a id="BRADV99961"></a><div class="props_rev_3"><a id="GUID-AD92E09D-0788-4AB5-8792-5F969C8D237A" name="GUID-AD92E09D-0788-4AB5-8792-5F969C8D237A"></a><h3 id="BRADV-GUID-AD92E09D-0788-4AB5-8792-5F969C8D237A" class="sect3"><span class="enumeration_section">5.1</span>关于配置RMAN备份的环境</h3>
               <div>
                  <p>RMAN为执行基本备份和恢复所需的大多数参数提供合理的默认值。您可以修改默认参数的值或覆盖特定会话的这些值。</p>
                  <p>实施基于RMAN的备份策略时，如果您了解最常见的配置，则可以更有效地使用RMAN。</p>
                  <p>要简化RMAN的持续使用，可以为每个目标数据库设置多个持久性配置设置。这些设置控制RMAN行为的许多方面。例如，您可以配置备份保留策略，备份的默认目标，默认备份设备类型等。您可以使用<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=RCMRF154" target="_blank"><code class="codeph">SHOW</code></a>和<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=RCMRF113" target="_blank"><code class="codeph">CONFIGURE</code></a>命令查看和更改RMAN配置。
                  </p>
                  <p>本节介绍RMAN配置的内容以及如何使用<code class="codeph">CONFIGURE</code>命令更改备份和恢复环境的RMAN默认行为。本节还介绍了可用的主要设置及其更常见的值。
                  </p>
                  <div class="infoboxnote" id="GUID-AD92E09D-0788-4AB5-8792-5F969C8D237A__GUID-36E91B28-8C3C-4A5F-8130-EF9CC2F8BB69">
                     <p class="notep1">注意：</p>
                     <p>如果您计划备份到磁带，请参阅<a href="configuring-rman-client-basic.html#GUID-215D0081-288D-4A90-92C2-1E9CA8AF0CAB" title="在大多数平台上，要备份到磁带等顺序介质并从中恢复，必须将介质管理软件与Oracle数据库集成。您可以将支持数据库和文件系统备份的Oracle Secure Backup用作磁带，作为媒体管理器。">配置RMAN以备份到介质管理器</a> 。
                     </p>
                  </div>
                  <div class="infoboxnotealso" id="GUID-AD92E09D-0788-4AB5-8792-5F969C8D237A__GUID-A99BABA6-FBC7-4317-8E29-986FC08258C6">
                     <p class="notep1">也可以看看：</p>
                     <p> <code class="codeph">CONFIGURE</code>语法的<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=RCMRF113" target="_blank"><span><cite>Oracle数据库备份和恢复参考</cite></span></a></p>
                  </div>
               </div><a id="BRADV566"></a><a id="BRADV8124"></a><div class="props_rev_3"><a id="GUID-44DD1FEB-3A95-436C-ABF9-03921B778155" name="GUID-44DD1FEB-3A95-436C-ABF9-03921B778155"></a><h4 id="BRADV-GUID-44DD1FEB-3A95-436C-ABF9-03921B778155" class="sect4"><span class="enumeration_section">5.1.1</span>显示和清除持久性RMAN配置</h4>
                  <div>
                     <p>您可以使用<code class="codeph">SHOW</code>命令显示目标数据库的RMAN配置设置的当前值。您还可以查看这些命令当前是否设置为其默认值。
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-44DD1FEB-3A95-436C-ABF9-03921B778155__GUID-C8F05EC7-63D6-4CB4-B713-7E347590AC90">要查看或更改CONFIGURE命令设置：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>启动RMAN并连接到目标数据库和恢复目录（如果使用）。</span></li>
                        <li class="stepexpand"><span>运行RMAN <code class="codeph">SHOW</code>命令。</span><div>
                              <p>例如，运行<code class="codeph">SHOW ALL</code> ，如以下示例所示（包括示例输出）。输出包括您已更改的参数和设置为默认值的参数。配置显示为重新创建配置所需的一系列RMAN命令。您可以将输出保存在文本文件中，并使用此命令文件在相同或不同的数据库上重新创建配置。
                              </p><pre class="pre codeblock"><code>显示所有;具有db_unique_name PROD1的数据库的RMAN配置参数是：配置保留策略以恢复3天的窗口;配置备份优化;配置默认设备类型磁盘; #default CONFIGURE CONTROLFILE AUTOBACKUP ON; #default CONFIGURE CONTROLFILE AUTOBACKUP格式为设备类型SBT_TAPE为'％F'; #default CONFIGURE CONTROLFILE AUTOBACKUP FORMAT for DEVICE TYPE DISK TO'％F'; #default配置设备类型'SBT_TAPE'并行2备份类型到压缩后备箱;配置设备类型磁盘并行1备份类型到BACKUPSET; #default CONFIGURE DATAFILE BACKUP将设备类型SBT_TAPE复制为1; #default CONFIGURE DATAFILE BACKUP将设备类型磁盘复制为1; #default CONFIGURE ARCHIVELOG BACKUP复制设备类型SBT_TAPE为1; #default CONFIGURE ARCHIVELOG BACKUP将设备类型磁盘复制到1; #default CONFIGURE CHANNEL DEVICE TYPE'SBT_TAPE'PARMS'ENV =（OB_DEVICE = tape1）';配置MAXSETSIZE无限; #default配置数据库关闭加密; #default CONFIGURE ENCRYPTION ALGORITHM'AES128'; #default配置压缩算法'基本'作为释放'默认'优化负载真实; #default配置RMAN输出保持7天; #default CONFIGURE ARCHIVELOG DELETION POLICY TO NONE; #default CONFIGURE SNAPSHOT CONTROLFILE NAME为'/disk1/oracle/dbs/snapcf_ev.f'; #default</code></pre><p>您还可以将<code class="codeph">SHOW</code>命令与特定配置的名称一起使用。例如，您可以按如下方式查看保留策略和默认设备类型：</p><pre class="pre codeblock"><code>显示保留政策;显示默认设备类型;</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>（可选）使用<code class="codeph">CONFIGURE ...CLEAR</code>命令将任何配置恢复为其默认值，如以下示例所示：</span><div><pre class="pre codeblock"><code>配置备份优化清除;配置保留政策明确;配置CONTROLFILE AUTOBACKUP格式为设备类型磁盘清除;</code></pre></div>
                        </li>
                     </ol>
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-44DD1FEB-3A95-436C-ABF9-03921B778155__GUID-A1C92018-3525-4305-8296-A60750A785AA">
                           <p class="notep1">也可以看看：</p>
                           <p> <code class="codeph">SHOW</code>语法的<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=RCMRF154" target="_blank"><span><cite>Oracle数据库备份和恢复参考</cite></span></a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="BRADV162"></a><a id="BRADV163"></a><a id="BRADV89399"></a><div class="props_rev_3"><a id="GUID-3845B630-DD47-4147-BA6E-8D677CAF1CC2" name="GUID-3845B630-DD47-4147-BA6E-8D677CAF1CC2"></a><h4 id="BRADV-GUID-3845B630-DD47-4147-BA6E-8D677CAF1CC2" class="sect4"><span class="enumeration_section">5.1.2</span>配置备份的默认设备：磁盘或SBT</h4>
                  <div>
                     <p>未指定目标设备类型的备份将定向到已配置的默认设备。RMAN已预先配置为使用磁盘作为默认设备类型。无需其他配置。</p>
                     <div class="section">
                        <p>您可能需要将默认设备类型从磁盘更改为磁带，或将其从磁带更改为磁盘。<a href="configuring-rman-client-basic.html#GUID-3845B630-DD47-4147-BA6E-8D677CAF1CC2__CHDIDJIC" title="列出用于指定默认设备类型的命令。">表5-1</a>显示了配置默认设备的命令。
                        </p>
                        <div class="tblformal" id="GUID-3845B630-DD47-4147-BA6E-8D677CAF1CC2__CHDIDJIC">
                           <p class="titleintable">表5-1配置默认设备类型的命令</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="配置默认设备类型的命令" width="100%" border="1" summary="Lists commands to specify the default device type." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="33%" id="d22448e586">命令</th>
                                    <th align="left" valign="bottom" width="67%" id="d22448e589">说明</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="33%" id="d22448e594" headers="d22448e586 ">
                                       <p><code class="codeph">配置默认设备类型磁盘</code></p>
                                    </td>
                                    <td align="left" valign="top" width="67%" headers="d22448e594 d22448e589 ">
                                       <p>指定默认情况下备份将转到磁盘。</p>
                                       <p>如果启用了恢复区域，则备份位置默认为<a href="glossary.html#GUID-6E3CDD76-A573-4E5C-B12D-59C232C96C19"><span class="xrefglossterm">快速恢复区域</span></a> 。否则，备份位置默认为磁盘上特定于操作系统的目录。
                                       </p>
                                       <p>备份到磁盘时，数据库文件的逻辑块大小必须是目标设备的物理块大小的偶数倍。例如，块大小为2千字节的DISK类型的设备只能用作备份逻辑块大小为2 KB，4 KB，6 KB等的数据库文件的目标。大多数磁盘驱动器的物理块大小为512字节，因此此限制很少影响备份到磁盘驱动器。但是，备份到可写DVD或具有较大物理块大小的设备时，您可能会遇到此限制。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="33%" id="d22448e609" headers="d22448e586 ">
                                       <p><code class="codeph">配置默认设备类型为sbt</code></p>
                                    </td>
                                    <td align="left" valign="top" width="67%" headers="d22448e609 d22448e589 ">
                                       <p>指定默认情况下备份将转到磁带。</p>
                                       <p><span class="q">“ <a href="configuring-rman-client-basic.html#GUID-215D0081-288D-4A90-92C2-1E9CA8AF0CAB" title="在大多数平台上，要备份到磁带等顺序介质并从中恢复，必须将介质管理软件与Oracle数据库集成。您可以将支持数据库和文件系统备份的Oracle Secure Backup用作磁带，作为媒体管理器。">配置RMAN以备份到媒体管理器</a> ”</span>解释了如何设置RMAN以与媒体管理器一起使用。当RMAN可以与介质管理器通信时，您可以配置RMAN以备份到磁带并将<a href="glossary.html#GUID-2E48CE71-9547-4196-B715-5CE59033262E"><span class="xrefglossterm">SBT</span></a>指定为默认设备类型。
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                        <p>您始终可以使用<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=RCMRF107" target="_blank"><code class="codeph">BACKUP</code></a>命令的<code class="codeph">DEVICE</code> <code class="codeph">TYPE</code>子句覆盖默认设备，如以下示例所示：</p><pre class="pre codeblock"><code>备份设备类型sbt数据库;备份设备类型磁盘数据库;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-3845B630-DD47-4147-BA6E-8D677CAF1CC2__GUID-25373040-83C0-4D45-B69A-DF19CD7EE17B">要更改配置的默认设备类型：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li>
                           <p>启动RMAN并连接到目标数据库和恢复目录（如果使用）。</p>
                        </li>
                        <li>
                           <p>运行<code class="codeph">SHOW ALL</code>命令以显示当前配置的默认设备。
                           </p>
                        </li>
                        <li>
                           <p>运行<code class="codeph">CONFIGURE DEFAULT DEVICE TYPE</code>命令，指定<code class="codeph">TO DISK</code>或<code class="codeph">TO sbt</code> 。
                           </p>
                        </li>
                     </ol>
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-3845B630-DD47-4147-BA6E-8D677CAF1CC2__GUID-D3A68BD8-FA5E-479A-B644-BA2ECB3326BE">
                           <p class="notep1">也可以看看：</p>
                           <p>有关将<code class="codeph">BACKUP</code>命令与<code class="codeph">DEVICE</code> <code class="codeph">TYPE</code>子句一起使用的更多详细信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=RCMRF107" target="_blank"><span><cite>参见Oracle数据库备份和恢复参考</cite></span></a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="BRADV164"></a><a id="BRADV89400"></a><div class="props_rev_3"><a id="GUID-BC37B3E4-3338-4452-A363-DB882F2E9415" name="GUID-BC37B3E4-3338-4452-A363-DB882F2E9415"></a><h4 id="BRADV-GUID-BC37B3E4-3338-4452-A363-DB882F2E9415" class="sect4"><span class="enumeration_section">5.1.3</span>配置备份的默认类型：备份集或副本</h4>
                  <div>
                     <p><code class="codeph">BACKUP</code>命令可以创建备份集或映像副本。对于磁盘，您可以使用<code class="codeph">CONFIGURE DEVICE TYPE DISK BACKUP TYPE TO</code>命令将RMAN配置为创建备份集或映像副本作为其默认备份类型。
                     </p>
                     <div class="section">
                        <div class="infoboxnote" id="GUID-BC37B3E4-3338-4452-A363-DB882F2E9415__GUID-13388200-9291-465E-9A69-3E7E01C8AAFB">
                           <p class="notep1">注意：</p>
                           <p>由于RMAN只能将<a href="glossary.html#GUID-397CB99E-3F07-4980-96B3-9D0D0ABBABEA"><span class="xrefglossterm">映像副本</span></a>写入磁盘，因此磁带的备份类型只能是备份集。
                           </p>
                        </div>
                        <p>磁盘的默认备份类型是未压缩的<a href="glossary.html#GUID-6AA43E7D-9946-4C41-A62F-01E5BACEB8A7"><span class="xrefglossterm">备份集</span></a> 。
                        </p>
                        <p>RMAN可以使用<a href="glossary.html#GUID-90E07DCF-D038-4770-8A1A-06AF137C3762"><span class="xrefglossterm">二进制压缩</span></a>创建备份集。通过在<code class="codeph">BACKUP TYPE TO ...指定<code class="codeph">COMPRESSED</code>选项，您可以将RMAN配置为默认情况下在设备类型上使用压缩备份集<code class="codeph">BACKUP TYPE TO ...BACKUPSET</code>条款。要禁用压缩，请使用<code class="codeph">CONFIGURE DEVICE TYPE</code>命令和参数指定其他所需设置，但省略<code class="codeph">COMPRESSED</code>关键字。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-BC37B3E4-3338-4452-A363-DB882F2E9415__GUID-5027B2CF-B09D-49C3-8323-F31B93EC2A0E">要配置默认备份类型：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>启动RMAN并连接到目标数据库和恢复目录（如果使用）。</span></li>
                        <li class="stepexpand"><span>将备份集或映像副本配置为默认备份类型。</span><div>
                              <p>以下示例将磁盘备份的备份类型配置为副本和备份集：</p><pre class="pre codeblock"><code>配置设备类型磁盘备份类型复制; #priod CONFIGURE DEVICE TYPE DISK BACKUP TYPE TO BACKUPSET; #uncompressed</code></pre><p>以下示例配置备份集的压缩：</p><pre class="pre codeblock"><code>配置设备类型磁盘备份类型到压缩备份;配置设备类型sbt备份类型到压缩后备;</code></pre><div class="infoboxnotealso" id="GUID-BC37B3E4-3338-4452-A363-DB882F2E9415__GUID-4F1B7117-2D8A-4EAF-87D8-BDCEDDA388FD">
                                 <p class="notep1">也可以看看：</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p><a href="rman-backup-concepts.html#GUID-74FF41AF-D1EE-4DB1-AC0D-56FC83CAA91D" title="在RMAN中执行BACKUP命令时，您将创建一个或多个备份集或映像副本。默认情况下，无论目标是磁盘还是媒体管理器，RMAN都会创建备份集。">关于备份集</a></p>
                                    </li>
                                    <li>
                                       <p><a href="backing-up-database.html#GUID-E0D30989-9477-45DD-8FE1-367BDD0A7A8E" title="创建备份集时，可以通过在BACKUP命令中包含AS COMPRESSED BACKUPSET选项，使用RMAN支持对备份集进行二进制压缩。">进行压缩备份</a></p>
                                    </li>
                                 </ul>
                              </div>
                           </div>
                        </li>
                     </ol>
                  </div>
               </div><a id="BRADV89402"></a><div class="props_rev_3"><a id="GUID-911248BA-A742-426C-9B90-51214CFAF36B" name="GUID-911248BA-A742-426C-9B90-51214CFAF36B"></a><h4 id="BRADV-GUID-911248BA-A742-426C-9B90-51214CFAF36B" class="sect4"><span class="enumeration_section">5.1.4</span>配置通道</h4>
                  <div>
                     <p>RMAN通道是与数据库服务器会话的连接。RMAN使用通道执行大多数任务。</p>
                     <p>本节包含以下主题：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="configuring-rman-client-basic.html#GUID-06001DF9-43B5-4A93-BFBC-B03D718A8692" title="使用CONFIGURE CHANNEL命令配置磁盘或SBT通道的选项。您可以为设备类型配置通用通道设置，即用于根据该设备的已配置设置创建的任何通道的模板。">关于频道配置</a></p>
                        </li>
                        <li>
                           <p><a href="configuring-rman-client-basic.html#GUID-FAFF9171-43CF-493A-BA5A-AD9B59B2CFEB" title="默认情况下，RMAN为所有操作分配一个磁盘通道。您可以为此通道指定不同的选项，例如，备份的新默认位置。">配置磁盘通道</a></p>
                        </li>
                        <li>
                           <p><a href="configuring-rman-client-basic.html#GUID-C6D6E615-892F-4586-B14D-1BA42CB0C457" title="运行命令时可用于设备类型的通道数确定RMAN是并行读取还是写入。通常，执行命令时使用的通道数应与访问的设备数相匹配。">配置磁盘和SBT设备的并行通道</a></p>
                        </li>
                        <li>
                           <p><a href="configuring-rman-client-basic.html#GUID-1090ADE7-5B97-43FE-B9BA-B720C50CE6B7" title="如果在作业期间手动分配通道，则RMAN将忽略任何已配置的通道设置。">手动覆盖已配置的通道</a></p>
                        </li>
                     </ul>
                  </div><a id="BRADV89403"></a><div class="props_rev_3"><a id="GUID-06001DF9-43B5-4A93-BFBC-B03D718A8692" name="GUID-06001DF9-43B5-4A93-BFBC-B03D718A8692"></a><h5 id="BRADV-GUID-06001DF9-43B5-4A93-BFBC-B03D718A8692" class="sect5"><span class="enumeration_section">5.1.4.1</span>关于通道配置</h5>
                     <div>
                        <p>使用<code class="codeph">CONFIGURE</code> <code class="codeph">CHANNEL</code>命令配置磁盘或SBT通道的选项。您可以为设备类型配置通用通道设置，即用于根据该设备的已配置设置创建的任何通道的模板。
                        </p>
                        <div class="infoboxnote" id="GUID-06001DF9-43B5-4A93-BFBC-B03D718A8692__GUID-2E08C1B6-AEF3-4D0A-B072-CE10F95444A2">
                           <p class="notep1">注意：</p>
                           <p>本节介绍磁盘通道的配置。要了解如何为磁带配置通道，请参阅<a href="configuring-rman-client-basic.html#GUID-DB37EEF2-426B-4060-BA36-FEE38C11ADB8" title="配置SBT通道会创建一个持久性设置，该设置是用于使用媒体管理器进行备份和恢复操作的默认设置。">配置SBT通道以与介质管理器配合使用</a> 。
                           </p>
                        </div>
                        <p><code class="codeph">CONFIGURE</code> <code class="codeph">CHANNEL</code>使用与<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=RCMRF102" target="_blank"><code class="codeph">ALLOCATE CHANNEL</code></a>命令指定一次性选项相同的选项。
                        </p>
                        <p>如果使用<code class="codeph">CONFIGURE</code> <code class="codeph">CHANNEL</code>指定设备的通用通道设置，则即使设置没有冲突，也会丢弃之前的所有设置。例如，在第二个<code class="codeph">CONFIGURE</code> <code class="codeph">CHANNEL</code>命令（仅指定已配置磁盘通道的<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=RCMRF195" target="_blank"><code class="codeph">FORMAT</code></a> ，磁盘通道的<code class="codeph">MAXPIECESIZE</code>将返回其默认值：</p><pre class="oac_no_warn" dir="ltr">配置通道设备类型磁盘最大化2G;配置通道设备类型磁盘格式/ tmp /％U;</pre></div>
                  </div><a id="BRADV165"></a><a id="BRADV602"></a><a id="BRADV89404"></a><div class="props_rev_3"><a id="GUID-FAFF9171-43CF-493A-BA5A-AD9B59B2CFEB" name="GUID-FAFF9171-43CF-493A-BA5A-AD9B59B2CFEB"></a><h5 id="BRADV-GUID-FAFF9171-43CF-493A-BA5A-AD9B59B2CFEB" class="sect5"><span class="enumeration_section">5.1.4.2</span>配置磁盘通道</h5>
                     <div>
                        <p>默认情况下，RMAN为所有操作分配一个磁盘通道。您可以为此通道指定不同的选项，例如，备份的新默认位置。</p>
                        <div class="example" id="GUID-FAFF9171-43CF-493A-BA5A-AD9B59B2CFEB__CHDDEHCC">
                           <p class="titleinexample">示例5-1配置非默认备份位置</p>
                           <p>此示例将RMAN配置为将磁盘备份写入<code class="codeph">/disk1</code>目录，并为相对文件名指定非默认格式。
                           </p><pre class="pre codeblock"><code>CONFIGURE CHANNEL DEVICE TYPE DISK FORMAT'/ disk1 / ora_df％t_s％s_s％p';</code></pre><p>RMAN自动将格式说明符<code class="codeph">%t</code>替换为四字节时间戳， <code class="codeph">%s</code>表示备份集编号， <code class="codeph">%p</code>表示备份表编号。
                           </p>
                           <div class="infoboxnote" id="GUID-FAFF9171-43CF-493A-BA5A-AD9B59B2CFEB__GUID-9AE42905-DFA8-407D-8499-80EE084CDCA6">
                              <p class="notep1">注意：</p>
                              <p>为磁盘通道配置显式格式时，RMAN默认情况下不会在<a href="glossary.html#GUID-6E3CDD76-A573-4E5C-B12D-59C232C96C19"><span class="xrefglossterm">快速恢复区域中</span></a>创建备份。在这种情况下，您将丢失快速恢复区域的磁盘空间管理功能。
                              </p>
                           </div>
                        </div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-FAFF9171-43CF-493A-BA5A-AD9B59B2CFEB__BGBDHBEF">
                           <p class="titleinexample">示例5-2配置ASM磁盘位置</p>
                           <p>此示例演示如何配置ASM磁盘位置。</p><pre class="pre codeblock"><code>CONFIGURE CHANNEL DEVICE TYPE DISK FORMAT'+ dgroup1';</code></pre><div class="infoboxnotealso" id="GUID-FAFF9171-43CF-493A-BA5A-AD9B59B2CFEB__GUID-146E49DF-3C3E-42F1-8336-B49CB8917F31">
                              <p class="notep1">也可以看看：</p>
                              <p><a href="backing-up-database.html#GUID-344F4D14-AC81-4093-B921-6403EE75112C" title="您可以在装入或打开数据库的情况下执行整个数据库备份。您可以使用BACKUP TABLESPACE命令备份一个或多个表空间，或使用BACKUP DATAFILE命令备份一个或多个数据文件。您可以在装入或打开数据库时备份控制文件。RMAN使用快照控制文件来确保读取一致的版本。控制文件的手动备份与控制文件自动备份不同。在备份BACKUP命令中指定的文件后，RMAN会进行控制文件自动备份。要进行手动备份，可以在备份其他文件时指定INCLUDE CURRENT CONTROLFILE或指定BACKUP CURRENT CONTROLFILE。在某些情况下，RMAN会自动备份当前服务器参数文件。BACKUP SPFILE命令显式备份参数文件。备份的服务器参数文件是实例当前使用的文件。只有在数据库关闭且处于一致状态时，才能以NOARCHIVELOG模式备份数据库。预打印备份确保在将非CDB作为PDB插入CDB后可以使用RMAN备份。">使用RMAN备份数据库文件</a>以了解如何进行备份</p>
                           </div>
                        </div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="BRADV166"></a><a id="BRADV568"></a><a id="BRADV89405"></a><div class="props_rev_3"><a id="GUID-C6D6E615-892F-4586-B14D-1BA42CB0C457" name="GUID-C6D6E615-892F-4586-B14D-1BA42CB0C457"></a><h5 id="BRADV-GUID-C6D6E615-892F-4586-B14D-1BA42CB0C457" class="sect5"><span class="enumeration_section">5.1.4.3</span>配置磁盘和SBT设备的并行通道</h5>
                     <div>
                        <p>运行命令时可用于设备类型的通道数确定RMAN是并行读取还是写入。通常，执行命令时使用的通道数应与访问的设备数相匹配。</p>
                        <div class="section">
                           <p>对于磁带备份，为每个磁带驱动器分配一个通道。对于磁盘备份，请为每个物理磁盘分配一个通道，除非您可以针对具有多个通道的磁盘子系统体系结构优化备份。在I / O操作期间，未能分配正确数量的通道会对RMAN性能产生负面影响。</p>
                           <p>您可以配置<a href="glossary.html#GUID-57D1A253-9620-4588-82E3-EC2BEC2B1B0C"><span class="xrefglossterm">通道并行度</span></a>设置，备份集的<a href="glossary.html#GUID-90E07DCF-D038-4770-8A1A-06AF137C3762"><span class="xrefglossterm">二进制压缩</span></a>以及<code class="codeph">CONFIGURE</code> <code class="codeph">DEVICE</code> <code class="codeph">TYPE</code> <code class="codeph">sbt</code>的<a href="glossary.html#GUID-2E48CE71-9547-4196-B715-5CE59033262E"><span class="xrefglossterm">SBT</span></a>设备的其他选项。您可以独立于通道配置设置设备类型的配置。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-C6D6E615-892F-4586-B14D-1BA42CB0C457__CHDGCAFE">
                           <p class="titleinexample">例5-3配置SBT设备的并行性</p>
                           <p>此示例更改SBT设备（包括示例输出），以便RMAN可以使用两个并行的磁带驱动器备份到介质管理器。每个配置的SBT通道备份大约一半的总数据。</p><pre class="pre codeblock"><code>RMAN&gt; CONFIGURE DEVICE TYPE sbt PARALLELISM 2;旧的RMAN配置参数：配置设备类型'SBT_TAPE'备份类型到压缩备用并行1;新的RMAN配置参数：配置设备类型'SBT_TAPE'并行2备份类型到压缩后备箱;成功存储新的RMAN配置参数</code></pre></div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-C6D6E615-892F-4586-B14D-1BA42CB0C457__CHDEGICJ">
                           <p class="titleinexample">示例5-4配置SBT设备的备份类型</p>
                           <p>此示例将SBT设备的默认备份类型更改为未压缩的备份集（包括样本输出）。</p>
                           <p>本示例中使用的<code class="codeph">CONFIGURE DEVICE TYPE</code>命令仅影响并行度和备份类型，不会影响未指定的设置值。在<a href="configuring-rman-client-basic.html#GUID-C6D6E615-892F-4586-B14D-1BA42CB0C457__CHDGCAFE">示例5-3中</a> ，通过更改并行度设置未更改压缩备份集的默认备份类型。在此示例中，更改默认备份类型不会影响并行使用多个磁带驱动器的能力。
                           </p><pre class="pre codeblock"><code>RMAN&gt;配置设备类型sbt BACKUP TYPE TO BACKUPSET;旧的RMAN配置参数：配置设备类型'SBT_TAPE'并行2备份类型到压缩备用;新的RMAN配置参数：配置设备类型'SBT_TAPE'备份类型为BACKUPSET PARALLELISM 2;成功存储新的RMAN配置参数</code></pre><div class="infoboxnotealso" id="GUID-C6D6E615-892F-4586-B14D-1BA42CB0C457__GUID-B73AFCC8-FCD2-4F9B-BD36-953A8446EBDA">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><a href="backing-up-database.html#GUID-D9A1870F-E5E4-48DD-B479-C55C09B59388" title="备份到磁盘时，您可以指定一种格式以将备份分布在多个驱动器上以提高性能。">为磁盘备份指定多种格式</a>以了解如何并行进行磁盘备份</p>
                                 </li>
                                 <li>
                                    <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=RCMRF107" target="_blank"><span><cite>Oracle数据库备份和恢复参考</cite></span></a> ，以获取有关<code class="codeph">BACKUP</code>命令的<code class="codeph">CHANNEL</code>参数的参考资料</p>
                                 </li>
                                 <li>
                                    <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=RACAD7321" target="_blank"><span><cite>“Oracle Real Application Clusters管理和部署指南”</cite></span></a> ，了解有关利用Oracle Real Application Clusters（Oracle RAC）配置中的并行操作的信息</p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="BRADV89406"></a><div class="props_rev_3"><a id="GUID-1090ADE7-5B97-43FE-B9BA-B720C50CE6B7" name="GUID-1090ADE7-5B97-43FE-B9BA-B720C50CE6B7"></a><h5 id="BRADV-GUID-1090ADE7-5B97-43FE-B9BA-B720C50CE6B7" class="sect5"><span class="enumeration_section">5.1.4.4</span>手动覆盖已配置的通道</h5>
                     <div>
                        <p>如果在作业期间手动分配通道，则RMAN将忽略任何已配置的通道设置。</p>
                        <div class="section">
                           <p class="subhead3" id="GUID-1090ADE7-5B97-43FE-B9BA-B720C50CE6B7__GUID-B32E29A0-7293-4058-8AF3-6F95E0D2FF86">要手动覆盖已配置的频道：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>假设默认设备类型是SBT。运行以下命令以覆盖默认配置。</p><pre class="pre codeblock"><code>运行{ALLOCATE CHANNEL c1设备类型磁盘; BACKUP TABLESPACE用户; }</code></pre><p>在这种情况下，RMAN仅使用您在<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=RCMRF151" target="_blank"><code class="codeph">RUN</code></a>命令中手动分配的磁盘通道，覆盖使用“ <code class="codeph">CONFIGURE</code> <code class="codeph">DEVICE</code> <code class="codeph">TYPE</code> ，“ <code class="codeph">CONFIGURE</code> <code class="codeph">DEFAULT</code> <code class="codeph">DEVICE</code> ”或“ <code class="codeph">CONFIGURE</code> <code class="codeph">CHANNEL</code>设置设置的任何默认值。
                                 </p>
                              </li>
                           </ul>
                           <div class="infoboxnotealso" id="GUID-1090ADE7-5B97-43FE-B9BA-B720C50CE6B7__GUID-A7E5373B-006C-4B6B-B2B0-56526FA1A2E4">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><a href="rman-architecture.html#GUID-282FD0B6-8593-4775-9965-DB47534D349C" title="RMAN信道表示到设备的一个数据流，并且对应于一个数据库服务器会话。在备份或恢复操作期间，通道从输入设备读取数据，对其进行处理，并将其写入输出设备。">关于RMAN频道</a> ，了解已配置和分配的频道</p>
                                 </li>
                                 <li>
                                    <p>适用于<code class="codeph">ALLOCATE CHANNEL</code>语法的<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=RCMRF102" target="_blank"><span><cite>Oracle数据库备份和恢复参考</cite></span></a></p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">CONFIGURE</code>语法的<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=RCMRF113" target="_blank"><span><cite>Oracle数据库备份和恢复参考</cite></span></a></p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div><a id="BRADV89407"></a><div class="props_rev_3"><a id="GUID-98BA7492-7108-4DF9-B5A2-21957072E308" name="GUID-98BA7492-7108-4DF9-B5A2-21957072E308"></a><h4 id="BRADV-GUID-98BA7492-7108-4DF9-B5A2-21957072E308" class="sect4"><span class="enumeration_section">5.1.5</span>配置控制文件和服务器参数文件自动备份</h4>
                  <div>
                     <p>您可以配置RMAN以自动备份控制文件和服务器参数文件。每当添加备份记录时都会发生自动备份。</p>
                     <div class="section">
                        <p>如果数据库以<code class="codeph">ARCHIVELOG</code>模式运行，则只要控制文件中的数据库结构元数据发生更改，也会执行自动备份。即使当前控制文件，恢复目录和服务器参数文件丢失， <a href="glossary.html#GUID-7CDA6567-DFB0-450D-8771-B033E9872AF7"><span class="xrefglossterm">控制文件自动备份也</span></a>会使RMAN恢复数据库。
                        </p>
                        <p>由于自动备份的文件名遵循众所周知的格式，因此RMAN可以在不访问存储库的情况下搜索它，然后还原服务器参数文件。使用还原的服务器参数文件启动实例后，RMAN可以从自动备份还原控制文件。挂载控制文件后，RMAN存储库可用，RMAN可以还原数据文件并查找存档的重做日志。</p>
                        <p><span class="bold">要启用自动备份功能：</span></p><pre class="pre codeblock"><code>配置CONTROLFILE AUTOBACKUP ON;</code></pre><p><span class="bold">要禁用自动备份功能：</span></p><pre class="pre codeblock"><code>配置CONTROLFILE AUTOBACKUP OFF;</code></pre><p>默认情况下，对于将<code class="codeph">COMPATIBLE</code>初始化参数设置为12.2或更高的CDB和独立数据库，将打开控制文件自动备份。
                        </p>
                        <div class="infoboxnotealso" id="GUID-98BA7492-7108-4DF9-B5A2-21957072E308__GUID-AFB214A7-50F4-45C9-955F-FBA383C136C6">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><a href="rman-backup-concepts.html#GUID-95840C84-1595-49AC-923D-310DA750676B" title="在许多恢复情况下，最近备份控制文件和服务器参数文件非常有用。为确保您备份这些文件，数据库支持控制文件和服务器参数文件自动备份。">关于RMAN控制文件和服务器参数文件自动备份</a></p>
                              </li>
                              <li>
                                 <p><code class="codeph">CONFIGURE</code>语法的<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=RCMRF113" target="_blank"><span><cite>Oracle数据库备份和恢复参考</cite></span></a></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div><a id="BRADV8101"></a><div class="props_rev_3"><a id="GUID-C64AE090-0749-43EA-92C4-69DC6201A15F" name="GUID-C64AE090-0749-43EA-92C4-69DC6201A15F"></a><h5 id="BRADV-GUID-C64AE090-0749-43EA-92C4-69DC6201A15F" class="sect5"><span class="enumeration_section">5.1.5.1</span>配置控制文件自动备份格式</h5>
                     <div>
                        <p>默认情况下，所有已配置设备的自动备份文件的格式是FORMAT子句中的替换变量<code class="codeph">%F</code> 。
                        </p>
                        <div class="section">
                           <p><code class="codeph">%F</code>变量格式转换为<span class="italic"><code class="codeph">c-IIIIIIIIII-YYYYMMDD-QQ</code></span> ，占位符定义如下：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><span class="italic"><code class="codeph">IIIIIIIIII</code></span>代表DBID。</p>
                              </li>
                              <li>
                                 <p><span class="italic"><code class="codeph">YYYYMMDD</code></span>是生成备份的时间戳。
                                 </p>
                              </li>
                              <li>
                                 <p><span class="italic"><code class="codeph">QQ</code></span>是十六进制序列，以<code class="codeph">00</code>开头，最大为<code class="codeph">FF</code> 。</p>
                              </li>
                           </ul>
                           <p>要更改自动备份文件的默认格式：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>使用以下命令，其中<span class="italic"><code class="codeph">deviceSpecifier</code></span>是任何有效的设备类型，' <span class="italic"><code class="codeph">string</code></span> '必须包含替换变量<code class="codeph">%F</code> （并且没有其他替换变量），并且是指定设备的有效句柄：</p><pre class="pre codeblock"><code>CONFIGURE CONTROLFILE AUTOBACKUP格式设备类型<span class="italic">deviceSpecifier</span> TO ' <span class="italic">串</span> ';</code></pre><p>例如，您可以运行以下命令为控制文件自动备份指定非默认文件名。在文件名中， <code class="codeph">?</code> 代表<code class="codeph">ORACLE_HOME</code> 。</p><pre class="pre codeblock"><code>设备类型磁盘的配置控制文件自动包装格式为'？/ ORADATA / cf_％F';</code></pre><p>以下示例将自动备份配置为写入自动存储管理磁盘组：</p><pre class="pre codeblock"><code>设备类型磁盘的配置控制文件自动包装格式为'+ dgroup1 /％F';</code></pre></li>
                           </ul>
                           <div class="infoboxnote" id="GUID-C64AE090-0749-43EA-92C4-69DC6201A15F__GUID-617A138B-8098-458B-B12A-0521B5907E3C">
                              <p class="notep1">注意：</p>
                              <p>控制文件自动备份的有效格式为： <code class="codeph">%D</code> ， <code class="codeph">%I</code> ， <code class="codeph">%M</code> ， <code class="codeph">%Y</code> ， <code class="codeph">%F</code> ， <code class="codeph">%T</code> ， <code class="codeph">%d</code>和<code class="codeph">%n</code> 。如果使用除这些之外的格式，则可能无法还原控制文件自动备份。
                              </p>
                           </div>
                           <p>要清除设备的控制文件自动备份格式：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>，使用以下命令：</p><pre class="pre codeblock"><code>配置CONTROLFILE AUTOBACKUP格式为设备类型磁盘清除;配置CONTROLFILE AUTOBACKUP格式为设备类型sbt CLEAR;</code></pre></li>
                           </ul>
                           <p>如果已为数据库设置了<a href="glossary.html#GUID-6E3CDD76-A573-4E5C-B12D-59C232C96C19"><span class="xrefglossterm">快速恢复区域</span></a> ，则可以通过清除磁盘的控制文件自动备份格式将控制文件自动备份定向到快速恢复区域。
                           </p>
                           <div class="infoboxnote" id="GUID-C64AE090-0749-43EA-92C4-69DC6201A15F__GUID-7E11ECA8-B5D9-4826-877A-73B07200478C">
                              <p class="notep1">注意：</p>
                              <p>快速恢复区域中的所有文件均由Oracle数据库维护，相关文件名以Oracle托管文件（OMF）格式维护。</p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="BRADV89408"></a><div class="props_rev_3"><a id="GUID-B04B5550-6DF9-4FDE-A03A-CFDF57518264" name="GUID-B04B5550-6DF9-4FDE-A03A-CFDF57518264"></a><h5 id="BRADV-GUID-B04B5550-6DF9-4FDE-A03A-CFDF57518264" class="sect5"><span class="enumeration_section">5.1.5.2</span>覆盖已配置的控制文件自动备份格式</h5>
                     <div>
                        <p><code class="codeph">SET CONTROLFILE AUTOBACKUP FORMAT</code>命令可以在<code class="codeph">RUN</code>命令或RMAN提示符下指定，仅在当前会话中覆盖已配置的自动备份格式。
                        </p>
                        <div class="section">
                           <p>优先顺序是：</p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li><span><code class="codeph">SET CONTROLFILE AUTOBACKUP FORMAT</code> （在<code class="codeph">RUN</code>块内<code class="codeph">)</code></span></li>
                           <li><span><code class="codeph">SET CONTROLFILE AUTOBACKUP FORMAT</code> （在<code class="codeph">RMAN</code>提示符下）</span></li>
                           <li><span><code class="codeph">配置CONTROLFILE AUTOBACKUP格式</code></span></li>
                        </ol>
                        <div class="section">
                           <p>以下示例显示了<code class="codeph">SET</code> <code class="codeph">CONTROLFILE</code> <code class="codeph">AUTOBACKUP</code> <code class="codeph">FORMAT</code>的两种形式如何交互：</p><pre class="oac_no_warn" dir="ltr">将DEVICE TYPE DISK的SET CONTROLFILE AUTOBACKUP格式设置为'controlfile_％F';备份为复制数据库;运行设备类型磁盘的SET SETFILE AUTOBACKUP格式为'/tmp/%F.bck';备份为BACKUPSET设备类型磁盘数据库; }</pre><p>第一个<code class="codeph">SET CONTROLFILE AUTOBACKUP FORMAT</code>控制控制文件自动备份的名称，直到RMAN客户端退出，覆盖任何已配置的控制文件自动备份格式。所述<code class="codeph">SET CONTROFILE AUTOBACKUP FORMAT</code>在<code class="codeph">RUN</code>块覆盖<code class="codeph">SET CONTROLFILE AUTOBACKUP FORMAT</code>外部<code class="codeph">RUN</code>为的持续时间块<code class="codeph">RUN</code>块。
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div>
            </div><a id="BRADV132"></a><div class="props_rev_3"><a id="GUID-215D0081-288D-4A90-92C2-1E9CA8AF0CAB" name="GUID-215D0081-288D-4A90-92C2-1E9CA8AF0CAB"></a><h3 id="BRADV-GUID-215D0081-288D-4A90-92C2-1E9CA8AF0CAB" class="sect3"><span class="enumeration_section">5.2</span>配置RMAN备份到媒体管理器</h3>
               <div>
                  <p>在大多数平台上，要备份到磁带等顺序介质并从中恢复，必须将介质管理软件与Oracle数据库集成。您可以将支持数据库和文件系统备份的Oracle Secure Backup用作磁带，作为媒体管理器。</p>
                  <div class="section">
                     <div class="infoboxnote" id="GUID-215D0081-288D-4A90-92C2-1E9CA8AF0CAB__GUID-99861407-AB66-4871-81F6-26387AA1660F">
                        <p class="notep1">注意：</p>
                        <p>您还可以使用第三方媒体管理器。本节介绍配置RMAN以与第三方介质管理器配合使用的一般步骤。实际步骤取决于您安装的介质管理产品以及运行数据库的平台。如果您选择将RMAN与Oracle Secure Backup以外的介质管理器一起使用，则必须从供应商处获取所有特定于产品的信息。</p>
                     </div>
                     <p>配置RMAN以与媒体管理器一起使用：</p>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>确保满足使用媒体管理器的先决条件，如<span class="q">“ <a href="configuring-rman-client-basic.html#GUID-B46C2D03-78D2-4880-8D47-57B2BD8C84C9">使用带有RMAN的媒体管理器的先决条件</a> ”中所述</span></span></li>
                     <li class="stepexpand"><span>确定用于与顺序介质通信的介质管理库的位置，如<span class="q">“ <a href="configuring-rman-client-basic.html#GUID-E9AE6653-6F60-4ED6-8AC1-7C6A31C9321F" title="在尝试将RMAN与媒体管理器一起使用之前，请确定媒体管理库的位置。">确定介质管理库的位置</a> ”中所述</span></span></li>
                     <li class="stepexpand"><span>按照<span class="q">“ <a href="configuring-rman-client-basic.html#GUID-56142138-9032-4454-B289-8A67A577682F" title="After installing the media management software, perform the configuration required by your vendor so that the software can accept RMAN backups.">为RMAN备份配置介质管理软件</a> ”中的说明<a href="configuring-rman-client-basic.html#GUID-56142138-9032-4454-B289-8A67A577682F" title="安装介质管理软件后，请执行供应商所需的配置，以便软件可以接受RMAN备份。">配置介质管理软件</a></span></span></li>
                     <li class="stepexpand"><span>检查RMAN是否可以使用媒体管理器创建备份，如<span class="q">“ <a href="configuring-rman-client-basic.html#GUID-8AD950E0-2C8C-42A1-884F-B416CBE06CB0" title="确认数据库服务器可以加载介质管理库之后，请进行测试以确保RMAN可以备份到介质管理器。">测试媒体管理器库是否正确集成</a> ”中所述</span></span></li>
                     <li class="stepexpand"><span>配置可用作所有磁带备份的默认值的RMAN通道，如<span class="q">“ <a href="configuring-rman-client-basic.html#GUID-DB37EEF2-426B-4060-BA36-FEE38C11ADB8" title="配置SBT通道会创建一个持久性设置，该设置是用于使用媒体管理器进行备份和恢复操作的默认设置。">配置与介质管理器一起使用的SBT通道</a> ”中所述</span></span><div>
                           <div class="infoboxnotealso" id="GUID-215D0081-288D-4A90-92C2-1E9CA8AF0CAB__GUID-5602B1AD-1753-4B5A-AF8A-C00552A918F1">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><a href="rman-architecture.html#GUID-12A32971-242E-4C62-AE95-26D58D5C983D" title="Oracle媒体管理层（MML）API允许第三方供应商构建与RMAN配合使用的媒体管理软件，以允许备份到磁带驱动器等顺序媒体设备。">关于媒体管理使用RMAN</a>概述媒体管理软件及其对RMAN的影响</p>
                                 </li>
                                 <li>
                                    <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=OBADM183" target="_blank"><span class="italic">Oracle Secure Backup管理员指南</span></a> ，了解如何设置RMAN以专门用于Oracle Secure Backup</p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                     </li>
                  </ol>
               </div><a id="BRADV89409"></a><div class="props_rev_3"><a id="GUID-B46C2D03-78D2-4880-8D47-57B2BD8C84C9" name="GUID-B46C2D03-78D2-4880-8D47-57B2BD8C84C9"></a><h4 id="BRADV-GUID-B46C2D03-78D2-4880-8D47-57B2BD8C84C9" class="sect4"><span class="enumeration_section">5.2.1</span>将媒体管理器与RMAN一起使用的先决条件</h4>
                  <div>
                     <p>在开始将RMAN与第三方媒体管理器一起使用之前，必须安装媒体管理器并确保RMAN可以与之通信。有关说明，请参阅介质管理供应商的软件文档。</p>
                     <p>通常，首先在目标主机或生产网络上安装和配置介质管理软件。确保您可以在目标数据库主机上对Hi操作系统文件进行非RMAN备份。通过确认媒体管理器与目标主机的基本集成是否成功，此步骤使后续故障排除变得更加容易。请参阅媒体管理文档，了解如何在不使用RMAN的情况下将文件备份到媒体管理器。</p>
                     <p>然后，获取并安装第三方介质管理模块以与数据库服务器集成。此模块包含Oracle数据库在访问媒体管理器时加载和使用的<a href="glossary.html#GUID-AAB3332C-E54E-49E3-9FFB-C2ED6232FA43"><span class="xrefglossterm">媒体管理库</span></a> 。它通常是第三方产品，必须单独购买。有关详细信息，请联系您的媒体管理
                     </p>
                  </div>
               </div><a id="BRADV89410"></a><div class="props_rev_3"><a id="GUID-E9AE6653-6F60-4ED6-8AC1-7C6A31C9321F" name="GUID-E9AE6653-6F60-4ED6-8AC1-7C6A31C9321F"></a><h4 id="BRADV-GUID-E9AE6653-6F60-4ED6-8AC1-7C6A31C9321F" class="sect4"><span class="enumeration_section">5.2.2</span>确定媒体管理库的位置</h4>
                  <div>
                     <p>在尝试将RMAN与媒体管理器一起使用之前，请确定媒体管理库的位置。</p>
                     <div class="p">
                        <p>为RMAN分配或配置用于与媒体管理器通信的<a href="glossary.html#GUID-D7D8E7D7-3CD3-4FCF-AF75-AF2BE11A366F"><span class="xrefglossterm">通道时</span></a> ，必须在<code class="codeph">ALLOCATE CHANNEL</code>或<code class="codeph">CONFIGURE CHANNEL</code>命令中指定<code class="codeph">SBT_LIBRARY</code>参数。<code class="codeph">SBT_LIBRARY</code>参数指定库的路径。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>当RMAN分配通道与介质管理器通信时，它会尝试加载<code class="codeph">SBT_LIBRARY</code>参数指示的库。如果未在已分配或预配置的通道中为<code class="codeph">SBT_LIBRARY</code>参数提供值，则RMAN将查找特定于平台且受保护的默认位置。
                        </p>
                        <p>在Linux和UNIX上，SBT库从以下位置加载：</p><pre class="oac_no_warn" dir="ltr">/opt/oracle/extapi/[32,64]/{SBT}/{VENDOR}/{VERSION}/libobk.so</pre><p>SBT库文件扩展名根据平台而有所不同：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>HP-UX上的<code class="codeph">.so</code> ， <code class="codeph">.sl</code> ，</p>
                           </li>
                           <li>
                              <p><code class="codeph">.a</code>在AIX上，</p>
                           </li>
                        </ul>
                        <p>在Windows上，SBT库从以下位置加载：</p><pre class="oac_no_warn" dir="ltr">％SYSTEM_DRIVE％\ ORACLE \ extapi \ [32,64] \ {SBT} \ {VENDOR} \ {VERSION} \ orasbt.dll</pre><p>如果RMAN无法使用安全的默认位置，或者您使用的是Oracle Database <span class="italic">11g</span>或更早版本，则RMAN会从环境变量<code class="codeph">PATH</code>或<code class="codeph">LIBPATH</code>指定的位置加载SBT库。</p>
                        <p>在某些情况下，您的组织可能具有安全性或法规遵从性要求，禁止使用环境变量<code class="codeph">PATH</code>或<code class="codeph">LIBPATH</code>来指定库目录。要禁用此行为，请将<code class="codeph">PARMS</code>字符串设置为<code class="codeph">SBT_SECURE=1</code> 。
                        </p>
                        <div class="infoboxnote" id="GUID-E9AE6653-6F60-4ED6-8AC1-7C6A31C9321F__GUID-A3E39E33-948A-4636-8FBF-5F03AF3E668F">
                           <p class="notep1">注意：</p>
                           <p>默认媒体管理库文件<span class="italic">不是</span>标准数据库安装的一部分。仅在安装第三方媒体管理软件时才存在。
                           </p>
                        </div>
                        <div class="infoboxnotealso" id="GUID-E9AE6653-6F60-4ED6-8AC1-7C6A31C9321F__GUID-56464409-FDB4-4DA1-898F-6E3855F26B7C">
                           <p class="notep1">也可以看看：</p>
                           <p>您的操作系统特定数据库文档和媒体供应商提供的文档，以获取有关如何在您的平台上实现媒体管理器集成的说明</p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-E9AE6653-6F60-4ED6-8AC1-7C6A31C9321F__GUID-3D6B62A0-4A9C-4C40-A8B9-5ABD46EE3CC0">示例：配置媒体管理库位置</p>
                        <p>以下示例显示了通道语法，其中<span class="italic">pathname</span>是库的绝对文件名：</p><pre class="pre codeblock"><code>CONFIGURE CHANNEL DEVICE TYPE sbt PARMS'SBT_LIBRARY = <span class="italic">pathname</span> ';</code></pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="BRADV569"></a><a id="BRADV89411"></a><div class="props_rev_3"><a id="GUID-56142138-9032-4454-B289-8A67A577682F" name="GUID-56142138-9032-4454-B289-8A67A577682F"></a><h4 id="BRADV-GUID-56142138-9032-4454-B289-8A67A577682F" class="sect4"><span class="enumeration_section">5.2.3</span>配置RMAN备份的介质管理软件</h4>
                  <div>
                     <p>安装介质管理软件后，请执行供应商所需的配置，以便软件可以接受RMAN备份。</p>
                     <div class="section">
                        <p>根据您安装的媒体管理软件的类型，您可能必须定义媒体池，配置用户和类等。有关相应的RMAN设置，请参阅介质管理供应商文档。<code class="codeph">PARMS</code>参数向媒体管理器发送指令。如果<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=RCMRF102" target="_blank"><code class="codeph">ALLOCATE CHANNEL</code></a>或<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=RCMRF113" target="_blank"><code class="codeph">CONFIGURE CHANNEL</code></a>命令需要<code class="codeph">PARMS</code>值，或者建议对<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=RCMRF107" target="_blank"><code class="codeph">BACKUP</code></a>或<code class="codeph">CONFIGURE</code>命令使用<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=RCMRF195" target="_blank"><code class="codeph">FORMAT</code></a>字符串，请参阅供应商文档以获取此信息。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-56142138-9032-4454-B289-8A67A577682F__CHDCDBHB">
                        <p class="titleinexample">示例5-5 Oracle Secure Backup的PARMS设置</p>
                        <p>此示例显示Oracle Secure Backup的<code class="codeph">PARMS</code>设置。此<code class="codeph">PARMS</code>设置指示介质管理器备份到名为<code class="codeph">datafile_mf</code>的磁带系列。<code class="codeph">PARMS</code>设置始终是特定于供应商的。
                        </p><pre class="pre codeblock"><code>配置通道设备类型'SBT_TAPE'参数'ENV =（OB_MEDIA_FAMILY = datafile_mf）';</code></pre><div class="infoboxnotealso" id="GUID-56142138-9032-4454-B289-8A67A577682F__GUID-C6E09F72-8923-4EF4-A244-28127DB0A0FF">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>适用于<code class="codeph">ALLOCATE</code> <code class="codeph">CHANNEL</code>语法的<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=RCMRF102" target="_blank"><span><cite>Oracle数据库备份和恢复参考</cite></span></a></p>
                              </li>
                              <li>
                                 <p>用于通道控制选项的<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=RCMRF113" target="_blank"><span><cite>Oracle数据库备份和恢复参考</cite></span></a></p>
                              </li>
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=OBREF564" target="_blank"><span class="italic">Oracle Secure Backup参考</span></a> ，用于Oracle Secure Backup的特定于RMAN的参数设置</p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="example" -->
                  </div>
               </div><a id="BRADV89412"></a><div class="props_rev_3"><a id="GUID-8AD950E0-2C8C-42A1-884F-B416CBE06CB0" name="GUID-8AD950E0-2C8C-42A1-884F-B416CBE06CB0"></a><h4 id="BRADV-GUID-8AD950E0-2C8C-42A1-884F-B416CBE06CB0" class="sect4"><span class="enumeration_section">5.2.4</span>测试媒体管理器库是否集成正确</h4>
                  <div>
                     <p>确认数据库服务器可以加载介质管理库之后，请进行测试以确保RMAN可以备份到介质管理器。</p>
                     <p>您可以执行以下任务：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="configuring-rman-client-basic.html#GUID-DCB869C0-C252-4A37-A618-7D505775B1B1" title="ALLOCATE CHANNEL命令用于执行与媒体管理器的RMAN通信的基本测试。">在媒体管理器上测试ALLOCATE CHANNEL</a></p>
                        </li>
                        <li>
                           <p><a href="configuring-rman-client-basic.html#GUID-4685176B-25B4-4C5A-94E6-2DE2B2A5DC24" title="在媒体管理器上测试通道分配后，创建并恢复测试备份。">在介质管理器上测试备份和还原操作</a></p>
                        </li>
                     </ul>
                  </div><a id="BRADV169"></a><a id="BRADV89413"></a><div class="props_rev_3"><a id="GUID-DCB869C0-C252-4A37-A618-7D505775B1B1" name="GUID-DCB869C0-C252-4A37-A618-7D505775B1B1"></a><h5 id="BRADV-GUID-DCB869C0-C252-4A37-A618-7D505775B1B1" class="sect5"><span class="enumeration_section">5.2.4.1</span>在媒体管理器上测试ALLOCATE CHANNEL</h5>
                     <div>
                        <p><code class="codeph">ALLOCATE CHANNEL</code>命令用于执行与媒体管理器的RMAN通信的基本测试。
                        </p>
                        <div class="section">
                           <p class="subhead3" id="GUID-DCB869C0-C252-4A37-A618-7D505775B1B1__GUID-ECF4819C-5CA6-446D-A139-DD9ADC240422">要测试媒体管理器上的频道分配：</p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>启动RMAN并连接到目标数据库和恢复目录（如果使用）。</span></li>
                           <li class="stepexpand"><span>使用媒体管理软件所需的<code class="codeph">PARMS</code>运行<code class="codeph">ALLOCATE</code> <code class="codeph">CHANNEL</code>命令。</span><div>
                                 <p>以下<code class="codeph">RUN</code>命令显示特定<code class="codeph">PARMS</code>供应商的样本<code class="codeph">PARMS</code>设置：</p><pre class="pre codeblock"><code>RUN {ALLOCATE CHANNEL c1 DEVICE TYPE sbt PARMS'SBT_LIBRARY = / mydir / lib / libobk.so，ENV =（OB_DEVICE = drive1，OB_MEDIA_FAMILY = datafile_mf）'; }</code></pre></div>
                           </li>
                           <li class="stepexpand"><span>检查RMAN输出。</span><div>
                                 <p>如果您没有收到错误消息，则数据库已成功加载媒体管理库。如果收到<code class="codeph">ORA-27211</code>错误，则无法加载媒体管理库：</p><pre class="pre codeblock"><code>RMAN-00571：============================================== ============= RMAN-00569：===============错误信息堆栈跟踪============== = RMAN-00571：============================================= ============== RMAN-03009：2007年11月30日13:57:18在c1频道上分配命令失败ORA-19554：错误分配设备，设备类型：SBT_TAPE，设备名称：ORA-27211：无法加载媒体管理库附加信息：25</code></pre><p>在这种情况下，请检查介质管理安装以确保正确安装库，并按照<a href="configuring-rman-client-basic.html#GUID-E9AE6653-6F60-4ED6-8AC1-7C6A31C9321F" title="在尝试将RMAN与媒体管理器一起使用之前，请确定媒体管理库的位置。">确定介质管理库的位置中所述</a>重新检查<code class="codeph">SBT_LIBRARY</code>参数的值。
                                 </p>
                                 <p>如果数据库无法在<code class="codeph">SBT_LIBRARY</code>参数或默认位置指定的位置找到介质管理库，则RMAN会发出<code class="codeph">ORA-27211</code>错误并退出。
                                 </p>
                              </div>
                           </li>
                        </ol>
                        <div class="section">
                           <p>每当通道分配失败时，数据库都会将跟踪文件写入<a href="glossary.html#GUID-BDCE90D1-13B7-4D2C-A761-1583A238A247"><span class="xrefglossterm">自动诊断存储库（ADR）</span></a>主目录中的<code class="codeph">trace</code>子目录。以下显示了示例输出：</p><pre class="oac_no_warn" dir="ltr">SKGFQ OSD：2278行上的功能sbtinit错误SKGFQ OSD：在文件/oracle/rdbms/log/sbtio.log中查找SBT跟踪消息SBT初始化为/oracle/lib/libobk.so失败</pre><div class="infoboxnotealso" id="GUID-DCB869C0-C252-4A37-A618-7D505775B1B1__GUID-C5AC8D34-51FB-4E4C-A6CD-9E253A9B3CCE">
                              <p class="notep1">也可以看看：</p>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=ADMIN005" target="_blank"><span><cite>Oracle数据库管理员指南</cite></span></a> ，了解如何使用自动诊断存储库来监视数据库操作</p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="BRADV570"></a><a id="BRADV171"></a><a id="BRADV89414"></a><div class="props_rev_3"><a id="GUID-4685176B-25B4-4C5A-94E6-2DE2B2A5DC24" name="GUID-4685176B-25B4-4C5A-94E6-2DE2B2A5DC24"></a><h5 id="BRADV-GUID-4685176B-25B4-4C5A-94E6-2DE2B2A5DC24" class="sect5"><span class="enumeration_section">5.2.4.2</span>在介质管理器上测试备份和还原操作</h5>
                     <div>
                        <p>在媒体管理器上测试通道分配后，创建并恢复测试备份。</p>
                        <div class="section">
                           <p>使用<code class="codeph">BACKUP</code>和<code class="codeph">RESTORE</code>命令在媒体管理器上执行备份和恢复操作。如果备份和还原操作成功，则您已准备好将媒体管理器与RMAN一起使用。</p>
                           <p>失败的可能原因包括以下情况：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>备份挂起。</p>
                                 <p>挂起备份通常表示媒体管理器正在等待挂载磁带。检查磁带装入请求模式中是否有任何介质管理器作业并解决问题。确保正确完成<a href="configuring-rman-client-basic.html#GUID-215D0081-288D-4A90-92C2-1E9CA8AF0CAB" title="在大多数平台上，要备份到磁带等顺序介质并从中恢复，必须将介质管理软件与Oracle数据库集成。您可以将支持数据库和文件系统备份的Oracle Secure Backup用作磁带，作为媒体管理器。">配置RMAN以备份到介质管理器</a>中的步骤。
                                 </p>
                              </li>
                              <li>
                                 <p><code class="codeph">ORA-27211: Failed to load Media Management Library</code>的备份失败<code class="codeph">ORA-27211: Failed to load Media Management Library</code> 。
                                 </p>
                                 <p>此错误表示未正确配置介质管理软件。确保正确完成<a href="configuring-rman-client-basic.html#GUID-215D0081-288D-4A90-92C2-1E9CA8AF0CAB" title="在大多数平台上，要备份到磁带等顺序介质并从中恢复，必须将介质管理软件与Oracle数据库集成。您可以将支持数据库和文件系统备份的Oracle Secure Backup用作磁带，作为媒体管理器。">配置RMAN以备份到介质管理器</a>中的步骤。此外，请确保您具有媒体管理软件所需的<code class="codeph">PARMS</code>和<code class="codeph">FORMAT</code>字符串。
                                 </p>
                              </li>
                           </ul>
                           <div class="infoboxnotealso" id="GUID-4685176B-25B4-4C5A-94E6-2DE2B2A5DC24__GUID-5E9A074B-7EEF-4313-BB1A-B2A50DB1D664">
                              <p class="notep1">也可以看看：</p>
                              <p><a href="troubleshooting-rman-operations.html#GUID-B1E9715D-BD07-4B80-8158-33981138E679" title="在某些平台上，Oracle提供了一个名为sbttest的诊断工具。该实用程序通过充当Oracle数据库服务器并尝试与媒体管理器通信来执行对媒体管理软件的简单测试。">测试介质管理API</a>和<a href="troubleshooting-rman-operations.html#GUID-ABFD58BD-5D3B-4A6C-AA46-E085AE234D73" title="Recovery Manager提供详细的错误消息，可帮助解决问题。对故障排除失败或无响应的RMAN作业有用的输出位于几个不同的位置。RMAN消息输出提供有关备份和恢复操作进度的信息。使用此信息可以采取任何必要的操作来解决卡住或等待资源的操作。RMAN会在发生错误时报告错误。如果错误无法检索，即，如果RMAN无法执行故障转移到另一个通道以完成特定作业步骤，则RMAN还会在所有作业集完成后报告错误摘要。此功能称为延迟错误报告。您可以使用RMAN消息堆栈中的错误代码来解决RMAN命令的问题。RMAN错误消息以RMAN-为前缀。如果发生媒体管理器错误，则发出ORA-19511信号，并且媒体管理器应该向RMAN提供描述性错误。RMAN显示媒体管理器传回给它的错误。在RMAN错误堆栈中标识相关消息非常重要。由RMAN作为前缀的错误表示由RMAN命令引起的错误。来自服务器的错误以ORA-为前缀。此示例显示如何解释在媒体管理器级别导致的错误。此示例显示具有错误介质管理错误的备份作业的输出。确定RMAN是否遇到错误的一种方法是检查其返回代码或退出状态。如果没有发生错误，RMAN客户端将0返回到调用它的shell，否则返回非零错误值。当LIST，REPORT和SHOW不提供RMAN操作所需的所有信息时，某些V $视图可以提供有用的详细信息。您可以使用动态性能事件视图中的事件名称来监视对媒体管理API的RMAN调用。事件名称与SBT功能一一对应。要识别哪些服务器会话对应于哪些RMAN通道，您可以查询V $ SESSION和V $ PROCESS。当只有一个RMAN会话处于活动状态时，确定RMAN通道的服务器会话ID的最简单方法是查询目标数据库。如果多个RMAN会话处于活动状态，则V $ SESSION.CLIENT_INFO列可以为每个会话中的通道生成相同的信息。您必须首先从RMAN输出中获取sid值，然后在SQL查询中使用这些值。您在RMAN备份脚本中指定命令ID字符串。然后，您可以查询此字符串的V $ SESSION.CLIENT_INFO。在某些平台上，Oracle提供了一个名为sbttest的诊断工具。该实用程序通过充当Oracle数据库服务器并尝试与媒体管理器通信来执行对媒体管理软件的简单测试。sbttest实用程序的默认位置取决于平台。使用不带参数的sbttest命令列出此程序的各种参数。使用sbttest对媒体管理器进行快速测试。有几种方法可以在执行过程中终止RMAN命令。要使用ALTER SYSTEM语句终止RMAN会话，您需要RMAN通道的Oracle会话ID和序列号。此信息包含在消息的RMAN日志中。查找和终止与服务器会话关联的进程是特定于操作系统的。在某些平台上，服务器会话根本不与任何进程相关联。有关更多信息，请参阅特定于操作系统的文档。您有时可能需要终止在媒体管理器中没有响应的RMAN作业。当媒体管理器中的通道连接没有响应时，终止RMAN的最佳方法是终止媒体管理器中的会话。RMAN会话的性质取决于操作系统。RMAN通常会停止响应，因为通道连接正在磁带资源的介质管理器代码中等待。目录连接和默认通道似乎挂起，因为它们正在等待RMAN告诉它们要做什么。在RMAN进程的控制下轮询RPC时，轮询连接似乎处于无限循环中。在终止媒体管理器代码中的无响应信道之后，RMAN进程检测到该终止并退出，移除除了仍在媒体管理层中操作的目标连接之外的所有连接。">RMAN操作疑难解答</a></p>
                           </div>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-4685176B-25B4-4C5A-94E6-2DE2B2A5DC24__CHDDDJGD">
                           <p class="titleinexample">示例5-6将服务器参数文件备份到磁带</p>
                           <p>您可以使用此示例中的命令（替换媒体管理供应商所需的通道设置）来测试是否可以在媒体管理器上创建备份。如果数据库不使用服务器参数文件，请改为备份当前控制文件。</p><pre class="pre codeblock"><code>RUN {ALLOCATE CHANNEL c1 DEVICE TYPE sbt PARMS'SBT_LIBRARY = / mydir / lib / libobk.so，ENV =（OB_DEVICE = drive1，OB_MEDIA_FAMILY = datafile_mf）'; BACKUP SPFILE; ＃如果您的数据库不使用服务器参数文件，请使用：#BACKUP CURRENT CONTROLFILE; }</code></pre></div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-4685176B-25B4-4C5A-94E6-2DE2B2A5DC24__CHDDDCBE">
                           <p class="titleinexample">示例5-7从磁带恢复服务器参数文件</p>
                           <p>此示例将<a href="configuring-rman-client-basic.html#GUID-4685176B-25B4-4C5A-94E6-2DE2B2A5DC24__CHDDDJGD">示例5-6中</a>创建的备份还原到临时目录。如果对介质管理器的备份成功，则尝试将服务器参数文件还原为初始化参数文件。
                           </p><pre class="pre codeblock"><code>RUN {ALLOCATE CHANNEL c1 DEVICE TYPE sbt PARMS'SBT_LIBRARY = / mydir / lib / libobk.so，ENV =（OB_DEVICE = drive1，OB_MEDIA_FAMILY = datafile_mf）';恢复SPILE到PFILE'/tmp/test_restore.f'; ＃如果您的数据库不使用服务器参数文件，请使用：＃RESTORE CURRENT CONTROLFILE to'/tmp/test_restore.f'; }</code></pre></div>
                        <!-- class="example" -->
                     </div>
                  </div>
               </div><a id="BRADV89415"></a><div class="props_rev_3"><a id="GUID-DB37EEF2-426B-4060-BA36-FEE38C11ADB8" name="GUID-DB37EEF2-426B-4060-BA36-FEE38C11ADB8"></a><h4 id="BRADV-GUID-DB37EEF2-426B-4060-BA36-FEE38C11ADB8" class="sect4"><span class="enumeration_section">5.2.5</span>配置SBT通道以与介质管理器配合使用</h4>
                  <div>
                     <p>配置SBT通道会创建一个持久性设置，该设置是用于使用媒体管理器进行备份和恢复操作的默认设置。</p>
                     <div class="infoboxnote" id="GUID-DB37EEF2-426B-4060-BA36-FEE38C11ADB8__GUID-8291DD79-4547-43CC-9238-1D860EBA652E">
                        <p class="notep1">注意：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="configuring-rman-client-advanced.html#GUID-EF072AB8-AE89-4847-90B1-2214FD2336B3" title="CONFIGURE CHANNEL命令用于配置RMAN通道选项。">配置高级频道选项</a></p>
                           </li>
                           <li>
                              <p><a href="configuring-rman-client-basic.html#GUID-91DF2C07-F857-445A-AB71-8ED824520228" title="备份片名由BACKUP命令，CONFIGURE CHANNEL命令或ALLOCATECHANNEL命令中指定的FORMAT字符串确定。">关于媒体管理器备份片名</a></p>
                           </li>
                           <li>
                              <p><a href="configuring-rman-client-basic.html#GUID-4DD4BBA1-9374-44BF-B56B-F3995EBD761E" title="备份到媒体管理器的最简单方法是配置自动SBT通道">配置自动SBT频道</a></p>
                           </li>
                        </ul>
                     </div>
                  </div><a id="BRADV89416"></a><div class="props_rev_3"><a id="GUID-91DF2C07-F857-445A-AB71-8ED824520228" name="GUID-91DF2C07-F857-445A-AB71-8ED824520228"></a><h5 id="BRADV-GUID-91DF2C07-F857-445A-AB71-8ED824520228" class="sect5"><span class="enumeration_section">5.2.5.1</span>关于介质管理器备份<span class="enumeration_section">片名</span></h5>
                     <div>
                        <p>备份片名由<code class="codeph">BACKUP</code>命令， <code class="codeph">CONFIGURE</code> <code class="codeph">CHANNEL</code>命令或<code class="codeph">ALLOCATE</code> <code class="codeph">CHANNEL</code>命令中指定的<code class="codeph">FORMAT</code>字符串确定。
                        </p>
                        <p>介质管理器将备份片段名称视为备份文件的名称，因此每个备份片段必须在<a href="glossary.html#GUID-BF263385-102C-44FF-AE86-40FBA05CE30C"><span class="xrefglossterm">介质管理目录中</span></a>具有唯一名称。您可以使用<code class="codeph">FORMAT</code>参数中的替换变量来生成唯一的备份片名。例如， <code class="codeph">%d</code>指定数据库的名称，而<code class="codeph">%t</code>指定备份时间戳。在大多数情况下，您可以使用<code class="codeph">%U</code> ，在这种情况下，RMAN会自动生成唯一的文件名。<code class="codeph">12i1nk47_1_1</code>名称<code class="codeph">12i1nk47_1_1</code>就是一个示例。如果未指定<code class="codeph">FORMAT</code>参数，则RMAN会自动生成具有<code class="codeph">%U</code>替换变量的唯一文件名。
                        </p>
                        <p>您的媒体经理可能会对文件名和大小施加限制。在这种情况下，您可能需要更多地控制备份片段的命名，以便它们遵守媒体管理器限制。例如，某些媒体管理器仅支持14个字符的备份片段名称，有些则需要特殊的<code class="codeph">FORMAT</code>字符串。<code class="codeph">%U</code>替换变量生成的唯一名称不超过14个字符。
                        </p>
                        <p>某些媒体管理员可能会限制他们可以备份或还原的文件的最大大小。您必须确保RMAN不会生成大于这些限制的备份集。要限制备份片段大小，请使用参数<code class="codeph">MAXPIECESIZE</code> ，您可以在<code class="codeph">CONFIGURE CHANNEL</code>和<code class="codeph">ALLOCATE CHANNEL</code>命令中设置该参数。
                        </p>
                        <div class="infoboxnotealso" id="GUID-91DF2C07-F857-445A-AB71-8ED824520228__GUID-3099C718-8B8F-4F1F-AF39-0BE09910F7FC">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=RCMRF104" target="_blank"><span><cite>Oracle数据库备份和恢复参考</cite></span></a></p>
                              </li>
                              <li>
                                 <p><a href="rman-backup-concepts.html#GUID-DD7E7E32-B0F7-4FA0-91C3-0811610A13D9" title="默认情况下，备份集包含一个备份片。要限制每个备份片的大小，请指定CONFIGURE CHANNEL或ALLOCATE CHANNEL命令的MAXPIECESIZE选项。">关于RMAN备份片的数量和大小，</a>了解如何设置<code class="codeph">MAXPIECESIZE</code></p>
                              </li>
                              <li>
                                 <p>使用<code class="codeph">BACKUP</code>命令在格式字符串中允许的完整变量列表的<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=RCMRF195" target="_blank"><span><cite>Oracle数据库备份和恢复参考</cite></span></a></p>
                              </li>
                              <li>
                                 <p>您的媒体管理文档，用于确定媒体管理器的字符串字符限制</p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div><a id="BRADV571"></a><a id="BRADV89417"></a><div class="props_rev_3"><a id="GUID-4DD4BBA1-9374-44BF-B56B-F3995EBD761E" name="GUID-4DD4BBA1-9374-44BF-B56B-F3995EBD761E"></a><h5 id="BRADV-GUID-4DD4BBA1-9374-44BF-B56B-F3995EBD761E" class="sect5"><span class="enumeration_section">5.2.5.2</span>配置自动SBT通道</h5>
                     <div>
                        <p>备份到媒体管理器的最简单方法是配置自动SBT通道</p>
                        <div class="section">
                           <p>如<span class="q">“ <a href="configuring-rman-client-basic.html#GUID-3845B630-DD47-4147-BA6E-8D677CAF1CC2" title="未指定目标设备类型的备份将定向到已配置的默认设备。RMAN已预先配置为使用磁盘作为默认设备类型。无需其他配置。">配置备份的默认设备：磁盘或SBT</a> ”中所述</span> ，您可以使用磁带设备作为默认备份目标。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-4DD4BBA1-9374-44BF-B56B-F3995EBD761E__GUID-7E7EFA86-3858-4DFE-B83D-4D0531DBB2A0">配置要与媒体管理器一起使用的频道：</p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>配置通用SBT通道。</span><div>
                                 <p>在配置中，输入在<span class="q">“ <a href="configuring-rman-client-basic.html#GUID-4685176B-25B4-4C5A-94E6-2DE2B2A5DC24" title="After testing a channel allocation on the media manager, create and restore a test backup.">在介质管理器上测试备份和还原操作</a> ”中<a href="configuring-rman-client-basic.html#GUID-4685176B-25B4-4C5A-94E6-2DE2B2A5DC24" title="在媒体管理器上测试通道分配后，创建并恢复测试备份。">测试的</a></span>所有参数。以下示例配置特定于供应商的通道参数并设置默认设备：</p><pre class="oac_no_warn" dir="ltr">配置通道设备类型sbt PARMS'ENV =（OB_RESOURCE_WAIT_TIME = 1minute，OB_DEVICE = tape1）';</pre></div>
                           </li>
                           <li class="stepexpand"><span>将默认设备类型配置为SBT，如以下命令所示：</span><div><pre class="oac_no_warn" dir="ltr">配置默认设备类型为sbt;</pre><p>如果使用多个磁带设备，则必须按照<span class="q">“ <a href="configuring-rman-client-basic.html#GUID-C6D6E615-892F-4586-B14D-1BA42CB0C457" title="运行命令时可用于设备类型的通道数确定RMAN是并行读取还是写入。通常，执行命令时使用的通道数应与访问的设备数相匹配。">为磁盘和SBT设备配置并行通道</a> ”中的</span>说明指定通道并行性。通过以下配置，您可以并行备份最多两个磁带机：</p><pre class="oac_no_warn" dir="ltr">配置设备类型sbt PARALLELISM 2;</pre><p>（可选）通过运行以下命令检查通道配置：</p><pre class="oac_no_warn" dir="ltr">显示设备类型的频道sbt;</pre></div>
                           </li>
                           <li class="stepexpand"><span>对磁带进行测试备份。</span><div>
                                 <p>以下命令将服务器参数文件备份到磁带：</p><pre class="oac_no_warn" dir="ltr">BACKUP SPFILE;</pre></div>
                           </li>
                           <li class="stepexpand"><span>列出备份以确保测试备份转到媒体管理器：</span><div><pre class="oac_no_warn" dir="ltr">清单备份SPFILE;</pre></div>
                           </li>
                        </ol>
                     </div>
                  </div>
               </div>
            </div><a id="BRADV453"></a><div class="props_rev_3"><a id="GUID-6F28089E-6D4E-4D6B-B96E-043C35D029D5" name="GUID-6F28089E-6D4E-4D6B-B96E-043C35D029D5"></a><h3 id="BRADV-GUID-6F28089E-6D4E-4D6B-B96E-043C35D029D5" class="sect3"><span class="enumeration_section">5.3</span>配置RMAN备份到恢复设备</h3>
               <div>
                  <p>RMAN命令可用于将目标数据库备份到零数据丢失恢复设备（恢复设备）。将恢复设备用作目标数据库备份的集中存储库需要某些配置步骤。</p>
                  <p>配置RMAN以创建到Recovery Appliance的备份：</p>
                  <ol>
                     <li>
                        <p>确保满足<span class="q">“ <a href="configuring-rman-client-basic.html#GUID-0E1C6F92-651D-44D5-8501-726DBA71DA1E" title="Before you can use RMAN to back up a target database to Zero Data Loss Recovery Appliance (Recovery Appliance), you must install the Recovery Appliance backup module in the Oracle home of the target database.">使用恢复设备</a></span>的先决条件”中描述的<span class="q"><a href="configuring-rman-client-basic.html#GUID-0E1C6F92-651D-44D5-8501-726DBA71DA1E" title="在使用RMAN将目标数据库备份到零数据丢失恢复设备（恢复设备）之前，必须在目标数据库的Oracle主目录中安装恢复设备备份模块。">先决条件</a></span> 。
                        </p>
                     </li>
                     <li>
                        <p>完成<span class="q">“ <a href="configuring-rman-client-basic.html#GUID-2215E132-8873-4F8A-A7F7-2952E6C4534B" title="RMAN configuration is required before you can back up Oracle databases to Zero Data Loss Recovery Appliance (Recovery Appliance).">为备份到恢复设备配置RMAN</a></span>的步骤”中列出的<span class="q"><a href="configuring-rman-client-basic.html#GUID-2215E132-8873-4F8A-A7F7-2952E6C4534B" title="在将Oracle数据库备份到零数据丢失恢复设备（恢复设备）之前，需要进行RMAN配置。">步骤</a></span> 。
                        </p>
                     </li>
                  </ol>
                  <div class="infoboxnotealso" id="GUID-6F28089E-6D4E-4D6B-B96E-043C35D029D5__GUID-563CF01C-655B-4131-9282-330E6F76E5D4">
                     <p class="notep1">也可以看看：</p>
                     <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=AMPDB909" target="_blank"><span class="italic">零数据丢失恢复设备保护数据库配置指南</span></a></p>
                  </div>
               </div><a id="BRADV456"></a><div class="props_rev_3"><a id="GUID-0E1C6F92-651D-44D5-8501-726DBA71DA1E" name="GUID-0E1C6F92-651D-44D5-8501-726DBA71DA1E"></a><h4 id="BRADV-GUID-0E1C6F92-651D-44D5-8501-726DBA71DA1E" class="sect4"><span class="enumeration_section">5.3.1</span>使用恢复设备的先决条件</h4>
                  <div>
                     <p>在使用RMAN将目标数据库备份到零数据丢失恢复设备（恢复设备）之前，必须在目标数据库的Oracle主目录中安装恢复设备备份模块。</p>
                     <p>备份模块可以安装在默认位置或用户指定的位置。安装恢复设备备份模块会创建用于将备份传输到恢复设备的共享库，以及包含用于使用恢复设备对目标数据库进行身份验证的凭据的Oracle钱包。</p>
                     <div class="infoboxnotealso" id="GUID-0E1C6F92-651D-44D5-8501-726DBA71DA1E__GUID-35BA9C4E-C0A7-4A7B-847A-47CE164DE8FE">
                        <p class="notep1">也可以看看：</p>
                        <p>有关安装Recovery Appliance备份模块的信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=AMPDB715" target="_blank"><span class="italic">“零数据丢失恢复设备受保护数据库配置指南”</span></a></p>
                     </div>
                  </div>
               </div><a id="BRADV468"></a><div class="props_rev_3"><a id="GUID-2215E132-8873-4F8A-A7F7-2952E6C4534B" name="GUID-2215E132-8873-4F8A-A7F7-2952E6C4534B"></a><h4 id="BRADV-GUID-2215E132-8873-4F8A-A7F7-2952E6C4534B" class="sect4"><span class="enumeration_section">5.3.2</span>配置备份到恢复设备的RMAN的步骤</h4>
                  <div>
                     <p>在将Oracle数据库备份到零数据丢失恢复设备（恢复设备）之前，需要进行RMAN配置。</p>
                     <ol>
                        <li class="stepexpand"><span>确定恢复设备备份模块<span class="q"><a href="configuring-rman-client-basic.html#GUID-7E328C2A-9E45-42B7-9C0B-DC1A855A0C46" title="Before using RMAN to back up target databases to Zero Data Loss Recovery Appliance (Recovery Appliance), you need to determine the location of the Recovery Appliance backup module on the target database host. This location is used while configuring or allocating RMAN channels for Recovery Appliance.">的位置，</a></span>如<span class="q">“ <a href="configuring-rman-client-basic.html#GUID-7E328C2A-9E45-42B7-9C0B-DC1A855A0C46" title="在使用RMAN将目标数据库备份到零数据丢失恢复设备（恢复设备）之前，需要确定目标数据库主机上恢复设备备份模块的位置。在为恢复设备配置或分配RMAN通道时使用此位置。">确定恢复设备备份模块的位置”中所述</a></span> 。</span></li>
                        <li class="stepexpand"><span>指定RMAN必须使用的恢复设备配置参数，如<span class="q"><a href="configuring-rman-client-basic.html#GUID-9CC5C3DE-C972-4A3C-8AB7-1C1B7D9773AD" title="存储在受保护数据库中的客户端配置文件包含零数据丢失恢复设备（恢复设备）备份模块用于与恢复设备通信的配置设置。安装Recovery Appliance备份模块时会自动创建此文件。">“为RMAN备份指定恢复设备配置设置</a> ”中</span>所述，创建备份到恢复设备。</span></li>
                        <li class="stepexpand"><span>分配一个或多个RMAN通道，RMAN将使用这些通道将数据库备份到恢复设备。</span><div>
                              <p>使用恢复设备时，必须指定<code class="codeph">SBT_LIBRARY</code>和<code class="codeph">ENV</code>参数。<code class="codeph">SBT_LIBRARY</code>提供恢复设备备份模块的位置， <code class="codeph">ENV</code>提供配置参数。
                              </p>
                              <p>您还可以配置将用于备份到恢复设备的RMAN SBT通道，而不是分配RMAN通道。在这种情况下，通道配置是持久的，并且设置适用，直到它们被重置（使用<code class="codeph">CONFIGURE</code>命令）或使用<code class="codeph">ALLOCATE</code>语句覆盖特定操作。
                              </p>
                              <div class="infoboxnotealso" id="GUID-2215E132-8873-4F8A-A7F7-2952E6C4534B__GUID-9EA3486E-DBAD-4255-AC82-A946149EF1C5">
                                 <p class="notep1">也可以看看：</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p><a href="configuring-rman-client-basic.html#GUID-7E328C2A-9E45-42B7-9C0B-DC1A855A0C46__CHDECBDB">示例5-8</a>和<a href="configuring-rman-client-basic.html#GUID-9CC5C3DE-C972-4A3C-8AB7-1C1B7D9773AD__CHDCJBCH">示例5-9</a>有关为恢复设备配置RMAN的示例。
                                       </p>
                                    </li>
                                    <li>
                                       <p>有关分配RMAN通道的信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=AMPDB909" target="_blank"><span class="italic">“零数据丢失恢复设备保护数据库配置指南”</span></a></p>
                                    </li>
                                 </ul>
                              </div>
                           </div>
                        </li>
                     </ol>
                  </div>
               </div><a id="BRADV479"></a><a id="BRADV478"></a><div class="props_rev_3"><a id="GUID-7E328C2A-9E45-42B7-9C0B-DC1A855A0C46" name="GUID-7E328C2A-9E45-42B7-9C0B-DC1A855A0C46"></a><h4 id="BRADV-GUID-7E328C2A-9E45-42B7-9C0B-DC1A855A0C46" class="sect4"><span class="enumeration_section">5.3.3</span>确定恢复设备备份模块的位置</h4>
                  <div>
                     <p>在使用RMAN将目标数据库备份到零数据丢失恢复设备（恢复设备）之前，需要确定目标数据库主机上恢复设备备份模块的位置。在为恢复设备配置或分配RMAN通道时使用此位置。</p>
                     <div class="section">
                        <p><code class="codeph">CONFIGURE</code>或<code class="codeph">ALLOCATE</code>命令中的<code class="codeph">SBT_LIBRARY</code>参数指定恢复设备备份模块的位置。当RMAN尝试备份到恢复设备时，它会加载<code class="codeph">SBT_LIBRARY</code>参数指示的共享库。
                        </p>
                        <p>您可以为<code class="codeph">SBT_LIBRARY</code>参数指定绝对路径名或文件名。如果指定文件名，则RMAN将在特定于操作系统的位置搜索该文件。默认情况下，恢复设备备份模块位于UNIX / Linux上的<code class="codeph">$ORACLE_HOME/lib/libra.so</code>和Windows上的<code class="codeph">%ORACLE_HOME\database\lib\libra.sso</code>中。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-7E328C2A-9E45-42B7-9C0B-DC1A855A0C46__CHDECBDB">
                        <p class="titleinexample">示例5-8在通道配置期间指定恢复设备备份模块位置</p>
                        <p>以下命令通过在Linux上指定恢复设备备份模块的绝对路径名来配置RMAN SBT通道：</p><pre class="pre codeblock"><code>CONFIGURE CHANNEL DEVICE TYPE sbt PARAMS'SBT_LIBRARY = / u01 / oracle / lib / libra.so';</code></pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="BRADV483"></a><a id="BRADV481"></a><div class="props_rev_3"><a id="GUID-9CC5C3DE-C972-4A3C-8AB7-1C1B7D9773AD" name="GUID-9CC5C3DE-C972-4A3C-8AB7-1C1B7D9773AD"></a><h4 id="BRADV-GUID-9CC5C3DE-C972-4A3C-8AB7-1C1B7D9773AD" class="sect4"><span class="enumeration_section">5.3.4</span>指定RMAN备份的恢复设备配置设置</h4>
                  <div>
                     <p>存储在受保护数据库中的客户端配置文件包含零数据丢失恢复设备（恢复设备）备份模块用于与恢复设备通信的配置设置。安装Recovery Appliance备份模块时会自动创建此文件。</p>
                     <div class="section">
                        <p>客户端配置文件必须包含Oracle钱包的位置，该钱包存储使用Recovery Appliance对目标数据库进行身份验证所需的凭据。可以包括其他可选设置。</p>
                        <p>使用恢复设备时，可以在RMAN命令中包含客户端配置设置。使用RMAN <code class="codeph">CONFIGURE CHANNEL</code>或<code class="codeph">ALLOCATE CHANNEL</code>命令的<code class="codeph">ENV</code>参数直接指定恢复设备的客户端配置参数。
                        </p>
                        <div class="infoboxnotealso" id="GUID-9CC5C3DE-C972-4A3C-8AB7-1C1B7D9773AD__GUID-5AE3F87A-6AEF-41F4-BC93-289F0B2655A4">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=AMPDB909" target="_blank"><span class="italic">零数据丢失恢复设备保护数据库配置指南</span></a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-9CC5C3DE-C972-4A3C-8AB7-1C1B7D9773AD__CHDCJBCH">
                        <p class="titleinexample">示例5-9指定Recovery Appliance客户端配置设置</p>
                        <p>以下命令直接指定Recovery Appliance客户端配置设置作为<code class="codeph">CONFIGURE CHANNEL</code>命令的一部分：</p><pre class="pre codeblock"><code>配置通道设备类型'SBT_TAPE'参数'SBT_LIBRARY = libra.so，ENV =（BA_WALLET = location = file：/home/oracle/product/12.1.0/dbhome_1/wallet credential_alias = ra-scan：1521 / zdlra5：dedicated） “;</code></pre><p>在此示例中， <code class="codeph">ra-scan</code>是恢复设备的SCAN， <code class="codeph">zdlra5</code>是恢复设备元数据数据库的服务名称。
                        </p>
                     </div>
                     <!-- class="example" -->
                  </div>
               </div>
            </div><a id="BRADV8183"></a><div class="props_rev_3"><a id="GUID-302339EC-EE0F-45FB-9862-BB2BA138AA13" name="GUID-302339EC-EE0F-45FB-9862-BB2BA138AA13"></a><h3 id="BRADV-GUID-302339EC-EE0F-45FB-9862-BB2BA138AA13" class="sect3"><span class="enumeration_section">5.4</span>配置快速恢复区</h3>
               <div>
                  <p>快速恢复区域功能使您可以设置磁盘区域，数据库可以在该区域中创建和管理与备份和恢复相关的各种文件。强烈建议使用快速恢复区域。考虑将快速恢复区域配置为实施备份策略的第一步。</p>
                  <p>本节概述了快速恢复区域的功能，标识了存储在那里的文件，解释了文件管理的规则，并介绍了最重要的配置选项。本节包含以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="configuring-rman-client-basic.html#GUID-061CCF1D-2C8D-4460-B469-9C32893A590A" title="快速恢复区域可以包含控制文件，联机重做日志，归档重做日志，闪回日志和RMAN备份。">快速恢复区中的文件概述</a></p>
                     </li>
                     <li>
                        <p><a href="configuring-rman-client-basic.html#GUID-233338E2-3EE6-4248-A2B6-16A7899DB14F" title="通过设置两个初始化参数来启用快速恢复区域。这些参数启用快速恢复区域，无论是否必须关闭并重新启动数据库实例。">启用快速恢复区</a></p>
                     </li>
                     <li>
                        <p><a href="configuring-rman-client-basic.html#GUID-A90518CA-CBCA-4B8F-AC98-373445371FD4" title="您可以使用ALTER SYSTEM命令禁用快速恢复区域。">禁用快速恢复区</a></p>
                     </li>
                     <li>
                        <p><a href="configuring-rman-client-basic.html#GUID-B6AB2CA1-573D-40E0-906F-9A8F3FA5597E" title="使用初始化参数配置控制文件和重做日志的默认位置。">配置控制文件和重做日志的位置</a></p>
                     </li>
                     <li>
                        <p><a href="configuring-rman-client-basic.html#GUID-AE300A8D-0485-436B-B9D2-D20F7D4B9EA5" title="某些RMAN命令或隐式操作（例如控制文件自动备份）可以在快速恢复区域中创建文件。">在快速恢复区中配置RMAN文件创建</a></p>
                     </li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-302339EC-EE0F-45FB-9862-BB2BA138AA13__GUID-7FE96601-CF64-4723-AAAC-7BE2EC7C09FD">
                     <p class="notep1">也可以看看：</p>
                     <p><span class="q">“ <a href="maintaining-rman-backups.html#GUID-A60E5493-8988-40E5-9E70-36AE6A0DFD69" title="虽然快速恢复区域主要是自我管理，但某些情况可能需要数据库管理干预。">维持快速恢复区</a> ”</span></p>
                  </div>
               </div><a id="BRADV173"></a><a id="BRADV89418"></a><div class="props_rev_3"><a id="GUID-061CCF1D-2C8D-4460-B469-9C32893A590A" name="GUID-061CCF1D-2C8D-4460-B469-9C32893A590A"></a><h4 id="BRADV-GUID-061CCF1D-2C8D-4460-B469-9C32893A590A" class="sect4"><span class="enumeration_section">5.4.1</span>快速恢复区域中的文件概述</h4>
                  <div>
                     <p>快速恢复区域可以包含控制文件，联机重做日志，归档重做日志，闪回日志和RMAN备份。</p>
                     <p>恢复区中的文件是<span class="italic">永久性的</span>或<span class="italic">瞬态的。</span> 永久文件是数据库实例使用的活动文件。所有非永久性文件都是暂时的。通常，Oracle数据库最终会在临时文件在<a href="glossary.html#GUID-ECF0ADBB-3255-43A2-A425-26850EA598EA"><span class="xrefglossterm">备份保留策略</span></a>下过时或已备份到磁带后删除它们。
                     </p>
                     <p>快速恢复区域是Oracle数据库管理的空间，可用于保存RMAN磁盘备份，控制文件自动备份和归档重做日志文件。放置在此位置的文件由Oracle数据库维护，生成的文件名以Oracle Managed Files（OMF）格式维护。</p>
                     <p><span class="q">“ <a href="configuring-rman-client-basic.html#GUID-061CCF1D-2C8D-4460-B469-9C32893A590A__CHDIJCHG" title="描述闪回恢复区中的文件，每个文件的分类为永久或临时，以及如果闪存恢复区不可访问，数据库可用性如何受到影响。">表5-2</a> ”</span>描述了恢复区中的文件，每个文件的分类为永久或临时，以及数据库可用性如何受到影响。
                     </p>
                     <div class="tblformalwide" id="GUID-061CCF1D-2C8D-4460-B469-9C32893A590A__CHDIJCHG">
                        <p class="titleintable">表5-2快速恢复区中的文件</p>
                        <table cellpadding="4" cellspacing="0" class="FormalWide" title="快速恢复区中的文件" width="100%" border="1" summary="Describes the files in the flash recovery area, the classification of each file as permanent or temporary, and how database availability is affected if the flash recovery area is inaccessible." frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="29%" id="d22448e4423">档</th>
                                 <th align="left" valign="bottom" width="14%" id="d22448e4426">类型</th>
                                 <th align="left" valign="bottom" width="57%" id="d22448e4429">快速恢复区不可访问时的数据库行为</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="29%" id="d22448e4434" headers="d22448e4423 ">
                                    <p>当前控制文件的多路复用副本</p>
                                 </td>
                                 <td align="left" valign="top" width="14%" headers="d22448e4434 d22448e4426 ">
                                    <p>常驻</p>
                                 </td>
                                 <td align="left" valign="top" width="57%" headers="d22448e4434 d22448e4429 ">
                                    <p>如果数据库无法写入存储在快速恢复区域中的控制文件的多路复用副本，则实例将失败。即使可访问的多路复用副本位于恢复区域之外，也会发生故障。</p>
                                    <p><span class="bold">另请参阅：</span> <span class="q">“ <a href="configuring-rman-client-basic.html#GUID-652242E6-F0DC-468D-8966-216472CE6136" title="初始化参数CONTROL_FILES，DB_CREATE_ONLINE_LOG_DEST_n，DB_RECOVERY_FILE_DEST和DB_CREATE_FILE_DEST都进行交互以确定创建数据库控制文件的位置。">配置控制文件位置</a> ”</span>以了解如何在恢复区中配置控制文件</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="29%" id="d22448e4470" headers="d22448e4423 ">
                                    <p>在线重做日志文件</p>
                                 </td>
                                 <td align="left" valign="top" width="14%" headers="d22448e4470 d22448e4426 ">
                                    <p>常驻</p>
                                 </td>
                                 <td align="left" valign="top" width="57%" headers="d22448e4470 d22448e4429 ">
                                    <p>如果在快速恢复区域外的可访问位置存在联机重做日志的镜像副本，则不会影响实例可用性。否则，实例失败。</p>
                                    <p><span class="bold">另请参阅：</span> <span class="q">“ <a href="configuring-rman-client-basic.html#GUID-F8A849BE-8276-4786-9B29-387E296B10DA">配置联机重做日志位置</a> ”</span>以了解如何在恢复区中配置联机重做日志</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="29%" id="d22448e4488" headers="d22448e4423 ">
                                    <p>存档的重做日志文件</p>
                                 </td>
                                 <td align="left" valign="top" width="14%" headers="d22448e4488 d22448e4426 ">
                                    <p>短暂的</p>
                                 </td>
                                 <td align="left" valign="top" width="57%" headers="d22448e4488 d22448e4429 ">
                                    <p>如果将日志存档到快速恢复区域外的可访问位置，则不会影响实例可用性。否则，数据库最终会暂停，因为它无法归档联机重做日志。</p>
                                    <p><span class="bold">另请参阅：</span> <span class="q">“ <a href="configuring-rman-client-basic.html#GUID-84988C3B-8F97-460A-8882-C26979F53836" title="Oracle建议您将快速恢复区域用作归档位置，因为归档日志由数据库自动管理。">配置存档重做日志位置</a> ”</span>以了解如何在恢复区域中配置存档重做日志</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="29%" id="d22448e4509" headers="d22448e4423 ">
                                    <p>外部归档重做日志文件</p>
                                 </td>
                                 <td align="left" valign="top" width="14%" headers="d22448e4509 d22448e4426 ">
                                    <p>短暂的</p>
                                 </td>
                                 <td align="left" valign="top" width="57%" headers="d22448e4509 d22448e4429 ">
                                    <p>实例可用性不受影响。</p>
                                    <p><span class="bold">注意：</span>外部归档重做日志由LogMiner会话的逻辑备用数据库接收。与普通归档日志不同， <a href="glossary.html#GUID-E2428029-4C01-4DFF-8C08-028EF57CF8C7"><span class="xrefglossterm">外部归档重做日志</span></a>与不同的DBID相关联。因此，无法在逻辑备用数据库上备份或还原它。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="29%" id="d22448e4526" headers="d22448e4423 ">
                                    <p>数据文件和控制文件的映像副本</p>
                                 </td>
                                 <td align="left" valign="top" width="14%" headers="d22448e4526 d22448e4426 ">
                                    <p>短暂的</p>
                                 </td>
                                 <td align="left" valign="top" width="57%" headers="d22448e4526 d22448e4429 ">
                                    <p>实例可用性不受影响。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="29%" id="d22448e4536" headers="d22448e4423 ">
                                    <p>备份件</p>
                                 </td>
                                 <td align="left" valign="top" width="14%" headers="d22448e4536 d22448e4426 ">
                                    <p>短暂的</p>
                                 </td>
                                 <td align="left" valign="top" width="57%" headers="d22448e4536 d22448e4429 ">
                                    <p>实例可用性不受影响。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="29%" id="d22448e4546" headers="d22448e4423 ">
                                    <p>闪回日志</p>
                                 </td>
                                 <td align="left" valign="top" width="14%" headers="d22448e4546 d22448e4426 ">
                                    <p>短暂的</p>
                                 </td>
                                 <td align="left" valign="top" width="57%" headers="d22448e4546 d22448e4429 ">
                                    <p>如果未定义保证的还原点，则不会影响实例可用性。在这种情况下，数据库会自动禁用闪回数据库，将消息写入警报日志，并继续进行数据库处理。如果配置了保证的还原点，则由于闪回日志的相互依赖性，实例将失败。</p>
                                    <p><a href="glossary.html#GUID-DD883C9B-0441-48D3-9DDC-755597782971"><span class="xrefglossterm">Oracle闪回数据库</span></a>功能提供了一种方便的<a href="glossary.html#GUID-FCC8BB91-79B6-4AF1-974A-43E75CD161E3"><span class="xrefglossterm">数据库时间点恢复（DBPITR）</span></a>替代方案，可生成<a href="glossary.html#GUID-725ED3D7-5077-4F16-85AA-CDAD5BFCE554"><span class="xrefglossterm">闪回日志</span></a> 。这些日志是临时文件，必须存储在快速恢复区域中。与其他瞬态文件不同，闪回日志无法备份到其他媒体。如果快速恢复区域没有足够的空间来存储闪回日志并满足其他备份保留要求，则恢复区域可能会删除闪回日志。
                                    </p>
                                    <p><span class="bold">另请参阅：</span> <span class="q">“ <a href="using-flasback-database-restore-points.html#GUID-FC98B2D7-9F18-4A62-BE4A-E97A0AA10BF4" title="使用ALTER DATABASE命令启用闪回数据库">启用闪回数据库</a> ”</span>以了解如何启用闪回日志记录</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p>如果您使用的是Windows平台，则可以将<a href="glossary.html#GUID-105781E5-32FB-4702-9248-9041B0EFBED4"><span class="xrefglossterm">卷影复制服务（VSS）</span></a>与<a href="glossary.html#GUID-CB860FA8-E039-4EC5-BAAC-F59091EA8F18"><span class="xrefglossterm">Oracle VSS编写器配合使用</span></a> 。在这种情况下，快速恢复区域会自动管理在VSS快照中备份的文件，并根据需要删除它们。
                     </p>
                     <div class="infoboxnotealso" id="GUID-061CCF1D-2C8D-4460-B469-9C32893A590A__GUID-A6EDB752-79F6-4F44-AE93-87DA5B784531">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="rman-performing-flashback-dbpitr.html#GUID-5463669A-DC89-4FF4-ACCE-136A72DF687B" title="此概述描述了Oracle闪回技术和数据库时间点恢复的目的和基本概念。某些情况适合使用时间点恢复或闪回功能，以便在之前的某个时间点将数据库或数据库对象返回到其状态。数据库时间点恢复（DBPITR）和闪回功能使您可以将数据库恢复到先前的某个时间点。DBPITR在物理级别工作，以在过去的目标时间将数据文件返回到其状态。RMAN为一个或多个PDB的时间点恢复提供支持。要恢复PDB，必须以具有SYSDBA或SYSBACKUP权限的用户身份连接到root。恢复后，PDB的旧备份仍然有效，并且可以在发生介质故障时使用。在大多数可用的情况下，Oracle数据库的闪回功能比介质恢复更有效。您可以使用它们来调查数据库的过去状态。Oracle闪回数据库是DBPITR最有效的替代方法。逻辑闪回功能用于将表及其内容恢复到过去的时间。您可以对整个多租户容器数据库（CDB）或特定可插拔数据库（PDB）执行闪回数据库操作。多租户容器数据库（CDB）可以使用共享撤消或本地撤消。RMAN用于执行闪回数据库操作的技术取决于CDB的撤消配置类型.RMAN提供了管理PDB中数据块的重做损坏的方法。闪回表使用撤消表空间中的信息而不是恢复的备份来检索表。发生闪回表操作时，将删除新行并重新插入旧行。在执行表的闪回时，数据库的其余部分仍然可用。要执行闪回表操作，该表必须符合闪回的条件，执行操作的用户必须具有所需的权限。要在一个或多个表上使用闪回表功能，请使用带有目标时间或SCN的FLASHBACK TABLE SQL语句。默认情况下，数据库在执行FLASHBACK TABLE操作之前禁用受影响表上的触发器。在操作之后，数据库将触发器返回到操作之前的状态（启用或禁用）。您可以使用FLASHBACK TABLE从回收站中检索对象...在DROP声明之前。Flashback Drop可以反转DROP TABLE操作的效果。闪回丢弃比在这种情况下可以使用的其他恢复机制（如时间点恢复）更快，并且不会导致停机或丢失最近的事务。在执行闪回删除操作之前，必须满足先决条件。使用FLASHBACK TABLE ...在DROP语句之前要从回收站中恢复对象。您可以指定回收站中表的名称或原始表名。您可以使用相同的原始名称创建，然后删除多个对象。所有丢弃的对象都存储在回收站中。闪回数据库通过将数据库返回到先前某个时间点的状态来反转不需要的更改。闪回数据库通过撤消对运行命令时存在的数据文件的更改来工作。必须满足先决条件才能执行闪回数据库操作。闪回数据库操作使用FLASHBACK DATABASE命令将数据库回滚到过去的某个时间点。您可以使用FLASHBACK DATABASE命令为整个多租户容器数据库（CDB）执行闪回数据库操作。您可以使用FLASHBACK DATABASE命令对多租户容器数据库（CDB）中的单个可插拔数据库（PDB）执行闪回数据库操作。数据字典视图包含用于监视闪回数据库的信息。RMAN DBPITR在目标恢复时间之前从备份还原数据库，然后使用增量备份和重做将数据库前滚到目标时间。您可以恢复到SCN，时间，日志序列号或还原点。Oracle建议您在重要时间创建还原点，以便在必要时使时间点恢复更易于管理。必须满足某些先决条件才能执行数据库时间点恢复（DBPITR）。使用RESTORE和RECOVER命令执行DBPITR。使用RECOVER命令执行容器数据库（CDB）和可插拔数据库（PDB）的时间点恢复（PITR）。PDB的PITR只能使用RMAN执行。使用RESTORE和RECOVER命令为整个CDB执行时间点恢复。当您将一个或多个PDB恢复到指定的时间点时，剩余的PDB将在国家开发银行不受影响，可以开放和运作。使用RESTORE和RECOVER命令执行应用程序PDB的时间点恢复。执行稀疏数据库的时间点恢复类似于执行正常数据库的时间点恢复。本节介绍基本闪回数据库和DBPITR方案的变体。闪回数据库可用于撤消OPEN RESETLOGS操作。跨OPEN RESETLOGS的闪回数据库可用于在Data Guard环境中执行多个功能。您可以使用闪回数据库将数据库回滚到废弃的数据库化身。要将DPITR执行到非当前数据库化身，必须显式执行RESET DATABASE以将数据库重置为目标SCN上当前的化身。您还必须从包含目标SCN的数据库化身中还原控制文件。">执行闪回和数据库时间点恢复</a></p>
                           </li>
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=NTQRF280" target="_blank"><span><cite>适用于Microsoft Windows的Oracle数据库管理员参考，</cite></span></a>了解如何在VSS环境中进行备份</p>
                           </li>
                        </ul>
                     </div>
                  </div><a id="BRADV89419"></a><div class="props_rev_3"><a id="GUID-5713C139-8CD8-4CC8-BFFB-81213EC0F8E1" name="GUID-5713C139-8CD8-4CC8-BFFB-81213EC0F8E1"></a><h5 id="BRADV-GUID-5713C139-8CD8-4CC8-BFFB-81213EC0F8E1" class="sect5"><span class="enumeration_section">5.4.1.1</span>使用Oracle托管文件和自动存储管理的快速恢复区</h5>
                     <div>
                        <p>快速恢复区域可与Oracle托管文件（OMF）和自动存储管理（ASM）一起使用</p>
                        <p>由于快速恢复区域构建在OMF之上，因此可以存储在Oracle Managed Files可以存储的任何位置。您还可以将恢复区域与ASM一起使用。</p>
                        <p>即使您选择不在ASM存储中设置快速恢复区域，仍可以使用Oracle Managed Files管理ASM磁盘组中的备份文件。但是，您将失去快速恢复区域的主要优势：自动删除不再需要的文件以满足您的可恢复性目标，因为最近的备份需要空间。尽管如此，OMF的其他自动功能仍然有效。</p>
                        <p>当您的商店备份时，支持在ASM之上使用OMF而不使用快速恢复区域但不鼓励。在ASM下直接操作文件很尴尬。</p>
                     </div>
                  </div><a id="BRADV89420"></a><div class="props_rev_3"><a id="GUID-0454CE22-F2A1-4053-8DC6-AC1714814352" name="GUID-0454CE22-F2A1-4053-8DC6-AC1714814352"></a><h5 id="BRADV-GUID-0454CE22-F2A1-4053-8DC6-AC1714814352" class="sect5"><span class="enumeration_section">5.4.1.2</span> Oracle如何管理快速恢复区中的磁盘空间</h5>
                     <div>
                        <p>快速恢复区域中的空间在备份和归档日志之间进行平衡，这些日志必须根据保留策略以及可能要删除的其他文件进行保留。</p>
                        <p>Oracle数据库不会从快速恢复区删除符合条件的文件，直到必须为其他目的回收该空间。但是，从Oracle Database Release 19c开始，将自动删除超出配置保留期的闪回日志。最近移动到磁带的文件通常仍可在磁盘上用于恢复。因此，恢复区域可以用作磁带的缓存。当快速恢复区域已满时，Oracle数据库会根据需要自动删除符合条件的文件以回收恢复区域中的空间。</p>
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>相关话题</strong></p>
                           <ul>
                              <li><a href="maintaining-rman-backups.html#GUID-2D7B9EF4-C306-4377-82F2-DDE3549FB63C">快速恢复区的删除规则</a></li>
                              <li><a href="maintaining-rman-backups.html#GUID-3F11ECB5-1321-45F5-A557-BB1A5BAF011F">响应完全快速恢复区</a></li>
                              <li><a href="maintaining-rman-backups.html#GUID-26C1A1E8-5555-4399-9DD1-39BA90E45A0C">管理快速恢复区域中闪回日志的空间</a></li>
                           </ul>
                        </div>
                     </div>
                  </div>
               </div><a id="BRADV572"></a><a id="BRADV89425"></a><div class="props_rev_3"><a id="GUID-233338E2-3EE6-4248-A2B6-16A7899DB14F" name="GUID-233338E2-3EE6-4248-A2B6-16A7899DB14F"></a><h4 id="BRADV-GUID-233338E2-3EE6-4248-A2B6-16A7899DB14F" class="sect4"><span class="enumeration_section">5.4.2</span>启用快速恢复区</h4>
                  <div>
                     <p>通过设置两个初始化参数来启用快速恢复区域。这些参数启用快速恢复区域，无论是否必须关闭并重新启动数据库实例。</p>
                     <div class="section">
                        <p>您设定的参数快速恢复区的大小<code class="codeph">DB_RECOVERY_FILE_DEST_SIZE</code>第一，然后设定参数快速恢复文件的物理位置<code class="codeph">DB_RECOVERY_FILE_DEST</code> 。</p>
                        <p><a href="configuring-rman-client-basic.html#GUID-233338E2-3EE6-4248-A2B6-16A7899DB14F__CHDDJJHE" title="该表描述了DB_RECOVERY_FILE_DEST_SIZE和DB_RECOVERY_FILE_DEST参数。">表5-3</a>讨论了启用快速恢复区域的必需参数和可选参数。
                        </p>
                        <p>在Oracle Real Application Clusters（Oracle RAC）数据库中，所有实例必须具有相同的初始化参数值。该位置必须位于群集文件系统，ASM或共享目录中。</p>
                        <div class="tblformalwide" id="GUID-233338E2-3EE6-4248-A2B6-16A7899DB14F__CHDDJJHE">
                           <p class="titleintable">表5-3快速恢复区的初始化参数</p>
                           <table cellpadding="4" cellspacing="0" class="FormalWide" title="快速恢复区的初始化参数" width="100%" border="1" summary="This table describes the DB_RECOVERY_FILE_DEST_SIZE and DB_RECOVERY_FILE_DEST parameters." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="43%" id="d22448e4964">初始化参数</th>
                                    <th align="left" valign="bottom" width="14%" id="d22448e4967">需要</th>
                                    <th align="left" valign="bottom" width="43%" id="d22448e4970">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="43%" id="d22448e4975" headers="d22448e4964 ">
                                       <p> <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=REFRN10235" target="_blank"><code class="codeph">DB_RECOVERY_FILE_DEST_SIZE</code></a> 
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="14%" headers="d22448e4975 d22448e4967 ">
                                       <p>是</p>
                                    </td>
                                    <td align="left" valign="top" width="43%" headers="d22448e4975 d22448e4970 ">
                                       <p>指定<a href="glossary.html#GUID-925AC655-2953-4F1F-9E5A-F8EA6D9DA552"><span class="xrefglossterm">磁盘配额</span></a> ，即此数据库的恢复区域要使用的最大数据存储空间（以字节为单位）。您必须<span class="italic">在</span> <code class="codeph">DB_RECOVERY_FILE_DEST</code> <span class="italic">之前</span>设置此参数。</p>
                                       <p><code class="codeph">DB_RECOVERY_FILE_DEST_SIZE</code>设置不包括以下类型的磁盘开销：</p>
                                       <ul style="list-style-type:disc">
                                          <li>
                                             <p>不包括每个Oracle数据库文件的块0或操作系统块头。</p>
                                             <p>在计算快速恢复区域所需的实际磁盘使用量时，允许额外10％的此数据。</p>
                                          </li>
                                          <li>
                                             <p>当基础文件系统被Oracle数据库不知道的开销镜像，压缩或影响时， <code class="codeph">DB_RECOVERY_FILE_DEST_SIZE</code>不指示磁盘上占用的实际大小。
                                             </p>
                                             <p>例如，如果恢复区域位于双向镜像ASM磁盘组上，则每个<span class="italic">x</span>字节文件在ASM磁盘组上占用2 <span class="italic">x</span>字节。在这种情况下，请将<code class="codeph">DB_RECOVERY_FILE_DEST_SIZE</code>设置为不超过ASM磁盘组磁盘大小的一半。同样，使用三向镜像ASM磁盘组时， <code class="codeph">DB_RECOVERY_FILE_DEST_SIZE</code>必须不超过磁盘组中磁盘大小的三分之一，依此类推。
                                             </p>
                                          </li>
                                       </ul>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="43%" id="d22448e5029" headers="d22448e4964 ">
                                       <p> <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=REFRN10234" target="_blank"><code class="codeph">DB_RECOVERY_FILE_DEST</code></a></p>
                                    </td>
                                    <td align="left" valign="top" width="14%" headers="d22448e5029 d22448e4967 ">
                                       <p>是</p>
                                    </td>
                                    <td align="left" valign="top" width="43%" headers="d22448e5029 d22448e4970 ">
                                       <p>指定恢复区位置，可以是文件系统目录或ASM磁盘组，但不能是原始磁盘。该位置必须足以容纳磁盘配额。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="43%" id="d22448e5043" headers="d22448e4964 ">
                                       <p> <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=REFRN10233" target="_blank"><code class="codeph">DB_FLASHBACK_RETENTION_TARGET</code></a> 
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="14%" headers="d22448e5043 d22448e4967 ">
                                       <p>没有</p>
                                    </td>
                                    <td align="left" valign="top" width="43%" headers="d22448e5043 d22448e4970 ">
                                       <p>指定数据库闪回的时间长度的上限（以分钟为单位）。仅闪回数据库需要此参数。</p>
                                       <p>此参数间接确定恢复区域中保留的闪回日志数据量。数据库生成的闪回日志的大小可能因数据库工作负载而有很大差异。如果在给定时间间隔内数据库更新会影响更多块，则为该时间间隔生成的闪回日志数据将使用更多磁盘空间。</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                        <div class="infoboxnotealso" id="GUID-233338E2-3EE6-4248-A2B6-16A7899DB14F__GUID-13EC7E8A-AB4C-46A3-B85C-89C94E6066C7">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><code class="codeph">ALTER</code> <code class="codeph">SYSTEM</code>语法的<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=SQLRF00902" target="_blank"><span><cite>Oracle数据库SQL语言参考</cite></span></a></p>
                              </li>
                              <li>
                                 <p>有关设置和更改数据库初始化参数的详细信息，请参见<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=ADMIN002" target="_blank"><span><cite>“Oracle数据库管</cite></span></a></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div><a id="BRADV89422"></a><div class="props_rev_3"><a id="GUID-F8BFD7F3-345D-4A9E-9596-86AEAB29507D" name="GUID-F8BFD7F3-345D-4A9E-9596-86AEAB29507D"></a><h5 id="BRADV-GUID-F8BFD7F3-345D-4A9E-9596-86AEAB29507D" class="sect5"><span class="enumeration_section">5.4.2.1</span>设置快速恢复区大小时的注意事项</h5>
                     <div>
                        <p>快速恢复区域越大，它就越有用。理想情况下，快速恢复区域足够大，可以包含控制文件，联机重做日志，归档重做日志和闪回日志。它应该能够包含数据库中所有数据文件的副本以及所选备份策略使用的增量备份。</p>
                        <p>如果提供这么大的空间是不切实际的，那么最好创建一个足够大的区域来备份最重要的表空间和所有尚未存储在磁带上的存档日志。在绝对最小值时，快速恢复区域必须足够大，以包含尚未在磁带上存档的重做日志。如果恢复区域没有足够的空间来存储新的闪回日志并满足其他备份保留要求，那么为了腾出空间，恢复区域可能会删除较旧的闪回日志。</p>
                        <p>估算有用的快速恢复区域大小的公式取决于是否：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>您的数据库有少量或大量经常更改的数据块</p>
                           </li>
                           <li>
                              <p>您只将备份存储在磁盘上，或磁盘和磁带上</p>
                           </li>
                           <li>
                              <p>您使用基于冗余的<a href="glossary.html#GUID-ECF0ADBB-3255-43A2-A425-26850EA598EA"><span class="xrefglossterm">备份保留策略</span></a>或基于恢复窗口的保留策略</p>
                           </li>
                           <li>
                              <p>您计划使用闪回数据库或<a href="glossary.html#GUID-CC1A7D5D-50B6-4F90-89DE-855B21C299F2"><span class="xrefglossterm">保证还原点</span></a>作为响应逻辑错误的<a href="glossary.html#GUID-491BEF3A-18F0-4670-B078-2D84765141E8"><span class="xrefglossterm">时间点</span></a> <a href="glossary.html#GUID-CC1A7D5D-50B6-4F90-89DE-855B21C299F2"><span class="xrefglossterm">恢复的</span></a>替代方法</p>
                           </li>
                        </ul>
                        <p>如果您计划启用闪回日志记录，则闪回日志生成的大小与重做日志生成大致相同。例如，如果您打算将<code class="codeph">DB_FLASHBACK_RETENTION_TARGET</code>设置为24小时，并且数据库在一天内生成20千兆字节的重做，则一般的经验法则是允许20 GB到30 GB的磁盘空间用于闪回日志。启用闪回日志记录时，同样的规则适用于保证还原点。例如，如果数据库每天生成20 GB的重做，并且保证还原点保留一天，则计划分配20到30 GB。</p>
                        <p>假设您希望在备份保留策略设置为<code class="codeph">REDUNDANCY 1</code>时确定快速恢复区域的大小，并且您打算遵循Oracle建议的<a href="glossary.html#GUID-F879F805-CAD5-4798-B9C1-A9C877D4FBC8"><span class="xrefglossterm">永久</span></a>使用<a href="glossary.html#GUID-F879F805-CAD5-4798-B9C1-A9C877D4FBC8"><span class="xrefglossterm">增量的</span></a>策略。在此示例中，您使用以下公式来估计磁盘配额，其中<span class="italic">n</span>是增量更新之间的间隔天数， <span class="italic">y</span>是在逻辑备用数据库上应用外部归档重做日志的延迟：</p><pre class="pre codeblock"><code>磁盘配额=数据库副本的大小+增量备份的大小+归档重做日志的大小（n + 1）天+外部归档重做日志的大小（y + 1）天（逻辑备用）+大小控制文件+在线重做日志成员的大小*日志组的数量+闪回日志的大小（基于DB_FLASHBACK_RETENTION_TARGET值）</code></pre></div>
                  </div><a id="BRADV90060"></a><div class="props_rev_3"><a id="GUID-ED4F069D-EFEB-4739-97C4-1C80326AB223" name="GUID-ED4F069D-EFEB-4739-97C4-1C80326AB223"></a><h5 id="BRADV-GUID-ED4F069D-EFEB-4739-97C4-1C80326AB223" class="sect5"><span class="enumeration_section">5.4.2.2</span>设置快速恢复区位置时的注意事项</h5>
                     <div>
                        <p>将快速恢复区域放在与<a href="glossary.html#GUID-B2954743-3455-4045-9200-891927E38048"><span class="xrefglossterm">数据库区域</span></a>不同的磁盘上， <a href="glossary.html#GUID-B2954743-3455-4045-9200-891927E38048"><span class="xrefglossterm">数据库区域</span></a>中的数据库维护活动数据库文件，如数据文件，控制文件和联机重做日志。将快速恢复区域保留在与数据库区域相同的磁盘上会使您在发生介质故障时丢失实时数据库文件和备份。
                        </p>
                        <p>Oracle建议将<code class="codeph">DB_RECOVERY_FILE_DEST</code>设置为与<code class="codeph">DB_CREATE_FILE_DEST</code>或任何<code class="codeph">DB_CREATE_ONLINE_LOG_DEST_</code> <span class="italic"><code class="codeph">n</code></span>初始化参数不同的值。如果<code class="codeph">DB_RECOVERY_FILE_DEST</code>等于这些参数，则数据库会向警报日志写入警告。
                        </p>
                        <p>多个数据库可以具有相同的<code class="codeph">DB_RECOVERY_FILE_DEST</code>值，但必须满足以下条件之一：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>没有为其指定<a href="../refrn/DB_UNIQUE_NAME.html#REFRN10242" target="_blank"><code class="codeph">DB_UNIQUE_NAME</code></a>初始化参数的两个数据库具有相同的<code class="codeph">DB_UNIQUE_NAME</code>值。</p>
                           </li>
                           <li>
                              <p>对于未提供<code class="codeph">DB_UNIQUE_NAME</code>数据库，没有两个数据库具有相同的<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=REFRN10041" target="_blank"><code class="codeph">DB_NAME</code></a>值。</p>
                           </li>
                        </ul>
                        <p>当数据库以这种方式共享单个恢复区域时，该位置应足够大以容纳所有数据库的文件。为数据库添加<code class="codeph">DB_RECOVERY_FILE_DEST_SIZE</code>的值，然后允许镜像或压缩等开销。
                        </p>
                     </div>
                  </div><a id="BRADV573"></a><a id="BRADV89424"></a><div class="props_rev_3"><a id="GUID-CD308CD0-2230-4F2A-8ADB-E2401010AED9" name="GUID-CD308CD0-2230-4F2A-8ADB-E2401010AED9"></a><h5 id="BRADV-GUID-CD308CD0-2230-4F2A-8ADB-E2401010AED9" class="sect5"><span class="enumeration_section">5.4.2.3</span>设置快速恢复区位置和初始大小</h5>
                     <div>
                        <p>使用数据库初始化参数来设置快速恢复区域的位置和大小。</p>
                        <div class="section">
                           <p><a href="configuring-rman-client-basic.html#GUID-233338E2-3EE6-4248-A2B6-16A7899DB14F__CHDDJJHE" title="该表描述了DB_RECOVERY_FILE_DEST_SIZE和DB_RECOVERY_FILE_DEST参数。">表5-3</a>列出了为启用快速恢复区域必须设置的初始化参数。本节介绍如何指定恢复区的位置并设置其初始大小。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-CD308CD0-2230-4F2A-8ADB-E2401010AED9__GUID-31DD8287-3F8F-482C-A566-4CA5EB641390">要确定快速恢复区域的最佳大小并设置恢复区域位置：</p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand" id="GUID-CD308CD0-2230-4F2A-8ADB-E2401010AED9__CHDJBFCA"><span>如果您计划使用闪回日志记录或保证还原点，则查询<code class="codeph">V$ARCHIVED_LOG</code>以确定数据库在您要设置<code class="codeph">DB_FLASHBACK_RETENTION_TARGET</code>的时间内生成的重做<code class="codeph">DB_FLASHBACK_RETENTION_TARGET</code> 。</span></li>
                           <li class="stepexpand"><span>设置恢复区域大小。</span><div>
                                 <p>如果您计划使用闪回日志记录或保证还原点，请确保将从步骤<a href="configuring-rman-client-basic.html#GUID-CD308CD0-2230-4F2A-8ADB-E2401010AED9__CHDJBFCA">1</a>获取的大小值合并到设置中。通过以下任何方式设置<code class="codeph">DB_RECOVERY_FILE_DEST_SIZE</code>初始化参数：</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p>关闭数据库并在数据库的初始化参数文件中设置<code class="codeph">DB_RECOVERY_FILE_DEST_SIZE</code>参数，如以下示例所示：</p><pre class="oac_no_warn" dir="ltr">DB_RECOVERY_FILE_DEST_SIZE = 10G</pre></li>
                                    <li>
                                       <p>在数据库打开时使用SQL语句<code class="codeph">ALTER</code> <code class="codeph">SYSTEM</code> <code class="codeph">SET</code>指定参数，如以下示例所示：</p><pre class="oac_no_warn" dir="ltr">ALTER SYSTEM SET DB_RECOVERY_FILE_DEST_SIZE = 10G SCOPE = BID = SID ='*';</pre><div class="infoboxnote" id="GUID-CD308CD0-2230-4F2A-8ADB-E2401010AED9__GUID-E5F223C4-DA0B-4A73-B905-E9E01AAD85BB">
                                          <p class="notep1">注意：</p>
                                          <p><code class="codeph">DB_RECOVERY_FILE_DEST_SIZE</code>和<code class="codeph">DB_RECOVERY_FILE_DEST</code>设置必须在数据库启动和关闭期间保持<code class="codeph">DB_RECOVERY_FILE_DEST</code> 。如果使用服务器参数文件，则设置<code class="codeph">SCOPE=BOTH</code>导致设置持久。但是，如果未使用服务器参数文件，则<code class="codeph">ALTER SYSTEM</code>命令所做的<code class="codeph">ALTER SYSTEM</code>不会持久。您还必须将这些参数添加到初始化参数文件中。
                                          </p>
                                       </div>
                                    </li>
                                    <li>
                                       <p>使用Database Configuration Assistant设置大小。</p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li class="stepexpand"><span>设置恢复区域位置。</span><div>
                                 <p>通过以下任何方式设置初始化参数：</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p>在数据库的参数文件中设置<code class="codeph">DB_RECOVERY_FILE_DEST</code> ，如以下示例所示：</p><pre class="oac_no_warn" dir="ltr">DB_RECOVERY_FILE_DEST ='/ u01 / oradata / rcv_area'</pre></li>
                                    <li>
                                       <p>在数据库打开时，使用SQL语句<code class="codeph">ALTER</code> <code class="codeph">SYSTEM</code> <code class="codeph">SET</code>指定<code class="codeph">DB_RECOVERY_FILE_DEST</code> 。
                                       </p>
                                       <p>以下示例将快速恢复区域设置为名为<code class="codeph">disk1</code>的自动存储管理（ASM）磁盘组：</p><pre class="oac_no_warn" dir="ltr">ALTER SYSTEM SET DB_RECOVERY_FILE_DEST ='+ disk1'SCOPE = BOTH SID ='*';</pre><p>以下示例将快速恢复区域设置为文件系统目录<code class="codeph">/disk1/fast_recovery_area</code> ：</p><pre class="oac_no_warn" dir="ltr">ALTER SYSTEM SET DB_RECOVERY_FILE_DEST ='/ disk1 / fast_recovery_area'SCOPE = BOTH SID ='*';</pre></li>
                                    <li>
                                       <p>使用Database Configuration Assistant设置位置。</p>
                                    </li>
                                 </ul>
                                 <p>如果您<span class="italic">不</span>打算使用闪回日志记录，则打开数据库（如果已关闭），并且不完成此过程中的其余步骤。
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>如果启用了闪回日志记录，则在<code class="codeph">DB_FLASHBACK_RETENTION_TARGET</code>指定的<code class="codeph">DB_FLASHBACK_RETENTION_TARGET</code>以正常工作负载运行数据库。</span><div>
                                 <p>通过这种方式，数据库可以生成闪回日志的代表性样本。</p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>查询<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=REFRN30300" target="_blank"><code class="codeph">V$FLASHBACK_DATABASE_LOG</code></a>视图，如下所示：</span><div><pre class="oac_no_warn" dir="ltr">从V $ FLASHBACK_DATABASE_LOG中选择ESTIMATED_FLASHBACK_SIZE;</pre><p>结果是根据自启用闪回数据库以来的数据库工作负载，估计满足当前闪回保留目标所需的磁盘空间。</p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>如有必要，请根据<code class="codeph">DB_FLASHBACK_RETENTION_TARGET</code>指定的<code class="codeph">DB_FLASHBACK_RETENTION_TARGET</code>生成的闪回日志的实际大小调整闪回日志空间要求。</span></li>
                        </ol>
                        <div class="section">
                           <div class="infoboxnotealso" id="GUID-CD308CD0-2230-4F2A-8ADB-E2401010AED9__GUID-9C15DCEE-436A-48BA-9319-A2180BA39871">
                              <p class="notep1">也可以看看：</p>
                              <p><span class="q">“ <a href="maintaining-rman-backups.html#GUID-26C1A1E8-5555-4399-9DD1-39BA90E45A0C" title="除了设置闪回保留目标或使用保证还原点之外，您无法直接管理快速恢复区域中的闪回日志。">在快速恢复区域中管理闪回日志的空间</a> ”</span></p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div><a id="BRADV528"></a><div class="props_rev_3"><a id="GUID-A90518CA-CBCA-4B8F-AC98-373445371FD4" name="GUID-A90518CA-CBCA-4B8F-AC98-373445371FD4"></a><h4 id="BRADV-GUID-A90518CA-CBCA-4B8F-AC98-373445371FD4" class="sect4"><span class="enumeration_section">5.4.3</span>禁用快速恢复区</h4>
                  <div>
                     <p>您可以使用<code class="codeph">ALTER SYSTEM</code>命令禁用快速恢复区域。
                     </p>
                     <div class="section">
                        <p>如果您已启用闪回数据库或使用快速恢复区域存档日志，请从下面的步骤中执行相应的步骤。否则，请跳至步骤3：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>如果启用了闪回数据库，则在禁用快速恢复区域之前禁用它。</span><div><pre class="oac_no_warn" dir="ltr">ALTER DATABASE FLASHBACK OFF;</pre></div>
                        </li>
                        <li class="stepexpand"><span>如果使用快速恢复区域存档日志，则将初始化参数<code class="codeph">LOG_ARCHIVE_DEST_</code> <span class="italic">n设置</span>为使用非快速恢复区域位置。</span><div>
                              <p>例如，要将<code class="codeph">LOG_ARCHIVE_DEST_1</code>的快速恢复区域更改为非快速恢复区域位置，请使用命令<code class="codeph">ALTER SYSTEM SET</code> ：</p><pre class="oac_no_warn" dir="ltr">LOG_ARCHIVE_DEST_1 = 'LOCATION = USE_DB_RECOVERY_FILE_DEST'</pre><pre class="oac_no_warn" dir="ltr">ALTER SYSTEM SET LOG_ARCHIVE_DEST_1 ='LOCATION = / ORACLE / DBS /';</pre></div>
                        </li>
                        <li class="stepexpand"><span>禁用快速恢复区初始化参数。</span><div><pre class="oac_no_warn" dir="ltr">ALTER SYSTEM SET DB_RECOVERY_FILE_DEST ='';</pre></div>
                        </li>
                     </ol>
                  </div>
               </div><a id="BRADV89428"></a><div class="props_rev_3"><a id="GUID-B6AB2CA1-573D-40E0-906F-9A8F3FA5597E" name="GUID-B6AB2CA1-573D-40E0-906F-9A8F3FA5597E"></a><h4 id="BRADV-GUID-B6AB2CA1-573D-40E0-906F-9A8F3FA5597E" class="sect4"><span class="enumeration_section">5.4.4</span>配置控制文件和重做日志的位置</h4>
                  <div>
                     <p>使用初始化参数配置控制文件和重做日志的默认位置。</p>
                     <div class="infoboxnotealso" id="GUID-B6AB2CA1-573D-40E0-906F-9A8F3FA5597E__GUID-43E695DF-ED4E-4BD2-A0CA-5E1C264E9892">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="configuring-rman-client-basic.html#GUID-061CCF1D-2C8D-4460-B469-9C32893A590A" title="快速恢复区域可以包含控制文件，联机重做日志，归档重做日志，闪回日志和RMAN备份。">快速恢复区中的文件概述</a></p>
                           </li>
                           <li>
                              <p><a href="configuring-rman-client-basic.html#GUID-F8A849BE-8276-4786-9B29-387E296B10DA">配置联机重做日志位置</a></p>
                           </li>
                           <li>
                              <p><a href="configuring-rman-client-basic.html#GUID-652242E6-F0DC-468D-8966-216472CE6136" title="初始化参数CONTROL_FILES，DB_CREATE_ONLINE_LOG_DEST_n，DB_RECOVERY_FILE_DEST和DB_CREATE_FILE_DEST都进行交互以确定创建数据库控制文件的位置。">配置控制文件位置</a></p>
                           </li>
                           <li>
                              <p><a href="configuring-rman-client-basic.html#GUID-84988C3B-8F97-460A-8882-C26979F53836" title="Oracle建议您将快速恢复区域用作归档位置，因为归档日志由数据库自动管理。">配置存档重做日志位置</a></p>
                           </li>
                        </ul>
                     </div>
                  </div><a id="BRADV89429"></a><div class="props_rev_3"><a id="GUID-F8A849BE-8276-4786-9B29-387E296B10DA" name="GUID-F8A849BE-8276-4786-9B29-387E296B10DA"></a><h5 id="BRADV-GUID-F8A849BE-8276-4786-9B29-387E296B10DA" class="sect5"><span class="enumeration_section">5.4.4.1</span>配置在线重做日志位置</h5>
                     <div>
                        <div class="section">
                           <p>确定联机重做日志文件创建位置的初始化参数是<code class="codeph">DB_CREATE_ONLINE_LOG_DEST_</code> <span class="italic"><code class="codeph">n</code></span> ， <code class="codeph">DB_RECOVERY_FILE_DEST</code>和<code class="codeph">DB_CREATE_FILE_DEST</code> 。</p>
                           <p>以下SQL语句可以在快速恢复区域中创建联机重做日志：</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=SQLRF01204" target="_blank"><code class="codeph">创建数据库</code></a></p>
                              </li>
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=SQLRF00802" target="_blank"><code class="codeph">ALTER DATABASE添加LOGFILE</code></a></p>
                              </li>
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=SQLRF00802" target="_blank"><code class="codeph">ALTER DATABASE添加STANDBY LOGFILE</code></a></p>
                              </li>
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=SQLRF00802" target="_blank"><code class="codeph">ALTER DATABASE OPEN RESETLOGS</code></a></p>
                              </li>
                           </ul>
                           <p>在快速恢复区域中创建的联机日志的默认大小为100 MB。日志成员文件名由数据库自动生成。</p>
                           <div class="infoboxnotealso" id="GUID-F8A849BE-8276-4786-9B29-387E296B10DA__GUID-00663A89-72C5-4035-9F65-784D1A56BD93">
                              <p class="notep1">也可以看看：</p>
                              <p>有关初始化参数组合对联机重做日志创建的影响的详细信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=SQLRF01204" target="_blank"><span><cite>Oracle数据库SQL语言参考中</cite></span></a> <code class="codeph">CREATE</code> <code class="codeph">DATABASE</code>语句的<code class="codeph">LOGFILE</code>子句的说明</p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="BRADV89430"></a><div class="props_rev_3"><a id="GUID-652242E6-F0DC-468D-8966-216472CE6136" name="GUID-652242E6-F0DC-468D-8966-216472CE6136"></a><h5 id="BRADV-GUID-652242E6-F0DC-468D-8966-216472CE6136" class="sect5"><span class="enumeration_section">5.4.4.2</span>配置控制文件位置</h5>
                     <div>
                        <p>初始化参数<code class="codeph">CONTROL_FILES</code> ， <code class="codeph">DB_CREATE_ONLINE_LOG_DEST_</code> <span class="italic"><code class="codeph">n</code></span> ， <code class="codeph">DB_RECOVERY_FILE_DEST</code>和<code class="codeph">DB_CREATE_FILE_DEST</code>所有交互，以确定在其中创建数据库控制文件的位置。
                        </p>
                        <div class="section">
                           <p>如果数据库创建Oracle托管控制文件，并且数据库使用服务器参数文件，则数据库会在服务器参数文件中设置<code class="codeph">CONTROL_FILES</code>初始化参数。如果数据库使用客户端初始化参数文件，则必须在初始化参数文件中手动设置<code class="codeph">CONTROL_FILES</code>初始化参数。
                           </p>
                           <div class="infoboxnotealso" id="GUID-652242E6-F0DC-468D-8966-216472CE6136__GUID-9C32994B-2ACD-4DC8-8D39-8AC10073C805">
                              <p class="notep1">也可以看看：</p>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=SQLRF01203" target="_blank"><span><cite>Oracle数据库SQL语言参考</cite></span></a>中<code class="codeph">CREATE CONTROLFILE</code>描述的“语义”部分，以获取这些参数如何交互的完整描述</p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="BRADV89431"></a><div class="props_rev_3"><a id="GUID-84988C3B-8F97-460A-8882-C26979F53836" name="GUID-84988C3B-8F97-460A-8882-C26979F53836"></a><h5 id="BRADV-GUID-84988C3B-8F97-460A-8882-C26979F53836" class="sect5"><span class="enumeration_section">5.4.4.3</span>配置存档重做日志位置</h5>
                     <div>
                        <p>Oracle建议您将快速恢复区域用作归档位置，因为归档日志由数据库自动管理。</p>
                        <div class="section">
                           <p>快速恢复区域中存档日志的生成文件名是针对Oracle管理的文件，不是由参数<code class="codeph">LOG_ARCHIVE_FORMAT</code>确定的。无论您选择哪种归档方案，始终建议创建归档重做日志的多个副本。
                           </p>
                           <p>您可以使用以下基本选项来归档重做日志，从最常用到最低建议列出：</p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span><span class="italic">仅对</span>快速恢复区域启用存档，并使用磁盘镜像创建保护存档重做日志所需的冗余。</span><div>
                                 <p>如果指定了<code class="codeph">DB_RECOVERY_FILE_DEST</code>指定<code class="codeph">LOG_ARCHIVE_DEST_</code> <span class="italic"><code class="codeph">n</code></span> ，则将<code class="codeph">LOG_ARCHIVE_DEST_10</code>隐式设置为恢复区域。您可以通过将<code class="codeph">LOG_ARCHIVE_DEST_10</code>设置为空字符串来覆盖此行为。
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>启用对快速恢复区域的归档，并将其他<code class="codeph">LOG_ARCHIVE_DEST_</code> <span class="italic"><code class="codeph">n</code></span>初始化参数设置为快速恢复区域外的位置。</span><div>
                                 <p>如果配置了快速恢复区域，则可以通过将任何<code class="codeph">LOG_ARCHIVE_DEST_</code> <span class="italic"><code class="codeph">n</code></span>参数设置为<code class="codeph">LOCATION=USE_DB_RECOVERY_FILE_DEST</code>来将快速恢复区域添加为归档目标。</p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>设置<code class="codeph">LOG_ARCHIVE_DEST_</code> <span class="italic"><code class="codeph">n</code></span>初始化参数以<span class="italic">仅</span>存档到非快速恢复区域位置。</span></li>
                        </ol>
                        <div class="section">
                           <p>如果使用快速恢复区，则无法使用<code class="codeph">LOG_ARCHIVE_DEST</code>和<code class="codeph">LOG_ARCHIVE_DUPLEX_DEST</code>初始化参数。使用这些参数中的任何一个都会阻止您启动实例。而是设置<code class="codeph">LOG_ARCHIVE_DEST_</code> <span class="italic"><code class="codeph">n</code></span>参数。在数据库使用<code class="codeph">LOG_ARCHIVE_DEST_</code> <span class="italic"><code class="codeph">n</code></span> ，您可以配置恢复区域。
                           </p>
                           <p>另请注意，如果启用归档但未为<code class="codeph">LOG_ARCHIVE_DEST</code> ， <code class="codeph">LOG_ARCHIVE_DEST_</code> <span class="italic"><code class="codeph">n</code></span>或<code class="codeph">DB_RECOVERY_FILE_DEST</code>设置任何值，则重做日志将归档到特定于平台的默认位置。例如，在Solaris上，默认是<code class="codeph">?/dbs</code> 。
                           </p>
                           <div class="infoboxnotealso" id="GUID-84988C3B-8F97-460A-8882-C26979F53836__GUID-C221286C-8693-4A94-B359-4C62D1768359">
                              <p class="notep1">也可以看看：</p>
                              <p>有关<code class="codeph">LOG_ARCHIVE_DEST_</code> <span class="italic"><code class="codeph">n</code></span>参数语义的详细信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=REFRN10086" target="_blank"><span><cite>参见Oracle数据库参考</cite></span></a></p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div><a id="BRADV89432"></a><div class="props_rev_3"><a id="GUID-AE300A8D-0485-436B-B9D2-D20F7D4B9EA5" name="GUID-AE300A8D-0485-436B-B9D2-D20F7D4B9EA5"></a><h4 id="BRADV-GUID-AE300A8D-0485-436B-B9D2-D20F7D4B9EA5" class="sect4"><span class="enumeration_section">5.4.5</span>配置快速恢复区域的RMAN文件创建</h4>
                  <div>
                     <p>某些RMAN命令或隐式操作（例如控制文件自动备份）可以在快速恢复区域中创建文件。</p>
                     <p>本节介绍如何控制命令是在快速恢复区域还是在其他目标中创建文件。命令是：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=RCMRF107" target="_blank"><code class="codeph">BACKUP</code></a></p>
                           <p>如果没有为磁盘备份指定<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=RCMRF195" target="_blank"><code class="codeph">FORMAT</code></a>子句，则RMAN会在快速恢复区域中创建备份片段和映像副本，其名称为Oracle Managed Files（OMF）格式。如果快速恢复区已启用，如果<span class="italic">你</span>指定<code class="codeph">FORMAT</code>的<code class="codeph">BACKUP</code>或一个通道，然后在RMAN特定平台的位置，而不是在恢复区创建备份。
                           </p>
                        </li>
                        <li>
                           <p>控制文件自动备份</p>
                           <p>RMAN可以在快速恢复区域中创建控制文件自动备份。使用RMAN命令<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=RCMRF113" target="_blank"><code class="codeph">CONFIGURE</code></a> <code class="codeph">CONTROLFILE AUTOBACKUP FORMAT FOR DEVICE TYPE DISK CLEAR</code>磁盘上控制文件自动备份位置的任何已配置格式选项。当没有配置其他目标时，RMAN在快速恢复区域中创建控制文件自动备份。
                           </p>
                        </li>
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=RCMRF149" target="_blank"><code class="codeph">RESTORE</code></a> <code class="codeph">ARCHIVELOG</code></p>
                           <p>明确地或隐含地设定<a id="d22448e6409" class="indexterm-anchor"></a> <code class="codeph">LOCATION=USE_DB_RECOVERY_FILE_DEST</code>的<code class="codeph">LOG_ARCHIVE_DEST_</code> <span class="italic"><code class="codeph">n</code></span>参数。如果未指定<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=RCMRF153" target="_blank"><code class="codeph">SET</code></a> <code class="codeph">ARCHIVELOG DESTINATION</code>来覆盖此行为，则RMAN会将归档的重做日志文件还原到快速恢复区域。
                           </p>
                        </li>
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=RCMRF140" target="_blank"><code class="codeph">RECOVER</code></a> <code class="codeph">DATABASE</code>或<code class="codeph">RECOVER TABLESPACE</code> ， <code class="codeph">RECOVER ...BLOCK</code>和<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=RCMRF194" target="_blank"><code class="codeph">FLASHBACK DATABASE</code></a></p>
                           <p>这些命令可以从备份还原存档的重做日志文件，以便在介质恢复期间按照命令的要求使用。RMAN将这些操作期间所需的任何重做日志文件还原到快速恢复区域，并在介质恢复期间应用它们后将其删除。</p>
                           <p>要将恢复的归档日志定向到快速恢复区域，请将<code class="codeph">LOG_ARCHIVE_DEST_</code> <span class="italic"><code class="codeph">n</code></span>参数设置为<code class="codeph">LOCATION = USE_DB_RECOVERY_FILE_DEST</code> 。确认您没有使用<code class="codeph">SET ARCHIVELOG DESTINATION</code>将已还原的日志定向到其他目标。
                           </p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div><a id="BRADV8400"></a><div class="props_rev_3"><a id="GUID-03DE4CF6-9D9F-4806-B5CA-CAA4CF5F2133" name="GUID-03DE4CF6-9D9F-4806-B5CA-CAA4CF5F2133"></a><h3 id="BRADV-GUID-03DE4CF6-9D9F-4806-B5CA-CAA4CF5F2133" class="sect3"><span class="enumeration_section">5.5</span>配置备份保留策略</h3>
               <div>
                  <p>备份保留策略指定必须保留哪些备份以满足您的数据恢复要求。</p>
                  <p>此策略可以基于<a href="glossary.html#GUID-1C595EF7-B8A1-4AA3-8C45-44E9FC8BAB9E"><span class="xrefglossterm">恢复窗口</span></a>或<a href="glossary.html#GUID-57A71B9A-2353-4669-A152-EFAD9AFF3ED3"><span class="xrefglossterm">冗余</span></a> 。使用<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=RCMRF113" target="_blank"><code class="codeph">CONFIGURE RETENTION POLICY</code></a>命令指定保留策略。
                  </p>
                  <p>本节包含以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="configuring-rman-client-basic.html#GUID-E9AEAC34-6C40-40A1-BAF5-3EAE20417715" title="CONFIGURE RETENTION POLICY命令的REDUNDANCY参数指定RMAN保留的每个数据文件和控制文件的完整备份数或0级备份数。默认保留策略为REDUNDANCY 1。">配置基于冗余的保留策略</a></p>
                     </li>
                     <li>
                        <p><a href="configuring-rman-client-basic.html#GUID-95ABBB30-713E-4781-B5C3-6ADBEB658DE3" title="CONFIGURE命令的RECOVERY WINDOW参数指定当前时间与最早可恢复点之间的天数。">配置基于恢复窗口的保留策略</a></p>
                     </li>
                     <li>
                        <p><a href="configuring-rman-client-basic.html#GUID-B668D2BC-8807-4308-AAB4-F3B85EA2B6C4" title="禁用保留策略时，RMAN不会将任何备份视为过时。">禁用保留策略</a></p>
                     </li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-03DE4CF6-9D9F-4806-B5CA-CAA4CF5F2133__GUID-6AF9B1F6-A96B-4E6C-8104-E80DF89C3B19">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="rman-backup-concepts.html#GUID-3F68F554-FBC9-4375-85DE-7F844C48C8FF" title="您可以使用CONFIGURE RETENTION POLICY命令创建持久性和自动备份保留策略。">关于备份保留策略</a></p>
                        </li>
                        <li>
                           <p><code class="codeph">CONFIGURE</code>语法的<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=RCMRF113" target="_blank"><span><cite>Oracle数据库备份和恢复参考</cite></span></a></p>
                        </li>
                     </ul>
                  </div>
               </div><a id="BRADV89436"></a><div class="props_rev_3"><a id="GUID-E9AEAC34-6C40-40A1-BAF5-3EAE20417715" name="GUID-E9AEAC34-6C40-40A1-BAF5-3EAE20417715"></a><h4 id="BRADV-GUID-E9AEAC34-6C40-40A1-BAF5-3EAE20417715" class="sect4"><span class="enumeration_section">5.5.1</span>配置基于冗余的保留策略</h4>
                  <div>
                     <p><code class="codeph">CONFIGURE</code> <code class="codeph">RETENTION</code> <code class="codeph">POLICY</code>命令的<code class="codeph">REDUNDANCY</code>参数指定RMAN保留的每个数据文件和控制文件的完整备份数或0级备份数。默认保留策略为<code class="codeph">REDUNDANCY 1</code> 。
                     </p>
                     <div class="section">
                        <p>如果特定数据文件或控制文件的完整备份或0级备份数超过<code class="codeph">REDUNDANCY</code>设置，则RMAN <code class="codeph">REDUNDANCY</code>额外备份视为过时。当您生成更多备份时，RMAN会跟踪要保留哪些备份以及哪些备份已过时。RMAN保留恢复非过时备份所需的所有归档日志和增量备份。
                        </p>
                        <p>假设您在星期一，星期二，星期三和星期四对数据文件7进行完整备份。您现在有四个完整备份此数据文件。如果<code class="codeph">REDUNDANCY</code>为<code class="codeph">2</code> ，则星期一和星期二备份已过时。如果您在星期五进行另一次备份，则数据文件7的星期三备份将过时。
                        </p>
                        <p>假设<code class="codeph">REDUNDANCY</code>为<code class="codeph">1</code>的不同情况。您在星期一中午运行0级数据库备份，在星期二和星期三中午运行1级累积备份，在星期四中午运行0级备份。每次每日备份后立即运行命令<code class="codeph">DELETE OBSOLETE</code> 。星期三<code class="codeph">DELETE</code>命令不会删除星期二的1级备份，因为此备份不是多余的：星期二1级备份可用于将星期一0级备份恢复到星期二中午和星期三中午之间的时间。但是，星期四的<code class="codeph">DELETE</code>命令会删除先前的0级和1级备份。
                        </p>
                        <p>在RMAN提示符下运行<code class="codeph">CONFIGURE</code> <code class="codeph">RETENTION</code> <code class="codeph">POLICY</code>命令，如下例所示：</p><pre class="pre codeblock"><code>配置保留政策以减少冗余3;</code></pre><div class="infoboxnotealso" id="GUID-E9AEAC34-6C40-40A1-BAF5-3EAE20417715__GUID-7C476B44-A877-4269-BC42-0EE9F412EAC6">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="maintaining-rman-backups.html#GUID-DB5F52FF-58DE-4486-B0B3-D0EAEA26A776" title="RMAN DELETE命令支持OBSOLETE选项，该选项删除不再需要的备份以满足指定的可恢复性要求。">根据保留策略删除过时的RMAN备份</a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="BRADV89437"></a><div class="props_rev_3"><a id="GUID-95ABBB30-713E-4781-B5C3-6ADBEB658DE3" name="GUID-95ABBB30-713E-4781-B5C3-6ADBEB658DE3"></a><h4 id="BRADV-GUID-95ABBB30-713E-4781-B5C3-6ADBEB658DE3" class="sect4"><span class="enumeration_section">5.5.2</span>配置基于恢复窗口的保留策略</h4>
                  <div>
                     <p><code class="codeph">CONFIGURE</code>命令的<code class="codeph">RECOVERY</code> <code class="codeph">WINDOW</code>参数指定当前时间与最早可恢复点之间的天数。
                     </p>
                     <div class="section">
                        <p>如果RMAN属于恢复窗口，则认为任何完全或<a href="glossary.html#GUID-DF84C185-E97D-4D3C-BF4E-41A9090C5F4C"><span class="xrefglossterm">0级增量备份</span></a>都不会过时。此外，RMAN还保留恢复到窗口中随机点所需的所有归档日志和1级增量备份。使用RMAN提示符下的<code class="codeph">CONFIGURE</code> <code class="codeph">RETENTION</code> <code class="codeph">POLICY</code>命令配置基于恢复窗口的保留策略。
                        </p>
                        <p>以下示例确保您可以将数据库恢复到上周的任何位置：</p><pre class="pre codeblock"><code>配置保留政策，以恢复7天的窗口;</code></pre><p>RMAN不会自动删除由恢复窗口废弃的备份。相反，RMAN在<code class="codeph">REPORT</code> <code class="codeph">OBSOLETE</code>输出和<code class="codeph">V$BACKUP_FILES</code> <code class="codeph">the OBSOLETE</code>列<code class="codeph">V$BACKUP_FILES</code>它们显示为<code class="codeph">OBSOLETE</code> 。如果运行<code class="codeph">DELETE</code> <code class="codeph">OBSOLETE</code>命令，RMAN将删除过时的文件。
                        </p>
                        <div class="infoboxnotealso" id="GUID-95ABBB30-713E-4781-B5C3-6ADBEB658DE3__GUID-272BEAC2-C0C4-4D92-A532-4829E88EFDB5">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="maintaining-rman-backups.html#GUID-DB5F52FF-58DE-4486-B0B3-D0EAEA26A776" title="RMAN DELETE命令支持OBSOLETE选项，该选项删除不再需要的备份以满足指定的可恢复性要求。">根据保留策略删除过时的RMAN备份</a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="BRADV89438"></a><div class="props_rev_3"><a id="GUID-B668D2BC-8807-4308-AAB4-F3B85EA2B6C4" name="GUID-B668D2BC-8807-4308-AAB4-F3B85EA2B6C4"></a><h4 id="BRADV-GUID-B668D2BC-8807-4308-AAB4-F3B85EA2B6C4" class="sect4"><span class="enumeration_section">5.5.3</span>禁用保留策略</h4>
                  <div>
                     <p>禁用保留策略时，RMAN不会将任何备份视为过时。</p>
                     <div class="section">
                        <p>要禁用保留策略，请运行以下命令：</p><pre class="oac_no_warn" dir="ltr">配置保留政策无;</pre><p>将保留策略配置为<code class="codeph">NONE</code>与清除保留策略不同。清除返回<code class="codeph">REDUNDANCY 1</code>的默认设置，而<code class="codeph">NONE</code>禁用它。
                        </p>
                        <p>如果禁用保留策略并运行<a href="../rcmrf/REPORT.html#RCMRF147" target="_blank"><code class="codeph">REPORT OBSOLETE</code></a>或<a href="../rcmrf/DELETE.html#RCMRF121" target="_blank"><code class="codeph">DELETE OBSOLETE</code></a>命令而不向该命令传递保留策略选项，则RMAN会发出错误，因为不存在用于确定哪些备份已过时的保留策略。
                        </p>
                        <div class="infoboxnote" id="GUID-B668D2BC-8807-4308-AAB4-F3B85EA2B6C4__GUID-E3884D59-4FAC-4FA6-BF76-485FE9D27657">
                           <p class="notep1">警告：</p>
                           <p>如果您使用的是快速恢复区域，请不要在禁用保留策略的情况下运行数据库。如果文件永远不会被认为是过时的，那么只有将文件备份到某个其他磁盘位置或第三级存储设备（如磁带）时，才能从快速恢复区删除该文件。此操作可能会占用恢复区中的所有空间，从而干扰数据库的正常操作。请参阅<span class="q">“ <a href="configuring-rman-client-basic.html#GUID-0454CE22-F2A1-4053-8DC6-AC1714814352" title="快速恢复区域中的空间在备份和归档日志之间进行平衡，这些日志必须根据保留策略以及可能要删除的其他文件进行保留。">Oracle如何管理快速恢复区中的磁盘空间</a> ”</span></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="BRADV138"></a><div class="props_rev_3"><a id="GUID-914A65A7-872E-465B-95E5-0FD5ADAF6A9C" name="GUID-914A65A7-872E-465B-95E5-0FD5ADAF6A9C"></a><h3 id="BRADV-GUID-914A65A7-872E-465B-95E5-0FD5ADAF6A9C" class="sect3"><span class="enumeration_section">5.6</span> Backup Optimization和CONFIGURE命令</h3>
               <div>
                  <p>运行RMAN <code class="codeph">CONFIGURE</code>命令以启用和禁用备份优化。如果备份了相同的文件或相同版本的文件，则备份优化会在某些情况下跳过文件备份。
                  </p>
                  <p>本节包含以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="configuring-rman-client-basic.html#GUID-ABA3E439-57C2-4AE7-BCEF-39A6663E7AA2" title="启用备份优化时，BACKUP命令会在将相同文件备份到指定的设备类型时跳过备份文件。">备份优化概述</a></p>
                     </li>
                     <li>
                        <p><a href="configuring-rman-client-basic.html#GUID-66D03493-7AD5-46D1-B7A3-2CAD69E0B8FE" title="备份到SBT设备时，并不总是应用备份优化。">保留策略对SBT备份备份优化的影响</a></p>
                     </li>
                     <li>
                        <p><a href="configuring-rman-client-basic.html#GUID-D78276FA-E505-4542-9D78-2335B5F94922" title="默认情况下，备份优化配置为OFF。您可以使用SHOW BACKUP OPTIMIZATION命令查看备份优化的当前设置。">配置备份优化</a></p>
                     </li>
                  </ul>
               </div><a id="BRADV574"></a><a id="BRADV113"></a><div class="props_rev_3"><a id="GUID-ABA3E439-57C2-4AE7-BCEF-39A6663E7AA2" name="GUID-ABA3E439-57C2-4AE7-BCEF-39A6663E7AA2"></a><h4 id="BRADV-GUID-ABA3E439-57C2-4AE7-BCEF-39A6663E7AA2" class="sect4"><span class="enumeration_section">5.6.1</span>备份优化概述</h4>
                  <div>
                     <p>启用备份优化时， <code class="codeph">BACKUP</code>命令会在将相同文件备份到指定的设备类型时跳过备份文件。
                     </p>
                     <p><a href="configuring-rman-client-basic.html#GUID-ABA3E439-57C2-4AE7-BCEF-39A6663E7AA2__CHDFJABD" title="该表在前面的文本中描述。">表5-4</a>描述了RMAN用于确定文件是否与其已备份的文件相同的条件。
                     </p>
                     <div class="tblformal" id="GUID-ABA3E439-57C2-4AE7-BCEF-39A6663E7AA2__CHDFJABD">
                        <p class="titleintable">表5-4确定相同文件的标准</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="确定相同文件的标准" width="100%" border="1" summary="This table is described in the preceding text." frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="33%" id="d22448e7322">文件类型</th>
                                 <th align="left" valign="bottom" width="67%" id="d22448e7325">确定相同文件的标准</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="33%" id="d22448e7330" headers="d22448e7322 ">
                                    <p>数据文件</p>
                                 </td>
                                 <td align="left" valign="top" width="67%" headers="d22448e7330 d22448e7325 ">
                                    <p>数据文件必须具有相同的<a href="glossary.html#GUID-2ABBEADC-F98C-4CF9-AD5B-065337E2733B"><span class="xrefglossterm">DBID</span></a> ， <a href="glossary.html#GUID-5FE755DB-A906-465A-A3E4-D067A77DA15C"><span class="xrefglossterm">检查点</span></a> SCN，创建SCN和<code class="codeph">RESETLOGS</code> SCN以及作为备份中的数据文件的时间。数据文件必须正常脱机，只读或正常关闭。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="33%" id="d22448e7346" headers="d22448e7322 ">
                                    <p>存档日志</p>
                                 </td>
                                 <td align="left" valign="top" width="67%" headers="d22448e7346 d22448e7325 ">
                                    <p>相同的DBID，线程，序列号和<code class="codeph">RESETLOGS</code> SCN和时间</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="33%" id="d22448e7356" headers="d22448e7322 ">
                                    <p>备份集</p>
                                 </td>
                                 <td align="left" valign="top" width="67%" headers="d22448e7356 d22448e7325 ">
                                    <p>相同的DBID，备份集记录ID和戳记</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p>如果RMAN确定文件相同且已备份，则它是要跳过的候选项。但是，RMAN必须进一步检查以确定是否跳过该文件，因为保留策略和备份双工功能都是算法中的因素，用于确定RMAN是否在指定的设备类型上有足够的备份。</p>
                     <p>满足以下条件时，RMAN使用备份优化：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>已运行<code class="codeph">CONFIGURE</code> <code class="codeph">BACKUP</code> <code class="codeph">OPTIMIZATION</code> <code class="codeph">ON</code>命令以启用备份优化。
                           </p>
                        </li>
                        <li>
                           <p>您运行<code class="codeph">BACKUP</code> <code class="codeph">DATABASE</code> ， <code class="codeph">BACKUP</code> <code class="codeph">ARCHIVELOG</code> with <code class="codeph">ALL</code>或<code class="codeph">LIKE</code>选项，或<code class="codeph">BACKUP</code> <code class="codeph">BACKUPSET</code> <code class="codeph">ALL</code> ， <code class="codeph">BACKUP RECOVERY AREA</code> ， <code class="codeph">BACKUP RECOVERY FILES</code>或<code class="codeph">BACKUP DATAFILECOPY</code> 。</p>
                           <div class="infoboxnote" id="GUID-ABA3E439-57C2-4AE7-BCEF-39A6663E7AA2__GUID-70E9BFDD-00CF-4E67-BF7E-8C4E39E3B801">
                              <p class="notep1">注意：</p>
                              <p>当<code class="codeph">TO DESTINATION</code>与<code class="codeph">BACKUP RECOVERY AREA</code>或<code class="codeph">BACKUP RECOVERY FILES</code> ，RMAN仅跳过在您提供的<code class="codeph">TO DESTINATION</code>位置具有相同备份的文件的备份。
                              </p>
                           </div>
                        </li>
                        <li>
                           <p>仅分配一种类型的通道，不要在同一备份命令中混合磁盘和<a href="glossary.html#GUID-2E48CE71-9547-4196-B715-5CE59033262E"><span class="xrefglossterm">SBT</span></a>通道。
                           </p>
                        </li>
                     </ul>
                     <div class="infoboxnote" id="GUID-ABA3E439-57C2-4AE7-BCEF-39A6663E7AA2__GUID-1A7B36F3-0D08-489A-B420-21A34435DDDA">
                        <p class="notep1">注意：</p>
                        <p>在<a href="glossary.html#GUID-06FF333B-92A2-4190-BF2C-09EBBEFA114D"><span class="xrefglossterm">备份撤消优化中</span></a> ，RMAN排除已提交事务的撤消更改（恢复备份不需要）。您可以启用和禁用备份优化，但备份撤消优化是内置行为。
                        </p>
                     </div>
                     <p>例如，假设您已配置备份优化。这些命令备份到磁带数据库，所有存档日志和所有备份集：</p><pre class="oac_no_warn" dir="ltr">备份设备类型sbt DATABASE PLUS ARCHIVELOG;备份设备类型sbt BACKUPSET ALL;</pre><p>如果自上次备份后没有更改备份文件，则RMAN不会再次备份文件。如果RMAN跳过命令中指定的所有文件，则RMAN也不会发出错误信号，因为文件已经备份。</p>
                     <p>您可以通过在<code class="codeph">BACKUP</code>命令上指定<code class="codeph">FORCE</code>选项随时覆盖优化。例如，您可以运行：</p><pre class="oac_no_warn" dir="ltr">备份数据库强制; BACKUP ARCHIVELOG ALL FORCE;</pre><div class="infoboxnotealso" id="GUID-ABA3E439-57C2-4AE7-BCEF-39A6663E7AA2__GUID-FB5C53D4-DA48-43C8-AAC4-04258900594D">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="../rcmrf/CONFIGURE.html#RCMRF113" target="_blank"><span><cite>Oracle数据库备份和恢复参考中</cite></span></a>的<code class="codeph">CONFIGURE</code>条目，以获取备份优化规则的完整说明</p>
                     </div>
                  </div>
               </div><a id="BRADV89462"></a><div class="props_rev_3"><a id="GUID-66D03493-7AD5-46D1-B7A3-2CAD69E0B8FE" name="GUID-66D03493-7AD5-46D1-B7A3-2CAD69E0B8FE"></a><h4 id="BRADV-GUID-66D03493-7AD5-46D1-B7A3-2CAD69E0B8FE" class="sect4"><span class="enumeration_section">5.6.2</span>保留策略对SBT备份备份优化的影响</h4>
                  <div>
                     <p>备份到SBT设备时，并不总是应用备份优化。</p>
                     <p>以下各节介绍了基于恢复窗口和基于冗余的保留策略的常规备份优化行为的例外情况。</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="configuring-rman-client-basic.html#GUID-27CE5FE2-DAF0-4E96-B7DF-933616E64C45">关于具有恢复窗口保留策略的SBT备份的备份优化</a></p>
                        </li>
                        <li>
                           <p><a href="configuring-rman-client-basic.html#GUID-56FA660A-E096-405C-B51B-AA927EC5DD0B">关于使用冗余保留策略进行SBT备份的备份优化</a></p>
                        </li>
                        <li>
                           <p><a href="configuring-rman-client-basic.html#GUID-D78276FA-E505-4542-9D78-2335B5F94922" title="默认情况下，备份优化配置为OFF。您可以使用SHOW BACKUP OPTIMIZATION命令查看备份优化的当前设置。">配置备份优化</a></p>
                        </li>
                     </ul>
                     <div class="infoboxnote" id="GUID-66D03493-7AD5-46D1-B7A3-2CAD69E0B8FE__GUID-B19188E6-6414-4EC8-AC87-882F46DE758C">
                        <p class="notep1">注意：</p>
                        <p>如果您使用具有自己的内部过期策略的媒体管理器，请在启用备份优化时小心。定期运行<a href="../rcmrf/CROSSCHECK.html#RCMRF119" target="_blank"><code class="codeph">CROSSCHECK</code></a>命令以使RMAN存储库与媒体管理器同步。否则，RMAN可能会因优化而跳过备份，而不会认识到介质管理器已丢弃存储在磁带上的备份。
                        </p>
                     </div>
                  </div><a id="BRADV89463"></a><div class="props_rev_3"><a id="GUID-27CE5FE2-DAF0-4E96-B7DF-933616E64C45" name="GUID-27CE5FE2-DAF0-4E96-B7DF-933616E64C45"></a><h5 id="BRADV-GUID-27CE5FE2-DAF0-4E96-B7DF-933616E64C45" class="sect5"><span class="enumeration_section">5.6.2.1</span>关于具有恢复窗口保留策略的SBT备份的备份优化</h5>
                     <div>
                        <p>假设已启用备份优化，并且恢复窗口<a href="glossary.html#GUID-ECF0ADBB-3255-43A2-A425-26850EA598EA"><span class="xrefglossterm">备份保留策略</span></a>有效。在这种情况下，执行SBT备份时，RMAN始终备份最近备份早于<a href="glossary.html#GUID-1C595EF7-B8A1-4AA3-8C45-44E9FC8BAB9E"><span class="xrefglossterm">恢复窗口的</span></a>数据文件。
                        </p>
                        <p>例如，假设以下情形：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>今天是2月21日。</p>
                           </li>
                           <li>
                              <p>恢复窗口为7天。</p>
                           </li>
                           <li>
                              <p>表空间<code class="codeph">tools</code>到磁带的最新备份是1月3日。
                              </p>
                           </li>
                           <li>
                              <p>表空间<code class="codeph">tools</code>是只读的。
                              </p>
                           </li>
                        </ul>
                        <p>2月21日，当您发出将表空间<code class="codeph">tools</code>备份到磁带的命令时，即使在1月3日备份后它没有更改（因为它是只读的），RMAN也会将其备份。RMAN进行备份，因为在7天恢复窗口中不存在表空间备份。
                        </p>
                        <p>此行为使媒体管理器使旧磁带过期。否则，媒体管理器将被迫无限期地保留表空间<code class="codeph">TOOLS</code>的1月3日备份。通过在2月21日对表空间<code class="codeph">tools</code>进行更新的备份，RMAN使媒体管理器使包含1月3日备份的磁带到期。
                        </p>
                     </div>
                  </div><a id="BRADV575"></a><a id="BRADV89464"></a><div class="props_rev_3"><a id="GUID-56FA660A-E096-405C-B51B-AA927EC5DD0B" name="GUID-56FA660A-E096-405C-B51B-AA927EC5DD0B"></a><h5 id="BRADV-GUID-56FA660A-E096-405C-B51B-AA927EC5DD0B" class="sect5"><span class="enumeration_section">5.6.2.2</span>关于使用冗余保留策略的SBT备份的备份优化</h5>
                     <div>
                        <p><a id="d22448e7781" class="indexterm-anchor"></a>假设您为冗余配置保留策略。在这种情况下，当存在<span class="italic"><code class="codeph">r</code></span> + 1个文件备份时，RMAN仅跳过脱机或只读数据文件的备份到SBT，其中<span class="italic"><code class="codeph">r</code></span>在<code class="codeph">CONFIGURE</code> <code class="codeph">RETENTION</code> <code class="codeph">POLICY</code> <code class="codeph">TO</code> <code class="codeph">REDUNDANCY</code> <span class="italic"><code class="codeph">r</code></span> 。
                        </p>
                        <p>例如，假设您启用了备份优化并设置了以下保留策略：</p><pre class="oac_no_warn" dir="ltr">配置默认设备类型为sbt;配置备份优化;配置保留政策以减少冗余2;</pre><p>使用这些设置，RMAN仅在备份三个相同文件时跳过备份。还假设您从未备份过<code class="codeph">users</code>表空间（可读/写），并且您在一周内执行<a href="configuring-rman-client-basic.html#GUID-56FA660A-E096-405C-B51B-AA927EC5DD0B__G1028781" title="此表描述了冗余设置对一周内执行的每日备份的影响。">表5-5中</a>所述的操作。
                        </p>
                        <div class="tblformal" id="GUID-56FA660A-E096-405C-B51B-AA927EC5DD0B__G1028781">
                           <p class="titleintable">表5-5冗余设置对备份优化的影响</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="冗余设置对备份优化的影响" width="100%" border="1" summary="This table describes the effects of the redundancy setting on daily backups performed over a week." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="25%" id="d22448e7840">天</th>
                                    <th align="left" valign="bottom" width="25%" id="d22448e7843">行动</th>
                                    <th align="left" valign="bottom" width="38%" id="d22448e7846">结果</th>
                                    <th align="left" valign="bottom" width="12%" id="d22448e7849">冗余备份</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="25%" id="d22448e7854" headers="d22448e7840 ">
                                       <p>星期一</p>
                                    </td>
                                    <td align="left" valign="top" width="25%" headers="d22448e7854 d22448e7843 ">
                                       <p>让<code class="codeph">users</code>离线正常。
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="38%" headers="d22448e7854 d22448e7846 "> </td>
                                    <td align="left" valign="top" width="12%" headers="d22448e7854 d22448e7849 "> </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="25%" id="d22448e7866" headers="d22448e7840 ">
                                       <p>星期二</p>
                                    </td>
                                    <td align="left" valign="top" width="25%" headers="d22448e7866 d22448e7843 ">
                                       <p><code class="codeph">BACKUP</code> <code class="codeph">DATABASE</code></p>
                                    </td>
                                    <td align="left" valign="top" width="38%" headers="d22448e7866 d22448e7846 ">
                                       <p><code class="codeph">users</code>表空间已备份。
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="12%" headers="d22448e7866 d22448e7849 "> </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="25%" id="d22448e7884" headers="d22448e7840 ">
                                       <p>星期三</p>
                                    </td>
                                    <td align="left" valign="top" width="25%" headers="d22448e7884 d22448e7843 ">
                                       <p><code class="codeph">BACKUP</code> <code class="codeph">DATABASE</code></p>
                                    </td>
                                    <td align="left" valign="top" width="38%" headers="d22448e7884 d22448e7846 ">
                                       <p><code class="codeph">users</code>表空间已备份。
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="12%" headers="d22448e7884 d22448e7849 "> </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="25%" id="d22448e7902" headers="d22448e7840 ">
                                       <p>星期四</p>
                                    </td>
                                    <td align="left" valign="top" width="25%" headers="d22448e7902 d22448e7843 ">
                                       <p><code class="codeph">BACKUP</code> <code class="codeph">DATABASE</code></p>
                                    </td>
                                    <td align="left" valign="top" width="38%" headers="d22448e7902 d22448e7846 ">
                                       <p><code class="codeph">users</code>表空间已备份。
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="12%" headers="d22448e7902 d22448e7849 ">
                                       <p>周二备份</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="25%" id="d22448e7922" headers="d22448e7840 ">
                                       <p>星期五</p>
                                    </td>
                                    <td align="left" valign="top" width="25%" headers="d22448e7922 d22448e7843 ">
                                       <p><code class="codeph">BACKUP</code> <code class="codeph">DATABASE</code></p>
                                    </td>
                                    <td align="left" valign="top" width="38%" headers="d22448e7922 d22448e7846 ">
                                       <p><span class="italic">不</span>备份<code class="codeph">users</code>表空间。
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="12%" headers="d22448e7922 d22448e7849 ">
                                       <p>周二备份</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="25%" id="d22448e7945" headers="d22448e7840 ">
                                       <p>星期六</p>
                                    </td>
                                    <td align="left" valign="top" width="25%" headers="d22448e7945 d22448e7843 ">
                                       <p><code class="codeph">BACKUP</code> <code class="codeph">DATABASE</code></p>
                                    </td>
                                    <td align="left" valign="top" width="38%" headers="d22448e7945 d22448e7846 ">
                                       <p><span class="italic">不</span>备份<code class="codeph">users</code>表空间。
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="12%" headers="d22448e7945 d22448e7849 ">
                                       <p>周二备份</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="25%" id="d22448e7968" headers="d22448e7840 ">
                                       <p>星期日</p>
                                    </td>
                                    <td align="left" valign="top" width="25%" headers="d22448e7968 d22448e7843 ">
                                       <p><code class="codeph">DELETE</code> <code class="codeph">OBSOLETE</code></p>
                                    </td>
                                    <td align="left" valign="top" width="38%" headers="d22448e7968 d22448e7846 ">
                                       <p>星期二备份已删除。</p>
                                    </td>
                                    <td align="left" valign="top" width="12%" headers="d22448e7968 d22448e7849 "> </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="25%" id="d22448e7983" headers="d22448e7840 ">
                                       <p>星期一</p>
                                    </td>
                                    <td align="left" valign="top" width="25%" headers="d22448e7983 d22448e7843 ">
                                       <p><code class="codeph">BACKUP</code> <code class="codeph">DATABASE</code></p>
                                    </td>
                                    <td align="left" valign="top" width="38%" headers="d22448e7983 d22448e7846 ">
                                       <p><code class="codeph">users</code>表空间已备份。
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="12%" headers="d22448e7983 d22448e7849 ">
                                       <p>周三备份</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                        <p>星期二，星期三和星期四的备份会备份脱机<code class="codeph">users</code>表空间，以满足必须存在三个备份的条件（比冗余设置多一个）。由于备份优化，星期五和星期六备份不备份<code class="codeph">users</code>表空间。从周四开始， <code class="codeph">users</code>的周二备份已经过时。
                        </p>
                        <p>在星期日，您删除所有过时的备份，这将删除<code class="codeph">users</code>的星期二备份。由于保留策略设置，星期二备份已过时。星期一的整个数据库备份然后备份<code class="codeph">users</code>表空间以满足必须存在三个备份的条件（比冗余设置多一个）。通过这种方式，您可以随着时间的推移回收磁带。
                        </p>
                        <div class="infoboxnotealso" id="GUID-56FA660A-E096-405C-B51B-AA927EC5DD0B__GUID-90BB0C1C-D460-4BAE-A87E-37DA4B8F3936">
                           <p class="notep1">也可以看看：</p>
                           <p><span class="q">“ <a href="configuring-rman-client-basic.html#GUID-914A65A7-872E-465B-95E5-0FD5ADAF6A9C" title="运行RMAN CONFIGURE命令以启用和禁用备份优化。如果备份了相同的文件或相同版本的文件，则备份优化会在某些情况下跳过文件备份。">备份优化和配置命令</a> ”</span></p>
                        </div>
                     </div>
                  </div>
               </div><a id="BRADV178"></a><a id="BRADV89465"></a><div class="props_rev_3"><a id="GUID-D78276FA-E505-4542-9D78-2335B5F94922" name="GUID-D78276FA-E505-4542-9D78-2335B5F94922"></a><h4 id="BRADV-GUID-D78276FA-E505-4542-9D78-2335B5F94922" class="sect4"><span class="enumeration_section">5.6.3</span>配置备份优化</h4>
                  <div>
                     <p>默认情况下，备份优化配置为<code class="codeph">OFF</code> 。您可以使用<code class="codeph">SHOW BACKUP OPTIMIZATION</code>命令查看备份优化的当前设置。
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-D78276FA-E505-4542-9D78-2335B5F94922__GUID-9BA9A36F-F93D-43D4-81F0-5C1EFC3BB228">配置备份优化：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>启动RMAN并连接到目标数据库和恢复目录（如果使用）。</span></li>
                        <li class="stepexpand"><span>运行<code class="codeph">SHOW</code> <code class="codeph">BACKUP</code> <code class="codeph">OPTIMIZATION</code>命令以确定当前是否启用了优化。</span><div>
                              <p>例如，输入以下命令：</p><pre class="oac_no_warn" dir="ltr">显示备份优化;</pre><p><code class="codeph">SHOW</code> <code class="codeph">BACKUP</code> <code class="codeph">OPTIMIZATION</code>示例输出如下：</p><pre class="oac_no_warn" dir="ltr">具有db_unique_name PROD1的数据库的RMAN配置参数为：CONFIGURE BACKUP OPTIMIZATION OFF;</pre></div>
                        </li>
                        <li class="stepexpand"><span>通过运行以下命令启用备份优化：</span><div><pre class="oac_no_warn" dir="ltr">配置备份优化;</pre></div>
                        </li>
                     </ol>
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-D78276FA-E505-4542-9D78-2335B5F94922__GUID-AF31A555-4E85-477F-B639-82F9FA95B1CF">
                           <p class="notep1">也可以看看：</p>
                           <p><span class="q">“ <a href="backing-up-database-advanced.html#GUID-BC32C333-F0EB-4F17-AD79-8882E224D2F4" title="您运行CONFIGURE BACKUP OPTIMIZATION命令以启用备份优化。满足特定条件时，RMAN会跳过与已备份文件相同的文件备份。">使用备份优化来跳过文件</a> ”</span>以获取有关如何优化RMAN备份的示例</p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="BRADV89439"></a><div class="props_rev_3"><a id="GUID-FA142760-8ACB-43DA-939C-8407618D2D0F" name="GUID-FA142760-8ACB-43DA-939C-8407618D2D0F"></a><h3 id="BRADV-GUID-FA142760-8ACB-43DA-939C-8407618D2D0F" class="sect3"><span class="enumeration_section">5.7</span>配置存档重做日志删除策略</h3>
               <div>
                  <p>您可以使用RMAN创建一个持久性配置，以管理归档重做日志何时有资格从磁盘中删除。</p>
                  <p>本节包含以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="configuring-rman-client-basic.html#GUID-30772A33-4C40-42D2-89AE-FDAC92DF44C9" title="您可以使用CONFIGURE ARCHIVELOG DELETION POLICY命令指定归档重做日志何时符合删除条件。">关于存档重做日志删除策略</a></p>
                     </li>
                     <li>
                        <p><a href="configuring-rman-client-basic.html#GUID-97829620-DD75-4993-BE83-E67F5CA5BB18" title="默认情况下，归档重做日志删除策略设置为NONE。">启用存档重做日志删除策略</a></p>
                     </li>
                  </ul>
               </div><a id="BRADV89440"></a><div class="props_rev_3"><a id="GUID-30772A33-4C40-42D2-89AE-FDAC92DF44C9" name="GUID-30772A33-4C40-42D2-89AE-FDAC92DF44C9"></a><h4 id="BRADV-GUID-30772A33-4C40-42D2-89AE-FDAC92DF44C9" class="sect4"><span class="enumeration_section">5.7.1</span>关于存档重做日志删除策略</h4>
                  <div>
                     <p>您可以使用<code class="codeph">CONFIGURE ARCHIVELOG DELETION POLICY</code>命令指定归档重做日志何时符合删除条件。
                     </p>
                     <p>此删除策略适用于所有归档目标，包括<a href="glossary.html#GUID-6E3CDD76-A573-4E5C-B12D-59C232C96C19"><span class="xrefglossterm">快速恢复区域</span></a> 。
                     </p>
                     <p>归档重做日志可以由数据库或用户启动的RMAN命令自动删除。数据库只能自动删除快速恢复区域中的日志。对于快速恢复区域中的归档重做日志文件，数据库会尽可能长时间地保留它们，并在需要额外磁盘空间时自动删除符合条件的日志。当您发出<a href="../rcmrf/BACKUP.html#RCMRF107" target="_blank"><code class="codeph">BACKUP</code></a>时，您可以从快速恢复区域内部或外部的任何位置手动删除符合条件的日志<code class="codeph">...DELETE INPUT</code>或<code class="codeph">DELETE ARCHIVELOG</code>命令。
                     </p>
                  </div><a id="BRADV99962"></a><div class="props_rev_3"><a id="GUID-E084E268-856C-4358-B2AA-09AEA3389929" name="GUID-E084E268-856C-4358-B2AA-09AEA3389929"></a><h5 id="BRADV-GUID-E084E268-856C-4358-B2AA-09AEA3389929" class="sect5"><span class="enumeration_section">5.7.1.1</span>禁用存档重做日志删除策略时</h5>
                     <div>
                        <p>默认情况下，没有归档重做日志删除策略，这就是归档重做日志策略设置为<code class="codeph">NONE</code>子句的原因。
                        </p>
                        <p>在此特定情况下，快速恢复区域会将恢复区域中的归档重做日志文件视为符合删除条件，前提是它们至少已备份到磁盘或SBT，或者根据备份保留策略已废弃日志。仅当保证还原点不需要日志且Oracle闪回数据库不需要日志时，备份保留策略才会将日志视为过时。如果日志是在<code class="codeph">SYSDATE-'DB_FLASHBACK_RETENTION_TARGET'</code>之后创建的，则闪回数据库需要存档的重做日志。
                        </p>
                        <div class="infoboxnotealso" id="GUID-E084E268-856C-4358-B2AA-09AEA3389929__GUID-7BE87898-28BF-4AB3-A1F1-A135BFB11609">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>有关策略选项的详细信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=RCMRF113" target="_blank"><span><cite>Oracle数据库备份和恢复参考中</cite></span></a>的<code class="codeph">CONFIGURE ARCHIVELOG DELETION POLICY</code>条目</p>
                              </li>
                              <li>
                                 <p><a href="../sbydb/using-RMAN-in-oracle-data-guard-configurations.html#SBYDB4852" target="_blank"><span><cite>Oracle Data Guard概念和管理</cite></span></a> ，了解如何在Data Guard环境中配置存档日志删除策略</p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div><a id="BRADV99963"></a><div class="props_rev_3"><a id="GUID-CDE80DA3-FCDE-4829-925F-E78193597A1C" name="GUID-CDE80DA3-FCDE-4829-925F-E78193597A1C"></a><h5 id="BRADV-GUID-CDE80DA3-FCDE-4829-925F-E78193597A1C" class="sect5"><span class="enumeration_section">5.7.1.2</span>启用存档重做日志删除策略时</h5>
                     <div>
                        <p>您可以使用<code class="codeph">CONFIGURE ARCHIVELOG DELETION POLICY BACKED UP</code> <span class="italic"><code class="codeph">integer</code></span> <code class="codeph">TIMES TO DEVICE TYPE</code>命令启用存档日志删除策略。此配置指定仅当指定设备类型上存在指定数量的归档日志备份时，归档日志才有资格删除。
                        </p>
                        <p>如果使用<code class="codeph">BACKED UP</code> <span class="italic"><code class="codeph">integer</code></span> <code class="codeph">TIMES</code>子句配置删除策略，则<code class="codeph">BACKUP ARCHIVELOG</code>命令将复制日志，除非指定设备类型上存在<span class="italic"><code class="codeph">integer</code></span>备份。如果存在日志的<span class="italic"><code class="codeph">integer</code></span>备份，则<code class="codeph">BACKUP ARCHIVELOG</code>命令会跳过日志。这样，归档日志删除策略在<code class="codeph">BACKUP ARCHIVELOG</code>命令上用作默认的<code class="codeph">NOT BACKED UP</code> <span class="italic"><code class="codeph">integer</code></span> <code class="codeph">TIMES</code>子句。您可以通过在<code class="codeph">BACKUP</code>命令上指定<code class="codeph">FORCE</code>选项来覆盖删除策略。
                        </p>
                        <p>归档日志删除策略还具有特定于Data Guard环境的选项。例如，如果指定<code class="codeph">APPLIED ON STANDBY</code>子句，则RMAN可以在所有强制远程目标应用后删除日志。如果指定<code class="codeph">SHIPPED TO STANDBY</code> ，则RMAN可以在将日志传输到所有强制备用目标时删除日志。
                        </p>
                        <div class="infoboxnotealso" id="GUID-CDE80DA3-FCDE-4829-925F-E78193597A1C__GUID-C556AF0A-B7C2-4036-8DB0-6BD4694F1943">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>有关策略选项的详细信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=RCMRF113" target="_blank"><span><cite>Oracle数据库备份和恢复参考中</cite></span></a>的<code class="codeph">CONFIGURE ARCHIVELOG DELETION POLICY</code>条目</p>
                              </li>
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=SBYDB04700" target="_blank"><span><cite>Oracle Data Guard概念和管理</cite></span></a> ，了解如何在Data Guard环境中配置存档日志删除策略</p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div>
               </div><a id="BRADV576"></a><a id="BRADV89441"></a><div class="props_rev_3"><a id="GUID-97829620-DD75-4993-BE83-E67F5CA5BB18" name="GUID-97829620-DD75-4993-BE83-E67F5CA5BB18"></a><h4 id="BRADV-GUID-97829620-DD75-4993-BE83-E67F5CA5BB18" class="sect4"><span class="enumeration_section">5.7.2</span>启用存档重做日志删除策略</h4>
                  <div>
                     <p>默认情况下，归档重做日志删除策略设置为<code class="codeph">NONE</code> 。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-97829620-DD75-4993-BE83-E67F5CA5BB18__GUID-99F2D226-7353-47F8-8BBB-B3DE17D919F1">要启用存档的重做日志删除策略：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>启动RMAN并连接到目标数据库和恢复目录（如果使用）。</span></li>
                        <li class="stepexpand"><span>使用所需选项运行<code class="codeph">CONFIGURE ARCHIVELOG DELETION POLICY</code>命令。</span><div>
                              <p>以下示例指定当已将日志备份至少两次到磁带时，归档重做日志有资格从快速恢复区域和所有本地归档目标中删除：</p><pre class="oac_no_warn" dir="ltr">配置ARCHIVELOG删除政策为SBT提供2次备份;</pre></div>
                        </li>
                     </ol>
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-97829620-DD75-4993-BE83-E67F5CA5BB18__GUID-61840FA9-A7A6-4930-B826-DFA0D1F16A77">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><a href="backing-up-database.html#GUID-E99C2A06-868F-458A-88F1-B257EADD63CB" title="BACKUP ARCHIVELOG ......DELETE INPUT命令在备份后删除存档的日志文件。此命令消除了手动删除存档重做日志的单独步骤。">在非CDB中备份后删除存档的重做日志</a></p>
                              </li>
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=SBYDB4852" target="_blank"><span><cite>Oracle Data Guard概念和管理</cite></span></a> ，了解如何在Data Guard环境中管理归档重做日志</p>
                              </li>
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=RCMRF113" target="_blank"><span><cite>Oracle数据库备份和恢复参考</cite></span></a>有关<code class="codeph">CONFIGURE ARCHIVELOG DELETION POLICY</code>命令的完整说明以及存档日志有资格删除的条件</p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="BRADV89455"></a><div class="props_rev_3"><a id="GUID-FDA66A53-B2AA-4C59-A142-C2F04016FAEF" name="GUID-FDA66A53-B2AA-4C59-A142-C2F04016FAEF"></a><h3 id="BRADV-GUID-FDA66A53-B2AA-4C59-A142-C2F04016FAEF" class="sect3"><span class="enumeration_section">5.8</span>在Data Guard环境中配置RMAN</h3>
               <div>
                  <p>如果在Data Guard环境中使用RMAN，则可以使用<code class="codeph">CONFIGURE</code>命令在此环境中注册和配置物理数据库的设置。
                  </p>
                  <div class="section">
                     <p>RMAN使用<code class="codeph">DB_UNIQUE_NAME</code>初始化参数来区分一个数据库与另一个数据库。因此，在Data Guard环境中保持<code class="codeph">DB_UNIQUE_NAME</code>的唯一性至关重要。
                     </p>
                     <p>在Data Guard环境中创建或更改数据库的配置时，必须将RMAN连接到恢复目录。如果使用<code class="codeph">SET DBID</code>命令在<a href="glossary.html#GUID-01D29658-41E1-4D45-9C7F-A761D56885B9"><span class="xrefglossterm">RMAN会话中</span></a>设置DBID，则即使RMAN未作为<code class="codeph">TARGET</code>连接到Data Guard环境中的数据库，也可以配置备用数据库。您甚至可以为尚未创建的备用数据库创建配置。
                     </p>
                     <p>您可以使用以下形式的<code class="codeph">CONFIGURE</code>命令：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">CONFIGURE DB_UNIQUE_NAME</code>定义与<a href="glossary.html#GUID-009B3F56-8C1E-4CF6-AF0F-A9D2C2E4B9C2"><span class="xrefglossterm">物理备用数据库</span></a>的连接，并隐式注册新数据库。
                           </p>
                           <p>当RMAN首次作为<code class="codeph">TARGET</code>连接到备用数据库时，也会自动注册新的备用数据库。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">CONFIGURE FOR DB_UNIQUE_NAME</code>在Data Guard环境中配置数据库的设置。
                           </p>
                           <p>例如，您可以为指定的数据库或环境中的所有数据库配置通道，默认设备等。您可以使用<code class="codeph">SHOW ALL FOR DB_UNIQUE_NAME</code>显示特定备用数据库的配置，或者<code class="codeph">SHOW ALL FOR DB_UNIQUE_NAME ALL</code>以显示所有已知数据库的配置。
                           </p>
                        </li>
                     </ul>
                     <p>Data Guard环境涉及许多仅与Data Guard相关的注意事项。例如，您可以根据归档日志是传输到备用数据库还是应用于备用数据库来配置<a href="glossary.html#GUID-3492E0C3-F42C-45E6-84E2-63E30A3489A4"><span class="xrefglossterm">归档重做日志删除策略</span></a> 。
                     </p>
                     <div class="infoboxnotealso" id="GUID-FDA66A53-B2AA-4C59-A142-C2F04016FAEF__GUID-C6CE7B9E-7228-4B3A-B9D2-B52DD4A350B8">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=SBYDB04700" target="_blank"><span><cite>Oracle Data Guard概念和管理</cite></span></a> ，了解如何配置RMAN环境以与备用数据库一起使用</p>
                           </li>
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=RCMRF113" target="_blank"><span><cite>Oracle数据库备份和恢复参考</cite></span></a>有关<code class="codeph">CONFIGURE ARCHIVELOG DELETION POLICY</code>命令的完整说明以及存档日志有资格删除的条件</p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
         </div>
      </article>
   </body>
</html>