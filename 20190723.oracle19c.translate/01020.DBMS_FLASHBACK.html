<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="Using DBMS_FLASHBACK, you can flash back to a version of the database at a specified time or a specified system change number (SCN).">
      <meta name="description" content="Using DBMS_FLASHBACK, you can flash back to a version of the database at a specified time or a specified system change number (SCN).">
      <title>DBMS_FLASHBACK</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="PL/SQL Packages and Types Reference">
      <meta property="og:description" content="Using DBMS_FLASHBACK, you can flash back to a version of the database at a specified time or a specified system change number (SCN).">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="PL/SQL Packages and Types Reference">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="database-pl-sql-packages-and-types-reference.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-03-25T11:24:34-07:00">
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96430-03">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="DBMS_FILE_TRANSFER.html" title="Previous" type="text/html">
      <link rel="next" href="DBMS_FLASHBACK_ARCHIVE.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database PL/SQL Packages and Types Reference">
    <meta name="dcterms.isVersionOf" content="ARPLS">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="DBMS_FILE_TRANSFER.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="DBMS_FLASHBACK_ARCHIVE.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">PL/SQL Packages and Types Reference</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem"> DBMS_FLASHBACK</li>
            </ol>
            <a id="GUID-49A5AA6B-428D-45D3-955F-F30DB8DF19A3" name="GUID-49A5AA6B-428D-45D3-955F-F30DB8DF19A3"></a><a id="ARPLS142"></a><a id="ARPLS142"></a>
            
            <h2 id="ARPLS-GUID-49A5AA6B-428D-45D3-955F-F30DB8DF19A3" class="sect2"><span class="enumeration_chapter">69 </span> DBMS_FLASHBACK
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>Using <code class="codeph">DBMS_FLASHBACK</code>, you can flash back to a version of the database at a specified time or a specified system change number (SCN).
               </p>
               <p>This chapter contains the following topics:</p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p><a href="DBMS_FLASHBACK.html#GUID-99EA6692-FD05-440B-AEAA-69B09C85F05A" title="DBMS_FLASHBACK provides an interface for the user to view the database at a particular time in the past, with the additional capacity provided by transaction back out features that allow for selective removal of the effects of individual transactions. This is different from a flashback database which moves the database back in time.">Overview</a></p>
                  </li>
                  <li>
                     <p><a href="DBMS_FLASHBACK.html#GUID-722A7B55-BF3B-4FBC-B139-9C3715FDD5B3" title="To use the DBMS_FLASHBACK package, you must have the EXECUTE privilege on it.">Security Model</a></p>
                  </li>
                  <li>
                     <p><a href="DBMS_FLASHBACK.html#GUID-CFBE83DD-FB0A-4FF8-879F-512448FBB9F0" title="The following table describes the types used by DBMS_FLASHBACK.">Types</a></p>
                  </li>
                  <li>
                     <p><a href="DBMS_FLASHBACK.html#GUID-B8B75749-A878-435F-9945-55C094098EEF" title="DBMS_FLASHBACK creates the following error messages.">Exceptions</a></p>
                  </li>
                  <li>
                     <p><a href="DBMS_FLASHBACK.html#GUID-C73A5AF2-9785-434D-AC2D-D37DCE5A26B7" title="DBMS_FLASHBACK is automatically turned off when the session ends, either by disconnection or by starting another connection.">Operational Notes</a></p>
                  </li>
                  <li>
                     <p><a href="DBMS_FLASHBACK.html#GUID-358DF749-192B-493C-A8DF-19C87FFBE457" title="The following example illustrates how Flashback can be used when the deletion of a senior employee triggers the deletion of all the personnel reporting to him. Using the Flashback feature, you can recover and re-insert the missing employees.">Examples</a></p>
                  </li>
                  <li>
                     <p><a href="DBMS_FLASHBACK.html#GUID-E4B46686-0B8B-43F2-9B6E-43BBA0921521" title="This table lists the DBMS_FLASHBACK subprograms and briefly describes them.">Summary of DBMS_FLASHBACK Subprograms</a></p>
                  </li>
               </ul>
               <div class="infoboxnotealso" id="GUID-49A5AA6B-428D-45D3-955F-F30DB8DF19A3__GUID-44442659-940F-4F86-A943-B8A885B44981">
                  <p class="notep1">See Also:</p>
                  <p>For detailed information about <code class="codeph">DBMS_FLASHBACK</code>:
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="../adfns/flashback.html#ADFNS-GUID-03D1CAAE-D940-444A-8771-B1BC636D105D" target="_blank"><span><cite>Oracle Database Development Guide</cite></span></a></p>
                     </li>
                     <li>
                        <p><a href="../sqlrf/Introduction-to-Oracle-SQL.html#SQLRF-GUID-049B7AE8-11E1-4110-B3E4-D117907D77AC" target="_blank"><span><cite>Oracle Database SQL Language Reference</cite></span></a>.
                        </p>
                     </li>
                  </ul>
               </div>
            </div><a id="ARPLS66391"></a><a id="ARPLS66391"></a><div class="props_rev_3"><a id="GUID-99EA6692-FD05-440B-AEAA-69B09C85F05A" name="GUID-99EA6692-FD05-440B-AEAA-69B09C85F05A"></a><h3 id="ARPLS-GUID-99EA6692-FD05-440B-AEAA-69B09C85F05A" class="sect3"><span class="enumeration_section">69.1 </span>DBMS_FLASHBACK Overview
               </h3>
               <div>
                  <p><code class="codeph">DBMS_FLASHBACK</code> provides an interface for the user to view the database at a particular time in the past, with the additional capacity provided by transaction back out features that allow for selective removal of the effects of individual transactions. This is different from a flashback database which moves the database back in time.
                  </p>
                  <div class="section">
                     <p>When <code class="codeph">DBMS_FLASHBACK</code> is enabled, the user session uses the Flashback version of the database, and applications can execute against the Flashback version of the database. 
                     </p>
                     <p>You may want to use <code class="codeph">DBMS_FLASHBACK</code> for the following reasons:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Self-service repair: If you accidentally delete rows from a table, you can recover the deleted rows.</p>
                        </li>
                        <li>
                           <p>Packaged applications such as email and voicemail: You can use Flashback to restore deleted email by re-inserting the deleted message into the current message box.</p>
                        </li>
                        <li>
                           <p>Decision support system (DSS) and online analytical processing (OLAP) applications: You can perform data analysis or data modeling to track seasonal demand.</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="ARPLS66392"></a><a id="ARPLS66392"></a><div class="props_rev_3"><a id="GUID-722A7B55-BF3B-4FBC-B139-9C3715FDD5B3" name="GUID-722A7B55-BF3B-4FBC-B139-9C3715FDD5B3"></a><h3 id="ARPLS-GUID-722A7B55-BF3B-4FBC-B139-9C3715FDD5B3" class="sect3"><span class="enumeration_section">69.2 </span>DBMS_FLASHBACK Security Model
               </h3>
               <div>
                  <p>To use the <code class="codeph">DBMS_FLASHBACK</code> package, you must have the <code class="codeph">EXECUTE</code> privilege on it.
                  </p>
               </div>
            </div><a id="ARPLS66393"></a><a id="ARPLS66394"></a><a id="ARPLS66394"></a><a id="ARPLS66393"></a><div class="props_rev_3"><a id="GUID-CFBE83DD-FB0A-4FF8-879F-512448FBB9F0" name="GUID-CFBE83DD-FB0A-4FF8-879F-512448FBB9F0"></a><h3 id="ARPLS-GUID-CFBE83DD-FB0A-4FF8-879F-512448FBB9F0" class="sect3"><span class="enumeration_section">69.3 </span>DBMS_FLASHBACK Types
               </h3>
               <div>
                  <p>The following table describes the types used by <code class="codeph">DBMS_FLASHBACK</code>.
                  </p>
                  <div class="tblformal" id="GUID-CFBE83DD-FB0A-4FF8-879F-512448FBB9F0__GUID-936557E1-93F8-461B-8E6A-7F6A734931EC">
                     <p class="titleintable">Table 69-1 DBMS_FLASHBACK</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="DBMS_FLASHBACK" summary="This table describes Types used by DBMS_FLASHBACK subprograms." width="100%" frame="hsides" border="1" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="33%" id="d434450e497">Type</th>
                              <th align="left" valign="bottom" width="67%" id="d434450e500">Description</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="33%" id="d434450e505" headers="d434450e497 ">
                                 <p><code class="codeph">TXNAME_ARRAY</code></p>
                              </td>
                              <td align="left" valign="top" width="67%" headers="d434450e505 d434450e500 ">
                                 <p>Creates a <code class="codeph">VARRAY</code> for holding Transaction Names or Identifiers (<code class="codeph">XID</code>s)
                                 </p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
               </div>
            </div><a id="ARPLS66395"></a><a id="ARPLS66396"></a><a id="ARPLS66396"></a><a id="ARPLS66395"></a><div class="props_rev_3"><a id="GUID-B8B75749-A878-435F-9945-55C094098EEF" name="GUID-B8B75749-A878-435F-9945-55C094098EEF"></a><h3 id="ARPLS-GUID-B8B75749-A878-435F-9945-55C094098EEF" class="sect3"><span class="enumeration_section">69.4 </span>DBMS_FLASHBACK Exceptions
               </h3>
               <div>
                  <p>DBMS_FLASHBACK creates the following error messages. </p>
                  <div class="tblformal" id="GUID-B8B75749-A878-435F-9945-55C094098EEF__GUID-6453F3FC-484D-4717-BD71-3FED8DA04212">
                     <p class="titleintable">Table 69-2 DBMS_FLASHBACK Error Messages</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="DBMS_FLASHBACK Error Messages" summary="This table describes Exceptions for the DBMS_FLASHBACK package." width="100%" frame="hsides" border="1" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="31%" id="d434450e616">Error</th>
                              <th align="left" valign="bottom" width="69%" id="d434450e619">Description</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d434450e624" headers="d434450e616 ">
                                 <p><code class="codeph">ORA-08180</code></p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d434450e624 d434450e619 ">
                                 <p>Time specified is too old</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d434450e632" headers="d434450e616 ">
                                 <p><code class="codeph">ORA-08181</code></p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d434450e632 d434450e619 ">
                                 <p>Invalid system change number specified</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d434450e640" headers="d434450e616 ">
                                 <p><code class="codeph">ORA-08182</code></p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d434450e640 d434450e619 ">
                                 <p>User cannot begin read-only or serializable transactions in Flashback mode</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d434450e648" headers="d434450e616 ">
                                 <p><code class="codeph">ORA-08183</code></p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d434450e648 d434450e619 ">
                                 <p>User cannot enable Flashback within an uncommitted transaction</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d434450e656" headers="d434450e616 ">
                                 <p><code class="codeph">ORA-08184</code></p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d434450e656 d434450e619 ">
                                 <p>User cannot enable Flashback within another Flashback session</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d434450e664" headers="d434450e616 ">
                                 <p><code class="codeph">ORA-08185</code></p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d434450e664 d434450e619 ">
                                 <p><code class="codeph">SYS</code> cannot enable Flashback mode
                                 </p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
               </div>
            </div><a id="ARPLS66397"></a><a id="ARPLS66397"></a><div class="props_rev_3"><a id="GUID-C73A5AF2-9785-434D-AC2D-D37DCE5A26B7" name="GUID-C73A5AF2-9785-434D-AC2D-D37DCE5A26B7"></a><h3 id="ARPLS-GUID-C73A5AF2-9785-434D-AC2D-D37DCE5A26B7" class="sect3"><span class="enumeration_section">69.5 </span>DBMS_FLASHBACK Operational Notes
               </h3>
               <div>
                  <p><code class="codeph">DBMS_FLASHBACK</code> is automatically turned off when the session ends, either by disconnection or by starting another connection.
                  </p>
                  <div class="section">
                     <p>PL/SQL cursors opened in Flashback mode return rows as of the flashback time or SCN. Different concurrent sessions (connections) in the database can perform Flashback to different wall-clock times or SCNs. DML and DDL operations and distributed operations are not allowed while a session is running in Flashback mode. You can use PL/SQL cursors opened before disabling Flashback to perform DML.</p>
                     <p>Under Automatic Undo Management (AUM) mode, you can use retention control to control how far back in time to go for the version of the database you need. If you need to perform a Flashback over a 24-hour period, the DBA must set the <code class="codeph">undo_retention</code> parameter to 24 hours. This way, the system retains enough undo information to regenerate the older versions of the data.
                     </p>
                     <p>You can set the <code class="codeph">RETENTION</code> <code class="codeph">GUARANTEE</code> clause for the undo tablespace to ensure that unexpired undo is not discarded.<code class="codeph"> UNDO_RETENTION</code> is not in itself a guarantee because, if the system is under space pressure, unexpired undo may be overwritten with freshly generated undo. In such cases, <code class="codeph">RETENTION</code> <code class="codeph">GUARANTEE</code> prevents this. For more information, see the <a href="../admin/managing-undo.html#ADMIN-GUID-2C865CF9-A8B5-4BF1-A451-E8C08D3611F0" target="_blank"><span><cite>Oracle Database Administrator’s Guide</cite></span></a>.
                     </p>
                     <p>In a Flashback-enabled session, <code class="codeph">SYSDATE</code> is not affected; it continues to provide the current time.
                     </p>
                     <p><code class="codeph">DBMS_FLASHBACK</code> can be used within logon triggers to enable Flashback without changing the application code.
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="ARPLS66398"></a><a id="ARPLS66398"></a><div class="props_rev_3"><a id="GUID-358DF749-192B-493C-A8DF-19C87FFBE457" name="GUID-358DF749-192B-493C-A8DF-19C87FFBE457"></a><h3 id="ARPLS-GUID-358DF749-192B-493C-A8DF-19C87FFBE457" class="sect3"><span class="enumeration_section">69.6 </span>DBMS_FLASHBACK Examples
               </h3>
               <div>
                  <p>The following example illustrates how Flashback can be used when the deletion of a senior employee triggers the deletion of all the personnel reporting to him. Using the Flashback feature, you can recover and re-insert the missing employees.</p>
                  <div class="section"><pre class="oac_no_warn" dir="ltr">DROP TABLE employee;
DROP TABLE keep_scn;

REM -- Keep_scn is a temporary table to store scns that we are interested in

CREATE TABLE keep_scn (scn number); 
SET ECHO ON 
CREATE TABLE employee ( 
   employee_no   number(5) PRIMARY KEY, 
   employee_name varchar2(20), 
   employee_mgr  number(5) 
      CONSTRAINT mgr_fkey REFERENCES EMPLOYEE ON DELETE CASCADE, 
   salary        number, 
   hiredate      date 
); 

REM -- Populate the company with employees
INSERT INTO employee VALUES (1, 'John Doe', null, 1000000, '5-jul-81'); 
INSERT INTO employee VALUES (10, 'Joe Johnson', 1, 500000, '12-aug-84'); 
INSERT INTO employee VALUES (20, 'Susie Tiger', 10, 250000, '13-dec-90'); 
INSERT INTO employee VALUES (100, 'Scott Tiger', 20, 200000, '3-feb-86'); 
INSERT INTO employee VALUES (200, 'Charles Smith', 100, 150000, '22-mar-88'); 
INSERT INTO employee VALUES (210, 'Jane Johnson', 100, 100000, '11-apr-87'); 
INSERT INTO employee VALUES (220, 'Nancy Doe', 100, 100000, '18-sep-93'); 
INSERT INTO employee VALUES (300, 'Gary Smith', 210, 75000, '4-nov-96'); 
INSERT INTO employee VALUES (310, 'Bob Smith', 210, 65000, '3-may-95'); 
COMMIT; 

REM -- Show the entire org
SELECT lpad(' ', 2*(level-1)) || employee_name Name 
FROM employee 
CONNECT BY PRIOR employee_no = employee_mgr 
START WITH employee_no = 1 
ORDER BY LEVEL; 

REM -- Sleep for a short time (approximately 10 to 20  seconds) to avoid 
REM -- querying close to table creation

EXECUTE DBMS_LOCK.SLEEP(10);

REM -- Store this snapshot for later access through Flashback
DECLARE 
I NUMBER; 
BEGIN 
I := DBMS_FLASHBACK.GET_SYSTEM_CHANGE_NUMBER; 
INSERT INTO keep_scn VALUES (I); 
COMMIT; 
END;
/

REM -- Scott decides to retire but the transaction is done incorrectly
DELETE FROM EMPLOYEE WHERE employee_name = 'Scott Tiger'; 
COMMIT; 

REM -- notice that all of scott's employees are gone 
SELECT lpad(' ', 2*(level-1)) || employee_name Name 
FROM EMPLOYEE 
CONNECT BY PRIOR employee_no = employee_mgr 
START WITH employee_no = 1 
ORDER BY LEVEL; 

REM -- Flashback to see Scott's organization
DECLARE 
   restore_scn number; 
BEGIN 
   SELECT  scn INTO restore_scn FROM keep_scn; 
   DBMS_FLASHBACK.ENABLE_AT_SYSTEM_CHANGE_NUMBER (restore_scn); 
END; 
/ 

REM -- Show Scott's org.
SELECT lpad(' ', 2*(level-1)) || employee_name Name 
FROM employee 
CONNECT BY PRIOR employee_no = employee_mgr 
START WITH employee_no = 
   (SELECT employee_no FROM employee WHERE employee_name = 'Scott Tiger') 
ORDER BY LEVEL; 

REM -- Restore scott's organization.
DECLARE 
   scotts_emp NUMBER; 
   scotts_mgr NUMBER; 
   CURSOR c1 IS 
      SELECT employee_no, employee_name, employee_mgr, salary, hiredate 
      FROM employee 
      CONNECT BY PRIOR employee_no = employee_mgr 
      START WITH employee_no = 
         (SELECT employee_no FROM employee WHERE employee_name = 'Scott Tiger'); 
   c1_rec c1 % ROWTYPE; 
BEGIN 
   SELECT employee_no, employee_mgr INTO scotts_emp, scotts_mgr FROM employee 
   WHERE employee_name = 'Scott Tiger'; 
   /* Open c1 in flashback mode */
   OPEN c1; 
   /* Disable Flashback */
   DBMS_FLASHBACK.DISABLE; 
 LOOP 
   FETCH c1 INTO c1_rec; 
   EXIT WHEN c1%NOTFOUND; 
   /*
     Note that all the DML operations inside the loop are performed
     with Flashback disabled
   */
   IF (c1_rec.employee_mgr = scotts_emp) then 
      INSERT INTO employee VALUES (c1_rec.employee_no, 
         c1_rec.employee_name, 
         scotts_mgr, 
         c1_rec.salary, 
         c1_rec.hiredate); 
   ELSE 
   IF (c1_rec.employee_no != scotts_emp) THEN 
   INSERT INTO employee VALUES (c1_rec.employee_no, 
         c1_rec.employee_name, 
         c1_rec.employee_mgr, 
         c1_rec.salary, 
         c1_rec.hiredate); 
      END IF; 
    END IF; 
 END LOOP; 
END; 
/ 

REM -- Show the restored organization.
select lpad(' ', 2*(level-1)) || employee_name Name 
FROM employee 
CONNECT BY PRIOR employee_no = employee_mgr 
START WITH employee_no = 1 
ORDER BY LEVEL; </pre></div>
                  <!-- class="section" -->
               </div>
            </div><a id="ARPLS66399"></a><a id="ARPLS66400"></a><a id="ARPLS66400"></a><a id="ARPLS66399"></a><div class="props_rev_3"><a id="GUID-E4B46686-0B8B-43F2-9B6E-43BBA0921521" name="GUID-E4B46686-0B8B-43F2-9B6E-43BBA0921521"></a><h3 id="ARPLS-GUID-E4B46686-0B8B-43F2-9B6E-43BBA0921521" class="sect3"><span class="enumeration_section">69.7 </span>Summary of DBMS_FLASHBACK Subprograms
               </h3>
               <div>
                  <p>This table lists the <code class="codeph">DBMS_FLASHBACK</code> subprograms and briefly describes them.
                  </p>
                  <div class="tblformal" id="GUID-E4B46686-0B8B-43F2-9B6E-43BBA0921521__GUID-E6E20915-A701-45B6-AA3A-89527F21AE4C">
                     <p class="titleintable">Table 69-3 DBMS_FLASHBACK Package Subprograms</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="DBMS_FLASHBACK Package Subprograms" summary="This table lists the DBMS_FLASHBACK subprograms in alphabetical order and briefly describes them." width="100%" frame="hsides" border="1" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="31%" id="d434450e993">Subprogram</th>
                              <th align="left" valign="bottom" width="69%" id="d434450e996">Description</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d434450e1001" headers="d434450e993 ">
                                 <p><a href="DBMS_FLASHBACK.html#GUID-40298AFA-27FB-477B-97BB-65E075EDE1EA" title="This procedure disables the Flashback mode for the entire session.">DISABLE Procedure</a></p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d434450e1001 d434450e996 ">
                                 <p>Disables the Flashback mode for the entire session</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d434450e1013" headers="d434450e993 ">
                                 <p><a href="DBMS_FLASHBACK.html#GUID-0EDCB7D7-B3FF-4CE8-A146-7C67B2DCD233" title="This procedure takes an SCN as an input parameter and sets the session snapshot to the specified number.">ENABLE_AT_SYSTEM_CHANGE_NUMBER Procedure</a></p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d434450e1013 d434450e996 ">
                                 <p>Enables Flashback for the entire session. Takes an SCN as an Oracle number and sets the session snapshot to the specified number. Inside the Flashback mode, all queries return data consistent as of the specified wall-clock time or SCN</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d434450e1025" headers="d434450e993 ">
                                 <p><a href="DBMS_FLASHBACK.html#GUID-7207DAD4-EE12-48D9-A778-F624D7D195A2" title="This procedure enables Flashback for the entire session.">ENABLE_AT_TIME Procedure</a></p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d434450e1025 d434450e996 ">
                                 <p>Enables Flashback for the entire session. The snapshot time is set to the SCN that most closely matches the time specified in <code class="codeph">query_time</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d434450e1039" headers="d434450e993 ">
                                 <p><a href="DBMS_FLASHBACK.html#GUID-AB866FCB-26FC-47C2-ACB0-DD1F6C7A35F3" title="This function returns the current SCN as an Oracle number datatype. You can obtain the current change number and store it for later use. This helps you retain specific snapshots.">GET_SYSTEM_CHANGE_NUMBER Function</a></p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d434450e1039 d434450e996 ">
                                 <p>Returns the current SCN as an Oracle number. You can use the SCN to store specific snapshots</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d434450e1051" headers="d434450e993 ">
                                 <p><a href="DBMS_FLASHBACK.html#GUID-AA34A68B-E1FC-46A5-ABAB-4AEF7F7BAF88" title="This procedure provides a mechanism to back out a set of transactions. The user can call these procedures with either transaction names or transaction identifiers (XIDS).">TRANSACTION_BACKOUT Procedures</a></p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d434450e1051 d434450e996 ">
                                 <p>Provides the mechanism to back out a transaction</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
               </div><a id="ARPLS66401"></a><a id="ARPLS66401"></a><div class="props_rev_3"><a id="GUID-40298AFA-27FB-477B-97BB-65E075EDE1EA" name="GUID-40298AFA-27FB-477B-97BB-65E075EDE1EA"></a><h4 id="ARPLS-GUID-40298AFA-27FB-477B-97BB-65E075EDE1EA" class="sect4"><span class="enumeration_section">69.7.1 </span>DISABLE Procedure
                  </h4>
                  <div>
                     <p>This procedure disables the Flashback mode for the entire session.</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-40298AFA-27FB-477B-97BB-65E075EDE1EA__GUID-B06FAD10-3230-4523-A2E1-A11FEC802557">Syntax</p><pre class="oac_no_warn" dir="ltr">DBMS_FLASHBACK.DISABLE;</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-40298AFA-27FB-477B-97BB-65E075EDE1EA__GUID-D14925E3-BE04-49E9-A5EC-D9FD1EC5C434">Examples</p>
                        <p>The following example queries the salary of an employee, Joe, on August 30, 2000:</p><pre class="oac_no_warn" dir="ltr">EXECUTE dbms_flashback.enable_at_time('30-AUG-2000');
SELECT salary FROM emp where name = 'Joe'
EXECUTE dbms_flashback.disable;</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ARPLS66402"></a><a id="ARPLS66403"></a><a id="ARPLS66403"></a><a id="ARPLS66402"></a><div class="props_rev_3"><a id="GUID-0EDCB7D7-B3FF-4CE8-A146-7C67B2DCD233" name="GUID-0EDCB7D7-B3FF-4CE8-A146-7C67B2DCD233"></a><h4 id="ARPLS-GUID-0EDCB7D7-B3FF-4CE8-A146-7C67B2DCD233" class="sect4"><span class="enumeration_section">69.7.2 </span>ENABLE_AT_SYSTEM_CHANGE_NUMBER Procedure
                  </h4>
                  <div>
                     <p>This procedure takes an SCN as an input parameter and sets the session snapshot to the specified number.</p>
                     <div class="section">
                        <p>In the Flashback mode, all queries return data consistent as of the specified wall-clock time or SCN. It enables Flashback for the entire session. </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-0EDCB7D7-B3FF-4CE8-A146-7C67B2DCD233__GUID-AD7C0BA8-CDE0-4D51-A9D0-AE5F021279C4">Syntax</p><pre class="oac_no_warn" dir="ltr">DBMS_FLASHBACK.ENABLE_AT_SYSTEM_CHANGE_NUMBER (
   query_scn IN NUMBER);</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-0EDCB7D7-B3FF-4CE8-A146-7C67B2DCD233__GUID-353AD05D-974A-45BE-92DA-46A84C95279B">Parameters</p>
                        <div class="tblformal" id="GUID-0EDCB7D7-B3FF-4CE8-A146-7C67B2DCD233__GUID-C162D5FD-DE44-47E7-B9C1-81239B8D4B4B">
                           <p class="titleintable">Table 69-4 ENABLE_AT_SYSTEM_CHANGE_NUMBER Procedure Parameters</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="ENABLE_AT_SYSTEM_CHANGE_NUMBER Procedure Parameters" summary="This table describes the parameters of DBMS_FLASHBACK.ENABLE_AT_SYSTEM_CHANGE_NUMBER." width="100%" frame="hsides" border="1" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="31%" id="d434450e1283">Parameter</th>
                                    <th align="left" valign="bottom" width="69%" id="d434450e1286">Description</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d434450e1291" headers="d434450e1283 ">
                                       <p><code class="codeph">query_scn</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d434450e1291 d434450e1286 ">
                                       <p>The system change number (SCN), a version number for the database that is incremented on every transaction commit.</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ARPLS66404"></a><a id="ARPLS66405"></a><a id="ARPLS66405"></a><a id="ARPLS66404"></a><div class="props_rev_3"><a id="GUID-7207DAD4-EE12-48D9-A778-F624D7D195A2" name="GUID-7207DAD4-EE12-48D9-A778-F624D7D195A2"></a><h4 id="ARPLS-GUID-7207DAD4-EE12-48D9-A778-F624D7D195A2" class="sect4"><span class="enumeration_section">69.7.3 </span>ENABLE_AT_TIME Procedure
                  </h4>
                  <div>
                     <p>This procedure enables Flashback for the entire session.</p>
                     <div class="section">
                        <p>The snapshot time is set to the SCN that most closely matches the time specified in query_time. It enables Flashback for the entire session. </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-7207DAD4-EE12-48D9-A778-F624D7D195A2__GUID-951A33D5-B89A-469C-BB94-9F594335A038">Syntax</p><pre class="oac_no_warn" dir="ltr">DBMS_FLASHBACK.ENABLE_AT_TIME (
   query_time   IN TIMESTAMP);</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-7207DAD4-EE12-48D9-A778-F624D7D195A2__GUID-B4D8754F-91B5-47A5-9E5A-821942697D53">Parameters</p>
                        <div class="tblformal" id="GUID-7207DAD4-EE12-48D9-A778-F624D7D195A2__GUID-390717C1-9400-49C8-ACC3-EF9C955655B7">
                           <p class="titleintable">Table 69-5 ENABLE_AT_TIME Procedure Parameters</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="ENABLE_AT_TIME Procedure Parameters" summary="This table describes the parameters of DBMS_FLASHBACK.ENABLE_AT_TIME." width="100%" frame="hsides" border="1" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="31%" id="d434450e1411">Parameter</th>
                                    <th align="left" valign="bottom" width="69%" id="d434450e1414">Description</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d434450e1419" headers="d434450e1411 ">
                                       <p><code class="codeph">query_time</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d434450e1419 d434450e1414 ">
                                       <p>This is an input parameter of type <code class="codeph">TIMESTAMP</code>. A time stamp can be specified in the following ways:
                                       </p>
                                       <ul style="list-style-type: disc;">
                                          <li>
                                             <p>Using the <code class="codeph">TIMESTAMP</code> constructor
                                             </p><pre class="oac_no_warn" dir="ltr">EXECUTE DBMS_FLASHBACK.ENABLE_AT_TIME(TIMESTAMP '2001-01-09 12:31:00'). </pre><p>Use the Globalization Support (NLS) format and supply a string. The format depends on the Globalization Support settings.</p>
                                          </li>
                                          <li>
                                             <p>Using the <code class="codeph">TO_TIMESTAMP</code> function: 
                                             </p><pre class="oac_no_warn" dir="ltr">EXECUTE DBMS_FLASHBACK.ENABLE_AT_TIME(TO_TIMESTAMP('12-02-2001 14:35:00', 'DD-MM-YYYY HH24:MI:SS'))</pre><p>You provide the format you want to use. This example shows the <code class="codeph">TO_TIMESTAMP</code> function for February 12, 2001, 2:35 PM.
                                             </p>
                                          </li>
                                          <li>
                                             <p>If the time is omitted from query time, it defaults to the beginning of the day, that is, 12:00 A.M.</p>
                                          </li>
                                          <li>
                                             <p>Note that if the query time contains a time zone, the time zone information is truncated.</p>
                                          </li>
                                       </ul>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ARPLS66406"></a><a id="ARPLS66406"></a><div class="props_rev_3"><a id="GUID-AB866FCB-26FC-47C2-ACB0-DD1F6C7A35F3" name="GUID-AB866FCB-26FC-47C2-ACB0-DD1F6C7A35F3"></a><h4 id="ARPLS-GUID-AB866FCB-26FC-47C2-ACB0-DD1F6C7A35F3" class="sect4"><span class="enumeration_section">69.7.4 </span>GET_SYSTEM_CHANGE_NUMBER Function
                  </h4>
                  <div>
                     <p>This function returns the current SCN as an Oracle number datatype. You can obtain the current change number and store it for later use. This helps you retain specific snapshots.</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-AB866FCB-26FC-47C2-ACB0-DD1F6C7A35F3__GUID-7622354C-DDA2-4675-B759-6AF16A42D26B">Syntax</p><pre class="oac_no_warn" dir="ltr">DBMS_FLASHBACK.GET_SYSTEM_CHANGE_NUMBER
 RETURN NUMBER;</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ARPLS66407"></a><a id="ARPLS66408"></a><a id="ARPLS66408"></a><a id="ARPLS66407"></a><div class="props_rev_3"><a id="GUID-AA34A68B-E1FC-46A5-ABAB-4AEF7F7BAF88" name="GUID-AA34A68B-E1FC-46A5-ABAB-4AEF7F7BAF88"></a><h4 id="ARPLS-GUID-AA34A68B-E1FC-46A5-ABAB-4AEF7F7BAF88" class="sect4"><span class="enumeration_section">69.7.5 </span>TRANSACTION_BACKOUT Procedures
                  </h4>
                  <div>
                     <p>This procedure provides a mechanism to back out a set of transactions. The user can call these procedures with either transaction names or transaction identifiers (<code class="codeph">XIDS</code>).
                     </p>
                     <div class="section">
                        <p>The procedure analyzes the transactional dependencies, perform DMLs and generates an extensive report on the operation performed by the subprogram. This procedure does not commit the DMLs performed as part of transaction back out. However it holds all the required locks on rows and tables in the right form, so that no other dependencies can enter the system. To make the changes permanent you must explicitly commit the transaction.</p>
                        <p>A report is generated in the system tables <code class="codeph">DBA_FLASHBACK_TRANSACTION_STATE</code> and <code class="codeph">DBA_FLASHBACK_TRANSACTION_REPORT</code>.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-AA34A68B-E1FC-46A5-ABAB-4AEF7F7BAF88__GUID-5C90F1F7-53EF-4C93-90D4-88BA7237C6C1">Syntax</p><pre class="oac_no_warn" dir="ltr">DBMS_FLASHBACK.TRANSACTION_BACKOUT
   numtxns            NUMBER,
   xids               XID_ARRAY,
   options            NUMBER default NOCASCADE, 
   timeHint           TIMESTAMP default MINTIME);

DBMS_FLASHBACK.TRANSACTION_BACKOUT
   numtxns            NUMBER,  
   xids               XID_ARRAY, 
   options            NUMBER default NOCASCADE,
   scnHint            TIMESTAMP default 0   );

DBMS_FLASHBACK.TRANSACTION_BACKOUT
   numtxns           NUMBER,
   txnnames          TXNAME_ARRAY,
   options           NUMBER default NOCASCADE,
   timehint          TIMESTAMP MINTIME );

DBMS_FLASHBACK.TRANSACTION_BACKOUT
   numtxns           NUMBER, 
   txnNames         TXNAME_ARRAY, 
   options          NUMBER default NOCASCADE,
   scnHint          NUMBER 0);</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-AA34A68B-E1FC-46A5-ABAB-4AEF7F7BAF88__GUID-2A632A6D-E43F-4C48-A3E1-6A931BC3198E">Parameters</p>
                        <div class="tblformal" id="GUID-AA34A68B-E1FC-46A5-ABAB-4AEF7F7BAF88__GUID-95F6A358-B60E-4439-9787-9ABA65179F9F">
                           <p class="titleintable">Table 69-6 TRANSACTION_BACKOUT Procedure Parameters</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="TRANSACTION_BACKOUT Procedure Parameters" summary="This table describes the parameters of the DBMS_FLASHBACK.TRANSACTION_BACKOUT subprogram." width="100%" frame="hsides" border="1" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="31%" id="d434450e1675">Parameter</th>
                                    <th align="left" valign="bottom" width="69%" id="d434450e1678">Description</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d434450e1683" headers="d434450e1675 ">
                                       <p><code class="codeph">numtxns</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d434450e1683 d434450e1678 ">
                                       <p>Number of transactions passed as input</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d434450e1691" headers="d434450e1675 ">
                                       <p><code class="codeph">xids</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d434450e1691 d434450e1678 ">
                                       <p>List of transaction IDs in the form of an array</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d434450e1699" headers="d434450e1675 ">
                                       <p><code class="codeph">txnnames</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d434450e1699 d434450e1678 ">
                                       <p>List of transaction names in the form of an array</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d434450e1707" headers="d434450e1675 ">
                                       <p><code class="codeph">options</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d434450e1707 d434450e1678 ">
                                       <p>Back out dependent transactions:</p>
                                       <ul style="list-style-type: disc;">
                                          <li>
                                             <p><code class="codeph">NOCASCADE</code> - No dependency is expected. If a dependency is found, this raises an error, with the first dependent transaction provided in the report.
                                             </p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">NOCASCADE_FORCE</code> - The user forcibly backs out the given transactions without considering the dependent transactions. The RDBMS executes the <code class="codeph">UNDO</code> <code class="codeph">SQL</code> for the given transactions in reverse order of their commit times. If no constraints break, and the result is satisfactory, the user can either <code class="codeph">COMMIT</code> the changes or else <code class="codeph">ROLL</code> <code class="codeph">BACK</code>.
                                             </p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">NONCONFLICT_ONLY</code> - This option lets the user back out the changes to the nonconflicting rows of the given transactions. Note that a transaction dependency can happen due to a row conflict through either WAW or primary/unique key constraints. If the user chooses to back out only the nonconflicting rows, this does not cause any problem with database consistency, although transaction atomicity is lost. As this is a recovery operation, the user can correct the data.
                                             </p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">CASCADE</code> - This completely removes the given transactions including their dependents in a post order fashion (reverse order of commit times). 
                                             </p>
                                          </li>
                                       </ul>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d434450e1751" headers="d434450e1675 ">
                                       <p><code class="codeph">timehint</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d434450e1751 d434450e1678 ">
                                       <p>Time hint on the start of the transaction</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d434450e1759" headers="d434450e1675 ">
                                       <p><code class="codeph">scnhint</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d434450e1759 d434450e1678 ">
                                       <p>SCN hint on the start of the transaction</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-AA34A68B-E1FC-46A5-ABAB-4AEF7F7BAF88__GUID-AA602CB5-0492-4930-B7ED-B4161B6AC5F9">Usage Notes</p>
                        <div class="infoboxnote" id="GUID-AA34A68B-E1FC-46A5-ABAB-4AEF7F7BAF88__GUID-CBF0234E-747F-4B30-8704-B11ADFF2652F">
                           <p class="notep1">Note:</p>
                           <p>For information about restrictions in using <code class="codeph">TRANSACTION_BACKOUT</code>, see <a href="../adfns/flashback.html#ADFNS1010" target="_blank">"Using Flashback Transaction"</a> in the <span class="italic">Oracle Database Development Guide</span>.
                           </p>
                        </div>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>If transaction name is used, a time hint must be provided. The time hint should be a time before the start of all the given transactions to back out.</p>
                           </li>
                           <li>
                              <p>If the SCN hint is provided, it must be before the start of the earliest transaction in the specified input set, or this raises an error and terminates. If it is not provided and the transaction has committed within undo retention, the database system is able to determine the start time.</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>