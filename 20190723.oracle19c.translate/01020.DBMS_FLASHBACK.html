<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="Using DBMS_FLASHBACK, you can flash back to a version of the database at a specified time or a specified system change number (SCN)."></meta>
      <meta name="description" content="Using DBMS_FLASHBACK, you can flash back to a version of the database at a specified time or a specified system change number (SCN)."></meta>
      <title>DBMS_FLASHBACK</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="PL/SQL Packages and Types Reference"></meta>
      <meta property="og:description" content="Using DBMS_FLASHBACK, you can flash back to a version of the database at a specified time or a specified system change number (SCN)."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="PL/SQL Packages and Types Reference"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="database-pl-sql-packages-and-types-reference.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-03-25T11:24:34-07:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96430-03"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="DBMS_FILE_TRANSFER.html" title="Previous" type="text/html"></link>
      <link rel="next" href="DBMS_FLASHBACK_ARCHIVE.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database PL/SQL Packages and Types Reference"></meta>
    <meta name="dcterms.isVersionOf" content="ARPLS"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="DBMS_FILE_TRANSFER.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="DBMS_FLASHBACK_ARCHIVE.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">PL / SQL包和类型参考</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">DBMS_FLASHBACK</li>
            </ol>
            <a id="GUID-49A5AA6B-428D-45D3-955F-F30DB8DF19A3" name="GUID-49A5AA6B-428D-45D3-955F-F30DB8DF19A3"></a><a id="ARPLS142"></a><a id="ARPLS142"></a>
            
            <h2 id="ARPLS-GUID-49A5AA6B-428D-45D3-955F-F30DB8DF19A3" class="sect2"><span class="enumeration_chapter">69</span> DBMS_FLASHBACK</h2>
         </header>
         <div class="ind">
            <div>
               <p>使用<code class="codeph">DBMS_FLASHBACK</code> ，您可以在指定时间或指定的系统更改号（SCN）闪回数据库版本。
               </p>
               <p>本章包含以下主题：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="DBMS_FLASHBACK.html#GUID-99EA6692-FD05-440B-AEAA-69B09C85F05A" title="DBMS_FLASHBACK为用户提供了一个界面，供用户在过去的特定时间查看数据库，并通过事务退出功能提供额外的容量，以便有选择地删除单个事务的影响。这与闪回数据库不同，闪回数据库将数据库及时移回。">概观</a></p>
                  </li>
                  <li>
                     <p><a href="DBMS_FLASHBACK.html#GUID-722A7B55-BF3B-4FBC-B139-9C3715FDD5B3" title="要使用DBMS_FLASHBACK包，您必须具有EXECUTE特权。">安全模型</a></p>
                  </li>
                  <li>
                     <p><a href="DBMS_FLASHBACK.html#GUID-CFBE83DD-FB0A-4FF8-879F-512448FBB9F0" title="下表描述了DBMS_FLASHBACK使用的类型。">类型</a></p>
                  </li>
                  <li>
                     <p><a href="DBMS_FLASHBACK.html#GUID-B8B75749-A878-435F-9945-55C094098EEF" title="DBMS_FLASHBACK创建以下错误消息。">例外</a></p>
                  </li>
                  <li>
                     <p><a href="DBMS_FLASHBACK.html#GUID-C73A5AF2-9785-434D-AC2D-D37DCE5A26B7" title="会话结束时，DBMS_FLASHBACK会自动关闭，可以通过断开连接或启动另一个连接来关闭。">操作说明</a></p>
                  </li>
                  <li>
                     <p><a href="DBMS_FLASHBACK.html#GUID-358DF749-192B-493C-A8DF-19C87FFBE457" title="以下示例说明了当删除高级员工触发删除向他报告的所有人员时如何使用Flashback。使用闪回功能，您可以恢复并重新插入缺少的员工。">例子</a></p>
                  </li>
                  <li>
                     <p><a href="DBMS_FLASHBACK.html#GUID-E4B46686-0B8B-43F2-9B6E-43BBA0921521" title="该表列出了DBMS_FLASHBACK子程序并简要描述了它们。">DBMS_FLASHBACK子程序摘要</a></p>
                  </li>
               </ul>
               <div class="infoboxnotealso" id="GUID-49A5AA6B-428D-45D3-955F-F30DB8DF19A3__GUID-44442659-940F-4F86-A943-B8A885B44981">
                  <p class="notep1">也可以看看：</p>
                  <p>有关<code class="codeph">DBMS_FLASHBACK</code>详细信息：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="../adfns/flashback.html#ADFNS-GUID-03D1CAAE-D940-444A-8771-B1BC636D105D" target="_blank"><span><cite>Oracle数据库开发指南</cite></span></a></p>
                     </li>
                     <li>
                        <p><a href="../sqlrf/Introduction-to-Oracle-SQL.html#SQLRF-GUID-049B7AE8-11E1-4110-B3E4-D117907D77AC" target="_blank"><span><cite>Oracle数据库SQL语言参考</cite></span></a> 。
                        </p>
                     </li>
                  </ul>
               </div>
            </div><a id="ARPLS66391"></a><a id="ARPLS66391"></a><div class="props_rev_3"><a id="GUID-99EA6692-FD05-440B-AEAA-69B09C85F05A" name="GUID-99EA6692-FD05-440B-AEAA-69B09C85F05A"></a><h3 id="ARPLS-GUID-99EA6692-FD05-440B-AEAA-69B09C85F05A" class="sect3"><span class="enumeration_section">69.1</span> DBMS_FLASHBACK概述</h3>
               <div>
                  <p><code class="codeph">DBMS_FLASHBACK</code>为用户提供了一个界面，供用户在过去的特定时间查看数据库，并通过事务退出功能提供额外的容量，以便有选择地删除单个事务的影响。这与闪回数据库不同，闪回数据库将数据库及时移回。
                  </p>
                  <div class="section">
                     <p>启用<code class="codeph">DBMS_FLASHBACK</code> ，用户会话使用数据库的闪回版本，应用程序可以针对数据库的闪回版本执行。
                     </p>
                     <p>您可能希望使用<code class="codeph">DBMS_FLASHBACK</code> ，原因如下：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>自助修复：如果您不小心从表中删除了行，则可以恢复已删除的行。</p>
                        </li>
                        <li>
                           <p>打包的应用程序，如电子邮件和语音邮件：您可以使用闪回通过将已删除的邮件重新插入当前邮件框来还原已删除的电子邮件。</p>
                        </li>
                        <li>
                           <p>决策支持系统（DSS）和在线分析处理（OLAP）应用程序：您可以执行数据分析或数据建模以跟踪季节性需求。</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="ARPLS66392"></a><a id="ARPLS66392"></a><div class="props_rev_3"><a id="GUID-722A7B55-BF3B-4FBC-B139-9C3715FDD5B3" name="GUID-722A7B55-BF3B-4FBC-B139-9C3715FDD5B3"></a><h3 id="ARPLS-GUID-722A7B55-BF3B-4FBC-B139-9C3715FDD5B3" class="sect3"><span class="enumeration_section">69.2</span> DBMS_FLASHBACK安全模型</h3>
               <div>
                  <p>要使用<code class="codeph">DBMS_FLASHBACK</code>包，您必须具有<code class="codeph">EXECUTE</code>特权。
                  </p>
               </div>
            </div><a id="ARPLS66393"></a><a id="ARPLS66394"></a><a id="ARPLS66394"></a><a id="ARPLS66393"></a><div class="props_rev_3"><a id="GUID-CFBE83DD-FB0A-4FF8-879F-512448FBB9F0" name="GUID-CFBE83DD-FB0A-4FF8-879F-512448FBB9F0"></a><h3 id="ARPLS-GUID-CFBE83DD-FB0A-4FF8-879F-512448FBB9F0" class="sect3"><span class="enumeration_section">69.3</span> DBMS_FLASHBACK类型</h3>
               <div>
                  <p>下表描述了<code class="codeph">DBMS_FLASHBACK</code>使用的类型。</p>
                  <div class="tblformal" id="GUID-CFBE83DD-FB0A-4FF8-879F-512448FBB9F0__GUID-936557E1-93F8-461B-8E6A-7F6A734931EC">
                     <p class="titleintable">表69-1 DBMS_FLASHBACK</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="DBMS_FLASHBACK" width="100%" border="1" summary="This table describes Types used by DBMS_FLASHBACK subprograms." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="33%" id="d434450e497">类型</th>
                              <th align="left" valign="bottom" width="67%" id="d434450e500">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="33%" id="d434450e505" headers="d434450e497 ">
                                 <p><code class="codeph">TXNAME_ARRAY</code></p>
                              </td>
                              <td align="left" valign="top" width="67%" headers="d434450e505 d434450e500 ">
                                 <p>创建用于保存交易名称或标识符的<code class="codeph">VARRAY</code> （ <code class="codeph">XID</code> ）</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
               </div>
            </div><a id="ARPLS66395"></a><a id="ARPLS66396"></a><a id="ARPLS66396"></a><a id="ARPLS66395"></a><div class="props_rev_3"><a id="GUID-B8B75749-A878-435F-9945-55C094098EEF" name="GUID-B8B75749-A878-435F-9945-55C094098EEF"></a><h3 id="ARPLS-GUID-B8B75749-A878-435F-9945-55C094098EEF" class="sect3"><span class="enumeration_section">69.4</span> DBMS_FLASHBACK异常</h3>
               <div>
                  <p>DBMS_FLASHBACK创建以下错误消息。</p>
                  <div class="tblformal" id="GUID-B8B75749-A878-435F-9945-55C094098EEF__GUID-6453F3FC-484D-4717-BD71-3FED8DA04212">
                     <p class="titleintable">表69-2 DBMS_FLASHBACK错误消息</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="DBMS_FLASHBACK错误消息" width="100%" border="1" summary="This table describes Exceptions for the DBMS_FLASHBACK package." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="31%" id="d434450e616">错误</th>
                              <th align="left" valign="bottom" width="69%" id="d434450e619">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d434450e624" headers="d434450e616 ">
                                 <p><code class="codeph">ORA-08180</code></p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d434450e624 d434450e619 ">
                                 <p>指定的时间太旧了</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d434450e632" headers="d434450e616 ">
                                 <p><code class="codeph">ORA-08181</code></p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d434450e632 d434450e619 ">
                                 <p>指定的系统更改号无效</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d434450e640" headers="d434450e616 ">
                                 <p><code class="codeph">ORA-08182</code></p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d434450e640 d434450e619 ">
                                 <p>用户无法在闪回模式下开始只读或可序列化事务</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d434450e648" headers="d434450e616 ">
                                 <p><code class="codeph">ORA-08183</code></p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d434450e648 d434450e619 ">
                                 <p>用户无法在未提交的事务中启用闪回</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d434450e656" headers="d434450e616 ">
                                 <p><code class="codeph">ORA-08184</code></p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d434450e656 d434450e619 ">
                                 <p>用户无法在另一个闪回会话中启用闪回</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d434450e664" headers="d434450e616 ">
                                 <p><code class="codeph">ORA-08185</code></p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d434450e664 d434450e619 ">
                                 <p><code class="codeph">SYS</code>无法启用闪回模式</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
               </div>
            </div><a id="ARPLS66397"></a><a id="ARPLS66397"></a><div class="props_rev_3"><a id="GUID-C73A5AF2-9785-434D-AC2D-D37DCE5A26B7" name="GUID-C73A5AF2-9785-434D-AC2D-D37DCE5A26B7"></a><h3 id="ARPLS-GUID-C73A5AF2-9785-434D-AC2D-D37DCE5A26B7" class="sect3"><span class="enumeration_section">69.5</span> DBMS_FLASHBACK操作说明</h3>
               <div>
                  <p>会话结束时， <code class="codeph">DBMS_FLASHBACK</code>会自动关闭，可以通过断开连接或启动另一个连接来关闭。
                  </p>
                  <div class="section">
                     <p>在闪回模式下打开的PL / SQL游标返回闪回时间或SCN的行。数据库中的不同并发会话（连接）可以执行闪回到不同的挂钟时间或SCN。会话在闪回模式下运行时，不允许DML和DDL操作以及分布式操作。您可以在禁用Flashback执行DML之前使用PL / SQL游标。</p>
                     <p>在自动还原管理（AUM）模式下，您可以使用保留控制来控制所需数据库版本的时间。如果需要在24小时内执行闪回，则DBA必须将<code class="codeph">undo_retention</code>参数设置为24小时。这样，系统保留足够的撤消信息以重新生成旧版本的数据。
                     </p>
                     <p>您可以为撤消表空间设置<code class="codeph">RETENTION</code> <code class="codeph">GUARANTEE</code>子句，以确保不会丢弃未过期的撤消。 <code class="codeph"> UNDO_RETENTION</code>本身并不是一种保证，因为如果系统处于空间压力之下，未过期的撤销可能会被新生成的撤销覆盖。在这种情况下， <code class="codeph">RETENTION</code> <code class="codeph">GUARANTEE</code>可以防止这种情况发生。有关更多信息，请参见“ <a href="../admin/managing-undo.html#ADMIN-GUID-2C865CF9-A8B5-4BF1-A451-E8C08D3611F0" target="_blank"><span><cite>Oracle数据库管理员指南”</cite></span></a> 。
                     </p>
                     <p>在启用闪回的会话中， <code class="codeph">SYSDATE</code>不受影响;它继续提供当前时间。
                     </p>
                     <p><code class="codeph">DBMS_FLASHBACK</code>可以在登录触发器中使用，以在不更改应用程序代码的情况下启用闪回。
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="ARPLS66398"></a><a id="ARPLS66398"></a><div class="props_rev_3"><a id="GUID-358DF749-192B-493C-A8DF-19C87FFBE457" name="GUID-358DF749-192B-493C-A8DF-19C87FFBE457"></a><h3 id="ARPLS-GUID-358DF749-192B-493C-A8DF-19C87FFBE457" class="sect3"><span class="enumeration_section">69.6</span> DBMS_FLASHBACK示例</h3>
               <div>
                  <p>以下示例说明了当删除高级员工触发删除向他报告的所有人员时如何使用Flashback。使用闪回功能，您可以恢复并重新插入缺少的员工。</p>
                  <div class="section"><pre class="oac_no_warn" dir="ltr">DROP TABLE员工; DROP TABLE keep_scn; REM  -  Keep_scn是一个存储scns的临时表，我们对CREATE TABLE keep_scn（scn number）感兴趣; SET ECHO ON CREATE TABLE employee（employee_no number（5）PRIMARY KEY，employee_name varchar2（20），employee_mgr number（5）CONSTRAINT mgr_fkey REFERENCES EMPLOYEE DELETE CASCADE，salary number，hiredate date）; REM  - 用员工填充公司INSERT INTO员工价值（1，'John Doe'，null，1000000，'5-jul-81'）;插入员工价值观（10，'Joe Johnson'，1,500000，' -  -aug-84'）;插入员工价值观（20，'苏西老虎'，10,250000，'13 -dec-90'）;插入员工价值观（100，'Scott Tiger'，20,200000，'3-feb-86'）;插入员工价值观（200，'Charles Smith'，100,150000，'22 -mar-88'）;插入员工价值观（210，'Jane Johnson'，100,100000，'11 -apr-87'）;插入员工价值观（220，'Nancy Doe'，100,100000，'18 -sep-93'）;插入员工价值观（300，'Gary Smith'，210,75000，'4-nov-96'）;插入员工价值观（310，'Bob Smith'，210,65000，'3-may-95'）;承诺; REM  - 显示整个组织SELECT lpad（''，2 *（level-1））|| employee_name名称FROM employee CONNECT BY PRIOR employee_no = employee_mgr START WITH employee_no = 1 ORDER BY LEVEL; REM  - 短时间休眠（大约10到20秒）以避免REM  - 查询表创建接近表EXECUTE DBMS_LOCK.SLEEP（10）; REM  - 存储此快照以供以后通过Flashback DECLARE I NUMBER访问; BEGIN I：= DBMS_FLASHBACK.GET_SYSTEM_CHANGE_NUMBER; INSERT INTO keep_scn VALUES（I）;承诺;结束; / REM  -  Scott决定退休，但交易错误完成DELETE FROM EMPLOYEE WHERE employee_name ='Scott Tiger';承诺; REM  - 请注意，所有scott的员工都已离开SELECT lpad（''，2 *（level-1））|| employee_name姓名FROM EMPLOYEE CONNECT BY PRIOR employee_no = employee_mgr START WITH employee_no = 1 ORDER BY LEVEL; REM  - 闪回以查看Scott的组织DECLARE restore_scn数字; BEGIN SELECT scn INTO restore_scn FROM keep_scn; DBMS_FLASHBACK.ENABLE_AT_SYSTEM_CHANGE_NUMBER（restore_scn）;结束; / REM  - 显示斯科特的组织。SELECT lpad（''，2 *（level-1））|| employee_name名称FROM employee CONNECT BY PRIOR employee_no = employee_mgr START WITH employee_no =（SELECT employee_no FROM employee WHERE employee_name ='Scott Tiger'）ORDER BY LEVEL; REM  - 恢复斯科特的组织。DECLARE scotts_emp NUMBER; scotts_mgr NUMBER; CURSOR c1 IS SELECT employee_no，employee_name，employee_mgr，salary，hiredate FROM employee CONNECT BY PRIOR employee_no = employee_mgr START WITH employee_no =（SELECT employee_no FROM employee WHERE employee_name ='Scott Tiger'）; c1_rec c1％ROWTYPE; BEGIN SELECT employee_no，employee_mgr INTO scotts_emp，scotts_mgr FROM employee WHERE employee_name ='Scott Tiger'; / *在闪回模式下打开c1 * / OPEN c1; / *禁用闪回* / DBMS_FLASHBACK.DISABLE; LOOP FETCH c1 INTO c1_rec;退出时c1％NOTFOUND; / *请注意，循环内的所有DML操作都是在禁用Flashback * / IF（c1_rec.employee_mgr = scotts_emp）的情况下执行的，然后INSERT INTO员工VALUES（c1_rec.employee_no，c1_rec.employee_name，scotts_mgr，c1_rec.salary，c1_rec.hiredate） ; ELSE IF（c1_rec.employee_no！= scotts_emp）然后插入员工VALUES（c1_rec.employee_no，c1_rec.employee_name，c1_rec.employee_mgr，c1_rec.salary，c1_rec.hiredate）;万一;万一;结束循环;结束; / REM  - 显示已恢复的组织。选择lpad（''，2 *（level-1））|| employee_name名称FROM employee CONNECT BY PRIOR employee_no = employee_mgr START WITH employee_no = 1 ORDER BY LEVEL;</pre></div>
                  <!-- class="section" -->
               </div>
            </div><a id="ARPLS66399"></a><a id="ARPLS66400"></a><a id="ARPLS66400"></a><a id="ARPLS66399"></a><div class="props_rev_3"><a id="GUID-E4B46686-0B8B-43F2-9B6E-43BBA0921521" name="GUID-E4B46686-0B8B-43F2-9B6E-43BBA0921521"></a><h3 id="ARPLS-GUID-E4B46686-0B8B-43F2-9B6E-43BBA0921521" class="sect3"><span class="enumeration_section">69.7</span> DBMS_FLASHBACK子程序摘要</h3>
               <div>
                  <p>该表列出了<code class="codeph">DBMS_FLASHBACK</code>子程序并简要描述了它们。
                  </p>
                  <div class="tblformal" id="GUID-E4B46686-0B8B-43F2-9B6E-43BBA0921521__GUID-E6E20915-A701-45B6-AA3A-89527F21AE4C">
                     <p class="titleintable">表69-3 DBMS_FLASHBACK包子程序</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="DBMS_FLASHBACK包子程序" width="100%" border="1" summary="This table lists the DBMS_FLASHBACK subprograms in alphabetical order and briefly describes them." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="31%" id="d434450e993">子程序</th>
                              <th align="left" valign="bottom" width="69%" id="d434450e996">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d434450e1001" headers="d434450e993 ">
                                 <p><a href="DBMS_FLASHBACK.html#GUID-40298AFA-27FB-477B-97BB-65E075EDE1EA" title="此过程禁用整个会话的闪回模式。">禁用程序</a></p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d434450e1001 d434450e996 ">
                                 <p>禁用整个会话的闪回模式</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d434450e1013" headers="d434450e993 ">
                                 <p><a href="DBMS_FLASHBACK.html#GUID-0EDCB7D7-B3FF-4CE8-A146-7C67B2DCD233" title="此过程将SCN作为输入参数，并将会话快照设置为指定的数字。">ENABLE_AT_SYSTEM_CHANGE_NUMBER过程</a></p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d434450e1013 d434450e996 ">
                                 <p>为整个会话启用闪回。将SCN作为Oracle编号，并将会话快照设置为指定的编号。在闪回模式内，所有查询都返回与指定的挂钟时间或SCN一致的数据</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d434450e1025" headers="d434450e993 ">
                                 <p><a href="DBMS_FLASHBACK.html#GUID-7207DAD4-EE12-48D9-A778-F624D7D195A2" title="此过程为整个会话启用闪回。">ENABLE_AT_TIME程序</a></p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d434450e1025 d434450e996 ">
                                 <p>为整个会话启用闪回。快照时间设置为最接近<code class="codeph">query_time</code>指定时间的SCN</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d434450e1039" headers="d434450e993 ">
                                 <p><a href="DBMS_FLASHBACK.html#GUID-AB866FCB-26FC-47C2-ACB0-DD1F6C7A35F3" title="此函数将当前SCN作为Oracle数字数据类型返回。您可以获取当前更改编号并将其存储以供日后使用。这有助于您保留特定快照。">GET_SYSTEM_CHANGE_NUMBER函数</a></p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d434450e1039 d434450e996 ">
                                 <p>将当前SCN作为Oracle编号返回。您可以使用SCN存储特定快照</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d434450e1051" headers="d434450e993 ">
                                 <p><a href="DBMS_FLASHBACK.html#GUID-AA34A68B-E1FC-46A5-ABAB-4AEF7F7BAF88" title="此过程提供了一种退出一组事务的机制。用户可以使用事务名称或事务标识符（XIDS）调用这些过程。">TRANSACTION_BACKOUT程序</a></p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d434450e1051 d434450e996 ">
                                 <p>提供退出事务的机制</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
               </div><a id="ARPLS66401"></a><a id="ARPLS66401"></a><div class="props_rev_3"><a id="GUID-40298AFA-27FB-477B-97BB-65E075EDE1EA" name="GUID-40298AFA-27FB-477B-97BB-65E075EDE1EA"></a><h4 id="ARPLS-GUID-40298AFA-27FB-477B-97BB-65E075EDE1EA" class="sect4"><span class="enumeration_section">69.7.1</span>禁用程序</h4>
                  <div>
                     <p>此过程禁用整个会话的闪回模式。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-40298AFA-27FB-477B-97BB-65E075EDE1EA__GUID-B06FAD10-3230-4523-A2E1-A11FEC802557">句法</p><pre class="oac_no_warn" dir="ltr">DBMS_FLASHBACK.DISABLE;</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-40298AFA-27FB-477B-97BB-65E075EDE1EA__GUID-D14925E3-BE04-49E9-A5EC-D9FD1EC5C434">例子</p>
                        <p>以下示例在2000年8月30日查询员工Joe的薪水：</p><pre class="oac_no_warn" dir="ltr">EXECUTE dbms_flashback.enable_at_time（'30 -AUG-2000'）; SELECT salary FROM emp where name ='Joe'EXECUTE dbms_flashback.disable;</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ARPLS66402"></a><a id="ARPLS66403"></a><a id="ARPLS66403"></a><a id="ARPLS66402"></a><div class="props_rev_3"><a id="GUID-0EDCB7D7-B3FF-4CE8-A146-7C67B2DCD233" name="GUID-0EDCB7D7-B3FF-4CE8-A146-7C67B2DCD233"></a><h4 id="ARPLS-GUID-0EDCB7D7-B3FF-4CE8-A146-7C67B2DCD233" class="sect4"><span class="enumeration_section">69.7.2</span> ENABLE_AT_SYSTEM_CHANGE_NUMBER过程</h4>
                  <div>
                     <p>此过程将SCN作为输入参数，并将会话快照设置为指定的数字。</p>
                     <div class="section">
                        <p>在闪回模式下，所有查询都会返回与指定的挂钟时间或SCN一致的数据。它为整个会话启用闪回。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-0EDCB7D7-B3FF-4CE8-A146-7C67B2DCD233__GUID-AD7C0BA8-CDE0-4D51-A9D0-AE5F021279C4">句法</p><pre class="oac_no_warn" dir="ltr">DBMS_FLASHBACK.ENABLE_AT_SYSTEM_CHANGE_NUMBER（query_scn IN NUMBER）;</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-0EDCB7D7-B3FF-4CE8-A146-7C67B2DCD233__GUID-353AD05D-974A-45BE-92DA-46A84C95279B">参数</p>
                        <div class="tblformal" id="GUID-0EDCB7D7-B3FF-4CE8-A146-7C67B2DCD233__GUID-C162D5FD-DE44-47E7-B9C1-81239B8D4B4B">
                           <p class="titleintable">表69-4 ENABLE_AT_SYSTEM_CHANGE_NUMBER过程参数</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="ENABLE_AT_SYSTEM_CHANGE_NUMBER过程参数" width="100%" border="1" summary="This table describes the parameters of DBMS_FLASHBACK.ENABLE_AT_SYSTEM_CHANGE_NUMBER." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="31%" id="d434450e1283">参数</th>
                                    <th align="left" valign="bottom" width="69%" id="d434450e1286">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d434450e1291" headers="d434450e1283 ">
                                       <p><code class="codeph">query_scn</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d434450e1291 d434450e1286 ">
                                       <p>系统更改编号（SCN），数据库的版本号，在每次事务提交时递增。</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ARPLS66404"></a><a id="ARPLS66405"></a><a id="ARPLS66405"></a><a id="ARPLS66404"></a><div class="props_rev_3"><a id="GUID-7207DAD4-EE12-48D9-A778-F624D7D195A2" name="GUID-7207DAD4-EE12-48D9-A778-F624D7D195A2"></a><h4 id="ARPLS-GUID-7207DAD4-EE12-48D9-A778-F624D7D195A2" class="sect4"><span class="enumeration_section">69.7.3</span> ENABLE_AT_TIME程序</h4>
                  <div>
                     <p>此过程为整个会话启用闪回。</p>
                     <div class="section">
                        <p>快照时间设置为最接近query_time中指定时间的SCN。它为整个会话启用闪回。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-7207DAD4-EE12-48D9-A778-F624D7D195A2__GUID-951A33D5-B89A-469C-BB94-9F594335A038">句法</p><pre class="oac_no_warn" dir="ltr">DBMS_FLASHBACK.ENABLE_AT_TIME（query_time IN TIMESTAMP）;</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-7207DAD4-EE12-48D9-A778-F624D7D195A2__GUID-B4D8754F-91B5-47A5-9E5A-821942697D53">参数</p>
                        <div class="tblformal" id="GUID-7207DAD4-EE12-48D9-A778-F624D7D195A2__GUID-390717C1-9400-49C8-ACC3-EF9C955655B7">
                           <p class="titleintable">表69-5 ENABLE_AT_TIME过程参数</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="ENABLE_AT_TIME过程参数" width="100%" border="1" summary="This table describes the parameters of DBMS_FLASHBACK.ENABLE_AT_TIME." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="31%" id="d434450e1411">参数</th>
                                    <th align="left" valign="bottom" width="69%" id="d434450e1414">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d434450e1419" headers="d434450e1411 ">
                                       <p><code class="codeph">query_time</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d434450e1419 d434450e1414 ">
                                       <p>这是<code class="codeph">TIMESTAMP</code>类型的输入参数。可以通过以下方式指定时间戳：</p>
                                       <ul style="list-style-type:disc">
                                          <li>
                                             <p>使用<code class="codeph">TIMESTAMP</code>构造函数</p><pre class="oac_no_warn" dir="ltr">EXECUTE DBMS_FLASHBACK.ENABLE_AT_TIME（TIMESTAMP'2001-01-09 12:31:00'）。</pre><p>使用全球化支持（NLS）格式并提供字符串。格式取决于全球化支持设置。</p>
                                          </li>
                                          <li>
                                             <p>使用<code class="codeph">TO_TIMESTAMP</code>函数：</p><pre class="oac_no_warn" dir="ltr">EXECUTE DBMS_FLASHBACK.ENABLE_AT_TIME（TO_TIMESTAMP（'12 -02-2001 14:35:00'，'DD-MM-YYYY HH24：MI：SS'））</pre><p>您提供要使用的格式。此示例显示2001年2月12日下午2:35的<code class="codeph">TO_TIMESTAMP</code>函数。</p>
                                          </li>
                                          <li>
                                             <p>如果从查询时间中省略时间，则默认为当天的开始，即12:00 AM</p>
                                          </li>
                                          <li>
                                             <p>请注意，如果查询时间包含时区，则会截断时区信息。</p>
                                          </li>
                                       </ul>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ARPLS66406"></a><a id="ARPLS66406"></a><div class="props_rev_3"><a id="GUID-AB866FCB-26FC-47C2-ACB0-DD1F6C7A35F3" name="GUID-AB866FCB-26FC-47C2-ACB0-DD1F6C7A35F3"></a><h4 id="ARPLS-GUID-AB866FCB-26FC-47C2-ACB0-DD1F6C7A35F3" class="sect4"><span class="enumeration_section">69.7.4</span> GET_SYSTEM_CHANGE_NUMBER函数</h4>
                  <div>
                     <p>此函数将当前SCN作为Oracle数字数据类型返回。您可以获取当前更改编号并将其存储以供日后使用。这有助于您保留特定快照。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-AB866FCB-26FC-47C2-ACB0-DD1F6C7A35F3__GUID-7622354C-DDA2-4675-B759-6AF16A42D26B">句法</p><pre class="oac_no_warn" dir="ltr">DBMS_FLASHBACK.GET_SYSTEM_CHANGE_NUMBER返回号码;</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ARPLS66407"></a><a id="ARPLS66408"></a><a id="ARPLS66408"></a><a id="ARPLS66407"></a><div class="props_rev_3"><a id="GUID-AA34A68B-E1FC-46A5-ABAB-4AEF7F7BAF88" name="GUID-AA34A68B-E1FC-46A5-ABAB-4AEF7F7BAF88"></a><h4 id="ARPLS-GUID-AA34A68B-E1FC-46A5-ABAB-4AEF7F7BAF88" class="sect4"><span class="enumeration_section">69.7.5</span> TRANSACTION_BACKOUT程序</h4>
                  <div>
                     <p>此过程提供了一种退出一组事务的机制。用户可以使用事务名称或事务标识符（ <code class="codeph">XIDS</code> ）调用这些过程。
                     </p>
                     <div class="section">
                        <p>该过程分析事务依赖性，执行DML并生成关于子程序执行的操作的扩展报告。此过程不会提交作为事务退出的一部分执行的DML。但是，它以正确的形式保存行和表上的所有必需锁，因此没有其他依赖项可以进入系统。要使更改成为永久更改，您必须显式提交事务。</p>
                        <p>在系统表<code class="codeph">DBA_FLASHBACK_TRANSACTION_STATE</code>和<code class="codeph">DBA_FLASHBACK_TRANSACTION_REPORT</code>生成报告。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-AA34A68B-E1FC-46A5-ABAB-4AEF7F7BAF88__GUID-5C90F1F7-53EF-4C93-90D4-88BA7237C6C1">句法</p><pre class="oac_no_warn" dir="ltr">DBMS_FLASHBACK.TRANSACTION_BACKOUT numtxns NUMBER，xids XID_ARRAY，options NUMBER default NOCASCADE，timeHint TIMESTAMP default MINTIME）; DBMS_FLASHBACK.TRANSACTION_BACKOUT numtxns NUMBER，xids XID_ARRAY，options NUMBER default NOCASCADE，scnHint TIMESTAMP default 0）; DBMS_FLASHBACK.TRANSACTION_BACKOUT numtxns NUMBER，txnnames TXNAME_ARRAY，options NUMBER default NOCASCADE，timehint TIMESTAMP MINTIME）; DBMS_FLASHBACK.TRANSACTION_BACKOUT numtxns NUMBER，txnNames TXNAME_ARRAY，options NUMBER default NOCASCADE，scnHint NUMBER 0）;</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-AA34A68B-E1FC-46A5-ABAB-4AEF7F7BAF88__GUID-2A632A6D-E43F-4C48-A3E1-6A931BC3198E">参数</p>
                        <div class="tblformal" id="GUID-AA34A68B-E1FC-46A5-ABAB-4AEF7F7BAF88__GUID-95F6A358-B60E-4439-9787-9ABA65179F9F">
                           <p class="titleintable">表69-6 TRANSACTION_BACKOUT过程参数</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="TRANSACTION_BACKOUT过程参数" width="100%" border="1" summary="This table describes the parameters of the DBMS_FLASHBACK.TRANSACTION_BACKOUT subprogram." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="31%" id="d434450e1675">参数</th>
                                    <th align="left" valign="bottom" width="69%" id="d434450e1678">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d434450e1683" headers="d434450e1675 ">
                                       <p><code class="codeph">numtxns</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d434450e1683 d434450e1678 ">
                                       <p>作为输入传递的事务数</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d434450e1691" headers="d434450e1675 ">
                                       <p><code class="codeph">的Xid</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d434450e1691 d434450e1678 ">
                                       <p>以数组形式的事务ID列表</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d434450e1699" headers="d434450e1675 ">
                                       <p><code class="codeph">txnnames</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d434450e1699 d434450e1678 ">
                                       <p>以数组形式的事务名称列表</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d434450e1707" headers="d434450e1675 ">
                                       <p><code class="codeph">选项</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d434450e1707 d434450e1678 ">
                                       <p>退出依赖交易：</p>
                                       <ul style="list-style-type:disc">
                                          <li>
                                             <p><code class="codeph">NOCASCADE</code> - 不期望依赖。如果找到依赖关系，则会引发错误，并在报告中提供第一个依赖事务。
                                             </p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">NOCASCADE_FORCE</code> - 用户强制退出给定的事务，而不考虑依赖事务。RDBMS以与提交时间相反的顺序为给定事务执行<code class="codeph">UNDO</code> <code class="codeph">SQL</code> 。如果没有约束中断，并且结果令人满意，则用户可以<code class="codeph">COMMIT</code>更改，也可以<code class="codeph">BACK</code> <code class="codeph">ROLL</code> <code class="codeph">BACK</code> 。</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">NONCONFLICT_ONLY</code> - 此选项允许用户<code class="codeph">NONCONFLICT_ONLY</code>对给定事务的非冲突行的更改。请注意，由于WAW或主/唯一键约束的行冲突，可能会发生事务依赖性。如果用户选择仅退出非冲突行，则不会导致数据库一致性出现任何问题，但会丢失事务原子性。由于这是恢复操作，用户可以更正数据。
                                             </p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">CASCADE</code> - 这会以后置顺序方式（提交时间的反向顺序）完全删除给定的事务，包括它们的依赖项。
                                             </p>
                                          </li>
                                       </ul>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d434450e1751" headers="d434450e1675 ">
                                       <p><code class="codeph">timehint</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d434450e1751 d434450e1678 ">
                                       <p>时间暗示交易开始</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d434450e1759" headers="d434450e1675 ">
                                       <p><code class="codeph">scnhint</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d434450e1759 d434450e1678 ">
                                       <p>SCN提示交易开始</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-AA34A68B-E1FC-46A5-ABAB-4AEF7F7BAF88__GUID-AA602CB5-0492-4930-B7ED-B4161B6AC5F9">使用说明</p>
                        <div class="infoboxnote" id="GUID-AA34A68B-E1FC-46A5-ABAB-4AEF7F7BAF88__GUID-CBF0234E-747F-4B30-8704-B11ADFF2652F">
                           <p class="notep1">注意：</p>
                           <p>有关使用<code class="codeph">TRANSACTION_BACKOUT</code>限制的信息，请参阅<a href="../adfns/flashback.html#ADFNS1010" target="_blank">“</a> <span class="italic">Oracle数据库开发指南</span> <a href="../adfns/flashback.html#ADFNS1010" target="_blank">”</a>中的<a href="../adfns/flashback.html#ADFNS1010" target="_blank">“使用闪回事务”</a> 。
                           </p>
                        </div>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>如果使用事务名称，则必须提供时间提示。时间提示应该是在所有给定事务开始之前退出的时间。</p>
                           </li>
                           <li>
                              <p>如果提供了SCN提示，则必须在指定输入集中最早的事务开始之前，否则会引发错误并终止。如果未提供并且事务已在撤消保留期内提交，则数据库系统能够确定开始时间。</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>