<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="When warranted, SQL Tuning Advisor recommends a SQL profile. You can use DBMS_SQLTUNE to implement, alter, drop, and transport SQL profiles."></meta>
      <meta name="description" content="When warranted, SQL Tuning Advisor recommends a SQL profile. You can use DBMS_SQLTUNE to implement, alter, drop, and transport SQL profiles."></meta>
      <title>管理SQL配置文件</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="SQL Tuning Guide"></meta>
      <meta property="og:description" content="When warranted, SQL Tuning Advisor recommends a SQL profile. You can use DBMS_SQLTUNE to implement, alter, drop, and transport SQL profiles."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="SQL Tuning Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="sql-tuning-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-31T14:57:08-08:00"></meta>
      <meta name="dcterms.title" content="SQL Tuning Guide"></meta>
      <meta name="dcterms.dateCopyrighted" content="2013, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96095-03"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="sql-controls.html" title="Previous" type="text/html"></link>
      <link rel="next" href="overview-of-sql-plan-management.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="TGSQL"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="sql-controls.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="overview-of-sql-plan-management.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">SQL调优指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="sql-controls.html" property="item" typeof="WebPage"><span property="name">SQL管理对象</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">管理SQL配置文件</li>
            </ol>
            <a id="GUID-C7FE0936-63B8-46EF-A03E-7E59F704606E" name="GUID-C7FE0936-63B8-46EF-A03E-7E59F704606E"></a><a id="TGSQL596"></a>
            
            <h2 id="TGSQL-GUID-C7FE0936-63B8-46EF-A03E-7E59F704606E" class="sect2"><span class="enumeration_chapter">26</span>管理SQL配置文件</h2>
         </header>
         <div class="ind">
            <div>
               <p>如有必要，SQL Tuning Advisor建议使用SQL配置文件。您可以使用<code class="codeph">DBMS_SQLTUNE</code>来实现，更改，删除和传输SQL配置文件。
               </p>
               <p>本章包含以下主题：</p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="managing-sql-profiles.html#GUID-1AC3C45E-331A-4016-8FE8-7FEFFD8D7220">关于SQL配置文件</a><br><strong class="term">SQL配置文件</strong>是一个数据库对象，其中包含特定于SQL语句的辅助统计信息。
                  </li>
                  <li class="ulchildlink"><a href="managing-sql-profiles.html#GUID-350D0B3C-881D-4841-A8E8-C5EAF68AFB40">实现SQL配置文件</a><br>实现SQL配置文件意味着将其持久存储在数据库中。
                  </li>
                  <li class="ulchildlink"><a href="managing-sql-profiles.html#GUID-A10B0EA8-3215-4F58-9CBF-F23EFF6584EC">列出SQL配置文件</a><br>数据字典视图<code class="codeph">DBA_SQL_PROFILES</code>将SQL配置文件持久存储在数据库中。
                  </li>
                  <li class="ulchildlink"><a href="managing-sql-profiles.html#GUID-EF674EC7-7C8B-4EDC-A94C-62A4A16BC166">更改SQL配置文件</a><br>您可以使用<code class="codeph">ALTER_SQL_PROFILE</code>过程的<code class="codeph">attribute_name</code>参数更改现有SQL配置文件的<code class="codeph">attribute_name</code> 。
                  </li>
                  <li class="ulchildlink"><a href="managing-sql-profiles.html#GUID-EE6AA78D-A7BA-4F27-8BE4-FAE4E1C7499C">删除SQL配置文件</a><br>您可以使用<code class="codeph">DROP_SQL_PROFILE</code>过程删除SQL配置文件。
                  </li>
                  <li class="ulchildlink"><a href="managing-sql-profiles.html#GUID-147E953C-C6BD-4A4A-BAD6-A269DB72CE9D">传输SQL配置文件</a><br>您可以将SQL配置文件从一个数据库中的<code class="codeph">SYS</code>模式导出到临时表，然后将其从登台表导入另一个数据库。您可以将SQL配置文件传输到在同一版本或更高版本中创建的任何Oracle数据库。
                  </li>
               </ul>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>父主题：</strong> <a href="sql-controls.html#GUID-2889EBC8-1FAD-412F-9779-865028473607" title="SQL管理对象是一种稳定单个SQL语句的执行计划的功能。SQL配置文件和SQL计划基准是SQL管理对象。">SQL管理对象</a></p>
                  </div>
               </div>
            </div>
            <a id="TGSQL597"></a><div class="props_rev_3"><a id="GUID-1AC3C45E-331A-4016-8FE8-7FEFFD8D7220" name="GUID-1AC3C45E-331A-4016-8FE8-7FEFFD8D7220"></a><h3 id="TGSQL-GUID-1AC3C45E-331A-4016-8FE8-7FEFFD8D7220" class="sect3"><span class="enumeration_section">26.1</span>关于SQL配置文件</h3>
               <div>
                  <p><strong class="term">SQL配置文件</strong>是一个数据库对象，其中包含特定于SQL语句的辅助统计信息。
                  </p>
                  <p>从概念上讲，SQL配置文件是SQL语句的对象级统计信息对表或索引的作用。DBA调用SQL Tuning Advisor时会创建SQL配置文件。</p>
                  <p>本节包含以下主题：</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="managing-sql-profiles.html#GUID-1197742C-0599-46F4-AFA4-D624CCDC7997">SQL配置文件的用途</a><br>在分析SQL语句时，SQL Tuning Advisor使用一组特定的绑定值作为输入。
                     </li>
                     <li class="ulchildlink"><a href="managing-sql-profiles.html#GUID-41377192-7E26-47E2-9D36-6BAD85ED1367">SQL配置文件的概念</a><br>SQL配置文件是查询的辅助统计信息的集合，包括查询中引用的所有表和列。
                     </li>
                     <li class="ulchildlink"><a href="managing-sql-profiles.html#GUID-280110BE-2D94-4174-BA28-8FD731DF6F20">SQL配置文件的用户界面</a><br>Oracle Enterprise Manager云控制（云控制）通常将SQL配置文件作为自动SQL调优的一部分来处理。
                     </li>
                     <li class="ulchildlink"><a href="managing-sql-profiles.html#GUID-93C2D28A-D9D8-43CB-880B-6121E2DEF9E6">SQL配置文件的基本任务</a><br>基本任务包括接受（实现）SQL配置文件，更改它，列出它并删除它。
                     </li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-1AC3C45E-331A-4016-8FE8-7FEFFD8D7220__GUID-F5F14D24-9291-41DD-9B3B-B1D7D67C789B">
                     <p class="notep1">也可以看看：</p>
                     <p><span class="q">“ <a href="sql-tuning-advisor.html#GUID-EF47CEF3-E31A-4A2A-8BCE-19DC5F06F458" title="SQL Tuning Advisor是Oracle Database Tuning Pack中的SQL诊断软件。">关于SQL Tuning Advisor</a> ”</span></p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="managing-sql-profiles.html#GUID-C7FE0936-63B8-46EF-A03E-7E59F704606E" title="如有必要，SQL Tuning Advisor建议使用SQL配置文件。您可以使用DBMS_SQLTUNE来实现，更改，删除和传输SQL配置文件。">管理SQL配置文件</a></p>
                     </div>
                  </div>
               </div>
               <a id="TGSQL598"></a><div class="props_rev_3"><a id="GUID-1197742C-0599-46F4-AFA4-D624CCDC7997" name="GUID-1197742C-0599-46F4-AFA4-D624CCDC7997"></a><h4 id="TGSQL-GUID-1197742C-0599-46F4-AFA4-D624CCDC7997" class="sect4"><span class="enumeration_section">26.1.1</span> SQL配置文件的用途</h4>
                  <div>
                     <p>在分析SQL语句时，SQL Tuning Advisor使用一组特定的绑定值作为输入。</p>
                     <p>顾问程序将优化程序估计值与通过在数据样本上执行语句的片段获得的值进行比较。如果发现重大差异，SQL Tuning Advisor会在SQL配置文件中将纠正操作捆绑在一起，然后建议接受。</p>
                     <p>SQL配置文件中的更正统计信息可以提高优化程序<a href="glossary.html#GUID-FE541AF8-DCAB-4B00-8015-04BDCB295A85"><span class="xrefglossterm">基数</span></a>估计值，从而使优化程序可以选择更好的计划。与其他改进计划的技术相比，SQL配置文件具有以下优势：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>与提示和存储的大纲不同，SQL配置文件不会将优化程序与特定计划或子计划联系起来。SQL配置文件修复了错误的估计，同时为优化器提供了在不同情况下选择最佳计划的灵活性。</p>
                        </li>
                        <li>
                           <p>与提示不同，使用SQL配置文件时不需要更改应用程序源代码。数据库对SQL配置文件的使用对用户是透明的。</p>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-1197742C-0599-46F4-AFA4-D624CCDC7997__GUID-581F8665-E013-4E2D-B7F4-0A02BAF3478D">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="q">“ <a href="influencing-the-optimizer.html#GUID-C558F7CF-446E-4078-B045-0B3BB026CB3C" title="优化程序提示是SQL语句中的特殊注释，它将指令传递给优化程序。">用提示影响优化器</a> ”</span></p>
                           </li>
                           <li>
                              <p><span class="q">“ <a href="sql-tuning-advisor.html#GUID-8E1A39CB-A491-4254-8B31-9B1DF7B52AA1" title="使用SQL Tuning Advisor获取有关提高高负载SQL语句性能的建议，并通过仅执行最佳计划来防止回归。">使用SQL Tuning Advisor分析SQL</a> ”</span></p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-sql-profiles.html#GUID-1AC3C45E-331A-4016-8FE8-7FEFFD8D7220" title="SQL配置文件是一个数据库对象，其中包含特定于SQL语句的辅助统计信息。">关于SQL配置文件</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TGSQL600"></a><a id="TGSQL599"></a><div class="props_rev_3"><a id="GUID-41377192-7E26-47E2-9D36-6BAD85ED1367" name="GUID-41377192-7E26-47E2-9D36-6BAD85ED1367"></a><h4 id="TGSQL-GUID-41377192-7E26-47E2-9D36-6BAD85ED1367" class="sect4"><span class="enumeration_section">26.1.2</span> SQL配置文件的概念</h4>
                  <div>
                     <p>SQL配置文件是查询的辅助统计信息的集合，包括查询中引用的所有表和列。</p>
                     <p>配置文件以内部格式存储在数据字典中。用户界面是<code class="codeph">DBA_SQL_PROFILES</code>字典视图。优化程序在优化期间使用此信息来确定最佳计划。
                     </p>
                     <p>本节包含以下主题：</p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="managing-sql-profiles.html#GUID-0DF775E3-8E88-437F-8A30-1173497EB971">SQL配置文件中的统计信息</a><br>除其他统计信息外，SQL配置文件还包含一组基数调整。
                        </li>
                        <li class="ulchildlink"><a href="managing-sql-profiles.html#GUID-C22DA9DF-6D9A-490F-A169-F4439F28C49D">SQL配置文件和执行计划</a><br>SQL配置文件包含整个<span class="italic">语句的</span>补充统计信息，而不是单个<span class="italic">计划</span> 。配置文件本身并不确定具体计划。
                        </li>
                        <li class="ulchildlink"><a href="managing-sql-profiles.html#GUID-943DA3BA-BD26-40F8-863E-B5C5AD113969">SQL配置文件建议</a><br>SQL Tuning Advisor调用自动调整优化器来生成SQL配置文件建议。
                        </li>
                        <li class="ulchildlink"><a href="managing-sql-profiles.html#GUID-D930A2C3-8769-46FB-9B60-E363B98013F6">SQL配置文件和SQL计划基准</a><br>您可以使用SQL配置文件，无论是否有SQL计划管理。
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-41377192-7E26-47E2-9D36-6BAD85ED1367__GUID-EF3B351A-3C80-4323-B412-50502089F458">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="../refrn/DBA_SQL_PROFILES.html#REFRN-GUID-1F27F94F-B567-42E1-8AC4-C015F8327610" target="_blank"><span><cite>Oracle Database Reference</cite></span></a>了解有关<code class="codeph">DBA_SQL_PROFILES</code>更多信息</p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-sql-profiles.html#GUID-1AC3C45E-331A-4016-8FE8-7FEFFD8D7220" title="SQL配置文件是一个数据库对象，其中包含特定于SQL语句的辅助统计信息。">关于SQL配置文件</a></p>
                        </div>
                     </div>
                  </div>
                  
                  <div class="sect4"><a id="GUID-0DF775E3-8E88-437F-8A30-1173497EB971" name="GUID-0DF775E3-8E88-437F-8A30-1173497EB971"></a><h5 id="TGSQL-GUID-0DF775E3-8E88-437F-8A30-1173497EB971" class="sect5"><span class="enumeration_section">26.1.2.1</span> SQL配置文件中的统计信息</h5>
                     <div>
                        <p>除其他统计信息外，SQL配置文件还包含一组基数调整。</p>
                        <p>基数度量基于<code class="codeph">WHERE</code>子句的抽样，而不是统计投影。配置文件使用查询的一部分来确定估计的基数是否接近实际的基数，如果存在不匹配，则使用校正的基数。例如，如果<code class="codeph">SELECT * FROM t WHERE x=5 AND y=10</code>存在SQL配置文件，则配置文件存储返回的实际行数。
                        </p>
                        <p>从<span>Oracle Database 18c开始</span> ，SQL Tuning Advisor可以推荐一个支持Exadata的SQL配置文件。<span>在Oracle数据库云服务器上，智能扫描的成本取决于系统统计信息I / O查找时间（ <code class="codeph">ioseektim</code> ），多块读取计数（ <code class="codeph">mbrc</code> ）和I / O传输速度（ <code class="codeph">iotfrspeed</code> ）。这些统计信息的值通常在Exadata上有所不同，因此可能影响计划的选择。如果系统统计信息过时，并且如果收集它们可以提高性能，则SQL Tuning Advisor建议接受可识别Exadata的SQL配置文件。</span></p>
                     </div>
                     <div>
                        <div class="infoboxnotealso" id="GUID-0DF775E3-8E88-437F-8A30-1173497EB971__GUID-EF3B351A-3C80-4323-B412-50502089F458">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><span class="q">“ <a href="optimizer-statistics-concepts.html#GUID-BCFD6363-8860-41AE-9920-60EB695C7374" title="在Oracle数据库中，表统计信息包括有关行和块的信息。">永久表统计</a> ”</span></p>
                              </li>
                              <li>
                                 <p><a href="gathering-optimizer-statistics.html#TGSQL-GUID-AC23D691-5C54-4EF9-BF9F-65121F2AFC31" target="_blank"><span><cite>Oracle数据库性能调优指南</cite></span></a> ，了解系统统计信息</p>
                              </li>
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tgsql&amp;id=DBMSO-GUID-B978FAD1-5E8D-4518-8BAA-2A06DB3F0883" target="_blank"><span id="GUID-0DF775E3-8E88-437F-8A30-1173497EB971__DBMSO"><cite>Oracle数据库云服务器系统概述</cite></span></a></p>
                              </li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="managing-sql-profiles.html#GUID-41377192-7E26-47E2-9D36-6BAD85ED1367" title="SQL配置文件是查询的辅助统计信息的集合，包括查询中引用的所有表和列。">SQL配置文件的概念</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
                  <div class="sect4"><a id="GUID-C22DA9DF-6D9A-490F-A169-F4439F28C49D" name="GUID-C22DA9DF-6D9A-490F-A169-F4439F28C49D"></a><h5 id="TGSQL-GUID-C22DA9DF-6D9A-490F-A169-F4439F28C49D" class="sect5"><span class="enumeration_section">26.1.2.2</span> SQL配置文件和执行计划</h5>
                     <div>
                        <p>SQL配置文件包含整个<span class="italic">语句的</span>补充统计信息，而不是单个<span class="italic">计划</span> 。配置文件本身并不确定具体计划。
                        </p>
                        <p>在内部，SQL配置文件使用提示来解决不同类型的问题。这些提示未指定任何特定计划。相反，提示更正优化器估计算法中导致次优计划的错误。例如，当统计信息丢失或过时时，配置文件可以使用<code class="codeph">TABLE_STATS</code>提示来设置表的对象统计信息。
                        </p>
                        <p>选择计划时，优化程序具有以下信息源：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>环境，包含数据库配置，系统统计信息， <a href="glossary.html#GUID-CA223D31-C3CC-4037-9BAD-9AB69FDD4212"><span class="xrefglossterm">绑定变量</span></a>值， <a href="glossary.html#GUID-F9E13693-82F8-4FD3-8B9F-C58CA0DAEEB0"><span class="xrefglossterm">优化程序统计信息</span></a> ，数据集等</p>
                           </li>
                           <li>
                              <p>SQL配置文件中的补充统计信息</p>
                           </li>
                        </ul>
                        <p>下图显示了SQL语句与此语句的SQL配置文件之间的关系。优化程序使用SQL配置文件和环境生成执行计划。在此示例中，计划位于语句的<a href="glossary.html#GUID-A9B279E2-7088-4029-8C94-4E8DD00B7E21"><span class="xrefglossterm">SQL计划基准</span></a>中。
                        </p>
                        <div class="figure" id="GUID-C22DA9DF-6D9A-490F-A169-F4439F28C49D__BABHHGEH">
                           <p class="titleinfigure">图26-1 SQL配置文件</p><img src="img/pfgrf234.gif" alt="下面是图26-1的描述" title="下面是图26-1的描述" longdesc="img_text/pfgrf234.html"><br><a href="img_text/pfgrf234.html">“图26-1 SQL配置文件”的说明</a></div>
                        <!-- class="figure" -->
                        <p>如果优化程序环境或SQL配置文件发生更改，则优化程序可以创建新计划。随着表的增长，或者在创建或删除索引时，SQL配置文件的计划可能会发生变化。即使相应语句的数据分布或访问路径发生更改，配置文件仍然相关。</p>
                        <p>通常，您不需要刷新SQL配置文件。但是，随着时间的推移，个人资料内容可能会过时。在这种情况下，SQL语句的性能可能会降低。该语句可能显示为高负载或顶级SQL。在这种情况下，Automatic SQL Tuning任务再次将语句捕获为高负载SQL。您可以为该语句实现新的SQL配置文件。</p>
                     </div>
                     <div>
                        <div class="infoboxnotealso" id="GUID-C22DA9DF-6D9A-490F-A169-F4439F28C49D__GUID-EF3B351A-3C80-4323-B412-50502089F458">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><span class="q">“ <a href="overview-of-sql-plan-management.html#GUID-27C85EB8-C4CE-40C5-B99C-F4ADDC09A617" title="SQL配置文件和SQL计划基准都通过确保优化程序仅使用最佳计划来帮助提高SQL语句的性能。">SQL计划基准和SQL配置文件之间的差异</a> ”</span></p>
                              </li>
                              <li>
                                 <p><span class="q">“ <a href="optimizer-statistics-concepts.html#GUID-AEE74FB8-98BD-416B-8EA0-32CD605DF64E" title="优化程序成本模型依赖于收集的有关查询中涉及的对象的统计信息，以及运行查询的数据库和主机。">优化器统计简介</a> ”</span></p>
                              </li>
                              <li>
                                 <p><a href="../sqlrf/Comments.html#SQLRF-GUID-D316D545-89E2-4D54-977F-FC97815CD62E" target="_blank"><span><cite>Oracle Database SQL语言参考</cite></span></a> ，了解SQL提示</p>
                              </li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="managing-sql-profiles.html#GUID-41377192-7E26-47E2-9D36-6BAD85ED1367" title="SQL配置文件是查询的辅助统计信息的集合，包括查询中引用的所有表和列。">SQL配置文件的概念</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="TGSQL602"></a><a id="TGSQL601"></a><div class="props_rev_3"><a id="GUID-943DA3BA-BD26-40F8-863E-B5C5AD113969" name="GUID-943DA3BA-BD26-40F8-863E-B5C5AD113969"></a><h5 id="TGSQL-GUID-943DA3BA-BD26-40F8-863E-B5C5AD113969" class="sect5"><span class="enumeration_section">26.1.2.3</span> SQL配置文件建议</h5>
                     <div>
                        <p>SQL Tuning Advisor调用自动调整优化器来生成SQL配置文件建议。</p>
                        <p>实现SQL配置文件的建议发生在查找中，该查找显示在SQL Tuning Advisor报告的单独部分中。实现（或接受）SQL配置文件时，数据库会创建配置文件并将其持久存储在数据字典中。但是，SQL配置文件信息不会通过常规字典视图公开。</p>
                        <div class="example" id="GUID-943DA3BA-BD26-40F8-863E-B5C5AD113969__GUID-650304C5-05F8-4E3E-9F2F-BB1BBB90C999">
                           <p class="titleinexample">例26-1 SQL配置文件建议</p>
                           <p>在此示例中，数据库为使用多个昂贵连接的<code class="codeph">SELECT</code>语句找到了更好的计划。数据库建议运行<code class="codeph">DBMS_SQLTUNE.ACCEPT_SQL_PROFILE</code>以实现配置文件，这使该语句的运行速度提高了98.53％。
                           </p><pre class="pre codeblock"><code>-------------------------------------------------- -----------------------------调查结果（2项调查结果）--------------- -------------------------------------------------- -------------- 1- SQL配置文件查找（参见下面的解释计划部分）------------------------ --------------------------------此声明找到了一个可能更好的执行计划。选择要实现的以下SQL配置文件之一。建议（估计收益：99.45％）------------------------------------------ - 考虑接受推荐的SQL配置文件。执行dbms_sqltune.accept_sql_profile（task_name =&gt;'my_task'，object_id =&gt; 3，task_owner =&gt;'SH'，replace =&gt; TRUE）;验证结果------------------通过执行其计划和原始计划并测量其各自的执行统计信息来测试SQL配置文件。如果另一个计划可以在更短的时间内完成，那么该计划可能只是部分执行。原始计划与SQL配置文件％改进------------- ---------------- ----------完成状态：PARTIAL完成经过的时间（us）：15467783 226902 98.53％CPU时间（us）：15336668 226965 98.52％用户I / O时间（us）：0 0 Buffer获取：3375243 18227 99.45％磁盘读取：0 0直接写入：0 0行已处理：0 109获取：0 109执行：0 1注意----- 1。首先执行SQL配置文件计划以加热缓冲区缓存。2。SQL配置文件计划的统计信息在接下来的3次执行中取平均值。
</code></pre><p>有时，SQL Tuning Advisor可能会建议实现使用自动并行度（Auto DOP）功能的配置文件。仅当原始计划是串行计划并且并行执行可以显着减少长时间运行查询所用的时间时，才建议使用并行查询配置文件。</p>
                           <p>当它推荐使用Auto DOP的配置文件时，SQL Tuning Advisor会提供有关在报告中对SQL语句使用并行执行的性能开销的详细信息。对于并行执行建议，SQL Tuning Advisor可以提供两个SQL配置文件建议，一个使用串行执行，另一个使用并行。</p>
                           <p>以下示例显示了并行查询建议。在这个例子中，7的并行度显着改善了响应时间，代价是增加了近25％的资源消耗。您必须确定数据库吞吐量的减少是否值得响应时间的增加。</p><pre class="pre codeblock"><code>建议（估计收益：99.99％）------------------------------------------ - 考虑接受建议的SQL配置文件以对此语句使用并行执行。执行dbms_sqltune.accept_sql_profile（task_name =&gt;'gfk_task'，object_id =&gt; 3，task_owner =&gt;'SH'，replace =&gt; TRUE，profile_type =&gt; DBMS_SQLTUNE.PX_PROFILE）;与DOP 7并行执行此查询将比SQL配置文件计划的响应时间缩短82.22％。但是，启用并行执行需要一些成本。它会使语句的资源消耗增加24.43％，这可能会导致系统吞吐量降低。此外，由于这些资源的使用时间要小得多，因此如果没有足够的硬件容量，并发语句的响应时间可能会受到负面影响。以下数据显示了过去一周此SQL的一些采样统计信息以及启用并行执行时的预计每周值。过去一周这个SQL的采样统计数据----------------------------------------- Number of执行0总活动百分比.29 #Active Sessions&gt; 2 *样本的百分比0每周DB时间（秒）76.51并行执行的预测统计数据----------------- ---------------------------每周数据库时间（秒）95.21</code></pre></div>
                        <!-- class="example" -->
                     </div>
                     <div>
                        <div class="infoboxnotealso" id="GUID-943DA3BA-BD26-40F8-863E-B5C5AD113969__GUID-0C26CC17-0F63-4134-8FEE-B6B11BE6D9E8">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><span class="q">“ <a href="sql-tuning-advisor.html#GUID-93AEDB23-107C-4357-8D7E-2BDE3D1893DF" title="SQL分析是自动调整优化器对其自身估计的验证。">SQL分析</a> ”</span></p>
                              </li>
                              <li>
                                 <p><a href="../vldbg/degree-parallel.html#VLDBG0103" target="_blank"><span><cite>Oracle Database VLDB和分区指南</cite></span></a>了解有关Auto DOP的更多信息</p>
                              </li>
                              <li>
                                 <p><a href="../arpls/DBMS_SQLTUNE.html#ARPLS68398" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考，</cite></span></a>以了解<code class="codeph">DBMS_SQLTUNE.ACCEPT_SQL_PROFILE</code>过程</p>
                              </li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="managing-sql-profiles.html#GUID-41377192-7E26-47E2-9D36-6BAD85ED1367" title="SQL配置文件是查询的辅助统计信息的集合，包括查询中引用的所有表和列。">SQL配置文件的概念</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="TGSQL603"></a><div class="props_rev_3"><a id="GUID-D930A2C3-8769-46FB-9B60-E363B98013F6" name="GUID-D930A2C3-8769-46FB-9B60-E363B98013F6"></a><h5 id="TGSQL-GUID-D930A2C3-8769-46FB-9B60-E363B98013F6" class="sect5"><span class="enumeration_section">26.1.2.4</span> SQL配置文件和SQL计划基准</h5>
                     <div>
                        <p>您可以使用SQL配置文件，无论是否有SQL计划管理。</p>
                        <p>SQL配置文件和SQL计划基准之间不存在严格的关系。如果语句在SQL计划基准中有多个计划，则SQL配置文件很有用，因为它使优化程序能够在基准中选择成本最低的计划。</p>
                     </div>
                     <div>
                        <div class="infoboxnotealso" id="GUID-D930A2C3-8769-46FB-9B60-E363B98013F6__GUID-23A76F4E-C141-45F5-91E4-AF6240842CD6">
                           <p class="notep1">也可以看看：</p>
                           <p><span class="q">“ <a href="overview-of-sql-plan-management.html#GUID-F1C45056-F998-43E5-B362-83F88DA49E58" title="SQL计划管理是一种预防机制，使优化程序能够自动管理执行计划，确保数据库仅使用已知或已验证的计划。">SQL计划管理概述</a> ”</span></p>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="managing-sql-profiles.html#GUID-41377192-7E26-47E2-9D36-6BAD85ED1367" title="SQL配置文件是查询的辅助统计信息的集合，包括查询中引用的所有表和列。">SQL配置文件的概念</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div><a id="TGSQL604"></a><div class="props_rev_3"><a id="GUID-280110BE-2D94-4174-BA28-8FD731DF6F20" name="GUID-280110BE-2D94-4174-BA28-8FD731DF6F20"></a><h4 id="TGSQL-GUID-280110BE-2D94-4174-BA28-8FD731DF6F20" class="sect4"><span class="enumeration_section">26.1.3</span> SQL配置文件的用户界面</h4>
                  <div>
                     <p>Oracle Enterprise Manager云控制（云控制）通常将SQL配置文件作为自动SQL调优的一部分来处理。</p>
                     <div class="section">
                        <p>在命令行上，您可以使用<code class="codeph">DBMS_SQLTUNE</code>包管理SQL配置文件。要使用API，您必须具有<code class="codeph">ADMINISTER SQL MANAGEMENT OBJECT</code>权限。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-280110BE-2D94-4174-BA28-8FD731DF6F20__GUID-2FB91677-BFC0-41B3-9BD5-1A3D0D3BE0BE">
                        <p class="notep1">也可以看看：</p>
                        <p></p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>有关<code class="codeph">DBMS_SQLTUNE</code>包的信息<a href="../arpls/DBMS_SQLTUNE.html#ARPLS220" target="_blank"><span><cite>，请参见Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                           </li>
                           <li>
                              <p><a href="../tdppt/tuning-sql-statements.html#TDPPT163" target="_blank"><span><cite>Oracle Database 2 Day +性能调优指南</cite></span></a> ，了解如何使用Cloud Control管理SQL配置文件</p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-sql-profiles.html#GUID-1AC3C45E-331A-4016-8FE8-7FEFFD8D7220" title="SQL配置文件是一个数据库对象，其中包含特定于SQL语句的辅助统计信息。">关于SQL配置文件</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TGSQL606"></a><a id="TGSQL605"></a><div class="props_rev_3"><a id="GUID-93C2D28A-D9D8-43CB-880B-6121E2DEF9E6" name="GUID-93C2D28A-D9D8-43CB-880B-6121E2DEF9E6"></a><h4 id="TGSQL-GUID-93C2D28A-D9D8-43CB-880B-6121E2DEF9E6" class="sect4"><span class="enumeration_section">26.1.4</span> SQL配置文件的基本任务</h4>
                  <div>
                     <p>基本任务包括接受（实现）SQL配置文件，更改它，列出它并删除它。</p>
                     <p>下图显示了基本工作流程。</p>
                     <div class="figure" id="GUID-93C2D28A-D9D8-43CB-880B-6121E2DEF9E6__BABIJIIH">
                        <p class="titleinfigure">图26-2管理SQL配置文件</p><img src="img/tgsql_vm_027.png" alt="下面是图26-2的描述" title="下面是图26-2的描述" longdesc="img_text/tgsql_vm_027.html"><br><a href="img_text/tgsql_vm_027.html">“图26-2管理SQL配置文件”的说明</a></div>
                     <!-- class="figure" -->
                     <p>通常，您按以下顺序管理SQL配置文件：</p>
                     <ol>
                        <li>
                           <p>实现推荐的SQL配置文件。</p>
                           <p><span class="q">“ <a href="managing-sql-profiles.html#GUID-350D0B3C-881D-4841-A8E8-C5EAF68AFB40" title="实现SQL配置文件意味着将其持久存储在数据库中。">实现SQL配置文件</a> ”</span>描述了此任务。
                           </p>
                        </li>
                        <li>
                           <p>获取有关存储在数据库中的SQL配置文件的信息。</p>
                           <p><span class="q">“ <a href="managing-sql-profiles.html#GUID-A10B0EA8-3215-4F58-9CBF-F23EFF6584EC" title="数据字典视图DBA_SQL_PROFILES将SQL配置文件持久存储在数据库中。">列出SQL配置文件</a> ”</span>描述了此任务。
                           </p>
                        </li>
                        <li>
                           <p>（可选）修改已实现的SQL配置文件。</p>
                           <p><span class="q">“ <a href="managing-sql-profiles.html#GUID-EF674EC7-7C8B-4EDC-A94C-62A4A16BC166" title="您可以使用ALTER_SQL_PROFILE过程的attribute_name参数更改现有SQL配置文件的属性。">更改SQL配置文件</a> ”</span>描述了此任务。
                           </p>
                        </li>
                        <li>
                           <p>在不再需要时删除已实现的SQL配置文件。</p>
                           <p><span class="q">“ <a href="managing-sql-profiles.html#GUID-EE6AA78D-A7BA-4F27-8BE4-FAE4E1C7499C" title="您可以使用DROP_SQL_PROFILE过程删除SQL配置文件。">删除SQL配置文件</a> ”</span>描述了此任务。
                           </p>
                        </li>
                     </ol>
                     <p>要调整另一个数据库上的SQL语句，可以将SQL调优集和SQL配置文件传输到单独的数据库。 <span class="q">“ <a href="managing-sql-profiles.html#GUID-147E953C-C6BD-4A4A-BAD6-A269DB72CE9D" title="您可以将SQL配置文件从一个数据库中的SYS模式导出到临时表，然后将其从登台表导入另一个数据库。您可以将SQL配置文件传输到在同一版本或更高版本中创建的任何Oracle数据库。">传输SQL配置文件</a> ”</span>描述了此任务。
                     </p>
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-93C2D28A-D9D8-43CB-880B-6121E2DEF9E6__GUID-AEB3CD39-84F8-47B8-8CB6-B4525BD36CC4">
                        <p class="notep1">也可以看看：</p>
                        <p>有关<code class="codeph">DBMS_SQLTUNE</code>包的信息<a href="../arpls/DBMS_SQLTUNE.html#ARPLS220" target="_blank"><span><cite>，请参见Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-sql-profiles.html#GUID-1AC3C45E-331A-4016-8FE8-7FEFFD8D7220" title="SQL配置文件是一个数据库对象，其中包含特定于SQL语句的辅助统计信息。">关于SQL配置文件</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="TGSQL607"></a><div class="props_rev_3"><a id="GUID-350D0B3C-881D-4841-A8E8-C5EAF68AFB40" name="GUID-350D0B3C-881D-4841-A8E8-C5EAF68AFB40"></a><h3 id="TGSQL-GUID-350D0B3C-881D-4841-A8E8-C5EAF68AFB40" class="sect3"><span class="enumeration_section">26.2</span>实现SQL配置文件</h3>
               <div>
                  <p>实现SQL配置文件意味着将其持久存储在数据库中。</p>
                  <p>实现配置文件与接受配置文件相同。在生成计划之前，优化程序可以将其用作输入之前必须接受配置文件。</p>
                  <p>本节包含以下主题：</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="managing-sql-profiles.html#GUID-5EF6DC38-6118-48B4-8162-56E7C4570C1B">关于SQL配置文件实现</a><br>根据经验，实现SQL Tuning Advisor推荐的SQL配置文件。
                     </li>
                     <li class="ulchildlink"><a href="managing-sql-profiles.html#GUID-B31665FC-A81A-46EE-B04C-39A3AC6C0F47">实现SQL配置文件</a><br>要实现SQL配置文件，请使用<code class="codeph">DBMS_SQLTUNE.ACCEPT_SQL_PROFILE</code>过程。
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="managing-sql-profiles.html#GUID-C7FE0936-63B8-46EF-A03E-7E59F704606E" title="如有必要，SQL Tuning Advisor建议使用SQL配置文件。您可以使用DBMS_SQLTUNE来实现，更改，删除和传输SQL配置文件。">管理SQL配置文件</a></p>
                     </div>
                  </div>
               </div>
               <a id="TGSQL608"></a><div class="props_rev_3"><a id="GUID-5EF6DC38-6118-48B4-8162-56E7C4570C1B" name="GUID-5EF6DC38-6118-48B4-8162-56E7C4570C1B"></a><h4 id="TGSQL-GUID-5EF6DC38-6118-48B4-8162-56E7C4570C1B" class="sect4"><span class="enumeration_section">26.2.1</span>关于SQL配置文件实现</h4>
                  <div>
                     <p>根据经验，实现SQL Tuning Advisor推荐的SQL配置文件。</p>
                     <p>如果数据库同时推荐索引和SQL配置文件，则使用两者或仅使用SQL配置文件。如果创建索引，则优化程序可能需要配置文件来选择新索引。</p>
                     <p>在某些情况下，除了更好的并行计划外，SQL Tuning Advisor还可以找到改进的串行计划。在这种情况下，顾问程序建议使用标准和并行SQL配置文件，使您可以在语句的最佳串行和最佳并行计划之间进行选择。仅当响应时间的增加值得降低吞吐量时才实施并行计划。</p>
                     <p>要实现SQL配置文件，请执行<code class="codeph">DBMS_SQLTUNE.ACCEPT_SQL_PROFILE</code>过程。一些重要参数如下：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">profile_type</code></p>
                           <p>将此参数设置为<code class="codeph">REGULAR_PROFILE</code>的SQL资料，而不需要更改并行执行，或<code class="codeph">PX_PROFLE</code>用于更改并行执行的SQL资料。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">force_match</code></p>
                           <p>此参数控制语句匹配。通常，接受的SQL配置文件通过使用哈希函数生成的<a href="glossary.html#GUID-160EB64E-536F-4313-B7B0-191C2719CF1F"><span class="xrefglossterm">SQL签名</span></a>与SQL语句相关联。此哈希函数将SQL语句更改为大写，并在生成签名之前删除所有额外的空格。因此，相同的SQL配置文件适用于所有SQL语句，其中唯一的区别是大小写和空格。
                           </p>
                           <p>通过将<code class="codeph">force_match</code>设置为<code class="codeph">true</code> ，在<code class="codeph">WHERE</code>子句中的文字值被绑定变量替换之后，SQL配置文件还会针对具有相同文本的所有SQL语句。此设置对于仅使用文字值的应用程序可能很有用，因为它允许SQL只使用文本值不同的文本来共享SQL配置文件。如果文本值和绑定变量都在SQL文本中，或者<code class="codeph">force_match</code>设置为<code class="codeph">false</code> （默认值），则<code class="codeph">WHERE</code>子句中的文字值不会被绑定变量替换。
                           </p>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-5EF6DC38-6118-48B4-8162-56E7C4570C1B__GUID-E20C9F72-FC97-4C4E-BE01-4D4DB8082F68">
                        <p class="notep1">也可以看看：</p>
                        <p>有关<code class="codeph">ACCEPT_SQL_PROFILE</code>过程的信息，请<code class="codeph">ACCEPT_SQL_PROFILE</code> <a href="../arpls/DBMS_SQLTUNE.html#ARPLS220" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-sql-profiles.html#GUID-350D0B3C-881D-4841-A8E8-C5EAF68AFB40" title="实现SQL配置文件意味着将其持久存储在数据库中。">实现SQL配置文件</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TGSQL94966"></a><a id="TGSQL609"></a><div class="props_rev_3"><a id="GUID-B31665FC-A81A-46EE-B04C-39A3AC6C0F47" name="GUID-B31665FC-A81A-46EE-B04C-39A3AC6C0F47"></a><h4 id="TGSQL-GUID-B31665FC-A81A-46EE-B04C-39A3AC6C0F47" class="sect4"><span class="enumeration_section">26.2.2</span>实现SQL配置文件</h4>
                  <div>
                     <p>要实现SQL配置文件，请使用<code class="codeph">DBMS_SQLTUNE.ACCEPT_SQL_PROFILE</code>过程。
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-B31665FC-A81A-46EE-B04C-39A3AC6C0F47__GUID-0FA549CD-9EF3-4D2F-8300-0E04DD100D90">假设</p>
                        <p>本教程假设以下内容：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>SQL Tuning Advisor任务<code class="codeph">STA_SPECIFIC_EMP_TASK</code>包含创建SQL配置文件的建议。
                              </p>
                           </li>
                           <li>
                              <p>SQL配置文件的名称是<code class="codeph">my_sql_profile</code> 。
                              </p>
                           </li>
                           <li>
                              <p>PL / SQL块接受使用并行执行的配置文件（ <code class="codeph">profile_type</code> ）。
                              </p>
                           </li>
                           <li>
                              <p>配置文件使用强制匹配。</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-B31665FC-A81A-46EE-B04C-39A3AC6C0F47__GUID-EC9A7CE1-CCB9-45C7-B829-DB1CAFEC46C0">要实现SQL配置文件：</p>
                        <ol>
                           <li>
                              <p>在SQL * Plus或SQL Developer中，以具有必要权限的用户身份登录数据库。</p>
                           </li>
                           <li>
                              <p>执行<code class="codeph">ACCEPT_SQL_PROFILE</code>函数。
                              </p>
                              <p>例如，执行以下PL / SQL：</p><pre class="pre codeblock"><code>DECLARE my_sqlprofile_name VARCHAR2（30）; BEGIN my_sqlprofile_name：= DBMS_SQLTUNE.ACCEPT_SQL_PROFILE（task_name =&gt;'STA_SPECIFIC_EMP_TASK'，name =&gt;'my_sql_profile'，profile_type =&gt; DBMS_SQLTUNE.PX_PROFILE，force_match =&gt; true）;结束; /</code></pre></li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-B31665FC-A81A-46EE-B04C-39A3AC6C0F47__GUID-87C727FA-76A8-48E3-AE6C-91BDFAE1663F">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="../arpls/DBMS_SQLTUNE.html#ARPLS68398" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考，</cite></span></a>以了解<code class="codeph">DBMS_SQLTUNE.ACCEPT_SQL_PROFILE</code>过程</p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-sql-profiles.html#GUID-350D0B3C-881D-4841-A8E8-C5EAF68AFB40" title="实现SQL配置文件意味着将其持久存储在数据库中。">实现SQL配置文件</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="TGSQL610"></a><div class="props_rev_3"><a id="GUID-A10B0EA8-3215-4F58-9CBF-F23EFF6584EC" name="GUID-A10B0EA8-3215-4F58-9CBF-F23EFF6584EC"></a><h3 id="TGSQL-GUID-A10B0EA8-3215-4F58-9CBF-F23EFF6584EC" class="sect3"><span class="enumeration_section">26.3</span>列出SQL配置文件</h3>
               <div>
                  <p>数据字典视图<code class="codeph">DBA_SQL_PROFILES</code>将SQL配置文件持久存储在数据库中。
                  </p>
                  <div class="section">
                     <p>配置文件统计信息采用Oracle数据库内部格式，因此您无法直接查询配置文件。但是，您可以列出配置文件。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-A10B0EA8-3215-4F58-9CBF-F23EFF6584EC__GUID-CA454002-646B-4325-99AB-D06EC70EE8E8">列出SQL配置文件：</p>
                     <ol>
                        <li>
                           <p>在SQL * Plus或SQL Developer中，以具有必要权限的用户身份登录数据库。</p>
                        </li>
                        <li>
                           <p>查询<code class="codeph">DBA_SQL_PROFILES</code>视图。
                           </p>
                           <p>例如，执行以下查询：</p><pre class="pre codeblock"><code>COLUMN category FORMAT a10 COLUMN sql_text FORMAT a20 SELECT NAME，SQL_TEXT，CATEGORY，STATUS FROM DBA_SQL_PROFILES;</code></pre><p>示例输出显示如下：</p><pre class="pre codeblock"><code>名称SQL_TEXT CATEGORY STATUS ------------------------------ ---------------- ---- ---------- -------- SYS_SQLPROF_01285f6d18eb0000选择promo_name，c DEFAULT ENABLED ount（*）c来自promo tions p，sales s whe re s.promo_id = p.pr omo_id和p.promo_c ategory ='internet'group by p.promo_na me order by c desc</code></pre></li>
                     </ol>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-A10B0EA8-3215-4F58-9CBF-F23EFF6584EC__GUID-5E637819-C7A8-498B-A988-66EAB4F933C1">
                     <p class="notep1">也可以看看：</p>
                     <p><a href="../refrn/DBA_SQL_PROFILES.html#REFRN23477" target="_blank"><span class="italic">Oracle Database Reference</span></a>了解<code class="codeph">DBA_SQL_PROFILES</code>视图</p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="managing-sql-profiles.html#GUID-C7FE0936-63B8-46EF-A03E-7E59F704606E" title="如有必要，SQL Tuning Advisor建议使用SQL配置文件。您可以使用DBMS_SQLTUNE来实现，更改，删除和传输SQL配置文件。">管理SQL配置文件</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="TGSQL611"></a><div class="props_rev_3"><a id="GUID-EF674EC7-7C8B-4EDC-A94C-62A4A16BC166" name="GUID-EF674EC7-7C8B-4EDC-A94C-62A4A16BC166"></a><h3 id="TGSQL-GUID-EF674EC7-7C8B-4EDC-A94C-62A4A16BC166" class="sect3"><span class="enumeration_section">26.4</span>更改SQL配置文件</h3>
               <div>
                  <p>您可以使用<code class="codeph">ALTER_SQL_PROFILE</code>过程的<code class="codeph">attribute_name</code>参数更改现有SQL配置文件的<code class="codeph">attribute_name</code> 。
                  </p>
                  <div class="section">
                     <p><code class="codeph">CATEGORY</code>属性确定哪些会话可以应用配置文件。通过查询<code class="codeph">DBA_SQL_PROFILES.CATEGORY</code>查看<code class="codeph">CATEGORY</code>属性。默认情况下，所有配置文件都在<code class="codeph">DEFAULT</code>类别中，这意味着<code class="codeph">SQLTUNE_CATEGORY</code>初始化参数设置为<code class="codeph">DEFAULT</code>所有会话都可以使用该配置文件。
                     </p>
                     <p>通过更改SQL配置文件的类别，可以确定配置文件创建会影响哪些会话。例如，通过将类别设置为<code class="codeph">DEV</code> ，只有<code class="codeph">SQLTUNE_CATEGORY</code>初始化参数设置为<code class="codeph">DEV</code>会话才能使用该配置文件。其他会话无权访问SQL配置文件，SQL语句的执行计划不受SQL配置文件的影响。此技术使您可以在限制环境中测试配置文件，然后将其用于其他会话。
                     </p>
                     <p>本节中的示例假定您要更改SQL配置文件的类别，以便仅将SQL配置文件类别设置为<code class="codeph">TEST</code>的会话使用它，运行SQL语句，然后将配置文件类别更改回<code class="codeph">DEFAULT</code> 。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-EF674EC7-7C8B-4EDC-A94C-62A4A16BC166__GUID-F12E76FE-0BB0-43A1-9E88-482FF7CF8653">要更改SQL配置文件：</p>
                     <ol>
                        <li>
                           <p>在SQL * Plus或SQL Developer中，以具有必要权限的用户身份登录数据库。</p>
                        </li>
                        <li>
                           <p>使用<code class="codeph">ALTER_SQL_PROFILE</code>过程设置<code class="codeph">attribute_name</code> 。
                           </p>
                           <p>例如，执行以下代码将属性<code class="codeph">CATEGORY</code>设置为<code class="codeph">TEST</code> ：</p><pre class="pre codeblock"><code>VARIABLE pname my_sql_profile BEGIN DBMS_SQLTUNE.ALTER_SQL_PROFILE（name =&gt;：pname，attribute_name =&gt;'CATEGORY'，value =&gt;'TEST'）;结束;</code></pre></li>
                        <li>
                           <p>更改当前数据库会话中的初始化参数设置。</p>
                           <p>例如，执行以下SQL：</p><pre class="pre codeblock"><code>ALTER SESSION SET SQLTUNE_CATEGORY ='TEST';</code></pre></li>
                        <li>
                           <p>测试配置文件的SQL语句。</p>
                        </li>
                        <li>
                           <p>使用<code class="codeph">ALTER_SQL_PROFILE</code>过程设置<code class="codeph">attribute_name</code> 。
                           </p>
                           <p>例如，执行以下代码将属性<code class="codeph">CATEGORY</code>设置为<code class="codeph">DEFAULT</code> ：</p><pre class="pre codeblock"><code>VARIABLE pname my_sql_profile BEGIN DBMS_SQLTUNE.ALTER_SQL_PROFILE（name =&gt;：pname，attribute_name =&gt;'CATEGORY'，value =&gt;'DEFAULT'）;结束;</code></pre></li>
                     </ol>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-EF674EC7-7C8B-4EDC-A94C-62A4A16BC166__GUID-D1F7E260-32C6-4490-9B61-E0A2DC0ED8E8">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="../refrn/SQLTUNE_CATEGORY.html#REFRN10257" target="_blank"><span><cite>Oracle Database Reference</cite></span></a>了解<code class="codeph">SQLTUNE_CATEGORY</code>初始化参数</p>
                        </li>
                        <li>
                           <p><a href="../arpls/DBMS_SQLTUNE.html#ARPLS68402" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考，</cite></span></a>以了解<code class="codeph">ALTER_SQL_PROFILE</code>过程</p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="managing-sql-profiles.html#GUID-C7FE0936-63B8-46EF-A03E-7E59F704606E" title="如有必要，SQL Tuning Advisor建议使用SQL配置文件。您可以使用DBMS_SQLTUNE来实现，更改，删除和传输SQL配置文件。">管理SQL配置文件</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="TGSQL94967"></a><a id="TGSQL612"></a><div class="props_rev_3"><a id="GUID-EE6AA78D-A7BA-4F27-8BE4-FAE4E1C7499C" name="GUID-EE6AA78D-A7BA-4F27-8BE4-FAE4E1C7499C"></a><h3 id="TGSQL-GUID-EE6AA78D-A7BA-4F27-8BE4-FAE4E1C7499C" class="sect3"><span class="enumeration_section">26.5</span>删除SQL配置文件</h3>
               <div>
                  <p>您可以使用<code class="codeph">DROP_SQL_PROFILE</code>过程删除SQL配置文件。
                  </p>
                  <div class="section">
                     <p class="subhead2" id="GUID-EE6AA78D-A7BA-4F27-8BE4-FAE4E1C7499C__GUID-E5CF383E-DA3C-4E2B-BD7C-0F1C517A78DB">假设</p>
                     <p>本节假设以下内容：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>你想删除<code class="codeph">my_sql_profile</code> 。
                           </p>
                        </li>
                        <li>
                           <p>如果名称不存在，您希望忽略引发的错误。</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-EE6AA78D-A7BA-4F27-8BE4-FAE4E1C7499C__GUID-FEC0F32F-0625-47BD-B7FB-E3A151850DF6">要删除SQL配置文件：</p>
                     <ol>
                        <li>
                           <p>在SQL * Plus或SQL Developer中，以具有必要权限的用户身份登录数据库。</p>
                        </li>
                        <li>
                           <p>使用<code class="codeph">DBMS_SQLTUNE.DROP_SQL_PROFILE</code>过程。
                           </p>
                           <p>以下示例删除名为<code class="codeph">my_sql_profile</code>的概要文件：</p><pre class="pre codeblock"><code>BEGIN DBMS_SQLTUNE.DROP_SQL_PROFILE（name =&gt;'my_sql_profile'）;结束; /</code></pre></li>
                     </ol>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-EE6AA78D-A7BA-4F27-8BE4-FAE4E1C7499C__GUID-DDE86E81-C28E-45C1-9EC4-19373633AAF7">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="../arpls/DBMS_SQLTUNE.html#ARPLS68418" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考，</cite></span></a>以了解<code class="codeph">DROP_SQL_PROFILE</code>过程</p>
                        </li>
                        <li>
                           <p><a href="../refrn/SQLTUNE_CATEGORY.html#REFRN10257" target="_blank"><span><cite>Oracle Database Reference</cite></span></a>了解<code class="codeph">SQLTUNE_CATEGORY</code>初始化参数</p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="managing-sql-profiles.html#GUID-C7FE0936-63B8-46EF-A03E-7E59F704606E" title="如有必要，SQL Tuning Advisor建议使用SQL配置文件。您可以使用DBMS_SQLTUNE来实现，更改，删除和传输SQL配置文件。">管理SQL配置文件</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="TGSQL614"></a><a id="TGSQL94968"></a><a id="TGSQL613"></a><div class="props_rev_3"><a id="GUID-147E953C-C6BD-4A4A-BAD6-A269DB72CE9D" name="GUID-147E953C-C6BD-4A4A-BAD6-A269DB72CE9D"></a><h3 id="TGSQL-GUID-147E953C-C6BD-4A4A-BAD6-A269DB72CE9D" class="sect3"><span class="enumeration_section">26.6</span>传输SQL配置文件</h3>
               <div>
                  <p>您可以将SQL配置文件从一个数据库中的<code class="codeph">SYS</code>模式导出到临时表，然后将其从登台表导入另一个数据库。您可以将SQL配置文件传输到在同一版本或更高版本中创建的任何Oracle数据库。
                  </p>
                  <div class="section">
                     <p><a href="managing-sql-profiles.html#GUID-147E953C-C6BD-4A4A-BAD6-A269DB72CE9D__BABHHJAF" title="SQLTUNE API">表26-1</a>显示了管理SQL配置文件的主要过程和函数。
                     </p>
                     <div class="tblformal" id="GUID-147E953C-C6BD-4A4A-BAD6-A269DB72CE9D__BABHHJAF">
                        <p class="titleintable">表26-1传输SQL配置文件的API</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="用于传输SQL配置文件的API" width="100%" border="1" summary="SQLTUNE APIs" frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" id="d136610e2883">程序或功能</th>
                                 <th align="left" valign="bottom" id="d136610e2886">描述</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d136610e2891" headers="d136610e2883 ">
                                    <p><code class="codeph">CREATE_STGTAB_SQLPROF</code></p>
                                 </td>
                                 <td align="left" valign="top" headers="d136610e2891 d136610e2886 ">
                                    <p>创建用于将SQL配置文件从一个系统复制到另一个系统的临时表。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d136610e2899" headers="d136610e2883 ">
                                    <p><code class="codeph">PACK_STGTAB_SQLPROF</code></p>
                                 </td>
                                 <td align="left" valign="top" headers="d136610e2899 d136610e2886 ">
                                    <p>将配置文件数据从<code class="codeph">SYS</code>模式移动到登台表中。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d136610e2910" headers="d136610e2883 ">
                                    <p><code class="codeph">UNPACK_STGTAB_SQLPROF</code></p>
                                 </td>
                                 <td align="left" valign="top" headers="d136610e2910 d136610e2886 ">
                                    <p>使用存储在登台表中的配置文件数据在此系统上创建配置文件。</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p>下图显示了传输SQL配置文件的基本工作流程。</p>
                     <div class="figure" id="GUID-147E953C-C6BD-4A4A-BAD6-A269DB72CE9D__GUID-834E79B6-7318-48C2-87B2-5B59BF050184">
                        <p class="titleinfigure">图26-3传输SQL配置文件</p><img src="img/tgsql_vm_066.png" alt="下面是图26-3的描述" title="下面是图26-3的描述" longdesc="img_text/tgsql_vm_066.html"><br><a href="img_text/tgsql_vm_066.html">“图26-3传输SQL配置文件”的说明</a></div>
                     <!-- class="figure" -->
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-147E953C-C6BD-4A4A-BAD6-A269DB72CE9D__GUID-C6A16E15-4353-4F21-B9C8-41B8715B1918">假设</p>
                     <p>本教程假设以下内容：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>您希望将<code class="codeph">my_profile</code>从生产数据库传输到测试数据库。
                           </p>
                        </li>
                        <li>
                           <p>您想在<code class="codeph">dba1</code>架构中创建临时表。
                           </p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-147E953C-C6BD-4A4A-BAD6-A269DB72CE9D__GUID-502E9FC0-096B-4A07-B83F-D05374F773F4">要传输SQL配置文件：</p>
                     <ol>
                        <li>
                           <p>使用适当的权限将SQL * Plus连接到数据库，然后使用<code class="codeph">CREATE_STGTAB_SQLPROF</code>过程创建用于保存SQL配置文件的临时表。
                           </p>
                           <p>以下示例在<code class="codeph">dba1</code>架构中创建<code class="codeph">my_staging_table</code> ：</p><pre class="pre codeblock"><code>BEGIN DBMS_SQLTUNE.CREATE_STGTAB_SQLPROF（table_name =&gt;'my_staging_table'，schema_name =&gt;'dba1'）;结束; /</code></pre></li>
                        <li>
                           <p>使用<code class="codeph">PACK_STGTAB_SQLPROF</code>过程将SQL配置文件导出到临时表中。
                           </p>
                           <p>以下示例使用SQL配置文件<code class="codeph">my_profile</code>填充<code class="codeph">dba1.my_staging_table</code> ：</p><pre class="pre codeblock"><code>BEGIN DBMS_SQLTUNE.PACK_STGTAB_SQLPROF（profile_name =&gt;'my_profile'，staging_table_name =&gt;'my_staging_table'，staging_schema_owner =&gt;'dba1'）;结束; /</code></pre></li>
                        <li>
                           <p>将登台表移动到计划解压缩SQL配置文件的数据库。</p>
                           <p>使用您选择的实用程序移动表。例如，使用Oracle Data Pump或数据库链接。</p>
                        </li>
                        <li>
                           <p>在计划导入SQL配置文件的数据库上，使用<code class="codeph">UNPACK_STGTAB_SQLPROF</code>从登台表中解压缩SQL配置文件。
                           </p>
                           <p>以下示例说明如何在登台表中解压缩SQL配置文件：</p><pre class="pre codeblock"><code>BEGIN DBMS_SQLTUNE.UNPACK_STGTAB_SQLPROF（replace =&gt; true，staging_table_name =&gt;'my_staging_table'）;结束; /</code></pre></li>
                     </ol>
                  </div>
                  <!-- class="section" -->
                  <div class="section"></div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-147E953C-C6BD-4A4A-BAD6-A269DB72CE9D__GUID-C6966ECF-E518-4AD6-8742-79346FCCC4DA">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>有关<code class="codeph">DBMS_SQLTUNE</code>完整参考信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tgsql&amp;id=ARPLS220" target="_blank"><span><cite>参见Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                        </li>
                        <li>
                           <p><a href="../sutil/oracle-data-pump-overview.html#SUTIL100" target="_blank"><span><cite>Oracle数据库实用程序</cite></span></a> ，了解如何使用Oracle Data Pump</p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="managing-sql-profiles.html#GUID-C7FE0936-63B8-46EF-A03E-7E59F704606E" title="如有必要，SQL Tuning Advisor建议使用SQL配置文件。您可以使用DBMS_SQLTUNE来实现，更改，删除和传输SQL配置文件。">管理SQL配置文件</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
         </div>
      </article>
   </body>
</html>