<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="When warranted, SQL Tuning Advisor recommends a SQL profile. You can use DBMS_SQLTUNE to implement, alter, drop, and transport SQL profiles.">
      <meta name="description" content="When warranted, SQL Tuning Advisor recommends a SQL profile. You can use DBMS_SQLTUNE to implement, alter, drop, and transport SQL profiles.">
      <title>Managing SQL Profiles</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="SQL Tuning Guide">
      <meta property="og:description" content="When warranted, SQL Tuning Advisor recommends a SQL profile. You can use DBMS_SQLTUNE to implement, alter, drop, and transport SQL profiles.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="SQL Tuning Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="sql-tuning-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-01-31T14:57:08-08:00">
      <meta name="dcterms.title" content="SQL Tuning Guide">
      <meta name="dcterms.dateCopyrighted" content="2013, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96095-03">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="sql-controls.html" title="Previous" type="text/html">
      <link rel="next" href="overview-of-sql-plan-management.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="TGSQL">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="sql-controls.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="overview-of-sql-plan-management.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">SQL Tuning Guide</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="sql-controls.html" property="item" typeof="WebPage"><span property="name">SQL Management Objects</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Managing SQL Profiles</li>
            </ol>
            <a id="GUID-C7FE0936-63B8-46EF-A03E-7E59F704606E" name="GUID-C7FE0936-63B8-46EF-A03E-7E59F704606E"></a><a id="TGSQL596"></a>
            
            <h2 id="TGSQL-GUID-C7FE0936-63B8-46EF-A03E-7E59F704606E" class="sect2"><span class="enumeration_chapter">26 </span>Managing SQL Profiles
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>When warranted, SQL Tuning Advisor recommends a SQL profile. You can use <code class="codeph">DBMS_SQLTUNE</code> to implement, alter, drop, and transport SQL profiles.
               </p>
               <p>This chapter contains the following topics:</p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="managing-sql-profiles.html#GUID-1AC3C45E-331A-4016-8FE8-7FEFFD8D7220">About SQL Profiles</a><br>A <strong class="term">SQL profile</strong> is a database object that contains auxiliary statistics specific to a SQL statement. 
                  </li>
                  <li class="ulchildlink"><a href="managing-sql-profiles.html#GUID-350D0B3C-881D-4841-A8E8-C5EAF68AFB40">Implementing a SQL Profile</a><br>Implementing a SQL profile means storing it persistently in the database.
                  </li>
                  <li class="ulchildlink"><a href="managing-sql-profiles.html#GUID-A10B0EA8-3215-4F58-9CBF-F23EFF6584EC">Listing SQL Profiles</a><br>The data dictionary view <code class="codeph">DBA_SQL_PROFILES</code> stores SQL profiles persistently in the database. 
                  </li>
                  <li class="ulchildlink"><a href="managing-sql-profiles.html#GUID-EF674EC7-7C8B-4EDC-A94C-62A4A16BC166">Altering a SQL Profile</a><br>You can alter attributes of an existing SQL profile using the <code class="codeph">attribute_name</code> parameter of the <code class="codeph">ALTER_SQL_PROFILE</code> procedure.
                  </li>
                  <li class="ulchildlink"><a href="managing-sql-profiles.html#GUID-EE6AA78D-A7BA-4F27-8BE4-FAE4E1C7499C">Dropping a SQL Profile</a><br>You can drop a SQL profile with the <code class="codeph">DROP_SQL_PROFILE</code> procedure. 
                  </li>
                  <li class="ulchildlink"><a href="managing-sql-profiles.html#GUID-147E953C-C6BD-4A4A-BAD6-A269DB72CE9D">Transporting a SQL Profile</a><br>You can export a SQL profile from the <code class="codeph">SYS</code> schema in one database to a staging table, and then import it from the staging table into another database. You can transport a SQL profile to any Oracle database created in the same release or later.
                  </li>
               </ul>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>Parent topic:</strong> <a href="sql-controls.html#GUID-2889EBC8-1FAD-412F-9779-865028473607" title="A SQL management object is a feature that stabilizes the execution plans of individual SQL statements. SQL profiles and SQL plan baselines are SQL management objects.">SQL Management Objects</a></p>
                  </div>
               </div>
            </div>
            <a id="TGSQL597"></a><div class="props_rev_3"><a id="GUID-1AC3C45E-331A-4016-8FE8-7FEFFD8D7220" name="GUID-1AC3C45E-331A-4016-8FE8-7FEFFD8D7220"></a><h3 id="TGSQL-GUID-1AC3C45E-331A-4016-8FE8-7FEFFD8D7220" class="sect3"><span class="enumeration_section">26.1 </span>About SQL Profiles
               </h3>
               <div>
                  <p>A <strong class="term">SQL profile</strong> is a database object that contains auxiliary statistics specific to a SQL statement. 
                  </p>
                  <p>Conceptually, a SQL profile is to a SQL statement what object-level statistics are to a table or index. SQL profiles are created when a DBA invokes SQL Tuning Advisor.</p>
                  <p>This section contains the following topics:</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="managing-sql-profiles.html#GUID-1197742C-0599-46F4-AFA4-D624CCDC7997">Purpose of SQL Profiles</a><br>When profiling a SQL statement, SQL Tuning Advisor uses a specific set of bind values as input.
                     </li>
                     <li class="ulchildlink"><a href="managing-sql-profiles.html#GUID-41377192-7E26-47E2-9D36-6BAD85ED1367">Concepts for SQL Profiles</a><br>A SQL profile is a collection of auxiliary statistics on a query, including all tables and columns referenced in the query.
                     </li>
                     <li class="ulchildlink"><a href="managing-sql-profiles.html#GUID-280110BE-2D94-4174-BA28-8FD731DF6F20">User Interfaces for SQL Profiles</a><br>Oracle Enterprise Manager Cloud Control (Cloud Control) usually handles SQL profiles as part of automatic SQL tuning.
                     </li>
                     <li class="ulchildlink"><a href="managing-sql-profiles.html#GUID-93C2D28A-D9D8-43CB-880B-6121E2DEF9E6">Basic Tasks for SQL Profiles</a><br>Basic tasks include accepting (implementing) a SQL profile, altering it, listing it, and dropping it.
                     </li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-1AC3C45E-331A-4016-8FE8-7FEFFD8D7220__GUID-F5F14D24-9291-41DD-9B3B-B1D7D67C789B">
                     <p class="notep1">See Also:</p>
                     <p><span class="q">"<a href="sql-tuning-advisor.html#GUID-EF47CEF3-E31A-4A2A-8BCE-19DC5F06F458" title="SQL Tuning Advisor is SQL diagnostic software in the Oracle Database Tuning Pack.">About SQL Tuning Advisor</a>"</span></p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="managing-sql-profiles.html#GUID-C7FE0936-63B8-46EF-A03E-7E59F704606E" title="When warranted, SQL Tuning Advisor recommends a SQL profile. You can use DBMS_SQLTUNE to implement, alter, drop, and transport SQL profiles.">Managing SQL Profiles</a></p>
                     </div>
                  </div>
               </div>
               <a id="TGSQL598"></a><div class="props_rev_3"><a id="GUID-1197742C-0599-46F4-AFA4-D624CCDC7997" name="GUID-1197742C-0599-46F4-AFA4-D624CCDC7997"></a><h4 id="TGSQL-GUID-1197742C-0599-46F4-AFA4-D624CCDC7997" class="sect4"><span class="enumeration_section">26.1.1 </span>Purpose of SQL Profiles
                  </h4>
                  <div>
                     <p>When profiling a SQL statement, SQL Tuning Advisor uses a specific set of bind values as input.</p>
                     <p>The advisor compares the optimizer estimate with values obtained by executing fragments of the statement on a data sample. When significant variances are found, SQL Tuning Advisor bundles corrective actions together in a SQL profile, and then recommends its acceptance. </p>
                     <p>The corrected statistics in a SQL profile can improve optimizer <a href="glossary.html#GUID-FE541AF8-DCAB-4B00-8015-04BDCB295A85"><span class="xrefglossterm">cardinality</span></a> estimates, which in turn leads the optimizer to select better plans. SQL profiles provide the following benefits over other techniques for improving plans:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Unlike hints and stored outlines, SQL profiles do not tie the optimizer to a specific plan or subplan. SQL profiles fix incorrect estimates while giving the optimizer the flexibility to pick the best plan in different situations.</p>
                        </li>
                        <li>
                           <p>Unlike hints, no changes to application source code are necessary when using SQL profiles. The use of SQL profiles by the database is transparent to the user.</p>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-1197742C-0599-46F4-AFA4-D624CCDC7997__GUID-581F8665-E013-4E2D-B7F4-0A02BAF3478D">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><span class="q">"<a href="influencing-the-optimizer.html#GUID-C558F7CF-446E-4078-B045-0B3BB026CB3C" title="Optimizer hints are special comments in a SQL statement that pass instructions to the optimizer.">Influencing the Optimizer with Hints</a>"</span></p>
                           </li>
                           <li>
                              <p><span class="q">"<a href="sql-tuning-advisor.html#GUID-8E1A39CB-A491-4254-8B31-9B1DF7B52AA1" title="Use SQL Tuning Advisor to obtain recommendations for improving performance of high-load SQL statements, and prevent regressions by only executing optimal plans.">Analyzing SQL with SQL Tuning Advisor</a>"</span></p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-sql-profiles.html#GUID-1AC3C45E-331A-4016-8FE8-7FEFFD8D7220" title="A SQL profile is a database object that contains auxiliary statistics specific to a SQL statement.">About SQL Profiles</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TGSQL600"></a><a id="TGSQL599"></a><div class="props_rev_3"><a id="GUID-41377192-7E26-47E2-9D36-6BAD85ED1367" name="GUID-41377192-7E26-47E2-9D36-6BAD85ED1367"></a><h4 id="TGSQL-GUID-41377192-7E26-47E2-9D36-6BAD85ED1367" class="sect4"><span class="enumeration_section">26.1.2 </span>Concepts for SQL Profiles
                  </h4>
                  <div>
                     <p>A SQL profile is a collection of auxiliary statistics on a query, including all tables and columns referenced in the query.</p>
                     <p>The profile is stored in an internal format in the data dictionary. The user interface is the <code class="codeph">DBA_SQL_PROFILES</code> dictionary view. The optimizer uses this information during optimization to determine the most optimal plan.
                     </p>
                     <p>This section contains the following topics:</p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="managing-sql-profiles.html#GUID-0DF775E3-8E88-437F-8A30-1173497EB971">Statistics in SQL Profiles</a><br>A SQL profile contains, among other statistics, a set of cardinality adjustments.
                        </li>
                        <li class="ulchildlink"><a href="managing-sql-profiles.html#GUID-C22DA9DF-6D9A-490F-A169-F4439F28C49D">SQL Profiles and Execution Plans</a><br>The SQL profile contains supplemental statistics for the entire <span class="italic">statement</span>, not individual <span class="italic">plans</span>. The profile does not itself determine a specific plan.
                        </li>
                        <li class="ulchildlink"><a href="managing-sql-profiles.html#GUID-943DA3BA-BD26-40F8-863E-B5C5AD113969">SQL Profile Recommendations</a><br>SQL Tuning Advisor invokes Automatic Tuning Optimizer to generate SQL profile recommendations. 
                        </li>
                        <li class="ulchildlink"><a href="managing-sql-profiles.html#GUID-D930A2C3-8769-46FB-9B60-E363B98013F6">SQL Profiles and SQL Plan Baselines</a><br>You can use SQL profiles with or without SQL plan management.
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-41377192-7E26-47E2-9D36-6BAD85ED1367__GUID-EF3B351A-3C80-4323-B412-50502089F458">
                        <p class="notep1">See Also:</p>
                        <p><a href="../refrn/DBA_SQL_PROFILES.html#REFRN-GUID-1F27F94F-B567-42E1-8AC4-C015F8327610" target="_blank"><span><cite>Oracle Database Reference</cite></span></a> to learn more about <code class="codeph">DBA_SQL_PROFILES</code></p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-sql-profiles.html#GUID-1AC3C45E-331A-4016-8FE8-7FEFFD8D7220" title="A SQL profile is a database object that contains auxiliary statistics specific to a SQL statement.">About SQL Profiles</a></p>
                        </div>
                     </div>
                  </div>
                  
                  <div class="sect4"><a id="GUID-0DF775E3-8E88-437F-8A30-1173497EB971" name="GUID-0DF775E3-8E88-437F-8A30-1173497EB971"></a><h5 id="TGSQL-GUID-0DF775E3-8E88-437F-8A30-1173497EB971" class="sect5"><span class="enumeration_section">26.1.2.1 </span>Statistics in SQL Profiles
                     </h5>
                     <div>
                        <p>A SQL profile contains, among other statistics, a set of cardinality adjustments.</p>
                        <p>The cardinality measure is based on sampling the <code class="codeph">WHERE</code> clause rather than on statistical projection. A profile uses parts of the query to determine whether the estimated cardinalities are close to the actual cardinalities and, if a mismatch exists, uses the corrected cardinalities. For example, if a SQL profile exists for <code class="codeph">SELECT * FROM t WHERE x=5 AND y=10</code>, then the profile stores the actual number of rows returned.
                        </p>
                        <p>Starting in <span>Oracle Database 18c</span>, SQL Tuning Advisor can recommend an Exadata-aware SQL profile. <span>On Oracle Exadata Database Machine, the cost of smart scans depends on the system statistics I/O seek time (<code class="codeph">ioseektim</code>), multiblock read count (<code class="codeph">mbrc</code>), and I/O transfer speed (<code class="codeph">iotfrspeed</code>). The values of these statistics usually differ on Exadata and can thus influence the choice of plan. If system statistics are stale, and if gathering them improves performance, then SQL Tuning Advisor recommends accepting an Exadata-aware SQL profile.</span></p>
                     </div>
                     <div>
                        <div class="infoboxnotealso" id="GUID-0DF775E3-8E88-437F-8A30-1173497EB971__GUID-EF3B351A-3C80-4323-B412-50502089F458">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><span class="q">"<a href="optimizer-statistics-concepts.html#GUID-BCFD6363-8860-41AE-9920-60EB695C7374" title="In Oracle Database, table statistics include information about rows and blocks.">Permanent Table Statistics</a>"</span></p>
                              </li>
                              <li>
                                 <p><a href="gathering-optimizer-statistics.html#TGSQL-GUID-AC23D691-5C54-4EF9-BF9F-65121F2AFC31" target="_blank"><span><cite>Oracle Database Performance Tuning Guide</cite></span></a> to learn about system statistics
                                 </p>
                              </li>
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tgsql&amp;id=DBMSO-GUID-B978FAD1-5E8D-4518-8BAA-2A06DB3F0883" target="_blank"><span id="GUID-0DF775E3-8E88-437F-8A30-1173497EB971__DBMSO"><cite>Oracle Exadata Database Machine System Overview</cite></span></a></p>
                              </li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="managing-sql-profiles.html#GUID-41377192-7E26-47E2-9D36-6BAD85ED1367" title="A SQL profile is a collection of auxiliary statistics on a query, including all tables and columns referenced in the query.">Concepts for SQL Profiles</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
                  <div class="sect4"><a id="GUID-C22DA9DF-6D9A-490F-A169-F4439F28C49D" name="GUID-C22DA9DF-6D9A-490F-A169-F4439F28C49D"></a><h5 id="TGSQL-GUID-C22DA9DF-6D9A-490F-A169-F4439F28C49D" class="sect5"><span class="enumeration_section">26.1.2.2 </span>SQL Profiles and Execution Plans
                     </h5>
                     <div>
                        <p>The SQL profile contains supplemental statistics for the entire <span class="italic">statement</span>, not individual <span class="italic">plans</span>. The profile does not itself determine a specific plan.
                        </p>
                        <p>Internally, a SQL profile is implemented using hints that address different types of problems. These hints do not specify any particular plan. Rather, the hints correct errors in the optimizer estimation algorithm that lead to suboptimal plans. For example, a profile may use the <code class="codeph">TABLE_STATS</code> hint to set object statistics for tables when the statistics are missing or stale.
                        </p>
                        <p>When choosing plans, the optimizer has the following sources of information:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>The environment, which contains the database configuration, system statistics, <a href="glossary.html#GUID-CA223D31-C3CC-4037-9BAD-9AB69FDD4212"><span class="xrefglossterm">bind variable</span></a> values, <a href="glossary.html#GUID-F9E13693-82F8-4FD3-8B9F-C58CA0DAEEB0"><span class="xrefglossterm">optimizer statistics</span></a>, data set, and so on
                              </p>
                           </li>
                           <li>
                              <p>The supplemental statistics in the SQL profile</p>
                           </li>
                        </ul>
                        <p>The following figure shows the relationship between a SQL statement and the SQL profile for this statement. The optimizer uses the SQL profile and the environment to generate an execution plan. In this example, the plan is in the <a href="glossary.html#GUID-A9B279E2-7088-4029-8C94-4E8DD00B7E21"><span class="xrefglossterm">SQL plan baseline</span></a> for the statement.
                        </p>
                        <div class="figure" id="GUID-C22DA9DF-6D9A-490F-A169-F4439F28C49D__BABHHGEH">
                           <p class="titleinfigure">Figure 26-1 SQL Profile</p><img src="img/pfgrf234.gif" alt="Description of Figure 26-1 follows" title="Description of Figure 26-1 follows" longdesc="img_text/pfgrf234.html"><br><a href="img_text/pfgrf234.html">Description of "Figure 26-1 SQL Profile"</a></div>
                        <!-- class="figure" -->
                        <p>If either the optimizer environment or SQL profile changes, then the optimizer can create a new plan. As tables grow, or as indexes are created or dropped, the plan for a SQL profile can change. The profile continues to be relevant even if the data distribution or access path of the corresponding statement changes. </p>
                        <p>In general, you do not need to refresh SQL profiles. Over time, however, profile content can become outdated. In this case, performance of the SQL statement may degrade. The statement may appear as high-load or top SQL. In this case, the Automatic SQL Tuning task again captures the statement as high-load SQL. You can implement a new SQL profile for the statement.</p>
                     </div>
                     <div>
                        <div class="infoboxnotealso" id="GUID-C22DA9DF-6D9A-490F-A169-F4439F28C49D__GUID-EF3B351A-3C80-4323-B412-50502089F458">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><span class="q">"<a href="overview-of-sql-plan-management.html#GUID-27C85EB8-C4CE-40C5-B99C-F4ADDC09A617" title="Both SQL profiles and SQL plan baselines help improve the performance of SQL statements by ensuring that the optimizer uses only optimal plans.">Differences Between SQL Plan Baselines and SQL Profiles</a>"</span></p>
                              </li>
                              <li>
                                 <p><span class="q">"<a href="optimizer-statistics-concepts.html#GUID-AEE74FB8-98BD-416B-8EA0-32CD605DF64E" title="The optimizer cost model relies on statistics collected about the objects involved in a query, and the database and host where the query runs.">Introduction to Optimizer Statistics</a>"</span></p>
                              </li>
                              <li>
                                 <p><a href="../sqlrf/Comments.html#SQLRF-GUID-D316D545-89E2-4D54-977F-FC97815CD62E" target="_blank"><span><cite>Oracle Database SQL Language Reference</cite></span></a> to learn about SQL hints
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="managing-sql-profiles.html#GUID-41377192-7E26-47E2-9D36-6BAD85ED1367" title="A SQL profile is a collection of auxiliary statistics on a query, including all tables and columns referenced in the query.">Concepts for SQL Profiles</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="TGSQL602"></a><a id="TGSQL601"></a><div class="props_rev_3"><a id="GUID-943DA3BA-BD26-40F8-863E-B5C5AD113969" name="GUID-943DA3BA-BD26-40F8-863E-B5C5AD113969"></a><h5 id="TGSQL-GUID-943DA3BA-BD26-40F8-863E-B5C5AD113969" class="sect5"><span class="enumeration_section">26.1.2.3 </span>SQL Profile Recommendations
                     </h5>
                     <div>
                        <p>SQL Tuning Advisor invokes Automatic Tuning Optimizer to generate SQL profile recommendations. </p>
                        <p>Recommendations to implement SQL profiles occur in a finding, which appears in a separate section of the SQL Tuning Advisor report. When you implement (or accept) a SQL profile, the database creates the profile and stores it persistently in the data dictionary. However, the SQL profile information is not exposed through regular dictionary views.</p>
                        <div class="example" id="GUID-943DA3BA-BD26-40F8-863E-B5C5AD113969__GUID-650304C5-05F8-4E3E-9F2F-BB1BBB90C999">
                           <p class="titleinexample">Example 26-1 SQL Profile Recommendation</p>
                           <p>In this example, the database found a better plan for a <code class="codeph">SELECT</code> statement that uses several expensive joins. The database recommends running <code class="codeph">DBMS_SQLTUNE.ACCEPT_SQL_PROFILE</code> to implement the profile, which enables the statement to run 98.53% faster.
                           </p><pre class="pre codeblock"><code>-------------------------------------------------------------------------------
FINDINGS SECTION (2 findings)
-------------------------------------------------------------------------------
 
1- SQL Profile Finding (see explain plans section below)
--------------------------------------------------------
  A potentially better execution plan was found for this statement. Choose
  one of the following SQL profiles to implement.
 
  Recommendation (estimated benefit: 99.45%)
  ------------------------------------------
  - Consider accepting the recommended SQL profile.
    execute dbms_sqltune.accept_sql_profile(task_name =&gt; 'my_task',
            object_id =&gt; 3, task_owner =&gt; 'SH', replace =&gt; TRUE);
 
  Validation results
  ------------------
  The SQL profile was tested by executing both its plan and the original plan
  and measuring their respective execution statistics. A plan may have been
  only partially executed if the other could be run to completion in less time.
 
                           Original Plan  With SQL Profile  % Improved
                           -------------  ----------------  ----------
  Completion Status:             PARTIAL          COMPLETE
  Elapsed Time(us):            15467783            226902      98.53 %
  CPU Time(us):                15336668            226965      98.52 %
  User I/O Time(us):                  0                 0
  Buffer Gets:                  3375243             18227      99.45 %
  Disk Reads:                         0                 0
  Direct Writes:                      0                 0
  Rows Processed:                     0               109
  Fetches:                            0               109
  Executions:                         0                 1
 
  Notes
  -----
  1. The SQL profile plan was first executed to warm the buffer cache.
  2. Statistics for the SQL profile plan were averaged over next 3 executions.
</code></pre><p>Sometimes SQL Tuning Advisor may recommend implementing a profile that uses the Automatic Degree of Parallelism (Auto DOP) feature. A parallel query profile is only recommended when the original plan is serial and when parallel execution can significantly reduce the elapsed time for a long-running query. </p>
                           <p>When it recommends a profile that uses Auto DOP, SQL Tuning Advisor gives details about the performance overhead of using parallel execution for the SQL statement in the report. For parallel execution recommendations, SQL Tuning Advisor may provide two SQL profile recommendations, one using serial execution and one using parallel.</p>
                           <p>The following example shows a parallel query recommendation. In this example, a degree of parallelism of 7 improves response time significantly at the cost of increasing resource consumption by almost 25%. You must decide whether the reduction in database throughput is worth the increase in response time.</p><pre class="pre codeblock"><code>  Recommendation (estimated benefit: 99.99%)
  ------------------------------------------
  - Consider accepting the recommended SQL profile to use parallel execution
    for this statement.
    execute dbms_sqltune.accept_sql_profile(task_name =&gt; 'gfk_task',
            object_id =&gt; 3, task_owner =&gt; 'SH', replace =&gt; TRUE,
            profile_type =&gt; DBMS_SQLTUNE.PX_PROFILE);
 
  Executing this query parallel with DOP 7 will improve its response time
  82.22% over the SQL profile plan. However, there is some cost in enabling
  parallel execution. It will increase the statement's resource consumption by
  an estimated 24.43% which may result in a reduction of system throughput.
  Also, because these resources are consumed over a much smaller duration, the
  response time of concurrent statements might be negatively impacted if
  sufficient hardware capacity is not available.
 
  The following data shows some sampled statistics for this SQL from the past
  week and projected weekly values when parallel execution is enabled.
 
                                 Past week sampled statistics for this SQL
                                 -----------------------------------------
  Number of executions                                                   0
  Percent of total activity                                            .29
  Percent of samples with #Active Sessions &gt; 2*CPU                       0
  Weekly DB time (in sec)                                            76.51
 
                              Projected statistics with Parallel Execution
                              --------------------------------------------
  Weekly DB time (in sec)                                            95.21</code></pre></div>
                        <!-- class="example" -->
                     </div>
                     <div>
                        <div class="infoboxnotealso" id="GUID-943DA3BA-BD26-40F8-863E-B5C5AD113969__GUID-0C26CC17-0F63-4134-8FEE-B6B11BE6D9E8">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><span class="q">"<a href="sql-tuning-advisor.html#GUID-93AEDB23-107C-4357-8D7E-2BDE3D1893DF" title="SQL profiling is the verification by the Automatic Tuning Optimizer of its own estimates.">SQL Profiling</a>"</span></p>
                              </li>
                              <li>
                                 <p><a href="../vldbg/degree-parallel.html#VLDBG0103" target="_blank"><span><cite>Oracle Database VLDB and Partitioning Guide</cite></span></a> to learn more about Auto DOP
                                 </p>
                              </li>
                              <li>
                                 <p><a href="../arpls/DBMS_SQLTUNE.html#ARPLS68398" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> to learn about the <code class="codeph">DBMS_SQLTUNE.ACCEPT_SQL_PROFILE</code> procedure
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="managing-sql-profiles.html#GUID-41377192-7E26-47E2-9D36-6BAD85ED1367" title="A SQL profile is a collection of auxiliary statistics on a query, including all tables and columns referenced in the query.">Concepts for SQL Profiles</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="TGSQL603"></a><div class="props_rev_3"><a id="GUID-D930A2C3-8769-46FB-9B60-E363B98013F6" name="GUID-D930A2C3-8769-46FB-9B60-E363B98013F6"></a><h5 id="TGSQL-GUID-D930A2C3-8769-46FB-9B60-E363B98013F6" class="sect5"><span class="enumeration_section">26.1.2.4 </span>SQL Profiles and SQL Plan Baselines
                     </h5>
                     <div>
                        <p>You can use SQL profiles with or without SQL plan management.</p>
                        <p>No strict relationship exists between the SQL profile and a SQL plan baseline. If a statement has multiple plans in a SQL plan baseline, then a SQL profile is useful because it enables the optimizer to choose the lowest-cost plan in the baseline.</p>
                     </div>
                     <div>
                        <div class="infoboxnotealso" id="GUID-D930A2C3-8769-46FB-9B60-E363B98013F6__GUID-23A76F4E-C141-45F5-91E4-AF6240842CD6">
                           <p class="notep1">See Also:</p>
                           <p><span class="q">"<a href="overview-of-sql-plan-management.html#GUID-F1C45056-F998-43E5-B362-83F88DA49E58" title="SQL plan management is a preventative mechanism that enables the optimizer to automatically manage execution plans, ensuring that the database uses only known or verified plans.">Overview of SQL Plan Management</a>"</span></p>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="managing-sql-profiles.html#GUID-41377192-7E26-47E2-9D36-6BAD85ED1367" title="A SQL profile is a collection of auxiliary statistics on a query, including all tables and columns referenced in the query.">Concepts for SQL Profiles</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div><a id="TGSQL604"></a><div class="props_rev_3"><a id="GUID-280110BE-2D94-4174-BA28-8FD731DF6F20" name="GUID-280110BE-2D94-4174-BA28-8FD731DF6F20"></a><h4 id="TGSQL-GUID-280110BE-2D94-4174-BA28-8FD731DF6F20" class="sect4"><span class="enumeration_section">26.1.3 </span>User Interfaces for SQL Profiles
                  </h4>
                  <div>
                     <p>Oracle Enterprise Manager Cloud Control (Cloud Control) usually handles SQL profiles as part of automatic SQL tuning.</p>
                     <div class="section">
                        <p>On the command line, you can manage SQL profiles with the <code class="codeph">DBMS_SQLTUNE</code> package. To use the APIs, you must have the <code class="codeph">ADMINISTER SQL MANAGEMENT OBJECT</code> privilege.
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-280110BE-2D94-4174-BA28-8FD731DF6F20__GUID-2FB91677-BFC0-41B3-9BD5-1A3D0D3BE0BE">
                        <p class="notep1">See Also:</p>
                        <p></p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="../arpls/DBMS_SQLTUNE.html#ARPLS220" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> for information about the <code class="codeph">DBMS_SQLTUNE</code> package
                              </p>
                           </li>
                           <li>
                              <p><a href="../tdppt/tuning-sql-statements.html#TDPPT163" target="_blank"><span><cite>Oracle Database 2 Day + Performance Tuning Guide</cite></span></a> to learn how to manage SQL profiles with Cloud Control
                              </p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-sql-profiles.html#GUID-1AC3C45E-331A-4016-8FE8-7FEFFD8D7220" title="A SQL profile is a database object that contains auxiliary statistics specific to a SQL statement.">About SQL Profiles</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TGSQL606"></a><a id="TGSQL605"></a><div class="props_rev_3"><a id="GUID-93C2D28A-D9D8-43CB-880B-6121E2DEF9E6" name="GUID-93C2D28A-D9D8-43CB-880B-6121E2DEF9E6"></a><h4 id="TGSQL-GUID-93C2D28A-D9D8-43CB-880B-6121E2DEF9E6" class="sect4"><span class="enumeration_section">26.1.4 </span>Basic Tasks for SQL Profiles
                  </h4>
                  <div>
                     <p>Basic tasks include accepting (implementing) a SQL profile, altering it, listing it, and dropping it.</p>
                     <p>The following graphic shows the basic workflow.</p>
                     <div class="figure" id="GUID-93C2D28A-D9D8-43CB-880B-6121E2DEF9E6__BABIJIIH">
                        <p class="titleinfigure">Figure 26-2 Managing SQL Profiles</p><img src="img/tgsql_vm_027.png" alt="Description of Figure 26-2 follows" title="Description of Figure 26-2 follows" longdesc="img_text/tgsql_vm_027.html"><br><a href="img_text/tgsql_vm_027.html">Description of "Figure 26-2 Managing SQL Profiles"</a></div>
                     <!-- class="figure" -->
                     <p>Typically, you manage SQL profiles in the following sequence:</p>
                     <ol>
                        <li>
                           <p>Implement a recommended SQL profile.</p>
                           <p><span class="q">"<a href="managing-sql-profiles.html#GUID-350D0B3C-881D-4841-A8E8-C5EAF68AFB40" title="Implementing a SQL profile means storing it persistently in the database.">Implementing a SQL Profile</a>"</span> describes this task.
                           </p>
                        </li>
                        <li>
                           <p>Obtain information about SQL profiles stored in the database.</p>
                           <p><span class="q">"<a href="managing-sql-profiles.html#GUID-A10B0EA8-3215-4F58-9CBF-F23EFF6584EC" title="The data dictionary view DBA_SQL_PROFILES stores SQL profiles persistently in the database.">Listing SQL Profiles</a>"</span> describes this task.
                           </p>
                        </li>
                        <li>
                           <p>Optionally, modify the implemented SQL profile.</p>
                           <p><span class="q">"<a href="managing-sql-profiles.html#GUID-EF674EC7-7C8B-4EDC-A94C-62A4A16BC166" title="You can alter attributes of an existing SQL profile using the attribute_name parameter of the ALTER_SQL_PROFILE procedure.">Altering a SQL Profile</a>"</span> describes this task.
                           </p>
                        </li>
                        <li>
                           <p>Drop the implemented SQL profile when it is no longer needed.</p>
                           <p><span class="q">"<a href="managing-sql-profiles.html#GUID-EE6AA78D-A7BA-4F27-8BE4-FAE4E1C7499C" title="You can drop a SQL profile with the DROP_SQL_PROFILE procedure.">Dropping a SQL Profile</a>"</span> describes this task.
                           </p>
                        </li>
                     </ol>
                     <p>To tune SQL statements on another database, you can transport both a SQL tuning set and a SQL profile to a separate database. <span class="q">"<a href="managing-sql-profiles.html#GUID-147E953C-C6BD-4A4A-BAD6-A269DB72CE9D" title="You can export a SQL profile from the SYS schema in one database to a staging table, and then import it from the staging table into another database. You can transport a SQL profile to any Oracle database created in the same release or later.">Transporting a SQL Profile</a>"</span> describes this task.
                     </p>
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-93C2D28A-D9D8-43CB-880B-6121E2DEF9E6__GUID-AEB3CD39-84F8-47B8-8CB6-B4525BD36CC4">
                        <p class="notep1">See Also:</p>
                        <p><a href="../arpls/DBMS_SQLTUNE.html#ARPLS220" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> for information about the <code class="codeph">DBMS_SQLTUNE</code> package
                        </p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-sql-profiles.html#GUID-1AC3C45E-331A-4016-8FE8-7FEFFD8D7220" title="A SQL profile is a database object that contains auxiliary statistics specific to a SQL statement.">About SQL Profiles</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="TGSQL607"></a><div class="props_rev_3"><a id="GUID-350D0B3C-881D-4841-A8E8-C5EAF68AFB40" name="GUID-350D0B3C-881D-4841-A8E8-C5EAF68AFB40"></a><h3 id="TGSQL-GUID-350D0B3C-881D-4841-A8E8-C5EAF68AFB40" class="sect3"><span class="enumeration_section">26.2 </span>Implementing a SQL Profile
               </h3>
               <div>
                  <p>Implementing a SQL profile means storing it persistently in the database.</p>
                  <p>Implementing a profile is the same as accepting it. A profile must be accepted before the optimizer can use it as input when generating plans.</p>
                  <p>This section contains the following topics:</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="managing-sql-profiles.html#GUID-5EF6DC38-6118-48B4-8162-56E7C4570C1B">About SQL Profile Implementation</a><br>As a rule of thumb, implement a SQL profile recommended by SQL Tuning Advisor. 
                     </li>
                     <li class="ulchildlink"><a href="managing-sql-profiles.html#GUID-B31665FC-A81A-46EE-B04C-39A3AC6C0F47">Implementing a SQL Profile</a><br>To implement a SQL profile, use the <code class="codeph">DBMS_SQLTUNE.ACCEPT_SQL_PROFILE</code> procedure.
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="managing-sql-profiles.html#GUID-C7FE0936-63B8-46EF-A03E-7E59F704606E" title="When warranted, SQL Tuning Advisor recommends a SQL profile. You can use DBMS_SQLTUNE to implement, alter, drop, and transport SQL profiles.">Managing SQL Profiles</a></p>
                     </div>
                  </div>
               </div>
               <a id="TGSQL608"></a><div class="props_rev_3"><a id="GUID-5EF6DC38-6118-48B4-8162-56E7C4570C1B" name="GUID-5EF6DC38-6118-48B4-8162-56E7C4570C1B"></a><h4 id="TGSQL-GUID-5EF6DC38-6118-48B4-8162-56E7C4570C1B" class="sect4"><span class="enumeration_section">26.2.1 </span>About SQL Profile Implementation
                  </h4>
                  <div>
                     <p>As a rule of thumb, implement a SQL profile recommended by SQL Tuning Advisor. </p>
                     <p>If the database recommends both an index and a SQL profile, then either use both or use the SQL profile only. If you create an index, then the optimizer may need the profile to pick the new index.</p>
                     <p>In some situations, SQL Tuning Advisor may find an improved serial plan in addition to an even better parallel plan. In this case, the advisor recommends both a standard and a parallel SQL profile, enabling you to choose between the best serial and best parallel plan for the statement. Implement a parallel plan only if the increase in response time is worth the decrease in throughput.</p>
                     <p>To implement a SQL profile, execute the <code class="codeph">DBMS_SQLTUNE.ACCEPT_SQL_PROFILE</code> procedure. Some important parameters are as follows:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><code class="codeph">profile_type</code></p>
                           <p>Set this parameter to <code class="codeph">REGULAR_PROFILE</code> for a SQL profile without a change to parallel execution, or <code class="codeph">PX_PROFLE</code> for a SQL profile with a change to parallel execution.
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">force_match</code></p>
                           <p>This parameter controls statement matching. Typically, an accepted SQL profile is associated with the SQL statement through a <a href="glossary.html#GUID-160EB64E-536F-4313-B7B0-191C2719CF1F"><span class="xrefglossterm">SQL signature</span></a> that is generated using a hash function. This hash function changes the SQL statement to upper case and removes all extra whitespace before generating the signature. Thus, the same SQL profile works for all SQL statements in which the only difference is case and white spaces.
                           </p>
                           <p>By setting <code class="codeph">force_match</code> to <code class="codeph">true</code>, the SQL profile additionally targets all SQL statements that have the same text after the literal values in the <code class="codeph">WHERE</code> clause have been replaced by bind variables. This setting may be useful for applications that use only literal values because it enables SQL with text differing only in its literal values to share a SQL profile. If both literal values and bind variables are in the SQL text, or if <code class="codeph">force_match</code> is set to <code class="codeph">false</code> (default), then the literal values in the <code class="codeph">WHERE</code> clause are not replaced by bind variables.
                           </p>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-5EF6DC38-6118-48B4-8162-56E7C4570C1B__GUID-E20C9F72-FC97-4C4E-BE01-4D4DB8082F68">
                        <p class="notep1">See Also:</p>
                        <p><a href="../arpls/DBMS_SQLTUNE.html#ARPLS220" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> for information about the <code class="codeph">ACCEPT_SQL_PROFILE</code> procedure
                        </p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-sql-profiles.html#GUID-350D0B3C-881D-4841-A8E8-C5EAF68AFB40" title="Implementing a SQL profile means storing it persistently in the database.">Implementing a SQL Profile</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TGSQL94966"></a><a id="TGSQL609"></a><div class="props_rev_3"><a id="GUID-B31665FC-A81A-46EE-B04C-39A3AC6C0F47" name="GUID-B31665FC-A81A-46EE-B04C-39A3AC6C0F47"></a><h4 id="TGSQL-GUID-B31665FC-A81A-46EE-B04C-39A3AC6C0F47" class="sect4"><span class="enumeration_section">26.2.2 </span>Implementing a SQL Profile
                  </h4>
                  <div>
                     <p>To implement a SQL profile, use the <code class="codeph">DBMS_SQLTUNE.ACCEPT_SQL_PROFILE</code> procedure.
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-B31665FC-A81A-46EE-B04C-39A3AC6C0F47__GUID-0FA549CD-9EF3-4D2F-8300-0E04DD100D90">Assumptions</p>
                        <p>This tutorial assumes the following:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>The SQL Tuning Advisor task <code class="codeph">STA_SPECIFIC_EMP_TASK</code> includes a recommendation to create a SQL profile.
                              </p>
                           </li>
                           <li>
                              <p>The name of the SQL profile is <code class="codeph">my_sql_profile</code>. 
                              </p>
                           </li>
                           <li>
                              <p>The PL/SQL block accepts a profile that uses parallel execution (<code class="codeph">profile_type</code>).
                              </p>
                           </li>
                           <li>
                              <p>The profile uses force matching.</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-B31665FC-A81A-46EE-B04C-39A3AC6C0F47__GUID-EC9A7CE1-CCB9-45C7-B829-DB1CAFEC46C0">To implement a SQL profile:</p>
                        <ol>
                           <li>
                              <p>In SQL*Plus or SQL Developer, log in to the database as a user with the necessary privileges.</p>
                           </li>
                           <li>
                              <p>Execute the <code class="codeph">ACCEPT_SQL_PROFILE</code> function.
                              </p>
                              <p>For example, execute the following PL/SQL:</p><pre class="pre codeblock"><code>DECLARE
  my_sqlprofile_name VARCHAR2(30);
BEGIN
  my_sqlprofile_name := DBMS_SQLTUNE.ACCEPT_SQL_PROFILE ( 
    task_name    =&gt; 'STA_SPECIFIC_EMP_TASK'
,   name         =&gt; 'my_sql_profile'
,   profile_type =&gt; DBMS_SQLTUNE.PX_PROFILE
,   force_match  =&gt; true 
);
END;
/</code></pre></li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-B31665FC-A81A-46EE-B04C-39A3AC6C0F47__GUID-87C727FA-76A8-48E3-AE6C-91BDFAE1663F">
                        <p class="notep1">See Also:</p>
                        <p><a href="../arpls/DBMS_SQLTUNE.html#ARPLS68398" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> to learn about the <code class="codeph">DBMS_SQLTUNE.ACCEPT_SQL_PROFILE</code> procedure
                        </p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-sql-profiles.html#GUID-350D0B3C-881D-4841-A8E8-C5EAF68AFB40" title="Implementing a SQL profile means storing it persistently in the database.">Implementing a SQL Profile</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="TGSQL610"></a><div class="props_rev_3"><a id="GUID-A10B0EA8-3215-4F58-9CBF-F23EFF6584EC" name="GUID-A10B0EA8-3215-4F58-9CBF-F23EFF6584EC"></a><h3 id="TGSQL-GUID-A10B0EA8-3215-4F58-9CBF-F23EFF6584EC" class="sect3"><span class="enumeration_section">26.3 </span>Listing SQL Profiles
               </h3>
               <div>
                  <p>The data dictionary view <code class="codeph">DBA_SQL_PROFILES</code> stores SQL profiles persistently in the database. 
                  </p>
                  <div class="section">
                     <p>The profile statistics are in an Oracle Database internal format, so you cannot query profiles directly. However, you can list profiles.</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-A10B0EA8-3215-4F58-9CBF-F23EFF6584EC__GUID-CA454002-646B-4325-99AB-D06EC70EE8E8">To list SQL profiles:</p>
                     <ol>
                        <li>
                           <p>In SQL*Plus or SQL Developer, log in to the database as a user with the necessary privileges.</p>
                        </li>
                        <li>
                           <p>Query the <code class="codeph">DBA_SQL_PROFILES</code> view.
                           </p>
                           <p>For example, execute the following query:</p><pre class="pre codeblock"><code>COLUMN category FORMAT a10
COLUMN sql_text FORMAT a20

SELECT NAME, SQL_TEXT, CATEGORY, STATUS
FROM   DBA_SQL_PROFILES;
</code></pre><p>Sample output appears below:</p><pre class="pre codeblock"><code>NAME                           SQL_TEXT             CATEGORY   STATUS
------------------------------ -------------------- ---------- --------
SYS_SQLPROF_01285f6d18eb0000   select promo_name, c DEFAULT    ENABLED
                               ount(*) c from promo
                               tions p, sales s whe
                               re s.promo_id = p.pr
                               omo_id and p.promo_c
                               ategory = 'internet'
                                group by p.promo_na
                               me order by c desc</code></pre></li>
                     </ol>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-A10B0EA8-3215-4F58-9CBF-F23EFF6584EC__GUID-5E637819-C7A8-498B-A988-66EAB4F933C1">
                     <p class="notep1">See Also:</p>
                     <p><a href="../refrn/DBA_SQL_PROFILES.html#REFRN23477" target="_blank"><span class="italic">Oracle Database Reference</span></a> to learn about the <code class="codeph">DBA_SQL_PROFILES</code> view
                     </p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="managing-sql-profiles.html#GUID-C7FE0936-63B8-46EF-A03E-7E59F704606E" title="When warranted, SQL Tuning Advisor recommends a SQL profile. You can use DBMS_SQLTUNE to implement, alter, drop, and transport SQL profiles.">Managing SQL Profiles</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="TGSQL611"></a><div class="props_rev_3"><a id="GUID-EF674EC7-7C8B-4EDC-A94C-62A4A16BC166" name="GUID-EF674EC7-7C8B-4EDC-A94C-62A4A16BC166"></a><h3 id="TGSQL-GUID-EF674EC7-7C8B-4EDC-A94C-62A4A16BC166" class="sect3"><span class="enumeration_section">26.4 </span>Altering a SQL Profile
               </h3>
               <div>
                  <p>You can alter attributes of an existing SQL profile using the <code class="codeph">attribute_name</code> parameter of the <code class="codeph">ALTER_SQL_PROFILE</code> procedure.
                  </p>
                  <div class="section">
                     <p>The <code class="codeph">CATEGORY</code> attribute determines which sessions can apply a profile. View the <code class="codeph">CATEGORY</code> attribute by querying <code class="codeph">DBA_SQL_PROFILES.CATEGORY</code>. By default, all profiles are in the <code class="codeph">DEFAULT</code> category, which means that all sessions in which the <code class="codeph">SQLTUNE_CATEGORY</code> initialization parameter is set to <code class="codeph">DEFAULT</code> can use the profile.
                     </p>
                     <p>By altering the category of a SQL profile, you determine which sessions are affected by profile creation. For example, by setting the category to <code class="codeph">DEV</code>, only sessions in which the <code class="codeph">SQLTUNE_CATEGORY</code> initialization parameter is set to <code class="codeph">DEV</code> can use the profile. Other sessions do not have access to the SQL profile and execution plans for SQL statements are not impacted by the SQL profile. This technique enables you to test a profile in a restricted environment before making it available to other sessions.
                     </p>
                     <p>The example in this section assumes that you want to change the category of the SQL profile so it is used only by sessions with the SQL profile category set to <code class="codeph">TEST</code>, run the SQL statement, and then change the profile category back to <code class="codeph">DEFAULT</code>.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-EF674EC7-7C8B-4EDC-A94C-62A4A16BC166__GUID-F12E76FE-0BB0-43A1-9E88-482FF7CF8653">To alter a SQL profile:</p>
                     <ol>
                        <li>
                           <p>In SQL*Plus or SQL Developer, log in to the database as a user with the necessary privileges.</p>
                        </li>
                        <li>
                           <p>Use the <code class="codeph">ALTER_SQL_PROFILE</code> procedure to set the <code class="codeph">attribute_name</code>.
                           </p>
                           <p>For example, execute the following code to set the attribute <code class="codeph">CATEGORY</code> to <code class="codeph">TEST</code>:
                           </p><pre class="pre codeblock"><code>VARIABLE pname my_sql_profile
BEGIN DBMS_SQLTUNE.ALTER_SQL_PROFILE ( 
   name            =&gt;  :pname
,  attribute_name  =&gt;  'CATEGORY'
,  value           =&gt;  'TEST'      
);
END;
</code></pre></li>
                        <li>
                           <p>Change the initialization parameter setting in the current database session.</p>
                           <p>For example, execute the following SQL:</p><pre class="pre codeblock"><code>ALTER SESSION SET SQLTUNE_CATEGORY = 'TEST';
</code></pre></li>
                        <li>
                           <p>Test the profiled SQL statement.</p>
                        </li>
                        <li>
                           <p>Use the <code class="codeph">ALTER_SQL_PROFILE</code> procedure to set the <code class="codeph">attribute_name</code>.
                           </p>
                           <p>For example, execute the following code to set the attribute <code class="codeph">CATEGORY</code> to <code class="codeph">DEFAULT</code>:
                           </p><pre class="pre codeblock"><code>VARIABLE pname my_sql_profile
BEGIN 
  DBMS_SQLTUNE.ALTER_SQL_PROFILE ( 
     name            =&gt;  :pname
,    attribute_name  =&gt;  'CATEGORY'
,    value           =&gt;  'DEFAULT'   
);
END;</code></pre></li>
                     </ol>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-EF674EC7-7C8B-4EDC-A94C-62A4A16BC166__GUID-D1F7E260-32C6-4490-9B61-E0A2DC0ED8E8">
                     <p class="notep1">See Also:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="../refrn/SQLTUNE_CATEGORY.html#REFRN10257" target="_blank"><span><cite>Oracle Database Reference</cite></span></a> to learn about the <code class="codeph">SQLTUNE_CATEGORY</code> initialization parameter
                           </p>
                        </li>
                        <li>
                           <p><a href="../arpls/DBMS_SQLTUNE.html#ARPLS68402" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> to learn about the <code class="codeph">ALTER_SQL_PROFILE</code> procedure
                           </p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="managing-sql-profiles.html#GUID-C7FE0936-63B8-46EF-A03E-7E59F704606E" title="When warranted, SQL Tuning Advisor recommends a SQL profile. You can use DBMS_SQLTUNE to implement, alter, drop, and transport SQL profiles.">Managing SQL Profiles</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="TGSQL94967"></a><a id="TGSQL612"></a><div class="props_rev_3"><a id="GUID-EE6AA78D-A7BA-4F27-8BE4-FAE4E1C7499C" name="GUID-EE6AA78D-A7BA-4F27-8BE4-FAE4E1C7499C"></a><h3 id="TGSQL-GUID-EE6AA78D-A7BA-4F27-8BE4-FAE4E1C7499C" class="sect3"><span class="enumeration_section">26.5 </span>Dropping a SQL Profile
               </h3>
               <div>
                  <p>You can drop a SQL profile with the <code class="codeph">DROP_SQL_PROFILE</code> procedure. 
                  </p>
                  <div class="section">
                     <p class="subhead2" id="GUID-EE6AA78D-A7BA-4F27-8BE4-FAE4E1C7499C__GUID-E5CF383E-DA3C-4E2B-BD7C-0F1C517A78DB">Assumptions</p>
                     <p>This section assumes the following:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>You want to drop <code class="codeph">my_sql_profile</code>.
                           </p>
                        </li>
                        <li>
                           <p>You want to ignore errors raised if the name does not exist.</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-EE6AA78D-A7BA-4F27-8BE4-FAE4E1C7499C__GUID-FEC0F32F-0625-47BD-B7FB-E3A151850DF6">To drop a SQL profile:</p>
                     <ol>
                        <li>
                           <p>In SQL*Plus or SQL Developer, log in to the database as a user with the necessary privileges.</p>
                        </li>
                        <li>
                           <p>Use the <code class="codeph">DBMS_SQLTUNE.DROP_SQL_PROFILE</code> procedure.
                           </p>
                           <p>The following example drops the profile named <code class="codeph">my_sql_profile</code>:
                           </p><pre class="pre codeblock"><code>BEGIN
  DBMS_SQLTUNE.DROP_SQL_PROFILE ( 
    name =&gt; 'my_sql_profile' 
);
END;
/</code></pre></li>
                     </ol>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-EE6AA78D-A7BA-4F27-8BE4-FAE4E1C7499C__GUID-DDE86E81-C28E-45C1-9EC4-19373633AAF7">
                     <p class="notep1">See Also:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="../arpls/DBMS_SQLTUNE.html#ARPLS68418" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> to learn about the <code class="codeph">DROP_SQL_PROFILE</code> procedure
                           </p>
                        </li>
                        <li>
                           <p><a href="../refrn/SQLTUNE_CATEGORY.html#REFRN10257" target="_blank"><span><cite>Oracle Database Reference</cite></span></a> to learn about the <code class="codeph">SQLTUNE_CATEGORY</code> initialization parameter
                           </p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="managing-sql-profiles.html#GUID-C7FE0936-63B8-46EF-A03E-7E59F704606E" title="When warranted, SQL Tuning Advisor recommends a SQL profile. You can use DBMS_SQLTUNE to implement, alter, drop, and transport SQL profiles.">Managing SQL Profiles</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="TGSQL614"></a><a id="TGSQL94968"></a><a id="TGSQL613"></a><div class="props_rev_3"><a id="GUID-147E953C-C6BD-4A4A-BAD6-A269DB72CE9D" name="GUID-147E953C-C6BD-4A4A-BAD6-A269DB72CE9D"></a><h3 id="TGSQL-GUID-147E953C-C6BD-4A4A-BAD6-A269DB72CE9D" class="sect3"><span class="enumeration_section">26.6 </span>Transporting a SQL Profile
               </h3>
               <div>
                  <p>You can export a SQL profile from the <code class="codeph">SYS</code> schema in one database to a staging table, and then import it from the staging table into another database. You can transport a SQL profile to any Oracle database created in the same release or later.
                  </p>
                  <div class="section">
                     <p><a href="managing-sql-profiles.html#GUID-147E953C-C6BD-4A4A-BAD6-A269DB72CE9D__BABHHJAF" title="SQLTUNE APIs">Table 26-1</a> shows the main procedures and functions for managing SQL profiles.
                     </p>
                     <div class="tblformal" id="GUID-147E953C-C6BD-4A4A-BAD6-A269DB72CE9D__BABHHJAF">
                        <p class="titleintable">Table 26-1 APIs for Transporting SQL Profiles</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="APIs for Transporting SQL Profiles" summary="SQLTUNE APIs" width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" id="d136610e2883">Procedure or Function</th>
                                 <th align="left" valign="bottom" id="d136610e2886">Description</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d136610e2891" headers="d136610e2883 ">
                                    <p><code class="codeph">CREATE_STGTAB_SQLPROF</code></p>
                                 </td>
                                 <td align="left" valign="top" headers="d136610e2891 d136610e2886 ">
                                    <p>Creates the staging table used for copying SQL profiles from one system to another.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d136610e2899" headers="d136610e2883 ">
                                    <p><code class="codeph">PACK_STGTAB_SQLPROF</code></p>
                                 </td>
                                 <td align="left" valign="top" headers="d136610e2899 d136610e2886 ">
                                    <p>Moves profile data out of the <code class="codeph">SYS</code> schema into the staging table.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d136610e2910" headers="d136610e2883 ">
                                    <p><code class="codeph">UNPACK_STGTAB_SQLPROF</code></p>
                                 </td>
                                 <td align="left" valign="top" headers="d136610e2910 d136610e2886 ">
                                    <p>Uses the profile data stored in the staging table to create profiles on this system.</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p>The following graphic shows the basic workflow of transporting SQL profiles.</p>
                     <div class="figure" id="GUID-147E953C-C6BD-4A4A-BAD6-A269DB72CE9D__GUID-834E79B6-7318-48C2-87B2-5B59BF050184">
                        <p class="titleinfigure">Figure 26-3 Transporting SQL Profiles</p><img src="img/tgsql_vm_066.png" alt="Description of Figure 26-3 follows" title="Description of Figure 26-3 follows" longdesc="img_text/tgsql_vm_066.html"><br><a href="img_text/tgsql_vm_066.html">Description of "Figure 26-3 Transporting SQL Profiles"</a></div>
                     <!-- class="figure" -->
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-147E953C-C6BD-4A4A-BAD6-A269DB72CE9D__GUID-C6A16E15-4353-4F21-B9C8-41B8715B1918">Assumptions</p>
                     <p>This tutorial assumes the following:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>You want to transport <code class="codeph">my_profile</code> from a production database to a test database.
                           </p>
                        </li>
                        <li>
                           <p>You want to create the staging table in the <code class="codeph">dba1</code> schema. 
                           </p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-147E953C-C6BD-4A4A-BAD6-A269DB72CE9D__GUID-502E9FC0-096B-4A07-B83F-D05374F773F4">To transport a SQL profile:</p>
                     <ol>
                        <li>
                           <p>Connect SQL*Plus to the database with the appropriate privileges, and then use the <code class="codeph">CREATE_STGTAB_SQLPROF</code> procedure to create a staging table to hold the SQL profiles.
                           </p>
                           <p>The following example creates <code class="codeph">my_staging_table</code> in the <code class="codeph">dba1</code> schema:
                           </p><pre class="pre codeblock"><code>BEGIN
  DBMS_SQLTUNE.CREATE_STGTAB_SQLPROF ( 
    table_name  =&gt; 'my_staging_table'
,   schema_name =&gt; 'dba1' 
);
END;
/
</code></pre></li>
                        <li>
                           <p>Use the <code class="codeph">PACK_STGTAB_SQLPROF</code> procedure to export SQL profiles into the staging table.
                           </p>
                           <p>The following example populates <code class="codeph">dba1.my_staging_table</code> with the SQL profile <code class="codeph">my_profile</code>:
                           </p><pre class="pre codeblock"><code>BEGIN
  DBMS_SQLTUNE.PACK_STGTAB_SQLPROF (  
    profile_name         =&gt; 'my_profile'
,   staging_table_name   =&gt; 'my_staging_table'
,   staging_schema_owner =&gt; 'dba1' 
);
END;
/ 
</code></pre></li>
                        <li>
                           <p>Move the staging table to the database where you plan to unpack the SQL profiles.</p>
                           <p> Move the table using your utility of choice. For example, use Oracle Data Pump or a database link.</p>
                        </li>
                        <li>
                           <p>On the database where you plan to import the SQL profiles, use <code class="codeph">UNPACK_STGTAB_SQLPROF</code> to unpack SQL profiles from the staging table.
                           </p>
                           <p>The following example shows how to unpack SQL profiles in the staging table:</p><pre class="pre codeblock"><code>BEGIN
  DBMS_SQLTUNE.UNPACK_STGTAB_SQLPROF(
     replace            =&gt; true
,    staging_table_name =&gt; 'my_staging_table'
);
END;
/</code></pre></li>
                     </ol>
                  </div>
                  <!-- class="section" -->
                  <div class="section"></div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-147E953C-C6BD-4A4A-BAD6-A269DB72CE9D__GUID-C6966ECF-E518-4AD6-8742-79346FCCC4DA">
                     <p class="notep1">See Also:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tgsql&amp;id=ARPLS220" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> for complete reference information about <code class="codeph">DBMS_SQLTUNE</code></p>
                        </li>
                        <li>
                           <p><a href="../sutil/oracle-data-pump-overview.html#SUTIL100" target="_blank"><span><cite>Oracle Database Utilities</cite></span></a> to learn how to use Oracle Data Pump
                           </p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="managing-sql-profiles.html#GUID-C7FE0936-63B8-46EF-A03E-7E59F704606E" title="When warranted, SQL Tuning Advisor recommends a SQL profile. You can use DBMS_SQLTUNE to implement, alter, drop, and transport SQL profiles.">Managing SQL Profiles</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
         </div>
      </article>
   </body>
</html>