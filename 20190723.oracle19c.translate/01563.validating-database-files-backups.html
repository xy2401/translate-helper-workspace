<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>验证数据库文件和备份</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Backup and Recovery User&#39;s Guide"></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Backup and Recovery User&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="database-backup-and-recovery-users-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-09T05:20:45-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2003, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96241-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="diagnosing-repairing-failures-dra.html" title="Previous" type="text/html"></link>
      <link rel="next" href="rman-complete-database-recovery.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database Backup and Recovery User&#39;s Guide"></meta>
    <meta name="dcterms.isVersionOf" content="BRADV"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="diagnosing-repairing-failures-dra.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="rman-complete-database-recovery.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">备份和恢复用户指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="part-diagnosing-responding-failures.html" property="item" typeof="WebPage"><span property="name">诊断和应对失败</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">验证数据库文件和备份</li>
            </ol>
            <a id="GUID-CC967929-9610-410D-B881-66E71353D84C" name="GUID-CC967929-9610-410D-B881-66E71353D84C"></a><a id="BRADV90063"></a>
            
            <h2 id="BRADV-GUID-CC967929-9610-410D-B881-66E71353D84C" class="sect2"><span class="enumeration_chapter">16</span>验证数据库文件和备份</h2>
         </header>
         <div class="ind">
            <div>
               <p>本章介绍如何检查数据库文件和备份的完整性。本章包含以下主题：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="validating-database-files-backups.html#GUID-B9656BE1-8D1A-47DB-A1CF-4B34EADC22D3" title="验证使您可以检查备份的完整性。">RMAN验证概述</a></p>
                  </li>
                  <li>
                     <p><a href="validating-database-files-backups.html#GUID-044FA44E-2AEF-4BEB-A73D-EF9EA3253415" title="您可以使用VALIDATE命令手动检查数据库文件中的物理和逻辑损坏。">使用VALIDATE命令检查块损坏</a></p>
                  </li>
                  <li>
                     <p><a href="validating-database-files-backups.html#GUID-6BD7EA93-053E-4934-A453-6DA6726D093B" title="您还可以使用BACKUP VALIDATE命令执行验证。">使用BACKUP VALIDATE验证数据库文件</a></p>
                  </li>
                  <li>
                     <p><a href="validating-database-files-backups.html#GUID-18A4B00E-0D9B-410D-8ABB-2AC78DB99AA4" title="你可以运行RESTORE ...VALIDATE以测试RMAN是否可以从备份还原特定文件或文件集。RMAN选择要使用的备份。">在恢复之前验证备份</a></p>
                  </li>
                  <li>
                     <p><a href="validating-database-files-backups.html#GUID-38C5D149-AA48-473F-A69A-58EF4E9F665F" title="RMAN使您可以使用VALIDATE命令验证多租户容器数据库（CDB）和可插拔数据库（PDB）。">验证CDB和PDB</a></p>
                  </li>
               </ul>
            </div><a id="BRADV115"></a><div class="props_rev_3"><a id="GUID-B9656BE1-8D1A-47DB-A1CF-4B34EADC22D3" name="GUID-B9656BE1-8D1A-47DB-A1CF-4B34EADC22D3"></a><h3 id="BRADV-GUID-B9656BE1-8D1A-47DB-A1CF-4B34EADC22D3" class="sect3"><span class="enumeration_section">16.1</span> RMAN验证概述</h3>
               <p>验证使您可以检查备份的完整性。</p><a id="BRADV90064"></a><div class="props_rev_3"><a id="GUID-89FBF3FB-6F07-492C-90EC-A03DE728D6EE" name="GUID-89FBF3FB-6F07-492C-90EC-A03DE728D6EE"></a><h4 id="BRADV-GUID-89FBF3FB-6F07-492C-90EC-A03DE728D6EE" class="sect4"><span class="enumeration_section">16.1.1</span> RMAN验证的目的</h4>
                  <div>
                     <p>RMAN验证的主要目的是检查损坏的块和丢失的文件。您还可以使用RMAN确定是否可以还原备份。</p>
                     <p>您可以使用以下RMAN命令执行验证：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">VALIDATE</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">备份......VALIDATE</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">恢复......VALIDATE</code></p>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-89FBF3FB-6F07-492C-90EC-A03DE728D6EE__GUID-BF4628FC-833B-4F91-8871-94631935AF7B">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>有关<code class="codeph">VALIDATE</code>语法的<a href="../rcmrf/VALIDATE.html#RCMRF162" target="_blank"><span><cite>Oracle数据库备份和恢复参考</cite></span></a></p>
                           </li>
                           <li>
                              <p>用于<code class="codeph">RESTORE ... <a href="../rcmrf/RESTORE.html#RCMRF149" target="_blank"><span><cite>Oracle数据库备份和恢复参考</cite></span></a> <code class="codeph">RESTORE ...VALIDATE</code>语法</p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="BRADV90065"></a><div class="props_rev_3"><a id="GUID-BADB95CC-6C69-4B8B-B665-4A5A79B686B1" name="GUID-BADB95CC-6C69-4B8B-B665-4A5A79B686B1"></a><h4 id="BRADV-GUID-BADB95CC-6C69-4B8B-B665-4A5A79B686B1" class="sect4"><span class="enumeration_section">16.1.2</span> RMAN验证的基本概念</h4>
                  <div>
                     <p>数据库可防止导致无法使用的备份文件或损坏的已还原数据文件的操作。</p>
                     <p>数据库自动执行以下操作：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>在恢复或恢复数据文件时阻止访问它们</p>
                        </li>
                        <li>
                           <p>每次只允许每个数据文件执行一次还原操作</p>
                        </li>
                        <li>
                           <p>确保以正确的顺序应用增量备份</p>
                        </li>
                        <li>
                           <p>在备份文件中存储信息以允许检测损坏</p>
                        </li>
                        <li>
                           <p>每次读取或写入时检查一个块，以便在检测到损坏后立即报告</p>
                        </li>
                     </ul>
                  </div><a id="BRADV89566"></a><div class="props_rev_3"><a id="GUID-AC61DB02-C1ED-4132-B404-E4282B88AD7C" name="GUID-AC61DB02-C1ED-4132-B404-E4282B88AD7C"></a><h5 id="BRADV-GUID-AC61DB02-C1ED-4132-B404-E4282B88AD7C" class="sect5"><span class="enumeration_section">16.1.2.1</span>关于校验和和损坏的块</h5>
                     <div>
                        <p>损坏的块是一个已更改的块，因此它与Oracle数据库期望找到的块不同。</p>
                        <p>块损坏可能由几种不同的故障引起，包括但不限于以下内容：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>磁盘和磁盘控制器出现故障</p>
                           </li>
                           <li>
                              <p>记忆力不好</p>
                           </li>
                           <li>
                              <p>Oracle数据库软件缺陷</p>
                           </li>
                        </ul>
                        <p><code class="codeph">DB_BLOCK_CHECKSUM</code>是一个数据库初始化参数，用于控制数据库中块的校验和以及数据库中的联机重做日志文件（而不是备份）的写入。如果<code class="codeph">DB_BLOCK_CHECKSUM</code>是<code class="codeph">typical</code> ，则数据库在正常操作期间计算每个块的校验和，并在将其写入磁盘之前将其存储在块的头中。当数据库稍后从磁盘读取块时，它会重新计算校验和并将其与存储的值进行比较。如果值不匹配，则块已损坏。
                        </p>
                        <p>默认情况下， <code class="codeph">BACKUP</code>命令计算每个块的校验和并将其存储在备份中。<code class="codeph">BACKUP</code>命令忽略<code class="codeph">DB_BLOCK_CHECKSUM</code>的值，因为此初始化参数适用于数据库中的数据文件，而不是备份。
                        </p>
                     </div>
                  </div><a id="BRADV991"></a><div class="props_rev_3"><a id="GUID-01E155AC-7665-4B81-8C99-DE65EB688C6C" name="GUID-01E155AC-7665-4B81-8C99-DE65EB688C6C"></a><h5 id="BRADV-GUID-01E155AC-7665-4B81-8C99-DE65EB688C6C" class="sect5"><span class="enumeration_section">16.1.2.2</span>关于物理和逻辑块损坏</h5>
                     <div>
                        <p>在物理损坏（也称为媒体损坏）中，数据库根本无法识别块：校验和无效，块包含全零，或块的页眉和页脚不匹配。</p>
                        <div class="infoboxnote" id="GUID-01E155AC-7665-4B81-8C99-DE65EB688C6C__GUID-AE3CF202-AA4C-4E7E-A07F-CE43AB9CDD08">
                           <p class="notep1">注意：</p>
                           <p>默认情况下， <code class="codeph">BACKUP</code>命令计算每个块的校验和并将其存储在备份中。如果指定<code class="codeph">NOCHECKSUM</code>选项，则RMAN在创建备份时不会对块执行校验和。
                           </p>
                        </div>
                        <p>在<a href="glossary.html#GUID-E55A74E5-8AD7-478F-A458-E4CB2E389009"><span class="xrefglossterm">逻辑损坏中</span></a> ，块的内容在逻辑上是不一致的。逻辑损坏的示例包括行段或索引条目的损坏。如果RMAN检测到逻辑损坏，则会将该日志记录在警报日志和服务器会话跟踪文件中。
                        </p>
                        <p>默认情况下，RMAN不检查逻辑损坏。但是，如果在<code class="codeph">BACKUP</code>命令中指定<code class="codeph">CHECK LOGICAL</code> ，则RMAN会测试数据和索引块是否存在逻辑损坏，例如行片段或索引条目的损坏，并将它们记录在<a href="glossary.html#GUID-BDCE90D1-13B7-4D2C-A761-1583A238A247"><span class="xrefglossterm">自动诊断存储库（ADR）</span></a>中的警报日志中。如果在备份或还原文件时使用具有以下配置的RMAN，则它会检测可能检测到的所有类型的块损坏：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>在数据库的初始化参数文件中，设置<code class="codeph">DB_BLOCK_CHECKSUM=typical</code>以便数据库自动计算数据文件校验和（不是用于备份，而是用于数据库使用的数据文件）</p>
                           </li>
                           <li>
                              <p>不要在<code class="codeph">BACKUP</code>命令之前使用<code class="codeph">SET MAXCORRUPT</code>以便RMAN不会容忍任何未标记的块损坏。
                              </p>
                           </li>
                           <li>
                              <p>在<code class="codeph">BACKUP</code>命令， <span class="italic">不</span>指定<code class="codeph">NOCHECKSUM</code>写备份时，这样RMAN计算选项校验</p>
                           </li>
                           <li>
                              <p>在<code class="codeph">BACKUP</code>和<code class="codeph">RESTORE</code>命令中，指定<code class="codeph">CHECK</code> <code class="codeph">LOGICAL</code>选项，以便RMAN检查逻辑和物理损坏</p>
                           </li>
                        </ul>
                     </div>
                  </div><a id="BRADV89567"></a><div class="props_rev_3"><a id="GUID-AB58202A-2674-46A7-937C-12AF482684F1" name="GUID-AB58202A-2674-46A7-937C-12AF482684F1"></a><h5 id="BRADV-GUID-AB58202A-2674-46A7-937C-12AF482684F1" class="sect5"><span class="enumeration_section">16.1.2.3</span>关于RMAN备份中损坏块的限制</h5>
                     <div>
                        <p>您可以使用<code class="codeph">SET MAXCORRUPT</code>命令设置RMAN备份文件中允许的未标记损坏总数。默认值为零，这意味着RMAN不会容忍任何类型的未标记的损坏块。
                        </p>
                        <p>如果在备份期间RMAN遇到未标记的损坏块时超出了<code class="codeph">MAXCORRUPT</code>限制，则RMAN将终止备份。否则，RMAN将新检测到的损坏块写入备份，并使用特殊标头指示该块已标记为已损坏。您可以使用<code class="codeph">VALIDATE</code>命令确定哪些块被标记为已损坏并找到任何未标记的损坏块。
                        </p>
                        <p>因为RMAN允许在备份中标记损坏的块，并且因为可以指示RMAN允许未标记的损坏块在备份中被标记为损坏（当使用<code class="codeph">MAXCORRUPT</code>时），所以可以恢复具有标记为多个块的数据文件腐败。如果备份此恢复的数据文件（假设没有发生新的损坏），即使没有<code class="codeph">MAXCORRUPT</code>设置，备份<code class="codeph">MAXCORRUPT</code>成功。这是因为先前标记的损坏不会阻止RMAN完成备份。
                        </p>
                        <div class="infoboxnotealso" id="GUID-AB58202A-2674-46A7-937C-12AF482684F1__GUID-B399F994-1A8C-4F95-B7A7-8F42AB5F119D">
                           <p class="notep1">也可以看看：</p>
                           <p><code class="codeph">SET MAXCORRUPT</code>语法的<a href="../rcmrf/SET.html#RCMRF153" target="_blank"><span><cite>Oracle数据库备份和恢复参考</cite></span></a></p>
                        </div>
                     </div>
                  </div><a id="BRADV336"></a><a id="BRADV994"></a><div class="props_rev_3"><a id="GUID-C9F93B27-D13F-465D-A32C-CF6B092CE2F0" name="GUID-C9F93B27-D13F-465D-A32C-CF6B092CE2F0"></a><h5 id="BRADV-GUID-C9F93B27-D13F-465D-A32C-CF6B092CE2F0" class="sect5"><span class="enumeration_section">16.1.2.4</span>关于检测块腐败</h5>
                     <div>
                        <p>Oracle数据库支持用于检测，修复和监视块损坏的不同技术。</p>
                        <p>该技术取决于损坏是否是<a href="glossary.html#GUID-8D895C8A-D749-48C1-92A6-A31D5BFCFE4D"><span class="xrefglossterm">块间损坏</span></a>或内部<a href="glossary.html#GUID-F0CE8BEB-71A3-4313-ABEF-244E6C8BCC05"><span class="xrefglossterm">损坏</span></a> 。在intrablock损坏中，损坏发生在块本身内。这种损坏可以是物理的也可以是逻辑的。在块间损坏中，损坏发生在块之间，并且只能是逻辑的。
                        </p>
                        <p>例如， <a href="../refrn/V-DATABASE_BLOCK_CORRUPTION.html#REFRN30048" target="_blank"><code class="codeph">V$DATABASE_BLOCK_CORRUPTION</code></a>视图记录了intrablock corruptions，而<a id="d73958e879" class="indexterm-anchor"></a> <a href="glossary.html#GUID-BDCE90D1-13B7-4D2C-A761-1583A238A247"><span class="xrefglossterm">自动诊断存储库（ADR）</span></a>跟踪所有类型的损坏。<a href="validating-database-files-backups.html#GUID-C9F93B27-D13F-465D-A32C-CF6B092CE2F0__CHDEICIB" title="描述数据库如何处理块损坏。">表16-1</a>总结了数据库如何处理不同类型的块损坏。
                        </p>
                        <div class="tblformalwide" id="GUID-C9F93B27-D13F-465D-A32C-CF6B092CE2F0__CHDEICIB">
                           <p class="titleintable">表16-1块腐败的检测，修复和监控</p>
                           <table cellpadding="4" cellspacing="0" class="FormalWide" title="区块腐败的检测，修复和监控" width="100%" border="1" summary="Describes how the database handles block corruption." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="14%" id="d73958e900">响应</th>
                                    <th align="left" valign="bottom" width="43%" id="d73958e903">内部腐败</th>
                                    <th align="left" valign="bottom" width="43%" id="d73958e906">Interblock腐败</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="14%" id="d73958e911" headers="d73958e900 ">
                                       <p>发现</p>
                                    </td>
                                    <td align="left" valign="top" width="43%" headers="d73958e911 d73958e903 ">
                                       <p>所有数据库实用程序都检测到内部块损坏，包括RMAN（例如， <code class="codeph">BACKUP</code>命令）和DBVERIFY实用程序。如果数据库进程可能遇到<code class="codeph">ORA-1578</code>错误，那么它可以检测到损坏并监视它。
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="43%" headers="d73958e911 d73958e906 ">
                                       <p>只有DBVERIFY和<code class="codeph">ANALYZE</code>语句才能检测到块间损坏。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="14%" id="d73958e930" headers="d73958e900 ">
                                       <p>跟踪</p>
                                    </td>
                                    <td align="left" valign="top" width="43%" headers="d73958e930 d73958e903 ">
                                       <p><code class="codeph">V$DATABASE_BLOCK_CORRUPTION</code>视图显示Oracle数据库组件（如RMAN命令， <code class="codeph">ANALYZE</code> ，SQL查询等）标记为已损坏的块。遇到内部块损坏的任何进程都会在此视图和ADR中记录块损坏。</p>
                                    </td>
                                    <td align="left" valign="top" width="43%" headers="d73958e930 d73958e906 ">
                                       <p>数据库在ADR中监视此类块损坏。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="14%" id="d73958e946" headers="d73958e900 ">
                                       <p>修理</p>
                                    </td>
                                    <td align="left" valign="top" width="43%" headers="d73958e946 d73958e903 ">
                                       <p>修复技术包括<a href="glossary.html#GUID-923A509A-1C36-4EA4-91C8-6E4F372722C0"><span class="xrefglossterm">块介质恢复</span></a> ，恢复数据文件，使用增量备份进行恢复以及阻止新建。阻止介质恢复可以修复物理损坏，但不能修复逻辑损坏。
                                       </p>
                                       <p>修复或检测到块已修复的任何RMAN命令都会更新<code class="codeph">V$DATABASE_BLOCK_CORRUPTION</code> 。例如，RMAN在成功阻止介质恢复结束时更新存储库。如果<code class="codeph">BACKUP</code> ， <code class="codeph">RESTORE</code>或<code class="codeph">VALIDATE</code>命令检测到块不再被破坏，则它会从视图中删除已修复的块。
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="43%" headers="d73958e946 d73958e906 ">
                                       <p>您必须使用手动技术（例如删除对象，重建索引等）来修复块间损坏。</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                        <div class="infoboxnotealso" id="GUID-C9F93B27-D13F-465D-A32C-CF6B092CE2F0__GUID-2850888D-BB01-48E6-818A-33C79E0F4709">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><a href="rman-complete-database-recovery.html#GUID-D908719C-9D46-4084-850C-0F81C25094EB" title="丢失一个或多个数据库文件后，完全恢复会使数据库恢复正常运行。完全恢复正在将数据库恢复到最近的某个时间点，而不会丢失任何已提交的事务。本章中描述的完整恢复操作受特定条件的限制。零数据丢失恢复设备（恢复设备）大大减少了连续归档重做日志备份之间存在的潜在数据丢失窗口。您可以在数据库故障的几个亚之内恢复目标数据库。您必须根据恢复目标以及丢失的数据库文件来规划数据库还原和恢复策略。用于确定哪些文件需要还原或恢复的技术取决于丢失的文件类型。当任何多路复用控制文件变得不可访问时，数据库立即关闭。关于何时以及如何恢复的决定取决于数据库的状态和数据文件的位置。确定缺少哪些数据文件的简单方法是运行VALIDATE DATABASE命令。尽管VALIDATE DATABASE是确定文件是否不可访问的好方法，但您可能希望使用SQL查询来获取更详细的信息。建议您记录数据库的DBID。预览备份可帮助您确保还原和恢复操作所需的所有备份都可用。异地备份存储在远程位置，例如安全存储设施，除非媒体管理器检索媒体，否则无法恢复。验证备份可确定备份是否可用。RMAN会根据需要自动从备份还原存档的重做日志文件以执行恢复。RMAN使您可以覆盖已还原的归档重做日志文件的默认位置。要管理用于包含已还原日志的磁盘空间，可以在一个RUN块中多次指定已归档日志的还原目标，以在多个目标之间分配已还原的日志。对于使用某些技术加密的备份，您必须提供用于解密这些备份的密码。在完全恢复期间，RMAN将还原一个或多个数据文件，然后应用还原备份后生成的所有重做。您使用RESTORE和RECOVER命令来还原和恢复数据库。如果无法将数据文件还原到其默认位置，则必须更新控制文件以反映数据文件的新位置。此方案假定数据库trgt已丢失其大部分或全部数据文件。它还假定数据库使用快速恢复区域。使用带有TABLESPACE选项的RESTORE和RECOVER命令执行表空间的完全恢复您可以通过切换到无法访问的数据文件的映像副本来恢复数据库。这种技术比传统的恢复和恢复花费的时间更少，因为不需要恢复备份。当一个或多个数据文件损坏时，您可以通过切换到损坏的数据文件的现有映像副本来执行恢复。您可以通过切换到损坏的数据文件的映像副本而不是还原这些数据文件来执行完整的数据库恢复。RMAN和Oracle Enterprise Manager云控制（云控制）为多租户环境中的备份和恢复提供全面支持。恢复整个CDB时，可以在单个操作中恢复根和所有PDB。如果发生仅影响根的数据损坏或用户错误，您可以考虑仅恢复根。您可以执行一个或多个PDB的完全恢复，而不会影响其他打开的PDB的操作。企业管理器云控制（云控制）提供了恢复PDB的界面。使用RECOVER命令使用预包装备份执行完全恢复。预打印备份用于在PDB插入当前CDB之前的某个时间将PDB恢复并恢复到其状态。 RMAN使用预包装备份执行PDB的完全恢复。在将PDB迁移到当前目标CDB之前，在源非CDB或源CDB上创建了这些预制备份备份。此示例使用预刷新备份执行目标CDB prod_cdb中PDB my_pdb的完全恢复。由于不同PDB中的表空间可以具有相同的名称，以消除歧义，因此必须直接连接到PDB以恢复其一个或多个表空间。相反，由于数据文件编号和路径在整个CDB中是唯一的，因此您可以在恢复PDB数据文件时连接到根或PDB。Oracle企业管理器云控制（云控制）提供了一个用于恢复PDB中的表空间的界面。通过切换到副本来恢复CDB比传统的恢复和恢复更快。RMAN使您可以使用RESTORE和RECOVER命令执行应用程序容器的完全恢复，而不会影响CDB中的其他容器。使用RESTORE和RECOVER命令执行应用程序根目录的完全恢复。您可以执行应用程序容器的完全恢复，其中包括应用程序根目录及其所有应用程序PDB，而不会影响CDB中的其他PDB。使用RESTORE和RECOVER命令执行一个或多个应用程序PDB的完全恢复。您可以使用RESTORE和RECOVER命令将稀疏数据库恢复到最近的时间点。执行包含稀疏数据文件的数据库的恢复与执行整个数据库的恢复非常相似。执行稀疏CDB的恢复与执行稀疏数据库的完全恢复非常相似。在根级别或CDB级别连接时，可以恢复稀疏PDB。">执行完整的数据库恢复</a></p>
                              </li>
                              <li>
                                 <p><a href="rman-block-media-recovery.html#GUID-1E226393-17D0-4AB0-A05D-91210255D8FF" title="阻止介质恢复恢复通过恢复损坏的数据块提供较低的平均恢复时间（MTTR）。使用块介质恢复来恢复数据文件中的一个或多个损坏的数据块。通常，数据库将块标记为介质损坏，然后在首次遇到损坏时将其写入磁盘。在块恢复之前，块的后续读取不会成功。您只能对标记为损坏或未通过损坏检查的块执行块恢复。阻止恢复行为取决于是在主数据库还是物理备用数据库上发现数据块损坏。V $ DATABASE_BLOCK_CORRUPTION视图显示由数据库组件（如RMAN，ANALYZE和SQL查询）标记为已损坏的块。阻止介质恢复仅需要对要恢复的块进行不间断的重做更改。这与数据文件恢复不同，它需要从恢复开始到结束时不间断的一系列重做更改。在使用RECOVER执行块介质恢复之前，必须满足某些先决条件...BLOCK命令。使用RECOVER ......BLOCK命令用于恢复数据文件中的各个损坏块。您确定需要恢复的块，然后使用任何可用的备份来还原和恢复这些块。您可以使用Data Recovery Advisor诊断和修复数据块损坏导致的故障。在此示例中，VALIDATE DATABASE命令时发现了损坏的数据块。RMAN可以自动恢复V $ DATABASE_BLOCK_CORRUPTION视图中列出的所有块。">执行块介质恢复</a></p>
                              </li>
                              <li>
                                 <p><a href="../admin/diagnosing-and-resolving-problems.html#ADMIN11257" target="_blank"><span><cite>Oracle数据库管理员指南</cite></span></a> ，了解ADR</p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div>
               </div>
            </div><a id="BRADV337"></a><a id="BRADV613"></a><a id="BRADV338"></a><a id="BRADV89563"></a><div class="props_rev_3"><a id="GUID-044FA44E-2AEF-4BEB-A73D-EF9EA3253415" name="GUID-044FA44E-2AEF-4BEB-A73D-EF9EA3253415"></a><h3 id="BRADV-GUID-044FA44E-2AEF-4BEB-A73D-EF9EA3253415" class="sect3"><span class="enumeration_section">16.2</span>使用VALIDATE命令检查块损坏</h3>
               <div>
                  <p>您可以使用<code class="codeph">VALIDATE</code>命令手动检查数据库文件中的物理和逻辑损坏。
                  </p>
                  <div class="section">
                     <p>此命令执行与<code class="codeph">BACKUP VALIDATE</code>相同类型的检查，但<code class="codeph">VALIDATE</code>可以检查更大的对象选择。例如，您可以使用<code class="codeph">VALIDATE DATAFILE ...验证各个块<code class="codeph">VALIDATE DATAFILE ...BLOCK</code>命令。
                     </p>
                     <p>要指定要验证的备份片的副本号，请运行<code class="codeph">VALIDATE FROM COPY NUMBER</code>命令。
                     </p>
                     <p>验证整个文件时，RMAN会检查输入文件的每个块。如果备份验证发现以前未标记的损坏块，则RMAN会使用描述损坏的行更新<code class="codeph">V$DATABASE_BLOCK_CORRUPTION</code>视图。
                     </p>
                     <p>当您怀疑备份集中的一个或多个备份片段丢失或已损坏时，请使用<code class="codeph">VALIDATE BACKUPSET</code> 。此命令检查备份集中的每个块，以确保可以还原备份。如果RMAN发现块损坏，则会发出错误并终止验证。命令<code class="codeph">VALIDATE BACKUPSET</code>使您可以选择要检查的备份，而<code class="codeph">RESTORE</code>命令的<code class="codeph">VALIDATE</code>选项允许RMAN选择。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-044FA44E-2AEF-4BEB-A73D-EF9EA3253415__GUID-64F9EA34-AF9A-4976-8D29-9E5FABF9DB02">要使用VALIDATE检查数据库文件和备份：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ol>
                        <li>
                           <p>启动RMAN并连接到目标数据库。</p>
                           <div class="infoboxnotealso" id="GUID-044FA44E-2AEF-4BEB-A73D-EF9EA3253415__GUID-5425CB18-E8EB-4A55-82EB-8E27F1642EAC">
                              <p class="notep1">也可以看看：</p>
                              <p><span class="q">“ <a href="starting-interacting-with-rman-client.html#GUID-E07231B2-F213-4F8F-8D02-E410A6DAE94C" title="您可以从RMAN客户端或操作系统命令行创建数据库连接。可以使用密码文件或操作系统身份验证对这些数据库连接进行身份验证。">使用RMAN建立数据库连接</a> ”</span></p>
                           </div>
                        </li>
                        <li>
                           <p>使用所需选项执行<code class="codeph">VALIDATE</code>命令。
                           </p>
                           <p>例如，要验证所有数据文件和控制文件（以及服务器参数文件（如果正在使用）），请在RMAN提示符处执行以下命令：</p><pre class="pre codeblock"><code>RMAN&gt;验证数据库;</code></pre><p>或者，您可以使用以下示例中显示的命令的形式验证特定备份集（包括示例输出）。</p><pre class="pre codeblock"><code>RMAN&gt; VALIDATE BACKUPSET 22;使用通道ORA_DISK_1分配的通道在17-AUG-13开始验证：ORA_SBT_TAPE_1通道ORA_SBT_TAPE_1：SID = 89设备类型= SBT_TAPE通道ORA_SBT_TAPE_1：Oracle安全备份通道ORA_DISK_1：开始验证数据文件备份集通道ORA_DISK_1：从备份片/ disk1 /读取oracle / work / orcva / RDBMS / backupset / 2013_08_16 / o1_mf_nnndf_ TAG20130816T153034_2g774bt2_.bkp频道ORA_DISK_1：piece handle = / disk1 / oracle / work / orcva / RDBMS / backupset / 2013_08_16 / o1_mf_nnndf_ TAG20130816T153034_2g774bt2_.bkp tag = TAG20130816T153034频道ORA_DISK_1：恢复后备片1个通道ORA_DISK_1：验证完成，已用时间：00：00：01在17-AUG-13完成验证</code></pre><p>以下示例说明了如何检查数据文件中的各个数据块是否存在损坏。</p><pre class="pre codeblock"><code>RMAN&gt;验证数据文件1块10;使用通道ORA_DISK_1通道ORA_DISK_1在17-AUG-13开始验证：开始验证数据文件通道ORA_DISK_1：指定验证输入数据文件的数据文件文件号= 00001名称= / disk1 / oracle / dbs / tbs_01.f通道ORA_DISK_1：验证完成，经过时间：00：00：01数据文件列表=================文件状态标记损坏空块阻止检查高SCN ---- ------ -------------- ------------ --------------- --------- -  1 OK 0 2 127 481907文件名：/disk1/oracle/dbs/tbs_01.f块类型块处理失败块---------- -------------- ----------------数据0 36索引0 31其他0 58在17-AUG-13完成验证</code></pre></li>
                     </ol>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-044FA44E-2AEF-4BEB-A73D-EF9EA3253415__CHDDJJAI">
                     <p class="subhead2" id="GUID-044FA44E-2AEF-4BEB-A73D-EF9EA3253415__GUID-5DBB8938-FF83-47B2-8E0E-AF2C6D3E8804">使数据文件的验证并行化</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>如果必须验证大型数据文件，则RMAN可以通过将文件划分为多个部分并并行处理每个<a href="glossary.html#GUID-FDECFF77-1833-4BD3-A23C-AA4806E28241"><span class="xrefglossterm">文件部分</span></a>来使工作并行。如果配置或分配了多个通道，并且您希望通道与验证并行，则指定<code class="codeph">VALIDATE</code>命令的<code class="codeph">SECTION SIZE</code>参数。
                     </p>
                     <p>如果指定的段大小大于文件大小，则RMAN不会创建文件段。如果指定的小部分大小将产生超过256个部分，则RMAN会将部分大小增加到一个导致恰好256个部分的值。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-044FA44E-2AEF-4BEB-A73D-EF9EA3253415__GUID-3C8371AB-2C78-498C-8B28-382F8EFB776B">要使数据文件的验证并行：</p>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>启动RMAN并连接到目标数据库。必须安装或打开目标数据库。</span></li>
                     <li class="stepexpand"><span>使用<code class="codeph">SECTION SIZE</code>参数运行<code class="codeph">VALIDATE</code> 。</span><div>
                           <p>以下示例分配两个通道并验证大型数据文件。部分大小为1200 MB。</p><pre class="pre codeblock"><code>运行{ALLOCATE CHANNEL c1设备类型磁盘; ALLOCATE CHANNEL c2设备类型磁盘;验证数据文件1部分大小1200M; }</code></pre></div>
                     </li>
                  </ol>
                  <div class="section">
                     <div class="infoboxnotealso" id="GUID-044FA44E-2AEF-4BEB-A73D-EF9EA3253415__GUID-DF933C00-C1F8-459A-B8EA-8A76045853FC">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="q">“ <a href="backing-up-database-advanced.html#GUID-F2D9FF2D-9E1C-4D38-AD8E-88B6B32F02B4" title="如果在BACKUP命令上指定SECTION SIZE参数，则RMAN会创建一个备份集，其中每个备份片段包含来自一个文件节的块。">将大型数据文件的备份划分为多个部分</a> ”</span></p>
                           </li>
                           <li>
                              <p><a href="../rcmrf/VALIDATE.html#RCMRF162" target="_blank"><span><cite>Oracle数据库备份和恢复参考</cite></span></a>了解<code class="codeph">VALIDATE</code>命令</p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="BRADV339"></a><a id="BRADV89562"></a><div class="props_rev_3"><a id="GUID-6BD7EA93-053E-4934-A453-6DA6726D093B" name="GUID-6BD7EA93-053E-4934-A453-6DA6726D093B"></a><h3 id="BRADV-GUID-6BD7EA93-053E-4934-A453-6DA6726D093B" class="sect3"><span class="enumeration_section">16.3</span>使用BACKUP VALIDATE验证数据库文件</h3>
               <div>
                  <p>您还可以使用<code class="codeph">BACKUP VALIDATE</code>命令执行验证。
                  </p>
                  <div class="section">
                     <p>此命令可以执行以下任务：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type:disc">
                        <li>
                           <p>检查数据文件是否存在物理和逻辑块损坏</p>
                        </li>
                        <li>
                           <p>确认所有数据库文件都存在且位于正确的位置</p>
                        </li>
                     </ul>
                     <p>当您运行<code class="codeph">BACKUP VALIDATE</code> ，RMAN将完整地读取要备份的文件，就像在实际备份期间一样。但是，RMAN实际上不会生成任何备份集或映像副本。
                     </p>
                     <p>您不能将<code class="codeph">BACKUPSET</code> ， <code class="codeph">MAXCORRUPT</code>或<code class="codeph">PROXY</code>参数与<code class="codeph">BACKUP VALIDATE</code> 。要验证特定的备份集，请运行<code class="codeph">VALIDATE</code>命令。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-6BD7EA93-053E-4934-A453-6DA6726D093B__GUID-CA3A6E88-0E33-42BD-8F8D-17D44A133E61">使用BACKUP VALIDATE命令验证文件：</p>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>启动RMAN并连接到目标数据库和恢复目录（如果使用）。</span></li>
                     <li class="stepexpand"><span>运行<code class="codeph">BACKUP VALIDATE</code>命令。</span><div>
                           <p>例如，您可以通过运行命令来验证是否可以备份所有数据库文件和存档日志，如以下示例所示。此命令仅检查物理损坏。</p><pre class="pre codeblock"><code>BACKUP VALIDATE DATABASE ARCHIVELOG ALL;</code></pre><p>要检查除物理损坏之外的逻辑损坏，请运行上述命令的以下变体：</p><pre class="pre codeblock"><code>BACKUP VALIDATE CHECK LOGICAL DATABASE ARCHIVELOG ALL;</code></pre><p>在前面的示例中，RMAN客户端显示与真正备份文件时相同的输出。如果RMAN无法备份一个或多个文件，则会发出错误消息。例如，RMAN可能会显示类似于以下内容的输出：</p><pre class="pre codeblock"><code>RMAN-00571：============================================== ============= RMAN-00569：===============错误信息堆栈跟踪============== = RMAN-00571：============================================= ============== RMAN-03002：在08/29/2013 14:33:47备份命令失败ORA-19625：错误识别文件/ oracle / oradata / trgt / arch / archive1_6 .dbf ORA-27037：无法获取文件状态SVR4错误：2：没有此类文件或目录附加信息：3</code></pre></div>
                     </li>
                  </ol>
                  <div class="section">
                     <div class="infoboxnotealso" id="GUID-6BD7EA93-053E-4934-A453-6DA6726D093B__GUID-E0DE2F03-0410-4A85-9F5A-A477C28FACCE">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>用于<code class="codeph">BACKUP</code>语法的<a href="../rcmrf/BACKUP.html#RCMRF107" target="_blank"><span><cite>Oracle数据库备份和恢复参考</cite></span></a></p>
                           </li>
                           <li>
                              <p><a href="rman-block-media-recovery.html#GUID-1E226393-17D0-4AB0-A05D-91210255D8FF" title="阻止介质恢复恢复通过恢复损坏的数据块提供较低的平均恢复时间（MTTR）。使用块介质恢复来恢复数据文件中的一个或多个损坏的数据块。通常，数据库将块标记为介质损坏，然后在首次遇到损坏时将其写入磁盘。在块恢复之前，块的后续读取不会成功。您只能对标记为损坏或未通过损坏检查的块执行块恢复。阻止恢复行为取决于是在主数据库还是物理备用数据库上发现数据块损坏。V $ DATABASE_BLOCK_CORRUPTION视图显示由数据库组件（如RMAN，ANALYZE和SQL查询）标记为已损坏的块。阻止介质恢复仅需要对要恢复的块进行不间断的重做更改。这与数据文件恢复不同，它需要从恢复开始到结束时不间断的一系列重做更改。在使用RECOVER执行块介质恢复之前，必须满足某些先决条件...BLOCK命令。使用RECOVER ......BLOCK命令用于恢复数据文件中的各个损坏块。您确定需要恢复的块，然后使用任何可用的备份来还原和恢复这些块。您可以使用Data Recovery Advisor诊断和修复数据块损坏导致的故障。在此示例中，VALIDATE DATABASE命令时发现了损坏的数据块。RMAN可以自动恢复V $ DATABASE_BLOCK_CORRUPTION视图中列出的所有块。">执行块介质恢复</a>以了解如何修复<code class="codeph">BACKUP</code> <code class="codeph">VALIDATE</code>发现的损坏块</p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="BRADV340"></a><a id="BRADV8156"></a><div class="props_rev_3"><a id="GUID-18A4B00E-0D9B-410D-8ABB-2AC78DB99AA4" name="GUID-18A4B00E-0D9B-410D-8ABB-2AC78DB99AA4"></a><h3 id="BRADV-GUID-18A4B00E-0D9B-410D-8ABB-2AC78DB99AA4" class="sect3"><span class="enumeration_section">16.4</span>在恢复之前验证备份</h3>
               <div>
                  <p>你可以运行<code class="codeph">RESTORE...VALIDATE</code>以测试RMAN是否可以从备份还原特定文件或文件集。RMAN选择要使用的备份。
                  </p>
                  <div class="section">
                     <p>必须为此命令装入或打开数据库。在验证数据文件的还原时，您不必使数据文件脱机，因为数据文件备份的验证仅读取备份而不影响生产数据文件。</p>
                     <p>验证磁盘或磁带上的文件时，RMAN会读取备份片或映像副本中的所有块。RMAN还验证异地备份。除了RMAN不写输出文件之外，验证与实际还原操作相同。</p>
                     <p>RMAN还允许为要验证的备份片段指定拷贝数。</p>
                     <div class="infoboxnote" id="GUID-18A4B00E-0D9B-410D-8ABB-2AC78DB99AA4__GUID-B4246061-54BF-43AF-8430-0AEFF88084DE">
                        <p class="notep1">注意：</p>
                        <p>作为额外的测试措施，您可以使用<code class="codeph">RECOVER ...执行<a href="glossary.html#GUID-20FF4FE0-3ABD-4773-A857-6CF062C7D028"><span class="xrefglossterm">试用恢复</span></a> <code class="codeph">RECOVER ...TEST</code>命令。试用恢复以类似于正常恢复的方式应用重做，但它仅在内存中，并在试用后回滚其更改。
                        </p>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-18A4B00E-0D9B-410D-8ABB-2AC78DB99AA4__GUID-F245DEF5-220C-4CEB-891C-CAE458E3B5D7">使用RESTORE命令验证备份：</p>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>使用<code class="codeph">VALIDATE</code>选项运行<code class="codeph">RESTORE</code>命令。</span><div>
                           <p>以下示例说明了验证数据库和所有归档重做日志的还原：</p><pre class="pre codeblock"><code>RESTORE DATABASE VALIDATE; RESTORE ARCHIVELOG ALL VALIDATE;</code></pre><p>如果<span class="italic">没有</span>看到RMAN错误堆栈，请跳过后续步骤。缺少错误消息意味着RMAN已确认它可以在实际还原和恢复期间成功使用这些备份。
                           </p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>如果您在输出中看到错误消息和<code class="codeph">RMAN-06026</code>消息，请调查问题的原因。如果可能，请更正阻止RMAN验证备份并重试验证的问题。</span><div>
                           <p>以下错误表示RMAN无法从可用备份还原一个或多个指定文件：</p><pre class="oac_no_warn" dir="ltr">RMAN-06026：未找到某些目标 - 中止恢复</pre><p>以下示例输出显示RMAN在读取指定备份时遇到问题：</p><pre class="oac_no_warn" dir="ltr">RMAN-03009：在12-DEC-12 23:22:30 ORA-19505的c1通道上恢复命令失败：无法识别文件“oracle / dbs / 1fafv9gl_1_1”ORA-27037：无法获取文件状态SVR4错误：2 ：没有这样的文件或目录附加信息：3</pre></div>
                     </li>
                  </ol>
                  <div class="section">
                     <div class="infoboxnotealso" id="GUID-18A4B00E-0D9B-410D-8ABB-2AC78DB99AA4__GUID-74D0C130-60D7-4280-B4C9-54FD839256EF">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="../rcmrf/RESTORE.html#RCMRF149" target="_blank"><span><cite>Oracle数据库备份和恢复参考</cite></span></a>以了解<code class="codeph">RESTORE...VALIDATE</code>命令</p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="BRADV635"></a><div class="props_rev_3"><a id="GUID-38C5D149-AA48-473F-A69A-58EF4E9F665F" name="GUID-38C5D149-AA48-473F-A69A-58EF4E9F665F"></a><h3 id="BRADV-GUID-38C5D149-AA48-473F-A69A-58EF4E9F665F" class="sect3"><span class="enumeration_section">16.5</span>验证CDB和PDB</h3>
               <div>
                  <p>RMAN使您可以使用<code class="codeph">VALIDATE</code>命令验证多租户容器数据库（CDB）和可插拔数据库（PDB）。
                  </p>
                  <p>您还可以选择为要为CDB和PDB验证的备份片段指定副本号。</p>
                  <p>本章中的所有过程均适用于CDB，以下各节中描述了不同之处：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="validating-database-files-backups.html#GUID-3875BD93-150E-410B-B5B5-0AB4D1061759" title="验证CDB的步骤与用于验证非CDB的步骤类似。">验证整个CDB</a></p>
                     </li>
                     <li>
                        <p><a href="validating-database-files-backups.html#GUID-83212DB5-4D0F-4EC0-950C-985FC053263E" title="有多种方法可以验证PDB。">验证PDB</a></p>
                     </li>
                  </ul>
               </div><a id="BRADV744"></a><div class="props_rev_3"><a id="GUID-3875BD93-150E-410B-B5B5-0AB4D1061759" name="GUID-3875BD93-150E-410B-B5B5-0AB4D1061759"></a><h4 id="BRADV-GUID-3875BD93-150E-410B-B5B5-0AB4D1061759" class="sect4"><span class="enumeration_section">16.5.1</span>验证整个CDB</h4>
                  <div>
                     <p>验证CDB的步骤与用于验证非CDB的步骤类似。</p>
                     <div class="section">
                        <p>唯一的区别是您必须以具有公共<code class="codeph">SYSBACKUP</code>或<code class="codeph">SYSDBA</code>权限的<a href="glossary.html#GUID-2B102186-15BD-443C-B375-8CB0D442CF5F"><span class="xrefglossterm">公共用户</span></a>身份连接到<a href="glossary.html#GUID-EA3DB8F4-F68E-4FC5-A599-32A4886FFF8A"><span class="xrefglossterm">根</span></a> 。然后，使用<code class="codeph">VALIDATE DATABASE</code>和<code class="codeph">RESTORE DATABASE VALIDATE</code>命令。
                        </p>
                        <div class="infoboxnotealso" id="GUID-3875BD93-150E-410B-B5B5-0AB4D1061759__GUID-5F233E57-1CD3-43A6-B139-F855D0B048D0">
                           <p class="notep1">也可以看看：</p>
                           <p><span class="q">“ <a href="starting-interacting-with-rman-client.html#GUID-B397ADD8-D9CF-4DDA-B6AC-8C5FF04447AD" title="您可以将RMAN客户端连接到多租户容器数据库（CDB）和可插拔数据库（PDB）。">与CDB建立RMAN连接</a> ”</span></p>
                        </div>
                        <p>连接到root时，以下命令验证整个CDB：</p><pre class="pre codeblock"><code>验证数据库;</code></pre><p>以下命令验证root：</p><pre class="pre codeblock"><code>确认数据库根;</code></pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="BRADV745"></a><div class="props_rev_3"><a id="GUID-83212DB5-4D0F-4EC0-950C-985FC053263E" name="GUID-83212DB5-4D0F-4EC0-950C-985FC053263E"></a><h4 id="BRADV-GUID-83212DB5-4D0F-4EC0-950C-985FC053263E" class="sect4"><span class="enumeration_section">16.5.2</span>验证PDB</h4>
                  <div>
                     <p>有多种方法可以验证PDB。</p>
                     <div class="section">
                        <p>使用以下技术之一来验证PDB：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p>连接到root并使用<code class="codeph">VALIDATE PLUGGABLE DATABASE</code>或<code class="codeph">RESTORE PLUGGABLE DATABASE VALIDATE</code>命令。这使您可以验证一个或多个PDB。
                              </p>
                              <p>以下命令连接到根时验证PDB <code class="codeph">hr_pdb</code>和<code class="codeph">sales_pdb</code> 。
                              </p><pre class="oac_no_warn" dir="ltr">VALIDATE PLUGGABLE DATABASE hr_pdb，sales_pdb;</pre></li>
                           <li>
                              <p>连接到PDB并使用<code class="codeph">VALIDATE DATABASE</code>和<code class="codeph">RESTORE DATABASE VALIDATE</code>命令仅验证一个PDB。此处使用的命令与您用于非CDB的命令相同。</p>
                              <p>连接到PDB时，以下命令验证数据库的还原。</p><pre class="oac_no_warn" dir="ltr">RESTORE DATABASE VALIDATE;</pre></li>
                        </ul>
                        <div class="infoboxnotealso" id="GUID-83212DB5-4D0F-4EC0-950C-985FC053263E__GUID-4A45786F-3945-440E-80EC-A6889A183F4D">
                           <p class="notep1">也可以看看：</p>
                           <p><span class="q">“ <a href="starting-interacting-with-rman-client.html#GUID-B397ADD8-D9CF-4DDA-B6AC-8C5FF04447AD" title="您可以将RMAN客户端连接到多租户容器数据库（CDB）和可插拔数据库（PDB）。">与CDB建立RMAN连接</a> ”</span></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>