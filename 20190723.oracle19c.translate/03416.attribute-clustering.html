<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>属性聚类</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Data Warehousing Guide"></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Data Warehousing Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="database-data-warehousing-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-09T00:20:13-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2001, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96243-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="advanced-query-rewrite-materialized-views.html" title="Previous" type="text/html"></link>
      <link rel="next" href="using-zone-maps.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database Data Warehousing Guide"></meta>
    <meta name="dcterms.isVersionOf" content="DWHSG"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="advanced-query-rewrite-materialized-views.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="using-zone-maps.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">数据仓库指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="part-optimizing-dw.html" property="item" typeof="WebPage"><span property="name">优化数据仓库</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">属性聚类</li>
            </ol>
            <a id="GUID-7B007A3C-53C2-4437-9E71-9ECECF8B4FAB" name="GUID-7B007A3C-53C2-4437-9E71-9ECECF8B4FAB"></a>
            
            <h2 id="DWHSG-GUID-7B007A3C-53C2-4437-9E71-9ECECF8B4FAB" class="sect2"><span class="enumeration_chapter">13</span>属性聚类</h2>
         </header>
         <div class="ind">
            <div>
               <p>属性聚类是一种表级指令，它根据某些列的内容对物理接近的数据进行聚类。将逻辑上属于数据的数据存储在物理上接近的位置可以大大减少要处理的数据量，并可以提高工作负载中某些查询的性能。</p>
               <p>本章包括以下部分：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="attribute-clustering.html#GUID-08788616-8D61-4550-9871-301503557E60">关于属性聚类</a></p>
                  </li>
                  <li>
                     <p><a href="attribute-clustering.html#GUID-B38DC1A3-3236-4741-BC33-613FE6B59C4F">属性聚类操作</a></p>
                  </li>
                  <li>
                     <p><a href="attribute-clustering.html#GUID-BA91F630-389F-417D-A07C-D53A57D80F61">查看属性聚类信息</a></p>
                  </li>
               </ul>
            </div><a id="DWHSG8917"></a><div class="props_rev_3"><a id="GUID-08788616-8D61-4550-9871-301503557E60" name="GUID-08788616-8D61-4550-9871-301503557E60"></a><h3 id="DWHSG-GUID-08788616-8D61-4550-9871-301503557E60" class="sect3"><span class="enumeration_section">13.1</span>关于属性聚类</h3>
               <div>
                  <p>attri bute-clustered表根据表中某些列的值或其他表中的一组列，以有序的方式将数据存储在磁盘上。
                  </p>
                  <p>您可以根据指定列的线性顺序进行聚类，也可以使用允许多维聚类的函数（也称为交错聚类）进行聚类。属性群集可提高区域映射，Exadata存储索引和内存中最小/最大修剪的有效性。限定群集列的查询将仅访问群集区域。在分区表上定义属性群集时，群集适用于所有分区。</p>
                  <p>属性聚类是表的指令属性。它不会针对每个DML操作强制执行，而只会影响直接路径插入操作，数据移动或表创建。表上的常规DML操作不受属性聚类的影响。这意味着无论对数据进行聚类所做的任何操作都只是对当前工作数据集进行的操作。这与手动应用的<code class="codeph">ORDER</code> <code class="codeph">BY</code>命令形成对比，例如作为CTAS操作的一部分发生的命令。
                  </p>
                  <p>本节包含以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="attribute-clustering.html#GUID-0655904B-79FF-409C-9AD9-C05F5E1010E1">聚类数据的方法</a></p>
                     </li>
                     <li>
                        <p><a href="attribute-clustering.html#GUID-CD788885-2FD1-460B-9844-4035CF76CDCE">属性聚类的类型</a></p>
                     </li>
                     <li>
                        <p><a href="attribute-clustering.html#GUID-CFA30358-183D-4770-9A79-C6720BF9D753">示例：属性群集表</a></p>
                     </li>
                     <li>
                        <p><a href="attribute-clustering.html#GUID-0314F65B-3015-4911-92E9-2C4117BC9579">使用属性聚类的指南</a></p>
                     </li>
                     <li>
                        <p><a href="attribute-clustering.html#GUID-739B232C-969C-4506-AA12-6B52D6F20D70">属性聚簇表的优点</a></p>
                     </li>
                     <li>
                        <p><a href="attribute-clustering.html#GUID-6C7C444C-5796-4A43-AE3C-B7A373CC932D">关于为表定义属性聚类</a></p>
                     </li>
                     <li>
                        <p><a href="attribute-clustering.html#GUID-636BB068-94D6-41FA-9FCE-5F3E71A1CF0A">关于指定何时必须执行属性聚类</a></p>
                     </li>
                  </ul>
               </div>
               <div class="props_rev_3"><a id="GUID-0655904B-79FF-409C-9AD9-C05F5E1010E1" name="GUID-0655904B-79FF-409C-9AD9-C05F5E1010E1"></a><h4 id="DWHSG-GUID-0655904B-79FF-409C-9AD9-C05F5E1010E1" class="sect4"><span class="enumeration_section">13.1.1</span>聚类数据的方法</h4>
                  <div>
                     <p>您可以<a id="d53740e129" class="indexterm-anchor"></a>使用以下方法聚类数据：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>基于定义了属性聚类的表的一列或多列进行聚类。</p>
                        </li>
                        <li>
                           <p>基于与定义了属性聚类的表连接的一个或多个列进行聚类。基于连接列的<span class="bold">聚类</span>称为<span class="bold">连接属性聚类</span> 。表应通过主键 - 外键关系连接，但不必强制执行外键。
                           </p>
                           <p>由于星型查询通常限定维层次结构，因此如果事实表基于一个或多个维表的列（属性）进行聚类，则会很有用。使用连接属性群集，您可以将一个或多个维度表与事实表连接，然后按维度层次结构列对事实表数据进行群集。要在一个或多个维表的列上对事实表进行聚类，维表的连接必须位于维表的主键或唯一键上。在星型查询的上下文中加入属性聚类也称为<span class="italic">层次聚类，</span>因为表数据按维层次<span class="italic">结构聚类</span> ，每个层次结构由一个有序的层次列列表组成（例如，构成<code class="codeph">location</code>的<code class="codeph">nation</code> ， <code class="codeph">state</code>和<code class="codeph">city</code>列）层次）。
                           </p>
                           <p><span class="bold">注意：</span>与Oracle Table Clusters相比，join属性聚簇表不会存储来自同一数据库块中的一组表的数据。例如，考虑使用维表<code class="codeph">products</code>连接的属性集群表<code class="codeph">sales</code> 。<code class="codeph">sales</code>表将只包含<code class="codeph">sales</code>表中的行，但行的顺序将基于从<code class="codeph">products</code>表连接的列的值。在数据移动，直接路径插入和CTAS操作期间将执行适当的连接。
                           </p>
                        </li>
                     </ul>
                  </div>
               </div><a id="DWHSG9338"></a><div class="props_rev_3"><a id="GUID-CD788885-2FD1-460B-9844-4035CF76CDCE" name="GUID-CD788885-2FD1-460B-9844-4035CF76CDCE"></a><h4 id="DWHSG-GUID-CD788885-2FD1-460B-9844-4035CF76CDCE" class="sect4"><span class="enumeration_section">13.1.2</span>属性聚类的类型</h4>
                  <div>
                     <p>属性<a id="d53740e202" class="indexterm-anchor"></a><a id="d53740e206" class="indexterm-anchor"></a> clustering是一个用户定义的表指令，它在表中的一列或多列上提供数据聚类。可以在创建或修改表时指定指令。
                     </p>
                     <p>Oracle数据库提供以下类型的属性集群：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="attribute-clustering.html#GUID-F22430E9-5A2E-4128-B91A-63414121BF88">线性排序的属性聚类</a></p>
                        </li>
                        <li>
                           <p><a href="attribute-clustering.html#GUID-C10C10DF-DB77-4F40-B4CA-7F5612DA5CE4">具有交织排序的属性聚类</a></p>
                        </li>
                     </ul>
                     <p>无论使用何种类型的属性聚类，您都可以基于单个表或通过连接多个表（连接属性聚类）来聚类数据。</p>
                  </div><a id="DWHSG9339"></a><div class="props_rev_3"><a id="GUID-F22430E9-5A2E-4128-B91A-63414121BF88" name="GUID-F22430E9-5A2E-4128-B91A-63414121BF88"></a><h5 id="DWHSG-GUID-F22430E9-5A2E-4128-B91A-63414121BF88" class="sect5"><span class="enumeration_section">13.1.2.1</span>带线性排序的属性聚类</h5>
                     <div>
                        <p>线性排序根据指定列的顺序存储数据。这是群集的默认类型。例如，表<code class="codeph">SALES</code>的<code class="codeph">(prod_id, channel_id)</code>列上的线性排序首先按<code class="codeph">prod_id</code>对数据进行排序，然后按<code class="codeph">channel_id</code>对数据进行排序。已排序的数据存储在磁盘上，群集列的数据非常接近。
                        </p>
                        <p>可以在通过主键 - 外键关系连接的单个表或多个表上定义线性排序。</p>
                        <p>使用<code class="codeph">CLUSTERING</code> <code class="codeph">...</code> <code class="codeph">BY</code> <code class="codeph">LINEAR</code> <code class="codeph">ORDER</code>指令，根据指定列的顺序执行属性聚类。
                        </p>
                        <p>基于列的线性排序的属性聚类最适用于以下场景：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>查询在单个表中指定<code class="codeph">CLUSTERING</code>子句中包含的列的前缀</p>
                              <p>例如，如果<code class="codeph">sales</code>查询通常指定客户ID或客户ID和产品ID的组合，那么您可以使用列顺序<code class="codeph">cust_id</code> ， <code class="codeph">prod_id</code>在表中对数据进行集群。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">CLUSTERING</code>子句中使用的列具有可接受的基数级别</p>
                              <p>在<span class="q">“ <a href="attribute-clustering.html#GUID-739B232C-969C-4506-AA12-6B52D6F20D70">属性 - 聚类表的优点</a> ”</span>中描述的场景中可以获得的潜在数据减少与从列上的谓词获得的数据减少成正比地增加。
                              </p>
                           </li>
                        </ul>
                        <p>线性聚类与区域图相结合在I / O减少方面非常有效。</p>
                     </div>
                  </div><a id="DWHSG9340"></a><div class="props_rev_3"><a id="GUID-C10C10DF-DB77-4F40-B4CA-7F5612DA5CE4" name="GUID-C10C10DF-DB77-4F40-B4CA-7F5612DA5CE4"></a><h5 id="DWHSG-GUID-C10C10DF-DB77-4F40-B4CA-7F5612DA5CE4" class="sect5"><span class="enumeration_section">13.1.2.2</span>具有交织排序的属性聚类</h5>
                     <div>
                        <p>交错排序使用基于Z阶曲线拟合的特殊多维聚类技术。它将多个列属性值（多维数据点）映射到单个一维值，同时保留列值（数据点）的多维局部性。单个表或多个表支持交错排序。与线性排序不同，此方法不需要存在聚类定义的前导列，以实现<span class="q">“ <a href="attribute-clustering.html#GUID-739B232C-969C-4506-AA12-6B52D6F20D70">属性 - 聚簇表的优点</a> ”</span>中描述的方案的I / O修剪优势。
                        </p>
                        <p>列可以单独使用，也可以组合成列组。每个单独的列或列组将用于构成群集中的多维数据点之一。分组列由'（'..'）'括起来，并且必须遵循从最粗糙到最精细粒度级别的维度层次结构。例如，（ <code class="codeph">product_category</code> ， <code class="codeph">product_subcategory</code> ）。
                        </p>
                        <p>使用<code class="codeph">CLUSTERING</code> <code class="codeph">...</code> <code class="codeph">BY</code> <code class="codeph">INTERLEAVED</code> <code class="codeph">ORDER</code>指令通过交错排序执行聚类。
                        </p>
                        <p>交错聚类对于SQL操作最有利，因为多列上的谓词不同。对于维度模型的星型查询通常就是这种情况，其中查询谓词在维度表上并且谓词的数量不同。使用交叉连接属性群集在基于维度表中的列对事实表进行群集的环境中最常见。维度表中的列可能包含层次结构，例如，产品类别和子类别的层次结构。在这种情况下，事实表的聚类将在形成层次结构的维度列上发生。这就是为什么星型模式的连接属性聚类有时被称为分层聚类的原因。例如，如果<code class="codeph">sales</code>查询指定来自不同维度的列，则可以根据这些维度中的列对<code class="codeph">sales</code>表中的数据进行集群。
                        </p>
                        <p>交错聚类与区域映射相结合在星型模式查询的I / O修剪中非常有效。此外，它使您能够使用区域映射为查询提供非常有效的I / O修剪，并增强压缩，因为相同的列值彼此接近并且可以轻松压缩。</p>
                     </div>
                  </div>
               </div><a id="DWHSG8918"></a><a id="DWHSG9341"></a><div class="props_rev_3"><a id="GUID-CFA30358-183D-4770-9A79-C6720BF9D753" name="GUID-CFA30358-183D-4770-9A79-C6720BF9D753"></a><h4 id="DWHSG-GUID-CFA30358-183D-4770-9A79-C6720BF9D753" class="sect4"><span class="enumeration_section">13.1.3</span>示例：属性聚簇表</h4>
                  <div>
                     <p><a href="attribute-clustering.html#GUID-CFA30358-183D-4770-9A79-C6720BF9D753__CHDHBIID">图13-1中</a>说明了集群表的外观示例。假设您有一个包含列<code class="codeph">(category, country)</code>的表<code class="codeph">sales</code> 。左侧的表使用线性排序进行聚类，右侧的表使用交错排序进行聚类。请注意，在交错排序表中，磁盘上存在包含具有给定类别和国家/地区的数据的连续区域。
                     </p>
                     <div class="figure" id="GUID-CFA30358-183D-4770-9A79-C6720BF9D753__CHDHBIID">
                        <p class="titleinfigure">图13-1属性聚簇表</p><img src="img/dwhsg136.png" alt="下面是图13-1的描述" title="下面是图13-1的描述" longdesc="img_text/dwhsg136.html"><br><a href="img_text/dwhsg136.html">“图13-1属性 - 聚簇表”的描述</a></div>
                     <!-- class="figure" -->
                  </div>
               </div><a id="DWHSG9342"></a><div class="props_rev_3"><a id="GUID-0314F65B-3015-4911-92E9-2C4117BC9579" name="GUID-0314F65B-3015-4911-92E9-2C4117BC9579"></a><h4 id="DWHSG-GUID-0314F65B-3015-4911-92E9-2C4117BC9579" class="sect4"><span class="enumeration_section">13.1.4</span>使用属性聚类的指南</h4>
                  <div>
                     <p>以下是一些<a id="d53740e451" class="indexterm-anchor"></a>定义属性聚簇表时的注意事项：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>将属性聚类与区域映射结合使用可以促进区域修剪及其相关的I / O减少。</p>
                        </li>
                        <li>
                           <p>考虑经常在中到低基数列上使用谓词查询的大型表。</p>
                        </li>
                        <li>
                           <p>考虑经常被维度层次结构查询的事实表。</p>
                        </li>
                        <li>
                           <p>对于分区表，请考虑包含与分区键相关的列（以便于区域映射分区修剪）。</p>
                        </li>
                        <li>
                           <p>对于线性排序，请按前缀到后缀顺序列出列。</p>
                        </li>
                        <li>
                           <p>将形成维度层次结构的列组合在一起。这构成了一个列组。在每个列组中，按最粗到最细的顺序列出列。</p>
                        </li>
                        <li>
                           <p>如果有四个以上的维表，请包含最常用过滤器指定的维。将维数限制为两个或三个以获得更好的聚类效果。</p>
                        </li>
                        <li>
                           <p>考虑在低到中的基数列上使用属性聚类而不是索引。</p>
                        </li>
                        <li>
                           <p>如果维度表的主键由维度层次结构值组成（例如，主键由年，季度，月，日值组成），请将相应的外键设置为群集列而不是维度层次结构。</p>
                        </li>
                     </ul>
                  </div>
               </div><a id="DWHSG8919"></a><div class="props_rev_3"><a id="GUID-739B232C-969C-4506-AA12-6B52D6F20D70" name="GUID-739B232C-969C-4506-AA12-6B52D6F20D70"></a><h4 id="DWHSG-GUID-739B232C-969C-4506-AA12-6B52D6F20D70" class="sect4"><span class="enumeration_section">13.1.5</span>属性聚簇表的优点</h4>
                  <div>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>消除与使用索引相关的存储成本</p>
                        </li>
                        <li>
                           <p>与区域映射结合使用时，可以访问群集区域，而不是执行随机I / O或全表扫描</p>
                        </li>
                        <li>
                           <p>与以下任何一项结合使用时，可提供I / O减少：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>Oracle Exadata存储索引</p>
                              </li>
                              <li>
                                 <p>Oracle内存最小/最大修剪</p>
                              </li>
                              <li>
                                 <p>区域地图</p>
                              </li>
                           </ul>
                           <p>属性集群基于用作过滤谓词的属性提供数据集群。由于Exadata存储索引和Oracle内存最小/最大修剪都跟踪存储在每个物理区域中的列的最小值和最大值，因此群集可减少访问数据所需的I / O.</p>
                           <p>使用区域映射进行I / O修剪可以显着降低表扫描和索引扫描的I / O成本和CPU成本。</p>
                        </li>
                        <li>
                           <p>根据星型模式中的维度列启用事实表的群集</p>
                           <p>诸如传统表簇之类的技术不提供按其他表的列排序。在星型模式中，大多数查询限定维度表而不是事实表，因此按事实表列进行集群无效。Oracle数据库支持对维度表中的列进行群集。</p>
                        </li>
                        <li>
                           <p>提高数据压缩率，从而间接提高了表扫描成本</p>
                           <p>压缩可以得到改善，因为通过群集，具有相同值的群集列很可能在磁盘上彼此接近，因此数据库可以更容易地压缩它们。</p>
                        </li>
                        <li>
                           <p>当属性聚类在索引选择条件上时，最小化索引范围扫描操作的表查找和单块I / O操作。</p>
                        </li>
                        <li>
                           <p>在OLTP应用程序中为符合前缀的查询启用I / O减少，并使用具有线性顺序的属性聚类</p>
                        </li>
                        <li>
                           <p>通过交叉排序，在聚类列的子集上启用I / O减少，以进行属性聚类</p>
                           <p>如果表数据在多个列上排序（如在索引组织表中），则查询必须指定列的前缀以获得I / O节省。相反， <code class="codeph">BY</code> <code class="codeph">INTERLEAVED</code>表允许查询在以非前缀顺序指定多个表中的列时受益于I / O修剪。
                           </p>
                        </li>
                     </ul>
                  </div>
               </div><a id="DWHSG9343"></a><div class="props_rev_3"><a id="GUID-6C7C444C-5796-4A43-AE3C-B7A373CC932D" name="GUID-6C7C444C-5796-4A43-AE3C-B7A373CC932D"></a><h4 id="DWHSG-GUID-6C7C444C-5796-4A43-AE3C-B7A373CC932D" class="sect4"><span class="enumeration_section">13.1.6</span>关于定义表的属性聚类</h4>
                  <div>
                     <p>属性聚类信息是表元数据的一部分。您可以在首次创建表时或通过更改表定义时为表定义属性集群。</p>
                     <p>使用<code class="codeph">CREATE TABLE</code>语句的<code class="codeph">CLUSTERING</code>子句为<code class="codeph">CREATE TABLE</code>定义属性集群。属性聚类的类型通过包括<code class="codeph">BY LINEAR ORDER</code>或<code class="codeph">BY INTERLEAVED ORDER</code> 。</p>
                     <div class="infoboxnotealso" id="GUID-6C7C444C-5796-4A43-AE3C-B7A373CC932D__GUID-C64C44E3-7098-45DD-AF39-611DE105E25B">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="q">“ <a href="attribute-clustering.html#GUID-DAECFBC5-FD1A-45A5-8C2C-DC9884D0857B">使用线性排序创建属性集群表</a> ”</span></p>
                           </li>
                           <li>
                              <p><span class="q">“ <a href="attribute-clustering.html#GUID-41510560-706B-4AF8-A59B-C8949BC5F4A1">使用Interleaved Ordering创建属性集群表</a> ”</span></p>
                           </li>
                        </ul>
                     </div>
                     <p>如果在创建表时未定义属性集群，则可以修改表定义并添加集群。使用<code class="codeph">ALTER TABLE ...ADD CLUSTERING</code>语句用于定义现有表的属性聚类。
                     </p>
                     <div class="infoboxnotealso" id="GUID-6C7C444C-5796-4A43-AE3C-B7A373CC932D__GUID-482A1B13-A82D-40B8-86A4-34B683A74BC4">
                        <p class="notep1">也可以看看：</p>
                        <p><span class="q">“ <a href="attribute-clustering.html#GUID-B30ECC81-6C05-48EB-B21D-F7923C1E1C30">将属性群集添加到现有表</a> ”</span></p>
                     </div>
                  </div>
               </div><a id="DWHSG9344"></a><div class="props_rev_3"><a id="GUID-636BB068-94D6-41FA-9FCE-5F3E71A1CF0A" name="GUID-636BB068-94D6-41FA-9FCE-5F3E71A1CF0A"></a><h4 id="DWHSG-GUID-636BB068-94D6-41FA-9FCE-5F3E71A1CF0A" class="sect4"><span class="enumeration_section">13.1.7</span>关于何时必须执行属性聚类的指定</h4>
                  <div>
                     <p>执行群集可能很昂贵，因为它涉及在DML操作期间重组表和聚类数据。Oracle数据库不会对常规DML，传统插入，更新和合并强制执行数据集群。</p>
                     <p>可以以两种方式执行聚类。第一种是对表上的某些DML操作自动执行聚类。这是通过定义作为表元数据的一部分来触发群集的操作来完成的。第二个是明确指定必须按照<span class="q">“ <a href="attribute-clustering.html#GUID-E45539BB-1A1A-43A2-BE13-E1BDA3756996">使用提示控制DML操作的属性群集</a> ”</span>和<span class="q">“ <a href="attribute-clustering.html#GUID-286AE59E-1285-4CE8-9287-C47A4C8D3F12">在DDL操作期间覆盖属性群集的表级设置”中所述执行群集</a></span> 。在这种情况下，即使其元数据定义不包括群集，也可以对表执行群集。
                     </p>
                     <p>作为表定义的一部分，您可以指定在触发以下操作时必须执行属性集群：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>直接路径插入操作</p>
                           <p>将<code class="codeph">ON LOAD</code>选项设置为<code class="codeph">YES</code>以指定必须在直接路径插入操作期间执行属性群集。
                           </p>
                        </li>
                        <li>
                           <p>数据移动操作</p>
                           <p>将<code class="codeph">ON DATA MOVEMENT</code>选项设置为<code class="codeph">YES</code>以指定必须在数据移动操作期间执行群集。这包括在线表重新定义和以下分区操作： <code class="codeph">MOVE</code> ， <code class="codeph">MERGE</code> ， <code class="codeph">SPLIT</code>和<code class="codeph">COALESCE</code> 。</p>
                        </li>
                     </ul>
                     <p><code class="codeph">ON LOAD</code>和<code class="codeph">ON DATA MOVEMENT</code>选项可以包含在<code class="codeph">CREATE TABLE</code>或<code class="codeph">ALTER TABLE</code>语句中。如果既未指定<code class="codeph">YES</code> <code class="codeph">ON</code> <code class="codeph">LOAD</code>也未指定<code class="codeph">YES</code> <code class="codeph">ON</code> <code class="codeph">DATA</code> <code class="codeph">MOVEMENT</code> ，则不会自动强制执行群集。
                     </p>
                     <p>它仅用作定义表的自然聚类的元数据，稍后可用于创建区域映射。在这种情况下，由用户在加载期间强制执行群集。</p>
                     <div class="infoboxnotealso" id="GUID-636BB068-94D6-41FA-9FCE-5F3E71A1CF0A__GUID-D330AE90-4DBA-44D7-993D-7F2047179F52">
                        <p class="notep1">也可以看看：</p>
                        <p><span class="q">“ <a href="attribute-clustering.html#GUID-B30ECC81-6C05-48EB-B21D-F7923C1E1C30">将属性聚类添加到现有表</a> ”</span>作为使用<code class="codeph">ON LOAD</code>和<code class="codeph">ON DATA MOVEMENT</code>选项的示例</p>
                     </div>
                  </div>
               </div>
            </div><a id="DWHSG8922"></a><div class="props_rev_3"><a id="GUID-B38DC1A3-3236-4741-BC33-613FE6B59C4F" name="GUID-B38DC1A3-3236-4741-BC33-613FE6B59C4F"></a><h3 id="DWHSG-GUID-B38DC1A3-3236-4741-BC33-613FE6B59C4F" class="sect3"><span class="enumeration_section">13.2</span>属性聚类操作</h3>
               <div>
                  <p>本节介绍涉及属性聚类的常见任务，包括：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="attribute-clustering.html#GUID-C7B6D6CF-50C6-4556-BD4C-737B5B5D2653">属性聚簇表的权限</a></p>
                     </li>
                     <li>
                        <p><a href="attribute-clustering.html#GUID-DAECFBC5-FD1A-45A5-8C2C-DC9884D0857B">使用线性排序创建属性聚簇表</a></p>
                     </li>
                     <li>
                        <p><a href="attribute-clustering.html#GUID-41510560-706B-4AF8-A59B-C8949BC5F4A1">使用Interleaved Ordering创建属性聚簇表</a></p>
                     </li>
                     <li>
                        <p><a href="attribute-clustering.html#GUID-589A37EE-61C9-4F12-BD8F-CB12F3A67675">维护属性聚类</a></p>
                     </li>
                  </ul>
               </div><a id="DWHSG9163"></a><div class="props_rev_3"><a id="GUID-C7B6D6CF-50C6-4556-BD4C-737B5B5D2653" name="GUID-C7B6D6CF-50C6-4556-BD4C-737B5B5D2653"></a><h4 id="DWHSG-GUID-C7B6D6CF-50C6-4556-BD4C-737B5B5D2653" class="sect4"><span class="enumeration_section">13.2.1</span>属性聚簇表的权限</h4>
                  <div>
                     <p>要为表定义属性集群，您必须对表具有<code class="codeph">CREATE</code>或<code class="codeph">ALTER</code>特权。此外，对于连接属性群集，还必须对已连接的表或表具有<code class="codeph">SELECT</code>或<code class="codeph">READ</code>权限。
                     </p>
                     <div class="infoboxnotealso" id="GUID-C7B6D6CF-50C6-4556-BD4C-737B5B5D2653__GUID-627D0F7D-97C0-4D04-9119-CA4847127144">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="../sqlrf/CREATE-TABLE.html#SQLRF01402" target="_blank"><span class="italic">Oracle数据库SQL语言参考</span></a> ，了解<code class="codeph">CREATE</code> <code class="codeph">TABLE</code>的<code class="codeph">CLUSTERING</code>子句的语法和语义</p>
                     </div>
                  </div>
               </div><a id="DWHSG8923"></a><div class="props_rev_3"><a id="GUID-DAECFBC5-FD1A-45A5-8C2C-DC9884D0857B" name="GUID-DAECFBC5-FD1A-45A5-8C2C-DC9884D0857B"></a><h4 id="DWHSG-GUID-DAECFBC5-FD1A-45A5-8C2C-DC9884D0857B" class="sect4"><span class="enumeration_section">13.2.2</span>使用线性排序创建属性聚簇表</h4>
                  <div>
                     <div class="section">
                        <p>线性排序根据指定列的顺序存储数据，相当于<code class="codeph">ORDER BY</code>子句。单个表的列或星型模式中的多个表支持线性排序。<a href="attribute-clustering.html#GUID-F04D6A23-9E72-4283-BFFF-F4406BD9BFC3">使用线性排序的属性聚类</a>示例包含<a href="attribute-clustering.html#GUID-F04D6A23-9E72-4283-BFFF-F4406BD9BFC3">具有线性排序</a>的属性聚簇表的示例。
                        </p>
                        <div class="infoboxnotealso" id="GUID-DAECFBC5-FD1A-45A5-8C2C-DC9884D0857B__GUID-B72C193B-A5FC-42F8-85C5-0287C815F1E0">
                           <p class="notep1">也可以看看：</p>
                           <p>有关属性群集限制的信息，请<a href="../sqlrf/CREATE-TABLE.html#SQLRF56843" target="_blank"><span class="italic">参见Oracle数据库SQL语言参考</span></a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div><a id="DWHSG9156"></a><a id="DWHSG9157"></a><a id="DWHSG8924"></a><div class="props_rev_3"><a id="GUID-F04D6A23-9E72-4283-BFFF-F4406BD9BFC3" name="GUID-F04D6A23-9E72-4283-BFFF-F4406BD9BFC3"></a><h5 id="DWHSG-GUID-F04D6A23-9E72-4283-BFFF-F4406BD9BFC3" class="sect5"><span class="enumeration_section">13.2.2.1</span>带线性排序的属性聚类示例</h5>
                     <div>
                        <div class="section">
                           <p><a href="attribute-clustering.html#GUID-F04D6A23-9E72-4283-BFFF-F4406BD9BFC3__CHDFCDGE">例13-1</a>和<a href="attribute-clustering.html#GUID-F04D6A23-9E72-4283-BFFF-F4406BD9BFC3__CHDFGDED">例13-2</a>说明了线性排序。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-F04D6A23-9E72-4283-BFFF-F4406BD9BFC3__CHDFCDGE">
                           <p class="titleinexample">例13-1使用线性排序创建表</p>
                           <p>假设<code class="codeph">sales</code>查询通常指定客户ID或客户ID和产品ID的组合。您可以创建属性聚簇表，以便此类查询可以从<span class="q">“ <a href="attribute-clustering.html#GUID-739B232C-969C-4506-AA12-6B52D6F20D70">属性 - 聚簇表的优点</a> ”</span>中描述的方案中减少I / O。
                           </p>
                           <p>以下语句使用线性排序创建<code class="codeph">sales</code>表：</p><pre class="oac_no_warn" dir="ltr">CREATE TABLE sales（prod_id NUMBER（6）NOT NULL，cust_id NUMBER NOT NULL，time_id DATE NOT NULL，channel_id CHAR（1）NOT NULL，promo_id NUMBER（6）NOT NULL，quantity_sold NUMBER（3）NOT NULL，amount_sold NUMBER（10 ，2）NOT NULL）按线性顺序聚类（cust_id，prod_id）;</pre><p>此聚簇表对于包含<code class="codeph">cust_id</code>上的谓词或<code class="codeph">cust_id</code>和<code class="codeph">prod_id</code>上的谓词的查询非常有用。
                           </p>
                        </div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-F04D6A23-9E72-4283-BFFF-F4406BD9BFC3__CHDFGDED">
                           <p class="titleinexample">示例13-2创建具有线性排序和连接的表</p>
                           <p>假设<code class="codeph">products</code>维度表在<code class="codeph">prod_id</code>列上具有唯一键或主键。此表中的其他列包括但不限于<code class="codeph">prod_name</code> ， <code class="codeph">prod_desc</code> ， <code class="codeph">prod_category</code> ， <code class="codeph">prod_subcategory</code>和<code class="codeph">prod_status</code> 。<code class="codeph">my_sales</code>事实表上的查询通常包含以下内容之一：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><code class="codeph">cust_id</code>的谓词</p>
                              </li>
                              <li>
                                 <p>对<code class="codeph">cust_id</code>和<code class="codeph">prod_category</code>谓词</p>
                              </li>
                              <li>
                                 <p>对<code class="codeph">cust_id</code> ， <code class="codeph">prod_category</code>和<code class="codeph">prod_subcategory</code></p>
                              </li>
                           </ul>
                           <p>定义属性聚类的<code class="codeph">my_sales</code>表是包含包括在谓词查询有用的<code class="codeph">CLUSTERING</code>条款。
                           </p><pre class="oac_no_warn" dir="ltr">CREATE TABLE my_sales（prod_id NUMBER（6）NOT NULL，cust_id NUMBER NOT NULL，time_id DATE NOT NULL，channel_id CHAR（1）NOT NULL，promo_id NUMBER（6）NOT NULL，quantity_sold NUMBER（3）NOT NULL，amount_sold NUMBER（10 ，2）NOT NULL）CLUSTERING my_sales JOIN products ON（my_sales.prod_id = products.prod_id）BY LINEAR ORDER（cust_id，prod_category，prod_subcategory）;</pre><div class="infoboxnotealso" id="GUID-F04D6A23-9E72-4283-BFFF-F4406BD9BFC3__GUID-A41D0B21-30CC-4D98-9065-E418A7159A75">
                              <p class="notep1">也可以看看：</p>
                              <p>有关<code class="codeph">BY</code> <code class="codeph">LINEAR</code> <code class="codeph">ORDER</code>子句的语法和语义的<a href="../sqlrf/CREATE-TABLE.html#SQLRF56830" target="_blank"><span class="italic">Oracle数据库SQL语言参考</span></a></p>
                           </div>
                        </div>
                        <!-- class="example" -->
                     </div>
                  </div>
               </div><a id="DWHSG8927"></a><div class="props_rev_3"><a id="GUID-41510560-706B-4AF8-A59B-C8949BC5F4A1" name="GUID-41510560-706B-4AF8-A59B-C8949BC5F4A1"></a><h4 id="DWHSG-GUID-41510560-706B-4AF8-A59B-C8949BC5F4A1" class="sect4"><span class="enumeration_section">13.2.3</span>使用Interleaved Ordering创建属性聚簇表</h4>
                  <div>
                     <div class="section">
                        <p>交错排序使用类似于Z顺序排序的特殊多维聚类技术。当您拥有大多数时候常用的特定谓词集时，尤其有用，但并不总是使用所有谓词。交错排序对于数据仓库中的星型模式的维层次结构非常有用。 <span class="q">“ <a href="attribute-clustering.html#GUID-96DF0C3A-1AC4-443D-AC07-0FC845ECEB03">具有交织排序的属性聚类的</a></span>示例<span class="q">”</span>包含<span class="q"><a href="attribute-clustering.html#GUID-96DF0C3A-1AC4-443D-AC07-0FC845ECEB03">具有交错排序</a></span>的属性聚类表的示例。
                        </p>
                        <div class="infoboxnotealso" id="GUID-41510560-706B-4AF8-A59B-C8949BC5F4A1__GUID-A5A35016-8771-456D-A82F-DAC88B463124">
                           <p class="notep1">也可以看看：</p>
                           <p>有关属性群集限制的信息，请<a href="../sqlrf/CREATE-TABLE.html#SQLRF56843" target="_blank"><span class="italic">参见Oracle数据库SQL语言参考</span></a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div><a id="DWHSG9159"></a><a id="DWHSG9160"></a><a id="DWHSG8928"></a><div class="props_rev_3"><a id="GUID-96DF0C3A-1AC4-443D-AC07-0FC845ECEB03" name="GUID-96DF0C3A-1AC4-443D-AC07-0FC845ECEB03"></a><h5 id="DWHSG-GUID-96DF0C3A-1AC4-443D-AC07-0FC845ECEB03" class="sect5"><span class="enumeration_section">13.2.3.1</span>具有交织排序的属性聚类示例</h5>
                     <div>
                        <div class="section">
                           <p><a href="attribute-clustering.html#GUID-96DF0C3A-1AC4-443D-AC07-0FC845ECEB03__CCHGFFIB">例13-3</a>和<a href="attribute-clustering.html#GUID-96DF0C3A-1AC4-443D-AC07-0FC845ECEB03__CCHCGHCD">例13-4</a>说明了交错排序。
                           </p>
                           <p>您还可以创建属性聚簇表，以便查询从区域映射修剪中受益。 <span class="q">“ <a href="using-zone-maps.html#GUID-655206D5-CD38-4CE3-AD20-DC984BB7CE26">使用属性聚类创建区域地图</a> ”</span>包含<span class="q"><a href="using-zone-maps.html#GUID-655206D5-CD38-4CE3-AD20-DC984BB7CE26">使用属性聚类</a></span>定义区域地图的示例。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-96DF0C3A-1AC4-443D-AC07-0FC845ECEB03__CCHGFFIB">
                           <p class="titleinexample">示例13-3使用Interleaved Ordering创建表</p>
                           <p>假设<code class="codeph">sales</code>查询通常指定时间ID或时间ID和产品ID的组合。您可以使用以下命令使用交错属性群集创建<code class="codeph">sales</code> ：</p><pre class="oac_no_warn" dir="ltr">CREATE TABLE sales（prod_id NUMBER（6）NOT NULL，cust_id NUMBER NOT NULL，time_id DATE NOT NULL，channel_id CHAR（1）NOT NULL，promo_id NUMBER（6）NOT NULL，quantity_sold NUMBER（3）NOT NULL，amount_sold NUMBER（10 ，2）NOT NULL）按交错顺序进行聚类（time_id，prod_id）;</pre><p>此聚簇表对包含以下内容之一的查询很有用：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>关于<code class="codeph">time_id</code>的谓词</p>
                              </li>
                              <li>
                                 <p>关于<code class="codeph">prod_id</code></p>
                              </li>
                              <li>
                                 <p>关于<code class="codeph">time_id</code>和<code class="codeph">prod_id</code></p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-96DF0C3A-1AC4-443D-AC07-0FC845ECEB03__CCHCGHCD">
                           <p class="titleinexample">示例13-4使用Interleaved Ordering和Join创建表</p>
                           <p>大型数据仓库经常以星型模式组织数据。维度表使用父子层次结构，并通过外键连接到事实表。使用交错排序对事实表进行聚类使数据库能够使用特殊函数在表扫描期间跳过维列中的值。请注意，群集不需要强制外键关系。但是，Oracle数据库确实需要维表上的主键或唯一键。</p>
                           <p>以下命令使用<code class="codeph">sales</code>事实表的交叉排序定义属性集群：</p><pre class="oac_no_warn" dir="ltr">CREATE TABLE sales（prod_id NUMBER（6）NOT NULL，cust_id NUMBER NOT NULL，time_id DATE NOT NULL，channel_id CHAR（1）NOT NULL，promo_id NUMBER（6）NOT NULL，quantity_sold NUMBER（3）NOT NULL，amount_sold NUMBER（10 ，2）NOT NULL）CLUSTERING销售JOIN产品ON（sales.prod_id = products.prod_id）BY INTERLEAVED ORDER（（time_id），（prod_category，prod_subcategory））;</pre><p>此聚簇表对包含以下内容之一的查询很有用：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>关于<code class="codeph">time_id</code>的谓词</p>
                              </li>
                              <li>
                                 <p>关于<code class="codeph">prod_category</code>的谓词</p>
                              </li>
                              <li>
                                 <p>关于<code class="codeph">prod_category</code>和<code class="codeph">prod_subcategory</code>谓词</p>
                              </li>
                              <li>
                                 <p>关于<code class="codeph">time_id</code>和<code class="codeph">prod_category</code>谓词</p>
                              </li>
                              <li>
                                 <p>对<code class="codeph">time_id</code> ， <code class="codeph">prod_category</code>和<code class="codeph">prod_subcategory</code></p>
                              </li>
                           </ul>
                           <div class="infoboxnotealso" id="GUID-96DF0C3A-1AC4-443D-AC07-0FC845ECEB03__GUID-187E1692-9F80-4969-9801-A47634F75AA8">
                              <p class="notep1">也可以看看：</p>
                              <p>有关<code class="codeph">CREATE TABLE</code>语句和<code class="codeph">CLUSTERING</code>子句的信息，请<a href="../sqlrf/CREATE-TABLE.html#SQLRF01402" target="_blank"><span class="italic">参见Oracle数据库SQL语言参考</span></a></p>
                           </div>
                        </div>
                        <!-- class="example" -->
                     </div>
                  </div>
               </div><a id="DWHSG8932"></a><div class="props_rev_3"><a id="GUID-589A37EE-61C9-4F12-BD8F-CB12F3A67675" name="GUID-589A37EE-61C9-4F12-BD8F-CB12F3A67675"></a><h4 id="DWHSG-GUID-589A37EE-61C9-4F12-BD8F-CB12F3A67675" class="sect4"><span class="enumeration_section">13.2.4</span>维护属性聚类</h4>
                  <div>
                     <div class="section">
                        <p>您可以在任何时间点添加，删除和更新表的属性聚类定义。修改后的定义不会影响现有的表数据，但只能用作将来操作的指令。</p>
                        <p>以下维护操作修改表元数据：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="attribute-clustering.html#GUID-B30ECC81-6C05-48EB-B21D-F7923C1E1C30">将属性群集添加到现有表</a></p>
                           </li>
                           <li>
                              <p><a href="attribute-clustering.html#GUID-C92FB7F3-ED86-4CD6-A152-7B1F4786E475">修改属性聚类定义</a></p>
                           </li>
                           <li>
                              <p><a href="attribute-clustering.html#GUID-091E20D7-ED91-4716-B765-4D265A82DEAC">删除现有表的属性群集</a></p>
                           </li>
                        </ul>
                        <p>您还可以在运行时覆盖表上的属性集群定义。在运行时影响属性集群行为的维护操作是：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="attribute-clustering.html#GUID-E45539BB-1A1A-43A2-BE13-E1BDA3756996">使用提示控制DML操作的属性聚类</a></p>
                           </li>
                           <li>
                              <p><a href="attribute-clustering.html#GUID-286AE59E-1285-4CE8-9287-C47A4C8D3F12">在DDL操作期间覆盖属性群集的表级设置</a></p>
                           </li>
                           <li>
                              <p><a href="attribute-clustering.html#GUID-CF11EB18-EF2A-430F-8AB0-86FBB3AC063B">在线表重新定义期间对表数据进行聚类</a></p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div><a id="DWHSG8930"></a><div class="props_rev_3"><a id="GUID-B30ECC81-6C05-48EB-B21D-F7923C1E1C30" name="GUID-B30ECC81-6C05-48EB-B21D-F7923C1E1C30"></a><h5 id="DWHSG-GUID-B30ECC81-6C05-48EB-B21D-F7923C1E1C30" class="sect5"><span class="enumeration_section">13.2.4.1</span>将属性聚类添加到现有表</h5>
                     <div>
                        <div class="section">
                           <p>当你<a id="d53740e1289" class="indexterm-anchor"></a>创建一个具有聚类的表，默认情况下使用区域映射创建。但是，您可以使用<code class="codeph">WITHOUT</code> <code class="codeph">ZONEMAP</code>明确地阻止这种<code class="codeph">ZONEMAP</code> 。这可以由于多种原因来完成，例如想要在群集列上创建区域映射以及与群集列相关的其他列，或者使用特定的区域映射存储选项而不是默认值。
                           </p>
                           <p>使用<code class="codeph">ALTER TABLE ...ADD CLUSTERING</code>命令将属性群集添加到当前不使用属性群集的现有表。
                           </p>
                           <p>以下命令将属性集群添加到<code class="codeph">SALES</code>事实表。修改后的表将使用基于连接的维度表<code class="codeph">CUSTOMERS</code>和<code class="codeph">PRODUCTS</code>交叉聚类。</p><pre class="oac_no_warn" dir="ltr">ALTER TABLE sales ADD CLUSTERING sales JOIN customers ON（sales.cust_id = customers.cust_id）JOIN products ON（sales.prod_id = products.prod_id）BY INTERLEAVED ORDER（（prod_category，prod_subcategory），（country_id，cust_state_province，cust_city））YES ON在没有物质化的ZONEMAP的情况下加载数据运动;</pre><p>将群集添加到表时，现有数据不会群集。要强制现有数据进行群集，您需要使用<code class="codeph">ALTER TABLE...移动表的内容<code class="codeph">ALTER TABLE...MOVE</code>声明。您可以按分区执行此分区。
                           </p>
                           <p>以下命令将<code class="codeph">sales</code>表中的数据进行聚类：</p><pre class="oac_no_warn" dir="ltr">ALTER TABLE销售MOVE PARTITION sales_1995 UPDATE INDEXES ALLOW CLUSTERING;</pre><p>有关区域贴图的详细信息，请参阅<span class="q">“ <a href="using-zone-maps.html#GUID-7E5C3F5A-C1F5-4A5E-A501-DB50B8948263">关于区域贴图</a> ”</span> 。
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="DWHSG9345"></a><div class="props_rev_3"><a id="GUID-C92FB7F3-ED86-4CD6-A152-7B1F4786E475" name="GUID-C92FB7F3-ED86-4CD6-A152-7B1F4786E475"></a><h5 id="DWHSG-GUID-C92FB7F3-ED86-4CD6-A152-7B1F4786E475" class="sect5"><span class="enumeration_section">13.2.4.2</span>修改属性聚类定义</h5>
                     <div>
                        <div class="section">
                           <p>使用<code class="codeph">ALTER TABLE ...MODIFY CLUSTERING</code>语句<a id="d53740e1363" class="indexterm-anchor"></a>修改何时触发表的属性聚类。修改群集定义不会影响现有的表数据。修改后的定义仅适用于未来的数据移动或直接路径插入操作。
                           </p>
                           <p>以下命令修改<code class="codeph">SALES</code>表的群集定义，并在数据移动期间启用群集。
                           </p><pre class="oac_no_warn" dir="ltr">ALTER TABLE销售MODIFY CLUSTERING YES FOR DATA MOVEMENT;</pre><p>您还可以修改表定义并创建或删除基于属性群集的区域映射。以下语句修改<code class="codeph">SALES</code>表的定义并添加区域映射：</p><pre class="oac_no_warn" dir="ltr">ALTER TABLE销售使用物化ZONEMAP修改集群;</pre><p>使用以下语句修改属性聚簇表<code class="codeph">SALES</code>的定义并删除区域映射。
                           </p><pre class="oac_no_warn" dir="ltr">ALTER TABLE销售无需物料化ZONEMAP的MODIFY CLUSTERING;</pre></div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="DWHSG9346"></a><div class="props_rev_3"><a id="GUID-091E20D7-ED91-4716-B765-4D265A82DEAC" name="GUID-091E20D7-ED91-4716-B765-4D265A82DEAC"></a><h5 id="DWHSG-GUID-091E20D7-ED91-4716-B765-4D265A82DEAC" class="sect5"><span class="enumeration_section">13.2.4.3</span>删除现有表的属性聚类</h5>
                     <div>
                        <div class="section">
                           <p>如果是属性聚类<a id="d53740e1413" class="indexterm-anchor"></a>为现有表定义，使用<code class="codeph">ALTER TABLE ...DROP CLUSTERING</code>语句删除属性聚类。删除聚类定义不会对现有表数据产生任何影响。
                           </p>
                           <p>以下命令删除<code class="codeph">SALES</code>表的属性群集：</p><pre class="oac_no_warn" dir="ltr">ALTER TABLE销售DROP CLUSTERING;</pre></div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="DWHSG9347"></a><div class="props_rev_3"><a id="GUID-E45539BB-1A1A-43A2-BE13-E1BDA3756996" name="GUID-E45539BB-1A1A-43A2-BE13-E1BDA3756996"></a><h5 id="DWHSG-GUID-E45539BB-1A1A-43A2-BE13-E1BDA3756996" class="sect5"><span class="enumeration_section">13.2.4.4</span>使用提示控制DML操作的属性聚类</h5>
                     <div>
                        <div class="section">
                           <p>你可以使用提示<a id="d53740e1452" class="indexterm-anchor"></a>强制使用群集或防止在直接路径插入操作期间使用群集。使用<code class="codeph">CLUSTERING</code>提示强制聚类的一张桌子和<code class="codeph">NO_CLUSTERING</code>提示，以防止使用集群。
                           </p>
                           <p>以下命令在将数据插入<code class="codeph">SALES</code>表时禁用属性群集。该表是使用<code class="codeph">YES ON LOAD</code>选项创建的。
                           </p><pre class="oac_no_warn" dir="ltr">INSERT / * + APPEND NO_CLUSTERING * / INTO销售SELECT * FROM external_sales;</pre><p>有关提示的详细信息，请参阅<span class="q">“ <a href="using-zone-maps.html#GUID-8266B0F1-29B0-418C-90F5-09B0AAA87F8F">控制区域地图的使用</a> ”</span> 。
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="DWHSG9348"></a><div class="props_rev_3"><a id="GUID-286AE59E-1285-4CE8-9287-C47A4C8D3F12" name="GUID-286AE59E-1285-4CE8-9287-C47A4C8D3F12"></a><h5 id="DWHSG-GUID-286AE59E-1285-4CE8-9287-C47A4C8D3F12" class="sect5"><span class="enumeration_section">13.2.4.5</span>在DDL操作期间覆盖属性群集的表级设置</h5>
                     <div>
                        <div class="section">
                           <p>您可以在数据移动DDL操作（例如创建新数据段（拆分或合并操作）或移动表，分区或子分区的分区维护）中覆盖属性集群定义。例如，如果使用<code class="codeph">NO ON DATA MOVEMENT</code>选项定义了表，则可以在数据移动操作期间使用<code class="codeph">ALTER TABLE ...对此表的数据进行聚类<code class="codeph">ALTER TABLE ...ALLOW CLUSTERING</code>声明。
                           </p>
                           <p>以下命令允许在使用<code class="codeph">NO ON DATA MOVEMENT</code>选项定义的<code class="codeph">SALES</code>表的<code class="codeph">sales_2010</code>分区的数据移动期间进行群集：</p><pre class="oac_no_warn" dir="ltr">ALTER TABLE销售MOVE PARTITION sales_2010 UPDATE INDEXES ALLOW CLUSTERING;</pre><p>同样，您可以在数据移动期间为使用<code class="codeph">YES ON DATA MOVEMENT</code>选项定义的表禁用聚类，方法是在用于移动数据的<code class="codeph">ALTER TABLE</code>命令中包含<code class="codeph">DISALLOW CLUSTERING</code>子句。
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="DWHSG8934"></a><a id="DWHSG9349"></a><div class="props_rev_3"><a id="GUID-CF11EB18-EF2A-430F-8AB0-86FBB3AC063B" name="GUID-CF11EB18-EF2A-430F-8AB0-86FBB3AC063B"></a><h5 id="DWHSG-GUID-CF11EB18-EF2A-430F-8AB0-86FBB3AC063B" class="sect5"><span class="enumeration_section">13.2.4.6</span>在线表重新定义期间对表数据进行聚类</h5>
                     <div>
                        <div class="section">
                           <p>通过联机表重定义，您可以修改表的逻辑或物理结构，而不会显着影响其可用性。在重定义过程的大部分时间内，查询和DML都可以访问该表。</p>
                           <p>您可以在线重新定义表，并将属性群集添加到之前未使用属性群集的表中。<code class="codeph">DBMS_REDEFINITION</code>包使您可以在线重新定义表并向其添加属性群集。
                           </p>
                           <div class="infoboxnotealso" id="GUID-CF11EB18-EF2A-430F-8AB0-86FBB3AC063B__GUID-171C5639-35C6-43DB-B0F6-9415EB2C5925">
                              <p class="notep1">也可以看看：</p>
                              <p>有关<code class="codeph">DBMS_REDEFINITION</code>包的更多信息，请<a href="../arpls/DBMS_REDEFINITION.html#ARPLS-GUID-2BA796C4-8B4D-49B4-8A35-4C6F789CD374" target="_blank"><span><cite>参见Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                           </div>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-CF11EB18-EF2A-430F-8AB0-86FBB3AC063B__GUID-2351793D-179F-4839-A474-B3A60A181295">
                           <p class="titleinexample">示例13-5在线重新定义属性聚簇表</p>
                           <p>假设您要重新定义<code class="codeph">sales</code>表以将<code class="codeph">amount_sold</code>的数据类型从数字更改为float，将属性群集添加到表中，并在联机重新定义期间对数据进行群集。
                           </p>
                           <p>使用以下步骤在<code class="codeph">SH</code>模式中重新定义<code class="codeph">sales</code>表并在联机表重新定义期间对其数据进行集群：</p>
                           <ol>
                              <li>
                                 <p>验证表可以通过调用在线重定义<code class="codeph">CAN_REDEF_TABLE</code>的议事<code class="codeph">DBMS_REDEFINITION</code>包。
                                 </p>
                                 <p>以下命令验证是否可以在线重新定义<code class="codeph">sales</code>表：</p><pre class="oac_no_warn" dir="ltr">exec DBMS_REDEFINITION.CAN_REDEF_TABLE（'SH'，'SALES'）;</pre></li>
                              <li>
                                 <p>在<code class="codeph">SH</code>模式中创建临时表，其中包含要用于重新定义的表的所需物理和逻辑属性。
                                 </p>
                                 <p>以下命令创建临时表<code class="codeph">sales_interim</code> 。所述的数据类型<code class="codeph">amount_sold</code>列是<code class="codeph">binary_double</code>和<code class="codeph">CLUSTERING</code>子句指定如何必须进行属性聚类。
                                 </p><pre class="oac_no_warn" dir="ltr">CREATE TABLE sales_interim（PROD_ID NUMBER（6）PRIMARY KEY，CUST_ID NUMBER NOT NULL，TIME_ID DATE NOT NULL，CHANNEL_ID CHAR（1）NOT NULL，PROMO_ID NUMBER（6），QUANTITY_SOLD NUMBER（3）NOT NULL，AMOUNT_SOLD binary_double）CLUSTERING sales_interim JOIN customers ON（sales_interim.cust_id = customers.cust_id）JOIN products ON（sales_interim.prod_id = products.prod_id）BY INTERLEAVED ORDER（（prod_category，prod_subcategory），（country_id，cust_state_province，cust_city））;</pre></li>
                              <li>
                                 <p>使用<code class="codeph">DBMS_REDEFINITON.START_REDEF_TABLE</code>过程启动联机表重新定义过程。在此过程中， <code class="codeph">sales</code>表可用于查询和DML。
                                 </p>
                                 <p>以下命令启动<code class="codeph">sales</code>表的重新定义过程：</p><pre class="oac_no_warn" dir="ltr">exec DBMS_REDEFINITION.START_REDEF_TABLE（uname =&gt;'SH'，orig_table =&gt;'SALES'，int_table =&gt;'SALES_INTERIM'，options_flag =&gt; DBMS_REDEFINITION.CONS_USE_ROWID）;</pre></li>
                              <li>
                                 <p>（可选）将临时表与原始表同步。</p>
                                 <p>如果在重新定义开始后可能在原始表上执行了大量DML语句，则建议进行同步。此步骤减少了完成重新定义过程所需的时间。</p>
                                 <p>以下命令将<code class="codeph">sales_interim</code>表与原始<code class="codeph">sales</code>表同步：</p><pre class="oac_no_warn" dir="ltr">exec DBMS_REDEFINITION.SYNC_INTERIM_TABLE（'SH'，'SALES'，'SALES_INTERIM'）;</pre></li>
                              <li>
                                 <p>使用<code class="codeph">DBMS_REDEFINITION.FINISH_REDEF_TABLE</code>过程完成在线表重新定义。
                                 </p>
                                 <p>以下命令完成<code class="codeph">sales</code>表的在线重新定义：</p><pre class="oac_no_warn" dir="ltr">exec DBMS_REDEFINITION.FINISH_REDEF_TABLE（'SH'，'SALES'，'SALES_INTERIM'）;</pre></li>
                           </ol>
                        </div>
                        <!-- class="example" -->
                     </div>
                  </div>
               </div>
            </div><a id="DWHSG9350"></a><div class="props_rev_3"><a id="GUID-BA91F630-389F-417D-A07C-D53A57D80F61" name="GUID-BA91F630-389F-417D-A07C-D53A57D80F61"></a><h3 id="DWHSG-GUID-BA91F630-389F-417D-A07C-D53A57D80F61" class="sect3"><span class="enumeration_section">13.3</span>查看属性聚类信息</h3>
               <div>
                  <p>Oracle数据库提供了一组数据字典<a id="d53740e1699" class="indexterm-anchor"></a>包含有关属性群集的信息的视图。本节介绍如何使用这些视图获取有关属性群集的信息。
                  </p>
                  <p>本节包含以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="attribute-clustering.html#GUID-D8519D08-CBC2-4AE2-92C4-ABCB7CEEBAAD">确定是否为表定义属性聚类</a></p>
                     </li>
                     <li>
                        <p><a href="attribute-clustering.html#GUID-75816833-5DDA-4211-B751-8C294B543E1F">查看表的属性 - 群集信息</a></p>
                     </li>
                     <li>
                        <p><a href="attribute-clustering.html#GUID-F618CFC7-99A8-4459-B248-36AAFD9B57D1">查看有关执行属性群集的列的信息</a></p>
                     </li>
                     <li>
                        <p><a href="attribute-clustering.html#GUID-425947F0-5949-4D59-8013-0380AF939933">查看有关执行属性群集的维度和联接的信息</a></p>
                     </li>
                  </ul>
               </div><a id="DWHSG9351"></a><div class="props_rev_3"><a id="GUID-D8519D08-CBC2-4AE2-92C4-ABCB7CEEBAAD" name="GUID-D8519D08-CBC2-4AE2-92C4-ABCB7CEEBAAD"></a><h4 id="DWHSG-GUID-D8519D08-CBC2-4AE2-92C4-ABCB7CEEBAAD" class="sect4"><span class="enumeration_section">13.3.1</span>确定是否为表定义属性聚类</h4>
                  <div>
                     <div class="section">
                        <p>该<code class="codeph">CLUSTERING</code>在视图列<code class="codeph">DBA_TABLES</code> ， <code class="codeph">USER_TABLES</code>和<code class="codeph">ALL_TABLES</code>指定是否属性聚类为表中定义。如果为表定义了属性聚类，则<code class="codeph">CLUSTERING</code>列显示<code class="codeph">YES</code> ，否则为<code class="codeph">NO</code> 。
                        </p>
                        <p>以下查询显示<code class="codeph">SH</code>模式中的表的名称，并指示它们是否使用属性集群。
                        </p><pre class="oac_no_warn" dir="ltr">SELECT TABLE_NAME，从DBA_TABLES CLUSTERING WHERE OWNER ='SH'; TABLE_NAME CLUSTERING ----------- ------------ SALES YES PRODUCTS NO MY_SALES YES</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="DWHSG9352"></a><div class="props_rev_3"><a id="GUID-75816833-5DDA-4211-B751-8C294B543E1F" name="GUID-75816833-5DDA-4211-B751-8C294B543E1F"></a><h4 id="DWHSG-GUID-75816833-5DDA-4211-B751-8C294B543E1F" class="sect4"><span class="enumeration_section">13.3.2</span>查看表的属性 - 聚类信息</h4>
                  <div>
                     <div class="section">
                        <p>使用以下数据字典视图之一获取有关表的属性集群的详细信息：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">DBA_CLUSTERING_TABLES</code>用于描述数据库中的所有属性聚簇表</p>
                           </li>
                           <li>
                              <p><code class="codeph">ALL_CLUSTERING_TABLES</code>描述用户可访问的属性集群表</p>
                           </li>
                           <li>
                              <p><code class="codeph">USER_CLUSTERING_TABLES</code>用于描述用户拥有的属性聚簇表</p>
                           </li>
                        </ul>
                        <p>以下查询显示有关<code class="codeph">SALES</code>表的属性群集的详细信息。详细信息包括属性群集的类型以及为表启用群集的操作。输出已格式化为适合页面。
                        </p><pre class="oac_no_warn" dir="ltr">SELECT owner，table_name，clustering_type，on_load，on_datamovement，with_zonemap FROM DBA_CLUSTERING_TABLES WHERE table_name ='SALES'; OWNER TABLE_NAME CLUSTERING_TYPE ON_LOAD ON_DATAMOVEMENT WITH_ZONEMAP ------ ---------- --------------- -------- ----- ---------- ------------- SH SALES LINEAR是是是</pre><pre class="oac_no_warn" dir="ltr">SELECT owner，table_name，clustering_type，on_load，on_datamovement FROM DBA_CLUSTERING_TABLES WHERE table_name ='SALES'; OWNER TABLE_NAME CLUSTERING_TYPE ON_LOAD ON_DATAMOVEMENT ------ ---------- --------------- -------- ------ --------- SH SALES LINEAR是的</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="DWHSG9353"></a><div class="props_rev_3"><a id="GUID-F618CFC7-99A8-4459-B248-36AAFD9B57D1" name="GUID-F618CFC7-99A8-4459-B248-36AAFD9B57D1"></a><h4 id="DWHSG-GUID-F618CFC7-99A8-4459-B248-36AAFD9B57D1" class="sect4"><span class="enumeration_section">13.3.3</span>查看有关执行属性聚类的列的信息</h4>
                  <div>
                     <div class="section">
                        <p>使用以下数据字典视图之一获取有关为表定义属性集群的列的信息：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">DBA_CLUSTERING_KEYS</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">ALL_CLUSTERING_KEYS</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">USER_CLUSTERING_KEYS</code></p>
                           </li>
                        </ul>
                        <p>例如，表<code class="codeph">SALES</code>的数据使用线性排序进行聚类。使用以下命令显示聚簇表的列。输出已格式化为适合页面。
                        </p><pre class="oac_no_warn" dir="ltr">SELECT detail_owner，detail_name，detail_column，position FROM DBA_CLUSTERING_KEYS WHERE table_name ='SALES'; DETAIL_OWNER DETAIL_NAME DETAIL_COLUMN POSITION ------------ -------------- ----------------- --- ------ SH SALES PROD_ID 2 SH SALES TIME_ID 1</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="DWHSG9354"></a><div class="props_rev_3"><a id="GUID-425947F0-5949-4D59-8013-0380AF939933" name="GUID-425947F0-5949-4D59-8013-0380AF939933"></a><h4 id="DWHSG-GUID-425947F0-5949-4D59-8013-0380AF939933" class="sect4"><span class="enumeration_section">13.3.4</span>查看有关执行属性聚类的维和连接的信息</h4>
                  <div>
                     <div class="section">
                        <p>要查看有关聚类事实表的维度表的信息，请查询<code class="codeph">DBA_CLUSTERING_DIMENSIONS</code> ， <code class="codeph">ALL_CLUSTERING_DIMENSIONS</code>或<code class="codeph">USER_CLUSTERING_DIMENSIONS</code>数据字典视图。
                        </p>
                        <p>要查看有关事实表和维度表的连接的详细信息，请查询<code class="codeph">DBA_CLUSTERING_JOINS</code> ， <code class="codeph">ALL_CLUSTERING_JOINS</code>或<code class="codeph">USER_CLUSTERING_JOINS</code>视图。输出已格式化为适合页面。
                        </p>
                        <p>以下查询显示事实表<code class="codeph">SALES</code>属性聚簇的维度表。
                        </p><pre class="oac_no_warn" dir="ltr">SELECT * FROM DBA_CLUSTERING_DIMENSIONS WHERE table_name ='MY_SALES'; OWNER TABLE_NAME DIMENSION_OWNER DIMENSION_NAME ------ -------------- ------------------- ------- -------------- SH MY_SALES SH产品</pre><p>以下查询显示用于将事实表<code class="codeph">my_sales</code>与维度表<code class="codeph">products</code>连接的列。输出已格式化为适合页面。
                        </p><pre class="oac_no_warn" dir="ltr">SELECT tab1_owner，tab1_name，tab1_column FROM DBA_CLUSTERING_JOINS WHERE table_name ='MY_SALES'; TAB1_OWNER TAB1_NAME TAB1_COLUMN ----------- ------------- -------------------- SH MY_SALES PROD_ID</pre></div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>