<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="You can use XML schema evolution to update your XML schema after you have registered it with Oracle XML DB."></meta>
      <meta name="description" content="You can use XML schema evolution to update your XML schema after you have registered it with Oracle XML DB."></meta>
      <title>XML Schema Evolution</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Developer&#39;s Guide "></meta>
      <meta property="og:description" content="You can use XML schema evolution to update your XML schema after you have registered it with Oracle XML DB."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Developer&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="xml-db-developers-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-03-30T12:32:42-07:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2002, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96222-03"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="XPath-rewrite-for-object-relational-storage.html" title="Previous" type="text/html"></link>
      <link rel="next" href="XML-DB-repository.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="XML DB Developer&#39;s Guide"></meta>
    <meta name="dcterms.isVersionOf" content="ADXDB"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="XPath-rewrite-for-object-relational-storage.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="XML-DB-repository.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">开发人员指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="XML-Schema-and-object-relational-XMLType.html" property="item" typeof="WebPage"><span property="name">XML Schema和Object-Relational XMLType</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">XML Schema Evolution</li>
            </ol>
            <a id="GUID-F2E920B3-C6D7-428B-9E75-5CE9C21F9B5F" name="GUID-F2E920B3-C6D7-428B-9E75-5CE9C21F9B5F"></a><a id="ADXDB0800"></a>
            
            <h2 id="ADXDB-GUID-F2E920B3-C6D7-428B-9E75-5CE9C21F9B5F" class="sect2"><span class="enumeration_chapter">20</span> XML Schema Evolution</h2>
         </header>
         <div class="ind">
            <div>
               <p>在向Oracle XML DB注册XML模式后，可以使用XML模式演变来更新XML模式。</p>
               <p>Oracle XML DB支持W3C XML Schema建议。可以使用SQL和协议（如FTP，HTTP（S）和WebDAV）存储和检索符合XML模式的XML实例文档。除了指定XML文档的结构之外，XML模式还确定了XML和对象关系存储之间的映射。</p>
               <div class="section"></div>
               <!-- class="section" -->
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="XML-Schema-evolution.html#GUID-98F5058B-852E-48C2-80A5-C5E7068AE0DD">XML Schema Evolution概述</a><br>使用XML模式与Oracle XML DB的开发人员面临的主要挑战是如何处理XML文档的内容或结构的变化。在某些环境中，由于新法规，内部需求或外部机会，对变更的需求可能频繁或广泛。
                  </li>
                  <li class="ulchildlink"><a href="XML-Schema-evolution.html#GUID-0E4FC235-D8D1-4F27-85DC-A3DCCC2662AB">基于副本的模式演变</a><br>您使用PL / SQL过程<code class="codeph">DBMS_XMLSCHEMA.copyEvolve</code>执行基于副本的XML模式演变。这会将现有实例文档备份到临时<code class="codeph">XMLType</code>表，删除旧版本的XML架构（也会删除关联的实例文档），注册新版本，并将备份的实例文档复制到新的<code class="codeph">XMLType</code>表。
                  </li>
                  <li class="ulchildlink"><a href="XML-Schema-evolution.html#GUID-0C97EA66-1890-495D-9117-55FB0D563992">就地XML架构演变</a><br>就地XML模式演变可以更改XML模式，而无需复制，删除和重新插入现有数据。因此，就地进化比基于复制的进化快得多。然而，就地进化也有一些限制，不适用于基于拷贝的进化。
                  </li>
               </ul>
               <div class="relinfo">
                  <p><strong>相关话题</strong></p>
                  <ul>
                     <li><a href="XML-Schema-and-query-basic.html#GUID-C09824C1-6B02-4556-A265-B1749DEE8DE1" title="XML Schema是用于描述XML文档的内容和结构的标准。您可以注册，更新和删除与Oracle XML DB一起使用的XML架构。您可以定义用于基于XML模式的数据的存储结构，并将XML模式数据类型映射到SQL数据类型。">XML模式存储和查询：基本</a></li>
                  </ul>
               </div>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>父主题：</strong> <a href="XML-Schema-and-object-relational-XMLType.html#GUID-817F95DE-D604-41DC-BCDE-76CDE30F9176" title="涵盖了XML Schema的使用和XMLType数据的对象关系存储。">XML模式和对象关系XMLType</a></p>
                  </div>
               </div>
            </div>
            <a id="ADXDB4680"></a><div class="props_rev_3"><a id="GUID-98F5058B-852E-48C2-80A5-C5E7068AE0DD" name="GUID-98F5058B-852E-48C2-80A5-C5E7068AE0DD"></a><h3 id="ADXDB-GUID-98F5058B-852E-48C2-80A5-C5E7068AE0DD" class="sect3"><span class="enumeration_section">20.1</span> XML Schema Evolution概述</h3>
               <div>
                  <p>使用XML模式与Oracle XML DB的开发人员面临的主要挑战是如何处理XML文档的内容或结构的变化。在某些环境中，由于新法规，内部需求或外部机会，对变更的需求可能频繁或广泛。</p>
                  <p>例如，您可能需要向XML架构定义添加新元素或属性，修改数据类型，或放松或收紧某些最小和最大出现要求。</p>
                  <p>在这种情况下，您需要“发展”XML模式以满足新要求，同时任何现有实例文档（数据）仍然有效（或可以变为有效），并且现有应用程序可以继续运行。</p>
                  <p>如果您不关心任何现有文档，您当然可以简单地删除依赖于XML模式的<code class="codeph">XMLType</code>表，删除旧的XML模式，并在同一URL上注册新的XML模式。但是，在大多数情况下，您需要保留现有文档，可能会对其进行转换以适应新的XML架构。
                  </p>
                  <p>Oracle XML DB支持两种模式演变：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><span class="bold">基于副本的模式演变</span> ，其中将符合模式的所有实例文档复制到数据库中的临时位置，删除旧模式，注册修改后的模式，并将实例文档从其中插入新位置临时区域</p>
                     </li>
                     <li>
                        <p><span class="bold">就地模式演变</span> ，不需要复制，删除和插入现有数据，因此比基于复制的演变快得多，但其限制不适用于基于复制的演化</p>
                        <p>通常，如果您不更改存储模型并且更改不会使现有文档无效（即，如果现有文档符合新架构或者可以使其符合要求），则允许就地演进。<a href="XML-Schema-evolution.html#GUID-0C97EA66-1890-495D-9117-55FB0D563992" title="就地XML模式演变可以更改XML模式，而无需复制，删除和重新插入现有数据。因此，就地进化比基于复制的进化快得多。然而，就地进化也有一些限制，不适用于基于拷贝的进化。">In-Place XML Schema Evolution中</a>提供了有关限制和指南的更详细说明。
                        </p>
                     </li>
                  </ul>
                  <p>每种方法都有自己的PL / SQL过程： <code class="codeph">DBMS_XMLSCHEMA.copyEvolve</code>用于基于副本的演化， <code class="codeph">DBMS_XMLSCHEMA.inPlaceEvolve</code>用于就地演进。本章解释了每个过程的使用，并提供了使用其相关的模式演化方法的指南。
                  </p>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="XML-Schema-evolution.html#GUID-F2E920B3-C6D7-428B-9E75-5CE9C21F9B5F" title="在向Oracle XML DB注册XML模式后，可以使用XML模式演变来更新XML模式。">XML模式演变</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="ADXDB4681"></a><div class="props_rev_3"><a id="GUID-0E4FC235-D8D1-4F27-85DC-A3DCCC2662AB" name="GUID-0E4FC235-D8D1-4F27-85DC-A3DCCC2662AB"></a><h3 id="ADXDB-GUID-0E4FC235-D8D1-4F27-85DC-A3DCCC2662AB" class="sect3"><span class="enumeration_section">20.2</span>基于复制的模式演变</h3>
               <div>
                  <p>您使用PL / SQL过程<code class="codeph">DBMS_XMLSCHEMA.copyEvolve</code>执行基于副本的XML模式演变。这会将现有实例文档备份到临时<code class="codeph">XMLType</code>表，删除旧版本的XML架构（也会删除关联的实例文档），注册新版本，并将备份的实例文档复制到新的<code class="codeph">XMLType</code>表。
                  </p>
                  <p>如果出现问题，将还原备份副本 - 请参阅<a href="XML-Schema-evolution.html#GUID-8EDAD01C-4791-4458-A0F3-EBFAC3E94D61" title="过程DBMS_XMLSCHEMA.copyEvolve要么完全成功，要么引发错误。如果它引发错误，那么它会尝试回滚尽可能多的操作。">过程DBMS_XMLSCHEMA.COPYEVOLVE引发错误时的回滚</a> 。
                  </p>
                  <p>使用过程<code class="codeph">copyEvolve</code> ，您可以改进已注册的XML模式，使现有的XML实例文档继续有效。
                  </p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="XML-Schema-evolution.html#GUID-AD87A5C3-D0E8-4109-A6B2-F3F673D42FFD">基于副本的进化的场景</a><br>显示了采购订单XML架构的演进版本。它用于说明使用基于副本的XML模式演变的示例中。
                     </li>
                     <li class="ulchildlink"><a href="XML-Schema-evolution.html#GUID-8F38814C-56AE-4021-AF31-AB8A99342C47">COPYEVOLVE参数和错误</a><br>描述了PL / SQL过程<code class="codeph">DBMS_XMLSCHEMA.copyEvolve</code>的参数，以及与此过程相关的错误。
                     </li>
                     <li class="ulchildlink"><a href="XML-Schema-evolution.html#GUID-12760FD2-5A95-49E9-A090-634C2AD18DA5">程序限制COPYEVOLVE</a><br>使用PL / SQL过程<code class="codeph">DBMS_XMLSCHEMA.copyEvolve</code>涉及某些限制。
                     </li>
                     <li class="ulchildlink"><a href="XML-Schema-evolution.html#GUID-52D895D1-BFD2-4DA8-B106-6385E9E7BA0D">使用程序COPYEVOLVE的指南</a><br>介绍了使用PL / SQL过程<code class="codeph">DBMS_XMLSCHEMA.copyEvolve</code>一般准则，以及特定于特定上下文的准则。
                     </li>
                     <li class="ulchildlink"><a href="XML-Schema-evolution.html#GUID-737B8590-6531-44BC-B81B-713466ABC931">使用XSLT样式表更新现有XML实例文档</a><br>修改已注册的XML架构后，必须更新使用该架构的任何现有XML实例文档。您可以通过将XSLT样式表应用于每个实例文档来完成此操作。样式表表示旧XML模式和新XML模式之间的区别。
                     </li>
                     <li class="ulchildlink"><a href="XML-Schema-evolution.html#GUID-977E4919-1072-4A96-B03C-6576A7B98786">使用过程COPYEVOLVE的示例</a><br>提供了几个使用PL / SQL过程<code class="codeph">DBMS_XMLSCHEMA.copyEvolve</code>更新XML模式的示例。（在使用该过程之前，请务必备份所有已注册的XML模式和引用它们的XML文档。）
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="XML-Schema-evolution.html#GUID-F2E920B3-C6D7-428B-9E75-5CE9C21F9B5F" title="在向Oracle XML DB注册XML模式后，可以使用XML模式演变来更新XML模式。">XML模式演变</a></p>
                     </div>
                  </div>
               </div>
               <a id="ADXDB4683"></a><a id="ADXDB4682"></a><div class="props_rev_3"><a id="GUID-AD87A5C3-D0E8-4109-A6B2-F3F673D42FFD" name="GUID-AD87A5C3-D0E8-4109-A6B2-F3F673D42FFD"></a><h4 id="ADXDB-GUID-AD87A5C3-D0E8-4109-A6B2-F3F673D42FFD" class="sect4"><span class="enumeration_section">20.2.1</span>基于副本的进化的场景</h4>
                  <div>
                     <p>显示了采购订单XML架构的演进版本。它用于说明使用基于副本的XML模式演变的示例中。</p>
                     <p><a href="XML-Schema-evolution.html#GUID-AD87A5C3-D0E8-4109-A6B2-F3F673D42FFD__BCGJAFFH">示例20-1</a>示出了<a href="oracle-supplied-XML-schemas-and-examples.html#GUID-1CB2213C-C6E8-4BC4-86A3-EFDE51AEBEFD__BABDAGBF">示例A-2</a>的购买订单XML模式的修订版本的<span class="italic">部分</span>列表。有关<span class="italic">完整</span>修订的模式列表，请参见<a href="oracle-supplied-XML-schemas-and-examples.html#GUID-1CB2213C-C6E8-4BC4-86A3-EFDE51AEBEFD__BABJJIFI">示例A-3</a> 。这里以<span class="bold">粗体显示的</span>文本是新的或与原始模式中的文本不同。
                     </p>
                     <div class="example" id="GUID-AD87A5C3-D0E8-4109-A6B2-F3F673D42FFD__BCGJAFFH">
                        <p class="titleinexample">例20-1修订的采购订单XML模式</p><pre class="oac_no_warn" dir="ltr">&lt;xs：schema xmlns：xs =“http://www.w3.org/2001/XMLSchema”xmlns：xdb =“http://xmlns.oracle.com/xdb”version =“1.0”&gt; &lt;xs：element name =“PurchaseOrder”type =“PurchaseOrderType”xdb：defaultTable =“PURCHASEORDER” <span class="bold">xdb：columnProps =</span> <span class="bold">“CONSTRAINT purchaseorder_pkey PRIMARY KEY（XMLDATA.reference），</span> <span class="bold">CONSTRAINT valid_email_address FOREIGN KEY（XMLDATA.userid）</span> <span class="bold">REFERENCES hr.employees（EMAIL）”</span> xdb ：tableProps =“VARRAY XMLDATA.ACTIONS.ACTION STORE AS TABLE ACTION_TABLE（（CONSTRAINT action_pkey PRIMARY KEY（NESTED_TABLE_ID，SYS_NC_ARRAY_INDEX $）））VARRAY XMLDATA.LINEITEMS.LINEITEM STORE AS TABLE LINEITEM_TABLE（（约束LINEITEM_PKEY主键（NESTED_TABLE_ID，SYS_NC_ARRAY_INDEX $） ））lob（XMLDATA.NOTES）存储为（在行存储中启用存储（初始4K NEXT 32K））“/&gt; &lt;xs：complexType name =”PurchaseOrderType“xdb：SQLType =”PURCHASEORDER_T“&gt; &lt;xs：sequence&gt; &lt;xs ：element name =“Actions”type =“ActionsType”xdb：SQLName =“ACTIONS”/&gt; &lt;xs：element name =“Reject”type =“RejectionType”minOccurs =“0”xdb：SQLName =“REJECTION”/&gt; &lt;xs：element name =“Requestor”type =“RequestorType”xdb：SQLName =“REQUESTOR”/&gt; &lt;xs：element name =“User”type =“UserType”xdb：SQLName =“USERID”/&gt; &lt;xs：element name =“CostCenter”type =“CostCenterType”xdb：SQLName =“COST_CENTER”/&gt; <span class="bold">&lt;xs：element name =“BillingAddress”type =“AddressType”minOccurs =“0”</span> <span class="bold">xdb：SQLName =“BILLING_ADDRESS”/&gt;</span> &lt;xs： element name =“ShippingInstructions”type =“ShippingInstructionsType”xdb：SQLName =“SHIPPING_INSTRUCTIONS”/&gt; &lt;xs：element name =“SpecialInstructions”type =“SpecialInstructionsType”xdb：SQLName =“SPECIAL_INSTRUCTIONS”/&gt; &lt;xs：element name =“ LineItems“type =”LineItemsType“xdb：SQLName =”LINEITEMS“/&gt; <span class="bold">&lt;xs：element name =”Notes“type =”NotesType“minOccurs =”0“xdb：SQLType =”CLOB“</span> <span class="bold">xdb：SQLName =”NOTES“/ &gt;</span> &lt;/ xs：sequence&gt; <span class="bold">&lt;xs：attribute name =“Reference”type =“ReferenceType”use =“required”xdb：SQLName =“REFERENCE”/&gt;</span> &lt;xs：attribute name =“DateCreated”type =“xs：dateTime “use =”required“xdb：SQLType =”TIMESTAMP WITH TIME ZONE“/&gt; &lt;/ xs：complexType&gt; &lt;xs：complexType name =”LineItemsType“xdb：SQLType =”LINEITEM S_T“&gt; &lt;xs：sequence&gt; &lt;xs：element name =”LineItem“type =”LineItemType“maxOccurs =”unbounded“xdb：SQLName =”LINEITEM“xdb：SQLCollType =”LINEITEM_V“/&gt; &lt;/ xs：sequence&gt; &lt; / xs：complexType&gt; &lt;xs：complexType name =“LineItemType”xdb：SQLType =“LINEITEM_T”&gt; &lt;xs：sequence&gt; &lt;xs：element name =“Part”type =“PartType”xdb：SQLName =“PART”/&gt; <span class="bold">&lt;xs：element name =“Quantity”type =“quantityType”/&gt;</span> &lt;/ xs：sequence&gt; &lt;xs：attribute name =“ItemNumber”type =“xs：integer”xdb：SQLName =“ITEMNUMBER”xdb：SQLType =“ NUMBER“/&gt; &lt;/ xs：complexType&gt; &lt;xs：complexType name =”PartType“xdb：SQLType =”PART_T“&gt; <span class="bold">&lt;xs：simpleContent&gt;</span> <span class="bold">&lt;xs：extension base =”UPCCodeType“&gt;</span> <span class="bold">&lt;xs：attribute name =”Description “type =”DescriptionType“use =”required“</span> <span class="bold">xdb：SQLName =”DESCRIPTION“/&gt;</span> <span class="bold">&lt;xs：attribute name =”UnitCost“type =”moneyType“use =”required“/&gt;</span> <span class="bold">&lt;/ xs：extension&gt;</span> <span class="bold">&lt;/ xs ：simpleContent&gt;</span> &lt;/ xs：complexType&gt; &lt;xs：simpleType name =“ReferenceType”&gt; &lt;xs：restriction base =“xs：string”&gt; &lt;xs：minLength value =“18”/&gt; &lt;xs：maxLength value =“30 “/&gt; &lt;/ xs：restriction&gt; &lt;/ xs：simpleType&gt;</pre><pre class="oac_no_warn" dir="ltr"><span class="bold">。 。 。</span>
</pre><pre class="oac_no_warn" dir="ltr">&lt;xs：complexType name =“RejectionType”xdb：SQLType =“REJECTION_T”&gt; &lt;xs：all&gt; &lt;xs：element name =“User”type =“UserType”minOccurs =“0”xdb：SQLName =“REJECTED_BY”/&gt; &lt;xs：element name =“Date”type =“DateType”minOccurs =“0”xdb：SQLName =“DATE_REJECTED”/&gt; &lt;xs：element name =“Comments”type =“CommentsType”minOccurs =“0”xdb：SQLName =“REASON_REJECTED”/&gt; &lt;/ xs：all&gt; &lt;/ xs：complexType&gt; &lt;xs：complexType name =“ShippingInstructionsType”xdb：SQLType =“SHIPPING_INSTRUCTIONS_T”&gt; &lt;xs：sequence&gt; &lt;xs：element name =“name”type =“NameType”minOccurs =“0”xdb：SQLName =“SHIP_TO_NAME”/&gt; <span class="bold">&lt;xs：choice&gt;</span> <span class="bold">&lt;xs：element name =“address”type =“AddressType”minOccurs =“0”/&gt;</span> <span class="bold">&lt;xs：element name = “fullAddress”type =“FullAddressType”minOccurs =“0”</span> <span class="bold">xdb：SQLName =“SHIP_TO_ADDRESS”/&gt;</span> <span class="bold">&lt;/ xs：choice&gt;</span> &lt;xs：element name =“telephone”type =“TelephoneType”minOccurs =“0”xdb：SQLName =“SHIP_TO_PHONE”/&gt; &lt;/ xs：sequence&gt; &lt;/ xs：complexType&gt;</pre><pre class="oac_no_warn" dir="ltr"><span class="bold">。 。 。</span>
</pre><pre class="oac_no_warn" dir="ltr">&lt;xs：simpleType name =“NameType”&gt; &lt;xs：restriction base =“xs：string”&gt; &lt;xs：minLength value =“1”/&gt; &lt;xs：maxLength value =“20”/&gt; &lt;/ xs：restriction&gt; &lt;/ xs：simpleType&gt; <span class="bold">&lt;xs：simpleType name =“FullAddressType”&gt;</span> &lt;xs：restriction base =“xs：string”&gt; &lt;xs：minLength value =“1”/&gt; &lt;xs：maxLength value =“256”/&gt; &lt;/ xs：restriction&gt; &lt;/ xs：simpleType&gt;</pre><pre class="oac_no_warn" dir="ltr"><span class="bold">。 。 。</span>
</pre><pre class="oac_no_warn" dir="ltr">&lt;xs：simpleType name =“DescriptionType”&gt; &lt;xs：restriction base =“xs：string”&gt; &lt;xs：minLength value =“1”/&gt; &lt;xs：maxLength value =“256”/&gt; &lt;/ xs：restriction&gt; &lt;/ xs：simpleType&gt; <span class="bold">&lt;xs：complexType name =“AddressType”xdb：SQLType =“ADDRESS_T”&gt;</span> <span class="bold">&lt;xs：sequence&gt;</span> <span class="bold">&lt;xs：element name =“StreetLine1”type =“StreetType”/&gt;</span> <span class="bold">&lt;xs：element name = “StreetLine2”type =“StreetType”minOccurs =“0”/&gt;</span> <span class="bold">&lt;xs：element name =“City”type =“CityType”/&gt;</span> <span class="bold">&lt;xs：choice&gt;</span> <span class="bold">&lt;xs：sequence&gt;</span> <span class="bold">&lt;xs：element name =“State” type =“StateType”/&gt;</span> <span class="bold">&lt;xs：element name =“ZipCode”type =“ZipCodeType”/&gt;</span> <span class="bold">&lt;/ xs：sequence&gt;</span> <span class="bold">&lt;xs：sequence&gt;</span> <span class="bold">&lt;xs：element name =“Province”type =“ProvinceType”/&gt;</span> <span class="bold">&lt;xs：element name =“PostCode”type =“PostCodeType”/&gt;</span> <span class="bold">&lt;/ xs：sequence&gt;</span> <span class="bold">&lt;xs：sequence&gt;</span> <span class="bold">&lt;xs：element name =“County”type =“CountyType”/&gt;</span> <span class="bold">&lt;xs：element name =“邮政编码“type =”PostCodeType“/&gt;</span> <span class="bold">&lt;/ xs：sequence&gt;</span> <span class="bold">&lt;/ xs：choice&gt;</span> <span class="bold">&lt;xs：element name =”Country“type =”CountryType“/&gt;</span> <span class="bold">&lt;/ xs：sequence&gt;</span> <span class="bold">&lt;/ xs：complexType&gt;</span> <span class="bold">&lt; xs：simpleType name =“StreetType”&gt;</span> <span class="bold">&lt;xs：restriction base =“xs：string”&gt;</span> <span class="bold">&lt;xs：minLength value =“1”/&gt;</span> <span class="bold">&lt;xs：maxLength value =“128”/&gt;</span> <span class="bold">&lt;/ x s：restriction&gt;</span> <span class="bold">&lt;/ xs：simpleType&gt;</span> <span class="bold">&lt;xs：simpleType name =“CityType”&gt;</span> <span class="bold">&lt;xs：restriction base =“xs：string”&gt;</span> <span class="bold">&lt;xs：minLength value =“1”/&gt;</span> <span class="bold">&lt;xs：maxLength value =“ 64“/&gt;</span> <span class="bold">&lt;/ xs：restriction&gt;</span> <span class="bold">&lt;/ xs：simpleType&gt;</span> <span class="bold">&lt;xs：simpleType name =”StateType“&gt;</span> <span class="bold">&lt;xs：restriction base =”xs：string“&gt;</span> <span class="bold">&lt;xs：minLength value =”2“/&gt;</span> <span class="bold">&lt; xs：maxLength value =“2”/&gt;</span> <span class="bold">&lt;xs：枚举值=“AK”/&gt;</span> <span class="bold">&lt;xs：枚举值=“AL”/&gt;</span> <span class="bold">&lt;xs：枚举值=“AR”/&gt;</span>
</pre><pre class="oac_no_warn" dir="ltr"><span class="bold">。 。 。</span> <span class="italic"> - 每个美国州缩写的值</span>
</pre><pre class="oac_no_warn" dir="ltr">      <span class="bold">&lt;xs：enumeration value =“WY”/&gt;</span> <span class="bold">&lt;/ xs：restriction&gt;</span> <span class="bold">&lt;/ xs：simpleType&gt;</span> <span class="bold">&lt;xs：simpleType name =“ZipCodeType”&gt;</span> <span class="bold">&lt;xs：restriction base =“xs：string”&gt;</span> <span class="bold">&lt;xs：pattern value =“\ d {5}”/&gt;</span> <span class="bold">&lt;xs：pattern value =“\ d {5}  -  \ d {4}”/&gt;</span> <span class="bold">&lt;/ xs：restriction&gt;</span> <span class="bold">&lt;/ xs：simpleType&gt;</span> <span class="bold">&lt;xs：simpleType name =“ CountryType“&gt;</span> <span class="bold">&lt;xs：restriction base =”xs：string“&gt;</span> <span class="bold">&lt;xs：minLength value =”1“/&gt;</span> <span class="bold">&lt;xs：maxLength value =”64“/&gt;</span> <span class="bold">&lt;/ xs：restriction&gt;</span> <span class="bold">&lt;/ xs：simpleType&gt;</span> <span class="bold">&lt; xs：simpleType name =“CountyType”&gt;</span> <span class="bold">&lt;xs：restriction base =“xs：string”&gt;</span> <span class="bold">&lt;xs：minLength value =“1”/&gt;</span> <span class="bold">&lt;xs：maxLength value =“32”/&gt;</span> <span class="bold">&lt;/ xs：restriction&gt;</span> <span class="bold">&lt; / xs：simpleType&gt;</span> <span class="bold">&lt;xs：simpleType name =“PostCodeType”&gt;</span> <span class="bold">&lt;xs：restriction base =“xs：string”&gt;</span> <span class="bold">&lt;xs：minLength value =“1”/&gt;</span> <span class="bold">&lt;xs：maxLength value =“12”/&gt;</span> <span class="bold">&lt; / xs：restriction&gt;</span> <span class="bold">&lt;/ xs：simpleType&gt;</span> <span class="bold">&lt;xs：simpleType name =“ProvinceType”&gt;</span> <span class="bold">&lt;xs：restriction base =“xs：string”&gt;</span> <span class="bold">&lt;xs：minLength value =“2”/&gt;</span> <span class="bold">&lt;xs：maxLength value = “2”/&gt;</span> <span class="bold">&lt;/ xs：restriction&gt;</span> <span class="bold">&lt;/ xs：simpleType&gt;</span> <span class="bold">&lt;xs：simpleType name =“NotesType”&gt;</span> <span class="bold">&lt;xs：restriction base =“xs：string”&gt;</span> <span class="bold">&lt;xs：maxLength value =“32767”/&gt;</span> <span class="bold">&lt;/ xs：restriction&gt;</span> <span class="bold">&lt;/ xs：simpleType&gt;</span> <span class="bold">&lt;xs：simple类型名称=“UPCCodeType”&gt;</span> <span class="bold">&lt;xs：restriction base =“xs：string”&gt;</span> <span class="bold">&lt;xs：minLength value =“11”/&gt;</span> <span class="bold">&lt;xs：maxLength value =“14”/&gt;</span> <span class="bold">&lt;xs：pattern value =“\ d {11}“/&gt;</span> <span class="bold">&lt;xs：pattern value =”\ d {12}“/&gt;</span> <span class="bold">&lt;xs：pattern value =”\ d {13}“/&gt;</span> <span class="bold">&lt;xs：pattern value =”\ d {14}“/ &gt;</span> <span class="bold">&lt;/ xs：restriction&gt;</span> <span class="bold">&lt;/ xs：simpleType&gt;</span> &lt;/ xs：schema&gt;</pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="XML-Schema-evolution.html#GUID-0E4FC235-D8D1-4F27-85DC-A3DCCC2662AB" title="您使用PL / SQL过程DBMS_XMLSCHEMA.copyEvolve执行基于副本的XML模式演变。这会将现有实例文档备份到临时XMLType表，删除旧版本的XML架构（也会删除关联的实例文档），注册新版本，并将备份的实例文档复制到新的XMLType表。">基于副本的模式演变</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="ADXDB4685"></a><a id="ADXDB4686"></a><a id="ADXDB4684"></a><div class="props_rev_3"><a id="GUID-8F38814C-56AE-4021-AF31-AB8A99342C47" name="GUID-8F38814C-56AE-4021-AF31-AB8A99342C47"></a><h4 id="ADXDB-GUID-8F38814C-56AE-4021-AF31-AB8A99342C47" class="sect4"><span class="enumeration_section">20.2.2</span> COPYEVOLVE参数和错误</h4>
                  <div>
                     <p>描述了PL / SQL过程<code class="codeph">DBMS_XMLSCHEMA.copyEvolve</code>的参数，以及与此过程相关的错误。
                     </p>
                     <div class="section">
                        <p>这是过程<code class="codeph">DBMS_XMLSCHEMA.copyEvolve</code>的签名：</p><pre class="oac_no_warn" dir="ltr">procedure copyEvolve（schemaURLs IN XDB $ STRING_LIST_T，newSchemas IN XMLSequenceType，转换IN XMLSequenceType：= NULL，preserveOldDocs IN BOOLEAN：= FALSE，mapTabName IN VARCHAR2：= NULL，generateTables IN BOOLEAN：= TRUE，强制IN BOOLEAN：= FALSE，schemaOwners IN XDB $ STRING_LIST_T：= NULL parallelDegree IN PLS_INTEGER：= 0，options IN PLS_INTEGER：= 0）;</pre><p><a href="XML-Schema-evolution.html#GUID-8F38814C-56AE-4021-AF31-AB8A99342C47__BCGJCFHJ" title="此表描述了DBMS_XMLSCHEMA.CopyEvolve参数。">表20-1</a>描述了各个参数。<a href="XML-Schema-evolution.html#GUID-8F38814C-56AE-4021-AF31-AB8A99342C47__BCGGIFAF" title="该表描述了DG&#39;BMS_XMLSCHEMA.copyevolve的错误和异常。它包括采取的原因和行动。">表20-2</a>描述了与该过程相关的错误。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="tblformal" id="GUID-8F38814C-56AE-4021-AF31-AB8A99342C47__BCGJCFHJ">
                        <p class="titleintable">表20-1过程DBMS_XMLSCHEMA.COPYEVOLVE的参数</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="过程DBMS_XMLSCHEMA.COPYEVOLVE的参数" width="100%" border="1" summary="This table describes the DBMS_XMLSCHEMA.CopyEvolve parameters." frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="31%" id="d103278e825">参数</th>
                                 <th align="left" valign="bottom" width="69%" id="d103278e828">描述</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d103278e833" headers="d103278e825 ">
                                    <p><code class="codeph">schemaURLs</code></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d103278e833 d103278e828 ">
                                    <p>要进化的XML模式的URL的变体（varray of <code class="codeph">VARCHAR2(4000)</code> 。这应该包括依赖模式。除非force参数为<code class="codeph">TRUE</code> ，否则URL应该是依赖顺序，也就是说，如果URL A位于varray中的URL B之前，则模式A不应该依赖于模式B，而模式B可能依赖于模式A.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d103278e847" headers="d103278e825 ">
                                    <p><code class="codeph">newSchemas</code></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d103278e847 d103278e828 ">
                                    <p>各种新的XML模式文档（ <code class="codeph">XMLType</code>实例）。以与相应URL完全相同的顺序指定它。如果XML架构中不需要进行任何更改，请提供未更改的架构。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d103278e858" headers="d103278e825 ">
                                    <p><code class="codeph">变换</code></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d103278e858 d103278e828 ">
                                    <p>应用于基于XML模式的文档的XSL文档（ <code class="codeph">XMLType</code>实例）的Varray，以使它们符合新模式。以与相应URL完全相同的顺序指定它们。如果不需要转换，则无需指定此参数。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d103278e869" headers="d103278e825 ">
                                    <p><code class="codeph">preserveOldDocs</code></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d103278e869 d103278e828 ">
                                    <p>如果为<code class="codeph">TRUE</code> ，则在模式演变结束时不会删除包含旧数据的临时表。另请参见<a href="XML-Schema-evolution.html#GUID-52D895D1-BFD2-4DA8-B106-6385E9E7BA0D" title="介绍了使用PL / SQL过程的一般准则DBMS_XMLSCHEMA.copyEvolve，以及特定于特定上下文的准则。">使用过程COPYEVOLVE的准则</a> 。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d103278e889" headers="d103278e825 ">
                                    <p><code class="codeph">mapTabName</code></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d103278e889 d103278e828 ">
                                    <p>指定将旧<code class="codeph">XMLType</code>表或列名映射到相应临时表名称的表的名称。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d103278e900" headers="d103278e825 ">
                                    <p><code class="codeph">generateTables</code></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d103278e900 d103278e828 ">
                                    <p>默认情况下，此参数为<code class="codeph">TRUE</code> 。如果为<code class="codeph">FALSE</code>则在注册新的XML模式后不会生成<code class="codeph">XMLType</code>表或列。如果为<code class="codeph">FALSE</code> ，则<code class="codeph">preserveOldDocs</code>必须为<code class="codeph">TRUE</code>且<code class="codeph">mapTabName</code>不得为<code class="codeph">NULL</code> 。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d103278e933" headers="d103278e825 ">
                                    <p><code class="codeph">力</code></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d103278e933 d103278e828 ">
                                    <p>如果为<code class="codeph">TRUE</code> ，则忽略新模式注册期间的错误。如果模式之间存在循环依赖关系，请将此标志设置为<code class="codeph">TRUE</code>以确保即使注册中可能存在错误，也会存储每个模式。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d103278e947" headers="d103278e825 ">
                                    <p><code class="codeph">schemaOwners</code></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d103278e947 d103278e828 ">
                                    <p>Varray名称的架构所有者。以与相应URL完全相同的顺序指定它们。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d103278e955" headers="d103278e825 ">
                                    <p><code class="codeph">parallelDegree</code></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d103278e955 d103278e828 ">
                                    <p>指定在数据复制阶段在<code class="codeph">PARALLEL</code>提示中使用的<code class="codeph">PARALLEL</code>度。如果此值为<code class="codeph">0</code> （默认值），则数据复制语句中不存在<code class="codeph">PARALLEL</code>提示。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d103278e972" headers="d103278e825 ">
                                    <p><code class="codeph">选项</code></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d103278e972 d103278e828 ">
                                    <p>其他选择。唯一的选择是<code class="codeph">COPYEVOLVE_BINARY_XML</code> ，这意味着为二进制XML数据注册新的XML模式，并使用二进制XML作为存储模型创建新的表或列。
                                    </p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <div class="tblformal" id="GUID-8F38814C-56AE-4021-AF31-AB8A99342C47__BCGGIFAF">
                        <p class="titleintable">表20-2与过程DBMS_XMLSCHEMA.COPYEVOLVE关联的错误</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="与过程DBMS_XMLSCHEMA.COPYEVOLVE关联的错误" width="100%" border="1" summary="This table describes DG‘BMS_XMLSCHEMA.copyevolve’s errors and exceptions. It includes the cause and action to take." frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="29%" id="d103278e993">错误号和消息</th>
                                 <th align="left" valign="bottom" width="35%" id="d103278e996">原因</th>
                                 <th align="left" valign="bottom" width="35%" id="d103278e999">行动</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="29%" id="d103278e1004" headers="d103278e993 ">
                                    <p><span class="bold">30942</span>架构“&lt;schema_url&gt;”表“&lt;owner_name&gt;。&lt;table_name&gt;”列“&lt;column_name&gt;”的XML架构演变错误</p>
                                 </td>
                                 <td align="left" valign="top" width="35%" headers="d103278e1004 d103278e996 ">
                                    <p>符合给定XML模式的给定<code class="codeph">XMLType</code>表或列在进化过程中出错。对于表，列名称为空。另请参阅此后的更具体的错误。
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="35%" headers="d103278e1004 d103278e999 ">
                                    <p>根据此错误中的架构，表和列信息以及随后的更具体的错误，采取纠正措施。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="29%" id="d103278e1019" headers="d103278e993 ">
                                    <p><span class="bold">30943</span> XML Schema'&lt;schema_url&gt;'依赖于XML模式'&lt;schema_url&gt;'</p>
                                 </td>
                                 <td align="left" valign="top" width="35%" headers="d103278e1019 d103278e996 ">
                                    <p>并非所有依赖的XML模式都已指定，或者未按依赖顺序指定模式，即，如果模式S1依赖于模式S，则S必须出现在S1之前。</p>
                                 </td>
                                 <td align="left" valign="top" width="35%" headers="d103278e1019 d103278e999 ">
                                    <p>在模式列表中包含先前未指定的模式或更正指定模式的顺序。然后重试该操作。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="29%" id="d103278e1031" headers="d103278e993 ">
                                    <p><span class="bold">30944</span>回滚XML模式“&lt;schema_url&gt;”表“&lt;owner_name&gt;。&lt;table_name&gt;”column'&lt;column_name&gt;'时出错</p>
                                 </td>
                                 <td align="left" valign="top" width="35%" headers="d103278e1031 d103278e996 ">
                                    <p>在回退XML模式演变期间，符合给定XML模式的给定<code class="codeph">XMLType</code>表或列存在错误。对于表，列名称为空。另请参阅此后的更具体的错误。
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="35%" headers="d103278e1031 d103278e999 ">
                                    <p>根据此错误中的架构，表和列信息以及随后的更具体的错误，采取纠正措施。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="29%" id="d103278e1046" headers="d103278e993 ">
                                    <p><span class="bold">30945</span>无法创建映射表'&lt;table_name&gt;'</p>
                                 </td>
                                 <td align="left" valign="top" width="35%" headers="d103278e1046 d103278e996 ">
                                    <p>在XML模式演变期间无法创建映射表。另请参阅此后的更具体的错误。</p>
                                 </td>
                                 <td align="left" valign="top" width="35%" headers="d103278e1046 d103278e999 ">
                                    <p>确保不存在具有给定名称的表，然后重试该操作。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="29%" id="d103278e1058" headers="d103278e993 ">
                                    <p><span class="bold">30946</span> XML Schema Evolution警告：未清除临时表</p>
                                 </td>
                                 <td align="left" valign="top" width="35%" headers="d103278e1058 d103278e996 ">
                                    <p>在清理临时表时发生架构后发生错误。模式演变是成功的。</p>
                                 </td>
                                 <td align="left" valign="top" width="35%" headers="d103278e1058 d103278e999 ">
                                    <p>如果需要删除临时表，请使用映射表获取临时表名并删除它们。</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="XML-Schema-evolution.html#GUID-0E4FC235-D8D1-4F27-85DC-A3DCCC2662AB" title="您使用PL / SQL过程DBMS_XMLSCHEMA.copyEvolve执行基于副本的XML模式演变。这会将现有实例文档备份到临时XMLType表，删除旧版本的XML架构（也会删除关联的实例文档），注册新版本，并将备份的实例文档复制到新的XMLType表。">基于副本的模式演变</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="ADXDB4687"></a><div class="props_rev_3"><a id="GUID-12760FD2-5A95-49E9-A090-634C2AD18DA5" name="GUID-12760FD2-5A95-49E9-A090-634C2AD18DA5"></a><h4 id="ADXDB-GUID-12760FD2-5A95-49E9-A090-634C2AD18DA5" class="sect4"><span class="enumeration_section">20.2.3</span>程序的限制COPYEVOLVE</h4>
                  <div>
                     <p>使用PL / SQL过程<code class="codeph">DBMS_XMLSCHEMA.copyEvolve</code>涉及某些限制。
                     </p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>不保留索引，触发器，约束，行级安全性（RLS）策略以及与依赖于模式的<code class="codeph">XMLType</code>表相关的其他元数据。这些必须在进化后重新创造。
                           </p>
                        </li>
                        <li>
                           <p>如果更改了顶级元素名称，则在<code class="codeph">copyEvolve</code>完成执行后需要执行其他步骤。请参阅<a href="XML-Schema-evolution.html#GUID-26F70F58-478C-415D-8640-3B17FCEA25EF" title="PL / SQL过程DBMS_XMLSCHEMA.copyEvolve假定顶级元素尚未在新模式中删除，并且其名称尚未更改。如果存在此类更改，则调用过程copyEvolve，并将参数generateTables设置为FALSE，将参数preserveOldDocs设置为TRUE，以便备份文档副本可用。">顶级元素名称更改</a> 。
                           </p>
                        </li>
                        <li>
                           <p>如果存在具有对象类型列的表，并且具有依赖于要进化的任何架构的<code class="codeph">XMLType</code>属性，则不能使用基于复制的演变。例如，请考虑此表：</p><pre class="pre codeblock"><code>CREATE TYPE t1 AS OBJECT（n NUMBER，x XMLType）; CREATE TABLE tab1（e NUMBER，o t1）XMLType COLUMN ox XMLSchema“s1.xsd”ELEMENT“Employee”;</code></pre><p>这假定在URL <code class="codeph">s1.xsd</code>下注册了具有顶级元素<code class="codeph">Employee</code>的XML模式。不可能改进此XML模式，因为具有<code class="codeph">XMLType</code>属性<code class="codeph">x</code>列<code class="codeph">o</code>表<code class="codeph">tab1</code>依赖于XML模式。虽然<code class="codeph">copyEvolve</code>不处理<code class="codeph">XMLType</code>对象属性，但在这种情况下确实会引发错误。
                           </p>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="XML-Schema-evolution.html#GUID-0E4FC235-D8D1-4F27-85DC-A3DCCC2662AB" title="您使用PL / SQL过程DBMS_XMLSCHEMA.copyEvolve执行基于副本的XML模式演变。这会将现有实例文档备份到临时XMLType表，删除旧版本的XML架构（也会删除关联的实例文档），注册新版本，并将备份的实例文档复制到新的XMLType表。">基于副本的模式演变</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="ADXDB4688"></a><div class="props_rev_3"><a id="GUID-52D895D1-BFD2-4DA8-B106-6385E9E7BA0D" name="GUID-52D895D1-BFD2-4DA8-B106-6385E9E7BA0D"></a><h4 id="ADXDB-GUID-52D895D1-BFD2-4DA8-B106-6385E9E7BA0D" class="sect4"><span class="enumeration_section">20.2.4</span>使用程序COPYEVOLVE的指南</h4>
                  <div>
                     <p>介绍了使用PL / SQL过程<code class="codeph">DBMS_XMLSCHEMA.copyEvolve</code>一般准则，以及特定于特定上下文的准则。
                     </p>
                     <p>以下一般准则适用于使用<code class="codeph">copyEvolve</code> 。本节的其余部分描述了在特定情况下也适用的特定指南。
                     </p>
                     <ol>
                        <li>
                           <p>关闭回收站，以防止丢弃的表被复制到它：</p><pre class="pre codeblock"><code>ALTER SESSION SET RECYCLEBIN = off;</code></pre></li>
                        <li id="GUID-52D895D1-BFD2-4DA8-B106-6385E9E7BA0D__CHDDCIBA">
                           <p>确定依赖于要进化的XML模式的XML模式。您可以使用以下查询获取从属XML模式的URL，其中<span class="italic"><code class="codeph">schema_to_be_evolved</code></span>是要进化的模式， <span class="italic"><code class="codeph">owner_of_schema_to_be_evolved</code></span>是其所有者（数据库用户）。
                           </p><pre class="oac_no_warn" dir="ltr">选择dxs。SCHEMA_URL，dxs。来自DBA_DEPENDENCIES的所有者dd，DBA_XML_SCHEMAS dxs WHERE dd。REFERENCED_NAME =（SELECT INT_OBJNAME FROM DBA_XML_SCHEMAS WHERE SCHEMA_URL = <span class="italic">schema_to_be_evolved</span> AND OWNER = <span class="italic">owner_of_schema_to_be_evolved</span> ）AND dxs。INT_OBJNAME = dd。名称;</pre><p>在许多情况下，从属XML模式不需要进行任何更改。但是，如果需要更改依赖的XML模式，那么还必须准备这些XML模式的新版本。</p>
                        </li>
                        <li>
                           <p>如果现有实例文档不符合新的XML模式，则必须提供一个XSL样式表，当应用于实例文档时，将其转换为符合新架构。您必须对步骤<a href="XML-Schema-evolution.html#GUID-52D895D1-BFD2-4DA8-B106-6385E9E7BA0D__CHDDCIBA">2中</a>标识的每个XML架构执行此操作。转换必须处理符合新XML模式中所有顶级元素的文档。
                           </p>
                        </li>
                        <li>
                           <p>调用过程<code class="codeph">DBMS_XMLSCHEMA.copyEvolve</code> ，指定XML模式URL，新模式和转换样式表。
                           </p>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="XML-Schema-evolution.html#GUID-26F70F58-478C-415D-8640-3B17FCEA25EF">顶级元素名称更改</a><br>PL / SQL过程<code class="codeph">DBMS_XMLSCHEMA.copyEvolve</code>假定顶级元素尚未在新模式中删除，并且其名称尚未更改。如果存在此类更改，则调用过程<code class="codeph">copyEvolve</code>并将参数<code class="codeph">generateTables</code>设置为<code class="codeph">FALSE</code> ，将参数<code class="codeph">preserveOldDocs</code>设置为<code class="codeph">TRUE</code> ，以便备份文档副本可用。
                        </li>
                        <li class="ulchildlink"><a href="XML-Schema-evolution.html#GUID-A672BEE9-10BA-4881-8DC2-3CFF0182AC93">用户创建的默认表以外的表的虚拟列</a><br>对于非默认表的表，在基于副本的演变期间不会重新创建您创建的任何虚拟列。如果需要此类列，则将<code class="codeph">copyEvolve</code>参数<code class="codeph">preserveOldDocs</code>设置为<code class="codeph">TRUE</code> ，创建表，并在<code class="codeph">copyEvolve</code>过程完成后复制旧文档。
                        </li>
                        <li class="ulchildlink"><a href="XML-Schema-evolution.html#GUID-FC3DC35A-0BCD-40C8-9300-EFF38F92794F">确保并发会话不使用XML架构和依赖项</a><br>确保在XML模式演变过程中，任何并发会话都不使用要演进的XML模式及其依赖项。
                        </li>
                        <li class="ulchildlink"><a href="XML-Schema-evolution.html#GUID-8EDAD01C-4791-4458-A0F3-EBFAC3E94D61">过程DBMS_XMLSCHEMA.COPYEVOLVE引发错误时回滚</a><br>过程<code class="codeph">DBMS_XMLSCHEMA.copyEvolve</code>要么完全成功，要么引发错误。如果它引发错误，那么它会尝试回滚尽可能多的操作。
                        </li>
                        <li class="ulchildlink"><a href="XML-Schema-evolution.html#GUID-8095D2EB-608D-4FE0-8E91-A37EDDD356F7">权限不足导致回滚失败</a><br>在某些情况下，您无法回滚基于副本的演化操作。例如，如果由于与新XML模式无关的原因导致表创建失败，则无法回滚。
                        </li>
                        <li class="ulchildlink"><a href="XML-Schema-evolution.html#GUID-9D8602A7-07F3-4320-A70A-98AD84061FE8">XML模式演进所需的权限</a><br>为了执行基于副本的XML模式演变，您可能需要多个数据库权限。
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="XML-Schema-evolution.html#GUID-0E4FC235-D8D1-4F27-85DC-A3DCCC2662AB" title="您使用PL / SQL过程DBMS_XMLSCHEMA.copyEvolve执行基于副本的XML模式演变。这会将现有实例文档备份到临时XMLType表，删除旧版本的XML架构（也会删除关联的实例文档），注册新版本，并将备份的实例文档复制到新的XMLType表。">基于副本的模式演变</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="ADXDB4689"></a><div class="props_rev_3"><a id="GUID-26F70F58-478C-415D-8640-3B17FCEA25EF" name="GUID-26F70F58-478C-415D-8640-3B17FCEA25EF"></a><h5 id="ADXDB-GUID-26F70F58-478C-415D-8640-3B17FCEA25EF" class="sect5"><span class="enumeration_section">20.2.4.1</span>顶级元素名称更改</h5>
                     <div>
                        <p>PL / SQL过程<code class="codeph">DBMS_XMLSCHEMA.copyEvolve</code>假定顶级元素尚未在新模式中删除，并且其名称尚未更改。如果存在此类更改，则调用过程<code class="codeph">copyEvolve</code>并将参数<code class="codeph">generateTables</code>设置为<code class="codeph">FALSE</code> ，将参数<code class="codeph">preserveOldDocs</code>设置为<code class="codeph">TRUE</code> ，以便备份文档副本可用。
                        </p>
                        <p>使用这些参数值时，不会生成新表，并且在过程结束时不会删除包含旧文档（备份副本）的临时表。然后，您可以以适当的任何形式存储旧文档，并删除临时表。有关使用这些参数的更多详细信息，请参见<a href="XML-Schema-evolution.html#GUID-8F38814C-56AE-4021-AF31-AB8A99342C47" title="描述了PL / SQL过程DBMS_XMLSCHEMA.copyEvolve的参数，以及与此过程相关的错误。">COPYEVOLVE参数和错误</a> 。
                        </p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="XML-Schema-evolution.html#GUID-52D895D1-BFD2-4DA8-B106-6385E9E7BA0D" title="介绍了使用PL / SQL过程的一般准则DBMS_XMLSCHEMA.copyEvolve，以及特定于特定上下文的准则。">使用过程COPYEVOLVE的准则</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="ADXDB4690"></a><div class="props_rev_3"><a id="GUID-A672BEE9-10BA-4881-8DC2-3CFF0182AC93" name="GUID-A672BEE9-10BA-4881-8DC2-3CFF0182AC93"></a><h5 id="ADXDB-GUID-A672BEE9-10BA-4881-8DC2-3CFF0182AC93" class="sect5"><span class="enumeration_section">20.2.4.2除</span>默认表之外的表的用户创建的虚拟列</h5>
                     <div>
                        <p>对于非默认表的表，在基于副本的演变期间不会重新创建您创建的任何虚拟列。如果需要此类列，则将<code class="codeph">copyEvolve</code>参数<code class="codeph">preserveOldDocs</code>设置为<code class="codeph">TRUE</code> ，创建表，并在<code class="codeph">copyEvolve</code>过程完成后复制旧文档。
                        </p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="XML-Schema-evolution.html#GUID-52D895D1-BFD2-4DA8-B106-6385E9E7BA0D" title="介绍了使用PL / SQL过程的一般准则DBMS_XMLSCHEMA.copyEvolve，以及特定于特定上下文的准则。">使用过程COPYEVOLVE的准则</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="ADXDB4691"></a><div class="props_rev_3"><a id="GUID-FC3DC35A-0BCD-40C8-9300-EFF38F92794F" name="GUID-FC3DC35A-0BCD-40C8-9300-EFF38F92794F"></a><h5 id="ADXDB-GUID-FC3DC35A-0BCD-40C8-9300-EFF38F92794F" class="sect5"><span class="enumeration_section">20.2.4.3</span>确保并发会话不使用XML模式和依赖项</h5>
                     <div>
                        <p>确保在XML模式演变过程中，任何并发会话都不使用要演进的XML模式及其依赖项。</p>
                        <p>如果其他并发会话在演进过程开始时在此架构上共享锁，则过程<code class="codeph">DBMS_XMLSCHEMA.copyEvolve</code>会等待这些会话释放锁，以便它可以获取独占锁。但是，此锁定会立即释放，以允许其余进程继续。
                        </p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="XML-Schema-evolution.html#GUID-52D895D1-BFD2-4DA8-B106-6385E9E7BA0D" title="介绍了使用PL / SQL过程的一般准则DBMS_XMLSCHEMA.copyEvolve，以及特定于特定上下文的准则。">使用过程COPYEVOLVE的准则</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="ADXDB4692"></a><div class="props_rev_3"><a id="GUID-8EDAD01C-4791-4458-A0F3-EBFAC3E94D61" name="GUID-8EDAD01C-4791-4458-A0F3-EBFAC3E94D61"></a><h5 id="ADXDB-GUID-8EDAD01C-4791-4458-A0F3-EBFAC3E94D61" class="sect5"><span class="enumeration_section">20.2.4.4</span>过程DBMS_XMLSCHEMA.COPYEVOLVE引发错误时回滚</h5>
                     <div>
                        <p>过程<code class="codeph">DBMS_XMLSCHEMA.copyEvolve</code>要么完全成功，要么引发错误。如果它引发错误，那么它会尝试回滚尽可能多的操作。
                        </p>
                        <p>演进XML模式涉及许多数据库DDL语句。发生错误时，将执行补偿DDL语句以撤消执行到该点的所有步骤的效果。如果已删除旧表或模式，则会重新创建它们，但是任何表，列和存储属性以及与表和列关联的任何辅助结构（如索引，触发器，约束和RLS策略）都将丢失。</p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="XML-Schema-evolution.html#GUID-52D895D1-BFD2-4DA8-B106-6385E9E7BA0D" title="介绍了使用PL / SQL过程的一般准则DBMS_XMLSCHEMA.copyEvolve，以及特定于特定上下文的准则。">使用过程COPYEVOLVE的准则</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="ADXDB4693"></a><div class="props_rev_3"><a id="GUID-8095D2EB-608D-4FE0-8E91-A37EDDD356F7" name="GUID-8095D2EB-608D-4FE0-8E91-A37EDDD356F7"></a><h5 id="ADXDB-GUID-8095D2EB-608D-4FE0-8E91-A37EDDD356F7" class="sect5"><span class="enumeration_section">20.2.4.5</span>权限不足<span class="enumeration_section">导致</span>回滚失败</h5>
                     <div>
                        <p>在某些情况下，您无法回滚基于副本的演化操作。例如，如果由于与新XML模式无关的原因导致表创建失败，则无法回滚。</p>
                        <p>一个例子是由于权限不足导致的失败。即使<code class="codeph">preserveOldDocs</code>为<code class="codeph">FALSE</code> ，也不会删除临时表，因此可以恢复数据。如果<code class="codeph">mapTabName</code>参数为null，则映射表名称为<code class="codeph">XDB$MAPTAB</code>后跟序列号。可以使用如下查询找到确切的表名：</p><pre class="pre codeblock"><code>SELECT TABLE_NAME FROM USER_TABLES WHERE TABLE_NAME LIKE'XDB $ MAPTAB <span class="bold">％</span> ';</code></pre></div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="XML-Schema-evolution.html#GUID-52D895D1-BFD2-4DA8-B106-6385E9E7BA0D" title="介绍了使用PL / SQL过程的一般准则DBMS_XMLSCHEMA.copyEvolve，以及特定于特定上下文的准则。">使用过程COPYEVOLVE的准则</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="ADXDB4694"></a><div class="props_rev_3"><a id="GUID-9D8602A7-07F3-4320-A70A-98AD84061FE8" name="GUID-9D8602A7-07F3-4320-A70A-98AD84061FE8"></a><h5 id="ADXDB-GUID-9D8602A7-07F3-4320-A70A-98AD84061FE8" class="sect5"><span class="enumeration_section">20.2.4.6</span> XML模式演进所需的权限</h5>
                     <div>
                        <p>为了执行基于副本的XML模式演变，您可能需要多个数据库权限。</p>
                        <p>基于副本的XML模式演变可能涉及删除或创建SQL数据类型，因此您需要与类型相关的权限，例如<code class="codeph">DROP TYPE</code> ， <code class="codeph">CREATE TYPE</code>和<code class="codeph">ALTER TYPE</code> 。您需要权限才能删除和注册演变中涉及的XML模式。您需要符合正在演变的模式的<code class="codeph">XMLType</code>表的所有特权。对于<code class="codeph">XMLType</code>列，相应表上需要<code class="codeph">ALTER TABLE</code>权限。如果其他数据库模式中存在基于模式的<code class="codeph">XMLType</code>表或列，则需要以下特权：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">创建任何表</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">创造任何指数</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">选择任何表格</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">读一个表</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">更新任何表格</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">插入任何表</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">删除任何表格</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">DROP ANY TABLE</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">更改任何表格</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">DROP ANY INDEX</code></p>
                           </li>
                        </ul>
                        <p>为避免需要将所有这些权限授予数据库模式所有者，Oracle建议数据库管理员执行演进，前提是存在基于XML模式的<code class="codeph">XMLType</code>表或属于其他数据库模式的列。
                        </p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="XML-Schema-evolution.html#GUID-52D895D1-BFD2-4DA8-B106-6385E9E7BA0D" title="介绍了使用PL / SQL过程的一般准则DBMS_XMLSCHEMA.copyEvolve，以及特定于特定上下文的准则。">使用过程COPYEVOLVE的准则</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div><a id="ADXDB4696"></a><a id="ADXDB4695"></a><div class="props_rev_3"><a id="GUID-737B8590-6531-44BC-B81B-713466ABC931" name="GUID-737B8590-6531-44BC-B81B-713466ABC931"></a><h4 id="ADXDB-GUID-737B8590-6531-44BC-B81B-713466ABC931" class="sect4"><span class="enumeration_section">20.2.5</span>使用XSLT样式表更新现有XML实例文档</h4>
                  <div>
                     <p>修改已注册的XML架构后，必须更新使用该架构的任何现有XML实例文档。您可以通过将XSLT样式表应用于每个实例文档来完成此操作。样式表表示旧XML模式和新XML模式之间的区别。</p>
                     <p><a href="XML-Schema-evolution.html#GUID-737B8590-6531-44BC-B81B-713466ABC931__BCGGIEFI">例20-2</a>显示了文件<code class="codeph">evolvePurchaseOrder.xsl</code>中的XSLT样式表，它转换了使用旧XML模式的现有采购订单文档，因此它们使用新的XML模式。
                     </p>
                     <div class="example" id="GUID-737B8590-6531-44BC-B81B-713466ABC931__BCGGIEFI">
                        <p class="titleinexample">例20-2 evolvePurchaseOrder.xsl：用于更新实例文档的XSLT样式表</p><pre class="pre codeblock"><code>&lt;？xml version =“1.0”encoding =“UTF-8”？&gt; &lt;xsl：stylesheet version =“1.0”xmlns：xsl =“http://www.w3.org/1999/XSL/Transform”xmlns：xsi =“http://www.w3.org/2001/XMLSchema- instance“&gt; &lt;xsl：output method =”xml“encoding =”UTF-8“/&gt; &lt;xsl：template match =”/ PurchaseOrder“&gt; &lt;PurchaseOrder&gt; &lt;xsl：attribute name =”xsi：noNamespaceSchemaLocation“&gt; http：/ /localhost:8080/source/schemas/poSource/xsd/purchaseOrder.xsd &lt;/ xsl：attribute&gt; &lt;xsl：for-each select =“Reference”&gt; &lt;xsl：attribute name =“Reference”&gt; &lt;xsl：value-of select =“。”/&gt; &lt;/ xsl：attribute&gt; &lt;/ xsl：for-each&gt; &lt;xsl：variable name =“V264_394”select =“'2004-01-01T12：00：00.000000-08：00'”/ &gt; &lt;xsl：attribute name =“DateCreated”&gt; &lt;xsl：value-of select =“$ V264_394”/&gt; &lt;/ xsl：attribute&gt; &lt;xsl：for-each select =“Actions”&gt; &lt;Actions&gt; &lt;xsl：for -each select =“Action”&gt; &lt;Action&gt; &lt;xsl：for-each select =“User”&gt; &lt;User&gt; &lt;xsl：value-of select =“。”/&gt; &lt;/ User&gt; &lt;/ xsl：for-each &gt; &lt;xsl：for-each select =“Date”&gt; &lt;Date&gt; &lt;xsl：value-of select =“。”/&gt; &lt;/ Date&gt; &lt;/ xsl：for-each&gt; &lt;/ Action&gt; &lt;/ xsl：for -each&gt; &lt;/ Actions&gt; &lt;/ xsl：for-each&gt; &lt;xsl：for-each select =“Reject” &gt; &lt;拒绝&gt; &lt;xsl：for-each select =“User”&gt; &lt;User&gt; &lt;xsl：value-of select =“。”/&gt; &lt;/ User&gt; &lt;/ xsl：for-each&gt; &lt;xsl：for-each select =“Date”&gt; &lt;Date&gt; &lt;xsl：value-of select =“。”/&gt; &lt;/ Date&gt; &lt;/ xsl：for-each&gt; &lt;xsl：for-each select =“Comments”&gt; &lt;Comments&gt; &lt; xsl：value-of select =“。”/&gt; &lt;/ Comments&gt; &lt;/ xsl：for-each&gt; &lt;/ Reject&gt; &lt;/ xsl：for-each&gt; &lt;xsl：for-each select =“Requestor”&gt; &lt;Requestor &gt; &lt;xsl：value-of select =“。”/&gt; &lt;/ Requestor&gt; &lt;/ xsl：for-each&gt; &lt;xsl：for-each select =“User”&gt; &lt;User&gt; &lt;xsl：value-of select =“ 。“/&gt; &lt;/ User&gt; &lt;/ xsl：for-each&gt; &lt;xsl：for-each select =”CostCenter“&gt; &lt;CostCenter&gt; &lt;xsl：value-of select =”。“/&gt; &lt;/ CostCenter&gt; &lt;/ xsl：for-each&gt; &lt;ShippingInstructions&gt; &lt;xsl：for-each select =“ShippingInstructions”&gt; &lt;xsl：for-each select =“name”&gt; &lt;name&gt; &lt;xsl：value-of select =“。”/&gt; &lt; / name&gt; &lt;/ xsl：for-each&gt; &lt;/ xsl：for-each&gt; &lt;xsl：for-each select =“ShippingInstructions”&gt; &lt;xsl：for-each select =“address”&gt; &lt;fullAddress&gt; &lt;xsl：value -of select =“。”/&gt; &lt;/ fullAddress&gt; &lt;/ xsl：for-each&gt; &lt;/ xsl：for-each&gt; &lt;xsl：for-each select =“ShippingInstructions”&gt; &lt;xsl：for-each s elect =“telephone”&gt; &lt;telephone&gt; &lt;xsl：value-of select =“。”/&gt; &lt;/ telephone&gt; &lt;/ xsl：for-each&gt; &lt;/ xsl：for-each&gt; &lt;/ ShippingInstructions&gt; &lt;xsl：for -each select =“SpecialInstructions”&gt; &lt;SpecialInstructions&gt; &lt;xsl：value-of select =“。”/&gt; &lt;/ SpecialInstructions&gt; &lt;/ xsl：for-each&gt; &lt;xsl：for-each select =“LineItems”&gt; &lt;LineItems &gt; &lt;xsl：for-each select =“LineItem”&gt; &lt;xsl：variable name =“V22”select =“。”/&gt; &lt;LineItem&gt; &lt;xsl：for-each select =“@ ItemNumber”&gt; &lt;xsl：attribute name =“ItemNumber”&gt; &lt;xsl：value-of select =“。”/&gt; &lt;/ xsl：attribute&gt; &lt;/ xsl：for-each&gt; &lt;xsl：for-each select =“$ V22 / Part”&gt; &lt;xsl：变量名=“V24”select =“。”/&gt; &lt;xsl：for-each select =“@ Id”&gt; &lt;Part&gt; &lt;xsl：for-each select =“$ V22 / Description”&gt; &lt;xsl：attribute name = “Description”&gt; &lt;xsl：value-of select =“。”/&gt; &lt;/ xsl：attribute&gt; &lt;/ xsl：for-each&gt; &lt;xsl：for-each select =“$ V24 / @ UnitPrice”&gt; &lt;xsl： attribute name =“UnitCost”&gt; &lt;xsl：value-of select =“。”/&gt; &lt;/ xsl：attribute&gt; &lt;/ xsl：for-each&gt; &lt;xsl：value-of select =“。”/&gt; &lt;/ Part &gt; &lt;/ xsl：for-each&gt; &lt;/ xsl：for-each&gt; &lt;xsl：for-each select =“$ V22 / Part”&gt; &lt;xsl：fo r-each select =“@ Quantity”&gt; &lt;Quantity&gt; &lt;xsl：value-of select =“。”/&gt; &lt;/ Quantity&gt; &lt;/ xsl：for-each&gt; &lt;/ xsl：for-each&gt; &lt;/ LineItem&gt; &lt;/ xsl：for-each&gt; &lt;/ LineItems&gt; &lt;/ xsl：for-each&gt; &lt;/ PurchaseOrder&gt; &lt;/ xsl：template&gt; &lt;/ xsl：stylesheet&gt;</code></pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="XML-Schema-evolution.html#GUID-0E4FC235-D8D1-4F27-85DC-A3DCCC2662AB" title="您使用PL / SQL过程DBMS_XMLSCHEMA.copyEvolve执行基于副本的XML模式演变。这会将现有实例文档备份到临时XMLType表，删除旧版本的XML架构（也会删除关联的实例文档），注册新版本，并将备份的实例文档复制到新的XMLType表。">基于副本的模式演变</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="ADXDB4701"></a><a id="ADXDB4702"></a><a id="ADXDB4703"></a><a id="ADXDB4699"></a><a id="ADXDB4700"></a><a id="ADXDB4698"></a><div class="props_rev_3"><a id="GUID-977E4919-1072-4A96-B03C-6576A7B98786" name="GUID-977E4919-1072-4A96-B03C-6576A7B98786"></a><h4 id="ADXDB-GUID-977E4919-1072-4A96-B03C-6576A7B98786" class="sect4"><span class="enumeration_section">20.2.6</span>使用过程COPYEVOLVE的示例</h4>
                  <div>
                     <p>提供了几个使用PL / SQL过程<code class="codeph">DBMS_XMLSCHEMA.copyEvolve</code>更新XML模式的示例。（在使用该过程之前，请务必备份所有已注册的XML模式和引用它们的XML文档。）
                     </p>
                     <div class="section">
                        <p><a href="XML-Schema-evolution.html#GUID-977E4919-1072-4A96-B03C-6576A7B98786__BCGBIBHG">例20-3</a>将修订的XML模式和evolution XSL样式表加载到Oracle XML DB Repository中。
                        </p>
                        <p><a href="XML-Schema-evolution.html#GUID-977E4919-1072-4A96-B03C-6576A7B98786__BCGFEAFB">实施例20-4</a>显示了如何使用过程<code class="codeph">DBMS_XMLSCHEMA.copyEvolve</code>进化XML模式<code class="codeph">purchaseOrder.xsd</code>到<code class="codeph">revisedPurchaseOrder.xsd</code>使用XSLT样式表<code class="codeph">evolvePurchaseOrder.xsl</code> 。
                        </p>
                        <p>过程<code class="codeph">DBMS_XMLSCHEMA.copyEvolve</code>以现有实例文档继续有效的方式演化已注册的XML模式。
                        </p>
                        <div class="infoboxnote" id="GUID-977E4919-1072-4A96-B03C-6576A7B98786__GUID-F44084BE-2EB5-4245-BCD8-2661F498C13F">
                           <p class="notep1">警告：</p>
                           <p>在执行<code class="codeph">DBMS_XMLSCHEMA.copyEvolve</code>过程之前，始终<span class="italic">备份</span>所有已注册的XML模式以及符合它们的所有XML文档。过程<code class="codeph">copyEvolve</code> <span class="italic">删除</span>符合已注册XML模式的所有文档。
                           </p>
                        </div>
                        <p>首先，过程<code class="codeph">copyEvolve</code>将基于XML模式的<code class="codeph">XMLType</code>表和列中的数据复制到临时表。然后删除原始表和列，并删除旧的XML模式。注册新的XML模式后，它会创建<code class="codeph">XMLType</code>表和列并使用数据填充它们（除非参数<code class="codeph">GENTABLES</code>为<code class="codeph">FALSE</code> ），但它不会创建任何辅助结构，例如索引，约束，触发器和行级安全性（RLS）策略。过程<code class="codeph">copyEvolve</code>创建表和列，如下所示：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p>它在注册新模式时创建默认表。</p>
                           </li>
                           <li>
                              <p>它使用以下形式的语句创建不是默认表的表：</p><pre class="oac_no_warn" dir="ltr">创建的XMLType OID <span class="italic">'OID'</span> XMLSCHEMA <span class="italic">schema_url</span>元<span class="italic">ELEMENT_NAME</span>表<span class="italic">TABLE_NAME</span>
</pre><p>其中<span class="italic"><code class="codeph">OID</code></span>是表的原始OID，在删除之前。
                              </p>
                           </li>
                           <li>
                              <p>它使用以下形式的语句添加<code class="codeph">XMLType</code>列：</p><pre class="oac_no_warn" dir="ltr">ALTER TABLE <span class="italic">table_name</span> ADD（ <span class="italic">column_name</span> XMLType）XMLType COLUMN <span class="italic">column_name</span> XMLSCHEMA <span class="italic">schema_url</span> ELEMENT <span class="italic">element_name</span>
</pre></li>
                        </ul>
                        <p>注册新的XML模式时，如果相应的旧模式的注册生成了类型，则会生成类型。如果XML模式在演化之前是全局的，那么它在演化之后也是全局的。类似地，如果XML模式在演化之前是本地的，那么它在演化之后也是本地的（由同一用户拥有）。通过将参数<code class="codeph">preserveOldDocs</code>设置为<code class="codeph">TRUE</code> ，您可以选择保留包含旧文档的临时表。所有临时表都是在当前用户的数据库模式中创建的。对于<code class="codeph">XMLType</code>表，临时表具有<a href="XML-Schema-evolution.html#GUID-977E4919-1072-4A96-B03C-6576A7B98786__BCGDADHA" title="此表描述了XML Schema evolution XMLType表的临时表列，包括列名和类型。">表20-3中</a>所示的列。
                        </p>
                        <div class="tblformal" id="GUID-977E4919-1072-4A96-B03C-6576A7B98786__BCGDADHA">
                           <p class="titleintable">表20-3 XML架构演变：XMLType表临时表列</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="XML Schema Evolution：XMLType表临时表列" width="100%" border="1" summary="This table describes XML Schema evolution XMLType tables’ temporary table columns, including the column name and type." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="31%" id="d103278e1971">名称</th>
                                    <th align="left" valign="bottom" width="17%" id="d103278e1974">类型</th>
                                    <th align="left" valign="bottom" width="53%" id="d103278e1977">评论</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d103278e1982" headers="d103278e1971 ">
                                       <p><code class="codeph">数据</code></p>
                                    </td>
                                    <td align="left" valign="top" width="17%" headers="d103278e1982 d103278e1974 ">
                                       <p><code class="codeph">CLOB</code></p>
                                    </td>
                                    <td align="left" valign="top" width="53%" headers="d103278e1982 d103278e1977 ">
                                       <p>来自旧表的XML文档，采用<code class="codeph">CLOB</code>格式。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d103278e1997" headers="d103278e1971 ">
                                       <p><code class="codeph">OID</code></p>
                                    </td>
                                    <td align="left" valign="top" width="17%" headers="d103278e1997 d103278e1974 ">
                                       <p><code class="codeph">RAW（16）</code></p>
                                    </td>
                                    <td align="left" valign="top" width="53%" headers="d103278e1997 d103278e1977 ">
                                       <p>旧表中相应行的<code class="codeph">OID</code> 。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d103278e2011" headers="d103278e1971 ">
                                       <p><code class="codeph">ACLOID</code></p>
                                    </td>
                                    <td align="left" valign="top" width="17%" headers="d103278e2011 d103278e1974 ">
                                       <p><code class="codeph">RAW（16）</code></p>
                                    </td>
                                    <td align="left" valign="top" width="53%" headers="d103278e2011 d103278e1977 ">
                                       <p>仅当旧表启用了层次结构时，才会显示此列。旧表中相应行的<code class="codeph">ACLOID</code> 。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d103278e2026" headers="d103278e1971 ">
                                       <p><code class="codeph">OWNERID</code></p>
                                    </td>
                                    <td align="left" valign="top" width="17%" headers="d103278e2026 d103278e1974 ">
                                       <p><code class="codeph">RAW（16）</code></p>
                                    </td>
                                    <td align="left" valign="top" width="53%" headers="d103278e2026 d103278e1977 ">
                                       <p>仅当旧表启用了层次结构时，才会显示此列。旧表中相应行的<code class="codeph">OWNERID</code> 。
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                        <p>对于<code class="codeph">XMLType</code>列，临时表具有<a href="XML-Schema-evolution.html#GUID-977E4919-1072-4A96-B03C-6576A7B98786__BCGIJHAH" title="此表描述XML模式演变XMLType列的临时表列。">表20-4中</a>所示的列。
                        </p>
                        <div class="tblformal" id="GUID-977E4919-1072-4A96-B03C-6576A7B98786__BCGIJHAH">
                           <p class="titleintable">表20-4 XML架构演变：XMLType列临时表列</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="XML Schema Evolution：XMLType列临时表列" width="100%" border="1" summary="This table describes the XML schema evolution XMLType columns’ temporary table columns." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="31%" id="d103278e2061">名称</th>
                                    <th align="left" valign="bottom" width="17%" id="d103278e2064">类型</th>
                                    <th align="left" valign="bottom" width="52%" id="d103278e2067">评论</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d103278e2072" headers="d103278e2061 ">
                                       <p><code class="codeph">数据</code></p>
                                    </td>
                                    <td align="left" valign="top" width="17%" headers="d103278e2072 d103278e2064 ">
                                       <p><code class="codeph">CLOB</code></p>
                                    </td>
                                    <td align="left" valign="top" width="52%" headers="d103278e2072 d103278e2067 ">
                                       <p>来自旧列的XML文档，采用<code class="codeph">CLOB</code>格式。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d103278e2087" headers="d103278e2061 ">
                                       <p><code class="codeph">RID</code></p>
                                    </td>
                                    <td align="left" valign="top" width="17%" headers="d103278e2087 d103278e2064 ">
                                       <p><code class="codeph">ROWID</code></p>
                                    </td>
                                    <td align="left" valign="top" width="52%" headers="d103278e2087 d103278e2067 ">
                                       <p>包含此列的表中相应行的<code class="codeph">ROWID</code> 。
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                        <p>过程<code class="codeph">copyEvolve</code>将有关映射的信息从旧表或列名存储到参数<code class="codeph">mapTabName</code>指定的单独表中的相应临时表名。如果<code class="codeph">preserveOldDocs</code>为<code class="codeph">TRUE</code> ，则<code class="codeph">mapTabName</code>参数不能为<code class="codeph">NULL</code> ，并且它不能是当前数据库模式中任何现有表的名称。映射表中的每一行都包含有关旧表/列之一的信息。<a href="XML-Schema-evolution.html#GUID-977E4919-1072-4A96-B03C-6576A7B98786__BCGJADCF" title="此表描述了CopyEvolve过程对XML模式演变的映射。">表20-5</a>显示了映射表列。
                        </p>
                        <div class="tblformal" id="GUID-977E4919-1072-4A96-B03C-6576A7B98786__BCGJADCF">
                           <p class="titleintable">表20-5过程COPYEVOLVE映射表</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="过程COPYEVOLVE映射表" width="100%" border="1" summary="This table describes the mapping of the CopyEvolve procedure for XML schema evolution." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="31%" id="d103278e2137">列名称</th>
                                    <th align="left" valign="bottom" width="26%" id="d103278e2140">列类型</th>
                                    <th align="left" valign="bottom" width="43%" id="d103278e2143">评论</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d103278e2148" headers="d103278e2137 ">
                                       <p><code class="codeph">SCHEMA_URL</code></p>
                                    </td>
                                    <td align="left" valign="top" width="26%" headers="d103278e2148 d103278e2140 ">
                                       <p><code class="codeph">VARCHAR2（700）</code></p>
                                    </td>
                                    <td align="left" valign="top" width="43%" headers="d103278e2148 d103278e2143 ">
                                       <p>此表或列符合的架构的URL。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d103278e2160" headers="d103278e2137 ">
                                       <p><code class="codeph">SCHEMA_OWNER</code></p>
                                    </td>
                                    <td align="left" valign="top" width="26%" headers="d103278e2160 d103278e2140 ">
                                       <p><code class="codeph">VARCHAR2（30）</code></p>
                                    </td>
                                    <td align="left" valign="top" width="43%" headers="d103278e2160 d103278e2143 ">
                                       <p>架构的所有者。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d103278e2172" headers="d103278e2137 ">
                                       <p><code class="codeph">ELEMENT_NAME</code></p>
                                    </td>
                                    <td align="left" valign="top" width="26%" headers="d103278e2172 d103278e2140 ">
                                       <p><code class="codeph">VARCHAR2（256）</code></p>
                                    </td>
                                    <td align="left" valign="top" width="43%" headers="d103278e2172 d103278e2143 ">
                                       <p>此表或列符合的元素。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d103278e2184" headers="d103278e2137 ">
                                       <p><code class="codeph">TABLE_NAME</code></p>
                                    </td>
                                    <td align="left" valign="top" width="26%" headers="d103278e2184 d103278e2140 ">
                                       <p><code class="codeph">VARCHAR2（65）</code></p>
                                    </td>
                                    <td align="left" valign="top" width="43%" headers="d103278e2184 d103278e2143 ">
                                       <p>表的限定名称（ <code class="codeph">&lt;owner_name&gt;.&lt;table_name&gt;</code> ）。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d103278e2199" headers="d103278e2137 ">
                                       <p><code class="codeph">TABLE_OID</code></p>
                                    </td>
                                    <td align="left" valign="top" width="26%" headers="d103278e2199 d103278e2140 ">
                                       <p><code class="codeph">RAW（16）</code></p>
                                    </td>
                                    <td align="left" valign="top" width="43%" headers="d103278e2199 d103278e2143 ">
                                       <p>表的<code class="codeph">OID</code> 。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d103278e2213" headers="d103278e2137 ">
                                       <p><code class="codeph">COLUMN_NAME</code></p>
                                    </td>
                                    <td align="left" valign="top" width="26%" headers="d103278e2213 d103278e2140 ">
                                       <p><code class="codeph">VARCHAR2（4000）</code></p>
                                    </td>
                                    <td align="left" valign="top" width="43%" headers="d103278e2213 d103278e2143 ">
                                       <p>列的名称（ <code class="codeph">XMLType</code>表的<code class="codeph">NULL</code> ）。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d103278e2231" headers="d103278e2137 ">
                                       <p><code class="codeph">TEMP_TABNAME</code></p>
                                    </td>
                                    <td align="left" valign="top" width="26%" headers="d103278e2231 d103278e2140 ">
                                       <p><code class="codeph">VARCHAR2（30）</code></p>
                                    </td>
                                    <td align="left" valign="top" width="43%" headers="d103278e2231 d103278e2143 ">
                                       <p>保存此表或列的数据的临时表的名称。</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                        <p>通过将参数<code class="codeph">GENTABLES</code>设置为<code class="codeph">FALSE</code>可以在注册新XML模式后避免生成任何表或列。如果<code class="codeph">GENTABLES</code>为<code class="codeph">FALSE</code> ，则参数<code class="codeph">PRESERVEOLDDOCS</code>必须为<code class="codeph">TRUE</code>且参数<code class="codeph">MAPTABNAME</code>不能为<code class="codeph">NULL</code> 。这可确保旧表中的数据不会丢失。如果您不希望通过过程创建表，这将非常有用，如<a href="XML-Schema-evolution.html#GUID-8F38814C-56AE-4021-AF31-AB8A99342C47" title="The parameters of PL/SQL procedure DBMS_XMLSCHEMA.copyEvolve are described, as are the errors associated with this procedure.">COPYEVOLVE参数和错误</a>一节中<a href="XML-Schema-evolution.html#GUID-8F38814C-56AE-4021-AF31-AB8A99342C47" title="描述了PL / SQL过程DBMS_XMLSCHEMA.copyEvolve的参数，以及与此过程相关的错误。">所述</a> 。
                        </p>
                        <p>默认情况下，假定所有XML模式都归当前用户所有。如果不是这样，则必须在<code class="codeph">schemaOwners</code>参数中指定每个XML模式的<code class="codeph">schemaOwners</code> 。
                        </p>
                        <div class="infoboxnotealso" id="GUID-977E4919-1072-4A96-B03C-6576A7B98786__GUID-49F7BCE9-78FB-445B-85E3-281B578A33DB">
                           <p class="notep1">也可以看看：</p>
                           <p>有关<code class="codeph">ALTER TABLE</code>的完整说明，请<a href="../sqlrf/ALTER-TABLE.html#SQLRF01001" target="_blank"><span><cite>参见Oracle数据库SQL语言参考</cite></span></a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-977E4919-1072-4A96-B03C-6576A7B98786__BCGBIBHG">
                        <p class="titleinexample">示例20-3加载修订的XML架构和XSLT样式表</p><pre class="oac_no_warn" dir="ltr">DECLARE res BOOLEAN; BEGIN res：= DBMS_XDB_REPOS.createResource（ - 加载修订的XML模式'/source/schemas/poSource/revisedPurchaseOrder.xsd'，bfilename（'XMLDIR'，'modifiedPurchaseOrder.xsd'），nls_charset_id（'AL32UTF8'））; res：= DBMS_XDB_REPOS.createResource（ - 加载修订的XSL样式表'/source/schemas/poSource/evolvePurchaseOrder.xsl'，bfilename（'XMLDIR'，'evolvePurchaseOrder.xsl'），nls_charset_id（'AL32UTF8'））;结束;/</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-977E4919-1072-4A96-B03C-6576A7B98786__BCGFEAFB">
                        <p class="titleinexample">示例20-4使用DBMS_XMLSCHEMA.COPYEVOLVE更新XML模式</p><pre class="oac_no_warn" dir="ltr">BEGIN DBMS_XMLSCHEMA.copyEvolve（xdb $ string_list_t（'http：// localhost：8080 / source / schemas / poSource / xsd / purchaseOrder.xsd'），XMLSequenceType（XDBURIType（'/ source / schemas / poSource / revisedPurchaseOrder.xsd'）。 getXML（）），XMLSequenceType（XDBURIType（'/ source / schemas / poSource / evolvePurchaseOrder.xsl'）。getXML（）））;结束;</pre><pre class="oac_no_warn" dir="ltr">SELECT XMLQuery（'$ p / PurchaseOrder / LineItems / LineItem [1]'PASSING po。OBJECT_VALUE为“p”返回内容）line_item来自purchaseorder po WHERE XMLExists（'$ p / PurchaseOrder [Reference =“SBELL-2003030912333601PDT”]'PASSING po。OBJECT_VALUE AS“p”）; LINE_ITEM ------------------------------------------------- ----------------------------- &lt;LineItem ItemNumber =“1”&gt; <span class="bold">&lt;Part Description =“值得纪念的夜晚”UnitCost =“ 39.95“&gt; 715515009058 &lt;/ Part&gt;</span> <span class="bold">&lt;数量&gt; 2 &lt;/数量&gt;</span> &lt;/ LineItem&gt;</pre><p>在模式演变之前，相同的查询会产生以下结果：</p><pre class="oac_no_warn" dir="ltr">LINE_ITEM ------------------------------------------------- --------- &lt;LineItem ItemNumber =“1”&gt; <span class="bold">&lt;Description&gt;要记住的夜晚&lt;/ Description&gt;</span> <span class="bold">&lt;Part Id =“715515009058”UnitPrice =“39.95”Quantity =“2”/&gt;</span> &lt;/ LineItem &gt;</pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="XML-Schema-evolution.html#GUID-0E4FC235-D8D1-4F27-85DC-A3DCCC2662AB" title="您使用PL / SQL过程DBMS_XMLSCHEMA.copyEvolve执行基于副本的XML模式演变。这会将现有实例文档备份到临时XMLType表，删除旧版本的XML架构（也会删除关联的实例文档），注册新版本，并将备份的实例文档复制到新的XMLType表。">基于副本的模式演变</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="ADXDB0850"></a><div class="props_rev_3"><a id="GUID-0C97EA66-1890-495D-9117-55FB0D563992" name="GUID-0C97EA66-1890-495D-9117-55FB0D563992"></a><h3 id="ADXDB-GUID-0C97EA66-1890-495D-9117-55FB0D563992" class="sect3"><span class="enumeration_section">20.3</span>就地XML模式演变</h3>
               <div>
                  <p>就地XML模式演变可以更改XML模式，而无需复制，删除和重新插入现有数据。因此，就地进化比基于复制的进化快得多。然而，就地进化也有一些限制，不适用于基于拷贝的进化。</p>
                  <p>您使用过程<code class="codeph">DBMS_XMLSCHEMA.inPlaceEvolve</code>执行就地演变。使用此过程，可以通过指定XML模式差异文档来标识对现有XML模式所做的更改，并且可以选择指定要应用于演化过程的标志。
                  </p>
                  <p>就地演变通过应用<code class="codeph">diffXML</code>文档中指定的更改来构造新版本的XML模式，验证新的XML模式（针对XML模式的XML模式），构造DDL语句以演化用于存储XML实例的磁盘结构与XML模式关联的文档，执行这些DDL语句，并按顺序将旧版本的XML模式替换为新模式。如果新版本的XML模式不是有效模式，则就地演进失败。
                  </p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="XML-Schema-evolution.html#GUID-7532CECB-3F71-4E7A-A6C0-F603CDB9BAFB">就地XML架构演变的限制</a><br>由于就地XML模式演变避免了复制数据，因此不允许对XML模式进行任意更改。使用就地演进的主要限制通常可以说是要求给定的XML模式可以仅以向后兼容的方式进化到位。
                     </li>
                     <li class="ulchildlink"><a href="XML-Schema-evolution.html#GUID-A58F605A-45D6-4159-9C2B-104DBE72673F">支持就地XML架构演进的操作</a><br>描述了一些支持就地模式演变的操作。在指定的特定上下文中不允许其中一些。
                     </li>
                     <li class="ulchildlink"><a href="XML-Schema-evolution.html#GUID-81D1FF2B-D820-47D4-BCC2-543FAC05541C">使用就地XML模式演变的准则</a><br>提出了适用于就地XML模式演变的指南。（确保在执行就地模式演变之前备份数据。）
                     </li>
                     <li class="ulchildlink"><a href="XML-Schema-evolution.html#GUID-B67CE8DE-8D9E-4221-995F-2065A4DE2F03">inPlaceEvolve参数</a><br>描述了PL / SQL过程<code class="codeph">DBMS_XMLSCHEMA.inPlaceEvolve</code>的参数，以及与此过程相关的错误。
                     </li>
                     <li class="ulchildlink"><a href="XML-Schema-evolution.html#GUID-4517E8F7-3ADB-464F-9744-189785466F7F">diffXML参数文档</a><br>过程<code class="codeph">DBMS_XMLSCHEMA.inPlaceEvolve</code>的参数<code class="codeph">diffXML</code>的值是一个<code class="codeph">XMLType</code>实例，它指定要应用于就地演进的XML模式的更改。这个<code class="codeph">diffXML</code>文档包含一系列操作，用于描述旧XML模式和新XML模式（预期的演化结果）之间的变化。
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="XML-Schema-evolution.html#GUID-F2E920B3-C6D7-428B-9E75-5CE9C21F9B5F" title="在向Oracle XML DB注册XML模式后，可以使用XML模式演变来更新XML模式。">XML模式演变</a></p>
                     </div>
                  </div>
               </div>
               <a id="ADXDB4704"></a><div class="props_rev_3"><a id="GUID-7532CECB-3F71-4E7A-A6C0-F603CDB9BAFB" name="GUID-7532CECB-3F71-4E7A-A6C0-F603CDB9BAFB"></a><h4 id="ADXDB-GUID-7532CECB-3F71-4E7A-A6C0-F603CDB9BAFB" class="sect4"><span class="enumeration_section">20.3.1</span>就地XML模式演变的限制</h4>
                  <div>
                     <p>由于就地XML模式演变避免了复制数据，因此不允许对XML模式进行任意更改。使用就地演进的主要限制通常可以说是要求给定的XML模式可以仅以向后兼容的方式进化到位。</p>
                     <p>有关就地演变支持的完整更改列表，请参阅<a href="XML-Schema-evolution.html#GUID-A58F605A-45D6-4159-9C2B-104DBE72673F" title="描述了一些支持就地模式演变的操作。在指定的特定上下文中不允许其中一些。">就地XML架构演变支持的操作</a> 。
                     </p>
                     <p>这里<strong class="term">向后兼容</strong>意味着任何可能针对给定XML模式进行验证的实例文档也必须针对该XML模式的后续（演进）版本进行验证。这适用于<span class="italic">所有可能的</span>符合实例文档，不仅适用于<span class="italic">现有</span>实例文档对于存储为二进制XML的XML数据，向后兼容性还意味着影响二进制XML处理的任何XML模式注释在进化过程中都不得更改。
                     </p>
                     <p>除了这种一般的向后兼容性限制之外，对于就地演进还有一些其他限制。</p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="XML-Schema-evolution.html#GUID-17B520D9-8711-4CC0-A122-D9F220E39B39">向后兼容性限制</a><br>描述了对就地XML模式演变的限制，以确保演进模式的向后兼容性，以便满足旧XML模式的任何可能的实例文档也满足新的模式。
                        </li>
                        <li class="ulchildlink"><a href="XML-Schema-evolution.html#GUID-843D0864-84E5-414F-8315-4AB84FA978FF">就地演变的其他限制</a><br>由于演进的XML模式的向后兼容性以外的原因，对就地XML模式演进的一些限制是必要的。
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="XML-Schema-evolution.html#GUID-0C97EA66-1890-495D-9117-55FB0D563992" title="就地XML模式演变可以更改XML模式，而无需复制，删除和重新插入现有数据。因此，就地进化比基于复制的进化快得多。然而，就地进化也有一些限制，不适用于基于拷贝的进化。">就地XML架构演变</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="ADXDB4705"></a><div class="props_rev_3"><a id="GUID-17B520D9-8711-4CC0-A122-D9F220E39B39" name="GUID-17B520D9-8711-4CC0-A122-D9F220E39B39"></a><h5 id="ADXDB-GUID-17B520D9-8711-4CC0-A122-D9F220E39B39" class="sect5"><span class="enumeration_section">20.3.1.1</span>向后兼容性限制</h5>
                     <div>
                        <p>描述了对就地XML模式演变的限制，以确保演进模式的向后兼容性，以便满足旧XML模式的任何可能的实例文档也满足新的模式。</p>
                     </div>
                     <div>
                        <ul class="ullinks">
                           <li class="ulchildlink"><a href="XML-Schema-evolution.html#GUID-631A3DDB-8491-4070-93C4-B70097EFBF00">磁盘上数据布局的更改</a><br>对XML架构的某些更改会更改磁盘上关联实例文档的布局，因此不允许这样做。当存储层与从XML模式派生的信息紧密集成时，这种情况更为常见，对象关系存储就是这种情况。
                           </li>
                           <li class="ulchildlink"><a href="XML-Schema-evolution.html#GUID-C806E9FD-2D1A-42CA-8961-516DC8326141">XML模式构造的重新排序</a><br>您不能使用就地演变来以影响XML实例文档的DOM保真度的方式重新排序XML模式元素。例如，您无法更改复杂类型定义中<code class="codeph">&lt;sequence&gt;</code>元素内元素的<code class="codeph">&lt;sequence&gt;</code> 。
                           </li>
                           <li class="ulchildlink"><a href="XML-Schema-evolution.html#GUID-1ACC4849-6725-4806-B991-4A4114A07D67">从集合到非集合的更改</a><br>您不能使用就地演变将集合更改为非集合。一个例子是从<code class="codeph">maxOccurs</code>大于1变为<code class="codeph">maxOccurs</code>等于1。因此，如果删除要求将集合演变为非集合，则就地演变不能从复杂类型中删除元素。
                           </li>
                           <li class="ulchildlink"><a href="XML-Schema-evolution.html#GUID-FDDFFC60-63AF-447D-B95C-EEFBCFA8D301">complexType元素中的模型更改</a><br><strong class="term">模型</strong>是<code class="codeph">group</code> ， <code class="codeph">choice</code> ， <code class="codeph">sequence</code>或<code class="codeph">all</code>元素。在<code class="codeph">complexType</code>元素中，您不能使用就地演变来添加新模型或用另一种类型的模型替换现有模型（例如，用<code class="codeph">sequence</code>元素替换<code class="codeph">choice</code>元素）。
                           </li>
                        </ul>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="XML-Schema-evolution.html#GUID-7532CECB-3F71-4E7A-A6C0-F603CDB9BAFB" title="由于就地XML模式演变避免了复制数据，因此不允许对XML模式进行任意更改。使用就地演进的主要限制通常可以说是要求给定的XML模式可以仅以向后兼容的方式进化到位。">就地XML架构演变的限制</a></p>
                           </div>
                        </div>
                     </div>
                     <a id="ADXDB4707"></a><a id="ADXDB4706"></a><div class="props_rev_3"><a id="GUID-631A3DDB-8491-4070-93C4-B70097EFBF00" name="GUID-631A3DDB-8491-4070-93C4-B70097EFBF00"></a><h6 id="ADXDB-GUID-631A3DDB-8491-4070-93C4-B70097EFBF00" class="sect6"><span class="enumeration_section">20.3.1.1.1</span>磁盘上数据布局的更改</h6>
                        <div>
                           <p>对XML架构的某些更改会更改磁盘上关联实例文档的布局，因此不允许这样做。当存储层与从XML模式派生的信息紧密集成时，这种情况更为常见，对象关系存储就是这种情况。</p>
                           <p>一个这样的示例是为对象关系存储映射注册的XML模式，其通过将复杂类型分成两种复杂类型而发展。在<a href="XML-Schema-evolution.html#GUID-631A3DDB-8491-4070-93C4-B70097EFBF00__CHDDDEGA">示例20-5中</a> ，复杂类型<code class="codeph">ShippingInstructionsType</code>分为两个复杂类型： <code class="codeph">Person-Name</code>和<code class="codeph">Contact-Info</code> ，并删除<code class="codeph">ShippingInstructionsType</code>复杂类型。
                           </p>
                           <p>即使此XML架构没有关联的实例文档，因此也不需要数据复制，但需要更改现有表的布局以适应将来的实例文档。</p>
                           <div class="example" id="GUID-631A3DDB-8491-4070-93C4-B70097EFBF00__CHDDDEGA">
                              <p class="titleinexample">示例20-5将复杂类型拆分为两种复杂类型</p>
                              <p>这些代码摘录显示了原始<code class="codeph">ShippingInstructionsType</code>类型的定义以及新的<code class="codeph">Person</code> <code class="codeph">-Name</code>和<code class="codeph">Contact-Info</code>类型。
                              </p><pre class="pre codeblock"><code>&lt;complexType name =“ShippingInstructionsType”&gt; &lt;sequence&gt; &lt;element name =“name”type =“NameType”minOccurs =“0”/&gt; &lt;element name =“address”type =“AddressType”minOccurs =“0”/&gt; &lt; element name =“telephone”type =“TelephoneType”minOccurs =“0”/&gt; &lt;/ sequence&gt; &lt;/ complexType&gt; &lt;complexType name =“Person-Name”&gt; &lt;sequence&gt; &lt;element name =“name”type =“NameType “minOccurs =”0“/&gt; &lt;/ sequence&gt; &lt;/ complexType&gt; &lt;complexType name =”Contact-Info“&gt; &lt;sequence&gt; &lt;element name =”address“type =”AddressType“minOccurs =”0“/&gt; &lt;element name =“telephone”type =“TelephoneType”minOccurs =“0”/&gt; &lt;/ sequence&gt; &lt;/ complexType&gt;</code></pre></div>
                           <!-- class="example" -->
                        </div>
                        <div>
                           <div class="familylinks">
                              <div class="parentlink">
                                 <p><strong>父主题：</strong> <a href="XML-Schema-evolution.html#GUID-17B520D9-8711-4CC0-A122-D9F220E39B39" title="描述了对就地XML模式演变的限制，以确保演进模式的向后兼容性，以便满足旧XML模式的任何可能的实例文档也满足新的模式。">向后兼容性限制</a></p>
                              </div>
                           </div>
                        </div>
                        
                     </div><a id="ADXDB4708"></a><div class="props_rev_3"><a id="GUID-C806E9FD-2D1A-42CA-8961-516DC8326141" name="GUID-C806E9FD-2D1A-42CA-8961-516DC8326141"></a><h6 id="ADXDB-GUID-C806E9FD-2D1A-42CA-8961-516DC8326141" class="sect6"><span class="enumeration_section">20.3.1.1.2</span> XML模式构造的重新排序</h6>
                        <div>
                           <p>您不能使用就地演变来以影响XML实例文档的DOM保真度的方式重新排序XML模式元素。例如，您无法更改复杂类型定义中<code class="codeph">&lt;sequence&gt;</code>元素内元素的<code class="codeph">&lt;sequence&gt;</code> 。
                           </p>
                           <p>例如，如果名为<code class="codeph">ShippingInstructionsType</code>的复杂类型要求其子元素<code class="codeph">name</code> ， <code class="codeph">address</code>和<code class="codeph">telephone</code> <code class="codeph">ShippingInstructionsType</code>顺序排列，则无法使用就地演变将订单更改为<code class="codeph">name</code> ， <code class="codeph">telephone</code>和<code class="codeph">address</code> 。
                           </p>
                        </div>
                        <div>
                           <div class="familylinks">
                              <div class="parentlink">
                                 <p><strong>父主题：</strong> <a href="XML-Schema-evolution.html#GUID-17B520D9-8711-4CC0-A122-D9F220E39B39" title="描述了对就地XML模式演变的限制，以确保演进模式的向后兼容性，以便满足旧XML模式的任何可能的实例文档也满足新的模式。">向后兼容性限制</a></p>
                              </div>
                           </div>
                        </div>
                        
                     </div><a id="ADXDB4709"></a><div class="props_rev_3"><a id="GUID-1ACC4849-6725-4806-B991-4A4114A07D67" name="GUID-1ACC4849-6725-4806-B991-4A4114A07D67"></a><h6 id="ADXDB-GUID-1ACC4849-6725-4806-B991-4A4114A07D67" class="sect6"><span class="enumeration_section">20.3.1.1.3</span>从集合到非集合的更改</h6>
                        <div>
                           <p>您不能使用就地演变将集合更改为非集合。一个例子是从<code class="codeph">maxOccurs</code>大于1变为<code class="codeph">maxOccurs</code>等于1。因此，如果删除要求将集合演变为非集合，则就地演变不能从复杂类型中删除元素。
                           </p>
                        </div>
                        <div>
                           <div class="familylinks">
                              <div class="parentlink">
                                 <p><strong>父主题：</strong> <a href="XML-Schema-evolution.html#GUID-17B520D9-8711-4CC0-A122-D9F220E39B39" title="描述了对就地XML模式演变的限制，以确保演进模式的向后兼容性，以便满足旧XML模式的任何可能的实例文档也满足新的模式。">向后兼容性限制</a></p>
                              </div>
                           </div>
                        </div>
                        
                     </div><a id="ADXDB6002"></a><div class="props_rev_3"><a id="GUID-FDDFFC60-63AF-447D-B95C-EEFBCFA8D301" name="GUID-FDDFFC60-63AF-447D-B95C-EEFBCFA8D301"></a><h6 id="ADXDB-GUID-FDDFFC60-63AF-447D-B95C-EEFBCFA8D301" class="sect6"><span class="enumeration_section">20.3.1.1.4</span> complexType元素中的模型更改</h6>
                        <div>
                           <p><strong class="term">模型</strong>是<code class="codeph">group</code> ， <code class="codeph">choice</code> ， <code class="codeph">sequence</code>或<code class="codeph">all</code>元素。在<code class="codeph">complexType</code>元素中，您不能使用就地演变来添加新模型或用另一种类型的模型替换现有模型（例如，用<code class="codeph">sequence</code>元素替换<code class="codeph">choice</code>元素）。
                           </p>
                           <p>但是，您可以添加全局<code class="codeph">group</code>元素，即在<code class="codeph">complexType</code>元素之外添加<code class="codeph">group</code>元素。
                           </p>
                        </div>
                        <div>
                           <div class="familylinks">
                              <div class="parentlink">
                                 <p><strong>父主题：</strong> <a href="XML-Schema-evolution.html#GUID-17B520D9-8711-4CC0-A122-D9F220E39B39" title="描述了对就地XML模式演变的限制，以确保演进模式的向后兼容性，以便满足旧XML模式的任何可能的实例文档也满足新的模式。">向后兼容性限制</a></p>
                              </div>
                           </div>
                        </div>
                        
                     </div>
                  </div><a id="ADXDB4710"></a><div class="props_rev_3"><a id="GUID-843D0864-84E5-414F-8315-4AB84FA978FF" name="GUID-843D0864-84E5-414F-8315-4AB84FA978FF"></a><h5 id="ADXDB-GUID-843D0864-84E5-414F-8315-4AB84FA978FF" class="sect5"><span class="enumeration_section">20.3.1.2</span>就地演变的其他限制</h5>
                     <div>
                        <p>由于演进的XML模式的向后兼容性以外的原因，对就地XML模式演进的一些限制是必要的。</p>
                     </div>
                     <div>
                        <ul class="ullinks">
                           <li class="ulchildlink"><a href="XML-Schema-evolution.html#GUID-E2E4E681-4C97-4DDA-9F1B-A055B23ED6AC">对命名空间xdb中的属性的更改</a><br>除了属性<code class="codeph">xdb:defaultTable</code> ，您不能使用就地演变来修改名称空间<code class="codeph">http://xmlns.oracle.com/xdb</code> （具有预定义前缀<code class="codeph">xdb</code> ）中的任何属性。
                           </li>
                           <li class="ulchildlink"><a href="XML-Schema-evolution.html#GUID-DC55F317-E8AC-41D6-A66D-EF1249551F61">从非集合到集合的更改</a><br>对于对象关系<code class="codeph">XMLType</code>数据，您不能使用就地演变将非集合对象类型更改为集合对象类型。例如，如果元素已经存在于类型中（或者通过继承相关的类型），则将元素添加到复杂类型。
                           </li>
                        </ul>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="XML-Schema-evolution.html#GUID-7532CECB-3F71-4E7A-A6C0-F603CDB9BAFB" title="由于就地XML模式演变避免了复制数据，因此不允许对XML模式进行任意更改。使用就地演进的主要限制通常可以说是要求给定的XML模式可以仅以向后兼容的方式进化到位。">就地XML架构演变的限制</a></p>
                           </div>
                        </div>
                     </div>
                     <a id="ADXDB4711"></a><div class="props_rev_3"><a id="GUID-E2E4E681-4C97-4DDA-9F1B-A055B23ED6AC" name="GUID-E2E4E681-4C97-4DDA-9F1B-A055B23ED6AC"></a><h6 id="ADXDB-GUID-E2E4E681-4C97-4DDA-9F1B-A055B23ED6AC" class="sect6"><span class="enumeration_section">20.3.1.2.1</span>命名空间xdb中属性的更改</h6>
                        <div>
                           <p>除了属性<code class="codeph">xdb:defaultTable</code> ，您不能使用就地演变来修改名称空间<code class="codeph">http://xmlns.oracle.com/xdb</code> （具有预定义前缀<code class="codeph">xdb</code> ）中的任何属性。
                           </p>
                        </div>
                        <div>
                           <div class="familylinks">
                              <div class="parentlink">
                                 <p><strong>父主题：</strong> <a href="XML-Schema-evolution.html#GUID-843D0864-84E5-414F-8315-4AB84FA978FF" title="由于演进的XML模式的向后兼容性以外的原因，对就地XML模式演进的一些限制是必要的。">就地演变的其他限制</a></p>
                              </div>
                           </div>
                        </div>
                        
                     </div><a id="ADXDB4712"></a><div class="props_rev_3"><a id="GUID-DC55F317-E8AC-41D6-A66D-EF1249551F61" name="GUID-DC55F317-E8AC-41D6-A66D-EF1249551F61"></a><h6 id="ADXDB-GUID-DC55F317-E8AC-41D6-A66D-EF1249551F61" class="sect6"><span class="enumeration_section">20.3.1.2.2</span>从非集合到集合的更改</h6>
                        <div>
                           <p>对于对象关系<code class="codeph">XMLType</code>数据，您不能使用就地演变将非集合对象类型更改为集合对象类型。例如，如果元素已经存在于类型中（或者通过继承相关的类型），则将元素添加到复杂类型。
                           </p>
                        </div>
                        <div>
                           <div class="familylinks">
                              <div class="parentlink">
                                 <p><strong>父主题：</strong> <a href="XML-Schema-evolution.html#GUID-843D0864-84E5-414F-8315-4AB84FA978FF" title="由于演进的XML模式的向后兼容性以外的原因，对就地XML模式演进的一些限制是必要的。">就地演变的其他限制</a></p>
                              </div>
                           </div>
                        </div>
                        
                     </div>
                  </div>
               </div><a id="ADXDB4713"></a><div class="props_rev_3"><a id="GUID-A58F605A-45D6-4159-9C2B-104DBE72673F" name="GUID-A58F605A-45D6-4159-9C2B-104DBE72673F"></a><h4 id="ADXDB-GUID-A58F605A-45D6-4159-9C2B-104DBE72673F" class="sect4"><span class="enumeration_section">20.3.2</span>就地XML模式演进支持的操作</h4>
                  <div>
                     <p>描述了一些支持就地模式演变的操作。在指定的特定上下文中不允许其中一些。</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>将可选元素添加到复杂类型或组：始终允许。一个例子是在以下复杂类型定义中添加了可选元素<code class="codeph">shipmethod</code> ：</p><pre class="pre codeblock"><code>&lt;xs：complexType name =“ShippingInstructionsType”&gt; &lt;xs：sequence&gt; &lt;xs：element name =“name”type =“NameType”minOccurs =“0”/&gt; &lt;xs：element name =“address”type =“AddressType” minOccurs =“0”/&gt; &lt;xs：element name =“telephone”type =“TelephoneType”minOccurs =“0”/&gt; <span class="bold">&lt;xs：element name =“shipmethod”type =“xs：string”minOccurs =“0”/ &gt;</span> &lt;/ xs：sequence&gt; &lt;/ xs：complexType&gt;</code></pre></li>
                        <li>
                           <p>将可选属性添加到复杂类型或属性组：始终允许。一个例子是在以下复杂类型定义中添加了可选属性<code class="codeph">shipbydate</code> ：</p><pre class="pre codeblock"><code>&lt;xs：complexType name =“ShippingInstructionsType”&gt; &lt;xs：sequence&gt; &lt;xs：element name =“name”type =“NameType”minOccurs =“0”/&gt; &lt;xs：element name =“address”type =“AddressType” minOccurs =“0”/&gt; &lt;xs：element name =“telephone”type =“TelephoneType”minOccurs =“0”/&gt; &lt;/ xs：sequence&gt; <span class="bold">&lt;xs：attribute name =“shipbydate”type =“DateType”use = “optional”/&gt;</span> &lt;/ xs：complexType&gt;</code></pre></li>
                        <li>
                           <p>使用简单内容将元素从简单类型转换为复杂类型：仅当存储模型是二进制XML时才支持。</p>
                        </li>
                        <li>
                           <p>修改现有maxLength元素的value属性：始终允许。该值只能增加，而不能减少。</p>
                        </li>
                        <li>
                           <p>添加枚举值：您只能将新枚举值添加到枚举列表的末尾。</p>
                        </li>
                        <li>
                           <p>添加全局元素：始终允许。一个示例是在以下模式定义中添加全局元素<code class="codeph">PurchaseOrderComment</code> ：</p><pre class="pre codeblock"><code>&lt;xs：schema ...&gt; ...
    <span class="bold">&lt;xs：element name =“PurchaseOrderComment”type =“string”xdb：defaultTable =“”/&gt;</span> ..&lt;/ XS：模式&gt;</code></pre></li>
                        <li>
                           <p>添加全局属性：始终允许。</p>
                        </li>
                        <li>
                           <p>添加或删除全局复杂类型：始终允许。一个示例是在以下模式定义中添加全局复杂类型<code class="codeph">ComplexAddressType</code> ：</p><pre class="pre codeblock"><code>&lt;xs：schema ...&gt; ....
    <span class="bold">&lt;xs：complexType name =“ComplexAddressType”&gt;</span> <span class="bold">&lt;xs：sequence&gt;</span> <span class="bold">&lt;xs：element name =“street”type =“string”/&gt;</span> <span class="bold">&lt;xs：element name =“city”type =“string”/&gt;</span> <span class="bold">&lt;xs： element ref =“zip”type =“positiveInteger”/&gt;</span> <span class="bold">&lt;xs：element name =“country”type =“string”/&gt;</span> <span class="bold">&lt;/ xs：sequence&gt;</span> <span class="bold">&lt;/ xs：complexType&gt;</span> ...&lt;/ XS：模式&gt;</code></pre></li>
                        <li>
                           <p>添加或删除全局简单类型：始终允许。</p>
                        </li>
                        <li>
                           <p>更改<code class="codeph">minOccurs</code>属性值：值<code class="codeph">minOccurs</code>只能下降。
                           </p>
                        </li>
                        <li>
                           <p>改变<code class="codeph">maxOccurs</code>属性值：值<code class="codeph">maxOccurs</code>只能增加，而这仅是可能的存储为二进制XML数据。也就是说，您无法对对象存储的数据的<code class="codeph">maxOccurs</code>属性进行任何更改。
                           </p>
                        </li>
                        <li>
                           <p>添加或删除全局组或<code class="codeph">attributeGroup</code>组：始终允许。一个例子是在以下类型定义中添加了一个<code class="codeph">Instructions</code>组：</p><pre class="pre codeblock"><code>&lt;xsd：schema ...&gt; ...
  <span class="bold">&lt;xsd：group name =“Instructions”&gt;</span> <span class="bold">&lt;xsd：sequence&gt;</span> <span class="bold">&lt;xsd：element name =“ShippingInstructions”type =“ShippingInstructionsType”/&gt;</span> <span class="bold">&lt;xsd：element name =“SpecialInstructions”type =“SpecialInstructionsType”/&gt;</span> <span class="bold">&lt;/ xsd ：sequence&gt;</span> <span class="bold">&lt;/ xsd：group&gt;</span> ...&lt;/ XSD：模式&gt;</code></pre></li>
                        <li>
                           <p>更改xdb：defaultTable属性值：始终允许。<span class="italic">不允许</span>更改在任何其他属性<code class="codeph">xdb</code>命名空间。
                           </p>
                        </li>
                        <li>
                           <p>添加，修改或删除注释或处理说明：始终允许。</p>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="XML-Schema-evolution.html#GUID-0C97EA66-1890-495D-9117-55FB0D563992" title="就地XML模式演变可以更改XML模式，而无需复制，删除和重新插入现有数据。因此，就地进化比基于复制的进化快得多。然而，就地进化也有一些限制，不适用于基于拷贝的进化。">就地XML架构演变</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="ADXDB4714"></a><div class="props_rev_3"><a id="GUID-81D1FF2B-D820-47D4-BCC2-543FAC05541C" name="GUID-81D1FF2B-D820-47D4-BCC2-543FAC05541C"></a><h4 id="ADXDB-GUID-81D1FF2B-D820-47D4-BCC2-543FAC05541C" class="sect4"><span class="enumeration_section">20.3.3</span>使用就地XML模式演进的指南</h4>
                  <div>
                     <p>提出了适用于就地XML模式演变的指南。（确保在执行就地模式演变之前备份数据。）</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><span class="italic">在</span>执行就地XML模式演变之前：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><span class="italic">备份</span>要进化的XML模式的<span class="italic">所有现有数据</span> （实例文档）。
                                 </p>
                                 <div class="infoboxnote" id="GUID-81D1FF2B-D820-47D4-BCC2-543FAC05541C__GUID-BB7E8076-CAE6-4F69-B9ED-DBB2949B97D1">
                                    <p class="notep1">警告：</p>
                                    <p>确保在执行就地XML模式演变之前备份数据，以防结果不符合您的预期。在就地演变之后<span class="italic">没有</span>可能的<span class="italic">回滚</span> 。如果在演变期间发生任何错误，或者如果您犯了重大错误并需要重做整个操作，则必须能够返回原始数据的备份副本。
                                    </p>
                                 </div>
                              </li>
                              <li>
                                 <p>仅使用跟踪<span class="italic">执行空运行</span> ，即，在不实际演变XML模式或更新任何实例文档的情况下，生成将在演变期间执行的更新操作的跟踪。为此，请将<code class="codeph">flag</code>参数值设置为<code class="codeph">INPLACE_TRACE</code> 。不要也使用<code class="codeph">INPLACE_EVOLVE</code> 。</p>
                                 <p>执行空运行后，检查跟踪文件，验证列出的DDL操作实际上是您想要的操作。</p>
                              </li>
                           </ul>
                        </li>
                        <li>
                           <p><span class="italic">在</span>执行就地XML的模式演变：</p>
                           <p>如果使用缓存数据的客户端访问数据库，或者您不确定是否是这种情况，请<span class="italic">重新启动客户端</span> 。否则，XML模式的预演进版本可能会继续在本地使用，并产生不可预测的结果。
                           </p>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-81D1FF2B-D820-47D4-BCC2-543FAC05541C__GUID-7F56A972-5D6D-4BBA-8093-FE1CEA8347A1">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="../admin/diagnosing-and-resolving-problems.html#ADMIN11263" target="_blank"><span><cite>“Oracle数据库管理员指南”</cite></span></a> ，了解有关使用跟踪文件的信息</p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="XML-Schema-evolution.html#GUID-0C97EA66-1890-495D-9117-55FB0D563992" title="就地XML模式演变可以更改XML模式，而无需复制，删除和重新插入现有数据。因此，就地进化比基于复制的进化快得多。然而，就地进化也有一些限制，不适用于基于拷贝的进化。">就地XML架构演变</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="ADXDB4716"></a><a id="ADXDB4715"></a><div class="props_rev_3"><a id="GUID-B67CE8DE-8D9E-4221-995F-2065A4DE2F03" name="GUID-B67CE8DE-8D9E-4221-995F-2065A4DE2F03"></a><h4 id="ADXDB-GUID-B67CE8DE-8D9E-4221-995F-2065A4DE2F03" class="sect4"><span class="enumeration_section">20.3.4</span> inPlaceEvolve参数</h4>
                  <div>
                     <p>描述了PL / SQL过程<code class="codeph">DBMS_XMLSCHEMA.inPlaceEvolve</code>的参数，以及与此过程相关的错误。
                     </p>
                     <div class="section">
                        <p>这是过程<code class="codeph">DBMS_XMLSCHEMA.inPlaceEvolve</code>的签名：</p><pre class="oac_no_warn" dir="ltr">procedure inPlaceEvolve（schemaURL IN VARCHAR2，diffXML IN XMLType，flags IN NUMBER）;</pre><p><a href="XML-Schema-evolution.html#GUID-B67CE8DE-8D9E-4221-995F-2065A4DE2F03__BCGHFHEI" title="此表描述了DBMS_XMLSCHEMA.InPlaceEvolve参数。">表20-6</a>描述了各个参数。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="tblformal" id="GUID-B67CE8DE-8D9E-4221-995F-2065A4DE2F03__BCGHFHEI">
                        <p class="titleintable">表20-6过程DBMS_XMLSCHEMA.INPLACEEVOLVE的参数</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="过程DBMS_XMLSCHEMA.INPLACEEVOLVE的参数" width="100%" border="1" summary="This table describes the DBMS_XMLSCHEMA.InPlaceEvolve parameters." frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="15%" id="d103278e3332">参数</th>
                                 <th align="left" valign="bottom" width="85%" id="d103278e3335">描述</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="15%" id="d103278e3340" headers="d103278e3332 ">
                                    <p><code class="codeph">schemaURL</code></p>
                                 </td>
                                 <td align="left" valign="top" width="85%" headers="d103278e3340 d103278e3335 ">
                                    <p>要进化的XML模式的URL（ <code class="codeph">VARCHAR2)</code> 。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="15%" id="d103278e3351" headers="d103278e3332 ">
                                    <p><code class="codeph">diffXML</code></p>
                                 </td>
                                 <td align="left" valign="top" width="85%" headers="d103278e3351 d103278e3335 ">
                                    <p>XML文档（ <code class="codeph">XMLType</code>实例），它符合<code class="codeph">xdiff</code> XML架构，并指定要应用的更改以及要应用更改的XML架构中的位置。有关如何为此参数创建文档的信息，请参阅<a href="XML-Schema-evolution.html#GUID-4517E8F7-3ADB-464F-9744-189785466F7F" title="过程DBMS_XMLSCHEMA.inPlaceEvolve的参数diffXML的值是一个XMLType实例，它指定要应用于就地演进的XML模式的更改。这个diffXML文档包含一系列操作，用于描述旧XML模式和新XML模式（预期的演化结果）之间的变化。">diffXML参数文档</a> 。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="15%" id="d103278e3383" headers="d103278e3332 ">
                                    <p><code class="codeph">旗</code></p>
                                 </td>
                                 <td align="left" valign="top" width="85%" headers="d103278e3383 d103278e3335 ">
                                    <p>一个控制过程行为的位掩码。您可以单独在此掩码中设置以下位值，将它们相加以定义整体效果。默认<code class="codeph">flags</code>值为1（位1开，位2关），这意味着执行就地演变并且不写入任何跟踪。
                                    </p>
                                    <ul style="list-style-type:disc">
                                       <li>
                                          <p><code class="codeph">INPLACE_EVOLVE</code> （值1，表示位1已打开） - 执行就地XML模式演变。构造一个新的XML模式并对其进行验证（针对XML模式的XML模式）。构造演进实例文档磁盘结构所需的DDL语句。执行DDL语句。用新的替换旧的XML模式。
                                          </p>
                                       </li>
                                       <li>
                                          <p><code class="codeph">INPLACE_TRACE</code> （值2，表示第2位打开） - 执行就地演变所需的所有步骤， <span class="italic">除了</span>执行DDL语句并用new覆盖旧的XML模式，然后同时写入DDL语句和新的XML模式跟踪文件。
                                          </p>
                                       </li>
                                    </ul>
                                    <p>也就是说，每个位构造新的XML模式，验证它，并确定发展实例文档下的磁盘结构所需的步骤。此外：</p>
                                    <ul style="list-style-type:disc">
                                       <li>
                                          <p>位<code class="codeph">INPLACE_EVOLVE</code>执行这些演进步骤，并用新的替换旧的XML模式。
                                          </p>
                                       </li>
                                       <li>
                                          <p>位<code class="codeph">INPLACE_TRACE</code>将演化步骤和新XML模式保存在跟踪文件中（它不执行演进步骤）。
                                          </p>
                                       </li>
                                    </ul>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <div class="section">
                        <p>过程<code class="codeph">DBMS_XMLSCHEMA.inPlaceEvolve</code>在以下情况下引发错误：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>XPath表达式无效，或在语法上是正确的，但不以XML架构中的节点为目标。</p>
                           </li>
                           <li>
                              <p><code class="codeph">diffXML</code>文档不符合<code class="codeph">xdiff</code> XML架构。
                              </p>
                           </li>
                           <li>
                              <p>此更改使XML架构无效或格式不正确。</p>
                           </li>
                           <li>
                              <p>生成的DDL语句（ <code class="codeph">CREATE TYPE</code> ， <code class="codeph">ALTER TYPE</code>等）在执行时会导致问题。
                              </p>
                           </li>
                           <li>
                              <p>与<code class="codeph">XMLType</code>表关联的索引对象处于不安全状态，这可能是由分区管理操作引起的。
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="XML-Schema-evolution.html#GUID-0C97EA66-1890-495D-9117-55FB0D563992" title="就地XML模式演变可以更改XML模式，而无需复制，删除和重新插入现有数据。因此，就地进化比基于复制的进化快得多。然而，就地进化也有一些限制，不适用于基于拷贝的进化。">就地XML架构演变</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="ADXDB4717"></a><div class="props_rev_3"><a id="GUID-4517E8F7-3ADB-464F-9744-189785466F7F" name="GUID-4517E8F7-3ADB-464F-9744-189785466F7F"></a><h4 id="ADXDB-GUID-4517E8F7-3ADB-464F-9744-189785466F7F" class="sect4"><span class="enumeration_section">20.3.5</span> diffXML参数文档</h4>
                  <div>
                     <p>过程<code class="codeph">DBMS_XMLSCHEMA.inPlaceEvolve</code>的参数<code class="codeph">diffXML</code>的值是一个<code class="codeph">XMLType</code>实例，它指定要应用于就地演进的XML模式的更改。这个<code class="codeph">diffXML</code>文档包含一系列操作，用于描述旧XML模式和新XML模式（预期的演化结果）之间的变化。
                     </p>
                     <p><code class="codeph">diffXML</code>文档指定的更改<code class="codeph">diffXML</code>顺序应用。
                     </p>
                     <p>您必须创建要用于<code class="codeph">diffXML</code>参数的XML文档您可以通过以下任何方式执行此操作：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">XMLDiff</code> JavaBean（ <code class="codeph">XMLDiff</code> <code class="codeph">oracle.xml.differ.XMLDiff</code> ）</p>
                        </li>
                        <li>
                           <p><code class="codeph">xmldiff</code>命令行实用程序</p>
                        </li>
                        <li>
                           <p>SQL函数<code class="codeph">XMLDiff</code></p>
                        </li>
                     </ul>
                     <p><code class="codeph">diffXML</code>参数文档必须符合<code class="codeph">xdiff</code> XML模式。
                     </p>
                     <p>本节的其余部分介绍了符合<code class="codeph">xdiff</code> XML架构的文档中的一些操作示例。
                     </p>
                     <div class="section"></div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="XML-Schema-evolution.html#GUID-A40016C6-9610-40D2-8A34-6437ABCAEA0C">diffXML操作和示例</a><br>描述了可以在提供给过程<code class="codeph">DBMS_XMLSCHEMA.inPlaceEvolve</code>的<code class="codeph">diffXML</code>文档中指定的操作。显示了符合<code class="codeph">xdiff</code> XML模式的示例XML文档。
                        </li>
                     </ul>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="oracle-supplied-XML-schemas-and-examples.html#GUID-F3A101B3-A943-4CBC-8AE7-243B76ECFEBD" title="提供了xdiff.xsd的完整列表，这是Oracle XML DB提供的XML模式，文档指定为过程DBMS_XMLSCHEMA.inPlaceEvolve的diffXML参数必须符合该模式。">xdiff.xsd：用于比较就地演进模式的XML模式</a></li>
                        </ul>
                     </div>
                     <div class="infoboxnotealso" id="GUID-4517E8F7-3ADB-464F-9744-189785466F7F__GUID-EAAF0640-80D5-4CD7-9B59-14D52A785DC7">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>有关使用<code class="codeph">XMLDiff</code> JavaBean的信息，请<code class="codeph">XMLDiff</code> <a href="../adxdk/XDK-JavaBeans.html#ADXDK246" target="_blank"><span><cite>Oracle XML Developer's Kit程序员指南</cite></span></a></p>
                           </li>
                           <li>
                              <p>有关命令行实用程序<code class="codeph">xmldiff</code>信息，请<code class="codeph">xmldiff</code> <a href="../adxdk/determining-XML-differences-using-C.html#ADXDK2540" target="_blank"><span><cite>Oracle XML Developer的Kit程序员指南</cite></span></a></p>
                           </li>
                           <li>
                              <p>有关SQL函数<code class="codeph">XMLDiff</code>信息，请<a href="../sqlrf/XMLDIFF.html#SQLRF20025" target="_blank"><span><cite>参见Oracle数据库SQL语言参考</cite></span></a> 
                              </p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="XML-Schema-evolution.html#GUID-0C97EA66-1890-495D-9117-55FB0D563992" title="就地XML模式演变可以更改XML模式，而无需复制，删除和重新插入现有数据。因此，就地进化比基于复制的进化快得多。然而，就地进化也有一些限制，不适用于基于拷贝的进化。">就地XML架构演变</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="ADXDB4719"></a><a id="ADXDB4718"></a><div class="props_rev_3"><a id="GUID-A40016C6-9610-40D2-8A34-6437ABCAEA0C" name="GUID-A40016C6-9610-40D2-8A34-6437ABCAEA0C"></a><h5 id="ADXDB-GUID-A40016C6-9610-40D2-8A34-6437ABCAEA0C" class="sect5"><span class="enumeration_section">20.3.5.1</span> diffXML操作和示例</h5>
                     <div>
                        <p>描述了可以在提供给过程<code class="codeph">DBMS_XMLSCHEMA.inPlaceEvolve</code>的<code class="codeph">diffXML</code>文档中指定的操作。显示了符合<code class="codeph">xdiff</code> XML模式的示例XML文档。
                        </p>
                        <p><code class="codeph">&lt;append-node&gt;</code>元素用于大多数受支持的更改，例如向复杂类型添加新属性或将新元素附加到组。
                        </p>
                        <p><code class="codeph">&lt;insert-node-before&gt;</code>元素指定应在指定节点之前插入给定类型的节点。<code class="codeph">xpath</code>属性指定指定节点的位置， <code class="codeph">node-type</code>属性指定要插入的节点类型。要插入的节点由<code class="codeph">&lt;content&gt;</code>子元素指定。<code class="codeph">&lt;insert-node-before&gt;</code>元素主要用于插入注释和处理指令，以及用于更改和添加添加注释元素。
                        </p>
                        <p><code class="codeph">&lt;delete-node&gt;</code>元素指定应删除具有给定XPath（由<code class="codeph">xpath</code>属性指定）的节点及其所有子节点。例如，您可以使用此元素删除注释和注释元素。您还可以将此元素与<code class="codeph">&lt;append-node&gt;</code>或<code class="codeph">&lt;insert-node-before&gt;</code> ，以对现有节点进行更改。
                        </p>
                        <p><a href="XML-Schema-evolution.html#GUID-A40016C6-9610-40D2-8A34-6437ABCAEA0C__BCGBHCDH">例20-6</a>显示了<code class="codeph">diffXML</code>参数的XML文档，该文档指定了以下更改：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>删除复杂类型<code class="codeph">PartType</code> 。
                              </p>
                           </li>
                           <li>
                              <p>添加复杂类型<code class="codeph">PartType</code> ，最大长度为28。
                              </p>
                           </li>
                           <li>
                              <p>在元素<code class="codeph">ShippingInstructions</code>之前添加注释。
                              </p>
                           </li>
                           <li>
                              <p>向元素<code class="codeph">ShippingInstructions</code>添加必需的元素<code class="codeph">shipmethod</code> 。
                              </p>
                           </li>
                        </ul>
                        <div class="example" id="GUID-A40016C6-9610-40D2-8A34-6437ABCAEA0C__BCGBHCDH">
                           <p class="titleinexample">例20-6 diffXML参数文档</p><pre class="pre codeblock"><code>&lt;xd：xdiff xmlns =“http://www.w3c.org/2001/XMLSchema”xmlns：xd =“http://xmlns.oracle.com/xdb/xdiff.xsd”xmlns：xsi =“http：/ /www.w3c.org/2001/XMLSchema-Instance“xsi：schemaLocation =”http://xmlns.oracle.com/xdb/xdiff.xsd http://xmlns.oracle.com/xdb/xdiff.xsd“&gt; &lt;xd：delete-node xpath =“/ schema / complexType [@ name =＆quote; PartType＆quote;] // maxLength /&gt; &lt;xd：append-node parent-xpath =”/ schema / complexType [@ name =＆quote; PartType＆quote; ] //限制“node-type =”element“&gt; &lt;xd：content&gt; &lt;xs：maxLength value =”28“/&gt; &lt;/ xd：content&gt; &lt;/ xd：append-node&gt; &lt;xd：insert-node-在xpath =“/ schema / complexType [@name =＆quote; ShippingInstructionsType＆quote;] / sequence”node-type =“comment”&gt; &lt;xd：content&gt; &lt;！ - 表示装运说明的类型 - &gt; &lt;/ xd： content&gt; &lt;/ xd：insert-node-before&gt; &lt;xd：append-node parent-xpath =“/ schema / complexType [@ name =＆quote; ShippingInstructionsType＆quote;] / sequence”node-type =“element”&gt; &lt;xd： content&gt; &lt;xs：element name =“shipmethod”type =“xs：string”minOccurs =“1”/&gt; &lt;/ xd：content&gt; &lt;/ xd：appe nd-node&gt; &lt;/ xd：xdiff&gt;</code></pre></div>
                        <!-- class="example" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="XML-Schema-evolution.html#GUID-4517E8F7-3ADB-464F-9744-189785466F7F" title="过程DBMS_XMLSCHEMA.inPlaceEvolve的参数diffXML的值是一个XMLType实例，它指定要应用于就地演进的XML模式的更改。这个diffXML文档包含一系列操作，用于描述旧XML模式和新XML模式（预期的演化结果）之间的变化。">diffXML参数文档</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>