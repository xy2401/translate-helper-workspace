<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="Lists the sharding functions.">
      <meta name="description" content="Lists the sharding functions.">
      <title>Sharding Functions</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Programmer's Guide">
      <meta property="og:description" content="Lists the sharding functions.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Programmer's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="oracle-call-interface-programmers-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-01-14T08:46:00-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96204-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="transaction-functions.html" title="Previous" type="text/html">
      <link rel="next" href="miscellaneous-functions.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Oracle Call Interface Programmer's Guide">
    <meta name="dcterms.isVersionOf" content="LNOCI">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="transaction-functions.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="miscellaneous-functions.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Programmer's Guide</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="more-database-access-c-api.html" property="item" typeof="WebPage"><span property="name"> More Oracle Database Access C API</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Sharding Functions</li>
            </ol>
            <a id="GUID-CEDBD404-E18E-4CCF-88D1-F13DB20EDA9A" name="GUID-CEDBD404-E18E-4CCF-88D1-F13DB20EDA9A"></a>
            
            <h2 id="LNOCI-GUID-CEDBD404-E18E-4CCF-88D1-F13DB20EDA9A" class="sect2"><span class="enumeration_section">26.8 </span>Sharding Functions
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>Lists the sharding functions.</p>
               <div class="section">
                  <p>The following table lists the sharding OCI functions that are described in this section.</p>
               </div>
               <!-- class="section" -->
               <div class="tblformal" id="GUID-CEDBD404-E18E-4CCF-88D1-F13DB20EDA9A__GUID-84C80772-629D-4A70-ABA2-F66901E1D77A">
                  <p class="titleintable">Table 26-7 Sharding Functions</p>
                  <table cellpadding="4" cellspacing="0" class="Formal" title="Sharding Functions" summary="This table has 2 columns. Column 1 is the OCI function name and column 2 describes its purpose. " frame="hsides" border="1" rules="rows">
                     <thead>
                        <tr align="left" valign="top">
                           <th align="left" valign="bottom" id="d225090e199">Function</th>
                           <th align="left" valign="bottom" id="d225090e201">Purpose</th>
                        </tr>
                     </thead>
                     <tbody>
                        <tr align="left" valign="top">
                           <td align="left" valign="top" id="d225090e205" headers="d225090e199 ">
                              <p><a href="shard-functions.html#GUID-32738F1F-A631-48C1-986F-2E7FAE2D9800" title="Adds sharding key columns to form a compound sharding key or a compound super sharding key.">OCIShardingKeyColumnAdd()</a></p>
                           </td>
                           <td align="left" valign="top" headers="d225090e205 d225090e201 ">
                              <p>Adds sharding key columns to form a compound sharding key or a compound super sharding key.</p>
                           </td>
                        </tr>
                        <tr align="left" valign="top">
                           <td align="left" valign="top" id="d225090e217" headers="d225090e199 ">
                              <p><a href="shard-functions.html#GUID-699532A5-AE5B-42DA-8D90-9C7732C773D3" title="Resets an already created sharding key or super sharding key for reuse with new key column values.">OCIShardingKeyReset()</a></p>
                           </td>
                           <td align="left" valign="top" headers="d225090e217 d225090e201 ">
                              <p>Resets an already created sharding key or super sharding key for reuse with new key column values.</p>
                           </td>
                        </tr>
                        <tr align="left" valign="top">
                           <td align="left" valign="top" id="d225090e229" headers="d225090e199 ">
                              <p><a href="shard-functions.html#GUID-AE0B287B-A515-4B69-9F95-D6894ADB0E9A" title="For use with custom pools only, gets the instance names given a sharding key descriptor, super sharding key descriptor, and a connection string.">OCIShardInstancesGet()</a></p>
                           </td>
                           <td align="left" valign="top" headers="d225090e229 d225090e201 ">
                              <p>Returns instance names for a given sharding key descriptor, super sharding key descriptor, and connection string.</p>
                           </td>
                        </tr>
                     </tbody>
                  </table>
               </div>
               <!-- class="inftblhruleinformal" -->
            </div>
            <div class="sect2"><a id="GUID-32738F1F-A631-48C1-986F-2E7FAE2D9800" name="GUID-32738F1F-A631-48C1-986F-2E7FAE2D9800"></a><h3 id="LNOCI-GUID-32738F1F-A631-48C1-986F-2E7FAE2D9800" class="sect3"><span class="enumeration_section">26.8.1 </span>OCIShardingKeyColumnAdd()
               </h3>
               <div>
                  <p>Adds sharding key columns to form a compound sharding key or a compound super sharding key.</p>
                  <div class="section">
                     <p class="subhead2" id="GUID-32738F1F-A631-48C1-986F-2E7FAE2D9800__GUID-4C1CA362-9B39-40A0-9041-8A929987B12E">Purpose</p>
                     <p>Adds sharding key columns to form a compound sharding key or a compound super sharding key. A sharding key column is a column in a table that is used as the key. If there are multiple columns to be used as the key then it is a compound key.</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-32738F1F-A631-48C1-986F-2E7FAE2D9800__GUID-0475628C-BD1E-43E9-A4A6-24358670BB2D">Syntax</p><pre class="pre codeblock"><code>sword OCIShardingKeyColumnAdd(OCIShardingKey   *shardingKey,
                              OCIError         *errhp,
                              void             *col, 
                              ub4               colLen, 
                              ub2               colType,  
                              ub4               mode);
</code></pre></div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-32738F1F-A631-48C1-986F-2E7FAE2D9800__GUID-08AFDF61-8259-4B66-B4FD-D0A141985084">Parameters</p>
                     <dl>
                        <dt class="dlterm"><a name="GUID-32738F1F-A631-48C1-986F-2E7FAE2D9800__GUID-534E80CB-08F3-4761-946C-0DCD6C126380">
                              <!-- --></a>shardingKey (IN)
                        </dt>
                        <dd>The  sharding key or super sharding key.</dd>
                        <dt class="dlterm"><a name="GUID-32738F1F-A631-48C1-986F-2E7FAE2D9800__GUID-AB8AA98E-835C-4569-B8A4-FF68E9F76237">
                              <!-- --></a>errhp (IN/OUT)
                        </dt>
                        <dd>An error handle that you can pass to <code class="codeph">OCIErrorGet()</code> for diagnostic information in the event of an error.
                        </dd>
                        <dt class="dlterm"><a name="GUID-32738F1F-A631-48C1-986F-2E7FAE2D9800__GUID-8B7AD9B8-EB16-41E2-BAD5-A714172F99DA">
                              <!-- --></a>col (IN)
                        </dt>
                        <dd>The sharding key column, a component of the compound key. For character strings, the values are assumed to be in the client character set (specified by <code class="codeph">NLS_LANG</code> or the <code class="codeph">OCIEnvNLSCreate()</code> call).
                        </dd>
                        <dt class="dlterm"><a name="GUID-32738F1F-A631-48C1-986F-2E7FAE2D9800__GUID-ADDB40F5-D17B-4F42-9BE4-17C0A30D2137">
                              <!-- --></a>colLen (IN)
                        </dt>
                        <dd>Length of the sharding key column.</dd>
                        <dt class="dlterm"><a name="GUID-32738F1F-A631-48C1-986F-2E7FAE2D9800__GUID-789015B3-35AD-4355-9A29-838A1181694D">
                              <!-- --></a>colType (IN)
                        </dt>
                        <dd>The data type of the column.</dd>
                        <dt class="dlterm"><a name="GUID-32738F1F-A631-48C1-986F-2E7FAE2D9800__GUID-958D099A-2116-44CE-AB0E-D40753C58EBF">
                              <!-- --></a>mode (IN)
                        </dt>
                        <dd><code class="codeph">OCI_DEFAULT</code> is the only value supported.
                        </dd>
                     </dl>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-32738F1F-A631-48C1-986F-2E7FAE2D9800__GUID-20D4019E-8564-433C-A35C-BB429ABC5442">Returns</p>
                     <p><code class="codeph">OCI_SUCCESS</code> or <code class="codeph">OCI_ERROR</code></p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-32738F1F-A631-48C1-986F-2E7FAE2D9800__GUID-36E1BDD3-E917-485A-8AB7-E090383297E5">Usage Notes</p>
                     <p>Users must allocate an <code class="codeph">OCIShardingKey</code> descriptor. 
                     </p>
                     <p>Call <code class="codeph">OCIShardingKeyColumnAdd()</code> as many times as there are columns in the compound key (one time for a simple sharding key), in the order in which the key is defined in the database. The <code class="codeph">colType</code> variable indicates the data type of the column. 
                     </p>
                     <p>The following table shows the supported OCI data type values for the <code class="codeph">colType</code> parameter and its corresponding C data type.
                     </p>
                     <div class="tblformal" id="GUID-32738F1F-A631-48C1-986F-2E7FAE2D9800__GUID-C1836B7A-F5E9-444A-AE82-41D2DF18C0B1">
                        <table cellpadding="4" cellspacing="0" class="Formal" title summary="This is a 2&#x2013;column table listing the OCI data type and its corresponding C data type." frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" id="d225090e521">OCI Data Type</th>
                                 <th align="left" valign="bottom" id="d225090e523">C Data Type</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d225090e527" headers="d225090e521 ">SQLT_NUM</td>
                                 <td align="left" valign="top" headers="d225090e527 d225090e523 ">ub1*</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d225090e532" headers="d225090e521 ">SQLT_CHR</td>
                                 <td align="left" valign="top" headers="d225090e532 d225090e523 ">OraText*</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d225090e537" headers="d225090e521 ">SQLT_DATE</td>
                                 <td align="left" valign="top" headers="d225090e537 d225090e523 ">ub1*</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d225090e542" headers="d225090e521 ">SQLT_TIMESTAMP</td>
                                 <td align="left" valign="top" headers="d225090e542 d225090e523 ">OCIDateTime*</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d225090e547" headers="d225090e521 ">SQLT_RAW</td>
                                 <td align="left" valign="top" headers="d225090e547 d225090e523 ">ub1*</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d225090e552" headers="d225090e521 ">SQLT_VNU</td>
                                 <td align="left" valign="top" headers="d225090e552 d225090e523 ">ub1*</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d225090e557" headers="d225090e521 ">SQLT_INT</td>
                                 <td align="left" valign="top" headers="d225090e557 d225090e523 ">int*</td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-32738F1F-A631-48C1-986F-2E7FAE2D9800__GUID-1D72AF2A-708D-4B9E-9E55-419F1A2F18E0">Examples</p>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-32738F1F-A631-48C1-986F-2E7FAE2D9800__GUID-0EB4667C-4B7C-4E6C-B6E6-CD7AEA4D02D4">
                     <p class="titleinexample">Example 26-1 Creating a Compound Sharding Key</p>
                     <p>Use the<code class="codeph"> OCIShardingKey</code> descriptor for the sharding key, then allocate a descriptor and call <code class="codeph">OCIShardingKeyColumnAdd()</code> as many times as needed to create the compound sharding key.
                     </p><pre class="pre codeblock"><code>OCIShardingKey   *shardKey;
text *name = “KK”;
int  empid = 150;

<span class="bold">checker(&amp;status, errhp, OCIDescriptorAlloc(envhp,(dvoid **)&amp;shardKey,
           OCI_DTYPE_SHARDING_KEY, 0,(dvoid **)0)));</span>

/* construct a compound key */

OCIShardingKeyColumnAdd(shardKey, OCIError *errhp,(ub4*)&amp;empid, sizeof(empid), 
                     SQLT_INT, OCI_DEFAULT);
OCIShardingKeyColumnAdd(shardKey, OCIError *errhp, name, strlen(name), 
                     SQLT_CHR, OCI_DEFAULT));
</code></pre></div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="handle-and-descriptor-functions.html#GUID-E9EF2766-E078-49A7-B1D1-738E4BA4814F" title="Allocates storage to hold descriptors or LOB locators.">OCIDescriptorAlloc()</a></li>
                        <li><a href="connect-authorize-and-initialize-functions.html#GUID-1E929CFB-9D96-4E8E-9F24-904AD539E555" title="Initializes a session pool for use with OCI session pooling and database resident connection pooling (DRCP).">OCISessionPoolCreate()</a></li>
                     </ul>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-699532A5-AE5B-42DA-8D90-9C7732C773D3" name="GUID-699532A5-AE5B-42DA-8D90-9C7732C773D3"></a><h3 id="LNOCI-GUID-699532A5-AE5B-42DA-8D90-9C7732C773D3" class="sect3"><span class="enumeration_section">26.8.2 </span>OCIShardingKeyReset()
               </h3>
               <div>
                  <p>Resets an already created sharding key or super sharding key for reuse with new key column values.</p>
                  <div class="section">
                     <p class="subhead2" id="GUID-699532A5-AE5B-42DA-8D90-9C7732C773D3__GUID-3C62296A-B3A3-4BF5-A8B4-6FFBB53B23BC">Purpose</p>
                     <p>A sharding key or super sharding key descriptor can be reset using this routine, which removes all the key column values added prior to this call. After this call, the descriptor can be used to set new key column values.</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-699532A5-AE5B-42DA-8D90-9C7732C773D3__GUID-6A8C9BB9-4FF9-4323-AA58-2367F7B23FEC">Syntax</p><pre class="pre codeblock"><code>sword OCIShardingKeyReset(OCIShardKey *shardKey, 
                          OCIError    *errhp, 
                          ub4          mode);</code></pre></div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-699532A5-AE5B-42DA-8D90-9C7732C773D3__GUID-006DA4E5-1A69-44DD-B7F7-DCB031E97BB5">Parameters</p>
                     <dl>
                        <dt class="dlterm"><a name="GUID-699532A5-AE5B-42DA-8D90-9C7732C773D3__GUID-0CBD15CD-01A9-4631-869D-E7B0B41DE1A5">
                              <!-- --></a>shardKey(IN)
                        </dt>
                        <dd>The sharding key or super sharding key descriptor.</dd>
                        <dt class="dlterm"><a name="GUID-699532A5-AE5B-42DA-8D90-9C7732C773D3__GUID-1A7D2268-1654-44AF-B2A9-D830A9D159EB">
                              <!-- --></a>errhp (IN/OUT)
                        </dt>
                        <dd>An error handle you can pass to <code class="codeph">OCIErrorGet()</code> for diagnostic information in the event of an error.
                        </dd>
                        <dt class="dlterm"><a name="GUID-699532A5-AE5B-42DA-8D90-9C7732C773D3__GUID-B59D5E83-34E1-453A-BDCF-AD7BCC8548DF">
                              <!-- --></a> mode (IN)
                        </dt>
                        <dd><code class="codeph">OCI_DEFAULT</code> is the only value currently supported.
                        </dd>
                     </dl>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-699532A5-AE5B-42DA-8D90-9C7732C773D3__GUID-1925C7CD-DA0C-4F6F-BE66-132AF3266A91">Returns</p>
                     <p><code class="codeph">OCI_SUCCESS</code> or <code class="codeph">OCI_ERROR</code></p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-699532A5-AE5B-42DA-8D90-9C7732C773D3__GUID-5EAD9119-7081-461E-A63A-F6FD710D8C70">Usage Notes</p>
                     <p>None.</p>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="handle-and-descriptor-functions.html#GUID-3741D7BD-7652-4D7A-8813-AC2AEA8D3B03" title="Sets the value of an attribute of a handle or a descriptor.">OCIAttrSet()</a></li>
                        <li><a href="handle-and-descriptor-functions.html#GUID-FA199A99-4D7A-42C2-BB0A-C20047B95DF9" title="Gets the value of an attribute of a handle.">OCIAttrGet()</a></li>
                     </ul>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-AE0B287B-A515-4B69-9F95-D6894ADB0E9A" name="GUID-AE0B287B-A515-4B69-9F95-D6894ADB0E9A"></a><h3 id="LNOCI-GUID-AE0B287B-A515-4B69-9F95-D6894ADB0E9A" class="sect3"><span class="enumeration_section">26.8.3 </span>OCIShardInstancesGet()
               </h3>
               <div>
                  <p>For use with custom pools only, gets the instance names given a sharding key descriptor, super sharding key descriptor, and a connection string.</p>
                  <div class="section">
                     <p class="subhead2" id="GUID-AE0B287B-A515-4B69-9F95-D6894ADB0E9A__GUID-3EA0B96B-4A85-4EB1-9533-CEEC489464B4">Purpose</p>
                     <p>For use with custom pools only, returns instance names for a given sharding key descriptor for a chunk and super sharding key descriptor for a group of chunks and a connection string. Shards are locations in a set of databases where each database stores some part of the data. The part of the data stored at each database is represented by a set of <span class="italic">chunks</span>, where each chunk is associated with a certain range of the data. 
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-AE0B287B-A515-4B69-9F95-D6894ADB0E9A__GUID-17B72E76-0383-4343-A0B7-9EC9B732C98E">Syntax</p><pre class="pre codeblock"><code>sword OCIShardInstancesGet(
           void            **shTopoCtx,
           OCIError         *errhp,
           const OraText    *connstr,
           ub4               constrl,
           OCIShardingKey   *shardingKey,
           OCIShardingKey   *superShardingKey,
           OCIShardinst   ***shardinsts,
           ub4               numShardInsts,        
           ub4               mode);</code></pre></div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-AE0B287B-A515-4B69-9F95-D6894ADB0E9A__GUID-226B8403-5635-4A97-ADAB-B189F0631F9F">Parameters</p>
                     <dl class="0.90* 3.10*">
                        <dt class="dlterm"><a name="GUID-AE0B287B-A515-4B69-9F95-D6894ADB0E9A__GUID-944AA985-40B0-4838-92A0-2E09172EE078">
                              <!-- --></a>shTopoCtx(IN/OUT)
                        </dt>
                        <dd>An opaque context that is created by OCI and returned in the first call to this method for a given connect string. This is an optional parameter and can be passed as <code class="codeph">NULL</code>. For better performance, pass the <code class="codeph">void * shardTopoCtx</code> returned from a prior call (if any) to <code class="codeph">OCIShardInstancesGet()</code> for the same connection string.
                        </dd>
                        <dt class="dlterm"><a name="GUID-AE0B287B-A515-4B69-9F95-D6894ADB0E9A__GUID-8275D3F4-4463-4C67-9344-4C0C381703C0">
                              <!-- --></a>errhp (IN/OUT)
                        </dt>
                        <dd>An error handle you can pass to <code class="codeph">OCIErrorGet()</code> for diagnostic information in the event of an error.
                        </dd>
                        <dt class="dlterm"><a name="GUID-AE0B287B-A515-4B69-9F95-D6894ADB0E9A__GUID-0ADF692A-68C5-46EA-A4B2-AB8DDAE4EB0C">
                              <!-- --></a>connstr (IN)
                        </dt>
                        <dd>The original connect string passed by the application to the <code class="codeph">OCISessionGet()</code> call.
                        </dd>
                        <dt class="dlterm"><a name="GUID-AE0B287B-A515-4B69-9F95-D6894ADB0E9A__GUID-21696ACF-4238-4A51-85F9-8194C80B6A10">
                              <!-- --></a>connstrl(IN)
                        </dt>
                        <dd>Length of the <code class="codeph">connstr</code> parameter.
                        </dd>
                        <dt class="dlterm"><a name="GUID-AE0B287B-A515-4B69-9F95-D6894ADB0E9A__GUID-FE45F0A6-F4EE-4F89-A128-D4BAB2D78063">
                              <!-- --></a>shardingKey (IN)
                        </dt>
                        <dd>The sharding key for the desired chunk.</dd>
                        <dt class="dlterm"><a name="GUID-AE0B287B-A515-4B69-9F95-D6894ADB0E9A__GUID-7188CA8C-C781-4290-9BBB-684482B46893">
                              <!-- --></a>superShardingKey (IN)
                        </dt>
                        <dd>The super sharding key for the desired chunk; this value can be NULL.</dd>
                        <dt class="dlterm"><a name="GUID-AE0B287B-A515-4B69-9F95-D6894ADB0E9A__GUID-48FCE995-7E78-4C84-AF50-28713578F94F">
                              <!-- --></a>shardInsts(OUT)
                        </dt>
                        <dd>An array of <code class="codeph">OCIShardInst</code> descriptors corresponding to instances that serve the chunk associated with the sharding key and super sharding key.
                        </dd>
                        <dt class="dlterm"><a name="GUID-AE0B287B-A515-4B69-9F95-D6894ADB0E9A__GUID-47501269-18B7-4957-9329-C687698AAFA9">
                              <!-- --></a>numShardInsts(OUT)
                        </dt>
                        <dd>The number of elements in <code class="codeph">shardInsts</code>.
                        </dd>
                        <dt class="dlterm"><a name="GUID-AE0B287B-A515-4B69-9F95-D6894ADB0E9A__GUID-ACA34836-5CE7-44C3-9711-75008A502BE7">
                              <!-- --></a>mode(IN)
                        </dt>
                        <dd><code class="codeph">OCI_DEFAULT</code> is the only value supported.
                        </dd>
                     </dl>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-AE0B287B-A515-4B69-9F95-D6894ADB0E9A__GUID-9C2DB107-CA3A-4484-A989-28A798E298B3">Returns</p>
                     <p><code class="codeph">OCI_SUCCESS</code> or <code class="codeph">OCI_ERROR</code></p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-AE0B287B-A515-4B69-9F95-D6894ADB0E9A__GUID-76031CBE-3712-4E70-A9DF-205A368482EA">Usage Notes</p>
                     <p>None.</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-AE0B287B-A515-4B69-9F95-D6894ADB0E9A__GUID-604EFF13-1C76-4DB8-8A85-280ADE3DEC84">Examples</p>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-AE0B287B-A515-4B69-9F95-D6894ADB0E9A__GUID-2C71D9BE-F087-46DA-AA8D-29DB4222F6AA">
                     <p class="titleinexample">Example 26-2 Custom Pool Example</p>
                     <p>This example uses a custom pool and illustrates how to get the instance name of a given connection and how to look up for instances hosting a given sharding key, shard name, and super sharding name for a given connection. If there is no matching connection in the custom pool, it creates a new connection.</p><pre class="pre codeblock"><code>&nbsp;&nbsp;&nbsp;&nbsp;OCIShardInstancesGet( &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                       &amp;shTopoCtx, 
                       errhp,
                       connstr,
                       strlen(connstrl),
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  &nbsp;&nbsp;&nbsp;&nbsp;shardingKey,
                       superShardingKey,
                       &amp;shardInsts,
                       &amp;numShardInsts,
                       OCI_DEFAULT);  &nbsp;&nbsp;

&nbsp;/* Iterate through all the shard instances that have the data satisfying the sharding key. */
 &nbsp;&nbsp;
  &nbsp;for (k=0; k &lt; numShardInsts; k++ ) &nbsp;&nbsp;&nbsp;&nbsp;
   { &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    &nbsp;OCIAttrGet(shardInstances[k], &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
               (ub4) OCI_DTYPE_SHARD_INST,
               (dvoid *)&amp;iName, 
               (ub4 *)&amp;inameLen, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
               &nbsp;OCI_ATTR_INSTNAME, 
               (OCIError *)errhp);
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
/* Look up in the custom pool for a connection to the same shard instance. */&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
/* The following attribute can be used to find the instance name. */&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

   OCIAttrGet(svchp[i], 
              OCI_HTYPE_SVCCTX, 
              &amp;cshardName[i], 
              (ub4 *) &amp;cshardNameLen[i], &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
              OCI_ATTR_INSTNAME, errhp);  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

/* If a matching connection is found (iName and cshardName[i]). */&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;
   &nbsp;{ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    &nbsp;OCIAttrSet(svchp[i], 
               OCI_HTYPE_SVCCTX, 
               shardingKey, 
               sizeof(shardingKey), &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
               OCI_ATTR_SHARDING_KEY, 
               errhp); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

/* Return that connection to the requester. */ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    return svchp[i]; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
   } &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  } &nbsp;&nbsp;&nbsp;&nbsp;

/* If no free existing connection is found, create a new connection in the pool and return it. */ &nbsp;&nbsp;&nbsp;
&nbsp; { &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
   OCIAttrSet(authp, 
              OCI_HTYPE_AUTHINFO, 
              shardingKey, 
              sizeof(shardingKey), 
              OCI_ATTR_SHARDING_KEY, 
              errhp); 
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
   OCISessionGet ((OCIEnv *)envhp, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                  (OCIError *)errhp, 
                  (OCISvcCtx **)&amp;mysvc, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                  (OCIAuthInfo *)authp, 
                  (OraText *)connstr, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                  (ub4)strlen((char*)connstrl), 
                  (OraText *)NULL, (ub4)0, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                  (OraText **)0, (ub4 *)0, 
                  (boolean *)0,OCI_SESSGET_CUSTOM_POOL); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  &nbsp;return mysvc; /* Track in the pool too. */ &nbsp;&nbsp;&nbsp;&nbsp;
 &nbsp;}
</code></pre></div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="handle-and-descriptor-functions.html#GUID-3741D7BD-7652-4D7A-8813-AC2AEA8D3B03" title="Sets the value of an attribute of a handle or a descriptor.">OCIAttrSet()</a></li>
                        <li><a href="handle-and-descriptor-functions.html#GUID-FA199A99-4D7A-42C2-BB0A-C20047B95DF9" title="Gets the value of an attribute of a handle.">OCIAttrGet()</a></li>
                        <li><a href="connect-authorize-and-initialize-functions.html#GUID-890DFBC4-718B-4339-A0EA-6226A25B8241" title="Gets a session.">OCISessionGet()</a></li>
                     </ul>
                  </div>
               </div>
               
            </div>
         </div>
      </article>
   </body>
</html>