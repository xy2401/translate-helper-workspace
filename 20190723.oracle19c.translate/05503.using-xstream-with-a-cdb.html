<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="You can use Oracle Database XStream in a multitenant container database (CDB).">
      <meta name="description" content="You can use Oracle Database XStream in a multitenant container database (CDB).">
      <title>Using XStream with a CDB</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Administrator’s Guide ">
      <meta property="og:description" content="You can use Oracle Database XStream in a multitenant container database (CDB).">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Administrator’s Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="multitenant-administrators-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-03-20T09:59:22-07:00">
      
      <meta name="dcterms.dateCopyrighted" content="2017, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96136-03">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="using-oracle-database-vault-with-a-cdb.html" title="Previous" type="text/html">
      <link rel="next" href="glossary.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Multitenant Administrator's Guide">
    <meta name="dcterms.isVersionOf" content="MULTI">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="using-oracle-database-vault-with-a-cdb.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="glossary.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Administrator’s Guide </span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="using-oracle-features-in-a-multitenant-environment.html" property="item" typeof="WebPage"><span property="name">Using Oracle Features in a Multitenant Environment</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem"> Using XStream with a CDB</li>
            </ol>
            <a id="GUID-37EA80B6-8131-46C9-8CB8-CA597ACE5563" name="GUID-37EA80B6-8131-46C9-8CB8-CA597ACE5563"></a>
            
            <h2 id="MULTI-GUID-37EA80B6-8131-46C9-8CB8-CA597ACE5563" class="sect2"><span class="enumeration_chapter">25 </span> Using XStream with a CDB
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>You can use  Oracle Database XStream in a multitenant container database (CDB).</p>
               <p>This chapter contains the following topics:</p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="using-xstream-with-a-cdb.html#GUID-644C0567-E409-4611-9D9E-C5C51FBF2DE0">About XStream</a><br>XStream consists of Oracle Database components and application programming interfaces (APIs) that enable client applications to receive data changes from an Oracle database and send data changes to an Oracle database. 
                  </li>
                  <li class="ulchildlink"><a href="using-xstream-with-a-cdb.html#GUID-CBD258F9-D53D-4DA8-98CE-D87232D06655">System-Created Rules and a Multitenant Environment</a><br>A multitenant environment enables an Oracle database to contain a portable set of schemas, objects, and related structures that appears logically to an application as a separate database. This self-contained collection is called a pluggable database (PDB). A CDB contains PDBs.
                  </li>
                  <li class="ulchildlink"><a href="using-xstream-with-a-cdb.html#GUID-6F932401-47F6-4A5A-BA72-EBFF2342C579">XStream Out and a Multitenant Environment</a><br>A multitenant environment enables a database to contain a portable set of schemas, objects, and related structures that appears logically to an application as a separate database. 
                  </li>
                  <li class="ulchildlink"><a href="using-xstream-with-a-cdb.html#GUID-1DBE4654-FA5C-4968-90FC-A2F79AA6B719">Configuring XStream Out in a CDB</a><br>When you configure XStream Out in a CDB, you must decide which database changes will be captured by XStream Out and sent to the client application. 
                  </li>
                  <li class="ulchildlink"><a href="using-xstream-with-a-cdb.html#GUID-4E7FDA7C-002C-41D3-8E7C-2918913C2B13">XStream In and a Multitenant Environment</a><br>A multitenant environment enables an Oracle database to contain a portable set of schemas, objects, and related structures that appears logically to an application as a separate database.
                  </li>
               </ul>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>Parent topic:</strong> <a href="using-oracle-features-in-a-multitenant-environment.html#GUID-CE922DAA-66FB-430B-96E5-29FF50BFD2FF" title="You can use Oracle Database features in a multitenant environment.">Using Oracle Features in a Multitenant Environment</a></p>
                  </div>
               </div>
            </div>
            
            <div class="props_rev_3"><a id="GUID-644C0567-E409-4611-9D9E-C5C51FBF2DE0" name="GUID-644C0567-E409-4611-9D9E-C5C51FBF2DE0"></a><h3 id="MULTI-GUID-644C0567-E409-4611-9D9E-C5C51FBF2DE0" class="sect3"><span class="enumeration_section">25.1 </span>About XStream
               </h3>
               <div>
                  <p>XStream consists of Oracle Database components and application programming interfaces (APIs) that enable client applications to receive data changes from an Oracle database and send data changes to an Oracle database. </p>
                  <p>These data changes can be shared between Oracle databases and other systems. The other systems include non-Oracle databases, non-RDBMS Oracle products, file systems, third party software applications, and so on. A client application is designed by the user for specific purposes and use cases.</p>
                  <p>XStream consists of two major features: XStream Out and XStream In. <span class="bold">XStream Out</span> provides Oracle Database components and APIs that enable you to share data changes made to an Oracle database with other systems. XStream Out can retrieve both data manipulation language (DML) and data definition language (DDL) changes from the redo log and send these changes to a client application that uses the APIs, as shown in the following figure.
                  </p>
                  <div class="figure" id="GUID-644C0567-E409-4611-9D9E-C5C51FBF2DE0__CHDIAHDB">
                     <p class="titleinfigure">Figure 25-1 XStream Out</p><img src="img/xstrm082.png" width="380" alt="Description of Figure 25-1 follows" title="Description of Figure 25-1 follows" longdesc="img_text/xstrm082.html"><br><a href="img_text/xstrm082.html">Description of "Figure 25-1 XStream Out"</a></div>
                  <!-- class="figure" -->
                  <p><span class="bold">XStream In</span> provides Oracle Database components and APIs that enable you to share data changes made to other systems with an Oracle database. XStream In can apply these changes to database objects in the Oracle database, as shown in the following figure.
                  </p>
                  <div class="figure" id="GUID-644C0567-E409-4611-9D9E-C5C51FBF2DE0__CHDHFBIB">
                     <p class="titleinfigure">Figure 25-2 XStream In</p><img src="img/xstrm083.png" width="380" alt="Description of Figure 25-2 follows" title="Description of Figure 25-2 follows" longdesc="img_text/xstrm083.html"><br><a href="img_text/xstrm083.html">Description of "Figure 25-2 XStream In"</a></div>
                  <!-- class="figure" -->
                  <p>XStream uses the capture and apply features of the Oracle database. These features enable the following functionality for XStream:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>The logical change record (LCR) format for streaming database changes</p>
                        <p>An <span class="bold">LCR</span> is a message with a specific format that describes a database change. If the change was a data manipulation language (DML) operation, then a <span class="bold">row LCR</span> encapsulates each row change resulting from the DML operation. One DML operation might result in multiple row changes, and so one DML operation might result in multiple row LCRs. If the change was a data definition language (DDL) operation, then a single <span class="bold">DDL LCR</span> encapsulates the DDL change.
                        </p>
                     </li>
                     <li>
                        <p>Rules and rule sets that control behavior, including inclusion and exclusion rules</p>
                        <p>Rules enable the filtering of database changes at the database level, schema level, table level, and row/column level.</p>
                     </li>
                     <li>
                        <p>Rule-based transformations that modify captured data changes</p>
                     </li>
                     <li>
                        <p>Support for most data types in the database, including LOBs, <code class="codeph">LONG</code>, <code class="codeph">LONG</code> <code class="codeph">RAW</code>, and <code class="codeph">XMLType</code></p>
                     </li>
                     <li>
                        <p>Customized configurations, including multiple inbound streams to a single database instance, multiple outbound streams from a single database instance, multiple outbound streams from a single capture process, and so on</p>
                     </li>
                     <li>
                        <p>Full-featured apply for XStream In, including apply parallelism for optimal performance, SQL generation, conflict detection and resolution, error handling, and customized apply with apply handlers</p>
                     </li>
                  </ul>
                  <div class="infoboxnote" id="GUID-644C0567-E409-4611-9D9E-C5C51FBF2DE0__GUID-D13C098C-7C9E-43CD-BECB-D062D7F3621B">
                     <p class="notep1">Note:</p>
                     <p>In both XStream Out and XStream In configurations, the client application must use a dedicated server connection.</p>
                  </div>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="../xstrm/introduction-to-xstream.html#XSTRM-GUID-5939CB6C-8BA9-4594-8F96-B0453D246722" target="_blank"><span><cite>Oracle Database XStream Guide</cite></span></a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-xstream-with-a-cdb.html#GUID-37EA80B6-8131-46C9-8CB8-CA597ACE5563" title="You can use Oracle Database XStream in a multitenant container database (CDB).">Using XStream with a CDB</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="props_rev_3"><a id="GUID-CBD258F9-D53D-4DA8-98CE-D87232D06655" name="GUID-CBD258F9-D53D-4DA8-98CE-D87232D06655"></a><h3 id="MULTI-GUID-CBD258F9-D53D-4DA8-98CE-D87232D06655" class="sect3"><span class="enumeration_section">25.2 </span>System-Created Rules and a Multitenant Environment
               </h3>
               <div>
                  <p>A multitenant environment enables an Oracle database to contain a portable set of schemas, objects, and related structures that appears logically to an application as a separate database. This self-contained collection is called a pluggable database (PDB). A CDB contains PDBs.</p>
                  <p>It can also contain application containers. An application container is an optional component of a CDB that consists of an application root and the application PDBs associated with it. An application container stores data for one or more applications. An application container shares application metadata and common data. In a CDB, each of the following is a container: the CDB root, each PDB, each application root, and each application PDB.</p>
                  <p>In a CDB, LCRs can contain the global name of the container where the change originated in the <code class="codeph">source_database_name</code> attribute and the global name of the CDB root in the <code class="codeph">root_name</code> attribute. The rules for XStream components can consider these attributes.
                  </p>
                  <p>This section contains the following topics:</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="using-xstream-with-a-cdb.html#GUID-60589C03-2095-42AA-8F2F-AFD83B110F31">System-Created Rules in a CDB and XStream Out</a><br>In a CDB, XStream Out must be configured in the CDB root. Therefore, the PL/SQL procedures in the <code class="codeph">DBMS_XSTREAM_ADM</code> package that create system-created rules must be run in the CDB root while connected as a common user.
                     </li>
                     <li class="ulchildlink"><a href="using-xstream-with-a-cdb.html#GUID-8B64C3F0-2EB0-495B-BB29-A08F1A1CD7C9">System-Created Rules in a CDB and XStream In</a><br>You can configure XStream In in the root or in any container in a CDB.
                     </li>
                  </ul>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="multitenant-architecture.html#GUID-BBAD3448-8A5A-4397-BD3A-F05D945DB7F8" title="The multitenant architecture enables an Oracle database to function as a multitenant container database (CDB).">Multitenant Architecture</a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-xstream-with-a-cdb.html#GUID-37EA80B6-8131-46C9-8CB8-CA597ACE5563" title="You can use Oracle Database XStream in a multitenant container database (CDB).">Using XStream with a CDB</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="props_rev_3"><a id="GUID-60589C03-2095-42AA-8F2F-AFD83B110F31" name="GUID-60589C03-2095-42AA-8F2F-AFD83B110F31"></a><h4 id="MULTI-GUID-60589C03-2095-42AA-8F2F-AFD83B110F31" class="sect4"><span class="enumeration_section">25.2.1 </span>System-Created Rules in a CDB and XStream Out
                  </h4>
                  <div>
                     <p>In a CDB, XStream Out must be configured in the CDB root. Therefore, the PL/SQL procedures in the <code class="codeph">DBMS_XSTREAM_ADM</code> package that create system-created rules must be run in the CDB root while connected as a common user.
                     </p>
                     <p>Excluding the procedures that create rules for propagations, the procedures that create system-created rules for XStream Out, such as the <code class="codeph">ADD_GLOBAL_RULES</code> procedure, include the key parameters in the following table:
                     </p>
                     <div class="tblformal" id="GUID-60589C03-2095-42AA-8F2F-AFD83B110F31__GUID-F2B0932E-2D66-4652-A805-A570A10E53C4">
                        <p class="titleintable">Table 25-1 Key Procedure Parameters for System-Created Rules in a CDB</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="Key Procedure Parameters for System-Created Rules in a CDB" summary="This table describes the parameters for system-created rules in a CDB." width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="25%" id="d115896e510">Parameter</th>
                                 <th align="left" valign="bottom" width="75%" id="d115896e513">Description</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="25%" id="d115896e518" headers="d115896e510 ">
                                    <p><code class="codeph">source_database</code></p>
                                 </td>
                                 <td align="left" valign="top" width="75%" headers="d115896e518 d115896e513 ">
                                    <p>The global name of the source database. In a CDB, specify the global name of the container to which the rules pertain. The container can be the CDB root, a PDB, an application root, or an application PDB. The following are examples: <code class="codeph">mycdb.example.com</code> or <code class="codeph">hrpdb.example.com</code>.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="25%" id="d115896e532" headers="d115896e510 ">
                                    <p><code class="codeph">source_root_name</code></p>
                                 </td>
                                 <td align="left" valign="top" width="75%" headers="d115896e532 d115896e513 ">
                                    <p>The global name of the CDB root in the source CDB. The following are examples: <code class="codeph">mycdb.example.com</code>. 
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="25%" id="d115896e543" headers="d115896e510 ">
                                    <p><code class="codeph">source_container_name</code></p>
                                 </td>
                                 <td align="left" valign="top" width="75%" headers="d115896e543 d115896e513 ">
                                    <p>The short name of the source container. The container can be the CDB root, a PDB, an application root, or an application PDB. The following are examples: <code class="codeph">CDB$ROOT</code> or <code class="codeph">hrpdb</code>.
                                    </p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p>If you do not include the domain name when you specify <code class="codeph">source_database</code> or <code class="codeph">source_root_name</code>, then the procedure appends it to the name automatically. For example, if you specify <code class="codeph">DBS1</code> and the domain is <code class="codeph">.EXAMPLE.COM</code>, then the procedure specifies <code class="codeph">DBS1.EXAMPLE.COM</code> automatically.
                     </p>
                     <p>The combination of these key parameters determines which containers' changes XStream Out captures and streams to the client application, based on the rules generated by the procedures. Regardless of the settings for these parameters, system-generated rules can still limit the changes captured and streamed to specific schemas and tables.</p>
                     <p>Local capture means that a capture process runs on the source CDB. In a local capture configuration, the <code class="codeph">source_root_name</code> parameter specifies the global name of the CDB root in the local CDB. If this parameter is <code class="codeph">NULL</code>, then the global name of the CDB root in the local CDB is specified automatically. The resulting rules include a condition for the global name of the CDB root in the current CDB.
                     </p>
                     <p>Downstream capture means that a capture process runs on a CDB other than the source CDB. In a downstream capture configuration, the <code class="codeph">source_root_name</code> parameter must be non-<code class="codeph">NULL</code>, and it must specify the global name of the CDB root in the remote source CDB. The resulting rules include a condition for the global name of the CDB root in the remote CDB. If this parameter is <code class="codeph">NULL</code>, then local capture is assumed. 
                     </p>
                     <p>The following table describes the rule conditions for various <code class="codeph">source_database</code> and <code class="codeph">source_container_name</code> parameter settings in a local capture configuration.
                     </p>
                     <div class="tblformal" id="GUID-60589C03-2095-42AA-8F2F-AFD83B110F31__BABFDIDE">
                        <p class="titleintable">Table 25-2 Local Capture and XStream Out Container Rule Conditions</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="Local Capture and XStream Out Container Rule Conditions" summary="This table shows different values of the source_root_name and source_database parameters and describes the resulting rules in a local capture configuration." width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="25%" id="d115896e613">source_database Parameter Setting</th>
                                 <th align="left" valign="bottom" width="25%" id="d115896e616">source_container_name Parameter Setting</th>
                                 <th align="left" valign="bottom" width="50%" id="d115896e619">Description</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="25%" id="d115896e624" headers="d115896e613 ">
                                    <p><code class="codeph">NULL</code></p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d115896e624 d115896e616 ">
                                    <p><code class="codeph">NULL</code></p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d115896e624 d115896e619 ">
                                    <p>XStream Out captures and streams changes made in any container in the local CDB, including the CDB root, all PDBs, all application roots, and all application PDBs.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="25%" id="d115896e636" headers="d115896e613 ">
                                    <p>non-<code class="codeph">NULL</code></p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d115896e636 d115896e616 ">
                                    <p><code class="codeph">NULL</code></p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d115896e636 d115896e619 ">
                                    <p>XStream Out captures and streams changes made in the specified source container of the local CDB. The source container can be the CDB root, a PDB, an application root, or an application PDB. The <code class="codeph">DBMS_XSTREAM_ADM</code> procedure queries the <code class="codeph">CDB_PDBS</code> view and <code class="codeph">CDB_PROPERTIES</code> view to determine the <code class="codeph">source_container_name</code> value.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="25%" id="d115896e661" headers="d115896e613 ">
                                    <p><code class="codeph">NULL</code></p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d115896e661 d115896e616 ">
                                    <p>non-<code class="codeph">NULL</code></p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d115896e661 d115896e619 ">
                                    <p>XStream Out captures and streams changes made in the specified source container of the local CDB. The source container can be the CDB root, a PDB, an application root, or an application PDB. The <code class="codeph">DBMS_XSTREAM_ADM</code> procedure queries the <code class="codeph">CDB_PDBS</code> view and <code class="codeph">CDB_PROPERTIES</code> view to determine the <code class="codeph">source_database</code> value.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="25%" id="d115896e686" headers="d115896e613 ">
                                    <p>non-<code class="codeph">NULL</code></p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d115896e686 d115896e616 ">
                                    <p>non-<code class="codeph">NULL</code></p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d115896e686 d115896e619 ">
                                    <p>XStream Out captures and streams changes made in the specified source container of the local CDB. The source container can be the CDB root, a PDB, an application root, or an application PDB.</p>
                                    <p>If the prefix of the <code class="codeph">source_database</code> value is different from the <code class="codeph">source_container_name</code> value, then the resulting rules include a condition for the <code class="codeph">source_database</code> value, and an internal table maps the <code class="codeph">source_database</code> value to the <code class="codeph">source_container_name</code> value.
                                    </p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p>The following table describes the rule conditions for various <code class="codeph">source_database</code> and <code class="codeph">source_container_name</code> parameter settings in a downstream capture configuration.
                     </p>
                     <div class="tblformal" id="GUID-60589C03-2095-42AA-8F2F-AFD83B110F31__BABIDHGF">
                        <p class="titleintable">Table 25-3 Downstream Capture and XStream Out Container Rule Conditions</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="Downstream Capture and XStream Out Container Rule Conditions" summary="This table shows different values of the source_root_name and source_database parameters and describes the resulting rules in a downstream capture configuration." width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="25%" id="d115896e735">source_database Parameter Setting</th>
                                 <th align="left" valign="bottom" width="25%" id="d115896e738">source_container_name Parameter Setting</th>
                                 <th align="left" valign="bottom" width="50%" id="d115896e741">Description</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="25%" id="d115896e746" headers="d115896e735 ">
                                    <p><code class="codeph">NULL</code></p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d115896e746 d115896e738 ">
                                    <p><code class="codeph">NULL</code></p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d115896e746 d115896e741 ">
                                    <p>XStream Out captures and streams changes made in any container in the remote source CDB, including the CDB root, all PDBs, all application roots, and all application PDBs.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="25%" id="d115896e758" headers="d115896e735 ">
                                    <p>non-<code class="codeph">NULL</code></p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d115896e758 d115896e738 ">
                                    <p><code class="codeph">NULL</code></p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d115896e758 d115896e741 ">
                                    <p>XStream Out captures and streams changes made in the specified source container of the remote source CDB. The source container can be the CDB root, a PDB, an application root, or an application PDB. The <code class="codeph">DBMS_XSTREAM_ADM</code> procedure derives the <code class="codeph">source_container_name</code> value from the prefix of <code class="codeph">source_database</code> value.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="25%" id="d115896e780" headers="d115896e735 ">
                                    <p><code class="codeph">NULL</code></p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d115896e780 d115896e738 ">
                                    <p>non-<code class="codeph">NULL</code></p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d115896e780 d115896e741 ">
                                    <p>The <code class="codeph">DBMS_XSTREAM_ADM</code> procedure raises an error.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="25%" id="d115896e796" headers="d115896e735 ">
                                    <p>non-<code class="codeph">NULL</code></p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d115896e796 d115896e738 ">
                                    <p>non-<code class="codeph">NULL</code></p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d115896e796 d115896e741 ">
                                    <p>XStream Out captures and streams changes made in the specified source container of the remote source CDB. The source container can be the CDB root, a PDB, an application root, or an application PDB.</p>
                                    <p>If the prefix of the <code class="codeph">source_database</code> value is different from the <code class="codeph">source_container_name</code> value, then the resulting rules include a condition for the <code class="codeph">source_database</code> value, and an internal table maps the <code class="codeph">source_database</code> value to the <code class="codeph">source_container_name</code> value.
                                    </p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="../xstrm/xstream-out-concepts.html#XSTRM-GUID-CC32AED8-6587-4CA7-8786-CDF2C4968DB1" target="_blank"><span><cite>Oracle Database XStream Guide</cite></span></a></li>
                           <li><a href="../arpls/DBMS_XSTREAM_ADM.html#ARPLS-GUID-1ABE7BC0-9252-44A0-A6B8-1E3AE8D085C9" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-xstream-with-a-cdb.html#GUID-CBD258F9-D53D-4DA8-98CE-D87232D06655" title="A multitenant environment enables an Oracle database to contain a portable set of schemas, objects, and related structures that appears logically to an application as a separate database. This self-contained collection is called a pluggable database (PDB). A CDB contains PDBs.">System-Created Rules and a Multitenant Environment</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="props_rev_3"><a id="GUID-8B64C3F0-2EB0-495B-BB29-A08F1A1CD7C9" name="GUID-8B64C3F0-2EB0-495B-BB29-A08F1A1CD7C9"></a><h4 id="MULTI-GUID-8B64C3F0-2EB0-495B-BB29-A08F1A1CD7C9" class="sect4"><span class="enumeration_section">25.2.2 </span>System-Created Rules in a CDB and XStream In
                  </h4>
                  <div>
                     <p>You can configure XStream In in the root or in any container in a CDB.</p>
                     <p>Typically, an inbound server does not use rule sets or rules. Instead, it usually processes all LCRs that it receives from its client application. An inbound server can apply changes to the current container only. Therefore, if an inbound server is configured in the CDB root, then it can apply changes only to the CDB root. If an inbound server is configured in a PDB, then it can apply changes only to that PDB.  If an inbound server is configured in an application root, then it can apply changes only to that application root, and if an inbound server is configured in an application PDB, then it can apply changes only to that application PDB.</p>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="managing-a-multitenant-environment.html#GUID-93F1E584-D309-4301-82E0-AD0E60D4977C" title="You can administer a multitenant environment using SQL*Plus or Enterprise Manager Cloud Control (Cloud Control).">Administering a Multitenant Environment</a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-xstream-with-a-cdb.html#GUID-CBD258F9-D53D-4DA8-98CE-D87232D06655" title="A multitenant environment enables an Oracle database to contain a portable set of schemas, objects, and related structures that appears logically to an application as a separate database. This self-contained collection is called a pluggable database (PDB). A CDB contains PDBs.">System-Created Rules and a Multitenant Environment</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
            <div class="props_rev_3"><a id="GUID-6F932401-47F6-4A5A-BA72-EBFF2342C579" name="GUID-6F932401-47F6-4A5A-BA72-EBFF2342C579"></a><h3 id="MULTI-GUID-6F932401-47F6-4A5A-BA72-EBFF2342C579" class="sect3"><span class="enumeration_section">25.3 </span>XStream Out and a Multitenant Environment
               </h3>
               <div>
                  <p>A multitenant environment enables a database to contain a portable set of schemas, objects, and related structures that appears logically to an application as a separate database. </p>
                  <p>This self-contained collection is called a pluggable database (PDB). A multitenant container database (CDB) contains PDBs. In a CDB, XStream Out functions much the same as it does in a non-CDB.</p>
                  <p>A CDB can also contain application containers. An application container is an optional component of a CDB that consists of an application root and all application PDBs associated with it. An application container stores data for one or more applications. An application container shares application metadata and common data. In a CDB, each of the following is a container: the CDB root, each PDB, each application root, and each application PDB.</p>
                  <p>The main differences in the way XStream Out functions in a CDB and non-CDB are:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>XStream Out must be configured only in the CDB root.</p>
                     </li>
                     <li>
                        <p>XStream Out can see changes made to any container within the CDB.</p>
                     </li>
                     <li>
                        <p>XStream Out capture rules can limit the LCRs to those that are needed for the client application. The system-generated capture rules select the appropriate LCRs based on the parameters that were passed to the <code class="codeph">ADD_OUTBOUND</code> and <code class="codeph">CREATE_OUTBOUND</code> procedures in the <code class="codeph">DBMS_XSTREAM_ADM</code> package. You can use the <code class="codeph">ADD_*_RULES</code> procedures in the same package for more fine-grained control over the rules used by the XStream Out components.
                        </p>
                     </li>
                     <li>
                        <p>The user who performs XStream Out tasks must be a common user. </p>
                     </li>
                  </ul>
                  <div class="section">
                     <p class="subhead2" id="GUID-6F932401-47F6-4A5A-BA72-EBFF2342C579__GUID-2524370F-946C-4514-87C4-558B2DEA6DDB">Unplug and Plug Operations in an XStream Environment</p>
                     <p>When a PDB, application root, or application PDB involved with XStream Out is unplugged from its CDB and plugged into another CDB, any capture process or outbound server is not considered part of the container. You must configure the capture process and outbound server again in the other CDB.</p>
                     <p>If an outbound server is configured in a different database than the capture process, then unplug and plug operations have additional considerations.</p>
                     <p>For this example, assume the following:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>A CDB named <code class="codeph">CDB1</code> contains PDB <code class="codeph">PDB1</code>. 
                           </p>
                        </li>
                        <li>
                           <p>A capture process is configured in <code class="codeph">CDB1</code>, and it sends LCRs from <code class="codeph">PDB1</code> to an outbound server in a CDB named <code class="codeph">CDB2</code>.
                           </p>
                        </li>
                        <li>
                           <p>You unplug <code class="codeph">PDB1</code> from <code class="codeph">CDB1</code>, and then plug it into a CDB named <code class="codeph">CDB3</code>.
                           </p>
                        </li>
                     </ul>
                     <p>To continue delivering LCRs from <code class="codeph">PDB1</code> to the outbound server in <code class="codeph">CDB2</code>, you must configure a new capture process in <code class="codeph">CDB3</code> to capture and send LCRs to <code class="codeph">CDB2</code>.
                     </p>
                     <p>The rules used by the outbound server in database B must be altered to change references to the root of <code class="codeph">CDB1</code> to the root of <code class="codeph">CDB3</code>. In addition, if <code class="codeph">PDB1</code> was given a different name in <code class="codeph">CDB3</code>, then the rules must be altered to reflect the new PDB name.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-6F932401-47F6-4A5A-BA72-EBFF2342C579__GUID-C5293004-860E-49E9-9987-BDD1DCC0D1AD">Application Containers in an XStream Environment</p>
                     <p>When a CDB has one or more application containers, XStream Out must be configured in the CDB root, and XStream Out can capture changes made in any container in the CDB, including the application roots and application PDBs. Changes captured in an application container can be sent to containers of any type, including PDBs, application roots, and application PDBs.</p>
                     <p>When replicating changes from one application root to another application root, XStream can replicate <code class="codeph">ALTER PLUGGABLE DATABASE APPLICATION</code> statements. To avoid errors, the target application root that applies the statements must have the same application installed as the source application root, and the application name must be identical in both application roots.
                     </p>
                     <p>To avoid errors when replicating changes from an application root to a container that is not an application root, you must ensure that <code class="codeph">ALTER PLUGGABLE DATABASE APPLICATION</code> statements are not replicated.
                     </p>
                     <p>With the XStream OCI API, you can control whether <code class="codeph">ALTER PLUGGABLE DATABASE APPLICATION</code> statements are replicated using the <code class="codeph">OCIXStreamOutAttach</code> function and the <code class="codeph">OCILCRHeaderGet</code> function. With the XStream Java API, you can control this behavior using the <code class="codeph">mode</code> parameter in the <code class="codeph">XStreamOut.attach</code> method.
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="using-xstream-with-a-cdb.html#GUID-CBD258F9-D53D-4DA8-98CE-D87232D06655" title="A multitenant environment enables an Oracle database to contain a portable set of schemas, objects, and related structures that appears logically to an application as a separate database. This self-contained collection is called a pluggable database (PDB). A CDB contains PDBs.">System-Created Rules and a Multitenant Environment</a></li>
                        <li><a href="using-xstream-with-a-cdb.html#GUID-1DBE4654-FA5C-4968-90FC-A2F79AA6B719" title="When you configure XStream Out in a CDB, you must decide which database changes will be captured by XStream Out and sent to the client application.">Configuring XStream Out in a CDB</a></li>
                        <li><a href="multitenant-architecture.html#GUID-BBAD3448-8A5A-4397-BD3A-F05D945DB7F8" title="The multitenant architecture enables an Oracle database to function as a multitenant container database (CDB).">Multitenant Architecture</a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-xstream-with-a-cdb.html#GUID-37EA80B6-8131-46C9-8CB8-CA597ACE5563" title="You can use Oracle Database XStream in a multitenant container database (CDB).">Using XStream with a CDB</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="props_rev_3"><a id="GUID-1DBE4654-FA5C-4968-90FC-A2F79AA6B719" name="GUID-1DBE4654-FA5C-4968-90FC-A2F79AA6B719"></a><h3 id="MULTI-GUID-1DBE4654-FA5C-4968-90FC-A2F79AA6B719" class="sect3"><span class="enumeration_section">25.4 </span>Configuring XStream Out in a CDB
               </h3>
               <div>
                  <p>When you configure XStream Out in a CDB, you must decide which database changes will be captured by XStream Out and sent to the client application. </p>
                  <p>XStream Out can stream all database changes for all containers, including the CDB root and all PDBs, application roots, and application PDBs, or XStream Out can stream the changes from specific containers. In addition, you can configure XStream Out with local capture, or you can configure it with downstream capture to offload the work required to capture changes from the source database.</p>
                  <p>The following restrictions apply when you configure XStream Out in a CDB:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>The capture process and outbound server must be in the CDB root.</p>
                     </li>
                     <li>
                        <p>The capture process and outbound server must be in the same CDB.</p>
                     </li>
                     <li>
                        <p>Each container in the CDB must be open during XStream Out configuration.</p>
                     </li>
                     <li>
                        <p>When changes made to an application root are captured, you must ensure that <code class="codeph">ALTER PLUGGABLE DATABASE APPLICATION</code> statements are replicated only to other application roots.
                        </p>
                     </li>
                  </ul>
                  <p>In addition, ensure that you create the XStream administrator properly for a CDB.</p>
                  <div class="infoboxnote" id="GUID-1DBE4654-FA5C-4968-90FC-A2F79AA6B719__GUID-1A3069BE-D8C1-4258-BB59-4036CB35DC09">
                     <p class="notep1">Note:</p>
                     <p>When a container is created using a non-CDB, any XStream Out components from the non-CDB cannot be used in the container. You must drop and re-create the XStream Out components, including the capture process and outbound servers, in the CDB root.</p>
                  </div>
                  <p>This section contains the following topics:</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="using-xstream-with-a-cdb.html#GUID-EE2BC80F-8EBE-49F7-8C6A-5A5D19A93669">Configuring XStream Out with Local Capture in a CDB</a><br>An example illustrates configuring XStream Out with local capture in a CDB.
                     </li>
                     <li class="ulchildlink"><a href="using-xstream-with-a-cdb.html#GUID-0E4AD3F3-AE28-40E3-A95E-D8E4B935B99A">Configuring XStream Out with Downstream Capture in CDBs</a><br>Using downstream capture, the XStream Out components can reside in databases other than the source database.
                     </li>
                  </ul>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="using-xstream-with-a-cdb.html#GUID-6F932401-47F6-4A5A-BA72-EBFF2342C579" title="A multitenant environment enables a database to contain a portable set of schemas, objects, and related structures that appears logically to an application as a separate database.">XStream Out and a Multitenant Environment</a></li>
                        <li><a href="using-xstream-with-a-cdb.html#GUID-60589C03-2095-42AA-8F2F-AFD83B110F31" title="In a CDB, XStream Out must be configured in the CDB root. Therefore, the PL/SQL procedures in the DBMS_XSTREAM_ADM package that create system-created rules must be run in the CDB root while connected as a common user.">System-Created Rules in a CDB and XStream Out</a></li>
                        <li><a href="../xstrm/configuring-xstream-out.html#XSTRM-GUID-C0E1C4AC-994A-4F62-B580-63742C9B7128" target="_blank"><span><cite>Oracle Database XStream Guide</cite></span></a></li>
                        <li><a href="overview-of-pdb-creation.html#GUID-F68E6FE9-919B-4665-95F7-785E69E07264" title="You have multiple options for moving a non-CDB into a PDB.">Options for Creating a PDB from a Non-CDB</a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-xstream-with-a-cdb.html#GUID-37EA80B6-8131-46C9-8CB8-CA597ACE5563" title="You can use Oracle Database XStream in a multitenant container database (CDB).">Using XStream with a CDB</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="props_rev_3"><a id="GUID-EE2BC80F-8EBE-49F7-8C6A-5A5D19A93669" name="GUID-EE2BC80F-8EBE-49F7-8C6A-5A5D19A93669"></a><h4 id="MULTI-GUID-EE2BC80F-8EBE-49F7-8C6A-5A5D19A93669" class="sect4"><span class="enumeration_section">25.4.1 </span>Configuring XStream Out with Local Capture in a CDB
                  </h4>
                  <div>
                     <p>An example illustrates configuring XStream Out with local capture in a CDB.</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-EE2BC80F-8EBE-49F7-8C6A-5A5D19A93669__GUID-00AD2429-E547-452E-98A6-CA92348CBA65">Prerequisites</p>
                        <p>Before configuring XStream Out, ensure that all containers in the CDB are in open read/write mode during XStream Out configuration.</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-EE2BC80F-8EBE-49F7-8C6A-5A5D19A93669__GUID-84DC71F1-4410-424A-972F-3060FC80405F">Assumptions</p>
                        <p>This section makes the following assumptions:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>The capture process will be a local capture process, and it will run on the same database as the outbound server.</p>
                           </li>
                           <li>
                              <p>The name of the outbound server is <code class="codeph">xout</code>.
                              </p>
                           </li>
                           <li>
                              <p>Data manipulation language (DML) and data definition language (DDL) changes made to the <code class="codeph">oe.orders</code> and <code class="codeph">oe.order_items</code> tables in PDB <code class="codeph">pdb1.example.com</code> are sent to the outbound server.
                              </p>
                           </li>
                           <li>
                              <p>DML and DDL changes made to the <code class="codeph">hr</code> schema in the PDB <code class="codeph">pdb1.example.com</code> are sent to the outbound server.
                              </p>
                           </li>
                        </ul>
                        <p><a href="using-xstream-with-a-cdb.html#GUID-EE2BC80F-8EBE-49F7-8C6A-5A5D19A93669__BHCJJGJI">Figure 25-3</a> provides an overview of this XStream Out configuration.
                        </p>
                        <div class="figure" id="GUID-EE2BC80F-8EBE-49F7-8C6A-5A5D19A93669__BHCJJGJI">
                           <p class="titleinfigure">Figure 25-3 Sample XStream Out Configuration Created Using CREATE_OUTBOUND for a PDB</p><img src="img/xstrm084.png" width="586" alt="Description of Figure 25-3 follows" title="Description of Figure 25-3 follows" longdesc="img_text/xstrm084.html"><br><a href="img_text/xstrm084.html">Description of "Figure 25-3 Sample XStream Out Configuration Created Using CREATE_OUTBOUND for a PDB"</a></div>
                        <!-- class="figure" -->
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-EE2BC80F-8EBE-49F7-8C6A-5A5D19A93669__GUID-D9311E5F-77CA-4913-BDB2-0B213ABEEFA4">To create an outbound server using the <code class="codeph">CREATE_OUTBOUND</code> procedure:
                        </p>
                        <ol>
                           <li>
                              <p>In SQL*Plus, connect to the root in the CDB (not to the PDB <code class="codeph">pdb1.example.com</code>) as the XStream administrator.
                              </p>
                           </li>
                           <li>
                              <p>Create the outbound server and other XStream components.</p>
                              <ol type="a">
                                 <li>
                                    <p>Ensure that all containers in the source CDB are in open read/write mode.</p>
                                 </li>
                                 <li id="GUID-EE2BC80F-8EBE-49F7-8C6A-5A5D19A93669__BHCHIDBF">
                                    <p>Run the <code class="codeph">CREATE_OUTBOUND</code> procedure.
                                    </p>
                                    <p>Given the assumptions for this example, run the following <code class="codeph">CREATE_OUTBOUND</code> procedure:
                                    </p><pre class="pre codeblock"><code>DECLARE
  tables  DBMS_UTILITY.UNCL_ARRAY;
  schemas DBMS_UTILITY.UNCL_ARRAY;
BEGIN
    tables(1)  := 'oe.orders';
    tables(2)  := 'oe.order_items';
    schemas(1) := 'hr';
  DBMS_XSTREAM_ADM.CREATE_OUTBOUND(
    server_name     =&gt;  'xout',
    source_database =&gt;  'pdb1.example.com',
    table_names     =&gt;  tables,
    schema_names    =&gt;  schemas);
END;
/
</code></pre><div class="infoboxnote" id="GUID-EE2BC80F-8EBE-49F7-8C6A-5A5D19A93669__GUID-3F2AE034-37D6-42BA-B960-D4DA290E1B30">
                                       <p class="notep1">Note:</p>
                                       <p>To capture changes in all containers in a CDB, including the CDB root, all PDBs, all application roots, and all application PDBs, and send those changes to the XStream client application, you can omit the <code class="codeph">source_database</code> parameter when you run the <code class="codeph">CREATE_OUTBOUND</code> procedure.
                                       </p>
                                    </div>
                                 </li>
                                 <li>
                                    <p>After the <code class="codeph">CREATE_OUTBOUND</code> procedure completes successfully, optionally change the open mode of one or more containers if necessary.
                                    </p>
                                 </li>
                              </ol>
                              <p>Running the procedure in Step <a href="using-xstream-with-a-cdb.html#GUID-EE2BC80F-8EBE-49F7-8C6A-5A5D19A93669__BHCHIDBF">b</a> performs the following actions:
                              </p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>Configures supplemental logging for the <code class="codeph">oe.orders</code> and <code class="codeph">oe.order_items</code> tables and for all tables in the <code class="codeph">hr</code> schema in the <code class="codeph">pdb1.example.com</code> PDB.
                                    </p>
                                 </li>
                                 <li>
                                    <p>Creates a queue with a system-generated name that is used by the capture process and the outbound server.</p>
                                 </li>
                                 <li>
                                    <p>Creates and starts a capture process with a system-generated name with rule sets that instruct it to capture DML and DDL changes to the <code class="codeph">oe.orders</code> table, the <code class="codeph">oe.order_items</code> table, and the <code class="codeph">hr</code> schema from the <code class="codeph">pdb1.example.com</code> PDB.
                                    </p>
                                 </li>
                                 <li>
                                    <p>Creates and starts an outbound server named <code class="codeph">xout</code> with rule sets that instruct it to send DML and DDL changes to the <code class="codeph">oe.orders</code> table, the <code class="codeph">oe.order_items</code> table, and the <code class="codeph">hr</code> schema to the client application.
                                    </p>
                                 </li>
                                 <li>
                                    <p>Sets the current user as the connect user for the outbound server. In this example, the current user is the XStream administrator. The client application must connect to the database as the connect user to interact with the outbound server.</p>
                                 </li>
                              </ul>
                              <div class="infoboxnote" id="GUID-EE2BC80F-8EBE-49F7-8C6A-5A5D19A93669__GUID-675A65B7-B11D-41A0-859F-2DC85081FCB2">
                                 <p class="notep1">Note:</p>
                                 <p>The <code class="codeph">server_name</code> value cannot exceed 30 bytes.
                                 </p>
                              </div>
                              <div class="infobox-tip" id="GUID-EE2BC80F-8EBE-49F7-8C6A-5A5D19A93669__GUID-28CF918F-2949-43B6-AFD1-2B117B7D40F9">
                                 <p class="notep1">Tip:</p>
                                 <p>To capture and send all database changes from the <code class="codeph">pdb1.example.com</code> database to the outbound server, specify <code class="codeph">NULL</code> (the default) for the <code class="codeph">table_names</code> and <code class="codeph">schema_names</code> parameters.
                                 </p>
                              </div>
                           </li>
                           <li>
                              <p>Create and run the client application that will connect to the outbound server in the root of the CDB and receive the LCRs.</p>
                              <p>When you run the client application, the outbound server is started automatically.</p>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="../xstrm/configuring-xstream-out.html#XSTRM-GUID-C3391C7F-D2C5-4A65-AA29-4B0EBC2B205E" target="_blank"><span><cite>Oracle Database XStream Guide</cite></span></a></li>
                           <li><a href="../xstrm/sample-xstream-client-application.html#XSTRM-GUID-B914FF75-92AA-4270-BF71-E9A5AA9228F8" target="_blank"><span><cite>Oracle Database XStream Guide</cite></span></a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-xstream-with-a-cdb.html#GUID-1DBE4654-FA5C-4968-90FC-A2F79AA6B719" title="When you configure XStream Out in a CDB, you must decide which database changes will be captured by XStream Out and sent to the client application.">Configuring XStream Out in a CDB</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="props_rev_3"><a id="GUID-0E4AD3F3-AE28-40E3-A95E-D8E4B935B99A" name="GUID-0E4AD3F3-AE28-40E3-A95E-D8E4B935B99A"></a><h4 id="MULTI-GUID-0E4AD3F3-AE28-40E3-A95E-D8E4B935B99A" class="sect4"><span class="enumeration_section">25.4.2 </span>Configuring XStream Out with Downstream Capture in CDBs
                  </h4>
                  <div>
                     <p>Using downstream capture, the XStream Out components can reside in databases other than the source database.</p>
                     <div class="section">When you have multiple CDBs, the source database can be in one CDB, and you can use downstream capture to capture the changes in another CDB.</div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-0E4AD3F3-AE28-40E3-A95E-D8E4B935B99A__GUID-F64F89D7-DA05-467B-8EC7-E37228C54AA4">Prerequisites</p>
                        <p>Before configuring XStream Out, the following prerequisites must be met:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Ensure that all containers in the CDB are in open read/write mode during XStream Out configuration.</p>
                           </li>
                           <li>
                              <p>This example uses downstream capture. Therefore, you must configure log file transfer from the source database to a downstream database.</p>
                           </li>
                           <li>
                              <p>If you want to use real-time downstream capture, then you must also add the required standby redo logs.</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-0E4AD3F3-AE28-40E3-A95E-D8E4B935B99A__GUID-D96EFF46-F06B-46A0-A290-92D845C7820D">Assumptions</p>
                        <p>This section makes the following assumptions:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>The name of the outbound server is <code class="codeph">xout</code>.
                              </p>
                           </li>
                           <li>
                              <p>The queue used by the outbound server is <code class="codeph">c##xstrmadmin.xstream_queue</code>.
                              </p>
                           </li>
                           <li>
                              <p>The source database is the PDB <code class="codeph">pdb1.example.com</code> in the CDB <code class="codeph">data.example.com</code>.
                              </p>
                           </li>
                           <li>
                              <p>The capture process runs in the CDB <code class="codeph">capture.example.com</code>.
                              </p>
                           </li>
                           <li>
                              <p>The outbound server runs in the CDB <code class="codeph">capture.example.com</code>.
                              </p>
                           </li>
                           <li>
                              <p>DML and DDL changes made to the <code class="codeph">oe.orders</code> and <code class="codeph">oe.order_items</code> tables from the PDB <code class="codeph">pdb1.example.com</code> are sent to the outbound server.
                              </p>
                           </li>
                           <li>
                              <p>DML and DDL changes made to the <code class="codeph">hr</code> schema from the PDB <code class="codeph">pdb1.example.com</code> are sent to the outbound server.
                              </p>
                           </li>
                        </ul>
                        <p>The following figure gives an overview of this XStream Out configuration.</p>
                        <div class="figure" id="GUID-0E4AD3F3-AE28-40E3-A95E-D8E4B935B99A__BHCDEHBB">
                           <p class="titleinfigure">Figure 25-4 Sample XStream Out Configuration Using Multiple CDBs and Downstream Capture </p><img src="img/xstrm085.png" width="594" alt="Description of Figure 25-4 follows" title="Description of Figure 25-4 follows" longdesc="img_text/xstrm085.html"><br><a href="img_text/xstrm085.html">Description of "Figure 25-4 Sample XStream Out Configuration Using Multiple CDBs and Downstream Capture "</a></div>
                        <!-- class="figure" -->
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-0E4AD3F3-AE28-40E3-A95E-D8E4B935B99A__GUID-4731220D-3633-4364-A189-721FD3517454">To configure XStream Out with downstream capture in CDBs:</p>
                        <ol>
                           <li>
                              <p>In SQL*Plus, connect to the root of the downstream capture CDB as the XStream administrator.</p>
                              <p>In this example. the downstream capture CDB is <code class="codeph">capture.example.com</code>.
                              </p>
                           </li>
                           <li>
                              <p>Create the queue that will be used by the capture process.</p>
                              <p>For example, run the following procedure:</p><pre class="pre codeblock"><code>BEGIN
  DBMS_XSTREAM_ADM.SET_UP_QUEUE(
    queue_table =&gt; 'c##xstrmadmin.xstream_queue_table',
    queue_name  =&gt; 'c##xstrmadmin.xstream_queue');
END;
/
</code></pre></li>
                           <li id="GUID-0E4AD3F3-AE28-40E3-A95E-D8E4B935B99A__BHCCCAIA">
                              <p>Optionally, create the database link from the root in the downstream capture CDB to the root in the source CDB.</p>
                              <p>In this example, create a database link from the root in <code class="codeph">capture.example.com</code> to the root in <code class="codeph">data.example.com</code>. For example, if the user <code class="codeph">c##xstrmadmin</code> is the XStream administrator on both databases, then create the following database link:
                              </p><pre class="pre codeblock"><code>CREATE DATABASE LINK data.example.com CONNECT TO c##xstrmadmin 
   IDENTIFIED BY <span class="italic">password</span> USING 'data.example.com';
</code></pre></li>
                           <li>
                              <p>Ensure that all containers in the source CDB are in open read/write mode.</p>
                           </li>
                           <li>
                              <p>If you did not create the database link in Step <a href="using-xstream-with-a-cdb.html#GUID-0E4AD3F3-AE28-40E3-A95E-D8E4B935B99A__BHCCCAIA">3</a>, then you must complete additional steps in the root of the source CDB.
                              </p>
                              <p>These steps are not required if you created the database link in Step <a href="using-xstream-with-a-cdb.html#GUID-0E4AD3F3-AE28-40E3-A95E-D8E4B935B99A__BHCCCAIA">3</a>.
                              </p>
                              <p>Run the <code class="codeph">BUILD</code> procedure and ensure that required supplemental logging is specified for the database objects in the source CDB:
                              </p>
                              <ol type="a">
                                 <li>
                                    <p>Connect to the root in the source CDB as the XStream administrator.</p>
                                 </li>
                                 <li>
                                    <p>Run the <code class="codeph">DBMS_CAPTURE_ADM.BUILD</code> procedure. For example:
                                    </p><pre class="pre codeblock"><code>SET SERVEROUTPUT ON
DECLARE
  scn  NUMBER;
BEGIN
  DBMS_CAPTURE_ADM.BUILD(
    first_scn =&gt; scn);
  DBMS_OUTPUT.PUT_LINE('First SCN Value = ' || scn);
END;
/
First SCN Value = 409391
</code></pre><p>This procedure displays the valid first SCN value for the capture process that will be created in the root in the <code class="codeph">capture.example.com</code> CDB. Make a note of the SCN value returned because you will use it when you create the capture process in Step&nbsp;<a href="using-xstream-with-a-cdb.html#GUID-0E4AD3F3-AE28-40E3-A95E-D8E4B935B99A__BHCHAEJF">6</a>.
                                    </p>
                                 </li>
                                 <li>
                                    <p>Ensure that required supplemental logging is specified for the database objects in the source CDB.</p>
                                    <p>For this example, ensure that supplemental logging is configured for the <code class="codeph">hr</code> schema, the <code class="codeph">oe.orders</code> table, and the <code class="codeph">oe.order_items</code> table in the <code class="codeph">pdb1.example.com</code> PDB.
                                    </p>
                                 </li>
                              </ol>
                           </li>
                           <li id="GUID-0E4AD3F3-AE28-40E3-A95E-D8E4B935B99A__BHCHAEJF">
                              <p>While connected to the root in the downstream capture CDB, create the capture process.</p>
                              <p>For example, run the following procedure to create the capture process while connected as the XStream administrator to <code class="codeph">capture.example.com</code>:
                              </p><pre class="pre codeblock"><code>BEGIN
  DBMS_CAPTURE_ADM.CREATE_CAPTURE(
    queue_name         =&gt; 'c##xstrmadmin.xstream_queue',
    capture_name       =&gt; 'real_time_capture',
    rule_set_name      =&gt; NULL,
    start_scn          =&gt; NULL,
    source_database    =&gt; NULL,
    use_database_link  =&gt; TRUE,
    first_scn          =&gt; NULL,
    logfile_assignment =&gt; 'implicit',
    source_root_name   =&gt; 'data.example.com',
    capture_class      =&gt; 'xstream');
END;
/
</code></pre><p>If you did not create a database link in Step <a href="using-xstream-with-a-cdb.html#GUID-0E4AD3F3-AE28-40E3-A95E-D8E4B935B99A__BHCCCAIA">3</a>, then specify the SCN value returned by the <code class="codeph">DBMS_CAPTURE_ADM.BUILD</code> procedure for the <code class="codeph">first_scn</code> parameter.
                              </p>
                              <p>Do not start the capture process.</p>
                           </li>
                           <li>
                              <p>After the capture process is created, optionally change the open mode of one or more PDBs if necessary.</p>
                           </li>
                           <li>
                              <p>Run the <code class="codeph">ADD_OUTBOUND</code> procedure.
                              </p>
                              <p>Given the assumption for this section, run the following <code class="codeph">ADD_OUTBOUND</code> procedure:
                              </p><pre class="pre codeblock"><code>DECLARE
  tables  DBMS_UTILITY.UNCL_ARRAY;
  schemas DBMS_UTILITY.UNCL_ARRAY;
BEGIN
    tables(1)  := 'oe.orders';
    tables(2)  := 'oe.order_items';
    schemas(1) := 'hr';
  DBMS_XSTREAM_ADM.ADD_OUTBOUND(
    server_name           =&gt;  'xout',
    queue_name            =&gt;  'c##xstrmadmin.xstream_queue',
    source_database       =&gt;  'pdb1.example.com',
    table_names           =&gt;  tables,
    schema_names          =&gt;  schemas,
    source_root_name      =&gt; 'data.example.com',
    source_container_name =&gt; 'pdb1');
END;
/
</code></pre><p>Running this procedure performs the following actions:</p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>Creates an outbound server named <code class="codeph">xout</code>. The outbound server has rule sets that instruct it to send DML and DDL changes to the <code class="codeph">oe.orders</code> table, the <code class="codeph">oe.order_items</code> table, and the <code class="codeph">hr</code> schema to the client application. The rules specify that these changes must have originated at the PDB <code class="codeph">pdb1.example.com</code> in the CDB <code class="codeph">data.example.com</code>. The outbound server dequeues LCRs from the queue <code class="codeph">c##xstrmadmin.xstream_queue</code>.
                                    </p>
                                 </li>
                                 <li>
                                    <p>Sets the current user as the <code class="codeph">connect_user</code> for the outbound server. In this example, the <code class="codeph">current_user</code> is the XStream administrator. The client application must connect to the database as the <code class="codeph">connect_user</code> to interact with the outbound server.
                                    </p>
                                 </li>
                              </ul>
                              <div class="infoboxnote" id="GUID-0E4AD3F3-AE28-40E3-A95E-D8E4B935B99A__GUID-692609D0-11F7-4EE7-9F4C-55DB5E31F93D">
                                 <p class="notep1">Note:</p>
                                 <p>The <code class="codeph">server_name</code> value cannot exceed 30 bytes.
                                 </p>
                              </div>
                           </li>
                           <li>
                              <p>Create and run the client application that will connect to the outbound server and receive the LCRs.</p>
                              <p>When you run the client application, the outbound server is started automatically at the downstream capture CDB.</p>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="../xstrm/configuring-xstream-out.html#XSTRM-GUID-C3391C7F-D2C5-4A65-AA29-4B0EBC2B205E" target="_blank"><span><cite>Oracle Database XStream Guide</cite></span></a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-xstream-with-a-cdb.html#GUID-1DBE4654-FA5C-4968-90FC-A2F79AA6B719" title="When you configure XStream Out in a CDB, you must decide which database changes will be captured by XStream Out and sent to the client application.">Configuring XStream Out in a CDB</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
            <div class="props_rev_3"><a id="GUID-4E7FDA7C-002C-41D3-8E7C-2918913C2B13" name="GUID-4E7FDA7C-002C-41D3-8E7C-2918913C2B13"></a><h3 id="MULTI-GUID-4E7FDA7C-002C-41D3-8E7C-2918913C2B13" class="sect3"><span class="enumeration_section">25.5 </span>XStream In and a Multitenant Environment
               </h3>
               <div>
                  <p>A multitenant environment enables an Oracle database to contain a portable set of schemas, objects, and related structures that appears logically to an application as a separate database.</p>
                  <p>This self-contained collection is called a pluggable database (PDB). A multitenant container database (CDB) contains PDBs. It can also contain application containers. An application container is an optional component of a CDB that consists of an application root and all application PDBs associated with it. An application container stores data for one or more applications. An application container shares application metadata and common data. In a CDB, each of the following is a container: the CDB root, each PDB, each application root, and each application PDB.</p>
                  <p>In a CDB, the inbound server is restricted to receiving LCRs from one source database and only executing changes in the current container (one PDB, one application root, one application PDB, or the CDB root). A single inbound server cannot apply changes to more than one container in a CDB.</p>
                  <p>When the inbound server is in the CDB root, the apply user must be a common user. When the inbound server is in an application root, the apply user must be a common user or an application common user. When the inbound server is in a PDB or application PDB, the apply user can be a common user or a local user.</p>
                  <div class="infoboxnote" id="GUID-4E7FDA7C-002C-41D3-8E7C-2918913C2B13__GUID-72FF3C44-9583-4898-B869-1B6183E5CEEC">
                     <p class="notep1">Note:</p>
                     <p>XStream does not synchronize changes done in the application root container. Do not use the XStream In replication to replicate operations done in the application root container. You can manually apply these changes in the application root containers in the target. Note that the operations done in the PDBs can still be replicated.</p>
                  </div>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="using-xstream-with-a-cdb.html#GUID-CBD258F9-D53D-4DA8-98CE-D87232D06655" title="A multitenant environment enables an Oracle database to contain a portable set of schemas, objects, and related structures that appears logically to an application as a separate database. This self-contained collection is called a pluggable database (PDB). A CDB contains PDBs.">System-Created Rules and a Multitenant Environment</a></li>
                        <li><a href="multitenant-architecture.html#GUID-BBAD3448-8A5A-4397-BD3A-F05D945DB7F8" title="The multitenant architecture enables an Oracle database to function as a multitenant container database (CDB).">Multitenant Architecture</a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-xstream-with-a-cdb.html#GUID-37EA80B6-8131-46C9-8CB8-CA597ACE5563" title="You can use Oracle Database XStream in a multitenant container database (CDB).">Using XStream with a CDB</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
         </div>
      </article>
   </body>
</html>