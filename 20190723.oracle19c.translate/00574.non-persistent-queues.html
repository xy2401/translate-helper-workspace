<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>非持久性队列</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Advanced Queuing User&#39;s Guide "></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Advanced Queuing User&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="oracle-database-advanced-queuing.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-02-12T10:53:09-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96511-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="omg-monitoring.html" title="Previous" type="text/html"></link>
      <link rel="next" href="error-messages.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Oracle® Database Advanced Queuing"></meta>
    <meta name="dcterms.isVersionOf" content="ADQUE"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="omg-monitoring.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="error-messages.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">高级排队用户指南</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">非持久性队列</li>
            </ol>
            <a id="GUID-53FA8763-D0CA-4EE4-A3B2-606CE01AE702" name="GUID-53FA8763-D0CA-4EE4-A3B2-606CE01AE702"></a><a id="ADQUE2400"></a>
            
            <h2 id="ADQUE-GUID-53FA8763-D0CA-4EE4-A3B2-606CE01AE702" class="sect2"><span class="enumeration_chapter">非</span>持久性队列</h2>
         </header>
         <div class="ind">
            <div>
               <p>Oracle数据库高级队列可以向订阅者异步传递非持久性消息。这些消息可以是事件驱动的，并且不会超出系统（或实例）的故障。消息存储在系统创建的队列表中。Oracle数据库高级队列支持使用通用<a href="glossary.html#GUID-2003BA71-5534-477C-990D-5ABE432A5907"><span class="xrefglossterm">API的</span></a>持久和非持久消息。</p>
               <p>非持久队列（可以是单用户或多用户）提供向所有当前连接的用户通知的机制。订户可以添加到多个非多余的非持久队列，非持久队列可以是传播的目的地。</p>
               <p>您可以使用enqueue接口以通常的方式将消息排入非持久队列。您可以将RAW和Oracle对象类型消息排入非持久队列。OCI通知用于将此类消息传递给当前已注册通知的用户。</p>
               <p>以下主题描述了非持久队列，这些队列在Oracle数据库高级队列<span class="italic">10g</span>第2版（10.2）中已弃用。Oracle建议您使用缓冲消息传递。
               </p>
               <div class="infoboxnotealso" id="GUID-53FA8763-D0CA-4EE4-A3B2-606CE01AE702__GUID-0F128853-E73E-4AAF-93EA-46FDDDE5E3BD">
                  <p class="notep1">也可以看看：</p>
                  <p><span class="q">“ <a href="aq-introduction.html#GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27" title="缓冲消息传递结合了该产品始终提供的丰富功能和更快的排队实现。缓冲消息传递非常适合不需要Oracle数据库高级队列持久消息传递的可靠性和事务支持的应用程序。">缓冲消息</a> ”</span></p>
               </div>
               <p>话题：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="non-persistent-queues.html#GUID-3F4FF540-00E0-43DB-8CAC-4876287BEDFE">创建非持久队列</a></p>
                  </li>
                  <li>
                     <p><a href="non-persistent-queues.html#GUID-7469E4B4-6136-4E29-9236-8A2CF214F8E5">管理非持久队列</a></p>
                  </li>
                  <li>
                     <p><a href="non-persistent-queues.html#GUID-9766CBCD-2C8C-4EC6-85B8-3FB84288249A">非持久队列的兼容性</a></p>
                  </li>
                  <li>
                     <p><a href="non-persistent-queues.html#GUID-C6587805-8ABE-40B3-BDE5-5234E7D1F391">非持久队列通知</a></p>
                  </li>
                  <li>
                     <p><a href="non-persistent-queues.html#GUID-6E3C13C7-C638-4F8D-A5DC-455A027774B4">非持久队列的限制</a></p>
                  </li>
               </ul>
            </div><a id="ADQUE3520"></a><div class="props_rev_3"><a id="GUID-3F4FF540-00E0-43DB-8CAC-4876287BEDFE" name="GUID-3F4FF540-00E0-43DB-8CAC-4876287BEDFE"></a><h3 id="ADQUE-GUID-3F4FF540-00E0-43DB-8CAC-4876287BEDFE" class="sect3"><span class="enumeration_section">A.1</span>创建非持久队列</h3>
               <div>
                  <div class="section"><pre class="oac_no_warn" dir="ltr">DBMS_AQADM.CREATE_NP_QUEUE（queue_name IN VARCHAR2，multiple_consumers IN BOOLEAN DEFAULT FALSE，comment IN VARCHAR2 DEFAULT NULL）;</pre><p>此过程创建一个<a href="glossary.html#GUID-A91ACE79-576B-49F6-BE03-D4A792B9B468"><span class="xrefglossterm">非持久</span></a>队列。
                     </p>
                     <p>非持久队列仅支持本地收件人。队列可以是单用户或多用户。所有队列名称在架构中必须是唯一的。队列在8.1兼容的系统创建的队列表（ <code class="codeph">AQ$_MEM_SC</code>或<code class="codeph">AQ$_MEM_MC</code> ）中创建， <code class="codeph">AQ$_MEM_SC</code> <code class="codeph">AQ$_MEM_MC</code>与队列名称指定的模式相同。如果队列名称未指定模式名称，则会在登录用户的模式中创建队列。
                     </p>
                     <div class="infoboxnote" id="GUID-3F4FF540-00E0-43DB-8CAC-4876287BEDFE__GUID-8723A182-C429-4F0E-8D50-2C2C82A2C97F">
                        <p class="notep1">注意：</p>
                        <p>非持久队列的名称不得超过24个字符。如果您尝试创建名称较长的非持久队列，则会出现错误ORA-24019。</p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="ADQUE3521"></a><div class="props_rev_3"><a id="GUID-7469E4B4-6136-4E29-9236-8A2CF214F8E5" name="GUID-7469E4B4-6136-4E29-9236-8A2CF214F8E5"></a><h3 id="ADQUE-GUID-7469E4B4-6136-4E29-9236-8A2CF214F8E5" class="sect3"><span class="enumeration_section">A.2</span>管理非持久队列</h3>
               <div>
                  <p>使用<code class="codeph">CREATE_NP_QUEUE</code>创建队列后，可以通过调用<code class="codeph">START_QUEUE</code>来启用它。默认情况下，创建队列时禁用enqueue和dequeue。
                  </p>
                  <p>您可以将RAW和Oracle对象类型消息排入非持久队列。您不能从非持久队列中出队。从非持久队列中检索消息的唯一方法是使用<a href="glossary.html#GUID-4C11A79C-E65E-4B48-8A30-E628E322B025"><span class="xrefglossterm">Oracle调用接口</span></a> （OCI）通知机制。您无法在非持久队列上调用<code class="codeph">listen</code>调用。
                  </p>
                  <p>非持久队列只能由其所有者删除。</p>
               </div>
            </div><a id="ADQUE3522"></a><div class="props_rev_3"><a id="GUID-9766CBCD-2C8C-4EC6-85B8-3FB84288249A" name="GUID-9766CBCD-2C8C-4EC6-85B8-3FB84288249A"></a><h3 id="ADQUE-GUID-9766CBCD-2C8C-4EC6-85B8-3FB84288249A" class="sect3"><span class="enumeration_section">A.3</span>非持久队列的兼容性</h3>
               <div>
                  <p>8.1式或更高队列，该<code class="codeph">compatible</code>的参数<code class="codeph">init.ora</code>和<code class="codeph">compatible</code>的的参数<a href="glossary.html#GUID-45894F1F-4871-4A00-9171-2743821BAD3A"><span class="xrefglossterm">队列表</span></a>应该被设置为8.1或更高，以使用非持久队列。
                  </p>
               </div>
            </div><a id="ADQUE3524"></a><a id="ADQUE3525"></a><a id="ADQUE3523"></a><div class="props_rev_3"><a id="GUID-C6587805-8ABE-40B3-BDE5-5234E7D1F391" name="GUID-C6587805-8ABE-40B3-BDE5-5234E7D1F391"></a><h3 id="ADQUE-GUID-C6587805-8ABE-40B3-BDE5-5234E7D1F391" class="sect3"><span class="enumeration_section">A.4</span>非持久队列通知</h3>
               <div>
                  <div class="section">
                     <p>对于非持久队列，消息作为通知的一部分传递。<a href="non-persistent-queues.html#GUID-C6587805-8ABE-40B3-BDE5-5234E7D1F391__g1009489" title="行是队列有效负载类型。对于每种有效负载类型，第一列是其名称。第二，第三和第四列分别描述了在OCI，电子邮件和PL / SQL中采取的操作。">表A-1</a>显示了在指定RAW表示时针对不同通知机制对<a href="glossary.html#GUID-A91ACE79-576B-49F6-BE03-D4A792B9B468"><span class="xrefglossterm">非持久</span></a>队列执行的操作。<a href="non-persistent-queues.html#GUID-C6587805-8ABE-40B3-BDE5-5234E7D1F391__g1009470" title="行是队列有效负载类型。对于每种有效负载类型，第一列是其名称。第二，第三和第四列分别描述了在OCI，电子邮件和PL / SQL中采取的操作。">表A-2</a>显示了指定XML表示时执行的操作。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="tblformalwide" id="GUID-C6587805-8ABE-40B3-BDE5-5234E7D1F391__g1009489">
                     <p class="titleintable">表A-1指定RAW演示文稿时对非持久队列执行的操作</p>
                     <table cellpadding="4" cellspacing="0" class="FormalWide" title="指定RAW演示文稿时对非持久队列执行的操作" width="100%" border="1" summary="Rows are queue payload types. For each payload type, the first column is its name. The second, third, and fourth columns describe the actions taken in OCI, E-mail, and PL/SQL respectively." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="21%" id="d125560e417">队列有效负载类型</th>
                              <th align="left" valign="bottom" width="22%" id="d125560e420">OCI回调</th>
                              <th align="left" valign="bottom" width="30%" id="d125560e423">电子邮件</th>
                              <th align="left" valign="bottom" width="28%" id="d125560e426">PL / SQL回调</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="21%" id="d125560e431" headers="d125560e417 ">
                                 <p>生的</p>
                              </td>
                              <td align="left" valign="top" width="22%" headers="d125560e431 d125560e420 ">
                                 <p>OCI回调接收有效负载中的RAW数据。</p>
                              </td>
                              <td align="left" valign="top" width="30%" headers="d125560e431 d125560e423 ">
                                 <p>不支持</p>
                              </td>
                              <td align="left" valign="top" width="28%" headers="d125560e431 d125560e426 ">
                                 <p>PL / SQL回调接收有效负载中的RAW数据。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="21%" id="d125560e444" headers="d125560e417 ">
                                 <p>Oracle对象类型</p>
                              </td>
                              <td align="left" valign="top" width="22%" headers="d125560e444 d125560e420 ">
                                 <p>不支持</p>
                              </td>
                              <td align="left" valign="top" width="30%" headers="d125560e444 d125560e423 ">
                                 <p>不支持</p>
                              </td>
                              <td align="left" valign="top" width="28%" headers="d125560e444 d125560e426 ">
                                 <p>不支持</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="tblformalwide" id="GUID-C6587805-8ABE-40B3-BDE5-5234E7D1F391__g1009470">
                     <p class="titleintable">表A-2指定XML表示时对非持久队列执行的操作</p>
                     <table cellpadding="4" cellspacing="0" class="FormalWide" title="指定XML表示时对非持久队列执行的操作" width="100%" border="1" summary="Rows are queue payload types. For each payload type, the first column is its name. The second, third, and fourth columns describe the actions taken in OCI, E-mail, and PL/SQL respectively." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="21%" id="d125560e468">队列有效负载类型</th>
                              <th align="left" valign="bottom" width="22%" id="d125560e471">OCI回调</th>
                              <th align="left" valign="bottom" width="30%" id="d125560e474">电子邮件</th>
                              <th align="left" valign="bottom" width="27%" id="d125560e477">PL / SQL回调</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="21%" id="d125560e482" headers="d125560e468 ">
                                 <p>生的</p>
                              </td>
                              <td align="left" valign="top" width="22%" headers="d125560e482 d125560e471 ">
                                 <p>OCI回调接收有效负载中的XML数据。</p>
                              </td>
                              <td align="left" valign="top" width="30%" headers="d125560e482 d125560e474 ">
                                 <p>XML数据被格式化为SOAP消息并通过电子邮件发送到已注册的电子邮件地址。</p>
                              </td>
                              <td align="left" valign="top" width="27%" headers="d125560e482 d125560e477 ">
                                 <p>PL / SQL回调接收有效负载中的XML数据。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="21%" id="d125560e495" headers="d125560e468 ">
                                 <p>Oracle对象类型</p>
                              </td>
                              <td align="left" valign="top" width="22%" headers="d125560e495 d125560e471 ">
                                 <p>OCI回调接收有效负载中的XML数据。</p>
                              </td>
                              <td align="left" valign="top" width="30%" headers="d125560e495 d125560e474 ">
                                 <p>XML数据被格式化为SOAP消息并通过电子邮件发送到已注册的电子邮件地址。</p>
                              </td>
                              <td align="left" valign="top" width="27%" headers="d125560e495 d125560e477 ">
                                 <p>PL / SQL回调接收有效负载中的XML数据。</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
               </div>
            </div><a id="ADQUE3526"></a><div class="props_rev_3"><a id="GUID-6E3C13C7-C638-4F8D-A5DC-455A027774B4" name="GUID-6E3C13C7-C638-4F8D-A5DC-455A027774B4"></a><h3 id="ADQUE-GUID-6E3C13C7-C638-4F8D-A5DC-455A027774B4" class="sect3"><span class="enumeration_section">A.5</span>非持久队列的限制</h3>
               <div>
                  <p>您可以创建<code class="codeph">RAW</code>和Oracle对象类型的非持久队列。您仅限于向订阅者和明确指定的本地收件人发送邮件。非持久队列不支持传播。检索消息时，不能使用出列调用，而必须使用异步通知机制，通过<code class="codeph">OCISubscriptionRegister</code>注册通知。
                  </p>
                  <p>对于非持久消息， <code class="codeph">enqueue_options</code>的<code class="codeph">visibility</code>属性必须设置为<code class="codeph">IMMEDIATE</code> 。
                  </p>
                  <div class="infoboxnotealso" id="GUID-6E3C13C7-C638-4F8D-A5DC-455A027774B4__GUID-62AAEE42-8F5E-4739-BF71-89315E4FF78A">
                     <p class="notep1">也可以看看：</p>
                     <p><span class="q">“入队<a href="aq-operations-using-pl-sql.html#GUID-1CEA86B9-4FDF-445F-93C1-67E21C033D35__CHDGBIHI">选项</a> ”</span></p>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>