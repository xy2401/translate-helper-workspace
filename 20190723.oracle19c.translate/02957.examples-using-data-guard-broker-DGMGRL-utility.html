<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="Use these scenarios to help you understand what you need to do to start creating, managing, and using an Oracle Data Guard broker configuration."></meta>
      <meta name="description" content="Use these scenarios to help you understand what you need to do to start creating, managing, and using an Oracle Data Guard broker configuration."></meta>
      <title>使用DGMGRL命令行界面的方案</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Broker "></meta>
      <meta property="og:description" content="Use these scenarios to help you understand what you need to do to start creating, managing, and using an Oracle Data Guard broker configuration."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Broker"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="data-guard-broker.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-03-29T04:14:25-07:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="1999, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96245-02"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="using-data-guard-broker-to-manage-switchovers-failovers.html" title="Previous" type="text/html"></link>
      <link rel="next" href="oracle-data-guard-broker-commands.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Data Guard Broker"></meta>
    <meta name="dcterms.isVersionOf" content="DGBKR"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="using-data-guard-broker-to-manage-switchovers-failovers.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="oracle-data-guard-broker-commands.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">经纪人</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">使用DGMGRL命令行界面的方案</li>
            </ol>
            <a id="GUID-D9018A5C-8C7A-4F6C-A7D3-B14E5AF7D4BC" name="GUID-D9018A5C-8C7A-4F6C-A7D3-B14E5AF7D4BC"></a><a id="DGBKR495"></a>
            
            <h2 id="DGBKR-GUID-D9018A5C-8C7A-4F6C-A7D3-B14E5AF7D4BC" class="sect2"><span class="enumeration_chapter">6</span>场景使用DGMGRL命令行界面</h2>
         </header>
         <div class="ind">
            <div>
               <p>使用这些方案可帮助您了解开始创建，管理和使用Oracle Data Guard代理配置所需执行的操作。</p>
               <p>阅读有关使用Oracle Data Guard命令行界面（DGMGRL）入门的先决条件的信息，以便您可以准备实例。然后阅读方案以了解如何使用DGMGRL创建，管理和监控代理配置。</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="examples-using-data-guard-broker-DGMGRL-utility.html#GUID-C9349251-C406-4C10-AFA7-34CA4FB1299B" title="使用DGMGRL的先决条件之一是必须已存在主数据库和任何备用数据库。">入门的先决条件</a></p>
                  </li>
                  <li>
                     <p><a href="examples-using-data-guard-broker-DGMGRL-utility.html#GUID-EBCA7643-F1D9-4EA0-BC5F-45AEEDEBC5BC" title="这些示例创建名为DRSolution的代理配置，其中包括名为North_Sales和South_Sales的主数据库和备用数据库。">场景1：创建配置</a></p>
                  </li>
                  <li>
                     <p><a href="examples-using-data-guard-broker-DGMGRL-utility.html#GUID-94628DB0-9C89-4D05-AB6D-A41555B9C7C4" title="使用DGMGRL创建配置后，您可以随时设置数据库属性。">方案2：设置数据库属性</a></p>
                  </li>
                  <li>
                     <p><a href="examples-using-data-guard-broker-DGMGRL-utility.html#GUID-99E9459D-5F21-4153-8D82-14BDD20A00BB" title="到目前为止，DRSolution配置已禁用，这意味着它不受Data Guard代理的控制。">方案3：启用配置和数据库</a></p>
                  </li>
                  <li>
                     <p><a href="examples-using-data-guard-broker-DGMGRL-utility.html#GUID-82319941-58E8-4672-8609-7CC496D3DC29" title="您可以随时更改配置的保护模式。">场景4：设置配置保护模式</a></p>
                  </li>
                  <li>
                     <p><a href="examples-using-data-guard-broker-DGMGRL-utility.html#GUID-FD18A0B8-350F-44E5-867E-0AD17E65D226" title="如果主数据库和备用数据库在地理上相距足够远以使同步传输模式的使用不切实际，则远程同步实例可以与最大可用性保护模式一起使用。">方案5：使用远程同步实例设置最高可用性模式</a></p>
                  </li>
                  <li>
                     <p><a href="examples-using-data-guard-broker-DGMGRL-utility.html#GUID-AAE5EA1A-53A2-4D8D-BF59-A2856B38C99D" title="您可以在连接到代理配置中的任何数据库时，从任何站点（包括观察站点）启用快速启动故障转移。">方案6：启用快速启动故障转移并启动观察器</a></p>
                  </li>
                  <li>
                     <p><a href="examples-using-data-guard-broker-DGMGRL-utility.html#GUID-09A3230B-A2A2-449D-89E0-EDDBD76A157C" title="当快速启动故障转移目标是从远程同步实例接收重做数据的逻辑或物理备用数据库时，可以在最大可用性模式下启用快速启动故障转移。">方案7：使用远程同步实例时启用快速启动故障转移</a></p>
                  </li>
                  <li>
                     <p><a href="examples-using-data-guard-broker-DGMGRL-utility.html#GUID-EF93CD0C-B038-4442-9D7F-F0B2B48F8927" title="在某些情况下，您可能希望更改代理配置中数据库的状态或属性，以对一个或多个数据库执行例行维护。">场景8：执行例行管理任务</a></p>
                  </li>
                  <li>
                     <p><a href="examples-using-data-guard-broker-DGMGRL-utility.html#GUID-1403D1C3-8944-42D0-8BDA-21D695C7958A" title="您可以使用SWITCHOVER命令切换主数据库和备用数据库的角色。">场景9：执行切换操作</a></p>
                  </li>
                  <li>
                     <p><a href="examples-using-data-guard-broker-DGMGRL-utility.html#GUID-630F5987-328C-410C-AE3B-A9D66EB233D4" title="您可以调用故障转移操作以响应紧急情况，通常是在无法访问主数据库或不可用时。">方案10：执行手动故障转移操作</a></p>
                  </li>
                  <li>
                     <p><a href="examples-using-data-guard-broker-DGMGRL-utility.html#GUID-D46A9644-136B-4149-8C74-BF4E845B3DE3" title="如果以前的主数据库配置了闪回数据库，则可以轻松地将发生故障的主数据库恢复为新主数据库的备用数据库。">方案11：恢复失败的主数据库</a></p>
                  </li>
                  <li>
                     <p><a href="examples-using-data-guard-broker-DGMGRL-utility.html#GUID-05313396-B80D-4F53-BB44-AC7B0FF5E8B4" title="如果您要将物理备用数据库转换为快照备用数据库，请使用DGMGRL CONVERT DATABASE命令。">方案12：将物理备用转换为快照备用</a></p>
                  </li>
                  <li>
                     <p><a href="examples-using-data-guard-broker-DGMGRL-utility.html#GUID-13FDC86F-A736-44F0-A2DD-33B7FF3067A7" title="这些步骤演示了使用SHOW命令和可监视属性来识别和解决故障情况所需的任务。">方案13：监视Data Guard配置</a></p>
                  </li>
                  <li>
                     <p><a href="examples-using-data-guard-broker-DGMGRL-utility.html#GUID-424D1C65-66EA-4286-B59C-A48D80B4587E" title="这些步骤说明如何将零数据丢失恢复设备（恢复设备）添加到代理配置。">方案14：将恢复设备添加到代理配置</a></p>
                  </li>
                  <li>
                     <p><a href="examples-using-data-guard-broker-DGMGRL-utility.html#GUID-1E270915-1E66-45BD-9EC5-5BFF6F66075D" title="您可以将代理配置元数据导出到文本文件中。需要重新创建代理配置时，可以将导出的元数据导入当前代理配置。">场景15：导出和导入代理配置文件</a></p>
                  </li>
                  <li>
                     <p><a href="examples-using-data-guard-broker-DGMGRL-utility.html#GUID-F4CD7D5A-8B96-456E-BF69-9A975BA2D504" title="通过仅观察模式，您可以测试在配置中使用快速启动故障转移的影响，而无需对配置进行任何实际更改。您可以使用DGMGRL命令或数据字典视图来验证仅观察模式设置。">方案16：使用仅观察模式进行快速启动故障转移</a></p>
                  </li>
               </ul>
            </div><a id="DGBKR500"></a><div class="props_rev_3"><a id="GUID-C9349251-C406-4C10-AFA7-34CA4FB1299B" name="GUID-C9349251-C406-4C10-AFA7-34CA4FB1299B"></a><h3 id="DGBKR-GUID-C9349251-C406-4C10-AFA7-34CA4FB1299B" class="sect3"><span class="enumeration_section">6.1</span>入门的先决条件</h3>
               <div>
                  <p>使用DGMGRL的先决条件之一是必须已存在主数据库和任何备用数据库。</p>
                  <div class="section">
                     <p>对于配置中的所有数据库，必须将<code class="codeph">DG_BROKER_START</code>初始化参数设置为<code class="codeph">TRUE</code> 。您必须在代理中使用服务器参数文件。
                     </p>
                     <p>如有必要，将主数据库和备用数据库上的初始化参数文件（PFILE）转换为服务器参数文件（SPFILE）。使用以下SQL * Plus命令：</p><pre class="oac_no_warn" dir="ltr">CREATE SPFILE ='spfilename'FROM PFILE ='pfilename';</pre><p>如果未使用服务器参数文件启动实例，则必须关闭实例并使用服务器参数文件重新启动它。</p>
                     <p>启动Oracle实例后，使用SQL <code class="codeph">ALTER SYSTEM</code>语句设置<code class="codeph">DG_BROKER_START=TRUE</code>初始化参数。参数值将保存在服务器参数文件中。下次启动Oracle实例时，代理会自动启动，您无需再次发出SQL <code class="codeph">ALTER SYSTEM</code>语句。
                     </p>
                     <p>在以下场景中进行了以下假设：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type:disc">
                        <li>
                           <p>TCP / IP用于连接主数据库和备用数据库。</p>
                        </li>
                        <li>
                           <p>备用数据库是根据主数据库控制文件和数据文件的备份创建的，如<a href="../sbydb/creating-oracle-data-guard-physical-standby.html#SBYDB00210" target="_blank"><span class="italic">Oracle Data Guard概念和管理中所述</span></a> 。
                           </p>
                        </li>
                        <li>
                           <p>这些方案假定以下代理配置：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>配置名称为<code class="codeph">DRSolution</code> 。
                                 </p>
                              </li>
                              <li>
                                 <p>主数据库的数据库唯一名称（ <code class="codeph">DB_UNIQUE_NAME</code> ）是<code class="codeph">North_Sales</code> 。
                                 </p>
                              </li>
                              <li>
                                 <p>远程备用数据库的数据库唯一名称（ <code class="codeph">DB_UNIQUE_NAME</code> ）是<code class="codeph">South_Sales</code> 。
                                 </p>
                              </li>
                              <li>
                                 <p>保护模式是最高性能模式。</p>
                              </li>
                              <li>
                                 <p>为主数据库和备用数据库配置了备用重做日志文件。两个数据库的传输模式都是<code class="codeph">ASYNC</code> 。</p>
                              </li>
                              <li>
                                 <p>备用数据库是物理备用数据库。</p>
                              </li>
                           </ul>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="DGBKR505"></a><div class="props_rev_3"><a id="GUID-EBCA7643-F1D9-4EA0-BC5F-45AEEDEBC5BC" name="GUID-EBCA7643-F1D9-4EA0-BC5F-45AEEDEBC5BC"></a><h3 id="DGBKR-GUID-EBCA7643-F1D9-4EA0-BC5F-45AEEDEBC5BC" class="sect3"><span class="enumeration_section">6.2</span>场景1：创建配置</h3>
               <div>
                  <p>这些示例创建名为<code class="codeph">DRSolution</code>的代理配置，其中包括名为<code class="codeph">North_Sales</code>和<code class="codeph">South_Sales</code>的主数据库和备用数据库。
                  </p>
                  <div class="section">
                     <p></p>
                     <p>要创建配置并添加一个物理备用数据库，请执行以下任务：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="examples-using-data-guard-broker-DGMGRL-utility.html#GUID-E0E3FE01-BC23-419F-B9B5-4E7035D9455F" title="要启动DGMGRL，请在安装了Oracle Data Guard的系统上的命令行提示符下输入dgmgrl。">创建配置任务1：调用DGMGRL</a></p>
                        </li>
                        <li>
                           <p><a href="examples-using-data-guard-broker-DGMGRL-utility.html#GUID-BA60C699-B35F-454A-A65F-97A521DDE176" title="在指定任何命令（HELP，EXIT或QUIT除外）之前，必须先使用DGMGRL CONNECT命令连接到主数据库。">创建配置任务2：连接到主数据库</a></p>
                        </li>
                        <li>
                           <p><a href="examples-using-data-guard-broker-DGMGRL-utility.html#GUID-50D518A0-7832-4DE9-96CC-551CD84F7AC5" title="在将备用数据库和远程同步添加到配置之前，必须清除备用数据库和远程同步实例上的所有远程重做传输目标。">创建配置任务3：清除现有的远程重做传输目标</a></p>
                        </li>
                        <li>
                           <p><a href="examples-using-data-guard-broker-DGMGRL-utility.html#GUID-BAEF04D8-CD69-4637-BF0F-F3108BF5FFB1" title="最初仅使用主数据库创建代理配置。">创建配置任务4：创建代理配置</a></p>
                        </li>
                        <li>
                           <p><a href="examples-using-data-guard-broker-DGMGRL-utility.html#GUID-D399C53D-793E-44EE-80FC-D1F4D0A1D974" title="使用SHOW CONFIGURATION命令显示配置的简短摘要。">创建配置任务5：显示配置信息</a></p>
                        </li>
                        <li>
                           <p><a href="examples-using-data-guard-broker-DGMGRL-utility.html#GUID-F2361026-9F8B-4A8B-BC40-0ECA570236E9" title="要将备用数据库添加到DRSolution配置，请使用ADD DATABASE命令。">创建配置任务6：将备用数据库添加到配置中</a></p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div>
               <div class="props_rev_3"><a id="GUID-E0E3FE01-BC23-419F-B9B5-4E7035D9455F" name="GUID-E0E3FE01-BC23-419F-B9B5-4E7035D9455F"></a><h4 id="DGBKR-GUID-E0E3FE01-BC23-419F-B9B5-4E7035D9455F" class="sect4"><span class="enumeration_section">6.2.1</span>创建配置任务1：调用DGMGRL</h4>
                  <div>
                     <p>要启动DGMGRL，请在安装了Oracle Data Guard的系统上的命令行提示符下输入<code class="codeph">dgmgrl</code> 。
                     </p>
                     <div class="section"><pre class="oac_no_warn" dir="ltr">$ dgmgrl</pre><p>显示DGMGRL提示：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt;</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="DGBKR3600"></a><a id="DGBKR3599"></a><div class="props_rev_3"><a id="GUID-BA60C699-B35F-454A-A65F-97A521DDE176" name="GUID-BA60C699-B35F-454A-A65F-97A521DDE176"></a><h4 id="DGBKR-GUID-BA60C699-B35F-454A-A65F-97A521DDE176" class="sect4"><span class="enumeration_section">6.2.2</span>创建配置任务2：连接到主数据库</h4>
                  <div>
                     <p>在指定任何命令（ <code class="codeph">HELP,</code> <code class="codeph">EXIT,</code>或<code class="codeph">QUIT</code>除外）之前，必须先使用DGMGRL <code class="codeph">CONNECT</code>命令连接到主数据库。
                     </p>
                     <div class="section">
                        <p>连接到数据库的帐户（本例中为<code class="codeph">SYS</code> ）必须在主数据库和备用数据库上具有<code class="codeph">SYSDG</code>或<code class="codeph">SYSDBA</code>权限。
                        </p>
                        <div class="infoboxnote" id="GUID-BA60C699-B35F-454A-A65F-97A521DDE176__GUID-656437C1-8712-469E-A114-459C680C67F9">
                           <p class="notep1">注意：</p>
                           <p>如果<code class="codeph">CONNECT</code>命令未指定<code class="codeph">AS</code>子句，则连接为<code class="codeph">SYSDBA</code> 。</p>
                        </div>
                        <p>以下示例显示了<code class="codeph">CONNECT</code>命令的两种变体。<a href="examples-using-data-guard-broker-DGMGRL-utility.html#GUID-BA60C699-B35F-454A-A65F-97A521DDE176__I1005721">例6-1</a>显示了如何连接到本地系统上的默认数据库， <a href="examples-using-data-guard-broker-DGMGRL-utility.html#GUID-BA60C699-B35F-454A-A65F-97A521DDE176__I1005725">例6-2</a>包含Oracle Net Services连接标识符（ <code class="codeph">North_Sales.example.com</code> ），以建立与远程系统上的数据库的连接。在这两个示例中，系统都会提示您输入密码。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-BA60C699-B35F-454A-A65F-97A521DDE176__I1005721">
                        <p class="titleinexample">示例6-1连接到本地系统上的主数据库</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; CONNECT sysdg;密码： <span class="italic">密码</span>连接到“North_Sales”连接为SYSDG。</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-BA60C699-B35F-454A-A65F-97A521DDE176__I1005725">
                        <p class="titleinexample">示例6-2连接到远程系统上的主数据库</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; CONNECT sysdg@North_Sales.example.com;密码： <span class="italic">密码</span>连接到“North_Sales”连接为SYSDG。</pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-50D518A0-7832-4DE9-96CC-551CD84F7AC5" name="GUID-50D518A0-7832-4DE9-96CC-551CD84F7AC5"></a><h4 id="DGBKR-GUID-50D518A0-7832-4DE9-96CC-551CD84F7AC5" class="sect4"><span class="enumeration_section">6.2.3</span>创建配置任务3：清除要添加的备用数据库和远程同步实例上的现有远程重做传输目标。
                  </h4>
                  <div>
                     <p>在将备用数据库和远程同步添加到配置之前，必须清除备用数据库和远程同步实例上的所有远程重做传输目标。</p>
                     <div class="section">
                        <p>如果未清除远程重做传输目标，则在尝试创建配置时将返回以下错误消息：</p><pre class="oac_no_warn" dir="ltr">ORA-16698：为要添加的对象设置的LOG_ARCHIVE_DEST_n参数失败。
</pre><p>要清除<code class="codeph">LOG_ARCHIVE_DEST_</code> <span class="italic"><code class="codeph">n</code></span>设置，请使用<code class="codeph">ALTER SYSTEM SET LOG_ARCHIVE_DEST_ <span class="variable" translate="no">n</span> =" "</code> SQL * Plus命令。
                        </p>
                        <p>主数据库上的远程重做传输目标（无论它们是否具有<code class="codeph">REGISTER</code>或<code class="codeph">NOREGISTER</code>属性）可以保留原样。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-BAEF04D8-CD69-4637-BF0F-F3108BF5FFB1" name="GUID-BAEF04D8-CD69-4637-BF0F-F3108BF5FFB1"></a><h4 id="DGBKR-GUID-BAEF04D8-CD69-4637-BF0F-F3108BF5FFB1" class="sect4"><span class="enumeration_section">6.2.4</span>创建配置任务4：创建代理配置</h4>
                  <div>
                     <p>最初仅使用主数据库创建代理配置。</p>
                     <div class="section">
                        <p>在这种情况下，主要称为<code class="codeph">North_Sales</code> 。在以后的命令中，您将添加备用数据库<code class="codeph">South_Sales</code> 。
                        </p>
                        <div class="infoboxnote" id="GUID-BAEF04D8-CD69-4637-BF0F-F3108BF5FFB1__GUID-64A71AE4-D3F4-4AF9-A189-AB777016B286">
                           <p class="notep1">注意：</p>
                           <p>主数据库和备用数据库的名称必须与其数据库唯一名称匹配。从<code class="codeph">DB_UNIQUE_NAME</code>初始化参数中获取这些内容，如下所示：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; SHOW PARAMETER DB_UNIQUE_NAME;</pre></div>
                        <p>使用<code class="codeph">CREATE CONFIGURATION</code>命令创建<code class="codeph">DRSolution</code>配置并定义主数据库<code class="codeph">North_Sales</code> ：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt;创建配置'DRSolution'AS&gt;主要数据库是'North_Sales'&gt; CONNECT IDENTIFIER是North_Sales.example.com;</pre><p>DGMGRL返回以下信息：</p><pre class="oac_no_warn" dir="ltr">使用主数据库“North_Sales”创建的“DRSolution”配置</pre><p>名称<code class="codeph">North_Sales</code>是此数据库的<code class="codeph">DB_UNIQUE_NAME</code>初始化参数的值。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-D399C53D-793E-44EE-80FC-D1F4D0A1D974" name="GUID-D399C53D-793E-44EE-80FC-D1F4D0A1D974"></a><h4 id="DGBKR-GUID-D399C53D-793E-44EE-80FC-D1F4D0A1D974" class="sect4"><span class="enumeration_section">6.2.5</span>创建配置任务5：显示配置信息</h4>
                  <div>
                     <p>使用<code class="codeph">SHOW CONFIGURATION</code>命令显示<code class="codeph">SHOW CONFIGURATION</code>的简短摘要。
                     </p>
                     <div class="section"><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; SHOW CONFIGURATION;</pre><p>DGMGRL返回以下信息：</p><pre class="oac_no_warn" dir="ltr">配置 -  DRSolution保护模式：MaxPerformance成员：North_Sales  - 主数据库快速启动故障转移：DISABLED配置状态：DISABLED</pre></div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-F2361026-9F8B-4A8B-BC40-0ECA570236E9" name="GUID-F2361026-9F8B-4A8B-BC40-0ECA570236E9"></a><h4 id="DGBKR-GUID-F2361026-9F8B-4A8B-BC40-0ECA570236E9" class="sect4"><span class="enumeration_section">6.2.6</span>创建配置任务6：将备用数据库添加到配置中</h4>
                  <div>
                     <p>要将备用数据库添加到<code class="codeph">DRSolution</code>配置，请使用<code class="codeph">ADD DATABASE</code>命令。
                     </p>
                     <div class="section">
                        <p>以下命令将<code class="codeph">South_Sales</code>定义为备用数据库，该备用数据库是与名为<code class="codeph">North_Sales</code>的主数据库关联的备用数据库：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; ADD DATABASE'South_Sales'AS&gt; CONNECT IDENTIFIER是South_Sales.example.com;</pre><p>DGMGRL返回以下信息：</p><pre class="oac_no_warn" dir="ltr">添加了数据库“South_Sales”</pre><p>名称<code class="codeph">South_Sales</code>是数据库的<code class="codeph">DB_UNIQUE_NAME</code>初始化参数的值。
                        </p>
                        <p>使用<code class="codeph">SHOW CONFIGURATION</code>命令验证<code class="codeph">South_Sales</code>数据库是否已添加到<code class="codeph">DRSolution</code>配置：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; SHOW CONFIGURATION;</pre><p>DGMGRL返回以下信息：</p><pre class="oac_no_warn" dir="ltr">配置 -  DRSolution保护模式：MaxPerformance成员：North_Sales  - 主数据库South_Sales  - 物理备用数据库快速启动故障转移：禁用配置状态：DISABLED DGMGRL&gt;</pre></div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="DGBKR510"></a><div class="props_rev_3"><a id="GUID-94628DB0-9C89-4D05-AB6D-A41555B9C7C4" name="GUID-94628DB0-9C89-4D05-AB6D-A41555B9C7C4"></a><h3 id="DGBKR-GUID-94628DB0-9C89-4D05-AB6D-A41555B9C7C4" class="sect3"><span class="enumeration_section">6.3</span>场景2：设置数据库属性</h3>
               <div>
                  <p>使用DGMGRL创建配置后，您可以随时设置数据库属性。</p>
                  <div class="section">
                     <p>例如，以下语句为<code class="codeph">South_Sales</code>备用数据库设置<code class="codeph">LogArchiveFormat</code>和<code class="codeph">StandbyArchiveLocation</code>数据库属性：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; EDIT DATABASE'South_Sales'Set PROPERTY'LogArchiveFormat'='log_％t_％s_％r_％d.arc';属性“LogArchiveFormat”已更新。DGMGRL&gt;编辑数据库'South_Sales'设置属性'StandbyArchiveLocation'='/ archfs / arch /';属性“StandbyArchiveLocation”已更新。
</pre><p>使用<code class="codeph">SHOW DATABASE VERBOSE</code>命令查看<code class="codeph">SHOW DATABASE VERBOSE</code>所有属性及其值。以下示例显示<code class="codeph">South_Sales</code>数据库的属性。
                     </p>
                     <p></p><pre class="pre codeblock"><code>DGMGRL&gt;显示数据库VERBOSE'South_Sales'数据库 -  South_Sales角色：PHYSICAL STANDBY预期状态：APPLY-ON传输延迟：0秒（计算0秒前）应用滞后：0秒（计算0秒前）平均应用率：2.00 KByte / ■活动应用率：0字节/秒最大应用率：0字节/秒实时查询：ON实例：South_sales1属性：DGConnectIdentifier ='South_Sales.example.com'ObserverConnectIdentifier =''FastStartFailoverTarget =''PreferredObserverHosts =' 'LogShipping ='ON'RedoRoutes =''LogXptMode ='ASYNC'DelayMins ='0'Binding ='optional'MaxFailure ='0'ReopenSecs ='300'NetTimeout ='30'RedoCompression ='DISABLE'AdferredApplyInstance =''ApplyInstanceTimeout ='0'ApplyLagThreshold ='0'TransportLagThreshold ='0'TransportDisconnectedThreshold ='0'ApplyParallel ='AUTO'ApplyInstances ='0'StandbyFileManagement =''ArchiveLagTarget ='0'LogArchiveMaxProcesses ='0'LogArchiveMinSucceedDest ='0'DataGuardSyncLatency = '0'LogAr chiveTrace ='0'LogArchiveFormat =''DbFileNameConvert ='dbs / cdb1_，dbs / cdb2_，dbs / t，dbs / bt，dbs / cdb4_，dbs / cdb2_，dbs / dt，dbs / bt'LogFileNameConvert ='dbs / cdb1_ ，dbs / cdb2_，dbs / t，dbs / bt，dbs / cdb4_，dbs / cdb2_，dbs / dt，dbs / bt'DrileLocation =''AlternateLocation =''StandbyArchiveLocation =''StandbyAlternateLocation =''InconsistentProperties ='（监视器）'InconsistentLogXptProps ='（monitor）'LogXptStatus ='（monitor）'SendQEntries ='（monitor）'RecvQEntries ='（monitor）'HostName ='South_Sales.example.com'StaticConnectIdentifier ='（DESCRIPTION =（ADDRESS_LIST =（ADDRESS） =（PROTOCOL = tcp）（HOST = South_Sales.example.com）（PORT = 2879）））（CONNECT_DATA =（SERVICE_NAME = South_Sales_DGMGRL.example.com）（INSTANCE_NAME = south_sales1）（SERVER = DEDICATED）））'TopWaitEvents =' （监视器）'SidName ='（监视器）'日志文件位置：警报日志：/db/oracle/log/diag/rdbms/South_Sales/south_sales1/trace/alert_south_sales1.log Data Guard Broker日志：/ db / oracle / log /诊断/ RDBMS / South_Sales / south_sales1 /跟踪/ d rcsouth_sales1.log数据库状态：成功</code></pre><p>如果启用了数据库的代理管理，则设置数据库属性值会导致在相应的数据库中更改基础参数值，并且更改的参数的值将反映在服务器参数文件中。因此，如果数据库在Oracle Enterprise Manager云控制（云控制）和DGMGRL（例如来自SQL * Plus接口）之外关闭并重新启动，则数据库在启动时使用更新的服务器参数文件中的新参数值。但是，不应通过SQL语句更改重做传输服务初始化参数。这样做会导致数据库和代理之间的不一致。</p>
                     <div class="infoboxnote" id="GUID-94628DB0-9C89-4D05-AB6D-A41555B9C7C4__GUID-3EF0D11D-49E1-4F9A-B737-5F65FCA0C115">
                        <p class="notep1">注意：</p>
                        <p>数据库属性通常以混合大小写（例如， <code class="codeph">LogArchiveFormat</code> ）字体显示，以帮助您在视觉上区分数据库属性（来自相应的初始化参数，SQL语句或PL / SQL过程），这些属性通常以<code class="codeph">UPPERCASE</code>字体形式记录。但是，管理属性的命令不区分大小写;您可以以大写，小写或混合大小写发出命令。
                        </p>
                     </div>
                     <p>如果启用或禁用了数据库，则可以更改属性。但是，如果在更改属性时禁用了数据库，则在启用数据库之前，更改不会生效。</p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="DGBKR3601"></a><a id="DGBKR3602"></a><a id="DGBKR3603"></a><a id="DGBKR3604"></a><a id="DGBKR515"></a><div class="props_rev_3"><a id="GUID-99E9459D-5F21-4153-8D82-14BDD20A00BB" name="GUID-99E9459D-5F21-4153-8D82-14BDD20A00BB"></a><h3 id="DGBKR-GUID-99E9459D-5F21-4153-8D82-14BDD20A00BB" class="sect3"><span class="enumeration_section">6.4</span>场景3：启用配置和数据库</h3>
               <div>
                  <p>到目前为止， <code class="codeph">DRSolution</code>配置已禁用，这意味着它不受Data Guard代理的控制。
                  </p>
                  <div class="section">
                     <p>完成将数据库配置为代理配置并设置任何必需的数据库属性后，必须启用配置以允许Data Guard代理管理它。</p>
                     <p>您可以启用：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type:disc">
                        <li>
                           <p>整个配置，包括其所有数据库</p>
                        </li>
                        <li>
                           <p>备用数据库</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-99E9459D-5F21-4153-8D82-14BDD20A00BB__GUID-CA9DDF64-1106-482E-BD9A-0FEA769D7856">启用整个配置</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>您可以使用以下命令启用整个配置，包括所有数据库：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; <a id="d22227e938" class="indexterm-anchor"></a>启用配置;启用。</pre></div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-99E9459D-5F21-4153-8D82-14BDD20A00BB__GUID-E490803B-9A70-490F-837B-6234EB3DFB3A">显示配置</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>使用<code class="codeph">SHOW</code>命令验证是否已成功启用配置及其数据库：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; <a id="d22227e952" class="indexterm-anchor"></a>显示配置;</pre><p>DGMGRL返回以下信息：</p><pre class="oac_no_warn" dir="ltr">配置 -  DRSolution保护模式：MaxPerformance成员：North_Sales  - 主数据库South_Sales  - 物理备用数据库快速启动故障转移：禁用配置状态：成功</pre></div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-99E9459D-5F21-4153-8D82-14BDD20A00BB__GUID-905FAE5C-B9A7-4269-9BAB-0C09C6DC7AB0">启用数据库</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>除非先前使用<code class="codeph">DISABLE DATABASE</code>命令禁用了备用数据库，否则此步骤是不必要的。通常，启用配置也会启用备用数据库。
                     </p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; ENABLE DATABASE'South_Sales';启用。</pre></div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-99E9459D-5F21-4153-8D82-14BDD20A00BB__GUID-45A8340C-DAE1-4EA0-AE25-7E2CEAFABCC0">显示数据库</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section"><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; SHOW DATABASE'South_Sales';数据库 -  South_Sales角色：PHYSICAL STANDBY预期状态：APPLY-ON传输延迟：0秒（计算1秒前）应用滞后：0秒（计算1秒前）应用率：1.54 MByte / s实时查询：OFF实例（s ）：south_sales1数据库状态：成功</pre></div>
                  <!-- class="section" -->
               </div>
            </div><a id="DGBKR520"></a><div class="props_rev_3"><a id="GUID-82319941-58E8-4672-8609-7CC496D3DC29" name="GUID-82319941-58E8-4672-8609-7CC496D3DC29"></a><h3 id="DGBKR-GUID-82319941-58E8-4672-8609-7CC496D3DC29" class="sect3"><span class="enumeration_section">6.5</span>场景4：设置配置保护模式</h3>
               <div>
                  <p>您可以随时更改配置的保护模式。</p>
                  <div class="infoboxnote" id="GUID-82319941-58E8-4672-8609-7CC496D3DC29__GUID-D37F81EE-1838-4E50-B0BD-9961B79CA3B9">
                     <p class="notep1">注意：</p>
                     <p>您无法将保护模式从最高性能模式更改为最大保护模式。您必须先将保护模式更改为最大可用性，然后再更改为最大保护模式。</p>
                     <p>更改保护模式时，无需重新启动主数据库。</p>
                  </div>
                  <p>此方案将配置的保护模式设置为<code class="codeph">MAXAVAILABILITY</code>模式。请注意，此保护模式要求至少有一个备用数据库配置为使用备用重做日志文件，如果它直接从主数据库接收重做，它必须通过<code class="codeph">SYNC</code>或<code class="codeph">FASTSYNC</code>模式接收重做。如果备用数据库通过远程同步实例接收重做，则远程同步实例必须通过<code class="codeph">SYNC</code>或<code class="codeph">FASTYSYNC</code>模式接收重做，并且备用数据库必须通过<code class="codeph">ASYNC</code>模式从远程同步实例接收重做。
                  </p>
                  <ol>
                     <li>
                        <p>如有必要，配置备用重做日志文件。</p>
                        <p>由于您将保护模式设置为<code class="codeph">MAXAVAILABILITY</code>模式，因此务必确保在备用数据库上配置了足够的备用重做日志文件。有关设置重做传输的更多信息，请参阅<a href="../sbydb/oracle-data-guard-redo-transport-services.html#SBYDB-GUID-04851F96-F8F3-4999-AAAD-83C4C3C7AE14" target="_blank"><span><cite>Oracle Data Guard概念和管理</cite></span></a> 。
                        </p>
                     </li>
                     <li>
                        <p>适当配置重做传输模式。</p>
                        <p>如果备用数据库直接从主数据库接收重做，则将备用数据库配置为通过<code class="codeph">SYNC</code>或<code class="codeph">FASTSYNC</code>模式接收重做。如果备用数据库通过远程同步实例接收主要重做，则将远程同步实例配置为通过<code class="codeph">SYNC</code>或<code class="codeph">FASTSYNC</code>模式接收重做，并将备用数据库配置为通过<code class="codeph">ASYNC</code>模式接收重做。例如：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt;编辑数据库'South_Sales'Set PROPERTY'LogXptMode'='SYNC';属性“LogXptMode”已更新</pre><p>除非备用数据库在配置中配置了备用重做日志文件，否则代理将不允许此命令成功。</p>
                     </li>
                     <li>
                        <p>更改配置的整体保护模式。</p>
                        <p>使用<code class="codeph">EDIT</code> <code class="codeph">CONFIGURATION</code>命令将代理配置升级到<code class="codeph">MAXAVAILABILITY</code>保护模式：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt;编辑配置集保护模式为最大可用性;成功了。
</pre><p>如果在输入此命令时禁用了配置，则在使用<code class="codeph">ENABLE CONFIGURATION</code>命令<code class="codeph">ENABLE CONFIGURATION</code>之前，不会应用实际的保护模式更改。如果在配置中未找到可支持保护模式要求的备用数据库，则代理将不允许您启用配置。
                        </p>
                     </li>
                     <li>
                        <p>验证保护模式是否已更改。</p>
                        <p>使用<code class="codeph">SHOW CONFIGURATION</code>命令显示<code class="codeph">SHOW CONFIGURATION</code>的当前保护模式：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; SHOW CONFIGURATION;配置 -  DRSolution <span class="bold">保护模式：</span> <span class="bold">MaxAvailability</span>成员：North_Sales  - 主数据库South_Sales  - 物理备用数据库快速启动故障转移：DISABLED配置状态：成功</pre><div class="infoboxnotealso" id="GUID-82319941-58E8-4672-8609-7CC496D3DC29__GUID-E5A4FA29-229A-4FB6-88C5-BB31B3BC8F67">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="managing-oracle-data-guard-broker-configuration-members.html#GUID-994BE350-859F-41DC-A1D3-B6E8D5EEF2C8" title="您可以使用代理设置具有任何不同数据保护模式的配置。">管理数据保护模式</a></p>
                        </div>
                     </li>
                  </ol>
               </div>
            </div><a id="DGBKR3865"></a><a id="DGBKR3861"></a><div class="props_rev_3"><a id="GUID-FD18A0B8-350F-44E5-867E-0AD17E65D226" name="GUID-FD18A0B8-350F-44E5-867E-0AD17E65D226"></a><h3 id="DGBKR-GUID-FD18A0B8-350F-44E5-867E-0AD17E65D226" class="sect3"><span class="enumeration_section">6.6</span>场景5：使用远程同步实例设置最高可用性模式</h3>
               <div>
                  <p>如果主数据库和备用数据库在地理上相距足够远以使同步传输模式的使用不切实际，则远程同步实例可以与最大可用性保护模式一起使用。</p>
                  <div class="section">
                     <p>此tpoic中的示例显示如何将远程同步实例添加到配置，然后为配置的所有成员设置<code class="codeph">RedoRoutes</code>属性。为远程同步实例设置<code class="codeph">RedoRoutes</code>属性使其能够基于<code class="codeph">North_Sales</code>或<code class="codeph">South_Sales</code>数据库作为主要数据发送重做数据。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>发出以下命令以将名为<code class="codeph">FS</code>的远程同步实例添加到代理配置：</span><div><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; ADD FAR_SYNC'FS'作为连接标识符是FS.EXAMPLE.COM; DGMGRL&gt; ENABLE FAR_SYNC'FS'; DGMGRL&gt; SHOW CONFIGURATION;配置 -  DRSolution保护模式：MaxPerformance成员：North_Sales  - 主数据库South_Sales  - 物理备用数据库FS  - 远程同步快速启动故障转移：禁用配置状态：成功</pre><p>在此输出中， <code class="codeph">South_Sales</code>和<code class="codeph">FS</code>在<code class="codeph">North_Sales</code>下<code class="codeph">North_Sales</code> 。这表明主要数据正在向<code class="codeph">South_Sales</code>和<code class="codeph">FS</code>发送重做数据。</p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>发出以下命令，以便当前主要（ <code class="codeph">North_Sales</code> ）仅将重做数据发送到远程同步实例，并且当<code class="codeph">North_Sales</code>为主要时，远程同步实例将重做数据发送到<code class="codeph">South_Sales</code> ：</span><div><pre class="oac_no_warn" dir="ltr">DGMGRL&gt;编辑数据库'North_Sales'设置属性RedoRoutes ='（LOCAL：FS SYNC）'; DGMGRL&gt;编辑FAR_SYNC'FS'设置属性RedoRoutes ='（North_Sales：South_Sales'）; DGMGRL&gt; SHOW CONFIGURATION; DGMGRL&gt; SHOW CONFIGURATION;配置 -  DRSolution保护模式：MaxPerformance成员：North_Sales  - 主数据库FS  - 远程同步South_Sales  - 物理备用数据库快速启动故障转移：禁用配置状态：成功</pre><p>上面输出中的缩进方案表明<code class="codeph">North_Sales</code>将重做数据发送到<code class="codeph">FS</code> ， <code class="codeph">FS</code>将重做数据发送到<code class="codeph">South_Sales</code> 。
                           </p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>发出以下命令将保护模式升级到最大可用性：</span><div><pre class="oac_no_warn" dir="ltr">DGMGRL&gt;编辑配置设置保护模式为MaxAvailability; DGMGRL&gt; SHOW CONFIGURATION;配置 -  DRSolution保护模式：MaxAvailability成员：North_Sales  - 主数据库FS  - 远程同步South_Sales  - 物理备用数据库快速启动故障转移：禁用配置状态：成功</pre><p>如果<code class="codeph">South_Sales</code>变为主要，而<code class="codeph">North_Sales</code>变为从远程同步实例<code class="codeph">FS</code>接收重做数据的备用数据库，则必须为<code class="codeph">South_Sales</code>设置<code class="codeph">RedoRoutes</code>属性。此外，必须在<code class="codeph">FS</code>的<code class="codeph">RedoRoutes</code>属性中包含新规则，以允许它在<code class="codeph">South_Sales</code>为主数据库时将重做数据发送到<code class="codeph">North_Sales</code> 。
                           </p>
                           <p>如果未创建这些规则，则<code class="codeph">North_Sales</code>将无法接收重做数据。要检查是否已设置正确的规则，请使用<code class="codeph">SHOW</code> <code class="codeph">CONFIGURATION</code> <code class="codeph">WHEN</code> <code class="codeph">PRIMARY</code> <code class="codeph">IS</code>命令查看如果<code class="codeph">South_Sales</code>是主数据库，重做传输配置将是什么。例如：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt;当主要是'South_Sales'时显示配置; South_Sales为主要时的配置 -  DRSolution成员：South_Sales  - 主数据库FS  - 远程同步North_Sales  - 物理备用数据库成员未接收重做：North_FS  - 物理备用数据库警告：ORA-16685：数据库未接收重做数据</pre><p>要更正此错误，请为<code class="codeph">South_Sales</code>和<code class="codeph">FS</code>设置<code class="codeph">RedoRoutes</code>属性，如下所示：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; EDIT DATABASE'South_Sales'Set PROPERTY RedoRoutes ='（LOCAL：FS SYNC）'; DGMGRL&gt;编辑FAR_SYNC'FS'设置属性RedoRoutes =（'North_Sales：South_Sales）（South_Sales：North_Sales）';</pre><p>更改为<code class="codeph">South_Sales</code>和<code class="codeph">FS</code>的<code class="codeph">RedoRoutes</code>属性后，使用<code class="codeph">SHOW</code> <code class="codeph">CONFIGURATION</code> <code class="codeph">WHEN</code> <code class="codeph">PRIMARY</code> <code class="codeph">IS</code>命令确认错误已被清除：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt;当主要是'South_Sales'时显示配置; South_Sales为主要时的配置 -  DRSolution成员：South_Sales  - 主数据库FS  - 远程同步North_Sales  - 物理备用数据库</pre></div>
                     </li>
                  </ol>
               </div>
            </div><a id="DGBKR3430"></a><div class="props_rev_3"><a id="GUID-AAE5EA1A-53A2-4D8D-BF59-A2856B38C99D" name="GUID-AAE5EA1A-53A2-4D8D-BF59-A2856B38C99D"></a><h3 id="DGBKR-GUID-AAE5EA1A-53A2-4D8D-BF59-A2856B38C99D" class="sect3"><span class="enumeration_section">6.7</span>场景6：启用快速启动故障转移并启动观察器</h3>
               <div>
                  <p>您可以在连接到代理配置中的任何数据库时，从任何站点（包括观察站点）启用快速启动故障转移。</p>
                  <div class="section">
                     <p>启用快速启动故障转移不会触发故障转移。相反，它允许监视配置的观察者在条件允许故障转移时启动快速启动故障转移。本节介绍启用快速启动故障转移的步骤，并启动配置保护模式设置为最大可用性模式的观察器。</p>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>确保在主备用数据库和目标备用数据库上配置备用重做日志。在配置备用重做日志之前，必须停止日志应用服务。</span><div>
                           <div class="infoboxnotealso" id="GUID-AAE5EA1A-53A2-4D8D-BF59-A2856B38C99D__GUID-DD9D7D36-23D7-412A-8BBA-A5325F9368B2">
                              <p class="notep1">也可以看看：</p>
                              <p>有关配置备用重做日志文件的说明，请<a href="../sbydb/creating-oracle-data-guard-physical-standby.html#SBYDB00426" target="_blank"><span class="italic">参阅Oracle Data Guard概念和管理</span></a></p>
                           </div>
                        </div>
                     </li>
                     <li class="stepexpand"><span>如果主数据库和备用数据库直接接收重做而不是通过远程同步实例，则将主数据库和备用数据库配置为通过<code class="codeph">SYNC</code>或<code class="codeph">FASTSYNC</code>模式接收重做。如果任一数据库通过远程同步实例接收重做，则将远同步实例配置为通过<code class="codeph">SYNC</code>或<code class="codeph">FASTSYNC</code>模式接收重做，并将数据库配置为通过<code class="codeph">ASYNC</code>模式接收重做。例如：</span><div><pre class="oac_no_warn" dir="ltr">DGMGRL&gt;编辑数据库'North_Sales'设置属性'LogXptMode'='SYNC';属性“LogXptMode”已更新</pre><pre class="oac_no_warn" dir="ltr">DGMGRL&gt;编辑数据库'South_Sales'Set PROPERTY'LogXptMode'='SYNC';属性“LogXptMode”已更新</pre><p>除非为数据库配置了备用重做日志文件，否则代理不允许这些命令成功。</p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>如果您有两个或更多备用数据库，请在主数据库上设置<code class="codeph">FastStartFailoverTarget</code>配置属性以指示所需的目标备用数据库。当实际启用快速启动故障转移时，代理会相互为目标备用数据库设置此属性，以指示主数据库为其未来目标备用数据库。您无需在目标备用数据库上设置此属性，因为这是自动完成的。例如：</span><div><pre class="oac_no_warn" dir="ltr">DGMGRL&gt;编辑数据库'North_Sales'设置属性FastStartFailoverTarget ='South_Sales';属性“FastStartFailoverTarget”已更新</pre></div>
                     </li>
                     <li class="stepexpand"><span>如果需要升级保护模式，请使用以下DGMGRL <code class="codeph">EDIT CONFIGURATION</code>命令。例如：</span><div><pre class="oac_no_warn" dir="ltr">DGMGRL&gt;编辑配置集保护模式为最大可用性;</pre></div>
                     </li>
                     <li class="stepexpand"><span>如果尚未在主数据库和备用数据库上启用它，请通过在每个数据库上发出以下语句来启用闪回数据库：</span><div><pre class="oac_no_warn" dir="ltr">ALTER SYSTEM SET UNDO_RETENTION = 3600 SCOPE = SPFILE; ALTER SYSTEM SET UNDO_MANAGEMENT ='AUTO'SCOPE = SPFILE;立即关闭;启动安装; SHOW PARAMETER UNDO; ALTER SYSTEM SET DB_FLASHBACK_RETENTION_TARGET = 4320 SCOPE = BOTH; ALTER DATABASE ARCHIVELOG; ALTER SYSTEM SET db_recovery_file_dest_size = &lt;size&gt;; ALTER SYSTEM SET db_recovery_file_dest = &lt;directory-specification&gt;; ALTER DATABASE FLASHBACK ON; ALTER DATABASE OPEN;</pre><p>确保将<code class="codeph">UNDO_RETENTION</code>和<code class="codeph">DB_FLASHBACK_RETENTION_TARGET</code>初始化参数设置为足够大的值，以便在长时间中断后仍可以恢复。
                           </p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>通过登录观察计算机并运行DGMGRL，启动三个观察者。 <a id="d22227e1404" class="indexterm-anchor"></a><a id="d22227e1408" class="indexterm-anchor"></a>以具有<code class="codeph">SYSDG</code>或<code class="codeph">SYSDBA</code>权限的用户身份连接到配置，然后发出<code class="codeph">START OBSERVER</code>命令。请注意，该命令不会返回;也就是说，在发出命令后你不会得到DGMGRL提示符。</span><div><pre class="pre codeblock"><code>DGMGRL&gt; CONNECT sysdg@North_Sales.example.com;密码： <span class="italic">密码</span>连接到“North_Sales”连接为SYSDG。 DGMGRL&gt; START OBSERVER observer1在BACKGROUND&gt; FILE IS /net/sales/dat/oracle/broker/fsfo.dat&gt; LOGFILE IS /net/sales/dat/oracle/broker/observer.log&gt; CONNECT IDENTIFIER IS North_Sales已提交命令“START OBSERVER“使用连接标识符”North_Sales“</code></pre><p>出于安全原因，Oracle建议使用此命令格式;没有凭据可见。此做法可防止系统上的其他用户使用实用程序（例如，UNIX ps实用程序）来显示连接凭据。它还可以防止明文密码在用户终端上可见。</p>
                           <p>从脚本启动观察者时，Oracle建议您使用支持“connect /”的方法，以便不必在脚本中嵌入数据库连接凭据。如果选择将客户端Oracle Wallet用作安全外部密码存储（请参阅“ <a href="../dbimi/using-oracle-wallet-manager.html#DBIMI160" target="_blank"><span class="italic">Oracle数据库企业用户安全性管理员指南”</span></a> ），请确保为主要和快速启动故障转移目标备用数据库添加凭据。添加每个数据库的凭据时指定的数据库连接字符串必须与<code class="codeph">ObserverConnectIdentifer</code>或<code class="codeph">DGConnectIdentifier</code>数据库属性匹配。
                           </p>
                           <p>启动多个观察者时，一个观察者是启用快速启动故障转移后的主观察者，其余观察者是备份观察者。只有主观察者才能与Data Guard代理协调快速启动故障转移。如果主数据库和目标备用数据库保持连接但与主观察器的连接丢失，则代理会尝试将备份观察器指定为新的主观察器。</p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>启用快速启动故障转移。您可以在连接到代理配置中的任何数据库系统时启用快速启动故障转移。例如：</span><div><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; ENABLE FAST_START FAILOVER;启用。
</pre></div>
                     </li>
                     <li class="stepexpand"><span>验证快速启动故障转移配置。使用<code class="codeph">SHOW FAST_START FAILOVER</code>命令显示快速启动故障转移设置：</span><div><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; SHOW FAST_START FAILOVER;快速启动故障转移：禁用阈值：30秒目标：South_Sales观察者：observer.example.com滞后限制：30秒（未使用）关闭主要：TRUE自动恢复：TRUE观察者重新连接:(无）观察者覆盖：FALSE可配置故障转移条件健康状况：损坏的控制文件是损坏的字典是无法访问的日志文件没有Stuck Archiver没有数据文件写入错误是Oracle错误条件:(无）</pre><p>以下命令显示启用快速启动故障转移后， <code class="codeph">FastStartFailoverTarget</code>属性将相互设置。为当前主数据库<code class="codeph">North_Sales</code>发出的第一个命令将<code class="codeph">FastStartFailoverTarget</code>属性的值显示为当前目标备用<code class="codeph">South_Sales</code> 。第二个命令，目标待机发出<code class="codeph">South_Sales</code> ，显示当前的主， <code class="codeph">North_Sales</code> ，作为目标待机的未来目标备用它应该永远接管作为主。
                           </p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; SHOW DATABASE'North_Sales'FastStartFailoverTarget; FastStartFailoverTarget = 'South_Sales'; DGMGRL&gt; SHOW DATABASE'South_Sales'FastStartFailoverTarget; FastStartFailoverTarget = 'North_Sales';</pre></div>
                     </li>
                  </ol>
               </div>
            </div><a id="DGBKR3866"></a><div class="props_rev_3"><a id="GUID-09A3230B-A2A2-449D-89E0-EDDBD76A157C" name="GUID-09A3230B-A2A2-449D-89E0-EDDBD76A157C"></a><h3 id="DGBKR-GUID-09A3230B-A2A2-449D-89E0-EDDBD76A157C" class="sect3"><span class="enumeration_section">6.8</span>场景7：使用远程同步实例时启用快速启动故障转移</h3>
               <div>
                  <p>当快速启动故障转移目标是从远程同步实例接收重做数据的逻辑或物理备用数据库时，可以在最大可用性模式下启用快速启动故障转移。</p>
                  <div class="section">
                     <p>要使用远程同步实例将重做数据传送到备用数据库时启用快速启动故障转移，必须首先在主数据库和目标备用数据库上设置<code class="codeph">FastStartFailoverTarget</code>属性，如下所示：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt;编辑数据库'North_Sales'设置属性FastStartFailoverTarget ='South_Sales'; DGMGRL&gt;编辑数据库'South_Sales'Set PROPERTY FastStartFailoverTarget ='North_Sales';</pre><p>然后，可以启用快速启动故障转移，如下所示：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; ENABLE FAST_START FAILOVER;</pre><p>请注意，远程同步实例数据库未指定为<code class="codeph">North_Sales</code>或<code class="codeph">South_Sales</code>的快速启动故障转移目标。
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="DGBKR525"></a><div class="props_rev_3"><a id="GUID-EF93CD0C-B038-4442-9D7F-F0B2B48F8927" name="GUID-EF93CD0C-B038-4442-9D7F-F0B2B48F8927"></a><h3 id="DGBKR-GUID-EF93CD0C-B038-4442-9D7F-F0B2B48F8927" class="sect3"><span class="enumeration_section">6.9</span>场景8：执行例行管理任务</h3>
               <div>
                  <p>在某些情况下，您可能希望更改代理配置中数据库的状态或属性，以对一个或多个数据库执行例行维护。</p>
                  <p>您可能还需要临时禁用配置中数据库的代理管理。</p>
               </div><a id="DGBKR530"></a><div class="props_rev_3"><a id="GUID-8939FDE1-19B9-477E-99F8-5353BDD3AEC2" name="GUID-8939FDE1-19B9-477E-99F8-5353BDD3AEC2"></a><h4 id="DGBKR-GUID-8939FDE1-19B9-477E-99F8-5353BDD3AEC2" class="sect4"><span class="enumeration_section">6.9.1</span>更改属性和状态</h4>
                  <div>
                     <p>在监视配置时，可能需要动态修改数据库或其属性的状态。</p>
                     <p>以下主题说明如何更改配置中数据库的状态或属性。</p>
                  </div><a id="DGBKR535"></a><div class="props_rev_3"><a id="GUID-13678A7F-F1C7-4676-AD1C-7658461B39B0" name="GUID-13678A7F-F1C7-4676-AD1C-7658461B39B0"></a><h5 id="DGBKR-GUID-13678A7F-F1C7-4676-AD1C-7658461B39B0" class="sect5"><span class="enumeration_section">6.9.1.1</span>更改数据库属性</h5>
                     <div>
                        <p>您可以随时修改数据库属性的值 - 无论是启用还是禁用数据库。</p>
                        <div class="section">
                           <p></p>
                           <p>下面的示例示出了如何使用<code class="codeph">EDIT DATABASE</code>命令将改变<code class="codeph">LogXptMode</code>数据库属性的值ASYNC为<code class="codeph">North_Sales</code>数据库。
                           </p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt;编辑数据库'North_Sales'设置属性'LogXptMode'= ASYNC;</pre><p>DGMGRL返回以下消息，指示<code class="codeph">LogXptMode</code>属性已在Data Guard配置文件中成功更新：</p><pre class="oac_no_warn" dir="ltr">属性“LogXptMode”已更新</pre><p>如果当前禁用了配置，则在使用<code class="codeph">ENABLE CONFIGURATION</code>命令启用代理配置之前，数据库不会使用新属性值。
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="DGBKR3867"></a><div class="props_rev_3"><a id="GUID-EF4BE10B-1B4E-43B5-B098-1D9059FE1C7D" name="GUID-EF4BE10B-1B4E-43B5-B098-1D9059FE1C7D"></a><h5 id="DGBKR-GUID-EF4BE10B-1B4E-43B5-B098-1D9059FE1C7D" class="sect5"><span class="enumeration_section">6.9.1.2</span>将属性重置为其默认值</h5>
                     <div>
                        <p>无论是启用还是禁用数据库或配置，您都可以随时将配置或可配置属性重置为其默认值。</p>
                        <div class="section">
                           <p></p>
                           <p>下面的示例演示了如何使用<code class="codeph">EDIT</code> <code class="codeph">DATABASE</code>命令将重置<code class="codeph">LogXptMode</code>数据库配置属性为它的默认值<code class="codeph">North_Sales</code>数据库。
                           </p><pre class="oac_no_warn" dir="ltr">编辑数据库'North_Sales'重置属性LogXptMode;</pre><p>以下示例说明如何使用<code class="codeph">EDIT</code> <code class="codeph">CONFIGURATION</code>命令将<code class="codeph">TraceLevel</code>配置属性重置为其默认值。
                           </p><pre class="oac_no_warn" dir="ltr">EDIT CONFIGURATION RESET PROPERTY TraceLevel;</pre></div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="DGBKR540"></a><div class="props_rev_3"><a id="GUID-269E0143-7540-4D2C-9AE7-0E4F5E6A4D93" name="GUID-269E0143-7540-4D2C-9AE7-0E4F5E6A4D93"></a><h5 id="DGBKR-GUID-269E0143-7540-4D2C-9AE7-0E4F5E6A4D93" class="sect5"><span class="enumeration_section">6.9.1.3</span>更改备用数据库的状态</h5>
                     <div>
                        <p>您可以在物理备用数据库上暂时停止重做应用。</p>
                        <div class="section">
                           <p>要将备用数据库的状态更改为<code class="codeph">APPLY-OFF</code> ，请输入<code class="codeph">EDIT DATABASE</code>命令，如以下示例所示。
                           </p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt;编辑数据库'South_Sales'Set STATE ='APPLY-OFF';成功了。
</pre><p>当物理备用数据库处于<code class="codeph">APPLY-OFF</code>状态时，仍会收到重做数据。
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="DGBKR545"></a><div class="props_rev_3"><a id="GUID-541AB954-CE70-4B06-A9B7-AA31112C2669" name="GUID-541AB954-CE70-4B06-A9B7-AA31112C2669"></a><h5 id="DGBKR-GUID-541AB954-CE70-4B06-A9B7-AA31112C2669" class="sect5"><span class="enumeration_section">6.9.1.4</span>更改主数据库的状态</h5>
                     <div>
                        <p>您可以停止将重做数据传输到备用数据库。</p>
                        <div class="section">
                           <p>要更改主数据库的状态以适应此状态，请使用以下命令：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt;编辑数据库North_Sales SET STATE = TRANSPORT-OFF;成功了。
</pre><p>要将主数据库的状态更改回<code class="codeph">TRANSPORT-ON</code> ，请执行以下操作：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt;编辑数据库North_Sales SET STATE = TRANSPORT-ON;成功了。</pre></div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div><a id="DGBKR550"></a><div class="props_rev_3"><a id="GUID-C9CA2EBC-F9DB-4B76-87AB-CC8E3D4A2879" name="GUID-C9CA2EBC-F9DB-4B76-87AB-CC8E3D4A2879"></a><h4 id="DGBKR-GUID-C9CA2EBC-F9DB-4B76-87AB-CC8E3D4A2879" class="sect4"><span class="enumeration_section">6.9.2</span>禁用配置和数据库</h4>
                  <div>
                     <p>当您禁用代理配置或其任何数据库时，您将禁用代理对它们的管理，并且实际上无法使用DGMGRL来管理和监视它们。</p>
                     <p>但是，禁用代理管理代理配置不会影响基础Oracle Data Guard配置或数据库的实际操作。例如，Oracle Data Guard配置中的重做传输服务和日志应用服务继续保持不变，但您无法再管理它们。</p>
                  </div><a id="DGBKR555"></a><div class="props_rev_3"><a id="GUID-F5AE66C9-A0C6-4C9C-BEEB-B037FE900F39" name="GUID-F5AE66C9-A0C6-4C9C-BEEB-B037FE900F39"></a><h5 id="DGBKR-GUID-F5AE66C9-A0C6-4C9C-BEEB-B037FE900F39" class="sect5"><span class="enumeration_section">6.9.2.1</span>禁用配置</h5>
                     <div>
                        <p>必须使用<code class="codeph">DISABLE CONFIGURATION</code>命令禁用对包括主数据库在内的整个代理配置的管理。
                        </p>
                        <p>例如：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt;禁用配置;</pre><p>禁用主数据库的代理管理的唯一方法是使用<code class="codeph">DISABLE CONFIGURATION</code>命令; <code class="codeph">DISABLE DATABASE</code>命令仅禁用备用数据库的管理。同样， <code class="codeph">DISABLE</code> <code class="codeph">FAR_SYNC</code>命令仅禁用远程同步实例的管理。
                        </p>
                        <div class="infoboxnote" id="GUID-F5AE66C9-A0C6-4C9C-BEEB-B037FE900F39__GUID-33739F06-9B13-4E45-81BD-926113EB1A2A">
                           <p class="notep1">注意：</p>
                           <p>如果在连接到备用数据库或远程同步实例时禁用配置管理，则必须连接到主数据库（即控制文件角色为主数据库的数据库）才能重新启用配置。</p>
                        </div>
                        <p>禁用代理管理配置成员不会从代理配置文件中删除该成员。您可以通过输入相应的<code class="codeph">ENABLE</code> <code class="codeph">CONFIGURATION</code>或<code class="codeph">ENABLE DATABASE</code>命令来重新启用使用DGMGRL（或Cloud Control）来管理成员的能力。
                        </p>
                     </div>
                  </div><a id="DGBKR560"></a><div class="props_rev_3"><a id="GUID-84500DF2-D9A5-4E4A-B09B-9F1EE56562D1" name="GUID-84500DF2-D9A5-4E4A-B09B-9F1EE56562D1"></a><h5 id="DGBKR-GUID-84500DF2-D9A5-4E4A-B09B-9F1EE56562D1" class="sect5"><span class="enumeration_section">6.9.2.2</span>禁用备用数据库</h5>
                     <div>
                        <p>当您暂时不希望代理管理和监视备用数据库时，可以使用<code class="codeph">DISABLE DATABASE</code>命令。
                        </p>
                        <p>您可以显式禁用备用数据库的代理管理，以防止在启用其余配置时启用备用数据库。以下示例说明如何禁用<code class="codeph">South_Sales</code>备用数据库。
                        </p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; DISABLE DATABASE'South_Sales';禁用。</pre><div class="infoboxnote" id="GUID-84500DF2-D9A5-4E4A-B09B-9F1EE56562D1__GUID-23E0E06A-D8F1-48FD-B95A-2D7C277440B9">
                           <p class="notep1">注意：</p>
                           <p>如果启用了快速启动故障切换并且要禁用的数据库是目标备用数据库，则无法从配置中禁用备用数据库。</p>
                        </div>
                        <div class="infoboxnote" id="GUID-84500DF2-D9A5-4E4A-B09B-9F1EE56562D1__GUID-9ABD9082-DAC2-4670-9AF4-053576624FEB">
                           <p class="notep1">注意：</p>
                           <p>如果在连接到备用数据库时禁用备用数据库的管理，则必须连接到主数据库或其他已启用的备用数据库，以重新启用备用数据库的代理管理。</p>
                        </div>
                        <div class="infoboxnotewarn" id="GUID-84500DF2-D9A5-4E4A-B09B-9F1EE56562D1__GUID-D6365D4F-2091-452D-8714-43211F8BB9C7">
                           <p class="notep1">警告：</p>
                           <p>如果在代理配置中禁用备用数据库的代理管理，则在丢失主数据库时，代理不能将该备用数据库用作故障转移目标。</p>
                        </div>
                        <p>在最大保护模式或最大可用性模式下运行时，代理会阻止您禁用支持保护模式的最后一个备用数据库。</p>
                     </div>
                  </div><a id="DGBKR3870"></a><div class="props_rev_3"><a id="GUID-567D825A-42F7-45AD-869C-8CA2C1191609" name="GUID-567D825A-42F7-45AD-869C-8CA2C1191609"></a><h5 id="DGBKR-GUID-567D825A-42F7-45AD-869C-8CA2C1191609" class="sect5"><span class="enumeration_section">6.9.2.3</span>禁用远程同步实例</h5>
                     <div>
                        <p>当您暂时不希望代理管理和监视远程同步实例时，请使用<code class="codeph">DISABLE</code> <code class="codeph">FAR_SYNC</code>命令。
                        </p>
                        <p>您可以显式禁用远程同步实例的代理管理，以防止在启用其余配置时启用它。以下示例显示如何禁用远程同步实例。</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; DISABLE FAR_SYNC'FS';禁用。
</pre><div class="infoboxnote" id="GUID-567D825A-42F7-45AD-869C-8CA2C1191609__GUID-0F231930-FDBF-47FC-A69C-A8146BFA8C8F">
                           <p class="notep1">注意：</p>
                           <p>禁用远程同步实例时，以下限制适用：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>如果在任何其他配置成员的<code class="codeph">RedoRoutes</code>属性中指定了远程同步实例，则无法禁用远程同步实例。
                                 </p>
                              </li>
                              <li>
                                 <p>如果在连接到远远同步实例时禁用远程同步实例的管理，则必须连接到主数据库或其他已启用的备用数据库，以重新启用远程同步实例的代理管理。</p>
                              </li>
                           </ul>
                        </div>
                        <div class="infoboxnote" id="GUID-567D825A-42F7-45AD-869C-8CA2C1191609__GUID-C47C7C9E-DD49-43D4-96EC-2650C10D2867">
                           <p class="notep1">警告：</p>
                           <p>如果在代理配置中禁用远程同步实例的代理管理，则无法在<code class="codeph">RedoRoutes</code>属性中为任何其他配置成员指定该远程同步实例。
                           </p>
                        </div>
                     </div>
                  </div>
               </div><a id="DGBKR565"></a><div class="props_rev_3"><a id="GUID-820B4A3F-6FA3-4CC7-A06E-27BE25AB66F4" name="GUID-820B4A3F-6FA3-4CC7-A06E-27BE25AB66F4"></a><h4 id="DGBKR-GUID-820B4A3F-6FA3-4CC7-A06E-27BE25AB66F4" class="sect4"><span class="enumeration_section">6.9.3</span>删除配置，备用数据库或远程同步实例</h4>
                  <div>
                     <p>使用<code class="codeph">REMOVE</code> <code class="codeph">CONFIGURATION</code> ， <code class="codeph">REMOVE</code> <code class="codeph">DATABASE</code>或<code class="codeph">REMOVE</code> <code class="codeph">FAR_SYNC</code>命令时，可以有效地从代理配置文件中删除配置，备用数据库或远程同步实例，从而消除Oracle Data Guard代理管理它们的能力。
                     </p>
                     <p>使用<code class="codeph">PRESERVE DESTINATIONS</code>子句的删除操作<span class="italic">不会</span>删除或删除下面的实际Oracle Data Guard配置，也不会影响实际Oracle Data Guard配置及其数据库的操作。
                     </p>
                     <div class="infoboxnote" id="GUID-820B4A3F-6FA3-4CC7-A06E-27BE25AB66F4__GUID-07B5045D-3975-47B0-9316-5C87935E952D">
                        <p class="notep1">注意：</p>
                        <p>使用<code class="codeph">REMOVE</code> <code class="codeph">CONFIGURATION</code> ， <code class="codeph">REMOVE</code> <code class="codeph">DATABASE</code>或<code class="codeph">REMOVE</code> <code class="codeph">FAR_SYNC</code>命令后，如果决定重新创建已删除的对象，则必须重新发出最初发出的命令。您必须完成<a href="examples-using-data-guard-broker-DGMGRL-utility.html#GUID-EBCA7643-F1D9-4EA0-BC5F-45AEEDEBC5BC" title="These examples create a broker configuration named DRSolution that includes a primary and standby database named North_Sales and South_Sales.">场景1：</a>根据需要<a href="examples-using-data-guard-broker-DGMGRL-utility.html#GUID-EBCA7643-F1D9-4EA0-BC5F-45AEEDEBC5BC" title="这些示例创建名为DRSolution的代理配置，其中包括名为North_Sales和South_Sales的主数据库和备用数据库。">创建配置中</a>的步骤，以创建可使用DGMGRL（或云控制）管理的代理配置。
                        </p>
                     </div>
                     <div class="infoboxnote" id="GUID-820B4A3F-6FA3-4CC7-A06E-27BE25AB66F4__GUID-CA141A80-2F32-44F4-AA0E-35B1ED718EDC">
                        <p class="notep1">注意：</p>
                        <p>以下限制适用：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>如果启用了快速启动故障切换并且要删除的数据库是目标备用数据库，则无法从配置中删除备用数据库。</p>
                           </li>
                           <li>
                              <p>如果在<code class="codeph">RedoRoutes</code>属性中为配置中的任何其他成员指定了备用数据库或远程同步实例，则无法删除备用数据库或远程同步实例。
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <div class="props_rev_3"><a id="GUID-6E5F263A-2E28-4B88-B683-F542C426A554" name="GUID-6E5F263A-2E28-4B88-B683-F542C426A554"></a><h5 id="DGBKR-GUID-6E5F263A-2E28-4B88-B683-F542C426A554" class="sect5"><span class="enumeration_section">6.9.3.1</span>从配置中删除备用数据库</h5>
                     <div>
                        <p>使用<code class="codeph">REMOVE</code> <code class="codeph">DATABASE</code>命令时，代理管理和数据库监视将停止，数据库将从代理配置文件中删除。
                        </p>
                        <div class="section">
                           <p>在删除<code class="codeph">South_Sales</code>备用数据库之前显示配置：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; SHOW CONFIGURATION;配置 -  DRSolution保护模式：MaxPerformance成员：North_Sales  - 主数据库FS  - 远程同步South_Sales  - 物理备用数据库快速启动故障转移：禁用配置状态：成功</pre><p>发出DGMGRL <code class="codeph">REMOVE DATABASE</code>命令以从Data Guard配置文件中删除<code class="codeph">South_Sales</code>数据库信息：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt;删除数据库'South_Sales';从配置中删除了数据库“South_Sales”</pre><p>删除<code class="codeph">South_Sales</code>备用数据库后显示配置：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; SHOW CONFIGURATION;配置 -  DRSolution保护模式：MaxPerformance成员：North_Sales  - 主数据库FS  - 远程同步快速启动故障转移：禁用配置状态：成功</pre><p>在最大保护模式或最大可用性模式下运行时，代理会阻止您删除支持保护模式的最后一个备用数据库。</p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
                  <div class="props_rev_3"><a id="GUID-6CD89529-74EC-4BE6-BC9C-8BFF01D38E7D" name="GUID-6CD89529-74EC-4BE6-BC9C-8BFF01D38E7D"></a><h5 id="DGBKR-GUID-6CD89529-74EC-4BE6-BC9C-8BFF01D38E7D" class="sect5"><span class="enumeration_section">6.9.3.2</span>从配置中删除远程同步实例</h5>
                     <div>
                        <p>使用<code class="codeph">REMOVE FAR_SYNC</code>命令从Oracle Data Guard配置文件中删除远程同步实例信息。
                        </p>
                        <div class="section">
                           <p>例如，使用以下命令删除<code class="codeph">FS</code>远程同步实例信息：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt;删除FAR_SYNC'FS';从配置中删除了远程同步实例“FS”</pre><p>删除<code class="codeph">FS</code>远程同步实例后显示配置：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; SHOW CONFIGURATION;配置 -  DRSolution保护模式：MaxPerformance成员：North_Sales  - 主数据库快速启动故障转移：禁用配置状态：成功</pre></div>
                        <!-- class="section" -->
                     </div>
                  </div>
                  <div class="props_rev_3"><a id="GUID-E2300CF1-C3E4-4C03-812C-316B064A12C5" name="GUID-E2300CF1-C3E4-4C03-812C-316B064A12C5"></a><h5 id="DGBKR-GUID-E2300CF1-C3E4-4C03-812C-316B064A12C5" class="sect5"><span class="enumeration_section">6.9.3.3</span>删除代理配置</h5>
                     <div>
                        <p>使用DGMGRL <code class="codeph">REMOVE CONFIGURATION</code>命令从代理管理和监视中删除整个配置。
                        </p>
                        <div class="section">
                           <p>例如：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt;删除配置;</pre><div class="infoboxnote" id="GUID-E2300CF1-C3E4-4C03-812C-316B064A12C5__GUID-7FF7ABFB-321C-40E4-BB46-E3682BCED3E0">
                              <p class="notep1">注意：</p>
                              <p>如果启用了快速启动故障转移，则无法删除配置。</p>
                           </div>
                           <p>DGMGRL返回以下消息，指示该命令已成功从Data Guard配置文件中删除所有配置信息：</p><pre class="oac_no_warn" dir="ltr">删除配置DGMGRL&gt; SHOW CONFIGURATION;错误：ORA-16532：Data Guard代理配置不存在DGMGRL无法确定配置详细信息</pre></div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div>
            </div><a id="DGBKR570"></a><div class="props_rev_3"><a id="GUID-1403D1C3-8944-42D0-8BDA-21D695C7958A" name="GUID-1403D1C3-8944-42D0-8BDA-21D695C7958A"></a><h3 id="DGBKR-GUID-1403D1C3-8944-42D0-8BDA-21D695C7958A" class="sect3"><span class="enumeration_section">6.10</span>场景9：执行切换操作</h3>
               <div>
                  <p>您可以使用<code class="codeph">SWITCHOVER</code>命令<code class="codeph">SWITCHOVER</code>主数据库和备用数据库的角色。
                  </p>
                  <p>在发出<code class="codeph">SWITCHOVER</code>命令之前，必须确保：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>主数据库和备用数据库的状态分别为<code class="codeph">TRANSPORT-ON</code>和<code class="codeph">APPLY-ON</code> 。
                        </p>
                     </li>
                     <li>
                        <p>所有参与的数据库都健康状况良好，没有任何错误或警告。</p>
                     </li>
                     <li>
                        <p>备用数据库属性在主数据库上设置，以便主数据库在转换到备用数据库时可以正常运行（在以下示例中以粗体显示）。</p>
                     </li>
                     <li>
                        <p>在主数据库上配置备用重做日志文件。</p>
                     </li>
                     <li>
                        <p>如果配置处于最大可用性模式，则当前主服务器配置为通过<code class="codeph">SYNC</code>或<code class="codeph">FASTSYNC</code>模式接收重做，如果它将直接从新主服务器接收重做。如果它将通过远程同步实例接收重做，则远程同步实例配置为通过<code class="codeph">SYNC</code>或<code class="codeph">FASTSYNC</code>模式接收重做，并且当前主要配置为通过<code class="codeph">ASYNC</code>模式接收重做。如果配置处于最大保护模式，则将当前主设备配置为通过<code class="codeph">SYNC</code>模式接收重做。
                        </p>
                     </li>
                     <li>
                        <p>如果启用了快速启动故障切换，则只能切换到指定为目标备用数据库的备用数据库。</p>
                     </li>
                  </ul>
                  <p>以下是使用<code class="codeph">SWITCHOVER</code>命令执行切换所需的任务：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="examples-using-data-guard-broker-DGMGRL-utility.html#GUID-B56AA048-02D8-49F4-819C-0B7064E37826" title="使用SHOW DATABASE VERBOSE命令检查主数据库的状态，运行状况和属性。">使用SWITCHOVER命令任务1：检查主数据库</a></p>
                     </li>
                     <li>
                        <p><a href="examples-using-data-guard-broker-DGMGRL-utility.html#GUID-1BB2F379-C18F-428A-9BF0-AD25B6802285" title="使用SHOW DATABASE命令检查作为切换目标的备用数据库的状态。">使用SWITCHOVER命令任务2：检查作为切换目标的备用数据库</a></p>
                     </li>
                     <li>
                        <p><a href="examples-using-data-guard-broker-DGMGRL-utility.html#GUID-93CA2A90-66C5-4DC8-A39B-5486FD2FC4FD" title="在执行角色更改之前，您可以使用VALIDATE DATABASE命令对数据库执行详尽的检查，以确认它已准备好进行角色更改。">使用SWITCHOVER命令任务3：确认数据库已准备好进行角色更改</a></p>
                     </li>
                     <li>
                        <p><a href="examples-using-data-guard-broker-DGMGRL-utility.html#GUID-486321F6-8816-4966-8813-EB5514A38FF2" title="发出SWITCHOVER命令以交换主数据库和备用数据库的角色。">使用SWITCHOVER命令任务4：发出切换命令</a></p>
                     </li>
                     <li>
                        <p><a href="examples-using-data-guard-broker-DGMGRL-utility.html#GUID-DE45B0C6-0536-4852-B66A-CECA69CEF4DD" title="使用SHOW CONFIGURATION命令验证切换是否成功。">使用SWITCHOVER命令任务5：显示配置</a></p>
                     </li>
                  </ul>
               </div>
               <div class="props_rev_3"><a id="GUID-B56AA048-02D8-49F4-819C-0B7064E37826" name="GUID-B56AA048-02D8-49F4-819C-0B7064E37826"></a><h4 id="DGBKR-GUID-B56AA048-02D8-49F4-819C-0B7064E37826" class="sect4"><span class="enumeration_section">6.10.1</span>使用SWITCHOVER命令任务1：检查主数据库</h4>
                  <div>
                     <p>使用<code class="codeph">SHOW DATABASE VERBOSE</code>命令检查主数据库的状态，运行状况和属性。
                     </p>
                     <div class="section">
                        <p>例如：</p>
                        <p></p><pre class="pre codeblock"><code>显示数据库VERBOSE'North_Sales';数据库 -  North_Sales角色：PRIMARY目标状态：TRANSPORT-ON实例：north_sales1属性：DGConnectIdentifier ='North_Sales.example.com'ObserverConnectIdentifier =''FastStartFailoverTarget =''PreferredObserverHosts =''LogShipping ='ON'RedoRoutes ='' LogXptMode ='ASYNC'DelayMins ='0'Binding ='optional'MaxFailure ='0'ReopenSecs ='300'NetTimeout ='30'RedoCompression ='DISABLE'AdferredApplyInstance =''ApplyInstanceTimeout ='0'ApplyLagThreshold ='0'TransportLagThreshold ='0'TransportDisconnectedThreshold ='0'ApplyParallel ='auto'ApplyInstances ='0'BestbyFileManagement =''ArchiveLagTarget ='0'LogArchiveMaxProcesses ='0'LogArchiveMinSucceedDest ='0'DataGuardSyncLatency ='0'LogArchiveTrace = 255 LogArchiveFormat ='db1r_ ％d_％t_％s_％R.arc'DbFileNameConvert ='dbs / cdb2_，dbs / cdb1_，dbs / bt，dbs / t，dbs / cdb4_，dbs / cdb1_，dbs / dt，dbs / t'LogFileNameConvert ='dbs / cdb2_，dbs / cdb1_，dbs / bt，dbs / t，dbs / cdb4_，dbs / cdb1_，dbs / dt，dbs / t'Archi veLocation =''AlternateLocation =''StandbyArchiveLocation =''StandbyAlternateLocation =''InconsistentProperties ='（monitor）'InconsistentLogXptProps ='（monitor）'LogXptStatus ='（monitor）'SendQEntries ='（monitor）'RecvQEntries ='（monitor） 'HostName ='North_Sales.example.com'StaticConnectIdentifier ='（DESCRIPTION =（ADDRESS =（PROTOCOL = tcp）（HOST = North_Sales.example.com）（PORT = 2840））（CONNECT_DATA =（SERVICE_NAME = North_Sales_DGMGRL.example.com） ）（INSTANCE_NAME = north_sales1）（SERVER = DEDICATED）））'TopWaitEvents ='（监视器）'SidName ='（监视器）'日志文件位置：警报日志：/ dev / oracle / log / diag / rdbms / North_Sales / north_sales1 / trace / alert_north_sales1.log Data Guard Broker日志：/dev/oracle/log/diag/rdbms/North_Sales/north_sales1/trace/drcnorth_sales1.log数据库状态：成功</code></pre><p>特别是，您应该检查粗体属性和主数据库的当前状态。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-1BB2F379-C18F-428A-9BF0-AD25B6802285" name="GUID-1BB2F379-C18F-428A-9BF0-AD25B6802285"></a><h4 id="DGBKR-GUID-1BB2F379-C18F-428A-9BF0-AD25B6802285" class="sect4"><span class="enumeration_section">6.10.2</span>使用SWITCHOVER命令任务2：检查作为切换目标的备用数据库</h4>
                  <div>
                     <p>使用<code class="codeph">SHOW DATABASE</code>命令检查作为切换目标的备用数据库的状态。
                     </p>
                     <div class="section">
                        <p>例如：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; SHOW DATABASE'South_Sales';数据库 -  South_Sales角色：PHYSICAL STANDBY预期状态：APPLY-ON传输延迟：0秒（计算0秒前）应用滞后：0秒（计算0秒前）应用率：1.44 MByte / s实时查询：关闭实例（s ）：south_sales1数据库状态：成功</pre></div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-93CA2A90-66C5-4DC8-A39B-5486FD2FC4FD" name="GUID-93CA2A90-66C5-4DC8-A39B-5486FD2FC4FD"></a><h4 id="DGBKR-GUID-93CA2A90-66C5-4DC8-A39B-5486FD2FC4FD" class="sect4"><span class="enumeration_section">6.10.3</span>使用SWITCHOVER命令任务3：确认数据库已准备好进行角色更改</h4>
                  <div>
                     <p>在执行角色更改之前，您可以使用<code class="codeph">VALIDATE</code> <code class="codeph">DATABASE</code>命令对<code class="codeph">DATABASE</code>执行详尽的检查，以确认它已准备好进行角色更改。
                     </p>
                     <div class="section">
                        <p>此步骤中显示的示例对<code class="codeph">DRSolution</code>配置中的所有三个数据库使用<code class="codeph">VALIDATE</code> <code class="codeph">DATABASE</code>命令：主数据库，逻辑备用数据库和物理备用数据库。配置如下：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; SHOW CONFIGURATION;配置 -  DRSolution保护模式：MaxAvailability成员：North_Sales  - 主数据库West_Sales  - 逻辑备用数据库South_Sales  - 物理备用数据库快速启动故障转移：禁用配置状态：成功</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-93CA2A90-66C5-4DC8-A39B-5486FD2FC4FD__GUID-CA4E9E13-384D-454F-A94D-3440C027CB2F">示例：验证主数据库</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">DGMGRL&gt;确认数据库'North_Sales';数据库角色：主数据库准备切换：是</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-93CA2A90-66C5-4DC8-A39B-5486FD2FC4FD__GUID-B8E4F589-3893-4D81-BB46-D31F286BFCC5">示例：验证逻辑备用数据库</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>验证逻辑备用数据库，如下所示：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt;确认数据库'West_Sales';数据库角色：逻辑备用数据库主数据库：North_Sales准备进行切换：是准备好进行故障转移：是（主要运行）警告：如果对此数据库执行角色更改，将禁用物理和快照备用数据库</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-93CA2A90-66C5-4DC8-A39B-5486FD2FC4FD__GUID-E2A2526C-0D1D-4C37-B3C9-1D681A48E10F">示例：验证物理备用数据库</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>验证物理备用数据库，如下所示：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt;确认数据库'South_Sales';数据库角色：物理备用数据库保护模式：MaxAvailability错误：无法切换到此备用数据库，因为没有其他备用数据库可以支持保护模式主数据库：North_Sales准备进行切换：没有准备好进行故障转移：是（主要运行）传输相关属性设置：属性North_Sales值South_Sales值LogXptMode ASYNC SYNC</pre><p>由于配置保护设置为最大可用性模式，而数据库<code class="codeph">South_Sales</code>是唯一将其<code class="codeph">LogXptMode</code>属性设置为<code class="codeph">SYNC</code> ，因此会显示错误以指示无法进行切换。请注意，当数据库从具有传输模式配置的<code class="codeph">RedoRoutes</code>属性的数据库或远程同步实例接收重做时，该模式将覆盖<code class="codeph">LogXptMode</code>指定的传输模式。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-486321F6-8816-4966-8813-EB5514A38FF2" name="GUID-486321F6-8816-4966-8813-EB5514A38FF2"></a><h4 id="DGBKR-GUID-486321F6-8816-4966-8813-EB5514A38FF2" class="sect4"><span class="enumeration_section">6.10.4</span>使用SWITCHOVER命令任务4：发出切换命令</h4>
                  <div>
                     <p>发出<code class="codeph">SWITCHOVER</code>命令以交换主数据库和备用数据库的角色。
                     </p>
                     <div class="section">
                        <p>以下示例显示代理如何在切换过程中自动关闭并重新启动旧主数据库。（有关如何设置代理环境的信息，请参阅“ <a href="oracle-data-guard-broker-commands.html#GUID-AC5DA9D2-5E60-4484-9099-0388BF238ACA" title="The items in this list describe usage notes specific to DGMGRL.">DGMGRL命令使用说明”</a>中的<a href="oracle-data-guard-broker-commands.html#GUID-AC5DA9D2-5E60-4484-9099-0388BF238ACA" title="此列表中的项目描述了DGMGRL特有的使用说明。">使用说明</a> ，以便DGMGRL可以自动为您重新启动主数据库和备用数据库。）
                        </p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; SWITCHOVER到'South_Sales';现在进行切换，请稍候......操作需要连接到数据库“South_Sales”上的实例“south_sales1”连接到实例“south_sales1”...连接为SYSDBA。新的主数据库“South_Sales”正在开放......操作需要在数据库“North_Sales”上启动实例“north_sales1”。启动实例“north_sales1”...ORACLE实例启动了。数据库已安装切换成功，新的主要是“South_Sales”</pre><p>切换完成后，使用<code class="codeph">SHOW CONFIGURATION</code>和<code class="codeph">SHOW DATABASE</code>命令验证切换操作是否成功。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-DE45B0C6-0536-4852-B66A-CECA69CEF4DD" name="GUID-DE45B0C6-0536-4852-B66A-CECA69CEF4DD"></a><h4 id="DGBKR-GUID-DE45B0C6-0536-4852-B66A-CECA69CEF4DD" class="sect4"><span class="enumeration_section">6.10.5</span>使用SWITCHOVER命令任务5：显示配置</h4>
                  <div>
                     <p>使用<code class="codeph">SHOW CONFIGURATION</code>命令验证切换是否成功。
                     </p>
                     <div class="section"><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; SHOW CONFIGURATION;配置 -  DRSolution保护模式：MaxAvailability成员：South_Sales  - 主数据库West_Sales  - 逻辑备用数据库North_Sales  - 物理备用数据库快速启动故障转移：禁用配置状态：成功</pre></div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="DGBKR575"></a><div class="props_rev_3"><a id="GUID-630F5987-328C-410C-AE3B-A9D66EB233D4" name="GUID-630F5987-328C-410C-AE3B-A9D66EB233D4"></a><h3 id="DGBKR-GUID-630F5987-328C-410C-AE3B-A9D66EB233D4" class="sect3"><span class="enumeration_section">6.11</span>场景10：执行手动故障转移操作</h3>
               <div>
                  <p>您可以调用故障转移操作以响应紧急情况，通常是在无法访问主数据库或不可用时。</p>
                  <div class="section">
                     <p>请参阅<a href="using-data-guard-broker-to-manage-switchovers-failovers.html#GUID-2AEF86C4-3CFA-4CF5-AEF3-E25871298363" title="在切换或故障转移后选择备用数据库作为下一个主数据库时，需要考虑几个因素。">选择目标备用数据库，</a>然后再进行故障转移，以确定哪个备用数据库应成为故障转移的目标。以下方案描述了到名为<code class="codeph">South_Sales</code>的远程数据库的故障转移。
                     </p>
                     <div class="infoboxnote" id="GUID-630F5987-328C-410C-AE3B-A9D66EB233D4__GUID-03286FB9-6404-4790-9138-CDD43199D629">
                        <p class="notep1">注意：</p>
                        <p>如果配置了多个快速启动故障切换目标，则只能对当前的快速启动故障切换目标进行手动故障切换。</p>
                        <p>如果要对不是快速启动故障转移目标备用数据库的备用数据库执行手动故障转移，则必须首先使用要故障转移的备用数据库上的<code class="codeph">FORCE</code>选项禁用快速启动故障转移。有关<code class="codeph">FORCE</code>选项的更多信息，请参阅<a href="using-data-guard-broker-to-manage-switchovers-failovers.html#GUID-67878B37-39B5-402A-A219-69E7483405A1" title="禁用快速启动故障转移可防止观察者启动到目标备用数据库的故障转移。">禁用快速启动故障转移</a> 。
                        </p>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>（可选）检查目标备用数据库的准备情况。</span><div>
                           <p>要验证目标备用数据库以确保它已准备好成为新的主数据库，请使用<code class="codeph">VALIDATE</code> <code class="codeph">DATABASE</code>命令，如以下示例所示：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt;确认数据库'South_Sales';数据库角色：物理备用数据库主数据库：South_Sales准备进行切换：是准备好进行故障转移：是</pre></div>
                     </li>
                     <li class="stepexpand"><span>要执行故障转移操作，必须以具有<code class="codeph">SYSDG</code>或<code class="codeph">SYSDBA</code>权限的用户身份连接到要故障转移到的备用数据库。例如：</span><div><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; CONNECT sysdg@South_Sales.example.com;密码： <span class="italic">密码</span>连接到“South_Sales”连接为SYSDG。</pre></div>
                     </li>
                     <li class="stepexpand"><span>现在，您可以发出failover命令，使目标备用数据库成为配置的新主数据库。</span><div><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; FAILOVER到'South_Sales';现在执行故障转移，请稍候...故障转移成功，新的主要是“South_Sales”</pre><p>请注意，故障转移完成后，原始主数据库不能用作新主数据库的备用数据库，除非它已恢复或重新创建（如<a href="using-data-guard-broker-to-manage-switchovers-failovers.html#GUID-D1C0709A-FBF0-4635-95A4-385506A5EC2D" title="To restore your original disaster-recovery solution after switchover to a logical standby database or after failover to any standby database, you may need to perform additional steps.">角色更改后</a>重新<a href="using-data-guard-broker-to-manage-switchovers-failovers.html#GUID-D1C0709A-FBF0-4635-95A4-385506A5EC2D" title="要在切换到逻辑备用数据库后或故障转移到任何备用数据库后还原原始灾难恢复解决方案，可能需要执行其他步骤。">启用已禁用的数据库中所述</a> ）。
                           </p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>发出SHOW CONFIGURATION命令以验证故障转移。</span><div><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; SHOW CONFIGURATION;配置 -  DRSolution保护模式：MaxAvailability成员：South_Sales  - 主数据库警告：ORA-16629：数据库报告与保护模式不同的保护级别North_Sales  - 物理备用数据库（已禁用）ORA-16661：备用数据库需要恢复快速 - 启动故障转移：禁用配置状态：警告</pre><p>请注意，在此示例中，配置在最大可用性模式下运行。故障转移后保留了保护模式。配置也有警告状态。新主<code class="codeph">SHOW DATABASE</code>的<code class="codeph">SHOW DATABASE</code>命令显示警告是未启用物理备用数据库的结果。因此，警告状态表示配置的保护级别与配置的模式不同。
                           </p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>显示新的主数据库。</span><div><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; SHOW DATABASE South_Sales;数据库 -  South_Sales角色：PRIMARY目标状态：TRANSPORT-ON实例：south_sales1数据库警告：ORA-16629：数据库报告与保护模式不同的保护级别数据库状态：警告</pre></div>
                     </li>
                     <li class="stepexpand"><span>发出<code class="codeph">SHOW DATABASE</code>命令，以查看由于故障转移而由代理禁用了前（失败）主数据库。必须恢复它（如<a href="using-data-guard-broker-to-manage-switchovers-failovers.html#GUID-D1C0709A-FBF0-4635-95A4-385506A5EC2D" title="To restore your original disaster-recovery solution after switchover to a logical standby database or after failover to any standby database, you may need to perform additional steps.">角色更改后</a>重新<a href="using-data-guard-broker-to-manage-switchovers-failovers.html#GUID-D1C0709A-FBF0-4635-95A4-385506A5EC2D" title="要在切换到逻辑备用数据库后或故障转移到任何备用数据库后还原原始灾难恢复解决方案，可能需要执行其他步骤。">启用已禁用的数据库中所述</a> ）。</span><div><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; SHOW DATABASE'North_Sales';数据库 -  North_Sales角色：PHYSICAL STANDBY预期状态：APPLY-ON传输延迟:(未知）应用滞后:(未知）应用率:(未知）实时查询：OFF实例：north_sales1数据库状态：ORA-16661：备用数据库需要恢复</pre></div>
                     </li>
                  </ol>
               </div>
            </div><a id="DGBKR3431"></a><div class="props_rev_3"><a id="GUID-D46A9644-136B-4149-8C74-BF4E845B3DE3" name="GUID-D46A9644-136B-4149-8C74-BF4E845B3DE3"></a><h3 id="DGBKR-GUID-D46A9644-136B-4149-8C74-BF4E845B3DE3" class="sect3"><span class="enumeration_section">6.12</span>场景11：恢复失败的主数据库</h3>
               <div>
                  <p>如果以前的主数据库配置了闪回数据库，则可以轻松地将发生故障的主数据库恢复为新主数据库的备用数据库。</p>
                  <div class="section">
                     <p>失败的主数据库将恢复为与旧备用数据库匹配的备用类型。例如，如果故障转移到物理备用数据库，则旧主数据库将恢复为物理备用数据库。</p>
                     <p>要恢复发生故障的主数据库，请将其启动到已装入状态。然后运行DGMGRL，连接到新的主数据库并恢复旧的主数据库。</p>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>重新启动旧的主数据库：</span><div><pre class="oac_no_warn" dir="ltr">％dgmgrl connect sysdg密码： <span class="italic">password</span>连接到“North_Sales”连接为SYSDG。 DGMGRL&gt;启动安装; ORACLE实例启动了。数据库已安装
</pre></div>
                     </li>
                     <li class="stepexpand"><span>恢复旧的主数据库：</span><div><pre class="oac_no_warn" dir="ltr">％dgmgrl connect sysdg密码： <span class="italic">password</span>连接到“North_Sales”连接为SYSDG。 DGMGRL&gt; REINSTATE DATABASE'North_Sales';恢复数据库“North_Sales”，请稍候...数据库“North_Sales”的恢复成功卸载数据库。ORACLE实例关闭。操作需要在数据库“North_Sales”上启动实例“north_sales1”。启动实例“north_sales1”...ORACLE实例启动了。数据库已安装继续恢复数据库“North_Sales”......数据库“North_Sales”的恢复成功</pre><p>恢复主节点后，发出<code class="codeph">SHOW CONFIGURATION</code>和<code class="codeph">SHOW DATABASE</code>命令以确认已成功恢复旧主节点。
                           </p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>显示配置及其成员：</span><div><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; SHOW CONFIGURATION配置 -  DRSolution保护模式：MaxAvailability成员：South_Sales  - 主数据库North_Sales  - 物理备用数据库快速启动故障转移：禁用配置状态：成功DGMGRL&gt;显示数据库'South_Sales';数据库 -  South_Sales角色：PRIMARY预期状态：TRANSPORT-ON实例：south_sales1数据库状态：SUCCESS DGMGRL&gt;显示数据库'North_Sales'数据库 - 'North_Sales'角色：PHYSICAL STANDBY预期状态：APPLY-ON传输延迟：0秒（计算1秒前）应用滞后：0秒（计算1秒前）应用率：0字节/秒实时查询：关闭实例：north_sales1数据库状态：成功</pre></div>
                     </li>
                  </ol>
               </div>
            </div><a id="DGBKR3432"></a><div class="props_rev_3"><a id="GUID-05313396-B80D-4F53-BB44-AC7B0FF5E8B4" name="GUID-05313396-B80D-4F53-BB44-AC7B0FF5E8B4"></a><h3 id="DGBKR-GUID-05313396-B80D-4F53-BB44-AC7B0FF5E8B4" class="sect3"><span class="enumeration_section">6.13</span>场景12：将物理备用转换为快照备用</h3>
               <div>
                  <p>如果您要将物理备用数据库转换为快照备用数据库，请使用DGMGRL <code class="codeph">CONVERT DATABASE</code>命令。
                  </p>
                  <div class="section">
                     <p>当数据库作为快照备用数据库运行时，数据将继续接收重做数据，但在将快照备用数据库转换回物理备用数据库之前，它不会应用。</p>
                     <p>必须为物理备用数据库配置快速恢复区域，才能将其转换为快照备用数据库。这是因为在转换过程中会创建有保证的还原点，并且保证还原点需要快速恢复区域。</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt;将数据库'South_Sales'转换为快照备用数据库;将数据库“South_Sales”转换为快照备用数据库，请稍候...数据库“South_Sales”转换成功DGMGRL&gt; SHOW CONFIGURATION;配置 -  DRSolution保护模式：MaxPerformance成员：North_Sales  - 主数据库South_Sales  - 快照备用数据库快速启动故障转移：禁用配置状态：成功</pre><p>准备好将数据库还原回物理备用数据库时，请再次使用DGMGRL <code class="codeph">CONVERT DATABASE</code>命令，如下所示。在数据库作为快照备用数据库运行时对数据库所做的任何更新都将被丢弃。数据库转换回物理备用数据库后，Redo Apply服务将应用所有累积的重做数据。
                     </p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; CONVERT DATABASE'South_Sales'到PHYSICAL STANDBY;将数据库“South_Sales”转换为Physical Standby数据库，请稍候...操作需要在数据库“South_Sales”上关闭实例“south_sales1”关闭实例“south_sales1”...数据库关闭。数据库已卸下。ORACLE实例关闭。操作需要在数据库“South_Sales”上启动实例“south_sales1”启动实例“south_sales1”...ORACLE实例启动了。数据库已安装继续转换数据库“South_Sales”...数据库“South_Sales”已成功转换</pre></div>
                  <!-- class="section" -->
               </div>
            </div><a id="DGBKR580"></a><div class="props_rev_3"><a id="GUID-13FDC86F-A736-44F0-A2DD-33B7FF3067A7" name="GUID-13FDC86F-A736-44F0-A2DD-33B7FF3067A7"></a><h3 id="DGBKR-GUID-13FDC86F-A736-44F0-A2DD-33B7FF3067A7" class="sect3"><span class="enumeration_section">6.14</span>场景13：监控Data Guard配置</h3>
               <div>
                  <p>这些步骤演示了使用<code class="codeph">SHOW</code>命令和可监视属性来识别和解决故障情况所需的任务。
                  </p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="examples-using-data-guard-broker-DGMGRL-utility.html#GUID-17C2B086-D11B-4C63-9AF6-8809FA0CA015" title="代理配置的状态是代理配置中所有数据库和实例的聚合状态。">监控配置任务1：检查配置状态</a></p>
                     </li>
                     <li>
                        <p><a href="examples-using-data-guard-broker-DGMGRL-utility.html#GUID-4CA56BEF-3309-48D8-A8C1-4DEA2F5C2B8B" title="要识别主数据库上的警告，请使用SHOW DATABASE命令显示其状态。">监控配置任务2：检查数据库状态</a></p>
                     </li>
                     <li>
                        <p><a href="examples-using-data-guard-broker-DGMGRL-utility.html#GUID-FCD421A4-EF56-45BB-BE88-F585C84914EE" title="步骤2中的SHOW DATABASE输出显示错误警告ORA-16737。">监视配置任务3：检查LogXptStatus Monitorable属性</a></p>
                     </li>
                     <li>
                        <p><a href="examples-using-data-guard-broker-DGMGRL-utility.html#GUID-2C585CD3-F32B-432F-8DCE-3288344FBA97" title="要识别重做传输数据库属性ReopenSecs的不一致值，可以使用InconsistentLogXptProps monitorable属性。">监视配置任务4：检查InconsistentLogXptProps Monitorable属性</a></p>
                     </li>
                  </ul>
               </div>
               <div class="props_rev_3"><a id="GUID-17C2B086-D11B-4C63-9AF6-8809FA0CA015" name="GUID-17C2B086-D11B-4C63-9AF6-8809FA0CA015"></a><h4 id="DGBKR-GUID-17C2B086-D11B-4C63-9AF6-8809FA0CA015" class="sect4"><span class="enumeration_section">6.14.1</span>监控配置任务1：检查配置状态</h4>
                  <div>
                     <p>代理配置的状态是代理配置中所有数据库和实例的聚合状态。</p>
                     <div class="section">
                        <p>您可以先检查配置状态，以确定是否需要采取进一步的操作。如果配置状态为SUCCESS，则代理配置中的所有内容都将正常运行。但是，如果您看到WARNING或ERROR状态，则配置中出现问题。</p>
                        <p>例如，在以下显示中，您可以看到主数据库有多个警告：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; SHOW CONFIGURATION;配置 -  DRSolution保护模式：MaxPerformance成员：North_Sales  - 主数据库警告：ORA-16809：检测到数据库的多个警告South_Sales  - 物理备用数据库快速启动故障转移：禁用配置状态：警告</pre></div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-4CA56BEF-3309-48D8-A8C1-4DEA2F5C2B8B" name="GUID-4CA56BEF-3309-48D8-A8C1-4DEA2F5C2B8B"></a><h4 id="DGBKR-GUID-4CA56BEF-3309-48D8-A8C1-4DEA2F5C2B8B" class="sect4"><span class="enumeration_section">6.14.2</span>监控配置任务2：检查数据库状态</h4>
                  <div>
                     <p>要识别主数据库上的警告，请使用<code class="codeph">SHOW DATABASE</code>命令显示其状态。
                     </p>
                     <div class="section">
                        <p>例如：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; SHOW DATABASE'North_Sales';数据库 -  North_Sales角色：PRIMARY预期状态：TRANSPORT-ON实例：north_sales1警告：ORA-16737：备用“red_Sort”的重做传输服务有错误警告：ORA-16714：属性LogArchiveTrace的值与之不一致数据库设置警告：ORA-16715：重做传输相关属性备用数据库“South_Sales”的ReopenSecs不一致数据库状态：警告</pre></div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-FCD421A4-EF56-45BB-BE88-F585C84914EE" name="GUID-FCD421A4-EF56-45BB-BE88-F585C84914EE"></a><h4 id="DGBKR-GUID-FCD421A4-EF56-45BB-BE88-F585C84914EE" class="sect4"><span class="enumeration_section">6.14.3</span>监控配置任务3：检查LogXptStatus Monitorable属性</h4>
                  <div>
                     <p>步骤2中的<code class="codeph">SHOW DATABASE</code>输出显示错误警告ORA-16737。
                     </p>
                     <div class="section">
                        <p>要确定确切的传输错误，请使用<code class="codeph">LogXptStatus</code>属性：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; SHOW DATABASE'North_Sales''LogXptStatus';日志传输状态PRIMARY_INSTANCE_NAME STANDBY_DATABASE_NAME状态north_sales1 South_Sales ORA-12541：TNS：没有侦听器</pre><p>输出显示物理备用数据库的侦听器未运行。要修复此错误，请启动物理备用数据库<code class="codeph">South_Sales</code>的侦听<code class="codeph">South_Sales</code> 。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-2C585CD3-F32B-432F-8DCE-3288344FBA97" name="GUID-2C585CD3-F32B-432F-8DCE-3288344FBA97"></a><h4 id="DGBKR-GUID-2C585CD3-F32B-432F-8DCE-3288344FBA97" class="sect4"><span class="enumeration_section">6.14.4</span>监视配置任务4：检查InconsistentLogXptProps Monitorable属性</h4>
                  <div>
                     <p>要识别重做传输数据库属性<code class="codeph">ReopenSecs</code>的不一致值，可以使用<code class="codeph">InconsistentLogXptProps</code> <code class="codeph">ReopenSecs</code>属性。
                     </p>
                     <div class="section">
                        <p>例如，对于步骤2中<code class="codeph">SHOW DATABASE</code>显示中显示的警告是ORA-16715，这很有用。
                        </p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; SHOW DATABASE'North_Sales''InconsistentLogXptProps';不一致的日志传输属性INSTANCE_NAME STANDBY_NAME PROPERTY_NAME MEMORY_VALUE BROKER_VALUE south_sales1 South_Sales ReopenSecs 600 300</pre><p>当前数据库内存值（600）与Oracle Data Guard代理的属性值（300）不同。如果您认为代理的属性值是正确的，则可以通过使用相同的值重新编辑备用数据库的属性来修复不一致性，如以下示例所示：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt;编辑数据库'South_Sales'Set PROPERTY'ReopenSecs'= 300;属性“ReopenSecs”已更新</pre><p>您还可以重新启用备用数据库或将主数据库的状态重置为<code class="codeph">TRANSPORT-ON</code>以修复此不一致。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div>
            <div class="props_rev_3"><a id="GUID-424D1C65-66EA-4286-B59C-A48D80B4587E" name="GUID-424D1C65-66EA-4286-B59C-A48D80B4587E"></a><h3 id="DGBKR-GUID-424D1C65-66EA-4286-B59C-A48D80B4587E" class="sect3"><span class="enumeration_section">6.15</span>方案14：将恢复设备添加到代理配置</h3>
               <div>
                  <p>这些步骤说明如何将零数据丢失恢复设备（恢复设备）添加到代理配置。</p>
                  <div class="section">
                     <div class="infoboxnotealso" id="GUID-424D1C65-66EA-4286-B59C-A48D80B4587E__GUID-4BBE501F-6E30-49EC-AD72-C125F6A5E7A8">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="managing-oracle-data-guard-broker-configuration-members.html#GUID-845BE719-CC15-4D6C-BD91-FF935CAE605A__BABBEGEI">示例4-9</a>有关如何将恢复设备设置为物理备用数据库的重做目标的示例</p>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>将恢复设备添加到代理配置。</span><div><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; ADD RECOVERY_APPLIANCE EnterpriseRecoveryAppliance AS CONNECT IDENTIFIER是EnterpriseRecoveryAppliance.example.com; Oracle Recovery Appliance“EnterpriseRecoveryAppliance”添加了DGMGRL&gt; SHOW RECOVERY_APPLIANCE'EnterpriseRecoveryAppliance'; Oracle Recovery Server  -  EnterpriseRecoveryAppliance传输延迟：0秒重做源：North_Sales Oracle恢复设备状态：已禁用</pre></div>
                     </li>
                     <li class="stepexpand"><span>启用恢复设备</span><div><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; ENABLE RECOVERY_APPLIANCE'EnterpriseRecoveryAppliance'; DGMGRL&gt; SHOW RECOVERY_APPLIANCE'EnterpriseRecoveryAppliance'; Oracle Recovery Server  -  EnterpriseRecoveryAppliance传输延迟：0秒重做源：North_Sales Oracle恢复设备状态：成功</pre></div>
                     </li>
                  </ol>
               </div>
            </div>
            <div class="sect2"><a id="GUID-1E270915-1E66-45BD-9EC5-5BFF6F66075D" name="GUID-1E270915-1E66-45BD-9EC5-5BFF6F66075D"></a><h3 id="DGBKR-GUID-1E270915-1E66-45BD-9EC5-5BFF6F66075D" class="sect3"><span class="enumeration_section">6.16</span>方案15：导出和导入代理配置文件</h3>
               <div>
                  <p>您可以将代理配置元数据导出到文本文件中。需要重新创建代理配置时，可以将导出的元数据导入当前代理配置。</p>
                  <p></p>
                  <p>在此示例中，您通过将配置元数据导出到文本文件中来保存代理配置。然后通过导入先前导出的文本文件来恢复配置。</p>
                  <ol>
                     <li>
                        <p><a href="examples-using-data-guard-broker-DGMGRL-utility.html#GUID-2ACD269A-6975-453E-BB9B-2467442BD9EF" title="使用EXPORT CONFIGURATION命令将代理配置文件中包含的元数据导出到文本文件。">导出代理配置</a></p>
                     </li>
                     <li>
                        <p><a href="examples-using-data-guard-broker-DGMGRL-utility.html#GUID-3CB876A7-3A29-43EB-9A94-E59725EED8B8" title="使用IMPORT CONFIGURATION命令将存储在文本文件中的代理配置元数据导入到当前代理配置中。">导入代理配置</a></p>
                     </li>
                  </ol>
               </div>
               <div class="sect3"><a id="GUID-2ACD269A-6975-453E-BB9B-2467442BD9EF" name="GUID-2ACD269A-6975-453E-BB9B-2467442BD9EF"></a><h4 id="DGBKR-GUID-2ACD269A-6975-453E-BB9B-2467442BD9EF" class="sect4"><span class="enumeration_section">6.16.1</span>导出代理配置</h4>
                  <div>
                     <p>使用<code class="codeph">EXPORT CONFIGURATION</code>命令将代理配置文件中包含的元数据导出到文本文件。
                     </p>
                     <div class="p">
                        <p>Oracle服务器进程必须可以访问存储代理配置文件的目录。</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>连接到主数据库。</span><div><pre class="pre codeblock"><code>DGMGRL&gt; CONNECT sysdg@North_Sales.example.com;密码： <span class="italic">密码</span>连接到“North_Sales”连接为SYSDG。</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>导出代理配置。</span><div>
                              <p>以下命令导出代理配置并将其存储在跟踪目录中名为<code class="codeph">myconfig.txt</code>的文件中。
                              </p><pre class="pre codeblock"><code>DGMGRL&gt;导出配置为'myconfig.txt';成功了。</code></pre></div>
                        </li>
                     </ol>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-3CB876A7-3A29-43EB-9A94-E59725EED8B8" name="GUID-3CB876A7-3A29-43EB-9A94-E59725EED8B8"></a><h4 id="DGBKR-GUID-3CB876A7-3A29-43EB-9A94-E59725EED8B8" class="sect4"><span class="enumeration_section">6.16.2</span>导入代理配置</h4>
                  <div>
                     <p>使用<code class="codeph">IMPORT CONFIGURATION</code>命令将存储在文本文件中的代理配置元数据导入到当前代理配置中。
                     </p>
                     <div class="section">
                        <p></p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>连接到主数据库。</span><div><pre class="pre codeblock"><code>DGMGRL&gt; CONNECT sysdg@North_Sales.example.com;密码： <span class="italic">密码</span>连接到“North_Sales”连接为SYSDG。</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>将存储在<code class="codeph">trace</code>目录中名为<code class="codeph">myconfig.txt</code>的文件中的代理配置元数据导入到当前代理配置中。</span><div><pre class="pre codeblock"><code>DGMGRL&gt; IMPORT CONFIGURATION'myconfig.txt';成功了。</code></pre></div>
                        </li>
                     </ol>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-F4CD7D5A-8B96-456E-BF69-9A975BA2D504" name="GUID-F4CD7D5A-8B96-456E-BF69-9A975BA2D504"></a><h3 id="DGBKR-GUID-F4CD7D5A-8B96-456E-BF69-9A975BA2D504" class="sect3"><span class="enumeration_section">6.17</span>方案16：使用仅观察模式进行快速启动故障转移</h3>
               <div>
                  <p>通过仅观察模式，您可以测试在配置中使用快速启动故障转移的影响，而无需对配置进行任何实际更改。您可以使用DGMGRL命令或数据字典视图来验证仅观察模式设置。</p>
                  <p></p>
                  <p><span class="bold">话题：</span></p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="examples-using-data-guard-broker-DGMGRL-utility.html#GUID-9E599DC5-E404-41C1-9DB3-00E13EDAD1A8" title="使用ENABLE FAST_START FAILOVER命令配置仅观察模式以实现快速启动故障转移。">配置仅观察模式以实现快速启动故障转移</a></p>
                     </li>
                     <li>
                        <p><a href="examples-using-data-guard-broker-DGMGRL-utility.html#GUID-88711D42-AC2D-4B45-AB96-6D1E28EECCB1" title="此部分显示在仅观察模式下配置快速启动故障转移时对日志文件所做的条目。">仅观察模式下日志文件的示例内容</a></p>
                     </li>
                     <li>
                        <p><a href="examples-using-data-guard-broker-DGMGRL-utility.html#GUID-85076033-2572-4E48-A8D1-0774A88756E1" title="使用DISABLE FAST_START FAILOVER命令退出快速启动故障转移的仅观察模式。必须首先禁用快速启动故障转移，然后在没有OBSERVE ONLY子句的情况下启用快速启动故障转移。">禁用仅观察模式以实现快速启动故障转移</a></p>
                     </li>
                  </ul>
               </div>
               <div class="sect3"><a id="GUID-9E599DC5-E404-41C1-9DB3-00E13EDAD1A8" name="GUID-9E599DC5-E404-41C1-9DB3-00E13EDAD1A8"></a><h4 id="DGBKR-GUID-9E599DC5-E404-41C1-9DB3-00E13EDAD1A8" class="sect4"><span class="enumeration_section">6.17.1</span>配置仅观察模式以实现快速启动故障转移</h4>
                  <div>
                     <p>使用<code class="codeph">ENABLE FAST_START FAILOVER</code>命令配置仅观察模式以实现快速启动故障转移。
                     </p>
                     <ol>
                        <li class="stepexpand"><span>使用以下命令配置快速启动故障转移的仅观察模式。</span><div><pre class="pre codeblock"><code>DGMGRL&gt;仅启用FAST_START FAILOVER OBSERVE;</code></pre><p>所有现有的观察者和将来开始的观察者都将以仅观察模式运行。</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>验证是否已使用以下方法之一设置了仅观察模式：</span><div>
                              <ol type="a">
                                 <li>
                                    <p>使用以下命令显示当前的快速启动故障转移配置：</p><pre class="pre codeblock"><code>DGMGRL&gt; SHOW FAST_START FAILOVER;快速启动故障转移：在仅观察模式下启用</code></pre></li>
                                 <li>
                                    <p>使用以下命令显示当前的快速启动故障转移模式：</p><pre class="pre codeblock"><code>DGMGRL&gt;从V $ DATABASE中选择fs_failover_mode;</code></pre></li>
                              </ol>
                           </div>
                        </li>
                     </ol>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-88711D42-AC2D-4B45-AB96-6D1E28EECCB1" name="GUID-88711D42-AC2D-4B45-AB96-6D1E28EECCB1"></a><h4 id="DGBKR-GUID-88711D42-AC2D-4B45-AB96-6D1E28EECCB1" class="sect4"><span class="enumeration_section">6.17.2</span>仅观察模式下日志文件的示例内容</h4>
                  <div>
                     <p>此部分显示在仅观察模式下配置快速启动故障转移时对日志文件所做的条目。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-88711D42-AC2D-4B45-AB96-6D1E28EECCB1__GUID-9B256F52-6BCA-4642-B231-7BE7FE1C8DFF">示例1： <span class="bold">应启动快速启动故障转移</span></p>
                        <p></p>
                        <p><span class="bold">观察者日志</span></p><pre class="pre codeblock"><code>将启动快速启动故障转移...由于此观察者处于仅观察模式，因此无法进行故障转移</code></pre><p><span class="bold">经纪人日志</span></p><pre class="pre codeblock"><code>快速启动故障转移无法继续，因为：“仅观察模式”</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-88711D42-AC2D-4B45-AB96-6D1E28EECCB1__GUID-47396DE0-EB43-49D8-A625-E5F31AA79C45">示例2：在没有来自Observer或Target Standby的确认的情况下启动期间主数据库打开</p>
                        <p>代理日志文件（drc * .log）和警报日志包含以下内容：</p><pre class="pre codeblock"><code>允许此数据库以仅观察模式打开。在正常FSFO模式下，需要来自观察者或目标待机的确认。</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-88711D42-AC2D-4B45-AB96-6D1E28EECCB1__GUID-D37204E5-1265-47DB-8D86-7B15DDBD8592"><span class="bold">示例3：切换或手动故障转移到旁观者数据库</span></p>
                        <p>代理日志文件（drc * .log）和警报日志包含以下信息：</p><pre class="pre codeblock"><code>即使启用了仅观察模式，也允许FAILOVER到数据库' <span class="italic">数据库名</span> '。由于数据库' <span class="italic">数据库名称</span> '是旁观者数据库，因此它将被拒绝。</code></pre></div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-85076033-2572-4E48-A8D1-0774A88756E1" name="GUID-85076033-2572-4E48-A8D1-0774A88756E1"></a><h4 id="DGBKR-GUID-85076033-2572-4E48-A8D1-0774A88756E1" class="sect4"><span class="enumeration_section">6.17.3</span>禁用仅观察模式以实现快速启动故障转移</h4>
                  <div>
                     <p>使用<code class="codeph">DISABLE FAST_START FAILOVER</code>命令退出快速启动故障转移的仅观察模式。必须首先禁用快速启动故障转移，然后在没有<code class="codeph">OBSERVE ONLY</code>子句的情况下启用快速启动故障转移。
                     </p>
                     <div class="section">
                        <p></p>
                        <p>使用以下命令禁用仅观察模式以进行快速启动故障转移：</p><pre class="pre codeblock"><code>DGMGRL&gt;禁用FAST_START FAILOVER; DGMGRL&gt; ENABLE FAST_START FAILOVER;</code></pre><p>现在启用了快速启动故障转移，没有仅观察模式。</p>
                        <p></p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>