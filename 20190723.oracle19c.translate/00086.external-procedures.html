<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>用多种编程语言开发应用程序</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Database Development Guide"></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Database Development Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="database-development-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-31T23:23:15-08:00"></meta>
      <meta name="dcterms.title" content="Database Development Guide"></meta>
      <meta name="dcterms.dateCopyrighted" content="1996, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96334-02"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="application-architecture.html" title="Previous" type="text/html"></link>
      <link rel="next" href="xa.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="ADFNS"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="application-architecture.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="xa.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">数据库开发指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="advanced-part.html" property="item" typeof="WebPage"><span property="name">应用程序开发人员的高级主题</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">用多种编程语言开发应用程序</li>
            </ol>
            <a id="GUID-230B2B41-2A6F-4756-AEC0-DBC99DCA8A37" name="GUID-230B2B41-2A6F-4756-AEC0-DBC99DCA8A37"></a>
            
            <h2 id="ADFNS-GUID-230B2B41-2A6F-4756-AEC0-DBC99DCA8A37" class="sect2"><span class="enumeration_chapter">21</span>使用多种编程语言开发应用程序</h2>
         </header>
         <div class="ind"><script type="text/javascript">window.name='external-procedures'</script><script type="text/javascript">
    function footdisplay(footnum,footnote) {
    var msg = window.open('about:blank', 'NewWindow' + footnum,
        'directories=no,height=100,location=no,menubar=no,resizable=yes,' +
        'scrollbars=yes,status=no,toolbar=no,width=598');
    msg.document.open('text/html');
    msg.document.write('<!DOCTYPE html ');
    msg.document.write('PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" ');
    msg.document.write('"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">'); 
    msg.document.write('<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us" dir="ltr"><head><title>');
   
    msg.document.write('Footnote&nbsp; ' + footnum);
    msg.document.write('<\/title><meta http-equiv="Content-Type" ');
    msg.document.write('content="text/html; charset=utf-8" />');
    msg.document.write('<meta http-equiv="Content-Script-Type" ');
    msg.document.write('content="text/javascript" />');
    msg.document.write('<style type="text/css"> <![CDATA[ ');
    msg.document.write('h1 {text-align: center; font-size: 14pt;}');
    msg.document.write('fieldset {border: none;}');
    msg.document.write('form {text-align: center;}');
    msg.document.write(' ]]u003e </style>');
    msg.document.write('<\/head><body><div id="footnote"><h1>Footnote&nbsp; ' + footnum + '<\/h1><p>');
    msg.document.write(footnote);
    msg.document.write('<\/p><form action="" method="post"><fieldset>');
    msg.document.write('<input type="button" value="OK" ');
    msg.document.write('onclick="window.close();" />');
    msg.document.write('<\/fieldset><\/form><\/div><\/body><\/html>');
    msg.document.close();
    setTimeout(function() {
        var height = msg.document.getElementById('footnote').offsetHeight;
        msg.resizeTo(598, height + 100);
    }
    , 100);
    msg.focus();
}
            </script><noscript>
               <p>此页面上的脚本内容仅用于导航目的，不会以任何方式更改内容。</p>
            </noscript>
            <div>
               <p>本章介绍如何开发调用其他编程语言编写的外部过程的数据库应用程序。</p>
               <div class="section">
                  <p class="subhead1" id="GUID-230B2B41-2A6F-4756-AEC0-DBC99DCA8A37__GUID-BFBF17B1-1D9A-4DAD-B83C-351994A00CF4">话题：</p>
               </div>
               <!-- class="section" -->
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="external-procedures.html#GUID-04F2EA73-D17A-4ACF-AF05-BBFBC8F8B6AA">多语言程序概述</a></p>
                  </li>
                  <li>
                     <p><a href="external-procedures.html#GUID-456B8988-6418-45C7-86EF-77EA0BE0BCEC">什么是外部程序？</a></p>
                  </li>
                  <li>
                     <p><a href="external-procedures.html#GUID-0B590058-1ED5-43D7-B669-E6F94E3B79A9">外部程序的呼叫规范概述</a></p>
                  </li>
                  <li>
                     <p><a href="external-procedures.html#GUID-8D2D291B-4059-4006-98E5-722D682186C2">加载外部程序</a></p>
                  </li>
                  <li>
                     <p><a href="external-procedures.html#GUID-755619F5-8FF7-4380-BCC5-7E6BD86659DE">发布外部程序</a></p>
                  </li>
                  <li>
                     <p><a href="external-procedures.html#GUID-BC6C93E6-8EE0-47F0-A713-D29AE4942B77">发布Java类方法</a></p>
                  </li>
                  <li>
                     <p><a href="external-procedures.html#GUID-CD08EFEE-66AB-47B3-9628-87895C826C22">发布外部C程序</a></p>
                  </li>
                  <li>
                     <p><a href="external-procedures.html#GUID-ABE1166B-0B2C-4E4C-84D9-2E9AFF45F356">呼叫规范的位置</a></p>
                  </li>
                  <li>
                     <p><a href="external-procedures.html#GUID-D6AC5D91-E0A1-44D0-94BE-B84406721B3B">使用呼叫规范将参数传递给外部C程序</a></p>
                  </li>
                  <li>
                     <p><a href="external-procedures.html#GUID-25A8F1CE-2464-47FD-805A-2FE08996AF63">使用CALL语句运行外部过程</a></p>
                  </li>
                  <li>
                     <p><a href="external-procedures.html#GUID-7B5ADF42-E345-4D87-8736-78ED62B78A21">处理多语言程序中的错误和例外</a></p>
                  </li>
                  <li>
                     <p><a href="external-procedures.html#GUID-F85C0E81-FBE9-4396-A5B1-6E379B44253D">使用具有外部C程序的服务例程</a></p>
                  </li>
                  <li>
                     <p><a href="external-procedures.html#GUID-2F73AD9E-924D-4955-891E-BCFCB0439F59">使用外部C程序执行回调</a></p>
                  </li>
               </ul>
            </div><a id="ADFNS1401"></a><div class="props_rev_3"><a id="GUID-04F2EA73-D17A-4ACF-AF05-BBFBC8F8B6AA" name="GUID-04F2EA73-D17A-4ACF-AF05-BBFBC8F8B6AA"></a><h3 id="ADFNS-GUID-04F2EA73-D17A-4ACF-AF05-BBFBC8F8B6AA" class="sect3">多语言程序概述</h3>
               <div>
                  <p>Oracle数据库允许您使用不同的语言：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>PL / SQL，如<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPLS-GUID-2FBCFBBE-6B42-4DB8-83F3-55B63B75B1EB" target="_blank"><span><cite>Oracle数据库PL / SQL语言参考中所述</cite></span></a></p>
                     </li>
                     <li>
                        <p>C，通过Oracle调用接口（OCI），如<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNOCI-GUID-27645179-6957-4004-8BB8-38775266B038" target="_blank"><span><cite>Oracle调用接口程序员指南中所述</cite></span></a></p>
                     </li>
                     <li>
                        <p>C ++，通过Oracle C ++调用接口（OCCI），如<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNCPP-GUID-99077609-BFCC-4FF7-9D23-C45623DDD465" target="_blank"><span><cite>Oracle C ++调用接口程序员指南中所述</cite></span></a></p>
                     </li>
                     <li>
                        <p>C或C ++，通过Pro * C / C ++预编译器，如<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPCC-GUID-20CBCC27-EC6B-4651-92CC-7E008BD73611" target="_blank"><span><cite>Pro * C / C ++程序员指南中所述</cite></span></a></p>
                     </li>
                     <li>
                        <p>COBOL，通过Pro * COBOL预编译器，如<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPCB-GUID-5B383B0F-9628-443B-8CB7-D2C01607EED6" target="_blank"><span><cite>Pro * COBOL程序员指南中所述</cite></span></a></p>
                     </li>
                     <li>
                        <p>Visual Basic，通过Oracle Provider for OLE DB，如<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=OLEDB003" target="_blank"><span class="italic">Oracle Provider for OLE DB Developer's Guide for Microsoft Windows中所述</span></a> 。
                        </p>
                     </li>
                     <li>
                        <p>.NET，通过Oracle Data Provider for .NET，如<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=ODPNT-GUID-635BAE6C-7D0B-4CF2-ADD8-8DB531B9C52E" target="_blank"><span><cite>Oracle Data Provider for .NET Developer's Guide for Microsoft Windows中所述</cite></span></a></p>
                     </li>
                     <li>
                        <p>Java，通过JDBC和SQLJ客户端应用程序编程接口（API）。请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=JJDBC-GUID-864DB502-5E50-4044-8132-33D6AAF8927A" target="_blank"><span><cite>Oracle数据库JDBC开发人员指南</cite></span></a>和<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=JSQLJ-GUID-B85E73E1-E3B4-45DA-A07A-40678F164AAE" target="_blank"><span><cite>Oracle数据库SQLJ开发人员指南</cite></span></a> 。
                        </p>
                     </li>
                     <li>
                        <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=JJDEV-GUID-912A14D4-2621-4955-85BD-A04E17EE6D21" target="_blank"><span><cite>数据库中的Java</cite></span></a> ，如<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=JJDEV-GUID-912A14D4-2621-4955-85BD-A04E17EE6D21" target="_blank"><span><cite>Oracle数据库Java开发人员指南中所述</cite></span></a> 。这包括使用Java存储过程（发布到SQL并存储在数据库中的Java方法），如<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=JJDEV13234" target="_blank"><span><cite>Oracle数据库Java开发人员指南</cite></span></a>中的章节所述。
                        </p>
                        <p>Oracle JVM Web调出实用程序还可用于生成Java类，以在Java客户端程序中表示数据库实体，例如SQL对象和PL / SQL包;从SQL，PL / SQL和服务器端Java发布到Web服务;并从数据库内部启用外部Web服务的调用。请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=JJDEV-GUID-E66168C4-6043-4A49-9062-A4937B76ABC0" target="_blank"><span><cite>Oracle数据库Java开发人员指南</cite></span></a> 。
                        </p>
                     </li>
                  </ul>
                  <p>如何在这些不同的实施可能性之间做出选择？这些语言中的每一种都提供了不同的优势：易用性，具有特定专业知识的程序员的可用性，对可移植性的需求以及遗留代码的存在是强有力的决定因素。</p>
                  <p>根据应用程序必须如何与Oracle数据库一起使用，选择可能会缩小：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>PL / SQL是一个功能强大的开发工具，专门用于SQL事务处理。</p>
                     </li>
                     <li>
                        <p>一些计算密集型任务在较低级语言中最有效地执行，例如C.</p>
                     </li>
                     <li>
                        <p>对于可移植性和安全性，您可以选择Java。</p>
                     </li>
                     <li>
                        <p>要熟悉Microsoft编程语言，可以选择.NET。</p>
                     </li>
                  </ul>
                  <p>最重要的是性能，只有PL / SQL和Java方法在服务器的地址空间内运行。C / C ++和.NET方法作为外部过程分派，并在服务器系统上运行，但在数据库服务器的地址空间之外。Pro * COBOL和Pro * C / C ++是预编译器，Visual Basic通过Oracle Provider for OLE DB和随后的OCI访问Oracle数据库，后者是用C实现的。</p>
                  <p>考虑到所有这些因素表明，可能存在您可能需要以多种语言实现应用程序的情况。例如，因为Java在服务器的地址空间内运行，所以您可能希望将现有Java应用程序导入数据库，然后通过从PL / SQL和SQL调用Java函数来利用此技术。</p>
                  <p>PL / SQL外部过程使您可以将C过程调用编写为PL / SQL主体。这些C过程可以直接从PL / SQL调用，也可以从SQL调用PL / SQL过程调用。数据库提供了一个专用接口，即调用规范，允许您从其他语言调用外部过程。虽然此服务旨在用于SQL，PL / SQL，C和Java之间的相互通信，但可以从任何可以调用这些语言的基本语言访问它。例如，您的过程可以使用Java或C以外的语言编写，如果C可以调用您的过程，则SQL或PL / SQL可以使用它。因此，如果您有候选C ++过程，请在该过程中使用C ++ <code class="codeph">extern</code> <code class="codeph">"C"</code>语句使其可由C调用。</p>
                  <p>因此，无论您的程序环境如何，您都可以使用不同语言的优势和功能。您不仅限于一种具有固有局限性的语言。外部过程可以提高可重用性和模块性，因为您可以为特定目的部署特定语言。</p>
               </div>
            </div><a id="ADFNS1402"></a><div class="props_rev_3"><a id="GUID-456B8988-6418-45C7-86EF-77EA0BE0BCEC" name="GUID-456B8988-6418-45C7-86EF-77EA0BE0BCEC"></a><h3 id="ADFNS-GUID-456B8988-6418-45C7-86EF-77EA0BE0BCEC" class="sect3">什么是外部程序？</h3>
               <div>
                  <p><strong class="term">外部过程</strong>是存储在动态链接库（DLL）中的过程。您使用基本语言注册该过程，然后调用它以执行特殊目的的处理。
                  </p>
                  <p>例如，当您使用PL / SQL时，该语言在运行时动态加载库，然后调用该过程，就像它是PL / SQL过程一样。这些过程完全参与当前事务，并可以回调数据库以执行SQL操作。</p>
                  <p>仅在必要时加载过程，因此节省了内存。将调用规范与其实现主体分离意味着可以在不影响调用程序的情况下增强过程。</p>
                  <p>外部程序让您：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>隔离数据库实例中客户端应用程序和进程的执行，以确保客户端上的问题不会对数据库产生负面影响</p>
                     </li>
                     <li>
                        <p>将计算绑定程序从客户端移动到服务器，它们运行得更快（因为它们避免了网络通信的往返）</p>
                     </li>
                     <li>
                        <p>将数据库服务器与外部系统和数据源连接</p>
                     </li>
                     <li>
                        <p>扩展数据库服务器本身的功能</p>
                     </li>
                  </ul>
                  <div class="infoboxnote" id="GUID-456B8988-6418-45C7-86EF-77EA0BE0BCEC__GUID-551FF649-9A80-4B09-9603-9024B2B130C0">
                     <p class="notep1">注意：</p>
                     <p>外部库（DLL文件）必须静态链接。换句话说，它不能引用来自其他外部库（DLL文件）的外部符号。Oracle数据库不解析此类符号，因此它们可能导致外部过程失败。</p>
                  </div>
                  <div class="infoboxnotealso" id="GUID-456B8988-6418-45C7-86EF-77EA0BE0BCEC__GUID-AA5D004E-C155-4334-A3A9-72FC6680A034">
                     <p class="notep1">也可以看看：</p>
                     <p>有关保护外部过程的信息，请参见<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=DBSEG656" target="_blank"><span class="italic">“Oracle数据库安</span></a></p>
                  </div>
               </div>
            </div><a id="ADFNS1403"></a><div class="props_rev_3"><a id="GUID-0B590058-1ED5-43D7-B669-E6F94E3B79A9" name="GUID-0B590058-1ED5-43D7-B669-E6F94E3B79A9"></a><h3 id="ADFNS-GUID-0B590058-1ED5-43D7-B669-E6F94E3B79A9" class="sect3">外部程序的呼叫规范概述</h3>
               <div>
                  <p>您可以通过<span class="bold">调用规范</span>发布外部过程，该<span class="bold">规范</span>通过<code class="codeph">AS</code> <code class="codeph">LANGUAGE</code>子句提供<code class="codeph">AS</code> <code class="codeph">EXTERNAL</code>函数的超集。<code class="codeph">AS</code> <code class="codeph">LANGUAGE</code>调用规范允许发布外部C程序。（Java类方法不是外部过程，但它们仍然使用调用规范。）
                  </p>
                  <div class="infoboxnote" id="GUID-0B590058-1ED5-43D7-B669-E6F94E3B79A9__GUID-8B69F41B-2560-4FC9-9A6F-B112AF266E7A">
                     <p class="notep1">注意：</p>
                     <p>为了支持旧版应用程序，调用规范还允许您使用<code class="codeph">AS</code> <code class="codeph">EXTERNAL</code>子句进行发布。但是，对于应用程序开发，建议使用<code class="codeph">AS</code> <code class="codeph">LANGUAGE</code>子句。
                     </p>
                  </div>
                  <p>通常，呼叫规范启用：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>调度适当的C或Java目标过程</p>
                     </li>
                     <li>
                        <p>数据类型转换</p>
                     </li>
                     <li>
                        <p>参数模式映射</p>
                     </li>
                     <li>
                        <p>自动内存分配和清理</p>
                     </li>
                     <li>
                        <p>必要时，为SQL调用的包函数指定纯度约束。</p>
                     </li>
                     <li>
                        <p>从数据库触发器调用Java方法或C过程</p>
                     </li>
                     <li>
                        <p>位置灵活性：您可以将<code class="codeph">AS</code> <code class="codeph">LANGUAGE</code>调用规范放在包或类型规范或包（或类型）主体中以优化性能并隐藏实现细节</p>
                     </li>
                  </ul>
                  <p>要将现有程序用作外部过程，请加载，发布，然后调用它。</p>
               </div>
            </div><a id="ADFNS1404"></a><div class="props_rev_3"><a id="GUID-8D2D291B-4059-4006-98E5-722D682186C2" name="GUID-8D2D291B-4059-4006-98E5-722D682186C2"></a><h3 id="ADFNS-GUID-8D2D291B-4059-4006-98E5-722D682186C2" class="sect3">加载外部程序</h3>
               <div>
                  <div class="section">
                     <p>要使外部C过程或Java方法可用于PL / SQL，必须先加载它们。</p>
                     <div class="infoboxnote" id="GUID-8D2D291B-4059-4006-98E5-722D682186C2__GUID-2B1EF5EE-05A0-42CF-961E-F51A9CC3E71A">
                        <p class="notep1">注意：</p>
                        <p>只能在支持任一DLL或动态可加载的共享库平台加载外部C程序（如Solaris。 <code class="codeph">so</code>的库）。
                        </p>
                     </div>
                     <p>当应用程序调用外部C过程时，Oracle数据库或Oracle Listener将启动外部过程代理<code class="codeph">extproc</code> 。使用Oracle数据库或Oracle Listener建立的网络连接，应用程序将此信息传递给<code class="codeph">extproc</code> ：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type:disc">
                        <li>
                           <p>DLL或共享库的名称</p>
                        </li>
                        <li>
                           <p>外部程序的名称</p>
                        </li>
                        <li>
                           <p>外部过程的任何参数</p>
                        </li>
                     </ul>
                     <p>然后， <code class="codeph">extproc</code>加载DLL或共享库，运行外部过程，并将外部过程返回的任何值传递回应用程序。应用程序和<code class="codeph">extproc</code>必须位于同一台计算机上。
                     </p>
                     <p><code class="codeph">extproc</code>可以调用任何符合所用调用标准的库中的过程。
                     </p>
                     <div class="infoboxnote" id="GUID-8D2D291B-4059-4006-98E5-722D682186C2__GUID-157D539F-6D60-4AED-9AD1-FB39A3AF2BC5">
                        <p class="notep1">注意：</p>
                        <p>外部过程的默认配置不再需要网络侦听器来使用Oracle数据库和<code class="codeph">extproc</code> 。Oracle数据库现在直接生成<code class="codeph">extproc</code> ，从而消除了Oracle Listener意外产生<code class="codeph">extproc</code>的风险。建议使用此默认配置以获得最大安全性。
                        </p>
                        <p>您必须更改此默认配置，以便Oracle Listener生成<code class="codeph">extproc</code> ，如果您使用以下任何一项：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>多线程<code class="codeph">extproc</code>代理</p>
                           </li>
                           <li>
                              <p>Windows上的共享模式下的Oracle数据库</p>
                           </li>
                           <li>
                              <p>一个<code class="codeph">AGENT</code>在子句<code class="codeph">LIBRARY</code>规范或<code class="codeph">AGENT</code> <code class="codeph">IN</code>在子句<code class="codeph">PROCEDURE</code>规范重定向外部程序，以不同的<code class="codeph">extproc</code>剂</p>
                           </li>
                        </ul>
                        <div class="p">
                           <div class="infoboxnotealso" id="GUID-8D2D291B-4059-4006-98E5-722D682186C2__NOTE-132451-CB0178E6">
                              <p class="notep1">也可以看看：</p>
                              <p><a href="external-procedures.html#GUID-5D6BE95D-BE07-4CA7-A2B2-9D4F6E83F809">调用标准</a>有关调用标准的详细信息</p>
                           </div>
                        </div>
                        <p>更改默认配置需要其他网络配置步骤。</p>
                     </div>
                     <p>要将数据库配置为使用用C编写的外部过程，或者可以从C应用程序调用的外部过程，您或您的数据库管理员必须遵循以下步骤：</p>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li><span><a href="external-procedures.html#GUID-D8EF7373-DD76-4D68-AC5D-6BEF0CBD0BBA">定义C程序</a></span></li>
                     <li><span><a href="external-procedures.html#GUID-7C9FA34E-893C-4DFA-B285-674122C00D62">设置环境</a></span></li>
                     <li><span><a href="external-procedures.html#GUID-A329C35E-F941-4341-A320-74C55358641B">识别DLL</a></span></li>
                     <li><span><a href="external-procedures.html#GUID-1CD345DA-0547-4D6F-BB4D-EA8F4F43F321">发布外部程序</a></span></li>
                  </ol>
               </div><a id="ADFNS702"></a><div class="props_rev_3"><a id="GUID-D8EF7373-DD76-4D68-AC5D-6BEF0CBD0BBA" name="GUID-D8EF7373-DD76-4D68-AC5D-6BEF0CBD0BBA"></a><h4 id="ADFNS-GUID-D8EF7373-DD76-4D68-AC5D-6BEF0CBD0BBA" class="sect4">定义C程序</h4>
                  <div>
                     <div class="section">
                        <p>使用以下原型之一定义C过程：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p>Kernighan＆Ritchie风格原型;例如：</p><pre class="oac_no_warn" dir="ltr">void C_findRoot（x）float x; ...
</pre></li>
                           <li>
                              <p>ISO / ANSI原型，而不是全宽度的数值数据类型（如<code class="codeph">float</code> ， <code class="codeph">short</code> ， <code class="codeph">char</code> ）;例如：</p><pre class="oac_no_warn" dir="ltr">void C_findRoot（double x）...
</pre></li>
                           <li>
                              <p>其他数据类型在默认参数提升下不会更改大小。</p>
                              <p>此示例在默认参数提升下更改大小：</p><pre class="oac_no_warn" dir="ltr">void C_findRoot（float x）...</pre></li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADFNS703"></a><div class="props_rev_3"><a id="GUID-7C9FA34E-893C-4DFA-B285-674122C00D62" name="GUID-7C9FA34E-893C-4DFA-B285-674122C00D62"></a><h4 id="ADFNS-GUID-7C9FA34E-893C-4DFA-B285-674122C00D62" class="sect4">设置环境</h4>
                  <div>
                     <div class="section">
                        <p>当您使用外部过程的默认配置时，Oracle数据库会直接生成<code class="codeph">extproc</code> 。您无需为<code class="codeph">listener</code>进行配置更改。 <code class="codeph">ora</code>和<code class="codeph">tnsnames</code> 。 <code class="codeph">ora</code> 。定义文件<code class="codeph">extproc</code>外部过程使用的环境变量。 <code class="codeph">ora</code> （位于UNIX操作系统上的<code class="codeph">$ORACLE_HOME/hs/admin</code>和Windows上的<code class="codeph">ORACLE_HOME\hs\admin</code> ），使用以下语法：</p><pre class="oac_no_warn" dir="ltr">SET <span class="italic">name</span> = <span class="italic">value</span> （ <span class="italic">environment_variable_name</span> <span class="italic">value</span> ）</pre><p>将<code class="codeph">EXTPROC_DLLS</code>环境变量设置为以下值之一，该变量将<code class="codeph">extproc</code>可以加载的DLL限制为：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">NULL</code> ;例如：</p><pre class="oac_no_warn" dir="ltr">SET EXTPROC_DLLS =</pre><p>此设置（默认设置）允许<code class="codeph">extproc</code>仅加载目录<code class="codeph">$ORACLE_HOME</code> / <code class="codeph">bin</code>或<code class="codeph">$ORACLE_HOME</code> / <code class="codeph">lib</code>的DLL。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">ONLY:</code>后跟冒号分隔（在Windows系统上以分号分隔）DLL列表;例如：</p><pre class="oac_no_warn" dir="ltr">SET EXTPROC_DLLS = ONLY：DLL1：DLL2</pre><p>此设置允许<code class="codeph">extproc</code>仅加载名为DLL1和DLL2的DLL。此设置提供最大的安全性。
                              </p>
                           </li>
                           <li>
                              <p>在Windows系统上以冒号分隔（以分号分隔）DLL列表;例如：</p><pre class="oac_no_warn" dir="ltr">SET EXTPROC_DLLS = DLL1：DLL2</pre><p>此设置允许<code class="codeph">extproc</code>加载名为DLL1和DLL2的DLL以及<code class="codeph">$ORACLE_HOME</code> / <code class="codeph">bin</code>或<code class="codeph">$ORACLE_HOME</code> / <code class="codeph">lib</code>目录中的DLL。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">ANY</code> ;例如：</p><pre class="oac_no_warn" dir="ltr">SET EXTPROC_DLLS = ANY</pre><p>此设置允许<code class="codeph">extproc</code>加载任何DLL。</p>
                           </li>
                        </ul>
                        <p>设置<code class="codeph">ENFORCE_CREDENTIAL</code>环境变量，该变量在<code class="codeph">ENFORCE_CREDENTIAL</code> <code class="codeph">extproc</code>进程时强制使用凭据。<code class="codeph">ENFORCE_CREDENTIAL</code>值可以是<code class="codeph">TRUE</code>或<code class="codeph">FALSE</code> （默认值）。有关<code class="codeph">ENFORCE_CREDENTIAL</code>的讨论以及基于可能的身份验证和模拟方案的<code class="codeph">extproc</code>进程的预期行为，请参阅“ <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=DBSEG755" target="_blank"><span class="italic">Oracle数据库安全指南”中</span></a>有关保护外部过程的信息。
                        </p>
                        <p>要更改外部过程的默认配置并让Oracle Listener生成<code class="codeph">extproc</code>代理，请将数据库配置为使用以C编写的外部过程，或者可以从C应用程序调用，如下所示。
                        </p>
                        <div class="infoboxnote" id="GUID-7C9FA34E-893C-4DFA-B285-674122C00D62__GUID-18146EDD-1635-458F-846A-B717B6CA4BF1">
                           <p class="notep1">注意：</p>
                           <p>要使用<span class="bold">extproc的</span>凭据，您不能使用Oracle Listener生成<code class="codeph">extproc</code>代理。
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>在配置文件<code class="codeph">tnsnames</code>设置代理的配置参数，默认情况下名为<code class="codeph">extproc</code> 。 <code class="codeph">ora</code>和<code class="codeph">listener</code> 。 <code class="codeph">ora</code> 。这将在启动数据库时为外部过程代理<code class="codeph">extproc</code>建立连接。</span></li>
                        <li class="stepexpand"><span>仅为外部过程启动侦听器进程。</span><div>
                              <p>监听器为<code class="codeph">extproc</code>设置一些必需的环境变量（例如<code class="codeph">ORACLE_HOME</code> ， <code class="codeph">ORACLE_SID</code>和<code class="codeph">LD_LIBRARY_PATH</code> ）。它还可以在其<code class="codeph">listener</code>的<code class="codeph">ENVS</code>部分中定义特定的环境变量。 <code class="codeph">ora</code> entry，并将这些变量传递给代理进程。否则，它为代理提供“干净”的环境。为代理程序设置的环境变量独立于为客户端和服务器设置的环境变量。因此，在代理进程中运行的外部过程无法读取为客户端或服务器进程设置的环境变量。
                              </p>
                              <div class="infoboxnote" id="GUID-7C9FA34E-893C-4DFA-B285-674122C00D62__GUID-85F1E19F-2B7D-453E-AF17-878458A92224">
                                 <p class="notep1">注意：</p>
                                 <p>您可以分别使用标准C过程<code class="codeph">setenv</code>和<code class="codeph">getenv</code>来设置和读取环境变量。以这种方式设置的环境变量特定于代理进程，这意味着它们可以被该进程中执行的所有函数读取，但不能由同一主机上运行的任何其他进程读取。
                                 </p>
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>确定外部过程的代理是以专用模式（默认）还是多线程模式运行。</span><div>
                              <p>在专用模式下，为每个会话启动一个“专用”代理。在多线程模式下，将启动单个多线程<code class="codeph">extproc</code>代理。多线程<code class="codeph">extproc</code>代理使用不同的线程为不同的用户处理调用。在许多用户可以调用外部过程的配置中，建议使用多线程<code class="codeph">extproc</code>代理来节省系统资源。
                              </p>
                              <p>如果代理程序要以专用模式运行，则无需对代理程序进程进行其他配置。</p>
                              <p>如果代理程序要以多线程模式运行，则数据库管理员必须将数据库系统配置为以多线程模式启动代理程序（作为多线程<code class="codeph">extproc</code>代理程序）。要执行此配置，请使用代理控制实用程序<code class="codeph">agtctl</code> 。例如，使用以下命令启动<code class="codeph">extproc</code> ：</p><pre class="oac_no_warn" dir="ltr">agtctl启动extproc <span class="italic"><code class="codeph">agent_sid</code></span> 
</pre><p>其中<span class="italic"><code class="codeph">agent_sid</code></span>是此<code class="codeph">extproc</code>代理服务的系统标识符。通常将此系统标识符的条目添加为文件<code class="codeph">tnsnames</code>的条目。 <code class="codeph">ora</code> 。
                              </p>
                           </div>
                        </li>
                     </ol>
                     <div class="section">
                        <div class="infoboxnote" id="GUID-7C9FA34E-893C-4DFA-B285-674122C00D62__GUID-0BF9008E-EC02-495A-9C6F-2E6F69386A76">
                           <p class="notep1">注意：</p>
                           <p></p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>如果使用多线程<code class="codeph">extproc</code>代理，则调用的库必须是线程安全的 - 以避免错误，例如损坏的调用堆栈。
                                 </p>
                              </li>
                              <li>
                                 <p>生成代理进程的数据库服务器，代理进程和侦听器进程必须全部驻留在同一主机上。</p>
                              </li>
                              <li>
                                 <p>默认情况下，代理进程在与主应用程序相同的数据库实例上运行。在可靠性至关重要的情况下，您可能希望在单独的数据库实例（仍在同一主机上）上运行外部过程的代理进程，以便代理中的任何问题都不会影响主数据库服务器。为此，请使用数据库链接指定单独的数据库实例。</p>
                              </li>
                           </ul>
                        </div>
                        <p><span class="italic">Oracle Call Interface Programmer's Guide中的</span> <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNOCI949" target="_blank">图F-1</a>说明了多线程<code class="codeph">extproc</code>代理的体系结构。
                        </p>
                        <div class="infoboxnotealso" id="GUID-7C9FA34E-893C-4DFA-B285-674122C00D62__NOTE-1243-CB020252">
                           <p class="notep1">也可以看看：</p>
                           <p>有关使用<code class="codeph">agtctl</code>进行<code class="codeph">extproc</code>管理的更多信息，请<code class="codeph">agtctl</code> <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNOCI953" target="_blank"><span><cite>“Oracle调用接口程序员指南”</cite></span></a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADFNS704"></a><div class="props_rev_3"><a id="GUID-A329C35E-F941-4341-A320-74C55358641B" name="GUID-A329C35E-F941-4341-A320-74C55358641B"></a><h4 id="ADFNS-GUID-A329C35E-F941-4341-A320-74C55358641B" class="sect4">识别DLL</h4>
                  <div>
                     <div class="section">
                        <p>在此上下文中，DLL是存储外部过程的任何可动态加载的操作系统文件。</p>
                        <p>出于安全原因，您的DBA控制对DLL的访问。使用<code class="codeph">CREATE</code> <code class="codeph">LIBRARY</code>语句，DBA创建一个称为别名库的模式对象，该对象表示DLL。然后，如果您是授权用户，DBA将授予您对<span class="bold">别名</span>库的<code class="codeph">EXECUTE</code>特权。或者，DBA可能授予您<code class="codeph">CREATE</code> <code class="codeph">ANY</code> <code class="codeph">LIBRARY</code>权限，在这种情况下，您可以使用以下语法创建自己的别名库：</p><pre class="oac_no_warn" dir="ltr">CREATE LIBRARY [ <span class="italic">schema_name</span> 。] <span class="italic">library_name</span> {IS | AS}' <span class="italic">file_path</span> '[ <span class="italic">AGENT'agent_link</span> '];</pre><div class="infoboxnote" id="GUID-A329C35E-F941-4341-A320-74C55358641B__GUID-62C00C1E-D072-4A25-A590-17BCB4E3269C">
                           <p class="notep1">注意：</p>
                           <p><code class="codeph">ANY</code>特权都非常强大，不能轻易授予。有关更多信息，请参阅：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>有关管理系统特权的信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=DBSEG004" target="_blank"><span class="italic">Oracle数据库安全指南</span></a> ，包括<code class="codeph">ANY</code></p>
                              </li>
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=DBSEG009" target="_blank"><span class="italic">“Oracle数据库安全指南”</span></a> ，了解保护用户帐户和权限的准则</p>
                              </li>
                           </ul>
                        </div>
                        <p>Oracle建议您使用目录对象指定DLL的路径，而不是仅使用DLL名称。在此示例中，您将创建别名库<code class="codeph">c_utils</code> ，它表示DLL <code class="codeph">utils</code> 。 <code class="codeph">so</code> ：</p><pre class="oac_no_warn" dir="ltr">在<span class="italic">DLL_DIRECTORY中</span>创建库C_utils AS'utils.so';</pre><p>其中<span class="italic"><code class="codeph">DLL_DIRECTORY</code></span>是引用<code class="codeph">'/DLLs'</code>的目录对象。
                        </p>
                        <p>作为替代方法，您可以指定DLL的完整路径，如下例所示：</p><pre class="oac_no_warn" dir="ltr">CREATE LIBRARY C_utils AS'/DLLs/utils.so';</pre><p>为了灵活地指定DLL，您可以使用符号<code class="codeph">${</code> <span class="italic"><code class="codeph">VAR_NAME</code></span> <code class="codeph">}</code>将路径的根部分指定为环境变量，并在<code class="codeph">listener</code>的<code class="codeph">ENVS</code>部分中设置该变量。 <code class="codeph">ora</code>项。
                        </p>
                        <p>在这个例子中，通过名称指定的代理<code class="codeph">agent_link</code>用于运行库中的任意外部过程<code class="codeph">C_Utils</code> ：</p><pre class="oac_no_warn" dir="ltr">使用'agent_tns_alias'创建数据库链接agent_link;创建或替换库C_utils是'$ {EP_LIB_HOME} /utils.so'代理'agent_link';</pre><p>环境变量<code class="codeph">EP_LIB_HOME</code>由代理扩展到该实例的适当路径，例如<code class="codeph">/usr/bin/dll</code> 。必须在文件<code class="codeph">listener</code>设置变量<code class="codeph">EP_LIB_HOME</code> 。 <code class="codeph">ora</code> ，让代理能够访问它。
                        </p>
                        <p>出于安全原因，默认情况下， <code class="codeph">extproc</code>仅加载目录<code class="codeph">$ORACLE_HOME/bin</code>或<code class="codeph">$ORACLE_HOME/lib</code> DLL。此外，只允许本地会话（即在同一系统上运行的Oracle数据库客户端进程）连接到<code class="codeph">extproc</code> 。
                        </p>
                        <p>要从其他目录加载DLL，请设置环境变量<code class="codeph">EXTPROC_DLLS</code> 。此环境变量的值是以完整路径限定的DLL名称的冒号分隔（在Windows系统上以分号分隔）列表。例如：</p><pre class="oac_no_warn" dir="ltr">EXTPROC_DLLS = / PRIVATE1 /家/人johndoe / DLL / myDll.so：/private1/home/johndoe/dll/newDll.so</pre><p>您可以通过文件<code class="codeph">listener</code>的<code class="codeph">ENVS</code>参数为<code class="codeph">extproc</code>设置环境变量。 <code class="codeph">ora</code> ，您还可以在<code class="codeph">extproc</code>初始化文件<code class="codeph">extproc</code>设置环境变量。目录<code class="codeph">$ORACLE_HOME/hs/admin</code> <code class="codeph">ora</code> 。当两个<code class="codeph">extproc</code> 。 <code class="codeph">listener</code> <code class="codeph">ora</code>和<code class="codeph">ENVS</code>参数。 <code class="codeph">ora</code> ，在<code class="codeph">extproc</code>定义环境变量。 <code class="codeph">ora</code>优先。有关<code class="codeph">EXTPROC</code>功能的更多信息，请参见Oracle Net手册。
                        </p>
                        <div class="infoboxnote" id="GUID-A329C35E-F941-4341-A320-74C55358641B__GUID-0E39E4DA-EFEB-4A22-91A8-533597FA10F5">
                           <p class="notep1">注意：</p>
                           <p>在Windows系统上的<code class="codeph">extproc.ora</code> ，使用驱动器号指定路径，并对路径中的每个反斜杠使用双反斜杠（ <code class="codeph">\\</code> ）。（每个双反斜杠中的第一个反斜杠用作转义字符。）
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADFNS705"></a><div class="props_rev_3"><a id="GUID-1CD345DA-0547-4D6F-BB4D-EA8F4F43F321" name="GUID-1CD345DA-0547-4D6F-BB4D-EA8F4F43F321"></a><h4 id="ADFNS-GUID-1CD345DA-0547-4D6F-BB4D-EA8F4F43F321" class="sect4">发布外部程序</h4>
                  <div>
                     <div class="section">
                        <p>您找到或写入外部C过程，并将其添加到DLL。当过程在DLL中时，您使用<a href="external-procedures.html#GUID-755619F5-8FF7-4380-BCC5-7E6BD86659DE">发布外部过程中</a>描述的调用规范机制发布它。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="ADFNS1091"></a><a id="ADFNS1405"></a><div class="props_rev_3"><a id="GUID-755619F5-8FF7-4380-BCC5-7E6BD86659DE" name="GUID-755619F5-8FF7-4380-BCC5-7E6BD86659DE"></a><h3 id="ADFNS-GUID-755619F5-8FF7-4380-BCC5-7E6BD86659DE" class="sect3">发布外部程序</h3>
               <div>
                  <div class="section">
                     <p>Oracle数据库只能使用通过调用规范发布的外部过程，该规范将Java类方法或C外部过程的名称，参数类型和返回类型映射到SQL对应项。它的编写方式与任何其他PL / SQL存储过程类似，只是在其主体中，而不是声明和<code class="codeph">BEGIN</code> <code class="codeph">END</code>块，您编写<code class="codeph">AS</code> <code class="codeph">LANGUAGE</code>子句。
                     </p>
                     <p><code class="codeph">AS</code> <code class="codeph">LANGUAGE</code>子句指定：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type:disc">
                        <li>
                           <p>该程序的编写语言</p>
                        </li>
                        <li>
                           <p>对于Java方法：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>Java方法的签名</p>
                              </li>
                           </ul>
                        </li>
                        <li>
                           <p>对于C程序：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>别名库对应于C过程的DLL</p>
                              </li>
                              <li>
                                 <p>DLL中C过程的名称</p>
                              </li>
                              <li>
                                 <p>用于指定参数传递方式的各种选项</p>
                              </li>
                              <li>
                                 <p>哪个参数（如果有）包含外部过程代理的名称<code class="codeph">extproc</code> ，用于在其他系统上运行该过程</p>
                              </li>
                           </ul>
                        </li>
                     </ul>
                     <p>您可以使用常规<code class="codeph">CREATE</code> <code class="codeph">OR</code> <code class="codeph">REPLACE</code>语法为过程，函数，包规范，包体，类型规范或类型主体开始声明。
                     </p>
                     <p>调用规范遵循名称和参数声明。它的语法是：</p><pre class="oac_no_warn" dir="ltr">{IS | AS} LANGUAGE {C | JAVA}</pre><p>然后是：</p><pre class="oac_no_warn" dir="ltr">名称<span class="italic">java_string_literal_name</span>
</pre><p>其中<span class="italic">java_string_literal_name</span>是Java方法的签名</p>
                     <p>或者通过：</p><pre class="oac_no_warn" dir="ltr">{LIBRARY <span class="italic">library_name</span> [NAME <span class="italic">c_string_literal_name</span> ] | [NAME <span class="italic">c_string_literal_name</span> ] LIBRARY <span class="italic">library_name</span> } [AGENT IN（ <span class="italic">argument</span> [， <span class="italic">argument</span> ] ...）] [WITH CONTEXT] [PARAMETERS（ <span class="italic">external_parameter</span> [， <span class="italic">external_parameter</span> ] ...）]。</pre><p>其中<code class="codeph">library_name</code>是别名库的名称， <code class="codeph">c_string_literal_name</code>是外部C过程的名称， <code class="codeph">external_parameter</code>代表：</p><pre class="oac_no_warn" dir="ltr">{CONTEXT |自我[{TDO | property}] | { <span class="italic">parameter_name</span> | RETURN} [ <span class="italic">property</span> ] [BY REFERENCE] [ <span class="italic">external_datatype</span> ]}</pre><p><code class="codeph">property</code>货币：</p><pre class="oac_no_warn" dir="ltr">{INDICATOR [{STRUCT | TDO}] |长度|持续时间| MAXLEN | CHARSETID | CHARSETFORM}</pre><div class="infoboxnote" id="GUID-755619F5-8FF7-4380-BCC5-7E6BD86659DE__GUID-DF2ADAD3-4977-4CAE-944D-8091BFF23B09">
                        <p class="notep1">注意：</p>
                        <p>与Java不同，C不了解SQL类型;因此，语法更复杂</p>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-755619F5-8FF7-4380-BCC5-7E6BD86659DE__GUID-1CB3D220-5831-4298-B077-1E77B0AA2C0A">话题：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="external-procedures.html#GUID-36C76273-69CE-44B3-84E9-367F18935A9C">作为Java类方法的AS LANGUAGE子句</a></p>
                        </li>
                        <li>
                           <p><a href="external-procedures.html#GUID-58F3EC2E-5040-4E04-9A07-58861B2D24A3">外部C程序的AS LANGUAGE条款</a></p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div><a id="ADFNS708"></a><div class="props_rev_3"><a id="GUID-36C76273-69CE-44B3-84E9-367F18935A9C" name="GUID-36C76273-69CE-44B3-84E9-367F18935A9C"></a><h4 id="ADFNS-GUID-36C76273-69CE-44B3-84E9-367F18935A9C" class="sect4">作为Java类方法的AS LANGUAGE子句</h4>
                  <div>
                     <div class="section">
                        <p><code class="codeph">AS</code> <code class="codeph">LANGUAGE</code>子句是PL / SQL和Java类方法之间的接口。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADFNS709"></a><div class="props_rev_3"><a id="GUID-58F3EC2E-5040-4E04-9A07-58861B2D24A3" name="GUID-58F3EC2E-5040-4E04-9A07-58861B2D24A3"></a><h4 id="ADFNS-GUID-58F3EC2E-5040-4E04-9A07-58861B2D24A3" class="sect4">外部C程序的AS LANGUAGE条款</h4>
                  <div>
                     <div class="section">
                        <p>这些子条款告诉PL / SQL在哪里找到外部C程序，如何调用它，以及传递给它的内容：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="external-procedures.html#GUID-7107191C-2A02-48CE-8C08-9576BDAB4844">图书馆</a></p>
                           </li>
                           <li>
                              <p><a href="external-procedures.html#GUID-E582650B-3F82-4E1F-BEA1-F875B3FED378">名称</a></p>
                           </li>
                           <li>
                              <p><a href="external-procedures.html#GUID-1073D814-FA76-40C4-8FA7-948E66BB8517">语言</a></p>
                           </li>
                           <li>
                              <p><a href="external-procedures.html#GUID-5D6BE95D-BE07-4CA7-A2B2-9D4F6E83F809">呼吁标准</a></p>
                           </li>
                           <li>
                              <p><a href="external-procedures.html#GUID-380DBDEB-5FB9-43E4-B8EE-11A11DEB22C6">WITH CONTEXT</a></p>
                           </li>
                           <li>
                              <p><a href="external-procedures.html#GUID-22E70E04-7147-4A61-979A-7E9F561915E8">参数</a></p>
                           </li>
                           <li>
                              <p><span class="q">“ <a href="external-procedures.html#GUID-79BF4402-FBFC-491E-A462-E5395B2BC57C">代理人</a> ”</span></p>
                           </li>
                        </ul>
                        <p>在前面的子条款中，只需要<code class="codeph">LIBRARY</code> 。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div><a id="ADFNS710"></a><div class="props_rev_3"><a id="GUID-7107191C-2A02-48CE-8C08-9576BDAB4844" name="GUID-7107191C-2A02-48CE-8C08-9576BDAB4844"></a><h5 id="ADFNS-GUID-7107191C-2A02-48CE-8C08-9576BDAB4844" class="sect5">图书馆</h5>
                     <div>
                        <div class="section">
                           <p>指定本地别名库。（您不能使用数据库链接指定远程库。）库名称是PL / SQL标识符。因此，如果将名称括在双引号中，则它将区分大小写。（默认情况下，名称以大写形式存储。）您必须对别名库具有<code class="codeph">EXECUTE</code>特权。
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="ADFNS711"></a><div class="props_rev_3"><a id="GUID-E582650B-3F82-4E1F-BEA1-F875B3FED378" name="GUID-E582650B-3F82-4E1F-BEA1-F875B3FED378"></a><h5 id="ADFNS-GUID-E582650B-3F82-4E1F-BEA1-F875B3FED378" class="sect5">名称</h5>
                     <div>
                        <div class="section">
                           <p>指定要调用的外部C过程。如果将过程名称括在双引号中，则它将区分大小写。（默认情况下，名称以大写形式存储。）如果省略此子句，则过程名称默认为PL / SQL过程的大写名称。</p>
                           <div class="infoboxnote" id="GUID-E582650B-3F82-4E1F-BEA1-F875B3FED378__GUID-4B6A5760-2D62-4979-AF8A-0A9E9505D4AE">
                              <p class="notep1">注意：</p>
                              <p>术语<code class="codeph">LANGUAGE</code>和<code class="codeph">CALLING</code> <code class="codeph">STANDARD</code>仅适用于被取代的<code class="codeph">AS</code> <code class="codeph">EXTERNAL</code>子句。
                              </p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="ADFNS712"></a><div class="props_rev_3"><a id="GUID-1073D814-FA76-40C4-8FA7-948E66BB8517" name="GUID-1073D814-FA76-40C4-8FA7-948E66BB8517"></a><h5 id="ADFNS-GUID-1073D814-FA76-40C4-8FA7-948E66BB8517" class="sect5">语言</h5>
                     <div>
                        <div class="section">
                           <p>指定编写外部过程的第三代语言。如果省略此子句，则语言名称默认为C.</p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="ADFNS713"></a><div class="props_rev_3"><a id="GUID-5D6BE95D-BE07-4CA7-A2B2-9D4F6E83F809" name="GUID-5D6BE95D-BE07-4CA7-A2B2-9D4F6E83F809"></a><h5 id="ADFNS-GUID-5D6BE95D-BE07-4CA7-A2B2-9D4F6E83F809" class="sect5">呼吁标准</h5>
                     <div>
                        <div class="section">
                           <p>指定编译外部过程的调用标准。支持的调用标准是C.如果省略此子条款，则调用标准默认为C.</p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="ADFNS714"></a><div class="props_rev_3"><a id="GUID-380DBDEB-5FB9-43E4-B8EE-11A11DEB22C6" name="GUID-380DBDEB-5FB9-43E4-B8EE-11A11DEB22C6"></a><h5 id="ADFNS-GUID-380DBDEB-5FB9-43E4-B8EE-11A11DEB22C6" class="sect5">WITH CONTEXT</h5>
                     <div>
                        <div class="section">
                           <p>指定将上下文指针传递给外部过程。上下文数据结构对外部过程是不透明的，但可用于外部过程调用的服务过程。</p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="ADFNS715"></a><div class="props_rev_3"><a id="GUID-22E70E04-7147-4A61-979A-7E9F561915E8" name="GUID-22E70E04-7147-4A61-979A-7E9F561915E8"></a><h5 id="ADFNS-GUID-22E70E04-7147-4A61-979A-7E9F561915E8" class="sect5">参数</h5>
                     <div>
                        <div class="section">
                           <p>指定传递给外部过程的参数的位置和数据类型。它还可以指定参数属性，例如当前长度和最大长度，以及首选参数传递方法（按值或按引用）。</p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="ADFNS716"></a><div class="props_rev_3"><a id="GUID-79BF4402-FBFC-491E-A462-E5395B2BC57C" name="GUID-79BF4402-FBFC-491E-A462-E5395B2BC57C"></a><h5 id="ADFNS-GUID-79BF4402-FBFC-491E-A462-E5395B2BC57C" class="sect5">代理人</h5>
                     <div>
                        <div class="section">
                           <p>指定哪个参数包含运行此过程的代理进程的名称。这适用于外部过程代理程序<code class="codeph">extproc</code>使用多个代理程序进程运行的情况，以确保在一个外部过程的代理程序进程失败时的稳健性。您可以传递代理进程的名称（对应于数据库链接的名称），以及<code class="codeph">tnsnames</code> 。 <code class="codeph">ora</code>和<code class="codeph">listener</code> 。 <code class="codeph">ora</code>在两个实例之间正确设置，外部过程在另一个实例上调用。两个实例必须位于同一主机上。
                           </p>
                           <p>这类似于<code class="codeph">CREATE</code> <code class="codeph">LIBRARY</code>语句的<code class="codeph">AGENT</code>子句;通过<code class="codeph">AGENT</code> <code class="codeph">IN</code>在运行时指定值允许更大的灵活性。
                           </p>
                           <p>以这种方式指定代理名称时，它将覆盖别名库中声明的任何代理名称。如果未指定代理名称，则缺省值是与调用程序在同一实例上的<code class="codeph">extproc</code>代理程序。
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div>
            </div><a id="ADFNS1406"></a><div class="props_rev_3"><a id="GUID-BC6C93E6-8EE0-47F0-A713-D29AE4942B77" name="GUID-BC6C93E6-8EE0-47F0-A713-D29AE4942B77"></a><h3 id="ADFNS-GUID-BC6C93E6-8EE0-47F0-A713-D29AE4942B77" class="sect3">发布Java类方法</h3>
               <div>
                  <div class="section">
                     <p>Java类及其方法存储在RDBMS libunits中，您可以使用<code class="codeph">LOADJAVA</code>实用程序或<code class="codeph">CREATEJAVA</code> SQL语句在其中加载Java源代码，二进制文件和资源。Libunits可以被认为类似于编写的DLL，例如，在C中，尽管它们与Java类一对一映射，而DLL可以包含多个过程。
                     </p>
                     <p><code class="codeph">NAME</code> -clause字符串唯一标识Java方法。PL / SQL函数或过程和Java必须具有相应的参数。如果Java方法不带参数，则必须为其编写空参数列表。
                     </p>
                     <p>将Java类加载到RDBMS时，它们不会自动发布到SQL。这是因为只有选定的公共静态方法才能显式发布到SQL。但是，只要具有适当的授权，所有方法都可以从驻留在数据库中的其他Java类调用。</p>
                     <p>假设您要发布名为<code class="codeph">J_calcFactorial</code> Java方法，该方法返回其参数的阶乘：</p><pre class="oac_no_warn" dir="ltr">包myRoutines.math; public class Factorial {public static int J_calcFactorial（int n）{if（n == 1）return 1;否则返回n * J_calcFactorial（n  -  1）; }}</pre><p>该调用规范使用SQL * Plus将Java方法<code class="codeph">J_calcFactorial</code>发布为PL / SQL存储函数<code class="codeph">plsToJavaFac_func</code> ：</p><pre class="oac_no_warn" dir="ltr">创建或替换功能Plstojavafac_func（N NUMBER）将语句返回为语言JAVA NAME'myRoutines.math。阶乘。J_calcFactorial（int）return int';</pre></div>
                  <!-- class="section" -->
               </div>
            </div><a id="ADFNS1407"></a><div class="props_rev_3"><a id="GUID-CD08EFEE-66AB-47B3-9628-87895C826C22" name="GUID-CD08EFEE-66AB-47B3-9628-87895C826C22"></a><h3 id="ADFNS-GUID-CD08EFEE-66AB-47B3-9628-87895C826C22" class="sect3">发布外部C程序</h3>
               <div>
                  <div class="section">
                     <p>在此示例中，您编写了一个名为<code class="codeph">plsCallsCdivisor_func</code>的PL / SQL独立函数，该函数将C函数<code class="codeph">Cdivisor_func</code>作为外部函数发布：</p><pre class="oac_no_warn" dir="ltr">创建或替换函数Plscallscdivisor_func（ <span class="italic">/ *查找x和y的最大公约数：* /</span> x PLS_INTEGER，y PLS_INTEGER）RETURN PLS_INTEGER as LANGUAGE C LIBRARY C_utils NAME“Cdivisor_func”; <span class="italic">/ *引号保留案例。* /</span></pre></div>
                  <!-- class="section" -->
               </div>
            </div><a id="ADFNS1321"></a><a id="ADFNS1408"></a><div class="props_rev_3"><a id="GUID-ABE1166B-0B2C-4E4C-84D9-2E9AFF45F356" name="GUID-ABE1166B-0B2C-4E4C-84D9-2E9AFF45F356"></a><h3 id="ADFNS-GUID-ABE1166B-0B2C-4E4C-84D9-2E9AFF45F356" class="sect3">呼叫规范的位置</h3>
               <div>
                  <div class="section">
                     <p>对于Java类方法和外部C过程，可以在以下任何位置指定调用规范：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>独立的PL / SQL程序</p>
                        </li>
                        <li>
                           <p>PL / SQL包规范</p>
                        </li>
                        <li>
                           <p>PL / SQL包体</p>
                        </li>
                        <li>
                           <p>ADT规格</p>
                        </li>
                        <li>
                           <p>ADT机构</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-ABE1166B-0B2C-4E4C-84D9-2E9AFF45F356__GUID-763D578A-3284-472D-8B8A-D7953219EC02">话题：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="external-procedures.html#GUID-BC9F8058-68D3-40A3-AE2B-3C9261D34AA9">示例：在PL / SQL包中查找调用规范</a></p>
                        </li>
                        <li>
                           <p><a href="external-procedures.html#GUID-9DDC222B-B346-41A0-A05E-740986677E2F">示例：在PL / SQL包主体中查找调用规范</a></p>
                        </li>
                        <li>
                           <p><a href="external-procedures.html#GUID-8FCFF0E3-A42E-44FC-847F-BF50BF91DC56">示例：在ADT规范中查找呼叫规范</a></p>
                        </li>
                        <li>
                           <p><a href="external-procedures.html#GUID-41FECDBA-0571-4A30-BDDB-97A359617869">示例：在ADT正文中查找呼叫规范</a></p>
                        </li>
                        <li>
                           <p><a href="external-procedures.html#GUID-D8528756-9D2F-4ACA-A22D-D059A13D6EFB">示例：带有AUTHID的Java</a></p>
                        </li>
                        <li>
                           <p><a href="external-procedures.html#GUID-87C6DA57-0186-4EF2-A5DA-6209D5469FBA">示例：带有可选AUTHID的C.</a></p>
                        </li>
                        <li>
                           <p><a href="external-procedures.html#GUID-34131FAB-D6B5-4791-8327-A18AFECEDC2B">示例：在包中混合呼叫规范</a></p>
                        </li>
                     </ul>
                     <div class="infoboxnote" id="GUID-ABE1166B-0B2C-4E4C-84D9-2E9AFF45F356__GUID-DA2831D4-652F-4C1D-AEEC-D6B4683C86EC">
                        <p class="notep1">注意：</p>
                        <p>在这些示例中，可能需要<code class="codeph">AUTHID</code>和<code class="codeph">SQL_NAME_RESOLVE</code>子句来完全规定调用规范。
                        </p>
                     </div>
                     <div class="infoboxnotealso" id="GUID-ABE1166B-0B2C-4E4C-84D9-2E9AFF45F356__GUID-C2C20D1C-FDF3-446B-9568-42F611EA4F91">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>有关从PL / SQL调用外部过程的更多信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPLS00812" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                           </li>
                           <li>
                              <p>有关SQL <code class="codeph">CALL</code>语句的详细信息，请<a href="../sqlrf/CALL.html#SQLRF01108" target="_blank"><span class="italic">参见Oracle数据库SQL语言参考</span></a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div><a id="ADFNS717"></a><div class="props_rev_3"><a id="GUID-BC9F8058-68D3-40A3-AE2B-3C9261D34AA9" name="GUID-BC9F8058-68D3-40A3-AE2B-3C9261D34AA9"></a><h4 id="ADFNS-GUID-BC9F8058-68D3-40A3-AE2B-3C9261D34AA9" class="sect4">示例：在PL / SQL包中查找调用规范</h4>
                  <div>
                     <div class="section"><pre class="oac_no_warn" dir="ltr">创建或替换包装Demo_pack AUTHID DEFINER作为程序plsToC_demoExternal_proc（x PLS_INTEGER，y VARCHAR2，z DATE）作为语言C名称“C_demoExternal”LIBRARY SomeLib WITH CONTEXT PARAMETERS（CONTEXT，x INT，y STRING，z OCIDATE）;结束;</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADFNS718"></a><div class="props_rev_3"><a id="GUID-9DDC222B-B346-41A0-A05E-740986677E2F" name="GUID-9DDC222B-B346-41A0-A05E-740986677E2F"></a><h4 id="ADFNS-GUID-9DDC222B-B346-41A0-A05E-740986677E2F" class="sect4">示例：在PL / SQL包主体中查找调用规范</h4>
                  <div>
                     <div class="section"><pre class="oac_no_warn" dir="ltr">创建或替换包Demo_pack AUTHID CURRENT_USER作为过程plsToC_demoExternal_proc（x PLS_INTEGER，y VARCHAR2，z DATE）;结束;创建或替换包装体Demo_pack SQL_NAME_RESOLVE CURRENT_USER作为程序plsToC_demoExternal_proc（x PLS_INTEGER，y VARCHAR2，z DATE）AS LANGUAGE JAVA NAME'pkg1.class4.methodProc1（int，java.lang。串，java.sql中。日期）';结束;</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADFNS719"></a><div class="props_rev_3"><a id="GUID-8FCFF0E3-A42E-44FC-847F-BF50BF91DC56" name="GUID-8FCFF0E3-A42E-44FC-847F-BF50BF91DC56"></a><h4 id="ADFNS-GUID-8FCFF0E3-A42E-44FC-847F-BF50BF91DC56" class="sect4">示例：在ADT规范中查找呼叫规范</h4>
                  <div>
                     <div class="section">
                        <div class="infoboxnote" id="GUID-8FCFF0E3-A42E-44FC-847F-BF50BF91DC56__GUID-66D38C0B-20F8-4199-8371-112339DD5F1F">
                           <p class="notep1">注意：</p>
                           <p>要使本主题中的示例起作用，您必须设置此数据结构（这要求您具有<code class="codeph">CREATE</code> <code class="codeph">ANY</code> <code class="codeph">LIBRARY</code>特权）：</p><pre class="oac_no_warn" dir="ltr">创建或替换LIBRARY SOMELIB为'/tmp/lib.so';</pre></div><pre class="oac_no_warn" dir="ltr">创建或替换类型Demo_typ AUTHID DEFINER作为对象（Attribute1 VARCHAR2（2000），SomeLib varchar2（20），成员程序plsToC_demoExternal_proc（x PLS_INTEGER，y VARCHAR2，z DATE）作为语言C名称“C_demoExternal”LIBRARY SomeLib WITH CONTEXT  -  PARAMETERS（ CONTEXT，x INT，y STRING，z OCIDATE）PARAMETERS（CONTEXT，x INT，y STRING，z OCIDATE，SELF））;</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADFNS720"></a><div class="props_rev_3"><a id="GUID-41FECDBA-0571-4A30-BDDB-97A359617869" name="GUID-41FECDBA-0571-4A30-BDDB-97A359617869"></a><h4 id="ADFNS-GUID-41FECDBA-0571-4A30-BDDB-97A359617869" class="sect4">示例：在ADT正文中查找呼叫规范</h4>
                  <div>
                     <div class="section"><pre class="oac_no_warn" dir="ltr">创建或替换类型Demo_typ AUTHID CURRENT_USER作为对象（attribute1 NUMBER，MEMBER PROCEDURE plsToJ_demoExternal_proc（x PLS_INTEGER，y VARCHAR2，z DATE））;创建或替换TYPE BODY Demo_typ作为成员程序plsToJ_demoExternal_proc（x PLS_INTEGER，y VARCHAR2，z DATE）作为语言JAVA NAME'pkg1.class4。J_demoExternal（INT，java.lang中。串，java.sql中。日期）';结束;</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADFNS721"></a><div class="props_rev_3"><a id="GUID-D8528756-9D2F-4ACA-A22D-D059A13D6EFB" name="GUID-D8528756-9D2F-4ACA-A22D-D059A13D6EFB"></a><h4 id="ADFNS-GUID-D8528756-9D2F-4ACA-A22D-D059A13D6EFB" class="sect4">示例：带有AUTHID的Java</h4>
                  <div>
                     <div class="section">
                        <p>以下是在独立PL / SQL过程中发布Java类方法的示例。</p><pre class="oac_no_warn" dir="ltr">创建或替换过程plsToJ_demoExternal_proc（x PLS_INTEGER，y VARCHAR2，z DATE）AUTHID CURRENT_USER as LANGUAGE JAVA NAME'pkg1.class4.methodProc1（int，java.lang。串，java.sql中。日期）';</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADFNS722"></a><div class="props_rev_3"><a id="GUID-87C6DA57-0186-4EF2-A5DA-6209D5469FBA" name="GUID-87C6DA57-0186-4EF2-A5DA-6209D5469FBA"></a><h4 id="ADFNS-GUID-87C6DA57-0186-4EF2-A5DA-6209D5469FBA" class="sect4">示例：带有可选AUTHID的C.</h4>
                  <div>
                     <div class="section">
                        <p>以下是<code class="codeph">AS</code> <code class="codeph">EXTERNAL</code>在独立PL / SQL程序中发布C过程的示例，其中<code class="codeph">AUTHID</code>子句是可选的。这样可以保持与Oracle Database 8.0版的外部过程的兼容性。
                        </p><pre class="oac_no_warn" dir="ltr">创建或替换过程plsToC_demoExternal_proc（x PLS_INTEGER，y VARCHAR2，z DATE）作为外部名称“C_demoExternal”LIBRARY SomeLib WITH CONTEXT PARAMETERS（CONTEXT，x INT，y STRING，z OCIDATE）;</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADFNS723"></a><div class="props_rev_3"><a id="GUID-34131FAB-D6B5-4791-8327-A18AFECEDC2B" name="GUID-34131FAB-D6B5-4791-8327-A18AFECEDC2B"></a><h4 id="ADFNS-GUID-34131FAB-D6B5-4791-8327-A18AFECEDC2B" class="sect4">示例：在包中混合呼叫规范</h4>
                  <div>
                     <div class="section"><pre class="oac_no_warn" dir="ltr">创建或替换包Demo_pack AUTHID DEFINER作为程序plsToC_InBodyOld_proc（x PLS_INTEGER，y VARCHAR2，z DATE）;程序plsToC_demoExternal_proc（x PLS_INTEGER，y VARCHAR2，z DATE）;程序plsToC_InBody_proc（x PLS_INTEGER，y VARCHAR2，z DATE）;程序plsToJ_InBody_proc（x PLS_INTEGER，y VARCHAR2，z DATE）;程序plsToJ_InSpec_proc（x PLS_INTEGER，y VARCHAR2，z DATE）是LANGUAGE JAVA NAME'pkg1.class4。J_InSpec_meth（INT，java.lang中。串，java.sql中。日期）';程序C_InSpec_proc（x PLS_INTEGER，y VARCHAR2，z DATE）作为语言C名称“C_demoExternal”LIBRARY SomeLib WITH CONTEXT PARAMETERS（CONTEXT，x INT，y STRING，z OCIDATE）;结束;创建或替换程序包Demo_pack AS程序plsToC_InBodyOld_proc（x PLS_INTEGER，y VARCHAR2，z DATE）作为外部名称“C_InBodyOld”LIBRARY SomeLib WITH CONTEXT PARAMETERS（CONTEXT，x INT，y STRING，z OCIDATE）;程序plsToC_demoExternal_proc（x PLS_INTEGER，y VARCHAR2，z DATE）作为语言C名称“C_demoExternal”LIBRARY SomeLib WITH CONTEXT PARAMETERS（CONTEXT，x INT，y STRING，z OCIDATE）;程序plsToC_InBody_proc（x PLS_INTEGER，y VARCHAR2，z DATE）AS LANGUAGE C NAME“C_InBody”LIBRARY SomeLib WITH CONTEXT PARAMETERS（CONTEXT，x INT，y STRING，z OCIDATE）;程序plsToJ_InBody_proc（x PLS_INTEGER，y VARCHAR2，z DATE）是LANGUAGE JAVA NAME'pkg1.class4。J_InBody_meth（INT，java.lang中。串，java.sql中。日期）';结束;</pre></div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="ADFNS1092"></a><a id="ADFNS1409"></a><div class="props_rev_3"><a id="GUID-D6AC5D91-E0A1-44D0-94BE-B84406721B3B" name="GUID-D6AC5D91-E0A1-44D0-94BE-B84406721B3B"></a><h3 id="ADFNS-GUID-D6AC5D91-E0A1-44D0-94BE-B84406721B3B" class="sect3">使用呼叫规范将参数传递给外部C程序</h3>
               <div>
                  <div class="section">
                     <p>调用规范允许PL / SQL和C数据类型之间的映射。</p>
                     <p>在以下几种情况下，将参数传递给外部C过程很复杂：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type:disc">
                        <li>
                           <p>可用的PL / SQL数据类型集与C数据类型集不是一一对应的。</p>
                        </li>
                        <li>
                           <p>与C不同，PL / SQL包含RDBMS无效概念。因此，PL / SQL参数可以为<code class="codeph">NULL</code> ，而C参数则不能。
                           </p>
                        </li>
                        <li>
                           <p>外部过程可能需要<code class="codeph">CHAR</code> ， <code class="codeph">LONG</code> <code class="codeph">RAW</code> ， <code class="codeph">RAW</code>和<code class="codeph">VARCHAR2</code>参数的当前长度或最大长度。
                           </p>
                        </li>
                        <li>
                           <p>外部过程可能需要有关<code class="codeph">CHAR</code> ， <code class="codeph">VARCHAR2</code>和<code class="codeph">CLOB</code>参数的字符集信息。
                           </p>
                        </li>
                        <li>
                           <p>PL / SQL可能需要外部过程返回的值的当前长度，最大长度或空状态。</p>
                        </li>
                     </ul>
                     <div class="infoboxnote" id="GUID-D6AC5D91-E0A1-44D0-94BE-B84406721B3B__GUID-E791EFC0-A7F4-482E-B27B-BD254A0E3D6A">
                        <p class="notep1">注意：</p>
                        <p>可以传递给C外部过程的最大参数数为128。但是，如果按值传递float或double参数，则最大值小于128。多少取决于这些参数和操作系统的数量。要获得粗略估计，请将每个浮点值或两个值的值计算为两个参数。</p>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-D6AC5D91-E0A1-44D0-94BE-B84406721B3B__GUID-0C4A5409-194E-46E7-A20B-BD572671252D">话题：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="external-procedures.html#GUID-0EEB2593-067D-498F-BF8F-FD508E03B09C">指定数据类型</a></p>
                        </li>
                        <li>
                           <p><a href="external-procedures.html#GUID-4C42C0B1-4065-473B-B1A5-D86497529978">外部数据类型映射</a></p>
                        </li>
                        <li>
                           <p><a href="external-procedures.html#GUID-AAED15F3-B00A-4FD4-8AA0-567B12A67234">通过VALUE或BY REFERENCE传递参数</a></p>
                        </li>
                        <li>
                           <p><a href="external-procedures.html#GUID-E9F173EF-A940-442C-95F0-CED014259005">声明正式参数</a></p>
                        </li>
                        <li>
                           <p><a href="external-procedures.html#GUID-F0D604FB-D266-4EB4-ACFE-EA24FE5ACF26">覆盖默认数据类型映射</a></p>
                        </li>
                        <li>
                           <p><a href="external-procedures.html#GUID-5689A420-BDEF-46B1-90FB-9003DE792A6E">指定属性</a></p>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-D6AC5D91-E0A1-44D0-94BE-B84406721B3B__NOTE-1342-CB02C85E">
                        <p class="notep1">也可以看看：</p>
                        <p>有关数据类型映射的更多信息，请<a href="external-procedures.html#GUID-0EEB2593-067D-498F-BF8F-FD508E03B09C">指定数据类型</a> 。
                        </p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div><a id="ADFNS725"></a><a id="ADFNS724"></a><div class="props_rev_3"><a id="GUID-0EEB2593-067D-498F-BF8F-FD508E03B09C" name="GUID-0EEB2593-067D-498F-BF8F-FD508E03B09C"></a><h4 id="ADFNS-GUID-0EEB2593-067D-498F-BF8F-FD508E03B09C" class="sect4">指定数据类型</h4>
                  <div>
                     <div class="section">
                        <p>不要直接将参数传递给外部过程。而是将它们传递给发布外部过程的PL / SQL过程，为参数指定PL / SQL数据类型。PL / SQL数据类型映射到默认外部数据类型，如<a href="external-procedures.html#GUID-0EEB2593-067D-498F-BF8F-FD508E03B09C__g1024826" title="参数数据类型映射">表21-1</a>所示。
                        </p>
                        <div class="infoboxnote" id="GUID-0EEB2593-067D-498F-BF8F-FD508E03B09C__GUID-82CDF7B0-9D59-4AFC-8D1C-BD3ECE2E1690">
                           <p class="notep1">注意：</p>
                           <p>PL / SQL数据类型<code class="codeph">BINARY_INTEGER</code>和<code class="codeph">PLS_INTEGER</code>是相同的。为简单起见，本指南使用“ <code class="codeph">PLS_INTEGER</code> ”表示<code class="codeph">BINARY_INTEGER</code>和<code class="codeph">PLS_INTEGER</code> 。</p>
                        </div>
                        <div class="tblformalwide" id="GUID-0EEB2593-067D-498F-BF8F-FD508E03B09C__g1024826">
                           <p class="titleintable">表21-1参数数据类型映射</p>
                           <table cellpadding="4" cellspacing="0" class="FormalWide" title="参数数据类型映射" width="100%" border="1" summary="Parameter Datatype Mappings" frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="35%" id="d121552e4572">PL / SQL数据类型</th>
                                    <th align="left" valign="bottom" width="40%" id="d121552e4575">支持的外部类型</th>
                                    <th align="left" valign="bottom" width="25%" id="d121552e4578">默认外部类型</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="35%" id="d121552e4583" headers="d121552e4572 "><pre class="oac_no_warn" dir="ltr">BINARY_INTEGER BOOLEAN PLS_INTEGER</pre></td>
                                    <td align="left" valign="top" width="40%" headers="d121552e4583 d121552e4575 "><pre class="oac_no_warn" dir="ltr">[UNSIGNED] CHAR [UNSIGNED] SHORT [UNSIGNED] INT [UNSIGNED] LONG SB1，SB2，SB4 UB1，UB2，UB4 SIZE_T</pre></td>
                                    <td align="left" valign="top" width="25%" headers="d121552e4583 d121552e4578 "><pre class="oac_no_warn" dir="ltr">INT</pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="35%" id="d121552e4593" headers="d121552e4572 "><pre class="oac_no_warn" dir="ltr">NATURAL <a id="GUID-0EEB2593-067D-498F-BF8F-FD508E03B09C__BEJEAFAE" name="GUID-0EEB2593-067D-498F-BF8F-FD508E03B09C__BEJEAFAE" href="#GUID-0EEB2593-067D-498F-BF8F-FD508E03B09C__BEJEAFAE" type="" this="" pl="" /sql="" compiles="" only="" if="" you="" use="" as="" external="" in="" your="" call="" spec=")" ="" onclick="footdisplay(1, "><sup>Foot 1</sup></a> NATURALN <a id="fnsrc_d121552e4606" name="fnsrc_d121552e4606" href="#fnsrc_d121552e4606" type="" this="" pl="" /sql="" compiles="" only="" if="" you="" use="" as="" external="" in="" your="" call="" spec=")" ="" onclick="footdisplay(1, "><sup>Footref 1</sup></a> POSITIVE <a id="fnsrc_d121552e4609" name="fnsrc_d121552e4609" href="#fnsrc_d121552e4609" type="" this="" pl="" /sql="" compiles="" only="" if="" you="" use="" as="" external="" in="" your="" call="" spec=")" ="" onclick="footdisplay(1, "><sup>Footref 1</sup></a> POSITIVEN <a id="fnsrc_d121552e4612" name="fnsrc_d121552e4612" href="#fnsrc_d121552e4612" type="" this="" pl="" /sql="" compiles="" only="" if="" you="" use="" as="" external="" in="" your="" call="" spec=")" ="" onclick="footdisplay(1, "><sup>Footref 1</sup></a> SIGNTYPE <a id="fnsrc_d121552e4615" name="fnsrc_d121552e4615" href="#fnsrc_d121552e4615" type="" this="" pl="" /sql="" compiles="" only="" if="" you="" use="" as="" external="" in="" your="" call="" spec=")" ="" onclick="footdisplay(1, "><sup>Footref 1</sup></a></pre></td>
                                    <td align="left" valign="top" width="40%" headers="d121552e4593 d121552e4575 "><pre class="oac_no_warn" dir="ltr">[UNSIGNED] CHAR [UNSIGNED] SHORT [UNSIGNED] INT [UNSIGNED] LONG SB1，SB2，SB4 UB1，UB2，UB4 SIZE_T</pre></td>
                                    <td align="left" valign="top" width="25%" headers="d121552e4593 d121552e4578 "><pre class="oac_no_warn" dir="ltr">UNSIGNED INT</pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="35%" id="d121552e4624" headers="d121552e4572 "><pre class="oac_no_warn" dir="ltr">FLOAT REAL</pre></td>
                                    <td align="left" valign="top" width="40%" headers="d121552e4624 d121552e4575 "><pre class="oac_no_warn" dir="ltr">浮动</pre></td>
                                    <td align="left" valign="top" width="25%" headers="d121552e4624 d121552e4578 "><pre class="oac_no_warn" dir="ltr">浮动</pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="35%" id="d121552e4634" headers="d121552e4572 "><pre class="oac_no_warn" dir="ltr">双精度</pre></td>
                                    <td align="left" valign="top" width="40%" headers="d121552e4634 d121552e4575 "><pre class="oac_no_warn" dir="ltr">双</pre></td>
                                    <td align="left" valign="top" width="25%" headers="d121552e4634 d121552e4578 "><pre class="oac_no_warn" dir="ltr">双</pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="35%" id="d121552e4644" headers="d121552e4572 "><pre class="oac_no_warn" dir="ltr">CHAR CHARACTER LONG NCHAR NVARCHAR2 ROWID VARCHAR VARCHAR2</pre></td>
                                    <td align="left" valign="top" width="40%" headers="d121552e4644 d121552e4575 "><pre class="oac_no_warn" dir="ltr">STRING OCISTRING</pre></td>
                                    <td align="left" valign="top" width="25%" headers="d121552e4644 d121552e4578 "><pre class="oac_no_warn" dir="ltr">串</pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="35%" id="d121552e4654" headers="d121552e4572 "><pre class="oac_no_warn" dir="ltr">LONG RAW RAW</pre></td>
                                    <td align="left" valign="top" width="40%" headers="d121552e4654 d121552e4575 "><pre class="oac_no_warn" dir="ltr">RAW OCIRAW</pre></td>
                                    <td align="left" valign="top" width="25%" headers="d121552e4654 d121552e4578 "><pre class="oac_no_warn" dir="ltr">生的</pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="35%" id="d121552e4664" headers="d121552e4572 "><pre class="oac_no_warn" dir="ltr">BFILE BLOB CLOB NCLOB</pre></td>
                                    <td align="left" valign="top" width="40%" headers="d121552e4664 d121552e4575 "><pre class="oac_no_warn" dir="ltr">OCILOBLOCATOR</pre></td>
                                    <td align="left" valign="top" width="25%" headers="d121552e4664 d121552e4578 "><pre class="oac_no_warn" dir="ltr">OCILOBLOCATOR</pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="35%" id="d121552e4674" headers="d121552e4572 "><pre class="oac_no_warn" dir="ltr">NUMBER DEC <a id="fnsrc_d121552e4677" name="fnsrc_d121552e4677" href="#fnsrc_d121552e4677" type="" this="" pl="" /sql="" compiles="" only="" if="" you="" use="" as="" external="" in="" your="" call="" spec=")" ="" onclick="footdisplay(1, "><sup>Footref 1</sup></a> DECIMAL <a id="fnsrc_d121552e4680" name="fnsrc_d121552e4680" href="#fnsrc_d121552e4680" type="" this="" pl="" /sql="" compiles="" only="" if="" you="" use="" as="" external="" in="" your="" call="" spec=")" ="" onclick="footdisplay(1, "><sup>Footref 1</sup></a> INT <a id="fnsrc_d121552e4683" name="fnsrc_d121552e4683" href="#fnsrc_d121552e4683" type="" this="" pl="" /sql="" compiles="" only="" if="" you="" use="" as="" external="" in="" your="" call="" spec=")" ="" onclick="footdisplay(1, "><sup>Footref 1</sup></a> INTEGER <a id="fnsrc_d121552e4686" name="fnsrc_d121552e4686" href="#fnsrc_d121552e4686" type="" this="" pl="" /sql="" compiles="" only="" if="" you="" use="" as="" external="" in="" your="" call="" spec=")" ="" onclick="footdisplay(1, "><sup>Footref 1</sup></a> NUMERIC <a id="fnsrc_d121552e4689" name="fnsrc_d121552e4689" href="#fnsrc_d121552e4689" type="" this="" pl="" /sql="" compiles="" only="" if="" you="" use="" as="" external="" in="" your="" call="" spec=")" ="" onclick="footdisplay(1, "><sup>Footref 1</sup></a> SMALLINT <a id="fnsrc_d121552e4693" name="fnsrc_d121552e4693" href="#fnsrc_d121552e4693" type="" this="" pl="" /sql="" compiles="" only="" if="" you="" use="" as="" external="" in="" your="" call="" spec=")" ="" onclick="footdisplay(1, "><sup>Footref 1</sup></a></pre></td>
                                    <td align="left" valign="top" width="40%" headers="d121552e4674 d121552e4575 "><pre class="oac_no_warn" dir="ltr">OCINUMBER</pre></td>
                                    <td align="left" valign="top" width="25%" headers="d121552e4674 d121552e4578 "><pre class="oac_no_warn" dir="ltr">OCINUMBER</pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="35%" id="d121552e4702" headers="d121552e4572 "><pre class="oac_no_warn" dir="ltr">日期</pre></td>
                                    <td align="left" valign="top" width="40%" headers="d121552e4702 d121552e4575 "><pre class="oac_no_warn" dir="ltr">OCIDATE</pre></td>
                                    <td align="left" valign="top" width="25%" headers="d121552e4702 d121552e4578 "><pre class="oac_no_warn" dir="ltr">OCIDATE</pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="35%" id="d121552e4712" headers="d121552e4572 "><pre class="oac_no_warn" dir="ltr">TIMESTAMP TIMESTAMP与时区TIMESTAMP与当地时区</pre></td>
                                    <td align="left" valign="top" width="40%" headers="d121552e4712 d121552e4575 "><pre class="oac_no_warn" dir="ltr"><code class="codeph">OCIDateTime</code></pre></td>
                                    <td align="left" valign="top" width="25%" headers="d121552e4712 d121552e4578 "><pre class="oac_no_warn" dir="ltr"><code class="codeph">OCIDateTime</code></pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="35%" id="d121552e4724" headers="d121552e4572 "><pre class="oac_no_warn" dir="ltr">第二个间隔年至第二个月的间隔日</pre></td>
                                    <td align="left" valign="top" width="40%" headers="d121552e4724 d121552e4575 "><pre class="oac_no_warn" dir="ltr">OCIInterval</pre></td>
                                    <td align="left" valign="top" width="25%" headers="d121552e4724 d121552e4578 "><pre class="oac_no_warn" dir="ltr">OCIInterval</pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="35%" id="d121552e4735" headers="d121552e4572 "><pre class="oac_no_warn" dir="ltr">复合对象类型：ADT</pre></td>
                                    <td align="left" valign="top" width="40%" headers="d121552e4735 d121552e4575 "><pre class="oac_no_warn" dir="ltr">dvoid</pre></td>
                                    <td align="left" valign="top" width="25%" headers="d121552e4735 d121552e4578 "><pre class="oac_no_warn" dir="ltr">dvoid</pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="35%" id="d121552e4745" headers="d121552e4572 "><pre class="oac_no_warn" dir="ltr">复合对象类型：集合（关联数组，varrays，嵌套表）</pre></td>
                                    <td align="left" valign="top" width="40%" headers="d121552e4745 d121552e4575 "><pre class="oac_no_warn" dir="ltr">OCICOLL</pre></td>
                                    <td align="left" valign="top" width="25%" headers="d121552e4745 d121552e4578 "><pre class="oac_no_warn" dir="ltr">OCICOLL</pre></td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                        <p class="tablefootnote"><sup class="tablefootnote">脚注1</sup></p><p>仅当您在呼叫规范中使用<code class="codeph">AS</code> <code class="codeph">EXTERNAL</code> ，此PL / SQL类型才会编译。
                           </p>
                        <p></p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADFNS727"></a><a id="ADFNS726"></a><div class="props_rev_3"><a id="GUID-4C42C0B1-4065-473B-B1A5-D86497529978" name="GUID-4C42C0B1-4065-473B-B1A5-D86497529978"></a><h4 id="ADFNS-GUID-4C42C0B1-4065-473B-B1A5-D86497529978" class="sect4">外部数据类型映射</h4>
                  <div>
                     <div class="section">
                        <p>每种外部数据类型都映射到C数据类型，并且隐式执行数据类型转换。为了避免在声明C原型参数时出错，请参阅<a href="external-procedures.html#GUID-4C42C0B1-4065-473B-B1A5-D86497529978__g1024886" title="此表汇总了外部数据类型映射。">表21-2</a> ，其中显示了为给定外部数据类型和PL / SQL参数模式指定的C数据类型。例如，如果<code class="codeph">OUT</code>参数的外部数据类型为<code class="codeph">STRING</code> ，则在C原型中指定数据类型char *。
                        </p>
                        <div class="tblformal" id="GUID-4C42C0B1-4065-473B-B1A5-D86497529978__g1024886">
                           <p class="titleintable">表21-2外部数据类型映射</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="外部数据类型映射" width="100%" border="1" summary="This table summarizes the external datatype mappings." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="22%" id="d121552e4876">外部数据类型对应PL / SL类型</th>
                                    <th align="left" valign="bottom" width="25%" id="d121552e4879">如果Mode为IN或RETURN，请在C Prototype中指定...</th>
                                    <th align="left" valign="bottom" width="32%" id="d121552e4882">如果Mode是IN by Reference或RETURN by Reference，请在C Prototype中指定...</th>
                                    <th align="left" valign="bottom" width="21%" id="d121552e4885">如果Mode为IN OUT或OUT，请在C Prototype中指定...</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="22%" id="d121552e4890" headers="d121552e4876 "><pre class="oac_no_warn" dir="ltr">CHAR</pre></td>
                                    <td align="left" valign="top" width="25%" headers="d121552e4890 d121552e4879 "><pre class="oac_no_warn" dir="ltr">烧焦</pre></td>
                                    <td align="left" valign="top" width="32%" headers="d121552e4890 d121552e4882 "><pre class="oac_no_warn" dir="ltr">char *</pre></td>
                                    <td align="left" valign="top" width="21%" headers="d121552e4890 d121552e4885 "><pre class="oac_no_warn" dir="ltr">char *</pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="22%" id="d121552e4903" headers="d121552e4876 "><pre class="oac_no_warn" dir="ltr">无符号的字符</pre></td>
                                    <td align="left" valign="top" width="25%" headers="d121552e4903 d121552e4879 "><pre class="oac_no_warn" dir="ltr">无符号的字符</pre></td>
                                    <td align="left" valign="top" width="32%" headers="d121552e4903 d121552e4882 "><pre class="oac_no_warn" dir="ltr">无符号的字符 *</pre></td>
                                    <td align="left" valign="top" width="21%" headers="d121552e4903 d121552e4885 "><pre class="oac_no_warn" dir="ltr">无符号的字符 *</pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="22%" id="d121552e4916" headers="d121552e4876 "><pre class="oac_no_warn" dir="ltr">短</pre></td>
                                    <td align="left" valign="top" width="25%" headers="d121552e4916 d121552e4879 "><pre class="oac_no_warn" dir="ltr">短</pre></td>
                                    <td align="left" valign="top" width="32%" headers="d121552e4916 d121552e4882 "><pre class="oac_no_warn" dir="ltr">短*</pre></td>
                                    <td align="left" valign="top" width="21%" headers="d121552e4916 d121552e4885 "><pre class="oac_no_warn" dir="ltr">短*</pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="22%" id="d121552e4929" headers="d121552e4876 "><pre class="oac_no_warn" dir="ltr">未签约的短信</pre></td>
                                    <td align="left" valign="top" width="25%" headers="d121552e4929 d121552e4879 "><pre class="oac_no_warn" dir="ltr">未签约的短片</pre></td>
                                    <td align="left" valign="top" width="32%" headers="d121552e4929 d121552e4882 "><pre class="oac_no_warn" dir="ltr">无符号短*</pre></td>
                                    <td align="left" valign="top" width="21%" headers="d121552e4929 d121552e4885 "><pre class="oac_no_warn" dir="ltr">无符号短*</pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="22%" id="d121552e4942" headers="d121552e4876 "><pre class="oac_no_warn" dir="ltr">INT</pre></td>
                                    <td align="left" valign="top" width="25%" headers="d121552e4942 d121552e4879 "><pre class="oac_no_warn" dir="ltr">INT</pre></td>
                                    <td align="left" valign="top" width="32%" headers="d121552e4942 d121552e4882 "><pre class="oac_no_warn" dir="ltr">int *</pre></td>
                                    <td align="left" valign="top" width="21%" headers="d121552e4942 d121552e4885 "><pre class="oac_no_warn" dir="ltr">int *</pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="22%" id="d121552e4955" headers="d121552e4876 "><pre class="oac_no_warn" dir="ltr">UNSIGNED INT</pre></td>
                                    <td align="left" valign="top" width="25%" headers="d121552e4955 d121552e4879 "><pre class="oac_no_warn" dir="ltr">unsigned int</pre></td>
                                    <td align="left" valign="top" width="32%" headers="d121552e4955 d121552e4882 "><pre class="oac_no_warn" dir="ltr">unsigned int *</pre></td>
                                    <td align="left" valign="top" width="21%" headers="d121552e4955 d121552e4885 "><pre class="oac_no_warn" dir="ltr">unsigned int *</pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="22%" id="d121552e4968" headers="d121552e4876 "><pre class="oac_no_warn" dir="ltr">长</pre></td>
                                    <td align="left" valign="top" width="25%" headers="d121552e4968 d121552e4879 "><pre class="oac_no_warn" dir="ltr">长</pre></td>
                                    <td align="left" valign="top" width="32%" headers="d121552e4968 d121552e4882 "><pre class="oac_no_warn" dir="ltr">长 *</pre></td>
                                    <td align="left" valign="top" width="21%" headers="d121552e4968 d121552e4885 "><pre class="oac_no_warn" dir="ltr">长 *</pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="22%" id="d121552e4981" headers="d121552e4876 "><pre class="oac_no_warn" dir="ltr">签名不合适</pre></td>
                                    <td align="left" valign="top" width="25%" headers="d121552e4981 d121552e4879 "><pre class="oac_no_warn" dir="ltr">无符号长</pre></td>
                                    <td align="left" valign="top" width="32%" headers="d121552e4981 d121552e4882 "><pre class="oac_no_warn" dir="ltr">无符号长*</pre></td>
                                    <td align="left" valign="top" width="21%" headers="d121552e4981 d121552e4885 "><pre class="oac_no_warn" dir="ltr">无符号长*</pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="22%" id="d121552e4994" headers="d121552e4876 "><pre class="oac_no_warn" dir="ltr">CHAR</pre></td>
                                    <td align="left" valign="top" width="25%" headers="d121552e4994 d121552e4879 "><pre class="oac_no_warn" dir="ltr">烧焦</pre></td>
                                    <td align="left" valign="top" width="32%" headers="d121552e4994 d121552e4882 "><pre class="oac_no_warn" dir="ltr">char *</pre></td>
                                    <td align="left" valign="top" width="21%" headers="d121552e4994 d121552e4885 "><pre class="oac_no_warn" dir="ltr">char *</pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="22%" id="d121552e5007" headers="d121552e4876 "><pre class="oac_no_warn" dir="ltr">无符号的字符</pre></td>
                                    <td align="left" valign="top" width="25%" headers="d121552e5007 d121552e4879 "><pre class="oac_no_warn" dir="ltr">无符号的字符</pre></td>
                                    <td align="left" valign="top" width="32%" headers="d121552e5007 d121552e4882 "><pre class="oac_no_warn" dir="ltr">无符号的字符 *</pre></td>
                                    <td align="left" valign="top" width="21%" headers="d121552e5007 d121552e4885 "><pre class="oac_no_warn" dir="ltr">无符号的字符 *</pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="22%" id="d121552e5020" headers="d121552e4876 "><pre class="oac_no_warn" dir="ltr">短</pre></td>
                                    <td align="left" valign="top" width="25%" headers="d121552e5020 d121552e4879 "><pre class="oac_no_warn" dir="ltr">短</pre></td>
                                    <td align="left" valign="top" width="32%" headers="d121552e5020 d121552e4882 "><pre class="oac_no_warn" dir="ltr">短*</pre></td>
                                    <td align="left" valign="top" width="21%" headers="d121552e5020 d121552e4885 "><pre class="oac_no_warn" dir="ltr">短*</pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="22%" id="d121552e5034" headers="d121552e4876 "><pre class="oac_no_warn" dir="ltr">未签约的短信</pre></td>
                                    <td align="left" valign="top" width="25%" headers="d121552e5034 d121552e4879 "><pre class="oac_no_warn" dir="ltr">未签约的短片</pre></td>
                                    <td align="left" valign="top" width="32%" headers="d121552e5034 d121552e4882 "><pre class="oac_no_warn" dir="ltr">无符号短*</pre></td>
                                    <td align="left" valign="top" width="21%" headers="d121552e5034 d121552e4885 "><pre class="oac_no_warn" dir="ltr">无符号短*</pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="22%" id="d121552e5047" headers="d121552e4876 "><pre class="oac_no_warn" dir="ltr">INT</pre></td>
                                    <td align="left" valign="top" width="25%" headers="d121552e5047 d121552e4879 "><pre class="oac_no_warn" dir="ltr">INT</pre></td>
                                    <td align="left" valign="top" width="32%" headers="d121552e5047 d121552e4882 "><pre class="oac_no_warn" dir="ltr">int *</pre></td>
                                    <td align="left" valign="top" width="21%" headers="d121552e5047 d121552e4885 "><pre class="oac_no_warn" dir="ltr">int *</pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="22%" id="d121552e5060" headers="d121552e4876 "><pre class="oac_no_warn" dir="ltr">UNSIGNED INT</pre></td>
                                    <td align="left" valign="top" width="25%" headers="d121552e5060 d121552e4879 "><pre class="oac_no_warn" dir="ltr">unsigned int</pre></td>
                                    <td align="left" valign="top" width="32%" headers="d121552e5060 d121552e4882 "><pre class="oac_no_warn" dir="ltr">unsigned int *</pre></td>
                                    <td align="left" valign="top" width="21%" headers="d121552e5060 d121552e4885 "><pre class="oac_no_warn" dir="ltr">unsigned int *</pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="22%" id="d121552e5073" headers="d121552e4876 "><pre class="oac_no_warn" dir="ltr">长</pre></td>
                                    <td align="left" valign="top" width="25%" headers="d121552e5073 d121552e4879 "><pre class="oac_no_warn" dir="ltr">长</pre></td>
                                    <td align="left" valign="top" width="32%" headers="d121552e5073 d121552e4882 "><pre class="oac_no_warn" dir="ltr">长 *</pre></td>
                                    <td align="left" valign="top" width="21%" headers="d121552e5073 d121552e4885 "><pre class="oac_no_warn" dir="ltr">长 *</pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="22%" id="d121552e5086" headers="d121552e4876 "><pre class="oac_no_warn" dir="ltr">签名不合适</pre></td>
                                    <td align="left" valign="top" width="25%" headers="d121552e5086 d121552e4879 "><pre class="oac_no_warn" dir="ltr">无符号长</pre></td>
                                    <td align="left" valign="top" width="32%" headers="d121552e5086 d121552e4882 "><pre class="oac_no_warn" dir="ltr">无符号长*</pre></td>
                                    <td align="left" valign="top" width="21%" headers="d121552e5086 d121552e4885 "><pre class="oac_no_warn" dir="ltr">无符号长*</pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="22%" id="d121552e5099" headers="d121552e4876 "><pre class="oac_no_warn" dir="ltr">SIZE_T</pre></td>
                                    <td align="left" valign="top" width="25%" headers="d121552e5099 d121552e4879 "><pre class="oac_no_warn" dir="ltr">为size_t</pre></td>
                                    <td align="left" valign="top" width="32%" headers="d121552e5099 d121552e4882 "><pre class="oac_no_warn" dir="ltr">size_t *</pre></td>
                                    <td align="left" valign="top" width="21%" headers="d121552e5099 d121552e4885 "><pre class="oac_no_warn" dir="ltr">size_t *</pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="22%" id="d121552e5112" headers="d121552e4876 "><pre class="oac_no_warn" dir="ltr">SB1</pre></td>
                                    <td align="left" valign="top" width="25%" headers="d121552e5112 d121552e4879 "><pre class="oac_no_warn" dir="ltr">SB1</pre></td>
                                    <td align="left" valign="top" width="32%" headers="d121552e5112 d121552e4882 "><pre class="oac_no_warn" dir="ltr">sb1 *</pre></td>
                                    <td align="left" valign="top" width="21%" headers="d121552e5112 d121552e4885 "><pre class="oac_no_warn" dir="ltr">sb1 *</pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="22%" id="d121552e5125" headers="d121552e4876 "><pre class="oac_no_warn" dir="ltr">UB1</pre></td>
                                    <td align="left" valign="top" width="25%" headers="d121552e5125 d121552e4879 "><pre class="oac_no_warn" dir="ltr">UB1</pre></td>
                                    <td align="left" valign="top" width="32%" headers="d121552e5125 d121552e4882 "><pre class="oac_no_warn" dir="ltr">ub1 *</pre></td>
                                    <td align="left" valign="top" width="21%" headers="d121552e5125 d121552e4885 "><pre class="oac_no_warn" dir="ltr">ub1 *</pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="22%" id="d121552e5138" headers="d121552e4876 "><pre class="oac_no_warn" dir="ltr">SB2</pre></td>
                                    <td align="left" valign="top" width="25%" headers="d121552e5138 d121552e4879 "><pre class="oac_no_warn" dir="ltr">SB2</pre></td>
                                    <td align="left" valign="top" width="32%" headers="d121552e5138 d121552e4882 "><pre class="oac_no_warn" dir="ltr">sb2 *</pre></td>
                                    <td align="left" valign="top" width="21%" headers="d121552e5138 d121552e4885 "><pre class="oac_no_warn" dir="ltr">sb2 *</pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="22%" id="d121552e5151" headers="d121552e4876 "><pre class="oac_no_warn" dir="ltr">UB2</pre></td>
                                    <td align="left" valign="top" width="25%" headers="d121552e5151 d121552e4879 "><pre class="oac_no_warn" dir="ltr">UB2</pre></td>
                                    <td align="left" valign="top" width="32%" headers="d121552e5151 d121552e4882 "><pre class="oac_no_warn" dir="ltr">ub2 *</pre></td>
                                    <td align="left" valign="top" width="21%" headers="d121552e5151 d121552e4885 "><pre class="oac_no_warn" dir="ltr">ub2 *</pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="22%" id="d121552e5164" headers="d121552e4876 "><pre class="oac_no_warn" dir="ltr">SB4</pre></td>
                                    <td align="left" valign="top" width="25%" headers="d121552e5164 d121552e4879 "><pre class="oac_no_warn" dir="ltr">SB4</pre></td>
                                    <td align="left" valign="top" width="32%" headers="d121552e5164 d121552e4882 "><pre class="oac_no_warn" dir="ltr">sb4 *</pre></td>
                                    <td align="left" valign="top" width="21%" headers="d121552e5164 d121552e4885 "><pre class="oac_no_warn" dir="ltr">sb4 *</pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="22%" id="d121552e5178" headers="d121552e4876 "><pre class="oac_no_warn" dir="ltr">UB4</pre></td>
                                    <td align="left" valign="top" width="25%" headers="d121552e5178 d121552e4879 "><pre class="oac_no_warn" dir="ltr">UB4</pre></td>
                                    <td align="left" valign="top" width="32%" headers="d121552e5178 d121552e4882 "><pre class="oac_no_warn" dir="ltr">ub4 *</pre></td>
                                    <td align="left" valign="top" width="21%" headers="d121552e5178 d121552e4885 "><pre class="oac_no_warn" dir="ltr">ub4 *</pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="22%" id="d121552e5191" headers="d121552e4876 "><pre class="oac_no_warn" dir="ltr">浮动</pre></td>
                                    <td align="left" valign="top" width="25%" headers="d121552e5191 d121552e4879 "><pre class="oac_no_warn" dir="ltr">浮动</pre></td>
                                    <td align="left" valign="top" width="32%" headers="d121552e5191 d121552e4882 "><pre class="oac_no_warn" dir="ltr">漂浮*</pre></td>
                                    <td align="left" valign="top" width="21%" headers="d121552e5191 d121552e4885 "><pre class="oac_no_warn" dir="ltr">漂浮*</pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="22%" id="d121552e5204" headers="d121552e4876 "><pre class="oac_no_warn" dir="ltr">双</pre></td>
                                    <td align="left" valign="top" width="25%" headers="d121552e5204 d121552e4879 "><pre class="oac_no_warn" dir="ltr">双</pre></td>
                                    <td align="left" valign="top" width="32%" headers="d121552e5204 d121552e4882 "><pre class="oac_no_warn" dir="ltr">双*</pre></td>
                                    <td align="left" valign="top" width="21%" headers="d121552e5204 d121552e4885 "><pre class="oac_no_warn" dir="ltr">双*</pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="22%" id="d121552e5217" headers="d121552e4876 "><pre class="oac_no_warn" dir="ltr">串</pre></td>
                                    <td align="left" valign="top" width="25%" headers="d121552e5217 d121552e4879 "><pre class="oac_no_warn" dir="ltr">char *</pre></td>
                                    <td align="left" valign="top" width="32%" headers="d121552e5217 d121552e4882 "><pre class="oac_no_warn" dir="ltr">char *</pre></td>
                                    <td align="left" valign="top" width="21%" headers="d121552e5217 d121552e4885 "><pre class="oac_no_warn" dir="ltr">char *</pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="22%" id="d121552e5230" headers="d121552e4876 "><pre class="oac_no_warn" dir="ltr">生的</pre></td>
                                    <td align="left" valign="top" width="25%" headers="d121552e5230 d121552e4879 "><pre class="oac_no_warn" dir="ltr">无符号的字符 *</pre></td>
                                    <td align="left" valign="top" width="32%" headers="d121552e5230 d121552e4882 "><pre class="oac_no_warn" dir="ltr">无符号的字符 *</pre></td>
                                    <td align="left" valign="top" width="21%" headers="d121552e5230 d121552e4885 "><pre class="oac_no_warn" dir="ltr">无符号的字符 *</pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="22%" id="d121552e5243" headers="d121552e4876 "><pre class="oac_no_warn" dir="ltr">OCILOBLOCATOR</pre></td>
                                    <td align="left" valign="top" width="25%" headers="d121552e5243 d121552e4879 "><pre class="oac_no_warn" dir="ltr">OCILobLocator *</pre></td>
                                    <td align="left" valign="top" width="32%" headers="d121552e5243 d121552e4882 "><pre class="oac_no_warn" dir="ltr">OCILobLocator **</pre></td>
                                    <td align="left" valign="top" width="21%" headers="d121552e5243 d121552e4885 "><pre class="oac_no_warn" dir="ltr">OCILobLocator **</pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="22%" id="d121552e5256" headers="d121552e4876 "><pre class="oac_no_warn" dir="ltr">OCINUMBER</pre></td>
                                    <td align="left" valign="top" width="25%" headers="d121552e5256 d121552e4879 "><pre class="oac_no_warn" dir="ltr">OCINumber *</pre></td>
                                    <td align="left" valign="top" width="32%" headers="d121552e5256 d121552e4882 "><pre class="oac_no_warn" dir="ltr">OCINumber *</pre></td>
                                    <td align="left" valign="top" width="21%" headers="d121552e5256 d121552e4885 "><pre class="oac_no_warn" dir="ltr">OCINumber *</pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="22%" id="d121552e5269" headers="d121552e4876 "><pre class="oac_no_warn" dir="ltr">OCISTRING</pre></td>
                                    <td align="left" valign="top" width="25%" headers="d121552e5269 d121552e4879 "><pre class="oac_no_warn" dir="ltr">OCIString *</pre></td>
                                    <td align="left" valign="top" width="32%" headers="d121552e5269 d121552e4882 "><pre class="oac_no_warn" dir="ltr">OCIString *</pre></td>
                                    <td align="left" valign="top" width="21%" headers="d121552e5269 d121552e4885 "><pre class="oac_no_warn" dir="ltr">OCIString *</pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="22%" id="d121552e5282" headers="d121552e4876 "><pre class="oac_no_warn" dir="ltr">OCIRAW</pre></td>
                                    <td align="left" valign="top" width="25%" headers="d121552e5282 d121552e4879 "><pre class="oac_no_warn" dir="ltr">OCIRaw *</pre></td>
                                    <td align="left" valign="top" width="32%" headers="d121552e5282 d121552e4882 "><pre class="oac_no_warn" dir="ltr">OCIRaw *</pre></td>
                                    <td align="left" valign="top" width="21%" headers="d121552e5282 d121552e4885 "><pre class="oac_no_warn" dir="ltr">OCIRaw *</pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="22%" id="d121552e5295" headers="d121552e4876 "><pre class="oac_no_warn" dir="ltr">OCIDATE</pre></td>
                                    <td align="left" valign="top" width="25%" headers="d121552e5295 d121552e4879 "><pre class="oac_no_warn" dir="ltr">OCIDate *</pre></td>
                                    <td align="left" valign="top" width="32%" headers="d121552e5295 d121552e4882 "><pre class="oac_no_warn" dir="ltr">OCIDate *</pre></td>
                                    <td align="left" valign="top" width="21%" headers="d121552e5295 d121552e4885 "><pre class="oac_no_warn" dir="ltr">OCIDate *</pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="22%" id="d121552e5308" headers="d121552e4876 "><pre class="oac_no_warn" dir="ltr">OCICOLL</pre></td>
                                    <td align="left" valign="top" width="25%" headers="d121552e5308 d121552e4879 "><pre class="oac_no_warn" dir="ltr">OCIColl *或OCIArray *或OCITable *</pre></td>
                                    <td align="left" valign="top" width="32%" headers="d121552e5308 d121552e4882 "><pre class="oac_no_warn" dir="ltr">OCIColl **或OCIArray **或OCITable **</pre></td>
                                    <td align="left" valign="top" width="21%" headers="d121552e5308 d121552e4885 "><pre class="oac_no_warn" dir="ltr">OCIColl **或OCIArray **或OCITable **</pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="22%" id="d121552e5322" headers="d121552e4876 "><pre class="oac_no_warn" dir="ltr">OCITYPE</pre></td>
                                    <td align="left" valign="top" width="25%" headers="d121552e5322 d121552e4879 "><pre class="oac_no_warn" dir="ltr">OCIType *</pre></td>
                                    <td align="left" valign="top" width="32%" headers="d121552e5322 d121552e4882 "><pre class="oac_no_warn" dir="ltr">OCIType *</pre></td>
                                    <td align="left" valign="top" width="21%" headers="d121552e5322 d121552e4885 "><pre class="oac_no_warn" dir="ltr">OCIType *</pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="22%" id="d121552e5335" headers="d121552e4876 "><pre class="oac_no_warn" dir="ltr">TDO</pre></td>
                                    <td align="left" valign="top" width="25%" headers="d121552e5335 d121552e4879 "><pre class="oac_no_warn" dir="ltr">OCIType *</pre></td>
                                    <td align="left" valign="top" width="32%" headers="d121552e5335 d121552e4882 "><pre class="oac_no_warn" dir="ltr">OCIType *</pre></td>
                                    <td align="left" valign="top" width="21%" headers="d121552e5335 d121552e4885 "><pre class="oac_no_warn" dir="ltr">OCIType *</pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="22%" id="d121552e5348" headers="d121552e4876 "><pre class="oac_no_warn" dir="ltr">ADT（最终类型）</pre></td>
                                    <td align="left" valign="top" width="25%" headers="d121552e5348 d121552e4879 "><pre class="oac_no_warn" dir="ltr">dvoid *</pre></td>
                                    <td align="left" valign="top" width="32%" headers="d121552e5348 d121552e4882 "><pre class="oac_no_warn" dir="ltr">dvoid *</pre></td>
                                    <td align="left" valign="top" width="21%" headers="d121552e5348 d121552e4885 "><pre class="oac_no_warn" dir="ltr">dvoid *</pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="22%" id="d121552e5361" headers="d121552e4876 "><pre class="oac_no_warn" dir="ltr">ADT（非最终类型）</pre></td>
                                    <td align="left" valign="top" width="25%" headers="d121552e5361 d121552e4879 "><pre class="oac_no_warn" dir="ltr">dvoid *</pre></td>
                                    <td align="left" valign="top" width="32%" headers="d121552e5361 d121552e4882 "><pre class="oac_no_warn" dir="ltr">dvoid *</pre></td>
                                    <td align="left" valign="top" width="21%" headers="d121552e5361 d121552e4885 "><pre class="oac_no_warn" dir="ltr">dvoid **</pre></td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                        <p>复合数据类型不是自描述的。它们的描述存储在<strong class="term">类型描述符对象</strong> （TDO）中。对象的对象和指示符结构没有预定义的OCI数据类型，但必须使用Oracle数据库的<strong class="term">对象</strong> <strong class="term">类型</strong> <strong class="term">转换器</strong> （OTT）生成的数据类型。<code class="codeph">INDICATOR</code>的可选TDO参数，对于复合对象，通常具有C数据类型OCIType *。
                        </p>
                        <p><code class="codeph">OCICOLL</code> for <code class="codeph">REF</code>和集合参数是可选的，仅为完整性而存在。不能在地图<code class="codeph">REF</code>或集合类型到任何其他数据类型，或任何其它数据类型到<code class="codeph">REF</code>或集合类型。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADFNS728"></a><div class="props_rev_3"><a id="GUID-AAED15F3-B00A-4FD4-8AA0-567B12A67234" name="GUID-AAED15F3-B00A-4FD4-8AA0-567B12A67234"></a><h4 id="ADFNS-GUID-AAED15F3-B00A-4FD4-8AA0-567B12A67234" class="sect4">通过VALUE或BY REFERENCE传递参数</h4>
                  <div>
                     <div class="section">
                        <p>如果指定<code class="codeph">BY</code> <code class="codeph">VALUE</code> ，则标量<code class="codeph">IN</code>和<code class="codeph">RETURN</code>参数按值传递（这也是默认值）。或者，您可以通过指定<code class="codeph">BY</code> <code class="codeph">REFERENCE</code>通过引用传递它们。</p>
                        <p>默认情况下，或者如果指定<code class="codeph">BY</code> <code class="codeph">REFERENCE</code> ，则标量<code class="codeph">IN</code> <code class="codeph">OUT</code>和<code class="codeph">OUT</code>参数通过引用传递。指定<code class="codeph">BY</code> <code class="codeph">VALUE</code>为<code class="codeph">IN</code> <code class="codeph">OUT</code>和<code class="codeph">OUT</code>不支持C.参数的的实用性<code class="codeph">BY</code> <code class="codeph">REFERENCE</code> / <code class="codeph">VALUE</code>子句被限制为是外部数据类型，默认情况下，由值来传递。这适用于这些外部类型的<code class="codeph">IN</code>和<code class="codeph">RETURN</code>参数：</p><pre class="oac_no_warn" dir="ltr">[UNSIGNED] CHAR [UNSIGNED] SHORT [UNSIGNED] INT [UNSIGNED] LONG SIZE_T SB1 SB2 SB4 UB1 UB2 UB4 FLOAT DOUBLE</pre><p>不在此列表中的外部类型的所有<code class="codeph">IN</code>和<code class="codeph">RETURN</code>参数，所有<code class="codeph">IN</code> <code class="codeph">OUT</code>参数和所有<code class="codeph">OUT</code>参数都通过引用传递。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADFNS729"></a><div class="props_rev_3"><a id="GUID-E9F173EF-A940-442C-95F0-CED014259005" name="GUID-E9F173EF-A940-442C-95F0-CED014259005"></a><h4 id="ADFNS-GUID-E9F173EF-A940-442C-95F0-CED014259005" class="sect4">声明正式参数</h4>
                  <div>
                     <div class="section">
                        <p>通常，发布外部过程的PL / SQL过程会声明形式参数列表，如下例所示：</p>
                        <div class="infoboxnote" id="GUID-E9F173EF-A940-442C-95F0-CED014259005__GUID-5F303152-4E92-417F-AAB3-39395A68D195">
                           <p class="notep1">注意：</p>
                           <p>您可能需要为此主题中的示例设置此数据结构才能工作：</p><pre class="oac_no_warn" dir="ltr">CREATE LIBRARY MathLib AS'/tmp/math.so';</pre></div><pre class="oac_no_warn" dir="ltr">创建或替换函数Interp_func（ <span class="italic">/ *使用拉格朗日插值在x度处找到y的值：* /</span> x IN FLOAT，y in FLOAT）以语言C返回FLOAT名称“Interp_func”LIBRARY MathLib;</pre><p>每个形式参数声明都指定名称，参数模式和PL / SQL数据类型（映射到默认外部数据类型）。这可能是外部程序所需的所有信息。如果没有，那么您可以使用<code class="codeph">PARAMETERS</code>子句提供更多信息，该子句允许您指定：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p>非默认外部数据类型</p>
                           </li>
                           <li>
                              <p>参数的当前或最大长度</p>
                           </li>
                           <li>
                              <p>参数的<code class="codeph">NULL</code> / <code class="codeph">NOT</code> <code class="codeph">NULL</code>指示符</p>
                           </li>
                           <li>
                              <p>字符集ID和表单</p>
                           </li>
                           <li>
                              <p>列表中参数的位置</p>
                           </li>
                           <li>
                              <p>如何传递<code class="codeph">IN</code>参数（按值或按引用）</p>
                           </li>
                        </ul>
                        <p>如果您决定使用<code class="codeph">PARAMETERS</code>子句，请记住：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>对于每个形式参数， <code class="codeph">PARAMETERS</code>子句中必须有相应的<code class="codeph">PARAMETERS</code> 。
                              </p>
                           </li>
                           <li>
                              <p>如果包含<code class="codeph">WITH</code> <code class="codeph">CONTEXT</code>子句，则必须指定参数<code class="codeph">CONTEXT</code> ，该参数显示参数列表中上下文指针的位置。
                              </p>
                           </li>
                           <li>
                              <p>如果外部过程是一个函数，那么您可以指定<code class="codeph">RETURN</code>参数，但它必须位于最后一个位置。如果未指定<code class="codeph">RETURN</code> ，则使用默认外部类型。
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADFNS730"></a><div class="props_rev_3"><a id="GUID-F0D604FB-D266-4EB4-ACFE-EA24FE5ACF26" name="GUID-F0D604FB-D266-4EB4-ACFE-EA24FE5ACF26"></a><h4 id="ADFNS-GUID-F0D604FB-D266-4EB4-ACFE-EA24FE5ACF26" class="sect4">覆盖默认数据类型映射</h4>
                  <div>
                     <div class="section">
                        <p>在某些情况下，您可以使用<code class="codeph">PARAMETERS</code>子句覆盖默认数据类型映射。例如，您可以将PL / SQL数据类型<code class="codeph">BOOLEAN</code>从外部数据类型<code class="codeph">INT</code>重新映射到外部数据类型<code class="codeph">CHAR</code> 。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADFNS732"></a><a id="ADFNS1093"></a><a id="ADFNS731"></a><div class="props_rev_3"><a id="GUID-5689A420-BDEF-46B1-90FB-9003DE792A6E" name="GUID-5689A420-BDEF-46B1-90FB-9003DE792A6E"></a><h4 id="ADFNS-GUID-5689A420-BDEF-46B1-90FB-9003DE792A6E" class="sect4">指定属性</h4>
                  <div>
                     <div class="section">
                        <p>您还可以使用<code class="codeph">PARAMETERS</code>子句将有关PL / SQL形式参数和函数结果的更多信息传递给外部过程。通过指定以下一个或多个属性来执行此操作：</p><pre class="oac_no_warn" dir="ltr">指标[{STRUCT | TDO}] <code class="codeph">LENGTH</code>持续时间<code class="codeph">MAXLEN</code> <code class="codeph">CHARSETID</code> <code class="codeph">CHARSETFORM</code> SELF</pre><p><a href="external-procedures.html#GUID-5689A420-BDEF-46B1-90FB-9003DE792A6E__g1025084" title="此表总结了PL / SQL数据类型的属性。">表21-3</a>显示了给定属性允许的默认外部数据类型，PL / SQL数据类型和PL / SQL参数模式。<code class="codeph">MAXLEN</code> （用于指定从C返回到PL / SQL的数据）不能应用于<code class="codeph">IN</code>参数。
                        </p>
                        <div class="tblformalwide" id="GUID-5689A420-BDEF-46B1-90FB-9003DE792A6E__g1025084">
                           <p class="titleintable">表21-3属性和数据类型</p>
                           <table cellpadding="4" cellspacing="0" class="FormalWide" title="属性和数据类型" width="100%" border="1" summary="This table summarizes the properties of the PL/SQL datatypes." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="13%" id="d121552e6020">属性</th>
                                    <th align="left" valign="bottom" width="18%" id="d121552e6023">允许的外部类型（C）</th>
                                    <th align="left" valign="bottom" width="17%" id="d121552e6026">默认外部类型（C）</th>
                                    <th align="left" valign="bottom" width="16%" id="d121552e6029">允许的PL / SQL类型</th>
                                    <th align="left" valign="bottom" width="16%" id="d121552e6032">允许的PL / SQL模式</th>
                                    <th align="left" valign="bottom" width="21%" id="d121552e6035">默认的PL / SQL传递方法</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="13%" id="d121552e6040" headers="d121552e6020 "><pre class="oac_no_warn" dir="ltr">指示符</pre></td>
                                    <td align="left" valign="top" width="18%" headers="d121552e6040 d121552e6023 "><pre class="oac_no_warn" dir="ltr">短</pre></td>
                                    <td align="left" valign="top" width="17%" headers="d121552e6040 d121552e6026 "><pre class="oac_no_warn" dir="ltr">短</pre></td>
                                    <td align="left" valign="top" width="16%" headers="d121552e6040 d121552e6029 "><pre class="oac_no_warn" dir="ltr">所有标量</pre></td>
                                    <td align="left" valign="top" width="16%" headers="d121552e6040 d121552e6032 "><pre class="oac_no_warn" dir="ltr">在OUT OUT OUTURN</pre></td>
                                    <td align="left" valign="top" width="21%" headers="d121552e6040 d121552e6035 "><pre class="oac_no_warn" dir="ltr">以引用方式引用的参考文献</pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="13%" id="d121552e6059" headers="d121552e6020 "><pre class="oac_no_warn" dir="ltr">长度</pre></td>
                                    <td align="left" valign="top" width="18%" headers="d121552e6059 d121552e6023 "><pre class="oac_no_warn" dir="ltr">[未签名]简短[未签名] INT [未签名]长</pre></td>
                                    <td align="left" valign="top" width="17%" headers="d121552e6059 d121552e6026 "><pre class="oac_no_warn" dir="ltr">INT</pre></td>
                                    <td align="left" valign="top" width="16%" headers="d121552e6059 d121552e6029 "><pre class="oac_no_warn" dir="ltr">CHAR LONG RAW RAW VARCHAR2</pre></td>
                                    <td align="left" valign="top" width="16%" headers="d121552e6059 d121552e6032 "><pre class="oac_no_warn" dir="ltr">在OUT OUT OUTURN</pre></td>
                                    <td align="left" valign="top" width="21%" headers="d121552e6059 d121552e6035 "><pre class="oac_no_warn" dir="ltr">以引用方式引用的参考文献</pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="13%" id="d121552e6078" headers="d121552e6020 "><pre class="oac_no_warn" dir="ltr">MAXLEN</pre></td>
                                    <td align="left" valign="top" width="18%" headers="d121552e6078 d121552e6023 "><pre class="oac_no_warn" dir="ltr">[未签名]简短[未签名] INT [未签名]长</pre></td>
                                    <td align="left" valign="top" width="17%" headers="d121552e6078 d121552e6026 "><pre class="oac_no_warn" dir="ltr">INT</pre></td>
                                    <td align="left" valign="top" width="16%" headers="d121552e6078 d121552e6029 "><pre class="oac_no_warn" dir="ltr">CHAR LONG RAW RAW VARCHAR2</pre></td>
                                    <td align="left" valign="top" width="16%" headers="d121552e6078 d121552e6032 "><pre class="oac_no_warn" dir="ltr">在OUT OUT OUT返回</pre></td>
                                    <td align="left" valign="top" width="21%" headers="d121552e6078 d121552e6035 "><pre class="oac_no_warn" dir="ltr">以引用方式引用作为参考</pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="13%" id="d121552e6097" headers="d121552e6020 "><pre class="oac_no_warn" dir="ltr">CHARSETID CHARSETFORM</pre></td>
                                    <td align="left" valign="top" width="18%" headers="d121552e6097 d121552e6023 "><pre class="oac_no_warn" dir="ltr">未签名的短期未签署的未签署的</pre></td>
                                    <td align="left" valign="top" width="17%" headers="d121552e6097 d121552e6026 "><pre class="oac_no_warn" dir="ltr">UNSIGNED INT</pre></td>
                                    <td align="left" valign="top" width="16%" headers="d121552e6097 d121552e6029 "><pre class="oac_no_warn" dir="ltr">CHAR CLOB VARCHAR2</pre></td>
                                    <td align="left" valign="top" width="16%" headers="d121552e6097 d121552e6032 "><pre class="oac_no_warn" dir="ltr">在OUT OUT OUTURN</pre></td>
                                    <td align="left" valign="top" width="21%" headers="d121552e6097 d121552e6035 "><pre class="oac_no_warn" dir="ltr">以引用方式引用的参考文献</pre></td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                        <p>在此示例中， <code class="codeph">PARAMETERS</code>子句指定PL / SQL形式参数和函数结果的属性：</p><pre class="oac_no_warn" dir="ltr">创建或替换函数plsToCparse_func（x IN PLS_INTEGER，Y IN OUT CHAR）返回CHAR作为语言C库c_utils名称“C_parse”PARAMETERS（x， - 存储xx INDICATOR的值， - 存储xy的空状态， - 存储值yy LENGTH， - 存储yy MAXLEN的当前长度， - 存储y RETURN INDICATOR，RETURN的最大长度;</pre><p>使用此<code class="codeph">PARAMETERS</code>子句，C原型变为：</p><pre class="oac_no_warn" dir="ltr">char * C_parse（int x，short x_ind，char * y，int * y_len，int * y_maxlen，short * retind）;</pre><p>C原型中的附加参数对应于<code class="codeph">INDICATOR</code> （对于<code class="codeph">x</code> ）， <code class="codeph">LENGTH</code> （对于<code class="codeph">y</code> ）和<code class="codeph">MAXLEN</code> （对于<code class="codeph">y</code> ），并且函数的<code class="codeph">INDICATOR</code>对应于<code class="codeph">PARAMETERS</code>子句。参数<code class="codeph">RETURN</code>对应于C函数标识符，它存储结果值。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-5689A420-BDEF-46B1-90FB-9003DE792A6E__GUID-3FDD04DE-132A-4D06-B419-C536D6465D97">话题：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="external-procedures.html#GUID-4EA97657-C287-4840-9E3B-010D0A45C903">指示符</a></p>
                           </li>
                           <li>
                              <p><a href="external-procedures.html#GUID-207ADB86-FB6F-44E6-8920-3FD3BD6FC261">LENGTH和MAXLEN</a></p>
                           </li>
                           <li>
                              <p><a href="external-procedures.html#GUID-155FC173-B216-486E-9126-3F9064ACA785">CHARSETID和CHARSETFORM</a></p>
                           </li>
                           <li>
                              <p><a href="external-procedures.html#GUID-580D15BC-3A1F-4B87-AE45-3D9B04D9F212">重新定位参数</a></p>
                           </li>
                           <li>
                              <p><a href="external-procedures.html#GUID-D3A93BDB-AD4F-4843-99D3-A5459BA29B81">自</a></p>
                           </li>
                           <li>
                              <p><a href="external-procedures.html#GUID-D7472464-DCB9-4305-A5BE-2D4A9C963D15">引用</a></p>
                           </li>
                           <li>
                              <p><a href="external-procedures.html#GUID-380DBDEB-5FB9-43E4-B8EE-11A11DEB22C6">WITH CONTEXT</a></p>
                           </li>
                           <li>
                              <p><a href="external-procedures.html#GUID-106AB76F-0CBF-4DD9-B2B4-DE6E4A1F3C91">中介语参数模式映射</a></p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div><a id="ADFNS733"></a><div class="props_rev_3"><a id="GUID-4EA97657-C287-4840-9E3B-010D0A45C903" name="GUID-4EA97657-C287-4840-9E3B-010D0A45C903"></a><h5 id="ADFNS-GUID-4EA97657-C287-4840-9E3B-010D0A45C903" class="sect5">指示符</h5>
                     <div>
                        <p><code class="codeph">INDICATOR</code>是一个参数，其值指示另一个参数是否为<code class="codeph">NULL</code> 。 PL / SQL不需要指标，因为RDBMS的无效概念是内置于语言中的。但是，外部过程可能需要确定参数或函数结果是否为<code class="codeph">NULL</code> 。此外，外部过程可能需要向服务器发出返回值为<code class="codeph">NULL</code> ，并且必须相应地进行处理。
                        </p>
                        <p>在这种情况下，您可以使用属性<code class="codeph">INDICATOR</code>将指标与形式参数相关联。如果PL / SQL过程是一个函数，那么您还可以将指示符与函数结果相关联，如“ <a href="external-procedures.html#GUID-5689A420-BDEF-46B1-90FB-9003DE792A6E">指定属性”中</a>所示。
                        </p>
                        <p>要检查指标的值，可以使用常量<code class="codeph">OCI_IND_NULL</code>和<code class="codeph">OCI_IND_NOTNULL</code> 。如果指示符等于<code class="codeph">OCI_IND_NULL</code> ，则关联的参数或函数结果为<code class="codeph">NULL</code> 。如果指标等于<code class="codeph">OCI_IND_NOTNULL</code> ，则参数或函数结果不为<code class="codeph">NULL</code> 。</p>
                        <p>对于本质上只读的<code class="codeph">IN</code>参数， <code class="codeph">INDICATOR</code>按值传递（除非您指定<code class="codeph">BY</code> <code class="codeph">REFERENCE</code> ）并且是只读的（即使您指定了<code class="codeph">BY</code> <code class="codeph">REFERENCE</code> ）。对于<code class="codeph">OUT</code> ， <code class="codeph">IN</code> <code class="codeph">OUT</code>和<code class="codeph">RETURN</code>参数，默认情况下， <code class="codeph">INDICATOR</code>通过引用传递。
                        </p>
                        <p><code class="codeph">INDICATOR</code>也可以有<code class="codeph">STRUCT</code>或TDO选项。因为不支持将<code class="codeph">INDICATOR</code>指定为对象的属性，并且因为对象的参数具有完整的指示符结构而不是<code class="codeph">INDICATOR</code>标量，所以必须使用<code class="codeph">STRUCT</code>选项指定它。必须对复合对象和集合使用类型描述符对象（TDO）选项，</p>
                     </div>
                  </div><a id="ADFNS734"></a><div class="props_rev_3"><a id="GUID-207ADB86-FB6F-44E6-8920-3FD3BD6FC261" name="GUID-207ADB86-FB6F-44E6-8920-3FD3BD6FC261"></a><h5 id="ADFNS-GUID-207ADB86-FB6F-44E6-8920-3FD3BD6FC261" class="sect5">LENGTH和MAXLEN</h5>
                     <div>
                        <p>在PL / SQL中，没有标准方法来指示<code class="codeph">RAW</code>或字符串参数的长度。但是，您可能希望将此类参数的长度传入和传出外部过程。使用属性<code class="codeph">LENGTH</code>和<code class="codeph">MAXLEN</code> ，可以指定存储形式参数的当前长度和最大长度的参数。
                        </p>
                        <div class="infoboxnote" id="GUID-207ADB86-FB6F-44E6-8920-3FD3BD6FC261__GUID-10053271-14AB-4275-B1E5-8E4C465F8B7A">
                           <p class="notep1">注意：</p>
                           <p>使用<code class="codeph">RAW</code>或<code class="codeph">LONG</code> <code class="codeph">RAW</code>类型的参数时，必须使用属性<code class="codeph">LENGTH</code> 。此外，如果该参数为<code class="codeph">IN</code> <code class="codeph">OUT</code>且<code class="codeph">NULL</code>或<code class="codeph">OUT</code>和<code class="codeph">NULL</code> ，则必须将相应C参数的长度设置为零。
                           </p>
                        </div>
                        <p>对于<code class="codeph">IN</code>参数， <code class="codeph">LENGTH</code>按值传递（除非您指定<code class="codeph">BY</code> <code class="codeph">REFERENCE</code> ）并且是只读的。对于<code class="codeph">OUT</code> ， <code class="codeph">IN</code> <code class="codeph">OUT</code>和<code class="codeph">RETURN</code>参数， <code class="codeph">LENGTH</code>通过引用传递。
                        </p>
                        <p><code class="codeph">MAXLEN</code>不适用于<code class="codeph">IN</code>参数。对于<code class="codeph">OUT</code> ， <code class="codeph">IN</code> <code class="codeph">OUT</code>和<code class="codeph">RETURN</code>参数， <code class="codeph">MAXLEN</code>通过引用传递并且是只读的。
                        </p>
                     </div>
                  </div><a id="ADFNS735"></a><div class="props_rev_3"><a id="GUID-155FC173-B216-486E-9126-3F9064ACA785" name="GUID-155FC173-B216-486E-9126-3F9064ACA785"></a><h5 id="ADFNS-GUID-155FC173-B216-486E-9126-3F9064ACA785" class="sect5">CHARSETID和CHARSETFORM</h5>
                     <div>
                        <p>Oracle数据库提供了全球化支持，使您可以处理单字节和多字节字符数据并在字符集之间进行转换。它还允许您的应用程序在不同的语言环境中运行。</p>
                        <p>默认情况下，如果服务器和代理使用完全相同的<code class="codeph">$ORACLE_HOME</code>值，则代理使用与服务器相同的全球化支持设置（包括使用<code class="codeph">ALTER</code> <code class="codeph">SESSION</code>语句指定的任何设置）。
                        </p>
                        <p>如果代理程序在单独的<code class="codeph">$ORACLE_HOME</code>运行（即使两个不同的别名或符号链接指定了相同的位置），代理程序将使用与服务器相同的全球化支持设置，但字符集除外;代理的默认字符集由代理的<code class="codeph">NLS_LANG</code>和<code class="codeph">NLS_NCHAR</code>环境设置定义。
                        </p>
                        <p><code class="codeph">CHARSETID</code>和<code class="codeph">CHARSETFORM</code>属性标识非默认字符集，从中创建了传递的字符数据。使用<code class="codeph">CHAR</code> ， <code class="codeph">CLOB</code>和<code class="codeph">VARCHAR2</code>参数，可以使用<code class="codeph">CHARSETID</code>和<code class="codeph">CHARSETFORM</code>将字符集ID和表单传递给外部过程。
                        </p>
                        <p>对于<code class="codeph">IN</code>参数， <code class="codeph">CHARSETID</code>和<code class="codeph">CHARSETFORM</code>按值传递（除非您指定<code class="codeph">BY</code> <code class="codeph">REFERENCE</code> ）并且是只读的（即使您指定了<code class="codeph">BY</code> <code class="codeph">REFERENCE</code> ）。对于<code class="codeph">OUT</code> ， <code class="codeph">IN</code> <code class="codeph">OUT</code>和<code class="codeph">RETURN</code>参数， <code class="codeph">CHARSETID</code>和<code class="codeph">CHARSETFORM</code>通过引用传递并且是只读的。
                        </p>
                        <p>这些属性的OCI属性名称是<code class="codeph">OCI_ATTR_CHARSET_ID</code>和<code class="codeph">OCI_ATTR_CHARSET_FORM</code> 。</p>
                        <div class="infoboxnotealso" id="GUID-155FC173-B216-486E-9126-3F9064ACA785__GUID-B0465005-EFFC-4831-B631-04F3C0968FD8">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>有关<code class="codeph">OCI_ATTR_CHARSET_ID</code>和<code class="codeph">OCI_ATTR_CHARSET_FORM</code>详细信息，请<code class="codeph">OCI_ATTR_CHARSET_ID</code> <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNOCI050" target="_blank"><span class="italic">Oracle调用接口程序员指南</span></a></p>
                              </li>
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=NLSPG465" target="_blank"><span class="italic">“Oracle数据库全球化支持指南”</span></a> ，了解有关在OCI中使用国家语言数据的更多信息</p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div><a id="ADFNS736"></a><div class="props_rev_3"><a id="GUID-580D15BC-3A1F-4B87-AE45-3D9B04D9F212" name="GUID-580D15BC-3A1F-4B87-AE45-3D9B04D9F212"></a><h5 id="ADFNS-GUID-580D15BC-3A1F-4B87-AE45-3D9B04D9F212" class="sect5">重新定位参数</h5>
                     <div>
                        <div class="section">
                           <p>请记住，外部过程的每个形式参数必须在<code class="codeph">PARAMETERS</code>子句中具有相应的<code class="codeph">PARAMETERS</code> 。它们的位置可能不同，因为PL / SQL通过名称而不是位置来关联它们。但是， <code class="codeph">PARAMETERS</code>子句和外部过程的C原型必须具有相同数量的参数，并且它们必须具有相同的顺序。
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="ADFNS737"></a><div class="props_rev_3"><a id="GUID-D3A93BDB-AD4F-4843-99D3-A5459BA29B81" name="GUID-D3A93BDB-AD4F-4843-99D3-A5459BA29B81"></a><h5 id="ADFNS-GUID-D3A93BDB-AD4F-4843-99D3-A5459BA29B81" class="sect5">自</h5>
                     <div>
                        <div class="section">
                           <p><code class="codeph">SELF</code>是对象类型的成员过程的始终存在的参数，即对象实例本身。在大多数情况下，此参数是隐式的，并未在PL / SQL过程的参数列表中列出。但是，必须将<code class="codeph">SELF</code>显式指定为<code class="codeph">PARAMETERS</code>子句的<code class="codeph">PARAMETERS</code> 。
                           </p>
                           <p>例如，假设您要创建一个<code class="codeph">Person</code>对象，该对象由一个人的姓名和出生日期组成，然后创建一个此对象类型的表。您最终想要确定此表中每个<code class="codeph">Person</code>对象的年龄。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>在SQL * Plus中， <code class="codeph">Person</code>对象类型可以通过以下方式创建：</span><div><pre class="oac_no_warn" dir="ltr">创建或替换类型Person1_typ AS OBJECT（Name_ VARCHAR2（30），B_date DATE，成员函数calcAge_func返回数字）; /</pre></div>
                           </li>
                           <li class="stepexpand"><span>声明成员函数的主体如下：</span><div><pre class="oac_no_warn" dir="ltr">创建或替换类型体Person1_typ作为成员函数calcAge_func返回数字作为语言C名称“年龄”LIBRARY agelib与上下文参数（上下文，自我，自我指示结构，自我TDO，返回指示符）;结束; /</pre><p>（通常，成员函数在PL / SQL中实现，但在此示例中，它是一个外部过程。）</p>
                                 <p><code class="codeph">calcAge_func</code>成员函数不带参数并返回一个数字。始终在关联对象类型的实例上调用成员函数。对象实例本身始终是成员函数的隐式参数。要引用隐式参数，请使用<code class="codeph">SELF</code>关键字。通过在parameters子句中支持对<code class="codeph">SELF</code>引用，将其合并到外部过程语法中。
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>创建并填充匹配表。</span><div><pre class="oac_no_warn" dir="ltr">创建表Person_tab OF Person1_typ; INSERT INTO Person_tab VALUES（'BOB'，TO_DATE（'14 -MAY-85'））; INSERT INTO Person_tab VALUES（'JOHN'，TO_DATE（'22 -DEC-71'））;</pre></div>
                           </li>
                           <li class="stepexpand"><span>从表中检索感兴趣的信息。</span><div><pre class="oac_no_warn" dir="ltr">SELECT p.name，p.b_date，p.calcAge_func（）FROM Person_tab p;姓名B_DATE P.CALCAGE_ ------------------------------ --------- ------ ---- BOB 14-MAY-85 0 JOHN 22-DEC-71 0</pre></div>
                           </li>
                        </ol>
                        <div class="section">
                           <p>这是实现<code class="codeph">external</code>成员函数和Object-Type-Translator（OTT）生成的<code class="codeph">struct</code>定义的示例C代码：</p><pre class="oac_no_warn" dir="ltr">#include &lt;oci.h&gt; struct PERSON {OCIString * NAME; OCIDate B_DATE; }; typedef struct PERSON PERSON; struct PERSON_ind {OCIInd _atomic; OCIInd NAME; OCIInd B_DATE; }; typedef struct PERSON_ind PERSON_ind; OCINumber * age（ctx，person_obj，person_obj_ind，tdo，ret_ind）OCIExtProcContext * ctx; PERSON * person_obj; PERSON_ind * person_obj_ind; OCIType * tdo; OCIInd * ret_ind; {剑错; text errbuf [512]; OCIEnv * envh; OCISvcCtx * svch; OCIError * errh; OCINumber *年龄; int inum = 0;剑的地位; <span class="italic">/ *获取OCI环境* /</span> err = OCIExtProcGetEnv（ctx，＆envh，＆svch，＆errh）; <span class="italic">/ *初始化返回年龄为0 * /</span>年龄=（OCINumber *）OCIExtProcAllocCallMemory（ctx，sizeof（OCINumber））; status = OCINumberFromInt（errh，＆inum，sizeof（inum），OCI_NUMBER_SIGNED，年龄）;如果（状态！= OCI_SUCCESS）{OCIExtProcRaiseExcp（ctx，（int）1476）;回归（年龄）; <span class="italic">如果person对象为null或者birthdate为null，则返回NULL * /</span> if（person_obj_ind  - &gt; _ atomic == OCI_IND_NULL || person_obj_ind-&gt; B_DATE == OCI_IND_NULL）{* ret_ind = OCI_IND_NULL;回归（年龄）; <span class="italic">/ *计算年龄的实际实现留给读者，</span> <span class="italic">但这样做的一个简单方法是对表单进行回调：</span> <span class="italic">从DUAL中</span> <span class="italic">选择trunc（months_between（sysdate，person_obj-&gt; b_date）/ 12）</span> <span class="italic">;</span> <span class="italic">* /</span> * ret_ind = OCI_IND_NOTNULL;回归（年龄）; }</pre></div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="ADFNS738"></a><div class="props_rev_3"><a id="GUID-D7472464-DCB9-4305-A5BE-2D4A9C963D15" name="GUID-D7472464-DCB9-4305-A5BE-2D4A9C963D15"></a><h5 id="ADFNS-GUID-D7472464-DCB9-4305-A5BE-2D4A9C963D15" class="sect5">引用</h5>
                     <div>
                        <div class="section">
                           <p>在C中，您可以按值传递<code class="codeph">IN</code>标量参数（传递参数的值）或通过引用传递（传递值的指针）。当外部过程需要指向标量的指针时，请指定<code class="codeph">BY</code> <code class="codeph">REFERENCE</code>短语以通过引用传递参数：</p><pre class="oac_no_warn" dir="ltr">创建或替换过程findRoot_proc（x双精度）作为语言C库c_utils名称“C_findRoot”参数（x参考）;</pre><p>在这种情况下，C原型是：</p><pre class="oac_no_warn" dir="ltr">void C_findRoot（double * x）;</pre><p>默认值（在没有<code class="codeph">PARAMETERS</code>子句时使用）是：</p><pre class="oac_no_warn" dir="ltr">void C_findRoot（double x）;</pre></div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="ADFNS739"></a><div class="props_rev_3"><a id="GUID-22EB523E-2E94-4674-A560-8D0DB46A060A" name="GUID-22EB523E-2E94-4674-A560-8D0DB46A060A"></a><h5 id="ADFNS-GUID-22EB523E-2E94-4674-A560-8D0DB46A060A" class="sect5">WITH CONTEXT</h5>
                     <div>
                        <div class="section">
                           <p>通过包含<code class="codeph">WITH</code> <code class="codeph">CONTEXT</code>子句，您可以为外部过程提供有关参数，异常，内存分配和用户环境的信息的访问权限。<code class="codeph">WITH</code> <code class="codeph">CONTEXT</code>子句指定将上下文指针传递给外部过程。例如，如果您编写此PL / SQL函数：</p><pre class="oac_no_warn" dir="ltr">创建或替换函数getNum_func（x IN REAL）将PLS_INTEGER作为语言C库返回c_utils带有上下文参数的名称“C_getNum”（上下文，x参考，返回指示符）;</pre><p>C原型是：</p><pre class="oac_no_warn" dir="ltr">int C_getNum（OCIExtProcContext * with_context，float * x，short * retind）;</pre><p>上下文数据结构对外部过程是不透明的;但是，可用于外部过程调用的服务过程。</p>
                           <p>如果还包括<code class="codeph">PARAMETERS</code>子句，则必须指定参数<code class="codeph">CONTEXT</code> ，该参数显示上下文指针在参数列表中的位置。如果省略<code class="codeph">PARAMETERS</code>子句，则上下文指针是传递给外部过程的第一个参数。
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="ADFNS740"></a><div class="props_rev_3"><a id="GUID-106AB76F-0CBF-4DD9-B2B4-DE6E4A1F3C91" name="GUID-106AB76F-0CBF-4DD9-B2B4-DE6E4A1F3C91"></a><h5 id="ADFNS-GUID-106AB76F-0CBF-4DD9-B2B4-DE6E4A1F3C91" class="sect5">中介语参数模式映射</h5>
                     <div>
                        <p>PL / SQL支持<code class="codeph">IN</code> ， <code class="codeph">IN</code> <code class="codeph">OUT</code>和<code class="codeph">OUT</code>参数模式，以及返回值的过程的<code class="codeph">RETURN</code>子句。
                        </p>
                     </div>
                  </div>
               </div>
            </div><a id="ADFNS741"></a><a id="ADFNS1094"></a><a id="ADFNS1410"></a><div class="props_rev_3"><a id="GUID-25A8F1CE-2464-47FD-805A-2FE08996AF63" name="GUID-25A8F1CE-2464-47FD-805A-2FE08996AF63"></a><h3 id="ADFNS-GUID-25A8F1CE-2464-47FD-805A-2FE08996AF63" class="sect3">使用CALL语句运行外部过程</h3>
               <div>
                  <div class="section">
                     <p>既然您已经发布了Java类方法或外部C过程，那么您就可以调用它了。</p>
                     <p>不要直接调用外部程序。而是使用<code class="codeph">CALL</code>语句来调用发布外部过程的PL / SQL过程。
                     </p>
                     <p>此类调用的编码方式与调用常规PL / SQL过程的方式相同，可以显示在：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type:disc">
                        <li>
                           <p>匿名块</p>
                        </li>
                        <li>
                           <p>独立和包装程序</p>
                        </li>
                        <li>
                           <p>对象类型的方法</p>
                        </li>
                        <li>
                           <p>数据库触发器</p>
                        </li>
                        <li>
                           <p>SQL语句（仅调用包函数）。</p>
                        </li>
                     </ul>
                     <p>在服务器端或客户端运行的任何PL / SQL块或过程（例如，在Oracle Forms等工具中）都可以调用外部过程。在服务器端，外部过程在单独的进程地址空间中运行，从而保护您的数据库。<a href="external-procedures.html#GUID-25A8F1CE-2464-47FD-805A-2FE08996AF63__I1007591">图21-1</a>显示了Oracle数据库和外部过程如何交互。
                     </p>
                     <div class="figure" id="GUID-25A8F1CE-2464-47FD-805A-2FE08996AF63__I1007591">
                        <p class="titleinfigure">图21-1 Oracle数据库和外部过程</p><img src="img/adfns063.gif" width="452" alt="下面是图21-1的描述" title="下面是图21-1的描述" longdesc="img_text/adfns063.html"><br><a href="img_text/adfns063.html">“图21-1 Oracle数据库和外部过程”的说明</a></div>
                     <!-- class="figure" -->
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-25A8F1CE-2464-47FD-805A-2FE08996AF63__GUID-130C1436-899D-4068-8DB4-4F23ACCA68CE">话题：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="external-procedures.html#GUID-9151266B-312D-4920-AC78-7E2963DCF117">外部程序的先决条件</a></p>
                        </li>
                        <li>
                           <p><a href="external-procedures.html#GUID-DC718BF7-49A2-41FC-9431-4222C9E35849">CALL语句语法</a></p>
                        </li>
                        <li>
                           <p><a href="external-procedures.html#GUID-500C7401-B6B7-4465-8C13-88720167275D">调用Java类方法</a></p>
                        </li>
                        <li>
                           <p><a href="external-procedures.html#GUID-D5F492F9-624A-481C-84B3-9B1E24EFAB0C">调用外部C程序</a></p>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-25A8F1CE-2464-47FD-805A-2FE08996AF63__NOTE-1342-CB041D0D">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="external-procedures.html#GUID-DC718BF7-49A2-41FC-9431-4222C9E35849">CALL语句语法</a></p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div><a id="ADFNS1095"></a><a id="ADFNS742"></a><div class="props_rev_3"><a id="GUID-9151266B-312D-4920-AC78-7E2963DCF117" name="GUID-9151266B-312D-4920-AC78-7E2963DCF117"></a><h4 id="ADFNS-GUID-9151266B-312D-4920-AC78-7E2963DCF117" class="sect4">外部程序的先决条件</h4>
                  <div>
                     <p>在调用外部过程之前，请考虑执行环境中存在的特权，权限和同义词。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-9151266B-312D-4920-AC78-7E2963DCF117__GUID-11B5B971-E77C-4A87-966D-16D40DABE579">话题：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="external-procedures.html#GUID-885B57AC-AE81-4D3E-B2ED-5EE5DA034121">外部程序的特权</a></p>
                           </li>
                           <li>
                              <p><a href="external-procedures.html#GUID-C571C888-052E-4086-84C9-E66D26040C30">管理权限</a></p>
                           </li>
                           <li>
                              <p><a href="external-procedures.html#GUID-C473C588-E6DD-4CC4-B174-A920E28F7702">为外部程序创建同义词</a></p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div><a id="ADFNS743"></a><div class="props_rev_3"><a id="GUID-885B57AC-AE81-4D3E-B2ED-5EE5DA034121" name="GUID-885B57AC-AE81-4D3E-B2ED-5EE5DA034121"></a><h5 id="ADFNS-GUID-885B57AC-AE81-4D3E-B2ED-5EE5DA034121" class="sect5">外部程序的特权</h5>
                     <div>
                        <p>当通过<code class="codeph">CALL</code>规范调用外部过程时，它们以定义者的权限运行，而不是使用调用者权限。
                        </p>
                        <p>使用调用者权限运行的程序不绑定到特定模式。它在调用站点运行，并使用调用者的可见性和权限访问数据库项（例如表和视图）。但是，使用定义者权限运行的程序将绑定到定义它的模式。它在定义的站点上运行，在definer的模式中运行，并使用定义者的可见性和权限访问数据库项。</p>
                     </div>
                  </div><a id="ADFNS744"></a><div class="props_rev_3"><a id="GUID-C571C888-052E-4086-84C9-E66D26040C30" name="GUID-C571C888-052E-4086-84C9-E66D26040C30"></a><h5 id="ADFNS-GUID-C571C888-052E-4086-84C9-E66D26040C30" class="sect5">管理权限</h5>
                     <div>
                        <div class="section">
                           <p>要调用外部过程，用户必须具有其调用规范的<code class="codeph">EXECUTE</code>特权。要授予此权限，请使用<code class="codeph">GRANT</code>语句。例如，此语句允许用户johndoe调用其调用规范为<code class="codeph">plsToJ_demoExternal_proc</code>的外部过程：</p><pre class="oac_no_warn" dir="ltr">GRANT EXECUTE ON plsToJ_demoExternal_proc TO johndoe;</pre><p>仅将呼叫规范的<code class="codeph">EXECUTE</code>特权授予必须调用该过程的用户。
                           </p>
                           <div class="infoboxnotealso" id="GUID-C571C888-052E-4086-84C9-E66D26040C30__NOTE-1214-CB0465CB">
                              <p class="notep1">也可以看看：</p>
                              <p>有关<code class="codeph">GRANT</code>语句的更多信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=SQLRF01603" target="_blank"><span class="italic">参见Oracle数据库SQL语言参考</span></a></p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="ADFNS745"></a><div class="props_rev_3"><a id="GUID-C473C588-E6DD-4CC4-B174-A920E28F7702" name="GUID-C473C588-E6DD-4CC4-B174-A920E28F7702"></a><h5 id="ADFNS-GUID-C473C588-E6DD-4CC4-B174-A920E28F7702" class="sect5">为外部程序创建同义词</h5>
                     <div>
                        <div class="section">
                           <p>为方便起见，您或您的DBA可以使用<code class="codeph">CREATE</code> <code class="codeph">PUBLIC</code> <code class="codeph">SYNONYM</code>语句为外部过程<code class="codeph">CREATE</code> <code class="codeph">SYNONYM</code> 。在此示例中，您的DBA创建了一个公共同义词，所有用户都可以访问该同义词。如果未指定<code class="codeph">PUBLIC</code> ，则同义词是私有的，只能在其架构中访问。
                           </p><pre class="oac_no_warn" dir="ltr">为johndoe创建公共SYNONYM Rfac。RecursiveFactorial;</pre></div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div><a id="ADFNS746"></a><div class="props_rev_3"><a id="GUID-DC718BF7-49A2-41FC-9431-4222C9E35849" name="GUID-DC718BF7-49A2-41FC-9431-4222C9E35849"></a><h4 id="ADFNS-GUID-DC718BF7-49A2-41FC-9431-4222C9E35849" class="sect4">CALL语句语法</h4>
                  <div>
                     <div class="section">
                        <p>通过SQL <code class="codeph">CALL</code>语句调用外部过程。您可以从SQL * Plus以交互方式运行<code class="codeph">CALL</code>语句。语法是：</p><pre class="oac_no_warn" dir="ltr">CALL [schema。] [{object_type_name | package_name}] procedure_name [@dblink_name] [（parameter_list）] [INTO：host_variable] [INDICATOR] [：indicator_variable];</pre><p>这相当于使用“ <code class="codeph">SELECT</code> <code class="codeph">myproc(</code> ... <code class="codeph">)</code> ”形式的SQL语句运行过程<code class="codeph">myproc</code> <code class="codeph">FROM</code> <code class="codeph">DUAL</code> ，“除了不会产生与执行<code class="codeph">SELECT</code>相关的开销。
                        </p>
                        <p>例如，这是一个匿名PL / SQL块，它使用动态SQL来调用您发布的<code class="codeph">plsToC_demoExternal_proc</code> 。PL / SQL将三个参数传递给外部C过程<code class="codeph">C_demoExternal_proc</code> 。
                        </p><pre class="oac_no_warn" dir="ltr">DECLARE xx NUMBER（4）; yy VARCHAR2（10）; zz DATE; BEGIN EXECUTE IMMEDIATE'CALL plsToC_demoExternal_proc（：xxx，：yyy，：zzz）'使用xx，yy，zz;结束;</pre><p><code class="codeph">CALL</code>语句的语义与等效的<code class="codeph">BEGIN</code> <code class="codeph">END</code>块的语义相同。
                        </p>
                        <div class="infoboxnote" id="GUID-DC718BF7-49A2-41FC-9431-4222C9E35849__GUID-9D2EFCF1-657C-4019-80ED-7BAE28FD4238">
                           <p class="notep1">注意：</p>
                           <p><code class="codeph">CALL</code>是唯一不能在PL / SQL <code class="codeph">BEGIN</code> <code class="codeph">END</code>块中放置的SQL语句。它可以是<code class="codeph">BEGIN</code> <code class="codeph">END</code>块中<code class="codeph">EXECUTE</code> <code class="codeph">IMMEDIATE</code>语句的一部分。
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADFNS747"></a><div class="props_rev_3"><a id="GUID-500C7401-B6B7-4465-8C13-88720167275D" name="GUID-500C7401-B6B7-4465-8C13-88720167275D"></a><h4 id="ADFNS-GUID-500C7401-B6B7-4465-8C13-88720167275D" class="sect4">调用Java类方法</h4>
                  <div>
                     <div class="section">
                        <p>要调用在<a href="external-procedures.html#GUID-BC6C93E6-8EE0-47F0-A713-D29AE4942B77">发布Java类方法</a>中<a href="external-procedures.html#GUID-BC6C93E6-8EE0-47F0-A713-D29AE4942B77">发布</a>的<code class="codeph">J_calcFactorial</code>类<a href="external-procedures.html#GUID-BC6C93E6-8EE0-47F0-A713-D29AE4942B77">方法</a> ：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>声明并初始化两个SQL * Plus主机变量：</span><div><pre class="oac_no_warn" dir="ltr">VARIABLE x NUMBER VARIABLE y NUMBER EXECUTE：x：= 5;</pre></div>
                        </li>
                        <li class="stepexpand"><span>调用<code class="codeph">J_calcFactorial</code> ：</span><div><pre class="oac_no_warn" dir="ltr">CALL J_calcFactorial（：x）INTO：y;打印y</pre></div>
                        </li>
                     </ol>
                     <div class="section">
                        <p>结果：</p><pre class="oac_no_warn" dir="ltr">Y ------ 120</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADFNS748"></a><div class="props_rev_3"><a id="GUID-D5F492F9-624A-481C-84B3-9B1E24EFAB0C" name="GUID-D5F492F9-624A-481C-84B3-9B1E24EFAB0C"></a><h4 id="ADFNS-GUID-D5F492F9-624A-481C-84B3-9B1E24EFAB0C" class="sect4">调用外部C程序</h4>
                  <div>
                     <div class="section">
                        <p>要调用外部C过程，PL / SQL必须找到相应DLL的路径。 PL / SQL引擎根据过程声明的<code class="codeph">AS</code> <code class="codeph">LANGUAGE</code>子句中的库别名从数据字典中检索路径。
                        </p>
                        <p>接下来，PL / SQL会向Listener进程发出警报，然后该进程会生成特定于会话的代理。默认情况下，此代理名为<code class="codeph">extproc</code> ，但您可以在<code class="codeph">listener</code>器中指定其他名称。 <code class="codeph">ora</code>文件。监听器将与代理的连接移交给代理，PL / SQL将DLL的名称，外部过程的名称和任何参数传递给代理。
                        </p>
                        <p>然后，代理加载DLL并运行外部过程。此外，代理处理服务调用（例如引发异常）和回调到Oracle数据库。最后，代理将外部过程返回的任何值传递给PL / SQL。</p>
                        <div class="infoboxnote" id="GUID-D5F492F9-624A-481C-84B3-9B1E24EFAB0C__GUID-801AB3E9-9603-43A7-A8E0-2776A1C233C6">
                           <p class="notep1">注意：</p>
                           <p>虽然发生了一些DLL缓存，但您的DLL可能不会保留在缓存中;因此，不要在DLL中存储全局变量。</p>
                        </div>
                        <p>外部过程完成后，代理在整个Oracle数据库会话中保持活动状态;注销时，代理程序将停止。因此，无论您拨打多少电话，您只需支付一次启动代理的费用。尽管如此，只有在计算收益超过成本时才调用外部程序。</p>
                        <p>在这里，您可以从匿名块调用在<a href="external-procedures.html#GUID-CD08EFEE-66AB-47B3-9628-87895C826C22">发布外部C过程</a>中<a href="external-procedures.html#GUID-CD08EFEE-66AB-47B3-9628-87895C826C22">发布的</a> PL / SQL函数<code class="codeph">plsCallsCdivisor_func</code> 。PL / SQL将两个整数参数传递给外部函数<code class="codeph">Cdivisor_func</code> ，后者返回它们最大的公约数。
                        </p><pre class="oac_no_warn" dir="ltr">DECLARE g PLS_INTEGER;一个PLS_INTEGER; b PLS_INTEGER; CALL plsCallsCdivisor_func（a，b）;如果g IN（2,4,8）那么......</pre></div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="ADFNS1411"></a><div class="props_rev_3"><a id="GUID-7B5ADF42-E345-4D87-8736-78ED62B78A21" name="GUID-7B5ADF42-E345-4D87-8736-78ED62B78A21"></a><h3 id="ADFNS-GUID-7B5ADF42-E345-4D87-8736-78ED62B78A21" class="sect3">处理多语言程序中的错误和例外</h3>
               <div>
                  <div class="section">
                     <p>如果在<code class="codeph">TYPE</code>或<code class="codeph">PACKAGE</code>规范中找到<code class="codeph">AS</code> <code class="codeph">EXTERNAL</code>调用规范，PL / SQL编译器会引发编译时异常。
                     </p>
                     <p>C程序可以通过<code class="codeph">OCIExtproc</code>函数引发异常。
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="ADFNS1412"></a><div class="props_rev_3"><a id="GUID-F85C0E81-FBE9-4396-A5B1-6E379B44253D" name="GUID-F85C0E81-FBE9-4396-A5B1-6E379B44253D"></a><h3 id="ADFNS-GUID-F85C0E81-FBE9-4396-A5B1-6E379B44253D" class="sect3">使用具有外部C程序的服务例程</h3>
               <div>
                  <div class="section">
                     <p>从外部过程调用时， <span class="bold">服务例程</span>可以引发异常，分配内存，并调用OCI句柄以回调服务器。要使用服务例程，必须指定<code class="codeph">WITH</code> <code class="codeph">CONTEXT</code>子句，该子句允许您将上下文结构传递给外部过程。上下文结构在头文件<code class="codeph">ociextp</code>声明。 <code class="codeph">h</code>如下：</p><pre class="oac_no_warn" dir="ltr">typedef struct OCIExtProcContext OCIExtProcContext;</pre><div class="infoboxnote" id="GUID-F85C0E81-FBE9-4396-A5B1-6E379B44253D__GUID-93D083FA-2228-4F6A-A709-D72F0EBA74E1">
                        <p class="notep1">注意：</p>
                        <p><code class="codeph">ociextp.h</code>位于Linux和UNIX上的<code class="codeph">$ORACLE_HOME/plsql/public</code> 。</p>
                     </div>
                     <p>服务程序：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="external-procedures.html#GUID-A6A621A2-D82F-49E9-929D-2E93D9C04429">OCIExtProcAllocCallMemory</a></p>
                        </li>
                        <li>
                           <p><a href="external-procedures.html#GUID-D86CFB89-2DF8-44B3-B4E5-248D516C8003">OCIExtProcRaiseExcp</a></p>
                        </li>
                        <li>
                           <p><a href="external-procedures.html#GUID-20BF4EB1-5529-401B-A330-CF847DC36017">OCIExtProcRaiseExcpWithMsg</a></p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div><a id="ADFNS749"></a><div class="props_rev_3"><a id="GUID-A6A621A2-D82F-49E9-929D-2E93D9C04429" name="GUID-A6A621A2-D82F-49E9-929D-2E93D9C04429"></a><h4 id="ADFNS-GUID-A6A621A2-D82F-49E9-929D-2E93D9C04429" class="sect4">OCIExtProcAllocCallMemory</h4>
                  <div>
                     <p><code class="codeph">OCIExtProcAllocCallMemory</code>服务例程在外部过程调用的持续时间内分配<span class="italic">n</span>个字节的内存。一旦控制返回PL / SQL，该函数分配的任何内存都将自动释放。</p>
                     <div class="infoboxnote" id="GUID-A6A621A2-D82F-49E9-929D-2E93D9C04429__GUID-957F894C-AABE-480E-8869-8962BB2F0D01">
                        <p class="notep1">注意：</p>
                        <p>没有外部程序调用C函数<code class="codeph">free</code>通过这个服务程序分配的内存，因为这是自动处理。
                        </p>
                     </div>
                     <p>该函数的C原型如下：</p><pre class="oac_no_warn" dir="ltr">dvoid * OCIExtProcAllocCallMemory（OCIExtProcContext * with_context，size_t amount）;</pre><p>参数<code class="codeph">with_context</code>和<code class="codeph">amount</code>分别是上下文指针和要分配的字节数。该函数返回指向已分配内存的无类型指针。返回值为零表示失败。
                     </p>
                     <p>在SQL * Plus中，假设您发布外部函数<code class="codeph">plsToC_concat_func</code> ，如下所示：</p><pre class="oac_no_warn" dir="ltr">创建或替换函数plsToC_concat_func（str1 IN VARCHAR2，str2 IN VARCHAR2）RETURN VARCHAR2 AS LANGUAGE C NAME“concat”LIBRARY stringlib WITH CONTEXT PARAMETERS（CONTEXT，str1 STRING，str1 INDICATOR short，str2 STRING，str2 INDICATOR short，RETURN INDICATOR short，RETURN LENGTH短，RETURN STRING）;</pre><p>调用时， <code class="codeph">C_concat</code>连接两个字符串，然后返回结果：</p><pre class="oac_no_warn" dir="ltr">从DUAL中选择plsToC_concat_func（'hello'，'world'）; PLSTOC_CONCAT_FUNC（'HELLO'，'WORLD'）---------------------------------------- -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  - - 你好，世界</pre><p>如果任一字符串为<code class="codeph">NULL</code> ，则结果也为<code class="codeph">NULL</code> 。如此示例所示， <code class="codeph">C_concat</code>使用<code class="codeph">OCIExtProcAllocCallMemory</code>为结果字符串分配内存：</p><pre class="oac_no_warn" dir="ltr">#include &lt;stdio.h&gt; #include &lt;stdlib.h&gt; #include &lt;string.h&gt; #include &lt;oci.h&gt; #include &lt;ociextp.h&gt; char * concat（ctx，str1，str1_i，str2，str2_i，ret_i ，ret_l）OCIExtProcContext * ctx; char * str1;短str1_i; char * str2;短str2_i;短* ret_i;短* ret_l; {char * tmp;短期; <span class="italic">/ *检查空输入。* /</span> if（（str1_i == OCI_IND_NULL）||（str2_i == OCI_IND_NULL））{* ret_i =（short）OCI_IND_NULL; <span class="italic">/ * PL / SQL没有NULL ptr的概念，所以返回一个零字节的字符串。* /</span> tmp = OCIExtProcAllocCallMemory（ctx，1）; tmp [0] ='\ 0';返回（TMP）; } <span class="italic">/ *为结果字符串分配内存，包括NULL终止符。* /</span> len = strlen（str1）+ strlen（str2）; tmp = OCIExtProcAllocCallMemory（ctx，len + 1）; strcpy（tmp，str1）; strcat（tmp，str2）; <span class="italic">/ *设置NULL指示符和长度。* /</span> * ret_i =（短）OCI_IND_NOTNULL; * ret_l = len; / *返回指针，PL / SQL稍后释放。* / return（tmp）; } #ifdef LATER static void checkerr（/ * _ OCIError * errhp，sword status _ * /）; void checkerr（errhp，status）OCIError * errhp;剑的地位; {text errbuf [512]; sb4 errcode = 0; switch（status）{case OCI_SUCCESS：break; case OCI_SUCCESS_WITH_INFO：（void）printf（“Error  -  OCI_SUCCESS_WITH_INFO \ n”）;打破; case OCI_NEED_DATA：（void）printf（“Error  -  OCI_NEED_DATA \ n”）;打破; case OCI_NO_DATA：（void）printf（“Error  -  OCI_NODATA \ n”）;打破; case OCI_ERROR：（void）OCIErrorGet（（dvoid *）errhp，（ub4）1，（text *）NULL，＆errcode，errbuf，（ub4）sizeof（errbuf），OCI_HTYPE_ERROR）; （void）printf（“Error  - ％。* s \ n”，512，errbuf）;打破; case OCI_INVALID_HANDLE：（void）printf（“Error  -  OCI_INVALID_HANDLE \ n”）;打破; case OCI_STILL_EXECUTING：（void）printf（“Error  -  OCI_STILL_EXECUTE \ n”）;打破; case OCI_CONTINUE：（void）printf（“Error  -  OCI_CONTINUE \ n”）;打破;默认值：break; char * concat（ctx，str1，str1_i，str2，str2_i，ret_i，ret_l）OCIExtProcContext * ctx; char * str1;短str1_i; char * str2;短str2_i;短* ret_i;短* ret_l; {char * tmp;短期; <span class="italic">/ *检查空输入。* /</span> if（（str1_i == OCI_IND_NULL）||（str2_i == OCI_IND_NULL））{* ret_i =（short）OCI_IND_NULL; / * PL / SQL没有NULL ptr的概念，所以返回一个零字节的字符串。* / tmp = OCIExtProcAllocCallMemory（ctx，1）; tmp [0] ='\ 0';返回（TMP）; } <span class="italic">/ *为结果字符串分配内存，包括NULL终止符。* /</span> len = strlen（str1）+ strlen（str2）; tmp = OCIExtProcAllocCallMemory（ctx，len + 1）; strcpy（tmp，str1）; strcat（tmp，str2）; <span class="italic">/ *设置NULL指示符和长度。* /</span> * ret_i =（短）OCI_IND_NOTNULL; * ret_l = len; <span class="italic">/ *返回指针，PL / SQL稍后释放。* /</span> return（tmp）; } / * =============================================== ======================= * / int main（char * argv，int argc）{OCIExtProcContext * ctx; char * str1;短str1_i; char * str2;短str2_i;短* ret_i;短* ret_l; <span class="italic">/ * OCI句柄* /</span> OCIEnv * envhp; OCIServer * srvhp; OCISvcCtx * svchp; OCIError * errhp; OCISession * authp; OCIStmt * stmthp; OCILobLocator * clob，* blob; OCILobLocator * Lob_loc; <span class="italic">/ *初始化和登录* /</span> （void）OCIInitialize（（ub4）OCI_DEFAULT，（dvoid *）0，（dvoid *（*）（dvoid *，size_t））0，（dvoid *（*）（dvoid *，dvoid * ，size_t））0，（void（*）（dvoid *，dvoid *））0）; （void）OCIEnvInit（（OCIEnv **）＆envhp，OCI_DEFAULT，（size_t）0，（dvoid **）0）; （void）OCIHandleAlloc（（dvoid *）envhp，（dvoid **）＆errhp，OCI_HTYPE_ERROR，（size_t）0，（dvoid **）0）; <span class="italic">/ *服务器上下文* /</span> （void）OCIHandleAlloc（（dvoid *）envhp，（dvoid **）＆srvhp，OCI_HTYPE_SERVER，（size_t）0，（dvoid **）0）; <span class="italic">/ *服务上下文* /</span> （void）OCIHandleAlloc（（dvoid *）envhp，（dvoid **）＆svchp，OCI_HTYPE_SVCCTX，（size_t）0，（dvoid **）0）; <span class="italic">/ *附加到Oracle数据库* /</span> （void）OCIServerAttach（srvhp，errhp，（text *）“”，strlen（“”），0）; <span class="italic">/ *在服务上下文中设置属性服务器上下文* /</span> （void）OCIAttrSet（（dvoid *）svchp，OCI_HTYPE_SVCCTX，（dvoid *）srvhp，（ub4）0，OCI_ATTR_SERVER，（OCIError *）errhp）; （void）OCIHandleAlloc（（dvoid *）envhp，（dvoid **）＆authp，（ub4）OCI_HTYPE_SESSION，（size_t）0，（dvoid **）0）; （void）OCIAttrSet（（dvoid *）authp，（ub4）OCI_HTYPE_SESSION，（dvoid *）“samp”，（ub4）4，（ub4）OCI_ATTR_USERNAME，errhp）; （void）OCIAttrSet（（dvoid *）authp，（ub4）OCI_HTYPE_SESSION，（dvoid *）“ <span class="italic">password</span> ”，（ub4）4，（ub4）OCI_ATTR_PASSWORD，errhp）; <span class="italic">/ *开始用户会话* /</span> checkerr（errhp，OCISessionBegin（svchp，errhp，authp，OCI_CRED_RDBMS，（ub4）OCI_DEFAULT））; （void）OCIAttrSet（（dvoid *）svchp，（ub4）OCI_HTYPE_SVCCTX，（dvoid *）authp，（ub4）0，（ub4）OCI_ATTR_SESSION，errhp）; <span class="italic">/ * -----------------------用户已登录---------------------- -------- * /</span> printf（“用户登录\ n”）; / *分配语句句柄* / checkerr（errhp，OCIHandleAlloc（（dvoid *）envhp，（dvoid **）＆stmthp，OCI_HTYPE_STMT，（size_t）0，（dvoid **）0））; checkerr（errhp，OCIDescriptorAlloc（（dvoid *）envhp，（dvoid **）＆Lob_loc，（ub4）OCI_DTYPE_LOB，（size_t）0，（dvoid **）0））; <span class="italic">/ * -------这里</span>调用<span class="italic">子程序----------------------- * /</span> printf（“call concat ... \ n”）; concat（ctx，str1，str1_i，str2，str2_i，ret_i，ret_l）;返回0; } ＃万一</pre></div>
               </div><a id="ADFNS750"></a><div class="props_rev_3"><a id="GUID-D86CFB89-2DF8-44B3-B4E5-248D516C8003" name="GUID-D86CFB89-2DF8-44B3-B4E5-248D516C8003"></a><h4 id="ADFNS-GUID-D86CFB89-2DF8-44B3-B4E5-248D516C8003" class="sect4">OCIExtProcRaiseExcp</h4>
                  <div>
                     <p><code class="codeph">OCIExtProcRaiseExcp</code>服务例程引发预定义的异常，该异常必须具有1..32,767范围内的有效Oracle数据库错误号。在进行任何必要的清理后，您的外部程序必须立即返回。（没有为<code class="codeph">OUT</code>或<code class="codeph">IN</code> <code class="codeph">OUT</code>参数赋值。）该函数的C原型如下：</p><pre class="oac_no_warn" dir="ltr">int OCIExtProcRaiseExcp（OCIExtProcContext * with_context，size_t errnum）;</pre><p>参数<code class="codeph">with_context</code>和<code class="codeph">error_number</code>是上下文指针和Oracle数据库错误号。返回值<code class="codeph">OCIEXTPROC_SUCCESS</code>和<code class="codeph">OCIEXTPROC_ERROR</code>表示成功或失败。
                     </p>
                     <p>在SQL * Plus中，假设您发布外部过程<code class="codeph">plsTo_divide_proc</code> ，如下所示：</p><pre class="oac_no_warn" dir="ltr">创建或替换过程plsTo_divide_proc（被分配IN PLS_INTEGER，除数IN PLS_INTEGER，结果OUT FLOAT）AS语言C名称“C_divide”LIBRARY MathLib具有上下文参数（上下文，被除数INT，除数INT，结果FLOAT）;</pre><p>调用时， <code class="codeph">C_divide</code>找到两个数的商。如此示例所示，如果除数为零，则<code class="codeph">C_divide</code>使用<code class="codeph">OCIExtProcRaiseExcp</code>来引发预定义的异常<code class="codeph">ZERO_DIVIDE</code> ：</p><pre class="oac_no_warn" dir="ltr">void C_divide（ctx，dividend，divisor，result）OCIExtProcContext * ctx;分红; int divisor; float *结果; {/ *检查零除数。* / if（divisor ==（int）0）{/ *提出异常ZERO_DIVIDE，这是Oracle数据库错误1476。* / if（OCIExtProcRaiseExcp（ctx，（int）1476）== OCIEXTPROC_SUCCESS）{return; } else {/ *传递了不正确的参数。* / assert（0）; } * * result =（float）dividend /（float）divisor; }</pre></div>
               </div><a id="ADFNS751"></a><div class="props_rev_3"><a id="GUID-20BF4EB1-5529-401B-A330-CF847DC36017" name="GUID-20BF4EB1-5529-401B-A330-CF847DC36017"></a><h4 id="ADFNS-GUID-20BF4EB1-5529-401B-A330-CF847DC36017" class="sect4">OCIExtProcRaiseExcpWithMsg</h4>
                  <div>
                     <p><code class="codeph">OCIExtProcRaiseExcpWithMsg</code>服务例程引发用户定义的异常并返回用户定义的错误消息。该函数的C原型如下：</p><pre class="oac_no_warn" dir="ltr">int OCIExtProcRaiseExcpWithMsg（OCIExtProcContext * with_context，size_t error_number，text * error_message，size_t len）;</pre><p>参数<code class="codeph">with_context</code> ， <code class="codeph">error_number</code>和<code class="codeph">error_message</code>是上下文指针，Oracle数据库错误号和错误消息文本。参数<code class="codeph">len</code>存储错误消息的长度。如果消息是以null结尾的字符串，则<code class="codeph">len</code>为零。返回值<code class="codeph">OCIEXTPROC_SUCCESS</code>和<code class="codeph">OCIEXTPROC_ERROR</code>表示成功或失败。
                     </p>
                     <p>在上一个示例中，您发布了外部过程<code class="codeph">plsTo_divide_proc</code> 。在此示例中，您使用了不同的实现。对于此版本，如果除数为零，则<code class="codeph">C_divide</code>使用<code class="codeph">OCIExtProcRaiseExcpWithMsg</code>来引发用户定义的异常：</p><pre class="oac_no_warn" dir="ltr">void C_divide（ctx，dividend，divisor，result）OCIExtProcContext * ctx;分红; int divisor; float *结果; / *检查零除数。* / if（divisor ==（int）0）{ <span class="italic">/ *引发用户定义的异常，即Oracle数据库错误20100，</span> <span class="italic">并返回以null结尾的错误消息。* /</span> if（OCIExtProcRaiseExcpWithMsg（ctx，（int）20100，“除数为零”，0）== OCIEXTPROC_SUCCESS）{return; } else {/ *传递了不正确的参数。* / assert（0）; } * * result = dividend / divisor; }</pre></div>
               </div>
            </div><a id="ADFNS1096"></a><a id="ADFNS1413"></a><div class="props_rev_3"><a id="GUID-2F73AD9E-924D-4955-891E-BCFCB0439F59" name="GUID-2F73AD9E-924D-4955-891E-BCFCB0439F59"></a><h3 id="ADFNS-GUID-2F73AD9E-924D-4955-891E-BCFCB0439F59" class="sect3">使用外部C程序执行回调</h3>
               <div>
                  <div class="section">
                     <p>要启用回调，请使用函数OCIExtProcGetEnv。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-2F73AD9E-924D-4955-891E-BCFCB0439F59__GUID-38667157-422D-4DFA-8F8F-64BC6FE38901">话题：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="external-procedures.html#GUID-596B4098-93D2-48BE-A257-630AF36FAA3F">OCIExtProcGetEnv</a></p>
                        </li>
                        <li>
                           <p><a href="external-procedures.html#GUID-770F32C0-931D-4F20-8819-7B28CD2A92C5">对OCI回调的对象支持</a></p>
                        </li>
                        <li>
                           <p><a href="external-procedures.html#GUID-7E6E02AA-9D21-4196-8045-0DC038EB66AD">回调限制</a></p>
                        </li>
                        <li>
                           <p><a href="external-procedures.html#GUID-415FB609-F482-4B99-8F06-E3477BDDA910">调试外部C程序</a></p>
                        </li>
                        <li>
                           <p><a href="external-procedures.html#GUID-F9F9F129-5C83-4AE1-ABCA-550D6425FB0D">示例：调用外部C过程</a></p>
                        </li>
                        <li>
                           <p><a href="external-procedures.html#GUID-AD5DF1F7-096E-49FD-A8C9-2BF7184F89D5">外部C程序中的全局变量</a></p>
                        </li>
                        <li>
                           <p><a href="external-procedures.html#GUID-2827F334-5989-4DDB-BDC0-2DD37A91212D">外部C程序中的静态变量</a></p>
                        </li>
                        <li>
                           <p><a href="external-procedures.html#GUID-7416A1E4-5EAC-4AB0-B4B0-803B24ABB959">外部C程序的限制</a></p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div><a id="ADFNS752"></a><div class="props_rev_3"><a id="GUID-596B4098-93D2-48BE-A257-630AF36FAA3F" name="GUID-596B4098-93D2-48BE-A257-630AF36FAA3F"></a><h4 id="ADFNS-GUID-596B4098-93D2-48BE-A257-630AF36FAA3F" class="sect4">OCIExtProcGetEnv</h4>
                  <div>
                     <div class="section">
                        <p><code class="codeph">OCIExtProcGetEnv</code>服务例程在外部过程调用期间启用对数据库的OCI回调。使用此函数获取的环境句柄重用现有连接返回数据库。如果必须建立与数据库的新连接，则不能使用这些句柄;相反，你必须创建自己的。
                        </p>
                        <p>该函数的C原型如下：</p><pre class="oac_no_warn" dir="ltr">剑OCIExtProcGetEnv（OCIExtProcContext * with_context，OCIEnv envh，OCISvcCtx svch，OCIError errh）</pre><p>参数<code class="codeph">with_context</code>是上下文指针，参数<code class="codeph">envh</code> ， <code class="codeph">svch</code>和<code class="codeph">errh</code>分别是OCI环境，服务和错误句柄。返回值<code class="codeph">OCIEXTPROC_SUCCESS</code>和<code class="codeph">OCIEXTPROC_ERROR</code>表示成功或失败。
                        </p>
                        <p>外部C过程和Java类方法都可以回调数据库来执行SQL操作。有关工作示例，请参阅<a href="external-procedures.html#GUID-F9F9F129-5C83-4AE1-ABCA-550D6425FB0D">示例：调用外部C过程</a> 。
                        </p>
                        <div class="infoboxnote" id="GUID-596B4098-93D2-48BE-A257-630AF36FAA3F__GUID-104AE6D8-D8A7-4875-933D-77D601DB3F5A">
                           <p class="notep1">注意：</p>
                           <p>回调不一定是同一会话现象;您可以通过<code class="codeph">OCIlogon</code>在不同的会话中运行SQL语句。
                           </p>
                        </div>
                        <p>在Oracle数据库上运行的外部C过程可以调用服务例程来获取OCI环境和服务句柄。使用OCI，您可以使用回调来运行SQL语句和PL / SQL子程序，获取数据和操作LOB。回调和外部过程在相同的用户会话和事务上下文中运行，因此具有相同的用户权限。</p>
                        <p>在SQL * Plus中，假设您运行此脚本：</p><pre class="oac_no_warn" dir="ltr">CREATE TABLE Emp_tab（empno NUMBER（10））CREATE PROCEDURE plsToC_insertIntoEmpTab_proc（empno PLS_INTEGER）AS LANGUAGE C NAME“C_insertEmpTab”LIBRARY insert_lib WITH CONTEXT PARAMETERS（CONTEXT，empno LONG）;</pre><p>后来，您可以调用服务程序<code class="codeph">OCIExtProcGetEnv</code>从外部过程<code class="codeph">plsToC_insertIntoEmpTab_proc</code> ，如下所示：</p><pre class="oac_no_warn" dir="ltr">#include &lt;stdio.h&gt; #include &lt;stdlib.h&gt; #include &lt;oratypes.h&gt; #include &lt;oci.h&gt; / *包括ociextp.h * / ...void C_insertIntoEmpTab（ctx，empno）OCIExtProcContext * ctx;长期的{OCIEnv * envhp; OCISvcCtx * svchp; OCIError * errhp; int err; ...err = OCIExtProcGetEnv（ctx，＆envhp，＆svchp，＆errhp）; ...}</pre><p>如果不使用回调，则不需要包含<code class="codeph">oci</code> 。 <code class="codeph">h</code> ;相反，包括<code class="codeph">ociextp</code> 。 <code class="codeph">h</code> 。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADFNS753"></a><div class="props_rev_3"><a id="GUID-770F32C0-931D-4F20-8819-7B28CD2A92C5" name="GUID-770F32C0-931D-4F20-8819-7B28CD2A92C5"></a><h4 id="ADFNS-GUID-770F32C0-931D-4F20-8819-7B28CD2A92C5" class="sect4">对OCI回调的对象支持</h4>
                  <div>
                     <p>要从外部过程运行与对象相关的回调， <code class="codeph">extproc</code>代理中的OCI环境将在对象模式下完全初始化。您使用<code class="codeph">OCIExtProcGetEnv</code>过程检索此环境的<code class="codeph">OCIExtProcGetEnv</code> 。
                     </p>
                     <p>对象运行时环境允许您使用OCI提供的静态和动态对象支持。要使用静态支持，请使用OTT为适当的对象类型生成C结构，然后使用传统的C代码访问对象属性。</p>
                     <p>对于那些在外部过程创建时类型未知的对象，另一种动态的访问对象的方法是首先调用<code class="codeph">OCIDescribeAny</code>来获取有关该类型的属性和方法信息。然后，可以调用<code class="codeph">OCIObjectGetAttr</code>和<code class="codeph">OCIObjectSetAttr</code>来检索和设置属性值。
                     </p>
                     <p>因为当前外部过程模型是无状态的， <code class="codeph">OCIExtProcGetEnv</code>必须在每个想要运行回调的外部过程中调用<code class="codeph">OCIExtProc</code> ，或者调用<code class="codeph">OCIExtProc</code> 。服务程序。在每次外部过程调用之后，将清除回调机制并释放所有OCI句柄。
                     </p>
                  </div>
               </div><a id="ADFNS754"></a><div class="props_rev_3"><a id="GUID-7E6E02AA-9D21-4196-8045-0DC038EB66AD" name="GUID-7E6E02AA-9D21-4196-8045-0DC038EB66AD"></a><h4 id="ADFNS-GUID-7E6E02AA-9D21-4196-8045-0DC038EB66AD" class="sect4">回调限制</h4>
                  <div>
                     <p>使用回调，不支持此SQL语句和OCI子程序：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>事务控制语句，如<code class="codeph">COMMIT</code></p>
                        </li>
                        <li>
                           <p>数据定义语句，例如<code class="codeph">CREATE</code></p>
                        </li>
                        <li>
                           <p>这些面向对象的OCI子程序：</p><pre class="oac_no_warn" dir="ltr">OCIObjectNew OCIObjectPin OCIObjectUnpin OCIObjectPinCountReset OCIObjectLock OCIObjectMarkUpdate OCIObjectUnmark OCIObjectUnmarkByRef OCIObjectAlwaysLatest OCIObjectNotAlwaysLatest OCIObjectMarkDeleteByRef OCIObjectMarkDelete OCIObjectFlush OCIObjectFlushRefresh OCIObjectGetTypeRef OCIObjectGetObjectRef OCIObjectExists OCIObjectIsLocked OCIObjectIsDirtied OCIObjectIsLoaded OCIObjectRefresh OCIObjectPinTable OCIObjectArrayPin OCICacheFlush，OCICacheFlushRefresh，OCICacheRefresh OCICacheUnpin OCICacheFree OCICacheUnmark OCICacheGetObjects OCICacheRegister</pre></li>
                     </ul>
                     <ul class="simple" style="list-style-type:none;padding-left:0">
                        <li></li>
                     </ul>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>轮询模式OCI子程序，例如<code class="codeph">OCIGetPieceInfo</code> 
                           </p>
                        </li>
                        <li>
                           <p>这些OCI子程序：</p><pre class="oac_no_warn" dir="ltr">OCIEnvInit OCIInitialize OCIPasswordChange OCIServerAttach OCIServerDetach OCISessionBegin OCISessionEnd OCISvcCtxToLda OCITransCommit OCITransDetach OCITransRollback OCITransStart</pre></li>
                     </ul><pre class="oac_no_warn" dir="ltr"></pre><p>此外，使用OCI子程序<code class="codeph">OCIHandleAlloc</code> ，不支持这些句柄类型：</p><pre class="oac_no_warn" dir="ltr"><code class="codeph">OCI_HTYPE_SERVER</code> <code class="codeph">OCI_HTYPE_SESSION</code> <code class="codeph">OCI_HTYPE_SVCCTX</code> <code class="codeph">OCI_HTYPE_TRANS</code></pre></div>
               </div><a id="ADFNS755"></a><div class="props_rev_3"><a id="GUID-415FB609-F482-4B99-8F06-E3477BDDA910" name="GUID-415FB609-F482-4B99-8F06-E3477BDDA910"></a><h4 id="ADFNS-GUID-415FB609-F482-4B99-8F06-E3477BDDA910" class="sect4">调试外部C程序</h4>
                  <div>
                     <div class="section">
                        <p>通常，当外部程序失败时，其原型是错误的。换句话说，原型与PL / SQL内部生成的原型不匹配。如果指定不兼容的C数据类型，则会发生这种情况。例如，要传递<code class="codeph">REAL</code>类型的<code class="codeph">OUT</code>参数，必须指定<code class="codeph">float *</code> 。指定<code class="codeph">float</code> ， <code class="codeph">double</code> <code class="codeph">*</code>或任何其他C数据类型会导致不匹配。
                        </p>
                        <p>在这种情况下，您可能会得到：</p><pre class="oac_no_warn" dir="ltr">丢失与外部例程代理的RPC连接</pre><p>此错误，表示<code class="codeph">extproc</code>异常终止，因为外部过程导致核心转储。要在声明C原型参数时避免错误，请参阅上表。
                        </p>
                        <p>为了帮助您调试外部过程，PL / SQL提供了实用程序包<code class="codeph">DEBUG_EXTPROC</code> 。要安装软件包，请运行脚本<code class="codeph">dbgextp</code> 。 <code class="codeph">sql</code> ，您可以在PL / SQL演示目录中找到它。（有关目录的位置，请参阅Oracle数据库安装或用户指南。）
                        </p>
                        <p>要使用该包，请按照<code class="codeph">dbgextp</code>的说明进行<code class="codeph">dbgextp</code> 。 <code class="codeph">sql</code> 。您的Oracle数据库帐户必须具有对程序包和<code class="codeph">CREATE</code> <code class="codeph">LIBRARY</code>权限的<code class="codeph">EXECUTE</code>权限。
                        </p>
                        <div class="infoboxnote" id="GUID-415FB609-F482-4B99-8F06-E3477BDDA910__GUID-B327715C-AC18-4342-9CBE-AD431D0E44D5">
                           <p class="notep1">注意：</p>
                           <p><code class="codeph">DEBUG_EXTPROC</code>仅适用于具有可附加到正在运行的进程的调试器的平台。
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADFNS756"></a><div class="props_rev_3"><a id="GUID-F9F9F129-5C83-4AE1-ABCA-550D6425FB0D" name="GUID-F9F9F129-5C83-4AE1-ABCA-550D6425FB0D"></a><h4 id="ADFNS-GUID-F9F9F129-5C83-4AE1-ABCA-550D6425FB0D" class="sect4">示例：调用外部C过程</h4>
                  <div>
                     <div class="section">
                        <p>PL / SQL演示目录中还有脚本<code class="codeph">extproc</code> 。 <code class="codeph">sql</code> ，演示了调用外部过程。配套文件<code class="codeph">extproc</code> 。 <code class="codeph">c</code>包含外部过程的C源代码。
                        </p>
                        <p>要运行演示，请按照<code class="codeph">extproc</code>的说明进行操作。 <code class="codeph">sql</code> 。您必须使用<code class="codeph">SCOTT</code>帐户，该帐户必须具有<code class="codeph">CREATE</code> <code class="codeph">LIBRARY</code>权限。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADFNS757"></a><div class="props_rev_3"><a id="GUID-AD5DF1F7-096E-49FD-A8C9-2BF7184F89D5" name="GUID-AD5DF1F7-096E-49FD-A8C9-2BF7184F89D5"></a><h4 id="ADFNS-GUID-AD5DF1F7-096E-49FD-A8C9-2BF7184F89D5" class="sect4">外部C程序中的全局变量</h4>
                  <div>
                     <p>全局变量在函数外部声明，其值由程序的所有函数共享。因此，在外部过程中，DLL中的所有函数都共享全局变量的值。全局变量还用于存储旨在超出函数生命周期的数据。但是，Oracle不鼓励使用全局变量有两个原因：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>穿线</p>
                           <p>在代理进程的非线程配置中，一次激活一个功能。对于多线程<code class="codeph">extproc</code>代理，多个函数可以同时处于活动状态，并且可能会尝试同时访问全局变量，但结果不成功。
                           </p>
                        </li>
                        <li>
                           <p>DLL缓存</p>
                           <p>假设函数<code class="codeph">func1</code>尝试通过将数据存储在全局变量中来将数据传递给函数<code class="codeph">func2</code> 。<code class="codeph">func1</code>完成后，可能会卸载DLL缓存，导致所有全局变量丢失其值。然后，当<code class="codeph">func2</code>运行时，重新加载DLL，并将所有全局变量初始化为0。
                           </p>
                        </li>
                     </ul>
                  </div>
               </div><a id="ADFNS758"></a><div class="props_rev_3"><a id="GUID-2827F334-5989-4DDB-BDC0-2DD37A91212D" name="GUID-2827F334-5989-4DDB-BDC0-2DD37A91212D"></a><h4 id="ADFNS-GUID-2827F334-5989-4DDB-BDC0-2DD37A91212D" class="sect4">外部C程序中的静态变量</h4>
                  <div>
                     <p>有两种类型的静态变量：外部和内部。外部静态变量是全局变量的特例，因此不鼓励使用它。内部静态变量是特定函数的本地变量，但每次激活函数时都保持存在而不是来去。因此，它们在单个功能中提供私有的永久存储。这些变量用于将数据传递给后续对同一函数的调用。但是，由于<a href="external-procedures.html#GUID-AD5DF1F7-096E-49FD-A8C9-2BF7184F89D5">外部C过程</a>中的<a href="external-procedures.html#GUID-AD5DF1F7-096E-49FD-A8C9-2BF7184F89D5">全局变量中</a>提到的DLL缓存功能，DLL可能会在调用之间被卸载和重新加载，这意味着内部静态变量会丢失其值。
                     </p>
                     <div class="infoboxnote" id="GUID-2827F334-5989-4DDB-BDC0-2DD37A91212D__GUID-C61155CD-219D-4B4A-B169-2C82E7B22F5C">
                        <p class="notep1">：</p>
                        <p>RDBMS子目录<code class="codeph">/public</code>中的模板<code class="codeph">makefile</code> ，用于创建动态链接库的帮助</p>
                     </div>
                     <p>调用外部程序时：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>切勿写入<code class="codeph">IN</code>参数或溢出<code class="codeph">OUT</code>参数的容量。（PL / SQL不对这些错误条件进行运行时检查。）
                           </p>
                        </li>
                        <li>
                           <p>切勿读取<code class="codeph">OUT</code>参数或功能结果。
                           </p>
                        </li>
                        <li>
                           <p>始终为<code class="codeph">IN</code> <code class="codeph">OUT</code>和<code class="codeph">OUT</code>参数以及功能结果分配值。否则，您的外部过程将无法成功返回。
                           </p>
                        </li>
                        <li>
                           <p>如果包含<code class="codeph">WITH</code> <code class="codeph">CONTEXT</code>和<code class="codeph">PARAMETERS</code>子句，则必须指定参数<code class="codeph">CONTEXT</code> ，该参数显示参数列表中上下文指针的位置。
                           </p>
                        </li>
                        <li>
                           <p>如果包含<code class="codeph">PARAMETERS</code>子句，并且外部过程是函数，则必须在最后一个位置指定参数<code class="codeph">RETURN</code> 。
                           </p>
                        </li>
                        <li>
                           <p>对于每个形式参数， <code class="codeph">PARAMETERS</code>子句中必须有相应的<code class="codeph">PARAMETERS</code> 。此外，请确保<code class="codeph">PARAMETERS</code>子句中的<code class="codeph">PARAMETERS</code>数据类型与C原型中的<code class="codeph">PARAMETERS</code>数据类型兼容，因为不会进行隐式转换。
                           </p>
                        </li>
                        <li>
                           <p>使用<code class="codeph">RAW</code>或<code class="codeph">LONG</code> <code class="codeph">RAW</code>类型的参数时，必须使用属性<code class="codeph">LENGTH</code> 。此外，如果该参数为<code class="codeph">IN</code> <code class="codeph">OUT</code>或<code class="codeph">OUT</code>且为null，则必须将相应C参数的长度设置为零。
                           </p>
                        </li>
                     </ul>
                  </div>
               </div><a id="ADFNS759"></a><div class="props_rev_3"><a id="GUID-7416A1E4-5EAC-4AB0-B4B0-803B24ABB959" name="GUID-7416A1E4-5EAC-4AB0-B4B0-803B24ABB959"></a><h4 id="ADFNS-GUID-7416A1E4-5EAC-4AB0-B4B0-803B24ABB959" class="sect4">外部C程序的限制</h4>
                  <div>
                     <p>这些限制适用于外部程序：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>此功能仅在支持DLL的平台上可用。</p>
                        </li>
                        <li>
                           <p>仅支持从C代码调用的C过程和过程。</p>
                        </li>
                        <li>
                           <p>不支持外部过程标注与分布式事务相结合。</p>
                        </li>
                        <li>
                           <p>您不能将PL / SQL游标变量或记录传递给外部过程。对于记录，请改用对象类型的实例。</p>
                        </li>
                        <li>
                           <p>在<code class="codeph">LIBRARY</code>子句中，您不能使用数据库链接来指定远程库。
                           </p>
                        </li>
                        <li>
                           <p>可以传递给外部过程的最大参数数为128。但是，如果按值传递float或double参数，则最大值小于128。多少取决于这些参数和操作系统的数量。要获得粗略估计，请将每个浮点值或两个值的值计算为两个参数。</p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>