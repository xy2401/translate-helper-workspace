<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>CATSEARCH查询应用程序</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Application Developer&#39;s Guide "></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Application Developer&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="text-application-developers-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-07T01:45:16-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2001, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96275-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="CONTEXT-query-application.html" title="Previous" type="text/html"></link>
      <link rel="next" href="custom-index-preference-examples.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Text Application Developer&#39;s Guide"></meta>
    <meta name="dcterms.isVersionOf" content="CCAPP"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="CONTEXT-query-application.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="custom-index-preference-examples.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">应用程序开发人员指南</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">CATSEARCH查询应用程序</li>
            </ol>
            <a id="GUID-72F18A97-92D7-411D-871A-27AD749D6141" name="GUID-72F18A97-92D7-411D-871A-27AD749D6141"></a><a id="CCAPP3100"></a>
            
            <h2 id="CCAPP-GUID-72F18A97-92D7-411D-871A-27AD749D6141" class="sect2"><span class="enumeration_chapter">B</span> CATSEARCH查询应用程序</h2>
         </header>
         <div class="ind">
            <div>
               <p><a id="d41409e61" class="indexterm-anchor"></a><a id="d41409e65" class="indexterm-anchor"></a><a id="d41409e67" class="indexterm-anchor"></a><a id="d41409e71" class="indexterm-anchor"></a>本附录介绍如何使用<code class="codeph">CATSEARCH</code>索引类型构建简单的Web搜索应用程序。
               </p>
               <p>本附录包含以下主题：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="CATSEARCH-query-application.html#GUID-D7B36466-FD0E-49FB-9677-0342B6F9931C">CATSEARCH Web查询应用程序概述</a></p>
                  </li>
                  <li>
                     <p><a href="CATSEARCH-query-application.html#GUID-24D14B20-AA64-4192-AABB-98CEA4744B82">JSP Web应用程序</a></p>
                  </li>
               </ul>
            </div><a id="CCAPP9384"></a><div class="props_rev_3"><a id="GUID-D7B36466-FD0E-49FB-9677-0342B6F9931C" name="GUID-D7B36466-FD0E-49FB-9677-0342B6F9931C"></a><h3 id="CCAPP-GUID-D7B36466-FD0E-49FB-9677-0342B6F9931C" class="sect3"><span class="enumeration_section">B.1</span> CATSEARCH Web查询应用程序概述</h3>
               <div>
                  <p><code class="codeph">CTXCAT</code>索引类型非常适合具有简短描述性文本片段和相关结构化数据的商品目录。本附录描述了如何构建基于浏览器的书店目录，用户可以搜索该目录以查找标题和价格。
                  </p>
                  <p>此应用程序是用JavaServer Pages（JSP）编写的。</p>
               </div>
            </div><a id="CCAPP9385"></a><div class="props_rev_3"><a id="GUID-24D14B20-AA64-4192-AABB-98CEA4744B82" name="GUID-24D14B20-AA64-4192-AABB-98CEA4744B82"></a><h3 id="CCAPP-GUID-24D14B20-AA64-4192-AABB-98CEA4744B82" class="sect3"><span class="enumeration_section">B.2</span> JSP Web应用程序</h3>
               <div>
                  <p>此应用程序基于JavaServer页面（JSP），并具有以下要求：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>您的Oracle数据库必须已启动并正在运行。</p>
                     </li>
                     <li>
                        <p>Web服务器，例如Apache Tomcat，它可以运行使用Java数据库连接（JDBC）连接到Oracle数据库的JSP脚本。</p>
                     </li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-24D14B20-AA64-4192-AABB-98CEA4744B82__GUID-604B2334-6E47-4A80-9464-482B3C599AFF">
                     <p class="notep1">也可以看看：</p>
                     <p>有关安装Apache HTTP Server的信息，请参阅<span class="italic">Oracle Database 2 Day + PHP Developer's Guide</span></p>
                  </div>
                  <p>本节包含以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="CATSEARCH-query-application.html#GUID-0545BB84-B851-4CCE-8A6A-51857384E071">构建JSP Web应用程序</a></p>
                     </li>
                     <li>
                        <p><a href="CATSEARCH-query-application.html#GUID-C3986263-5739-43D4-B703-8805AE8CE142">JSP Web应用程序示例代码</a></p>
                     </li>
                  </ul>
               </div><a id="CCAPP9531"></a><a id="CCAPP9386"></a><div class="props_rev_3"><a id="GUID-0545BB84-B851-4CCE-8A6A-51857384E071" name="GUID-0545BB84-B851-4CCE-8A6A-51857384E071"></a><h4 id="CCAPP-GUID-0545BB84-B851-4CCE-8A6A-51857384E071" class="sect4"><span class="enumeration_section">B.2.1</span>构建JSP Web应用程序</h4>
                  <div>
                     <div class="section">
                        <p>此应用程序模拟在线书店，您可以在其中查找书名和价格。</p>
                        <p>要创建JavaServer Pages（JSP）Web应用程序：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>创建你的表。</span><div>
                              <p>您必须创建表格以存储标题，出版商和价格等书籍信息。从SQL * Plus：</p><pre class="oac_no_warn" dir="ltr">sqlplus&gt; create table book_catalog（id numeric，title varchar2（80），publisher varchar2（25），price numeric）</pre></div>
                        </li>
                        <li class="stepexpand"><span>使用SQL * Loader加载数据。</span><div>
                              <p>使用SQL * Loader从操作系统命令行加载book数据：</p><pre class="oac_no_warn" dir="ltr">％sqlldr userid = ctxdemo / ctxdemo control = loader.ctl</pre></div>
                        </li>
                        <li class="stepexpand"><span>创建索引集。</span><div>
                              <p>您可以从SQL * Plus创建索引集：</p><pre class="oac_no_warn" dir="ltr">sqlplus&gt; begin ctx_ddl.create_index_set（'bookset'）; ctx_ddl.add_index（ '查询手册'， '价格'）; ctx_ddl.add_index（ '查询手册'， '发布者'）;结束; /</pre></div>
                        </li>
                        <li class="stepexpand"><span>创建<code class="codeph">CTXCAT</code>索引。</span><div>
                              <p>您可以从SQL * Plus创建<code class="codeph">CTXCAT</code>索引，如下所示：</p><pre class="oac_no_warn" dir="ltr">sqlplus&gt;在book_catalog上创建索引book_idx（标题）indextype是ctxsys.ctxcat参数（'index set bookset'）;</pre></div>
                        </li>
                        <li class="stepexpand"><span>尝试使用<code class="codeph">CATSEARCH.</code>进行简单搜索<code class="codeph">CATSEARCH.</code></span><div>
                              <p>您可以在SQL * Plus中测试新创建的索引，如下所示：</p><pre class="oac_no_warn" dir="ltr">sqlplus&gt; select book，title from book_catalog where catsearch（title，'Java'，'price&gt; 10 order by price'）&gt; 0</pre></div>
                        </li>
                        <li class="stepexpand"><span>将<code class="codeph">catalogSearch.jsp</code>文件复制到JSP目录。</span><div>
                              <p>执行此操作时，您可以从浏览器访问该应用程序。URL为<code class="codeph">http://</code> <span class="italic">localhost</span> <code class="codeph">:</code> <span class="italic">port</span> <code class="codeph">/</code> <span class="italic">path</span> <code class="codeph">/catalogSearch.jsp.</code></p>
                              <p>应用程序在浏览器中显示查询字段，并将查询结果作为HTML链接列表返回。<a href="CATSEARCH-query-application.html#GUID-0545BB84-B851-4CCE-8A6A-51857384E071__I634494">见图B-1</a> 。
                              </p>
                           </div>
                        </li>
                     </ol>
                     <div class="section">
                        <div class="figure" id="GUID-0545BB84-B851-4CCE-8A6A-51857384E071__I634494">
                           <p class="titleinfigure">图B-1 Web查询应用程序的屏幕截图</p><img src="img/qcatwiz1_newb.gif" width="503" alt="下面描述图B-1" title="下面描述图B-1" longdesc="img_text/qcatwiz1_newb.html"><br><a href="img_text/qcatwiz1_newb.html">“图B-1 Web查询应用程序的屏幕截图”的描述</a></div>
                        <!-- class="figure" -->
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="CCAPP9387"></a><div class="props_rev_3"><a id="GUID-C3986263-5739-43D4-B703-8805AE8CE142" name="GUID-C3986263-5739-43D4-B703-8805AE8CE142"></a><h4 id="CCAPP-GUID-C3986263-5739-43D4-B703-8805AE8CE142" class="sect4"><span class="enumeration_section">B.2.2</span> JSP Web应用程序示例代码</h4>
                  <div>
                     <p>本节列出了用于构建示例Web应用程序的代码。它包括以下文件：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="CATSEARCH-query-application.html#GUID-C0558949-0BE3-45FD-BD72-223118825581">loader.ctl</a></p>
                        </li>
                        <li>
                           <p><a href="CATSEARCH-query-application.html#GUID-3F66BB43-5E4C-4F76-B6B2-B91BAA40609F">loader.dat</a></p>
                        </li>
                        <li>
                           <p><a href="CATSEARCH-query-application.html#GUID-A72F070D-4A17-40A4-89F3-857B1560B570">catalogSearch.jsp</a></p>
                           <div class="infoboxnotealso" id="GUID-C3986263-5739-43D4-B703-8805AE8CE142__GUID-5FC4697F-EB50-4CDB-A91C-6DFD52CC15F1">
                              <p class="notep1">也可以看看：</p>
                              <p><a href="http://www.oracle.com/technetwork/indexes/downloads/index.html" target="_blank"><code class="codeph">http://www.oracle.com/technetwork/indexes/downloads/index.html</code></a></p>
                           </div>
                        </li>
                     </ul>
                  </div><a id="CCAPP9388"></a><div class="props_rev_3"><a id="GUID-C0558949-0BE3-45FD-BD72-223118825581" name="GUID-C0558949-0BE3-45FD-BD72-223118825581"></a><h5 id="CCAPP-GUID-C0558949-0BE3-45FD-BD72-223118825581" class="sect5"><span class="enumeration_section">B.2.2.1</span> loader.ctl</h5>
                     <div>
                        <div class="section"><pre class="oac_no_warn" dir="ltr">LOAD DATA INFILE'loading.dat'INTO TABLE book_catalog REPLACE FIELDS TERMINATED BY';' （id，title，publisher，price）</pre></div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="CCAPP9389"></a><div class="props_rev_3"><a id="GUID-3F66BB43-5E4C-4F76-B6B2-B91BAA40609F" name="GUID-3F66BB43-5E4C-4F76-B6B2-B91BAA40609F"></a><h5 id="CCAPP-GUID-3F66BB43-5E4C-4F76-B6B2-B91BAA40609F" class="sect5"><span class="enumeration_section">B.2.2.2</span> loader.dat</h5>
                     <div>
                        <div class="section"><pre class="oac_no_warn" dir="ltr">1;山羊史; SPINDRIFT书籍; 50 2;健康的食谱受到饮食过多的启发; SPINDRIFT书籍; 28 3;格陵兰历史地图集; SPINDRIFT书籍; 35 4;格陵兰岛民宿指南; SPINDRIFT书籍; 37 5;离开你的工作，逃跑; SPINDRIFT书籍; 25 6;奥马哈最好的面馆; SPINDRIFT书籍; 28 7;完整的脚趾书; SPINDRIFT书籍; 16 8;完成白痴核技术指南; SPINDRIFT书籍; 28 9;林地动物的Java编程;大小的书; 10 10;紧急手术技巧和窍门; SPOT-ON出版; 10 11;闭眼编程; KLONDIKE BOOKS; 10 12;十二分钟英语;扳手书11 13;西班牙语十二分钟;扳手书11 14;林地动物的C ++编程; CALAMITY BOOKS; 12 15; Oracle Internet Application Server，企业版; KANT BOOKS; 12 16; Oracle Internet Developer Suite; SPAMMUS BOOK CO; 13 17;向你的宠物讲述真相; IBEX BOOKS INC; 13 18;去问爱丽丝的餐厅;哼哼书; 13 19;生命开始于93; CALAMITY BOOKS; 17 20; Python的Python编程; BALLAST BOOKS; 14 21;倒数第二个Mohican; KLONDIKE BOOKS; 14 22;荷鲁斯之眼;古埃及的甲骨文;大小的书; 15 23;坐下来介绍; IBEX BOOKS INC; 15</pre></div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="CCAPP9390"></a><div class="props_rev_3"><a id="GUID-A72F070D-4A17-40A4-89F3-857B1560B570" name="GUID-A72F070D-4A17-40A4-89F3-857B1560B570"></a><h5 id="CCAPP-GUID-A72F070D-4A17-40A4-89F3-857B1560B570" class="sect5"><span class="enumeration_section">B.2.2.3</span> catalogSearch.jsp</h5>
                     <div>
                        <div class="section"><pre class="oac_no_warn" dir="ltr">&lt;％@ page import =“java.sql。*，oracle.jsp.dbutil。*”％&gt; &lt;jsp：useBean id =“name”class =“oracle.jsp.jml。JmlString“scope =”request“&gt; &lt;jsp：setProperty name =”name“property =”value“param =”v_query“/&gt; &lt;/ jsp：useBean&gt; &lt;％String connStr =”jdbc：oracle：thin：@ machine- domain-name：1521：betadev“; java.util。属性info = new java.util。属性（）;连接conn = null; ResultSet rset = null;语句stmt = null; if（name.isEmpty（））{％&gt; &lt;html&gt; &lt;title&gt;目录搜索&lt;/ title&gt; &lt;body&gt; &lt;center&gt; &lt;form method = post&gt;搜索书名：&lt;input type = text name =“v_query” size = 10&gt;其中publisher是&lt;select name =“v_publisher”&gt; &lt;option value =“ADDISON WESLEY”&gt; ADDISON WESLEY &lt;选项值=“悍马书”&gt;悍马书&lt;选项值=“扳手书”&gt;扳手书&lt;选项value =“SPOT-ON PUBLISHING”&gt; SPOT-ON PUBLISHING &lt;option value =“SPINDRIFT BOOKS”&gt; SPINDRIFT BOOKS &lt;option value =“KLONDIKE BOOKS”&gt; KLONDIKE BOOKS &lt;option value =“CALAMITY BOOKS”&gt; CALAMITY BOOKS &lt;option value = “IBEX BOOKS INC”&gt; IBEX BOOKS INC &lt;期权价值=“BIG LITTLE BOOKS”&gt; BIG LITTLE BOOKS &lt;/ select&gt;且价格为&lt;select name =“v_op”&gt; &lt;option value =“=”&gt; = &lt;option value = “＆LT;”&gt;＆LT; &lt;option value =“＆gt;”&gt;＆gt; &lt;/ select&gt; &lt;input type = text name =“v_price”size = 2&gt; &lt;input type = submit value =“Search”&gt; &lt;/ form&gt; &lt;/ center&gt; &lt;hr&gt; &lt;/ body&gt; &lt;/ html&gt; &lt;％ } else {String v_query = request.getParameter（“v_query”）; String v_publisher = request.getParameter（“v_publisher”）; String v_price = request.getParameter（“v_price”）; String v_op = request.getParameter（“v_op”）; ％&gt; &lt;html&gt; &lt;title&gt;目录搜索&lt;/ title&gt; &lt;body&gt; &lt;center&gt; &lt;form method = post action =“catalogSearch.jsp”&gt;搜索书名：&lt;input type = text name =“v_query”value = &lt;％= v_query％&gt; size = 10&gt;其中，发布者&lt;select name =“v_publisher”&gt; &lt;option value =“ADDISON WESLEY”&gt; ADDISON WESLEY &lt;选项值=“悍马书”&gt;悍马书&lt;选项值=“扳手书” “&gt; WRENCH BOOKS &lt;选项值=”SPOT-ON PUBLISHING“&gt; SPOT-ON PUBLISHING &lt;选项值=”SPINDRIFT BOOKS“&gt; SPINDRIFT BOOKS &lt;选项值=”KLONDIKE BOOKS“&gt; KLONDIKE BOOKS &lt;选项值=”CALAMITY BOOKS“&gt; CALAMITY BOOKS &lt;option value =“IBEX BOOKS INC”&gt; IBEX BOOKS INC &lt;期权价值=“BIG LITTLE BOOKS”&gt; BIG LITTLE BOOKS &lt;/ select&gt;且价格为&lt;select name =“v_op”&gt; &lt;option value =“=” &gt; = &lt;option value =“＆lt;”&gt;＆lt; &lt;option value =“＆gt;”&gt;＆gt; &lt;/ select&gt; &lt;input type = text name =“v_price”value = &lt;％= v_price％&gt; size = 2&gt; &lt;input type = submit value =“Search”&gt; &lt;/ form&gt; &lt;/ center&gt; &lt;％try {DriverManager .registerDriver（new oracle.jdbc.driver。OracleDriver（））; info.put（“user”，“ctxdemo”）; info.put（“password”，“ctxdemo”）; conn = DriverManager.getConnection（connStr，info）; stmt = conn.createStatement（）; String theQuery = request.getParameter（“v_query”）; String thePrice = request.getParameter（“v_price”）; //选择id，title //来自book_catalog //其中catsearch（标题，'Java'，'价格&gt; 10个按价格排序'）&gt; 0 //从book_catalog //中选择标题//其中catsearch（标题，'Java' ，'publisher =''CALAMITY BOOKS''和价格&lt;40 order by price'）&gt; 0 String myQuery =“select book，publisher，price from book_catalog where catsearch（title，'”+ theQuery +“'，'publisher ='' “+ v_publisher +”''和价格“+ v_op + thePrice +”按价格排序'）&gt; 0“; rset = stmt.executeQuery（myQuery）; String color =“ffffff”; String myTitle = null; String myPublisher = null; int myPrice = 0; int items = 0; while（rset.next（））{myTitle =（String）rset.getString（1）; myPublisher =（String）rset.getString（2）; myPrice =（int）rset.getInt（3）;项目++; if（items == 1）{％&gt; &lt;center&gt; &lt;table border =“0”&gt; &lt;tr bgcolor =“＃6699CC”&gt; &lt;th&gt; Title &lt;/ th&gt; &lt;th&gt; Publisher &lt;/ th&gt; &lt;th&gt; Price &lt;/ th&gt; &lt;/ tr&gt; &lt;％}％&gt; &lt;tr bgcolor =“＃&lt;％= color％&gt;”&gt; &lt;td&gt; &lt;％= myTitle％&gt; &lt;/ td&gt; &lt;td&gt; &lt;％= myPublisher％&gt; &lt; / td&gt; &lt;td&gt; $ &lt;％= myPrice％&gt; &lt;/ td&gt; &lt;/ tr&gt; &lt;％if（color.compareTo（“ffffff”）== 0）color =“eeeeee”; else color =“ffffff”; }} catch（SQLException e）{％&gt; &lt;b&gt;错误：&lt;/ b&gt; &lt;％= e％&gt; &lt;p&gt; &lt;％}最后{if（conn！）= null）conn.close（）;如果（stmt！= null）stmt.close（）;如果（rset！= null）rset.close（）; }％&gt; &lt;/ table&gt; &lt;/ center&gt; &lt;/ body&gt; &lt;/ html&gt; &lt;％}％&gt;</pre></div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>