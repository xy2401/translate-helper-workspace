<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>分配频道</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Backup and Recovery Reference"></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Backup and Recovery Reference"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="database-backup-and-recovery-reference.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-09T19:31:58-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2003, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96242-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="ADVISE-FAILURE.html" title="Previous" type="text/html"></link>
      <link rel="next" href="ALLOCATE-CHANNEL-FOR-MAINTENANCE.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database Backup and Recovery Reference"></meta>
    <meta name="dcterms.isVersionOf" content="RCMRF"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="ADVISE-FAILURE.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="ALLOCATE-CHANNEL-FOR-MAINTENANCE.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">备份和恢复参考</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="rman-commands-at-sign-to-quit.html" property="item" typeof="WebPage"><span property="name">RMAN命令：@（at符号）到QUIT</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">分配频道</li>
            </ol>
            <a id="GUID-9320BFF7-0728-4B3D-85B9-2184557ECDCE" name="GUID-9320BFF7-0728-4B3D-85B9-2184557ECDCE"></a><a id="RCMRF89991"></a><a id="RCMRF89992"></a><a id="RCMRF89993"></a><a id="RCMRF89994"></a><a id="RCMRF89995"></a><a id="RCMRF89996"></a><a id="RCMRF89997"></a><a id="RCMRF102"></a>
            
            <h2 id="RCMRF-GUID-9320BFF7-0728-4B3D-85B9-2184557ECDCE" class="sect2"><span class="enumeration_section">2.4</span>分配频道</h2>
         </header>
         <div class="ind">
            <div>
               <div class="section">
                  <p class="subhead1" id="GUID-9320BFF7-0728-4B3D-85B9-2184557ECDCE__GUID-BC43CE5B-5C53-4B55-B4FE-E222A9FD021C">目的</p>
                  <p><a id="d10820e90" class="indexterm-anchor"></a><a id="d10820e94" class="indexterm-anchor"></a><a id="d10820e98" class="indexterm-anchor"></a><a id="d10820e102" class="indexterm-anchor"></a> <code class="codeph">ALLOCATE CHANNEL</code>手动分配一个<strong class="term">通道</strong> ，这是RMAN和数据库实例之间的连接。必须在<code class="codeph"><a href="RUN.html#GUID-88250EEF-DC49-42A9-822C-4011B1345C7B">RUN</a></code>块中发出<code class="codeph">ALLOCATE CHANNEL</code>命令。它仅在发出命令的块中分配通道。
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-9320BFF7-0728-4B3D-85B9-2184557ECDCE__GUID-8349EE1F-730A-41B3-A425-13F050740740">先决条件</p>
                  <p>必须启动目标实例。</p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-9320BFF7-0728-4B3D-85B9-2184557ECDCE__GUID-39924007-2E0D-43AA-9141-0B89B8F59960">使用说明</p>
                  <p>手动分配的通道与使用<code class="codeph"><a href="CONFIGURE.html#GUID-B5094E73-C26C-4FED-AE39-8C2E9540050A">CONFIGURE</a></code>指定的自动分配的通道不同。自动通道适用于您<span class="italic">不</span>手动分配通道的任何RMAN作业。您可以通过在<code class="codeph">RUN</code>命令中手动分配通道来覆盖自动通道配置，但在使用<code class="codeph">ALLOCATE CHANNEL</code>指定手动通道后，不能使用<code class="codeph"><a href="BACKUP.html#GUID-73642FF2-43C5-48B2-9969-99001C52EB50">BACKUP</a></code> <code class="codeph">DEVICE TYPE</code>或<code class="codeph"><a href="RESTORE.html#GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B">RESTORE</a></code> <code class="codeph">DEVICE TYPE</code>来使用自动通道。</p>
                  <p><span class="bold">多个频道</span></p>
                  <p><a id="d10820e163" class="indexterm-anchor"></a><a id="d10820e167" class="indexterm-anchor"></a><a id="d10820e171" class="indexterm-anchor"></a><a id="d10820e175" class="indexterm-anchor"></a><a id="d10820e177" class="indexterm-anchor"></a>您最多可以分配255个频道;每个通道可以并行读取多达64个文件。您可以通过分配的通道数控制作业内的并行度。同时分配多个通道允许单个作业并行读取或写入多个备份集或磁盘副本，每个通道在单独的备份集或副本上运行。
                  </p>
                  <p>在备份到磁盘时，指南是为每个输出设备分配一个通道（参见<a href="ALLOCATE-CHANNEL.html#GUID-9320BFF7-0728-4B3D-85B9-2184557ECDCE__CHDCDCFF">示例2-7</a> ）。但是，如果RMAN正在写入条带文件系统或ASM磁盘组，则多个通道可以提高性能。备份到磁带时，准则是磁带通道数等于磁带设备数除以双工副本数（参见<a href="ALLOCATE-CHANNEL.html#GUID-9320BFF7-0728-4B3D-85B9-2184557ECDCE__CHDGCEDF">示例2-8</a> ）。
                  </p>
                  <p><span class="bold">Oracle RAC环境中的通道</span></p>
                  <p><a id="d10820e190" class="indexterm-anchor"></a><a id="d10820e194" class="indexterm-anchor"></a><a id="d10820e198" class="indexterm-anchor"></a>如果<code class="codeph">SYS</code>和<code class="codeph">SYSBACKUP</code>用户的所有Oracle RAC实例的密码相同，则无需将密码放在<code class="codeph">ALLOCATE</code>或<code class="codeph">CONFIGURE</code>命令的<code class="codeph">CONNECT</code>选项中。如果使用<span class="italic"><code class="codeph">user</code></span> <code class="codeph">@</code> <span class="italic"><code class="codeph">database</code></span>形式的连接字符串，则RMAN会自动使用与RMAN会话启动时用于<code class="codeph">TARGET</code>连接的密码相同的密码。
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-9320BFF7-0728-4B3D-85B9-2184557ECDCE__GUID-90107B22-E26D-4F98-96FA-B92E6DBE4D4F">句法</p>
                  <p><span class="bold"><span class="italic">分配:: =</span></span></p>
                  <div class="figure" id="GUID-9320BFF7-0728-4B3D-85B9-2184557ECDCE__GUID-DE12AD08-3F42-4BC2-88DA-AE48B346A0AE"><img src="img/allocate.gif" alt="allocate.eps的描述如下" title="allocate.eps的描述如下" longdesc="img_text/allocate.html"><br><a href="img_text/allocate.html">allocate.eps插图的说明</a></div>
                  <!-- class="figure" -->
                  <p>（ <span class="italic"><a href="deviceSpecifier.html#GUID-F653748D-4AB5-4A0E-B6E5-D891A000ADAC__BABDEJAC">deviceSpecifier :: =</a></span> ， <span class="italic"><a href="allocOperandList.html#GUID-8B6C1DAB-F27A-4DA8-BECC-5DA04F5907DA__BABFFJCH">allocOperandList :: =</a></span> ）</p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-9320BFF7-0728-4B3D-85B9-2184557ECDCE__GUID-B57A3856-160E-438A-897A-981AA157987A">语义</p>
                  <div class="tblformalwide" id="GUID-9320BFF7-0728-4B3D-85B9-2184557ECDCE__GUID-0333354E-30B8-4C1E-A8C3-2157DDEC9B78">
                     <table cellpadding="4" cellspacing="0" class="FormalWide" title="" width="100%" border="1" summary="Describes ALLOCATE command parameters" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="27%" id="d10820e262">语法元素</th>
                              <th align="left" valign="bottom" width="73%" id="d10820e265">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="27%" id="d10820e270" headers="d10820e262 ">
                                 <p><code class="codeph">辅助</code></p>
                              </td>
                              <td align="left" valign="top" width="73%" headers="d10820e270 d10820e265 ">
                                 <p>指定RMAN与辅助数据库实例之间的连接。</p>
                                 <p>执行<code class="codeph"><a href="DUPLICATE.html#GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4">DUPLICATE</a></code>或<code class="codeph"><a href="TRANSPORT-TABLESPACE.html#GUID-3E1F9103-17E7-40F4-A42C-DED0FB14362D">TRANSPORT TABLESPACE</a></code>命令时以及使用<code class="codeph"><a href="RECOVER.html#GUID-CA98040F-9865-4F4F-BAF2-91C518612E95">RECOVER</a></code> <code class="codeph">TABLESPACE</code>执行TSPITR时使用辅助实例（参见<a href="ALLOCATE-CHANNEL.html#GUID-9320BFF7-0728-4B3D-85B9-2184557ECDCE__CHDIHDBD">例2-9</a> ）。指定此选项时，必须启动辅助实例但不安装。
                                 </p>
                                 <p><span class="bold">另请参阅：</span> <code class="codeph"><a href="DUPLICATE.html#GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4">DUPLICATE</a></code>以了解如何复制数据库，以及<code class="codeph"><a href="CONNECT.html#GUID-64ECF1B8-4F70-413E-BEBE-1D5E8CD48B67">CONNECT</a></code>以了解如何连接到重复的数据库实例</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="27%" id="d10820e314" headers="d10820e262 ">
                                 <p><code class="codeph">CHANNEL</code> <span class="italic"><code class="codeph">channel_id</code></span></p>
                              </td>
                              <td align="left" valign="top" width="73%" headers="d10820e314 d10820e265 ">
                                 <p><a id="d10820e324" class="indexterm-anchor"></a>指定RMAN与目标数据库实例之间的连接。<span class="italic"><code class="codeph">channel_id</code></span>是通道的区分大小写的名称。数据库使用<span class="italic"><code class="codeph">channel_id</code></span>报告I / O错误。
                                 </p>
                                 <p>每个连接都在目标或辅助实例上启动数据库服务器会话：此会话执行备份，还原或恢复RMAN备份的工作。您无法建立与共享服务器会话的连接。</p>
                                 <p><code class="codeph">ALLOCATE CHANNEL</code>是否立即分配操作系统资源取决于操作系统。在某些平台上，在发出命令时分配操作系统资源。在其他平台上，在打开文件进行读取或写入之前，不会分配操作系统资源。
                                 </p>
                                 <p>每个通道一次在一个备份集或映像副本上运行。RMAN会在作业结束时自动释放频道。</p>
                                 <p><span class="bold">注意：</span>您不能将<code class="codeph">ORA_</code>作为通道名称的前缀。RMAN保留以<code class="codeph">ORA_</code>前缀开头的通道名称供自己使用。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="27%" id="d10820e355" headers="d10820e262 ">
                                 <p><code class="codeph">DEVICE TYPE</code> <span class="italic"><a href="deviceSpecifier.html#GUID-F653748D-4AB5-4A0E-B6E5-D891A000ADAC">deviceSpecifier</a></span></p>
                              </td>
                              <td align="left" valign="top" width="73%" headers="d10820e355 d10820e265 ">
                                 <p>指定备份的存储类型。查询<a id="d10820e366" class="indexterm-anchor"></a> <code class="codeph">V$BACKUP_DEVICE</code>视图，了解有关可用设备类型和名称的信息。
                                 </p>
                                 <p><span class="bold">注意：</span>指定<code class="codeph">DEVICE TYPE DISK</code> ，除了创建服务器会话之外，不会分配任何操作系统资源。
                                 </p>
                                 <p><span class="bold">另请参见：</span> <span class="italic"><code class="codeph"><a href="deviceSpecifier.html#GUID-F653748D-4AB5-4A0E-B6E5-D891A000ADAC">deviceSpecifier</a></code></span></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="27%" id="d10820e388" headers="d10820e262 ">
                                 <p><code class="codeph">   </code> <span class="italic"><a href="allocOperandList.html#GUID-8B6C1DAB-F27A-4DA8-BECC-5DA04F5907DA">allocOperandList</a></span></p>
                              </td>
                              <td align="left" valign="top" width="73%" headers="d10820e388 d10820e265 ">
                                 <p>指定已分配通道的控制选项。顺序I / O设备的通道参数是特定于平台的（参见<a href="ALLOCATE-CHANNEL.html#GUID-9320BFF7-0728-4B3D-85B9-2184557ECDCE__CHDIEGIA">例2-6</a> ）。
                                 </p>
                                 <p><span class="bold">另请参见：</span> <code class="codeph"><span class="codeinlineitalic"><a href="allocOperandList.html#GUID-8B6C1DAB-F27A-4DA8-BECC-5DA04F5907DA">allocOperandList</a></span></code></p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-9320BFF7-0728-4B3D-85B9-2184557ECDCE__GUID-613EFE72-01AB-4258-804E-D2239E56CF7B">例子</p>
               </div>
               <!-- class="section" -->
               <div class="example" id="GUID-9320BFF7-0728-4B3D-85B9-2184557ECDCE__CHDIEGIA">
                  <p class="titleinexample">示例2-6手动为备份分配通道</p>
                  <p>此示例为整个数据库和归档重做日志备份分配单个磁带通道。<code class="codeph">PARMS</code>参数指定名为<code class="codeph">wholedb_mf</code>的Oracle Secure Backup介质系列。
                  </p><pre class="oac_no_warn" dir="ltr">RUN {ALLOCATE CHANNEL c1 DEVICE TYPE sbt PARMS'ENV =（OB_MEDIA_FAMILY = wholedb_mf）';备份数据库; BACKUP ARCHIVELOG全部没有备份; }</pre></div>
               <!-- class="example" -->
               <div class="example" id="GUID-9320BFF7-0728-4B3D-85B9-2184557ECDCE__CHDCDCFF">
                  <p class="titleinexample">示例2-7跨多个磁盘分发备份</p>
                  <p><a id="d10820e430" class="indexterm-anchor"></a>备份到磁盘时，可以将备份分布在多个磁盘驱动器上。为每个磁盘驱动器分配一个<code class="codeph">DEVICE TYPE DISK</code>通道，并指定格式字符串，以便输出文件位于不同的磁盘上。
                  </p><pre class="oac_no_warn" dir="ltr">RUN {ALLOCATE CHANNEL disk1 DEVICE TYPE DISK FORMAT'/ disk1 /％U'; ALLOCATE CHANNEL disk2 DEVICE TYPE DISK FORMAT'/ disk2 /％U'; BACKUP DATABASE PLUS ARCHIVELOG; }</pre></div>
               <!-- class="example" -->
               <div class="example" id="GUID-9320BFF7-0728-4B3D-85B9-2184557ECDCE__CHDGCEDF">
                  <p class="titleinexample">示例2-8在磁带上创建备份的多个副本</p>
                  <p><a id="d10820e442" class="indexterm-anchor"></a><a id="d10820e444" class="indexterm-anchor"></a>在此示例中，有四个磁带驱动器可用于写入： <code class="codeph">stape1</code> ， <code class="codeph">stape2</code> ， <code class="codeph">stape3</code>和<code class="codeph">stape4</code> 。您可以使用<code class="codeph"><a href="SET.html#GUID-BC501B5C-4CD0-485D-AA18-27E2894024C3">SET</a></code> <code class="codeph">BACKUP COPIES</code>命令指示RMAN创建两个相同的数据库备份副本。由于准则是磁带通道数等于磁带设备数除以双工副本数，因此您可以分配两个通道。在这种情况下， <code class="codeph">BACKUP_TAPE_IO_SLAVES</code>初始化参数必须设置为<code class="codeph">TRUE</code> 。</p>
                  <p>在Oracle Secure Backup的<code class="codeph">OB_DEVICE_</code> <span class="italic"><code class="codeph">n</code></span>参数中， <span class="italic"><code class="codeph">n</code></span>指定备份片的副本号。RMAN将每个备份片的副本1写入磁带驱动器<code class="codeph">stape1</code>和<code class="codeph">stape2</code> ，并将每个备份片的副本2写入驱动器<code class="codeph">stape3</code>和<code class="codeph">stape4</code> 。因此，数据库备份的每个副本都分布在两个磁带驱动器之间，因此部分数据位于每个驱动器上。
                  </p><pre class="oac_no_warn" dir="ltr">RUN {ALLOCATE CHANNEL t1 DEVICE TYPE sbt PARMS'ENV =（OB_DEVICE_1 = stape1，OB_DEVICE_2 = stape3）'; ALLOCATE CHANNEL t2设备类型sbt PARMS'ENV =（OB_DEVICE_1 = stape2，OB_DEVICE_2 = stape4）'; SET BACKUP COPIES 2;备份数据库; }</pre></div>
               <!-- class="example" -->
               <div class="example" id="GUID-9320BFF7-0728-4B3D-85B9-2184557ECDCE__CHDIHDBD">
                  <p class="titleinexample">例2-9为数据库复制分配辅助通道</p>
                  <p><a id="d10820e507" class="indexterm-anchor"></a><a id="d10820e511" class="indexterm-anchor"></a>此示例从备份创建重复数据库。即使RMAN未指定<code class="codeph">AUXILIARY</code>选项，RMAN也可以使用已配置的通道进行复制。在此示例中，没有预先配置SBT通道，因此手动分配辅助SBT通道。
                  </p><pre class="oac_no_warn" dir="ltr">运行{ALLOCATE AUXILIARY CHANNEL c1 DEVICE TYPE sbt; DUPLICATE TARGET DATABASE到dupdb DB_FILE_NAME_CONVERT'/ disk2 / dbs /'，'/ disk1 /'SPFILE PARAMETER_VALUE_CONVERT'/ disk2 / dbs /'，'/ disk1 /'SET LOG_FILE_NAME_CONVERT'/ disk2 / dbs /'，'/ disk1 /'; }</pre></div>
               <!-- class="example" -->
               <div class="infoboxnotealso" id="GUID-9320BFF7-0728-4B3D-85B9-2184557ECDCE__GUID-2D5840F4-E646-4DE9-9C48-94B3CCA04ED1">
                  <p class="notep1">也可以看看：</p>
                  <p>有关参数<code class="codeph">DB_FILE_NAME_CONVERT</code>更多信息，请<a href="../refrn/DB_FILE_NAME_CONVERT.html#REFRN10038" target="_blank"><span><cite>参见Oracle数据库参考</cite></span></a></p>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>