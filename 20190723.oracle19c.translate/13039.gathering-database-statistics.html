<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>收集数据库统计信息</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Database Performance Tuning Guide"></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Database Performance Tuning Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="database-performance-tuning-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-03-12T22:26:14-07:00"></meta>
      <meta name="dcterms.title" content="Database Performance Tuning Guide"></meta>
      <meta name="dcterms.dateCopyrighted" content="2007, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96347-03"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="measuring-database-performance.html" title="Previous" type="text/html"></link>
      <link rel="next" href="automatic-performance-diagnostics.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="TGDBA"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="measuring-database-performance.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="automatic-performance-diagnostics.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">数据库性能调优指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="part-II-diagnosing-and-tuning-database-performance.html" property="item" typeof="WebPage"><span property="name">诊断和调整数据库性能</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">收集数据库统计信息</li>
            </ol>
            <a id="GUID-CBB1716F-2B20-4575-ADCE-94E33BEA53EF" name="GUID-CBB1716F-2B20-4575-ADCE-94E33BEA53EF"></a>
            
            <h2 id="TGDBA-GUID-CBB1716F-2B20-4575-ADCE-94E33BEA53EF" class="sect2"><span class="enumeration_chapter">6</span>收集数据库统计信息</h2>
         </header>
         <div class="ind">
            <div>
               <p>本章介绍如何收集Oracle数据库的数据库统计信息，并包含以下主题：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="gathering-database-statistics.html#GUID-56AEF38E-9400-427B-A818-EDEC145F7ACD">关于收集数据库统计信息</a></p>
                  </li>
                  <li>
                     <p><a href="gathering-database-statistics.html#GUID-9D3A3890-8E68-48C5-84D0-DB0A8D93C53A" title="您可以调整间隔，保留期和顶级SQL的数量以刷新快照生成，但请注意，这会影响Oracle数据库诊断工具的精度。Oracle数据库使您可以在系统之间传输AWR数据。这在您希望使用单独的系统执行AWR数据分析的情况下非常有用，以便减少生产系统上性能分析所导致的开销。集中式自动工作负载存储库（AWR）在多租户环境中存储与CDB和PDB相关的性能数据。在多租户环境中，AWR数据分为不同的类别。">管理自动工作负载存储库</a></p>
                  </li>
                  <li>
                     <p><a href="gathering-database-statistics.html#GUID-9BFC6383-6C4F-4103-A2CB-4713802F2669">生成自动工作负载存储库报告</a></p>
                  </li>
                  <li>
                     <p><a href="gathering-database-statistics.html#GUID-23061F14-767D-47B6-9B45-D1E26FB1E075">生成性能中心活动报告</a></p>
                  </li>
               </ul>
            </div><a id="TGDBA167"></a><a id="TGDBA168"></a><div class="props_rev_3"><a id="GUID-56AEF38E-9400-427B-A818-EDEC145F7ACD" name="GUID-56AEF38E-9400-427B-A818-EDEC145F7ACD"></a><h3 id="TGDBA-GUID-56AEF38E-9400-427B-A818-EDEC145F7ACD" class="sect3"><span class="enumeration_section">6.1</span>关于收集数据库统计信息</h3>
               <div>
                  <p>Oracle数据库自动保留自动工作负载存储库（AWR）中所有级别（会话级别除外）的大多数统计信息的累积值和增量值。此过程在常规时间段内重复，结果将在AWR快照中捕获。快照捕获的增量值表示该时间段内每个统计信息的更改。</p>
                  <p>统计基线是通常在系统以最佳水平表现良好的时间段内采用的统计率的集合。使用统计基线通过比较基线中捕获的统计信息与性能不佳期间捕获的统计信息来诊断性能问题。这使您可以识别可能显着增加的特定统计信息，并可能是问题的原因。AWR支持捕获基线数据，使您能够指定并保留一对或一系列AWR快照作为基线。</p>
                  <p>度量标准通常是累积统计量的变化率。您可以针对各种单位测量此费率，包括时间，交易或数据库调用。例如，每秒数字数据库调用是一个指标。度量值在某些<code class="codeph">V$</code>视图中公开，其中值是相当小的时间间隔（通常为60秒）内的平均值。通过<code class="codeph">V$</code>视图可以获得最近度量值的历史记录，AWR快照也会保留一些数据。
                  </p>
                  <p>以下部分介绍了各种Oracle数据库功能，使您能够更有效地收集数据库统计信息：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="gathering-database-statistics.html#GUID-CE73D449-0EE9-4022-B1F1-AA12F0955C03">自动工作负载存储库</a></p>
                     </li>
                     <li>
                        <p><a href="gathering-database-statistics.html#GUID-A64AE148-DFB9-4B5F-BAA8-6A4A575E79DF">快照</a></p>
                     </li>
                     <li>
                        <p><a href="gathering-database-statistics.html#GUID-C6401C10-F958-4339-99C2-3320BDAB4CEA">基线</a></p>
                     </li>
                     <li>
                        <p><a href="gathering-database-statistics.html#GUID-6C74FDE0-FF92-4605-82DB-9FA598E59407">空间消耗</a></p>
                     </li>
                     <li>
                        <p><a href="gathering-database-statistics.html#GUID-6450312A-8894-4648-8DC3-83C83F6995F3">自适应阈值</a></p>
                     </li>
                  </ul>
                  <div class="infoboxnote" id="GUID-56AEF38E-9400-427B-A818-EDEC145F7ACD__GUID-9B1DA07F-EC37-4FB4-A9B7-E543BD114AA2">
                     <p class="notep1">注意：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>将AWR功能与可插拔数据库（PDB）一起使用时，数据可见性和权限要求可能会有所不同。有关可管理性功能（包括AWR功能）如何在多租户容器数据库（CDB）中工作的信息，请参阅<a href="../multi/administering-a-cdb-with-sql-plus.html#MULTI-GUID-DF42C0D3-8968-4810-9327-9D176337D356" target="_blank"><span class="italic">Oracle Multitenant管理员指南</span></a> 。
                           </p>
                        </li>
                        <li>
                           <p>需要Oracle Diagnostic Pack许可才能使用本章中介绍的AWR功能。</p>
                        </li>
                     </ul>
                  </div>
               </div><a id="TGDBA169"></a><div class="props_rev_3"><a id="GUID-CE73D449-0EE9-4022-B1F1-AA12F0955C03" name="GUID-CE73D449-0EE9-4022-B1F1-AA12F0955C03"></a><h4 id="TGDBA-GUID-CE73D449-0EE9-4022-B1F1-AA12F0955C03" class="sect4"><span class="enumeration_section">6.1.1</span>自动工作负载存储库</h4>
                  <div>
                     <p>AWR收集，处理和维护性能统计信息，以便进行问题检测和自我调整。收集的数据存储在内存和数据库中，并显示在报表和视图中。</p>
                     <p>AWR收集和处理的统计数据包括：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>确定数据库段的访问和使用统计信息的对象统计信息</p>
                        </li>
                        <li>
                           <p>基于活动时间使用的时间模型统计信息，显示在<code class="codeph">V$SYS_TIME_MODEL</code>和<code class="codeph">V$SESS_TIME_MODEL</code>视图中</p>
                        </li>
                        <li>
                           <p>在<code class="codeph">V$SYSSTAT</code>和<code class="codeph">V$SESSTAT</code>视图中收集的一些系统和会话统计<code class="codeph">V$SYSSTAT</code></p>
                        </li>
                        <li>
                           <p>根据经过时间和CPU时间等条件，在系统上产生最高负载的SQL语句</p>
                        </li>
                        <li>
                           <p>活动会话历史记录（ASH）统计信息，表示最近会话活动的历史记录</p>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-CE73D449-0EE9-4022-B1F1-AA12F0955C03__GUID-FA71697E-E16C-40EA-8CF0-EFD0C55EA8DE">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>有关各种类型的数据库统计信息，请参阅<span class="q">“ <a href="measuring-database-performance.html#GUID-D106A7A3-1B96-47E7-883C-2BB0F11567E1">关于数据库统计</a></span>信息<span class="q">”</span></p>
                           </li>
                           <li>
                              <p>有关视图<code class="codeph">V$SYS_TIME_MODEL</code> ， <code class="codeph">V$SESS_TIME_MODEL</code> ， <code class="codeph">V$SYSSTAT</code>和<code class="codeph">V$SESSTAT</code>更多信息，请<a href="../refrn/index.html" target="_blank"><span class="italic">参见Oracle数据库参考</span></a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="TGDBA170"></a><div class="props_rev_3"><a id="GUID-A64AE148-DFB9-4B5F-BAA8-6A4A575E79DF" name="GUID-A64AE148-DFB9-4B5F-BAA8-6A4A575E79DF"></a><h4 id="TGDBA-GUID-A64AE148-DFB9-4B5F-BAA8-6A4A575E79DF" class="sect4"><span class="enumeration_section">6.1.2</span>快照</h4>
                  <div>
                     <p><a id="d11457e348" class="indexterm-anchor"></a>快照是特定时间段的历史数据集，用于通过自动数据库诊断监视器（ADDM）进行性能比较。默认情况下，Oracle数据库每小时自动生成一次性能数据快照，并在AWR中保留8天的统计信息。您也可以手动创建快照或更改快照保留期，但通常不需要。
                     </p>
                     <p>AWR比较快照之间的差异，以根据对系统负载的影响确定要捕获的SQL语句。这减少了必须随时间捕获的SQL语句的数量。创建快照后，ADDM会分析快照中捕获的数据以执行其性能分析。</p>
                     <div class="infoboxnotealso" id="GUID-A64AE148-DFB9-4B5F-BAA8-6A4A575E79DF__GUID-8828CE63-56E1-4349-BF30-BEC434C492A3">
                        <p class="notep1">也可以看看：</p>
                        <p>有关管理快照的信息，请参阅<span class="q">“ <a href="gathering-database-statistics.html#GUID-144711F9-85AE-4281-B548-3E01280F9A56" title="您可以调整间隔，保留期和顶级SQL的数量以刷新快照生成，但请注意，这会影响Oracle数据库诊断工具的精度。">管理快照</a> ”</span></p>
                     </div>
                  </div>
               </div><a id="TGDBA171"></a><div class="props_rev_3"><a id="GUID-C6401C10-F958-4339-99C2-3320BDAB4CEA" name="GUID-C6401C10-F958-4339-99C2-3320BDAB4CEA"></a><h4 id="TGDBA-GUID-C6401C10-F958-4339-99C2-3320BDAB4CEA" class="sect4"><span class="enumeration_section">6.1.3</span>基线</h4>
                  <div>
                     <p>一个<a id="d11457e417" class="indexterm-anchor"></a> baseline是一组特定时间段内的快照，保留这些快照以便在出现性能问题时与其他快照进行比较。基线中包含的快照将从自动AWR清除过程中排除，并将无限期保留。
                     </p>
                     <p>有几种类型的可用基线：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="gathering-database-statistics.html#GUID-9855A86D-0A2C-413B-8980-490E96A062B3">固定基线</a></p>
                        </li>
                        <li>
                           <p><a href="gathering-database-statistics.html#GUID-91C614C3-5B49-4DD9-90B5-A38F3D6AAD62">移动窗口基线</a></p>
                        </li>
                        <li>
                           <p><a href="gathering-database-statistics.html#GUID-BC0E898A-5AE3-4305-9F74-C24EE5F288DF">基线模板</a></p>
                        </li>
                     </ul>
                  </div><a id="TGDBA172"></a><div class="props_rev_3"><a id="GUID-9855A86D-0A2C-413B-8980-490E96A062B3" name="GUID-9855A86D-0A2C-413B-8980-490E96A062B3"></a><h5 id="TGDBA-GUID-9855A86D-0A2C-413B-8980-490E96A062B3" class="sect5"><span class="enumeration_section">6.1.3.1</span>固定基线</h5>
                     <div>
                        <p>固定基线对应于您指定的过去固定的连续时间段。在创建固定基线之前，请仔细考虑您选择的基准时间段，因为基线应代表系统在最佳水平运行。将来，您可以将基线与在性能不佳期间捕获的其他基准或快照进行比较，以分析性能随时间的降低。</p>
                        <div class="infoboxnotealso" id="GUID-9855A86D-0A2C-413B-8980-490E96A062B3__GUID-15C41FDC-ECE0-446E-B7E1-E5B537B3A00A">
                           <p class="notep1">也可以看看：</p>
                           <p>有关管理固定基准的信息，请参阅<span class="q">“ <a href="gathering-database-statistics.html#GUID-44811EF8-D082-487F-8EEC-DA6E78700E68">管理基准</a> ”</span></p>
                        </div>
                     </div>
                  </div><a id="TGDBA173"></a><div class="props_rev_3"><a id="GUID-91C614C3-5B49-4DD9-90B5-A38F3D6AAD62" name="GUID-91C614C3-5B49-4DD9-90B5-A38F3D6AAD62"></a><h5 id="TGDBA-GUID-91C614C3-5B49-4DD9-90B5-A38F3D6AAD62" class="sect5"><span class="enumeration_section">6.1.3.2</span>移动窗口基线</h5>
                     <div>
                        <p>移动窗口基线对应于AWR保留期内存在的所有AWR数据。这在使用自适应阈值时非常有用，因为数据库可以在整个AWR保留期内使用AWR数据来计算度量阈值。</p>
                        <p>Oracle数据库自动维护系统定义的移动窗口基线。系统定义的移动窗口基线的默认窗口大小是当前AWR保留期，默认为8天。如果您计划使用自适应阈值，请考虑使用更大的移动窗口（例如30天）来准确计算阈值。您可以通过将移动窗口中的天数更改为等于或小于AWR保留期中的天数的值来调整移动窗口基线的大小。因此，要增加移动窗口的大小，必须首先相应地增加AWR保留期。</p>
                        <div class="infoboxnotealso" id="GUID-91C614C3-5B49-4DD9-90B5-A38F3D6AAD62__GUID-610550A1-6F5D-4E73-A4C8-DEB5796BFFFC">
                           <p class="notep1">也可以看看：</p>
                           <p><span class="q">“ <a href="gathering-database-statistics.html#GUID-FFB695C6-E57A-487D-898A-EDAF0ECDD881">调整默认移动窗口基线的</a></span>大小<span class="q">”</span>以获取有关调整移动窗口基线大小的信息</p>
                        </div>
                     </div>
                  </div><a id="TGDBA174"></a><div class="props_rev_3"><a id="GUID-BC0E898A-5AE3-4305-9F74-C24EE5F288DF" name="GUID-BC0E898A-5AE3-4305-9F74-C24EE5F288DF"></a><h5 id="TGDBA-GUID-BC0E898A-5AE3-4305-9F74-C24EE5F288DF" class="sect5"><span class="enumeration_section">6.1.3.3</span>基线模板</h5>
                     <div>
                        <p>通过基准模板，您可以在将来为连续的时间段创建基准。有两种类型的基线模板：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="gathering-database-statistics.html#GUID-55C09FAB-9DCD-4EC8-BE2F-5B99125387B7">单基线模板</a></p>
                           </li>
                           <li>
                              <p><a href="gathering-database-statistics.html#GUID-A07D8B81-2451-4513-8885-42504DD680C1">重复基准模板</a></p>
                           </li>
                        </ul>
                        <div class="infoboxnotealso" id="GUID-BC0E898A-5AE3-4305-9F74-C24EE5F288DF__GUID-19B6C0FB-9FCF-4F16-ABBF-24E5EEFACD3C">
                           <p class="notep1">也可以看看：</p>
                           <p><span class="q">“ <a href="gathering-database-statistics.html#GUID-B5DB2422-951F-4D00-A473-AB6739ECC88B">管理基准模板</a> ”</span>以获取有关管理基准模板的信息</p>
                        </div>
                     </div><a id="TGDBA175"></a><div class="props_rev_3"><a id="GUID-55C09FAB-9DCD-4EC8-BE2F-5B99125387B7" name="GUID-55C09FAB-9DCD-4EC8-BE2F-5B99125387B7"></a><h6 id="TGDBA-GUID-55C09FAB-9DCD-4EC8-BE2F-5B99125387B7" class="sect6"><span class="enumeration_section">6.1.3.3.1</span>单基线模板</h6>
                        <div>
                           <p>使用单个基准模板为将来的单个连续时间段创建基准。如果您事先知道将来要捕获的时间段，这将非常有用。例如，您可能希望在为即将到来的周末安排的系统测试期间捕获AWR数据。在这种情况下，您可以创建单个基线模板以自动捕获测试发生的时间段。</p>
                        </div>
                     </div><a id="TGDBA176"></a><div class="props_rev_3"><a id="GUID-A07D8B81-2451-4513-8885-42504DD680C1" name="GUID-A07D8B81-2451-4513-8885-42504DD680C1"></a><h6 id="TGDBA-GUID-A07D8B81-2451-4513-8885-42504DD680C1" class="sect6"><span class="enumeration_section">6.1.3.3.2</span>重复基线模板</h6>
                        <div>
                           <p>使用重复基线模板根据重复时间表创建和删除基线。如果您希望Oracle数据库持续自动捕获连续的时间段，这将非常有用。例如，您可能希望在每个星期一早上捕获一个月的AWR数据。在这种情况下，您可以创建重复基线模板，以便在每个星期一的重复计划中自动创建基线，并在指定的到期间隔（例如一个月）后自动删除旧基线。</p>
                        </div>
                     </div>
                  </div>
               </div><a id="TGDBA187"></a><div class="props_rev_3"><a id="GUID-6C74FDE0-FF92-4605-82DB-9FA598E59407" name="GUID-6C74FDE0-FF92-4605-82DB-9FA598E59407"></a><h4 id="TGDBA-GUID-6C74FDE0-FF92-4605-82DB-9FA598E59407" class="sect4"><span class="enumeration_section">6.1.4</span>空间消耗</h4>
                  <div>
                     <p>AWR消耗的空间由几个因素决定：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>任何给定时间数据库中的活动会话数</p>
                        </li>
                        <li>
                           <p>快照间隔</p>
                           <p>快照间隔确定捕获快照的频率。较小的快照间隔会增加频率，从而增加AWR收集的数据量。</p>
                        </li>
                        <li>
                           <p>历史数据保留期</p>
                           <p>保留期决定了数据在清除之前保留的时间。较长的保留期会增加AWR消耗的空间。</p>
                        </li>
                     </ul>
                     <p>默认情况下，Oracle数据库每小时捕获一次快照，并将其保留在数据库中8天。使用这些默认设置，平均具有10个并发活动会话的典型系统可能需要大约200到300 MB的空间用于其AWR数据。</p>
                     <p>要减少AWR空间消耗，请增加快照间隔并缩短保留期。在减少保留期限时，请注意多个Oracle数据库自我管理功能依赖于AWR数据才能正常运行。没有足够的数据会影响这些组件和功能的有效性和准确性，包括：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>自动数据库诊断监视器（ADDM）</p>
                        </li>
                        <li>
                           <p>SQL Tuning Advisor</p>
                        </li>
                        <li>
                           <p>撤消顾问</p>
                        </li>
                        <li>
                           <p>细分顾问</p>
                        </li>
                     </ul>
                     <p>如果可能，Oracle建议您将AWR保留期设置得足够大，以捕获至少一个完整的工作负载周期。如果您的系统遇到每周工作负载周期，例如工作日期间的OLTP工作负载和周末期间的批处理作业，则您无需更改8天的默认AWR保留期。但是，如果您的系统在月末结账期间遇到月度峰值负载，则可能需要将保留期设置为一个月。</p>
                     <p>在特殊情况下，您可以通过将快照间隔设置为0来禁用自动快照收集。在这种情况下，将停止自动收集工作负载和统计数据，并且大多数Oracle数据库自我管理功能都无法运行。此外，您无法手动创建快照。因此，Oracle强烈建议不要禁用自动快照收集。</p>
                     <div class="infoboxnote" id="GUID-6C74FDE0-FF92-4605-82DB-9FA598E59407__GUID-60A39E12-D5B8-4942-B886-296B6B0F89FD">
                        <p class="notep1">注意：</p>
                        <p>默认情况下，Oracle数据库使用<code class="codeph">SYSAUX</code>表空间来存储AWR数据。从Oracle Database 19c开始，您可以指定任何其他表空间来存储AWR数据，以避免<code class="codeph">SYSAUX</code>表空间过载。
                        </p>
                     </div>
                     <div class="infoboxnotealso" id="GUID-6C74FDE0-FF92-4605-82DB-9FA598E59407__GUID-A6447C91-65FB-47F4-BB53-2C2327B177D4">
                        <p class="notep1">也可以看看：</p>
                        <p><span class="q">“ <a href="gathering-database-statistics.html#GUID-62D01B30-2687-4821-A651-DC0E4AAC3B01" title="您可以调整间隔，保留期和顶级SQL的数量以刷新快照生成，但请注意，这会影响Oracle数据库诊断工具的精度。">修改快照设置</a> ”</span>以获取有关更改快照间隔和保留期的默认值的信息</p>
                     </div>
                  </div>
               </div><a id="TGDBA177"></a><div class="props_rev_3"><a id="GUID-6450312A-8894-4648-8DC3-83C83F6995F3" name="GUID-6450312A-8894-4648-8DC3-83C83F6995F3"></a><h4 id="TGDBA-GUID-6450312A-8894-4648-8DC3-83C83F6995F3" class="sect4"><span class="enumeration_section">6.1.5</span>自适应阈值</h4>
                  <div>
                     <p>自适应阈值使您能够监视和检测性能问题，同时最大限度地减少管理开销。自适应阈值使用从移动窗口基线中捕获的度量值导出的统计信息，自动为某些系统度量标准设置警告和严重警报阈值。这些阈值的统计数据每周重新计算一次，随着系统性能的不断发展，可能会产生新的阈值。另外，自适应阈值可以基于周期性工作负载模式计算一天或一周的不同时间的不同阈值。</p>
                     <p>例如，许多数据库在白天支持在线事务处理（OLTP）工作负载，在夜间支持批处理。每个事务响应时间的性能指标可用于检测白天OLTP性能的下降。但是，对于批量工作负载而言，有用的OLTP阈值通常太低，而长时间运行的事务可能很常见。因此，适合于OLTP的阈值可能会在批处理期间触发频繁的错误性能警报。自适应阈值可以检测此类工作负载模式，并自动为白天和夜晚设置不同的阈值。</p>
                     <p>有两种类型的自适应阈值：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="gathering-database-statistics.html#GUID-5B32060C-1752-4ACC-AB45-1CBE76DE53E9">最大阈值百分比</a></p>
                        </li>
                        <li>
                           <p><a href="gathering-database-statistics.html#GUID-145777F9-E316-4663-B847-042F2A85B144">显着性水平阈值</a></p>
                        </li>
                     </ul>
                  </div><a id="TGDBA178"></a><div class="props_rev_3"><a id="GUID-5B32060C-1752-4ACC-AB45-1CBE76DE53E9" name="GUID-5B32060C-1752-4ACC-AB45-1CBE76DE53E9"></a><h5 id="TGDBA-GUID-5B32060C-1752-4ACC-AB45-1CBE76DE53E9" class="sect5"><span class="enumeration_section">6.1.5.1</span>最大阈值百分比</h5>
                     <div>
                        <p>最大阈值百分比的阈值被计算为在移动窗口基线中观察到的数据的最大值的百分比倍数。</p>
                        <p>当系统的大小适合峰值工作负载时，最大阈值百分比最有用，并且您希望在当前工作负载量接近或超过先前的高值时收到警报。具有未知但明确限制值的度量标准是这些设置的主要候选者。例如，每秒生成的重做度量通常是最大阈值百分比的良好候选。</p>
                     </div>
                  </div><a id="TGDBA179"></a><div class="props_rev_3"><a id="GUID-145777F9-E316-4663-B847-042F2A85B144" name="GUID-145777F9-E316-4663-B847-042F2A85B144"></a><h5 id="TGDBA-GUID-145777F9-E316-4663-B847-042F2A85B144" class="sect5"><span class="enumeration_section">6.1.5.2</span>显着性水平阈值</h5>
                     <div>
                        <p>显着性水平阈值的阈值被设置为统计百分位数，其表示基于移动窗口基线中的数据观察高于阈值的值的异常程度。</p>
                        <p>显着性水平阈值对于在系统正常运行时表现出统计上稳定行为的指标最有用，但在系统性能不佳时可能会在很大范围内变化。例如，对于经过良好调整的OLTP系统，每个事务响应时间度量标准应该是稳定的，但在出现性能问题时可能会波动很大。显着性级别阈值用于在条件产生异常度量值和异常系统性能时生成警报。</p>
                        <p>显着性阈值可以设置为以下级别之一：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>高（.95）</p>
                              <p>预计100个观测值中只有5个超过该值。</p>
                           </li>
                           <li>
                              <p>很高（.99）</p>
                              <p>预计100个观测值中只有1个会超过此值。</p>
                           </li>
                           <li>
                              <p>严重（.999）</p>
                              <p>预计1,000个观测值中只有1个会超过该值。</p>
                           </li>
                           <li>
                              <p>极端（.9999）</p>
                              <p>预计10,000个观测值中只有1个超过该值。</p>
                           </li>
                        </ul>
                        <p>指定显着性级别阈值时，Oracle数据库会执行内部计算以设置阈值。在某些情况下，Oracle数据库无法使用基线中的数据在较高显着性级别建立阈值，并且未设置显着性级别阈值。</p>
                        <p>如果您指定了严重（.999）或极端（.9999）显着性水平阈值且未按预期接收警报，请尝试将显着性水平阈值设置为较低的值，例如极高（.99）或高（.95） ）。或者，请考虑使用最大阈值的百分比。如果更改阈值并发现收到的警报太多，请尝试增加触发警报的次数。</p>
                        <div class="infoboxnote" id="GUID-145777F9-E316-4663-B847-042F2A85B144__GUID-81E67E00-D34E-41C8-92E1-C6303C179B47">
                           <p class="notep1">注意：</p>
                           <p>管理基准指标的主要界面是Oracle企业管理器云控制（云控制）。要为基准度量标准创建自适应阈值，请使用“ <a href="../tdppt/resolving-performance-degradation-over-time.html#TDPPT334" target="_blank"><span class="italic">Oracle数据库2日+性能调整指南”中</span></a>所述的云控制。
                           </p>
                        </div>
                        <div class="infoboxnotealso" id="GUID-145777F9-E316-4663-B847-042F2A85B144__GUID-F36B9899-CC9C-43FE-B6D1-7C9FC764219F">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>有关移动窗口基线的信息，请参阅<span class="q">“ <a href="gathering-database-statistics.html#GUID-91C614C3-5B49-4DD9-90B5-A38F3D6AAD62">移动窗口基线</a> ”</span></p>
                              </li>
                              <li>
                                 <p>有关管理基线指标的信息，请参阅<span class="q">“ <a href="gathering-database-statistics.html#GUID-44811EF8-D082-487F-8EEC-DA6E78700E68">管理基准</a> ”</span></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div>
               </div>
            </div><a id="TGDBA185"></a><div class="props_rev_3"><a id="GUID-9D3A3890-8E68-48C5-84D0-DB0A8D93C53A" name="GUID-9D3A3890-8E68-48C5-84D0-DB0A8D93C53A"></a><h3 id="TGDBA-GUID-9D3A3890-8E68-48C5-84D0-DB0A8D93C53A" class="sect3"><span class="enumeration_section">6.2</span>管理自动工作负载存储库</h3>
               <div>
                  <p>本节介绍如何管理Oracle数据库的AWR功能，并包含以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="gathering-database-statistics.html#GUID-26D359FA-F809-4444-907C-B5AFECD9AE29">启用自动工作负载存储库</a></p>
                     </li>
                     <li>
                        <p><a href="gathering-database-statistics.html#GUID-144711F9-85AE-4281-B548-3E01280F9A56" title="您可以调整间隔，保留期和顶级SQL的数量以刷新快照生成，但请注意，这会影响Oracle数据库诊断工具的精度。">管理快照</a></p>
                     </li>
                     <li>
                        <p><a href="gathering-database-statistics.html#GUID-44811EF8-D082-487F-8EEC-DA6E78700E68">管理基准</a></p>
                     </li>
                     <li>
                        <p><a href="gathering-database-statistics.html#GUID-B5DB2422-951F-4D00-A473-AB6739ECC88B">管理基准模板</a></p>
                     </li>
                     <li>
                        <p><a href="gathering-database-statistics.html#GUID-F25470A0-C236-46DE-84F7-D68FBE1B0F12" title="Oracle数据库使您可以在系统之间传输AWR数据。这在您希望使用单独的系统执行AWR数据分析的情况下非常有用，以便减少生产系统上性能分析所导致的开销。">将自动工作负载存储库数据传输到另一个系统</a></p>
                     </li>
                     <li>
                        <p><a href="gathering-database-statistics.html#GUID-18E1B278-B3C5-4FE1-8E51-BC8878C439F5">使用自动工作负载存储库视图</a></p>
                     </li>
                     <li>
                        <p><a href="gathering-database-statistics.html#GUID-D64AEB01-18FF-47EF-BB5C-A0611117D180" title="集中式自动工作负载存储库（AWR）在多租户环境中存储与CDB和PDB相关的性能数据。">在多租户环境中管理自动工作负载存储库</a></p>
                     </li>
                     <li>
                        <p><a href="gathering-database-statistics.html#GUID-309C107F-DC42-4119-9904-9504E9748B84">在Active Data Guard备用数据库中管理自动工作负载存储库</a></p>
                     </li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-9D3A3890-8E68-48C5-84D0-DB0A8D93C53A__GUID-34657870-039E-4272-822B-29466028668F">
                     <p class="notep1">也可以看看：</p>
                     <p><span class="q">“ <a href="gathering-database-statistics.html#GUID-CE73D449-0EE9-4022-B1F1-AA12F0955C03">自动工作负载存储库</a> ”，</span>用于描述AWR</p>
                  </div>
               </div><a id="TGDBA186"></a><div class="props_rev_3"><a id="GUID-26D359FA-F809-4444-907C-B5AFECD9AE29" name="GUID-26D359FA-F809-4444-907C-B5AFECD9AE29"></a><h4 id="TGDBA-GUID-26D359FA-F809-4444-907C-B5AFECD9AE29" class="sect4"><span class="enumeration_section">6.2.1</span>启用自动工作负载存储库</h4>
                  <div>
                     <div class="section">
                        <p><a id="d11457e1236" class="indexterm-anchor"></a>默认情况下启用使用AWR收集数据库统计信息，并由<code class="codeph">STATISTICS_LEVEL</code>初始化参数控制。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-26D359FA-F809-4444-907C-B5AFECD9AE29__GUID-DD3E22CF-F0CF-4B77-91B8-E2D6FE1C97E2">要通过AWR启用统计信息收集：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>将<code class="codeph">STATISTICS_LEVEL</code>参数设置为<code class="codeph">TYPICAL</code>或<code class="codeph">ALL</code> 。</p>
                              <p>此参数的默认设置为<code class="codeph">TYPICAL</code> 。</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>将<code class="codeph">STATISTICS_LEVEL</code>设置为<code class="codeph">BASIC</code>会禁用许多Oracle数据库功能，包括AWR，因此不建议这样做。如果<code class="codeph">STATISTICS_LEVEL</code>设置为<code class="codeph">BASIC</code> ，您仍然可以使用<code class="codeph">DBMS_WORKLOAD_REPOSITORY</code>包手动捕获AWR统计信息。但是，由于将禁用许多系统统计信息（例如段统计信息和内存顾问信息）的内存中收集，因此在这些快照中捕获的统计信息可能不完整。
                        </p>
                        <div class="infoboxnotealso" id="GUID-26D359FA-F809-4444-907C-B5AFECD9AE29__GUID-9DC1D01A-774D-4DC0-A429-40884F4A4E90">
                           <p class="notep1">也可以看看：</p>
                           <p>有关<code class="codeph">STATISTICS_LEVEL</code>初始化参数的信息，请<a href="../refrn/STATISTICS_LEVEL.html#REFRN10214" target="_blank"><span class="italic">参见Oracle数据库参考</span></a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="TGDBA188"></a><div class="props_rev_3"><a id="GUID-144711F9-85AE-4281-B548-3E01280F9A56" name="GUID-144711F9-85AE-4281-B548-3E01280F9A56"></a><h4 id="TGDBA-GUID-144711F9-85AE-4281-B548-3E01280F9A56" class="sect4"><span class="enumeration_section">6.2.2</span>管理快照</h4>
                  <div>
                     <p>默认情况下，Oracle数据库每小时生成一次快照，并将工作负载存储库中的统计信息保留8天。必要时，您可以手动创建或删除快照并修改快照设置。</p>
                     <p>本节介绍如何管理快照，并包含以下主题：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="gathering-database-statistics.html#GUID-1BD04654-3D24-42DA-96A5-9FCAED77439D">用于管理快照的用户界面</a></p>
                        </li>
                        <li>
                           <p><a href="gathering-database-statistics.html#GUID-70A79E56-18AB-4E85-9494-C0C8F02320AF">创建快照</a></p>
                        </li>
                        <li>
                           <p><a href="gathering-database-statistics.html#GUID-542ED7D0-ABED-48F4-9D2F-5DADEB610249">删除快照</a></p>
                        </li>
                        <li>
                           <p><a href="gathering-database-statistics.html#GUID-62D01B30-2687-4821-A651-DC0E4AAC3B01" title="您可以调整间隔，保留期和顶级SQL的数量以刷新快照生成，但请注意，这会影响Oracle数据库诊断工具的精度。">修改快照设置</a></p>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-144711F9-85AE-4281-B548-3E01280F9A56__GUID-E0B4A412-24D7-4C75-BB17-0DFB5643F7A7">
                        <p class="notep1">也可以看看：</p>
                        <p>有关快照的信息的<span class="q">“ <a href="gathering-database-statistics.html#GUID-A64AE148-DFB9-4B5F-BAA8-6A4A575E79DF">快照</a> ”</span></p>
                     </div>
                  </div><a id="TGDBA189"></a><div class="props_rev_3"><a id="GUID-1BD04654-3D24-42DA-96A5-9FCAED77439D" name="GUID-1BD04654-3D24-42DA-96A5-9FCAED77439D"></a><h5 id="TGDBA-GUID-1BD04654-3D24-42DA-96A5-9FCAED77439D" class="sect5"><span class="enumeration_section">6.2.2.1</span>管理快照的用户界面</h5>
                     <div>
                        <p>管理快照的主要界面是Oracle企业管理器云控制（云控制）。您应尽可能使用Cloud Control管理快照。</p>
                        <p>如果Cloud Control不可用，则使用命令行界面中的<code class="codeph">DBMS_WORKLOAD_REPOSITORY</code>包管理快照。需要DBA角色来调用<code class="codeph">DBMS_WORKLOAD_REPOSITORY</code>过程。
                        </p>
                        <div class="infoboxnotealso" id="GUID-1BD04654-3D24-42DA-96A5-9FCAED77439D__GUID-B1F12ADB-CFAC-4100-9F8F-924398E299F3">
                           <p class="notep1">也可以看看：</p>
                           <p>有关<code class="codeph">DBMS_WORKLOAD_REPOSITORY</code>包的信息，请<code class="codeph">DBMS_WORKLOAD_REPOSITORY</code> <a href="../arpls/DBMS_WORKLOAD_REPOSITORY.html#ARPLS093" target="_blank"><span class="italic">Oracle Database PL / SQL包和类型参考</span></a></p>
                        </div>
                     </div>
                  </div><a id="TGDBA665"></a><a id="TGDBA190"></a><div class="props_rev_3"><a id="GUID-70A79E56-18AB-4E85-9494-C0C8F02320AF" name="GUID-70A79E56-18AB-4E85-9494-C0C8F02320AF"></a><h5 id="TGDBA-GUID-70A79E56-18AB-4E85-9494-C0C8F02320AF" class="sect5"><span class="enumeration_section">6.2.2.2</span>创建快照</h5>
                     <div>
                        <div class="section">
                           <p>默认情况下，Oracle数据库每小时自动生成一次快照。但是，您可能希望手动创建快照以捕获与自动生成的快照不同的统计信息。</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-70A79E56-18AB-4E85-9494-C0C8F02320AF__GUID-11EE5FFB-0937-467D-97E4-083D9F4CF15C">使用命令行界面创建快照</p>
                           <p>要手动创建快照，请使用<code class="codeph">CREATE_SNAPSHOT</code>过程。以下示例显示了<code class="codeph">CREATE_SNAPSHOT</code>过程调用。
                           </p><pre class="pre codeblock"><code>BEGIN DBMS_WORKLOAD_REPOSITORY.CREATE_SNAPSHOT（）;结束; /</code></pre><p>在此示例中，将立即在本地数据库实例上创建快照。要查看有关现有快照的信息，请使用<code class="codeph">DBA_HIST_SNAPSHOT</code>视图。
                           </p>
                           <div class="infoboxnote" id="GUID-70A79E56-18AB-4E85-9494-C0C8F02320AF__GUID-F22D67F1-03C3-4785-96AD-2C9F4200D3E8">
                              <p class="notep1">注意：</p>
                              <p>您可以将<code class="codeph">CREATE_SNAPSHOT</code>过程的<code class="codeph">flush_level</code>参数的值指定为TYPICAL或ALL。刷新级别的默认值为TYPICAL。</p>
                              <p>刷新级别表示要捕获的AWR统计信息的广度和深度。如果要捕获所有AWR统计信息，请将刷新级别设置为ALL。如果由于性能原因要跳过几个AWR统计信息（例如，SQL统计信息，段统计信息以及文件和表空间统计信息），请将刷新级别设置为TYPICAL。</p>
                           </div>
                           <div class="infoboxnotealso" id="GUID-70A79E56-18AB-4E85-9494-C0C8F02320AF__GUID-4CA05C3A-7AF1-471A-95A0-DD44AD33365E">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>有关<code class="codeph">DBMS_WORKLOAD_REPOSITORY</code>包的信息，请<code class="codeph">DBMS_WORKLOAD_REPOSITORY</code> <a href="../arpls/DBMS_WORKLOAD_REPOSITORY.html#ARPLS093" target="_blank"><span class="italic">Oracle Database PL / SQL包和类型参考</span></a></p>
                                 </li>
                                 <li>
                                    <p>有关<code class="codeph">DBA_HIST_SNAPSHOT</code>视图的信息，请<a href="../refrn/DBA_HIST_SNAPSHOT.html#REFRN23442" target="_blank"><span class="italic">参见Oracle数据库参考</span></a></p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="TGDBA666"></a><a id="TGDBA193"></a><div class="props_rev_3"><a id="GUID-542ED7D0-ABED-48F4-9D2F-5DADEB610249" name="GUID-542ED7D0-ABED-48F4-9D2F-5DADEB610249"></a><h5 id="TGDBA-GUID-542ED7D0-ABED-48F4-9D2F-5DADEB610249" class="sect5"><span class="enumeration_section">6.2.2.3</span>删除快照</h5>
                     <div>
                        <div class="section">
                           <p>默认情况下，Oracle数据库会自动清除已存储在AWR中超过8天的快照。但是，您可能希望手动删除一系列快照以释放空间。</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-542ED7D0-ABED-48F4-9D2F-5DADEB610249__GUID-54EC04A7-E294-4222-94F9-310BF2AEC951">使用命令行界面删除快照</p>
                           <p>要手动删除一系列快照，请使用<code class="codeph">DROP_SNAPSHOT_RANGE</code>过程。以下示例显示了<code class="codeph">DROP_SNAPSHOT_RANGE</code>过程调用。
                           </p><pre class="oac_no_warn" dir="ltr">BEGIN DBMS_WORKLOAD_REPOSITORY.DROP_SNAPSHOT_RANGE（low_snap_id =&gt; 22，high_snap_id =&gt; 32，dbid =&gt; 3310949047）;结束; /</pre><p>在该示例中，快照ID范围为22到32的快照将立即从数据库实例中删除，数据库标识符为<code class="codeph">3310949047</code> 。在此快照范围内捕获的任何ASH数据也将被清除。
                           </p>
                           <div class="infobox-tip" id="GUID-542ED7D0-ABED-48F4-9D2F-5DADEB610249__GUID-DA1A705C-E218-413A-923D-05723486B2E1">
                              <p class="notep1">小费：</p>
                              <p>要确定要删除的快照，请使用<code class="codeph">DBA_HIST_SNAPSHOT</code>视图查看现有快照</p>
                           </div>
                           <div class="infoboxnotealso" id="GUID-542ED7D0-ABED-48F4-9D2F-5DADEB610249__GUID-FAE546F9-C537-4811-B807-B24B3B746FF1">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>有关<code class="codeph">DBMS_WORKLOAD_REPOSITORY</code>包的信息，请<code class="codeph">DBMS_WORKLOAD_REPOSITORY</code> <a href="../arpls/DBMS_WORKLOAD_REPOSITORY.html#ARPLS093" target="_blank"><span class="italic">Oracle Database PL / SQL包和类型参考</span></a></p>
                                 </li>
                                 <li>
                                    <p>有关<code class="codeph">DBA_HIST_SNAPSHOT</code>视图的信息，请<a href="../refrn/DBA_HIST_SNAPSHOT.html#REFRN23442" target="_blank"><span class="italic">参见Oracle数据库参考</span></a></p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="TGDBA667"></a><a id="TGDBA196"></a><div class="props_rev_3"><a id="GUID-62D01B30-2687-4821-A651-DC0E4AAC3B01" name="GUID-62D01B30-2687-4821-A651-DC0E4AAC3B01"></a><h5 id="TGDBA-GUID-62D01B30-2687-4821-A651-DC0E4AAC3B01" class="sect5"><span class="enumeration_section">6.2.2.4</span>修改快照设置</h5>
                     <div>
                        <p>您可以调整间隔，保留期和顶级SQL的数量以刷新快照生成，但请注意，这会影响Oracle数据库诊断工具的精度。</p>
                        <div class="section">
                           <p class="subhead3" id="GUID-62D01B30-2687-4821-A651-DC0E4AAC3B01__GUID-6736420E-986A-42E7-B964-87BC39805DA3">使用命令行界面修改快照设置</p>
                           <p>您可以使用<code class="codeph">DBMS_WORKLOAD_REPOSITORY.MODIFY_SNAPSHOT_SETTINGS</code>过程的以下参数修改快照设置：</p>
                           <div class="tblformal" id="GUID-62D01B30-2687-4821-A651-DC0E4AAC3B01__TABLE_DBMS_MEMOPTIMIZE_SUBPROGRAMS">
                              <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="This table lists the parameters of the DBMS_WORKLOAD_REPOSITORY.MODIFY_SNAPSHOT_SETTINGS procedure that can be used to  modify snapshot settings." frame="hsides" rules="rows">
                                 <thead>
                                    <tr align="left" valign="top">
                                       <th align="left" valign="bottom" id="d11457e1727">参数</th>
                                       <th align="left" valign="bottom" id="d11457e1730">描述</th>
                                    </tr>
                                 </thead>
                                 <tbody>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d11457e1735" headers="d11457e1727 ">
                                          <p><code class="codeph">间隔</code> 
                                          </p>
                                       </td>
                                       <td align="left" valign="top" headers="d11457e1735 d11457e1730 ">
                                          <p>此设置会影响数据库自动生成快照的频率。</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d11457e1744" headers="d11457e1727 ">
                                          <p><code class="codeph">保留</code> 
                                          </p>
                                       </td>
                                       <td align="left" valign="top" headers="d11457e1744 d11457e1730 ">
                                          <p>此设置会影响数据库在AWR中存储快照的时间。</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d11457e1753" headers="d11457e1727 ">
                                          <p><code class="codeph">TOPNSQL</code> 
                                          </p>
                                       </td>
                                       <td align="left" valign="top" headers="d11457e1753 d11457e1730 ">
                                          <p>此设置会影响为每个SQL条件刷新的顶级SQL数（已用时间，CPU时间，解析调用，可共享内存和版本计数）。</p>
                                          <p>此设置不受统计信息/刷新级别的影响，并会覆盖AWR SQL集合的系统默认行为。可以将此设置的值设置为<code class="codeph">MAXIMUM</code>以捕获共享SQL区域中的完整SQL集，但这样做（或通过将值设置为非常高的数字）可能会导致可能的空间和性能问题，因为那里将收集和存储更多数据。
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <!-- class="inftblhruleinformal" -->
                           <p>以下示例显示如何使用<code class="codeph">DBMS_WORKLOAD_REPOSITORY.MODIFY_SNAPSHOT_SETTINGS</code>过程修改快照设置：</p><pre class="oac_no_warn" dir="ltr">BEGIN DBMS_WORKLOAD_REPOSITORY.MODIFY_SNAPSHOT_SETTINGS（保留=&gt; 43200，间隔=&gt; 30，topnsql =&gt; 100，dbid =&gt; 3310949047）;结束; /</pre><p>在此示例中，数据库标识为<code class="codeph">3310949047</code>的数据库的快照设置将修改如下：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>保留期限指定为43200分钟（30天）。</p>
                              </li>
                              <li>
                                 <p>每个快照之间的间隔指定为30分钟。</p>
                              </li>
                              <li>
                                 <p>要为每个SQL条件刷新的顶级SQL数量指定为100。</p>
                              </li>
                           </ul>
                           <p>要获取有关数据库的当前快照设置的信息，请使用<code class="codeph">DBA_HIST_WR_CONTROL</code>视图，如以下示例所示：</p><pre class="oac_no_warn" dir="ltr">SQL&gt;选择snap_interval，保留DBA_HIST_WR_CONTROL; SNAP_INTERVAL RETENTION --------------------------------------- +00000 01：00：00.0 +00008 00：00：00.0</pre><p><code class="codeph">snap_interval</code>和<code class="codeph">retention</code>值以以下格式显示：</p><pre class="oac_no_warn" dir="ltr">+ [天] [小时]：[分钟]：[秒]。[纳秒]</pre><div class="infoboxnotealso" id="GUID-62D01B30-2687-4821-A651-DC0E4AAC3B01__GUID-B599EB38-C7DD-454C-9703-43CB5036F49C">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>有关<code class="codeph">DBMS_WORKLOAD_REPOSITORY.MODIFY_SNAPSHOT_SETTINGS</code>过程的详细信息，请<code class="codeph">DBMS_WORKLOAD_REPOSITORY.MODIFY_SNAPSHOT_SETTINGS</code> <a href="../arpls/DBMS_WORKLOAD_REPOSITORY.html#ARPLS-GUID-E2B46878-1BDB-4789-8A21-016A625530F1" target="_blank"><span class="italic">Oracle Database PL / SQL包和类型参考</span></a></p>
                                 </li>
                                 <li>
                                    <p>有关<code class="codeph">DBA_HIST_WR_CONTROL</code>视图的更多信息，请<a href="../refrn/DBA_HIST_WR_CONTROL.html#REFRN23462" target="_blank"><span class="italic">参见Oracle数据库参考</span></a></p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div><a id="TGDBA199"></a><div class="props_rev_3"><a id="GUID-44811EF8-D082-487F-8EEC-DA6E78700E68" name="GUID-44811EF8-D082-487F-8EEC-DA6E78700E68"></a><h4 id="TGDBA-GUID-44811EF8-D082-487F-8EEC-DA6E78700E68" class="sect4"><span class="enumeration_section">6.2.3</span>管理基线</h4>
                  <div>
                     <p>默认情况下，Oracle数据库会自动维护系统定义的移动窗口基线。必要时，您可以手动创建，删除或重命名基准并查看基线阈值设置。此外，您可以手动调整移动窗口基线的窗口大小。</p>
                     <p>本节介绍如何管理基准，并包含以下主题：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="gathering-database-statistics.html#GUID-471AAB84-1CE9-456C-9FF0-59B448D087C3">用于管理基准的用户界面</a></p>
                        </li>
                        <li>
                           <p><a href="gathering-database-statistics.html#GUID-CDAB6DE7-F5A1-4D14-8FF0-954C86DFC3FF">创建基线</a></p>
                        </li>
                        <li>
                           <p><a href="gathering-database-statistics.html#GUID-53D4F193-5EA5-4C6C-8547-A4A0B602D553">删除基线</a></p>
                        </li>
                        <li>
                           <p><a href="gathering-database-statistics.html#GUID-0E0D7ECE-A8C5-41C6-9CB7-69E99DB75193">重命名基线</a></p>
                        </li>
                        <li>
                           <p><a href="gathering-database-statistics.html#GUID-4206BF49-A554-4104-8CB7-A9281CA1A9D8">显示基准度量标准</a></p>
                        </li>
                        <li>
                           <p><a href="gathering-database-statistics.html#GUID-FFB695C6-E57A-487D-898A-EDAF0ECDD881">调整默认移动窗口基线的大小</a></p>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-44811EF8-D082-487F-8EEC-DA6E78700E68__GUID-1C5587B3-9325-4B92-BC74-AE023454EC16">
                        <p class="notep1">也可以看看：</p>
                        <p>有关基线信息的<span class="q">“ <a href="gathering-database-statistics.html#GUID-C6401C10-F958-4339-99C2-3320BDAB4CEA">基线</a> ”</span></p>
                     </div>
                  </div><a id="TGDBA200"></a><div class="props_rev_3"><a id="GUID-471AAB84-1CE9-456C-9FF0-59B448D087C3" name="GUID-471AAB84-1CE9-456C-9FF0-59B448D087C3"></a><h5 id="TGDBA-GUID-471AAB84-1CE9-456C-9FF0-59B448D087C3" class="sect5"><span class="enumeration_section">6.2.3.1</span>管理基线的用户界面</h5>
                     <div>
                        <p>管理基线的主要界面是Oracle企业管理器云控制（云控制）。尽可能使用Cloud Control管理基线。</p>
                        <p>如果Cloud Control不可用，则使用命令行界面中的<code class="codeph">DBMS_WORKLOAD_REPOSITORY</code>包管理基准。需要DBA角色来调用<code class="codeph">DBMS_WORKLOAD_REPOSITORY</code>过程。
                        </p>
                        <div class="infoboxnotealso" id="GUID-471AAB84-1CE9-456C-9FF0-59B448D087C3__GUID-1D5A96FA-83DA-446C-BBA1-FEF4A96261C9">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>有关使用Cloud Control管理基线的详细信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tgdba&amp;id=TDPPT230" target="_blank"><span class="italic">“Oracle数据库2天+性能调整指南”</span></a></p>
                              </li>
                              <li>
                                 <p>有关<code class="codeph">DBMS_WORKLOAD_REPOSITORY</code>包的信息，请<code class="codeph">DBMS_WORKLOAD_REPOSITORY</code> <a href="../arpls/DBMS_WORKLOAD_REPOSITORY.html#ARPLS093" target="_blank"><span class="italic">Oracle Database PL / SQL包和类型参考</span></a></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div><a id="TGDBA668"></a><a id="TGDBA201"></a><div class="props_rev_3"><a id="GUID-CDAB6DE7-F5A1-4D14-8FF0-954C86DFC3FF" name="GUID-CDAB6DE7-F5A1-4D14-8FF0-954C86DFC3FF"></a><h5 id="TGDBA-GUID-CDAB6DE7-F5A1-4D14-8FF0-954C86DFC3FF" class="sect5"><span class="enumeration_section">6.2.3.2</span>创建基线</h5>
                     <div>
                        <div class="section">
                           <p>默认情况下，Oracle数据库会自动维护系统定义的移动窗口基线。但是，您可能希望手动创建表示系统以最佳级别运行的固定基线，因此您可以将其与在性能不佳期间捕获的其他基准或快照进行比较。</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>要使用命令行界面创建基线，请使用<code class="codeph">CREATE_BASELINE</code>过程，如以下示例所示：</p><pre class="oac_no_warn" dir="ltr">BEGIN DBMS_WORKLOAD_REPOSITORY.CREATE_BASELINE（start_snap_id =&gt; 270，end_snap_id =&gt; 280，baseline_name =&gt;'peak baseline'，dbid =&gt; 3310949047，expiration =&gt; 30）;结束; /</pre><p>在此示例中，将在数据库实例上创建基准，数据库标识符为<code class="codeph">3310949047</code>并具有以下设置：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>起始快照序列号为270。</p>
                              </li>
                              <li>
                                 <p>结束快照序列号为280。</p>
                              </li>
                              <li>
                                 <p>基线的名称是<code class="codeph">peak baseline</code> 。
                                 </p>
                              </li>
                              <li>
                                 <p>基线到期时间为30天。</p>
                              </li>
                           </ul>
                           <p>创建基线时，Oracle数据库会自动为新基准分配唯一ID。</p>
                           <div class="infobox-tip" id="GUID-CDAB6DE7-F5A1-4D14-8FF0-954C86DFC3FF__GUID-9B17EAA9-2E95-4EDC-8D8B-4E225416089A">
                              <p class="notep1">小费：</p>
                              <p>要确定要包括在基准中的快照范围，请使用<code class="codeph">DBA_HIST_SNAPSHOT</code>视图查看现有快照</p>
                           </div>
                           <div class="infoboxnotealso" id="GUID-CDAB6DE7-F5A1-4D14-8FF0-954C86DFC3FF__GUID-05244353-23C0-418D-BFC9-83F919BAA297">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>有关<code class="codeph">DBMS_WORKLOAD_REPOSITORY</code>包的信息，请<code class="codeph">DBMS_WORKLOAD_REPOSITORY</code> <a href="../arpls/DBMS_WORKLOAD_REPOSITORY.html#ARPLS093" target="_blank"><span class="italic">Oracle Database PL / SQL包和类型参考</span></a></p>
                                 </li>
                                 <li>
                                    <p>有关<code class="codeph">DBA_HIST_SNAPSHOT</code>视图的信息，请<a href="../refrn/DBA_HIST_SNAPSHOT.html#REFRN23442" target="_blank"><span class="italic">参见Oracle数据库参考</span></a></p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="TGDBA669"></a><a id="TGDBA204"></a><div class="props_rev_3"><a id="GUID-53D4F193-5EA5-4C6C-8547-A4A0B602D553" name="GUID-53D4F193-5EA5-4C6C-8547-A4A0B602D553"></a><h5 id="TGDBA-GUID-53D4F193-5EA5-4C6C-8547-A4A0B602D553" class="sect5"><span class="enumeration_section">6.2.3.3</span>删除基线</h5>
                     <div>
                        <div class="section">
                           <p>要节省磁盘空间，请考虑定期删除不再使用的基准。与基线关联的快照将无限期保留，直到您明确删除基线或基线已过期为止。</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>要使用命令行界面删除基线，请使用<code class="codeph">DROP_BASELINE</code>过程，如以下示例所示：</p><pre class="oac_no_warn" dir="ltr">BEGIN DBMS_WORKLOAD_REPOSITORY.DROP_BASELINE（baseline_name =&gt;'peak baseline'，cascade =&gt; FALSE，dbid =&gt; 3310949047）;结束; /</pre><p>在该示例中，从数据库实例中删除基线<code class="codeph">peak baseline</code> ，数据库标识符为<code class="codeph">3310949047</code>并保留关联的快照。
                           </p>
                           <div class="infobox-tip" id="GUID-53D4F193-5EA5-4C6C-8547-A4A0B602D553__GUID-204E8C52-AC8B-4014-BE2F-564A93F3427F">
                              <p class="notep1">小费：</p>
                              <p>要确定要删除的基准，请使用<code class="codeph">DBA_HIST_BASELINE</code>视图查看现有基准。
                              </p>
                           </div>
                           <div class="infobox-tip" id="GUID-53D4F193-5EA5-4C6C-8547-A4A0B602D553__GUID-8BEDA752-4A26-47BE-A1E3-BC27EC9B8A4A">
                              <p class="notep1">小费：</p>
                              <p>要将关联的快照与基线一起删除，请将<code class="codeph">cascade</code>参数设置为<code class="codeph">TRUE</code> 。</p>
                           </div>
                           <div class="infoboxnotealso" id="GUID-53D4F193-5EA5-4C6C-8547-A4A0B602D553__GUID-AF1A803D-238B-42D6-8D13-8D0138A043DC">
                              <p class="notep1">也可以看看：</p>
                              <p>有关<code class="codeph">DBMS_WORKLOAD_REPOSITORY</code>包的信息，请<code class="codeph">DBMS_WORKLOAD_REPOSITORY</code> <a href="../arpls/DBMS_WORKLOAD_REPOSITORY.html#ARPLS093" target="_blank"><span class="italic">Oracle Database PL / SQL包和类型参考</span></a></p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="TGDBA670"></a><a id="TGDBA207"></a><div class="props_rev_3"><a id="GUID-0E0D7ECE-A8C5-41C6-9CB7-69E99DB75193" name="GUID-0E0D7ECE-A8C5-41C6-9CB7-69E99DB75193"></a><h5 id="TGDBA-GUID-0E0D7ECE-A8C5-41C6-9CB7-69E99DB75193" class="sect5"><span class="enumeration_section">6.2.3.4</span>重命名基线</h5>
                     <div>
                        <div class="section">
                           <p>要使用命令行界面重命名基线，请使用<code class="codeph">RENAME_BASELINE</code>过程。以下示例显示了<code class="codeph">RENAME_BASELINE</code>过程调用。
                           </p><pre class="oac_no_warn" dir="ltr">BEGIN DBMS_WORKLOAD_REPOSITORY.RENAME_BASELINE（old_baseline_name =&gt;'peak baseline'，new_baseline_name =&gt;'peak mondays'，dbid =&gt; 3310949047）;结束; /</pre><p>在此示例中，数据库标识为<code class="codeph">3310949047</code>的数据库实例上的基线名称将从<code class="codeph">peak baseline</code>重命名为<code class="codeph">peak mondays</code> 。
                           </p>
                           <div class="infoboxnotealso" id="GUID-0E0D7ECE-A8C5-41C6-9CB7-69E99DB75193__GUID-D1CFEA9C-F6CE-4D93-8815-D278847F82A4">
                              <p class="notep1">也可以看看：</p>
                              <p>有关<code class="codeph">DBMS_WORKLOAD_REPOSITORY</code>包的信息，请<code class="codeph">DBMS_WORKLOAD_REPOSITORY</code> <a href="../arpls/DBMS_WORKLOAD_REPOSITORY.html#ARPLS093" target="_blank"><span class="italic">Oracle Database PL / SQL包和类型参考</span></a></p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="TGDBA210"></a><div class="props_rev_3"><a id="GUID-4206BF49-A554-4104-8CB7-A9281CA1A9D8" name="GUID-4206BF49-A554-4104-8CB7-A9281CA1A9D8"></a><h5 id="TGDBA-GUID-4206BF49-A554-4104-8CB7-A9281CA1A9D8" class="sect5"><span class="enumeration_section">6.2.3.5</span>显示基准度量标准</h5>
                     <div>
                        <div class="section">
                           <p>与自适应阈值一起使用时，基线包含数据库可用于计算度量阈值的AWR数据。</p>
                           <p>要使用命令行界面在基准期间显示度量标准值的摘要统计信息，请使用<code class="codeph">SELECT_BASELINE_METRICS</code>函数：</p><pre class="oac_no_warn" dir="ltr">DBMS_WORKLOAD_REPOSITORY.SELECT_BASELINE_METRICS（baseline_name IN VARCHAR2，dbid IN NUMBER DEFAULT NULL，instance_num IN NUMBER DEFAULT NULL）RETURN awr_baseline_metric_type_table PIPELINED;</pre><div class="infoboxnotealso" id="GUID-4206BF49-A554-4104-8CB7-A9281CA1A9D8__GUID-A9621E73-25C1-4763-B4B9-62A8DBE98516">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><span class="q">“ <a href="gathering-database-statistics.html#GUID-6450312A-8894-4648-8DC3-83C83F6995F3">自适应阈值</a> ”，</span>用于获取有关基线度量阈值的信息</p>
                                 </li>
                                 <li>
                                    <p>有关<code class="codeph">DBMS_WORKLOAD_REPOSITORY</code>包的信息，请<code class="codeph">DBMS_WORKLOAD_REPOSITORY</code> <a href="../arpls/DBMS_WORKLOAD_REPOSITORY.html#ARPLS093" target="_blank"><span class="italic">Oracle Database PL / SQL包和类型参考</span></a></p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="TGDBA671"></a><a id="TGDBA213"></a><div class="props_rev_3"><a id="GUID-FFB695C6-E57A-487D-898A-EDAF0ECDD881" name="GUID-FFB695C6-E57A-487D-898A-EDAF0ECDD881"></a><h5 id="TGDBA-GUID-FFB695C6-E57A-487D-898A-EDAF0ECDD881" class="sect5"><span class="enumeration_section">6.2.3.6</span>调整默认移动窗口基线的大小</h5>
                     <div>
                        <div class="section">
                           <p>默认情况下，Oracle数据库会自动维护系统定义的移动窗口基线。系统定义的移动窗口基线的默认窗口大小是当前AWR保留期，默认为8天。在某些情况下，您可能希望修改默认移动窗口基线的窗口大小，例如增加其大小以更准确地计算自适应阈值的阈值。</p>
                           <p>要使用命令行界面修改默认移动窗口基线的窗口大小，请使用<code class="codeph">MODIFY_BASELINE_WINDOW_SIZE</code>过程，如以下示例所示：</p><pre class="oac_no_warn" dir="ltr">BEGIN DBMS_WORKLOAD_REPOSITORY.MODIFY_BASELINE_WINDOW_SIZE（window_size =&gt; 30，dbid =&gt; 3310949047）;结束; /</pre><p>在此示例中，默认移动窗口在数据库实例上调整为30天，数据库标识符为<code class="codeph">3310949047</code> 。
                           </p>
                           <div class="infoboxnote" id="GUID-FFB695C6-E57A-487D-898A-EDAF0ECDD881__GUID-A575D691-2ACE-4BB2-8005-995D18F7708D">
                              <p class="notep1">注意：</p>
                              <p>窗口大小必须设置为等于或小于AWR保留设置值的值。要设置大于当前AWR保留期的窗口大小，必须首先按<span class="q">“ <a href="gathering-database-statistics.html#GUID-62D01B30-2687-4821-A651-DC0E4AAC3B01" title="您可以调整间隔，保留期和顶级SQL的数量以刷新快照生成，但请注意，这会影响Oracle数据库诊断工具的精度。">修改快照设置</a> ”中的说明</span>增加<code class="codeph">retention</code>参数的值。
                              </p>
                           </div>
                           <div class="infoboxnotealso" id="GUID-FFB695C6-E57A-487D-898A-EDAF0ECDD881__GUID-B705F485-D11D-4DF2-BFC9-868C3AF63018">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>有关移动窗口基线的信息，请参阅<span class="q">“ <a href="gathering-database-statistics.html#GUID-91C614C3-5B49-4DD9-90B5-A38F3D6AAD62">移动窗口基线</a> ”</span></p>
                                 </li>
                                 <li>
                                    <p>有关<code class="codeph">DBMS_WORKLOAD_REPOSITORY</code>包的信息，请<code class="codeph">DBMS_WORKLOAD_REPOSITORY</code> <a href="../arpls/DBMS_WORKLOAD_REPOSITORY.html#ARPLS093" target="_blank"><span class="italic">Oracle Database PL / SQL包和类型参考</span></a></p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div><a id="TGDBA216"></a><div class="props_rev_3"><a id="GUID-B5DB2422-951F-4D00-A473-AB6739ECC88B" name="GUID-B5DB2422-951F-4D00-A473-AB6739ECC88B"></a><h4 id="TGDBA-GUID-B5DB2422-951F-4D00-A473-AB6739ECC88B" class="sect4"><span class="enumeration_section">6.2.4</span>管理基准模板</h4>
                  <div>
                     <p>通过基线模板，您可以自动创建基线以捕获将来指定的时间段。本节介绍如何管理基准模板，并包含以下主题：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="gathering-database-statistics.html#GUID-67905721-1F11-4F0C-8186-8EF56B94C53B">用于管理基准模板的用户界面</a></p>
                        </li>
                        <li>
                           <p><a href="gathering-database-statistics.html#GUID-A4FA4563-BF8B-4EA6-8348-5D1CDB32664D">创建单个基线模板</a></p>
                        </li>
                        <li>
                           <p><a href="gathering-database-statistics.html#GUID-2B940DB3-B11F-4A17-B0B9-AE4C83E01CD6">创建重复的基线模板</a></p>
                        </li>
                        <li>
                           <p><a href="gathering-database-statistics.html#GUID-8ED1483E-AED8-41D6-9E8A-E31379F5B174">删除基线模板</a></p>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-B5DB2422-951F-4D00-A473-AB6739ECC88B__GUID-B9E842DF-3952-4183-AB4F-1A0AD5E222CD">
                        <p class="notep1">也可以看看：</p>
                        <p><span class="q">“ <a href="gathering-database-statistics.html#GUID-BC0E898A-5AE3-4305-9F74-C24EE5F288DF">基准模板</a> ”，</span>用于获取有关基线模板的信息</p>
                     </div>
                  </div><a id="TGDBA217"></a><div class="props_rev_3"><a id="GUID-67905721-1F11-4F0C-8186-8EF56B94C53B" name="GUID-67905721-1F11-4F0C-8186-8EF56B94C53B"></a><h5 id="TGDBA-GUID-67905721-1F11-4F0C-8186-8EF56B94C53B" class="sect5"><span class="enumeration_section">6.2.4.1</span>管理基准模板的用户界面</h5>
                     <div>
                        <p>管理基准模板的主要界面是Oracle企业管理器云控制（云控制）。尽可能使用Cloud Control管理基线模板。</p>
                        <p>如果Cloud Control不可用，则使用命令行界面中的<code class="codeph">DBMS_WORKLOAD_REPOSITORY</code>包管理基线模板。需要DBA角色来调用<code class="codeph">DBMS_WORKLOAD_REPOSITORY</code>过程。
                        </p>
                        <div class="infoboxnotealso" id="GUID-67905721-1F11-4F0C-8186-8EF56B94C53B__GUID-D5E696CD-7320-4739-8C96-FC24002292AB">
                           <p class="notep1">也可以看看：</p>
                           <p>有关使用Cloud Control管理基线模板的详细信息，请参阅<a href="../tdppt/resolving-performance-degradation-over-time.html#TDPPT230" target="_blank"><span class="italic">“Oracle数据库2天+性能调整指南”</span></a></p>
                        </div>
                     </div>
                  </div><a id="TGDBA672"></a><a id="TGDBA218"></a><div class="props_rev_3"><a id="GUID-A4FA4563-BF8B-4EA6-8348-5D1CDB32664D" name="GUID-A4FA4563-BF8B-4EA6-8348-5D1CDB32664D"></a><h5 id="TGDBA-GUID-A4FA4563-BF8B-4EA6-8348-5D1CDB32664D" class="sect5"><span class="enumeration_section">6.2.4.2</span>创建单个基线模板</h5>
                     <div>
                        <div class="section">
                           <p>您可以使用单个基线模板在将来的单个固定时间间隔内创建基线。例如，您可以创建单个基线模板以生成在2012年4月2日下午5:00到晚上8:00捕获的基线。</p>
                           <p>要使用命令行界面创建单个基线模板，请使用<code class="codeph">CREATE_BASELINE_TEMPLATE</code>过程，如以下示例所示：</p><pre class="oac_no_warn" dir="ltr">BEGIN DBMS_WORKLOAD_REPOSITORY.CREATE_BASELINE_TEMPLATE（start_time =&gt;'2012-04-02 17:00:00 PST'，end_time =&gt;'2012-04-02 20:00:00 PST'，baseline_name =&gt;'baseline_120402'，template_name =&gt;' template_120402'，expiration =&gt; 30，dbid =&gt; 3310949047）;结束; /</pre><p>在此示例中，创建了名为<code class="codeph">template_120402</code>的基线模板，该模板将在2012年4月2日下午5:00到8:00的<code class="codeph">3310949047</code>在数据库ID为<code class="codeph">3310949047</code>的数据库上生成名为<code class="codeph">baseline_120402</code> 。基线将在30天后过期。
                           </p>
                           <div class="infoboxnotealso" id="GUID-A4FA4563-BF8B-4EA6-8348-5D1CDB32664D__GUID-0D808D3D-9FA5-43CF-9AC1-51C432FC7161">
                              <p class="notep1">也可以看看：</p>
                              <p>有关<code class="codeph">DBMS_WORKLOAD_REPOSITORY</code>包的信息，请<code class="codeph">DBMS_WORKLOAD_REPOSITORY</code> <a href="../arpls/DBMS_WORKLOAD_REPOSITORY.html#ARPLS093" target="_blank"><span class="italic">Oracle Database PL / SQL包和类型参考</span></a></p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="TGDBA673"></a><a id="TGDBA221"></a><div class="props_rev_3"><a id="GUID-2B940DB3-B11F-4A17-B0B9-AE4C83E01CD6" name="GUID-2B940DB3-B11F-4A17-B0B9-AE4C83E01CD6"></a><h5 id="TGDBA-GUID-2B940DB3-B11F-4A17-B0B9-AE4C83E01CD6" class="sect5"><span class="enumeration_section">6.2.4.3</span>创建重复的基线模板</h5>
                     <div>
                        <div class="section">
                           <p>您可以使用重复基线模板自动创建在特定时间段内在将来的特定时间段内重复的基线。例如，您可以创建重复基线模板以生成基线，该基线在2012年的每个星期一下午5:00到晚上8:00重复。</p>
                           <p>要使用命令行创建重复基线模板，请使用<code class="codeph">CREATE_BASELINE_TEMPLATE</code>过程，如以下示例所示：</p><pre class="oac_no_warn" dir="ltr">BEGIN DBMS_WORKLOAD_REPOSITORY.CREATE_BASELINE_TEMPLATE（day_of_week =&gt;'monday'，hour_in_day =&gt; 17，duration =&gt; 3，expiration =&gt; 30，start_time =&gt;'2012-04-02 17:00:00 PST'，end_time =&gt;'2012- 12-31 20:00:00 PST'，baseline_name_prefix =&gt;'baseline_2012_mondays_'，template_name =&gt;'template_2012_mondays'，dbid =&gt; 3310949047）;结束; /</pre><p>在此示例中，创建名为<code class="codeph">template_2012_mondays</code>的基线模板，该模板将在2012年4月2日下午5:00和2012年12月31日结束时的每周一下午5:00至晚上8:00生成基线：数据库ID为<code class="codeph">3310949047</code>的数据库下午00点。将使用前缀为<code class="codeph">baseline_2012_mondays_</code>的基线名称创建每个<code class="codeph">baseline_2012_mondays_</code>并在30天后过期。
                           </p>
                           <div class="infoboxnotealso" id="GUID-2B940DB3-B11F-4A17-B0B9-AE4C83E01CD6__GUID-1DFB1349-D51B-42B3-B58A-F70FA388C4DC">
                              <p class="notep1">也可以看看：</p>
                              <p>有关<code class="codeph">DBMS_WORKLOAD_REPOSITORY</code>包的信息，请<code class="codeph">DBMS_WORKLOAD_REPOSITORY</code> <a href="../arpls/DBMS_WORKLOAD_REPOSITORY.html#ARPLS093" target="_blank"><span class="italic">Oracle Database PL / SQL包和类型参考</span></a></p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="TGDBA674"></a><a id="TGDBA224"></a><div class="props_rev_3"><a id="GUID-8ED1483E-AED8-41D6-9E8A-E31379F5B174" name="GUID-8ED1483E-AED8-41D6-9E8A-E31379F5B174"></a><h5 id="TGDBA-GUID-8ED1483E-AED8-41D6-9E8A-E31379F5B174" class="sect5"><span class="enumeration_section">6.2.4.4</span>删除基线模板</h5>
                     <div>
                        <div class="section">
                           <p>您可能希望定期删除不再用于节省磁盘空间的基准模板。</p>
                           <p>要使用命令行删除基线模板，请使用<code class="codeph">DROP_BASELINE_TEMPLATE</code>过程，如以下示例所示：</p><pre class="oac_no_warn" dir="ltr">BEGIN DBMS_WORKLOAD_REPOSITORY.DROP_BASELINE_TEMPLATE（template_name =&gt;'template_2012_mondays'，dbid =&gt; 3310949047）;结束; /</pre><p>在此示例中，名为<code class="codeph">template_2012_mondays</code>的基线模板从数据库实例中删除，数据库标识符为<code class="codeph">3310949047</code> 。
                           </p>
                           <div class="infobox-tip" id="GUID-8ED1483E-AED8-41D6-9E8A-E31379F5B174__GUID-2C608B95-160C-41CB-BC05-24D38FBD3932">
                              <p class="notep1">小费：</p>
                              <p>要确定要删除的基准模板，请使用<code class="codeph">DBA_HIST_BASELINE_TEMPLATE</code>视图查看现有基准模板。
                              </p>
                           </div>
                           <div class="infoboxnotealso" id="GUID-8ED1483E-AED8-41D6-9E8A-E31379F5B174__GUID-42343832-2C01-4BE4-8EAD-DF81C54084DC">
                              <p class="notep1">也可以看看：</p>
                              <p>有关<code class="codeph">DBMS_WORKLOAD_REPOSITORY</code>包的信息，请<code class="codeph">DBMS_WORKLOAD_REPOSITORY</code> <a href="../arpls/DBMS_WORKLOAD_REPOSITORY.html#ARPLS093" target="_blank"><span class="italic">Oracle Database PL / SQL包和类型参考</span></a></p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div><a id="TGDBA227"></a><div class="props_rev_3"><a id="GUID-F25470A0-C236-46DE-84F7-D68FBE1B0F12" name="GUID-F25470A0-C236-46DE-84F7-D68FBE1B0F12"></a><h4 id="TGDBA-GUID-F25470A0-C236-46DE-84F7-D68FBE1B0F12" class="sect4"><span class="enumeration_section">6.2.5将</span>自动工作负载存储库数据传输到另一个系统</h4>
                  <div>
                     <p>Oracle数据库使您可以在系统之间传输AWR数据。这在您希望使用单独的系统执行AWR数据分析的情况下非常有用，以便减少生产系统上性能分析所导致的开销。</p>
                     <p>要将AWR数据从一个系统传输到另一个系统，首先从源系统上的数据库导出AWR数据，然后将其导入目标系统上的数据库。</p>
                     <p>本节包含以下主题：</p>
                     <ul id="GUID-F25470A0-C236-46DE-84F7-D68FBE1B0F12__UL_XGF_P5P_FGB" style="list-style-type:disc">
                        <li>
                           <p><span class="q">“ <a href="gathering-database-statistics.html#GUID-CC6A87BD-BFEA-4A1B-9FD1-3445DC11BE72">导出AWR数据</a> ”</span></p>
                        </li>
                        <li>
                           <p><span class="q">“ <a href="gathering-database-statistics.html#GUID-C916E80F-B819-4452-ABFC-18CA70D8A501">导入AWR数据</a> ”</span></p>
                        </li>
                     </ul>
                  </div><a id="TGDBA229"></a><div class="props_rev_3"><a id="GUID-CC6A87BD-BFEA-4A1B-9FD1-3445DC11BE72" name="GUID-CC6A87BD-BFEA-4A1B-9FD1-3445DC11BE72"></a><h5 id="TGDBA-GUID-CC6A87BD-BFEA-4A1B-9FD1-3445DC11BE72" class="sect5"><span class="enumeration_section">6.2.5.1</span>导出AWR数据</h5>
                     <div>
                        <div class="section">
                           <p><code class="codeph">awrextr.sql</code>脚本将一系列快照的AWR数据从数据库导出到Data Pump导出文件中。创建后，您可以将此转储文件传输到另一个数据库，您可以在其中导入导出的AWR数据。要运行<code class="codeph">awrextr.sql</code>脚本，必须以<code class="codeph">SYS</code>用户身份连接到数据库。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-CC6A87BD-BFEA-4A1B-9FD1-3445DC11BE72__GUID-FE226749-F63A-4EB3-9445-75162A29B9C5">要导出AWR数据：</p>
                           <ol>
                              <li>
                                 <p>在SQL提示符下，输入：</p><pre class="oac_no_warn" dir="ltr">@ $ ORACLE_HOME / RDBMS /管理/ awrextr.sql</pre><p>将显示AWR架构中的数据库列表。</p>
                              </li>
                              <li>
                                 <p>指定需要从中导出AWR数据的数据库：</p><pre class="oac_no_warn" dir="ltr">输入db_id的值：1377863381</pre><p>在此示例中，指定了数据库标识为<code class="codeph">1377863381</code>的数据库。
                                 </p>
                              </li>
                              <li>
                                 <p>指定要查看所有快照ID的天数：</p><pre class="oac_no_warn" dir="ltr">输入num_days的值：2</pre><p>在此示例中，将显示过去2天内捕获的所有快照。</p>
                              </li>
                              <li>
                                 <p>通过指定开始和结束快照ID，定义需要导出AWR数据的快照范围：</p><pre class="oac_no_warn" dir="ltr">输入begin_snap的值：30输入end_snap的值：40</pre><p>在此示例中，快照ID 30指定为开始快照，快照ID 40指定为结束快照。</p>
                                 <p>显示目录对象列表。</p>
                              </li>
                              <li>
                                 <p>指定指向需要存储导出转储文件的目录的目录对象：</p><pre class="oac_no_warn" dir="ltr">输入directory_name的值：DATA_PUMP_DIR</pre><p>在此示例中，指定目录对象<code class="codeph">DATA_PUMP_DIR</code>指向目录<code class="codeph">ORACLE_HOME/rdbms/log</code> ，其中<code class="codeph">ORACLE_HOME</code>是<code class="codeph">/u01/app/oracle/product/ <span class="codeinlineitalic">database_release_number</span> /dbhome_1</code> 。
                                 </p>
                              </li>
                              <li>
                                 <p>为没有文件扩展名的导出转储文件指定名称。默认情况下，使用<code class="codeph">.dmp</code>的文件扩展名。
                                 </p><pre class="oac_no_warn" dir="ltr">输入file_name的值：awrdata_30_40</pre><p>在此示例中，在目录对象<code class="codeph">DATA_PUMP_DIR</code>指定的目录中创建名为<code class="codeph">awrdata_30_40.dmp</code>的导出转储文件：</p><pre class="oac_no_warn" dir="ltr">为SYS.SYS_EXPORT_TABLE_01设置的转储文件是：/ u01 / app / oracle / product / <span class="italic">database_release_number</span> /dbhome_1/rdbms/log/awrdata_30_40.dmp作业“SYS”。“SYS_EXPORT_TABLE_01”在08:58:20顺利完成</pre><p>根据必须导出的AWR数据量，AWR导出操作可能需要一段时间才能完成。创建转储文件后，您可以使用Data Pump将文件传输到另一个系统。</p>
                              </li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <div class="infoboxnotealso" id="GUID-CC6A87BD-BFEA-4A1B-9FD1-3445DC11BE72__GUID-A7D89CA3-8271-4786-8ADD-581E48D9C621">
                              <p class="notep1">也可以看看：</p>
                              <p>有关使用Data Pump的信息，请<a href="../sutil/oracle-data-pump-overview.html#SUTIL100" target="_blank"><span class="italic">参见Oracle数据库实用程序</span></a></p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="TGDBA230"></a><div class="props_rev_3"><a id="GUID-C916E80F-B819-4452-ABFC-18CA70D8A501" name="GUID-C916E80F-B819-4452-ABFC-18CA70D8A501"></a><h5 id="TGDBA-GUID-C916E80F-B819-4452-ABFC-18CA70D8A501" class="sect5"><span class="enumeration_section">6.2.5.2</span>导入AWR数据</h5>
                     <div>
                        <div class="section">
                           <p>将导出转储文件传输到目标系统后，使用<code class="codeph">awrload.sql</code>脚本导入导出的AWR数据。<code class="codeph">awrload.sql</code>脚本创建一个临时模式，其中快照数据从Data Pump文件传输到数据库中。然后将数据从分段模式传输到适当的AWR表中。要运行<code class="codeph">awrload.sql</code>脚本，必须以<code class="codeph">SYS</code>用户身份连接到数据库。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-C916E80F-B819-4452-ABFC-18CA70D8A501__GUID-6B7D41A0-372A-433A-849E-4CB7C42AF3C2">要导入AWR数据：</p>
                           <ol>
                              <li>
                                 <p>在SQL提示符下，输入：</p><pre class="oac_no_warn" dir="ltr">@ $ ORACLE_HOME / RDBMS /管理/ awrload.sql</pre><p>显示目录对象列表。</p>
                              </li>
                              <li>
                                 <p>指定指向导出转储文件所在目录的目录对象：</p><pre class="oac_no_warn" dir="ltr">输入directory_name的值：DATA_PUMP_DIR</pre><p>在此示例中，指定了目录对象<code class="codeph">DATA_PUMP_DIR</code> ，该目标对象指向导出转储文件所在的目录。
                                 </p>
                              </li>
                              <li>
                                 <p>指定不带文件扩展名的导出转储文件的名称。默认情况下，使用<code class="codeph">.dmp</code>的文件扩展名。
                                 </p><pre class="oac_no_warn" dir="ltr">输入file_name的值：awrdata_30_40</pre><p>在此示例中，选择名为<code class="codeph">awrdata_30_40.dmp</code>的导出转储文件。
                                 </p>
                              </li>
                              <li>
                                 <p>指定需要导入AWR数据的登台模式的名称：</p><pre class="oac_no_warn" dir="ltr">输入schema_name的值：AWR_STAGE</pre><p>在此示例中，将创建名为<code class="codeph">AWR_STAGE</code>的临时模式。
                                 </p>
                              </li>
                              <li>
                                 <p>指定登台模式的默认表空间：</p><pre class="oac_no_warn" dir="ltr">输入default_tablespace的值：SYSAUX</pre><p>在此示例中，指定了<code class="codeph">SYSAUX</code>表空间。
                                 </p>
                              </li>
                              <li>
                                 <p>为登台模式指定临时表空间：</p><pre class="oac_no_warn" dir="ltr">输入temporary_tablespace的值：TEMP</pre><p>在此示例中，指定了<code class="codeph">TEMP</code>表空间。
                                 </p>
                              </li>
                              <li>
                                 <p>首先将AWR数据导入<code class="codeph">AWR_STAGE</code>模式，然后将其传输到<code class="codeph">SYS</code>模式中的AWR表：</p><pre class="oac_no_warn" dir="ltr">处理对象类型TABLE_EXPORT / TABLE / CONSTRAINT / CONSTRAINT在11秒内完成113个CONSTRAINT对象处理对象类型TABLE_EXPORT / TABLE / CONSTRAINT / REF_CONSTRAINT在1秒内完成1个REF_CONSTRAINT对象作业“SYS”。“SYS_IMPORT_FULL_03”在09:29:30成功完成...删除AWR_STAGE用户AWR加载结束</pre><p>根据必须导入的AWR数据量，AWR导入操作可能需要一段时间才能完成。导入AWR数据后，将自动删除分段架构。</p>
                              </li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div><a id="TGDBA231"></a><div class="props_rev_3"><a id="GUID-18E1B278-B3C5-4FE1-8E51-BC8878C439F5" name="GUID-18E1B278-B3C5-4FE1-8E51-BC8878C439F5"></a><h4 id="TGDBA-GUID-18E1B278-B3C5-4FE1-8E51-BC8878C439F5" class="sect4"><span class="enumeration_section">6.2.6</span>使用自动工作负载存储库视图</h4>
                  <div>
                     <div class="section">
                        <p>通常，您可以使用Oracle Enterprise Manager云控制（云控制）或AWR报告查看AWR数据。但是，您还可以使用以下<code class="codeph">DBA_HIST</code>视图查看存储在AWR中的历史数据。
                        </p>
                        <div class="infoboxnote" id="GUID-18E1B278-B3C5-4FE1-8E51-BC8878C439F5__GUID-4EC90DF7-373B-485E-942C-3421F8BE5515">
                           <p class="notep1">注意：</p>
                           <p>在多租户环境中，这些<code class="codeph">DBA_HIST</code>视图也可以分别与CDB级别和PDB级别的<code class="codeph">AWR_ROOT</code>视图和<code class="codeph">AWR_PDB</code>视图互换。例如，您可以使用<code class="codeph">AWR_PDB_ACTIVE_SESS_HISTORY</code>视图来检索有关PDB级别的活动会话历史记录的AWR数据，这相当于非多租户环境中独立数据库中的<code class="codeph">DBA_HIST_ACTIVE_SESS_HISTORY</code>视图。如果尚未收集PDB级别快照，则<code class="codeph">AWR_PDB</code>视图不会显示任何AWR数据。
                           </p>
                        </div>
                        <div class="tblformalwide" id="GUID-18E1B278-B3C5-4FE1-8E51-BC8878C439F5__GUID-6F1462C5-A791-4887-B257-5EBAE3481209">
                           <p class="titleintable">表6-1 DBA_HIST视图</p>
                           <table cellpadding="4" cellspacing="0" class="FormalWide" title="DBA_HIST视图" width="100%" border="1" summary="This table lists the DBA_HIST views that can be used to view Automatic Workload Repository data." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="20%" id="d11457e3309">DBA_HIST查看</th>
                                    <th align="left" valign="bottom" width="20%" id="d11457e3312">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d11457e3317" headers="d11457e3309 ">
                                       <p><code class="codeph">DBA_HIST_ACTIVE_SESS_HISTORY</code></p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d11457e3317 d11457e3312 ">
                                       <p>显示最近系统活动的内存中活动会话历史记录内容的历史记录。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d11457e3325" headers="d11457e3309 ">
                                       <p><code class="codeph">DBA_HIST_BASELINE</code> 
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d11457e3325 d11457e3312 ">
                                       <p>显示有关系统上捕获的基线的信息，例如每个基线的时间范围和基线类型。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d11457e3334" headers="d11457e3309 ">
                                       <p><code class="codeph">DBA_HIST_BASELINE_DETAILS</code></p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d11457e3334 d11457e3312 ">
                                       <p>显示有关特定基准的详细信息。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d11457e3342" headers="d11457e3309 ">
                                       <p><code class="codeph">DBA_HIST_BASELINE_TEMPLATE</code> 
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d11457e3342 d11457e3312 ">
                                       <p>显示有关系统用于生成基准的基准模板的信息。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d11457e3351" headers="d11457e3309 ">
                                       <p><code class="codeph">DBA_HIST_CON_SYS_TIME_MODEL</code></p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d11457e3351 d11457e3312 ">
                                       <p>显示历史系统时间模型统计信息，包括OLAP定时统计信息。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d11457e3359" headers="d11457e3309 ">
                                       <p><code class="codeph">DBA_HIST_CON_SYSMETRIC_HIST</code></p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d11457e3359 d11457e3312 ">
                                       <p>显示有关系统指标值的历史信息。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d11457e3367" headers="d11457e3309 ">
                                       <p><code class="codeph">DBA_HIST_CON_SYSMETRIC_SUMM</code></p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d11457e3367 d11457e3312 ">
                                       <p>显示长持续时间（60秒）组的系统度量标准中所有度量标准值的统计摘要的历史记录。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d11457e3375" headers="d11457e3309 ">
                                       <p><code class="codeph">DBA_HIST_CON_SYSSTAT</code></p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d11457e3375 d11457e3312 ">
                                       <p>显示历史系统统计信息，包括OLAP内核统计信息。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d11457e3383" headers="d11457e3309 ">
                                       <p><code class="codeph">DBA_HIST_CON_SYSTEM_EVENT</code></p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d11457e3383 d11457e3312 ">
                                       <p>显示有关事件总等待的历史信息。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d11457e3391" headers="d11457e3309 ">
                                       <p><code class="codeph">DBA_HIST_DATABASE_INSTANCE</code></p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d11457e3391 d11457e3312 ">
                                       <p>显示有关数据库环境的信息。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d11457e3399" headers="d11457e3309 ">
                                       <p><code class="codeph">DBA_HIST_DB_CACHE_ADVICE</code> 
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d11457e3399 d11457e3312 ">
                                       <p>显示与每行对应的高速缓存大小的物理读取数的历史预测。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d11457e3409" headers="d11457e3309 ">
                                       <p><code class="codeph">DBA_HIST_DISPATCHER</code></p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d11457e3409 d11457e3312 ">
                                       <p>显示快照时每个调度程序进程的历史信息。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d11457e3417" headers="d11457e3309 ">
                                       <p><code class="codeph">DBA_HIST_DYN_REMASTER_STATS</code> 
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d11457e3417 d11457e3312 ">
                                       <p>显示有关动态重新制作过程的统计信息。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d11457e3426" headers="d11457e3309 ">
                                       <p><code class="codeph">DBA_HIST_IOSTAT_DETAIL</code> 
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d11457e3426 d11457e3312 ">
                                       <p>显示按文件类型和功能聚合的历史I / O统计信息。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d11457e3435" headers="d11457e3309 ">
                                       <p><code class="codeph">DBA_HIST_RSRC_PDB_METRIC</code></p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d11457e3435 d11457e3312 ">
                                       <p>显示过去一小时可插拔数据库（PDB）的资源管理器度量标准的历史信息。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d11457e3443" headers="d11457e3309 ">
                                       <p><code class="codeph">DBA_HIST_RSRC_METRIC</code> 
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d11457e3443 d11457e3312 ">
                                       <p>显示过去一小时内针对使用者组的资源管理器度量标准的历史信息。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d11457e3452" headers="d11457e3309 ">
                                       <p><code class="codeph">DBA_HIST_SHARED_SERVER_SUMMARY</code></p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d11457e3452 d11457e3312 ">
                                       <p>显示共享服务器的历史信息，例如共享服务器活动，公共队列和调度程序队列。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d11457e3460" headers="d11457e3309 ">
                                       <p><code class="codeph">DBA_HIST_SNAPSHOT</code> 
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d11457e3460 d11457e3312 ">
                                       <p>显示有关系统中快照的信息。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d11457e3469" headers="d11457e3309 ">
                                       <p><code class="codeph">DBA_HIST_SQL_PLAN</code></p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d11457e3469 d11457e3312 ">
                                       <p>显示SQL执行计划。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d11457e3477" headers="d11457e3309 ">
                                       <p><code class="codeph">DBA_HIST_WR_CONTROL</code></p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d11457e3477 d11457e3312 ">
                                       <p>显示控制AWR的设置。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d11457e3485" headers="d11457e3309 ">
                                       <p><code class="codeph">DBA_HIST_WR_SETTINGS</code></p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d11457e3485 d11457e3312 ">
                                       <p>显示AWR的设置和元数据。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d11457e3493" headers="d11457e3309 ">
                                       <p><code class="codeph">DBA_HIST_PROCESS_WAITTIME</code></p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d11457e3493 d11457e3312 ">
                                       <p>显示进程类型的CPU和等待时间。</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                        <div class="infoboxnotealso" id="GUID-18E1B278-B3C5-4FE1-8E51-BC8878C439F5__GUID-B6CF0FB2-0A32-4DFD-A2B1-6B1E85557957">
                           <p class="notep1">也可以看看：</p>
                           <p>有关<code class="codeph">DBA_HIST</code>视图的更多信息，请<a href="../refrn/index.html" target="_blank"><span class="italic">参见Oracle数据库参考</span></a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-D64AEB01-18FF-47EF-BB5C-A0611117D180" name="GUID-D64AEB01-18FF-47EF-BB5C-A0611117D180"></a><h4 id="TGDBA-GUID-D64AEB01-18FF-47EF-BB5C-A0611117D180" class="sect4"><span class="enumeration_section">6.2.7</span>在多租户环境中管理自动工作负载存储库</h4>
                  <div>
                     <p>集中式自动工作负载存储库（AWR）在多租户环境中存储与CDB和PDB相关的性能数据。</p>
                     <p>CDB和单个PDB可以存储，查看和管理AWR数据。您可以在CDB级别或PDB级别拍摄AWR快照。</p>
                     <p>本节包含以下主题：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="gathering-database-statistics.html#GUID-8DEFFB31-87F0-45D4-9E3E-C788AE88C5E7" title="在多租户环境中，AWR数据分为不同的类别。">多租户环境中AWR数据的分类</a></p>
                        </li>
                        <li>
                           <p><a href="gathering-database-statistics.html#GUID-2DF8836E-D682-44A6-90BE-ABEAE6F1E2F7">多租户环境中的AWR数据存储和检索</a></p>
                        </li>
                        <li>
                           <p><a href="gathering-database-statistics.html#GUID-4188466A-1206-4945-812B-A4A830DA61BC">在多租户环境中查看AWR数据</a></p>
                        </li>
                     </ul>
                  </div>
                  <div class="props_rev_3"><a id="GUID-8DEFFB31-87F0-45D4-9E3E-C788AE88C5E7" name="GUID-8DEFFB31-87F0-45D4-9E3E-C788AE88C5E7"></a><h5 id="TGDBA-GUID-8DEFFB31-87F0-45D4-9E3E-C788AE88C5E7" class="sect5"><span class="enumeration_section">6.2.7.1</span>多租户环境中AWR数据的分类</h5>
                     <div>
                        <p>在多租户环境中，AWR数据分为不同的类别。</p>
                        <p>分类如下：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>一般AWR数据</p>
                              <p>这些数据没有安全隐患。在CDB的所有租户之间共享是安全的。所有PDB都可以访问此数据，并在CDB级和PDB级快照中捕获这些数据。一般AWR数据的示例包括统计信息，锁存器和参数的名称。</p>
                           </li>
                           <li>
                              <p>CDB的AWR数据</p>
                              <p>此类别汇总了CDB中所有租户的数据。此数据包含整个数据库的状态，仅对CDB管理员有用。仅在CDB级快照中捕获此数据。</p>
                           </li>
                           <li>
                              <p>各个PDB的AWR数据</p>
                              <p>该数据描述了CDB中的各个PDB。它显示了特定于容器的数据，表示每个PDB对整个数据库实例的贡献。因此，此数据对CDB和PDB管理员都很有用。此数据在CDB级和PDB级快照中捕获。</p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <div class="props_rev_3"><a id="GUID-2DF8836E-D682-44A6-90BE-ABEAE6F1E2F7" name="GUID-2DF8836E-D682-44A6-90BE-ABEAE6F1E2F7"></a><h5 id="TGDBA-GUID-2DF8836E-D682-44A6-90BE-ABEAE6F1E2F7" class="sect5"><span class="enumeration_section">6.2.7.2</span>多租户环境中的AWR数据存储和检索</h5>
                     <div>
                        <p>本节介绍在多租户环境中管理快照，导出和导入AWR数据的过程。</p>
                        <div class="section" id="GUID-2DF8836E-D682-44A6-90BE-ABEAE6F1E2F7__AWRDATASTORAGERETRIEVALMULTITENANTENVIRONMENT">
                           <p class="subhead3" id="GUID-2DF8836E-D682-44A6-90BE-ABEAE6F1E2F7__GUID-B6F05BE1-D2B4-4038-90BF-46860A16D82E">管理快照</p>
                           <p>从Oracle Database 12 <span class="italic">c</span>第2版（12.2）开始，您可以在CDB级别（即CDB根目录）以及PDB级别（即单个PDB）上获取AWR快照。默认情况下，CDB级快照数据存储在CDB根的<code class="codeph">SYSAUX</code>表空间中，PDB级快照数据存储在PDB的<code class="codeph">SYSAUX</code>表空间中。</p>
                           <p>CDB级快照包含有关CDB统计信息以及所有PDB统计信息的信息，例如ASH，SQL统计信息和文件统计信息。CDB管理员可以执行特定于CDB的管理操作，例如设置AWR数据保留期，设置快照计划，获取手动快照以及清除CDB根的快照数据。</p>
                           <p>PDB级快照包含PDB统计信息以及一些可用于诊断与PDB相关的性能问题的全局统计信息。 PDB管理员可以执行特定于PDB的管理操作，例如设置AWR数据保留期，设置快照计划，执行手动快照以及清除PDB的快照数据。</p>
                           <p>CDB级和PDB级快照操作（如创建快照和清除快照）可以在<span class="italic">自动模式</span>或<span class="italic">手动模式下执行</span> 。
                           </p>
                           <p>计划自动快照操作，以便在特定时间自动执行。<code class="codeph">AWR_PDB_AUTOFLUSH_ENABLED</code>初始化参数使您可以指定是为CDB中的所有PDB还是CDB中的各个PDB启用或禁用自动快照。默认情况下，CDB会启用自动快照操作，但默认情况下会为PDB禁用。要为PDB启用自动快照，PDB管理员必须连接到该PDB，将<code class="codeph">AWR_PDB_AUTOFLUSH_ENABLED</code>参数的值设置为<code class="codeph">true</code> ，并将快照生成间隔设置为大于0的值。
                           </p>
                           <div class="infoboxnotealso" id="GUID-2DF8836E-D682-44A6-90BE-ABEAE6F1E2F7__GUID-3FE0607E-E356-4A3D-BCC0-041F3B7C999B">
                              <p class="notep1">也可以看看：</p>
                              <p>有关<code class="codeph">AWR_PDB_AUTOFLUSH_ENABLED</code>初始化参数的详细信息，请<code class="codeph">AWR_PDB_AUTOFLUSH_ENABLED</code> <span class="italic"><a href="../refrn/AWR_PDB_AUTOFLUSH_ENABLED.html#REFRN-GUID-08FA21BC-8FB1-4C51-BEEA-139C734D17A7" target="_blank">Oracle数据库参考</a></span></p>
                           </div>
                           <p>手动快照操作由用户明确启动。自动快照和手动快照捕获相同的AWR信息。Oracle建议通常为PDB使用手动快照。出于性能原因，您应仅为PDB选择性地启用自动快照。</p>
                           <p>管理快照的主要界面是Oracle企业管理器云控制（云控制）。如果Cloud Control不可用，则可以使用<code class="codeph">DBMS_WORKLOAD_REPOSITORY</code>包中的过程来管理快照。要使用<code class="codeph">DBMS_WORKLOAD_REPOSITORY</code>包中的过程，需要Oracle DBA角色。用于创建，删除和修改CDB根和PDB的快照的SQL过程与非CDB的快照相同。如果在其过程调用中未提供目标数据库信息，则默认情况下，这些SQL过程在本地数据库上执行其操作。
                           </p>
                           <div class="infoboxnote" id="GUID-2DF8836E-D682-44A6-90BE-ABEAE6F1E2F7__GUID-B45F3745-12B4-47CC-BC58-5C1735A16E70">
                              <p class="notep1">注意：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>PDB级快照具有唯一的快照ID，与CDB级快照无关。</p>
                                 </li>
                                 <li>
                                    <p>CDB中的PDB的插拔操作不会影响存储在PDB上的AWR数据。</p>
                                 </li>
                                 <li>
                                    <p>CDB管理员可以使用<span class="italic">PDB锁定配置文件</span>通过在该PDB上执行以下SQL语句来禁用<span class="italic">PDB</span>的AWR功能：</p><pre class="pre codeblock"><code>SQL&gt; alter lockdown profile <span class="italic">profile_name</span> disable feature =（'AWR_ACCESS'）;</code></pre><p>在PDB上禁用AWR功能后，无法在该PDB上执行快照操作。</p>
                                    <p>通过在该PDB上执行以下SQL语句，可以再次为PDB启用AWR功能：</p><pre class="pre codeblock"><code>SQL&gt; alter lockdown profile <span class="italic">profile_name</span> enable feature =（'AWR_ACCESS'）;</code></pre></li>
                                 <li>
                                    <p>默认情况下，快照数据存储在CDB和PDB的<code class="codeph">SYSAUX</code>表空间中。从Oracle Database 19c开始，您可以通过修改快照设置来指定任何其他表空间来存储CDB和PDB的快照数据。
                                    </p>
                                 </li>
                              </ul>
                           </div>
                           <div class="infoboxnotealso" id="GUID-2DF8836E-D682-44A6-90BE-ABEAE6F1E2F7__GUID-2268F728-D798-4150-90C4-A98C0CCB6DD8">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><span class="q">“ <a href="gathering-database-statistics.html#GUID-70A79E56-18AB-4E85-9494-C0C8F02320AF">创建快照</a> ”</span></p>
                                 </li>
                                 <li>
                                    <p><span class="q">“ <a href="gathering-database-statistics.html#GUID-542ED7D0-ABED-48F4-9D2F-5DADEB610249">删除快照</a> ”</span></p>
                                 </li>
                                 <li>
                                    <p><span class="q">“ <a href="gathering-database-statistics.html#GUID-62D01B30-2687-4821-A651-DC0E4AAC3B01" title="您可以调整间隔，保留期和顶级SQL的数量以刷新快照生成，但请注意，这会影响Oracle数据库诊断工具的精度。">修改快照设置</a> ”</span></p>
                                 </li>
                                 <li>
                                    <p>有关PDB锁定配置文件的详细信息，请参见<span class="italic"><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tgdba&amp;id=DBSEG-GUID-AB5E62DB-7E2A-4B5A-BA96-A2BD2DF15275" target="_blank">“Oracle数据库安全指南”</a></span></p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="section" -->
                        <div class="section" id="GUID-2DF8836E-D682-44A6-90BE-ABEAE6F1E2F7__EXPORTINGANDIMPORTINGAWRDATA-0F8D6D91">
                           <p class="subhead3" id="GUID-2DF8836E-D682-44A6-90BE-ABEAE6F1E2F7__GUID-E4C594E4-F783-436A-8F02-FA34EFDD5255">导出和导入AWR数据</p>
                           <p>在多租户环境中导出和导入CDB根和PDB的AWR数据的过程类似于导出和导入非CDB的AWR数据的过程。</p>
                           <div class="infoboxnotealso" id="GUID-2DF8836E-D682-44A6-90BE-ABEAE6F1E2F7__GUID-29F470DF-D284-4DC8-AB44-712EAAC5AA1E">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><span class="q">“ <a href="gathering-database-statistics.html#GUID-CC6A87BD-BFEA-4A1B-9FD1-3445DC11BE72">导出AWR数据</a> ”</span>以获取有关从Oracle数据库导出AWR数据的信息</p>
                                 </li>
                                 <li>
                                    <p><span class="q">“ <a href="gathering-database-statistics.html#GUID-C916E80F-B819-4452-ABFC-18CA70D8A501">导入AWR数据</a> ”</span>以获取有关将AWR数据导入Oracle数据库的信息</p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
                  <div class="props_rev_3"><a id="GUID-4188466A-1206-4945-812B-A4A830DA61BC" name="GUID-4188466A-1206-4945-812B-A4A830DA61BC"></a><h5 id="TGDBA-GUID-4188466A-1206-4945-812B-A4A830DA61BC" class="sect5"><span class="enumeration_section">6.2.7.3</span>在多租户环境中查看AWR数据</h5>
                     <div>
                        <p>您可以使用各种Oracle数据库报告和视图在多租户环境中查看AWR数据。</p>
                        <div class="section" id="GUID-4188466A-1206-4945-812B-A4A830DA61BC__AWRREPORTS-310DB0DA">
                           <p class="subhead3" id="GUID-4188466A-1206-4945-812B-A4A830DA61BC__GUID-C632FF64-53E0-4E75-BE9B-CB1E5CB693E3">AWR报告</p>
                           <p>生成AWR报告的主要界面是Oracle企业管理器云控制（云控制）。尽可能使用Cloud Control生成AWR报告。</p>
                           <div class="infoboxnotealso" id="GUID-4188466A-1206-4945-812B-A4A830DA61BC__GUID-97A07075-AD34-42C0-A122-16B1D5BFA793">
                              <p class="notep1">也可以看看：</p>
                              <p>有关使用Cloud Control生成AWR报告的详细信息，请参阅<span class="italic"><a href="../tdppt/resolving-performance-degradation-over-time.html#TDPPT-GUID-71C2B1BD-6906-47B0-9FF5-BD3268F0C7C8" target="_blank">“Oracle数据库2天+性能调整指南”</a></span></p>
                           </div>
                           <p>如果Cloud Control不可用，则可以通过运行SQL脚本生成AWR报告，如下所述。运行这些脚本需要DBA角色。</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>您可以从CDB根生成CDB特定的AWR报告，该报告显示整个多租户环境的<span class="italic">全局系统数据</span>统计信息。您可以使用<span class="q"><a href="gathering-database-statistics.html#GUID-B7D1B185-4942-4934-9B21-A9010F82A4FF">“为本地数据库生成AWR报告</a> ” <a href="gathering-database-statistics.html#GUID-B7D1B185-4942-4934-9B21-A9010F82A4FF">一</a></span>节中描述的SQL脚本生成此AWR报告。
                                 </p>
                              </li>
                              <li>
                                 <p>您可以从PDB生成特定于PDB的AWR报告，该报告显示与该PDB相关的统计信息。您可以使用<span class="q"><a href="gathering-database-statistics.html#GUID-B7D1B185-4942-4934-9B21-A9010F82A4FF">“为本地数据库生成AWR报告</a> ” <a href="gathering-database-statistics.html#GUID-B7D1B185-4942-4934-9B21-A9010F82A4FF">一</a></span>节中描述的SQL脚本生成此AWR报告。
                                 </p>
                              </li>
                              <li>
                                 <p>您可以从CDB根生成特定于PDB的AWR报告，该报告显示与特定PDB相关的统计信息。您可以使用<span class="q"><a href="gathering-database-statistics.html#GUID-EB7B34CD-6F4B-4010-9A8A-E1C7B8F2F851">“为特定数据库生成AWR报告</a> ” <a href="gathering-database-statistics.html#GUID-EB7B34CD-6F4B-4010-9A8A-E1C7B8F2F851">一</a></span>节中描述的SQL脚本生成此AWR报告。
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                        <div class="section" id="GUID-4188466A-1206-4945-812B-A4A830DA61BC__AWRVIEWS-310DC118">
                           <p class="subhead3" id="GUID-4188466A-1206-4945-812B-A4A830DA61BC__GUID-7ADD0370-23FE-4436-860E-8861B9EC1EFD">AWR视图</p>
                           <p>下表列出了用于访问存储在CDB根目录上的AWR数据和多租户环境中的各个PDB的Oracle数据库视图。</p>
                           <div class="infoboxnotealso" id="GUID-4188466A-1206-4945-812B-A4A830DA61BC__GUID-C6461361-1D71-4A1A-AE18-D4756FBF4069">
                              <p class="notep1">也可以看看：</p>
                              <p><span class="q">“ <a href="gathering-database-statistics.html#GUID-18E1B278-B3C5-4FE1-8E51-BC8878C439F5">使用自动工作负载存储库视图</a> ”</span>以获取有关这些AWR视图的更多信息</p>
                           </div>
                           <div class="tblformalwide" id="GUID-4188466A-1206-4945-812B-A4A830DA61BC__GUID-732FDECC-3C26-4DDF-A8F3-212F4EE1FA11">
                              <p class="titleintable">表6-2在多租户环境中访问AWR数据的视图</p>
                              <table cellpadding="4" cellspacing="0" class="FormalWide" title="在多租户环境中访问AWR数据的视图" width="100%" border="1" summary="This table lists the Oracle Database views that can be used to access the AWR data stored on the CDB root and the individual PDBs in a multitenant environment." frame="hsides" rules="rows">
                                 <thead>
                                    <tr align="left" valign="top">
                                       <th align="left" valign="bottom" width="20%" id="d11457e3970">查看</th>
                                       <th align="left" valign="bottom" width="20%" id="d11457e3972">描述</th>
                                    </tr>
                                 </thead>
                                 <tbody>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="20%" id="d11457e3976" headers="d11457e3970 ">
                                          <p><code class="codeph">DBA_HIST</code>视图</p>
                                       </td>
                                       <td align="left" valign="top" width="20%" headers="d11457e3976 d11457e3972 ">
                                          <ul style="list-style-type:disc">
                                             <li>
                                                <p><code class="codeph">DBA_HIST</code>视图显示仅存在于CDB根目录上的AWR数据。
                                                </p>
                                             </li>
                                             <li>
                                                <p>从CDB根访问<code class="codeph">DBA_HIST</code>视图时，它们显示存储在CDB根目录中的所有AWR数据。
                                                </p>
                                             </li>
                                             <li>
                                                <p>当从PDB访问<code class="codeph">DBA_HIST</code>视图时，它们显示CDB根AWR数据的子集，该子集特定于该PDB。</p>
                                             </li>
                                          </ul>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="20%" id="d11457e4002" headers="d11457e3970 ">
                                          <p><code class="codeph">DBA_HIST_CON</code>视图</p>
                                       </td>
                                       <td align="left" valign="top" width="20%" headers="d11457e4002 d11457e3972 ">
                                          <ul style="list-style-type:disc">
                                             <li>
                                                <p><code class="codeph">DBA_HIST_CON</code>视图类似于<code class="codeph">DBA_HIST</code>视图，但它们提供有关每个容器的更细粒度的信息，因此，它们具有比<code class="codeph">DBA_HIST</code>视图更多的数据。
                                                </p>
                                             </li>
                                             <li>
                                                <p><code class="codeph">DBA_HIST_CON</code>视图显示仅在CDB根目录上存在的AWR数据。
                                                </p>
                                             </li>
                                             <li>
                                                <p>从CDB根访问<code class="codeph">DBA_HIST_CON</code>视图时，它们显示存储在CDB根目录中的所有AWR数据。
                                                </p>
                                             </li>
                                             <li>
                                                <p>当从PDB访问<code class="codeph">DBA_HIST_CON</code>视图时，它们显示CDB根AWR数据的子集，该子集特定于该PDB。</p>
                                             </li>
                                          </ul>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="20%" id="d11457e4040" headers="d11457e3970 ">
                                          <p><code class="codeph">AWR_ROOT</code>视图</p>
                                       </td>
                                       <td align="left" valign="top" width="20%" headers="d11457e4040 d11457e3972 ">
                                          <ul style="list-style-type:disc">
                                             <li>
                                                <p><code class="codeph">AWR_ROOT</code>视图从Oracle Database 12 <span class="italic">c</span>第2版（12.2）开始提供，仅在Multitenant环境中可用。
                                                </p>
                                             </li>
                                             <li>
                                                <p><code class="codeph">AWR_ROOT</code>视图等同于<code class="codeph">DBA_HIST</code>视图。
                                                </p>
                                             </li>
                                             <li>
                                                <p><code class="codeph">AWR_ROOT</code>视图显示仅在CDB根目录上存在的AWR数据。
                                                </p>
                                             </li>
                                             <li>
                                                <p>从CDB根访问<code class="codeph">AWR_ROOT</code>视图时，它们显示存储在CDB根目录中的所有AWR数据。
                                                </p>
                                             </li>
                                             <li>
                                                <p>当从PDB访问<code class="codeph">AWR_ROOT</code>视图时，它们显示CDB根AWR数据的子集，该子集特定于该PDB。</p>
                                             </li>
                                          </ul>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="20%" id="d11457e4084" headers="d11457e3970 ">
                                          <p><code class="codeph">AWR_PDB</code>视图</p>
                                       </td>
                                       <td align="left" valign="top" width="20%" headers="d11457e4084 d11457e3972 ">
                                          <ul style="list-style-type:disc">
                                             <li>
                                                <p>从Oracle Database 12 <span class="italic">c</span>第2版（12.2）开始，可以使用<code class="codeph">AWR_PDB</code>视图。
                                                </p>
                                             </li>
                                             <li>
                                                <p><code class="codeph">AWR_PDB</code>视图显示CDB根或PDB上存在的本地AWR数据。</p>
                                             </li>
                                             <li>
                                                <p>从CDB根访问<code class="codeph">AWR_PDB</code>视图时，它们显示存储在CDB根目录上的AWR数据。
                                                </p>
                                             </li>
                                             <li>
                                                <p>当从PDB访问<code class="codeph">AWR_PDB</code>视图时，它们显示存储在该PDB上的AWR数据。</p>
                                             </li>
                                          </ul>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="20%" id="d11457e4119" headers="d11457e3970 ">
                                          <p><code class="codeph">CDB_HIST</code>视图</p>
                                       </td>
                                       <td align="left" valign="top" width="20%" headers="d11457e4119 d11457e3972 ">
                                          <ul style="list-style-type:disc">
                                             <li>
                                                <p><code class="codeph">CDB_HIST</code>视图显示存储在PDB上的AWR数据。
                                                </p>
                                             </li>
                                             <li>
                                                <p>当从CDB根访问<code class="codeph">CDB_HIST</code>视图时，它们显示存储在所有PDB上的AWR数据的并集。
                                                </p>
                                             </li>
                                             <li>
                                                <p>当从PDB访问<code class="codeph">CDB_HIST</code>视图时，它们显示存储在该PDB上的AWR数据。</p>
                                             </li>
                                          </ul>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <!-- class="inftblhruleinformal" -->
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-309C107F-DC42-4119-9904-9504E9748B84" name="GUID-309C107F-DC42-4119-9904-9504E9748B84"></a><h4 id="TGDBA-GUID-309C107F-DC42-4119-9904-9504E9748B84" class="sect4"><span class="enumeration_section">6.2.8</span>在Active Data Guard备用数据库中管理自动工作负载存储库</h4>
                  <div>
                     <p>从Oracle Database 12 <span class="italic">c</span>第2版（12.2）开始，可以为Active Data Guard（ADG）备用数据库捕获自动工作负载存储库（AWR）数据。此功能可以分析ADG备用数据库的任何与性能相关的问题。
                     </p>
                     <p>ADG备用数据库的AWR快照称为<span class="italic">远程快照</span> 。称为<span class="italic">destination的</span>数据库节点负责存储从远程ADG备用数据库节点（称为<span class="italic">源）</span>收集的快照。
                     </p>
                     <p>目标可以是ADG主数据库或非ADG数据库。如果目标是ADG主数据库，则它也是源数据库，其快照是<span class="italic">本地快照</span> 。
                     </p>
                     <p>源由唯一的名称或<span class="italic">源名称</span>标识，目的地通知该名称或<span class="italic">源名称</span> 。
                     </p>
                     <p>您可以在配置期间为目标节点或源节点分配名称。否则，将初始化参数<code class="codeph">DB_UNIQUE_NAME</code>值指定为节点的名称。
                     </p>
                     <p>每个源必须具有两个数据库链接，即目标到源数据库链接和源到目标数据库链接。在ADG部署期间为每个源配置这些数据库链接。您必须在某些ADG事件（例如故障转移，切换以及主机的添加和删除）之后手动重新配置这些数据库链接，以便数据库应用程序在这些事件之后继续正常运行。</p>
                     <p>您可以按预定的时间间隔自动拍摄远程快照，也可以手动拍摄远程快照。远程快照始终由目标节点启动。目标启动快照创建过程后，源会使用数据库链接<span class="italic">将</span>其快照数据<span class="italic">推</span>送到目标。可以使用AWR报告，Oracle数据库导入和导出功能以及用户定义的查询来访问存储在目标上的快照数据或<span class="italic">AWR数据</span> 。自动数据库诊断监视器（ADDM）应用程序可以使用AWR数据分析任何与数据库性能相关的问题。
                     </p>
                     <div class="section" id="GUID-309C107F-DC42-4119-9904-9504E9748B84__DESTINATIONDATABASERESPONSIBILITIES-350A67B5">
                        <p class="subhead3" id="GUID-309C107F-DC42-4119-9904-9504E9748B84__DESTINATIONDATABASERESPONSIBILITIES-FAC9F5C1">目的地数据库责任</p>
                        <p>目标数据库管理以下任务：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>注册来源</p>
                           </li>
                           <li>
                              <p>为每个源分配唯一标识符</p>
                           </li>
                           <li>
                              <p>在目标和源之间创建数据库链接</p>
                           </li>
                           <li>
                              <p>为源安排和启动自动快照</p>
                           </li>
                           <li>
                              <p>通过协调源之间的快照来管理目标工作负载</p>
                           </li>
                           <li>
                              <p>管理每个源的快照设置</p>
                           </li>
                           <li>
                              <p>为新生成的快照分配标识符</p>
                           </li>
                           <li>
                              <p>对AWR表进行分区</p>
                           </li>
                           <li>
                              <p>将性能数据存储在本地AWR中</p>
                           </li>
                           <li>
                              <p>清除目的地和来源的AWR数据</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section" id="GUID-309C107F-DC42-4119-9904-9504E9748B84__SOURCEDATABASERESPONSIBILITIES-350A828E">
                        <p class="subhead3" id="GUID-309C107F-DC42-4119-9904-9504E9748B84__SOURCEDATABASERESPONSIBILITIES-FAC9F1EF">来源数据库责任</p>
                        <p>源数据库管理以下任务：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>将其性能数据存储在本地AWR中</p>
                           </li>
                           <li>
                              <p>将其AWR数据发送到目的地</p>
                           </li>
                           <li>
                              <p>响应来自目的地的服务请求</p>
                           </li>
                           <li>
                              <p>从目标中提取AWR数据</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-309C107F-DC42-4119-9904-9504E9748B84__MAJORSTEPSFORMANAGINGAWRINADGSTANDB-FAC9FEE2">在ADG备用数据库中管理AWR的主要步骤</p>
                        <p>以下是在ADG备用数据库中管理AWR的主要步骤：</p>
                        <ol>
                           <li>
                              <p><a href="gathering-database-statistics.html#GUID-E1369092-DA6B-4CF4-B286-69D4A3BDFA1E">配置远程管理框架（RMF）</a></p>
                           </li>
                           <li>
                              <p><a href="gathering-database-statistics.html#GUID-D37F8265-2CBB-4906-8AD8-D6DB6E6D0B44">管理Active Data Guard备用数据库的快照</a></p>
                           </li>
                           <li>
                              <p><a href="gathering-database-statistics.html#GUID-751B53F2-0101-4AEE-8709-1978120249E1">在Active Data Guard备用数据库中查看AWR数据</a></p>
                           </li>
                        </ol>
                        <div class="infoboxnote" id="GUID-309C107F-DC42-4119-9904-9504E9748B84__GUID-2DFE1B4C-D585-473C-B9E7-FBAB9E2ABB6A">
                           <p class="notep1">注意：</p>
                           <p>在开始为ADG环境配置AWR之前，请确保在ADG部署期间已配置所有ADG备用数据库的数据库链接。</p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div class="props_rev_3"><a id="GUID-E1369092-DA6B-4CF4-B286-69D4A3BDFA1E" name="GUID-E1369092-DA6B-4CF4-B286-69D4A3BDFA1E"></a><h5 id="TGDBA-GUID-E1369092-DA6B-4CF4-B286-69D4A3BDFA1E" class="sect5"><span class="enumeration_section">6.2.8.1</span>配置远程管理框架（RMF）</h5>
                     <div>
                        <p>远程管理框架（RMF）是一种用于捕获Oracle数据库中的性能统计信息（AWR数据）的体系结构。</p>
                        <div class="infoboxnote" id="GUID-E1369092-DA6B-4CF4-B286-69D4A3BDFA1E__GUID-CFA6D1CA-F33D-424D-88D9-10E8F2DBC56E">
                           <p class="notep1">注意：</p>
                           <p>RMF只能用于ADG备用数据库和独立数据库。</p>
                        </div>
                        <p>RMF <span class="italic">拓扑</span>是一种集中式体系结构，由所有参与的数据库节点及其元数据和连接信息组成。RMF拓扑具有一个名为<span class="italic">destination的</span>数据库节点，该节点负责存储和管理从数据库节点（称为<span class="italic">源</span> ）收集的性能数据（AWR数据）。<span class="italic">候选目标</span>是可以在原始目标不可用或降级时替换原始目标的方式配置的源。拓扑只能有一个目标和一个或多个候选目标。
                        </p>
                        <p>必须为拓扑中的每个数据库节点分配唯一的名称。这可以在配置节点期间使用过程<code class="codeph">DBMS_UMF.configure_node()</code>来完成。如果在此过程中未提供节点的名称，则初始化参数<code class="codeph">DB_UNIQUE_NAME</code>的值将用作节点的名称。
                        </p>
                        <p>拓扑中的数据库节点使用数据库链接相互通信。必须在ADG部署期间为每个ADG备用数据库创建目标到源和源到目标之间的数据库链接。</p>
                        <p><span class="italic">服务</span>是在拓扑上运行的应用程序。例如，在拓扑上运行的AWR服务为该拓扑中的所有数据库节点启用远程AWR快照。
                        </p>
                        <p>RMF API是可用于配置RMF拓扑的PL / SQL过程和函数。RMF API在PL / SQL包<code class="codeph">DBMS_UMF</code> 。</p>
                        <div class="infoboxnote" id="GUID-E1369092-DA6B-4CF4-B286-69D4A3BDFA1E__GUID-3AB107A9-FEAE-4522-A3CE-8EDECE532AB1">
                           <p class="notep1">注意：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><code class="codeph">SYS$UMF</code>用户是默认数据库用户，具有访问系统级RMF视图和表的所有权限。RMF中的所有AWR相关操作只能由<code class="codeph">SYS$UMF</code>用户执行。<code class="codeph">SYS$UMF</code>用户默认处于锁定状态，必须在部署RMF拓扑之前解锁。
                                 </p>
                              </li>
                              <li>
                                 <p>在RMF拓扑中创建数据库链接时，需要为<code class="codeph">SYS$UMF</code>用户提供密码。如果更改了<code class="codeph">SYS$UMF</code>用户的密码，则必须重新创建RMF拓扑中的所有数据库链接。
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <div class="infoboxnotealso" id="GUID-E1369092-DA6B-4CF4-B286-69D4A3BDFA1E__GUID-F64DAC41-23DD-433B-9D29-5F8A4E0115FC">
                           <p class="notep1">也可以看看：</p>
                           <p>有关<code class="codeph">DBMS_UMF</code>包的更多信息，请<code class="codeph">DBMS_UMF</code> <span class="italic"><a href="../arpls/DBMS_UMF.html#ARPLS-GUID-9B44C2DE-512A-4B55-B91E-9828FCF04BFD" target="_blank">Oracle Database PL / SQL包和类型参考</a></span></p>
                        </div>
                        <div class="section">
                           <p class="subhead3" id="GUID-E1369092-DA6B-4CF4-B286-69D4A3BDFA1E__GUID-401A34FB-DDA2-4E4E-8127-AFE33E3DF9EA">设置RMF拓扑</p>
                           <p>您需要设置RMF拓扑以收集Oracle数据库的性能统计信息。</p>
                           <p>以下是设置RMF拓扑的先决条件：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>您必须为要在RMF拓扑中注册的所有数据库节点的源和源目标数据库链接创建目标。此设置应在ADG部署期间完成。</p>
                              </li>
                           </ul>
                           <p>以下是设置RMF拓扑的步骤：</p>
                           <ol>
                              <li>
                                 <p>配置要添加到拓扑的数据库节点。</p>
                              </li>
                              <li>
                                 <p>创建拓扑。</p>
                              </li>
                              <li>
                                 <p>使用拓扑注册数据库节点。</p>
                              </li>
                              <li>
                                 <p>（可选）注册拓扑中节点之间的数据库链接。当目标变得不可用且候选目标需要使用数据库链接连接到拓扑中的其余节点时，需要此配置。</p>
                              </li>
                           </ol>
                           <p><span class="bold">设置RMF拓扑的示例</span></p>
                           <p>在此示例中，三个数据库节点<code class="codeph">T</code> ， <code class="codeph">S0</code>和<code class="codeph">S1</code>被添加到拓扑<code class="codeph">Topology_1</code> 。节点<code class="codeph">T</code>是目的节点，节点<code class="codeph">S0</code>和<code class="codeph">S1</code>是源节点。节点<code class="codeph">S1</code>是候选目的地，即，当原始目的地<code class="codeph">T</code>不可用时，节点<code class="codeph">S1</code>成为新目的地。为拓扑中的所有源启用AWR服务。
                           </p>
                           <p>假设在ADG部署期间已创建以下数据库链接：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><code class="codeph">DBLINK_T_to_S0</code> ：从<code class="codeph">T</code>到<code class="codeph">S0</code>数据库链接。
                                 </p>
                              </li>
                              <li>
                                 <p><code class="codeph">DBLINK_T_to_S1</code> ：从<code class="codeph">T</code>到<code class="codeph">S1</code>数据库链接。
                                 </p>
                              </li>
                              <li>
                                 <p><code class="codeph">DBLINK_S0_to_T</code> ：从<code class="codeph">S0</code>到<code class="codeph">T</code>数据库链接。</p>
                              </li>
                              <li>
                                 <p><code class="codeph">DBLINK_S0_to_S1</code> ：从<code class="codeph">S0</code>到<code class="codeph">S1</code>数据库链接。
                                 </p>
                              </li>
                              <li>
                                 <p><code class="codeph">DBLINK_S1_to_T</code> ：从<code class="codeph">S1</code>到<code class="codeph">T</code>数据库链接。</p>
                              </li>
                              <li>
                                 <p><code class="codeph">DBLINK_S1_to_S0</code> ：从<code class="codeph">S1</code>到<code class="codeph">S0</code>数据库链接。
                                 </p>
                              </li>
                           </ul>
                           <p>以下是设置RMF拓扑的示例代码：</p><pre class="pre codeblock"><code>/ *通过执行以下过程配置节点T，S0和S1 * / / *在节点T * / SQL&gt; exec DBMS_UMF.configure_node（'T'）上执行此过程; / *在节点S0 * / SQL&gt; exec DBMS_UMF.configure_node（'S0'，'DBLINK_S0_to_T'）上执行此过程; / *在节点S1 * / SQL&gt; exec DBMS_UMF.configure_node（'S1'，'DBLINK_S1_to_T'）上执行此过程; / *在目标节点上执行以下所有过程T * / / *创建拓扑'Topology_1'* / SQL&gt; exec DBMS_UMF.create_topology（'Topology_1'）; / *使用拓扑'Topology_1'* / SQL&gt; exec DBMS_UMF.register_node注册节点S0（'Topology_1'，'S0'，'DBLINK_T_to_S0'，'DBLINK_S0_to_T'，'TRUE'/ *将其设置为源* /， 'FALSE'/ *将其设置为<span class="italic">不是</span>候选目的地* /）; / *使用拓扑“Topology_1”* / SQL&gt; exec DBMS_UMF.register_node注册节点S1（“Topology_1”，“S1”，“DBLINK_T_to_S1”，“DBLINK_S1_to_T”，“TRUE”/ *将其设置为源* /， 'TRUE'/ *将其设置为候选目的地* /）; / *在拓扑“拓扑_1”中注册节点S0和S1之间的数据库链接。*当故障转移时目标T不可用时，源S0可以使用此数据库链接将*连接到候选目标S1。* / SQL&gt; exec DBMS_UMF.create_link（'Topology_1'，'S0'，'S1'，'DBLINK_S0_to_S1'，'DBLINK_S1_to_S0'）; / *在拓扑“拓扑_1”* / SQL&gt; exec DBMS_WORKLOAD_REPOSITORY.register_remote_database（node_name =&gt;'S0'）中的节点S0上启用AWR服务; / *在拓扑“拓扑_1”* / SQL&gt; exec DBMS_WORKLOAD_REPOSITORY.register_remote_database（node_name =&gt;'S1'）中的节点S1上启用AWR服务;</code></pre><div class="infoboxnote" id="GUID-E1369092-DA6B-4CF4-B286-69D4A3BDFA1E__GUID-D4ACE19A-10D4-482D-9853-05527529FA54">
                              <p class="notep1">注意：</p>
                              <p>可以使用以下过程为节点禁用AWR服务：</p><pre class="pre codeblock"><code>SQL&gt; exec DBMS_WORKLOAD_REPOSITORY.unregister_remote_database（ <span class="italic">node_name</span> ）</code></pre></div>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-E1369092-DA6B-4CF4-B286-69D4A3BDFA1E__GUID-68BE322A-A524-4480-8767-41A306FA8A5B">管理ADG角色转换</p>
                           <p>当ADG主目标或原始目标失败（ <span class="italic">故障转移</span>事件）或ADG备用数据库或候选目标在维护阶段（ <span class="italic">切换</span>事件）中接管ADG主要角色时，会发生ADG角色<span class="italic">转换</span> 。
                           </p>
                           <p>Oracle建议您在更改角色之前执行以下配置步骤，即在将候选目标作为故障转移或切换事件的新目标之前执行：</p>
                           <ol>
                              <li>
                                 <p>在源和候选目标之间创建数据库链接。必须通过对每个源执行以下过程为所有源完成此配置：</p><pre class="pre codeblock"><code>SQL&gt; EXEC DBMS_UMF.CREATE_LINK（ <span class="italic">拓扑名称</span> ， <span class="italic">源名称</span> ， <span class="italic">候选目标名称</span> ， <span class="italic">候选目标数据库链接源</span> ， <span class="italic">源数据库链接的</span> <span class="italic">候选目标</span> ）;</code></pre><div class="infoboxnote" id="GUID-E1369092-DA6B-4CF4-B286-69D4A3BDFA1E__GUID-82D9B61A-65FB-41B3-8AD7-868694C270E1">
                                    <p class="notep1">注意：</p>
                                    <p>Oracle建议您在拓扑中的所有节点之间创建数据库链接，以避免在角色更改时可能出现的任何意外问题。</p>
                                 </div>
                              </li>
                              <li>
                                 <p>在候选目的地上拍摄AWR快照。</p>
                                 <div class="infoboxnote" id="GUID-E1369092-DA6B-4CF4-B286-69D4A3BDFA1E__GUID-A1EA62F8-E849-4800-A5D9-9DEAF568E241">
                                    <p class="notep1">注意：</p>
                                    <p>要在角色更改后为候选目标生成AWR报告，请在角色更改之前为候选目标创建至少一个快照。</p>
                                 </div>
                              </li>
                              <li>
                                 <p>重新启动候选目标以及所有源。</p>
                              </li>
                           </ol>
                           <p>完成上述配置步骤后，您可以通过在候选目标上执行以下过程来更改角色：</p><pre class="pre codeblock"><code>SQL&gt; EXEC DBMS_UMF.SWITCH_DESTINATION（ <span class="italic">拓扑名称</span> ，force_switch =&gt; FALSE）;</code></pre><div class="infoboxnote" id="GUID-E1369092-DA6B-4CF4-B286-69D4A3BDFA1E__GUID-80993672-E6CE-4402-9763-93A555B85390">
                              <p class="notep1">注意：</p>
                              <p>Oracle建议您在角色转换期间不要为源创建任何快照。通过执行<code class="codeph">DBMS_UMF.SWITCH_DESTINATION</code>过程完成角色更改过程后，您可以为源创建快照。如果要在角色更改后为源生成AWR报告，则必须仅选择角色更改后拍摄的快照。
                              </p>
                           </div>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-E1369092-DA6B-4CF4-B286-69D4A3BDFA1E__GUID-2FBCD71F-A170-478C-A84C-768A871FE3C5">获取已注册的RMF拓扑的详细信息</p>
                           <p>下面描述的RMF视图显示了有关多数据库环境中所有已注册RMF拓扑的配置信息。</p>
                           <div class="tblformal" id="GUID-E1369092-DA6B-4CF4-B286-69D4A3BDFA1E__GUID-F16EDAB9-C97A-4136-AF63-178206DE182A">
                              <p class="titleintable">表6-3 RMF视图</p>
                              <table cellpadding="4" cellspacing="0" class="Formal" title="RMF观点" width="100%" border="1" summary="This table lists the RMF views." frame="hsides" rules="rows">
                                 <thead>
                                    <tr align="left" valign="top">
                                       <th align="left" valign="bottom" width="20%" id="d11457e4662">RMF查看</th>
                                       <th align="left" valign="bottom" width="20%" id="d11457e4665">描述</th>
                                    </tr>
                                 </thead>
                                 <tbody>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="20%" id="d11457e4670" headers="d11457e4662 ">
                                          <p><code class="codeph">DBA_UMF_TOPOLOGY</code></p>
                                       </td>
                                       <td align="left" valign="top" width="20%" headers="d11457e4670 d11457e4665 ">
                                          <p>显示多数据库环境中的所有已注册拓扑。每个拓扑都具有拓扑名称，目标ID和拓扑状态。要启用RMF，至少一个拓扑的拓扑状态应为<code class="codeph">ACTIVE</code> 。</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="20%" id="d11457e4681" headers="d11457e4662 ">
                                          <p><code class="codeph">DBA_UMF_REGISTRATION</code></p>
                                       </td>
                                       <td align="left" valign="top" width="20%" headers="d11457e4681 d11457e4665 ">
                                          <p>显示多数据库环境中所有拓扑中的所有已注册节点。</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="20%" id="d11457e4689" headers="d11457e4662 ">
                                          <p><code class="codeph">DBA_UMF_LINK</code></p>
                                       </td>
                                       <td align="left" valign="top" width="20%" headers="d11457e4689 d11457e4665 ">
                                          <p>显示多数据库环境中所有拓扑中的所有已注册数据库链接。</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="20%" id="d11457e4697" headers="d11457e4662 ">
                                          <p><code class="codeph">DBA_UMF_SERVICE</code></p>
                                       </td>
                                       <td align="left" valign="top" width="20%" headers="d11457e4697 d11457e4665 ">
                                          <p>显示多数据库环境中所有拓扑中的所有已注册服务。</p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <!-- class="inftblhruleinformal" -->
                           <div class="infoboxnotealso" id="GUID-E1369092-DA6B-4CF4-B286-69D4A3BDFA1E__GUID-5D89A840-893A-4BE4-82EC-F4B9209C137F">
                              <p class="notep1">也可以看看：</p>
                              <p>有关这些RMF视图的更多信息，请<span class="italic"><a href="../refrn/index.html" target="_blank">参见Oracle数据库参考</a></span></p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
                  <div class="props_rev_3"><a id="GUID-D37F8265-2CBB-4906-8AD8-D6DB6E6D0B44" name="GUID-D37F8265-2CBB-4906-8AD8-D6DB6E6D0B44"></a><h5 id="TGDBA-GUID-D37F8265-2CBB-4906-8AD8-D6DB6E6D0B44" class="sect5"><span class="enumeration_section">6.2.8.2</span>管理Active Data Guard备用数据库的快照</h5>
                     <div>
                        <p>ADG备用数据库的AWR快照称为<span class="italic">远程</span>快照。与本地AWR快照类似，远程AWR快照可以按预定的时间间隔自动生成，也可以手动生成。<span class="italic">Push-on-Demand</span>机制用于生成远程快照，其中快照生成过程由目标启动，然后目标指示源开始通过数据库链接将快照数据<span class="italic">推</span>送到目标。目标定期根据为每个源配置的快照时间间隔启动自动快照。
                        </p>
                        <div class="infoboxnote" id="GUID-D37F8265-2CBB-4906-8AD8-D6DB6E6D0B44__GUID-8647E713-37BA-4B93-84FB-1BEB979C434E">
                           <p class="notep1">注意：</p>
                           <p>目标负责根据各个源的快照数据或<span class="italic">AWR数据</span>保留设置清除过期的远程快照。清除本地生成的快照是定期计划的清除过程的一部分。默认情况下，Oracle数据库会自动清除已存储在AWR中超过8天的快照。远程快照的AWR表分区的方式与本地快照的分区方式相同。
                           </p>
                        </div>
                        <div class="section" id="GUID-D37F8265-2CBB-4906-8AD8-D6DB6E6D0B44__CREATINGMODIFYINGANDDELETINGREMOTES-39187220">
                           <p class="subhead3" id="GUID-D37F8265-2CBB-4906-8AD8-D6DB6E6D0B44__GUID-8603AA78-0F27-4064-BA76-BA747A782227">创建，修改和删除远程快照</p>
                           <p>用于创建，修改和删除<span class="italic">远程</span>快照的API与<span class="italic">本地</span>快照的API相同。
                           </p>
                           <div class="infoboxnote" id="GUID-D37F8265-2CBB-4906-8AD8-D6DB6E6D0B44__GUID-C37B76E7-A98A-461E-8783-25C961CC550A">
                              <p class="notep1">注意：</p>
                              <p>要创建<span class="italic">远程</span>快照，还可以使用<code class="codeph">DBMS_WORKLOAD_REPOSITORY.CREATE_REMOTE_SNAPSHOT</code> API。此API的工作方式类似于<span class="italic">本地</span>快照创建API <code class="codeph">DBMS_WORKLOAD_REPOSITORY.CREATE_SNAPSHOT</code> ，但它采用RMF拓扑名称的附加参数。
                              </p>
                           </div>
                           <div class="infoboxnotealso" id="GUID-D37F8265-2CBB-4906-8AD8-D6DB6E6D0B44__GUID-2558A863-20DA-4750-A051-4DDEBBA8F1C9">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><span class="q">“ <a href="gathering-database-statistics.html#GUID-70A79E56-18AB-4E85-9494-C0C8F02320AF">创建快照</a> ”</span></p>
                                 </li>
                                 <li>
                                    <p><span class="q">“ <a href="gathering-database-statistics.html#GUID-62D01B30-2687-4821-A651-DC0E4AAC3B01" title="您可以调整间隔，保留期和顶级SQL的数量以刷新快照生成，但请注意，这会影响Oracle数据库诊断工具的精度。">修改快照设置</a> ”</span></p>
                                 </li>
                                 <li>
                                    <p><span class="q">“ <a href="gathering-database-statistics.html#GUID-542ED7D0-ABED-48F4-9D2F-5DADEB610249">删除快照</a> ”</span></p>
                                 </li>
                                 <li>
                                    <p><span class="italic"><a href="../arpls/DBMS_WORKLOAD_REPOSITORY.html#ARPLS-GUID-B58FD031-FF96-4569-B0C8-DECA33F364E6" target="_blank">Oracle Database PL / SQL包和类型参考</a></span> ，了解<code class="codeph">DBMS_WORKLOAD_REPOSITORY.CREATE_REMOTE_SNAPSHOT</code> API的语法。</p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="section" -->
                        <div class="section" id="GUID-D37F8265-2CBB-4906-8AD8-D6DB6E6D0B44__MANAGINGBASELINES-07B967F2">
                           <p class="subhead3" id="GUID-D37F8265-2CBB-4906-8AD8-D6DB6E6D0B44__GUID-DCC6FA78-D923-4FA5-A41A-A06FC03E465E">管理远程快照的基准</p>
                           <p>用于管理<span class="italic">远程</span>快照的基准的API与<span class="italic">本地</span>快照的基本相同。
                           </p>
                           <div class="infoboxnotealso" id="GUID-D37F8265-2CBB-4906-8AD8-D6DB6E6D0B44__GUID-37EC0B13-D21D-4E73-B457-41D9BAD18E84">
                              <p class="notep1">也可以看看：</p>
                              <p><span class="q">“ <a href="gathering-database-statistics.html#GUID-44811EF8-D082-487F-8EEC-DA6E78700E68">管理基线</a> ”</span></p>
                           </div>
                        </div>
                        <!-- class="section" -->
                        <div class="section" id="GUID-D37F8265-2CBB-4906-8AD8-D6DB6E6D0B44__EXPORTINGANDIMPORTINGREMOTESNAPSHOT-021641D1">
                           <p class="subhead3" id="GUID-D37F8265-2CBB-4906-8AD8-D6DB6E6D0B44__GUID-9DB7BA3D-313E-43D9-BABE-EDA599884F7C">导出和导入远程快照</p>
                           <div class="infoboxnote" id="GUID-D37F8265-2CBB-4906-8AD8-D6DB6E6D0B44__GUID-939C15AD-E3C0-4A67-8CC9-075ACCCEC0D4">
                              <p class="notep1">注意：</p>
                              <p>您无法在ADG备用数据库（即源数据库）上执行与远程快照相关的AWR导出和导入脚本。始终在目标数据库上执行这些脚本。</p>
                           </div>
                           <p>导出和导入<span class="italic">远程</span>快照的AWR数据的过程与<span class="italic">本地</span>快照的过程相同。从Oracle Database 12 <span class="italic">c</span>第2版（12.2）开始，AWR数据导出和导入脚本<code class="codeph">awrextr.sql</code>和<code class="codeph">awrload.sql</code>使用<span class="italic">源名称</span>标识符来区分源自特定源的快照。源名称在导出操作期间存储在转储文件中，并在导入操作期间用作默认源名称。
                           </p>
                           <div class="infoboxnotealso" id="GUID-D37F8265-2CBB-4906-8AD8-D6DB6E6D0B44__GUID-FED9CC22-27A7-46D0-AADA-BDB40CF04C64">
                              <p class="notep1">也可以看看：</p>
                              <p><span class="q">“将<a href="gathering-database-statistics.html#GUID-F25470A0-C236-46DE-84F7-D68FBE1B0F12" title="Oracle数据库使您可以在系统之间传输AWR数据。这在您希望使用单独的系统执行AWR数据分析的情况下非常有用，以便减少生产系统上性能分析所导致的开销。">自动工作负载存储库数据传输到另一个系统</a> ”，</span>以获取有关导出和导入本地快照的AWR数据的信息。
                              </p>
                           </div>
                           <p><span class="bold">使用awrextr.sql脚本导出远程快照</span></p>
                           <p>导出<span class="italic">远程</span>快照的过程类似于使用<span class="q">“ <a href="gathering-database-statistics.html#GUID-CC6A87BD-BFEA-4A1B-9FD1-3445DC11BE72">导出AWR数据</a> ”</span>一节中描述的<code class="codeph">awrextr.sql</code>脚本导出<span class="italic">本地</span>快照，但有以下区别：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>默认导出日志文件目录与转储文件的目录相同，但您也可以为导出日志文件指定任何其他目录。</p>
                              </li>
                              <li>
                                 <p>可以将<code class="codeph">.dmp</code>后缀指定为要导出的转储文件的名称。
                                 </p>
                              </li>
                              <li>
                                 <p>在提示要导出<span class="italic">映射数据库ID</span>值之前，导出脚本会显示AWR表的<code class="codeph">SOURCE_DBID</code>和<code class="codeph">SOURCE_NAME</code>列的值。
                                 </p>
                              </li>
                           </ul>
                           <p><span class="bold">使用awrload.sql脚本导入远程快照</span></p>
                           <p>导入<span class="italic">远程</span>快照的过程类似于使用<span class="q">“ <a href="gathering-database-statistics.html#GUID-C916E80F-B819-4452-ABFC-18CA70D8A501">导入AWR数据</a> ”</span>一节中描述的<code class="codeph">awrload.sql</code>脚本导入<span class="italic">本地</span>快照，但有以下区别：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>默认导入日志文件目录与转储文件的目录相同，但您也可以为导入日志文件指定任何其他目录。当转储文件驻留在只读目录中时，这尤其有用。</p>
                              </li>
                              <li>
                                 <p>可以将<code class="codeph">.dmp</code>后缀指定为要导入的转储文件的名称。
                                 </p>
                              </li>
                              <li>
                                 <p>导入脚本使用转储文件中存在的<code class="codeph">SOURCE_DBID</code>和<code class="codeph">SOURCE_NAME</code>列的值来确定用于在AWR中存储快照数据的相应<span class="italic">映射数据库ID</span> 。</p>
                              </li>
                           </ul>
                           <div class="infoboxnote" id="GUID-D37F8265-2CBB-4906-8AD8-D6DB6E6D0B44__GUID-F94FDD70-23F4-493B-B7FA-1976F01054EF">
                              <p class="notep1">注意：</p>
                              <p>快照导入操作不受生成快照转储的Oracle数据库版本的影响。</p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
                  <div class="props_rev_3"><a id="GUID-751B53F2-0101-4AEE-8709-1978120249E1" name="GUID-751B53F2-0101-4AEE-8709-1978120249E1"></a><h5 id="TGDBA-GUID-751B53F2-0101-4AEE-8709-1978120249E1" class="sect5"><span class="enumeration_section">6.2.8.3</span>在Active Data Guard备用数据库中查看AWR数据</h5>
                     <div>
                        <p>您可以使用Oracle提供的AWR视图和AWR报告查看存储在ADG备用数据库中的AWR数据。</p>
                        <div class="section" id="GUID-751B53F2-0101-4AEE-8709-1978120249E1__USINGAWRVIEWSFORACTIVEDATAGUARDSTAN-07B9627E">
                           <p class="subhead3" id="GUID-751B53F2-0101-4AEE-8709-1978120249E1__GUID-E48CA2A5-7E90-46B4-A539-9FEACC7E5BB8">使用AWR视图查看AWR数据</p>
                           <p>您可以使用<span class="q">“ <a href="gathering-database-statistics.html#GUID-18E1B278-B3C5-4FE1-8E51-BC8878C439F5">使用自动工作负载存储库视图</a> ”</span>一节中描述的<code class="codeph"><span class="codeinlineitalic">DBA_HIST</span></code>视图查看存储在AWR中的历史数据。
                           </p>
                           <div class="infoboxnote" id="GUID-751B53F2-0101-4AEE-8709-1978120249E1__GUID-1099C7D9-0071-44B5-9682-C9E2579AA26F">
                              <p class="notep1">注意：</p>
                              <p>从Oracle Database 12 <span class="italic">c</span>第2版（12.2）开始，视图<code class="codeph">DBA_HIST_DATABASE_INSTANCE</code>包含<code class="codeph">DB_UNIQUE_NAME</code>列，以支持ADG备用数据库的AWR。列<code class="codeph">DB_UNIQUE_NAME</code>存储目标已知的源的唯一标识符。
                              </p>
                           </div>
                        </div>
                        <!-- class="section" -->
                        <div class="section" id="GUID-751B53F2-0101-4AEE-8709-1978120249E1__GENERATINGAWRREPORTS-28AFC27F">
                           <p class="subhead3" id="GUID-751B53F2-0101-4AEE-8709-1978120249E1__GUID-8827A4DB-980E-494A-A4A7-1E2913C9D85C">使用AWR报告查看AWR数据</p>
                           <p>您可以使用AWR报告查看与ADG备用数据库相关的性能统计信息。生成AWR报告的主要界面是Oracle企业管理器云控制（云控制）。尽可能使用Cloud Control生成AWR报告。如果Cloud Control不可用，则使用Oracle提供的SQL脚本生成AWR报告。运行这些脚本需要DBA角色。</p>
                           <p>可以使用源名称映射的数据库ID对查询特定源的AWR数据。映射的数据库ID类似于AWR用于标识数据库实例的数据库标识符（DBID），并存储在AWR表的<code class="codeph">DBID</code>列中。对于ADG备用数据库，AWR DBID值的派生如下：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>对于目标，AWR DBID值是<code class="codeph">V$DATABASE.CON_DBID</code>的值。</p>
                              </li>
                              <li>
                                 <p>对于源，AWR DBID值是<code class="codeph">DBMS_UMF.GET_NODE_ID_LOCAL()</code>的值或<code class="codeph">DBA_UMF_REGISTRATION</code>视图中的列<code class="codeph">NODE_ID</code>的值。
                                 </p>
                              </li>
                           </ul>
                           <p>由于快照ID在源之间不是唯一的，因此快照ID映射的数据库ID对标识特定源的快照。</p>
                           <div class="infoboxnotealso" id="GUID-751B53F2-0101-4AEE-8709-1978120249E1__GUID-71774603-608B-49D2-BF52-FF596198069F">
                              <p class="notep1">也可以看看：</p>
                              <p><span class="q">“ <a href="gathering-database-statistics.html#GUID-EB7B34CD-6F4B-4010-9A8A-E1C7B8F2F851">为特定数据库</a></span>生成AWR报告<span class="q">”，</span>以获取有关使用Oracle提供的SQL脚本生成AWR报告的信息。
                              </p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div>
            </div><a id="TGDBA232"></a><div class="props_rev_3"><a id="GUID-9BFC6383-6C4F-4103-A2CB-4713802F2669" name="GUID-9BFC6383-6C4F-4103-A2CB-4713802F2669"></a><h3 id="TGDBA-GUID-9BFC6383-6C4F-4103-A2CB-4713802F2669" class="sect3"><span class="enumeration_section">6.3</span>生成自动工作负载存储库报告</h3>
               <div>
                  <p>AWR报告显示在两个快照（或两个时间点）之间捕获的数据。AWR报告分为多个部分。报告的内容包含所选快照范围的系统工作负载配置文件。HTML报告包含可用于在各部分之间快速导航的链接。</p>
                  <div class="infoboxnote" id="GUID-9BFC6383-6C4F-4103-A2CB-4713802F2669__GUID-9A976CD9-69E7-4413-B84A-7FF94892CB43">
                     <p class="notep1">注意：</p>
                     <p><a id="d11457e5149" class="indexterm-anchor"></a>如果在指定的快照范围内对没有任何工作负载活动的数据库运行报告，则某些报告统计信息的计算百分比可能小于0或大于100。此结果意味着统计信息没有任何有意义的值。
                     </p>
                  </div>
                  <p>本节介绍如何生成AWR报告，并包含以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="gathering-database-statistics.html#GUID-590826F2-AA17-4565-B0E6-3FF5225063D8">用于生成AWR报告的用户界面</a></p>
                     </li>
                     <li>
                        <p><a href="gathering-database-statistics.html#GUID-4B5CB76B-7A8E-4A31-8850-1BB77B13EEE2">使用命令行界面生成AWR报告</a></p>
                     </li>
                  </ul>
               </div><a id="TGDBA233"></a><div class="props_rev_3"><a id="GUID-590826F2-AA17-4565-B0E6-3FF5225063D8" name="GUID-590826F2-AA17-4565-B0E6-3FF5225063D8"></a><h4 id="TGDBA-GUID-590826F2-AA17-4565-B0E6-3FF5225063D8" class="sect4"><span class="enumeration_section">6.3.1</span>生成AWR报告的用户界面</h4>
                  <div>
                     <p>生成AWR报告的主要界面是Oracle企业管理器云控制（云控制）。尽可能使用Cloud Control生成AWR报告。</p>
                     <p>如果Cloud Control不可用，则通过运行SQL脚本生成AWR报告。运行这些脚本需要DBA角色。</p>
                     <div class="infoboxnotealso" id="GUID-590826F2-AA17-4565-B0E6-3FF5225063D8__GUID-0F779AE5-01F4-4AE0-8534-5E764AC81F6C">
                        <p class="notep1">也可以看看：</p>
                        <p>有关使用Cloud Control生成AWR报告的详细信息，请参阅<a href="../tdppt/automatic-database-performance-monitoring.html#TDPPT032" target="_blank"><span class="italic">“Oracle数据库2天+性能调整指南”</span></a></p>
                     </div>
                  </div>
               </div><a id="TGDBA235"></a><div class="props_rev_3"><a id="GUID-4B5CB76B-7A8E-4A31-8850-1BB77B13EEE2" name="GUID-4B5CB76B-7A8E-4A31-8850-1BB77B13EEE2"></a><h4 id="TGDBA-GUID-4B5CB76B-7A8E-4A31-8850-1BB77B13EEE2" class="sect4"><span class="enumeration_section">6.3.2</span>使用命令行界面生成AWR报告</h4>
                  <div>
                     <p>本节介绍如何通过在命令行界面中运行SQL脚本来生成AWR报告。运行这些脚本需要DBA角色。单击下表中的相应任务链接，以获取生成所需AWR报告的详细步骤。</p>
                     <div class="tblformalwide" id="GUID-4B5CB76B-7A8E-4A31-8850-1BB77B13EEE2__SQLSCRIPTSFORGENERATINGAWRREPORTS-B339BD28">
                        <p class="titleintable">表6-4生成AWR报告的SQL脚本</p>
                        <table cellpadding="4" cellspacing="0" class="FormalWide" title="用于生成AWR报告的SQL脚本" width="100%" border="1" summary="This table lists the SQL scripts that can be used for generating AWR reports." frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="20%" id="d11457e5289">任务</th>
                                 <th align="left" valign="bottom" width="20%" id="d11457e5292">SQL脚本</th>
                                 <th align="left" valign="bottom" width="20%" id="d11457e5295">描述</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d11457e5300" headers="d11457e5289 ">
                                    <p><a href="gathering-database-statistics.html#GUID-B7D1B185-4942-4934-9B21-A9010F82A4FF">生成本地数据库的AWR报告</a></p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d11457e5300 d11457e5292 ">
                                    <p><code class="codeph">的awrrpt.sql</code></p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d11457e5300 d11457e5295 ">
                                    <p>生成HTML或文本格式的AWR报告，显示本地数据库实例中一系列快照ID的统计信息。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d11457e5312" headers="d11457e5289 ">
                                    <p><a href="gathering-database-statistics.html#GUID-EB7B34CD-6F4B-4010-9A8A-E1C7B8F2F851">生成特定数据库的AWR报告</a></p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d11457e5312 d11457e5292 ">
                                    <p><code class="codeph">awrrpti.sql</code> 
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d11457e5312 d11457e5295 ">
                                    <p>生成HTML或文本格式的AWR报告，显示特定数据库实例中一系列快照ID的统计信息。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d11457e5325" headers="d11457e5289 ">
                                    <p><a href="gathering-database-statistics.html#GUID-A1ACE3E6-7655-4CA2-BD98-0CEC937D9F63">在Oracle RAC中为本地数据库生成AWR报告</a></p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d11457e5325 d11457e5292 ">
                                    <p><code class="codeph">awrgrpt.sql</code></p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d11457e5325 d11457e5295 ">
                                    <p>生成HTML或文本格式的AWR报告，该报告显示Oracle RAC环境中本地数据库实例中的一系列快照ID的统计信息。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d11457e5337" headers="d11457e5289 ">
                                    <p><a href="gathering-database-statistics.html#GUID-1FE0EA42-4299-411B-A69D-F6B1FD038293">在Oracle RAC中为特定数据库生成AWR报告</a></p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d11457e5337 d11457e5292 ">
                                    <p><code class="codeph">awrgrpti.sql</code></p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d11457e5337 d11457e5295 ">
                                    <p>生成HTML或文本格式的AWR报告，该报告显示Oracle RAC环境中特定数据库实例中的一系列快照ID的统计信息。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d11457e5349" headers="d11457e5289 ">
                                    <p><a href="gathering-database-statistics.html#GUID-BD9DA8AD-89FC-4C7E-B902-04340C0E9E3D">为本地数据库上的SQL语句生成AWR报告</a></p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d11457e5349 d11457e5292 ">
                                    <p><code class="codeph">awrsqrpt.sql</code></p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d11457e5349 d11457e5295 ">
                                    <p>以HTML或文本格式生成AWR报告，该报告显示本地数据库实例中一系列快照ID的特定SQL语句的统计信息。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d11457e5361" headers="d11457e5289 ">
                                    <p><a href="gathering-database-statistics.html#GUID-28885D04-6EB8-4AEB-8019-B767782F84C3">为特定数据库上的SQL语句生成AWR报告</a></p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d11457e5361 d11457e5292 ">
                                    <p><code class="codeph">awrsqrpi.sql</code></p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d11457e5361 d11457e5295 ">
                                    <p>生成HTML或文本格式的AWR报告，该报告显示特定数据库实例中一系列快照ID的特定SQL语句的统计信息。</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div><a id="TGDBA236"></a><div class="props_rev_3"><a id="GUID-B7D1B185-4942-4934-9B21-A9010F82A4FF" name="GUID-B7D1B185-4942-4934-9B21-A9010F82A4FF"></a><h5 id="TGDBA-GUID-B7D1B185-4942-4934-9B21-A9010F82A4FF" class="sect5"><span class="enumeration_section">6.3.2.1</span>为本地数据库生成AWR报告</h5>
                     <div>
                        <div class="section">
                           <p>该<a id="d11457e5424" class="indexterm-anchor"></a><a id="d11457e5428" class="indexterm-anchor"></a> <code class="codeph">awrrpt.sql</code> SQL脚本生成HTML或文本报告，显示一系列快照ID的统计信息。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-B7D1B185-4942-4934-9B21-A9010F82A4FF__GUID-5204AF15-F449-4EBB-A4E8-65435B9114EA">要使用命令行界面在本地数据库实例上生成AWR报告，请执行以下操作：</p>
                           <ol>
                              <li>
                                 <p>在SQL提示符下，输入：</p><pre class="oac_no_warn" dir="ltr">@ $ ORACLE_HOME / RDBMS /管理/的awrrpt.sql</pre></li>
                              <li>
                                 <p>指定您是要HTML还是文本报告：</p><pre class="oac_no_warn" dir="ltr">输入report_type：text的值</pre><p>在此示例中，选择了文本报告。</p>
                              </li>
                              <li>
                                 <p>指定要列出快照ID的天数。</p><pre class="oac_no_warn" dir="ltr">输入num_days的值：2</pre><p>将显示指定时间范围的现有快照列表。在此示例中，将显示最近2天捕获的快照。</p>
                              </li>
                              <li>
                                 <p>指定工作负载存储库报告的开始和结束快照ID：</p><pre class="oac_no_warn" dir="ltr">输入begin_snap的值：150输入end_snap的值：160</pre><p>在此示例中，选择快照ID为150的快照作为开始快照，并选择快照ID为160的快照作为结束快照。</p>
                              </li>
                              <li>
                                 <p>输入报告名称，或接受默认报告名称：</p><pre class="oac_no_warn" dir="ltr">输入report_name的值：使用报告名称awrrpt_1_150_160</pre><p>在此示例中，接受默认名称，并生成名为<code class="codeph">awrrpt_1_150_160</code>的AWR报告。
                                 </p>
                              </li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="TGDBA237"></a><div class="props_rev_3"><a id="GUID-EB7B34CD-6F4B-4010-9A8A-E1C7B8F2F851" name="GUID-EB7B34CD-6F4B-4010-9A8A-E1C7B8F2F851"></a><h5 id="TGDBA-GUID-EB7B34CD-6F4B-4010-9A8A-E1C7B8F2F851" class="sect5"><span class="enumeration_section">6.3.2.2</span>为特定数据库生成AWR报告</h5>
                     <div>
                        <div class="section">
                           <p><code class="codeph">awrrpti.sql</code> SQL脚本生成HTML或文本报告，该报告使用特定数据库实例显示来自一系列快照ID的统计信息。此脚本使您可以指定将为其生成AWR报告的数据库标识符和实例。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-EB7B34CD-6F4B-4010-9A8A-E1C7B8F2F851__GUID-5955FD60-EC16-4CBF-8AF5-DFAE32F63663">使用命令行界面生成特定数据库实例的AWR报告：</p>
                           <ol>
                              <li>
                                 <p>在SQL提示符下，输入：</p><pre class="oac_no_warn" dir="ltr">@ $ ORACLE_HOME / RDBMS /管理/ awrrpti.sql</pre></li>
                              <li>
                                 <p>指定您是要HTML还是文本报告：</p><pre class="oac_no_warn" dir="ltr">输入report_type：text的值</pre><p>在此示例中，选择了文本报告。</p>
                                 <p>显示可用数据库标识符和实例编号的列表：</p><pre class="oac_no_warn" dir="ltr">这个Workload Repository模式中的实例~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ DB Id Inst Num数据库名称实例主机----------- -------- ------------ ----------- -  ------------ 3309173529 1 MAIN main examp1690 3309173529 1 TINT251 tint251 samp251</pre></li>
                              <li>
                                 <p>输入数据库标识符（ <code class="codeph">dbid)</code>和实例编号（ <code class="codeph">inst_num)</code> ：</p><pre class="oac_no_warn" dir="ltr">输入dbid的值：3309173529对数据库ID使用3309173529输入inst_num的值：1</pre><div class="infoboxnote" id="GUID-EB7B34CD-6F4B-4010-9A8A-E1C7B8F2F851__GUID-BF6734D3-A3CA-432D-A3F4-550D49780179">
                                    <p class="notep1">注意：</p>
                                    <p>对于ADG备用数据库， <code class="codeph">dbid</code>的值可以确定如下：</p>
                                    <ul style="list-style-type:disc">
                                       <li>
                                          <p>对于Destination节点，请使用<code class="codeph">v$database.con_dbid</code>的值。
                                          </p>
                                       </li>
                                       <li>
                                          <p>对于Source节点，请使用<code class="codeph">dbms_umf.get_node_id_local()</code>的值。
                                          </p>
                                       </li>
                                    </ul>
                                 </div>
                              </li>
                              <li>
                                 <p>指定要列出快照ID的天数。</p><pre class="oac_no_warn" dir="ltr">输入num_days的值：2</pre><p>将显示指定时间范围的现有快照列表。在此示例中，将显示最近2天捕获的快照。</p>
                              </li>
                              <li>
                                 <p>指定工作负载存储库报告的开始和结束快照ID：</p><pre class="oac_no_warn" dir="ltr">输入begin_snap的值：150输入end_snap的值：160</pre><p>在此示例中，选择快照ID为150的快照作为开始快照，并选择快照ID为160的快照作为结束快照。</p>
                              </li>
                              <li>
                                 <p>输入报告名称，或接受默认报告名称：</p><pre class="oac_no_warn" dir="ltr">输入report_name的值：使用报告名称awrrpt_1_150_160</pre><p>在此示例中，接受默认名称，并在数据库实例上生成名为<code class="codeph">awrrpt_1_150_160</code>的AWR报告，其数据库ID值为<code class="codeph">3309173529</code> 。
                                 </p>
                              </li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="TGDBA238"></a><div class="props_rev_3"><a id="GUID-A1ACE3E6-7655-4CA2-BD98-0CEC937D9F63" name="GUID-A1ACE3E6-7655-4CA2-BD98-0CEC937D9F63"></a><h5 id="TGDBA-GUID-A1ACE3E6-7655-4CA2-BD98-0CEC937D9F63" class="sect5"><span class="enumeration_section">6.3.2.3</span>为Oracle RAC中的本地数据库生成AWR报告</h5>
                     <div>
                        <div class="section">
                           <p><code class="codeph">awrgrpt.sql</code> SQL脚本生成HTML或文本报告，该报告使用Oracle Real Application Clusters（Oracle RAC）环境中的当前数据库实例显示来自一系列快照ID的统计信息。
                           </p>
                           <div class="infoboxnote" id="GUID-A1ACE3E6-7655-4CA2-BD98-0CEC937D9F63__GUID-34D1A713-3FA3-46B9-B5DB-9F19999E42FE">
                              <p class="notep1">注意：</p>
                              <p>在Oracle RAC环境中，Oracle建议生成HTML报告（而不是文本报告），因为它更容易阅读。</p>
                           </div>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-A1ACE3E6-7655-4CA2-BD98-0CEC937D9F63__GUID-73AF7F76-6152-4FB8-882D-467E41318F60">使用命令行界面在本地数据库实例上生成Oracle RAC的AWR报告：</p>
                           <ol>
                              <li>
                                 <p>在SQL提示符下，输入：</p><pre class="oac_no_warn" dir="ltr">@ $ ORACLE_HOME / RDBMS /管理/ awrgrpt.sql</pre></li>
                              <li>
                                 <p>指定您是要HTML还是文本报告：</p><pre class="oac_no_warn" dir="ltr">输入report_type的值：html</pre><p>在此示例中，选择了HTML报告。</p>
                              </li>
                              <li>
                                 <p>指定要列出快照ID的天数。</p><pre class="oac_no_warn" dir="ltr">输入num_days的值：2</pre><p>将显示指定时间范围的现有快照列表。在此示例中，将显示最后一天捕获的快照。</p>
                              </li>
                              <li>
                                 <p>指定工作负载存储库报告的开始和结束快照ID：</p><pre class="oac_no_warn" dir="ltr">输入begin_snap的值：150输入end_snap的值：160</pre><p>在此示例中，选择快照ID为150的快照作为开始快照，并选择快照ID为160的快照作为结束快照。</p>
                              </li>
                              <li>
                                 <p>输入报告名称，或接受默认报告名称：</p><pre class="oac_no_warn" dir="ltr">输入report_name的值：使用报告名称awrrpt_rac_150_160.html</pre><p>在此示例中，接受默认名称，并生成名为<code class="codeph">awrrpt_rac_150_160.html</code>的AWR报告。
                                 </p>
                              </li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="TGDBA239"></a><div class="props_rev_3"><a id="GUID-1FE0EA42-4299-411B-A69D-F6B1FD038293" name="GUID-1FE0EA42-4299-411B-A69D-F6B1FD038293"></a><h5 id="TGDBA-GUID-1FE0EA42-4299-411B-A69D-F6B1FD038293" class="sect5"><span class="enumeration_section">6.3.2.4</span>为Oracle RAC中的特定数据库生成AWR报告</h5>
                     <div>
                        <div class="section">
                           <p><code class="codeph">awrgrpti.sql</code> SQL脚本生成HTML或文本报告，该报告使用在Oracle RAC环境中运行的特定数据库实例显示来自一系列快照ID的统计信息。此脚本使您可以指定数据库标识符和将为其生成AWR报告的数据库实例的逗号分隔列表。
                           </p>
                           <div class="infoboxnote" id="GUID-1FE0EA42-4299-411B-A69D-F6B1FD038293__GUID-5E1BD446-DC71-4F9C-ABAA-44D5A0383C4A">
                              <p class="notep1">注意：</p>
                              <p>在Oracle RAC环境中，Oracle建议生成HTML报告（而不是文本报告），因为它更容易阅读。</p>
                           </div>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-1FE0EA42-4299-411B-A69D-F6B1FD038293__GUID-3AEC63DA-1C46-4AE2-BF55-173381380D97">使用命令行界面在特定数据库实例上生成Oracle RAC的AWR报告：</p>
                           <ol>
                              <li>
                                 <p>在SQL提示符下，输入：</p><pre class="oac_no_warn" dir="ltr">@ $ ORACLE_HOME / RDBMS /管理/ awrgrpti.sql</pre></li>
                              <li>
                                 <p>指定您是要HTML还是文本报告：</p><pre class="oac_no_warn" dir="ltr">输入report_type的值：html</pre><p>在此示例中，选择了HTML报告。</p>
                                 <p>显示可用数据库标识符和实例编号的列表：</p><pre class="oac_no_warn" dir="ltr">这个Workload Repository模式中的实例~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ DB Id Inst Num数据库名称实例主机----------- -------- ------------ ----------- -  ------------ 3309173529 1 MAIN main examp1690 3309173529 1 TINT251 tint251 samp251 3309173529 2 TINT251 tint252 samp252</pre></li>
                              <li>
                                 <p>输入数据库标识符（ <code class="codeph">dbid)</code> ：</p><pre class="oac_no_warn" dir="ltr">输入dbid的值：3309173529使用3309173529获取数据库ID</pre></li>
                              <li>
                                 <p>输入要包含在报告中的Oracle RAC实例的实例编号（ <code class="codeph">instance_numbers_or_all</code> ）的值：</p><pre class="oac_no_warn" dir="ltr">输入instance_numbers_or_all的值：1,2</pre></li>
                              <li>
                                 <p>指定要列出快照ID的天数。</p><pre class="oac_no_warn" dir="ltr">输入num_days的值：2</pre><p>将显示指定时间范围的现有快照列表。在此示例中，将显示最近2天捕获的快照。</p>
                              </li>
                              <li>
                                 <p>指定工作负载存储库报告的开始和结束快照ID：</p><pre class="oac_no_warn" dir="ltr">输入begin_snap的值：150输入end_snap的值：160</pre><p>在此示例中，选择快照ID为150的快照作为开始快照，并选择快照ID为160的快照作为结束快照。</p>
                              </li>
                              <li>
                                 <p>输入报告名称，或接受默认报告名称：</p><pre class="oac_no_warn" dir="ltr">输入report_name的值：使用报告名称awrrpt_rac_150_160.html</pre><p>在此示例中，接受默认名称，并在数据库实例上生成名为<code class="codeph">awrrpt_rac_150_160.html</code>的AWR报告，其数据库ID值为<code class="codeph">3309173529</code> 。
                                 </p>
                              </li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="TGDBA240"></a><div class="props_rev_3"><a id="GUID-BD9DA8AD-89FC-4C7E-B902-04340C0E9E3D" name="GUID-BD9DA8AD-89FC-4C7E-B902-04340C0E9E3D"></a><h5 id="TGDBA-GUID-BD9DA8AD-89FC-4C7E-B902-04340C0E9E3D" class="sect5"><span class="enumeration_section">6.3.2.5</span>为本地数据库上的SQL语句生成AWR报告</h5>
                     <div>
                        <div class="section">
                           <p><code class="codeph">awrsqrpt.sql</code> SQL脚本生成HTML或文本报告，该报告显示一系列快照ID中特定SQL语句的统计信息。运行此报告以检查或调试SQL语句的性能。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-BD9DA8AD-89FC-4C7E-B902-04340C0E9E3D__GUID-B46CD66A-E71F-40D0-8BF0-490438977013">使用命令行界面为本地数据库实例上的SQL语句生成AWR报告：</p>
                           <ol>
                              <li>
                                 <p>在SQL提示符下，输入：</p><pre class="oac_no_warn" dir="ltr">@ $ ORACLE_HOME / RDBMS /管理/ awrsqrpt.sql</pre></li>
                              <li>
                                 <p>指定您是要HTML还是文本报告：</p><pre class="oac_no_warn" dir="ltr">输入report_type的值：html</pre><p>在此示例中，选择了HTML报告。</p>
                              </li>
                              <li>
                                 <p>指定要列出快照ID的天数。</p><pre class="oac_no_warn" dir="ltr">输入num_days的值：1</pre><p>将显示指定时间范围的现有快照列表。在此示例中，将显示前一天捕获的快照。</p>
                              </li>
                              <li>
                                 <p>指定工作负载存储库报告的开始和结束快照ID：</p><pre class="oac_no_warn" dir="ltr">输入begin_snap的值：146输入end_snap的值：147</pre><p>在此示例中，选择快照ID为146的快照作为开始快照，并选择快照ID为147的快照作为结束快照。</p>
                              </li>
                              <li>
                                 <p>指定要显示统计信息的特定SQL语句的SQL ID：</p><pre class="oac_no_warn" dir="ltr">输入sql_id的值：2b064ybzkwf1y</pre><p>在此示例中，选择SQL ID为<code class="codeph">2b064ybzkwf1y</code>的SQL语句。
                                 </p>
                              </li>
                              <li>
                                 <p>输入报告名称，或接受默认报告名称：</p><pre class="oac_no_warn" dir="ltr">输入report_name的值：使用报告名称awrrpt_1_146_147.html</pre><p>在此示例中，接受默认名称，并生成名为<code class="codeph">awrrpt_1_146_147</code>的AWR报告。
                                 </p>
                              </li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="TGDBA241"></a><div class="props_rev_3"><a id="GUID-28885D04-6EB8-4AEB-8019-B767782F84C3" name="GUID-28885D04-6EB8-4AEB-8019-B767782F84C3"></a><h5 id="TGDBA-GUID-28885D04-6EB8-4AEB-8019-B767782F84C3" class="sect5"><span class="enumeration_section">6.3.2.6</span>为特定数据库上的SQL语句生成AWR报告</h5>
                     <div>
                        <div class="section">
                           <p><code class="codeph">awrsqrpi.sql</code> SQL脚本生成HTML或文本报告，该报告使用特定数据库实例显示来自一系列快照ID的特定SQL语句的统计信息。此脚本使您可以指定将为其生成AWR报告的数据库标识符和实例。运行此报告以检查或调试特定数据库和实例上的SQL语句的性能。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-28885D04-6EB8-4AEB-8019-B767782F84C3__GUID-DCDE85A3-12A5-43CB-8978-B83ABC013332">使用命令行界面为特定数据库实例上的SQL语句生成AWR报告：</p>
                           <ol>
                              <li>
                                 <p>在SQL提示符下，输入：</p><pre class="oac_no_warn" dir="ltr">@ $ ORACLE_HOME / RDBMS /管理/ awrsqrpi.sql</pre></li>
                              <li>
                                 <p>指定您是要HTML还是文本报告：</p><pre class="oac_no_warn" dir="ltr">输入report_type的值：html</pre><p>在此示例中，选择了HTML报告。</p>
                                 <p>显示可用数据库标识符和实例编号的列表：</p><pre class="oac_no_warn" dir="ltr">这个Workload Repository模式中的实例~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ DB Id Inst Num数据库名称实例主机----------- -------- ------------ ----------- -  ------------ 3309173529 1 MAIN main examp1690 3309173529 1 TINT251 tint251 samp251</pre></li>
                              <li>
                                 <p>输入数据库标识符（ <code class="codeph">dbid)</code>和实例编号（ <code class="codeph">inst_num)</code> ：</p><pre class="oac_no_warn" dir="ltr">输入dbid的值：3309173529使用3309173529获取数据库ID输入inst_num的值：1使用1作为实例编号</pre></li>
                              <li>
                                 <p>指定要列出快照ID的天数。</p><pre class="oac_no_warn" dir="ltr">输入num_days的值：1</pre><p>将显示指定时间范围的现有快照列表。在此示例中，将显示前一天捕获的快照。</p>
                              </li>
                              <li>
                                 <p>指定工作负载存储库报告的开始和结束快照ID：</p><pre class="oac_no_warn" dir="ltr">输入begin_snap的值：146输入end_snap的值：147</pre><p>在此示例中，选择快照ID为146的快照作为开始快照，并选择快照ID为147的快照作为结束快照。</p>
                              </li>
                              <li>
                                 <p>指定要显示统计信息的特定SQL语句的SQL ID：</p><pre class="oac_no_warn" dir="ltr">输入sql_id的值：2b064ybzkwf1y</pre><p>在此示例中，选择SQL ID为<code class="codeph">2b064ybzkwf1y</code>的SQL语句。
                                 </p>
                              </li>
                              <li>
                                 <p>输入报告名称，或接受默认报告名称：</p><pre class="oac_no_warn" dir="ltr">输入report_name的值：使用报告名称awrrpt_1_146_147.html</pre><p>在此示例中，接受默认名称，并在数据库实例上生成名为<code class="codeph">awrrpt_1_146_147</code>的AWR报告，其数据库ID值为<code class="codeph">3309173529</code> 。
                                 </p>
                              </li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div>
            </div><a id="TGDBA95393"></a><div class="props_rev_3"><a id="GUID-23061F14-767D-47B6-9B45-D1E26FB1E075" name="GUID-23061F14-767D-47B6-9B45-D1E26FB1E075"></a><h3 id="TGDBA-GUID-23061F14-767D-47B6-9B45-D1E26FB1E075" class="sect3"><span class="enumeration_section">6.4</span>生成性能中心活动报告</h3>
               <div>
                  <p><a id="d11457e6106" class="indexterm-anchor"></a> EM Express的Performance Hub功能提供了一个活动报告，其中包含指定时间段内所有性能数据的统一视图。该报告完全互动;其内容保存在HTML文件中，您可以使用Web浏览器离线访问该文件。
                  </p>
                  <div class="infoboxnotealso" id="GUID-23061F14-767D-47B6-9B45-D1E26FB1E075__GUID-4909A519-DE7E-4C0B-9054-065831C2D0F9">
                     <p class="notep1">也可以看看：</p>
                     <p>有关EM Express Performance Hub功能的更多信息，请<a href="../admqs/monitoring-and-tuning-the-database.html#ADMQS12446" target="_blank"><span class="italic">参见Oracle Database 2 Day DBA</span></a></p>
                  </div>
                  <p>本节介绍如何生成Performance Hub活动报告，并包含以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="gathering-database-statistics.html#GUID-5D746952-984F-4D20-9EA2-09486332128A">Performance Hub活动报告概述</a></p>
                     </li>
                     <li>
                        <p><a href="gathering-database-statistics.html#GUID-2757F38D-F766-4208-94AA-13D58B03C5C5">用于生成性能集线器活动报告的命令行用户界面</a></p>
                     </li>
                     <li>
                        <p><a href="gathering-database-statistics.html#GUID-BA1747A8-590B-4266-9D9E-AAD4182563AB">使用SQL脚本生成性能集线器活动报告</a></p>
                     </li>
                  </ul>
               </div><a id="TGDBA95394"></a><div class="props_rev_3"><a id="GUID-5D746952-984F-4D20-9EA2-09486332128A" name="GUID-5D746952-984F-4D20-9EA2-09486332128A"></a><h4 id="TGDBA-GUID-5D746952-984F-4D20-9EA2-09486332128A" class="sect4"><span class="enumeration_section">6.4.1</span>性能中心活动报告概述</h4>
                  <div>
                     <p><a id="d11457e6186" class="indexterm-anchor"></a> Performance Hub活动报告使您可以查看指定时间段内的所有可用性能数据。Performance Hub中提供了不同的选项卡，具体取决于是否为该时间段选择了实时数据或历史数据。选择实时数据时，会显示更精细的数据，因为会显示最后一小时的实时数据。选择历史数据时，将显示更详细的数据，但数据点将在所选时间段内平均到自动工作负载存储库（AWR）间隔。
                     </p>
                     <p>本节介绍Performance Hub活动报告，包含以下主题：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="gathering-database-statistics.html#GUID-C4A1CCF0-FA06-4AFB-BAB1-1F2C7021B1FA">关于Performance Hub活动报告选项卡</a></p>
                        </li>
                        <li>
                           <p><a href="gathering-database-statistics.html#GUID-87FF1297-3CA4-419E-9323-D6B63820E84D">关于Performance Hub活动报告类型</a></p>
                        </li>
                     </ul>
                  </div><a id="TGDBA95395"></a><div class="props_rev_3"><a id="GUID-C4A1CCF0-FA06-4AFB-BAB1-1F2C7021B1FA" name="GUID-C4A1CCF0-FA06-4AFB-BAB1-1F2C7021B1FA"></a><h5 id="TGDBA-GUID-C4A1CCF0-FA06-4AFB-BAB1-1F2C7021B1FA" class="sect5"><span class="enumeration_section">6.4.1.1</span>关于Performance Hub活动报告选项卡</h5>
                     <div>
                        <p>Performance Hub活动报告包含交互式选项卡，使您可以查看和导航分类到各种性能区域的性能数据。</p>
                        <p>Performance Hub活动报告中包含的选项卡包括以下内容：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>摘要</p>
                              <p>“摘要”选项卡提供系统性能的概述，包括资源消耗，平均活动会话和负载配置文件信息。此选项卡可用于实时数据和历史数据。</p>
                           </li>
                           <li>
                              <p>活动</p>
                              <p>“活动”选项卡显示ASH分析。此选项卡可用于实时数据和历史数据。</p>
                           </li>
                           <li>
                              <p>工作量</p>
                              <p>“工作负载”选项卡显示有关工作负载配置文件的度量信息，例如呼叫率，登录率和顶级SQL。此选项卡可用于实时数据和历史数据。</p>
                           </li>
                           <li>
                              <p>RAC</p>
                              <p>RAC选项卡显示特定于Oracle RAC的度量标准，例如接收的全局高速缓存块数和平均块延迟。此选项卡仅在Oracle RAC环境中可用。此选项卡可用于实时数据和历史数据。</p>
                           </li>
                           <li>
                              <p>受监控的SQL</p>
                              <p>“受监视的SQL”选项卡显示有关受监视SQL语句的信息。此选项卡可用于实时数据和历史数据。</p>
                           </li>
                           <li>
                              <p>ADDM</p>
                              <p>ADDM选项卡显示ADDM分析任务和实时ADDM分析报告的信息。此选项卡可用于实时数据和历史数据。</p>
                           </li>
                           <li>
                              <p>目前的ADDM调查结果</p>
                              <p>“当前ADDM结果”选项卡显示过去5分钟内系统性能的实时分析。仅当Performance Hub活动报告的指定时间段在过去一小时内时，此选项卡才可用。此选项卡仅适用于实时数据。</p>
                           </li>
                           <li>
                              <p>数据库时间</p>
                              <p>“数据库时间”选项卡按类别显示各种度量标准的等待事件此选项卡仅适用于历史数据。</p>
                           </li>
                           <li>
                              <p>资源</p>
                              <p>“资源”选项卡显示操作系统和I / O使用情况统计信息。此选项卡仅适用于历史数据。</p>
                           </li>
                           <li>
                              <p>系统统计</p>
                              <p>System Statistics选项卡显示数据库和系统统计信息。此选项卡仅适用于历史数据。</p>
                           </li>
                        </ul>
                     </div>
                  </div><a id="TGDBA95396"></a><div class="props_rev_3"><a id="GUID-87FF1297-3CA4-419E-9323-D6B63820E84D" name="GUID-87FF1297-3CA4-419E-9323-D6B63820E84D"></a><h5 id="TGDBA-GUID-87FF1297-3CA4-419E-9323-D6B63820E84D" class="sect5"><span class="enumeration_section">6.4.1.2</span>关于Performance Hub活动报告类型</h5>
                     <div>
                        <p>您可以通过选择报告类型来选择Performance Hub活动报告的每个选项卡中显示的详细信息级别。</p>
                        <p>Performance Hub活动报告的可用报告类型包括以下内容：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>基本</p>
                              <p>只有所有选项卡的基本信息才会保存到报告中。</p>
                           </li>
                           <li>
                              <p>典型</p>
                              <p>除了基本报告类型中保存的信息之外，“监视的SQL”选项卡和ADDM报告中包含的顶级SQL语句的SQL监视器信息也会保存到报告中。</p>
                           </li>
                           <li>
                              <p>所有</p>
                              <p>除了典型报告类型中保存的信息之外，“监视的SQL”选项卡中包含的所有SQL语句的SQL监视器信息以及所有选项卡的所有详细报告都将保存到报告中。</p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="TGDBA95397"></a><div class="props_rev_3"><a id="GUID-2757F38D-F766-4208-94AA-13D58B03C5C5" name="GUID-2757F38D-F766-4208-94AA-13D58B03C5C5"></a><h4 id="TGDBA-GUID-2757F38D-F766-4208-94AA-13D58B03C5C5" class="sect4"><span class="enumeration_section">6.4.2</span>生成性能集线器活动报告的命令行用户界面</h4>
                  <div>
                     <p>您可以使用命令行界面以下列两种方式之一生成Performance Hub活动报告：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>使用SQL脚本，如<span class="q">“</span>使用SQL脚本<span class="q"><a href="gathering-database-statistics.html#GUID-BA1747A8-590B-4266-9D9E-AAD4182563AB">生成性能集线器活动报表</a> ”中所述</span> 。
                           </p>
                        </li>
                        <li>
                           <p>使用<code class="codeph">DBMS_PERF</code>包，如<a href="../arpls/DBMS_PERF.html#ARPLS75006" target="_blank"><span class="italic">Oracle Database PL / SQL包和类型参考中所述</span></a> 。
                           </p>
                        </li>
                     </ul>
                  </div>
               </div><a id="TGDBA95398"></a><div class="props_rev_3"><a id="GUID-BA1747A8-590B-4266-9D9E-AAD4182563AB" name="GUID-BA1747A8-590B-4266-9D9E-AAD4182563AB"></a><h4 id="TGDBA-GUID-BA1747A8-590B-4266-9D9E-AAD4182563AB" class="sect4"><span class="enumeration_section">6.4.3</span>使用SQL脚本生成性能集线器活动报告</h4>
                  <div>
                     <div class="section">
                        <p>本节介绍如何生成<a id="d11457e6501" class="indexterm-anchor"></a>通过在命令行界面中运行<code class="codeph">perfhubrpt.sql</code> SQL脚本，Performance Hub活动报告。运行此脚本需要DBA角色。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-BA1747A8-590B-4266-9D9E-AAD4182563AB__GUID-74C798E0-F717-4055-9798-A8E58A5DFC4E">要生成Performance Hub活动报告：</p>
                        <ol>
                           <li>
                              <p>在SQL提示符下，输入：</p><pre class="oac_no_warn" dir="ltr">@ $ ORACLE_HOME / RDBMS /管理/ perfhubrpt.sql</pre></li>
                           <li>
                              <p>指定所需的报告类型：</p><pre class="oac_no_warn" dir="ltr">请输入报告类型：典型</pre><p>有关可用报告类型的信息，请参阅<span class="q">“ <a href="gathering-database-statistics.html#GUID-87FF1297-3CA4-419E-9323-D6B63820E84D">关于Performance Hub活动报告类型</a> ”</span> 。
                              </p>
                           </li>
                           <li>
                              <p>输入要使用的数据库的数据库标识符的值：</p><pre class="oac_no_warn" dir="ltr">请输入数据库ID：3309173529</pre><p>要使用本地数据库，请输入空值（默认值）。如果为本地数据库以外的数据库指定数据库标识符，则会从导入的AWR数据生成Performance Hub活动报告。</p>
                           </li>
                           <li>
                              <p>输入要使用的数据库实例的实例编号的值：</p><pre class="oac_no_warn" dir="ltr">请输入实例编号：所有实例</pre><p>要指定所有实例，请输入<code class="codeph">all instances</code> （默认值）。
                              </p>
                           </li>
                           <li>
                              <p>通过以<code class="codeph">dd:mm:yyyy hh:mi:ss</code>格式指定结束时间和开始时间输入所需的时间段<code class="codeph">dd:mm:yyyy hh:mi:ss</code> ：</p><pre class="oac_no_warn" dir="ltr">请输入结束时间格式为dd：mm：yyyy hh24：mi：ss：03：04：2014 17:00:00请输入开始时间格式为dd：mm：yyyy hh24：mi：ss：03：04： 2014年16:00:00</pre></li>
                           <li>
                              <p>输入报告名称，或接受默认报告名称：</p><pre class="oac_no_warn" dir="ltr">输入report_name的值：my_perfhub_report.html</pre><p>在此示例中，将在2014年4月3日下午4:00到5:00之间的指定时间段内，在数据库ID值为<code class="codeph">3309173529</code>所有数据库实例上生成名为<code class="codeph">my_perfhub_report</code>的Performance Hub活动报告。
                              </p>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>