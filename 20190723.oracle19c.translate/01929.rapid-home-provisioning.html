<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="Fleet Patching and Provisioning is a software lifecycle management method for provisioning and maintaining Oracle homes."></meta>
      <meta name="description" content="Fleet Patching and Provisioning is a software lifecycle management method for provisioning and maintaining Oracle homes."></meta>
      <title>车队修补和供应与维护</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Clusterware Administration and Deployment Guide"></meta>
      <meta property="og:description" content="Fleet Patching and Provisioning is a software lifecycle management method for provisioning and maintaining Oracle homes."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Clusterware Administration and Deployment Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="clusterware-administration-and-deployment-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-04-24T07:05:38-07:00"></meta>
      <meta name="dcterms.title" content="Clusterware Administration and Deployment Guide"></meta>
      <meta name="dcterms.dateCopyrighted" content="2007, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E95727-05"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="oracle-flex-clusters.html" title="Previous" type="text/html"></link>
      <link rel="next" href="managing-oracle-cluster-registry-and-voting-files.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="CWADD"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="oracle-flex-clusters.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="managing-oracle-cluster-registry-and-voting-files.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">“Clusterware管理和部署指南”</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">车队修补和供应与维护</li>
            </ol>
            <a id="GUID-CCEC5960-EDA4-4A3F-9643-0CA308EA49AA" name="GUID-CCEC5960-EDA4-4A3F-9643-0CA308EA49AA"></a><a id="CWADD92402"></a>
            
            <h2 id="CWADD-GUID-CCEC5960-EDA4-4A3F-9643-0CA308EA49AA" class="sect2"><span class="enumeration_chapter">5</span> Fleet Patching and Provisioning and Maintenance</h2>
         </header>
         <div class="ind">
            <div>
               <p>Fleet Patching and Provisioning是一种用于配置和维护Oracle主目录的软件生命周期管理方法。</p>
               <p>Fleet Patching和Provisioning支持大规模部署和维护数据库，集群和用户定义的软件类型的标准操作环境。通过Fleet Patching和Provisioning，您还可以安装集群以及配置，修补，扩展和升级Oracle Grid Infrastructure和Oracle Database <span class="italic">11g第</span> 2版（11.2）及更高版本。此外，您还可以配置应用程序和中间件。
               </p>
               <div class="p">Fleet Patching和Provisioning是Oracle Grid Infrastructure中的一项服务，您可以使用以下任一模式：<ul style="list-style-type:disc">
                     <li>
                        <p>作为中央服务器（ <a href="glossary.html#GUID-9B0F2E98-277F-478E-8D49-3216423E061C"><span class="xrefglossterm">Fleet Patching and Provisioning Server</span></a> ），它存储和管理标准化的<a href="glossary.html#GUID-2241F26E-0652-46E7-A3C4-B8EBC0939F3E"><span class="xrefglossterm">图像</span></a> ，称为<a href="glossary.html#GUID-FE7C4C15-DA65-4737-B310-3284EB59EBA0"><span class="xrefglossterm">黄金图像</span></a> 。您可以将黄金映像部署到数据中心的任意数量的节点。您可以使用已部署的主目录来创建新的群集和数据库，以及修补，升级和扩展现有安装。
                        </p>
                        <p>服务器管理托管Fleet Patching和Provisioning Server的集群上的软件家庭，Fleet Patching和Provisioning Clients，还可以管理运行Oracle Grid Infrastructure <span class="italic">11g第</span> 2版（11.2.0.3和11.2.0.4）和12 <span class="italic">c</span>版本的安装1（12.1.0.2）。服务器还可以管理不运行网格基础结构的安装。
                        </p>
                        <p>Fleet Patching和Provisioning Server可以配置新安装，并且可以管理现有安装，而无需对现有安装进行任何更改（例如，无代理，守护程序或配置先决条件）。Fleet Patching和Provisioning Server还包括在对等Fleet Patching和Provisioning Server之间自动共享黄金映像的功能，以支持具有地理位置分布的数据中心的企业。</p>
                     </li>
                     <li>
                        <p>作为客户端（Fleet Patching and Provisioning Client），可以从中央Fleet Patching和Provisioning Server进行管理，也可以直接在Fleet Patching and Provisioning Client上运行命令。与Fleet Patching和Provisioning Server一样，Fleet Patching and Provisioning Client是内置于Oracle Grid Infrastructure的服务，可与Oracle Grid Infrastructure 12 <span class="italic">c第</span> 2版（12.2.0.1）及更高版本一起使用。Fleet Patching和Provisioning Client服务可以从Fleet Patching和Provisioning Server检索黄金映像，根据策略上传新映像，并将维护操作应用于自身。
                        </p>
                     </li>
                  </ul>
               </div>
               <p>对于修补操作，Oracle Database和Oracle Grid Infrastructure 18c提供了第三个选项。更新数据库和网格基础架构的过程已经模块化为Oracle数据库和Oracle Grid Infrastructure中包含的独立<span class="italic">自动机</span> ，并且可以在本地运行，而无需在架构中安装任何中央Fleet Patching和Provisioning Server。只要您启动Oracle数据库或集群，这就可以立即切换到Fleet Patching和Provisioning的功能。
               </p>
               <div class="p">使用Fleet Patching and Provisioning管理Oracle软件：<ul style="list-style-type:disc">
                     <li>
                        <p>通过黄金映像和已部署软件的管理系列确保标准化并实现高度自动化。</p>
                     </li>
                     <li>
                        <p>通过在不中断活动数据库或群集的情况下部署新住宅（黄金映像），最大限度地减少维护时间。</p>
                     </li>
                     <li>
                        <p>通过提供跨数据库版本和部署模型使用API调用的自动机来简化维护。</p>
                     </li>
                     <li>
                        <p>通过内置验证和干运行模式降低维护风险，确保操作端到端成功。</p>
                     </li>
                     <li>
                        <p>如果出现问题，命令可以恢复和重新启动，从而进一步降低维护操作的风险。</p>
                     </li>
                     <li>
                        <p>最大限度地减少并在许多情况下消除修补和升级的影响，其功能包括：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>零停机数据库升级：完全在部署中执行的全自动升级，无需额外节点或外部存储。</p>
                           </li>
                           <li>
                              <p>滚动修补期间数据库会话和OJVM的自适应管理。</p>
                           </li>
                           <li>
                              <p>用于细化部署的细粒度管理的选项。</p>
                           </li>
                        </ul>
                     </li>
                  </ul>
               </div>
               <p>部署和维护操作是可扩展的，允许自定义将特定于环境的操作包括在自动化工作流中。</p>
               <div class="section">
                  <p class="subhead1" id="GUID-CCEC5960-EDA4-4A3F-9643-0CA308EA49AA__GUID-F2D6C009-800E-4077-B779-C2EEF7044782">舰队修补和供应自动机</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><span class="italic">零停机数据库升级可</span>自动执行<span class="italic">数据库升级中</span>涉及的所有步骤，以最大限度地减少甚至消除升级Oracle数据库时的应用程序停机时间。它还可以最小化资源需求，并在必须回滚升级时提供回退路径。
                        </p>
                     </li>
                     <li>
                        <p><span class="italic">针对OJVM部署的自适应Oracle RAC滚动修补</span> ：在群集环境中，用于修补数据库的Fleet Patching和Provisioning的默认方法是Oracle RAC滚动修补。但是，如果修补的数据库主目录包含OJVM修补程序，则可能需要非滚动。在这种情况下，Fleet Patching and Provisioning确定是否可以进行滚动修补，如果适用，则确定是否可以进行滚动修补。
                        </p>
                     </li>
                     <li>
                        <p><span class="italic">干运行命令评估</span> ：在运行任何命令之前，Fleet Patching和Provisioning会检查各种前提条件以确保命令成功。但是，在命令运行之前无法检测到某些条件。并且，虽然Fleet Patching和Provisioning允许在纠正错误条件后恢复或恢复失败的命令，但最好在命令运行之前解决尽可能多的潜在问题。命令评估模式将测试给定命令的前提条件，而不进行任何更改，并报告潜在问题并在实际运行命令之前更正它们。
                        </p>
                     </li>
                     <li>
                        <div class="p"><span class="italic">独立自动机</span> ：在Oracle Database 18c之前，执行任何Fleet Patching和Provisioning操作（例如，将数据库主页切换到更高版本）需要存在中央Fleet Patching和Provisioning Server。从Oracle Database 18c开始，关键功能可以独立执行，架构中没有中央Fleet Patching和Provisioning Server。
                           <div class="infoboxnote" id="GUID-CCEC5960-EDA4-4A3F-9643-0CA308EA49AA__GUID-57991E83-C2C4-44CF-9BB1-7D3A22D66226">
                              <p class="notep1">注意：</p>安装Oracle Grid Infrastructure时，默认情况下，Fleet Patching and Provisioning Server配置为<span class="italic">本地</span>模式，以支持<span class="italic">本地交换机归属</span>功能。如果必须配置常规Fleet Patching和Provisioning Server产品，则必须使用以下命令以<code class="codeph">root</code>身份删除当前的本地模式Fleet Patching和Provisioning Server：<pre class="pre codeblock"><code>#srvctl stop rhpserver</code></pre><p>忽略类似于“Fleet Patching和Provisioning Server未运行”的消息。</p><pre class="pre codeblock"><code>#srvctl删除rhpserver</code></pre></div>
                        </div>
                     </li>
                  </ul>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-CCEC5960-EDA4-4A3F-9643-0CA308EA49AA__GUID-21BB7458-BDD6-4FB6-99D4-1CD2C69E0082">全球车队标准化与管理</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><span class="italic">在对等Fleet Patching和Provisioning Server之间共享黄金映像</span> ：大型企业通常托管多个数据中心，并且在每个数据中心内，可能存在单独的网段。在Fleet Patching and Provisioning体系结构中，一个Fleet Patching and Provisioning Server在给定数据中心（或数据中心的网段）内的一组目标上运行。因此，每个数据中心至少需要一个Fleet Patching和Provisioning Server。
                        </p>
                        <p>虽然每个数据中心在目标服务器将使用的黄金映像方面可能有一些独特的要求，但标准化的目标是尽可能在所有数据中心使用相同的黄金映像。为此，Fleet Patching和Provisioning支持黄金映像的点对点共享，以便在多个Fleet Patching和Provisioning Server之间轻松传播黄金映像。</p>
                     </li>
                     <li>
                        <div class="p"><span class="italic">黄金图像漂移检测和聚合</span> ：从黄金映像配置软件主页后，您可能必须直接将修补程序应用于已部署的主目录。此时，部署的房屋已从黄金图像中漂移。Fleet Patching and Provisioning提供两种监控和报告漂移的功能：<ul style="list-style-type:disc">
                              <li>
                                 <p>Fleet Patching and Provisioning将特定主页与其父级黄金图像进行比较，并列出应用于主页但不在黄金图像中的任何修补程序。</p>
                              </li>
                              <li>
                                 <p>Fleet Patching and Provisioning将特定的黄金图像与其所有后代房屋进行比较，并列出应用于那些不在黄金图像中的房屋的所有补丁的聚合。这为新的黄金映像提供了构建规范，可以应用于原始黄金映像的所有后代，这样就不会从任何这些部署中丢失任何补丁。</p>
                              </li>
                           </ul>
                        </div>
                     </li>
                     <li>
                        <p><span class="italic">配置收集和报告</span> ：Fleet Patching和Provisioning Server可以收集和保留操作系统配置以及指定的Fleet Patching和Provisioning Clients的根文件系统内容。如果Fleet Patching and Provisioning Client节点变得不可用（例如，用户意外删除或更改了操作系统配置或根文件系统），则可能很难确定问题并进行更正。此功能可自动收集相关信息，从而在节点发生故障时实现简单的恢复。
                        </p>
                     </li>
                  </ul>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-CCEC5960-EDA4-4A3F-9643-0CA308EA49AA__GUID-D212A924-1923-43C0-B536-EF7A9075E3BC">灵活性和可扩展性</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <div class="p"><span class="italic">RESTful API</span> ：Fleet Patching和Provisioning为许多常见操作提供RESTful API，包括配置，修补，升级和查询操作。
                           <div class="infoboxnotealso" id="GUID-CCEC5960-EDA4-4A3F-9643-0CA308EA49AA__GUID-AE768EA4-0C36-4EE1-A129-2ED44921769D">
                              <p class="notep1">也可以看看：</p><a href="../dbrst/index.html" target="_blank"><span><cite>Oracle Database REST API参考</cite></span></a></div>
                        </div>
                     </li>
                     <li>
                        <p><span class="italic">可定制的身份验证</span> ：某些环境中的主机到主机身份验证，尤其是在合规性行业（如财务和电子商务）中，通常使用Fleet Patching and Provisioning本身不支持的技术和产品。此功能允许将Fleet Patching和Provisioning身份验证与您数据中心使用的机制集成。
                        </p>
                     </li>
                     <li>
                        <p><span class="italic">命令调度程序</span> ：调度和捆绑自动化任务的能力对于维护大型数据库资产至关重要。Fleet Patching和Provisioning支持调度任务，例如配置软件家庭，切换到新家庭以及扩展群集。此外，您还可以向命令添加客户端列表，从而促进大规模操作。
                        </p>
                     </li>
                     <li>
                        <p><span class="italic">可配置的连接</span> ：随着安全问题和合规性要求的增加，许多企业内部网的连接限制也在增加。您可以配置用于Fleet Patching和Provisioning Server及其客户端之间通信的小型设置端口，从而实现对防火墙或审计意识环境的低影响集成。
                        </p>
                     </li>
                  </ul>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-CCEC5960-EDA4-4A3F-9643-0CA308EA49AA__GUID-FA0DAFAD-CAB1-48EB-9148-6F363AE179E7">其他舰队补丁和配置功能</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><span class="italic">零停机升级</span> ：所有升级步骤的自动化最大限度地减少甚至消除了升级Oracle数据库时的应用程序停机时间。它还可以最大限度地减少资源需求，并在您必须回滚升级时提供回退路径。您可以在某些版本的Oracle RAC和Oracle RAC One Node数据库上运行零停机升级。
                        </p>
                     </li>
                     <li>
                        <p><span class="italic">配置新服务器池</span> ：Fleet Patching和Provisioning Server可以在具有的节点上安装和配置Oracle Grid Infrastructure（11 <span class="italic">g</span>版本2（11.2.0.4）和12 <span class="italic">c</span>版本1（12.1.0.2）和版本2（12.2））没有Oracle软件库存，可以使用全套Fleet Patching和Provisioning功能管理这些部署。
                        </p>
                     </li>
                     <li>
                        <p><span class="italic">提供和管理任何软件主页</span> ：Fleet Patching和Provisioning使您可以从任何软件主页创建黄金映像。然后，您可以将该软件置备到任何Fleet Patching and Provisioning Client或目标作为黄金映像的工作副本。该软件可以是您将在Fleet Patching and Provisioning Client或目标上运行的任何二进制文件。
                        </p>
                     </li>
                     <li>
                        <p><span class="italic">配置，扩展，修补和升级Oracle Grid Infrastructure</span> ：Fleet Patching和Provisioning Server可以配置Oracle Grid Infrastructure <span class="italic">11g第</span> 2版（11.2.0.4）主页，稍后可以从Oracle Grid Infrastructure配置中添加或删除节点，并且可以还可用于修补和升级Oracle Grid Infrastructure主目录。此外，还有一个回滚功能可以帮助撤消失败的补丁程序。在修补Oracle Grid Infrastructure时，您可以使用Fleet Patching和Provisioning来选择性地修补群集上托管的任何数据库。
                        </p>
                     </li>
                     <li>
                        <p><span class="italic">配置，扩展，修补和升级Oracle数据库</span> ：您可以使用Fleet Patching和Provisioning，您可以配置，扩展和修补Oracle Database <span class="italic">11g第</span> 2版（11.2.0.4）及更高版本。您还可以将Oracle数据库从11 <span class="italic">g</span>版本2（11.2.0.3）升级到11 <span class="italic">g</span>版本2（11.2.0.4）;从<span class="italic">11克</span> 2版（11.2.0.4），以12 <span class="italic">C</span>释放1（12.1.0.2）;和从<span class="italic">11克</span> 2版（11.2.0.4）或12 <span class="italic">c</span>释放1（12.1.0.2）至12个<span class="italic">C</span> 2版（12.2）。
                        </p>
                        <p>当您配置此类软件时，Fleet Patching and Provisioning提供了在不同类型的存储上创建各种类型的数据库（例如Oracle RAC，单实例和Oracle Real Application Clusters One节点（Oracle RAC One Node）数据库）的附加功能，以及其他选项，例如使用模板和创建容器数据库（CDB）。Fleet Patching和Provisioning Server可以将节点添加到Oracle RAC配置，并从Oracle RAC配置中删除节点。Fleet Patching和Provisioning还改进并提高了数据库软件的补丁效率，允许在大多数情况下快速和远程修补软件，而无需数据库停机。</p>
                     </li>
                     <li>
                        <p><span class="italic">支持单实例数据库</span> ：您可以使用Fleet Patching和Provisioning来配置，修补和升级在群集或Oracle Restart上运行的单实例数据库，或者在单个独立节点上运行。
                        </p>
                     </li>
                     <li>
                        <p><span class="italic">高级修补功能</span> ：在修补Oracle Grid Infrastructure或Oracle数据库主页时，Fleet Patching和Provisioning提供了一种批处理模式，通过并行修补群集的部分或全部节点来加速修补过程，而不是按顺序修补。
                        </p>
                        <p>对于Oracle数据库主目录，您可以定义不相交的节点集。每组节点按顺序更新。通过参考在其上运行的数据库实例来定义集合，您可以通过确保服务永远不会完全脱机来最小化滚动更新的影响。“smartmove”选项可用于帮助定义批次集以实现此目标。</p>
                        <p>与应用程序连续性集成是另一项有助于消除维护影响的增强功能。这提供了在群集中优雅地耗尽和重新定位服务的能力，完全掩盖了用户的维护。</p>
                     </li>
                     <li>
                        <p><span class="italic">通知</span> ：Fleet Patching和Provisioning Server是数据中心可用软件家庭的中央存储库。因此，整个数据中心的管理员必须了解可能影响其责任区域的库存变化。
                        </p>
                        <p>Fleet Patching and Provisioning使您和其他用户可以订阅图像系列事件。任何订阅的人都将通过电子邮件通知特定图像系列中可用图像的任何更改。此外，当向客户端添加或删除黄金映像的工作副本时，可以通过电子邮件通知用户。</p>
                     </li>
                     <li>
                        <p><span class="italic">自定义工作流支持</span> ：您可以为各种Fleet Patching和Provisioning操作创建操作，例如导入图像，添加或删除黄金映像的工作副本以及管理软件主页。您可以为每个操作定义不同的操作，并进一步区分操作所适用的图像类型。您定义的操作可以在给定操作之前或之后执行，并在操作所适用的部署上执行，无论是Fleet Patching还是Provisioning Server，还是未运行Fleet Patching和Provisioning Client的目标，或者正在运行Fleet Patching and Provisioning Client的目标。
                        </p>
                     </li>
                     <li>
                        <p><span class="italic">恢复失败的操作</span> ：如果某项操作（如添加映像，配置黄金映像的工作副本或执行扩展，修补或升级）失败，则Fleet Patching and Provisioning会报告错误并停止。问题得到纠正后（例如，目标节点上的目录权限或所有权配置错误），您可以重新运行失败的RHPCTL命令，它将从故障点恢复。这可以避免重做在失败之前可能已完成的任何工作。
                        </p>
                     </li>
                     <li>
                        <p><span class="italic">审计命令</span> ：车队修补和配置服务器记录所有车队修补和配置操作的执行，并记录其结果（成功或失败）。审计机制使您能够以各种维度查询审计日志，还可以管理其内容和大小。
                        </p>
                     </li>
                  </ul>
               </div>
               <!-- class="section" -->
               <div class="infoboxnote" id="GUID-CCEC5960-EDA4-4A3F-9643-0CA308EA49AA__GUID-9726D570-4A7D-4DF5-8464-8E4C2769B59B">
                  <p class="notep1">注意：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>Oracle不支持HP-UX或Windows操作系统上的Fleet Patching和Provisioning。</p>
                     </li>
                     <li>
                        <p>Fleet Patching和Provisioning Server不管理操作系统映像。</p>
                     </li>
                  </ul>
               </div>
               <p>本节包括以下主题：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="rapid-home-provisioning.html#GUID-CA5067D0-3847-48F5-BBC7-37617DDBCF66" title="有关Fleet Patching和Provisioning架构的概念信息。">Fleet Patching和Provisioning Architecture</a></p>
                  </li>
                  <li>
                     <p><a href="rapid-home-provisioning.html#GUID-33FC643F-0A2C-4EFF-A13A-D3054D945119" title="实施Fleet Patching和Provisioning涉及创建Fleet Patching和Provisioning Server，将黄金映像添加到服务器，以及创建黄金映像的工作副本以供应软件。">车队补丁和供应实施</a></p>
                  </li>
                  <li>
                     <p><a href="rapid-home-provisioning.html#GUID-F4F263A1-0580-4386-B929-5252A196632E" title="Fleet Patching和Provisioning Server为将Oracle Grid Infrastructure家庭分发到目标和Fleet Patching和Provisioning Client提供了一个高效安全的平台。">Oracle Grid Infrastructure Management</a></p>
                  </li>
                  <li>
                     <p><a href="rapid-home-provisioning.html#GUID-F1F48984-C440-44F4-9D62-BDB4BE1CDB4A" title="Fleet Patching和Provisioning Server为将数据库家园分发到目标和Fleet Patching和Provisioning Client提供了一个高效安全的平台。">Oracle数据库软件管理</a></p>
                  </li>
                  <li>
                     <p><a href="rapid-home-provisioning.html#GUID-40D3B039-92D9-4325-908B-C40C7FA9B805" title="使用自动化和协调数据库升级的Fleet Patching和Provisioning，您可以升级Oracle RAC或Oracle RAC One Node数据库，而不会中断服务。">零停机升级</a></p>
                  </li>
                  <li>
                     <p><a href="rapid-home-provisioning.html#GUID-6CDC373B-6261-4BF8-BD60-2E9E2C3E0168" title="Oracle在应用更新时建议使用不合适的修补程序。">修补过程中的持久主路径</a></p>
                  </li>
                  <li>
                     <p><a href="rapid-home-provisioning.html#GUID-8D6EC31C-C179-4939-B153-C02F4398C9E0" title="Fleet Patching和Provisioning Client的管理任务包括创建，启用和禁用，创建用户以及为这些用户分配角色以及管理密码。">管理车队修补和配置客户端</a></p>
                  </li>
               </ul>
            </div>
            <div>
               <div class="relinfo">
                  <p><strong>相关话题</strong></p>
                  <ul>
                     <li><a href="../install-and-upgrade.html" target="_blank"><span><cite>“Oracle Real Application Clusters安装指南”</cite></span></a></li>
                  </ul>
               </div>
            </div><a id="CWADD92545"></a><div class="props_rev_3"><a id="GUID-CA5067D0-3847-48F5-BBC7-37617DDBCF66" name="GUID-CA5067D0-3847-48F5-BBC7-37617DDBCF66"></a><h3 id="CWADD-GUID-CA5067D0-3847-48F5-BBC7-37617DDBCF66" class="sect3">Fleet Patching和Provisioning Architecture</h3>
               <div>
                  <p>有关Fleet Patching和Provisioning架构的概念信息。</p>
                  <p>Fleet Patching and Provisioning体系结构包括Fleet Patching和Provisioning Server以及任意数量的Fleet Patching和Provisioning Client和目标。Oracle建议在多节点群集中部署Fleet Patching和Provisioning Server，以使其具有高可用性。</p>
                  <p>Fleet Patching和Provisioning Server集群是所有数据的存储库，其中主要有两种类型：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>黄金图片</p>
                     </li>
                     <li>
                        <p>与用户，角色，权限和身份相关的元数据</p>
                     </li>
                  </ul>
                  <p>Fleet Patching和Provisioning Server充当中央服务器，用于配置Oracle数据库家庭，Oracle Grid Infrastructure家庭和其他应用程序软件家庭，使其可用于托管Fleet Patching和Provisioning Server的群集以及Fleet Patching和Provisioning Client群集和目标。</p>
                  <p>用户在Fleet Patching and Provisioning Server或Fleet Patching and Provisioning Client上运行，以请求部署Oracle Homes或查询黄金映像。当用户请求Oracle主目录，指定黄金映像时，Fleet Patching和Provisioning Client与Fleet Patching和Provisioning Server通信以传递请求。 Fleet Patching和Provisioning Server通过采取适当的操作来实例化黄金映像的副本，并使用Oracle自动存储管理集群文件系统（Oracle ACFS）等可用技术将其提供给Fleet Patching和Provisioning Client集群，从而处理请求。 ）和本地文件系统。</p>
                  <p>Fleet Patching和Provisioning Server与Fleet Patching和Provisioning Client（运行Oracle Grid Infrastructure 12 <span class="italic">c第</span> 2版（12.2.0.1）或更高版本）和目标（目标是使用Oracle Grid Infrastructure 12c第1版（12.1.0.2）的安装进行通信使用以下端口安装11.2或未安装Oracle Grid Infrastructure，或者可以配置其中几个端口，如<a href="rapid-home-provisioning.html#GUID-CA5067D0-3847-48F5-BBC7-37617DDBCF66__GUID-69618B75-2338-4B0F-B2A5-6F76EAC2B1F2" title="描述在Fleet Patching和Provisioning Server以及Fleet Patching和Provisioning Client，目标或两者之间使用的通信端口。">表5-1中所述</a> 。此外，还注意到与Fleet Patching和Provisioning Clients进行通信时使用的端口与目标之间的差异。
                  </p>
                  <div class="tblformalwide" id="GUID-CA5067D0-3847-48F5-BBC7-37617DDBCF66__GUID-69618B75-2338-4B0F-B2A5-6F76EAC2B1F2">
                     <p class="titleintable">表5-1车队补丁和配置通信端口</p>
                     <table cellpadding="4" cellspacing="0" class="FormalWide" title="车队修补和配置通信端口" width="100%" border="1" summary="Describes communication ports used between Fleet Patching and Provisioning Servers and Fleet Patching and Provisioning Clients, targets, or both." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="20%" id="d25134e637">客户端，目标或两者</th>
                              <th align="left" valign="bottom" width="20%" id="d25134e639">协议</th>
                              <th align="left" valign="bottom" width="20%" id="d25134e641">港口</th>
                              <th align="left" valign="bottom" width="20%" id="d25134e643">目的</th>
                              <th align="left" valign="bottom" width="20%" id="d25134e645">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d25134e649" headers="d25134e637 ">
                                 <p>目标</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e649 d25134e639 ">
                                 <p>TCP</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e649 d25134e641 ">
                                 <p>22</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e649 d25134e643 ">
                                 <p>SSH</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e649 d25134e645 ">
                                 <p>基于身份验证的操作涉及无客户端目标。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d25134e665" headers="d25134e637 ">
                                 <p>客户</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e665 d25134e639 ">
                                 <p>TCP</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e665 d25134e641 ">
                                 <p>22</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e665 d25134e643 ">
                                 <p>SSH</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e665 d25134e645 ">
                                 <p>配置Oracle Grid Infrastructure 12 <span class="italic">c第</span> 2版（12.2.0.1）或更高版本需要SSH端口。（后续Fleet Patching和Provisioning Server / Client交互使用JMX路径。）
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d25134e684" headers="d25134e637 ">
                                 <p>客户</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e684 d25134e639 ">
                                 <p>TCP</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e684 d25134e641 ">
                                 <p>8896</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e684 d25134e643 ">
                                 <p>JMX注册表和服务器端口</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e684 d25134e645 ">
                                 <p>用于与Fleet Patching和Provisioning Clients建立Fleet Patching和Provisioning Server通信。</p>
                                 <p>您可以使用<code class="codeph">srvctl modify rhpserver -port <span class="variable" translate="no">port_number</span></code>命令配置此端口。
                                 </p>
                                 <p><span class="bold">注意：</span>上述命令要求您重新启动服务。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d25134e711" headers="d25134e637 ">
                                 <p>客户</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e711 d25134e639 ">
                                 <p>UDP</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e711 d25134e641 ">
                                 <p>端口53必须仅在Fleet Patching和Provisioning Server上打开才能接受传入连接。</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e711 d25134e643 ">
                                 <p>GNS端口</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e711 d25134e645 ">
                                 <p>GNS用于Fleet Patching和Provisioning Client以定位Fleet Patching和Provisioning Server。</p>
                                 <p>您可以使用或不使用区域委派来配置GNS。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d25134e729" headers="d25134e637 ">
                                 <p>都</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e729 d25134e639 ">
                                 <p>TCP</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e729 d25134e641 ">
                                 <p>为临时端口范围中的每个RHPCTL命令指定一个端口，或者使用<code class="codeph">srvctl modify rhpserver –pl_port <span class="variable" translate="no">port_number</span></code>命令指定一个端口。
                                 </p>
                                 <p>必须打开Progress侦听器端口才能接受运行RHPCTL的服务器上的传入连接（无论是Fleet Patching和Provisioning Server还是Client）。</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e729 d25134e643 ">
                                 <p>命令进度监听器</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e729 d25134e645 ">
                                 <p>Fleet Patching和Provisioning Server从临时范围打开一个随机端口，以监视客户端或目标上的进度，或使用您使用<code class="codeph">srvctl modify rhpserver –pl_port <span class="variable" translate="no">port_number</span></code>指定的固定端口以及跨客户端/目标的多路复用。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d25134e757" headers="d25134e637 ">
                                 <p>运行Oracle Database 18c或Oracle Database 12 <span class="italic">c的</span>客户端以及2018年1月的RU或更高版本运行的第2版（12.2.0.1）</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e757 d25134e639 ">
                                 <p>TCP</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e757 d25134e641 ">
                                 <p>您必须在Fleet Patching and Provisioning Client服务器上有六个用于黄金映像供应的端口才能接受传入连接。</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e757 d25134e643 ">
                                 <p>使用2018年1月RU（在Fleet Patching and Provisioning Server上运行<code class="codeph">rhpctl add workingcopy</code>命令） <code class="codeph">rhpctl add workingcopy</code> Gold映像传输到Oracle Database 18c客户端和客户端</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e757 d25134e645 ">
                                 <p>将Fleet Patching and Provisioning Server中的黄金映像副本传输到客户端使用从短暂范围中选择的六个端口，或使用<code class="codeph">srvctl modify rhpserver -port_range <span class="variable" translate="no">port_number_range</span></code>定义的六个端口。在这种情况下，请指定一个范围以适应您将使用的预期并行度（并发传输）。如果指定了<code class="codeph">port_range</code>值，并且RHPS管理12.2个客户端，则必须将客户端修补到12.2.0.1.180717OCWJUL2018RU或更高版本。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d25134e787" headers="d25134e637 ">
                                 <p>都</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e787 d25134e639 ">
                                 <p>TCP / UDP</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e787 d25134e641 ">
                                 <p>固定和可配置端口，如<a href="rapid-home-provisioning.html#GUID-CA5067D0-3847-48F5-BBC7-37617DDBCF66__GUID-8D86DD62-83BE-4BDF-8BEF-4A999DDB1885" title="描述用于NFS的端口">表5-2中所述</a></p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e787 d25134e643 ">
                                 <p>NFS</p>
                                 <p>如果RHPC集群处于版本18c（18.4）或更高版本，则不需要NFS。</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e787 d25134e645 ">
                                 <p>Fleet Patching和Provisioning Server使用临时NFS挂载点将软件家庭转移到目标和Oracle Database 12 <span class="italic">c</span>版本2（12.2.0.1），2018年1月之前的RU客户端。NFS还用于客户端和目标（所有版本）上的远程命令执行支持。
                                 </p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="tblformalwide" id="GUID-CA5067D0-3847-48F5-BBC7-37617DDBCF66__GUID-8D86DD62-83BE-4BDF-8BEF-4A999DDB1885">
                     <p class="titleintable">表5-2 NFS端口</p>
                     <table cellpadding="4" cellspacing="0" class="FormalWide" title="NFS端口" width="100%" border="1" summary="Describes ports for use with NFS" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="20%" id="d25134e821">港口</th>
                              <th align="left" valign="bottom" width="20%" id="d25134e823">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d25134e827" headers="d25134e821 ">
                                 <p>2049年，111</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e827 d25134e823 ">
                                 <p>修复了NFS端口</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d25134e834" headers="d25134e821 ">
                                 <p>六个端口从临时范围（默认）中选择或在<code>/etc/sysconfig/nfs</code></p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e834 d25134e823 ">
                                 <div class="p">可配置的NFS端口，每个项目后跟其配置文件条目：<ul class="simple" style="list-style-type:none;padding-left:0">
                                       <li>rpc：STATD_PORT</li>
                                       <li>rpc status out：STATD_OUTGOING_PORT</li>
                                       <li>rpc配额：RQUOTAD_PORT</li>
                                       <li>rpc mountd：MOUNTD_PORT</li>
                                       <li>rpc lockd tcp：LOCKD_TCPPORT</li>
                                       <li>rpc lockd udp：LOCKD_UDPPORT</li>
                                    </ul>
                                 </div>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
               </div><a id="CWADD92585"></a><div class="props_rev_3"><a id="GUID-3B15B8F9-208E-4881-B62F-1B35E70FB64E" name="GUID-3B15B8F9-208E-4881-B62F-1B35E70FB64E"></a><h4 id="CWADD-GUID-3B15B8F9-208E-4881-B62F-1B35E70FB64E" class="sect4">Fleet Patching和Provisioning Server</h4>
                  <div>
                     <p>Fleet Patching and Provisioning Server是一个高度可用的软件供应系统，它使用Oracle自动存储管理（Oracle ASM），Oracle自动存储管理集群文件系统（Oracle ACFS），网格命名服务（GNS）和其他组件。</p>
                     <p>Fleet Patching和Provisioning Server主要用作配置Oracle主目录的中央服务器，使其可用于Fleet Patching和Provisioning Client和目标。</p>
                     <p>Fleet Patching and Provisioning Server的功能：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>有效地存储托管家庭的黄金图像和图像系列，包括单独的二进制文件，以及与用户，角色和权限相关的元数据。</p>
                        </li>
                        <li>
                           <p>根据要求提供客户可用房屋清单。</p>
                        </li>
                        <li>
                           <p>将软件回家一次，然后将主页部署到任何Fleet Patching and Provisioning Client或任何其他目标，而不是修补每个站点。</p>
                        </li>
                        <li>
                           <p>提供报告现有部署的功能。</p>
                        </li>
                        <li>
                           <p>在物理服务器和虚拟机上部署家庭。</p>
                        </li>
                        <li>
                           <p>通知订阅者图像系列的更改。</p>
                        </li>
                        <li>
                           <p>维护所有运行的RHPCTL命令的审核日志。</p>
                        </li>
                     </ul>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-817F0470-7F7F-446B-9160-AA63DE5EF09E" name="GUID-817F0470-7F7F-446B-9160-AA63DE5EF09E"></a><h4 id="CWADD-GUID-817F0470-7F7F-446B-9160-AA63DE5EF09E" class="sect4">舰队修补和供应目标</h4>
                  <div>
                     <p>Fleet Patching和Provisioning意识到的计算机被称为目标。</p>
                     <p>Fleet Patching和Provisioning Server可以创建新目标，还可以在仅安装了操作系统的目标上安装和配置Oracle Grid Infrastructure。随后，Fleet Patching和Provisioning Server可以在这些目标上配置数据库和其他软件，执行维护，扩展目标群集以及许多其他操作。所有Fleet Patching和Provisioning命令都在Fleet Patching and Provisioning Server上运行。在Oracle Clusterware 12 <span class="italic">c第</span> 2版（12.2）及更高版本中运行Fleet Patching and Provisioning Client的目标也可以运行许多Fleet Patching和Provisioning命令，以从Fleet Patching和Provisioning Server请求新软件并自行启动维护，其他任务。
                     </p>
                     <div class="infoboxnote" id="GUID-817F0470-7F7F-446B-9160-AA63DE5EF09E__GUID-8C5E4165-F38F-4F2E-91DC-DE24047E0148">
                        <p class="notep1">注意：</p>如果您的目标是在12 <span class="italic">c</span>版本2（12.2）之前在Oracle Clusterware中运行Fleet Patching and Provisioning Client，那么您可以使用RHPCTL实用程序导入映像，而无需将其作为客户端。对于在Oracle Clusterware 12 <span class="italic">c第</span> 2版（12.2）及更高版本中运行的客户端，必须配置和启用Fleet Patching和Provisioning Clients以简化连接和凭据问题。
                     </div>
                  </div>
               </div><a id="CWADD92586"></a><div class="props_rev_3"><a id="GUID-67917A2D-9C1E-423D-9BCB-FDD88E5663DD" name="GUID-67917A2D-9C1E-423D-9BCB-FDD88E5663DD"></a><h4 id="CWADD-GUID-67917A2D-9C1E-423D-9BCB-FDD88E5663DD" class="sect4">Fleet Patching and Provisioning Clients</h4>
                  <div>
                     <p>Fleet Patching和Provisioning Client是Oracle Grid Infrastructure的一部分。用户在Fleet Patching and Provisioning Client上运行，以执行诸如请求部署Oracle主页和列出可用黄金映像等任务。</p>
                     <p>当用户请求指定黄金映像的Oracle主目录时，Fleet Patching和Provisioning Client与Fleet Patching和Provisioning Server通信以传递请求。 Fleet Patching和Provisioning Server通过实例化黄金映像的工作副本并使用Oracle ACFS或其他本地文件系统将其提供给Fleet Patching and Provisioning Client来处理请求。</p>
                     <p>Fleet Patching and Provisioning Client：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>可以使用Oracle ACFS存储黄金映像的工作副本，可以快速配置为本地家庭;可以使用Oracle ACFS快照快速创建或撤消新住宅。</p>
                           <div class="infoboxnote" id="GUID-67917A2D-9C1E-423D-9BCB-FDD88E5663DD__GUID-E97A141E-2147-487D-8B9F-E88A25B2E8F0">
                              <p class="notep1">注意：</p>
                              <p>除了Oracle ACFS之外，Oracle还支持使用其他本地文件系统。</p>
                           </div>
                        </li>
                        <li>
                           <p>提供Fleet Patching and Provisioning Server中可用房屋的列表。</p>
                        </li>
                        <li>
                           <p>具有Oracle Clusterware 12 <span class="italic">c第</span> 2版（12.2）中的完整功能，可以与Oracle Clusterware 12 <span class="italic">c第</span> 2版（12.2）或更高版本中的Fleet Patching和Provisioning Server进行通信。
                           </p>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="rapid-home-provisioning.html#GUID-E65C9FC4-C8AC-4BF6-A689-A70C70B3A636" title="用户在Fleet Patching and Provisioning Client上运行，以执行诸如请求部署Oracle主页和查询黄金映像等任务。">创建Fleet Patching和Provisioning客户端</a></li>
                        </ul>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-44D851A3-9478-4A6F-A779-70FB85191A2C" name="GUID-44D851A3-9478-4A6F-A779-70FB85191A2C"></a><h4 id="CWADD-GUID-44D851A3-9478-4A6F-A779-70FB85191A2C" class="sect4">车队修补和供应操作的身份验证选项</h4>
                  <div>
                     <p>某些RHPCTL命令将身份验证选项显示为可选参数。</p>
                     <p>在Fleet Patching and Provisioning Client上运行RHPCTL命令时，在Fleet Patching and Provisioning Server上运行RHPCTL命令并在Fleet Patching and Provisioning Client上运行时，不需要指定身份验证选项，因为服务器和客户端建立了创建客户端时的信任关系，每次事务发生时都在内部处理身份验证。（必须指定身份验证选项的服务器/客户端通信的唯一条件是服务器配置新的Oracle Grid Infrastructure部署时 - 在这种情况下，客户端尚不存在。）</p>
                     <div class="p">要在不是Fleet Patching and Provisioning Client的目标上运行，您必须向Fleet Patching和Provisioning Server提供允许其与目标进行身份验证的信息。选项如下：<ul style="list-style-type:disc">
                           <li>
                              <p>提供目标的<code class="codeph">root</code>密码（在<code class="codeph">stdin</code> ）</p>
                           </li>
                           <li>
                              <p>为目标提供<code class="codeph">sudo</code>用户名， <code class="codeph">sudo</code>二进制路径和密码（ <code class="codeph">stdin</code> ）</p>
                           </li>
                           <li>
                              <p>从本地加密存储以非交互方式提供密码（ <code class="codeph">root</code>或<code class="codeph">sudouser</code> ）（使用<code class="codeph">-cred</code> authentication参数）</p>
                           </li>
                           <li>
                              <p>提供存储在Fleet Patching and Provisioning Server上的身份文件的路径，以进行SSL加密的无密码身份验证（使用<code class="codeph">-auth sshkey</code>选项）</p>
                           </li>
                        </ul>
                     </div>
                     <div class="section">
                        <p class="subhead3" id="GUID-44D851A3-9478-4A6F-A779-70FB85191A2C__GUID-D9E12B72-8557-4D68-97C7-FB923FB2E6B4">无密码验证详细信息</p>
                        <div class="p">Fleet Patching和Provisioning Server可以使用密钥对通过SSH对目标进行身份验证。要启用该选项，则必须建立与用户等效<code class="codeph">crsusr</code>的舰队修补和配置服务器和<code class="codeph">root</code>或<code class="codeph">sudouser</code>目标。
                           <div class="infoboxnote" id="GUID-44D851A3-9478-4A6F-A779-70FB85191A2C__GUID-22CB29D1-85F5-427A-8552-A9DC37D73585">
                              <p class="notep1">注意：</p>创建等效性的步骤与平台有关，因此这里不再详细说明。对于Linux，请参阅要在目标上运行的命令<code class="codeph">ssh-keygen</code>和要在Fleet Patching and Provisioning Server上运行的<code class="codeph">ssh-copy-id</code> 。
                           </div>
                        </div>
                        <div class="p">例如，假设您已在Fleet Patching和Provisioning Server上的<code class="codeph">nonRHPClient4004.example.com</code>与目标节点上的<code class="codeph">root</code> <code class="codeph">crsusr</code>之间建立了用户等效，并在<code>/home/oracle/rhp/ssh-key/key –path</code>上保存了Fleet Patching and Provisioning Server上的密钥信息。 <code>/home/oracle/rhp/ssh-key/key –path</code> ，然后以下命令将使用无密码身份验证将指定的黄金映像的副本提供给目标节点：<pre class="pre codeblock"><code>$ rhpctl add workingcopy -workingcopy db12102_160607wc1 -image db12102_160607 -targetnode nonRHPClient4004.example.com -path /u01/app/oracle/12.1/rhp/dbhome_1 -oraclebase / u01 / app / oracle -auth sshkey -arg1 user：root -arg2 identity_file ：/家庭/ ORACLE / RHP / SSH-键/</code></pre></div>
                        <div class="p">对于等价之间<code class="codeph">crsusr</code>上舰队修补和配置服务器和特权用户（除了<code class="codeph">root</code>上的目标），则<code class="codeph">-auth</code>命令的部分将类似于以下内容：<pre class="pre codeblock"><code>-auth sshkey -arg1 user： <span class="variable" translate="no">ssh_user</span> -arg2 identity_file： <span class="variable" translate="no">path_to_identity_file_on_RHPS</span> -arg3 sudo_location： <span class="variable" translate="no">path_to_sudo_binary_on_target</span></code></pre></div>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-5CCBB74C-D6BD-4681-98DF-96A16E14CE17" title="将凭据添加到Oracle Cluster Registry（OCR）。">rhpctl添加凭据</a></li>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-EB74413B-F6A5-43AB-B19F-1050BB1260B4" title="从Oracle Cluster Registry（OCR）中删除凭据。">rhpctl删除凭据</a></li>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-61929F3C-A50A-45EA-8B4A-D11E245A6493" title="在客户端群集上创建工作副本。">rhpctl添加workingcopy</a></li>
                        </ul>
                     </div>
                  </div>
               </div><a id="CWADD92588"></a><div class="props_rev_3"><a id="GUID-3AE65540-02ED-4178-8ACC-BC45094C214B" name="GUID-3AE65540-02ED-4178-8ACC-BC45094C214B"></a><h4 id="CWADD-GUID-3AE65540-02ED-4178-8ACC-BC45094C214B" class="sect4">舰队修补和供应角色</h4>
                  <div>
                     <p>管理员分配<a id="d25134e1684" class="indexterm-anchor"></a>具有为每个角色定义的访问级别权限的Fleet Patching和Provisioning用户的角色。还为Fleet Patching和Provisioning Client上的用户分配了特定角色。Fleet Patching和Provisioning包括基本的内置和复合内置角色。
                     </p>
                  </div>
                  <div class="props_rev_3"><a id="GUID-BBB0C3C2-40C5-4595-A699-C410EB9BCD1A" name="GUID-BBB0C3C2-40C5-4595-A699-C410EB9BCD1A"></a><h5 id="CWADD-GUID-BBB0C3C2-40C5-4595-A699-C410EB9BCD1A" class="sect5">基本的内置角色</h5>
                     <div>
                        <div class="section">
                           <p>该<a id="d25134e1807" class="indexterm-anchor"></a>基本的内置角色及其功能是：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>GH_ROLE_ADMIN：与角色相关的所有内容的管理角色。分配了此角色的用户可以运行<code class="codeph">rhpctl <span class="variable" translate="no">verb</span> role</code>命令。
                                 </p>
                              </li>
                              <li>
                                 <p>GH_SITE_ADMIN：与Fleet Patching和Provisioning Clients相关的所有内容的管理角色。分配了此角色的用户可以运行<code class="codeph">rhpctl <span class="variable" translate="no">verb</span> client</code>命令。
                                 </p>
                              </li>
                              <li>
                                 <p>GH_SERIES_ADMIN：与图像系列相关的所有内容的管理角色。分配了此角色的用户可以运行<code class="codeph">rhpctl <span class="variable" translate="no">verb</span> series</code>命令。
                                 </p>
                              </li>
                              <li>
                                 <p>GH_SERIES_CONTRIB：分配这个角色可以通过图像添加到一系列用户<code class="codeph">rhpctl insertimage series</code>命令使用的一个系列，或删除的图像<code class="codeph">rhpctl deleteimage series</code>命令。
                                 </p>
                              </li>
                              <li>
                                 <p>GH_WC_ADMIN：与黄金图像的工作副本相关的所有内容的管理角色。分配了此角色的用户可以运行<code class="codeph">rhpctl <span class="variable" translate="no">verb</span> workingcopy</code>命令。
                                 </p>
                              </li>
                              <li>
                                 <p>GH_WC_OPER：一种角色，使用户可以使用带有<code class="codeph">-user</code>选项的<code class="codeph">rhpctl add workingcopy</code>命令（为其他人创建时）为自己或他人创建黄金映像的工作副本。分配了此角色的用户没有管理权限，只能管理他们创建的黄金映像的工作副本。
                                 </p>
                              </li>
                              <li>
                                 <p>GH_WC_USER：一种角色，使用户能够使用<code class="codeph">rhpctl add workingcopy</code>命令创建黄金映像的工作副本。分配了此角色的用户没有管理权限，只能删除他们创建的工作副本。
                                 </p>
                              </li>
                              <li>
                                 <p>GH_IMG_ADMIN：与图像相关的所有内容的管理角色。分配了此角色的用户可以运行<code class="codeph">rhpctl <span class="variable" translate="no">verb</span> image</code>命令。
                                 </p>
                              </li>
                              <li>
                                 <p>GH_IMG_USER：允许用户使用<code class="codeph">rhpctl add | import image</code>创建图像的<code class="codeph">rhpctl add | import image</code>命令。分配了此角色的用户没有管理权限，只能删除他们创建的图像。
                                 </p>
                              </li>
                              <li>
                                 <p>GH_IMG_TESTABLE：一种角色，使用户能够添加处于<code class="codeph">TESTABLE</code>状态的图像的工作副本。还必须为分配了此角色的用户分配GH_WC_ADMIN角色或GH_WC_USER角色以添加工作副本。
                                 </p>
                              </li>
                              <li>
                                 <p>GH_IMG_RESTRICT：一种角色，使用户能够从处于<code class="codeph">RESTRICTED</code>状态的图像添加工作副本。还必须为分配了此角色的用户分配GH_WC_ADMIN角色或GH_WC_USER角色以添加工作副本。
                                 </p>
                              </li>
                              <li>
                                 <p>GH_IMG_PUBLISH：分配了此角色的用户可以将图像提升到另一个状态，或者将图像从<code class="codeph">PUBLISHED</code>状态缩回到<code class="codeph">TESTABLE</code>或<code class="codeph">RESTRICTED</code>状态。
                                 </p>
                              </li>
                              <li>
                                 <p>GH_IMG_VISIBILITY：分配了此角色的用户可以使用<code class="codeph">rhpctl allow | disallow image</code>修改对提升或已发布图像的访问权限<code class="codeph">rhpctl allow | disallow image</code>命令。
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
                  <div class="props_rev_3"><a id="GUID-DDFA409C-8C12-453E-907D-6D75E50BFE7B" name="GUID-DDFA409C-8C12-453E-907D-6D75E50BFE7B"></a><h5 id="CWADD-GUID-DDFA409C-8C12-453E-907D-6D75E50BFE7B" class="sect5">复合内置角色</h5>
                     <div>
                        <div class="section">
                           <p>该<a id="d25134e2039" class="indexterm-anchor"></a>复合内置角色及其功能是：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>GH_SA：Fleet Patching and Provisioning Server上的Oracle Grid Infrastructure用户自动继承此角色。</p>
                                 <p>GH_SA角色包括以下基本内置角色：GH_ROLE_ADMIN，GH_SITE_ADMIN，GH_SERIES_ADMIN，GH_SERIES_CONTRIB，GH_WC_ADMIN，GH_IMG_ADMIN，GH_IMG_TESTABLE，GH_IMG_RESTRICT，GH_IMG_PUBLISH和GH_IMG_VISIBILITY。</p>
                              </li>
                              <li>
                                 <p>GH_CA：Fleet Patching and Provisioning Client上的Oracle Grid Infrastructure用户自动继承此角色。</p>
                                 <p>GH_CA角色包括以下基本内置角色：GH_SERIES_ADMIN，GH_SERIES_CONTRIB，GH_WC_ADMIN，GH_IMG_ADMIN，GH_IMG_TESTABLE，GH_IMG_RESTRICT，GH_IMG_PUBLISH和GH_IMG_VISIBILITY。</p>
                              </li>
                              <li>
                                 <p>GH_OPER：此角色包括以下内置角色：GH_WC_OPER，GH_SERIES_ADMIN，GH_IMG_TESTABLE，GH_IMG_RESTRICT和GH_IMG_USER。分配了此角色的用户只能删除他们创建的图像。</p>
                              </li>
                           </ul>
                           <p>考虑一个名为<code class="codeph">G1</code>的黄金映像，可在Fleet Patching and Provisioning Server上使用。
                           </p>
                           <p>进一步考虑Fleet Patching and Provisioning Client <code class="codeph">Cl1</code>上的用户<code class="codeph">U1</code>具有GH_WC_USER角色。如果<code class="codeph">U1</code>请求基于黄金映像<code class="codeph">G1</code>配置Oracle主目录，那么<code class="codeph">U1</code>可以这样做，因为GH_WC_USER角色授予了权限。但是，如果<code class="codeph">U1</code>请求删除<code class="codeph">G1</code> ，则该请求将被拒绝，因为GH_WC_USER角色没有必要的权限。
                           </p>
                           <p>Fleet Patching和Provisioning Server可以将用户角色映射关联到Fleet Patching and Provisioning Client。在Fleet Patching和Provisioning Server委派用户角色映射后，Fleet Patching和Provisioning Client可以修改Fleet Patching和Provisioning Server上属于Fleet Patching and Provisioning Client的所有用户的用户角色映射。这是因为只有Fleet Patching和Provisioning Server才能使用该站点的客户端群集名称来限定Fleet Patching和Provisioning Client站点中的用户ID。因此，Fleet Patching and Provisioning Client <code class="codeph">CL1</code>将无法更新<code class="codeph">CL2</code>上用户的用户映射，其中<code class="codeph">CL2</code>是不同Fleet Patching and Provisioning Client的群集名称。
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div><a id="CWADD93060"></a><div class="props_rev_3"><a id="GUID-DF1DCE94-B92D-4925-971C-6C60929E455F" name="GUID-DF1DCE94-B92D-4925-971C-6C60929E455F"></a><h4 id="CWADD-GUID-DF1DCE94-B92D-4925-971C-6C60929E455F" class="sect4">舰队修补和供应图像</h4>
                  <div>
                     <p></p>
                     <p>默认情况下，使用<code class="codeph">rhpctl import image</code>或<code class="codeph">rhpctl add image</code>创建黄金<code class="codeph">rhpctl add image</code> ，映像已准备好供应工作副本。但是，在某些情况下，您可能希望限制对图像的访问，并要求某人在将图像提供给一般用途之前对其进行测试或验证。
                     </p>
                     <p>您还可以在Fleet Patching and Provisioning Server上创建一组黄金图像，这些图像可以统称为彼此相关的黄金图像系列，例如相同的发行版本，特定用户发布的黄金图像或图像。组织内的特定部门。</p>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="rapid-home-provisioning.html#GUID-7D5E221B-4F74-4ECE-ADD1-6F060D6D7A7C">图像状态</a></li>
                           <li><a href="rapid-home-provisioning.html#GUID-1FE5E4A1-3920-467C-B2DD-749F436D35E6" title="图像系列是将不同的黄金图像分组为逻辑序列的便捷方式。">图像系列</a></li>
                           <li><a href="rapid-home-provisioning.html#GUID-E3AF7DAC-8612-445B-9368-60A30C1DA474" title="添加或导入黄金图像时，必须指定图像类型。">图像类型</a></li>
                        </ul>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-69A53A58-F50D-43E2-B79C-405369113FF8" name="GUID-69A53A58-F50D-43E2-B79C-405369113FF8"></a><h4 id="CWADD-GUID-69A53A58-F50D-43E2-B79C-405369113FF8" class="sect4">车队补丁和配置服务器中的黄金映像分配</h4>
                  <div>
                     <p>Fleet Patching和Provisioning可以在Fleet Patching和Provisioning Server之间自动共享和同步黄金映像。</p>
                     <div class="section">在Fleet Patching and Provisioning体系结构中，一个Fleet Patching和Provisioning Server管理给定数据中心（或数据中心的网段）内的一组Fleet Patching和Provisioning Client以及目标。如果您有多个数据中心或分段数据中心，则必须具有多个Fleet Patching和Provisioning Server。</div>
                     <!-- class="section" -->
                     <div class="section">在Fleet Patching and Provisioning体系结构中，一个Fleet Patching和Provisioning Server管理给定数据中心（或数据中心的网段）内的一组Fleet Patching和Provisioning Client以及目标。如果您有多个数据中心或分段数据中心，那么您必须拥有多个Fleet Patching和Provisioning Server，以促进跨多个庄园的大规模标准化。</div>
                     <!-- class="section" -->
                     <div class="section">Fleet Patching和Provisioning Servers保留了创建和管理其范围内私有的黄金映像的能力，因此可以无缝支持本地自定义。</div>
                     <!-- class="section" -->
                     <div class="p">您必须首先在两个Fleet Patching和Provisioning Server之间建立对等关系。注册使用Fleet Patching和Provisioning Server群集的名称。两个群集的名称可以相同，但有一个命名限制：如果该对等体与Fleet Patching具有相同的名称，则Fleet Patching和Provisioning Server（例如<code class="codeph">RHPS_1</code> ）无法注册对等Fleet Patching和Provisioning Server。在<code class="codeph">RHPS_1</code>的管理域内配置客户端或目标。
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>在一个Fleet Patching和Provisioning Server上，创建一个包含服务器配置信息的文件，如下所示：</span><div><pre class="pre codeblock"><code>$ rhpctl export server -serverdata <span class="variable" translate="no">file_path</span></code></pre></div>
                        </li>
                        <li class="stepexpand"><span>将文件复制到第二个Fleet Patching and Provisioning Server。</span></li>
                        <li class="stepexpand"><span>完成第二个Fleet Patching和Provisioning Server的注册，如下所示：</span><div><pre class="pre codeblock"><code>$ rhpctl register server -server <span class="variable" translate="no">server_cluster_name</span> -serverdata <span class="variable" translate="no">file</span> {-root | {-sudouser <span class="variable" translate="no">user_name</span> -sudopath <span class="variable" translate="no">sudo_path</span> }}</code></pre><p>凭据是第一个Fleet Patching和Provisioning Server的登录凭据。</p>
                           </div>
                        </li>
                     </ol>
                     <div class="section">将Fleet Patching和Provisioning Server注册为对等方后，以下命令将显示服务器的对等方（或对等方）：<pre class="pre codeblock"><code>$ rhpctl查询peerserver</code></pre><div class="p">您可以检查对等Fleet Patching和Provisioning Server上的映像，如下所示：<pre class="pre codeblock"><code>$ rhpctl查询图像-server <span class="variable" translate="no">server_cluster_name</span></code></pre></div>
                        <p>上述命令显示特定对等Fleet Patching和Provisioning Server上的所有映像。此外，您可以指定对等服务器以及<code class="codeph">-image <span class="variable" translate="no">image_name</span></code>参数，以显示特定对等服务器上特定映像的详细信息。
                        </p>
                        <p>Fleet Patching和Provisioning Server可以有多个对等体。但是，Oracle不支持对等体之间的链接关系，例如，如果<code class="codeph">RHPS_1</code>是<code class="codeph">RHPS_1</code>的对等<code class="codeph">RHPS_2</code> ，并且<code class="codeph">RHPS_2</code>也是<code class="codeph">RHPS_2</code>的对等<code class="codeph">RHPS_3</code> ，则<code class="codeph">RHPS_1</code>和<code class="codeph">RHPS_3</code>之间不建立或暗示关系，尽管如果您可以使它们成为对等体，你要。
                        </p>
                        <div class="p">从对等Fleet Patching和Provisioning Server检索黄金映像的副本，如下所示：<pre class="pre codeblock"><code>$ rhpctl instantiate image -server <span class="variable" translate="no">server_cluster_name</span></code></pre></div>
                        <div class="p">运行<code class="codeph">rhpctl instantiate image</code>命令可激活自动更新机制。从那时起，当您在对等Fleet Patching和Provisioning Server（例如<code class="codeph">RHPS_2</code> ）上创建黄金映像时，它们可以自动复制到执行实例化操作的Fleet Patching and Provisioning Server（例如<code class="codeph">RHPS_1</code> ）。是否自动复制新的黄金映像取决于该映像与您可能包含在命令中的任何实例化参数的相关性：<ul style="list-style-type:disc">
                              <li>
                                 <p><code class="codeph">-all</code> ：为在<code class="codeph">RHPS_2</code>到<code class="codeph">RHPS_1</code>上创建的所有黄金映像创建自动推送</p>
                              </li>
                              <li>
                                 <p><code class="codeph">-image <span class="variable" translate="no">image_name</span></code> ：为<code class="codeph">RHPS_2</code>到<code class="codeph">RHPS_1</code>上创建的命名图像的所有新后代黄金图像创建自动推送。命名图像的后代是使用<code class="codeph">rhpctl add image</code>命令在<code class="codeph">RHPS_2</code>上创建的<code class="codeph">rhpctl add image</code> 。
                                 </p>
                              </li>
                              <li>
                                 <p><code class="codeph">-series <span class="variable" translate="no">series_name</span></code> ：为<code class="codeph">RHPS_2</code>到<code class="codeph">RHPS_1</code>上添加到指定系列的所有黄金图像创建自动推送</p>
                              </li>
                              <li>
                                 <p><code class="codeph">-imagetype <span class="variable" translate="no">image_type</span></code> ：为在<code class="codeph">RHPS_2</code>到<code class="codeph">RHPS_1</code>上的指定图像类型创建的所有黄金图像创建自动推送</p>
                              </li>
                           </ul>
                        </div>
                        <p>要停止接收由<code class="codeph">rhpctl instantiate image</code>命令建立的更新，请运行<code class="codeph">rhpctl uninstantiate image</code>并指定对等Fleet Patching和Provisioning Server以及以下之一：all，image name，image series name或image type。
                        </p>
                        <div class="p">在任何一个Fleet Patching和Provisioning Server上结束对等关系，如下所示：<pre class="pre codeblock"><code>$ rhpctl取消注册服务器-server <span class="variable" translate="no">server_cluster_name</span></code></pre></div>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-0363908C-9003-4674-A361-72430E8A2487" title="将数据从存储库导出到Fleet Patching和Provisioning Server数据文件。">rhpctl导出服务器</a></li>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-E004E59B-1388-4DBE-97DF-865AEBAC75D8" title="将特定的Fleet Patching和Provisioning Server注册为对等服务器。">rhpctl注册服务器</a></li>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-48AE57CE-5946-4D84-966B-2FDEF74D07A6" title="显示已注册的对等Fleet Patching和Provisioning Server的信息。">rhpctl查询peererver</a></li>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-8365ABC0-B4E6-45BE-9616-8956E3E32CDD" title="显示现有图像的配置。">rhpctl查询图片</a></li>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-8F63A46A-2580-444D-A8BE-1B06D2147323" title="从同级Fleet Patching和Provisioning Server请求黄金映像的副本。">rhpctl实例化图像</a></li>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-F91D87BD-3141-404A-BFB2-E8B5042C1779" title="停止来自对等Fleet Patching和Provisioning Server的先前请求的图像的更新。">rhpctl uninstantiate image</a></li>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-401A62BB-587F-45BF-9218-1174C1AF5834" title="取消注册特定的Fleet Patching和Provisioning Server作为对等服务器。">rhpctl取消注册服务器</a></li>
                        </ul>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-A12679AF-D30B-4E96-94AF-ED2AA703F428" name="GUID-A12679AF-D30B-4E96-94AF-ED2AA703F428"></a><h4 id="CWADD-GUID-A12679AF-D30B-4E96-94AF-ED2AA703F428" class="sect4">Fleet Patching和Provisioning Server审计</h4>
                  <div>
                     <p>Fleet Patching和Provisioning Server记录所有Fleet Patching和Provisioning操作的执行情况，并记录这些操作是成功还是失败。</p>
                     <div class="section">
                        <p>审计机制使管理员能够以各种维度查询审计日志，并管理其内容和大小。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-80D9C9A4-12EF-4D3C-8750-DCF3A4933C2E" name="GUID-80D9C9A4-12EF-4D3C-8750-DCF3A4933C2E"></a><h4 id="CWADD-GUID-80D9C9A4-12EF-4D3C-8750-DCF3A4933C2E" class="sect4">车队修补和供应通知</h4>
                  <div>
                     <p>Fleet Patching和Provisioning Server是数据中心可用软件家庭的中央存储库。因此，整个数据中心的管理员必须了解可能影响其责任范围的清单变更。</p>
                     <div class="section">
                        <p>您可以创建图像系列事件的订阅。Fleet Patching and Provisioning通过电子邮件通知订阅的角色或用户数量，以便对系列中可用的图像进行任何更改，包括添加或删除图像。每个系列可能有一组唯一的订户。</p>
                        <p>此外，当向目标添加或删除黄金图像的工作副本时，可以通过电子邮件通知工作副本的所有者和任何其他用户。如果要为其他Fleet Patching和Provisioning事件启用通知，可以按照下一节中的说明创建用户定义的操作。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="CWADD92589"></a><div class="props_rev_3"><a id="GUID-33FC643F-0A2C-4EFF-A13A-D3054D945119" name="GUID-33FC643F-0A2C-4EFF-A13A-D3054D945119"></a><h3 id="CWADD-GUID-33FC643F-0A2C-4EFF-A13A-D3054D945119" class="sect3">车队补丁和供应实施</h3>
               <div>
                  <p>实施Fleet Patching和Provisioning涉及创建Fleet Patching和Provisioning Server，将黄金映像添加到服务器，以及创建黄金映像的工作副本以供应软件。</p>
                  <p>安装和配置Oracle Clusterware后，您可以配置并开始使用Fleet Patching和Provisioning。您必须创建一个Fleet Patching和Provisioning Server，您可以在其中创建和存储数据库和其他软件家庭的黄金映像。</p>
               </div><a id="CWADD92648"></a><div class="props_rev_3"><a id="GUID-50B4A759-EE58-47AF-9B50-84572A58606A" name="GUID-50B4A759-EE58-47AF-9B50-84572A58606A"></a><h4 id="CWADD-GUID-50B4A759-EE58-47AF-9B50-84572A58606A" class="sect4">创建Fleet Patching和Provisioning Server</h4>
                  <div>
                     <p>Fleet Patching和Provisioning Server使用您在Oracle ACFS文件系统中创建的存储库，您可以在其中存储要为客户端和目标提供的所有软件主目录。</p>
                     <div class="section">
                        <p>要创建Fleet Patching和Provisioning Server：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>使用Oracle ASM配置助手（ASMCA）在Fleet Patching and Provisioning Server上创建Oracle ASM磁盘组以存储软件，如下所示：</span><div><pre class="pre codeblock"><code>$ <span class="variable" translate="no">Grid_home</span> / bin / asmca</code></pre><p>由于此磁盘组用于存储软件，因此Oracle建议此磁盘组至少为50 GB。</p>
                              <div class="infoboxnote" id="GUID-50B4A759-EE58-47AF-9B50-84572A58606A__GUID-9549C3DB-B206-4219-840D-065F282FC846">
                                 <p class="notep1">注意：</p>
                                 <p>您必须将此磁盘组的Oracle ASM Dynamic Volume Manager（Oracle ADVM）兼容性设置设置为<code class="codeph">12.1</code> 。
                                 </p>
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>提供存在于群集的所有节点上的装载路径。Fleet Patching和Provisioning Server使用此路径来安装黄金映像。</span><div><pre class="pre codeblock"><code>$ mkdir -p <span class="variable" translate="no">storage_path</span> / images</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>以<code class="codeph">root</code>身份创建Fleet Patching和Provisioning Server资源，如下所示：</span><div><pre class="pre codeblock"><code><span class="variable" translate="no">Grid_home</span> / bin / srvctl add rhpserver -storage <span class="variable" translate="no">storage_path</span> -diskgroup <span class="variable" translate="no">disk_group_name</span></code></pre></div>
                        </li>
                        <li class="stepexpand"><span>启动Fleet Patching和Provisioning Server，如下所示：</span><div><pre class="pre codeblock"><code>$ <span class="variable" translate="no">Grid_home</span> / bin / srvctl启动rhpserver</code></pre></div>
                        </li>
                     </ol>
                     <div class="section">
                        <p>启动Fleet Patching and Provisioning Server后，使用Fleet Patching and Provisioning Control（RHPCTL）实用程序进一步管理Fleet Patching和Provisioning。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="../ostmg/diskgroup-compatibility.html#OSTMG-GUID-FBB5AA72-5208-48E1-BD8D-0FD4C6876F34" target="_blank"><span><cite>Oracle自动存储管理管理员指南</cite></span></a></li>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-66345667-F035-4ADB-A25F-5530299E04B7" title="使用Fleet Patching and Provisioning Control（RHPCTL）实用程序来管理群集中的Fleet Patching和Provisioning。">Fleet Patching and Provisioning Control（RHPCTL）命令参考</a></li>
                           <li><a href="server-control-command-reference.html#GUID-1DCA9E3F-B929-4555-B673-921FF3588AC3" title="使用服务器控件（SRVCTL）实用程序来管理群集中的各种组件和应用程序。">服务器控制（SRVCTL）命令参考</a></li>
                        </ul>
                     </div>
                  </div>
               </div><a id="CWADD92649"></a><div class="props_rev_3"><a id="GUID-58793EAD-3C8B-4C3F-A5CB-680BD5693A14" name="GUID-58793EAD-3C8B-4C3F-A5CB-680BD5693A14"></a><h4 id="CWADD-GUID-58793EAD-3C8B-4C3F-A5CB-680BD5693A14" class="sect4">将黄金映像添加到Fleet Patching和Provisioning Server</h4>
                  <div>
                     <p>使用RHPCTL添加黄金映像以便以后配置软件。</p>
                     <div class="section">
                        <p>Fleet Patching和Provisioning Server存储并提供软件家庭的黄金映像。必须在Fleet Patching and Provisioning Server上实例化这些映像。</p>
                        <div class="infoboxnote" id="GUID-58793EAD-3C8B-4C3F-A5CB-680BD5693A14__GUID-B9C7EF26-38E3-4A25-9163-839FC055AB01">
                           <p class="notep1">注意：</p>
                           <p>图像是只读的，您无法从它们运行程序。要从图像创建可用的软件主页，您必须创建黄金图像的工作副本。您无法直接将图像用作软件之家。但是，您可以使用图像创建工作副本（软件家庭）。</p>
                        </div>
                        <p>您可以使用以下任一方法将软件导入Fleet Patching和Provisioning Server：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p>您可以使用以下命令从Fleet Patching and Provisioning Server上的已安装主目录导入映像：</p><pre class="pre codeblock"><code>rhpctl import image -image <span class="variable" translate="no">image_name</span> -path <span class="variable" translate="no">path_to_installed_home</span> [-imagetype ORACLEDBSOFTWARE | ORACLEGISOFTWARE | ORACLEGGSOFTWARE |软件]</code></pre></li>
                           <li>
                              <p>您可以使用从Fleet Patching and Provisioning Client运行的以下命令从Fleet Patching and Provisioning Client中的已安装主目录导入映像：</p><pre class="pre codeblock"><code>rhpctl import image -image <span class="variable" translate="no">image_name</span> -path <span class="variable" translate="no">path_to_installed_home</span>
</code></pre></li>
                           <li>
                              <p>您可以使用以下命令从现有工作副本创建映像：</p><pre class="pre codeblock"><code>rhpctl add image -image <span class="variable" translate="no">image_name</span> -workingcopy <span class="variable" translate="no">working_copy_name</span>
</code></pre></li>
                        </ul>
                        <p>使用前面列表中的前两个命令为图像存储库设定种子，并随时间添加其他图像。使用Fleet Patching and Provisioning Server上的第三个命令作为工作流程的一部分，以创建包含应用于预先存在的黄金映像的补丁的黄金映像。</p>
                        <p>前面三个命令还在Fleet Patching and Provisioning根目录中创建Oracle ACFS文件系统，类似于以下内容：</p><pre class="pre codeblock"><code>/ U01 / RHP /图片/图像/ RDBMS_121020617524</code></pre></div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="rapid-home-provisioning.html#GUID-CD92C0DB-D5E2-427A-8784-94F4C140B279" title="要修补Oracle数据库，可以将数据库迁移到新的主目录，其中包括要实现的修补程序。">修补Oracle数据库软件</a></li>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-BB5B4501-E270-482A-ADEF-B3D487A9055E" title="本节介绍RHPCTL命令的使用信息，列出并描述RHPCTL命令。">RHPCTL命令参考</a></li>
                        </ul>
                     </div>
                  </div>
                  <div class="props_rev_3"><a id="GUID-7D5E221B-4F74-4ECE-ADD1-6F060D6D7A7C" name="GUID-7D5E221B-4F74-4ECE-ADD1-6F060D6D7A7C"></a><h5 id="CWADD-GUID-7D5E221B-4F74-4ECE-ADD1-6F060D6D7A7C" class="sect5">图像状态</h5>
                     <div>
                        <p>你可以设置<a id="d25134e3485" class="indexterm-anchor"></a>图像的状态为<code class="codeph">TESTABLE</code>或<code class="codeph">RESTRICTED</code>以便只有具有GH_IMG_TESTABLE或GH_IMG_RESTRICT角色的用户才能从此图像配置工作副本。图像经过测试或验证后，您可以通过运行<code class="codeph">rhpctl promote image -image</code> <span class="italic"><code class="codeph">image_name</code></span> <code class="codeph">-state PUBLISHED</code>命令来更改状态并使图像可供一般使用。添加新的黄金图像时，默认图像状态为<code class="codeph">PUBLISHED</code> ，但您可以选择使用<code class="codeph">rhpctl add image</code>和<code class="codeph">rhpctl import image</code>命令指定不同的状态。
                        </p>
                     </div>
                  </div>
                  <div class="props_rev_3"><a id="GUID-1FE5E4A1-3920-467C-B2DD-749F436D35E6" name="GUID-1FE5E4A1-3920-467C-B2DD-749F436D35E6"></a><h5 id="CWADD-GUID-1FE5E4A1-3920-467C-B2DD-749F436D35E6" class="sect5">图像系列</h5>
                     <div>
                        <p>图像系列是将不同的黄金图像分组为逻辑序列的便捷方式。</p>
                        <p>Fleet Patching and Provisioning将每个图像视为与其他图像相关的独立实体。图像之间没有任何关系，即使它们遵循某些特定的命名法。图像管理员可以选择以对用户社区有意义的逻辑方式命名图像，但这不会在Fleet Patching and Provisioning框架内创建任何管理分组。</p>
                        <p>使用<code class="codeph">rhpctl add series</code>命令创建图像系列并将一个或多个图像关联到此系列。图像系列中的图像列表是有序列表。使用<code class="codeph">rhpctl insertimage series</code>和<code class="codeph">rhpctl deleteimage series</code>添加和删除图像系列中的图像。您还可以使用这些命令更改系列中图像的顺序。
                        </p>
                        <p><code class="codeph">insertimage</code>和<code class="codeph">deleteimage</code>命令不会实例化或删除实际的黄金映像，只会更改列表。此外，图像可以属于多个系列（或根本不属于任何系列）。
                        </p>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-E3AF7DAC-8612-445B-9368-60A30C1DA474" name="GUID-E3AF7DAC-8612-445B-9368-60A30C1DA474"></a><h5 id="CWADD-GUID-E3AF7DAC-8612-445B-9368-60A30C1DA474" class="sect5">图像类型</h5>
                     <div>
                        <p>添加或导入黄金图像时，必须指定图像类型。</p>
                        <div class="p">Oracle Clusterware提供以下内置基本映像类型：<ul class="simple" style="list-style-type:none;padding-left:0">
                              <li>ORACLEDBSOFTWARE</li>
                              <li>ORACLEGISOFTWARE</li>
                              <li>ORACLEGGSOFTWARE</li>
                              <li>软件</li>
                           </ul>
                        </div>
                        <p>每个黄金图像都必须具有图像类型，您可以创建自己的图像类型。新图像类型必须基于其中一种内置类型。映像类型指示Fleet Patching和Provisioning应用其管理Oracle Grid Infrastructure和Oracle Database Homes的功能。Fleet Patching和Provisioning还使用图像类型来组织自定义工作流支持框架。</p>
                        <div class="section">
                           <p class="subhead3" id="GUID-E3AF7DAC-8612-445B-9368-60A30C1DA474__GUID-ABC7FC26-98B7-4FD4-9223-9EA6EC3100E4">创建自定义图像类型</p>
                           <p>使用<code class="codeph">rhpctl add imagetype</code>命令创建自定义图像类型。
                           </p>
                           <p>例如，要创建一个名为DBTEST的图像类型，它基于ORACLEDBSOFTWARE图像类型：</p><pre class="pre codeblock"><code>$ rhpctl add imagetype -imagetype DBTEST -basetype ORACLEDBSOFTWARE</code></pre><div class="infoboxnote" id="GUID-E3AF7DAC-8612-445B-9368-60A30C1DA474__GUID-4C069D6E-91A9-4425-A9EE-C92DA864AB6C">
                              <p class="notep1">注意：</p>创建基于现有图像类型的图像类型时，新图像类型不会从基本类型继承任何用户操作（用于自定义工作流支持）。
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div><a id="CWADD93063"></a><div class="props_rev_3"><a id="GUID-FE6E954E-89D7-4AE3-9B9B-A26B787ECBAE" name="GUID-FE6E954E-89D7-4AE3-9B9B-A26B787ECBAE"></a><h4 id="CWADD-GUID-FE6E954E-89D7-4AE3-9B9B-A26B787ECBAE" class="sect4">提供黄金图像的副本</h4>
                  <div>
                     <p>使用RHPCTL将黄金映像的副本提供给Fleet Patching和Provisioning Server，Clients和targets。</p>
                     <div class="section">
                        <p>创建和导入黄金映像后，您可以通过在Fleet Patching and Provisioning Server，Fleet Patching and Provisioning Client或目标上添加黄金映像（称为工作副本）的副本来配置软件。您可以在服务器或客户端上运行软件配置命令。</p>
                     </div>
                     <!-- class="section" -->
                     <ul>
                        <li class="stepexpand"><span>要在Fleet Patching and Provisioning Server上创建工作副本，请执行以下操作：</span><div><pre class="pre codeblock"><code>$ rhpctl add workingcopy -workingcopy <span class="variable" translate="no">working_copy_name</span> -image <span class="variable" translate="no">image_name</span>
</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>要在Fleet Patching and Provisioning Client上的本地文件系统中创建工作副本，请执行以下操作：</span><div><pre class="pre codeblock"><code>$ rhpctl add workingcopy -workingcopy <span class="variable" translate="no">working_copy_name</span> -image <span class="variable" translate="no">image_name</span> -storagetype LOCAL -path <span class="variable" translate="no">path_to_software_home</span></code></pre></div>
                        </li>
                        <li class="stepexpand"><span>要从Fleet Patching and Provisioning Server在Fleet Patching and Provisioning Client上创建工作副本，请执行以下操作：</span><div><pre class="pre codeblock"><code>$ rhpctl add workingcopy -workingcopy <span class="variable" translate="no">working_copy_name</span> -image <span class="variable" translate="no">image_name</span> -client <span class="variable" translate="no">client_cluster_name</span></code></pre></div>
                        </li>
                     </ul>
                     <div class="section">
                        <div class="infoboxnote" id="GUID-FE6E954E-89D7-4AE3-9B9B-A26B787ECBAE__GUID-9286594C-2C93-4D9D-BF55-96B9B0431749">
                           <p class="notep1">注意：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>您在<code class="codeph">-path</code>参数中指定的目录必须为空。
                                 </p>
                              </li>
                              <li>
                                 <p>如果由于系统或用户错误导致中断或故障，您可以重新运行配置命令。修复报告的错误后，重新运行该命令，它将从故障点恢复。</p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="rapid-home-provisioning.html#GUID-94758068-0E75-40E1-BCAC-EFF25CBB76F1" title="选择三个存储选项之一，其中Fleet Patching和Provisioning存储黄金图像的工作副本。">供应软件的存储选项</a></li>
                        </ul>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-F343ADA0-D2B1-4451-AF2B-3E069FE15279" name="GUID-F343ADA0-D2B1-4451-AF2B-3E069FE15279"></a><h5 id="CWADD-GUID-F343ADA0-D2B1-4451-AF2B-3E069FE15279" class="sect5">车队补丁和配置中的用户组管理</h5>
                     <div>
                        <p>当您在移动或升级操作中创建黄金映像的工作副本时，Fleet Patching and Provisioning会将新工作副本中的操作系统组配置为与源软件主目录中的操作系统组匹配（来自非托管或托管主目录）你移动或升级）。</p>
                        <p>创建SOFTWARE图像类型的黄金映像时，源中的任何用户组都不会被继承，并且此类型的图像永远不会包含用户组信息。使用<code class="codeph">rhpctl add workingcopy</code>命令从SOFTWARE黄金映像配置工作副本时，您可以选择使用<code class="codeph">-groups</code>参数在工作副本中配置用户组。
                        </p>
                        <p><code class="codeph">rhpctl move database</code> ， <code class="codeph">rhpctl move gihome</code> ， <code class="codeph">rhpctl upgrade database</code>和<code class="codeph">rhpctl upgrade gihome</code>命令都要求您指定源主目录（使用Fleet Patching and Provisioning设置的非托管主目录或托管主目录（工作副本）），以及目的地家庭（必须是工作副本）。
                        </p>
                        <p>使用<code class="codeph">rhpctl add workingcopy</code>命令设置目标主<code class="codeph">rhpctl add workingcopy</code> ，在执行移动或升级操作之前，必须确保源主目录中配置的组与目标主目录中的组匹配。Fleet Patching和Provisioning将组配置为添加操作的一部分。
                        </p>
                        <p>当您从源软件主目录（使用<code class="codeph">rhpctl import image</code>命令）或从工作副本（使用<code class="codeph">rhpctl add image</code>命令）创建ORACLEGISOFTWARE或ORACLEDBSOFTWARE图像类型的黄金映像时，黄金映像将继承Oracle用户组在源中配置的。您无法覆盖此功能。
                        </p>
                        <p>您可以使用<code class="codeph">rhpctl add workingcopy</code>命令为ORACLEGISOFTWARE和ORACLEDBSOFTWARE工作副本定义用户组，具体取决于映像类型和用户组，如后续章节中所述。
                        </p>
                        <p>本节描述舰队修补和供应如何管理用户组的配置，以及如何<code class="codeph">-groups</code>的命令行选项<code class="codeph">rhpctl add workingcopy</code>功能。
                        </p>
                        <div class="section">
                           <p class="subhead3" id="GUID-F343ADA0-D2B1-4451-AF2B-3E069FE15279__GUID-E2B7AB57-0580-44EB-8384-140D4B79755F">ORACLEGISOFTWARE（Oracle网格基础架构<span class="italic">11克</span> 2版（11.2），和<span class="italic">12c</span>释放1（12.1）和版本2（12.2））</p>
                           <p>在配置黄金映像的Oracle Grid Infrastructure工作副本时，根据配置类型（无论是常规配置还是仅软件，带或不带<code class="codeph">-local</code>参数）在工作副本中设置组，以及是否指定在<code class="codeph">-groups</code>与参数<code class="codeph">rhpctl add workingcopy</code> 。您可以使用<code class="codeph">-softwareonly</code>命令参数或使用带有<code class="codeph">rhpctl add workingcopy</code>命令的响应文件在Oracle Grid Infrastructure软件中定义OSDBA和OSASM用户组。
                           </p>
                           <p>如果使用<code class="codeph">-softwareonly</code>命令参数仅供应Oracle Grid Infrastructure软件，则不能使用<code class="codeph">-groups</code>参数，并且Fleet Patching and Provisioning从活动的Grid主目录获取OSDBA和OSASM用户组信息。
                           </p>
                           <p>如果使用<code class="codeph">-local</code>命令参数（仅在使用<code class="codeph">-softwareonly</code>命令参数时有效）和<code class="codeph">rhpctl add workingcopy</code> ，则Fleet Patching and Provisioning将从命令行获取组的值（使用<code class="codeph">-groups</code>参数）或使用Fleet Patching和Provisioning从黄金映像的<code class="codeph">osdbagrp</code>二进制文件中获取的默认值。
                           </p>
                           <p>如果上述条件均不适用，则Fleet Patching and Provisioning将使用安装程序默认用户组。</p>
                           <div class="p">如果使用响应文件中的信息配置和配置工作副本，则Fleet Patching and Provisioning：<ol>
                                 <li>
                                    <p>如果提供，则使用OSDBA或OSASM或两者的命令行中的用户组值。</p>
                                 </li>
                                 <li>
                                    <p>如果在命令行中未提供任何值，则Fleet Patching and Provisioning将检索响应文件中定义的用户组信息。</p>
                                 </li>
                              </ol>
                           </div>
                           <p>如果要定义OSOPER Oracle组，则可以再次使用<code class="codeph">-softwareonly</code>命令参数或使用带有<code class="codeph">rhpctl add workingcopy</code>命令的响应文件。
                           </p>
                           <p>如果使用<code class="codeph">-softwareonly</code>命令参数，则可以在命令行上提供值（使用<code class="codeph">-groups</code>参数）或保留用户组undefined。
                           </p>
                           <p>如果使用响应文件中的信息配置和配置黄金映像的工作副本，则可以在命令行上提供值，使用响应文件中包含的信息，或者保留OSOPER Oracle组的未定义。</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-F343ADA0-D2B1-4451-AF2B-3E069FE15279__GUID-4054A9F9-E51A-4B4F-9022-CF81029693AA">ORACLEDBSOFTWARE（Oracle Database 11 <span class="italic">g第</span> 2版（11.2）和12 <span class="italic">c第</span> 1版（12.1）和第2版（12.2））</p>
                           <p>如果您要置备Oracle数据库软件的工作副本，你要定义的Oracle组，然后用<code class="codeph">-groups</code>用命令参数<code class="codeph">rhpctl add workingcopy</code>命令。各种Oracle数据库版本中提供的Oracle组如下：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>Oracle Database <span class="italic">11g第</span> 2版（11.2）</p>
                                 <ul class="simple" style="list-style-type:none;padding-left:0">
                                    <li>OSDBA</li>
                                    <li>OSOPER</li>
                                 </ul>
                              </li>
                              <li>
                                 <p>Oracle Database 12 <span class="italic">c第</span> 1版（12.1）</p>
                                 <ul class="simple" style="list-style-type:none;padding-left:0">
                                    <li>OSDBA</li>
                                    <li>OSOPER</li>
                                    <li>OSBACKUP</li>
                                    <li>OSDG</li>
                                    <li>OSKM</li>
                                 </ul>
                              </li>
                              <li>
                                 <p>Oracle Database 12 <span class="italic">c第</span> 2版（12.2）</p>
                                 <ul class="simple" style="list-style-type:none;padding-left:0">
                                    <li>OSDBA</li>
                                    <li>OSOPER</li>
                                    <li>OSBACKUP</li>
                                    <li>OSDG</li>
                                    <li>OSKM</li>
                                    <li>OSRAC</li>
                                 </ul>
                              </li>
                           </ul>
                           <p>无论您定义哪个前面的组（OSOPER除外），Fleet Patching and Provisioning都会从命令行获取组的值（使用<code class="codeph">-groups</code>参数）或使用Fleet Patching和Provisioning从中获取的默认值黄金图像的<code class="codeph">osdbagrp</code>二进制文件。
                           </p>
                           <p>如果从<code class="codeph">osdbagrp</code>二进制文件中拾取的任何组不在数据库用户所属的组列表中（由<code class="codeph">id</code>命令给出），则Fleet Patching and Provisioning将使用安装程序默认用户组。否则，数据库用户是运行<code class="codeph">rhpctl add workingcopy</code>命令的用户。
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="CWADD93064"></a><div class="props_rev_3"><a id="GUID-94758068-0E75-40E1-BCAC-EFF25CBB76F1" name="GUID-94758068-0E75-40E1-BCAC-EFF25CBB76F1"></a><h5 id="CWADD-GUID-94758068-0E75-40E1-BCAC-EFF25CBB76F1" class="sect5">供应软件的存储选项</h5>
                     <div>
                        <p>选择三个存储选项之一，其中Fleet Patching和Provisioning存储黄金图像的工作副本。</p>
                        <p>使用<code class="codeph">rhpctl add workingcopy</code>命令配置软件时，您可以从三个存储选项中进行选择，其中Fleet Patching和Provisioning放置该软件：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>在由Fleet Patching and Provisioning管理的Oracle ACFS共享文件系统中（仅适用于数据库主目录）</p>
                           </li>
                           <li>
                              <p>在不由Fleet Patching and Provisioning管理的本地文件系统中</p>
                           </li>
                        </ul>
                        <p>使用<code class="codeph">rhpctl add workingcopy</code>与命令<code class="codeph">–storagetype</code>和<code class="codeph">–path</code>参数，您可以选择您存储供应工作拷贝。参数的适用性取决于您为其配置工作副本的节点（或多个节点）是Fleet Patching and Provisioning Server，Fleet Patching and Provisioning Client还是非Fleet Patching and Provisioning客户端。您可以从<code class="codeph">–stroragetype</code>参数的以下值中进行选择：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">RHP_MANAGED</code> ：选择此值（可用于Fleet Patching和Provisioning Server以及Fleet Patching和Provisioning Clients），将工作副本存储在Oracle ACFS共享文件系统中。<code class="codeph">–path</code>参数不与此选项一起使用，因为Fleet Patching和Provisioning管理存储选项。
                              </p>
                              <div class="infoboxnote" id="GUID-94758068-0E75-40E1-BCAC-EFF25CBB76F1__GUID-E13E3FE5-B983-4191-A717-370F849A5391">
                                 <p class="notep1">笔记：</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p>您无法在<code class="codeph">RHP_MANAGED</code>存储中存储Oracle Grid Infrastructure <code class="codeph">RHP_MANAGED</code> 。
                                       </p>
                                    </li>
                                    <li>
                                       <p>Oracle建议使用<code class="codeph">RHP_MANAGED</code>存储类型，该类型可在Fleet Patching和Provisioning Server以及配置有Oracle ASM磁盘组的客户端上使用。
                                       </p>
                                    </li>
                                    <li>
                                       <p>如果在Fleet Patching和Provisioning Server上配置工作副本，则不需要指定<code class="codeph">-storagetype</code>选项，因为它将默认为<code class="codeph">RHP_MANAGED</code> 。</p>
                                    </li>
                                    <li>
                                       <p>如果选择在Fleet Patching and Provisioning Client上配置工作副本，并且未指定<code class="codeph">-path</code>参数，则仅当客户端上存在Oracle ASM磁盘组时，存储类型默认为<code class="codeph">RHP_MANAGED</code> 。否则命令将失败。如果在客户端上为<code class="codeph">-path</code>参数指定了一个位置，则存储类型默认为<code class="codeph">LOCAL</code>包含或不包含Oracle ASM磁盘组。
                                       </p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li>
                              <p><code class="codeph">LOCAL</code> ：选择此值可将工作副本存储在不由Fleet Patching and Provisioning管理的本地文件系统中。您必须在Fleet Patching and Provisioning Server，Fleet Patching and Provisioning Client，非Fleet Patching and Provisioning客户端或Fleet Patching and Provisioning Client上的Oracle ASM磁盘组中指定文件系统的路径。
                              </p>
                           </li>
                        </ul>
                        <p>如果指定<code class="codeph">–path</code>参数，如果文件系统在群集中的所有节点之间共享，则会在此共享存储上创建工作副本。如果未共享文件系统，则会在群集中每个节点上的给定路径的位置创建工作副本。
                        </p>
                        <div class="infoboxnote" id="GUID-94758068-0E75-40E1-BCAC-EFF25CBB76F1__GUID-095CD677-DCCD-441C-AC1B-9E70E7767F49">
                           <p class="notep1">注意：</p>您在<code class="codeph">-path</code>参数中指定的目录必须为空。
                        </div>
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>相关话题</strong></p>
                           <ul>
                              <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-61929F3C-A50A-45EA-8B4A-D11E245A6493" title="在客户端群集上创建工作副本。">rhpctl添加workingcopy</a></li>
                           </ul>
                        </div>
                     </div>
                  </div><a id="CWADD93065"></a><div class="props_rev_3"><a id="GUID-40F14729-5687-404E-8F89-83144E4673CF" name="GUID-40F14729-5687-404E-8F89-83144E4673CF"></a><h5 id="CWADD-GUID-40F14729-5687-404E-8F89-83144E4673CF" class="sect5">为不同的用户供应</h5>
                     <div>
                        <p>如果您希望其他用户配置除运行该命令的用户以外的软件，请使用<code class="codeph">rhpctl add workingcopy</code>命令的<code class="codeph">-user</code>参数。
                        </p>
                        <div class="section">
                           <p>配置完成后，配置软件的所有文件和目录都由您指定的用户拥有。远程配置软件上的文件权限与配置应用程序软件的黄金映像上存在的权限相同。</p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-5DDE9952-9D6E-4DD7-99C1-245081954645" name="GUID-5DDE9952-9D6E-4DD7-99C1-245081954645"></a><h4 id="CWADD-GUID-5DDE9952-9D6E-4DD7-99C1-245081954645" class="sect4">在Fleet Patching和Provisioning Servers之间传播图像</h4>
                  <div>
                     <p>通过自动图像传播，您可以跨不同的对等Fleet Patching和Provisioning Server设置软件映像的自动副本。您在一个站点注册的黄金映像将复制到对等的Fleet Patching和Provisioning Server。</p>
                     <div class="section">在两个Fleet Patching和Provisioning Server之间的对等关系中，一个服务器是软件映像的源，另一个是软件映像的目标。</div>
                     <!-- class="section" -->
                     <div class="section">在服务器之间复制软件映像的标准可以基于某些策略，例如软件映像类型，映像系列或所有软件映像。注册符合软件映像传播标准的映像时，此映像的副本将传播到所有已注册的对等服务器。</div>
                     <!-- class="section" -->
                     <div class="p">以下示例过程在两个Fleet Patching和Provisioning Server站点<code class="codeph">RHPS-A</code>和<code class="codeph">RHPS-B</code>之间建立关系，其中<code class="codeph">RHPS-A</code>是源， <code class="codeph">RHPS-B</code>是软件映像的目标。
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>在<code class="codeph">RHPS-B</code>上运行以下命令：</span><div><pre class="pre codeblock"><code>$ rhpctl export server -server RHPS-A -serverdata <span class="variable" translate="no">file_path</span></code></pre><p>上述命令在为<code class="codeph">-serverdata</code>参数指定的目录路径中创建名为<code>RHPS-B.xml</code>的文件。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>运行以下命令将对等服务器注册到当前的Fleet Patching和Provisioning Server：</span><div><pre class="pre codeblock"><code>$ rhpctl注册服务器-server RHPS-B -serverdata /tmp/RHPS-B.xml</code></pre><p>上述命令将在上一步中创建的<code>RHPS-B.xml</code>文件复制到运行该命令的服务器上的某个位置，在本例中为<code>/tmp/RHPS-B.xml</code> 。
                              </p>
                              <p>运行上述命令的群集是源站点，您在命令行上指定的服务器是复制软件映像的目标站点。</p>
                              <p><code class="codeph">rhpctl unregister server</code>命令用来删除对等关系。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>运行下面的命令<code class="codeph">RHPS-B</code>从软件传播图像<code class="codeph">RHPS-A</code>到<code class="codeph">RHPS-B</code></span><div><pre class="pre codeblock"><code>$ rhpctl实例化image -server RHPS-A -all</code></pre><div class="p">上述命令将所有映像从<code class="codeph">RHPS-A</code>传播到<code class="codeph">RHPS-B</code> 。如果<code class="codeph">RHPS-B</code>上已存在图像，则不会再次传播。
                                 <div class="infoboxnote" id="GUID-5DDE9952-9D6E-4DD7-99C1-245081954645__GUID-CC55A4A0-8CEA-4628-B5D0-A1C674435216">
                                    <p class="notep1">注意：</p>图像的传播基于图像名称。RHPCTL不会比较图像本身的内容，以确定它们是否不同。如果要传播的图像具有非唯一名称，则RHPCTL会假定图像相同且不传播图像。
                                 </div>
                              </div>
                              <p>使用<code class="codeph">rhpctl uninstantiate image</code>命令取消特定图像的传播。任何正在进行的传播都不受此命令的影响，并将继续直到完成。<code class="codeph">-all</code>参数删除<code class="codeph">-imagetype</code>和<code class="codeph">-series</code>参数的所有值。
                              </p>
                           </div>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-0363908C-9003-4674-A361-72430E8A2487" title="将数据从存储库导出到Fleet Patching和Provisioning Server数据文件。">rhpctl导出服务器</a></li>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-E004E59B-1388-4DBE-97DF-865AEBAC75D8" title="将特定的Fleet Patching和Provisioning Server注册为对等服务器。">rhpctl注册服务器</a></li>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-401A62BB-587F-45BF-9218-1174C1AF5834" title="取消注册特定的Fleet Patching和Provisioning Server作为对等服务器。">rhpctl取消注册服务器</a></li>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-8F63A46A-2580-444D-A8BE-1B06D2147323" title="从同级Fleet Patching和Provisioning Server请求黄金映像的副本。">rhpctl实例化图像</a></li>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-F91D87BD-3141-404A-BFB2-E8B5042C1779" title="停止来自对等Fleet Patching和Provisioning Server的先前请求的图像的更新。">rhpctl uninstantiate image</a></li>
                        </ul>
                     </div>
                  </div>
                  
               </div>
            </div>
            <div class="sect2"><a id="GUID-F4F263A1-0580-4386-B929-5252A196632E" name="GUID-F4F263A1-0580-4386-B929-5252A196632E"></a><h3 id="CWADD-GUID-F4F263A1-0580-4386-B929-5252A196632E" class="sect3">Oracle Grid Infrastructure Management</h3>
               <div>
                  <p>Fleet Patching和Provisioning Server为将Oracle Grid Infrastructure家庭分发到目标和Fleet Patching和Provisioning Client提供了一个高效安全的平台。</p>
                  <p>此外，Fleet Patching和Provisioning Client能够从Fleet Patching和Provisioning Server获取Oracle Grid Infrastructure家庭。</p>
                  <p>Oracle Grid Infrastructure主页以黄金映像的工作副本的形式分发。配置完工作副本后，Fleet Patching and Provisioning可以选择配置Oracle Grid Infrastructure。这使Fleet Patching和Provisioning能够在最初未安装Oracle Grid Infrastructure的一个或多个节点上创建Oracle Grid Infrastructure安装。</p>
                  <p>Fleet Patching和Provisioning还具有管理Oracle Grid Infrastructure家庭的命令，例如切换到已打补丁的家庭或升级到新的Oracle Grid Infrastructure版本。这些都是单个命令，用于协调所涉及的众多步骤。回到原来的家就是这么简单。此外，Fleet Patching和Provisioning可以从Oracle Grid Infrastructure配置中添加或删除节点。</p>
               </div>
               <div class="sect3"><a id="GUID-31A09C7F-CC05-4343-8C1A-C99E33B7AFC7" name="GUID-31A09C7F-CC05-4343-8C1A-C99E33B7AFC7"></a><h4 id="CWADD-GUID-31A09C7F-CC05-4343-8C1A-C99E33B7AFC7" class="sect4">关于使用Fleet Patching and Provisioning（FPP）部署Oracle Grid Infrastructure</h4>
                  <div>
                     <p>Fleet Patching and Provisioning（FPP）是一种用于配置和维护Oracle主目录的软件生命周期管理方法。Fleet Patching和Provisioning支持大规模部署和维护数据库，集群和用户定义的软件类型的标准操作环境。</p>
                     <div class="infoboxnote" id="GUID-31A09C7F-CC05-4343-8C1A-C99E33B7AFC7__GUID-ED7E64BD-4196-494E-94EB-52079FFB7E7B">
                        <p class="notep1">注意：</p>从Oracle Grid Infrastructure 19c开始，以前称为Rapid Home Provisioning（RHP）的功能现在是Fleet Patching and Provisioning（FPP）。
                     </div>
                     <p>Fleet Patching和Provisioning使您可以安装集群，以及配置，修补，扩展和升级Oracle Grid Infrastructure，Oracle Restart和Oracle数据库主目录。支持的版本是11.2,12.1,12.2,18c和19c。您还可以使用Fleet Patching and Provisioning配置应用程序和中间件。</p>
                     <p>Fleet Patching和Provisioning是Oracle Grid Infrastructure中的一项服务，您可以使用以下任一模式：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>中央舰队补丁和配置服务器</p>
                           <p>Fleet Patching和Provisioning Server存储和管理标准化图像，称为黄金图像。黄金映像可以部署到数据中心的任意数量的节点。您可以在已部署的主目录上创建新的群集和数据库，并可以使用它们来修补，升级和扩展现有安装。</p>
                           <div class="p">Fleet Patching和Provisioning Server可以管理以下类型的安装：<ul style="list-style-type:disc">
                                 <li>
                                    <p>托管Fleet Patching和Provisioning Server本身的集群上的软件之家。</p>
                                 </li>
                                 <li>
                                    <p>运行Oracle Grid Infrastructure 12c第2版（12.2），18c和19c的Fleet Patching和Provisioning Client。</p>
                                 </li>
                                 <li>
                                    <p>运行Oracle Grid Infrastructure 11g第2版（11.2）和12c第1版（12.1）的安装。</p>
                                 </li>
                                 <li>
                                    <p>没有Oracle Grid Infrastructure的安装。</p>
                                 </li>
                              </ul>
                           </div>
                           <p>Fleet Patching和Provisioning Server可以配置新安装并可以管理现有安装，而无需对现有安装进行任何更改。Fleet Patching和Provisioning Server可以在对等服务器之间自动共享黄金映像，以支持具有地理位置分散的数据中心的企业。</p>
                        </li>
                        <li>
                           <p>Fleet Patching and Provisioning Client</p>
                           <p>可以从Fleet Patching和Provisioning Server管理Fleet Patching和Provisioning Client，也可以直接在客户端本身上执行命令。Fleet Patching and Provisioning Client是Oracle Grid Infrastructure中内置的服务，可在Oracle Grid Infrastructure 12c第2版（12.2）及更高版本中使用。Fleet Patching and Provisioning Client可以从Fleet Patching和Provisioning Server检索黄金映像，根据策略上传新映像，并将维护操作应用于自身。</p>
                        </li>
                     </ul>
                     <div class="section">
                        <p class="subhead3" id="GUID-31A09C7F-CC05-4343-8C1A-C99E33B7AFC7__GUID-E5549D9E-52B9-4C39-AC7B-54B3400D528A">舰队修补和供应</p>
                        <p>使用Fleet Patching and Provisioning部署Oracle软件具有以下优势：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>通过黄金映像和已部署软件的管理系列确保标准化并实现高度自动化。</p>
                           </li>
                           <li>
                              <p>通过将新住宅作为图像（称为黄金映像）部署在一起，最大限度地减少停机时间，而不会中断活动数据库或集群。</p>
                           </li>
                           <li>
                              <p>通过提供跨数据库版本和部署模型使用简单，一致的API调用的自动机来简化维护。</p>
                           </li>
                           <li>
                              <p>通过内置验证和“干运行”模式降低维护风险，以测试操作。</p>
                           </li>
                           <li>
                              <p>使您能够在出现无法预料的问题时恢复或重新启动命令，从而降低维护操作的风险。</p>
                           </li>
                           <li>
                              <p>最大限度地减少并经常消除修补和升级的影响，其功能包括：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>零停机数据库升级，全自动升级，完全在部署中执行，无需任何额外节点或外部存储。</p>
                                 </li>
                                 <li>
                                    <p>滚动修补期间数据库会话和OJVM的自适应管理。</p>
                                 </li>
                                 <li>
                                    <p>用于管理整合部署的选项。</p>
                                 </li>
                              </ul>
                           </li>
                           <li>
                              <p>部署和维护操作使自定义能够将特定于环境的操作包括在自动化工作流中。</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="rapid-home-provisioning.html#CWADD92402" target="_blank"><span><cite>“Oracle Clusterware管理和部署指南”</cite></span></a></li>
                        </ul>
                     </div>
                     <div class="infoboxnotealso" id="GUID-31A09C7F-CC05-4343-8C1A-C99E33B7AFC7__GUID-1E3F2B12-F069-4BE8-B24E-E003A62FA4EB">
                        <p class="notep1">也可以看看：</p> <span><cite>“Oracle Clusterware管理和部署指南”，</cite></span>以获取有关设置Fleet Patching和Provisioning Server和Client以及创建和使用黄金映像以供应和修补Oracle Grid Infrastructure和Oracle Database Homes的信息。
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-CD7FC0E1-31BD-45D3-A3D0-2DB788E4DB24" name="GUID-CD7FC0E1-31BD-45D3-A3D0-2DB788E4DB24"></a><h4 id="CWADD-GUID-CD7FC0E1-31BD-45D3-A3D0-2DB788E4DB24" class="sect4">供应Oracle Grid Infrastructure软件</h4>
                  <div>
                     <p>Fleet Patching和Provisioning提供了多种方法来配置和（可选）配置Oracle Grid Infrastructure和Oracle Restart网格基础架构之家。</p>
                     <div class="section">Fleet Patching和Provisioning可以在一个或多个当前没有Grid home的节点上配置和配置Oracle Grid Infrastructure，然后配置Oracle Grid Infrastructure以形成单节点或多节点Oracle Grid Infrastructure安装。</div>
                     <!-- class="section" -->
                     <div class="section">使用<code class="codeph">rhpctl add workingcopy</code>命令安装和配置Oracle Grid Infrastructure，并启用简单且可重复的标准化部署创建。
                     </div>
                     <!-- class="section" -->
                     <div class="section">Fleet Patching和Provisioning Server还可以为当前运行Oracle Grid Infrastructure的节点或集群配置Oracle Grid Infrastructure主目录。当前运行的Grid home可以是Fleet Patching and Provisioning没有提供的房屋（ <span class="italic">非托管</span>房屋）或Fleet Patching and Provisioning提供的房屋（ <span class="italic">托管</span>房屋）。
                     </div>
                     <!-- class="section" -->
                     <div class="section">您还可以将Oracle Restart网格基础结构置备到群集中的节点。</div>
                     <!-- class="section" -->
                     <div class="section">在任何一种情况下，请使用<code class="codeph">rhpctl add workingcopy</code>命令的<code class="codeph">-softwareonly</code>参数。这条规定但不会激活新的Grid主页，因此当您准备切换到新主页时，您可以使用单个命令执行此操作。
                     </div>
                     <!-- class="section" -->
                     <ul>
                        <li class="stepexpand"><span>要通知Fleet Patching and Provisioning要安装Oracle Grid Infrastructure的节点，并配置Oracle Grid Infrastructure，请在响应文件中提供说明，如以下示例所示：</span><div><pre class="pre codeblock"><code>$ rhpctl add workingcopy -workingcopy GI_HOME_11204_WCPY -image GI_HOME_11204 -responsefile /u01/app/rhpinfo/GI_11204_install.txt { <span class="variable" translate="no">authentication_option</span> }</code></pre><div class="p">上述命令将<code class="codeph">GI_HOME_11204_WCPY</code>工作副本基于<code class="codeph">GI_HOME_11204</code>黄金映像配置到<code class="codeph">GI_11204_install.txt</code>响应文件中指定的目标。除了标识目标节点之外，响应文件还指定有关Oracle Grid Infrastructure配置的信息，例如Oracle ASM和GNS参数。
                                 <div class="infoboxnote" id="GUID-CD7FC0E1-31BD-45D3-A3D0-2DB788E4DB24__GUID-91F9102A-ED77-4C5A-8A85-5D5BF3A38093">
                                    <p class="notep1">注意：</p>无论您在响应文件中指定了什么，都会覆盖<code class="codeph">oracle.install.crs.rootconfig.executeRootScript= <span class="variable" translate="no">xxx</span></code>响应文件参数，并始终将其设置为<code class="codeph">false</code>以用于Fleet Patching和Provisioning。
                                 </div>
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>要将Oracle Grid Infrastructure主目录配置到当前运行Oracle Grid Infrastructure的节点或集群，请执行以下操作：</span><div><pre class="pre codeblock"><code>$ rhpctl add workingcopy -workingcopy GI_HOME_12201_PATCHED_WCPY -image GI_HOME_12201_PSU1 -client CLUST_002 -softwareonly</code></pre><p>上述命令规定基于上一个新的工作副本<code class="codeph">GI_HOME_12201_PSU1</code>金图像舰队修补和供应客户机（正在运行Oracle网格基础设施12 <span class="italic">c</span>释放2（12.2））命名<code class="codeph">CLUST_002</code> 。当您配置到未运行Oracle Grid Infrastructure 12c <span class="italic">第</span> 2版（12.2）的目标时（例如，运行Oracle Grid Infrastructure 12c <span class="italic">第</span> 1版（12.1）或Oracle Grid Infrastructure <span class="italic">11g第</span> 2版（11.2）的目标），使用<code class="codeph">-targetnode</code>参数而不是<code class="codeph">-client</code> 。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>指定要在其上配置Oracle Restart网格基础结构的目标节点，如下所示：</span><div><pre class="pre codeblock"><code>$ rhpctl add workingcopy -workingcopy SIHA_GI -image goldimage -targetnode <span class="variable" translate="no">remote_node_name</span> -resposnefile <span class="variable" translate="no">Oracle_Restart_resposne_file</span> { <span class="variable" translate="no">authentication_option</span> }</code></pre></div>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="rapid-home-provisioning.html#GUID-44D851A3-9478-4A6F-A779-70FB85191A2C" title="某些RHPCTL命令将身份验证选项显示为可选参数。">车队修补和供应操作的身份验证选项</a></li>
                        </ul>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-856C7378-2510-4B3E-8BE1-B4D79DF4FE8B" name="GUID-856C7378-2510-4B3E-8BE1-B4D79DF4FE8B"></a><h4 id="CWADD-GUID-856C7378-2510-4B3E-8BE1-B4D79DF4FE8B" class="sect4">修补Oracle Grid Infrastructure软件</h4>
                  <div>
                     <p>Fleet Patching和Provisioning提供了三种方法来修补Oracle Grid Infrastructure软件家庭：滚动，非滚动和批量。</p>
                     <div class="section">修补Oracle Grid Infrastructure软件涉及将Grid主页移动到当前Grid主目录的修补版本。当Fleet Patching and Provisioning Server或Client启动修补操作时，修补版本必须是黄金映像的工作副本。您将Grid Home移动到的工作副本的补丁级别可能低于当前的主页。如果在移动到更高级别的修补家庭后出现任何问题，这便于回滚。
                        <p>您还可以在没有Fleet Patching和Provisioning Server的环境中使用独立自动机执行此操作。在这种情况下，源和目标家庭不是黄金映像的工作副本，而是使用除了使用Fleet Patching和Provisioning之外的某种方法部署的两个已安装的家庭。</p>
                        <p>本节包括以下主题：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="rapid-home-provisioning.html#GUID-98C7EAF9-D7B3-4293-ABE5-ACC2F270F632" title="修补Oracle Grid Infrastructure的滚动方法是默认方法。">使用滚动方法修补Oracle Grid Infrastructure</a></p>
                           </li>
                           <li>
                              <p><a href="rapid-home-provisioning.html#GUID-5C9CE736-0C43-4E55-9275-F655AB73C140" title="您可以将-nonrolling参数与rhpctl move gihome命令一起使用，该命令将并行地在所有节点上重新启动Oracle Grid Infrastructure堆栈。">使用非滚动方法修补Oracle Grid Infrastructure</a></p>
                           </li>
                           <li>
                              <p><a href="rapid-home-provisioning.html#GUID-83518C02-E439-49E7-A406-47FE5DCF49B0" title="第三种修补方法是顺序处理批量节点，每批中的多个节点并行重启。">使用批处理修补Oracle Grid Infrastructure</a></p>
                           </li>
                           <li>
                              <p><a href="rapid-home-provisioning.html#GUID-A0C98197-0383-4B9F-A520-C4166EAF3180" title="修补Oracle Grid Infrastructure部署时，Fleet Patching和Provisioning使您可以同时修补群集上的Oracle数据库主目录，因此您可以在单个维护操作中修补两种类型的软件主目录。">结合Oracle Grid Infrastructure和Oracle数据库补丁</a></p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-61929F3C-A50A-45EA-8B4A-D11E245A6493">rhpctl添加workingcopy</a></li>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-4706B307-CEDE-4A91-97DE-6AFF552AEDC8">rhpctl移动gihome</a></li>
                        </ul>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-98C7EAF9-D7B3-4293-ABE5-ACC2F270F632" name="GUID-98C7EAF9-D7B3-4293-ABE5-ACC2F270F632"></a><h5 id="CWADD-GUID-98C7EAF9-D7B3-4293-ABE5-ACC2F270F632" class="sect5">使用滚动方法修补Oracle Grid Infrastructure</h5>
                     <div>
                        <p>修补Oracle Grid Infrastructure的滚动方法是默认方法。</p>
                        <div class="section">您可以使用<code class="codeph">rhpctl move gihome</code>命令（原子操作），该命令在每个节点上的Oracle Grid Infrastructure堆栈已在新主目录上重新启动后返回。节点按顺序重新启动，因此一次只有一个节点将脱机，而群集中的所有其他节点仍保持联机状态。
                        </div>
                        <!-- class="section" -->
                        <ul>
                           <li class="stepexpand"><span>将Oracle Grid Infrastructure主目录移动到同一发行版级别的工作副本，如下所示：</span><div><pre class="pre codeblock"><code>$ rhpctl move gihome -client <span class="variable" translate="no">cluster_name</span> -sourcewc <span class="variable" translate="no">Grid_home_1</span> -destwc <span class="variable" translate="no">Grid_home_2</span></code></pre><p>上述命令将正在运行的Oracle Grid Infrastructure主目录从当前托管主目录（ <code class="codeph">sourcewc</code> ）移动到特定客户端群集上的修补主目录（ <code class="codeph">destwc</code> ）。必须在客户端配置已打补丁的房屋。
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>如果移动操作在完成之前的某个时刻失败，则可以通过再次运行该命令来重新运行该操作，并且操作将从停止的位置继续。这使您可以修复导致故障的任何问题，并从故障点恢复处理。或者，您可以撤消部分完成的操作并将配置恢复到其初始状态，如下所示：</span><div><pre class="pre codeblock"><code>$ rhpctl move gihome -destwc <span class="variable" translate="no">destination_workingcopy_name</span> -revert [ <span class="variable" translate="no">authentication_option</span> ]</code></pre><p>您可以将<code class="codeph">-revert</code>参数与未管理的主页一起使用。
                                 </p>
                              </div>
                           </li>
                        </ul>
                        <div class="section">
                           <div class="infoboxnote" id="GUID-98C7EAF9-D7B3-4293-ABE5-ACC2F270F632__GUID-33238487-FB19-4BC9-89D0-F1146D5497A0">
                              <p class="notep1">笔记：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>您无法将Grid主页移动到Fleet Patching and Provisioning无法管理的主页。因此，回滚（到原始主页）仅适用于两个工作副本之间的移动。使用独立自动机时，此限制不适用，因为它仅在非托管住宅上运行。</p>
                                 </li>
                                 <li>
                                    <p>移动网格主页后，您可以随时删除源工作副本。但是，删除工作副本后，无法执行回滚。此外，使用<code class="codeph">rhpctl delete workingcopy</code>命令（例如，与<code class="codeph">rm</code>相反）删除源工作副本以保持Fleet Patching和Provisioning库存正确。
                                    </p>
                                 </li>
                                 <li>
                                    <p>如果使用<code class="codeph">-abort</code>参数终止修补操作，则Fleet Patching and Provisioning不会清除或撤消任何修补步骤。群集，数据库或两者可能处于不一致状态，因为未修补所有节点。
                                    </p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-5C9CE736-0C43-4E55-9275-F655AB73C140" name="GUID-5C9CE736-0C43-4E55-9275-F655AB73C140"></a><h5 id="CWADD-GUID-5C9CE736-0C43-4E55-9275-F655AB73C140" class="sect5">使用非滚动方法修补Oracle Grid Infrastructure</h5>
                     <div>
                        <p>您可以将<code class="codeph">-nonrolling</code>参数与<code class="codeph">rhpctl move gihome</code>命令一起使用，该命令将并行地在所有节点上重新启动Oracle Grid Infrastructure堆栈。
                        </p>
                        <div class="section">与滚动方法一样，这是一个在所有节点联机后返回的原子命令。</div>
                        <!-- class="section" -->
                        <ul>
                           <li class="stepexpand"><span>使用以下命令以非滚动方式修补Oracle Grid Infrastructure：</span><div><pre class="pre codeblock"><code>$ rhpctl move gihome -client <span class="variable" translate="no">cluster_name</span> -sourcewc <span class="variable" translate="no">Grid_home_1</span> -destwc <span class="variable" translate="no">Grid_home_2</span> -nrolling</code></pre></div>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-83518C02-E439-49E7-A406-47FE5DCF49B0" name="GUID-83518C02-E439-49E7-A406-47FE5DCF49B0"></a><h5 id="CWADD-GUID-83518C02-E439-49E7-A406-47FE5DCF49B0" class="sect5">使用批处理修补Oracle Grid Infrastructure</h5>
                     <div>
                        <p>第三种修补方法是顺序处理批量节点，每批中的多个节点并行重启。</p>
                        <div class="section">此方法可在修补过程中最大化服务可用性。修补Oracle Grid Infrastructure 12 <span class="italic">c第</span> 2版（12.2.x）软件主页时，可以在命令行上定义批处理，或者选择让Fleet Patching and Provisioning根据对运行的数据库服务的分析生成批处理列表。集群。
                        </div>
                        <!-- class="section" -->
                        <div class="section">定义批次有两种方法：<ul style="list-style-type:disc">
                              <li>
                                 <p><a href="rapid-home-provisioning.html#GUID-83518C02-E439-49E7-A406-47FE5DCF49B0__USER-DEFINEDBATCHES-5B5324C9">用户定义的批次</a></p>
                              </li>
                              <li>
                                 <p><a href="rapid-home-provisioning.html#GUID-83518C02-E439-49E7-A406-47FE5DCF49B0__RAPIDHOMEPROVISIONING-DEFINEDBATCHE-5B531F59">Fleet Patching和Provisioning-Defined Batches</a></p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                        <div class="section" id="GUID-83518C02-E439-49E7-A406-47FE5DCF49B0__USER-DEFINEDBATCHES-5B5324C9">
                           <p class="subhead3" id="GUID-83518C02-E439-49E7-A406-47FE5DCF49B0__GUID-E21983C3-C7F0-4FFE-B317-97F743EF7712">用户定义的批次</p>
                           <p>使用此修补方法时，首次运行<code class="codeph">rhpctl move gihome</code>命令时，必须根据需要指定源主目录，目标主目录，批处理和其他选项。该命令在第一个节点重新启动后终止。
                           </p>
                           <p>使用您定义的批次修补Oracle Grid Infrastructure：</p>
                           <ol>
                              <li>
                                 <p>在命令行上定义批处理列表并开始修补过程，如以下示例所示：</p><pre class="pre codeblock"><code>$ rhpctl move gihome -sourcewc wc1 -destwc wc2 -batches“（n1），（n2，n3），（n4）”</code></pre><p>上述命令示例启动移动操作，并在第一批Oracle Grid Infrastructure堆栈重新启动时终止并报告成功。Oracle Grid Infrastructure按照您在<code class="codeph">-batches</code>参数中指定的顺序重新启动批处理。
                                 </p>
                                 <p>在命令示例中，节点<code class="codeph">n1</code>形成第一批，节点<code class="codeph">n2</code>和<code class="codeph">n3</code>形成第二批，节点<code class="codeph">n4</code>形成最后一批。该命令将源工作副本定义为<code class="codeph">wc1</code> ，将修补（目标）工作副本定义为<code class="codeph">wc2</code> 。
                                 </p>
                                 <div class="infoboxnote" id="GUID-83518C02-E439-49E7-A406-47FE5DCF49B0__GUID-9C2857EF-2E1A-48DA-AD2E-84EFC1BB49BB">
                                    <p class="notep1">笔记：</p>
                                    <p>您可以指定批处理，以便在批处理之间重新定位单件服务（策略管理的单件服务或在一个实例上运行的管理员管理的服务），并且在修补过程中非单件服务保持部分可用。</p>
                                 </div>
                              </li>
                              <li>
                                 <p>您必须再次运行<code class="codeph">rhpctl move gihome</code>命令来处理下一批，如下所示：</p><pre class="pre codeblock"><code>$ rhpctl move gihome -destwc wc2 -continue</code></pre><p>上述命令示例在第二批（节点<code class="codeph">n2</code>和<code class="codeph">n3</code> ）上重新启动Oracle Grid Infrastructure堆栈。该命令通过报告第二批已成功修补来终止。
                                 </p>
                              </li>
                              <li>
                                 <p>重复上一步，直到处理完最后一批节点。如果在处理完最后一批之后尝试使用<code class="codeph">-continue</code>参数运行该命令，则该命令将返回错误。
                                 </p>
                                 <p>如果<code class="codeph">rhpctl move gihome</code>命令在上述序列中的任何时候失败，则在确定并修复失败原因后，使用<code class="codeph">-continue</code>选项重新运行该命令以尝试修补失败的批处理。如果你想跳过失败批次，并继续进行下一个批次，使用<code class="codeph">-continue</code>和<code class="codeph">-skip</code>参数。如果您尝试跳过最后一批，则终止移动操作。
                                 </p>
                                 <p>或者，您可以使用<code class="codeph">-revert</code>参数重新<code class="codeph">-revert</code>该命令以撤消已进行的更改并将配置返回到其初始状态。
                                 </p>
                                 <p>您可以使用<code class="codeph">-abort</code>参数代替的<code class="codeph">-continue</code>在任何一点参数上一过程中终止打补丁的过程，并留在其当前状态的集群。
                                 </p>
                                 <div class="infoboxnote" id="GUID-83518C02-E439-49E7-A406-47FE5DCF49B0__GUID-72638C6B-CE52-42DF-83EF-7FD38AF37124">
                                    <p class="notep1">笔记：</p>
                                    <ul style="list-style-type:disc">
                                       <li>
                                          <p>托管在具有一个活动服务器的服务器池上的策略托管服务，以及具有一个首选实例且没有可用实例的管理员托管服务无法重新定位，并且在重新启动实例时将脱机。</p>
                                       </li>
                                       <li>
                                          <p>如果正在进行移动操作，则无法从同一源主目录或同一目标主目录启动另一个移动操作。</p>
                                       </li>
                                       <li>
                                          <p>移动操作结束后，服务可能会在移动前与运行的节点不同的节点上运行，如有必要，您必须手动将它们重新定位回原始实例。</p>
                                       </li>
                                       <li>
                                          <p>如果使用<code class="codeph">-abort</code>参数终止修补操作，则Fleet Patching and Provisioning不会清除或撤消任何修补步骤。群集，数据库或两者可能处于不一致状态，因为未修补所有节点。
                                          </p>
                                       </li>
                                       <li>
                                          <p>根据启动依赖关系，在移动开始之前脱机的服务可能会在移动期间联机。</p>
                                       </li>
                                    </ul>
                                 </div>
                              </li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                        <div class="section" id="GUID-83518C02-E439-49E7-A406-47FE5DCF49B0__RAPIDHOMEPROVISIONING-DEFINEDBATCHE-5B531F59">
                           <p class="subhead3" id="GUID-83518C02-E439-49E7-A406-47FE5DCF49B0__GUID-64FDD6DB-027A-47D9-A189-C482625C8C30">Fleet Patching和Provisioning-Defined Batches</p>
                           <p>使用Fleet Patching和Provisioning定义和修补批处理节点意味着您只需运行一个命令，如以下命令示例所示，其中源工作为<code class="codeph">wc1</code> ，目标工作副本为<code class="codeph">wc2</code> ：</p><pre class="pre codeblock"><code>$ rhpctl move gihome -sourcewc wc1 -destwc wc2 -smartmove -saf <span class="variable" translate="no">Z+</span> [-eval]</code></pre><p>除非您在命令中使用了<code class="codeph">-separate</code>参数，否则无需执行任何其他操作。在这种情况下，移动操作等待用户干预以进入下一批，然后您必须在每个批次完成后使用<code class="codeph">-continue</code>参数运行该命令。
                           </p>
                           <div class="p">如果移动操作在完成之前的某个时刻失败，则可以通过再次运行该命令来重新运行该操作，或者可以撤消部分完成的操作，如下所示：<pre class="pre codeblock"><code>$ rhpctl move gihome -destwc <span class="variable" translate="no">destination_workingcopy_name</span> -revert [ <span class="variable" translate="no">authentication_option</span> ]</code></pre>您可以将<code class="codeph">-revert</code>参数与未管理的主页一起使用。
                           </div>
                           <p>上例中使用的参数如下：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <div class="p"><code class="codeph">-smartmove</code> ：此参数在不相交的节点集上重新启动Oracle Grid Infrastructure堆栈，以便在Oracle Grid Infrastructure启动之前重新定位单例资源。
                                    <div class="infoboxnote" id="GUID-83518C02-E439-49E7-A406-47FE5DCF49B0__GUID-7A593538-CE7D-45A7-ADD3-8CC20B343F54">
                                       <p class="notep1">注意：</p>如果资源所属的服务器池仅包含一个活动服务器，则该资源将脱机，因为无法进行重定位。
                                    </div>
                                 </div>
                                 <p><code class="codeph">-smartmove</code>参数：</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p>创建运行它们的服务和节点的映射。</p>
                                    </li>
                                    <li>
                                       <p>创建批量节点。如果配置是Oracle Flex Cluster，则第一批将仅包含Hub节点。对于其他批次，可以在以下情况下将节点合并到批处理中：</p>
                                       <ul style="list-style-type:disc">
                                          <li>
                                             <p>在此节点上运行的任何非单件服务的可用性不会低于指定的服务可用性因子（或默认值50％）。</p>
                                          </li>
                                          <li>
                                             <p>此节点上运行单件服务，批处理中不包含该服务的任何重定位目标节点。</p>
                                          </li>
                                       </ul>
                                    </li>
                                    <li>
                                       <p>逐批重新启动Oracle Grid Infrastructure堆栈。</p>
                                    </li>
                                 </ul>
                              </li>
                              <li>
                                 <p>服务可用性因子（ <code class="codeph">-saf <span class="variable" translate="no">Z+</span></code> ）：您可以指定一个正数（百分比），表示必须运行数据库服务的最小数据库实例数。例如：</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p>如果为在两个实例上运行的服务指定<code class="codeph">-saf 50</code> ，则一次只能有一个实例脱机。
                                       </p>
                                    </li>
                                    <li>
                                       <p>如果为在三个实例上运行的服务指定<code class="codeph">-saf 50</code> ，则一次只能有一个实例脱机。
                                       </p>
                                    </li>
                                    <li>
                                       <p>如果为在两个实例上运行的服务指定<code class="codeph">-saf 75</code> ，则会发生错误，因为永远无法满足目标。
                                       </p>
                                    </li>
                                    <li>
                                       <p>服务可用性因子适用于至少在两个实例上运行的服务。因此，服务可用性因子可以是0％以指示非滚动移动，但不是100％。默认值为50％。</p>
                                    </li>
                                    <li>
                                       <p>如果为单件服务指定服务可用性因子，则将忽略该参数，因为此类服务的可用性为100％且服务将重新定位。</p>
                                    </li>
                                 </ul>
                              </li>
                              <li>
                                 <p><code class="codeph">-eval</code> ：您可以选择使用此参数来查看自动生成的批次。此参数还显示移动操作的顺序，而不实际修补软件。
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>相关话题</strong></p>
                           <ul>
                              <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-4706B307-CEDE-4A91-97DE-6AFF552AEDC8" title="将Oracle Grid Infrastructure软件堆栈从一个主目录移动到另一个主目录。">rhpctl移动gihome</a></li>
                           </ul>
                        </div>
                     </div>
                     
                  </div>
                  <div class="sect4"><a id="GUID-A0C98197-0383-4B9F-A520-C4166EAF3180" name="GUID-A0C98197-0383-4B9F-A520-C4166EAF3180"></a><h5 id="CWADD-GUID-A0C98197-0383-4B9F-A520-C4166EAF3180" class="sect5">结合Oracle Grid Infrastructure和Oracle数据库补丁</h5>
                     <div>
                        <p>修补Oracle Grid Infrastructure部署时，Fleet Patching和Provisioning使您可以同时修补群集上的Oracle数据库主目录，因此您可以在单个维护操作中修补两种类型的软件主目录。</p>
                        <div class="infoboxnote" id="GUID-A0C98197-0383-4B9F-A520-C4166EAF3180__GUID-BEE8637F-3B46-4455-8A99-67D84C99FA7D">
                           <p class="notep1">注意：</p>您无法使用独立自动机将Oracle Grid Infrastructure和Oracle数据库组合在一起。
                        </div>
                        <p><code class="codeph">rhpctl move gihome</code>命令的以下可选参数与组合的Oracle Grid Infrastructure和Oracle数据库修补用例相关：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">-auto</code> ：自动修补数据库以及修补Oracle Grid Infrastructure</p>
                           </li>
                           <li>
                              <div class="p"><code class="codeph">-dbhomes <span class="variable" translate="no">mapping_of_Oracle_homes</span></code> ：按以下格式映射源和目标工作副本：<pre class="pre codeblock"><code>sourcewc1 = destwc1，...， <span class="variable" translate="no">source_oracle_home_path</span> = destwc <span class="variable" translate="no">N</span></code></pre></div>
                           </li>
                           <li>
                              <p><code class="codeph">-dblist <span class="variable" translate="no">db_name_list</span></code> ：仅修补指定的数据库</p>
                           </li>
                           <li>
                              <p><code class="codeph">-excludedblist <span class="variable" translate="no">db_name_list</span></code> ：修补除指定数据库之外的所有数据库</p>
                           </li>
                           <li>
                              <p><code class="codeph">-nodatapatch</code> ：表示<code class="codeph">datapatch</code>没有对数据库运行移动</p>
                           </li>
                        </ul>
                        <p>作为一个例子，假设一个舰队修补和与Oracle网格基础架构12 <span class="italic">c</span>释放2预配置服务器（12.2）已置备的Oracle网格基础设施12 <span class="italic">c</span>释放1（12.1.0.2）目标群集，其包括在节点上的以下工作副本<code class="codeph">test_749</code> ：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">GI121WC1</code> ：Oracle Grid Infrastructure 12 <span class="italic">c</span>发行版1（12.1.0.2）群集上的活动Grid主目录</p>
                           </li>
                           <li>
                              <p><code class="codeph">GI121WC2</code> ：Oracle Grid Infrastructure 12 <span class="italic">c</span>发行版1（12.1.0.2）群集上的<code class="codeph">GI121WC2</code>软件网格主目录</p>
                           </li>
                           <li>
                              <p><code class="codeph">DB121WC1</code> ：运行数据库实例的Oracle RAC 12 <span class="italic">c</span>发行版1（12.1.0.2.0）数据库主目录</p>
                           </li>
                           <li>
                              <p><code class="codeph">DB121025WC1</code> ：没有数据库实例的Oracle RAC 12 <span class="italic">c</span>版本1（12.1.0.2.5）数据库主目录（这是已修补的主目录）</p>
                           </li>
                           <li>
                              <p><code class="codeph">DB112WC1</code> ：运行数据库实例的Oracle RAC <span class="italic">11g</span>发行版2（11.2.0.4.0）数据库主目录</p>
                           </li>
                           <li>
                              <p><code class="codeph">DB112045WC1</code> ：没有数据库实例的Oracle RAC <span class="italic">11g第</span> 2版（11.2.0.4.5）数据库主目录（这是已修补的主目录）</p>
                           </li>
                        </ul>
                        <p>进一步假设您想要同时移动</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>Oracle Grid Infrastructure从工作副本<code class="codeph">GI121WC1</code>到工作副本<code class="codeph">GI121WC2</code></p>
                           </li>
                           <li>
                              <p>Oracle RAC数据库<code class="codeph">db1</code>从工作副本<code class="codeph">DB121WC1</code>到工作副本<code class="codeph">DB121025WC1</code></p>
                           </li>
                           <li>
                              <p>Oracle RAC数据库<code class="codeph">db2</code>在工作副本<code class="codeph">DB112WC1</code>中工作副本<code class="codeph">DB112045WC1</code></p>
                           </li>
                        </ul>
                        <p>以下单个命令完成了这些操作：</p><pre class="pre codeblock"><code>$ rhpctl move gihome -sourcewc GI121WC1 -destwc GI121WC2 -auto -dbhomes DB121WC1 = DB121025WC1，DB112WC1 = DB112045WC1 -targetnode test_749 { <span class="variable" translate="no">authentication_option</span> }</code></pre><div class="infoboxnote" id="GUID-A0C98197-0383-4B9F-A520-C4166EAF3180__GUID-BA4F9D32-F682-43B8-9844-314B594002C7">
                           <p class="notep1">笔记：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>如果现有的Oracle主目录当前不是工作副本，则指定Oracle主路径而不是源主目录的工作副本名称。在前面的示例中，如果现有12.1.0.2主目录的Oracle主路径为<code class="codeph">/u01/app/prod/12.1.0.2/dbhome1</code> ，则将<code class="codeph">DB121WC1=DB121025WC1</code>替换为<code class="codeph">/u01/app/prod/12.1.0.2/dbhome1=DB121025WC1</code> 。
                                 </p>
                              </li>
                              <li>
                                 <div class="p">如果移动操作在完成之前的某个时刻失败，那么您可以通过重新运行命令来解决失败的原因并恢复操作，或者您可以通过发出以下命令来撤消部分完成的操作，该命令将配置恢复到其初始状态：<pre class="pre codeblock"><code>$ rhpctl move gihome -destwc GI121WC2 -revert { <span class="variable" translate="no">authentication_option</span> }</code></pre></div>
                              </li>
                           </ul>
                        </div>
                        <p>在前面的命令例如，Oracle网格基础架构12 <span class="italic">c</span>释放1（12.1.0.2）网格家从工作副本移动<code class="codeph">GI121WC1</code>到工作副本<code class="codeph">GI121WC2</code> ，数据库上工作副本运行<code class="codeph">DB121WC1</code>移动到工作拷贝<code class="codeph">DB121025WC1</code> ，并在工作副本正在运行的数据库<code class="codeph">DB112WC1</code>转到工作副本<code class="codeph">DB112045WC1</code> 。
                        </p>
                        <p>对于客户端群集中的每个节点，RHPCTL：</p>
                        <ol>
                           <li>
                              <p>运行任何已配置的操作前用户操作以移动Oracle Grid Infrastructure（ <code class="codeph">move gihome</code> ）。
                              </p>
                           </li>
                           <li>
                              <p>运行任何已配置的操作前用户操作以移动数据库工作副本（ <code class="codeph">move database</code> ）。
                              </p>
                           </li>
                           <li>
                              <p>停止在节点上运行的服务，并应用drain和disconnect选项。</p>
                           </li>
                           <li>
                              <p>执行Oracle Clusterware和Oracle Database的相关修补操作。</p>
                           </li>
                           <li>
                              <p>运行任何已配置的操作后用户操作以移动数据库工作副本（ <code class="codeph">move database</code> ）。
                              </p>
                           </li>
                           <li>
                              <p>运行任何已配置的操作后用户操作以移动Oracle Grid Infrastructure工作副本（ <code class="codeph">move gihome</code> ）。
                              </p>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>相关话题</strong></p>
                           <ul>
                              <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-4706B307-CEDE-4A91-97DE-6AFF552AEDC8" title="将Oracle Grid Infrastructure软件堆栈从一个主目录移动到另一个主目录。">rhpctl移动gihome</a></li>
                           </ul>
                        </div>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-A40643A4-9ADA-4F35-87B6-967BC24363FF" name="GUID-A40643A4-9ADA-4F35-87B6-967BC24363FF"></a><h5 id="CWADD-GUID-A40643A4-9ADA-4F35-87B6-967BC24363FF" class="sect5">零停机Oracle Grid Infrastructure补丁</h5>
                     <div>
                        <p>使用Fleet Patching和Provisioning修补Oracle Grid Infrastructure，而不会关闭Oracle RAC数据库实例。</p>
                        <div class="section">当前修补Oracle Grid Infrastructure的方法要求您在要修补Oracle Grid Infrastructure主目录的节点上关闭所有Oracle RAC数据库实例。此问题在Grid Infrastructure层中得到解决，数据库实例可以在网格基础结构修补期间继续运行。</div>
                        <!-- class="section" -->
                        <ul>
                           <li class="stepexpand"><span>要启用零停机Oracle Grid Infrastructure修补，请以类似于以下的方式使用<code class="codeph">rhpctl move gihome</code>命令：</span><div><pre class="pre codeblock"><code>rhpctl移动gihome -tgip</code></pre></div>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-FF5595BC-8603-4564-9DD8-C53484330519" name="GUID-FF5595BC-8603-4564-9DD8-C53484330519"></a><h4 id="CWADD-GUID-FF5595BC-8603-4564-9DD8-C53484330519" class="sect4">使用本地模式配置修补Oracle Grid Infrastructure</h4>
                  <div>
                     <p>安装Oracle Grid Infrastructure或将旧版本升级到当前版本时，将以本地模式自动配置Fleet Patching和Provisioning Server。</p>
                     <div class="section">
                        <div class="p">通过本地模式操作，您可以在简化的环境中在本地群集上执行网格基础结构和数据库修补操作，而无需注册或部署黄金映像。部署网格基础结构或数据库<code class="codeph">rhpctl move gihome</code>回家并使用<code class="codeph">rhpctl move gihome</code>或<code class="codeph">rhpctl move database</code>命令运行修补程序操作，指定源路径和目标路径而不是工作副本名称。
                           <div class="infoboxnote" id="GUID-FF5595BC-8603-4564-9DD8-C53484330519__GUID-02F11B15-D338-4E73-B5EB-EC979146E343">
                              <p class="notep1">注意：</p>必须先使用以下命令启用并启动Fleet Patching and Provisioning Server，然后才能使用本地模式修补操作：<pre class="pre codeblock"><code>$ srvctl enable rhpserver $ srvctl start rhpserver</code></pre></div>
                        </div>
                        <div class="p">要将Fleet Patching和Provisioning Server从本地模式切换到常规中央模式（以管理远程目标），您必须在本地模式下删除当前的Fleet Patching和Provisioning Server，如下所示：<pre class="pre codeblock"><code>$ srvctl stop rhpserver $ srvctl remove rhpserver</code></pre></div>
                        <p>继续执行“创建Fleet Patching和Provisioning Server”中描述的步骤以创建中央模式Fleet Patching和Provisioning Server。</p>
                     </div>
                     <!-- class="section" -->
                     <ul>
                        <li class="stepexpand"><span>用于修补Oracle Grid Infrastructure的独立自动机执行从一个家庭切换到另一个家庭所需的所有步骤。由于自动机不知道黄金映像，因此移动数据库需要两条主路径，如下所示：</span><div><pre class="pre codeblock"><code>$ rhpctl move gihome -sourcehome <span class="variable" translate="no">Oracle_home_path</span> -destinationhome <span class="variable" translate="no">Oracle_home_path</span></code></pre></div>
                        </li>
                     </ul>
                     <div class="section">使用以下<code class="codeph">rhpctl move gihome</code>命令参数进行修补操作：<ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">-node</code> ：如果您要移动的主目录是安装在多个节点上的Oracle Grid Infrastructure主目录，则默认操作是在所有节点上进行滚动更新。要将修补程序仅应用于一个节点，请使用此参数指定该节点的名称。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">-nonrolling</code> ：如果您要移动的主页是安装在多个节点上的Oracle Grid Infrastructure主目录，则默认操作是在所有节点上进行滚动更新。要以非滚动方式修补所有节点，请使用此参数而不是<code class="codeph">-node</code>参数。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">-ignorewcpatches</code> ：默认情况下，如果目标主页缺少源主目录中存在的任何修补程序，则Fleet Patching和Provisioning将不执行移动操作。您可以使用此参数覆盖此功能，例如，如果必须撤消更新，则返回到上一个源主目录。
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="rapid-home-provisioning.html#GUID-50B4A759-EE58-47AF-9B50-84572A58606A" title="Fleet Patching和Provisioning Server使用您在Oracle ACFS文件系统中创建的存储库，您可以在其中存储要为客户端和目标提供的所有软件主目录。">创建Fleet Patching和Provisioning Server</a></li>
                        </ul>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-7F6F87C2-57B9-410F-9ECF-231909CB4F14" name="GUID-7F6F87C2-57B9-410F-9ECF-231909CB4F14"></a><h4 id="CWADD-GUID-7F6F87C2-57B9-410F-9ECF-231909CB4F14" class="sect4">错误预防和自动恢复选项</h4>
                  <div>
                     <p>Fleet Patching and Provisioning具有错误预防和自动恢复选项，可在维护操作期间为您提供帮助。</p>
                     <p>在维护操作期间，必须尽可能避免错误，并且一旦发生错误，您必须具有自动恢复路径以避免服务中断。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-7F6F87C2-57B9-410F-9ECF-231909CB4F14__GUID-C8541044-AEB0-4E8C-BEB0-2FBD053C9C97">错误预防</p>
                        <p>许多RHPCTL命令都包含<code class="codeph">-eval</code>参数，您可以使用该参数运行命令并评估当前配置，而无需进行任何更改以确定命令是否可以成功运行以及命令的运行将如何影响配置。使用<code class="codeph">-eval</code>参数运行的命令在不更改配置的情况下运行尽可能多的先决条件检查。如果遇到错误，则RHPCTL在命令输出中报告它们。更正任何错误后，可以使用<code class="codeph">-eval</code>再次运行该命令以验证更正。使用<code class="codeph">–eval</code>成功运行命令可以高度确信运行实际命令将成功。
                        </p>
                        <p>您可以在任何维护窗口之外使用<code class="codeph">-eval</code>参数测试命令，因此完整窗口可用于维护过程本身。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-7F6F87C2-57B9-410F-9ECF-231909CB4F14__GUID-9FEB682D-905B-4747-A7EF-E3B30F4891B3">自动恢复选项</p>
                        <p>在维护操作期间，错误可能在飞行中发生（例如，在<code class="codeph">rhpctl move database</code>或<code class="codeph">rhpctl move gihome</code>命令的中途）或成功操作后（例如，在<code class="codeph">rhpctl move database</code>命令之后，您会遇到性能或行为问题） ）。
                        </p>
                        <p><span class="bold">飞行中的错误</span></p>
                        <div class="p">移动操作期间是否应发生飞行中错误：<ul style="list-style-type:disc">
                              <li>
                                 <p>更正RHPCTL报告并重新运行命令的任何错误，该命令将在故障点恢复运行。</p>
                                 <p>如果重新运行命令成功并且移动操作具有与之关联的操作后用户操作，则运行用户操作。但是，如果存在操作前用户操作，则RHPCTL不会重新运行该命令。</p>
                              </li>
                              <li>
                                 <p>运行新的移动命令，仅指定失败移动的目标（工作副本或非托管主页），验证选项（如果需要），并使用<code class="codeph">-revert</code>参数。这会将配置恢复到其初始状态。
                                 </p>
                                 <p>不会运行与该操作关联的用户操作。</p>
                              </li>
                              <li>
                                 <p>运行新的移动命令，仅指定失败移动的目标（工作副本或非托管主页），验证选项（如果需要）和<code class="codeph">-abort</code>参数。这使配置保持当前状态。此时需要手动干预以将配置置于最终状态。
                                 </p>
                                 <p>不会运行与该操作关联的用户操作。</p>
                              </li>
                           </ul>
                        </div>
                        <p><span class="bold">更新后的问题</span></p>
                        <div class="p">即使在成功移动到新数据库或Oracle Grid Infrastructure主页后，您仍可能需要撤消更改并回滚到之前的主页。您可以通过重新运行命令来反转源和目标主页来执行此操作。这实际上是在不参考先前的移动操作的情况下执行的新移动操作。
                           <div class="infoboxnote" id="GUID-7F6F87C2-57B9-410F-9ECF-231909CB4F14__GUID-AD870256-958E-4506-B063-8966854B4007">
                              <p class="notep1">注意：</p>对于独立的自动机，源房和目的地房屋总是不受管理的房屋（那些房屋没有由Fleet Patching and Provisioning提供）。在Fleet Patching and Provisioning Server或Fleet Patching and Provisioning Client上运行移动操作时，目标主目录必须是由Fleet Patching and Provisioning配置的托管主目录。
                           </div>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-8CFE4E4C-DD4E-4E5B-81E7-A71CBC220E1E" name="GUID-8CFE4E4C-DD4E-4E5B-81E7-A71CBC220E1E"></a><h4 id="CWADD-GUID-8CFE4E4C-DD4E-4E5B-81E7-A71CBC220E1E" class="sect4">升级Oracle Grid Infrastructure软件</h4>
                  <div>
                     <p>如果您正在使用Fleet Patching and Provisioning，则可以使用单个命令升级Oracle Grid Infrastructure主目录。</p>
                     <div class="section">
                        <p>Fleet Patching和Provisioning支持从11 <span class="italic">g</span>版本2（11.2.0.3和11.2.0.4）升级到Oracle Grid Infrastructure 12 <span class="italic">c第</span> 1版（12.1.0.2）。11 <span class="italic">g</span>版本2（11.2.0.3和11.2.0.4）和12 <span class="italic">c</span>版本1（12.1.0.2）支持升级到Oracle Grid Infrastructure 12 <span class="italic">c</span>版本2（12.2.0.1）。升级的目标可以是已配置的黄金映像的工作副本，也可以选择在此操作中创建工作副本。
                        </p>
                        <p>例如，假设目标集群在由Fleet Patching and Provisioning配置的Oracle Grid Infrastructure主目录上运行Oracle Grid Infrastructure。此Oracle Grid Infrastructure主页为11 <span class="italic">g</span>版本2（11.2.0.4），并且相应地命名了工作副本。
                        </p>
                        <p>配置Oracle Grid Infrastructure 12 <span class="italic">c</span>发行版2（12.2.0.1）的工作副本版本（在此示例中名为GIOH12201）后，您可以使用以下单个命令升级到该工作副本：</p><pre class="pre codeblock"><code>$ rhpctl upgrade gihome -sourcewc GIOH11204 -destwc GIOH12201</code></pre><div class="p">Fleet Patching和Provisioning能够根据源工作副本的名称识别要升级的集群。如果目标集群在非托管Oracle Grid Infrastructure主目录上运行，那么您将指定源主目录的路径，而不是提供源工作副本名称，并且还必须指定目标集群。
                           <div class="infoboxnote" id="GUID-8CFE4E4C-DD4E-4E5B-81E7-A71CBC220E1E__GUID-9B09578B-20DE-421E-A27C-DA5830DF152A">
                              <p class="notep1">注意：</p>完成升级后，您可以随时删除源工作副本。但是，删除工作副本后，无法执行回滚。此外，使用<code class="codeph">rhpctl delete workingcopy</code>命令（例如，与<code class="codeph">rm</code>相反）删除源工作副本以保持Fleet Patching和Provisioning库存正确。
                           </div>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-F1F48984-C440-44F4-9D62-BDB4BE1CDB4A" name="GUID-F1F48984-C440-44F4-9D62-BDB4BE1CDB4A"></a><h3 id="CWADD-GUID-F1F48984-C440-44F4-9D62-BDB4BE1CDB4A" class="sect3">Oracle数据库软件管理</h3>
               <div>
                  <p>Fleet Patching和Provisioning Server为将数据库家园分发到目标和Fleet Patching和Provisioning Client提供了一个高效安全的平台。</p>
                  <p>此外，Fleet Patching和Provisioning Client能够从Fleet Patching和Provisioning Server获取数据库。</p>
                  <p>Oracle数据库主目录以黄金映像的工作副本的形式分发。然后可以在工作副本上创建数据库实例（一个或多个）。</p>
                  <p>Fleet Patching和Provisioning还具有管理现有数据库的命令，例如切换到已打补丁的主页或升级到新的数据库版本。这些都是单个命令，它们协调所涉及的众多步骤。回到原来的家就是这么简单。</p>
               </div>
               <div class="sect3"><a id="GUID-34B6F969-E70E-480D-AC7F-9858E11FF293" name="GUID-34B6F969-E70E-480D-AC7F-9858E11FF293"></a><h4 id="CWADD-GUID-34B6F969-E70E-480D-AC7F-9858E11FF293" class="sect4">配置数据库主页的黄金映像副本</h4>
                  <div>
                     <p>使用<code class="codeph">rhpctl add workingcopy</code>命令在Fleet Patching and Provisioning Server，Client或target上设置数据库主目录的工作副本。
                     </p>
                     <ul>
                        <li class="stepexpand"><span>在Fleet Patching and Provisioning Server上运行<code class="codeph">rhpctl add workingcopy</code>命令，类似于以下示例：</span><div><pre class="pre codeblock"><code>$ rhpctl add workingcopy -image db12c -path /u01/app/dbusr/product/12.2.0/db12201 -client client_007 -oraclebase / u01 / app / dbusr / -workingcopy wc_db122_1</code></pre><p>上述命令示例在名为<code class="codeph">client_007</code>的Fleet Patching and Provisioning Client集群的所有节点上创建名为<code class="codeph">wc_db122_1</code>的工作副本。黄金图像<code class="codeph">db12c</code>是工作<code class="codeph">db12c</code>的来源。您在命令中指定的目录路径位置必须为空。
                              </p>
                           </div>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-61929F3C-A50A-45EA-8B4A-D11E245A6493">rhpctl添加workingcopy</a></li>
                        </ul>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-8EEE7B35-43C4-4C26-95C6-C39B702F1EF1" name="GUID-8EEE7B35-43C4-4C26-95C6-C39B702F1EF1"></a><h4 id="CWADD-GUID-8EEE7B35-43C4-4C26-95C6-C39B702F1EF1" class="sect4">在Gold Image的副本上创建Oracle数据库</h4>
                  <div>
                     <p>在工作副本上创建Oracle数据库。</p>
                     <div class="section">
                        <p>Fleet Patching和Provisioning Server可以在Fleet Patching and Provisioning Server本身，Fleet Patching and Provisioning Client或非Fleet Patching and Provisioning Client目标上的工作副本上添加数据库。Fleet Patching和Provisioning Client可以在Fleet Patching and Provisioning Client本身运行的工作副本上创建数据库。</p>
                     </div>
                     <!-- class="section" -->
                     <ul>
                        <li class="stepexpand"><span>创建黄金映像的工作副本并将该工作副本提供给目标后，可以使用<code class="codeph">rhpctl add database</code>命令在工作副本上创建Oracle数据库，类似于以下命令示例，该示例创建Oracle Real Application Clusters所谓的（Oracle RAC的）数据库<code class="codeph">db12201</code>上的工作副本名为<code class="codeph">wc_db122_1</code> ：</span><div><pre class="pre codeblock"><code>$ rhpctl add database -workingcopy wc_db122_1 -dbname db12201 -node client_007_node1，client_007_node2 -dbtype RAC -datafileDestination DATA007_DG</code></pre></div>
                        </li>
                     </ul>
                     <div class="section">上面的示例在客户端群集中的两个节点上创建管理员管理的Oracle RAC数据库。数据文件目标是在运行命令之前创建的Oracle ASM磁盘组。此外，您还可以创建Oracle RAC One Node和非群集数据库。
                        <div class="infoboxnote" id="GUID-8EEE7B35-43C4-4C26-95C6-C39B702F1EF1__GUID-32A4EDD9-193D-4203-AB58-A59C7F235C1D">
                           <p class="notep1">注意：</p>使用Fleet Patching and Provisioning创建数据库时，该功能对数据库中的SYS和SYSTEM模式使用随机密码，您无法检索这些密码。具有DBA或操作员角色的用户必须在运行它的节点上本地连接到数据库，并将密码重置为这两个帐户。
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-CD92C0DB-D5E2-427A-8784-94F4C140B279" name="GUID-CD92C0DB-D5E2-427A-8784-94F4C140B279"></a><h4 id="CWADD-GUID-CD92C0DB-D5E2-427A-8784-94F4C140B279" class="sect4">修补Oracle数据库软件</h4>
                  <div>
                     <p>要修补Oracle数据库，可以将数据库迁移到新的主目录，其中包括要实现的修补程序。</p>
                     <div class="section">使用<code class="codeph">rhpctl move database</code>命令将一个或多个数据库主<code class="codeph">rhpctl move database</code>到同一数据库发行版级别的工作副本。数据库可以在工作副本上运行，也可以在不由Fleet Patching and Provisioning管理的Oracle数据库主目录上运行。
                     </div>
                     <!-- class="section" -->
                     <div class="section">当Fleet Patching and Provisioning Server或Client启动移动操作时，移动到的版本必须是黄金映像的工作副本。您还可以在没有Fleet Patching和Provisioning Server的环境中使用独立自动机执行此操作。在这种情况下，源和目标家庭不是黄金映像的工作副本，而是使用除了使用Fleet Patching和Provisioning之外的某种方法部署的两个已安装的家庭。</div>
                     <!-- class="section" -->
                     <div class="section">要移动数据库的工作副本的补丁级别可能低于当前数据库主目录。如果在移动到更高级别的补丁主页后遇到任何问题，这有助于回滚。</div>
                     <!-- class="section" -->
                     <div class="section">移动数据库主目录的工作副本可以与原始工作副本处于相同的修补程序级别。如果您将数据库从一个存储位置移动到另一个存储位置，或者如果您希望将非托管主页转换为托管主页，同时保持相同的修补程序级别，则此功能非常有用。</div>
                     <!-- class="section" -->
                     <div class="section">Fleet Patching and Provisioning适用于所有补丁，最大限度地减少了维护所需的停机时间。Fleet Patching和Provisioning还保留了当前配置，从而实现了之前描述的回滚功能。默认情况下，Fleet Patching和Provisioning以滚动方式应用修补程序，从而减少并在许多情况下消除服务停机时间。使用<code class="codeph">-nonrolling</code>选项以非滚动模式执行修补。然后在旧的<code class="codeph">ORACLE_HOME</code>上完全停止数据库，然后重新启动以使其从新修补的<code class="codeph">ORACLE_HOME</code>运行。<div class="infoboxnote" id="GUID-CD92C0DB-D5E2-427A-8784-94F4C140B279__GUID-798067EB-E9CA-4292-B958-1538CFF860E8">
                           <p class="notep1">注意：</p>部分修补过程包括应用Datapatch。移动Oracle Database 12 <span class="italic">c第</span> 1版（12.1）或更高版本时，Fleet Patching and Provisioning将为您完成此步骤。但是，当您移动到Oracle Database 12 <span class="italic">c第</span> 1版（12.1）之前的版本时，必须手动运行Datapatch。Fleet Patching和Provisioning支持Oracle Data Guard，不会将Datapatch应用于Oracle Data Guard备用数据库。
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p><span class="bold">数据库修补的工作流程</span></p>假设数据库名为<code class="codeph">myorcldb</code>是在一个从Oracle数据库12c的版本命名为2（12.2），金像创建工作副本运行<code class="codeph">DB122</code> 。修补Oracle数据库主目录的典型工作流程如下：</div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>创建要修补的Oracle数据库的工作副本，在本例中为<code class="codeph">DB122</code> 。</span></li>
                        <li class="stepexpand"><span>将修补程序应用于您创建的工作副本。</span></li>
                        <li class="stepexpand"><span>测试并验证修补的工作副本。</span></li>
                        <li class="stepexpand"><span>使用<code class="codeph">rhpctl add image</code>命令从修补的工作副本创建黄金映像（例如， <code class="codeph">DB122_PATCH</code> ）。</span><div>
                              <div class="infoboxnote" id="GUID-CD92C0DB-D5E2-427A-8784-94F4C140B279__GUID-37F07A1D-A6CB-4C90-974F-B3EA70C70D16">
                                 <p class="notep1">注意：</p>您在上述命令中指定的工作副本必须托管在Fleet Patching和Provisioning-managed存储中的Fleet Patching and Provisioning Server上。
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>使用<code class="codeph">rhpctl delete workingcopy</code>命令使用修补的Oracle数据库删除修补的工作副本。</span><div>
                              <div class="infoboxnote" id="GUID-CD92C0DB-D5E2-427A-8784-94F4C140B279__GUID-56F8104D-9F2F-4B39-BE0E-8F0CFC7DB106">
                                 <p class="notep1">注意：</p>不要使用<code class="codeph">rm</code>命令或其他方法直接删除，因为这不会更新Fleet Patching和Provisioning清单信息。
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>从修补的黄金图像（ <code class="codeph">DB122_PATCH</code> ）创建工作副本。</span></li>
                        <li class="stepexpand"><span>将<code class="codeph">myorcldb</code>移动到刚刚创建的工作副本。</span></li>
                        <li class="stepexpand"><span>如果您确信在过程开始时不需要回滚到运行数据库的工作副本，请使用<code class="codeph">rhpctl delete workingcopy</code>命令删除该工作副本。</span></li>
                     </ol>
                     <div class="section">
                        <p><span class="bold">使用批处理修补Oracle数据库</span></p>
                        <p>在数据库修补期间，Fleet Patching和Provisioning可以按顺序处理批量节点，并且每个批次中的多个节点并行重启。此方法可在修补过程中最大化服务可用性。您可以在命令行上定义批处理，也可以选择让Fleet Patching和Provisioning根据对集群中运行的数据库服务的分析生成批处理列表。</p>
                        <p><span class="bold">针对OJVM部署的自适应Oracle RAC滚动修补</span></p>
                        <p>在集群环境中，使用Fleet Patching和Provisioning应用数据库维护的默认方法是Oracle RAC滚动。但是，如果新（修补）数据库主目录包含OJVM修补程序，则可能需要非滚动。在这种情况下，Fleet Patching and Provisioning确定滚动方法是否可行，并在适用时滚动。（有关详细信息，请参阅MOS注释2217053.1。）</p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="rapid-home-provisioning.html#GUID-856C7378-2510-4B3E-8BE1-B4D79DF4FE8B">修补Oracle Grid Infrastructure软件</a></li>
                           <li><a href="rapid-home-provisioning.html#GUID-FE6E954E-89D7-4AE3-9B9B-A26B787ECBAE">提供黄金图像的副本</a></li>
                           <li><a href="rapid-home-provisioning.html#GUID-58793EAD-3C8B-4C3F-A5CB-680BD5693A14">将黄金映像添加到Fleet Patching和Provisioning Server</a></li>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-BB5B4501-E270-482A-ADEF-B3D487A9055E">RHPCTL命令参考</a></li>
                        </ul>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-FD8CDD66-7821-4817-84FC-B0109D2929D5" name="GUID-FD8CDD66-7821-4817-84FC-B0109D2929D5"></a><h4 id="CWADD-GUID-FD8CDD66-7821-4817-84FC-B0109D2929D5" class="sect4">使用独立自动机修补Oracle数据库</h4>
                  <div>
                     <p>独立本地模式自动机更新Oracle数据库主目录，包括群集中的Oracle数据库单实例数据库或独立（没有Oracle Grid Infrastructure），Oracle RAC数据库或Oracle RAC One Node数据库。</p>
                     <div class="section">在集群环境中，数据库源家庭可以是Oracle数据库11 <span class="italic">克</span> （11.2.0.4），12个<span class="italic">C（12.1.0.2），12</span>个<span class="italic">C（12.2.0.1），</span>或更高版本。
                     </div>
                     <!-- class="section" -->
                     <div class="section">在独立（非群集）环境中，数据库主目录必须是Oracle Database 18c或更高版本。</div>
                     <!-- class="section" -->
                     <div class="section">自动机在部署中本地运行，并且不需要体系结构中的Fleet Patching和Provisioning Server。（如果体系结构中存在Fleet Patching和Provisioning Server，则自动机不与其通信，并且Fleet Patching和Provisioning Server无法与独立自动机交互。）</div>
                     <!-- class="section" -->
                     <ul>
                        <li class="stepexpand"><span>Oracle数据库修补的独立自动机执行从一个家庭切换到另一个家庭所需的所有步骤。由于自动机不知道黄金映像，因此移动数据库需要两条主路径，如下所示：</span><div><pre class="pre codeblock"><code>$ rhpctl move database -sourcehome <span class="variable" translate="no">Oracle_home_path</span> -destinationhome <span class="variable" translate="no">Oracle_home_path</span></code></pre></div>
                        </li>
                     </ul>
                     <div class="section">对于任何修补方案，请使用以下<code class="codeph">rhpctl move database</code>命令参数：<ul style="list-style-type:disc">
                           <li>
                              <div class="p"><code class="codeph">-dbname</code> ：如果数据库主目录托管多个数据库，则可以通过使用此参数指定逗号分隔的列表来移动特定数据库。未指定的数据库不会移动。如果不使用此参数，则RHPCTL将移动所有数据库。
                                 <div class="infoboxnote" id="GUID-FD8CDD66-7821-4817-84FC-B0109D2929D5__GUID-BE551544-86B9-4B21-8CA2-22B62F606C41">
                                    <p class="notep1">注意：</p>如果要移动非群集（单实例）数据库，则对于<code class="codeph">-dbname</code>参数的值，必须指定数据库的SID而不是数据库名称。
                                 </div>
                              </div>
                           </li>
                           <li>
                              <p><code class="codeph">-ignorewcpatches</code> ：默认情况下，如果目标主页缺少源主目录中存在的任何修补程序，则Fleet Patching和Provisioning将不执行移动操作。您可以使用此参数覆盖此功能，例如，如果必须撤消更新，则返回到上一个源主目录。
                              </p>
                           </li>
                        </ul>
                        <div class="p">以下参数仅适用于群集环境：<ul style="list-style-type:disc">
                              <li>
                                 <p><code class="codeph">-node</code> ：如果您要移动的主目录是安装在多个节点上的数据库主目录，则默认操作是在所有节点上进行滚动更新。要将修补程序仅应用于一个节点，请使用此参数指定该节点的名称。
                                 </p>
                              </li>
                              <li>
                                 <p><code class="codeph">-nonrolling</code> ：如果您要移动的主页是安装在多个节点上的数据库主目录，则默认操作是在所有节点上进行滚动更新。要以非滚动方式修补所有节点，请使用此参数而不是<code class="codeph">-node</code>参数。
                                 </p>
                              </li>
                              <li>
                                 <p></p>
                              </li>
                           </ul>
                        </div>
                        <p><code class="codeph">-disconnect</code>和<code class="codeph">-noreplay</code> ：适用于单实例Oracle数据库，以及Oracle RAC和Oracle RAC One Node数据库实例。在停止或重定位服务之前，请使用<code class="codeph">-disconnect</code>参数断开所有会话。如果选择使用<code class="codeph">-disconnect</code> ，则可以选择使用<code class="codeph">-noreplay</code>参数在断开连接期间禁用会话重播。
                        </p>
                        <p><code class="codeph">-drain_timeout</code> ：适用于单实例Oracle数据库，Oracle RAC和Oracle RAC One Node数据库实例。使用此参数指定从每个节点完成资源耗尽所允许的时间（以秒为单位）。接受的值是空字符串（“”），0或任何正整数。默认值为空字符串，表示未设置此参数。这适用于旧版本以维护传统行为。如果设置为0，则立即应用停止选项。
                        </p>
                        <p>排水期用于计划的维护操作。在排水期间，在每个节点上连续处理所有当前客户端请求，但不接受新请求。</p>
                        <p><code class="codeph">-stopoption</code> ：适用于单实例Oracle数据库，Oracle RAC和Oracle RAC One Node数据库实例。为数据库指定停止选项。停止选项包括：ABORT，IMMEDIATE，NORMAL，TRANSACTIONAL和TRANSACTIONAL_LOCAL。</p>
                        <div class="infoboxnote" id="GUID-FD8CDD66-7821-4817-84FC-B0109D2929D5__GUID-FE4798CD-5BBC-41A4-88ED-4DF8032B64DF">
                           <p class="notep1">注意：</p><code class="codeph">rhpctl move database</code>命令是Oracle Data Guard感知的，如果数据库是Oracle Data Guard备用数据库，则不会运行Datapatch。
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-C10036DC-B091-40E1-B46B-8ACF38B20066" title="将一个或多个数据库从源工作副本或任何Oracle数据库主目录移动到修补的工作副本。">rhpctl移动数据库</a></li>
                        </ul>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-CB42840D-3ECB-4AB4-B338-FD9F0D856AC3" name="GUID-CB42840D-3ECB-4AB4-B338-FD9F0D856AC3"></a><h4 id="CWADD-GUID-CB42840D-3ECB-4AB4-B338-FD9F0D856AC3" class="sect4">修补Oracle Exadata软件</h4>
                  <div>
                     <p>除Oracle Grid Infrastructure和Oracle Database之外，Fleet Patching和Provisioning还支持修补Oracle Exadata组件：数据库节点，存储单元和InfiniBand交换机。</p>
                     <div class="section">第一次使用Fleet Patching and Provisioning修补Oracle Exadata系统时，运行<code class="codeph">rhpctl add workingcopy</code>命令，该命令在Fleet Patching and Provisioning Server上存储Oracle Exadata系统信息（节点列表和上次修补它们的映像） ，在修补所需的Oracle Exadata节点之前。
                     </div>
                     <!-- class="section" -->
                     <div class="section">对于后续修补，请运行<code class="codeph">rhpctl update workingcopy</code>命令。修补后，Fleet Patching和Provisioning会更新节点的图像。
                     </div>
                     <!-- class="section" -->
                     <div class="section">当您为基于<code class="codeph">EXAPATCHSOFTWARE</code>图像类型的工作副本运行<code class="codeph">rhpctl query workingcopy</code>命令时，该命令将返回节点及其图像的列表。
                     </div>
                     <!-- class="section" -->
                     <div class="section">要使用Fleet Patching和Provisioning修补Oracle Exadata：</div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>使用<code class="codeph">rhpctl import image</code>命令<code class="codeph">rhpctl import image</code> <code class="codeph">EXAPATCHSOFTWARE</code>图像类型的<code class="codeph">rhpctl import image</code> ，类似于以下内容：</span><div><pre class="pre codeblock"><code>$ rhpctl import image -image EXA1 -imagetype EXAPATCHSOFTWARE -path / tmp / ExadataPatchBundle -version 12.1.2.2.3.160720</code></pre><div class="infoboxnote" id="GUID-CB42840D-3ECB-4AB4-B338-FD9F0D856AC3__GUID-F8784395-3035-4943-A515-6C32E7F375B2">
                                 <p class="notep1">注意：</p>您必须重命名修补程序zip文件以包含单词<span class="italic">storage</span> ， <span class="italic">database</span>和<span class="italic">iso</span> ，以便Fleet Patching和Provisioning可以区分它们。
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>如果这是您第一次使用Fleet Patching和Provisioning修补Oracle Exadata，请使用<code class="codeph">rhpctl add workingcopy</code>命令，如下所示：</span><div><pre class="pre codeblock"><code>$ rhpctl add workingcopy -image <span class="variable" translate="no">image_name</span> -root {[-dbnodes <span class="variable" translate="no">dbnode_list</span> ] [ <span class="variable" translate="no">cell_list</span> ] [-ibswitches <span class="variable" translate="no">ibswitch_list</span> ]} [-fromnode <span class="variable" translate="no">node_name</span> ] [-unkey] [-smtpfrom“ <span class="variable" translate="no">address</span> ”] [-smtpto“ <span class="variable" translate="no">addresses</span> ”] [ -precheckonly] [-modifyatprereq] [-resetforce] [-force]</code></pre><p>除了节点类型和映像类型之外，上述命令还存储工作副本上的Fleet Patching和Provisioning中的节点列表（数据库节点，单元和InfiniBand交换机）以及每个节点的版本。</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>对于后续修补操作，在使用更新的数据库，存储单元和交换机文件创建黄金映像后，运行<code class="codeph">rhpctl update workingcopy</code>命令以修补一个，两个或所有三个Oracle Exadata组件，如下所示：</span><div><pre class="pre codeblock"><code>$ rhpctl update workingcopy -image <span class="variable" translate="no">image_name</span> -root {[-dbnodes <span class="variable" translate="no">dbnode_list</span> ] [ <span class="variable" translate="no">cell_list</span> ] [-ibswitches <span class="variable" translate="no">ibswitch_list</span> ]} [-fromnode <span class="variable" translate="no">node_name</span> ] [-unkey] [-smtpfrom“ <span class="variable" translate="no">address</span> ”] [-smtpto“ <span class="variable" translate="no">addresses</span> ”] [ -precheckonly] [-modifyatprereq] [-resetforce] [-force]</code></pre><div class="infoboxnote" id="GUID-CB42840D-3ECB-4AB4-B338-FD9F0D856AC3__GUID-BB30A4AA-A344-4C7D-B0A8-7F03A0D2B102">
                                 <p class="notep1">注意：</p>在修补给定的Oracle Exadata目标的整个生命周期中，工作副本的名称保持不变。
                              </div>
                              <p>您可以选择仅修补数据库节点，单元或InfiniBand交换机或三者的任意组合。修补按以下顺序进行：InfiniBand交换机，单元，数据库节点。</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>显示节点及其图像列表，如下所示：</span><div><pre class="pre codeblock"><code>$ rhpctl query workingcopy -workingcopy <span class="variable" translate="no">working_copy_name</span></code></pre></div>
                        </li>
                        <li class="stepexpand"><span>删除工作副本，如下所示：</span><div><pre class="pre codeblock"><code>rhpctl delete workingcopy -workingcopy <span class="variable" translate="no">working_copy_name</span></code></pre></div>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-5282B39C-4D95-4205-A180-ED4D874E2540" title="在Fleet Patching and Provisioning Server上创建映像。">rhpctl导入图片</a></li>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-61929F3C-A50A-45EA-8B4A-D11E245A6493" title="在客户端群集上创建工作副本。">rhpctl添加workingcopy</a></li>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-4CFB9687-A8D7-4AFB-AEE4-F249B9464083" title="更新客户端群集上的工作副本。">rhpctl更新workingcopy</a></li>
                        </ul>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-3EDC1553-8411-4363-BCDC-DF4687AB3D60" name="GUID-3EDC1553-8411-4363-BCDC-DF4687AB3D60"></a><h4 id="CWADD-GUID-3EDC1553-8411-4363-BCDC-DF4687AB3D60" class="sect4">升级Oracle数据库软件</h4>
                  <div>
                     <p>Fleet Patching和Provisioning提供了两个升级Oracle数据库的选项。两个选项都使用单个命令执行。</p>
                     <div class="section"><code class="codeph">rhpctl upgrade database</code>命令执行传统升级，从而导致停机。<code class="codeph">rhpctl zdtupgrade database</code>命令以最少或无停机时间执行Oracle RAC或Oracle RAC One Node升级。
                     </div>
                     <!-- class="section" -->
                     <div class="section">使用<code class="codeph">rhpctl upgrade database</code>命令从Oracle Database <span class="italic">11g第</span> 2版（11.2.0.3和11.2.0.4）升级到Oracle Database 12 <span class="italic">c第</span> 1版（12.1.0.2）。升级到Oracle数据库12 <span class="italic">c</span>释放2（12.2.0.1）从Oracle数据库<span class="italic">11克</span> 2版（11.2.0.3和11.2.0.4）和Oracle数据库12 <span class="italic">c</span>释放1（12.1.0.2）的支持。
                        <div class="infoboxnote" id="GUID-3EDC1553-8411-4363-BCDC-DF4687AB3D60__GUID-6AB1793C-A365-4CB9-8BEC-ED9A83D5E9D4">
                           <p class="notep1">注意：</p>运行升级前数据库的Oracle Grid Infrastructure版本必须与要升级的数据库版本相同或更高。
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="section">升级的目标可以是已配置的工作副本，也可以选择在此操作中创建黄金映像的工作副本。</div>
                     <!-- class="section" -->
                     <div class="section">升级前数据库可以在工作副本（由Fleet Patching and Provisioning配置的托管主页）上运行，也可以在非托管主页上运行。在第一种情况下，您可以使用单个RHPCTL命令回滚升级过程。
                        <div class="infoboxnote" id="GUID-3EDC1553-8411-4363-BCDC-DF4687AB3D60__GUID-732520D0-C464-4C9D-83F1-9F91B902889B">
                           <p class="notep1">注意：</p>完成升级后，您可以随时删除源工作副本。但是，删除工作副本后，无法执行回滚。此外，使用<code class="codeph">rhpctl delete workingcopy</code>命令（例如，与<code class="codeph">rm</code>相反）删除源工作副本以保持Fleet Patching和Provisioning库存正确。
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-926A4D78-0BAB-45EA-B5A4-B9B11BF77374">rhpctl升级数据库</a></li>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-9D6C5016-F10F-42F2-8175-E2D995655C33">rhpctl zdtupgrade数据库</a></li>
                        </ul>
                     </div>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-40D3B039-92D9-4325-908B-C40C7FA9B805" name="GUID-40D3B039-92D9-4325-908B-C40C7FA9B805"></a><h3 id="CWADD-GUID-40D3B039-92D9-4325-908B-C40C7FA9B805" class="sect3">零停机升级</h3>
               <div>
                  <p>使用自动化和协调数据库升级的Fleet Patching和Provisioning，您可以升级Oracle RAC或Oracle RAC One Node数据库，而不会中断服务。</p>
                  <p>如果任何错误中断过程，则零停机升级过程可恢复，可重新启动并可恢复。您可以修复该问题，然后重新运行该命令，并从错误点继续Fleet Patching和Provisioning。Oracle还在零停机时间升级过程的开始和结束时提供挂钩，允许调用用户定义的脚本，以便您可以自定义该过程。</p>
                  <div class="p">您可以使用零停机升级过程来升级满足以下条件的数据库：<ul style="list-style-type:disc">
                        <li>
                           <div class="p"><span class="bold">数据库升级目标</span> ：Oracle RAC和Oracle RAC One节点，具有以下升级路径：<ul class="simple" style="list-style-type:none;padding-left:0">
                                 <li>11 <span class="italic">g第</span> 2版（11.2.0.4）至12 <span class="italic">c第</span> 1版（12.1.0.2）</li>
                                 <li>11 <span class="italic">g第</span> 2版（11.2.0.4）至12 <span class="italic">c第</span> 2版（12.2.0.1）</li>
                                 <li>12 <span class="italic">c</span>版本1（12.1.0.2）至12 <span class="italic">c</span>版本2（12.2.0.1）</li>
                              </ul>
                           </div>
                        </li>
                        <li>
                           <p><span class="bold">Fleet Patching和Provisioning管理</span> ：源数据库home可以是非托管（不由Fleet Patching和Provisioning服务提供）或托管（由Fleet Patching and Provisioning服务提供）</p>
                        </li>
                        <li>
                           <p><span class="bold">数据库状态</span> ：源数据库必须处于归档日志模式</p>
                        </li>
                     </ul>
                  </div>
                  <div class="section">
                     <p class="subhead2" id="GUID-40D3B039-92D9-4325-908B-C40C7FA9B805__GUID-2BACFFCF-CD60-46F8-8D89-96320F477E11">升级容器数据库</p>
                     <p>您可以使用Fleet Patching和Provisioning升级CDB，但Fleet Patching和Provisioning不支持在升级期间将非CDB转换为CDB。要准备零停机升级，请完成配置步骤和验证检查。使用Fleet Patching and Provisioning运行零停机升级时，可以根据需要停止升级并恢复升级。您可以从任何升级错误中恢复，并且可以重新启动升级。您还可以在升级期间插入对自己脚本的调用，以便自定义升级过程。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-40D3B039-92D9-4325-908B-C40C7FA9B805__GUID-80BB3126-AAF4-4210-8874-DC2DDB821D03">零停机升级环境先决条件</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><span class="bold">服务器环境</span> ：带有Fleet补丁和配置的Oracle Grid Infrastructure 18c</p>
                        </li>
                        <li>
                           <div class="p"><span class="bold">数据库主机</span> ：托管在以下平台之一上的数据库：<ul style="list-style-type:disc">
                                 <li>
                                    <p>Oracle Grid Infrastructure 18c Fleet补丁和配置客户端</p>
                                 </li>
                                 <li>
                                    <p>Oracle Grid Infrastructure 18c Fleet补丁和配置服务器</p>
                                 </li>
                                 <li>
                                    <p>Oracle Grid Infrastructure 12 <span class="italic">c</span> （12.2.0.1）Fleet Patching and Provisioning Client</p>
                                 </li>
                                 <li>
                                    <p>Oracle Grid Infrastructure 12 <span class="italic">c</span> （12.1.0.2）目标集群</p>
                                 </li>
                              </ul>
                           </div>
                        </li>
                        <li>
                           <div class="p"><span class="bold">特定于数据库的环境先决条件</span> ：在升级期间，Fleet Patching和Provisioning管理复制到本地数据文件，以便在准备好时保留应用于新数据库的事务。本地数据文件有两种可能性：<ul class="simple" style="list-style-type:none;padding-left:0">
                                 <li>Snap克隆，如果数据库数据文件以及重做和归档重做日志位于Oracle ACFS文件系统上，则可以使用该克隆</li>
                                 <li>完整副本，适用于所有其他情况</li>
                              </ul>
                           </div>
                        </li>
                        <li>
                           <p>在零停机数据库升级期间，Fleet Patching和Provisioning需要Oracle GoldenGate或Oracle Data Guard。作为升级过程的一部分，Fleet Patching和Provisioning配置和管理Oracle GoldenGate部署。</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div>
               <div class="sect3"><a id="GUID-08160350-092E-4546-9B21-C61EBED811B1" name="GUID-08160350-092E-4546-9B21-C61EBED811B1"></a><h4 id="CWADD-GUID-08160350-092E-4546-9B21-C61EBED811B1" class="sect4">使用Oracle GoldenGate进行复制，运行零停机升级</h4>
                  <div>
                     <p>使用Oracle GoldenGate进行零停机升级以进行复制。</p>
                     <div class="p">
                        <ol>
                           <li>
                              <p>准备Fleet Patching和Provisioning Server。</p>
                              <div class="p">在Fleet Patching and Provisioning Server的映像库中创建Oracle GoldenGate软件的黄金映像。
                                 <div class="infoboxnote" id="GUID-08160350-092E-4546-9B21-C61EBED811B1__GUID-52C3558D-4ACA-4B36-B313-23E12F8859BA">
                                    <p class="notep1">注意：</p>您可以从Oracle eDelivery下载适用于您的平台的Oracle GoldenGate软件。所述的Oracle GoldenGate 12.3安装试剂盒含有用于两个Oracle数据库11 <span class="italic">G</span>和Oracle数据库<span class="italic">12c的</span>数据库所需的软件。
                                 </div>
                              </div>
                              <p>如果您下载Oracle GoldenGate软件，则将软件解压缩并在Fleet Patching and Provisioning Server上执行<span class="italic">仅软件</span>安装。
                              </p>
                              <div class="p">为两个数据库创建Oracle GoldenGate软件的黄金映像，如下所示：<pre class="pre codeblock"><code>$ rhpctl import image -image 112ggimage -path <span class="variable" translate="no">path</span> -imagetype ORACLEGGSOFTWARE $ rhpctl import image -image 12ggimage -path <span class="variable" translate="no">path</span> -imagetype ORACLEGGSOFTWARE</code></pre>在上述两个命令中， <code class="codeph"><span class="variable" translate="no">path</span></code>指的是每个版本数据库的Fleet Patching and Provisioning Server上Oracle GoldenGate软件主目录的位置。
                              </div>
                           </li>
                           <li>
                              <p>准备目标数据库。</p>
                              <div class="p">将Oracle GoldenGate软件的工作副本提供给托管数据库的群集，如下所示：<pre class="pre codeblock"><code>$ rhpctl add workingcopy -workingcopy GG_Wcopy_11g -image 112ggimage -user <span class="variable" translate="no">user_name</span> -node <span class="variable" translate="no">12102_cluster_node</span> -path <span class="variable" translate="no">path</span> {-root | -sudouser user_name -sudopath <span class="variable" translate="no">sudo_bin_path</span> } $ rhpctl add workingcopy -workingcopy GG_Wcopy_12c -image 12ggimage -user <span class="variable" translate="no">user_name</span> -node <span class="variable" translate="no">12102_cluster_node</span> -path <span class="variable" translate="no">path</span> {-root | -sudouser user_name -sudopath <span class="variable" translate="no">sudo_bin_path</span> }</code></pre></div>
                              <div class="p">如果数据库本身托管在Fleet Patching and Provisioning Server上，那么<code class="codeph">-targetnode</code>和<code class="codeph">-client</code>参数都不是必需的。
                                 <div class="infoboxnote" id="GUID-08160350-092E-4546-9B21-C61EBED811B1__GUID-9B391F8E-2DD3-4E9B-AC5D-803B091572D2">
                                    <p class="notep1">注意：</p>工作副本名称必须是唯一的，因此您必须在后续目标上使用不同的工作副本名称。您可以通过在工作副本名称中包含目标/客户端群集名称来创建唯一的工作副本名称。
                                 </div>
                              </div>
                           </li>
                           <li>
                              <p>将Oracle Database 12 <span class="italic">c</span>软件的工作副本提供给目标群集。
                              </p>
                           </li>
                        </ol>
                        <div class="infoboxnote" id="GUID-08160350-092E-4546-9B21-C61EBED811B1__GUID-7367A9C2-62C6-4FB9-A192-8FD0B192E92A">
                           <p class="notep1">注意：</p>您可以在维护窗口之前进行此准备，而不会中断目标上发生的任何操作。
                        </div>
                     </div>
                     <!-- class="section" -->
                     <ul>
                        <li class="stepexpand"><span>您可以运行舰队修补和配置服务器上的升级命令升级托管服务器，Oracle数据库<span class="italic">12c的</span>第1版（12.1.0.2）目标群集或数据库托管在一个舰队修补和配置客户端12个<span class="italic">C</span>上的数据库第2版（12.2.0.1）或第18c版。您还可以运行Fleet Patching和Provisioning Client 18c命令来升级客户端上托管的数据库本身。</span><div>使用类似于以下内容的upgrade命令：<pre class="pre codeblock"><code>$ rhpctl zdtupgrade database -dbname sierra -destwc DB_Wcopy_121 -ggsrcwc GG_Wcopy_11g -ggdstwc GG_Wcopy_12c -targetnode <span class="variable" translate="no">12102_cluster_node</span> -root</code></pre><p>在上面的命令， <code class="codeph"><span class="variable" translate="no">12102_cluster_node</span></code>指Oracle网格基础架构12 <span class="italic">c</span>释放1（12.1.0.2）群集主机要升级数据库。
                              </p>
                           </div>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-5282B39C-4D95-4205-A180-ED4D874E2540" title="在Fleet Patching and Provisioning Server上创建映像。">rhpctl导入图片</a></li>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-61929F3C-A50A-45EA-8B4A-D11E245A6493" title="在客户端群集上创建工作副本。">rhpctl添加workingcopy</a></li>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-9D6C5016-F10F-42F2-8175-E2D995655C33" title="为Oracle RAC和Oracle RAC One Node数据库启用零停机数据库升级。">rhpctl zdtupgrade数据库</a></li>
                        </ul>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-9223FCA7-481A-472F-B1FB-EAED510FB63A" name="GUID-9223FCA7-481A-472F-B1FB-EAED510FB63A"></a><h4 id="CWADD-GUID-9223FCA7-481A-472F-B1FB-EAED510FB63A" class="sect4">使用Oracle Data Guard进行复制，从而实现零停机升级</h4>
                  <div>
                     <p>使用Oracle Data Guard进行零停机升级以进行复制。</p>
                     <div class="section">您可以使用Oracle Data Guard的瞬态逻辑备用（TLS）功能运行zero-downtime upgrade命令。所有涉及的步骤都由零停机升级命令编排。</div>
                     <!-- class="section" -->
                     <div class="p">配置目标数据库Home后，必须满足以下先决条件：<ul style="list-style-type:disc">
                           <li>
                              <p>Data Guard Broker未启用</p>
                           </li>
                           <li>
                              <p>已配置闪回恢复区（FRA）</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <ul>
                        <li class="stepexpand"><span>升级零停机的下面的示例使用Oracle数据卫士升级已Oracle数据库<span class="italic">11克</span> 2版（11.2.0.4）， <code class="codeph">sierra</code> ，目标群集，其中包括一个节点上运行的<code class="codeph">targetclust003</code> ，Oracle数据库第12 <span class="italic">C</span>释放1 （12.1.0.2）（目标工作副本，由存储在名为<code class="codeph">rhps.example.com</code>的Fleet Patching and Provisioning Server上的Gold Image提供）：</span><div><pre class="pre codeblock"><code>$ <kbd class="userinput">rhpctl zdtupgrade database -dbname sierra -destwc WC121DB4344 -clonedatadg DBDATA -targetnode node90743 -root</kbd>输入用户“root”密码：node90753.example.com：启动零停机升级操作...node90753.example.com：验证应用于Oracle家庭的补丁...node90753.example.com：验证数据库“sierra”是否可以在零停机时升级...node90743：15：09：10.459：验证数据库“sierra”是否可以克隆...node90743：15：09：10.462：验证数据库“sierra”是否为主数据库...node90743：15：09：14.672：验证是否可以为数据库“sierra”创建连接...&lt;...&gt; node90743：15：14：58.015：开始重做申请......node90743：15：15：07.133：配置主数据库“sierra”......################################################## ################## node90753.example.com：检索有关数据库“xmvotkvd”的信息......node90753.example.com：为快照数据库“xmvotkvd”创建服务...################################################## ################## node90743：15：15：33.640：宏步骤1：获取信息并验证设置...&lt;...&gt; node90743：15：16：02.844：宏步骤2：在中止升级的情况下备份用户环境...node90743：15：16：02.848：停止数据库“xmvotkvd”的媒体恢复...node90743：15：16：05.858：创建初始还原点“NZDRU_0000_0001”...&lt;...&gt; node90743：15：16：17.611：宏步骤3：从现有物理备用数据库创建瞬态逻辑备用数据库...node90743：15：16：18.719：停止数据库“xmvotkvd”的实例“xmvotkvd2”...node90743：15：16：43.187：验证数据库“sierra”是主数据库...&lt;...&gt; node90743：15：19：27.158：宏步骤4：升级瞬态逻辑备用数据库...node90743：15：20：27.272：禁用数据库“xmvotkvd”的服务“sierrasvc”...node90743：16：36：54.684：宏步骤5：验证升级后的瞬态逻辑备用数据库...node90743：16：37：09.576：在阶段“3”和任务“1”期间为数据库“xmvotkvd”创建检查点“NZDRU_0301”...node90743：16：37：09.579：停止数据库“xmvotkvd”的媒体恢复...node90743：16：37：10.792：为数据库“xmvotkvd”创建还原点“NZDRU_0301”...node90743：16：37：11.998：宏步骤6：切换瞬态逻辑备用数据库的角色...node90743：16：37：12.002：验证数据库“sierra”是否为主数据库...&lt;...&gt; node90743：16：39：07.425：宏步骤7：闪回前主数据库以预升级还原点并转换为物理备用...node90743：16：39：08.833：停止数据库“sierra”的实例“sierra2”......&lt;...&gt; node90743：16：41：17.138：宏步骤8：恢复以前的主数据库...node90743：16：41：19.045：验证数据库“sierra”已挂载...&lt;...&gt; node90743：17：20：21.378：宏步骤9：切换回...&lt;...&gt; ############################################## ####################### node90753.example.com：删除快照数据库“xmvotkvd”...</code></pre></div>
                        </li>
                     </ul>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-C24A5EA8-BD8D-4458-BA61-877DDFBE72E7" name="GUID-C24A5EA8-BD8D-4458-BA61-877DDFBE72E7"></a><h4 id="CWADD-GUID-C24A5EA8-BD8D-4458-BA61-877DDFBE72E7" class="sect4">自定义零停机时间升级</h4>
                  <div>
                     <p>您可以使用Fleet Patching and Provisioning的用户 - 操作框架自定义零停机时间升级。</p>
                     <div class="p">要使用用户操作框架，您可以为整个过程中列出的任何或所有点提供单独的脚本。
                        <div class="tblformal" id="GUID-C24A5EA8-BD8D-4458-BA61-877DDFBE72E7__ZERO-DOWNTIMEUPGRADEPLUGINS-34477E2A">
                           <p class="titleintable">表5-3零停机升级插件</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="零停机升级插件" border="1" summary="Describes zero-downtime upgrade plugins." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="20%" id="d25134e9655">插件类型</th>
                                    <th align="left" valign="bottom" width="20%" id="d25134e9657">前或后</th>
                                    <th align="left" valign="bottom" width="20%" id="d25134e9659">插件运行...</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td rowspan="2" align="left" valign="top" width="20%" id="d25134e9663" headers="d25134e9655 "><code class="codeph">ZDTUPGRADE_DATABASE</code></td>
                                    <td align="left" valign="top" width="20%" headers="d25134e9663 d25134e9657 ">
                                       <p>预</p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d25134e9663 d25134e9659 ">
                                       <p>在Fleet Patching and Provisioning开始零停机升级之前。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" headers="d25134e9663 d25134e9657 ">
                                       <p>岗位</p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d25134e9663 d25134e9659 ">
                                       <p>Fleet Patching and Provisioning完成零停机升级后。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td rowspan="2" align="left" valign="top" width="20%" id="d25134e9680" headers="d25134e9655 "><code class="codeph">ZDTUPGRADE_DATABASE_SNAPDB</code></td>
                                    <td align="left" valign="top" width="20%" headers="d25134e9680 d25134e9657 ">
                                       <p>预</p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d25134e9680 d25134e9659 ">
                                       <p>在创建快照或完整克隆数据库之前。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" headers="d25134e9680 d25134e9657 ">
                                       <p>岗位</p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d25134e9680 d25134e9659 ">
                                       <p>启动快照或完整克隆数据库后（但在切换之前）。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td rowspan="2" align="left" valign="top" width="20%" id="d25134e9697" headers="d25134e9655 "><code class="codeph">ZDTUPGRADE_DATABASE_DBUA</code></td>
                                    <td align="left" valign="top" width="20%" headers="d25134e9697 d25134e9657 ">
                                       <p>预</p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d25134e9697 d25134e9659 ">
                                       <p>在运行DBUA之前（切换后）。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" headers="d25134e9697 d25134e9657 ">
                                       <p>岗位</p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d25134e9697 d25134e9659 ">
                                       <p>DBUA完成后。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td rowspan="2" align="left" valign="top" width="20%" id="d25134e9714" headers="d25134e9655 "><code class="codeph">ZDTUPGRADE_DATABASE_SWITCHBACK</code></td>
                                    <td align="left" valign="top" width="20%" headers="d25134e9714 d25134e9657 ">
                                       <p>预</p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d25134e9714 d25134e9659 ">
                                       <p>在将用户切换回升级的源数据库之前。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" headers="d25134e9714 d25134e9657 ">
                                       <p>岗位</p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d25134e9714 d25134e9659 ">
                                       <p>将用户切换回升级后的源数据库（删除快照或完整克隆数据库之前）。</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                     <ul>
                        <li class="stepexpand"><span>要注册要在零停机升级期间运行的插件，请运行以下命令：</span><div><pre class="pre codeblock"><code>$ rhpctl add useraction -useraction <span class="variable" translate="no">user_action_name</span> -actionscript <span class="variable" translate="no">script_name</span> {-pre | -post} -optype {ZDTUPGRADE_DATABASE | ZDTUPGRADE_DATABASE_SNAPDB | ZDTUPGRADE_DATABASE_DBUA | ZDTUPGRADE_DATABASE_SWITCHBACK}</code></pre><p>您可以使用<code class="codeph">rhpctl zdtupgrade database</code>命令的<code class="codeph">-useractiondata</code>选项指定插件的运行时输入。
                              </p>
                           </div>
                        </li>
                     </ul>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-6CDC373B-6261-4BF8-BD60-2E9E2C3E0168" name="GUID-6CDC373B-6261-4BF8-BD60-2E9E2C3E0168"></a><h3 id="CWADD-GUID-6CDC373B-6261-4BF8-BD60-2E9E2C3E0168" class="sect3">修补过程中的持久主路径</h3>
               <div>
                  <p>Oracle在应用更新时建议使用不合适的修补程序。</p>
                  <p>外部修补涉及在新目录路径中部署修补环境，然后将软件切换到新路径。这种方法允许无中断的软件分发，因为现有的家庭在配置新家时仍保持活动状态，并且还便于回滚，因为如果在切换之后出现任何问题，则未修补的软件家庭可用。此外，对于数据库的异地修补，您可以选择将实例的子集移动到新的主页，如果在主页上运行多个实例，而使用就地修补，则必须同时修补所有实例时间。</p>
                  <p>传统的外部修补的潜在障碍是软件主路径发生变化。虽然Fleet Patching and Provisioning在内部和透明地为Oracle数据库和Oracle Grid Infrastructure软件管理，但是一些用户已经开发了依赖于路径的脚本。为了解决这个问题，Fleet Patching and Provisioning使用文件系统功能，可以将黄金映像软件与特定于站点的配置更改分开，因此软件主路径在整个更新过程中都是持久的。</p>
                  <p>此功能适用于Oracle Database 12 <span class="italic">c第</span> 2版（12.2）和Oracle Grid Infrastructure 12 <span class="italic">c第</span> 2版（12.2）在本地存储中配置的工作副本。此外，如果在不使用此功能的情况下配置Oracle Database 12 <span class="italic">c</span>发行版2（12.2）或Oracle Grid Infrastructure 12 <span class="italic">c</span>发行版2（12.2），则在使用<code class="codeph">rhpctl move database</code>或<code class="codeph">rhpctl move gihome</code>命令进行修补操作期间，您可以转换为此配置并利用该功能。
                  </p>
                  <div class="infoboxnote" id="GUID-6CDC373B-6261-4BF8-BD60-2E9E2C3E0168__GUID-CB083092-3523-462B-80B5-714A419C5525">
                     <p class="notep1">注意：</p>您只能在Fleet Patching and Provisioning Client上使用基于Fleet Patching and Provisioning Server的持久主路径的主服务器修补Oracle Grid Infrastructure。
                  </div>
               </div>
            </div><a id="CWADD93066"></a><div class="props_rev_3"><a id="GUID-8D6EC31C-C179-4939-B153-C02F4398C9E0" name="GUID-8D6EC31C-C179-4939-B153-C02F4398C9E0"></a><h3 id="CWADD-GUID-8D6EC31C-C179-4939-B153-C02F4398C9E0" class="sect3">管理车队修补和配置客户端</h3>
               <div>
                  <p>Fleet Patching和Provisioning Client的管理任务包括创建，启用和禁用，创建用户以及为这些用户分配角色以及管理密码。</p>
                  <p>使用SRVCTL和RHPCTL，您可以执行Fleet Patching和Provisioning Client的所有管理任务。</p>
               </div><a id="CWADD92650"></a><div class="props_rev_3"><a id="GUID-E65C9FC4-C8AC-4BF6-A689-A70C70B3A636" name="GUID-E65C9FC4-C8AC-4BF6-A689-A70C70B3A636"></a><h4 id="CWADD-GUID-E65C9FC4-C8AC-4BF6-A689-A70C70B3A636" class="sect4">创建Fleet Patching和Provisioning客户端</h4>
                  <div>
                     <p>用户在Fleet Patching and Provisioning Client上运行，以执行诸如请求部署Oracle主页和查询黄金映像等任务。</p>
                     <div class="section">
                        <p>要创建Fleet Patching和Provisioning客户端：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>如果Fleet Patching and Provisioning Server上没有高可用性VIP（HAVIP），则以<code class="codeph">root</code>用户身份创建HAVIP，如下所示：</span><div><pre class="pre codeblock"><code>#srvctl add havip -id <span class="variable" translate="no">id</span> -address { <span class="variable" translate="no">host_name</span> | <span class="variable" translate="no">ip_address</span> }</code></pre><p>您可以指定主机名或IPv4或IPv6 IP地址。运行此命令时， <span class="italic">不能</span>使用为HAVIP指定的IP地址或从指定主机名解析的地址。
                              </p>
                              <div class="infoboxnote" id="GUID-E65C9FC4-C8AC-4BF6-A689-A70C70B3A636__GUID-66427A78-96F0-4C53-9BE4-A8E25BD634B3">
                                 <p class="notep1">注意：</p>
                                 <p>高可用性VIP必须与Fleet Patching和Provisioning Server群集中配置的默认网络位于同一子网中。您可以通过运行以下命令获取子网：</p><pre class="pre codeblock"><code>$ srvctl config network -netnum <span class="variable" translate="no">network_number</span></code></pre></div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>在作为网格所有者的Fleet Patching和Provisioning Server上，创建客户端数据文件，如下所示：</span><div><pre class="pre codeblock"><code>$ rhpctl add client -client <span class="variable" translate="no">client_cluster_name</span> -toclientdata <span class="variable" translate="no">path</span>
</code></pre><p>RHPCTL在<code class="codeph">-toclientdata</code>标志之后指定的目录路径中创建客户端数据文件。客户端数据文件的名称是<code class="codeph"><span class="variable" translate="no">client_cluster_name</span> .xml</code> 。
                              </p>
                              <div class="infoboxnote" id="GUID-E65C9FC4-C8AC-4BF6-A689-A70C70B3A636__GUID-851AD92A-B2B4-4235-AC50-4500FAAC177B">
                                 <p class="notep1">注意：</p>
                                 <p><code class="codeph"><span class="variable" translate="no">client_cluster_name</span></code>必须是唯一的，并且必须与运行步骤<a href="rapid-home-provisioning.html#GUID-E65C9FC4-C8AC-4BF6-A689-A70C70B3A636__CBBBIDBH">4</a>的客户端群集的群集名称匹配。
                                 </p>
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>将您在上一步中创建的客户端数据文件复制到客户端群集上的目录，该目录对Fleet Patching and Provisioning Client上的Grid主目录具有读/写权限。</span></li>
                        <li class="stepexpand" id="GUID-E65C9FC4-C8AC-4BF6-A689-A70C70B3A636__CBBBIDBH"><span>通过在客户端群集上以<code class="codeph">root</code>身份运行以下命令来创建Fleet Patching和Provisioning Client：</span><div><pre class="pre codeblock"><code>#srvctl add rhpclient -clientdata <span class="variable" translate="no">path_to_client_data</span> [-diskgroup <span class="variable" translate="no">disk_group_name</span> <span class="variable" translate="no">base_path</span> ]</code></pre><p>如果要将工作副本置备到此群集上的Oracle ACFS存储，并且已为此目的创建了磁盘组，请在上述命令中指定此磁盘组。在这种情况下，还要指定一个存储路径，该路径将在创建用于存储工作副本的Oracle ACFS文件系统时用作所有装入点的基本路径。</p>
                              <div class="infoboxnote" id="GUID-E65C9FC4-C8AC-4BF6-A689-A70C70B3A636__GUID-6A053CB3-5CAE-4B12-AFE1-0E45D5DC3398">
                                 <p class="notep1">注意：</p>
                                 <p>在Fleet Patching and Provisioning Client上配置磁盘组后，您无法在Fleet Patching和Provisioning Client配置中将其删除或更改。您可以执行的任务（更改或删除）的唯一方法是使用<code class="codeph">srvctl remove client</code>命令完全删除Fleet Patching和Provisioning Client，然后根据需要将其添加回另一个磁盘组。在删除Fleet Patching和Provisioning Client之前，请确保从此群集中删除所有已注册用户以及在此群集上配置的所有工作副本。
                                 </p>
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>启动Fleet Patching and Provisioning Client，如下所示：</span><div><pre class="pre codeblock"><code>$ srvctl启动rhpclient</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>检查Fleet Patching和Provisioning Client的状态，如下所示：</span><div><pre class="pre codeblock"><code>$ srvctl status rhpclient</code></pre></div>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="../racad/server-control-utility-reference.html#RACAD-GUID-C2D37BAB-DA98-49B4-A777-F2B3AA8D2E7A" target="_blank"><span><cite>“Oracle Real Application Clusters管理和部署指南”</cite></span></a></li>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-66345667-F035-4ADB-A25F-5530299E04B7" title="使用Fleet Patching and Provisioning Control（RHPCTL）实用程序来管理群集中的Fleet Patching和Provisioning。">Fleet Patching and Provisioning Control（RHPCTL）命令参考</a></li>
                        </ul>
                     </div>
                  </div>
               </div><a id="CWADD93067"></a><div class="props_rev_3"><a id="GUID-E9DBA610-DF3C-45F3-9127-070BE602A52E" name="GUID-E9DBA610-DF3C-45F3-9127-070BE602A52E"></a><h4 id="CWADD-GUID-E9DBA610-DF3C-45F3-9127-070BE602A52E" class="sect4">启用和禁用Fleet Patching和Provisioning Client</h4>
                  <div>
                     <p>在Fleet Patching和Provisioning Server上，您可以启用或禁用Fleet Patching和Provisioning Client。</p>
                     <div class="section">
                        <p>Fleet Patching和Provisioning Client与Fleet Patching and Provisioning Server进行通信以进行所有操作。如果没有与Fleet Patching和Provisioning Server的连接，则无法运行任何RHPCTL命令。</p>
                        <p>要启用或禁用Fleet Patching和Provisioning Client，请从Fleet Patching and Provisioning Server集群运行以下命令：</p><pre class="pre codeblock"><code>$ rhpctl modify client -client <span class="variable" translate="no">client_name</span> -enabled TRUE |假</code></pre><p>要启用Fleet Patching和Provisioning Client，请指定<code class="codeph">-enabled TRUE</code> 。相反，指定<code class="codeph">-enabled FALSE</code>以禁用客户端。禁用Fleet Patching和Provisioning Client群集时，Fleet Patching和Provisioning Server将拒绝来自该客户端群集的所有RHPCTL命令，除非您重新启用该客户端。
                        </p>
                        <div class="infoboxnote" id="GUID-E9DBA610-DF3C-45F3-9127-070BE602A52E__GUID-815C0EC2-C183-4C62-8E55-85DA0C3D58B4">
                           <p class="notep1">注意：</p>
                           <p>禁用Fleet Patching和Provisioning Client群集不会禁用客户端群集上的任何现有工作副本。工作副本将继续运行，这些工作副本中的任何数据库将继续运行。</p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-838D76D6-C7BB-4057-BCFE-9ED92139EC42" name="GUID-838D76D6-C7BB-4057-BCFE-9ED92139EC42"></a><h4 id="CWADD-GUID-838D76D6-C7BB-4057-BCFE-9ED92139EC42" class="sect4">删除Fleet Patching和Provisioning Client</h4>
                  <div>
                     <p>使用以下过程删除Fleet Patching和Provisioning Client。</p>
                     <ol>
                        <li class="stepexpand"><span>在删除Fleet Patching and Provisioning Client之前，必须先删除Fleet Patching and Provisioning Server上的工作副本和用户，如下所示：</span><ol type="a">
                              <li class="substepexpand"><span>查询已在Fleet Patching and Provisioning Client群集上配置的工作副本列表。</span><div>
                                    <p>运行以下命令：</p><pre class="pre codeblock"><code>$ rhpctl query workingcopy -client <span class="italic">client_name</span></code></pre></div>
                              </li>
                              <li class="substepexpand"><span>删除上一个命令输出中列出的每个工作副本。</span><div>
                                    <p>对每个工作副本运行以下命令，并指定要删除的工作副本的名称：</p><pre class="pre codeblock"><code>$ rhpctl delete workingcopy -workingcopy <span class="italic">working_copy_name</span></code></pre></div>
                              </li>
                              <li class="substepexpand"><span>从Fleet Patching and Provisioning Client群集中查询用户列表。</span><div>
                                    <p>运行以下命令：</p><pre class="pre codeblock"><code>$ rhpctl query user -client <span class="italic">client_name</span></code></pre></div>
                              </li>
                              <li class="substepexpand"><span>删除上述命令输出中列出的用户，如下所示：</span><div>
                                    <p>运行以下命令并指定要删除的用户的名称和客户端的名称：</p><pre class="pre codeblock"><code>$ rhpctl delete user -user <span class="italic">user_name</span> -client <span class="italic">client_name</span></code></pre></div>
                              </li>
                           </ol>
                        </li>
                        <li class="stepexpand"><span>在Fleet Patching and Provisioning Client群集上，删除客户端，如下所示：</span><ol type="a">
                              <li class="substepexpand"><span>停止Fleet Patching和Provisioning Client守护程序。</span><div>
                                    <p>运行以下命令：</p><pre class="pre codeblock"><code>$ srvctl stop rhpclient</code></pre></div>
                              </li>
                              <li class="substepexpand"><span>删除Fleet Patching和Provisioning Client配置。</span><div>
                                    <p>运行以下命令：</p><pre class="pre codeblock"><code>$ srvctl删除rhpclient</code></pre></div>
                              </li>
                           </ol>
                        </li>
                        <li class="stepexpand"><span>删除Fleet Patching和Provisioning Server群集上的客户端站点配置。<code class="codeph"></code></span><div>
                              <p>运行以下命令并指定客户端的名称：</p><pre class="pre codeblock"><code>$ rhpctl delete client -client <span class="italic">client_name</span></code></pre></div>
                        </li>
                     </ol>
                  </div>
               </div><a id="CWADD93068"></a><div class="props_rev_3"><a id="GUID-43A1B15A-CF4A-4C1F-BFE1-C830CFD4D44F" name="GUID-43A1B15A-CF4A-4C1F-BFE1-C830CFD4D44F"></a><h4 id="CWADD-GUID-43A1B15A-CF4A-4C1F-BFE1-C830CFD4D44F" class="sect4">为Fleet Patching和Provisioning Client Cluster Users创建用户和分配角色</h4>
                  <div>
                     <div class="section">
                        <p>使用<code class="codeph">rhpctl add client</code>命令创建Fleet Patching和Provisioning Client时，可以使用<code class="codeph">-maproles</code>参数创建用户并为其分配角色。您可以将多个用户与角色关联，也可以使用此命令为单个用户分配多个角色。
                        </p>
                        <p>创建客户端后，可以分别使用<code class="codeph">rhpctl grant role</code>命令和<code class="codeph">rhpctl revoke role</code>角色为用户添加和删除角色。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="CWADD93069"></a><div class="props_rev_3"><a id="GUID-8429C5C1-44B7-4FDF-8DCE-B5F536AA2054" name="GUID-8429C5C1-44B7-4FDF-8DCE-B5F536AA2054"></a><h4 id="CWADD-GUID-8429C5C1-44B7-4FDF-8DCE-B5F536AA2054" class="sect4">管理车队修补和配置客户端密码</h4>
                  <div>
                     <div class="section">
                        <p>该<a id="d25134e10885" class="indexterm-anchor"></a> Fleet Patching和Provisioning Client使用内部存储的密码对RHP服务器进行身份验证。您无法查询此密码，但是，如果由于某种原因，您需要重置此密码，则可以在RHP服务器群集上执行此操作，如下所示：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>在Fleet Patching和Provisioning Server群集上运行以下命令以生成新密码并将其存储在客户端凭据中：</span><div><pre class="oac_no_warn" dir="ltr">$ rhpctl修改客户端-client <span class="italic">client_name</span> -password</pre></div>
                        </li>
                        <li class="stepexpand"><span>在Fleet Patching and Provisioning Server集群上运行以下命令以生成凭证文件：</span><div><pre class="oac_no_warn" dir="ltr">$ rhpctl export client -client <span class="italic">client_name</span> -clientdata <span class="italic">file_path</span>
</pre><p>例如，要为名为<code class="codeph">mjk9394</code>的Fleet Patching and Provisioning Client生成凭证文件：</p><pre class="oac_no_warn" dir="ltr">$ rhpctl export client -client mjk9394 -clientdata /tmp/mjk9394.xml</pre></div>
                        </li>
                        <li class="stepexpand"><span>继续前面的示例，将生成的凭据文件安全地传输到Fleet Patching and Provisioning Client集群，然后在Fleet Patching and Provisioning Client集群中的任何节点上运行以下命令：</span><div><pre class="oac_no_warn" dir="ltr">$ srvctl修改rhpclient -clientdata <span class="italic">path_to_mjk9394.xml</span>
</pre></div>
                        </li>
                        <li class="stepexpand"><span>通过在Fleet Patching and Provisioning Client集群上运行以下命令，重新启动Fleet Patching and Provisioning Client守护程序：</span><div><pre class="oac_no_warn" dir="ltr">$ srvctl stop rhpclient $ srvctl start rhpclient</pre></div>
                        </li>
                     </ol>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-A3D8F47A-688B-4404-BAC9-3AFD2DA124BE" name="GUID-A3D8F47A-688B-4404-BAC9-3AFD2DA124BE"></a><h3 id="CWADD-GUID-A3D8F47A-688B-4404-BAC9-3AFD2DA124BE" class="sect3">用户定义的操作</h3>
               <div>
                  <p>您可以为各种Fleet Patching和Provisioning操作创建操作，例如导入映像，添加和删除工作副本，以及添加，删除，移动和升级软件主页。</p>
                  <div class="section">
                     <p>您可以为各种Fleet Patching和Provisioning操作创建操作，例如导入图像，添加和删除黄金映像的工作副本，以及添加，删除，移动和升级软件主页。您可以为每个操作定义不同的操作，这可以通过操作所适用的图像类型进一步区分。用户定义的操作可以在给定操作之前或之后运行，并在运行操作的部署上运行，无论是Fleet Patching还是Provisioning Server，Fleet Patching and Provisioning Client（12 <span class="italic">c</span> release 2（12.2） ），或者没有运行Fleet Patching and Provisioning Client的目标。
                     </p>
                     <p>用户定义的操作是shell脚本，存储在Fleet Patching and Provisioning Server上。脚本运行时，会在命令行上为其提供有关操作的相关信息。此外，您可以将文件与脚本相关联。Fleet Patching和Provisioning Server会将该文件复制到运行脚本的客户端或目标上的相同位置。</p>
                     <p>比如，也许你想创建的数据库升级后运行用户定义的操作，你要定义Oracle数据库11 <span class="italic">g，</span>并且<span class="italic">12c的</span>不同的动作。这需要您定义新的图像类型，如以下示例过程所示。
                     </p>
                     <ol>
                        <li>
                           <p>基于ORACLEDBSOFTWARE图像类型创建新的图像类型（例如<code class="codeph">DB11IMAGE</code> ），如下所示：</p><pre class="pre codeblock"><code>$ rhpctl add imagetype -imagetype DB11IMAGE -basetype ORACLEDBSOFTWARE</code></pre><p>添加或导入Oracle Database 11 <span class="italic">g</span>黄金映像时，请将映像类型指定为<code class="codeph">DB11IMAGE</code> 。</p>
                        </li>
                        <li>
                           <p>定义用户操作并将其与<code class="codeph">DB11IMAGE</code>映像类型和升级操作相关联。您可以在升级之前或之后运行不同的操作。
                           </p>
                        </li>
                        <li>
                           <div class="p">要为Oracle Database 12 <span class="italic">c</span>定义操作，请创建基于ORACLEDBSOFTWARE图像类型的新图像类型（例如<code class="codeph">DB12IMAGE</code> ），如上一步骤，但使用<code class="codeph">DB12IMAGE</code>图像类型。
                              <div class="infoboxnote" id="GUID-A3D8F47A-688B-4404-BAC9-3AFD2DA124BE__GUID-6D2C5185-5278-4E25-9325-D5D2E1E68CC2">
                                 <p class="notep1">注意：</p>如果为用户定义的图像类型的基本类型定义用户操作（在这种情况下，基本类型为ORACLEDBSOFTWARE），则Fleet Patching and Provisioning会在用户定义的图像类型的操作之前执行这些操作。
                              </div>
                           </div>
                        </li>
                     </ol>
                     <p>您可以使用<code class="codeph">rhpctl modify image</code>命令<code class="codeph">rhpctl modify image</code>的图像类型。此外，您还可以修改，添加和删除其他操作。以下两个表（ <a href="rapid-home-provisioning.html#GUID-A3D8F47A-688B-4404-BAC9-3AFD2DA124BE__GUID-8C76537B-0D99-4674-AB59-48B303BDB7EB" title="列出您可以定义的各种Fleet Patching和Provisioning操作及其相关参数。">表5-4</a>和<a href="rapid-home-provisioning.html#GUID-A3D8F47A-688B-4404-BAC9-3AFD2DA124BE__GUID-E7885154-CB30-4E23-BE67-E6C835B1AD71" title="列出并描述可用于各种用户定义操作的参数">表5-5</a> ）分别列出了可以自定义的操作以及可用于定义这些操作的参数。
                     </p>
                     <div class="tblformal" id="GUID-A3D8F47A-688B-4404-BAC9-3AFD2DA124BE__GUID-8C76537B-0D99-4674-AB59-48B303BDB7EB">
                        <p class="titleintable">表5-4 Fleet Patching和Provisioning用户定义的操作</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="Fleet Patching和Provisioning用户定义的操作" border="1" summary="Lists various Fleet Patching and Provisioning operations that you can define, along with their associated parameters." frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="20%" id="d25134e11136">手术</th>
                                 <th align="left" valign="bottom" width="20%" id="d25134e11138">参数列表</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e11142" headers="d25134e11136 "><code class="codeph">IMPORT_IMAGE</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e11142 d25134e11138 ">
                                    <p><code class="codeph">RHP_OPTYPE</code> ， <code class="codeph">RHP_PHASE</code> ， <code class="codeph">RHP_PATH</code> ， <code class="codeph">RHP_PATHOWNER</code> ， <code class="codeph">RHP_PROGRESSLISTENERHOST</code> ， <code class="codeph">RHP_PROGRESSLISTENERPORT</code> ， <code class="codeph">RHP_IMAGE</code> ， <code class="codeph">RHP_IMAGETYPE</code> ， <code class="codeph">RHP_VERSION</code> ， <code class="codeph">RHP_CLI</code> ， <code class="codeph">RHP_USERACTIONDATA</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e11181" headers="d25134e11136 "><code class="codeph">ADD_WORKINGCOPY</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e11181 d25134e11138 ">
                                    <p><code class="codeph">RHP_OPTYPE</code> ， <code class="codeph">RHP_PHASE</code> ， <code class="codeph">RHP_WORKINGCOPY</code> ， <code class="codeph">RHP_PATH</code> ， <code class="codeph">RHP_STORAGETYPE</code> ， <code class="codeph">RHP_USER</code> ， <code class="codeph">RHP_NODES</code> ， <code class="codeph">RHP_ORACLEBASE</code> ， <code class="codeph">RHP_DBNAME</code> ， <code class="codeph">RHP_PROGRESSLISTENERHOST</code> ， <code class="codeph">RHP_PROGRESSLISTENERPORT</code> ， <code class="codeph">RHP_IMAGE</code> ， <code class="codeph">RHP_IMAGETYPE</code> ， <code class="codeph">RHP_VERSION</code> ， <code class="codeph">RHP_CLI</code> ， <code class="codeph">RHP_USERACTIONDATA</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e11236" headers="d25134e11136 "><code class="codeph">ADD_DATABASE</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e11236 d25134e11138 ">
                                    <p><code class="codeph">RHP_OPTYPE</code> ， <code class="codeph">RHP_PHASE</code> ， <code class="codeph">RHP_WORKINGCOPY</code> ， <code class="codeph">RHP_CLIENT</code> ， <code class="codeph">RHP_DBNAME</code> ， <code class="codeph">RHP_PROGRESSLISTENERHOST</code> ， <code class="codeph">RHP_PROGRESSLISTENERPORT</code> ， <code class="codeph">RHP_IMAGE</code> ， <code class="codeph">RHP_IMAGETYPE</code> ， <code class="codeph">RHP_VERSION</code> ， <code class="codeph">RHP_CLI</code> ， <code class="codeph">RHP_USERACTIONDATA</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e11278" headers="d25134e11136 "><code class="codeph">DELETE_WORKINGCOPY</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e11278 d25134e11138 ">
                                    <p><code class="codeph">RHP_OPTYPE</code> ， <code class="codeph">RHP_PHASE</code> ， <code class="codeph">RHP_WORKINGCOPY</code> ， <code class="codeph">RHP_CLIENT</code> ， <code class="codeph">RHP_PATH</code> ， <code class="codeph">RHP_PROGRESSLISTENERHOS</code> ， <code class="codeph">RHP_PROGRESSLISTENERPORT</code> ， <code class="codeph">RHP_IMAGE</code> ， <code class="codeph">RHP_IMAGETYPE</code> ， <code class="codeph">RHP_VERSION</code> ， <code class="codeph">RHP_CLI</code> ， <code class="codeph">RHP_USERACTIONDATA</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e11320" headers="d25134e11136 "><code class="codeph">DELETE_DATABASE</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e11320 d25134e11138 ">
                                    <p><code class="codeph">RHP_OPTYPE</code> ， <code class="codeph">RHP_PHASE</code> ， <code class="codeph">RHP_WORKINGCOPY</code> ， <code class="codeph">RHP_CLIENT</code> ， <code class="codeph">RHP_DBNAME</code> ， <code class="codeph">RHP_PROGRESSLISTENERHOST</code> ， <code class="codeph">RHP_PROGRESSLISTENERPORT</code> ， <code class="codeph">RHP_IMAGE</code> ， <code class="codeph">RHP_IMAGETYPE</code> ， <code class="codeph">RHP_VERSION</code> ， <code class="codeph">RHP_CLI</code> ， <code class="codeph">RHP_USERACTIONDATA</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e11362" headers="d25134e11136 "><code class="codeph">MOVE_GIHOME</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e11362 d25134e11138 ">
                                    <p><code class="codeph">RHP_OPTYPE</code> ， <code class="codeph">RHP_PHASE</code> ， <code class="codeph">RHP_SOURCEWC</code> ， <code class="codeph">RHP_SOURCEPATH</code> ， <code class="codeph">RHP_DESTINATIONWC</code> ， <code class="codeph">RHP_DESTINATIONPATH</code> ， <code class="codeph">RHP_IMAGE</code> ， <code class="codeph">RHP_IMAGETYPE</code> ， <code class="codeph">RHP_PROGRESSLISTENERHOS</code> ， <code class="codeph">RHP_PROGRESSLISTENERPORT</code> ， <code class="codeph">RHP_VERSION</code> ， <code class="codeph">RHP_CL</code> ， <code class="codeph">RHP_USERACTIONDATA</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e11408" headers="d25134e11136 "><code class="codeph">MOVE_DATABASE</code><p>对修补操作中涉及的每个数据库运行此用户操作。</p>
                                    <p>如果运行范围设置为<code class="codeph">ALLNODES</code> ，则为每个群集节点上的每个数据库运行脚本。
                                    </p>
                                    <p>如果运行范围设置为<code class="codeph">ONENODE</code> ，则为应用于数据库的节点上的每个数据库运行脚本。
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d25134e11408 d25134e11138 ">
                                    <p><code class="codeph">RHP_OPTYPE</code> ， <code class="codeph">RHP_PHASE</code> ， <code class="codeph">RHP_SOURCEWC</code> ， <code class="codeph">RHP_SOURCEPATH</code> ， <code class="codeph">RHP_DESTINATIONWC</code> ， <code class="codeph">RHP_DESTINATIONPATH</code> ， <code class="codeph">RHP_DBNAME</code> ， <code class="codeph">RHP_IMAGE</code> ， <code class="codeph">RHP_IMAGETYPE</code> ， <code class="codeph">RHP_PROGRESSLISTENERHOST</code> ， <code class="codeph">RHP_PROGRESSLISTENERPORT</code> ， <code class="codeph">RHP_VERSION</code> ， <code class="codeph">RHP_CLI</code> ， <code class="codeph">RHP_DATAPATCH</code> ， <code class="codeph">RHP_USERACTIONDATA</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e11472" headers="d25134e11136 "><code class="codeph">UPGRADE_GIHOME</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e11472 d25134e11138 ">
                                    <p><code class="codeph">RHP_OPTYPE</code> ， <code class="codeph">RHP_PHASE</code> ， <code class="codeph">RHP_SOURCEWC</code> ， <code class="codeph">RHP_SOURCEPATH</code> ， <code class="codeph">RHP_DESTINATIONWC</code> ， <code class="codeph">RHP_DESTINATIONPATH</code> ， <code class="codeph">RHP_IMAGE</code> ， <code class="codeph">RHP_IMAGETYPE</code> ， <code class="codeph">RHP_PROGRESSLISTENERHOST</code> ， <code class="codeph">RHP_PROGRESSLISTENERPORT</code> ， <code class="codeph">RHP_VERSION</code> ， <code class="codeph">RHP_CLI</code> ， <code class="codeph">RHP_USERACTIONDATA</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e11518" headers="d25134e11136 "><code class="codeph">UPGRADE_DATABASE</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e11518 d25134e11138 ">
                                    <p><code class="codeph">RHP_OPTYPE</code> ， <code class="codeph">RHP_PHASE</code> ， <code class="codeph">RHP_SOURCEWC</code> ， <code class="codeph">RHP_SOURCEPATH</code> ， <code class="codeph">RHP_DESTINATIONWC</code> ， <code class="codeph">RHP_DESTINATIONPATH</code> ， <code class="codeph">RHP_DBNAME</code> ， <code class="codeph">RHP_IMAGE</code> ， <code class="codeph">RHP_IMAGETYPE</code> ， <code class="codeph">RHP_PROGRESSLISTENERHOST</code> ， <code class="codeph">RHP_PROGRESSLISTENERPORT</code> ， <code class="codeph">RHP_VERSION</code> ， <code class="codeph">RHP_CLI</code> ， <code class="codeph">RHP_USERACTIONDATA</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e11567" headers="d25134e11136 "><code class="codeph">ADDNODE_DATABASE</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e11567 d25134e11138 ">
                                    <p><code class="codeph">RHP_OPTYPE</code> ， <code class="codeph">RHP_PHASE</code> ， <code class="codeph">RHP_WORKINGCOPY</code> ， <code class="codeph">RHP_CLIENT</code> ， <code class="codeph">RHP_DBNAME</code> ， <code class="codeph">RHP_PROGRESSLISTENERHOST</code> ， <code class="codeph">RHP_PROGRESSLISTENERPORT</code> ， <code class="codeph">RHP_IMAGE</code> ， <code class="codeph">RHP_IMAGETYPE</code> ， <code class="codeph">RHP_VERSION</code> ， <code class="codeph">RHP_CLI</code> ， <code class="codeph">RHP_USERACTIONDATA</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e11609" headers="d25134e11136 "><code class="codeph">DELETENODE_DATABASE</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e11609 d25134e11138 ">
                                    <p><code class="codeph">RHP_OPTYPE</code> ， <code class="codeph">RHP_PHASE</code> ， <code class="codeph">RHP_WORKINGCOPY</code> ， <code class="codeph">RHP_CLIENT</code> ， <code class="codeph">RHP_DBNAME</code> ， <code class="codeph">RHP_PROGRESSLISTENERHOST</code> ， <code class="codeph">RHP_PROGRESSLISTENERPORT</code> ， <code class="codeph">RHP_IMAGE</code> ， <code class="codeph">RHP_IMAGETYPE</code> ， <code class="codeph">RHP_VERSION</code> ， <code class="codeph">RHP_CLI</code> ， <code class="codeph">RHP_USERACTIONDATA</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e11652" headers="d25134e11136 "><code class="codeph">ADDNODE_GIHOME</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e11652 d25134e11138 ">
                                    <p><code class="codeph">RHP_OPTYPE</code> ， <code class="codeph">RHP_PHASE</code> ， <code class="codeph">RHP_WORKINGCOPY</code> ， <code class="codeph">RHP_CLIENT</code> ， <code class="codeph">RHP_PATH</code> ， <code class="codeph">RHP_PROGRESSLISTENERHOST</code> ， <code class="codeph">RHP_PROGRESSLISTENERPORT</code> ， <code class="codeph">RHP_IMAGE</code> ， <code class="codeph">RHP_IMAGETYPE</code> ， <code class="codeph">RHP_VERSION</code> ， <code class="codeph">RHP_CLI</code> ， <code class="codeph">RHP_USERACTIONDATA</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e11694" headers="d25134e11136 "><code class="codeph">DELETENODE_GIHOME</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e11694 d25134e11138 ">
                                    <p><code class="codeph">RHP_OPTYPE</code> ， <code class="codeph">RHP_PHASE</code> ， <code class="codeph">RHP_WORKINGCOPY</code> ， <code class="codeph">RHP_CLIENT</code> ， <code class="codeph">RHP_PATH</code> ， <code class="codeph">RHP_PROGRESSLISTENERHOST</code> ， <code class="codeph">RHP_PROGRESSLISTENERPORT</code> ， <code class="codeph">RHP_IMAGE</code> ， <code class="codeph">RHP_IMAGETYPE</code> ， <code class="codeph">RHP_VERSION</code> ， <code class="codeph">RHP_CLI</code> ， <code class="codeph">RHP_USERACTIONDATA</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e11736" headers="d25134e11136 "><code class="codeph">ADDNODE_WORKINGCOPY</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e11736 d25134e11138 ">
                                    <p><code class="codeph">RHP_OPTYPE</code> ， <code class="codeph">RHP_PHASE</code> ， <code class="codeph">RHP_WORKINGCOPY</code> ， <code class="codeph">RHP_CLIENT</code> ， <code class="codeph">RHP_PATH</code> ， <code class="codeph">RHP_PROGRESSLISTENERHOST</code> ， <code class="codeph">RHP_PROGRESSLISTENERPORT</code> ， <code class="codeph">RHP_IMAGE</code> ， <code class="codeph">RHP_IMAGETYPE</code> ， <code class="codeph">RHP_VERSION</code> ， <code class="codeph">RHP_CLI</code> ， <code class="codeph">RHP_USERACTIONDATA</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e11778" headers="d25134e11136 "><code class="codeph">ZDTUPGRADE_DATABASE</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e11778 d25134e11138 ">
                                    <p><code class="codeph">RHP_OPTYPE</code> ， <code class="codeph">RHP_PHASE</code> ， <code class="codeph">RHP_SOURCEWC</code> ， <code class="codeph">RHP_SOURCEPATH</code> ， <code class="codeph">RHP_DESTINATIONWC</code> ， <code class="codeph">RHP_DESTINATIONPATH</code> ， <code class="codeph">RHP_SRCGGWC</code> ， <code class="codeph">RHP_SRCGGPATH</code> ， <code class="codeph">RHP_DSTGGWC</code> ， <code class="codeph">RHP_DSTGGPATH</code> ， <code class="codeph">RHP_DBNAME</code> ， <code class="codeph">RHP_IMAGE</code> ， <code class="codeph">RHP_IMAGETYPE</code> ， <code class="codeph">RHP_PROGRESSLISTENERHOST</code> ， <code class="codeph">RHP_PROGRESSLISTENERPORT</code> ， <code class="codeph">RHP_VERSION</code> ， <code class="codeph">RHP_CLI</code> ， <code class="codeph">RHP_USERACTIONDATA</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e11839" headers="d25134e11136 "><code class="codeph">ZDTUPGRADE_DATABASE_SNAPDB</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e11839 d25134e11138 ">
                                    <p><code class="codeph">RHP_OPTYPE</code> ， <code class="codeph">RHP_PHASE</code> ， <code class="codeph">RHP_SOURCEWC</code> ， <code class="codeph">RHP_SOURCEPATH</code> ， <code class="codeph">RHP_DESTINATIONWC</code> ， <code class="codeph">RHP_DESTINATIONPATH</code> ， <code class="codeph">RHP_SRCGGWC</code> ， <code class="codeph">RHP_SRCGGPATH</code> ， <code class="codeph">RHP_DSTGGWC</code> ， <code class="codeph">RHP_DSTGGPATH</code> ， <code class="codeph">RHP_DBNAME</code> ， <code class="codeph">RHP_IMAGE</code> ， <code class="codeph">RHP_IMAGETYPE</code> ， <code class="codeph">RHP_PROGRESSLISTENERHOST</code> ， <code class="codeph">RHP_PROGRESSLISTENERPORT</code> ， <code class="codeph">RHP_VERSION</code> ， <code class="codeph">RHP_CLI</code> ， <code class="codeph">RHP_USERACTIONDATA</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e11900" headers="d25134e11136 "><code class="codeph">ZDTUPGRADE_DATABASE_DBUA</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e11900 d25134e11138 ">
                                    <p><code class="codeph">RHP_OPTYPE</code> ， <code class="codeph">RHP_PHASE</code> ， <code class="codeph">RHP_SOURCEWC</code> ， <code class="codeph">RHP_SOURCEPATH</code> ， <code class="codeph">RHP_DESTINATIONWC</code> ， <code class="codeph">RHP_DESTINATIONPATH</code> ， <code class="codeph">RHP_SRCGGWC</code> ， <code class="codeph">RHP_SRCGGPATH</code> ， <code class="codeph">RHP_DSTGGWC</code> ， <code class="codeph">RHP_DSTGGPATH</code> ， <code class="codeph">RHP_DBNAME</code> ， <code class="codeph">RHP_IMAGE</code> ， <code class="codeph">RHP_IMAGETYPE</code> ， <code class="codeph">RHP_PROGRESSLISTENERHOST</code> ， <code class="codeph">RHP_PROGRESSLISTENERPORT</code> ， <code class="codeph">RHP_VERSION</code> ， <code class="codeph">RHP_CLI</code> ， <code class="codeph">RHP_USERACTIONDATA</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e11961" headers="d25134e11136 "><code class="codeph">ZDTUPGRADE_DATABASE_SWITCHBACK</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e11961 d25134e11138 ">
                                    <p><code class="codeph">RHP_OPTYPE</code> ， <code class="codeph">RHP_PHASE</code> ， <code class="codeph">RHP_SOURCEWC</code> ， <code class="codeph">RHP_SOURCEPATH</code> ， <code class="codeph">RHP_DESTINATIONWC</code> ， <code class="codeph">RHP_DESTINATIONPATH</code> ， <code class="codeph">RHP_SRCGGWC</code> ， <code class="codeph">RHP_SRCGGPATH</code> ， <code class="codeph">RHP_DSTGGWC</code> ， <code class="codeph">RHP_DSTGGPATH</code> ， <code class="codeph">RHP_DBNAME</code> ， <code class="codeph">RHP_IMAGE</code> ， <code class="codeph">RHP_IMAGETYPE</code> ， <code class="codeph">RHP_PROGRESSLISTENERHOST</code> ， <code class="codeph">RHP_PROGRESSLISTENERPORT</code> ， <code class="codeph">RHP_VERSION</code> ， <code class="codeph">RHP_CLI</code> ， <code class="codeph">RHP_USERACTIONDATA</code></p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <div class="tblformal" id="GUID-A3D8F47A-688B-4404-BAC9-3AFD2DA124BE__GUID-E7885154-CB30-4E23-BE67-E6C835B1AD71">
                        <p class="titleintable">表5-5用户定义的操作参数</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="用户定义的操作参数" border="1" summary="Lists and describes the parameters you can use with various user-defined operations" frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="20%" id="d25134e12031">参数</th>
                                 <th align="left" valign="bottom" width="20%" id="d25134e12033">描述</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e12037" headers="d25134e12031 "><code class="codeph">RHP_OPTYPE</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e12037 d25134e12033 ">
                                    <p>正在执行用户操作的操作类型，如上表中所列。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e12044" headers="d25134e12031 "><code class="codeph">RHP_PHASE</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e12044 d25134e12033 ">
                                    <p>此参数指示用户操作是在操作之前还是之后执行（是PRE还是POST）。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e12051" headers="d25134e12031 "><code class="codeph">RHP_SOURCEWC</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e12051 d25134e12033 ">
                                    <p>升级操作补丁的源工作副本名称。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e12058" headers="d25134e12031 "><code class="codeph">RHP_SOURCEPATH</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e12058 d25134e12033 ">
                                    <p>源工作副本回家的路径。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e12065" headers="d25134e12031 "><code class="codeph">RHP_DESTINATIONWC</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e12065 d25134e12033 ">
                                    <p>修补程序或升级操作的目标工作副本名称。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e12072" headers="d25134e12031 "><code class="codeph">RHP_DESTINATIONPATH</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e12072 d25134e12033 ">
                                    <p>目的地工作副本回家的路径。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e12079" headers="d25134e12031 "><code class="codeph">RHP_SRCGGWC</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e12079 d25134e12033 ">
                                    <p>要升级的Oracle GoldenGate工作副本的版本名称。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e12086" headers="d25134e12031 "><code class="codeph">RHP_SRCGGPATH</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e12086 d25134e12033 ">
                                    <p>要升级的Oracle GoldenGate软件主目录版本的绝对路径。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e12093" headers="d25134e12031 "><code class="codeph">RHP_DESTGGWC</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e12093 d25134e12033 ">
                                    <p>要升级的Oracle GoldenGate工作副本的版本名称。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e12100" headers="d25134e12031 "><code class="codeph">RHP_DESTGGPATH</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e12100 d25134e12033 ">
                                    <p>要升级的Oracle GoldenGate软件主目录版本的绝对路径。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e12107" headers="d25134e12031 "><code class="codeph">RHP_PATH</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e12107 d25134e12033 ">
                                    <p>这是软件主页位置的路径。此参数表示为<code class="codeph">IMPORT_IMAGE</code>操作运行RHPCTL命令的本地节点上的路径。对于所有其他操作，此路径存在于进行操作的站点上。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e12118" headers="d25134e12031 "><code class="codeph">RHP_PATHOWNER</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e12118 d25134e12033 ">
                                    <p>正在导入的黄金映像的路径的所有者。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e12125" headers="d25134e12031 "><code class="codeph">RHP_PROGRESSLISTENERHOST</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e12125 d25134e12033 ">
                                    <p>进度监听器正在侦听的主机。您可以将此参数与进度侦听器端口一起使用，以创建TCP连接，以将输出打印到运行RHPCTL命令的控制台。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e12132" headers="d25134e12031 "><code class="codeph">RHP_PROGRESSLISTENERPORT</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e12132 d25134e12033 ">
                                    <p>进度侦听器主机正在侦听的端口。您可以将此参数与进度侦听器主机名一起使用，以创建TCP连接，以将输出打印到运行RHPCTL命令的控制台。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e12139" headers="d25134e12031 "><code class="codeph">RHP_IMAGE</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e12139 d25134e12033 ">
                                    <p>与操作关联的图像。在移动操作的情况下，它将反映目标图像的名称。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e12146" headers="d25134e12031 "><code class="codeph">RHP_IMAGETYPE</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e12146 d25134e12033 ">
                                    <p>与操作关联的图像的图像类型。在移动操作的情况下，它将反映目标图像的名称。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e12153" headers="d25134e12031 "><code class="codeph">RHP_VERSION</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e12153 d25134e12033 ">
                                    <p>在Fleet Patching and Provisioning Server上运行的Oracle Grid Infrastructure软件版本。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e12160" headers="d25134e12031 "><code class="codeph">RHP_CLI</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e12160 d25134e12033 ">
                                    <p>用于调用操作的确切命令。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e12167" headers="d25134e12031 "><code class="codeph">RHP_STORAGETYPE</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e12167 d25134e12033 ">
                                    <p>家庭的存储类型（ <code class="codeph">LOCAL</code>或<code class="codeph">RHP_MANAGED</code> ）</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e12180" headers="d25134e12031 "><code class="codeph">RHP_USER</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e12180 d25134e12033 ">
                                    <p>正在执行操作的用户。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e12187" headers="d25134e12031 "><code class="codeph">RHP_NODES</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e12187 d25134e12033 ">
                                    <p>将在其上创建数据库的节点。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e12194" headers="d25134e12031 "><code class="codeph">RHP_ORACLEBASE</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e12194 d25134e12033 ">
                                    <p>配置主目录的Oracle基本位置。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e12202" headers="d25134e12031 "><code class="codeph">RHP_DBNAME</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e12202 d25134e12033 ">
                                    <p>要创建的数据库的名称。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e12209" headers="d25134e12031 "><code class="codeph">RHP_CLIENT</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e12209 d25134e12033 ">
                                    <p>客户端群集的名称。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e12216" headers="d25134e12031 "><code class="codeph">RHP_DATAPATCH</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e12216 d25134e12033 ">
                                    <p>在移动数据库操作完成后将运行SQL修补程序的节点上的用户操作结束时，此参数设置为TRUE。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e12223" headers="d25134e12031 "><code class="codeph">RHP_USERACTIONDATA</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e12223 d25134e12033 ">
                                    <p>此参数存在于所有操作中，用于在运行时将用户定义的项作为参数传递给用户操作。</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-A3D8F47A-688B-4404-BAC9-3AFD2DA124BE__GUID-BBE81842-CC48-4BD4-A912-BFB13E42C3D0">用户定义的操作示例</p>
                     <p>假设有一个映像类型<code class="codeph">APACHESW</code>用于配置和管理Apache部署。也假设有一个Apache的Gold Image名为<code class="codeph">apacheinstall</code> 。以下示例显示如何创建将在配置Apache Gold Image的任何副本之前运行的用户操作。
                     </p>
                     <p>以下是名为<code class="codeph">addapache_useraction.sh</code>的示例用户操作脚本：</p><pre class="pre codeblock"><code>$ cat /scratch/apacheadmin/addapache_useraction.sh#！/ bin / sh #refer参数使用参数名称touch /tmp/SAMPLEOUT.txt; for i in“$ @”do export $ i done echo“OPTYPE = $ RHP_OPTYPE”&gt;&gt; /tmp/SAMPLEOUT.txt; echo“PHASE = $ RHP_PHASE”&gt;&gt; /tmp/SAMPLEOUT.txt; echo“WORKINGCOPY = $ RHP_WORKINGCOPY”&gt;&gt; /tmp/SAMPLEOUT.txt; echo“PATH = $ RHP_PATH”&gt;&gt; /tmp/SAMPLEOUT.txt; echo“STORAGETYPE = $ RHP_STORAGETYPE”&gt;&gt; /tmp/SAMPLEOUT.txt; echo“USER = $ RHP_USER”&gt;&gt; /tmp/SAMPLEOUT.txt; echo“NODES = $ RHP_NODES”&gt;&gt; /tmp/SAMPLEOUT.txt; echo“ORACLEBASE = $ RHP_ORACLEBASE”&gt;&gt; /tmp/SAMPLEOUT.txt; echo“DBNAME = $ RHP_DBNAME”&gt;&gt; /tmp/SAMPLEOUT.txt; echo“PROGRESSLISTENERHOST = $ RHP_PROGRESSLISTENERHOST”&gt;&gt; /tmp/SAMPLEOUT.txt; echo“PROGRESSLISTENERPORT = $ RHP_PROGRESSLISTENERPORT”&gt;&gt; /tmp/SAMPLEOUT.txt; echo“IMAGE = $ RHP_IMAGE”&gt;&gt; /tmp/SAMPLEOUT.txt; echo“IMAGETYPE = $ RHP_IMAGETYPE”&gt;&gt; /tmp/SAMPLEOUT.txt; echo“RHPVERSION = $ RHP_VERSION”&gt;&gt; /tmp/SAMPLEOUT.txt; echo“CLI = $ RHP_CLI”&gt;&gt; /tmp/SAMPLEOUT.txt; echo“USERACTIONDATA = $ RHP_USERACTIONDATA”&gt;&gt; /tmp/SAMPLEOUT.txt; $</code></pre><p>该脚本已注册为在<code class="codeph">rhpctl add workingcopy</code>命令的开头运行。如果脚本失败，则添加工作副本操作将中止。
                     </p>
                     <p>以下命令创建名为addapachepre的用户操作：</p><pre class="pre codeblock"><code>$ rhpctl add useraction -optype ADD_WORKINGCOPY -pre -onerror ABORT -useraction addapachepre -actionscript /scratch/apacheadmin/addapache_useraction.sh -runscope ONENODE</code></pre><p>以下命令为<code class="codeph">APACHESW</code>映像类型注册用户操作：</p><pre class="pre codeblock"><code>$ rhpctl modify imagetype -imagetype APACHESW -useractions addapachepre</code></pre><p>在部署APACHESW类型的任何映像的工作副本的命令的开头，将自动调用注册的用户操作，如下所示：</p><pre class="pre codeblock"><code>$ rhpctl add workingcopy -workingcopy apachecopy001 -image apacheinstall -path / scratch / apacheadmin / apacheinstallloc -sudouser apacheadmin -sudopath / usr / local / bin / sudo -node targetnode003 -user apacheadmin -useractiondata“sample”</code></pre><p>示例脚本创建<code>/tmp/SAMPLEOUT.txt</code>输出文件。根据示例命令，输出文件包含：</p><pre class="pre codeblock"><code>$ cat /tmp/SAMPLEOUT.txt OPTYPE = ADD_WORKINGCOPY PHASE = PRE WORKINGCOPY = apachecopy001 PATH = / scratch / apacheadmin / apacheinstallloc STORAGETYPE = USER = apacheadmin NODES = targetnode003 ORACLEBASE = DBNAME = PROGRESSLISTENERHOST = mds11042003.my.company.com PROGRESSLISTENERPORT = 58068 IMAGE = apacheinstall IMAGETYPE = APACHESW RHPVERSION = 12.2.0.1.0 CLI = rhpctl__add__workingcopy __- image__apacheinstall __- path __ / scratch / apacheadmin / apacheinstallloc __- node__targetnode003 __- useractiondata__sample__ -sudopath __ / usr / local / bin / sudo __- workingcopy__apachecopy __- user__apacheadmin__ -sudouser__apacheadmin__USERACTIONDATA = sample $</code></pre><div class="infoboxnote" id="GUID-A3D8F47A-688B-4404-BAC9-3AFD2DA124BE__GUID-929E539E-023C-4C7B-868D-D36A23FB1384">
                        <p class="notep1">笔记：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>在前面的输出示例中，空值以等号（ <code class="codeph">=</code> ）终止。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">RHP_CLI</code>参数的命令行值中的<code class="codeph">RHP_CLI</code>将替换为两个下划线字符（ <code class="codeph">__</code> ），以将其与其他参数区分开来。
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
            <div class="sect2"><a id="GUID-56298658-5135-4FE1-AC94-31C9339B3A90" name="GUID-56298658-5135-4FE1-AC94-31C9339B3A90"></a><h3 id="CWADD-GUID-56298658-5135-4FE1-AC94-31C9339B3A90" class="sect3">操作的Job Scheduler</h3>
               <div>
                  <p>Fleet Patching和Provisioning作业调度程序为您提供了一种机制，用于在预定时间提交操作，而不是立即运行命令，查询作业的元数据，然后从存储库中删除作业。</p>
                  <div class="p">Fleet Patching and Provisioning作业调度程序包括以下功能：<ul style="list-style-type:disc">
                        <li>
                           <p>使您能够通过提供时间值来安排在特定时间点运行的命令</p>
                        </li>
                        <li>
                           <p>执行作业并存储作业的元数据以及作业的当前状态</p>
                        </li>
                        <li>
                           <p>存储已运行或正在运行的每个作业的日志</p>
                        </li>
                        <li>
                           <p>使您可以查询作业详细信息（针对所有作业或基于用户角色的特定作业）</p>
                        </li>
                        <li>
                           <p>删除工作</p>
                        </li>
                        <li>
                           <p>根据用户的基于角色的访问权限，授权运行，查询和删除作业</p>
                        </li>
                     </ul>
                  </div>
                  <div class="p">使用<code class="codeph">-schedule <span class="variable" translate="no">timer_value</span></code>命令参数和以下任何RHPCTL命令来安排某些Rapid Hope Provisioning操作：<ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">rhpctl添加workingcopy</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">rhpctl导入图片</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">rhpctl删除图片</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">rhpctl添加数据库</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">rhpctl移动gihome</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">rhpctl移动数据库</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">rhpctl升级数据库</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">rhpctl addnode数据库</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">rhpctl deletenode数据库</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">rhpctl删除workingcopy</code></p>
                        </li>
                     </ul>
                  </div>
                  <div class="p">例如：<pre class="pre codeblock"><code>$ rhpctl add workingcopy -workingcopy 18_3 -image 18_3_Base -oraclebase / u01 / app / oracle -schedule 2016-12-21T19：13：17 + 05</code></pre></div>
                  <p>根据ISO-8601值，所有命令均以服务器时区为参考运行，RHPCTL通过指定相同时区显示命令结果。</p>
                  <p><span class="bold">命令结果</span></p>
                  <p>RHPCTL存储从Fleet Patching and Provisioning Server上的命令队列运行的任何命令。通过指定命令标识符查询命令结果时，RHPCTL将返回作业输出文件的路径以及结果。</p>
                  <p><span class="bold">工作操作</span></p>
                  <p>使用<code class="codeph">-schedule</code>参数运行RHPCTL命令时，该操作将创建具有唯一作业ID的作业，您可以查询该作业以获取作业的状态。
                  </p>
                  <p><span class="bold">工作状态</span></p>
                  <div class="p">在任何时间点，作业都可以处于以下任何状态：<pre class="pre codeblock"><code>执行| TIMER_RUNNING |执行|未知| TERMINATED</code></pre><ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">EXECUTED</code> ：工作完成。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">TIMER_RUNNING</code> ：作业的计时器仍在运行。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">EXECUTING</code> ：作业的计时器已过期且正在运行。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">UNKNOWN</code> ：由于目标停机，节点停机或任何资源故障等问题导致意外故障。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">TERMINATED</code> ：突然发生故障或操作已停止。
                           </p>
                        </li>
                     </ul>
                  </div>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-5E020245-CBE8-4B0E-AAD9-7D5305CDABDB" title="从存储库中删除特定的预定作业。">rhpctl删除工作</a></li>
                        <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-37F19BE3-BE9C-4013-9C6D-F63BCF1BCBDD" title="使用特定作业ID查询计划作业的当前状态。">rhpctl查询工作</a></li>
                     </ul>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-492BAB58-26A7-4968-98BC-2993DDCCA856" name="GUID-492BAB58-26A7-4968-98BC-2993DDCCA856"></a><h3 id="CWADD-GUID-492BAB58-26A7-4968-98BC-2993DDCCA856" class="sect3">Oracle重新启动修补和升级</h3>
               <div>
                  <p>您可以使用Fleet Patching和Provisioning使用黄金映像修补和升级Oracle Restart。</p>
                  <p>您可以将单节点Oracle Restart的目标移动到从包含任何修补程序的黄金映像进行置备的Oracle主目录。Fleet Patching和Provisioning确保将配置文件（例如listener.ora）复制到新的Oracle主目录。</p>
                  <p>您还可以使用Fleet Patching和Provisioning来使用黄金映像升级Oracle Restart。通过升级从较高级别的黄金映像配置的目标Oracle主目录上的Oracle主目录来升级Oracle Restart环境。Fleet Patching and Provisioning更新配置和库存设置。</p>
                  <div class="p">使用类似于以下内容的RHPCTL实用程序：<pre class="pre codeblock"><code>rhpctl add workingcopy -workingcopy <span class="variable" translate="no">Oracle_Restart_working_copy</span> -resposnefile <span class="variable" translate="no">Oracle_Restart_resposne_file</span> -targetnode <span class="variable" translate="no">node_on_which_Oracle_Restart_is_provisioned</span> {superuser credentials}</code></pre></div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-4A987DBE-1BBC-4FEE-B576-A06308AA05C8" name="GUID-4A987DBE-1BBC-4FEE-B576-A06308AA05C8"></a><h3 id="CWADD-GUID-4A987DBE-1BBC-4FEE-B576-A06308AA05C8" class="sect3">舰队修补和供应用例</h3>
               <div>
                  <p>查看这些主题，了解使用Fleet Patching and Provisioning配置，修补和升级软件的分步过程。</p>
                  <p>Fleet Patching and Provisioning是一种软件生命周期管理解决方案，可帮助标准化标准操作环境的修补，配置和升级。</p>
               </div>
               <div class="sect3"><a id="GUID-576A8A2F-A7E2-4678-BD3F-ACF1E731B3A9" name="GUID-576A8A2F-A7E2-4678-BD3F-ACF1E731B3A9"></a><h4 id="CWADD-GUID-576A8A2F-A7E2-4678-BD3F-ACF1E731B3A9" class="sect4">创建Oracle Grid Infrastructure 12 <span class="italic">c</span>第2版部署</h4>
                  <div>
                     <p>在当前没有Grid主目录的两个节点上配置Oracle Grid Infrastructure软件，然后配置Oracle Grid Infrastructure以形成多节点Oracle Grid Infrastructure安装。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-576A8A2F-A7E2-4678-BD3F-ACF1E731B3A9__GUID-D1463B9D-231A-4C20-8844-6138F87CAB0E">在你开始之前</p>
                        <p>提供存储，网络，用户和组的配置详细信息以及在响应文件中安装Oracle Grid Infrastructure的节点信息。您可以将响应文件存储在Fleet Patching and Provisioning Server上的任何位置。</p>
                        <p>您可以配置Oracle独立群集，Oracle应用群集，Oracle域服务群集或Oracle成员群集。确保响应文件具有所需的群集配置详细信息。</p>
                        <p>确保按照“ <cite>Oracle Grid Infrastructure安装指南”</cite>中的说明配置了存储，网络和操作系统要求。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-576A8A2F-A7E2-4678-BD3F-ACF1E731B3A9__GUID-A5F16808-85CE-4166-AD3F-269DFB04ADDC">程序</p>
                     </div>
                     <!-- class="section" -->
                     <ul>
                        <li class="stepexpand"><span>从Fleet Patching和Provisioning Server，运行命令：</span><div><pre class="pre codeblock"><code>$ rhpctl add workingcopy -workingcopy GI122 -image GI_HOME_12201 -responsefile /u01/app/rhpinfo/GI_12201_install.rsp { <span class="variable" translate="no">authentication_option</span> }</code></pre><p><code class="codeph">GI122</code>是基于图像<code class="codeph">GI_HOME_12201</code>的工作副本</p>
                              <p><code class="codeph">/u01/app/rhpinfo/GI_12201_install.rsp</code>是响应文件位置。
                              </p>
                           </div>
                           <div>Cluster Verification Utility根据要求检查预安装配置。Fleet Patching和Provisioning配置Oracle Grid Infrastructure。</div>
                        </li>
                     </ul>
                     <div class="section">
                        <p>根据同一响应文件中的设置配置Oracle Grid Infrastructure 12 <span class="italic">c第</span> 2版。
                        </p>
                        <p>在配置期间，如果发生错误，过程将停止并允许您修复错误。修复错误后，您可以从上次停止的位置恢复配置操作。</p>
                        <p>观看视频</p><div class="video-box">
                              <div id="18888" class="video-container"></div>
                           </div>
                        
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-EE5A5ED3-5ACF-4745-AB9D-6A4D2E438D09" name="GUID-EE5A5ED3-5ACF-4745-AB9D-6A4D2E438D09"></a><h4 id="CWADD-GUID-EE5A5ED3-5ACF-4745-AB9D-6A4D2E438D09" class="sect4">配置Oracle数据库主页和创建数据库</h4>
                  <div>
                     <p>此过程提供Oracle Database 12 <span class="italic">c第</span> 2版（12.2）软件并创建Oracle数据库实例。
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-EE5A5ED3-5ACF-4745-AB9D-6A4D2E438D09__GUID-67070765-F49B-4386-84D0-71BD0801F260">程序</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>从Fleet Patching和Provisioning Server，配置Oracle数据库主页软件：</span><div><pre class="pre codeblock"><code>$ rhpctl add workingcopy -image db12201 -path /u01/app/dbusr/product/12.2.0/db12201 -client client_001 -oraclebase / u01 / app / dbusr / -workingcopy db122</code></pre></div>
                           <div>该命令将工作副本<code class="codeph">db122</code>从映像<code class="codeph">db12201</code>到集群<code class="codeph">client_001</code>上的指定路径。
                           </div>
                        </li>
                        <li class="stepexpand"><span>创建数据库实例：</span><div><pre class="pre codeblock"><code>$ rhpctl add database -workingcopy db122 -dbname db -dbtype RAC</code></pre></div>
                           <div>该命令将创建Oracle RAC数据库实例<code class="codeph">db</code> 。您可以重复使用<code class="codeph">add database</code>命令在工作副本上创建更多实例。
                           </div>
                        </li>
                     </ol>
                     <div class="section">
                        <p>观看视频</p><div class="video-box">
                              <div id="18874" class="video-container"></div>
                           </div>
                        
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-8D0CCA76-0F80-4B64-9097-52B31C525DB4" name="GUID-8D0CCA76-0F80-4B64-9097-52B31C525DB4"></a><h4 id="CWADD-GUID-8D0CCA76-0F80-4B64-9097-52B31C525DB4" class="sect4">配置可插拔数据库</h4>
                  <div>
                     <p>您可以在配置的数据库工作副本中运行的现有容器数据库（CDB）上配置可插拔数据库（PDB）。</p>
                     <div class="p">创建黄金映像的工作副本，将该工作副本提供给目标，并将数据库创建为多租户CDB后，可以使用<code class="codeph">rhpctl addpdb database</code>命令将PDB添加到CDB。
                     </div>
                     <!-- class="section" -->
                     <ul>
                        <li class="stepexpand"><span>以下命令示例创建一个名为PDB <code class="codeph">pdb183</code>在CDB称为<code class="codeph">raccdb183</code> ，这是一个工作拷贝称为<code class="codeph">wc_db183</code> ：</span><div><pre class="pre codeblock"><code>$ rhpctl addpdb database -workingcopy wc_db183 -cdbName raccdb183 -pdbName pdb183</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>使用<code class="codeph">rhpctl deletepdb database</code>命令从工作副本上的现有CDB中删除PDB。</span><div>以下命令示例删除一个名为PDB <code class="codeph">pdb183</code>上的CDB称为<code class="codeph">raccdb183</code> ，这是一个工作拷贝被称为<code class="codeph">wc_db183</code> ：<pre class="pre codeblock"><code>$ rhpctl deletepdb database -workingcopy wc_db183 -cdbName raccdb183 -pdbName pdb183</code></pre></div>
                        </li>
                     </ul>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-018ACE1C-D873-45CF-A2D7-D7BD7B9C7AFA" name="GUID-018ACE1C-D873-45CF-A2D7-D7BD7B9C7AFA"></a><h4 id="CWADD-GUID-018ACE1C-D873-45CF-A2D7-D7BD7B9C7AFA" class="sect4">升级到Oracle Grid Infrastructure 12 <span class="italic">c</span>第2版</h4>
                  <div>
                     <p>此过程使用Fleet Patching和Provisioning将Oracle Grid Infrastructure集群从11 <span class="italic">g</span>版本2（11.2.0.4）升级到12 <span class="italic">c</span>版本2（12.2）。
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-018ACE1C-D873-45CF-A2D7-D7BD7B9C7AFA__GUID-69223C4E-E632-4BEA-BABD-CB362B699CDF">在你开始之前</p>
                        <p>升级到Oracle网格基础架构12 <span class="italic">c</span>释放2（12.2.0.1），将信号源必须是Oracle网格基础架构<span class="italic">11克</span> 2版（11.2.0.3或11.2.0.4），或Oracle网格基础架构12 <span class="italic">c</span>释放2（12.1.0.2） 。
                        </p>
                        <p>确保源主目录中配置的组与目标主目录中的组匹配。</p>
                        <p>确保您拥有Oracle Grid Infrastructure 12 <span class="italic">c第</span> 2版（12.2.0.1）软件的映像<code class="codeph">GI_HOME_12201</code>以配置您的工作副本。
                        </p>
                        <p><code class="codeph">GI_11204</code>是正在升级的群集上的活动Grid Infrastructure主目录。它是一个工作副本，因为在此示例中，Fleet Patching和Provisioning配置了群集。Fleet Patching和Provisioning还可以升级其Grid Grid家庭未受管理的群集，即Fleet Patching和Provisioning未提供的家庭。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-018ACE1C-D873-45CF-A2D7-D7BD7B9C7AFA__GUID-82330B07-CACF-45E8-91B0-97AB411FF586">程序</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>提供Oracle Grid Infrastructure 12 <span class="italic">c第</span> 2版（12.2.0.1）软件的工作副本：</span><div><pre class="pre codeblock"><code>$ rhpctl add workingcopy -workingcopy GI122 -image GI_HOME_12201 { <span class="variable" translate="no">authentication_option</span> }</code></pre><p><code class="codeph">GI122</code>是基于图像<code class="codeph">GI_HOME_12201</code>的工作副本。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>将目标群集升级到<code class="codeph">GI122</code>工作副本：</span><div><pre class="pre codeblock"><code>rhpctl升级gihome -sourcewc GI11204 -destwc GI122</code></pre></div>
                           <div>Rapid Home Provisioning根据源工作副本的名称识别要升级的集群，并升级到工作副本<code class="codeph">GI122</code> 。
                           </div>
                        </li>
                     </ol>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-01E1C53C-CD9E-4E96-BA2A-C061821768D2" name="GUID-01E1C53C-CD9E-4E96-BA2A-C061821768D2"></a><h4 id="CWADD-GUID-01E1C53C-CD9E-4E96-BA2A-C061821768D2" class="sect4">在不更改网格主路径的情况下修补Oracle Grid Infrastructure</h4>
                  <div>
                     <p>此过程说明如何在不更改Grid主路径的情况下修补Oracle Grid Infrastructure。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-01E1C53C-CD9E-4E96-BA2A-C061821768D2__GUID-71E75BA7-232A-42C3-920B-19F44B518800">在你开始之前</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>确保导入包含Grid home的黄金映像并存在于Fleet Patching and Provisioning Server上。</p>
                           </li>
                           <li>
                              <p>确保您在<code class="codeph">path</code>选项中提供的目录不是现有目录。
                              </p>
                           </li>
                           <li>
                              <p>源Grid home必须是托管主页（由Fleet Patching and Provisioning配置）。它不需要是符合Oracle分层文件系统（OLFS）的家庭。</p>
                           </li>
                           <li>
                              <p>Grid home必须是Oracle Grid Infrastructure 12 <span class="italic">c</span> （12.2.0.1）或更高版本。
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-01E1C53C-CD9E-4E96-BA2A-C061821768D2__GUID-7C8C0DFE-FA2E-4B56-A5EB-58CC934E3FFE">修补程序</p>
                     </div>
                     <!-- class="section" -->
                     <ul>
                        <li class="stepexpand"><span>要将非OLFS兼容的Grid主目录移动到OLFS网格主目录，请从Fleet Patching和Provisioning Server中运行两个类似于以下内容的命令：</span><div><pre class="pre codeblock"><code>$ rhpctl add workingcopy -workingcopy GI_HOME_12201_PSU1 -aupath /u01/app/orabase/product/12.2.0.1/aupath -image <span class="variable" translate="no">image_name</span> -client <span class="variable" translate="no">client_name</span> -softwareonly</code></pre><pre class="pre codeblock"><code>$ rhpctl move gihome -srcwc GI_HOME_12201 -destwc GI_HOME_12201_PSU1 -agpath /u01/app/orabase/product/12.2.0.1/agpath -path /u01/app/orabase/product/12.2.0.1/grid</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>要将符合OLFS的Grid主目录移动到修补版本，请运行两个类似于以下内容的命令：</span><div><pre class="pre codeblock"><code>$ rhpctl add workingcopy -workingcopy gihome12201_psu1_lpm -aupath /u01/app/orabase/product/12.2.0.1/aupath -image <span class="variable" translate="no">image_name</span> -client <span class="variable" translate="no">client_name</span> -softwareonly</code></pre><pre class="pre codeblock"><code>$ rhpctl move gihome -sourcewc gihome12201_lpm -destwc gihome12201_psu1_lpm</code></pre></div>
                        </li>
                     </ul>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-4E6A7A57-BB3C-49A1-9C9F-820EA62D675A" name="GUID-4E6A7A57-BB3C-49A1-9C9F-820EA62D675A"></a><h4 id="CWADD-GUID-4E6A7A57-BB3C-49A1-9C9F-820EA62D675A" class="sect4">同时修补Oracle Grid Infrastructure和Oracle数据库</h4>
                  <div>
                     <p>此过程将群集上的Oracle Grid Infrastructure和Oracle数据库修补到最新的修补程序级别，而不会导致群集停机。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-4E6A7A57-BB3C-49A1-9C9F-820EA62D675A__GUID-E146963D-CFFD-4015-82A2-17AE0A54F999">在你开始之前</p>
                        <p>在此过程中，Oracle Grid Infrastructure 12 <span class="italic">c</span>发行版2（12.2.0.1）正在目标集群上运行。工作副本<code class="codeph">GI_HOME_12201_WCPY</code>是此群集上的活动Grid主目录。工作副本<code class="codeph">DB_HOME_12201_WCPY</code>运行带有正在运行的数据库实例<code class="codeph">db1</code>的Oracle RAC 12 <span class="italic">c</span>发行版2（12.2.0.1）数据库。工作副本<code class="codeph">DB_HOME_12102_WCPY</code>运行带有运行数据库实例<code class="codeph">db2</code>的Oracle RAC 12 <span class="italic">c</span>发行版1（12.1.0.2）数据库</p>
                        <p>确保在Fleet Patching and Provisioning Server上具有图像<code class="codeph">GI_HOME_12201_PSU1</code> ， <code class="codeph">DB_HOME_12201_PSU1</code> ， <code class="codeph">DB_HOME_12102_PSU5</code>以及Oracle Grid Infrastructure和Oracle RAC数据库所需的修补程序。
                        </p>
                        <p>源主目录中配置的组必须与目标主目录中的组匹配。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-4E6A7A57-BB3C-49A1-9C9F-820EA62D675A__GUID-AA19B7B3-9919-4A3B-B996-7B15A4FEB610">程序</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>按如下方式准备目标Oracle主目录：</span><ol type="a">
                              <li class="substepexpand"><span>在要修补的群集上提供仅限软件的Grid home：</span><div><pre class="pre codeblock"><code>$ rhpctl add workingcopy -workingcopy GI_HOME_12201_PATCHED_WCPY -image GI_HOME_12201_PSU1 -client CLUSTER_005 -softwareonly</code></pre></div>
                              </li>
                              <li class="substepexpand"><span>在没有数据库实例的情况下，为每个版本的数据库主目录进行修补：</span><div><pre class="pre codeblock"><code>$ rhpctl add workingcopy -workingcopy DB_HOME_12201_PATCHED_WCPY -image DB_HOME_12201_PSU1 $ rhpctl add workingcopy -workingcopy DB_HOME_12102_PATCHED_WCPY -image DB_HOME_12102_PSU5</code></pre></div>
                              </li>
                           </ol>
                        </li>
                        <li class="stepexpand"><span>在<code class="codeph">node1</code>上修补Oracle Grid Infrastructure和所有Oracle RAC数据库，如下所示：</span><div><pre class="pre codeblock"><code>$ rhpctl move gihome -sourcewc GI_HOME_12201_WCPY -destwc GI_HOME_12201_PATCHED_WCPY -auto -dbhomes DB_HOME_12102_WCPY = DB_HOME_12102_PATCHED_WCPY，DB_HOME_12201_WCPY = DB_HOME_12201_PATCHED_WCPY -targetnode node1 { <span class="variable" translate="no">authentication_option</span> }</code></pre><p>运行该命令时，将活动Oracle Grid Infrastructure从工作副本<code class="codeph">GI_HOME_12201_WCPY</code>移至<code class="codeph">GI_HOME_12201_PATCHED_WCPY</code> ，将Oracle RAC数据库<code class="codeph">db1</code>从<code class="codeph">DB_HOME_12201_WCPY</code>移至<code class="codeph">DB_HOME_12201_PATCHED_WCPY</code> ，将Oracle RAC数据库<code class="codeph">db2</code>从<code class="codeph">DB_HOME_12102_WCPY</code>移至<code class="codeph">DB_HOME_12102_PATCHED_WCPY</code> 。</p>
                           </div>
                        </li>
                     </ol>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-666A28B6-66D5-48F6-AD2B-7606E300517E" name="GUID-666A28B6-66D5-48F6-AD2B-7606E300517E"></a><h4 id="CWADD-GUID-666A28B6-66D5-48F6-AD2B-7606E300517E" class="sect4">在没有停机的情况下修补Oracle Database 12 <span class="italic">c</span>第1版</h4>
                  <div>
                     <p>此过程说明如何使用最新的修补程序修补Oracle Database 12 <span class="italic">c</span>发行版1（12.1.0.2），而不会关闭数据库。
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-666A28B6-66D5-48F6-AD2B-7606E300517E__GUID-D870EAE4-3315-4388-82B2-97D8597C1B44">在你开始之前</p>
                        <p>您有一个要修补到最新补丁级别的Oracle数据库<code class="codeph">db12102</code> 。
                        </p>
                        <p>确保基于映像<code class="codeph">DB12102_PSU</code>的工作副本<code class="codeph">db12102_psu</code>包含最新的修补程序并且可用。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-666A28B6-66D5-48F6-AD2B-7606E300517E__GUID-FB9CBBC8-ED4A-4004-A01C-9C761A812215">程序</p>
                        <p>从Fleet Patching和Provisioning Server，根据源和目标数据库运行以下命令之一：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>要修补由Fleet Patching and Provisioning管理的Oracle数据库主目录，并且存在源数据库和目标数据库的工作副本，请运行：</span><div><pre class="pre codeblock"><code>rhpctl move database -sourcewc db12102 -patchedwc db12102_psu</code></pre><p><code class="codeph">db12102</code>是要修补的数据库的源工作副本</p>
                              <p><code class="codeph">db12102_psu</code>是Oracle数据库软件的工作副本，其中应用了修补程序，基于映像<code class="codeph">DB12102_PSU</code> 。</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>要修补非托管Oracle数据库主目录（源工作副本不存在，因为Oracle主目录不由Fleet Patching and Provisioning管理），请运行：</span><div><pre class="pre codeblock"><code>rhpctl move database -sourcehome /u01/app/orabase/product/12.1.0.2/dbhome_1 -patchedwc db12102_psu -targetnode node1</code></pre><p><code class="codeph">targetnode</code>指定要升级数据库的节点，因为源Oracle数据库位于12.1.0.2集群上。
                              </p>
                              <p><code class="codeph">/u01/app/orabase/product/12.1.0.2/dbhome_1</code>是要修补的数据库的路径</p>
                              <p><code class="codeph">db12102_psu</code>是Oracle数据库软件的工作副本，其中应用了修补程序，基于映像<code class="codeph">DB12102_PSU</code> 。</p>
                           </div>
                           <div></div>
                           <div>使用保存的黄金映像将版本12 <span class="italic">c</span>版本1的所有数据库标准化修补到相同的修补程序级别。
                           </div>
                        </li>
                        <li class="stepexpand"><span>如果由于某种原因，您想要回滚应用于托管Oracle数据库主目录的修补程序，请运行：</span><div><pre class="pre codeblock"><code>rhpctl move database -sourcewc db12102_psu -patchedwc db12102 -ignorewcpatches</code></pre><p><code class="codeph">db12102</code>是要回滚的未修补数据库的工作副本。
                              </p>
                              <p><code class="codeph">db12102_psu</code>是Oracle数据库软件的工作副本，其中应用了修补程序，基于映像<code class="codeph">DB12102_PSU</code> 。</p>
                           </div>
                        </li>
                     </ol>
                     <div class="section">
                        <p>对于所有Oracle数据库，您还可以使用<code class="codeph">move database</code>命令指定这些附加选项：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">-keepplacement</code> ：对于管理员管理的Oracle RAC数据库（不是Oracle RAC One Node Database），Fleet Patching and Provisioning会在移动后保留相同节点上的服务。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">-disconnect</code> ：在停止或重新定位服务之前断开所有会话。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">-drain_timeout</code> ：指定为计划的维护操作完成资源耗尽所允许的时间（以秒为单位）。在排水期间，处理所有当前客户端请求，但不接受新请求。此选项仅适用于Oracle Database 12 <span class="italic">c第</span> 2版（12.2）或更高版本。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">-stopoption</code> ：停止数据库。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">-nodatapatch</code> ：确保<code class="codeph">datapatch</code>是不是因为你是移动的数据库上运行。
                              </p>
                           </li>
                        </ul>
                        <p>观看视频</p><div class="video-box">
                              <div id="18887" class="video-container"></div>
                           </div>
                        
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-3C43BA78-B15B-4235-9088-81D65A13C497" name="GUID-3C43BA78-B15B-4235-9088-81D65A13C497"></a><h4 id="CWADD-GUID-3C43BA78-B15B-4235-9088-81D65A13C497" class="sect4">升级到Oracle Database 12 <span class="italic">c</span>第2版</h4>
                  <div>
                     <p>此过程描述了如何使用Fleet Patching和Provisioning为托管和非托管Oracle主目录使用单个命令将Oracle数据库从Oracle Database <span class="italic">11g第</span> 2版（11.2）升级到12 <span class="italic">c第</span> 2版。
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-3C43BA78-B15B-4235-9088-81D65A13C497__GUID-016AFE9C-C941-4BC9-A270-B73EA0CC8D90">在你开始之前</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>要升级到Oracle Database 12 <span class="italic">c第</span> 2版（12.2.0.1），源数据库必须是Oracle Database <span class="italic">11g第</span> 2版（11.2.0.3或11.2.0.4）或Oracle Database 12 <span class="italic">c第</span> 1版（12.1.0.2）。
                              </p>
                           </li>
                           <li>
                              <p>运行升级前数据库的Oracle Grid Infrastructure必须与要升级的数据库版本具有相同的版本或更高版本。</p>
                           </li>
                           <li>
                              <p>要升级的源Oracle主目录可以是托管工作副本，即使用Fleet Patching and Provisioning配置的Oracle主目录，或非托管主目录，即未使用Fleet Patching and Provisioning配置的Oracle主目录。如果要升级非托管Oracle主目录，请提供要升级的数据库的完整路径。</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-3C43BA78-B15B-4235-9088-81D65A13C497__GUID-6405DCF0-4C37-4BC4-9824-BDC02D796DE4">使用Fleet Patching和Provisioning升级Oracle数据库的过程</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>从Fleet Patching和Provisioning Server，根据源和目标数据库运行以下命令之一：</span><ol type="a">
                              <li class="substepexpand"><span>要升级由Fleet Patching and Provisioning管理的Oracle主目录，并且存在源数据库和目标数据库的工作副本，请运行：</span><div><pre class="pre codeblock"><code>$ rhpctl upgrade database -dbname test_database -sourcewc db112 -destwc db122 { <span class="variable" translate="no">authentication_option</span> }</code></pre><p><code class="codeph">test_database</code>是要升级的数据库的名称。
                                    </p>
                                    <p><code class="codeph">db112</code>是升级前数据库的源工作副本。
                                    </p>
                                    <p><code class="codeph">db122</code>是已升级的Oracle数据库软件的工作副本。
                                    </p>
                                 </div>
                              </li>
                              <li class="substepexpand"><span>要升级非托管Oracle主目录（源工作副本不存在，因为Oracle主目录不由Fleet Patching and Provisioning管理），请运行：</span><div><pre class="pre codeblock"><code>$ rhpctl move database -sourcehome /u01/app/orabase/product/11.2.0/dbhome_1 -destwc db122 -targetnode node1 { <span class="variable" translate="no">authentication_option</span> }</code></pre><p><code class="codeph">/u01/app/orabase/product/11.2.0/dbhome_1</code>是要升级的数据库的路径。
                                    </p>
                                    <p><code class="codeph">db122</code>是已升级的Oracle数据库软件的工作副本。
                                    </p>
                                    <p><code class="codeph">targetnode</code>指定要升级数据库的节点，因为源Oracle数据库位于11.2.0.4集群上。
                                    </p>
                                 </div>
                              </li>
                           </ol>
                           <div></div>
                        </li>
                     </ol>
                     <div class="section">升级后的数据库现在由Fleet Patching and Provisioning管理。您可以使用Fleet Patching和Provisioning确保将数据库修补到最新级别。
                        <div class="infoboxnote" id="GUID-3C43BA78-B15B-4235-9088-81D65A13C497__GUID-E187BA50-88F6-4D33-8567-DC16F1FF03D6">
                           <p class="notep1">注意：</p>在升级期间，如果发生错误，该过程将停止并允许您修复错误。修复错误后，您可以从上次停止的位置恢复升级操作。
                        </div>
                        <p>观看视频</p><div class="video-box">
                              <div id="18886" class="video-container"></div>
                           </div>
                        
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-926A4D78-0BAB-45EA-B5A4-B9B11BF77374" title="将数据库升级到目标工作副本的版本。">rhpctl升级数据库</a></li>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-C10036DC-B091-40E1-B46B-8ACF38B20066" title="将一个或多个数据库从源工作副本或任何Oracle数据库主目录移动到修补的工作副本。">rhpctl移动数据库</a></li>
                        </ul>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-34F15203-2715-47CE-80EE-962355B61CAE" name="GUID-34F15203-2715-47CE-80EE-962355B61CAE"></a><h4 id="CWADD-GUID-34F15203-2715-47CE-80EE-962355B61CAE" class="sect4">将节点添加到群集并将Oracle RAC数据库扩展到节点</h4>
                  <div>
                     <p>您可以使用Fleet Patching and Provisioning添加节点，然后将Oracle RAC数据库扩展到新节点，从而将节点添加到双节点群集。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-34F15203-2715-47CE-80EE-962355B61CAE__GUID-1AA5AE92-7E1D-4313-B884-904E59D80A04">在你开始之前</p>
                        <p>在此过程中，Oracle Grid Infrastructure 12 <span class="italic">c</span>发行版2（12.2.0.1）正在群集上运行。工作副本<code class="codeph">GI_HOME_12202_WCPY</code>是此群集上的活动Grid主目录。
                        </p>
                        <p>Oracle RAC数据库主目录在工作副本<code class="codeph">DB_HOME_12202_WCPY</code>上运行。</p>
                        <p>确保按照“ <cite>Oracle Grid Infrastructure安装指南”中的</cite>说明为新节点配置了存储，网络和操作系统要求。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-34F15203-2715-47CE-80EE-962355B61CAE__GUID-D1E7F9DC-0CFF-4DBC-BC92-01AAD569C544">程序</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>从Fleet Patching和Provisioning Server，运行以下命令将节点添加到现有Oracle Grid Infrastructure工作副本：</span><div><pre class="pre codeblock"><code>rhpctl addnode gihome -workingcopy GI_HOME_12202_WCPY -newnodes n3：n3-vip { <span class="variable" translate="no">authentication_option</span> }</code></pre></div>
                           <div>该命令通过添加<code class="codeph">node3</code>扩展集群。
                           </div>
                        </li>
                        <li class="stepexpand"><span>将实例添加到新节点上的管理员管理的Oracle RAC数据库：</span><div><pre class="pre codeblock"><code>rhpctl addnode database -workingcopy DB_HOME_12202_WCPY -dbname db321 -node n3 { <span class="variable" translate="no">authentication_option</span> }</code></pre></div>
                           <div>该命令将数据库扩展到<code class="codeph">node3</code>上，并在此节点上创建数据库<code class="codeph">db321</code> 。
                           </div>
                        </li>
                     </ol>
                     <div class="section">
                        <p>观看视频</p><div class="video-box">
                              <div id="18899" class="video-container"></div>
                           </div>
                        
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-808195B6-C75C-46F7-B81C-F975671FD924" title="将一个或多个节点添加到Oracle Grid Infrastructure安装。">rhpctl addnode gihome</a></li>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-AF70BBF3-3FDD-4CCE-B73F-D19BE9C95A3B" title="将实例添加到管理员管理的Oracle RAC数据库。">rhpctl addnode数据库</a></li>
                        </ul>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-53F8804C-E900-4B92-A092-5C2EF4B61CEE" name="GUID-53F8804C-E900-4B92-A092-5C2EF4B61CEE"></a><h4 id="CWADD-GUID-53F8804C-E900-4B92-A092-5C2EF4B61CEE" class="sect4">为舰队补丁和供应添加黄金图像</h4>
                  <div>
                     <p>创建软件主页的黄金映像并将其存储在Fleet Patching and Provisioning Server上，以便稍后用于配置Oracle主目录。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-53F8804C-E900-4B92-A092-5C2EF4B61CEE__GUID-0F9E8554-EF44-4F80-8225-73C074DC778D">在你开始之前</p>
                        <p>用于创建黄金映像的Oracle主目录可以位于Fleet Patching and Provisioning Server，Fleet Patching and Provisioning Client或Fleet Patching and Provisioning Server可以与之通信的任何目标计算机上。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-53F8804C-E900-4B92-A092-5C2EF4B61CEE__GUID-D8DFA4FB-DEBE-484E-8B44-6DF6260E4159">程序</p>
                        <p>通过以下任何方式创建Oracle Homes的黄金映像，并将其存储在Fleet Patching and Provisioning服务器上：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>从Fleet Patching and Provisioning Server上已安装的Oracle主目录导入映像：</span><div><pre class="pre codeblock"><code>rhpctl import image -image db12201 -path / share / software / 122 / dbhome -imagetype ORACLEDBSOFTWARE</code></pre><p>的金像<code class="codeph">imagetype</code> Oracle数据库<span class="italic">12c的</span>第2版软件创建并存储在舰队修补和配置服务器。
                              </p>
                              <p>您还可以通过将<code class="codeph">-imagetype</code>分别指定为<code class="codeph">ORACLEGISOFTWARE</code> ， <code class="codeph">ORACLEGGSOFTWARE</code>或<code class="codeph">SOFTWARE</code>来创建Oracle Grid Infrastructure或任何其他软件的黄金映像。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>通过从Fleet Patching and Provisioning Client运行以下命令，从Fleet Patching and Provisioning Client上的已安装Oracle主目录导入映像：</span><div><pre class="pre codeblock"><code>rhpctl import image -image db12201 -path /u01/app/dbusr/product/12.2.0/</code></pre><p>该命令根据指定路径中安装的本地Oracle主<code class="codeph">db12201</code>创建并添加映像<code class="codeph">db12201</code> 。
                              </p>
                           </div>
                        </li>
                     </ol>
                     <div class="section">
                        <div class="infoboxnote" id="GUID-53F8804C-E900-4B92-A092-5C2EF4B61CEE__GUID-9D279974-9A5E-43E3-B27A-33AE1971A20F">
                           <p class="notep1">注意：</p>您无法直接将图像用作软件之家。使用图像创建软件家庭的工作副本。
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-6F4210E7-F0E5-4A3E-A8B4-D4664286A0AA" name="GUID-6F4210E7-F0E5-4A3E-A8B4-D4664286A0AA"></a><h4 id="CWADD-GUID-6F4210E7-F0E5-4A3E-A8B4-D4664286A0AA" class="sect4">公共车队修补和配置任务的用户操作</h4>
                  <div>
                     <p>您可以使用Fleet Patching和Provisioning用户操作来执行许多任务，例如安装和配置任何类型的软件以及运行脚本。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-6F4210E7-F0E5-4A3E-A8B4-D4664286A0AA__GUID-DD3EAFF8-BD56-468A-822A-85173565651F">部署Web服务器</p>
                        <p>以下过程演示了使用Fleet Patching和Provisioning自动部署Apache Web Server：</p>
                        <ol id="GUID-6F4210E7-F0E5-4A3E-A8B4-D4664286A0AA__OL_JST_T1Y_XFB">
                           <li>创建脚本以安装Apache Web服务器，如下所示：<ol type="a" id="GUID-6F4210E7-F0E5-4A3E-A8B4-D4664286A0AA__OL_RGR_DGY_XFB">
                                 <li>在Fleet Patching和Provisioning Server上，下载并解压缩Apache Web服务器安装工具包。</li>
                                 <li>创建脚本以安装，配置和启动Apache Web服务器。</li>
                              </ol>
                           </li>
                           <li>通过在Fleet Patching and Provisioning Server上运行以下命令，将脚本注册为具有Fleet Patching和Provisioning的用户操作：<pre class="pre codeblock"><code>rhpctl useraction -useraction apachestart -actionscript /user1/useractions/apacheinstall.sh -post -optype ADD_WORKINGCOPY -onerror ABORT</code></pre><p>上述命令为存储在指定目录中的操作脚本添加<code class="codeph">apachestart</code>用户操作。根据指定的属性，用户操作在<code class="codeph">ADD_WORKINGCOPY</code>操作之后运行，如果有任何错误则中止。
                              </p>
                           </li>
                           <li>创建图像类型并将用户操作与图像类型相关联，如下所示：<pre class="pre codeblock"><code>rhpctl add imagetype -imagetype apachetype -basetype SOFTWARE -useraction“apachestart”</code></pre><p>上述命令创建一个名为<code class="codeph">apachetype</code>的新图像类型，它是基本图像类型<code class="codeph">SOFTWARE</code>的衍生物，具有关联的用户操作<code class="codeph">apachestart</code> 。
                              </p>
                           </li>
                           <li>创建图像类型的黄金图像，如下所示：<pre class="pre codeblock"><code>rhpctl import image -image apacheinstall -path / user1 / apache2219_kit / -imagetype apachetype</code></pre><p>上述命令根据您之前创建的<code class="codeph">imagetype</code> ，在指定的路径中创建一个带有Apache Web服务器安装脚本的黄金映像<code class="codeph">apacheinstall</code> 。
                              </p>
                              <p>要查看此映像的属性，请运行<code class="codeph">rhpctl query image -image apacheinstall</code>命令。
                              </p>
                           </li>
                           <li>在目标上部署黄金映像的工作副本，如下所示：<pre class="pre codeblock"><code>rhpctl add workingcopy -workingcopy apachecopy -image apacheinstall -path / user1 / apacheinstallloc -sudouser user1 -sudopath / usr / local / bin / sudo -node node1 -user user1 -useractiondata“/user1/apachehome:1080:2.2.19”</code></pre><p>Fleet Patching和Provisioning将软件配置到目标并运行用户操作中指定的<code class="codeph">apachestart</code>脚本。您可以使用<code class="codeph">useractiondata</code>选项提供Apache Web服务器配置详细信息，例如端口号。如果目标是Fleet Patching and Provisioning Client，则无需指定<code class="codeph">sudo</code>凭据。
                              </p>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-6F4210E7-F0E5-4A3E-A8B4-D4664286A0AA__GUID-CB8A6D06-8CB1-44DF-8F2B-ADDEA37DFB1D">使用单个用户操作注册多个脚本</p>
                        <p>通过注册包装脚本和捆绑的自定义脚本，将多个脚本作为用户操作插件的一部分运行。包装器脚本提取捆绑的脚本，这些脚本在包装器脚本的目录下复制，然后根据需要运行这些提取的脚本，类似于以下过程：</p>
                        <ol id="GUID-6F4210E7-F0E5-4A3E-A8B4-D4664286A0AA__OL_P25_Q5Y_XFB">
                           <li>以下命令创建名为<code class="codeph">ohadd_ua</code>的用户操作，并将包装脚本<code class="codeph">wc_add.sh</code>与包含其他脚本的zip文件相关联：<pre class="pre codeblock"><code>rhpctl add useraction -useraction ohadd_ua -actionscript /scratch/crsusr/wc_add.sh -actionfile /scratch/crsusr/pack.zip -pre -runscope ALLNODES -optype ADD_WORKINGCOPY</code></pre><p>包装器脚本<code class="codeph">wc_add.sh</code>将<code class="codeph">pack.zip</code>文件提取到脚本路径中，该路径是用户操作脚本复制到的临时路径。包装器脚本可以调用文件中包含的任何脚本。
                              </p>
                           </li>
                           <li>以下命令为<code class="codeph">ohadd_ua</code>用户操作创建图像类型<code class="codeph">sw_ua</code> ：<pre class="pre codeblock"><code>rhpctl add imagetype -imagetype sw_ua -useractions ohadd_ua -basetype SOFTWARE</code></pre></li>
                           <li>以下命令从路径中指定的软件创建名为<code class="codeph">swimgua</code>的图像：<pre class="pre codeblock"><code>rhpctl import image -image swimgua -path / tmp / custom_sw -imagetype sw_ua</code></pre></li>
                           <li>以下命令添加名为<code class="codeph">wcua</code>的工作副本并运行<code class="codeph">wc_add.sh</code>脚本：<pre class="pre codeblock"><code>rhpctl add workingcopy -workingcopy wcua -image swimgua -client targetcluster</code></pre></li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>