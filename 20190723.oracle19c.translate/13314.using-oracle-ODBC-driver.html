<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>使用Oracle ODBC驱动程序</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Database Administrator&#39;s Reference"></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Database Administrator&#39;s Reference for Linux and UNIX System-Based Operating Systems"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="administrators-reference-linux-and-unix-system-based-operating-systems.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-07T05:04:28-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2006, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96356-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="administering-oracle-database-on-oracle-solaris.html" title="Previous" type="text/html"></link>
      <link rel="next" href="database-limits.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Administrator&#39;s Reference for Linux and UNIX System-Based Operating Systems"></meta>
    <meta name="dcterms.isVersionOf" content="UNXAR"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="administering-oracle-database-on-oracle-solaris.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="database-limits.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">数据库管理员参考</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">使用Oracle ODBC驱动程序</li>
            </ol>
            <a id="GUID-3641214C-2732-441C-A858-B5B9C00E579C" name="GUID-3641214C-2732-441C-A858-B5B9C00E579C"></a><a id="UNXAR014"></a>
            
            <h2 id="UNXAR-GUID-3641214C-2732-441C-A858-B5B9C00E579C" class="sect2"><span class="enumeration_chapter">C</span>使用Oracle ODBC驱动程序</h2>
         </header>
         <div class="ind">
            <div>
               <p><a id="d21196e79" class="indexterm-anchor"></a>本附录提供了有关使用Oracle ODBC Driver的信息。
               </p>
               <p>它包含以下部分：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="using-oracle-ODBC-driver.html#GUID-7753AFF3-3BCD-4FF4-B07E-7E1E5A790D4E">不支持Oracle ODBC功能</a></p>
                  </li>
                  <li>
                     <p><a href="using-oracle-ODBC-driver.html#GUID-086CF5AE-BD01-4C9C-B657-6B1C85C54AB8">数据类型的实现</a></p>
                  </li>
                  <li>
                     <p><a href="using-oracle-ODBC-driver.html#GUID-263F0D40-D6AF-47C3-8EDE-FDBC6CB460B7">数据类型的限制</a></p>
                  </li>
                  <li>
                     <p><a href="using-oracle-ODBC-driver.html#GUID-E3587401-AE9D-453E-88BC-C70B5A26847D">SQLDriverConnect函数的连接字符串的格式</a></p>
                  </li>
                  <li>
                     <p><a href="using-oracle-ODBC-driver.html#GUID-B7D91AB2-A116-41F1-BC29-D55DA4E2F60C">减少程序中的锁定超时</a>	
                     </p>
                  </li>
                  <li>
                     <p><a href="using-oracle-ODBC-driver.html#GUID-071B8E13-4549-4162-89CE-284D6561450B">链接ODBC应用程序</a></p>
                  </li>
                  <li>
                     <p><a href="using-oracle-ODBC-driver.html#GUID-67008F0C-E833-4FE0-AE32-06B7532F6115">获取有关ROWID的信息</a></p>
                  </li>
                  <li>
                     <p><a href="using-oracle-ODBC-driver.html#GUID-4C04A996-909E-4783-93CC-D53B293B0529">WHERE子句中的ROWID</a></p>
                  </li>
                  <li>
                     <p><a href="using-oracle-ODBC-driver.html#GUID-05F6FB92-D15B-439B-8F02-9A45F2E276E0">启用结果集</a></p>
                  </li>
                  <li>
                     <p><a href="using-oracle-ODBC-driver.html#GUID-9E81960A-5706-474D-BB64-E03D1819E1B3">启用EXEC语法</a></p>
                  </li>
                  <li>
                     <p><a href="using-oracle-ODBC-driver.html#GUID-CA2BC55D-8420-4735-8B22-B11311397C03">支持的功能</a></p>
                  </li>
                  <li>
                     <p><a href="using-oracle-ODBC-driver.html#GUID-7075D133-A698-449F-82CC-D86EA4CD4391">Unicode支持</a></p>
                  </li>
                  <li>
                     <p><a href="using-oracle-ODBC-driver.html#GUID-DB2BBEFC-608F-4693-A76E-EA66A71FD57B">性能和调优</a></p>
                  </li>
                  <li>
                     <p><a href="using-oracle-ODBC-driver.html#GUID-01565DBC-5059-4CF1-8D51-81FB9708148D">错误消息</a></p>
                  </li>
               </ul>
               <div class="infoboxnotealso" id="GUID-3641214C-2732-441C-A858-B5B9C00E579C__GUID-A07B443E-0D17-42E6-938D-E370622DF3D2">
                  <p class="notep1">也可以看看：</p>
                  <p>适用于ODBC驱动程序认证信息的<a href="../install-and-upgrade.html" target="_blank"><span class="italic">Oracle数据库安装指南</span></a></p>
               </div>
            </div><a id="UNXAR352"></a><div class="props_rev_3"><a id="GUID-7753AFF3-3BCD-4FF4-B07E-7E1E5A790D4E" name="GUID-7753AFF3-3BCD-4FF4-B07E-7E1E5A790D4E"></a><h3 id="UNXAR-GUID-7753AFF3-3BCD-4FF4-B07E-7E1E5A790D4E" class="sect3"><span class="enumeration_section">C.1</span>不支持Oracle ODBC功能</h3>
               <div>
                  <div class="section">
                     <p>Oracle ODBC驱动程序不支持以下Oracle ODBC 3.0功能：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>区间数据类型</p>
                        </li>
                        <li>
                           <p><code class="codeph">SQL_C_UBIGINT</code>和<code class="codeph">SQL_C_SBIGINT</code> C数据类型标识符</p>
                        </li>
                        <li>
                           <p>共享连接</p>
                        </li>
                        <li>
                           <p>共享环境</p>
                        </li>
                        <li>
                           <p><code class="codeph">SQLSetConnectAttr</code>的<code class="codeph">SQL_LOGIN_TIMEOUT</code>属性</p>
                        </li>
                        <li>
                           <p>过期的密码选项</p>
                        </li>
                     </ul>
                     <p>Oracle ODBC驱动程序不支持下表中列出的SQL函数：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="tblformal" id="GUID-7753AFF3-3BCD-4FF4-B07E-7E1E5A790D4E__GUID-5F8C15C2-6E45-4FD0-8219-CE591B587B64">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="This 3 column table lists the SQL functions that Oracle ODBC Driver does not support. Column 1 lists string functions. Column 2 lists numeric functions. Column 3 lists time, date, and interval functions. " frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="30%" id="d21196e287">字符串函数</th>
                              <th align="left" valign="bottom" width="26%" id="d21196e290">数字函数</th>
                              <th align="left" valign="bottom" width="44%" id="d21196e293">时间，日期和间隔函数</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="30%" id="d21196e298" headers="d21196e287 ">
                                 <p><code class="codeph">BIT_LENGTH</code></p>
                              </td>
                              <td align="left" valign="top" width="26%" headers="d21196e298 d21196e290 ">
                                 <p><code class="codeph">ACOS</code></p>
                              </td>
                              <td align="left" valign="top" width="44%" headers="d21196e298 d21196e293 ">
                                 <p><code class="codeph">当前的日期</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="30%" id="d21196e311" headers="d21196e287 ">
                                 <p><code class="codeph">CHAR_LENGTH</code></p>
                              </td>
                              <td align="left" valign="top" width="26%" headers="d21196e311 d21196e290 ">
                                 <p><code class="codeph">ASIN</code></p>
                              </td>
                              <td align="left" valign="top" width="44%" headers="d21196e311 d21196e293 ">
                                 <p><code class="codeph">当前时间</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="30%" id="d21196e324" headers="d21196e287 ">
                                 <p><code class="codeph">CHARACTER_LENGTH</code></p>
                              </td>
                              <td align="left" valign="top" width="26%" headers="d21196e324 d21196e290 ">
                                 <p><code class="codeph">晒黑</code></p>
                              </td>
                              <td align="left" valign="top" width="44%" headers="d21196e324 d21196e293 ">
                                 <p><code class="codeph">CURRENT_TIMESTAMP</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="30%" id="d21196e337" headers="d21196e287 ">
                                 <p><code class="codeph">区别</code></p>
                              </td>
                              <td align="left" valign="top" width="26%" headers="d21196e337 d21196e290 ">
                                 <p><code class="codeph">ATAN2</code></p>
                              </td>
                              <td align="left" valign="top" width="44%" headers="d21196e337 d21196e293 ">
                                 <p><code class="codeph">提取</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="30%" id="d21196e350" headers="d21196e287 ">
                                 <p><code class="codeph">OCTET_LENGTH</code></p>
                              </td>
                              <td align="left" valign="top" width="26%" headers="d21196e350 d21196e290 ">
                                 <p><code class="codeph">COT</code></p>
                              </td>
                              <td align="left" valign="top" width="44%" headers="d21196e350 d21196e293 ">
                                 <p><code class="codeph">TIMESTAMPDIFF</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="30%" id="d21196e363" headers="d21196e287 ">
                                 <p><code class="codeph">位置</code></p>
                              </td>
                              <td align="left" valign="top" width="26%" headers="d21196e363 d21196e290 ">
                                 <p><code class="codeph">DEGREES</code></p>
                                 <p><code class="codeph">RADIANS</code></p>
                                 <p><code class="codeph">RAND</code></p>
                                 <p><code class="codeph">回合</code></p>
                              </td>
                              <td align="left" valign="top" width="44%" headers="d21196e363 d21196e293 ">
                                 <p></p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
               </div>
            </div><a id="UNXAR354"></a><a id="UNXAR355"></a><a id="UNXAR353"></a><div class="props_rev_3"><a id="GUID-086CF5AE-BD01-4C9C-B657-6B1C85C54AB8" name="GUID-086CF5AE-BD01-4C9C-B657-6B1C85C54AB8"></a><h3 id="UNXAR-GUID-086CF5AE-BD01-4C9C-B657-6B1C85C54AB8" class="sect3"><span class="enumeration_section">C.2</span>数据类型的实现</h3>
               <div>
                  <p>本节讨论<code class="codeph">DATE</code> ， <code class="codeph">TIMESTAMP</code>和浮点数据类型。
                  </p>
                  <div class="section">
                     <p class="subhead2" id="GUID-086CF5AE-BD01-4C9C-B657-6B1C85C54AB8__GUID-37FEE230-25C8-4F2E-919F-782DC77FD7BD">DATE和TIMESTAMP</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>Oracle <code class="codeph">DATE</code>和<code class="codeph">TIMESTAMP</code>数据类型的语义与具有相同名称的ODBC数据类型不完全对应。Oracle <code class="codeph">DATE</code>数据类型包含日期和时间信息。<code class="codeph">SQL_DATE</code>数据类型仅包含日期信息。Oracle <code class="codeph">TIMESTAMP</code>数据类型还包含日期和时间信息，但它在小数秒内具有更高的精度。Oracle ODBC驱动程序将Oracle <code class="codeph">DATE</code>和<code class="codeph">TIMESTAMP</code>列的数据类型报告为<code class="codeph">SQL_TIMESTAMP</code>以防止信息丢失。同样，Oracle ODBC驱动程序将<code class="codeph">SQL_TIMESTAMP</code>参数绑定为Oracle <code class="codeph">TIMESTAMP</code>值。
                     </p>
                     <div class="infoboxnotealso" id="GUID-086CF5AE-BD01-4C9C-B657-6B1C85C54AB8__GUID-C9F1E304-D19F-41F4-A9C2-5A76D4FD1749">
                        <p class="notep1">也可以看看：</p>
                        <p><span class="q">“ <a href="using-oracle-ODBC-driver.html#GUID-CF96CB6C-43BF-4BD2-919C-EE005B64FEE3">DATE和TIMESTAMP数据类型</a> ”，</span>以获取有关与性能和调优相关的<code class="codeph">DATE</code>和<code class="codeph">TIMESTAMP</code>数据类型的信息</p>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-086CF5AE-BD01-4C9C-B657-6B1C85C54AB8__GUID-52A3FBA6-1041-4F55-A455-42776093718F">浮点数据类型</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>连接到Oracle Database 12 <span class="italic">c</span>第2版（12.2）或更高版本时，Oracle ODBC驱动程序将Oracle浮点数据类型<code class="codeph">BINARY_FLOAT</code>和<code class="codeph">BINARY_DOUBLE</code>分别映射到ODBC数据类型<code class="codeph">SQL_REAL</code>和<code class="codeph">SQL_DOUBLE</code> 。在早期版本中， <code class="codeph">SQL_REAL</code>和<code class="codeph">SQL_DOUBLE</code>映射到通用Oracle数值数据类型。
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="UNXAR356"></a><div class="props_rev_3"><a id="GUID-263F0D40-D6AF-47C3-8EDE-FDBC6CB460B7" name="GUID-263F0D40-D6AF-47C3-8EDE-FDBC6CB460B7"></a><h3 id="UNXAR-GUID-263F0D40-D6AF-47C3-8EDE-FDBC6CB460B7" class="sect3"><span class="enumeration_section">C.3</span>数据类型的限制</h3>
               <div>
                  <div class="section">
                     <p>Oracle ODBC驱动程序和Oracle数据库对数据类型施加了限制。下表描述了这些限制：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="tblformal" id="GUID-263F0D40-D6AF-47C3-8EDE-FDBC6CB460B7__GUID-6AA2DCC5-EB28-4151-A021-AD50A445F218">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="The following 2 column table describes the Oracle ODBC Driver and Oracle Database limitations on data types. Column 1 is the limited data type. Column 2 is a description. " frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="31%" id="d21196e643">有限的数据类型</th>
                              <th align="left" valign="bottom" width="69%" id="d21196e646">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d21196e651" headers="d21196e643 ">
                                 <p>字面</p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d21196e651 d21196e646 ">
                                 <p>Oracle数据库将SQL语句中的文字限制为4000字节。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d21196e658" headers="d21196e643 ">
                                 <p><code class="codeph">SQL_LONGVARCHAR</code>和<code class="codeph">SQL_WLONGVARCHAR</code></p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d21196e658 d21196e646 ">
                                 <p><code class="codeph">SQL_LONGVARCHAR</code>数据的Oracle限制（列类型为<code class="codeph">LONG</code> ）为2,147,483,647字节。<code class="codeph">SQL_LONGVARCHAR</code>数据的Oracle限制（列类型为<code class="codeph">CLOB</code> ）为4千兆字节。限制因素是客户端工作站内存。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d21196e681" headers="d21196e643 ">
                                 <p><code class="codeph">SQL_LONGVARCHAR</code>和<code class="codeph">SQL_LONGVARBINARY</code></p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d21196e681 d21196e646 ">
                                 <p>Oracle数据库仅允许每个表中的单个长数据列。长数据类型是<code class="codeph">SQL_LONGVARCHAR</code> （ <code class="codeph">LONG</code> ）和<code class="codeph">SQL_LONGVARBINARY</code> （ <code class="codeph">LONG RAW</code> ）。Oracle建议您改为使用<code class="codeph">CLOB</code>和<code class="codeph">BLOB</code>列。表中的<code class="codeph">CLOB</code>和<code class="codeph">BLOB</code>列数没有限制。
                                 </p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
               </div>
            </div><a id="UNXAR357"></a><div class="props_rev_3"><a id="GUID-E3587401-AE9D-453E-88BC-C70B5A26847D" name="GUID-E3587401-AE9D-453E-88BC-C70B5A26847D"></a><h3 id="UNXAR-GUID-E3587401-AE9D-453E-88BC-C70B5A26847D" class="sect3"><span class="enumeration_section">C.4</span> SQLDriverConnect函数的连接字符串的格式</h3>
               <div>
                  <div class="section">
                     <p><code class="codeph">SQLDriverConnect</code>函数是Oracle ODBC Driver实现的函数之一。下表描述了可以包含在<code class="codeph">SQLDriverConnect</code>函数调用的连接字符串参数中的关键字：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="tblformal" id="GUID-E3587401-AE9D-453E-88BC-C70B5A26847D__GUID-08FAFF34-89D0-4AC2-8AD2-EFCC19DC89E5">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="This 3 column table lists keywords for the SQLDriverConnect function. Column 1 is the keyword. Column 2 is its meaning. Column 3 is its value." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" id="d21196e814">关键词</th>
                              <th align="left" valign="bottom" id="d21196e817">含义</th>
                              <th align="left" valign="bottom" id="d21196e820">值</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" id="d21196e825" headers="d21196e814 ">
                                 <p><code class="codeph">DSN</code></p>
                              </td>
                              <td align="left" valign="top" headers="d21196e825 d21196e817 ">
                                 <p>ODBC数据源名称</p>
                              </td>
                              <td align="left" valign="top" headers="d21196e825 d21196e820 ">
                                 <p>用户提供的名称</p>
                                 <p>这是一个强制性关键字。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" id="d21196e838" headers="d21196e814 ">
                                 <p><code class="codeph">DBQ</code></p>
                              </td>
                              <td align="left" valign="top" headers="d21196e838 d21196e817 ">
                                 <p>TNS服务名称</p>
                              </td>
                              <td align="left" valign="top" headers="d21196e838 d21196e820 ">
                                 <p>用户提供的名称</p>
                                 <p>这是一个强制性关键字。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" id="d21196e851" headers="d21196e814 ">
                                 <p><code class="codeph">UID</code></p>
                              </td>
                              <td align="left" valign="top" headers="d21196e851 d21196e817 ">
                                 <p>用户ID或用户名</p>
                              </td>
                              <td align="left" valign="top" headers="d21196e851 d21196e820 ">
                                 <p>用户提供的名称</p>
                                 <p>这是一个强制性关键字。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" id="d21196e864" headers="d21196e814 ">
                                 <p><code class="codeph">PWD</code></p>
                              </td>
                              <td align="left" valign="top" headers="d21196e864 d21196e817 ">
                                 <p>密码</p>
                              </td>
                              <td align="left" valign="top" headers="d21196e864 d21196e820 ">
                                 <p>用户提供的名称</p>
                                 <p>指定<code class="codeph">PWD=;</code>一个空密码。
                                 </p>
                                 <p>这是一个强制性关键字。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" id="d21196e882" headers="d21196e814 ">
                                 <p><code class="codeph">DBA</code></p>
                              </td>
                              <td align="left" valign="top" headers="d21196e882 d21196e817 ">
                                 <p>数据库属性</p>
                              </td>
                              <td align="left" valign="top" headers="d21196e882 d21196e820 ">
                                 <p><code class="codeph">W</code>意味着写访问</p>
                                 <p><code class="codeph">R</code>意味着只读访问</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" id="d21196e899" headers="d21196e814 ">
                                 <p><code class="codeph">APA</code></p>
                              </td>
                              <td align="left" valign="top" headers="d21196e899 d21196e817 ">
                                 <p>应用属性</p>
                              </td>
                              <td align="left" valign="top" headers="d21196e899 d21196e820 ">
                                 <p><code class="codeph">T</code>意味着要启用线程安全性。
                                 </p>
                                 <p><code class="codeph">F</code>表示禁用线程安全性。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" id="d21196e916" headers="d21196e814 ">
                                 <p><code class="codeph">RST</code></p>
                              </td>
                              <td align="left" valign="top" headers="d21196e916 d21196e817 ">
                                 <p>结果集</p>
                              </td>
                              <td align="left" valign="top" headers="d21196e916 d21196e820 ">
                                 <p><code class="codeph">T</code>意味着要启用结果集。
                                 </p>
                                 <p><code class="codeph">F</code>表示要禁用结果集。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" id="d21196e933" headers="d21196e814 ">
                                 <p><code class="codeph">QTO</code></p>
                              </td>
                              <td align="left" valign="top" headers="d21196e933 d21196e817 ">
                                 <p>查询超时选项</p>
                              </td>
                              <td align="left" valign="top" headers="d21196e933 d21196e820 ">
                                 <p><code class="codeph">T</code>意味着要启用查询超时。
                                 </p>
                                 <p><code class="codeph">F</code>意味着要禁用查询超时。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" id="d21196e950" headers="d21196e814 ">
                                 <p><code class="codeph">企业社会责任</code></p>
                              </td>
                              <td align="left" valign="top" headers="d21196e950 d21196e817 ">
                                 <p>关闭光标</p>
                              </td>
                              <td align="left" valign="top" headers="d21196e950 d21196e820 ">
                                 <p><code class="codeph">T</code>意味着要启用关闭光标。
                                 </p>
                                 <p><code class="codeph">F</code>表示禁用近光标。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" id="d21196e967" headers="d21196e814 ">
                                 <p><code class="codeph">BAM</code></p>
                              </td>
                              <td align="left" valign="top" headers="d21196e967 d21196e817 ">
                                 <p>批量自动提交模式</p>
                              </td>
                              <td align="left" valign="top" headers="d21196e967 d21196e820 ">
                                 <p><code class="codeph">IfAllSuccessful</code>仅在所有语句都成功时暗示提交（旧行为）。
                                 </p>
                                 <p><code class="codeph">UpToFirstFailure</code>意味着提交第一个失败的语句。这是ODBC版本7的行为。
                                 </p>
                                 <p><code class="codeph">AllSuccessful</code>意味着提交所有成功的语句。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" id="d21196e988" headers="d21196e814 ">
                                 <p><code class="codeph">FBS</code></p>
                              </td>
                              <td align="left" valign="top" headers="d21196e988 d21196e817 ">
                                 <p>获取缓冲区大小</p>
                              </td>
                              <td align="left" valign="top" headers="d21196e988 d21196e820 ">
                                 <p>用户提供的数值（指定0或更大的字节值）。默认值为60,000字节。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" id="d21196e1000" headers="d21196e814 ">
                                 <p><code class="codeph">分</code></p>
                              </td>
                              <td align="left" valign="top" headers="d21196e1000 d21196e817 ">
                                 <p>故障转移</p>
                              </td>
                              <td align="left" valign="top" headers="d21196e1000 d21196e820 ">
                                 <p><code class="codeph">T</code>表示启用故障转移。
                                 </p>
                                 <p><code class="codeph">F</code>表示要禁用故障转移。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" id="d21196e1017" headers="d21196e814 ">
                                 <p><code class="codeph">FRC</code></p>
                              </td>
                              <td align="left" valign="top" headers="d21196e1017 d21196e817 ">
                                 <p>故障转移重试计数</p>
                              </td>
                              <td align="left" valign="top" headers="d21196e1017 d21196e820 ">
                                 <p>用户提供的数值。</p>
                                 <p>默认值为10。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" id="d21196e1030" headers="d21196e814 ">
                                 <p><code class="codeph">FDL</code></p>
                              </td>
                              <td align="left" valign="top" headers="d21196e1030 d21196e817 ">
                                 <p>故障转移延迟</p>
                              </td>
                              <td align="left" valign="top" headers="d21196e1030 d21196e820 ">
                                 <p>用户提供的数值。</p>
                                 <p>默认值为10。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" id="d21196e1043" headers="d21196e814 ">
                                 <p><code class="codeph">高球</code></p>
                              </td>
                              <td align="left" valign="top" headers="d21196e1043 d21196e817 ">
                                 <p>LOB写道</p>
                              </td>
                              <td align="left" valign="top" headers="d21196e1043 d21196e820 ">
                                 <p><code class="codeph">T</code>意味着要启用LOB。
                                 </p>
                                 <p><code class="codeph">F</code>意味着要禁用LOB。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" id="d21196e1060" headers="d21196e814 ">
                                 <p><code class="codeph">FWC</code></p>
                              </td>
                              <td align="left" valign="top" headers="d21196e1060 d21196e817 ">
                                 <p>强制<code class="codeph">SQL_WCHAR</code>支持</p>
                              </td>
                              <td align="left" valign="top" headers="d21196e1060 d21196e820 ">
                                 <p><code class="codeph">T</code>表示要启用<code class="codeph">Force SQL_WCHAR</code> 。
                                 </p>
                                 <p><code class="codeph">F</code>表示要禁用<code class="codeph">Force SQL_WCHAR</code> 。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" id="d21196e1086" headers="d21196e814 ">
                                 <p><code class="codeph">EXC</code></p>
                              </td>
                              <td align="left" valign="top" headers="d21196e1086 d21196e817 ">
                                 <p><code class="codeph">EXEC</code>语法</p>
                              </td>
                              <td align="left" valign="top" headers="d21196e1086 d21196e820 ">
                                 <p><code class="codeph">T</code>意味着要启用<code class="codeph">EXEC</code>语法。
                                 </p>
                                 <p><code class="codeph">F</code>意味着要禁用<code class="codeph">EXEC</code>语法。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" id="d21196e1111" headers="d21196e814 ">
                                 <p><code class="codeph">XSM</code></p>
                              </td>
                              <td align="left" valign="top" headers="d21196e1111 d21196e817 ">
                                 <p>架构字段</p>
                              </td>
                              <td align="left" valign="top" headers="d21196e1111 d21196e820 ">
                                 <p><code class="codeph">Default</code>意味着要使用默认值。
                                 </p>
                                 <p><code class="codeph">Database</code>意味着要使用数据库名称。
                                 </p>
                                 <p><code class="codeph">Owner</code>意味着要使用所有者的名称。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" id="d21196e1132" headers="d21196e814 ">
                                 <p><code class="codeph">MDI</code></p>
                              </td>
                              <td align="left" valign="top" headers="d21196e1132 d21196e817 ">
                                 <p>设置元数据ID默认值</p>
                              </td>
                              <td align="left" valign="top" headers="d21196e1132 d21196e820 ">
                                 <p><code class="codeph">T</code>表示<code class="codeph">SQL_ATTR_METADATA_ID</code>的默认值为<code class="codeph">SQL_TRUE</code> 。</p>
                                 <p><code class="codeph">F</code>表示<code class="codeph">SQL_ATTR_METADATA_ID</code>的默认值为<code class="codeph">SQL_FALSE</code> 。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" id="d21196e1161" headers="d21196e814 ">
                                 <p><code class="codeph">DPM</code></p>
                              </td>
                              <td align="left" valign="top" headers="d21196e1161 d21196e817 ">
                                 <p>禁用<code class="codeph">SQLDescribeParam</code></p>
                              </td>
                              <td align="left" valign="top" headers="d21196e1161 d21196e820 ">
                                 <p><code class="codeph">T</code>意味着要禁用<code class="codeph">SQLDescribeParam</code> 。
                                 </p>
                                 <p><code class="codeph">F</code>意味着要启用<code class="codeph">SQLDescribeParam</code> 。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" id="d21196e1186" headers="d21196e814 ">
                                 <p><code class="codeph">BTD</code></p>
                              </td>
                              <td align="left" valign="top" headers="d21196e1186 d21196e817 ">
                                 <p>将<code class="codeph">TIMESTAMP</code>绑定为<code class="codeph">DATE</code></p>
                              </td>
                              <td align="left" valign="top" headers="d21196e1186 d21196e820 ">
                                 <p><code class="codeph">T</code>意味着<code class="codeph">SQL_TIMESTAMP</code>将被绑定为Oracle <code class="codeph">DATE</code> 。</p>
                                 <p><code class="codeph">F</code>意味着<code class="codeph">SQL_TIMESTAMP</code>将被绑定为Oracle <code class="codeph">TIMESTAMP</code> 。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" id="d21196e1220" headers="d21196e814 ">
                                 <p><code class="codeph">NUM</code></p>
                              </td>
                              <td align="left" valign="top" headers="d21196e1220 d21196e817 ">
                                 <p>数字设置</p>
                              </td>
                              <td align="left" valign="top" headers="d21196e1220 d21196e820 ">
                                 <p><code class="codeph">NLS</code>意味着将使用全球化支持数字设置（以确定小数和组分隔符）。
                                 </p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
               </div>
            </div><a id="UNXAR358"></a><div class="props_rev_3"><a id="GUID-B7D91AB2-A116-41F1-BC29-D55DA4E2F60C" name="GUID-B7D91AB2-A116-41F1-BC29-D55DA4E2F60C"></a><h3 id="UNXAR-GUID-B7D91AB2-A116-41F1-BC29-D55DA4E2F60C" class="sect3"><span class="enumeration_section">C.5</span>减少程序中的锁定超时</h3>
               <div>
                  <p>Oracle数据库无限期地等待要解析的事务之间的锁冲突。但是，您可以限制Oracle数据库等待解析锁定的时间。为此，请在连接到数据源之前调用此函数时设置ODBC <code class="codeph">SQLSetStmtAttr</code>函数的<code class="codeph">SQL_ATTR_QUERY_TIMEOUT</code>属性。
                  </p>
               </div>
            </div><a id="UNXAR359"></a><div class="props_rev_3"><a id="GUID-071B8E13-4549-4162-89CE-284D6561450B" name="GUID-071B8E13-4549-4162-89CE-284D6561450B"></a><h3 id="UNXAR-GUID-071B8E13-4549-4162-89CE-284D6561450B" class="sect3"><span class="enumeration_section">C.6</span>链接ODBC应用程序</h3>
               <div>
                  <p>链接程序时，必须将其与驱动程序管理器库<code class="codeph">libodbc.so</code> 。
                  </p>
               </div>
            </div><a id="UNXAR360"></a><div class="props_rev_3"><a id="GUID-67008F0C-E833-4FE0-AE32-06B7532F6115" name="GUID-67008F0C-E833-4FE0-AE32-06B7532F6115"></a><h3 id="UNXAR-GUID-67008F0C-E833-4FE0-AE32-06B7532F6115" class="sect3"><span class="enumeration_section">C.7</span>获取有关ROWID的信息</h3>
               <div>
                  <p>ODBC <code class="codeph">SQLSpecialColumns</code>函数返回有关表中列的信息。与Oracle ODBC驱动程序一起使用时，它返回有关与Oracle表关联的Oracle ROWID的信息。
                  </p>
               </div>
            </div><a id="UNXAR361"></a><div class="props_rev_3"><a id="GUID-4C04A996-909E-4783-93CC-D53B293B0529" name="GUID-4C04A996-909E-4783-93CC-D53B293B0529"></a><h3 id="UNXAR-GUID-4C04A996-909E-4783-93CC-D53B293B0529" class="sect3"><span class="enumeration_section">C.8</span> WHERE子句中的ROWID</h3>
               <div>
                  <p>ROWID可以在SQL语句的<code class="codeph">WHERE</code>子句中使用。但是，ROWID值必须以参数标记显示。
                  </p>
               </div>
            </div><a id="UNXAR362"></a><div class="props_rev_3"><a id="GUID-05F6FB92-D15B-439B-8F02-9A45F2E276E0" name="GUID-05F6FB92-D15B-439B-8F02-9A45F2E276E0"></a><h3 id="UNXAR-GUID-05F6FB92-D15B-439B-8F02-9A45F2E276E0" class="sect3"><span class="enumeration_section">C.9</span>启用结果集</h3>
               <div>
                  <p>Oracle引用游标（也称为结果集）使应用程序能够使用存储过程和存储函数来检索数据。以下信息描述如何使用引用游标通过ODBC启用结果集：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>您必须使用ODBC语法来调用存储过程。ODBC不支持原生PL / SQL。以下代码示例标识了如何在没有包和包内的情况下调用过程或函数。在这种情况下，包名称是<code class="codeph">RSET</code> 。</p><pre class="oac_no_warn" dir="ltr">过程调用：{CALL Example1（？）}{CALL RSET.Example1（？）}功能调用：{？= CALL示例1（？）}{？= CALL RSET.Example1（？）}
</pre></li>
                     <li>
                        <p>调用过程时，省略PL / SQL引用游标参数。例如，假设过程<code class="codeph">Example2</code>被定义为具有四个参数。参数1和3是参考光标参数，参数2和4是字符串。该呼叫指定为：</p><pre class="oac_no_warn" dir="ltr">{CALL RSET.Example2（“Literal 1”，“Literal 2”）}</pre></li>
                  </ul>
                  <p>以下示例应用程序显示了如何使用Oracle ODBC Driver返回结果集：</p><pre class="oac_no_warn" dir="ltr">/ * *通过ODBC使用Oracle引用游标的示例应用程序* *假设：* * 1）Oracle示例数据库存在为EMP表加载的数据。* * 2）EMP表中引用了两个字段，ename和mgr。* * 3）已设置数据源以访问示例数据库。* * *程序说明：* *摘要：* *此程序演示如何使用* Oracle存储过程返回结果集* *详细信息：* *此程序：*创建与数据库的ODBC连接。*创建包含两个结果集的打包过程。*执行该过程并从两个结果集中检索数据。*向用户显示数据。*删除包然后将用户从数据库中注销。* * *以下是此代码生成的实际PL / SQL *创建存储过程。* DROP PACKAGE ODBCRefCur;创建包ODBCRefCur作为类型ename_cur是REF CURSOR; TYPE mgr_cur是REF CURSOR;程序EmpCurs（Ename IN OUT ename_cur，Mgr IN OUT mgr_cur，pjob in VARCHAR2）;结束; / CREATE PACKAGE BODY ODBCRefCur作为程序EmpCurs（En out IN OUT ename_cur，Mgr IN OUT mgr_cur，pjob in VARCHAR2）如果不是，则启动％ISOPEN然后打开Ename for ename from emp;万一;如果不是Mgr％ISOPEN那么OPEN Mgr for SELECT mgr from emp where job = pjob;万一;结束;结束; / * *结束参考光标的PL / SQL。* / / * *包含文件* / #include &lt;stdio.h&gt; #include &lt;sql.h&gt; #include &lt;sqlext.h&gt; / * *定义* / #define JOB_LEN 9 #define DATA_LEN 100 #define SQL_STMT_LEN 500 / * *程序* / void DisplayError（SWORD HandleType，SQLHANDLE hHandle，char * Module）; / * *主程序* / int main（）{SQLHENV hEnv; SQLHDBC hDbc; SQLHSTMT hStmt; SQLRETURN rc; char * DefUserName =“jones”; char * DefPassWord =“ <span class="italic">密码</span> ”; SQLCHAR ServerName [DATA_LEN]; SQLCHAR * pServerName = ServerName; SQLCHAR用户名[DATA_LEN]; SQLCHAR * pUserName = UserName; SQLCHAR PassWord [DATA_LEN]; SQLCHAR * pPassWord = PassWord; char数据[DATA_LEN]; SQLINTEGER DataLen; char错误[DATA_LEN]; char * charptr; SQLCHAR SqlStmt [SQL_STMT_LEN]; SQLCHAR * pSqlStmt = SqlStmt; char * pSalesMan =“SALESMAN”; SQLINTEGER sqlnts = SQL_NTS; / * *分配环境句柄* / rc = SQLAllocHandle（SQL_HANDLE_ENV，SQL_NULL_HANDLE，＆hEnv）;如果（rc！= SQL_SUCCESS）{printf（“无法分配环境句柄\ n”）; printf（“\ nHit返回退出\ n”）; charptr = gets（（char *）error）;出口（1）; } / * *设置ODBC Version * / rc = SQLSetEnvAttr（hEnv，SQL_ATTR_ODBC_VERSION，（void *）SQL_OV_ODBC3,0）;如果（rc！= SQL_SUCCESS）{printf（“无法设置ODBC版本\ n”）; printf（“\ nHit返回退出\ n”）; charptr = gets（（char *）error）;出口（1）; } / * *分配Connection句柄* / rc = SQLAllocHandle（SQL_HANDLE_DBC，hEnv，＆hDbc）;如果（rc！= SQL_SUCCESS）{printf（“无法分配连接句柄\ n”）; printf（“\ nHit返回退出\ n”）; charptr = gets（（char *）error）;出口（1）; } / * *获取用户信息* / strcpy（（char *）pUserName，DefUserName）; strcpy（（char *）pPassWord，DefPassWord）; / * *数据源名称* / printf（“\ n输入ODBC数据源名称\ n”）; charptr = gets（（char *）ServerName）; / * *用户名* / printf（“\ n输入用户名默认值[％s] \ n”，pUserName）; charptr = gets（（char *）UserName）; if（* charptr =='\ 0'）{strcpy（（char *）pUserName，（char *）DefUserName）; } / * *密码* / printf（“\ n输入密码默认值[％s] \ n”，pPassWord）; charptr = gets（（char *）PassWord）; if（* charptr =='\ 0'）{strcpy（（char *）pPassWord，（char *）DefPassWord）; } / * *连接数据库* / rc = SQLConnect（hDbc，pServerName，（SQLSMALLINT）strlen（（char *）pServerName），pUserName，（SQLSMALLINT）strlen（（char *）pUserName），pPassWord，（SQLSMALLINT）strlen （（char *）pPassWord））;如果（rc！= SQL_SUCCESS）{DisplayError（SQL_HANDLE_DBC，hDbc，“SQLConnect”）; } / * *分配语句* / rc = SQLAllocHandle（SQL_HANDLE_STMT，hDbc和＆hStmt）;如果（rc！= SQL_SUCCESS）{printf（“无法分配语句句柄\ n”）; printf（“\ nHit返回退出\ n”）; charptr = gets（（char *）error）;出口（1）;删除包* / strcpy（（char *）pSqlStmt，“DROP PACKAGE ODBCRefCur”）; rc = SQLExecDirect（hStmt，pSqlStmt，strlen（（char *）pSqlStmt））; / * *创建包头* / strcpy（（char *）pSqlStmt，“CREATE PACKAGE ODBCRefCur AS \ n”）; strcat（（char *）pSqlStmt，“TYPE ename_cur IS REF CURSOR; \ n”）; strcat（（char *）pSqlStmt，“TYPE mgr_cur是REF CURSOR; \ n \ n”）; strcat（（char *）pSqlStmt，“PROCEDURE EmpCurs（Ename IN OUT ename_cur，”）; strcat（（char *）pSqlStmt，“Mgr IN OUT mgr_cur，pjob IN VARCHAR2）; \ n \ n”）; strcat（（char *）pSqlStmt，“END; \ n”）; rc = SQLExecDirect（hStmt，pSqlStmt，strlen（（char *）pSqlStmt））;如果（rc！= SQL_SUCCESS）{DisplayError（SQL_HANDLE_STMT，hStmt，“SQLExecDirect”）; } / * *创建Package Body * / strcpy（（char *）pSqlStmt，“CREATE PACKAGE BODY ODBCRefCur AS \ n”）; strcat（（char *）pSqlStmt，“PROCEDURE EmpCurs（Ename IN OUT ename_cur，”）; strcat（（char *）pSqlStmt，“Mgr IN OUT mgr_cur，pjob IN VARCHAR2）\ n AS \ n BEGIN \ n”）; strcat（（char *）pSqlStmt，“IF NOT Ename％ISOPEN \ n THEN \ n”）; strcat（（char *）pSqlStmt，“OPEN Ename for SELECT ename from emp; \ n”）; strcat（（char *）pSqlStmt，“END IF; \ n \ n”）; strcat（（char *）pSqlStmt，“IF NOT Mgr％ISOPEN \ n THEN \ n”）; strcat（（char *）pSqlStmt，“OPEN Mgr for SELECT mgr from emp where job = pjob; \ n”）; strcat（（char *）pSqlStmt，“END IF; \ n”）; strcat（（char *）pSqlStmt，“END; \ n”）; strcat（（char *）pSqlStmt，“END; \ n”）; rc = SQLExecDirect（hStmt，pSqlStmt，strlen（（char *）pSqlStmt））;如果（rc！= SQL_SUCCESS）{DisplayError（SQL_HANDLE_STMT，hStmt，“SQLExecDirect”）; } / * *绑定Parameter * / rc = SQLBindParameter（hStmt，1，SQL_PARAM_INPUT，SQL_C_CHAR，SQL_CHAR，JOB_LEN，0，pSalesMan，0和sqlnts）; / * *调用执行结果集的存储过程* / strcpy（（char *）pSqlStmt，“{CALL ODBCRefCur。EmpCurs（？）}“）; rc = SQLExecDirect（hStmt，pSqlStmt，strlen（（char *）pSqlStmt））; if（rc！= SQL_SUCCESS）{DisplayError（SQL_HANDLE_STMT，hStmt，“SQLExecDirect”）; } / * *绑定Data * / rc = SQLBindCol（hStmt，1，SQL_C_CHAR，Data，sizeof（Data）和DataLen）;如果（rc！= SQL_SUCCESS）{DisplayError（SQL_HANDLE_STMT，hStmt，“SQLBindCol”）; } / * *获取结果集1 * / printf（“\ nEmployee Names \ n \ n”）的数据; while（rc == SQL_SUCCESS）{rc = SQLFetch（hStmt）; if（rc == SQL_SUCCESS）{printf（“％s \ n”，Data）; } else {if（rc！= SQL_NO_DATA）{DisplayError（SQL_HANDLE_STMT，hStmt，“SQLFetch”）; printf（“\ n第一个结果集 - 命中返回继续\ n”）; charptr = gets（（char *）error）; / * *获取下一个结果集* / rc = SQLMoreResults（hStmt）;如果（rc！= SQL_SUCCESS）{DisplayError（SQL_HANDLE_STMT，hStmt，“SQLMoreResults”）; } / * *获取结果集2 * / printf（“\ nManagers \ n \ n”）的数据; while（rc == SQL_SUCCESS）{rc = SQLFetch（hStmt）; if（rc == SQL_SUCCESS）{printf（“％s \ n”，Data）; } else {if（rc！= SQL_NO_DATA）{DisplayError（SQL_HANDLE_STMT，hStmt，“SQLFetch”）; printf（“\ n第二个结果集 - 命中返回继续\ n”）; charptr = gets（（char *）error）; / * *应该不再有结果集* / rc = SQLMoreResults（hStmt）;如果（rc！= SQL_NO_DATA）{DisplayError（SQL_HANDLE_STMT，hStmt，“SQLMoreResults”）;删除包* / strcpy（（char *）pSqlStmt，“DROP PACKAGE ODBCRefCur”）; rc = SQLExecDirect（hStmt，pSqlStmt，strlen（（char *）pSqlStmt））; / * * Free处理与数据库的紧密连接* / SQLFreeHandle（SQL_HANDLE_STMT，hStmt）; SQLDisconnect（hDbc）; SQLFreeHandle（SQL_HANDLE_DBC，hDbc）; SQLFreeHandle（SQL_HANDLE_ENV，hEnv）; printf（“\ n全部完成 - 命中返回退出\ n”）; charptr = gets（（char *）error）;返回（0）; } / * *显示错误消息* / void DisplayError（SWORD HandleType，SQLHANDLE hHandle，char * Module）{SQLCHAR MessageText [255]; SQLCHAR SQLState [80]; SQLRETURN rc = SQL_SUCCESS;长NativeError; SWORD RetLen; SQLCHAR错误[25]; char * charptr; rc = SQLGetDiagRec（HandleType，hHandle，1，SQLState，＆NativeError，MessageText，255，＆RetLen）; printf（“失败调用％s \ n”，模块）; if（rc == SQL_SUCCESS || rc == SQL_SUCCESS_WITH_INFO）{printf（“\ t \ t \ tttr：％s \ n”，SQLState）; printf（“\ t \ t \ t原生错误：％d \ n”，NativeError）; printf（“\ t \ t \ t错误信息：％s \ n”，MessageText）; } printf（“\ nHit返回退出\ n”）; charptr = gets（（char *）error）;出口（1）; }</pre></div>
            </div><a id="UNXAR363"></a><div class="props_rev_3"><a id="GUID-9E81960A-5706-474D-BB64-E03D1819E1B3" name="GUID-9E81960A-5706-474D-BB64-E03D1819E1B3"></a><h3 id="UNXAR-GUID-9E81960A-5706-474D-BB64-E03D1819E1B3" class="sect3"><span class="enumeration_section">C.10</span>启用EXEC语法</h3>
               <div>
                  <p>如果SQL Server <code class="codeph">EXEC</code>语句的语法可以很容易地转换为等效的Oracle过程调用而不需要对其进行任何更改，那么如果启用此选项，Oracle ODBC Driver可以将其翻译。
                  </p>
                  <p>SQL Server过程的完整名称最多包含四个标识符：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>服务器名称</p>
                     </li>
                     <li>
                        <p>数据库名称</p>
                     </li>
                     <li>
                        <p>所有者名称</p>
                     </li>
                     <li>
                        <p>程序名称</p>
                     </li>
                  </ul>
                  <p>名称的格式为：</p><pre class="oac_no_warn" dir="ltr">[[[服务器] [数据库]。] [OWNER_NAME]。] PROCEDURE_NAME</pre><p>在将Microsoft SQL Server数据库迁移到Oracle数据库期间，每个SQL Server过程或函数的定义都将转换为其等效的Oracle数据库语法，并在Oracle数据库的模式中定义。迁移过程通常通过以下方式之一重新组织（并在模式中创建）：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>所有过程都迁移到一个模式（默认选项）。</p>
                     </li>
                     <li>
                        <p>在一个SQL Server数据库中定义的所有过程都将迁移到使用该数据库名称命名的模式。</p>
                     </li>
                     <li>
                        <p>一个用户拥有的所有过程都将迁移到使用该用户名命名的模式。</p>
                     </li>
                  </ul>
                  <p>要支持这三种组织迁移过程的方法，可以指定其中一个模式名称选项来转换过程名称。已转换的Oracle过程调用中的对象名称不区分大小写。</p>
               </div>
            </div><a id="UNXAR364"></a><div class="props_rev_3"><a id="GUID-CA2BC55D-8420-4735-8B22-B11311397C03" name="GUID-CA2BC55D-8420-4735-8B22-B11311397C03"></a><h3 id="UNXAR-GUID-CA2BC55D-8420-4735-8B22-B11311397C03" class="sect3"><span class="enumeration_section">C.11</span>支持的功能</h3>
               <div>
                  <p>本节提供有关Oracle ODBC Driver支持的功能的信息。它包含以下部分：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="using-oracle-ODBC-driver.html#GUID-03636B8F-E806-40EF-B817-D991D7DD3CA0">API一致性</a></p>
                     </li>
                     <li>
                        <p><a href="using-oracle-ODBC-driver.html#GUID-8AB8015C-0DC6-4F6B-B5BF-E6230A6F1422">ODBC API函数的实现</a></p>
                     </li>
                     <li>
                        <p><a href="using-oracle-ODBC-driver.html#GUID-CB739B7D-0764-4A76-9451-F4FCF6F44914">ODBC SQL语法的实现</a></p>
                     </li>
                     <li>
                        <p><a href="using-oracle-ODBC-driver.html#GUID-D60661E4-9E77-4CFF-B569-13CF9417F2CE">数据类型的实现</a></p>
                     </li>
                  </ul>
               </div><a id="UNXAR365"></a><div class="props_rev_3"><a id="GUID-03636B8F-E806-40EF-B817-D991D7DD3CA0" name="GUID-03636B8F-E806-40EF-B817-D991D7DD3CA0"></a><h4 id="UNXAR-GUID-03636B8F-E806-40EF-B817-D991D7DD3CA0" class="sect4"><span class="enumeration_section">C.11.1</span> API一致性</h4>
                  <div>
                     <div class="section">
                        <p>Oracle ODBC驱动程序10.2.0.1.0及更高版本支持所有Core，Level 2和Level 1功能。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="UNXAR367"></a><a id="UNXAR366"></a><div class="props_rev_3"><a id="GUID-8AB8015C-0DC6-4F6B-B5BF-E6230A6F1422" name="GUID-8AB8015C-0DC6-4F6B-B5BF-E6230A6F1422"></a><h4 id="UNXAR-GUID-8AB8015C-0DC6-4F6B-B5BF-E6230A6F1422" class="sect4"><span class="enumeration_section">C.11.2</span> ODBC API函数的实现</h4>
                  <div>
                     <div class="section">
                        <p>下表描述了Oracle ODBC Driver如何实现特定功能：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="tblformal" id="GUID-8AB8015C-0DC6-4F6B-B5BF-E6230A6F1422__GUID-70D80339-9EEA-4C84-8836-398A242B26B8">
                        <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="This 2 column table describes how Oracle ODBC Driver implements specific functions. Column 1 is the function. Column 2 describes how it is implemented." frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="30%" id="d21196e2080">功能</th>
                                 <th align="left" valign="bottom" width="70%" id="d21196e2083">描述</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="30%" id="d21196e2088" headers="d21196e2080 ">
                                    <p><code class="codeph">的SQLConnect</code></p>
                                 </td>
                                 <td align="left" valign="top" width="70%" headers="d21196e2088 d21196e2083 ">
                                    <p><code class="codeph">SQLConnect</code>仅需要<code class="codeph">DBQ</code> ，用户ID和密码。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="30%" id="d21196e2101" headers="d21196e2080 ">
                                    <p><code class="codeph">的SQLDriverConnect</code></p>
                                 </td>
                                 <td align="left" valign="top" width="70%" headers="d21196e2101 d21196e2083 ">
                                    <p><code class="codeph">SQLDriverConnect</code>使用<code class="codeph">DSN</code> ， <code class="codeph">DBQ</code> ， <code class="codeph">UID</code>和<code class="codeph">PWD</code>关键字。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="30%" id="d21196e2123" headers="d21196e2080 ">
                                    <p><code class="codeph">SQLSpecialColumns</code></p>
                                 </td>
                                 <td align="left" valign="top" width="70%" headers="d21196e2123 d21196e2083 ">
                                    <p>如果使用<code class="codeph">SQL_BEST_ROWID</code>属性调用<code class="codeph">SQLSpecialColumns</code> ，则它始终返回ROWID列。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="30%" id="d21196e2137" headers="d21196e2080 ">
                                    <p><code class="codeph">SQLProcedures</code>和<code class="codeph">SQLProcedureColumns</code></p>
                                 </td>
                                 <td align="left" valign="top" width="70%" headers="d21196e2137 d21196e2083 ">
                                    <p>请参阅以下行中的信息。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="30%" id="d21196e2148" headers="d21196e2080 ">
                                    <p>所有目录功能</p>
                                 </td>
                                 <td align="left" valign="top" width="70%" headers="d21196e2148 d21196e2083 ">
                                    <p>如果<code class="codeph">SQL_ATTR_METADATA_ID</code>语句属性设置为<code class="codeph">SQL_TRUE</code> ，则字符串参数将被视为标识符参数，并且其大小写不重要。在这种情况下，下划线（_）和百分号（％）被视为实际字符，而不是搜索模式字符。相反，如果此属性设置为<code class="codeph">SQL_FALSE</code> ，则它是普通参数或模式值参数，并按字面处理，其大小写很重要。
                                    </p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-8AB8015C-0DC6-4F6B-B5BF-E6230A6F1422__GUID-F1985036-61AE-4CC6-9DFF-47129B0DEB1C">SQLProcedures和SQLProcedureColumns</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>已修改<code class="codeph">SQLProcedures</code>和<code class="codeph">SQLProcedureColumns</code>调用，以查找和返回有关所有过程和函数的信息，即使它们包含在包中也是如此。在早期版本中，调用只发现了包之外的过程和函数。以下示例和方案显示了<code class="codeph">SQL_ATTR_METADATA_ID</code>属性设置为<code class="codeph">SQL_FALSE</code>返回的过程或函数。</p>
                        <p>假设您有以下存储过程：</p><pre class="oac_no_warn" dir="ltr">“BAR”“BARX”“XBAR”“XBARX”“SQLPROCTEST.BAR”“SQLPROCTEST.BARX”“SQLPROCTEST.XBAR”“SQLPROCTEST.XBARX”</pre><p>当您查找<code class="codeph">%</code>或<code class="codeph">%%%%%%</code> ，您将获得所有八个程序。
                        </p>
                        <p>当您查找<code class="codeph">%_</code>或<code class="codeph">_%</code> ，您将获得以下内容：</p><pre class="oac_no_warn" dir="ltr">BAR BARX XBAR XBARX</pre><p>当你寻找<code class="codeph">.</code>或<code class="codeph">.%</code>或<code class="codeph">%.%</code>或<code class="codeph">SQLPROC%.</code>或<code class="codeph">SQLPROC%.%</code> ，您得到以下内容：</p><pre class="oac_no_warn" dir="ltr">SQLPROCTEST.BAR SQLPROCTEST.BARX SQLPROCTEST.XBAR SQLPROCTEST.XBARX</pre><p>当您查找<code class="codeph">%BAR</code> ，您会得到以下内容：</p><pre class="oac_no_warn" dir="ltr">BAR XBAR</pre><p>当你寻找<code class="codeph">.%BAR</code>或<code class="codeph">%.%BAR</code> ，您将获得以下内容：</p><pre class="oac_no_warn" dir="ltr">SQLPROCTEST.BAR SQLPROCTEST.XBAR</pre><p>当你寻找<code class="codeph">SQLPROC%</code>或<code class="codeph">.SQLPROC%</code> ，您得到以下内容：</p><pre class="oac_no_warn" dir="ltr">什么都没有（0行）</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="UNXAR368"></a><div class="props_rev_3"><a id="GUID-CB739B7D-0764-4A76-9451-F4FCF6F44914" name="GUID-CB739B7D-0764-4A76-9451-F4FCF6F44914"></a><h4 id="UNXAR-GUID-CB739B7D-0764-4A76-9451-F4FCF6F44914" class="sect4"><span class="enumeration_section">C.11.3</span> ODBC SQL语法的实现</h4>
                  <div>
                     <p>如果比较谓词将参数标记作为比较中的第二个表达式，并且该参数的值使用<code class="codeph">SQLBindParameter</code>设置为<code class="codeph">SQL_NULL_DATA</code> ，则比较将失败。这与ODBC SQL中的空谓词语法一致。</p>
                  </div>
               </div><a id="UNXAR369"></a><div class="props_rev_3"><a id="GUID-D60661E4-9E77-4CFF-B569-13CF9417F2CE" name="GUID-D60661E4-9E77-4CFF-B569-13CF9417F2CE"></a><h4 id="UNXAR-GUID-D60661E4-9E77-4CFF-B569-13CF9417F2CE" class="sect4"><span class="enumeration_section">C.11.4</span>数据类型的实现</h4>
                  <div>
                     <p>对于程序员来说，数据类型实现中最重要的部分涉及<code class="codeph">CHAR</code> ， <code class="codeph">VARCHAR</code>和<code class="codeph">VARCHAR2</code>数据类型。
                     </p>
                     <p>对于<code class="codeph">SQL_VARCHAR</code>的<code class="codeph">fSqlType</code>值， <code class="codeph">SQLGetTypeInfo</code>返回Oracle数据库数据类型<code class="codeph">VARCHAR2</code> 。对于<code class="codeph">SQL_CHAR</code>的<code class="codeph">fSqlType</code>值， <code class="codeph">SQLGetTypeInfo</code>返回Oracle数据库数据类型<code class="codeph">CHAR</code> 。</p>
                  </div>
               </div>
            </div><a id="UNXAR370"></a><div class="props_rev_3"><a id="GUID-7075D133-A698-449F-82CC-D86EA4CD4391" name="GUID-7075D133-A698-449F-82CC-D86EA4CD4391"></a><h3 id="UNXAR-GUID-7075D133-A698-449F-82CC-D86EA4CD4391" class="sect3"><span class="enumeration_section">C.12</span> Unicode支持</h3>
               <div>
                  <p>本节提供有关Unicode支持的信息。它包含以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="using-oracle-ODBC-driver.html#GUID-307963BA-2906-4954-A723-315E346E7451">ODBC环境中的Unicode支持</a></p>
                     </li>
                     <li>
                        <p><a href="using-oracle-ODBC-driver.html#GUID-85BAD912-58FD-4E77-946F-99F7A3E6C100">ODBC API中的Unicode支持</a></p>
                     </li>
                     <li>
                        <p><a href="using-oracle-ODBC-driver.html#GUID-9227818A-0ACC-4CF5-A8F4-564FD99710D7">SQLGetData性能</a></p>
                     </li>
                     <li>
                        <p><a href="using-oracle-ODBC-driver.html#GUID-A259DEBF-70CE-4E4F-AA0B-00A723DC047F">Unicode示例</a></p>
                     </li>
                  </ul>
               </div><a id="UNXAR371"></a><div class="props_rev_3"><a id="GUID-307963BA-2906-4954-A723-315E346E7451" name="GUID-307963BA-2906-4954-A723-315E346E7451"></a><h4 id="UNXAR-GUID-307963BA-2906-4954-A723-315E346E7451" class="sect4"><span class="enumeration_section">C.12.1</span> ODBC环境中的Unicode支持</h4>
                  <div>
                     <p>ODBC驱动程序管理器使所有ODBC驱动程序（无论它们是否支持Unicode）都显示为符合Unicode。这允许独立于底层ODBC驱动程序的Unicode功能编写ODBC应用程序。</p>
                     <p>驱动程序管理器可以模拟对ANSI ODBC驱动程序的Unicode支持的程度受限于Unicode数据和本地代码页之间可能的转换。当驱动程序管理器从Unicode转换为本地代码页时，可能会丢失数据。除非底层ODBC驱动程序支持Unicode，否则无法使用完全Unicode支持。Oracle ODBC Driver提供完整的Unicode支持。</p>
                  </div>
               </div><a id="UNXAR372"></a><div class="props_rev_3"><a id="GUID-85BAD912-58FD-4E77-946F-99F7A3E6C100" name="GUID-85BAD912-58FD-4E77-946F-99F7A3E6C100"></a><h4 id="UNXAR-GUID-85BAD912-58FD-4E77-946F-99F7A3E6C100" class="sect4"><span class="enumeration_section">C.12.2</span> ODBC API中的Unicode支持</h4>
                  <div>
                     <p>ODBC API使用<code class="codeph">W</code>和<code class="codeph">A</code>后缀约定支持Unicode和ANSI入口点。ODBC应用程序开发人员不显式调用带后缀的入口点。使用<code class="codeph">UNICODE</code>和<code class="codeph">_UNICODE</code>预处理程序定义编译的ODBC应用程序会生成相应的调用。例如，对<code class="codeph">SQLPrepare</code>的调用将编译为<code class="codeph">SQLPrepareW</code> 。</p>
                     <p>C数据类型<code class="codeph">SQL_C_WCHAR</code>已添加到ODBC接口，以允许应用程序指定输入参数编码为Unicode或请求以Unicode返回的列数据。宏<code class="codeph">SQL_C_TCHAR</code>对于必须同时构建为Unicode和ANSI的应用程序非常有用。 <code class="codeph">SQL_C_TCHAR</code>宏编译为Unicode应用程序的<code class="codeph">SQL_C_WCHAR</code>和ANSI应用程序的<code class="codeph">SQL_C_CHAR</code> 。
                     </p>
                     <p>SQL数据类型<code class="codeph">SQL_WCHAR</code> ， <code class="codeph">SQL_WVARCHAR</code>和<code class="codeph">SQL_WLONGVARCHAR</code>已添加到ODBC接口，以将表中定义的列表示为Unicode。潜在地，这些值是从对<code class="codeph">SQLDescribeCol</code> ， <code class="codeph">SQLColAttribute</code> ， <code class="codeph">SQLColumns</code>和<code class="codeph">SQLProcedureColumns</code>调用返回的。
                     </p>
                     <p>SQL列类型NCHAR，NVARCHAR2和NCLOB支持Unicode编码。此外，如果在列定义中指定了字符语义，则SQL列类型CHAR和VARCHAR2也支持Unicode编码。</p>
                     <p>Oracle ODBC驱动程序支持这些SQL列类型并将它们映射到ODBC SQL数据类型。下表列出了支持的SQL数据类型和等效的ODBC SQL数据类型：</p>
                     <div class="tblformal" id="GUID-85BAD912-58FD-4E77-946F-99F7A3E6C100__GUID-3C3ECC7A-A7A7-4360-A741-B9F695E99FC9">
                        <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="This 2 column table lists the supported SQL data types and the equivalent ODBC SQL data type. Column 1 is the SQL data type. Column 2 is the equivalent ODBC SQL data type." frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="32%" id="d21196e2799">SQL数据类型</th>
                                 <th align="left" valign="bottom" width="68%" id="d21196e2802">ODBC SQL数据类型</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="32%" id="d21196e2807" headers="d21196e2799 ">
                                    <p><code class="codeph">CHAR</code></p>
                                 </td>
                                 <td align="left" valign="top" width="68%" headers="d21196e2807 d21196e2802 ">
                                    <p><code class="codeph">SQL_CHAR</code>或<code class="codeph">SQL_WCHAR</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="32%" id="d21196e2819" headers="d21196e2799 ">
                                    <p><code class="codeph">VARCHAR2</code></p>
                                 </td>
                                 <td align="left" valign="top" width="68%" headers="d21196e2819 d21196e2802 ">
                                    <p><code class="codeph">SQL_VARCHAR</code>或<code class="codeph">SQL_WVARCHAR</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="32%" id="d21196e2831" headers="d21196e2799 ">
                                    <p><code class="codeph">NCHAR</code></p>
                                 </td>
                                 <td align="left" valign="top" width="68%" headers="d21196e2831 d21196e2802 ">
                                    <p><code class="codeph">SQL_WCHAR</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="32%" id="d21196e2840" headers="d21196e2799 ">
                                    <p><code class="codeph">NVARCHAR2</code></p>
                                 </td>
                                 <td align="left" valign="top" width="68%" headers="d21196e2840 d21196e2802 ">
                                    <p><code class="codeph">SQL_WVARCHAR</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="32%" id="d21196e2849" headers="d21196e2799 ">
                                    <p><code class="codeph">NCLOB</code></p>
                                 </td>
                                 <td align="left" valign="top" width="68%" headers="d21196e2849 d21196e2802 ">
                                    <p><code class="codeph">SQL_WLONGVARCHAR</code></p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div>
               </div><a id="UNXAR373"></a><div class="props_rev_3"><a id="GUID-9227818A-0ACC-4CF5-A8F4-564FD99710D7" name="GUID-9227818A-0ACC-4CF5-A8F4-564FD99710D7"></a><h4 id="UNXAR-GUID-9227818A-0ACC-4CF5-A8F4-564FD99710D7" class="sect4"><span class="enumeration_section">C.12.3</span> SQLGetData性能</h4>
                  <div>
                     <p><code class="codeph">SQLGetData</code>函数允许ODBC应用程序指定在获取数据后接收列的数据类型。OCI要求Oracle ODBC Driver在获取之前指定数据类型。在这种情况下，Oracle ODBC驱动程序使用有关列的数据类型的信息（如数据库中所定义）来确定如何最好地默认通过OCI获取列。</p>
                     <p>如果包含字符数据的列未受<code class="codeph">SQLBindCol</code>绑定，则Oracle ODBC驱动程序必须确定是否应将该列作为Unicode或本地代码页获取。驱动程序始终可以默认以Unicode格式接收列。但是，这可能导致多达两次不必要的转换。例如，如果数据在数据库中以ANSI编码，那么将进行ANSI到Unicode转换以将数据提取到Oracle ODBC驱动程序中。如果ODBC应用程序然后将数据请求为<code class="codeph">SQL_C_CHAR</code> ，那么将进行额外的转换以将数据恢复为其原始编码。
                     </p>
                     <p>获取数据时使用Oracle Database Client的默认编码。但是，ODBC应用程序可能会覆盖此缺省值，并通过将列或参数绑定为<code class="codeph">WCHAR</code>数据类型将数据作为Unicode获取。
                     </p>
                  </div>
               </div><a id="UNXAR375"></a><a id="UNXAR376"></a><a id="UNXAR377"></a><a id="UNXAR378"></a><a id="UNXAR379"></a><a id="UNXAR374"></a><div class="props_rev_3"><a id="GUID-A259DEBF-70CE-4E4F-AA0B-00A723DC047F" name="GUID-A259DEBF-70CE-4E4F-AA0B-00A723DC047F"></a><h4 id="UNXAR-GUID-A259DEBF-70CE-4E4F-AA0B-00A723DC047F" class="sect4"><span class="enumeration_section">C.12.4</span> Unicode样本</h4>
                  <div>
                     <p>由于Oracle ODBC驱动程序本身是使用<code class="codeph">TCHAR</code>宏实现的，因此建议ODBC应用程序使用<code class="codeph">TCHAR</code>来利用驱动程序。
                     </p>
                     <p>以下示例显示如何使用<code class="codeph">TCHAR</code> ，如果使用<code class="codeph">UNICODE</code>和<code class="codeph">_UNICODE</code>编译，则<code class="codeph">TCHAR</code>将成为<code class="codeph">WCHAR</code>数据类型：</p>
                     <div class="example" id="GUID-A259DEBF-70CE-4E4F-AA0B-00A723DC047F__GUID-B5D0D65A-8C9A-4BF5-AAE1-5D52FA0964F1">
                        <p class="titleinexample">示例C-1与数据库的连接</p>
                        <p>要使用此代码，您只需为<code class="codeph">SQLConnect</code>指定Unicode文字。
                        </p><pre class="oac_no_warn" dir="ltr">HENV envHnd; HDBC conHnd; HSTMT stmtHnd; RETCODE rc; rc = SQL_SUCCESS; // ENV被分配rc = SQLAllocEnv（＆envHnd）; //连接句柄被分配rc = SQLAllocConnect（envHnd，＆conHnd）; rc = SQLConnect（conHnd，_T（“stpc19”），SQL_NTS，_T（“jones”），SQL_NTS，_T（“ <span class="italic">password</span> ”），SQL_NTS）; 。。。if（conHnd）SQLFreeConnect（conHnd）; if（envHnd）SQLFreeEnv（envHnd）;</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-A259DEBF-70CE-4E4F-AA0B-00A723DC047F__GUID-F88D175E-87C1-4422-A98C-D2A44DC9C061">
                        <p class="titleinexample">示例C-2简单检索</p>
                        <p>以下示例从<code class="codeph">EMP</code>表中检索员工姓名和作业磁贴。除了必须为每个ODBC函数指定符合<code class="codeph">TCHAR</code>数据之外，ANSI情况没有区别。如果大小写是Unicode应用程序，则必须在调用<code class="codeph">SQLBindCol</code>时将缓冲区长度指定为<code class="codeph">BYTE</code>长度。例如， <code class="codeph">sizeof(ename)</code> 。
                        </p><pre class="oac_no_warn" dir="ltr">/ * **执行SQL，绑定列和获取。**过程：** ** SQLExecDirect ** SQLBindCol ** SQLFetch ** * / static SQLTCHAR * sqlStmt = _T（“SELECT ename，job FROM emp”）; SQLTCHAR ename [50]; SQLTCHAR作业[50]; SQLINTEGER enamelen，joblen; _tprintf（_T（“使用SQLBindCol 1 ... / n [％s] / n”检索ENAME和JOB），sqlStmt）; //步骤1：准备并执行rc = SQLExecDirect（stmtHnd，sqlStmt，SQL_NTS）; //选择checkSQLErr（envHnd，conHnd，stmtHnd，rc）; //步骤2：绑定列rc = SQLBindCol（stmtHnd，1，SQL_C_TCHAR，ename，sizeof（ename），＆enamelen）; checkSQLErr（envHnd，conHnd，stmtHnd，rc）; rc = SQLBindCol（stmtHnd，2，SQL_C_TCHAR，job，sizeof（job），＆joblen）; checkSQLErr（envHnd，conHnd，stmtHnd，rc）; do {//第3步：获取数据rc = SQLFetch（stmtHnd）; if（rc == SQL_NO_DATA）中断; checkSQLErr（envHnd，conHnd，stmtHnd，rc）; _tprintf（_T（“ENAME =％s，JOB =％s / n”），ename，job）; } while（1）; _tprintf（_T（“Finished Retrieval / n / n”））;</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-A259DEBF-70CE-4E4F-AA0B-00A723DC047F__GUID-6013D201-FB05-40A9-968B-A7CC055A63E9">
                        <p class="titleinexample">示例C-3使用SQLGetData进行检索（获取后绑定）</p>
                        <p>此示例显示如何使用<code class="codeph">SQLGetData</code> 。就Unicode特定问题而言，ANSI应用程序没有区别。
                        </p><pre class="oac_no_warn" dir="ltr">/ * **执行SQL，绑定列和获取。**过程：** ** SQLExecDirect ** SQLFetch ** SQLGetData * / static SQLTCHAR * sqlStmt = _T（“SELECT ename，job FROM emp”）; //与案例1相同。SQLTCHAR ename [50]; SQLTCHAR作业[50]; _tprintf（_T（“使用SQLGetData检索ENAME和JOB ... / n [％s] / n”），sqlStmt）;如果（rc！= SQL_SUCCESS）{_ tprintf（_T（“无法分配STMT / n”））;转到exit2; } //步骤1：准备并执行rc = SQLExecDirect（stmtHnd，sqlStmt，SQL_NTS）; //选择checkSQLErr（envHnd，conHnd，stmtHnd，rc）; do {//第2步：获取rc = SQLFetch（stmtHnd）; if（rc == SQL_NO_DATA）中断; checkSQLErr（envHnd，conHnd，stmtHnd，rc）; //步骤3：GetData rc = SQLGetData（stmtHnd，1，SQL_C_TCHAR，（SQLPOINTER）ename，sizeof（ename），NULL）; checkSQLErr（envHnd，conHnd，stmtHnd，rc）; rc = SQLGetData（stmtHnd，2，SQL_C_TCHAR，（SQLPOINTER）作业，sizeof（作业），NULL）; checkSQLErr（envHnd，conHnd，stmtHnd，rc）; _tprintf（_T（“ENAME =％s，JOB =％s / n”），ename，job）; } while（1）; _tprintf（_T（“Finished Retrieval / n / n”））;</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-A259DEBF-70CE-4E4F-AA0B-00A723DC047F__GUID-6C3BCE02-9A53-4F1C-80D0-5ABDA4E330EC">
                        <p class="titleinexample">示例C-4简单更新</p>
                        <p>此示例显示如何更新数据。<code class="codeph">SQLBindParameter</code>的数据长度必须使用BYTE长度指定，即使在Unicode应用程序中也是如此。
                        </p><pre class="oac_no_warn" dir="ltr">/ * **执行SQL，绑定列和获取。**过程：** ** SQLPrepare ** SQLBindParameter ** SQLExecute * / static SQLTCHAR * sqlStmt = _T（“INSERT INTO emp（empno，ename，job）VALUES（？，？，？）“）;静态SQLTCHAR * \ tempno = _T（”9876“）; // Emp无静态SQLTCHAR * ename = _T（”ORACLE“）; //名称静态SQLTCHAR * job = _T（”PRESIDENT“）; //作业_tprintf （_T（“使用SQLBindParameter插入用户ORACLE ... / n [％s] / n”），sqlStmt）; //步骤1：准备rc = SQLPrepare（stmtHnd，sqlStmt，SQL_NTS）; //选择checkSQLErr（envHnd， conHnd，stmtHnd，rc）; //步骤2：绑定参数rc = SQLBindParameter（stmtHnd，1，SQL_PARAM_INPUT，SQL_C_TCHAR，SQL_DECIMAL，4，// 4位0，（SQLPOINTER）empno，0，NULL）; checkSQLErr（envHnd， conHnd，stmtHnd，rc）; rc = SQLBindParameter（stmtHnd，2，SQL_PARAM_INPUT，SQL_C_TCHAR，SQL_CHAR，lstrlen（ename）* sizeof（TCHAR），0，（SQLPOINTER）ename，lstrlen（ename）* sizeof（TCHAR），NULL） ; checkSQLErr（envHnd，conHnd，stmtHnd，rc）; rc = SQLBindParameter（stmtHnd，3，SQL_PARAM_INPUT，SQL_C_TCHAR，SQL_CHAR，lstrlen（作业）* sizeof（TCHAR），0，（SQLPOINTER）作业，lstrlen（作业）* sizeof（ TCHAR），NULL）; checkSQLErr（envHnd，conHnd，stmtHnd，rc）; //步骤3：执行rc = SQLExecute（stmtHnd）; checkSQLErr（envHnd，c onHnd，stmtHnd，rc）;</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-A259DEBF-70CE-4E4F-AA0B-00A723DC047F__GUID-3E1EF63C-3393-40F6-920A-FE377684DA2C">
                        <p class="titleinexample">示例C-5更新和检索长数据（CLOB）</p>
                        <p>此示例可能是更新和检索Oracle数据库中的长数据（如<code class="codeph">CLOB</code>数据的最复杂情况。由于数据长度应始终为<code class="codeph">BYTE</code>长度，因此需要使用表达式<code class="codeph">lstrlen(TCHAR data)*sizeof(TCHAR)</code>来导出<code class="codeph">BYTE</code>长度。
                        </p><pre class="oac_no_warn" dir="ltr">/ * **执行SQL，绑定列和获取。**过程：** ** SQLPrepare ** SQLBindParameter ** SQLExecute ** SQLParamData ** SQLPutData ** ** SQLExecDirect ** SQLFetch ** SQLGetData * / static SQLTCHAR * sqlStmt1 = _T（“INSERT INTO clobtbl（clob1）VALUES（ ？）“）;静态SQLTCHAR * sqlStmt2 = _T（”SELECT clob1 FROM clobtbl“）; SQLTCHAR clobdata [1001]; SQLTCHAR resultdata [1001]; SQLINTEGER ind = SQL_DATA_AT_EXEC; SQLTCHAR * bufp; int clobdatalen，chunksize，dtsize，retchklen; _tprintf（ _T（“使用SQLPutData插入CLOB1 ... / n [％s] / n”），sqlStmt1）; //设置CLOB数据{int i; SQLTCHAR ch; for（i = 0，ch = _T（'A'） ; i &lt;sizeof（clobdata）/ sizeof（SQLTCHAR）; ++ i，++ ch）{if（ch&gt; _T（'Z'））ch = _T（'A'）; clobdata [i] = ch;} clobdata [sizeof（clobdata）/ sizeof（SQLTCHAR）-1] = _T（'/ 0'）;} clobdatalen = lstrlen（clobdata）; //字符长度chunksize = clobdatalen / 7; // 7次放置//步骤1：准备rc = SQLPrepare（stmtHnd，sqlStmt1，SQL_NTS）; checkSQLErr（envHnd，conHnd，stmtHnd，rc）; //步骤2：使用SQL_DATA_AT_EXEC绑定参数rc = SQLBindParameter（stmtHnd，1，SQL_PARAM_INPUT，SQL_C_TCHAR，SQL_LONGVARCHAR，clobdatalen * sizeof（TCHAR），0，（SQLPOINTER）clobdata，clobdatalen * sizeof（TCHAR），＆ind）; checkSQLErr（envHnd，conHnd，stmtHnd，rc）; //步骤3：执行rc = SQ LExecute（stmtHnd）; checkSQLErr（envHnd，conHnd，stmtHnd，rc）; //步骤4：ParamData（发起）rc = SQLParamData（stmtHnd，（SQLPOINTER *）＆bufp）; //设置值checkSQLErr（envHnd，conHnd，stmtHnd，rc）; for（dtsize = 0，bufp = clobdata; dtsize &lt;clobdatalen; dtsize + = chunksize，bufp + = chunksize）{int len; if（dtsize + chunksize &lt;clobdatalen）len = chunksize; else len = clobdatalen-dtsize; //步骤5：PutData rc = SQLPutData（stmtHnd，（SQLPOINTER）bufp，len * sizeof（TCHAR））; checkSQLErr（envHnd，conHnd，stmtHnd，rc）; } //步骤6：ParamData（temination）rc = SQLParamData（stmtHnd，（SQLPOINTER *）＆bufp）; checkSQLErr（envHnd，conHnd，stmtHnd，rc）; rc = SQLFreeStmt（stmtHnd，SQL_CLOSE）; _tprintf（_T（“完成更新/ n / n”））; rc = SQLAllocStmt（conHnd，＆stmtHnd）;如果（rc！= SQL_SUCCESS）{_ tprintf（_T（“无法分配STMT / n”））;转到exit2; } //清除结果数据memset（resultdata，0，sizeof（resultdata））; chunksize = clobdatalen / 15; //放置15次//步骤1：准备rc = SQLExecDirect（stmtHnd，sqlStmt2，SQL_NTS）; //选择checkSQLErr（envHnd，conHnd，stmtHnd，rc）; //第2步：获取rc = SQLFetch（stmtHnd）; checkSQLErr（envHnd，conHnd，stmtHnd，rc）; for（dtsize = 0，bufp = resultdata; dtsize &lt;sizeof（resultdata）/ sizeof（TCHAR）&amp;&amp; rc！= SQL_NO_DATA; dtsize + = chunksize-1，bufp + = chunksize-1）{int len; // len应包含NULL终止的空间if（dtsize + chunksize &lt;sizeof（resultdata）/ sizeof（TCHAR））len = chunksize; else len = sizeof（resultdata）/ sizeof（TCHAR）-dtsize; //步骤3：GetData rc = SQLGetData（stmtHnd，1，SQL_C_TCHAR，（SQLPOINTER）bufp，len * sizeof（TCHAR），＆retchklen）;如果（！_tcscmp（resultdata，clobdata））{_ tprintf（_T（成功!!）/ n / n“））;} else {_tprintf（_T（”失败!!/ n / n“））;}</pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
            </div><a id="UNXAR380"></a><div class="props_rev_3"><a id="GUID-DB2BBEFC-608F-4693-A76E-EA66A71FD57B" name="GUID-DB2BBEFC-608F-4693-A76E-EA66A71FD57B"></a><h3 id="UNXAR-GUID-DB2BBEFC-608F-4693-A76E-EA66A71FD57B" class="sect3"><span class="enumeration_section">C.13</span>性能和调优</h3>
               <div>
                  <p>本节包含以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="using-oracle-ODBC-driver.html#GUID-DD922C6D-AE48-4B6F-9AEC-CEAD9EFE05E4">通用ODBC编程指南</a></p>
                     </li>
                     <li>
                        <p><a href="using-oracle-ODBC-driver.html#GUID-6D6E17C5-81CF-42D6-B166-AAF8E656E653">数据源配置选项</a></p>
                     </li>
                     <li>
                        <p><a href="using-oracle-ODBC-driver.html#GUID-CF96CB6C-43BF-4BD2-919C-EE005B64FEE3">DATE和TIMESTAMP数据类型</a></p>
                     </li>
                  </ul>
               </div><a id="UNXAR381"></a><div class="props_rev_3"><a id="GUID-DD922C6D-AE48-4B6F-9AEC-CEAD9EFE05E4" name="GUID-DD922C6D-AE48-4B6F-9AEC-CEAD9EFE05E4"></a><h4 id="UNXAR-GUID-DD922C6D-AE48-4B6F-9AEC-CEAD9EFE05E4" class="sect4"><span class="enumeration_section">C.13.1</span>通用ODBC编程指南</h4>
                  <div>
                     <div class="section">
                        <p>应用以下编程指南以提高ODBC应用程序的性能：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>如果应用程序经常连接和断开数据源，则启用连接池。与重新建立连接相比，重用池化连接非常有效。</p>
                           </li>
                           <li>
                              <p>最小化必须准备语句的次数。在可能的情况下，使用绑定参数使语句可以重用于不同的参数值。准备一次语句并多次运行它比为每个<code class="codeph">SQLExecute</code>准备语句要高效得多。
                              </p>
                           </li>
                           <li>
                              <p>不要在<code class="codeph">SELECT</code>语句中包含您知道应用程序无法检索的列;特别是<code class="codeph">LONG</code>专栏。由于数据库服务器协议的性质，Oracle ODBC驱动程序必须获取<code class="codeph">LONG</code>列的全部内容（如果它包含在<code class="codeph">SELECT</code>语句中），无论应用程序是绑定列还是执行<code class="codeph">SQLGetData</code>操作。
                              </p>
                           </li>
                           <li>
                              <p>如果您正在执行不更新数据源的事务，请将ODBC <code class="codeph">SQLSetConnectAttr</code>函数的<code class="codeph">SQL_ATTR_ACCESS_MODE</code>属性设置为<code class="codeph">SQL_MODE_READ_ONLY</code> 。</p>
                           </li>
                           <li>
                              <p>如果未使用ODBC转义子句，则将ODBC <code class="codeph">SQLSetConnectAttr</code>函数或ODBC <code class="codeph">SQLSetStmtAttr</code>函数的<code class="codeph">SQL_ATTR_NOSCAN</code>属性设置为true。
                              </p>
                           </li>
                           <li>
                              <p>使用ODBC <code class="codeph">SQLFetchScroll</code>函数而不是ODBC <code class="codeph">SQLFetch</code>函数从具有大量行的表中检索数据。
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="UNXAR382"></a><div class="props_rev_3"><a id="GUID-6D6E17C5-81CF-42D6-B166-AAF8E656E653" name="GUID-6D6E17C5-81CF-42D6-B166-AAF8E656E653"></a><h4 id="UNXAR-GUID-6D6E17C5-81CF-42D6-B166-AAF8E656E653" class="sect4"><span class="enumeration_section">C.13.2</span>数据源配置选项</h4>
                  <div>
                     <div class="section">
                        <p>本节讨论以下ODBC数据源配置选项的性能影响：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>启用结果集</p>
                              <p>此选项支持从过程调用返回结果集（例如， <code class="codeph">RefCursor</code> ）。默认设置是启用结果集的返回。
                              </p>
                              <p>Oracle ODBC驱动程序必须查询数据库服务器以确定过程及其数据类型的参数集，以确定是否存在任何<code class="codeph">RefCursor</code>参数。在第一次准备和执行任何过程时，该查询引起额外的网络往返。
                              </p>
                           </li>
                           <li>
                              <p>启用LOB</p>
                              <p>此选项支持插入和更新LOB。默认设置已启用。</p>
                              <p>Oracle ODBC驱动程序必须查询数据库服务器以确定<code class="codeph">INSERT</code>或<code class="codeph">UPDATE</code>语句中每个参数的数据类型，以确定是否存在任何LOB参数。第一次准备并运行<code class="codeph">INSERT</code>或<code class="codeph">UPDATE</code>时，此查询会产生额外的网络往返。
                              </p>
                              <div class="infoboxnotealso" id="GUID-6D6E17C5-81CF-42D6-B166-AAF8E656E653__GUID-FEA70536-87C8-4586-B480-4149590BEE5A">
                                 <p class="notep1">也可以看看：</p>
                                 <p>有关LOB的更多信息，请参见<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/unxar&amp;id=ADLOB45119" target="_blank"><span class="italic">Oracle Database SecureFiles和Large Objects Developer's Guide</span></a></p>
                              </div>
                              <div class="infoboxnote" id="GUID-6D6E17C5-81CF-42D6-B166-AAF8E656E653__GUID-285CCE5E-6224-4FFC-B544-A051ACF9D636">
                                 <p class="notep1">注意：</p>
                                 <p>LOB数据压缩使您能够压缩SecureFiles以获得磁盘，输入输出和重做日志记录。这可以降低成本，因为压缩可以最有效地利用空间并提高SecureFiles的性能，因为压缩会降低输入输出和重做日志记录。</p>
                                 <p>LOB数据加密提供增强的数据库安全性。虽然加密数据可用于随机读写，但数据更安全。</p>
                                 <p>数据压缩和加密会消耗一些额外的内存。</p>
                              </div>
                           </li>
                           <li>
                              <p>将<code class="codeph">TIMESTAMP</code>绑定为<code class="codeph">DATE</code></p>
                              <p>将<code class="codeph">SQL_TIMESTAMP</code>参数绑定为适当的Oracle数据库数据类型。如果此选项设置为<code class="codeph">TRUE</code> ，则<code class="codeph">SQL_TIMESTAMP</code>将绑定为Oracle <code class="codeph">DATE</code>数据类型。如果此选项设置为<code class="codeph">FALSE</code> ，则<code class="codeph">SQL_TIMESTAMP</code>将绑定为Oracle <code class="codeph">TIMESTAMP</code>数据类型，这是默认值。
                              </p>
                           </li>
                           <li>
                              <p>启用关闭游标</p>
                              <p>ODBC函数的<code class="codeph">SQL_CLOSE</code>选项<code class="codeph">SQLFreeStmt</code>应该使用语句关闭关联的游标并丢弃所有挂起的结果。应用程序可以通过再次运行语句重新打开游标，而无需再次执行SQLPrepare。这种情况的典型情况是应用程序需要空闲一段时间但重新使用相同的SQL语句。当应用程序空闲时，它可能想要释放任何相关的服务器资源。
                              </p>
                              <p>分层Oracle ODBC驱动程序的OCI不支持关闭游标的功能。因此，默认情况下， <code class="codeph">SQL_CLOSE</code>选项在Oracle ODBC驱动程序中无效。游标和相关资源在数据库上保持打开状态。
                              </p>
                              <p>启用此选项会导致关联的游标在数据库服务器上关闭。但是，这会导致SQL语句的解析上下文丢失。ODBC应用程序可以在不调用<code class="codeph">SQLPrepare</code>情况下再次运行该语句。但是，在内部，Oracle ODBC Driver必须准备并运行该语句。启用此选项会对准备语句一次并重复运行的应用程序产生严重的性能影响。
                              </p>
                              <p>只有在需要释放服务器上的资源时才应启用此选项。</p>
                           </li>
                           <li>
                              <p>获取缓冲区大小</p>
                              <p>将<code class="codeph">odbc.ini</code>文件中的Fetch Buffer Size（ <code class="codeph">FetchBufferSize</code> ）设置为以字节为单位指定的值。此值是确定Oracle ODBC驱动程序从Oracle数据库一次预取多少行数据到客户端缓存所需的内存量，而不管应用程序在单个查询中请求的行数，从而提高性能。
                              </p>
                              <p>通常一次获取少于20行数据的应用程序的响应时间有所改善，特别是在慢速网络连接或高负载服务器上。将此设置得太高会对响应时间产生负面影响或消耗大量内存。默认值为64,000个字节。您应该为应用程序选择最佳值。</p>
                              <p>当存在<code class="codeph">LONG</code>和<code class="codeph">LOB</code>数据类型时，Oracle ODBC驱动程序预取的行数不是由获取缓冲区大小决定的。包含<code class="codeph">LONG</code>和<code class="codeph">LOB</code>数据类型可以最大限度地降低性能，并可能导致过多的内存使用。Oracle ODBC驱动程序忽略了获取缓冲区大小，并且仅在存在<code class="codeph">LONG</code>和<code class="codeph">LOB</code>数据类型时预取了一定数量的行。
                              </p>
                           </li>
                        </ul>
                        <div class="infoboxnotealso" id="GUID-6D6E17C5-81CF-42D6-B166-AAF8E656E653__GUID-CB0E493A-53A1-4DBA-A083-E341B5FDE199">
                           <p class="notep1">也可以看看：</p>
                           <p><span class="q">“ <a href="using-oracle-ODBC-driver.html#GUID-E3587401-AE9D-453E-88BC-C70B5A26847D">SQLDriverConnect函数的连接字符串的格式</a> ”</span></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="UNXAR383"></a><div class="props_rev_3"><a id="GUID-CF96CB6C-43BF-4BD2-919C-EE005B64FEE3" name="GUID-CF96CB6C-43BF-4BD2-919C-EE005B64FEE3"></a><h4 id="UNXAR-GUID-CF96CB6C-43BF-4BD2-919C-EE005B64FEE3" class="sect4"><span class="enumeration_section">C.13.3</span> DATE和TIMESTAMP数据类型</h4>
                  <div>
                     <p>如果在<code class="codeph">WHERE</code>子句中使用数据库中的<code class="codeph">DATE</code>列并且该列具有索引，则可能会对性能产生影响。例如：</p><pre class="oac_no_warn" dir="ltr">SELECT * FROM EMP WHERE HIREDATE =？
</pre><p>在此示例中， <code class="codeph">HIREDATE</code>列上的索引可用于使查询快速运行。但是，由于<code class="codeph">HIREDATE</code>是<code class="codeph">DATE</code>值而Oracle ODBC驱动程序将参数值作为<code class="codeph">TIMESTAMP</code> ，因此Oracle数据库的查询优化器必须应用转换函数。为了防止不正确的结果（如果参数值具有非零小数秒可能会发生），优化程序将转换应用于<code class="codeph">HIREDATE</code>列，从而产生以下语句：</p><pre class="oac_no_warn" dir="ltr">SELECT * FROM EMP WHERE TO_TIMESTAMP（HIREDATE）=？
</pre><p>但是，这会禁止在<code class="codeph">HIREDATE</code>列上使用索引。相反，服务器执行表的顺序扫描。如果表有很多行，那么这可能需要很长时间。作为这种情况的解决方法，Oracle ODBC驱动程序具有将<code class="codeph">TIMESTAMP</code>绑定为<code class="codeph">DATE</code>的连接选项。启用此选项后，Oracle ODBC驱动程序将<code class="codeph">SQL_TIMESTAMP</code>参数绑定为Oracle <code class="codeph">DATE</code>数据类型而不是Oracle <code class="codeph">TIMESTAMP</code>数据类型。这使查询优化器能够使用<code class="codeph">DATE</code>列上的任何索引。
                     </p>
                     <div class="infoboxnote" id="GUID-CF96CB6C-43BF-4BD2-919C-EE005B64FEE3__GUID-E1059E0C-0FF6-4172-AE24-A6FE6C41FDC7">
                        <p class="notep1">注意：</p>
                        <p>此选项仅适用于Microsoft Access或将<code class="codeph">DATE</code>列绑定为<code class="codeph">TIMESTAMP</code>列的其他类似程序。当存在实际的<code class="codeph">TIMESTAMP</code>列或可能发生数据丢失时，不应使用它。Microsoft Access使用选择的任何列作为主键来运行此类查询。
                        </p>
                     </div>
                  </div>
               </div>
            </div><a id="UNXAR385"></a><a id="UNXAR386"></a><a id="UNXAR387"></a><a id="UNXAR384"></a><div class="props_rev_3"><a id="GUID-01565DBC-5059-4CF1-8D51-81FB9708148D" name="GUID-01565DBC-5059-4CF1-8D51-81FB9708148D"></a><h3 id="UNXAR-GUID-01565DBC-5059-4CF1-8D51-81FB9708148D" class="sect3"><span class="enumeration_section">C.14</span>错误消息</h3>
               <div>
                  <div class="section">
                     <p>发生错误时，Oracle ODBC驱动程序返回本机错误号， <code class="codeph">SQLSTATE</code> （ODBC错误代码）和错误消息。驱动程序从驱动程序检测到的错误和Oracle数据库返回的错误中获取此信息。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-01565DBC-5059-4CF1-8D51-81FB9708148D__GUID-F536AAA4-8AD8-4A84-8BC6-E7FCA5D31949">本机错误</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>对于数据源中发生的错误，Oracle ODBC驱动程序返回Oracle数据库返回给它的本机错误。当Oracle ODBC驱动程序或驱动程序管理器检测到错误时，Oracle ODBC驱动程序返回零的本机错误。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-01565DBC-5059-4CF1-8D51-81FB9708148D__GUID-5F00F939-4359-4B76-B959-D66DA5EBA63E">SQLSTATE</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>对于数据源中发生的错误，Oracle ODBC Driver将返回的本机错误映射到适当的<code class="codeph">SQLSTATE</code> 。当Oracle ODBC驱动程序或驱动程序管理器检测到错误时，它会生成相应的<code class="codeph">SQLSTATE</code> 。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-01565DBC-5059-4CF1-8D51-81FB9708148D__GUID-7E4B56DA-630D-43F9-B420-BA3D62AB4B63">错误信息</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>对于数据源中发生的错误，Oracle ODBC Driver会根据Oracle数据库返回的消息返回错误消息。对于Oracle ODBC驱动程序或驱动程序管理器中发生的错误，Oracle ODBC驱动程序会根据与<code class="codeph">SQLSTATE</code>关联的文本返回错误消息。</p>
                     <p>错误消息具有以下格式：</p><pre class="oac_no_warn" dir="ltr">[vendor] [ODBC-component] [data-source]错误消息</pre><p>括号（[]）中的前缀标识错误的来源。下表显示了Oracle ODBC Driver返回的这些前缀的值。当数据源中发生错误时， <code class="codeph">vendor</code>和<code class="codeph">ODBC-component</code>前缀标识从数据源接收错误的ODBC组件的供应商和名称。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="tblformal" id="GUID-01565DBC-5059-4CF1-8D51-81FB9708148D__GUID-DD3C9DD9-882A-46BB-80A2-A4E75A46E0B1">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="This 3 column table lists the values of the error source prefixes returned by Oracle ODBC Drive. Column 1 is the error source. Column 2 is the prefix. Column 3 is the value." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="28%" id="d21196e3889">错误来源</th>
                              <th align="left" valign="bottom" width="28%" id="d21196e3892">字首</th>
                              <th align="left" valign="bottom" width="45%" id="d21196e3895">值</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="28%" id="d21196e3900" headers="d21196e3889 ">
                                 <p>司机经理</p>
                              </td>
                              <td align="left" valign="top" width="28%" headers="d21196e3900 d21196e3892 ">
                                 <p>[供应商]</p>
                                 <p>[ODBC组分]</p>
                                 <p>[数据源]</p>
                              </td>
                              <td align="left" valign="top" width="45%" headers="d21196e3900 d21196e3895 ">
                                 <p>[了unixODBC]</p>
                                 <p>[司机经理]</p>
                                 <p>不适用</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="28%" id="d21196e3918" headers="d21196e3889 ">
                                 <p>Oracle ODBC驱动程序</p>
                              </td>
                              <td align="left" valign="top" width="28%" headers="d21196e3918 d21196e3892 ">
                                 <p>[供应商]</p>
                                 <p>[ODBC组分]</p>
                                 <p>[数据源]</p>
                              </td>
                              <td align="left" valign="top" width="45%" headers="d21196e3918 d21196e3895 ">
                                 <p>[ORACLE]</p>
                                 <p>[Oracle ODBC驱动程序]</p>
                                 <p>不适用</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="28%" id="d21196e3936" headers="d21196e3889 ">
                                 <p>Oracle数据库</p>
                              </td>
                              <td align="left" valign="top" width="28%" headers="d21196e3936 d21196e3892 ">
                                 <p>[供应商]</p>
                                 <p>[ODBC组分]</p>
                                 <p>[数据源]</p>
                              </td>
                              <td align="left" valign="top" width="45%" headers="d21196e3936 d21196e3895 ">
                                 <p>[ORACLE]</p>
                                 <p>[Oracle ODBC驱动程序]</p>
                                 <p>[Oracle OCI]</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p>例如，如果错误消息不包含以下格式显示的<code class="codeph">Ora</code>前缀，则错误是Oracle ODBC驱动程序错误，应该是不言自明的。
                     </p><pre class="oac_no_warn" dir="ltr">[Oracle] [ODBC] <span class="italic">错误消息文本在这里</span>
</pre><p>如果错误消息包含以下格式显示的<code class="codeph">Ora</code>前缀，则它不是Oracle ODBC驱动程序错误。
                     </p><pre class="oac_no_warn" dir="ltr">[Oracle] [ODBC] [Ora] <span class="italic">此处出现错误消息文本</span></pre><div class="infoboxnote" id="GUID-01565DBC-5059-4CF1-8D51-81FB9708148D__GUID-C5DF40DD-EB9A-4010-82CD-A3F32D682AE1">
                        <p class="notep1">注意：</p>
                        <p>虽然错误消息包含<code class="codeph">ORA-</code>前缀，但实际错误可能源自多个源之一。
                        </p>
                     </div>
                     <p>如果错误消息文本以<code class="codeph">ORA-</code>前缀开头，则可以在Oracle Database文档中获取有关错误的更多信息。
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
         </div>
      </article>
   </body>
</html>