<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="If you have an Oracle Database installation using Oracle Restart (that is, an Oracle Grid Infrastructure installation for a standalone server), and you want to configure that server as a cluster member node, then complete the following tasks:"></meta>
      <meta name="description" content="If you have an Oracle Database installation using Oracle Restart (that is, an Oracle Grid Infrastructure installation for a standalone server), and you want to configure that server as a cluster member node, then complete the following tasks:"></meta>
      <title>将独立Oracle Grid Infrastructure服务器迁移到群集</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Grid Infrastructure Installation and Upgrade Guide"></meta>
      <meta property="og:description" content="If you have an Oracle Database installation using Oracle Restart (that is, an Oracle Grid Infrastructure installation for a standalone server), and you want to configure that server as a cluster member node, then complete the following tasks:"></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Grid Infrastructure Installation and Upgrade Guide for Linux"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="grid-infrastructure-installation-and-upgrade-guide-linux.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-04-23T21:10:05-07:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2013, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96272-02"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="deinstallation-response-file-example-for-oracle-grid-infrastructure-for-a-cluster.html" title="Previous" type="text/html"></link>
      <link rel="next" href="relinking-oracle-grid-infrastructure-for-a-cluster-binaries.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Grid Infrastructure Installation and Upgrade Guide for Linux"></meta>
    <meta name="dcterms.isVersionOf" content="CWLIN"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="deinstallation-response-file-example-for-oracle-grid-infrastructure-for-a-cluster.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="relinking-oracle-grid-infrastructure-for-a-cluster-binaries.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Grid Infrastructure安装和升级指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="removing-oracle-database-software.html" property="item" typeof="WebPage"><span property="name">删除Oracle数据库软件</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">将独立Oracle Grid Infrastructure服务器迁移到群集</li>
            </ol>
            <a id="GUID-D666C4AE-7784-46A5-BE8A-A9E858D9727E" name="GUID-D666C4AE-7784-46A5-BE8A-A9E858D9727E"></a>
            
            <h2 id="CWLIN-GUID-D666C4AE-7784-46A5-BE8A-A9E858D9727E" class="sect2">将独立Oracle Grid Infrastructure服务器迁移到群集</h2>
         </header>
         <div class="ind">
            <div>
               <p>如果使用Oracle Restart安装Oracle数据库（即，为独立服务器安装Oracle Grid Infrastructure），并且要将该服务器配置为集群成员节点，请完成以下任务：</p>
               <ol id="GUID-D666C4AE-7784-46A5-BE8A-A9E858D9727E__GUID-446C8556-61A0-45C7-84DF-86E6DB5C8A90">
                  <li>
                     <p>列出服务器上的所有Oracle数据库及其版本，数据库的唯一名称和Oracle主目录信息：</p>
                     <p><code class="codeph">srvctl配置数据库-home</code></p>
                  </li>
                  <li>
                     <p>使用以下语法使用<code class="codeph">srvctl</code>检查每个数据库的Oracle Restart配置，其中<span class="italic">db_unique_name</span>是数据库的唯一名称， <span class="italic">lsnrname</span>是侦听器的名称：</p>
                     <p><code class="codeph">srvctl config database -db</code> <span class="italic"><code class="codeph">db_unique_name</code></span></p>
                     <p><code class="codeph">srvctl config service -db</code> <span class="italic"><code class="codeph">db_unique_name</code></span></p>
                     <p><code class="codeph">srvctl config listener -listener</code> <span class="italic"><code class="codeph">lsnrname</code></span></p>
                     <p><code class="codeph">srvctl config volume -volume <span class="codeinlineitalic">volume_name</span> -diskgroup <span class="codeinlineitalic">diskgroup_name</span></code></p>
                     <p>记下服务器的配置信息。</p>
                  </li>
                  <li>
                     <p>停止在步骤1中发现的所有数据库，服务和侦听器。</p>
                  </li>
                  <li>
                     <p>如果存在，请卸载所有Oracle自动存储管理群集文件系统（Oracle ACFS）文件系统。</p>
                  </li>
                  <li>
                     <p>以<code class="codeph">root</code>身份登录，并将目录更改为<span class="italic">Grid home</span> <code class="codeph">/crs/install</code> 。例如：</p><pre class="pre codeblock"><code>#cd /u01/app/19.0.0/grid/crs/install</code></pre></li>
                  <li>
                     <p>使用以下命令取消配置独立服务器（Oracle Restart）的Oracle Grid Infrastructure安装：</p><pre class="pre codeblock"><code>＃roothas.sh -deconfig -force</code></pre></li>
                  <li>
                     <p>打开<code class="codeph">/etc/oratab</code>文件并删除与<code class="codeph">oracle_restart_home</code>对应的条目，格式如下：</p><pre class="pre codeblock"><code>+ ASM： <span class="italic">oracle_restart_home</span> ：N</code></pre></li>
                  <li>
                     <p>如本文档中所述，为Oracle Clusterware配置准备服务器。此外，您可以在与Oracle Restart相同的位置或在其他位置为群集安装Oracle Grid Infrastructure。</p>
                     <p><span class="bold">安装在与Oracle Restart相同的位置</span></p>
                     <ol type="a" id="GUID-D666C4AE-7784-46A5-BE8A-A9E858D9727E__GUID-A7C0FEC7-9BF1-4A92-BAC4-D01D8542CA3C">
                        <li>
                           <p>使用以下命令解锁独立服务器（Oracle Restart）主目录的Oracle Grid Infrastructure安装：</p><pre class="pre codeblock"><code>roothas.sh -unlock -hahome <span class="italic">oracle_restart_home</span></code></pre></li>
                        <li>
                           <p>继续第7步。</p>
                        </li>
                     </ol>
                     <p><span class="bold">安装在与Oracle Restart不同的位置</span></p>
                     <ol type="a" id="GUID-D666C4AE-7784-46A5-BE8A-A9E858D9727E__GUID-86AB9990-91B9-435D-947B-854934C60D34">
                        <li>
                           <p>在新的Grid home软件位置中设置Oracle Grid Infrastructure软件，如<cite>仅安装Oracle Grid Infrastructure软件中所述</cite> 。
                           </p>
                        </li>
                        <li>
                           <p>继续第7步。</p>
                        </li>
                     </ol>
                  </li>
                  <li>
                     <p>设置环境变量如下：</p><pre class="pre codeblock"><code>export oracle_install_asm_UseExistingDG = <span class="italic">true或false</span> export oracle_install_asm_DiskGroupName = <span class="italic">disk_group_name</span> export oracle_install_asm_DiskDiscoveryString = <span class="italic">asm_discovery_string</span>
</code></pre><p>如果<code class="codeph">oracle_install_asm_UseExistingDG</code>设置为false，则无需指定其他环境变量。
                     </p>
                  </li>
                  <li id="GUID-D666C4AE-7784-46A5-BE8A-A9E858D9727E__CIHIHJJH">
                     <p>作为Oracle Grid Infrastructure安装所有者，如<cite>记录响应文件中</cite>所述，为此安装创建并<cite>暂存响应文件</cite> 。
                     </p>
                  </li>
                  <li>
                     <p>使用以下命令在静默模式下完成安装：</p><pre class="pre codeblock"><code>$ Grid_home / gridSetup.sh -silent -responseFile $ ORACLE_HOME / GI.rsp</code></pre></li>
                  <li>
                     <p>运行<code class="codeph">root.sh</code>
                     </p>
                  </li>
                  <li>
                     <p>装载Oracle Restart使用的Oracle ASM磁盘组。</p>
                  </li>
                  <li>
                     <p>如果您将Oracle ACFS与Oracle Restart一起使用，那么：</p>
                     <ol type="a" id="GUID-D666C4AE-7784-46A5-BE8A-A9E858D9727E__GUID-C7FF172F-7D3E-4A98-8253-836EA2385166">
                        <li>
                           <p>启动Oracle ASM Configuration Assistant（ASMCA）。运行<code class="codeph">volenable</code>命令以启用所有Oracle Restart磁盘组卷。
                           </p>
                        </li>
                        <li>
                           <p>手动挂载所有Oracle ACFS文件系统。</p>
                        </li>
                     </ol>
                  </li>
                  <li>
                     <p>使用您在步骤1中记下的信息将Oracle Clusterware服务添加回Oracle Clusterware主目录，包括添加Oracle ACFS资源。例如：</p><pre class="pre codeblock"><code>/u01/app/grid/product/19.0.0/grid/bin/srvctl add filesystem -device / dev / asm / db1 -diskgroup ORestartData -volume db1 -mountpointpath /u01/app/grid/product/19.0.0/db1 - 用户网格</code></pre></li>
                  <li>
                     <p>使用您在步骤1中记录的配置信息，添加Oracle数据库以获得Oracle Grid Infrastructure对群集的支持。使用以下命令语法，其中<span class="italic">db_unique_name</span>是节点上数据库的唯一名称，nodename是节点的名称：</p>
                     <p><code class="codeph">srvctl add database -db <span class="codeinlineitalic"><code class="codeph">db_unique_name</code></span> -spfile <span class="codeinlineitalic">spfile_name</span> -pwfile <span class="codeinlineitalic">pwfile_name</span></code> <code class="codeph">-oraclehome $ORACLE_HOME -node</code> <span class="italic"><code class="codeph">nodename</code></span></p>
                     <ol type="a">
                        <li>
                           <p>例如，首先验证<code class="codeph">ORACLE_HOME</code>环境变量是否设置为数据库主目录的位置。
                           </p>
                        </li>
                        <li>
                           <p>接下来，要添加数据库名称<code class="codeph">mydb</code> ，请输入以下命令：</p><pre class="pre codeblock"><code>srvctl add database -db mydb -spfile <span class="italic">spfile_name</span> -pwfile <span class="italic">pwfile_name</span> -oraclehome $ ORACLE_HOME -node node1</code></pre></li>
                        <li>
                           <p>使用命令<code class="codeph">srvctl add service</code>将每个服务添加到数据库。例如，添加<code class="codeph">myservice</code>如下：</p><pre class="pre codeblock"><code>srvctl添加服务-db mydb -service myservice -preferred myinstance</code></pre></li>
                     </ol>
                  </li>
                  <li>
                     <p>使用Oracle Grid Infrastructure安装程序根据需要将节点添加到群集。</p>
                  </li>
               </ol>
            </div>
            <div>
               <div class="infoboxnotealso" id="GUID-D666C4AE-7784-46A5-BE8A-A9E858D9727E__GUID-0DDDA347-0D97-4C3D-BB20-F78D8190C913">
                  <p class="notep1">也可以看看：</p><a href="../cwadd/adding-and-deleting-cluster-nodes.html#CWADD1167" target="_blank"><span class="italic">“Oracle Clusterware管理和部署指南”，</span></a>以获取有关向群集添加节点的信息。
               </div>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>父主题：</strong> <a href="removing-oracle-database-software.html#GUID-5619EBF0-C89E-4349-AE6F-A8F8B3B06BD1" title="这些主题描述了如何删除Oracle软件和配置文件。">删除Oracle数据库软件</a></p>
                  </div>
               </div>
            </div>
            
         </div>
      </article>
   </body>
</html>