<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="These examples show the steps to complete preupgrade checks, upgrade, and postupgrade checks for an Oracle Database 11g Release 2 (11.2.0.4) upgrade to Oracle Database 19c."></meta>
      <meta name="description" content="These examples show the steps to complete preupgrade checks, upgrade, and postupgrade checks for an Oracle Database 11g Release 2 (11.2.0.4) upgrade to Oracle Database 19c."></meta>
      <title>Windows非CDB Oracle数据库的手动升级示例</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Database Upgrade Guide"></meta>
      <meta property="og:description" content="These examples show the steps to complete preupgrade checks, upgrade, and postupgrade checks for an Oracle Database 11g Release 2 (11.2.0.4) upgrade to Oracle Database 19c."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Database Upgrade Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="database-upgrade-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-04-25T08:26:31-07:00"></meta>
      <meta name="dcterms.title" content="Database Upgrade Guide"></meta>
      <meta name="dcterms.dateCopyrighted" content="1996, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96252-05"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="upgrade-scenarios-non-cdb-oracle-databases.html" title="Previous" type="text/html"></link>
      <link rel="next" href="manual-upgrade-scenarios-multitenant-architecture-oracle-databases.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="UPGRD"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="upgrade-scenarios-non-cdb-oracle-databases.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="manual-upgrade-scenarios-multitenant-architecture-oracle-databases.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">数据库升级指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="upgrading-oracle-database.html" property="item" typeof="WebPage"><span property="name">升级Oracle数据库</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Windows非CDB Oracle数据库的手动升级示例</li>
            </ol>
            <a id="GUID-30F3DC9C-141A-47DC-9B83-6D0C395E565C" name="GUID-30F3DC9C-141A-47DC-9B83-6D0C395E565C"></a>
            
            <h2 id="UPGRD-GUID-30F3DC9C-141A-47DC-9B83-6D0C395E565C" class="sect2">Windows非CDB Oracle数据库的手动升级示例</h2>
         </header>
         <div class="ind">
            <div>
               <p>这些示例显示了完成Oracle Database 11g第2版（11.2.0.4）升级到Oracle Database 19c的预升级检查，升级和升级后检查的步骤。</p>
               <p>这些主题中的特定示例显示了Microsoft Windows平台上的升级。他们使用特定于Windows环境的工具。但是，这些示例提供了手动安装体验的概述。</p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="example-manual-upgrade-windows-non-cdb-11203-to-122.html#GUID-6DCC7A57-7F82-467B-9B39-6568CEDF04BC">准备使用命令行实用程序升级Windows非CDB</a><br>在将非CDB Oracle Database 11g第2版（11.2.0.4）数据库升级到非CDB Oracle Database 12c及更高版本之前，请完成所需的预升级步骤。
                  </li>
                  <li class="ulchildlink"><a href="example-manual-upgrade-windows-non-cdb-11203-to-122.html#GUID-BCD5E0B2-B821-435E-93E8-B033A65DA263">使用命令行实用程序手动升级Windows非CDB</a><br>这些示例显示了将非CDB Oracle Database 11g第2版（11.2.0.4）升级到非CDB Oracle数据库的升级步骤</li>
                  <li class="ulchildlink"><a href="example-manual-upgrade-windows-non-cdb-11203-to-122.html#GUID-B5A840F4-912B-4DAD-82CA-94522140DB14">升级非CDB数据库后运行Postupgrade修复脚本</a><br>这些示例显示了为非CDB升级到非CDB升级的<code>postupgrade_fixups.sql</code>脚本的过程。
                  </li>
               </ul>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>父主题：</strong> <a href="upgrading-oracle-database.html#GUID-CC88F262-3370-4FFA-8604-EDA9F20F56D9" title="Oracle提供了一套全面的工具，用于以最短的停机时间升级Oracle数据库，以及将应用程序迁移到新版本。">升级Oracle数据库</a></p>
                  </div>
               </div>
            </div>
            
            <div class="sect2"><a id="GUID-6DCC7A57-7F82-467B-9B39-6568CEDF04BC" name="GUID-6DCC7A57-7F82-467B-9B39-6568CEDF04BC"></a><h3 id="UPGRD-GUID-6DCC7A57-7F82-467B-9B39-6568CEDF04BC" class="sect3">准备使用命令行实用程序升级Windows非CDB</h3>
               <div>
                  <p>在将非CDB Oracle Database 11g第2版（11.2.0.4）数据库升级到非CDB Oracle Database 12c及更高版本之前，请完成所需的预升级步骤。</p>
                  <div class="section">
                     <p>此过程提供了一个示例，说明如何使用命令行实用程序准备系统，以便在Windows上将非CDB Oracle数据库手动升级到当前版本的非CDB Oracle数据库。在此示例中，要升级的Oracle数据库是Oracle Database 11g第2版（11.2.0.4）。</p>
                     <p>以作为<code class="codeph">ORA_DBA</code>组成员的用户身份登录。Oracle建议您在服务器上安装新版本的Oracle Database二进制文件。请参阅Windows的Oracle数据库安装指南以完成该过程。
                     </p>
                     <p>Preupgrade包含以下步骤：</p>
                     <ol>
                        <li>
                           <p>将用户环境变量从新版Oracle主目录重置为Oracle安装所有者用户帐户（Oracle用户）的11.2.0.4 Oracle主目录。</p>
                        </li>
                        <li>
                           <p>测试与11.2.0.4 Oracle数据库的连接。</p>
                        </li>
                        <li>
                           <p>在11.2.0.4 Oracle数据库主目录上运行升级前信息工具。</p>
                        </li>
                        <li>
                           <p>查看升级前信息工具日志（ <code class="codeph">preupgrade.log</code> ）。如果必须运行<code>preupgrade_fixups.sql</code>脚本，则运行它们。在此示例中，我们显示以下错误的手动修复：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>存在Oracle Enterprise Manager（ <code class="codeph">em_present</code> ）。
                                 </p>
                              </li>
                              <li>
                                 <p>存在OLAP目录（ <code class="codeph">amd_exists</code> ）。
                                 </p>
                              </li>
                              <li>
                                 <p>必须授予ADMINISTER DATABASE TRIGGER权限（ <code class="codeph">trgowner_no_admndbtrg</code> ）。
                                 </p>
                              </li>
                              <li>
                                 <p>物化视图不会刷新（ <code class="codeph">mv_refresh</code> ）。
                                 </p>
                              </li>
                              <li>
                                 <p>Oracle Application Express未升级（ <code class="codeph">apex_upgrade_msg</code> ）</p>
                              </li>
                           </ul>
                        </li>
                        <li>
                           <p>运行<code>preupgrade_fixups.sql</code>脚本。
                           </p>
                        </li>
                        <li>
                           <p>备份数据库。</p>
                        </li>
                     </ol>
                     <p>这些示例使用以下系统，路径和用户：</p>
                     <p>Oracle Database 11g第2版（11.2.0.4）</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>Oracle Installation Owner用户帐户： <code class="codeph">oracle1</code> ，它是ORA_DBA组的成员。
                           </p>
                        </li>
                        <li>
                           <p>Oracle主目录： <code class="codeph">C:\app\oracle\product\11.2.0\dbhome_1</code></p>
                        </li>
                     </ul>
                     <p>Oracle数据库19c</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>Oracle Installation Owner用户帐户： <code class="codeph">oracle2</code> ，它是ORA_DBA组的成员。
                           </p>
                        </li>
                        <li>
                           <p>Oracle主目录： <code class="codeph">C:\app\oracle1\product\19\dbhome_1</code></p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-6DCC7A57-7F82-467B-9B39-6568CEDF04BC__GUID-DDFE745A-0FEC-4BF4-885A-93DEB83A7FBE">
                     <p class="titleinexample">示例4-6重置用户环境变量</p>
                     <p>此示例显示如何从为Oracle Database 19c安装设置的值更改环境变量：</p><pre class="pre codeblock"><code>C：\ app \ oracle1 \ product \ 19 \ dbhome_1 \ rdbms \ admin&gt;设置ORACLE_HOME = C：\ app \ oracle2 \ product \ 11.2.0 \ dbhome_1 C：\ app \ oracle1 \ product \ 19 \ dbhome_1 \ rdbms \ admin &gt;设置ORACLE_SID = orcl11</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-6DCC7A57-7F82-467B-9B39-6568CEDF04BC__GUID-E49BE1A5-0BDD-4D07-81AD-325D2391ED68">
                     <p class="titleinexample">示例4-7测试与数据库的连接</p>
                     <p>此示例显示如何测试与数据库的连接，并确保您要连接到要升级的版本11.2.0.4数据库。</p><pre class="pre codeblock"><code>C：\ app \ oracle1 \ product \ 19 \ dbhome_1 \ rdbms \ admin&gt; sqlplus / as sysdba SQL * Plus：版本11.2.0.4.0生产于12月12日星期二12:14:49 2018 Copyright（c）1982,2011，甲骨文。版权所有。连接到：Oracle Database 11g企业版11.2.0.4.0版 -  64位生产使用分区，OLAP，数据挖掘和实际应用程序测试选项SQL&gt;从v $ instance中选择版本;版本----------------- 11.2.0.4.0 SQL&gt;</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-6DCC7A57-7F82-467B-9B39-6568CEDF04BC__GUID-40FFB6B6-30FF-4407-A476-A5FE3989C958">
                     <p class="titleinexample">示例4-8运行升级前信息工具（preupgrade.jar）</p>
                     <p>此示例显示如何使用命令<code class="codeph">java -jar %ORACLE_HOME19%\rdbms\admin\preupgrade.jar</code>运行该工具。
                     </p>
                     <p>Preupgrade信息工具打印日志文件的路径，并打印修复脚本的路径。默认情况下，这些修复脚本放在<code class="codeph">%ORACLE_BASE%</code> 。
                     </p><pre class="pre codeblock"><code>C：\ app \ oracle1 \ product \ 19 \ dbhome_1 \ rdbms \ admin&gt; java -jar preupgrade.jar预升级生成的文件：C：\ app \ oracle2 \ cfgtoollogs \ orcl11 \ preupgrade \ preupgrade.log C：\ app \ oracle2 \ cfgtoollogs \ orcl11 \ preupgrade \ preupgrade_fixups.sql C：\ app \ oracle2 \ cfgtoollogs \ orcl11 \ preupgrade \ postupgrade_fixups.sql C：\ app \ oracle1 \ product \ 12.2.0 \ dbhome_1 \ rdbms \ admin&gt;</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-6DCC7A57-7F82-467B-9B39-6568CEDF04BC__GUID-CF7DDC7E-99CD-4E6A-9F99-778809D35C04">
                     <p class="titleinexample">示例4-9查看升级前信息工具日志（preupgrade.log）</p>
                     <p>在此示例中，日志文件<code class="codeph">preupgrade.log</code>在以下路径中生成： <code>C:\app\oracle2\cfgtoollogs\orcl11\preupgrade\preupgrade.log</code> 。
                     </p>
                     <p>日志文件可以指导您手动运行一些SQL修复文件。如果它指示您运行SQL文件，则将这些文件复制到早期版本11.2.0.4 Oracle主目录，然后运行脚本。</p>
                  </div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-6DCC7A57-7F82-467B-9B39-6568CEDF04BC__GUID-C71312F3-AEE1-4D03-96F5-01A6EDAB5119">
                     <p class="titleinexample">示例4-10运行Preupgrade Fixup SQL脚本（preupgrade_fixups.sql）</p><pre class="pre codeblock"><code>C：\ app \ oracle1 \ product \ 19 \ dbhome_1 \ rdbms \ admin&gt; sqlplus / as sysdba @C：\ app \ oracle2 \ cfgtoollogs \ orcl11 \ preupgrade \ preupgrade_fixups.sql SQL * Plus：版本11.2.0.4.0生产于Tue Dec 11 12:34:08 2018 Copyright（c）1982,2011，Oracle。版权所有。连接到：Oracle Database 11g企业版11.2.0.4.0版 -  64位生产使用分区，OLAP，数据挖掘和实际应用程序测试选项执行Oracle PRE-Upgrade修复脚本自动生成者：Oracle Preupgrade脚本版本：19.0.0.0 Build：1生成于：2018-12-11 12:18:06源数据库：ORCL11源数据库版本：11.2.0.4.0升级到版本：12.2.0.1.0 Fixup检查名称状态进一步DBA操作---- ------ ------ ------------------ em_present建议手动修复失败。amd_exists失败手动修复建议。dictionary_stats建议失败手动修复。trgowner_no_admndbtrg建议手动修复失败。mv_refresh失败建议使用手动修复。apex_upgrade_msg失败建议使用手动修复。PL / SQL过程成功完成。
	</code></pre><p>在此示例中，某些自动检查失败，并且需要手动修复。请参阅以下示例，了解如何执行手动修正。</p>
                  </div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-6DCC7A57-7F82-467B-9B39-6568CEDF04BC__GUID-E86EC895-48D8-4164-850E-51EA35D2A3F3">
                     <p class="titleinexample">示例4-11手动删除Oracle企业管理器（em_present）</p>
                     <p><code>preupgrade_fixups.sql</code>日志文件为您提供了手动删除Oracle Enterprise Manager的说明（ <code class="codeph">em_present</code> ）：</p><pre class="pre codeblock"><code>+删除EM存储库。- 将rdbms / admin / emremove.sql脚本从目标19.0.0.0.0 ORACLE_HOME复制到源11.2.0.4.0 ORACLE_HOME中。步骤1：如果配置了数据库控制，请使用以下命令停止EM Database Control：$&gt; emctl stop dbconsole步骤2：使用SYS帐户AS SYSDBA SET ECHO ON连接到数据库; SET SERVEROUTPUT ON; @ emremove.sql .........执行：步骤1  - 停止dbconsole：C：\ app \ oracle1 \ product \ 19 \ dbhome_1 \ rdbms \ admin&gt; emctl stop dbconsole Oracle企业管理器11g数据库控制版本11.2.0.4.0版权所有（c）1996,2011 Oracle Corporation。版权所有。https://db01.example.com:1158/em/console/aboutApplication OracleDBConsoleorcl11服务正在停止...........OracleDBConsoleorcl11服务已成功停止。第2步 - 删除em（如果需要，提供凭据）.........删除同义词：SETEMVIEWUSERCONTEXT ...删除同义词：SMP_EMD_AVAIL_OBJ ...删除同义词：SMP_EMD_DELETE_REC_ARRAY ...删除同义词：SMP_EMD_INTEGER_ARRAY ...删除同义词：SMP_EMD_INTEGER_ARRAY_ARRAY ...删除同义词：SMP_EMD_NVPAIR ...删除同义词：SMP_EMD_NVPAIR_ARRAY ...删除同义词：SMP_EMD_STRING_ARRAY ...删除同义词：SMP_EMD_STRING_ARRAY_ARRAY ...删除同义词：SMP_EMD_TARGET_OBJ ...删除同义词：SMP_EMD_TARGET_OBJ_ARRAY ...完成阶段5开始阶段6：删除与其他角色相关的Oracle Enterprise Manager ...完成阶段6删除与Oracle Enterprise Manager相关的模式和对象。如果在运行此脚本之前未完成DB控制，请执行手动步骤，然后删除成功完成的DB Control配置文件PL / SQL过程。SQL&gt;</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-6DCC7A57-7F82-467B-9B39-6568CEDF04BC__GUID-D359CCB9-0775-49FF-BE36-788338AA92F9">
                     <p class="titleinexample">示例4-12手动删除OLAP目录（amd_exists）</p>
                     <p><code>preupgrade_fixups.sql</code>日志文件为您提供了手动删除OLAP目录的说明（ <code class="codeph">amd_exists</code> ）：</p><pre class="pre codeblock"><code>+通过运行11.2.0.4.0 SQL脚本$ ORACLE_HOME / olap / admin / catnoamd.sql脚本删除OLAP目录。OLAP目录组件AMD存在于数据库中。sqlplus / as sysdba @％ORACLE_HOME％\ olap \ admin \ catnoamd.sql .........同义词掉线了。用户掉线了角色掉线了。SQL&gt;</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-6DCC7A57-7F82-467B-9B39-6568CEDF04BC__GUID-6D5B00B3-E74B-4AF8-BFBF-E48C1491783D">
                     <p class="titleinexample">示例4-13收集当前字典统计信息（dictionary_stats）</p>
                     <p><code>preupgrade_fixups.sql</code>日志文件为您提供了收集目录统计信息（ <code class="codeph">dictionary_stats</code> ）的说明。
                     </p><pre class="pre codeblock"><code>+使用以下命令收集非高峰时间数据库升级之前的字典统计信息：EXECUTE dbms_stats.gather_dictionary_stats; SQL&gt; EXECUTE dbms_stats.gather_dictionary_stats; PL / SQL过程成功完成。</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-6DCC7A57-7F82-467B-9B39-6568CEDF04BC__GUID-74112031-EBB4-41E3-B51E-24099B6E0457">
                     <p class="titleinexample">示例4-14授予ADMINISTER DATABASE TRIGGER权限（trgowner_no_admndbtrg）</p>
                     <p><code>preupgrade_fixups.sql</code>日志文件为您提供授予ADMINISTER DATABASE TRIGGER权限（ <code class="codeph">trgowner_no_admndbtrg</code> ）的说明：</p><pre class="pre codeblock"><code>+直接向触发器的所有者授予ADMINISTER DATABASE TRIGGER权限，或者删除并使用直接授予该用户的用户重新创建触发器。您可以使用“SELECT OWNER，TRIGGER_NAME FROM DBA_TRIGGERS WHERE BASE_OBJECT_TYPE ='DATABASE'和OWNER NOT IN列出这些触发器（选择GRANTEE来自DBA_SYS_PRIVS WHERE PRIVILEGE ='ADMINISTER DATABASE TRIGGER'）”SQL&gt; SELECT OWNER，2 TRIGGER_NAME FROM DBA_TRIGGERS WHERE BASE_OBJECT_TYPE = 'DATABASE'和3 OWNER NOT IN（从DBA_SYS_PRIVS中选择GRANTEE 4个PRIVILEGE ='ADMINISTER DATABASE TRIGGER'）; OWNER TRIGGER_NAME ------------------------------ ------------------ ------------ MDSYS SDO_DROP_USER MDSYS SDO_ST_SYN_CREATE MDSYS SDO_TOPO_DROP_FTBL MDSYS SDO_GEOR_BDDL_TRIGGER MDSYS SDO_GEOR_ADDL_TRIGGER MDSYS SDO_NETWORK_DROP_USER选择了6行。SQL&gt;将ADMINISTER DATABASE TRIGGER授予MDSYS;格兰特成功了。
</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-6DCC7A57-7F82-467B-9B39-6568CEDF04BC__GUID-33F66959-D631-4E8C-94AD-0CB74F7FE0EE">
                     <p class="titleinexample">示例4-15刷新实体化视图（mv_refresh）</p>
                     <p><code>preupgrade_fixups.sql</code>日志文件为您提供了刷新<code class="codeph">mv_refresh</code>化视图的指令（ <code class="codeph">mv_refresh</code> ）：</p><pre class="pre codeblock"><code>+请确保在升级之前刷新所有MV并且sys.sumdelta $变为空，除非您有强烈的商业理由不这样做。您可以使用dbms_mview.refresh（）刷新MV，但由于业务需要而保留那些陈旧的MV。如果有任何陈旧的MV取决于sys.sumdelta $中的更改，请不要截断它，因为这样做会在刷新后导致错误的结果。SQL&gt; declare 2 num_failures integer（3）：= 0; 3开始4 DBMS_MVIEW.REFRESH_ALL_MVIEWS（num_failures，'C'，''，TRUE，FALSE）; 5结束; 6 / PL / SQL过程成功完成。SQL&gt;从sumdelta $中选择count（1）; COUNT（1）---------- 0 SQL&gt;</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-6DCC7A57-7F82-467B-9B39-6568CEDF04BC__GUID-FA801C45-2D70-4947-8A3F-1E620ACDE2D8">
                     <p class="titleinexample">示例4-16升级Oracle Application Express（apex_upgrade_msg）</p><code>preupgrade_fixups.sql</code>日志文件建议您可以升级Oracle Application Express（ <code class="codeph">apex_upgrade_msg</code> ）。运行此升级可以减少Oracle数据库升级所需的停机时间。日志文件为您提供有关如何完成升级的信息：<pre class="pre codeblock"><code>+在数据库升级之前，请考虑手动升级APEX。该数据库包含APEX版本3.2.1.00.12，需要升级到至少版本5.0.4.00.11。要减少数据库升级时间，可以在数据库升级之前手动升级APEX。有关APEX安装升级的信息，请参阅My Oracle Support说明1088970.1。下载：http：//www.oracle.com/technetwork/developer-tools/apex/downloads/index.html提供凭据。然后转到：http：//www.oracle.com/technetwork/developer-tools/apex/application-express/upgrade-apex-for-xe-154969.html和https://docs.oracle.com/cd/ E59726_01 / install.50 / e39144 / toc.htm指导您进行升级。下载后，请转到目录并解压缩文件，从那里运行apex升级。......完成注册过程。12:07:41验证安装。12:07:41 ......开始验证12:07:41 ...数据库用户“SYS”，数据库模式“APEX_050000”，用户＃“90”12:07:41 ... 272包...... 265包体... 465表... 8个函数... 16个程序.. .4序列... 497触发... 1582个索引... 255个视图... 0个库... 14个类型... 5个类型的主体... 0个运算符... 0个索引类型...开始关键对象存在检查12:07:53 ...完成关键对象存在检查12:07:54 ...设置DBMS注册表12:07:54 ......设置DBMS注册表完成12:07:54 ...退出验证12:07:54 PL / SQL过程成功完成。时间：验证安装时间：00：00：13.00会话已更改。时间：完成安装经过时间：00：18：40.49 .........
</code></pre></div>
                  <!-- class="example" -->
                  <div class="section">
                     <div class="infoboxnote" id="GUID-6DCC7A57-7F82-467B-9B39-6568CEDF04BC__GUID-BAC905E7-96B6-4C68-9CFA-6D2385FC7CF0">
                        <p class="notep1">警告：</p>
                        <p>完成预升级步骤后，Oracle建议您在继续升级之前备份数据库。</p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="backing-up-oracle-db-for-upgrading.html#GUID-E3BF972C-26EA-436D-B09B-716B3DB90A23">备份Oracle数据库以进行升级</a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="example-manual-upgrade-windows-non-cdb-11203-to-122.html#GUID-30F3DC9C-141A-47DC-9B83-6D0C395E565C" title="这些示例显示了完成Oracle Database 11g第2版（11.2.0.4）升级到Oracle Database 19c的预升级检查，升级和升级后检查的步骤。">Windows非CDB Oracle数据库的手动升级示例</a></p>
                     </div>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-BCD5E0B2-B821-435E-93E8-B033A65DA263" name="GUID-BCD5E0B2-B821-435E-93E8-B033A65DA263"></a><h3 id="UPGRD-GUID-BCD5E0B2-B821-435E-93E8-B033A65DA263" class="sect3">使用命令行实用程序手动升级Windows非CDB</h3>
               <div>
                  <p>这些示例显示了将非CDB Oracle Database 11g第2版（11.2.0.4）升级到非CDB Oracle数据库的升级步骤</p>
                  <div class="section">
                     <p>完成预升级步骤后，可以将非CDB Oracle数据库升级到新版本的非CDB Oracle数据库。在开始升级之前，必须停止数据库服务。您可以使用命令行命令或使用Microsoft Windows PowerShell脚本来停止数据库服务。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="p">
                     <div class="p">完成升级的步骤顺序如下：<ol>
                           <li>
                              <p>使用命令行命令或PowerShell停止数据库服务。</p>
                           </li>
                           <li>
                              <p>从早期版本的Oracle主目录中删除数据库服务。</p>
                           </li>
                           <li>
                              <p>从早期版本的Oracle主目录中停止监听器</p>
                           </li>
                           <li>
                              <p>将环境变量设置为新的Oracle主目录。</p>
                           </li>
                           <li>
                              <p>将数据库文件（例如<code class="codeph">tnsnames.ora</code> ， <code class="codeph">listener.ora</code> ，密码文件，钱包和其他类似文件）复制到新的Oracle主目录。
                              </p>
                           </li>
                           <li>
                              <p>将PFILE复制到新的Oracle Database Oracle主目录，并使用新Oracle主目录中的Oracle Database二进制文件创建新服务。（在这个例子中，我们假设PFILE是兼容的。您的PFILE可能与新版本不兼容。）</p>
                           </li>
                           <li>
                              <p>开始数据库升级。</p>
                           </li>
                           <li>
                              <p>完成升级后的步骤。</p>
                           </li>
                        </ol>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-BCD5E0B2-B821-435E-93E8-B033A65DA263__GUID-67BC2EB9-17A9-4DDC-9674-DECA196CC411">
                     <p class="titleinexample">示例4-17使用命令行命令停止数据库服务</p>
                     <ol>
                        <li>
                           <p>如果您不知道服务名称，请标识服务名称。</p><pre class="pre codeblock"><code>c：\ apex \ apex&gt; sc query type = service | find / i“orcl11”SERVICE_NAME：OracleServiceORCL11 DISPLAY_NAME：OracleServiceORCL11</code></pre></li>
                        <li>
                           <p>使用服务名称，找出服务的状态。</p><pre class="pre codeblock"><code>c：\ apex \ apex&gt; sc查询OracleServiceORCL11 SERVICE_NAME：OracleServiceORCL11类型：10 WIN32_OWN_PROCESS状态：4运行（STOPPABLE，PAUSABLE，ACCEPTS_SHUTDOWN）WIN32_EXIT_CODE：0（0x0）SERVICE_EXIT_CODE：0（0x0）检查点：0x0 WAIT_HINT：0x0</code></pre></li>
                        <li>
                           <p>停止服务</p><pre class="pre codeblock"><code>c：\ apex \ apex&gt; sc stop OracleServiceORCL11 SERVICE_NAME：OracleServiceORCL11 TYPE：10 WIN32_OWN_PROCESS STATE：3 STOP_PENDING（STOPPABLE，PAUSABLE，ACCEPTS_SHUTDOWN）WIN32_EXIT_CODE：0（0x0）SERVICE_EXIT_CODE：0（0x0）检查点：0x5 WAIT_HINT：0x15f90</code></pre></li>
                        <li>
                           <p>等待几分钟，然后检查状态。</p><pre class="pre codeblock"><code>c：\ apex \ apex&gt; sc查询OracleServiceORCL11 SERVICE_NAME：OracleServiceORCL11类型：10 WIN32_OWN_PROCESS状态：1 STOPPED WIN32_EXIT_CODE：0（0x0）SERVICE_EXIT_CODE：0（0x0）检查点：0x0 WAIT_HINT：0x0</code></pre><p>服务停止后，您可以继续删除服务。</p>
                        </li>
                     </ol>
                  </div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-BCD5E0B2-B821-435E-93E8-B033A65DA263__GUID-457F4B48-3D74-401C-A8DB-F43739013BDE">
                     <p class="titleinexample">示例4-18使用Microsoft Windows PowerShell脚本停止数据库服务</p>
                     <ol>
                        <li>
                           <p>检查服务的状态。</p><pre class="pre codeblock"><code>PS C：\ app \ oraclbm \ cfgtoollogs \ orcl \ preupgrade&gt; Get-Service | Where-Object {$ _。displayName。包含（“ORCL11”）}状态名称DisplayName ------ ---- -----------停止OracleJobSchedu ...OracleJobSchedulerORCL11运行OracleServiceOR ...OracleServiceORCL11运行OracleVssWriter ...Oracle ORCL11 VSS编写器服务</code></pre></li>
                        <li>
                           <p>停止服务。</p><pre class="pre codeblock"><code>PS C：\ app \ oraclbm \ cfgtoollogs \ orcl \ preupgrade&gt; Get-Service | Where-Object {$ _。displayName。包含（“ORCL11”）} |停止服务警告：等待服务'OracleServiceORCL11（OracleServiceORCL11）'停止...警告：等待服务'OracleServiceORCL11（OracleServiceORCL11）'停止...警告：等待服务'OracleServiceORCL11（OracleServiceORCL11）'停止...警告：等待服务'OracleServiceORCL11（OracleServiceORCL11）'停止...警告：等待服务'OracleServiceORCL11（OracleServiceORCL11）'停止...警告：等待服务'OracleServiceORCL11（OracleServiceORCL11）'停止...警告：等待服务'OracleServiceORCL11（OracleServiceORCL11）'停止...警告：等待服务'OracleServiceORCL11（OracleServiceORCL11）'停止...警告：等待服务'OracleServiceORCL11（OracleServiceORCL11）'停止...警告：等待服务'OracleServiceORCL11（OracleServiceORCL11）'停止...警告：等待服务'OracleServiceORCL11（OracleServiceORCL11）'停止...
				
</code></pre><p>服务停止后，您可以继续删除数据库服务。</p>
                        </li>
                     </ol>
                  </div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-BCD5E0B2-B821-435E-93E8-B033A65DA263__GUID-BFDFDC5E-3174-4DF2-B26D-8A545ED2219D">
                     <p class="titleinexample">示例4-19从早期版本Oracle Home中删除数据库服务</p>
                     <p>对于Windows上的Oracle Database 11g第2版（11.2.0.4），请使用早期版本的Oracle主目录中的ORADIM。ORADIM是一个特定于Windows的实用程序，可用于管理Windows服务。</p><pre class="pre codeblock"><code>c：\ apex \ apex&gt; oradim -delete -sid orcl11无法停止服务，操作系统错误= 1062实例已删除。
</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-BCD5E0B2-B821-435E-93E8-B033A65DA263__GUID-06C5AD07-2D00-43DA-8820-B641323B6C06">
                     <p class="titleinexample">示例4-20停止早期版本Oracle Home的监听器</p><pre class="pre codeblock"><code>c：\ apex \ apex&gt;适用于64位Windows的lsnrctl状态LSNRCTL：版本11.2.0.4.0  - 生产于2016年7月13日13:58:52版权所有（c）1991,2012，Oracle。版权所有。连接到（DESCRIPTION =（ADDRESS =（PROTOCOL = IPC）（KEY = EXTPROC1522）））LISTENER的状态------------------------ Alias LISTENER适用于64位Windows的版本TNSLSNR：版本11.2.0.4.0  - 生产开始日期05-JUL-2018 10:01:30正常运行时间8天3小时。 57分钟23秒跟踪级别关闭安全性开启：本地操作系统身份验证SNMP关闭监听器参数文件C：\ app \ oracle2 \ product \ 11.2.0 \ dbhome_1 \ network \ admin \ listener.ora监听器日志文件C：\ app \ oracle2 \ diag \ tnslsnr \ slc01auu \ listener \ alert \ log.xml听力端点摘要...（DESCRIPTION =（ADDRESS =（PROTOCOL = ipc）（PIPENAME = \\。\ pipe \ EXTPROC1522ipc）））（DESCRIPTION =（ADDRESS =（PROTOCOL = tcp）（HOST = db01.example.com）（PORT = 1522）） ）服务摘要......服务“CLRExtProc”有1个实例。实例“CLRExtProc”，状态为UNKNOWN，具有此服务的1个处理程序...命令成功完成c：\ apex \ apex&gt; lsnrctl停止用于64位Windows的LSNRCTL：版本11.2.0.4.0  - 生产于13-JUL-2018 13:59:00版权所有（c）1991,2012，Oracle。版权所有。连接到（DESCRIPTION =（ADDRESS =（PROTOCOL = IPC）（KEY = EXTPROC1522）））命令成功完成</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-BCD5E0B2-B821-435E-93E8-B033A65DA263__GUID-3E16E129-133D-4E01-835F-EC46F24BF1DF">
                     <p class="titleinexample">示例4-21将环境变量设置为新的Oracle主目录</p><pre class="pre codeblock"><code>c：\ apex \ apex&gt;设置ORACLE_HOME = C：\ app \ oracle1 \ product \ 18.1.0 \ dbhome_1 c：\ apex \ apex&gt; SET PATH =％ORACLE_HOME％\ BIN;％PATH％c：\ apex \ apex&gt; SET ORACLE_SID = ORCL11</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-BCD5E0B2-B821-435E-93E8-B033A65DA263__GUID-F246D222-945F-4665-A522-6B5EEC35C401">
                     <p class="titleinexample">示例4-22将PFILE复制到新的Oracle主目录，并使用新的Oracle数据库二进制文件创建新服务</p>
                     <p>此示例显示如何使用特定于Windows的ORADIM实用程序来创建新的数据库服务。在此示例中，早期版本的PFILE与新版本兼容。</p><pre class="pre codeblock"><code>c：\ apex \ apex&gt; C：\ app \ oracle1 \ product \ 18.1.0 \ dbhome_1 \ bin \ oradim -new -sid orcl11 -syspwd <span class="variable" translate="no">My-sys-password</span> -maxusers 1000 -startmode auto -pfile C：\ app \ oracle1 \ product \ 18.1.0 \ dbhome_1 \ database \ initorcl11.ora输入Oracle服务用户的密码：创建实例。
</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-BCD5E0B2-B821-435E-93E8-B033A65DA263__GUID-E65164EA-E14A-4AD7-B8CD-D6E5E8ECBF8E">
                     <p class="titleinexample">示例4-23启动数据库升级</p>
                     <p>使用Parallel Upgrade Utility开始升级。</p>
                     <div class="infoboxnote" id="GUID-BCD5E0B2-B821-435E-93E8-B033A65DA263__GUID-81A8815A-5E57-4E67-975F-FF7634D8A0E4">
                        <p class="notep1">注意：</p>
                        <p>您可以发现必须更改PFILE上的文件夹符号链接以用于DIAGNOSTIC_DEST等路径。如果是这种情况，那么您会看到以下示例中的错误：</p><pre class="pre codeblock"><code>ORA-48173：ADR初始化期间错误检查目录存在[C：\ app \ oracle2 \ diag \ rdbms \ orcl11] ORA-00205：识别控制文件时出错，检查警报日志以获取更多信息</code></pre><p>如果您看到这些错误，则在早期版本的Oracle主目录上以及具有继承的所有相关文件夹上向用户授予权限。在数据库访问的任何访问控制列表（ACL）上也进行此更改，例如钱包文件。如果您使用早期版本的Oracle主目录作为ORADATA位置，则此步骤尤为必要。</p>
                     </div>
                     <p>如果您使用的是内置帐户，则该服务将作为<code class="codeph">LocalSystem</code>运行。如果您使用的是虚拟帐户，则使用Windows虚拟帐户运行服务，其名称来自服务名称。如果Oracle Database 19c二进制文件所有者是虚拟帐户，则必须将该虚拟帐户添加到组<code class="codeph">ORA_ <span class="variable" translate="no">Homename</span> _SVCAACCTS</code> ，而不是添加Oracle Home User。
                     </p>
                     <p>Oracle Database 19c包含一个shell脚本<code class="codeph">dbupgrade</code> 。shell脚本调用并行升级实用程序（ <code class="codeph">catctl.pl</code> ），以便您可以将升级作为命令运行。此示例显示Oracle数据库从版本11.2.0.4升级到版本19c。系统的升级时间可能与此示例中的结果不同。
                     </p><pre class="pre codeblock"><code>C：\ app \ oracle1 \ product \ 19.1.0 \ dbhome_1 \ bin&gt; dbupgrade .........C：\ app \ oracle1 \ product \ 19.1.0 \ dbhome_1 \ bin&gt; REM批处理文件，用于执行catctl.pl [C：\ app \ oracle1 \ product \ 19 \ dbhome_1 \ rdbms \ admin \ catctl.pl]的参数列表在c = 0中运行不在C = 0中运行输入目录d = 0 Echo OFF e = 1模拟E = 0强制清理F = 0 Log Id i = 0子进程I = 0 Log Dir l = c：\ temp2优先级列表名称L = 0升级模式有效M = 0 SQL进程计数n = 4 SQL PDB进程计数N = 0开放模式正常o = 0开始阶段p = 0结束阶段P = 0反向顺序r = 0自动升级恢复R = 0脚本s = 0串行运行S = 0 RO用户表空间T = 0显示阶段y = 0调试catcon.pm z = 0调试catctl.pl Z = 0 catctl.pl版本：[19.0.0.0.0]状态：[生产] BUILD：[RDBMS_MAIN_WINDOWS.X64_160624] C：\ app \ oracle1 \ product \ 19.1.0 \ dbhome_1 \ rdbms \ admin \ orahome.exe = [C：\ app \ oracle1 \ product \ 19.1.0 \ dbhome_1] C：\ app \ oracle1 \ product \ 19.1.0 \ dbhome_1 \ bin \ orabasehome.exe = [C：\ app \ oracle1 \ product \ 189.1.0 \ dbhome_1] catctlGetOrabase = [C：\ app \ oracle1 \ product \ 19.1.0 \ dbhome_ 1]分析文件C：\ app \ oracle1 \ product \ 19.1.0 \ dbhome_1 \ rdbms \ admin \ catupgrd.sql日志文件目录= [c：\ temp2] catcon：所有与catcon相关的输出都将写入[c： \ temp2 / catupgrd_catcon_3252.lst] catcon：有关脚本catcon生成的输出，请参阅[c：\ temp2 / catupgrd * .log]文件：有关假脱机文件的详细信息，请参阅[c：\ temp2 / catupgrd _ * .lst]文件Cpus = 2数据库名称= orcl11数据库版本= 11.2.0.4.0并行SQL进程计数= [orcl11]中的4个组件已安装[APEX APS CATALOG CATJROA CATPROC上下文JAVAVM ORDIM OWM SDO XDB XML XOQ]未安装[DV EM MGW ODM OLS RAC WK] ----------------------------------------------- -------阶段[0-109]开始时间：[2018_12_13 15:49:40] -------------------------- ---------------------------- ***********执行变更脚本******** ***串行阶段＃：0 [orcl11]文件：1 .........-------------------------------------------------- ----阶段[0-109]结束时间：[2018_12_13 16:53:27] ----------------------------- -------------------------总时间：3830s日志文件：（c：\ temp2 \ catupgrd * .log）升级摘要报告位于： c：\ temp2 \ upg_summary.log总升级时间：[0d：1h：3m：50s]</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-BCD5E0B2-B821-435E-93E8-B033A65DA263__GUID-FA5F8742-199D-465A-A81D-30E57E889B55">
                     <p class="titleinexample">示例4-24完成升级后检查</p>
                     <p>启动升级的Oracle数据库，并检查版本和状态。</p><pre class="pre codeblock"><code>C：\ app \ oracle1 \ product \ 19.1.0 \ dbhome_1 \ bin&gt; sqlplus / as sysdba SQL * Plus：版本19.1.0生产于12月13日星期四09:38:50 201版权所有（c）1982,2019，Oracle。版权所有。连接到空闲实例。SQL&gt;启动ORACLE实例已启动。系统全局总面积1828716544字节固定大小8740096字节可变大小503317248字节数据库缓冲区1308622848字节重做缓冲区8036352字节数据库已装入。数据库已打开SQL&gt;从v $ database中选择open_mode; OPEN_MODE -------------------- READ WRITE SQL&gt;从v $ instance中选择版本;版本----------------- 19.0.0.0.0 SQL&gt;</code></pre></div>
                  <!-- class="example" -->
                  <div class="section">
                     <p>升级完成后，执行升级后检查以确保对象有效，并且没有剩余问题。</p>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="example-manual-upgrade-windows-non-cdb-11203-to-122.html#GUID-30F3DC9C-141A-47DC-9B83-6D0C395E565C" title="这些示例显示了完成Oracle Database 11g第2版（11.2.0.4）升级到Oracle Database 19c的预升级检查，升级和升级后检查的步骤。">Windows非CDB Oracle数据库的手动升级示例</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-B5A840F4-912B-4DAD-82CA-94522140DB14" name="GUID-B5A840F4-912B-4DAD-82CA-94522140DB14"></a><h3 id="UPGRD-GUID-B5A840F4-912B-4DAD-82CA-94522140DB14" class="sect3">升级非CDB数据库后运行Postupgrade修复脚本</h3>
               <div>
                  <p>这些示例显示了为非CDB升级到非CDB升级的<code>postupgrade_fixups.sql</code>脚本的过程。
                  </p>
                  <div class="section">
                     <p>这些示例显示从非CDB Oracle Database 11g第2版（11.2.0.4）升级到非CDB Oracle数据库19c。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-B5A840F4-912B-4DAD-82CA-94522140DB14__GUID-78192807-06CA-41FD-AAB1-17E6824F28F8">
                     <p class="titleinexample">示例4-25运行Postupgrade Fixups脚本</p>
                     <p>在开始升级之前，运行先前版本Oracle主目录中使用升级前信息工具生成的<code>postupgrade_fixups.sql</code>脚本：</p><pre class="pre codeblock"><code>SQL&gt; @C：\ app \ oracle \ cfgtoollogs \ orcl11 \ preupgrade \ postupgrade_fixups.sql SQL&gt; REM SQL&gt; REM Oracle POST升级修复脚本SQL&gt; REM SQL&gt; REM自动生成者：Oracle Preupgrade脚本SQL&gt; REM版本： 19.0.0.0.0 SQL&gt; REM生成于：2018-12-05 12:18:07 SQL&gt; REM SQL&gt; REM源数据库：ORCL11 SQL&gt; REM源数据库版本：11.2.0.4.0 SQL&gt; REM升级到版本：19.0.0.0.0 SQL&gt; REM SQL&gt; SQL&gt; REM SQL&gt; REM设置环境SQL&gt; REM SQL&gt; SET ECHO OFF SERVEROUTPUT ON FORMAT WRAPPED TAB OFF LINESIZE 200;执行Oracle POST升级修复脚本自动生成者：Oracle Preupgrade脚本版本：19.0.0.0.0生成日期：2018-12-05 12:18:07源数据库：ORCL11源数据库版本：11.2.0.4.0升级版本：19.0.0.0.0 Fixup检查名称状态进一步DBA操作---------- ------ ------------------ depend_usr_tables推荐手动修复失败。old_time_zones_exist建议失败手动修复。post_dictionary推荐手动修复失败。fixed_objects已通过无upg_by_std_upgrd已通过无PL / SQL过程已成功完成。经过时间：00：00：11.26 SQL&gt;</code></pre><p>在此示例中， <code>postupgrade_fixup.sql</code>脚本无法完成三个修复。所以你被指示进行手动修正。这个结果很正常。要执行手动修复，请查看日志文件<code class="codeph">preupgrade.log</code> 。它包含有关如何运行手动修复脚本的说明和脚本信息。这些<code>postupgrade_fixups.sql</code>脚本由<code>postupgrade_fixups.sql</code>脚本为您生成。按照日志文件中提供的说明解决问题。
                     </p>
                  </div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-B5A840F4-912B-4DAD-82CA-94522140DB14__GUID-6FA77187-D5F7-4036-836C-708E4A616D48">
                     <p class="titleinexample">示例4-26用户表中Oracle维护类型的手动修复指令（depend_usr_tables）</p><pre class="pre codeblock"><code>+如果使用-T选项进行数据库升级，则运行@？升级完成后，/ rbbms / admin / utluptabdata.sql，以验证和升级受Oracle维护类型更改影响的任何用户表。SQL&gt; @C：\ app \ oracle \ product \ 19.1.0 \ dbhome_1 \ rdbms \ admin \ utluptabdata.sql PL / SQL过程已成功完成。SQL&gt;</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-B5A840F4-912B-4DAD-82CA-94522140DB14__GUID-0BC6C7B9-7295-4D5C-91C7-3425624C4ED8">
                     <p class="titleinexample">示例4-27时区版本的手动修复说明（old_time_zones_exist）</p><pre class="pre codeblock"><code>+使用DBMS_DST包升级数据库时区版本。数据库使用时区数据文件版本14，目标19.0.0.0.0数据库附带时区数据文件版本26。Oracle建议使用最新的时区数据。有关详细信息，请参阅My Oracle Support说明1585343.1 SQL&gt; @C：\ Users \ oracle \ Downloads \ DBMS_DST_scriptsV1.9 \ DBMS_DST_scriptsV1.9 \ countstatsTSTZ.sql。使用DBA_TABLES中的num_rows stats信息的TSTZ数据量。 。对于SYS表首先......注意：未列出空表。统计日期 - 所有者。表名。列名 -  num_rows 05/07/2019  -  SYS.AQ $ _ALERT_QT_S.CREATION_TIME  -  5 ...SYS TSTZ列的总数为：14652总共有154个非SYS TSTZ列。。...对于非SYS表...注意：未列出空表。......统计日期 - 所有者。表名。列名 -  num_rows非SYS TSTZ列的总数为：17总共有32个非SYS TSTZ列。已用完的总分钟数：0 SQL&gt; SQL&gt; spool upg_tzv_check.log SQL&gt; @C：\ Users \ oracle \ Downloads \ DBMS_DST_scriptsV1.9 \ DBMS_DST_scriptsV1.9 \ upg_tzv_check.sql INFO：从RDBMS DST更新准备开始。信息：此脚本不会执行任何实际的RDBMS DST更新。信息：如果发生错误，脚本将退出sqlplus。信息：检查已知问题......信息：数据库版本是19.0.0.0.0。信息：数据库RDBMS DST版本是DSTv14。信息：未检测到已知问题。信息：现在检测新的RDBMS DST版本。准备窗口已成功启动。信息：检测到的最新RDBMS DST版本是DSTv26。信息：下一步是检查所有TSTZ数据。信息：可能需要一段时间才能看到任何进一步的输出......准备窗口已成功结束。信息：找到比当前使用的版本更新的RDBMS DST版本。信息：请注意，尚未完成DST更新。信息：现在运行upg_tzv_apply.sql来进行实际的RDBMS DST更新。信息：请注意upg_tzv_apply.sql脚本将INFO：重启数据库2次没有任何确认或提示。SQL&gt;假脱机SQL&gt; @C：\ Users \ oracle \ Downloads \ DBMS_DST_scriptsV1.9 \ DBMS_DST_scriptsV1.9 \ upg_tzv_apply.sql INFO：如果发生ERROR，脚本将退出sqlplus。信息：数据库RDBMS DST版本将更新为DSTv26。警告：此脚本将重启数据库2次警告：不要求任何确认。警告：如果不是这样，请立即点击control-c。信息：在UPGRADE模式下重新启动数据库以启动DST升级。数据库关闭。数据库已卸下。 &lt;---------你可能需要等几分钟才能输入几次。ORACLE实例关闭。ORACLE实例启动了。系统全局总面积1828716544字节固定大小8740096字节可变大小503317248字节数据库缓冲区1308622848字节重做缓冲区8036352字节数据库已装入。数据库已打开信息：启动RDBMS DST升级。信息：升级所有SYS拥有的TSTZ数据。信息：在看到任何进一步的输出之前可能需要一些时间...... &lt;---------您可能需要等待几分钟并且输入几次。已成功启动升级窗口。信息：在NORMAL模式下重新启动数据库以升级非SYS TSTZ数据。数据库关闭。数据库已卸下。ORACLE实例关闭。ORACLE实例启动了。系统全局总面积1828716544字节固定大小8740096字节可变大小503317248字节数据库缓冲区1308622848字节重做缓冲区8036352字节数据库已装入。数据库已打开...... &lt;---------你可能需要等几分钟才能输入几次。信息：升级所有非SYS TSTZ数据。信息：在看到任何进一步的输出之前可能需要一些时间......信息：不要启动任何使用TSTZ数据的应用程序！ ...... &lt;---------你可能需要等几分钟才能输入几次。信息：接下来是所有升级表的列表：表列表：“IX”。“AQ $ _ORDERS_QUEUETABLE_L”失败次数：0表列表：“IX”。“AQ $ _ORDERS_QUEUETABLE_S”失败次数：0表列表：“IX “。”AQ $ _STREAMS_QUEUE_TABLE_L“失败次数：0表格列表：”IX“。”AQ $ _STREAMS_QUEUE_TABLE_S“失败次数：0表格列表：”APEX_050000“。”WWV_FLOW_DEBUG_MESSAGES“失败次数：0表格列表：”APEX_050000“ 。“WWV_FLOW_DEBUG_MESSAGES2”失败次数：0表格列表：“APEX_050000”。“WWV_FLOW_FEEDBACK”失败次数：0表格列表：“APEX_050000”。“WWV_FLOW_FEEDBACK_FOLLOWUP”失败次数：0表格列表：“APEX_050000”。“WWV_FLOW_WORKSHEET_NOTIFY”编号失败：0表列表：“GSMADMIN_INTERNAL”。“AQ $ _CHANGE_LOG_QUEUE_TABLE_L”失败次数：0表列表：“GSMADMIN_INTERNAL”。“AQ $ _CHANGE_LOG_QUEUE_TABLE_S”失败次数：0 INFO：更新TSTZ数据期间的总失败次数：0。升级窗口已成功结束。信息：您的新服务器RDBMS DST版本是DSTv26。信息：RDBMS DST更新已成功完成。信息：确保退出此sqlplus会话。信息：不要将它用于与时区相关的选择。SQL&gt;</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-B5A840F4-912B-4DAD-82CA-94522140DB14__GUID-7D2CCA90-9EE1-44A8-B3E4-B395653D4E8D">
                     <p class="titleinexample">示例4-28刷新字典统计信息的手动修复（post_dictionary）</p><pre class="pre codeblock"><code>+使用以下命令升级后收集字典统计信息：EXECUTE DBMS_STATS.GATHER_DICTIONARY_STATS;所有preupgrade运行都会给出此建议。SQL&gt; EXECUTE DBMS_STATS.GATHER_DICTIONARY_STATS; PL / SQL过程成功完成。SQL&gt;</code></pre></div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="example-manual-upgrade-windows-non-cdb-11203-to-122.html#GUID-30F3DC9C-141A-47DC-9B83-6D0C395E565C" title="这些示例显示了完成Oracle Database 11g第2版（11.2.0.4）升级到Oracle Database 19c的预升级检查，升级和升级后检查的步骤。">Windows非CDB Oracle数据库的手动升级示例</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
         </div>
      </article>
   </body>
</html>