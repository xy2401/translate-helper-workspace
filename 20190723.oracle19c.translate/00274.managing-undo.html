<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="For a default installation, Oracle Database automatically manages undo. There is typically no need for DBA intervention. However, if your installation uses Oracle Flashback operations, you may need to perform some undo management tasks to ensure the success of these operations.">
      <meta name="description" content="For a default installation, Oracle Database automatically manages undo. There is typically no need for DBA intervention. However, if your installation uses Oracle Flashback operations, you may need to perform some undo management tasks to ensure the success of these operations.">
      <title>Managing Undo</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Database Administrator’s Guide ">
      <meta property="og:description" content="For a default installation, Oracle Database automatically manages undo. There is typically no need for DBA intervention. However, if your installation uses Oracle Flashback operations, you may need to perform some undo management tasks to ensure the success of these operations.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Database Administrator’s Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="database-administrators-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-03-14T11:02:35-07:00">
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96348-04">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="transporting-data.html" title="Previous" type="text/html">
      <link rel="next" href="using-oracle-managed-files.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database Administrator's Guide">
    <meta name="dcterms.isVersionOf" content="ADMIN">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="transporting-data.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="using-oracle-managed-files.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Database Administrator’s Guide </span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="oracle-database-structure-and-storage.html" property="item" typeof="WebPage"><span property="name"> Oracle Database Structure and Storage</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem"> Managing Undo </li>
            </ol>
            <a id="GUID-2C865CF9-A8B5-4BF1-A451-E8C08D3611F0" name="GUID-2C865CF9-A8B5-4BF1-A451-E8C08D3611F0"></a><a id="ADMIN013"></a>
            
            <h2 id="ADMIN-GUID-2C865CF9-A8B5-4BF1-A451-E8C08D3611F0" class="sect2"><span class="enumeration_chapter">16 </span> Managing Undo 
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>For a default installation, Oracle Database automatically manages undo. There is typically no need for DBA intervention. However, if your installation uses Oracle Flashback operations, you may need to perform some undo management tasks to ensure the success of these operations.</p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="managing-undo.html#GUID-4454BE93-9160-4D92-9F93-EFB2958FC03D">What Is Undo?</a><br>Oracle Database creates and manages information that is used to roll back, or undo, changes to the database. Such information consists of records of the actions of transactions, primarily before they are committed. These records are collectively referred to as <span class="bold">undo</span>. 
                  </li>
                  <li class="ulchildlink"><a href="managing-undo.html#GUID-106B56C9-CB60-4E46-86A6-BF645E9E1A7F">Introduction to Automatic Undo Management</a><br>Oracle Database can manage undo information and space automatically.
                  </li>
                  <li class="ulchildlink"><a href="managing-undo.html#GUID-C1272948-3E08-45D9-BD5A-D6461E249EFB">Setting the Minimum Undo Retention Period</a><br>You specify the minimum undo retention period (in seconds) by setting the <code class="codeph">UNDO_RETENTION</code> initialization parameter.
                  </li>
                  <li class="ulchildlink"><a href="managing-undo.html#GUID-F7D30328-A0CC-4F81-BA54-0FCFC2095F8B">Sizing a Fixed-Size Undo Tablespace</a><br>Automatic tuning of undo retention typically achieves better results with a fixed-size undo tablespace. If you decide to use a fixed-size undo tablespace, then the Undo Advisor can help you estimate needed capacity.
                  </li>
                  <li class="ulchildlink"><a href="managing-undo.html#GUID-B994F33A-0905-4A7F-BA8C-2B76B43E8188">Managing Undo Tablespaces</a><br>You manage undo tablespaces by completing tasks such as creating, altering, and dropping them. You can also switch undo tablespaces and establish user quotas for undo space.
                  </li>
                  <li class="ulchildlink"><a href="managing-undo.html#GUID-B159A41D-C28C-4E6E-BAAF-FE5ACE2C18B7">Migrating to Automatic Undo Management</a><br>If you are currently using rollback segments to manage undo space, Oracle strongly recommends that you migrate your database to automatic undo management.
                  </li>
                  <li class="ulchildlink"><a href="managing-undo.html#GUID-9A6B9475-63ED-4204-93DD-2B77BEB858CE">Managing Temporary Undo</a><br>By default, undo records for temporary tables are stored in the undo tablespace and are logged in the redo, which is the same way undo is managed for persistent tables. However, you can use the <code class="codeph">TEMP_UNDO_ENABLED</code> initialization parameter to separate undo for temporary tables from undo for persistent tables. When this parameter is set to <code class="codeph">TRUE</code>, the undo for temporary tables is called <span class="bold">temporary undo</span>. 
                  </li>
                  <li class="ulchildlink"><a href="managing-undo.html#GUID-F9B85E9D-D56A-43D2-AB52-918C0FE4D609">Undo Space Data Dictionary Views</a><br>You can query a set of views for information about undo space in the automatic undo management mode.
                  </li>
               </ul>
               <div class="infoboxnotealso" id="GUID-2C865CF9-A8B5-4BF1-A451-E8C08D3611F0__GUID-87C44FCF-CF78-4E5A-9665-2656E398D886">
                  <p class="notep1">See Also:</p>
                  <p><a href="using-oracle-managed-files.html#GUID-4A3C4616-0D81-4BBA-8EAD-FCAA8AD5C15A" title="Oracle Database can manage the files that comprise the database."> Using Oracle Managed Files</a> for information about creating an undo tablespace whose data files are both created and managed by Oracle Database.
                  </p>
               </div>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>Parent topic:</strong> <a href="oracle-database-structure-and-storage.html#GUID-F11D30A7-BF12-4D8F-A1C2-D7437D38F8C7" title="You can create and manage database structures and storage components.">Oracle Database Structure and Storage</a></p>
                  </div>
               </div>
            </div>
            <a id="ADMIN11460"></a><div class="props_rev_3"><a id="GUID-4454BE93-9160-4D92-9F93-EFB2958FC03D" name="GUID-4454BE93-9160-4D92-9F93-EFB2958FC03D"></a><h3 id="ADMIN-GUID-4454BE93-9160-4D92-9F93-EFB2958FC03D" class="sect3"><span class="enumeration_section">16.1 </span>What Is Undo?
               </h3>
               <div>
                  <p>Oracle Database creates and manages information that is used to roll back, or undo, changes to the database. Such information consists of records of the actions of transactions, primarily before they are committed. These records are collectively referred to as <span class="bold">undo</span>. 
                  </p>
                  <p>Undo records are used to:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Roll back transactions when a <code class="codeph">ROLLBACK</code> statement is issued
                        </p>
                     </li>
                     <li>
                        <p>Recover the database</p>
                     </li>
                     <li>
                        <p>Provide read consistency</p>
                     </li>
                     <li>
                        <p>Analyze data as of an earlier point in time by using Oracle Flashback Query</p>
                     </li>
                     <li>
                        <p>Recover from logical corruptions using Oracle Flashback features</p>
                     </li>
                  </ul>
                  <p>When a <code class="codeph">ROLLBACK</code> statement is issued, undo records are used to undo changes that were made to the database by the uncommitted transaction. During database recovery, undo records are used to undo any uncommitted changes applied from the redo log to the data files. Undo records provide read consistency by maintaining the before image of the data for users who are accessing the data at the same time that another user is changing it.
                  </p>
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-4454BE93-9160-4D92-9F93-EFB2958FC03D__GUID-919C7A94-918A-484B-88D8-CE7DA7F0E3D4">
                     <p class="notep1">See Also:</p>
                     <p><a href="../cncpt/logical-storage-structures.html#CNCPT305" target="_blank"><span class="italic">Oracle Database Concepts</span></a></p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="managing-undo.html#GUID-2C865CF9-A8B5-4BF1-A451-E8C08D3611F0" title="For a default installation, Oracle Database automatically manages undo. There is typically no need for DBA intervention. However, if your installation uses Oracle Flashback operations, you may need to perform some undo management tasks to ensure the success of these operations.">Managing Undo</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="ADMIN11461"></a><div class="props_rev_3"><a id="GUID-106B56C9-CB60-4E46-86A6-BF645E9E1A7F" name="GUID-106B56C9-CB60-4E46-86A6-BF645E9E1A7F"></a><h3 id="ADMIN-GUID-106B56C9-CB60-4E46-86A6-BF645E9E1A7F" class="sect3"><span class="enumeration_section">16.2 </span>Introduction to Automatic Undo Management 
               </h3>
               <p>Oracle Database can manage undo information and space automatically.</p>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="managing-undo.html#GUID-281C5BFE-BAED-47C3-BFF7-806C0954F3EC">Overview of Automatic Undo Management</a><br>Oracle provides a fully automated mechanism, referred to as automatic undo management, for managing undo information and space. With automatic undo management, the database manages undo segments in an undo tablespace. 
                     </li>
                     <li class="ulchildlink"><a href="managing-undo.html#GUID-28EA4133-BC73-4036-87F2-656FC1A6D9A2">The Undo Retention Period</a><br>The <span class="bold">undo retention period</span> is the minimum amount of time that Oracle Database attempts to retain old undo information before overwriting it.
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="managing-undo.html#GUID-2C865CF9-A8B5-4BF1-A451-E8C08D3611F0" title="For a default installation, Oracle Database automatically manages undo. There is typically no need for DBA intervention. However, if your installation uses Oracle Flashback operations, you may need to perform some undo management tasks to ensure the success of these operations.">Managing Undo</a></p>
                     </div>
                  </div>
               </div>
               <a id="ADMIN11462"></a><div class="props_rev_3"><a id="GUID-281C5BFE-BAED-47C3-BFF7-806C0954F3EC" name="GUID-281C5BFE-BAED-47C3-BFF7-806C0954F3EC"></a><h4 id="ADMIN-GUID-281C5BFE-BAED-47C3-BFF7-806C0954F3EC" class="sect4"><span class="enumeration_section">16.2.1 </span>Overview of Automatic Undo Management
                  </h4>
                  <div>
                     <p>Oracle provides a fully automated mechanism, referred to as automatic undo management, for managing undo information and space. With automatic undo management, the database manages undo segments in an undo tablespace. </p>
                     <p>Automatic undo management is the default mode for a newly installed database. An auto-extending undo tablespace named <code class="codeph">UNDOTBS1</code> is automatically created when you create the database with Database Configuration Assistant (DBCA).
                     </p>
                     <p>You can also create an undo tablespace explicitly. The methods of creating an undo tablespace are explained in <span class="q">"<a href="managing-undo.html#GUID-49219733-ABC4-488E-850B-A704B171ACF5" title="When you are creating a database, you can create an undo tablespace with the CREATE DATABASE statement. In an existing database, you can create an undo tablespace with the CREATE UNDO TABLESPACE statement.">Creating an Undo Tablespace</a>"</span>.
                     </p>
                     <p>When the database instance starts, the database automatically selects the first available undo tablespace. If no undo tablespace is available, then the instance starts without an undo tablespace and stores undo records in the <code class="codeph">SYSTEM</code> tablespace. This is not recommended, and an alert message is written to the alert log file to warn that the system is running without an undo tablespace.
                     </p>
                     <p>If the database contains multiple undo tablespaces, then you can optionally specify at startup that you want to use a specific undo tablespace. This is done by setting the <code class="codeph">UNDO_TABLESPACE</code> initialization parameter, as shown in this example:
                     </p><pre class="oac_no_warn" dir="ltr">UNDO_TABLESPACE = undotbs_01
</pre><p>If the tablespace specified in the initialization parameter does not exist, the <code class="codeph">STARTUP</code> command fails. The <code class="codeph">UNDO_TABLESPACE</code> parameter can be used to assign a specific undo tablespace to an instance in an Oracle Real Application Clusters environment. 
                     </p>
                     <p>The database can also run in <span class="italic">manual undo management mode</span>. In this mode, undo space is managed through rollback segments, and no undo tablespace is used.
                     </p>
                     <div class="infoboxnote" id="GUID-281C5BFE-BAED-47C3-BFF7-806C0954F3EC__GUID-FAE8D895-DE7D-4B6E-86B9-753CB992ECAE">
                        <p class="notep1">Note:</p>
                        <p>Space management for rollback segments is complex. Oracle strongly recommends leaving the database in automatic undo management mode. </p>
                     </div>
                     <p>The following is a summary of the <a id="d168466e338" class="indexterm-anchor"></a>initialization parameters for undo management:
                     </p>
                     <div class="tblformal" id="GUID-281C5BFE-BAED-47C3-BFF7-806C0954F3EC__GUID-4A620D46-6270-4168-A4FB-CD612BF17E97">
                        <table cellpadding="4" cellspacing="0" class="Formal" title="" summary="In column 1 this table lists the initialization parameters relating to automatic undo management. Column 2 describes each parameter." width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="33%" id="d168466e351">Initialization Parameter</th>
                                 <th align="left" valign="bottom" width="67%" id="d168466e354">Description</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="33%" id="d168466e359" headers="d168466e351 ">
                                    <p><code class="codeph"><a href="../refrn/UNDO_MANAGEMENT.html#REFRN10224" target="_blank">UNDO_MANAGEMENT</a></code> 
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="67%" headers="d168466e359 d168466e354 ">
                                    <p>If <code class="codeph">AUTO</code> or null, enables automatic undo management. If <code class="codeph">MANUAL</code>, sets manual undo management mode. The default is <code class="codeph">AUTO</code>.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="33%" id="d168466e379" headers="d168466e351 ">
                                    <p><code class="codeph"><a href="../refrn/UNDO_TABLESPACE.html#REFRN10227" target="_blank">UNDO_TABLESPACE</a></code> 
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="67%" headers="d168466e379 d168466e354 ">
                                    <p>Optional, and valid only in automatic undo management mode. Specifies the name of an undo tablespace. Use only when the database has multiple undo tablespaces and you want to direct the database instance to use a particular undo tablespace.</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p>When automatic undo management is enabled, if the initialization parameter file contains parameters relating to manual undo management, they are ignored.</p>
                     <div class="infoboxnote" id="GUID-281C5BFE-BAED-47C3-BFF7-806C0954F3EC__GUID-919E8828-0CF8-4AF3-B009-DE1494D44355">
                        <p class="notep1">Note:</p>
                        <p>Earlier releases of Oracle Database default to manual undo management mode. To change to automatic undo management, you must first create an undo tablespace and then change the <code class="codeph">UNDO_MANAGEMENT</code> initialization parameter to <code class="codeph">AUTO</code>. If your Oracle Database is Oracle9<span class="italic">i</span> or later and you want to change to automatic undo management, see <a href="../upgrd/index.html" target="_blank"><span class="italic">Oracle Database Upgrade Guide</span></a> for instructions.
                        </p>
                        <p>A null <code class="codeph">UNDO_MANAGEMENT</code> initialization parameter defaults to automatic undo management mode in Oracle Database 11<span class="italic">g</span> and later, but defaults to manual undo management mode in earlier releases. You must therefore use caution when upgrading a previous release to the current release. <a href="../upgrd/index.html" target="_blank"><span class="italic">Oracle Database Upgrade Guide</span></a> describes the correct method of migrating to automatic undo management mode, including information on how to size the undo tablespace.
                        </p>
                     </div>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-undo.html#GUID-106B56C9-CB60-4E46-86A6-BF645E9E1A7F" title="Oracle Database can manage undo information and space automatically.">Introduction to Automatic Undo Management</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-28EA4133-BC73-4036-87F2-656FC1A6D9A2" name="GUID-28EA4133-BC73-4036-87F2-656FC1A6D9A2"></a><h4 id="ADMIN-GUID-28EA4133-BC73-4036-87F2-656FC1A6D9A2" class="sect4"><span class="enumeration_section">16.2.2 </span>The Undo Retention Period
                  </h4>
                  <p>The <span class="bold">undo retention period</span> is the minimum amount of time that Oracle Database attempts to retain old undo information before overwriting it.
                  </p>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="managing-undo.html#GUID-049380AF-220F-43C0-81B2-27DCD7953574">About the Undo Retention Period</a><br>When automatic undo management is enabled, there is always a current <span class="bold">undo retention period</span>, which is the minimum amount of time that Oracle Database attempts to retain old undo information before overwriting it. 
                        </li>
                        <li class="ulchildlink"><a href="managing-undo.html#GUID-43B6D26F-1EF6-4A25-B831-D90E625C7649">Automatic Tuning of Undo Retention</a><br>Oracle Database automatically tunes the undo retention period based on how the undo tablespace is configured.
                        </li>
                        <li class="ulchildlink"><a href="managing-undo.html#GUID-FE48AEC0-64AE-4431-8A29-CD4EA15E6548">Retention Guarantee</a><br>To guarantee the success of long-running queries or Oracle Flashback operations, you can enable retention guarantee.
                        </li>
                        <li class="ulchildlink"><a href="managing-undo.html#GUID-3F10B6D7-4A77-4486-A72C-301CFA6F47A9">Undo Retention Tuning and Alert Thresholds</a><br>For a fixed-size undo tablespace, the database calculates the best possible retention based on database statistics and on the size of the undo tablespace.
                        </li>
                        <li class="ulchildlink"><a href="managing-undo.html#GUID-8450E94B-D55D-47D6-9872-0778464AD77E">Tracking the Tuned Undo Retention Period</a><br>You can determine the current retention period by querying the <code class="codeph">TUNED_UNDORETENTION</code> column of the <code class="codeph">V$UNDOSTAT</code> view.
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-undo.html#GUID-106B56C9-CB60-4E46-86A6-BF645E9E1A7F" title="Oracle Database can manage undo information and space automatically.">Introduction to Automatic Undo Management</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="ADMIN10180"></a><div class="props_rev_3"><a id="GUID-049380AF-220F-43C0-81B2-27DCD7953574" name="GUID-049380AF-220F-43C0-81B2-27DCD7953574"></a><h5 id="ADMIN-GUID-049380AF-220F-43C0-81B2-27DCD7953574" class="sect5"><span class="enumeration_section">16.2.2.1 </span>About the Undo Retention Period
                     </h5>
                     <div>
                        <p>When automatic undo management is enabled, there is always a current <span class="bold">undo retention period</span>, which is the minimum amount of time that Oracle Database attempts to retain old undo information before overwriting it. 
                        </p>
                        <p>After a transaction is committed, undo data is no longer needed for rollback or transaction recovery purposes. However, for consistent read purposes, long-running queries may require this old undo information for producing older images of data blocks. Furthermore, the success of several Oracle Flashback features can also depend upon the availability of older undo information. For these reasons, it is desirable to retain the old undo information for as long as possible.</p>
                        <p>Old (committed) undo information that is older than the current undo retention period is said to be <span class="italic">expired</span> and its space is available to be overwritten by new transactions. Old undo information with an age that is less than the current undo retention period is said to be <span class="italic">unexpired</span> and is retained for consistent read and Oracle Flashback operations.
                        </p>
                        <p>Oracle Database automatically tunes the undo retention period based on undo tablespace size and system activity. You can optionally specify a minimum undo retention period (in seconds) by setting the <code class="codeph">UNDO_RETENTION</code> initialization parameter. The exact impact this parameter on undo retention is as follows:
                        </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>The <code class="codeph">UNDO_RETENTION</code> parameter is ignored for a fixed size undo tablespace. The database always tunes the undo retention period for the best possible retention, based on system activity and undo tablespace size. See <span class="q">"<a href="managing-undo.html#GUID-43B6D26F-1EF6-4A25-B831-D90E625C7649" title="Oracle Database automatically tunes the undo retention period based on how the undo tablespace is configured.">Automatic Tuning of Undo Retention</a>"</span> for more information.
                              </p>
                           </li>
                           <li>
                              <p>For an undo tablespace with the <code class="codeph">AUTOEXTEND</code> option enabled, the database attempts to honor the minimum retention period specified by <code class="codeph">UNDO_RETENTION</code>. When space is low, instead of overwriting unexpired undo information, the tablespace auto-extends. If the <code class="codeph">MAXSIZE</code> clause is specified for an auto-extending undo tablespace, when the maximum size is reached, the database may begin to overwrite unexpired undo information. The <code class="codeph">UNDOTBS1</code> tablespace that is automatically created by DBCA is auto-extending.
                              </p>
                           </li>
                        </ul>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="managing-undo.html#GUID-28EA4133-BC73-4036-87F2-656FC1A6D9A2" title="The undo retention period is the minimum amount of time that Oracle Database attempts to retain old undo information before overwriting it.">The Undo Retention Period</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="ADMIN11464"></a><div class="props_rev_3"><a id="GUID-43B6D26F-1EF6-4A25-B831-D90E625C7649" name="GUID-43B6D26F-1EF6-4A25-B831-D90E625C7649"></a><h5 id="ADMIN-GUID-43B6D26F-1EF6-4A25-B831-D90E625C7649" class="sect5"><span class="enumeration_section">16.2.2.2 </span>Automatic Tuning of Undo Retention
                     </h5>
                     <div>
                        <p>Oracle Database automatically tunes the undo retention period based on how the undo tablespace is configured.</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>If the undo tablespace is configured with the <code class="codeph">AUTOEXTEND</code> option, the database dynamically tunes the undo retention period to be somewhat longer than the longest-running active query on the system. However, this retention period may be insufficient to accommodate Oracle Flashback operations. Oracle Flashback operations resulting in <code class="codeph">snapshot</code> <code class="codeph">too</code> <code class="codeph">old</code> errors are the indicator that you must intervene to ensure that sufficient undo data is retained to support these operations. To better accommodate Oracle Flashback features, you can either set the <code class="codeph">UNDO_RETENTION</code> parameter to a value equal to the longest expected Oracle Flashback operation, or you can change the undo tablespace to fixed size.
                              </p>
                           </li>
                           <li>
                              <p>If the undo tablespace is fixed size, the database dynamically tunes the undo retention period for the best possible retention for that tablespace size and the current system load. This best possible retention time is typically significantly greater than the duration of the longest-running active query.</p>
                              <p>If you decide to change the undo tablespace to fixed-size, you must choose a tablespace size that is sufficiently large. If you choose an undo tablespace size that is too small, the following two errors could occur:</p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>DML could fail because there is not enough space to accommodate undo for new transactions.</p>
                                 </li>
                                 <li>
                                    <p>Long-running queries could fail with a <code class="codeph">snapshot</code> <code class="codeph">too</code> <code class="codeph">old</code> error, which means that there was insufficient undo data for read consistency.
                                    </p>
                                 </li>
                              </ul>
                              <p>See <span class="q">"<a href="managing-undo.html#GUID-F7D30328-A0CC-4F81-BA54-0FCFC2095F8B" title="Automatic tuning of undo retention typically achieves better results with a fixed-size undo tablespace. If you decide to use a fixed-size undo tablespace, then the Undo Advisor can help you estimate needed capacity.">Sizing a Fixed-Size Undo Tablespace</a>"</span> for more information.
                              </p>
                           </li>
                        </ul>
                        <div class="infoboxnote" id="GUID-43B6D26F-1EF6-4A25-B831-D90E625C7649__GUID-D951240F-797F-41AF-A7B8-8E117DC35E36">
                           <p class="notep1">Note:</p>
                           <p>Automatic tuning of undo retention is not supported for LOBs. This is because undo information for LOBs is stored in the segment itself and not in the undo tablespace. For LOBs, the database attempts to honor the minimum undo retention period specified by <code class="codeph">UNDO_RETENTION</code>. However, if space becomes low, unexpired LOB undo information may be overwritten.
                           </p>
                        </div>
                     </div>
                     <div>
                        <div class="infoboxnotealso" id="GUID-43B6D26F-1EF6-4A25-B831-D90E625C7649__GUID-BD431DB7-CAEE-42D7-8F95-76293D8980F5">
                           <p class="notep1">See Also:</p>
                           <p><span class="q">"<a href="managing-undo.html#GUID-C1272948-3E08-45D9-BD5A-D6461E249EFB" title="You specify the minimum undo retention period (in seconds) by setting the UNDO_RETENTION initialization parameter.">Setting the Minimum Undo Retention Period</a>"</span></p>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="managing-undo.html#GUID-28EA4133-BC73-4036-87F2-656FC1A6D9A2" title="The undo retention period is the minimum amount of time that Oracle Database attempts to retain old undo information before overwriting it.">The Undo Retention Period</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="ADMIN11463"></a><div class="props_rev_3"><a id="GUID-FE48AEC0-64AE-4431-8A29-CD4EA15E6548" name="GUID-FE48AEC0-64AE-4431-8A29-CD4EA15E6548"></a><h5 id="ADMIN-GUID-FE48AEC0-64AE-4431-8A29-CD4EA15E6548" class="sect5"><span class="enumeration_section">16.2.2.3 </span>Retention Guarantee
                     </h5>
                     <div>
                        <p>To guarantee the success of long-running queries or Oracle Flashback operations, you can enable retention guarantee.</p>
                        <p>If retention guarantee is enabled, then the specified minimum undo retention is guaranteed; the database never overwrites unexpired undo data even if it means that transactions fail due to lack of space in the undo tablespace. If retention guarantee is not enabled, then the database can overwrite unexpired undo when space is low, thus lowering the undo retention for the system. This option is disabled by default.</p>
                        <div class="infoboxnotewarn" id="GUID-FE48AEC0-64AE-4431-8A29-CD4EA15E6548__GUID-E4873846-72C2-410A-AC37-BA10ED507EF0">
                           <p class="notep1">WARNING:</p>
                           <p>Enabling retention guarantee can cause multiple DML operations to fail. Use with caution.</p>
                        </div>
                        <p>You enable retention guarantee by specifying the <code class="codeph">RETENTION GUARANTEE</code> clause for the undo tablespace when you create it with either the <code class="codeph">CREATE DATABASE</code> or <code class="codeph">CREATE UNDO TABLESPACE</code> statement. Or, you can later specify this clause in an <code class="codeph">ALTER TABLESPACE</code> statement. You disable retention guarantee with the <code class="codeph">RETENTION NOGUARANTEE</code> clause.
                        </p>
                        <p>You can use the <code class="codeph">DBA_TABLESPACES</code> view to determine the retention guarantee setting for the undo tablespace. A column named <code class="codeph">RETENTION</code> contains a value of <code class="codeph">GUARANTEE</code>, <code class="codeph">NOGUARANTEE</code>, or <code class="codeph">NOT</code> <code class="codeph">APPLY</code>, where <code class="codeph">NOT</code> <code class="codeph">APPLY</code> is used for tablespaces other than the undo tablespace.
                        </p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="managing-undo.html#GUID-28EA4133-BC73-4036-87F2-656FC1A6D9A2" title="The undo retention period is the minimum amount of time that Oracle Database attempts to retain old undo information before overwriting it.">The Undo Retention Period</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="ADMIN12328"></a><div class="props_rev_3"><a id="GUID-3F10B6D7-4A77-4486-A72C-301CFA6F47A9" name="GUID-3F10B6D7-4A77-4486-A72C-301CFA6F47A9"></a><h5 id="ADMIN-GUID-3F10B6D7-4A77-4486-A72C-301CFA6F47A9" class="sect5"><span class="enumeration_section">16.2.2.4 </span>Undo Retention Tuning and Alert Thresholds
                     </h5>
                     <div>
                        <p>For a fixed-size undo tablespace, the database calculates the best possible retention based on database statistics and on the size of the undo tablespace.</p>
                        <p>For optimal undo management, rather than tuning based on 100% of the tablespace size, the database tunes the undo retention period based on 85% of the tablespace size, or on the warning alert threshold percentage for space used, whichever is lower. (The warning alert threshold defaults to 85%, but can be changed.) Therefore, if you set the warning alert threshold of the undo tablespace below 85%, this may reduce the tuned size of the undo retention period. For more information on tablespace alert thresholds, see <span class="q">"<a href="managing-space-for-schema-objects.html#GUID-7C425A1F-3F8F-488D-B7B8-06F432D2C070" title="Two alert thresholds are defined by default: warning and critical. The warning threshold is the limit at which space is beginning to run low. The critical threshold is a serious limit that warrants your immediate attention. The database issues alerts at both thresholds.">Managing Tablespace Alerts</a>"</span>.
                        </p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="managing-undo.html#GUID-28EA4133-BC73-4036-87F2-656FC1A6D9A2" title="The undo retention period is the minimum amount of time that Oracle Database attempts to retain old undo information before overwriting it.">The Undo Retention Period</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="ADMIN12329"></a><div class="props_rev_3"><a id="GUID-8450E94B-D55D-47D6-9872-0778464AD77E" name="GUID-8450E94B-D55D-47D6-9872-0778464AD77E"></a><h5 id="ADMIN-GUID-8450E94B-D55D-47D6-9872-0778464AD77E" class="sect5"><span class="enumeration_section">16.2.2.5 </span>Tracking the Tuned Undo Retention Period
                     </h5>
                     <div>
                        <p>You can determine the current retention period by querying the <code class="codeph">TUNED_UNDORETENTION</code> column of the <code class="codeph">V$UNDOSTAT</code> view.
                        </p>
                        <div class="section">
                           <p>This view contains one row for each 10-minute statistics collection interval over the last 4 days. (Beyond 4 days, the data is available in the <code class="codeph">DBA_HIST_UNDOSTAT</code> view.) <code class="codeph">TUNED_UNDORETENTION</code> is given in seconds.
                           </p><pre class="oac_no_warn" dir="ltr">select to_char(begin_time, 'DD-MON-RR HH24:MI') begin_time,
to_char(end_time, 'DD-MON-RR HH24:MI') end_time, tuned_undoretention
from v$undostat order by end_time;

BEGIN_TIME      END_TIME        TUNED_UNDORETENTION
--------------- --------------- -------------------
04-FEB-05 00:01 04-FEB-05 00:11               12100
      ...                                          
07-FEB-05 23:21 07-FEB-05 23:31               86700
07-FEB-05 23:31 07-FEB-05 23:41               86700
07-FEB-05 23:41 07-FEB-05 23:51               86700
07-FEB-05 23:51 07-FEB-05 23:52               86700

576 rows selected.
</pre><p>See <a href="../refrn/V-UNDOSTAT.html#REFRN30295" target="_blank"><span class="italic">Oracle Database Reference</span></a> for more information about <code class="codeph">V$UNDOSTAT</code>.
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="managing-undo.html#GUID-28EA4133-BC73-4036-87F2-656FC1A6D9A2" title="The undo retention period is the minimum amount of time that Oracle Database attempts to retain old undo information before overwriting it.">The Undo Retention Period</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div>
            </div><a id="ADMIN11465"></a><div class="props_rev_3"><a id="GUID-C1272948-3E08-45D9-BD5A-D6461E249EFB" name="GUID-C1272948-3E08-45D9-BD5A-D6461E249EFB"></a><h3 id="ADMIN-GUID-C1272948-3E08-45D9-BD5A-D6461E249EFB" class="sect3"><span class="enumeration_section">16.3 </span>Setting the Minimum Undo Retention Period
               </h3>
               <div>
                  <p>You specify the minimum undo retention period (in seconds) by setting the <code class="codeph">UNDO_RETENTION</code> initialization parameter.
                  </p>
                  <div class="section">
                     <p>As described in <span class="q">"<a href="managing-undo.html#GUID-049380AF-220F-43C0-81B2-27DCD7953574" title="When automatic undo management is enabled, there is always a current undo retention period, which is the minimum amount of time that Oracle Database attempts to retain old undo information before overwriting it.">About the Undo Retention Period</a>"</span>, the current undo retention period may be automatically tuned to be greater than <code class="codeph">UNDO_RETENTION</code>, or, unless retention guarantee is enabled, less than <code class="codeph">UNDO_RETENTION</code> if space in the undo tablespace is low.
                     </p>
                     <p>To set the minimum undo retention period:</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Do one of the following:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>Set <code class="codeph">UNDO_RETENTION</code> in the initialization parameter file.
                                 </p><pre class="oac_no_warn" dir="ltr">UNDO_RETENTION = 1800
</pre></li>
                              <li>
                                 <p>Change <code class="codeph">UNDO_RETENTION</code> at any time using the <code class="codeph">ALTER SYSTEM</code> statement:
                                 </p><pre class="oac_no_warn" dir="ltr">ALTER SYSTEM SET UNDO_RETENTION = 2400;
</pre></li>
                           </ul>
                        </li>
                     </ul>
                     <p>The effect of an <code class="codeph">UNDO_RETENTION</code> parameter change is immediate, but it can only be honored if the current undo tablespace has enough space.
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="managing-undo.html#GUID-2C865CF9-A8B5-4BF1-A451-E8C08D3611F0" title="For a default installation, Oracle Database automatically manages undo. There is typically no need for DBA intervention. However, if your installation uses Oracle Flashback operations, you may need to perform some undo management tasks to ensure the success of these operations.">Managing Undo</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="ADMIN11466"></a><div class="props_rev_3"><a id="GUID-F7D30328-A0CC-4F81-BA54-0FCFC2095F8B" name="GUID-F7D30328-A0CC-4F81-BA54-0FCFC2095F8B"></a><h3 id="ADMIN-GUID-F7D30328-A0CC-4F81-BA54-0FCFC2095F8B" class="sect3"><span class="enumeration_section">16.4 </span>Sizing a Fixed-Size Undo Tablespace
               </h3>
               <div>
                  <p>Automatic tuning of undo retention typically achieves better results with a fixed-size undo tablespace. If you decide to use a fixed-size undo tablespace, then the Undo Advisor can help you estimate needed capacity.</p>
                  <div class="section">
                     <p>You can access the Undo Advisor through Oracle Enterprise Manager Database Express (EM Express) or through the <code class="codeph">DBMS_ADVISOR</code> PL/SQL package. EM Express is the preferred method of accessing the advisor. For more information on using the Undo Advisor through EM Express, see <a href="../admqs/managing-database-storage-structures.html#ADMQS0635" target="_blank"><span class="italic">Oracle Database 2 Day DBA</span></a>.
                     </p>
                     <p>The Undo Advisor relies for its analysis on data collected in the Automatic Workload Repository (AWR). It is therefore important that the AWR have adequate workload statistics available so that the Undo Advisor can make accurate recommendations. For newly created databases, adequate statistics may not be available immediately. In such cases, continue to use the default auto-extending undo tablespace until at least one workload cycle completes.</p>
                     <p>An adjustment to the collection interval and retention period for AWR statistics can affect the precision and the type of recommendations that the advisor produces. See <a href="../tgdba/gathering-database-statistics.html#TGDBA196" target="_blank"><span class="italic">Oracle Database Performance Tuning Guide</span></a> for more information.
                     </p>
                     <p>To use the Undo Advisor, you first estimate these two values:</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>The length of your expected longest running query</p>
                           <p>After the database has completed a workload cycle, you can view the Longest Running Query field on the System Activity subpage of the Automatic Undo Management page.</p>
                        </li>
                        <li>
                           <p>The longest interval that you will require for Oracle Flashback operations</p>
                           <p>For example, if you expect to run Oracle Flashback queries for up to 48 hours in the past, your Oracle Flashback requirement is 48 hours.</p>
                        </li>
                     </ul>
                     <p>You then take the maximum of these two values and use that value as input to the Undo Advisor.</p>
                     <p>Running the Undo Advisor does not alter the size of the undo tablespace. The advisor just returns a recommendation. You must use <code class="codeph">ALTER</code> <code class="codeph">DATABASE</code> statements to change the tablespace data files to fixed sizes.
                     </p>
                     <p>The following example assumes that the undo tablespace has one auto-extending data file named <code class="codeph">undotbs.dbf</code>. The example changes the tablespace to a fixed size of 300MB.
                     </p><pre class="oac_no_warn" dir="ltr">ALTER DATABASE DATAFILE '/oracle/dbs/undotbs.dbf' RESIZE 300M;
ALTER DATABASE DATAFILE '/oracle/dbs/undotbs.dbf' AUTOEXTEND OFF;</pre><div class="infoboxnote" id="GUID-F7D30328-A0CC-4F81-BA54-0FCFC2095F8B__GUID-D4C9FE99-E2CE-4D74-9E7B-AA8AFA8C04BE">
                        <p class="notep1">Note:</p>
                        <p>To make the undo tablespace fixed-size, Oracle suggests that you first allow enough time after database creation to run a full workload, thus allowing the undo tablespace to grow to its minimum required size to handle the workload. Then, you can use the Undo Advisor to determine, if desired, how much larger to set the size of the undo tablespace to allow for long-running queries and Oracle Flashback operations.</p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="managing-undo.html#GUID-014AE5F8-A5A8-4612-8F16-08D4752F0C78">Activating the Undo Advisor PL/SQL Interface</a><br>You can activate the Undo Advisor by creating an undo advisor task through the advisor framework.
                     </li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-F7D30328-A0CC-4F81-BA54-0FCFC2095F8B__GUID-42D5CFFF-5DFF-4666-B241-27CFC95EAF48">
                     <p class="notep1">See Also:</p>
                     <p><a href="../admqs/managing-database-storage-structures.html#ADMQS0635" target="_blank"><span class="italic">Oracle Database 2 Day DBA</span></a> for instructions for computing the minimum undo tablespace size with the Undo Advisor
                     </p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="managing-undo.html#GUID-2C865CF9-A8B5-4BF1-A451-E8C08D3611F0" title="For a default installation, Oracle Database automatically manages undo. There is typically no need for DBA intervention. However, if your installation uses Oracle Flashback operations, you may need to perform some undo management tasks to ensure the success of these operations.">Managing Undo</a></p>
                     </div>
                  </div>
               </div>
               <a id="ADMIN11469"></a><div class="props_rev_3"><a id="GUID-014AE5F8-A5A8-4612-8F16-08D4752F0C78" name="GUID-014AE5F8-A5A8-4612-8F16-08D4752F0C78"></a><h4 id="ADMIN-GUID-014AE5F8-A5A8-4612-8F16-08D4752F0C78" class="sect4"><span class="enumeration_section">16.4.1 </span>Activating the Undo Advisor PL/SQL Interface
                  </h4>
                  <div>
                     <p>You can activate the Undo Advisor by creating an undo advisor task through the advisor framework.</p>
                     <div class="section">
                        <p>The following example creates an undo advisor task to evaluate the undo tablespace. The name of the advisor is 'Undo Advisor'. The analysis is based on Automatic Workload Repository snapshots, which you must specify by setting parameters <code class="codeph">START_SNAPSHOT</code> and <code class="codeph">END_SNAPSHOT</code>. In the following example, the <code class="codeph">START_SNAPSHOT</code> is "1" and <code class="codeph">END_SNAPSHOT</code> is "2".
                        </p><pre class="oac_no_warn" dir="ltr">DECLARE
   tid    NUMBER;
   tname  VARCHAR2(30);
   oid    NUMBER;
BEGIN
   DBMS_ADVISOR.CREATE_TASK('Undo Advisor', tid, tname, 'Undo Advisor Task');
   DBMS_ADVISOR.CREATE_OBJECT(tname, 'UNDO_TBS', null, null, null, 'null', oid);
   DBMS_ADVISOR.SET_TASK_PARAMETER(tname, 'TARGET_OBJECTS', oid);
   DBMS_ADVISOR.SET_TASK_PARAMETER(tname, 'START_SNAPSHOT', 1);
   DBMS_ADVISOR.SET_TASK_PARAMETER(tname, 'END_SNAPSHOT', 2);
   DBMS_ADVISOR.SET_TASK_PARAMETER(tname, 'INSTANCE', 1);
   DBMS_ADVISOR.execute_task(tname);
END;
/
</pre><p>After you have created the advisor task, you can view the output and recommendations in the Automatic Database Diagnostic Monitor in EM Express. This information is also available in the <code class="codeph">DBA_ADVISOR_*</code> data dictionary views (<code class="codeph">DBA_ADVISOR_TASKS</code>, <code class="codeph">DBA_ADVISOR_OBJECTS</code>, <code class="codeph">DBA_ADVISOR_FINDINGS</code>, <code class="codeph">DBA_ADVISOR_RECOMMENDATIONS</code>, and so on).
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-014AE5F8-A5A8-4612-8F16-08D4752F0C78__GUID-E35EBDD6-A3B3-45A0-BC1D-4237345B2340">
                        <p class="notep1">See Also:</p>
                        <p></p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><span class="q">"<a href="managing-space-for-schema-objects.html#GUID-E9B57A45-2688-42B6-9782-D49702D51F24" title="To use the Segment Advisor, check the results of Automatic Segment Advisor, and, optionally, run the Segment Advisor manually.">Using the Segment Advisor</a>"</span> for an example of creating an advisor task for a different advisor
                              </p>
                           </li>
                           <li>
                              <p><a href="../admqs/monitoring-and-tuning-the-database.html#ADMQS1021" target="_blank"><span class="italic">Oracle Database 2 Day DBA</span></a> for information about the Automatic Database Diagnostic Monitor in EM Express
                              </p>
                           </li>
                           <li>
                              <p><a href="../refrn/index.html" target="_blank"><span class="italic">Oracle Database Reference</span></a> for information about the <code class="codeph">DBA_ADVISOR_*</code> data dictionary views
                              </p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-undo.html#GUID-F7D30328-A0CC-4F81-BA54-0FCFC2095F8B" title="Automatic tuning of undo retention typically achieves better results with a fixed-size undo tablespace. If you decide to use a fixed-size undo tablespace, then the Undo Advisor can help you estimate needed capacity.">Sizing a Fixed-Size Undo Tablespace</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="ADMIN11470"></a><div class="props_rev_3"><a id="GUID-B994F33A-0905-4A7F-BA8C-2B76B43E8188" name="GUID-B994F33A-0905-4A7F-BA8C-2B76B43E8188"></a><h3 id="ADMIN-GUID-B994F33A-0905-4A7F-BA8C-2B76B43E8188" class="sect3"><span class="enumeration_section">16.5 </span>Managing Undo Tablespaces
               </h3>
               <p>You manage undo tablespaces by completing tasks such as creating, altering, and dropping them. You can also switch undo tablespaces and establish user quotas for undo space.</p>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="managing-undo.html#GUID-B9A62413-C613-4CD2-9A03-5ED80B18E0C8">Creating an Undo Tablespace</a><br>Although Database Configuration Assistant (DBCA) automatically creates an undo tablespace for new installations, there may be occasions when you want to manually create an undo tablespace.
                     </li>
                     <li class="ulchildlink"><a href="managing-undo.html#GUID-B103ED51-A921-4E47-A665-BEB5DC927085">Altering an Undo Tablespace</a><br>You can alter an undo tablespaces using the <code class="codeph">ALTER TABLESPACE</code> statement. 
                     </li>
                     <li class="ulchildlink"><a href="managing-undo.html#GUID-825E2A2F-7AEB-4D7A-B8BA-B1533D7BE512">Dropping an Undo Tablespace</a><br>Use the <code class="codeph">DROP TABLESPACE</code> statement to drop an undo tablespace.
                     </li>
                     <li class="ulchildlink"><a href="managing-undo.html#GUID-DC7DBC48-E2B9-48D3-A0EB-1355704390F3">Switching Undo Tablespaces</a><br>You can switch from using one undo tablespace to another. Because the <code class="codeph">UNDO_TABLESPACE</code> initialization parameter is a dynamic parameter, the <code class="codeph">ALTER SYSTEM SET</code> statement can be used to assign a new undo tablespace.
                     </li>
                     <li class="ulchildlink"><a href="managing-undo.html#GUID-B9AE4692-B3C9-4481-8B13-F581BAD0FF8B">Establishing User Quotas for Undo Space</a><br>You can use the Oracle Database Resource Manager to establish user quotas for undo space. The Database Resource Manager directive <code class="codeph">UNDO_POOL</code> allows DBAs to limit the amount of undo space consumed by a group of users (resource consumer group).
                     </li>
                     <li class="ulchildlink"><a href="managing-undo.html#GUID-981972D3-655C-42E5-B79D-17C9D6A84A2C">Managing Space Threshold Alerts for the Undo Tablespace</a><br>Oracle Database provides proactive help in managing tablespace disk space use by alerting you when tablespaces run low on available space.
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="managing-undo.html#GUID-2C865CF9-A8B5-4BF1-A451-E8C08D3611F0" title="For a default installation, Oracle Database automatically manages undo. There is typically no need for DBA intervention. However, if your installation uses Oracle Flashback operations, you may need to perform some undo management tasks to ensure the success of these operations.">Managing Undo</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="sect3"><a id="GUID-B9A62413-C613-4CD2-9A03-5ED80B18E0C8" name="GUID-B9A62413-C613-4CD2-9A03-5ED80B18E0C8"></a><h4 id="ADMIN-GUID-B9A62413-C613-4CD2-9A03-5ED80B18E0C8" class="sect4"><span class="enumeration_section">16.5.1 </span>Creating an Undo Tablespace
                  </h4>
                  <p>Although Database Configuration Assistant (DBCA) automatically creates an undo tablespace for new installations, there may be occasions when you want to manually create an undo tablespace.</p>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="managing-undo.html#GUID-49219733-ABC4-488E-850B-A704B171ACF5">About Creating an Undo Tablespace</a><br>When you are creating a database, you can create an undo tablespace with the <code class="codeph">CREATE DATABASE</code> statement. In an existing database, you can create an undo tablespace with the <code class="codeph">CREATE UNDO TABLESPACE</code> statement.
                        </li>
                        <li class="ulchildlink"><a href="managing-undo.html#GUID-AF9FF46C-9F35-45E4-BBA6-2781C21D22FB">Using CREATE DATABASE to Create an Undo Tablespace</a><br>You can create a specific undo tablespace using the <code class="codeph">UNDO TABLESPACE</code> clause of the <code class="codeph">CREATE DATABASE</code> statement.
                        </li>
                        <li class="ulchildlink"><a href="managing-undo.html#GUID-C78DC3F8-BABD-4DFF-B4E2-5154D45D64C4">Using the CREATE UNDO TABLESPACE Statement</a><br>The <code class="codeph">CREATE UNDO TABLESPACE </code>statement is the same as the <code class="codeph">CREATE TABLESPACE</code> statement, but the <code class="codeph">UNDO</code> keyword is specified. The database determines most of the attributes of the undo tablespace, but you can specify the <code class="codeph">DATAFILE</code> clause.
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-undo.html#GUID-B994F33A-0905-4A7F-BA8C-2B76B43E8188" title="You manage undo tablespaces by completing tasks such as creating, altering, and dropping them. You can also switch undo tablespaces and establish user quotas for undo space.">Managing Undo Tablespaces</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="ADMIN11471"></a><div class="props_rev_3"><a id="GUID-49219733-ABC4-488E-850B-A704B171ACF5" name="GUID-49219733-ABC4-488E-850B-A704B171ACF5"></a><h5 id="ADMIN-GUID-49219733-ABC4-488E-850B-A704B171ACF5" class="sect5"><span class="enumeration_section">16.5.1.1 </span>About Creating an Undo Tablespace
                     </h5>
                     <div>
                        <p>When you are creating a database, you can create an undo tablespace with the <code class="codeph">CREATE DATABASE</code> statement. In an existing database, you can create an undo tablespace with the <code class="codeph">CREATE UNDO TABLESPACE</code> statement.
                        </p>
                        <p>There are two methods of creating an undo tablespace. The first method creates the undo tablespace when the <code class="codeph">CREATE DATABASE</code> statement is issued. This occurs when you are creating a new database, and the instance is started in automatic undo management mode (<code class="codeph">UNDO_MANAGEMENT = AUTO</code>). The second method is used with an existing database. It uses the <code class="codeph">CREATE UNDO TABLESPACE</code> statement.
                        </p>
                        <p>You cannot create database objects in an undo tablespace. It is reserved for system-managed undo data.</p>
                        <p>Oracle Database enables you to create a single-file undo tablespace. Single-file, or bigfile, tablespaces are discussed in <span class="q">"<a href="managing-tablespaces.html#GUID-7E376766-D99D-4274-BF00-8DC1E6FC5063" title="A bigfile tablespace is a tablespace with a single, but potentially very large (up to 4G blocks) data file. Traditional smallfile tablespaces, in contrast, can contain multiple data files, but the files cannot be as large.">Bigfile Tablespaces</a>"</span>.
                        </p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="managing-undo.html#GUID-B9A62413-C613-4CD2-9A03-5ED80B18E0C8" title="Although Database Configuration Assistant (DBCA) automatically creates an undo tablespace for new installations, there may be occasions when you want to manually create an undo tablespace.">Creating an Undo Tablespace</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="ADMIN11472"></a><div class="props_rev_3"><a id="GUID-AF9FF46C-9F35-45E4-BBA6-2781C21D22FB" name="GUID-AF9FF46C-9F35-45E4-BBA6-2781C21D22FB"></a><h5 id="ADMIN-GUID-AF9FF46C-9F35-45E4-BBA6-2781C21D22FB" class="sect5"><span class="enumeration_section">16.5.1.2 </span>Using CREATE DATABASE to Create an Undo Tablespace
                     </h5>
                     <div>
                        <p>You can create a specific undo tablespace using the <code class="codeph">UNDO TABLESPACE</code> clause of the <code class="codeph">CREATE DATABASE</code> statement.
                        </p>
                        <div class="section">
                           <p>The following statement illustrates using the <code class="codeph">UNDO TABLESPACE</code> clause in a <code class="codeph">CREATE DATABASE</code> statement. The undo tablespace is named <code class="codeph">undotbs_01</code> and one data file, <code class="codeph">/u01/oracle/rbdb1/undo0101.dbf</code>, is allocated for it.
                           </p><pre class="oac_no_warn" dir="ltr">CREATE DATABASE rbdb1
     CONTROLFILE REUSE
     .
     .
     .
     UNDO TABLESPACE undotbs_01 DATAFILE '/u01/oracle/rbdb1/undo0101.dbf';
</pre><p>If the undo tablespace cannot be created successfully during <code class="codeph">CREATE DATABASE</code>, the entire <code class="codeph">CREATE DATABASE</code> operation fails. You must clean up the database files, correct the error and retry the <code class="codeph">CREATE DATABASE</code> operation.
                           </p>
                           <p>The <code class="codeph">CREATE DATABASE</code> statement also lets you create a single-file undo tablespace at database creation. This is discussed in <span class="q">"<a href="creating-and-configuring-an-oracle-database.html#GUID-35A12594-29EB-4545-A6AD-63B9AC3A5671" title="Oracle Database simplifies management of tablespaces and enables support for extremely large databases by letting you create bigfile tablespaces.">Supporting Bigfile Tablespaces During Database Creation</a>"</span>.
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="infoboxnotealso" id="GUID-AF9FF46C-9F35-45E4-BBA6-2781C21D22FB__GUID-98E6A9CD-6F18-4882-980B-B458AFB3DBF5">
                           <p class="notep1">See Also:</p>
                           <p><a href="../sqlrf/CREATE-DATABASE.html#SQLRF01204" target="_blank"><span class="italic">Oracle Database SQL Language Reference</span></a> for the syntax for using the <code class="codeph">CREATE DATABASE</code> statement to create an undo tablespace
                           </p>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="managing-undo.html#GUID-B9A62413-C613-4CD2-9A03-5ED80B18E0C8" title="Although Database Configuration Assistant (DBCA) automatically creates an undo tablespace for new installations, there may be occasions when you want to manually create an undo tablespace.">Creating an Undo Tablespace</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="ADMIN11473"></a><div class="props_rev_3"><a id="GUID-C78DC3F8-BABD-4DFF-B4E2-5154D45D64C4" name="GUID-C78DC3F8-BABD-4DFF-B4E2-5154D45D64C4"></a><h5 id="ADMIN-GUID-C78DC3F8-BABD-4DFF-B4E2-5154D45D64C4" class="sect5"><span class="enumeration_section">16.5.1.3 </span>Using the CREATE UNDO TABLESPACE Statement
                     </h5>
                     <div>
                        <p>The <code class="codeph">CREATE UNDO TABLESPACE </code>statement is the same as the <code class="codeph">CREATE TABLESPACE</code> statement, but the <code class="codeph">UNDO</code> keyword is specified. The database determines most of the attributes of the undo tablespace, but you can specify the <code class="codeph">DATAFILE</code> clause.
                        </p>
                        <div class="section">
                           <p>This example creates the <code class="codeph">undotbs_02</code> undo tablespace with the <code class="codeph">AUTOEXTEND</code> option: 
                           </p><pre class="oac_no_warn" dir="ltr">CREATE UNDO TABLESPACE undotbs_02
     DATAFILE '/u01/oracle/rbdb1/undo0201.dbf' SIZE 2M REUSE AUTOEXTEND ON;
</pre><p>You can create multiple undo tablespaces, but only one of them can be active at any one time.</p>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="infoboxnotealso" id="GUID-C78DC3F8-BABD-4DFF-B4E2-5154D45D64C4__GUID-29B895CA-A145-40F9-9113-58B102269EA8">
                           <p class="notep1">See Also:</p>
                           <p><a href="../sqlrf/CREATE-TABLESPACE.html#SQLRF01403" target="_blank"><span class="italic">Oracle Database SQL Language Reference</span></a> for the syntax for using the <code class="codeph">CREATE UNDO TABLESPACE </code>statement to create an undo tablespace
                           </p>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="managing-undo.html#GUID-B9A62413-C613-4CD2-9A03-5ED80B18E0C8" title="Although Database Configuration Assistant (DBCA) automatically creates an undo tablespace for new installations, there may be occasions when you want to manually create an undo tablespace.">Creating an Undo Tablespace</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div><a id="ADMIN11474"></a><div class="props_rev_3"><a id="GUID-B103ED51-A921-4E47-A665-BEB5DC927085" name="GUID-B103ED51-A921-4E47-A665-BEB5DC927085"></a><h4 id="ADMIN-GUID-B103ED51-A921-4E47-A665-BEB5DC927085" class="sect4"><span class="enumeration_section">16.5.2 </span>Altering an Undo Tablespace
                  </h4>
                  <div>
                     <p>You can alter an undo tablespaces using the <code class="codeph">ALTER TABLESPACE</code> statement. 
                     </p>
                     <div class="section">
                        <p>However, since most aspects of undo tablespaces are system managed, you need only be concerned with the following actions:</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Adding a data file</p>
                           </li>
                           <li>
                              <p>Renaming a data file</p>
                           </li>
                           <li>
                              <p>Bringing a data file online or taking it offline</p>
                           </li>
                           <li>
                              <p>Beginning or ending an open backup on a data file</p>
                           </li>
                           <li>
                              <p>Enabling and disabling undo retention guarantee</p>
                           </li>
                        </ul>
                        <p>These are also the only attributes you are permitted to alter.</p>
                        <p>If an undo tablespace runs out of space, or you want to prevent it from doing so, you can add more files to it or resize existing data files.</p>
                        <p>The following example adds another data file to undo tablespace undotbs_01:</p><pre class="oac_no_warn" dir="ltr">ALTER TABLESPACE undotbs_01
     ADD DATAFILE '/u01/oracle/rbdb1/undo0102.dbf' AUTOEXTEND ON NEXT 1M 
         MAXSIZE UNLIMITED;
</pre><p>You can use the <code class="codeph">ALTER DATABASE...DATAFILE</code> statement to resize or extend a data file.
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-B103ED51-A921-4E47-A665-BEB5DC927085__GUID-2DC7FA0A-B957-48E7-A8B7-A972B35098B1">
                        <p class="notep1">See Also:</p>
                        <p></p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><span class="q">"<a href="managing-data-files-and-temp-files.html#GUID-8E7A9714-85CB-45F3-8384-00D68EAC3E58" title="You can alter the size of a data file. For example, you can increase the size of one or more data files when more space is needed in the database.">Changing Data File Size</a>"</span></p>
                           </li>
                           <li>
                              <p><a href="../sqlrf/ALTER-TABLESPACE.html#SQLRF01002" target="_blank"><span class="italic">Oracle Database SQL Language Reference</span></a> for <code class="codeph">ALTER TABLESPACE</code> syntax
                              </p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-undo.html#GUID-B994F33A-0905-4A7F-BA8C-2B76B43E8188" title="You manage undo tablespaces by completing tasks such as creating, altering, and dropping them. You can also switch undo tablespaces and establish user quotas for undo space.">Managing Undo Tablespaces</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="ADMIN11475"></a><div class="props_rev_3"><a id="GUID-825E2A2F-7AEB-4D7A-B8BA-B1533D7BE512" name="GUID-825E2A2F-7AEB-4D7A-B8BA-B1533D7BE512"></a><h4 id="ADMIN-GUID-825E2A2F-7AEB-4D7A-B8BA-B1533D7BE512" class="sect4"><span class="enumeration_section">16.5.3 </span>Dropping an Undo Tablespace
                  </h4>
                  <div>
                     <p>Use the <code class="codeph">DROP TABLESPACE</code> statement to drop an undo tablespace.
                     </p>
                     <div class="section">
                        <p>The following example drops the undo tablespace <code class="codeph">undotbs_01</code>:
                        </p><pre class="oac_no_warn" dir="ltr">DROP TABLESPACE undotbs_01;
</pre><p>An undo tablespace can only be dropped if it is not currently used by any instance. If the undo tablespace contains any outstanding transactions (for example, a transaction died but has not yet been recovered), the <code class="codeph">DROP TABLESPACE</code> statement fails. However, since <code class="codeph">DROP TABLESPACE</code> drops an undo tablespace even if it contains unexpired undo information (within retention period), you must be careful not to drop an undo tablespace if undo information is needed by some existing queries.
                        </p>
                        <p><code class="codeph">DROP TABLESPACE</code> for undo tablespaces behaves like <code class="codeph">DROP TABLESPACE...INCLUDING CONTENTS</code>. All contents of the undo tablespace are removed.
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-825E2A2F-7AEB-4D7A-B8BA-B1533D7BE512__GUID-63FEB8DF-D7C1-4631-8B54-3A690C0E3FA2">
                        <p class="notep1">See Also:</p>
                        <p><a href="../sqlrf/DROP-TABLESPACE.html#SQLRF01807" target="_blank"><span class="italic">Oracle Database SQL Language Reference</span></a> for <code class="codeph">DROP TABLESPACE</code> syntax
                        </p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-undo.html#GUID-B994F33A-0905-4A7F-BA8C-2B76B43E8188" title="You manage undo tablespaces by completing tasks such as creating, altering, and dropping them. You can also switch undo tablespaces and establish user quotas for undo space.">Managing Undo Tablespaces</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="ADMIN11476"></a><div class="props_rev_3"><a id="GUID-DC7DBC48-E2B9-48D3-A0EB-1355704390F3" name="GUID-DC7DBC48-E2B9-48D3-A0EB-1355704390F3"></a><h4 id="ADMIN-GUID-DC7DBC48-E2B9-48D3-A0EB-1355704390F3" class="sect4"><span class="enumeration_section">16.5.4 </span>Switching Undo Tablespaces
                  </h4>
                  <div>
                     <p>You can switch from using one undo tablespace to another. Because the <code class="codeph">UNDO_TABLESPACE</code> initialization parameter is a dynamic parameter, the <code class="codeph">ALTER SYSTEM SET</code> statement can be used to assign a new undo tablespace.
                     </p>
                     <div class="section">
                        <p>The following statement switches to a new undo tablespace:</p><pre class="oac_no_warn" dir="ltr">ALTER SYSTEM SET UNDO_TABLESPACE = undotbs_02;
</pre><p>Assuming <code class="codeph">undotbs_01</code> is the current undo tablespace, after this command successfully executes, the instance uses <code class="codeph">undotbs_02</code> in place of <code class="codeph">undotbs_01</code> as its undo tablespace. 
                        </p>
                        <p>If any of the following conditions exist for the tablespace being switched to, an error is reported and no switching occurs:</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>The tablespace does not exist </p>
                           </li>
                           <li>
                              <p>The tablespace is not an undo tablespace</p>
                           </li>
                           <li>
                              <p>The tablespace is already being used by another instance (in an Oracle RAC environment only)</p>
                           </li>
                        </ul>
                        <p>The database is online while the switch operation is performed, and user transactions can be executed while this command is being executed. When the switch operation completes successfully, all transactions started after the switch operation began are assigned to transaction tables in the new undo tablespace. </p>
                        <p>The switch operation does not wait for transactions in the old undo tablespace to commit. If there are any pending transactions in the old undo tablespace, the old undo tablespace enters into a <code class="codeph">PENDING OFFLINE</code> mode (status). In this mode, existing transactions can continue to execute, but undo records for new user transactions cannot be stored in this undo tablespace. 
                        </p>
                        <p>An undo tablespace can exist in this <code class="codeph">PENDING OFFLINE</code> mode, even after the switch operation completes successfully. A <code class="codeph">PENDING OFFLINE</code> <a id="d168466e1913" class="indexterm-anchor"></a>undo tablespace cannot be used by another instance, nor can it be dropped. Eventually, after all active transactions have committed, the undo tablespace automatically goes from the <code class="codeph">PENDING OFFLINE</code> mode to the <code class="codeph">OFFLINE</code> mode. From then on, the undo tablespace is available for other instances (in an Oracle Real Application Cluster environment).
                        </p>
                        <p>If the parameter value for <code class="codeph">UNDO TABLESPACE</code> is set to '' (two single quotes), then the current undo tablespace is switched out and the next available undo tablespace is switched in. Use this statement with care because  there may be no undo tablespace available.
                        </p>
                        <p>The following example unassigns the current undo tablespace:</p><pre class="oac_no_warn" dir="ltr">ALTER SYSTEM SET UNDO_TABLESPACE = '';</pre></div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-undo.html#GUID-B994F33A-0905-4A7F-BA8C-2B76B43E8188" title="You manage undo tablespaces by completing tasks such as creating, altering, and dropping them. You can also switch undo tablespaces and establish user quotas for undo space.">Managing Undo Tablespaces</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="ADMIN11477"></a><div class="props_rev_3"><a id="GUID-B9AE4692-B3C9-4481-8B13-F581BAD0FF8B" name="GUID-B9AE4692-B3C9-4481-8B13-F581BAD0FF8B"></a><h4 id="ADMIN-GUID-B9AE4692-B3C9-4481-8B13-F581BAD0FF8B" class="sect4"><span class="enumeration_section">16.5.5 </span>Establishing User Quotas for Undo Space
                  </h4>
                  <div>
                     <p>You can use the Oracle Database Resource Manager to establish user quotas for undo space. The Database Resource Manager directive <code class="codeph">UNDO_POOL</code> allows DBAs to limit the amount of undo space consumed by a group of users (resource consumer group).
                     </p>
                     <p>You can specify an undo pool for each consumer group. An undo pool controls the amount of total undo that can be generated by a consumer group. When the total undo generated by a consumer group exceeds its undo limit, the current <code class="codeph">UPDATE</code> transaction generating the undo is terminated. No other members of the consumer group can perform further updates until undo space is freed from the pool.
                     </p>
                     <p>When no <code class="codeph">UNDO_POOL</code> directive is explicitly defined, users are allowed unlimited undo space.
                     </p>
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-B9AE4692-B3C9-4481-8B13-F581BAD0FF8B__GUID-2566CD17-0B38-4822-9FF0-79CC71F934AC">
                        <p class="notep1">See Also:</p>
                        <p><a href="managing-resources-with-oracle-database-resource-manager.html#GUID-2BEF5482-CF97-4A85-BD90-9195E41E74EF" title="Oracle Database Resource Manager (Resource Manager) enables you to manage resource allocation for a database.">Managing Resources with Oracle Database Resource Manager</a></p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-undo.html#GUID-B994F33A-0905-4A7F-BA8C-2B76B43E8188" title="You manage undo tablespaces by completing tasks such as creating, altering, and dropping them. You can also switch undo tablespaces and establish user quotas for undo space.">Managing Undo Tablespaces</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="ADMIN11478"></a><div class="props_rev_3"><a id="GUID-981972D3-655C-42E5-B79D-17C9D6A84A2C" name="GUID-981972D3-655C-42E5-B79D-17C9D6A84A2C"></a><h4 id="ADMIN-GUID-981972D3-655C-42E5-B79D-17C9D6A84A2C" class="sect4"><span class="enumeration_section">16.5.6 </span>Managing Space Threshold Alerts for the Undo Tablespace
                  </h4>
                  <div>
                     <p>Oracle Database provides proactive help in managing tablespace disk space use by alerting you when tablespaces run low on available space.</p>
                     <p>See <span class="q">"<a href="managing-space-for-schema-objects.html#GUID-7C425A1F-3F8F-488D-B7B8-06F432D2C070" title="Two alert thresholds are defined by default: warning and critical. The warning threshold is the limit at which space is beginning to run low. The critical threshold is a serious limit that warrants your immediate attention. The database issues alerts at both thresholds.">Managing Tablespace Alerts</a>"</span> for information on how to set alert thresholds for the undo tablespace.
                     </p>
                     <p>In addition to the proactive undo space alerts, Oracle Database also provides alerts if your system has long-running queries that cause <code class="codeph">SNAPSHOT</code> <code class="codeph">TOO</code> <code class="codeph">OLD</code> errors. To prevent excessive alerts, the long query alert is issued at most once every 24 hours. When the alert is generated, you can check the Undo Advisor Page of EM Express to get more information about the undo tablespace. For more information on using the Undo Advisor through EM Express, see <a href="../admqs/managing-database-storage-structures.html#ADMQS0635" target="_blank"><span class="italic">Oracle Database 2 Day DBA</span></a>.
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-undo.html#GUID-B994F33A-0905-4A7F-BA8C-2B76B43E8188" title="You manage undo tablespaces by completing tasks such as creating, altering, and dropping them. You can also switch undo tablespaces and establish user quotas for undo space.">Managing Undo Tablespaces</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="ADMIN11479"></a><div class="props_rev_3"><a id="GUID-B159A41D-C28C-4E6E-BAAF-FE5ACE2C18B7" name="GUID-B159A41D-C28C-4E6E-BAAF-FE5ACE2C18B7"></a><h3 id="ADMIN-GUID-B159A41D-C28C-4E6E-BAAF-FE5ACE2C18B7" class="sect3"><span class="enumeration_section">16.6 </span>Migrating to Automatic Undo Management
               </h3>
               <div>
                  <p>If you are currently using rollback segments to manage undo space, Oracle strongly recommends that you migrate your database to automatic undo management.</p>
                  <p>For instructions, see <a href="../upgrd/index.html" target="_blank"><span class="italic">Oracle Database Upgrade Guide</span></a>.
                  </p>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="managing-undo.html#GUID-2C865CF9-A8B5-4BF1-A451-E8C08D3611F0" title="For a default installation, Oracle Database automatically manages undo. There is typically no need for DBA intervention. However, if your installation uses Oracle Flashback operations, you may need to perform some undo management tasks to ensure the success of these operations.">Managing Undo</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="ADMIN13740"></a><div class="props_rev_3"><a id="GUID-9A6B9475-63ED-4204-93DD-2B77BEB858CE" name="GUID-9A6B9475-63ED-4204-93DD-2B77BEB858CE"></a><h3 id="ADMIN-GUID-9A6B9475-63ED-4204-93DD-2B77BEB858CE" class="sect3"><span class="enumeration_section">16.7 </span>Managing Temporary Undo
               </h3>
               <p>By default, undo records for temporary tables are stored in the undo tablespace and are logged in the redo, which is the same way undo is managed for persistent tables. However, you can use the <code class="codeph">TEMP_UNDO_ENABLED</code> initialization parameter to separate undo for temporary tables from undo for persistent tables. When this parameter is set to <code class="codeph">TRUE</code>, the undo for temporary tables is called <span class="bold">temporary undo</span>. 
               </p>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="managing-undo.html#GUID-EB6F70B8-BC3E-4D69-991C-7DFC932009B4">About Managing Temporary Undo</a><br>Temporary undo records are stored in the database's temporary tablespaces and thus are not logged in the redo log. When temporary undo is enabled, some of the segments used by the temporary tablespaces store the temporary undo, and these segments are called <span class="bold">temporary undo segments</span>.
                     </li>
                     <li class="ulchildlink"><a href="managing-undo.html#GUID-73EAD58E-14D2-4DA4-A126-22401B82231A">Enabling and Disabling Temporary Undo</a><br>You can enable or disable temporary undo for a session or for the system. To do so, set the <code class="codeph">TEMP_UNDO_ENABLED</code> initialization parameter.
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="managing-undo.html#GUID-2C865CF9-A8B5-4BF1-A451-E8C08D3611F0" title="For a default installation, Oracle Database automatically manages undo. There is typically no need for DBA intervention. However, if your installation uses Oracle Flashback operations, you may need to perform some undo management tasks to ensure the success of these operations.">Managing Undo</a></p>
                     </div>
                  </div>
               </div>
               <a id="ADMIN13741"></a><div class="props_rev_3"><a id="GUID-EB6F70B8-BC3E-4D69-991C-7DFC932009B4" name="GUID-EB6F70B8-BC3E-4D69-991C-7DFC932009B4"></a><h4 id="ADMIN-GUID-EB6F70B8-BC3E-4D69-991C-7DFC932009B4" class="sect4"><span class="enumeration_section">16.7.1 </span>About Managing Temporary Undo
                  </h4>
                  <div>
                     <p>Temporary undo records are stored in the database's temporary tablespaces and thus are not logged in the redo log. When temporary undo is enabled, some of the segments used by the temporary tablespaces store the temporary undo, and these segments are called <span class="bold">temporary undo segments</span>.
                     </p>
                     <p>When temporary undo is enabled, it might be necessary to increase the size of the temporary tablespaces to account for the undo records.</p>
                     <p>Enabling temporary undo provides the following benefits:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Temporary undo reduces the amount of undo stored in the undo tablespaces.</p>
                           <p>Less undo in the undo tablespaces can result in more realistic undo retention period requirements for undo records.</p>
                        </li>
                        <li>
                           <p>Temporary undo reduces the size of the redo log.</p>
                           <p>Performance is improved because less data is written to the redo log, and components that parse redo log records, such as LogMiner, perform better because there is less redo data to parse.</p>
                        </li>
                        <li>
                           <p>Temporary undo enables data manipulation language (DML) operations on temporary tables in a physical standby database with the Oracle Active Data Guard option. However, data definition language (DDL) operations that create temporary tables must be issued on the primary database.</p>
                        </li>
                     </ul>
                     <p>You can enable temporary undo for a specific session or for the whole system. When you enable temporary undo for a session using an <code class="codeph">ALTER</code> <code class="codeph">SESSION</code> statement, the session creates temporary undo without affecting other sessions. When you enable temporary undo for the system using an <code class="codeph">ALTER</code> <code class="codeph">SYSTEM</code> statement, all existing sessions and new sessions create temporary undo.
                     </p>
                     <p>When a session uses temporary objects for the first time, the current value of the <code class="codeph">TEMP_UNDO_ENABLED</code> initialization parameter is set for the rest of the session. Therefore, if temporary undo is enabled for a session and the session uses temporary objects, then temporary undo cannot be disabled for the session. Similarly, if temporary undo is disabled for a session and the session uses temporary objects, then temporary undo cannot be enabled for the session.
                     </p>
                     <p>Temporary undo is enabled by default for a physical standby database with the Oracle Active Data Guard option. The <code class="codeph">TEMP_UNDO_ENABLED</code> initialization parameter has no effect on a physical standby database with Active Data Guard option because of the default setting.
                     </p>
                     <div class="infoboxnote" id="GUID-EB6F70B8-BC3E-4D69-991C-7DFC932009B4__GUID-86317552-3F90-4450-BD63-42266580680F">
                        <p class="notep1">Note:</p>
                        <p>Temporary undo can be enabled only if the compatibility level of the database is 12.0.0 or higher.</p>
                     </div>
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-EB6F70B8-BC3E-4D69-991C-7DFC932009B4__GUID-0F8FA54A-4C69-4DF1-B26E-419A981DC59C">
                        <p class="notep1">See Also:</p>
                        <p></p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><span class="q">"<a href="managing-tables.html#GUID-A48CB362-FC15-4A26-8386-906A55F6788E" title="Examples illustrate how to create a global temporary table.">Creating a Temporary Table</a>"</span></p>
                           </li>
                           <li>
                              <p><span class="q">"<a href="managing-undo.html#GUID-049380AF-220F-43C0-81B2-27DCD7953574" title="When automatic undo management is enabled, there is always a current undo retention period, which is the minimum amount of time that Oracle Database attempts to retain old undo information before overwriting it.">About the Undo Retention Period</a>"</span></p>
                           </li>
                           <li>
                              <p><a href="../refrn/TEMP_UNDO_ENABLED.html#REFRN10326" target="_blank"><span class="italic">Oracle Database Reference</span></a> for more information about the <code class="codeph">TEMP_UNDO_ENABLED</code> initialization parameter
                              </p>
                           </li>
                           <li>
                              <p><a href="../sbydb/managing-oracle-data-guard-physical-standby-databases.html#SBYDB5163" target="_blank"><span class="italic">Oracle Data Guard Concepts and Administration</span></a></p>
                           </li>
                           <li>
                              <p><a href="../cncpt/logical-storage-structures.html#CNCPT89227" target="_blank"><span class="italic">Oracle Database Concepts</span></a> for more information about temporary undo segments
                              </p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-undo.html#GUID-9A6B9475-63ED-4204-93DD-2B77BEB858CE" title="By default, undo records for temporary tables are stored in the undo tablespace and are logged in the redo, which is the same way undo is managed for persistent tables. However, you can use the TEMP_UNDO_ENABLED initialization parameter to separate undo for temporary tables from undo for persistent tables. When this parameter is set to TRUE, the undo for temporary tables is called temporary undo.">Managing Temporary Undo</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="ADMIN13742"></a><div class="props_rev_3"><a id="GUID-73EAD58E-14D2-4DA4-A126-22401B82231A" name="GUID-73EAD58E-14D2-4DA4-A126-22401B82231A"></a><h4 id="ADMIN-GUID-73EAD58E-14D2-4DA4-A126-22401B82231A" class="sect4"><span class="enumeration_section">16.7.2 </span>Enabling and Disabling Temporary Undo
                  </h4>
                  <div>
                     <p>You can enable or disable temporary undo for a session or for the system. To do so, set the <code class="codeph">TEMP_UNDO_ENABLED</code> initialization parameter.
                     </p>
                     <div class="section">
                        <p>To enable or disable temporary undo:</p>
                        <ol>
                           <li>
                              <p>In SQL*Plus, connect to the database.</p>
                              <p>If you are enabling or disabling temporary undo for a session, then start the session in SQL*Plus.</p>
                              <p>If you are enabling or disabling temporary undo for the system, then connect as an administrative user with the <code class="codeph">ALTER</code> <code class="codeph">SYSTEM</code> system privilege in SQL*Plus.
                              </p>
                              <p>See <span class="q">"<a href="getting-started-with-database-administration.html#GUID-895EC72B-C620-4D93-9F23-3F6DC1706764" title="Oracle Database includes the following components: the Oracle Database instance, which is a collection of processes and memory, and a set of disk files that contain user data and system data.">Connecting to the Database with SQL*Plus</a>"</span>.
                              </p>
                           </li>
                           <li>
                              <p>Set the <code class="codeph">TEMP_UNDO_ENABLED</code> initialization parameter:
                              </p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>To enable temporary undo for a session, run the following SQL statement:</p><pre class="oac_no_warn" dir="ltr">ALTER SESSION SET TEMP_UNDO_ENABLED = TRUE;
</pre></li>
                                 <li>
                                    <p>To disable temporary undo for a session, run the following SQL statement:</p><pre class="oac_no_warn" dir="ltr">ALTER SESSION SET TEMP_UNDO_ENABLED = FALSE;
</pre></li>
                                 <li>
                                    <p>To enable temporary undo for the system, run the following SQL statement:</p><pre class="oac_no_warn" dir="ltr">ALTER SYSTEM SET TEMP_UNDO_ENABLED = TRUE;
</pre><p>After temporary undo is enabled for the system, a session can disable temporary undo using the <code class="codeph">ALTER</code> <code class="codeph">SESSION</code> statement.
                                    </p>
                                 </li>
                                 <li>
                                    <p>To disable temporary undo for the system, run the following SQL statement:</p><pre class="oac_no_warn" dir="ltr">ALTER SYSTEM SET TEMP_UNDO_ENABLED = FALSE;
</pre><p>After temporary undo is disabled for the system, a session can enable temporary undo using the <code class="codeph">ALTER</code> <code class="codeph">SESSION</code> statement.
                                    </p>
                                 </li>
                              </ul>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>You can also enable temporary undo for the system by setting <code class="codeph">TEMP_UNDO_ENABLED</code> to <code class="codeph">TRUE</code> in a server parameter file or a text initialization parameter file. In this case, all new sessions create temporary undo unless temporary undo is disabled for the system by an <code class="codeph">ALTER</code> <code class="codeph">SYSTEM</code> statement or for a session by an <code class="codeph">ALTER</code> <code class="codeph">SESSION</code> statement.
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-73EAD58E-14D2-4DA4-A126-22401B82231A__GUID-0E808DCA-9D2D-4320-A112-E396C6C19485">
                        <p class="notep1">See Also:</p>
                        <p></p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="../refrn/TEMP_UNDO_ENABLED.html#REFRN10326" target="_blank"><span class="italic">Oracle Database Reference</span></a> for more information about the <code class="codeph">TEMP_UNDO_ENABLED</code> initialization parameter
                              </p>
                           </li>
                           <li>
                              <p><a href="../sbydb/managing-oracle-data-guard-physical-standby-databases.html#SBYDB5163" target="_blank"><span class="italic">Oracle Data Guard Concepts and Administration</span></a> for information about enabling and disabling temporary undo in an Oracle Data Guard environment
                              </p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-undo.html#GUID-9A6B9475-63ED-4204-93DD-2B77BEB858CE" title="By default, undo records for temporary tables are stored in the undo tablespace and are logged in the redo, which is the same way undo is managed for persistent tables. However, you can use the TEMP_UNDO_ENABLED initialization parameter to separate undo for temporary tables from undo for persistent tables. When this parameter is set to TRUE, the undo for temporary tables is called temporary undo.">Managing Temporary Undo</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="ADMIN11480"></a><div class="props_rev_3"><a id="GUID-F9B85E9D-D56A-43D2-AB52-918C0FE4D609" name="GUID-F9B85E9D-D56A-43D2-AB52-918C0FE4D609"></a><h3 id="ADMIN-GUID-F9B85E9D-D56A-43D2-AB52-918C0FE4D609" class="sect3"><span class="enumeration_section">16.8 </span>Undo Space Data Dictionary Views
               </h3>
               <div>
                  <p>You can query a set of views for information about undo space in the automatic undo management mode.</p>
                  <div class="section">
                     <p>In addition to views listed here, you can obtain information from the views available for viewing tablespace and data file information. See <span class="q">"<a href="managing-data-files-and-temp-files.html#GUID-8873DB8E-71AF-4793-A4F7-2694FD4E10F9" title="A set of data dictionary views provides useful information about the data files of a database.">Data Files Data Dictionary Views</a>"</span> for information on getting information about those views.
                     </p>
                     <p>The following dynamic performance views are useful for obtaining space information about the undo tablespace:</p>
                  </div>
                  <!-- class="section" -->
                  <div class="tblformal" id="GUID-F9B85E9D-D56A-43D2-AB52-918C0FE4D609__GUID-F6AA1748-28FB-45DB-AD00-ED0DFF7D788C">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" summary="Column 1 lists the views that are useful for obtaining information about the undo tablespace. Column 2 describes each view." width="100%" frame="hsides" border="1" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="35%" id="d168466e2561">View</th>
                              <th align="left" valign="bottom" width="65%" id="d168466e2564">Description</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="35%" id="d168466e2569" headers="d168466e2561 ">
                                 <p><code class="codeph"><a href="../refrn/V-UNDOSTAT.html#REFRN30295" target="_blank">V$UNDOSTAT</a></code> 
                                 </p>
                              </td>
                              <td align="left" valign="top" width="65%" headers="d168466e2569 d168466e2564 ">
                                 <p>Contains statistics for monitoring and tuning undo space. Use this view to help estimate the amount of undo space required for the current workload. The database also uses this information to help tune undo usage in the system. This view is meaningful only in automatic undo management mode. </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="35%" id="d168466e2580" headers="d168466e2561 ">
                                 <p><code class="codeph"><a href="../refrn/V-TEMPUNDOSTAT.html#REFRN30689" target="_blank">V$TEMPUNDOSTAT</a></code> 
                                 </p>
                              </td>
                              <td align="left" valign="top" width="65%" headers="d168466e2580 d168466e2564 ">
                                 <p>Contains statistics for monitoring and tuning temporary undo space. Use this view to help estimate the amount of temporary undo space required in the temporary tablespaces for the current workload. The database also uses this information to help tune temporary undo usage in the system. This view is meaningful only when temporary undo is enabled.</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="35%" id="d168466e2591" headers="d168466e2561 ">
                                 <p><code class="codeph"><a href="../refrn/V-ROLLSTAT.html#REFRN30210" target="_blank">V$ROLLSTAT</a></code> 
                                 </p>
                              </td>
                              <td align="left" valign="top" width="65%" headers="d168466e2591 d168466e2564 ">
                                 <p>For automatic undo management mode, information reflects behavior of the undo segments in the undo tablespace</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="35%" id="d168466e2602" headers="d168466e2561 ">
                                 <p><code class="codeph"><a href="../refrn/V-TRANSACTION.html#REFRN30291" target="_blank">V$TRANSACTION</a></code> 
                                 </p>
                              </td>
                              <td align="left" valign="top" width="65%" headers="d168466e2602 d168466e2564 ">
                                 <p>Contains undo segment information</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="35%" id="d168466e2613" headers="d168466e2561 ">
                                 <p><code class="codeph"><a href="../refrn/DBA_UNDO_EXTENTS.html#REFRN23299" target="_blank">DBA_UNDO_EXTENTS</a></code> 
                                 </p>
                              </td>
                              <td align="left" valign="top" width="65%" headers="d168466e2613 d168466e2564 ">
                                 <p>Shows the status and size of each extent in the undo tablespace.</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="35%" id="d168466e2624" headers="d168466e2561 ">
                                 <p><code class="codeph"><a href="../refrn/DBA_HIST_UNDOSTAT.html#REFRN23460" target="_blank">DBA_HIST_UNDOSTAT</a></code></p>
                              </td>
                              <td align="left" valign="top" width="65%" headers="d168466e2624 d168466e2564 ">
                                 <p>Contains statistical snapshots of <code class="codeph">V$UNDOSTAT</code> information.
                                 </p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p>The <code class="codeph">V$UNDOSTAT</code> view is useful for monitoring the effects of transaction execution on undo space in the current instance. Statistics are available for undo space consumption, transaction concurrency, the tuning of undo retention, and the length and SQL ID of long-running queries in the instance. 
                     </p>
                     <p>Each row in the view contains statistics collected in the instance for a ten-minute interval. The rows are in descending order by the <code class="codeph">BEGIN_TIME</code> column value. Each row belongs to the time interval marked by (<code class="codeph">BEGIN_TIME</code>, <code class="codeph">END_TIME</code>). Each column represents the data collected for the particular statistic in that time interval. The first row of the view contains statistics for the (partial) current time period. The view contains a total of 576 rows, spanning a 4 day cycle.
                     </p>
                     <p>The following example shows the results of a query on the <code class="codeph">V$UNDOSTAT</code> view. 
                     </p><pre class="oac_no_warn" dir="ltr">  SELECT TO_CHAR(BEGIN_TIME, 'MM/DD/YYYY HH24:MI:SS') BEGIN_TIME,
         TO_CHAR(END_TIME, 'MM/DD/YYYY HH24:MI:SS') END_TIME,
         UNDOTSN, UNDOBLKS, TXNCOUNT, MAXCONCURRENCY AS "MAXCON"
         FROM v$UNDOSTAT WHERE rownum &lt;= 144;
  
  BEGIN_TIME          END_TIME               UNDOTSN   UNDOBLKS   TXNCOUNT     MAXCON
  ------------------- ------------------- ---------- ---------- ---------- ----------
  10/28/2004 14:25:12 10/28/2004 14:32:17          8         74   12071108          3
  10/28/2004 14:15:12 10/28/2004 14:25:12          8         49   12070698          2
  10/28/2004 14:05:12 10/28/2004 14:15:12          8        125   12070220          1
  10/28/2004 13:55:12 10/28/2004 14:05:12          8         99   12066511          3
  ...
  10/27/2004 14:45:12 10/27/2004 14:55:12          8         15   11831676          1
  10/27/2004 14:35:12 10/27/2004 14:45:12          8        154   11831165          2
 
  144 rows selected.
</pre><p>The preceding example shows how undo space is consumed in the system for the previous 24 hours from the time 14:35:12 on 10/27/2004.</p>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="managing-undo.html#GUID-2C865CF9-A8B5-4BF1-A451-E8C08D3611F0" title="For a default installation, Oracle Database automatically manages undo. There is typically no need for DBA intervention. However, if your installation uses Oracle Flashback operations, you may need to perform some undo management tasks to ensure the success of these operations.">Managing Undo</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
         </div>
      </article>
   </body>
</html>