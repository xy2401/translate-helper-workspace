<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="Use this information about common issues and resolutions to maintain your Oracle Data Guard environment."></meta>
      <meta name="description" content="Use this information about common issues and resolutions to maintain your Oracle Data Guard environment."></meta>
      <title>Oracle Data Guard故障排除</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Broker "></meta>
      <meta property="og:description" content="Use this information about common issues and resolutions to maintain your Oracle Data Guard environment."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Broker"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="data-guard-broker.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-03-29T04:14:25-07:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="1999, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96245-02"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="oracle-data-guard-broker-properties.html" title="Previous" type="text/html"></link>
      <link rel="next" href="upgrading-downgrading-in-data-guard-broker-configuration.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Data Guard Broker"></meta>
    <meta name="dcterms.isVersionOf" content="DGBKR"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="oracle-data-guard-broker-properties.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="upgrading-downgrading-in-data-guard-broker-configuration.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">经纪人</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Oracle Data Guard故障排除</li>
            </ol>
            <a id="GUID-CF46FC94-2F5B-40AA-89A6-8B8F2B124807" name="GUID-CF46FC94-2F5B-40AA-89A6-8B8F2B124807"></a><a id="DGBKR1020"></a>
            
            <h2 id="DGBKR-GUID-CF46FC94-2F5B-40AA-89A6-8B8F2B124807" class="sect2"><span class="enumeration_chapter">9</span> Oracle Data Guard故障排除</h2>
         </header>
         <div class="ind">
            <div>
               <p>使用有关常见问题和解决方案的此信息来维护Oracle Data Guard环境。</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="troubleshooting-oracle-data-guard-broker.html#GUID-A7D1301B-635F-46C6-9E33-FDA2093B8ABA" title="Oracle Data Guard代理以多种形式提供有关其活动的信息。">诊断信息的来源</a></p>
                  </li>
                  <li>
                     <p><a href="troubleshooting-oracle-data-guard-broker.html#GUID-0AED2023-2A96-4B7B-96A2-CE0942AC0144" title="这些主题描述了使用Oracle Data Guard代理时的一般问题和解决方案。">一般问题和解决方案</a></p>
                  </li>
                  <li>
                     <p><a href="troubleshooting-oracle-data-guard-broker.html#GUID-E417A951-84C5-4693-9136-8480FB8B1876" title="如果由于配置问题导致切换失败，则代理会报告在警报日志文件或代理日志文件中遇到的任何问题。">切换操作期间的问题疑难解答</a></p>
                  </li>
                  <li>
                     <p><a href="troubleshooting-oracle-data-guard-broker.html#GUID-0BA77759-4B36-42FA-BEE1-BE132ED88ACE" title="虽然故障转移操作可能会失败，但不太可能。如果确实发生错误，则可以遵循一些指导原则来解决问题，然后重试代理故障转移。">故障转移操作期间的问题疑难解答</a></p>
                  </li>
                  <li>
                     <p><a href="troubleshooting-oracle-data-guard-broker.html#GUID-C6AAB2E3-1714-4AFB-AC7B-BEA4B43F19C9" title="观察者持续监视快速启动故障转移环境，以确保主数据库可用。">解决观察者问题</a></p>
                  </li>
               </ul>
            </div><a id="DGBKR1025"></a><div class="props_rev_3"><a id="GUID-A7D1301B-635F-46C6-9E33-FDA2093B8ABA" name="GUID-A7D1301B-635F-46C6-9E33-FDA2093B8ABA"></a><h3 id="DGBKR-GUID-A7D1301B-635F-46C6-9E33-FDA2093B8ABA" class="sect3"><span class="enumeration_section">9.1</span>诊断信息的来源</h3>
               <div>
                  <p>Oracle Data Guard代理以多种形式提供有关其活动的信息。</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>数据库状态信息（参见<a href="managing-oracle-data-guard-broker-configuration-members.html#GUID-85D20060-248B-42A1-B78D-15C23AAA2F59" title="通常，代理通过验证实际数据库状态和设置是否与代理配置文件中描述的相匹配来检查数据库的运行状况。">数据库状态</a> ）</p>
                     </li>
                     <li>
                        <p>Oracle警报日志文件</p>
                        <p>代理在代理配置中为每个数据库的每个实例记录警报日志文件中的关键信息。在对Oracle Data Guard进行故障排除时，可以检查警报日志文件以获取此类信息。</p>
                     </li>
                     <li>
                        <p>Oracle Data Guard“代理日志文件”<a id="d77355e118" class="indexterm-anchor"></a><a id="d77355e122" class="indexterm-anchor"></a><a id="d77355e126" class="indexterm-anchor"></a></p>
                        <p>对于代理配置中每个数据库的每个实例，代理DMON进程会在代理日志文件中记录重要的行为和状态信息，这对诊断Oracle Data Guard故障非常有用。<code class="codeph">TraceLevel</code>配置属性（请参阅<a href="oracle-data-guard-broker-properties.html#GUID-30441264-7892-48EC-96B0-A63D70CF46F8" title="TraceLevel配置属性用于控制代理为配置中的每个成员执行的跟踪量。">TraceLevel</a> ）用于指定代理日志文件中报告的诊断信息的级别。
                        </p>
                        <p>代理日志文件在与警报日志相同的目录中创建，名为<code class="codeph">drc&lt;$ORACLE_SID&gt;.log</code> 。
                        </p>
                        <p></p>
                     </li>
                  </ul>
               </div>
            </div><a id="DGBKR1030"></a><div class="props_rev_3"><a id="GUID-0AED2023-2A96-4B7B-96A2-CE0942AC0144" name="GUID-0AED2023-2A96-4B7B-96A2-CE0942AC0144"></a><h3 id="DGBKR-GUID-0AED2023-2A96-4B7B-96A2-CE0942AC0144" class="sect3"><span class="enumeration_section">9.2</span>一般问题和解决方案</h3>
               <div>
                  <p>这些主题描述了使用Oracle Data Guard代理时的一般问题和解决方案。</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="troubleshooting-oracle-data-guard-broker.html#GUID-17E8BAEE-3D30-4A49-9869-C3D13180C709" title="向代理发出了请求，但您已连接的数据库实例不再是代理配置的一部分。">ORA-16596：数据库不是Oracle Data Guard代理配置的一部分</a></p>
                     </li>
                     <li>
                        <p><a href="troubleshooting-oracle-data-guard-broker.html#GUID-203CF4DA-A3D3-4BB3-A840-64D61CE2862B" title="通过查看Cloud Control中的“日志文件详细信息”页面，您已确定日志文件正在主数据库上累积，并且未归档到代理配置中的某些备用数据库。">主服务器上的重做累积不会发送到某些备用数据库</a></p>
                     </li>
                     <li>
                        <p><a href="troubleshooting-oracle-data-guard-broker.html#GUID-87B880E0-EA12-4C6A-8640-0EF39EF0C378" title="通过在Cloud Control中查看“性能”页面或“日志文件详细信息”页面，您已确定备用数据库累积了太多日志文件而未应用它们。">许多日志文件在备用数据库上接收但未应用</a></p>
                     </li>
                     <li>
                        <p><a href="troubleshooting-oracle-data-guard-broker.html#GUID-3C04CB40-B5E3-4952-BD2D-C953CE1FCC57" title="如果代理请求未在正常超时参数内完成，请尝试以下操作来解决问题。">请求超时或云控制性能缓慢</a></p>
                     </li>
                     <li>
                        <p><a href="troubleshooting-oracle-data-guard-broker.html#GUID-AE89C1C3-F896-4526-A0EA-372301DAF5C4" title="如果主数据库闪回，则配置中的备用数据库也必须闪回或重新创建，以便成为切换或故障转移的可行目标。">主数据库被闪回</a></p>
                     </li>
                     <li>
                        <p><a href="troubleshooting-oracle-data-guard-broker.html#GUID-AC5641FD-20E9-411C-A9D2-5F2EA384325E" title="如果DGMGRL CLI在代理操作后无法自动启动实例（例如，切换，恢复或转换为物理备用），则可能会生成ORA-12514错误。">备用因服务未知而无法自动启动（ORA-12514）</a></p>
                     </li>
                  </ul>
               </div><a id="DGBKR3614"></a><a id="DGBKR1035"></a><div class="props_rev_3"><a id="GUID-17E8BAEE-3D30-4A49-9869-C3D13180C709" name="GUID-17E8BAEE-3D30-4A49-9869-C3D13180C709"></a><h4 id="DGBKR-GUID-17E8BAEE-3D30-4A49-9869-C3D13180C709" class="sect4"><span class="enumeration_section">9.2.1</span> ORA-16596：数据库不是Oracle Data Guard代理配置的一部分</h4>
                  <div>
                     <p>向代理发出了请求，但您已连接的数据库实例不再是代理配置的一部分。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-17E8BAEE-3D30-4A49-9869-C3D13180C709__GUID-5B92BDE5-F216-4AA2-BC42-5562133F76A0">解</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>通过您知道属于代理配置的另一个数据库重新连接到配置。确认代理配置中存在一个数据库，该数据库的名称与返回ORA-16596错误的数据库的<code class="codeph">db_unique_name</code>值相匹配。
                        </p>
                        <p>如果您尝试启用配置，但其中一个数据库的代理配置文件被意外删除或过时，也会发生此问题。在这种情况下，从代理配置中删除数据库，手动删除该备用数据库的配置文件（而不是主数据库），然后再次尝试启用配置。启用配置后，您可以使用Cloud Control Add Standby Database向导并选择<span>Add existing standby database</span>选项，也可以使用DGMGRL命令行界面并发出<code class="codeph">ADD DATABASE</code>命令。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="DGBKR3615"></a><a id="DGBKR1040"></a><div class="props_rev_3"><a id="GUID-203CF4DA-A3D3-4BB3-A840-64D61CE2862B" name="GUID-203CF4DA-A3D3-4BB3-A840-64D61CE2862B"></a><h4 id="DGBKR-GUID-203CF4DA-A3D3-4BB3-A840-64D61CE2862B" class="sect4"><span class="enumeration_section">9.2.2</span>主服务器上的重做累积不会发送到某些备用数据库</h4>
                  <div>
                     <p>通过查看Cloud Control中的“日志文件详细信息”页面，您已确定日志文件正在主数据库上累积，并且未归档到代理配置中的某些备用数据库。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-203CF4DA-A3D3-4BB3-A840-64D61CE2862B__GUID-6010B37C-DE01-4E9F-9A5E-7BFDAAADE0DC">解</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>要缩小问题范围，请执行以下操作：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>验证主数据库的状态是否处于<code class="codeph">TRANSPORT-ON</code>状态（不是<code class="codeph">TRANSPORT-OFF</code> ）。
                              </p>
                           </li>
                           <li>
                              <p>验证有问题的备用数据库的<code class="codeph">LogShipping</code>数据库属性的值是否为<code class="codeph">ON</code> 。</p>
                           </li>
                           <li>
                              <p>使用<code class="codeph">LogXptStatus</code>属性检查主数据库上的重做传输服务的状态。如果重做传输服务有错误，则使用错误消息确定进一步的检查和解决操作。例如：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>如果错误指示备用数据库不可用，则需要重新启动备用数据库。</p>
                                 </li>
                                 <li>
                                    <p>如果错误指示没有侦听器，则需要重新启动侦听器。</p>
                                 </li>
                                 <li>
                                    <p>如果错误指示备用数据库没有本地目标，则需要设置备用位置以存储主数据库中的归档重做日志文件。</p>
                                 </li>
                              </ul>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="DGBKR3616"></a><a id="DGBKR3617"></a><a id="DGBKR3618"></a><a id="DGBKR1045"></a><div class="props_rev_3"><a id="GUID-87B880E0-EA12-4C6A-8640-0EF39EF0C378" name="GUID-87B880E0-EA12-4C6A-8640-0EF39EF0C378"></a><h4 id="DGBKR-GUID-87B880E0-EA12-4C6A-8640-0EF39EF0C378" class="sect4"><span class="enumeration_section">9.2.3</span>许多日志文件在备用数据库上接收但未应用</h4>
                  <div>
                     <p>通过在Cloud Control中查看“性能”页面或“日志文件详细信息”页面，您已确定备用数据库累积了太多日志文件而未应用它们。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-87B880E0-EA12-4C6A-8640-0EF39EF0C378__GUID-8D186CAA-8B44-4C89-8B57-BE8245913454">解</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>归档重做日志文件可能未应用于备用数据库的原因有很多。调查日志文件正在构建的原因并排除有效原因。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-87B880E0-EA12-4C6A-8640-0EF39EF0C378__GUID-20C40827-2240-4BB4-9BCF-D86EDF514F75">如果备用数据库的当前状态不正常：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p>确定日志应用服务是否可能意外停止。有关更多帮助，请参阅ORA-16766（对于物理备用数据库）或ORA-16768（对于逻辑备用数据库）错误说明和解决方案声明。</p>
                           </li>
                           <li>
                              <p>如果这是逻辑备用数据库，请检查是否发生了失败的事务。</p>
                           </li>
                           <li>
                              <p>如果要在调查问题时禁止显示错误，可以暂时禁用数据库的代理管理。</p>
                              <div class="infoboxnotealso" id="GUID-87B880E0-EA12-4C6A-8640-0EF39EF0C378__GUID-800585DC-4D65-499D-A9D3-2BFD697BB884">
                                 <p class="notep1">也可以看看：</p>
                                 <p>有关使用DGMGRL命令行界面禁用数据库的其他信息，请参阅<a href="oracle-data-guard-broker-commands.html#GUID-E7889124-C414-466F-9FBB-B8F035881F89" title="使用命令参考了解如何使用Data Guard代理命令行界面（DGMGRL）来管理代理配置。">Oracle Data Guard命令行界面参考</a></p>
                              </div>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-87B880E0-EA12-4C6A-8640-0EF39EF0C378__GUID-531777D2-6003-4B67-9378-57694032AC55">如果备用数据库的当前状态是正常的：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p>验证备用数据库的状态是否为<code class="codeph">APPLY-ON</code> （不处于<code class="codeph">APPLY-OFF</code>状态）。
                              </p>
                           </li>
                           <li>
                              <p>验证主数据库的状态是<code class="codeph">TRANSPORT-ON</code> （不处于<code class="codeph">TRANSPORT-OFF</code>状态）。
                              </p>
                              <div class="infoboxnotealso" id="GUID-87B880E0-EA12-4C6A-8640-0EF39EF0C378__GUID-05F262BD-68EB-4EB0-8674-53F3E9B72096">
                                 <p class="notep1">也可以看看：</p>
                                 <p>有关<code class="codeph">LogShipping</code>数据库属性的其他信息，请<code class="codeph">LogShipping</code> <a href="oracle-data-guard-broker-properties.html#GUID-1966A317-DD75-4385-8A64-ADEC75662F7E" title="使用Oracle Data Guard代理属性来管理实例或整个配置。">Oracle Data Guard Broker属性</a></p>
                              </div>
                           </li>
                           <li>
                              <p>检查日志文件是否正在建立，因为<code class="codeph">DelayMins</code>属性的值设置得太大。（日志应用服务将延迟在备用数据库上应用已归档的重做日志文件达到指定的分钟数。）
                              </p>
                              <div class="infoboxnotealso" id="GUID-87B880E0-EA12-4C6A-8640-0EF39EF0C378__GUID-A2496017-567A-4479-954A-81E3DC973249">
                                 <p class="notep1">也可以看看：</p>
                                 <p>有关<code class="codeph">DelayMins</code>数据库属性的其他信息，请<code class="codeph">DelayMins</code> <a href="oracle-data-guard-broker-properties.html#GUID-1966A317-DD75-4385-8A64-ADEC75662F7E" title="使用Oracle Data Guard代理属性来管理实例或整个配置。">Oracle Data Guard Broker属性</a></p>
                              </div>
                           </li>
                           <li>
                              <p>如果您看不到任何错误，请将存档速率与Cloud Control中“性能”页面上的应用率进行比较，以查看应用率是否低于存档速率。</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="DGBKR3443"></a><div class="props_rev_3"><a id="GUID-3C04CB40-B5E3-4952-BD2D-C953CE1FCC57" name="GUID-3C04CB40-B5E3-4952-BD2D-C953CE1FCC57"></a><h4 id="DGBKR-GUID-3C04CB40-B5E3-4952-BD2D-C953CE1FCC57" class="sect4"><span class="enumeration_section">9.2.4</span>请求超时或云控制性能缓慢</h4>
                  <div>
                     <p>如果代理请求未在正常超时参数内完成，请尝试以下操作来解决问题。</p>
                     <div class="section">
                        <ol>
                           <li>
                              <p>验证网络是否正常运行。</p>
                           </li>
                           <li>
                              <p>尝试ping配置中的所有节点。</p>
                           </li>
                           <li>
                              <p>尝试重新连接另一个数据库以重试该操作。</p>
                           </li>
                           <li>
                              <p>运行<code class="codeph">VERIFY</code>命令以确定代理无法处理请求的数据库。
                              </p>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="DGBKR1050"></a><div class="props_rev_3"><a id="GUID-AE89C1C3-F896-4526-A0EA-372301DAF5C4" name="GUID-AE89C1C3-F896-4526-A0EA-372301DAF5C4"></a><h4 id="DGBKR-GUID-AE89C1C3-F896-4526-A0EA-372301DAF5C4" class="sect4"><span class="enumeration_section">9.2.5</span>主数据库被闪回</h4>
                  <div>
                     <p>如果主数据库闪回，则配置中的备用数据库也必须闪回或重新创建，以便成为切换或故障转移的可行目标。</p>
                     <div class="section">
                        <p>如果主数据库已闪回，则代理将报告备用数据库的错误。</p>
                        <p>有关还原代理禁用的备用数据库的<a href="using-data-guard-broker-to-manage-switchovers-failovers.html#GUID-D1C0709A-FBF0-4635-95A4-385506A5EC2D" title="To restore your original disaster-recovery solution after switchover to a logical standby database or after failover to any standby database, you may need to perform additional steps.">可用性的</a>详细信息，请参阅<a href="using-data-guard-broker-to-manage-switchovers-failovers.html#GUID-D1C0709A-FBF0-4635-95A4-385506A5EC2D" title="要在切换到逻辑备用数据库后或故障转移到任何备用数据库后还原原始灾难恢复解决方案，可能需要执行其他步骤。">角色更改后重新启用已禁用的数据库</a> 。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="DGBKR3846"></a><div class="props_rev_3"><a id="GUID-AC5641FD-20E9-411C-A9D2-5F2EA384325E" name="GUID-AC5641FD-20E9-411C-A9D2-5F2EA384325E"></a><h4 id="DGBKR-GUID-AC5641FD-20E9-411C-A9D2-5F2EA384325E" class="sect4"><span class="enumeration_section">9.2.6</span>备用因服务未知而无法自动启动（ORA-12514）</h4>
                  <div>
                     <p>如果DGMGRL CLI在代理操作后无法自动启动实例（例如，切换，恢复或转换为物理备用），则可能会生成<code class="codeph">ORA-12514</code>错误。
                     </p>
                     <div class="section">
                        <p>完整错误文本是<code class="codeph">ORA-12514: TNS:listener does not currently know of service requested in connect descriptor</code> 。如果收到此错误，并且Oracle Clusterware不管理您的数据库，则必须手动启动实例以完成或继续代理操作。
                        </p>
                        <div class="infoboxnote" id="GUID-AC5641FD-20E9-411C-A9D2-5F2EA384325E__GUID-90C41398-98C4-4483-A2FC-74EA12FA7524">
                           <p class="notep1">注意：</p>
                           <p>本节中的故障排除信息仅适用于不由Oracle Clusterware管理的数据库。</p>
                        </div>
                        <p>您可以在完成以下步骤之前或之后重新启动实例：</p>
                        <ol>
                           <li>
                              <p>发出以下DGMGRL CLI命令，以检查DGMGRL CLI无法重新启动的实例的<code class="codeph">StaticConnectIdentifer</code>配置属性的值。（您必须连接到另一个正在运行的实例才能发出此命令）：</p><pre class="pre codeblock"><code>SHOW DATABASE <span class="italic">db_unique_name</span> StaticConnectIdentifier;</code></pre></li>
                           <li>
                              <p>应使用属性值中指定的侦听器注册<code class="codeph">StaticConnectIdentifer</code>实例属性值中指定的静态服务名称。静态服务名称的默认值具有以下形式：</p><pre class="oac_no_warn" dir="ltr"><span class="italic">db_unique_name</span> _DGMGRL。 <span class="italic">DB_DOMAIN</span>
</pre><p>有关使用代理的此信息和其他先决<a href="oracle-data-guard-broker-installation-requirements.html#GUID-BFDA8675-DA97-4910-B3FF-5DD5CFF5CC6D" title="These are the conditions that must be met before you can use the broker.">条件</a>的详细信息，请参阅<a href="oracle-data-guard-broker-installation-requirements.html#GUID-BFDA8675-DA97-4910-B3FF-5DD5CFF5CC6D" title="这些是您在使用代理之前必须满足的条件。">先决条件</a> 。
                              </p>
                           </li>
                           <li>
                              <p>使用监听器控制实用程序的status命令确认静态服务名称是使用<code class="codeph">StaticConnectIdentifer</code>配置属性值中指定的侦听器注册的。如果静态服务名称已正确注册到侦听器，则它将包含在由以下命令生成的输出中：</p><pre class="oac_no_warn" dir="ltr">lsnrctl状态</pre></li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="DGBKR1060"></a><div class="props_rev_3"><a id="GUID-E417A951-84C5-4693-9136-8480FB8B1876" name="GUID-E417A951-84C5-4693-9136-8480FB8B1876"></a><h3 id="DGBKR-GUID-E417A951-84C5-4693-9136-8480FB8B1876" class="sect3"><span class="enumeration_section">9.3</span>切换操作过程中的问题排除</h3>
               <div>
                  <p>如果由于配置问题导致切换失败，则代理会报告在警报日志文件或代理日志文件中遇到的任何问题。</p>
                  <p>有关日志文件的详细信息，请参阅<a href="troubleshooting-oracle-data-guard-broker.html#GUID-A7D1301B-635F-46C6-9E33-FDA2093B8ABA" title="Oracle Data Guard代理以多种形式提供有关其活动的信息。">诊断信息的来源</a> 。如果可以更正报告的问题，则可以重试切换操作，通常会成功。如果报告的问题无法纠正或者即使在更正报告的问题后切换操作仍然失败，则可以选择另一个数据库进行切换，或者将配置恢复到切换前的状态，然后重试切换。
                  </p>
                  <p>如果启用了快速启动故障转移，则代理不允许切换到除目标备用数据库之外的任何备用数据库。此外，仅当目标备用数据库上的<code class="codeph">V$DATABASE</code>视图中的<code class="codeph">FS_FAILOVER_STATUS</code>列的值为<code class="codeph">READY</code>或<code class="codeph">SUSPENDED</code>时，才允许切换到目标备用数据库。</p>
                  <div class="infoboxnotealso" id="GUID-E417A951-84C5-4693-9136-8480FB8B1876__GUID-BFC682AD-0276-4755-A3DC-18E8FBED7899">
                     <p class="notep1">也可以看看：</p>
                     <p><a href="using-data-guard-broker-to-manage-switchovers-failovers.html#GUID-824C3FEF-9D1D-4AA7-9C7A-DBDBADC77F47" title="启用快速启动故障转移并启动最多三个观察者后，将指定一个观察者作为主观察者，持续监视环境以确保主数据库可用。">启用快速启动故障转移并且观察器正在运行时</a></p>
                  </div>
               </div>
            </div><a id="DGBKR1055"></a><div class="props_rev_3"><a id="GUID-0BA77759-4B36-42FA-BEE1-BE132ED88ACE" name="GUID-0BA77759-4B36-42FA-BEE1-BE132ED88ACE"></a><h3 id="DGBKR-GUID-0BA77759-4B36-42FA-BEE1-BE132ED88ACE" class="sect3"><span class="enumeration_section">9.4</span>故障转移操作期间的故障排除问题</h3>
               <div>
                  <p>虽然故障转移操作可能会失败，但不太可能。如果确实发生错误，则可以遵循一些指导原则来解决问题，然后重试代理故障转移。</p>
               </div><a id="DGBKR3452"></a><div class="props_rev_3"><a id="GUID-17CB06EF-2B0E-41F7-9D08-7759987FFB4E" name="GUID-17CB06EF-2B0E-41F7-9D08-7759987FFB4E"></a><h4 id="DGBKR-GUID-17CB06EF-2B0E-41F7-9D08-7759987FFB4E" class="sect4"><span class="enumeration_section">9.4.1</span>故障转移到物理备用数据库失败</h4>
                  <div>
                     <p>这些步骤描述了如何从失败的代理故障转移恢复到物理备用数据库。</p>
                  </div><a id="DGBKR3453"></a><div class="props_rev_3"><a id="GUID-5FB1AC6D-D817-4064-BD39-D9F7B965452A" name="GUID-5FB1AC6D-D817-4064-BD39-D9F7B965452A"></a><h5 id="DGBKR-GUID-5FB1AC6D-D817-4064-BD39-D9F7B965452A" class="sect5"><span class="enumeration_section">9.4.1.1</span>失败的代理完成物理故障转移</h5>
                     <div>
                        <p>检查目标备用数据库上的警报日志文件和代理日志文件（drc * .log），以确定故障原因并更正问题。</p>
                        <div class="section">
                           <p>如果可以更正报告的问题，请重试故障转移操作。如果无法更正报告的问题，或者在报告的问题得到纠正后故障转移操作再次失败，请执行以下步骤：</p>
                           <ol>
                              <li>
                                 <p>连接到目标备用数据库并使用<code class="codeph">FORCE</code>选项禁用快速启动故障转移（如果已启用）。
                                 </p>
                              </li>
                              <li>
                                 <p>然后你可以：</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p>连接到另一个物理备用数据库并尝试代理完成故障转移。</p>
                                    </li>
                                    <li>
                                       <p>执行代理立即故障转移到目标物理备用数据库。</p>
                                    </li>
                                 </ul>
                              </li>
                              <li>
                                 <p>恢复原始主数据库和禁用状态为需要恢复的任何旁观者物理备用数据库（ <code class="codeph">ORA-16661</code> ）。
                                 </p>
                              </li>
                              <li>
                                 <p>如果在步骤1中禁用了快速启动故障转移，则重新启用它。</p>
                              </li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="DGBKR3454"></a><div class="props_rev_3"><a id="GUID-BEBFF44B-9000-44EE-9F1F-0640F49B183A" name="GUID-BEBFF44B-9000-44EE-9F1F-0640F49B183A"></a><h5 id="DGBKR-GUID-BEBFF44B-9000-44EE-9F1F-0640F49B183A" class="sect5"><span class="enumeration_section">9.4.1.2</span>失败的经纪人即时物理故障转移</h5>
                     <div>
                        <p>检查目标备用数据库上的警报日志文件和代理日志文件（drc * .log），以确定故障原因并更正问题。</p>
                        <div class="section">
                           <p>如果问题可以解决，请重试代理立即进行故障转移。否则，连接到另一个物理备用数据库并尝试完成代理或立即进行故障转移。</p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div><a id="DGBKR3455"></a><div class="props_rev_3"><a id="GUID-AF1C816F-A0E5-4F6C-9DA6-A489EB256388" name="GUID-AF1C816F-A0E5-4F6C-9DA6-A489EB256388"></a><h4 id="DGBKR-GUID-AF1C816F-A0E5-4F6C-9DA6-A489EB256388" class="sect4"><span class="enumeration_section">9.4.2</span>故障转移到逻辑备用数据库失败</h4>
                  <div>
                     <p>如果故障转移到逻辑备用数据库失败，则需要遵循以下步骤。</p>
                     <div class="section">
                        <ol>
                           <li>
                              <p>检查目标备用数据库上的警报日志文件和代理日志文件（drc * .log），以确定故障原因并更正问题。</p>
                           </li>
                           <li>
                              <p>连接到目标备用数据库并使用<code class="codeph">FORCE</code>选项禁用快速启动故障转移（如果已启用）。
                              </p>
                           </li>
                           <li>
                              <p>重试代理故障转移。</p>
                           </li>
                           <li>
                              <p>恢复旧的主数据库。将从新主数据库的副本重新创建所有旁观者备用数据库。</p>
                           </li>
                           <li>
                              <p>如果在步骤1中禁用了快速启动故障转移，则重新启用它。</p>
                           </li>
                        </ol>
                        <p>如果代理故障转移继续失败，则应在Oracle Data Guard配置中的所有数据库上停止代理（将<code class="codeph">DG_BROKER_START</code>初始化参数设置为<code class="codeph">FALSE</code> ）。从所有数据库中删除Oracle Data Guard代理配置文件。使用<a href="../sbydb/managing-oracle-data-guard-role-transitions.html#SBYDB00635" target="_blank"><span class="italic">Oracle Data Guard概念和管理中的</span></a>角色转换准则尝试手动故障转移。
                        </p>
                        <div class="infoboxnote" id="GUID-AF1C816F-A0E5-4F6C-9DA6-A489EB256388__GUID-0FC2BF42-091A-47FD-B95D-5FF4431D640A">
                           <p class="notep1">注意：</p>
                           <p>您可以使用DGMGRL <code class="codeph">ENABLE CONFIGURATION</code>和<code class="codeph">DISABLE CONFIGURATION</code>命令启用或禁用代理配置。您无法使用Cloud Control禁用配置。如果以前使用DGMGRL禁用了Cloud Control，则只能使用Cloud Control启用配置。</p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="DGBKR3456"></a><div class="props_rev_3"><a id="GUID-C6AAB2E3-1714-4AFB-AC7B-BEA4B43F19C9" name="GUID-C6AAB2E3-1714-4AFB-AC7B-BEA4B43F19C9"></a><h3 id="DGBKR-GUID-C6AAB2E3-1714-4AFB-AC7B-BEA4B43F19C9" class="sect3"><span class="enumeration_section">9.5</span>解决观察者问题</h3>
               <div>
                  <p>观察者持续监视快速启动故障转移环境，以确保主数据库可用。</p>
                  <p>安装和启动观察器是使用快速启动故障转移的一个组成部分。以下部分描述了对观察者进行故障排除的技术：</p>
                  <p></p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="troubleshooting-oracle-data-guard-broker.html#GUID-19CF1965-70A1-45B4-B398-3781937E4B0F" title="如果观察者主机崩溃，则不再观察代理配置，并且不再可以进行快速启动故障转移。">观察者停止的问题</a></p>
                     </li>
                     <li>
                        <p><a href="troubleshooting-oracle-data-guard-broker.html#GUID-5B9D54C8-C446-4678-A770-2851C41C9265" title="您可以使用START OBSERVER命令的LOGFILE IS选项来捕获观察者执行的活动。">捕获观察者日志文件中的观察者操作</a></p>
                     </li>
                  </ul>
               </div><a id="DGBKR3458"></a><div class="props_rev_3"><a id="GUID-19CF1965-70A1-45B4-B398-3781937E4B0F" name="GUID-19CF1965-70A1-45B4-B398-3781937E4B0F"></a><h4 id="DGBKR-GUID-19CF1965-70A1-45B4-B398-3781937E4B0F" class="sect4"><span class="enumeration_section">9.5.1</span>观察者已停止的问题</h4>
                  <div>
                     <p>如果观察者主机崩溃，则不再观察代理配置，并且不再可以进行快速启动故障转移。</p>
                     <div class="section">
                        <p>在这种情况下，如果无法及时修复原始主机，则可能必须将观察者移动到新主机。</p>
                        <ol>
                           <li>
                              <p>发出DGMGRL <code class="codeph">STOP OBSERVER</code>命令以切断原始观察者和代理配置之间的链接：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt;停止观察员;完成。
</pre></li>
                           <li>
                              <p>发出DGMGRL <code class="codeph">SHOW CONFIGURATION VERBOSE</code>命令以验证是否不再遵守配置：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt; SHOW CONFIGURATION VERBOSE;配置 -  DRSolution保护模式：MaxAvailability成员：North_Sales  - 主数据库警告：ORA-16819：快速启动故障切换观察器未启动South_Sales  - （*）物理备用数据库警告：ORA-16819：快速启动故障切换观察器未启动（*）快速启动故障转移目标属性：FastStartFailoverThreshold ='30'ReperationTimeout ='30'TraceLevel ='USER'FastStartFailoverLagLimit ='30'CommunicationTimeout ='180'ObserverReconnect ='0'FastStartFailoverAutoReinstate ='TRUE'FastStartFailoverPmyShutdown ='TRUE'BystandersFollowRoleChange =' ALL'ObserverOverride ='FALSE'ExternalDestination1 =''ExternalDestination2 =''PrimaryLostWriteAction ='CONTINUE'ConfigurationWideService ='North_Sales_CFG'快速启动故障转移：ENABLED阈值：30秒目标：South_Sales <span class="bold">观察者：observer.example.com</span>滞后限制：30秒（未使用）Shutdown Primary：TRUE自动恢复：TRUE Observer重新连接:(无）Observer Override：FALSE配置状态： 警告</pre></li>
                           <li>
                              <p>请注意，您无需发出DGMGRL <code class="codeph">SHOW CONFIGURATION</code>命令来验证观察者是否已实际停止。成功完成DGMGRL <code class="codeph">STOP OBSERVER</code>命令将允许新观察者与配置关联。
                              </p>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="DGBKR3459"></a><div class="props_rev_3"><a id="GUID-5B9D54C8-C446-4678-A770-2851C41C9265" name="GUID-5B9D54C8-C446-4678-A770-2851C41C9265"></a><h4 id="DGBKR-GUID-5B9D54C8-C446-4678-A770-2851C41C9265" class="sect4"><span class="enumeration_section">9.5.2</span>在观察者日志文件中捕获观察者动作</h4>
                  <div>
                     <p>您可以使用<code class="codeph">START OBSERVER</code>命令的<code class="codeph">LOGFILE IS</code>选项来捕获观察者执行的活动。
                     </p>
                     <div class="section">
                        <p>例如：</p><pre class="pre codeblock"><code>％dgmgrl START OBSERVER observer1在BACKGROUND LOGFILE中是observer.log CONNECT IDENTIFIER是North_Sales TRACE_LEVEL是支持;</code></pre><p>然后，所有观察者输出都记录在您发出<code class="codeph">DGMGRL</code>命令的当前工作目录中名为<code class="codeph">observer.log</code>的文件中。如果无法访问指定的日志文件，则将观察器输出发送到标准输出，就像未指定日志文件一样。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>