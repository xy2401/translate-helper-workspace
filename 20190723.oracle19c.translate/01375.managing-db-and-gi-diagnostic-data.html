<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="This section enables you to manage Oracle Database and Oracle Grid Infrastructure diagnostic data and disk usage snapshots."></meta>
      <meta name="description" content="This section enables you to manage Oracle Database and Oracle Grid Infrastructure diagnostic data and disk usage snapshots."></meta>
      <title>管理Oracle数据库和Oracle Grid Infrastructure诊断数据</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="User’s Guide"></meta>
      <meta property="og:description" content="This section enables you to manage Oracle Database and Oracle Grid Infrastructure diagnostic data and disk usage snapshots."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="User’s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="autonomous-health-framework-users-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-21T23:14:30-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2016, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96320-02"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="managing-and-configuring-tfa.html" title="Previous" type="text/html"></link>
      <link rel="next" href="troubleshoot-tfa.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Autonomous Health Framework User’s Guide"></meta>
    <meta name="dcterms.isVersionOf" content="ATNMS"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="managing-and-configuring-tfa.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="troubleshoot-tfa.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">用户指导</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="diagnose-troubleshoot-issues-errors.html" property="item" typeof="WebPage"><span property="name">收集诊断数据和分类，诊断和解决问题</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">管理Oracle数据库和Oracle Grid Infrastructure诊断数据</li>
            </ol>
            <a id="GUID-996745FA-5ADE-4CCF-B703-88B1C88B1A8B" name="GUID-996745FA-5ADE-4CCF-B703-88B1C88B1A8B"></a>
            
            <h2 id="ATNMS-GUID-996745FA-5ADE-4CCF-B703-88B1C88B1A8B" class="sect2"><span class="enumeration_chapter">20</span>管理Oracle数据库和Oracle Grid Infrastructure诊断数据</h2>
         </header>
         <div class="ind">
            <div>
               <p>本部分使您可以管理Oracle数据库和Oracle Grid Infrastructure诊断数据和磁盘使用情况快照。</p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="managing-db-and-gi-diagnostic-data.html#GUID-60273FDF-F318-4BB7-BD8F-C74D64163FA0">管理自动诊断存储库日志和跟踪文件</a><br>使用<code class="codeph">managelogs</code>命令管理自动诊断存储库日志和跟踪文件。
                  </li>
                  <li class="ulchildlink"><a href="managing-db-and-gi-diagnostic-data.html#GUID-99EB0F3B-574F-48E7-975C-C3F948697441">管理磁盘使用快照</a><br>使用<code class="codeph">tfactl</code>命令管理Oracle跟踪文件分析器磁盘使用情况快照。
                  </li>
                  <li class="ulchildlink"><a href="managing-db-and-gi-diagnostic-data.html#GUID-65D9412B-3BFB-46E7-81D5-F33115233869">清除Oracle数据库和Oracle Grid Infrastructure日志</a><br>使用这些<code class="codeph">tfactl</code>命令管理Oracle数据库和Oracle Grid Infrastructure日志的日志文件清除策略。
                  </li>
               </ul>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>父主题：</strong> <a href="diagnose-troubleshoot-issues-errors.html#GUID-DA02663E-305E-4DD2-9758-DCA883B54198" title="使用Autonomous Health Framework提供的工具来解决错误。">收集诊断数据和分类，诊断和解决问题</a></p>
                  </div>
               </div>
            </div>
            
            <div class="sect2"><a id="GUID-60273FDF-F318-4BB7-BD8F-C74D64163FA0" name="GUID-60273FDF-F318-4BB7-BD8F-C74D64163FA0"></a><h3 id="ATNMS-GUID-60273FDF-F318-4BB7-BD8F-C74D64163FA0" class="sect3"><span class="enumeration_section">20.1</span>管理自动诊断存储库日志和跟踪文件</h3>
               <div>
                  <p>使用<code class="codeph">managelogs</code>命令管理自动诊断存储库日志和跟踪文件。
                  </p>
                  <div class="section">
                     <p><code class="codeph">-purge</code>命令选项删除由Automatic Diagnostic Repository管理的文件。此命令清除诊断目标下“ <code class="codeph">ALERT</code> ”，“ <code class="codeph">INCIDENT</code> ”，“ <code class="codeph">TRACE</code> ”，“ <code class="codeph">CDUMP</code> ”，“ <code class="codeph">HM</code> ”，“ <code class="codeph">UTSCDMP</code> ”，“ <code class="codeph">LOG</code> ”中的文件。<code class="codeph">-purge</code>命令还提供有关文件系统空间更改的详细信息。
                     </p>
                     <p>如果诊断目标包含大量文件，则该命令将运行一段时间。检查从相应目录中删除正在进行的文件。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="p">
                     <p>要删除文件，您必须具有相应诊断目标的操作系统权限。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-60273FDF-F318-4BB7-BD8F-C74D64163FA0__GUID-79ABE9A8-7791-4285-A4CD-C53DA8CE5C6D">要管理自动诊断存储库日志和跟踪文件：</p>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>要限制清除，或仅将操作显示为超过特定时间的文件：</span><div>
                           <div class="p"><pre class="pre codeblock"><code>$ tfactl managelogs -older <span class="variable" translate="no">n</span> m | h | d过去'n'[d] ays或'n'[h]我们或'n'[m] inutes的文件</code></pre></div>
                           <div class="p">例如：<pre class="pre codeblock"><code>$ tfactl managelogs -purge -older 30d -dryrun $ tfactl managelogs -purge -older 30d</code></pre></div>
                        </div>
                     </li>
                     <li class="stepexpand"><span>要估计删除了多少文件以及释放了多少空间，请使用<code class="codeph">–dryrun</code>选项：</span><div>
                           <div class="p">例如：<pre class="pre codeblock"><code>$ tfactl managelogs -purge -older 30d -dryrun</code></pre></div>
                        </div>
                     </li>
                     <li class="stepexpand"><span>要删除文件并清理磁盘空间：</span><div>
                           <div class="p">例如：<pre class="pre codeblock"><code>$ tfactl managelogs -purge -older 30d $ tfactl managelogs -purge -older 30d -gi $ tfactl managelogs -purge -older 30d -database</code></pre></div>
                        </div>
                     </li>
                     <li class="stepexpand"><span>要查看各个诊断目标的空间使用情况：</span><div>
                           <div class="p">例如：<pre class="pre codeblock"><code>$ tfactl managelogs -show usage $ tfactl managelogs -show usage -gi $ tfactl managelogs -show usage -database</code></pre></div>
                        </div>
                     </li>
                  </ol>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="running-diagnostic-collection-commands.html#GUID-07EFE012-6954-4C77-9B8E-E83CA8A7E80A" title="使用tfactl managelogs命令管理自动诊断存储库日志和跟踪文件。">tfactl managelogs</a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="managing-db-and-gi-diagnostic-data.html#GUID-996745FA-5ADE-4CCF-B703-88B1C88B1A8B" title="本部分使您可以管理Oracle数据库和Oracle Grid Infrastructure诊断数据和磁盘使用情况快照。">管理Oracle数据库和Oracle Grid Infrastructure诊断数据</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-99EB0F3B-574F-48E7-975C-C3F948697441" name="GUID-99EB0F3B-574F-48E7-975C-C3F948697441"></a><h3 id="ATNMS-GUID-99EB0F3B-574F-48E7-975C-C3F948697441" class="sect3"><span class="enumeration_section">20.2</span>管理磁盘使用快照</h3>
               <div>
                  <p>使用<code class="codeph">tfactl</code>命令管理Oracle跟踪文件分析器磁盘使用情况快照。
                  </p>
                  <div class="section">
                     <p>Oracle跟踪文件分析器自动监视磁盘使用情况，记录快照并将快照存储在<code class="codeph"><span class="variable" translate="no">tfa_install_dir</span> /tfa/repository/suptools/node/managelogs/usage_snapshot/</code></p>
                     <p>默认情况下，快照之间的时间间隔为60分钟。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-99EB0F3B-574F-48E7-975C-C3F948697441__GUID-D552DA08-D09D-4DAF-9DDC-1083495A984A">管理磁盘使用情况快照：</p>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>要更改快照的默认时间间隔：</span><div>
                           <div class="p"><pre class="pre codeblock"><code>$ tfactl set diskUsageMonInterval = <span class="variable" translate="no">minutes</span></code></pre></div>
                           <p>其中<code class="codeph"><span class="variable" translate="no">minutes</span></code>是快照之间的分钟数。
                           </p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>要打开或关闭磁盘使用情况监视器：</span><div>
                           <div class="p"><pre class="pre codeblock"><code>$ tfactl set diskUsageMon = ON | OFF</code></pre></div>
                        </div>
                     </li>
                  </ol>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="managing-db-and-gi-diagnostic-data.html#GUID-996745FA-5ADE-4CCF-B703-88B1C88B1A8B" title="本部分使您可以管理Oracle数据库和Oracle Grid Infrastructure诊断数据和磁盘使用情况快照。">管理Oracle数据库和Oracle Grid Infrastructure诊断数据</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-65D9412B-3BFB-46E7-81D5-F33115233869" name="GUID-65D9412B-3BFB-46E7-81D5-F33115233869"></a><h3 id="ATNMS-GUID-65D9412B-3BFB-46E7-81D5-F33115233869" class="sect3"><span class="enumeration_section">20.3</span>清除Oracle数据库和Oracle Grid Infrastructure日志</h3>
               <div>
                  <p>使用这些<code class="codeph">tfactl</code>命令管理Oracle数据库和Oracle Grid Infrastructure日志的日志文件清除策略。
                  </p>
                  <div class="section">
                     <p>默认情况下，在域服务群集（DSC）上启用自动清除，并在其他位置默认禁用。启用自动清除后，Oracle Trace File Analyzer每隔60分钟自动清除超过30天的日志。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-65D9412B-3BFB-46E7-81D5-F33115233869__GUID-A51C698A-11EF-4051-866C-403C46D28D61">要自动清除Oracle跟踪文件分析器日志：</p>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>要打开或关闭自动清除：</span><div>
                           <div class="p"><pre class="pre codeblock"><code>$ tfactl set manageLogsAutoPurge = ON | OFF</code></pre></div>
                        </div>
                     </li>
                     <li class="stepexpand"><span>要调整要清除的日志的年龄：</span><div>
                           <div class="p"><pre class="pre codeblock"><code>$ tfactl set manageLogsAutoPurgePolicyAge = <span class="variable" translate="no">n</span> d | h</code></pre></div>
                        </div>
                     </li>
                     <li class="stepexpand"><span>调整清除频率：</span><div>
                           <div class="p"><pre class="pre codeblock"><code>$ tfactl设置manageLogsAutoPurgeInterval = <span class="variable" translate="no">minutes</span></code></pre></div>
                        </div>
                     </li>
                  </ol>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="managing-db-and-gi-diagnostic-data.html#GUID-996745FA-5ADE-4CCF-B703-88B1C88B1A8B" title="本部分使您可以管理Oracle数据库和Oracle Grid Infrastructure诊断数据和磁盘使用情况快照。">管理Oracle数据库和Oracle Grid Infrastructure诊断数据</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
         </div>
      </article>
   </body>
</html>