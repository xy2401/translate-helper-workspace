<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="Backup and recovery is a crucial and important job for a DBA to protect business data."></meta>
      <meta name="description" content="Backup and recovery is a crucial and important job for a DBA to protect business data."></meta>
      <title>备份和恢复VLDB</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="VLDB and Partitioning Guide"></meta>
      <meta property="og:description" content="Backup and recovery is a crucial and important job for a DBA to protect business data."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="VLDB and Partitioning Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="vldb-and-partitioning-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-04-23T18:05:22-07:00"></meta>
      <meta name="dcterms.title" content="VLDB and Partitioning Guide"></meta>
      <meta name="dcterms.dateCopyrighted" content="2008, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96199-03"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="parallel-exec-tips.html" title="Previous" type="text/html"></link>
      <link rel="next" href="vldb-storage.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="VLDBG"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="parallel-exec-tips.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="vldb-storage.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">VLDB和分区指南</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">备份和恢复VLDB</li>
            </ol>
            <a id="GUID-8B6DB99C-5265-480B-B227-DBCFBCBD4D98" name="GUID-8B6DB99C-5265-480B-B227-DBCFBCBD4D98"></a><a id="VLDBG008"></a>
            
            <h2 id="VLDBG-GUID-8B6DB99C-5265-480B-B227-DBCFBCBD4D98" class="sect2"><span class="enumeration_chapter">9</span>备份和恢复VLDB</h2>
         </header>
         <div class="ind">
            <div>
               <p>备份和恢复是DBA保护业务数据的关键且重要的工作。</p>
               <p>随着数据存储每年变得越来越大，DBA不断面临着确保关键数据得到备份以及可以快速，轻松地恢复以满足业务需求的挑战。非常大的数据库是独特的，因为它们很大并且数据可能来自许多资源。OLTP和数据仓库系统具有一些独特的特征。通常，非常大的OLTP系统的可用性考虑因素与小型OLTP系统的考虑因素没有区别。假设允许的固定停机时间，大型OLTP系统比小型OLTP系统需要更多的硬件资源。</p>
               <p>本章针对超大型数据库提出了一种有效的备份和恢复策略，通过使用区分数据仓库和OLTP系统的一些特殊特性来减少支持备份和恢复所需的总体资源。</p>
               <p>本章包含以下部分：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="vldb-backup.html#GUID-836E38BE-FD44-42FC-AB7C-FD58108DC83C" title="数据仓库是一个旨在支持分析和决策的系统。">数据仓库</a></p>
                  </li>
                  <li>
                     <p><a href="vldb-backup.html#GUID-9FA8366F-9413-4239-9FF3-CB492686C8BA" title="通常，备份和恢复是指在保护数据库免受数据丢失和在任何类型的数据丢失后重建数据库所涉及的各种策略和过程。">Oracle备份和恢复</a></p>
                  </li>
                  <li>
                     <p><a href="vldb-backup.html#GUID-79223C42-48E1-4036-AD74-4856A24935D5" title="数据仓库恢复类似于OLTP系统。">数据仓库备份和恢复</a></p>
                  </li>
                  <li>
                     <p><a href="vldb-backup.html#GUID-E6542B38-2388-4152-AFBC-C1CA03837D93" title="设计备份和恢复策略可能是一项复杂且具有挑战性的任务。">数据仓库恢复方法</a></p>
                  </li>
               </ul>
            </div><a id="VLDBG1552"></a><div class="props_rev_3"><a id="GUID-836E38BE-FD44-42FC-AB7C-FD58108DC83C" name="GUID-836E38BE-FD44-42FC-AB7C-FD58108DC83C"></a><h3 id="VLDBG-GUID-836E38BE-FD44-42FC-AB7C-FD58108DC83C" class="sect3">数据仓库</h3>
               <div>
                  <p>数据仓库是一个旨在支持分析和决策的系统。</p>
                  <p>在典型的企业中，数百或数千个用户可能依赖数据仓库来提供信息，以帮助他们了解业务并做出更好的决策。因此，可用性是数据仓库的关键要求。本章讨论数据仓库可用性的一个关键方面：数据丢失后的数据恢复。</p>
                  <p>在详细了解备份和恢复技术之前，讨论备份和恢复数据仓库的具体技术非常重要。特别是，一个合理的问题可能是：数据仓库的备份和恢复策略是否应该像其他所有数据库系统一样？</p>
                  <p>DBA最初应该通过应用OLTP系统中使用的相同技术来处理数据仓库备份和恢复任务：DBA必须决定要保护哪些信息并在需要介质恢复时快速恢复，根据数据的重要性和数据确定数据的优先级。它改变的程度。但是，数据仓库通常会出现的问题是，对于100 GB OLTP系统而言，高效且经济高效的方法可能不适用于10 TB数据仓库。备份和恢复可能需要100倍的时间或需要100倍的存储空间。</p>
                  <div class="infoboxnotealso" id="GUID-836E38BE-FD44-42FC-AB7C-FD58108DC83C__GUID-DE3EC844-6FCC-4CB4-81D1-DB543B28F90C">
                     <p class="notep1">也可以看看：</p>
                     <p>有关数据仓库的更多信息，请<a href="../dwhsg/introduction-data-warehouse-concepts.html#DWHSG-GUID-452FBA23-6976-4590-AA41-1369647AD14D" target="_blank"><span><cite>参见“Oracle数据库数据仓库指南”</cite></span></a></p>
                  </div>
               </div><a id="VLDBG1553"></a><div class="props_rev_3"><a id="GUID-38705383-2C31-48BE-8EA5-ECAD0F479B89" name="GUID-38705383-2C31-48BE-8EA5-ECAD0F479B89"></a><h4 id="VLDBG-GUID-38705383-2C31-48BE-8EA5-ECAD0F479B89" class="sect4">数据仓库特征</h4>
                  <div>
                     <p>数据仓库和OLTP系统之间存在几个主要差异，这些差异会对备份和恢复产生重大影响。</p>
                     <p>这些差异是：</p>
                     <ol>
                        <li>
                           <p>数据仓库通常比OLTP系统大得多。超过10兆兆字节的数据仓库并不罕见，最大的数据仓库增长到数量级。因此，可伸缩性是数据仓库备份和恢复的一个特别重要的考虑因素。</p>
                        </li>
                        <li>
                           <p>数据仓库的可用性要求通常低于OLTP系统。虽然数据仓库对企业至关重要，但与在一天内恢复相比，在几小时内恢复多个TB的能力也会产生相当大的成本。有些组织可能会确定，如果发生故障需要恢复大部分数据仓库，他们可以容忍一天或更长时间的中断，如果他们可以节省备份硬件和存储的大量支出。</p>
                        </li>
                        <li>
                           <p>数据仓库通常通过称为ETL（提取，转换，加载）过程的受控进程进行更新，这与用户自行修改数据的OLTP系统不同。由于数据修改是在受控过程中完成的，因此数据仓库的更新通常是已知的，并且可以从重做日志以外的来源重现。</p>
                        </li>
                        <li>
                           <p>数据仓库包含历史信息，通常，数据仓库中较旧部分的旧数据是静态的。例如，数据仓库可以跟踪五年的历史销售数据。虽然最近一年的数据可能仍有待修改（由于退货，重述等），但过去四年的数据可能完全是静态的。静态数据的优点是不需要经常备份。</p>
                        </li>
                     </ol>
                     <p>在设计针对数据仓库优化的备份和恢复策略时，这四个特征是关键考虑因素。</p>
                  </div>
               </div>
            </div><a id="VLDBG1554"></a><div class="props_rev_3"><a id="GUID-9FA8366F-9413-4239-9FF3-CB492686C8BA" name="GUID-9FA8366F-9413-4239-9FF3-CB492686C8BA"></a><h3 id="VLDBG-GUID-9FA8366F-9413-4239-9FF3-CB492686C8BA" class="sect3">Oracle备份和恢复</h3>
               <div>
                  <p>通常，备份和恢复是指在保护数据库免受数据丢失和在任何类型的数据丢失后重建数据库所涉及的各种策略和过程。</p>
                  <p>备份是代表性的数据副本。此副本可以包括数据库的重要部分，例如控制文件，归档重做日志和数据文件。备份通过提供恢复原始数据的方法来保护数据免受应用程序错误的影响，并可防止意外数据丢失。</p>
                  <p>本节包含以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="vldb-backup.html#GUID-8B4CA295-6392-48C3-868E-0C5BD687FDCC" title="在开始认真考虑备份和恢复策略之前，必须确定与备份和恢复操作相关的物理数据结构。">用于恢复数据的物理数据库结构</a></p>
                     </li>
                     <li>
                        <p><a href="vldb-backup.html#GUID-E037DA35-38AD-42D2-8D6D-D66568333429" title="备份分为物理备份和逻辑备份。">备份类型</a></p>
                     </li>
                     <li>
                        <p><a href="vldb-backup.html#GUID-003FB14B-0FD7-4E45-A136-854803A2702B" title="Oracle数据库提供了多种工具来管理Oracle数据库的备份和恢复。">备份工具</a></p>
                     </li>
                  </ul>
               </div><a id="VLDBG1555"></a><div class="props_rev_3"><a id="GUID-8B4CA295-6392-48C3-868E-0C5BD687FDCC" name="GUID-8B4CA295-6392-48C3-868E-0C5BD687FDCC"></a><h4 id="VLDBG-GUID-8B4CA295-6392-48C3-868E-0C5BD687FDCC" class="sect4">用于恢复数据的物理数据库结构</h4>
                  <div>
                     <p>在开始认真考虑备份和恢复策略之前，必须确定与备份和恢复操作相关的物理数据结构。</p>
                     <p>这些组件包括构成Oracle数据存储数据的文件和其他结构，并保护数据存储免受可能的故障的影响。恢复Oracle数据库需要三个基本组件：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="vldb-backup.html#GUID-32A8CC6B-E800-4EC8-B1B9-A10638848BD0" title="Oracle数据库由一个或多个称为表空间的逻辑存储单元组成。Oracle数据库中的每个表空间都包含一个或多个称为数据文件的文件，这些文件是位于或附加到运行Oracle数据库的主机操作系统的物理文件。">数据文件</a></p>
                        </li>
                        <li>
                           <p><a href="vldb-backup.html#GUID-862076BF-4F81-44BC-BEB3-2180785888D4" title="重做日志记录对数据库的数据文件所做的所有更改。">重做日志</a></p>
                        </li>
                        <li>
                           <p><a href="vldb-backup.html#GUID-1624A713-7AC0-4647-96AE-48E67FCF5079" title="控制文件包含数据库物理结构及其状态的关键记录。">控制文件</a></p>
                        </li>
                     </ul>
                  </div><a id="VLDBG1556"></a><div class="props_rev_3"><a id="GUID-32A8CC6B-E800-4EC8-B1B9-A10638848BD0" name="GUID-32A8CC6B-E800-4EC8-B1B9-A10638848BD0"></a><h5 id="VLDBG-GUID-32A8CC6B-E800-4EC8-B1B9-A10638848BD0" class="sect5">数据文件</h5>
                     <div>
                        <p>Oracle数据库由一个或多个称为表空间的逻辑存储单元组成。Oracle数据库中的每个表空间都包含一个或多个称为数据文件的文件，这些文件是位于或附加到运行Oracle数据库的主机操作系统的物理文件。</p>
                        <p>数据库中的数据共同存储在构成数据库的每个表空间的数据文件中。最简单的Oracle数据库将有一个表空间，存储在一个数据文件中。数据库的数据文件副本是任何备份策略的关键部分。从VLDB备份和恢复的角度来看，数据文件的庞大规模是主要挑战。</p>
                     </div>
                  </div><a id="VLDBG1557"></a><div class="props_rev_3"><a id="GUID-862076BF-4F81-44BC-BEB3-2180785888D4" name="GUID-862076BF-4F81-44BC-BEB3-2180785888D4"></a><h5 id="VLDBG-GUID-862076BF-4F81-44BC-BEB3-2180785888D4" class="sect5">重做日志</h5>
                     <div>
                        <p>重做日志记录对数据库的数据文件所做的所有更改。</p>
                        <p>通过一组完整的重做日志和较旧的数据文件副本，Oracle可以重新应用重做日志中记录的更改，以便在备份时间和最后一个重做日志结束之间的任何时刻重新创建数据库。每次在Oracle数据库中更改数据时，在将更改应用于数据文件之前，首先将该更改记录在联机重做日志中。</p>
                        <p>Oracle数据库至少需要两个联机重做日志组。在每个组中，至少有一个联机重做日志成员，一个单独的重做日志文件，其中记录了更改。每隔一段时间，Oracle数据库就会通过联机重做日志组进行轮换，在当前联机重做日志中存储更改，而不使用的组可以复制到归档位置，在这些位置称为归档重做日志（或统称为归档重做日志）日志）。出于高可用性原因，生产系统应始终每组使用多个联机重做成员，最好是在不同的存储系统上。保留归档重做日志是备份策略的主要部分，因为它包含对数据文件的所有更新的记录。备份策略通常涉及将归档的重做日志复制到磁盘或磁带以进行长期存储。</p>
                     </div>
                  </div><a id="VLDBG1558"></a><div class="props_rev_3"><a id="GUID-1624A713-7AC0-4647-96AE-48E67FCF5079" name="GUID-1624A713-7AC0-4647-96AE-48E67FCF5079"></a><h5 id="VLDBG-GUID-1624A713-7AC0-4647-96AE-48E67FCF5079" class="sect5">控制文件</h5>
                     <div>
                        <p>控制文件包含数据库物理结构及其状态的关键记录。</p>
                        <p>存储在控制文件中的几种类型的信息与备份和恢复有关：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>从故障中恢复或执行介质恢复所需的数据库信息</p>
                           </li>
                           <li>
                              <p>数据库结构信息，例如数据文件详细信息</p>
                           </li>
                           <li>
                              <p>重做日志详细信息</p>
                           </li>
                           <li>
                              <p>存档的日志记录</p>
                           </li>
                           <li>
                              <p>过去RMAN备份的记录</p>
                           </li>
                        </ul>
                        <p>Oracle数据库数据文件恢复过程部分由控制文件中的状态信息引导，例如数据库检查点，当前联机重做日志文件和数据文件头检查点。丢失控制文件使得从数据丢失中恢复更加困难。应定期备份控制文件，以保留最新的数据库结构更改，并简化恢复。</p>
                     </div>
                  </div>
               </div><a id="VLDBG1559"></a><div class="props_rev_3"><a id="GUID-E037DA35-38AD-42D2-8D6D-D66568333429" name="GUID-E037DA35-38AD-42D2-8D6D-D66568333429"></a><h4 id="VLDBG-GUID-E037DA35-38AD-42D2-8D6D-D66568333429" class="sect4">备份类型</h4>
                  <div>
                     <p>备份分为物理备份和逻辑备份。</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><span class="bold">物理</span> <span class="bold">备份</span>是用于存储和恢复数据库的物理文件的备份，例如数据文件，控制文件和归档重做日志。最终，每个物理备份都是将数据库信息存储到其他某个位置的文件的副本，无论是在磁盘上还是在脱机存储上，如磁带。
                           </p>
                        </li>
                        <li>
                           <p><span class="bold">逻辑</span> <span class="bold">备份</span>包含使用Oracle Data Pump（导出/导入）实用程序从数据库中提取的逻辑数据（例如，表或存储过程）。数据存储在二进制文件中，可以导入Oracle数据库。
                           </p>
                        </li>
                     </ul>
                     <p>物理备份是任何备份和恢复策略的基础。在许多情况下，逻辑备份是物理备份的有用补充，但如果没有物理备份，则不足以防止数据丢失。</p>
                     <p>从备份重建全部或部分数据库的内容通常涉及两个阶段：从备份中检索数据文件的副本，并从备份（从存档和联机重做日志）开始重新应用对文件的更改，以实现数据库到期望的恢复时间点。从备份还原数据文件或控制文件是从磁带，磁盘或其他介质上的备份位置检索文件，并使其可供Oracle数据库使用。要恢复数据文件，将获取数据文件的已还原副本，并将数据库重做日志中记录的更改应用于该文件。要恢复整个数据库，请对其每个数据文件执行恢复。</p>
                  </div>
               </div><a id="VLDBG1560"></a><div class="props_rev_3"><a id="GUID-003FB14B-0FD7-4E45-A136-854803A2702B" name="GUID-003FB14B-0FD7-4E45-A136-854803A2702B"></a><h4 id="VLDBG-GUID-003FB14B-0FD7-4E45-A136-854803A2702B" class="sect4">备份工具</h4>
                  <div>
                     <p>Oracle数据库提供了多种工具来管理Oracle数据库的备份和恢复。</p>
                     <p>每个工具都可以选择几种基本的备份方法。方法包括：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="vldb-backup.html#GUID-69A6FC62-06CB-48BD-AAC6-F5F1BE00E504" title="Oracle Recovery Manager（RMAN）是一种命令行，是Oracle首选的有效备份和恢复Oracle数据库的方法。">Oracle Recovery Manager（RMAN）</a></p>
                           <p>RMAN通过维护有关所有备份和所需恢复相关文件的大量元数据记录，减少与备份策略相关的管理工作。在还原和恢复操作中，RMAN使用此信息来消除用户识别所需文件的需要。RMAN是高效的，支持文件多路复用和并行流，并在备份和恢复时验证物理和（可选）逻辑损坏的块。</p>
                           <p>可以使用<code class="codeph">V$BACKUP</code>视图生成备份活动报告。
                           </p>
                        </li>
                        <li>
                           <p><a href="vldb-backup.html#GUID-BEF89467-A14D-4B90-A6C6-37BDAABFE2F9" title="可以使用Oracle Data Pump（导出/导入）实用程序来补充物理备份，以对数据进行逻辑备份。">Oracle Data Pump</a></p>
                           <p>Oracle Data Pump提供Oracle数据库内容的高速，并行，批量数据和元数据移动。此实用程序通过将数据从Oracle数据库写入操作系统文件来进行逻辑备份。以后可以将此数据导入Oracle数据库。</p>
                        </li>
                        <li>
                           <p><a href="vldb-backup.html#GUID-E2A62C86-11FB-4B51-89F9-326228ABB228" title="如果您不想使用Recovery Manager，则可以使用操作系统命令（例如UNIX dd或tar命令）进行备份。">用户管理的备份</a></p>
                           <p>通过执行特定于您的操作系统的命令手动备份数据库。</p>
                        </li>
                     </ul>
                  </div><a id="VLDBG1561"></a><div class="props_rev_3"><a id="GUID-69A6FC62-06CB-48BD-AAC6-F5F1BE00E504" name="GUID-69A6FC62-06CB-48BD-AAC6-F5F1BE00E504"></a><h5 id="VLDBG-GUID-69A6FC62-06CB-48BD-AAC6-F5F1BE00E504" class="sect5">Oracle Recovery Manager（RMAN）</h5>
                     <div>
                        <p>Oracle Recovery Manager（RMAN）是一种命令行，是Oracle首选的有效备份和恢复Oracle数据库的方法。</p>
                        <p>RMAN旨在与服务器密切配合，在备份和恢复期间提供块级损坏检测。RMAN通过文件多路复用和备份集压缩优化备份期间的性能和空间消耗，并通过提供的媒体管理库（MML）API与领先的磁带和存储介质产品集成。</p>
                        <p>RMAN在备份或恢复之前和之后处理所有底层数据库过程，释放对操作系统和SQL * Plus脚本的依赖。它为跨不同主机操作系统的备份任务提供通用接口，并提供用户管理方法无法提供的功能，如数据文件和表空间级备份和恢复，备份和恢复数据流并行化，增量备份，自动备份控制文件的数据库结构更改，备份保留策略和所有备份的详细历史记录。</p>
                        <div class="infoboxnotealso" id="GUID-69A6FC62-06CB-48BD-AAC6-F5F1BE00E504__GUID-09BEB90C-9B5C-40E9-88B1-3E7E090B609B">
                           <p class="notep1">也可以看看：</p>
                           <p>有关RMAN的详细信息，请参见<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/vldbg&amp;id=BRADV8001" target="_blank"><span><cite>“Oracle数据库备份和恢复用户指南”</cite></span></a></p>
                        </div>
                     </div>
                  </div><a id="VLDBG1564"></a><div class="props_rev_3"><a id="GUID-BEF89467-A14D-4B90-A6C6-37BDAABFE2F9" name="GUID-BEF89467-A14D-4B90-A6C6-37BDAABFE2F9"></a><h5 id="VLDBG-GUID-BEF89467-A14D-4B90-A6C6-37BDAABFE2F9" class="sect5">Oracle Data Pump</h5>
                     <div>
                        <p>可以使用Oracle Data Pump（导出/导入）实用程序来补充物理备份，以对数据进行逻辑备份。</p>
                        <p>逻辑备份存储有关为数据库创建的模式对象的信息。Oracle Data Pump将数据和元数据加载到一组操作系统文件中，这些文件可以在同一系统上导入或移动到另一个系统并在那里导入。</p>
                        <p>转储文件集由一个或多个包含表数据，数据库对象元数据和控制信息的磁盘文件组成。文件以二进制格式写入。在导入操作期间，数据泵导入实用程序使用这些文件来查找转储文件集中的每个数据库对象。</p>
                     </div>
                  </div><a id="VLDBG1565"></a><div class="props_rev_3"><a id="GUID-E2A62C86-11FB-4B51-89F9-326228ABB228" name="GUID-E2A62C86-11FB-4B51-89F9-326228ABB228"></a><h5 id="VLDBG-GUID-E2A62C86-11FB-4B51-89F9-326228ABB228" class="sect5">用户管理的备份</h5>
                     <div>
                        <p>如果您不想使用Recovery Manager，则可以使用操作系统命令（例如UNIX <code class="codeph">dd</code>或<code class="codeph">tar</code>命令）进行备份。
                        </p>
                        <p>要创建用户管理的联机备份，必须手动将数据库置于热备份模式。热备份模式会对联机日志文件执行额外的写入操作，从而增加其大小。</p>
                        <p>通过编写脚本也可以自动执行备份操作。您可以立即备份整个数据库，也可以备份单个表空间，数据文件，控制文件或归档日志。可以使用各个表空间，数据文件，控制文件和存档日志的备份来补充整个数据库备份。</p>
                        <p>操作系统命令或第三方备份软件可以执行数据库备份。相反，必须使用第三方软件来还原数据库的备份。</p>
                     </div>
                  </div>
               </div>
            </div><a id="VLDBG1566"></a><div class="props_rev_3"><a id="GUID-79223C42-48E1-4036-AD74-4856A24935D5" name="GUID-79223C42-48E1-4036-AD74-4856A24935D5"></a><h3 id="VLDBG-GUID-79223C42-48E1-4036-AD74-4856A24935D5" class="sect3">数据仓库备份和恢复</h3>
               <div>
                  <p>数据仓库恢复类似于OLTP系统。</p>
                  <p>但是，数据仓库可能不需要从备份中恢复所有数据，或者完全失败，在用户访问开始之前恢复整个数据库。高效快速地恢复数据仓库始于精心规划的备份。</p>
                  <p>接下来的几节将帮助您确定应备份哪些数据，并指导您使用能够在最短的时间内恢复关键数据的方法和工具。</p>
                  <p>本节包含以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="vldb-backup.html#GUID-76435B39-EF7E-418B-9C33-0C43B088178A" title="恢复时间目标（RTO）是您希望能够恢复数据的持续时间。">恢复时间目标（RTO）</a></p>
                     </li>
                     <li>
                        <p><a href="vldb-backup.html#GUID-AD7289B0-0D01-4382-AA5D-CBE458ADDF91" title="恢复点目标（RPO）是在对组织造成不利伤害之前可能丢失的最大数据量。">恢复点目标（RPO）</a></p>
                     </li>
                  </ul>
               </div><a id="VLDBG1567"></a><div class="props_rev_3"><a id="GUID-76435B39-EF7E-418B-9C33-0C43B088178A" name="GUID-76435B39-EF7E-418B-9C33-0C43B088178A"></a><h4 id="VLDBG-GUID-76435B39-EF7E-418B-9C33-0C43B088178A" class="sect4">恢复时间目标（RTO）</h4>
                  <div>
                     <p><span class="bold">恢复</span> <span class="bold">时间</span> <span class="bold">目标</span> （RTO）是您希望能够恢复数据的持续时间。
                     </p>
                     <p>您的备份和恢复计划应设计为满足贵公司为其数据仓库选择的RTO。例如，您可以确定5％的数据必须在12小时内可用，50％的数据必须在2天内完全丢失数据后可用，其余数据在5天内可用。在这种情况下，您有两个RTO。您的总RTO是7.5天。</p>
                     <p>要确定您的RTO应该是什么，您必须首先确定数据不可用的影响。要建立RTO，请执行以下四个步骤：</p>
                     <ol>
                        <li>
                           <p>分析和识别：了解您的恢复准备情况，风险区域和不可用数据的业务成本。在数据仓库中，您应该识别必须在中断后的<span class="italic">n</span>天内恢复的关键数据。
                           </p>
                        </li>
                        <li>
                           <p>设计：将恢复要求转换为备份和恢复策略。这可以通过将数据组织成逻辑关系和关键性来实现。</p>
                        </li>
                        <li>
                           <p>构建和集成：将解决方案部署并集成到您的环境中以备份和恢复数据。记录备份和恢复计划。</p>
                        </li>
                        <li>
                           <p>管理和发展：定期测试您的恢复计划。随着数据，IT基础架构和业务流程的变化，实施变更管理流程以优化和更新解决方案。</p>
                        </li>
                     </ol>
                  </div>
               </div><a id="VLDBG1568"></a><div class="props_rev_3"><a id="GUID-AD7289B0-0D01-4382-AA5D-CBE458ADDF91" name="GUID-AD7289B0-0D01-4382-AA5D-CBE458ADDF91"></a><h4 id="VLDBG-GUID-AD7289B0-0D01-4382-AA5D-CBE458ADDF91" class="sect4">恢复点目标（RPO）</h4>
                  <div>
                     <p>恢复点目标（RPO）是在对组织造成不利伤害之前可能丢失的最大数据量。</p>
                     <p>RPO表示业务流程或组织的数据丢失容忍度。这种数据丢失通常以时间来衡量，例如，数据丢失5小时或2天。零RPO意味着在发生媒体丢失时不应丢失已提交的数据，而24小时RPO可以容忍一天的数据丢失。</p>
                     <p>本节包含以下主题：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="vldb-backup.html#GUID-1EC8332F-35B1-4441-8E03-67D29247E526" title="数据仓库最明显的特征是数据库的大小。">更多数据意味着更长的备份窗口</a></p>
                        </li>
                        <li>
                           <p><a href="vldb-backup.html#GUID-E573779F-B18F-4080-A60E-5C33E36F129C" title="在数据仓库中，有时可能没有完全使用数据库。">分而治之</a></p>
                        </li>
                     </ul>
                  </div><a id="VLDBG1569"></a><div class="props_rev_3"><a id="GUID-1EC8332F-35B1-4441-8E03-67D29247E526" name="GUID-1EC8332F-35B1-4441-8E03-67D29247E526"></a><h5 id="VLDBG-GUID-1EC8332F-35B1-4441-8E03-67D29247E526" class="sect5">更多数据意味着更长的备份窗口</h5>
                     <div>
                        <p>数据仓库最明显的特征是数据库的大小。</p>
                        <p>这可以超过100的太字节。硬件是快速备份和恢复的限制因素。但是，今天的磁带存储继续发展以适应必须卸载到磁带的数据量（例如，在内部使用磁盘和标准磁带访问接口的虚拟磁带库的出现）。RMAN可以并行地完全使用所有可用的磁带设备，以最大限度地提高备份和恢复性能。</p>
                        <p>实质上，备份大型数据库所需的时间可以从以下最小吞吐量中获得：生产磁盘，主机总线适配器（HBA）和网络到磁带设备，以及磁带驱动器流规范*磁带驱动器的数量。如果使用RMAN备份加密或压缩，主机CPU也可能是整体备份性能的限制因素。在充足的硬件资源的情况下，可以调整备份和恢复窗口以满足任何业务需求。</p>
                     </div>
                  </div><a id="VLDBG1570"></a><div class="props_rev_3"><a id="GUID-E573779F-B18F-4080-A60E-5C33E36F129C" name="GUID-E573779F-B18F-4080-A60E-5C33E36F129C"></a><h5 id="VLDBG-GUID-E573779F-B18F-4080-A60E-5C33E36F129C" class="sect5">分而治之</h5>
                     <div>
                        <p>在数据仓库中，有时可能没有完全使用数据库。</p>
                        <p>虽然这个时间窗口可能是几个连续的小时，但仅备份整个数据库是不够的。您可能需要考虑在几天内分解数据库备份。RMAN使您可以指定允许运行给定备份作业的时间。使用<code class="codeph">BACKUP</code> <code class="codeph">DURATION</code> ，您可以选择尽快运行备份并以更慢的速度运行备份，以最大限度地减少备份可能对数据库施加的负载。
                        </p>
                        <p>在以下示例中，RMAN将备份最近7天内未备份的所有数据库文件，运行4小时，并尽快读取块。</p><pre class="oac_no_warn" dir="ltr">备份数据库自'sysdate  -  7'部分持续时间4:00后最小时间;</pre><p>每次运行此RMAN命令时，它都会备份最近7天内未备份的数据文件。您无需每晚手动指定要备份的表空间或数据文件。在几天的过程中，将备份所有数据库文件。</p>
                        <p>虽然这是一种简单的数据库备份方法，但它易于实现，并且可以更灵活地备份大量数据。在恢复期间，RMAN可能会指向多个不同的存储设备以执行还原操作。因此，您的恢复时间可能会更长。</p>
                     </div>
                  </div>
               </div>
            </div><a id="VLDBG1571"></a><div class="props_rev_3"><a id="GUID-E6542B38-2388-4152-AFBC-C1CA03837D93" name="GUID-E6542B38-2388-4152-AFBC-C1CA03837D93"></a><h3 id="VLDBG-GUID-E6542B38-2388-4152-AFBC-C1CA03837D93" class="sect3">数据仓库恢复方法</h3>
               <div>
                  <p>设计备份和恢复策略可能是一项复杂且具有挑战性的任务。</p>
                  <p>当您有数百TB的数据必须受到保护并因故障而被恢复时，策略可能非常复杂。本节包含几个可以实现的最佳实践，以简化备份和恢复的管理。</p>
                  <p>本节包含以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="vldb-backup.html#GUID-DE407D9D-F392-4436-89B8-960ADD4AE300" title="归档重做日志对于恢复至关重要，因为它们不会丢失数据，因为它们构成了对数据库的更改记录。">最佳实践1：使用ARCHIVELOG模式</a></p>
                     </li>
                     <li>
                        <p><a href="vldb-backup.html#GUID-6AF7DEE0-8916-42C6-8EDA-A0464C5DA57B" title="许多数据仓库是在早期版本的Oracle数据库中开发的，可能没有集成RMAN进行备份和恢复。">最佳实践2：使用RMAN</a></p>
                     </li>
                     <li>
                        <p><a href="vldb-backup.html#GUID-6D73D7DA-7F4F-4CC3-A4EC-7A84F7ACF2B7" title="通过仅读取和写入自上次完全备份或增量备份以来更改的块，启用块更改跟踪可以更快地完成增量备份。">最佳实践3：使用块更改跟踪</a></p>
                     </li>
                     <li>
                        <p><a href="vldb-backup.html#GUID-FA70B6EF-0C8B-435B-98C9-CDEBCDCED145" title="随着大文件表空间的出现，数据仓库有机会将大量数据文件整合到更少，更好管理的数据文件中。">最佳实践4：使用RMAN多节备份</a></p>
                     </li>
                     <li>
                        <p><a href="vldb-backup.html#GUID-70595966-7453-4EAD-AE6F-6CDEF4C7049F" title="数据仓库面临的一个重要问题是典型数据仓库的庞大规模。即使使用强大的备份硬件，备份仍可能需要几个小时。">最佳实践5：利用只读表空间</a></p>
                     </li>
                     <li>
                        <p><a href="vldb-backup.html#GUID-42825ED1-C4C5-449B-870F-D2C8627CBF86" title="通常，数据仓库的高优先级是性能。数据仓库不仅必须为在线用户提供良好的查询性能，而且数据仓库在提取，转换和加载（ETL）过程中也必须高效，以便可以在最短的时间内加载大量数据。数据仓库使用的一种常见优化是使用NOLOGGING模式执行批量数据操作。">最佳实践6：计划备份/恢复策略中的NOLOGGING操作</a></p>
                     </li>
                     <li>
                        <p><a href="vldb-backup.html#GUID-12293CA0-65A8-469F-BEDE-4D502B250724" title="从备份和恢复的角度来看，并非数据仓库中的所有表空间都具有同等重要性。">最佳实践7：并非所有表空间都应该同等对待</a></p>
                     </li>
                  </ul>
               </div><a id="VLDBG1572"></a><div class="props_rev_3"><a id="GUID-DE407D9D-F392-4436-89B8-960ADD4AE300" name="GUID-DE407D9D-F392-4436-89B8-960ADD4AE300"></a><h4 id="VLDBG-GUID-DE407D9D-F392-4436-89B8-960ADD4AE300" class="sect4">最佳实践1：使用ARCHIVELOG模式</h4>
                  <div>
                     <p>归档重做日志对于恢复至关重要，因为它们不会丢失数据，因为它们构成了对数据库的更改记录。</p>
                     <p>Oracle数据库可以以两种模式运行：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">ARCHIVELOG</code></p>
                           <p>Oracle数据库归档填充的联机重做日志文件，然后在循环中重用它们。</p>
                        </li>
                        <li>
                           <p><code class="codeph">NOARCHIVELOG</code></p>
                           <p>在重新使用循环之前，Oracle数据库不会归档已填充的联机重做日志文件。</p>
                        </li>
                     </ul>
                     <p>在<code class="codeph">ARCHIVELOG</code>模式下运行数据库具有以下好处：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>可以从实例和介质故障中恢复数据库。</p>
                        </li>
                        <li>
                           <p>可以在数据库打开并可供使用时执行备份。</p>
                        </li>
                        <li>
                           <p>Oracle数据库支持多路复用存档日志，以避免存档日志中出现任何可能的单点故障。</p>
                        </li>
                        <li>
                           <p>可以使用更多恢复选项，例如执行表空间时间点恢复（TSPITR）的功能。</p>
                        </li>
                        <li>
                           <p>存档的重做日志可以传输并应用于物理备用数据库，该数据库是主数据库的精确副本。</p>
                        </li>
                     </ul>
                     <p>在<code class="codeph">NOARCHIVELOG</code>模式下运行数据库会产生以下后果：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>只有在干净关闭后关闭数据库时，才能备份数据库。</p>
                        </li>
                        <li>
                           <p>通常，唯一的介质恢复选项是将整个数据库还原到完成或增量备份的时间点，这可能导致最近的事务丢失。</p>
                        </li>
                     </ul>
                  </div><a id="VLDBG1573"></a><div class="props_rev_3"><a id="GUID-5905FBA5-9F21-4FAC-AA64-71FCF074635D" name="GUID-5905FBA5-9F21-4FAC-AA64-71FCF074635D"></a><h5 id="VLDBG-GUID-5905FBA5-9F21-4FAC-AA64-71FCF074635D" class="sect5">停机时间可以接受吗？</h5>
                     <div>
                        <p>设计备份计划以最大限度地减少数据库中断非常重要。</p>
                        <p>可以在打开或关闭数据库时进行Oracle数据库备份。计划的数据库停机时间可能会对运营造成破坏，特别是在支持多个时区用户的全球企业中，每天最多24小时。</p>
                        <p>根据业务，一些企业可以承受停机时间。如果整体业务策略需要很少或不需要停机，那么备份策略应该实现在线备份。永远不需要删除数据库进行备份。联机备份要求数据库处于<code class="codeph">ARCHIVELOG</code>模式。
                        </p>
                        <p>考虑到数据仓库的大小（以及因此备份数据仓库的时间量），对数据仓库进行脱机备份通常是不可行的，如果使用<code class="codeph">NOARCHIVELOG</code>模式，这将是必需的。
                        </p>
                     </div>
                  </div>
               </div><a id="VLDBG1574"></a><div class="props_rev_3"><a id="GUID-6AF7DEE0-8916-42C6-8EDA-A0464C5DA57B" name="GUID-6AF7DEE0-8916-42C6-8EDA-A0464C5DA57B"></a><h4 id="VLDBG-GUID-6AF7DEE0-8916-42C6-8EDA-A0464C5DA57B" class="sect4">最佳实践2：使用RMAN</h4>
                  <div>
                     <p>许多数据仓库是在早期版本的Oracle数据库中开发的，可能没有集成RMAN进行备份和恢复。</p>
                     <p>然而，正如有很多理由利用<code class="codeph">ARCHIVELOG</code>模式一样，有一个类似的引人注目的理由列表采用RMAN。考虑以下：</p>
                     <ol>
                        <li>
                           <p>无故障备份和恢复</p>
                        </li>
                        <li>
                           <p>腐败块检测</p>
                        </li>
                        <li>
                           <p>归档日志验证和管理</p>
                        </li>
                        <li>
                           <p>阻止媒体恢复（BMR）</p>
                        </li>
                        <li>
                           <p>轻松与媒体管理器集成</p>
                        </li>
                        <li>
                           <p>备份和还原优化</p>
                        </li>
                        <li>
                           <p>备份和还原验证</p>
                        </li>
                        <li>
                           <p>无需停机的备份</p>
                        </li>
                        <li>
                           <p>增量备份</p>
                        </li>
                        <li>
                           <p>广泛的报道</p>
                        </li>
                     </ol>
                  </div>
               </div><a id="VLDBG1575"></a><div class="props_rev_3"><a id="GUID-6D73D7DA-7F4F-4CC3-A4EC-7A84F7ACF2B7" name="GUID-6D73D7DA-7F4F-4CC3-A4EC-7A84F7ACF2B7"></a><h4 id="VLDBG-GUID-6D73D7DA-7F4F-4CC3-A4EC-7A84F7ACF2B7" class="sect4">最佳实践3：使用块更改跟踪</h4>
                  <div>
                     <p>通过仅读取和写入自上次完全备份或增量备份以来更改的块，启用块更改跟踪可以更快地完成增量备份。</p>
                     <p>对于数据仓库，如果数据库通常经历低到中等百分比的更改，这将非常有用。</p>
                     <div class="infoboxnotealso" id="GUID-6D73D7DA-7F4F-4CC3-A4EC-7A84F7ACF2B7__GUID-FDE85183-87ED-491F-8258-DC122A535892">
                        <p class="notep1">也可以看看：</p>
                        <p>有关块更改跟踪的详细信息<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/vldbg&amp;id=BRADV8001" target="_blank"><span><cite>，请参见“Oracle数据库备份和恢复用户指南”</cite></span></a></p>
                     </div>
                  </div>
               </div><a id="VLDBG1576"></a><div class="props_rev_3"><a id="GUID-FA70B6EF-0C8B-435B-98C9-CDEBCDCED145" name="GUID-FA70B6EF-0C8B-435B-98C9-CDEBCDCED145"></a><h4 id="VLDBG-GUID-FA70B6EF-0C8B-435B-98C9-CDEBCDCED145" class="sect4">最佳实践4：使用RMAN多节备份</h4>
                  <div>
                     <p>随着大文件表空间的出现，数据仓库有机会将大量数据文件整合到更少，更好管理的数据文件中。</p>
                     <p>对于备份非常大的数据文件，RMAN提供多节备份作为在文件本身内并行化备份操作的方法，以便并行备份文件的各个部分，而不是基于每个文件进行备份。</p>
                     <p>例如，一个TB数据文件可以划分为10个100 GB备份，每个部分并行备份，而不是整个备份为一个文件的TB文件。大数据文件的总体备份时间可以大大减少。</p>
                     <div class="infoboxnotealso" id="GUID-FA70B6EF-0C8B-435B-98C9-CDEBCDCED145__GUID-F28215A7-7FFF-46F5-A141-CC01F58F4CD8">
                        <p class="notep1">也可以看看：</p>
                        <p>有关配置多节备份的详细信息，请参见<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/vldbg&amp;id=BRADV8001" target="_blank"><span><cite>“Oracle数据库备份和恢复用户指南”</cite></span></a></p>
                     </div>
                  </div>
               </div><a id="VLDBG1577"></a><div class="props_rev_3"><a id="GUID-70595966-7453-4EAD-AE6F-6CDEF4C7049F" name="GUID-70595966-7453-4EAD-AE6F-6CDEF4C7049F"></a><h4 id="VLDBG-GUID-70595966-7453-4EAD-AE6F-6CDEF4C7049F" class="sect4">最佳实践5：利用只读表空间</h4>
                  <div>
                     <p>数据仓库面临的一个重要问题是典型数据仓库的庞大规模。即使使用强大的备份硬件，备份仍可能需要几个小时。</p>
                     <p>提高备份性能的一个重要考虑因素是最大限度地减少要备份的数据量。只读表空间是减少要在数据仓库中备份的数据量的最简单机制。即使使用增量备份，如果表空间设置为只读，备份和恢复也会更快。</p>
                     <p>只读表空间的优点是数据必须只备份一次。如果数据仓库包含五年的历史数据，并且前四年的数据可以只读，那么从理论上讲，数据库的常规备份将只备份20％的数据。这可以大大减少备份数据仓库所需的时间。</p>
                     <p>大多数数据仓库将其数据存储在按时间进行范围分区的表中。在典型的数据仓库中，数据通常在30天到一年的范围内有效。在此期间，历史数据仍然可以更新和更改（例如，零售商可以接受自购买之日起最多30天的退货，以便销售数据记录在此期间可能会发生变化）。但是，在数据达到某个年龄后，通常会知道它是静态的。</p>
                     <p>通过利用分区，用户可以将其数据的静态部分设置为只读。目前，Oracle支持只读表空间而不是只读分区或表。要利用只读表空间并减少备份窗口，应设计一种在只读表空间中存储常量数据分区的策略。以下是实现滚动窗口的两种策略：</p>
                     <ol>
                        <li>
                           <p>当分区中的数据成熟到完全静态时，实现定期调度的进程将分区从当前的读写表空间移动到表空间，然后可以将其设置为只读。</p>
                        </li>
                        <li>
                           <p>创建一系列表空间，每个表空间包含少量分区，并定期将表空间从读写更改为只读，因为该表空间中的数据会老化。</p>
                        </li>
                     </ol>
                     <p>一个考虑因素是备份数据只是恢复过程的一半。如果您配置磁带系统以便它可以在4小时内备份数据仓库的读写部分，那么推论是磁带系统可能需要20个小时来恢复数据库，如果需要完全恢复，则80％数据库是只读的。</p>
                  </div>
               </div><a id="VLDBG1578"></a><div class="props_rev_3"><a id="GUID-42825ED1-C4C5-449B-870F-D2C8627CBF86" name="GUID-42825ED1-C4C5-449B-870F-D2C8627CBF86"></a><h4 id="VLDBG-GUID-42825ED1-C4C5-449B-870F-D2C8627CBF86" class="sect4">最佳实践6：计划备份/恢复策略中的NOLOGGING操作</h4>
                  <div>
                     <p>通常，数据仓库的高优先级是性能。数据仓库不仅必须为在线用户提供良好的查询性能，而且数据仓库在提取，转换和加载（ETL）过程中也必须高效，以便可以在最短的时间内加载大量数据。数据仓库使用的一种常见优化是使用<code class="codeph">NOLOGGING</code>模式执行批量数据操作。
                     </p>
                     <p></p>
                     <p>支持<code class="codeph">NOLOGGING</code>模式的数据库操作是直接路径加载和插入操作，索引创建和表创建。当操作在<code class="codeph">NOLOGGING</code>模式下运行时，数据不会写入重做日志（或者更准确地说，只有一小组元数据被写入重做日志）。此模式在数据仓库中广泛使用，可将批量数据操作的性能提高多达50％。
                     </p>
                     <p>但是，权衡是使用传统的恢复机制无法恢复<code class="codeph">NOLOGGING</code>操作，因为支持恢复的必要数据从未写入日志文件。此外，即使那些操作没有使用<code class="codeph">NOLOGGING</code>模式，对发生了<code class="codeph">NOLOGGING</code>操作的数据的后续操作也不能恢复。由于<code class="codeph">NOLOGGING</code>操作提供的性能提升，通常建议数据仓库在其ETL过程中使用<code class="codeph">NOLOGGING</code>模式。
                     </p>
                     <p>在设计备份和恢复策略时，必须考虑<code class="codeph">NOLOGGING</code>操作的存在。当数据库依赖于<code class="codeph">NOLOGGING</code>操作时，传统的恢复策略（从最新的磁带备份恢复并应用存档的日志文件）不再适用，因为日志文件无法恢复<code class="codeph">NOLOGGING</code>操作。
                     </p>
                     <p>要记住的第一个原则是，在<code class="codeph">NOLOGGING</code>操作发生时不要进行备份。Oracle数据库当前不强制执行此规则，因此DBA必须安排备份作业和ETL作业，以使<code class="codeph">NOLOGGING</code>操作不与备份操作重叠。
                     </p>
                     <p>存在<code class="codeph">NOLOGGING</code>操作时有两种备份和恢复方法：ETL或增量备份。如果您未在数据仓库中使用<code class="codeph">NOLOGGING</code>操作，则不必选择任一选项：您可以使用存档日志恢复数据仓库。但是，与基于归档日志的恢复方法相比，这些选项可能会提供一些性能优势。您还可以使用闪回日志和保证还原点将数据库闪回到以前的某个时间点。
                     </p>
                     <p>本节包含以下主题：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="vldb-backup.html#GUID-D4A6BA18-4B9D-4C8A-9228-A7A347B6EB42" title="ETL过程使用多个Oracle功能和一组方法将数据加载（重新加载）到数据仓库中。">提取，转换和加载</a></p>
                        </li>
                        <li>
                           <p><a href="vldb-backup.html#GUID-894D16AF-2719-4C42-95D0-9A8E0E156343" title="一种方法是进行常规数据库备份，并存储必要的数据文件以重新创建整周的ETL过程。">提取，转换和加载策略</a></p>
                        </li>
                        <li>
                           <p><a href="vldb-backup.html#GUID-8BB8C9D9-FF95-49B5-9E3B-F768459AB3EA" title="在NOLOGGING操作存在的情况下，更自动化的备份和恢复策略使用RMAN的增量备份功能。">增量备份</a></p>
                        </li>
                        <li>
                           <p><a href="vldb-backup.html#GUID-4FDB71A7-3761-4899-9BCA-1E97FB17BF9B" title="使用此方法的典型备份和恢复策略是每周末备份数据仓库，然后在ETL过程完成后每晚对数据仓库进行增量备份。">增量方法</a></p>
                        </li>
                        <li>
                           <p><a href="vldb-backup.html#GUID-F4F3145C-A462-4963-ACF6-BA66C5E9DD70" title="闪回数据库是一种快速，连续的时间点恢复方法，用于修复广泛的逻辑错误。">闪回数据库和保证还原点</a></p>
                        </li>
                     </ul>
                  </div><a id="VLDBG1579"></a><div class="props_rev_3"><a id="GUID-D4A6BA18-4B9D-4C8A-9228-A7A347B6EB42" name="GUID-D4A6BA18-4B9D-4C8A-9228-A7A347B6EB42"></a><h5 id="VLDBG-GUID-D4A6BA18-4B9D-4C8A-9228-A7A347B6EB42" class="sect5">提取，转换和加载</h5>
                     <div>
                        <p>ETL过程使用多个Oracle功能和一组方法将数据加载（重新加载）到数据仓库中。</p>
                        <p>这些功能包括：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>可传输的表空间</p>
                              <p>可传输表空间允许用户跨Oracle数据库快速移动表空间。这是在数据库之间移动批量数据的最有效方法。Oracle数据库提供跨平台传输表空间的功能。如果源平台和目标平台具有不同的字节顺序，则RMAN将正在传输的表空间转换为目标格式。</p>
                           </li>
                           <li>
                              <p>使用SQL * Loader</p>
                              <p>SQL * Loader将外部平面文件中的数据加载到Oracle数据库的表中。它具有强大的数据解析引擎，对数据文件中的数据格式几乎没有限制。</p>
                           </li>
                           <li>
                              <p>数据泵（导出/导入）</p>
                              <p>Oracle Data Pump支持从一个数据库到另一个数据库的高速数据和元数据移动。该技术是Oracle Data Pump Export和Data Pump Import实用程序的基础。</p>
                           </li>
                           <li>
                              <p>外部表格</p>
                              <p>外部表功能是对现有SQL * Loader功能的补充。它使您可以访问外部源中的数据，就像它在数据库中的表中一样。外部表还可以与Data Pump驱动程序一起使用，以使用<code class="codeph">CREATE</code> <code class="codeph">TABLE</code> <code class="codeph">AS</code> <code class="codeph">SELECT</code> <code class="codeph">*</code> <code class="codeph">FROM</code>从数据库导出数据，然后将数据导入Oracle数据库。
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div><a id="VLDBG1580"></a><div class="props_rev_3"><a id="GUID-894D16AF-2719-4C42-95D0-9A8E0E156343" name="GUID-894D16AF-2719-4C42-95D0-9A8E0E156343"></a><h5 id="VLDBG-GUID-894D16AF-2719-4C42-95D0-9A8E0E156343" class="sect5">提取，转换和加载策略</h5>
                     <div>
                        <p>一种方法是进行常规数据库备份，并存储必要的数据文件以重新创建整周的ETL过程。</p>
                        <p>如果需要恢复，可以从最新的备份中恢复数据仓库。然后，通过应用存档的重做日志（如在传统的恢复方案中所做的那样）而不是向前滚动，可以通过重新运行ETL过程来前滚数据仓库。这种范例假设可以轻松地重放ETL过程，这通常涉及为每个ETL过程存储一组提取文件。</p>
                        <p>此方法的示例实现是每周末备份数据仓库，然后存储必要的文件以支持每晚的ETL过程。最多必须重新应用7天的ETL处理才能恢复数据库。数据仓库管理员可以根据磁带的恢复速度和以前ETL运行的性能数据，轻松地预测恢复数据仓库的时间长度。</p>
                        <p>从本质上讲，数据仓库管理员在使用<code class="codeph">NOLOGGING</code>操作的ETL过程中获得了更好的性能，其代价是稍微复杂一些，自动恢复过程也不那么自动化。许多数据仓库管理员发现这是一个理想的权衡。
                        </p>
                        <p>这种方法的一个缺点是数据仓库管理员负担跟踪数据仓库中发生的所有相关更改。此方法不捕获超出ETL过程的更改。例如，在某些数据仓库中，用户可以创建自己的表和数据结构。这些变化在恢复过程中丢失了。</p>
                        <p>必须将此限制传达给最终用户。或者，也可以强制最终用户在单独的表空间中创建所有私有数据库对象，并且在恢复期间，DBA可以使用常规恢复恢复此表空间，同时使用重新运行ETL过程的方法恢复数据库的其余部分。</p>
                     </div>
                  </div><a id="VLDBG1581"></a><div class="props_rev_3"><a id="GUID-8BB8C9D9-FF95-49B5-9E3B-F768459AB3EA" name="GUID-8BB8C9D9-FF95-49B5-9E3B-F768459AB3EA"></a><h5 id="VLDBG-GUID-8BB8C9D9-FF95-49B5-9E3B-F768459AB3EA" class="sect5">增量备份</h5>
                     <div>
                        <p>在<code class="codeph">NOLOGGING</code>操作存在的情况下，更自动化的备份和恢复策略使用RMAN的增量备份功能。
                        </p>
                        <p>增量备份提供了自上次备份以来仅备份更改的块的功能。数据文件的增量备份在逐个块的基础上捕获数据更改，而不是要求备份数据文件中的所有已使用块。除非更改了数据文件中的每个块，否则生成的备份集通常比完整数据文件备份更小且更有效。</p>
                        <p>启用块更改跟踪时，Oracle数据库会跟踪所有数据库更改的物理位置。RMAN自动使用更改跟踪文件来确定在增量备份期间必须读取哪些块。块更改跟踪文件大约是数据库总大小的1/30000。</p>
                        <div class="infoboxnotealso" id="GUID-8BB8C9D9-FF95-49B5-9E3B-F768459AB3EA__GUID-15C766EE-97C7-456A-880F-59ADC195C6A1">
                           <p class="notep1">也可以看看：</p>
                           <p>有关块更改跟踪及其启用方式的详细信息<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/vldbg&amp;id=BRADV8001" target="_blank"><span><cite>，请参见“Oracle数据库备份和恢复用户指南”</cite></span></a></p>
                        </div>
                     </div>
                  </div><a id="VLDBG1582"></a><div class="props_rev_3"><a id="GUID-4FDB71A7-3761-4899-9BCA-1E97FB17BF9B" name="GUID-4FDB71A7-3761-4899-9BCA-1E97FB17BF9B"></a><h5 id="VLDBG-GUID-4FDB71A7-3761-4899-9BCA-1E97FB17BF9B" class="sect5">增量方法</h5>
                     <div>
                        <p>使用此方法的典型备份和恢复策略是每周末备份数据仓库，然后在ETL过程完成后每晚对数据仓库进行增量备份。</p>
                        <p>与常规备份一样，增量备份不得与<code class="codeph">NOLOGGING</code>操作同时运行。要恢复数据仓库，将恢复数据库备份，然后重新应用每晚的增量备份。
                        </p>
                        <p>虽然<code class="codeph">NOLOGGING</code>操作未在存档日志捕获，从数据<code class="codeph">NOLOGGING</code>操作是存在于增量备份。此外，与以前的方法不同，可以使用RMAN管理此备份和恢复策略。</p>
                     </div>
                  </div><a id="VLDBG1583"></a><div class="props_rev_3"><a id="GUID-F4F3145C-A462-4963-ACF6-BA66C5E9DD70" name="GUID-F4F3145C-A462-4963-ACF6-BA66C5E9DD70"></a><h5 id="VLDBG-GUID-F4F3145C-A462-4963-ACF6-BA66C5E9DD70" class="sect5">闪回数据库和保证还原点</h5>
                     <div>
                        <p>闪回数据库是一种快速，连续的时间点恢复方法，用于修复广泛的逻辑错误。</p>
                        <p>闪回数据库依赖于额外的日志记录，称为闪回日志，这些日志记录在快速恢复区域中创建，并根据恢复需要保留用户定义的时间间隔。这些日志在更新时跟踪原始块图像。</p>
                        <p>执行闪回数据库操作时，只恢复和恢复与更改的数据对应的块映像，而传统的数据文件还原必须在恢复开始之前恢复备份中的所有块。闪回日志与重做日志成比例地创建。</p>
                        <p>对于非常大且活跃的数据库，保留所有需要的闪回日志以进行连续时间点恢复可能是不可行的。但是，可能需要在批处理运行期间为逻辑错误创建特定的时间点快照（例如，在夜间批处理作业之前）。对于此方案，可以在不启用闪回日志记录的情况下创建保证还原点。</p>
                        <p>创建保证还原点后，将保留闪回日志，以使闪回数据库满足保证还原点，而无需其他时间点，从而节省空间。例如，可以创建保证的还原点，然后创建一个nologging批处理作业。只要在保证还原点的创建时间的最后一小时内没有先前的nologging操作，闪回数据库到保证还原点就会撤消nologging批处理作业。要在nologging批处理作业完成后闪回一段时间，请在批处理作业结束后至少一小时创建保证还原点。</p>
                        <p>在此方案中估计闪回日志空间以确保还原点取决于您希望保留还原点的天数中数据库的更改量。例如，要保证2天的保证还原点并且您希望更改100 GB的数据库，那么为闪回日志计划100 GB。100 GB是指在创建保证还原点后更改的数据库子集，而不是更改频率。</p>
                     </div>
                  </div>
               </div><a id="VLDBG1584"></a><div class="props_rev_3"><a id="GUID-12293CA0-65A8-469F-BEDE-4D502B250724" name="GUID-12293CA0-65A8-469F-BEDE-4D502B250724"></a><h4 id="VLDBG-GUID-12293CA0-65A8-469F-BEDE-4D502B250724" class="sect4">最佳实践7：并非所有表空间都应该同等对待</h4>
                  <div>
                     <p>从备份和恢复的角度来看，并非数据仓库中的所有表空间都具有同等重要性。</p>
                     <p>数据库管理员可以在必要时使用此信息来设计更有效的备份和恢复策略。备份和恢复的基本粒度是表空间，因此不同的表空间可能具有不同的备份和恢复策略。</p>
                     <p>在最基本的层面上，永远不需要备份临时表空间（RMAN强制执行的规则）。此外，在某些数据仓库中，可能存在专用于临时空间的表空间，供用户存储临时表和增量结果。这些表空间不是显式临时表空间，而是基本上用作临时表空间。根据业务需求，可能不需要备份和还原这些表空间;相反，对于这些表空间的丢失，用户将重新创建自己的数据对象。</p>
                     <p>在许多数据仓库中，某些数据比其他数据更重要。例如，数据仓库中的销售数据可能至关重要，在恢复情况下，此数据必须尽快联机。但是，在同一个数据仓库中，存储来自公司网站的点击流数据的表可能对企业来说不那么重要。如果数据库文件丢失，企业可能会容忍这些数据离线几天，或者甚至可以容纳数天的点击流数据丢失。在这种情况下，必须经常备份包含销售数据的表空间，而包含点击流数据的表空间只需每周或两周备份一次。</p>
                     <p>虽然最简单的备份和恢复方案是将数据库中的每个表空间都视为相同，但Oracle数据库为DBA提供了根据需要为每个表空间设计备份和恢复方案的灵活性。</p>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>