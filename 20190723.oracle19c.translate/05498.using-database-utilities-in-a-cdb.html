<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="You can use utilities such as Oracle Data Pump, DBNEWID, and Oracle LogMiner in a multitenant environment."></meta>
      <meta name="description" content="You can use utilities such as Oracle Data Pump, DBNEWID, and Oracle LogMiner in a multitenant environment."></meta>
      <title>在多租户环境中使用数据库实用程序</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Administrator’s Guide "></meta>
      <meta property="og:description" content="You can use utilities such as Oracle Data Pump, DBNEWID, and Oracle LogMiner in a multitenant environment."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Administrator’s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="multitenant-administrators-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-03-20T09:59:22-07:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2017, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96136-03"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="backing-up-and-recovering-cdbs-and-pdbs.html" title="Previous" type="text/html"></link>
      <link rel="next" href="using-oracle-resource-manager-for-pdbs-with-sql-plus.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Multitenant Administrator&#39;s Guide"></meta>
    <meta name="dcterms.isVersionOf" content="MULTI"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="backing-up-and-recovering-cdbs-and-pdbs.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="using-oracle-resource-manager-for-pdbs-with-sql-plus.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">管理员指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="using-oracle-features-in-a-multitenant-environment.html" property="item" typeof="WebPage"><span property="name">在多租户环境中使用Oracle功能</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">在多租户环境中使用数据库实用程序</li>
            </ol>
            <a id="GUID-FF209AA0-3628-4E33-B155-FDF8FAC60BB6" name="GUID-FF209AA0-3628-4E33-B155-FDF8FAC60BB6"></a>
            
            <h2 id="MULTI-GUID-FF209AA0-3628-4E33-B155-FDF8FAC60BB6" class="sect2"><span class="enumeration_chapter">21</span>在多租户环境中使用数据库实用程序</h2>
         </header>
         <div class="ind">
            <div>
               <p>您可以在多租户环境中使用Oracle Data Pump，DBNEWID和Oracle LogMiner等实用程序。</p>
               <p>本章包含以下主题：</p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="using-database-utilities-in-a-cdb.html#GUID-0CE0454A-C192-4075-97D6-5C1333440778">在CDB中导入和导出数据</a><br>Oracle Data Pump技术可以将数据和元数据从一个数据库高速移动到另一个数据库。
                  </li>
                  <li class="ulchildlink"><a href="using-database-utilities-in-a-cdb.html#GUID-2555A155-01E3-483E-9FC6-2BDC2D8A4093">在CDB中使用LogMiner</a><br>您可以在多租户容器数据库（CDB）中使用LogMiner。
                  </li>
                  <li class="ulchildlink"><a href="using-database-utilities-in-a-cdb.html#GUID-73D5DDC3-F576-4869-A68F-5091DB961B48">DBNEWID对CDB和PDB的考虑</a><br>DBNEWID参数<code class="codeph">PDB</code>允许您更改可插拔数据库（PDB）上的DBID。
                  </li>
               </ul>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>父主题：</strong> <a href="using-oracle-features-in-a-multitenant-environment.html#GUID-CE922DAA-66FB-430B-96E5-29FF50BFD2FF" title="您可以在多租户环境中使用Oracle数据库功能。">在多租户环境中使用Oracle功能</a></p>
                  </div>
               </div>
            </div>
            
            <div class="sect2"><a id="GUID-0CE0454A-C192-4075-97D6-5C1333440778" name="GUID-0CE0454A-C192-4075-97D6-5C1333440778"></a><h3 id="MULTI-GUID-0CE0454A-C192-4075-97D6-5C1333440778" class="sect3"><span class="enumeration_section">21.1</span>在CDB中导入和导出数据</h3>
               <div>
                  <p>Oracle Data Pump技术可以将数据和元数据从一个数据库高速移动到另一个数据库。</p>
                  <p>本节包含以下主题：</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="using-database-utilities-in-a-cdb.html#GUID-BD76463C-0867-477E-983F-4329610EC458">关于在多租户环境中使用数据泵</a><br>通常，将数据泵与PDB一起使用与使用非CDB的数据泵相同。</li>
                     <li class="ulchildlink"><a href="using-database-utilities-in-a-cdb.html#GUID-49A847B1-3193-4C45-B7F3-B7F514B75C71">使用数据泵将数据移入CDB</a><br>创建空PDB后，可以使用Oracle Data Pump全模式导出和导入操作将数据移动到PDB中。</li>
                     <li class="ulchildlink"><a href="using-database-utilities-in-a-cdb.html#GUID-C1578FB6-216F-473E-A6D5-18453D4F9021">使用数据泵在CDB内或之间移动PDB</a><br>PDB上的数据泵导出和导入操作与非CDB上的数据泵导出和导入操作相同，但常见用户的处理方式除外。
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="using-database-utilities-in-a-cdb.html#GUID-FF209AA0-3628-4E33-B155-FDF8FAC60BB6" title="您可以在多租户环境中使用Oracle Data Pump，DBNEWID和Oracle LogMiner等实用程序。">在多租户环境中使用数据库实用程序</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="sect3"><a id="GUID-BD76463C-0867-477E-983F-4329610EC458" name="GUID-BD76463C-0867-477E-983F-4329610EC458"></a><h4 id="MULTI-GUID-BD76463C-0867-477E-983F-4329610EC458" class="sect4"><span class="enumeration_section">21.1.1</span>关于在多租户环境中使用数据泵</h4>
                  <div>
                     <p>通常，将数据泵与PDB一起使用与使用非CDB的数据泵相同。</p>
                     <p>多租户容器数据库（CDB）是一个Oracle数据库，包括零个，一个或多个用户创建的可插拔数据库（PDB）。PDB是一组可移植的模式，模式对象和非模式对象，它们在Oracle Net客户端中显示为非CDB。非CDB是不是CDB的Oracle数据库。</p>
                     <p>在以下方案中，您可以使用Data Pump迁移全部或部分数据库：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>从非CDB到PDB</p>
                        </li>
                        <li>
                           <p>在相同或不同CDB内的PDB之间</p>
                        </li>
                        <li>
                           <p>从PDB到非CDB</p>
                        </li>
                     </ul>
                     <div class="infoboxnote" id="GUID-BD76463C-0867-477E-983F-4329610EC458__GUID-140B9CD4-E02E-4A16-9410-B036E8310254">
                        <p class="notep1">注意：</p>
                        <p>Data Pump不支持任何CDB范围的操作。如果您连接到CDB的根数据库或种子数据库，则Data Pump会发出以下警告：</p><pre class="pre codeblock"><code>ORA-39357：警告：连接到容器数据库的根目录或种子时，通常不需要Oracle Data Pump操作。</code></pre></div>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-database-utilities-in-a-cdb.html#GUID-0CE0454A-C192-4075-97D6-5C1333440778" title="Oracle Data Pump技术可以将数据和元数据从一个数据库高速移动到另一个数据库。">在CDB中导入和导出数据</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="props_rev_3"><a id="GUID-49A847B1-3193-4C45-B7F3-B7F514B75C71" name="GUID-49A847B1-3193-4C45-B7F3-B7F514B75C71"></a><h4 id="MULTI-GUID-49A847B1-3193-4C45-B7F3-B7F514B75C71" class="sect4"><span class="enumeration_section">21.1.2</span>使用数据泵将数据移入CDB</h4>
                  <div>
                     <p>创建空PDB后，可以使用Oracle Data Pump全模式导出和导入操作将数据移动到PDB中。</p>
                     <p>您可以使用或不使用transportable选项导入数据。如果在完整模式导出或导入时使用可传输选项，则将其称为完全可传输导出/导入。</p>
                     <p>使用可传输选项时，导出和导入使用可传输的表空间数据移动和传统的数据移动;后者用于驻留在非可传输表空间（如<code class="codeph">SYSTEM</code>和<code class="codeph">SYSAUX</code>那些表。使用transportable选项可以减少导出时间，尤其是导入时间，因为不需要卸载和重新加载表数据，也不需要重新创建用户表空间中的索引结构。
                     </p>
                     <p>使用Data Pump将数据移动到CDB时，请注意以下要求：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>要管理多租户环境，您必须具有<code class="codeph">CDB_DBA</code>角色。
                           </p>
                        </li>
                        <li>
                           <p>可以将Oracle Database 11.2.0.2及更早版本的完整数据库导出导入Oracle Database 12c（CDB或非CDB）。但是，Oracle建议您首先将源数据库升级到Oracle Database 11g第2版（11.2.0.3或更高版本），以便导出中包含有关已注册选项和组件的信息。</p>
                        </li>
                        <li>
                           <p>使用完整数据库导出或完全可传输数据库导出将Oracle Database 11g第2版（11.2.0.3或更高版本）迁移到CDB（或非CDB）时，必须将数据泵导出参数<code class="codeph">VERSION=12</code>为生成一个准备导入Oracle Database 12c的转储文件。如果未设置<code class="codeph">VERSION=12</code> ，则生成的导出文件不包含有关已注册数据库选项和组件的完整信息。
                           </p>
                        </li>
                        <li>
                           <p>基于网络的完全可传输导入需要使用<code class="codeph">FULL=YES</code> ， <code class="codeph">TRANSPORTABLE=ALWAYS</code>和<code class="codeph">TRANSPORT_DATAFILES= <span class="variable" translate="no">datafile_name</span></code>参数。当源数据库是Oracle Database 11g 11.2.0.3或更高版本，但早于Oracle Database 12c第1版（12.1）时，还需要<code class="codeph">VERSION=12</code>参数。
                           </p>
                        </li>
                        <li>
                           <p>基于文件的完全可传输导入仅需要使用<code class="codeph">TRANSPORT_DATAFILES= <span class="variable" translate="no">datafile_name</span></code>参数。数据泵导入推断出<code class="codeph">TRANSPORTABLE=ALWAYS</code>和<code class="codeph">FULL=YES</code>参数的存在。
                           </p>
                        </li>
                        <li>
                           <p>从Oracle Database 12c第2版（12.2）开始，在多租户容器数据库（CDB）环境中，默认数据泵目录对象<code class="codeph">DATA_PUMP_DIR</code>被定义为CDB中每个PDB的唯一路径。定义此唯一路径是定义<code class="codeph">CREATE PLUGGABLE DATABASE</code>语句的<code class="codeph">PATH_PREFIX</code>子句还是未定义相对路径。
                           </p>
                        </li>
                        <li>
                           <p>从Oracle Database 19c开始， <code class="codeph">impdp</code>的<code class="codeph">credential</code>参数指定凭证对象的名称，该凭证对象包含访问对象存储桶所需的用户名和密码。您还可以使用名为<code class="codeph">DEFAULT_CREDENTIAL</code>的PDB属性指定默认凭据。使用当时的默认凭据运行<code class="codeph">impdb</code>时，使用<code class="codeph">DEFAULT_CREDENTIAL:</code>为转储文件名添加前缀<code class="codeph">DEFAULT_CREDENTIAL:</code>并且不指定<code class="codeph">credential</code>参数。
                           </p>
                        </li>
                     </ul>
                     <div class="example" id="GUID-49A847B1-3193-4C45-B7F3-B7F514B75C71__GUID-13F8CE65-B6F4-4A75-AB27-5F6268C39C84">
                        <p class="titleinexample">示例21-1将表导入PDB</p>
                        <p>要为导出/导入操作指定特定PDB，请在启动Data Pump时在连接字符串中提供连接标识符。例如，要将数据导入名为<code class="codeph">pdb1</code>的PDB，可以在Data Pump命令行中输入以下内容：</p><pre class="pre codeblock"><code>impdp hr @ pdb1 DIRECTORY = dpump_dir1 DUMPFILE = hr.dmp TABLES =员工</code></pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-49A847B1-3193-4C45-B7F3-B7F514B75C71__GUID-30BBDAEB-AC3A-4672-BC72-09052CFBFB35">
                        <p class="titleinexample">示例21-2导入数据时指定凭据</p>
                        <p>此示例假定您使用<code class="codeph">DBMS_CREDENTIAL.CREATE_CREDENTIAL</code>创建了名为<code class="codeph">HR_CRED</code>的凭据，如下所示：</p><pre class="pre codeblock"><code>BEGIN DBMS_CLOUD.CREATE_CREDENTIAL（credential_name =&gt;'HR_CRED'，用户名=&gt;'atpc_user@oracle.com'，密码=&gt;' <span class="italic">密码</span> '）;结束; /</code></pre><p>以下命令指定凭证<code class="codeph">HR_CRED</code> ，并指定存储在对象库中的文件。该文件的URL是<code class="codeph">https://example.com/ostore/dnfs/myt.dmp</code> 。</p><pre class="pre codeblock"><code>impdp hr @ pdb1 \ table_exists_action = replace \ credential = HR_CRED \ parallel = 16 \ dumpfile = https://example.com/ostore/dnfs/myt.dmp</code></pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-49A847B1-3193-4C45-B7F3-B7F514B75C71__GUID-73EF3BB4-46CA-44E4-B67C-1DD09FC48DA3">
                        <p class="titleinexample">示例21-3使用默认凭据导入数据</p>
                        <ol id="GUID-49A847B1-3193-4C45-B7F3-B7F514B75C71__OL_D5V_NX3_QFB">
                           <li>
                              <p>您可以使用<code class="codeph">DBMS_CREDENTIAL.CREATE_CREDENTIAL</code>创建名为<code class="codeph">HR_CRED</code>的凭证，如下所示：</p><pre class="pre codeblock"><code>BEGIN DBMS_CLOUD.CREATE_CREDENTIAL（credential_name =&gt;'HR_CRED'，用户名=&gt;'atpc_user@oracle.com'，密码=&gt;' <span class="italic">密码</span> '）;结束; /</code></pre></li>
                           <li>
                              <p>您可以按如下方式设置PDB属性<code class="codeph">DEFAULT_CREDENTIAL</code> ：</p><pre class="pre codeblock"><code>ALTER DATABASE PROPERTY SET DEFAULT_CREDENTIAL ='ADMIN.HR_CRED'</code></pre></li>
                           <li>
                              <p>以下命令将默认凭据指定为转储文件位置的前缀<code class="codeph">https://example.com/ostore/dnfs/myt.dmp</code> ：</p><pre class="pre codeblock"><code>impdp hr @ pdb1 \ table_exists_action = replace \ parallel = 16 \ dumpfile = default_credential：https：//example.com/ostore/dnfs/myt.dmp</code></pre><p>请注意，未指定<code class="codeph">credential</code>参数。
                              </p>
                           </li>
                        </ol>
                     </div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-49A847B1-3193-4C45-B7F3-B7F514B75C71__GUID-3144C863-B387-49F4-AEDF-010D15E4D2B1">
                        <p class="notep1">也可以看看：</p>
                        <ul id="GUID-49A847B1-3193-4C45-B7F3-B7F514B75C71__UL_BYJ_FW3_QFB" style="list-style-type:disc">
                           <li>
                              <p><a href="../dbseg/configuring-secure-sockets-layer-authentication.html#DBSEG-GUID-6AD89576-526F-4D6B-A539-ADF4B840819F" target="_blank"><span><cite>Oracle数据库安全指南</cite></span></a> ，了解如何配置SSL身份验证，这是对象存储访问所必需的</p>
                           </li>
                           <li>
                              <p><a href="../sutil/datapump-import-utility.html#SUTIL-GUID-D11E340E-14C6-43B8-AB09-6335F0C1F71B" target="_blank"><span><cite>Oracle数据库实用程序</cite></span></a> ，了解如何使用Data Pump Import将文件加载到对象库</p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-database-utilities-in-a-cdb.html#GUID-0CE0454A-C192-4075-97D6-5C1333440778" title="Oracle Data Pump技术可以将数据和元数据从一个数据库高速移动到另一个数据库。">在CDB中导入和导出数据</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="props_rev_3"><a id="GUID-C1578FB6-216F-473E-A6D5-18453D4F9021" name="GUID-C1578FB6-216F-473E-A6D5-18453D4F9021"></a><h4 id="MULTI-GUID-C1578FB6-216F-473E-A6D5-18453D4F9021" class="sect4"><span class="enumeration_section">21.1.3</span>使用数据泵在CDB内或之间移动PDB</h4>
                  <div>
                     <p>PDB上的数据泵导出和导入操作与非CDB上的数据泵导出和导入操作相同，但常见用户的处理方式除外。</p>
                     <div class="section">
                        <p>如果您在CDB中创建了一个公共用户，那么该用户从CDB中的任何PDB中导出的完整数据库或特权模式会导致在导入时执行标准的<code class="codeph">CREATE USER C##common name</code> DDL语句。由于用户名上的公共用户前缀<code class="codeph">C##</code> ，该语句将失败。将返回以下错误消息：</p><pre class="pre codeblock"><code>ORA-65094：无效的本地用户或角色名称</code></pre><p>在导出的PDB中，如果已在该用户的架构中创建了本地对象并且要导入它们，则要么确保目标CDB实例中已存在同名的公共用户，要么使用数据泵导入<code class="codeph">REMAP_SCHEMA</code>参数<code class="codeph">impdp</code>命令，如下：</p><pre class="pre codeblock"><code>REMAP_SCHEMA = C ## <span class="variable" translate="no">common name:local user name</span>
</code></pre></div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="../sutil/oracle-data-pump-export-utility.html#SUTIL-GUID-079769D8-40F4-432F-88AD-E7264D7A2E2D" target="_blank"><span><cite>Oracle数据库实用程序</cite></span></a></li>
                           <li><a href="../sutil/datapump-import-utility.html#SUTIL-GUID-E27D2DC9-A6D8-4F0B-AB72-6BF526B3AA18" target="_blank"><span><cite>Oracle数据库实用程序</cite></span></a></li>
                           <li><a href="../sutil/oracle-data-pump-export-utility.html#SUTIL-GUID-72973E3D-FC0A-47E8-A62A-6DF8AD83138D" target="_blank"><span><cite>Oracle数据库实用程序</cite></span></a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-database-utilities-in-a-cdb.html#GUID-0CE0454A-C192-4075-97D6-5C1333440778" title="Oracle Data Pump技术可以将数据和元数据从一个数据库高速移动到另一个数据库。">在CDB中导入和导出数据</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="SUTIL3926"></a><div class="props_rev_3"><a id="GUID-2555A155-01E3-483E-9FC6-2BDC2D8A4093" name="GUID-2555A155-01E3-483E-9FC6-2BDC2D8A4093"></a><h3 id="MULTI-GUID-2555A155-01E3-483E-9FC6-2BDC2D8A4093" class="sect3"><span class="enumeration_section">21.2</span>在CDB中使用LogMiner</h3>
               <div>
                  <p>您可以在多租户容器数据库（CDB）中使用LogMiner。</p>
                  <p>以下部分讨论了在CDB中使用LogMiner与非CDB时要注意的一些差异：</p>
                  <p>LogMiner支持具有不同字符集的PDB的CDB，前提是根容器具有作为所有PDB的超集的字符集。</p>
                  <p>要管理多租户环境，您必须具有<code class="codeph">CDB_DBA</code>角色。
                  </p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="using-database-utilities-in-a-cdb.html#GUID-945F35C4-1D2D-4F0E-954B-408BBB09EDF0">CDB中的LogMiner V $视图和DBA视图</a><br>在CDB中，LogMiner用于显示有关在系统中运行的LogMiner会话的信息的视图包含一个名为<code class="codeph">CON_ID</code>的附加列。</li>
                     <li class="ulchildlink"><a href="using-database-utilities-in-a-cdb.html#GUID-98AED018-EAF5-4B56-BE6C-F1DEEF8D6B51">CDB中的V $ LOGMNR_CONTENTS视图</a><br>在CDB中， <code class="codeph">V$LOGMNR_CONTENTS</code>视图及其相关功能仅限于根数据库。<code class="codeph">V$LOGMNR_CONTENTS</code>中存在几个支持CDB的新列。
                     </li>
                     <li class="ulchildlink"><a href="using-database-utilities-in-a-cdb.html#GUID-6564DEB6-DE46-4269-BFA0-4797612DE7C0">在CDB中启用补充日志记录</a><br>在CDB中，启用和禁用数据库范围的补充日志记录的语法与非CDB数据库中的语法相同</li>
                     <li class="ulchildlink"><a href="using-database-utilities-in-a-cdb.html#GUID-EF8A932F-7E71-4995-893E-E583B90007C2">在CDB中使用平面文件字典</a><br>您无法在单个平面文件中为整个CDB获取字典快照。您必须连接到不同的PDB，并且只能在平面文件中拍摄该PDB的快照。
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="using-database-utilities-in-a-cdb.html#GUID-FF209AA0-3628-4E33-B155-FDF8FAC60BB6" title="您可以在多租户环境中使用Oracle Data Pump，DBNEWID和Oracle LogMiner等实用程序。">在多租户环境中使用数据库实用程序</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="sect3"><a id="GUID-945F35C4-1D2D-4F0E-954B-408BBB09EDF0" name="GUID-945F35C4-1D2D-4F0E-954B-408BBB09EDF0"></a><h4 id="MULTI-GUID-945F35C4-1D2D-4F0E-954B-408BBB09EDF0" class="sect4"><span class="enumeration_section">21.2.1</span> CDB中的LogMiner V $视图和DBA视图</h4>
                  <div>
                     <p>在CDB中，LogMiner用于显示有关在系统中运行的LogMiner会话的信息的视图包含一个名为<code class="codeph">CON_ID</code>的附加列。</p>
                     <p><code class="codeph">CON_ID</code>列标识与正在显示信息的会话关联的容器ID。从可插拔数据库（PDB）查询视图时，仅显示与数据库关联的信息。以下视图受此新行为的影响：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">V $ LOGMNR_DICTIONARY_LOAD</code>	
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">V $ LOGMNR_LATCH</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">V $ LOGMNR_PROCESS</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">V $ LOGMNR_SESSION</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">V $ LOGMNR_STATS</code></p>
                        </li>
                     </ul>
                     <div class="infoboxnote" id="GUID-945F35C4-1D2D-4F0E-954B-408BBB09EDF0__GUID-98114A40-FAB4-40B7-AE82-FE364F882588">
                        <p class="notep1">注意：</p>
                        <p>为了支持CDB，除了<code class="codeph">CON_ID</code>之外， <code class="codeph">V$LOGMNR_CONTENTS</code>视图还有几个其他新列。</p>
                     </div>
                     <p>以下DBA视图具有类似的CDB视图，其名称以CDB开头。</p>
                     <div class="tblformal" id="GUID-945F35C4-1D2D-4F0E-954B-408BBB09EDF0__LOGMINERDBAANDCDBVIEWSDBAVIEWCDB_VI-FEBFF9B4">
                        <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="LogMiner DBA views and CDB Views " frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="34%" id="d101602e988">日志视图的类型</th>
                                 <th align="left" valign="bottom" width="33%" id="d101602e990">DBA视图</th>
                                 <th align="left" valign="bottom" width="33%" id="d101602e993">CDB视图</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="34%" id="d101602e998" headers="d101602e988 ">LogMiner日志视图</td>
                                 <td align="left" valign="top" width="33%" headers="d101602e998 d101602e990 ">
                                    <p><code class="codeph">DBA_LOGMNR_LOG</code></p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d101602e998 d101602e993 ">
                                    <p><code class="codeph">CDB_LOGMNR_LOG</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="34%" id="d101602e1009" headers="d101602e988 ">LogMiner清除日志视图</td>
                                 <td align="left" valign="top" width="33%" headers="d101602e1009 d101602e990 ">
                                    <p><code class="codeph">DBA_LOGMNR_PURGED_LOG</code></p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d101602e1009 d101602e993 ">
                                    <p><code class="codeph">CDB_LOGMNR_PURGED_LOG</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="34%" id="d101602e1020" headers="d101602e988 ">LogMiner会话日志视图</td>
                                 <td align="left" valign="top" width="33%" headers="d101602e1020 d101602e990 ">
                                    <p><code class="codeph">DBA_LOGMNR_SESSION</code></p>
                                 </td>
                                 <td align="left" valign="top" width="33%" headers="d101602e1020 d101602e993 ">
                                    <p><code class="codeph">CDB_LOGMNR_SESSION</code></p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p>DBA视图仅显示与查询它们的容器中定义的会话相关的信息。</p>
                     <p>CDB视图包含一个额外的<code class="codeph">CON_ID</code>列，用于标识给定行所代表的数据的容器。从根查询CDB视图时，可以使用它们查看有关所有容器的信息。
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-database-utilities-in-a-cdb.html#GUID-2555A155-01E3-483E-9FC6-2BDC2D8A4093" title="您可以在多租户容器数据库（CDB）中使用LogMiner。">在CDB中使用LogMiner</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-98AED018-EAF5-4B56-BE6C-F1DEEF8D6B51" name="GUID-98AED018-EAF5-4B56-BE6C-F1DEEF8D6B51"></a><h4 id="MULTI-GUID-98AED018-EAF5-4B56-BE6C-F1DEEF8D6B51" class="sect4"><span class="enumeration_section">21.2.2</span> CDB中的V $ LOGMNR_CONTENTS视图</h4>
                  <div>
                     <p>在CDB中， <code class="codeph">V$LOGMNR_CONTENTS</code>视图及其相关功能仅限于根数据库。<code class="codeph">V$LOGMNR_CONTENTS</code>中存在几个支持CDB的新列。
                     </p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">CON_ID</code> - 包含与执行查询的容器关联的ID。由于<code class="codeph">V$LOGMNR_CONTENTS</code>仅限于根数据库，因此在CDB上执行查询时，此列将返回值1。</p>
                        </li>
                        <li>
                           <p><code class="codeph">SRC_CON_NAME</code> -  PDB名称。仅当使用LogMiner字典执行挖掘时，此信息才可用。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">SRC_CON_ID</code> - 生成重做记录的PDB的容器ID。仅当使用LogMiner字典执行挖掘时，此信息才可用。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">SRC_CON_DBID</code> -  PDB标识符。仅当使用当前LogMiner字典执行挖掘时，此信息才可用。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">SRC_CON_GUID</code> - 包含与PDB关联的GUID。仅当使用当前LogMiner字典执行挖掘时，此信息才可用。
                           </p>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-database-utilities-in-a-cdb.html#GUID-2555A155-01E3-483E-9FC6-2BDC2D8A4093" title="您可以在多租户容器数据库（CDB）中使用LogMiner。">在CDB中使用LogMiner</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="SUTIL3929"></a><div class="props_rev_3"><a id="GUID-6564DEB6-DE46-4269-BFA0-4797612DE7C0" name="GUID-6564DEB6-DE46-4269-BFA0-4797612DE7C0"></a><h4 id="MULTI-GUID-6564DEB6-DE46-4269-BFA0-4797612DE7C0" class="sect4"><span class="enumeration_section">21.2.3</span>在CDB中启用补充日志记录</h4>
                  <div>
                     <p>在CDB中，启用和禁用数据库范围的补充日志记录的语法与非CDB数据库中的语法相同</p>
                     <div class="section">
                        <p>例如，在添加或删除补充日志数据时使用以下语法：</p><pre class="pre codeblock"><code>ALTER DATABASE [ADD | DROP]补充日志数据......
</code></pre><p>但请注意以下事项：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>在CDB中，CDB上启用了从<code class="codeph">CDB$ROOT</code>启用的补充日志记录级别。</p>
                           </li>
                           <li>
                              <p>如果在<code class="codeph">CDB$ROOT</code>启用了至少最小的补充日志记录，则可以在PDB级别启用其他补充日志记录级别。
                              </p>
                           </li>
                           <li>
                              <p>在CDB级别从<code class="codeph">CDB$ROOT</code>级别启用的补充日志记录级别无法在PDB级别禁用。
                              </p>
                           </li>
                           <li>
                              <p>从<code class="codeph">CDB$ROOT</code>删除所有补充日志记录会禁用<code class="codeph">CDB$ROOT</code>所有补充日志记录，无论以前的PDB级别设置如何。
                              </p>
                           </li>
                        </ul>
                        <p>使用<code class="codeph">CREATE TABLE</code>和<code class="codeph">ALTER TABLE</code>语句启动的补充日志记录操作可以从CDB根目录或PDB执行。它们仅影响应用它们的表。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-database-utilities-in-a-cdb.html#GUID-2555A155-01E3-483E-9FC6-2BDC2D8A4093" title="您可以在多租户容器数据库（CDB）中使用LogMiner。">在CDB中使用LogMiner</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="SUTIL4227"></a><div class="props_rev_3"><a id="GUID-EF8A932F-7E71-4995-893E-E583B90007C2" name="GUID-EF8A932F-7E71-4995-893E-E583B90007C2"></a><h4 id="MULTI-GUID-EF8A932F-7E71-4995-893E-E583B90007C2" class="sect4"><span class="enumeration_section">21.2.4</span>在CDB中使用平面文件字典</h4>
                  <div>
                     <p>您无法在单个平面文件中为整个CDB获取字典快照。您必须连接到不同的PDB，并且只能在平面文件中拍摄该PDB的快照。</p>
                     <p>因此，在使用平面文件字典时，您只能挖掘重做日志以查找与数据字典包含在平面文件中的PDB相关的更改。</p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-database-utilities-in-a-cdb.html#GUID-2555A155-01E3-483E-9FC6-2BDC2D8A4093" title="您可以在多租户容器数据库（CDB）中使用LogMiner。">在CDB中使用LogMiner</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
            <div class="sect2"><a id="GUID-73D5DDC3-F576-4869-A68F-5091DB961B48" name="GUID-73D5DDC3-F576-4869-A68F-5091DB961B48"></a><h3 id="MULTI-GUID-73D5DDC3-F576-4869-A68F-5091DB961B48" class="sect3"><span class="enumeration_section">21.3</span> CDB和PDB的DBNEWID注意事项</h3>
               <div>
                  <p>DBNEWID参数<code class="codeph">PDB</code>允许您更改可插拔数据库（PDB）上的DBID。
                  </p>
                  <p>默认情况下，在容器数据库（CDB）上运行DBNEWID实用程序时，它仅更改CDB的DBID;包含CDB的可插拔数据库（PDB）的DBID保持不变。在某些情况下，例如克隆CDB时，这可能会导致PDB的重复DBID出现问题。</p>
                  <p>从Oracle Database 12 <span class="italic">c</span>第2版（12.2）开始，您可以使用新的DBNEWID <code class="codeph">PDB</code>参数更改PDB上的DBID。您无法指定特定的PDB;要么全部，要么都没有新的DBID。<code class="codeph">PDB</code>参数仅适用于CDB环境。它具有以下格式：</p><pre class="pre codeblock"><code>PDB = [ALL |没有]</code></pre><ul style="list-style-type:disc">
                     <li>
                        <p>如果指定<code class="codeph">ALL</code> ，则除了CDB更改的DBID之外，还会更改包含CDB的所有PDB的DBID。
                        </p>
                     </li>
                     <li>
                        <p>即使CDB DBID已更改，指定<code class="codeph">NONE</code> （默认值）也会使PDB DBID保持不变。
                        </p>
                     </li>
                  </ul>
                  <p>Oracle建议您使用<code class="codeph">PDB=ALL</code> ，但出于向后兼容性原因， <code class="codeph">PDB=NONE</code>是默认值。
                  </p>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="using-database-utilities-in-a-cdb.html#GUID-FF209AA0-3628-4E33-B155-FDF8FAC60BB6" title="您可以在多租户环境中使用Oracle Data Pump，DBNEWID和Oracle LogMiner等实用程序。">在多租户环境中使用数据库实用程序</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
         </div>
      </article>
   </body>
</html>