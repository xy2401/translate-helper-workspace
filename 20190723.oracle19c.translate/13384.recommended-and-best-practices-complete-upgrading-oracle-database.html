<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="Oracle recommends that you complete these good practices guidelines for updating Oracle Database. These practices are recommended for both manual and DBUA upgrades."></meta>
      <meta name="description" content="Oracle recommends that you complete these good practices guidelines for updating Oracle Database. These practices are recommended for both manual and DBUA upgrades."></meta>
      <title>升级Oracle数据库后需要完成的推荐和最佳实践</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Database Upgrade Guide"></meta>
      <meta property="og:description" content="Oracle recommends that you complete these good practices guidelines for updating Oracle Database. These practices are recommended for both manual and DBUA upgrades."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Database Upgrade Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="database-upgrade-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-04-25T08:26:31-07:00"></meta>
      <meta name="dcterms.title" content="Database Upgrade Guide"></meta>
      <meta name="dcterms.dateCopyrighted" content="1996, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96252-05"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="required-tasks-complete-upgrading-oracle-database.html" title="Previous" type="text/html"></link>
      <link rel="next" href="recommended-tasks-after-upgrade-oracle-rac.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="UPGRD"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="required-tasks-complete-upgrading-oracle-database.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="recommended-tasks-after-upgrade-oracle-rac.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">数据库升级指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="post-upgrade-tasks-oracle-database.html" property="item" typeof="WebPage"><span property="name">Oracle数据库的升级后任务</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">升级Oracle数据库后需要完成的推荐和最佳实践</li>
            </ol>
            <a id="GUID-5196CE88-8669-45D6-8906-C45272940740" name="GUID-5196CE88-8669-45D6-8906-C45272940740"></a><a id="UPGRD12432"></a>
            
            <h2 id="UPGRD-GUID-5196CE88-8669-45D6-8906-C45272940740" class="sect2">升级Oracle数据库后需要完成的推荐和最佳实践</h2>
         </header>
         <div class="ind">
            <div>
               <p>Oracle建议您完成这些更新Oracle数据库的良好实践指南。建议手动和DBUA升级使用这些做法。</p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="recommended-and-best-practices-complete-upgrading-oracle-database.html#GUID-AA7E76B0-1571-4F24-A65D-756602A814B9">备份数据库</a><br>执行生产数据库的完整备份。
                  </li>
                  <li class="ulchildlink"><a href="recommended-and-best-practices-complete-upgrading-oracle-database.html#GUID-54415206-25BF-46EE-BAF4-1AA6FCEB90B2">运行Postupgrade修复脚本</a><br>查看此过程以了解如何对CDB和非CDB数据库使用<code>postupgrade_fixups.sql</code>脚本。
                  </li>
                  <li class="ulchildlink"><a href="recommended-and-best-practices-complete-upgrading-oracle-database.html#GUID-8AF2DB10-9746-4938-B69F-D1F3890BEAF5">升级后收集字典统计信息</a><br>为了确保良好的性能，请在完成升级后使用此过程收集字典统计信息。
                  </li>
                  <li class="ulchildlink"><a href="recommended-and-best-practices-complete-upgrading-oracle-database.html#GUID-44B9B605-8FFE-4FFD-89A0-105CE4C4939E">使用DBMS_STATS重新收集固定对象统计信息</a><br>升级后或其他数据库配置更改后，Oracle强烈建议您在Oracle数据库上运行代表性工作负载后重新收集固定对象统计信息。
                  </li>
                  <li class="ulchildlink"><a href="recommended-and-best-practices-complete-upgrading-oracle-database.html#GUID-082A0965-7898-4D84-885C-24BEE2493FC4">重置密码以强制区分大小写</a><br>对于升级的数据库，通过对默认用户帐户和用户帐户使用区分大小写的密码来提高安全性。
                  </li>
                  <li class="ulchildlink"><a href="recommended-and-best-practices-complete-upgrading-oracle-database.html#GUID-D7B09DFE-F55D-449A-8F8A-174D89936304">查找和重置使用10G密码版本的用户密码</a><br>为了更好的安全性，请查找和重置使用<code class="codeph">10G</code>密码版本的用户帐户的密码，以便他们使用更安全的密码版本。
                  </li>
                  <li class="ulchildlink"><a href="recommended-and-best-practices-complete-upgrading-oracle-database.html#GUID-D7793765-AF4C-4091-BCCB-E5720FDE0EF4">了解Oracle Grid Infrastructure，Oracle ASM和Oracle Clusterware</a><br>Oracle Clusterware和Oracle自动存储管理（Oracle ASM）都是Oracle Grid Infrastructure安装的一部分。
                  </li>
                  <li class="ulchildlink"><a href="recommended-and-best-practices-complete-upgrading-oracle-database.html#GUID-4266E383-39F3-4858-9A67-D11CCD664C88">Oracle Grid Infrastructure安装和升级以及Oracle ASM</a><br>Oracle ASM随Oracle Grid Infrastructure一起安装。
                  </li>
                  <li class="ulchildlink"><a href="recommended-and-best-practices-complete-upgrading-oracle-database.html#GUID-128BB0D3-0739-4631-8283-F667302DCBF1">添加适当的新功能</a><br>在数据库升级计划中查看新功能。
                  </li>
                  <li class="ulchildlink"><a href="recommended-and-best-practices-complete-upgrading-oracle-database.html#GUID-36C4A570-B944-4E0E-B754-EBC04CC4F07C">根据需要制定新的行政程序</a><br>计划对脚本和过程的审核，并根据需要进行更改。
                  </li>
                  <li class="ulchildlink"><a href="recommended-and-best-practices-complete-upgrading-oracle-database.html#GUID-0A27E3EA-B320-4DED-8587-9ED5E3DAAEC3">设置表空间警报的阈值</a><br>升级后，已升级的Oracle数据库表空间警报的阈值将设置为null，从而禁用警报。
                  </li>
                  <li class="ulchildlink"><a href="recommended-and-best-practices-complete-upgrading-oracle-database.html#GUID-7BBB2D85-E8FB-437B-BA21-6D08A04BB7AE">从回滚段迁移到自动撤消模式</a><br>如果数据库版本早于Oracle Database <span class="italic">11g</span> ，则必须将正在升级的数据库从使用回滚段（手动撤消管理）迁移到自动撤消管理。
                  </li>
                  <li class="ulchildlink"><a href="recommended-and-best-practices-complete-upgrading-oracle-database.html#GUID-07FE428B-C14E-4457-9A8E-04964D52B49E">将表从LONG数据类型迁移到LOB数据类型</a><br>您可以使用<code class="codeph">ALTER TABLE</code>语句将<code class="codeph">LONG</code>列的数据类型更改为<code class="codeph">CLOB</code> ，将<code class="codeph">LONG RAW</code>列的数据类型更改为<code class="codeph">BLOB</code> 。</li>
                  <li class="ulchildlink"><a href="recommended-and-best-practices-complete-upgrading-oracle-database.html#GUID-EB285325-CA65-41B4-BE58-D3F69CFED789">迁移升级的Oracle数据库以使用统一审核</a><br>要使用统一审核的全部功能，必须手动迁移到统一审核。
                  </li>
                  <li class="ulchildlink"><a href="recommended-and-best-practices-complete-upgrading-oracle-database.html#GUID-7A5E0A01-7711-4EEA-88DD-EECF16B9A6F7">确定重建的Oracle文本索引</a><br>您可以运行一个脚本，帮助您识别带有令牌表的Oracle Text索引索引，这些令牌表可以在升级到新的Oracle数据库发行版后重建。
                  </li>
                  <li class="ulchildlink"><a href="recommended-and-best-practices-complete-upgrading-oracle-database.html#GUID-9FF51E36-BD45-429F-8E4D-25FA9F0574D0">删除和重新创建DBMS_SCHEDULER作业</a><br>如果从早期版本升级后DBMS_SCHEDULER作业不起作用，请删除并重新创建作业。
                  </li>
                  <li class="ulchildlink"><a href="recommended-and-best-practices-complete-upgrading-oracle-database.html#GUID-4BC5F146-BF0D-4BCF-8A0B-1B67B767EEF1">升级后传输Unified Audit记录</a><br>查看这些主题以了解在升级和迁移到统一审核后如何获得更好的性能</li>
                  <li class="ulchildlink"><a href="recommended-and-best-practices-complete-upgrading-oracle-database.html#GUID-F2334FB4-3FE6-4B75-A5DE-2FE2F9A4C8E4">关于测试升级的生产Oracle数据库</a><br>对您在测试数据库上执行的生产数据库重复测试，以确保应用程序按预期运行。
                  </li>
               </ul>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>父主题：</strong> <a href="post-upgrade-tasks-oracle-database.html#GUID-637ADBD0-866B-4B64-9513-4C7CDE84895C" title="升级Oracle数据库后，完成所需的升级后任务，并考虑新版本的建议。">Oracle数据库的升级后任务</a></p>
                  </div>
               </div>
            </div>
            <a id="UPGRD12433"></a><div class="props_rev_3"><a id="GUID-AA7E76B0-1571-4F24-A65D-756602A814B9" name="GUID-AA7E76B0-1571-4F24-A65D-756602A814B9"></a><h3 id="UPGRD-GUID-AA7E76B0-1571-4F24-A65D-756602A814B9" class="sect3">备份数据库</h3>
               <div>
                  <p>执行生产数据库的完整备份。</p>
                  <p>虽然不需要此步骤，但Oracle强烈建议您备份生产数据库。</p>
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-AA7E76B0-1571-4F24-A65D-756602A814B9__GUID-C894FC76-EC11-4F9C-B941-AB5B7CDA4A40">
                     <p class="notep1">也可以看看：</p>
                     <p>有关使用RMAN备份数据库的详细信息，请参见<a href="../bradv/backing-up-database.html#BRADV8003" target="_blank"><span class="italic">“Oracle数据库备份和恢复用户指南”</span></a></p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="recommended-and-best-practices-complete-upgrading-oracle-database.html#GUID-5196CE88-8669-45D6-8906-C45272940740" title="Oracle建议您完成这些更新Oracle数据库的良好实践指南。建议手动和DBUA升级使用这些做法。">升级Oracle数据库后要完成的建议和最佳实践</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="UPGRD60140"></a><div class="props_rev_3"><a id="GUID-54415206-25BF-46EE-BAF4-1AA6FCEB90B2" name="GUID-54415206-25BF-46EE-BAF4-1AA6FCEB90B2"></a><h3 id="UPGRD-GUID-54415206-25BF-46EE-BAF4-1AA6FCEB90B2" class="sect3">运行Postupgrade修复脚本</h3>
               <div>
                  <p>查看此过程以了解如何对CDB和非CDB数据库使用<code>postupgrade_fixups.sql</code>脚本。
                  </p>
                  <p>运行升级前信息工具（ <code>preupgrade.jar</code> ）时会生成升级后修订脚本。完成升级后，随时运行postupgrade脚本。对于具有可插拔数据库（PDB）和非CDB数据库的容器数据库（CDB），升级后修订脚本提供常规警告，错误和信息建议。
                  </p>
                  <p>您可以使用<code>catcon.pl</code>实用程序或使用SQL * Plus来运行脚本。
                  </p>
                  <p>升级后SQL脚本和日志文件的位置取决于您设置输出文件夹的方式，或者定义Oracle基本环境变量。升级后修复脚本与预升级修订脚本放在同一目录路径中。</p>
                  <p>如果使用<code>dir</code>选项和升级前信息工具指定输出目录，则输出日志和文件将放在文件路径/ <code>cfgtoollogs/ <span class="variable" translate="no">dbunique_name</span> /preupgrade</code>中的该目录下，其中<code class="codeph"><span class="variable" translate="no">dbunique_name</span></code>是源Oracle的名称数据库。如果在运行升级前信息工具时未指定输出目录，则输出将定向到以下默认位置之一：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>如果未使用<code class="codeph">DIR</code>指定输出目录，但已设置Oracle基本环境变量，则会在以下文件路径中创建生成的脚本和日志文件：</p>
                        <p><code><span class="variable" translate="no">Oracle-base</span> / cfgtoollogs / <span class="variable" translate="no">dbunique_name</span> / preupgrade</code></p>
                     </li>
                     <li>
                        <p>如果未指定输出目录，并且尚未定义Oracle基本环境变量，则会在以下文件路径中创建生成的脚本和日志文件：</p>
                        <p><code class="codeph"><span class="variable" translate="no">Oracle-home</span> / cfgtoollogs / <span class="variable" translate="no">dbunique_name</span> / preupgrade</code></p>
                     </li>
                  </ul>
                  <p>升级前信息工具创建的升级后修复脚本取决于源数据库是非CDB数据库还是CDB数据库：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>非CDB： <code>postupgrade_fixups.sql</code></p>
                     </li>
                     <li>
                        <p>CDB：两套不同的脚本：</p>
                        <ol>
                           <li>
                              <p><code class="codeph">postupgrade_fixups.sql</code> ：所有PDB的合并脚本</p>
                           </li>
                           <li>
                              <p>多<code class="codeph">postupgrade_fixups_ <span class="variable" translate="no">pdbname</span> .sql</code>脚本，其中<code class="codeph"><span class="variable" translate="no">pdbname</span></code>是为其生成一个脚本的PDB名称：个人脚本，您具体的PDBS运行。
                              </p>
                           </li>
                        </ol>
                     </li>
                  </ul>
                  <div class="example" id="GUID-54415206-25BF-46EE-BAF4-1AA6FCEB90B2__GUID-937F7531-9CE0-469C-868D-376E426A8C73">
                     <p class="titleinexample">示例5-6非CDB Oracle数据库的后续升级修复结果的假脱机示例</p>
                  </div>
                  <!-- class="example" -->
                  <p>将系统设置为假脱机结果到日志文件，以便您可以读取输出。但是，不要假脱机到<code>admin</code>目录：</p><pre class="pre codeblock"><code>SQL&gt; SPOOL postupgrade.log SQL&gt; @ postupgrade_fixups.sql SQL&gt; SPOOL OFF</code></pre><p>关闭脚本结果的假脱机到日志文件：</p><pre class="pre codeblock"><code>SQL&gt; SPOOL OFF</code></pre><div class="example" id="GUID-54415206-25BF-46EE-BAF4-1AA6FCEB90B2__GUID-F37689DB-C603-421F-B07B-6395E1AFAF1D">
                     <p class="titleinexample">示例5-7使用catcon.pl运行升级后修复的示例在Linux，UNIX和Windows系统上</p>
                     <p>在本节的示例中， <code class="codeph">catcon</code>命令在CDB数据库的所有容器中运行<code class="codeph">postupgrade_fixups.sql</code> 。在运行此命令之前，必须确保为UNIX和Linux环境设置操作系统环境变量ORACLE_HOME和ORACLE_SID，并确保为Windows环境设置其等效项。在以下示例中， <code class="codeph">sales1</code>是目标数据库的唯一名称。
                     </p>
                     <p>Linux和UNIX环境：</p><pre class="pre codeblock"><code>$ ORACLE_HOME / perl / bin / perl -I $ ORACLE_HOME / perl / lib -I $ ORACLE_HOME / rdbms / admin $ ORACLE_HOME / rdbms / admin / catcon.pl -l / home / oracle / here / -b postupg / cfgtoollogs / sales1 /preupgrade/postupgrade_fixups.sql</code></pre><p>Windows环境：</p><pre class="pre codeblock"><code>％ORACLE_HOME％\ perl \ bin \ perl -I％ORACLE_HOME％\ perl \ lib -I％ORACLE_HOME％\ rdbms \ admin％ORACLE_HOME％\ rdbms \ admin \ catcon.pl -lc：\ tmp \ logdir \ -b postupg c ：\ cfgtoollogs \销售额1 \升级前\ postupgrade_fixups.sql</code></pre><p>在此Windows示例中，命令选项<code class="codeph">-l</code>在文件路径<code>c:/tmp/logdir/</code>下创建日志，并将postupgrade脚本的输出放入该目录中。选项<code class="codeph">-b</code>在输出文件上设置<code class="codeph">postupg</code>前缀。
                     </p>
                     <div class="infoboxnote" id="GUID-54415206-25BF-46EE-BAF4-1AA6FCEB90B2__GUID-1B12FFE4-D041-4211-8430-11CE21E65053">
                        <p class="notep1">注意：</p>
                        <p>您必须按照这些示例中显示的顺序输入<code class="codeph">catcon</code>参数。
                        </p>
                     </div>
                  </div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="recommended-and-best-practices-complete-upgrading-oracle-database.html#GUID-5196CE88-8669-45D6-8906-C45272940740" title="Oracle建议您完成这些更新Oracle数据库的良好实践指南。建议手动和DBUA升级使用这些做法。">升级Oracle数据库后要完成的建议和最佳实践</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-8AF2DB10-9746-4938-B69F-D1F3890BEAF5" name="GUID-8AF2DB10-9746-4938-B69F-D1F3890BEAF5"></a><h3 id="UPGRD-GUID-8AF2DB10-9746-4938-B69F-D1F3890BEAF5" class="sect3">升级后收集字典统计信息</h3>
               <div>
                  <p>为了确保良好的性能，请在完成升级后使用此过程收集字典统计信息。</p>
                  <div class="section">
                     <p>Oracle建议您在升级数据库之前和之后收集字典统计信息，因为在升级期间会修改和创建数据字典表。对于Oracle Database 12 <span class="italic">c第</span> 2版（12.2）及更高版本，当您以正常模式启动数据库时，可以在升级后将统计信息收集为手动过程。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-8AF2DB10-9746-4938-B69F-D1F3890BEAF5__GUID-89186456-922B-4682-AB96-4154AF51FF98">
                     <ul style="list-style-type:disc">
                        <li>
                           <p>非CDB Oracle数据库：Oracle建议您使用<code class="codeph">DBMS_STATS.GATHER_DICTIONARY_STATS</code>过程来收集这些统计信息。例如，输入以下SQL语句：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; EXEC DBMS_STATS.GATHER_DICTIONARY_STATS;</pre></li>
                        <li>
                           <p>CDB：Oracle建议您使用<code>catcon</code>在整个多租户架构中收集数据字典统计信息</p>
                           <p>要收集容器数据库中所有PDB的字典统计信息，请使用以下语法</p>
                           <p><code class="codeph">$ ORACLE_HOME / perl / bin / perl $ ORACLE_HOME / rdbms / admin / catcon.pl -l / tmp -b gatherstats  -  --x“exec dbms_stats.gather_dictionary_stats”</code></p>
                           <p>要收集特定PDB上的字典统计信息，请使用类似于以下内容的语法：</p><pre class="pre codeblock"><code>$ ORACLE_HOME / perl / bin / perl $ ORACLE_HOME / rdbms / admin / catcon.pl -l / tmp -c'SALES1'-b gatherstats  -  --x“exec dbms_stats.gather_dictionary_stats”</code></pre><p>在前面的示例中， <code class="codeph">-c SALES1</code>选项为您运行的命令指定PDB包含列表，指定名为<code class="codeph">SALES1</code>的数据库。选项<code class="codeph">-b gatherstats</code>指定日志的基本名称。选项<code class="codeph">--x</code>指定要执行的SQL命令。SQL命令本身在引号内。
                           </p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="../arpls/DBMS_STATS.html#ARPLS-GUID-867989C7-ADFC-4464-8981-437CEA7F331E" target="_blank"><span><cite>Oracle数据库PL / SQL包和类型参考</cite></span></a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="recommended-and-best-practices-complete-upgrading-oracle-database.html#GUID-5196CE88-8669-45D6-8906-C45272940740" title="Oracle建议您完成这些更新Oracle数据库的良好实践指南。建议手动和DBUA升级使用这些做法。">升级Oracle数据库后要完成的建议和最佳实践</a></p>
                     </div>
                  </div>
               </div>
            </div><a id="UPGRD60056"></a><div class="props_rev_3"><a id="GUID-44B9B605-8FFE-4FFD-89A0-105CE4C4939E" name="GUID-44B9B605-8FFE-4FFD-89A0-105CE4C4939E"></a><h3 id="UPGRD-GUID-44B9B605-8FFE-4FFD-89A0-105CE4C4939E" class="sect3">使用DBMS_STATS重新收集固定对象统计信息</h3>
               <div>
                  <p>升级后或其他数据库配置更改后，Oracle强烈建议您在Oracle数据库上运行代表性工作负载后重新收集固定对象统计信息。</p>
                  <p>固定对象是<code class="codeph">X$</code>表及其索引。<code class="codeph">V$</code>性能视图通过<code class="codeph">X$</code>表定义。收集固定对象统计信息对于数据库性能很有价值，因为这些统计信息可帮助优化器生成良好的执行计划，从而提高数据库性能。未能获得具有代表性的统计数据可能会导致执行计划不理想，从而导致严重的性能问题。
                  </p>
                  <p>使用<code class="codeph">DBMS_STATS.GATHER_FIXED_OBJECTS_STATS</code> PL / SQL过程收集固定对象统计信息。<code class="codeph">DBMS_STATS.GATHER_FIXED_OBJECTS_STATS</code>还显示有关从<code class="codeph">INIT.ORA</code>或<code class="codeph">SPFILE</code>删除所有隐藏或下划线参数和事件的建议。</p>
                  <p>由于<code class="codeph">X$</code>表的瞬态特性，当系统上存在代表性工作负载时，您必须收集固定对象统计信息。如果在高峰加载期间无法收集固定对象统计信息，则Oracle建议您在系统处于运行时状态后执行此操作，并填充最重要类型的固定对象表。
                  </p>
                  <p>要收集固定对象的统计信息，请运行以下PL / SQL过程：</p><pre class="pre codeblock"><code>SQL&gt; execute dbms_stats.gather_fixed_objects_stats;</code></pre></div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="recommended-and-best-practices-complete-upgrading-oracle-database.html#GUID-5196CE88-8669-45D6-8906-C45272940740" title="Oracle建议您完成这些更新Oracle数据库的良好实践指南。建议手动和DBUA升级使用这些做法。">升级Oracle数据库后要完成的建议和最佳实践</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="UPGRD12434"></a><div class="props_rev_3"><a id="GUID-082A0965-7898-4D84-885C-24BEE2493FC4" name="GUID-082A0965-7898-4D84-885C-24BEE2493FC4"></a><h3 id="UPGRD-GUID-082A0965-7898-4D84-885C-24BEE2493FC4" class="sect3">重置密码以强制区分大小写</h3>
               <div>
                  <p>对于升级的数据库，通过对默认用户帐户和用户帐户使用区分大小写的密码来提高安全性。</p>
                  <p>为了提高安全性，Oracle建议您在密码中启用区分大小写。区分大小写通过要求用户输入正确的密码字符串以及该字符串中每个字符的正确大小写来增加密码的安全性。例如，如果密码为<code class="codeph">hpp5620QR</code>或<code class="codeph">hPp5620Qr</code> ，则密码<code class="codeph">hPP5620qr</code>失败。
                  </p>
                  <p>要保护数据库，请以安全的方式创建密码。如果数据库中有默认密码，请更改这些密码。默认情况下，更改密码时会强制执行区分大小写。每个密码都应满足Oracle建议的密码要求，包括预定义用户帐户的密码。</p>
                  <p>对于升级后创建的新数据库，不存在其他任务或管理要求。</p>
                  <div class="section">
                     <p class="subhead2" id="GUID-082A0965-7898-4D84-885C-24BEE2493FC4__GUID-740E30B5-5F61-43FF-B1F1-420A5BC30044">密码更改的现有数据库要求和指南</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>如果Oracle Database 12 <span class="italic">c第</span> 1版（12.1）及更高版本的默认安全设置已就绪，则密码必须至少为8个字符，并且不允许使用<code class="codeph">welcome</code>和<code class="codeph">oracle</code>等密码。
                           </p>
                        </li>
                        <li>
                           <p>不推荐使用<code class="codeph">IGNORECASE</code>参数。不要使用此参数。
                           </p>
                        </li>
                        <li>
                           <p>对于现有数据库，要利用密码区分大小写，必须在数据库升级过程中重置现有用户的密码。使用<code class="codeph">ALTER</code> <code class="codeph">USER</code>语句重置每个现有数据库用户的密码。
                           </p>
                        </li>
                        <li>
                           <p>查询<code class="codeph">DBA_USERS</code>的<code class="codeph">PASSWORD_VERSIONS</code>列以查找仅具有10G密码版本的帐户的<code class="codeph">USERNAME</code> ，并且没有<code class="codeph">11G</code>或<code class="codeph">12C</code>密码版本。重置任何只有<code class="codeph">10G</code>密码版本的帐户的密码。
                           </p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-082A0965-7898-4D84-885C-24BEE2493FC4__GUID-B81A62C3-0233-4146-A541-8DB88AF5B18E">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>有关密码区分大小写的更多信息，请<a href="../dbseg/configuring-authentication.html#DBSEG3225" target="_blank"><span class="italic">参见“Oracle数据库安</span></a></p>
                        </li>
                        <li>
                           <p>有关密码强度的详细信息，请参见<a href="../dbseg/keeping-your-oracle-database-secure.html#DBSEG10005" target="_blank"><span class="italic">“Oracle数据库安</span></a></p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="recommended-and-best-practices-complete-upgrading-oracle-database.html#GUID-5196CE88-8669-45D6-8906-C45272940740" title="Oracle建议您完成这些更新Oracle数据库的良好实践指南。建议手动和DBUA升级使用这些做法。">升级Oracle数据库后要完成的建议和最佳实践</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="props_rev_3"><a id="GUID-D7B09DFE-F55D-449A-8F8A-174D89936304" name="GUID-D7B09DFE-F55D-449A-8F8A-174D89936304"></a><h3 id="UPGRD-GUID-D7B09DFE-F55D-449A-8F8A-174D89936304" class="sect3">查找和重置使用10G密码版本的用户密码</h3>
               <div>
                  <p>为了更好的安全性，请查找和重置使用<code class="codeph">10G</code>密码版本的用户帐户的密码，以便他们使用更安全的密码版本。
                  </p>
                  <div class="section"></div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-D7B09DFE-F55D-449A-8F8A-174D89936304__GUID-BE07FE9A-817E-4E9F-A704-6E9EC4AB5C28">查找当前用户的所有密码版本</p>
                     <p>您可以查询<code class="codeph">DBA_USERS</code>数据字典视图，以查找为用户帐户配置的所有密码版本的列表。
                     </p>
                     <p>例如：</p><pre class="pre codeblock"><code>来自DBA_USERS的SELECT USERNAME，PASSWORD_VERSIONS; USERNAME PASSWORD_VERSIONS ------------------------------ ----------------- JONES 10G 11G 12C ADAMS 10G 11G CLARK 10G 11G PRESTON 11G BLAKE 10G</code></pre><p><code class="codeph">PASSWORD_VERSIONS</code>列显示该帐户存在的密码版本列表。<code class="codeph">10G</code>是指早期不区分大小写的Oracle密码版本， <code class="codeph">11G</code>是指基于SHA-1的密码版本， <code class="codeph">12C</code>是指基于SHA-2的SHA-512密码版本。
                     </p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>用户<code class="codeph">jones</code> ：当<code class="codeph">SQLNET.ALLOWED_LOGON_VERSION_SERVER</code>参数设置为<code class="codeph">8</code>时，在Oracle Database 12 <span class="italic">c</span>版本12.1中重置了此用户的密码。这样就可以创建所有三个密码版本。
                           </p>
                        </li>
                        <li>
                           <p>用户<code class="codeph">adams</code>和<code class="codeph">clark</code> ：这些帐户的密码最初是在Oracle Database <span class="italic">10g中</span>创建的，然后在Oracle Database <span class="italic">11g中</span>重置。Oracle Database <span class="italic">11g</span>软件当时使用的默认<code class="codeph">SQLNET.ALLOWED_LOGON_VERSION</code>设置为<code class="codeph">8</code> 。由于默认情况下启用了大小写不敏感，因此它们的密码现在区分大小写， <code class="codeph">preston</code>的密码也是如此。
                           </p>
                        </li>
                        <li>
                           <p>用户<code class="codeph">preston</code> ：此帐户是从以独占模式（ <code class="codeph">SQLNET.ALLOWED_LOGON_VERSION = 12</code> ）运行的Oracle Database 11 <span class="italic">g</span>数据库导入的。
                           </p>
                        </li>
                        <li>
                           <p>用户<code class="codeph">blake</code> ：此帐户仍使用Oracle Database 10 <span class="italic">g</span>密码版本。在此阶段，阻止用户<code class="codeph">blake</code>登录。
                           </p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-D7B09DFE-F55D-449A-8F8A-174D89936304__GUID-D3A60C27-423E-4541-8BDE-EBED59B91382">重置使用10G密码版本的用户密码</p>
                     <p>为了更好的安全性，请从所有用户的帐户中删除<code class="codeph">10G</code>密码版本。在以下过程中，要重置具有<code class="codeph">10G</code>密码版本的用户的密码，必须暂时放松<code class="codeph">SQLNET.ALLOWED_LOGON_VERSION_SERVER</code>设置，该设置在允许登录之前控制客户端所需的能力级别。放宽设置使这些用户能够登录并更改其密码，从而生成除<code class="codeph">10G</code>密码版本之外的新密码版本。之后，您可以将数据库设置为使用独占模式，并确保客户端具有<code class="codeph">O5L_NP</code>功能。然后用户可以再次重置他们的密码，以便他们的密码版本不再包含<code class="codeph">10G</code> ，但只有更安全的<code class="codeph">11G</code>和<code class="codeph">12C</code>密码版本。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand" id="GUID-D7B09DFE-F55D-449A-8F8A-174D89936304__QUERYTHEDBA_USERSVIEWTOFINDUSERSWHO-4DFAFF23"><span>查询<code class="codeph">DBA_USERS</code>视图以查找仅使用<code class="codeph">10G</code>密码版本的用户。</span><div><pre class="oac_no_warn" dir="ltr">从DBA_USERS WHERE中选择USERNAME（PASSWORD_VERSIONS ='10G'或PASSWORD_VERSIONS ='10G HTTP'）和USERNAME &lt;&gt;'ANONYMOUS';</pre></div>
                     </li>
                     <li class="stepexpand"><span>配置数据库，使其不以独占模式运行，如下所示：</span><ol type="a">
                           <li class="substepexpand"><span>编辑<code class="codeph">sqlnet.ora</code>文件中的<code class="codeph">SQLNET.ALLOWED_LOGON_VERSION_SERVER</code>设置，使其比默认值更宽松。例如：</span><div><pre class="oac_no_warn" dir="ltr">SQLNET.ALLOWED_LOGON_VERSION_SERVER = 11</pre></div>
                           </li>
                           <li class="substepexpand"><span>重启数据库。</span></li>
                        </ol>
                     </li>
                     <li class="stepexpand"><span>使您在查询<code class="codeph">DBA_USERS</code>视图时找到的用户过期，以查找仅使用<code class="codeph">10G</code>密码版本的用户。</span><div>
                           <p>您必须使仅具有<code class="codeph">10G</code>密码版本且没有<code class="codeph">11G</code>或<code class="codeph">12C</code>密码版本中的一个或两个的用户到期。
                           </p>
                           <p>例如：</p><pre class="pre codeblock"><code>ALTER USER用户<span class="variable" translate="no">username</span> PASSWORD EXPIRE;</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>询问您过期密码的用户是否登录。</span><div>
                           <p>当用户登录时，系统会提示他们更改密码。除<code class="codeph">10G</code>密码版本外，数据库还为其帐户生成缺少的<code class="codeph">11G</code>和<code class="codeph">12C</code>密码版本。<code class="codeph">10G</code>密码版本继续存在，因为数据库正在以许可模式运行。
                           </p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>确保用户连接的客户端软件具有<code class="codeph">O5L_NP</code>功能。</span><div>
                           <p>所有Oracle Database 11.2.0.3及更高版本的客户端都具有<code class="codeph">O5L_NP</code>功能。如果您有早期的Oracle数据库客户端，则必须安装CPUOct2012补丁。
                           </p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>在所有客户端都具有<code class="codeph">O5L_NP</code>功能后，将服务器的安全性设置回“独占模式”，如下所示：</span><ol type="a">
                           <li class="substepexpand"><span>从实例初始化文件中删除<code class="codeph">SEC_CASE_SENSITIVE_LOGON</code>参数设置，或将<code class="codeph">SEC_CASE_SENSITIVE_LOGON</code>设置为<code class="codeph">TRUE</code> 。</span><div><pre class="oac_no_warn" dir="ltr">SEC_CASE_SENSITIVE_LOGON = TRUE</pre></div>
                           </li>
                           <li class="substepexpand"><span>卸下<code class="codeph">SQLNET.ALLOWED_LOGON_VERSION_SERVER</code>从服务器参数<code class="codeph">sqlnet.ora</code>文件，或设置的值<code class="codeph">SQLNET.ALLOWED_LOGON_VERSION_SERVER</code>在服务器<code class="codeph">sqlnet.ora</code>文件返回到<code class="codeph">12</code> ，将其设置为独占模式。</span><div><pre class="oac_no_warn" dir="ltr">SQLNET.ALLOWED_LOGON_VERSION_SERVER = 12</pre></div>
                           </li>
                           <li class="substepexpand"><span>重启数据库。</span></li>
                        </ol>
                     </li>
                     <li class="stepexpand"><span>找到仍具有<code class="codeph">10G</code>密码版本的帐户。</span><div><pre class="oac_no_warn" dir="ltr">从DBA_USERS中选择USERNAME，其中PASSWORD_VERSIONS类似'％10G％'和USERNAME &lt;&gt;'ANONYMOUS';</pre></div>
                     </li>
                     <li class="stepexpand"><span>使仍具有<code class="codeph">10G</code>密码版本的帐户过期。</span><div><pre class="oac_no_warn" dir="ltr">ALTER USER用户<span class="variable" translate="no">username</span> PASSWORD EXPIRE;</pre></div>
                     </li>
                     <li class="stepexpand"><span>要求这些用户登录其帐户。</span><div>
                           <p>当用户登录时，系统会提示他们重置密码。然后，数据库仅为其帐户生成<code class="codeph">11G</code>和<code class="codeph">12C</code>密码版本。由于数据库以独占模式运行，因此不再生成<code class="codeph">10G</code>密码版本。
                           </p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>重新运行以下查询：</span><div><pre class="oac_no_warn" dir="ltr">从DBA_USERS中选择USERNAME，其中PASSWORD_VERSIONS类似'％10G％'和USERNAME &lt;&gt;'ANONYMOUS';</pre></div>
                        <div>
                           <p>如果此查询未返回任何结果，则表示没有用户帐户具有<code class="codeph">10G</code>密码版本。因此，数据库以比以前版本更安全的模式运行。
                           </p>
                        </div>
                     </li>
                  </ol>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="recommended-and-best-practices-complete-upgrading-oracle-database.html#GUID-5196CE88-8669-45D6-8906-C45272940740" title="Oracle建议您完成这些更新Oracle数据库的良好实践指南。建议手动和DBUA升级使用这些做法。">升级Oracle数据库后要完成的建议和最佳实践</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="UPGRD52685"></a><div class="props_rev_3"><a id="GUID-D7793765-AF4C-4091-BCCB-E5720FDE0EF4" name="GUID-D7793765-AF4C-4091-BCCB-E5720FDE0EF4"></a><h3 id="UPGRD-GUID-D7793765-AF4C-4091-BCCB-E5720FDE0EF4" class="sect3">了解Oracle Grid Infrastructure，Oracle ASM和Oracle Clusterware</h3>
               <div>
                  <p>Oracle Clusterware和Oracle自动存储管理（Oracle ASM）都是Oracle Grid Infrastructure安装的一部分。</p>
                  <p>如果为单个服务器安装了Oracle Grid Infrastructure，则将其部署为Oracle ASM的Oracle Restart安装。如果为群集安装了Oracle Grid Infrastructure，则将其部署为Oracle ASM的Oracle Clusterware安装。</p>
                  <p>Oracle Restart在单实例环境中增强了Oracle数据库的可用性。如果安装Oracle Restart，并且Oracle数据库软件堆栈的任何部分（包括数据库，侦听器和Oracle ASM实例）发生临时故障，Oracle Restart会自动重新启动发生故障的组件。此外，Oracle Restart会在重新启动数据库主机时启动所有这些组件。考虑到组件之间的依赖关系，组件以正确的顺序启动。</p>
                  <p>Oracle Clusterware是一种可移植的集群软件，可以对单个服务器进行集群，以便它们作为单个系统进行协作。Oracle Clusterware还为Oracle RAC提供了所需的基础结构。此外，Oracle Clusterware还可以保护集群中的任何Oracle应用程序或任何其他应用程序。无论如何，Oracle Clusterware是那些确保集群节点之间所需合作的系统中的智能。</p>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="recommended-and-best-practices-complete-upgrading-oracle-database.html#GUID-5196CE88-8669-45D6-8906-C45272940740" title="Oracle建议您完成这些更新Oracle数据库的良好实践指南。建议手动和DBUA升级使用这些做法。">升级Oracle数据库后要完成的建议和最佳实践</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="UPGRD52686"></a><div class="props_rev_3"><a id="GUID-4266E383-39F3-4858-9A67-D11CCD664C88" name="GUID-4266E383-39F3-4858-9A67-D11CCD664C88"></a><h3 id="UPGRD-GUID-4266E383-39F3-4858-9A67-D11CCD664C88" class="sect3">Oracle Grid Infrastructure安装和升级以及Oracle ASM</h3>
               <div>
                  <p>Oracle ASM随Oracle Grid Infrastructure一起安装。</p>
                  <p>在早期版本中，Oracle ASM作为Oracle数据库安装的一部分安装。从Oracle Database 11.2版开始，在安装Grid Infrastructure组件时会安装Oracle ASM。Oracle ASM与Oracle Clusterware共享Oracle主目录。</p>
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-4266E383-39F3-4858-9A67-D11CCD664C88__GUID-AF398C2E-4D83-4820-A2EB-457A88B72938">
                     <p class="notep1">也可以看看：</p>
                     <p>适用于您的平台的<a href="../install-and-upgrade.html" target="_blank"><span class="italic">Oracle Grid Infrastructure安装指南</span></a> ，其中提供有关Oracle主目录，角色分配的系统权限组，不同的安装软件所有者用户以及其他更改的信息。
                     </p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="recommended-and-best-practices-complete-upgrading-oracle-database.html#GUID-5196CE88-8669-45D6-8906-C45272940740" title="Oracle建议您完成这些更新Oracle数据库的良好实践指南。建议手动和DBUA升级使用这些做法。">升级Oracle数据库后要完成的建议和最佳实践</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="UPGRD12436"></a><div class="props_rev_3"><a id="GUID-128BB0D3-0739-4631-8283-F667302DCBF1" name="GUID-128BB0D3-0739-4631-8283-F667302DCBF1"></a><h3 id="UPGRD-GUID-128BB0D3-0739-4631-8283-F667302DCBF1" class="sect3">添加适当的新功能</h3>
               <div>
                  <p>在数据库升级计划中查看新功能。</p>
                  <p><span class="italic">“Oracle数据库新增功能指南”</span>介绍了新Oracle数据库发行版中提供的许多新功能。确定哪些新功能可以使数据库和应用程序受益。然后，您可以制定使用这些功能的计划。
                  </p>
                  <p>没有必要立即进行更改以开始使用新的Oracle数据库软件。您可以选择逐步向数据库和应用程序中引入新功能增强功能。</p>
                  <p> </p>
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-128BB0D3-0739-4631-8283-F667302DCBF1__GUID-C58DE683-674D-4F75-8E62-D1FF4348568B">
                     <p class="notep1">也可以看看：</p>
                     <p><a href="../newft/index.html" target="_blank"><span class="italic">Oracle数据库新功能指南</span></a></p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="recommended-and-best-practices-complete-upgrading-oracle-database.html#GUID-5196CE88-8669-45D6-8906-C45272940740" title="Oracle建议您完成这些更新Oracle数据库的良好实践指南。建议手动和DBUA升级使用这些做法。">升级Oracle数据库后要完成的建议和最佳实践</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="UPGRD12437"></a><div class="props_rev_3"><a id="GUID-36C4A570-B944-4E0E-B754-EBC04CC4F07C" name="GUID-36C4A570-B944-4E0E-B754-EBC04CC4F07C"></a><h3 id="UPGRD-GUID-36C4A570-B944-4E0E-B754-EBC04CC4F07C" class="sect3">根据需要制定新的行政程序</h3>
               <div>
                  <p>计划对脚本和过程的审核，并根据需要进行更改。</p>
                  <p>熟悉新Oracle数据库版本的功能后，请查看数据库管理脚本和过程，以确定是否需要进行任何更改。</p>
                  <p>使用每个应用程序所需的更改来协调对数据库的更改。例如，通过在数据库中启用完整性约束，您可以从应用程序中删除一些数据检查。</p>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="recommended-and-best-practices-complete-upgrading-oracle-database.html#GUID-5196CE88-8669-45D6-8906-C45272940740" title="Oracle建议您完成这些更新Oracle数据库的良好实践指南。建议手动和DBUA升级使用这些做法。">升级Oracle数据库后要完成的建议和最佳实践</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="UPGRD12438"></a><div class="props_rev_3"><a id="GUID-0A27E3EA-B320-4DED-8587-9ED5E3DAAEC3" name="GUID-0A27E3EA-B320-4DED-8587-9ED5E3DAAEC3"></a><h3 id="UPGRD-GUID-0A27E3EA-B320-4DED-8587-9ED5E3DAAEC3" class="sect3">设置表空间警报的阈值</h3>
               <div>
                  <p>升级后，已升级的Oracle数据库表空间警报的阈值将设置为null，从而禁用警报。</p>
                  <p>您必须在数据库中标识要监视的表空间，并且必须为这些表空间设置适当的阈值。</p>
                  <p>从Oracle Database 18c及更高版本开始，在新创建的Oracle数据库安装中，以下值用作默认值：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>85％完全警告</p>
                     </li>
                     <li>
                        <p>97％完全关键</p>
                     </li>
                  </ul>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="recommended-and-best-practices-complete-upgrading-oracle-database.html#GUID-5196CE88-8669-45D6-8906-C45272940740" title="Oracle建议您完成这些更新Oracle数据库的良好实践指南。建议手动和DBUA升级使用这些做法。">升级Oracle数据库后要完成的建议和最佳实践</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-7BBB2D85-E8FB-437B-BA21-6D08A04BB7AE" name="GUID-7BBB2D85-E8FB-437B-BA21-6D08A04BB7AE"></a><h3 id="UPGRD-GUID-7BBB2D85-E8FB-437B-BA21-6D08A04BB7AE" class="sect3">从回滚段迁移到自动撤消模式</h3>
               <div>
                  <p>如果数据库版本早于Oracle Database <span class="italic">11g</span> ，则必须将正在升级的数据库从使用回滚段（手动撤消管理）迁移到自动撤消管理。
                  </p>
                  <div class="section">
                     <p>自动撤消管理是默认的撤消空间管理模式。<code class="codeph">UNDO_MANAGEMENT</code>初始化参数指定系统应使用的撤消空间管理模式：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="p">
                     <ul style="list-style-type:disc">
                        <li>
                           <p>如果<span class="parmname" translate="no">UNDO_MANAGEMENT</span>设置为<code>AUTO</code> （或未设置<span class="parmname" translate="no">UNDO_MANAGEMENT</span> ），则数据库实例将以自动撤消管理模式启动。
                           </p>
                           <p>null <span class="parmname" translate="no">UNDO_MANAGEMENT</span>初始化参数默认为Oracle Database <span class="italic">11g</span>第1版（11.1）及更高版本中的自动撤消管理模式。在早期版本中，默认为手动撤消管理模式。升级早期版本时请小心。
                           </p>
                        </li>
                        <li>
                           <p>如果<span class="parmname" translate="no">UNDO_MANAGEMENT</span>设置为<code>MANUAL</code> ，则撤消空间在外部分配为回滚段。
                           </p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>将<span class="parmname" translate="no">UNDO_MANAGEMENT</span>参数设置为<code class="codeph">UNDO_MANAGEMENT=MANUAL</code> 。</span></li>
                     <li class="stepexpand"><span>再次启动实例并运行标准业务周期以获取代表性工作负载。评估工作负载，并计算自动撤消管理所需的撤消表空间的大小。</span></li>
                     <li class="stepexpand"><span>标准业务周期完成后，运行以下函数来收集撤消表空间大小，并帮助调整撤消表空间的大小。您需要SYSDBA权限才能运行此功能。</span><div><pre class="pre codeblock"><code>DECLARE utbsiz_in_MB NUMBER; BEGIN utbsiz_in_MB：= DBMS_UNDO_ADV.RBU_MIGRATION;结束; /</code></pre></div>
                        <div>
                           <p>此函数运行PL / SQL过程，该过程根据系统中回滚段的配置和使用情况提供有关如何调整新undo表空间大小的信息。该函数直接返回大小调整信息。</p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>创建所需大小的撤消表空间，并通过设置<code class="codeph">UNDO_MANAGEMENT=AUTO</code>或删除参数来打开自动撤消管理。</span></li>
                     <li class="stepexpand"><span>对于Oracle RAC配置，请在所有实例上重复这些步骤。</span></li>
                  </ol>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="recommended-and-best-practices-complete-upgrading-oracle-database.html#GUID-5196CE88-8669-45D6-8906-C45272940740" title="Oracle建议您完成这些更新Oracle数据库的良好实践指南。建议手动和DBUA升级使用这些做法。">升级Oracle数据库后要完成的建议和最佳实践</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="UPGRD12441"></a><div class="props_rev_3"><a id="GUID-07FE428B-C14E-4457-9A8E-04964D52B49E" name="GUID-07FE428B-C14E-4457-9A8E-04964D52B49E"></a><h3 id="UPGRD-GUID-07FE428B-C14E-4457-9A8E-04964D52B49E" class="sect3">将表从LONG数据类型迁移到LOB数据类型</h3>
               <div>
                  <p>您可以使用<code class="codeph">ALTER TABLE</code>语句将<code class="codeph">LONG</code>列的数据类型更改为<code class="codeph">CLOB</code> ，将<code class="codeph">LONG RAW</code>列的数据类型更改为<code class="codeph">BLOB</code> 。</p>
                  <div class="section">
                     <p><code class="codeph">LOB</code>数据类型（ <code class="codeph">BFILE</code> ， <code class="codeph">BLOB</code> ， <code class="codeph">CLOB</code>和<code class="codeph">NCLOB</code> ）可以提供比<code class="codeph">LONG</code>数据类型更多的优势。
                     </p>
                     <p>在以下示例中，表<code class="codeph">long_tab</code>名为<code class="codeph">long_col</code>的<code class="codeph">LONG</code>列更改为数据类型<code class="codeph">CLOB</code> ：</p><pre class="pre codeblock"><code>SQL&gt; ALTER TABLE Long_tab MODIFY（long_col CLOB）;</code></pre><p>使用此方法将<code class="codeph">LONG</code>列更改为LOB后，表上的所有现有约束和触发器仍可使用。但是，表的所有列上的所有索引（包括域索引和功能索引）都变得不可用，必须使用<code class="codeph">ALTER INDEX...重建<code class="codeph">ALTER INDEX...REBUILD</code>声明。此外，在域的索引<code class="codeph">LONG</code>列必须改变之前被丢弃<code class="codeph">LONG</code>列到LOB。</p>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-07FE428B-C14E-4457-9A8E-04964D52B49E__GUID-4868E504-C120-4A27-9BA8-25CD1A32DA31">
                     <p class="notep1">也可以看看：</p>
                     <p><a href="../adlob/introduction-to-large-objects.html#ADLOB001" target="_blank"><span class="italic">Oracle Database SecureFiles和Large Objects Developer's Guide</span></a> ，了解有关修改应用程序以使用LOB数据的信息</p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="recommended-and-best-practices-complete-upgrading-oracle-database.html#GUID-5196CE88-8669-45D6-8906-C45272940740" title="Oracle建议您完成这些更新Oracle数据库的良好实践指南。建议手动和DBUA升级使用这些做法。">升级Oracle数据库后要完成的建议和最佳实践</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="UPGRD52810"></a><div class="props_rev_3"><a id="GUID-EB285325-CA65-41B4-BE58-D3F69CFED789" name="GUID-EB285325-CA65-41B4-BE58-D3F69CFED789"></a><h3 id="UPGRD-GUID-EB285325-CA65-41B4-BE58-D3F69CFED789" class="sect3">迁移升级的Oracle数据库以使用统一审核</h3>
               <div>
                  <p>要使用统一审核的全部功能，必须手动迁移到统一审核。</p>
                  <p>在统一审核，所有Oracle数据库审计线索（ <code class="codeph">SYS.AUD$</code>数据库审计线索， <code class="codeph">SYS.FGA_LOG$</code>细粒度审计， <code class="codeph">DVYS.AUDIT_TRAIL$</code>对于Database Vault的，等等）合并成一个单一的审计跟踪，您可以通过查询单实例安装的<code class="codeph">UNIFIED_AUDIT_TRAIL</code>数据字典视图和Oracle Real Application Clusters环境的<code class="codeph">GV$UNIFIED_AUDIT_TRAIL</code>来查看。
                  </p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="recommended-and-best-practices-complete-upgrading-oracle-database.html#GUID-C13E0E20-2FCC-4DDE-A707-3C29D0C04E20">了解Oracle数据库的统一审核迁移过程</a><br>确定要在升级的数据库中使用的审核策略。
                     </li>
                     <li class="ulchildlink"><a href="recommended-and-best-practices-complete-upgrading-oracle-database.html#GUID-21FE7F97-DE79-43D4-A8DD-D66035C17608">迁移到Oracle数据库的统一审核</a><br>将此过程用于多租户容器（CDB）数据库以迁移到统一审核。
                     </li>
                     <li class="ulchildlink"><a href="recommended-and-best-practices-complete-upgrading-oracle-database.html#GUID-A44905C3-3D2E-4FAD-BA35-8F8E956D874C">关于迁移到统一审核后管理早期审核记录</a><br>检查，存档和清除早期审计跟踪，以准备使用统一审计跟踪。
                     </li>
                     <li class="ulchildlink"><a href="recommended-and-best-practices-complete-upgrading-oracle-database.html#GUID-28211AC6-2197-4D04-9DB9-1C3D6E030F03">删除统一审核功能</a><br>使用此过程可删除统一审核，并使用混合模式审核。
                     </li>
                     <li class="ulchildlink"><a href="recommended-and-best-practices-complete-upgrading-oracle-database.html#GUID-94E741BC-4503-4278-8F04-D780AAF7F7A6">如果您选择不使用统一审核，则获取文档参考</a><br>您可以访问此处列出的文档以获取有关如何使用非统一审核的配置信息。
                     </li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-EB285325-CA65-41B4-BE58-D3F69CFED789__GUID-696F4626-575B-4C04-ACE6-52F1B7C61635">
                     <p class="notep1">也可以看看：</p>
                     <p><a href="../dbseg/how-unified-auditing-migration-affects-individual-audit-features.html#DBSEG341" target="_blank"><span class="italic">“Oracle数据库安全指南”，</span></a>以获取有关此版本的审核功能如何更改的信息</p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="recommended-and-best-practices-complete-upgrading-oracle-database.html#GUID-5196CE88-8669-45D6-8906-C45272940740" title="Oracle建议您完成这些更新Oracle数据库的良好实践指南。建议手动和DBUA升级使用这些做法。">升级Oracle数据库后要完成的建议和最佳实践</a></p>
                     </div>
                  </div>
               </div>
               <a id="UPGRD52811"></a><div class="props_rev_3"><a id="GUID-C13E0E20-2FCC-4DDE-A707-3C29D0C04E20" name="GUID-C13E0E20-2FCC-4DDE-A707-3C29D0C04E20"></a><h4 id="UPGRD-GUID-C13E0E20-2FCC-4DDE-A707-3C29D0C04E20" class="sect4">了解Oracle数据库的统一审核迁移过程</h4>
                  <div>
                     <p>确定要在升级的数据库中使用的审核策略。</p>
                     <p>默认情况下，不会为升级的数据库启用统一审核。如果已从早期版本升级到Oracle Database 12 <span class="italic">c</span> ，那么您的数据库将使用早期版本中使用的相同审核功能。对于新创建的数据库，默认情况下启用统一审核的混合模式方法。完成向统一审计的迁移后，将禁用传统审计，并且新审计记录将写入统一审计跟踪。
                     </p>
                     <p>要启用和配置审核策略及其使用方式，请选择以下一种方法：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>使用纯统一审计工具。</p>
                           <p>迁移到统一审计以使用完整的统一审计功能。完成迁移到统一审核的过程后，您可以创建和启用新的审核策略，还可以使用预定义的审核策略。这些策略的审计记录写入统一审计跟踪。较早的审计跟踪及其审计记录仍然存在，但没有新的审计记录写入先前的审计跟踪。</p>
                           <div class="infoboxnote" id="GUID-C13E0E20-2FCC-4DDE-A707-3C29D0C04E20__GUID-EFEF76E8-F8D9-4942-8547-A99CE59746C6">
                              <p class="notep1">注意：</p>
                              <p>早期版本的审计配置对统一审计系统没有影响。只有统一的审计策略才会在统一审计跟踪中生成审计记录。</p>
                           </div>
                        </li>
                        <li>
                           <p>使用混合模式审计工具。</p>
                           <p>混合模式审计工具使传统和统一审计工具能够同时运行，并适用于新数据库和升级数据库。如果您启用至少一个统一审计预定义审计策略，则可以使用混合模式统一审计工具。这些策略的审计记录写入统一审计跟踪。早期版本的Oracle数据库中的审计配置也可用，此配置的审计记录将写入先前的审计跟踪。如果您决定使用纯统一审计工具，则可以迁移到该工具。</p>
                           <div class="infoboxnote" id="GUID-C13E0E20-2FCC-4DDE-A707-3C29D0C04E20__GUID-D53B8E5A-9A7C-4F85-8471-4711A3816049">
                              <p class="notep1">注意：</p>
                              <p>如果数据库不可写，则审计记录将写入<code>$ORACLE_BASE/audit/$ORACLE_SID</code>目录中的新格式操作系统文件。
                              </p>
                           </div>
                           <div class="infoboxnotealso" id="GUID-C13E0E20-2FCC-4DDE-A707-3C29D0C04E20__GUID-6B7D03D1-2AB9-4791-A9EC-0C25CCDE5572">
                              <p class="notep1">也可以看看：</p>
                              <p></p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>有关预定义审核策略的信息，请参见<a href="../dbseg/configuring-audit-policies.html#DBSEG356" target="_blank"><span class="italic">“Oracle数据库安</span></a></p>
                                 </li>
                                 <li>
                                    <p>有关<span class="parmname" translate="no">ora_SecureConfig</span>审核策略的信息，请<span class="parmname" translate="no">ora_SecureConfig</span> <a href="../dbseg/configuring-audit-policies.html#DBSEG703" target="_blank"><span class="italic">“Oracle数据库安全指南”</span></a></p>
                                 </li>
                              </ul>
                           </div>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="recommended-and-best-practices-complete-upgrading-oracle-database.html#GUID-EB285325-CA65-41B4-BE58-D3F69CFED789" title="要使用统一审核的全部功能，必须手动迁移到统一审核。">迁移升级的Oracle数据库以使用统一审计</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="UPGRD52812"></a><div class="props_rev_3"><a id="GUID-21FE7F97-DE79-43D4-A8DD-D66035C17608" name="GUID-21FE7F97-DE79-43D4-A8DD-D66035C17608"></a><h4 id="UPGRD-GUID-21FE7F97-DE79-43D4-A8DD-D66035C17608" class="sect4">迁移到Oracle数据库的统一审核</h4>
                  <div>
                     <p>将此过程用于多租户容器（CDB）数据库以迁移到统一审核。</p>
                     <p>在CDB环境中，请在<code class="codeph">root</code>执行以下过程。该过程将<code class="codeph">root</code> CDB和任何关联的PDB迁移到统一审计。
                     </p>
                     <ol>
                        <li>
                           <p>以具有<code class="codeph">SYSDBA</code>权限的<code class="codeph">SYS</code>用户身份登录SQL * Plus。
                           </p><pre class="pre codeblock"><code>sqlplus sys as sysdba输入密码： <span class="variable" translate="no">password</span>
</code></pre><p>在Pluggable Databases环境中，此登录将您连接到<code class="codeph">root</code> 。
                           </p>
                        </li>
                        <li>
                           <p>使用此查询检查您的Oracle数据库是否已迁移到统一审核：</p><pre class="pre codeblock"><code>SQL&gt;从V $ OPTION中选择VALUE参数='统一审计';</code></pre><p>如果<code class="codeph">VALUE</code>列的输出为<code class="codeph">TRUE</code> ，则数据库中已启用统一审核。您可以继续管理早期审核记录。如果输出为<code class="codeph">FALSE</code> ，则完成此过程中的其余步骤。
                           </p>
                        </li>
                        <li>
                           <p>停止数据库。对于单实例环境，请从SQL * Plus输入以下命令：</p><pre class="pre codeblock"><code>SQL&gt; SHUTDOWN IMMEDIATE SQL&gt; EXIT</code></pre><p>对于Windows系统，请停止Oracle服务：</p><pre class="pre codeblock"><code>net stop OracleService％ORACLE_SID％</code></pre><p>对于Oracle RAC安装，请按如下方式关闭每个数据库实例：</p><pre class="pre codeblock"><code>srvctl stop database -db <span class="variable" translate="no">db_name</span>
</code></pre></li>
                        <li>
                           <p>停止听众。（对于Oracle RAC和Oracle Grid Infrastructure侦听器，不需要停止侦听器。）</p><pre class="pre codeblock"><code>lsnrctl stop <span class="variable" translate="no">listener_name</span>
</code></pre><p>您可以通过运行<code class="codeph">lsnrctl</code> <code class="codeph">status</code>命令找到侦听器的名称。<code class="codeph">Alias</code>设置表示名称。
                           </p>
                        </li>
                        <li>
                           <p>转到<code>$ORACLE_HOME/rdbms/lib</code>目录。
                           </p>
                        </li>
                        <li>
                           <p>启用统一审核。</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>Linux和UNIX</p><pre class="pre codeblock"><code>make -f ins_rdbms.mk uniaud_on ioracle ORACLE_HOME = $ ORACLE_HOME</code></pre></li>
                              <li>
                                 <p>视窗</p>
                                 <p>将文件<code>%ORACLE_HOME%/bin/orauniaud12.dll.dbl</code>重命名为<code>%ORACLE_HOME%/bin/orauniaud12.dll</code> 。
                                 </p>
                              </li>
                           </ul>
                           <div class="infoboxnote" id="GUID-21FE7F97-DE79-43D4-A8DD-D66035C17608__GUID-D52716EB-4FBD-4386-8E62-B94E88BCF0AD">
                              <p class="notep1">注意：</p>
                              <p>对于具有非共享Oracle主目录的Oracle RAC数据库，必须在每个集群成员节点上重复此步骤，以便在每个集群节点上的本地ORACLE_HOME内更新二进制文件。</p>
                           </div>
                        </li>
                        <li>
                           <p>重启监听器。</p><pre class="pre codeblock"><code>lsnrctl start <span class="variable" translate="no">listener_name</span>
</code></pre></li>
                        <li>
                           <p>重启数据库。</p>
                           <p>登录到SQL * Plus，然后输入<code>STARTUP</code>命令：</p><pre class="pre codeblock"><code>sqlplus sys as sysoper输入密码： <span class="variable" translate="no">password</span> SQL&gt; STARTUP</code></pre><p>对于Windows系统，启动Oracle服务：</p><pre class="pre codeblock"><code>net start OracleService％ORACLE_SID％</code></pre><p>对于Oracle RAC安装，请启动每个数据库实例：</p><pre class="pre codeblock"><code>srvctl启动数据库-db <span class="variable" translate="no">db_name</span></code></pre></li>
                     </ol>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="recommended-and-best-practices-complete-upgrading-oracle-database.html#GUID-EB285325-CA65-41B4-BE58-D3F69CFED789" title="要使用统一审核的全部功能，必须手动迁移到统一审核。">迁移升级的Oracle数据库以使用统一审计</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="UPGRD52876"></a><div class="props_rev_3"><a id="GUID-A44905C3-3D2E-4FAD-BA35-8F8E956D874C" name="GUID-A44905C3-3D2E-4FAD-BA35-8F8E956D874C"></a><h4 id="UPGRD-GUID-A44905C3-3D2E-4FAD-BA35-8F8E956D874C" class="sect4">关于迁移到统一审核后管理早期审核记录</h4>
                  <div>
                     <p>检查，存档和清除早期审计跟踪，以准备使用统一审计跟踪。</p>
                     <p>完成迁移Oracle数据库以使用统一审计的过程后，数据库之前的任何审计记录都将保留在其早期审计跟踪中。您可以归档这些审核记录，然后清除其审核跟踪。通过统一审计，任何新的审计记录都会写入统一审计跟踪。</p>
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-A44905C3-3D2E-4FAD-BA35-8F8E956D874C__GUID-2FF78F42-7A1F-486A-A5E1-C256221BEA43">
                        <p class="notep1">也可以看看：</p>
                        <p></p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>“ <a href="../dbseg/administering-the-audit-trail.html#DBSEG732" target="_blank"><span class="italic">Oracle数据库安全指南</span></a> ”中的“归档审计跟踪”</p>
                           </li>
                           <li>
                              <p>“ <a href="../dbseg/administering-the-audit-trail.html#DBSEG90934" target="_blank"><span class="italic">Oracle数据库安全指南</span></a> ”中的“清除审计跟踪记录”</p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="recommended-and-best-practices-complete-upgrading-oracle-database.html#GUID-EB285325-CA65-41B4-BE58-D3F69CFED789" title="要使用统一审核的全部功能，必须手动迁移到统一审核。">迁移升级的Oracle数据库以使用统一审计</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="UPGRD52877"></a><div class="props_rev_3"><a id="GUID-28211AC6-2197-4D04-9DB9-1C3D6E030F03" name="GUID-28211AC6-2197-4D04-9DB9-1C3D6E030F03"></a><h4 id="UPGRD-GUID-28211AC6-2197-4D04-9DB9-1C3D6E030F03" class="sect4">删除统一审核功能</h4>
                  <div>
                     <p>使用此过程可删除统一审核，并使用混合模式审核。</p>
                     <p>在使数据库启用统一审计后，如果您决定不需要统一审计，则可以使用此过程删除统一审计功能。在这种情况下，您的数据库使用混合模式审计工具。</p>
                     <ol>
                        <li>
                           <p>停止数据库。</p><pre class="pre codeblock"><code>sqlplus sys as sysoper输入密码： <span class="variable" translate="no">password</span> SQL&gt; SHUTDOWN IMMEDIATE SQL&gt; EXIT</code></pre><p>对于Windows系统，请停止Oracle服务：</p><pre class="pre codeblock"><code>net stop OracleService％ORACLE_SID％</code></pre><p>对于Oracle RAC安装，请按如下方式关闭每个数据库实例：</p><pre class="pre codeblock"><code>srvctl stop database -db <span class="variable" translate="no">db_name</span>
</code></pre></li>
                        <li>
                           <p>转到<code>$ORACLE_HOME/rdbms/lib</code>目录。
                           </p>
                        </li>
                        <li>
                           <p>禁用统一审核可执行文件。</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><span class="bold">Unix：</span>运行以下命令：</p><pre class="pre codeblock"><code>make -f ins_rdbms.mk uniaud_off ioracle ORACLE_HOME = $ ORACLE_HOME</code></pre></li>
                              <li>
                                 <p><span class="bold">Microsoft Windows：</span>将<code>%ORACLE_HOME%/bin/orauniaud12.dll</code>文件重命名为<code>%ORACLE_HOME%/bin/orauniaud12.dll.dbl</code> 。
                                 </p>
                              </li>
                           </ul>
                        </li>
                        <li>
                           <p>重启数据库。</p><pre class="pre codeblock"><code>sqlplus sys as sysoper输入密码： <span class="variable" translate="no">password</span> SQL&gt; STARTUP SQL&gt; EXIT</code></pre><p>对于Microsoft Windows系统，请再次启动Oracle服务。</p><pre class="pre codeblock"><code>net start OracleService％ORACLE_SID％</code></pre><p>对于Oracle RAC安装，请使用以下语法启动每个数据库实例：</p><pre class="pre codeblock"><code>srvctl启动数据库-db <span class="variable" translate="no">db_name</span></code></pre><pre class="oac_no_warn" dir="ltr"></pre></li>
                     </ol>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="recommended-and-best-practices-complete-upgrading-oracle-database.html#GUID-EB285325-CA65-41B4-BE58-D3F69CFED789" title="要使用统一审核的全部功能，必须手动迁移到统一审核。">迁移升级的Oracle数据库以使用统一审计</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="UPGRD52813"></a><div class="props_rev_3"><a id="GUID-94E741BC-4503-4278-8F04-D780AAF7F7A6" name="GUID-94E741BC-4503-4278-8F04-D780AAF7F7A6"></a><h4 id="UPGRD-GUID-94E741BC-4503-4278-8F04-D780AAF7F7A6" class="sect4">如果您选择不使用统一审核，则获取文档参考</h4>
                  <div>
                     <p>您可以访问此处列出的文档以获取有关如何使用非统一审核的配置信息。</p>
                     <p>升级到新版Oracle数据库后，如果您选择不更改为统一审计，则Oracle文档和Oracle技术网提供有关传统非统一审计的信息。</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><cite>Oracle数据库安全指南</cite> ：本指南是配置审计的主要信息来源。您必须使用本手册的Oracle Database <span class="italic">11g</span>版本。要访问此指南：</p>
                           <ol>
                              <li>
                                 <p>访问Oracle Technology Network，网址如下：</p>
                                 <p><a href="http://www.oracle.com/technetwork/index.html" target="_blank"><code class="codeph">http://www.oracle.com/technetwork/index.html</code></a></p>
                              </li>
                              <li>
                                 <p>从“ <code>Downloads</code>菜单的“ <code>Databases</code>下，选择“ <code>Database 11g</code> 。
                                 </p>
                              </li>
                              <li>
                                 <p>在“下载”页面中，选择“ <span class="uicontrol bold">文档”</span>选项卡。
                                 </p>
                              </li>
                              <li>
                                 <p>从最新的Oracle Database <span class="italic">11g</span>第2版（11.2）文档页面中，选择<span class="uicontrol bold">View Library</span>链接以显示Release 11 <span class="italic">g</span>文档集的主页。
                                 </p>
                              </li>
                              <li>
                                 <p>在“ <span class="uicontrol bold">搜索”</span>字段下，选择“ <span class="uicontrol bold">主图书清单”</span>链接。
                                 </p>
                              </li>
                              <li>
                                 <p>搜索<cite>安全指南</cite> 。
                                 </p>
                              </li>
                              <li>
                                 <p>选择本指南的<span class="uicontrol bold">HTML</span>或<span class="uicontrol bold">PDF</span>链接。
                                 </p>
                              </li>
                           </ol>
                        </li>
                        <li>
                           <p><a href="../sqlrf/AUDIT-Unified-Auditing.html#SQLRF56110" target="_blank"><span><cite>Oracle数据库SQL语言参考</cite></span></a> ：本指南介绍了如何将AUDIT和NOAUDIT语句用于统一审计和非统一审计环境。
                           </p>
                        </li>
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/upgrd&amp;id=REFRN10004" target="_blank"><span><cite>Oracle数据库参考</cite></span></a> ：本指南介绍如何使用与非统一审计环境关联的初始化参数和数据字典视图。
                           </p>
                        </li>
                        <li>
                           <p><a href="../dvadm/auditing-oracle-database-vault.html#DVADM011" target="_blank"><span><cite>Oracle Database Vault管理员指南</cite></span></a> ：本指南介绍如何在Database Vault的非统一审核环境中配置审核。
                           </p>
                        </li>
                        <li>
                           <p><a href="../olsag/auditing-under-oracle-label-security.html#OLSAG073" target="_blank"><span><cite>Oracle Label Security管理员指南</cite></span></a> ：本指南介绍了如何在非标准化审核环境中为Oracle Label Security配置审核。
                           </p>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="recommended-and-best-practices-complete-upgrading-oracle-database.html#GUID-EB285325-CA65-41B4-BE58-D3F69CFED789" title="要使用统一审核的全部功能，必须手动迁移到统一审核。">迁移升级的Oracle数据库以使用统一审计</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
            <div class="sect2"><a id="GUID-7A5E0A01-7711-4EEA-88DD-EECF16B9A6F7" name="GUID-7A5E0A01-7711-4EEA-88DD-EECF16B9A6F7"></a><h3 id="UPGRD-GUID-7A5E0A01-7711-4EEA-88DD-EECF16B9A6F7" class="sect3">确定重建的Oracle文本索引</h3>
               <div>
                  <p>您可以运行一个脚本，帮助您识别带有令牌表的Oracle Text索引索引，这些令牌表可以在升级到新的Oracle数据库发行版后重建。</p>
                  <p>从Oracle Database 12c第1版（12.2.0.1）升级到Oracle Database 18c及更高版本时，Oracle Text令牌表（ <code class="codeph">$I</code> ， <code class="codeph">$P</code>等）将从64字节扩展到255字节。但是，如果使用较小大小范围的现有标记表的索引，则Oracle Text索引无法利用此扩展标记列范围。必须重建索引才能使用255字节大小范围。Oracle提供了一个脚本，可以帮助您识别可以通过重建获益的索引。
                  </p>
                  <p>从My Oracle Support获取脚本：</p>
                  <p><a href="https://support.oracle.com/rs?type=doc&amp;id=2287094.1" target="_blank">https://support.oracle.com/rs?type=doc&amp;id=2287094.1</a></p>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="recommended-and-best-practices-complete-upgrading-oracle-database.html#GUID-5196CE88-8669-45D6-8906-C45272940740" title="Oracle建议您完成这些更新Oracle数据库的良好实践指南。建议手动和DBUA升级使用这些做法。">升级Oracle数据库后要完成的建议和最佳实践</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-9FF51E36-BD45-429F-8E4D-25FA9F0574D0" name="GUID-9FF51E36-BD45-429F-8E4D-25FA9F0574D0"></a><h3 id="UPGRD-GUID-9FF51E36-BD45-429F-8E4D-25FA9F0574D0" class="sect3">删除和重新创建DBMS_SCHEDULER作业</h3>
               <div>
                  <p>如果从早期版本升级后DBMS_SCHEDULER作业不起作用，请删除并重新创建作业。</p>
                  <p>如果发现升级后DBMS_SCHEDULER作业无法正常运行。放弃并重新创造这些工作。即使升级过程未报告问题，并且系统对象有效，也会发生此问题。</p>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="recommended-and-best-practices-complete-upgrading-oracle-database.html#GUID-5196CE88-8669-45D6-8906-C45272940740" title="Oracle建议您完成这些更新Oracle数据库的良好实践指南。建议手动和DBUA升级使用这些做法。">升级Oracle数据库后要完成的建议和最佳实践</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-4BC5F146-BF0D-4BCF-8A0B-1B67B767EEF1" name="GUID-4BC5F146-BF0D-4BCF-8A0B-1B67B767EEF1"></a><h3 id="UPGRD-GUID-4BC5F146-BF0D-4BCF-8A0B-1B67B767EEF1" class="sect3">升级后传输Unified Audit记录</h3>
               <div>
                  <p>查看这些主题以了解在升级和迁移到统一审核后如何获得更好的性能</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="recommended-and-best-practices-complete-upgrading-oracle-database.html#GUID-D71F00E9-2A6B-4F9A-98A7-C643F18E3DBA">关于升级后传输统一审核记录</a><br>将统一审计记录从Oracle Database 12c版本12.1传输到新Oracle Database版本的<code class="codeph">AUDSYS</code>架构下的新关系表，可提高统一审计跟踪的读取性能。
                     </li>
                     <li class="ulchildlink"><a href="recommended-and-best-practices-complete-upgrading-oracle-database.html#GUID-DA086BFC-D267-47C7-B4DF-8D5754A0AD9F">升级后传输统一审核记录</a><br>您可以使用<span class="apiname" translate="no">DBMS_AUDIT_MGMT.TRANSFER_UNIFIED_AUDIT_RECORDS</span> PL / SQL过程将统一审计记录传输到<span class="apiname" translate="no">AUDSYS</span>的新关系表。
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="recommended-and-best-practices-complete-upgrading-oracle-database.html#GUID-5196CE88-8669-45D6-8906-C45272940740" title="Oracle建议您完成这些更新Oracle数据库的良好实践指南。建议手动和DBUA升级使用这些做法。">升级Oracle数据库后要完成的建议和最佳实践</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="sect3"><a id="GUID-D71F00E9-2A6B-4F9A-98A7-C643F18E3DBA" name="GUID-D71F00E9-2A6B-4F9A-98A7-C643F18E3DBA"></a><h4 id="UPGRD-GUID-D71F00E9-2A6B-4F9A-98A7-C643F18E3DBA" class="sect4">关于升级后传输统一审核记录</h4>
                  <div>
                     <p>将统一审计记录从Oracle Database 12c版本12.1传输到新Oracle Database版本的<code class="codeph">AUDSYS</code>架构下的新关系表，可提高统一审计跟踪的读取性能。
                     </p>
                     <p>从Oracle Database 12c第2版开始，统一审计记录将直接写入位于<span class="apiname" translate="no">AUDSYS</span>模式中的新内部关系表。在Oracle Database 12c 12.1版中，统一审计记录已写入公共日志记录基础结构（CLI）SGA队列。如果您迁移到该版本中的统一审计，那么为了获得更好的读取性能，您可以将该发行版的统一审计记录传输到新的Oracle数据库发行版内部表。您不必执行此传输，但Oracle建议您这样做以获得更好的统一审计跟踪读取性能。这是一次性操作。升级后生成的所有新统一审计记录都将写入新表。该表是只读表。强制审核任何修改此表的元数据或数据的尝试。
                     </p>
                     <p>升级到新的Oracle数据库发行版后，如果早期版本的<code class="codeph">UNIFIED_AUDIT_TRAIL</code>存在任何统一的审计记录，则考虑使用传输过程将它们传输到新的内部关系表，以便更好地读取统一审计跟踪的性能。
                     </p>
                     <p>与<code class="codeph">SYS</code>模式一样，如果您具有<span class="apiname" translate="no">SELECT ANY TABLE</span>系统特权，则无法查询<span class="apiname" translate="no">AUDSYS</span>模式。此外，除非您具有<span class="apiname" translate="no">SELECT ANY DICTIONARY</span>系统特权或此内部表的显式<span class="apiname" translate="no">SELECT</span>特权，否则此表不会在<span class="apiname" translate="no">ALL_TABLES</span>数据字典视图中列为架构对象。在数据库打开读写之前，审计记录将写入操作系统溢出文件（ <code class="codeph">.bin</code>格式）。但是，在数据库以读写模式打开后，可以使用<span class="apiname" translate="no">DBMS_AUDIT_MGMT.LOAD_UNIFIED_AUDIT_FILES</span>过程将这些操作系统文件中的审计记录传输到内部关系表。
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="recommended-and-best-practices-complete-upgrading-oracle-database.html#GUID-4BC5F146-BF0D-4BCF-8A0B-1B67B767EEF1" title="查看这些主题以了解在升级和迁移到统一审核后如何获得更好的性能">升级后传输Unified Audit记录</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-DA086BFC-D267-47C7-B4DF-8D5754A0AD9F" name="GUID-DA086BFC-D267-47C7-B4DF-8D5754A0AD9F"></a><h4 id="UPGRD-GUID-DA086BFC-D267-47C7-B4DF-8D5754A0AD9F" class="sect4">升级后传输统一审核记录</h4>
                  <div>
                     <p>您可以使用<span class="apiname" translate="no">DBMS_AUDIT_MGMT.TRANSFER_UNIFIED_AUDIT_RECORDS</span> PL / SQL过程将统一审计记录传输到<span class="apiname" translate="no">AUDSYS</span>的新关系表。
                     </p>
                     <ol>
                        <li class="stepexpand"><span>以已被授予<span class="apiname" translate="no">AUDIT_ADMIN</span>角色的用户身份登录数据库实例。</span><div>
                              <p>例如，在非多租户环境中：</p><pre class="oac_no_warn" dir="ltr">sqlplus sec_admin输入密码： <span class="variable" translate="no">password</span></pre><p>对于多租户环境，请连接到根目录：</p><pre class="oac_no_warn" dir="ltr">sqlplus c ## sec_admin @ root输入密码： <span class="variable" translate="no">password</span></pre><p>您可以在根目录和PDB中执行此过程，因为<span class="apiname" translate="no">UNIFIED_AUDIT_TRAIL</span>视图是特定于容器的。此外，转移程序是特定于容器的。也就是说，从根执行传输不会影响PDB的统一审计跟踪中存在的统一审计记录。</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>对于多租户环境，请查询<span class="apiname" translate="no">DBA_PDB_HISTORY</span>视图以查找与CLI表关联的正确GUID，该表特定于必须从中传输审计记录的容器。</span><div>
                              <p>例如：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; SELECT PDB_NAME，PDB_GUID FROM DBA_PDB_HISTORY; PDB_NAME PDB_GUID -------- -------------------------------- HR_PDB 33D96CA7862D53DFE0534DC0E40A7C9B ...</pre></div>
                        </li>
                        <li class="stepexpand"><span>在多租户环境中，连接到要为其传输审核记录的容器。</span><div>
                              <p>您无法在与当前连接的容器不同的容器上执行传输操作。</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>运行<span class="apiname" translate="no">DBMS_AUDIT_MGMT.TRANSFER_UNIFIED_AUDIT_RECORDS</span>过程。</span><div>例如：<pre class="oac_no_warn" dir="ltr">SQL&gt; EXEC DBMS_AUDIT_MGMT.TRANSFER_UNIFIED_AUDIT_RECORDS; PL / SQL过程成功完成。</pre><p>或者，指定PDB GUID：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; EXEC DBMS_AUDIT_MGMT.TRANSFER_UNIFIED_AUDIT_RECORDS（'33D96CA7862D53DFE0534DC0E40A7C9B'）; PL / SQL过程成功完成。</pre></div>
                        </li>
                        <li class="stepexpand"><span>如果数据库处于打开读写模式，则执行<span class="apiname" translate="no">DBMS_AUDIT_MGMT.LOAD_UNIFIED_AUDIT_FILES</span>过程。</span><div>
                              <p>在数据库处于开放读写模式之前，审计记录将写入操作系统（OS）文件。<span class="apiname" translate="no">DBMS_AUDIT_MGMT.LOAD_UNIFIED_AUDIT_FILES</span>过程将文件中存在的统一审计记录移动到数据库表。通过查询<span class="apiname" translate="no">V$UNIFIED_AUDIT_TRAIL</span>动态视图，可以找到OS溢出文件中存在的统一审计记录。
                              </p>
                           </div>
                           <div>
                              <p>例如，如果要对<span class="apiname" translate="no">HR_PDB</span>容器中的审计记录执行此过程，则必须首先连接到该PDB：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; CONNECT sec_admin @ HR_PDB输入密码： <span class="variable" translate="no">password</span> SQL&gt; EXEC DBMS_AUDIT_MGMT.LOAD_UNIFIED_AUDIT_FILES; PL / SQL过程成功完成。</pre></div>
                        </li>
                        <li class="stepexpand"><span>查询<span class="apiname" translate="no">UNIFIED_AUDIT_TRAIL</span>数据字典视图以检查记录是否正确传输。</span><div>
                              <p>Oracle强烈建议您查询<span class="apiname" translate="no">UNIFIED_AUDIT_TRAIL</span> 。成功审核记录传输后，您应查询<span class="apiname" translate="no">UNIFIED_AUDIT_TRAIL</span>因为查询<span class="apiname" translate="no">V$UNIFIED_AUDIT_TRAIL</span>动态视图将显示仅存在于OS溢出文件中的审核记录。
                              </p>
                           </div>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="recommended-and-best-practices-complete-upgrading-oracle-database.html#GUID-4BC5F146-BF0D-4BCF-8A0B-1B67B767EEF1" title="查看这些主题以了解在升级和迁移到统一审核后如何获得更好的性能">升级后传输Unified Audit记录</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="UPGRD52687"></a><a id="UPGRD12383"></a><div class="props_rev_3"><a id="GUID-F2334FB4-3FE6-4B75-A5DE-2FE2F9A4C8E4" name="GUID-F2334FB4-3FE6-4B75-A5DE-2FE2F9A4C8E4"></a><h3 id="UPGRD-GUID-F2334FB4-3FE6-4B75-A5DE-2FE2F9A4C8E4" class="sect3">关于测试升级的生产Oracle数据库</h3>
               <div>
                  <p>对您在测试数据库上执行的生产数据库重复测试，以确保应用程序按预期运行。</p>
                  <p>如果将测试数据库升级到新的Oracle数据库发行版，然后对其进行测试，那么现在可以在升级到新Oracle数据库发行版的生产数据库上重复这些测试。比较结果，注意异常。根据需要多次重复测试升级。</p>
                  <p>要使用新的Oracle Database版本验证应用程序是否正常运行，请使用现有应用程序测试新升级的生产数据库。您还可以通过添加可用的Oracle数据库功能，然后测试它们来测试增强功能。但是，首先要确保应用程序以与升级之前相同的方式运行。</p>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="recommended-and-best-practices-complete-upgrading-oracle-database.html#GUID-5196CE88-8669-45D6-8906-C45272940740" title="Oracle建议您完成这些更新Oracle数据库的良好实践指南。建议手动和DBUA升级使用这些做法。">升级Oracle数据库后要完成的建议和最佳实践</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
         </div>
      </article>
   </body>
</html>