<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="For supported releases of Oracle Database, you can downgrade a database to the release from which you last upgraded."></meta>
      <meta name="description" content="For supported releases of Oracle Database, you can downgrade a database to the release from which you last upgraded."></meta>
      <title>将Oracle数据库降级为早期版本</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Database Upgrade Guide"></meta>
      <meta property="og:description" content="For supported releases of Oracle Database, you can downgrade a database to the release from which you last upgraded."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Database Upgrade Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="database-upgrade-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-04-25T08:26:31-07:00"></meta>
      <meta name="dcterms.title" content="Database Upgrade Guide"></meta>
      <meta name="dcterms.dateCopyrighted" content="1996, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96252-05"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="upgrading-oracle-forms-oracle-developer-applications.html" title="Previous" type="text/html"></link>
      <link rel="next" href="migrating-data-after-upgrade-oracle.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="UPGRD"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="upgrading-oracle-forms-oracle-developer-applications.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="migrating-data-after-upgrade-oracle.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">数据库升级指南</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">将Oracle数据库降级为早期版本</li>
            </ol>
            <a id="GUID-CAD9888A-2E6E-48F8-938C-B3E861738606" name="GUID-CAD9888A-2E6E-48F8-938C-B3E861738606"></a><a id="UPGRD007"></a>
            
            <h2 id="UPGRD-GUID-CAD9888A-2E6E-48F8-938C-B3E861738606" class="sect2"><span class="enumeration_chapter">7将</span> Oracle数据库降级为早期版本</h2>
         </header>
         <div class="ind">
            <div>
               <p>对于受支持的Oracle数据库版本，您可以将数据库降级到上次升级的版本。</p>
               <p>例如，如果您最近升级了Oracle Database 12c版本1（12.1.0.2（发布版本为19c，并且未将兼容初始化参数更改为19.1.0，则可以降级到版本12.1.0.2）。</p>
               <p>话题：</p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-59F92E2A-DC4D-46A3-9AC9-63F47BE4A86F">支持降级Oracle数据库的版本</a><br>您可以根据升级数据库的原始Oracle数据库版本降级主要版本并发布更新或补丁集版本。
                  </li>
                  <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-16E57DCD-0136-4E2D-8EB8-CE5572FCB010">降级Oracle数据库时检查不兼容性</a><br>要查看数据库是否存在可能阻止您降级的不兼容性，请检查数据库的兼容级别。
                  </li>
                  <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-FFECBDB5-6FA3-4A32-B817-BCBCE4C93C4B">在降级Oracle数据库之前执行完全备份</a><br>Oracle强烈建议您在降级到受支持的早期版本之前执行新Oracle数据库发行版的完整备份。
                  </li>
                  <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-FC6DF99A-F32B-4258-8E5B-2DB5D7AD2A73">执行Oracle数据库所需的预迁移步骤</a><br>在将Oracle数据库降级到升级的早期版本之前，请完成此处所述的必需准备步骤。
                  </li>
                  <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-EF4B784F-BF90-48B5-80B5-3D4E209F8F8E">使用脚本降级CDB或非CDB Oracle数据库</a><br>为了自动降级，从Oracle Database 19c开始，Oracle提供了<code class="codeph">dbdowngrade</code>实用程序脚本。必要时，您还可以继续手动运行<code class="codeph">catdwgrd.sql</code> ，与以前的版本一样。
                  </li>
                  <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-F1FB354D-8C53-4E80-A4C9-A6366055028C">关于具有组件状态选项关闭的降级和无效对象</a><br>从降级版本的Oracle数据库标准版到带有CDB和PDBS的Oracle Database 12c标准版的降级包含更高版本后发布的无效对象。
                  </li>
                  <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-66560D5D-A5C8-4ACC-82C0-46315465E77F">降级单个可插拔Oracle数据库（PDB）</a><br>如果您要降级Oracle数据库，则可以降级一个PDB而不降级整个CDB。</li>
                  <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-EEC355DD-AA56-4972-9EB3-139CEC457D65">降级包含Oracle Application Express的PDB</a><br>在降级包含Oracle Application Express的PDB时，请使用此过程来避免APEX_050000错误导致的INVALID OBJECTS。
                  </li>
                  <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-5DF45F07-90FB-4AE2-9814-4956D60726E5">Oracle数据库降级后降级任务降级</a><br>由于影响兼容性，组件和支持的协议的更改，在降级Oracle数据库之后可能需要执行其他任务。
                  </li>
                  <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-F3DAC69A-A5D0-4998-A14D-DCC8599AD3FA">对Oracle数据库降级进行故障排除</a><br>使用此故障排除信息可以解决降级Oracle数据库时可能出现的问题。
                  </li>
               </ul>
            </div>
            <a id="UPGRD00710"></a><div class="props_rev_3"><a id="GUID-59F92E2A-DC4D-46A3-9AC9-63F47BE4A86F" name="GUID-59F92E2A-DC4D-46A3-9AC9-63F47BE4A86F"></a><h3 id="UPGRD-GUID-59F92E2A-DC4D-46A3-9AC9-63F47BE4A86F" class="sect3">支持降级Oracle数据库的版本</h3>
               <div>
                  <p>您可以根据升级数据库的原始Oracle数据库版本降级主要版本并发布更新或补丁集版本。</p>
                  <div class="section">
                     <p class="subhead2" id="GUID-59F92E2A-DC4D-46A3-9AC9-63F47BE4A86F__GUID-7580F70A-93C8-4024-82C2-53847CE00E09">降级支持的版本</p>
                     <p>您可以将非CDB Oracle数据库从Oracle Database 19c降级到Oracle Database 18c，Oracle Database 12c和Oracle Database 11g 11.2.0.4版。</p>
                     <p>您可以将PDB或CDB从Oracle Database 19c降级到Oracle Database 18c或Oracle Database 12c Release 2（12.2.0.1）</p>
                     <p>您可以将PDB或CDB降级到Oracle数据库18c，Oracle Database 12c版本12.2和Oracle Database 12c版本12.1.0.2。</p>
                     <div class="infoboxnote" id="GUID-59F92E2A-DC4D-46A3-9AC9-63F47BE4A86F__GUID-36FA6D07-0897-417C-9C5A-E686B44E8613">
                        <p class="notep1">注意：</p>
                        <p>从Oracle Database 12c第1版（12.1）开始，不推荐使用非CDB体系结构。它可以在将来的版本中得到支持。</p>
                     </div>
                     <p>下表提供了有关降级支持的版本的其他信息。使用此表时，还请阅读“在降级Oracle数据库时检查不兼容性”中的兼容性。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="tblformal" id="GUID-59F92E2A-DC4D-46A3-9AC9-63F47BE4A86F__CACGDDHC">
                     <p class="titleintable">表7-1降级支持的版本和版本</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="降级支持的版本和版本" width="100%" border="1" summary="Column 1 indicates if a release is supported for upgrade. Column 2 indicates if you can downgrade to the release specified in column 1. Column 3 provides further information about each release." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="20%" id="d51852e254">Oracle数据库发行版或版本</th>
                              <th align="left" valign="bottom" width="21%" id="d51852e257">可降级（是/否）</th>
                              <th align="left" valign="bottom" width="59%" id="d51852e260">笔记</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d51852e265" headers="d51852e254 ">
                                 <p>18</p>
                              </td>
                              <td align="left" valign="top" width="21%" headers="d51852e265 d51852e257 ">
                                 <p>是</p>
                              </td>
                              <td align="left" valign="top" width="59%" headers="d51852e265 d51852e260 ">
                                 <p>目前没有其他信息。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d51852e275" headers="d51852e254 ">
                                 <p>12.2.0.1和12.1.0.2</p>
                              </td>
                              <td align="left" valign="top" width="21%" headers="d51852e275 d51852e257 ">
                                 <p>是</p>
                              </td>
                              <td align="left" valign="top" width="59%" headers="d51852e275 d51852e260 ">
                                 <p>将兼容的初始化参数设置为12.1.0.2后，无法降级数据库。</p>
                                 <p>您可以将非CDB从19降级到18，或12.2降级到12.1.0.2或11.2.0.4（所有支持的升级版本）。</p>
                                 <p>在降级CDB之前，或在拔出和降级PDB之前，请安装最新的版本更新，版本修订，捆绑补丁或补丁集更新（BP或PSU）。可以在My Oracle Support上下载修补程序。请参阅My Oracle Support说明756671.1以获取最新的补丁集。</p>
                                 <p>您无法降级到早于新Oracle Database发行版的最低兼容性设置的版本。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d51852e291" headers="d51852e254 ">
                                 <p>Oracle企业管理器</p>
                              </td>
                              <td align="left" valign="top" width="21%" headers="d51852e291 d51852e257 ">
                                 <p>没有</p>
                              </td>
                              <td align="left" valign="top" width="59%" headers="d51852e291 d51852e260 ">
                                 <p>如果降级到早期支持的版本，则必须重新配置Oracle Enterprise Manager控件。</p>
                                 <p>在开始升级之前，必须使用<code>emdwgrd</code>实用程序来保存数据库控制文件和数据，以便在降级后还原Oracle Enterprise Manager数据库控制（数据库控制）。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d51852e306" headers="d51852e254 ">
                                 <p>Oracle数据库快捷版</p>
                              </td>
                              <td align="left" valign="top" width="21%" headers="d51852e306 d51852e257 ">
                                 <p>没有</p>
                              </td>
                              <td align="left" valign="top" width="59%" headers="d51852e306 d51852e260 ">
                                 <p>您无法降级从Oracle Database Express Edition升级的数据库。</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-59F92E2A-DC4D-46A3-9AC9-63F47BE4A86F__GUID-006B7A89-4476-43AD-B026-5AFC731765B8">降级前的审核建议</p>
                     <p>针对早期支持的版本的以下建议会影响Oracle数据库的降级：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>多租户架构为多租户容器数据库（CDB）和可插拔数据库（PDB）提供架构功能。如果要升级到多租户体系结构，并且在升级到此版本后将兼容的初始化参数设置为最高级别，则升级后无法降级数据库。</p>
                        </li>
                        <li>
                           <p>除了<code class="codeph">SELECT</code>之外，此版本还包含一个新的对象权限<code class="codeph">READ</code> 。降级后，请注意此对象权限的以下含义：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>如果您具有<code class="codeph">SELECT</code>和<code class="codeph">READ</code>对象权限，则删除<code class="codeph">READ</code>权限。
                                 </p>
                              </li>
                              <li>
                                 <p>如果以前只具有<code class="codeph">READ</code>对象权限，则<code class="codeph">READ</code>对象权限将转换为<code class="codeph">SELECT</code>对象权限。
                                 </p>
                              </li>
                           </ul>
                           <p>有关READ和SELECT对象权限的更多信息，请参阅Oracle数据库安全指南。</p>
                        </li>
                        <li>
                           <p>如果在升级的数据库中未安装Oracle XML DB，则在降级期间，将卸载Oracle XML DB。例如，如果未在Oracle Database 11g第2版（11.2）中安装Oracle XML DB，则Oracle XML DB随Oracle Database 12c一起安装。如果降级数据库，则会在降级过程中卸载Oracle XML DB。Oracle Database DB默认包含在Oracle Database 12c第1版（12.1）及更高版本中。</p>
                        </li>
                        <li>
                           <p>在升级到Oracle Database 12c期间，将删除数据库（DB）控制存储库。如果降级到早期版本，则必须重新配置数据库（DB）控件以在降级后使用它。</p>
                        </li>
                        <li>
                           <p>Oracle Enterprise Manager不支持降级。如果降级到早期支持的版本，则必须重新配置Oracle Enterprise Manager控件。</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="https://support.oracle.com/rs?type=doc&amp;id=756671.1" target="_blank">https://support.oracle.com/rs?type=doc&amp;id=756671.1</a></li>
                        <li><a href="../dbseg/configuring-privilege-and-role-authorization.html#DBSEG992" target="_blank"><span><cite>Oracle数据库安全指南</cite></span></a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：将</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-CAD9888A-2E6E-48F8-938C-B3E861738606" title="对于受支持的Oracle数据库版本，您可以将数据库降级到上次升级的版本。">Oracle数据库降级为早期版本</a></p>
                     </div>
                  </div>
               </div>
            </div><a id="UPGRD12554"></a><div class="props_rev_3"><a id="GUID-16E57DCD-0136-4E2D-8EB8-CE5572FCB010" name="GUID-16E57DCD-0136-4E2D-8EB8-CE5572FCB010"></a><h3 id="UPGRD-GUID-16E57DCD-0136-4E2D-8EB8-CE5572FCB010" class="sect3">降级Oracle数据库时检查不兼容性</h3>
               <div>
                  <p>要查看数据库是否存在可能阻止您降级的不兼容性，请检查数据库的兼容级别。</p>
                  <p>如果Oracle Database 12 <span class="italic">c</span>数据库的兼容级别为<code class="codeph">12.1.0</code> ，则无法降级。
                  </p>
                  <p>如果要降级到Oracle Database <span class="italic">11g第</span> 2版，则将<code class="codeph">COMPATIBLE</code>初始化参数设置为<code class="codeph">11.2.0</code>或更低。
                  </p>
                  <div class="infoboxnote" id="GUID-16E57DCD-0136-4E2D-8EB8-CE5572FCB010__GUID-FBB1C572-0428-4DDF-A91B-C8254E2AA0F7">
                     <p class="notep1">注意：</p>
                     <p>对于Oracle ASM磁盘组，如果在升级数据库时将磁盘组兼容性更改为12.1.0.0.0，则在降级到早期版本时，无法装入Oracle ASM磁盘组。</p>
                     <p>在降级之前，必须手动恢复Oracle ASM磁盘组的兼容性。否则，实例无法在降级后装入磁盘组。</p>
                  </div>
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-16E57DCD-0136-4E2D-8EB8-CE5572FCB010__GUID-CD3BD861-78B5-4A28-A46F-8B9CF766AC98">
                     <p class="notep1">也可以看看：</p>
                     <p>有关Oracle ASM磁盘组兼容性的信息，请参见<a href="../ostmg/diskgroup-compatibility.html#OSTMG02700" target="_blank"><span class="italic">“Oracle自动存储管理管理员指南”</span></a></p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：将</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-CAD9888A-2E6E-48F8-938C-B3E861738606" title="对于受支持的Oracle数据库版本，您可以将数据库降级到上次升级的版本。">Oracle数据库降级为早期版本</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="UPGRD12555"></a><div class="props_rev_3"><a id="GUID-FFECBDB5-6FA3-4A32-B817-BCBCE4C93C4B" name="GUID-FFECBDB5-6FA3-4A32-B817-BCBCE4C93C4B"></a><h3 id="UPGRD-GUID-FFECBDB5-6FA3-4A32-B817-BCBCE4C93C4B" class="sect3">在降级Oracle数据库之前执行完全备份</h3>
               <div>
                  <p>Oracle强烈建议您在降级到受支持的早期版本之前执行新Oracle数据库发行版的完整备份。</p>
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-FFECBDB5-6FA3-4A32-B817-BCBCE4C93C4B__GUID-7B294ABB-E676-4E24-8DEE-D1A2073F56BC">
                     <p class="notep1">也可以看看：</p>
                     <p>有关执行RMAN备份的信息，请参见<a href="../bradv/backing-up-database.html#BRADV8003" target="_blank"><span class="italic">“Oracle数据库备份和恢复用户指南”</span></a></p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：将</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-CAD9888A-2E6E-48F8-938C-B3E861738606" title="对于受支持的Oracle数据库版本，您可以将数据库降级到上次升级的版本。">Oracle数据库降级为早期版本</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="UPGRD60142"></a><div class="props_rev_3"><a id="GUID-FC6DF99A-F32B-4258-8E5B-2DB5D7AD2A73" name="GUID-FC6DF99A-F32B-4258-8E5B-2DB5D7AD2A73"></a><h3 id="UPGRD-GUID-FC6DF99A-F32B-4258-8E5B-2DB5D7AD2A73" class="sect3">执行Oracle数据库所需的预迁移步骤</h3>
               <div>
                  <p>在将Oracle数据库降级到升级的早期版本之前，请完成此处所述的必需准备步骤。</p>
                  <p>在开始降级之前，必须解决数据库版本之间的不兼容问题。例如，确定在开始降级之前是否必须禁用数据库中的组件。</p>
                  <ol>
                     <li>
                        <p>如果要降级CDB或拔出并降级Oracle数据库中的PDB，则必须先应用最新的季度版本更新（更新），版本更新版本（修订版），捆绑补丁或补丁集更新（BP或PSU）。在My Oracle Support Note 756671.1上应用任何必需的其他修补程序：</p>
                        <p><a href="https://support.oracle.com/rs?type=doc&amp;id=756671.1" target="_blank">https://support.oracle.com/rs?type=doc&amp;id=756671.1</a></p>
                     </li>
                     <li>
                        <p>如果已在数据库上启用Oracle Database Vault，则在降级数据库之前禁用Oracle Database Vault。</p>
                        <p>使用DBA_DV_STATUS查明是否启用了Oracle Database Vault：</p><pre class="pre codeblock"><code>SQL&gt; SELECT * FROM DBA_DV_STATUS;</code></pre><p>如果输出为<samp class="sysout">TRUE</samp> ，则启用Oracle Database Vault，因此必须禁用它。
                        </p>
                        <p>在多租户架构Oracle数据库系统上，使用CDB $ ROOT上的CDB_DV_STATUS查找插入CDB的所有PDB上的Oracle Database Vault状态：</p><pre class="pre codeblock"><code>SQL&gt; SELECT * FROM CDB_DV_STATUS;</code></pre></li>
                     <li>
                        <p>如果您的数据库使用Oracle Label Security，并且您要降级到版本11.2，则在新的Oracle Database 12 <span class="italic">c</span> Oracle主目录中运行Oracle Label Security（OLS）预处理降级<code>olspredowngrade.sql</code>脚本。
                        </p>
                        <div class="infoboxnote" id="GUID-FC6DF99A-F32B-4258-8E5B-2DB5D7AD2A73__GUID-DB90FA0E-7DD8-49FC-8AB7-2208F617E001">
                           <p class="notep1">警告：</p>
                           <p>对于使用Oracle Label Security和Oracle Database Vault的数据库，在从Oracle Database 12 <span class="italic">c</span>降级到数据库版本11.2之前运行<code>olspredowngrade.sql</code> 。
                           </p>
                        </div>
                        <ol type="a">
                           <li>
                              <p>查询<code class="codeph">V$OPTION</code>动态视图。确定是否已启用Oracle Label Security。例如：</p><pre class="pre codeblock"><code>SQL&gt; SELECT VALUE FROM V $ OPTION WHERE PARAMETER ='Oracle Label Security';</code></pre></li>
                           <li>
                              <p>运行<code>olspredowngrade.sql</code>脚本：</p><pre class="pre codeblock"><code>SQL&gt; @ <span class="variable" translate="no">ORACLE_HOME</span> /rdbms/admin/olspredowngrade.sql</code></pre></li>
                        </ol>
                     </li>
                     <li>
                        <p>如果已启用统一审核，则可以选择备份和清除统一审核跟踪：</p>
                        <ol type="a">
                           <li>
                              <p>查找是否存在统一审计记录。</p><pre class="pre codeblock"><code>SQL&gt; SELECT COUNT（*）FROM UNIFIED_AUDIT_TRAIL;</code></pre></li>
                           <li>
                              <p>将现有审计数据备份到表中。例如：</p><pre class="pre codeblock"><code>SQL&gt; CREATE TABLE UA_DATA AS（SELECT * FROM UNIFIED_AUDIT_TRAIL）;</code></pre></li>
                           <li>
                              <p>清理审计跟踪。</p><pre class="pre codeblock"><code>EXEC DBMS_AUDIT_MGMT.CLEAN_AUDIT_TRAIL（audit_trail_type =&gt; DBMS_AUDIT_MGMT.AUDIT_TRAIL_UNIFIED，use_last_arch_timestamp =&gt; FALSE）;</code></pre></li>
                        </ol>
                     </li>
                     <li>
                        <p>在降级之前，请确保降级数据库的目标Oracle Home包含数据库正在使用的时区文件的版本。</p>
                        <p>要查找数据库当前使用的时区文件版本，请使用以下命令查询<code class="codeph">V$TIMEZONE_FILE</code> ：</p><pre class="pre codeblock"><code>SQL&gt; select * from V $ TIMEZONE_FILE;</code></pre><p>例如：</p>
                        <p>如果查询在<code class="codeph">V$TIMEZONE_FILE.FILENAME</code>列中返回<code class="codeph">timezlrg_18.dat</code> ，则检查该文件是否存在于目标Oracle Home中：</p>
                        <p>Linux和UNIX</p><pre class="pre codeblock"><code>$ ORACLE_HOME / oracore / zoneinfo中/ timezlrg_18.dat</code></pre><p>视窗</p><pre class="pre codeblock"><code>％ORACLE_HOME％\ oracore \区信息\ timezlrg_18.dat</code></pre><p>如果目标Oracle Home中缺少所需的时区文件，请执行以下操作之一：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>如果您将当前版本的时区文件安装为修补程序，并且仍然知道修补程序编号，则使用相同的修补程序编号从My Oracle Support网站下载目标版本的相应时区文件。</p>
                           </li>
                           <li>
                              <p>使用My Oracle Support网站修补程序搜索功能找到正确的修补程序。输入以下搜索条件：“产品是'Oracle数据库'”，“发布是' <span class="variable" translate="no">target release</span> '”，“描述包含'DST'”。
                              </p>
                           </li>
                           <li>
                              <p>如果您无法在My Oracle Support网站上找到该修补程序，请使用Oracle Support记录服务请求。</p>
                           </li>
                        </ul>
                        <p>找到并下载所需的修补程序后，将其安装在目标Oracle主目录中。</p>
                     </li>
                     <li>
                        <p>如果您基于固定对象创建了对象，则删除这些对象以避免可能的<samp class="sysout">ORA-00600</samp>错误。您可以在降级后重新创建这些对象。
                        </p>
                     </li>
                     <li>
                        <p>如果在数据库中配置了Oracle Enterprise Manager，则删除企业管理器用户：</p><pre class="pre codeblock"><code>DROP USER sysman CASCADE;</code></pre><div class="infoboxnote" id="GUID-FC6DF99A-F32B-4258-8E5B-2DB5D7AD2A73__GUID-F8A87770-0FB2-4E6A-8DE3-B0DCE168DE9A">
                           <p class="notep1">注意：</p>
                           <p>删除企业管理器用户后，您会发现<code class="codeph">MGMT*</code>同义词无效。您必须重新配置Oracle Enterprise Manager以使用降级数据库中的任何Oracle Enterprise Manager控件。
                           </p>
                        </div>
                     </li>
                     <li>
                        <p>如果您要降级到已应用JSON捆绑补丁且使用简单Oracle文档访问（SODA）的Oracle Database 12 <span class="italic">c第</span> 1版（12.1.0.2），请确保应用JSON捆绑补丁（JSON补丁捆绑包1或JSON Patch Bundle 2）到Oracle Database 12.1.0.2二进制文件。有关更多信息，请查看以下My Oracle Support说明：</p>
                        <p><a href="https://support.oracle.com/rs?type=doc&amp;id=1992767.1" target="_blank">https://support.oracle.com/rs?type=doc&amp;id=1992767.1</a></p>
                     </li>
                     <li>
                        <p>从为您的版本列出的PSE获取适用于您的服务器操作系统的ARU。在开始降级之前，请下载并安装为早期版本列出的所有补丁：</p>
                        <ol type="a">
                           <li>
                              <p>登录My Oracle Support：</p>
                              <p><a href="https://support.oracle.com" target="_blank">https://support.oracle.com</a></p>
                           </li>
                           <li>
                              <p>选择<span class="uicontrol bold">修补程序和更新</span> 。在“ <span class="wintitle">修补程序搜索”</span>框中，提供为您的版本列出的错误编号，并为您的服务器提供平台。
                              </p>
                           </li>
                           <li>
                              <p>下载并安装补丁</p>
                           </li>
                           <li>
                              <p>重复操作，直到为服务器安装了所有必需的修补程序。</p>
                           </li>
                        </ol>
                        <p>获取适用于您的版本的补丁：</p>
                        <p>从18c降级到12.2</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>2414935.1：在将Oracle GI和DB升级到18c之前要应用的修补程序</p>
                           </li>
                           <li>
                              <p>2118136.2：助手：下载Oracle数据库/ GI更新，版本，PSU，SPU（CPU），软件包补丁，补丁集和基本版本的参考</p>
                           </li>
                        </ul>
                        <p>用CDB和PDB从18c降级到12.1.0.2.0</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>25755742：数据库补丁设置更新12.1.0.2.170718或最新的12.1.0.2.0数据库补丁集更新</p>
                           </li>
                           <li>
                              <p>24438034：CDB_UPG：12101 CDB UPGRADE LEFT OBJECT CDB_JAVA_POLICY INVALID</p>
                           </li>
                           <li>
                              <p>20348910：使用创建或替换类型替换PRVTAQJI.SQL中的ALTER TYPE替换</p>
                           </li>
                           <li>
                              <p>20958816：从12.2.0.1降至12.1.0.2之后的无效对象</p>
                           </li>
                        </ul>
                        <p>非CDB从18c降至12.1.0.2.0</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>25755742：数据库补丁设置更新12.1.0.2.170718或最新的12.1.0.2.0数据库补丁集更新</p>
                           </li>
                           <li>
                              <p>24438034：CDB_UPG：12101 CDB UPGRADE LEFT OBJECT CDB_JAVA_POLICY INVALID</p>
                           </li>
                           <li>
                              <p>20348910：使用创建或替换类型替换PRVTAQJI.SQL中的ALTER TYPE替换</p>
                           </li>
                           <li>
                              <p>20958816：从12.2.0.1降至12.1.0.2之后的无效对象</p>
                           </li>
                           <li>
                              <p>21856522：升级12.1到12.2导致XOQ组件无效</p>
                           </li>
                        </ul>
                        <p>从18c降级到11.2.0.4.0</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>23054359：数据库补丁设置更新11.2.0.4</p>
                           </li>
                           <li>
                              <p>20898997：XMLTYPESUP：QCTOXSNLB不应检查快照尺寸</p>
                           </li>
                           <li>
                              <p>20348910：使用创建或替换类型替换PRVTAQJI.SQL中的ALTER TYPE替换</p>
                           </li>
                        </ul>
                     </li>
                  </ol>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="../olsag/performing-dba-functions-under-oracle-label-security.html#OLSAG3416" target="_blank"><span><cite>Oracle Label Security管理员指南</cite></span></a></li>
                        <li><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/upgrd&amp;id=NLSPG004" target="_blank"><span><cite>Oracle数据库全球化支持指南</cite></span></a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：将</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-CAD9888A-2E6E-48F8-938C-B3E861738606" title="对于受支持的Oracle数据库版本，您可以将数据库降级到上次升级的版本。">Oracle数据库降级为早期版本</a></p>
                     </div>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-EF4B784F-BF90-48B5-80B5-3D4E209F8F8E" name="GUID-EF4B784F-BF90-48B5-80B5-3D4E209F8F8E"></a><h3 id="UPGRD-GUID-EF4B784F-BF90-48B5-80B5-3D4E209F8F8E" class="sect3">使用脚本降级CDB或非CDB Oracle数据库</h3>
               <div>
                  <p>为了自动降级，从Oracle Database 19c开始，Oracle提供了<code class="codeph">dbdowngrade</code>实用程序脚本。必要时，您还可以继续手动运行<code class="codeph">catdwgrd.sql</code> ，与以前的版本一样。
                  </p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-EAF290FD-5F22-4FEE-829D-B3587168471F">使用Dbdowngrade降级CDB和非CDB Oracle数据库</a><br>要将Oracle数据库降级到早期支持的主要版本或更早版本更新，Oracle建议您运行降级脚本<code class="codeph">dbdowngrade</code> 。
                     </li>
                     <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-0227D321-577E-47C5-A8C0-36991B8D0357">使用catdwgrd.sql手动降级CDB或非CDB Oracle数据库</a><br>您可以运行手动<code class="codeph">catdwgrd.sql</code>脚本以将Oracle数据库降级到较早的受支持主要版本或早期版本更新，您可能希望运行手动脚本，或者希望避免过多的线程问题。
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：将</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-CAD9888A-2E6E-48F8-938C-B3E861738606" title="对于受支持的Oracle数据库版本，您可以将数据库降级到上次升级的版本。">Oracle数据库降级为早期版本</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="sect3"><a id="GUID-EAF290FD-5F22-4FEE-829D-B3587168471F" name="GUID-EAF290FD-5F22-4FEE-829D-B3587168471F"></a><h4 id="UPGRD-GUID-EAF290FD-5F22-4FEE-829D-B3587168471F" class="sect4">使用Dbdowngrade降级CDB和非CDB Oracle数据库</h4>
                  <div>
                     <p>要将Oracle数据库降级到早期支持的主要版本或更早版本更新，Oracle建议您运行降级脚本<code class="codeph">dbdowngrade</code> 。
                     </p>
                     <div class="section">
                        <p>从Oracle Database 19c开始，Oracle提供了降级实用程序脚本<code class="codeph">dbdowngrade</code> 。当您使用dbdowngrade实用程序时，它会为降级设置适当的值，并简化您开始降级的方式。具体来说，它确保对<code class="codeph">catcon.pl</code>的底层调用使用建议值，从而减少由于生成过多线程而导致的潜在错误。此功能对于多租户架构（CDB）数据库的降级特别有价值。当存在过多线程的可能性时，您可以通过手动运行<code class="codeph">catdwgrd.sql</code>脚本来继续降级，就像在以前的版本中一样。
                        </p>
                        <p><code class="codeph">dbdowngrade</code> shell命令位于Linux和Unix上的文件路径<code class="codeph">$ORACLE_HOME/bin</code> ，以及基于Microsoft Windows的系统上的<code class="codeph">%ORACLE_HOME%\bin</code> 。如果要降级CDB，则可以将包含列表作为脚本的参数提供。
                        </p>
                        <p>当您降级多租户架构数据库（CDB）时， <code class="codeph">dbdowngrade</code>脚本有两种行为，具体取决于您是否使用包含列表。
                        </p>
                        <ul id="GUID-EAF290FD-5F22-4FEE-829D-B3587168471F__UL_BW3_4YD_CGB" style="list-style-type:disc">
                           <li>
                              <p><span class="bold">没有包含列表</span> 。降级将在CDB（PDB和CDB）中打开的所有容器上运行。
                              </p>
                              <p>如果要降级整个CDB，请运行不带包含列表的降级。在这种情况下，所有打开的容器都会降级。在启动<code class="codeph">dbdowngrade</code>脚本之前，必须手动打开CDB中的所有PDB。
                              </p>
                           </li>
                           <li>
                              <p><span class="bold">包含列表</span> 。降级仅在包含列表中的PDB上运行，并且在降级操作期间CDB $ ROOT不会降级。
                              </p>
                              <p>如果只想降级包含列表中列出的PDB集，请使用包含列表运行降级。在此方案中，您要使用拔出和插件升级，只会降低您在包含列表中列出的一组PDB。不在包含列表中的CDB和PDB仍然升级到更高版本。</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="p">
                        <p>先决条件：</p>
                        <ul id="GUID-EAF290FD-5F22-4FEE-829D-B3587168471F__UL_ZKW_RZD_CGB" style="list-style-type:disc">
                           <li>
                              <p>如果要从Oracle Database 19c降级到Oracle Database 18c，Oracle Database 12.2或Oracle Database 12.1，则可以降级多租户容器数据库（CDB）中的所有数据库或CDB中的一个可插拔数据库（PDB）。早于Oracle Database 12c的Oracle数据库版本不使用多租户架构。</p>
                           </li>
                           <li>如果在没有包含列表的情况下降级，则必须在运行<code class="codeph">dbdowngrade</code>脚本之前打开所有PDB容器。
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>将ORACLE_HOME环境变量设置为已升级的Oracle数据库版本的Oracle主目录</span></li>
                        <li class="stepexpand"><span>将ORACLE_SID环境变量设置为要降级的Oracle数据库。</span></li>
                        <li class="stepexpand"><span>使用默认值或包含列表启动<code class="codeph">dbdowngrade</code>脚本。</span><div>
                              <p>如果您使用包含列表，则CDB $ ROOT不得在您的包含列表中。</p>
                           </div>
                           <div>
                              <p>例如：</p><code>使用默认值运行</code><p>Linux和Unix</p><pre class="pre codeblock"><code>$ cd $ ORACLE_HOME / bin $。/ dbdowngrade</code></pre><p>微软Windows</p><pre class="pre codeblock"><code>$ cd％ORACLE_HOME％\ bin $ dbdowngrade.cmd</code></pre><code>与CDB的包含列表一起运行</code><p>Linux和Unix</p><pre class="pre codeblock"><code>$ cd $ ORACLE_HOME / bin $。/ dbdowngrade -c'PDB1 PDB2 PDBN'</code></pre><p>微软Windows</p><pre class="pre codeblock"><code>$ cd％ORACLE_HOME％\ bin $ dbdowngrade.cmd -c“PDB1 PDB2 PDBN”</code></pre></div>
                        </li>
                     </ol>
                     <div class="section">
                        <p>运行<code class="codeph">dbdowngrade</code>脚本后，该实用程序将运行<code class="codeph">catdwgrd</code>和<code class="codeph">catcon.pl</code> 。这些脚本使用您要降级的版本的建议值来执行降级。由降级脚本生成的日志文件放在这三个选项之一的第一个目录下，按顺序排列：</p>
                        <ul id="GUID-EAF290FD-5F22-4FEE-829D-B3587168471F__UL_YDR_3PJ_CGB" style="list-style-type:disc">
                           <li>
                              <p>由<code class="codeph">orabasehome</code>命令标识的Oracle基础主<code class="codeph">orabasehome</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">orabase</code>命令标识的Oracle基础主<code class="codeph">orabase</code></p>
                           </li>
                           <li>
                              <p>由<code class="codeph">oracle_home</code>命令标识的Oracle主目录</p>
                           </li>
                        </ul>
                        <div class="p">例如：<pre class="pre codeblock"><code>$ $ ORACLE_HOME / bin / orabasehome /u01/app/oracle/product/19.0.0/dbhome_1</code></pre>在此示例中，$ ORACLE_BASE目录为<code class="codeph">/u01/app/oracle/product/19.0.0/dbhome_1</code> ，日志位于<code class="codeph">/u01/app/oracle/product/19.0.0/dbhome_1/cfgtoollogs/downgrade</code> 。在目录中，日志文件以字符串<code class="codeph">catdwgrd</code>为前缀。
                        </div>
                        <div class="infoboxnote" id="GUID-EAF290FD-5F22-4FEE-829D-B3587168471F__GUID-0799D96A-CE03-4F8C-BA04-517CAE3272D6">
                           <p class="notep1">注意：</p>
                           <ul id="GUID-EAF290FD-5F22-4FEE-829D-B3587168471F__UL_ODW_TJJ_CGB" style="list-style-type:disc">
                              <li>
                                 <p>读写Oracle家庭：命令<code class="codeph">orabaseconfig</code>和<code class="codeph">orabasehome</code>都返回ORACLE_HOME的环境设置。</p>
                              </li>
                              <li>
                                 <p>只读Oracle主目录：命令<code class="codeph">orabaseconfig</code>在路径<code class="codeph">$ORACLE_BASE/homes</code>返回Oracle基础的只读路径配置。
                                 </p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-EF4B784F-BF90-48B5-80B5-3D4E209F8F8E" title="为了自动降级，从Oracle Database 19c开始，Oracle提供了dbdowngrade实用程序脚本。必要时，您还可以继续手动运行catdwgrd.sql，与以前的版本一样。">使用脚本降级CDB或非CDB Oracle数据库</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-0227D321-577E-47C5-A8C0-36991B8D0357" name="GUID-0227D321-577E-47C5-A8C0-36991B8D0357"></a><h4 id="UPGRD-GUID-0227D321-577E-47C5-A8C0-36991B8D0357" class="sect4">使用catdwgrd.sql手动降级CDB或非CDB Oracle数据库</h4>
                  <div>
                     <p>您可以运行手动<code class="codeph">catdwgrd.sql</code>脚本以将Oracle数据库降级到较早的受支持主要版本或早期版本更新，您可能希望运行手动脚本，或者希望避免过多的线程问题。
                     </p>
                     <div class="section">
                        <p>如果要从Oracle Database 19c降级到Oracle Database 18c，Oracle Database 12.2或Oracle Database 12.1，则可以降级多租户容器数据库（CDB）中的所有数据库或CDB中的一个可插拔数据库（PDB）。早于Oracle Database 12c的Oracle数据库版本不使用多租户架构。</p>
                        <div class="infoboxnote" id="GUID-0227D321-577E-47C5-A8C0-36991B8D0357__GUID-33208AE2-97CD-4E76-A3AE-A709BEE94AE6">
                           <p class="notep1">注意：</p>
                           <p>从Oracle Database 12c第1版（12.1）开始，不推荐使用非CDB体系结构。它可以在将来的版本中得到支持。</p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>以Oracle Database Oracle主目录的所有者身份登录系统。</span></li>
                        <li class="stepexpand"><span>在系统提示符下，切换到目录<code class="codeph"><span class="variable" translate="no">ORACLE_HOME</span> /rdbms/admin</code> ，其中<code class="codeph"><span class="variable" translate="no">ORACLE_HOME</span></code>是系统上的Oracle主目录。</span><div>
                              <div class="infoboxnote" id="GUID-0227D321-577E-47C5-A8C0-36991B8D0357__GUID-A7F329F3-06E7-469E-A4F1-10C2BA6EF7E4">
                                 <p class="notep1">注意：</p>
                                 <p>如果要降级群集数据库，请完全关闭数据库，并将初始化参数<code class="codeph">CLUSTER_DATABASE</code>的值更改为<code class="codeph">FALSE</code> 。降级后，将此参数设置为<code class="codeph">TRUE</code> 。</p>
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>使用SQL * Plus，以具有<code class="codeph">SYSDBA</code>权限的用户身份连接到数据库实例：</span><div><pre class="pre codeblock"><code>sqlplus sys as sysdba输入密码： <span class="variable" translate="no">password</span>
</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>以新Oracle数据库发行版Oracle主目录的Oracle用户（所有者）身份登录系统。</span></li>
                        <li class="stepexpand"><span>将目录更改为<code class="codeph"><span class="variable" translate="no">ORACLE_HOME</span> /rdbms/admin</code> ，然后启动SQL * Plus。</span></li>
                        <li class="stepexpand"><span>使用具有DBA权限的帐户连接到要升级的数据库：</span><div><pre class="pre codeblock"><code>CONNECT / AS SYSDBA</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>通过为Oracle数据库实例类型发出以下SQL * Plus命令，以降级模式启动实例。您可能需要使用<code class="codeph">PFILE</code>选项指定初始化参数文件的位置。</span><ul>
                              <li>
                                 <p>非CDB实例：</p><pre class="pre codeblock"><code>SQL&gt; startup downgrade pfile = <span class="variable" translate="no">pfile_name</span>
</code></pre></li>
                              <li>
                                 <p>CDB实例：</p><pre class="pre codeblock"><code>SQL&gt; startup downgrade pfile = <span class="variable" translate="no">pfile_name</span> SQL&gt; alter pluggable database all open downgrade;</code></pre></li>
                           </ul>
                           <div>
                              <p>指定初始化参数文件<code class="codeph">PFILE</code>的位置。</p>
                              <div class="infoboxnotealso" id="GUID-0227D321-577E-47C5-A8C0-36991B8D0357__GUID-072F0FC7-6B87-4CC6-B0F0-B6CB3FD90EA0">
                                 <p class="notep1">也可以看看：</p>
                                 <p>有关在启动时指定初始化参数和初始化参数文件的信息，请参见<a href="../admin/starting-up-and-shutting-down.html#ADMIN12825" target="_blank"><span><cite>“Oracle数据库管理员指南”</cite></span></a></p>
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>（可选）如果要降级非CDB，则可以将系统设置为将结果假脱机到日志文件，以便跟踪更改和问题。</span><div>
                              <p>如果要降级CDB，则无需执行此步骤。CDB自动将输出假脱机到<code class="codeph">catcon_logs</code> 。
                              </p>
                              <p>在非CDB上，输入以下命令将结果假脱机到日志文件，其中<code class="codeph">downgrade.log</code>是日志文件的名称：</p>
                           </div>
                           <div><pre class="pre codeblock"><code>SQL&gt; SPOOL downgrade.log</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>使用以下命令启动降级，具体取决于您的配置：</span><ul>
                              <li>
                                 <p>非国开行：</p><pre class="pre codeblock"><code>SQL&gt; @ catdwgrd.sql</code></pre></li>
                              <li>
                                 <p>CDB：</p><pre class="pre codeblock"><code>$ ORACLE_HOME / perl / bin / perl $ ORACLE_HOME / rdbms / admin / catcon.pl -d $ ORACLE_HOME / rdbms / admin -e -b catdwgrd -l <span class="variable" translate="no">output directory</span> -r catdwgrd.sql</code></pre></li>
                           </ul>
                           <div>
                              <p>在CDB示例中， <code>catdwgrd.sql</code>使用<code>catcon.pl</code>在容器上运行。要使用<code>catcon.pl</code>实用程序运行命令，首先要启动Perl。<code class="codeph">-d</code>参数告诉<code>catcon.pl</code>在哪里找到<code>catdwgrd</code> 。<code class="codeph">-l</code>参数指定日志文件的输出目录（而不是写入<code>rdbms/admin</code>目录）。指定<code class="codeph">-r</code>参数会导致<code>catdwgrd</code>首先在PDB上运行，第二个在CDB_ROOT上运行。</p>
                              <p>降级CDB时使用<code class="codeph">-r</code>参数运行<code>catdwgrd</code> 。 <code class="codeph">–r</code>参数更改脚本运行的默认顺序，以便脚本在所有PDB中运行，然后在CDB_ROOT中运行。</p>
                              <div class="infoboxnote" id="GUID-0227D321-577E-47C5-A8C0-36991B8D0357__GUID-EAB6D4C4-8286-41DC-8F60-DB0BE0F702B6">
                                 <p class="notep1">注意：</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p>使用新Oracle数据库发行版附带的<code class="codeph">catdwgrd.sql</code>脚本的版本。
                                       </p>
                                    </li>
                                    <li>
                                       <p>降级CDB时使用<code class="codeph">-r</code>参数运行<code class="codeph">catdwgrd</code> 。</p>
                                    </li>
                                    <li>
                                       <p>在新的Oracle数据库发行版环境中运行<code class="codeph">catdwgrd.sql</code> 。
                                       </p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">catdwgrd.sql</code>脚本将数据库中的所有Oracle数据库组件降级到升级的版本。降级要么是升级后支持的主要版本，要么是升级后的补丁版本。
                                       </p>
                                    </li>
                                 </ul>
                              </div>
                              <p>如果要降级多租户环境数据库，并且<code>catdwgrd.sql</code>命令遇到故障，请查看错误消息。在继续之前，请检查<code class="codeph">CDB$ROOT</code>或PDB中存在哪些问题。查看“排除Oracle数据库降级故障”部分。修复错误中陈述的问题。解决错误后，使用<code>catcon.pl</code> ， <code class="codeph">catcon.pl -c 'cdb,pdb' -r</code>语法，使用<code>catcon.pl</code>实用程序重新运行<code>catdgwrd.sq</code> 。
                              </p>
                              <div class="infoboxnote" id="GUID-0227D321-577E-47C5-A8C0-36991B8D0357__GUID-6AE4C9D3-07D5-427F-8F28-4105F9DD12FD">
                                 <p class="notep1">警告：</p>
                                 <p>如果组件的降级失败，则会显示<code class="codeph">ORA-39709</code>错误。SQL * Plus会话终止而不降级Oracle数据库数据字典。在降级Oracle数据库数据字典之前，必须成功降级所有组件。在重新运行<code>catdwgrd.sql</code>脚本之前确定并修复问题。
                                 </p>
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>仅对于非CDB，如果您打开了假脱机，则关闭脚本结果的假脱机到日志文件：</span><div><pre class="pre codeblock"><code>SQL&gt; SPOOL OFF</code></pre><p>检查假脱机文件，并确认在降级期间没有发生错误。您在步骤8中命名了假脱机文件，建议的名称为<code class="codeph">downgrade.log</code> 。纠正在此文件中找到的任何问题。如有必要，请重新运行降级脚本。
                              </p>
                           </div>
                           <div>
                              <div class="infoboxnote" id="GUID-0227D321-577E-47C5-A8C0-36991B8D0357__GUID-D93C480D-DF41-4A5D-B0F1-6561EA414026">
                                 <p class="notep1">注意：</p>
                                 <p>保存第一次运行降级脚本时的结果。在重新运行降级脚本之前，请将文件<code class="codeph">downgrade.log</code>重命名为其他名称，以便在重新运行脚本时不会覆盖该名称。
                                 </p>
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>关闭实例：</span><div><pre class="pre codeblock"><code>SQL&gt; SHUTDOWN IMMEDIATE</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>退出SQL * Plus。</span></li>
                        <li class="stepexpand"><span>如果您的操作系统是Linux或UNIX，则更改以下环境变量以指向要降级的版本的目录：</span><ul>
                              <li>
                                 <p>Linux和UNIX系统</p>
                                 <p>更改以下环境变量以指向要降级的版本的目录：</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p><code class="codeph">ORACLE_HOME</code></p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">路径</code></p>
                                    </li>
                                 </ul>
                                 <p>还要检查<code class="codeph">oratab</code>文件以及设置<code class="codeph">ORACLE_HOME</code>值的任何客户端脚本是否指向降级的Oracle主目录。
                                 </p>
                                 <div class="infoboxnotealso" id="GUID-0227D321-577E-47C5-A8C0-36991B8D0357__GUID-1D10C9D2-23C9-4C0D-A855-57266297E589">
                                    <p class="notep1">也可以看看：</p>
                                    <p>适用于您的操作系统的<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/upgrd&amp;id=GINST" target="_blank"><span><cite>Oracle数据库安装指南</cite></span></a> ，以获取有关在操作系统上设置其他重要环境变量的信</p>
                                 </div>
                              </li>
                              <li>
                                 <p>Microsoft Windows系统</p>
                                 <ol type="a">
                                    <li>
                                       <p>停止所有Oracle服务，包括Oracle Database 12c数据库的<code class="codeph">OracleService <span class="variable" translate="no">SID</span></code> Oracle服务，其中<code class="codeph"><span class="variable" translate="no">SID</span></code>是实例名称。
                                       </p>
                                       <p>例如，如果您的<span class="variable" translate="no">SID</span>是<code class="codeph">ORCL</code> ，则在命令提示符处输入以下内容：</p><pre class="pre codeblock"><code>C：\&gt; NET STOP OracleServiceORCL</code></pre><div class="infoboxnotealso" id="GUID-0227D321-577E-47C5-A8C0-36991B8D0357__GUID-21EBB256-7F58-4846-BC96-E9A64F3C24D2">
                                          <p class="notep1">也可以看看：</p>
                                          <p>有关在Windows上停止Oracle服务的详细信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/upgrd&amp;id=NTQRF206" target="_blank"><span><cite>适用于Microsoft Windows的Oracle数据库管理员参考</cite></span></a></p>
                                       </div>
                                    </li>
                                    <li>
                                       <p>通过发出命令<code class="codeph">ORADIM</code>在命令提示符处删除Oracle服务。</p>
                                       <p>例如，如果您的<span class="variable" translate="no">SID</span>是<code class="codeph">ORCL</code> ，则输入以下命令：</p><pre class="pre codeblock"><code>C：\&gt; ORADIM -DELETE -SID ORCL</code></pre><p>使用命令<code class="codeph">ORADIM</code>在命令提示符下创建要降级的数据库的Oracle服务：</p><pre class="pre codeblock"><code>C：\&gt; ORADIM -NEW -SID <span class="variable" translate="no">SID</span> -INTPWD <span class="variable" translate="no">PASSWORD</span> -MAXUSERS <span class="variable" translate="no">USERS</span> -STARTMODE MANUAL -PFILE <span class="variable" translate="no">ORACLE_HOME</span> \ DATABASE \ INIT <span class="variable" translate="no">SID</span> .ORA</code></pre><p><code class="codeph">ORADIM</code>的语法包括以下变量：</p>
                                       <div class="tblformal" id="GUID-0227D321-577E-47C5-A8C0-36991B8D0357__GUID-6ECD3048-96E0-4F39-8437-1C8AEA8F171A">
                                          <table cellpadding="4" cellspacing="0" class="Formal" title="" width="90%" border="1" summary="Syntax and variables for ORADIM, listing the variable, and listing the description" frame="hsides" rules="rows">
                                             <thead>
                                                <tr align="left" valign="top">
                                                   <th align="left" valign="bottom" width="21%" id="d51852e1837">变量</th>
                                                   <th align="left" valign="bottom" width="79%" id="d51852e1840">描述</th>
                                                </tr>
                                             </thead>
                                             <tbody>
                                                <tr align="left" valign="top">
                                                   <td align="left" valign="top" width="21%" id="d51852e1845" headers="d51852e1837 ">
                                                      <p><span class="variable" translate="no">SID</span></p>
                                                   </td>
                                                   <td align="left" valign="top" width="79%" headers="d51852e1845 d51852e1840 ">
                                                      <p>与要降级的数据库的SID相同的系统标识符（SID）名称。</p>
                                                   </td>
                                                </tr>
                                                <tr align="left" valign="top">
                                                   <td align="left" valign="top" width="21%" id="d51852e1853" headers="d51852e1837 ">
                                                      <p><span class="variable" translate="no">密码</span></p>
                                                   </td>
                                                   <td align="left" valign="top" width="79%" headers="d51852e1853 d51852e1840 ">
                                                      <p>数据库实例的密码。此密码是与<code class="codeph">SYSDBA</code>权限关联的用户的密码。<code class="codeph">-INTPWD</code>选项不是必需的。如果系统提示您输入密码，请使用此Windows平台的标准用户帐户的密码。
                                                      </p>
                                                   </td>
                                                </tr>
                                                <tr align="left" valign="top">
                                                   <td align="left" valign="top" width="21%" id="d51852e1867" headers="d51852e1837 ">
                                                      <p><span class="variable" translate="no">USERS</span></p>
                                                   </td>
                                                   <td align="left" valign="top" width="79%" headers="d51852e1867 d51852e1840 ">
                                                      <p>可授予<code class="codeph">SYSDBA</code>和<code class="codeph">SYSOPER</code>权限的最大用户数。
                                                      </p>
                                                   </td>
                                                </tr>
                                                <tr align="left" valign="top">
                                                   <td align="left" valign="top" width="21%" id="d51852e1881" headers="d51852e1837 ">
                                                      <p><span class="variable" translate="no">ORACLE_HOME</span></p>
                                                   </td>
                                                   <td align="left" valign="top" width="79%" headers="d51852e1881 d51852e1840 ">
                                                      <p>要降级的数据库的Oracle主目录。确保使用选项<code class="codeph">-PFILE</code>指定完整路径名，包括安装Oracle主目录的驱动器号。
                                                      </p>
                                                      <p>有关在启动时指定初始化参数的信息，以及有关初始化参数文件的信息，请参见“ <cite>Oracle数据库管理员指南”</cite> 。
                                                      </p>
                                                   </td>
                                                </tr>
                                             </tbody>
                                          </table>
                                       </div>
                                       <!-- class="inftblhruleinformal" -->
                                       <p>例如，如果您的<span class="variable" translate="no">SID</span>是<code class="codeph">ORCL</code> ，则您的<span class="variable" translate="no">PASSWORD</span>是<code class="codeph">TWxy5791</code> ， <span class="variable" translate="no">USERS</span>的最大数量是<code class="codeph">10</code> ， <span class="variable" translate="no">ORACLE_HOME</span>目录是<code class="codeph">C:\ORANT</code> ，然后输入以下命令：</p><pre class="oac_no_warn" dir="ltr">C：\&gt; ORADIM -NEW -SID ORCL -INTPWD TWxy5791 -MAXUSERS 10 -STARTMODE AUTO -PFILE C：\ ORANT \ DATABASE \ INITORCL.ORA</pre><div class="infoboxnote" id="GUID-0227D321-577E-47C5-A8C0-36991B8D0357__GUID-D5D20E7F-36CB-4F3F-8E13-B6136C350F36">
                                          <p class="notep1">注意：</p>
                                          <p><code class="codeph">ORADIM</code>命令提示您输入Oracle主用户帐户的密码。您可以使用<code class="codeph">ORADIM</code>指定其他选项。</p>
                                          <p>降级数据库时，不需要更改任何Windows注册表设置。<code class="codeph">ORADIM</code>实用程序自动进行所有必要的更改。
                                          </p>
                                       </div>
                                       <div class="infoboxnotealso" id="GUID-0227D321-577E-47C5-A8C0-36991B8D0357__GUID-18E83A45-EFE2-4D0B-92B5-7706D851759E">
                                          <p class="notep1">也可以看看：</p>
                                          <p>有关使用<code class="codeph">ORADIM</code>管理Oracle数据库实例的信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/upgrd&amp;id=NTQRF05011" target="_blank"><span><cite>Microsoft Windows的Oracle数据库管理员参考</cite></span></a></p>
                                       </div>
                                    </li>
                                 </ol>
                              </li>
                           </ul>
                        </li>
                        <li class="stepexpand"><span>恢复要降级的版本的配置文件（例如，参数文件，密码文件等）。</span><div>
                              <p>如果数据库是Oracle RAC数据库，则运行以下命令将数据库返回到单实例模式：</p><pre class="pre codeblock"><code>SET CLUSTER_DATABASE = FALSE</code></pre><div class="infoboxnote" id="GUID-0227D321-577E-47C5-A8C0-36991B8D0357__GUID-4C04E65D-B393-4841-88D5-2405CD35AE55">
                                 <p class="notep1">注意：</p>
                                 <p>如果要降级群集数据库，请在此群集数据库已配置实例的所有节点上执行此步骤。将初始化参数<code class="codeph">CLUSTER_DATABASE</code>的值设置为<code class="codeph">FALSE</code> 。降级后，将此初始化参数设置回<code class="codeph">TRUE</code> 。</p>
                              </div>
                              <div class="infoboxnotealso" id="GUID-0227D321-577E-47C5-A8C0-36991B8D0357__GUID-978244AA-F04B-48DD-8369-4E69713FFD5F">
                                 <p class="notep1">也可以看看：</p>
                                 <p><a href="../racad/administering-database-instances-and-cluster-databases.html#RACAD017" target="_blank"><span><cite>“Oracle Real Application Clusters管理和部署指南”，</cite></span></a>以获取有关Oracle RAC中初始化参数使用的信息</p>
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>在系统提示符下，切换到要降级的早期版本的Oracle主目录中的<code class="codeph">admin</code>目录。（ <code><span class="variable" translate="no">ORACLE_HOME</span> /rdbms/admin</code> ，其中<code class="codeph"><span class="variable" translate="no">ORACLE_HOME</span></code>是早期版本Oracle主目录的路径。）</span></li>
                        <li class="stepexpand"><span>启动SQL * Plus，并以具有SYSDBA权限的用户身份连接到数据库实例。</span><ul>
                              <li>
                                 <p>对于非CDB：</p><pre class="pre codeblock"><code>SQL&gt; CONNECT / AS SYSDBA SQL&gt;启动升级</code></pre></li>
                              <li>
                                 <p>对于CDB：</p><pre class="pre codeblock"><code>connect / as sysdba startup upgrade; alter pluggable database全部开放升级;</code></pre></li>
                           </ul>
                        </li>
                        <li class="stepexpand"><span>（可选）对于非CDB，将系统设置为将结果假脱机到日志文件以跟踪更改和问题。CDB不需要此步骤。</span><div><pre class="pre codeblock"><code>SQL&gt; SPOOL reload.log</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>运行<code>catrelod.sql</code>非CDB数据库，或使用<code>catcon.pl</code>运行<code>utlrp.sql</code>的CDB数据库。</span><ul>
                              <li>
                                 <p>对于非CDB：</p><pre class="pre codeblock"><code>SQL&gt; $ ORACLE_HOME / rdbms / admin / catrelod.sql</code></pre></li>
                              <li>
                                 <p>对于CDB：</p><pre class="oac_no_warn" dir="ltr">$ ORACLE_HOME / perl / bin / perl $ ORACLE_HOME / rdbms / admin / catcon.pl -n 1 -e -b catrelod -d $ ORACLE_HOME / rdbms / admin catrelod.sql</pre></li>
                           </ul>
                           <div>
                              <p>此命令为降级的数据库中的每个数据库组件重新加载适当的版本。</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>如果为非CDB打开假脱机，则关闭脚本结果假脱机到日志文件：</span><div><pre class="pre codeblock"><code>SQL&gt; SPOOL OFF</code></pre><p>检查假脱机文件，并验证是否已成功编译包和过程。更正在此日志文件中找到的任何问题，并在必要时重新运行相应的脚本。</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>关闭并重新启动实例以进行正常操作：</span><div><pre class="pre codeblock"><code>SQL&gt; SHUTDOWN IMMEDIATE SQL&gt; STARTUP</code></pre></div>
                           <div>
                              <p>您可能需要使用<code class="codeph">PFILE</code>选项指定初始化参数文件的位置。
                              </p>
                              <div class="infoboxnotealso" id="GUID-0227D321-577E-47C5-A8C0-36991B8D0357__GUID-CCEBC3D1-9DE2-47F8-82E2-1BC60D12E229">
                                 <p class="notep1">也可以看看：</p>
                                 <p>有关在启动时和初始化参数文件中指定初始化参数的信息，请参见“ <a href="../admin/starting-up-and-shutting-down.html#ADMIN12825" target="_blank"><span><cite>Oracle数据库管理员指南”</cite></span></a></p>
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>如果您将数据库配置为使用Oracle Label Security，请完成此步骤。如果未将数据库配置为使用Oracle Label Security，请继续执行下一步。</span><ol type="a">
                              <li class="substepexpand"><span>脚本复制<code class="codeph">olstrig.sql</code>从Oracle主<span class="italic">12c的</span> Oracle数据库下发行数量的Oracle主到要降级的数据库。</span></li>
                              <li class="substepexpand"><span>在降级版本的Oracle主目录中，运行<code class="codeph">olstrig.sql</code>以使用Oracle Label Security策略在表上重新创建DML触发器：</span><div><pre class="pre codeblock"><code>SQL&gt; @ olstrig.sql</code></pre></div>
                              </li>
                           </ol>
                        </li>
                        <li class="stepexpand"><span>（可选）对于非CDB，将系统设置为将结果假脱机到日志文件以跟踪更改和问题。CDB不需要此步骤。</span><div>
                              <p>例：</p><pre class="pre codeblock"><code>SQL&gt; SPOOL utlrp.log</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>运行<code class="codeph">utlrp.sql</code>脚本以重新编译任何剩余的存储的PL / SQL和Java代码。使用您的配置过程：</span><ul>
                              <li>
                                 <p>非国开行：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; $ ORACLE_HOME / rdbms / admin / utlrp.sql</pre></li>
                              <li>
                                 <p>CDB：</p><pre class="oac_no_warn" dir="ltr">$ ORACLE_HOME / perl / bin / perl $ ORACLE_HOME / rdbms / admin / catcon.pl -n 1 -e -b utlrp -d $ ORACLE_HOME / rdbms / admin utlrp.sql</pre><p><code class="codeph">utlrp.sql</code>脚本重新编译以前处于<code class="codeph">INVALID</code>状态的所有现有PL / SQL模块，例如包，过程，类型等。生成日志文件<code class="codeph">utlrp0.log</code> 。该日志文件列出了重新编译结果。
                                 </p>
                              </li>
                           </ul>
                        </li>
                        <li class="stepexpand"><span>如果在运行<code class="codeph">utlrp.sql</code>时打开非CDB的假脱机，则关闭脚本结果的假脱机到日志文件：</span><div><pre class="pre codeblock"><code>SQL&gt; SPOOL OFF</code></pre><p>检查假脱机文件，并验证是否已成功编译包和过程。更正在此日志文件中找到的任何问题。如有必要，请重新运行相应的脚本。</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>退出SQL * Plus。</span></li>
                        <li class="stepexpand"><span>如果要降级群集数据库，则必须运行以下命令以降级Oracle Clusterware数据库配置：</span><div><pre class="pre codeblock"><code>$ srvctl降级数据库-d <span class="variable" translate="no">db-unique-name</span> -o <span class="variable" translate="no">oraclehome</span> -t <span class="variable" translate="no">to_version</span>
</code></pre></div>
                           <div>
                              <p>将此语法示例中的变量替换为系统的值：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><code class="codeph"><span class="variable" translate="no">db-unique-name</span></code>是数据库名称（不是实例名称）。
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph"><span class="variable" translate="no">oraclehome</span></code>是降级数据库的旧Oracle主目录的位置。
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph"><span class="variable" translate="no">to_version</span></code>是数据库降级的数据库版本。（例如：12.1.0.2.0。）
                                    </p>
                                 </li>
                              </ul>
                              <div class="infoboxnote" id="GUID-0227D321-577E-47C5-A8C0-36991B8D0357__GUID-DFEFB115-42A3-42B4-86CC-E2109E326FA3">
                                 <p class="notep1">注意：</p>
                                 <p>从新版本的Oracle主目录运行此命令，而不是从数据库降级到的Oracle主目录运行。</p>
                              </div>
                           </div>
                        </li>
                     </ol>
                     <div class="section">
                        <p>完成此过程后，您的数据库将降级。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="downgrading-oracle-db-after-upgrade.html#GUID-F3DAC69A-A5D0-4998-A14D-DCC8599AD3FA">对Oracle数据库降级进行故障排除</a></li>
                           <li><a href="../admin/starting-up-and-shutting-down.html#ADMIN12825" target="_blank"><span><cite>Oracle数据库管理员指南</cite></span></a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-EF4B784F-BF90-48B5-80B5-3D4E209F8F8E" title="为了自动降级，从Oracle Database 19c开始，Oracle提供了dbdowngrade实用程序脚本。必要时，您还可以继续手动运行catdwgrd.sql，与以前的版本一样。">使用脚本降级CDB或非CDB Oracle数据库</a></p>
                        </div>
                     </div>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-F1FB354D-8C53-4E80-A4C9-A6366055028C" name="GUID-F1FB354D-8C53-4E80-A4C9-A6366055028C"></a><h3 id="UPGRD-GUID-F1FB354D-8C53-4E80-A4C9-A6366055028C" class="sect3">关于具有组件状态选项关闭的降级和无效对象</h3>
               <div>
                  <p>从降级版本的Oracle数据库标准版到带有CDB和PDBS的Oracle Database 12c标准版的降级包含更高版本后发布的无效对象。</p>
                  <p>随着Oracle数据库版本12c（12.2或12.1）的发布，将数据库版本降级到Oracle数据库版本12c（12.2或12.1），预计会在降级数据库中找到更高版本的无效对象，其中Oracle Database Release 12c数据库将这些对象设置为FALSE。降级到Oracle Database Release 18c（18.1.0）和更高版本的Oracle数据库版本时，不存在此问题。</p>
                  <div class="example" id="GUID-F1FB354D-8C53-4E80-A4C9-A6366055028C__GUID-4ECE04D0-86FB-474A-9C18-ACAAC5BD0D4F">
                     <p>例如：</p>
                     <p>在从Oracle Database 19c标准版降级到Oracle Database 12c第2版（12.2.0.1）标准版期间，您将OLAP和Spatial组件升级到19c版本，但它们设置为FALSE。降级后，OLAP和Spatial组件仍然不可用，但它们不会重新加载到12.2.0.1版本中。然后，您可以在DBA注册表中看到此结果，您可以在12.2注册表中找到后续发布的对象：</p><pre class="pre codeblock"><code>OLAP分析工作区选项关闭19.1.0 Oracle OLAP API选项关闭19.1.0</code></pre></div>
                  <!-- class="example" -->
                  <div class="section">
                     <p>此结果是从Oracle Database 18c及更高版本降级到Oracle Database 12c的预期行为。预期此行为的原因是因为Standard Edition数据库中这些选项的选项设置为FALSE。在升级期间，即使将它们设置为<code class="codeph">FALSE</code> ，也会升级所有选项。在<code class="codeph">catrelod.sql</code>运行期间，重新加载脚本不会运行以使用早期版本替换这些对象。因此，降级到标准版会使许多OLAP和Spatial对象处于其后续版本中。
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：将</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-CAD9888A-2E6E-48F8-938C-B3E861738606" title="对于受支持的Oracle数据库版本，您可以将数据库降级到上次升级的版本。">Oracle数据库降级为早期版本</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="props_rev_3"><a id="GUID-66560D5D-A5C8-4ACC-82C0-46315465E77F" name="GUID-66560D5D-A5C8-4ACC-82C0-46315465E77F"></a><h3 id="UPGRD-GUID-66560D5D-A5C8-4ACC-82C0-46315465E77F" class="sect3">降级单个可插拔Oracle数据库（PDB）</h3>
               <div>
                  <p>如果您要降级Oracle数据库，则可以降级一个PDB而不降级整个CDB。</p>
                  <p>在Oracle Database 12c第2版（12.2）之后的Oracle数据库发行版中，您可以降级各个PDB。例如，您可以从升级后的CDB中拔出PDB，降级PDB，然后将其插入早期版本的CDB，或者可以将PDB数据库转换为独立数据库。</p>
                  <div class="section">
                     <p class="subhead2" id="GUID-66560D5D-A5C8-4ACC-82C0-46315465E77F__GUID-FDBE5EE1-9702-4F3C-AAAF-AB864443A5E2">降级PDB</p>
                     <p>在此过程示例中，您将PDB降级到版本12.1.0.2：</p>
                     <ol>
                        <li>
                           <p>在DOWNGRADE模式下启动PDB。执行此操作时，CDB可以处于正常模式。</p><pre class="oac_no_warn" dir="ltr">SQL&gt; alter pluggable database CDB1_PDB1 open downgrade;</pre></li>
                        <li>
                           <p>，无论是通过使用降级PDB <code class="codeph">dbdowngrade</code>效用，或通过运行<code class="codeph">catdwgrd</code>手动，使用<code class="codeph">catcon.pl</code> 。
                           </p>
                           <p>在每个选项中，您要降级的PDB是<code class="codeph">PDB1</code> 。
                           </p>
                           <ul id="GUID-66560D5D-A5C8-4ACC-82C0-46315465E77F__UL_UWJ_LB2_CGB" style="list-style-type:disc">
                              <li>
                                 <p>使用<code class="codeph">dbdowngrade</code>实用程序降级。
                                 </p>
                                 <p>使用dbdowngrade脚本降级PDB，如下所示：</p><pre class="pre codeblock"><code>cd $ ORACLE_HOME / bin ./dbdowngrade -c'PDB1'</code></pre></li>
                              <li>
                                 <p>与手动降级<code class="codeph">catdwgrd</code> ，使用<code class="codeph">catcon.p.</code></p>
                                 <p>运行<code class="codeph">catdwgrd</code>如下：</p><pre class="oac_no_warn" dir="ltr">$ ORACLE_HOME / perl / bin / perl $ ORACLE_HOME / rdbms / admin / catcon.pl -d $ ORACLE_HOME / rdbms / admin -n 1 -l &lt;输出目录&gt; -e -b catdwgrd -c'PDB1'catdwgrd.sql</pre><p>在示例中， <code>catdwgrd</code>与<code>catcon.pl</code> <code>catdwgrd</code>运行。<code class="codeph">-d</code>参数告诉<code>catcon.pl</code>在哪里找到<code>catdwgrd</code> 。<code class="codeph">-l</code>参数指定日志文件的输出目录，而不是写入<code class="codeph">rdbms/admin</code>目录。必须使用<code class="codeph">-r</code>参数同时运行两个脚本。
                                 </p>
                                 <p>降级的日志文件放在Oracle基本主目录中（由命令<code class="codeph">orabasehome</code>或<code class="codeph">orabase</code>标识的Oracle基础，或由命令<code class="codeph">oracle_home</code>标识的Oracle主<code class="codeph">orabasehome</code> ， <code class="codeph">orabase</code>顺序排列）。
                                 </p>
                              </li>
                           </ul>
                        </li>
                        <li>
                           <p>关闭PDB。</p>
                        </li>
                     </ol>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-66560D5D-A5C8-4ACC-82C0-46315465E77F__GUID-201A7D9B-2D52-44EE-BC23-2408393DF7AF">从CDB上拔下PDB</p>
                     <p>在此步骤中，从版本12.2.0.1 CDB中拔出降级的PDB：</p>
                     <ol>
                        <li>
                           <p>连接到升级后的CDB。</p>
                        </li>
                        <li>
                           <p>关闭要拔出的PDB。</p><pre class="oac_no_warn" dir="ltr">SQL&gt; alter pluggable database PDB1 close;</pre></li>
                        <li>
                           <p>拔下降级的12.1.0.2 PDB，用系统上的路径替换变量<code class="codeph"><span class="variable" translate="no">path</span></code> ：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; alter pluggable database PDB1拔出' <span class="variable" translate="no">path</span> /pdb1.xml';</pre><p>拔出完成后，您会收到以下响应：</p><pre class="oac_no_warn" dir="ltr">可插拔数据库已更改</pre></li>
                     </ol>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-66560D5D-A5C8-4ACC-82C0-46315465E77F__GUID-217DD5FD-30A1-4796-A0C4-3CBAB107CAA0">插入降级的12.1.0.2 PDB</p>
                     <p>在此步骤中，将降级的12.1.0.2 PDB插入12.1.0.2 CDB。为此，您必须在此CDB中创建PDB。以下示例显示如何创建名为PDB1的可插拔数据库：</p>
                     <ol>
                        <li>
                           <p>连接到12.1.0.2 CDB。</p>
                        </li>
                        <li>
                           <p>插入12.1.0.2 PDB。</p><pre class="oac_no_warn" dir="ltr">SQL&gt;使用' <span class="variable" translate="no">path</span> /pdb1.xml'创建可插拔数据库PDB1;</pre><p>此命令返回已<code class="codeph">Pluggable database created</code> 。
                           </p>
                        </li>
                        <li>
                           <p>在升级模式下打开PDB：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; alter pluggable database PDB1 open upgrade;</pre></li>
                        <li>
                           <p>连接到PDB：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; alter session set container = PDB1;</pre></li>
                        <li>
                           <p>在PDB中运行<code class="codeph">catrelod</code> ：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; @ $ ORACLE_HOME / rdbms / admin / catrelod.sql</pre><p><code class="codeph">catrelod.sql</code>脚本为降级的数据库中的每个数据库组件重新加载适当的版本。
                           </p>
                        </li>
                        <li>
                           <p>在PDB中运行<code class="codeph">utlrp</code> ：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; @ $ ORACLE_HOME / rdbms / admin / utlrp.sql</pre><p><code class="codeph">utlrp.sql</code>脚本重新编译以前处于<code class="codeph">INVALID</code>状态的所有现有PL / SQL模块，例如包，过程，类型等。
                           </p>
                        </li>
                     </ol>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：将</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-CAD9888A-2E6E-48F8-938C-B3E861738606" title="对于受支持的Oracle数据库版本，您可以将数据库降级到上次升级的版本。">Oracle数据库降级为早期版本</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-EEC355DD-AA56-4972-9EB3-139CEC457D65" name="GUID-EEC355DD-AA56-4972-9EB3-139CEC457D65"></a><h3 id="UPGRD-GUID-EEC355DD-AA56-4972-9EB3-139CEC457D65" class="sect3">降级包含Oracle Application Express的PDB</h3>
               <div>
                  <p>在降级包含Oracle Application Express的PDB时，请使用此过程来避免APEX_050000错误导致的INVALID OBJECTS。</p>
                  <div class="section">
                     <p>将PDB降级到早期版本后，输入类似于以下内容的SQL语句以删除Oracle Application Express用户：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-EEC355DD-AA56-4972-9EB3-139CEC457D65__ORACLE_HOMEPERLBINPERLORACLE_HOMERD-50050B17"><pre class="pre codeblock"><code>$ ORACLE_HOME / perl / bin / perl $ ORACLE_HOME / rdbms / admin / catcon.pl -b drop_apex5 -c'PDB1' -  --x'drop user apex_050000 cascade'</code></pre><p>在此示例中，PDB名称为<code class="codeph">'PDB1'</code> 。
                     </p>
                  </div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：将</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-CAD9888A-2E6E-48F8-938C-B3E861738606" title="对于受支持的Oracle数据库版本，您可以将数据库降级到上次升级的版本。">Oracle数据库降级为早期版本</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="UPGRD12557"></a><div class="props_rev_3"><a id="GUID-5DF45F07-90FB-4AE2-9814-4956D60726E5" name="GUID-5DF45F07-90FB-4AE2-9814-4956D60726E5"></a><h3 id="UPGRD-GUID-5DF45F07-90FB-4AE2-9814-4956D60726E5" class="sect3">Oracle数据库降级后降级任务降级</h3>
               <div>
                  <p>由于影响兼容性，组件和支持的协议的更改，在降级Oracle数据库之后可能需要执行其他任务。</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-2C4D727B-48E3-4AD2-852D-D3A54C838322">Oracle数据库降级的Oracle XML DB身份验证建议</a><br>从12.1之前的版本升级会导致禁用摘要式身份验证。
                     </li>
                     <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-5C696750-2055-4FB2-8EB6-83E5139B1EA2">降级后重新应用发布更新和其他补丁</a><br>运行降级并且<code class="codeph">catrelod.sql</code>成功完成后，如果在升级后但在降级之前在原始Oracle主目录中安装了新修补程序，请确保应用已安装的任何修补程序。
                     </li>
                     <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-B8C9E95E-AC37-48F0-945F-4A17E111E7D5">降级Oracle数据库后重新启用Oracle Database Vault</a><br>如果在降级期间指示您禁用Oracle Database Vault，则必须执行此操作。
                     </li>
                     <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-67714F0E-0CE4-4527-86AF-8918914DACAF">恢复Oracle Clusterware的配置</a><br>要还原配置，必须还原要升级的版本。
                     </li>
                     <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-C2C793F4-67A1-4F10-88DB-EE09D7C3B4CD">降级Oracle数据库后恢复Oracle Enterprise Manager</a><br>仅当您执行降级并且在主机上配置了Oracle Enterprise Manager时，才需要执行本节中描述的还原任务。
                     </li>
                     <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-593D396B-A1C2-4453-BBDA-8C4455000CA0">将Oracle Application Express还原到早期版本</a><br>降级后，如果在升级Oracle数据库的同时升级了Oracle Application Express，则必须完成恢复到早期Oracle Application Express版本的步骤。
                     </li>
                     <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-6B972762-122D-4CFF-B910-6F93409DAC5F">降级后收集字典统计</a><br>为降低降级后的性能，请使用此过程收集字典统计信息。
                     </li>
                     <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-42DB61B8-ADA7-426D-B9E6-24365BDE0506">降级后重新收集固定对象统计数据</a><br>降级后，在Oracle数据库上运行代表性工作负载，并重新收集固定对象统计信息。
                     </li>
                     <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-3B34038A-2C85-4B77-B91D-BB9665883B21">降级后重新收集陈旧的CBO统计数据</a><br>Oracle建议您在完成Oracle数据库降级后重新收集Oracle基于成本的优化程序（CBO）统计信息。
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：将</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-CAD9888A-2E6E-48F8-938C-B3E861738606" title="对于受支持的Oracle数据库版本，您可以将数据库降级到上次升级的版本。">Oracle数据库降级为早期版本</a></p>
                     </div>
                  </div>
               </div>
               <a id="UPGRD52884"></a><div class="props_rev_3"><a id="GUID-2C4D727B-48E3-4AD2-852D-D3A54C838322" name="GUID-2C4D727B-48E3-4AD2-852D-D3A54C838322"></a><h4 id="UPGRD-GUID-2C4D727B-48E3-4AD2-852D-D3A54C838322" class="sect4">Oracle数据库降级的Oracle XML DB身份验证建议</h4>
                  <div>
                     <p>从12.1之前的版本升级会导致禁用摘要式身份验证。</p>
                     <p>如果降级到版本比Oracle数据库<span class="italic">12c的</span>前面，其中摘要认证，不支持，摘要式身份验证被禁用，做出认证选择不可用。这会影响Oracle XML DB Repository的HTTP身份验证。如果您没有利用摘要式身份验证而是使用默认配置，则无需进一步操作。
                     </p>
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-2C4D727B-48E3-4AD2-852D-D3A54C838322__GUID-9E98738F-8B58-4827-BB7C-722CA5BED224">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="../adxdb/administration-of-XML-DB.html#ADXDB6110" target="_blank"><span class="italic">Oracle XML DB Developer's Guide</span></a> ，了解有关使用Oracle XML DB进行数据库安装，升级和降级的身份验证的信息</p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-5DF45F07-90FB-4AE2-9814-4956D60726E5" title="由于影响兼容性，组件和支持的协议的更改，在降级Oracle数据库之后可能需要执行其他任务。">Oracle数据库降级的降级后任务</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-5C696750-2055-4FB2-8EB6-83E5139B1EA2" name="GUID-5C696750-2055-4FB2-8EB6-83E5139B1EA2"></a><h4 id="UPGRD-GUID-5C696750-2055-4FB2-8EB6-83E5139B1EA2" class="sect4">降级后重新应用发布更新和其他补丁</h4>
                  <div>
                     <p>运行降级并且<code class="codeph">catrelod.sql</code>成功完成后，如果在升级后但在降级之前在原始Oracle主目录中安装了新修补程序，请确保应用已安装的任何修补程序。
                     </p>
                     <p>如果你安装了新的补丁程序，然后运行<code class="codeph">datapatch</code>工具，这些补丁应用到降级的数据库。如果在升级后未更改Oracle Home中的二进制文件和文件，则无需在运行<code class="codeph">datapatch</code>后运行<code class="codeph">catrelod.sql</code> 。
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-5DF45F07-90FB-4AE2-9814-4956D60726E5" title="由于影响兼容性，组件和支持的协议的更改，在降级Oracle数据库之后可能需要执行其他任务。">Oracle数据库降级的降级后任务</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="UPGRD12559"></a><div class="props_rev_3"><a id="GUID-B8C9E95E-AC37-48F0-945F-4A17E111E7D5" name="GUID-B8C9E95E-AC37-48F0-945F-4A17E111E7D5"></a><h4 id="UPGRD-GUID-B8C9E95E-AC37-48F0-945F-4A17E111E7D5" class="sect4">降级Oracle数据库后重新启用Oracle Database Vault</h4>
                  <div>
                     <p>如果在降级期间指示您禁用Oracle Database Vault，则必须执行此操作。</p>
                     <p>如果您使用Oracle Database Vault，则可能已指示您在降级数据库之前禁用它。要在降级后使用Oracle Database Vault，必须重新启用它。</p>
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-B8C9E95E-AC37-48F0-945F-4A17E111E7D5__GUID-93351A50-7410-4292-A0C0-237F8265FC6F">
                        <p class="notep1">也可以看看：</p>
                        <p>有关重新启用Oracle Database Vault的过程的<a href="../dvadm/getting-started-with-oracle-database-vault.html#DVADM30031" target="_blank"><span class="italic">Oracle Database Vault管理员指南</span></a></p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-5DF45F07-90FB-4AE2-9814-4956D60726E5" title="由于影响兼容性，组件和支持的协议的更改，在降级Oracle数据库之后可能需要执行其他任务。">Oracle数据库降级的降级后任务</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="UPGRD52664"></a><div class="props_rev_3"><a id="GUID-67714F0E-0CE4-4527-86AF-8918914DACAF" name="GUID-67714F0E-0CE4-4527-86AF-8918914DACAF"></a><h4 id="UPGRD-GUID-67714F0E-0CE4-4527-86AF-8918914DACAF" class="sect4">恢复Oracle Clusterware的配置</h4>
                  <div>
                     <p>要还原配置，必须还原要升级的版本。</p>
                     <p>您可以将Oracle Clusterware配置还原到Oracle Clusterware 12 <span class="italic">c</span>第2版（12.2）升级之前的状态。您在Oracle Database 12 <span class="italic">c</span>升级过程中或之后执行的任何配置更改都将被删除，并且无法恢复。
                     </p>
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-67714F0E-0CE4-4527-86AF-8918914DACAF__GUID-22CCA6B5-57DE-4E14-930B-5E0DFE5405FF">
                        <p class="notep1">也可以看看：</p>
                        <p>适用于您的平台的<a href="../install-and-upgrade.html" target="_blank"><span><cite>Oracle Grid Infrastructure安装和升级指南</cite></span></a></p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-5DF45F07-90FB-4AE2-9814-4956D60726E5" title="由于影响兼容性，组件和支持的协议的更改，在降级Oracle数据库之后可能需要执行其他任务。">Oracle数据库降级的降级后任务</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="UPGRD60106"></a><div class="props_rev_3"><a id="GUID-C2C793F4-67A1-4F10-88DB-EE09D7C3B4CD" name="GUID-C2C793F4-67A1-4F10-88DB-EE09D7C3B4CD"></a><h4 id="UPGRD-GUID-C2C793F4-67A1-4F10-88DB-EE09D7C3B4CD" class="sect4">降级Oracle数据库后恢复Oracle Enterprise Manager</h4>
                  <div>
                     <p>仅当您执行降级并且在主机上配置了Oracle Enterprise Manager时，才需要执行本节中描述的还原任务。</p>
                     <p>要还原Oracle Enterprise Manager，首先运行Oracle Enterprise Manager配置助手（EMCA），然后运行<code class="codeph">emdwgrd</code>实用程序。
                     </p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-648BBBCF-0F0E-43CB-ACF7-B8F15882F422">降级后恢复Oracle企业管理器的要求</a><br>升级之前必须完成这些要求才能在降级到12.1之前的版本后还原Oracle Enterprise Manager</li>
                        <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-2EEC4E63-0F98-4EC8-8630-46F69A5A1FB0">降级后运行EMCA以还原Oracle企业管理器</a><br>查看这些主题并选择还原方案，以在降级后还原Oracle Enterprise Manager。
                        </li>
                        <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-A97C04EC-BD77-4075-A354-03788DBCB74D">运行emdwgrd实用程序以还原企业管理器数据库控制</a><br>运行<kbd class="userinput">emca -restore</kbd>后，可以使用<code>emdwgrd</code>实用程序还原Oracle Enterprise Manager数据库控件和数据。
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-5DF45F07-90FB-4AE2-9814-4956D60726E5" title="由于影响兼容性，组件和支持的协议的更改，在降级Oracle数据库之后可能需要执行其他任务。">Oracle数据库降级的降级后任务</a></p>
                        </div>
                     </div>
                  </div>
                  
                  <div class="props_rev_3"><a id="GUID-648BBBCF-0F0E-43CB-ACF7-B8F15882F422" name="GUID-648BBBCF-0F0E-43CB-ACF7-B8F15882F422"></a><h5 id="UPGRD-GUID-648BBBCF-0F0E-43CB-ACF7-B8F15882F422" class="sect5">降级后恢复Oracle企业管理器的要求</h5>
                     <div>
                        <p>升级之前必须完成这些要求才能在降级到12.1之前的版本后还原Oracle Enterprise Manager</p>
                        <p>要使用<code class="codeph">emca -restore</code>将Oracle Enterprise Manager还原到以前的状态，必须满足以下条件：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>在升级之前，您保存了Oracle Enterprise Manager配置文件和数据的备份</p>
                           </li>
                           <li>
                              <p>您运行位于Oracle数据库12 <span class="italic">c</span> Oracle主目录中的<code class="codeph">emca</code>二进制文件以执行此过程</p>
                           </li>
                        </ul>
                        <p>在Oracle Clusterware系统上，要在Oracle RAC数据库上还原Oracle Enterprise Manager，必须在运行<code class="codeph">emca -restore</code>之前使用<code class="codeph">srvctl</code>注册数据库。您必须从数据库降级的早期Oracle数据库发行版的<code><span class="variable" translate="no">ORACLE_HOME</span> /bin</code>目录运行<code class="codeph">emca -restore</code> 。
                        </p>
                        <p>运行带有相应选项的<code class="codeph">emca -restore</code>命令，以将Oracle Enterprise Manager数据库控制或网格控制还原到旧的Oracle主目录。
                        </p>
                        <p>指定不同的<code>emca</code>选项，具体取决于要降级的数据库是单实例数据库，Oracle RAC数据库还是Oracle ASM数据库。
                        </p>
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>相关话题</strong></p>
                           <ul>
                              <li><a href="../cwadd/server-control-command-reference.html#CWADD-GUID-803F603E-8638-4946-84D4-CB24D21C893C" target="_blank"><span><cite>“Oracle Clusterware管理和部署指南”</cite></span></a></li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-C2C793F4-67A1-4F10-88DB-EE09D7C3B4CD" title="仅当您执行降级并且在主机上配置了Oracle Enterprise Manager时，才需要执行本节中描述的还原任务。">降级Oracle数据库后还原Oracle Enterprise Manager</a></p>
                           </div>
                        </div>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-2EEC4E63-0F98-4EC8-8630-46F69A5A1FB0" name="GUID-2EEC4E63-0F98-4EC8-8630-46F69A5A1FB0"></a><h5 id="UPGRD-GUID-2EEC4E63-0F98-4EC8-8630-46F69A5A1FB0" class="sect5">降级后运行EMCA以还原Oracle企业管理器</h5>
                     <div>
                        <p>查看这些主题并选择还原方案，以在降级后还原Oracle Enterprise Manager。</p>
                     </div>
                     <div>
                        <ul class="ullinks">
                           <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-C2AC0068-9BB8-4CE5-B15D-5603E5613167">在没有Oracle ASM的单实例Oracle数据库上运行emca</a><br>使用Enterprise Manager Configuration Assistant（ <code>emca</code> ）管理数据库。
                           </li>
                           <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-5E91C301-67ED-4C35-BAE6-2A533E84829B">在没有Oracle ASM的Oracle RAC数据库上运行EMCA</a><br>使用Enterprise Manager Configuration Assistant（ <code>emca</code> ）管理数据库：</li>
                           <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-5F8A1676-8ACF-4D19-879A-72524BB7AF6A">在单实例Oracle ASM实例上运行EMCA</a><br>使用Enterprise Manager Configuration Assistant（ <code>emca</code> ）管理数据库和存储。
                           </li>
                           <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-2F275E58-A811-41F9-9AF5-0D8E400F7F02">在Oracle RAC实例上的Oracle ASM上运行emca</a><br>使用Enterprise Manager Configuration Assistant（ <code>emca</code> ）管理数据库和存储。
                           </li>
                           <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-3F8EFEF3-1410-4983-87DA-042A9DD69601">使用Oracle ASM在单实例Oracle数据库上运行emca</a><br>使用Enterprise Manager Configuration Assistant（ <code>emca</code> ）管理数据库和存储。
                           </li>
                           <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-A1DDA4D7-7EC2-4D1C-89E3-A1C8D9CC142E">在Oracle RAC数据库和Oracle ASM实例上运行emca</a><br>使用Enterprise Manager Configuration Assistant（ <code>emca</code> ）管理数据库和存储。
                           </li>
                        </ul>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-C2C793F4-67A1-4F10-88DB-EE09D7C3B4CD" title="仅当您执行降级并且在主机上配置了Oracle Enterprise Manager时，才需要执行本节中描述的还原任务。">降级Oracle数据库后还原Oracle Enterprise Manager</a></p>
                           </div>
                        </div>
                     </div>
                     <a id="UPGRD60107"></a><div class="props_rev_3"><a id="GUID-C2AC0068-9BB8-4CE5-B15D-5603E5613167" name="GUID-C2AC0068-9BB8-4CE5-B15D-5603E5613167"></a><h6 id="UPGRD-GUID-C2AC0068-9BB8-4CE5-B15D-5603E5613167" class="sect6">在没有Oracle ASM的单实例Oracle数据库上运行emca</h6>
                        <div>
                           <p>使用Enterprise Manager Configuration Assistant（ <code>emca</code> ）管理数据库。
                           </p>
                           <p>使用此命令可以运行Enterprise Manager Configuration Assistant。</p><pre class="oac_no_warn" dir="ltr">ORACLE_HOME / bin / emca -restore db</pre><p>系统会提示您输入以下信息：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>要恢复的数据库的Oracle主目录</p>
                              </li>
                              <li>
                                 <p>数据库SID</p>
                              </li>
                              <li>
                                 <p>侦听器端口号</p>
                              </li>
                           </ul>
                        </div>
                        <div>
                           <div class="familylinks">
                              <div class="parentlink">
                                 <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-2EEC4E63-0F98-4EC8-8630-46F69A5A1FB0" title="查看这些主题并选择还原方案，以在降级后还原Oracle Enterprise Manager。">在降级后运行EMCA以还原Oracle Enterprise Manager</a></p>
                              </div>
                           </div>
                        </div>
                        
                     </div><a id="UPGRD60108"></a><div class="props_rev_3"><a id="GUID-5E91C301-67ED-4C35-BAE6-2A533E84829B" name="GUID-5E91C301-67ED-4C35-BAE6-2A533E84829B"></a><h6 id="UPGRD-GUID-5E91C301-67ED-4C35-BAE6-2A533E84829B" class="sect6">在没有Oracle ASM的Oracle RAC数据库上运行EMCA</h6>
                        <div>
                           <p>使用Enterprise Manager Configuration Assistant（ <code>emca</code> ）管理数据库：</p>
                           <p>使用此过程运行企业管理器配置助手：</p><pre class="pre codeblock"><code>ORACLE_HOME / bin / emca -restore db -cluster</code></pre><p>系统会提示您输入以下信息：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>要恢复的数据库的Oracle主目录</p>
                              </li>
                              <li>
                                 <p>数据库唯一名称</p>
                              </li>
                              <li>
                                 <p>侦听器端口号</p>
                              </li>
                           </ul>
                        </div>
                        <div>
                           <div class="familylinks">
                              <div class="parentlink">
                                 <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-2EEC4E63-0F98-4EC8-8630-46F69A5A1FB0" title="查看这些主题并选择还原方案，以在降级后还原Oracle Enterprise Manager。">在降级后运行EMCA以还原Oracle Enterprise Manager</a></p>
                              </div>
                           </div>
                        </div>
                        
                     </div><a id="UPGRD60109"></a><div class="props_rev_3"><a id="GUID-5F8A1676-8ACF-4D19-879A-72524BB7AF6A" name="GUID-5F8A1676-8ACF-4D19-879A-72524BB7AF6A"></a><h6 id="UPGRD-GUID-5F8A1676-8ACF-4D19-879A-72524BB7AF6A" class="sect6">在单实例Oracle ASM实例上运行EMCA</h6>
                        <div>
                           <p>使用Enterprise Manager Configuration Assistant（ <code>emca</code> ）管理数据库和存储。
                           </p>
                           <p>使用此命令可以运行Enterprise Manager Configuration Assistant。</p><pre class="pre codeblock"><code>ORACLE_HOME / bin / emca -restore asm</code></pre><p>系统会提示您输入以下信息：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>要恢复的数据库的Oracle主目录</p>
                              </li>
                              <li>
                                 <p>Oracle ASM端口</p>
                              </li>
                              <li>
                                 <p>Oracle ASM SID</p>
                              </li>
                           </ul>
                        </div>
                        <div>
                           <div class="familylinks">
                              <div class="parentlink">
                                 <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-2EEC4E63-0F98-4EC8-8630-46F69A5A1FB0" title="查看这些主题并选择还原方案，以在降级后还原Oracle Enterprise Manager。">在降级后运行EMCA以还原Oracle Enterprise Manager</a></p>
                              </div>
                           </div>
                        </div>
                        
                     </div><a id="UPGRD60110"></a><div class="props_rev_3"><a id="GUID-2F275E58-A811-41F9-9AF5-0D8E400F7F02" name="GUID-2F275E58-A811-41F9-9AF5-0D8E400F7F02"></a><h6 id="UPGRD-GUID-2F275E58-A811-41F9-9AF5-0D8E400F7F02" class="sect6">在Oracle RAC实例上的Oracle ASM上运行emca</h6>
                        <div>
                           <p>使用Enterprise Manager Configuration Assistant（ <code>emca</code> ）管理数据库和存储。
                           </p>
                           <p>使用此命令可以运行Enterprise Manager Configuration Assistant。</p><pre class="pre codeblock"><code>ORACLE_HOME / bin / emca -restore asm -cluster</code></pre><p>系统会提示您输入以下信息：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>要恢复的数据库的Oracle主目录</p>
                              </li>
                              <li>
                                 <p>Oracle ASM端口</p>
                              </li>
                           </ul>
                        </div>
                        <div>
                           <div class="familylinks">
                              <div class="parentlink">
                                 <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-2EEC4E63-0F98-4EC8-8630-46F69A5A1FB0" title="查看这些主题并选择还原方案，以在降级后还原Oracle Enterprise Manager。">在降级后运行EMCA以还原Oracle Enterprise Manager</a></p>
                              </div>
                           </div>
                        </div>
                        
                     </div><a id="UPGRD60111"></a><div class="props_rev_3"><a id="GUID-3F8EFEF3-1410-4983-87DA-042A9DD69601" name="GUID-3F8EFEF3-1410-4983-87DA-042A9DD69601"></a><h6 id="UPGRD-GUID-3F8EFEF3-1410-4983-87DA-042A9DD69601" class="sect6">使用Oracle ASM在单实例Oracle数据库上运行emca</h6>
                        <div>
                           <p>使用Enterprise Manager Configuration Assistant（ <code>emca</code> ）管理数据库和存储。
                           </p>
                           <p>使用此命令可以运行Enterprise Manager Configuration Assistant。</p><pre class="pre codeblock"><code>ORACLE_HOME / bin / emca -restore db_asm</code></pre><p>系统会提示您输入以下信息：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>要恢复的Oracle数据库的Oracle主目录</p>
                              </li>
                              <li>
                                 <p>数据库SID</p>
                              </li>
                              <li>
                                 <p>侦听器端口号</p>
                              </li>
                              <li>
                                 <p>Oracle ASM端口</p>
                              </li>
                              <li>
                                 <p>Oracle ASM主页</p>
                              </li>
                              <li>
                                 <p>Oracle ASM SID [+ ASM]</p>
                              </li>
                           </ul>
                        </div>
                        <div>
                           <div class="familylinks">
                              <div class="parentlink">
                                 <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-2EEC4E63-0F98-4EC8-8630-46F69A5A1FB0" title="查看这些主题并选择还原方案，以在降级后还原Oracle Enterprise Manager。">在降级后运行EMCA以还原Oracle Enterprise Manager</a></p>
                              </div>
                           </div>
                        </div>
                        
                     </div><a id="UPGRD60112"></a><div class="props_rev_3"><a id="GUID-A1DDA4D7-7EC2-4D1C-89E3-A1C8D9CC142E" name="GUID-A1DDA4D7-7EC2-4D1C-89E3-A1C8D9CC142E"></a><h6 id="UPGRD-GUID-A1DDA4D7-7EC2-4D1C-89E3-A1C8D9CC142E" class="sect6">在Oracle RAC数据库和Oracle ASM实例上运行emca</h6>
                        <div>
                           <p>使用Enterprise Manager Configuration Assistant（ <code>emca</code> ）管理数据库和存储。
                           </p>
                           <p>使用此命令运行企业管理器配置助手：</p><pre class="oac_no_warn" dir="ltr">ORACLE_HOME / bin / emca -restore db_asm -cluster</pre><p>系统会提示您输入以下信息：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>要恢复的数据库的Oracle主目录</p>
                              </li>
                              <li>
                                 <p>数据库唯一名称</p>
                              </li>
                              <li>
                                 <p>侦听器端口号</p>
                              </li>
                              <li>
                                 <p>Oracle ASM端口</p>
                              </li>
                              <li>
                                 <p>Oracle ASM Oracle主页</p>
                              </li>
                              <li>
                                 <p>Oracle ASM SID [+ ASM]</p>
                              </li>
                           </ul>
                           <p><code>emca</code>的输出根据您指定的选项和您在提示中输入的值而有所不同。在Oracle RAC环境中，必须在所有Oracle RAC集群成员节点上重复此步骤。
                           </p>
                           <p>您现在必须运行<code>emdwgrd</code>实用程序以还原Oracle Enterprise Manager数据库控制和数据。
                           </p>
                        </div>
                        <div>
                           <div class="familylinks">
                              <div class="parentlink">
                                 <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-2EEC4E63-0F98-4EC8-8630-46F69A5A1FB0" title="查看这些主题并选择还原方案，以在降级后还原Oracle Enterprise Manager。">在降级后运行EMCA以还原Oracle Enterprise Manager</a></p>
                              </div>
                           </div>
                        </div>
                        
                     </div>
                  </div><a id="UPGRD60113"></a><div class="props_rev_3"><a id="GUID-A97C04EC-BD77-4075-A354-03788DBCB74D" name="GUID-A97C04EC-BD77-4075-A354-03788DBCB74D"></a><h5 id="UPGRD-GUID-A97C04EC-BD77-4075-A354-03788DBCB74D" class="sect5">运行emdwgrd实用程序以还原企业管理器数据库控制</h5>
                     <div>
                        <p>运行<kbd class="userinput">emca -restore</kbd>后，可以使用<code>emdwgrd</code>实用程序还原Oracle Enterprise Manager数据库控件和数据。
                        </p>
                        <p>要使用<code>emdwgrd</code> ，您必须执行以下操作：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>将<span class="variable" translate="no">ORACLE_HOME</span>和其他环境变量设置为指向最初进行升级的Oracle主目录。
                              </p>
                           </li>
                           <li>
                              <p>从Oracle Database 12 <span class="italic">c</span> home运行<code>emdwgrd</code>实用程序</p>
                           </li>
                        </ul>
                        <p>以下过程适用于Linux和UNIX。要在Windows上运行它， <code>emdwgrd.bat</code> <code>emdwgrd</code>替换为<code>emdwgrd</code> 。
                        </p>
                        <ol>
                           <li>
                              <p>将<span class="variable" translate="no">ORACLE_HOME</span>设置为最初进行数据库升级的Oracle主目录。
                              </p>
                           </li>
                           <li>
                              <p>将<span class="variable" translate="no">ORACLE_SID</span>设置为已升级然后降级的数据库的SID。
                              </p>
                           </li>
                           <li>
                              <p>将<span class="variable" translate="no">PATH</span> ， <span class="variable" translate="no">LD_LIBRARY_PATH</span>和<span class="variable" translate="no">SHLIB_PATH</span>为指向最初进行数据库升级的Oracle主目录。
                              </p>
                           </li>
                           <li>
                              <p>转到Oracle数据库12 <span class="italic">c</span> Oracle主页：</p><pre class="pre codeblock"><code>cd $ ORACLE_HOME / bin</code></pre><pre class="oac_no_warn" dir="ltr"></pre></li>
                           <li>
                              <p>使用以下过程之一运行<code>emdwgrd</code> ：</p>
                              <ol type="a">
                                 <li>
                                    <p>对于单实例数据库，请运行以下命令，其中<code class="codeph"><span class="variable" translate="no">SID</span></code>是已升级然后降级的数据库的SID， <code class="codeph"><span class="variable" translate="no">save_directory</span></code>是保存数据库控制文件和数据时所选存储位置的路径：</p><pre class="pre codeblock"><code>emdwgrd -restore -sid <span class="variable" translate="no">SID</span> -path <span class="variable" translate="no">save_directory</span> -tempTablespace TEMP</code></pre><pre class="oac_no_warn" dir="ltr"></pre></li>
                                 <li>
                                    <p>对于Oracle RAC数据库，跨群集节点需要远程复制。定义环境变量以指示配置了哪个远程副本。例如：</p><pre class="pre codeblock"><code>setenv EM_REMCP / usr / bin / scp</code></pre><p>然后，使用以下选项运行<kbd class="userinput">emdwgrd -restore</kbd> ：</p><pre class="pre codeblock"><code>emdwgrd -restore -tempTablespace TEMP -cluster -sid <span class="variable" translate="no">SID_OldHome</span> -path <span class="variable" translate="no">save_directory</span>
</code></pre><p>如果Oracle home是一个共享设备上，再加入<kbd class="userinput">-shared</kbd>到<code>emdwgrd</code>命令选项。
                                    </p>
                                 </li>
                              </ol>
                           </li>
                           <li>
                              <p>当提示输入SYS和SYSMAN密码<code>emdwgrd</code> 。
                              </p>
                           </li>
                           <li>
                              <p>当<code>emdwgrd</code>完成时，Oracle Enterprise Manager Database Control将降级到旧的Oracle主目录。
                              </p>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-C2C793F4-67A1-4F10-88DB-EE09D7C3B4CD" title="仅当您执行降级并且在主机上配置了Oracle Enterprise Manager时，才需要执行本节中描述的还原任务。">降级Oracle数据库后还原Oracle Enterprise Manager</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-593D396B-A1C2-4453-BBDA-8C4455000CA0" name="GUID-593D396B-A1C2-4453-BBDA-8C4455000CA0"></a><h4 id="UPGRD-GUID-593D396B-A1C2-4453-BBDA-8C4455000CA0" class="sect4">将Oracle Application Express还原到早期版本</h4>
                  <div>
                     <p>降级后，如果在升级Oracle数据库的同时升级了Oracle Application Express，则必须完成恢复到早期Oracle Application Express版本的步骤。</p>
                     <p>要在数据库降级后完成Oracle Application Express的降级，请完成“ <cite>Oracle Application Express安装指南”中</cite>列出的所有步骤，以将Oracle Application Express版本还原到早期版本。根据您的体系结构是非CDB还是多租户体系结构（CDB）Oracle数据库，还原的步骤是不同的。
                     </p>
                     <div class="infoboxnote" id="GUID-593D396B-A1C2-4453-BBDA-8C4455000CA0__GUID-7CF0A9E9-5C05-4F0C-8E7B-4C64408AA2EB">
                        <p class="notep1">注意：</p>
                        <p>如果在升级数据库的同时升级了Oracle Application Express，则只需完成这些步骤。</p>
                     </div>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/upgrd&amp;id=HTMIG266" target="_blank"><span><cite>“Oracle Application Express安装指南”</cite></span></a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-5DF45F07-90FB-4AE2-9814-4956D60726E5" title="由于影响兼容性，组件和支持的协议的更改，在降级Oracle数据库之后可能需要执行其他任务。">Oracle数据库降级的降级后任务</a></p>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-6B972762-122D-4CFF-B910-6F93409DAC5F" name="GUID-6B972762-122D-4CFF-B910-6F93409DAC5F"></a><h4 id="UPGRD-GUID-6B972762-122D-4CFF-B910-6F93409DAC5F" class="sect4">降级后收集字典统计</h4>
                  <div>
                     <p>为降低降级后的性能，请使用此过程收集字典统计信息。</p>
                     <div class="section">
                        <p>Oracle建议您在降级数据库后收集字典统计信息，以便为降级的版本数据字典表收集统计信息。</p>
                        <div class="infoboxnote" id="GUID-6B972762-122D-4CFF-B910-6F93409DAC5F__GUID-1185D203-0BC8-4290-8C80-1DE6DB2F3FF1">
                           <p class="notep1">注意：</p>
                           <p>在降级过程之后，请注意数据字典可以在降级的字典中保留更改。这些变化微不足道。降级的数据字典在功能上等同于早期版本的数据字典。</p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-6B972762-122D-4CFF-B910-6F93409DAC5F__GUID-89186456-922B-4682-AB96-4154AF51FF98">
                        <ul style="list-style-type:disc">
                           <li>
                              <p>非CDB Oracle数据库：Oracle建议您使用<code class="codeph">DBMS_STATS.GATHER_DICTIONARY_STATS</code>过程来收集这些统计信息。例如，输入以下SQL语句：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; EXEC DBMS_STATS.GATHER_DICTIONARY_STATS;</pre></li>
                           <li>
                              <p>CDB（多租户架构）Oracle数据库：Oracle建议您使用<code>catcon</code>在整个多租户架构中收集数据字典统计信息。
                              </p>
                              <p>要收集容器数据库中所有PDB的字典统计信息，请使用以下语法：</p>
                              <p><code class="codeph">$ ORACLE_HOME / perl / bin / perl $ ORACLE_HOME / rdbms / admin / catcon.pl -l / tmp -b gatherstats  -  --x“exec dbms_stats.gather_dictionary_stats”</code></p>
                              <p>要收集特定PDB上的字典统计信息，请使用类似于以下内容的语法：</p><pre class="pre codeblock"><code>$ ORACLE_HOME / perl / bin / perl $ ORACLE_HOME / rdbms / admin / catcon.pl -l / tmp -c'SALES1'-b gatherstats  -  --x“exec dbms_stats.gather_dictionary_stats”</code></pre><p>在前面的示例中， <code class="codeph">-c SALES1</code>选项为您运行的命令指定PDB包含列表，指定名为<code class="codeph">SALES1</code>的数据库。选项<code class="codeph">-b gatherstats</code>指定日志的基本名称。选项<code class="codeph">--x</code>指定要执行的SQL命令。SQL命令本身在引号内。
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="../arpls/DBMS_STATS.html#ARPLS-GUID-867989C7-ADFC-4464-8981-437CEA7F331E" target="_blank"><span><cite>Oracle数据库PL / SQL包和类型参考</cite></span></a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-5DF45F07-90FB-4AE2-9814-4956D60726E5" title="由于影响兼容性，组件和支持的协议的更改，在降级Oracle数据库之后可能需要执行其他任务。">Oracle数据库降级的降级后任务</a></p>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-42DB61B8-ADA7-426D-B9E6-24365BDE0506" name="GUID-42DB61B8-ADA7-426D-B9E6-24365BDE0506"></a><h4 id="UPGRD-GUID-42DB61B8-ADA7-426D-B9E6-24365BDE0506" class="sect4">降级后重新收集固定对象统计数据</h4>
                  <div>
                     <p>降级后，在Oracle数据库上运行代表性工作负载，并重新收集固定对象统计信息。</p>
                     <div class="section">
                        <p>固定对象是X $表及其索引。V $性能视图通过X $表定义。降级后，重新收集固定对象统计信息以确保已还原数据库的优化程序可以生成良好的执行计划。这些执行计划可以提高数据库性能。未能获得具有代表性的统计数据可能会导致执行计划不理想，从而导致性能问题</p>
                        <p>使用<code class="codeph">DBMS_STATS.GATHER_FIXED_OBJECTS_STATS</code> PL / SQL过程收集固定对象统计信息。<code class="codeph">DBMS_STATS.GATHER_FIXED_OBJECTS_STATS</code>还显示有关从<code class="codeph">init.ora</code>和<code class="codeph">SPFILE</code>删除所有隐藏或下划线参数和事件的建议。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-42DB61B8-ADA7-426D-B9E6-24365BDE0506__GUID-9570A561-DA47-4A64-AA78-DCB20ABDAFA8">
                        <p>要收集固定对象的统计信息，请运行以下PL / SQL过程：</p><pre class="pre codeblock"><code>SQL&gt; execute dbms_stats.gather_fixed_objects_stats;</code></pre><div class="infoboxnotealso" id="GUID-42DB61B8-ADA7-426D-B9E6-24365BDE0506__GUID-6952400C-259E-4561-A653-3EBAB6B3CF58">
                           <p class="notep1">也可以看看：</p>
                           <p>有关使用<code class="codeph">GATHER_FIXED_OBJECTS_STATS</code>过程的更多信息，请<a href="../arpls/DBMS_STATS.html#ARPLS-GUID-EAD4C693-4F03-45DE-9704-1466C8E35232" target="_blank"><span class="italic">参见Oracle Database PL / SQL包和类型参考</span></a></p>
                        </div><pre class="pre codeblock"><code></code></pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-5DF45F07-90FB-4AE2-9814-4956D60726E5" title="由于影响兼容性，组件和支持的协议的更改，在降级Oracle数据库之后可能需要执行其他任务。">Oracle数据库降级的降级后任务</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-3B34038A-2C85-4B77-B91D-BB9665883B21" name="GUID-3B34038A-2C85-4B77-B91D-BB9665883B21"></a><h4 id="UPGRD-GUID-3B34038A-2C85-4B77-B91D-BB9665883B21" class="sect4">降级后重新收集陈旧的CBO统计数据</h4>
                  <div>
                     <p>Oracle建议您在完成Oracle数据库降级后重新收集Oracle基于成本的优化程序（CBO）统计信息。</p>
                     <div class="section">
                        <p>升级Oracle数据库并收集新的CBO统计信息时，已升级的数据库具有新的数据库统计信息。升级后的数据库还可以包含新的直方图类型。因此，在降级数据库时，为新版本收集的统计信息可能与先前版本不同。此问题适用于数据字典表和常规用户表。</p>
                        <p>通过使用GATHER_DATABASE_STATS或使用通常用于更新字典和应用程序模式中陈旧统计信息的收集命令来重新过时的统计信息。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-3B34038A-2C85-4B77-B91D-BB9665883B21__DJWREGATHERSTALE2.4.2GATHERIN-36BE6E15">
                        <p>例如：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>非CDB Oracle数据库：为了重新收集统计信息，Oracle建议您使用<code class="codeph">GATHER_DATABASE_STATS</code>过程，并选择<code class="codeph">'GATHER STALE'</code>选项。例如：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; execute dbms_stats.gather_database_stats（options =&gt;'GATHER STALE'）;</pre></li>
                           <li>
                              <p>CDB（多租户架构）Oracle数据库：为了在整个多租户架构中<code>catcon</code>数据字典统计信息，Oracle建议您使用<code>catcon</code> 。
                              </p>
                              <p>要重新收集容器数据库中所有PDB的陈旧字典统计信息，请使用以下语法：</p>
                              <p><code class="codeph">$ ORACLE_HOME / perl / bin / perl $ ORACLE_HOME / rdbms / admin / catcon.pl -l / tmp -b gatherstats  -  --x“exec dbms_stats.gather_database_stats（options =&gt;'GATHER STALE'）”</code></p>
                              <p>要收集特定PDB上的字典统计信息，请使用类似于以下内容的语法：</p><pre class="pre codeblock"><code>$ ORACLE_HOME / perl / bin / perl $ ORACLE_HOME / rdbms / admin / catcon.pl -l / tmp -c'SALES1'-b gatherstats  -  --x“exec dbms_stats.gather_database_stats（options =&gt;'GATHER STALE'）”</code></pre><p>在前面的示例中， <code class="codeph">-c SALES1</code>选项为您运行的命令指定PDB包含列表，指定名为<code class="codeph">SALES1</code>的数据库。选项<code class="codeph">-b gatherstats</code>指定日志的基本名称。选项<code class="codeph">--x</code>指定要执行的SQL命令。SQL命令本身在引号内。
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="../arpls/DBMS_STATS.html#ARPLS-GUID-867989C7-ADFC-4464-8981-437CEA7F331E" target="_blank"><span><cite>Oracle数据库PL / SQL包和类型参考</cite></span></a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-5DF45F07-90FB-4AE2-9814-4956D60726E5" title="由于影响兼容性，组件和支持的协议的更改，在降级Oracle数据库之后可能需要执行其他任务。">Oracle数据库降级的降级后任务</a></p>
                        </div>
                     </div>
                  </div>
               </div>
            </div><a id="UPGRD52750"></a><div class="props_rev_3"><a id="GUID-F3DAC69A-A5D0-4998-A14D-DCC8599AD3FA" name="GUID-F3DAC69A-A5D0-4998-A14D-DCC8599AD3FA"></a><h3 id="UPGRD-GUID-F3DAC69A-A5D0-4998-A14D-DCC8599AD3FA" class="sect3">对Oracle数据库降级进行故障排除</h3>
               <div>
                  <p>使用此故障排除信息可以解决降级Oracle数据库时可能出现的问题。</p>
                  <p>本节包含降级期间可能发生的已知错误，以及解决这些错误的解决方法。</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-B34BCFE6-C55F-4D69-BA59-FCC883CD3EA1">错误使用catdwgrd.sql脚本降级Oracle数据库组件</a><br>在降级期间运行<code class="codeph">catdwgrd.sql</code>脚本时，使用此部分可以解决错误，例如<code class="codeph">ORA-20001</code> ：降级无法继续。
                     </li>
                     <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-627D70F7-D0B2-442C-B520-06BEBDEBF59C">Oracle Multimedia降级和imrelod.sql脚本错误</a><br>检查是否遇到ORA-20000：注册表中的Oracle ORDIM组件状态为：DOWNGRADED。</li>
                     <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-DC657D49-A972-4F3F-9D39-D59860133BF8">Oracle Database Vault和dvrelod.sql脚本错误</a><br>检查是否遇到ORA-31011：XML解析失败。
                     </li>
                     <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-4B6D5991-6336-4FCC-A8B3-6DA35F4D4C91">升级成功或失败后降级Oracle Grid Infrastructure（Oracle Restart）</a><br>要降级Oracle Restart，必须取消配置，然后重新安装Oracle Grid Infrastructure。然后，您可以添加数据库和服务。
                     </li>
                     <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-865ED278-8D25-4D79-8C8F-70343C4535F1">Oracle ACFS和Oracle Grid Infrastructure降级至11g第2版（11.2）</a><br>在尝试启动软件堆栈之前，必须运行<code>acfsroot install</code> 。
                     </li>
                     <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-F5278C79-EB57-4E68-BE58-758F7A9F22FA">降级Oracle Database 11g第1版（11.1）后的数据库链接密码</a><br>重置在版本11.2或12.1中创建的任何数据库链接的密码。
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：将</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-CAD9888A-2E6E-48F8-938C-B3E861738606" title="对于受支持的Oracle数据库版本，您可以将数据库降级到上次升级的版本。">Oracle数据库降级为早期版本</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="sect3"><a id="GUID-B34BCFE6-C55F-4D69-BA59-FCC883CD3EA1" name="GUID-B34BCFE6-C55F-4D69-BA59-FCC883CD3EA1"></a><h4 id="UPGRD-GUID-B34BCFE6-C55F-4D69-BA59-FCC883CD3EA1" class="sect4">错误使用catdwgrd.sql脚本降级Oracle数据库组件</h4>
                  <div>
                     <p>在降级期间运行<code class="codeph">catdwgrd.sql</code>脚本时，使用此部分可以解决错误，例如<code class="codeph">ORA-20001</code> ：降级无法继续。
                     </p>
                     <p><code>catdwgrd.sql</code>脚本将数据库中的所有Oracle数据库组件降级到最初升级的主要版本。必须在可以降级数据字典之前运行此脚本。如果在运行脚本时遇到任何问题，请更正问题的原因，然后重新运行脚本。
                     </p>
                     <p>您可以看到的错误包括<code class="codeph">ORA-39709</code> ：不完整的组件降级; string downgrade aborted， <code class="codeph">ORA-06512</code> 。发生这些错误时，降级无法继续。
                     </p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><span class="bold">原因</span> ：在继续进行数据字典降级之前必须降级的一个或多个组件未降级。
                           </p>
                        </li>
                        <li>
                           <p><span class="bold">操作</span> ：查看日志文件以确定在<code class="codeph">catdwgrd.sql</code>脚本暂停之前发生了哪些错误，并且已停止降级。
                           </p>
                        </li>
                     </ul>
                     <p>查看这些示例以了解如何更正此问题。</p>
                     <p>错误通常描述了您必须采取的措施来解决阻止降级完成的问题。按照错误消息中的说明进行操作。修复错误原因后，重新运行<code>catdwgrd.sql</code>脚本。
                     </p>
                     <p>例如，如果由于检查而在降级CDB $ ROOT期间CDB降级失败，请按照错误消息中的说明修复条件错误。在修复错误，重新运行<code>catdwgrd.sql</code>与<code class="codeph">catcon.pl</code> 。使用<code class="codeph">-c</code>选项运行包含列表<code class="codeph">'CDB$ROOT PDB1'</code> 。使用<code class="codeph">-r</code>选项首先在PDB上运行命令，然后在CDB $ ROOT上运行。例如：</p><pre class="pre codeblock"><code>$ ORACLE_HOME / perl / bin / perl $ ORACLE_HOME / rdbms / admin / catcon.pl -d $ ORACLE_HOME / rdbms / admin -e -b catdwgrd -l / scratch / rac / downgradeLogs -c'CDB $ ROOT，PDB1，PDB2' -r catdwgrd.sql</code></pre><div class="example" id="GUID-B34BCFE6-C55F-4D69-BA59-FCC883CD3EA1__GUID-4AE6D301-0665-463A-9C28-7079B1B1265B">
                        <p class="titleinexample">例7-1由ORA-06512引起的ORA-20001错误</p>
                        <p>你的降级停止了。查看日志文件时，您会发现<code>catdwgrd.sql</code>终止此错误：</p><pre class="pre codeblock"><code>第1行的DECLARE * ERROR：ORA-20001：降级无法继续 - 存在Unified Audit Trail数据。请先使用DBMS_AUDIT_MGMT.CLEAN_AUDIT_TRAIL清理数据。 ORA-06512：第65行ORA-06512：第42行</code></pre><p>您必须在<code class="codeph">CDB$ROOT</code>和所有PDB上清除统一审核试验。
                        </p>
                        <div class="p">例如：<ol>
                              <li>
                                 <p>寻找统一审计线索的存在：</p><pre class="pre codeblock"><code>SQL&gt; SELECT COUNT（*）FROM UNIFIED_AUDIT_TRAIL; COUNT（*）---------- 4538</code></pre></li>
                              <li>
                                 <p>清除审计跟踪。在国家开发银行。</p>
                                 <p>例如，审计跟踪类型为<code class="codeph">DBMS_AUDIT.MGMT.AUDIT</code> ：</p><pre class="pre codeblock"><code>EXEC DBMS_AUDIT_MGMT.CLEAN_AUDIT_TRAIL DBMS_AUDIT_MGMT.AUDIT</code></pre></li>
                              <li>
                                 <p>在<code class="codeph">CDB$ROOT</code>上运行<code class="codeph">catdwngrd.sql</code> 。如果PDB仍具有统一的审计数据，则脚本将因ORA20001而失败：</p><pre class="pre codeblock"><code>62执行立即63'从audsys中选择计数（*）。'|''''|| tab_name ||'“'进入no_rows; 64 65  - 如果审计跟踪有一些数据，则提高应用程序错误66如果no_rows&gt; 0那么67 RAISE_APPLICATION_ERROR（-20001，ErrMsg）; 68结束IF; 69结束IF; 70结束IF; 71例外72当NO_DATA_FOUND那么73 NULL; 74当其他75岁升起时; 76结束; 77 / DECLARE *错误在第1行：ORA-20001：降级无法继续 - 存在Unified Audit Trail数据。请先使用DBMS_AUDIT_MGMT.CLEAN_AUDIT_TRAIL清理数据。 ORA-06512：第75行</code></pre></li>
                              <li>
                                 <p>连接到各个PDB，并查找它们是否具有统一的审计跟踪。清除所有PDB的统一审计跟踪。例如，名为PDB1的PDB具有统一的审计跟踪：</p><pre class="pre codeblock"><code>ALTER SESSION SET container = PDB1; SQL&gt; SELECT COUNT（*）FROM UNIFIED_AUDIT_TRAIL; COUNT（*）---------- 1330</code></pre></li>
                              <li>
                                 <p>确定统一的审计跟踪：</p><pre class="pre codeblock"><code>SQL&gt; CREATE TABLE UA_DATA AS（SELECT * FROM UNIFIED_AUDIT_TRAIL）;</code></pre></li>
                              <li>
                                 <p>清除审计跟踪。</p>
                                 <p>在此示例中，审计跟踪类型为<code class="codeph">DBMS_AUDIT_MGMT.AAUDIT_TRAIL_UNIFIED</code> ， <code class="codeph">USE_LAST_ARCH_TIMESTAMP</code>值设置为<code class="codeph">FALSE</code> ，以便删除所有审计记录，而不考虑上次存档时间戳，并将<code class="codeph">CONTAINER</code>值设置为<code class="codeph">DBMS_AUDIT_MGMT.CONTAINER_ALL</code> ，以便审计记录清除所有PDB。
                                 </p><pre class="pre codeblock"><code>BEGIN DBMS_AUDIT_MGMT.CLEAN_AUDIT_TRAIL（AUDIT_TRAIL_TYPE =&gt; DBMS_AUDIT_MGMT.AUDIT_TRAIL_UNIFIED，USE_LAST_ARCH_TIMESTAMP =&gt; FALSE，CONTAINER =&gt; DBMS_AUDIT_MGMT.CONTAINER_ALL END; /</code></pre></li>
                              <li>
                                 <p>在PDB和CDB级别重新运行<code class="codeph">catdwngrd.sql</code> 。例如：</p><pre class="pre codeblock"><code>$ ORACLE_HOME / perl / bin / perl $ ORACLE_HOME / rdbms / admin / catcon.pl -c'CDB $ ROOT，PDB1'-d $ ORACLE_HOME / rdbms / admin -e -b catdwgrd -l /u01/oracle/product/19.0 .0 / downgrade_logs -r catdwgrd.sql</code></pre></li>
                              <li>
                                 <p>重复查找和清除审计跟踪的过程并运行<code class="codeph">catdwgrd.sql</code>直到脚本在CDB和PDB上成功完成，并且您不再在日志中看到<code class="codeph">ORA-20001</code>错误</p>
                              </li>
                           </ol> 
                        </div>
                     </div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="../dbseg/administering-the-audit-trail.html#DBSEG-GUID-7D2E55CE-2820-47E3-A989-5F7AAB19CD76" target="_blank"><span><cite>Oracle数据库安全指南</cite></span></a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-F3DAC69A-A5D0-4998-A14D-DCC8599AD3FA" title="使用此故障排除信息可以解决降级Oracle数据库时可能出现的问题。">对Oracle数据库降级进行故障排除</a></p>
                        </div>
                     </div>
                  </div>
               </div><a id="UPGRD60114"></a><div class="props_rev_3"><a id="GUID-627D70F7-D0B2-442C-B520-06BEBDEBF59C" name="GUID-627D70F7-D0B2-442C-B520-06BEBDEBF59C"></a><h4 id="UPGRD-GUID-627D70F7-D0B2-442C-B520-06BEBDEBF59C" class="sect4">Oracle Multimedia降级和imrelod.sql脚本错误</h4>
                  <div>
                     <p>检查是否遇到ORA-20000：注册表中的Oracle ORDIM组件状态为：DOWNGRADED。</p>
                     <p>将Oracle数据库从版本12.1降级到版本11.2.0.2时，可能会从版本11.2.0.2中包含的<code class="codeph">imrelod.sql</code>脚本引发错误。
                     </p>
                     <p><code class="codeph">ORA-20000：注册表中的Oracle ORDIM组件状态为：DOWNGRADED。在Oracle Multimedia升级，降级或修补之前，必须安装Oracle ORDIM并使其有效。</code></p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><span class="bold">原因</span> <code class="codeph">imrelod.sql</code>脚本引发此错误，因为它不知道ORDIM的状态。</p>
                        </li>
                        <li>
                           <p><span class="bold">行动</span>没有行动。您可以忽略此错误。
                           </p>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-F3DAC69A-A5D0-4998-A14D-DCC8599AD3FA" title="使用此故障排除信息可以解决降级Oracle数据库时可能出现的问题。">对Oracle数据库降级进行故障排除</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="UPGRD60115"></a><div class="props_rev_3"><a id="GUID-DC657D49-A972-4F3F-9D39-D59860133BF8" name="GUID-DC657D49-A972-4F3F-9D39-D59860133BF8"></a><h4 id="UPGRD-GUID-DC657D49-A972-4F3F-9D39-D59860133BF8" class="sect4">Oracle Database Vault和dvrelod.sql脚本错误</h4>
                  <div>
                     <p>检查是否遇到ORA-31011：XML解析失败。</p>
                     <p>将Oracle数据库从版本12.1降级到版本11.2.0.3时，使用Oracle Database Vault的数据库可能会遇到以下错误，这是由版本11.2.0.3中包含的<code class="codeph">dvrelod.sql</code>脚本引起的：</p><pre class="pre codeblock"><code>ORA-31011：XML解析失败; Oracle Database Vault降级到版本11.2.0.3</code></pre><ul style="list-style-type:disc">
                        <li>
                           <p><span class="bold">原因</span> <code class="codeph">dvrelod.sql</code>脚本不知道XML解析的状态。
                           </p>
                           <p><span class="bold">行动</span>没有行动。您可以忽略此消息。
                           </p>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-F3DAC69A-A5D0-4998-A14D-DCC8599AD3FA" title="使用此故障排除信息可以解决降级Oracle数据库时可能出现的问题。">对Oracle数据库降级进行故障排除</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="UPGRD60143"></a><div class="props_rev_3"><a id="GUID-4B6D5991-6336-4FCC-A8B3-6DA35F4D4C91" name="GUID-4B6D5991-6336-4FCC-A8B3-6DA35F4D4C91"></a><h4 id="UPGRD-GUID-4B6D5991-6336-4FCC-A8B3-6DA35F4D4C91" class="sect4">升级成功或失败后降级Oracle Grid Infrastructure（Oracle Restart）</h4>
                  <div>
                     <p>要降级Oracle Restart，必须取消配置，然后重新安装Oracle Grid Infrastructure。然后，您可以添加数据库和服务。</p>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="https://support.oracle.com/rs?type=doc&amp;id=1364412.1" target="_blank">https://support.oracle.com/rs?type=doc&amp;id=1364412.1</a></li>
                           <li><a href="../install-and-upgrade.html" target="_blank"><span><cite>Oracle Grid Infrastructure安装和升级指南</cite></span></a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-F3DAC69A-A5D0-4998-A14D-DCC8599AD3FA" title="使用此故障排除信息可以解决降级Oracle数据库时可能出现的问题。">对Oracle数据库降级进行故障排除</a></p>
                        </div>
                     </div>
                  </div>
               </div><a id="UPGRD60116"></a><div class="props_rev_3"><a id="GUID-865ED278-8D25-4D79-8C8F-70343C4535F1" name="GUID-865ED278-8D25-4D79-8C8F-70343C4535F1"></a><h4 id="UPGRD-GUID-865ED278-8D25-4D79-8C8F-70343C4535F1" class="sect4">Oracle ACFS和Oracle Grid Infrastructure降级至11g第2版（11.2）</h4>
                  <div>
                     <p>在尝试启动软件堆栈之前，必须运行<code>acfsroot install</code> 。
                     </p>
                     <p>如果您使用Oracle ASM集群文件系统（Oracle ACFS），并升级到Oracle Grid Infrastructure 12c，无论是集群还是Oracle Restart独立服务器，您选择降级到Oracle Grid Infrastructure 11g第2版（11.2），然后在尝试启动11.2版软件堆栈之前，必须从版本11.2 Oracle Grid Infrastructure Oracle home（Grid home）运行命令<code class="codeph">acfsroot install</code> 。
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-F3DAC69A-A5D0-4998-A14D-DCC8599AD3FA" title="使用此故障排除信息可以解决降级Oracle数据库时可能出现的问题。">对Oracle数据库降级进行故障排除</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="UPGRD60144"></a><div class="props_rev_3"><a id="GUID-F5278C79-EB57-4E68-BE58-758F7A9F22FA" name="GUID-F5278C79-EB57-4E68-BE58-758F7A9F22FA"></a><h4 id="UPGRD-GUID-F5278C79-EB57-4E68-BE58-758F7A9F22FA" class="sect4">降级Oracle Database <span class="italic">11g</span>第1版（11.1）后的数据库链接密码</h4>
                  <div>
                     <p>重置在版本11.2或12.1中创建的任何数据库链接的密码。</p>
                     <p>降级到Oracle数据库版本11.1后，您需要重置在版本11.2或12.1中创建的任何数据库链接的密码。</p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-339D0338-A80C-4B5C-8406-57E7ABEC8121">降级到Oracle Database 11.1第1版后，数据库链接密码出现ORA-00600错误</a><br>如果您不重置数据库链接密码可能会发生此错误。
                        </li>
                        <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-EB0943DA-C2C5-4CC9-93B5-9B2675BCD496">使用Oracle Data Pump导出创建包含所有现有数据库链接的转储文件</a><br>在执行降级之前，请使用此Oracle Data Pump导出过程创建包含所有现有数据库链接的转储文件。
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-F3DAC69A-A5D0-4998-A14D-DCC8599AD3FA" title="使用此故障排除信息可以解决降级Oracle数据库时可能出现的问题。">对Oracle数据库降级进行故障排除</a></p>
                        </div>
                     </div>
                  </div>
                  
                  <div class="props_rev_3"><a id="GUID-339D0338-A80C-4B5C-8406-57E7ABEC8121" name="GUID-339D0338-A80C-4B5C-8406-57E7ABEC8121"></a><h5 id="UPGRD-GUID-339D0338-A80C-4B5C-8406-57E7ABEC8121" class="sect5">降级到Oracle Database 11.1第1版后，数据库链接密码出现ORA-00600错误</h5>
                     <div>
                        <p>如果您不重置数据库链接密码可能会发生此错误。</p>
                        <div class="p">如果不重置数据库链接密码，则当有人试图使用数据库链接时，将显示内部错误。作为参考，当Oracle服务器无法检索数据库链接的密码时，这是Oracle跟踪文件中报告的内部错误：<pre class="pre codeblock"><code>ORA-00600：[kzdlk_zt2错误]，[18446744073709551601]</code></pre></div>
                        <p>要在降级到版本11.1后重置数据库链接的密码，请使用<code>ALTER DATABASE LINK</code>命令通过在IDENTIFIED BY子句中指定原始密码将密码更改回原始密码。
                        </p>
                        <p>要在运行没有此密码问题的Oracle Database 11.2或12.1版本时创建新的数据库链接，请与Oracle支持部门联系，以获取有关如何使用<code>CREATE DATABASE LINK</code>命令的IDENTIFIED BY VALUES子句的信息。
                        </p>
                     </div>
                     <div>
                        <div class="infoboxnotealso" id="GUID-339D0338-A80C-4B5C-8406-57E7ABEC8121__GUID-E8A3F122-7431-4AAC-B9E4-B28A8BC43490">
                           <p class="notep1">也可以看看：</p>
                           <p>有关<code class="codeph">ALTER</code> <code class="codeph">DATABASE</code> <code class="codeph">LINK</code>信息，请<a href="../sqlrf/ALTER-DATABASE-LINK.html#SQLRF30050" target="_blank"><span class="italic">参见Oracle数据库SQL语言参考</span></a></p>
                           <p> </p>
                           <p><a href="../admin/developing-applications-for-a-distributed-database-system.html#ADMIN12194" target="_blank"><span class="italic">“Oracle数据库管理员指南”</span></a> ，了解有关控制数据库链接建立的连接的信息</p>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-F5278C79-EB57-4E68-BE58-758F7A9F22FA" title="重置在版本11.2或12.1中创建的任何数据库链接的密码。">降级Oracle Database 11g第1版（11.1）后的数据库链接密码</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="UPGRD60145"></a><div class="props_rev_3"><a id="GUID-EB0943DA-C2C5-4CC9-93B5-9B2675BCD496" name="GUID-EB0943DA-C2C5-4CC9-93B5-9B2675BCD496"></a><h5 id="UPGRD-GUID-EB0943DA-C2C5-4CC9-93B5-9B2675BCD496" class="sect5">使用Oracle Data Pump导出创建包含所有现有数据库链接的转储文件</h5>
                     <div>
                        <p>在执行降级之前，请使用此Oracle Data Pump导出过程创建包含所有现有数据库链接的转储文件。</p>
                        <p></p>
                        <p>您创建的转储文件包括任何新创建的数据库链接。该过程使用带有<code>expdp</code>命令的<span class="parmname" translate="no">FULL=Y</span>和<span class="parmname" translate="no">INCLUDE=DB_LINK</span>参数。
                        </p>
                        <ol>
                           <li>
                              <p>登录SQL * Plus。</p>
                              <p>例如：</p><pre class="pre codeblock"><code>sqlplus系统/经理</code></pre></li>
                           <li>
                              <p>删除转储目录以防万一存在。</p>
                              <p>例如：</p><pre class="pre codeblock"><code>SQL&gt; DROP DIRECTORY dpump_dir; SQL&gt; CREATE DIRECTORY dpump_dir AS'/ location_to_write_datapump_dump_file';</code></pre></li>
                           <li>
                              <p>导出数据库链接。</p>
                              <p>例如：</p><pre class="pre codeblock"><code>$ expdp system / manager FULL = Y directory = dpump_dir dumpfile = saved_dblinks.dmp INCLUDE = DB_LINK;</code></pre></li>
                           <li>
                              <p>降级后，如果任何降级的数据库链接无法正常工作，则删除这些链接，并从转储文件中导入它们：</p><pre class="pre codeblock"><code>$ impdp system / manager directory = dpump_dir dumpfile = saved_dblinks.dmp;</code></pre><p>例如，如果您发现链接显示内部错误ORA-00600，则从转储文件中删除和导入链接应该使这些链接按预期工作。</p>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-F5278C79-EB57-4E68-BE58-758F7A9F22FA" title="重置在版本11.2或12.1中创建的任何数据库链接的密码。">降级Oracle Database 11g第1版（11.1）后的数据库链接密码</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>