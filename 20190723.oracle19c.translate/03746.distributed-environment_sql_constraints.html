<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="This section explains some of the constraints on SQL in a distributed environment."></meta>
      <meta name="description" content="This section explains some of the constraints on SQL in a distributed environment."></meta>
      <title>分布式环境中SQL的约束</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Database Heterogeneous Connectivity User&#39;s Guide"></meta>
      <meta property="og:description" content="This section explains some of the constraints on SQL in a distributed environment."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Database Heterogeneous Connectivity User&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="heterogeneous-connectivity-users-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-04-16T12:43:36-07:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2001, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96192-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="sql-plus-describe-command.html" title="Previous" type="text/html"></link>
      <link rel="next" href="optimizer-and-heterogeneous-services.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Heterogeneous Connectivity User&#39;s Guide"></meta>
    <meta name="dcterms.isVersionOf" content="HETER"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="sql-plus-describe-command.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="optimizer-and-heterogeneous-services.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">数据库异构连接用户指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="oracle-database-gateways-features.html" property="item" typeof="WebPage"><span property="name">Oracle数据库网关的功能</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">分布式环境中SQL的约束</li>
            </ol>
            <a id="GUID-630A201B-62B0-4643-A4CF-85D58AA8105F" name="GUID-630A201B-62B0-4643-A4CF-85D58AA8105F"></a><a id="HETER4071"></a>
            
            <h2 id="HETER-GUID-630A201B-62B0-4643-A4CF-85D58AA8105F" class="sect2">分布式环境中SQL的约束</h2>
         </header>
         <div class="ind">
            <div>
               <p>本节介绍分布式环境中SQL的一些约束。</p>
               <p>这些约束适用于访问非Oracle系统或远程Oracle数据库的分布式环境。</p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="distributed-environment_sql_constraints.html#GUID-E93FB210-DADE-4EE4-BC42-1E1DA507D934">远程和异构参考</a><br>许多异构访问规则也适用于远程引用。
                  </li>
                  <li class="ulchildlink"><a href="distributed-environment_sql_constraints.html#GUID-57497077-1253-490F-9940-C2D5B2ECB6E1">在分布式环境中使用SQL进行远程映射时的规则和限制</a><br>在分布式环境中使用SQL进行远程映射时，存在规则和限制。
                  </li>
               </ul>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>父主题：</strong> <a href="oracle-database-gateways-features.html#GUID-13FD7B76-9463-4EE3-8DDA-13C1AA7C815C">Oracle数据库网关的功能</a></p>
                  </div>
               </div>
            </div>
            <a id="HETER4072"></a><div class="props_rev_3"><a id="GUID-E93FB210-DADE-4EE4-BC42-1E1DA507D934" name="GUID-E93FB210-DADE-4EE4-BC42-1E1DA507D934"></a><h3 id="HETER-GUID-E93FB210-DADE-4EE4-BC42-1E1DA507D934" class="sect3">远程和异构参考</h3>
               <div>
                  <p>许多异构访问规则也适用于远程引用。</p>
                  <p>SQL语句可以在SQL语句或本地节点中引用的任何数据库节点上执行。如果引用的所有对象都解析为单个引用的节点，Oracle会尝试在该节点上执行查询。您可以使用<code class="codeph">/*+ REMOTE_MAPPED */</code>或<code class="codeph">/*+ DRIVING_SITE */</code>提示强制在引用的节点上执行。如果语句被转发到发出语句的节点以外的节点，则该语句是<span class="bold">远程映射的</span> 。
                  </p>
                  <p>对远程映射语句有完整的数据类型检查支持。结果提供了一致的数据类型检查和完整的数据类型强制。</p>
                  <p>SQL语句必须遵循特定的规则才能进行远程映射。如果不遵循这些规则，则会发生错误。应用规则的顺序无关紧要。</p>
                  <p>在分布式环境中使用SQL进行远程映射时，存在不同的约束。此分布式环境可以包括通过Oracle数据库网关访问的远程Oracle数据库和非Oracle数据库。</p>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="database-server-sql-construct-processing.html#GUID-0A2CA01B-9EAE-46AD-96F4-CF769596131C" title="当需要翻译或后处理语句时，异构服务和网关会重写SQL语句。">Oracle数据库服务器SQL构造处理</a></li>
                        <li><a href="distributed-environment_sql_constraints.html#GUID-57497077-1253-490F-9940-C2D5B2ECB6E1" title="在分布式环境中使用SQL进行远程映射时，存在规则和限制。">在分布式环境中使用SQL进行远程映射时的规则和限制</a></li>
                     </ul>
                  </div>
                  <div class="infoboxnotealso" id="GUID-E93FB210-DADE-4EE4-BC42-1E1DA507D934__NOTE-136-E137732A">
                     <p class="notep1">也可以看看：</p>
                     <p><a href="../admin/distributed-database-concepts.html#ADMIN028" target="_blank"><span class="italic">“Oracle数据库管理员指南”</span></a> ，了解有关分布式数据库的信
                     </p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="distributed-environment_sql_constraints.html#GUID-630A201B-62B0-4643-A4CF-85D58AA8105F" title="本节介绍分布式环境中SQL的一些约束。">对分布式环境中的SQL的约束</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="HETER4074"></a><a id="HETER4075"></a><a id="HETER4076"></a><a id="HETER4077"></a><a id="HETER4078"></a><a id="HETER4079"></a><a id="HETER4080"></a><a id="HETER4081"></a><a id="HETER4082"></a><a id="HETER4083"></a><a id="HETER4073"></a><div class="props_rev_3"><a id="GUID-57497077-1253-490F-9940-C2D5B2ECB6E1" name="GUID-57497077-1253-490F-9940-C2D5B2ECB6E1"></a><h3 id="HETER-GUID-57497077-1253-490F-9940-C2D5B2ECB6E1" class="sect3">在分布式环境中使用SQL进行远程映射时的规则和限制</h3>
               <div>
                  <p>在分布式环境中使用SQL进行远程映射时，存在规则和限制。</p>
                  <p>以下部分列出了在分布式环境中使用SQL进行远程映射时存在的一些不同规则或限制。</p>
                  <div class="infoboxnote" id="GUID-57497077-1253-490F-9940-C2D5B2ECB6E1__GUID-A4B78245-D455-4754-B664-C8AFA66BD61A">
                     <p class="notep1">注意：</p>
                     <p>在下面的示例中， <code class="codeph">remote_db</code>名词指的是远程非Oracle系统，而<code class="codeph">remote_oracle_db</code>名词指的是远程Oracle数据库。
                     </p>
                  </div>
                  <div class="section">
                     <p class="subhead2" id="GUID-57497077-1253-490F-9940-C2D5B2ECB6E1__GUID-5011FB0D-D923-4C3E-B346-454A5F3B8A37">规则A：无法远程映射数据定义语言语句。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>在Oracle数据定义语言中，目标对象在语法上没有远程引用的位置。包含远程引用的数据定义语言语句在本地执行。对于异构服务，这意味着它无法使用SQL直接在非Oracle数据库中创建数据库对象。</p>
                     <p>您可以使用passthrough SQL单独创建数据库对象，如以下示例所示：</p><pre class="oac_no_warn" dir="ltr">DECLARE num_rows INTEGER; BEGIN num_rows：= DBMS_HS_PASSTHROUGH.EXECUTE_IMMEDIATE@remote_db（'create table x1（c1 char，c2 int）'）;结束;</pre></div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-57497077-1253-490F-9940-C2D5B2ECB6E1__GUID-DBF84D30-B405-4F7F-AD27-82B61233AC62">规则B：必须远程映射具有远程目标表的INSERT，UPDATE和DELETE语句。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>对于非Oracle远程数据库，此规则对远程Oracle数据库的限制更严格。这是因为远程系统在执行针对非Oracle系统中的表的数据操作语言（DML）语句时无法从原始Oracle数据库检索数据。</p>
                     <p>例如，要将本地<code class="codeph">emp</code>表中的所有本地员工插入远程非Oracle <code class="codeph">emp</code>表，请使用以下语句：</p><pre class="oac_no_warn" dir="ltr">INSERT INTO \ temp @ remote_db SELECT * FROM \ temp;</pre><p>此语句远程映射到远程数据库。发送到远程数据库的远程映射语句包含一个远程引用，该引用返回到<code class="codeph">emp</code>表的原始数据库。远程数据库接收的远程链接称为a <a id="d5552e192" class="indexterm-anchor"></a> <span class="bold">回调链接</span> 。
                     </p>
                     <div class="infoboxnote" id="GUID-57497077-1253-490F-9940-C2D5B2ECB6E1__GUID-67E69EDE-4EDF-438B-A1D2-3500350576C3">
                        <p class="notep1">注意：</p>
                        <p>尽管通用异构服务支持回调链接，但它们可能未在所有异构服务代理中实现。有关详细信息，请参阅数据库网关文档以确定回调链接是否与您正在使用的数据库网关一起使用。</p>
                     </div>
                     <p>如果特定网关不支持回调链接，则先前的<code class="codeph">INSERT</code>语句将返回以下错误：</p><pre class="oac_no_warn" dir="ltr">ORA-02025：SQL语句中的所有表必须位于远程数据库中</pre><p>解决方法是编写PL / SQL块。例如：</p><pre class="oac_no_warn" dir="ltr">DECLARE CURSOR remote_insert IS SELECT * FROM emp; BEGIN FOR rec IN remote_insert LOOP INSERT INTO \ temp @ remote_db（empno，ename，deptno）VALUES（rec.empno，rec.ename，rec.deptno）; END循环;结束;</pre><p>另一个特殊情况涉及特定于会话的SQL函数，例如<code class="codeph">USER</code> ， <code class="codeph">USERENV</code>和<code class="codeph">SYSDATE</code> 。这些功能必须在原始站点执行。具有这些函数的远程映射语句包含回调链接。对于不支持回调的非Oracle数据库，这可能（默认情况下）会导致限制错误。
                     </p>
                     <p>例如，请考虑以下语句：</p><pre class="oac_no_warn" dir="ltr">DELETE FROM \ temp @ remote_db WHERE hiredate&gt; sysdate;</pre><p>前一个语句返回以下错误消息：</p><pre class="oac_no_warn" dir="ltr">ORA-02070：数据库<span class="italic">REMOTE_DB</span>在此上下文中不支持特殊功能</pre><p>这可以通过用绑定变量替换特殊函数来解决。例如：</p><pre class="oac_no_warn" dir="ltr">DELETE FROM emp @ remote_db WHERE hiredate&gt;：1;</pre></div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-57497077-1253-490F-9940-C2D5B2ECB6E1__GUID-EC187264-6194-4BF9-B7C9-FB9E601B3C81">规则C：无法远程映射对象功能，例如具有嵌套表列，ADT列，不透明列或参考列的表。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>目前，异构访问不支持这些列类型。因此，不直接遇到这种限制。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-57497077-1253-490F-9940-C2D5B2ECB6E1__GUID-F6D52F0A-1BB0-433C-8EE4-5B5CDF8C55D5">规则D：无法远程映射包含远程站点不支持的运算符和构造的SQL语句。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>对于<code class="codeph">INSERT</code> ， <code class="codeph">UPDATE</code>或<code class="codeph">DELETE</code>语句，无法执行SQL语句（请参阅规则B）。但是，如果可以通过回调链接执行不受支持的运算符或构造，则可以执行SQL语句。
                     </p>
                     <p>对于<code class="codeph">SELECT</code>语句，如果其余规则都不需要远程映射语句，则可以执行受此规则影响的语句。受此规则影响的<code class="codeph">SELECT</code>语句是通过远程<code class="codeph">SELECT</code>操作检索所有必需数据，并使用SQL引擎在本地处理不支持的运算符或构造来执行的。
                     </p>
                     <p>远程<code class="codeph">SELECT</code>操作是从远程表检索行的操作，而不是从本地表检索数据的操作。全表扫描是指通过网络远程表中的所有数据，而不检索任何过滤（例如， <code class="codeph">SELECT * FROM EMP</code> ）。
                     </p>
                     <p>全表扫描很昂贵，因此，Oracle名词试图避免它们。如果远程表上有可以使用的索引，则在<code class="codeph">WHERE</code>子句谓词中使用这些索引来减少通过网络检索的行数。
                     </p>
                     <p>您可以通过解释语句并查询每个<code class="codeph">REMOTE</code>操作的说明计划表的<code class="codeph">OTHER</code>列来检查Oracle数据库生成的SQL语句。
                     </p>
                     <div class="infoboxnotealso" id="GUID-57497077-1253-490F-9940-C2D5B2ECB6E1__GUID-C90B681E-4D2C-421D-B455-389A33871DE3">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="optimizer-and-heterogeneous-services.html#GUID-13DB0D52-07F2-4BEA-8054-A3A75069344D" title="使用索引和表统计信息的示例。">示例：使用索引和表统计</a>信息获取有关如何使用远程引用解释说明计划的更多信息。
                        </p>
                     </div>
                     <p>例如，请考虑以下语句：</p><pre class="oac_no_warn" dir="ltr">SELECT COUNT（*）FROM emp @ remote_db WHERE hiredate &lt;sysdate;</pre><p>该语句返回以下输出：</p><pre class="oac_no_warn" dir="ltr">COUNT（*）---------- 14选择1行。
</pre><p>远程表扫描是：</p><pre class="oac_no_warn" dir="ltr">SELECT hiredate FROM emp;</pre><p>无法生成转换为过滤器的谓词并将其传递给远程操作，因为<span class="italic"><code class="codeph">remote_db</code></span>或评估规则不支持<code class="codeph">sysdate</code> 。因此<code class="codeph">sysdate</code>必须在本地执行。
                     </p>
                     <div class="infoboxnote" id="GUID-57497077-1253-490F-9940-C2D5B2ECB6E1__GUID-33B3C3A0-0B4B-410A-B749-CC277F876167">
                        <p class="notep1">注意：</p>
                        <p>由于远程表扫描操作仅与原始查询部分相关，因此检索的行数可能远大于预期，并且可能对性能产生重大影响。</p>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-57497077-1253-490F-9940-C2D5B2ECB6E1__GUID-6F7963E9-403A-4D48-AB48-ABCB83FBFA3B">规则E：包含表表达式的SQL语句无法进行远程映射。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>不直接遇到此限制，因为异构访问模块不支持表表达式。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-57497077-1253-490F-9940-C2D5B2ECB6E1__GUID-B62EA642-95B1-4125-BE40-9FB9CED53DE3">规则F：如果SQL语句选择LONG数据，则必须将语句映射到包含LONG数据的表所在的节点。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>请考虑以下类型的陈述：</p><pre class="oac_no_warn" dir="ltr">SELECT long1 FROM <span class="italic">table_with_long</span> @ <span class="italic">remote_db</span> ，dual;</pre><p>前一个语句返回以下错误消息（如果不支持回调链接）：</p><pre class="oac_no_warn" dir="ltr">ORA-02025：SQL语句中的所有表必须位于远程数据库中</pre></div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-57497077-1253-490F-9940-C2D5B2ECB6E1__GUID-D4F51628-6D7A-4747-A83C-581D35927ECC">规则G：当SQL语句的格式为“SELECT ...”时，语句必须映射到FOR UPDATE OF子句中引用了列的表所在的节点。更新...“</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>当SQL语句的格式为<code class="codeph">SELECT...FOR UPDATE OF...,</code>语句必须映射到<code class="codeph">FOR UPDATE OF</code>子句中引用了列的表所在的节点。
                     </p>
                     <p>例如，请考虑以下语句：</p><pre class="oac_no_warn" dir="ltr">SELECT ename FROM emp @ remote_db WHERE hiredate &lt;sysdate FOR UPDATE OF empno;</pre><p>如果无法进行远程映射，则上一条语句将返回以下错误消息：</p><pre class="oac_no_warn" dir="ltr">ORA-02070：数据库<span class="italic">REMOTE_DB</span>在此上下文中不支持特殊功能</pre></div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-57497077-1253-490F-9940-C2D5B2ECB6E1__GUID-70B1B426-BA94-4B10-9CFA-02ABCB75192A">规则H：如果SQL语句包含序列，则必须将语句映射到每个序列所在的站点。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>异构访问模块不会遇到此规则，因为不支持远程非Oracle序列。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-57497077-1253-490F-9940-C2D5B2ECB6E1__GUID-74757BFF-6735-40F5-986B-F007924947E7">规则I：如果语句包含用户定义的运算符，则必须将语句映射到定义每个运算符的节点。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>如果语句包含用户定义的运算符，则需要将整个语句远程映射到定义运算符的数据库节点。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-57497077-1253-490F-9940-C2D5B2ECB6E1__GUID-147DE3CA-8439-492F-B022-0DFCE91EC3BC">规则J：包含重复绑定变量的语句无法进行远程映射。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>此限制的解决方法是使用唯一绑定变量并按编号绑定。</p>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="distributed-environment_sql_constraints.html#GUID-630A201B-62B0-4643-A4CF-85D58AA8105F" title="本节介绍分布式环境中SQL的一些约束。">对分布式环境中的SQL的约束</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
         </div>
      </article>
   </body>
</html>