<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>承诺</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="SQL Language Reference "></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="SQL Language Reference"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="sql-language-reference.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-02-12T15:36:36-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96310-02"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="SQL-Statements-COMMIT-to-CREATE-JAVA.html" title="Previous" type="text/html"></link>
      <link rel="next" href="CREATE-ANALYTIC-VIEW.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="SQL Language Reference"></meta>
    <meta name="dcterms.isVersionOf" content="SQLRF"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="SQL-Statements-COMMIT-to-CREATE-JAVA.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="CREATE-ANALYTIC-VIEW.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">SQL语言参考</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="SQL-Statements-COMMIT-to-CREATE-JAVA.html" property="item" typeof="WebPage"><span property="name">SQL语句：COMMIT到CREATE JAVA</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">承诺</li>
            </ol>
            <a id="GUID-6CD5C9A7-54B9-4FA2-BA3C-D6B4492B9EE2" name="GUID-6CD5C9A7-54B9-4FA2-BA3C-D6B4492B9EE2"></a><a id="SQLRF53771"></a><a id="SQLRF53772"></a><a id="SQLRF53773"></a><a id="SQLRF53774"></a><a id="SQLRF53775"></a><a id="SQLRF53776"></a><a id="SQLRF53777"></a><a id="SQLRF53778"></a><a id="SQLRF53779"></a><a id="SQLRF53780"></a><a id="SQLRF53781"></a><a id="SQLRF01110"></a>
            
            <h2 id="SQLRF-GUID-6CD5C9A7-54B9-4FA2-BA3C-D6B4492B9EE2" class="sect2">承诺</h2>
         </header>
         <div class="ind">
            <div>
               <div class="section">
                  <p class="subhead1" id="GUID-6CD5C9A7-54B9-4FA2-BA3C-D6B4492B9EE2__GUID-49EAFBF2-8E61-4268-8000-1FB82D9D4A53">目的</p>
                  <p><a id="d299968e134" class="indexterm-anchor"></a><a id="d299968e138" class="indexterm-anchor"></a><a id="d299968e142" class="indexterm-anchor"></a><a id="d299968e146" class="indexterm-anchor"></a>使用<code class="codeph">COMMIT</code>语句结束当前事务并在事务中执行永久性所有更改。<span class="bold">事务</span>是Oracle数据库视为单个单元的一系列SQL语句。此语句还会擦除事务中的所有保存点并释放事务锁。
                  </p>
                  <p>在您提交交易之前：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>您可以通过查询已修改的表来查看在事务期间所做的任何更改，但其他用户无法查看更改。提交事务后，更改对提交后执行的其他用户的语句可见。</p>
                     </li>
                     <li>
                        <p>您可以使用<code class="codeph">ROLLBACK</code>语句回滚（撤消）在事务期间所做的任何更改（请参阅<a href="ROLLBACK.html#GUID-94551F0C-A47F-43DE-BC68-9B1C1ED38C93">ROLLBACK</a> ）。
                        </p>
                     </li>
                  </ul>
                  <p>在以下情况下，Oracle数据库会发出隐式<code class="codeph">COMMIT</code> ：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>在任何语法上有效的数据定义语言（DDL）语句之前，即使语句导致错误</p>
                     </li>
                     <li>
                        <p>在完成没有错误的任何数据定义语言（DDL）语句之后</p>
                     </li>
                  </ul>
                  <p><a id="d299968e185" class="indexterm-anchor"></a>您还可以使用此语句：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>手动提交不确定的分布式事务</p>
                     </li>
                     <li>
                        <p>终止由<code class="codeph">SET</code> <code class="codeph">TRANSACTION</code>语句开始的只读事务</p>
                     </li>
                  </ul>
                  <p>Oracle建议您在断开与Oracle数据库的连接之前，使用<code class="codeph">COMMIT</code>或<code class="codeph">ROLLBACK</code>语句显式结束应用程序中的每个事务，包括最后一个事务。如果您没有显式提交事务并且程序异常终止，则会自动回滚最后一个未提交的事务。
                  </p>
                  <p><a id="d299968e214" class="indexterm-anchor"></a><a id="d299968e218" class="indexterm-anchor"></a>大多数Oracle实用程序和工具的正常退出会导致提交当前事务。从Oracle预编译器程序正常退出不会提交事务，并依赖Oracle数据库回滚当前事务。
                  </p>
                  <div class="infoboxnotealso" id="GUID-6CD5C9A7-54B9-4FA2-BA3C-D6B4492B9EE2__GUID-AF088E30-3A7F-463E-BF07-D7800200BF26">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="../cncpt/introduction-to-oracle-database.html#CNCPT016" target="_blank"><span class="italic">Oracle Database Concepts</span></a>有关事务的更多信息</p>
                        </li>
                        <li>
                           <p>有关指定事务特征的更多信息，请参阅<a href="SET-TRANSACTION.html#GUID-F11E1E30-5871-48D1-8266-F80A1DF126A1">SET TRANSACTION</a></p>
                        </li>
                     </ul>
                  </div>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-6CD5C9A7-54B9-4FA2-BA3C-D6B4492B9EE2__GUID-7E1A4098-948D-4F8F-B7E1-09CA13E9F809">先决条件</p>
                  <p>您无需提交当前事务的权限。</p>
                  <p>要手动提交最初提交的分布式不确定事务，您必须具有<code class="codeph">FORCE</code> <code class="codeph">TRANSACTION</code>系统特权。要手动提交最初由其他用户提交的分布式不确定事务，您必须具有<code class="codeph">FORCE</code> <code class="codeph">ANY</code> <code class="codeph">TRANSACTION</code>系统特权。
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-6CD5C9A7-54B9-4FA2-BA3C-D6B4492B9EE2__GUID-3460E3E2-A05D-473C-91D3-8E70E26FD976">句法</p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-6CD5C9A7-54B9-4FA2-BA3C-D6B4492B9EE2__GUID-66969D6B-27C2-47BE-A5E5-20F9A4773B18"><span class="italic">commit</span> :: =</p>
                  <div class="figure" id="GUID-6CD5C9A7-54B9-4FA2-BA3C-D6B4492B9EE2__GUID-A3523852-522C-47B3-8057-254B9064D187"><img src="img/commit.gif" alt="commit.eps的描述如下" title="commit.eps的描述如下" longdesc="img_text/commit.html"><br><a href="img_text/commit.html">commit.eps插图的描述</a></div>
                  <!-- class="figure" -->
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-6CD5C9A7-54B9-4FA2-BA3C-D6B4492B9EE2__GUID-9A61ABF3-E967-48BD-8783-6984F164DBB9">语义</p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-6CD5C9A7-54B9-4FA2-BA3C-D6B4492B9EE2__GUID-9F603413-4BB7-488E-823B-90C59CEB77A0">承诺</p>
                  <p><code class="codeph">COMMIT</code>关键字后面的所有子句都是可选的。如果仅指定<code class="codeph">COMMIT</code> ，则默认为<code class="codeph">COMMIT</code> <code class="codeph">WORK</code> <code class="codeph">WRITE</code> <code class="codeph">WAIT</code> <code class="codeph">IMMEDIATE</code> 。</p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-6CD5C9A7-54B9-4FA2-BA3C-D6B4492B9EE2__GUID-2E91E4E5-EB74-4ECE-99F1-8F4757DEB88F">工作</p>
                  <p>支持<code class="codeph">WORK</code>关键字以符合标准SQL。 <code class="codeph">COMMIT</code>和<code class="codeph">COMMIT</code> <code class="codeph">WORK</code>语句是等效的。
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-6CD5C9A7-54B9-4FA2-BA3C-D6B4492B9EE2__GUID-76FB25C8-02E5-4737-A8F8-E6B713D052D6">评论条款</p>
                  <p><a id="d299968e321" class="indexterm-anchor"></a><a id="d299968e325" class="indexterm-anchor"></a>支持此子句以实现向后兼容性。Oracle建议您使用命名事务而不是提交注释。
                  </p>
                  <div class="infoboxnotealso" id="GUID-6CD5C9A7-54B9-4FA2-BA3C-D6B4492B9EE2__GUID-4293C6E3-1314-4E55-B683-5C1457DF8C77">
                     <p class="notep1">也可以看看：</p>
                     <p>有关命名事务的更多信息，请参阅<a href="SET-TRANSACTION.html#GUID-F11E1E30-5871-48D1-8266-F80A1DF126A1">SET TRANSACTION</a>和<a href="../cncpt/transactions.html#CNCPT1122" target="_blank"><span class="italic">Oracle Database Concepts</span></a></p>
                  </div>
                  <p>指定与当前事务关联的注释。' <span class="italic"><code class="codeph">text</code></span> '是一个最多255个字节的引用文字，Oracle数据库存储在数据字典视图<code class="codeph">DBA_2PC_PENDING</code> ，如果分布式事务存在疑问， <code class="codeph">DBA_2PC_PENDING</code>与事务ID一起存储。此注释可以帮助您诊断分布式事务的失败。
                  </p>
                  <div class="infoboxnotealso" id="GUID-6CD5C9A7-54B9-4FA2-BA3C-D6B4492B9EE2__GUID-4EC688A2-BEED-461D-82DC-3BF0DBD7A302">
                     <p class="notep1">也可以看看：</p>
                     <p>有关向SQL语句添加<a href="COMMENT.html#GUID-65F447C4-6914-4823-9691-F15D52DB74D7">注释</a>的更多信息，请参阅<a href="COMMENT.html#GUID-65F447C4-6914-4823-9691-F15D52DB74D7">COMMENT</a></p>
                  </div>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-6CD5C9A7-54B9-4FA2-BA3C-D6B4492B9EE2__GUID-194E1890-5736-490C-BAF9-4B627E1BE671">写条款</p>
                  <p><a id="d299968e358" class="indexterm-anchor"></a><a id="d299968e362" class="indexterm-anchor"></a><a id="d299968e366" class="indexterm-anchor"></a>使用此子句指定将提交操作生成的重做信息写入重做日志的优先级。此子句可以通过减少延迟来提高性能，从而消除等待重做日志的I / O.在满足以下条件的情况下，使用此子句可以改善响应时间要求严格的环境中的响应时间：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>更新事务的数量很大，需要将重做日志频繁写入磁盘。</p>
                     </li>
                     <li>
                        <p>应用程序可以容忍丢失异步提交的事务。</p>
                     </li>
                     <li>
                        <p>等待重做日志写入发生的延迟对整体响应时间有很大影响。</p>
                     </li>
                  </ul>
                  <p>您可以指定<code class="codeph">WAIT</code> | <code class="codeph">NOWAIT</code>和<code class="codeph">IMMEDIATE</code> | <code class="codeph">BATCH</code>条款的任何顺序。
                  </p>
                  <div class="infoboxnote" id="GUID-6CD5C9A7-54B9-4FA2-BA3C-D6B4492B9EE2__GUID-7DC8E660-D44C-47D7-9DCC-9DF04B7DA13C">
                     <p class="notep1">注意：</p>
                     <p>如果省略此子句，则提交操作的行为由<code class="codeph">COMMIT_LOGGING</code>和<code class="codeph">COMMIT_WAIT</code>初始化参数控制（如果已设置）。
                     </p>
                  </div>
                  <p><span class="bold">等待| NOWAIT</span></p>
                  <p>使用这些子句指定控件何时返回给用户。</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><code class="codeph">WAIT</code>参数确保仅在相应的重做在联机重做日志中持久化后才会返回提交。无论是在<code class="codeph">BATCH</code>模式还是<code class="codeph">IMMEDIATE</code>模式下，当客户端从此<code class="codeph">COMMIT</code>语句成功返回时，该事务已被提交到持久介质。成功写入日志后发生崩溃可能会阻止成功消息返回到客户端。在这种情况下，客户端无法判断事务是否已提交。
                        </p>
                     </li>
                     <li>
                        <p>无论对重做日志的写入是否已完成， <code class="codeph">NOWAIT</code>参数都会使提交返回给客户端。此行为可以增加事务吞吐量。使用<code class="codeph">WAIT</code>参数，如果收到提交消息，则可以确保没有数据丢失。
                        </p>
                     </li>
                  </ul>
                  <div class="infoboxnote" id="GUID-6CD5C9A7-54B9-4FA2-BA3C-D6B4492B9EE2__GUID-59733FB9-935C-41CC-BBC5-82F2AB93D2DF">
                     <p class="notep1">注意：</p>
                     <p>使用<code class="codeph">NOWAIT</code> ，在收到提交消息之后但在写入重做日志记录之前发生崩溃可能会错误地向事务指示其更改是持久的。
                     </p>
                  </div>
                  <p>如果省略此子句，则事务将以<code class="codeph">WAIT</code>行为提交。
                  </p>
                  <p><span class="bold">立即|批量</span></p>
                  <p>使用这些子句指定何时将重做写入日志。</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><code class="codeph">IMMEDIATE</code>参数使日志写入器进程（LGWR）将事务的重做信息写入日志。此操作选项强制执行磁盘I / O，因此可以降低事务吞吐量。
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">BATCH</code>参数使重做被重缓冲到重做日志，以及其他同时执行的事务。收集到足够的重做信息后，将启动重做日志的磁盘写入。此行为称为“组提交”，因为多个事务的重做在单个I / O操作中写入日志。
                        </p>
                     </li>
                  </ul>
                  <p>如果省略此子句，则事务将以<code class="codeph">IMMEDIATE</code>行为提交。
                  </p>
                  <div class="infoboxnotealso" id="GUID-6CD5C9A7-54B9-4FA2-BA3C-D6B4492B9EE2__GUID-7322276B-FC6C-4A6E-B89C-C078942D8014">
                     <p class="notep1">也可以看看：</p>
                     <p><a href="../cncpt/transactions.html#CNCPT1119" target="_blank"><span class="italic">Oracle Database Concepts</span></a>有关异步提交的更多信息</p>
                  </div>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-6CD5C9A7-54B9-4FA2-BA3C-D6B4492B9EE2__GUID-C6507E1F-BD3A-473D-902E-4FB04EC43D63">FORCE条款</p>
                  <p><a id="d299968e478" class="indexterm-anchor"></a><a id="d299968e482" class="indexterm-anchor"></a><a id="d299968e486" class="indexterm-anchor"></a><a id="d299968e492" class="indexterm-anchor"></a><a id="d299968e496" class="indexterm-anchor"></a>在分布式数据库系统中， <code class="codeph">FORCE</code> <span class="italic"><code class="codeph">string</code></span> [， <span class="italic"><code class="codeph">integer</code></span> ]子句允许您手动提交不确定的分布式事务。事务由包含其本地或全局事务ID的“ <span class="italic"><code class="codeph">string</code></span> ”标识。要查找此类事务的ID，请查询数据字典视图<code class="codeph">DBA_2PC_PENDING</code> 。您可以使用<span class="italic"><code class="codeph">integer</code></span>专门为事务分配系统更改编号（SCN）。如果省略<span class="italic"><code class="codeph">integer</code></span> ，则使用当前SCN提交事务。</p>
                  <div class="infoboxnote" id="GUID-6CD5C9A7-54B9-4FA2-BA3C-D6B4492B9EE2__GUID-195436F5-25E5-40C4-9D52-5E5C812B2A53">
                     <p class="notep1">注意：</p>
                     <p>带<code class="codeph">FORCE</code>子句的<code class="codeph">COMMIT</code>语句仅提交指定的事务。这样的陈述不会影响您当前的交易。
                     </p>
                  </div>
                  <div class="infoboxnotealso" id="GUID-6CD5C9A7-54B9-4FA2-BA3C-D6B4492B9EE2__GUID-4BF2E3B5-962A-4B50-83F8-A01C3CF9BBCE">
                     <p class="notep1">也可以看看：</p>
                     <p><a href="../admin/managing-distributed-transactions.html#ADMIN032" target="_blank"><span class="italic">“Oracle数据库管理员指南”</span></a> ，了解有关这些主题的更多信息</p>
                  </div>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-6CD5C9A7-54B9-4FA2-BA3C-D6B4492B9EE2__GUID-6853D9EC-F35D-40E3-96B1-F3B50B4A0FC4">例子</p>
                  <p><span class="bold">提交插入：示例</span></p>
                  <p>此语句在<code class="codeph">hr.regions</code>表中插入一行并提交此更改：</p><pre class="oac_no_warn" dir="ltr">插入地区价值观（5，'南极洲'）;承诺工作;</pre><p>要提交相同的插入操作并指示数据库将更改缓冲到重做日志，而不启动磁盘I / O，请使用以下<code class="codeph">COMMIT</code>语句：</p><pre class="oac_no_warn" dir="ltr">COMMIT WRITE BATCH;</pre><p><span class="bold">评论COMMIT：示例</span></p>
                  <p>以下语句提交当前事务并将注释与其关联：</p><pre class="oac_no_warn" dir="ltr">委员会评论'不确定交易代码36，致电（415）555-2637';</pre><p>如果网络或计算机故障阻止此分布式事务正确提交，则Oracle数据库会将注释与事务ID一起存储在数据字典中。注释指示发生故障的应用程序部分，并提供有关联系提交事务的数据库管理员的信息。</p>
                  <p><span class="bold">强制进行疑问事务：示例</span></p>
                  <p>以下语句手动提交假设的不确定分布式事务。查询<code class="codeph">V$CORRUPT_XID_LIST</code>数据字典视图以查找损坏事务的事务ID。您必须具有DBA权限才能查看<code class="codeph">V$CORRUPT_XID_LIST</code>并发出此语句。
                  </p><pre class="oac_no_warn" dir="ltr">COMMIT FORCE '22 .57.53';</pre></div>
               <!-- class="section" -->
            </div>
         </div>
      </article>
   </body>
</html>