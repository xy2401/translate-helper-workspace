<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="Database Replay enables you to capture a workload on the production system and replay it on a test system. This can be very useful when evaluating or adopting new database technologies because these changes can be tested on a test system without affecting the production system."></meta>
      <meta name="description" content="Database Replay enables you to capture a workload on the production system and replay it on a test system. This can be very useful when evaluating or adopting new database technologies because these changes can be tested on a test system without affecting the production system."></meta>
      <title>使用Consolidated Database Replay</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Testing Guide "></meta>
      <meta property="og:description" content="Database Replay enables you to capture a workload on the production system and replay it on a test system. This can be very useful when evaluating or adopting new database technologies because these changes can be tested on a test system without affecting the production system."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Testing Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="testing-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-07T01:43:11-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2008, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96279-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="using-workload-intelligence.html" title="Previous" type="text/html"></link>
      <link rel="next" href="using-workload-scale-up.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Testing Guide"></meta>
    <meta name="dcterms.isVersionOf" content="RATUG"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="using-workload-intelligence.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="using-workload-scale-up.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">测试指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="database-replay.html" property="item" typeof="WebPage"><span property="name">数据库重播</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">使用Consolidated Database Replay</li>
            </ol>
            <a id="GUID-62AAF505-1DD4-414A-9F1D-4386B59B7138" name="GUID-62AAF505-1DD4-414A-9F1D-4386B59B7138"></a><a id="RATUG4080"></a>
            
            <h2 id="RATUG-GUID-62AAF505-1DD4-414A-9F1D-4386B59B7138" class="sect2"><span class="enumeration_chapter">15</span>使用Consolidated Database Replay</h2>
         </header>
         <div class="ind">
            <div>
               <div><span>通过数据库重放，您可以捕获生产系统上的工作负载并在测试系统上重放它。这在评估或采用新数据库技术时非常有用，因为这些更改可以在测试系统上进行测试，而不会影响生产系统。</span> 但是，如果正在测试的新系统提供比现有系统明显更好的性能，则数据库重放可能无法准确预测新系统可以处理多少额外工作负载。
               </div>
               <p>例如，如果要将多个生产系统整合到单个Oracle Exadata计算机中，则重放从Oracle Exadata计算机上的某个现有系统捕获的工作负载可能会在重放期间导致资源使用率降低（例如主机CPU和I / O）因为新系统功能更强大。在这种情况下，评估新系统如何处理来自所有现有系统的组合工作负载，而不是来自一个系统的单个工作负载的工作负载更为有用。</p>
               <p><a id="d31544e81" class="indexterm-anchor"></a>通过Consolidated Database Replay，您可以整合从一个或多个系统捕获的多个工作负载，并在单个测试系统上同时重放这些工作负载。在此示例中，使用Consolidated Database Replay将帮助您评估数据库整合将如何影响生产系统，以及单个Oracle Exadata计算机是否可以处理来自统一数据库的组合工作负载。
               </p>
               <p>本章介绍如何使用Consolidated Database Replay并包含以下部分：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="using-consolidated-database-replay.html#GUID-CA75813D-10DB-4635-B127-6747CEC0C6D8" title="通过统一数据库重放，您可以同时重播从一个或多个系统捕获的多个工作负载。">用例进行统一数据库重放</a></p>
                  </li>
                  <li>
                     <p><a href="using-consolidated-database-replay.html#GUID-ED30A383-7236-44C7-9DD0-A9FC4F75F686" title="本节介绍使用Consolidated Workload Replay时涉及的步骤。">使用统一数据库重播的步骤</a></p>
                  </li>
                  <li>
                     <p><a href="using-consolidated-database-replay.html#GUID-BBC96414-F08A-4D57-BA72-B28C1BBEE9F2" title="本节介绍如何将Consolidated Database Replay与Enterprise Manager一起使用。">在企业管理器中使用Consolidated Database Replay</a></p>
                  </li>
                  <li>
                     <p><a href="using-consolidated-database-replay.html#GUID-F3F44EF1-5E8E-4758-BB59-602E7E07CAE5" title="本节介绍如何使用DBMS_WORKLOAD_REPLAY包创建和重播整合的工作负载。">使用Consolidated Database Replay和API</a></p>
                  </li>
                  <li>
                     <p><a href="using-consolidated-database-replay.html#GUID-14A9F425-0888-4CA8-90C4-9E7B476852B8" title="在仅查询数据库重放中，仅重播工作负载捕获的只读查询。换句话说，在仅查询重放中，只有SELECT语句在重放时发送到服务器。在仅查询重放期间不执行DML语句，并且重放不会对用户模式或数据进行任何更改。">关于仅查询数据库重播</a></p>
                  </li>
                  <li>
                     <p><a href="using-consolidated-database-replay.html#GUID-29988B63-F974-46EF-9AAD-3D04AF774337" title="本节假设一个场景，来自三个独立生产系统的工作负载在不同操作系统上运行不同版本的Oracle数据库。">示例：使用API重播Consolidated Workload</a></p>
                  </li>
               </ul>
            </div><a id="RATUG4082"></a><div class="props_rev_3"><a id="GUID-CA75813D-10DB-4635-B127-6747CEC0C6D8" name="GUID-CA75813D-10DB-4635-B127-6747CEC0C6D8"></a><h3 id="RATUG-GUID-CA75813D-10DB-4635-B127-6747CEC0C6D8" class="sect3"><span class="enumeration_section">15.1</span>统一数据库重放的用例</h3>
               <div>
                  <div><span>通过统一数据库重放，您可以同时重播从一个或多个系统捕获的多个工作负载。</span> 在重放期间，合并重播开始时，合并的每个工作负载捕获都将开始重放。
                  </div>
                  <p>整合数据库重放的一些典型用例包括：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="using-consolidated-database-replay.html#GUID-42958859-005D-4B93-9DD3-79807968EA9E" title="统一数据库重放的一个用途是评估系统是否可以处理来自数据库整合的组合工作负载。">使用可插拔数据库进行数据库整合</a></p>
                     </li>
                     <li>
                        <p><a href="using-consolidated-database-replay.html#GUID-A2836514-C2B9-4170-B76F-DA8E4B298C2B" title="Consolidated Database Replay的另一个用途是用于压力测试或容量规划。">压力测试</a></p>
                     </li>
                     <li>
                        <p><a href="using-consolidated-database-replay.html#GUID-0A835930-BD73-4C32-AC02-35D2E21AF725" title="Consolidated Database Replay的第三个用途是用于扩展测试。">放大测试</a></p>
                     </li>
                  </ul>
                  <p>可以使用本章中描述的过程执行这些用例中的每一个。此外，在使用Consolidated Database Replay时，您可以使用各种工作负载扩展技术，如<a href="using-workload-scale-up.html#GUID-6EE876DA-F6E0-435A-8728-CFDA1AFD1FF0" title="本章介绍如何使用各种工作负载扩展技术和Consolidated Database Replay。">使用Workload Scale-Up中所述</a> 。
                  </p>
               </div><a id="RATUG4199"></a><div class="props_rev_3"><a id="GUID-42958859-005D-4B93-9DD3-79807968EA9E" name="GUID-42958859-005D-4B93-9DD3-79807968EA9E"></a><h4 id="RATUG-GUID-42958859-005D-4B93-9DD3-79807968EA9E" class="sect4"><span class="enumeration_section">15.1.1</span>使用可插拔数据库进行数据库整合</h4>
                  <div>
                     <p>统一数据库重放的一个用途是评估系统是否可以处理来自数据库整合的组合工作负载。</p>
                     <p>例如，假设您希望通过将它们迁移到可插拔数据库（PDB）来合并CRM，ERP和SCM应用程序的数据库。您可以使用Consolidated Database Replay组合三个应用程序中捕获的工作负载，并在PDB上同时重放它们。</p>
                     <div class="infoboxnotealso" id="GUID-42958859-005D-4B93-9DD3-79807968EA9E__GUID-3EE5DD0E-B6F9-4E27-BEE9-D37D734EB6B2">
                        <p class="notep1">也可以看看：</p>
                        <p><span class="q">“ <a href="using-consolidated-database-replay.html#GUID-29988B63-F974-46EF-9AAD-3D04AF774337" title="本节假设一个场景，来自三个独立生产系统的工作负载在不同操作系统上运行不同版本的Oracle数据库。">示例：使用API重播Consolidated Workload</a> ”</span>作为此用例的示例</p>
                     </div>
                  </div>
               </div><a id="RATUG4200"></a><div class="props_rev_3"><a id="GUID-A2836514-C2B9-4170-B76F-DA8E4B298C2B" name="GUID-A2836514-C2B9-4170-B76F-DA8E4B298C2B"></a><h4 id="RATUG-GUID-A2836514-C2B9-4170-B76F-DA8E4B298C2B" class="sect4"><span class="enumeration_section">15.1.2</span>压力测试</h4>
                  <div>
                     <p>Consolidated Database Replay的另一个用途是用于压力测试或容量规划。</p>
                     <p>例如，假设您希望Sales应用程序的工作负载在假日期间翻倍。您可以使用Consolidated Database Replay通过将工作负载加倍并重放组合工作负载来测试系统上的额外压力。</p>
                     <div class="infoboxnotealso" id="GUID-A2836514-C2B9-4170-B76F-DA8E4B298C2B__GUID-721FA44F-2680-47A0-ACEF-9EC7267391C2">
                        <p class="notep1">也可以看看：</p>
                        <p><span class="q">“ <a href="using-workload-scale-up.html#GUID-A8D66BDD-5B60-4A0D-81E8-FF88D9F68A49" title="本节介绍如何使用Consolidated Database Replay进行时移，并假设您希望使用时移来协调从三个应用程序捕获的工作负载峰值并同时重放它们。">使用时间转换</a> ”</span>作为此用例的示例</p>
                     </div>
                  </div>
               </div><a id="RATUG4201"></a><div class="props_rev_3"><a id="GUID-0A835930-BD73-4C32-AC02-35D2E21AF725" name="GUID-0A835930-BD73-4C32-AC02-35D2E21AF725"></a><h4 id="RATUG-GUID-0A835930-BD73-4C32-AC02-35D2E21AF725" class="sect4"><span class="enumeration_section">15.1.3放大</span>测试</h4>
                  <div>
                     <p>Consolidated Database Replay的第三个用途是用于扩展测试。</p>
                     <p>例如，假设您要测试您的系统是否可以同时处理Financials应用程序和Orders应用程序中捕获的工作负载。您可以使用Consolidated Database Replay通过组合工作负载并同时重放它们来测试扩展工作负载对系统的影响。</p>
                     <div class="infoboxnotealso" id="GUID-0A835930-BD73-4C32-AC02-35D2E21AF725__GUID-2AABD94E-E630-4F44-BBD1-A817F1CD367F">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="q">“ <a href="using-workload-scale-up.html#GUID-8564F1A9-E002-45DB-B049-6AABB3A88B82" title="本节介绍如何使用Consolidated Database Replay进行模式重新映射，并假设您希望在部署应用程序的多个实例时使用模式重新映射来识别可能的主机瓶颈。">使用架构重映射</a> ”</span></p>
                           </li>
                           <li>
                              <p><span class="q">“ <a href="using-workload-scale-up.html#GUID-756772FF-1F7E-4EB5-AFB5-152CB3DF6704" title="本节介绍如何使用Consolidated Database Replay使用工作负载折叠，并假设您希望使用工作负载折叠将捕获的工作负载增加三倍。该场景演示了如何使用工作负载折叠进行向上扩展测试。">使用工作负载折叠</a> ”</span></p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div>
            </div><a id="RATUG4081"></a><div class="props_rev_3"><a id="GUID-ED30A383-7236-44C7-9DD0-A9FC4F75F686" name="GUID-ED30A383-7236-44C7-9DD0-A9FC4F75F686"></a><h3 id="RATUG-GUID-ED30A383-7236-44C7-9DD0-A9FC4F75F686" class="sect3"><span class="enumeration_section">15.2</span>使用统一数据库重播的步骤</h3>
               <div>
                  <div><span>本节介绍使用Consolidated Workload Replay时涉及的步骤。</span> 它包含以下主题：</div>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="using-consolidated-database-replay.html#GUID-29DEF1D4-AA77-4BF5-938E-52EFC666D47C" title="统一数据库重放不需要任何特殊步骤来捕获数据库工作负载。">捕获数据库工作负载以进行统一数据库重放</a></p>
                     </li>
                     <li>
                        <p><a href="using-consolidated-database-replay.html#GUID-D4B92163-DB56-403B-81B2-B3E91D3EA667" title="为Consolidated Database Replay设置测试系统类似于为数据库重放设置测试系统。">设置统一数据库重放的测试系统</a></p>
                     </li>
                     <li>
                        <p><a href="using-consolidated-database-replay.html#GUID-E8EB57F8-8977-47FA-8FD4-B2C528CE7FE4" title="为Consolidated Database Replay预处理数据库工作负载与为数据库重放预处理数据库工作负载类似。">为综合数据库重放预处理数据库工作负载</a></p>
                     </li>
                     <li>
                        <p><a href="using-consolidated-database-replay.html#GUID-BFC7713A-5BEB-4A2E-9B0F-9F43A983BC6C" title="使用Consolidated Database Replay重播整合的工作负载与使用Database Replay重放单个数据库工作负载完全不同。">重播数据库工作负载以进行统一数据库重放</a></p>
                     </li>
                     <li>
                        <p><a href="using-consolidated-database-replay.html#GUID-D7C55F09-D604-4AD6-8B4A-C8C93D954954" title="使用重播比较期间报告执行统一数据库重放的报告和分析。看到" ="">统一数据库重放的报告和分析</a></p>
                     </li>
                  </ul>
               </div><a id="RATUG4086"></a><div class="props_rev_3"><a id="GUID-29DEF1D4-AA77-4BF5-938E-52EFC666D47C" name="GUID-29DEF1D4-AA77-4BF5-938E-52EFC666D47C"></a><h4 id="RATUG-GUID-29DEF1D4-AA77-4BF5-938E-52EFC666D47C" class="sect4"><span class="enumeration_section">15.2.1</span>捕获数据库工作负载以进行统一数据库重放</h4>
                  <div>
                     <div><span>统一数据库重放不需要任何特殊步骤来捕获数据库工作负载。</span> 捕获数据库工作负载的步骤与捕获数据库重放的单个工作负载完全相同，如<a href="capturing-a-database-workload.html#GUID-E774C161-98C0-43EF-8B78-DD74E2A2A219" title="本章介绍如何在生产系统上捕获数据库工作负载。">捕获数据库工作负载中所述</a> 。
                     </div>
                     <p>本节包含以下有关特定于Consolidated Database Replay的工作负载捕获的主题：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="using-consolidated-database-replay.html#GUID-180A4527-003B-4441-8FE7-524A2206FB54" title="Consolidated Database Replay支持从一个或多个操作系统上运行Oracle Database 9i第2版（版本9.2.0.8.0）或更高版本的一个或多个系统捕获的多个工作负载。">支持的工作负载类型</a></p>
                        </li>
                        <li>
                           <p><a href="using-consolidated-database-replay.html#GUID-C4DC0795-74B2-456D-AA0A-B4F7F45C81F8" title="通过Consolidated Database Replay，您可以将现有工作负载捕获转换为新的较小的捕获子集。">捕获子集</a></p>
                        </li>
                     </ul>
                  </div><a id="RATUG4087"></a><div class="props_rev_3"><a id="GUID-180A4527-003B-4441-8FE7-524A2206FB54" name="GUID-180A4527-003B-4441-8FE7-524A2206FB54"></a><h5 id="RATUG-GUID-180A4527-003B-4441-8FE7-524A2206FB54" class="sect5"><span class="enumeration_section">15.2.1.1</span>支持的工作负载类型</h5>
                     <div>
                        <div><span>Consolidated Database Replay支持从一个或多个操作系统上运行Oracle Database 9 <span class="italic">i</span> Release 2（版本9.2.0.8.0）或更高版本的一个或多个系统捕获的多个工作负载。</span> 例如，您可以在AIX上使用从运行Oracle Database 9 <span class="italic">i</span> Release 2（版本9.2.0.8.0）的一个系统捕获的工作负载，以及在AIX上运行Oracle Database <span class="italic">10g</span>第2版（版本10.2.0.4.0）的另一个系统。</div>
                        <div class="infoboxnote" id="GUID-180A4527-003B-4441-8FE7-524A2206FB54__GUID-3D39C9AB-52AD-4AF2-B52C-4A5131DB8D62">
                           <p class="notep1">注意：</p>
                           <p>统一数据库重放仅适用于Oracle Database <span class="italic">11g</span>第2版（版本11.2.0.2.0）及更高版本。
                           </p>
                        </div>
                     </div>
                  </div><a id="RATUG4088"></a><div class="props_rev_3"><a id="GUID-C4DC0795-74B2-456D-AA0A-B4F7F45C81F8" name="GUID-C4DC0795-74B2-456D-AA0A-B4F7F45C81F8"></a><h5 id="RATUG-GUID-C4DC0795-74B2-456D-AA0A-B4F7F45C81F8" class="sect5"><span class="enumeration_section">15.2.1.2</span>捕获子集</h5>
                     <div>
                        <div><span>通过Consolidated Database Replay，您可以将现有工作负载捕获转换为新的较小的捕获子集。</span> 然后，您可以从可在不同用例中使用的捕获子集生成新的工作负载捕获，如<span class="q">“ <a href="using-consolidated-database-replay.html#GUID-CA75813D-10DB-4635-B127-6747CEC0C6D8" title="通过统一数据库重放，您可以同时重播从一个或多个系统捕获的多个工作负载。">使用整合数据库重放的用例</a> ”中所述</span> 。
                        </div>
                        <p><span class="bold">捕获子集</span>是工作负载捕获的一部分，通过应用时间范围从现有工作负载捕获定义。时间范围指定为从工作负载捕获开始的偏移量。在指定时间范围内捕获的所有用户工作负载都包含在定义的捕获子集中。
                        </p>
                        <p>例如，假设从上午2点到晚上8点捕获工作负载，并确定峰值工作负载从上午10点到下午4点。您可以通过应用从8小时开始的时间范围来定义捕获子集以表示峰值工作负载工作量开始后（或上午10点），并在工作量开始后14小时（或下午4点）结束。</p>
                        <p>但是，如果捕获子集仅包含满足指定时间范围的记录用户工作负载，则不会记录在指定时间范围之前发生的用户登录。如果重放需要这些用户登录，则捕获子集可能无法重播。例如，如果用户会话在上午9:30开始并在上午10:30结束，并且捕获子集的指定时间范围是上午10:00到下午4:00，则如果用户登录为9，则重播可能会失败。 ：工作量不包括上午30点。类似地，指定的时间范围还可以包括仅在用户会话在下午3:30开始但直到下午4:30才完成的部分记录的不完整用户呼叫。</p>
                        <p>Consolidated Database Replay通过仅包含由指定时间范围的开始时间引起的不完整用户调用来解决此问题。如果折叠工作负载捕获，则避免将相同的不完整用户调用包括两次，默认情况下<span class="italic">不</span>包括由结束时间引起的不完整用户调用。因此，捕获子集基本上是在正确重放所需的指定时间范围内记录的用户调用的最小数量，包括必要的用户登录，更改会话语句和由开始时间引起的不完整的用户调用。
                        </p>
                        <div class="infoboxnotealso" id="GUID-C4DC0795-74B2-456D-AA0A-B4F7F45C81F8__GUID-43ACD249-5A94-411D-B55B-5FC6EA5BAB9A">
                           <p class="notep1">也可以看看：</p>
                           <p><span class="q">“ <a href="using-consolidated-database-replay.html#GUID-936472E4-89E9-4FBA-8474-1E3831BFB3CC" title="本节介绍如何使用DBMS_WORKLOAD_REPLAY包从现有工作负载捕获生成捕获子集。">使用API生成捕获子集</a> ”</span></p>
                        </div>
                     </div>
                  </div>
               </div><a id="RATUG4091"></a><a id="RATUG4090"></a><div class="props_rev_3"><a id="GUID-D4B92163-DB56-403B-81B2-B3E91D3EA667" name="GUID-D4B92163-DB56-403B-81B2-B3E91D3EA667"></a><h4 id="RATUG-GUID-D4B92163-DB56-403B-81B2-B3E91D3EA667" class="sect4"><span class="enumeration_section">15.2.2</span>设置统一数据库重播的测试系统</h4>
                  <div>
                     <div><span>为Consolidated Database Replay设置测试系统类似于为数据库重放设置测试系统。</span> 但是，在为Consolidated Database Replay设置重播数据库时还有一些其他注意事项。有关为数据库重放设置测试系统的详细信息，请参阅<span class="q">“ <a href="replaying-a-database-workload.html#GUID-EA0C0608-0B0C-4D2B-B6A4-2B8FFC548F8F" title="正确准备重播系统和规划工作负载重放可确保重放准确。">重播数据库工作负载的步骤</a> ”</span> 。
                     </div>
                     <p>为了最大限度地减少重放过程中的分歧，测试系统应包含相同的应用程序数据，并且应用程序数据的状态在逻辑上应与每个工作负载捕获开始时捕获系统的状态等效。但是，由于合并捕获可能包含来自不同生产系统的多个工作负载捕获，因此需要为所有捕获设置测试系统。在这种情况下，建议使用多租户架构来整合多个数据库，以便每个数据库在捕获开始时具有与其捕获系统等效的数据。</p>
                     <p>对于Consolidated Database Replay，所有参与的工作负载捕获必须放在测试系统上的新捕获目录下。您可以将所有工作负载捕获复制到新的<a id="d31544e1083" class="indexterm-anchor"></a>捕获目录，或创建指向原始工作负载捕获的符号链接。在合并工作负载捕获之前，请确保新的捕获目录具有足够的磁盘空间来存储所有参与的捕获。
                     </p>
                     <p><a href="using-consolidated-database-replay.html#GUID-D4B92163-DB56-403B-81B2-B3E91D3EA667__CHDEFCDA">图15-1</a>说明了如何设置测试系统和新的捕获目录以合并三个工作负载捕获。
                     </p>
                     <div class="figure" id="GUID-D4B92163-DB56-403B-81B2-B3E91D3EA667__CHDEFCDA">
                        <p class="titleinfigure">图15-1设置统一数据库重放的测试系统</p><img src="img/ratug004.png" width="279" alt="下面是图15-1的描述" title="下面是图15-1的描述" longdesc="img_text/ratug004.html"><br><a href="img_text/ratug004.html">“图15-1设置统一数据库重放测试系统”的说明</a></div>
                     <!-- class="figure" -->
                     <div class="infoboxnotealso" id="GUID-D4B92163-DB56-403B-81B2-B3E91D3EA667__GUID-C9AEA61F-FC73-49D6-9614-D130925F9A09">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="q">“ <a href="using-consolidated-database-replay.html#GUID-3A5F701E-6200-45C4-BDFD-D5A4740875DA" title="本节介绍如何使用DBMS_WORKLOAD_REPLAY包在测试系统上设置统一重播目录。">使用API设置合并重播目录</a> ”</span></p>
                           </li>
                           <li>
                              <p>有关多租户架构的信息，请参见<a href="../multi/introduction-to-the-multitenant-architecture.html#CNCPT89234" target="_blank"><span><cite>Oracle数据库概念</cite></span></a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="RATUG4089"></a><div class="props_rev_3"><a id="GUID-E8EB57F8-8977-47FA-8FD4-B2C528CE7FE4" name="GUID-E8EB57F8-8977-47FA-8FD4-B2C528CE7FE4"></a><h4 id="RATUG-GUID-E8EB57F8-8977-47FA-8FD4-B2C528CE7FE4" class="sect4"><span class="enumeration_section">15.2.3</span>为综合数据库重放预处理数据库工作负载</h4>
                  <div>
                     <div><span>为Consolidated Database Replay预处理数据库工作负载与为数据库重放预处理数据库工作负载类似。</span> 有关为数据库重放预处理数据库工作负载的信息，请参阅<span class="q">“ <a href="preprocessing-a-database-workload.html#GUID-4CEE2F79-F5A7-4EBA-9018-0CB99AB51C0A" title="捕获工作负载并完成测试系统的设置后，必须预处理捕获的数据。">预处理数据库工作负载</a> ”</span> 。
                     </div>
                     <p>对于Consolidated Database Replay，将每个捕获的工作负载预处理到其自己的目录中。不要将不同的工作负载捕获组合到一个目录中进行预处理。必须使用运行与将重放工作负载的测试系统相同版本的Oracle数据库的数据库来执行捕获的工作负载的预处理。</p>
                  </div>
               </div><a id="RATUG4092"></a><div class="props_rev_3"><a id="GUID-BFC7713A-5BEB-4A2E-9B0F-9F43A983BC6C" name="GUID-BFC7713A-5BEB-4A2E-9B0F-9F43A983BC6C"></a><h4 id="RATUG-GUID-BFC7713A-5BEB-4A2E-9B0F-9F43A983BC6C" class="sect4"><span class="enumeration_section">15.2.4</span>重播数据库工作负载以进行统一数据库重放</h4>
                  <div>
                     <p>使用Consolidated Database Replay重播整合的工作负载与使用Database Replay重放单个数据库工作负载完全不同。</p>
                     <p>本节包含有关重放特定于Consolidated Database Replay的工作负载的以下主题：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="using-consolidated-database-replay.html#GUID-B1AEA82F-60E5-43CE-BB12-C6D72232886A" title="重播计划将一个或多个工作负载捕获添加到统一重播，并指定捕获在重放期间开始的顺序。">定义重播计划</a></p>
                        </li>
                        <li>
                           <p><a href="using-consolidated-database-replay.html#GUID-A2D6CDAF-A91D-4DA4-ADCE-038595E851A9" title="与使用数据库重放重放单个数据库工作负载的情况一样，用于连接到生产系统的捕获的连接字符串需要重新映射到重放系统。">重新映射统一数据库重播的连接</a></p>
                        </li>
                        <li>
                           <p><a href="using-consolidated-database-replay.html#GUID-48411BB5-E585-4783-B016-72DCD97074CE" title="与使用数据库重放重放单个数据库工作负载的情况一样，可以在重放期间重新映射用于连接到生产系统的数据库用户和模式的用户名。看到" ="">重新映射用户以进行统一数据库重播</a></p>
                        </li>
                        <li>
                           <p><a href="using-consolidated-database-replay.html#GUID-C2F6DA54-9C2C-40CE-B357-F58126C0E2EE" title="与使用数据库重放重放单个数据库工作负载的情况一样，在准备重播期间定义了重播选项。">准备合并数据库重播</a></p>
                        </li>
                        <li>
                           <p><a href="using-consolidated-database-replay.html#GUID-C0629657-BFE2-48AB-8BF6-E1EBBCEB79EE" title="建议在重播统一工作负载之前单独重播每个参与的工作负载。">重播个人工作量</a></p>
                        </li>
                     </ul>
                  </div><a id="RATUG4093"></a><div class="props_rev_3"><a id="GUID-B1AEA82F-60E5-43CE-BB12-C6D72232886A" name="GUID-B1AEA82F-60E5-43CE-BB12-C6D72232886A"></a><h5 id="RATUG-GUID-B1AEA82F-60E5-43CE-BB12-C6D72232886A" class="sect5"><span class="enumeration_section">15.2.4.1</span>定义重播计划</h5>
                     <div>
                        <div><span><span class="bold">重播计划</span>将一个或多个工作负载捕获添加到统一重播，并指定捕获在重放期间开始的顺序。</span> 必须先创建重播计划，然后才能初始化整合重播。可以为整合重播定义多个重播计划。在重放初始化期间，您可以从任何现有的重播计划中进行选择。
                        </div>
                        <p>重播计划执行两种类型的操作：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="using-consolidated-database-replay.html#GUID-816A1006-2A04-4C6C-B046-8C0F26FB7C70" title="重放计划执行的第一种操作是将参与的工作负载捕获添加到重放。">添加工作量捕获</a></p>
                           </li>
                           <li>
                              <p><a href="using-consolidated-database-replay.html#GUID-03A418A1-2FB3-43FE-AC82-C9703C3224EA" title="重播计划执行的第二种操作是添加计划订单，指定参与工作负载捕获在重放期间开始的顺序。">添加计划订单</a></p>
                           </li>
                        </ul>
                        <div class="infoboxnotealso" id="GUID-B1AEA82F-60E5-43CE-BB12-C6D72232886A__GUID-E9D32462-7C44-427F-87D6-1157183438F2">
                           <p class="notep1">也可以看看：</p>
                           <p><span class="q">“ <a href="using-consolidated-database-replay.html#GUID-0C2C161B-76C7-4D14-87A1-2364EF731ECD" title="本节介绍如何使用DBMS_WORKLOAD_REPLAY包定义重播计划。">使用API定义重播计划</a> ”</span></p>
                        </div>
                     </div><a id="RATUG4094"></a><div class="props_rev_3"><a id="GUID-816A1006-2A04-4C6C-B046-8C0F26FB7C70" name="GUID-816A1006-2A04-4C6C-B046-8C0F26FB7C70"></a><h6 id="RATUG-GUID-816A1006-2A04-4C6C-B046-8C0F26FB7C70" class="sect6"><span class="enumeration_section">15.2.4.1.1</span>添加工作量捕获</h6>
                        <div>
                           <p>重放计划执行的第一种操作是将参与的工作负载捕获添加到重放。</p>
                           <p>将工作负载捕获添加到重播计划时，将返回唯一编号以标识工作负载捕获。工作负载捕获可以多次添加到重放计划中，因为每次添加时都会为其分配不同的捕获编号。重放计划每次都指向相同的捕获目录，以避免每次添加捕获时复制捕获所浪费磁盘空间。</p>
                           <div class="infoboxnotealso" id="GUID-816A1006-2A04-4C6C-B046-8C0F26FB7C70__GUID-C33A7BE0-BE78-4C77-BEBC-EB5A511FFA0C">
                              <p class="notep1">也可以看看：</p>
                              <p><span class="q">“ <a href="using-consolidated-database-replay.html#GUID-5D8972FE-DCB0-4CE4-A930-28E211387ECE" title="本节介绍如何使用DBMS_WORKLOAD_REPLAY包向重放计划添加工作负载捕获和删除工作负载捕获。">使用API添加工作负载捕获重播计划</a> ”</span></p>
                           </div>
                        </div>
                     </div><a id="RATUG4095"></a><div class="props_rev_3"><a id="GUID-03A418A1-2FB3-43FE-AC82-C9703C3224EA" name="GUID-03A418A1-2FB3-43FE-AC82-C9703C3224EA"></a><h6 id="RATUG-GUID-03A418A1-2FB3-43FE-AC82-C9703C3224EA" class="sect6"><span class="enumeration_section">15.2.4.1.2</span>添加计划订单</h6>
                        <div>
                           <p>重播计划执行的第二种操作是添加计划订单，指定参与工作负载捕获在重放期间开始的顺序。</p>
                           <p>一个<a id="d31544e1621" class="indexterm-anchor"></a> <span class="bold">计划顺序</span>定义已添加到重放计划的两个工作负荷捕获的开始之间的顺序。可以将多个计划订单添加到重播计划中。例如，假设重播计划添加了三个工作负载捕获。可以添加一个计划订单，以指定Capture 2必须等待Capture 1在启动之前完成。可以添加另一个计划订单，以指定Capture 3必须等待Capture 1在启动之前完成。在这种情况下，Capture 2和Capture 3必须等待Capture 1完成才能启动。
                           </p>
                           <p>重播计划可能不包含任何计划订单。在这种情况下，重播计划中的所有参与工作负载捕获将在整合重播开始时同时开始重播。</p>
                           <div class="infoboxnotealso" id="GUID-03A418A1-2FB3-43FE-AC82-C9703C3224EA__GUID-1379BFFF-3832-4AEF-A41E-DAC7254ECDA5">
                              <p class="notep1">也可以看看：</p>
                              <p><span class="q">“ <a href="using-consolidated-database-replay.html#GUID-CB0EBAEF-AE24-4EFA-A3F1-27C2479B3A73" title="本节介绍如何使用DBMS_WORKLOAD_REPLAY包向重播计划添加计划订单和删除计划订单。">添加计划订单以使用API重播计划</a> ”</span></p>
                           </div>
                        </div>
                     </div>
                  </div><a id="RATUG4096"></a><div class="props_rev_3"><a id="GUID-A2D6CDAF-A91D-4DA4-ADCE-038595E851A9" name="GUID-A2D6CDAF-A91D-4DA4-ADCE-038595E851A9"></a><h5 id="RATUG-GUID-A2D6CDAF-A91D-4DA4-ADCE-038595E851A9" class="sect5"><span class="enumeration_section">15.2.4.2</span>重新映射统一数据库重播的连接</h5>
                     <div>
                        <div><span>与使用数据库重放重放单个数据库工作负载的情况一样，用于连接到生产系统的捕获的连接字符串需要重新映射到重放系统。</span> 有关详细信息，请参阅<span class="q">“ <a href="replaying-a-database-workload.html#GUID-823FEDBB-B93B-47DF-AE72-FBD3832DFD9B" title="在工作负载捕获期间，将捕获用于连接到生产系统的连接字符串。为了使重放成功，您需要将这些连接字符串重新映射到重放系统。然后，重播客户端可以使用重新映射的连接连接到重放系统。">连接重新映射</a> ”</span> 。
                        </div>
                        <p>对于<a id="d31544e1731" class="indexterm-anchor"></a>统一数据库重放，您需要在重放期间将捕获的连接字符串从多个工作负载捕获重新映射到不同的连接字符串。
                        </p>
                        <div class="infoboxnotealso" id="GUID-A2D6CDAF-A91D-4DA4-ADCE-038595E851A9__GUID-8E052D59-1915-4BA9-B3EA-CD59DC22C6AE">
                           <p class="notep1">也可以看看：</p>
                           <p><span class="q">“ <a href="using-consolidated-database-replay.html#GUID-284D7908-40EE-4570-AE78-E75AAA294327" title="本节介绍如何使用DBMS_WORKLOAD_REPLAY包重新映射整合重播的连接字符串。">使用API重新映射连接</a> ”</span></p>
                        </div>
                     </div>
                  </div><a id="RATUG4097"></a><div class="props_rev_3"><a id="GUID-48411BB5-E585-4783-B016-72DCD97074CE" name="GUID-48411BB5-E585-4783-B016-72DCD97074CE"></a><h5 id="RATUG-GUID-48411BB5-E585-4783-B016-72DCD97074CE" class="sect5"><span class="enumeration_section">15.2.4.3</span>重新映射用户以进行统一数据库重播</h5>
                     <div>
                        <div><span>与使用数据库重放重放单个数据库工作负载的情况一样，可以在重放期间重新映射用于连接到生产系统的数据库用户和模式的用户名。有关详细信息，请参阅<span class="q">“ <a href="replaying-a-database-workload.html#GUID-A00C24B9-28C9-46E4-839F-A0ABDA6C4C24" title="在工作负载捕获期间，将捕获用于连接到生产系统的数据库用户或模式的用户名。您可以选择将捕获的用户名重新映射到新用户或架构的用户名。">用户重新映射</a> ”</span> 。</span></div>
                        <p>对于<a id="d31544e1835" class="indexterm-anchor"></a>通过统一数据库重放，您可以选择在重放期间将捕获的用户从多个工作负载捕获重新映射到不同的用户或模式。
                        </p>
                        <div class="infoboxnotealso" id="GUID-48411BB5-E585-4783-B016-72DCD97074CE__GUID-18CC0161-29E8-42BB-AC28-D211140E85C5">
                           <p class="notep1">也可以看看：</p>
                           <p><span class="q">“ <a href="using-consolidated-database-replay.html#GUID-12BFB1A9-B0C6-4AE9-9E1B-F7237FAED915" title="本节介绍如何使用DBMS_WORKLOAD_REPLAY包重新映射用户以进行整合重播。">使用API重新映射用户</a> ”</span></p>
                        </div>
                     </div>
                  </div><a id="RATUG4098"></a><div class="props_rev_3"><a id="GUID-C2F6DA54-9C2C-40CE-B357-F58126C0E2EE" name="GUID-C2F6DA54-9C2C-40CE-B357-F58126C0E2EE"></a><h5 id="RATUG-GUID-C2F6DA54-9C2C-40CE-B357-F58126C0E2EE" class="sect5"><span class="enumeration_section">15.2.4.4</span>准备合并数据库重播</h5>
                     <div>
                        <div><span>与使用数据库重放重放单个数据库工作负载的情况一样，在准备重播期间定义了重播选项。</span> 有关详细信息，请参阅<span class="q">“ <a href="replaying-a-database-workload.html#GUID-289F573A-9C83-4A29-A1D4-323705E8293D" title="还原数据库并重新映射连接和用户后，您可以设置相应的重播选项。">指定重播选项</a> ”</span> 。
                        </div>
                        <p>对于<a id="d31544e1940" class="indexterm-anchor"></a>统一数据库重放，整合重播中的所有参与工作负载捕获在重放准备期间定义的重放期间使用相同的重播选项。
                        </p>
                        <div class="infoboxnotealso" id="GUID-C2F6DA54-9C2C-40CE-B357-F58126C0E2EE__GUID-3C4FAAE0-B74D-44BA-B8EF-C951BC4E3869">
                           <p class="notep1">也可以看看：</p>
                           <p><span class="q">“ <a href="using-consolidated-database-replay.html#GUID-84EE2D27-04A8-4C78-8C08-4A5FF4472B68" title="本节介绍如何使用DBMS_WORKLOAD_REPLAY包准备整合重播。">准备使用API进行统一数据库重放</a> ”</span></p>
                        </div>
                     </div>
                  </div><a id="RATUG4099"></a><div class="props_rev_3"><a id="GUID-C0629657-BFE2-48AB-8BF6-E1EBBCEB79EE" name="GUID-C0629657-BFE2-48AB-8BF6-E1EBBCEB79EE"></a><h5 id="RATUG-GUID-C0629657-BFE2-48AB-8BF6-E1EBBCEB79EE" class="sect5"><span class="enumeration_section">15.2.4.5</span>重播单个工作负载</h5>
                     <div>
                        <div><span>建议在重播统一工作负载之前单独重播每个参与的工作负载。</span> 有关详细信息，请参阅<span class="q">“ <a href="replaying-a-database-workload.html#GUID-1F638D8F-7168-492D-BAD6-39F4F36EAD9B" title="在对捕获的工作负载进行预处理后，可以在运行相同版本的Oracle数据库的重放系统上重复执行该工作负载。">重播数据库工作负载</a> ”</span> 。
                        </div>
                        <p>单个重放可以为每个工作负载捕获建立基准性能，并用于分析整合重放的性能。</p>
                     </div>
                  </div>
               </div><a id="RATUG4202"></a><a id="RATUG4100"></a><div class="props_rev_3"><a id="GUID-D7C55F09-D604-4AD6-8B4A-C8C93D954954" name="GUID-D7C55F09-D604-4AD6-8B4A-C8C93D954954"></a><h4 id="RATUG-GUID-D7C55F09-D604-4AD6-8B4A-C8C93D954954" class="sect4"><span class="enumeration_section">15.2.5</span>统一数据库重放的报告和分析</h4>
                  <div>
                     <div><span>使用重播比较期间报告执行统一数据库重放的报告和分析。有关详细信息，请参阅<span class="q">“ <a href="analyzing-captured-and-replayed-workloads.html#GUID-A4EEC94D-ACA1-4B1C-937E-51BBA20CF91D" title="重播比较期间报告可用于多种目的。">使用重播比较期间报告</a> ”</span> 。</span></div>
                     <p>统一数据库重放的重播比较期间报告标识每个单独工作负载捕获的活动会话历史记录（ASH）数据，并将来自工作负载捕获的ASH数据与来自整合重放的过滤ASH数据进行比较。使用此报告来比较相同整合工作负载捕获的重放。</p>
                     <p>统一数据库重放的重播比较期间报告将整合重播视为多次捕获与重放比较。报告的摘要部分包含一个表格，该表格总结了所有Capture捕获与重放比较。查看本节中的信息，以全面了解整合重播的运行方式。</p>
                     <p><a href="using-consolidated-database-replay.html#GUID-D7C55F09-D604-4AD6-8B4A-C8C93D954954__CHDCBGFE">图15-2</a>显示了Consolidated Database Replay的重播比较期间报告的摘要部分。
                     </p>
                     <div class="figure" id="GUID-D7C55F09-D604-4AD6-8B4A-C8C93D954954__CHDCBGFE">
                        <p class="titleinfigure">图15-2比较期间报告：合并重播</p><img src="img/dbr_rep_cons_replay.gif" width="505" alt="下面是图15-2的描述" title="下面是图15-2的描述" longdesc="img_text/dbr_rep_cons_replay.html"><br><a href="img_text/dbr_rep_cons_replay.html">“图15-2比较期间报告：合并重播”的说明</a></div>
                     <!-- class="figure" -->
                     <p>报告中的其余部分类似于重播比较期间报告的ASH数据比较部分，并通过在整合重播中加入所有Capture与重播报告而形成。有关本节的说明，请参阅<span class="q">“ <a href="analyzing-captured-and-replayed-workloads.html#GUID-1741E117-65B1-4DEE-8E3E-314BD09AA4C8" title="本节比较两次运行中的ASH数据。">ASH数据比较</a> ”</span> 。
                     </p>
                  </div>
               </div>
            </div><a id="RATUG4137"></a><div class="props_rev_3"><a id="GUID-BBC96414-F08A-4D57-BA72-B28C1BBEE9F2" name="GUID-BBC96414-F08A-4D57-BA72-B28C1BBEE9F2"></a><h3 id="RATUG-GUID-BBC96414-F08A-4D57-BA72-B28C1BBEE9F2" class="sect3"><span class="enumeration_section">15.3</span>在企业管理器中使用Consolidated Database Replay</h3>
               <div>
                  <p>本节介绍如何将Consolidated Database Replay与Enterprise Manager一起使用。</p>
                  <p>重放统一数据库工作负载的主要工具是Oracle Enterprise Manager。如果Oracle Enterprise Manager不可用，您还可以使用API重播统一数据库工作负载，如<span class="q">“ <a href="using-consolidated-database-replay.html#GUID-F3F44EF1-5E8E-4758-BB59-602E7E07CAE5" title="This section describes how to create and replay consolidated workloads using the DBMS_WORKLOAD_REPLAY package.">使用</a></span> API中的<span class="q"><a href="using-consolidated-database-replay.html#GUID-F3F44EF1-5E8E-4758-BB59-602E7E07CAE5" title="本节介绍如何使用DBMS_WORKLOAD_REPLAY包创建和重播整合的工作负载。">使用统一数据库重放</a> ”中所述</span> 。
                  </p>
                  <p>重放统一数据库工作负载的过程几乎与重放单个数据库工作负载的过程相同。以下各节中的单次重放过程中记录了这些差异：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="preprocessing-a-database-workload.html#GUID-4CEE2F79-F5A7-4EBA-9018-0CB99AB51C0A" title="捕获工作负载并完成测试系统的设置后，必须预处理捕获的数据。">预处理数据库工作负载中的</a> <span class="q">“ <a href="preprocessing-a-database-workload.html#GUID-8012B6B9-4571-4802-9B87-CC44B3E51DF0" title="在创建数据库重播任务之前，请确保要重播的捕获具有一些捕获的用户调用。">创建数据库重放任务</a> ”</span></p>
                     </li>
                     <li>
                        <p><span class="q"><a href="preprocessing-a-database-workload.html#GUID-6C328D8F-9451-4733-AB51-595BE096DAC9" title="The final preparation for the replay involves preprocessing the workload and deploying the replay clients.">预处理</a></span> <a href="preprocessing-a-database-workload.html#GUID-4CEE2F79-F5A7-4EBA-9018-0CB99AB51C0A" title="捕获工作负载并完成测试系统的设置后，必须预处理捕获的数据。">数据库工作负载中的</a> <span class="q">“ <a href="preprocessing-a-database-workload.html#GUID-6C328D8F-9451-4733-AB51-595BE096DAC9" title="重播的最后准备工作包括预处理工作负载和部署重播客户端。">预处理工作负载和部署重放客户端</a> ”</span></p>
                     </li>
                     <li>
                        <p><span class="q">“ <a href="replaying-a-database-workload.html#GUID-B97B7550-A947-45D0-A31B-636A6427DD86" title="This section describes how to replay a database workload using Enterprise Manager.">重播数据库工作负载</a> ”</span>中的<span class="q">“ <a href="replaying-a-database-workload.html#GUID-B97B7550-A947-45D0-A31B-636A6427DD86" title="本节介绍如何使用Enterprise Manager重播数据库工作负载。">使用Enterprise Manager</a></span> <a href="replaying-a-database-workload.html#GUID-1F638D8F-7168-492D-BAD6-39F4F36EAD9B" title="在对捕获的工作负载进行预处理后，可以在运行相同版本的Oracle数据库的重放系统上重复执行该工作负载。">重播数据库工作负载”</a></p>
                     </li>
                  </ul>
                  <p>以下列表概述了重放统一数据库工作负载与重放单个数据库工作负载之间的差异：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>创建重播任务时，需要从“创建任务”页面的“选择捕获”表中选择两个或多个捕获的工作负载。</p>
                     </li>
                     <li>
                        <p>“预处理捕获的工作负载：向导的复制工作负载”步骤对“捕获名称”下拉列表有多个选项，因此您可能需要为工作负载目录的当前位置输入多个凭据。</p>
                     </li>
                     <li>
                        <p>预处理捕获的工作负载：向导的“选择目录”步骤不会像单次重放那样显示“捕获摘要”。</p>
                     </li>
                     <li>
                        <p>向导的“重播工作负载：复制工作负载”步骤对“捕获名称”下拉列表有多个选项，因此您可能需要为工作负载目录的当前位置输入多个凭据。</p>
                     </li>
                     <li>
                        <p>重播工作负载：向导的“选择目录”步骤不会像单次重播那样显示“捕获摘要”。</p>
                     </li>
                     <li>
                        <p>向导的“重播工作负载：初始化选项”步骤不显示“标识源”部分。</p>
                     </li>
                     <li>
                        <p>“重播工作负载：自定义选项”步骤在“连接映射”选项卡中为“捕获名称”下拉列表提供了多个选项，因此您可以重新映射每个捕获的工作负载的连接。使用单个连接描述符或网络服务名称的选项不可用。</p>
                     </li>
                  </ul>
               </div>
            </div><a id="RATUG4102"></a><div class="props_rev_3"><a id="GUID-F3F44EF1-5E8E-4758-BB59-602E7E07CAE5" name="GUID-F3F44EF1-5E8E-4758-BB59-602E7E07CAE5"></a><h3 id="RATUG-GUID-F3F44EF1-5E8E-4758-BB59-602E7E07CAE5" class="sect3"><span class="enumeration_section">15.4</span>使用API进行统一数据库重放</h3>
               <div>
                  <div><span>本节介绍如何使用<code class="codeph">DBMS_WORKLOAD_REPLAY</code>包创建和重播整合的工作负载。</span> 您还可以使用Oracle Enterprise Manager创建和重播整合的工作负载，如<span class="q">“ <a href="using-consolidated-database-replay.html#GUID-BBC96414-F08A-4D57-BA72-B28C1BBEE9F2" title="本节介绍如何将Consolidated Database Replay与Enterprise Manager一起使用。">使用Consolidated Database Replay with Enterprise Manager</a> ”中所述</span> 。
                  </div>
                  <p>使用API创建和重放整合工作负载是一个包含以下步骤的多步骤过程：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="using-consolidated-database-replay.html#GUID-936472E4-89E9-4FBA-8474-1E3831BFB3CC" title="本节介绍如何使用DBMS_WORKLOAD_REPLAY包从现有工作负载捕获生成捕获子集。">使用API生成捕获子集</a></p>
                     </li>
                     <li>
                        <p><a href="using-consolidated-database-replay.html#GUID-3A5F701E-6200-45C4-BDFD-D5A4740875DA" title="本节介绍如何使用DBMS_WORKLOAD_REPLAY包在测试系统上设置统一重播目录。">使用API设置合并重播目录</a></p>
                     </li>
                     <li>
                        <p><a href="using-consolidated-database-replay.html#GUID-0C2C161B-76C7-4D14-87A1-2364EF731ECD" title="本节介绍如何使用DBMS_WORKLOAD_REPLAY包定义重播计划。">使用API定义重播计划</a></p>
                     </li>
                     <li>
                        <p><a href="using-consolidated-database-replay.html#GUID-10610AAB-EB5C-441C-A1E3-64DEDEC6B45F" title="本节介绍如何使用DBMS_WORKLOAD_REPLAY包运行Consolidated Database Replay。">使用API运行Consolidated Database Replay</a></p>
                     </li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-F3F44EF1-5E8E-4758-BB59-602E7E07CAE5__GUID-582B0AC9-B098-4AB4-9317-D73A941DD678">
                     <p class="notep1">也可以看看：</p>
                     <p>有关<code class="codeph">DBMS_WORKLOAD_REPLAY</code>包的信息，请<code class="codeph">DBMS_WORKLOAD_REPLAY</code> <a href="../arpls/DBMS_WORKLOAD_REPLAY.html#ARPLS208" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                  </div>
               </div><a id="RATUG4104"></a><a id="RATUG4103"></a><div class="props_rev_3"><a id="GUID-936472E4-89E9-4FBA-8474-1E3831BFB3CC" name="GUID-936472E4-89E9-4FBA-8474-1E3831BFB3CC"></a><h4 id="RATUG-GUID-936472E4-89E9-4FBA-8474-1E3831BFB3CC" class="sect4"><span class="enumeration_section">15.4.1</span>使用API生成捕获子集</h4>
                  <div>
                     <div><span>本节介绍如何使用<code class="codeph">DBMS_WORKLOAD_REPLAY</code>包从现有工作负载捕获生成捕获子集。</span> 有关捕获子集的信息，请参阅<span class="q">“ <a href="using-consolidated-database-replay.html#GUID-C4DC0795-74B2-456D-AA0A-B4F7F45C81F8" title="通过Consolidated Database Replay，您可以将现有工作负载捕获转换为新的较小的捕获子集。">捕获子集</a> ”</span> 。
                     </div>
                     <div class="section">
                        <p class="subhead3" id="GUID-936472E4-89E9-4FBA-8474-1E3831BFB3CC__GUID-A33C5A55-01CF-4624-BEDB-A4161822E486">从现有工作负载捕获生成捕获子集：</p>
                        <ol>
                           <li>
                              <p>使用<a id="d31544e2574" class="indexterm-anchor"></a> <code class="codeph">GENERATE_CAPTURE_SUBSET</code>程序：</p><pre class="oac_no_warn" dir="ltr">DBMS_WORKLOAD_REPLAY.GENERATE_CAPTURE_SUBSET（input_capture_dir IN VARCHAR2，output_capture_dir IN VARCHAR2，new_capture_name IN VARCHAR2，begin_time IN NUMBER，begin_include_incomplete IN BOOLEAN DEFAULT TRUE，end_time IN NUMBER，end_include_incomplete IN BOOLEAN DEFAULT FALSE，parallel_level IN NUMBER DEFAULT NULL）;</pre></li>
                           <li>
                              <p>将<code class="codeph">input_capture_dir</code>参数设置为指向现有工作负载捕获的目录对象的名称。
                              </p>
                           </li>
                           <li>
                              <p>将<code class="codeph">output_capture_dir</code>参数设置为目录对象的名称，该目录对象指向将存储新工作负载捕获的空目录。
                              </p>
                           </li>
                           <li>
                              <p>将<code class="codeph">new_capture_name</code>参数设置为要生成的新工作负载捕获的名称。
                              </p>
                           </li>
                           <li>
                              <p>根据需要设置其他参数，这些参数是可选的。</p>
                              <p>有关这些参数的信息，请参阅<a href="../arpls/DBMS_WORKLOAD_REPLAY.html#ARPLS73989" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a> 。
                              </p>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>此示例显示如何从目录对象<code class="codeph">peak_capdir</code>的现有工作负载捕获在目录对象<code class="codeph">rec_dir</code>处创建名为<code class="codeph">peak_wkld</code>的捕获子集。捕获子集包括工作负载捕获开始后2小时（或7,200秒）到工作负载捕获开始后3小时（或10,800秒）的工作负载。
                        </p><pre class="oac_no_warn" dir="ltr">EXEC DBMS_WORKLOAD_REPLAY.GENERATE_CAPTURE_SUBSET（'rec_dir'，'peak_capdir'，'peak_wkld'，7200，TRUE，10800，FALSE，1）;</pre><div class="infoboxnotealso" id="GUID-936472E4-89E9-4FBA-8474-1E3831BFB3CC__GUID-92C841A0-762E-470B-A2FD-4244B1C407CF">
                           <p class="notep1">也可以看看：</p>
                           <p>有关<code class="codeph">GENERATE_CAPTURE_SUBSET</code>过程的信息<a href="../arpls/DBMS_WORKLOAD_REPLAY.html#ARPLS73988" target="_blank"><span><cite>，请参见Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="RATUG4106"></a><a id="RATUG4105"></a><div class="props_rev_3"><a id="GUID-3A5F701E-6200-45C4-BDFD-D5A4740875DA" name="GUID-3A5F701E-6200-45C4-BDFD-D5A4740875DA"></a><h4 id="RATUG-GUID-3A5F701E-6200-45C4-BDFD-D5A4740875DA" class="sect4"><span class="enumeration_section">15.4.2</span>使用API设置合并重播目录</h4>
                  <div>
                     <div><span>本节介绍如何使用<code class="codeph">DBMS_WORKLOAD_REPLAY</code>包在测试系统上设置统一重播目录。</span> 将整合的重播目录设置为测试系统上的目录，该目录包含要合并和重放的工作负载捕获。有关设置测试系统的信息，请参阅<span class="q">“ <a href="using-consolidated-database-replay.html#GUID-D4B92163-DB56-403B-81B2-B3E91D3EA667" title="为Consolidated Database Replay设置测试系统类似于为数据库重放设置测试系统。">为统一数据库重放设置测试系统</a> ”</span> 。
                     </div>
                     <div class="section">
                        <p class="subhead3" id="GUID-3A5F701E-6200-45C4-BDFD-D5A4740875DA__GUID-08AA053F-1F61-4480-91C6-54DC27CD74D5">要设置重播目录：</p>
                        <ol>
                           <li>
                              <p>使用<a id="d31544e2744" class="indexterm-anchor"></a> <code class="codeph">SET_CONSOLIDATED_DIRECTORY</code>程序：</p><pre class="oac_no_warn" dir="ltr">DBMS_WORKLOAD_REPLAY.SET_CONSOLIDATED_DIRECTORY（replay_dir IN VARCHAR2）;</pre></li>
                           <li>
                              <p>将<code class="codeph">replay_dir</code>参数设置为目录对象的名称，该目录对象指向包含要用于工作负载整合的工作负载捕获的操作系统目录。
                              </p>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <div class="infobox-tip" id="GUID-3A5F701E-6200-45C4-BDFD-D5A4740875DA__GUID-115AB160-02CF-4480-867C-003560AADEFF">
                           <p class="notep1">小费：</p>
                           <p>不推荐使用<code class="codeph">SET_REPLAY_DIRECTORY</code>过程，并将其替换为<code class="codeph">SET_CONSOLIDATED_DIRECTORY</code>过程。
                           </p>
                        </div>
                        <p>此示例显示如何将replay目录设置为名为<code class="codeph">rep_dir</code>的目录对象。
                        </p><pre class="oac_no_warn" dir="ltr">EXEC DBMS_WORKLOAD_REPLAY.SET_CONSOLIDATED_DIRECTORY（'rep_dir'）;</pre><p>您还可以使用<code class="codeph">DBMS_WORKLOAD_REPLAY</code>包来查看由<code class="codeph">SET_CONSOLIDATED_DIRECTORY</code>过程设置的当前整合重播目录。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-3A5F701E-6200-45C4-BDFD-D5A4740875DA__GUID-555DD23B-9C2A-4F48-8F75-02E46F4BAC1D">要查看已设置的当前整合重播目录：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>使用<a id="d31544e2792" class="indexterm-anchor"></a> <code class="codeph">GET_REPLAY_DIRECTORY</code>函数：</p><pre class="oac_no_warn" dir="ltr">DBMS_WORKLOAD_REPLAY.GET_REPLAY_DIRECTORY RETURN VARCHAR2;</pre><p>如果未设置整合的重播目录，则该函数返回<code class="codeph">NULL</code> 。</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-3A5F701E-6200-45C4-BDFD-D5A4740875DA__GUID-D44D28BA-6804-4D88-A07D-A40A8FDB3CA8">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>有关<code class="codeph">SET_REPLAY_DIRECTORY</code>过程的信息，请<code class="codeph">SET_REPLAY_DIRECTORY</code> <a href="../arpls/DBMS_WORKLOAD_REPLAY.html#ARPLS73107" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                              </li>
                              <li>
                                 <p>有关<code class="codeph">GET_REPLAY_DIRECTORY</code>函数的信息，请<code class="codeph">GET_REPLAY_DIRECTORY</code> <a href="../arpls/DBMS_WORKLOAD_REPLAY.html#ARPLS73993" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="RATUG4107"></a><div class="props_rev_3"><a id="GUID-0C2C161B-76C7-4D14-87A1-2364EF731ECD" name="GUID-0C2C161B-76C7-4D14-87A1-2364EF731ECD"></a><h4 id="RATUG-GUID-0C2C161B-76C7-4D14-87A1-2364EF731ECD" class="sect4"><span class="enumeration_section">15.4.3</span>使用API定义重播计划</h4>
                  <div>
                     <div><span>本节介绍如何使用<code class="codeph">DBMS_WORKLOAD_REPLAY</code>包定义重播计划。</span> 有关重播计划的信息，请参阅<span class="q">“ <a href="using-consolidated-database-replay.html#GUID-B1AEA82F-60E5-43CE-BB12-C6D72232886A" title="重播计划将一个或多个工作负载捕获添加到统一重播，并指定捕获在重放期间开始的顺序。">定义重播计划</a> ”</span> 。
                     </div>
                     <div class="p">
                        <p>在定义重播计划之前，请确保满足以下先决条件：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>在运行与重放系统相同的数据库版本的系统上，使用<code class="codeph">PROCESS_CAPTURE</code>过程对所有工作负载捕获进行预处理，如<a href="preprocessing-a-database-workload.html#GUID-4CEE2F79-F5A7-4EBA-9018-0CB99AB51C0A" title="捕获工作负载并完成测试系统的设置后，必须预处理捕获的数据。">预处理数据库工作负载中所述</a> 。
                              </p>
                           </li>
                           <li>
                              <p>所有捕获目录都将复制到重放系统上的重播目录中</p>
                           </li>
                           <li>
                              <p>使用<code class="codeph">SET_REPLAY_DIRECTORY</code>过程设置重播目录，如<span class="q">“ <a href="using-consolidated-database-replay.html#GUID-3A5F701E-6200-45C4-BDFD-D5A4740875DA" title="本节介绍如何使用DBMS_WORKLOAD_REPLAY包在测试系统上设置统一重播目录。">使用API设置合并重播目录</a> ”中所述</span> 。
                              </p>
                           </li>
                           <li>
                              <p>数据库状态不在重播模式</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-0C2C161B-76C7-4D14-87A1-2364EF731ECD__GUID-A9FEED3A-A934-4E0A-BDCF-1A66BA473135">要定义重播计划：</p>
                        <ol>
                           <li>
                              <p>创建新的重播计划，如<span class="q">“ <a href="using-consolidated-database-replay.html#GUID-CC592BD9-1FBE-46BA-88DD-ABB191C93EAB" title="本节介绍如何使用DBMS_WORKLOAD_REPLAY包创建重播计划。">使用API创建重播计划</a> ”中所述</span> 。
                              </p>
                           </li>
                           <li>
                              <p>将工作负载捕获添加到重播计划中，如<span class="q">“ <a href="using-consolidated-database-replay.html#GUID-5D8972FE-DCB0-4CE4-A930-28E211387ECE" title="本节介绍如何使用DBMS_WORKLOAD_REPLAY包向重放计划添加工作负载捕获和删除工作负载捕获。">使用API添加工作负载以重播计划</a> ”中所述</span> 。
                              </p>
                           </li>
                           <li>
                              <p>将计划订单添加到重播计划，如<span class="q">“ <a href="using-consolidated-database-replay.html#GUID-CB0EBAEF-AE24-4EFA-A3F1-27C2479B3A73" title="This section describes how to add schedule orders to and remove schedule orders from replay schedules using the DBMS_WORKLOAD_REPLAY package.">使用API</a></span>重新计划计划<span class="q"><a href="using-consolidated-database-replay.html#GUID-CB0EBAEF-AE24-4EFA-A3F1-27C2479B3A73" title="本节介绍如何使用DBMS_WORKLOAD_REPLAY包向重播计划添加计划订单和删除计划订单。">添加计划订单</a> ”中所述</span> 。
                              </p>
                           </li>
                           <li>
                              <p>保存重播计划，如<span class="q">“ <a href="using-consolidated-database-replay.html#GUID-40B753EE-A8E0-4C58-AF63-70B23FBF73A6" title="本节介绍如何保存使用DBMS_WORKLOAD_REPLAY包定义的重播计划。">使用API保存重播计划</a> ”中所述</span> 。
                              </p>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div><a id="RATUG4109"></a><a id="RATUG4108"></a><div class="props_rev_3"><a id="GUID-CC592BD9-1FBE-46BA-88DD-ABB191C93EAB" name="GUID-CC592BD9-1FBE-46BA-88DD-ABB191C93EAB"></a><h5 id="RATUG-GUID-CC592BD9-1FBE-46BA-88DD-ABB191C93EAB" class="sect5"><span class="enumeration_section">15.4.3.1</span>使用API创建重播计划</h5>
                     <div>
                        <div><span>本节介绍如何使用<code class="codeph">DBMS_WORKLOAD_REPLAY</code>包创建重播计划。</span> 有关重播计划的信息，请参阅<span class="q">“ <a href="using-consolidated-database-replay.html#GUID-B1AEA82F-60E5-43CE-BB12-C6D72232886A" title="重播计划将一个或多个工作负载捕获添加到统一重播，并指定捕获在重放期间开始的顺序。">定义重播计划</a> ”</span> 。
                        </div>
                        <div class="section">
                           <p class="subhead3" id="GUID-CC592BD9-1FBE-46BA-88DD-ABB191C93EAB__GUID-A5058A68-E1F9-407F-A94D-09ADD270A720">要创建重播计划：</p>
                           <ol>
                              <li>
                                 <p>使用<a id="d31544e3132" class="indexterm-anchor"></a> <code class="codeph">BEGIN_REPLAY_SCHEDULE</code>程序：</p><pre class="oac_no_warn" dir="ltr">DBMS_WORKLOAD_REPLAY.BEGIN_REPLAY_SCHEDULE（schedule_name IN VARCHAR2）;</pre></li>
                              <li>
                                 <p>将<code class="codeph">schedule_name</code>参数设置为此重播计划的名称。
                                 </p>
                              </li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <div class="infoboxnote" id="GUID-CC592BD9-1FBE-46BA-88DD-ABB191C93EAB__GUID-05D8F5D8-67E1-4BBC-A2E2-59797D522AE0">
                              <p class="notep1">注意：</p>
                              <p><code class="codeph">BEGIN_REPLAY_SCHEDULE</code>过程启动创建可重用的重播计划。一次只能定义一个重播计划。在定义重播计划时再次调用此过程将导致错误。
                              </p>
                           </div>
                           <p>此示例显示如何创建名为<code class="codeph">peak_schedule</code>的重播计划。
                           </p><pre class="oac_no_warn" dir="ltr">EXEC DBMS_WORKLOAD_REPLAY.BEGIN_REPLAY_SCHEDULE（'peak_schedule'）;</pre><div class="infoboxnotealso" id="GUID-CC592BD9-1FBE-46BA-88DD-ABB191C93EAB__GUID-47E10147-6E85-4499-A23C-A83CAAB4188D">
                              <p class="notep1">也可以看看：</p>
                              <p>有关<code class="codeph">BEGIN_REPLAY_SCHEDULE</code>过程的信息，请<code class="codeph">BEGIN_REPLAY_SCHEDULE</code> <a href="../arpls/DBMS_WORKLOAD_REPLAY.html#ARPLS73985" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="RATUG4111"></a><a id="RATUG4110"></a><div class="props_rev_3"><a id="GUID-5D8972FE-DCB0-4CE4-A930-28E211387ECE" name="GUID-5D8972FE-DCB0-4CE4-A930-28E211387ECE"></a><h5 id="RATUG-GUID-5D8972FE-DCB0-4CE4-A930-28E211387ECE" class="sect5"><span class="enumeration_section">15.4.3.2</span>使用API添加工作负载以重播计划</h5>
                     <div>
                        <div><span>本节介绍如何使用<code class="codeph">DBMS_WORKLOAD_REPLAY</code>包向重放计划添加工作负载捕获和删除工作负载捕获。</span> 有关将工作负载捕获添加到重放计划的信息，请参阅<span class="q">“ <a href="using-consolidated-database-replay.html#GUID-816A1006-2A04-4C6C-B046-8C0F26FB7C70" title="重放计划执行的第一种操作是将参与的工作负载捕获添加到重放。">添加工作负载捕获</a> ”</span> 。
                        </div>
                        <div class="p">
                           <p>在将工作负载捕获添加到重播计划之前，请确保满足以下先决条件：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>创建要添加工作负载捕获的重放计划。</p>
                                 <p>有关创建重播计划的信息，请参阅<span class="q">“ <a href="using-consolidated-database-replay.html#GUID-CC592BD9-1FBE-46BA-88DD-ABB191C93EAB" title="本节介绍如何使用DBMS_WORKLOAD_REPLAY包创建重播计划。">使用API创建重播计划</a> ”</span> 。
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p></p>
                        </div>
                        <!-- class="section" -->
                        <div class="section"></div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-5D8972FE-DCB0-4CE4-A930-28E211387ECE__GUID-5C6BF56D-BFF5-427F-A82F-7B4CC3A917D2">要将工作负载捕获添加到重播计划：</p>
                           <ol>
                              <li>
                                 <p>使用<a id="d31544e3301" class="indexterm-anchor"></a> <code class="codeph">ADD_CAPTURE</code>函数：</p><pre class="oac_no_warn" dir="ltr">DBMS_WORKLOAD_REPLAY.ADD_CAPTURE（capture_dir_name IN VARCHAR2，start_delay_seconds IN NUMBER DEFAULT 0，stop_replay IN BOOLEAN DEFAULT FALSE，take_begin_snapshot IN BOOLEAN DEFAULT FALSE，take_end_snapshot IN BOOLEAN DEFAULT FALSE，query_only IN BOOLEAN DEFAULT FALSE）返回号码;</pre><pre class="oac_no_warn" dir="ltr">DBMS_WORKLOAD_REPLAY.ADD_CAPTURE（capture_dir_name IN VARCHAR2，start_delay_seconds IN NUMBER，stop_replay IN VARCHAR2，take_begin_snapshot IN VARCHAR2 DEFAULT'N'，take_end_snapshot IN VARCHAR2 DEFAULT'N'，query_only IN VARCHAR2 DEFAULT'N'）返回号码;</pre><p>此函数返回唯一标识符，用于标识此重播计划中的工作负载捕获。</p>
                                 <div class="infoboxnote" id="GUID-5D8972FE-DCB0-4CE4-A930-28E211387ECE__GUID-53354CB5-FBFD-442D-8276-6BB72D1D1A53">
                                    <p class="notep1">看到：</p>
                                    <p><span class="q">“ <a href="using-consolidated-database-replay.html#GUID-14A9F425-0888-4CA8-90C4-9E7B476852B8" title="在仅查询数据库重放中，仅重播工作负载捕获的只读查询。换句话说，在仅查询重放中，只有SELECT语句在重放时发送到服务器。在仅查询重放期间不执行DML语句，并且重放不会对用户模式或数据进行任何更改。">关于仅查询数据库重播</a> ”，</span>以获取有关仅查询数据库重放的信息。
                                    </p>
                                 </div>
                                 <div class="infoboxnote" id="GUID-5D8972FE-DCB0-4CE4-A930-28E211387ECE__GUID-B085FB32-1640-415E-9700-AC8703E5BD8E">
                                    <p class="notep1">注意：</p>
                                    <p>仅查询数据库重放仅在测试环境中使用和执行。</p>
                                    <ul style="list-style-type:disc">
                                       <li>
                                          <p>不要在生产系统上使用仅查询数据库重放。</p>
                                       </li>
                                       <li>
                                          <p>在仅查询数据库重放期间，预期会发散。</p>
                                       </li>
                                    </ul>
                                 </div>
                              </li>
                              <li>
                                 <p>将<code class="codeph">capture_dir_name</code>参数设置为指向顶级重播目录下的工作负载捕获的目录对象的名称。
                                 </p>
                                 <p>该目录必须包含在与重放系统运行相同数据库版本的系统上预处理的有效工作负载捕获。</p>
                              </li>
                              <li>
                                 <p>根据需要设置其他参数，这些参数是可选的。</p>
                                 <p>有关这些参数的信息，请参阅<a href="../arpls/DBMS_WORKLOAD_REPLAY.html#ARPLS73982" target="_blank"><span class="italic">Oracle Database PL / SQL包和类型参考</span></a> 。
                                 </p>
                              </li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>以下示例说明如何使用<code class="codeph">SELECT</code>语句中的<code class="codeph">ADD_CAPTURE</code>函数将名为<code class="codeph">peak_wkld</code>的工作负载捕获添加到重播计划。
                           </p><pre class="oac_no_warn" dir="ltr">SELECT DBMS_WORKLOAD_REPLAY.ADD_CAPTURE（'peak_wkld'）FROM dual;</pre><p>您还可以使用<code class="codeph">DBMS_WORKLOAD_REPLAY</code>包删除<a id="d31544e3374" class="indexterm-anchor"></a>工作负载从重播计划中捕获。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-5D8972FE-DCB0-4CE4-A930-28E211387ECE__GUID-E63D6BCD-D837-4F8C-8061-58BDD6D5D0C9">要从重播计划中删除工作负载捕获：</p>
                           <ol>
                              <li>
                                 <p>使用<a id="d31544e3388" class="indexterm-anchor"></a> <code class="codeph">REMOVE_CAPTURE</code>程序：</p><pre class="oac_no_warn" dir="ltr">DBMS_WORKLOAD_REPLAY.REMOVE_CAPTURE（schedule_capture_number IN NUMBER）;</pre></li>
                              <li>
                                 <p>将<code class="codeph">schedule_capture_number</code>参数设置为标识此重播计划中的工作负载捕获的唯一标识符。
                                 </p>
                                 <p>唯一标识符与将工作负载捕获添加到重播计划时<code class="codeph">ADD_CAPTURE</code>函数返回的标识符相同。
                                 </p>
                              </li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <div class="infoboxnotealso" id="GUID-5D8972FE-DCB0-4CE4-A930-28E211387ECE__GUID-EEA18DF4-962E-4C25-A7DF-AA804E9CC66E">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>有关<code class="codeph">ADD_CAPTURE</code>函数的信息，请<code class="codeph">ADD_CAPTURE</code> <a href="../arpls/DBMS_WORKLOAD_REPLAY.html#ARPLS73981" target="_blank"><span class="italic">Oracle Database PL / SQL包和类型参考</span></a></p>
                                 </li>
                                 <li>
                                    <p>有关<code class="codeph">REMOVE_CAPTURE</code>过程的信息<a href="../arpls/DBMS_WORKLOAD_REPLAY.html#ARPLS73998" target="_blank"><span class="italic">，请参见Oracle Database PL / SQL包和类型参考</span></a></p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="RATUG4112"></a><div class="props_rev_3"><a id="GUID-CB0EBAEF-AE24-4EFA-A3F1-27C2479B3A73" name="GUID-CB0EBAEF-AE24-4EFA-A3F1-27C2479B3A73"></a><h5 id="RATUG-GUID-CB0EBAEF-AE24-4EFA-A3F1-27C2479B3A73" class="sect5"><span class="enumeration_section">15.4.3.3</span>添加计划订单以使用API重播计划</h5>
                     <div>
                        <div><span>本节介绍如何使用<code class="codeph">DBMS_WORKLOAD_REPLAY</code>包向重播计划添加计划订单和删除计划订单。</span> 有关向重播计划添加计划订单的信息，请参阅<span class="q">“ <a href="using-consolidated-database-replay.html#GUID-03A418A1-2FB3-43FE-AC82-C9703C3224EA" title="重播计划执行的第二种操作是添加计划订单，指定参与工作负载捕获在重放期间开始的顺序。">添加计划订单</a> ”</span> 。
                        </div>
                        <div class="p">
                           <p>在将计划订单添加到重播计划之前，请确保满足以下先决条件：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>创建要添加计划订单的重放计划。</p>
                                 <p>有关创建重播计划的信息，请参阅<span class="q">“ <a href="using-consolidated-database-replay.html#GUID-CC592BD9-1FBE-46BA-88DD-ABB191C93EAB" title="本节介绍如何使用DBMS_WORKLOAD_REPLAY包创建重播计划。">使用API创建重播计划</a> ”</span> 。
                                 </p>
                              </li>
                              <li>
                                 <p>参与计划订单的所有工作负载捕获都将添加到重播计划中。</p>
                                 <p>有关将工作负载捕获添加到重播计划的信息，请参阅<span class="q">“ <a href="using-consolidated-database-replay.html#GUID-5D8972FE-DCB0-4CE4-A930-28E211387ECE" title="本节介绍如何使用DBMS_WORKLOAD_REPLAY包向重放计划添加工作负载捕获和删除工作负载捕获。">使用API添加工作负载以重播计划</a> ”</span> 。
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <div class="infoboxnote" id="GUID-CB0EBAEF-AE24-4EFA-A3F1-27C2479B3A73__GUID-04FD230E-1B5F-4195-B515-83108436357A">
                              <p class="notep1">注意：</p>
                              <p>将计划订单添加到重播计划是可选的。如果未向重播计划添加计划顺序，则在整合重播开始时，添加到重播计划的所有工作负载捕获将同时开始重播。</p>
                           </div>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-CB0EBAEF-AE24-4EFA-A3F1-27C2479B3A73__GUID-EE69F9DB-1E1E-46A1-A8A0-86DD81D758D7">要将计划订单添加到重播计划：</p>
                           <ol>
                              <li>
                                 <p>使用<a id="d31544e3579" class="indexterm-anchor"></a> <code class="codeph">ADD_SCHEDULE_ORDERING</code>函数：</p><pre class="oac_no_warn" dir="ltr">DBMS_WORKLOAD_REPLAY.ADD_SCHEDULE_ORDERING（schedule_capture_id IN NUMBER，waitfor_capture_id IN NUMBER）返回号码;</pre><p>此功能在已添加到重播计划的两个工作负载捕获之间添加计划顺序。如果无法添加计划订单，则会返回非零错误代码。</p>
                              </li>
                              <li>
                                 <p>将<code class="codeph">schedule_capture_id</code>参数设置为要在此计划顺序中等待的工作负载捕获。
                                 </p>
                              </li>
                              <li>
                                 <p>将<code class="codeph">wait_for_capture_id</code>参数设置为要在此计划顺序中启动其他工作负载捕获之前要完成的工作负载捕获。
                                 </p>
                              </li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>您还可以使用<code class="codeph">DBMS_WORKLOAD_REPLAY</code>包删除<a id="d31544e3609" class="indexterm-anchor"></a>从重播计划安排订单。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-CB0EBAEF-AE24-4EFA-A3F1-27C2479B3A73__GUID-7143E517-B55F-4E4D-A566-EB7871324702">要从重播计划中删除计划订单：</p>
                           <ol>
                              <li>
                                 <p>使用<code class="codeph">REMOVE_SCHEDULE_ORDERING</code>过程：</p><pre class="oac_no_warn" dir="ltr">DBMS_WORKLOAD_REPLAY.REMOVE_SCHEDULE ORDERING（schedule_capture_id IN VARCHAR2，wait_for_capture_id IN VARCHAR2）;</pre></li>
                              <li>
                                 <p>将<code class="codeph">schedule_capture_id</code>参数设置为以此计划顺序等待的工作负载捕获。
                                 </p>
                              </li>
                              <li>
                                 <p>将<code class="codeph">wait_for_capture_id</code>参数设置为需要在此计划顺序中启动其他工作负载捕获之前完成的工作负载捕获。
                                 </p>
                              </li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-CB0EBAEF-AE24-4EFA-A3F1-27C2479B3A73__GUID-0E63F9CC-EAE1-4A45-8145-EA6777342EA5">要查看计划订单：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>使用<code class="codeph">DBA_WORKLOAD_SCHEDULE_ORDERING</code>视图。
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <div class="infoboxnotealso" id="GUID-CB0EBAEF-AE24-4EFA-A3F1-27C2479B3A73__GUID-01E4C99D-5167-4500-AA93-CCB305191218">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>有关<code class="codeph">ADD_SCHEDULE_ORDERING</code>函数的信息，请<code class="codeph">ADD_SCHEDULE_ORDERING</code> <a href="../arpls/DBMS_WORKLOAD_REPLAY.html#ARPLS72130" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                                 </li>
                                 <li>
                                    <p>有关<code class="codeph">REMOVE_SCHEDULE_ORDERING</code>过程的信息，请<code class="codeph">REMOVE_SCHEDULE_ORDERING</code> <a href="../arpls/DBMS_WORKLOAD_REPLAY.html#ARPLS74000" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                                 </li>
                                 <li>
                                    <p>有关<code class="codeph">DBA_WORKLOAD_SCHEDULE_ORDERING</code>视图的信息，请<code class="codeph">DBA_WORKLOAD_SCHEDULE_ORDERING</code> <a href="../refrn/DBA_WORKLOAD_SCHEDULE_ORDERING.html#REFRN23844" target="_blank"><span><cite>Oracle数据库参考</cite></span></a></p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="RATUG4113"></a><div class="props_rev_3"><a id="GUID-40B753EE-A8E0-4C58-AF63-70B23FBF73A6" name="GUID-40B753EE-A8E0-4C58-AF63-70B23FBF73A6"></a><h5 id="RATUG-GUID-40B753EE-A8E0-4C58-AF63-70B23FBF73A6" class="sect5"><span class="enumeration_section">15.4.3.4</span>使用API保存重播计划</h5>
                     <div>
                        <p>本节介绍如何保存使用<code class="codeph">DBMS_WORKLOAD_REPLAY</code>包定义的重播计划。
                        </p>
                        <div class="p">
                           <p>在保存重播计划之前，请确保满足以下先决条件：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>将创建将保存的重播计划。</p>
                                 <p>有关创建重播计划的信息，请参阅<span class="q">“ <a href="using-consolidated-database-replay.html#GUID-CC592BD9-1FBE-46BA-88DD-ABB191C93EAB" title="本节介绍如何使用DBMS_WORKLOAD_REPLAY包创建重播计划。">使用API创建重播计划</a> ”</span> 。
                                 </p>
                              </li>
                              <li>
                                 <p>参与计划订单的所有工作负载捕获都将添加到重播计划中。</p>
                                 <p>有关将工作负载捕获添加到重播计划的信息，请参阅<span class="q">“ <a href="using-consolidated-database-replay.html#GUID-5D8972FE-DCB0-4CE4-A930-28E211387ECE" title="本节介绍如何使用DBMS_WORKLOAD_REPLAY包向重放计划添加工作负载捕获和删除工作负载捕获。">使用API添加工作负载以重播计划</a> ”</span> 。
                                 </p>
                              </li>
                              <li>
                                 <p>您要使用的任何计划订单都会添加到重播计划中（此步骤是可选的）。</p>
                                 <p>有关将计划订单添加到重播计划的信息，请参阅<span class="q">“ <a href="using-consolidated-database-replay.html#GUID-CB0EBAEF-AE24-4EFA-A3F1-27C2479B3A73" title="This section describes how to add schedule orders to and remove schedule orders from replay schedules using the DBMS_WORKLOAD_REPLAY package.">使用API</a></span>重新计划计划<span class="q"><a href="using-consolidated-database-replay.html#GUID-CB0EBAEF-AE24-4EFA-A3F1-27C2479B3A73" title="本节介绍如何使用DBMS_WORKLOAD_REPLAY包向重播计划添加计划订单和删除计划订单。">添加计划订单</a> ”</span> 。
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                        <div class="section"></div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-40B753EE-A8E0-4C58-AF63-70B23FBF73A6__GUID-84F8B405-BB69-40CE-B1F1-191D17A36854">要保存重播计划：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>使用<a id="d31544e3830" class="indexterm-anchor"></a> <code class="codeph">END_REPLAY_SCHEDULE</code>程序：</p><pre class="oac_no_warn" dir="ltr">DBMS_WORKLOAD_REPLAY.END_REPLAY_SCHEDULE;</pre><p>此过程完成重播计划的创建。重播计划已保存并与重播目录关联。保存重播计划后，您可以将其用于整合重播。</p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-40B753EE-A8E0-4C58-AF63-70B23FBF73A6__GUID-DF78CE64-0AF7-4F9E-A53B-D71022E5D08B">要查看重播计划：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>使用<code class="codeph">DBA_WORKLOAD_REPLAY_SCHEDULES</code>视图。
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <div class="infoboxnotealso" id="GUID-40B753EE-A8E0-4C58-AF63-70B23FBF73A6__GUID-8895EC74-CFA2-4AB2-9051-90C081E635B6">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>有关<code class="codeph">END_REPLAY_SCHEDULE</code>过程的信息，请<code class="codeph">END_REPLAY_SCHEDULE</code> <a href="../arpls/DBMS_WORKLOAD_REPLAY.html#ARPLS73987" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                                 </li>
                                 <li>
                                    <p>有关<code class="codeph">DBA_WORKLOAD_REPLAY_SCHEDULES</code>视图的信息，请<code class="codeph">DBA_WORKLOAD_REPLAY_SCHEDULES</code> <a href="../refrn/DBA_WORKLOAD_REPLAY_SCHEDULES.html#REFRN-GUID-5C3B2723-B9F9-491A-9226-171B8DAD6553" target="_blank"><span><cite>Oracle数据库参考</cite></span></a></p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div><a id="RATUG4114"></a><div class="props_rev_3"><a id="GUID-10610AAB-EB5C-441C-A1E3-64DEDEC6B45F" name="GUID-10610AAB-EB5C-441C-A1E3-64DEDEC6B45F"></a><h4 id="RATUG-GUID-10610AAB-EB5C-441C-A1E3-64DEDEC6B45F" class="sect4"><span class="enumeration_section">15.4.4</span>使用API运行Consolidated Database Replay</h4>
                  <div>
                     <div><span>本节介绍如何使用<code class="codeph">DBMS_WORKLOAD_REPLAY</code>包运行Consolidated Database Replay。</span> 有关整合重播的信息，请参阅<span class="q">“ <a href="using-consolidated-database-replay.html#GUID-BFC7713A-5BEB-4A2E-9B0F-9F43A983BC6C" title="使用Consolidated Database Replay重播整合的工作负载与使用Database Replay重放单个数据库工作负载完全不同。">重新合并数据库工作负载以进行统一数据库重放</a> ”</span> 。
                     </div>
                     <div class="p">
                        <p>在运行Consolidated Database Replay之前，请确保满足以下先决条件：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>在运行与重放系统相同的数据库版本的系统上，使用<code class="codeph">PROCESS_CAPTURE</code>过程对所有工作负载捕获进行预处理，如<a href="preprocessing-a-database-workload.html#GUID-4CEE2F79-F5A7-4EBA-9018-0CB99AB51C0A" title="捕获工作负载并完成测试系统的设置后，必须预处理捕获的数据。">预处理数据库工作负载中所述</a> 。
                              </p>
                           </li>
                           <li>
                              <p>所有捕获目录都将复制到重放系统上的重播目录中</p>
                           </li>
                           <li>
                              <p>使用<code class="codeph">SET_REPLAY_DIRECTORY</code>过程设置重播目录，如<span class="q">“ <a href="using-consolidated-database-replay.html#GUID-3A5F701E-6200-45C4-BDFD-D5A4740875DA" title="本节介绍如何使用DBMS_WORKLOAD_REPLAY包在测试系统上设置统一重播目录。">使用API设置合并重播目录</a> ”中所述</span> 。
                              </p>
                           </li>
                           <li>
                              <p>在所有工作负载捕获的开始时间，数据库在逻辑上恢复到与所有捕获系统相同的应用程序状态。</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-10610AAB-EB5C-441C-A1E3-64DEDEC6B45F__GUID-28E06ED6-C11C-4310-BCD4-F08CA40D7C1D">要运行Consolidated Database Replay：</p>
                        <ol>
                           <li>
                              <p>初始化重播数据，如<span class="q">“ <a href="using-consolidated-database-replay.html#GUID-7FA57ECB-BFF9-4595-AB3E-DDED8BEE3E65" title="本节介绍如何使用DBMS_WORKLOAD_REPLAY包初始化整合重播的重播数据。">使用API初始化统一数据库重放</a> ”中所述</span> 。
                              </p>
                           </li>
                           <li>
                              <p>重新映射连接字符串，如<span class="q">“ <a href="using-consolidated-database-replay.html#GUID-284D7908-40EE-4570-AE78-E75AAA294327" title="本节介绍如何使用DBMS_WORKLOAD_REPLAY包重新映射整合重播的连接字符串。">使用API重新映射连接</a> ”中所述</span> 。
                              </p>
                           </li>
                           <li>
                              <p>重新映射用户，如<span class="q">“ <a href="using-consolidated-database-replay.html#GUID-12BFB1A9-B0C6-4AE9-9E1B-F7237FAED915" title="本节介绍如何使用DBMS_WORKLOAD_REPLAY包重新映射用户以进行整合重播。">使用API重新映射用户</a> ”中所述</span> 。
                              </p>
                              <p>重新映射用户是可选的。</p>
                           </li>
                           <li>
                              <p>准备整合重播，如<span class="q">“ <a href="using-consolidated-database-replay.html#GUID-84EE2D27-04A8-4C78-8C08-4A5FF4472B68" title="本节介绍如何使用DBMS_WORKLOAD_REPLAY包准备整合重播。">使用API准备合并数据库重放</a> ”中所述</span> 。
                              </p>
                           </li>
                           <li>
                              <p>设置并启动重播客户端，如<span class="q">“ <a href="replaying-a-database-workload.html#GUID-80A5AAE5-53E8-4775-AE5F-B43ADDB6E07F" title="此时，您需要设置并启动重播客户端，这些客户端将连接到重放系统并根据工作负载中捕获的内容发送请求。">设置重播客户端</a> ”中所述</span> 。
                              </p>
                           </li>
                           <li>
                              <p>启动整合重播，如<span class="q">“ <a href="using-consolidated-database-replay.html#GUID-62E2EA2B-D34C-47A0-BDA3-83E446DCC3D1" title="本节介绍如何使用DBMS_WORKLOAD_REPLAY包启动整合重播。">使用API启动统一数据库重放</a> ”中所述</span> 。
                              </p>
                           </li>
                           <li>
                              <p>生成报告并执行分析，如<span class="q">“ <a href="using-consolidated-database-replay.html#GUID-D7C55F09-D604-4AD6-8B4A-C8C93D954954" title="使用重播比较期间报告执行统一数据库重放的报告和分析。看到" ="">统一数据库重放的报告和分析</a> ”中所述</span> 。
                              </p>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div><a id="RATUG4116"></a><a id="RATUG4115"></a><div class="props_rev_3"><a id="GUID-7FA57ECB-BFF9-4595-AB3E-DDED8BEE3E65" name="GUID-7FA57ECB-BFF9-4595-AB3E-DDED8BEE3E65"></a><h5 id="RATUG-GUID-7FA57ECB-BFF9-4595-AB3E-DDED8BEE3E65" class="sect5"><span class="enumeration_section">15.4.4.1</span>使用API初始化统一数据库重放</h5>
                     <div>
                        <p>本节介绍如何使用<code class="codeph">DBMS_WORKLOAD_REPLAY</code>包初始化整合重播的重播数据。
                        </p>
                        <div class="section">
                           <p>初始化重播数据执行以下操作：</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>将数据库状态置于初始化模式以重放统一工作负载。</p>
                              </li>
                              <li>
                                 <p>指向重播目录，其中包含参与重播计划的所有工作负载捕获。</p>
                              </li>
                              <li>
                                 <p>将必要的元数据加载到重播所需的表中。</p>
                                 <p>例如，捕获的连接字符串被加载到表中，在表中可以重新映射它们以进行重放。</p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-7FA57ECB-BFF9-4595-AB3E-DDED8BEE3E65__GUID-D8874968-8015-448B-A276-AC0CF4922D8F">要初始化Consolidated Database Replay：</p>
                           <ol>
                              <li>
                                 <p>使用<a id="d31544e4217" class="indexterm-anchor"></a> <code class="codeph">INITIALIZE_CONSOLIDATED_REPLAY</code>程序：</p><pre class="oac_no_warn" dir="ltr">DBMS_WORKLOAD_REPLAY.INITIALIZE_CONSOLIDATED_REPLAY（replay_name IN VARCHAR2，schedule_name IN VARCHAR2，plsql_mode IN VARCHAR2 DEFAULT'TOP_LEVEL'）;</pre></li>
                              <li>
                                 <p>将<code class="codeph">replay_name</code>参数设置为整合重播的名称。
                                 </p>
                              </li>
                              <li>
                                 <p>将<code class="codeph">schedule_name</code>参数设置为要使用的重播计划的名称。
                                 </p>
                                 <p><code class="codeph">schedule_name</code>参数是在创建过程中使用的重放计划的名称，如<span class="q">“ <a href="using-consolidated-database-replay.html#GUID-CC592BD9-1FBE-46BA-88DD-ABB191C93EAB" title="本节介绍如何使用DBMS_WORKLOAD_REPLAY包创建重播计划。">使用API创建重播计划</a> ”中所述</span> 。
                                 </p>
                              </li>
                           </ol>
                           <p>可选的<code class="codeph">plsql_mode</code>参数指定PL / SQL重放模式。
                           </p>
                           <p>可以为<code class="codeph">plsql_mode</code>参数设置这两个值：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><code class="codeph">top_level</code> ：只有顶级PL / SQL调用。这是默认值。
                                 </p>
                              </li>
                              <li>
                                 <p><code class="codeph">extended</code> ：如果内部没有记录SQL，则在PL / SQL或顶级PL / SQL中执行SQL。所有捕获都必须在<code class="codeph">'extended'</code> PL / SQL模式下完成。非PL / SQL调用将以通常的方式重放。
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>下面的例子显示了如何初始化命名合并重播<code class="codeph">peak_replay</code>使用名为重播时间表<code class="codeph">peak_schedule</code> 。
                           </p><pre class="oac_no_warn" dir="ltr">EXEC DBMS_WORKLOAD_REPLAY.INITIALIZE_CONSOLIDATED_REPLAY（'peak_replay'，'peak_schedule'）;</pre><div class="infoboxnotealso" id="GUID-7FA57ECB-BFF9-4595-AB3E-DDED8BEE3E65__GUID-F69A8ED8-D38D-4C88-A697-667085ABC2F2">
                              <p class="notep1">也可以看看：</p>
                              <p>有关<code class="codeph">INITIALIZE_CONSOLIDATED_REPLAY</code>过程的信息，请参阅<a href="../arpls/DBMS_WORKLOAD_REPLAY.html#ARPLS73994" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="RATUG4117"></a><div class="props_rev_3"><a id="GUID-284D7908-40EE-4570-AE78-E75AAA294327" name="GUID-284D7908-40EE-4570-AE78-E75AAA294327"></a><h5 id="RATUG-GUID-284D7908-40EE-4570-AE78-E75AAA294327" class="sect5"><span class="enumeration_section">15.4.4.2</span>使用API重新映射连接</h5>
                     <div>
                        <div><span>本节介绍如何使用<code class="codeph">DBMS_WORKLOAD_REPLAY</code>包重新映射整合重播的连接字符串。</span> 有关连接重新映射的信息，请参阅<span class="q">“ <a href="using-consolidated-database-replay.html#GUID-A2D6CDAF-A91D-4DA4-ADCE-038595E851A9" title="与使用数据库重放重放单个数据库工作负载的情况一样，用于连接到生产系统的捕获的连接字符串需要重新映射到重放系统。">重新映射统一数据库重播的连接</a> ”</span> 。
                        </div>
                        <div class="section">
                           <p class="subhead3" id="GUID-284D7908-40EE-4570-AE78-E75AAA294327__GUID-CC13AAA9-08DC-448B-9818-C83536C25724">要重新映射连接字符串：</p>
                           <ol>
                              <li>
                                 <p>使用<a id="d31544e4404" class="indexterm-anchor"></a> <code class="codeph">REMAP_CONNECTION</code>程序：</p><pre class="oac_no_warn" dir="ltr">DBMS_WORKLOAD_REPLAY.REMAP_CONNECTION（schedule_cap_id IN NUMBER，connection_id IN NUMBER，replay_connection IN VARCHAR2）;</pre><p>此过程将捕获的连接重新映射到重播计划中所有参与工作负载捕获的新连接字符串。</p>
                              </li>
                              <li>
                                 <p>将<code class="codeph">schedule_capture_id</code>参数设置为当前重播计划中的参与工作负载捕获。
                                 </p>
                                 <p><code class="codeph">schedule_capture_id</code>参数是将工作负载捕获添加到重播计划时返回的唯一标识符，如<span class="q">“ <a href="using-consolidated-database-replay.html#GUID-5D8972FE-DCB0-4CE4-A930-28E211387ECE" title="本节介绍如何使用DBMS_WORKLOAD_REPLAY包向重放计划添加工作负载捕获和删除工作负载捕获。">使用API添加工作负载到重播计划</a> ”中所述</span> 。
                                 </p>
                              </li>
                              <li>
                                 <p>将<code class="codeph">connection_id</code>参数设置为要重新映射的连接。
                                 </p>
                                 <p><code class="codeph">connection_id</code>参数在初始化重放数据时生成，并且对应于工作负载捕获的连接。
                                 </p>
                              </li>
                              <li>
                                 <p>将<code class="codeph">replay_connection</code>参数设置为将在重播期间使用的新连接字符串。
                                 </p>
                              </li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <div class="infoboxnotealso" id="GUID-284D7908-40EE-4570-AE78-E75AAA294327__GUID-01C606DC-D44E-4016-B215-C5F1146A4FB6">
                              <p class="notep1">也可以看看：</p>
                              <p>有关<code class="codeph">REMAP_CONNECTION</code>过程的信息，请<code class="codeph">REMAP_CONNECTION</code> <a href="../arpls/DBMS_WORKLOAD_REPLAY.html#ARPLS69093" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="RATUG4119"></a><a id="RATUG4118"></a><div class="props_rev_3"><a id="GUID-12BFB1A9-B0C6-4AE9-9E1B-F7237FAED915" name="GUID-12BFB1A9-B0C6-4AE9-9E1B-F7237FAED915"></a><h5 id="RATUG-GUID-12BFB1A9-B0C6-4AE9-9E1B-F7237FAED915" class="sect5"><span class="enumeration_section">15.4.4.3</span>使用API重新映射用户</h5>
                     <div>
                        <div><span>本节介绍如何使用<code class="codeph">DBMS_WORKLOAD_REPLAY</code>包重新映射用户以进行整合重播。</span> 有关重新映射用户的信息，请参阅<span class="q">“ <a href="using-consolidated-database-replay.html#GUID-48411BB5-E585-4783-B016-72DCD97074CE" title="与使用数据库重放重放单个数据库工作负载的情况一样，可以在重放期间重新映射用于连接到生产系统的数据库用户和模式的用户名。看到" ="">重新映射用户以进行统一数据库重播</a> ”</span> 。
                        </div>
                        <div class="p">
                           <p>在重新映射用户之前，请确保满足以下先决条件：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>重播数据已初始化，如<span class="q">“ <a href="using-consolidated-database-replay.html#GUID-7FA57ECB-BFF9-4595-AB3E-DDED8BEE3E65" title="本节介绍如何使用DBMS_WORKLOAD_REPLAY包初始化整合重播的重播数据。">使用API初始化统一数据库重放</a> ”中所述</span> 。
                                 </p>
                              </li>
                              <li>
                                 <p>数据库状态不处于重播模式。</p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-12BFB1A9-B0C6-4AE9-9E1B-F7237FAED915__GUID-68972639-9541-46C0-8C4F-FFC32411E689">要重新映射用户：</p>
                           <ol>
                              <li>
                                 <p>使用<a id="d31544e4594" class="indexterm-anchor"></a> <code class="codeph">SET_USER_MAPPING</code>程序：</p><pre class="oac_no_warn" dir="ltr">DBMS_WORKLOAD_REPLAY.SET_USER_MAPPING（schedule_cap_id IN NUMBER，capture_user IN VARCHAR2，replay_user IN VARCHAR2）;</pre></li>
                              <li>
                                 <p>将<code class="codeph">schedule_capture_id</code>参数设置为当前重播计划中的参与工作负载捕获。
                                 </p>
                                 <p><code class="codeph">schedule_capture_id</code>参数是将工作负载捕获添加到重播计划时返回的唯一标识符，如<span class="q">“ <a href="using-consolidated-database-replay.html#GUID-5D8972FE-DCB0-4CE4-A930-28E211387ECE" title="本节介绍如何使用DBMS_WORKLOAD_REPLAY包向重放计划添加工作负载捕获和删除工作负载捕获。">使用API添加工作负载到重播计划</a> ”中所述</span> 。
                                 </p>
                              </li>
                              <li>
                                 <p>将<code class="codeph">capture_user</code>参数设置为在工作负载捕获期间捕获的用户或模式的用户名。
                                 </p>
                              </li>
                              <li>
                                 <p>将<code class="codeph">replay_user</code>参数设置为在重放期间将捕获的用户重新映射到的新用户或模式的用户名。
                                 </p>
                                 <p>如果此参数设置为<code class="codeph">NULL</code> ，则禁用映射。
                                 </p>
                              </li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>此示例显示如何在重放期间将捕获期间使用的<code class="codeph">PROD</code>用户重新映射到<code class="codeph">TEST</code>用户，以识别标识为<code class="codeph">1001</code>的工作负载捕获。
                           </p><pre class="oac_no_warn" dir="ltr">EXEC DBMS_WORKLOAD_REPLAY.SET_USER_MAPPING（1001，'PROD'，'TEST'）;</pre><div class="infoboxnotealso" id="GUID-12BFB1A9-B0C6-4AE9-9E1B-F7237FAED915__GUID-5B470F97-CDFE-4350-8E8D-D6D5457D2505">
                              <p class="notep1">也可以看看：</p>
                              <p>有关<code class="codeph">SET_USER_MAPPING</code>过程的信息，请<code class="codeph">SET_USER_MAPPING</code> <a href="../arpls/DBMS_WORKLOAD_REPLAY.html#ARPLS74963" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="RATUG4120"></a><div class="props_rev_3"><a id="GUID-84EE2D27-04A8-4C78-8C08-4A5FF4472B68" name="GUID-84EE2D27-04A8-4C78-8C08-4A5FF4472B68"></a><h5 id="RATUG-GUID-84EE2D27-04A8-4C78-8C08-4A5FF4472B68" class="sect5"><span class="enumeration_section">15.4.4.4</span>使用API准备统一数据库重放</h5>
                     <div>
                        <div><span>本节介绍如何使用<code class="codeph">DBMS_WORKLOAD_REPLAY</code>包准备整合重播。</span> 有关准备合并重播的信息，请参阅<span class="q">“ <a href="using-consolidated-database-replay.html#GUID-C2F6DA54-9C2C-40CE-B357-F58126C0E2EE" title="与使用数据库重放重放单个数据库工作负载的情况一样，在准备重播期间定义了重播选项。">准备合并数据库重播</a> ”</span> 。
                        </div>
                        <div class="p">
                           <p>在准备整合重播之前，请确保满足以下先决条件：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>重播数据已初始化，如<span class="q">“ <a href="using-consolidated-database-replay.html#GUID-7FA57ECB-BFF9-4595-AB3E-DDED8BEE3E65" title="本节介绍如何使用DBMS_WORKLOAD_REPLAY包初始化整合重播的重播数据。">使用API初始化统一数据库重放</a> ”中所述</span> 。
                                 </p>
                              </li>
                              <li>
                                 <p>捕获的连接将重新映射，如<span class="q">“ <a href="using-consolidated-database-replay.html#GUID-284D7908-40EE-4570-AE78-E75AAA294327" title="本节介绍如何使用DBMS_WORKLOAD_REPLAY包重新映射整合重播的连接字符串。">使用API重新映射连接</a> ”中所述</span> 。
                                 </p>
                              </li>
                              <li>
                                 <p>映射用户，如<span class="q">“ <a href="using-consolidated-database-replay.html#GUID-12BFB1A9-B0C6-4AE9-9E1B-F7237FAED915" title="本节介绍如何使用DBMS_WORKLOAD_REPLAY包重新映射用户以进行整合重播。">使用API重新映射用户</a> ”中所述</span> 。
                                 </p>
                                 <p>重新映射用户是可选的。但是，如果您计划在重放期间重新映射用户，则必须在准备整合重播之前完成该操作。</p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                        <div class="section"></div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>准备整合重播将执行以下操作：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>指定重播选项，例如同步模式，会话连接速率和会话请求速率。</p>
                              </li>
                              <li>
                                 <p>将数据库状态置于重放模式。</p>
                              </li>
                              <li>
                                 <p>启用重播客户端的启动。</p>
                              </li>
                           </ul>
                           <div class="infoboxnote" id="GUID-84EE2D27-04A8-4C78-8C08-4A5FF4472B68__GUID-FE5EE87C-72B4-41DA-A7E8-61E2562C8C0F">
                              <p class="notep1">注意：</p>
                              <p>Consolidated Database Replay仅支持基于时间或基于<code class="codeph">OBJECT_ID</code>的同步（ <code class="codeph">synchronization</code> = <code class="codeph">TIME</code>或<code class="codeph">OBJECT_ID</code> ）。目前不支持基于SCN的同步。
                              </p>
                           </div>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-84EE2D27-04A8-4C78-8C08-4A5FF4472B68__GUID-25F965C4-613B-4246-BD1E-5A3F05B1EF8E">准备合并重播：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>使用<a id="d31544e4843" class="indexterm-anchor"></a> <code class="codeph">PREPARE_CONSOLIDATED_REPLAY</code>程序：</p><pre class="oac_no_warn" dir="ltr">DBMS_WORKLOAD_REPLAY.PREPARE_CONSOLIDATED_REPLAY（同步IN VARCHAR2 DEFAULT'OBJECT_ID'，connect_time_scale IN NUMBER DEFAULT 100，think_time_scale IN NUMBER DEFAULT 100，think_time_auto_correct IN BOOLEAN DEFAULT TRUE，capture_sts IN BOOLEAN DEFAULT FALSE，sts_cap_interval in NUMBER DEFAULT 300）;</pre><p>有关这些参数及其设置方法的信息，请参阅<span class="q">“ <a href="replaying-a-database-workload.html#GUID-289F573A-9C83-4A29-A1D4-323705E8293D" title="还原数据库并重新映射连接和用户后，您可以设置相应的重播选项。">指定重播选项</a> ”</span> 。
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <div class="infoboxnote" id="GUID-84EE2D27-04A8-4C78-8C08-4A5FF4472B68__GUID-3AB11FC9-F51A-4526-87F2-6289B811322E">
                              <p class="notep1">注意：</p>
                              <p>使用<code class="codeph">PREPARE_CONSOLIDATED_REPLAY</code>过程时，请确保将<code class="codeph">synchronization</code>设置为<code class="codeph">false</code> 。
                              </p>
                           </div>
                           <div class="infoboxnotealso" id="GUID-84EE2D27-04A8-4C78-8C08-4A5FF4472B68__GUID-2C656CF4-9A96-4455-B835-17A3513F4450">
                              <p class="notep1">也可以看看：</p>
                              <p>有关<code class="codeph">PREPARE_CONSOLIDATED_REPLAY</code>过程的信息，请<code class="codeph">PREPARE_CONSOLIDATED_REPLAY</code> <a href="../arpls/DBMS_WORKLOAD_REPLAY.html#ARPLS73996" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="RATUG4121"></a><div class="props_rev_3"><a id="GUID-62E2EA2B-D34C-47A0-BDA3-83E446DCC3D1" name="GUID-62E2EA2B-D34C-47A0-BDA3-83E446DCC3D1"></a><h5 id="RATUG-GUID-62E2EA2B-D34C-47A0-BDA3-83E446DCC3D1" class="sect5"><span class="enumeration_section">15.4.4.5</span>使用API启动统一数据库重放</h5>
                     <div>
                        <p>本节介绍如何使用<code class="codeph">DBMS_WORKLOAD_REPLAY</code>包启动整合重播。
                        </p>
                        <div class="p">
                           <p>在开始整合重播之前，请确保满足以下先决条件：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>准备整合重播，如<span class="q">“ <a href="using-consolidated-database-replay.html#GUID-84EE2D27-04A8-4C78-8C08-4A5FF4472B68" title="本节介绍如何使用DBMS_WORKLOAD_REPLAY包准备整合重播。">使用API准备合并数据库重放</a> ”中所述</span> 。
                                 </p>
                              </li>
                              <li>
                                 <p>启动了足够数量的重播客户端。</p>
                                 <p>有关设置和启动重播客户端的信息，请参阅<span class="q">“ <a href="replaying-a-database-workload.html#GUID-80A5AAE5-53E8-4775-AE5F-B43ADDB6E07F" title="此时，您需要设置并启动重播客户端，这些客户端将连接到重放系统并根据工作负载中捕获的内容发送请求。">设置重播客户端</a> ”</span> 。
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-62E2EA2B-D34C-47A0-BDA3-83E446DCC3D1__GUID-DF65BFF4-F297-41C5-BE1C-13C04DF55E98">要开始整合重播：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>使用<a id="d31544e5009" class="indexterm-anchor"></a> <code class="codeph">START_CONSOLIDATED_REPLAY</code>程序：</p><pre class="oac_no_warn" dir="ltr">DBMS_WORKLOAD_REPLAY.START_CONSOLIDATED_REPLAY;</pre></li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <div class="infoboxnotealso" id="GUID-62E2EA2B-D34C-47A0-BDA3-83E446DCC3D1__GUID-9B347C48-85D3-40C4-B94D-82D904A642CD">
                              <p class="notep1">也可以看看：</p>
                              <p>有关<code class="codeph">START_CONSOLIDATED_REPLAY</code>过程的信息<a href="../arpls/DBMS_WORKLOAD_REPLAY.html#ARPLS74454" target="_blank"><span><cite>，请参见Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div>
            </div><a id="RATUG4265"></a><div class="props_rev_3"><a id="GUID-14A9F425-0888-4CA8-90C4-9E7B476852B8" name="GUID-14A9F425-0888-4CA8-90C4-9E7B476852B8"></a><h3 id="RATUG-GUID-14A9F425-0888-4CA8-90C4-9E7B476852B8" class="sect3"><span class="enumeration_section">15.5</span>关于仅查询数据库重播</h3>
               <div>
                  <p>在仅查询数据库重放中，仅重播工作负载捕获的只读查询。换句话说，在仅查询重放中，只有<code class="codeph">SELECT</code>语句在重放时发送到服务器。在仅查询重放期间不执行DML语句，并且重放不会对用户模式或数据进行任何更改。
                  </p>
                  <div class="infoboxnote" id="GUID-14A9F425-0888-4CA8-90C4-9E7B476852B8__GUID-9E11040B-0E83-4E6B-B2D4-6E228FF9ACE8">
                     <p class="notep1">注意：</p>
                     <p>只能使用Consolidated Database Replay执行仅查询数据库重播。</p>
                  </div>
                  <div class="infoboxnote" id="GUID-14A9F425-0888-4CA8-90C4-9E7B476852B8__GUID-E04313E2-44BA-49E6-B069-B1E39B523120">
                     <p class="notep1">注意：</p>
                     <p>仅查询数据库重放仅在测试环境中使用和执行。</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>不要在生产系统上使用仅查询数据库重放。</p>
                        </li>
                        <li>
                           <p>在仅查询数据库重放期间，预期会发散。</p>
                        </li>
                     </ul>
                  </div>
               </div><a id="RATUG4266"></a><div class="props_rev_3"><a id="GUID-5BF0AEE7-A64C-4523-ACDE-7043AE0AAEFE" name="GUID-5BF0AEE7-A64C-4523-ACDE-7043AE0AAEFE"></a><h4 id="RATUG-GUID-5BF0AEE7-A64C-4523-ACDE-7043AE0AAEFE" class="sect4"><span class="enumeration_section">15.5.1</span>仅查询数据库重播的用例</h4>
                  <div>
                     <div><span>您可以使用仅查询数据库重放来预热数据库缓冲区缓存并查找回归。</span> 例如：</div>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>预热数据库缓冲区缓存</p>
                           <p>在某些情况下，当数据库缓冲区高速缓存为热时（数据块已在缓冲区高速缓存中），将捕获工作负载。但是，当您在测试系统上重放该工作负载时，缓冲区缓存将不会变热，并且最初需要从磁盘加载数据块。这可能使重播持续时间长于捕获持续时间，并增加数据库时间。</p>
                           <p>为了避免必须预热缓冲区缓存，您可以执行仅查询重放，然后执行读/写重放，而无需重新启动数据库，也无需刷新缓冲区缓存。请注意，在仅查询重播之后，您不必重新启动数据库，因为仅查询重播是只读的。</p>
                        </li>
                        <li>
                           <p>寻找回归</p>
                           <p>仅查询重播是一种通过并发从工作负载的只读部分查找回归的简单方法。只读部分包括<code class="codeph">SELECT</code> （不是<code class="codeph">SELECT...FOR UPDATE</code> ）语句，没有DML和DDL的PL / SQL，LOB读取等。它通常是工作负载捕获的主要部分。
                           </p>
                        </li>
                     </ul>
                  </div>
               </div><a id="RATUG4267"></a><div class="props_rev_3"><a id="GUID-81A86A84-E915-4A40-A9C1-B3BA4C5410E1" name="GUID-81A86A84-E915-4A40-A9C1-B3BA4C5410E1"></a><h4 id="RATUG-GUID-81A86A84-E915-4A40-A9C1-B3BA4C5410E1" class="sect4"><span class="enumeration_section">15.5.2</span>执行仅查询数据库重播</h4>
                  <div>
                     <p>您可以执行仅查询数据库重播。</p>
                     <p>要执行仅查询数据库重播，请按照<span class="q">“ <a href="using-consolidated-database-replay.html#GUID-F3F44EF1-5E8E-4758-BB59-602E7E07CAE5" title="本节介绍如何使用DBMS_WORKLOAD_REPLAY包创建和重播整合的工作负载。">使用API中的合并数据库重放</a> ”中</span>的说明进行操作。当您使用<code class="codeph">ADD_CAPTURE</code>函数将工作负载捕获添加到重播计划时，如<span class="q">“ <a href="using-consolidated-database-replay.html#GUID-5D8972FE-DCB0-4CE4-A930-28E211387ECE" title="本节介绍如何使用DBMS_WORKLOAD_REPLAY包向重放计划添加工作负载捕获和删除工作负载捕获。">使用API添加工作负载捕获重播计划</a> ”中所述</span> ，将<code class="codeph">query_only</code>参数设置为<code class="codeph">Y</code></p>
                  </div>
               </div>
            </div><a id="RATUG4130"></a><a id="RATUG4122"></a><div class="props_rev_3"><a id="GUID-29988B63-F974-46EF-9AAD-3D04AF774337" name="GUID-29988B63-F974-46EF-9AAD-3D04AF774337"></a><h3 id="RATUG-GUID-29988B63-F974-46EF-9AAD-3D04AF774337" class="sect3"><span class="enumeration_section">15.6</span>示例：使用API重新合并工作负载</h3>
               <div>
                  <p>本节假设一个场景，来自三个独立生产系统的工作负载在不同操作系统上运行不同版本的Oracle数据库。</p>
                  <div class="section">
                     <p>此方案使用以下假设：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type:disc">
                        <li>
                           <p>要整合的第一个工作负载是从CRM系统捕获的，该系统在Solaris服务器上运行Oracle数据库10g第2版（版本10.2.0.4）。</p>
                        </li>
                        <li>
                           <p>要整合的第二个工作负载是从ERP系统捕获的，该系统在Linux服务器上运行Oracle数据库10g第2版（版本10.2.0.5）。</p>
                        </li>
                        <li>
                           <p>要整合的第三个工作负载是从SCM系统捕获的，该系统在Solaris服务器上运行Oracle Database <span class="italic">11g</span>第2版（版本11.2.0.2）。
                           </p>
                        </li>
                        <li>
                           <p>测试系统设置为运行Oracle Database 12 <span class="italic">c</span> Release 1（版本12.1.0.1）的多租户容器数据库（CDB）。
                           </p>
                        </li>
                        <li>
                           <p>CDB包含从CRM，ERP和SCM系统创建的三个PDB。</p>
                        </li>
                        <li>
                           <p>CDB中包含的每个PDB在捕获开始时恢复到与CRM，ERP和SCM系统相同的应用程序数据状态。</p>
                        </li>
                     </ul>
                     <p><a href="using-consolidated-database-replay.html#GUID-29988B63-F974-46EF-9AAD-3D04AF774337__CHDJGAIH">图15-3</a>说明了这种情况。
                     </p>
                     <div class="figure" id="GUID-29988B63-F974-46EF-9AAD-3D04AF774337__CHDJGAIH">
                        <p class="titleinfigure">图15-3合并三个工作负载的场景</p><img src="img/ratug005.png" width="298" alt="下面是图15-3的描述" title="下面是图15-3的描述" longdesc="img_text/ratug005.html"><br><a href="img_text/ratug005.html">“图15-3合并三个工作负载的场景”的描述</a></div>
                     <!-- class="figure" -->
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-29988B63-F974-46EF-9AAD-3D04AF774337__GUID-52916F2F-D49E-4071-ADD0-BBEA157DD284">要在此方案中合并工作负载并重播整合工作负载：</p>
                     <ol>
                        <li>
                           <p>在测试系统上，将各个工作负载捕获预处理到单独的目录中：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>对于CRM工作负载：</p>
                                 <ol type="a">
                                    <li>
                                       <p>创建目录对象：</p><pre class="oac_no_warn" dir="ltr">创建或替换DIRECTORY目录crm AS'/ u01 / test / cap_crm';</pre></li>
                                    <li>
                                       <p>确保从CRM系统捕获的工作负载存储在此目录中。</p>
                                    </li>
                                    <li>
                                       <p>预处理工作量：</p><pre class="oac_no_warn" dir="ltr">EXEC DBMS_WORKLOAD_REPLAY.PROCESS_CAPTURE（'CRM'）;</pre></li>
                                 </ol>
                              </li>
                              <li>
                                 <p>对于ERP工作量：</p>
                                 <ol type="a">
                                    <li>
                                       <p>创建目录对象：</p><pre class="oac_no_warn" dir="ltr">创建或替换目录erp AS'/ u01 / test / cap_erp';</pre></li>
                                    <li>
                                       <p>确保从ERP系统捕获的工作负载存储在此目录中。</p>
                                    </li>
                                    <li>
                                       <p>预处理工作量：</p><pre class="oac_no_warn" dir="ltr">EXEC DBMS_WORKLOAD_REPLAY.PROCESS_CAPTURE（'ERP'）;</pre></li>
                                 </ol>
                              </li>
                              <li>
                                 <p>对于SCM工作负载：</p>
                                 <ol type="a">
                                    <li>
                                       <p>创建目录对象：</p><pre class="oac_no_warn" dir="ltr">创建或替换DIRECTORY目录scm AS'/ u01 / test / cap_scm';</pre></li>
                                    <li>
                                       <p>确保从SCM系统捕获的工作负载存储在此目录中。</p>
                                    </li>
                                    <li>
                                       <p>预处理工作量：</p><pre class="oac_no_warn" dir="ltr">EXEC DBMS_WORKLOAD_REPLAY.PROCESS_CAPTURE（'SCM'）;</pre></li>
                                 </ol>
                              </li>
                           </ul>
                        </li>
                        <li id="GUID-29988B63-F974-46EF-9AAD-3D04AF774337__CHDCFBIC">
                           <p>创建根目录以存储预处理的工作负载：</p><pre class="oac_no_warn" dir="ltr">mkdir'/ u01 / test / cons_dir';创建或替换DIRECTORY目录cons_workload AS'/ u01 / test / cons_dir';</pre></li>
                        <li>
                           <p>将每个预处理的工作负载目录复制到根目录：</p><pre class="oac_no_warn" dir="ltr">cp -r / u01 / test / cap_crm / u01 / test / cons_dir cp -r / u01 / test / cap_erp / u01 / test / cons_dir cp -r / u01 / test / cap_scm / u01 / test / cons_dir</pre></li>
                        <li>
                           <p>对于每个工作负载，使用新的操作系统目录路径创建目录对象：</p><pre class="oac_no_warn" dir="ltr">创建或更换目录crm AS'/ u01 / test / cons_dir / cap_crm';创建或替换DIRECTORY erp AS'/ u01 / test / cons_dir / cap_erp';创建或替换DIRECTORY scm AS'/ u01 / test / cons_dir / cap_scm';</pre></li>
                        <li>
                           <p>将重播目录设置为先前在步骤<a href="using-consolidated-database-replay.html#GUID-29988B63-F974-46EF-9AAD-3D04AF774337__CHDCFBIC">2中</a>创建的根目录：</p><pre class="oac_no_warn" dir="ltr">EXEC DBMS_WORKLOAD_REPLAY.SET_REPLAY_DIRECTORY（'CONS_WORKLOAD'）;</pre></li>
                        <li>
                           <p>创建重播计划并添加工作负载捕获：</p><pre class="oac_no_warn" dir="ltr">EXEC DBMS_WORKLOAD_REPLAY.BEGIN_REPLAY_SCHEDULE（'CONS_SCHEDULE'）; SELECT DBMS_WORKLOAD_REPLAY.ADD_CAPTURE（'CRM'）FROM dual; SELECT DBMS_WORKLOAD_REPLAY.ADD_CAPTURE（'ERP'）FROM dual; SELECT DBMS_WORKLOAD_REPLAY.ADD_CAPTURE（'SCM'）FROM dual; EXEC DBMS_WORKLOAD_REPLAY.END_REPLAY_SCHEDULE;</pre></li>
                        <li>
                           <p>初始化整合重播：</p><pre class="oac_no_warn" dir="ltr">EXEC DBMS_WORKLOAD_REPLAY.INITIALIZE_CONSOLIDATED_REPLAY（'CONS_REPLAY'，'CONS_SCHEDULE'）;</pre></li>
                        <li>
                           <p>重新映射连接：</p>
                           <ol type="a">
                              <li>
                                 <p>在<code class="codeph">DBA_WORKLOAD_CONNECTION_MAP</code>视图中查询连接映射信息：</p><pre class="oac_no_warn" dir="ltr">SELECT schedule_cap_id，conn_id，capture_conn，replay_conn FROM dba_workload_connection_map;</pre></li>
                              <li>
                                 <p>重新映射连接：</p><pre class="oac_no_warn" dir="ltr">EXEC DBMS_WORKLOAD_REPLAY.REMAP_CONNECTION（schedule_cap_id =&gt; 1，conn_id =&gt; 1，replay_connection =&gt;'CRM'）; EXEC DBMS_WORKLOAD_REPLAY.REMAP_CONNECTION（schedule_cap_id =&gt; 2，conn_id =&gt; 1，replay_connection =&gt;'ERP'）; EXEC DBMS_WORKLOAD_REPLAY.REMAP_CONNECTION（schedule_cap_id =&gt; 3，conn_id =&gt; 1，replay_connection =&gt;'SCM'）;</pre><p><code class="codeph">replay_connection</code>参数表示在测试系统上定义的服务。
                                 </p>
                              </li>
                              <li>
                                 <p>验证连接重映射：</p><pre class="oac_no_warn" dir="ltr">SELECT schedule_cap_id，conn_id，capture_conn，replay_conn FROM dba_workload_connection_map;</pre></li>
                           </ol>
                        </li>
                        <li>
                           <p>准备整合重播：</p><pre class="oac_no_warn" dir="ltr">EXEC DBMS_WORKLOAD_REPLAY.PREPARE_CONSOLIDATED_REPLAY（synchronization =&gt;'OBJECT_ID'）;</pre></li>
                        <li>
                           <p>开始重播客户：</p>
                           <ol type="a">
                              <li>
                                 <p>估计所需的重播客户端数量：</p><pre class="oac_no_warn" dir="ltr">wrc mode = calibrate replaydir = / u01 / test / cons_dir / cap_crm wrc mode = calibrate replaydir = / u01 / test / cons_dir / cap_erp wrc mode = calibrate replaydir = / u01 / test / cons_dir / cap_scm</pre></li>
                              <li>
                                 <p>添加输出以确定所需的重播客户端数。</p>
                                 <p>您需要在整合工作负载中包含的每个工作负载捕获中至少启动一个重播客户端。</p>
                              </li>
                              <li>
                                 <p>重复此命令启动所需数量的重播客户端：</p><pre class="oac_no_warn" dir="ltr">wrc <span class="italic">用户名</span> / <span class="italic">密码</span>模式=重播replaydir = / u01 / test / cons_dir</pre><p><code class="codeph">replaydir</code>参数设置为存储工作负载捕获的根目录。
                                 </p>
                              </li>
                           </ol>
                        </li>
                        <li>
                           <p>开始整合重播：</p><pre class="oac_no_warn" dir="ltr">EXEC DBMS_WORKLOAD_REPLAY.START_CONSOLIDATED_REPLAY;</pre></li>
                     </ol>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <div class="infoboxnotealso" id="GUID-29988B63-F974-46EF-9AAD-3D04AF774337__GUID-F9378433-DF10-42F0-A2EB-3F062B2776EE">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>有关配置CDB的信息，请参见<a href="../multi/creating-and-configuring-a-cdb.html#ADMIN13514" target="_blank"><span><cite>“Oracle数据库管理员指南”</cite></span></a></p>
                           </li>
                           <li>
                              <p>有关创建PDB的信息，请参见<a href="../admin/index.html" target="_blank"><span><cite>“Oracle数据库管理员指南”</cite></span></a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
         </div>
      </article>
   </body>
</html>