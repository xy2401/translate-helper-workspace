<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>创建元数据和分析工作区</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Java API Developer&#39;s Guide "></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Java API Developer&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="olap-java-api-developers-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-10T13:53:39-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2000, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96402-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="discovering-metadata.html" title="Previous" type="text/html"></link>
      <link rel="next" href="understanding-source-objects.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="OLAP Java API Developer&#39;s Guide"></meta>
    <meta name="dcterms.isVersionOf" content="OLAAP"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="discovering-metadata.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="understanding-source-objects.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Java API开发人员指南</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">创建元数据和分析工作区</li>
            </ol>
            <a id="GUID-67674127-304F-4F8A-BCA1-410C8CB4797E" name="GUID-67674127-304F-4F8A-BCA1-410C8CB4797E"></a><a id="OLAAP220"></a>
            
            <h2 id="OLAAP-GUID-67674127-304F-4F8A-BCA1-410C8CB4797E" class="sect2"><span class="enumeration_chapter">4</span>创建元数据和分析工作区</h2>
         </header>
         <div class="ind">
            <div>
               <p>本章介绍如何创建新的元数据对象并将其映射到关系结构或表达式。它描述了如何将元数据对象的定义导出和导入到XML模板。它还描述了如何将对象与分析工作区相关联，以及如何构建分析工作区。</p>
               <p>本章中的示例来自<code class="codeph">CreateMetadataAndAW.java</code>示例程序。该程序创建一些与<code class="codeph">CreateAndBuildAW.java</code>和<code class="codeph">SpecifyAWValues.java</code>示例程序相同的元数据对象。<code class="codeph">CreateMetadataAndAW</code>程序还将分析工作区导出到XML模板。
               </p>
               <p>本章包括以下主题：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="creating-metadata-and-analytic-workspaces.html#GUID-2A726D0C-2B7F-4E15-B594-348487D1BF28">创建和映射元数据概述</a></p>
                  </li>
                  <li>
                     <p><a href="creating-metadata-and-analytic-workspaces.html#GUID-8AD05B73-FBF3-4D2F-99F7-02E406BAEA0D">创建分析工作区</a></p>
                  </li>
                  <li>
                     <p><a href="creating-metadata-and-analytic-workspaces.html#GUID-83B7A4E9-430A-4B7D-8A18-10D6175FAE10">创建维度，级别和层次结构</a></p>
                  </li>
                  <li>
                     <p><a href="creating-metadata-and-analytic-workspaces.html#GUID-EA1BAC07-B64E-45CB-B0E9-74A2E2EE9FD3">创建属性</a></p>
                  </li>
                  <li>
                     <p><a href="creating-metadata-and-analytic-workspaces.html#GUID-3C6A8328-2BB6-43B7-86FB-2513B31DAABD">创建多维数据集和度量</a></p>
                  </li>
                  <li>
                     <p><a href="creating-metadata-and-analytic-workspaces.html#GUID-E79729DC-35F2-4A1F-975A-6DB9F91D7361">提交交易</a></p>
                  </li>
                  <li>
                     <p><a href="creating-metadata-and-analytic-workspaces.html#GUID-767D2EF6-AAC5-47DA-91A8-9D48AD90A279">导出和导入XML模板</a></p>
                  </li>
                  <li>
                     <p><a href="creating-metadata-and-analytic-workspaces.html#GUID-FBBE0DE5-B703-4CBD-9A1B-845AEFE5E640">构建分析工作区</a></p>
                  </li>
               </ul>
            </div><a id="OLAAP221"></a><div class="props_rev_3"><a id="GUID-2A726D0C-2B7F-4E15-B594-348487D1BF28" name="GUID-2A726D0C-2B7F-4E15-B594-348487D1BF28"></a><h3 id="OLAAP-GUID-2A726D0C-2B7F-4E15-B594-348487D1BF28" class="sect3"><span class="enumeration_section">4.1</span>创建和映射元数据概述</h3>
               <div>
                  <p><a id="d11910e126" class="indexterm-anchor"></a><a id="d11910e130" class="indexterm-anchor"></a> OLAP Java API提供了创建持久元数据对象的功能。顶级元数据对象存在于Oracle数据库实例的数据字典中。API还提供了创建仅在会话期间存在的临时元数据对象的功能。应用程序可以使用两种类型的元数据对象来创建检索或以其他方式使用数据存储中的数据的查询。
                  </p>
                  <p>在OLAP Java API应用程序可以创建元数据对象之前，数据库管理员必须已准备好Oracle数据库实例。DBA必须在数据库中设置永久和临时表空间以支持Oracle OLAP元数据对象的创建，并且必须已授予允许会话用户创建和管理对象的权限。维度元数据模型通常包括“ <a href="understanding-olap-java-api-metadata.html#GUID-8E4F4EC0-8EF8-4D2A-BBAE-6010021A6D1A" title="使用MdmDescription对象，您可以将描述性信息与MdmObject对象相关联。数据库用户拥有的关系模式由MdmDatabaseSchema对象表示。">了解OLAP Java API元数据”中</a>描述的对象。
                  </p>
                  <p>您可以通过创建OLAP Java API元数据对象来实现维模型。您可以使用<code class="codeph">oracle.olapi.metadata.mapping</code>包中的类将元数据对象映射到关系源对象并构建分析工作区。您可以使用<code class="codeph">oracle.olapi.syntax</code>包中的类来指定在映射元数据时使用的<code class="codeph">Expression</code>对象。您可以使用<code class="codeph">oracle.olapi.metadata.deployment</code>包中的类在分析工作区或关系数据库（ROLAP）组织中部署元数据对象。
                  </p>
                  <p>在分析工作区中将维模型实现为OLAP Java API对象的基本步骤如下：</p>
                  <ol>
                     <li>
                        <p>创建一个<code class="codeph">AW</code>对象和<code class="codeph">MdmPrimaryDimension</code>和<code class="codeph">MdmCube</code>对象。
                        </p>
                     </li>
                     <li>
                        <p>将<code class="codeph">MdmPrimaryDimension</code>和<code class="codeph">MdmCube</code>对象部署到<code class="codeph">AW</code> 。</p>
                     </li>
                     <li>
                        <p>为每个<code class="codeph">MdmPrimaryDimension</code>创建<code class="codeph">MdmDimensionLevel</code> ， <code class="codeph">MdmHierarchy</code>和<code class="codeph">MdmAttribute</code>对象，创建<code class="codeph">MdmHierarchyLevel</code>对象以将<code class="codeph">MdmDimensionLevel</code>对象与<code class="codeph">MdmHierarchy</code> ，并为<code class="codeph">MdmCube</code>对象创建<code class="codeph">MdmMeasure</code>和相关对象。
                        </p>
                     </li>
                     <li>
                        <p>将元数据对象映射到基础数据的关系源。</p>
                     </li>
                     <li>
                        <p>提交<code class="codeph">Transaction</code> ，它在数据库中创建持久对象。
                        </p>
                     </li>
                     <li>
                        <p>通过构建分析工作区将数据从关系源加载到对象中。</p>
                     </li>
                  </ol>
                  <p>有关描述这些步骤的主题列表，请参阅<a href="creating-metadata-and-analytic-workspaces.html#GUID-67674127-304F-4F8A-BCA1-410C8CB4797E">创建元数据和分析工作区</a> 。
                  </p>
               </div>
            </div><a id="OLAAP223"></a><a id="OLAAP222"></a><div class="props_rev_3"><a id="GUID-8AD05B73-FBF3-4D2F-99F7-02E406BAEA0D" name="GUID-8AD05B73-FBF3-4D2F-99F7-02E406BAEA0D"></a><h3 id="OLAAP-GUID-8AD05B73-FBF3-4D2F-99F7-02E406BAEA0D" class="sect3"><span class="enumeration_section">4.2</span>创建分析工作区</h3>
               <div>
                  <div class="section">
                     <p><a id="d11910e281" class="indexterm-anchor"></a><a id="d11910e285" class="indexterm-anchor"></a><a id="d11910e289" class="indexterm-anchor"></a>分析工作区是维对象的容器。它由<code class="codeph">oracle.olapi.metadata.deployment</code>包中的<code class="codeph">AW</code>类表示。分析工作区由<code class="codeph">MdmDatabaseSchema</code>拥有。
                     </p>
                     <p><a id="d11910e304" class="indexterm-anchor"></a><a id="d11910e308" class="indexterm-anchor"></a> <a href="creating-metadata-and-analytic-workspaces.html#GUID-8AD05B73-FBF3-4D2F-99F7-02E406BAEA0D__BABGHIJF">示例4-1</a>演示了为GLOBAL用户获取<code class="codeph">MdmDatabaseSchema</code>并创建<code class="codeph">AW</code> 。有关获取<code class="codeph">MdmRootSchema</code>的示例，请参阅<a href="discovering-metadata.html#GUID-0F34DAE9-AD90-4107-A14D-4DA29A13A369">发现元数据</a> 。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-8AD05B73-FBF3-4D2F-99F7-02E406BAEA0D__BABGHIJF">
                     <p class="titleinexample">例4-1创建AW</p><pre class="oac_no_warn" dir="ltr">private void createAW（MdmRootSchema mdmRootSchema）{MdmDatabaseSchema mdmDBSchema = mdmRootSchema.getDatabaseSchema（“GLOBAL”）; aw = mdmDBSchema.findOrCreateAW（“GLOBAL_AWJ”）; }</pre></div>
                  <!-- class="example" -->
               </div>
            </div><a id="OLAAP224"></a><div class="props_rev_3"><a id="GUID-83B7A4E9-430A-4B7D-8A18-10D6175FAE10" name="GUID-83B7A4E9-430A-4B7D-8A18-10D6175FAE10"></a><h3 id="OLAAP-GUID-83B7A4E9-430A-4B7D-8A18-10D6175FAE10" class="sect3"><span class="enumeration_section">4.3</span>创建维，级别和层次结构</h3>
               <div>
                  <p><a id="d11910e368" class="indexterm-anchor"></a><a id="d11910e372" class="indexterm-anchor"></a><a id="d11910e376" class="indexterm-anchor"></a><a id="d11910e380" class="indexterm-anchor"></a>维度是标识和分类数据的唯一值列表。尺寸构成立方体的边缘，并标识立方体度量中的值。维度可以具有一个或多个级别，用于对维度成员进行分类。它可以有一个或多个层次结构，进一步对成员进行分类。维度也可以没有级别或层次结构。但是，在Oracle OLAP可以为其创建实例化视图之前，维度必须具有一个或多个级别。
                  </p>
                  <p>维度还包含包含维度成员信息的属性。有关创建属性的说明，请参阅<span class="q">“ <a href="creating-metadata-and-analytic-workspaces.html#GUID-EA1BAC07-B64E-45CB-B0E9-74A2E2EE9FD3">创建属性</a> ”</span> 。
                  </p>
                  <p>以下主题描述如何创建表示维度的对象以及维度的级别和层次结构。</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="creating-metadata-and-analytic-workspaces.html#GUID-AFF38664-59EF-47FC-A503-FCFB689510C1">创建和映射维度</a></p>
                     </li>
                     <li>
                        <p><a href="creating-metadata-and-analytic-workspaces.html#GUID-36EF8BE6-12A1-4ED8-B664-57C8C2DB08F0">创建和映射维度级别</a></p>
                     </li>
                     <li>
                        <p><a href="creating-metadata-and-analytic-workspaces.html#GUID-962D8275-96D9-493D-8398-6691EBBEDB23">创建和映射层次结构</a></p>
                     </li>
                  </ul>
               </div><a id="OLAAP226"></a><a id="OLAAP225"></a><div class="props_rev_3"><a id="GUID-AFF38664-59EF-47FC-A503-FCFB689510C1" name="GUID-AFF38664-59EF-47FC-A503-FCFB689510C1"></a><h4 id="OLAAP-GUID-AFF38664-59EF-47FC-A503-FCFB689510C1" class="sect4"><span class="enumeration_section">4.3.1</span>创建和映射维度</h4>
                  <div>
                     <div class="section">
                        <p><a id="d11910e448" class="indexterm-anchor"></a><a id="d11910e452" class="indexterm-anchor"></a><a id="d11910e456" class="indexterm-anchor"></a><a id="d11910e460" class="indexterm-anchor"></a> OLAP维度由<code class="codeph">MdmPrimaryDimension</code>类表示。维度由<code class="codeph">MdmDatabaseSchema</code>拥有。您创建一个维度<code class="codeph">findOrCreateTimeDimension</code>或<code class="codeph">findOrCreateStandardDimension</code>的方法<code class="codeph">MdmDatabaseSchema</code> 。您可以通过为维创建<code class="codeph">MemberListMap</code> ，将没有级别的维度映射到关系数据源。
                        </p>
                        <p><a id="d11910e485" class="indexterm-anchor"></a><a id="d11910e489" class="indexterm-anchor"></a> <a href="creating-metadata-and-analytic-workspaces.html#GUID-AFF38664-59EF-47FC-A503-FCFB689510C1__BABEACAJ">例4-2</a>创建了一个名为CHANNEL_AWJ的标准维。该示例创建一个<code class="codeph">AWPrimaryDimensionOrganization</code>对象，以在分析工作区中部署维度。<code class="codeph">mdmDBSchema</code>和<code class="codeph">aw</code>对象由<a href="creating-metadata-and-analytic-workspaces.html#GUID-8AD05B73-FBF3-4D2F-99F7-02E406BAEA0D__BABGHIJF">例4-1</a>创建。最后三行分别调用<a href="creating-metadata-and-analytic-workspaces.html#GUID-36EF8BE6-12A1-4ED8-B664-57C8C2DB08F0__BABDJEDC">例4-3</a> ， <a href="creating-metadata-and-analytic-workspaces.html#GUID-EFF7B8CF-44A2-464D-905B-4AD086345A81__BABHDHDG">例4-4</a>和<a href="creating-metadata-and-analytic-workspaces.html#GUID-E79729DC-35F2-4A1F-975A-6DB9F91D7361__BABDCDHH">例4-9的方法</a> 。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-AFF38664-59EF-47FC-A503-FCFB689510C1__BABEACAJ">
                        <p class="titleinexample">示例4-2创建和部署MdmStandardDimension</p><pre class="oac_no_warn" dir="ltr">MdmStandardDimension mdmChanDim = mdmDBSchema.findOrCreateStandardDimension（“CHANNEL_AWJ”）; AWPrimaryDimensionOrganization awChanDimOrg = mdmChanDim.findOrCreateAWPrimaryDimensionOrganization（aw）; createAndMapDimensionLevels（mdmChanDim）; createAndMapHierarchies（）;提交（mdmChanDim）;</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="OLAAP228"></a><a id="OLAAP227"></a><div class="props_rev_3"><a id="GUID-36EF8BE6-12A1-4ED8-B664-57C8C2DB08F0" name="GUID-36EF8BE6-12A1-4ED8-B664-57C8C2DB08F0"></a><h4 id="OLAAP-GUID-36EF8BE6-12A1-4ED8-B664-57C8C2DB08F0" class="sect4"><span class="enumeration_section">4.3.2</span>创建和映射维度级别</h4>
                  <div>
                     <div class="section">
                        <p><a id="d11910e556" class="indexterm-anchor"></a><a id="d11910e560" class="indexterm-anchor"></a><a id="d11910e564" class="indexterm-anchor"></a><a id="d11910e568" class="indexterm-anchor"></a><a id="d11910e572" class="indexterm-anchor"></a><a id="d11910e576" class="indexterm-anchor"></a><a id="d11910e580" class="indexterm-anchor"></a> <code class="codeph">MdmDimensionLevel</code>表示处于同一级别的维度的成员。通常，级别的成员位于关系源中的维度表中的列中。<code class="codeph">MemberListMap</code>将<code class="codeph">MdmDimensionLevel</code>与关系源相关联。
                        </p>
                        <p><a id="d11910e596" class="indexterm-anchor"></a><a id="d11910e600" class="indexterm-anchor"></a><a id="d11910e604" class="indexterm-anchor"></a><a id="d11910e608" class="indexterm-anchor"></a><a id="d11910e612" class="indexterm-anchor"></a><a id="d11910e616" class="indexterm-anchor"></a><a id="d11910e620" class="indexterm-anchor"></a><a id="d11910e624" class="indexterm-anchor"></a><a id="d11910e628" class="indexterm-anchor"></a> <a href="creating-metadata-and-analytic-workspaces.html#GUID-36EF8BE6-12A1-4ED8-B664-57C8C2DB08F0__BABDJEDC">示例4-3</a>为CHANNEL_AWJ维度创建了两个<code class="codeph">MdmDimensionLevel</code>对象，并将维度级别映射到GLOBAL.CHANNEL_DIM表的键列。该示例还将维度级别的长描述属性映射到该表的列。长描述属性<code class="codeph">chanLongDescAttr</code>由<a href="creating-metadata-and-analytic-workspaces.html#GUID-EA1BAC07-B64E-45CB-B0E9-74A2E2EE9FD3__BABEHBJF">例4-6</a>创建。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-36EF8BE6-12A1-4ED8-B664-57C8C2DB08F0__BABDJEDC">
                        <p class="titleinexample">示例4-3创建和映射MdmDimensionLevel</p><pre class="oac_no_warn" dir="ltr">private ArrayList &lt;MdmDimensionLevel&gt; dimLevelList = new ArrayList（）; private ArrayList &lt;String&gt; dimLevelNames = new ArrayList（）; private ArrayList &lt;String&gt; keyColumns = new ArrayList（）; private ArrayList &lt;String&gt; lDescColNames = new ArrayList（）; private void createAndMapDimensionLevels（MdmPrimaryDimension mdmChanDim）{dimLevelNames.add（“TOTAL_CHANNEL”）; dimLevelNames.add（ “信道”）; keyColumns.add（ “GLOBAL.CHANNEL_DIM.TOTAL_ID”）; keyColumns.add（ “GLOBAL.CHANNEL_DIM.CHANNEL_ID”）; lDescColNames.add（ “GLOBAL.CHANNEL_DIM.TOTAL_DSC”）; lDescColNames.add（ “GLOBAL.CHANNEL_DIM.CHANNEL_DSC”）; //创建MdmDimensionLevel和MemberListMap对象。int i = 0; for（String dimLevelName：dimLevelNames）{ <a id="d11910e648" class="indexterm-anchor"></a> MdmDimensionLevel mdmDimLevel = mdmChanDim.findOrCreateDimensionLevel（dimLevelNames.get（i））; dimLevelList.add（mdmDimLevel）; //为维度级别创建MemberListMap。MemberListMap mdmDimLevelMemListMap = mdmDimLevel.findOrCreateMemberListMap（）; ColumnExpression keyColExp =（ColumnExpression）SyntaxObject.fromSyntax（keyColumns.get（i），metadataProvider）; mdmDimLevelMemListMap.setKeyExpression（keyColExp）; mdmDimLevelMemListMap.setQuery（keyColExp.getQuery（））; //为Long Description属性创建属性映射。
<a id="d11910e653" class="indexterm-anchor"></a> AttributeMap attrMapLong = mdmDimLevelMemListMap.findOrCreateAttributeMap（chanLongDescAttr）; //为属性映射创建表达式。表达式lDescColExp =（表达式）SyntaxObject.fromSyntax（lDescColNames.get（i），metadataProvider）; attrMapLong.setExpression（lDescColExp）;我++; }}</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="OLAAP229"></a><div class="props_rev_3"><a id="GUID-962D8275-96D9-493D-8398-6691EBBEDB23" name="GUID-962D8275-96D9-493D-8398-6691EBBEDB23"></a><h4 id="OLAAP-GUID-962D8275-96D9-493D-8398-6691EBBEDB23" class="sect4"><span class="enumeration_section">4.3.3</span>创建和映射层次结构</h4>
                  <div>
                     <p><a id="d11910e694" class="indexterm-anchor"></a><a id="d11910e698" class="indexterm-anchor"></a><a id="d11910e702" class="indexterm-anchor"></a><a id="d11910e706" class="indexterm-anchor"></a><a id="d11910e710" class="indexterm-anchor"></a><a id="d11910e714" class="indexterm-anchor"></a><a id="d11910e718" class="indexterm-anchor"></a> <code class="codeph">MdmHierarchy</code>表示维对象模型中的层次结构。<code class="codeph">MdmHierarchy</code>可以是<code class="codeph">MdmLevelHierarchy</code>或<code class="codeph">MdmValueHierarchy</code>类的实例。<code class="codeph">MdmLevelHierarchy</code>具有<code class="codeph">MdmHierarchyLevel</code>对象的有序列表， <code class="codeph">MdmHierarchyLevel</code>对象将<code class="codeph">MdmDimensionLevel</code>对象与层次结构相关<code class="codeph">MdmDimensionLevel</code> 。
                     </p>
                  </div><a id="OLAAP231"></a><a id="OLAAP230"></a><div class="props_rev_3"><a id="GUID-EFF7B8CF-44A2-464D-905B-4AD086345A81" name="GUID-EFF7B8CF-44A2-464D-905B-4AD086345A81"></a><h5 id="OLAAP-GUID-EFF7B8CF-44A2-464D-905B-4AD086345A81" class="sect5"><span class="enumeration_section">4.3.3.1</span>创建和映射MdmLevelHierarchy</h5>
                     <div>
                        <div class="section">
                           <p><a href="creating-metadata-and-analytic-workspaces.html#GUID-EFF7B8CF-44A2-464D-905B-4AD086345A81__BABHDHDG">示例4-4</a>为CHANNEL_AWJ维创建层次结构。它为层次结构创建层次结构级别，并将属性与层次结构级别相关联。它还将层次结构级别和属性映射到关系源。该示例使用<a href="creating-metadata-and-analytic-workspaces.html#GUID-36EF8BE6-12A1-4ED8-B664-57C8C2DB08F0__BABDJEDC">示例4-3中</a>的<code class="codeph">ArrayList</code>对象。它的映射<code class="codeph">MdmHierarchyLevel</code>为对象，相同的关系源对象<code class="codeph">MdmDimensionLevel</code>对象映射。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-EFF7B8CF-44A2-464D-905B-4AD086345A81__BABHDHDG">
                           <p class="titleinexample">示例4-4创建和映射MdmLevelHierarchy和MdmHierarchyLevel对象</p><pre class="oac_no_warn" dir="ltr">private void createAndMapHierarchies（）{MdmLevelHierarchy mdmLevelHier = mdmChanDim.findOrCreateLevelHierarchy（“CHANNEL_PRIMARY”）; //创建MdmHierarchyLevel和HierarchyLevelMap对象。int i = 0; for（String dimLevelName：dimLevelNames）{MdmDimensionLevel mdmDimLevel = mdmChanDim.findOrCreateDimensionLevel（dimLevelName）; MdmHierarchyLevel mdmHierLevel = <a id="d11910e801" class="indexterm-anchor"></a> mdmLevelHier.findOrCreateHierarchyLevel（mdmDimLevel）; HierarchyLevelMap hierLevelMap = mdmHierLevel.findOrCreateHierarchyLevelMap（）; ColumnExpression keyColExp =（ColumnExpression）SyntaxObject.fromSyntax（keyColumns.get（i），metadataProvider）; hierLevelMap.setKeyExpression（keyColExp）; hierLevelMap.setQuery（keyColExp.getQuery（））;我++; }}</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="OLAAP233"></a><a id="OLAAP232"></a><div class="props_rev_3"><a id="GUID-9F97D203-9DDC-4726-83E7-F22F41C00538" name="GUID-9F97D203-9DDC-4726-83E7-F22F41C00538"></a><h5 id="OLAAP-GUID-9F97D203-9DDC-4726-83E7-F22F41C00538" class="sect5"><span class="enumeration_section">4.3.3.2</span>创建和映射MdmValueHierarchy</h5>
                     <div>
                        <div class="section">
                           <p><a id="d11910e844" class="indexterm-anchor"></a>本文档中的示例使用的GLOBAL_AWJ分析工作区没有<code class="codeph">MdmPrimaryDimension</code> ， <code class="codeph">MdmValueHierarchy</code>来说是明智的。用户<code class="codeph">SCOTT</code>的示例模式有一个表可以作为示例。
                           </p>
                           <p>SCOTT示例模式有一个名为EMP的表。该表包含员工和经理的列。您可以为员工创建维度。然后，您可以创建一个<code class="codeph">MdmValueHierarchy</code>在该层中将employee列映射为层次结构的基本值，并将manager列映射为父关系，如<a href="creating-metadata-and-analytic-workspaces.html#GUID-9F97D203-9DDC-4726-83E7-F22F41C00538__BABDCIBA">例4-5</a>所示。为了能够创建OLAP维度，必须为SCOTT用户授予<code class="codeph">OLAP_USER</code>角色和<code class="codeph">CREATE SESSION</code>权限。
                           </p>
                           <p><a id="d11910e872" class="indexterm-anchor"></a>在示例中， <code class="codeph">mdmDBSchema</code>是SCOTT用户的<code class="codeph">MdmDatabaseSchema</code> ， <code class="codeph">dp</code>是<code class="codeph">DataProvider</code> ， <code class="codeph">mp</code>是<code class="codeph">MdmMetadataProvider</code> 。该示例未显示用于连接到数据库或获取<code class="codeph">DataProvider</code>并创建<code class="codeph">UserSession</code>或获取<code class="codeph">MdmMetadataProvider</code> ， <code class="codeph">MdmRootSchema</code>或<code class="codeph">MdmDatabaseSchema</code> 。该代码是扩展<code class="codeph">BaseExample11g</code>示例类的类的摘录。该类使用其他示例类，这些类具有提交当前<code class="codeph">Transaction</code>和显示输出的方法。有关完整代码，请参阅<code class="codeph">CreateValueHierarchy.java</code>示例程序。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-9F97D203-9DDC-4726-83E7-F22F41C00538__BABDCIBA">
                           <p class="titleinexample">示例4-5创建MdmValueHierarchy</p><pre class="oac_no_warn" dir="ltr">//创建分析工作区对象。AW aw = mdmDBSchema.findOrCreateAW（awName）; //创建维度并将其部署到分析工作区。MdmPrimaryDimension mdmEmpDim = mdmDBSchema.findOrCreateStandardDimension（“EMP_DIM”）; AWPrimaryDimensionOrganization awEmpDimOrg = mdmEmpDim.findOrCreateAWPrimaryDimensionOrganization（aw）; //获取EMP表和表的查询。MdmTable empTable =（MdmTable）mdmDBSchema.getTopLevelObject（“EMP”）;查询empQuery = empTable.getQuery（）; //创建值层次结构。MdmValueHierarchy mdmValHier = mdmEmpDim.findOrCreateValueHierarchy（“EMPVALHIER”）; //为层次结构创建地图。SolvedValueHierarchyMap solveValHierMap = mdmValHier.findOrCreateSolvedValueHierarchyMap（）; //为层次结构指定Query，键表达式和父键表达式。solvedValHierMap.setQuery（empQuery）;表达式keyExp =（Expression）SyntaxObject.fromSyntax（“SCOTT.EMP.EMPNO”，mp）; solvedValHierMap.setKeyExpression（keyExp）;表达式parentExp =（Expression）SyntaxObject.fromSyntax（“SCOTT.EMP.MGR”，mp）; solvedValHierMap.setParentKeyExpression（parentExp）; //创建一个将名称与每个维度成员相关联的属性。MdmBaseAttribute mdmNameAttr = mdmEmpDim.findOrCreateBaseAttribute（“EMP_NAME”）; SQLDataType sdtVC2 = new SQLDataType（“VARCHAR2”）; mdmNameAttr.setSQLDataType（sdtVC2）//为属性创建属性映射。AttributeMap attrMap = solveValHierMap.findOrCreateAttributeMap（mdmNameAttr）; //为属性映射创建并设置表达式。表达式exp =（表达式）SyntaxObject.fromSyntax（“SCOTT.EMP.ENAME”，mp）; attrMap.setExpression（EXP）; mdmValHier.addAttribute（mdmNameAttr）; //在构建分析工作区之前提交事务。// BaseExample11g的getContext方法返回一个Context11g对象，//有一个提交Transaction的方法。的getContext（）提交（）; BuildItem bldEmpDim = new BuildItem（mdmEmpDim）; ArrayList &lt;BuildItem&gt; items = new ArrayList（）; items.add（bldEmpDim）; BuildProcess bldProc = new BuildProcess（items）; //执行构建。试试{dp.executeBuild（bldProc，0）; } catch（Exception ex）{println（“无法执行BuildProcess。”）; println（“Caught：”+ ex）; } //获取维度，层次结构和属性的Source对象。源empDim = mdmEmpDim.getSource（）;来源valHier = mdmValHier.getSource（）;源empNameAttr = mdmNameAttr.getSource（）; //获取父属性并获取它的Source。MdmAttribute mdmParentAttr = mdmEmpDim.getParentAttribute（）;源parentAttr = mdmParentAttr.getSource（）;源parentByEmpByName = parentAttr.join（valHier.join（empNameAttr））; //按管理员的员工编号按升序对值排序。Source sortedParentByEmpByName = parentByEmpByName.sortAscending（）; //在创建Cursor之前提交事务。的getContext（）提交（）; // Context11g对象的displayResult方法创建一个Cursor，//显示结果。println（“员工的经理是：”）; 。的getContext（）displayResult（sortedParentByEmpByName）;</pre><p>该示例的输出如下。它显示员工姓名，员工ID，然后显示经理的员工ID。结果按经理排序。员工King没有父级，并且是层次结构中的最高成员，因此King的管理器值为null，在输出中显示为<code class="codeph">NA</code> 。
                           </p><pre class="oac_no_warn" dir="ltr">员工的经理是：1：（（SCOTT，EMPVALHIER :: 7788），EMPVALHIER :: 7566）2 :(（FORD，EMPVALHIER :: 7902），EMPVALHIER :: 7566）3 :(（ALLEN，EMPVALHIER :: 7499），EMPVALHIER :: 7698）4：（（WARD，EMPVALHIER :: 7521），EMPVALHIER :: 7698）5：（（MARTIN，EMPVALHIER :: 7654），EMPVALHIER :: 7698）6：（（TURNER，EMPVALHIER： ：7844），EMPVALHIER :: 7698）7：（（JAMES，EMPVALHIER :: 7900），EMPVALHIER :: 7698）8：（（MILLER，EMPVALHIER :: 7934），EMPVALHIER :: 7782）9：（（ADAMS，EMPVALHIER） :: 7876），EMPVALHIER :: 7788）10：（（JONES，EMPVALHIER :: 7566），EMPVALHIER :: 7839）11 :(（BLAKE，EMPVALHIER :: 7698），EMPVALHIER :: 7839）12：（（CLARK， EMPVALHIER :: 7782），EMPVALHIER :: 7839）13：（（SMITH，EMPVALHIER :: 7369），EMPVALHIER :: 7902）14：（（KING，EMPVALHIER :: 7839），NA）</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div>
               </div>
            </div><a id="OLAAP235"></a><a id="OLAAP234"></a><div class="props_rev_3"><a id="GUID-EA1BAC07-B64E-45CB-B0E9-74A2E2EE9FD3" name="GUID-EA1BAC07-B64E-45CB-B0E9-74A2E2EE9FD3"></a><h3 id="OLAAP-GUID-EA1BAC07-B64E-45CB-B0E9-74A2E2EE9FD3" class="sect3"><span class="enumeration_section">4.4</span>创建属性</h3>
               <div>
                  <div class="section">
                     <p>属性包含有关维度成员的信息。<code class="codeph">MdmBaseAttribute</code>表示基于关系源表的值。<code class="codeph">MdmDerivedAttribute</code>表示Oracle OLAP从维度成员的特征或关系派生的值。例如， <code class="codeph">MdmPrimaryDimension</code>的<code class="codeph">getParentAttribute</code>方法返回一个<code class="codeph">MdmDerivedAttribute</code> ，它记录每个维度成员的父级。
                     </p>
                     <p><a id="d11910e986" class="indexterm-anchor"></a><a id="d11910e990" class="indexterm-anchor"></a><a id="d11910e994" class="indexterm-anchor"></a>使用<code class="codeph">findOrCreateBaseAttribute</code>方法为维创建基本属性。您可以指定属性的数据类型，但对于许多属性，Oracle OLAP可以从属性映射中确定数据类型。使用<code class="codeph">setAllowAutoDataTypeChange</code>方法，您可以指定Oracle OLAP确定数据类型。维度以某些方式使用某些属性，例如提供维度成员的描述或提供可用于计算的日期信息。例如，您可以使用维度的<code class="codeph">setValueDescriptionAttribute</code>方法为描述指定属性，并且可以使用<code class="codeph">setEndDateAttribute</code>方法指定包含结束日期时间段值的<code class="codeph">MdmTimeDimension</code> 。
                     </p>
                     <p><a id="d11910e1016" class="indexterm-anchor"></a><a id="d11910e1020" class="indexterm-anchor"></a><a id="d11910e1024" class="indexterm-anchor"></a> <a href="creating-metadata-and-analytic-workspaces.html#GUID-EA1BAC07-B64E-45CB-B0E9-74A2E2EE9FD3__BABEHBJF">示例4-6</a>为CHANNEL_AWJ维度创建长描述属性，并将其指定为包含维度成员描述的属性。该示例指定Oracle OLAP自动确定属性的SQL数据类型。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-EA1BAC07-B64E-45CB-B0E9-74A2E2EE9FD3__BABEHBJF">
                     <p class="titleinexample">示例4-6创建MdmBaseAttribute</p><pre class="oac_no_warn" dir="ltr">private MdmBaseAttribute chanLongDescAttr = null; private void createLongDesciptionAttribute（MdmPrimaryDimension mdmChanDim）{//创建长描述属性并允许自动更改// SQL数据类型。chanLongDescAttr = mdmChanDim.findOrCreateBaseAttribute（“LONG_DESCRIPTION”）; chanLongDescAttr.setAllowAutoDataTypeChange（真））; //指定该属性包含维成员的描述。mdmChanDim.setValueDescriptionAttribute（chanLongDescAttr）; }</pre><p><a id="d11910e1036" class="indexterm-anchor"></a><a id="d11910e1040" class="indexterm-anchor"></a><a id="d11910e1044" class="indexterm-anchor"></a>属性可以具有不同维度级别的成员的不同值。在这种情况下，该属性具有每个级别的属性映射。<a href="creating-metadata-and-analytic-workspaces.html#GUID-36EF8BE6-12A1-4ED8-B664-57C8C2DB08F0__BABDJEDC">实施例4-3</a>将创建一个<code class="codeph">AttributeMap</code>通过调用用于每个维度电平的长描述属性<code class="codeph">findOrCreateAttributeMap</code>所述的方法<code class="codeph">MemberListMap</code>针对每个维度的水平。它为每个属性映射指定不同的列。
                     </p>
                  </div>
                  <!-- class="example" -->
               </div>
            </div><a id="OLAAP236"></a><div class="props_rev_3"><a id="GUID-3C6A8328-2BB6-43B7-86FB-2513B31DAABD" name="GUID-3C6A8328-2BB6-43B7-86FB-2513B31DAABD"></a><h3 id="OLAAP-GUID-3C6A8328-2BB6-43B7-86FB-2513B31DAABD" class="sect3"><span class="enumeration_section">4.5</span>创建多维数据集和度量</h3>
               <div>
                  <p>维度对象模型中的立方体由<code class="codeph">MdmCube</code>类表示。<code class="codeph">MdmCube</code>拥有一个或多个<code class="codeph">MdmMeasure</code>对象。它有一个<code class="codeph">MdmPrimaryDimension</code>对象列表，用于<code class="codeph">MdmPrimaryDimension</code>度量。
                  </p>
                  <p><code class="codeph">MdmCube</code>具有与之关联的以下对象。
                  </p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><code class="codeph">MdmPrimaryDimension</code>对象，用于指定多维数据集的维度。
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">MdmMeasure</code>对象包含由维度标识的数据。
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">CubeOrganization</code> ，指定多维数据集如何存储和管理度量数据。
                        </p>
                     </li>
                     <li>
                        <p>将多维数据集与关系源关联的<code class="codeph">CubeMap</code>对象。
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">ConsistentSolveSpecification</code> ，指定如何计算或求解聚合级别数据。
                        </p>
                     </li>
                  </ul>
                  <p>以下示例演示了如何创建和映射多维数据集及其度量。</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="creating-metadata-and-analytic-workspaces.html#GUID-62FDFA22-A3BA-47B9-84BE-383A2351ADBE">创建多维数据集</a></p>
                     </li>
                     <li>
                        <p><a href="creating-metadata-and-analytic-workspaces.html#GUID-C04F33E1-5FB8-41A1-90CC-C27D026D00A0">创建和映射措施</a></p>
                     </li>
                  </ul>
               </div><a id="OLAAP238"></a><a id="OLAAP237"></a><div class="props_rev_3"><a id="GUID-62FDFA22-A3BA-47B9-84BE-383A2351ADBE" name="GUID-62FDFA22-A3BA-47B9-84BE-383A2351ADBE"></a><h4 id="OLAAP-GUID-62FDFA22-A3BA-47B9-84BE-383A2351ADBE" class="sect4"><span class="enumeration_section">4.5.1</span>创建多维数据集</h4>
                  <div>
                     <div class="example" id="GUID-62FDFA22-A3BA-47B9-84BE-383A2351ADBE__BABHHCBI">
                        <p class="titleinexample">示例4-7创建和映射MdmCube</p>
                        <p><a id="d11910e1192" class="indexterm-anchor"></a><a id="d11910e1196" class="indexterm-anchor"></a><a id="d11910e1200" class="indexterm-anchor"></a><a id="d11910e1204" class="indexterm-anchor"></a><a id="d11910e1208" class="indexterm-anchor"></a>此示例创建一个多维数据集以及与之关联的一些对象。它创建了一个<code class="codeph">MdmCube</code>其名称PRICE_CUBE_AWJ。它还会创建一个<code class="codeph">AWCubeOrganization</code>对象，以在分析工作区中部署多维数据集。<a href="creating-metadata-and-analytic-workspaces.html#GUID-8AD05B73-FBF3-4D2F-99F7-02E406BAEA0D__BABGHIJF">示例4-1</a>创建了<code class="codeph">mdmDBSchema</code>和<code class="codeph">aw</code>对象，并在<a href="creating-metadata-and-analytic-workspaces.html#GUID-EFF7B8CF-44A2-464D-905B-4AD086345A81__BABHDHDG">示例4-4中</a>创建了<code class="codeph">leafLevel</code> <code class="codeph">ArrayList</code> 。<code class="codeph">mdmTimeDim</code>和<code class="codeph">mdmProdDim</code>对象是时间段和产品类别的维度。<code class="codeph">CreateAndBuildAW</code>程序创建这些维度。该示例的最后几行分别调用<a href="creating-metadata-and-analytic-workspaces.html#GUID-C04F33E1-5FB8-41A1-90CC-C27D026D00A0__BABICJFH">示例4-8</a>和<a href="creating-metadata-and-analytic-workspaces.html#GUID-E79729DC-35F2-4A1F-975A-6DB9F91D7361__BABDCDHH">示例4-9中</a>的方法。
                        </p><pre class="oac_no_warn" dir="ltr">private MdmCube createAndMapCube（MdmPrimaryDimension mdmTimeDim，MdmPrimaryDimension mdmProdDim）{ <a id="d11910e1252" class="indexterm-anchor"></a> MdmCube mdmPriceCube = mdmDBSchema.findOrCreateCube（“PRICE_CUBE_AWJ”）; //向多维数据集添加维度。mdmPriceCube.addDimension（mdmTimeDim）; mdmPriceCube.addDimension（mdmProdDim）; <a id="d11910e1257" class="indexterm-anchor"></a> AWCubeOrganization awCubeOrg = mdmPriceCube.findOrCreateAWCubeOrganization（aw）; awCubeOrg.setMVOption（AWCubeOrganization。NONE_MV_OPTION）; awCubeOrg.setMeasureStorage（AWCubeOrganization。SHARED_MEASURE_STORAGE）; awCubeOrg.setCubeStorageType（ “NUMBER”）; AggregationCommand aggCommand = new AggregationCommand（“AVG”）; ArrayList &lt;ConsistentSolveCommand&gt; solveCommands = new ArrayList（）; solveCommands.add（aggCommand）; ConsistentSolveSpecification conSolveSpec = new ConsistentSolveSpecification（solveCommands）; <a id="d11910e1262" class="indexterm-anchor"></a> mdmPriceCube.setConsistentSolveSpecification（conSolveSpec）; //创建并映射多维数据集的度量。createAndMapMeasures（mdmPriceCube）; //提交交易。提交（mdmPriceCube）; }</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="OLAAP240"></a><a id="OLAAP239"></a><div class="props_rev_3"><a id="GUID-C04F33E1-5FB8-41A1-90CC-C27D026D00A0" name="GUID-C04F33E1-5FB8-41A1-90CC-C27D026D00A0"></a><h4 id="OLAAP-GUID-C04F33E1-5FB8-41A1-90CC-C27D026D00A0" class="sect4"><span class="enumeration_section">4.5.2</span>创建和映射措施</h4>
                  <div>
                     <div class="example" id="GUID-C04F33E1-5FB8-41A1-90CC-C27D026D00A0__BABICJFH">
                        <p class="titleinexample">示例4-8创建和映射度量</p>
                        <p><a id="d11910e1307" class="indexterm-anchor"></a><a id="d11910e1311" class="indexterm-anchor"></a><a id="d11910e1315" class="indexterm-anchor"></a><a id="d11910e1319" class="indexterm-anchor"></a><a id="d11910e1323" class="indexterm-anchor"></a><a id="d11910e1327" class="indexterm-anchor"></a><a id="d11910e1331" class="indexterm-anchor"></a><a id="d11910e1335" class="indexterm-anchor"></a><a id="d11910e1339" class="indexterm-anchor"></a><a id="d11910e1343" class="indexterm-anchor"></a><a id="d11910e1347" class="indexterm-anchor"></a>此示例为多维数据集创建度量，并将度量映射到关系数据库中的事实表。该示例使用<a href="creating-metadata-and-analytic-workspaces.html#GUID-62FDFA22-A3BA-47B9-84BE-383A2351ADBE__BABHHCBI">示例4-7</a>创建的多维数据集。
                        </p><pre class="oac_no_warn" dir="ltr">private void createAndMapMeasures（MdmCube mdmPriceCube）{ArrayList &lt;MdmBaseMeasure&gt; measures = new ArrayList（）; <a id="d11910e1357" class="indexterm-anchor"></a> MdmBaseMeasure mdmCostMeasure = mdmPriceCube.findOrCreateBaseMeasure（“UNIT_COST”）; MdmBaseMeasure mdmPriceMeasure = mdmPriceCube.findOrCreateBaseMeasure（“UNIT_PRICE”）; mdmCostMeasure.setAllowAutoDataTypeChange（真）; mdmPriceMeasure.setAllowAutoDataTypeChange（真）; measures.add（mdmCostMeasure）; measures.add（mdmPriceMeasure）; <a id="d11910e1362" class="indexterm-anchor"></a> MdmTable priceCostTable =（MdmTable）mdmDBSchema.getTopLevelObject（“PRICE_FACT”）;查询cubeQuery = priceCostTable.getQuery（）; ArrayList &lt;String&gt; measureColumns = new ArrayList（）; measureColumns.add（ “GLOBAL.PRICE_FACT.UNIT_COST”）; measureColumns.add（ “GLOBAL.PRICE_FACT.UNIT_PRICE”）; CubeMap cubeMap = mdmPriceCube.findOrCreateCubeMap（）; cubeMap.setQuery（cubeQuery）; //为多维数据集的度量创建MeasureMap对象，//设置度量的表达式。表达式指定度量的事实表的//列。int i = 0; for（MdmBaseMeasure mdmBaseMeasure：measures）{ <a id="d11910e1367" class="indexterm-anchor"></a> MeasureMap measureMap = cubeMap.findOrCreateMeasureMap（mdmBaseMeasure）; Expression expr =（Expression）SyntaxObject.fromSyntax（measureColumns.get（i），metadataProvider）; measureMap.setExpression（表达式）;我++; } //为多维数据集的维度创建CubeDimensionalityMap对象，//设置维度的表达式。表达式为维度指定事实表的//列。ArrayList &lt;String&gt; factColNames = new ArrayList（）; factColNames.add（ “GLOBAL.PRICE_FACT.MONTH_ID”）; factColNames.add（ “GLOBAL.PRICE_FACT.ITEM_ID”）; List &lt;MdmDimensionality&gt; mdmDimltys = mdmPriceCube.getDimensionality（）; for（MdmDimensionality mdmDimlty：mdmDimltys）{ <a id="d11910e1372" class="indexterm-anchor"></a> CubeDimensionalityMap cubeDimMap = cubeMap.findOrCreateCubeDimensionalityMap（mdmDimlty）; MdmPrimaryDimension mdmPrimDim =（MdmPrimaryDimension）mdmDimlty.getDimension（）; String columnMap = null; if（mdmPrimDim.getName（）。startsWith（“TIME”））{columnMap = factColNames.get（0）; i = 0; } else //（mdmPrimDim.getName（）。startsWith（“PRODUCT”））{columnMap = factColNames.get（1）; i = 1; Expression expr =（Expression）SyntaxObject.fromSyntax（columnMap，metadataProvider）; cubeDimMap.setExpression（表达式）; //将层次结构的叶级别与多维数据集相关联。MdmHierarchy mdmDefHier = mdmPrimDim.getDefaultHierarchy（）; MdmLevelHierarchy mdmLevHier =（MdmLevelHierarchy）mdmDefHier; List &lt;MdmHierarchyLevel&gt; levHierList = mdmLevHier.getHierarchyLevels（）; //列表中的最后一个元素必须是层次结构的叶级别。MdmHierarchyLevel leafLevel = levHierList.get（levHierList.size（） -  1）; cubeDimMap.setMappedDimension（leafLevel）; }}</pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
            </div><a id="OLAAP242"></a><a id="OLAAP241"></a><div class="props_rev_3"><a id="GUID-E79729DC-35F2-4A1F-975A-6DB9F91D7361" name="GUID-E79729DC-35F2-4A1F-975A-6DB9F91D7361"></a><h3 id="OLAAP-GUID-E79729DC-35F2-4A1F-975A-6DB9F91D7361" class="sect3"><span class="enumeration_section">4.6</span>提交交易</h3>
               <div>
                  <div class="section">
                     <p><a id="d11910e1416" class="indexterm-anchor"></a><a id="d11910e1420" class="indexterm-anchor"></a>要将元数据对象保存为数据库中的持久实体，必须提交在其中创建对象的<code class="codeph">Transaction</code> 。您可以随时提交<code class="codeph">Transaction</code> 。在创建顶级对象及其拥有的对象后提交<code class="codeph">Transaction</code>是一种很好的做法。
                     </p>
                     <p><a href="creating-metadata-and-analytic-workspaces.html#GUID-E79729DC-35F2-4A1F-975A-6DB9F91D7361__BABDCDHH">例4-9</a>从会话的<code class="codeph">DataProvider</code>获取<code class="codeph">TransactionProvider</code>并提交当前的<code class="codeph">Transaction</code> 。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-E79729DC-35F2-4A1F-975A-6DB9F91D7361__BABDCDHH">
                     <p class="titleinexample">示例4-9提交事务</p><pre class="oac_no_warn" dir="ltr">private void commit（MdmSource mdmSource）{try {System.out.println（“将事务提交为”+ mdmSource.getName（）+“。”）; （dp.getTransactionProvider（））commitCurrentTransaction（）; } catch（Exception ex）{System.out.println（“无法提交事务。”+ ex）; }}</pre></div>
                  <!-- class="example" -->
               </div>
            </div><a id="OLAAP244"></a><a id="OLAAP243"></a><div class="props_rev_3"><a id="GUID-767D2EF6-AAC5-47DA-91A8-9D48AD90A279" name="GUID-767D2EF6-AAC5-47DA-91A8-9D48AD90A279"></a><h3 id="OLAAP-GUID-767D2EF6-AAC5-47DA-91A8-9D48AD90A279" class="sect3"><span class="enumeration_section">4.7</span>导出和导入XML模板</h3>
               <div>
                  <div class="section">
                     <p><a id="d11910e1487" class="indexterm-anchor"></a><a id="d11910e1489" class="indexterm-anchor"></a><a id="d11910e1493" class="indexterm-anchor"></a>您可以通过将对象导出到XML模板来保存元数据对象的定义。导出对象可以保存对象的定义以及它拥有的任何对象的定义。例如，如果将<code class="codeph">AW</code>对象导出为XML，则XML包含<code class="codeph">AW</code>拥有的任何<code class="codeph">MdmPrimaryDimension</code>和<code class="codeph">MdmCube</code>对象的定义，以及维度和多维数据集拥有的<code class="codeph">MdmAttribute</code> ， <code class="codeph">MdmMeasure</code>和其他对象。
                     </p>
                     <p><a id="d11910e1518" class="indexterm-anchor"></a><a id="d11910e1520" class="indexterm-anchor"></a><a id="d11910e1524" class="indexterm-anchor"></a>您可以将元数据对象定义作为XML模板导入。导入后，您必须构建对象。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-767D2EF6-AAC5-47DA-91A8-9D48AD90A279__BABGCBEB">
                     <p class="titleinexample">示例4-10导出到XML模板</p>
                     <p><a id="d11910e1533" class="indexterm-anchor"></a>此示例将元数据对象导出到XML模板并将其保存在文件中。示例开头的代码摘录创建了要导出的对象的<code class="codeph">List</code> 。它向<code class="codeph">List</code>添加了<code class="codeph">aw</code>对象，它是由<a href="creating-metadata-and-analytic-workspaces.html#GUID-8AD05B73-FBF3-4D2F-99F7-02E406BAEA0D__BABGHIJF">示例4-1</a>创建的分析工作区。然后它调用<code class="codeph">exportToXML</code>方法。
                     </p><pre class="oac_no_warn" dir="ltr">...//在某种方法中List objectsToExport = new ArrayList（）; objectsToExport.add（AW）; exportToXML（objectsToExport，“globalawj.xml”）; ...public void exportToXML（List objectsToExport，String fileName）{try {PrintWriter writer = new PrintWriter（new FileWriter（filename））; mp.exportFullXML（writer，// mp是MdmMetadataProvider objectsToExport，null，//没有用于重命名对象的Map为false）; //不包括所有者名称writer.close（）; } catch（IOException ie）{ie.printStackTrace（）; }}</pre></div>
                  <!-- class="example" -->
               </div>
            </div><a id="OLAAP246"></a><a id="OLAAP245"></a><div class="props_rev_3"><a id="GUID-FBBE0DE5-B703-4CBD-9A1B-845AEFE5E640" name="GUID-FBBE0DE5-B703-4CBD-9A1B-845AEFE5E640"></a><h3 id="OLAAP-GUID-FBBE0DE5-B703-4CBD-9A1B-845AEFE5E640" class="sect3"><span class="enumeration_section">4.8</span>构建分析工作区</h3>
               <div>
                  <div class="section">
                     <p>在创建和映射元数据对象或导入对象的XML定义之后，必须执行对象指定的计算并将结果数据加载到物理存储结构中。</p>
                     <p><a id="d11910e1594" class="indexterm-anchor"></a><a id="d11910e1598" class="indexterm-anchor"></a><a id="d11910e1602" class="indexterm-anchor"></a><a id="d11910e1606" class="indexterm-anchor"></a><a id="d11910e1610" class="indexterm-anchor"></a> <a href="creating-metadata-and-analytic-workspaces.html#GUID-FBBE0DE5-B703-4CBD-9A1B-845AEFE5E640__BABDFIJC">示例4-11</a>为分析工作区的维度和多维数据集创建<code class="codeph">BuildItem</code>对象。它创建一个<code class="codeph">BuildProcess</code> ，指定<code class="codeph">BuildItem</code>对象，并将<code class="codeph">BuildProcess</code>传递给会话的<code class="codeph">DataProvider</code>的<code class="codeph">executeBuild</code>方法。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-FBBE0DE5-B703-4CBD-9A1B-845AEFE5E640__BABDFIJC">
                     <p class="titleinexample">示例4-11构建分析工作区</p><pre class="oac_no_warn" dir="ltr">BuildItem bldChanDim = new BuildItem（mdmChanDim）; BuildItem bldProdDim = new BuildItem（mdmProdDim）; BuildItem bldCustDim = new BuildItem（mdmCustDim）; BuildItem bldTimeDim = new BuildItem（mdmTimeDim）; BuildItem bldUnitsCube = new BuildItem（mdmUnitsCube）; BuildItem bldPriceCube = new BuildItem（mdmPriceCube）; ArrayList &lt;BuildItem&gt; items = new ArrayList（）; items.add（bldChanDim）; items.add（bldProdDim）; items.add（bldCustDim）; items.add（bldTimeDim）; items.add（bldUnitsCube）; items.add（bldPriceCube）; BuildProcess bldProc = new BuildProcess（items）;试试{dp.executeBuild（bldProc，0）; } catch（Exception ex）{System.out.println（“无法执行BuildProcess。”+ ex）; }</pre></div>
                  <!-- class="example" -->
               </div>
            </div>
         </div>
      </article>
   </body>
</html>