<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>调整RMAN性能</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Backup and Recovery User&#39;s Guide"></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Backup and Recovery User&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="database-backup-and-recovery-users-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-09T05:20:45-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2003, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96241-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="part-rman-tuning-troubleshooting.html" title="Previous" type="text/html"></link>
      <link rel="next" href="troubleshooting-rman-operations.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database Backup and Recovery User&#39;s Guide"></meta>
    <meta name="dcterms.isVersionOf" content="BRADV"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="part-rman-tuning-troubleshooting.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="troubleshooting-rman-operations.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">备份和恢复用户指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="part-rman-tuning-troubleshooting.html" property="item" typeof="WebPage"><span property="name">调整和故障排除</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">调整RMAN性能</li>
            </ol>
            <a id="GUID-33D81037-2310-4021-8039-1A2C579AAA5A" name="GUID-33D81037-2310-4021-8039-1A2C579AAA5A"></a><a id="BRADV011"></a>
            
            <h2 id="BRADV-GUID-33D81037-2310-4021-8039-1A2C579AAA5A" class="sect2"><span class="enumeration_chapter">23</span>调整RMAN性能</h2>
         </header>
         <div class="ind">
            <div>
               <p>本章包含以下主题：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="tuning-rman-performance.html#GUID-BD6B1424-A13E-4EBA-99C3-1B79B2DF7FC9" title="RMAN调整的目的是识别给定作业的瓶颈，并使用RMAN命令，初始化参数或对物理介质的调整来提高性能。">RMAN性能调整的目的</a></p>
                  </li>
                  <li>
                     <p><a href="tuning-rman-performance.html#GUID-55347A64-8DA3-415E-99C7-9F7FB30001A3" title="当RMAN通道从磁盘读取数据时，多个因素会影响性能。在备份期间，RMAN通道将输入文件中的块读入I / O磁盘缓冲区。磁盘子系统上的数据库文件可以由自动存储管理（ASM）或备用卷管理器或文件系统管理。备份调整的注意事项会根据您是否使用ASM管理数据库文件而更改。当通道读取或写入磁盘时，I / O可以是同步I / O或异步I / O.在不支持本机异步I / O的操作系统上，数据库可以使用特殊的I / O从属进程对其进行仿真。这些过程专门用于代表另一个进程执行I / O.您可以使用RATE参数设置读取的字节数的上限，以便RMAN不会消耗过多的磁盘带宽并降低在线性能。从本质上讲，RATE充当备用节流阀。在复制阶段，通道将块从输入缓冲区复制到输出缓冲区并执行其他处理。备份到SBT时，RMAN为媒体管理软件提供字节流，并将唯一名称与此流关联。存储流的方式和位置的所有细节完全由媒体管理器处理。因此，备份到磁带涉及RMAN和媒体管理器的交互。影响SBT写入阶段的RMAN特定因素类似于影响磁盘读取的因素。在这两种情况下，缓冲区分配，从属进程以及同步或异步I / O都会影响性能。多种因素会影响备份到磁带的速度。如果磁带设备是远程的，则介质管理器必须通过网络传输数据。磁带本机传输速率是在没有压缩的情况下写入磁带的速度。此速度表示备份速率的上限。磁带压缩级别对备份性能非常重要。如果磁带具有良好的压缩性，则持续备份速率更快。写入操作期间的磁带流对磁带备份性能有重大影响。物理磁带块大小会影响备份性能。影响磁盘写入阶段的主要因素是缓冲区大小。">RMAN性能调优的基本概念</a></p>
                  </li>
                  <li>
                     <p><a href="tuning-rman-performance.html#GUID-9F7B89D0-969A-47EE-B29B-28C8F5AC3243" title="通常，您可以使用V $视图开始调整过程，以确定RMAN备份和还原操作遇到问题的位置。">使用V $视图诊断RMAN性能问题</a></p>
                  </li>
                  <li>
                     <p><a href="tuning-rman-performance.html#GUID-5AAB8C9A-41C6-4400-B643-08D10D7106AD" title="许多因素都会影响备份性能。通常，找到缓慢备份的解决方案是一个反复试验的过程。">调整RMAN备份性能</a></p>
                  </li>
               </ul>
            </div><a id="BRADV89842"></a><div class="props_rev_3"><a id="GUID-BD6B1424-A13E-4EBA-99C3-1B79B2DF7FC9" name="GUID-BD6B1424-A13E-4EBA-99C3-1B79B2DF7FC9"></a><h3 id="BRADV-GUID-BD6B1424-A13E-4EBA-99C3-1B79B2DF7FC9" class="sect3"><span class="enumeration_section">23.1</span> RMAN性能调整的目的</h3>
               <div>
                  <p>RMAN调整的目的是识别给定作业的瓶颈，并使用RMAN命令，初始化参数或对物理介质的调整来提高性能。</p>
                  <p>RMAN备份或还原作业可以分为单独的阶段或组件。任何RMAN作业中这些阶段中最慢的一个称为<strong class="term">瓶颈</strong> 。
                  </p>
               </div>
            </div><a id="BRADV393"></a><a id="BRADV394"></a><a id="BRADV170"></a><div class="props_rev_3"><a id="GUID-55347A64-8DA3-415E-99C7-9F7FB30001A3" name="GUID-55347A64-8DA3-415E-99C7-9F7FB30001A3"></a><h3 id="BRADV-GUID-55347A64-8DA3-415E-99C7-9F7FB30001A3" class="sect3"><span class="enumeration_section">23.2</span> RMAN性能调优的基本概念</h3>
               <div>
                  <p>调整RMAN性能需要详细了解RMAN如何创建备份。备份的工作由一个或多个通道执行。<a href="glossary.html#GUID-D7D8E7D7-3CD3-4FCF-AF75-AF2BE11A366F"><span class="xrefglossterm">通道</span></a>表示存储设备的字节流。
                  </p>
                  <p>出于说明的目的，您可以将字节流视为从内存中的输入缓冲区通过CPU传递到输出缓冲区，并从那里传递到存储设备。要将备份定向到两个磁带设备，请分配两个磁带通道，以便每个字节流转到另一个设备。</p>
                  <p>每个通道的工作，无论是磁盘类型还是系统备份磁带（SBT），都细分为不同的阶段。下表描述了这些阶段。</p>
                  <div class="tblformal" id="GUID-55347A64-8DA3-415E-99C7-9F7FB30001A3__GUID-E4E56CF2-91C0-46EC-BEB8-FEA1B112839D">
                     <p class="titleintable">表23-1渠道工作的阶段</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="渠道工作的阶段" border="1" summary="This table describes the phases in the work of an RMAN channel (both of type disk and SBT)." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="20%" id="d100789e283">序列</th>
                              <th align="left" valign="bottom" width="20%" id="d100789e285">相</th>
                              <th align="left" valign="bottom" width="20%" id="d100789e287">描述</th>
                              <th align="left" valign="bottom" width="20%" id="d100789e289">附加信息</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d100789e293" headers="d100789e283 ">1</td>
                              <td align="left" valign="top" width="20%" headers="d100789e293 d100789e285 ">阅读阶段</td>
                              <td align="left" valign="top" width="20%" headers="d100789e293 d100789e287 ">
                                 <p>通道从磁盘读取块到输入I / O缓冲区。</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d100789e293 d100789e289 ">
                                 <p><span class="q">“ <a href="tuning-rman-performance.html#GUID-1016F1F4-21D0-47B8-871A-FB582838D8A7" title="当RMAN通道从磁盘读取数据时，多个因素会影响性能。">阅读阶段</a> ”</span></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d100789e309" headers="d100789e283 ">2</td>
                              <td align="left" valign="top" width="20%" headers="d100789e309 d100789e285 ">复制阶段</td>
                              <td align="left" valign="top" width="20%" headers="d100789e309 d100789e287 ">
                                 <p>通道将块从输入缓冲区复制到输出缓冲区，并对块执行其他处理。</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d100789e309 d100789e289 ">
                                 <p><span class="q">“ <a href="tuning-rman-performance.html#GUID-4061DDD7-DB0F-46E8-A6B2-C3D10E288846" title="在复制阶段，通道将块从输入缓冲区复制到输出缓冲区并执行其他处理。">复制阶段</a> ”</span></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d100789e325" headers="d100789e283 ">3</td>
                              <td align="left" valign="top" width="20%" headers="d100789e325 d100789e285 ">写阶段</td>
                              <td align="left" valign="top" width="20%" headers="d100789e325 d100789e287 ">
                                 <p>通道将块从输出缓冲区写入存储介质。写入阶段可以采用以下互斥形式之一，具体取决于备份介质的类型：系统备份磁带（SBT）的写入阶段或磁盘的写入阶段。</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d100789e325 d100789e289 ">
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p><span class="q">“ <a href="tuning-rman-performance.html#GUID-BA0D4E35-7835-4F28-9504-C5EB32207206" title="备份到SBT时，RMAN为媒体管理软件提供字节流，并将唯一名称与此流关联。存储流的方式和位置的所有细节完全由媒体管理器处理。因此，备份到磁带涉及RMAN和媒体管理器的交互。">系统备份磁带（SBT）的写入阶段</a> ”</span></p>
                                    </li>
                                    <li>
                                       <p><span class="q">“ <a href="tuning-rman-performance.html#GUID-56356B98-2E0F-4D03-9998-F1E8348D9F2B" title="影响磁盘写入阶段的主要因素是缓冲区大小。">为磁盘写入阶段</a> ”</span></p>
                                    </li>
                                 </ul>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <p><a href="tuning-rman-performance.html#GUID-55347A64-8DA3-415E-99C7-9F7FB30001A3__BABDJHBJ">图23-1</a>描述了备份存储在三个磁盘上的数据的两个通道。每个通道将数据读入输入缓冲区，在将数据从输入缓冲区复制到输出缓冲区时处理数据，然后将数据从输出缓冲区写入磁盘。
                  </p>
                  <div class="figure" id="GUID-55347A64-8DA3-415E-99C7-9F7FB30001A3__BABDJHBJ">
                     <p class="titleinfigure">图23-1多磁盘备份到磁盘的阶段</p><img src="img/bradv042.gif" alt="下面是图23-1的描述" title="下面是图23-1的描述" longdesc="img_text/bradv042.html"><br><a href="img_text/bradv042.html">“图23-1多通道备份到磁盘的阶段”的说明</a></div>
                  <!-- class="figure" -->
                  <p><a href="tuning-rman-performance.html#GUID-55347A64-8DA3-415E-99C7-9F7FB30001A3__BABEDGBI">图23-2</a>还描述了备份存储在三个磁盘上的数据的两个通道，但是一个磁盘通过网络远程安装。每个通道将数据读入输入缓冲区，在将数据从输入缓冲区复制到输出缓冲区时处理数据，然后将数据从输出缓冲区写入磁带。通道1将数据写入本地连接的磁带驱动器，而通道2通过网络将数据发送到远程介质服务器。
                  </p>
                  <div class="figure" id="GUID-55347A64-8DA3-415E-99C7-9F7FB30001A3__BABEDGBI">
                     <p class="titleinfigure">图23-2多磁带备份到磁带的阶段</p><img src="img/bradv041.gif" alt="下面是图23-2的描述" title="下面是图23-2的描述" longdesc="img_text/bradv041.html"><br><a href="img_text/bradv041.html">“图23-2多通道备份到磁带的阶段”的说明</a></div>
                  <!-- class="figure" -->
                  <p>恢复数据时，通道以相反的顺序执行这些步骤并反转读取和写入操作。以下部分介绍了备份方面的RMAN调优概念。</p>
                  <p>可用于设备的通道数确定RMAN是否可以并行读取和写入此设备。建议通道数等于所用存储设备的数量。因此，当RMAN使用磁盘时，通道数必须等于访问的物理磁盘数。当RMAN使用磁带时，通道数必须等于RMAN访问的磁带驱动器数。</p>
               </div><a id="BRADV90067"></a><div class="props_rev_3"><a id="GUID-1016F1F4-21D0-47B8-871A-FB582838D8A7" name="GUID-1016F1F4-21D0-47B8-871A-FB582838D8A7"></a><h4 id="BRADV-GUID-1016F1F4-21D0-47B8-871A-FB582838D8A7" class="sect4"><span class="enumeration_section">23.2.1</span>读取阶段</h4>
                  <div>
                     <p>当RMAN通道从磁盘读取数据时，多个因素会影响性能。</p>
                     <p>本节中的以下主题说明了这些因素：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="tuning-rman-performance.html#GUID-59FBFBBE-78F0-4035-8FAC-818DB539576B" title="在备份期间，RMAN通道将输入文件中的块读入I / O磁盘缓冲区。磁盘子系统上的数据库文件可以由自动存储管理（ASM）或备用卷管理器或文件系统管理。备份调整的注意事项会根据您是否使用ASM管理数据库文件而更改。">输入磁盘缓冲区的分配</a></p>
                        </li>
                        <li>
                           <p><a href="tuning-rman-performance.html#GUID-6339C9D0-E98C-49E0-8C82-1EBA810EBB0B" title="当通道读取或写入磁盘时，I / O是同步I / O或异步I / O.">同步和异步磁盘I / O.</a></p>
                        </li>
                        <li>
                           <p><a href="tuning-rman-performance.html#GUID-BA1D0CA9-AE7F-4A9A-88B6-2449B94DBEF0" title="在不支持本机异步I / O的操作系统上，数据库可以使用特殊的I / O从属进程对其进行仿真。这些过程专门用于代表另一个进程执行I / O.">磁盘I / O从站</a></p>
                        </li>
                        <li>
                           <p><a href="tuning-rman-performance.html#GUID-5A55B177-B2A8-47AE-A6E9-693DFB5CC613" title="您可以使用RATE参数设置读取的字节数的上限，以便RMAN不会消耗过多的磁盘带宽并降低在线性能。从本质上讲，RATE充当备用节流阀。">速率通道参数</a></p>
                        </li>
                     </ul>
                  </div><a id="BRADV395"></a><a id="BRADV396"></a><a id="BRADV89845"></a><div class="props_rev_3"><a id="GUID-59FBFBBE-78F0-4035-8FAC-818DB539576B" name="GUID-59FBFBBE-78F0-4035-8FAC-818DB539576B"></a><h5 id="BRADV-GUID-59FBFBBE-78F0-4035-8FAC-818DB539576B" class="sect5"><span class="enumeration_section">23.2.1.1</span>输入磁盘缓冲区的分配</h5>
                     <div>
                        <p>在备份期间，RMAN通道将输入文件中的块读入I / O磁盘缓冲区。磁盘子系统上的数据库文件可以由自动存储管理（ASM）或备用卷管理器或文件系统管理。备份调整的注意事项会根据您是否使用ASM管理数据库文件而更改。</p>
                        <p>输入缓冲区的分配取决于文件的复用方式。备份<a href="glossary.html#GUID-635043F8-78E2-4B43-A3C4-E27AFEAF363C"><span class="xrefglossterm">多路复用</span></a>是RMAN能够同时从不同来源读取备份中的多个文件，然后将它们写入单个备份片段。<a href="glossary.html#GUID-648D7B2D-7AB2-40C0-AFFD-0A6FE569F3D7"><span class="xrefglossterm">多路复用</span></a>的<a href="glossary.html#GUID-648D7B2D-7AB2-40C0-AFFD-0A6FE569F3D7"><span class="xrefglossterm">级别</span></a> ，即同时读取然后写入同一<a href="glossary.html#GUID-AED62318-D45A-49FA-B4B4-DAD98647FCF6"><span class="xrefglossterm">备份片段</span></a>的输入文件的数量，由<span class="q">“ <a href="rman-backup-concepts.html#GUID-6E6613A6-545A-4E65-8D5E-849CB6B91E97" title="创建备份集时，RMAN可以同时从磁盘读取多个文件，然后将其块写入同一备份集。例如，RMAN可以同时读取两个数据文件，然后将这些数据文件中的块组合成一个备份片。来自多个文件的块组合称为备份多路复用。">关于多路复用的RMAN备份集</a> ”中</span>描述的算法确定。在继续之前请查看本节。
                        </p>
                        <p>当RMAN通道从磁盘备份文件时，它使用<a href="tuning-rman-performance.html#GUID-59FBFBBE-78F0-4035-8FAC-818DB539576B__CACCAJJB" title="该表描述了RMAN使用的缓冲区大小，具体取决于复用级别。">表23-2中</a>描述的规则来确定输入磁盘缓冲区的大小。
                        </p>
                        <div class="tblformal" id="GUID-59FBFBBE-78F0-4035-8FAC-818DB539576B__CACCAJJB">
                           <p class="titleintable">表23-2数据文件读缓冲区大小调整算法</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="数据文件读缓冲区大小算法" width="100%" border="1" summary="This table describes buffer sizes RMAN uses depending upon the level of multiplexing." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="33%" id="d100789e596">多路复用程度</th>
                                    <th align="left" valign="bottom" width="67%" id="d100789e599">输入磁盘缓冲区大小</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="33%" id="d100789e604" headers="d100789e596 ">
                                       <p>小于或等于4</p>
                                    </td>
                                    <td align="left" valign="top" width="67%" headers="d100789e604 d100789e599 ">
                                       <p>RMAN通道分配16个大小为1兆字节（MB）的缓冲区，以便所有输入文件的总缓冲区大小为16 MB。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="33%" id="d100789e611" headers="d100789e596 ">
                                       <p>大于4但小于或等于8</p>
                                    </td>
                                    <td align="left" valign="top" width="67%" headers="d100789e611 d100789e599 ">
                                       <p>RMAN通道分配大小为512千字节（KB）的可变数量的磁盘缓冲区，以便所有输入文件的总缓冲区大小小于16 MB。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="33%" id="d100789e618" headers="d100789e596 ">
                                       <p>大于8</p>
                                    </td>
                                    <td align="left" valign="top" width="67%" headers="d100789e618 d100789e599 ">
                                       <p>RMAN通道为每个文件分配4个128 KB的磁盘缓冲区，因此每个输入文件的总缓冲区大小为512 KB。</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                        <p>在<a href="tuning-rman-performance.html#GUID-59FBFBBE-78F0-4035-8FAC-818DB539576B__BABICCGE">图23-3</a>所示的示例中，一个通道正在备份四个数据文件。<code class="codeph">MAXOPENFILES</code>设置为4， <code class="codeph">FILESPERSET</code>设置为4。因此，多路复用的级别是4。因此，每个数据文件的缓冲区总大小为4 MB。所有缓冲区的总大小为16 MB。</p>
                        <div class="figure" id="GUID-59FBFBBE-78F0-4035-8FAC-818DB539576B__BABICCGE">
                           <p class="titleinfigure">图23-3磁盘缓冲区分配</p><img src="img/bradv011.gif" alt="下面是图23-3的描述" title="下面是图23-3的描述" longdesc="img_text/bradv011.html"><br><a href="img_text/bradv011.html">“图23-3磁盘缓冲区分配”的说明</a></div>
                        <!-- class="figure" -->
                        <p>如果通道正在备份存储在ASM中的文件，则仅当多路复用级别为1时，输入磁盘缓冲区的数量才等于ASM磁盘组中的物理磁盘数。例如，如果数据文件存储在包含16个物理磁盘的ASM磁盘组中，则通道会为数据文件备份分配16个输入缓冲区。</p>
                        <p>如果某个通道正在从磁盘恢复备份，则会分配4个缓冲区。缓冲区的大小取决于操作系统。</p>
                     </div>
                  </div><a id="BRADV90068"></a><div class="props_rev_3"><a id="GUID-6339C9D0-E98C-49E0-8C82-1EBA810EBB0B" name="GUID-6339C9D0-E98C-49E0-8C82-1EBA810EBB0B"></a><h5 id="BRADV-GUID-6339C9D0-E98C-49E0-8C82-1EBA810EBB0B" class="sect5"><span class="enumeration_section">23.2.1.2</span>同步和异步磁盘I / O.</h5>
                     <div>
                        <p>当通道读取或写入磁盘时，I / O是同步I / O或异步I / O.</p>
                        <p>当磁盘I / O是同步的时，服务器进程一次只能执行一个任务。当磁盘I / O是异步时，服务器进程可以开始I / O操作，然后在等待I / O完成时执行其他工作。RMAN还可以在等待第一个完成之前开始多个I / O操作。</p>
                        <p>从ASM <a href="glossary.html#GUID-FB619E7B-0181-4834-8F73-ED14C94837CC"><span class="xrefglossterm">磁盘组</span></a>读取时，请尽可能使用异步磁盘I / O.此外，如果通道从使用卷管理<a href="glossary.html#GUID-D6545038-B176-4D0E-9B4B-E4187A063984"><span class="xrefglossterm">器</span></a>管理的<a href="glossary.html#GUID-D6545038-B176-4D0E-9B4B-E4187A063984"><span class="xrefglossterm">原始设备</span></a>读取，则异步磁盘I / O也可以正常工作。某些操作系统支持本机异步磁盘I / O.如果可用，数据库将利用此功能。
                        </p>
                     </div>
                  </div><a id="BRADV90069"></a><div class="props_rev_3"><a id="GUID-BA1D0CA9-AE7F-4A9A-88B6-2449B94DBEF0" name="GUID-BA1D0CA9-AE7F-4A9A-88B6-2449B94DBEF0"></a><h5 id="BRADV-GUID-BA1D0CA9-AE7F-4A9A-88B6-2449B94DBEF0" class="sect5"><span class="enumeration_section">23.2.1.3</span>磁盘I / O从站</h5>
                     <div>
                        <p>在不支持本机异步I / O的操作系统上，数据库可以使用特殊的I / O从属进程对其进行仿真。这些过程专门用于代表另一个进程执行I / O.</p>
                        <p>您可以通过设置<code class="codeph">DBWR_IO_SLAVES</code>初始化参数来控制磁盘I / O从站，该参数不是动态的。该参数指定数据库写程序进程（DBWR）使用的I / O服务器进程数。默认情况下，该值为0并且不使用I / O服务器进程。如果禁用异步I / O，则RMAN会为任何非零值<code class="codeph">DBWR_IO_SLAVES</code>分配四个备份磁盘I / O从站。</p>
                        <p>尝试获取I / O从属的共享缓冲区时，数据库执行以下操作：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>如果设置了<code class="codeph">LARGE_POOL_SIZE</code>初始化参数，并且<code class="codeph">DBWR_IO_SLAVES</code>参数设置为非零值，则数据库将尝试从大型池中获取内存。如果此值不够大，则会在警报日志中记录错误，数据库不会尝试从共享池中获取缓冲区，并且不使用异步I / O.
                              </p>
                           </li>
                           <li>
                              <p>如果未设置<code class="codeph">LARGE_POOL_SIZE</code>初始化参数或将其设置为零，则数据库将尝试从共享池中获取内存。
                              </p>
                           </li>
                           <li>
                              <p>如果数据库无法获得足够的内存，则它从程序全局区域（PGA）获取I / O缓冲区内存并将消息写入<code class="codeph">alert</code> 。 <code class="codeph">log</code>文件，指示同步I / O用于此备份。
                              </p>
                           </li>
                        </ul>
                        <p>大型池中的内存用于许多功能，包括共享服务器，并行查询和RMAN I / O从属缓冲区。配置大型池可防止RMAN与其他子系统竞争同一内存。</p>
                        <p>来自共享池的连续内存分配请求通常很小（小于5 KB）。但是，对大量连续内存分配的请求可能会失败或需要大量内存管理来释放所需数量的连续内存。虽然共享池可能无法满足此内存请求，但大型池可以这样做。大型池没有最近最少使用（LRU）列表;数据库不会尝试使内存超出大池。</p>
                     </div>
                  </div><a id="BRADV90070"></a><div class="props_rev_3"><a id="GUID-5A55B177-B2A8-47AE-A6E9-693DFB5CC613" name="GUID-5A55B177-B2A8-47AE-A6E9-693DFB5CC613"></a><h5 id="BRADV-GUID-5A55B177-B2A8-47AE-A6E9-693DFB5CC613" class="sect5"><span class="enumeration_section">23.2.1.4</span>速率信道参数</h5>
                     <div>
                        <p>您可以使用<code class="codeph">RATE</code>参数设置读取的字节数的上限，以便RMAN不会消耗过多的磁盘带宽并降低在线性能。从本质上讲， <code class="codeph">RATE</code>充当备用节流阀。
                        </p>
                        <p>在<code class="codeph">ALLOCATE</code>和<code class="codeph">CONFIGURE CHANNEL</code>命令中， <code class="codeph">RATE</code>参数指定在通道上读取的每秒字节数。例如，如果您设置<code class="codeph">RATE 1500K</code> ，并且每个磁盘驱动器每秒提供3兆字节，则该通道会为在线系统留下一些磁盘带宽。
                        </p>
                     </div>
                  </div>
               </div><a id="BRADV90071"></a><div class="props_rev_3"><a id="GUID-4061DDD7-DB0F-46E8-A6B2-C3D10E288846" name="GUID-4061DDD7-DB0F-46E8-A6B2-C3D10E288846"></a><h4 id="BRADV-GUID-4061DDD7-DB0F-46E8-A6B2-C3D10E288846" class="sect4"><span class="enumeration_section">23.2.2</span>复制阶段</h4>
                  <div>
                     <p>在复制阶段，通道将块从输入缓冲区复制到输出缓冲区并执行其他处理。</p>
                     <p>例如，如果通道从磁盘读取数据并备份到磁带，则通道会将数据从磁盘缓冲区复制到输出磁带缓冲区。</p>
                     <p>复制阶段涉及以下类型的处理：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>验证</p>
                        </li>
                        <li>
                           <p>压缩</p>
                        </li>
                        <li>
                           <p>加密</p>
                        </li>
                     </ul>
                     <p>执行块<a href="glossary.html#GUID-A7DFFD0D-F709-43CD-BD1A-E5F08D88DB77"><span class="xrefglossterm">验证</span></a>时，RMAN会检查它们是否存在损坏。通常，此处理不是CPU密集型的。
                     </p>
                     <p>执行<a href="glossary.html#GUID-90E07DCF-D038-4770-8A1A-06AF137C3762"><span class="xrefglossterm">二进制压缩时</span></a> ，RMAN将压缩算法应用于备份集中的数据。二进制压缩可能是CPU密集型的。您可以选择RMAN用于备份的压缩算法。对于大多数情况，RMAN的基本压缩级别具有良好的压缩率。如果启用了Oracle Advanced Compression选项，则可以从几个不同的级别中进行选择，以提供压缩比和所需CPU资源之间的权衡。
                     </p>
                     <p>执行<a href="glossary.html#GUID-65A13E9F-7391-4A6A-8379-B2EA64D0EA9E"><span class="xrefglossterm">备份加密时</span></a> ，RMAN使用<code class="codeph">V$RMAN_ENCRYPTION_ALGORITHMS</code>列出的算法对备份集进行<a href="glossary.html#GUID-65A13E9F-7391-4A6A-8379-B2EA64D0EA9E"><span class="xrefglossterm">加密</span></a> 。 RMAN提供三种加密模式：透明，密码保护和双模式。备份加密可能是CPU密集型的。
                     </p>
                     <div class="infoboxnotealso" id="GUID-4061DDD7-DB0F-46E8-A6B2-C3D10E288846__GUID-259FC8AE-A039-4618-914B-E17AEF44F6BE">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="validating-database-files-backups.html#GUID-CC967929-9610-410D-B881-66E71353D84C" title="验证使您可以检查备份的完整性。RMAN验证的主要目的是检查损坏的块和丢失的文件。您还可以使用RMAN确定是否可以还原备份。数据库可防止导致无法使用的备份文件或损坏的已还原数据文件的操作。损坏的块是一个已更改的块，因此它与Oracle数据库期望找到的块不同。在物理损坏（也称为媒体损坏）中，数据库根本无法识别块：校验和无效，块包含全零，或块的页眉和页脚不匹配。您可以使用SET MAXCORRUPT命令设置RMAN备份文件中允许的未标记损坏总数。默认值为零，这意味着RMAN不会容忍任何类型的未标记的损坏块。Oracle数据库支持用于检测，修复和监视块损坏的不同技术。您可以使用VALIDATE命令手动检查数据库文件中的物理和逻辑损坏。您还可以使用BACKUP VALIDATE命令执行验证。你可以运行RESTORE ...VALIDATE以测试RMAN是否可以从备份还原特定文件或文件集。RMAN选择要使用的备份。RMAN使您可以使用VALIDATE命令验证多租户容器数据库（CDB）和可插拔数据库（PDB）。验证CDB的步骤与用于验证非CDB的步骤类似。有多种方法可以验证PDB。">验证数据库文件和备份</a></p>
                           </li>
                           <li>
                              <p><a href="backing-up-database.html#GUID-E0D30989-9477-45DD-8FE1-367BDD0A7A8E" title="创建备份集时，可以通过在BACKUP命令中包含AS COMPRESSED BACKUPSET选项，使用RMAN支持对备份集进行二进制压缩。">进行压缩备份</a></p>
                           </li>
                           <li>
                              <p><a href="backing-up-database-advanced.html#GUID-ECBE4965-57F7-49F0-BECD-734196F417F5" title="您可以使用备份加密保护RMAN备份集。如果未经授权的用户获取加密备份，则无法读取这些备份。">加密RMAN备份</a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="BRADV90072"></a><div class="props_rev_3"><a id="GUID-BA0D4E35-7835-4F28-9504-C5EB32207206" name="GUID-BA0D4E35-7835-4F28-9504-C5EB32207206"></a><h4 id="BRADV-GUID-BA0D4E35-7835-4F28-9504-C5EB32207206" class="sect4"><span class="enumeration_section">23.2.3</span>系统备份磁带（SBT）的写入阶段</h4>
                  <div>
                     <p>备份到SBT时，RMAN为媒体管理软件提供字节流，并将唯一名称与此流关联。存储流的方式和位置的所有细节完全由媒体管理器处理。因此，备份到磁带涉及RMAN和媒体管理器的交互。</p>
                     <p></p>
                     <p>影响SBT写入阶段的因素在以下主题中描述：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="tuning-rman-performance.html#GUID-A0CF4DE6-07C1-4828-9889-EDA1E30E1BE9" title="影响SBT写入阶段的RMAN特定因素类似于影响磁盘读取的因素。在这两种情况下，缓冲区分配，从属进程以及同步或异步I / O都会影响性能。">SBT写入阶段的RMAN组件</a></p>
                        </li>
                        <li>
                           <p><a href="tuning-rman-performance.html#GUID-AD7E0880-DEDB-4339-80E6-125F40591F8F" title="多种因素会影响备份到磁带的速度。">SBT写入阶段的媒体管理器组件</a></p>
                        </li>
                     </ul>
                  </div><a id="BRADV90073"></a><div class="props_rev_3"><a id="GUID-A0CF4DE6-07C1-4828-9889-EDA1E30E1BE9" name="GUID-A0CF4DE6-07C1-4828-9889-EDA1E30E1BE9"></a><h5 id="BRADV-GUID-A0CF4DE6-07C1-4828-9889-EDA1E30E1BE9" class="sect5"><span class="enumeration_section">23.2.3.1</span> SBT写入阶段的RMAN组件</h5>
                     <p>影响SBT写入阶段的RMAN特定因素类似于影响磁盘读取的因素。在这两种情况下，缓冲区分配，从属进程以及同步或异步I / O都会影响性能。</p><a id="BRADV397"></a><a id="BRADV89846"></a><div class="props_rev_3"><a id="GUID-14963AC8-18DB-44F1-99C8-F07D85D7D826" name="GUID-14963AC8-18DB-44F1-99C8-F07D85D7D826"></a><h6 id="BRADV-GUID-14963AC8-18DB-44F1-99C8-F07D85D7D826" class="sect6"><span class="enumeration_section">23.2.3.1.1</span>磁带缓冲区的分配</h6>
                        <div>
                           <p>如果备份到<a href="glossary.html#GUID-2E48CE71-9547-4196-B715-5CE59033262E"><span class="xrefglossterm">SBT</span></a>设备或从<a href="glossary.html#GUID-2E48CE71-9547-4196-B715-5CE59033262E"><span class="xrefglossterm">SBT</span></a>设备恢复，则默认情况下，数据库会为磁带写入器为每个通道分配四个缓冲区（如果还原数据则读取， <a href="tuning-rman-performance.html#GUID-14963AC8-18DB-44F1-99C8-F07D85D7D826__CACEAIIF">如图23-4</a>所示）。磁带I / O缓冲区的大小取决于平台。您可以使用<code class="codeph">ALLOCATE CHANNEL</code>或<code class="codeph">CONFIGURE CHANNEL</code>命令的<code class="codeph">PARMS</code>和<code class="codeph">BLKSIZE</code>参数更改此值。
                           </p>
                           <div class="figure" id="GUID-14963AC8-18DB-44F1-99C8-F07D85D7D826__CACEAIIF">
                              <p class="titleinfigure">图23-4磁带缓冲区的分配</p><img src="img/bradv013.gif" alt="下面是图23-4的描述" title="下面是图23-4的描述" longdesc="img_text/bradv013.html"><br><a href="img_text/bradv013.html">“图23-4磁带缓冲区分配”的描述</a></div>
                           <!-- class="figure" -->
                        </div>
                     </div><a id="BRADV90074"></a><div class="props_rev_3"><a id="GUID-4AFD6357-3E96-4449-A2F0-AA4BF49A11A8" name="GUID-4AFD6357-3E96-4449-A2F0-AA4BF49A11A8"></a><h6 id="BRADV-GUID-4AFD6357-3E96-4449-A2F0-AA4BF49A11A8" class="sect6"><span class="enumeration_section">23.2.3.1.2</span>磁带I / O从站</h6>
                        <div>
                           <p>RMAN根据是否使用I / O从站在系统全局区域（SGA）或程序全局区域（PGA）中分配磁带缓冲区。如果设置初始化参数<code class="codeph">BACKUP_TAPE_IO_SLAVES=true</code> ，则RMAN从SGA分配磁带缓冲区。磁带设备一次只能由一个进程访问，因此RMAN会根据磁带设备的数量启动尽可能多的从设备。如果还设置了<code class="codeph">LARGE_POOL_SIZE</code>初始化参数，则RMAN将从大型池中分配缓冲区。如果设置<code class="codeph">BACKUP_TAPE_IO_SLAVES=false</code> ，则RMAN从PGA分配缓冲区。</p>
                           <p>如果使用I / O从属，则将<code class="codeph">LARGE_POOL_SIZE</code>初始化参数设置为专用SGA内存以保存这些大内存分配。此参数可防止RMAN I / O缓冲区与SGA内存的库高速缓存竞争。如果请求了磁带I / O的I / O从站，但SGA中没有足够的空间用于它们，则不使用从站，并且警报日志中会显示一条消息。
                           </p>
                           <p>参数<code class="codeph">BACKUP_TAPE_IO_SLAVES</code>指定RMAN是否使用从属进程而不是从属进程的数量。磁带设备一次只能由一个进程访问，RMAN使用磁带设备数量所需的从设备数。
                           </p>
                        </div>
                     </div><a id="BRADV398"></a><a id="BRADV399"></a><a id="BRADV89847"></a><div class="props_rev_3"><a id="GUID-34FEA214-7C3D-447B-B441-A05C11814015" name="GUID-34FEA214-7C3D-447B-B441-A05C11814015"></a><h6 id="BRADV-GUID-34FEA214-7C3D-447B-B441-A05C11814015" class="sect6"><span class="enumeration_section">23.2.3.1.3</span>同步和异步I / O.</h6>
                        <div>
                           <p>当SBT通道读取或写入数据到磁带时，I / O始终是同步的。对于磁带I / O，分配的每个通道（无论是手动还是自动）都对应于服务器进程，此处称为通道进程。</p>
                           <p><a href="tuning-rman-performance.html#GUID-34FEA214-7C3D-447B-B441-A05C11814015__BABEBGFD">图23-5</a>显示了备份到磁带的同步I / O.
                           </p>
                           <div class="figure" id="GUID-34FEA214-7C3D-447B-B441-A05C11814015__BABEBGFD">
                              <p class="titleinfigure">图23-5同步磁带I / O.</p><img src="img/bradv015.png" alt="下面是图23-5的描述" title="下面是图23-5的描述" longdesc="img_text/bradv015.html"><br><a href="img_text/bradv015.html">“图23-5同步磁带I / O”的说明</a></div>
                           <!-- class="figure" -->
                           <p>发生以下步骤：</p>
                           <ol>
                              <li>
                                 <p>通道进程组成磁带缓冲区。</p>
                              </li>
                              <li>
                                 <p>通道进程执行介质管理器代码，该代码处理磁带缓冲区并将其内部化以供介质管理器进一步处理和存储。</p>
                              </li>
                              <li>
                                 <p>媒体管理器代码向服务器进程返回一条消息，指出它已完成写入。</p>
                              </li>
                              <li>
                                 <p>渠道流程可以启动新任务。</p>
                              </li>
                           </ol>
                           <p><a href="tuning-rman-performance.html#GUID-34FEA214-7C3D-447B-B441-A05C11814015__BABCJEEI">图23-6</a>显示了磁带备份中的异步I / O.使用磁带从属模拟磁带的异步I / O.在这种情况下，每个分配的信道对应于服务器进程，在随后的说明中将其识别为信道进程。对于每个通道进程，启动一个磁带从站（如果存在多个副本，则启动多个磁带从站）。
                           </p>
                           <div class="figure" id="GUID-34FEA214-7C3D-447B-B441-A05C11814015__BABCJEEI">
                              <p class="titleinfigure">图23-6异步磁带I / O.</p><img src="img/bradv012.png" alt="下面是图23-6的描述" title="下面是图23-6的描述" longdesc="img_text/bradv012.html"><br><a href="img_text/bradv012.html">“图23-6异步磁带I / O”的说明</a></div>
                           <!-- class="figure" -->
                           <p>发生以下步骤：</p>
                           <ol>
                              <li>
                                 <p>通道进程将块写入磁带缓冲区。</p>
                              </li>
                              <li>
                                 <p>通道进程向磁带从属进程发送消息以处理磁带缓冲区。磁带从属进程执行介质管理器代码，该代码处理磁带缓冲区并将其内部化，以便介质管理器可以处理它。</p>
                              </li>
                              <li>
                                 <p>当磁带从属进程正在写入时，通道进程可以自由地从数据文件中读取数据并准备更多的输出缓冲区。</p>
                              </li>
                              <li>
                                 <p>磁带从属通道从介质管理器代码返回后，它会请求新的磁带缓冲区，该缓冲区通常已准备就绪。因此减少了信道处理的等待时间，并且更快地完成备份。</p>
                              </li>
                           </ol>
                        </div>
                     </div>
                  </div><a id="BRADV99979"></a><div class="props_rev_3"><a id="GUID-AD7E0880-DEDB-4339-80E6-125F40591F8F" name="GUID-AD7E0880-DEDB-4339-80E6-125F40591F8F"></a><h5 id="BRADV-GUID-AD7E0880-DEDB-4339-80E6-125F40591F8F" class="sect5"><span class="enumeration_section">23.2.3.2</span> SBT写入阶段的媒体管理器组件</h5>
                     <div>
                        <p>多种因素会影响备份到磁带的速度。</p>
                        <p>它们包括以下内容：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="tuning-rman-performance.html#GUID-7F87C520-E4DC-4D2E-9BD5-520715D43FD3" title="如果磁带设备是远程的，则介质管理器必须通过网络传输数据。">网络吞吐量</a></p>
                           </li>
                           <li>
                              <p><a href="tuning-rman-performance.html#GUID-B8428B92-0FD1-4027-9935-D8B8C3A5D9E9" title="磁带本机传输速率是在没有压缩的情况下写入磁带的速度。此速度表示备份速率的上限。">原生转移率</a></p>
                           </li>
                           <li>
                              <p><a href="tuning-rman-performance.html#GUID-93005BE3-2812-42B2-9475-07013BADF2A7" title="磁带压缩级别对备份性能非常重要。如果磁带具有良好的压缩性，则持续备份速率更快。">磁带压缩</a></p>
                           </li>
                           <li>
                              <p><a href="tuning-rman-performance.html#GUID-14C2A81B-F28F-4F32-A6F6-D91F510E08F1" title="写入操作期间的磁带流对磁带备份性能有重大影响。">磁带流</a></p>
                           </li>
                           <li>
                              <p><a href="tuning-rman-performance.html#GUID-F92F1101-04CD-478D-B766-6C01EE4AFB32" title="物理磁带块大小会影响备份性能。">物理磁带块大小</a></p>
                           </li>
                        </ul>
                     </div><a id="BRADV99980"></a><div class="props_rev_3"><a id="GUID-7F87C520-E4DC-4D2E-9BD5-520715D43FD3" name="GUID-7F87C520-E4DC-4D2E-9BD5-520715D43FD3"></a><h6 id="BRADV-GUID-7F87C520-E4DC-4D2E-9BD5-520715D43FD3" class="sect6"><span class="enumeration_section">23.2.3.2.1</span>网络吞吐量</h6>
                        <div>
                           <p>如果磁带设备是远程的，则介质管理器必须通过网络传输数据。</p>
                           <p>例如，Oracle Secure Backup中的管理域可以包含多个联网客户端主机，介质服务器和磁带设备。如果数据库位于一台主机上，但输出磁带驱动器连接到其他主机，则Oracle Secure Backup会管理网络上的数据传输。网络吞吐量是备份性能的上限。</p>
                        </div>
                     </div><a id="BRADV89850"></a><div class="props_rev_3"><a id="GUID-B8428B92-0FD1-4027-9935-D8B8C3A5D9E9" name="GUID-B8428B92-0FD1-4027-9935-D8B8C3A5D9E9"></a><h6 id="BRADV-GUID-B8428B92-0FD1-4027-9935-D8B8C3A5D9E9" class="sect6"><span class="enumeration_section">23.2.3.2.2</span>原生转移率</h6>
                        <div>
                           <p>磁带本机传输速率是在没有压缩的情况下写入磁带的速度。此速度表示备份速率的上限。</p>
                           <p>备份性能的上限应该是所有磁带机的总传输速率。如果备份以该速率执行，并且如果它没有使用过多的CPU，则RMAN性能调整无效。</p>
                        </div>
                     </div><a id="BRADV89851"></a><div class="props_rev_3"><a id="GUID-93005BE3-2812-42B2-9475-07013BADF2A7" name="GUID-93005BE3-2812-42B2-9475-07013BADF2A7"></a><h6 id="BRADV-GUID-93005BE3-2812-42B2-9475-07013BADF2A7" class="sect6"><span class="enumeration_section">23.2.3.2.3</span>磁带压缩</h6>
                        <div>
                           <p>磁带压缩级别对备份性能非常重要。如果磁带具有良好的压缩性，则持续备份速率更快。</p>
                           <p>例如，如果压缩比为2：1并且磁带驱动器的本机传输速率为每秒6兆字节，则生成的备份速度为每秒12兆字节。在这种情况下，RMAN必须能够读取吞吐量超过每秒12兆字节的磁盘，否则磁盘将成为备份的瓶颈。</p>
                           <div class="infoboxnote" id="GUID-93005BE3-2812-42B2-9475-07013BADF2A7__GUID-B38EF514-4F37-40C6-9FAE-6EF52887C635">
                              <p class="notep1">注意：</p>
                              <p>不要同时使用媒体管理器提供的磁带压缩和RMAN提供的二进制压缩。如果媒体管理器压缩效率很高，那么通常是更好的选择。如果压缩RMAN中的数据所需的CPU开销是可接受的，则使用RMAN压缩的备份集可以是减少用于将未压缩的备份集通过网络移动到媒体管理器的带宽的有效替代方案。</p>
                           </div>
                        </div>
                     </div><a id="BRADV89852"></a><div class="props_rev_3"><a id="GUID-14C2A81B-F28F-4F32-A6F6-D91F510E08F1" name="GUID-14C2A81B-F28F-4F32-A6F6-D91F510E08F1"></a><h6 id="BRADV-GUID-14C2A81B-F28F-4F32-A6F6-D91F510E08F1" class="sect6"><span class="enumeration_section">23.2.3.2.4</span>磁带流</h6>
                        <div>
                           <p>写入操作期间的磁带流对磁带备份性能有重大影响。</p>
                           <p>许多磁带驱动器都是固定速度的流式磁带驱动器。因为这样的驱动器只能以一种速度写入数据，当它们用尽数据写入磁带时，磁带必须减速并停止。通常情况下，当驱动器的缓冲区清空时，磁带移动得如此之快，以至于它实际上会超调;要继续写入，驱动器必须重绕磁带以找到它停止写入的位置。多速磁带驱动器可用于缓解此问题。</p>
                        </div>
                     </div><a id="BRADV89853"></a><div class="props_rev_3"><a id="GUID-F92F1101-04CD-478D-B766-6C01EE4AFB32" name="GUID-F92F1101-04CD-478D-B766-6C01EE4AFB32"></a><h6 id="BRADV-GUID-F92F1101-04CD-478D-B766-6C01EE4AFB32" class="sect6"><span class="enumeration_section">23.2.3.2.5</span>物理磁带块大小</h6>
                        <div>
                           <p>物理磁带块大小会影响备份性能。</p>
                           <p>块大小是媒体管理软件在一次写操作中写入磁带的数据量。通常，磁带块大小越大，备份越快。物理磁带块大小不受RMAN或Oracle数据库控制，而是由媒体管理软件控制。有关详细信息，请参阅媒体管理软件的文档。</p>
                        </div>
                     </div>
                  </div>
               </div><a id="BRADV90075"></a><div class="props_rev_3"><a id="GUID-56356B98-2E0F-4D03-9998-F1E8348D9F2B" name="GUID-56356B98-2E0F-4D03-9998-F1E8348D9F2B"></a><h4 id="BRADV-GUID-56356B98-2E0F-4D03-9998-F1E8348D9F2B" class="sect4"><span class="enumeration_section">23.2.4</span>磁盘写入阶段</h4>
                  <div>
                     <p>影响磁盘写入阶段的主要因素是缓冲区大小。</p>
                     <p>当备份的输出驻留在磁盘上时，每个通道分配四个输出缓冲区，每个缓冲区为1 MB。磁盘通道将块写入磁盘子系统。恢复文件时，读取阶段类似于备份文件时的写入阶段，除了块以相反方向移动。</p>
                     <p>如果RMAN异步读取磁盘，则它会异步写入磁盘。写入磁盘时，您可以像从磁盘读取时那样使用磁盘I / O从站。</p>
                     <p>如果RMAN将文件备份到多个磁盘上条带化的基于磁盘的输出目标，则可以分配多个通道。通道数仅限于目标条带化的磁盘数。ASM是在多个磁盘上条带化的目标的一个示例。</p>
                  </div>
               </div>
            </div><a id="BRADV90076"></a><div class="props_rev_3"><a id="GUID-9F7B89D0-969A-47EE-B29B-28C8F5AC3243" name="GUID-9F7B89D0-969A-47EE-B29B-28C8F5AC3243"></a><h3 id="BRADV-GUID-9F7B89D0-969A-47EE-B29B-28C8F5AC3243" class="sect3"><span class="enumeration_section">23.3</span>使用V $视图诊断RMAN性能问题</h3>
               <div>
                  <p>通常，您通过使用<code class="codeph">V$</code>视图来确定RMAN备份和还原操作遇到问题的位置，从而开始调整过程。
                  </p>
                  <p>本节包含以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="tuning-rman-performance.html#GUID-82E0A857-10E7-42B7-ABB4-AFD226AD7159" title="您可以通过查询视图V $ SESSION_LONGOPS来监视备份和还原作业的进度。 RMAN在V $ SESSION_LONGOPS中使用两种类型的行：详细信息行和聚合行。">使用V $ SESSION_LONGOPS监视RMAN作业进度</a></p>
                     </li>
                     <li>
                        <p><a href="tuning-rman-performance.html#GUID-B3E0099F-8F76-4013-8993-550B3BAFF22E" title="您可以使用V $ BACKUP_SYNC_IO和V $ BACKUP_ASYNC_IO视图来确定备份或还原瓶颈的来源，并查看备份作业的详细进度。">使用V $ BACKUP_SYNC_IO和V $ BACKUP_ASYNC_IO识别瓶颈</a></p>
                     </li>
                  </ul>
               </div><a id="BRADV400"></a><a id="BRADV401"></a><a id="BRADV99981"></a><div class="props_rev_3"><a id="GUID-82E0A857-10E7-42B7-ABB4-AFD226AD7159" name="GUID-82E0A857-10E7-42B7-ABB4-AFD226AD7159"></a><h4 id="BRADV-GUID-82E0A857-10E7-42B7-ABB4-AFD226AD7159" class="sect4"><span class="enumeration_section">23.3.1</span>使用V $ SESSION_LONGOPS监视RMAN作业进度</h4>
                  <div>
                     <p>您可以通过查询视图<code class="codeph">V$SESSION_LONGOPS</code>来监视备份和还原作业的进度。 RMAN在<code class="codeph">V$SESSION_LONGOPS</code>使用两种类型的行：详细信息行和聚合行。
                     </p>
                     <div class="section">
                        <p>详细信息行描述由一个作业步骤处理的文件，而聚合行描述由RMAN命令中的所有作业步骤处理的文件。作业步骤是创建或恢复一个备份集或数据文件副本。使用在备份步骤期间读取或写入的每个缓冲区更新详细信息行，因此它们的更新粒度很小。每个作业步骤完成时更新聚合行，因此它们的更新粒度很大。</p>
                        <p><a href="tuning-rman-performance.html#GUID-82E0A857-10E7-42B7-ABB4-AFD226AD7159__G1013679" title="该表在前一段中描述。">表23-3</a>描述了<code class="codeph">V$SESSION_LONGOPS</code>中与RMAN最相关的列。通常，您查看详细信息行而不是聚合行以确定每个备份集的进度。
                        </p>
                        <div class="tblformal" id="GUID-82E0A857-10E7-42B7-ABB4-AFD226AD7159__G1013679">
                           <p class="titleintable">表23-3 V $ SESSION_LONGOPS的列与RMAN相关</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="V $ SESSION_LONGOPS的列与RMAN相关" width="100%" border="1" summary="This table is described in the preceding paragraph." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="20%" id="d100789e2359">柱</th>
                                    <th align="left" valign="bottom" width="80%" id="d100789e2362">细节行描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d100789e2367" headers="d100789e2359 ">
                                       <p><code class="codeph">SID</code></p>
                                    </td>
                                    <td align="left" valign="top" width="80%" headers="d100789e2367 d100789e2362 ">
                                       <p>与RMAN信道对应的服务器会话ID</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d100789e2375" headers="d100789e2359 ">
                                       <p><code class="codeph">SERIAL＃</code></p>
                                    </td>
                                    <td align="left" valign="top" width="80%" headers="d100789e2375 d100789e2362 ">
                                       <p>服务器会话序列号。每次重用服务器会话时，此值都会更改。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d100789e2383" headers="d100789e2359 ">
                                       <p><code class="codeph">OPNAME</code></p>
                                    </td>
                                    <td align="left" valign="top" width="80%" headers="d100789e2383 d100789e2362 ">
                                       <p>行的文本描述。详细信息行的示例包括<code class="codeph">RMAN:</code> <code class="codeph">datafile</code> <code class="codeph">copy</code> ， <code class="codeph">RMAN:</code> <code class="codeph">full</code> <code class="codeph">datafile</code> <code class="codeph">backup</code>和<code class="codeph">RMAN:</code> <code class="codeph">full</code> <code class="codeph">datafile</code> <code class="codeph">restore</code> 。
                                       </p>
                                       <p><span class="bold">注意：</span> <code class="codeph">RMAN:</code> <code class="codeph">aggregate</code> <code class="codeph">input</code>和<code class="codeph">RMAN:</code> <code class="codeph">aggregate</code> <code class="codeph">output</code>是唯一的聚合行。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d100789e2448" headers="d100789e2359 ">
                                       <p><code class="codeph">CONTEXT</code></p>
                                    </td>
                                    <td align="left" valign="top" width="80%" headers="d100789e2448 d100789e2362 ">
                                       <p>对于备份输出行，此值为<code class="codeph">2</code> 。对于除代理副本（不更新此列）之外的所有其他行，值为<code class="codeph">1</code> 。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d100789e2462" headers="d100789e2359 ">
                                       <p><code class="codeph">至今</code></p>
                                    </td>
                                    <td align="left" valign="top" width="80%" headers="d100789e2462 d100789e2362 ">
                                       <p>此列的含义取决于此行描述的操作类型：</p>
                                       <ul style="list-style-type:disc">
                                          <li>
                                             <p>对于映像副本，已读取的块数</p>
                                          </li>
                                          <li>
                                             <p>对于备份输入行，已从正在备份的文件中读取的块数</p>
                                          </li>
                                          <li>
                                             <p>对于备份输出行，已写入备份片的块数</p>
                                          </li>
                                          <li>
                                             <p>对于还原，已处理到在此一个作业步骤中正在还原的文件的块数</p>
                                          </li>
                                          <li>
                                             <p>对于代理副本，已复制的文件数</p>
                                          </li>
                                       </ul>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d100789e2486" headers="d100789e2359 ">
                                       <p><code class="codeph">TOTALWORK</code></p>
                                    </td>
                                    <td align="left" valign="top" width="80%" headers="d100789e2486 d100789e2362 ">
                                       <p>此列的含义取决于此行描述的操作类型：</p>
                                       <ul style="list-style-type:disc">
                                          <li>
                                             <p>对于映像副本，文件中的块总数。</p>
                                          </li>
                                          <li>
                                             <p>对于备份输入行，从此作业步骤中处理的所有文件中读取的块总数。</p>
                                          </li>
                                          <li>
                                             <p>对于备份输出行，该值为<code class="codeph">0</code>因为RMAN不知道它将写入任何备份片的块数。
                                             </p>
                                          </li>
                                          <li>
                                             <p>对于还原，此作业步骤中还原的所有文件中的块总数。</p>
                                          </li>
                                          <li>
                                             <p>对于代理副本，在此作业步骤中要复制的文件总数。</p>
                                          </li>
                                       </ul>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                        <p>执行备份或还原作业的每个服务器会话都会报告与作业步骤所需的总工作量相比的进度。例如，如果使用两个通道还原数据库，并且每个通道有两个要还原的备份集（总共四组），则每个服务器会话通过单个备份集报告其进度。完全恢复集合后，RMAN开始报告要恢复的下一组的进度。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-82E0A857-10E7-42B7-ABB4-AFD226AD7159__GUID-EA0C36DA-6F39-44CC-AD04-D7590A93229C">监控RMAN作业进度：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>在启动RMAN作业之前，请创建一个包含以下SQL语句的脚本文件（对于此示例称为<code class="codeph">longops</code> ）：</span><div><pre class="oac_no_warn" dir="ltr">SELECT SID，SERIAL＃，CONTEXT，SOFAR，TOTALWORK，ROUND（SOFAR / TOTALWORK * 100,2）“％_COMPLETE”来自V $ SESSION_LONGOPS WHERE OPNAME喜欢'RMAN％'和OPNAME不喜欢'％aggregate％'和TOTALWORK！= 0 AND SOFAR &lt;&gt; TOTALWORK;</pre></div>
                        </li>
                        <li class="stepexpand"><span>启动RMAN并连接到目标数据库和恢复目录（如果使用）。</span></li>
                        <li class="stepexpand"><span>开始RMAN工作。例如，输入：</span><div><pre class="oac_no_warn" dir="ltr">RMAN&gt; RESTORE DATABASE <code class="codeph">;</code>
</pre></div>
                        </li>
                        <li class="stepexpand"><span>在RMAN作业运行时，启动SQL * Plus并连接到目标数据库，然后执行<code class="codeph">longops</code>脚本以检查RMAN作业的进度。如果在RMAN作业进行时重复查询，则会看到如下输出：</span><div><pre class="oac_no_warn" dir="ltr">SQL&gt; @longops SID SERIAL＃CONTEXT SOFAR TOTALWORK％_COMPLETE ---------- ---------- ---------- -------- -  ---------- ---------- 8 19 1 10377 36617 28.34 SQL&gt; @longops SID SERIAL＃CONTEXT SOFAR TOTALWORK％COMPLETE ---------- ---------- ---------- ---------- ---------- ---------- 8 19 1 21513 36617 58.75 SQL&gt; @longops SID SERIAL＃CONTEXT SOFAR TOTALWORK％COMPLETE ---------- ---------- ----------- -------- ---------- ---------- 8 19 1 29641 36617 80.95 SQL&gt; @longops SID SERIAL＃CONTEXT SOFAR TOTALWORK％COMPLETE ---- ------ ---------- ---------- ---------- ---------- ---- ------ 8 19 1 35849 36617 97.9 SQL&gt; @longops未选择任何行</pre></div>
                        </li>
                        <li class="stepexpand"><span>如果以2分钟或更长的间隔运行<code class="codeph">longops</code>脚本并且<code class="codeph">%</code> _ <code class="codeph">COMPLETE</code>列未增加，则RMAN遇到问题。请参阅<span class="q">“ <a href="troubleshooting-rman-operations.html#GUID-6B323AE8-1E76-45E6-8434-3DCC5CE2E873" title="您可以使用动态性能事件视图中的事件名称来监视对媒体管理API的RMAN调用。事件名称与SBT功能一一对应。">监视与媒体管理器的RMAN交互</a> ”</span>以获取更多信息。</span></li>
                     </ol>
                     <div class="section">
                        <p>如果经常监视长时间运行的任务的执行，则可以在运行SQL * Plus的主机操作系统下创建一个shell脚本或批处理文件，以重复执行此查询。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="BRADV402"></a><a id="BRADV89862"></a><div class="props_rev_3"><a id="GUID-B3E0099F-8F76-4013-8993-550B3BAFF22E" name="GUID-B3E0099F-8F76-4013-8993-550B3BAFF22E"></a><h4 id="BRADV-GUID-B3E0099F-8F76-4013-8993-550B3BAFF22E" class="sect4"><span class="enumeration_section">23.3.2</span>使用V $ BACKUP_SYNC_IO和V $ BACKUP_ASYNC_IO识别瓶颈</h4>
                  <div>
                     <p>您可以使用<code class="codeph">V$BACKUP_SYNC_IO</code>和<code class="codeph">V$BACKUP_ASYNC_IO</code>视图来确定备份或还原瓶颈的来源，并查看备份作业的详细进度。
                     </p>
                     <div class="section">
                        <p>当I / O与执行备份的进程（或某些平台上的线程）同步时， <code class="codeph">V$BACKUP_SYNC_IO</code>包含行。当I / O异步时， <code class="codeph">V$BACKUP_ASYNC_IO</code>包含行。异步I / O可以通过I / O进程获得，也可以由底层操作系统支持。
                        </p>
                        <p>在数据库实例关闭之前，备份或还原作业的结果将保留在内存中。因此，您可以在作业完成后查询视图。</p>
                        <p>在I / O同步时确定磁带是否正在流式传输：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>启动SQL * Plus并连接到目标数据库。</span></li>
                        <li class="stepexpand"><span>查询<code class="codeph">V$BACKUP_SYNC_IO</code>或<code class="codeph">V$BACKUP_ASYNC_IO</code>视图中的<code class="codeph">EFFECTIVE_BYTES_PER_SECOND</code>列。</span><div>
                              <p>如果<code class="codeph">EFFECTIVE_BYTES_PER_SECOND</code>小于硬件的原始容量，则磁带不会流式传输。如果<code class="codeph">EFFECTIVE_BYTES_PER_SECOND</code>大于硬件的原始容量，则磁带可能是也可能不是流式传输。压缩可能导致<code class="codeph">EFFECTIVE_BYTES_PER_SECOND</code>大于实际I / O的速度。</p>
                           </div>
                        </li>
                     </ol>
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-B3E0099F-8F76-4013-8993-550B3BAFF22E__GUID-0E412F03-BE1F-4793-B34D-115AB9A3F83E">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="../refrn/index.html" target="_blank"><span class="italic">Oracle Database Reference</span></a>有关这些视图的更多信息</p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div><a id="BRADV403"></a><a id="BRADV89863"></a><div class="props_rev_3"><a id="GUID-5D8AAB8F-8A63-4B82-9BFB-16D22CE439FD" name="GUID-5D8AAB8F-8A63-4B82-9BFB-16D22CE439FD"></a><h5 id="BRADV-GUID-5D8AAB8F-8A63-4B82-9BFB-16D22CE439FD" class="sect5"><span class="enumeration_section">23.3.2.1</span>使用同步I / O识别瓶颈</h5>
                     <div>
                        <p>查询<code class="codeph">V$BACKUP_SYNC_IO</code>视图以识别具有同步I / O的瓶颈。</p>
                        <div class="section">
                           <p>对于同步I / O，很难识别特定的瓶颈，因为所有同步I / O都是该过程的瓶颈。调整同步I / O的唯一方法是将速率（以每秒字节数为单位）与设备的最大吞吐率进行比较。如果速率低于设备指定的速率，请考虑调整备份和还原过程的这一方面。</p>
                           <p>要确定同步I / O的速率：</p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>启动SQL * Plus并连接到目标数据库。</span></li>
                           <li class="stepexpand"><span>查询<code class="codeph">V$BACKUP_SYNC_IO</code>视图中的<code class="codeph">DISCRETE_BYTES_PER_SECOND</code>列以显示I / O速率。</span><div>
                                 <p>如果您在<code class="codeph">V$BACKUP_SYNC_IO</code>看到数据，则问题是您没有启用异步I / O或者您没有使用磁盘I / O从站。
                                 </p>
                              </div>
                           </li>
                        </ol>
                     </div>
                  </div><a id="BRADV404"></a><a id="BRADV89864"></a><div class="props_rev_3"><a id="GUID-CD6CA7F3-F59B-4FB6-8F8C-B378DBEEBCD0" name="GUID-CD6CA7F3-F59B-4FB6-8F8C-B378DBEEBCD0"></a><h5 id="BRADV-GUID-CD6CA7F3-F59B-4FB6-8F8C-B378DBEEBCD0" class="sect5"><span class="enumeration_section">23.3.2.2</span>使用异步I / O识别瓶颈</h5>
                     <div>
                        <p>查询<code class="codeph">V$BACKUP_ASYNC_IO</code>以识别异步I / O的瓶颈。</p>
                        <div class="section">
                           <p><strong class="term">长等待</strong>是备份或还原过程告诉操作系统等待I / O完成的次数。<strong class="term">短等待</strong>是备份或还原过程在非阻塞模式下进行操作系统调用以轮询I / O完成的次数。<strong class="term">Ready</strong>指示I / O准备就绪的次数，因此无需进行操作系统调用以轮询I / O完成。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-CD6CA7F3-F59B-4FB6-8F8C-B378DBEEBCD0__GUID-59ACB37B-5440-45D1-A9B1-AED1DD9D4029">要确定异步I / O的速率：</p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>启动SQL * Plus并连接到目标数据库。</span></li>
                           <li class="stepexpand"><span>查询<code class="codeph">V$BACKUP_ASYNC_IO</code>视图中的<code class="codeph">LONG_WAITS</code>和<code class="codeph">IO_COUNT</code>列以显示I / O速率。</span><div>
                                 <p>识别瓶颈的最简单方法是找到<code class="codeph">LONG_WAITS</code>比率最大的数据文件除以<code class="codeph">IO_COUNT</code> 。例如，您可以使用以下查询：</p><pre class="oac_no_warn" dir="ltr">SELECT LONG_WAITS / IO_COUNT，FILENAME FROM V $ BACKUP_ASYNC_IO WHERE LONG_WAITS / IO_COUNT&gt; 0 ORDER BY LONG_WAITS / IO_COUNT DESC;</pre></div>
                           </li>
                        </ol>
                        <div class="section">
                           <div class="infoboxnote" id="GUID-CD6CA7F3-F59B-4FB6-8F8C-B378DBEEBCD0__GUID-A3BDB529-CEFB-45A0-93C6-CE0938B50164">
                              <p class="notep1">注意：</p>
                              <p>如果您有同步I / O但设置了<code class="codeph">BACKUP_DISK_IO_SLAVES</code> ，那么I / O将显示在<code class="codeph">V$BACKUP_ASYNC_IO</code> 。</p>
                           </div>
                           <div class="infoboxnotealso" id="GUID-CD6CA7F3-F59B-4FB6-8F8C-B378DBEEBCD0__GUID-9649AC95-51E9-4FED-AD9C-E2D3A693C2F9">
                              <p class="notep1">也可以看看：</p>
                              <p><a href="../refrn/dynamic-performance-views.html#REFRN003" target="_blank"><span><cite>Oracle Database Reference，</cite></span></a>用于描述<code class="codeph">V$BACKUP_SYNC_IO</code>和<code class="codeph">V$BACKUP_ASYNC_IO</code>视图</p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div>
            </div><a id="BRADV172"></a><div class="props_rev_3"><a id="GUID-5AAB8C9A-41C6-4400-B643-08D10D7106AD" name="GUID-5AAB8C9A-41C6-4400-B643-08D10D7106AD"></a><h3 id="BRADV-GUID-5AAB8C9A-41C6-4400-B643-08D10D7106AD" class="sect3"><span class="enumeration_section">23.4</span>调整RMAN备份性能</h3>
               <div>
                  <p>许多因素都会影响备份性能。通常，找到缓慢备份的解决方案是一个反复试验的过程。</p>
                  <div class="section">
                     <p><span class="bold">要获得备份的最佳性能，请按照下列步骤操作：</span></p>
                     <ol>
                        <li>
                           <p>删除通道设置的<code class="codeph">RATE</code>参数，如<span class="q">“ <a href="tuning-rman-performance.html#GUID-B0E48A46-024E-4C26-BD09-A8BE96FFE5C7" title="通道上的RATE参数旨在减少而不是增加备份吞吐量，以便为其他数据库操作提供更多磁盘带宽。如果备份未流式传输到磁带，则确认未设置RATE参数。">从通道设置中删除RATE参数</a> ”中所述</span> 。
                           </p>
                        </li>
                        <li>
                           <p>如果磁盘不支持异步I / O，则设置<code class="codeph">DBWR_IO_SLAVES</code>参数，如<span class="q">“ <a href="tuning-rman-performance.html#GUID-B0A3D96A-D65B-4D15-8AB8-A84494F545FA" title="某些操作系统支持本机异步I / O.当且仅当您的磁盘不支持异步I / O时，请设置DBWR_IO_SLAVES。 DBWR_IO_SLAVES的任何非零值都会导致固定数量的磁盘I / O从站用于备份和还原，从而模拟异步I / O.">将DBWR_IO_SLAVES设置为模拟异步I / O</a> ”中所述</span> 。
                           </p>
                        </li>
                        <li>
                           <p>设置<code class="codeph">LARGE_POOL_SIZE</code>参数，如<span class="q">“ <a href="tuning-rman-performance.html#GUID-B2B1A6DB-6C3D-4E41-B285-26289713D473" title="如果数据库在警报日志中报告错误，指出它没有足够的内存并且无法启动I / O从属，请设置LARGE_POOL_SIZE初始化参数。">设置LARGE_POOL_SIZE以解决共享内存问题</a> ”中所述</span> 。
                           </p>
                        </li>
                        <li>
                           <p>删除影响备份性能的瓶颈，如<span class="q">“ <a href="tuning-rman-performance.html#GUID-4189FC87-CD02-49CD-A311-887ABAA34004" title="您可以执行多项任务来识别和修复影响备份性能的瓶颈。">调整读取，写入和复制阶段</a> ”中所述</span> 。
                           </p>
                        </li>
                     </ol>
                  </div>
                  <!-- class="section" -->
               </div><a id="BRADV405"></a><a id="BRADV89855"></a><div class="props_rev_3"><a id="GUID-B0E48A46-024E-4C26-BD09-A8BE96FFE5C7" name="GUID-B0E48A46-024E-4C26-BD09-A8BE96FFE5C7"></a><h4 id="BRADV-GUID-B0E48A46-024E-4C26-BD09-A8BE96FFE5C7" class="sect4"><span class="enumeration_section">23.4.1</span>从通道设置中删除RATE参数</h4>
                  <div>
                     <p>通道上的<code class="codeph">RATE</code>参数旨在减少而不是增加备份吞吐量，以便为其他数据库操作提供更多磁盘带宽。如果备份未流式传输到磁带，则确认未设置<code class="codeph">RATE</code>参数。
                     </p>
                     <div class="section"></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p><span class="bold">要删除RATE参数：</span></p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>检查您的备份脚本。</span></li>
                        <li class="stepexpand"><span>执行以下操作之一：</span><div>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>如果备份在<code class="codeph">RUN</code>命令中，则从<code class="codeph">ALLOCATE</code>命令中删除<code class="codeph">RATE</code>参数（如果已指定）。跳过剩下的步骤。
                                    </p>
                                 </li>
                                 <li>
                                    <p>如果备份不在<code class="codeph">RUN</code>命令中，则启动RMAN，连接到目标数据库，然后继续执行下一步。
                                    </p>
                                 </li>
                              </ul>
                           </div>
                        </li>
                        <li class="stepexpand"><span>执行<code class="codeph">SHOW ALL</code>命令以显示当前配置的设置。</span></li>
                        <li class="stepexpand"><span>如果已设置，则从<code class="codeph">CONFIGURE CHANNEL</code>命令中删除<code class="codeph">RATE</code>参数。</span></li>
                     </ol>
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-B0E48A46-024E-4C26-BD09-A8BE96FFE5C7__GUID-18BCCE40-416D-4252-9A18-777758ACF56A">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="tuning-rman-performance.html#GUID-5A55B177-B2A8-47AE-A6E9-693DFB5CC613" title="您可以使用RATE参数设置读取的字节数的上限，以便RMAN不会消耗过多的磁盘带宽并降低在线性能。从本质上讲，RATE充当备用节流阀。">速率通道参数</a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="BRADV406"></a><a id="BRADV89856"></a><div class="props_rev_3"><a id="GUID-B0A3D96A-D65B-4D15-8AB8-A84494F545FA" name="GUID-B0A3D96A-D65B-4D15-8AB8-A84494F545FA"></a><h4 id="BRADV-GUID-B0A3D96A-D65B-4D15-8AB8-A84494F545FA" class="sect4"><span class="enumeration_section">23.4.2</span>设置DBWR_IO_SLAVES以模拟异步I / O.</h4>
                  <div>
                     <p>某些操作系统支持本机异步I / O.当且仅当您的磁盘<span class="italic">不</span>支持异步I / O，然后设置<code class="codeph">DBWR_IO_SLAVES</code> 。 <code class="codeph">DBWR_IO_SLAVES</code>任何非零值都会导致固定数量的磁盘I / O从站用于备份和还原，从而模拟异步I / O.</p>
                     <div class="section"></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p><span class="bold">要启用磁盘I / O从站：</span></p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>启动SQL * Plus并连接到目标数据库。</span></li>
                        <li class="stepexpand"><span>关闭数据库。</span></li>
                        <li class="stepexpand"><span>将<code class="codeph">DBWR_IO_SLAVES</code>初始化参数设置为非零值。</span><div>
                              <p>此设置使数据库写程序进程可以使用从属进程。因此，您可能需要增加<code class="codeph">PROCESSES</code>初始化参数的值。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>重启数据库。</span></li>
                        <li class="stepexpand"><span>重新启动RMAN备份。</span></li>
                     </ol>
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-B0A3D96A-D65B-4D15-8AB8-A84494F545FA__GUID-ABEE827A-78CF-492E-8354-E39338D4A772">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="tuning-rman-performance.html#GUID-6339C9D0-E98C-49E0-8C82-1EBA810EBB0B" title="当通道读取或写入磁盘时，I / O是同步I / O或异步I / O.">同步和异步磁盘I / O.</a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="BRADV407"></a><a id="BRADV89857"></a><div class="props_rev_3"><a id="GUID-B2B1A6DB-6C3D-4E41-B285-26289713D473" name="GUID-B2B1A6DB-6C3D-4E41-B285-26289713D473"></a><h4 id="BRADV-GUID-B2B1A6DB-6C3D-4E41-B285-26289713D473" class="sect4"><span class="enumeration_section">23.4.3</span>设置LARGE_POOL_SIZE以解决共享内存问题</h4>
                  <div>
                     <p>如果数据库在警报日志中报告错误，指出它没有足够的内存并且无法启动I / O从属，请设置<code class="codeph">LARGE_POOL_SIZE</code>初始化参数。
                     </p>
                     <div class="section">
                        <p>警报日志消息类似于以下内容：</p><pre class="oac_no_warn" dir="ltr">ksfqxcre：无法分配共享内存意味着只要本机不支持async I / O，就会使用同步I / O</pre><p>大型池用于RMAN和其他用途，因此其总大小必须适应所有用途。如果已设置<code class="codeph">DBWR_IO_SLAVES</code>并且DBWR进程需要缓冲区，则尤其如此。
                        </p>
                        <p><span class="bold">要设置较大的池大小：</span></p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>启动SQL * Plus并连接到目标数据库。</span></li>
                        <li class="stepexpand"><span>（可选）查询<code class="codeph">V$SGASTAT.POOL</code>以确定对象的内存驻留在哪个池（共享池或大池）中。</span></li>
                        <li class="stepexpand"><span>在目标数据库中设置<code class="codeph">LARGE_POOL_SIZE</code>初始化参数。</span><div>
                              <p>您可以执行<code class="codeph">ALTER SYSTEM SET</code>语句来动态设置参数。该<span class="italic"> </span>设置<code class="codeph">LARGE_POOL_SIZE</code>公式如下：</p><pre class="oac_no_warn" dir="ltr">LARGE_POOL_SIZE = <span class="italic"><code class="codeph">number_of_allocated_channels</code></span> *（16 MB +（4 * <span class="italic">size_of_tape_buffer</span> ））</pre></div>
                        </li>
                        <li class="stepexpand"><span>重新启动RMAN备份。</span></li>
                     </ol>
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-B2B1A6DB-6C3D-4E41-B285-26289713D473__GUID-89ACE45B-48F1-402D-A43B-D29947CDE589">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>有关大型池的更多信息，请<a href="../cncpt/memory-architecture.html#CNCPT802" target="_blank"><span><cite>参见Oracle数据库概念</cite></span></a></p>
                              </li>
                              <li>
                                 <p><a href="../refrn/LARGE_POOL_SIZE.html#REFRN10078" target="_blank"><span><cite>Oracle Database Reference</cite></span></a>有关初始化参数的完整信息</p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="BRADV89858"></a><div class="props_rev_3"><a id="GUID-4189FC87-CD02-49CD-A311-887ABAA34004" name="GUID-4189FC87-CD02-49CD-A311-887ABAA34004"></a><h4 id="BRADV-GUID-4189FC87-CD02-49CD-A311-887ABAA34004" class="sect4"><span class="enumeration_section">23.4.4</span>调整读，写和复制阶段</h4>
                  <div>
                     <p>您可以执行多项任务来识别和修复影响备份性能的瓶颈。</p>
                     <div class="section">
                        <p>这包括以下任务：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="tuning-rman-performance.html#GUID-DA0FFF93-832C-41E9-9162-157F589A7082" title="确定输出设备或输入磁盘I / O是否是给定备份作业的瓶颈的一种可靠方法是将运行备份任务所需的时间与运行相同任务的BACKUP VALIDATE所需的时间进行比较。备份的BACKUP VALIDATE执行与真实备份相同的磁盘读取，但不对输出设备执行I / O.">使用备份验证来区分读取和写入瓶颈</a></p>
                           </li>
                           <li>
                              <p><a href="tuning-rman-performance.html#GUID-F2715D6D-F750-4B4B-8A8A-BC4B2ECE6D23" title="调整读取阶段有助于提高RMAN性能。">调整读取阶段</a></p>
                           </li>
                           <li>
                              <p><a href="tuning-rman-performance.html#GUID-3303B929-0747-4E78-BED1-9F468213F357" title="如果读取阶段表现良好，那么复制或写入阶段可能是瓶颈。特别是，如果RMAN正在以足够快的速度向磁带驱动器发送数据块以支持流式传输，但磁带不是流式传输，那么SBT写入阶段就是瓶颈。">调整复制和写入阶段</a></p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div><a id="BRADV408"></a><a id="BRADV89859"></a><div class="props_rev_3"><a id="GUID-DA0FFF93-832C-41E9-9162-157F589A7082" name="GUID-DA0FFF93-832C-41E9-9162-157F589A7082"></a><h5 id="BRADV-GUID-DA0FFF93-832C-41E9-9162-157F589A7082" class="sect5"><span class="enumeration_section">23.4.4.1</span>使用备份验证来区分读取和写入瓶颈</h5>
                     <div>
                        <p>确定输出设备或输入磁盘I / O是否是给定备份作业的瓶颈的一种可靠方法是将运行备份任务所需的时间与运行相同任务的<code class="codeph">BACKUP VALIDATE</code>所需的时间进行比较。<code class="codeph">BACKUP VALIDATE</code>执行与真实备份相同的磁盘读取，但不对输出设备执行I / O.
                        </p>
                        <div class="section">
                           <p><span class="bold">要比较备份和验证时间：</span></p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>确保将NLS环境日期格式变量设置为显示时间。例如，设置NLS变量如下：</span><div><pre class="oac_no_warn" dir="ltr">setenv NLS_LANG AMERICAN_AMERICA.WE8DEC; setenv NLS_DATE_FORMAT“MM / DD / YYYY HH24：MI：SS”</pre></div>
                           </li>
                           <li class="stepexpand"><span>编辑备份脚本以使用<code class="codeph">BACKUP VALIDATE</code>命令而不是<code class="codeph">BACKUP</code>命令。</span></li>
                           <li class="stepexpand"><span>运行备份脚本。</span></li>
                           <li class="stepexpand"><span>检查RMAN输出并计算<code class="codeph">Starting backup at</code>显示的时间与消息上的<code class="codeph">Finished backup at</code>之间的差异。</span></li>
                           <li class="stepexpand"><span>编辑备份脚本以使用<code class="codeph">BACKUP</code>命令而不是<code class="codeph">BACKUP VALIDATE</code>命令。</span></li>
                           <li class="stepexpand"><span>运行备份脚本。</span></li>
                           <li class="stepexpand"><span>检查RMAN输出并计算<code class="codeph">Starting backup at</code>显示的时间与消息上的<code class="codeph">Finished backup at</code>之间的差异。</span></li>
                           <li class="stepexpand"><span>比较验证和实际备份的备份时间。</span><div>
                                 <p>如果<code class="codeph">BACKUP VALIDATE</code>到磁带的时间与实际备份到磁带的时间大致相同，那么从磁盘读取可能是瓶颈。
                                 </p>
                                 <p>如果<code class="codeph">BACKUP VALIDATE</code>到磁带的时间远远小于真正备份到磁带的时间，那么写入输出设备可能是瓶颈。
                                 </p>
                              </div>
                           </li>
                        </ol>
                        <div class="section">
                           <div class="infoboxnotealso" id="GUID-DA0FFF93-832C-41E9-9162-157F589A7082__GUID-91292A39-0110-4FDE-B534-6D5AFF0A476E">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><a href="tuning-rman-performance.html#GUID-F2715D6D-F750-4B4B-8A8A-BC4B2ECE6D23" title="调整读取阶段有助于提高RMAN性能。">调整读取阶段</a></p>
                                 </li>
                                 <li>
                                    <p><a href="tuning-rman-performance.html#GUID-3303B929-0747-4E78-BED1-9F468213F357" title="如果读取阶段表现良好，那么复制或写入阶段可能是瓶颈。特别是，如果RMAN正在以足够快的速度向磁带驱动器发送数据块以支持流式传输，但磁带不是流式传输，那么SBT写入阶段就是瓶颈。">调整复制和写入阶段</a> 。
                                    </p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="BRADV409"></a><a id="BRADV89860"></a><div class="props_rev_3"><a id="GUID-F2715D6D-F750-4B4B-8A8A-BC4B2ECE6D23" name="GUID-F2715D6D-F750-4B4B-8A8A-BC4B2ECE6D23"></a><h5 id="BRADV-GUID-F2715D6D-F750-4B4B-8A8A-BC4B2ECE6D23" class="sect5"><span class="enumeration_section">23.4.4.2</span>调整读取阶段</h5>
                     <div>
                        <p>调整读取阶段有助于提高RMAN性能。</p>
                        <div class="section">
                           <p>RMAN可能无法足够快地将数据块发送到输出设备以使其保持占用状态。例如，在<a href="glossary.html#GUID-31E3AC05-E73E-4E44-A9AA-915988B9A6A3"><span class="xrefglossterm">增量备份</span></a>期间，RMAN仅备份自上次数据文件备份以来更改的块作为同一策略的一部分。如果不打开<a href="glossary.html#GUID-C80ACD57-9170-4FA5-A61F-81A05E77A1A4"><span class="xrefglossterm">块更改跟踪</span></a> ，则RMAN必须扫描整个数据文件以查找更改的块，并在找到此类块时填充输出缓冲区。如果更改了几个块，并且RMAN正在进行SBT备份，则RMAN可能无法足够快地填充输出缓冲区以保持磁带驱动器流式传输。
                           </p>
                           <p>您可以通过调整<a href="glossary.html#GUID-648D7B2D-7AB2-40C0-AFFD-0A6FE569F3D7"><span class="xrefglossterm">多路复用级别</span></a>来提高备份性能<a href="glossary.html#GUID-648D7B2D-7AB2-40C0-AFFD-0A6FE569F3D7"><span class="xrefglossterm">，多路复用级别</span></a>是同时读取的输入文件数，然后写入同一个RMAN备份片。多路复用级别是通道上<code class="codeph">MAXOPENFILES</code>设置的最小值和每个备份集中放置的输入文件数。下表提供了调整多路复用级别的建议。
                           </p>
                           <div class="tblformal" id="GUID-F2715D6D-F750-4B4B-8A8A-BC4B2ECE6D23__GUID-EED07681-166A-4905-AAAB-1CE59F011A74">
                              <p class="titleintable">表23-4调整复用级别</p>
                              <table cellpadding="4" cellspacing="0" class="Formal" title="调整多路复用级别" width="100%" border="1" summary="Level of multiplexing" frame="hsides" rules="rows">
                                 <thead>
                                    <tr align="left" valign="top">
                                       <th align="left" valign="bottom" width="14%" id="d100789e3896">ASM</th>
                                       <th align="left" valign="bottom" width="29%" id="d100789e3899">条纹磁盘</th>
                                       <th align="left" valign="bottom" width="57%" id="d100789e3902">建议</th>
                                    </tr>
                                 </thead>
                                 <tbody>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="14%" id="d100789e3907" headers="d100789e3896 ">
                                          <p>没有</p>
                                       </td>
                                       <td align="left" valign="top" width="29%" headers="d100789e3907 d100789e3899 ">
                                          <p>是</p>
                                       </td>
                                       <td align="left" valign="top" width="57%" headers="d100789e3907 d100789e3902 ">
                                          <p>提高多路复用的水平。确定哪个是最小值， <code class="codeph">MAXOPENFILES</code>或每个备份集中的文件数，然后增加此值。
                                          </p>
                                          <p>通过这种方式，您可以提高RMAN填充磁带缓冲区的速率，这使得缓冲区更有可能以足够快的速度发送到媒体管理器以维持流式传输。</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="14%" id="d100789e3922" headers="d100789e3896 ">
                                          <p>没有</p>
                                       </td>
                                       <td align="left" valign="top" width="29%" headers="d100789e3922 d100789e3899 ">
                                          <p>没有</p>
                                       </td>
                                       <td align="left" valign="top" width="57%" headers="d100789e3922 d100789e3902 ">
                                          <p>增加通道上的<code class="codeph">MAXOPENFILES</code>设置。
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="14%" id="d100789e3935" headers="d100789e3896 ">
                                          <p>是</p>
                                       </td>
                                       <td align="left" valign="top" width="29%" headers="d100789e3935 d100789e3899 ">
                                          <p>不适用</p>
                                       </td>
                                       <td align="left" valign="top" width="57%" headers="d100789e3935 d100789e3902 ">
                                          <p>将通道上的<code class="codeph">MAXOPENFILES</code>参数设置为<code class="codeph">1</code>或<code class="codeph">2</code> 。
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <!-- class="inftblhruleinformal" -->
                           <div class="infoboxnotealso" id="GUID-F2715D6D-F750-4B4B-8A8A-BC4B2ECE6D23__GUID-4E86A862-7A97-4DCD-B2BC-04453FCDA43F">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><span class="q">“ <a href="rman-backup-concepts.html#GUID-6E6613A6-545A-4E65-8D5E-849CB6B91E97" title="创建备份集时，RMAN可以同时从磁盘读取多个文件，然后将其块写入同一备份集。例如，RMAN可以同时读取两个数据文件，然后将这些数据文件中的块组合成一个备份片。来自多个文件的块组合称为备份多路复用。">关于多路复用RMAN备份集</a> ”</span> ，了解<code class="codeph">MAXOPENFILES</code>和<code class="codeph">FILESPERSET</code>设置如何影响多路复用级别</p>
                                 </li>
                                 <li>
                                    <p><span class="q">“ <a href="rman-backup-concepts.html#GUID-C93F3588-BBA9-4AE2-9E47-74C7A9468023" title="增量备份仅复制自上次备份以来已更改的数据块。您可以使用RMAN创建数据文件，表空间或整个数据库的增量备份。">关于RMAN增量备份</a> ”</span>的概念性概述</p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="BRADV89861"></a><div class="props_rev_3"><a id="GUID-3303B929-0747-4E78-BED1-9F468213F357" name="GUID-3303B929-0747-4E78-BED1-9F468213F357"></a><h5 id="BRADV-GUID-3303B929-0747-4E78-BED1-9F468213F357" class="sect5"><span class="enumeration_section">23.4.4.3</span>调整复制和写入阶段</h5>
                     <div>
                        <p>如果读取阶段表现良好，那么复制或写入阶段可能是瓶颈。特别是，如果RMAN正在以足够快的速度向磁带驱动器发送数据块以支持流式传输，但磁带不是流式传输，那么SBT写入阶段就是瓶颈。</p>
                        <div class="section">
                           <div class="p">尝试使用下表中描述的技术之一来提高性能。
                              <div class="tblformal" id="GUID-3303B929-0747-4E78-BED1-9F468213F357__GUID-25D6F10A-8A0B-4B5E-A74D-B44526F62CA4">
                                 <p class="titleintable">表23-5提高复制和写入性能的技术</p>
                                 <table cellpadding="4" cellspacing="0" class="Formal" title="提高复制和写入性能的技术" border="1" summary="This table describes the techniques available to improve copy and writer performance." frame="hsides" rules="rows">
                                    <thead>
                                       <tr align="left" valign="top">
                                          <th align="left" valign="bottom" width="20%" id="d100789e4065">技术</th>
                                          <th align="left" valign="bottom" width="20%" id="d100789e4067">描述</th>
                                          <th align="left" valign="bottom" width="20%" id="d100789e4069">额外的信息</th>
                                       </tr>
                                    </thead>
                                    <tbody>
                                       <tr align="left" valign="top">
                                          <td align="left" valign="top" width="20%" id="d100789e4073" headers="d100789e4065 ">
                                             <p>如果备份是<a href="glossary.html#GUID-D47BE9B3-BAE1-4415-B4B4-4D577B6CB493"><span class="xrefglossterm">完整备份</span></a> ，则考虑使用增量备份</p>
                                          </td>
                                          <td align="left" valign="top" width="20%" headers="d100789e4073 d100789e4067 ">
                                             <p>增量级别1备份仅将已更改的块从数据文件写入磁带，因此写入磁带的任何瓶颈对整体备份策略的影响较小。特别是，如果磁带驱动器未本地连接到正在备份的数据库的节点，则增量备份可以更快。 。</p>
                                          </td>
                                          <td align="left" valign="top" width="20%" headers="d100789e4073 d100789e4069 ">
                                             <p><span class="q">“ <a href="backing-up-database.html#GUID-2AF8EE74-CEB2-468D-A3B2-DD6AD8E41304" title="增量备份仅复制自指定的先前备份以来已更改的数据文件块。使用BACKUP命令创建增量备份。">制作和更新RMAN增量备份</a> ”</span></p>
                                          </td>
                                       </tr>
                                       <tr align="left" valign="top">
                                          <td align="left" valign="top" width="20%" id="d100789e4094" headers="d100789e4065 ">
                                             <p>如果备份使用基本压缩算法，请考虑使用Oracle Advanced Compression选项</p>
                                          </td>
                                          <td align="left" valign="top" width="20%" headers="d100789e4094 d100789e4067 ">
                                             <p> </p>
                                          </td>
                                          <td align="left" valign="top" width="20%" headers="d100789e4094 d100789e4069 ">
                                             <ul style="list-style-type:disc">
                                                <li>
                                                   <p><span class="q">“ <a href="configuring-rman-client-advanced.html#GUID-3117DA93-EC34-488D-A4FB-29E6CD4D168A" title="RMAN支持预压缩处理和备份集的二进制压缩。CONFIGURE COMPRESSION ALGORITHM命令可以配置压缩选项。">配置压缩选项</a> ”</span></p>
                                                </li>
                                                <li>
                                                   <p><span class="q">“ <a href="rman-backup-concepts.html#GUID-2AFCD551-95CB-4F9F-946E-550E89613974" title="RMAN支持备份集的二进制压缩。二进制压缩仅在BACKUP命令中指定AS COMPRESSED BACKUPSET时启用，或者一次使用配置设备类型[DISK | SBT] BACKUP TYPE TO COMPRESSED BACKUPSET命令。">关于RMAN备份集的二进制压缩</a> ”</span></p>
                                                </li>
                                             </ul>
                                          </td>
                                       </tr>
                                       <tr align="left" valign="top">
                                          <td align="left" valign="top" width="20%" id="d100789e4131" headers="d100789e4065 ">
                                             <p>如果数据库主机使用多个CPU，并且备份使用二进制压缩，则增加通道数</p>
                                          </td>
                                          <td align="left" valign="top" width="20%" headers="d100789e4131 d100789e4067 ">
                                             <p> </p>
                                          </td>
                                          <td align="left" valign="top" width="20%" headers="d100789e4131 d100789e4069 "> </td>
                                       </tr>
                                       <tr align="left" valign="top">
                                          <td align="left" valign="top" width="20%" id="d100789e4139" headers="d100789e4065 ">
                                             <p>如果备份已加密，则将加密算法更改为<code class="codeph">AES128</code></p>
                                          </td>
                                          <td align="left" valign="top" width="20%" headers="d100789e4139 d100789e4067 ">
                                             <p><code class="codeph">AES128</code>算法是CPU密集度最低的算法。
                                             </p>
                                          </td>
                                          <td align="left" valign="top" width="20%" headers="d100789e4139 d100789e4069 "><span class="q">“ <a href="configuring-rman-client-advanced.html#GUID-97ED7AA5-476C-4068-9C6C-97A0C0353864" title="您可以使用CONFIGURE命令持久配置在编写备份集时用于加密的默认算法。">配置备份加密算法</a> ”</span></td>
                                       </tr>
                                       <tr align="left" valign="top">
                                          <td align="left" valign="top" width="20%" id="d100789e4161" headers="d100789e4065 ">
                                             <p>（仅适用于磁带备份）调整磁带I / O缓冲区的大小</p>
                                          </td>
                                          <td align="left" valign="top" width="20%" headers="d100789e4161 d100789e4067 ">
                                             <p>使用<code class="codeph">ALLOCATE CHANNEL</code>或<code class="codeph">CONFIGURE CHANNEL</code>命令的<code class="codeph">PARMS</code>和<code class="codeph">BLKSIZE</code>参数来设置大小。磁带I / O缓冲区的大小取决于平台。<code class="codeph">BLKSIZE</code>设置会覆盖默认值。
                                             </p>
                                          </td>
                                          <td align="left" valign="top" width="20%" headers="d100789e4161 d100789e4069 "> </td>
                                       </tr>
                                       <tr align="left" valign="top">
                                          <td align="left" valign="top" width="20%" id="d100789e4184" headers="d100789e4065 ">
                                             <p>（仅适用于磁带备份）调整媒体管理软件中的设置</p>
                                          </td>
                                          <td align="left" valign="top" width="20%" headers="d100789e4184 d100789e4067 ">
                                             <p>某些介质管理器设置（包括磁带块大小）可能会影响备份性能。</p>
                                          </td>
                                          <td align="left" valign="top" width="20%" headers="d100789e4184 d100789e4069 "> </td>
                                       </tr>
                                       <tr align="left" valign="top">
                                          <td align="left" valign="top" width="20%" id="d100789e4192" headers="d100789e4065 ">
                                             <p>如果RMAN将文件备份到ASM，则增加通道数</p>
                                          </td>
                                          <td align="left" valign="top" width="20%" headers="d100789e4192 d100789e4067 ">
                                             <p>例如，如果RMAN将数据库备份到具有16个物理磁盘的单个磁盘组，则分配或配置至少4个磁盘通道，最多16个。</p>
                                          </td>
                                          <td align="left" valign="top" width="20%" headers="d100789e4192 d100789e4069 "> </td>
                                       </tr>
                                    </tbody>
                                 </table>
                              </div>
                              <!-- class="inftblhruleinformal" -->
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>