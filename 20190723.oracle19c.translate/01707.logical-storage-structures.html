<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="This chapter describes the nature of and relationships among logical storage structures. These structures are created and recognized by Oracle Database and are not known to the operating system."></meta>
      <meta name="description" content="This chapter describes the nature of and relationships among logical storage structures. These structures are created and recognized by Oracle Database and are not known to the operating system."></meta>
      <title>逻辑存储结构</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Database Concepts"></meta>
      <meta property="og:description" content="This chapter describes the nature of and relationships among logical storage structures. These structures are created and recognized by Oracle Database and are not known to the operating system."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Database Concepts"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="database-concepts.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-09T07:47:16-08:00"></meta>
      <meta name="dcterms.title" content="Database Concepts"></meta>
      <meta name="dcterms.dateCopyrighted" content="1993, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96138-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="physical-storage-structures.html" title="Previous" type="text/html"></link>
      <link rel="next" href="oracle-instance-architecture.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="CNCPT"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="physical-storage-structures.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="oracle-instance-architecture.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">数据库概念</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="oracle-database-storage-structures.html" property="item" typeof="WebPage"><span property="name">Oracle数据库存储结构</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">逻辑存储结构</li>
            </ol>
            <a id="GUID-13CE5EDA-8C66-4CA0-87B5-4069215A368D" name="GUID-13CE5EDA-8C66-4CA0-87B5-4069215A368D"></a>
            
            <h2 id="CNCPT-GUID-13CE5EDA-8C66-4CA0-87B5-4069215A368D" class="sect2"><span class="enumeration_chapter">12个</span>逻辑存储结构</h2>
         </header>
         <div class="ind">
            <div>
               <p>本章介绍逻辑存储结构的本质和关系。这些结构由Oracle数据库创建和识别，操作系统不知道。</p>
               <p>本章包含以下部分：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="logical-storage-structures.html#GUID-52FE1A8C-74EA-4B81-B1AC-69FD34252659" title="Oracle数据库为数据库中的所有数据分配逻辑空间。">逻辑存储结构简介</a></p>
                  </li>
                  <li>
                     <p><a href="logical-storage-structures.html#GUID-1AED5140-E820-436C-BEB7-2A985524911E" title="Oracle数据库在称为数据块的单元（也称为Oracle块或页面）中管理数据库的数据文件中的逻辑存储空间。数据块是数据库I / O的最小单位。">数据块概述</a></p>
                  </li>
                  <li>
                     <p><a href="logical-storage-structures.html#GUID-E3D8E030-A056-40AC-9B7E-8C957E28EE75" title="范围是由逻辑上连续的数据块组成的数据库存储单元。由于RAID条带化和文件系统实现，数据块可以物理地分布在磁盘上。">范围概述</a></p>
                  </li>
                  <li>
                     <p><a href="logical-storage-structures.html#GUID-7DA83E64-9FF1-45A7-A9AC-D4997DDE0866" title="段是一组扩展区，包含表空间中逻辑存储结构的所有数据。">细分概述</a></p>
                  </li>
                  <li>
                     <p><a href="logical-storage-structures.html#GUID-3502CA78-FBC9-4927-B455-0ECB22E53066" title="表空间是段的逻辑存储容器。段是消耗存储空间的数据库对象，例如表和索引。在物理级别，表空间将数据存储在一个或多个数据文件或临时文件中。">表空间概述</a></p>
                  </li>
               </ul>
            </div><a id="CNCPT89000"></a><a id="CNCPT301"></a><div class="props_rev_3"><a id="GUID-52FE1A8C-74EA-4B81-B1AC-69FD34252659" name="GUID-52FE1A8C-74EA-4B81-B1AC-69FD34252659"></a><h3 id="CNCPT-GUID-52FE1A8C-74EA-4B81-B1AC-69FD34252659" class="sect3">逻辑存储结构简介</h3>
               <div>
                  <p>Oracle数据库为数据库中的所有数据分配逻辑空间。</p>
                  <p>数据库空间分配的逻辑单元是数据块，扩展区，段和表空间。在物理级别，数据存储在磁盘上的数据文件中。数据文件中的数据存储在操作系统块中。</p>
                  <p>下图是物理和逻辑存储的实体关系图。乌鸦的足迹代表了一对多的关系。</p>
                  <div class="figure" id="GUID-52FE1A8C-74EA-4B81-B1AC-69FD34252659__BABDADHH">
                     <p class="titleinfigure">图12-1逻辑和物理存储</p><img src="img/cncpt227.gif" alt="下面是图12-1的描述" title="下面是图12-1的描述" longdesc="img_text/cncpt227.html"><br><a href="img_text/cncpt227.html">“图12-1逻辑和物理存储”的说明</a></div>
                  <!-- class="figure" -->
                  <div class="infoboxnotealso" id="GUID-52FE1A8C-74EA-4B81-B1AC-69FD34252659__GUID-B4E4DF18-35BC-4C1C-B0FC-F84909A54460">
                     <p class="notep1">也可以看看：</p>
                     <p><span class="q">“ <a href="physical-storage-structures.html#GUID-FFA872E1-7F63-4DC5-8A35-F21394AB4595" title="Oracle数据库的物理数据库结构可在操作系统级别查看。">物理存储结构</a> ”</span></p>
                  </div>
               </div><a id="CNCPT89001"></a><a id="CNCPT3000"></a><div class="props_rev_3"><a id="GUID-DC561B64-67D9-43CC-A9BA-BE5B92A7B869" name="GUID-DC561B64-67D9-43CC-A9BA-BE5B92A7B869"></a><h4 id="CNCPT-GUID-DC561B64-67D9-43CC-A9BA-BE5B92A7B869" class="sect4">逻辑存储层次结构</h4>
                  <div>
                     <p>段包含一个或多个扩展区，每个扩展区包含多个数据块。</p>
                     <p>下图显示了表空间中数据块，范围和段之间的关系。在此示例中，段具有存储在不同数据文件中的两个扩展区。</p>
                     <div class="figure" id="GUID-DC561B64-67D9-43CC-A9BA-BE5B92A7B869__I10251">
                        <p class="titleinfigure">图12-2表空间中的段，范围和数据块</p><img src="img/cncpt027.gif" alt="下面是图12-2的描述" title="下面是图12-2的描述" longdesc="img_text/cncpt027.html"><br><a href="img_text/cncpt027.html">“图12-2表空间中的段，范围和数据块”的说明</a></div>
                     <!-- class="figure" -->
                     <p>从最低级别的粒度到最高级别，Oracle数据库存储数据</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="glossary.html#GUID-2141C31D-6752-4260-91CE-99B4CC557247"><span class="xrefglossterm">数据块</span></a>是Oracle数据库中最小的数据存储逻辑单元。
                           </p>
                           <p>一个逻辑数据块对应于物理磁盘空间的特定字节数，例如，2KB。数据块是Oracle数据库可以使用或分配的最小存储单元。</p>
                        </li>
                        <li>
                           <p><a href="glossary.html#GUID-C56D833A-B3D3-4B85-AAB4-334F7CF3F5E9"><span class="xrefglossterm">范围</span></a>是分配用于存储特定类型信息的一组逻辑连续数据块</p>
                           <p>在上图中，24 KB范围有12个数据块，而72 KB范围有36个数据块。</p>
                        </li>
                        <li>
                           <p><a href="glossary.html#GUID-EC12AA68-8C89-43B3-B1F9-3AABF7CAEB9F"><span class="xrefglossterm">段</span></a>是为特定数据库对象（例如<a href="glossary.html#GUID-DA8F7E11-B6AF-4ED3-B2A9-B5741E9AE2D4"><span class="xrefglossterm">表）</span></a>分配的一组扩展区。
                           </p>
                           <p>例如， <code class="codeph">employees</code>表的<a href="glossary.html#GUID-2CDB4221-D152-4C89-BB2B-4A7FC6DA340B"><span class="xrefglossterm">数据</span></a>存储在自己的<a href="glossary.html#GUID-2CDB4221-D152-4C89-BB2B-4A7FC6DA340B"><span class="xrefglossterm">数据段中</span></a> ，而<code class="codeph">employees</code>每个<a href="glossary.html#GUID-3CDC5A7E-10A5-4F63-9ED3-49A74D001CA5"><span class="xrefglossterm">索引</span></a>都存储在自己的<a href="glossary.html#GUID-BDF74E0F-51FF-44C5-9A3B-26B8ACBB683C"><span class="xrefglossterm">索引段中</span></a> 。每个消耗存储的数据库对象都包含一个段。
                           </p>
                        </li>
                        <li>
                           <p><a href="glossary.html#GUID-AA66891C-71B2-4D55-8F64-0E427AE24E88"><span class="xrefglossterm">表空间</span></a>是包含一个或多个段的数据库存储单元。
                           </p>
                           <p>每个段属于一个且只有一个表空间。因此，段的所有扩展区都存储在同一个表空间中。在表空间中，段可以包含来自多个数据文件的扩展区，如上图所示。例如，段的一个范围可以存储在<code class="codeph">users01.dbf</code> ，而另一个范围存储在<code class="codeph">users02.dbf</code> 。单个范围永远不能跨越数据文件。
                           </p>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-DC561B64-67D9-43CC-A9BA-BE5B92A7B869__GUID-AAA40D4D-102E-4355-B94A-138DFAFA8202">
                        <p class="notep1">也可以看看：</p>
                        <p><span class="q">“ <a href="physical-storage-structures.html#GUID-008A1F08-9C75-4E9F-A70B-41FB942C60B4" title="在操作系统级别，Oracle数据库将数据库数据存储在称为数据文件的结构中。每个Oracle数据库必须至少有一个数据文件。">数据文件概述</a> ”</span></p>
                     </div>
                  </div>
               </div><a id="CNCPT89002"></a><a id="CNCPT1095"></a><div class="props_rev_3"><a id="GUID-5E81D8A9-2D4C-4991-9D64-B23DD476E22F" name="GUID-5E81D8A9-2D4C-4991-9D64-B23DD476E22F"></a><h4 id="CNCPT-GUID-5E81D8A9-2D4C-4991-9D64-B23DD476E22F" class="sect4">逻辑空间管理</h4>
                  <div>
                     <p>Oracle数据库必须使用逻辑空间管理来跟踪和分配表空间中的扩展区。</p>
                     <p>当数据库对象需要扩展区时，数据库必须具有查找和提供它的方法。类似地，当对象不再需要扩展区时，数据库必须具有使可用扩展区可用的方法。</p>
                     <p>Oracle数据库根据您创建的类型管理表空间中的空间。您可以创建以下类型的表空间之一：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>本地管理的表空间（默认）</p>
                           <p>数据库使用表空间本身的位图来管理范围。因此，本地管理的表空间具有为位图预留的表空间的一部分。在表空间内，数据库可以使用自动段空间管理（ASSM）或手动段空间管理（MSSM）管理段。</p>
                        </li>
                        <li>
                           <p>字典管理的表空间</p>
                           <p>数据库使用<a href="glossary.html#GUID-D6A3934F-BA6D-464F-9612-C683E20514A4"><span class="xrefglossterm">数据字典</span></a>来管理扩展区。
                           </p>
                        </li>
                     </ul>
                     <p><a href="logical-storage-structures.html#GUID-5E81D8A9-2D4C-4991-9D64-B23DD476E22F__BABDJBGD">图12-3</a>显示了表空间中逻辑空间管理的备选方案。
                     </p>
                     <div class="figure" id="GUID-5E81D8A9-2D4C-4991-9D64-B23DD476E22F__BABDJBGD">
                        <p class="titleinfigure">图12-3逻辑空间管理</p><img src="img/cncpt268.gif" alt="下面是图12-3的描述" title="下面是图12-3的描述" longdesc="img_text/cncpt268.html"><br><a href="img_text/cncpt268.html">“图12-3逻辑空间管理”的描述</a></div>
                     <!-- class="figure" -->
                     <div class="infoboxnotealso" id="GUID-5E81D8A9-2D4C-4991-9D64-B23DD476E22F__GUID-2CA1387B-BE22-491E-95D2-FF0AEDD94CB9">
                        <p class="notep1">也可以看看：</p>
                        <p><span class="q">“ <a href="data-dictionary-and-dynamic-performance-views.html#GUID-9B9ABE1C-A1E3-464F-8936-978250DC3E1F" title="Oracle数据库的一个重要部分是它的数据字典，它是一组只读表，提供有关数据库的管理元数据。">数据字典概述</a> ”</span></p>
                     </div>
                  </div><a id="CNCPT1096"></a><div class="props_rev_3"><a id="GUID-190867AF-0714-4B34-9AA4-C23293BDA2F0" name="GUID-190867AF-0714-4B34-9AA4-C23293BDA2F0"></a><h5 id="CNCPT-GUID-190867AF-0714-4B34-9AA4-C23293BDA2F0" class="sect5">本地管理的表空间</h5>
                     <div>
                        <p>本地管理的表空间在数据文件头中维护一个位图，以跟踪数据文件主体中的空闲和已用空间。</p>
                        <p>每个位对应于一组块。分配或释放空间时，Oracle数据库会更改位图值以反映块的新状态。</p>
                        <p>下图是位图管理存储的概念表示。标题中的<code class="codeph">1</code>表示已用空间，而<code class="codeph">0</code>表示空闲空间。
                        </p>
                        <div class="figure" id="GUID-190867AF-0714-4B34-9AA4-C23293BDA2F0__GUID-560F61DE-3165-455D-82D9-8813611CFD92">
                           <p class="titleinfigure">图12-4位图管理存储</p><img src="img/cncpt332.gif" alt="下面是图12-4的描述" title="下面是图12-4的描述" longdesc="img_text/cncpt332.html"><br><a href="img_text/cncpt332.html">“图12-4位图管理存储”的说明</a></div>
                        <!-- class="figure" -->
                        <p>本地管理的表空间具有以下优点：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>避免使用数据字典来管理范围</p>
                              <p>如果消耗或释放范围中的空间导致另一个消耗或释放数据字典表或撤消段中的空间的操作，则在字典管理的表空间中可能发生递归操作。</p>
                           </li>
                           <li>
                              <p>自动跟踪相邻的可用空间</p>
                              <p>通过这种方式，数据库消除了合并空闲扩展区的需要。</p>
                           </li>
                           <li>
                              <p>自动确定本地管理的扩展区的大小</p>
                              <p>或者，所有扩展区在本地管理的表空间中可以具有相同的大小，并覆盖对象存储选项。</p>
                           </li>
                        </ul>
                        <div class="infoboxnote" id="GUID-190867AF-0714-4B34-9AA4-C23293BDA2F0__GUID-12892D78-3F3E-4A71-B737-7F36B06D5083">
                           <p class="notep1">注意：</p>
                           <p>Oracle强烈建议使用具有自动段空间管理的本地管理表空间。</p>
                        </div>
                        <p>段空间管理是从包含段的表空间继承的属性。在本地管理的表空间中，数据库可以自动或手动管理段。例如，可以自动管理表空间<code class="codeph">users</code>中的段，而手动管理表空间<code class="codeph">tools</code>中的段。
                        </p>
                     </div><a id="CNCPT7668"></a><div class="props_rev_3"><a id="GUID-4AF2D61A-8675-4D48-97A4-B20F401ADA16" name="GUID-4AF2D61A-8675-4D48-97A4-B20F401ADA16"></a><h6 id="CNCPT-GUID-4AF2D61A-8675-4D48-97A4-B20F401ADA16" class="sect6">自动段空间管理</h6>
                        <div>
                           <p><span class="bold">自动段空间管理（ASSM）</span>方法使用位图来管理表空间中的空间。
                           </p>
                           <p>位图具有以下优势：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>简化管理</p>
                                 <p>ASSM避免了手动确定许多存储参数的正确设置的需要。只有一个关键的SQL参数控制空间分配： <code class="codeph">PCTFREE</code> 。此参数指定块中要保留的空间百分比以供将来更新（请参阅<span class="q">“ <a href="logical-storage-structures.html#GUID-ECB2069B-A7DC-4D3D-A345-D3216CAEDB6E" title="The PCTFREE SQL parameter sets the minimum percentage of a data block reserved as free space for updates to existing rows. PCTFREE is important for preventing row migration and avoiding wasted space.">数据块中</a></span>可用空间的<span class="q"><a href="logical-storage-structures.html#GUID-ECB2069B-A7DC-4D3D-A345-D3216CAEDB6E" title="PCTFREE SQL参数设置保留为可用空间的数据块的最小百分比，以便更新现有行。PCTFREE对于防止行迁移和避免浪费空间非常重要。">百分比</a> ”</span> ）。
                                 </p>
                              </li>
                              <li>
                                 <p>增加并发性</p>
                                 <p>多个事务可以搜索单独的空闲数据块列表，从而减少争用和等待。对于许多标准工作负载，ASSM的应用程序性能优于使用MSSM的良好调整应用程序的性能。</p>
                              </li>
                              <li>
                                 <p>空间与Oracle Real Application Clusters（Oracle RAC）环境中的实例的动态关联</p>
                              </li>
                           </ul>
                           <p>ASSM效率更高，是永久性本地管理表空间的默认值。</p>
                           <div class="infoboxnote" id="GUID-4AF2D61A-8675-4D48-97A4-B20F401ADA16__GUID-240DF394-3738-4867-84E2-1DCA6B26FF23">
                              <p class="notep1">注意：</p>
                              <p>本章假定在所有关于逻辑存储空间的讨论中使用ASSM。</p>
                           </div>
                        </div>
                     </div><a id="CNCPT89176"></a><a id="CNCPT7669"></a><div class="props_rev_3"><a id="GUID-71C6DECB-E7D0-4511-9BA1-127AAE8851EF" name="GUID-71C6DECB-E7D0-4511-9BA1-127AAE8851EF"></a><h6 id="CNCPT-GUID-71C6DECB-E7D0-4511-9BA1-127AAE8851EF" class="sect6">手动段空间管理</h6>
                        <div>
                           <p>传统的<span class="bold">手动段空间管理（MSSM）</span>方法使用称为<span class="bold">空闲列表</span>的链接<span class="bold">列表</span>来管理段中的可用空间。
                           </p>
                           <p>对于具有可用空间的数据库对象，空闲列表跟踪<a href="glossary.html#GUID-F3F5ACB2-94C8-483F-B427-1981836D0609"><span class="xrefglossterm">高水位线（HWM）</span></a> （HWM）下的块， <a href="glossary.html#GUID-F3F5ACB2-94C8-483F-B427-1981836D0609"><span class="xrefglossterm">HWM</span></a>是正在使用和尚未使用的段空间之间的分界线。在使用块时，数据库会根据需要在空闲列表中放置块或从中删除块。
                           </p>
                           <p>除了<code class="codeph">PCTFREE</code> ，MSSM还要求您使用<code class="codeph">PCTUSED</code>参数（如<code class="codeph">PCTUSED</code> ， <code class="codeph">FREELISTS</code>和<code class="codeph">FREELIST GROUPS</code>来控制空间分配。 <code class="codeph">PCTUSED</code>设置当前使用的块中必须存在的可用空间百分比，以便数据库将其放在空闲列表中。例如，如果在<code class="codeph">CREATE TABLE</code>语句中将<code class="codeph">PCTUSED</code>设置为<code class="codeph">40</code> ，则不能将行插入到段中的块中，直到使用的块空间少于40％。
                           </p>
                           <p>例如，假设您在表中插入一行。数据库检查第一个可用块的表的空闲列表。如果行不适合块，并且块中已用空间大于或等于<code class="codeph">PCTUSED</code> ，则数据库将从列表中删除块并搜索另一个块。如果从块中删除行，则数据库会检查块中的已用空间是否现在小于<code class="codeph">PCTUSED</code> 。如果是，则数据库将块放在空闲列表的开头。
                           </p>
                           <p>一个对象可能有多个空闲列表。这样，在表上执行DML的多个会话可以使用不同的列表，这可以减少争用。每个数据库会话在其会话期间仅使用一个空闲列表。</p>
                           <p><a href="logical-storage-structures.html#GUID-71C6DECB-E7D0-4511-9BA1-127AAE8851EF__BABJABGH">如图12-5</a>所示，您还可以创建一个包含一个或多个<span class="italic">空闲列表组</span>的对象，这些组是空闲列表的集合。每个组都有一个<span class="italic">主空闲列表</span> ，用于管理组中的各个<span class="italic">进程空闲列表</span> 。空闲列表的空间开销，尤其是空闲列表组，可能很重要。
                           </p>
                           <div class="figure" id="GUID-71C6DECB-E7D0-4511-9BA1-127AAE8851EF__BABJABGH">
                              <p class="titleinfigure">图12-5自由列表组</p><img src="img/cncpt320.gif" alt="下面是图12-5的描述" title="下面是图12-5的描述" longdesc="img_text/cncpt320.html"><br><a href="img_text/cncpt320.html">“图12-5自由列表组”的说明</a></div>
                           <!-- class="figure" -->
                           <p>手动管理段空间可能很复杂。您必须调整<code class="codeph">PCTFREE</code>和<code class="codeph">PCTUSED</code>以减少行迁移并避免浪费空间。例如，如果段中的每个使用的块都是半满的，并且如果<code class="codeph">PCTUSED</code>是<code class="codeph">40</code> ，则数据库不允许插入任何这些块。由于难以微调空间分配参数，Oracle强烈建议使用ASSM。在ASSM中， <code class="codeph">PCTFREE</code>确定是否可以将新行插入块中，但它不使用空闲列表并忽略<code class="codeph">PCTUSED</code> 。</p>
                           <div class="infoboxnotealso" id="GUID-71C6DECB-E7D0-4511-9BA1-127AAE8851EF__GUID-1C3A2F09-9D3A-4164-9FEC-032DA100BE6B">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><span class="q">“ <a href="logical-storage-structures.html#GUID-49D4E586-57BF-4310-9EE9-2DD54108E651" title="Oracle数据库使用链接和迁移来管理太大而无法放入单个块的行。">链式和迁移行</a> ”</span></p>
                                 </li>
                                 <li>
                                    <p><a href="../admin/managing-tablespaces.html#ADMIN11360" target="_blank"><span><cite>Oracle数据库管理员指南</cite></span></a> ，了解本地管理的表空间</p>
                                 </li>
                                 <li>
                                    <p><a href="../admin/managing-tablespaces.html#ADMIN10065" target="_blank"><span><cite>Oracle数据库管理员指南</cite></span></a> ，了解有关自动段空间管理的更多信息</p>
                                 </li>
                                 <li>
                                    <p><a href="../sqlrf/physical_attributes_clause.html#SQLRF30011" target="_blank"><span><cite>Oracle数据库SQL语言参考</cite></span></a> ，了解存储参数，如<code class="codeph">PCTFREE</code>和<code class="codeph">PCTUSED</code></p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                     </div>
                  </div><a id="CNCPT1098"></a><div class="props_rev_3"><a id="GUID-E0A29F9D-3987-46BE-AD07-EE27068FDD92" name="GUID-E0A29F9D-3987-46BE-AD07-EE27068FDD92"></a><h5 id="CNCPT-GUID-E0A29F9D-3987-46BE-AD07-EE27068FDD92" class="sect5">字典管理的表空间</h5>
                     <div>
                        <p>字典管理的表空间使用数据字典来管理其范围。</p>
                        <p>只要分配或释放扩展区以供重用，Oracle数据库就会更新数据字典中的表。例如，当表需要扩展区时，数据库将查询数据字典表，并搜索空闲扩展区。如果数据库找到空间，则它会修改一个数据字典表并将一行插入另一个数据字典表中。通过这种方式，数据库通过修改和移动数据来管理空间。</p>
                        <p>数据库在后台执行以获取数据库对象空间的<a href="glossary.html#GUID-31B21CCC-5324-4B86-A58A-2BC7DF57AB33"><span class="xrefglossterm">SQL</span></a>是<a href="glossary.html#GUID-31B21CCC-5324-4B86-A58A-2BC7DF57AB33"><span class="xrefglossterm">递归SQL</span></a> 。频繁使用递归SQL会对性能产生负面影响，因为必须序列化对数据字典的更新。本地管理的表空间（默认情况下）可以避免此性能问题。
                        </p>
                        <div class="infoboxnotealso" id="GUID-E0A29F9D-3987-46BE-AD07-EE27068FDD92__GUID-59F84071-A1CA-4946-ABD8-FF8662278BD3">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="../admin/managing-tablespaces.html#ADMIN11392" target="_blank"><span><cite>Oracle数据库管理员指南</cite></span></a> ，了解如何将表空间从字典管理迁移到本地管理</p>
                        </div>
                     </div>
                  </div>
               </div>
            </div><a id="CNCPT302"></a><div class="props_rev_3"><a id="GUID-1AED5140-E820-436C-BEB7-2A985524911E" name="GUID-1AED5140-E820-436C-BEB7-2A985524911E"></a><h3 id="CNCPT-GUID-1AED5140-E820-436C-BEB7-2A985524911E" class="sect3">数据块概述</h3>
               <div>
                  <p>Oracle数据库在称为<span class="bold">数据块</span> （也称为<span class="italic">Oracle块</span>或<span class="italic">页面）</span>的单元中管理数据库的数据文件中的逻辑存储空间。数据块是数据库I / O的最小单位。</p>
               </div><a id="CNCPT89003"></a><a id="CNCPT250"></a><div class="props_rev_3"><a id="GUID-B4F626CB-9909-47B9-ACF1-A4EA913B5053" name="GUID-B4F626CB-9909-47B9-ACF1-A4EA913B5053"></a><h4 id="CNCPT-GUID-B4F626CB-9909-47B9-ACF1-A4EA913B5053" class="sect4">数据块和操作系统块</h4>
                  <div>
                     <p>在物理层面，数据库数据存储在由操作系统块组成的磁盘文件中。</p>
                     <p><a href="glossary.html#GUID-D3D87FDB-24AD-4B10-A61E-1E6F40FCE562"><span class="xrefglossterm">操作系统块</span></a>是操作系统可以读取或写入的最小数据单元。相反，Oracle块是一种逻辑存储结构，其大小和结构对于操作系统是未知的。
                     </p>
                     <p>下图显示操作系统块的大小可能与数据块不同。数据库以多个数据块而不是操作系统块请求数据。</p>
                     <div class="figure" id="GUID-B4F626CB-9909-47B9-ACF1-A4EA913B5053__BABDCGIB">
                        <p class="titleinfigure">图12-6数据块和操作系统块</p><img src="img/cncpt293.gif" alt="下面是图12-6的描述" title="下面是图12-6的描述" longdesc="img_text/cncpt293.html"><br><a href="img_text/cncpt293.html">“图12-6数据块和操作系统块”的描述</a></div>
                     <!-- class="figure" -->
                     <p>当数据库请求数据块时，操作系统将此操作转换为永久存储中的数据请求。数据块与操作系统块的逻辑分离具有以下含义：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>应用程序不需要确定磁盘上数据的物理地址。</p>
                        </li>
                        <li>
                           <p>数据库数据可以在多个物理磁盘上进行条带化或镜像。</p>
                        </li>
                     </ul>
                  </div><a id="CNCPT7670"></a><div class="props_rev_3"><a id="GUID-39B58094-478C-4DD9-8419-504439F4E8F7" name="GUID-39B58094-478C-4DD9-8419-504439F4E8F7"></a><h5 id="CNCPT-GUID-39B58094-478C-4DD9-8419-504439F4E8F7" class="sect5">数据库块大小</h5>
                     <div>
                        <p>每个数据库都有一个数据库块大小。</p>
                        <p><code class="codeph">DB_BLOCK_SIZE</code>初始化参数在创建数据库时设置数据块的大小。为<code class="codeph">SYSTEM</code>和<code class="codeph">SYSAUX</code>表空间设置大小，并且是所有其他表空间的默认值。除非重新创建数据库，否则无法更改数据库块大小。
                        </p>
                        <p>如果未设置<code class="codeph">DB_BLOCK_SIZE</code> ，则默认数据块大小是特定于操作系统的。数据库的标准数据块大小为4 KB或8 KB。如果数据块和操作系统块的大小不同，则数据块大小必须是操作系统块大小的倍数。
                        </p>
                        <div class="infoboxnotealso" id="GUID-39B58094-478C-4DD9-8419-504439F4E8F7__GUID-060A75CE-194F-40B0-B553-68D46B36B23E">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><a href="../refrn/DB_BLOCK_SIZE.html#REFRN10031" target="_blank"><span><cite>Oracle Database Reference</cite></span></a>了解<code class="codeph">DB_BLOCK_SIZE</code>初始化参数</p>
                              </li>
                              <li>
                                 <p><a href="../admin/creating-and-configuring-an-oracle-database.html#ADMIN11106" target="_blank"><span><cite>“Oracle数据库管理员指南”</cite></span></a>和“ <a href="../tgdba/IO-configuration-and-design.html#TGDBA94404" target="_blank"><span><cite>Oracle数据库性能调整指南”</cite></span></a> ，了解如何选择块大小</p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div><a id="CNCPT7671"></a><div class="props_rev_3"><a id="GUID-C6AFF186-0A2A-40C2-A0AF-7450CBFF9603" name="GUID-C6AFF186-0A2A-40C2-A0AF-7450CBFF9603"></a><h5 id="CNCPT-GUID-C6AFF186-0A2A-40C2-A0AF-7450CBFF9603" class="sect5">表空间块大小</h5>
                     <div>
                        <p>您可以创建块大小与<code class="codeph">DB_BLOCK_SIZE</code>设置不同的单个表空间。
                        </p>
                        <p>将可<a href="glossary.html#GUID-F3AC6538-2722-4916-BD9F-EDAB8318CCCD"><span class="xrefglossterm">传输表空间</span></a>移动到其他平台时，非标准块大小非常有用。
                        </p>
                        <div class="infoboxnotealso" id="GUID-C6AFF186-0A2A-40C2-A0AF-7450CBFF9603__GUID-B362AC6C-9B50-4C6F-8799-D22934AC2E42">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="../admin/creating-and-configuring-an-oracle-database.html#ADMIN11107" target="_blank"><span><cite>Oracle数据库管理员指南</cite></span></a> ，了解如何为表空间指定非标准块大小</p>
                        </div>
                     </div>
                  </div>
               </div><a id="CNCPT89004"></a><a id="CNCPT1046"></a><div class="props_rev_3"><a id="GUID-754ECC03-DD58-4B49-95D1-B98A23B508B2" name="GUID-754ECC03-DD58-4B49-95D1-B98A23B508B2"></a><h4 id="CNCPT-GUID-754ECC03-DD58-4B49-95D1-B98A23B508B2" class="sect4">数据块格式</h4>
                  <div>
                     <p>每个数据块都具有格式或内部结构，使数据库能够跟踪块中的数据和可用空间。无论数据块是否包含表，索引或表簇数据，此格式都类似。</p>
                     <p>下图显示了未压缩数据块的格式。</p>
                     <div class="figure" id="GUID-754ECC03-DD58-4B49-95D1-B98A23B508B2__I4902">
                        <p class="titleinfigure">图12-7数据块格式</p><img src="img/cncpt028.gif" alt="下面是图12-7的描述" title="下面是图12-7的描述" longdesc="img_text/cncpt028.html"><br><a href="img_text/cncpt028.html">“图12-7数据块格式”的说明</a></div>
                     <!-- class="figure" -->
                     <div class="infoboxnotealso" id="GUID-754ECC03-DD58-4B49-95D1-B98A23B508B2__GUID-2DAE5318-A62B-4C45-A8EB-7C876008764A">
                        <p class="notep1">也可以看看：</p>
                        <p><span class="q">“ <a href="logical-storage-structures.html#GUID-B248DC2A-3F65-42CF-ACA5-0B096CFCFC46" title="数据库可以使用表压缩来消除数据块中的重复值。本节介绍使用压缩的数据块的格式。">数据块压缩</a> ”</span>了解压缩块</p>
                     </div>
                  </div><a id="CNCPT1050"></a><div class="props_rev_3"><a id="GUID-D12A9269-54D8-4765-9E92-CEDDC98F1468" name="GUID-D12A9269-54D8-4765-9E92-CEDDC98F1468"></a><h5 id="CNCPT-GUID-D12A9269-54D8-4765-9E92-CEDDC98F1468" class="sect5">数据块开销</h5>
                     <div>
                        <p>Oracle数据库使用<strong class="term">块开销</strong>来管理块本身。块开销不可用于存储用户数据。
                        </p>
                        <p>如<span class="q">“ <a href="logical-storage-structures.html#GUID-754ECC03-DD58-4B49-95D1-B98A23B508B2" title="每个数据块都具有格式或内部结构，使数据库能够跟踪块中的数据和可用空间。无论数据块是否包含表，索引或表簇数据，此格式都类似。">数据块格式</a> ”所示</span> ，块开销包括以下部分：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>块头</p>
                              <p>此部分包含有关块的一般信息，包括磁盘地址和段类型。对于事务管理的<a href="glossary.html#GUID-78394D5D-A1F6-4978-8F13-028185F514B5"><span class="xrefglossterm">块，块头</span></a>包含活动和历史事务信息。
                              </p>
                              <p>每个更新块的<a href="glossary.html#GUID-B7820ED2-E8D7-40B3-AAAE-2B8F935C220C"><span class="xrefglossterm">事务</span></a>都需要一个<a href="glossary.html#GUID-B7820ED2-E8D7-40B3-AAAE-2B8F935C220C"><span class="xrefglossterm">事务条目</span></a> 。Oracle数据库最初在块头中为事务条目保留空间。在分配给支持事务更改的段的数据块中，可用空间还可以在标头空间耗尽时保留事务条目。事务条目所需的空间取决于操作系统。但是，大多数操作系统中的事务条目大约需要23个字节。
                              </p>
                           </li>
                           <li>
                              <p>表目录</p>
                              <p>对于<a href="glossary.html#GUID-861D8FCE-B86C-46B3-AA01-35066D24F4CF"><span class="xrefglossterm">堆组织表</span></a> ，此目录包含有关其行存储在此块中的表的元数据。在表集群中，多个表可以在同一个块中存储行。
                              </p>
                           </li>
                           <li>
                              <p>行目录</p>
                              <p>对于堆组织表，此目录描述块的数据部分中的行的位置。数据库可以在块的底部的任何位置放置一行。行地址记录在行目录向量的一个槽中。</p>
                              <p>rowid指向特定的文件，块和行号。例如，在rowid <code class="codeph">AAAPecAAFAAAABSAAA</code> ，最终的<code class="codeph">AAA</code>表示行号。行号是行目录中条目的索引。行目录条目包含指向数据块上行的位置的指针。如果数据库在块中移动一行，则数据库将更新行目录条目以修改指针。rowid保持不变。
                              </p>
                              <p>在数据库在行目录中分配空间后，数据库在删除行后不会回收此空间。因此，当前为空但以前最多有50行的块继续为行目录分配100个字节。仅当会话在块中插入新行时，数据库才会重用此空间。</p>
                           </li>
                        </ul>
                        <p>块开销的某些部分的大小是固定的，但总大小是可变的。平均而言，块开销总计为84到107个字节。</p>
                     </div>
                  </div><a id="CNCPT89005"></a><a id="CNCPT1051"></a><div class="props_rev_3"><a id="GUID-D993A749-93D0-448C-BDC8-330D805AC481" name="GUID-D993A749-93D0-448C-BDC8-330D805AC481"></a><h5 id="CNCPT-GUID-D993A749-93D0-448C-BDC8-330D805AC481" class="sect5">行格式</h5>
                     <div>
                        <p>块的行数据部分包含实际数据，例如表行或索引键条目。正如每个数据块都具有内部格式一样，每一行都有一种行格式，使数据库能够跟踪行中的数据。</p>
                        <p>Oracle数据库将行存储为可变长度记录。一行包含在一个或多个部分中。每个部分称为<a href="glossary.html#GUID-4C16E45D-79AF-40D5-ACE2-CE2B301CA97B"><span class="xrefglossterm">行块</span></a> 。每个行块都有行标题和列数据。
                        </p>
                        <p>下图显示了行的格式。</p>
                        <div class="figure" id="GUID-D993A749-93D0-448C-BDC8-330D805AC481__THEFORMATOFAROWPIECE-EC1F5807">
                           <p class="titleinfigure">图12-8行块的格式</p><img src="img/cncpt043.gif" alt="下面是图12-8的描述" title="下面是图12-8的描述" longdesc="img_text/cncpt043.html"><br><a href="img_text/cncpt043.html">“图12-8行块格式”的描述</a></div>
                        <!-- class="figure" -->
                     </div><a id="CNCPT89006"></a><div class="props_rev_3"><a id="GUID-D01C1E10-43DE-461D-9B41-A65266EAB70B" name="GUID-D01C1E10-43DE-461D-9B41-A65266EAB70B"></a><h6 id="CNCPT-GUID-D01C1E10-43DE-461D-9B41-A65266EAB70B" class="sect6">行标题</h6>
                        <div>
                           <p>Oracle数据库使用行标题来管理存储在块中的行块。</p>
                           <p>行标题包含以下信息：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>行块中的列</p>
                              </li>
                              <li>
                                 <p>行的片段位于其他数据块中</p>
                                 <p>如果可以将整行插入到单个数据块中，则Oracle数据库会将该行存储为一个行块。但是，如果无法将所有行数据插入到单个块中，或者更新导致现有行超出其块，则数据库将该行存储在多个行块中。数据块通常每行只包含一个行块。</p>
                              </li>
                              <li>
                                 <p>表簇的群集键</p>
                              </li>
                           </ul>
                           <p>完全包含在一个块中的行具有至少3个字节的行标题。</p>
                           <div class="infoboxnotealso" id="GUID-D01C1E10-43DE-461D-9B41-A65266EAB70B__GUID-63FA5FB5-B7CA-42F1-AC89-AE0757F648CC">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><span class="q">“ <a href="logical-storage-structures.html#GUID-49D4E586-57BF-4310-9EE9-2DD54108E651" title="Oracle数据库使用链接和迁移来管理太大而无法放入单个块的行。">链式和迁移行</a> ”</span></p>
                                 </li>
                                 <li>
                                    <p><span class="q">“ <a href="tables-and-table-clusters.html#GUID-04AADD81-E5C2-498B-B857-DF2A37DD3520" title="表簇是一组表，它们共享公共列并在相同的块中存储相关数据。">表集群概述</a> ”</span></p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                     </div><a id="CNCPT89007"></a><div class="props_rev_3"><a id="GUID-4B9E65B3-327F-49C3-AD98-D412A98D2151" name="GUID-4B9E65B3-327F-49C3-AD98-D412A98D2151"></a><h6 id="CNCPT-GUID-4B9E65B3-327F-49C3-AD98-D412A98D2151" class="sect6">列数据</h6>
                        <div>
                           <p>在行标题之后，列数据部分将实际数据存储在行中。行块通常按照<code class="codeph">CREATE TABLE</code>语句中列出的顺序存储列，但不保证此顺序。例如，最后创建<code class="codeph">LONG</code>类型的列。
                           </p>
                           <p>如<span class="q">“ <a href="logical-storage-structures.html#GUID-D993A749-93D0-448C-BDC8-330D805AC481" title="块的行数据部分包含实际数据，例如表行或索引键条目。正如每个数据块都具有内部格式一样，每一行都有一种行格式，使数据库能够跟踪行中的数据。">行格式</a> ”</span>中的图所示，对于行块中的每个列，Oracle数据库分别存储列长度和数据。所需空间取决于数据类型。如果列的数据类型是可变长度，则保存值所需的空间可随着数据更新而增大和缩小。
                           </p>
                           <p>每行在数据块头的行目录中都有一个槽。插槽指向行的开头。</p>
                           <div class="infoboxnotealso" id="GUID-4B9E65B3-327F-49C3-AD98-D412A98D2151__GUID-943E3E3A-5402-4B2C-BC19-4BDFB33A1169">
                              <p class="notep1">也可以看看：</p>
                              <p><span class="q">“ <a href="tables-and-table-clusters.html#GUID-85BE900A-0047-4B7C-A992-F1E35B640CA3" title="Oracle数据库使用表空间中的数据段来保存表数据。">表存储</a> ”</span>和<span class="q">“ <a href="indexes-and-index-organized-tables.html#GUID-832C2B66-912B-4E1C-B4B5-AA40F49E4970" title="Oracle数据库将索引数据存储在索引段中。 。">索引存储</a> ”</span></p>
                           </div>
                        </div>
                     </div><a id="CNCPT89010"></a><a id="CNCPT89009"></a><a id="CNCPT89008"></a><div class="props_rev_3"><a id="GUID-684E6324-A874-4304-8015-5634199BEE81" name="GUID-684E6324-A874-4304-8015-5634199BEE81"></a><h6 id="CNCPT-GUID-684E6324-A874-4304-8015-5634199BEE81" class="sect6">Rowid格式</h6>
                        <div>
                           <p>Oracle数据库使用<span class="bold">rowid</span>唯一标识行。在内部，rowid是一种结构，用于保存数据库访问行所需的信息。rowid不是物理存储在数据库中，而是从存储数据的文件和块中推断出来的。
                           </p>
                           <p>扩展rowid包括数据对象编号。此rowid类型对每行使用物理地址的base 64编码。编码字符是<code class="codeph">AZ</code> ， <code class="codeph">az</code> ， <code class="codeph">0-9</code> ， <code class="codeph">+</code>和<code class="codeph">/</code> 。
                           </p>
                           <div class="example" id="GUID-684E6324-A874-4304-8015-5634199BEE81__BABJJJIB">
                              <p class="titleinexample">例12-1 ROWID伪列</p>
                              <p>以下示例查询<code class="codeph">ROWID</code> <a href="glossary.html#GUID-175D4923-5C7E-4FF0-A69B-C4D8F3D93A3D"><span class="xrefglossterm">伪</span></a>列以在<code class="codeph">employees</code>表的<code class="codeph">employees</code>表中显示该行的扩展rowid：</p><pre class="pre codeblock"><code>SQL&gt; SELECT ROWID FROM employees WHERE employee_id = 100; ROWID ------------------ AAAPecAAFAAAABSAAA</code></pre><p>下图说明了扩展rowid的格式。</p>
                              <div class="figure" id="GUID-684E6324-A874-4304-8015-5634199BEE81__CBBFDAHG">
                                 <p class="titleinfigure">图12-9 ROWID格式</p><img src="img/cncpt249.gif" alt="下面是图12-9的描述" title="下面是图12-9的描述" longdesc="img_text/cncpt249.html"><br><a href="img_text/cncpt249.html">“图12-9 ROWID格式”的描述</a></div>
                              <!-- class="figure" -->
                              <p>扩展rowid以四件式格式显示， <code class="codeph">OOOOOOFFFBBBBBBRRR</code> ，格式分为以下几个部分：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><code class="codeph">OOOOOO</code></p>
                                    <p>数据对象编号标识段（样本查询中的数据对象<code class="codeph">AAAPec</code> ）。将数据对象编号分配给每个数据库段。同一段中的架构对象（例如<a href="glossary.html#GUID-1C56177E-6BEE-4FE7-B45E-38298CDB946D"><span class="xrefglossterm">表簇</span></a> ）具有相同的数据对象编号。
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">FFF</code></p>
                                    <p>表空间相对数据文件编号标识包含行的数据文件（示例查询中的文件<code class="codeph">AAF</code> ）。
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">BBBBBB</code></p>
                                    <p>数据块编号标识包含该行的块（示例查询中的块<code class="codeph">AAAABS</code> ）。块编号与其数据文件相关，而不是其表空间。因此，具有相同块号的两行可以驻留在同一表空间的不同数据文件中。
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">存款准备金率</code></p>
                                    <p>行号标识块中的行（示例查询中的行<code class="codeph">AAA</code> ）。
                                    </p>
                                 </li>
                              </ul>
                              <p>将rowid分配给行块后，rowid可以在特殊情况下更改。例如，如果启用了行移动，则rowid可能会因分区键更新，闪回表操作，缩小表操作等而发生更改。如果禁用行移动，则使用Oracle数据库实用程序导出和导入行时，rowid可能会更改。</p>
                              <div class="infoboxnote" id="GUID-684E6324-A874-4304-8015-5634199BEE81__GUID-9936FEA7-CAED-4962-A233-EE102BD2E5B5">
                                 <p class="notep1">注意：</p>
                                 <p>在内部，数据库执行行移动，就像物理删除并重新插入行一样。但是，行移动被视为更新，这会对触发器产生影响。</p>
                              </div>
                              <div class="infoboxnotealso" id="GUID-684E6324-A874-4304-8015-5634199BEE81__GUID-79F0CAE4-4611-4A71-BD57-CA91F8806B00">
                                 <p class="notep1">也可以看看：</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p><span class="q">“ <a href="tables-and-table-clusters.html#GUID-0258C4C2-2BF2-445F-B1E1-F282A57A6859" title="存储在数据库中的每一行都有一个地址。Oracle数据库使用ROWID数据类型来存储数据库中每一行的地址（rowid）。">Rowid数据类型</a> ”</span></p>
                                    </li>
                                    <li>
                                       <p><a href="../sqlrf/Data-Types.html#SQLRF50998" target="_blank"><span><cite>Oracle数据库SQL语言参考</cite></span></a> ，了解rowid</p>
                                    </li>
                                 </ul>
                              </div>
                           </div>
                           <!-- class="example" -->
                        </div>
                     </div>
                  </div>
               </div><a id="CNCPT89140"></a><a id="CNCPT89143"></a><a id="CNCPT89141"></a><a id="CNCPT89142"></a><a id="CNCPT89139"></a><div class="props_rev_3"><a id="GUID-B248DC2A-3F65-42CF-ACA5-0B096CFCFC46" name="GUID-B248DC2A-3F65-42CF-ACA5-0B096CFCFC46"></a><h4 id="CNCPT-GUID-B248DC2A-3F65-42CF-ACA5-0B096CFCFC46" class="sect4">数据块压缩</h4>
                  <div>
                     <p>数据库可以使用<span class="bold">表压缩</span>来消除数据块中的重复值。本节介绍使用压缩的数据块的格式。
                     </p>
                     <p>使用基本表和高级行压缩的数据块的格式与未压缩块基本相同。不同之处在于块开头的符号表存储行和列的重复值。数据库使用对符号表的简短引用替换这些值的出现次数。</p>
                     <div class="example" id="GUID-B248DC2A-3F65-42CF-ACA5-0B096CFCFC46__GUID-952CDC5E-81B3-4983-BBBF-B7F81C90006D">
                        <p class="titleinexample">例12-2压缩数据块的格式</p>
                        <p>假设以下行存储在七列<code class="codeph">sales</code>表的数据块中：</p><pre class="pre codeblock"><code>2190,13770,25-NOV-00，S，9999,23,161 2225,15720,28-NOV-00，S，9999,25,1450 34005,120760,29-NOV-00，P，9999,44,2376 9425 ，4750,29-NOV-00，I，9999,11,979 1675,46750,29-NOV-00，S，9999,19,1121</code></pre><p>当对此表应用基本表或高级行压缩时，数据库将使用符号引用替换重复值。压缩的以下概念表示显示符号<code class="codeph">*</code>替换<code class="codeph">29-NOV-00</code>和<code class="codeph">%</code>替换<code class="codeph">9999</code> ：</p><pre class="pre codeblock"><code>2190,13770,25-NOV-00，S，％，23,161 2225,15720,28-NOV-00，S，％，25,1450 34005,120760，*，P，％，43,4376 9425,4750，* ，I，％，11,979 1675,46750，*，S，％，19,1121</code></pre><p><a href="logical-storage-structures.html#GUID-B248DC2A-3F65-42CF-ACA5-0B096CFCFC46__BABCFDJG" title="此表表示将符号映射到值的符号表。">表12-1</a>概念性地表示将符号映射到值的符号表。
                        </p>
                        <div class="tblformal" id="GUID-B248DC2A-3F65-42CF-ACA5-0B096CFCFC46__BABCFDJG">
                           <p class="titleintable">表12-1符号表</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="符号表" width="100%" border="1" summary="This table represents the symbol table that maps symbols to values." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" id="d61599e5829">符号</th>
                                    <th align="left" valign="bottom" id="d61599e5832">值</th>
                                    <th align="left" valign="bottom" id="d61599e5835">柱</th>
                                    <th align="left" valign="bottom" id="d61599e5838">行</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" id="d61599e5843" headers="d61599e5829 ">
                                       <p>*</p>
                                    </td>
                                    <td align="left" valign="top" headers="d61599e5843 d61599e5832 ">
                                       <p>29-NOV-00</p>
                                    </td>
                                    <td align="left" valign="top" headers="d61599e5843 d61599e5835 ">
                                       <p>3</p>
                                    </td>
                                    <td align="left" valign="top" headers="d61599e5843 d61599e5838 ">
                                       <p>958-960</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" id="d61599e5856" headers="d61599e5829 ">
                                       <p>％</p>
                                    </td>
                                    <td align="left" valign="top" headers="d61599e5856 d61599e5832 ">
                                       <p>9999</p>
                                    </td>
                                    <td align="left" valign="top" headers="d61599e5856 d61599e5835 ">
                                       <p>五</p>
                                    </td>
                                    <td align="left" valign="top" headers="d61599e5856 d61599e5838 ">
                                       <p>956-960</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                        <div class="infoboxnotealso" id="GUID-B248DC2A-3F65-42CF-ACA5-0B096CFCFC46__GUID-FA5F7C5B-8D2D-45BB-BE9C-75AFCC152518">
                           <p class="notep1">也可以看看：</p>
                           <p><span class="q">“ <a href="tables-and-table-clusters.html#GUID-54EE5325-0894-4869-B3AD-8912D9B4A329" title="数据库可以使用表压缩来减少表所需的存储量。">表压缩</a> ”</span></p>
                        </div>
                     </div>
                     <!-- class="example" -->
                  </div>
               </div><a id="CNCPT1053"></a><div class="props_rev_3"><a id="GUID-2785BB10-1628-4645-AEE9-27EC18E8BB21" name="GUID-2785BB10-1628-4645-AEE9-27EC18E8BB21"></a><h4 id="CNCPT-GUID-2785BB10-1628-4645-AEE9-27EC18E8BB21" class="sect4">数据块中的空间管理</h4>
                  <div>
                     <p>当数据库从下往上填充数据块时，行数据和块头之间的可用空间量减少。</p>
                     <p>数据块中的可用空间也可以在更新期间缩小，如将尾随空值更改为非空值时。数据库管理数据块中的可用空间以优化性能并避免浪费空间。</p>
                     <div class="infoboxnote" id="GUID-2785BB10-1628-4645-AEE9-27EC18E8BB21__GUID-51F1E991-DDA8-491D-BC02-2D6180DC4682">
                        <p class="notep1">注意：</p>
                        <p>本节假定使用自动段空间管理。</p>
                     </div>
                  </div><a id="CNCPT89011"></a><a id="CNCPT1057"></a><div class="props_rev_3"><a id="GUID-ECB2069B-A7DC-4D3D-A345-D3216CAEDB6E" name="GUID-ECB2069B-A7DC-4D3D-A345-D3216CAEDB6E"></a><h5 id="CNCPT-GUID-ECB2069B-A7DC-4D3D-A345-D3216CAEDB6E" class="sect5">数据块中可用空间的百分比</h5>
                     <div>
                        <p><code class="codeph">PCTFREE</code> SQL参数设置保留为可用空间的数据块的最小百分比，以便更新现有行。<code class="codeph">PCTFREE</code>对于防止行迁移和避免浪费空间非常重要。
                        </p>
                        <p>例如，假设您创建的表只需要偶尔更新，其中大部分都不会增加现有数据的大小。您可以在<code class="codeph">CREATE</code> <code class="codeph">TABLE</code>语句中指定<code class="codeph">PCTFREE</code>参数，如下所示：</p><pre class="pre codeblock"><code>CREATE TABLE test_table（n NUMBER）PCTFREE 20;</code></pre><p><a href="logical-storage-structures.html#GUID-ECB2069B-A7DC-4D3D-A345-D3216CAEDB6E__BABHHIDA">图12-10</a>显示了<code class="codeph">PCTFREE</code> <code class="codeph">20</code>设置如何影响空间管理。数据库随着时间的推移向行添加行，导致行数据向上朝向块头增长，块头本身向下向行数据扩展。<code class="codeph">PCTFREE</code>设置确保<span class="italic">至少</span> 20％的数据块是免费的。例如，数据库阻止<code class="codeph">INSERT</code>语句填充块，以便行数据和标题占据总块空间的90％，只剩下10％的空闲。
                        </p>
                        <div class="figure" id="GUID-ECB2069B-A7DC-4D3D-A345-D3216CAEDB6E__BABHHIDA">
                           <p class="titleinfigure">图12-10 PCTFREE</p><img src="img/cncpt029.gif" alt="下面是图12-10的描述" title="下面是图12-10的描述" longdesc="img_text/cncpt029.html"><br><a href="img_text/cncpt029.html">“图12-10 PCTFREE”的描述</a></div>
                        <!-- class="figure" -->
                        <div class="infoboxnote" id="GUID-ECB2069B-A7DC-4D3D-A345-D3216CAEDB6E__GUID-0CEE6A52-FB64-4527-9224-3F4D14E041F9">
                           <p class="notep1">注意：</p>
                           <p>此讨论不适用于不使用<code class="codeph">PCTFREE</code>存储参数或空闲列表的<a href="glossary.html#GUID-A85748CE-C4D4-43ED-BD49-29AFC4AD3A02"><span class="xrefglossterm">LOB</span></a>数据类型。
                           </p>
                        </div>
                        <div class="infoboxnotealso" id="GUID-ECB2069B-A7DC-4D3D-A345-D3216CAEDB6E__GUID-A3171D81-13C6-4976-91AA-4CC21C1468D1">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><span class="q">“ <a href="concepts-for-database-developers.html#GUID-E918382E-0E0A-444C-ABD3-BCC6EFC0AB38" title="大对象（LOB）数据类型使您能够以二进制或字符格式存储和操作大块非结构化数据。">LOB概述</a> ”</span></p>
                              </li>
                              <li>
                                 <p><a href="../sqlrf/physical_attributes_clause.html#SQLRF52292" target="_blank"><span><cite>Oracle数据库SQL语言参考，</cite></span></a>用于<code class="codeph">PCTFREE</code>参数的语法和语义</p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div><a id="CNCPT1054"></a><div class="props_rev_3"><a id="GUID-298A5447-858D-4384-84A8-6DE6804EBEB0" name="GUID-298A5447-858D-4384-84A8-6DE6804EBEB0"></a><h5 id="CNCPT-GUID-298A5447-858D-4384-84A8-6DE6804EBEB0" class="sect5">数据块中自由空间的优化</h5>
                     <div>
                        <p>虽然可用空间的百分比不能<span class="italic">小于</span> <code class="codeph">PCTFREE</code> ，但可用空间量可以<span class="italic">更大</span> 。例如，将<code class="codeph">PCTFREE</code>设置为20％可防止可用空间的总量下降到块的5％，但允许50％的块空闲。
                        </p>
                     </div><a id="CNCPT89222"></a><div class="props_rev_3"><a id="GUID-DB1E5A0D-84A7-4620-8197-6928F2DC0A9B" name="GUID-DB1E5A0D-84A7-4620-8197-6928F2DC0A9B"></a><h6 id="CNCPT-GUID-DB1E5A0D-84A7-4620-8197-6928F2DC0A9B" class="sect6">通过增加自由空间来优化</h6>
                        <div>
                           <p>一些DML语句可以增加数据块中的可用空间。</p>
                           <p>以下语句可以增加空间：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><code class="codeph">DELETE</code>语句</p>
                              </li>
                              <li>
                                 <p><code class="codeph">UPDATE</code>语句，用于将现有值更新为较小值或增加现有值并强制迁移行</p>
                              </li>
                              <li>
                                 <p>在使用高级行压缩的表上的<code class="codeph">INSERT</code>语句</p>
                                 <p>如果<code class="codeph">INSERT</code>语句用数据填充块，则数据库调用块压缩，这可能导致块具有更多可用空间。
                                 </p>
                              </li>
                           </ul>
                           <p>在以下条件下，释放的空间可用于<code class="codeph">INSERT</code>语句：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>如果<code class="codeph">INSERT</code>语句位于同一事务中，并且它位于释放空间的语句之后，则该语句可以使用该空格。
                                 </p>
                              </li>
                              <li>
                                 <p>如果<code class="codeph">INSERT</code>语句与释放空间的语句（可能由另一个用户运行）处于单独的事务中，并且如果需要空间，则该语句可以使用可用空间，但仅在其他事务提交之后。
                                 </p>
                              </li>
                           </ul>
                           <div class="infoboxnotealso" id="GUID-DB1E5A0D-84A7-4620-8197-6928F2DC0A9B__GUID-4A4CEC03-1043-4802-BE68-D568D59E31E6">
                              <p class="notep1">也可以看看：</p>
                              <p><a href="../admin/managing-tables.html#ADMIN13948" target="_blank"><span><cite>Oracle数据库管理员指南</cite></span></a> ，了解高级行压缩</p>
                           </div>
                        </div>
                     </div><a id="CNCPT89013"></a><a id="CNCPT89014"></a><a id="CNCPT89012"></a><div class="props_rev_3"><a id="GUID-D25D436C-02D2-4AA5-B14A-7A7FA2C665C9" name="GUID-D25D436C-02D2-4AA5-B14A-7A7FA2C665C9"></a><h6 id="CNCPT-GUID-D25D436C-02D2-4AA5-B14A-7A7FA2C665C9" class="sect6">通过合并碎片空间进行优化</h6>
                        <div>
                           <p>释放的空间可能与数据块中的可用空间的主要区域邻接也可能不相邻。不连续的自由空间称为<span class="italic">碎片空间</span> 。
                           </p>
                           <p>下图显示了具有不连续可用空间的数据块。</p>
                           <div class="figure" id="GUID-D25D436C-02D2-4AA5-B14A-7A7FA2C665C9__BABJHCCE">
                              <p class="titleinfigure">图12-11带有碎片空间的数据块</p><img src="img/cncpt210.gif" alt="下面是图12-11的描述" title="下面是图12-11的描述" longdesc="img_text/cncpt210.html"><br><a href="img_text/cncpt210.html">“图12-11带有碎片空间的数据块”的描述</a></div>
                           <!-- class="figure" -->
                           <p><span class="italic">仅</span>当满足以下条件时，Oracle数据库<span class="italic">才会</span>自动且透明地合并数据块的可用空间：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><code class="codeph">INSERT</code>或<code class="codeph">UPDATE</code>语句尝试使用包含足够可用空间的块来包含新的行块。
                                 </p>
                              </li>
                              <li>
                                 <p>自由空间是碎片的，因此行块不能插入块的连续部分。</p>
                              </li>
                           </ul>
                           <p>合并后，可用空间量与操作前的量相同，但空间现在是连续的。<a href="logical-storage-structures.html#GUID-D25D436C-02D2-4AA5-B14A-7A7FA2C665C9__BABIIACD">图12-12</a>显示了空间合并后的数据块。
                           </p>
                           <div class="figure" id="GUID-D25D436C-02D2-4AA5-B14A-7A7FA2C665C9__BABIIACD">
                              <p class="titleinfigure">图12-12合并可用空间后的数据块</p><img src="img/cncpt211.gif" alt="下面是图12-12的描述" title="下面是图12-12的描述" longdesc="img_text/cncpt211.html"><br><a href="img_text/cncpt211.html">“图12-12合并自由空间后的数据块”的说明</a></div>
                           <!-- class="figure" -->
                           <p>Oracle数据库仅在前面的情况下执行合并，因为否则由于数据块中的可用空间的连续合并，性能会降低。</p>
                        </div>
                     </div>
                  </div><a id="CNCPT89017"></a><a id="CNCPT89167"></a><a id="CNCPT1055"></a><div class="props_rev_3"><a id="GUID-49D4E586-57BF-4310-9EE9-2DD54108E651" name="GUID-49D4E586-57BF-4310-9EE9-2DD54108E651"></a><h5 id="CNCPT-GUID-49D4E586-57BF-4310-9EE9-2DD54108E651" class="sect5">链式和迁移行</h5>
                     <div>
                        <p>Oracle数据库使用链接和迁移来管理太大而无法放入单个块的行。</p>
                        <p>可能存在以下情况：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>在第一次插入时，该行太大而无法放入一个数据块中。</p>
                              <p><a href="glossary.html#GUID-0F47A5E4-2B7F-4101-AA04-E9641F71AC7F"><span class="xrefglossterm">在行链接中</span></a> ，Oracle数据库将行的数据存储在为该段保留的一个或多个数据块的链中。行链接最常出现在大行中。示例包括包含数据类型为<code class="codeph">LONG</code>或<code class="codeph">LONG RAW</code>的列的行，或包含大量列的行。在这些情况下行链接是不可避免的。
                              </p>
                           </li>
                           <li>
                              <p>最初适合一个数据块的行被更新，以便整个行长度增加，但是存在不足的可用空间来保存更新的行。</p>
                              <p><a href="glossary.html#GUID-CF217247-B358-44B4-9AB6-7FC1557230B7"><span class="xrefglossterm">在行迁移中</span></a> ，Oracle数据库将整个行移动到新数据块，假设该行可以适合新块。已迁移行的原始行块包含指向包含已迁移行的新块的指针或“转发地址”。迁移行的rowid不会更改。
                              </p>
                           </li>
                           <li>
                              <p>一行有超过255列。</p>
                              <p>Oracle数据库只能在一行中存储255列。因此，如果将行插入到具有1000列的表中，则数据库将创建4个行块，通常链接在多个块上。</p>
                           </li>
                        </ul>
                        <p><a href="logical-storage-structures.html#GUID-49D4E586-57BF-4310-9EE9-2DD54108E651__BABFBDIH">图12-13</a>描述了在数据块中插入一个大行。该行对于左侧块而言太大，因此数据库通过将第一个行块放在左侧块中而将第二个行块放置在右侧块中来链接该行。
                        </p>
                        <div class="figure" id="GUID-49D4E586-57BF-4310-9EE9-2DD54108E651__BABFBDIH">
                           <p class="titleinfigure">图12-13行链接</p><img src="img/cncpt316.gif" alt="下面是图12-13的描述" title="下面是图12-13的描述" longdesc="img_text/cncpt316.html"><br><a href="img_text/cncpt316.html">“图12-13行链”的描述</a></div>
                        <!-- class="figure" -->
                        <p><a href="logical-storage-structures.html#GUID-49D4E586-57BF-4310-9EE9-2DD54108E651__BABBGEGE">如图12-14所示</a> ，左侧块包含一个更新的行，因此该行现在对于块来说太大了。数据库将整行移动到右侧块，并在左侧块中留下指向已迁移行的指针。
                        </p>
                        <div class="figure" id="GUID-49D4E586-57BF-4310-9EE9-2DD54108E651__BABBGEGE">
                           <p class="titleinfigure">图12-14行迁移</p><img src="img/cncpt306.gif" alt="下面是图12-14的描述" title="下面是图12-14的描述" longdesc="img_text/cncpt306.html"><br><a href="img_text/cncpt306.html">“图12-14行迁移”的描述</a></div>
                        <!-- class="figure" -->
                        <p>链接或迁移行时，检索数据所需的I / O会增加。出现这种情况的原因是Oracle数据库必须扫描多个块以检索该行的信息。例如，如果数据库执行一个I / O来读取索引，一个I / O读取非迁移表行，则需要额外的I / O来获取迁移行的数据。</p>
                        <p>Segment Advisor可以手动和自动运行，它是一个Oracle数据库组件，用于标识具有可用于回收的空间的段。顾问可以提供有关具有大量可用空间或链接行数太多的对象的建议。</p>
                        <div class="infoboxnotealso" id="GUID-49D4E586-57BF-4310-9EE9-2DD54108E651__GUID-05939B4D-BB1C-459E-B3A6-0F1830B8E19B">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><span class="q">“ <a href="tables-and-table-clusters.html#GUID-37546C88-24EE-47BE-8662-A9CED99BB90F" title="数据库存储数据块中的行。包含少于256列的数据的表的每一行包含在一个或多个行块中。">行存储</a> ”</span>和<span class="q">“ <a href="tables-and-table-clusters.html#GUID-83BDB6CC-8CE1-44FE-9BCB-B018AC316FFC" title="rowid实际上是一行的10字节物理地址。">行块行</a> ”</span></p>
                              </li>
                              <li>
                                 <p><a href="../admin/managing-space-for-schema-objects.html#ADMIN01401" target="_blank"><span><cite>Oracle数据库管理员指南</cite></span></a> ，了解如何回收浪费的空间</p>
                              </li>
                              <li>
                                 <p><a href="../tgdba/instance-tuning-using-performance-views.html#GUID-07836086-3C62-4A4A-8392-25A8C34C4A66" target="_blank"><span><cite>Oracle数据库性能调优指南</cite></span></a> ，了解如何减少链接和迁移的行</p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div>
               </div><a id="CNCPT89223"></a><div class="props_rev_3"><a id="GUID-82531CDF-407E-4D70-AFD0-8E8929B72783" name="GUID-82531CDF-407E-4D70-AFD0-8E8929B72783"></a><h4 id="CNCPT-GUID-82531CDF-407E-4D70-AFD0-8E8929B72783" class="sect4">索引块概述</h4>
                  <div>
                     <p><span class="bold">索引块</span>是一种特殊类型的数据块，它以不同于表块的方式管理空间。Oracle数据库使用索引块来管理索引中的逻辑存储空间。
                     </p>
                  </div><a id="CNCPT89328"></a><div class="props_rev_3"><a id="GUID-84F0C09B-222C-4CA6-85F2-807445844E51" name="GUID-84F0C09B-222C-4CA6-85F2-807445844E51"></a><h5 id="CNCPT-GUID-84F0C09B-222C-4CA6-85F2-807445844E51" class="sect5">索引块的类型</h5>
                     <div>
                        <p>索引包含根块，分支块和叶块。</p>
                        <p>块类型定义如下：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>根块</p>
                              <p>此块标识索引的入口点。</p>
                           </li>
                           <li>
                              <p>分支块</p>
                              <p>搜索索引键时，数据库会浏览分支块。</p>
                           </li>
                           <li>
                              <p>叶块</p>
                              <p>这些块包含指向关联行的索引键值rowid。叶块按排序顺序存储键值，以便数据库可以有效地搜索一系列键值中的所有行。</p>
                           </li>
                        </ul>
                     </div>
                  </div><a id="CNCPT89454"></a><div class="props_rev_3"><a id="GUID-223F3DC7-0103-460E-A8E7-B4A44A39BAD8" name="GUID-223F3DC7-0103-460E-A8E7-B4A44A39BAD8"></a><h5 id="CNCPT-GUID-223F3DC7-0103-460E-A8E7-B4A44A39BAD8" class="sect5">存储索引条目</h5>
                     <div>
                        <p>索引条目以与数据块中的表行相同的方式存储在索引块中。块部分中的索引条目不是以二进制顺序存储，而是存储在堆中。</p>
                        <p>数据库管理索引块中的行目录与数据块中的目录不同。行目录中的条目（不是索引块正文中的条目）按键值排序。例如，在行目录中，索引键<code class="codeph">000000</code>的目录条目位于索引键<code class="codeph">111111</code>的目录条目之前，依此类推。
                        </p>
                        <p>行目录中条目的排序提高了索引扫描的效率。在范围扫描中，数据库必须读取范围中指定的所有索引键。数据库遍历分支块以标识包含第一个密钥的叶块。由于行目录中的条目已排序，因此数据库可以使用二进制搜索来查找范围中的第一个索引键，然后按顺序遍历行目录中的条目，直到找到最后一个键。这样，数据库就可以避免读取叶块体中的所有键。</p>
                        <div class="infoboxnotealso" id="GUID-223F3DC7-0103-460E-A8E7-B4A44A39BAD8__GUID-F226AAF1-C53A-4A11-9387-638A39741162">
                           <p class="notep1">也可以看看：</p>
                           <p><span class="q">“ <a href="logical-storage-structures.html#GUID-D12A9269-54D8-4765-9E92-CEDDC98F1468" title="Oracle数据库使用块开销来管理块本身。块开销不可用于存储用户数据。">数据块开销</a> ”</span></p>
                        </div>
                     </div>
                  </div><a id="CNCPT89224"></a><div class="props_rev_3"><a id="GUID-B32BF8EA-E51B-4F69-BEEF-53902AE04A9D" name="GUID-B32BF8EA-E51B-4F69-BEEF-53902AE04A9D"></a><h5 id="CNCPT-GUID-B32BF8EA-E51B-4F69-BEEF-53902AE04A9D" class="sect5">重复使用索引块中的插槽</h5>
                     <div>
                        <p>数据库可以重用索引块中的空间。</p>
                        <p>例如，应用程序可以将值插入列中，然后删除该值。当行需要空间时，数据库可以重用以前由已删除值占用的索引槽。</p>
                        <p>索引块通常比堆组织的表块具有更多的行。在单个索引块中存储许多行的能力使数据库更容易维护索引，因为它避免了频繁拆分块以存储新数据。</p>
                        <p>索引不能合并，尽管您可以使用带有<code class="codeph">REBUILD</code>或<code class="codeph">COALESCE</code>选项的<code class="codeph">ALTER INDEX</code>语句手动合并它。例如，如果使用值<code class="codeph">1</code>到<code class="codeph">500000</code>填充列，并且然后删除包含偶数的行，则索引将包含250,000个空槽。仅当数据库可以插入适合包含空插槽的索引块的数据时，它才会重用插槽。
                        </p>
                     </div>
                  </div><a id="CNCPT89165"></a><a id="CNCPT89166"></a><a id="CNCPT89225"></a><div class="props_rev_3"><a id="GUID-84CF442F-B8CB-4BFA-9878-743F39EBB48F" name="GUID-84CF442F-B8CB-4BFA-9878-743F39EBB48F"></a><h5 id="CNCPT-GUID-84CF442F-B8CB-4BFA-9878-743F39EBB48F" class="sect5">合并索引块</h5>
                     <div>
                        <p>索引合并将现有索引数据压缩到位，如果重组释放块，则在索引结构中保留空闲块。因此，合并不会释放索引块以用于其他用途或导致索引重新分配块。</p>
                        <p>Oracle数据库不会自动压缩索引：您必须使用<code class="codeph">REBUILD</code>或<code class="codeph">COALESCE</code>选项运行<code class="codeph">ALTER INDEX</code>语句。
                        </p>
                        <p><a href="logical-storage-structures.html#GUID-84CF442F-B8CB-4BFA-9878-743F39EBB48F__BABIBCII">图12-15</a>显示了合并索引之前<code class="codeph">employees.department_id</code>列的索引。前三个叶块仅部分填满，如灰色填充线所示。
                        </p>
                        <div class="figure" id="GUID-84CF442F-B8CB-4BFA-9878-743F39EBB48F__BABIBCII">
                           <p class="titleinfigure">图12-15合并前的索引</p><img src="img/cncpt294.gif" alt="下面是图12-15的描述" title="下面是图12-15的描述" longdesc="img_text/cncpt294.html"><br><a href="img_text/cncpt294.html">“图12-15合并前的索引”的说明</a></div>
                        <!-- class="figure" -->
                        <p><a href="logical-storage-structures.html#GUID-84CF442F-B8CB-4BFA-9878-743F39EBB48F__BABJACFA">图12-16</a>显示了索引合并后<a href="logical-storage-structures.html#GUID-84CF442F-B8CB-4BFA-9878-743F39EBB48F__BABIBCII">图12-15中</a>的索引。前两个叶块现在已满，如灰色填充线所示，并且第三个叶块已被释放。
                        </p>
                        <div class="figure" id="GUID-84CF442F-B8CB-4BFA-9878-743F39EBB48F__BABJACFA">
                           <p class="titleinfigure">图12-16合并后的索引</p><img src="img/cncpt295.gif" alt="下面是图12-16的描述" title="下面是图12-16的描述" longdesc="img_text/cncpt295.html"><br><a href="img_text/cncpt295.html">“图12-16合并后的索引”的说明</a></div>
                        <!-- class="figure" -->
                        <div class="infoboxnotealso" id="GUID-84CF442F-B8CB-4BFA-9878-743F39EBB48F__GUID-BD1104F3-3669-429B-8870-13E10A12A61C">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><a href="../admin/managing-indexes.html#ADMIN11720" target="_blank"><span><cite>Oracle数据库管理员指南</cite></span></a> ，了解如何合并和重建索引</p>
                              </li>
                              <li>
                                 <p><a href="../sqlrf/COALESCE.html#SQLRF00617" target="_blank"><span><cite>Oracle Database SQL语言参考</cite></span></a> ，了解<code class="codeph">COALESCE</code>语句</p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div>
               </div>
            </div><a id="CNCPT303"></a><div class="props_rev_3"><a id="GUID-E3D8E030-A056-40AC-9B7E-8C957E28EE75" name="GUID-E3D8E030-A056-40AC-9B7E-8C957E28EE75"></a><h3 id="CNCPT-GUID-E3D8E030-A056-40AC-9B7E-8C957E28EE75" class="sect3">范围概述</h3>
               <div>
                  <p>范围是由逻辑上连续的数据块组成的数据库存储单元。由于RAID条带化和文件系统实现，数据块可以物理地分布在磁盘上。</p>
               </div><a id="CNCPT89018"></a><a id="CNCPT89019"></a><a id="CNCPT1060"></a><div class="props_rev_3"><a id="GUID-C205981E-182A-466D-B151-090455F9ECE7" name="GUID-C205981E-182A-466D-B151-090455F9ECE7"></a><h4 id="CNCPT-GUID-C205981E-182A-466D-B151-090455F9ECE7" class="sect4">范围的分配</h4>
                  <div>
                     <p>默认情况下，数据库在创建段时为数据段分配初始范围。范围始终包含在一个数据文件中。</p>
                     <p>虽然没有数据添加到段中，但初始范围中的数据块仅为该段保留。每个段的第一个数据块包含段中扩展区的目录。<a href="logical-storage-structures.html#GUID-C205981E-182A-466D-B151-090455F9ECE7__BABFIFCF">图12-17</a>显示了先前不包含任何数据的数据文件中段的初始范围。
                     </p>
                     <div class="figure" id="GUID-C205981E-182A-466D-B151-090455F9ECE7__BABFIFCF">
                        <p class="titleinfigure">图12-17段的初始范围</p><img src="img/cncpt274.gif" alt="下面是图12-17的描述" title="下面是图12-17的描述" longdesc="img_text/cncpt274.html"><br><a href="img_text/cncpt274.html">“图12-17段的初始范围”的描述</a></div>
                     <!-- class="figure" -->
                     <p>如果初始范围变满，并且需要更多空间，则数据库会自动为此段分配增量范围。增量范围是为该段创建的后续范围。</p>
                     <p>分配算法取决于表空间是本地管理还是字典管理。在本地管理的情况下，数据库搜索数据文件的位图以查找相邻的空闲块。如果数据文件没有足够的空间，则数据库将查找另一个数据文件。段的范围始终在同一个表空间中，但可能位于不同的数据文件中。</p>
                     <p><a href="logical-storage-structures.html#GUID-C205981E-182A-466D-B151-090455F9ECE7__BABGHIED">图12-18</a>显示数据库可以为表空间中任何数据文件中的段分配扩展区。例如，该段可以在分配初始程度<code class="codeph">users01.dbf</code> ，在分配第一增量程度<code class="codeph">users02.dbf</code> ，然后在分配下一个程度<code class="codeph">users01.dbf</code> 。
                     </p>
                     <div class="figure" id="GUID-C205981E-182A-466D-B151-090455F9ECE7__BABGHIED">
                        <p class="titleinfigure">图12-18段的增量范围</p><img src="img/cncpt278.gif" alt="下面是图12-18的描述" title="下面是图12-18的描述" longdesc="img_text/cncpt278.html"><br><a href="img_text/cncpt278.html">“图12-18段的增量范围”的描述</a></div>
                     <!-- class="figure" -->
                     <p>新分配范围的块虽然是免费的，但可能不会没有旧数据。在ASSM中，Oracle数据库在开始使用范围时格式化新分配范围的块，但仅在需要时格式化。</p>
                     <div class="infoboxnote" id="GUID-C205981E-182A-466D-B151-090455F9ECE7__GUID-BD8A07EE-0F3A-4312-A155-19E0ECB47541">
                        <p class="notep1">注意：</p>
                        <p>本节适用于串行操作，其中一个<a href="glossary.html#GUID-E660AC1C-B704-4DC1-A35A-DB49EFB34F4A"><span class="xrefglossterm">服务器进程</span></a>解析并运行语句。数据库在并行SQL语句中以不同方式分配扩展区，这需要多个服务器进程。
                        </p>
                     </div>
                     <div class="infoboxnotealso" id="GUID-C205981E-182A-466D-B151-090455F9ECE7__GUID-3F889902-0B05-4902-8642-BA682F08106A">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="q">“ <a href="logical-storage-structures.html#GUID-5050DCC5-DBBD-4B57-AB14-D83A480B9AAE" title="为了管理空间，Oracle数据库跟踪段中的块状态。高水位线（HWM）是段中的一个点，超出该段的数据块未被格式化并且从未使用过。">分段空间和高水位线</a> ”</span></p>
                           </li>
                           <li>
                              <p><a href="../admin/managing-tables.html#ADMIN11660" target="_blank"><span><cite>Oracle数据库管理员指南</cite></span></a> ，了解如何手动分配扩展区</p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="CNCPT1063"></a><div class="props_rev_3"><a id="GUID-0385358A-7F7F-4151-AAC4-F49B3B123852" name="GUID-0385358A-7F7F-4151-AAC4-F49B3B123852"></a><h4 id="CNCPT-GUID-0385358A-7F7F-4151-AAC4-F49B3B123852" class="sect4">释放范围</h4>
                  <div>
                     <p>通常，除非使用<code class="codeph">DROP</code>语句删除对象，否则用户段的范围不会返回到表空间。
                     </p>
                     <p>例如，如果删除表中的所有行，则数据库不会回收数据块以供表空间中的其他对象使用。您也可以使用<code class="codeph">DBMS_SPACE_ADMIN</code>包删除该段。
                     </p>
                     <div class="infoboxnote" id="GUID-0385358A-7F7F-4151-AAC4-F49B3B123852__GUID-BC034FC0-40D1-47A6-9F08-33C849206445">
                        <p class="notep1">注意：</p>
                        <p>在还原段中，如果Oracle数据库具有指定的<code class="codeph">OPTIMAL</code>大小或者数据库处于<a href="glossary.html#GUID-31B8DD86-BD6D-446D-A35D-B5BF3654DF9E"><span class="xrefglossterm">自动撤消管理模式</span></a> ，则Oracle数据库会定期释放一个或多个扩展区。
                        </p>
                     </div>
                     <p>在某些情况下，您可以手动释放空间。Oracle Segment Advisor根据对象中的碎片级别帮助确定对象是否有可用于回收的空间。以下技术可以释放范围：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>使用在线段缩小来回收段中的碎片空间。段缩减是一种在线就地操作。通常，数据压缩可以提高缓存利用率，并且需要在<a href="glossary.html#GUID-BF9B54D6-892E-4C3B-8536-38958ACC069D"><span class="xrefglossterm">全表扫描中</span></a>读取更少的块。
                           </p>
                        </li>
                        <li>
                           <p>将未分区的表或表分区的数据移动到新段中，并可选择移动到您具有配额的其他表空间中。</p>
                        </li>
                        <li>
                           <p>重建或合并索引。</p>
                        </li>
                        <li>
                           <p>截断表或表集群，删除所有行。默认情况下，Oracle数据库会释放已删除行所使用的所有空间，但<code class="codeph">MINEXTENTS</code>存储参数指定的行除外。从<span>Oracle Database 11g</span>第2版（11.2.0.2）开始，您还可以使用<code class="codeph">TRUNCATE</code>和<code class="codeph">DROP ALL STORAGE</code>选项删除整个段。
                           </p>
                        </li>
                        <li>
                           <p>释放未使用的空间，释放数据库段高水位端的未使用空间，并使空间可用于表空间中的其他段。</p>
                        </li>
                     </ul>
                     <p>释放扩展区时，Oracle数据库会修改数据文件中的位图以获取本地管理的表空间，以将重新获得的扩展区反映为可用空间。释放范围块中的任何数据都将变得不可访问。</p>
                     <div class="infoboxnotealso" id="GUID-0385358A-7F7F-4151-AAC4-F49B3B123852__GUID-0D623B4B-15C0-4A34-AFA7-2841291B7D12">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="q">“ <a href="logical-storage-structures.html#GUID-84CF442F-B8CB-4BFA-9878-743F39EBB48F" title="索引合并将现有索引数据压缩到位，如果重组释放块，则在索引结构中保留空闲块。因此，合并不会释放索引块以用于其他用途或导致索引重新分配块。">合并索引块</a> ”</span></p>
                           </li>
                           <li>
                              <p><span class="q">“ <a href="logical-storage-structures.html#GUID-29C6EBF7-64AB-468E-A8CD-6ED36677D604" title="撤消表空间是为系统管理的撤消数据保留的本地管理的表空间。">撤消表空间</a> ”</span></p>
                           </li>
                           <li>
                              <p><span class="q">“ <a href="logical-storage-structures.html#GUID-5050DCC5-DBBD-4B57-AB14-D83A480B9AAE" title="为了管理空间，Oracle数据库跟踪段中的块状态。高水位线（HWM）是段中的一个点，超出该段的数据块未被格式化并且从未使用过。">分段空间和高水位线</a> ”</span></p>
                           </li>
                           <li>
                              <p><a href="../admin/managing-space-for-schema-objects.html#ADMIN01401" target="_blank"><span><cite>Oracle数据库管理员指南</cite></span></a> ，了解如何回收段空间</p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="CNCPT1061"></a><div class="props_rev_3"><a id="GUID-38EC39DC-D9A2-41AD-8AD4-0E1A8A91FFED" name="GUID-38EC39DC-D9A2-41AD-8AD4-0E1A8A91FFED"></a><h4 id="CNCPT-GUID-38EC39DC-D9A2-41AD-8AD4-0E1A8A91FFED" class="sect4">范围的存储参数</h4>
                  <div>
                     <p>每个段由以范围表示的存储参数定义。这些参数控制Oracle数据库如何为段分配可用空间。</p>
                     <p>存储设置按以下优先顺序确定，列表中的设置更高，覆盖列表下方的设置：</p>
                     <ol>
                        <li>
                           <p>段存储子句</p>
                        </li>
                        <li>
                           <p>表空间存储子句</p>
                        </li>
                        <li>
                           <p>Oracle数据库默认</p>
                        </li>
                     </ol>
                     <p>本地管理的表空间可以具有统一的范围大小或由系统自动确定的可变范围大小：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>对于统一扩展区，可以指定扩展区大小或使用默认大小1 MB。表空间中的所有扩展区都具有此大小。本地管理的临时表空间只能使用这种类型的分配。</p>
                        </li>
                        <li>
                           <p>对于自动分配的扩展区，Oracle数据库确定其他扩展区的最佳大小。</p>
                        </li>
                     </ul>
                     <p>对于本地管理的表空间，无法在表空间级别指定某些存储参数。但是，您可以在段级别指定这些参数。在这种情况下，数据库一起使用所有参数来计算段的初始大小。内部算法确定每个范围的后续大小。</p>
                     <div class="infoboxnotealso" id="GUID-38EC39DC-D9A2-41AD-8AD4-0E1A8A91FFED__GUID-8172B6A1-E252-4C62-A0B6-B5DF5819E855">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="../admin/managing-tablespaces.html#ADMIN11361" target="_blank"><span><cite>Oracle数据库管理员指南</cite></span></a> ，了解创建本地管理的表空间时的扩展区管理注意事项</p>
                           </li>
                           <li>
                              <p><a href="../sqlrf/storage_clause.html#SQLRF30013" target="_blank"><span><cite>Oracle Database SQL语言参考</cite></span></a> ，了解storage子句中的选项</p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div>
            </div><a id="CNCPT304"></a><div class="props_rev_3"><a id="GUID-7DA83E64-9FF1-45A7-A9AC-D4997DDE0866" name="GUID-7DA83E64-9FF1-45A7-A9AC-D4997DDE0866"></a><h3 id="CNCPT-GUID-7DA83E64-9FF1-45A7-A9AC-D4997DDE0866" class="sect3">细分概述</h3>
               <div>
                  <p>段是一组扩展区，包含表空间中逻辑存储结构的所有数据。</p>
                  <p>例如，Oracle数据库分配一个或多个扩展区以形成表的数据段。数据库还分配一个或多个扩展区以形成表上索引的索引段。</p>
                  <p>Oracle数据库自动或手动管理段空间。本节假定使用ASSM。</p>
                  <div class="infoboxnotealso" id="GUID-7DA83E64-9FF1-45A7-A9AC-D4997DDE0866__GUID-0491FBDE-5809-496C-B180-4252378079D2">
                     <p class="notep1">也可以看看：</p>
                     <p><span class="q">“ <a href="logical-storage-structures.html#GUID-5E81D8A9-2D4C-4991-9D64-B23DD476E22F" title="Oracle数据库必须使用逻辑空间管理来跟踪和分配表空间中的扩展区。">逻辑空间管理</a> ”</span>以了解有关ASSM的更多信息</p>
                  </div>
               </div><a id="CNCPT1070"></a><div class="props_rev_3"><a id="GUID-EFB292CB-87EA-42AA-808C-BD85E540BACC" name="GUID-EFB292CB-87EA-42AA-808C-BD85E540BACC"></a><h4 id="CNCPT-GUID-EFB292CB-87EA-42AA-808C-BD85E540BACC" class="sect4">用户细分</h4>
                  <div>
                     <p>数据库中的单个数据段存储一个用户对象的数据。</p>
                     <p>有不同类型的细分。用户细分的示例包括：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>表，表分区或表簇</p>
                        </li>
                        <li>
                           <p><a href="glossary.html#GUID-A85748CE-C4D4-43ED-BD49-29AFC4AD3A02"><span class="xrefglossterm">LOB</span></a>或LOB分区</p>
                        </li>
                        <li>
                           <p>索引或索引分区</p>
                        </li>
                     </ul>
                     <p>每个非分区对象和对象分区都存储在自己的段中。例如，如果索引有五个分区，则五个段包含索引数据。</p>
                  </div><a id="CNCPT89020"></a><a id="CNCPT89021"></a><a id="CNCPT998"></a><div class="props_rev_3"><a id="GUID-733C09AF-70D1-4D53-A34A-5521115A596E" name="GUID-733C09AF-70D1-4D53-A34A-5521115A596E"></a><h5 id="CNCPT-GUID-733C09AF-70D1-4D53-A34A-5521115A596E" class="sect5">用户细分创建</h5>
                     <div>
                        <p>默认情况下，数据库使用延迟段创建在创建表，索引和分区时仅更新数据库元数据。</p>
                        <p>当用户将第一行插入表或分区时，数据库会为表或分区，其LOB列及其索引创建段。延迟段创建可避免不必要地使用数据库资源。例如，安装应用程序可能会创建数千个对象，从而占用大量磁盘空间。许多这些对象可能永远不会被使用。</p>
                        <p><code class="codeph">DBMS_SPACE_ADMIN</code>包管理空对象的段。您可以使用此PL / SQL包执行以下操作：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>手动实现没有创建段的空表或分区的段</p>
                           </li>
                           <li>
                              <p>从当前分配了空段的空表或分区中删除段</p>
                           </li>
                        </ul>
                        <p>为了最好地说明对象创建和段创建之间的关系，假设已禁用延迟段创建。您创建一个表如下：</p><pre class="pre codeblock"><code>CREATE TABLE test_table（my_column NUMBER）;</code></pre><p><a href="logical-storage-structures.html#GUID-733C09AF-70D1-4D53-A34A-5521115A596E__BABCHBJC">如图12-19</a>所示，数据库为表创建一个段。
                        </p>
                        <div class="figure" id="GUID-733C09AF-70D1-4D53-A34A-5521115A596E__BABCHBJC">
                           <p class="titleinfigure">图12-19创建用户段</p><img src="img/cncpt246.gif" alt="下面是图12-19的描述" title="下面是图12-19的描述" longdesc="img_text/cncpt246.html"><br><a href="img_text/cncpt246.html">“图12-19创建用户段”的描述</a></div>
                        <!-- class="figure" -->
                        <p>使用<a href="glossary.html#GUID-8640EFA5-276C-4812-A078-1F21F55F4200"><span class="xrefglossterm">主键</span></a>或唯一键创建表时，Oracle数据库会自动为此键创建索引。再次假设已禁用延迟段创建。您创建一个表如下：</p><pre class="pre codeblock"><code>CREATE TABLE lob_table（my_column NUMBER PRIMARY KEY，clob_column CLOB）;</code></pre><p><a href="logical-storage-structures.html#GUID-733C09AF-70D1-4D53-A34A-5521115A596E__BABJJADA">图12-20</a>显示<code class="codeph">lob_table</code>的数据存储在一个段中，而隐式创建的索引位于不同的段中。此外，CLOB数据存储在其自己的段中，其关联的CLOB索引也是如此。因此， <code class="codeph">CREATE TABLE</code>语句导致创建<span class="italic">四个</span>不同的段。
                        </p>
                        <div class="figure" id="GUID-733C09AF-70D1-4D53-A34A-5521115A596E__BABJJADA">
                           <p class="titleinfigure">图12-20多段</p><img src="img/cncpt245.gif" alt="下面是图12-20的描述" title="下面是图12-20的描述" longdesc="img_text/cncpt245.html"><br><a href="img_text/cncpt245.html">“图12-20多段”的说明</a></div>
                        <!-- class="figure" -->
                        <div class="infoboxnote" id="GUID-733C09AF-70D1-4D53-A34A-5521115A596E__GUID-9DA417BE-F333-4082-A166-2EAE5B4EBDDA">
                           <p class="notep1">注意：</p>
                           <p>表的段和该表的索引不必占用相同的表空间。</p>
                        </div>
                        <p>创建段时，数据库会分配一个或多个扩展区。对象的存储参数确定如何分配每个段的范围。这些参数会影响与对象关联的数据段的数据检索和存储效率。</p>
                        <div class="infoboxnotealso" id="GUID-733C09AF-70D1-4D53-A34A-5521115A596E__GUID-87989EE9-24FD-4BB2-9919-FEEC758DC07E">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p> <span class="q">“ <a href="concepts-for-database-developers.html#GUID-3C50EAB8-FC39-4BB3-B680-4EACCE49E866" title="内部LOB将数据存储在数据库本身而不是外部文件中。">内部LOB</a> ”</span></p>
                              </li>
                              <li>
                                 <p> <span class="q">“ <a href="logical-storage-structures.html#GUID-38EC39DC-D9A2-41AD-8AD4-0E1A8A91FFED" title="每个段由以范围表示的存储参数定义。这些参数控制Oracle数据库如何为段分配可用空间。">范围的存储参数</a> ”</span></p>
                              </li>
                              <li>
                                 <p><a href="../admin/managing-tables.html#ADMIN13319" target="_blank"><span><cite>Oracle数据库管理员指南</cite></span></a> ，了解如何管理延迟段创建</p>
                              </li>
                              <li>
                                 <p>用于<code class="codeph">CREATE TABLE</code>语法的<a href="../sqlrf/CREATE-TABLE.html#SQLRF01402" target="_blank"><span><cite>Oracle数据库SQL语言参考</cite></span></a></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div>
               </div><a id="CNCPT1072"></a><div class="props_rev_3"><a id="GUID-BFC69020-DECA-4F2D-8BED-57A612A4E7C8" name="GUID-BFC69020-DECA-4F2D-8BED-57A612A4E7C8"></a><h4 id="CNCPT-GUID-BFC69020-DECA-4F2D-8BED-57A612A4E7C8" class="sect4">临时段</h4>
                  <div>
                     <p>处理查询时，Oracle数据库通常需要临时工作空间来执行SQL语句的中间阶段。</p>
                     <p>可能需要<a href="glossary.html#GUID-12B9FBED-5452-4D45-A43A-B33AB6DE9390"><span class="xrefglossterm">临时段的</span></a>典型操作包括排序， <a href="glossary.html#GUID-90B8C458-65EB-4868-9CC5-175955A7AD91"><span class="xrefglossterm">散列</span></a>和合并位图。在创建索引时，Oracle数据库还会将索引段放入临时段，然后在索引完成时将它们转换为永久段。
                     </p>
                     <p>如果可以在内存中执行操作，Oracle数据库不会创建临时段。但是，如果无法使用内存，则数据库会自动在磁盘上分配临时段。</p>
                  </div><a id="CNCPT1076"></a><div class="props_rev_3"><a id="GUID-2F77DB80-8AAD-468A-AA34-D1230009AEAC" name="GUID-2F77DB80-8AAD-468A-AA34-D1230009AEAC"></a><h5 id="CNCPT-GUID-2F77DB80-8AAD-468A-AA34-D1230009AEAC" class="sect5">分配查询的临时段</h5>
                     <div>
                        <p>Oracle数据库在用户会话期间根据需要为查询分配临时段，并在查询完成时删除它们。除临时段上的空间管理操作外，临时段的更改不会记录在联机重做日志中。</p>
                        <p>数据库在分配给用户的临时表空间中创建临时段。表空间的默认存储特征确定临时段中扩展区的特征。由于临时段的分配和释放经常发生，因此最佳做法是为临时段创建至少一个特殊表空间。数据库跨磁盘分发I / O，并避免使用临时段对<code class="codeph">SYSTEM</code>和其他表空间进行分段。
                        </p>
                        <div class="infoboxnote" id="GUID-2F77DB80-8AAD-468A-AA34-D1230009AEAC__GUID-12611FC6-2178-4EA0-8118-0C4B036783EE">
                           <p class="notep1">注意：</p>
                           <p>在本地管理<code class="codeph">SYSTEM</code> ，必须在创建数据库时定义默认临时表空间。本地管理的<code class="codeph">SYSTEM</code>表空间不能用于默认临时存储。
                           </p>
                        </div>
                        <div class="infoboxnotealso" id="GUID-2F77DB80-8AAD-468A-AA34-D1230009AEAC__GUID-D6307853-A80F-464F-A572-E8B6C41F96B8">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li><span class="q">“ <a href="physical-storage-structures.html#GUID-47557C86-E551-46B5-B28E-28D6C500694E" title="最重要的恢复结构是联机重做日志，它由两个或多个预分配文件组成，这些文件在数据库发生变化时存储更改。联机重做日志记录对数据文件的更改。">在线重做日志概述</a> ”</span></li>
                              <li>
                                 <p><a href="../admin/managing-tablespaces.html#ADMIN11366" target="_blank"><span class="italic">Oracle数据库管理员指南</span></a> ，了解如何创建临时表空间</p>
                              </li>
                              <li>
                                 <p>用于<code class="codeph">CREATE TEMPORARY TABLESPACE</code>语法和语义的<a href="../sqlrf/CREATE-TABLESPACE.html#SQLRF01403" target="_blank"><span class="italic">Oracle数据库SQL语言参考</span></a></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div><a id="CNCPT1077"></a><div class="props_rev_3"><a id="GUID-98855434-8F27-4809-990C-5F8DC25AD5A9" name="GUID-98855434-8F27-4809-990C-5F8DC25AD5A9"></a><h5 id="CNCPT-GUID-98855434-8F27-4809-990C-5F8DC25AD5A9" class="sect5">临时表和索引的段的分配</h5>
                     <div>
                        <p>Oracle数据库可以为临时表及其索引分配临时段。</p>
                        <p>临时表包含仅在事务或会话期间存在的数据。每个会话仅访问为自己分配的扩展区，并且不能访问为其他会话分配的扩展区。</p>
                        <p>当第一次<code class="codeph">INSERT</code>进入表时，Oracle数据库为全局临时表分配段，并且仅在需要时为私有临时表分配段。插入可以显式发生，也可以因为<code class="codeph">CREATE TABLE AS SELECT</code> 。数据库为表及其索引分配段，创建索引的根页，并分配任何<code class="codeph">LOB</code>段。
                        </p>
                        <p>当前用户的临时表空间为临时表分配段。例如，分配给<code class="codeph">user1</code>的临时表空间是<code class="codeph">temp1</code> ，分配给<code class="codeph">user2</code>的临时表空间是<code class="codeph">temp2</code> 。在这种情况下， <code class="codeph">user1</code>将临时数据存储在<code class="codeph">temp1</code>段中，而<code class="codeph">user2</code>将临时数据存储在<code class="codeph">temp2</code>段中。
                        </p>
                        <div class="infoboxnotealso" id="GUID-98855434-8F27-4809-990C-5F8DC25AD5A9__GUID-FA084362-E202-4875-8762-F4E630B246F9">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><span class="q">“ <a href="tables-and-table-clusters.html#GUID-23B23DCF-7482-4585-9C63-AC073C5DE224" title="临时表包含仅在事务或会话期间存在的数据。">临时表概述</a> ”</span></p>
                              </li>
                              <li>
                                 <p><a href="../admin/managing-tables.html#ADMIN-GUID-A48CB362-FC15-4A26-8386-906A55F6788E" target="_blank"><span><cite>Oracle数据库管理员指南</cite></span></a> ，了解如何创建临时表</p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div>
               </div><a id="CNCPT305"></a><div class="props_rev_3"><a id="GUID-6E206D3A-E0E7-4B23-9C41-516FB35BC3FE" name="GUID-6E206D3A-E0E7-4B23-9C41-516FB35BC3FE"></a><h4 id="CNCPT-GUID-6E206D3A-E0E7-4B23-9C41-516FB35BC3FE" class="sect4">撤消细分</h4>
                  <div>
                     <p>Oracle数据库维护事务操作的记录，统称为<strong class="term">撤消数据</strong> 。
                     </p>
                     <p>Oracle数据库使用撤消数据执行以下操作：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>回滚<a href="glossary.html#GUID-6A310BE1-83AB-4C87-ABE1-09CD847A31FB"><span class="xrefglossterm">活动事务</span></a></p>
                        </li>
                        <li>
                           <p>恢复已终止的交易</p>
                        </li>
                        <li>
                           <p>提供<a href="glossary.html#GUID-A2D92FBD-9C36-432E-A44F-0462DB2E5527"><span class="xrefglossterm">读取一致性</span></a></p>
                        </li>
                        <li>
                           <p>执行一些逻辑闪回操作</p>
                        </li>
                     </ul>
                     <p>Oracle数据库将撤消数据存储在数据库中而不是外部日志中。撤消数据存储在与数据块一样更新的块中，这些块的更改会生成重做记录。通过这种方式，Oracle数据库可以高效地访问撤消数据，而无需读取外部日志。</p>
                     <p>永久对象的撤消数据存储在<a href="glossary.html#GUID-78A7FBF2-2EB5-4BD6-AECC-D61A5AEF1158"><span class="xrefglossterm">撤消表空间中</span></a> 。Oracle数据库提供了一种全自动机制，称为<a href="glossary.html#GUID-31B8DD86-BD6D-446D-A35D-B5BF3654DF9E"><span class="xrefglossterm">自动撤消管理模式</span></a> ，用于管理撤消表空间中的还原段和空间。
                     </p>
                     <p>数据库将撤消数据分成两个流。临时undo流只封装对临时对象更改生成的undo记录，而永久undo流只封装永久对象的undo记录。数据库独立管理临时和永久撤消。通过执行以下操作，撤消分离可减少存储并提高性能：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>使您能够配置最适合永久和临时表的工作负载的永久和撤消表空间大小</p>
                        </li>
                        <li>
                           <p>减少写入在线重做日志的重做大小</p>
                        </li>
                        <li>
                           <p>避免备份临时撤消数据的需要</p>
                        </li>
                     </ul>
                     <p>在Active Data Guard实例上，全局临时表上的DML要求在临时还原段中生成撤消。</p>
                     <div class="infoboxnotealso" id="GUID-6E206D3A-E0E7-4B23-9C41-516FB35BC3FE__GUID-40B9DB5A-EC89-46B0-BA79-DDF150485A7C">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="q">“ <a href="physical-storage-structures.html#GUID-B7EB99F2-0D79-4E22-BBB6-75191035DE8D" title="数据库维护联机重做日志文件以防止数据丢失。具体而言，在实例发生故障后，联机重做日志文件使Oracle数据库能够恢复尚未写入数据文件的已提交数据。">使用在线重做日志</a> ”</span></p>
                           </li>
                           <li>
                              <p><span class="q">“ <a href="logical-storage-structures.html#GUID-311EBE7D-F01F-4E52-9B8B-DBF84116207D" title="临时undo段是一个可选的空间管理容器，仅用于临时undo数据。">临时撤消段</a> ”</span></p>
                           </li>
                           <li>
                              <p><a href="../admin/managing-undo.html#ADMIN13740" target="_blank"><span><cite>Oracle数据库管理员指南</cite></span></a> ，了解临时还原段</p>
                           </li>
                           <li>
                              <p><a href="../refrn/TEMP_UNDO_ENABLED.html#REFRN10326" target="_blank"><span><cite>Oracle Database Reference</cite></span></a>了解<code class="codeph">TEMP_UNDO_ENABLED</code>初始化参数</p>
                           </li>
                        </ul>
                     </div>
                  </div><a id="CNCPT89185"></a><a id="CNCPT89186"></a><a id="CNCPT89187"></a><a id="CNCPT89184"></a><div class="props_rev_3"><a id="GUID-BB42D7D8-2C93-4F5B-B0C1-6361AEEF4B37" name="GUID-BB42D7D8-2C93-4F5B-B0C1-6361AEEF4B37"></a><h5 id="CNCPT-GUID-BB42D7D8-2C93-4F5B-B0C1-6361AEEF4B37" class="sect5">撤消细分和交易</h5>
                     <div>
                        <p>当事务开始时，数据库将事务绑定（分配）到撤消段，并因此绑定到当前撤消表空间中的<span class="bold">事务表</span> 。在极少数情况下，如果数据库实例没有指定的撤消表空间，则事务将绑定到系统还原段。
                        </p>
                        <p>多个活动事务可以同时写入同一个还原段或不同的段。例如，事务T1和T2都可以写入撤消段U1，或者T1可以写入U1，而T2写入撤消段U2。</p>
                        <p>从概念上讲，撤销段中的范围形成一个环。事务写入一个撤消范围，然后写入环中的下一个范围，依此类推。<a href="logical-storage-structures.html#GUID-BB42D7D8-2C93-4F5B-B0C1-6361AEEF4B37__BABGAFCA">图12-21</a>显示了两个事务T1和T2，它们开始在撤销段的第三个范围（E3）中写入并继续写入第四个范围（E4）。
                        </p>
                        <div class="figure" id="GUID-BB42D7D8-2C93-4F5B-B0C1-6361AEEF4B37__BABGAFCA">
                           <p class="titleinfigure">图12-21撤消段中分配的范围环</p><img src="img/cncpt328.gif" alt="下面是图12-21的描述" title="下面是图12-21的描述" longdesc="img_text/cncpt328.html"><br><a href="img_text/cncpt328.html">“图12-21撤消段中分配的范围环”的说明</a></div>
                        <!-- class="figure" -->
                        <p>在任何给定时间，事务按顺序写入撤消段中的一个范围，称为事务的<span class="italic">当前范围</span> 。多个活动事务可以同时写入相同的当前范围或不同的当前范围。<a href="logical-storage-structures.html#GUID-BB42D7D8-2C93-4F5B-B0C1-6361AEEF4B37__BABGAFCA">图12-21</a>显示了事务T1和T2同时写入范围E3。在撤消范围内，数据块仅包含一个事务的数据。
                        </p>
                        <p>当前撤消范围填充时，需要空间的第一个事务检查环中下一个已分配范围的可用性。如果下一个程度<span class="italic">不会</span>从活动事务包含数据，那么这个程度成为当前的程度。现在，所有需要空间的事务都可以写入新的当前范围。在<a href="logical-storage-structures.html#GUID-BB42D7D8-2C93-4F5B-B0C1-6361AEEF4B37__BABEHGDD">图12-22中</a> ，当E4已满时，T1和T2继续写入E1，覆盖E1中的非活动撤销数据。
                        </p>
                        <div class="figure" id="GUID-BB42D7D8-2C93-4F5B-B0C1-6361AEEF4B37__BABEHGDD">
                           <p class="titleinfigure">图12-22撤消段中循环使用分配的区段</p><img src="img/cncpt327.gif" alt="下面是图12-22的描述" title="下面是图12-22的描述" longdesc="img_text/cncpt327.html"><br><a href="img_text/cncpt327.html">“图12-22在撤消段中循环使用分配的区段”的说明</a></div>
                        <!-- class="figure" -->
                        <p>如果下一个范围<span class="italic">确实</span>包含来自活动事务的数据，则数据库必须分配新范围。<a href="logical-storage-structures.html#GUID-BB42D7D8-2C93-4F5B-B0C1-6361AEEF4B37__BABFECCE">图12-23</a>显示了T1和T2写入E4的场景。当E4填满时，事务无法继续写入E1，因为E1包含活动的撤销条目。因此，数据库为此撤消段分配新范围（E5）。交易继续写入E5。
                        </p>
                        <div class="figure" id="GUID-BB42D7D8-2C93-4F5B-B0C1-6361AEEF4B37__BABFECCE">
                           <p class="titleinfigure">图12-23撤消段的新范围的分配</p><img src="img/cncpt326.gif" alt="下面是图12-23的描述" title="下面是图12-23的描述" longdesc="img_text/cncpt326.html"><br><a href="img_text/cncpt326.html">“图12-23撤消段的新范围的分配”的描述</a></div>
                        <!-- class="figure" -->
                        <div class="infoboxnotealso" id="GUID-BB42D7D8-2C93-4F5B-B0C1-6361AEEF4B37__GUID-38913373-F1D6-44D8-96DB-0EA5E9C0E0A7">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="../admin/managing-undo.html#ADMIN013" target="_blank"><span><cite>Oracle数据库管理员指南</cite></span></a> ，了解如何管理还原段</p>
                        </div>
                     </div>
                  </div><a id="CNCPT89188"></a><div class="props_rev_3"><a id="GUID-E99834E8-596C-49BE-99CD-B5FC39C70333" name="GUID-E99834E8-596C-49BE-99CD-B5FC39C70333"></a><h5 id="CNCPT-GUID-E99834E8-596C-49BE-99CD-B5FC39C70333" class="sect5">交易回滚</h5>
                     <div>
                        <p>发出<code class="codeph">ROLLBACK</code>语句时，数据库使用撤消记录来回滚未提交的事务对数据库所做的更改。
                        </p>
                        <p>在恢复期间，数据库会回滚从联机重做日志应用到数据文件的任何未提交的更改。撤消记录通过维护数据的前映像来提供<a href="glossary.html#GUID-A2D92FBD-9C36-432E-A44F-0462DB2E5527"><span class="xrefglossterm">读取一致性</span></a> ，以便用户在另一个用户更改数据的同时访问数据。
                        </p>
                     </div>
                  </div><a id="CNCPT89227"></a><div class="props_rev_3"><a id="GUID-311EBE7D-F01F-4E52-9B8B-DBF84116207D" name="GUID-311EBE7D-F01F-4E52-9B8B-DBF84116207D"></a><h5 id="CNCPT-GUID-311EBE7D-F01F-4E52-9B8B-DBF84116207D" class="sect5">临时撤消段</h5>
                     <div>
                        <p><strong class="term">临时undo段</strong>是一个可选的空间管理容器，仅用于临时undo数据。
                        </p>
                        <p>撤消对临时表的更改的记录都是特定于会话的，仅对读取一致性和事务回滚有用。在<span>Oracle Database 12c</span>之前，数据库始终将这些记录存储在联机重做日志中。由于在联机重做日志中未记录对临时对象的更改，因此将临时对象的撤消写入临时还原段可节省联机重做日志和归档重做日志文件中的空间。数据库不记录对撤消的更改或对临时表的更改，这样可以提高性能。
                        </p>
                        <p>您可以设置<code class="codeph">TEMP_UNDO_ENABLED</code>初始化参数，以便临时表将撤消数据存储在临时还原段中。当此参数为<code class="codeph">TRUE</code> ，数据库将从临时表空间分配临时还原段。
                        </p>
                        <div class="infoboxnotealso" id="GUID-311EBE7D-F01F-4E52-9B8B-DBF84116207D__GUID-316D0F49-8593-4E9A-BE11-4923EB2849E4">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><a href="../admin/managing-undo.html#ADMIN13740" target="_blank"><span><cite>Oracle数据库管理员指南</cite></span></a> ，了解临时还原段</p>
                              </li>
                              <li>
                                 <p><a href="../refrn/TEMP_UNDO_ENABLED.html#REFRN10326" target="_blank"><span><cite>Oracle Database Reference</cite></span></a>了解<code class="codeph">TEMP_UNDO_ENABLED</code>初始化参数</p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div>
               </div><a id="CNCPT89023"></a><a id="CNCPT89024"></a><a id="CNCPT89194"></a><a id="CNCPT89025"></a><a id="CNCPT89022"></a><div class="props_rev_3"><a id="GUID-5050DCC5-DBBD-4B57-AB14-D83A480B9AAE" name="GUID-5050DCC5-DBBD-4B57-AB14-D83A480B9AAE"></a><h4 id="CNCPT-GUID-5050DCC5-DBBD-4B57-AB14-D83A480B9AAE" class="sect4">分段空间和高水位线</h4>
                  <div>
                     <p>为了管理空间，Oracle数据库跟踪段中的块状态。<span class="bold">高水位线（HWM）</span>是段中的一个点，超出该段的数据块未被格式化并且从未使用过。
                     </p>
                     <p>MSSM使用空闲列表来管理段空间。在创建表时，不会格式化段中的块。当会话首先将行插入表中时，数据库会在空闲列表中搜索可用的块。如果数据库找不到可用块，则它预先格式化一组块，将它们放在空闲列表中，然后开始将数据插入块中。在MSSM中，全表扫描会读取HWM下的<span class="italic">所有</span>块。</p>
                     <p>ASSM不使用免费列表，因此必须以不同方式管理空间。当会话首先将数据插入表中时，数据库将格式化单个位图块，而不是像在MSSM中那样预格式化一组块。位图跟踪段中块的状态，取代空闲列表。数据库使用位图查找空闲块，然后在填充数据之前格式化每个块。ASSM在块之间展开插入以避免并发问题。</p>
                     <p>ASSM段中的每个数据块都处于以下状态之一：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>在HWM之上</p>
                           <p>这些块未格式化，从未使用过。</p>
                        </li>
                        <li>
                           <p>在HWM下面</p>
                           <p>这些块处于以下状态之一：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>分配，但目前未格式化和未使用</p>
                              </li>
                              <li>
                                 <p>格式化并包含数据</p>
                              </li>
                              <li>
                                 <p>格式化并为空，因为数据已删除</p>
                              </li>
                           </ul>
                        </li>
                     </ul>
                     <p><a href="logical-storage-structures.html#GUID-5050DCC5-DBBD-4B57-AB14-D83A480B9AAE__BABJIIAI">图12-24</a>描绘了作为水平系列块的ASSM段。在创建表时，HWM位于左侧段的开头。由于尚未插入任何数据，因此段中的所有块都未格式化且从未使用过。
                     </p>
                     <div class="figure" id="GUID-5050DCC5-DBBD-4B57-AB14-D83A480B9AAE__BABJIIAI">
                        <p class="titleinfigure">图12-24表创建时的HWM</p><img src="img/cncpt275.gif" alt="下面是图12-24的描述" title="下面是图12-24的描述" longdesc="img_text/cncpt275.html"><br><a href="img_text/cncpt275.html">“图12-24表创建时的HWM”的描述</a></div>
                     <!-- class="figure" -->
                     <p>假设事务将行插入到段中。数据库必须分配一组块来保存行。分配的块低于HWM。数据库格式化此组中的位图块以保存元数据，但不预先格式化组中的其余块。</p>
                     <p>在<a href="logical-storage-structures.html#GUID-5050DCC5-DBBD-4B57-AB14-D83A480B9AAE__BABJGIBJ">图12-25中</a> ，分配了HWM下方的块，而HWM上方的块既未分配也未格式化。当插入发生时，数据库可以写入具有可用空间的任何块。低高水位线（低HWM）标志着已知所有块都被格式化的点，因为它们包含数据或以前包含的数据。
                     </p>
                     <div class="figure" id="GUID-5050DCC5-DBBD-4B57-AB14-D83A480B9AAE__BABJGIBJ">
                        <p class="titleinfigure">图12-25 HWM和低HWM</p><img src="img/cncpt276.gif" width="371" alt="下面是图12-25的描述" title="下面是图12-25的描述" longdesc="img_text/cncpt276.html"><br><a href="img_text/cncpt276.html">“图12-25 HWM和低HWM”的描述</a></div>
                     <!-- class="figure" -->
                     <p>在<a href="logical-storage-structures.html#GUID-5050DCC5-DBBD-4B57-AB14-D83A480B9AAE__CHDBFGBB">图12-26中</a> ，数据库选择HWM和低HWM之间的块并写入它。数据库可以很容易地选择HWM和低HWM之间的任何其他块，或者具有可用空间的低HWM之下的任何块。在<a href="logical-storage-structures.html#GUID-5050DCC5-DBBD-4B57-AB14-D83A480B9AAE__CHDBFGBB">图12-26中</a> ，新填充块两侧的块未格式化。
                     </p>
                     <div class="figure" id="GUID-5050DCC5-DBBD-4B57-AB14-D83A480B9AAE__CHDBFGBB">
                        <p class="titleinfigure">图12-26 HWM和低HWM</p><img src="img/cncpt333.gif" alt="下面是图12-26的描述" title="下面是图12-26的描述" longdesc="img_text/cncpt333.html"><br><a href="img_text/cncpt333.html">“图12-26 HWM和低HWM”的描述</a></div>
                     <!-- class="figure" -->
                     <p>低HWM在<a href="glossary.html#GUID-BF9B54D6-892E-4C3B-8536-38958ACC069D"><span class="xrefglossterm">全表扫描中</span></a>很重要。由于HWM下方的块仅在使用时被格式化，因此某些块可能未格式化， <a href="logical-storage-structures.html#GUID-5050DCC5-DBBD-4B57-AB14-D83A480B9AAE__CHDBFGBB">如图12-26所示</a> 。因此，数据库读取位图块以获得低HWM的位置。数据库读取所有块到低HWM，因为已知它们被格式化，然后仔细读取低HWM和HWM之间的格式化块。</p>
                     <p>假设新事务将行插入表中，但位图表明HWM下存在不足的可用空间。在<a href="logical-storage-structures.html#GUID-5050DCC5-DBBD-4B57-AB14-D83A480B9AAE__BABFHJIC">图12-27中</a> ，数据库将HWM向右推进，分配一组新的未格式化块。
                     </p>
                     <div class="figure" id="GUID-5050DCC5-DBBD-4B57-AB14-D83A480B9AAE__BABFHJIC">
                        <p class="titleinfigure">图12-27推进HWM和低HWM</p><img src="img/cncpt277.gif" alt="下面是图12-27的描述" title="下面是图12-27的描述" longdesc="img_text/cncpt277.html"><br><a href="img_text/cncpt277.html">“图12-27推进HWM和低HWM”的描述</a></div>
                     <!-- class="figure" -->
                     <p>当HWM和低HWM之间的块已满时，HWM向右前进，低HWM前进到旧HWM的位置。随着数据库随时间插入数据，HWM继续向右前进，低HWM始终落后于它。除非您手动重建，截断或缩小对象，否则HWM永远不会撤退。</p>
                     <div class="infoboxnotealso" id="GUID-5050DCC5-DBBD-4B57-AB14-D83A480B9AAE__GUID-BB3B416A-0E34-495D-87FE-090FE5DA4884">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/cncpt&amp;id=ADMIN10161" target="_blank"><span><cite>Oracle数据库管理员指南</cite></span></a> ，了解如何在线缩小细分</p>
                           </li>
                           <li>
                              <p>用于<code class="codeph">TRUNCATE TABLE</code>语法和语义的<a href="../sqlrf/TRUNCATE-TABLE.html#SQLRF01707" target="_blank"><span><cite>Oracle数据库SQL语言参考</cite></span></a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div>
            </div><a id="CNCPT89168"></a><a id="CNCPT402"></a><div class="props_rev_3"><a id="GUID-3502CA78-FBC9-4927-B455-0ECB22E53066" name="GUID-3502CA78-FBC9-4927-B455-0ECB22E53066"></a><h3 id="CNCPT-GUID-3502CA78-FBC9-4927-B455-0ECB22E53066" class="sect3">表空间概述</h3>
               <div>
                  <p><span class="bold">表空间</span>是段的逻辑存储容器。段是消耗存储空间的数据库对象，例如表和索引。在物理级别，表空间将数据存储在一个或多个数据文件或临时文件中。
                  </p>
                  <p>数据库必须具有<code class="codeph">SYSTEM</code>和<code class="codeph">SYSAUX</code>表空间。下图显示了典型数据库中的表空间。以下部分描述了表空间类型。
                  </p>
                  <div class="figure" id="GUID-3502CA78-FBC9-4927-B455-0ECB22E53066__BABBBFDJ">
                     <p class="titleinfigure">图12-28表空间</p><img src="img/cncpt319.gif" alt="下面是图12-28的描述" title="下面是图12-28的描述" longdesc="img_text/cncpt319.html"><br><a href="img_text/cncpt319.html">“图12-28表空间”的说明</a></div>
                  <!-- class="figure" -->
               </div><a id="CNCPT89026"></a><div class="props_rev_3"><a id="GUID-BD3962AF-D4E1-47C0-96CD-0A56807D7850" name="GUID-BD3962AF-D4E1-47C0-96CD-0A56807D7850"></a><h4 id="CNCPT-GUID-BD3962AF-D4E1-47C0-96CD-0A56807D7850" class="sect4">永久表空间</h4>
                  <div>
                     <p><strong class="term">永久表空间</strong>将持久模式对象分组。表空间中对象的段以物理方式存储在数据文件中。
                     </p>
                     <p>为每个数据库用户分配一个默认的永久表空间。一个非常小的数据库可能只需要默认的<code class="codeph">SYSTEM</code>和<code class="codeph">SYSAUX</code>表空间。但是，Oracle建议您至少创建一个表空间来存储用户和应用程序数据。您可以使用表空间来实现以下目标：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>控制数据库数据的磁盘空间分配</p>
                        </li>
                        <li>
                           <p>为数据库用户分配配额（空间限额或限制）</p>
                        </li>
                        <li>
                           <p>在线或离线获取单个表空间，而不会影响整个数据库的可用性</p>
                        </li>
                        <li>
                           <p>执行单个表空间的备份和恢复</p>
                        </li>
                        <li>
                           <p>使用Oracle Data Pump实用程序导入或导出应用程序数据</p>
                        </li>
                        <li>
                           <p>创建可<a href="glossary.html#GUID-F3AC6538-2722-4916-BD9F-EDAB8318CCCD"><span class="xrefglossterm">传输的表空间</span></a> ，您可以将其从一个数据库复制或移动到另一个数据库，甚至跨平台</p>
                           <p>通过传输表空间来移动数据可以比导出/导入或卸载/加载相同数据快几个数量级，因为传输表空间只涉及复制数据文件和集成表空间元数据。传输表空间时，还可以移动索引数据。</p>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-BD3962AF-D4E1-47C0-96CD-0A56807D7850__GUID-E226603D-E95C-4AE8-AAE2-8F32B264FFF5">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="q">“ <a href="concepts-for-database-administrators.html#GUID-DCDD0FBF-0AD2-45E1-B723-21CC72ADDCD6" title="Oracle Data Pump支持从一个数据库到另一个数据库的高速数据和元数据移动。">Oracle数据泵导出和导入</a> ”</span></p>
                           </li>
                           <li>
                              <p><a href="../admin/transporting-data.html#ADMIN01101" target="_blank"><span><cite>Oracle数据库管理员指南</cite></span></a> ，了解如何传输表空间</p>
                           </li>
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/cncpt&amp;id=SUTIL100" target="_blank"><span><cite>Oracle数据库实用程序，</cite></span></a>以了解Oracle Data Pump</p>
                           </li>
                        </ul>
                     </div>
                  </div><a id="CNCPT89028"></a><a id="CNCPT1086"></a><div class="props_rev_3"><a id="GUID-C1500AE3-17CD-4EF8-A83C-66A058C92CF5" name="GUID-C1500AE3-17CD-4EF8-A83C-66A058C92CF5"></a><h5 id="CNCPT-GUID-C1500AE3-17CD-4EF8-A83C-66A058C92CF5" class="sect5">SYSTEM表空间</h5>
                     <div>
                        <p><code class="codeph">SYSTEM</code>表空间是数据库创建时包含的必要管理表空间。Oracle数据库使用<code class="codeph">SYSTEM</code>来管理数据库。
                        </p>
                        <p><code class="codeph">SYSTEM</code>表空间包含以下信息，全部由<code class="codeph">SYS</code>用户拥有：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>数据字典</p>
                           </li>
                           <li>
                              <p>包含有关数据库的管理信息的表和视图</p>
                           </li>
                           <li>
                              <p>编译存储的对象，例如触发器，过程和包</p>
                           </li>
                        </ul>
                        <p><code class="codeph">SYSTEM</code>表空间作为任何其他表空间进行管理，但需要更高级别的权限，并且在某些方面受到限制。例如，您无法重命名或删除<code class="codeph">SYSTEM</code>表空间。
                        </p>
                        <p>默认情况下，Oracle数据库将所有新创建的用户表空间设置为本地管理。在具有本地管理的<code class="codeph">SYSTEM</code>表空间的数据库中，您无法创建字典管理的表空间（已弃用）。但是，如果手动执行<code class="codeph">CREATE DATABASE</code>语句并接受默认值，则<code class="codeph">SYSTEM</code>表空间是字典管理的。您可以将现有字典管理的<code class="codeph">SYSTEM</code>表空间迁移到本地管理的格式。
                        </p>
                        <div class="infoboxnote" id="GUID-C1500AE3-17CD-4EF8-A83C-66A058C92CF5__GUID-BAF01C9A-BFEB-47F9-81D8-5B20635EB726">
                           <p class="notep1">注意：</p>
                           <p>Oracle强烈建议您使用Database Configuration Assistant（DBCA）创建新数据库，以便默认情况下本地管理所有表空间（包括<code class="codeph">SYSTEM</code> 。
                           </p>
                        </div>
                        <div class="infoboxnotealso" id="GUID-C1500AE3-17CD-4EF8-A83C-66A058C92CF5__GUID-D37BA428-FF63-43F6-AF45-F7E33A839D9D">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><span class="q">“ <a href="logical-storage-structures.html#GUID-DBE61726-0DE6-4A85-A49B-9F5587234A87" title="每当数据库打开时，表空间都可以在线（可访问）或脱机（不可访问）。">在线和离线表空间</a> ”，</span>以获取有关<code class="codeph">SYSTEM</code>表空间的永久在线状态的信息</p>
                              </li>
                              <li>
                                 <p><span class="q">“ <a href="concepts-for-database-administrators.html#GUID-87ACF317-FEBC-418C-9BE6-253F2C43F482" title="Oracle提供了多种工具来简化安装和配置Oracle数据库软件的任务。">数据库安装和配置工具</a> ”</span>了解DBCA</p>
                              </li>
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/cncpt&amp;id=ADMIN11393" target="_blank"><span><cite>Oracle数据库管理员指南</cite></span></a> ，了解如何创建或迁移到本地管理的<code class="codeph">SYSTEM</code>表空间</p>
                              </li>
                              <li>
                                 <p>用于<code class="codeph">CREATE DATABASE</code>语法和语义的<a href="../sqlrf/CREATE-DATABASE.html#SQLRF01204" target="_blank"><span><cite>Oracle数据库SQL语言参考</cite></span></a></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div><a id="CNCPT1089"></a><div class="props_rev_3"><a id="GUID-E4055936-C426-4B5C-8811-32FF98284F16" name="GUID-E4055936-C426-4B5C-8811-32FF98284F16"></a><h5 id="CNCPT-GUID-E4055936-C426-4B5C-8811-32FF98284F16" class="sect5">SYSAUX表空间</h5>
                     <div>
                        <p><code class="codeph">SYSAUX</code>表空间是<code class="codeph">SYSTEM</code>表空间的辅助表空间。
                        </p>
                        <p>由于<code class="codeph">SYSAUX</code>是以前需要自己的表空间的许多Oracle数据库功能和产品的默认表空间，因此它减少了数据库所需的表空间数量。它还减少了<code class="codeph">SYSTEM</code>表空间的负载。
                        </p>
                        <p>数据库创建或升级会自动创建<code class="codeph">SYSAUX</code>表空间。在正常的数据库操作期间，数据库不允许删除或重命名<code class="codeph">SYSAUX</code>表空间。如果<code class="codeph">SYSAUX</code>表空间不可用，则核心数据库功能仍可运行。使用<code class="codeph">SYSAUX</code>表空间的数据库功能可能会失败，或者功能有限。
                        </p>
                        <div class="infoboxnotealso" id="GUID-E4055936-C426-4B5C-8811-32FF98284F16__GUID-F9D1E871-6556-47B3-9342-0E00585E39CD">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/cncpt&amp;id=ADMIN00203" target="_blank"><span><cite>Oracle数据库管理员指南</cite></span></a> ，了解<code class="codeph">SYSAUX</code>表空间</p>
                        </div>
                     </div>
                  </div><a id="CNCPT1090"></a><div class="props_rev_3"><a id="GUID-29C6EBF7-64AB-468E-A8CD-6ED36677D604" name="GUID-29C6EBF7-64AB-468E-A8CD-6ED36677D604"></a><h5 id="CNCPT-GUID-29C6EBF7-64AB-468E-A8CD-6ED36677D604" class="sect5">撤消表空间</h5>
                     <div>
                        <p><span class="bold">撤消表空间</span>是为系统管理的撤消数据保留的本地管理的表空间。
                        </p>
                        <p>与其他永久表空间一样，撤消表空间包含数据文件。这些文件中的撤消块按范围分组。</p>
                        <div class="infoboxnotealso" id="GUID-29C6EBF7-64AB-468E-A8CD-6ED36677D604__GUID-91966206-7CCF-469C-B8FF-BD4C1B681FBA">
                           <p class="notep1">也可以看看：</p>
                           <p><span class="q">“ <a href="logical-storage-structures.html#GUID-6E206D3A-E0E7-4B23-9C41-516FB35BC3FE" title="Oracle数据库维护事务操作的记录，统称为撤消数据。">撤消细分</a> ”</span></p>
                        </div>
                     </div><a id="CNCPT1079"></a><div class="props_rev_3"><a id="GUID-3BC7D6F1-8060-4A00-800E-A00C2F621634" name="GUID-3BC7D6F1-8060-4A00-800E-A00C2F621634"></a><h6 id="CNCPT-GUID-3BC7D6F1-8060-4A00-800E-A00C2F621634" class="sect6">自动撤消管理模式</h6>
                        <div>
                           <p>撤消表空间要求数据库处于<strong class="term">默认的自动撤消模式</strong> 。
                           </p>
                           <p>自动模式消除了手动管理还原段的复杂性。数据库会自动调整自身以提供最佳的撤消数据保留，以满足可能需要此数据的长时间运行的查询。</p>
                           <p>新安装的Oracle数据库会自动创建一个撤消表空间。早期版本的Oracle数据库可能不包含撤消表空间，而是使用旧版回滚段，称为<a href="glossary.html#GUID-D30B79E4-A641-4521-98C2-6F500A553736"><span class="xrefglossterm">手动撤消管理模式</span></a> 。升级到<span>Oracle Database 11g</span>或更高版本时，可以启用自动撤消管理模式并创建撤消表空间。Oracle数据库包含一个撤消顾问，它提供有关撤消环境的建议并帮助您自动化撤消环境。
                           </p>
                           <p>数据库可以包含多个撤消表空间，但一次只能使用一个。当实例尝试打开数据库时，Oracle数据库会自动选择第一个可用的撤消表空间。如果没有可用的撤消表空间，则实例将在没有撤消表空间的情况下启动，并将撤消数据存储在<code class="codeph">SYSTEM</code>表空间中。建议不要在<code class="codeph">SYSTEM</code>存储撤消数据。
                           </p>
                           <div class="infoboxnotealso" id="GUID-3BC7D6F1-8060-4A00-800E-A00C2F621634__GUID-E835BD0F-F4D5-485D-87E7-07B4702A38A5">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><a href="../admin/managing-undo.html#ADMIN11461" target="_blank"><span><cite>Oracle数据库管理员指南</cite></span></a> ，了解自动撤消管理</p>
                                 </li>
                                 <li>
                                    <p><a href="../upgrd/index.html" target="_blank"><span><cite>Oracle数据库升级指南</cite></span></a> ，了解如何迁移到自动撤消管理模式</p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                     </div><a id="CNCPT1080"></a><div class="props_rev_3"><a id="GUID-0C389DB8-AAD1-49E2-9E9F-0270F7B25B3D" name="GUID-0C389DB8-AAD1-49E2-9E9F-0270F7B25B3D"></a><h6 id="CNCPT-GUID-0C389DB8-AAD1-49E2-9E9F-0270F7B25B3D" class="sect6">自动撤消保留</h6>
                        <div>
                           <p><span class="bold">撤消保留期</span>是Oracle数据库在覆盖之前尝试保留旧撤消数据的最短时间。
                           </p>
                           <p>撤消保留很重要，因为长时间运行的查询可能需要较旧的块映像来提供<a href="glossary.html#GUID-A2D92FBD-9C36-432E-A44F-0462DB2E5527"><span class="xrefglossterm">读取一致性</span></a> 。此外，某些Oracle闪回功能可能依赖于撤消可用性。
                           </p>
                           <p>通常，希望尽可能长时间地保留旧的撤销数据。事务提交后，不再需要撤消数据进行回滚或事务恢复。如果撤消表空间具有用于新事务的空间，则数据库可以保留旧的撤消数据。当可用空间不足时，数据库开始覆盖已提交事务的旧撤消数据。</p>
                           <p>Oracle数据库自动为当前的撤消表空间提供最佳的撤消保留。数据库收集使用情况统计信息，并根据这些统计信息和撤消表空间大小调整保留期。如果使用<code class="codeph">AUTOEXTEND</code>选项配置撤消表空间，并且未指定最大大小，则撤消保留调整会有所不同。在这种情况下，如果空间允许，数据库会将撤消保留期调整为比运行时间最长的查询略长。
                           </p>
                           <div class="infoboxnotealso" id="GUID-0C389DB8-AAD1-49E2-9E9F-0270F7B25B3D__GUID-4AEF661C-C1F8-4DD9-A099-DF1CB22BE1A0">
                              <p class="notep1">也可以看看：</p>
                              <p>有关自动调整撤消保留的详细信息，请参见<a href="../admin/managing-undo.html#ADMIN-GUID-049380AF-220F-43C0-81B2-27DCD7953574" target="_blank"><span><cite>“Oracle数据库管理员指南”</cite></span></a></p>
                           </div>
                        </div>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-36AAD6A3-1677-432C-B40A-4288F870A3C8" name="GUID-36AAD6A3-1677-432C-B40A-4288F870A3C8"></a><h5 id="CNCPT-GUID-36AAD6A3-1677-432C-B40A-4288F870A3C8" class="sect5">影子表空间</h5>
                     <div>
                        <p><strong class="term">影子表空间</strong>是一个bigfile表空间，用于<strong class="term">阴影丢失写保护</strong> 。
                        </p>
                        <div class="infoboxnote" id="GUID-36AAD6A3-1677-432C-B40A-4288F870A3C8__GUID-380497CF-2D1E-47CB-85F5-5C50466D0C83">
                           <p class="notep1">注意：</p>
                           <p>影子丢失写保护与使用<code class="codeph">DB_LOST_WRITE_PROTECT</code>初始化参数和备用数据库配置的丢失写保护<code class="codeph">DB_LOST_WRITE_PROTECT</code> 。
                           </p>
                        </div>
                     </div>
                     <div class="sect5"><a id="GUID-44C7652F-78D8-410A-8717-FA43F1D5E645" name="GUID-44C7652F-78D8-410A-8717-FA43F1D5E645"></a><h6 id="CNCPT-GUID-44C7652F-78D8-410A-8717-FA43F1D5E645" class="sect6">影子表空间的用途</h6>
                        <div>
                           <p>阴影丢失写保护提供快速检测和对<strong class="term">丢失写入的</strong>即时响应。
                           </p>
                           <p>当I / O子系统确认块写入完成时发生数据块丢失写入，即使没有发生写入或者块的前一个图像覆盖当前图像。</p>
                           <p>未检测到的丢失写入可能导致数据损坏，因为不正确的数据可用于其他DML事务。例如，事务可以从一个表读取旧的和不正确的数据，然后根据此数据更新数百个其他表。通过这种方式，数据损坏可以在整个数据库中传播。</p>
                           <p>阴影丢失写保护提供以下好处：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>它在标准DML，SQL * Loader常规路径加载，直接路径加载和RMAN备份使用之前检测到丢失的写入。</p>
                              </li>
                              <li>
                                 <p>不需要备用数据库，如<span>Oracle Database 11g中</span>引入的丢失写保护。
                                 </p>
                              </li>
                              <li>
                                 <p>您可以为特定表空间和数据文件启用阴影丢失写保护。您无需跟踪所有数据。</p>
                              </li>
                              <li>
                                 <p>您可以将一个影子表空间替换为另一个影子表空间以更改其配置或位置。</p>
                              </li>
                              <li>
                                 <p>您可以暂停和恢复表空间或数据文件的阴影丢失写保护。</p>
                              </li>
                              <li>
                                 <p>您可以使用单个<code class="codeph">ALTER DATABASE ...为整个非CDB或PDB启用或禁用它<code class="codeph">ALTER DATABASE ...LOST WRITE TRACKING</code>声明。请注意， <code class="codeph">PROP$</code>表指示是否为PDB启用了跟踪。</p>
                              </li>
                           </ul>
                           <div class="infoboxnotealso" id="GUID-44C7652F-78D8-410A-8717-FA43F1D5E645__GUID-3932BD9E-C47C-4C4F-9DCF-075EF0A1B431">
                              <p class="notep1">也可以看看：</p>
                              <p><a href="../sqlrf/ALTER-DATABASE.html#SQLRF00802" target="_blank"><span><cite>Oracle Database SQL语言参考，</cite></span></a>以了解有关<code class="codeph">LOST WRITE TRACKING</code>子句的更多信息</p>
                           </div>
                        </div>
                     </div>
                     <div class="sect5"><a id="GUID-16C39881-6B6B-45C2-860E-5462C3896AC5" name="GUID-16C39881-6B6B-45C2-860E-5462C3896AC5"></a><h6 id="CNCPT-GUID-16C39881-6B6B-45C2-860E-5462C3896AC5" class="sect6">影子表空间的工作原理</h6>
                        <div>
                           <p>丢失写保护需要两个表空间：一个影子表空间和一个非影子表空间，其影子表由影子表空间跟踪。</p>
                           <p>下图提供了一个示例场景。表空间<code class="codeph">TBS1</code>和<code class="codeph">TBS2</code>中的数据文件由影子表空间跟踪。只有影子表空间跟踪表空间<code class="codeph">TBS3</code>数据文件<code class="codeph">DBF6</code> 。
                           </p>
                           <div class="figure" id="GUID-16C39881-6B6B-45C2-860E-5462C3896AC5__GUID-1784D4D7-21A0-4020-9BF8-4B523BCBC90C"><img src="img/cncpt390.png" alt="cncpt390.eps的描述如下" title="cncpt390.eps的描述如下" longdesc="img_text/cncpt390.html"><br><a href="img_text/cncpt390.html">插图说明cncpt390.eps</a></div>
                           <!-- class="figure" -->
                           <p>一个<a href="glossary.html#GUID-8A0DABA5-3509-4298-B206-C379910EC038"><span class="xrefglossterm">跟踪数据文件</span></a>映射到阴影表空间中的一个<a href="glossary.html#GUID-2A32C405-187E-47FB-85C7-2B56E9C34286"><span class="xrefglossterm">阴影范围</span></a> 。跟踪数据文件中的每个数据块在阴影块中都有对应的条目。此条目包含跟踪数据块的SCN。当从磁盘读取跟踪数据块时，阴影丢失写保护会将影子表空间中的块的SCN与跟踪数据块中最近写入的SCN进行比较。如果影子条目的SCN大于正在读取的数据块，则会发生丢失写入，从而提示错误。
                           </p>
                           <p>阴影范围的大小具有显着的额外空间，以防止数据文件的自动调整大小导致阴影范围变得过大。如果手动或自动调整跟踪数据文件的大小，并且阴影范围需要增长，则数据库会尝试调整跟踪数据的大小。如果影子表空间中没有足够的空间，则数据库会向警报日志写入警告，并跟踪尽可能多的数据块。</p>
                           <div class="infoboxnotealso" id="GUID-16C39881-6B6B-45C2-860E-5462C3896AC5__GUID-D463D237-F7F2-473C-BB87-57A1E0D2CFE9">
                              <p class="notep1">也可以看看：</p>
                              <p><a href="../admin/managing-tablespaces.html#GUID-23154DE0-B2AA-4D73-BBCA-73ED5786FF2B" target="_blank"><span><cite>Oracle数据库管理员指南</cite></span></a> ，了解如何管理影子丢失的写保护</p>
                           </div>
                        </div>
                     </div>
                     <div class="sect5"><a id="GUID-62BDBC60-6356-480C-BA98-F5C95330EDFA" name="GUID-62BDBC60-6356-480C-BA98-F5C95330EDFA"></a><h6 id="CNCPT-GUID-62BDBC60-6356-480C-BA98-F5C95330EDFA" class="sect6">影子表空间的用户界面</h6>
                        <div>
                           <p>使用<code class="codeph">ALTER DATABASE</code>命令启用和禁用阴影丢失写保护。
                           </p>
                           <p>对于保护特定表空间或数据文件的阴影丢失写保护，必须满足以下条件：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>您必须使用<code class="codeph">ALTER DATABASE ENABLE LOST WRITE PROTECTION</code>语句为整个非CDB或PDB启用了阴影丢失写保护。
                                 </p>
                                 <div class="infoboxnote" id="GUID-62BDBC60-6356-480C-BA98-F5C95330EDFA__GUID-7B9BFA1C-B8EB-4C39-AE44-390AFF183318">
                                    <p class="notep1">注意：</p>
                                    <p>在CDB中，如果在根中启用了阴影丢失写保护，则PDB不会继承它。必须为要保护的每个PDB启用阴影丢失写保护。</p>
                                 </div>
                              </li>
                              <li>
                                 <p>您必须使用<code class="codeph">ENABLE LOST WRITE PROTECTION</code>子句为要保护的表空间或数据文件启用阴影丢失写保护。
                                 </p>
                                 <p>为表空间启用阴影丢失写保护时，表空间的所有数据文件都受到保护，并且添加到表空间的所有数据文件也受到保护。请注意，您无法在临时表空间或其他丢失的写表空间上启用丢失的写保护。</p>
                              </li>
                              <li>
                                 <p>您必须使用带有<code class="codeph">LOST WRITE PROTECTION</code>子句的<code class="codeph">CREATE BIGFILE TABLESPACE</code>语句创建一个或多个影子表空间。
                                 </p>
                              </li>
                           </ul>
                           <p>Oracle数据库自动将跟踪的数据文件分配给特定的影子表空间。您无法指定将哪个影子表空间用于特定数据文件。</p>
                           <p>以下数据字典视图监视影子表空间：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><code class="codeph">DBA_TABLESPACES</code></p>
                                 <p>通过查询显示哪些表空间是影子表空间。</p>
                              </li>
                              <li>
                                 <p><code class="codeph">DBA_DATA_FILES.LOST_WRITE_PROTECT</code></p>
                                 <p>显示是否为数据文件启用了丢失的写保护</p>
                              </li>
                              <li>
                                 <p><code class="codeph">USER_TABLESPACES.LOST_WRITE_PROTECT</code></p>
                                 <p>显示是否为特定表空间打开了丢失的写保护。<code class="codeph">DBA_DATA_FILES</code>不指示是否为表空间打开了丢失写入：您必须查看<code class="codeph">USER_TABLESPACES</code> 。
                                 </p>
                              </li>
                           </ul>
                           <div class="infoboxnotealso" id="GUID-62BDBC60-6356-480C-BA98-F5C95330EDFA__GUID-BFC9EFB9-13A6-4E43-9F81-EF5CEB54493A">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><span class="q">“ <a href="topics-for-database-administrators-and-developers.html#GUID-CEA4D714-A143-4F9F-8EED-EE5A6B29B3C3" title="当硬件，软件或网络组件导致读取或写入损坏的数据时，会发生数据损坏。">数据腐败</a> ”</span></p>
                                 </li>
                                 <li>
                                    <p><a href="../admin/managing-tablespaces.html#ADMIN-GUID-23154DE0-B2AA-4D73-BBCA-73ED5786FF2B" target="_blank"><span><cite>Oracle数据库管理员指南</cite></span></a> ，了解如何管理影子表空间</p>
                                 </li>
                                 <li>
                                    <p><a href="../sqlrf/CREATE-TABLESPACE.html#SQLRF01403" target="_blank"><span><cite>Oracle Database SQL语言参考</cite></span></a> ，了解<code class="codeph">CREATE TABLESPACE</code>语句</p>
                                 </li>
                                 <li>
                                    <p><a href="../refrn/DBA_TABLESPACES.html#REFRN-GUID-B28A7D79-24E3-49B5-B948-7C2277CB1FB8" target="_blank"><span><cite>Oracle Database Reference</cite></span></a>了解<code class="codeph">DBA_TABLESPACES</code></p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                     </div>
                     <div class="sect5"><a id="GUID-DE072DB9-9375-4FCA-91E3-AEB37535AA44" name="GUID-DE072DB9-9375-4FCA-91E3-AEB37535AA44"></a><h6 id="CNCPT-GUID-DE072DB9-9375-4FCA-91E3-AEB37535AA44" class="sect6">示例：配置丢失写保护</h6>
                        <div>
                           <p>此示例为一组表空间启用了阴影丢失写入跟踪。</p>
                           <div class="section">
                              <p>在此示例中，您的目标是保护非CDB中的<code class="codeph">salestbs</code>和<code class="codeph">hrtbs</code>表空间。您还希望在<code class="codeph">oetbs</code>表空间内保护<code class="codeph">oetbs01.dbf</code>数据文件，并且只保护此数据文件。您执行以下操作：</p>
                              <ol>
                                 <li>
                                    <p>以<code class="codeph">SYSTEM</code>身份登录数据库。</p>
                                 </li>
                                 <li>
                                    <p>创建单个影子表空间，如下所示：</p><pre class="pre codeblock"><code>创建BIGFILE TABLESPACE shadow_lwp1 DATAFILE'shadow_lwp1_df'SIZE 10M LOST WRITE PROTECTION;</code></pre></li>
                                 <li>
                                    <p>为整个数据库启用丢失的写保护，如下所示：</p><pre class="pre codeblock"><code>ALTER DATABASE使LOST写保护失效;</code></pre></li>
                                 <li>
                                    <p>为<code class="codeph">salestbs</code>和<code class="codeph">hrtbs</code>表空间启用阴影丢失写保护，如下所示：</p><pre class="pre codeblock"><code>ALTER TABLESPACE salestbs ENABLE LOST WRITE PROTECTION; ALTER TABLESPACE hrtbs启用丢失写保护;</code></pre></li>
                                 <li>
                                    <p>为<code class="codeph">oetbs01.dbf</code>数据文件启用阴影丢失写保护，如下所示：</p><pre class="pre codeblock"><code>ALTER DATABASE DATAFILE'oetbs01.dbf'启用丢失的写保护;</code></pre></li>
                              </ol>
                              <div class="infoboxnotealso" id="GUID-DE072DB9-9375-4FCA-91E3-AEB37535AA44__GUID-63FA5FB5-B7CA-42F1-AC89-AE0757F648CC">
                                 <p class="notep1">也可以看看：</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p><a href="../admin/managing-tablespaces.html#ADMIN-GUID-23154DE0-B2AA-4D73-BBCA-73ED5786FF2B" target="_blank"><span><cite>Oracle数据库管理员指南</cite></span></a> ，了解如何管理影子表空间</p>
                                    </li>
                                    <li>
                                       <p><a href="../sqlrf/CREATE-TABLESPACE.html#SQLRF01403" target="_blank"><span><cite>Oracle Database SQL语言参考</cite></span></a> ，了解<code class="codeph">CREATE TABLESPACE</code>语句</p>
                                    </li>
                                 </ul>
                              </div>
                           </div>
                           <!-- class="section" -->
                        </div>
                     </div>
                  </div>
               </div><a id="CNCPT1092"></a><a id="CNCPT89029"></a><div class="props_rev_3"><a id="GUID-93848D41-A32B-494F-87A0-A090FF1B2E9A" name="GUID-93848D41-A32B-494F-87A0-A090FF1B2E9A"></a><h4 id="CNCPT-GUID-93848D41-A32B-494F-87A0-A090FF1B2E9A" class="sect4">临时表空间</h4>
                  <div>
                     <p><span class="bold">临时表空间</span>包含仅在会话期间保留的临时数据。永久模式对象不能驻留在临时表空间中。<span class="bold">临时文件</span>存储临时表空间数据。
                     </p>
                     <p>临时表空间可以改善不适合内存的多个排序操作的并发性。这些表空间还可以提高各种空间管理操作的效率。</p>
                  </div>
                  <div class="sect4"><a id="GUID-8EB47FD3-2C96-4130-98B7-36E0B1DA0486" name="GUID-8EB47FD3-2C96-4130-98B7-36E0B1DA0486"></a><h5 id="CNCPT-GUID-8EB47FD3-2C96-4130-98B7-36E0B1DA0486" class="sect5">共享和本地临时表空间</h5>
                     <div>
                        <p>临时表空间可以是共享的，也可以是本地的。</p>
                        <p><a href="glossary.html#GUID-66347815-8AB8-4E23-9B86-F3748CB46AA6"><span class="xrefglossterm">共享临时表空间</span></a>将临时文件存储在共享磁盘上，以便所有数据库实例都可以访问临时空间。相反， <a href="glossary.html#GUID-3B1784FE-857F-4421-B6F8-17105AEBB6B7"><span class="xrefglossterm">本地临时表空间</span></a>为每个数据库实例存储单独的非共享临时文件。本地临时表空间对Oracle Real Application Clusters或Oracle Flex Clusters非常有用。
                        </p>
                        <div class="infoboxnote" id="GUID-8EB47FD3-2C96-4130-98B7-36E0B1DA0486__GUID-9C316BCB-4A99-41DD-B6A2-AA7A8BB2E4C3">
                           <p class="notep1">注意：</p>本地临时表空间是<span>Oracle Database 12c</span>第2版（12.2）中的新增功能。在以前的版本中，共享临时表空间简称为<span class="italic">临时表空间</span> 。从此版本开始，术语<span class="italic">临时表空间</span>引用共享临时表空间，除非另有说明。
                        </div>
                        <p>您可以为只读和读/写数据库实例创建本地临时表空间。当许多只读实例访问单个数据库时，本地临时表空间可以提高涉及排序，散列聚合和连接的查询的性能。优点是：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>通过使用本地而非共享磁盘存储来提高I / O性能</p>
                           </li>
                           <li>
                              <p>避免昂贵的跨实例临时空间管理</p>
                           </li>
                           <li>
                              <p>通过消除磁盘空间元数据管理来提高实例启动性能</p>
                           </li>
                        </ul>
                        <p>下表比较了共享和本地临时表空间的特征。</p>
                        <div class="tblformal" id="GUID-8EB47FD3-2C96-4130-98B7-36E0B1DA0486__GUID-6FA2085C-EE5C-4293-A045-D1FA379FE57F">
                           <p class="titleintable">表12-2共享和本地临时表空间</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="共享和本地临时表空间" border="1" summary="This table compares the characteristics of shared and local temporary tablespaces." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="20%" id="d61599e18611">共享临时表空间</th>
                                    <th align="left" valign="bottom" width="20%" id="d61599e18613">本地临时表空间</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d61599e18617" headers="d61599e18611 ">使用<code class="codeph">CREATE TEMPORARY TABLESPACE</code>语句创建。
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d61599e18617 d61599e18613 ">使用<code class="codeph">CREATE LOCAL TEMPORARY TABLESPACE</code>语句<code class="codeph">CREATE LOCAL TEMPORARY TABLESPACE</code> 。
                                       <p><span class="bold">注意：</span>本地临时表空间始终是<a href="glossary.html#GUID-02B4A6A1-8828-47C9-A921-11966359363E"><span class="xrefglossterm">bigfile表空间</span></a> ，但创建语句中不需要<code class="codeph">BIGFILE</code>关键字。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d61599e18638" headers="d61599e18611 ">为数据库创建单个临时表空间。</td>
                                    <td align="left" valign="top" width="20%" headers="d61599e18638 d61599e18613 ">为每个数据库实例创建单独的临时表空间。<code class="codeph">FOR LEAF</code>选项仅为只读实例创建表空间。<code class="codeph">FOR ALL</code>选项为所有实例创建表空间，包括只读和读/写。
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d61599e18649" headers="d61599e18611 ">支持表空间组。</td>
                                    <td align="left" valign="top" width="20%" headers="d61599e18649 d61599e18613 ">不支持表空间组。</td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d61599e18654" headers="d61599e18611 ">在控制文件中存储临时文件元数据。</td>
                                    <td align="left" valign="top" width="20%" headers="d61599e18654 d61599e18613 ">存储控制文件中所有实例共有的临时文件元数据，以及SGA中特定于实例的元数据（例如，分配的位图，当前临时文件大小和文件状态）。</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                        <div class="infoboxnotealso" id="GUID-8EB47FD3-2C96-4130-98B7-36E0B1DA0486__GUID-84084335-4A4D-4158-9802-2C327C01C353">
                           <p class="notep1">也可以看看：</p>
                           <p><span class="q">“ <a href="oracle-database-instance.html#GUID-2942B648-70FA-47B4-8950-0CC6884B1F80" title="数据库实例是一组管理数据库文件的内存结构。">Oracle数据库实例简介</a> ”</span></p>
                        </div>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-3F457D7A-93F3-411A-94B7-75C0888C1F94" name="GUID-3F457D7A-93F3-411A-94B7-75C0888C1F94"></a><h5 id="CNCPT-GUID-3F457D7A-93F3-411A-94B7-75C0888C1F94" class="sect5">默认临时表空间</h5>
                     <div>
                        <p>为每个数据库用户帐户分配一个默认的共享临时表空间。如果数据库包含本地临时表空间，则还会为每个用户帐户分配默认的本地临时存储。</p>
                        <p>您可以使用<code class="codeph">CREATE USER</code>或<code class="codeph">ALTER USER</code>语句为用户帐户指定不同的临时表空间。Oracle数据库对未为其指定其他临时表空间的用户使用系统级缺省临时表空间。
                        </p>
                        <div class="infoboxnotealso" id="GUID-3F457D7A-93F3-411A-94B7-75C0888C1F94__GUID-CF428B87-8218-46D4-B11B-C1B33AAC4F50">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="../sqlrf/CREATE-USER.html#SQLRF01503" target="_blank"><span><cite>Oracle数据库SQL语言参考，</cite></span></a>以了解有关<code class="codeph">CREATE USER</code>语句的更多信息</p>
                        </div>
                     </div>
                     <div class="sect5"><a id="GUID-428FB762-4EDE-4BAC-B23D-C4789F148943" name="GUID-428FB762-4EDE-4BAC-B23D-C4789F148943"></a><h6 id="CNCPT-GUID-428FB762-4EDE-4BAC-B23D-C4789F148943" class="sect6">创建默认临时表空间</h6>
                        <div>
                           <p>创建数据库时，默认临时存储取决于<code class="codeph">SYSTEM</code>表空间是否在本地管理。
                           </p>
                           <p>下表显示了Oracle数据库在创建数据库时如何选择默认临时表空间。</p>
                           <div class="tblformal" id="GUID-428FB762-4EDE-4BAC-B23D-C4789F148943__GUID-181EE4F0-DD68-42F4-90E2-15A6C8235303">
                              <p class="titleintable">表12-3创建默认临时表空间</p>
                              <table cellpadding="4" cellspacing="0" class="Formal" title="创建默认临时表空间" border="1" summary="This table shows the options for creation of default temporary tablespaces" frame="hsides" rules="rows">
                                 <thead>
                                    <tr align="left" valign="top">
                                       <th align="left" valign="bottom" width="20%" id="d61599e19239">SYSTEM表空间是否在本地管理？</th>
                                       <th align="left" valign="bottom" width="20%" id="d61599e19241">CREATE DATABASE语句是否指定了默认的临时表空间？</th>
                                       <th align="left" valign="bottom" width="20%" id="d61599e19243">那么数据库......</th>
                                    </tr>
                                 </thead>
                                 <tbody>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="20%" id="d61599e19247" headers="d61599e19239 ">是</td>
                                       <td align="left" valign="top" width="20%" headers="d61599e19247 d61599e19241 ">是</td>
                                       <td align="left" valign="top" width="20%" headers="d61599e19247 d61599e19243 ">使用指定的表空间作为默认值。</td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="20%" id="d61599e19254" headers="d61599e19239 ">是</td>
                                       <td align="left" valign="top" width="20%" headers="d61599e19254 d61599e19241 ">没有</td>
                                       <td align="left" valign="top" width="20%" headers="d61599e19254 d61599e19243 ">创建临时表空间。</td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="20%" id="d61599e19261" headers="d61599e19239 ">没有</td>
                                       <td align="left" valign="top" width="20%" headers="d61599e19261 d61599e19241 ">是</td>
                                       <td align="left" valign="top" width="20%" headers="d61599e19261 d61599e19243 ">使用指定的表空间作为默认值。</td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="20%" id="d61599e19268" headers="d61599e19239 ">没有</td>
                                       <td align="left" valign="top" width="20%" headers="d61599e19268 d61599e19241 ">没有</td>
                                       <td align="left" valign="top" width="20%" headers="d61599e19268 d61599e19243 ">使用<code class="codeph">SYSTEM</code>进行默认临时存储。数据库在<a href="glossary.html#GUID-ACC7727F-41AE-47B1-AADB-2585EE828792"><span class="xrefglossterm">警报日志中</span></a>写入警告，指出建议使用默认临时表空间。
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <!-- class="inftblhruleinformal" -->
                           <p>创建数据库后，可以使用<code class="codeph">ALTER DATABASE DEFAULT TEMPORARY TABLESPACE</code>语句<code class="codeph">ALTER DATABASE DEFAULT TEMPORARY TABLESPACE</code>的默认临时表空间。
                           </p>
                           <div class="infoboxnote" id="GUID-428FB762-4EDE-4BAC-B23D-C4789F148943__GUID-3B85D03F-11B4-4622-A385-806F5029CEA8">
                              <p class="notep1">注意：</p>
                              <p>您不能永久保留默认临时表空间。</p>
                           </div>
                           <div class="infoboxnotealso" id="GUID-428FB762-4EDE-4BAC-B23D-C4789F148943__GUID-22CF2657-823D-44D1-A854-115EC3EA6A51">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><span class="q">“ <a href="physical-storage-structures.html#GUID-D59095AD-F79B-4C54-BBED-798E510B049E" title="永久表空间包含持久模式对象。永久表空间中的对象存储在数据文件中。">永久和临时数据文件</a> ”</span></p>
                                 </li>
                                 <li>
                                    <p><a href="../admin/creating-and-configuring-an-oracle-database.html#ADMIN11090" target="_blank"><span class="italic">Oracle数据库管理员指南</span></a> ，了解如何创建默认临时表空间</p>
                                 </li>
                                 <li>
                                    <p><a href="../sqlrf/CREATE-DATABASE.html#SQLRF53870" target="_blank"><span class="italic">Oracle数据库SQL语言参考</span></a> ，了解<code class="codeph">CREATE DATABASE</code>和<code class="codeph">ALTER DATABASE</code>的<code class="codeph">DEFAULT TEMPORARY TABLESPACE</code>子句的语法</p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                     </div>
                     <div class="sect5"><a id="GUID-5387D7B2-C0CA-4C1E-811B-C7EB9B636442" name="GUID-5387D7B2-C0CA-4C1E-811B-C7EB9B636442"></a><h6 id="CNCPT-GUID-5387D7B2-C0CA-4C1E-811B-C7EB9B636442" class="sect6">访问临时存储</h6>
                        <div>
                           <p>如果用户分配了临时表空间，则数据库首先访问它;否则，数据库访问默认的临时表空间。数据库访问查询的临时表空间后，它不会切换到另一个表空间。</p>
                           <p>用户查询可以访问共享或本地临时存储。此外，用户可以为只读实例分配一个默认本地临时表空间，为读/写实例分配不同的默认本地临时表空间。</p>
                           <p>对于读/写实例，数据库为共享临时表空间提供更高的优先级。对于只读实例，数据库为本地临时表空间提供更高的优先级。如果数据库实例是读/写，则数据库按以下顺序搜索空间：</p>
                           <ol>
                              <li>
                                 <p>是否为用户分配了共享临时表空间？</p>
                              </li>
                              <li>
                                 <p>是否为用户分配了本地临时表空间？</p>
                              </li>
                              <li>
                                 <p>数据库默认临时表空间是否有空格？</p>
                              </li>
                           </ol>
                           <p>如果前面任何一个问题的答案都是肯定的，那么数据库就会停止搜索并从指定的表空间中分配空间;否则，从数据库默认本地临时表空间分配空间。</p>
                           <p>如果数据库实例是只读的，则数据库按以下顺序搜索空间：</p>
                           <ol>
                              <li>
                                 <p>是否为用户分配了本地临时表空间？</p>
                              </li>
                              <li>
                                 <p>分配的数据库默认本地临时表空间是否有空格？</p>
                              </li>
                              <li>
                                 <p>是否为用户分配了共享临时表空间？</p>
                              </li>
                           </ol>
                           <p>如果前面任何问题的答案都是肯定的，那么数据库将停止搜索并从指定的表空间分配空间;否则，从数据库默认共享临时表空间分配空间。</p>
                        </div>
                     </div>
                  </div>
               </div><a id="CNCPT89027"></a><div class="props_rev_3"><a id="GUID-4984EBD7-4250-48F0-8EA9-A28DD8A17C6B" name="GUID-4984EBD7-4250-48F0-8EA9-A28DD8A17C6B"></a><h4 id="CNCPT-GUID-4984EBD7-4250-48F0-8EA9-A28DD8A17C6B" class="sect4">表空间模式</h4>
                  <div>
                     <p>表空间模式确定表空间的可访问性。</p>
                  </div><a id="CNCPT1102"></a><div class="props_rev_3"><a id="GUID-274AC80E-624C-4B23-A88C-7E73C22C6040" name="GUID-274AC80E-624C-4B23-A88C-7E73C22C6040"></a><h5 id="CNCPT-GUID-274AC80E-624C-4B23-A88C-7E73C22C6040" class="sect5">读/写和只读表空间</h5>
                     <div>
                        <p>每个表空间都处于写入模式，指定是否可以写入。</p>
                        <p>互斥模式如下：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>读/写模式</p>
                              <p>用户可以读写表空间。所有表空间最初都创建为读/写。该<code class="codeph">SYSTEM</code>和<code class="codeph">SYSAUX</code>表空间和临时表空间将被永久读/写，这意味着它们不能只读制作。
                              </p>
                           </li>
                           <li>
                              <p>只读模式</p>
                              <p>禁止对表空间中的数据文件执行写操作。只读表空间可以驻留在只读介质上，例如DVD或WORM驱动器。</p>
                              <p>只读表空间消除了执行数据库的大型静态部分的备份和恢复的需要。只读表空间不会更改，因此不需要重复备份。如果在介质发生故障后恢复数据库，则无需恢复只读表空间。</p>
                           </li>
                        </ul>
                        <div class="infoboxnotealso" id="GUID-274AC80E-624C-4B23-A88C-7E73C22C6040__GUID-88244713-9B1A-4EFE-947B-8717D71744BF">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><a href="../admin/managing-tablespaces.html#ADMIN11379" target="_blank"><span><cite>Oracle数据库管理员指南</cite></span></a> ，了解如何将表空间更改为只读或读/写模式</p>
                              </li>
                              <li>
                                 <p>用于<code class="codeph">ALTER TABLESPACE</code>语法和语义的<a href="../sqlrf/ALTER-TABLESPACE.html#SQLRF53606" target="_blank"><span><cite>Oracle数据库SQL语言参考</cite></span></a></p>
                              </li>
                              <li>
                                 <p>有关恢复的详细信息<a href="../bradv/getting-started-rman.html#BRADV89370" target="_blank"><span><cite>，请参见“Oracle数据库备份和恢复用户指南”</cite></span></a></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div><a id="CNCPT1099"></a><div class="props_rev_3"><a id="GUID-DBE61726-0DE6-4A85-A49B-9F5587234A87" name="GUID-DBE61726-0DE6-4A85-A49B-9F5587234A87"></a><h5 id="CNCPT-GUID-DBE61726-0DE6-4A85-A49B-9F5587234A87" class="sect5">在线和离线表空间</h5>
                     <div>
                        <p>每当数据库打开时，表空间都可以在线（可访问）或脱机（不可访问）。</p>
                        <p>表空间通常在线，因此用户可以使用其数据。<code class="codeph">SYSTEM</code>表空间和临时表空间不能脱机。
                        </p>
                        <p>表空间可以自动或手动脱机。例如，您可以使表空间脱机以进行维护或备份和恢复。遇到某些错误时，数据库会自动使表空间脱机，因为<a href="glossary.html#GUID-C27AAA54-E60B-49BC-AB04-7B3848EBAFD6"><span class="xrefglossterm">数据库写程序（DBW）</span></a>进程在多次尝试写入数据文件时失败。尝试访问脱机表空间中的表的用户会收到错误。
                        </p>
                        <p>当表空间脱机时，数据库将执行以下操作：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>数据库不允许后续DML语句引用脱机表空间中的对象。除Oracle数据库之外的任何实用程序都无法读取或编辑脱机表空间。</p>
                           </li>
                           <li>
                              <p>具有引用该表空间中的数据的已完成语句的活动事务不会在事务级别受到影响。</p>
                           </li>
                           <li>
                              <p>数据库在<code class="codeph">SYSTEM</code>表空间中的延迟撤销段中保存与已完成语句对应的撤消数据。当表空间联机时，如果需要，数据库会将撤消数据应用于表空间。
                              </p>
                           </li>
                        </ul>
                        <div class="infoboxnotealso" id="GUID-DBE61726-0DE6-4A85-A49B-9F5587234A87__GUID-25520263-EEA9-43CA-8AA7-9EA64819BAC7">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><span class="q">“ <a href="physical-storage-structures.html#GUID-A9ADC3BA-D991-4CA6-A4CA-8953A75AEF9D" title="每个数据文件都是在线（可用）或脱机（不可用）。">在线和离线数据文件</a> ”</span></p>
                              </li>
                              <li>
                                 <p><span class="q">“ <a href="process-architecture.html#GUID-DC9CBDED-3978-450A-9D7A-0A94CE8FF233" title="数据库写程序进程（DBW）将数据库缓冲区的内容写入数据文件。DBW进程将数据库缓冲区高速缓存中的修改缓冲区写入磁盘。">数据库编写器进程（DBW）</a> ”</span></p>
                              </li>
                              <li>
                                 <p><a href="../admin/managing-tablespaces.html#ADMIN12490" target="_blank"><span><cite>Oracle数据库管理员指南</cite></span></a> ，了解如何更改表空间可用性</p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div>
               </div><a id="CNCPT1083"></a><div class="props_rev_3"><a id="GUID-D02B2220-E6F5-40D9-AFB5-BC69BCEF6CD4" name="GUID-D02B2220-E6F5-40D9-AFB5-BC69BCEF6CD4"></a><h4 id="CNCPT-GUID-D02B2220-E6F5-40D9-AFB5-BC69BCEF6CD4" class="sect4">表空间文件大小</h4>
                  <div>
                     <p>表空间是<span class="bold">bigfile表空间</span>或<span class="bold">smallfile表空间</span> 。这些表空间在执行未明确引用数据文件或临时文件的SQL语句方面无法区分。
                     </p>
                     <p>区别如下：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>smallfile表空间可以包含多个数据文件或临时文件，但文件不能像bigfile表空间那样大。这是默认的表空间类型。</p>
                        </li>
                        <li>
                           <p>bigfile表空间包含一个非常大的数据文件或临时文件。这种类型的表空间可以执行以下操作：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>增加数据库的存储容量</p>
                                 <p>数据库中的最大数据文件数量是有限的，因此增加每个数据文件的大小会增加整体存储。</p>
                              </li>
                              <li>
                                 <p>减轻管理许多数据文件和临时文件的负担</p>
                                 <p>Bigfile表空间通过Oracle管理文件和自动存储管理（Oracle ASM）简化了文件管理，无需添加新文件和处理多个文件。</p>
                              </li>
                              <li>
                                 <p>对表空间而不是单个文件执行操作</p>
                                 <p>Bigfile表空间使表空间成为磁盘空间管理，备份和恢复等的主要单元。</p>
                              </li>
                           </ul>
                           <p>仅使用ASSM的本地管理表空间支持Bigfile表空间。但是，即使手动管理段，本地管理的undo和临时表空间也可以是bigfile表空间。</p>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-D02B2220-E6F5-40D9-AFB5-BC69BCEF6CD4__GUID-2988500D-7C02-4A92-8A0D-0A76EE5C7FB6">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="q">“ <a href="concepts-for-database-administrators.html#GUID-DCE361D9-B486-43B4-B4FD-5722A93203F0" title="备份和恢复是保护数据库免受介质故障或用户错误导致的数据丢失所涉及的一组概念，过程和策略。通常，备份和恢复策略的目的是保护数据库免受数据丢失和重建丢失的数据。">备份和恢复</a> ”</span></p>
                           </li>
                           <li>
                              <p><a href="../admin/managing-tablespaces.html#ADMIN01102" target="_blank"><span><cite>Oracle数据库管理员指南</cite></span></a> ，了解如何管理bigfile表空间</p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>