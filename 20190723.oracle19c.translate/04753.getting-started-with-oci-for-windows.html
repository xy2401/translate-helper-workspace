<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="How to get started with OCI for Windows."></meta>
      <meta name="description" content="How to get started with OCI for Windows."></meta>
      <title>OCI for Windows入门</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Programmer&#39;s Guide"></meta>
      <meta property="og:description" content="How to get started with OCI for Windows."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Programmer&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="oracle-call-interface-programmers-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-14T08:46:00-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96204-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="oci-function-server-round-trips.html" title="Previous" type="text/html"></link>
      <link rel="next" href="deprecated-oci-functions.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Oracle Call Interface Programmer&#39;s Guide"></meta>
    <meta name="dcterms.isVersionOf" content="LNOCI"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="oci-function-server-round-trips.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="deprecated-oci-functions.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">程序员指南</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">OCI for Windows入门</li>
            </ol>
            <a id="GUID-AF5B9CF0-EA9A-4786-80AF-1FEF13363C88" name="GUID-AF5B9CF0-EA9A-4786-80AF-1FEF13363C88"></a><a id="LNOCI350"></a>
            
            <h2 id="LNOCI-GUID-AF5B9CF0-EA9A-4786-80AF-1FEF13363C88" class="sect2"><span class="enumeration_chapter">D</span> OCI for Windows入门</h2>
         </header>
         <div class="ind">
            <div>
               <p>如何开始使用OCI for Windows。</p>
               <p>本附录仅介绍适用于Windows 2003，Windows 2000和Windows XP操作系统的OCI功能。不再支持Windows NT。</p>
               <p>本章包含以下主题：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="getting-started-with-oci-for-windows.html#GUID-F164142B-7EC4-401A-8899-B72951129B29" title="OCI for Windows软件包包括链接OCI程序所需的其他库。">Windows的OCI包中包含哪些内容？</a></p>
                  </li>
                  <li>
                     <p><a href="getting-started-with-oci-for-windows.html#GUID-3C452EC3-71F9-46EB-BF67-CC749789B93F" title="OCI包含在默认的Oracle数据库安装中。">适用于Windows的Oracle目录结构</a></p>
                  </li>
                  <li>
                     <p><a href="getting-started-with-oci-for-windows.html#GUID-C3D566D3-42EF-4714-AA55-5FDC7D030E1B" title="安装OCI时复制样本程序文件和相应的项目文件的位置。">适用于Windows的OCI程序示例</a></p>
                  </li>
                  <li>
                     <p><a href="getting-started-with-oci-for-windows.html#GUID-03541A37-66B4-47EA-A6E5-1E7427FBED63" title="编译OCI应用程序时，必须包含相应的OCI头文件。">关于编译Windows的OCI应用程序</a></p>
                  </li>
                  <li>
                     <p><a href="getting-started-with-oci-for-windows.html#GUID-86D08C43-CEF1-4B37-ADE7-8467651C82CA" title="OCI调用在Oracle提供的动态链接库（DLL）中实现。">关于链接OCI应用程序的Windows</a></p>
                  </li>
                  <li>
                     <p><a href="getting-started-with-oci-for-windows.html#GUID-12517773-9169-4015-BF33-53E045ED82E1" title="修改Windows的OCI应用程序需要什么。">关于运行Windows的OCI应用程序</a></p>
                  </li>
                  <li>
                     <p><a href="getting-started-with-oci-for-windows.html#GUID-2129561A-A16C-4ADE-8B73-DBFED7F883D7" title="如何使用Oracle XA库编译和链接OCI程序。该数据库支持使用XA动态注册。在命令提示符处添加环境变量仅影响当前会话。添加注册表变量会影响Windows系统上的所有会话。要为供应商提供的TP监视器添加注册表变量，请执行以下步骤。请参阅分布式TP：XA规范和其他特定的TP监视器和XA信息。">Oracle XA库</a></p>
                  </li>
                  <li>
                     <p><a href="getting-started-with-oci-for-windows.html#GUID-0A924779-3CB5-421E-A02D-628022F92067" title="要利用对象，请对数据库运行对象类型转换程序（OTT）以生成包含C结构的头文件。">关于使用Windows的对象类型转换器</a></p>
                  </li>
               </ul>
            </div><a id="LNOCI18089"></a><div class="props_rev_3"><a id="GUID-F164142B-7EC4-401A-8899-B72951129B29" name="GUID-F164142B-7EC4-401A-8899-B72951129B29"></a><h3 id="LNOCI-GUID-F164142B-7EC4-401A-8899-B72951129B29" class="sect3"><span class="enumeration_section">D.1</span>适用于Windows的OCI包中包含哪些内容？
               </h3>
               <div>
                  <p>OCI for Windows软件包包括链接OCI程序所需的其他库。</p>
                  <p>Oracle Call Interface for Windows软件包包括：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>Oracle调用接口（OCI）</p>
                     </li>
                     <li>
                        <p>必需的支持文件（RSF）</p>
                     </li>
                     <li>
                        <p>Oracle Universal Installer</p>
                     </li>
                     <li>
                        <p>用于编译OCI应用程序的头文件</p>
                     </li>
                     <li>
                        <p>用于链接OCI应用程序的库文件</p>
                     </li>
                     <li>
                        <p>用于演示如何构建OCI应用程序的示例程序</p>
                     </li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-F164142B-7EC4-401A-8899-B72951129B29__GUID-5AE5532F-9A60-4F2D-B7FD-8463740227AC">
                     <p class="notep1">也可以看看：</p>
                     <p><a href="instant-client.html#GUID-6895DB45-97AA-4738-9959-BD677D610186" title="Oracle Instant Client提供必要的Oracle数据库客户端文件，以创建和运行OCI，OCCI，ODBC和JDBC OCI应用程序。还提供有用的命令行实用程序，包括SQL * Plus，SQL * Loader和Oracle Data Pump。Oracle Instant Client消除了客户端计算机上对Oracle主目录的需求，从而简化了应用程序的部署。">关于Oracle Instant Client，</a>用于简化OCI安装选项</p>
                  </div>
               </div>
            </div><a id="LNOCI18091"></a><a id="LNOCI18090"></a><div class="props_rev_3"><a id="GUID-3C452EC3-71F9-46EB-BF67-CC749789B93F" name="GUID-3C452EC3-71F9-46EB-BF67-CC749789B93F"></a><h3 id="LNOCI-GUID-3C452EC3-71F9-46EB-BF67-CC749789B93F" class="sect3"><span class="enumeration_section">D.2</span> Windows的Oracle目录结构</h3>
               <div>
                  <p>OCI包含在默认的Oracle数据库安装中。</p>
                  <div class="section">
                     <p>安装Oracle数据库时，Oracle Universal Installer会在<span class="italic"><code class="codeph">ORACLE_BASE\ORACLE_HOME</code></span>目录下的<code class="codeph">oci</code> ， <code class="codeph">bin</code>和<code class="codeph">precomp</code>目录中创建OCI文件。这些文件包括链接和运行OCI应用程序所需的库文件，以及与其他Oracle for Microsoft Windows产品（如Oracle Forms）的链接。
                     </p>
                     <p><span class="italic"><code class="codeph">ORACLE_BASE\ORACLE_HOME</code></span>目录包含<a href="getting-started-with-oci-for-windows.html#GUID-3C452EC3-71F9-46EB-BF67-CC749789B93F__CACCBCBJ" title="该表有2列。第1列是目录名，第2列描述其内容。">表D-1</a>中描述的与OCI相关的以下目录。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="tblformal" id="GUID-3C452EC3-71F9-46EB-BF67-CC749789B93F__CACCBCBJ">
                     <p class="titleintable">表D-1 ORACLE_HOME目录和内容</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="ORACLE_HOME目录和内容" width="100%" border="1" summary="This table has 2 columns. Column 1 is the directory name and column 2 describes its contents." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="38%" id="d382314e697">目录名称</th>
                              <th align="left" valign="bottom" width="62%" id="d382314e700">内容</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="38%" id="d382314e705" headers="d382314e697 ">
                                 <p><code class="codeph">\ BIN</code></p>
                              </td>
                              <td align="left" valign="top" width="62%" headers="d382314e705 d382314e700 ">
                                 <p>可执行文件和帮助文件</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="38%" id="d382314e713" headers="d382314e697 ">
                                 <p><code class="codeph">\ OCI</code></p>
                              </td>
                              <td align="left" valign="top" width="62%" headers="d382314e713 d382314e700 ">
                                 <p>用于Windows文件的Oracle Call Interface目录</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="38%" id="d382314e721" headers="d382314e697 ">
                                 <p><code class="codeph">\ OCI \包括</code></p>
                              </td>
                              <td align="left" valign="top" width="62%" headers="d382314e721 d382314e700 ">
                                 <p>头文件，例如<code class="codeph">oci.h</code>和<code class="codeph">ociap.h</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="38%" id="d382314e734" headers="d382314e697 ">
                                 <p><code class="codeph">\ OCI \样本</code></p>
                              </td>
                              <td align="left" valign="top" width="62%" headers="d382314e734 d382314e700 ">
                                 <p>示例程序</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="38%" id="d382314e742" headers="d382314e697 ">
                                 <p><code class="codeph">\预补偿\ ADMIN \ ottcfg.cfg</code></p>
                              </td>
                              <td align="left" valign="top" width="62%" headers="d382314e742 d382314e700 ">
                                 <p>对象类型转换器实用程序和默认配置文件</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
               </div>
            </div><a id="LNOCI18092"></a><div class="props_rev_3"><a id="GUID-C3D566D3-42EF-4714-AA55-5FDC7D030E1B" name="GUID-C3D566D3-42EF-4714-AA55-5FDC7D030E1B"></a><h3 id="LNOCI-GUID-C3D566D3-42EF-4714-AA55-5FDC7D030E1B" class="sect3"><span class="enumeration_section">D.3</span> Windows的OCI程序示例</h3>
               <div>
                  <p>安装OCI时复制样本程序文件和相应的项目文件的位置。</p>
                  <p>安装OCI时，会将一组示例程序及其相应的项目文件复制到<span class="italic"><code class="codeph">ORACLE_BASE\ORACLE_HOME</code></span> <code class="codeph">\oci\samples</code>子目录中。Oracle建议您构建并运行这些示例程序，以验证是否已成功安装OCI，并熟悉开发OCI应用程序所涉及的步骤。
                  </p>
                  <p>要构建示例，请在命令提示符处运行批处理文件<code class="codeph">(make.bat)</code> 。例如，要构建<code class="codeph">cdemo1.c</code>示例，请在目录<code class="codeph">samples</code>输入以下命令：</p><pre class="oac_no_warn" dir="ltr">C：&gt;制作cdemo1</pre><p>使用完这些示例程序后，可以选择删除它们。</p>
                  <p>应使用<code class="codeph">ociucb.bat</code>编译<code class="codeph">ociucb.c</code>程序。此批处理文件创建DLL并将其放在<span class="italic"><code class="codeph">ORACLE_BASE\ORACLE_HOME</code></span> <code class="codeph">\bin</code>目录中。要加载用户回调函数，请将环境注册表变量<code class="codeph">ORA_OCI_UCBPKG</code>为<code class="codeph">OCIUCB</code> 。</p>
               </div>
            </div><a id="LNOCI18093"></a><div class="props_rev_3"><a id="GUID-03541A37-66B4-47EA-A6E5-1E7427FBED63" name="GUID-03541A37-66B4-47EA-A6E5-1E7427FBED63"></a><h3 id="LNOCI-GUID-03541A37-66B4-47EA-A6E5-1E7427FBED63" class="sect3"><span class="enumeration_section">D.4</span>关于编译Windows的OCI应用程序</h3>
               <div>
                  <p>编译OCI应用程序时，必须包含相应的OCI头文件。</p>
                  <p>头文件位于<span class="italic"><code class="codeph">\ORACLE_BASE\ORACLE_HOME</code></span> <code class="codeph">\oci\include</code>目录中。
                  </p>
                  <p>对于Microsoft Visual C ++，请在“选项”对话框的“库”部分中指定<span class="italic"><code class="codeph">\ORACLE_BASE\ORACLE_HOME\oci\lib\msvc</code></span> 。对于Borland编译器，请指定<span class="italic"><code class="codeph">\ORACLE_BASE\ORACLE_HOME\oci\lib\bc</code></span> 。
                  </p>
                  <p>例如，如果您使用的是Microsoft Visual C ++ 8.0，则必须在“工具”菜单的“选项”对话框的“目录”页面中放入相应的路径<code class="codeph">\oracle\db_1\oci\include</code> 。
                  </p>
                  <div class="infoboxnote" id="GUID-03541A37-66B4-47EA-A6E5-1E7427FBED63__GUID-5F2D08C8-AF49-4F67-B71E-6E6E976BEFD9">
                     <p class="notep1">注意：</p>
                     <p>当前OCI版本支持的唯一Microsoft Visual C ++版本是7.1或更高版本。</p>
                  </div>
                  <div class="infoboxnotealso" id="GUID-03541A37-66B4-47EA-A6E5-1E7427FBED63__GUID-C71A57B4-D12A-40DE-8E93-B80EA2D9C506">
                     <p class="notep1">也可以看看：</p>
                     <p>编译器的文档，提供有关编译应用程序和特殊编译器选项的特定信息</p>
                  </div>
               </div>
            </div><a id="LNOCI18094"></a><div class="props_rev_3"><a id="GUID-86D08C43-CEF1-4B37-ADE7-8467651C82CA" name="GUID-86D08C43-CEF1-4B37-ADE7-8467651C82CA"></a><h3 id="LNOCI-GUID-86D08C43-CEF1-4B37-ADE7-8467651C82CA" class="sect3"><span class="enumeration_section">D.5</span>关于链接OCI应用程序的Windows</h3>
               <div>
                  <p>OCI调用在Oracle提供的动态链接库（DLL）中实现。</p>
                  <p>这些DLL位于<span class="italic"><code class="codeph">ORACLE_BASE\ORACLE_HOME</code></span> <code class="codeph">\bin</code>目录中，是必需支持文件（RSF）的一部分。
                  </p>
                  <p>Oracle仅提供<code class="codeph">oci.lib</code>导入库以与Microsoft编译器一起使用。Oracle还支持Borland编译器与OCI一起使用。 Oracle建议应用程序必须始终与<code class="codeph">oci.lib</code>链接，以避免每次发布时重新链接或编译。
                  </p>
                  <p>在Microsoft编译器中使用<code class="codeph">oci.lib</code>时，您不必指示任何特殊链接选项。
                  </p>
                  <div class="p">本节包括以下主题：<ul style="list-style-type:disc">
                        <li>
                           <p><a href="getting-started-with-oci-for-windows.html#GUID-DCA9FAD0-0C02-4613-8ABF-80A438AE8F59" title="为什么需要与oci.lib链接的应用程序。">oci.lib</a></p>
                        </li>
                        <li>
                           <p><a href="getting-started-with-oci-for-windows.html#GUID-30B4694A-586E-497A-A2A7-13FBFF4CCDBB" title="使用LoadLibrary时如何搜索目录。">使用Load Library时加载客户端DLL（）</a></p>
                        </li>
                     </ul>
                  </div>
               </div><a id="LNOCI18095"></a><div class="props_rev_3"><a id="GUID-DCA9FAD0-0C02-4613-8ABF-80A438AE8F59" name="GUID-DCA9FAD0-0C02-4613-8ABF-80A438AE8F59"></a><h4 id="LNOCI-GUID-DCA9FAD0-0C02-4613-8ABF-80A438AE8F59" class="sect4"><span class="enumeration_section">D.5.1</span> oci.lib</h4>
                  <div>
                     <p>为什么需要与oci.lib链接的应用程序。</p>
                     <p>Oracle建议将应用程序与<code class="codeph">oci.lib</code>链接，后者负责加载正确版本的Oracle DLL。
                     </p>
                  </div>
               </div><a id="LNOCI18096"></a><div class="props_rev_3"><a id="GUID-30B4694A-586E-497A-A2A7-13FBFF4CCDBB" name="GUID-30B4694A-586E-497A-A2A7-13FBFF4CCDBB"></a><h4 id="LNOCI-GUID-30B4694A-586E-497A-A2A7-13FBFF4CCDBB" class="sect4"><span class="enumeration_section">D.5.2</span>使用Load Library时加载客户端DLL（）</h4>
                  <div>
                     <p>使用LoadLibrary时如何搜索目录。</p>
                     <p>对于客户端DLL加载， <code class="codeph">LoadLibrary()</code>函数按此顺序搜索以下目录：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>加载应用程序的目录或<code class="codeph">oci.dll</code>所在的目录</p>
                        </li>
                        <li>
                           <p>当前目录</p>
                        </li>
                        <li>
                           <p>视窗：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>32位Windows系统目录<code class="codeph">(system32)</code> 。使用Windows API的<code class="codeph">GetWindowsDirectory()</code>函数获取此目录的路径。
                                 </p>
                              </li>
                              <li>
                                 <p>16位Windows目录<code class="codeph">(system)</code> 。没有Win32函数可以获取此目录的路径，但会搜索它。
                                 </p>
                              </li>
                           </ul>
                        </li>
                        <li>
                           <p><code class="codeph">PATH</code>环境变量中列出的目录</p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div><a id="LNOCI18097"></a><div class="props_rev_3"><a id="GUID-12517773-9169-4015-BF33-53E045ED82E1" name="GUID-12517773-9169-4015-BF33-53E045ED82E1"></a><h3 id="LNOCI-GUID-12517773-9169-4015-BF33-53E045ED82E1" class="sect3"><span class="enumeration_section">D.6</span>关于运行Windows的OCI应用程序</h3>
               <div>
                  <p>修改Windows的OCI应用程序需要什么。</p>
                  <p>要运行OCI应用程序，请确保在运行OCI应用程序的计算机上安装了相应的一组必需支持文件（RSF）。</p>
               </div>
            </div><a id="LNOCI18099"></a><a id="LNOCI18098"></a><div class="props_rev_3"><a id="GUID-2129561A-A16C-4ADE-8B73-DBFED7F883D7" name="GUID-2129561A-A16C-4ADE-8B73-DBFED7F883D7"></a><h3 id="LNOCI-GUID-2129561A-A16C-4ADE-8B73-DBFED7F883D7" class="sect3"><span class="enumeration_section">D.7</span> Oracle XA库</h3>
               <div>
                  <p>XA应用程序编程接口（API）通常用于使Oracle数据库与事务处理（TP）监视器交互，例如：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>Oracle Tuxedo</p>
                     </li>
                     <li>
                        <p>IBM Transarc Encina</p>
                     </li>
                     <li>
                        <p>IBM CICS</p>
                     </li>
                  </ul>
                  <p>您还可以在客户端程序中使用TP监视器语句。OCI支持使用XA API。</p>
                  <p>Oracle XA库作为Oracle数据库企业版的一部分自动安装。<a href="getting-started-with-oci-for-windows.html#GUID-2129561A-A16C-4ADE-8B73-DBFED7F883D7__G638606" title="该表有2列。第1列是组件名称，第2列描述其目录位置。">表D-2</a>列出了Oracle主目录中创建的组件。<code class="codeph">oci.lib</code>导入库包含XA导出。
                  </p>
                  <div class="tblformal" id="GUID-2129561A-A16C-4ADE-8B73-DBFED7F883D7__G638606">
                     <p class="titleintable">表D-2 Oracle XA组件</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="Oracle XA组件" width="100%" border="1" summary="This table has 2 columns. Column 1 is the component name and column 2 describes its directory location." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="31%" id="d382314e2334">零件</th>
                              <th align="left" valign="bottom" width="69%" id="d382314e2337">地点</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d382314e2342" headers="d382314e2334 ">
                                 <p><code class="codeph">xa.h</code></p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d382314e2342 d382314e2337 ">
                                 <p><span class="italic"><code class="codeph">ORACLE_BASE\ORACLE_HOME</code></span> <code class="codeph">\oci\include</code></p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="p">本节包括以下主题：<ul style="list-style-type:disc">
                        <li>
                           <p><a href="getting-started-with-oci-for-windows.html#GUID-405A09FB-4462-427A-9668-F109A16183F2" title="如何使用Oracle XA库编译和链接OCI程序。">关于编译和链接OCI程序与Oracle XA库</a></p>
                        </li>
                        <li>
                           <p><a href="getting-started-with-oci-for-windows.html#GUID-1DCFA8A1-8914-4E39-927D-B94C7B3D2B66" title="该数据库支持使用XA动态注册。">关于使用XA动态注册</a></p>
                        </li>
                        <li>
                           <p><a href="getting-started-with-oci-for-windows.html#GUID-263CE42C-7EEE-47E1-8A98-D594FA777CC3" title="请参阅分布式TP：XA规范和其他特定的TP监视器和XA信息。">XA和TP监视器信息</a></p>
                        </li>
                     </ul>
                  </div>
               </div><a id="LNOCI18101"></a><a id="LNOCI18100"></a><div class="props_rev_3"><a id="GUID-405A09FB-4462-427A-9668-F109A16183F2" name="GUID-405A09FB-4462-427A-9668-F109A16183F2"></a><h4 id="LNOCI-GUID-405A09FB-4462-427A-9668-F109A16183F2" class="sect4"><span class="enumeration_section">D.7.1</span>关于编译和链接OCI程序与Oracle XA库</h4>
                  <div>
                     <p>如何使用Oracle XA库编译和链接OCI程序。</p>
                     <p>要使用Oracle XA库编译和链接OCI程序：</p>
                     <ol>
                        <li>
                           <p>使用Microsoft Visual C ++或Borland编译器编译<span class="italic"><code class="codeph">program</code></span> <code class="codeph">.c</code> ，确保包含<span class="italic"> </span>您路径中的<span class="italic"><code class="codeph">ORACLE_BASE\ORACLE_HOME</code></span> <code class="codeph">\rdbms\xa</code> 。
                           </p>
                        </li>
                        <li>
                           <p>链接<span class="italic"><code class="codeph">program</code></span> <code class="codeph">.obj</code>与<a href="getting-started-with-oci-for-windows.html#GUID-405A09FB-4462-427A-9668-F109A16183F2__G638765" title="该表有2列。第1列是库名，第2列描述其目录位置。">表D-3中</a>显示的库：</p>
                           <div class="tblformal" id="GUID-405A09FB-4462-427A-9668-F109A16183F2__G638765">
                              <p class="titleintable">表D-3链接库</p>
                              <table cellpadding="4" cellspacing="0" class="Formal" title="链接库" width="90%" border="1" summary="This table has 2 columns. Column 1 is the library name and column 2 describes its directory location." frame="hsides" rules="rows">
                                 <thead>
                                    <tr align="left" valign="top">
                                       <th align="left" valign="bottom" width="26%" id="d382314e2632">图书馆</th>
                                       <th align="left" valign="bottom" width="74%" id="d382314e2635">地点</th>
                                    </tr>
                                 </thead>
                                 <tbody>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="26%" id="d382314e2640" headers="d382314e2632 ">
                                          <p><code class="codeph">oraxa12.lib</code></p>
                                       </td>
                                       <td align="left" valign="top" width="74%" headers="d382314e2640 d382314e2635 ">
                                          <p><span class="italic"><code class="codeph">ORACLE_BASE\ORACLE_HOME</code></span> <code class="codeph">\rdbms\xa</code></p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="26%" id="d382314e2652" headers="d382314e2632 ">
                                          <p><code class="codeph">oci.lib</code></p>
                                       </td>
                                       <td align="left" valign="top" width="74%" headers="d382314e2652 d382314e2635 ">
                                          <p><span class="italic"><code class="codeph">ORACLE_BASE\ORACLE_HOME</code></span> <code class="codeph">\oci\lib\msvc</code>或，</p>
                                          <p><span class="italic"><code class="codeph">ORACLE_BASE\ORACLE_HOME</code></span> <code class="codeph">\oci\lib\bc</code></p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <!-- class="inftblhruleinformal" -->
                        </li>
                        <li>
                           <p>运行<span class="italic"><code class="codeph">program</code></span> <code class="codeph">.exe</code> 。
                           </p>
                        </li>
                     </ol>
                  </div>
               </div><a id="LNOCI18102"></a><div class="props_rev_3"><a id="GUID-1DCFA8A1-8914-4E39-927D-B94C7B3D2B66" name="GUID-1DCFA8A1-8914-4E39-927D-B94C7B3D2B66"></a><h4 id="LNOCI-GUID-1DCFA8A1-8914-4E39-927D-B94C7B3D2B66" class="sect4"><span class="enumeration_section">D.7.2</span>关于使用XA动态注册</h4>
                  <div>
                     <p>该数据库支持使用XA动态注册。</p>
                     <p>XA动态注册可提高与符合XA标准的TP监视器交互的应用程序的性能。要使TP监视器在Windows上与Oracle数据库一起使用XA动态注册，必须将环境变量或注册表变量添加到运行TP监视器的Windows系统。有关说明，请参阅以下任一部分：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="getting-started-with-oci-for-windows.html#GUID-B04319F8-42AA-48E1-B278-9613B4C1B1C0" title="在命令提示符处添加环境变量仅影响当前会话。">为当前会话添加环境变量</a></p>
                        </li>
                        <li>
                           <p><a href="getting-started-with-oci-for-windows.html#GUID-BD88BD8D-EB33-49D5-A200-1D4CB832F843" title="添加注册表变量会影响Windows系统上的所有会话。">关于为所有会话添加注册表变量</a></p>
                        </li>
                        <li>
                           <p><a href="getting-started-with-oci-for-windows.html#GUID-CA646563-041A-4CDC-99F8-D271F9D1D354" title="要为供应商提供的TP监视器添加注册表变量，请执行以下步骤。">添加注册表变量：</a></p>
                        </li>
                     </ul>
                  </div><a id="LNOCI18104"></a><a id="LNOCI18103"></a><div class="props_rev_2"><a id="GUID-B04319F8-42AA-48E1-B278-9613B4C1B1C0" name="GUID-B04319F8-42AA-48E1-B278-9613B4C1B1C0"></a><h5 id="LNOCI-GUID-B04319F8-42AA-48E1-B278-9613B4C1B1C0" class="sect5"><span class="enumeration_section">D.7.2.1</span>为当前会话添加环境变量</h5>
                     <div>
                        <p>在命令提示符处添加环境变量仅影响当前会话。</p>
                        <div class="section">
                           <p class="subhead3" id="GUID-B04319F8-42AA-48E1-B278-9613B4C1B1C0__GUID-2C8A7BDB-A72F-465D-9787-AE32BC29C61E">添加环境变量：</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>从安装了TP监视器的计算机上，在命令提示符处输入以下内容：</p><pre class="oac_no_warn" dir="ltr">C：\&gt;设置ORA_XA_REG_DLL = <span class="italic">vendor</span> .dll</pre><p>在此示例中， <span class="italic"><code class="codeph">vendor</code></span> <code class="codeph">.dll</code>是<span class="italic"><code class="codeph">vendor</code></span>提供的TP监视器DLL。
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="LNOCI18105"></a><div class="props_rev_3"><a id="GUID-BD88BD8D-EB33-49D5-A200-1D4CB832F843" name="GUID-BD88BD8D-EB33-49D5-A200-1D4CB832F843"></a><h5 id="LNOCI-GUID-BD88BD8D-EB33-49D5-A200-1D4CB832F843" class="sect5"><span class="enumeration_section">D.7.2.2</span>关于为所有会话添加注册表变量</h5>
                     <div>
                        <p>添加注册表变量会影响Windows系统上的所有会话。</p>
                        <p>这对于只运行一个TP监视器的计算机很有用。</p>
                     </div>
                  </div><a id="LNOCI18106"></a><div class="props_rev_3"><a id="GUID-CA646563-041A-4CDC-99F8-D271F9D1D354" name="GUID-CA646563-041A-4CDC-99F8-D271F9D1D354"></a><h5 id="LNOCI-GUID-CA646563-041A-4CDC-99F8-D271F9D1D354" class="sect5"><span class="enumeration_section">D.7.2.3</span>添加注册表变量：</h5>
                     <div>
                        <p>要为供应商提供的TP监视器添加注册表变量，请执行以下步骤。</p>
                        <ol>
                           <li class="stepexpand"><span>转到安装TP监视器的计算机。</span></li>
                           <li class="stepexpand"><span>在命令提示符处输入以下内容：</span><div><pre class="oac_no_warn" dir="ltr">C：\&gt; <a id="d382314e3486" class="indexterm-anchor"></a> REGEDT32</pre><p>出现“注册表编辑器”窗口</p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>转到<code class="codeph">HKEY_LOCAL_MACHINE\SOFTWARE\ORACLE\HOME</code> <span class="italic"><code class="codeph">ID</code></span> 。</span></li>
                           <li class="stepexpand"><span>在“ <span class="bold">编辑”</span>菜单中选择“ <span class="bold">添加值</span> ”。将出现“添加值”对话框。</span></li>
                           <li class="stepexpand"><span>在“ <span class="bold">值名称”</span>文本框中输入<code class="codeph">ORA_XA_REG_DLL</code> 。</span></li>
                           <li class="stepexpand"><span>从<span class="bold">数据类型</span>列表中选择<code class="codeph">REG_EXPAND_SZ</code> 。</span></li>
                           <li class="stepexpand"><span>单击<span class="bold">确定</span> 。出现“ <span>字符串编辑器”</span>对话框。</span></li>
                           <li class="stepexpand"><span>在<span class="bold">String</span>字段中输入<span class="italic"><code class="codeph">vendor</code></span> <code class="codeph">.dll</code> ，其中<span class="italic"><code class="codeph">vendor</code></span> <code class="codeph">.dll</code>是<span class="italic"><code class="codeph">vendor</code></span>提供的TP监视器DLL。</span></li>
                           <li class="stepexpand"><span>单击<span class="bold">确定</span> 。注册表编辑器添加参数。</span></li>
                           <li class="stepexpand"><span>从<span class="bold">注册表</span>菜单中选择<span class="bold">退出</span> 。</span><div>
                                 <p>注册表退出。</p>
                              </div>
                           </li>
                        </ol>
                     </div>
                  </div>
               </div><a id="LNOCI18107"></a><div class="props_rev_3"><a id="GUID-263CE42C-7EEE-47E1-8A98-D594FA777CC3" name="GUID-263CE42C-7EEE-47E1-8A98-D594FA777CC3"></a><h4 id="LNOCI-GUID-263CE42C-7EEE-47E1-8A98-D594FA777CC3" class="sect4"><span class="enumeration_section">D.7.3</span> XA和TP监视器信息</h4>
                  <div>
                     <p>请参阅<span class="italic">分布式TP：XA规范</span>和其他特定的TP监视器和XA信息。
                     </p>
                     <p><span class="italic">分布式TP：</span> Open Group在网站上发布<span class="italic">的XA规范</span> （C193）： <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/lnoci&amp;id=xa_specification" target="_blank">分布式TP：XA规范</a></p>
                     <div class="infoboxnotealso" id="GUID-263CE42C-7EEE-47E1-8A98-D594FA777CC3__GUID-42AF5251-E00E-4071-9CCC-48FDFD8E11CD">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="../adfns/xa.html#ADFNS017" target="_blank"><span><cite>Oracle数据库开发指南</cite></span></a> ，关于使用Oracle XA开发应用程序的主题，有关Oracle XA库和使用XA动态注册的更多信息</p>
                           </li>
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/lnoci&amp;id=tuxedo_overview" target="_blank">Oracle Tuxedo</a>获取更多信息</p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div>
            </div><a id="LNOCI18108"></a><div class="props_rev_3"><a id="GUID-0A924779-3CB5-421E-A02D-628022F92067" name="GUID-0A924779-3CB5-421E-A02D-628022F92067"></a><h3 id="LNOCI-GUID-0A924779-3CB5-421E-A02D-628022F92067" class="sect3"><span class="enumeration_section">D.8</span>关于使用Windows的对象类型转换器</h3>
               <div>
                  <p>要利用对象，请对数据库运行对象类型转换程序（OTT）以生成包含C结构的头文件。</p>
                  <p>例如，如果已在数据库中创建<code class="codeph">PERSON</code>类型，则OTT可以生成包含与<code class="codeph">PERSON</code>属性对应的元素的C结构。此外，还会创建一个null指示符结构，表示C结构实例的空信息。
                  </p>
                  <p>intype文件告诉OTT应该翻译哪些对象类型。此文件还控制生成的结构的命名。</p>
                  <div class="infoboxnote" id="GUID-0A924779-3CB5-421E-A02D-628022F92067__GUID-2539EF33-6FFE-4727-A993-340DB62999C1">
                     <p class="notep1">注意：</p>
                     <p>从Oracle Database <span class="italic">10g</span>第1版开始，INTYPE File Assistant不可用。
                     </p>
                  </div>
                  <p>请注意，intype文件中的<code class="codeph">CASE</code>规范（例如<code class="codeph">CASE=LOWER</code> ）仅适用于未通过intype文件中的<code class="codeph">TYPE</code>或<code class="codeph">TRANSLATE</code>语句明确列出的C标识符。在intype文件中为类型名称提供适当的案例非常重要，例如TYPE <code class="codeph">Person</code>和Type <code class="codeph">PeRsOn</code> 。
                  </p>
                  <p>可以从命令行调用Windows上的OTT。也可以在命令行上命名配置文件。对于Windows，配置文件是<code class="codeph">ottcfg.cfg,</code>位于<span class="italic"><code class="codeph">ORACLE_BASE\ORACLE_HOME</code></span> <code class="codeph">\precomp\admin</code> 。
                  </p>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>