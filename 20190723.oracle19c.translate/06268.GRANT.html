<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>GRANT</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Backup and Recovery Reference"></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Backup and Recovery Reference"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="database-backup-and-recovery-reference.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-09T19:31:58-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2003, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96242-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="FLASHBACK-DATABASE.html" title="Previous" type="text/html"></link>
      <link rel="next" href="HOST.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database Backup and Recovery Reference"></meta>
    <meta name="dcterms.isVersionOf" content="RCMRF"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="FLASHBACK-DATABASE.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="HOST.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">备份和恢复参考</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="rman-commands-at-sign-to-quit.html" property="item" typeof="WebPage"><span property="name">RMAN命令：@（at符号）到QUIT</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">GRANT</li>
            </ol>
            <a id="GUID-ECD469D1-DE31-498E-8AE1-E47E52E541B2" name="GUID-ECD469D1-DE31-498E-8AE1-E47E52E541B2"></a><a id="RCMRF90187"></a><a id="RCMRF90188"></a><a id="RCMRF90189"></a><a id="RCMRF90190"></a><a id="RCMRF197"></a>
            
            <h2 id="RCMRF-GUID-ECD469D1-DE31-498E-8AE1-E47E52E541B2" class="sect2"><span class="enumeration_section">2.24</span>授予</h2>
         </header>
         <div class="ind">
            <div>
               <div class="section">
                  <p class="subhead1" id="GUID-ECD469D1-DE31-498E-8AE1-E47E52E541B2__GUID-BC71D472-CBB5-4514-AACE-422FBC1B39DD">目的</p>
                  <p>使用<code class="codeph">GRANT</code>命令将虚拟专用目录模式的权限分配给数据库用户。默认情况下，虚拟目录用户无权访问基本恢复目录。
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-ECD469D1-DE31-498E-8AE1-E47E52E541B2__GUID-C85D549F-746D-4658-9F24-34EB274706DB">先决条件</p>
                  <p>在RMAN提示符下执行此命令。</p>
                  <p>必须先使用<code class="codeph"><a href="CREATE-CATALOG.html#GUID-9CFE47C7-2273-48C4-8056-6A4042AF3CDC">CREATE CATALOG</a></code>创建基本恢复目录，然后才能使用<code class="codeph">GRANT</code>为虚拟专用目录分配权限。
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-ECD469D1-DE31-498E-8AE1-E47E52E541B2__GUID-EDFA4224-9E60-472B-A4B0-47D65F7BCF01">使用说明</p>
                  <p>最佳做法是创建一个存储所有数据库元数据的<strong class="term">基本恢复目录</strong> 。然后，您可以创建Oracle数据库用户以拥有虚拟专用目录模式。在Oracle Database 12 <span class="italic">c</span>第1版（12.1.0.1）中，必须为虚拟专用目录用户授予<code class="codeph">RECOVERY_CATALOG_OWNER</code>角色。从Oracle Database 12 <span class="italic">c</span>第1版（12.1.0.2）开始，虚拟专用目录用户只需要<code class="codeph">CREATE SESSION</code>权限。
                  </p>
                  <p>将RMAN连接到基本恢复目录，并使用<code class="codeph">GRANT</code>命令将恢复目录特权分配给虚拟目录所有者。然后，运行<code class="codeph">CREATE VIRTUAL CATALOG</code>为该用户创建虚拟目录模式。您可以使用<code class="codeph"><a href="REVOKE.html#GUID-4F83C820-E3C2-46A2-B954-1EF589A4B9C8">REVOKE</a></code>撤消目录权限。
                  </p>
                  <p><span class="bold">同一数据库上具有CATALOG权限的用户之间的关系</span></p>
                  <p>作为的图示<code class="codeph">GRANT</code>用法，假设数据库<code class="codeph">prod1</code>和<code class="codeph">prod2</code>在基本恢复目录登记。以具有<code class="codeph">SYSBACKUP</code>或<code class="codeph">SYSDBA</code>权限的用户身份登录到基本恢复目录时，您将创建两个虚拟专用目录用户： <code class="codeph">VPC1</code>和<code class="codeph">VPC2</code> 。您授予两个用户<code class="codeph">CATALOG FOR DATABASE</code>访问数据库<code class="codeph">PROD1</code> ，但不<code class="codeph">PROD2</code> 。
                  </p>
                  <p>在此方案中， <code class="codeph">VPC1</code>和<code class="codeph">VPC2</code>都可以访问由基本恢复目录所有者进行的<code class="codeph">PROD1</code>备份的元数据。两个用户还可以访问<code class="codeph">PROD1</code>制作的<code class="codeph">PROD1</code>备份的元数据。<code class="codeph">VPC1</code>和<code class="codeph">VPC2</code>都不能访问数据库<code class="codeph">PROD2</code>备份元数据。
                  </p>
                  <p><span class="bold">授权登记与授权目录的关系</span></p>
                  <p>将<code class="codeph">REGISTER DATABASE</code>授予用户时，RMAN会为此用户注册的任何数据库隐式授予恢复<code class="codeph">CATALOG FOR DATABASE</code>权限。如果仅从用户<code class="codeph"><a href="REVOKE.html#GUID-4F83C820-E3C2-46A2-B954-1EF589A4B9C8">REVOKE</a></code> <code class="codeph">REGISTER DATABASE</code>权限（例如， <code class="codeph">VIRTCAT</code> ），则它不会隐式撤销<code class="codeph">virtcat</code>注册的数据库的<code class="codeph">CATALOG FOR DATABASE</code>权限（例如， <code class="codeph">PROD</code> ）。由于<code class="codeph">CATALOG FOR DATABASE</code>权限包含<code class="codeph">prod</code>注册权限，因此<code class="codeph">virtcat</code>可以继续取消注册并注册<code class="codeph">prod</code> 。为了防止<code class="codeph">VIRTCAT</code>对<code class="codeph">prod</code>执行任何操作，包括重新注册，请从<code class="codeph">VIRTCAT</code> <code class="codeph">REVOKE ALL PRIVILEGES</code> 。</p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-ECD469D1-DE31-498E-8AE1-E47E52E541B2__GUID-01F89488-77D2-4DFB-AF3A-CE02091757BD">句法</p>
                  <p><span class="bold"><span class="italic">grant</span> :: =</span></p>
                  <div class="figure" id="GUID-ECD469D1-DE31-498E-8AE1-E47E52E541B2__GUID-8455AE62-D78A-4AD5-B2EA-594180D253A8"><img src="img/grant.gif" alt="grant.eps的描述如下" title="grant.eps的描述如下" longdesc="img_text/grant.html"><br><a href="img_text/grant.html">说明grant.eps的说明</a></div>
                  <!-- class="figure" -->
                  <p><span class="bold"><span class="italic">privoptdb</span> :: =</span></p>
                  <div class="figure" id="GUID-ECD469D1-DE31-498E-8AE1-E47E52E541B2__GUID-F0C9DCE5-37CF-4D58-98D3-FE1FF8E3226F"><img src="img/privoptdb.gif" alt="下面是privoptdb.eps的描述" title="下面是privoptdb.eps的描述" longdesc="img_text/privoptdb.html"><br><a href="img_text/privoptdb.html">说明privoptdb.eps的说明</a></div>
                  <!-- class="figure" -->
                  <p><span class="bold"><span class="italic">privoptpdb</span> ::  -</span></p>
                  <div class="figure" id="GUID-ECD469D1-DE31-498E-8AE1-E47E52E541B2__GUID-32C65041-4335-4118-808F-1C7DB83A74FB"><img src="img/privoptpdb.gif" alt="下面介绍privoptpdb.eps" title="下面介绍privoptpdb.eps" longdesc="img_text/privoptpdb.html"><br><a href="img_text/privoptpdb.html">说明privoptpdb.eps的说明</a></div>
                  <!-- class="figure" -->
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-ECD469D1-DE31-498E-8AE1-E47E52E541B2__GUID-1F54C04C-D318-4CD8-9DA4-0579DAC87FB8">语义</p>
                  <div class="tblformalwide" id="GUID-ECD469D1-DE31-498E-8AE1-E47E52E541B2__GUID-E7C4F36A-EEFB-41A5-9D63-84D94D095AF3">
                     <table cellpadding="4" cellspacing="0" class="FormalWide" title="" width="100%" border="1" summary="Describes GRANT command parameters" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="29%" id="d54375e306">语法元素</th>
                              <th align="left" valign="bottom" width="71%" id="d54375e309">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d54375e314" headers="d54375e306 "><span class="italic"><code class="codeph">database_name</code></span> <code class="codeph">CATALOG FOR DATABASE</code> <code class="codeph">[</code> <span class="italic"><code class="codeph">database_name</code></span> <code class="codeph">|</code> <span class="italic"><code class="codeph">integer</code></span> <code class="codeph">]</code> <code class="codeph">TO</code> <span class="italic"><code class="codeph">userid</code></span></td>
                              <td align="left" valign="top" width="71%" headers="d54375e314 d54375e309 ">
                                 <p>将指定数据库的恢复目录访问权限授予指定用户。</p>
                                 <p><span class="bold">注意：</span>在指定数据库上授予的目录操作包括注册和取消注册此数据库。
                                 </p>
                                 <p>通过数据库名称或DBID指定数据库。如果在目录中注册了具有此名称的多个数据库时指定了名称，则RMAN将返回错误。在这种情况下，请按DBID指定数据库。</p>
                                 <p>要授予对恢复目录中注册的数据库的访问权限，必须使用<code class="codeph">GRANT CATALOG</code>命令。您还可以为尚未在目录中注册的目标数据库授予访问权限，从而使虚拟专用目录用户能够注册数据库。您必须使用尚未注册的数据库的DBID授予访问权限。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d54375e352" headers="d54375e306 "><code class="codeph">CATALOG FOR PLUGGABLE DATABASE</code> <code class="codeph">[</code> <span class="italic"><code class="codeph">database_name</code></span> <code class="codeph">| GUID</code> <span class="italic"><code class="codeph">guid_name</code></span> <code class="codeph">]</code> <code class="codeph">TO</code> <span class="italic"><code class="codeph">userid</code></span></td>
                              <td align="left" valign="top" width="71%" headers="d54375e352 d54375e309 ">
                                 <p></p>
                                 <p>将指定可插拔数据库（PDB）的恢复目录访问权限授予指定用户。</p>
                                 <p>使用PDB名称或PDB GUID指定PDB。如果在恢复目录中注册了具有此名称的多个PDB时指定了PDB名称，则RMAN将返回错误。在这种情况下，请指定PDB的GUID。</p>
                                 <p><span class="bold">注意：</span>在指定数据库上授予的目录操作包括注册和取消注册此数据库。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d54375e386" headers="d54375e306 "><code class="codeph">REGISTER DATABASE</code> <code class="codeph">TO</code> <span class="italic"><code class="codeph">userid</code></span></td>
                              <td align="left" valign="top" width="71%" headers="d54375e386 d54375e309 ">
                                 <p>授予指定用户使用<code class="codeph"><a href="REGISTER-DATABASE.html#GUID-F52FDFAD-C13E-4076-9589-58FB2ACB0691">REGISTER DATABASE</a></code>注册恢复目录当前未知的数据库的能力。
                                 </p>
                                 <p>将<code class="codeph">REGISTER DATABASE</code>授予用户时，RMAN会为用户注册的任何数据库隐式授予恢复<code class="codeph">CATALOG FOR DATABASE</code>权限。<code class="codeph">CATALOG FOR DATABASE</code>上的<code class="codeph">CATALOG FOR DATABASE</code>权限包括注册和取消注册此数据库。
                                 </p>
                                 <p>例如，假设用户<code class="codeph">virtcat</code>被授予<code class="codeph">REGISTER DATABASE</code>并在目录中注册数据库<code class="codeph">prod</code> 。RMAN隐式授予恢复<code class="codeph">CATALOG FOR DATABASE</code>权限，以便<code class="codeph">prod</code>到<code class="codeph">virtcat</code> 。
                                 </p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-ECD469D1-DE31-498E-8AE1-E47E52E541B2__GUID-B82B2EA5-2135-4D6D-9A22-E195C4F04B95">例子</p>
               </div>
               <!-- class="section" -->
               <div class="example" id="GUID-ECD469D1-DE31-498E-8AE1-E47E52E541B2__GUID-C87CA2A8-93C8-47A7-9708-E2B0156C786D">
                  <p class="titleinexample">示例2-102授予虚拟专用目录的权限</p>
                  <p>假设数据库用户<code class="codeph">RCO</code>拥有数据库<code class="codeph">CATDB</code>的基本恢复目录。此基本恢复目录存储数据中心中大量数据库的RMAN元数据。您的目标是为数据中心的两个备份操作员创建虚拟专用目录。数据库版本是Oracle Database 12 <span class="italic">c</span>第1版（12.1.0.2）。
                  </p>
                  <p>您启动SQL * Plus并以<code class="codeph">SYS</code>身份连接到<code class="codeph">CATDB</code>数据库。然后使用<code class="codeph">CREATE USER</code>语句创建<code class="codeph">BCKOP2</code>和<code class="codeph">BCKOP3</code>用户对<code class="codeph">CATDB</code> 。您可以为这些用户授予<code class="codeph">CREATE SESSION</code>权限，如下所示：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; GRANT创建会话到bckop2，bckop3; SQL&gt; EXIT</pre><p>然后启动RMAN客户端并以用户<code class="codeph">RCO</code>身份连接到恢复目录数据库。您可以使用RMAN <code class="codeph">GRANT</code>命令为<code class="codeph">BCKOP2</code>提供在其虚拟专用目录中注册任何数据库的功能，但只允许<code class="codeph">BCKOP3</code>访问数据中心中的一部分数据库：</p><pre class="oac_no_warn" dir="ltr">RMAN&gt; CONNECT CATALOG rco @ catdb恢复目录数据库密码： <span class="italic">密码</span>连接到恢复目录数据库RMAN&gt; GRANT REGISTER DATABASE to bckop2; RMAN&gt;数据库的GRANT CATALOG prod to bckop3; RMAN&gt;数据库的GRANT CATALOG prodb to bckop3; RMAN&gt;退出;</pre><p>您启动一个新的RMAN会话并以用户<code class="codeph">BCKOP2</code>连接。首次连接时，RMAN会自动创建虚拟专用目录。创建每个虚拟目录后，必须退出并重新启动RMAN。
                  </p><pre class="oac_no_warn" dir="ltr">RMAN&gt; CONNECT CATALOG bckop2 @ catdb恢复目录数据库密码：连接到恢复目录数据库的<span class="italic">密码</span> RMAN&gt; EXIT;</pre><p>您启动一个新的RMAN会话并以用户<code class="codeph">BCKOP3</code>身份连接以创建与此用户关联的虚拟专用目录：</p><pre class="oac_no_warn" dir="ltr">RMAN&gt; CONNECT CATALOG bckop3 @ catdb恢复目录数据库密码：连接到恢复目录数据库的<span class="italic">密码</span> RMAN&gt; EXIT;</pre><p>在下面的例子中，备份操作员<code class="codeph">DBA1</code>用她的虚拟专用目录，存储在<code class="codeph">BCKOP3</code>上架构<code class="codeph">CATDB</code> ，存储元数据的目标数据库的备份：</p><pre class="oac_no_warn" dir="ltr">RMAN&gt; CONNECT TARGET / RMAN&gt; CONNECT CATALOG bckop3 @ catdb恢复目录数据库密码：连接到恢复目录数据库的<span class="italic">密码</span> RMAN&gt; BACKUP DATABASE PLUS ARCHIVELOG;</pre></div>
               <!-- class="example" -->
               <div class="example" id="GUID-ECD469D1-DE31-498E-8AE1-E47E52E541B2__GUID-3DB6FFA9-6948-4A7F-AEFC-0B225FF9216C">
                  <p class="titleinexample">示例2-103授予PDB权限</p>
                  <p></p>
                  <p>假设数据库<code class="codeph">catdb</code>中的恢复目录所有者是<code class="codeph">rco</code> ，而VPC用户是<code class="codeph">vpc1</code> 。您需要将访问PDB <code class="codeph">mypdb</code>权限授予<code class="codeph">vpc1</code> 。
                  </p>
                  <div class="p">使用以下命令连接到基本恢复目录<code class="codeph">rco</code> ：<pre class="pre codeblock"><code>RMAN&gt; CONNECT CATALOG rco @ catdb恢复目录数据库密码：连接到恢复目录数据库的<span class="italic">密码</span></code></pre></div>
                  <p>使用以下命令将PDB <code class="codeph">mypdb</code>的访问元数据的权限授予VPC用户<code class="codeph">vpc1</code> ：</p><pre class="pre codeblock"><code>RMAN&gt;用于可插入数据库的GRANT CATALOG mypdb to vpc1;</code></pre></div>
               <!-- class="example" -->
            </div>
         </div>
      </article>
   </body>
</html>