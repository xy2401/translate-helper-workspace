<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="You can use Database Replay to capture a workload on the production system and replay it on a test system with the exact timing, concurrency, and transaction characteristics of the original workload. This enables you to test the effects of a system change without affecting the production system."></meta>
      <meta name="description" content="You can use Database Replay to capture a workload on the production system and replay it on a test system with the exact timing, concurrency, and transaction characteristics of the original workload. This enables you to test the effects of a system change without affecting the production system."></meta>
      <title>数据库重放简介</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Testing Guide "></meta>
      <meta property="og:description" content="You can use Database Replay to capture a workload on the production system and replay it on a test system with the exact timing, concurrency, and transaction characteristics of the original workload. This enables you to test the effects of a system change without affecting the production system."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Testing Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="testing-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-07T01:43:11-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2008, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96279-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="database-replay.html" title="Previous" type="text/html"></link>
      <link rel="next" href="capturing-a-database-workload.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Testing Guide"></meta>
    <meta name="dcterms.isVersionOf" content="RATUG"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="database-replay.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="capturing-a-database-workload.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">测试指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="database-replay.html" property="item" typeof="WebPage"><span property="name">数据库重播</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">数据库重放简介</li>
            </ol>
            <a id="GUID-5AA30327-74FB-4406-8F7C-5D442F307534" name="GUID-5AA30327-74FB-4406-8F7C-5D442F307534"></a><a id="RATUG238"></a><a id="RATUG104"></a>
            
            <h2 id="RATUG-GUID-5AA30327-74FB-4406-8F7C-5D442F307534" class="sect2"><span class="enumeration_chapter">9</span>数据库重放简介</h2>
         </header>
         <div class="ind">
            <div>
               <p>您可以使用数据库重放来捕获生产系统上的工作负载，并使用原始工作负载的准确时间，并发性和事务特征在测试系统上重放它。这使您可以在不影响生产系统的情况下测试系统更改的效果。</p>
               <p>Database Replay支持在运行Oracle数据库<span class="italic">10g</span>第2版及更高版本的系统上捕获工作负载。为了捕获运行Oracle数据库<span class="italic">10g</span>第2版的系统上的工作负载，数据库版本必须为10.2.0.4或更高版本。仅在运行Oracle Database <span class="italic">11g</span>第1版和更新版本的系统上支持工作负载重放。
               </p>
               <div class="infoboxnote" id="GUID-5AA30327-74FB-4406-8F7C-5D442F307534__GUID-7A3C39E9-F46B-408C-9367-C2D7799D68FA">
                  <p class="notep1">注意：</p>
                  <p>要在运行Oracle9 <span class="italic">i</span>数据库或早期版本的Oracle Database 10 <span class="italic">g</span>的系统上使用工作负载捕获功能，请参阅以下URL中的My Oracle Support说明ID 560977.1以获取有关所需修补程序的信息，或者与Oracle支持部门联系以获取更多信息：</p>
                  <p><a href="https://support.oracle.com/rs?type=doc&amp;id=560977.1" target="_blank">https://support.oracle.com/rs?type=doc&amp;id=560977.1</a></p>
               </div>
               <p>用MATLAB分析系统变化的影响<a id="d17171e109" class="indexterm-anchor"></a><a id="d17171e113" class="indexterm-anchor"></a>数据库重放涉及以下步骤， <a href="introduction-to-database-replay.html#GUID-5AA30327-74FB-4406-8F7C-5D442F307534__CCHJBGCE">如图9-1所示</a> ：</p>
               <div class="figure" id="GUID-5AA30327-74FB-4406-8F7C-5D442F307534__CCHJBGCE">
                  <p class="titleinfigure">图9-1数据库重放工作流程</p><img src="img/ratug001.gif" width="497" alt="下面是图9-1的描述" title="下面是图9-1的描述" longdesc="img_text/ratug001.html"><br><a href="img_text/ratug001.html">“图9-1数据库重放工作流”的说明</a></div>
               <!-- class="figure" -->
               <ol>
                  <li>
                     <p>在生产系统上，将工作负载捕获到捕获文件中，如<span class="q">“ <a href="introduction-to-database-replay.html#GUID-36DE5567-5A64-493B-A154-6581C678FC8A" title="使用数据库重放的第一步是捕获生产工作负载。捕获工作负载涉及将外部客户端发出的所有请求记录到Oracle数据库。">Workload Capture</a> ”中所述</span> 。
                     </p>
                  </li>
                  <li>
                     <p>将捕获文件复制到测试系统并对其进行预处理，如<span class="q">“ <a href="introduction-to-database-replay.html#GUID-585D38D1-C63F-420C-B4F1-5AD11A6E3DE1" title="捕获工作负载后，必须预处理捕获文件中的信息。预处理创建重放工作负载所需的所有必要元数据。必须对每个捕获的工作负载执行一次，然后才能重放它们。">工作负载预处理</a> ”中所述</span> 。
                     </p>
                  </li>
                  <li>
                     <p>在测试系统上，重播预处理的文件，如<span class="q">“ <a href="introduction-to-database-replay.html#GUID-6A7A45F0-27B2-41D8-B1DA-1CE39F49AA7C" title="捕获的工作负载经过预处理后，可以在测试系统上重放。">工作负载重播</a> ”中所述</span> 。
                     </p>
                  </li>
                  <li>
                     <p>使用Database Replay生成的报告，对工作负载捕获和工作负载重放进行详细分析，如<span class="q">“ <a href="introduction-to-database-replay.html#GUID-E9DA3C3B-C44D-4DBB-B75C-7F012EDD6514" title="重播工作负载后，将为您提供深入报告，以便对工作负载捕获和重放进行详细分析。">分析和报告</a> ”中所述</span> 。
                     </p>
                  </li>
               </ol>
            </div><a id="RATUG105"></a><div class="props_rev_3"><a id="GUID-36DE5567-5A64-493B-A154-6581C678FC8A" name="GUID-36DE5567-5A64-493B-A154-6581C678FC8A"></a><h3 id="RATUG-GUID-36DE5567-5A64-493B-A154-6581C678FC8A" class="sect3"><span class="enumeration_section">9.1</span>工作负载捕获</h3>
               <div>
                  <p>使用数据库重放的第一步是捕获生产工作负载。捕获工作负载涉及将外部客户端发出的所有请求记录到Oracle数据库。</p>
                  <p>启用工作负载捕获后，将跟踪所有定向到Oracle数据库的外部客户端请求并将其存储在二进制文件中<a id="d17171e254" class="indexterm-anchor"></a>捕获文件 - 在文件系统上。您可以指定捕获文件的存储位置。工作负载捕获开始后，所有外部数据库调用都将写入捕获文件。捕获文件包含有关客户端请求的所有相关信息，例如SQL文本，绑定值和事务信息。不捕获后台活动和数据库调度程序作业。这些捕获文件与平台无关，可以传输到另一个系统。
                  </p>
                  <div class="infoboxnotealso" id="GUID-36DE5567-5A64-493B-A154-6581C678FC8A__GUID-999747EC-64CD-4E0C-AD95-D7A4F92A833A">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="capturing-a-database-workload.html#GUID-E774C161-98C0-43EF-8B78-DD74E2A2A219" title="This chapter describes how to capture a database workload on the production system.">捕获数据库工作负载</a>以获取有关如何捕获生产系统上的<a href="capturing-a-database-workload.html#GUID-E774C161-98C0-43EF-8B78-DD74E2A2A219" title="本章介绍如何在生产系统上捕获数据库工作负载。">工作负载</a>的信息</p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div><a id="RATUG106"></a><div class="props_rev_3"><a id="GUID-585D38D1-C63F-420C-B4F1-5AD11A6E3DE1" name="GUID-585D38D1-C63F-420C-B4F1-5AD11A6E3DE1"></a><h3 id="RATUG-GUID-585D38D1-C63F-420C-B4F1-5AD11A6E3DE1" class="sect3"><span class="enumeration_section">9.2</span>工作负载预处理</h3>
               <div>
                  <div><span>捕获工作负载后，必须预处理捕获文件中的信息。预处理创建重放工作负载所需的所有必要元数据。必须对每个捕获的工作负载执行一次，然后才能重放它们。</span> 捕获的工作负载经过预处理后，可以在运行相同版本的Oracle数据库的重放系统上重复播放。通常，应将捕获文件复制到测试系统进行预处理。由于工作负载预处理可能耗时且资源密集，因此建议在将重放工作负载的测试系统上执行此步骤。
                  </div>
                  <div class="infoboxnotealso" id="GUID-585D38D1-C63F-420C-B4F1-5AD11A6E3DE1__GUID-7685AE30-8994-4DE4-8684-8CC922582B45">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="preprocessing-a-database-workload.html#GUID-4CEE2F79-F5A7-4EBA-9018-0CB99AB51C0A" title="捕获工作负载并完成测试系统的设置后，必须预处理捕获的数据。">预处理数据库工作负载，</a>以获取有关如何预处理捕获的工作负载的信息</p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div><a id="RATUG107"></a><div class="props_rev_3"><a id="GUID-6A7A45F0-27B2-41D8-B1DA-1CE39F49AA7C" name="GUID-6A7A45F0-27B2-41D8-B1DA-1CE39F49AA7C"></a><h3 id="RATUG-GUID-6A7A45F0-27B2-41D8-B1DA-1CE39F49AA7C" class="sect3"><span class="enumeration_section">9.3</span>工作负载重播</h3>
               <div>
                  <div><span>捕获的工作负载经过预处理后，可以在测试系统上重放。</span> 在工作负载重放阶段，Oracle数据库通过使用生产系统的相同时序，并发和事务依赖性重新创建所有捕获的外部客户端请求，在测试系统上执行工作负载捕获阶段记录的操作。
                  </div>
                  <p>Database Replay使用一个名为的客户端程序<a id="d17171e460" class="indexterm-anchor"></a>重播客户端以重新创建工作负载捕获期间记录的所有外部客户端请求。根据捕获的工作负载，您可能需要一个或多个重播客户端才能正确重放工作负载。提供校准工具以帮助确定特定工作负载所需的重放客户端的数量。由于重放了整个工作负载（包括DML和SQL查询），因此重放系统中的数据应尽可能与捕获系统中的数据逻辑相似。这将最大限度地减少重放差异，并实现更可靠的重播分析。
                  </p>
                  <div class="infoboxnotealso" id="GUID-6A7A45F0-27B2-41D8-B1DA-1CE39F49AA7C__GUID-64FC641A-95C9-4897-AA76-57C3F6C200BF">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="replaying-a-database-workload.html#GUID-1F638D8F-7168-492D-BAD6-39F4F36EAD9B" title="After a captured workload is preprocessed, it can be replayed repeatedly on a replay system that is running the same version of Oracle Database.">重播数据库工作负载，</a>以获取有关如何在测试系统上重播预处理工作<a href="replaying-a-database-workload.html#GUID-1F638D8F-7168-492D-BAD6-39F4F36EAD9B" title="在对捕获的工作负载进行预处理后，可以在运行相同版本的Oracle数据库的重放系统上重复执行该工作负载。">负载</a>的信息</p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div><a id="RATUG108"></a><div class="props_rev_3"><a id="GUID-E9DA3C3B-C44D-4DBB-B75C-7F012EDD6514" name="GUID-E9DA3C3B-C44D-4DBB-B75C-7F012EDD6514"></a><h3 id="RATUG-GUID-E9DA3C3B-C44D-4DBB-B75C-7F012EDD6514" class="sect3"><span class="enumeration_section">9.4</span>分析和报告</h3>
               <div>
                  <p>重播工作负载后，将为您提供深入报告，以便对工作负载捕获和重放进行详细分析。</p>
                  <p>工作负载捕获报告和工作负载重放报告提供有关工作负载捕获和重放的基本信息，例如重放期间遇到的错误以及DML或SQL查询返回的行中的数据偏差。还提供了工作负载捕获和工作负载重放之间的若干统计信息（例如数据库时间，平均活动会话和用户调用）的比较。</p>
                  <p>重放比较期间报告可用于执行一次工作负荷重放与其捕获或同一捕获的另一次重放的高级别比较。还提供了一个分歧摘要，分析是否发生任何数据分歧以及是否存在任何重大的性能变化。此外，自动数据库诊断监视器（ADDM）结果也包含在这些报告中。</p>
                  <p>对于高级分析，可以使用自动工作负载存储库（AWR）报告来详细比较工作负载捕获和工作负载重放之间的性能统计信息。这些报告中提供的信息非常详细，可以预期工作负载捕获和重放之间存在一些差异。此外，Workload Intelligence还会对工作负载捕获期间记录的数据进行操作，以创建描述工作负载的模型。此模型可用于标识作为工作负载一部分执行的模板中的重要模式。对于每个模式，您可以查看重要的统计信息，例如给定模式的执行次数以及模式在执行期间消耗的数据库时间。</p>
                  <p>SQL Performance Analyzer报告可用于将工作负载捕获中的SQL调优集与工作负载重放中的另一个SQL调优集或两个工作负载重放中的两个SQL调优集进行比较。将SQL调优集与数据库重放进行比较提供了比SQL性能分析器测试执行更多的信息，因为它考虑并显示了每个SQL语句的所有执行计划，而SQL性能分析器测试执行仅为每个SQL语句为每个SQL语句生成一个执行计划。此外，SQL语句在更真实的环境中执行，因为Database Replay捕获所有绑定值并更准确地再现PL / SQL包状态等动态会话状态。建议您首先运行SQL Performance Analyzer测试执行作为完整性测试，以确保在使用数据库重放执行负载和货币测试之前，SQL语句没有退化并且测试系统已正确设置。</p>
                  <p>除了使用重放差异信息来分析给定系统更改的重放特征外，还应使用应用程序级验证过程来评估系统更改。考虑开发一个脚本来评估重播的整体成功。例如，如果在工作负载捕获期间处理10,000个订单，则应验证在重放期间还处理了类似数量的订单。</p>
                  <p>重播分析完成后，您可以在工作负载捕获时将数据库还原到其原始状态，并重复工作负载重放以测试对系统的其他更改。</p>
                  <div class="infoboxnotealso" id="GUID-E9DA3C3B-C44D-4DBB-B75C-7F012EDD6514__GUID-51E73BCF-AFD8-49AB-BD4B-830AC4F7DDE7">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="analyzing-captured-and-replayed-workloads.html#GUID-3E9AA9F2-B37B-4E03-9E00-FEB0A141631E" title="本章介绍如何使用各种数据库重放报告分析捕获和重放的工作负载。">分析捕获和重放的工作负载，</a>以获取有关如何使用数据库重放报告分析数据和性能差异的信息</p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-B47B8419-A618-4EB5-A402-54157C609AAA" name="GUID-B47B8419-A618-4EB5-A402-54157C609AAA"></a><h3 id="RATUG-GUID-B47B8419-A618-4EB5-A402-54157C609AAA" class="sect3"><span class="enumeration_section">9.5</span> PDB中的工作负载捕获和重放</h3>
               <div>
                  <p>可以启用工作负载捕获，并且可以在可插拔数据库（PDB）级别启动工作负载重放。</p>
                  <p>在Oracle Database Release 19c之前，工作负载捕获和重放严格适用于从CDB root启动捕获和重放的容器数据库（CDB）管理员。从Oracle Database Release 19c开始，可以为当前可插拔数据库（PDB）启用工作负载捕获。还可以为当前PDB启动工作负载重放。</p>
                  <div class="infoboxnote" id="GUID-B47B8419-A618-4EB5-A402-54157C609AAA__GUID-AD7CAA04-7B0A-4B5B-98F1-0A72AF3B62CE">
                     <p class="notep1">注意：</p>
                     <p>PDB级别不支持并发工作负载捕获和重放。</p>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>