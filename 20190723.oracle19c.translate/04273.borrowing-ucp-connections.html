<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>About Borrowing Connections from UCP</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Universal Connection Pool Developer's Guide ">
      <meta property="og:description" content="">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Universal Connection Pool Developer's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="universal-connection-pool-developers-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-02-13T06:57:38-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="1999, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96473-02">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="getting-database-connections.html" title="Previous" type="text/html">
      <link rel="next" href="setting-ucp-properties.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Universal Connection Pool Developer's Guide">
    <meta name="dcterms.isVersionOf" content="JJUCP">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="getting-database-connections.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="setting-ucp-properties.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Universal Connection Pool Developer's Guide </span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="getting-database-connections.html" property="item" typeof="WebPage"><span property="name">Getting Database Connections in UCP</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">About Borrowing Connections from UCP</li>
            </ol>
            <a id="GUID-2AB7C67B-E634-4EBD-9383-7086FD672617" name="GUID-2AB7C67B-E634-4EBD-9383-7086FD672617"></a><a id="JJUCP8128"></a>
            
            <h2 id="JJUCP-GUID-2AB7C67B-E634-4EBD-9383-7086FD672617" class="sect2"><span class="enumeration_section">3.1 </span>About Borrowing Connections from UCP
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>An application borrows connections using a pool-enabled data source. This section describes the following concepts about borrowing connections:</p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p><a href="borrowing-ucp-connections.html#GUID-434C7A5A-C0D9-4CB4-BBBC-CC1B3F27A56D">Overview of Borrowing Connections from UCP</a></p>
                  </li>
                  <li>
                     <p><a href="borrowing-ucp-connections.html#GUID-DC1FB036-E07C-490E-B8EB-A05D5F46909E">Using the Pool-Enabled Data Source</a></p>
                  </li>
                  <li>
                     <p><a href="borrowing-ucp-connections.html#GUID-6EDE4770-D197-4ABA-9A4B-FE1D434BFEDF">Using the Pool-Enabled XA Data Source</a></p>
                  </li>
                  <li>
                     <p><a href="borrowing-ucp-connections.html#GUID-E0DDAD88-925B-4F92-BE07-22D084BA6B3E">Setting Connection Properties</a></p>
                  </li>
                  <li>
                     <p><a href="borrowing-ucp-connections.html#GUID-44F415AE-9B73-4834-9C67-04FE7B4A59DD">Using JNDI to Borrow a Connection</a></p>
                  </li>
                  <li>
                     <p><a href="borrowing-ucp-connections.html#GUID-466F2D15-0811-40F0-8DF3-1F5518F49C82">About Connection Initialization Callback</a></p>
                  </li>
               </ul>
               <div class="infoboxnote" id="GUID-2AB7C67B-E634-4EBD-9383-7086FD672617__GUID-3297B118-1F94-4569-B316-2EE9702A8B23">
                  <p class="notep1">Note:</p>
                  <p>The instructions in this section use a pool-enabled data source to implicitly create and start a connection pool.</p>
               </div>
            </div>
            <div class="props_rev_3"><a id="GUID-434C7A5A-C0D9-4CB4-BBBC-CC1B3F27A56D" name="GUID-434C7A5A-C0D9-4CB4-BBBC-CC1B3F27A56D"></a><h3 id="JJUCP-GUID-434C7A5A-C0D9-4CB4-BBBC-CC1B3F27A56D" class="sect3"><span class="enumeration_section">3.1.1 </span>Overview of Borrowing Connections from UCP
               </h3>
               <div>
                  <p><a id="d2697e102" class="indexterm-anchor"></a><a id="d2697e106" class="indexterm-anchor"></a><a id="d2697e110" class="indexterm-anchor"></a>The UCP API provides two pool-enabled data sources, one for borrowing regular connections and one for borrowing XA connections. These data sources provide access to UCP JDBC connection pool functionality and include a set of <code class="codeph">getConnection</code> methods that are used to borrow connections. The same pool features are included in both XA and non-XA UCP JDBC connection pools.
                  </p>
                  <p>UCP JDBC connection pools maintain both available connections and borrowed connections. A connection is reused from the pool if an application requests to borrow a connection that matches an available connection. A new connection is created if no available connection in the pool match the requested connection. The number of available connections and borrowed connections are subjected to pool properties such as pool size, timeout intervals, and validation rules.</p>
               </div>
            </div><a id="JJUCP8130"></a><a id="JJUCP8131"></a><a id="JJUCP8129"></a><div class="props_rev_3"><a id="GUID-DC1FB036-E07C-490E-B8EB-A05D5F46909E" name="GUID-DC1FB036-E07C-490E-B8EB-A05D5F46909E"></a><h3 id="JJUCP-GUID-DC1FB036-E07C-490E-B8EB-A05D5F46909E" class="sect3"><span class="enumeration_section">3.1.2 </span>Using the Pool-Enabled Data Source
               </h3>
               <div>
                  <div class="section">
                     <p><a id="d2697e159" class="indexterm-anchor"></a><a id="d2697e163" class="indexterm-anchor"></a><a id="d2697e167" class="indexterm-anchor"></a><a id="d2697e169" class="indexterm-anchor"></a><a id="d2697e171" class="indexterm-anchor"></a><a id="d2697e173" class="indexterm-anchor"></a>UCP provides a pool-enabled data source (<code class="codeph">oracle.ucp.jdbc.PoolDataSource</code>) that is used to get connections to a database. The <code class="codeph">oracle.ucp.jdbc.PoolDataSourceFactory</code> factory class provides a <code class="codeph">getPoolDataSource()</code> method that creates the pool-enabled data source instance. For example:
                     </p><pre class="oac_no_warn" dir="ltr">PoolDataSource  pds = PoolDataSourceFactory.getPoolDataSource();
</pre><p><a id="d2697e191" class="indexterm-anchor"></a><a id="d2697e195" class="indexterm-anchor"></a>The pool-enabled data source requires a connection factory class in order to get an actual physical connection. The connection factory is typically provided as part of a JDBC driver and can be a data source itself. A UCP JDBC connection pool can use any JDBC driver to create physical connections that are then maintained by the pool. The <code class="codeph">setConnectionFactoryClassName(String)</code> method is used to define the connection factory for the pool-enabled data source instance. The following example uses Oracle's <code class="codeph">oracle.jdbc.pool.OracleDataSource</code> connection factory class included with the JDBC driver. If you are using a different vendor's JDBC driver, refer to the vendor's documentation for an appropriate connection factory class.
                     </p><pre class="oac_no_warn" dir="ltr">pds.setConnectionFactoryClassName("oracle.jdbc.pool.OracleDataSource");
</pre><p><a id="d2697e207" class="indexterm-anchor"></a><a id="d2697e209" class="indexterm-anchor"></a><a id="d2697e211" class="indexterm-anchor"></a><a id="d2697e213" class="indexterm-anchor"></a><a id="d2697e215" class="indexterm-anchor"></a><a id="d2697e217" class="indexterm-anchor"></a>In addition to the connection factory class, a pool-enabled data source requires the URL, user name, and password that is used to connect to a database. A pool-enabled data source instance includes methods to set each of these properties. The following example uses an Oracle JDBC Thin driver syntax. If you are using a different vendor's JDBC driver, refer to the vendor's documentation for the appropriate URL syntax to use.
                     </p><pre class="oac_no_warn" dir="ltr">pds.setURL("jdbc:oracle:thin:@//localhost:1521/XE");
pds.setUser("<span class="italic">user</span>");
pds.setPassword("<span class="italic">password</span>");
</pre><div class="infoboxnotealso" id="GUID-DC1FB036-E07C-490E-B8EB-A05D5F46909E__GUID-7B18384F-450C-495B-8FFB-8DEFD0EB9048">
                        <p class="notep1">See Also:</p>
                        <p><a href="../jjdbc/JDBC-getting-started.html#JJDBC-GUID-F65BF3C1-FFB3-4513-AEB6-94A0D025AD39" target="_blank"><span><cite>Oracle Database JDBC Developer’s Guide</cite></span></a> for detailed Oracle URL syntax usage.
                        </p>
                     </div>
                     <p><a id="d2697e237" class="indexterm-anchor"></a><a id="d2697e239" class="indexterm-anchor"></a>Lastly, a pool-enabled data source provides a set of <code class="codeph">getConnection</code> methods. The methods include:
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><code class="codeph">getConnection()</code> : Returns a connection that is associated with the user name and password that was used to connect to the database.
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">getConnection(String username, String password)</code>: Returns a connection that is associated with the given user name and password.
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">getConnection(java.util.Properties labels)</code>: Returns a connection that matches a given label.
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">getConnection(String username, String password, java.util.Properties labels)</code> : Returns a connection that is associated with a given user name and password and that matches a given label.
                           </p>
                        </li>
                     </ul>
                     <p>An application uses the <code class="codeph">getConnection</code> methods to borrow a connection handle from the pool that is of the type <code class="codeph">java.sql.Connection</code>. If a connection handle is already in the pool that matches the requested connection (same URL, user name, and password) then it is returned to the application; or else, a new connection is created and a new connection handle is returned to the application. An example for both Oracle and MySQL are provided.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-DC1FB036-E07C-490E-B8EB-A05D5F46909E__GUID-6FFCFE64-1B69-4B99-B261-791A3DE5C45C">Oracle Example</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>The following example demonstrates borrowing a connection when using the JDBC Thin driver:</p><pre class="oac_no_warn" dir="ltr">PoolDataSource  pds = PoolDataSourceFactory.getPoolDataSource();

pds.setConnectionFactoryClassName("oracle.jdbc.pool.OracleDataSource");
pds.setURL("jdbc:oracle:thin:@//localhost:1521/XE");
pds.setUser("<span class="italic">&lt;user&gt;</span>");
pds.setPassword("<span class="italic">&lt;password&gt;</span>");

Connection conn = pds.getConnection();
</pre></div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-DC1FB036-E07C-490E-B8EB-A05D5F46909E__GUID-09F1C33A-66CA-4BB6-8EBC-B7E05FDFAFBB">MySQL Example</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>The following example demonstrates borrowing a connection when using the Connector/J JDBC driver from MySQL:</p><pre class="oac_no_warn" dir="ltr">PoolDataSource  pds = PoolDataSourceFactory.getPoolDataSource();

pds.setConnectionFactoryClassName("com.mysql.jdbc.jdbc2.optional.
   MysqlDataSource");
pds.setURL("jdbc:mysql://<span class="italic">host</span>:3306/dbname");
pds.setUser("<span class="italic">&lt;user&gt;</span>");
pds.setPassword("<span class="italic">&lt;password&gt;</span>");

Connection conn = pds.getConnection();
</pre></div>
                  <!-- class="section" -->
               </div>
            </div><a id="JJUCP8132"></a><div class="props_rev_3"><a id="GUID-6EDE4770-D197-4ABA-9A4B-FE1D434BFEDF" name="GUID-6EDE4770-D197-4ABA-9A4B-FE1D434BFEDF"></a><h3 id="JJUCP-GUID-6EDE4770-D197-4ABA-9A4B-FE1D434BFEDF" class="sect3"><span class="enumeration_section">3.1.3 </span>Using the Pool-Enabled XA Data Source
               </h3>
               <div>
                  <div class="section">
                     <p><a id="d2697e345" class="indexterm-anchor"></a><a id="d2697e349" class="indexterm-anchor"></a><a id="d2697e353" class="indexterm-anchor"></a><a id="d2697e355" class="indexterm-anchor"></a><a id="d2697e357" class="indexterm-anchor"></a><a id="d2697e359" class="indexterm-anchor"></a><a id="d2697e361" class="indexterm-anchor"></a><a id="d2697e365" class="indexterm-anchor"></a>UCP provides a pool-enabled XA data source (<code class="codeph">oracle.ucp.jdbc.PoolXADataSource</code>) that is used to get XA connections that can be enlisted in a distributed transaction. UCP JDBC XA pools have the same features as non-XA UCP JDBC pools. The <code class="codeph">oracle.ucp.jdbc.PoolDataSourceFactory</code> factory class provides a <code class="codeph">getPoolXADataSource()</code> method that creates the pool-enabled XA data source instance. For example:
                     </p><pre class="oac_no_warn" dir="ltr">PoolXADataSource  pds = PoolDataSourceFactory.getPoolXADataSource();
</pre><p><a id="d2697e381" class="indexterm-anchor"></a><a id="d2697e383" class="indexterm-anchor"></a><a id="d2697e385" class="indexterm-anchor"></a><a id="d2697e387" class="indexterm-anchor"></a><a id="d2697e391" class="indexterm-anchor"></a><a id="d2697e393" class="indexterm-anchor"></a><a id="d2697e395" class="indexterm-anchor"></a><a id="d2697e397" class="indexterm-anchor"></a>A pool-enabled XA data source instance, like a non-XA data source instance, requires the connection factory, URL, user name, and password in order to get an actual physical connection. These properties are set in the same way as a non-XA data source instance (see above). However, an XA-specific connection factory class is required to get XA connections. The XA connection factory is typically provided as part of a JDBC driver and can be a data source itself. The following example uses Oracle's <code class="codeph">oracle.jdbc.xa.client.OracleXADataSource</code> XA connection factory class included with the JDBC driver. If a different vendor's JDBC driver is used, refer to the vendor's documentation for an appropriate XA connection factory class.
                     </p><pre class="oac_no_warn" dir="ltr">pds.setConnectionFactoryClassName("oracle.jdbc.xa.client.OracleXADataSource");
pds.setURL("jdbc:oracle:thin:@//localhost:1521/XE");
pds.setUser("<span class="italic">user</span>");
pds.setPassword("<span class="italic">password</span>");
</pre><p><a id="d2697e412" class="indexterm-anchor"></a><a id="d2697e414" class="indexterm-anchor"></a>Lastly, a pool-enabled XA data source provides a set of <code class="codeph">getXAConnection</code> methods that are used to borrow a connection handle from the pool that is of the type <code class="codeph">javax.sql.XAConnection</code>. The <code class="codeph">getXAConnection</code> methods are the same as the <code class="codeph">getConnection</code> methods previously described. The following example demonstrates borrowing an XA connection.
                     </p><pre class="oac_no_warn" dir="ltr">PoolXADataSource  pds = PoolDataSourceFactory.getPoolXADataSource();

pds.setConnectionFactoryClassName("oracle.jdbc.xa.client.OracleXADataSource");
pds.setURL("jdbc:oracle:thin:@//localhost:1521/XE");
pds.setUser("<span class="italic">&lt;user&gt;</span>");
pds.setPassword("<span class="italic">&lt;password&gt;</span>");

XAConnection conn = pds.getXAConnection();
</pre></div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="labeling-ucp-connections.html#GUID-FF477DDE-FAE6-4E42-9B45-C3003CDB0DDF">Labeling Connections in UCP</a></li>
                     </ul>
                  </div>
               </div>
               
            </div><a id="JJUCP8133"></a><div class="props_rev_3"><a id="GUID-E0DDAD88-925B-4F92-BE07-22D084BA6B3E" name="GUID-E0DDAD88-925B-4F92-BE07-22D084BA6B3E"></a><h3 id="JJUCP-GUID-E0DDAD88-925B-4F92-BE07-22D084BA6B3E" class="sect3"><span class="enumeration_section">3.1.4 </span>Setting Connection Properties
               </h3>
               <div>
                  <div class="section">
                     <p><a id="d2697e482" class="indexterm-anchor"></a><a id="d2697e484" class="indexterm-anchor"></a><a id="d2697e488" class="indexterm-anchor"></a>Oracle's connection factories support properties that configure connections with specific features. UCP pool-enabled data sources provide the <code class="codeph">setConnectionProperties(Properties)</code> method, which is used to set properties on a given connection factory. The following example demonstrates setting connection properties for Oracle's JDBC driver. If you are using a JDBC driver from a different vendor, then refer to the vendor-specific documentation to check whether setting properties in this manner is supported and what properties are available:
                     </p><pre class="oac_no_warn" dir="ltr">Properties connProps = new Properties();
connProps.put("fixedString", false);
connProps.put("remarksReporting", false);
connProps.put("restrictGetTables", false);
connProps.put("includeSynonyms", false);
connProps.put("defaultNChar", false);
connProps.put("AccumulateBatchResult", false);

pds.setConnectionProperties(connProps);
</pre><p>The UCP JDBC connection pool does not remove connections that are already created if <code class="codeph">setConnectionProperties</code> is called after the pool is created and in use.
                     </p>
                     <div class="infoboxnotealso" id="GUID-E0DDAD88-925B-4F92-BE07-22D084BA6B3E__GUID-A432D9F0-7E6A-4871-BE78-6D31FE1E2DD4">
                        <p class="notep1">See Also:</p>
                        <p><a href="../jajdb/index.html" target="_blank"><span class="italic">Oracle Database JDBC Java API Reference</span></a> for a detailed list of supported properties to configure the connection. For example, to set the auto-commit mode, you can use the <code class="codeph">OracleConnection.CONNECTION_PROPERTY_AUTOCOMMIT</code> property.
                        </p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="JJUCP8134"></a><div class="props_rev_3"><a id="GUID-44F415AE-9B73-4834-9C67-04FE7B4A59DD" name="GUID-44F415AE-9B73-4834-9C67-04FE7B4A59DD"></a><h3 id="JJUCP-GUID-44F415AE-9B73-4834-9C67-04FE7B4A59DD" class="sect3"><span class="enumeration_section">3.1.5 </span>Using JNDI to Borrow a Connection
               </h3>
               <div>
                  <div class="section">
                     <p><a id="d2697e547" class="indexterm-anchor"></a><a id="d2697e551" class="indexterm-anchor"></a><a id="d2697e553" class="indexterm-anchor"></a>A connection can be borrowed from a connection pool by performing a JNDI look up for a pool-enabled data source and then calling <code class="codeph">getConnection()</code> on the returned object. The pool-enabled data source must first be bound to a JNDI context and a logical name. This assumes that an application includes a Service Provider Interface (SPI) implementation for a naming and directory service where object references can be registered and located.
                     </p>
                     <p>The following example uses Sun's file system JNDI service provider, which can be downloaded from the JNDI software download page:</p>
                     <p><a href="http://www.oracle.com/technetwork/java/index.html" target="_blank"><code class="codeph">http://www.oracle.com/technetwork/java/index.html</code></a></p>
                     <p>The example demonstrates creating an initial context and then performing a lookup for a pool-enabled data source that is bound to the name <code class="codeph">MyPooledDataSource</code>. The object returned is then used to borrow a connection from the connection pool.
                     </p><pre class="oac_no_warn" dir="ltr">
Hashtable env = new Hashtable();
env.put(Context.INITIAL_CONTEXT_FACTORY,   
   "com.sun.jndi.fscontext.RefFSContextFactory");
env.put(Context.PROVIDER_URL, "file:/tmp");

ctx = new InitialContext(env);

PoolDataSource jpds = (PoolDataSource)ctx.lookup(MyPooledDataSource);
Connection conn = jpds.getConnection();
</pre><p>In the example, <code class="codeph">MyPoolDataSource</code> must be bound to the context. For example:
                     </p><pre class="oac_no_warn" dir="ltr">PoolDataSource  pds = PoolDataSourceFactory.getPoolDataSource();

pds.setConnectionFactoryClassName("oracle.jdbc.pool.OracleDataSource");
pds.setURL("jdbc:oracle:thin:@//localhost:1521/XE");
pds.setUser("<span class="italic">&lt;user&gt;</span>");
pds.setPassword("<span class="italic">&lt;password&gt;</span>");

ctx.bind(MyPooledDataSource, pds);
</pre></div>
                  <!-- class="section" -->
               </div>
            </div>
            <div class="props_rev_3"><a id="GUID-466F2D15-0811-40F0-8DF3-1F5518F49C82" name="GUID-466F2D15-0811-40F0-8DF3-1F5518F49C82"></a><h3 id="JJUCP-GUID-466F2D15-0811-40F0-8DF3-1F5518F49C82" class="sect3"><span class="enumeration_section">3.1.6 </span>About Connection Initialization Callback
               </h3>
               <div>
                  <p>The Connection Initialization Callback enables applications and frameworks to initialize connections retrieved from Universal Connection Pool. It is executed at every connection checkout from the pool, as well as at each successful reconnection during failover.</p>
                  <p>This section discusses initialization callbacks in the following sections:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="borrowing-ucp-connections.html#GUID-43994D45-B1D7-44E1-AE20-6BC5A055AB90">Overview of Connection Initialization Callback</a></p>
                     </li>
                     <li>
                        <p><a href="borrowing-ucp-connections.html#GUID-B406C378-5E60-4D64-A0D8-A55B7D55912A">Creating an Initialization Callback</a></p>
                     </li>
                     <li>
                        <p><a href="borrowing-ucp-connections.html#GUID-7739FB00-31FB-4558-A85D-248C66B9EBF2">Registering an Initialization Callback</a></p>
                     </li>
                     <li>
                        <p><a href="borrowing-ucp-connections.html#GUID-4B6E7E87-9417-4AC5-ADC5-21884277A555">Removing or Unregistering an Initialization Callback</a></p>
                     </li>
                  </ul>
               </div>
               <div class="props_rev_3"><a id="GUID-43994D45-B1D7-44E1-AE20-6BC5A055AB90" name="GUID-43994D45-B1D7-44E1-AE20-6BC5A055AB90"></a><h4 id="JJUCP-GUID-43994D45-B1D7-44E1-AE20-6BC5A055AB90" class="sect4"><span class="enumeration_section">3.1.6.1 </span>Overview of Connection Initialization Callback
                  </h4>
                  <div>
                     <p>If an application cannot use connection labeling because it cannot be changed, then the connection initialization callback is provided for such an application.</p>
                     <p>When registered, the initialization callback is executed every time a connection is borrowed from the pool and at each successful reconnection following a recoverable error. Using the same callback at both run time and replay ensures that exactly the same initialization, which was used when the original session was established, is reestablished at run time. If the callback invocation fails, then replay is disabled on that connection.</p>
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-B406C378-5E60-4D64-A0D8-A55B7D55912A" name="GUID-B406C378-5E60-4D64-A0D8-A55B7D55912A"></a><h4 id="JJUCP-GUID-B406C378-5E60-4D64-A0D8-A55B7D55912A" class="sect4"><span class="enumeration_section">3.1.6.2 </span>Creating an Initialization Callback
                  </h4>
                  <div>
                     <div class="section">
                        <p>To create a UCP connection initialization callback, an application implements the <code class="codeph">oracle.ucp.jdbc.ConnectionInitializationCallback</code> interface. This interface has the following method:
                        </p><pre class="oac_no_warn" dir="ltr">void initialize(java.sql.Connection connection) throws SQLException;
</pre><div class="infoboxnote" id="GUID-B406C378-5E60-4D64-A0D8-A55B7D55912A__GUID-46B1B850-C131-4813-BFF0-CB0E55D3AB01">
                           <p class="notep1">Note:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>One callback is created for every connection pool.</p>
                              </li>
                              <li>
                                 <p>This callback is not used if a labeling callback is registered for the connection pool.</p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-B406C378-5E60-4D64-A0D8-A55B7D55912A__GUID-7A5FB5D9-8267-445C-9DC0-E092E4016BBA">Example</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>The following example demonstrates how to create a simple initialization callback:</p><pre class="oac_no_warn" dir="ltr">import oracle.ucp.jdbc.ConnectionInitializationCallback;
class MyConnectionInitializationCallback implements ConnectionInitializationCallback
{
  public MyConnectionInitializationCallback()
  {
    ...
  }
  public void initialize(java.sql.Connection connection) throws SQLException
  {
     // Reset the state for the connection, if necessary (like ALTER SESSION)
  }
}
</pre></div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-7739FB00-31FB-4558-A85D-248C66B9EBF2" name="GUID-7739FB00-31FB-4558-A85D-248C66B9EBF2"></a><h4 id="JJUCP-GUID-7739FB00-31FB-4558-A85D-248C66B9EBF2" class="sect4"><span class="enumeration_section">3.1.6.3 </span>Registering an Initialization Callback
                  </h4>
                  <div>
                     <div class="section">
                        <p>UCP provides the <code class="codeph">registerConnectionInitializationCallback</code> method in the <code class="codeph">oracle.ucp.jdbc.PoolDataSource</code> interface for registering a connection initialization callback.
                        </p><pre class="oac_no_warn" dir="ltr">public void registerConnectionInitializationCallback (ConnectionInitializationCallback cbk) throws SQLException;
</pre><p>One callback may be registered on each connection pool instance.</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-4B6E7E87-9417-4AC5-ADC5-21884277A555" name="GUID-4B6E7E87-9417-4AC5-ADC5-21884277A555"></a><h4 id="JJUCP-GUID-4B6E7E87-9417-4AC5-ADC5-21884277A555" class="sect4"><span class="enumeration_section">3.1.6.4 </span>Removing or Unregistering an Initialization Callback
                  </h4>
                  <div>
                     <div class="section">
                        <p>UCP provides the <code class="codeph">unregisterConnectionInitializationCallback</code> method in the <code class="codeph">oracle.ucp.jdbc.PoolDataSource</code> interface for unregistering a connection initialization callback.
                        </p><pre class="oac_no_warn" dir="ltr">public void unregisterConnectionInitializationCallback (ConnectionInitializationCallback cbk) throws SQLException;
</pre><div class="infoboxnotealso" id="GUID-4B6E7E87-9417-4AC5-ADC5-21884277A555__GUID-BA291BBE-5757-462C-A7DA-5141AF68C58D">
                           <p class="notep1">See Also:</p>
                           <p><a href="../jjuar/index.html" target="_blank"><span class="italic">Oracle Universal Connection Pool Java API Reference</span></a> for more information
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>