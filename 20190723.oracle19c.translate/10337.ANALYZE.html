<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>分析</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="SQL Language Reference "></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="SQL Language Reference"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="sql-language-reference.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-02-12T15:36:36-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96310-02"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="ALTER-VIEW.html" title="Previous" type="text/html"></link>
      <link rel="next" href="ASSOCIATE-STATISTICS.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="SQL Language Reference"></meta>
    <meta name="dcterms.isVersionOf" content="SQLRF"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="ALTER-VIEW.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="ASSOCIATE-STATISTICS.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">SQL语言参考</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="SQL-Statements-ALTER-SYNONYM-to-COMMENT.html" property="item" typeof="WebPage"><span property="name">SQL语句：ALTER SYNONYM to COMMENT</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">分析</li>
            </ol>
            <a id="GUID-535CE98E-2359-4147-839F-DCB3772C1B0E" name="GUID-535CE98E-2359-4147-839F-DCB3772C1B0E"></a><a id="SQLRF53664"></a><a id="SQLRF53665"></a><a id="SQLRF53666"></a><a id="SQLRF53667"></a><a id="SQLRF53668"></a><a id="SQLRF53669"></a><a id="SQLRF53670"></a><a id="SQLRF53671"></a><a id="SQLRF53672"></a><a id="SQLRF53673"></a><a id="SQLRF53674"></a><a id="SQLRF53675"></a><a id="SQLRF53676"></a><a id="SQLRF53677"></a><a id="SQLRF53678"></a><a id="SQLRF53680"></a><a id="SQLRF53681"></a><a id="SQLRF53682"></a><a id="SQLRF53679"></a><a id="SQLRF53683"></a><a id="SQLRF53684"></a><a id="SQLRF53685"></a><a id="SQLRF53686"></a><a id="SQLRF53687"></a><a id="SQLRF53688"></a><a id="SQLRF53689"></a><a id="SQLRF01105"></a>
            
            <h2 id="SQLRF-GUID-535CE98E-2359-4147-839F-DCB3772C1B0E" class="sect2">分析</h2>
         </header>
         <div class="ind">
            <div>
               <div class="section">
                  <p class="subhead1" id="GUID-535CE98E-2359-4147-839F-DCB3772C1B0E__GUID-AFFF4AF5-86B5-4F04-A111-A17FDC911432">目的</p>
                  <p><a id="d289770e168" class="indexterm-anchor"></a><a id="d289770e170" class="indexterm-anchor"></a><a id="d289770e172" class="indexterm-anchor"></a><a id="d289770e174" class="indexterm-anchor"></a><a id="d289770e180" class="indexterm-anchor"></a><a id="d289770e186" class="indexterm-anchor"></a>使用<code class="codeph">ANALYZE</code>语句收集统计信息，例如：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>收集或删除有关索引或索引分区，表或表分区，索引组织表，集群或标量对象属性的统计信息。</p>
                     </li>
                     <li>
                        <p>验证索引或索引分区，表或表分区，索引组织表，集群或对象引用（ <code class="codeph">REF</code> ）的结构。
                        </p>
                     </li>
                     <li>
                        <p>标识表或集群的已迁移和链接的行。</p>
                     </li>
                  </ul>
                  <div class="infoboxnote" id="GUID-535CE98E-2359-4147-839F-DCB3772C1B0E__GUID-9D6A89F8-7C4D-490B-A20F-8B7CD6299858">
                     <p class="notep1">注意：</p>
                     <p>对于大多数统计信息的收集，请使用<code class="codeph">DBMS_STATS</code>包，它允许您并行收集统计信息，收集分区对象的全局统计信息，以及以其他方式微调统计信息收集。有关<code class="codeph">DBMS_STATS</code>包的更多信息，请参见<a href="../arpls/DBMS_STATS.html#ARPLS059" target="_blank"><span class="italic">Oracle数据库PL / SQL包和类型参考</span></a> 。
                     </p>
                     <p>使用<code class="codeph">ANALYZE</code>语句（而不是<code class="codeph">DBMS_STATS</code> ）进行与基于开销的优化器无关的统计信息收集：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>使用<code class="codeph">VALIDATE</code>或<code class="codeph">LIST</code> <code class="codeph">CHAINED</code> <code class="codeph">ROWS</code>子句</p>
                        </li>
                        <li>
                           <p>收集freelist块的信息</p>
                        </li>
                     </ul>
                  </div>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-535CE98E-2359-4147-839F-DCB3772C1B0E__GUID-85CDACFE-A205-4FD7-89C3-6AA297B4CBC0">先决条件</p>
                  <p>要分析的模式对象必须是本地的，并且必须位于您自己的模式中，或者您必须具有<code class="codeph">ANALYZE</code> <code class="codeph">ANY</code>系统特权。
                  </p>
                  <p>如果要将表或集群的链接行列表到列表中，则列表必须位于您自己的模式中，或者您必须对列表具有<code class="codeph">INSERT</code>特权，或者您必须具有<code class="codeph">INSERT</code> <code class="codeph">ANY</code> <code class="codeph">TABLE</code>系统特权。
                  </p>
                  <p>如果要验证分区表，则必须对列出已分析rowid的表具有<code class="codeph">INSERT</code>对象特权，或者必须具有<code class="codeph">INSERT</code> <code class="codeph">ANY</code> <code class="codeph">TABLE</code>系统特权。
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-535CE98E-2359-4147-839F-DCB3772C1B0E__GUID-41A2FED6-0395-4C5B-A154-DD5681FAFB58">句法</p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-535CE98E-2359-4147-839F-DCB3772C1B0E__GUID-BD519F40-C658-4E88-8742-095AA617EC08"><span class="italic">analyze</span> :: =</p>
                  <div class="figure" id="GUID-535CE98E-2359-4147-839F-DCB3772C1B0E__GUID-56B44FFE-8BAE-4138-8F14-286A1E879E2E"><img src="img/analyze.gif" alt="analyze.eps的描述如下" title="analyze.eps的描述如下" longdesc="img_text/analyze.html"><br><a href="img_text/analyze.html">说明analyze.eps的说明</a></div>
                  <!-- class="figure" -->
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-535CE98E-2359-4147-839F-DCB3772C1B0E__GUID-43AD9B53-3D27-4390-BBC2-1B05A7136183"><span class="italic">partition_extension_clause</span> :: =</p>
                  <div class="figure" id="GUID-535CE98E-2359-4147-839F-DCB3772C1B0E__GUID-D7ED1804-4FF0-4A50-9C34-0076E34A7B04"><img src="img/partition_extension_clause.gif" alt="下面是partition_extension_clause.eps的描述" title="下面是partition_extension_clause.eps的描述" longdesc="img_text/partition_extension_clause.html"><br><a href="img_text/partition_extension_clause.html">插图说明partition_extension_clause.eps</a></div>
                  <!-- class="figure" -->
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-535CE98E-2359-4147-839F-DCB3772C1B0E__GUID-F10D7C3F-57B8-47F5-9D1B-7041B396400D"><span class="italic">validation_clauses</span> :: =</p>
                  <div class="figure" id="GUID-535CE98E-2359-4147-839F-DCB3772C1B0E__GUID-E589647D-8BA3-4151-90C2-258410A64368"><img src="img/validation_clauses.gif" alt="validation_clauses.eps的描述如下" title="validation_clauses.eps的描述如下" longdesc="img_text/validation_clauses.html"><br><a href="img_text/validation_clauses.html">说明validation_clauses.eps的说明</a></div>
                  <!-- class="figure" -->
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-535CE98E-2359-4147-839F-DCB3772C1B0E__GUID-7CE6533E-3039-4308-B046-3B2A515DFE2A"><span class="italic">into_clause</span> :: =</p>
                  <div class="figure" id="GUID-535CE98E-2359-4147-839F-DCB3772C1B0E__GUID-35036AA7-7EE2-4542-9B29-828DA3FF07A0"><img src="img/into_clause.gif" alt="下面是into_clause.eps的描述" title="下面是into_clause.eps的描述" longdesc="img_text/into_clause.html"><br><a href="img_text/into_clause.html">插图描述into_clause.eps</a></div>
                  <!-- class="figure" -->
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-535CE98E-2359-4147-839F-DCB3772C1B0E__GUID-0F6407D4-6CD5-4EFF-AAAD-635FA0AEC06D">语义</p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-535CE98E-2359-4147-839F-DCB3772C1B0E__GUID-020C4708-5795-42C4-8E3C-04D2D4C9F37F"><span class="italic">模式</span></p>
                  <p>指定包含表，索引或集群的模式。如果省略<span class="italic"><code class="codeph">schema</code></span> ，则Oracle数据库假定表，索引或集群位于您自己的模式中。
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-535CE98E-2359-4147-839F-DCB3772C1B0E__GUID-4A4EFF29-5A2E-47C6-997E-90541445F20A">表格<span class="italic">表</span></p>
                  <p><a id="d289770e343" class="indexterm-anchor"></a><a id="d289770e347" class="indexterm-anchor"></a>指定要分析的表。分析表时，数据库还会收集有关任何基于函数的索引中出现的表达式的统计信息。因此，在分析表之前，请务必在表上创建基于函数的索引。有关基于函数的<a href="CREATE-INDEX.html#GUID-1F89BBC0-825F-4215-AF71-7588E31D8BFE">索引</a>的更多信息，请参阅<a href="CREATE-INDEX.html#GUID-1F89BBC0-825F-4215-AF71-7588E31D8BFE">CREATE INDEX</a> 。
                  </p>
                  <p>分析表时，数据库会跳过标记为<code class="codeph">LOADING</code>或<code class="codeph">FAILED</code>所有域索引。</p>
                  <p><a id="d289770e364" class="indexterm-anchor"></a><a id="d289770e368" class="indexterm-anchor"></a>对于索引组织表，数据库还会分析任何映射表并计算其<code class="codeph">PCT_ACCESSS_DIRECT</code>统计信息。这些统计数据估计作为映射表中本地rowid的一部分存储的猜测数据块地址的准确性。
                  </p>
                  <p><a id="d289770e377" class="indexterm-anchor"></a> Oracle数据库收集表的以下统计信息。标有星号的统计数据总是精确计算。表统计信息（包括域索引的状态）显示在括号中显示的列中的数据字典视图<code class="codeph">USER_TABLES</code> ， <code class="codeph">ALL_TABLES</code>和<code class="codeph">DBA_TABLES</code>中。
                  </p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>行数（ <code class="codeph">NUM_ROWS</code> ）</p>
                     </li>
                     <li>
                        <p>*高水位线以下的数据块数 - 已格式化为接收数据的数据块数，无论它们当前是否包含数据或为空（ <code class="codeph">BLOCKS</code> ）</p>
                     </li>
                     <li>
                        <p>*分配给从未使用过的表的数据块数（ <code class="codeph">EMPTY_BLOCKS</code> ）</p>
                     </li>
                     <li>
                        <p>每个数据块的平均可用空间（以字节为单位）（ <code class="codeph">AVG_SPACE</code> ）</p>
                     </li>
                     <li>
                        <p>链接行数（ <code class="codeph">CHAIN_COUNT</code> ）</p>
                     </li>
                     <li>
                        <p>平均行长度，包括行开销，以字节为单位（ <code class="codeph">AVG_ROW_LEN</code> ）</p>
                     </li>
                  </ul>
                  <p><span class="bold">分析表的限制</span></p>
                  <p>分析表受以下限制：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>您不能使用<code class="codeph">ANALYZE</code>来收集数据字典表的统计信息。
                        </p>
                     </li>
                     <li>
                        <p>您不能使用<code class="codeph">ANALYZE</code>来收集外部表的统计信息。相反，您必须使用<code class="codeph">DBMS_STATS</code>包。
                        </p>
                     </li>
                     <li>
                        <p>您不能使用<code class="codeph">ANALYZE</code>来收集临时表上的默认统计信息。但是，如果已经在临时表的一个或多个列与用户定义的统计信息类型之间创建了关联，则可以使用<code class="codeph">ANALYZE</code>在临时表上收集用户定义的统计信息。
                        </p>
                     </li>
                     <li>
                        <p>您无法计算或估计以下列类型的统计信息： <code class="codeph">REF</code>列类型，varrays，嵌套表，LOB列类型（不分析LOB列类型，跳过它们）， <code class="codeph">LONG</code>列类型或对象类型。但是，如果统计类型与此类关联，则Oracle数据库会收集用户定义的统计信息。
                        </p>
                     </li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-535CE98E-2359-4147-839F-DCB3772C1B0E__GUID-014D9B87-0D01-4137-ADD3-81C76147ECB1">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="ASSOCIATE-STATISTICS.html#GUID-BD02BA6A-32A7-4093-A6B6-BAE860C0F834">协会统计</a></p>
                        </li>
                        <li>
                           <p>有关数据字典视图的信息，请参阅<a href="../refrn/static-data-dictionary-views.html#REFRN-GUID-8865F65B-EF6D-44A5-B0A1-3179EFF0C36A" target="_blank"><span class="italic">Oracle数据库参考</span></a></p>
                        </li>
                     </ul>
                  </div>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-535CE98E-2359-4147-839F-DCB3772C1B0E__GUID-46F2BB54-F39C-41F2-9986-B9A49C59B029"><span class="italic">partition_extension_clause</span></p>
                  <p><span class="italic">partition_extension_clause</span> <a id="d289770e488" class="indexterm-anchor"></a><a id="d289770e492" class="indexterm-anchor"></a></p>
                  <p>指定要在其上收集统计信息的分区或子分区或分区或子分区值。分析集群时，不能使用此子句。</p>
                  <p>如果指定<code class="codeph">PARTITION</code>并且<span class="italic"><code class="codeph">table</code></span>是复合分区的，则Oracle数据库会分析指定分区中的所有子分区。
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-535CE98E-2359-4147-839F-DCB3772C1B0E__GUID-33AA9816-4FAC-4ECA-8393-6CF42F6EA10A">INDEX <span class="italic">指数</span></p>
                  <p><a id="d289770e514" class="indexterm-anchor"></a><a id="d289770e518" class="indexterm-anchor"></a>指定要分析的索引。
                  </p>
                  <p>Oracle数据库收集索引的以下统计信息。标有星号的统计数据总是精确计算。对于常规索引，在计算或估计统计信息时，统计信息将显示在括号中显示的列中的数据字典视图<code class="codeph">USER_INDEXES</code> ， <code class="codeph">ALL_INDEXES</code>和<code class="codeph">DBA_INDEXES</code>中。
                  </p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>*索引从其根块到其叶块的深度（ <code class="codeph">BLEVEL</code> ）</p>
                     </li>
                     <li>
                        <p>叶块数（ <code class="codeph">LEAF_BLOCKS</code> ）</p>
                     </li>
                     <li>
                        <p>不同索引值的数量（ <code class="codeph">DISTINCT_KEYS</code> ）</p>
                     </li>
                     <li>
                        <p>每个索引值的平均叶块数（ <code class="codeph">AVG_LEAF_BLOCKS_PER_KEY</code> ）</p>
                     </li>
                     <li>
                        <p>每个索引值的平均数据块数（对于表上的索引）（ <code class="codeph">AVG_DATA_BLOCKS_PER_KEY</code> ）</p>
                     </li>
                     <li>
                        <p>聚类因子（行与索引值的排序顺序）（ <code class="codeph">CLUSTERING_FACTOR</code> ）</p>
                     </li>
                  </ul>
                  <p>对于域索引，此语句将调用与索引关联的统计类型中指定的用户定义的统计信息收集函数（请参阅<a href="ASSOCIATE-STATISTICS.html#GUID-BD02BA6A-32A7-4093-A6B6-BAE860C0F834">ASSOCIATE STATISTICS</a> ）。如果没有与域索引关联的统计信息类型，则使用与其indextype关联的统计信息类型。如果索引或其索引类型不存在统计类型，则不会收集用户定义的统计信息。用户定义的索引统计信息显示在数据字典视图<code class="codeph">USER_USTATS</code> ， <code class="codeph">ALL_USTATS</code>和<code class="codeph">DBA_USTATS</code>的<code class="codeph">STATISTICS</code>列中。</p>
                  <div class="infoboxnote" id="GUID-535CE98E-2359-4147-839F-DCB3772C1B0E__GUID-FAFCAF53-62E2-46F2-9411-2034E6FAAE6E">
                     <p class="notep1">注意：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>分析已从中删除大量行的索引时，即使您请求<code class="codeph">ESTIMATE</code>统计操作，Oracle数据库有时也会执行<code class="codeph">COMPUTE</code>统计操作（可能需要进行全表扫描）。这样的操作可能非常耗时。
                           </p>
                        </li>
                        <li>
                           <p>在某些情况下，使用<code class="codeph">ANALYZE</code>语句分析索引需要花费过多的时间才能完成。在这些情况下，您可以使用SQL查询来验证索引。如果查询确定表与索引之间存在不一致，则可以使用<code class="codeph">ANALYZE</code>语句对索引进行全面分析。有关更多信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sqlrf&amp;id=ADMIN14215" target="_blank"><span class="italic">Oracle数据库管理员指南</span></a> 。
                           </p>
                        </li>
                     </ul>
                  </div>
                  <p><span class="bold">分析指数的限制</span></p>
                  <p>您无法分析标记为<code class="codeph">IN_PROGRESS</code>或<code class="codeph">FAILED</code>的域索引。</p>
                  <div class="infoboxnotealso" id="GUID-535CE98E-2359-4147-839F-DCB3772C1B0E__GUID-A008D739-96E4-4C30-AE2A-4FC44E1783F7">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>有关域索引的更多信息，请参阅<a href="CREATE-INDEX.html#GUID-1F89BBC0-825F-4215-AF71-7588E31D8BFE">CREATE INDEX</a></p>
                        </li>
                        <li>
                           <p>有关数据字典视图的信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sqlrf&amp;id=REFRN-GUID-8865F65B-EF6D-44A5-B0A1-3179EFF0C36A" target="_blank"><span class="italic">Oracle数据库参考</span></a></p>
                        </li>
                        <li>
                           <p><span class="q">“ <a href="ANALYZE.html#GUID-535CE98E-2359-4147-839F-DCB3772C1B0E__I2154661">分析索引：示例</a> ”</span></p>
                        </li>
                     </ul>
                  </div>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-535CE98E-2359-4147-839F-DCB3772C1B0E__GUID-5C34A086-EB5D-431F-B9AB-71F87AEC3D8E">CLUSTER <span class="italic">集群</span></p>
                  <p>指定要分析的群集。收集集群的统计信息时，Oracle数据库还会自动收集集群中所有表及其所有索引（包括集群索引）的统计信息。</p>
                  <p>对于索引和散列集群，数据库会收集单个集群密钥（ <code class="codeph">AVG_BLOCKS_PER_KEY</code> ）占用的平均数据块数。这些统计信息显示在数据字典视图<code class="codeph">ALL_CLUSTERS</code> ， <code class="codeph">USER_CLUSTERS</code>和<code class="codeph">DBA_CLUSTERS</code> 。</p>
                  <div class="infoboxnotealso" id="GUID-535CE98E-2359-4147-839F-DCB3772C1B0E__GUID-B8756108-4A6B-4581-823A-FECB4605ED6A">
                     <p class="notep1">也可以看看：</p>
                     <p>有关数据字典视图和<span class="q">“ <a href="ANALYZE.html#GUID-535CE98E-2359-4147-839F-DCB3772C1B0E__I2115909">分析集群：示例</a> ”的</span>信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sqlrf&amp;id=REFRN-GUID-8865F65B-EF6D-44A5-B0A1-3179EFF0C36A" target="_blank"><span class="italic">Oracle数据库参考</span></a></p>
                  </div>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-535CE98E-2359-4147-839F-DCB3772C1B0E__GUID-1BA6DF50-F714-4FF0-A71E-7EC5378F9B5D"><span class="italic">validation_clauses</span></p>
                  <p>验证子句允许您验证<code class="codeph">REF</code>值和分析对象的结构。
                  </p>
                  <div class="infoboxnotealso" id="GUID-535CE98E-2359-4147-839F-DCB3772C1B0E__GUID-DC854467-9E3F-4F89-9DCD-1C9E2858547D">
                     <p class="notep1">也可以看看：</p>
                     <p>有关验证表，索引，集群和物化视图的详细信息，请参见<a href="../admin/managing-schema-objects.html#ADMIN11526" target="_blank"><span class="italic">“Oracle数据库管理员指南”</span></a></p>
                  </div>
                  <p><span class="bold">验证REF更新条款</span> <a id="d289770e694" class="indexterm-anchor"></a><a id="d289770e698" class="indexterm-anchor"></a><a id="d289770e702" class="indexterm-anchor"></a></p>
                  <p>指定<code class="codeph">VALIDATE</code> <code class="codeph">REF</code> <code class="codeph">UPDATE</code>以验证指定表中的<code class="codeph">REF</code>值，检查每个<code class="codeph">REF</code>的rowid部分，将其与真正的rowid进行比较，并在必要时进行更正。只有在分析表时才能使用此子句。
                  </p>
                  <p>如果表的所有者对引用的对象没有<code class="codeph">READ</code>或<code class="codeph">SELECT</code>对象特权，则Oracle数据库将认为它们无效并将它们设置为null。随后，这些<code class="codeph">REF</code>值在查询中将不可用，即使它是由具有对象的适当权限的用户发出的。
                  </p>
                  <p><span class="bold">将DANGLING设置为NULL</span> <a id="d289770e738" class="indexterm-anchor"></a><a id="d289770e742" class="indexterm-anchor"></a></p>
                  <p><code class="codeph">SET</code> <code class="codeph">DANGLING</code> <code class="codeph">TO</code> <code class="codeph">NULL</code>设置为null指定表中发现指向无效或不存在的对象的任何<code class="codeph">REF</code>值（无论是否作用域）。
                  </p>
                  <p><span class="bold">验证结构</span> <a id="d289770e766" class="indexterm-anchor"></a><a id="d289770e770" class="indexterm-anchor"></a><a id="d289770e774" class="indexterm-anchor"></a><a id="d289770e778" class="indexterm-anchor"></a><a id="d289770e782" class="indexterm-anchor"></a><a id="d289770e786" class="indexterm-anchor"></a><a id="d289770e790" class="indexterm-anchor"></a><a id="d289770e794" class="indexterm-anchor"></a></p>
                  <p>指定<code class="codeph">VALIDATE</code> <code class="codeph">STRUCTURE</code>以验证分析对象的结构。Oracle数据库优化器不使用此子句收集的统计信息。
                  </p>
                  <div class="infoboxnotealso" id="GUID-535CE98E-2359-4147-839F-DCB3772C1B0E__GUID-7C634D67-1FD1-4E58-9462-17E66533373E">
                     <p class="notep1">也可以看看：</p>
                     <p><span class="q">“ <a href="ANALYZE.html#GUID-535CE98E-2359-4147-839F-DCB3772C1B0E__I2115898">验证表：示例</a> ”</span></p>
                  </div>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>对于表，Oracle数据库会验证每个数据块和行的完整性。对于索引组织表，数据库还为表上的主键索引生成压缩统计信息（最佳前缀压缩计数）。</p>
                     </li>
                     <li>
                        <p>对于集群，Oracle数据库会自动验证集群表的结构。</p>
                     </li>
                     <li>
                        <p>对于分区表，Oracle数据库还会验证每行是否属于正确的分区。如果某行未正确整理，则其rowid将插入<code class="codeph">INVALID_ROWS</code>表中。
                        </p>
                     </li>
                     <li>
                        <p>对于临时表，Oracle数据库会在当前会话期间验证表及其索引的结构。</p>
                     </li>
                     <li>
                        <p>对于索引，Oracle数据库会验证索引中每个数据块的完整性，并检查块损坏。此子句不确认表中的每一行都有索引条目，或者每个索引条目都指向表中的一行。您可以通过使用<a href="ANALYZE.html#GUID-535CE98E-2359-4147-839F-DCB3772C1B0E__I2111178">CASCADE</a>子句验证表的结构来执行这些操作。
                        </p>
                        <p>Oracle数据库还计算所有正常索引的压缩统计信息（最佳前缀压缩计数）。</p>
                        <p>Oracle数据库在数据字典视图<code class="codeph">INDEX_STATS</code>和<code class="codeph">INDEX_HISTOGRAM</code>存储有关索引的统计信息。</p>
                        <div class="infoboxnotealso" id="GUID-535CE98E-2359-4147-839F-DCB3772C1B0E__GUID-A649356C-2703-41ED-BE9B-46271E3EBE09">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="../refrn/static-data-dictionary-views.html#REFRN-GUID-8865F65B-EF6D-44A5-B0A1-3179EFF0C36A" target="_blank"><span class="italic">Oracle数据库参考</span></a>有关这些视图的信息</p>
                        </div>
                     </li>
                  </ul>
                  <p>如果Oracle数据库遇到对象结构中的损坏，则会返回错误消息。在这种情况下，删除并重新创建对象。</p>
                  <p id="GUID-535CE98E-2359-4147-839F-DCB3772C1B0E__I2111178"><span class="bold">级联</span></p>
                  <p>如果希望Oracle数据库验证与表或集群关联的索引的结构，请指定<code class="codeph">CASCADE</code> 。如果在验证表时使用此子句，则数据库还会验证表上定义的索引。如果在验证集群时使用此子句，则数据库还会验证所有集群表索引，包括集群索引。
                  </p>
                  <p>默认情况下， <code class="codeph">CASCADE</code>执行<code class="codeph">COMPLETE</code>验证，这可能是资源密集型的。如果希望数据库检查是否存在损坏而不报告有关损坏的详细信息，请指定<code class="codeph">FAST</code> 。如果<code class="codeph">FAST</code>检查发现损坏，则可以使用不带<code class="codeph">FAST</code>子句的<code class="codeph">CASCADE</code>选项来查找和了解有关它的详细信息。
                  </p>
                  <p>如果使用此子句验证已启用（但先前已禁用）基于函数的索引，则可能会导致验证错误。在这种情况下，您必须重建索引。</p>
                  <p><span class="bold">在线|离线</span><a id="d289770e887" class="indexterm-anchor"></a><a id="d289770e891" class="indexterm-anchor"></a></p>
                  <p>指定<code class="codeph">ONLINE</code>以使Oracle数据库能够在对象内进行DML操作时运行验证。数据库减少了为允许并发而执行的验证量。
                  </p>
                  <div class="infoboxnote" id="GUID-535CE98E-2359-4147-839F-DCB3772C1B0E__GUID-204BAD7D-5FD6-4A64-901E-B0CBCF8A63FD">
                     <p class="notep1">注意：</p>
                     <p>当您验证对象的结构<code class="codeph">ONLINE</code> ，Oracle数据库不会收集任何统计数据，因为这时候你验证对象的结构确实<code class="codeph">OFFLINE</code> 。</p>
                  </div>
                  <p>指定<code class="codeph">OFFLINE</code> ，以最大化执行的验证量。此设置可防止<code class="codeph">INSERT</code> ， <code class="codeph">UPDATE</code>和<code class="codeph">DELETE</code>语句在验证期间同时访问对象，但允许查询。这是默认值。
                  </p>
                  <p><span class="bold">对ONLINE的限制</span></p>
                  <p>分析群集时，无法指定<code class="codeph">ONLINE</code> 。
                  </p>
                  <p><span class="bold">INTO</span></p>
                  <p><code class="codeph">VALIDATE</code> <code class="codeph">STRUCTURE</code>的<code class="codeph">INTO</code>子句仅对分区表有效。指定一个表，Oracle数据库将列出行无法正确整理的分区的rowid。如果省略<span class="italic"><code class="codeph">schema</code></span> ，则数据库假定列表位于您自己的模式中。如果完全省略此子句，则数据库假定该表名为<code class="codeph">INVALID_ROWS</code> 。用于创建此表的SQL脚本是<code class="codeph">UTLVALID.SQL</code> 。</p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-535CE98E-2359-4147-839F-DCB3772C1B0E__GUID-77B11873-9757-4A35-A846-2F13B7BDA25C">列出行链</p>
                  <p><a id="d289770e963" class="indexterm-anchor"></a><a id="d289770e967" class="indexterm-anchor"></a><a id="d289770e971" class="indexterm-anchor"></a><a id="d289770e975" class="indexterm-anchor"></a><a id="d289770e977" class="indexterm-anchor"></a><a id="d289770e981" class="indexterm-anchor"></a> <code class="codeph">LIST</code> <code class="codeph">CHAINED</code> <code class="codeph">ROWS</code>允许您识别分析的表或集群的已迁移和链接的行。分析索引时不能使用此子句。
                  </p>
                  <p>在<code class="codeph">INTO</code>子句中，指定Oracle数据库列出迁移和链接行的表。如果省略<span class="italic"><code class="codeph">schema</code></span> ，则数据库假定链式行表位于您自己的模式中。如果完全省略此子句，则数据库假定该表名为<code class="codeph">CHAINED_ROWS</code> 。链式行表必须位于本地数据库中。
                  </p>
                  <p>您可以使用以下脚本之一创建<code class="codeph">CHAINED_ROWS</code>表：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><code class="codeph">UTLCHAIN.SQL</code>使用物理rowid。因此，它可以容纳传统表中的行，但不能容纳索引组织表。（见下面的注释。）
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">UTLCHN1。SQL</code>使用通用rowid，因此它可以容纳来自传统和索引组织表的行。
                        </p>
                     </li>
                  </ul>
                  <p>如果您创建自己的链式行表，则它必须遵循这两个脚本之一规定的格式。</p>
                  <p>如果要基于主键（而不是通用rowid）分析索引组织表，则必须为每个索引组织表创建单独的链式行表以容纳其主键存储。使用SQL脚本<code class="codeph">DBMSIOTC.SQL</code>和<code class="codeph">PRVTIOTC.PLB</code>定义<code class="codeph">BUILD_CHAIN_ROWS_TABLE</code>过程，然后执行此过程为每个此类索引组织表创建<code class="codeph">IOT_CHAINED_ROWS</code>表。
                  </p>
                  <div class="infoboxnotealso" id="GUID-535CE98E-2359-4147-839F-DCB3772C1B0E__GUID-54E7D658-2DC7-4542-9040-A1F733D351E3">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>有关打包的SQL脚本的信息，请参阅<a href="../arpls/DBMS_IOT.html#ARPLS018" target="_blank"><span class="italic">Oracle Database PL / SQL包和类型参考中</span></a>的<code class="codeph">DBMS_IOT</code>包</p>
                        </li>
                        <li>
                           <p><span class="q">“ <a href="ANALYZE.html#GUID-535CE98E-2359-4147-839F-DCB3772C1B0E__I2115921">列出链式行：示例</a> ”</span></p>
                        </li>
                     </ul>
                  </div>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-535CE98E-2359-4147-839F-DCB3772C1B0E__GUID-66739054-68E7-4D88-8811-11D02BB1CDE0">删除统计</p>
                  <p><a id="d289770e1060" class="indexterm-anchor"></a><a id="d289770e1064" class="indexterm-anchor"></a>指定<code class="codeph">DELETE</code> <code class="codeph">STATISTICS</code>以删除当前存储在数据字典中的有关分析对象的任何统计信息。当您不再希望Oracle数据库使用统计信息时，请使用此语句。
                  </p>
                  <p>在表上使用此子句时，数据库还会自动删除表中定义的所有索引的统计信息。在群集上使用此子句时，数据库还会自动删除所有群集表及其所有索引（包括群集索引）的统计信息。</p>
                  <p>如果希望Oracle数据库仅删除系统（非用户定义的）统计信息，请指定<code class="codeph">SYSTEM</code> 。如果省略<code class="codeph">SYSTEM</code> ，并且如果为对象收集了用户定义的列或索引统计信息，则数据库还会通过调用用于收集统计信息的统计信息类型中指定的统计信息删除功能来删除用户定义的统计信息。
                  </p>
                  <div class="infoboxnotealso" id="GUID-535CE98E-2359-4147-839F-DCB3772C1B0E__GUID-06488019-68D7-4CE0-858B-2DA23A6745AE">
                     <p class="notep1">也可以看看：</p>
                     <p><span class="q">“ <a href="ANALYZE.html#GUID-535CE98E-2359-4147-839F-DCB3772C1B0E__I2115827">删除统计信息：示例</a> ”</span></p>
                  </div>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-535CE98E-2359-4147-839F-DCB3772C1B0E__GUID-6B17DD37-12B7-40B9-BB23-9F5BC8433F40">例子</p>
                  <p id="GUID-535CE98E-2359-4147-839F-DCB3772C1B0E__I2115827"><span class="bold">删除统计信息：示例</span></p>
                  <p>以下语句从数据字典中删除有关示例表<code class="codeph">oe.orders</code>及其所有索引的统计信息：</p><pre class="oac_no_warn" dir="ltr">ANALYZE TABLE命令DELETE STATISTICS;</pre><p id="GUID-535CE98E-2359-4147-839F-DCB3772C1B0E__I2154661"><span class="bold">分析索引：示例</span></p>
                  <p>以下语句验证了样本索引<code class="codeph">oe.inv_product_ix</code>的结构：</p><pre class="oac_no_warn" dir="ltr">ANALYZE INDEX inv_product_ix验证结构;</pre><p id="GUID-535CE98E-2359-4147-839F-DCB3772C1B0E__I2115898"><span class="bold">验证表：示例</span></p>
                  <p>以下语句分析示例表<code class="codeph">hr.employees</code>及其所有索引：</p><pre class="oac_no_warn" dir="ltr">ANALYZE TABLE员工验证结构CASCADE;</pre><p>对于表， <code class="codeph">VALIDATE</code> <code class="codeph">REF</code> <code class="codeph">UPDATE</code>子句验证指定表中的<code class="codeph">REF</code>值，检查每个<code class="codeph">REF</code>的rowid部分，然后将其与真正的rowid进行比较。如果结果是不正确的rowid，则更新<code class="codeph">REF</code>以使rowid部分正确。
                  </p>
                  <p>以下语句验证样本表<code class="codeph">oe.customers</code>的<code class="codeph">REF</code>值：</p><pre class="oac_no_warn" dir="ltr">ANALYZE TABLE客户验证REF更新;</pre><p>以下语句验证了样本表<code class="codeph">oe.customers</code>的结构，同时允许同时使用DML：</p><pre class="oac_no_warn" dir="ltr">ANALYZE TABLE客户在线验证结构;</pre><p id="GUID-535CE98E-2359-4147-839F-DCB3772C1B0E__I2115909"><span class="bold">分析群集：示例</span></p>
                  <p>以下语句分析<code class="codeph">personnel</code>集群（在<span class="q">“ <a href="CREATE-CLUSTER.html#GUID-4DBC701F-AFC3-486D-AA32-B5CB1D6946F7__I2105033">创建集群：示例</a> ”中<a href="CREATE-CLUSTER.html#GUID-4DBC701F-AFC3-486D-AA32-B5CB1D6946F7__I2105033">创建</a></span> ），其所有表及其所有索引，包括集群索引：</p><pre class="oac_no_warn" dir="ltr">ANALYZE CLUSTER人员验证结构级联;</pre><p id="GUID-535CE98E-2359-4147-839F-DCB3772C1B0E__I2115921"><span class="bold">列出链式行：示例</span></p>
                  <p>以下语句收集有关表<code class="codeph">orders</code>所有链接行的信息：</p><pre class="oac_no_warn" dir="ltr">ANALYZE TABLE命令LIST CHAINED ROWS INTO chained_rows;</pre><p>前面的语句将信息放入表<code class="codeph">chained_rows</code> 。然后，您可以使用此查询检查行（如果表中不包含链接的行，则不会返回任何行）：</p><pre class="oac_no_warn" dir="ltr">SELECT owner_name，table_name，head_rowid，analyze_timestamp FROM chained_rows ORDER BY owner_name，table_name，head_rowid，analyze_timestamp; OWNER_NAME TABLE_NAME HEAD_ROWID ANALYZE_TIMESTAMP ---------- ---------- ------------------ -------- --------- OE ORDERS AAAAZzAABAAABrXAAA 25-SEP-2000</pre></div>
               <!-- class="section" -->
            </div>
         </div>
      </article>
   </body>
</html>