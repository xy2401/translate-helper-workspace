<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>RMAN</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Backup and Recovery Reference"></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Backup and Recovery Reference"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="database-backup-and-recovery-reference.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-09T19:31:58-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2003, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96242-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="REVOKE.html" title="Previous" type="text/html"></link>
      <link rel="next" href="RUN.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database Backup and Recovery Reference"></meta>
    <meta name="dcterms.isVersionOf" content="RCMRF"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="REVOKE.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="RUN.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">备份和恢复参考</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="rman-commands-recover-to-validate.html" property="item" typeof="WebPage"><span property="name">RMAN命令：RECOVER to VALIDATE</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">RMAN</li>
            </ol>
            <a id="GUID-E5514ACB-59F6-4DB0-B4DB-64DF4C87CDE7" name="GUID-E5514ACB-59F6-4DB0-B4DB-64DF4C87CDE7"></a><a id="RCMRF90327"></a><a id="RCMRF90328"></a><a id="RCMRF90329"></a><a id="RCMRF90330"></a><a id="RCMRF90331"></a><a id="RCMRF90332"></a><a id="RCMRF90333"></a><a id="RCMRF90334"></a><a id="RCMRF111"></a>
            
            <h2 id="RCMRF-GUID-E5514ACB-59F6-4DB0-B4DB-64DF4C87CDE7" class="sect2"><span class="enumeration_section">3.11</span> RMAN</h2>
         </header>
         <div class="ind">
            <div>
               <div class="section">
                  <p class="subhead1" id="GUID-E5514ACB-59F6-4DB0-B4DB-64DF4C87CDE7__GUID-B7780DFF-DBD2-4DED-8902-A54944979250">目的</p>
                  <p><a id="d91517e109" class="indexterm-anchor"></a><a id="d91517e111" class="indexterm-anchor"></a>使用<code class="codeph" id="GUID-E5514ACB-59F6-4DB0-B4DB-64DF4C87CDE7__CHDECICE">RMAN</code>命令从操作系统命令行启动RMAN。
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-E5514ACB-59F6-4DB0-B4DB-64DF4C87CDE7__GUID-DBCF8DFA-2C63-4469-AB71-B1698DAC3F17">先决条件</p>
                  <p>您必须在操作系统命令行而不是在RMAN提示符下发出<code class="codeph">RMAN</code>命令和任何选项。
                  </p>
                  <p>指定和验证与数据库的RMAN连接的方式与SQL * Plus与数据库的连接相同。唯一的区别是与目标或辅助数据库的RMAN连接需要<code class="codeph">SYSBACKUP</code>权限。
                  </p>
                  <div class="infoboxnotealso" id="GUID-E5514ACB-59F6-4DB0-B4DB-64DF4C87CDE7__GUID-5500B7A8-C93C-484C-8F17-15100D4FBC8D">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="../admin/getting-started-with-database-administration.html#ADMIN-GUID-7842AF72-DA25-4559-A8E7-9883D0C63BF2" target="_blank"><span><cite>Oracle数据库管理员指南</cite></span></a> ，了解使用SQL * Plus时的数据库连接选项</p>
                        </li>
                        <li>
                           <p><a href="../bradv/starting-interacting-with-rman-client.html#BRADV8123" target="_blank"><span><cite>“Oracle数据库备份和恢复用户指南”</cite></span></a>了解如何使用<code class="codeph">SYSBACKUP</code>管理权限</p>
                        </li>
                     </ul>
                  </div>
                  <div class="infoboxnote" id="GUID-E5514ACB-59F6-4DB0-B4DB-64DF4C87CDE7__GUID-90D2ACF1-8FBF-4D0F-9D24-FA723A3398AC">
                     <p class="notep1">警告：</p>
                     <p>良好的安全性要求不要在命令行上以纯文本形式输入密码。仅在RMAN提示请求时在RMAN中输入密码。请参阅<a href="../dbseg/configuring-authentication.html#DBSEG0032" target="_blank"><span><cite>Oracle数据库安全指南</cite></span></a>以了解密码保护。
                     </p>
                  </div>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-E5514ACB-59F6-4DB0-B4DB-64DF4C87CDE7__GUID-36ADC61E-101A-4BFF-8908-94DB04AF4EF0">使用说明</p>
                  <p>您在操作系统提示符下输入的命令名称取决于操作系统。例如，在Linux和UNIX系统上以小写形式输入<code class="codeph">rman</code> 。
                  </p>
                  <p>如果在操作系统命令行上未指定<code class="codeph">CATALOG</code>或<code class="codeph">NOCATALOG</code>而启动RMAN，则除非执行<code class="codeph"><a href="CONNECT.html#GUID-64ECF1B8-4F70-413E-BEBE-1D5E8CD48B67">CONNECT</a></code> <code class="codeph">CATALOG</code>命令，否则RMAN会话实际上处于<code class="codeph">NOCATALOG</code>模式（请参阅<a href="RMAN.html#GUID-E5514ACB-59F6-4DB0-B4DB-64DF4C87CDE7__CHDIIDEJ">示例3-48</a> ）。如果维护恢复目录，则最佳做法是在执行RMAN操作之前将RMAN连接到恢复目录。
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-E5514ACB-59F6-4DB0-B4DB-64DF4C87CDE7__GUID-D3CE3807-8AE2-4899-B824-FE5AB20C1CCB">句法</p>
                  <p><a id="d91517e196" class="indexterm-anchor"></a><a id="d91517e200" class="indexterm-anchor"></a> <span class="bold"><span class="italic">cmdLine</span> :: =</span></p>
                  <div class="figure" id="GUID-E5514ACB-59F6-4DB0-B4DB-64DF4C87CDE7__GUID-8874AA53-1ADD-45CA-B409-07E5CFD28F1E"><img src="img/cmdline.gif" alt="下面是cmdline.eps的说明" title="下面是cmdline.eps的说明" longdesc="img_text/cmdline.html"><br><a href="img_text/cmdline.html">插图描述cmdline.eps</a></div>
                  <!-- class="figure" -->
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-E5514ACB-59F6-4DB0-B4DB-64DF4C87CDE7__GUID-31FBFA86-159C-4B41-A9B8-53AB0065BDDA">语义</p>
                  <p id="GUID-E5514ACB-59F6-4DB0-B4DB-64DF4C87CDE7__CHDDGEEB"><span class="bold"><span class="italic">CMDLINE</span></span></p>
                  <div class="tblformalwide" id="GUID-E5514ACB-59F6-4DB0-B4DB-64DF4C87CDE7__GUID-B58B3A6A-79BE-4FE1-ADDC-6342EEE6EA87">
                     <table cellpadding="4" cellspacing="0" class="FormalWide" title="" width="100%" border="1" summary="Describes RMAN command parameters" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="30%" id="d91517e226">语法元素</th>
                              <th align="left" valign="bottom" width="70%" id="d91517e229">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="30%" id="d91517e234" headers="d91517e226 ">
                                 <p><code class="codeph">附加</code></p>
                              </td>
                              <td align="left" valign="top" width="70%" headers="d91517e234 d91517e229 ">
                                 <p>导致新输出附加到消息日志文件的末尾。如果未指定此参数，并且存在与消息日志文件同名的文件，则RMAN将覆盖该文件。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="30%" id="d91517e242" headers="d91517e226 ">
                                 <p><code class="codeph">CHECKSYNTAX</code> 
                                 </p>
                              </td>
                              <td align="left" valign="top" width="70%" headers="d91517e242 d91517e229 ">
                                 <p>导致RMAN以检查语法错误的方式启动，但不执行其他处理（请参阅<a href="RMAN.html#GUID-E5514ACB-59F6-4DB0-B4DB-64DF4C87CDE7__CHDCGAGH">示例3-51</a> ）。如果与<code class="codeph">CMDFILE</code>或<code class="codeph">@</code>参数一起使用，则RMAN客户端启动，检查文件中的所有命令，然后退出。如果在未指定命令文件的情况下使用，则RMAN会提示用户输入并解析每个命令，直到用户退出RMAN客户端。
                                 </p>
                                 <p>RMAN报道了一个<a id="d91517e260" class="indexterm-anchor"></a><a id="d91517e262" class="indexterm-anchor"></a>每个命令的<code class="codeph">RMAN-0558</code>错误在语法上都不正确。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="30%" id="d91517e270" headers="d91517e226 ">
                                 <p><code class="codeph">AUXILIARY</code> <span class="italic"><code class="codeph"><a href="connectStringSpec.html#GUID-DAA7D54B-1954-4AA3-A423-E1AB9F68A2FD">connectStringSpec</a></code></span></p>
                              </td>
                              <td align="left" valign="top" width="70%" headers="d91517e270 d91517e229 ">
                                 <p>指定辅助数据库的连接字符串，例如<code class="codeph">AUXILIARY</code> <code class="codeph">sbu@dupdb</code> 。
                                 </p>
                                 <p><span class="bold">另请参见：</span> <span class="italic"><code class="codeph"><a href="connectStringSpec.html#GUID-DAA7D54B-1954-4AA3-A423-E1AB9F68A2FD">connectStringSpec</a></code></span></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="30%" id="d91517e299" headers="d91517e226 ">
                                 <p><code class="codeph">CATALOG</code> <span class="italic"><code class="codeph"><a href="connectStringSpec.html#GUID-DAA7D54B-1954-4AA3-A423-E1AB9F68A2FD">connectStringSpec</a></code></span></p>
                              </td>
                              <td align="left" valign="top" width="70%" headers="d91517e299 d91517e229 ">
                                 <p>指定包含恢复目录的数据库的连接字符串，例如<code class="codeph">CATALOG</code> <code class="codeph">rco@inst2</code> 。
                                 </p>
                                 <p><span class="bold">另请参见：</span> <span class="italic"><code class="codeph"><a href="connectStringSpec.html#GUID-DAA7D54B-1954-4AA3-A423-E1AB9F68A2FD">connectStringSpec</a></code></span></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="30%" id="d91517e328" headers="d91517e226 ">
                                 <p><code class="codeph">CMDFILE</code> <span class="italic"><code class="codeph">filename</code></span></p>
                              </td>
                              <td align="left" valign="top" width="70%" headers="d91517e328 d91517e229 ">
                                 <p>解析并编译文件中的所有RMAN命令，然后按顺序执行文件中的每个命令。如果在解析阶段遇到语法错误或者在执行阶段遇到运行时错误，则RMAN退出。如果未找到任何错误，则在作业完成后退出RMAN。</p>
                                 <p>如果文件名的第一个字符是字母，则可以省略文件名周围的引号。命令文件的内容与在RMAN提示符下输入的命令相同。</p>
                                 <p><span class="bold">注：</span>如果您在RMAN提示符，而不是作为操作系统的命令行选项运行命令文件，然后RMAN <span class="italic">不</span>运行该文件作为一个单一的作业。RMAN按顺序读取每一行并执行它，仅在到达脚本的最后一行时退出。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="30%" id="d91517e349" headers="d91517e226 ">
                                 <p><code class="codeph">@</code> <span class="italic"><code class="codeph">filename</code></span></p>
                              </td>
                              <td align="left" valign="top" width="70%" headers="d91517e349 d91517e229 ">
                                 <p>相当于<code class="codeph">CMDFILE</code> 。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="30%" id="d91517e363" headers="d91517e226 "><code class="codeph">   </code> <code class="codeph">{</code> <span class="italic"><code class="codeph">string_or_identifier</code></span> <code class="codeph">|</code> <span class="italic"><code class="codeph">integer</code></span> <code class="codeph">}</code></td>
                              <td align="left" valign="top" width="70%" headers="d91517e363 d91517e229 ">
                                 <p>相当于<code class="codeph">USING</code>语法后指定的选项。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="30%" id="d91517e385" headers="d91517e226 ">
                                 <p><code class="codeph">LOG</code> <span class="italic"><code class="codeph">filename</code></span></p>
                              </td>
                              <td align="left" valign="top" width="70%" headers="d91517e385 d91517e229 ">
                                 <p>指定RMAN记录其输出的文件，即已处理的命令及其结果。RMAN在提示符处显示命令输入，但不显示写入日志文件的命令输出。默认情况下，RMAN将其消息日志文件写入标准输出。</p>
                                 <p>RMAN输出也存储在<a id="d91517e398" class="indexterm-anchor"></a><a id="d91517e400" class="indexterm-anchor"></a> <code class="codeph">V$RMAN_OUTPUT</code>视图，它是正在进行的作业的内存专用视图<a id="d91517e407" class="indexterm-anchor"></a><a id="d91517e409" class="indexterm-anchor"></a> <code class="codeph">V$RMAN_STATUS</code> ，它是已完成作业和正在进行的作业的控制文件视图。
                                 </p>
                                 <p>如果无法打开指定的文件， <code class="codeph">LOG</code>参数不会导致RMAN终止。相反，RMAN写入标准输出。
                                 </p>
                                 <p><span class="bold">注意：</span>将RMAN输出发送到日志文件和标准输出的最简单方法是使用Linux <a id="d91517e425" class="indexterm-anchor"></a> <code class="codeph">tee</code>命令或其等价物。例如：</p><pre class="oac_no_warn" dir="ltr">％rman | tee rman.log</pre></td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="30%" id="d91517e433" headers="d91517e226 ">
                                 <p><code class="codeph">MSGNO</code></p>
                              </td>
                              <td align="left" valign="top" width="70%" headers="d91517e433 d91517e229 ">
                                 <p>使RMAN打印消息号，即<code class="codeph">RMAN-</code> <span class="italic"><code class="codeph">xxxx</code></span> ，以输出所有命令。默认情况下，RMAN不打印<code class="codeph">RMAN-</code> <span class="italic"><code class="codeph">xxxx</code></span>前缀。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="30%" id="d91517e453" headers="d91517e226 ">
                                 <p><code class="codeph">NOCATALOG</code></p>
                              </td>
                              <td align="left" valign="top" width="70%" headers="d91517e453 d91517e229 ">
                                 <p>表示您使用的是没有恢复目录的RMAN。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="30%" id="d91517e461" headers="d91517e226 ">
                                 <p><code class="codeph">SEND</code> <code class="codeph">'</code> <span class="italic"><code class="codeph">command</code></span> <code class="codeph">'</code></p>
                              </td>
                              <td align="left" valign="top" width="70%" headers="d91517e461 d91517e229 ">
                                 <p>将特定于供应商的命令字符串发送到所有已分配的通道。</p>
                                 <p><span class="bold">另请参阅：</span>您的媒体管理文档，以确定是否支持此功能，以及<code class="codeph"><a href="SEND.html#GUID-4AD68AC8-1A0A-4FDC-90D5-BDA278393D97">SEND</a></code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="30%" id="d91517e486" headers="d91517e226 ">
                                 <p><code class="codeph">PIPE</code> <span class="italic"><code class="codeph">pipe_name</code></span></p>
                              </td>
                              <td align="left" valign="top" width="70%" headers="d91517e486 d91517e229 ">
                                 <p>调用RMAN管道接口。RMAN使用两个公共管道：一个用于接收命令，另一个用于发送输出。管道的名称是从<code class="codeph">PIPE</code>参数的值派生的。例如，您可以使用以下选项调用RMAN管道接口： <code class="codeph">PIPE rpi TARGET /</code> 。
                                 </p>
                                 <p>RMAN在目标数据库中打开以下管道：</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p><code class="codeph">ORA$RMAN_RPI_IN</code> ，RMAN用于接收用户命令</p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">ORA$RMAN_RPI_OUT</code> ，RMAN用于发送所有输出</p>
                                    </li>
                                 </ul>
                                 <p>输入和输出管道上的所有消息都是<code class="codeph">VARCHAR2</code>类型。
                                 </p>
                                 <p><span class="bold">另请参阅：</span> <a href="../bradv/getting-started-rman.html#BRADV130" target="_blank"><span><cite>Oracle数据库备份和恢复用户指南</cite></span></a> ，了解如何通过管道将命令传递给RMAN</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="30%" id="d91517e532" headers="d91517e226 ">
                                 <p><code class="codeph">SCRIPT</code> <span class="italic"><code class="codeph">script_name</code></span></p>
                              </td>
                              <td align="left" valign="top" width="70%" headers="d91517e532 d91517e229 ">
                                 <p>指定存储脚本的名称。</p>
                                 <p>连接到目标数据库和恢复目录（必须使用<code class="codeph">TARGET</code>和<code class="codeph">CATALOG</code>选项指定）后，RMAN将针对目标数据库从恢复目录运行命名的存储脚本。如果目标数据库上存在名为<span class="italic"><code class="codeph">script_name</code></span>的全局脚本和本地存储脚本，则RMAN将运行本地脚本。
                                 </p>
                                 <p>当脚本名称以数字开头或者是RMAN保留字时，需要存储脚本名称周围的单引号（请参阅<span class="q">“ <a href="about-rman-commands.html#GUID-0EBC8675-D9D1-4E67-AA2A-4991C79E1675" title="RMAN语言包含在RMAN命令中使用或已经使用的保留字。通常，避免使用与RMAN命令语言中的主要含义冲突的保留字。">RMAN保留字</a> ”</span> ）。避免使用这样的名字。
                                 </p>
                                 <p><span class="bold">另请参阅：</span> <code class="codeph"><a href="CREATE-SCRIPT.html#GUID-4741C1E1-C365-4597-BF2F-8679145B4946">CREATE SCRIPT</a></code>以获取有关存储脚本的更多详细信息</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="30%" id="d91517e575" headers="d91517e226 ">
                                 <p><code class="codeph">TARGET</code> <span class="italic"><code class="codeph"><a href="connectStringSpec.html#GUID-DAA7D54B-1954-4AA3-A423-E1AB9F68A2FD">connectStringSpec</a></code></span></p>
                              </td>
                              <td align="left" valign="top" width="70%" headers="d91517e575 d91517e229 ">
                                 <p>指定目标数据库的连接字符串，例如<code class="codeph">TARGET /</code> 。
                                 </p>
                                 <p><span class="bold">另请参见：</span> <span class="italic"><code class="codeph"><a href="connectStringSpec.html#GUID-DAA7D54B-1954-4AA3-A423-E1AB9F68A2FD">connectStringSpec</a></code></span></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="30%" id="d91517e601" headers="d91517e226 ">
                                 <p><code class="codeph">TIMEOUT</code> <span class="italic"><code class="codeph">integer</code></span></p>
                              </td>
                              <td align="left" valign="top" width="70%" headers="d91517e601 d91517e229 ">
                                 <p>如果RMAN在<span class="italic"><code class="codeph">integer</code></span>秒内未从输入管道接收输入，则会导致RMAN自动退出。使用<code class="codeph">TIMEOUT</code>时必须指定<code class="codeph">PIPE</code>参数。</p>
                                 <p><span class="bold">另请参阅：</span> <a href="../bradv/getting-started-rman.html#BRADV130" target="_blank"><span><cite>Oracle数据库备份和恢复用户指南</cite></span></a> ，了解如何通过管道将命令传递给RMAN</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="30%" id="d91517e633" headers="d91517e226 ">
                                 <p><code class="codeph">USING</code> <code class="codeph">{</code> <span class="italic"><code class="codeph">string_or_identifier</code></span> <code class="codeph">|</code> <span class="italic"><code class="codeph">integer</code></span> <code class="codeph">}</code></p>
                              </td>
                              <td align="left" valign="top" width="70%" headers="d91517e633 d91517e229 ">
                                 <p>指定一个或多个值，用于命令文件中的替换变量。与SQL * Plus一样， <code class="codeph">&amp;1</code>表示放置第一个值的位置， <code class="codeph">&amp;2</code>表示放置第二个值的位置，依此类推。<a href="RMAN.html#GUID-E5514ACB-59F6-4DB0-B4DB-64DF4C87CDE7__CHDIAFGG">示例3-50</a>说明了如何将<code class="codeph">USING</code>子句中指定的值传递给RMAN命令文件。
                                 </p>
                                 <p>替换变量语法是<code class="codeph">&amp;</code> <span class="italic"><code class="codeph">integer</code></span>后跟可选的点，例如<code class="codeph">&amp;1.3</code> 。可选的点是变量的一部分，并替换为值，从而使替换文本紧跟另一个整数。例如，如果将值<code class="codeph">mybackup</code>传递给包含替换变量<code class="codeph">&amp;1.3</code>的命令文件，则替换的结果为<code class="codeph">mybackup3</code> 。
                                 </p>
                                 <p><span class="bold">另请参阅：</span> <code class="codeph"><a href="EXECUTE-SCRIPT.html#GUID-553B5C55-0BA6-4B47-86A9-0BCF839CCE04">EXECUTE SCRIPT</a></code> ，了解在执行存储脚本时如何指定<code class="codeph">USING</code>子句</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-E5514ACB-59F6-4DB0-B4DB-64DF4C87CDE7__GUID-32FB91F3-B3CC-42EF-A1F2-F1BBDE09CA27">例子</p>
               </div>
               <!-- class="section" -->
               <div class="example" id="GUID-E5514ACB-59F6-4DB0-B4DB-64DF4C87CDE7__CHDIIDEJ">
                  <p class="titleinexample">示例3-48在默认NOCATALOG模式下将RMAN连接到目标数据库</p>
                  <p>在此示例中，您启动RMAN客户端，而不在操作系统提示符处指定数据库连接选项。在RMAN提示符下，运行<code class="codeph">CONNECT</code>命令以连接到目标数据库。由于<code class="codeph"><a href="CONNECT.html#GUID-64ECF1B8-4F70-413E-BEBE-1D5E8CD48B67">CONNECT</a></code> <code class="codeph">CATALOG</code>未在RMAN提示符下运行，因此当运行需要存储库连接的第一个命令时，RMAN以默认的<code class="codeph">NOCATALOG</code>模式连接，在本例中为<code class="codeph">BACKUP DATABASE</code>命令。
                  </p><pre class="oac_no_warn" dir="ltr">％rman RMAN&gt; CONNECT TARGET / RMAN&gt; BACKUP DATABASE;</pre></div>
               <!-- class="example" -->
               <div class="example" id="GUID-E5514ACB-59F6-4DB0-B4DB-64DF4C87CDE7__GUID-1FA522DE-A267-443F-86FC-0A9AC3D4D7ED">
                  <p class="titleinexample">示例3-49将RMAN连接到辅助数据库实例</p>
                  <p>此示例使用网络服务名称连接到目标数据库<code class="codeph">prod</code>和恢复目录数据库<code class="codeph">catdb</code> ，并使用操作系统身份验证连接到辅助数据库实例。 <code class="codeph">sbu</code>是被授予<code class="codeph">SYSBACKUP</code>权限的用户。
                  </p><pre class="oac_no_warn" dir="ltr">$ <span class="bold">RMAN TARGET“sbu @ prod AS SYSBACKUP”</span>恢复管理器：版本12.1.0.1.0  - 生产于2013年1月16日星期三09:29:02版权所有（c）1982,2013，Oracle和/或其附属公司。版权所有。目标数据库密码：连接到目标数据库的<span class="italic"><span class="bold">密码</span></span> ：REL12（DBID = 3152825380）RMAN&gt; <span class="bold">CONNECT CATALOG rco @ catdb</span>恢复目录数据库密码：连接到恢复目录数据库的<span class="italic"><span class="bold">密码</span></span> RMAN&gt; <span class="bold">CONNECT AUXILIARY /</span>连接到辅助数据库：REL12（DBID = 3152825380）</pre></div>
               <!-- class="example" -->
               <div class="example" id="GUID-E5514ACB-59F6-4DB0-B4DB-64DF4C87CDE7__CHDIAFGG">
                  <p class="titleinexample">示例3-50指定替换变量</p>
                  <p>假设您要创建备份数据库的Linux shell脚本。您希望使用shell变量，以便可以在运行时将参数传递给RMAN备份脚本。替换变量解决了这个问题。首先，使用以下内容创建名为<code class="codeph">whole_db.cmd</code>的命令文件：</p><pre class="oac_no_warn" dir="ltr">cat&gt; /tmp/whole_db.cmd &lt;&lt; EOF＃name：whole_db.cmd CONNECT TARGET / BACKUP TAG＆1 COPIES＆2 DATABASE FORMAT'/ disk2 / db_％U';出口; EOF</pre><p>接下来，编写以下Linux shell脚本，该脚本设置<code class="codeph">csh</code> shell变量<code class="codeph">tagname</code>和<code class="codeph">copies</code> 。shell脚本启动RMAN，连接到目标数据库<code class="codeph">prod1</code> ，并运行<code class="codeph">whole_db.cmd</code> 。<code class="codeph">USING</code>子句传递变量<code class="codeph">tagname</code>的值，并在执行时<code class="codeph">copies</code>到RMAN命令文件。
                  </p><pre class="oac_no_warn" dir="ltr">＃！/ bin / csh #name：runbackup.sh #use：使用标签名称和副本数作为参数set tagname = $ argv [1] set copies = $ argv [2] rman @'/ tmp / whole_db.cmd'Using $ tagname $ copies LOG /tmp/runbackup.out#前一行相当于：#rman @'/ tmp / whole_db.cmd'$ tagname $ copies LOG /tmp/runbackup.out</pre><p>最后，从Linux shell执行shell脚本<code class="codeph">runbackup.sh</code> ，如下所示，使用标记<code class="codeph">Q106</code>创建数据库的两个备份：</p><pre class="oac_no_warn" dir="ltr">％runbackup.sh Q106 2</pre></div>
               <!-- class="example" -->
               <div class="example" id="GUID-E5514ACB-59F6-4DB0-B4DB-64DF4C87CDE7__CHDCGAGH">
                  <p class="titleinexample">示例3-51检查命令文件的语法</p>
                  <p>假设您创建命令文件<code class="codeph">backup_db.cmd</code> ，如下所示：</p><pre class="oac_no_warn" dir="ltr">cat&gt; /tmp/backup_db.cmd &lt;&lt; EOF CONNECT TARGET / BACKUP DATABASE;出口; EOF</pre><p>以下示例检查命令文件<code class="codeph">backup_db.cmd</code>的内容语法（包括示例输出）：</p><pre class="oac_no_warn" dir="ltr">％rman CHECKSYNTAX @'/ tmp / backup_db.cmd'恢复管理器：版本12.1.0.1.0  - 生产于1月16日星期三17:51:30 2013版权所有（c）1982,2013，Oracle和/或其附属公司。版权所有。RMAN&gt; CONNECT TARGET * 2&gt; BACKUP DATABASE; 3&gt;退出; cmdfile没有语法错误Recovery Manager完成。</pre></div>
               <!-- class="example" -->
               <div class="example" id="GUID-E5514ACB-59F6-4DB0-B4DB-64DF4C87CDE7__GUID-D8D18288-98B9-472A-8287-E2183A293AD0">
                  <p class="titleinexample">示例3-52运行存储的脚本并将输出附加到消息日志</p>
                  <p>此示例使用操作系统身份验证连接到目标数据库，然后运行存储的脚本<code class="codeph">wdbb</code> 。RMAN将输出写入消息log <code class="codeph">/tmp/wdbb.log</code> 。
                  </p><pre class="oac_no_warn" dir="ltr">％rman TARGET / SCRIPT wdbb LOG /tmp/wdbb.log</pre></div>
               <!-- class="example" -->
               <div class="example" id="GUID-E5514ACB-59F6-4DB0-B4DB-64DF4C87CDE7__GUID-B62D87E4-E420-4DAA-B463-CFFA1BF8A2B6">
                  <p class="titleinexample">示例3-53调用RMAN管道接口</p>
                  <p>此示例使用90秒超时选项调用RMAN管道<code class="codeph">newpipe</code> 。
                  </p><pre class="oac_no_warn" dir="ltr">％rman PIPE newpipe TARGET / TIMEOUT 90</pre></div>
               <!-- class="example" -->
            </div>
         </div>
      </article>
   </body>
</html>