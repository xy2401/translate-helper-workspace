<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="You can create backup strategies using Oracle Recovery Manager (RMAN) with Oracle Data Guard and standby databases."></meta>
      <meta name="description" content="You can create backup strategies using Oracle Recovery Manager (RMAN) with Oracle Data Guard and standby databases."></meta>
      <title>使用RMAN备份和还原文件</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Concepts and Administration "></meta>
      <meta property="og:description" content="You can create backup strategies using Oracle Recovery Manager (RMAN) with Oracle Data Guard and standby databases."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Concepts and Administration"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="data-guard-concepts-and-administration.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-02-12T10:50:21-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="1999, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96244-02"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="managing-oracle-data-guard-logical-standby-databases.html" title="Previous" type="text/html"></link>
      <link rel="next" href="using-sql-apply-to-perform-rolling-upgrade.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Data Guard Concepts and Administration"></meta>
    <meta name="dcterms.isVersionOf" content="SBYDB"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="managing-oracle-data-guard-logical-standby-databases.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="using-sql-apply-to-perform-rolling-upgrade.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">概念和管理</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="oracle-data-guard-concepts.html" property="item" typeof="WebPage"><span property="name">概念和管理</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">使用RMAN备份和还原文件</li>
            </ol>
            <a id="GUID-516D9C60-F2EF-4822-BB87-5D3BE877B69B" name="GUID-516D9C60-F2EF-4822-BB87-5D3BE877B69B"></a><a id="SBYDB04700"></a>
            
            <h2 id="SBYDB-GUID-516D9C60-F2EF-4822-BB87-5D3BE877B69B" class="sect2"><span class="enumeration_chapter">12</span>使用RMAN备份和还原文件</h2>
         </header>
         <div class="ind">
            <div>
               <p>您可以使用带有Oracle Data Guard和备用数据库的Oracle Recovery Manager（RMAN）创建备份策略。</p>
               <p>RMAN可以对主数据库执行最小影响的备份，并可以快速从丢失单个数据文件或整个数据库中恢复。RMAN和Oracle Data Guard可以一起使用，以简化Oracle Data Guard配置的管理。</p>
               <p>请参阅以下主题：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="using-RMAN-in-oracle-data-guard-configurations.html#GUID-7B0909F0-2DEA-4A16-8E91-A4687F634D4E" title="RMAN使用恢复目录来跟踪Oracle Data Guard环境中所有数据库文件的文件名。">关于Oracle Data Guard配置中的RMAN文件管理</a></p>
                  </li>
                  <li>
                     <p><a href="using-RMAN-in-oracle-data-guard-configurations.html#GUID-8D525402-9629-44EC-A3F1-F6B8C3307E8C" title="在Oracle Data Guard配置中，可以将备份控制文件，数据文件和存档日志的过程卸载到备用系统，从而最大限度地减少备份对生产系统的影响。">关于Oracle Data Guard环境中的RMAN配置</a></p>
                  </li>
                  <li>
                     <p><a href="using-RMAN-in-oracle-data-guard-configurations.html#GUID-33B70E30-2454-484C-9110-A5AC452E63CB" title="这些配置可以简化备份和恢复操作。">推荐的RMAN和Oracle数据库配置</a></p>
                  </li>
                  <li>
                     <p><a href="using-RMAN-in-oracle-data-guard-configurations.html#GUID-410FEFAD-7805-405A-8C02-B9D8F74C60F4" title="您可以使用RMAN脚本和过程在Oracle Data Guard配置中备份Oracle数据库。">备份程序</a></p>
                  </li>
                  <li>
                     <p><a href="using-RMAN-in-oracle-data-guard-configurations.html#GUID-9C54A243-6B84-4755-957E-AFC57B9BC3B6" title="必须使用REGISTER DATABASE命令仅显式注册主数据库。将RMAN连接到恢复目录和主数据库作为TARGET后执行此操作。">在Oracle Data Guard环境中注册和取消注册数据库</a></p>
                  </li>
                  <li>
                     <p><a href="using-RMAN-in-oracle-data-guard-configurations.html#GUID-D13E9A5E-5DBB-4DF4-8534-F1E16FA33618" title="将RMAN LIST，REPORT和SHOW命令与FOR DB_UNIQUE_NAME子句一起使用可以查看有关特定数据库的信息。">在Oracle Data Guard环境中报告</a></p>
                  </li>
                  <li>
                     <p><a href="using-RMAN-in-oracle-data-guard-configurations.html#GUID-4B1696A8-1A90-426C-A620-D5F313365E54" title="Oracle Data Guard环境中的文件（数据文件，存档日志，备份片，映像副本和代理副本）通过使用DB_UNIQUE_NAME参数与数据库关联。">在Oracle Data Guard环境中执行备份维护</a></p>
                  </li>
                  <li>
                     <p><a href="using-RMAN-in-oracle-data-guard-configurations.html#GUID-44539CC5-0BAB-47F8-B51F-BFD0A1D6DA40" title="这些是Oracle Data Guard环境中可能发生的一些恢复方案。">Oracle Data Guard环境中的恢复方案</a></p>
                  </li>
                  <li>
                     <p><a href="using-RMAN-in-oracle-data-guard-configurations.html#GUID-211E08A4-C19E-4159-80B2-429431314278" title="您可以修改其他配置的备份过程，例如备用数据库和主数据库无法共享备份文件时;备用实例仅用于远程存档重做日志文件;或者备用数据库文件名与主数据库不同。">其他备份情况</a></p>
                  </li>
                  <li>
                     <p><a href="using-RMAN-in-oracle-data-guard-configurations.html#GUID-F0EB4F8E-7D2F-4674-9A5B-AABC368D8F11" title="从Oracle Database 12c开始，RMAN允许您通过网络连接到包含所需文件的物理备用数据库来还原或恢复文件。">通过网络恢复和恢复文件</a></p>
                  </li>
                  <li>
                     <p><a href="using-RMAN-in-oracle-data-guard-configurations.html#GUID-72F008A1-527F-41DB-89CD-623FA06D0420" title="RMAN支持备用数据库中多租户容器数据库（CDB）的时间点恢复（PITR）。（单个可插拔数据库（PDB）没有自己的备用数据库。）">RMAN在Oracle Data Guard环境中对CDB的支持</a></p>
                  </li>
               </ul>
               <div class="infoboxnote" id="GUID-516D9C60-F2EF-4822-BB87-5D3BE877B69B__GUID-B845DC4E-2CDB-4220-9B4D-4BA79F9BAF8A">
                  <p class="notep1">注意：</p>
                  <p>由于逻辑备用数据库不是主数据库的块到块副本，因此无法使用逻辑备用数据库备份主数据库。</p>
               </div>
               <div class="infoboxnotealso" id="GUID-516D9C60-F2EF-4822-BB87-5D3BE877B69B__GUID-1E5E4442-BAC3-43B3-84FF-70E9B4E14E0A">
                  <p class="notep1">也可以看看：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=BRADV89346" target="_blank"><span class="italic">“Oracle数据库备份和恢复用户指南”</span></a> ，以获取有关RMAN概念以及在Oracle Data Guard环境中使用RMAN的更多信息</p>
                     </li>
                     <li>
                        <p>有关RMAN命令的详细信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=RCMRF001" target="_blank"><span class="italic">参见Oracle数据库备份和恢复参考</span></a></p>
                     </li>
                  </ul>
               </div>
            </div><a id="SBYDB4847"></a><div class="props_rev_3"><a id="GUID-7B0909F0-2DEA-4A16-8E91-A4687F634D4E" name="GUID-7B0909F0-2DEA-4A16-8E91-A4687F634D4E"></a><h3 id="SBYDB-GUID-7B0909F0-2DEA-4A16-8E91-A4687F634D4E" class="sect3"><span class="enumeration_section">12.1</span>关于Oracle Data Guard配置中的RMAN文件管理</h3>
               <div>
                  <p>RMAN使用恢复目录来跟踪Oracle Data Guard环境中所有数据库文件的文件名。</p>
                  <p>恢复目录是RMAN用于存储有关一个或多个Oracle数据库的元数据的数据库模式。该目录还记录了联机重做日志，备用重做日志，临时文件，归档重做日志，备份集和映像副本的创建位置。</p>
               </div><a id="SBYDB4848"></a><div class="props_rev_3"><a id="GUID-075FF361-A398-4533-9E7B-9255A288A662" name="GUID-075FF361-A398-4533-9E7B-9255A288A662"></a><h4 id="SBYDB-GUID-075FF361-A398-4533-9E7B-9255A288A662" class="sect4"><span class="enumeration_section">12.1.1</span> Oracle Data Guard环境中备份的可互换性</h4>
                  <div>
                     <p>RMAN命令使用恢复目录元数据在Oracle Data Guard环境中的不同物理数据库之间透明地运行。</p>
                     <p>例如，您可以备份物理备用数据库上的表空间，并在主数据库上还原和恢复它。同样，您可以备份主数据库上的表空间，并在物理备用数据库上还原和恢复它。</p>
                     <div class="infoboxnote" id="GUID-075FF361-A398-4533-9E7B-9255A288A662__GUID-C796926F-7651-4EE5-8CC6-B34FD5EC9145">
                        <p class="notep1">注意：</p>
                        <p>逻辑备用数据库的备份在主数据库中不可用。</p>
                     </div>
                     <p>备用控制文件和非备用控制文件的备份是可互换的。例如，您可以还原主数据库上的备用控制文件和物理备用数据库上的主控制文件。这种可互换性意味着您可以将控制文件备份卸载到Oracle Data Guard环境中的一个数据库。RMAN在数据库的还原和恢复期间自动更新数据库文件的文件名。</p>
                  </div>
               </div><a id="SBYDB4849"></a><div class="props_rev_3"><a id="GUID-73A75929-1F78-46F1-9CBE-EC2611388A6B" name="GUID-73A75929-1F78-46F1-9CBE-EC2611388A6B"></a><h4 id="SBYDB-GUID-73A75929-1F78-46F1-9CBE-EC2611388A6B" class="sect4"><span class="enumeration_section">12.1.2</span> Oracle Data Guard环境中的备份关联</h4>
                  <div>
                     <p>恢复目录通过将每个数据库文件或备份文件与<code class="codeph">DB_UNIQUE_NAME</code>相关联来跟踪Oracle Data Guard环境中的文件。</p>
                     <p>创建文件的数据库与该文件相关联。例如，如果RMAN使用唯一名称<code class="codeph">standby1</code>备份数据库，则<code class="codeph">standby1</code>与此备份关联。除非您使用<code class="codeph">CHANGE</code> ，否则备份仍与创建它的数据库相关联<code class="codeph">...RESET DB_UNIQUE_NAME</code>将备份与其他数据库关联。
                     </p>
                  </div>
               </div><a id="SBYDB4850"></a><div class="props_rev_3"><a id="GUID-61ABB2C2-0813-4DD9-94F4-BB292CB21194" name="GUID-61ABB2C2-0813-4DD9-94F4-BB292CB21194"></a><h4 id="SBYDB-GUID-61ABB2C2-0813-4DD9-94F4-BB292CB21194" class="sect4"><span class="enumeration_section">12.1.3</span> Oracle Data Guard环境中备份的可访问性</h4>
                  <div>
                     <p>默认情况下，在Oracle Data Guard环境中，恢复目录将磁盘备份视为仅对与其关联的数据库可访问，而在一个数据库上创建的磁带备份可供所有数据库访问。</p>
                     <div class="p">您可以使用以下RMAN命令覆盖默认行为：<pre class="pre codeblock"><code>为设备类型设置备份文件类型device_specifier TO [NOTACCESSIBLE |无障碍]</code></pre>可访问性设置位于会话级别，这意味着在断开RMAN会话后，备份关联将恢复为默认行为。</div>
                     <p>如果备份文件未与任何数据库关联，则在恢复目录视图中描述它的行对于<code class="codeph">SITE_KEY</code>列显示为<code class="codeph">null</code> 。默认情况下，RMAN将<code class="codeph">SITE_KEY</code>为<code class="codeph">null</code>文件与目标数据库关联。
                     </p>
                     <p>RMAN命令（如<code class="codeph">BACKUP</code> ， <code class="codeph">RESTORE</code>和<code class="codeph">CROSSCHECK</code>可用于任何可访问的备份。例如，对于<code class="codeph">RECOVER COPY</code>操作，RMAN仅将与数据库关联的映像副本视为可以恢复。RMAN认为磁盘和磁带上的增量备份有资格恢复映像副本。在数据库恢复中，RMAN仅考虑与数据库关联的磁盘备份以及磁带上的所有文件都有资格恢复。
                     </p>
                     <p>为了说明备份可访问性的差异，假设数据库<code class="codeph">prod</code>和<code class="codeph">standby1</code>驻留在不同的主机上。RMAN将<code class="codeph">prod</code>上的数据文件1备份到生产主机上的<code class="codeph">/prmhost/disk1/df1.dbf</code> ，也备份到磁带。RMAN备份数据文件1上<code class="codeph">standby1</code>到<code class="codeph">/sbyhost/disk2/df1.dbf</code>备用主机上，并且还到磁带上。如果RMAN连接到数据库<code class="codeph">prod</code> ，则无法使用RMAN命令对备用主机上的<code class="codeph">/sbyhost/disk2/df1.dbf</code>备份执行操作。然而，RMAN会考虑上所做的磁带备份<code class="codeph">standby1</code>有资格得到恢复。
                     </p>
                     <div class="infoboxnote" id="GUID-61ABB2C2-0813-4DD9-94F4-BB292CB21194__GUID-77DE5DBE-E968-43BC-AF85-42BF02FF27C4">
                        <p class="notep1">注意：</p>
                        <p>您可以将备份从备用主机FTP到主要主机，反之亦然，将<code class="codeph">TARGET</code>作为<code class="codeph">TARGET</code>连接到此主机上的数据库，然后对备份进行<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=RCMRF109" target="_blank"><code class="codeph">CATALOG</code></a> 。在目标数据库对文件进行编目之后，该文件将与目标数据库关联。
                        </p>
                     </div>
                  </div>
               </div>
            </div><a id="SBYDB4851"></a><div class="props_rev_3"><a id="GUID-8D525402-9629-44EC-A3F1-F6B8C3307E8C" name="GUID-8D525402-9629-44EC-A3F1-F6B8C3307E8C"></a><h3 id="SBYDB-GUID-8D525402-9629-44EC-A3F1-F6B8C3307E8C" class="sect3"><span class="enumeration_section">12.2</span>关于Oracle Data Guard环境中的RMAN配置</h3>
               <div>
                  <p>在Oracle Data Guard配置中，可以将备份控制文件，数据文件和存档日志的过程卸载到备用系统，从而最大限度地减少备份对生产系统的影响。</p>
                  <p>这些备份可用于恢复主数据库或备用数据库。</p>
                  <p>RMAN使用<code class="codeph">DB_UNIQUE_NAME</code>初始化参数将一个数据库站点与另一个数据库站点区分开来。因此，在Oracle Data Guard配置中维护<code class="codeph">DB_UNIQUE_NAME</code>的唯一性至关重要。
                  </p>
                  <p>必须使用RMAN <code class="codeph">REGISTER DATABASE</code>命令仅显式注册主数据库。将RMAN连接到恢复目录和主数据库作为目标后，可以执行此操作。
                  </p>
                  <p>使用RMAN <code class="codeph">CONFIGURE</code>命令设置RMAN配置。当<code class="codeph">CONFIGURE</code>命令与<code class="codeph">FOR DB_UNIQUE_NAME</code>选项一起使用时，它会使用您指定的DB_UNIQUE_NAME为数据库设置RMAN特定于站点的配置。
                  </p>
                  <p>例如，在连接到恢复目录后，可以在RMAN提示符处使用以下命令，将DBID为1625818158的<code class="codeph">BOSTON</code>数据库的默认设备类型设置为<code class="codeph">SBT</code> 。仅当您未作为目标连接到数据库时，才需要RMAN <code class="codeph">SET DBID</code>命令。
                  </p><pre class="oac_no_warn" dir="ltr">SET DBID 1625818158;为DB_UNIQUE_NAME波士顿配置默认设备类型为SBT;</pre></div>
            </div><a id="SBYDB5054"></a><a id="SBYDB4852"></a><div class="props_rev_3"><a id="GUID-33B70E30-2454-484C-9110-A5AC452E63CB" name="GUID-33B70E30-2454-484C-9110-A5AC452E63CB"></a><h3 id="SBYDB-GUID-33B70E30-2454-484C-9110-A5AC452E63CB" class="sect3"><span class="enumeration_section">12.3</span>推荐的RMAN和Oracle数据库配置</h3>
               <div>
                  <p>这些配置可以简化备份和恢复操作。</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="using-RMAN-in-oracle-data-guard-configurations.html#GUID-B7FFF73A-B8C0-49DD-8404-F6FE9F784C41" title="建议在Oracle Data Guard环境中的每个主数据库和备用数据库上使用这些Oracle数据库配置。">主数据库和备用数据库上的Oracle数据库配置</a></p>
                     </li>
                     <li>
                        <p><a href="using-RMAN-in-oracle-data-guard-configurations.html#GUID-2AEB88E7-075F-47F4-BBCE-77B274A50683" title="为了简化RMAN的持续使用，您可以在Oracle Data Guard环境中为每个数据库设置许多持久性配置设置。">主数据库中的RMAN配置</a></p>
                     </li>
                     <li>
                        <p><a href="using-RMAN-in-oracle-data-guard-configurations.html#GUID-FBB66066-8FD4-4328-9AF2-0D7625803FDB" title="建议在备份数据库中执行这些RMAN配置。">备份数据库中执行备份的RMAN配置</a></p>
                     </li>
                     <li>
                        <p><a href="using-RMAN-in-oracle-data-guard-configurations.html#GUID-F4CD9CD2-1006-409F-92D8-909114931B06" title="建议在未完成备份的备用数据库中使用这些RMAN配置。">处于待机状态的RMAN配置未执行备份</a></p>
                     </li>
                  </ul>
                  <div class="section">
                     <p class="subhead2" id="GUID-33B70E30-2454-484C-9110-A5AC452E63CB__GUID-B9B1D627-EC55-4F67-AAAE-55DB07E2BECA">配置假设</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>这些配置做出以下假设：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>备用数据库是物理备用数据库，仅在备用数据库上进行备份。如果在主数据库和备用数据库上都进行了<a href="using-RMAN-in-oracle-data-guard-configurations.html#GUID-75F78440-2A7C-4FDC-AFF9-CABB440CB651" title="If the standby databases are far apart from one another, then the backups taken on them may not be easily accessible by the primary system or other standby systems.">备份</a> ，请参阅<a href="using-RMAN-in-oracle-data-guard-configurations.html#GUID-75F78440-2A7C-4FDC-AFF9-CABB440CB651" title="如果备用数据库彼此相距很远，则主系统或其他备用系统可能无法轻松访问其上的备份。">备用数据库太地理位置远离共享备份</a>以进行程序更改。
                           </p>
                        </li>
                        <li>
                           <p>需要RMAN恢复目录，以便可以将在一个数据库服务器上执行的备份还原到另一个数据库服务器。仅将控制文件用作RMAN存储库是不够的，因为主数据库不了解备用数据库上的备份。</p>
                           <p>RMAN恢复目录在集中位置组织备份历史记录和其他与恢复相关的元数据。恢复目录在数据库中配置并维护备份元数据。恢复目录没有控制文件的空间限制，可以存储有关备份的更多历史数据。</p>
                           <p>建议在Oracle Data Guard配置中与主站点和备用站点物理分离的目录服务器，因为任一站点的灾难都不会影响恢复最新备份的能力。</p>
                           <div class="infoboxnotealso" id="GUID-33B70E30-2454-484C-9110-A5AC452E63CB__GUID-40CEB303-D9CD-43BE-B3EF-6D9368D1F439">
                              <p class="notep1">也可以看看：</p>
                              <p>有关管理恢复目录的详细信息，请参见<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=BRADV8015" target="_blank"><span class="italic">“Oracle数据库备份和恢复用户指南”</span></a></p>
                           </div>
                        </li>
                        <li>
                           <p>配置中的所有数据库都使用Oracle Database <span class="italic">11g</span>第1版（11.1）或更高版本。
                           </p>
                        </li>
                        <li>
                           <p>Oracle Secure Backup软件或第三方媒体管理软件配置了RMAN以备份到磁带。</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div><a id="SBYDB4853"></a><div class="props_rev_3"><a id="GUID-B7FFF73A-B8C0-49DD-8404-F6FE9F784C41" name="GUID-B7FFF73A-B8C0-49DD-8404-F6FE9F784C41"></a><h4 id="SBYDB-GUID-B7FFF73A-B8C0-49DD-8404-F6FE9F784C41" class="sect4"><span class="enumeration_section">12.3.1</span>主数据库和备用数据库上的Oracle数据库配置</h4>
                  <div>
                     <p>建议在Oracle Data Guard环境中的每个主数据库和备用数据库上使用这些Oracle数据库配置。</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>为每个数据库配置快速恢复区域（恢复区域是数据库的本地）。</p>
                           <p>快速恢复区域是文件系统或Oracle自动存储管理（Oracle ASM）磁盘组上的单个存储位置，其中包含恢复所需的所有文件。这些文件包括控制文件，存档日志，联机重做日志，闪回日志和RMAN备份。由于在快速恢复区域中创建了新备份和归档日志，因此会自动删除旧文件（保留期之外或已备份到第三级存储）以为其腾出空间。此外，可以设置通知以在快速恢复区域中的空间消耗接近其预定义限制时警告DBA。然后，DBA可以采取措施，例如增加恢复区空间限制，添加磁盘硬件或减少保留期。</p>
                           <p></p>
                           <p>设置以下初始化参数以配置快速恢复区域：</p><pre class="oac_no_warn" dir="ltr">DB_RECOVERY_FILE_DEST = &lt;文件系统位置或Oracle ASM磁盘组&gt; DB_RECOVERY_FILE_DEST_SIZE = &lt;磁盘空间配额&gt;</pre><div class="infoboxnotealso" id="GUID-B7FFF73A-B8C0-49DD-8404-F6FE9F784C41__GUID-C42B4850-3659-432F-A93B-C26A86C0F8D8">
                              <p class="notep1">也可以看看：</p>
                              <p>有关配置快速恢复区域的详细信息<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=BRADV8183" target="_blank"><span class="italic">，请参见“Oracle数据库备份和恢复用户指南”</span></a></p>
                           </div>
                        </li>
                        <li>
                           <p>使用服务器参数文件（SPFILE），以便可以备份它以在备份中保存实例参数。</p>
                        </li>
                        <li>
                           <p>在主数据库和备用数据库上启用闪回数据库。</p>
                           <p>启用闪回数据库后，Oracle数据库会在快速恢复区域中维护闪回日志。这些日志可用于将数据库回滚到较早的时间点，而无需完全还原。</p>
                           <div class="infoboxnotealso" id="GUID-B7FFF73A-B8C0-49DD-8404-F6FE9F784C41__GUID-A633BB4E-A8ED-4B72-AE87-D872ACAE1E31">
                              <p class="notep1">也可以看看：</p>
                              <p>有关启用闪回数据库的详细信息，请参见<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=BRADV595" target="_blank"><span class="italic">“Oracle数据库备份和恢复用户指南”</span></a></p>
                           </div>
                        </li>
                     </ul>
                  </div>
               </div><a id="SBYDB4854"></a><div class="props_rev_3"><a id="GUID-2AEB88E7-075F-47F4-BBCE-77B274A50683" name="GUID-2AEB88E7-075F-47F4-BBCE-77B274A50683"></a><h4 id="SBYDB-GUID-2AEB88E7-075F-47F4-BBCE-77B274A50683" class="sect4"><span class="enumeration_section">12.3.2</span>主数据库中的RMAN配置</h4>
                  <div>
                     <p>为了简化RMAN的持续使用，您可以在Oracle Data Guard环境中为每个数据库设置许多持久性配置设置。</p>
                     <div class="section">
                        <p>这些设置控制RMAN行为的许多方面。例如，您可以配置备份保留策略，备份到磁带或磁盘的默认目标，默认备份设备类型等。您可以使用<code class="codeph">CONFIGURE</code>命令设置和更改RMAN配置。建议在主数据库中使用以下RMAN配置：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>将RMAN连接到主数据库和恢复目录。</span></li>
                        <li class="stepexpand"><span>将数据库的保留策略配置为<span class="italic"><code class="codeph">n</code></span>天：</span><div><pre class="oac_no_warn" dir="ltr">配置保留政策，以恢复&lt;n&gt;天的窗口;</pre><p>通过此配置，您可以将执行数据库恢复所需的备份保留在指定天数内的任何时间点。</p>
                              <p>使用<code class="codeph">DELETE</code> <code class="codeph">OBSOLETE</code>命令删除任何不需要的备份（根据保留策略）以在指定的天数内执行恢复。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>使用<code class="codeph">CONFIGURE ARCHIVELOG DELETION POLICY</code>命令指定何时可以删除存档日志。例如，要在确保将日志<span class="italic">发送</span>到所有目标后删除日志，请使用以下配置：</span><div><pre class="oac_no_warn" dir="ltr">配置ARCHIVELOG删除政策运送到所有待机;</pre><p>要在确保将日志<span class="italic">应用于</span>所有备用目标后删除日志，请使用以下配置：</p><pre class="oac_no_warn" dir="ltr">配置ARCHIVELOG删除政策应用于所有待机;</pre></div>
                        </li>
                        <li class="stepexpand"><span>配置主数据库和所有备用数据库的连接字符串，以便在使用<code class="codeph">RESYNC CATALOG FROM DB_UNIQUE_NAME</code>命令时，RMAN可以远程连接并执行重新同步。连接到目标实例时，必须提供网络服务名称。即使完成重新同步的其他数据库实例位于本地主机上，此要求也适用。目标和远程实例必须使用相同的<code class="codeph">SYSDBA</code> （或<code class="codeph">SYSBACKUP</code> ）密码，这意味着两个实例必须已具有密码文件。您可以使用单个密码创建密码文件，以便可以使用该密码文件启动所有数据库实例。例如，如果要连接到Boston中的备用数据库的TNS别名是<code class="codeph">boston_conn_str</code> ，则可以使用以下命令配置<code class="codeph">BOSTON</code>数据库站点的连接标识符：</span><div><pre class="oac_no_warn" dir="ltr">配置DB_UNIQUE_NAME BOSTON CONNECT IDENTIFIER'boston_conn_str';</pre><p>请注意， <code class="codeph">'boston_conn_str'</code>不包含用户名和密码。它仅包含可从任何数据库站点用于连接到<code class="codeph">BOSTON</code>数据库站点的Oracle Net服务名称。
                              </p>
                              <p>为所有备用数据库配置连接标识符后，可以使用<code class="codeph">LIST DB_UNIQUE_NAME OF DATABASE</code>命令验证备用数据库列表。
                              </p>
                           </div>
                        </li>
                     </ol>
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-2AEB88E7-075F-47F4-BBCE-77B274A50683__GUID-81E4B6DA-3925-474F-8A46-792AC36955CF">
                           <p class="notep1">也可以看看：</p>
                           <p> </p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>有关RMAN配置的详细信息，请参见<a href="../bradv/configuring-rman-client-advanced.html#BRADV006" target="_blank"><span class="italic">“Oracle数据库备份和恢复用户指南”</span></a></p>
                              </li>
                              <li>
                                 <p>有关RMAN <code class="codeph">CONFIGURE</code>命令的详细信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=RCMRF113" target="_blank"><span class="italic">参见Oracle数据库备份和恢复参考</span></a></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="SBYDB4855"></a><div class="props_rev_3"><a id="GUID-FBB66066-8FD4-4328-9AF2-0D7625803FDB" name="GUID-FBB66066-8FD4-4328-9AF2-0D7625803FDB"></a><h4 id="SBYDB-GUID-FBB66066-8FD4-4328-9AF2-0D7625803FDB" class="sect4"><span class="enumeration_section">12.3.3</span>备份数据库中执行备份的RMAN配置</h4>
                  <div>
                     <p>建议在备份数据库中执行这些RMAN配置。</p>
                     <ol>
                        <li class="stepexpand"><span>将RMAN连接到备用数据库（执行备份的位置）作为目标，并连接到恢复目录。</span></li>
                        <li class="stepexpand"><span>启用控制文件和服务器参数文件的自动备份：</span><div><pre class="oac_no_warn" dir="ltr">配置CONTROLFILE AUTOBACKUP ON;</pre></div>
                        </li>
                        <li class="stepexpand"><span>跳过备份已存在具有相同检查点的有效备份的数据文件：</span><div><pre class="oac_no_warn" dir="ltr">配置备份优化;</pre></div>
                        </li>
                        <li class="stepexpand"><span>配置磁带通道以根据介质管理软件的要求创建备份：</span><div><pre class="oac_no_warn" dir="ltr">配置通道设备类型SBT PARMS'&lt;通道参数&gt;';</pre></div>
                        </li>
                        <li class="stepexpand"><span>由于存档日志在备用数据库中备份，因此Oracle建议您为日志删除策略配置<code class="codeph">BACKED UP</code>选项：</span><div><pre class="oac_no_warn" dir="ltr">配置ARCHIVELOG删除政策<span class="italic">n次</span>备份到设备类型SBT;</pre></div>
                        </li>
                     </ol>
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-FBB66066-8FD4-4328-9AF2-0D7625803FDB__GUID-F042CE3F-2867-4CE4-A848-0623D0ACE30E">
                           <p class="notep1">也可以看看：</p>
                           <p>有关为存档重做日志启用删除策略的详细信息，请参见<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=BRADV89439" target="_blank"><span class="italic">“Oracle数据库备份和恢复用户指南”</span></a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="SBYDB4856"></a><div class="props_rev_3"><a id="GUID-F4CD9CD2-1006-409F-92D8-909114931B06" name="GUID-F4CD9CD2-1006-409F-92D8-909114931B06"></a><h4 id="SBYDB-GUID-F4CD9CD2-1006-409F-92D8-909114931B06" class="sect4"><span class="enumeration_section">12.3.4</span>备用时未执行备份的RMAN配置</h4>
                  <div>
                     <p>建议在<span class="italic">未</span>完成备份的备用数据库中使用这些RMAN配置。
                     </p>
                     <ol>
                        <li class="stepexpand"><span>将RMAN作为目标连接到备用数据库，并连接到恢复目录。</span></li>
                        <li class="stepexpand"><span>在归档日志应用于备用数据库后，启用自动删除归档日志（当使用级联或远程同步实例功能时，这也适用于所有终端数据库）：</span><div><pre class="oac_no_warn" dir="ltr">配置ARCHIVELOG删除政策应用于所有待机;</pre></div>
                        </li>
                     </ol>
                  </div>
               </div>
            </div><a id="SBYDB5055"></a><a id="SBYDB00755"></a><div class="props_rev_3"><a id="GUID-410FEFAD-7805-405A-8C02-B9D8F74C60F4" name="GUID-410FEFAD-7805-405A-8C02-B9D8F74C60F4"></a><h3 id="SBYDB-GUID-410FEFAD-7805-405A-8C02-B9D8F74C60F4" class="sect3"><span class="enumeration_section">12.4</span>备份程序</h3>
               <div>
                  <p>您可以使用RMAN脚本和过程在Oracle Data Guard配置中备份Oracle数据库。</p>
                  <p>请参阅以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="using-RMAN-in-oracle-data-guard-configurations.html#GUID-104006BF-5611-44C9-B892-87D140474DD3" title="备用数据库上的快速恢复区域可用作磁带备份的磁盘高速缓存。">使用磁盘作为磁带备份的缓存</a></p>
                     </li>
                     <li>
                        <p><a href="using-RMAN-in-oracle-data-guard-configurations.html#GUID-9102A173-7F1B-46B2-A750-E2599F74305F" title="Oracle的媒体管理层（MML）API允许第三方供应商构建媒体管理器，该软件可与RMAN和供应商的硬件配合使用，以允许备份到磁带驱动器等顺序媒体设备。">直接执行磁带备份</a></p>
                     </li>
                  </ul>
                  <div class="infoboxnote" id="GUID-410FEFAD-7805-405A-8C02-B9D8F74C60F4__GUID-A38275CC-E493-405E-A445-9E29D19787A4">
                     <p class="notep1">注意：</p>
                     <p>Oracle的最高可用性体系结构（MAA）最佳实践建议在主数据库和备用数据库中进行备份，以便在出现双重中断时减少MTTR，并避免在切换和故障转移时引入新的站点实践。</p>
                  </div>
                  <div class="section">
                     <p class="subhead2" id="GUID-410FEFAD-7805-405A-8C02-B9D8F74C60F4__GUID-B862B1D0-AF45-46D2-84FF-0D3208E7684F">服务器参数文件的备份</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>除SPFILE的备份外，所有备份操作都可以卸载到单个备用数据库。 SPFILE的备份只能还原到备份它们的数据库。</p>
                     <p>对于未备份的数据库，Oracle建议您至少将SPFILE备份到已知的本地磁盘位置。如果需要将SPFILE备份进一步备份到磁带，则可以将它们复制到已配置备份到磁带的数据库站点。然后，可以使用以下RMAN命令在该数据库中对SPFILE备份进行编目：</p><pre class="oac_no_warn" dir="ltr">CATALOG START WITH'&lt;SPFILE backup directory&gt;';</pre><p>然后将SPFILE备份备份到磁带：</p><pre class="oac_no_warn" dir="ltr">BACKUP BACKUPSET ALL;</pre><p>当需要为特定数据库还原SPFILE时，将从磁盘或磁带还原相应的SPFILE备份。</p>
                  </div>
                  <!-- class="section" -->
               </div><a id="SBYDB4857"></a><div class="props_rev_3"><a id="GUID-104006BF-5611-44C9-B892-87D140474DD3" name="GUID-104006BF-5611-44C9-B892-87D140474DD3"></a><h4 id="SBYDB-GUID-104006BF-5611-44C9-B892-87D140474DD3" class="sect4"><span class="enumeration_section">12.4.1</span>使用磁盘作为磁带备份的缓存</h4>
                  <div>
                     <p>备用数据库上的快速恢复区域可用作磁带备份的磁盘高速缓存。</p>
                     <p>磁盘用作备份的主存储，磁带提供长期的归档存储。每天进行增量磁带备份，每周进行一次完整的磁带备份。以下各节介绍了用于执行这些备份的命令。</p>
                  </div><a id="SBYDB4858"></a><div class="props_rev_3"><a id="GUID-88CA9C62-4AFF-4395-B47D-05A145E7EFAE" name="GUID-88CA9C62-4AFF-4395-B47D-05A145E7EFAE"></a><h5 id="SBYDB-GUID-88CA9C62-4AFF-4395-B47D-05A145E7EFAE" class="sect5"><span class="enumeration_section">12.4.1.1</span>使用磁盘作为缓存的每日磁带备份命令</h5>
                     <div>
                        <p>在决定备份策略时，Oracle建议您利用每日增量备份。</p>
                        <p>可以使用最新的增量备份前滚数据文件映像副本，从而始终提供最新的数据文件映像副本。RMAN使用生成的映像副本进行介质恢复，就像使用在系统更改号（SCN）上获取的完整映像副本一样，而无需每天执行数据库的完整映像副本。另一个优点是减少了恢复时间，因为使用最新的块更改更新映像副本，并且需要更少的重做日志以使数据库恢复到当前状态。</p>
                        <p>要实施每日增量备份，将在第一天进行完整数据库备份，然后在第二天进行增量备份。存档的重做日志可用于将数据库恢复到任一天的任何一点。对于第3天及以后，前一天的增量备份将与数据文件副本合并，并进行当前增量备份，从而可以快速恢复到最后一天内的任何点。重做日志可用于将数据库恢复到当天的任何时间点。</p>
                        <p>执行每日备份的脚本如下所示（最后一行，只有在快速恢复区域不用于存储日志时才需要<code class="codeph">DELETE ARCHIVELOG ALL</code> ）：</p><pre class="oac_no_warn" dir="ltr">来自DB_UNIQUE_NAME ALL的RESYNC CATALOG;用TAG'OSS'恢复数据库的复制;备份设备类型磁盘增量级别1用于恢复带有标记'OSS'数据库的副本;备份设备类型磁盘DATAFILECOPY所有没有在任何SCN备份;备份设备类型SBT ARCHIVELOG ALL; BACKUP BACKUPSET ALL;删除ARCHIVELOG ALL;</pre><p>备份控制文件在备份操作结束时自动备份，因为启用了控制文件自动备份。</p>
                        <p>脚本中每个命令的作用说明如下：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">来自DB_UNIQUE_NAME的RESYNC目录ALL</code></p>
                              <p>重新同步Oracle Data Guard设置中恢复目录已知的所有其他数据库站点（主数据库和其他备用数据库）的信息。要使<code class="codeph">RESYNC CATALOG FROM DB_UNIQUE_NAME</code>正常工作，必须使用Oracle Net服务名称将RMAN连接到目标，并且所有数据库必须使用相同的密码文件。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">用TAG'OSS'恢复数据库的复制</code></p>
                              <p>通过应用前一天采用的1级增量备份来转发数据库的0级副本。在刚刚显示的示例脚本中，前一天的增量级别1被标记为<code class="codeph">OSS</code> 。此增量由<code class="codeph">BACKUP DEVICE TYPE DISK ...生成<code class="codeph">BACKUP DEVICE TYPE DISK ...DATABASE</code>命令。在运行此命令的第一天，没有前滚，因为还没有增量级别1。<code class="codeph">BACKUP DEVICE TYPE DISK ...创建0级增量<code class="codeph">BACKUP DEVICE TYPE DISK ...DATABASE</code>命令。在第二天再次没有前滚，因为只有0级增量。一个1级增量标记的<code class="codeph">OSS</code>由<code class="codeph">BACKUP DEVICE TYPE DISK ...创建<code class="codeph">BACKUP DEVICE TYPE DISK ...DATABASE</code>命令。在第三天和后几天，使用前一天创建的1级增量标记<code class="codeph">OSS</code>执行前滚。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">备份设备类型磁盘增量级别1用于恢复与标签'OSS'数据库的复制</code></p>
                              <p>创建新的1级增量备份。在运行此命令的第一天，将创建基本数据文件副本。在第二天和随后的几天，这是一级增量。</p>
                           </li>
                           <li><code class="codeph">备份设备类型磁盘DATAFILECOPY所有不在任何SCN备份</code><p>仅备份尚未备份的数据文件。</p>
                           </li>
                           <li>
                              <p><code class="codeph">备份设备类型SBT ARCHIVELOG ALL</code></p>
                              <p>根据删除策略将归档日志备份到磁带。</p>
                           </li>
                           <li>
                              <p><code class="codeph">BACKUP BACKUPSET ALL</code></p>
                              <p>备份由于创建增量备份而创建的任何备份集。</p>
                           </li>
                           <li>
                              <p><code class="codeph">删除ARCHIVELOG ALL</code></p>
                              <p>根据<code class="codeph">CONFIGURE ARCHIVELOG DELETION POLICY</code>命令设置的日志删除策略删除已归档日志。如果存档日志位于快速恢复区域，则在需要更多开放磁盘空间时会自动删除它们。因此，如果您明确要每天删除日志，则只需使用此命令。
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div><a id="SBYDB4859"></a><div class="props_rev_3"><a id="GUID-66665A86-0B71-41FE-BED0-B9992A405C35" name="GUID-66665A86-0B71-41FE-BED0-B9992A405C35"></a><h5 id="SBYDB-GUID-66665A86-0B71-41FE-BED0-B9992A405C35" class="sect5"><span class="enumeration_section">12.4.1.2</span>使用磁盘作为缓存的每周磁带备份命令</h5>
                     <div>
                        <p>要将所有与恢复相关的文件备份到磁带，请每周使用一次RMAN <code class="codeph">BACKUP RECOVERY FILES</code>命令。
                        </p>
                        <div class="section">
                           <p>这可确保磁盘上的所有当前增量备份，映像副本和归档日志备份都备份到磁带。</p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div><a id="SBYDB4860"></a><div class="props_rev_3"><a id="GUID-9102A173-7F1B-46B2-A750-E2599F74305F" name="GUID-9102A173-7F1B-46B2-A750-E2599F74305F"></a><h4 id="SBYDB-GUID-9102A173-7F1B-46B2-A750-E2599F74305F" class="sect4"><span class="enumeration_section">12.4.2</span>直接对磁带执行备份</h4>
                  <div>
                     <p>Oracle的媒体管理层（MML）API允许第三方供应商构建媒体管理器，该软件可与RMAN和供应商的硬件配合使用，以允许备份到磁带驱动器等顺序媒体设备。</p>
                     <div class="section">
                        <p>介质管理器处理顺序介质（如磁带）的加载，卸载和标记。您必须安装Oracle Secure Backup或第三方媒体管理软件才能将RMAN与顺序媒体设备配合使用。</p>
                        <p>默认情况下，请执行以下步骤直接对磁带执行备份：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>将RMAN连接到备用数据库（作为目标数据库）和恢复目录。</span></li>
                        <li class="stepexpand"><span>执行<code class="codeph">CONFIGURE</code>命令，如下所示：</span><div><pre class="oac_no_warn" dir="ltr">配置默认设备类型为SBT;</pre></div>
                        </li>
                     </ol>
                     <div class="section">
                        <p>在此方案中，每周进行完整备份，每天在备用数据库上进行增量备份。</p>
                        <div class="infoboxnotealso" id="GUID-9102A173-7F1B-46B2-A750-E2599F74305F__GUID-E3E29B26-407C-4576-81BF-BDF5B06A0E89">
                           <p class="notep1">也可以看看：</p>
                           <p>有关如何配置RMAN以与媒体管理器一起使用的详细信息<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=BRADV132" target="_blank"><span class="italic">，请参见“Oracle数据库备份和恢复用户指南”</span></a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div><a id="SBYDB4861"></a><div class="props_rev_3"><a id="GUID-110EF96F-1018-44FE-A7D4-6BED2786424B" name="GUID-110EF96F-1018-44FE-A7D4-6BED2786424B"></a><h5 id="SBYDB-GUID-110EF96F-1018-44FE-A7D4-6BED2786424B" class="sect5"><span class="enumeration_section">12.4.2.1</span>每日备份直接到磁带的命令</h5>
                     <div>
                        <p>用于直接对磁带执行每日备份的RMAN命令会重新同步Oracle Data Guard环境中所有其他数据库的信息。</p>
                        <div class="section">
                           <p>执行以下步骤直接执行磁带的每日备份：</p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>将RMAN连接到备用数据库（作为目标数据库）和恢复管理器。</span></li>
                           <li class="stepexpand"><span>执行以下RMAN命令：</span><div><pre class="oac_no_warn" dir="ltr">来自DB_UNIQUE_NAME ALL的RESYNC CATALOG; BACKUP作为BACKUPSET INCREMENTAL LEVEL 1 DATABASE PLUS ARCHIVELOG;删除ARCHIVELOG ALL;</pre></div>
                           </li>
                        </ol>
                        <div class="section">
                           <p>这些命令还会创建数据库的1级增量备份，包括所有存档日志。在运行此脚本的第一天，如果未找到0级备份，则会创建0级备份。</p>
                           <p>仅当所有归档日志文件不在快速恢复区域中时，才需要<code class="codeph">DELETE ARCHIVELOG ALL</code>命令。
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="SBYDB4862"></a><div class="props_rev_3"><a id="GUID-859B3851-D933-44E0-A114-5430EFD1F662" name="GUID-859B3851-D933-44E0-A114-5430EFD1F662"></a><h5 id="SBYDB-GUID-859B3851-D933-44E0-A114-5430EFD1F662" class="sect5"><span class="enumeration_section">12.4.2.2</span>每周备份直接到磁带的命令</h5>
                     <div>
                        <p>每周一天，直接执行每周备份到磁带。</p>
                        <div class="section">
                           <p>采取以下步骤：</p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>将RMAN连接到备用数据库（作为目标数据库）和恢复目录。</span></li>
                           <li class="stepexpand"><span>执行以下RMAN命令：</span><div><pre class="oac_no_warn" dir="ltr">来自DB_UNIQUE_NAME ALL的RESYNC CATALOG; BACKUP作为BACKUPSET INCREMENTAL LEVEL 0 DATABASE PLUS ARCHIVELOG;删除ARCHIVELOG ALL;</pre></div>
                           </li>
                        </ol>
                        <div class="section">
                           <p>这些命令重新同步Oracle Data Guard环境中所有其他数据库的信息，并创建包含所有已归档日志的0级数据库备份。</p>
                           <p>仅当所有归档日志文件不在快速恢复区域中时，才需要<code class="codeph">DELETE ARCHIVELOG ALL</code>命令。
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div>
            </div><a id="SBYDB4863"></a><div class="props_rev_3"><a id="GUID-9C54A243-6B84-4755-957E-AFC57B9BC3B6" name="GUID-9C54A243-6B84-4755-957E-AFC57B9BC3B6"></a><h3 id="SBYDB-GUID-9C54A243-6B84-4755-957E-AFC57B9BC3B6" class="sect3"><span class="enumeration_section">12.5</span>在Oracle Data Guard环境中注册和取消注册数据库</h3>
               <div>
                  <p>必须使用<code class="codeph">REGISTER DATABASE</code>命令仅显式注册主数据库。将RMAN连接到恢复目录和主数据库作为<code class="codeph">TARGET</code>后执行此操作。</p>
                  <p>连接到备用数据库或使用<code class="codeph">CONFIGURE DB_UNIQUE_NAME</code>命令配置连接标识符时，会在恢复目录中自动注册新备用数据库。
                  </p>
                  <p>要取消注册有关特定备用数据库的信息，可以使用<code class="codeph">UNREGISTER DB_UNIQUE_NAME</code>命令。从Oracle Data Guard环境中完全删除备用数据库后，还可以在连接到同一Oracle Data Guard环境中的另一个数据库后删除恢复目录中的数据库信息。与未注册的数据库关联的备份仍可供其他数据库使用。您可以使用<code class="codeph">CHANGE BACKUP RESET DB_UNIQUE_NAME</code>命令将这些备份与任何其他现有数据库相关联。
                  </p>
                  <p>当<code class="codeph">UNREGISTER DB_UNIQUE_NAME</code>命令与<code class="codeph">INCLUDING BACKUPS</code>选项一起使用时，与未注册的数据库关联的所有备份文件的元数据也将从恢复目录中取消注册。
                  </p>
               </div>
            </div><a id="SBYDB4864"></a><div class="props_rev_3"><a id="GUID-D13E9A5E-5DBB-4DF4-8534-F1E16FA33618" name="GUID-D13E9A5E-5DBB-4DF4-8534-F1E16FA33618"></a><h3 id="SBYDB-GUID-D13E9A5E-5DBB-4DF4-8534-F1E16FA33618" class="sect3"><span class="enumeration_section">12.6</span>在Oracle Data Guard环境中报告</h3>
               <div>
                  <p>将RMAN <code class="codeph">LIST</code> ， <code class="codeph">REPORT</code>和<code class="codeph">SHOW</code>命令与<code class="codeph">FOR DB_UNIQUE_NAME</code>子句一起使用可以查看有关特定数据库的信息。
                  </p>
                  <p>例如，在连接到恢复目录后，可以使用以下命令显示DBID为1625818158的数据库的信息，并在Oracle Data Guard环境中列出数据库。仅当您未以<code class="codeph">TARGET</code>身份连接到数据库时，才需要<code class="codeph">SET DBID</code>命令。最后三个命令列出了具有<code class="codeph">BOSTON</code>的<code class="codeph">DB_UNIQUE_NAME</code>的数据库的存档日志，数据库文件名和RMAN配置信息。</p><pre class="oac_no_warn" dir="ltr">SET DBID 1625818158;列出数据库的DB_UNIQUE_NAME;列表ARCHIVELOG ALL FOR DB_UNIQUE_NAME BOSTON; DB_UNIQUE_NAME BOSTON的报告模式;显示全部为DB_UNIQUE_NAME波士顿;</pre></div>
            </div><a id="SBYDB4865"></a><div class="props_rev_3"><a id="GUID-4B1696A8-1A90-426C-A620-D5F313365E54" name="GUID-4B1696A8-1A90-426C-A620-D5F313365E54"></a><h3 id="SBYDB-GUID-4B1696A8-1A90-426C-A620-D5F313365E54" class="sect3"><span class="enumeration_section">12.7</span>在Oracle Data Guard环境中执行备份维护</h3>
               <div>
                  <p>Oracle Data Guard环境中的文件（数据文件，存档日志，备份片，映像副本和代理副本）通过使用<code class="codeph">DB_UNIQUE_NAME</code>参数与数据库关联。
                  </p>
                  <p>因此，为Oracle Data Guard环境中的每个数据库提供的<code class="codeph">DB_UNIQUE_NAME</code>值必须是唯一的。此信息以及文件共享属性用于确定在各种RMAN操作期间可以访问哪些文件。
                  </p>
                  <p>文件共享属性指出磁盘上的文件只能在与其关联的数据库中访问，而磁带上的所有文件都假定可供所有数据库访问。RMAN命令（如<code class="codeph">BACKUP</code>和<code class="codeph">RESTORE</code> ）以及其他维护命令根据此假设工作。例如，在数据库中的映像副本的前滚操作期间，仅前滚与数据库相关联的映像副本。与该数据库关联的磁盘上的增量备份和磁带上的任何增量备份用于前滚映像副本。同样，在恢复操作期间，只有与数据库关联的磁盘备份和磁带上的文件才会被视为备份源。
                  </p>
                  <div class="infoboxnotealso" id="GUID-4B1696A8-1A90-426C-A620-D5F313365E54__GUID-C9F3BDAF-8809-4085-BFF6-C79AB0C3306E">
                     <p class="notep1">也可以看看：</p>
                     <p>有关RMAN命令的详细信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=RCMRF001" target="_blank"><span class="italic">参见Oracle数据库备份和恢复参考</span></a></p>
                  </div>
               </div><a id="SBYDB5056"></a><a id="SBYDB5057"></a><a id="SBYDB5058"></a><a id="SBYDB4866"></a><div class="props_rev_3"><a id="GUID-13FC0BEC-C528-47DA-95D5-35A67B3A97A1" name="GUID-13FC0BEC-C528-47DA-95D5-35A67B3A97A1"></a><h4 id="SBYDB-GUID-13FC0BEC-C528-47DA-95D5-35A67B3A97A1" class="sect4"><span class="enumeration_section">12.7.1</span>更改恢复目录中的元数据</h4>
                  <div>
                     <p>RMAN <code class="codeph">CHANGE</code>命令可与各种操作数一起使用，以更改恢复目录中的元数据。
                     </p>
                     <div class="section">
                        <p>例如：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p>将文件关联从一个备用数据库更改为另一个</p>
                              <p>将<code class="codeph">CHANGE</code>命令与<code class="codeph">RESET DB_UNIQUE_NAME</code>选项一起使用可以更改Oracle Data Guard环境中文件从一个数据库到另一个数据库的关联。当磁盘备份或归档日志从一个数据库传输到另一个数据库并且您希望在它们传输到的数据库上使用它们时， <code class="codeph">CHANGE</code>命令很有用。<code class="codeph">CHANGE</code>命令还可以更改文件从一个数据库到另一个数据库的关联，而无需使用<code class="codeph">FOR DB_UNIQUE_NAME</code>和<code class="codeph">RESET DB_UNIQUE_NAME TO</code>选项直接连接到任一数据库。
                              </p>
                           </li>
                           <li>
                              <p>更改数据库的DB_UNIQUE_NAME初始化参数</p>
                              <p>如果<code class="codeph">DB_UNIQUE_NAME</code>初始化参数的值对数据库发生更改，则必须在Oracle Data Guard环境中进行相同的更改。连接到该数据库实例后，RMAN恢复目录知道<code class="codeph">DB_UNIQUE_NAME</code>的旧值和新值。要合并恢复目录模式中旧值和新值的信息，必须使用RMAN <code class="codeph">CHANGE DB_UNIQUE_NAME</code>命令。如果<code class="codeph">DB_UNIQUE_NAME</code>初始化参数的值更改为数据库，则必须在RMAN中进行相同的更改，以便它知道新的<code class="codeph">DB_UNIQUE_NAME</code> 。例如，执行以下步骤以将<code class="codeph">BOSTON_A</code> <code class="codeph">DB_UNIQUE_NAME</code> <code class="codeph">BOSTON_A</code>为<code class="codeph">BOSTON_B</code> ：</p>
                              <ol>
                                 <li>
                                    <p>在初始化参数文件或SQL中，将<code class="codeph">DB_UNIQUE_NAME</code>初始化参数从<code class="codeph">BOSTON_A</code>为<code class="codeph">BOSTON_B</code> 。</p>
                                 </li>
                                 <li>
                                    <div class="p">在RMAN中，连接到Oracle Data Guard环境中的任何数据库作为目标数据库并连接到恢复目录。然后执行<code class="codeph">CHANGE</code>命令：<pre class="pre codeblock"><code>将BOSTON_A从BOSTON_A更改为BOSTON_B;更改DB_UNIQUE_NAME;</code></pre></div>
                                 </li>
                              </ol>
                           </li>
                           <li>
                              <p>使备份不可用或删除其元数据</p>
                              <p>使用<code class="codeph">CHANGE</code>命令选项（如<code class="codeph">AVAILABLE</code> ， <code class="codeph">UNAVAILABLE</code> ， <code class="codeph">KEEP</code>和<code class="codeph">UNCATALOG</code>使备份可用或不可用于还原和恢复，以及保留或删除其元数据。
                              </p>
                              <div class="infoboxnotealso" id="GUID-13FC0BEC-C528-47DA-95D5-35A67B3A97A1__GUID-14ED5188-25A5-41F3-9B78-D1438EC22667">
                                 <p class="notep1">也可以看看：</p>
                                 <p>有关RMAN <code class="codeph">CHANGE</code>命令的更多信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=RCMRF110" target="_blank"><span class="italic">参见Oracle数据库备份和恢复参考</span></a></p>
                              </div>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="SBYDB4867"></a><div class="props_rev_3"><a id="GUID-38EB0163-6F07-4F89-9A17-FC21FD779785" name="GUID-38EB0163-6F07-4F89-9A17-FC21FD779785"></a><h4 id="SBYDB-GUID-38EB0163-6F07-4F89-9A17-FC21FD779785" class="sect4"><span class="enumeration_section">12.7.2</span>删除存档日志或备份</h4>
                  <div>
                     <p>使用RMAN <code class="codeph">DELETE</code>命令删除备份集，映像副本，存档日志或代理副本。
                     </p>
                     <p>要仅删除与特定数据库关联的文件，必须使用带有<code class="codeph">DELETE</code>命令的<code class="codeph">FOR DB_UNIQUE_NAME</code>选项。
                     </p>
                     <p>对于与当前目标数据库关联的所有成功删除的文件（或与任何已知数据库无关的文件），将删除文件元数据。如果无法成功删除文件，则可以使用<code class="codeph">FORCE</code>选项删除文件的元数据。
                     </p>
                     <p>成功删除与其他数据库关联的文件后，还会删除其恢复目录中的元数据。在<code class="codeph">DELETE</code>命令完成时列出与其他数据库关联且无法成功删除的任何文件，以及在与文件关联的数据库中执行相同操作的说明（文件已分组）按数据库）。<code class="codeph">FORCE</code>选项不能用于覆盖此行为。如果您确定删除不可删除文件的元数据不会导致问题，则可以使用<code class="codeph">CHANGE RESET DB_UNIQUE_NAME</code>命令更改文件与数据库关联的元数据，并使用带有<code class="codeph">FORCE</code>选项的<code class="codeph">DELETE</code>命令删除该文件的元数据。
                     </p>
                     <div class="infoboxnotealso" id="GUID-38EB0163-6F07-4F89-9A17-FC21FD779785__GUID-06311517-F1C2-405E-B449-F64CBEBB5E1E">
                        <p class="notep1">也可以看看：</p>
                        <p>有关RMAN <code class="codeph">DELETE</code>命令的更多信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=RCMRF121" target="_blank"><span class="italic">参见Oracle数据库备份和恢复参考</span></a></p>
                     </div>
                  </div>
               </div><a id="SBYDB4868"></a><div class="props_rev_3"><a id="GUID-5C9C8A2E-E23A-4D62-BE5B-2205B5E877CB" name="GUID-5C9C8A2E-E23A-4D62-BE5B-2205B5E877CB"></a><h4 id="SBYDB-GUID-5C9C8A2E-E23A-4D62-BE5B-2205B5E877CB" class="sect4"><span class="enumeration_section">12.7.3</span>验证恢复目录元数据</h4>
                  <div>
                     <p>使用<code class="codeph">CROSSCHECK</code>命令验证和更新恢复目录架构中的文件状态。
                     </p>
                     <p>根据<code class="codeph">CROSSCHECK</code>操作的结果，与当前目标数据库（或任何与任何数据库无关的文件）关联的所有文件的元数据都标记为<code class="codeph">AVAILABLE</code>或<code class="codeph">EXPIRED</code> 。
                     </p>
                     <p>如果成功检查与另一个数据库关联的文件，则其恢复目录中的元数据也将更改为<code class="codeph">AVAILABLE</code> 。在<code class="codeph">CROSSCHECK</code>命令完成时列出与其他数据库关联且无法成功检查的任何文件，以及在与文件关联的数据库中执行相同操作的说明（文件已分组）按网站）。如果您确定配置并且仍希望更改不可用文件的状态元数据，则可以使用<code class="codeph">CHANGE RESET DB_UNIQUE_NAME</code>命令更改文件与数据库关联的元数据，并执行<code class="codeph">CROSSCHECK</code>命令以将状态元数据更新为<code class="codeph">EXPIRED</code> 。</p>
                     <div class="infoboxnotealso" id="GUID-5C9C8A2E-E23A-4D62-BE5B-2205B5E877CB__GUID-9847EC13-4E04-4492-8E7A-55915CAE2BA6">
                        <p class="notep1">也可以看看：</p>
                        <p>有关RMAN <code class="codeph">CROSSCHECK</code>命令的更多信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=RCMRF119" target="_blank"><span class="italic">参见Oracle数据库备份和恢复参考</span></a></p>
                     </div>
                  </div>
               </div>
            </div><a id="SBYDB00754"></a><div class="props_rev_3"><a id="GUID-44539CC5-0BAB-47F8-B51F-BFD0A1D6DA40" name="GUID-44539CC5-0BAB-47F8-B51F-BFD0A1D6DA40"></a><h3 id="SBYDB-GUID-44539CC5-0BAB-47F8-B51F-BFD0A1D6DA40" class="sect3"><span class="enumeration_section">12.8</span> Oracle Data Guard环境中的恢复方案</h3>
               <div>
                  <p>这些是Oracle Data Guard环境中可能发生的一些恢复方案。</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="using-RMAN-in-oracle-data-guard-configurations.html#GUID-1F1D37FE-48A6-46D4-98DB-C0E3707E3BCF" title="您可以通过连接到包含所需文件的物理备用数据库来通过网络还原和恢复文件。">从主数据库或备用数据库中的文件丢失中恢复</a></p>
                     </li>
                     <li>
                        <p><a href="using-RMAN-in-oracle-data-guard-configurations.html#GUID-7D1A6CBF-6E72-4700-87D8-64E534EFAA2B" title="如果当前ACTIVE组或尚未归档的非活动组的所有联机日志成员都丢失，则必须故障转移到备用数据库。">从在线重做日志文件丢失中恢复</a></p>
                     </li>
                     <li>
                        <p><a href="using-RMAN-in-oracle-data-guard-configurations.html#GUID-E8430B01-A852-4EAF-A711-10F3211F36A3" title="主数据库的不完全恢复通常在数据库被逻辑损坏（由用户或应用程序）或从数据库中意外删除表空间或数据文件的情况下完成。">主数据库的不完全恢复</a></p>
                     </li>
                     <li>
                        <p><a href="using-RMAN-in-oracle-data-guard-configurations.html#GUID-2B3CB228-F8AD-4FE0-8C3B-BEED91DFB424" title="在主服务器上执行RMAN表空间时间点恢复（TSPITR）后，恢复的数据文件具有新的系统更改编号（SCN），因此被视为主数据库中的新数据文件。">在主要版本的TSPITR或表空间插件之后需要的操作</a></p>
                     </li>
                  </ul>
               </div><a id="SBYDB4869"></a><div class="props_rev_3"><a id="GUID-1F1D37FE-48A6-46D4-98DB-C0E3707E3BCF" name="GUID-1F1D37FE-48A6-46D4-98DB-C0E3707E3BCF"></a><h4 id="SBYDB-GUID-1F1D37FE-48A6-46D4-98DB-C0E3707E3BCF" class="sect4"><span class="enumeration_section">12.8.1</span>从主数据库或备用数据库中的文件丢失中恢复</h4>
                  <div>
                     <p>您可以通过连接到包含所需文件的物理备用数据库来通过网络还原和恢复文件。</p>
                     <p>当您想要使用物理备用数据库上的相应文件恢复主数据库上丢失的数据文件，控制文件或表空间时，这非常有用。您还可以使用相同的进程通过使用主数据库还原物理备用数据库上的文件。</p>
                     <div class="infoboxnote" id="GUID-1F1D37FE-48A6-46D4-98DB-C0E3707E3BCF__GUID-3013E54B-17E9-4350-849F-B2740EC3DE86">
                        <p class="notep1">注意：</p>
                        <p>在之前的版本Oracle数据库<span class="italic">12c</span>中，从在主文件的丢失中恢复，则所使用的RMAN恢复目录和RMAN <code class="codeph">BACKUP</code> ， <code class="codeph">CATALOG DATAFILE</code>和<code class="codeph">SWITCH DATAFILE</code>命令。要从备用数据库上的文件丢失中恢复，您使用了<code class="codeph">RESTORE</code>和<code class="codeph">RECOVER</code>命令。从Oracle Database 12 <span class="italic">c开始，</span>不再需要这些方法。如果您需要有关使用它们的信息，请参阅Oracle Database <span class="italic">11g</span>文档。
                        </p>
                     </div>
                     <div class="infoboxnotealso" id="GUID-1F1D37FE-48A6-46D4-98DB-C0E3707E3BCF__GUID-52F9483F-E402-4FDD-9D4C-6A91C65753C1">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>有关使用RMAN通过网络还原和恢复文件的详细信息，请参见<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=BRADV680" target="_blank"><span class="italic">“Oracle数据库备份和恢复用户指南”</span></a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="SBYDB4873"></a><div class="props_rev_3"><a id="GUID-7D1A6CBF-6E72-4700-87D8-64E534EFAA2B" name="GUID-7D1A6CBF-6E72-4700-87D8-64E534EFAA2B"></a><h4 id="SBYDB-GUID-7D1A6CBF-6E72-4700-87D8-64E534EFAA2B" class="sect4"><span class="enumeration_section">12.8.2</span>从在线重做日志文件丢失中恢复</h4>
                  <div>
                     <p>如果当前<code class="codeph">ACTIVE</code>组或尚未归档的非活动组的所有联机日志成员都丢失，则必须故障转移到备用数据库。
                     </p>
                     <div class="section">
                        <p>请参阅<a href="managing-oracle-data-guard-role-transitions.html#GUID-44F26D5F-E036-4ACD-B8F0-224F5498FBCE" title="Oracle Data Guard配置包含一个在主角色中运行的数据库和一个在备用角色中运行的一个或多个数据库。">角色转换</a>以了解故障转移过程。
                        </p>
                        <p>有关如何在其他情况下从丢失联机重做日志文件中恢复的信息，请参阅“ <a href="../bradv/user-managed-recovery-advanced.html#BRADV229" target="_blank"><span class="italic">Oracle数据库备份和恢复用户指南”</span></a> 。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="SBYDB5061"></a><a id="SBYDB5062"></a><a id="SBYDB5063"></a><a id="SBYDB4874"></a><div class="props_rev_3"><a id="GUID-E8430B01-A852-4EAF-A711-10F3211F36A3" name="GUID-E8430B01-A852-4EAF-A711-10F3211F36A3"></a><h4 id="SBYDB-GUID-E8430B01-A852-4EAF-A711-10F3211F36A3" class="sect4"><span class="enumeration_section">12.8.3</span>主数据库的不完全恢复</h4>
                  <div>
                     <p>主数据库的不完全恢复通常在数据库被逻辑损坏（由用户或应用程序）或从数据库中意外删除表空间或数据文件的情况下完成。</p>
                     <div class="section">
                        <p>根据备用数据库实例上的当前数据库检查点SCN，您可以使用以下过程之一来执行主数据库的不完全恢复。所有程序都按照优先顺序排列，从最耗时的程序开始。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-E8430B01-A852-4EAF-A711-10F3211F36A3__GUID-1CB2F407-B630-4CC0-B37A-98E013FBAF71">使用闪回数据库</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>在主数据库上启用闪回数据库功能时，建议的过程是使用闪回数据库，没有数据库文件丢失，并且时间点恢复大于最早的闪回SCN或最早的闪回时间。有关<a href="examples-of-using-oracle-data-guard.html#GUID-BAA5ED38-29A0-4E8D-8435-AA083D19C13E" title="If an error occurrs on the primary database in an Oracle Data Guard configuration in which the standby database is using real-time apply, then the same error is applied on the standby database. if Flashback Database is enabled, you can revert the primary and standby databases back to their pre-error condition.">使用闪</a>回数据库执行时间点恢复的过程，请参阅<a href="examples-of-using-oracle-data-guard.html#GUID-BAA5ED38-29A0-4E8D-8435-AA083D19C13E" title="如果备用数据库使用实时应用的Oracle Data Guard配置中的主数据库发生错误，则在备用数据库上应用相同的错误。如果启用了闪回数据库，则可以将主数据库和备用数据库还原为其错误前的状态。">在发布Open Resetlogs语句后</a>使用闪回数据库。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-E8430B01-A852-4EAF-A711-10F3211F36A3__GUID-F9282BCB-F58D-4E68-AD68-879466B6A190">使用备用数据库实例</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>当备用数据库位于所需的不完全恢复时间之后，并且主数据库或备用数据库上未启用闪回数据库时，建议执行此过程：</p>
                        <ol>
                           <li>
                              <p>将备用数据库恢复到所需的时间点。在发出以下命令之前，请务必停止托管重做进程（MRP）：</p><pre class="oac_no_warn" dir="ltr">恢复数据库直到' <span class="italic">时间</span> ';</pre><p>或者，可以使用SCN或日志序列号指定不完整的恢复时间：</p><pre class="oac_no_warn" dir="ltr">RECOVER DATABASE UNTIL SCN <span class="variable" translate="no">incomplete recovery SCN</span> '; RECOVER DATABASE UNTIL LOGSEQ <span class="variable" translate="no">incomplete recovery log sequence number</span> THREAD <span class="variable" translate="no">thread number</span> ;</pre></li>
                           <li>
                              <p>以只读模式打开备用数据库以验证数据库的状态。</p>
                              <p>如果状态不是所需的，请使用LogMiner实用程序查看存档的重做日志文件以查找正确的目标时间或SCN以进行不完全恢复。或者，您可以将备用数据库恢复到您知道的目标时间之前的点，然后以只读模式打开数据库以检查数据的状态。重复此过程，直到验证数据库的状态是否正确。如果您将数据库恢复得太远（通过发生错误的SCN），则无法将其返回到早期的SCN。</p>
                           </li>
                           <li>
                              <p>启用<a id="d31144e3236" class="indexterm-anchor"></a><a id="d31144e3241" class="indexterm-anchor"></a>备用数据库使用SQL <code class="codeph">ALTER DATABASE ACTIVATE STANDBY DATABASE</code>语句。这会将备用数据库转换为主数据库，创建新的resetlogs分支并打开数据库。请参阅<a href="managing-oracle-data-guard-physical-standby-databases.html#GUID-02218512-31A6-461E-96B4-0B9997DCFC4A" title="Oracle Data Guard allows recovery on a physical standby database to continue after the primary database has been opened with the RESETLOGS option.">通过OPEN RESETLOGS语句恢复</a>以了解备用数据库如何<a href="managing-oracle-data-guard-physical-standby-databases.html#GUID-02218512-31A6-461E-96B4-0B9997DCFC4A" title="在使用RESETLOGS选项打开主数据库之后，Oracle Data Guard允许在物理备用数据库上进行恢复。">响应</a>新的重置日志分支。
                              </p>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-E8430B01-A852-4EAF-A711-10F3211F36A3__GUID-D0C83B59-F397-461E-908E-8DF88C7CE0FC">使用主数据库实例</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>如果所有备用数据库实例已在所需的时间点恢复，并且主数据库或备用数据库上未启用闪回数据库，则这是您唯一的选择。</p>
                        <p>使用以下过程在主数据库上执行不完全恢复：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>使用LogMiner或其他方法来识别数据库中所有数据都知道良好的时间或SCN。</span></li>
                        <li class="stepexpand"><span>使用时间或SCN，发出以下RMAN命令以执行不完整的数据库恢复，并使用<code class="codeph">RESETLOGS</code>选项打开数据库（在连接到目录数据库和处于<code class="codeph">MOUNT</code>状态的主实例之后）：</span><div><pre class="oac_no_warn" dir="ltr">RUN {SET UNTIL TIME' <span class="italic">时间</span> '; RESTORE DATABASE;恢复数据库; ALTER DATABASE OPEN RESETLOGS;</pre></div>
                        </li>
                     </ol>
                     <div class="section">
                        <p>完成此过程后，必须在Oracle Data Guard配置中重新建立所有备用数据库实例。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="SBYDB5429"></a><div class="props_rev_3"><a id="GUID-2B3CB228-F8AD-4FE0-8C3B-BEED91DFB424" name="GUID-2B3CB228-F8AD-4FE0-8C3B-BEED91DFB424"></a><h4 id="SBYDB-GUID-2B3CB228-F8AD-4FE0-8C3B-BEED91DFB424" class="sect4"><span class="enumeration_section">12.8.4</span>主节点上TSPITR或表空间插件后待机所需的操作</h4>
                  <div>
                     <p>在主服务器上执行RMAN表空间时间点恢复（TSPITR）后，恢复的数据文件具有新的系统更改编号（SCN），因此被视为主数据库中的新数据文件。</p>
                     <p>无法在备用数据库中自动创建这些数据文件。</p>
                     <p>同样，当将新插入的表空间添加到主数据库时，数据文件将被视为主数据库中的新数据文件。</p>
                     <p>当重做应用进程遇到这些新文件的创建时，备用数据库上的托管重做进程（MRP）将停止。必须复制所需的新数据文件并将其还原到备用数据库。您可以使用备份或主数据库中的直接副本执行此操作。例如，要复制属于已经过RMAN TSPITR的表空间的所有文件，可以使用以下RMAN命令：</p><pre class="oac_no_warn" dir="ltr">RMAN&gt; RESTORE TABLESPACE &lt;tbs_name1，tbs_name2&gt; FROM SERVICE &lt;tnsalias-of-primary&gt;</pre><p>分配的磁盘通道数是每RMAN配置。因此，如果执行<code class="codeph">CONFIGURE DEVICE TYPE DISK PARALLELISM 4</code> ，则使用4个磁盘通道从主数据库中提取文件。
                     </p>
                     <p>当备用数据库中有新数据文件可用时，请重新启动MRP以继续应用日志。</p>
                     <div class="infoboxnotealso" id="GUID-2B3CB228-F8AD-4FE0-8C3B-BEED91DFB424__GUID-DC7926CE-9304-45EE-9975-3FF148B12D51">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>有关RMAN TSPITR的详细信息，请参见<a href="../bradv/performing-rman-tspitr.html#BRADV009" target="_blank"><span class="italic">“Oracle数据库备份和恢复用户指南”</span></a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div>
            </div><a id="SBYDB00752"></a><div class="props_rev_3"><a id="GUID-211E08A4-C19E-4159-80B2-429431314278" name="GUID-211E08A4-C19E-4159-80B2-429431314278"></a><h3 id="SBYDB-GUID-211E08A4-C19E-4159-80B2-429431314278" class="sect3"><span class="enumeration_section">12.9</span>其他备份情况</h3>
               <div>
                  <p>您可以修改其他配置的备份过程，例如备用数据库和主数据库无法共享备份文件时;备用实例仅用于远程存档重做日志文件;或者备用数据库文件名与主数据库不同。</p>
               </div><a id="SBYDB4875"></a><div class="props_rev_3"><a id="GUID-75F78440-2A7C-4FDC-AFF9-CABB440CB651" name="GUID-75F78440-2A7C-4FDC-AFF9-CABB440CB651"></a><h4 id="SBYDB-GUID-75F78440-2A7C-4FDC-AFF9-CABB440CB651" class="sect4"><span class="enumeration_section">12.9.1</span>备用数据库在地理位置上远离共享备份</h4>
                  <div>
                     <p>如果备用数据库彼此相距很远，则主系统或其他备用系统可能无法轻松访问其上的备份。</p>
                     <div class="section">
                        <p>在所有系统上执行数据库的完整备份以执行恢复操作。快速恢复区域可以驻留在主系统和备用系统上;对于主数据库和备用数据库，它不必相同。</p>
                        <p>在此方案中，您仍可以使用<a href="using-RMAN-in-oracle-data-guard-configurations.html#GUID-44539CC5-0BAB-47F8-B51F-BFD0A1D6DA40" title="These are some of recovery scenarios that can occur in an Oracle Data Guard environment.">Oracle Data Guard环境</a>中的<a href="using-RMAN-in-oracle-data-guard-configurations.html#GUID-44539CC5-0BAB-47F8-B51F-BFD0A1D6DA40" title="这些是Oracle Data Guard环境中可能发生的一些恢复方案。">恢复方案中</a>描述的常规策略，但以下情况除外：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p>必须使用本地系统名称标记RMAN创建的备份文件，并使用标记必须用于限制RMAN选择在同一主机上执行的备份的<code class="codeph">RESTORE</code>操作。换句话说， <code class="codeph">BACKUP</code>命令在创建备份时必须使用<code class="codeph">TAG</code> <span class="variable" translate="no">system name</span>选项; <code class="codeph">RESTORE</code>命令必须使用<code class="codeph">FROM TAG</code> <span class="variable" translate="no">system name</span>选项;并且<code class="codeph">RECOVER</code>命令必须使用<code class="codeph">FROM TAG</code> <span class="variable" translate="no">system name</span> <code class="codeph">ARCHIVELOG TAG</code> <span class="variable" translate="no">system name</span>选项。
                              </p>
                           </li>
                           <li>
                              <p>备用站点的灾难恢复：</p>
                              <ol>
                                 <li>
                                    <p>使用备用数据库之前运行的相同参数文件，以<code class="codeph">NOMOUNT</code>状态启动备用实例。
                                    </p>
                                 </li>
                                 <li>
                                    <p>使用SQL <code class="codeph">ALTER DATABASE CREATE STANDBY CONTROLFILE AS</code> <span class="variable" translate="no">filename</span>语句在主实例上创建备用控制文件，并使用创建的控制文件挂载备用实例。
                                    </p>
                                 </li>
                                 <li>
                                    <p>发出以下RMAN命令以还原和恢复数据库文件：</p><pre class="oac_no_warn" dir="ltr">从TAG' <span class="variable" translate="no">system name</span> '恢复数据库';从TAG中恢复数据库' <span class="variable" translate="no">system name</span> 'ARCHIVELOG TAG' <span class="variable" translate="no">system name</span> ';</pre></li>
                                 <li>
                                    <p>重新启动重做应用。</p>
                                 </li>
                              </ol>
                           </li>
                        </ul>
                        <p>备用实例获取剩余的归档重做日志文件。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="SBYDB4876"></a><div class="props_rev_3"><a id="GUID-BA288622-6D29-444E-ACD6-7CFC293C32D5" name="GUID-BA288622-6D29-444E-ACD6-7CFC293C32D5"></a><h4 id="SBYDB-GUID-BA288622-6D29-444E-ACD6-7CFC293C32D5" class="sect4"><span class="enumeration_section">12.9.2</span>备用数据库不包含用作FAL服务器的数据文件</h4>
                  <div>
                     <p>FAL服务器可用作所有归档重做日志文件的备份源，从而将归档重做日志文件的备份卸载到FAL服务器。</p>
                     <div class="section">
                        <p>使用“ <a href="using-RMAN-in-oracle-data-guard-configurations.html#GUID-410FEFAD-7805-405A-8C02-B9D8F74C60F4" title="您可以使用RMAN脚本和过程在Oracle Data Guard配置中备份Oracle数据库。">备份</a>过程”中描述的相同过程，但不能对FAL服务器运行备份数据库文件的RMAN命令。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="SBYDB4877"></a><div class="props_rev_3"><a id="GUID-75A2D339-D737-44A1-B0E0-3BF8443D2FA4" name="GUID-75A2D339-D737-44A1-B0E0-3BF8443D2FA4"></a><h4 id="SBYDB-GUID-75A2D339-D737-44A1-B0E0-3BF8443D2FA4" class="sect4"><span class="enumeration_section">12.9.3</span>备用数据库文件名与主数据库不同</h4>
                  <div>
                     <p>从Oracle Database <span class="italic">11g开始</span> ，恢复目录可以重新同步每个备用数据库站点的文件名。
                     </p>
                     <p>但是，如果从未重新同步的主数据库和备用数据库上的数据库文件名不同，则您使用的<code class="codeph">RESTORE</code>和<code class="codeph">RECOVER</code>命令略有不同。要获取备用数据库上的实际数据文件名，请查询<code class="codeph">V$DATAFILE</code>视图，并为数据库中的所有数据文件指定<code class="codeph">SET NEWNAME</code>选项：</p><pre class="oac_no_warn" dir="ltr">运行{ <span class="variable" translate="no">existing file location for file#1</span>设置NEWNAME 1到'来自V $ DATAFILE'的<span class="variable" translate="no">existing file location for file#1</span>的<span class="variable" translate="no">existing file location for file#1</span> ';将DATAFILE的NEWNAME设置为'来自V $ DATAFILE'的<span class="variable" translate="no">existing file location for file#2</span>的<span class="variable" translate="no">existing file location for file#2</span> '; ......为DATAFILE设置NEWNAME <span class="variable" translate="no">n</span> '从V $ DATAFILE'到' <span class="variable" translate="no">existing file location for file#n</span> #n的<span class="variable" translate="no">existing file location for file#n</span> '; RESTORE {DATAFILE &lt; <span class="variable" translate="no">n,m,…</span> &gt; | TABLESPACE <span class="variable" translate="no">tbs_name_1, 2, …</span> |数据库; SWITCH DATAFILE ALL; RECOVER DATABASE {NOREDO}; }</pre><p>同样，您使用RMAN <code class="codeph">DUPLICATE</code>命令的<code class="codeph">SET NEWNAME</code>选项在备用数据库创建期间指定新文件名。或者您可以设置<code class="codeph">LOG_FILE_NAME_CONVERT</code>和<code class="codeph">DB_FILE_NAME_CONVERT</code>参数。
                     </p>
                     <div class="infoboxnotealso" id="GUID-75A2D339-D737-44A1-B0E0-3BF8443D2FA4__GUID-ED37F32E-B0F2-4901-A7F2-901C835FB989">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="examples-of-using-oracle-data-guard.html#GUID-6FB574E5-2F3A-4C9E-A3F0-7C9154B0F540" title="When you create standby databases, there are additional steps that must be performed if the primary database uses Oracle Managed Files (OMF) or Oracle Automatic Storage Management (Oracle ASM).">在备用数据库</a>上设置<code class="codeph">DB_FILE_NAME_CONVERT</code>和<code class="codeph">DB_CREATE_FILE_DEST</code>参数时， <a href="examples-of-using-oracle-data-guard.html#GUID-6FB574E5-2F3A-4C9E-A3F0-7C9154B0F540" title="创建备用数据库时，如果主数据库使用Oracle托管文件（OMF）或Oracle自动存储管理（Oracle ASM），则必须执行其他步骤。">创建使用OMF或Oracle ASM的备用数据库，</a>以获取有关优先规则的信息</p>
                     </div>
                  </div>
               </div>
            </div><a id="SBYDB5457"></a><div class="props_rev_3"><a id="GUID-F0EB4F8E-7D2F-4674-9A5B-AABC368D8F11" name="GUID-F0EB4F8E-7D2F-4674-9A5B-AABC368D8F11"></a><h3 id="SBYDB-GUID-F0EB4F8E-7D2F-4674-9A5B-AABC368D8F11" class="sect3"><span class="enumeration_section">12.10</span>通过网络恢复和恢复文件</h3>
               <div>
                  <p>从Oracle Database 12 <span class="italic">c开始</span> ，RMAN允许您通过网络连接到包含所需文件的物理备用数据库来还原或恢复文件。
                  </p>
                  <p>您可以还原整个数据库，数据文件，控制文件，spfile或表空间。在需要同步主数据库和备用数据库的情况下，通过网络还原文件非常有用。</p>
                  <p>RMAN使用<code class="codeph">RESTORE</code>命令的<code class="codeph">FROM</code> <code class="codeph">SERVICE</code>子句从物理备用数据库通过网络还原数据库文件。<code class="codeph">FROM</code> <code class="codeph">SERVICE</code>子句提供必须从中还原文件的物理备用数据库的服务名称。在还原操作期间，RMAN在物理备用数据库上创建需要还原的文件的备份集，然后通过网络将这些备份集传输到目标数据库。
                  </p>
                  <div class="infoboxnote" id="GUID-F0EB4F8E-7D2F-4674-9A5B-AABC368D8F11__GUID-063A5B63-188F-4B0E-80D3-E27100F43128">
                     <p class="notep1">注意：</p>
                     <p>在Oracle数据库<span class="italic">12c</span>中之前的版本中，还原和恢复文件在网络上，你使用的<a id="d31144e3944" class="indexterm-anchor"></a><a id="d31144e3946" class="indexterm-anchor"></a><a id="d31144e3950" class="indexterm-anchor"></a> RMAN <code class="codeph">BACKUP INCREMENTAL FROM SCN</code>命令，用于在备用数据库的当前SCN上启动的主数据库上创建备份，然后用于及时向前滚动备用数据库。从Oracle Database 12 <span class="italic">c开始，</span>不需要该手动，多步骤方法。如果您需要有关使用该方法的信息，请参阅Oracle Database <span class="italic">11g</span>文档。
                     </p>
                  </div>
                  <div class="infoboxnotealso" id="GUID-F0EB4F8E-7D2F-4674-9A5B-AABC368D8F11__GUID-B8967DE5-3197-42F7-9165-98AABB3EAC1E">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>有关使用RMAN通过网络还原和恢复文件的详细信息，请参见<a href="../bradv/rman-recovery-advanced.html#BRADV680" target="_blank"><span class="italic">“Oracle数据库备份和恢复用户指南”</span></a></p>
                        </li>
                        <li>
                           <p>有关使用跨平台增量备份减少可传输表空间停机时间的信息，请访问<a href="http://support.oracle.com" target="_blank"><code class="codeph">http://support.oracle.com</code></a> My Oracle Support说明2005729.1。
                           </p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-53AF8403-7ECC-4329-966E-965FDBFB4455" name="GUID-53AF8403-7ECC-4329-966E-965FDBFB4455"></a><h3 id="SBYDB-GUID-53AF8403-7ECC-4329-966E-965FDBFB4455" class="sect3"><span class="enumeration_section">12.11</span>使用一个命令滚动待机</h3>
               <div>
                  <p>从Oracle Database 18c开始，您可以使用一个RMAN命令<code class="codeph">RECOVER STANDBY DATABASE</code>通过网络刷新备用数据库。</p>
                  <p><code class="codeph">RECOVER STANDBY DATABASE</code>命令重新启动备用实例，从主数据库刷新控制文件，并自动重命名数据文件，临时文件和联机日志。它还原已添加到主数据库的新数据文件，并将备用数据库恢复到当前时间。
                  </p>
                  <p>使用<code class="codeph">RECOVER STANDBY DATABASE</code>命令刷新备用数据库时，可以指定<code class="codeph">FROM SERVICE</code>子句或<code class="codeph">NOREDO</code>子句。<code class="codeph">FROM SERVICE</code>子句指定主服务的名称。<code class="codeph">NOREDO</code>子句指定应该用于刷新备份，这允许备用数据库前滚到特定时间或SCN。</p>
                  <p>在尝试与主数据库同步之前，必须在备用数据库上手动停止MRP。</p>
                  <p>以下是使用<code class="codeph">RECOVER STANDBY DATABASE</code>命令的示例。它显示了<code class="codeph">PFILE</code>子句的可选用法，以指定备用数据库的参数文件（在spfile不可用时使用）。
                  </p><pre class="pre codeblock"><code>从服务中恢复STANDBY数据库service_name PFILE = pfile_location;</code></pre><div class="infoboxnotealso" id="GUID-53AF8403-7ECC-4329-966E-965FDBFB4455__GUID-D8EAEF1D-6BE6-4B7F-8B25-AC2D6B3D51D8">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>有关使用<code class="codeph">RECOVER STANDBY DATABASE</code>命令刷新物理备用数据库以及对主数据库所做更改的更多信息，请<code class="codeph">RECOVER STANDBY DATABASE</code> <a href="../bradv/rman-recovery-advanced.html#BRADV-GUID-828A4953-3F7E-4975-ADA4-5469D6794BB0" target="_blank"><span><cite>“Oracle数据库备份和恢复用户指南”</cite></span></a> 。</p>
                        </li>
                     </ul> 
                  </div>
               </div>
            </div><a id="SBYDB5261"></a><div class="props_rev_3"><a id="GUID-72F008A1-527F-41DB-89CD-623FA06D0420" name="GUID-72F008A1-527F-41DB-89CD-623FA06D0420"></a><h3 id="SBYDB-GUID-72F008A1-527F-41DB-89CD-623FA06D0420" class="sect3"><span class="enumeration_section">12.12</span> RMAN在Oracle Data Guard环境中对CDB的支持</h3>
               <div>
                  <p>RMAN支持备用数据库中多租户容器数据库（CDB）的时间点恢复（PITR）。（单个可插拔数据库（PDB）没有自己的备用数据库。）</p>
                  <p>这是RMAN在备用数据库中提供完整数据库恢复和完整数据文件恢复的支持。</p>
                  <p>要在备用数据库上执行CDB PITR，请以root身份连接到CDB，并根据需要发出RMAN <code class="codeph">BACKUP</code> ， <code class="codeph">RESTORE</code>和<code class="codeph">RECOVER</code>命令。
                  </p>
                  <p>请注意，在备用数据库上执行CDB PITR时，任何在CDB PITR启用之前处于禁用状态的可插拔数据库（PDB）。要返回PDB为禁用状态，连接到它，确保它关闭（ <code class="codeph">OPEN_MODE</code>列<code class="codeph">V$PDBS</code>视图显示的值<code class="codeph">MOUNTED</code> ），然后执行SQL语句<code class="codeph">ALTER</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> <code class="codeph">DISABLE</code> <code class="codeph">RECOVERY</code> 。</p>
                  <p><code class="codeph">ALTER</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> <code class="codeph">DISABLE</code> <code class="codeph">RECOVERY</code>语句将属于PDB的所有数据文件脱机并禁用PDB的恢复。在再次启用PDB之前，属于PDB的数据文件不属于任何恢复会话。禁用恢复时创建的任何新数据文件都将创建为未命名文件并标记为脱机。
                  </p>
                  <p>提起这属于PDB重新联机所有数据文件，并使其恢复，连接到它，确保它被关闭（ <code class="codeph">OPEN_MODE</code>列<code class="codeph">V$PDBS</code>视图显示的值<code class="codeph">MOUNTED</code> ），并发出SQL语句<code class="codeph">ALTER</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> <code class="codeph">ENABLE</code> <code class="codeph">RECOVERY</code> 。</p>
                  <p>要检查PDB上是启用还是禁用恢复，请按如下方式查询<code class="codeph">V$PDBS</code>视图：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; SELECT RECOVERY_STATUS FROM V $ PDBS;</pre><div class="section">
                     <p class="subhead2" id="GUID-72F008A1-527F-41DB-89CD-623FA06D0420__GUID-A86DE91D-C851-4188-8BB4-9E2D47B77BF4">闪回PDB</p>
                     <p>如Oracle数据库<span class="italic">12c的</span>第2版（12.2.0.1）的，则可以使用<code class="codeph">FLASHBACK PLUGGABLE DATABASE</code>命令（可通过SQL或恢复管理器），以在一个特定的PDB执行闪回操作。您可以闪回到特定还原点 - 系统更改号（SCN）的别名 - 过去不会影响CDB中的其他PDB。 （在PDB上执行此类操作类似于非CDB中的<code class="codeph">FLASHBACK DATABASE</code> 。）
                     </p>
                     <p>您还可以在备用数据库上闪回PDB。实际上，在备用数据库上闪回PDB会将PDB的数据文件倒回到先前的某个时间点，就像恢复PDB的备份一样。在备用数据库上闪回PDB允许备用数据库在主数据库上执行PDB PITR /闪回操作后快速跟随主数据库，如主数据库上的<a href="examples-of-using-oracle-data-guard.html#GUID-8D948A24-A3B7-4E4F-917A-00B047CF3CAF" title="在主服务器上执行PDB PITR或PDB闪回后，您可以还原PDB或闪回备用服务器上的PDB以使备用服务器跟随主服务器。">PDB PITR后备用操作所需的操作中所述</a> 。
                     </p>
                     <div class="infoboxnote" id="GUID-72F008A1-527F-41DB-89CD-623FA06D0420__FILESTHATAREBROUGHTONLINEOROFFLINEA-43A25B1E">
                        <p class="notep1">注意：</p>
                        <p>由于<code class="codeph">ALTER</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> <code class="codeph">[</code> <code class="codeph">ENABLE</code> <code class="codeph">|</code>而导致联机或脱机的文件即使您将数据库闪回到执行操作之前的某个点， <code class="codeph">DISABLE</code> <code class="codeph">]</code>操作仍保持该状态。
                        </p>
                     </div>
                     <div class="infoboxnotealso" id="GUID-72F008A1-527F-41DB-89CD-623FA06D0420__ACTIONSNEEDEDONASTANDBYAFTERAPDBPIT-43A25B1E">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="examples-of-using-oracle-data-guard.html#GUID-8D948A24-A3B7-4E4F-917A-00B047CF3CAF" title="After you perform a PDB PITR or PDB Flashback on a primary, you can either restore the PDB or flashback the PDB on the standby to let the standby follow the primary.">PDB PITR后备用时所需的操作在主服务器</a>上获取有关<a href="examples-of-using-oracle-data-guard.html#GUID-8D948A24-A3B7-4E4F-917A-00B047CF3CAF" title="在主服务器上执行PDB PITR或PDB闪回后，您可以还原PDB或闪回备用服务器上的PDB以使备用服务器跟随主服务器。">主服务器</a>上PDB PITR后备用服务器所需操作的信息</p>
                           </li>
                           <li>
                              <p><a href="using-RMAN-in-oracle-data-guard-configurations.html#GUID-2B3CB228-F8AD-4FE0-8C3B-BEED91DFB424" title="After an RMAN tablespace point-in-time recovery (TSPITR) is performed at the primary, the recovered data files have a new system change number (SCN), and are therefore treated like new data files at the primary.">在主服务器</a>上的TSPITR或表空间插件之后所需的操作，以获取有关<a href="using-RMAN-in-oracle-data-guard-configurations.html#GUID-2B3CB228-F8AD-4FE0-8C3B-BEED91DFB424" title="在主服务器上执行RMAN表空间时间点恢复（TSPITR）后，恢复的数据文件具有新的系统更改编号（SCN），因此被视为主数据库中的新数据文件。">在主服务器</a>上的TSPITR或表空间插件之后备用服务器上所需操作的信息</p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
         </div>
      </article>
   </body>
</html>