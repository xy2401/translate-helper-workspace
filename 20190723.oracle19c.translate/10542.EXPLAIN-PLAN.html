<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>解释计划</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="SQL Language Reference "></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="SQL Language Reference"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="sql-language-reference.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-02-12T15:36:36-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96310-02"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="DROP-VIEW.html" title="Previous" type="text/html"></link>
      <link rel="next" href="FLASHBACK-DATABASE.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="SQL Language Reference"></meta>
    <meta name="dcterms.isVersionOf" content="SQLRF"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="DROP-VIEW.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="FLASHBACK-DATABASE.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">SQL语言参考</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="SQL-Statements-DROP-TABLE-to-LOCK-TABLE.html" property="item" typeof="WebPage"><span property="name">SQL语句：DROP TABLE到LOCK TABLE</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">解释计划</li>
            </ol>
            <a id="GUID-FD540872-4ED3-4936-96A2-362539931BA0" name="GUID-FD540872-4ED3-4936-96A2-362539931BA0"></a><a id="SQLRF54982"></a><a id="SQLRF54983"></a><a id="SQLRF54984"></a><a id="SQLRF54985"></a><a id="SQLRF54986"></a><a id="SQLRF54987"></a><a id="SQLRF54988"></a><a id="SQLRF01601"></a>
            
            <h2 id="SQLRF-GUID-FD540872-4ED3-4936-96A2-362539931BA0" class="sect2">解释计划</h2>
         </header>
         <div class="ind">
            <div>
               <div class="section">
                  <p class="subhead1" id="GUID-FD540872-4ED3-4936-96A2-362539931BA0__GUID-9BA47DA6-8685-4C32-8705-420F34523DC3">目的</p>
                  <p><a id="d393300e130" class="indexterm-anchor"></a><a id="d393300e134" class="indexterm-anchor"></a><a id="d393300e140" class="indexterm-anchor"></a><a id="d393300e144" class="indexterm-anchor"></a>使用<code class="codeph">EXPLAIN</code> <code class="codeph">PLAN</code>语句确定Oracle Database执行指定SQL语句所遵循的执行计划。此语句将描述执行计划的每个步骤的行插入到指定的表中。您还可以将<code class="codeph">EXPLAIN</code> <code class="codeph">PLAN</code>语句作为SQL跟踪工具的一部分发出。
                  </p>
                  <p>此语句还确定执行语句的成本。如果在表上定义了任何域索引，则还将插入用户定义的CPU和I / O开销。</p>
                  <p><a id="d393300e165" class="indexterm-anchor"></a><a id="d393300e167" class="indexterm-anchor"></a>可以在分发介质上的SQL脚本中使用示例输出表<code class="codeph">PLAN_TABLE</code>的定义。您的输出表必须与此表具有相同的列名称和数据类型。此脚本的通用名称是<code class="codeph">UTLXPLAN.SQL</code> 。确切的名称和位置取决于您的操作系统。
                  </p>
                  <p><a id="d393300e177" class="indexterm-anchor"></a><a id="d393300e181" class="indexterm-anchor"></a> Oracle数据库通过多个动态性能视图提供有关缓存游标的信息：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>有关SQL游标使用的工作区的信息，请查询<code class="codeph">V$SQL_WORKAREA</code> 。</p>
                     </li>
                     <li>
                        <p>有关缓存游标的执行计划的信息，请查询<code class="codeph">V$SQL_PLAN</code> 。</p>
                     </li>
                     <li>
                        <p>对于高速缓存游标执行计划的每个步骤或操作的执行统计信息（例如，生成的行数，读取的块数），查询<code class="codeph">V$SQL_PLAN_STATISTICS</code> 。</p>
                     </li>
                     <li>
                        <p>对于前三个视图的选择性预计算连接，请查询<code class="codeph">V$SQL_PLAN_STATISTICS_ALL</code> 。</p>
                     </li>
                     <li>
                        <p>如果监视语句执行，则在<code class="codeph">V$SQL_PLAN_MONITOR</code>中显示缓存游标执行计划的每个步骤或操作的执行统计信息。您可以使用<code class="codeph">MONITOR</code>提示强制进行监控。
                        </p>
                     </li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-FD540872-4ED3-4936-96A2-362539931BA0__GUID-BB1A5A7F-43FC-45A1-9201-A2C6A97F2D68">
                     <p class="notep1">也可以看看：</p>
                     <p></p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>有关<code class="codeph">EXPLAIN</code> <code class="codeph">PLAN</code>输出，如何使用SQL跟踪工具以及如何生成和解释执行计划的信息，请参阅<a href="../tgsql/generating-and-displaying-execution-plans.html#TGSQL271" target="_blank"><span class="italic">“Oracle数据库SQL调优指南”</span></a></p>
                        </li>
                        <li>
                           <p><a href="../refrn/dynamic-performance-views.html#REFRN003" target="_blank"><span class="italic">Oracle Database Reference</span></a> ，了解有关动态性能视图的信息</p>
                        </li>
                     </ul>
                  </div>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-FD540872-4ED3-4936-96A2-362539931BA0__GUID-26797289-7E5C-4B52-86D6-F440B3773C29">先决条件</p>
                  <p>要发出<code class="codeph">EXPLAIN</code> <code class="codeph">PLAN</code>语句，您必须具有将行插入到指定用于保存执行计划的现有输出表所需的权限。
                  </p>
                  <p>您还必须具有执行要为其确定执行计划的SQL语句所需的特权。如果SQL语句访问视图，则您必须具有访问视图所基于的任何表和视图的权限。如果视图基于另一个基于表的视图，则您必须具有访问其他视图及其基础表的权限。</p>
                  <p>要检查<code class="codeph">EXPLAIN</code> <code class="codeph">PLAN</code>语句生成的执行计划，您必须具有查询输出表所需的权限。
                  </p>
                  <p><code class="codeph">EXPLAIN</code> <code class="codeph">PLAN</code>语句是一种数据操作语言（DML）语句，而不是数据定义语言（DDL）语句。因此，Oracle数据库不会隐式提交<code class="codeph">EXPLAIN</code> <code class="codeph">PLAN</code>语句所做的更改。如果要在输出表中保留<code class="codeph">EXPLAIN</code> <code class="codeph">PLAN</code>语句生成的行，则必须提交包含该语句的事务。
                  </p>
                  <div class="infoboxnotealso" id="GUID-FD540872-4ED3-4936-96A2-362539931BA0__GUID-11EFFEE1-A9D2-4797-99A5-8F1F1EF1B930">
                     <p class="notep1">也可以看看：</p>
                     <p><a href="INSERT.html#GUID-903F8043-0254-4EE9-ACC1-CB8AC0AF3423">INSERT</a>和<a href="SELECT.html#GUID-CFA006CA-6FF1-4972-821E-6996142A51C6">SELECT</a>获取有关填充和查询计划表所需的权限的信息</p>
                  </div>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-FD540872-4ED3-4936-96A2-362539931BA0__GUID-C660FBFC-0686-40EA-86C0-FA4D2A619EBA">句法</p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-FD540872-4ED3-4936-96A2-362539931BA0__GUID-BDCC3613-9F65-476A-BEBC-4793321BF7A2"><span class="italic">explain_plan</span> :: =</p>
                  <div class="figure" id="GUID-FD540872-4ED3-4936-96A2-362539931BA0__GUID-C22D7197-6644-46B7-AFAE-9E3535ADE445"><img src="img/explain_plan.gif" alt="下面是explain_plan.eps的描述" title="下面是explain_plan.eps的描述" longdesc="img_text/explain_plan.html"><br><a href="img_text/explain_plan.html">说明explain_plan.eps的描述</a></div>
                  <!-- class="figure" -->
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-FD540872-4ED3-4936-96A2-362539931BA0__GUID-4C3386C6-BBD8-48C5-AD12-D4C964BCFB76">语义</p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-FD540872-4ED3-4936-96A2-362539931BA0__GUID-7E002AC5-1D31-4296-8ADA-9BBBE32E5C85">SET STATEMENT_ID子句</p>
                  <p><a id="d393300e311" class="indexterm-anchor"></a>为输出表中的执行计划的行指定<code class="codeph">STATEMENT_ID</code>列的值。然后，您可以使用此值在输出表中标识这些行。如果输出表包含许多执行计划中的行，请确保指定<code class="codeph">STATEMENT_ID</code>值。如果省略此子句，则<code class="codeph">STATEMENT_ID</code>值默认为null。
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-FD540872-4ED3-4936-96A2-362539931BA0__GUID-C54CFA16-CAAD-4420-A062-F177AAAE4F7F">INTO <span class="italic">表</span>条款</p>
                  <p><a id="d393300e332" class="indexterm-anchor"></a>指定输出表的名称，以及可选的其架构和数据库。在使用<code class="codeph">EXPLAIN</code> <code class="codeph">PLAN</code>语句之前，此表必须存在。
                  </p>
                  <p>如果省略<span class="italic"><code class="codeph">schema</code></span> ，则数据库假定该表位于您自己的模式中。
                  </p>
                  <p><span class="italic"><code class="codeph">dblink</code></span>可以是指向输出表所在的远程Oracle数据库的数据库链接的完整或部分名称。仅当您使用Oracle数据库分布式功能时，才能指定远程输出表。如果省略<span class="italic"><code class="codeph">dblink</code></span> ，则数据库假定该表位于本地数据库中。有关<span class="q"><a href="Syntax-for-Schema-Objects-and-Parts-in-SQL-Statements.html#GUID-61D0B206-A5EA-473F-AD04-7067D6E3914C">引用</a></span>数据库链接的信息，请参阅<span class="q">“ <a href="Syntax-for-Schema-Objects-and-Parts-in-SQL-Statements.html#GUID-61D0B206-A5EA-473F-AD04-7067D6E3914C">对远程数据库中对象的引用</a> ”</span> 。
                  </p>
                  <p>如果完全省略<code class="codeph">INTO</code> ，则数据库假定您本地数据库上自己的架构中名为<code class="codeph">PLAN_TABLE</code>的输出表。
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-FD540872-4ED3-4936-96A2-362539931BA0__GUID-0D798DC6-6383-4EC0-8B49-140684E7768A">FOR <span class="italic">声明</span>条款</p>
                  <p><a id="d393300e378" class="indexterm-anchor"></a>指定<code class="codeph">SELECT</code> ， <code class="codeph">INSERT</code> ， <code class="codeph">UPDATE</code> ， <code class="codeph">DELETE</code> ， <code class="codeph">MERGE</code> ， <code class="codeph">CREATE</code> <code class="codeph">TABLE</code> ， <code class="codeph">CREATE</code> <code class="codeph">INDEX</code>或<code class="codeph">ALTER</code> <code class="codeph">INDEX</code> ......<code class="codeph">REBUILD</code>执行计划的<code class="codeph">REBUILD</code>语句。
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-FD540872-4ED3-4936-96A2-362539931BA0__GUID-52609872-B4C7-44B5-8E2C-B3B8AA70B767">关于解释计划的说明</p>
                  <p>以下说明适用于<code class="codeph">EXPLAIN</code> <code class="codeph">PLAN</code> ：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>如果<span class="italic"><code class="codeph">statement</code></span>包含<span class="italic"><code class="codeph">parallel_clause</code></span> ，则生成的执行计划将指示并行执行。但是， <code class="codeph">EXPLAIN</code> <code class="codeph">PLAN</code>实际上将语句插入到计划表中，因此您提交的并行DML语句不再是事务中的第一个DML语句。这违反了单个事务中对一个并行DML语句的Oracle数据库限制，并且该语句将以串行方式执行。要保持语句的并行执行，必须提交或回滚<code class="codeph">EXPLAIN</code> <code class="codeph">PLAN</code>语句，然后提交并行DML语句。
                        </p>
                     </li>
                     <li>
                        <p>要确定临时表上操作的执行计划，必须从同一会话运行<code class="codeph">EXPLAIN</code> <code class="codeph">PLAN</code> ，因为临时表中的数据是特定于会话的。
                        </p>
                     </li>
                  </ul>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-FD540872-4ED3-4936-96A2-362539931BA0__GUID-59AEB35B-6BBB-4A18-A8DE-ABB476036CE8">例子</p>
                  <p><span class="bold">解释计划示例</span></p>
                  <p>以下语句确定<code class="codeph">UPDATE</code>语句的执行计划和成本，并将描述执行计划的行插入到指定的<code class="codeph">plan_table</code>表中，其<code class="codeph">STATEMENT_ID</code>值为“东京的提升”：</p><pre class="oac_no_warn" dir="ltr">EXPLAIN PLAN SET STATEMENT_ID ='在东京举起'INTO plan_table FOR UPDATE员工SET薪水=薪水* 1.10 WHERE department_id =（SELECT department_id FROM departments WHERE location_id = 1700）;</pre><p>以下<code class="codeph">SELECT</code>语句查询<code class="codeph">plan_table</code>表并返回执行计划和成本：</p><pre class="oac_no_warn" dir="ltr">SELECT id，LPAD（''，2 *（LEVEL-1））||操作操作，options，object_name，object_alias，position FROM plan_table START WITH id = 0 AND statement_id ='在东京举起'CONNECT BY PRIOR id = parent_id AND statement_id ='东京的提升'ORDER BY id;</pre><p>查询返回此执行计划：</p><pre class="oac_no_warn" dir="ltr">ID操作选项OBJECT_NAME OBJECT_ALIAS POSITION --- -------------------- --------------------  - ------------------- -------------------- -------- 0更新声明4 1更新员工1 2指数范围扫描EMP_DEPARTMENT_IX员工@ UPD $ 1 1 3表格访问指数部门部门@ SEL $ 1 1 4 INDEX RANGE SCAN DEPT_LOCATION_IX部门@ SEL $ 1 1</pre><p>第一行的<code class="codeph">POSITION</code>列中的值显示该语句的成本为4。
                  </p>
                  <p><span class="bold">EXPLAIN PLAN：分区示例</span></p>
                  <p>示例表<code class="codeph">sh.sales</code>在<code class="codeph">time_id</code>列上进行了分区。分区<code class="codeph">sales_q3_2000</code>包含小于2000年10月1日的时间值，并且<code class="codeph">time_id</code>列上有本地索引<code class="codeph">sales_time_bix</code> 。
                  </p>
                  <p>考虑查询：</p><pre class="oac_no_warn" dir="ltr">SELECT * FROM EXPLAIN PLAN *来自销售WHERE time_id BETWEEN：h AND '01 -OCT-2000';</pre><p>其中<code class="codeph">:h</code>表示已声明的绑定变量。<code class="codeph">EXPLAIN</code> <code class="codeph">PLAN</code>使用<code class="codeph">PLAN_TABLE</code>作为输出表执行此查询。使用以下查询获取基本执行计划（包括分区信息）：</p><pre class="oac_no_warn" dir="ltr">SELECT操作，选项，partition_start，partition_stop，partition_id FROM plan_table;</pre></div>
               <!-- class="section" -->
            </div>
         </div>
      </article>
   </body>
</html>