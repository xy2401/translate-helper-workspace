<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="Oracle Sharding is integrated with Oracle Database replication technologies for high availability and disaster recovery at the shard level."></meta>
      <meta name="description" content="Oracle Sharding is integrated with Oracle Database replication technologies for high availability and disaster recovery at the shard level."></meta>
      <title>碎片级高可用性</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Using Oracle Sharding"></meta>
      <meta property="og:description" content="Oracle Sharding is integrated with Oracle Database replication technologies for high availability and disaster recovery at the shard level."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Using Oracle Sharding"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="using-oracle-sharding.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-02-14T12:19:13-08:00"></meta>
      <meta name="dcterms.title" content="Using Oracle Sharding"></meta>
      <meta name="dcterms.dateCopyrighted" content="2018, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E87088-04"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="sharding-data-routing.html" title="Previous" type="text/html"></link>
      <link rel="next" href="sharding-deployment.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="SHARD"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="sharding-data-routing.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="sharding-deployment.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">使用Oracle Sharding</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">碎片级高可用性</li>
            </ol>
            <a id="GUID-C668B8C7-0F94-4F85-B8E1-A6B91548BBB6" name="GUID-C668B8C7-0F94-4F85-B8E1-A6B91548BBB6"></a>
            
            <h2 id="SHARD-GUID-C668B8C7-0F94-4F85-B8E1-A6B91548BBB6" class="sect2"><span class="enumeration_chapter">7</span>级别高级可用性</h2>
         </header>
         <div class="ind">
            <div>
               <p>Oracle Sharding与Oracle数据库复制技术集成，可在分片级别实现高可用性和灾难恢复。</p>
               <p>以下主题描述了如何使用Oracle的复制技术使分片数据库具有高可用性：</p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="sharding-high-availability.html#GUID-133A4C15-FCD5-46E3-B33B-0DB3EBE54064">关于Sharding和复制</a><br>Oracle Sharding与Oracle复制和灾难恢复技术Oracle Data Guard和Oracle GoldenGate紧密集成。
                  </li>
                  <li class="ulchildlink"><a href="sharding-high-availability.html#GUID-52E55FFE-2AF7-45B0-B29A-6664D6CB78AB">将Oracle Data Guard与Sharded Database一起使用</a><br>Oracle Data Guard复制维护碎片（主要）的一个或多个同步副本（备用），以实现高可用性和数据保护。Standbys可以在本地或远程部署，使用Oracle Active Data Guard时也可以打开以进行只读访问。
                  </li>
                  <li class="ulchildlink"><a href="sharding-high-availability.html#GUID-4FC0AC46-0B8B-4670-BBE4-052228492C72">将Oracle GoldenGate与Sharded Database一起使用</a><br>Oracle GoldenGate用于细粒度主动 - 主动复制，其中所有分片都是可写的，并且每个分片可以部分复制到分片组内的其他分片。
                  </li>
               </ul>
            </div>
            
            <div class="sect2"><a id="GUID-133A4C15-FCD5-46E3-B33B-0DB3EBE54064" name="GUID-133A4C15-FCD5-46E3-B33B-0DB3EBE54064"></a><h3 id="SHARD-GUID-133A4C15-FCD5-46E3-B33B-0DB3EBE54064" class="sect3"><span class="enumeration_section">7.1</span>关于分片和复制</h3>
               <div>
                  <p>Oracle Sharding与Oracle复制和灾难恢复技术Oracle Data Guard和Oracle GoldenGate紧密集成。</p>
                  <p>复制为读取提供高可用性，灾难恢复和额外的可伸缩性。复制单元可以是分片，分片的一部分或一组分片。</p>
                  <p>使用GDSCTL命令语法以声明方式指定分片数据库中的复制拓扑。您可以选择两种技术之一 -  Oracle Data Guard或Oracle GoldenGate  - 来复制数据。Oracle Sharding自动部署指定的复制拓扑并启用数据复制。</p>
                  <p>分片数据库的可用性不受一个或多个分片的中断或减速的影响。复制用于提供单独的分片级高可用性（Oracle Active Data Guard或Oracle GoldenGate）。创建分片数据库时，将自动配置和部署复制。（可选）您可以将Oracle RAC用于分片级高可用性（通过复制补充），以便在发生群集中断时维护分片级数据可用性。如果发生计划外中断，Oracle Sharding会自动将数据库连接从分片连接到其副本。</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="sharding-high-availability.html#GUID-E65AA060-0C3D-4F4F-BE9F-4BF1FD3967FB">何时为Shard高可用性选择Oracle GoldenGate</a><br>什么时候应该使用Oracle GoldenGate作为Oracle Sharding的高可用性解决方案？
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="sharding-high-availability.html#GUID-C668B8C7-0F94-4F85-B8E1-A6B91548BBB6" title="Oracle Sharding与Oracle数据库复制技术集成，可在分片级别实现高可用性和灾难恢复。">分片级高可用性</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="sect3"><a id="GUID-E65AA060-0C3D-4F4F-BE9F-4BF1FD3967FB" name="GUID-E65AA060-0C3D-4F4F-BE9F-4BF1FD3967FB"></a><h4 id="SHARD-GUID-E65AA060-0C3D-4F4F-BE9F-4BF1FD3967FB" class="sect4"><span class="enumeration_section">7.1.1</span>何时为Shard高可用性选择Oracle GoldenGate</h4>
                  <div>
                     <p>什么时候应该使用Oracle GoldenGate作为Oracle Sharding的高可用性解决方案？</p>
                     <p>在以下情况下，Oracle GoldenGate应该是您首选的高可用性解决方案：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>所有分片都是可读写的。使用Active Data Guard，DR /备份分片是只读的。</p>
                        </li>
                        <li>
                           <p>部署分片的灵活性更高。每个分片可以位于不同的操作系统或不同的数据库版本上。</p>
                        </li>
                        <li>
                           <p>不止一个可更新的数据副本，即使在单个shardgroup中也是如此。例如，使用Oracle GoldenGate，使用复制因子4，您可以拥有4个可更新数据的读写副本。</p>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-E65AA060-0C3D-4F4F-BE9F-4BF1FD3967FB__GUID-492E63F2-8CAD-46E6-AE8F-3CC58ADEDA05">
                        <p class="notep1">也可以看看：</p>
                        <p>在融合中间件中<span class="italic">使用</span> <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/shard&amp;id=GGSAU-GUID-2C059382-7753-4EFA-B313-A6E0DAF7EA1C" target="_blank">Oracle GoldenGate Sharding</a> <span class="italic">使用Oracle GoldenGate微服务架构</span>指南，了解有关将Oracle GoldenGate与Oracle Sharding配合使用的更多信息。
                        </p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="sharding-high-availability.html#GUID-133A4C15-FCD5-46E3-B33B-0DB3EBE54064" title="Oracle Sharding与Oracle复制和灾难恢复技术Oracle Data Guard和Oracle GoldenGate紧密集成。">关于分片和复制</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
            <div class="sect2"><a id="GUID-52E55FFE-2AF7-45B0-B29A-6664D6CB78AB" name="GUID-52E55FFE-2AF7-45B0-B29A-6664D6CB78AB"></a><h3 id="SHARD-GUID-52E55FFE-2AF7-45B0-B29A-6664D6CB78AB" class="sect3"><span class="enumeration_section">7.2</span>将Oracle Data Guard与分片数据库结合使用</h3>
               <div>
                  <p>Oracle Data Guard复制维护碎片（主要）的一个或多个同步副本（备用），以实现高可用性和数据保护。Standbys可以在本地或远程部署，使用Oracle Active Data Guard时也可以打开以进行只读访问。</p>
                  <p>Oracle Data Guard可以使用系统管理，用户定义或复合分片方法用作分片数据库的复制技术。</p>
                  <div class="section">
                     <p class="subhead2" id="GUID-52E55FFE-2AF7-45B0-B29A-6664D6CB78AB__GUID-79D148A4-A50E-4C08-A50C-64D86AFBF196">将Oracle Data Guard与系统管理的分片数据库结合使用</p>
                     <p>在系统管理和复合分<span class="italic">片中</span> ，逻辑复制单元是一组称为分片组的分片。在系统管理的分片中，分片组包含存储在分片数据库中的所有数据。通过构成分片组的分片上的一致哈希来对数据进行分片。属于分片组的碎片通常位于同一数据中心。整个分片组可以完全复制到相同或不同数据中心的一个或多个分片组。
                     </p>
                     <p>下图说明了Data Guard复制如何与系统管理的分片一起使用。在图中的示例中，有一个主分片组，Shardgroup 1和两个备用分片组，Shardgroup 2和Shardgroup 3。Shardgroup 1由Data Guard主数据库（分片1-3）组成。Shardgroup 2由本地备用数据库（分片4-6）组成，它们位于同一数据中心并配置为进行同步复制。Shardgroup 3由位于不同数据中心的远程备用数据库（分片7-9）组成，并配置为异步复制。此配置中启用了Oracle Active Data Guard，因此每个备用数据库都是只读的。</p>
                     <div class="figure" id="GUID-52E55FFE-2AF7-45B0-B29A-6664D6CB78AB__GUID-821EC77F-6FBE-4142-A165-2AD1328EF293">
                        <p class="titleinfigure">图7-1使用Data Guard复制的系统管理分片</p><img src="img/admin_3v_136a.png" alt="下面是图7-1的描述" title="下面是图7-1的描述" longdesc="img_text/admin_3v_136a.html"><br><a href="img_text/admin_3v_136a.html">“图7-1使用Data Guard复制进行系统管理的分片”的说明</a></div>
                     <!-- class="figure" -->
                     <p>shardgroup作为逻辑复制单元的概念从用户隐藏了复制的实现细节。使用Data Guard，复制在分片（数据库）级别完成。上图中的分片数据库由三组复制的分片组成：{1,4,7}，{2,5,8}和{3,6,9}。每组复制的分片都作为Data Guard Broker配置进行管理，并启用快速启动故障转移（FSFO）。</p>
                     <p>要部署复制，请指定分片组的属性（区域，角色等）并为其添加分片。Oracle Sharding自动配置Data Guard并为每组复制的分片启动FSFO观察器。它还提供只读工作负载，基于角色的全局服务和复制延迟以及基于位置的路由的负载平衡。</p>
                     <p>运行以下GDSCTL命令以部署上图中显示的示例配置。</p><pre class="pre codeblock"><code>CREATE SHARDCATALOG -database host00：1521：shardcat -region dc1，dc2 ADD GSM -gsm gsm1 -listener 1571 -catalog host00：1521：shardcat -region dc1 ADD GSM -gsm gsm2 -listener 1571 -catalog host00：1521：shardcat -region dc2 START GSM -gsm gsm1 START GSM -gsm gsm2 ADD SHARDGROUP -shardgroup shardgroup1 -region dc1 -deploy_as primary ADD SHARDGROUP -shardgroup shardgroup2 -region dc1 -deploy_as active_standby ADD SHARDGROUP -shardgroup shardgroup3 -region dc2 -deploy_as active_standby CREATE SHARD -shardgroup shardgroup1 -destination host01 -credential oracle_cred CREATE SHARD -shardgroup shardgroup1 -destination host02 -credential oracle_cred CREATE SHARD -shardgroup shardgroup1 -destination host03 -credential oracle_cred ...CREATE SHARD -shardgroup shardgroup3 -destination host09 -credential oracle_cred DEPLOY</code></pre></div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-52E55FFE-2AF7-45B0-B29A-6664D6CB78AB__GUID-0C743452-E7C3-485A-82B1-24B5204139D8">将Oracle Data Guard与用户定义的分片数据库结合使用</p>
                     <p>使用用户定义的分片，逻辑（和物理）复制单元是分片。碎片不会合并到碎片组中。每个分片及其副本组成一个分片<span class="italic">空间</span> ，对应于单个Data Guard Broker配置。可以为每个分片空间单独配置复制。Shardspace可以有不同数量的备用数据库，可以位于不同的数据中心。下图显示了使用Data Guard复制的用户定义分片的示例。
                     </p>
                     <div class="figure" id="GUID-52E55FFE-2AF7-45B0-B29A-6664D6CB78AB__GUID-657DD600-76BF-4F95-B211-BCF9C798B572">
                        <p class="titleinfigure">图7-2使用Data Guard复制的用户定义分片</p><img src="img/admin_3v_135a.png" alt="下面是图7-2的描述" title="下面是图7-2的描述" longdesc="img_text/admin_3v_135a.html"><br><a href="img_text/admin_3v_135a.html">“图7-2使用Data Guard复制的用户定义分片”的说明</a></div>
                     <!-- class="figure" -->
                     <p>运行以下GDSCTL命令以使用上图中显示的Data Guard复制部署示例用户定义的分片数据库。</p><pre class="pre codeblock"><code>CREATE SHARDCATALOG -sharding user -database host00：1521：cat -region dc1，dc2，dc3 ADD GSM -gsm gsm1 -listener 1571 -catalog host00：1521：cat -region dc1 ADD GSM -gsm gsm2 -listener 1571 -catalog host00：1521 ：cat -region dc2 ADD GSM -gsm gsm3 -listener 1571 -catalog host00：1521：cat -region dc3 START GSM -gsm gsm1 START GSM -gsm gsm2 START GSM -gsm gsm3 ADD SHARDSPACE -shardspace shardspace_a ADD SHARDSPACE -shardspace shardspace_b ADD SHARDSPACE -shardspace shardspace_c CREATE SHARD -shardspace shardspace_a -region dc1 -deploy_as primary -destination host01 -credential oracle_cred -netparamfile /home/oracle/netca_dbhome.rsp CREATE SHARD -shardspace shardspace_a -region dc1 -deploy_as standby -destination host04 -credential oracle_cred -netparamfile / home / oracle / netca_dbhome.rsp CREATE SHARD -shardspace shardspace_a -region dc2 -deploy_as standby -destination host06 -credential oracle_cred -netparamfile /home/oracle/netca_dbhome.rsp CREATE SHARD -shardspace shardspace_ a -region dc3 -deploy_as standby -destination host08 -credential oracle_cred -netparamfile /home/oracle/netca_dbhome.rsp CREATE SHARD -shardspace shardspace_b -region dc1 -deploy_as primary -destination host08 -credential oracle_cred -netparamfile /home/oracle/netca_dbhome.rs ...CREATE SHARD -shardspace shardspace_c -region dc3 -deploy_as standby -destination host10 -credential oracle_cred -netparamfile /home/oracle/netca_dbhome.rsp DEPLOY</code></pre></div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-52E55FFE-2AF7-45B0-B29A-6664D6CB78AB__GUID-DF0FF1E2-B6A1-4E5E-8DC6-65A32DF948B7">将Oracle Data Guard与复合分片数据库结合使用</p>
                     <p>在复合分片中，类似于用户定义的分片，分片数据库由多个分片空间组成。但是，每个分片空间而不是复制的分片都包含复制的分片组。</p>
                     <div class="figure" id="GUID-52E55FFE-2AF7-45B0-B29A-6664D6CB78AB__GUID-CC41C14B-41D0-4AD6-8668-86F6B1390D14">
                        <p class="titleinfigure">图7-3使用Data Guard复制的复合分片</p><img src="img/admin_3v_133c.png" alt="下面是图7-3的描述" title="下面是图7-3的描述" longdesc="img_text/admin_3v_133c.html"><br><a href="img_text/admin_3v_133c.html">“图7-3使用Data Guard复制进行复合分片”的说明</a></div>
                     <!-- class="figure" -->
                     <p>运行以下GDSCTL命令以部署上图中显示的示例配置。</p><pre class="pre codeblock"><code>CREATE SHARDCATALOG -sharding composite -database host00：1521：cat -region dc1，dc2，dc3 ADD GSM -gsm gsm1 -listener 1571 -catalog host00：1521：cat -region dc1 ADD GSM -gsm gsm2 -listener 1571 -catalog host00：1521 ：cat -region dc2 ADD GSM -gsm gsm3 -listener 1571 -catalog host00：1521：cat -region dc3 START GSM -gsm gsm1 START GSM -gsm gsm2 START GSM -gsm gsm3 ADD SHARDSPACE -shardspace shardspace_a ADD SHARDSPACE -shardspace shardspace_b ADD SHARDGROUP -shardgroup shardgroup_a1 -shardspace shardspace_a -region dc1 -deploy_as primary ADD SHARDGROUP -shardgroup shardgroup_a2 -shardspace shardspace_a -region dc1 -deploy_as active_standby ADD SHARDGROUP -shardgroup shardgroup_a3 -shardspace shardspace_a -region dc3 -deploy_as active_standby ADD SHARDGROUP -shardgroup shardgroup_b1 -shardspace shardspace_b -region dc1 -deploy_as primary ADD SHARDGROUP -shardgroup shardgroup_b2 -shardspace shardspace_b -region dc1 -deploy_as active_standby ADD SHARDGROUP -shardgroup shard group_b3 -shardspace shardspace_b -region dc2 -deploy_as active_standby CREATE SHARD -shardgroup shardgroup_a1 -destination host01 -credential orcl_cred ...CREATE SHARD -shardgroup shardgroup_b3 -destination host09 -credential orcl_cred DEPLOY</code></pre></div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="sharding-high-availability.html#GUID-C668B8C7-0F94-4F85-B8E1-A6B91548BBB6" title="Oracle Sharding与Oracle数据库复制技术集成，可在分片级别实现高可用性和灾难恢复。">分片级高可用性</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-4FC0AC46-0B8B-4670-BBE4-052228492C72" name="GUID-4FC0AC46-0B8B-4670-BBE4-052228492C72"></a><h3 id="SHARD-GUID-4FC0AC46-0B8B-4670-BBE4-052228492C72" class="sect3"><span class="enumeration_section">7.3</span>将Oracle GoldenGate与分片数据库一起使用</h3>
               <div>
                  <p>Oracle GoldenGate用于细粒度主动 - 主动复制，其中所有分片都是可写的，并且每个分片可以部分复制到分片组内的其他分片。</p>
                  <p>在Oracle GoldenGate中，复制是在块级别处理的。例如，在下图中的Shardgroup 1中，存储在每个分片中的一半数据被复制到一个分片，另一半被复制到另一个分片。如果任何分片变得不可用，则其工作负载将分散在分片组中的其他两个分片之间。多个故障转移目标可以减轻分片故障的影响，因为没有单个分片必须处理来自故障分片的所有工作负载。</p>
                  <div class="figure" id="GUID-4FC0AC46-0B8B-4670-BBE4-052228492C72__SYSTEM-MANAGEDSHARDINGWITHGOLDENGAT-A0EF952D">
                     <p class="titleinfigure">图7-4使用Golden Gate复制的系统管理分片</p><img src="img/admin_3v_137a.png" alt="下面是图7-4的描述" title="下面是图7-4的描述" longdesc="img_text/admin_3v_137a.html"><br><a href="img_text/admin_3v_137a.html">“图7-4使用Golden Gate复制进行系统管理的分片”的说明</a></div>
                  <!-- class="figure" -->
                  <p>使用Oracle GoldenGate复制，分片组可以包含分片表中每行的多个副本;因此，在分片组内提供高可用性，并且不需要具有分片组的本地副本，就像Data Guard复制一样。在shardgroup中复制每一行的次数称为其<span class="italic">复制因子，</span>并且是可配置参数。
                  </p>
                  <p>要提供灾难恢复，可以将分片组复制到一个或多个数据中心。分片组的每个副本可以具有不同数量的分片，复制因子，数据库版本和硬件平台。但是，所有shardgroup副本必须具有相同数量的块，因为复制是在块级别完成的。</p>
                  <p>上图中的Shardgroup 2包含与Shardgroup 1相同的数据，但位于不同的数据中心。两个数据中心的碎片都是可写的。默认复制因子2用于两个分片组。</p>
                  <p>请注意，由于Shardgroup 2仅包含两个分片且复制因子为2，因此分片将完全复制，并且每个分片都包含存储在分片数据库中的所有数据。这意味着可以执行路由到这些分片的任何查询，而无需跨越分片。此分片组中只有一个故障转移目标;如果碎片发生故障，另一个碎片上的负载会翻倍。</p>
                  <p>Oracle Sharding旨在最大限度地减少对不同分片上的同一行执行的冲突更新的数量。这实现了为每个散列值范围指定<span class="italic">主块</span>并将对应数据的大多数请求路由到该块。
                  </p>
                  <p>有时，由于状态转换（例如块移动或拆分，或者碎片上升或下降），无法避免更新冲突。用户还可以有意地允许冲突以最小化事务等待时间。对于这种情况，Oracle GoldenGate提供自动冲突检测和解决方案，可以处理各种冲突，包括插入 - 删除冲突。</p>
                  <p>在创建任何分片之前，有一些先决条件：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>注册调度程序（使用GDSCTL <code>create shard</code>片时）</p>
                     </li>
                     <li>
                        <p>准备站点安全钱包或客户端和服务器证书。</p>
                     </li>
                     <li>
                        <p>安装Oracle GoldenGate并添加至少一个带分片选项的安全部署，并启动GoldenGate服务和服务器。</p>
                     </li>
                     <li>
                        <p>在每个Oracle主目录中，复制用于添加GoldenGate部署的客户端钱包，并将其放在$ ORACLE_BASE / admin / ggshd_wallet /中。</p>
                     </li>
                     <li>
                        <p>从GoldenGate安装主目录加载PL / SQL包。如果要使用GDSCTL <code class="codeph">CREATE SHARD</code> SHARD创建分片，则此步骤仅适用于分片目录。如果您正在使用GDSCTL <code class="codeph">ADD SHARD</code> SHARD，它将应用于分片目录和所有分片。
                        </p>
                     </li>
                  </ul>
                  <p>运行以下GDSCTL命令以部署上图中显示的示例配置。</p><pre class="pre codeblock"><code>CREATE SHARDCATALOG -database host00：1521：shardcat -chunks 60 -user'gsmcatuser / <span class="variable" translate="no">gsmcatuser_password</span> - <span class="bold">repl OGG</span> -sharding system -sdb orasdb ADD GSM -gsm gsm1 -listener 1571 -catalog shard-dir1：1521：shardcat -localons 3841 ADD GSM -gsm gsm2 -listener 1571 -catalog shard-dir1：1521：shardcat -localons 3841 START GSM -gsm gsm1 START GSM -gsm gsm2 CONFIGURE -timeout 900 ADD REGION -region dc1 ADD REGION -region dc2 MODIFY GSM -gsm gsm1 -region dc1 MODIFY GSM -gsm gsm2 -region dc2 ADD SHARDGROUP -shardgroup shardgroup1 -region dc1 <span class="bold">-repfactor 2</span> ADD SHARDGROUP -shardgroup shardgroup2 -region dc2 <span class="bold">-repfactor 2</span> CREATE SHARD -shardgroup shardgroup1 -destination host01 -credential oracle_cred -netparam / home / oracle / netca_dbhome。 rsp -gg_service host01：9900 / deployment_name -gg_password ggadmin_password -dbparamfile /home/oracle/dbparams01.tmp -dbtemplatefile /home/oracle/sharddb01.dbt CREATE SHARD -shardgroup shardgroup1 -destination host02 -credential oracle_cred -netparam / home / oracle / netca_db home.rsp -gg_service host02：9900 / remote_scheduler_agent -gg_password ggadmin_password -dbparamfile /home/oracle/dbparams02.tmp -dbtemplatefile /home/oracle/sharddb02.dbt CREATE SHARD -shardgroup shardgroup1 -destination host03 -credential oracle_cred -netparam / home / oracle /netca_dbhome.rsp -gg_service host03：9900 / remote_scheduler_agent -gg_password ggadmin_password -dbparamfile /home/oracle/dbparams03.tmp -dbtemplatefile /home/oracle/sharddb03.dbt CREATE SHARD -shardgroup shardgroup2 -destination host04 -credential oracle_cred -netparam / home / oracle / netca_dbhome.rsp -gg_service host04：9900 / remote_scheduler_agent -gg_password ggadmin_password -dbparamfile /home/oracle/dbparams04.tmp -dbtemplatefile /home/oracle/sharddb04.dbt CREATE SHARD -shardgroup shardgroup2 -destination host05 -credential oracle_cred -netparam / home /oracle/netca_dbhome.rsp -gg_service host05：9900 / remote_scheduler_agent -gg_password ggadmin_password -dbparamfile /home/oracle/dbparams05.tmp -dbtemplatefile / home / oracl e / sharddb05.dbt部署</code></pre><p>请注意，上面的示例使用<code class="codeph">CREATE SHARD</code>在部署期间创建新的分片。<code class="codeph">ADD SHARD</code>是<code class="codeph">CREATE SHARD</code>的替代方法， <code class="codeph">ADD SHARD</code>方法假定已经存在可以转换为数据库分片的干净的slate数据库实例。
                  </p>
                  <div class="infoboxnote" id="GUID-4FC0AC46-0B8B-4670-BBE4-052228492C72__GUID-762C2E8A-0B04-41BD-BE0B-4AF8429320BB">
                     <p class="notep1">注意：</p>
                     <p>与使用Data Guard或Active Data Guard进行分片复制不同，您无法手动部署Oracle GoldenGate，必须使用<code class="codeph">DEPLOY</code>命令完成。
                     </p>
                     <p>Oracle GoldenGate不支持将PDB作为分片。</p>
                  </div>
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-4FC0AC46-0B8B-4670-BBE4-052228492C72__GUID-DB192465-74C2-4853-A026-F4A32BAE6C77">
                     <p class="notep1">也可以看看：</p>
                     <p>在融合中间件中<span id="GUID-4FC0AC46-0B8B-4670-BBE4-052228492C72__GGSAU"><cite>使用</cite></span> <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/shard&amp;id=GGSAU-GUID-2C059382-7753-4EFA-B313-A6E0DAF7EA1C" target="_blank">Oracle GoldenGate Sharding</a> <span id="GUID-4FC0AC46-0B8B-4670-BBE4-052228492C72__GGSAU"><cite>使用Oracle GoldenGate微服务架构</cite></span>指南，了解有关将Oracle GoldenGate与Oracle Sharding配合使用的更多信息。
                     </p>
                     <p></p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="sharding-high-availability.html#GUID-C668B8C7-0F94-4F85-B8E1-A6B91548BBB6" title="Oracle Sharding与Oracle数据库复制技术集成，可在分片级别实现高可用性和灾难恢复。">分片级高可用性</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
         </div>
      </article>
   </body>
</html>