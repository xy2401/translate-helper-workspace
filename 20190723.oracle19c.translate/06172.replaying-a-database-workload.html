<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="After a captured workload is preprocessed, it can be replayed repeatedly on a replay system that is running the same version of Oracle Database."></meta>
      <meta name="description" content="After a captured workload is preprocessed, it can be replayed repeatedly on a replay system that is running the same version of Oracle Database."></meta>
      <title>重播数据库工作负载</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Testing Guide "></meta>
      <meta property="og:description" content="After a captured workload is preprocessed, it can be replayed repeatedly on a replay system that is running the same version of Oracle Database."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Testing Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="testing-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-07T01:43:11-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2008, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96279-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="preprocessing-a-database-workload.html" title="Previous" type="text/html"></link>
      <link rel="next" href="analyzing-captured-and-replayed-workloads.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Testing Guide"></meta>
    <meta name="dcterms.isVersionOf" content="RATUG"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="preprocessing-a-database-workload.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="analyzing-captured-and-replayed-workloads.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">测试指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="database-replay.html" property="item" typeof="WebPage"><span property="name">数据库重播</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">重播数据库工作负载</li>
            </ol>
            <a id="GUID-1F638D8F-7168-492D-BAD6-39F4F36EAD9B" name="GUID-1F638D8F-7168-492D-BAD6-39F4F36EAD9B"></a><a id="RATUG131"></a>
            
            <h2 id="RATUG-GUID-1F638D8F-7168-492D-BAD6-39F4F36EAD9B" class="sect2"><span class="enumeration_chapter">12</span>重播数据库工作负载</h2>
         </header>
         <div class="ind">
            <div>
               <div><span>在对捕获的工作负载进行预处理后，可以在运行相同版本的Oracle数据库的重放系统上重复执行该工作负载。</span> 通常，将重放预处理工作负载的重放系统应该是与生产系统分开的测试系统。
               </div>
               <p>本章介绍如何在测试系统上重放数据库工作负载，并包含以下部分：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="replaying-a-database-workload.html#GUID-EA0C0608-0B0C-4D2B-B6A4-2B8FFC548F8F" title="正确准备重播系统和规划工作负载重放可确保重放准确。">重播数据库工作负载的步骤</a></p>
                  </li>
                  <li>
                     <p><a href="replaying-a-database-workload.html#GUID-B97B7550-A947-45D0-A31B-636A6427DD86" title="本节介绍如何使用Enterprise Manager重播数据库工作负载。">使用Enterprise Manager重播数据库工作负载</a></p>
                  </li>
                  <li>
                     <p><a href="replaying-a-database-workload.html#GUID-F4B0C255-243D-4C85-A003-F876AA25E845" title="通过重播计划功能，您可以扩展捕获的工作负载的实例，使其包含在整合的重放中，然后控制重放中实例的相对回放计划。">使用Enterprise Manager设置重播计划和参数</a></p>
                  </li>
                  <li>
                     <p><a href="replaying-a-database-workload.html#GUID-64593639-9102-4C30-8EB9-71F28ABED05A" title="本节介绍如何使用Enterprise Manager监视工作负载重放。监视工作负载重放的主要工具是Oracle Enterprise Manager。">使用Enterprise Manager监视工作负载重放</a></p>
                  </li>
                  <li>
                     <p><a href="replaying-a-database-workload.html#GUID-B7EC0F88-A2E4-41C9-97E0-2DCAE0F63490" title="与导入Enterprise Manager外部的工作负载一样，您可以将重播导入Enterprise Manager以对其进行管理。">导入企业管理器外部重播</a></p>
                  </li>
                  <li>
                     <p><a href="replaying-a-database-workload.html#GUID-0F8D20F3-A4A1-4A89-852A-449C2E7C9602" title="本节介绍如何使用DBMS_WORKLOAD_REPLAY包重播数据库工作负载。">使用API重播数据库工作负载</a></p>
                  </li>
                  <li>
                     <p><a href="replaying-a-database-workload.html#GUID-6AB48629-25B9-4E07-AD7C-DE830E1022A2" title="本节介绍如何使用API和视图监视工作负载重放。">使用API监视工作负载重放</a></p>
                  </li>
               </ul>
               <div class="infobox-tip" id="GUID-1F638D8F-7168-492D-BAD6-39F4F36EAD9B__GUID-819370F5-6614-43E8-9293-BF794AE4AA1C">
                  <p class="notep1">小费：</p>
                  <p>在重放数据库工作负载之前，您必须先：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>捕获生产系统上的工作负载，如<a href="capturing-a-database-workload.html#GUID-E774C161-98C0-43EF-8B78-DD74E2A2A219" title="本章介绍如何在生产系统上捕获数据库工作负载。">捕获数据库工作负载中所述</a></p>
                     </li>
                     <li>
                        <p>预处理捕获的工作负载，如<a href="preprocessing-a-database-workload.html#GUID-4CEE2F79-F5A7-4EBA-9018-0CB99AB51C0A" title="捕获工作负载并完成测试系统的设置后，必须预处理捕获的数据。">预处理数据库工作负载中所述</a></p>
                     </li>
                  </ul>
               </div>
            </div><a id="RATUG135"></a><div class="props_rev_3"><a id="GUID-EA0C0608-0B0C-4D2B-B6A4-2B8FFC548F8F" name="GUID-EA0C0608-0B0C-4D2B-B6A4-2B8FFC548F8F"></a><h3 id="RATUG-GUID-EA0C0608-0B0C-4D2B-B6A4-2B8FFC548F8F" class="sect3"><span class="enumeration_section">12.1</span>重播数据库工作负载的步骤</h3>
               <div>
                  <div><span>正确准备重播系统和规划工作负载重放可确保重放准确。</span> 在重放数据库工作负载之前，请完成以下步骤以准备重播系统和工作负载重放：</div>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="replaying-a-database-workload.html#GUID-8E08DCF5-5AC2-44CE-B49B-B2765C5673CC" title="捕获的工作负载必须已经过预处理并复制到重放系统。复制预处理工作负载的目录的目录对象必须存在于重放系统中。">设置重播目录</a></p>
                     </li>
                     <li>
                        <p><a href="replaying-a-database-workload.html#GUID-076EFFC4-D4EA-4F75-88E6-9766713BD384" title="在重放工作负载之前，重放系统上的应用程序数据状态在逻辑上应与工作负载捕获开始时捕获系统的状态等效。这最小化了重放期间的重放差异。还原数据库的方法取决于捕获工作负载之前使用的备份方法。">恢复数据库</a></p>
                     </li>
                     <li>
                        <p><a href="replaying-a-database-workload.html#GUID-5ACBE3DE-4919-46B6-8D8D-20B8CA132AC4" title="捕获的工作负载可能包含对外部系统的引用，例如数据库链接或外部表。通常，您应该重新配置这些外部交互，以避免在重放期间影响其他生产系统。">解决对外部系统的引用</a></p>
                     </li>
                     <li>
                        <p><a href="replaying-a-database-workload.html#GUID-823FEDBB-B93B-47DF-AE72-FBD3832DFD9B" title="在工作负载捕获期间，将捕获用于连接到生产系统的连接字符串。为了使重放成功，您需要将这些连接字符串重新映射到重放系统。然后，重播客户端可以使用重新映射的连接连接到重放系统。">连接重映射</a></p>
                     </li>
                     <li>
                        <p><a href="replaying-a-database-workload.html#GUID-A00C24B9-28C9-46E4-839F-A0ABDA6C4C24" title="在工作负载捕获期间，将捕获用于连接到生产系统的数据库用户或模式的用户名。您可以选择将捕获的用户名重新映射到新用户或架构的用户名。">用户重新映射</a></p>
                     </li>
                     <li>
                        <p><a href="replaying-a-database-workload.html#GUID-289F573A-9C83-4A29-A1D4-323705E8293D" title="还原数据库并重新映射连接和用户后，您可以设置相应的重播选项。">指定重播选项</a></p>
                     </li>
                     <li>
                        <p><a href="replaying-a-database-workload.html#GUID-22C2E8D1-48E7-492E-B116-CDE79686E1BE" title="默认情况下，在工作负载重放期间重播所有捕获的数据库调用。您可以使用工作负载筛选器指定在工作负载重放期间要包含在工作负载中或从工作负载中排除的数据库调">使用带工作负载重放的过滤器</a></p>
                     </li>
                     <li>
                        <p><a href="replaying-a-database-workload.html#GUID-80A5AAE5-53E8-4775-AE5F-B43ADDB6E07F" title="此时，您需要设置并启动重播客户端，这些客户端将连接到重放系统并根据工作负载中捕获的内容发送请求。">设置重播客户端</a></p>
                     </li>
                  </ul>
               </div><a id="RATUG136"></a><div class="props_rev_3"><a id="GUID-8E08DCF5-5AC2-44CE-B49B-B2765C5673CC" name="GUID-8E08DCF5-5AC2-44CE-B49B-B2765C5673CC"></a><h4 id="RATUG-GUID-8E08DCF5-5AC2-44CE-B49B-B2765C5673CC" class="sect4"><span class="enumeration_section">12.1.1</span>设置重播目录</h4>
                  <p>捕获的工作负载必须已经过预处理并复制到重放系统。复制预处理工作负载的目录的目录对象必须存在于重放系统中。</p>
               </div><a id="RATUG133"></a><div class="props_rev_3"><a id="GUID-076EFFC4-D4EA-4F75-88E6-9766713BD384" name="GUID-076EFFC4-D4EA-4F75-88E6-9766713BD384"></a><h4 id="RATUG-GUID-076EFFC4-D4EA-4F75-88E6-9766713BD384" class="sect4"><span class="enumeration_section">12.1.2</span>恢复数据库</h4>
                  <div>
                     <div><span>在重放工作负载之前，重放系统上的应用程序数据状态在逻辑上应与工作负载捕获开始时捕获系统的状态等效。这最小化了重放期间的重放差异。还原数据库的方法取决于捕获工作负载之前使用的备份方法。</span> 例如，如果使用RMAN备份捕获系统，则可以使用RMAN <code class="codeph">DUPLICATE</code>功能来创建测试数据库。有关更多信息，请参阅<span class="q">“ <a href="capturing-a-database-workload.html#GUID-372BA03D-7A24-4300-A0AE-30E0D9D9C724" title="在开始工作负载捕获之前，您应该有一个策略来恢复测试系统上的数据库。">捕获数据库工作负载的先决条件</a> ”</span> 。
                     </div>
                     <p>使用重放系统上的相应应用程序数据创建数据库后，执行要测试的系统更改，例如数据库或操作系统升级。数据库重放的主要目的是测试系统更改对捕获的工作负载的影响。因此，您应该进行的系统更改应该使用捕获的工作负载定义您正在进行的测试。</p>
                  </div>
               </div><a id="RATUG137"></a><div class="props_rev_3"><a id="GUID-5ACBE3DE-4919-46B6-8D8D-20B8CA132AC4" name="GUID-5ACBE3DE-4919-46B6-8D8D-20B8CA132AC4"></a><h4 id="RATUG-GUID-5ACBE3DE-4919-46B6-8D8D-20B8CA132AC4" class="sect4"><span class="enumeration_section">12.1.3</span>解析对外部系统的引用</h4>
                  <div>
                     <div><span>捕获的工作负载可能包含对外部系统的引用，例如数据库链接或外部表。通常，您应该重新配置这些外部交互，以避免在重放期间影响其他生产系统。</span> 在重放工作负载之前需要解决的外部引用包括：</div>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>数据库链接</p>
                           <p>重放系统通常不希望与其他数据库交互。因此，您应该重新配置所有数据库链接以指向包含重播所需数据的相应数据库。</p>
                        </li>
                        <li>
                           <p>外部表格</p>
                           <p>在重放期间，使用外部表引用的目录对象指定的所有外部文件都必须可供数据库使用。这些文件的内容应与捕获期间的内容相同，用于定义外部表的文件名和目录对象也应该有效。</p>
                        </li>
                        <li>
                           <p>目录对象</p>
                           <p>您应该通过在还原数据库后适当地重新定义重放系统中存在的目录对象来重新配置对生产系统上的目录的任何引用。</p>
                        </li>
                        <li>
                           <p>网址</p>
                           <p>需要配置存储在数据库中的URL / URI，以便在工作负载捕获期间访问的Web服务将在重放期间指向正确的URL。如果工作负载引用存储在生产系统中的URL，则应在重放期间隔离测试系统网络。</p>
                        </li>
                        <li>
                           <p>电子邮件</p>
                           <p>为避免在重放期间重新发送电子邮件通知，应将重播系统可访问的任何电子邮件服务器配置为忽略对传出电子邮件的请求。</p>
                        </li>
                     </ul>
                     <div class="infobox-tip" id="GUID-5ACBE3DE-4919-46B6-8D8D-20B8CA132AC4__GUID-8E8F665B-D35F-4F00-B0F1-CA819DD33B70">
                        <p class="notep1">小费：</p>
                        <p>为避免在重放期间影响其他生产系统，Oracle强烈建议在无法访问生产环境主机的隔离专用网络中运行重放。</p>
                     </div>
                  </div>
               </div><a id="RATUG138"></a><div class="props_rev_3"><a id="GUID-823FEDBB-B93B-47DF-AE72-FBD3832DFD9B" name="GUID-823FEDBB-B93B-47DF-AE72-FBD3832DFD9B"></a><h4 id="RATUG-GUID-823FEDBB-B93B-47DF-AE72-FBD3832DFD9B" class="sect4"><span class="enumeration_section">12.1.4</span>连接重映射</h4>
                  <div>
                     <p>在工作负载捕获期间，将捕获用于连接到生产系统的连接字符串。为了使重放成功，您需要将这些连接字符串重新映射到重放系统。然后，重播客户端可以使用重新映射的连接连接到重放系统。</p>
                     <p>对于Oracle Real Application Clusters（Oracle RAC）数据库，您可以将所有连接字符串映射到负载平衡连接字符串。如果重放系统上的节点数与捕获系统不同，这尤其有用。或者，如果要将工作负载定向到特定实例，则可以使用服务或在重新映射的连接字符串中显式指定实例标识符。</p>
                  </div>
               </div><a id="RATUG4067"></a><div class="props_rev_3"><a id="GUID-A00C24B9-28C9-46E4-839F-A0ABDA6C4C24" name="GUID-A00C24B9-28C9-46E4-839F-A0ABDA6C4C24"></a><h4 id="RATUG-GUID-A00C24B9-28C9-46E4-839F-A0ABDA6C4C24" class="sect4"><span class="enumeration_section">12.1.5</span>用户重映射</h4>
                  <p>在工作负载捕获期间，将捕获用于连接到生产系统的数据库用户或模式的用户名。您可以选择将捕获的用户名重新映射到新用户或架构的用户名。</p>
               </div><a id="RATUG139"></a><div class="props_rev_3"><a id="GUID-289F573A-9C83-4A29-A1D4-323705E8293D" name="GUID-289F573A-9C83-4A29-A1D4-323705E8293D"></a><h4 id="RATUG-GUID-289F573A-9C83-4A29-A1D4-323705E8293D" class="sect4"><span class="enumeration_section">12.1.6</span>指定重播选项</h4>
                  <div>
                     <div><span>还原数据库并重新映射连接和用户后，您可以设置相应的重播选项。</span> 例如：</div>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="replaying-a-database-workload.html#GUID-72101FAD-1C09-4F15-A691-EAE0EDE86ACF" title="synchronization参数控制用于数据库重放的同步方法。">指定同步方法</a></p>
                        </li>
                        <li>
                           <p><a href="replaying-a-database-workload.html#GUID-776F6E15-7429-4434-B4BC-8FEA180DB708" title="connect_time_scale参数使您可以缩放工作负载捕获开始和每个会话连接之间的经过时间。">控制会话连接速率</a></p>
                        </li>
                        <li>
                           <p><a href="replaying-a-database-workload.html#GUID-D8D4EEE8-AB75-453B-B696-35A99263504F" title="用户思考时间是重播用户在单个会话中发出呼叫之间等待的时间。">控制会话中的请求率</a></p>
                        </li>
                     </ul>
                  </div><a id="RATUG140"></a><div class="props_rev_3"><a id="GUID-72101FAD-1C09-4F15-A691-EAE0EDE86ACF" name="GUID-72101FAD-1C09-4F15-A691-EAE0EDE86ACF"></a><h5 id="RATUG-GUID-72101FAD-1C09-4F15-A691-EAE0EDE86ACF" class="sect5"><span class="enumeration_section">12.1.6.1</span>指定同步方法</h5>
                     <div>
                        <p><code class="codeph">synchronization</code>参数控制用于数据库重放的同步方法。
                        </p>
                        <p>如果参数设置为<code class="codeph">TIME</code> ，则重放将使用与捕获相同的挂钟时序。所有数据库会话登录时间都将与捕获完全重放。同样，数据库会话中的事务之间的所有时间将被保留并在捕获时重放。这种同步方法将为大多数工作负载产生良好的重放。
                        </p>
                        <p>如果此参数设置为<code class="codeph">SCN</code> ，则在重放期间将观察捕获的工作负载中的<code class="codeph">COMMIT</code>顺序，并且只有在所有相关<code class="codeph">COMMIT</code>操作完成后才会执行所有重放操作。这种同步方法可能会为某些工作负载带来显着的延迟。如果是这种情况，建议使用<code class="codeph">TIME</code>作为<code class="codeph">synchronization</code>参数。
                        </p>
                        <p>如果此参数设置为<code class="codeph">OBJECT_ID</code> ，则只有在完成所有相关<code class="codeph">COMMIT</code>操作后，才会执行所有重放操作。相关<code class="codeph">COMMIT</code>操作必须符合以下条件：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>在工作负载捕获中的给定操作之前发布</p>
                           </li>
                           <li>
                              <p>至少修改了至少一个给定操作引用的数据库对象，无论是隐式还是显式</p>
                           </li>
                        </ul>
                        <p>将此参数设置为<code class="codeph">OBJECT_ID</code>可以在工作负载重放期间为在工作负载捕获期间未引用相同数据库对象的<code class="codeph">COMMIT</code>操作提供更多并发性。
                        </p>
                     </div>
                  </div><a id="RATUG141"></a><div class="props_rev_3"><a id="GUID-776F6E15-7429-4434-B4BC-8FEA180DB708" name="GUID-776F6E15-7429-4434-B4BC-8FEA180DB708"></a><h5 id="RATUG-GUID-776F6E15-7429-4434-B4BC-8FEA180DB708" class="sect5"><span class="enumeration_section">12.1.6.2</span>控制会话连接速率</h5>
                     <div><span><code class="codeph">connect_time_scale</code>参数使您可以缩放工作负载捕获开始和每个会话连接之间的经过时间。</span> 您可以使用此选项在重放期间使用给定的百分比值操纵会话连接时间。默认值为100，它将尝试连接捕获的所有会话。将此参数设置为0将尝试立即连接所有会话。
                     </div>
                  </div><a id="RATUG142"></a><div class="props_rev_3"><a id="GUID-D8D4EEE8-AB75-453B-B696-35A99263504F" name="GUID-D8D4EEE8-AB75-453B-B696-35A99263504F"></a><h5 id="RATUG-GUID-D8D4EEE8-AB75-453B-B696-35A99263504F" class="sect5"><span class="enumeration_section">12.1.6.3</span>控制会话内的请求速率</h5>
                     <div>
                        <div><span>用户思考时间是重播用户在单个会话中发出呼叫之间等待的时间。</span> 要控制重放速度，请使用<code class="codeph">think_time_scale</code>参数在重放期间缩放用户思考时间。
                        </div>
                        <p>如果在重放期间执行用户调用的速度比捕获期间要慢，则可以通过将<code class="codeph">think_time_auto_correct</code>参数设置为<code class="codeph">TRUE</code>来使数据库重放尝试赶上。这将使重播客户端缩短呼叫之间的思考时间，以便重放的总体经过时间将更接近地匹配捕获的经过时间。
                        </p>
                        <p>如果在重放期间比捕获期间更快地执行用户调用，则将<code class="codeph">think_time_auto_correct</code>参数设置为<code class="codeph">TRUE</code>将不会更改思考时间。重播客户端不会增加调用之间的思考时间以匹配捕获的经过时间。
                        </p>
                     </div>
                  </div>
               </div><a id="RATUG261"></a><div class="props_rev_3"><a id="GUID-22C2E8D1-48E7-492E-B116-CDE79686E1BE" name="GUID-22C2E8D1-48E7-492E-B116-CDE79686E1BE"></a><h4 id="RATUG-GUID-22C2E8D1-48E7-492E-B116-CDE79686E1BE" class="sect4"><span class="enumeration_section">12.1.7</span>使用具有工作负载重放的过滤器</h4>
                  <div>
                     <p>默认情况下，在工作负载重放期间重播所有捕获的数据库调用。您可以使用工作负载筛选器指定在工作负载重放期间要包含在工作负载中或从工作负载中排除的数据库调</p>
                     <p>首先定义工作负载重放过滤器，然后将其添加到a <a id="d22870e1258" class="indexterm-anchor"></a>重放过滤器集，以便它们可用于工作负载重放。工作负载过滤器有两种类型：包含过滤器和排除过滤器。<a id="d22870e1265" class="indexterm-anchor"></a>通过包含筛选器，您可以指定将要重播的数据库调用。<a id="d22870e1272" class="indexterm-anchor"></a>使用排除筛选器可以指定不会重播的数据库调用。您可以在工作负载重播中使用包含过滤器或排除过滤器，但不能同时使用两者。在创建重放过滤器集时，工作负载过滤器被确定为包含或排除过滤器。
                     </p>
                  </div>
               </div><a id="RATUG143"></a><div class="props_rev_3"><a id="GUID-80A5AAE5-53E8-4775-AE5F-B43ADDB6E07F" name="GUID-80A5AAE5-53E8-4775-AE5F-B43ADDB6E07F"></a><h4 id="RATUG-GUID-80A5AAE5-53E8-4775-AE5F-B43ADDB6E07F" class="sect4"><span class="enumeration_section">12.1.8</span>设置重播客户端</h4>
                  <div>
                     <div>重放客户端是一个多线程程序（位于<code class="codeph">$ORACLE_HOME/bin</code>目录中的名为<code class="codeph">wrc</code>的可执行文件），其中每个线程都从捕获的会话中提交工作负载。在重播开始之前，数据库将等待重播客户端连接。<span>此时，您需要设置并启动重播客户端，这些客户端将连接到重放系统并根据工作负载中捕获的内容发送请求。</span></div>
                     <p>在开始重播客户端之前，请确保：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>重播客户端软件安装在将运行它的主机上</p>
                        </li>
                        <li>
                           <p>重播客户端可以访问重播目录</p>
                        </li>
                        <li>
                           <p>重播目录包含预处理的工作负载捕获</p>
                        </li>
                        <li>
                           <p>重播用户具有正确的用户ID，密码和权限（重放用户需要DBA角色，不能是<code class="codeph">SYS</code>用户）</p>
                        </li>
                        <li>
                           <p>重播客户端不会在运行数据库的系统上启动</p>
                        </li>
                        <li>
                           <p>重播客户端读取文件系统上的捕获目录，该文件系统与数据库文件所在的文件系统不同</p>
                           <p>为此，请将捕获目录复制到将运行重播客户端的系统。重放完成后，您可以删除捕获目录。</p>
                        </li>
                     </ul>
                     <p>满足这些先决条件后，您可以继续使用<code class="codeph">wrc</code>可执行文件设置和启动重播客户端。<code class="codeph">wrc</code>可执行文件使用以下语法：</p><pre class="oac_no_warn" dir="ltr">wrc [用户/密码[@server]] MODE = [value] [keyword = [value]]</pre><p>参数<code class="codeph">user</code> ， <code class="codeph">password</code>和<code class="codeph">server</code>指定用于连接到重放数据库的用户名，密码和连接字符串。参数<code class="codeph">mode</code>指定运行<code class="codeph">wrc</code>可执行文件的模式。可能的值包括<code class="codeph">replay</code> （默认值）， <code class="codeph">calibrate</code>和<code class="codeph">list_hosts</code> 。parameter <code class="codeph">keyword</code>指定用于执行的选项，并且取决于所选的模式。要显示可能的关键字及其对应的值，请运行不带任何参数的<code class="codeph">wrc</code>可执行文件。
                     </p>
                     <p>以下部分描述了运行<code class="codeph">wrc</code>可执行文件时可以选择的模式：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="replaying-a-database-workload.html#GUID-4316A9DF-554D-481E-987A-90D06E5AE7F6" title="由于一个重播客户端可以启动与数据库的多个会话，因此不必为捕获的每个会话启动重播客户端。需要启动的重播客户端数量取决于工作负载流的数量，主机数量以及每个主机的重播客户端数量。">校准重播客户端</a></p>
                        </li>
                        <li>
                           <p><a href="replaying-a-database-workload.html#GUID-0E7CD4B5-433D-408A-990B-DD499C11ACCB" title="确定重放工作负载所需的重播客户端数量后，需要通过在安装它们的主机上以重播模式运行wrc可执行文件来启动重播客户端。">启动重播客户端</a></p>
                        </li>
                        <li>
                           <p><a href="replaying-a-database-workload.html#GUID-CFB2030D-C77B-495F-98CF-10953D2A937B" title="您可以通过在list_hosts模式下运行wrc可执行文件来显示参与工作负载捕获和工作负载重放的主机。">显示主机信息</a></p>
                        </li>
                     </ul>
                  </div><a id="RATUG144"></a><div class="props_rev_3"><a id="GUID-4316A9DF-554D-481E-987A-90D06E5AE7F6" name="GUID-4316A9DF-554D-481E-987A-90D06E5AE7F6"></a><h5 id="RATUG-GUID-4316A9DF-554D-481E-987A-90D06E5AE7F6" class="sect5"><span class="enumeration_section">12.1.8.1</span>校准重播客户端</h5>
                     <div>
                        <p>由于一个重播客户端可以启动与数据库的多个会话，因此不必为捕获的每个会话启动重播客户端。需要启动的重播客户端数量取决于工作负载流的数量，主机数量以及每个主机的重播客户端数量。</p>
                        <p>要估计重放特定工作负载所需的重播客户端和主机数，请运行<code class="codeph">wrc</code>可执行文件<a id="d22870e1565" class="indexterm-anchor"></a>校准模式。
                        </p>
                        <p>在校准模式下， <code class="codeph">wrc</code>可执行文件接受以下关键字：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">replaydir</code>指定包含要重播的预处理工作负载捕获的目录。如果未指定，则默认为当前目录。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">process_per_cpu</code>指定每个CPU可以运行的最大客户端进程数。默认值为4。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">threads_per_process</code>指定可在客户端进程中运行的最大线程数。默认值为50。
                              </p>
                           </li>
                        </ul>
                        <p>以下示例显示如何在校准模式下运行<code class="codeph">wrc</code>可执行文件：</p><pre class="oac_no_warn" dir="ltr">％&gt; wrc mode =校准replaydir =。/重播</pre><p>在此示例中，执行<code class="codeph">wrc</code>可执行文件以估计重放存储在当前目录下名为<code class="codeph">replay</code>的子目录中的工作负载捕获所需的重放客户端和主机的数量。在以下示例输出中，建议使用至少21个重播客户端，分为6个CPU：</p><pre class="oac_no_warn" dir="ltr">Workload Replay客户端：版本12.1.0.0.1  - 生产于2011年9月30日星期五13:06:33版权所有（c）1982,2011，Oracle。版权所有。工作负载报告：/ oracle / replay / -----------------------建议：考虑使用至少21个客户端分为6个CPU。工作负载特征： - 最大并发：1004个会话 - 总会话数：1013假设： - 每50个并发会话1个客户端进程 - 每个CPU 4个客户端进程 - 认为时间刻度= 100  - 连接时间刻度= 100  - 同步= TRUE</pre></div>
                  </div><a id="RATUG145"></a><div class="props_rev_3"><a id="GUID-0E7CD4B5-433D-408A-990B-DD499C11ACCB" name="GUID-0E7CD4B5-433D-408A-990B-DD499C11ACCB"></a><h5 id="RATUG-GUID-0E7CD4B5-433D-408A-990B-DD499C11ACCB" class="sect5"><span class="enumeration_section">12.1.8.2</span>启动重播客户端</h5>
                     <div>
                        <div><span>确定重放工作负载所需的重播客户端数量后，需要通过在安装它们的主机上以重播模式运行<code class="codeph">wrc</code>可执行文件来启动重播客户端。</span> 一旦启动，每个重播客户端将启动与数据库的一个或多个会话以驱动工作负载重放。
                        </div>
                        <p>在重放模式下， <code class="codeph">wrc</code>可执行文件接受以下关键字：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">userid</code>和<code class="codeph">password</code>指定重播客户端的重播用户的用户标识和密码。如果未指定，则这些值默认为<code class="codeph">system</code>用户。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">server</code>指定用于连接到重播系统的连接字符串。如果未指定，则该值默认为空字符串。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">replaydir</code>指定包含要重播的预处理工作负载捕获的目录。如果未指定，则默认为当前目录。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">workdir</code>指定将写入客户端日志的目录。此参数仅与<code class="codeph">debug</code>参数一起用于调试目的。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">debug</code>指定是否将创建调试数据。可能的值包括：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><code class="codeph">上</code></p>
                                    <p>调试数据将写入工作目录中的文件</p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">离</code></p>
                                    <p>不会写入调试数据（默认值）</p>
                                 </li>
                              </ul>
                              <div class="infoboxnote" id="GUID-0E7CD4B5-433D-408A-990B-DD499C11ACCB__GUID-737330EF-05AB-4019-938A-826A8483579B">
                                 <p class="notep1">注意：</p>
                                 <p>在调试模式下运行<code class="codeph">wrc</code>可执行文件之前，请联系Oracle支持以获取更多信息。
                                 </p>
                              </div>
                           </li>
                           <li>
                              <p><code class="codeph">connection_override</code>指定是否覆盖存储在<code class="codeph">DBA_WORKLOAD_CONNECTION_MAP</code>视图中的连接映射。如果设置为<code class="codeph">TRUE</code> ，则将忽略存储在<code class="codeph">DBA_WORKLOAD_CONNECTION_MAP</code>视图中的连接重映射，并将使用使用<code class="codeph">server</code>参数指定的连接字符串。如果设置为<code class="codeph">FALSE</code> ，则所有重播线程将使用存储在<code class="codeph">DBA_WORKLOAD_CONNECTION_MAP</code>视图中的连接重映射进行连接。这是默认设置。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">walletdir</code>指向自动登录软件密钥库目录的位置。默认值为空字符串。在重播加密工作负载捕获期间， <code class="codeph">walletdir</code>是必需的。对于非加密捕获，不得设置<code class="codeph">walletdir</code> ，并且默认为空字符串。
                              </p>
                           </li>
                        </ul>
                        <div class="infoboxnote" id="GUID-0E7CD4B5-433D-408A-990B-DD499C11ACCB__GUID-E881A619-7410-41DF-98A6-3275FD811F63">
                           <p class="notep1">注意：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>对于加密工作负载捕获，必须使用<code class="codeph">oracle.rat.database_replay.encryption</code> （区分大小写）标识符设置密码。密码存储在自动登录软件密钥库中。
                                 </p>
                              </li>
                              <li>
                                 <p>在重放加密工作负载捕获期间，您必须设置单独的客户端软件密钥库。例如：</p><pre class="pre codeblock"><code>rm -rf <span class="italic">keystore_location</span> mkdir <span class="italic">keystore_location</span> mkstore -wrl <span class="italic">keystore_location</span> -create mkstore -wrl <span class="italic">keystore_location</span> <span class="italic">-createEntry'oracle.rat.database_replay.encryption'secret_key</span> mkstore -wrl <span class="italic">keystore_location</span> -createSSO</code></pre><p><code class="codeph"><span class="codeinlineitalic">secret_key</span></code>必须与在加密工作负载捕获期间创建的服务器端软件密钥库中使用的<code class="codeph"><span class="codeinlineitalic">secret_key</span></code>匹配。
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <p>在所有重播客户端都已连接之后，数据库将自动在所有可用的重播客户端之间分配工作负载捕获流，并且可以开始工作负载重放。您可以使用<code class="codeph">V$WORKLOAD_REPLAY_THREAD</code>视图监控重播客户端的状态。重播完成后，所有重播客户端将自动断开连接。
                        </p>
                        <div class="section">
                           <p class="subhead3" id="GUID-0E7CD4B5-433D-408A-990B-DD499C11ACCB__GUID-75980CA5-8D9E-4165-9E0E-E6FB1EB71232">示例：在重放模式下运行wrc可执行文件以进行非加密捕获</p>
                           <p>以下示例显示如何在重放模式下运行<code class="codeph">wrc</code>可执行文件：</p><pre class="oac_no_warn" dir="ltr">％&gt; wrc system / password @ test mode = replay replaydir =。/ replay</pre><p>在此示例中， <code class="codeph">wrc</code>可执行文件启动重播客户端以重放存储在当前目录下名为<code class="codeph">replay</code>的子目录中的工作负载捕获。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-0E7CD4B5-433D-408A-990B-DD499C11ACCB__GUID-9E3E00FB-6960-4B1B-96D1-871633756E0F">示例：以重播模式运行wrc可执行文件以进行加密捕获</p>
                           <p>以下示例显示如何在重放模式下运行<code class="codeph">wrc</code>可执行文件以进行加密工作负载捕获：</p><pre class="pre codeblock"><code>％&gt; wrc system / password @ test mode = replay replaydir =。/ replay walletdir = / tmp / replay_encrypt_cwallet</code></pre><p>在此示例中， <code class="codeph">wrc</code>可执行文件启动重播客户端以重放存储在当前目录下名为<code class="codeph">replay</code>的子目录中的工作负载捕获。 <code class="codeph">walletdir</code>指向自动登录软件密钥库目录的位置。
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="RATUG146"></a><div class="props_rev_3"><a id="GUID-CFB2030D-C77B-495F-98CF-10953D2A937B" name="GUID-CFB2030D-C77B-495F-98CF-10953D2A937B"></a><h5 id="RATUG-GUID-CFB2030D-C77B-495F-98CF-10953D2A937B" class="sect5"><span class="enumeration_section">12.1.8.3</span>显示主机信息</h5>
                     <div>
                        <p>您可以通过在list_hosts模式下运行<code class="codeph">wrc</code>可执行文件来显示参与工作负载捕获和工作负载重放的主机。
                        </p>
                        <p>在list_hosts模式下， <code class="codeph">wrc</code>可执行文件接受关键字<code class="codeph">replaydir</code> ，该关键字指定包含要重播的预处理工作负载捕获的目录。如果未指定，则默认为当前目录。
                        </p>
                        <p>以下示例显示如何在list_hosts模式下运行<code class="codeph">wrc</code>可执行文件：</p><pre class="oac_no_warn" dir="ltr">％&gt; wrc mode = list_hosts replaydir =。/ replay</pre><p>在此示例中，执行<code class="codeph">wrc</code>可执行文件以列出参与捕获或重放存储在当前目录下名为<code class="codeph">replay</code>的子目录中的工作负载捕获的所有主机。在以下示例输出中，显示了参与工作负载捕获的主机和三个后续重放：</p><pre class="oac_no_warn" dir="ltr">Workload Replay客户端：版本12.1.0.0.1  - 生产于2011年9月30日星期五13:44:48版权所有（c）1982,2011，Oracle。版权所有。主持人发现：捕获：prod1 prod2重播1：test1重播2：test1 test2重播3：testwin</pre></div>
                  </div>
               </div>
            </div><a id="RATUG262"></a><a id="RATUG147"></a><div class="props_rev_3"><a id="GUID-B97B7550-A947-45D0-A31B-636A6427DD86" name="GUID-B97B7550-A947-45D0-A31B-636A6427DD86"></a><h3 id="RATUG-GUID-B97B7550-A947-45D0-A31B-636A6427DD86" class="sect3"><span class="enumeration_section">12.2</span>使用Enterprise Manager重播数据库工作负载</h3>
               <div>
                  <p>本节介绍如何使用Enterprise Manager重播数据库工作负载。</p>
                  <div class="p">在继续之前，您必须已经创建了重播任务并从重播任务创建了重播。为此，请参阅<span class="q">“ <a href="preprocessing-a-database-workload.html#GUID-07329403-B681-4278-81F3-B72803E83B44" title="准备单个工作负载涉及多个任务。">使用Enterprise Manager准备单个数据库工作负载</a> ”</span> 。
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>重放数据库工作负载的主要工具是Oracle Enterprise Manager。如果Oracle Enterprise Manager不可用，您还可以使用API重播数据库工作负载，如<span class="q">“ <a href="replaying-a-database-workload.html#GUID-0F8D20F3-A4A1-4A89-852A-449C2E7C9602" title="本节介绍如何使用DBMS_WORKLOAD_REPLAY包重播数据库工作负载。">使用API重新映射数据库工作负载</a> ”中所述</span> 。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-B97B7550-A947-45D0-A31B-636A6427DD86__GUID-1A85F1EA-EA18-44DA-B4F9-424D55CC1F4F">使用Enterprise Manager重播数据库工作负载：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ol>
                        <li>
                           <p>从Enterprise Manager Cloud Control控制台的Enterprise菜单中，选择<span class="bold">Quality Management</span> ，然后选择<span class="bold">Database Replay</span> 。
                           </p>
                           <p>如果出现“数据库登录”页面，请以具有管理员权限的用户身份登录。</p>
                           <p>将显示“数据库重播”页面。</p>
                           <div class="figure" id="GUID-B97B7550-A947-45D0-A31B-636A6427DD86__GUID-327EBB40-F190-4AE0-B2D7-FCF985C88FFE"><img src="img/dbr.gif" width="505" alt="dbr.gif的描述如下" title="dbr.gif的描述如下" longdesc="img_text/dbr.html"><br><a href="img_text/dbr.html">插图描述dbr.gif</a></div>
                           <!-- class="figure" -->
                        </li>
                        <li>
                           <p>选择“ <span class="bold">重播任务”</span>选项卡，然后单击表中所需重播任务的链接。
                           </p>
                           <p>将显示重播的“重播任务”页面。</p>
                           <div class="figure" id="GUID-B97B7550-A947-45D0-A31B-636A6427DD86__GUID-4CE3CACE-9C14-4581-BCEB-B354262FFD97"><img src="img/dbr_replay_tasks.gif" width="509" alt="下面是dbr_replay_tasks.gif的描述" title="下面是dbr_replay_tasks.gif的描述" longdesc="img_text/dbr_replay_tasks.html"><br><a href="img_text/dbr_replay_tasks.html">说明描述dbr_replay_tasks.gif</a></div>
                           <!-- class="figure" -->
                        </li>
                        <li>
                           <p>单击<span class="bold">创建</span>的重播部分创建重播。
                           </p>
                           <p>将出现“创建重播”弹出窗口。</p>
                        </li>
                        <li>
                           <p>提供必需的名称和可选说明，然后单击“ <span class="bold">目标数据库”</span>图标。
                           </p>
                           <p>将出现“搜索和选择：目标”弹出窗口。</p>
                        </li>
                        <li>
                           <p>选择适当的数据库，然后单击“ <span class="bold">选择”</span> 。
                           </p>
                        </li>
                        <li>
                           <p>在“创建重播”弹出窗口中单击“ <span class="bold">确定</span> ”。
                           </p>
                           <p>将显示重播的“数据库重放”页面，其中包含一个任务列表，其中包含执行重播的链接。</p>
                           <div class="figure" id="GUID-B97B7550-A947-45D0-A31B-636A6427DD86__GUID-FBF0506B-F50B-46AE-BB4B-7AD7117C0D3A"><img src="img/dbr_replay_workload.gif" width="509" alt="下面是dbr_replay_workload.gif的描述" title="下面是dbr_replay_workload.gif的描述" longdesc="img_text/dbr_replay_workload.html"><br><a href="img_text/dbr_replay_workload.html">说明dbr_replay_workload.gif的描述</a></div>
                           <!-- class="figure" -->
                        </li>
                        <li>
                           <p>单击“ <span class="bold">重播工作负载”</span>任务的链接。
                           </p>
                           <p>将显示“重播工作负载：定位工作负载”页面。</p>
                           <div class="figure" id="GUID-B97B7550-A947-45D0-A31B-636A6427DD86__GUID-0CBF7B07-FE09-4E55-A5D7-00A2FEA38CA9"><img src="img/dbr_replay_loc_wkload.gif" width="511" alt="下面是dbr_replay_loc_wkload.gif的描述" title="下面是dbr_replay_loc_wkload.gif的描述" longdesc="img_text/dbr_replay_loc_wkload.html"><br><a href="img_text/dbr_replay_loc_wkload.html">说明描述dbr_replay_loc_wkload.gif</a></div>
                           <!-- class="figure" -->
                        </li>
                        <li>
                           <p>选择所需的工作负载位置选项。</p>
                           <p>如果之前未将工作负载从其存储位置复制到重播客户端可以访问的重放位置，请选择复制工作负载的选项。否则，请选择该选项以使用包含要重播的工作负载的现有重播目录。</p>
                           <p>单击“ <span class="bold">下一步”</span>以显示“重播工作负载：复制工作负载”页面。
                           </p>
                           <div class="figure" id="GUID-B97B7550-A947-45D0-A31B-636A6427DD86__GUID-B7775211-FD41-43EA-A70A-45FD8C2E9C81"><img src="img/dbr_replay_copy_wkload.gif" width="511" alt="下面是dbr_replay_copy_wkload.gif的描述" title="下面是dbr_replay_copy_wkload.gif的描述" longdesc="img_text/dbr_replay_copy_wkload.html"><br><a href="img_text/dbr_replay_copy_wkload.html">说明说明dbr_replay_copy_wkload.gif</a></div>
                           <!-- class="figure" -->
                        </li>
                        <li>
                           <p>提供所需的凭据以及要将工作负载复制到的工作负载目录的新位置，然后单击“ <span class="bold">下一步”</span> 。
                           </p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>统一重播有多个源工作负载，因此工作负载目录的当前位置可能需要多个源凭据。有关整合重播的详细信息，请参阅<span class="q">“ <a href="using-consolidated-database-replay.html#GUID-BBC96414-F08A-4D57-BA72-B28C1BBEE9F2" title="本节介绍如何将Consolidated Database Replay与Enterprise Manager一起使用。">使用统一数据库重放与企业管理器”</a> 。</span></p>
                              </li>
                           </ul>
                           <p>系统通过在处理期间显示进度条形图来响应，然后在复制操作结束后显示“重播工作负载：选择目录”页面。</p>
                           <div class="figure" id="GUID-B97B7550-A947-45D0-A31B-636A6427DD86__GUID-434D9C21-AFF9-4455-8000-D54F8C9302CC"><img src="img/dbr_replay_select_dir.gif" width="440" alt="下面是dbr_replay_select_dir.gif的描述" title="下面是dbr_replay_select_dir.gif的描述" longdesc="img_text/dbr_replay_select_dir.html"><br><a href="img_text/dbr_replay_select_dir.html">插图描述dbr_replay_select_dir.gif</a></div>
                           <!-- class="figure" -->
                        </li>
                        <li>
                           <p>指定目录对象，或创建指向包含工作负载的位置的新目录对象。如果在上一步中选择从工作负载位置复制到新位置，请确保目录对象指向您在“工作负载目录”的“新位置”部分中指定的确切位置。</p>
                           <p>系统通过显示捕获摘要进行响应。您可以展开“捕获详细信息”部分以查看工作负载配置文件和工作负载筛您还可以生成工作负载捕获分析器报告和数据库捕获报告。“合并重播”不会显示“捕获摘要”。</p>
                           <p>单击“ <span class="bold">下一步”</span>以显示“重播工作负荷：初始化选项”页面。
                           </p>
                           <div class="figure" id="GUID-B97B7550-A947-45D0-A31B-636A6427DD86__GUID-7B2C38C2-1906-4503-B9C2-E868BBF6C219"><img src="img/dbr_replay_init_options.gif" width="437" alt="下面是dbr_replay_init_options.gif的描述" title="下面是dbr_replay_init_options.gif的描述" longdesc="img_text/dbr_replay_init_options.html"><br><a href="img_text/dbr_replay_init_options.html">说明说明dbr_replay_init_options.gif</a></div>
                           <!-- class="figure" -->
                        </li>
                        <li>
                           <p>在“SQL性能分析器”部分中，保留或禁用“捕获SQL语句”选项，该选项在默认情况下启用并建议使用。如果您不想在重放结束时比较SQL调优集，则可以禁用此选项。</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>SQL性能分析器可以在SQL调优集中启动对SQL语句性能的环境变化的影响分析。您可以创建和分析SQL Performance Analyzer任务，以测试数据库升级，初始化参数更改，Exadata模拟或自定义实验的效果。任务比较试验前更改与试验后更改的影响。</p>
                                 <p>尽管数据库重放提供了对更改如何影响整个系统的分析，但您可以将SQL调优集与SQL性能分析器结合使用，以获得更多以SQL为中心的分析，了解更改如何影响SQL语句和执行计划。</p>
                                 <p>通过在工作负载重放期间捕获SQL调优集，您可以使用SQL性能分析器将此SQL调优集与工作负载捕获期间捕获的另一个SQL调优集进行比较，而无需重新执行SQL语句。这使您可以在运行数据库重放时获取SQL Performance Analyzer报告并比较更改前后的SQL性能。</p>
                              </li>
                              <li>
                                 <p>在Identify Source部分中，初始重播选项引用Customize Options页面上的连接映射和参数。连接与工作负载一起被捕获。</p>
                                 <div class="infoboxnote" id="GUID-B97B7550-A947-45D0-A31B-636A6427DD86__GUID-C05ECE62-389B-4C2A-9CA9-32842967DB84">
                                    <p class="notep1">注意：</p>
                                    <p>对于合并重播或Oracle RAC，此部分不会出现。</p>
                                 </div>
                              </li>
                           </ul>
                           <p>单击“ <span class="bold">下一步”</span>以显示“重播工作负荷：自定义选项”页面。
                           </p>
                           <div class="figure" id="GUID-B97B7550-A947-45D0-A31B-636A6427DD86__GUID-565A1FA8-F5C8-4742-8DF6-E7051C84715A"><img src="img/dbr_replay_cust_options.gif" width="435" alt="下面是dbr_replay_cust_options.gif的描述" title="下面是dbr_replay_cust_options.gif的描述" longdesc="img_text/dbr_replay_cust_options.html"><br><a href="img_text/dbr_replay_cust_options.html">说明描述dbr_replay_cust_options.gif</a></div>
                           <!-- class="figure" -->
                        </li>
                        <li>
                           <p>将捕获的连接字符串重新映射到指向重放系统的连接字符串。请注意，您需要重新映射每个捕获连接。例如，在上图中，您需要重新映射capture12_1和capture12_adc的连接。</p>
                           <p>（您可以重新映射每个工作负载的连接以进行整合重播。有一个Capture Name下拉列表可以选择工作负载。）</p>
                           <p>单击“ <span class="bold">连接映射”</span>选项卡。您可以使用多种方法重新映射捕获的连接字符串。您可以选择：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>通过选择此选项并输入要<span class="bold">使用的连接描述符，为所有客户端连接使用单个连接描述符</span> 。连接描述符应指向重放系统。
                                 </p>
                                 <p>要测试连接，请单击“ <span class="bold">测试连接”</span> 。如果连接描述符有效，则会显示一条信息消息，通知您连接已成功。
                                 </p>
                              </li>
                              <li>
                                 <p>通过选择此选项并输入要使用的<span class="bold">网络服务名称，为所有客户端连接使用单个TNS网络服务名称</span> 。所有重播客户端必须能够解析网络服务名称，这可以使用本地<code class="codeph">tnsnames.ora</code>文件来完成。
                                 </p>
                              </li>
                              <li>
                                 <p>通过选择此选项，为<span class="bold">工作负载中捕获的每个客户端连接描述符使用单独的连接描述符或网络服务名称，</span>并为每个捕获系统值输入重放客户端将使用的相应重播系统值。如果在“初始化选项”步骤中选择了“使用先前重播中的重播选项”选项，则会选择“使用单独的连接描述符”选项，并且以前的重播系统值将显示在下面的文本字段中。
                                 </p>
                                 <div class="infoboxnote" id="GUID-B97B7550-A947-45D0-A31B-636A6427DD86__GUID-5CB0B54B-696E-478D-8508-9FD63A1BE52C">
                                    <p class="notep1">注意：</p>
                                    <p>此选项不适用于合并重播。</p>
                                 </div>
                              </li>
                           </ul>
                        </li>
                        <li>
                           <p>使用重播参数指定重播选项，这些参数控制重放的某些方面。</p>
                           <p>要修改重播行为，请单击“ <span class="bold">重播参数”</span>选项卡，然后为每个重播参数输入所需的值。建议使用默认值。有关设置重播参数的信息，请参阅。
                           </p>
                           <p>设置重播参数后，单击“ <span class="bold">下一步”</span> 。
                           </p>
                           <p>将显示“重播工作负载：准备重播客户端”页面。</p>
                           <div class="figure" id="GUID-B97B7550-A947-45D0-A31B-636A6427DD86__GUID-AB0197E8-E153-4CBA-BA04-9D66CA8AA6A3"><img src="img/dbr_replay_prep_clients.gif" width="433" alt="下面是dbr_replay_prep_clients.gif的描述" title="下面是dbr_replay_prep_clients.gif的描述" longdesc="img_text/dbr_replay_prep_clients.html"><br><a href="img_text/dbr_replay_prep_clients.html">说明说明dbr_replay_prep_clients.gif</a></div>
                           <!-- class="figure" -->
                        </li>
                        <li>
                           <p>确保重播客户端已准备好重播：</p>
                           <p>在继续之前，必须设置重播客户端。</p>
                           <ol type="a">
                              <li>
                                 <p>单击“ <span class="bold">估计”</span>以确定重播所需的重播客户端和CPU数量。
                                 </p>
                              </li>
                              <li>
                                 <p>单击“ <span class="bold">添加重播客户端主机”</span>以为重播客户端添加一个或多个主机。（如果您不想添加任何重播客户端主机，您仍然可以从Enterprise Manager外部的命令行继续并启动重播客户端）。
                                 </p>
                                 <p>将显示“搜索并选择：重播客户端主机”弹出窗口。</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p>指定目标名称，然后单击“开始<span class="bold">”</span> ，或者只需单击“ <span class="bold">转到”</span>以显示可用主机的完整列表。
                                       </p>
                                    </li>
                                    <li>
                                       <p>选择主机，然后单击“ <span class="bold">选择”</span> 。
                                       </p>
                                    </li>
                                 </ul>
                              </li>
                              <li>
                                 <p>当主机名出现在“重播客户端主机”表的“目标”列中时，请根据估计结果指定建议的重播客户端数，然后确保为主机列出的CPU数量满足估计结果中的最小建议。您应该为每个捕获的工作负载启动至少一个重播客户端。</p>
                              </li>
                              <li>
                                 <p>在Configured列中，单击<span class="bold">No</span>链接以在出现的弹出窗口中配置重播客户端主机。
                                 </p>
                              </li>
                              <li>
                                 <p>在弹出窗口中完成输入后，单击“ <span class="bold">应用”</span> 。“已配置”列现在在“重播客户端主机”表中显示“是”。
                                 </p>
                              </li>
                           </ol>
                        </li>
                        <li>
                           <p>单击“ <span class="bold">下一步”</span>以启动重播客户端并显示“重播工作负载：等待客户端连接”页面。
                           </p>
                           <div class="figure" id="GUID-B97B7550-A947-45D0-A31B-636A6427DD86__GUID-376B55C6-B97E-4C67-B49F-0093C1087C90"><img src="img/dbr_replay_client.gif" width="444" alt="下面是dbr_replay_client.gif的描述" title="下面是dbr_replay_client.gif的描述" longdesc="img_text/dbr_replay_client.html"><br><a href="img_text/dbr_replay_client.html">插图描述dbr_replay_client.gif</a></div>
                           <!-- class="figure" -->
                           <div class="infoboxnote" id="GUID-B97B7550-A947-45D0-A31B-636A6427DD86__GUID-D0B1A7A9-26D6-42B9-BC1E-FA0DFB2CCEA8">
                              <p class="notep1">注意：</p>
                              <p>如果您已从“企业”菜单进入此过程中的此步骤，则还需要输入重播作业和重播结果存储主机的凭据。</p>
                           </div>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>启动重播客户端后，重播客户端连接将显示在“客户端连接”表中。</p>
                              </li>
                              <li>
                                 <p>如果连接了重播客户端，则时钟下方的文本会发生变化。</p>
                              </li>
                              <li>
                                 <p>连接至少一个重播客户端时，将填充“客户端连接”表。</p>
                              </li>
                           </ul>
                           <p>当所有重播客户端都已连接后，在页面底部输入主机凭据以启动重播作业，然后单击“ <span class="bold">下一步”</span>以显示“重播工作负载：审阅”页面。
                           </p>
                        </li>
                        <li>
                           <p>查看为工作负载重放定义的选项和参数。</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>连接的重播客户端的值必须至少为1才能成功提交重播工作负载作业。</p>
                              </li>
                              <li>
                                 <p>仅当至少连接了一个重播客户端时，才会启用“提交”按钮。</p>
                              </li>
                           </ul>
                        </li>
                        <li>
                           <p>如果所有内容都按预期显示，请单击“ <span class="bold">提交”</span>以提交重播作业。
                           </p>
                           <p>重播开始后，此重播的“数据库重放”页面的“主页”选项卡将重新显示，并显示一条系统消息，指出“工作负载重放已开始”。</p>
                        </li>
                     </ol>
                     <div class="infoboxnotealso" id="GUID-B97B7550-A947-45D0-A31B-636A6427DD86__GUID-4EEE0BB6-83D3-44EC-BB11-A204B438C946">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="q">“ <a href="replaying-a-database-workload.html#GUID-823FEDBB-B93B-47DF-AE72-FBD3832DFD9B" title="在工作负载捕获期间，将捕获用于连接到生产系统的连接字符串。为了使重放成功，您需要将这些连接字符串重新映射到重放系统。然后，重播客户端可以使用重新映射的连接连接到重放系统。">连接重映射</a> ”</span></p>
                           </li>
                           <li>
                              <p><span class="q">“ <a href="replaying-a-database-workload.html#GUID-289F573A-9C83-4A29-A1D4-323705E8293D" title="还原数据库并重新映射连接和用户后，您可以设置相应的重播选项。">指定重播选项</a> ”</span></p>
                           </li>
                           <li>
                              <p><span class="q">“ <a href="replaying-a-database-workload.html#GUID-80A5AAE5-53E8-4775-AE5F-B43ADDB6E07F" title="此时，您需要设置并启动重播客户端，这些客户端将连接到重放系统并根据工作负载中捕获的内容发送请求。">设置重播客户端</a> ”</span></p>
                           </li>
                           <li>
                              <p><span class="q">“ <a href="replaying-a-database-workload.html#GUID-4803ACC1-B1E0-4668-A6BB-1BA8FAD76071" title="本节介绍如何使用Enterprise Manager监视活动工作负载重放。">监控活动工作负载重放</a> ”</span></p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="RATUG4241"></a><div class="props_rev_3"><a id="GUID-F4B0C255-243D-4C85-A003-F876AA25E845" name="GUID-F4B0C255-243D-4C85-A003-F876AA25E845"></a><h3 id="RATUG-GUID-F4B0C255-243D-4C85-A003-F876AA25E845" class="sect3"><span class="enumeration_section">12.3</span>使用Enterprise Manager设置重播计划和参数</h3>
               <div>
                  <div><span>通过重播计划功能，您可以扩展捕获的工作负载的实例，使其包含在整合的重放中，然后控制重放中实例的相对回放计划。</span> 通过更新每个实例的活动会话图表的对齐，可视地显示捕获的工作负载实例的相对调度。
                  </div>
                  <div class="section">
                     <p>此功能适用于Cloud Control Database插件12.1.0.5及更高版本。</p>
                     <p>此功能使您可以完成以下任务：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type:disc">
                        <li>
                           <p><span class="bold">偏移实例，以便它们以不同的时间间隔执行</span></p>
                           <p>您可以调整每个工作负载实例的相对重播开始时间，以使Capture工作负载的计划实例的平均活动会话高峰时间保持一致。工作负载峰值的这种对齐可能会最大化系统负载，因此您可以试验测试系统在不同工作负载条件下的响应方式。</p>
                        </li>
                        <li>
                           <p><span class="bold">通过添加捕获的工作负载的实例来扩展重放工作负载</span></p>
                           <p>每个添加的实例都独立于其他实例进行重放。</p>
                           <p>通过指定工作负载的多个实例来扩展工作负载时，默认和建议的配置是重放其中一个实例中的DML语句。所有其他实例仅重放查询（仅限就绪）语句。</p>
                           <p>例如，如果工作负载具有对员工数据库的SQL插入，通常您希望只有一个实例执行Insert，而其他实例将绕过使用此Insert修改数据库的用户调用。但是，您可以通过取消选中“仅限重播查询”复选框来重写工作负载中的所有语句，从而覆盖实例的默认设置。</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-F4B0C255-243D-4C85-A003-F876AA25E845__GUID-9B423D14-AF82-4262-91D2-9FBE244D6EFF">要访问“计划重播计划”页面：</p>
                     <ol>
                        <li>
                           <p>在Database Replay主页中，单击<span class="bold">Replay Tasks</span>选项卡。
                           </p>
                        </li>
                        <li>
                           <p>单击具有多个工作负荷的现有重播任务的名称，以导航到“重播任务”页面。</p>
                        </li>
                        <li>
                           <p>单击“ <span class="bold">创建”</span>以创建新重播。
                           </p>
                        </li>
                        <li>
                           <p>在“创建重播”弹出窗口中提供必需信息，然后单击“ <span class="bold">确定”</span> 。</p>
                           <p>新重播将显示在“重播”表中。</p>
                        </li>
                        <li>
                           <p>在Replays表中单击新重播的名称。</p>
                           <p>任务列表现在出现在重播页面中。</p>
                        </li>
                        <li>
                           <p>单击“ <span class="bold">计划重播计划”</span>链接。
                           </p>
                           <p>将显示“计划重播计划”页面。</p>
                        </li>
                     </ol>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-F4B0C255-243D-4C85-A003-F876AA25E845__GUID-1123ECD6-228B-4D99-9AB6-C7FDFF39F1C9">要扩大重播次数：</p>
                     <ol>
                        <li>
                           <p>在“添加工作负载实例”按钮旁边的下拉列表中，选择要为其添加实例的“捕获”工作负载。</p>
                        </li>
                        <li>
                           <p>单击“ <span class="bold">添加工作负载实例”</span>以添加实例。
                           </p>
                        </li>
                     </ol>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-F4B0C255-243D-4C85-A003-F876AA25E845__GUID-D7CED3C3-49D2-4657-8394-BDA494B90B4F">安排时间间隔：</p>
                     <ol>
                        <li>
                           <p>在“重播延迟”列中，为第一个捕获实例保留默认值0，或者在实例开始执行之前调整所需的分钟数。</p>
                        </li>
                        <li>
                           <p>对每个捕获实例重复上述步骤，直到您设置了所有值来表示您希望为测试需求执行性能峰值的方式。</p>
                        </li>
                     </ol>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-F4B0C255-243D-4C85-A003-F876AA25E845__GUID-156DC0F0-D6EE-4876-B0F7-A53F1E87D549">要自动对齐工作负载峰值：</p>
                     <ol>
                        <li>
                           <p>单击“ <span class="bold">自动对齐”</span>按钮。
                           </p>
                        </li>
                     </ol>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-F4B0C255-243D-4C85-A003-F876AA25E845__GUID-4CD4E1F9-3984-4B00-9AA9-5E0C4474ECD1">要指定仅查询实例：</p>
                     <ol>
                        <li>
                           <p>对于您希望仅查询的每个实例，请启用“ <span class="bold">仅重播查询”</span>复选框。
                           </p>
                        </li>
                     </ol>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-F4B0C255-243D-4C85-A003-F876AA25E845__GUID-F64C386D-48E8-4A47-96FE-B148A679262C">要查看更新的计划：</p>
                     <ol>
                        <li>
                           <p>在“数据库重放”页面的“重播任务”选项卡中，单击包含计划重播的重播任务链接。</p>
                           <p>将显示“重播任务”页面。</p>
                        </li>
                        <li>
                           <p>单击“重播”表中的计划重播。</p>
                        </li>
                        <li>
                           <p>在“重播”页面中选择“审阅”选项卡。</p>
                        </li>
                     </ol>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="RATUG148"></a><div class="props_rev_3"><a id="GUID-64593639-9102-4C30-8EB9-71F28ABED05A" name="GUID-64593639-9102-4C30-8EB9-71F28ABED05A"></a><h3 id="RATUG-GUID-64593639-9102-4C30-8EB9-71F28ABED05A" class="sect3"><span class="enumeration_section">12.4</span>使用Enterprise Manager监控工作负载重播</h3>
               <div>
                  <div><span>本节介绍如何使用Enterprise Manager监视工作负载重放。监视工作负载重放的主要工具是Oracle Enterprise Manager。</span> 使用Enterprise Manager，您可以：</div>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>监视或停止活动工作负载重播</p>
                     </li>
                     <li>
                        <p>查看已完成的工作负载重播</p>
                     </li>
                  </ul>
                  <p>如果Oracle Enterprise Manager不可用，您可以使用API和视图监视工作负载重放，如<span class="q">“ <a href="replaying-a-database-workload.html#GUID-6AB48629-25B9-4E07-AD7C-DE830E1022A2" title="本节介绍如何使用API和视图监视工作负载重放。">使用API监视工作负载重放</a> ”中所述</span> 。
                  </p>
                  <p>本节包含以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="replaying-a-database-workload.html#GUID-4803ACC1-B1E0-4668-A6BB-1BA8FAD76071" title="本节介绍如何使用Enterprise Manager监视活动工作负载重放。">监视活动工作负载重播</a></p>
                     </li>
                     <li>
                        <p><a href="replaying-a-database-workload.html#GUID-D482064E-6B26-400F-8D96-B7686F887B70" title="本节介绍如何使用Enterprise Manager查看已完成的工作负载重放。">查看已完成的工作负载重播</a></p>
                     </li>
                  </ul>
               </div><a id="RATUG263"></a><a id="RATUG149"></a><div class="props_rev_3"><a id="GUID-4803ACC1-B1E0-4668-A6BB-1BA8FAD76071" name="GUID-4803ACC1-B1E0-4668-A6BB-1BA8FAD76071"></a><h4 id="RATUG-GUID-4803ACC1-B1E0-4668-A6BB-1BA8FAD76071" class="sect4"><span class="enumeration_section">12.4.1</span>监视活动工作负载重播</h4>
                  <div>
                     <p>本节介绍如何使用Enterprise Manager监视活动工作负载重放。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-4803ACC1-B1E0-4668-A6BB-1BA8FAD76071__GUID-2AFC2F82-E69F-4A6A-BC43-6DED6B9B4401">监视活动工作负载重放：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>在“数据库重放”页面中，单击“ <span class="bold">重播任务”</span>选项卡。</span></li>
                        <li class="stepexpand"><span>单击包含要监视重播进度的重播的重播任务的名称。</span></li>
                        <li class="stepexpand"><span>在“重播任务”页面的“重播”部分中，单击“创建重播”向导中已提交以进行处理的重播的名称。（此重播的“状态”列应显示“正在进行”。）</span><div>
                              <p>将显示“数据库重播”页面的“主页”选项卡，“重播摘要”将显示“正在运行”状态。</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>重放进度图表中的重播行在重放过程中动态更新。您可以单击“刷新”按钮更新图表。</p>
                                 </li>
                                 <li>
                                    <p>重播进度图表中的用户调用行指示数据库相对于捕获同时服务的工作负载量。</p>
                                 </li>
                                 <li>
                                    <p>在重播完成之前，重播发散摘要的数据不可用。</p>
                                 </li>
                              </ul>
                           </div>
                        </li>
                     </ol>
                  </div>
               </div><a id="RATUG286"></a><a id="RATUG150"></a><div class="props_rev_3"><a id="GUID-D482064E-6B26-400F-8D96-B7686F887B70" name="GUID-D482064E-6B26-400F-8D96-B7686F887B70"></a><h4 id="RATUG-GUID-D482064E-6B26-400F-8D96-B7686F887B70" class="sect4"><span class="enumeration_section">12.4.2</span>查看已完成的工作负载重播</h4>
                  <div>
                     <p>本节介绍如何使用Enterprise Manager查看已完成的工作负载重放。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-D482064E-6B26-400F-8D96-B7686F887B70__GUID-1EF6243C-817E-47AF-9EF3-538DF526DB9F">要查看已完成的工作负载重播：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>在“数据库重放”页面中，单击“ <span class="bold">重播任务”</span>选项卡。</span></li>
                        <li class="stepexpand"><span>单击包含要查看的已完成重播的重播任务的名称。</span></li>
                        <li class="stepexpand"><span>在“重播任务”页面的“重播”部分中，单击“创建重播”向导中已提交以进行处理的重播的名称。（此重播的“状态”列应显示“已完成”。）</span><div>
                              <p>将显示“数据库重播”页面的“主页”选项卡，“重播摘要”将显示“已完成状态”。</p>
                              <div class="figure" id="GUID-D482064E-6B26-400F-8D96-B7686F887B70__GUID-C0EDA23D-04BA-45A9-81DB-3CF9C78050D5"><img src="img/dbr_replay_completed.gif" width="508" alt="下面是dbr_replay_completed.gif的描述" title="下面是dbr_replay_completed.gif的描述" longdesc="img_text/dbr_replay_completed.html"><br><a href="img_text/dbr_replay_completed.html">说明dbr_replay_completed.gif的描述</a></div>
                              <!-- class="figure" -->
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>“用户调用”图表中的重播行以图形方式表示从开始到结束的整个重播过程中的重放进度。</p>
                                    <p>该图表显示了在用户调用方面，与工作负载捕获期间的已用时间相比，重放相同工作负载所花费的时间。如果重放行位于Capture行的上方或左侧，则重播系统比捕获系统更快地处理工作负载。</p>
                                 </li>
                                 <li>
                                    <p>在Replay Divergence Summary下，重播系统和捕获系统之间的任何错误和数据差异在重放期间显示为分散的数据库调用。您可以使用分散的总呼叫百分比作为重播质量的度量。</p>
                                    <p>要查看有关分支呼叫的详细信息，请单击“计数”列中与分叉呼叫类型对应的链接，以访问“重播期间的分散呼叫”页面。“重放期间的分散呼叫”页面显示最相关的重播呼叫集，这些呼叫与通过基于公共属性值和指定的过滤条件对它们进行分组而捕获的工作负载不同。要查看有关特定分支调用的详细信息（如调用属性，SQL文本和绑定变量），请单击SQL ID列中的相应链接以显示Replay Diverged Statement页面。</p>
                                 </li>
                              </ul>
                           </div>
                        </li>
                        <li class="stepexpand"><span>要返回“数据库重放”页面，请单击“数据库重放”面包屑。</span><div>
                              <div class="infoboxnotealso" id="GUID-D482064E-6B26-400F-8D96-B7686F887B70__GUID-312E464F-D7AA-461F-B1F4-F712B4256A40">
                                 <p class="notep1">也可以看看：</p>
                                 <p><span class="q">“ <a href="analyzing-captured-and-replayed-workloads.html#GUID-3E9AA9F2-B37B-4E03-9E00-FEB0A141631E" title="本章介绍如何使用各种数据库重放报告分析捕获和重放的工作负载。">分析捕获的和重放的工作负载</a> ”</span>以获取有关访问工作负载重放报告的信息</p>
                              </div>
                           </div>
                        </li>
                     </ol>
                  </div>
               </div>
            </div><a id="RATUG4242"></a><div class="props_rev_3"><a id="GUID-B7EC0F88-A2E4-41C9-97E0-2DCAE0F63490" name="GUID-B7EC0F88-A2E4-41C9-97E0-2DCAE0F63490"></a><h3 id="RATUG-GUID-B7EC0F88-A2E4-41C9-97E0-2DCAE0F63490" class="sect3"><span class="enumeration_section">12.5</span>在企业管理器外部导入重播</h3>
               <div>
                  <div><span>与导入Enterprise Manager外部的工作负载一样，您可以将重播导入Enterprise Manager以对其进行管理。</span> 要导入重播，请从重播任务导入重播，该重播任务可以包含一个或多个工作负载以及一个或多个重放。重放任务位于数据库重放层次结构的顶部，并充当这些其他从属组件的容器。
                  </div>
                  <div class="section">
                     <p>要导入的重放可以在测试数据库中运行，也可以完成重放并将重放目录存储在文件系统中。</p>
                     <p>此功能适用于Cloud Control Database插件12.1.0.5及更高版本。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-B7EC0F88-A2E4-41C9-97E0-2DCAE0F63490__GUID-7EBF83FD-BED6-463C-88F0-79B1FED9E0FA">要导入企业管理器外部的重播：</p>
                     <ol>
                        <li>
                           <p>在“数据库重放”页面中，单击“ <span class="bold">重播任务”</span>选项卡，然后选择所需的重播任务。
                           </p>
                           <p>将显示“重播任务”页面。</p>
                        </li>
                        <li>
                           <p>单击“重播”部分中的“ <span class="bold">导入</span> ”。
                           </p>
                           <p>将显示“导入重播：源”页面</p>
                        </li>
                        <li id="GUID-B7EC0F88-A2E4-41C9-97E0-2DCAE0F63490__BGBBEIBA">
                           <p>选择可用于导入重播的三个选项之一，然后单击“ <span class="bold">下一步”</span> 。
                           </p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><span class="bold">从文件系统中的目录导入一个或多个已完成的重播</span></p>
                                 <p>此选项通常适用于使用API创建的重播，您现在可以将其导入Enterprise Manager以进行后续处理。在这种情况下，企业管理器可能不一定管理重播数据库。</p>
                              </li>
                              <li>
                                 <p><span class="bold">从数据库目标导入一个或多个已完成的重播</span></p>
                                 <p>在这种情况下，企业管理器可能已经在管理重放数据库。重放可以在这个数据库上完成，或者可以像上面的选项那样加载。</p>
                              </li>
                              <li>
                                 <p><span class="bold">附加到在数据库目标中运行的此重播任务的重播</span></p>
                                 <p>此选项与上面的选项类似，但此重播仍在进行中，而不是已完成的重播。</p>
                              </li>
                           </ul>
                           <p>将显示“导入重播：数据库”页面。</p>
                        </li>
                        <li>
                           <p>单击<span class="bold">“数据库目标”字段旁边的搜索图标，然后从显示的弹出窗口中选择一个数据库。</span></p>
                           <div class="infoboxnote" id="GUID-B7EC0F88-A2E4-41C9-97E0-2DCAE0F63490__GUID-642C727C-0293-42F0-91E1-6E404F3CC72B">
                              <p class="notep1">注意：</p>
                              <p>读取重播的数据库的目标版本必须至少与您在重播任务中使用的目标版本一样高。例如，如果重播任务使用Oracle Database 12x，则您选择读取重播的数据库必须至少为12x版本。</p>
                           </div>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>系统现在请求数据库和主机凭据。</p>
                              </li>
                              <li>
                                 <p>在上一步中，如果您选择从文件系统中的目录导入一个或多个已完成的重播，则系统还需要工作负载位置。</p>
                              </li>
                              <li>
                                 <p>重放任务可以根据重放任务中包含的工作负载数量来确定这是否是整合重播。如果这是一个整合重播，则此步骤会要求您输入工作负载位置的整合重播目录。</p>
                              </li>
                           </ul>
                        </li>
                        <li>
                           <p>为上面的步骤提供必要的输入，然后单击“ <span class="bold">下一步”</span> 。
                           </p>
                           <p>将显示“导入重播：重播”页面。</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>如果在步骤<a href="replaying-a-database-workload.html#GUID-B7EC0F88-A2E4-41C9-97E0-2DCAE0F63490__BGBBEIBA">3中</a>选择“从文件系统中的目录导入一个或多个已完成的重播”，则此页面将提供“加载重播”按钮。
                                 </p>
                              </li>
                              <li>
                                 <p>如果在步骤<a href="replaying-a-database-workload.html#GUID-B7EC0F88-A2E4-41C9-97E0-2DCAE0F63490__BGBBEIBA">3中</a>选择“从数据库目标导入一个或多个已完成的重播”或“附加到在数据库目标中运行的此重播任务的重播”，则此页面将提供“发现重播”按钮。
                                 </p>
                              </li>
                           </ul>
                        </li>
                        <li>
                           <p>单击“ <span class="bold">加载重播”</span>或“ <span class="bold">发现重播”</span> ，具体取决于您在步骤<a href="replaying-a-database-workload.html#GUID-B7EC0F88-A2E4-41C9-97E0-2DCAE0F63490__BGBBEIBA">3中</a>的选择可用的按钮。
                           </p>
                           <p>如果找到，系统会在Discovered Replays表中显示一个或多个重放。</p>
                        </li>
                        <li>
                           <p>单击“ <span class="bold">下一步”</span>以加载重播，或选择一个或多个重播，然后单击“ <span class="bold">下一步”</span>继续导入重播。
                           </p>
                           <p>将显示“导入重播：审阅”页面。</p>
                        </li>
                        <li>
                           <p>如果一切按预期显示，请单击“ <span class="bold">提交”</span> 。
                           </p>
                           <p>数据库重播页面重新出现并显示一条消息，指出作业已成功提交。表格中用于导入重播的“状态”列将显示“正在进行”。</p>
                           <div class="infobox-tip" id="GUID-B7EC0F88-A2E4-41C9-97E0-2DCAE0F63490__GUID-B1BC3FCA-2AEF-4BED-81DB-9005C322B0AF">
                              <p class="notep1">小费：</p>
                              <p>您可以通过单击“审核”步骤中刚刚提交的重播名称来检查作业的进度。将显示“重播摘要”页面，您可以单击“数据库重播导入作业”链接以查看作业执行步骤的进度。</p>
                           </div>
                        </li>
                     </ol>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="RATUG151"></a><div class="props_rev_3"><a id="GUID-0F8D20F3-A4A1-4A89-852A-449C2E7C9602" name="GUID-0F8D20F3-A4A1-4A89-852A-449C2E7C9602"></a><h3 id="RATUG-GUID-0F8D20F3-A4A1-4A89-852A-449C2E7C9602" class="sect3"><span class="enumeration_section">12.6</span>使用API重播数据库工作负载</h3>
               <div>
                  <div><span>本节介绍如何使用<code class="codeph">DBMS_WORKLOAD_REPLAY</code>包重播数据库工作负载。</span> 您还可以使用Oracle Enterprise Manager重播数据库工作负载，如<span class="q">“ <a href="replaying-a-database-workload.html#GUID-B97B7550-A947-45D0-A31B-636A6427DD86" title="本节介绍如何使用Enterprise Manager重播数据库工作负载。">使用Enterprise Manager重新映射数据库工作负载</a> ”中所述</span> 。
                  </div>
                  <p>使用<code class="codeph">DBMS_WORKLOAD_REPLAY</code>包重播数据库工作负载是一个多步骤过程，涉及：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="replaying-a-database-workload.html#GUID-FBED93C2-DBF2-4CC1-A9A1-393CDB9B05BD" title="在预处理工作负载捕获并正确准备测试系统之后，可以初始化重放数据。初始化重放数据会将必要的元数据加载到工作负载重放所需的表中。">初始化重播数据</a></p>
                     </li>
                     <li>
                        <p><a href="replaying-a-database-workload.html#GUID-348FCFCF-A37E-44E8-9BBD-B18697EC29B0" title="初始化重放数据后，需要重新映射工作负载捕获中使用的连接字符串，以便用户会话可以连接到相应的数据库并执行重放期间捕获的外部交互。">重新映射连接</a></p>
                     </li>
                     <li>
                        <p><a href="replaying-a-database-workload.html#GUID-C9CBE72D-5948-4D4F-962B-96108B87507E" title="除了重新映射连接字符串之外，您还可以使用新架构或用户，而不是工作负载捕获中捕获的用户。">重新映射用户</a></p>
                     </li>
                     <li>
                        <p><a href="replaying-a-database-workload.html#GUID-EA09779B-E85F-45A7-A54E-3FED813AB68D" title="初始化重放数据并重新映射连接和用户后，您需要准备数据库以进行工作负载重放。">设置工作负载重播选项</a></p>
                     </li>
                     <li>
                        <p><a href="replaying-a-database-workload.html#GUID-434C455E-3BA3-4BF6-8DE8-4E5FACBABDAF" title="本节介绍如何添加和删除工作负载重放过滤器，以及如何创建和使用重放过滤器集。">定义工作负载重放过滤器和重放过滤器集</a></p>
                     </li>
                     <li>
                        <p><a href="replaying-a-database-workload.html#GUID-0AA0E9DD-400A-47A9-BB80-07B83FBA6064" title="本节介绍如何为工作负载重放设置超时操作。">设置重播超时操作</a></p>
                     </li>
                     <li>
                        <p><a href="replaying-a-database-workload.html#GUID-ED9DCCDB-2928-4BAC-9617-2314532AE517" title="在开始工作负载重放之前，需要执行任务。">开始工作负载重播</a></p>
                     </li>
                     <li>
                        <p><a href="replaying-a-database-workload.html#GUID-50EABBFB-99C4-42A1-8B3D-37072B01BB0E" title="暂停工作负载重放将暂停重播客户端发出的所有后续用户调用，直到重新启动或取消工作负载重放为止。">暂停工作负载重播</a></p>
                     </li>
                     <li>
                        <p><a href="replaying-a-database-workload.html#GUID-AF6D748C-D05E-4612-9578-A726A7427B0F" title="本节介绍如何恢复暂停的工作负载重播。">恢复工作负载重播</a></p>
                     </li>
                     <li>
                        <p><a href="replaying-a-database-workload.html#GUID-31D34E9B-14BA-4AE3-91DE-6D57BD4E5053" title="本节介绍如何取消工作负载重放。">取消工作负载重播</a></p>
                     </li>
                     <li>
                        <p><a href="replaying-a-database-workload.html#GUID-BE084EF0-D8EA-4BFF-A3A3-53A30E9C96FA" title="您可以从重放目录对象中检索有关工作负载捕获的所有信息，以及从目录中检索工作负载重放尝试的历史记录。">检索有关工作负载重播的信息</a></p>
                     </li>
                     <li>
                        <p><a href="replaying-a-database-workload.html#GUID-9EF34950-7ABC-4AC1-BFCA-734DB4DCF44E" title="加载工作负载重放的差异数据会将从重播目录检索到的每次重播尝试导入行导入DBA_WORKLOAD_REPLAY_DIVERGENCE视图，该视图显示有关重放尝试期间分歧的呼叫和错误的信息。">加载工作负载重放的分歧数据</a></p>
                     </li>
                     <li>
                        <p><a href="replaying-a-database-workload.html#GUID-13B2F26C-2655-4900-94A2-60322707D248" title="您可以删除为单个工作负载重放或给定目录对象中的所有工作负载重放检索的信息。">删除有关工作负载重播的信息</a></p>
                     </li>
                     <li>
                        <p><a href="replaying-a-database-workload.html#GUID-03B5F50F-40C2-4183-8E07-2B64319356FA" title="导出AWR数据可以对工作负载进行详细分析。">导出工作负载重播的AWR数据</a></p>
                     </li>
                     <li>
                        <p><a href="replaying-a-database-workload.html#GUID-9A1ACF42-5AB1-4FBA-91C8-153181404F07" title="从重放系统导出AWR数据后，您可以将AWR数据导入另一个系统。导入AWR数据可以对工作负载进行详细分析。">导入工作负载重播的AWR数据</a></p>
                     </li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-0F8D20F3-A4A1-4A89-852A-449C2E7C9602__GUID-77705B7E-E09F-4948-B51C-B68BADF2B020">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>有关<code class="codeph">DBMS_WORKLOAD_REPLAY</code>包的信息，请<code class="codeph">DBMS_WORKLOAD_REPLAY</code> <a href="../arpls/DBMS_WORKLOAD_REPLAY.html#ARPLS208" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                        </li>
                     </ul>
                  </div>
               </div><a id="RATUG152"></a><div class="props_rev_3"><a id="GUID-FBED93C2-DBF2-4CC1-A9A1-393CDB9B05BD" name="GUID-FBED93C2-DBF2-4CC1-A9A1-393CDB9B05BD"></a><h4 id="RATUG-GUID-FBED93C2-DBF2-4CC1-A9A1-393CDB9B05BD" class="sect4"><span class="enumeration_section">12.6.1</span>初始化重播数据</h4>
                  <div>
                     <div><span>在预处理工作负载捕获并正确准备测试系统之后，可以初始化重放数据。初始化重放数据会将必要的元数据加载到工作负载重放所需的表中。</span> 例如，捕获的连接字符串被加载到表中，在表中可以重新映射它们以进行重放。
                     </div>
                     <div class="section">
                        <p class="subhead3" id="GUID-FBED93C2-DBF2-4CC1-A9A1-393CDB9B05BD__GUID-3B869885-D5DE-42E2-A3B8-8CD8EC813247">要初始化重播数据：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>使用<a id="d22870e3509" class="indexterm-anchor"></a> <code class="codeph">INITIALIZE_REPLAY</code>程序：</p><pre class="oac_no_warn" dir="ltr">BEGIN DBMS_WORKLOAD_REPLAY.INITIALIZE_REPLAY（replay_name =&gt;'dec06_102'，replay_dir =&gt;'dec06'，plsql_mode =&gt;'top_level'）;结束; /</pre><p>在此示例中， <code class="codeph">INITIALIZE_REPLAY</code>过程将来自<code class="codeph">dec06</code>目录的预处理工作负载数据加载到数据库中。
                              </p>
                              <p>此示例中的<code class="codeph">INITIALIZE_REPLAY</code>过程使用以下参数：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><code class="codeph">replay_name</code> required参数指定可与其他API一起使用的重播名称，以检索先前重放的设置和过滤器。
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">replay_dir</code> required参数指定包含将要重播的工作负载捕获的目录。
                                    </p>
                                 </li>
                                 <li>
                                    <p>可选的<code class="codeph">plsql_mode</code>参数指定PL / SQL重放模式。
                                    </p>
                                    <p>可以为<code class="codeph">plsql_mode</code>参数设置这两个值：</p>
                                    <ul style="list-style-type:disc">
                                       <li>
                                          <p><code class="codeph">top_level</code> ：只有顶级PL / SQL调用。这是默认值。
                                          </p>
                                       </li>
                                       <li>
                                          <p><code class="codeph">extended</code> ：如果内部没有记录SQL，则在PL / SQL或顶级PL / SQL中执行SQL。非PL / SQL调用将以通常的方式重放。
                                          </p>
                                       </li>
                                    </ul>
                                 </li>
                              </ul>
                           </li>
                        </ul>
                        <div class="infoboxnote" id="GUID-FBED93C2-DBF2-4CC1-A9A1-393CDB9B05BD__GUID-A1145984-A0AC-457E-9398-80F039225CAC">
                           <p class="notep1">注意：</p>
                           <p>要在加密工作负载捕获上运行<code class="codeph">INITIALIZE_REPLAY</code> ，您需要使用<code class="codeph">oracle.rat.database_replay.encryption</code> （区分大小写）标识符设置密码。密码存储在软件密钥库中。您可以从<code class="codeph">DBA_WORKLOAD_CAPTURES</code>视图中查找工作负载捕获是否已加密。
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-FBED93C2-DBF2-4CC1-A9A1-393CDB9B05BD__GUID-CFEA8F0C-B0DB-4D13-B669-80B7B1780564">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><span class="q">“ <a href="preprocessing-a-database-workload.html#GUID-4FC4A529-D603-48A1-BA0E-12E8BB130733" title="本节介绍如何使用DBMS_WORKLOAD_REPLAY包预处理捕获的工作负载。">使用API预处理数据库工作负载</a> ”，</span>以获取有关预处理工作负载捕获的信息</p>
                              </li>
                              <li>
                                 <p><span class="q">“ <a href="replaying-a-database-workload.html#GUID-EA0C0608-0B0C-4D2B-B6A4-2B8FFC548F8F" title="正确准备重播系统和规划工作负载重放可确保重放准确。">重放数据库工作负载的步骤</a> ”，</span>用于准备测试系统的信息</p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="RATUG153"></a><div class="props_rev_3"><a id="GUID-348FCFCF-A37E-44E8-9BBD-B18697EC29B0" name="GUID-348FCFCF-A37E-44E8-9BBD-B18697EC29B0"></a><h4 id="RATUG-GUID-348FCFCF-A37E-44E8-9BBD-B18697EC29B0" class="sect4"><span class="enumeration_section">12.6.2</span>重新映射连接</h4>
                  <div>
                     <div><span>初始化重放数据后，需要重新映射工作负载捕获中使用的连接字符串，以便用户会话可以连接到相应的数据库并执行重放期间捕获的外部交互。</span> 要查看连接映射，请使用<code class="codeph">DBA_WORKLOAD_CONNECTION_MAP</code>视图。
                     </div>
                     <div class="section">
                        <p class="subhead3" id="GUID-348FCFCF-A37E-44E8-9BBD-B18697EC29B0__GUID-E5E82D13-86F5-422E-8515-B62E7958E954">要重新映射连接：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>使用<a id="d22870e3693" class="indexterm-anchor"></a> <code class="codeph">REMAP_CONNECTION</code>程序：</p><pre class="oac_no_warn" dir="ltr">BEGIN DBMS_WORKLOAD_REPLAY.REMAP_CONNECTION（connection_id =&gt; 101，replay_connection =&gt;'dlsun244：3434 / bjava21'）;结束; /</pre><p>在此示例中，对应于连接ID 101的连接将使用由<code class="codeph">replay_connection</code>参数定义的新连接字符串。
                              </p>
                              <p>此示例中的<code class="codeph">REMAP_CONNECTION</code>过程使用以下参数：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><code class="codeph">connection_id</code> required参数在初始化重放数据时生成，并且对应于工作负载捕获的连接。
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">replay_connection</code> required参数指定将在工作负载重放期间使用的新连接字符串。
                                    </p>
                                 </li>
                              </ul>
                           </li>
                        </ul>
                        <div class="infoboxnotealso" id="GUID-348FCFCF-A37E-44E8-9BBD-B18697EC29B0__GUID-BD17A90C-4AF7-4421-BEBE-C7BA4790CE69">
                           <p class="notep1">也可以看看：</p>
                           <p><span class="q">“ <a href="replaying-a-database-workload.html#GUID-823FEDBB-B93B-47DF-AE72-FBD3832DFD9B" title="在工作负载捕获期间，将捕获用于连接到生产系统的连接字符串。为了使重放成功，您需要将这些连接字符串重新映射到重放系统。然后，重播客户端可以使用重新映射的连接连接到重放系统。">连接重映射</a> ”</span></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="RATUG4068"></a><div class="props_rev_3"><a id="GUID-C9CBE72D-5948-4D4F-962B-96108B87507E" name="GUID-C9CBE72D-5948-4D4F-962B-96108B87507E"></a><h4 id="RATUG-GUID-C9CBE72D-5948-4D4F-962B-96108B87507E" class="sect4"><span class="enumeration_section">12.6.3</span>重新映射用户</h4>
                  <div>
                     <div><span>除了重新映射连接字符串之外，您还可以使用新架构或用户，而不是工作负载捕获中捕获的用户。</span> 要查看捕获的用户，请使用<code class="codeph">DBA_WORKLOAD_USER_MAP</code>视图。
                     </div>
                     <div class="section">
                        <p class="subhead3" id="GUID-C9CBE72D-5948-4D4F-962B-96108B87507E__GUID-F3013C9E-0429-444C-BDB9-193D127EF568">要重新映射用户：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>使用<a id="d22870e3823" class="indexterm-anchor"></a> <code class="codeph">SET_USER_MAPPING</code>程序：</p><pre class="oac_no_warn" dir="ltr">BEGIN DBMS_WORKLOAD_REPLAY.SET_USER_MAPPING（capture_user =&gt;'PROD'，replay_user =&gt;'TEST'）;结束; /</pre><p>在此示例中，捕获期间使用的<code class="codeph">PROD</code>用户在重放期间重新映射到<code class="codeph">TEST</code>用户。
                              </p>
                              <p>此示例中的<code class="codeph">SET_USER_MAPPING</code>过程使用以下参数：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><code class="codeph">capture_user</code> required参数指定在工作负载捕获期间捕获的用户名。
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">replay_user</code> required参数指定在重放期间将捕获的用户重新映射到的用户名。如果此参数设置为<code class="codeph">NULL</code> ，则禁用映射。
                                    </p>
                                 </li>
                              </ul>
                           </li>
                        </ul>
                        <div class="infoboxnotealso" id="GUID-C9CBE72D-5948-4D4F-962B-96108B87507E__GUID-FF53AEAC-2B70-4478-A493-05B9AD6F7C83">
                           <p class="notep1">也可以看看：</p>
                           <p><span class="q">“ <a href="replaying-a-database-workload.html#GUID-A00C24B9-28C9-46E4-839F-A0ABDA6C4C24" title="在工作负载捕获期间，将捕获用于连接到生产系统的数据库用户或模式的用户名。您可以选择将捕获的用户名重新映射到新用户或架构的用户名。">用户重映射</a> ”</span></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="RATUG154"></a><div class="props_rev_3"><a id="GUID-EA09779B-E85F-45A7-A54E-3FED813AB68D" name="GUID-EA09779B-E85F-45A7-A54E-3FED813AB68D"></a><h4 id="RATUG-GUID-EA09779B-E85F-45A7-A54E-3FED813AB68D" class="sect4"><span class="enumeration_section">12.6.4</span>设置工作负载重播选项</h4>
                  <div>
                     <div><span>初始化重放数据并重新映射连接和用户后，您需要准备数据库以进行工作负载重放。</span></div>
                     <div class="section">
                        <p class="subhead3" id="GUID-EA09779B-E85F-45A7-A54E-3FED813AB68D__GUID-37953254-F9E7-4702-BCDB-D08A03D67A75">要在重播系统上准备工作负载重播：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>使用<a id="d22870e3963" class="indexterm-anchor"></a> <code class="codeph">PREPARE_REPLAY</code>程序：</p><pre class="oac_no_warn" dir="ltr">BEGIN DBMS_WORKLOAD_REPLAY.PREPARE_REPLAY（synchronization =&gt;'OBJECT_ID'，capture_sts =&gt; TRUE，sts_cap_interval =&gt; 300）;结束; /</pre><p>在此示例中， <code class="codeph">PREPARE_REPLAY</code>过程准备先前已初始化的重播。还将与工作负载重放并行捕获SQL调优集。
                              </p>
                              <p><code class="codeph">PREPARE_REPLAY</code>过程使用以下参数：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><code class="codeph">synchronization</code> required参数控制工作负载重放期间使用的同步类型。
                                    </p>
                                    <p>如果参数设置为<code class="codeph">TIME</code> ，则重放将使用与捕获相同的挂钟时序。所有数据库会话登录时间都将与捕获完全重放。同样，数据库会话中的事务之间的所有时间将被保留并在捕获时重放。这种同步方法将为大多数工作负载产生良好的重放。
                                    </p>
                                    <p>如果此参数设置为<code class="codeph">SCN</code> （默认值），则在重放期间将观察捕获的工作负载中的<code class="codeph">COMMIT</code>顺序，并且只有在所有相关<code class="codeph">COMMIT</code>操作完成后才会执行所有重放操作。这种同步方法可能会为某些工作负载带来显着的延迟。如果是这种情况，建议使用<code class="codeph">TIME</code>作为同步参数。
                                    </p>
                                    <p>如果此参数设置为<code class="codeph">OBJECT_ID</code> ，则只有在完成所有相关<code class="codeph">COMMIT</code>操作后，才会执行所有重放操作。相关<code class="codeph">COMMIT</code>操作必须符合以下条件：</p>
                                    <ul style="list-style-type:disc">
                                       <li>
                                          <p>在工作负载捕获中的给定操作之前发布</p>
                                       </li>
                                       <li>
                                          <p>至少修改了至少一个给定操作引用的数据库对象，无论是隐式还是显式</p>
                                       </li>
                                    </ul>
                                    <p>将此参数设置为<code class="codeph">OBJECT_ID</code>可以在工作负载重放期间为在工作负载捕获期间不引用相同数据库对象的<code class="codeph">COMMIT</code>操作提供更多并发性。
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">connect_time_scale</code>参数缩放从工作负载捕获开始到会话与指定值连接的经过时间，并被解释为％值。使用此参数可以在重播期间增加或减少并发用户数。默认值为100。
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">think_time_scale</code>参数缩放来自同一会话的两个连续用户调用之间的经过时间，并被解释为％值。将此参数设置为0将在重播期间尽快将用户调用发送到数据库。默认值为100。
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">think_time_auto_correct</code>参数可在用户调用在重放期间完成的时间比在捕获期间花费更长时间时<code class="codeph">think_time_scale</code>调用之间的思考时间（基于<code class="codeph">think_time_scale</code>参数）。此参数可以设置为<code class="codeph">TRUE</code>或<code class="codeph">FALSE</code> 。如果工作负载重放花费的时间超过工作负载捕获，则将此参数设置为<code class="codeph">TRUE</code>可减少思考时间。默认值为<code class="codeph">TRUE</code> 。</p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">scale_up_multiplier</code>参数定义在重放期间扩展工作负载的次数。每个捕获的会话将同时重放此参数指定的次数。但是，每组相同的重放会话中只有一个会话将执行查询和更新。其余会话将仅执行查询。
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">capture_sts</code>参数指定是否与工作负载重放并行捕获SQL调优集。如果此参数设置为<code class="codeph">TRUE</code> ，则可以在工作负载重放期间捕获SQL调优集，并使用SQL Performance Analyzer将其与另一个SQL调优集进行比较，而无需重新执行SQL语句。这使您可以在运行数据库重放时获取SQL性能分析器报告并比较更改之前和之后的SQL性能。您还可以使用<code class="codeph">EXPORT_AWR</code>过程导出生成的SQL调优集及其AWR数据，如<span class="q">“ <a href="replaying-a-database-workload.html#GUID-03B5F50F-40C2-4183-8E07-2B64319356FA" title="导出AWR数据可以对工作负载进行详细分析。">导出工作负载重播的AWR数据</a> ”中所述</span> 。
                                    </p>
                                    <p>Oracle RAC不支持此功能。使用<code class="codeph">DBMS_WORKLOAD_REPLAY</code>定义的工作负载重<code class="codeph">DBMS_WORKLOAD_REPLAY</code>不适用于SQL调整集捕获。此参数的默认值为<code class="codeph">FALSE</code> 。</p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">sts_cap_interval</code>参数指定从光标高速缓存捕获SQL调整集的持续时间（以秒为单位）。默认值为300。将此参数的值设置为低于默认值可能会导致某些工作负载产生额外开销，因此不建议这样做。
                                    </p>
                                 </li>
                              </ul>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>有关设置这些参数的详细信息，请参阅<span class="q">“ <a href="replaying-a-database-workload.html#GUID-289F573A-9C83-4A29-A1D4-323705E8293D" title="还原数据库并重新映射连接和用户后，您可以设置相应的重播选项。">指定重播选项</a> ”</span> 。
                        </p>
                        <div class="infoboxnotealso" id="GUID-EA09779B-E85F-45A7-A54E-3FED813AB68D__GUID-CD94962C-3FF3-4A6E-A7C7-047279DD3DDE">
                           <p class="notep1">也可以看看：</p>
                           <p><span class="q">“ <a href="replaying-a-database-workload.html#GUID-EA0C0608-0B0C-4D2B-B6A4-2B8FFC548F8F" title="正确准备重播系统和规划工作负载重放可确保重放准确。">重播数据库工作负载的步骤</a> ”</span></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="RATUG264"></a><div class="props_rev_3"><a id="GUID-434C455E-3BA3-4BF6-8DE8-4E5FACBABDAF" name="GUID-434C455E-3BA3-4BF6-8DE8-4E5FACBABDAF"></a><h4 id="RATUG-GUID-434C455E-3BA3-4BF6-8DE8-4E5FACBABDAF" class="sect4"><span class="enumeration_section">12.6.5</span>定义工作负载重播过滤器和重播过滤器集</h4>
                  <div>
                     <div><span>本节介绍如何添加和删除工作负载重放过滤器，以及如何创建和使用重放过滤器集。</span> 
                     </div>
                     <p>本节包含以下主题：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="replaying-a-database-workload.html#GUID-BCFCE439-5ACF-476B-853B-AB456FAB9296">添加工作负载重放过滤器</a></p>
                        </li>
                        <li>
                           <p><a href="replaying-a-database-workload.html#GUID-43D8C6CD-8E77-4AD3-925B-C3F508E93B96">删除工作负载重播过滤器</a></p>
                        </li>
                        <li>
                           <p><a href="replaying-a-database-workload.html#GUID-F07AE474-DA24-4FA9-A997-5C1472873070">创建重播过滤器集</a></p>
                        </li>
                        <li>
                           <p><a href="replaying-a-database-workload.html#GUID-E5D3A78C-C4B7-4778-ACE2-9A92AF750E9E">使用重播过滤器集</a></p>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-434C455E-3BA3-4BF6-8DE8-4E5FACBABDAF__GUID-C3F8EA34-2568-47A4-BDAC-7DFC298B59A9">
                        <p class="notep1">也可以看看：</p>
                        <p><span class="q">“ <a href="replaying-a-database-workload.html#GUID-22C2E8D1-48E7-492E-B116-CDE79686E1BE" title="默认情况下，在工作负载重放期间重播所有捕获的数据库调用。您可以使用工作负载筛选器指定在工作负载重放期间要包含在工作负载中或从工作负载中排除的数据库调">使用带工作负载重放的过滤器</a> ”</span></p>
                     </div>
                  </div><a id="RATUG265"></a><div class="props_rev_3"><a id="GUID-BCFCE439-5ACF-476B-853B-AB456FAB9296" name="GUID-BCFCE439-5ACF-476B-853B-AB456FAB9296"></a><h5 id="RATUG-GUID-BCFCE439-5ACF-476B-853B-AB456FAB9296" class="sect5"><span class="enumeration_section">12.6.5.1</span>添加工作负载重<span class="enumeration_section">放过</span>滤器</h5>
                     <div>
                        <div class="section">
                           <p>本节介绍如何添加要在重放过滤器集中使用的新过滤器。</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-BCFCE439-5ACF-476B-853B-AB456FAB9296__GUID-6522CE7C-CA9C-43F2-88F2-470423AF7777">要添加新过滤器：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>使用<a id="d22870e4327" class="indexterm-anchor"></a> <code class="codeph">ADD_FILTER</code>程序：</p><pre class="oac_no_warn" dir="ltr">BEGIN DBMS_WORKLOAD_REPLAY.ADD_FILTER（fname =&gt;'user_ichan'，fattribute =&gt;'USER'，fvalue =&gt;'ICHAN'）;结束; /</pre><p>在此示例中， <code class="codeph">ADD_FILTER</code>过程添加名为user_ichan的过滤器，该过滤器可用于过滤掉属于用户名ICHAN的所有会话。</p>
                                 <p>此示例中的<code class="codeph">ADD_FILTER</code>过程使用以下参数：</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p><code class="codeph">fname</code> required参数指定要添加的过滤器的名称。
                                       </p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">fattribute</code> required参数指定将应用过滤器的属性。有效值包括PROGRAM，MODULE，ACTION，SERVICE，USER和CONNECTION_STRING。您必须指定将在重播期间使用的有效捕获的连接字符串作为CONNECTION_STRING属性。
                                       </p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">fvalue</code> required参数指定将应用过滤器的相应属性的值。可以使用％等通配符和某些属性，例如模块和操作。
                                       </p>
                                    </li>
                                 </ul>
                                 <p>添加所有工作负载重放过滤器后，您可以创建可在重放工作负载时使用的重放过滤器集。</p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="RATUG266"></a><div class="props_rev_3"><a id="GUID-43D8C6CD-8E77-4AD3-925B-C3F508E93B96" name="GUID-43D8C6CD-8E77-4AD3-925B-C3F508E93B96"></a><h5 id="RATUG-GUID-43D8C6CD-8E77-4AD3-925B-C3F508E93B96" class="sect5"><span class="enumeration_section">12.6.5.2</span>删除工作负载重<span class="enumeration_section">放过</span>滤器</h5>
                     <div>
                        <div class="section">
                           <p>本节介绍如何删除工作负载重放过滤器。</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-43D8C6CD-8E77-4AD3-925B-C3F508E93B96__GUID-305F5690-B735-4644-BBD1-4401D9154912">要删除工作负载重播过滤器：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>使用<a id="d22870e4454" class="indexterm-anchor"></a> <code class="codeph">DELETE_FILTER</code>程序：</p><pre class="oac_no_warn" dir="ltr">BEGIN DBMS_WORKLOAD_REPLAY.DELETE_FILTER（fname =&gt;'user_ichan'）;结束; /</pre><p>在此示例中， <code class="codeph">DELETE_FILTER</code>过程删除名为user_ichan的过滤器。
                                 </p>
                                 <p>此示例中的<code class="codeph">DELETE_FILTER</code>过程使用<code class="codeph">fname</code> required参数，该参数指定要删除的过滤器的名称。
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="RATUG267"></a><div class="props_rev_3"><a id="GUID-F07AE474-DA24-4FA9-A997-5C1472873070" name="GUID-F07AE474-DA24-4FA9-A997-5C1472873070"></a><h5 id="RATUG-GUID-F07AE474-DA24-4FA9-A997-5C1472873070" class="sect5"><span class="enumeration_section">12.6.5.3</span>创建重播过滤器集</h5>
                     <div>
                        <div class="section">
                           <p>添加工作负载重放过滤器后，您可以创建一组重播过滤器以用于工作负载重放。创建重播过滤器集时，将使用自创建上一个重放过滤器集以来添加的所有工作负载重放过滤器。</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-F07AE474-DA24-4FA9-A997-5C1472873070__GUID-038B152F-FD36-4740-BAC2-43EAEDB19855">要创建重播过滤器集：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>使用<a id="d22870e4562" class="indexterm-anchor"></a> <code class="codeph">CREATE_FILTER_SET</code>程序：</p><pre class="oac_no_warn" dir="ltr">BEGIN DBMS_WORKLOAD_REPLAY.CREATE_FILTER_SET（replay_dir =&gt;'apr09'，filter_set =&gt;'replayfilters'，default_action =&gt;'INCLUDE'）;结束; /</pre><p>在此示例中， <code class="codeph">CREATE_FILTER_SET</code>过程创建名为replayfilters的重放过滤器集，它将重放所有捕获的<code class="codeph">apr09</code>目录中存储的重放调用，但重<code class="codeph">apr09</code>滤器定义的工作负载部分除外。
                                 </p>
                                 <p>此示例中的<code class="codeph">CREATE_FILTER_SET</code>过程使用以下参数：</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p><code class="codeph">replay_dir</code>参数指定存储要过滤的重放的目录</p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">filter_set</code>参数指定要创建的过滤器集的名称</p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">default_action</code>参数确定是否应重播每个捕获的数据库调用，以及是否应将工作负载重放过滤器视为包含或排除过滤器。
                                       </p>
                                       <p>如果此参数设置为<code class="codeph">INCLUDE</code> ，则将重播所有捕获的数据库调用，但重放过滤器定义的工作负载部分除外。在这种情况下，所有重放过滤器都将被视为排除过滤器，因为它们将定义不会重放的工作负载部分。这是默认行为。
                                       </p>
                                       <p>如果此参数设置为<code class="codeph">EXCLUDE</code> ，则不会重播捕获的数据库调用，除了重放过滤器定义的工作负载部分。在这种情况下，所有重放过滤器都将被视为包含过滤器，因为它们将定义将要重播的工作负载部分。
                                       </p>
                                    </li>
                                 </ul>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="RATUG268"></a><div class="props_rev_3"><a id="GUID-E5D3A78C-C4B7-4778-ACE2-9A92AF750E9E" name="GUID-E5D3A78C-C4B7-4778-ACE2-9A92AF750E9E"></a><h5 id="RATUG-GUID-E5D3A78C-C4B7-4778-ACE2-9A92AF750E9E" class="sect5"><span class="enumeration_section">12.6.5.4</span>使用重<span class="enumeration_section">放过</span>滤器集</h5>
                     <div>
                        <div class="section">
                           <p>一旦创建了重<code class="codeph">replay_dir</code>滤器集并初始化了重放，您就可以使用重<code class="codeph">replay_dir</code>滤器集来过滤<code class="codeph">replay_dir</code>目录中的重放。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-E5D3A78C-C4B7-4778-ACE2-9A92AF750E9E__GUID-FEE2C383-397B-4F96-BF91-6D3E23FB6B17">要使用重播过滤器集：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>使用<a id="d22870e4702" class="indexterm-anchor"></a> <code class="codeph">USE_FILTER_SET</code>程序：</p><pre class="oac_no_warn" dir="ltr">BEGIN DBMS_WORKLOAD_REPLAY.USE_FILTER_SET（filter_set =&gt;'replayfilters'）;结束; /</pre><p>在此示例中， <code class="codeph">USE_FILTER_SET</code>过程使用名为replayfilters的过滤器集。
                                 </p>
                                 <p>所述<code class="codeph">USE_FILTER_SET</code>在此示例过程使用<code class="codeph">filter_set</code>所需的参数，其指定在设置重放中使用的过滤器的名称。
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div><a id="RATUG320"></a><div class="props_rev_3"><a id="GUID-0AA0E9DD-400A-47A9-BB80-07B83FBA6064" name="GUID-0AA0E9DD-400A-47A9-BB80-07B83FBA6064"></a><h4 id="RATUG-GUID-0AA0E9DD-400A-47A9-BB80-07B83FBA6064" class="sect4"><span class="enumeration_section">12.6.6</span>设置重播超时操作</h4>
                  <div>
                     <div><span>本节介绍如何为工作负载重放设置超时操作。</span> 您可以设置重播超时操作以中止在重放期间显着较慢的用户调用或导致重播挂起。例如，您可能希望设置重播超时操作以中止由数据库升级后的次优执行计划导致的失控查询。
                     </div>
                     <div class="section">
                        <p>启用重播超时操作后，如果用户调用延迟超出重播超时操作指定的条件，则会以<code class="codeph">ORA-15569</code>错误退出。中止的呼叫及其错误报告为错误分歧。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-0AA0E9DD-400A-47A9-BB80-07B83FBA6064__GUID-D680197D-0E1F-44E6-82F8-55D85B74E4D6">要设置重播超时：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>使用<a id="d22870e4817" class="indexterm-anchor"></a> <code class="codeph">SET_REPLAY_TIMEOUT</code>程序：</p><pre class="oac_no_warn" dir="ltr">BEGIN DBMS_WORKLOAD_REPLAY.SET_REPLAY_TIMEOUT（enabled =&gt; TRUE，min_delay =&gt; 20，max_delay =&gt; 60，delay_factor =&gt; 10）;结束; /</pre><p>在此示例中， <code class="codeph">SET_REPLAY_TIMEOUT</code>过程定义了一个重播超时操作，如果重放期间的延迟超过60分钟，或者重放期间的延迟超过20分钟且经过的时间比捕获时间大10倍，则会中止用户调用经过的时间。
                              </p>
                              <p>此示例中的<code class="codeph">SET_REPLAY_TIMEOUT</code>过程使用以下参数：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><code class="codeph">enabled</code>参数指定是启用还是禁用重播超时操作。默认值为<code class="codeph">TRUE</code> 。</p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">min_delay</code>参数定义呼叫延迟的下限值（以分钟为单位）。仅当延迟超过此值时，才会激活重播超时操作。默认值为10。
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">max_delay</code>参数定义呼叫延迟的上限值（以分钟为单位）。重播超时操作已激活，并在延迟超过此值时发出错误。默认值为120。
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">delay_factor</code>参数定义了<code class="codeph">min_delay</code>和<code class="codeph">max_delay</code>之间的呼叫延迟的因子。当前重播经过的时间高于捕获经过时间与此值的乘积时，重放超时操作会发出错误。默认值为8。
                                    </p>
                                 </li>
                              </ul>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-0AA0E9DD-400A-47A9-BB80-07B83FBA6064__GUID-2F38C1BF-8044-4F46-AD9A-97ACFA9D0DEA">要检索重播超时操作设置：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>使用<code class="codeph">GET_REPLAY_TIMEOUT</code>过程：</p><pre class="oac_no_warn" dir="ltr">DECLARE启用了BOOLEAN; min_delay NUMBER; max_delay NUMBER; delay_factor NUMBER; BEGIN DBMS_WORKLOAD_REPLAY.GET_REPLAY_TIMEOUT（启用，min_delay，max_delay，delay_factor）;结束; /</pre><p>此示例中的<code class="codeph">GET_REPLAY_TIMEOUT</code>过程返回以下参数：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><code class="codeph">enabled</code>参数返回是启用还是禁用重播超时操作。
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">min_delay</code>参数以分钟为单位返回呼叫延迟的下限值。
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">max_delay</code>参数以分钟为单位返回呼叫延迟的上限值。
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">delay_factor</code>参数返回延迟因子。
                                    </p>
                                 </li>
                              </ul>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="RATUG155"></a><div class="props_rev_3"><a id="GUID-ED9DCCDB-2928-4BAC-9617-2314532AE517" name="GUID-ED9DCCDB-2928-4BAC-9617-2314532AE517"></a><h4 id="RATUG-GUID-ED9DCCDB-2928-4BAC-9617-2314532AE517" class="sect4"><span class="enumeration_section">12.6.7</span>启动工作负载重播</h4>
                  <div>
                     <div><span>在开始工作负载重放之前，需要执行任务。</span> 例如：</div>
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p>预处理捕获的工作负载，如<span class="q">“ <a href="preprocessing-a-database-workload.html#GUID-4FC4A529-D603-48A1-BA0E-12E8BB130733" title="本节介绍如何使用DBMS_WORKLOAD_REPLAY包预处理捕获的工作负载。">使用API预处理数据库工作负载</a> ”中所述</span></p>
                           </li>
                           <li>
                              <p>初始化重播数据，如<span class="q">“ <a href="replaying-a-database-workload.html#GUID-FBED93C2-DBF2-4CC1-A9A1-393CDB9B05BD" title="在预处理工作负载捕获并正确准备测试系统之后，可以初始化重放数据。初始化重放数据会将必要的元数据加载到工作负载重放所需的表中。">初始化重放数据</a> ”中所述</span></p>
                           </li>
                           <li>
                              <p>指定重播选项，如<span class="q">“ <a href="replaying-a-database-workload.html#GUID-EA09779B-E85F-45A7-A54E-3FED813AB68D" title="初始化重放数据并重新映射连接和用户后，您需要准备数据库以进行工作负载重放。">设置工作负载重播选项</a> ”中所述</span></p>
                           </li>
                           <li>
                              <p>启动重播客户端，如<span class="q">“ <a href="replaying-a-database-workload.html#GUID-0E7CD4B5-433D-408A-990B-DD499C11ACCB" title="确定重放工作负载所需的重播客户端数量后，需要通过在安装它们的主机上以重播模式运行wrc可执行文件来启动重播客户端。">启动重播客户端</a> ”中所述</span></p>
                           </li>
                        </ul>
                        <div class="infoboxnote" id="GUID-ED9DCCDB-2928-4BAC-9617-2314532AE517__GUID-9449FCA6-71EB-42BD-99B5-A35B192E509B">
                           <p class="notep1">注意：</p>
                           <p>一旦开始工作负载重放，新的重播客户端将无法连接到数据库。仅重播在执行<code class="codeph">START_REPLAY</code>过程之前启动的客户端将用于重放捕获的工作负载。
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-ED9DCCDB-2928-4BAC-9617-2314532AE517__GUID-79338298-41C9-4A20-9B5D-D10F54510AEB">要开始重新启动工作负载：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>使用<a id="d22870e5057" class="indexterm-anchor"></a> <code class="codeph">START_REPLAY</code>程序：</p><pre class="oac_no_warn" dir="ltr">BEGIN DBMS_WORKLOAD_REPLAY.START_REPLAY（）;结束; /</pre></li>
                        </ul>
                        <div class="infoboxnote" id="GUID-ED9DCCDB-2928-4BAC-9617-2314532AE517__GUID-88A50B19-1619-482D-AD31-4942C9111EE8">
                           <p class="notep1">注意：</p>
                           <p>从Oracle Database Release 19c开始， <code class="codeph">DBA_RAT_CAPTURE_SCHEMA_INFO</code>视图为SQL语句提供<code class="codeph">login_schema</code>和<code class="codeph">current_schema</code>信息。在扩展模式下重播期间，如果遇到<code class="codeph">ORA-00942: table or view does not exist</code>错误，则使用<code class="codeph">DBA_RAT_CAPTURE_SCHEMA_INFO</code>和<code class="codeph">DBA_WORKLOAD_CAPTURE_SQLTEXT</code>视图查找发生错误的表。然后将表的必要权限授予发生错误的用户并重试重播;这可能会解决问题。
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="RATUG269"></a><div class="props_rev_3"><a id="GUID-50EABBFB-99C4-42A1-8B3D-37072B01BB0E" name="GUID-50EABBFB-99C4-42A1-8B3D-37072B01BB0E"></a><h4 id="RATUG-GUID-50EABBFB-99C4-42A1-8B3D-37072B01BB0E" class="sect4"><span class="enumeration_section">12.6.8</span>暂停工作负载重播</h4>
                  <div>
                     <div><span>暂停工作负载重放将暂停重播客户端发出的所有后续用户调用，直到重新启动或取消工作负载重放为止。</span> 将允许完成正在进行的用户呼叫。此选项使您可以暂时停止重播以执行更改并观察其对剩余重播的影响。
                     </div>
                     <div class="section">
                        <p class="subhead3" id="GUID-50EABBFB-99C4-42A1-8B3D-37072B01BB0E__GUID-2C0B14EE-3E36-444D-B76F-BED50AAFE51F">暂停工作负载重放：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>使用<a id="d22870e5184" class="indexterm-anchor"></a> <code class="codeph">PAUSE_REPLAY</code>程序：</p><pre class="oac_no_warn" dir="ltr">BEGIN DBMS_WORKLOAD_REPLAY.PAUSE_REPLAY（）;结束; /</pre></li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="RATUG270"></a><div class="props_rev_3"><a id="GUID-AF6D748C-D05E-4612-9578-A726A7427B0F" name="GUID-AF6D748C-D05E-4612-9578-A726A7427B0F"></a><h4 id="RATUG-GUID-AF6D748C-D05E-4612-9578-A726A7427B0F" class="sect4"><span class="enumeration_section">12.6.9</span>恢复工作负载重播</h4>
                  <div>
                     <p>本节介绍如何恢复暂停的工作负载重播。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-AF6D748C-D05E-4612-9578-A726A7427B0F__GUID-E5AA734E-3AA0-4BAF-A001-E697928E1881">要恢复工作负载重播：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>使用<a id="d22870e5286" class="indexterm-anchor"></a> <code class="codeph">RESUME_REPLAY</code>程序：</p><pre class="oac_no_warn" dir="ltr">BEGIN DBMS_WORKLOAD_REPLAY.RESUME_REPLAY（）;结束; /</pre></li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="RATUG156"></a><div class="props_rev_3"><a id="GUID-31D34E9B-14BA-4AE3-91DE-6D57BD4E5053" name="GUID-31D34E9B-14BA-4AE3-91DE-6D57BD4E5053"></a><h4 id="RATUG-GUID-31D34E9B-14BA-4AE3-91DE-6D57BD4E5053" class="sect4"><span class="enumeration_section">12.6.10</span>取消工作负载重播</h4>
                  <div>
                     <p>本节介绍如何取消工作负载重放。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-31D34E9B-14BA-4AE3-91DE-6D57BD4E5053__GUID-B39C1EA3-FB5A-4B9D-B798-4A451F02A46D">要取消工作负载重播：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>使用<a id="d22870e5388" class="indexterm-anchor"></a> <code class="codeph">CANCEL_REPLAY</code>程序：</p><pre class="oac_no_warn" dir="ltr">BEGIN DBMS_WORKLOAD_REPLAY.CANCEL_REPLAY（）;结束; /</pre></li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="RATUG4258"></a><a id="RATUG4257"></a><div class="props_rev_3"><a id="GUID-BE084EF0-D8EA-4BFF-A3A3-53A30E9C96FA" name="GUID-BE084EF0-D8EA-4BFF-A3A3-53A30E9C96FA"></a><h4 id="RATUG-GUID-BE084EF0-D8EA-4BFF-A3A3-53A30E9C96FA" class="sect4"><span class="enumeration_section">12.6.11</span>检索有关工作负载重播的信息</h4>
                  <div>
                     <div><span>您可以从重放目录对象中检索有关工作负载捕获的所有信息，以及从目录中检索工作负载重放尝试的历史记录。</span> 默认情况下，不会加载工作负载重放差异数据，但您可以选择性地选择加载此数据。
                     </div>
                     <div class="section">
                        <p class="subhead3" id="GUID-BE084EF0-D8EA-4BFF-A3A3-53A30E9C96FA__GUID-EA5AED55-3B4A-4494-8C62-C3469DBF7A4D">要检索有关工作负载重放的信息：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>调用<code class="codeph">DBMS_WORKLOAD_REPLAY</code> 。 <a id="d22870e5489" class="indexterm-anchor"></a> <code class="codeph">GET_REPLAY_INFO</code>函数。
                              </p>
                              <p><code class="codeph">GET_REPLAY_INFO</code>函数首先将行导入<code class="codeph">DBA_WORKLOAD_CAPTURES</code>视图，该视图包含有关工作负载捕获的信息。默认情况下，它仅导入以前未加载到<code class="codeph">DBA_WORKLOAD_REPLAYS</code>视图中的重放信息。此函数返回捕获目录的<code class="codeph">cap_id</code> （对于合并的捕获目录，返回的<code class="codeph">cap_id</code>为<code class="codeph">0</code> ），它可以与<code class="codeph">DBA_WORKLOAD_REPLAYS</code>视图中的<code class="codeph">CAPTURE_ID</code>列关联，以访问检索到的信息。
                              </p>
                              <p><code class="codeph">GET_REPLAY_INFO</code>函数使用以下参数：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><code class="codeph">replay_dir</code>必需参数，指定工作负载重播目录对象的名称。
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">load_divergence</code>可选参数，指定是否加载分歧数据。此参数的默认值为<code class="codeph">FALSE</code> 。要加载<code class="codeph">DBA_WORKLOAD_REPLAY_DIVERGENCE</code>数据，将从重放目录检索到的每次重播尝试的行导入<code class="codeph">DBA_WORKLOAD_REPLAY_DIVERGENCE</code>视图，请将此参数设置为<code class="codeph">TRUE</code> 。或者，您可以使用<code class="codeph">LOAD_DIVERGENCE</code>过程在检索重放信息后有选择地为单个重播或目录对象中的所有重放<span class="q"><a href="replaying-a-database-workload.html#GUID-9EF34950-7ABC-4AC1-BFCA-734DB4DCF44E" title="Loading divergence data for workload replay imports rows for every replay attempt retrieved from the replay directory into the DBA_WORKLOAD_REPLAY_DIVERGENCE view, which displays information about diverged calls and errors during replay attempts.">加载分歧数据</a></span> ，如<span class="q">“ <a href="replaying-a-database-workload.html#GUID-9EF34950-7ABC-4AC1-BFCA-734DB4DCF44E" title="加载工作负载重放的差异数据会将从重播目录检索到的每次重播尝试导入行导入DBA_WORKLOAD_REPLAY_DIVERGENCE视图，该视图显示有关重放尝试期间分歧的呼叫和错误的信息。">加载分散数据以进行工作负载重放</a> ”中所述</span> 。
                                    </p>
                                 </li>
                              </ul>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-BE084EF0-D8EA-4BFF-A3A3-53A30E9C96FA__GUID-68023FD6-46FF-4C90-8D4A-B7394AC98D27">
                        <p class="titleinexample">示例12-1检索有关工作负载重放的信息</p>
                        <p>以下示例说明如何检索有关工作负载捕获的信息以及名为<code class="codeph">jul14</code>的重放目录对象的工作负载重放尝试的历史记录，以及验证是否已检索到该信息。
                        </p><pre class="oac_no_warn" dir="ltr">DECLARE cap_id NUMBER; BEGIN cap_id：= DBMS_WORKLOAD_REPLAY.GET_REPLAY_INFO（replay_dir =&gt;'jul14'）; SELECT capture_id FROM dba_workload_replays WHERE capture_id = cap_id;结束; /</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="RATUG4260"></a><a id="RATUG4259"></a><div class="props_rev_3"><a id="GUID-9EF34950-7ABC-4AC1-BFCA-734DB4DCF44E" name="GUID-9EF34950-7ABC-4AC1-BFCA-734DB4DCF44E"></a><h4 id="RATUG-GUID-9EF34950-7ABC-4AC1-BFCA-734DB4DCF44E" class="sect4"><span class="enumeration_section">12.6.12</span>加载工作负载重放的分歧数据</h4>
                  <div>
                     <div><span>加载工作负载重放的差异数据<code class="codeph">DBA_WORKLOAD_REPLAY_DIVERGENCE</code>从重播目录检索到的每次重播尝试导入行导入<code class="codeph">DBA_WORKLOAD_REPLAY_DIVERGENCE</code>视图，该视图显示有关重放尝试期间分歧的呼叫和错误的信息。</span> 您可以选择为单个工作负载重放或给定目录对象中的所有工作负载重放加载差异数据。
                     </div>
                     <div class="section">
                        <p class="subhead3" id="GUID-9EF34950-7ABC-4AC1-BFCA-734DB4DCF44E__GUID-17F224FE-14A4-4459-A18E-18AD25CFD88D">加载工作负载重放的差异数据：</p>
                        <ol>
                           <li>
                              <p>调用<code class="codeph">WORKLOAD_REPLAY</code> 。 <a id="d22870e5668" class="indexterm-anchor"></a>使用以下参数之一的<code class="codeph">LOAD_DIVERGENCE</code>过程：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><code class="codeph">replay_id</code>参数指定要为其加载分歧数据的工作负载重放的ID。如果您只想为单个工作负载重放加载差异数据，请使用此参数。
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">replay_dir</code>参数指定目录对象的名称（值区分大小写）。如果要为给定目录对象中的所有工作负载重放加载差异数据，请使用此参数。
                                    </p>
                                 </li>
                              </ul>
                           </li>
                           <li>
                              <p>要检查分歧数据的加载状态，请在<code class="codeph">DBA_WORKLOAD_REPLAYS</code>视图中查询<code class="codeph">DIVERGENCE_LOAD_STATUS</code>列。
                              </p>
                              <p>值<code class="codeph">TRUE</code>表示加载了分歧数据，值<code class="codeph">FALSE</code>表示尚未加载。
                              </p>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-9EF34950-7ABC-4AC1-BFCA-734DB4DCF44E__GUID-FAA768FB-7EA7-45AB-8D48-A8B0F2F04711">
                        <p class="titleinexample">示例12-2加载单个工作负载重放的差异数据</p>
                        <p>以下示例显示如何使用<code class="codeph">replay_id</code>值<code class="codeph">12</code>加载工作负载重放的差异数据，并验证是否加载了分歧数据。
                        </p><pre class="oac_no_warn" dir="ltr">DECLARE rep_id NUMBER; BEGIN rep_id：= DBMS_WORKLOAD_REPLAY.LOAD_DIVERGENCE（replay_id =&gt; 12）; SELECT divergence_load_status FROM dba_workload_replays WHERE capture_id = rep_id;结束; /</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="RATUG4262"></a><a id="RATUG4261"></a><div class="props_rev_3"><a id="GUID-13B2F26C-2655-4900-94A2-60322707D248" name="GUID-13B2F26C-2655-4900-94A2-60322707D248"></a><h4 id="RATUG-GUID-13B2F26C-2655-4900-94A2-60322707D248" class="sect4"><span class="enumeration_section">12.6.13</span>删除有关工作负载重播的信息</h4>
                  <div>
                     <div><span>您可以删除为单个工作负载重放或给定目录对象中的所有工作负载重放检索的信息。</span> 可以使用<code class="codeph">GET_REPLAY_INFO</code>函数检索已删除的信息，如<span class="q">“ <a href="replaying-a-database-workload.html#GUID-BE084EF0-D8EA-4BFF-A3A3-53A30E9C96FA" title="您可以从重放目录对象中检索有关工作负载捕获的所有信息，以及从目录中检索工作负载重放尝试的历史记录。">检索有关工作负载重播的信息</a> ”中所述</span> 。
                     </div>
                     <div class="section">
                        <p class="subhead3" id="GUID-13B2F26C-2655-4900-94A2-60322707D248__GUID-6B423274-60F9-459E-AC52-EF37A37294D7">要删除有关工作负载重放的信息：</p>
                        <ol>
                           <li>
                              <p>调用<code class="codeph">DBMS_WORKLOAD_REPLAY</code> 。 <a id="d22870e5819" class="indexterm-anchor"></a> <code class="codeph">DELETE_REPLAY_INFO</code>过程使用<code class="codeph">replay_id</code>参数。
                              </p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><code class="codeph">replay_id</code>参数指定要删除重播信息的工作负载重放的ID。如果您只想删除单个工作负载重放的信息，请使用此参数。
                                    </p>
                                 </li>
                              </ul>
                           </li>
                           <li>
                              <p>默认情况下，删除有关工作负载重放的信息不会从磁盘中删除数据。</p>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-13B2F26C-2655-4900-94A2-60322707D248__GUID-E81F42C4-998A-49BC-B711-0C60FD5EFD76">
                        <p class="titleinexample">示例12-3删除有关工作负载重放的信息</p>
                        <p>以下示例删除检索到的有关工作负载捕获的信息以及ID为<code class="codeph">2</code>的工作负载重放的工作负载重放尝试的历史记录。重放数据不会从磁盘中删除，因此可以通过调用<code class="codeph">GET_REPLAY_INFO</code>函数来检索，如<span class="q">“ <a href="replaying-a-database-workload.html#GUID-BE084EF0-D8EA-4BFF-A3A3-53A30E9C96FA" title="您可以从重放目录对象中检索有关工作负载捕获的所有信息，以及从目录中检索工作负载重放尝试的历史记录。">检索有关工作负载重播的信息</a> ”中所述</span> 。
                        </p><pre class="oac_no_warn" dir="ltr">BEGIN DBMS_WORKLOAD_REPLAY.DELETE_REPLAY_INFO（replay_id =&gt; 2）;结束; /</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="RATUG157"></a><div class="props_rev_3"><a id="GUID-03B5F50F-40C2-4183-8E07-2B64319356FA" name="GUID-03B5F50F-40C2-4183-8E07-2B64319356FA"></a><h4 id="RATUG-GUID-03B5F50F-40C2-4183-8E07-2B64319356FA" class="sect4"><span class="enumeration_section">12.6.14</span>导出工作负载重播的AWR数据</h4>
                  <div>
                     <div><span>导出AWR数据可以对工作负载进行详细分析。</span> 如果您计划在一对工作负载捕获或重放上运行AWR比较期报告，则还需要此数据。
                     </div>
                     <div class="section">
                        <p class="subhead3" id="GUID-03B5F50F-40C2-4183-8E07-2B64319356FA__GUID-5D331A3E-54BC-401F-9C46-9D7292F75ADA">要导出AWR数据：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>使用<a id="d22870e5955" class="indexterm-anchor"></a> <code class="codeph">EXPORT_AWR</code>程序：</p><pre class="oac_no_warn" dir="ltr">BEGIN DBMS_WORKLOAD_REPLAY.EXPORT_AWR（replay_id =&gt; 1）;结束; /</pre><p>在此示例中，将导出与重放ID为1的工作负载重放相对应的AWR快照，以及在工作负载重放期间可能已捕获的任何SQL调整集。</p>
                              <p><code class="codeph">EXPORT_AWR</code>过程使用<code class="codeph">replay_id</code> required参数，该参数指定将导出其AWR快照的重放的ID。
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <div class="infoboxnote" id="GUID-03B5F50F-40C2-4183-8E07-2B64319356FA__GUID-2F592A6D-2651-4F8B-B9E1-144CB547A1ED">
                           <p class="notep1">注意：</p>
                           <p>仅当在当前数据库中执行相应的工作负载重放且与原始重播时间段对应的AWR快照仍可用时，此过程才有效。</p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="RATUG4195"></a><div class="props_rev_3"><a id="GUID-9A1ACF42-5AB1-4FBA-91C8-153181404F07" name="GUID-9A1ACF42-5AB1-4FBA-91C8-153181404F07"></a><h4 id="RATUG-GUID-9A1ACF42-5AB1-4FBA-91C8-153181404F07" class="sect4"><span class="enumeration_section">12.6.15</span>导入工作负载重播的AWR数据</h4>
                  <div>
                     <div><span>从重放系统导出AWR数据后，您可以将AWR数据导入另一个系统。导入AWR数据可以对工作负载进行详细分析。</span> 如果您计划在一对工作负载捕获或重放上运行AWR比较期报告，则还需要此数据。
                     </div>
                     <div class="section">
                        <p class="subhead3" id="GUID-9A1ACF42-5AB1-4FBA-91C8-153181404F07__GUID-51A82109-537C-4E35-8C33-636A208DB1FF">要导入AWR数据：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>使用<a id="d22870e6073" class="indexterm-anchor"></a> <code class="codeph">IMPORT_AWR</code>功能：</p><pre class="oac_no_warn" dir="ltr">CREATE USER capture_awr SELECT DBMS_WORKLOAD_REPLAY.IMPORT_AWR（replay_id =&gt; 1，staging_schema =&gt;'capture_awr'）FROM DUAL;</pre><p>在此示例中，使用名为<code class="codeph">capture_awr</code>的临时模式导入与捕获ID为1的工作负载重放相对应的AWR快照。
                              </p>
                              <p>此示例中的<code class="codeph">IMPORT_AWR</code>过程使用以下参数：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><code class="codeph">replay_id</code> required参数指定将导入其AWR快照的重播的ID。
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">staging_schema</code> required参数指定当前数据库中有效模式的名称，该模式可以在将AWR快照从重播目录导入<code class="codeph">SYS</code> <code class="codeph">AWR</code>模式时用作临时区域。
                                    </p>
                                 </li>
                              </ul>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <div class="infoboxnote" id="GUID-9A1ACF42-5AB1-4FBA-91C8-153181404F07__GUID-793B5548-43B2-48FB-A4D1-7734659C234D">
                           <p class="notep1">注意：</p>
                           <p>如果<code class="codeph">staging_schema</code>参数指定的模式包含与任何AWR表同名的任何表，则此函数将失败。
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="RATUG302"></a><div class="sect2"><a id="GUID-6AB48629-25B9-4E07-AD7C-DE830E1022A2" name="GUID-6AB48629-25B9-4E07-AD7C-DE830E1022A2"></a><h3 id="RATUG-GUID-6AB48629-25B9-4E07-AD7C-DE830E1022A2" class="sect3"><span class="enumeration_section">12.7</span>使用API监控工作负载重放</h3>
               <div>
                  <div><span>本节介绍如何使用API和视图监视工作负载重放。</span> 您还可以使用Oracle Enterprise Manager监视工作负载重放，如<span class="q">“ <a href="replaying-a-database-workload.html#GUID-64593639-9102-4C30-8EB9-71F28ABED05A" title="本节介绍如何使用Enterprise Manager监视工作负载重放。监视工作负载重放的主要工具是Oracle Enterprise Manager。">使用Enterprise Manager监视工作负载重放</a> ”中所述</span> 。
                  </div>
                  <p>本节包含以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="replaying-a-database-workload.html#GUID-9E76AEB4-4B23-442D-8A10-2732EAA8FF79" title="在重放期间，重放系统和捕获系统之间的任何错误和数据差异都记录为分支呼叫。">检索有关分散呼叫的信息</a></p>
                     </li>
                     <li>
                        <p><a href="replaying-a-database-workload.html#GUID-BF5B4273-330A-461A-9C60-A4BB538ABB29" title="本节概述了可以显示以监视工作负载重放的视图。">使用视图监视工作负载重播</a></p>
                     </li>
                  </ul>
               </div><a id="RATUG303"></a><div class="props_rev_3"><a id="GUID-9E76AEB4-4B23-442D-8A10-2732EAA8FF79" name="GUID-9E76AEB4-4B23-442D-8A10-2732EAA8FF79"></a><h4 id="RATUG-GUID-9E76AEB4-4B23-442D-8A10-2732EAA8FF79" class="sect4"><span class="enumeration_section">12.7.1</span>检索有关分散呼叫的信息</h4>
                  <div>
                     <p>在重放期间，重放系统和捕获系统之间的任何错误和数据差异都记录为分支呼叫。</p>
                     <div class="section">
                        <p>要检索有关分支调用的信息（包括其SQL标识符，SQL文本和绑定值），请调用<a id="d22870e6311" class="indexterm-anchor"></a> <code class="codeph">GET_DIVERGING_STATEMENT</code>函数使用以下参数：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p>将<code class="codeph">replay_id</code>参数设置为呼叫分散的重播ID</p>
                           </li>
                           <li>
                              <p>将<code class="codeph">stream_id</code>参数设置为<code class="codeph">stream_id</code>呼叫的流ID</p>
                           </li>
                           <li>
                              <p>将<code class="codeph">call_counter</code>参数设置为<code class="codeph">call_counter</code>呼叫的呼叫计数器</p>
                           </li>
                        </ul>
                        <p>要查看有关分歧呼叫的这些信息，请使用<code class="codeph">DBA_WORKLOAD_REPLAY_DIVERGENCE</code>视图。以下示例说明了函数调用：</p><pre class="oac_no_warn" dir="ltr">DECLARE r CLOB; ls_stream_id NUMBER; ls_call_counter NUMBER; ls_sql_cd VARCHAR2（20）; ls_sql_err VARCHAR2（512）; CURSOR c IS SELECT stream_id，call_counter FROM DBA_WORKLOAD_REPLAY_DIVERGENCE WHERE replay_id = 72; BEGIN OPEN c; LOOP FETCH c INTO ls_stream_id，ls_call_counter;当c％未发现时退出; DBMS_OUTPUT.PUT_LINE（ls_stream_id ||''|| ls_call_counter）; r：= DBMS_WORKLOAD_REPLAY.GET_DIVERGING_STATEMENT（replay_id =&gt; 72，stream_id =&gt; ls_stream_id，call_counter =&gt; ls_call_counter）; DBMS_OUTPUT.PUT_LINE（r）;结束循环;结束; /</pre><div class="infoboxnotealso" id="GUID-9E76AEB4-4B23-442D-8A10-2732EAA8FF79__GUID-B3EE3159-2C87-4886-B6DF-89FF48295F1F">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>有关<code class="codeph">DBMS_WORKLOAD_REPLAY</code>包的信息，请<code class="codeph">DBMS_WORKLOAD_REPLAY</code> <a href="../arpls/DBMS_WORKLOAD_REPLAY.html#ARPLS208" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="RATUG158"></a><div class="props_rev_3"><a id="GUID-BF5B4273-330A-461A-9C60-A4BB538ABB29" name="GUID-BF5B4273-330A-461A-9C60-A4BB538ABB29"></a><h4 id="RATUG-GUID-BF5B4273-330A-461A-9C60-A4BB538ABB29" class="sect4"><span class="enumeration_section">12.7.2</span>使用视图监控工作负载重播</h4>
                  <div>
                     <div><span>本节概述了可以显示以监视工作负载重放的视图。</span> 您需要DBA权限才能访问这些视图。
                     </div>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">DBA_WORKLOAD_CAPTURES</code>视图列出了当前数据库中捕获的所有工作负载捕获。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">DBA_WORKLOAD_FILTERS</code>视图列出了当前数据库中定义的工作负载捕获的所有工作负载过滤器。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">DBA_WORKLOAD_REPLAYS</code>视图列出了当前数据库中已重播的所有工作负载重放。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">DBA_WORKLOAD_REPLAY_DIVERGENCE</code>视图使您可以查看有关<code class="codeph">DBA_WORKLOAD_REPLAY_DIVERGENCE</code>呼叫的信息，例如重播标识符，流标识符和呼叫计数器。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">DBA_WORKLOAD_DIV_SUMMARY</code>视图在<code class="codeph">DBA_WORKLOAD_DIV_SUMMARY</code>视图中显示重播差异信息的<code class="codeph">DBA_WORKLOAD_REPLAY_DIVERGENCE</code> 。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">DBA_WORKLOAD_REPLAY_FILTER_SET</code>视图列出了当前数据库中定义的工作负载重放的所有工作负载过滤器。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">DBA_WORKLOAD_CONNECTION_MAP</code>视图列出了工作负载重放的连接映射信息。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">V$WORKLOAD_REPLAY_THREAD</code>视图列出了有关重播客户端的所有会话的信息。
                           </p>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-BF5B4273-330A-461A-9C60-A4BB538ABB29__GUID-28820D51-017F-4104-92CA-6FAD1516A412">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="../refrn/index.html" target="_blank"><span><cite>Oracle数据库参考</cite></span></a> <span class="italic"> </span>有关这些视图的信息</p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>