<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>故障排除</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="JDBC Developer&#39;s Guide"></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="JDBC Developer&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="jdbc-developers-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-02-13T13:20:37-08:00"></meta>
      <meta name="dcterms.title" content="JDBC Developer&#39;s Guide"></meta>
      <meta name="dcterms.dateCopyrighted" content="1999, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96471-02"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="JDBC-error-messages.html" title="Previous" type="text/html"></link>
      <link rel="next" href="book-index.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="JJDBC"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="JDBC-error-messages.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="book-index.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">JDBC开发人员指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="appendixes.html" property="item" typeof="WebPage"><span property="name">附录</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">故障排除</li>
            </ol>
            <a id="GUID-F8CC9C5E-B043-4D84-A86E-ACED8F40E2E9" name="GUID-F8CC9C5E-B043-4D84-A86E-ACED8F40E2E9"></a><a id="JJDBC28976"></a>
            
            <h2 id="JJDBC-GUID-F8CC9C5E-B043-4D84-A86E-ACED8F40E2E9" class="sect2"><span class="enumeration_chapter">E</span>故障排除</h2>
         </header>
         <div class="ind">
            <div>
               <div class="section">
                  <p>本附录介绍了如何在以下主题中对Java数据库连接（JDBC）应用程序进行故障排除：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="JDBC-troubleshooting.html#GUID-E0615FF5-D311-4F35-9337-08F46CAB6857">常见问题</a></p>
                     </li>
                     <li>
                        <p><a href="JDBC-troubleshooting.html#GUID-BEF28F31-0A7F-47F7-9CB4-A9635768B983">基本调试程序</a></p>
                     </li>
                  </ul>
               </div>
               <!-- class="section" -->
            </div><a id="JJDBC28977"></a><div class="props_rev_3"><a id="GUID-E0615FF5-D311-4F35-9337-08F46CAB6857" name="GUID-E0615FF5-D311-4F35-9337-08F46CAB6857"></a><h3 id="JJDBC-GUID-E0615FF5-D311-4F35-9337-08F46CAB6857" class="sect3"><span class="enumeration_section">E.1</span>常见问题</h3>
               <div>
                  <div class="section">
                     <p>本节介绍使用Oracle时可能遇到的一些常见问题<a id="d116827e59" class="indexterm-anchor"></a> JDBC驱动程序。这些问题包括：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="JDBC-troubleshooting.html#GUID-88104995-B9C8-49D2-9C8E-C5ED356674F8">CHAR列的内存消耗定义为OUT或IN / OUT变量</a></p>
                        </li>
                        <li>
                           <p><a href="JDBC-troubleshooting.html#GUID-9E933DA0-5D61-4C5C-9D1D-E61AD0AD0F04">内存泄漏和游标耗尽</a></p>
                        </li>
                        <li>
                           <p><a href="JDBC-troubleshooting.html#GUID-2776500F-19DA-4D06-A86F-805B1BC92703">为流程打开超过16个OCI连接</a></p>
                        </li>
                        <li>
                           <p><a href="JDBC-troubleshooting.html#GUID-E846B7AB-4032-473B-8E2F-E741FDD97012">使用statement.cancel</a></p>
                        </li>
                        <li>
                           <p><a href="JDBC-troubleshooting.html#GUID-5ADA932F-B2BF-4E34-8995-435FD2EF1F92">将JDBC与防火墙结合使用</a></p>
                        </li>
                        <li>
                           <p><a href="JDBC-troubleshooting.html#GUID-D4FEB9D7-D7F2-4AF8-858C-89E3988CD00D">频繁突然断开与服务器的连接</a></p>
                        </li>
                        <li>
                           <p><a href="JDBC-troubleshooting.html#GUID-80F0D16E-0513-4F74-B22B-32F35AB172E6">网络适配器无法建立连接</a></p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div><a id="JJDBC28979"></a><div class="props_rev_3"><a id="GUID-88104995-B9C8-49D2-9C8E-C5ED356674F8" name="GUID-88104995-B9C8-49D2-9C8E-C5ED356674F8"></a><h4 id="JJDBC-GUID-88104995-B9C8-49D2-9C8E-C5ED356674F8" class="sect4"><span class="enumeration_section">E.1.1</span> CHAR列的内存消耗定义为OUT或IN / OUT变量</h4>
                  <div>
                     <div class="section">
                        <p>在PL / SQL中，当<code class="codeph">CHAR</code>或<code class="codeph">VARCHAR2</code>列定义为<code class="codeph">OUT</code>或<code class="codeph">IN/OUT</code>变量时，驱动程序将分配一个32512个字符的<code class="codeph">CHAR</code>数组。这可能会导致内存消耗问题。使用<code class="codeph">VARCHAR2</code>输出类型时，JDBC Thin驱动程序不分配内存。但JDBC OCI驱动程序为<code class="codeph">CHAR</code>和<code class="codeph">VARCHAR2</code>类型分配内存。因此，OCI驱动程序中的CPU负载高于Thin驱动程序。
                        </p>
                        <p>在以前的版本中，问题的解决方案是调用<code class="codeph">Statement.setMaxFieldSize</code>方法。更好的解决方案是使用<code class="codeph">OracleCallableStatement.registerOutParameter</code> 。Oracle鼓励您始终在每个<code class="codeph">CHAR</code>或<code class="codeph">VARCHAR2</code>列上调用<code class="codeph">registerOutParameter (int paramIndex, int sqlType, int scale, int maxLength)</code> 。此方法在<code class="codeph">oracle.jdbc.定义<code class="codeph">oracle.jdbc.OracleCallableStatement</code> 。使用第四个参数<code class="codeph">maxLength</code>来限制内存消耗。此参数告诉驱动程序存储此列需要多少个字符。如果字符数组不能保存列数据，则会截断该列。第三个参数<code class="codeph">scale</code> ，被驱动程序忽略。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="JJDBC28980"></a><div class="props_rev_3"><a id="GUID-9E933DA0-5D61-4C5C-9D1D-E61AD0AD0F04" name="GUID-9E933DA0-5D61-4C5C-9D1D-E61AD0AD0F04"></a><h4 id="JJDBC-GUID-9E933DA0-5D61-4C5C-9D1D-E61AD0AD0F04" class="sect4"><span class="enumeration_section">E.1.2</span>内存泄漏和游标耗尽</h4>
                  <div>
                     <div class="section">
                        <p>如果你收到<a id="d116827e202" class="indexterm-anchor"></a><a id="d116827e204" class="indexterm-anchor"></a><a id="d116827e206" class="indexterm-anchor"></a><a id="d116827e208" class="indexterm-anchor"></a>如果游标用完游标或内存不足，请确保明确关闭所有<code class="codeph">Statement</code>和<code class="codeph">ResultSet</code>对象。Oracle JDBC驱动程序没有终结器方法。它们通过使用<code class="codeph">ResultSet</code>和<code class="codeph">Statement</code>类的<code class="codeph">close</code>方法执行清理例程。如果未显式关闭结果集和语句对象，则可能发生严重的内存泄漏。您也可能在数据库中用完游标。关闭语句会释放数据库中的相应游标。
                        </p>
                        <p>同样，您必须显式关闭<code class="codeph">Connection</code>对象，以避免服务器端的游标泄漏和用完。关闭连接时，JDBC驱动程序将关闭与其关联的所有打开的语句对象，从而在服务器端释放游标。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="JJDBC28982"></a><div class="props_rev_3"><a id="GUID-2776500F-19DA-4D06-A86F-805B1BC92703" name="GUID-2776500F-19DA-4D06-A86F-805B1BC92703"></a><h4 id="JJDBC-GUID-2776500F-19DA-4D06-A86F-805B1BC92703" class="sect4"><span class="enumeration_section">E.1.3</span>为进程打开16个以上的OCI连接</h4>
                  <div>
                     <div class="section">
                        <p>您可能会发现在任何给定时间都无法为进程打开超过大约16个JDBC-OCI连接。最可能的原因可能是服务器上的进程数超过了初始化文件中指定的限制，或者超出了每进程文件描述符限制。值得注意的是，一个JDBC-OCI连接可以使用多个文件描述符（它可能使用3到4个文件描述符之间的任何地方）。</p>
                        <p>如果服务器允许超过16个进程，则问题可能在于每进程文件描述符限制。可能的解决方案是增加此限制。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="JJDBC28983"></a><div class="props_rev_3"><a id="GUID-E846B7AB-4032-473B-8E2F-E741FDD97012" name="GUID-E846B7AB-4032-473B-8E2F-E741FDD97012"></a><h4 id="JJDBC-GUID-E846B7AB-4032-473B-8E2F-E741FDD97012" class="sect4"><span class="enumeration_section">E.1.4</span>使用statement.cancel</h4>
                  <div>
                     <div class="section">
                        <p><a id="d116827e284" class="indexterm-anchor"></a><a id="d116827e286" class="indexterm-anchor"></a><a id="d116827e290" class="indexterm-anchor"></a> JDBC标准方法<code class="codeph">Statement.cancel</code>尝试通过向数据库发送消息来干净地停止执行SQL语句。作为响应，数据库停止执行并回复错误消息。调用<code class="codeph">Statement.execute</code>的Java线程在服务器上等待，并且只有在收到通过调用其他线程调用<code class="codeph">Statement.cancel</code>方法调用的错误回复消息时才继续执行。
                        </p>
                        <p>因此， <code class="codeph">Statement.cancel</code>方法依赖于网络和数据库的正确运行。如果网络连接中断或数据库服务器挂起，则客户端不会收到对取消消息的错误答复。通常，当服务器进程终止时，JDBC会收到一个<code class="codeph">IOException</code> ，它释放调用<code class="codeph">Statement.execute</code>的线程。在某些情况下，服务器挂起，但JDBC不会收到<code class="codeph">IOException</code> 。<code class="codeph">Statement.cancel</code>方法不释放启动<code class="codeph">Statement.execute</code>方法的线程。
                        </p>
                        <div class="infoboxnote" id="GUID-E846B7AB-4032-473B-8E2F-E741FDD97012__GUID-27A4C0CC-782E-4BC7-B9F8-80882A043727">
                           <p class="notep1">注意：</p>
                           <p>使用<code class="codeph">Statement.cancel</code>方法时，请记住以下几点：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>区分连接级别和语句级别取消。如果通过<code class="codeph">statement.cancel</code>方法取消了非句句执行（例如， <code class="codeph">ROLLBACK</code> ），则我们重放该命令（仅当它是<code class="codeph">ROLLBACK</code> ， <code class="codeph">COMMIT</code> ， <code class="codeph">autoCommit ON</code> ， <code class="codeph">autoCommit OFF</code> ， <code class="codeph">VERSION</code> ）时。为了保证数据的完整性，我们不重放语句执行。
                                 </p>
                              </li>
                              <li>
                                 <p>同步语句执行和语句取消，以便在将取消调用发送到数据库之前不会返回执行。这为执行语句提供了更好的取消机会。</p>
                              </li>
                              <li>
                                 <p>同步取消调用，以便忽略任何新的取消请求，直到取消正在完成整个协议，即在数据库收到中断后，对其执行操作并通知JDBC。</p>
                              </li>
                           </ul>
                        </div>
                        <p>当JDBC没有收到<code class="codeph">IOException</code> ，Oracle Net最终可能会超时并关闭连接。这会导致<code class="codeph">IOException</code>并释放线程。此过程可能需要很长时间。有关如何控制此超时的信息，请参阅<code class="codeph">OracleDatasource.setConnectionProperties</code>的<code class="codeph">readTimeout</code>属性的说明。您还可以使用某些Oracle Net设置调整此超时。
                        </p>
                        <p>JDBC标准方法<code class="codeph">Statement.setQueryTimeout</code>依赖于<code class="codeph">Statement.cancel</code>方法。如果执行持续的时间超过指定的超时间隔，则监视器线程将调用<code class="codeph">Statement.cancel</code>方法。这受到前面描述的所有相同限制的约束。因此，有些情况下超时不会释放调用<code class="codeph">Statement.execute</code>方法的线程。
                        </p>
                        <p>执行和取消之间的时间长度不准确。此间隔不小于指定的超时间隔，但可以延长几秒。如果应用程序具有以高优先级运行的活动线程，则该间隔可以任意更长。监视器线程以高优先级运行，但其他高优先级线程可能使其无限期运行。请注意，只有在执行非零超时的语句时才会启动监视器线程。只有一个监视器线程监视所有Oracle JDBC语句执行。</p>
                        <div class="infoboxnote" id="GUID-E846B7AB-4032-473B-8E2F-E741FDD97012__GUID-075FCA6C-B968-4F4F-B83E-452CF0B6F9C4">
                           <p class="notep1">注意：</p>
                           <p>服务器端内部驱动程序不支持<code class="codeph">Statement.cancel</code>方法和<code class="codeph">Statement.setQueryTimeout</code>方法。服务器端内部驱动程序在单线程服务器进程中运行，Oracle JVM在此单线程进程中实现Java线程。如果服务器端内部驱动程序正在执行SQL语句，则没有Java线程可以调用<code class="codeph">Statement.cancel</code>方法。这也适用于Oracle JDBC监视器线程。
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="JJDBC28984"></a><div class="props_rev_3"><a id="GUID-5ADA932F-B2BF-4E34-8995-435FD2EF1F92" name="GUID-5ADA932F-B2BF-4E34-8995-435FD2EF1F92"></a><h4 id="JJDBC-GUID-5ADA932F-B2BF-4E34-8995-435FD2EF1F92" class="sect4"><span class="enumeration_section">E.1.5</span>将JDBC与防火墙一起使用</h4>
                  <div>
                     <div class="section">
                        <p>空闲连接的防火墙超时可能会切断连接。这可能导致JDBC应用程序在等待连接时挂起。您可以执行以下一个或多个操作，以避免因防火墙超时而导致连接被切断：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>如果使用连接缓存或连接池，则始终将连接缓存上的非活动超时值设置为短于防火墙空闲超时值。</p>
                           </li>
                           <li>
                              <p>传递<code class="codeph">oracle.jdbc.ReadTimeout</code>作为连接属性以在套接字上启用读取超时。超时值以毫秒为单位。
                              </p>
                           </li>
                           <li>
                              <p>对于JDBC OCI和JDBC Thin驱动程序，使用net描述符连接到数据库，并在连接描述符的<code class="codeph">DESCRIPTION</code>子句中指定<code class="codeph">ENABLE=BROKEN</code>参数。另外，为<code class="codeph">TCP_KEEPALIVE_INTERVAL</code>设置较低的值。</p>
                           </li>
                           <li>
                              <p>通过在服务器端的<code class="codeph">sqlnet.ora</code>文件中设置<code class="codeph">SQLNET.EXPIRE_TIME=1</code>来启用Oracle Net DCD。
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="JJDBC28985"></a><div class="props_rev_3"><a id="GUID-D4FEB9D7-D7F2-4AF8-858C-89E3988CD00D" name="GUID-D4FEB9D7-D7F2-4AF8-858C-89E3988CD00D"></a><h4 id="JJDBC-GUID-D4FEB9D7-D7F2-4AF8-858C-89E3988CD00D" class="sect4"><span class="enumeration_section">E.1.6</span>频繁突然断开与服务器的连接</h4>
                  <div>
                     <div class="section">
                        <p>如果网络不可靠，则当服务器突然断开时，客户端很难检测到频繁的断开连接。默认情况下，在Linux上运行的客户端需要7200秒（2小时）才能检测到突然断开连接。此值等于<code class="codeph">tcp_keepalive_time</code>属性的值。如果希望应用程序更快地检测断开连接，则必须将<code class="codeph">tcp_keepalive_time</code> ， <code class="codeph">tcp_keepalive_interval</code>和<code class="codeph">tcp_keepalive_probes</code>属性的值设置为操作系统级别的较低值。
                        </p>
                        <div class="infoboxnote" id="GUID-D4FEB9D7-D7F2-4AF8-858C-89E3988CD00D__GUID-3444A412-199D-4FC7-96DC-2C56B73E2DC9">
                           <p class="notep1">注意：</p>
                           <p>为<code class="codeph">tcp_keepalive_interval</code>属性设置较低的值会导致网络上的频繁探测数据包，从而导致系统速度变慢。因此，应根据系统要求适当设置此属性的值。
                           </p>
                        </div>
                        <p>此外，您必须在连接描述符的<code class="codeph">DESCRIPTION</code>子句中指定<code class="codeph">ENABLE=BROKEN</code>参数。例如：</p><pre class="oac_no_warn" dir="ltr">JDBC：预言：瘦：@（DESCRIPTION =（ENABLE = BROKEN）（ADDRESS =（PROTOCOL = TCP）（PORT = 5221）（HOST =为myhost））（CONNECT_DATA =（SERVICE_NAME = ORCL）））</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="JJDBC29175"></a><div class="props_rev_3"><a id="GUID-80F0D16E-0513-4F74-B22B-32F35AB172E6" name="GUID-80F0D16E-0513-4F74-B22B-32F35AB172E6"></a><h4 id="JJDBC-GUID-80F0D16E-0513-4F74-B22B-32F35AB172E6" class="sect4"><span class="enumeration_section">E.1.7</span>网络适配器无法建立连接</h4>
                  <div>
                     <div class="section">
                        <p>尝试建立从JDBC应用程序到Oracle实例的连接时，您可能会收到以下错误：</p><pre class="oac_no_warn" dir="ltr">java.sql中。SQLException：Io异常：网络适配器无法建立连接SQLException：SQLState（null）供应商代码（17002）</pre><p>即使满足以下所有或任何条件，也可能发生此错误：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>您可以从同一客户端到同一Oracle实例建立SQL * Plus连接。</p>
                           </li>
                           <li>
                              <p>您可以建立JDBC OCI连接，但不能建立从同一客户端到同一Oracle实例的JDBC Thin连接。</p>
                           </li>
                           <li>
                              <p>相同的JDBC应用程序能够从不同的客户端连接到同一个Oracle实例。</p>
                           </li>
                           <li>
                              <p>无论初始JDBC连接字符串是指定主机名还是IP地址，都会应用相同的行为。</p>
                           </li>
                        </ul>
                        <p>以下一个或多个原因可能导致此错误：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>您尝试建立连接的主机名不正确。</p>
                           </li>
                           <li>
                              <p>用于建立连接的端口号是错误的。</p>
                           </li>
                           <li>
                              <p>NIC卡支持IPv4和IPv6。</p>
                           </li>
                           <li>
                              <p>Oracle实例是为MTS配置的，但JDBC连接使用共享服务器而不是专用服务器。</p>
                           </li>
                        </ul>
                        <p>除了NIC卡的问题之外，您可以使用SQL * Plus快速诊断上述这些原因。以下部分指定了如何解决此错误，还包含一个示例应用程序：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="JDBC-troubleshooting.html#GUID-8E036A1B-6698-45F9-AF79-05685F3331F8">配置MTS服务器的Oracle实例使用共享服务器</a></p>
                           </li>
                           <li>
                              <p><a href="JDBC-troubleshooting.html#GUID-5BC8E69F-F199-468C-8AB8-72D489F33029">带有NIC卡的JDBC瘦驱动程序，支持IPv4和IPv6</a></p>
                           </li>
                           <li>
                              <p><a href="JDBC-troubleshooting.html#GUID-0794BD02-81FC-480F-9DB5-50AAA6BBDFA3">样品申请</a></p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div><a id="JJDBC29177"></a><a id="JJDBC29178"></a><a id="JJDBC29176"></a><div class="props_rev_3"><a id="GUID-8E036A1B-6698-45F9-AF79-05685F3331F8" name="GUID-8E036A1B-6698-45F9-AF79-05685F3331F8"></a><h5 id="JJDBC-GUID-8E036A1B-6698-45F9-AF79-05685F3331F8" class="sect5"><span class="enumeration_section">E.1.7.1</span>使用MTS服务器配置的Oracle实例使用共享服务器</h5>
                     <div>
                        <div class="section">
                           <p>要解决此错误，您必须验证是否为多线程服务器（MTS）配置了Oracle实例。如果没有为MTS配置Oracle实例，则必须对其进行配置。</p>
                           <p>如果为MTS配置了Oracle实例，则必须强制JDBC连接使用专用服务器而不是共享服务器。您可以通过将服务器重新配置为仅使用专用连接来实现此目的。如果将服务器配置为仅使用专用连接是不可行的，则执行以下步骤从客户端进行设置：</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-8E036A1B-6698-45F9-AF79-05685F3331F8__GUID-C833FE23-6FDD-4F56-BC3A-DCF3609FDC35">对于JDBC OCI客户端</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <ol>
                              <li>
                                 <p>将<code class="codeph">(SERVER=DEDICATED)</code>属性添加到存储在客户端上的<code class="codeph">tnsnames.ora</code>文件中的TNS连接字符串。
                                 </p>
                              </li>
                              <li>
                                 <p>在客户端的<code class="codeph">sqlnet.ora</code>文件中设置<code class="codeph">USER_DEDICATED_SERVER=ON</code> 。
                                 </p>
                              </li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-8E036A1B-6698-45F9-AF79-05685F3331F8__GUID-E6322168-3D34-47EC-AABC-2778F6452F48">对于JDBC Thin：</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>您必须指定一个完整的名称 - 值对连接字符串（与<code class="codeph">tnsnames.ora</code>文件中显示的相同），而不是简短的JDBC Thin语法。例如，您必须使用以下形式的连接字符串，而不是“ <code class="codeph">jdbc:oracle:thin:@host:port:sid</code> ”连接字符串：</p><pre class="oac_no_warn" dir="ltr">“jdbc：oracle：thin：@（DESCRIPTION =”+“（ADDRESS_LIST =”+“（ADDRESS =（PROTOCOL = TCP）”+“（HOST = host）”+“（PORT = port）”+“）”+ “）”+“（CONNECT_DATA =”+“（SERVICE_NAME = sid）”+“（SERVER = DEDICATED）”+“）”+“）”</pre></div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="JJDBC29179"></a><div class="props_rev_3"><a id="GUID-5BC8E69F-F199-468C-8AB8-72D489F33029" name="GUID-5BC8E69F-F199-468C-8AB8-72D489F33029"></a><h5 id="JJDBC-GUID-5BC8E69F-F199-468C-8AB8-72D489F33029" class="sect5"><span class="enumeration_section">E.1.7.2</span>带有NIC卡的JDBC瘦驱动程序，支持IPv4和IPv6</h5>
                     <div>
                        <div class="section">
                           <p>如果服务器的网络接口控制器（NIC）卡配置为支持IPv4和IPv6，则某些服务可能从IPv6开始。尝试使用IPv4连接到使用IPv6运行的服务（或反过来）的任何客户端应用程序都会收到连接拒绝错误。如果JDBC瘦客户端应用程序尝试连接到数据库服务器，则应用程序可能会停止响应或失败，并显示以下错误：</p><pre class="oac_no_warn" dir="ltr">java.sql中。SQLException：Io异常：网络适配器无法建立连接错误代码：17002</pre><p>使用以下任一解决方案来解决此错误：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>指示Java虚拟机（JVM）使用IP协议版本4。启动运行JDBC应用程序的JVM，并将<code class="codeph">-Djava.net.preferIPv4Stack</code>参数设置为<code class="codeph">true</code> 。例如，假设您正在运行名为<code class="codeph">jdbcTest</code>的JDBC应用程序。然后按以下方式执行应用程序：</p><pre class="oac_no_warn" dir="ltr">java -Djava.net.preferIPv4Stack = true jdbcTest</pre></li>
                              <li>
                                 <p>使用OCI JDBC驱动程序。</p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="JJDBC29181"></a><a id="JJDBC29180"></a><div class="props_rev_3"><a id="GUID-0794BD02-81FC-480F-9DB5-50AAA6BBDFA3" name="GUID-0794BD02-81FC-480F-9DB5-50AAA6BBDFA3"></a><h5 id="JJDBC-GUID-0794BD02-81FC-480F-9DB5-50AAA6BBDFA3" class="sect5"><span class="enumeration_section">E.1.7.3</span>样本申请</h5>
                     <div>
                        <div class="section">
                           <p><a href="JDBC-troubleshooting.html#GUID-0794BD02-81FC-480F-9DB5-50AAA6BBDFA3__CHDHJBCE">示例E-1</a>显示了连接到数据库的基本JDBC程序，可用于测试连接。它允许使用Oracle JDBC驱动程序尝试所有形式的连接。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-0794BD02-81FC-480F-9DB5-50AAA6BBDFA3__CHDHJBCE">
                           <p class="titleinexample">示例E-1以五种不同方式连接到数据库的基本JDBC程序</p><pre class="oac_no_warn" dir="ltr">import java.sql。*; public class Jdbctest {public static void main（String args []）{try {/ *取消注释下一行以获取更多连接信息* / // DriverManager.setLogStream（System.out）; / *设置下面的host，port和sid以匹配listener.ora * / String host =“myhost.oracle.com”中的条目; String port =“5221”; String sid =“orcl”; //或传递所有三个项的命令行参数if（args.length&gt; = 3）{host = args [0]; port = args [1]; sid = args [2]; } String s1 =“jdbc：oracle：thin：@”+ host +“：”+ port +“：”+ sid; if（args.length == 1）{s1 =“jdbc：oracle：oci8：@”+ args [0]; } if（args.length == 4）{s1 =“jdbc：oracle：”+ args [3] +“：@”+“（description =（address =（host =”+ host +“）（protocol = tcp） （port =“+ port +”））（connect_data =（sid =“+ sid +”）））“; System.out.println（“Connecting with：”）; System.out.println（s1）; DriverManager.registerDriver（new oracle.jdbc.driver。一个OracleDriver（））; Connection conn = DriverManager.getConnection（s1，“hr”，“hr”）; DatabaseMetaData dmd = conn.getMetaData（）;的System.out.println（ “DriverVersion：[” + dmd.getDriverVersion（）+ “]”）; System.out.println（“DriverMajorVersion：[”+ dmd.getDriverMajorVersion（）+“]”）; System.out.println（“DriverMinorVersion：[”+ dmd.getDriverMinorVersion（）+“]”）;的System.out.println（ “的DriverName：[” + dmd.getDriverName（）+ “]”）;如果（连环！= null）conn.close（）;的System.out.println（ “完成”。）; } catch（SQLException e）{System.out.println（“\ n *** Java Stack Trace *** \ n”）; e.printStackTrace（）; System.out.println（“\ n *** SQLException捕获*** \ n”）;而（e！= null）{System.out.println（“SQLState：”+ e.getSQLState（））; System.out.println（“Message：”+ e.getMessage（））; System.out.println（“错误代码：”+ e.getErrorCode（））; e = e.getNextException（）; System.out.println（“”）; }}}}</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div>
               </div>
            </div><a id="JJDBC28986"></a><div class="props_rev_3"><a id="GUID-BEF28F31-0A7F-47F7-9CB4-A9635768B983" name="GUID-BEF28F31-0A7F-47F7-9CB4-A9635768B983"></a><h3 id="JJDBC-GUID-BEF28F31-0A7F-47F7-9CB4-A9635768B983" class="sect3"><span class="enumeration_section">E.2</span>基本调试程序</h3>
               <div>
                  <div class="section">
                     <p>本节介绍了策略<a id="d116827e765" class="indexterm-anchor"></a>调试JDBC程序：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="JDBC-troubleshooting.html#GUID-E51079F5-28FC-4C76-9FAE-85D8E9B4E6F9">Oracle Net Tracing to Trap网络事件</a></p>
                        </li>
                        <li>
                           <p><a href="JDBC-troubleshooting.html#GUID-0B05B4E3-F132-4725-A5AE-539BB402ABB8">第三方调试工具</a></p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="JDBC-getting-started.html#GUID-E187D04E-B48D-4394-9DC5-1ECEEBC53AFD">关于处理SQL异常</a></li>
                     </ul>
                  </div>
               </div>
               <a id="JJDBC28987"></a><div class="props_rev_3"><a id="GUID-E51079F5-28FC-4C76-9FAE-85D8E9B4E6F9" name="GUID-E51079F5-28FC-4C76-9FAE-85D8E9B4E6F9"></a><h4 id="JJDBC-GUID-E51079F5-28FC-4C76-9FAE-85D8E9B4E6F9" class="sect4"><span class="enumeration_section">E.2.1</span> Oracle网络跟踪以捕获网络事件</h4>
                  <div>
                     <div class="section">
                        <p><a id="d116827e812" class="indexterm-anchor"></a>您可以启用客户端和服务器Oracle-Net跟踪来捕获通过Oracle Net发送的数据包。您只能对JDBC OCI驱动程序使用客户端跟踪; JDBC Thin驱动程序不支持它。
                        </p>
                        <p>该<a id="d116827e817" class="indexterm-anchor"></a>跟踪工具生成详细的语句序列，用于描述执行时的网络事件。 “跟踪”操作可让您获取有关事件内部操作的更多信息。此信息将打印到可读文件中，以识别导致错误的事件。<code class="codeph">SQLNET.ORA</code>文件中的几个Oracle Net参数控制着跟踪信息的收集。在<code class="codeph">SQLNET.ORA</code>设置参数后，必须建立新连接才能执行跟踪。
                        </p>
                        <p>跟踪级别越高，跟踪文件中捕获的细节越多。由于跟踪文件很难理解，因此在启用跟踪时以跟踪级别4开始。跟踪文件的第一部分包含连接握手信息，因此请查看与JDBC程序相关的SQL语句和错误消息。</p>
                        <div class="infoboxnote" id="GUID-E51079F5-28FC-4C76-9FAE-85D8E9B4E6F9__GUID-1296CE44-9B23-41B6-A7A6-10C8718691F1">
                           <p class="notep1">注意：</p>
                           <p>跟踪工具使用大量磁盘空间，可能会对系统性能产生重大影响。因此，仅在必要时启用跟踪。</p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="../lnoci/build-and-configure-oci-applications.html#LNOCI-GUID-7F47F9F7-EF51-4D68-8B2A-2443C837710B" target="_blank"><span class="italic">Oracle调用接口程序员指南</span></a></li>
                        </ul>
                     </div>
                  </div><a id="JJDBC28988"></a><div class="props_rev_3"><a id="GUID-1897E108-9DCA-47D2-9248-51FC4050C2F4" name="GUID-1897E108-9DCA-47D2-9248-51FC4050C2F4"></a><h5 id="JJDBC-GUID-1897E108-9DCA-47D2-9248-51FC4050C2F4" class="sect5"><span class="enumeration_section">E.2.1.1</span>客户端跟踪</h5>
                     <div>
                        <div class="section">
                           <p><a id="d116827e861" class="indexterm-anchor"></a>在客户端系统上的<code class="codeph">SQLNET.ORA</code>文件中设置以下参数。
                           </p>
                           <div class="infoboxnote" id="GUID-1897E108-9DCA-47D2-9248-51FC4050C2F4__GUID-E08178E8-1A9E-4D59-B080-D0F6EBA214B4">
                              <p class="notep1">注意：</p>
                              <p>从Oracle Database 12 <span class="italic">c</span>第1版（12.1）开始，Oracle建议您使用新XML配置文件<code class="codeph">oraaccess.xml</code>中的配置参数，而不是<code class="codeph">sqlnet.ora</code>文件中存在的OCI特定配置参数。但是，仍支持<code class="codeph">sqlnet.ora</code>文件中存在的配置参数。
                              </p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div><a id="JJDBC28989"></a><div class="props_rev_3"><a id="GUID-76ADC54B-9B43-4E87-BC14-7DCB7971815D" name="GUID-76ADC54B-9B43-4E87-BC14-7DCB7971815D"></a><h6 id="JJDBC-GUID-76ADC54B-9B43-4E87-BC14-7DCB7971815D" class="sect6"><span class="enumeration_section">E.2.1.1.1</span> TRACE_LEVEL_CLIENT</h6>
                        <div>
                           <div class="section">
                              <p><span class="bold">目的：</span></p>
                              <p>将跟踪<code class="codeph">on</code>或<code class="codeph">off</code>到某个指定的级别。
                              </p>
                              <p><span class="bold">默认值：</span></p>
                              <p>0或OFF</p>
                              <p><span class="bold">可用值：</span></p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>0或<code class="codeph">OFF</code> - 无跟踪输出</p>
                                 </li>
                                 <li>
                                    <p>4或<code class="codeph">USER</code> - 用户跟踪信息</p>
                                 </li>
                                 <li>
                                    <p>10或<code class="codeph">ADMIN</code> - 管理跟踪信息</p>
                                 </li>
                                 <li>
                                    <p>16或<code class="codeph">SUPPORT</code> -  WorldWide客户支持跟踪信息</p>
                                 </li>
                              </ul>
                              <p><span class="bold">例：</span></p><pre class="oac_no_warn" dir="ltr">TRACE_LEVEL_CLIENT = 10</pre></div>
                           <!-- class="section" -->
                        </div>
                     </div><a id="JJDBC28990"></a><div class="props_rev_3"><a id="GUID-1D4FEE6F-6CE8-4DAC-9551-C8A8086382B5" name="GUID-1D4FEE6F-6CE8-4DAC-9551-C8A8086382B5"></a><h6 id="JJDBC-GUID-1D4FEE6F-6CE8-4DAC-9551-C8A8086382B5" class="sect6"><span class="enumeration_section">E.2.1.1.2</span> TRACE_DIRECTORY_CLIENT</h6>
                        <div>
                           <div class="section">
                              <p><span class="bold">目的：</span></p>
                              <p>指定跟踪文件的目标目录。</p>
                              <p><span class="bold">默认值：</span></p>
                              <p><span class="italic"><code class="codeph">ORACLE_HOME</code></span> <code class="codeph">/network/trace</code></p>
                              <p><span class="bold">例：</span></p>
                              <p>UNIX： <code class="codeph">TRACE_DIRECTORY_CLIENT=/oracle/traces</code></p>
                              <p>Windows： <code class="codeph">TRACE_DIRECTORY_CLIENT=C:\ORACLE\TRACES</code></p>
                           </div>
                           <!-- class="section" -->
                        </div>
                     </div><a id="JJDBC28991"></a><div class="props_rev_3"><a id="GUID-8E648E37-F094-49EB-8336-DE812D1175A9" name="GUID-8E648E37-F094-49EB-8336-DE812D1175A9"></a><h6 id="JJDBC-GUID-8E648E37-F094-49EB-8336-DE812D1175A9" class="sect6"><span class="enumeration_section">E.2.1.1.3</span> TRACE_FILE_CLIENT</h6>
                        <div>
                           <div class="section">
                              <p><span class="bold">目的：</span></p>
                              <p>指定客户端跟踪文件的名称。</p>
                              <p><span class="bold">默认值：</span></p>
                              <p><code class="codeph">SQLNET.TRC</code> 
                              </p>
                              <p><span class="bold">例：</span></p>
                              <p><code class="codeph">TRACE_FILE_CLIENT = cli_Connection1.trc</code></p>
                              <div class="infoboxnote" id="GUID-8E648E37-F094-49EB-8336-DE812D1175A9__GUID-0C10AFAC-07F2-40F6-BBC7-E6B788F56908">
                                 <p class="notep1">注意：</p>
                                 <p>确保为<code class="codeph">TRACE_FILE_CLIENT</code>文件选择的名称与为<code class="codeph">TRACE_FILE_SERVER</code>文件选择的名称不同。
                                 </p>
                              </div>
                           </div>
                           <!-- class="section" -->
                        </div>
                     </div><a id="JJDBC28992"></a><div class="props_rev_3"><a id="GUID-B36DEDF2-80D2-4CD0-967B-E630B5ED3FF2" name="GUID-B36DEDF2-80D2-4CD0-967B-E630B5ED3FF2"></a><h6 id="JJDBC-GUID-B36DEDF2-80D2-4CD0-967B-E630B5ED3FF2" class="sect6"><span class="enumeration_section">E.2.1.1.4</span> TRACE_UNIQUE_CLIENT</h6>
                        <div>
                           <div class="section">
                              <p><span class="bold">目的：</span></p>
                              <p>为每个客户端跟踪提供唯一名称，以防止每次跟踪文件被下一次出现的客户端跟踪覆盖。<code class="codeph">PID</code>附加到文件名的末尾。
                              </p>
                              <p><span class="bold">默认值：</span></p>
                              <p><code class="codeph">关闭</code> 
                              </p>
                              <p><span class="bold">例：</span></p>
                              <p><code class="codeph">TRACE_UNIQUE_CLIENT = ON</code></p>
                           </div>
                           <!-- class="section" -->
                        </div>
                     </div>
                  </div><a id="JJDBC28993"></a><div class="props_rev_3"><a id="GUID-EC7C9DD4-E4DE-4D55-A327-CBE4B3CD495F" name="GUID-EC7C9DD4-E4DE-4D55-A327-CBE4B3CD495F"></a><h5 id="JJDBC-GUID-EC7C9DD4-E4DE-4D55-A327-CBE4B3CD495F" class="sect5"><span class="enumeration_section">E.2.1.2</span>服务器端跟踪</h5>
                     <div>
                        <div class="section">
                           <p><a id="d116827e1124" class="indexterm-anchor"></a>在服务器系统上的<code class="codeph">SQLNET.ORA</code>文件中设置以下参数。每个连接都将生成一个具有唯一文件名的单独文件。
                           </p>
                           <div class="infoboxnote" id="GUID-EC7C9DD4-E4DE-4D55-A327-CBE4B3CD495F__GUID-7624DF7D-C47D-4F07-800F-F6014061A6C1">
                              <p class="notep1">注意：</p>
                              <p>从Oracle Database 12 <span class="italic">c</span>第1版（12.1）开始，Oracle建议您使用新XML配置文件<code class="codeph">oraaccess.xml</code>中的配置参数，而不是<code class="codeph">sqlnet.ora</code>文件中存在的OCI特定配置参数。但是，仍支持<code class="codeph">sqlnet.ora</code>文件中存在的配置参数。
                              </p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div><a id="JJDBC28994"></a><div class="props_rev_3"><a id="GUID-64C4ABAF-0C8C-4DC2-AA6F-053911E457F0" name="GUID-64C4ABAF-0C8C-4DC2-AA6F-053911E457F0"></a><h6 id="JJDBC-GUID-64C4ABAF-0C8C-4DC2-AA6F-053911E457F0" class="sect6"><span class="enumeration_section">E.2.1.2.1</span> TRACE_LEVEL_SERVER</h6>
                        <div>
                           <div class="section">
                              <p><span class="bold">目的：</span></p>
                              <p>将跟踪<code class="codeph">on</code>或<code class="codeph">off</code>到某个指定的级别。
                              </p>
                              <p><span class="bold">默认值：</span></p>
                              <p>0或<code class="codeph">OFF</code></p>
                              <p><span class="bold">可用值：</span></p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>0或<code class="codeph">OFF</code> - 无跟踪输出</p>
                                 </li>
                                 <li>
                                    <p>4或<code class="codeph">USER</code> - 用户跟踪信息</p>
                                 </li>
                                 <li>
                                    <p>10或<code class="codeph">ADMIN</code> - 管理跟踪信息</p>
                                 </li>
                                 <li>
                                    <p>16或<code class="codeph">SUPPORT</code> -  WorldWide客户支持跟踪信息</p>
                                 </li>
                              </ul>
                              <p><span class="bold">例：</span></p><pre class="oac_no_warn" dir="ltr">TRACE_LEVEL_SERVER = 10</pre></div>
                           <!-- class="section" -->
                        </div>
                     </div><a id="JJDBC28995"></a><div class="props_rev_3"><a id="GUID-7438E1EC-8FFA-4472-BA10-7457125F0E5E" name="GUID-7438E1EC-8FFA-4472-BA10-7457125F0E5E"></a><h6 id="JJDBC-GUID-7438E1EC-8FFA-4472-BA10-7457125F0E5E" class="sect6"><span class="enumeration_section">E.2.1.2.2</span> TRACE_DIRECTORY_SERVER</h6>
                        <div>
                           <div class="section">
                              <p><span class="bold">目的：</span></p>
                              <p>指定跟踪文件的目标目录。</p>
                              <p><span class="bold">默认值：</span></p>
                              <p><span class="italic"><code class="codeph">ORACLE_HOME</code></span> <code class="codeph">/network/trace</code> 
                              </p>
                              <p><span class="bold">例：</span></p>
                              <p><code class="codeph">TRACE_DIRECTORY_SERVER = / ORACLE /迹线</code> 
                              </p>
                           </div>
                           <!-- class="section" -->
                        </div>
                     </div><a id="JJDBC28996"></a><div class="props_rev_3"><a id="GUID-FF07DC7F-7E32-43E6-BAFC-E96A09EB8F7E" name="GUID-FF07DC7F-7E32-43E6-BAFC-E96A09EB8F7E"></a><h6 id="JJDBC-GUID-FF07DC7F-7E32-43E6-BAFC-E96A09EB8F7E" class="sect6"><span class="enumeration_section">E.2.1.2.3</span> TRACE_FILE_SERVER</h6>
                        <div>
                           <div class="section">
                              <p><span class="bold">目的：</span></p>
                              <p>指定服务器跟踪文件的名称。</p>
                              <p><span class="bold">默认值：</span></p>
                              <p><code class="codeph">SERVER.TRC</code> 
                              </p>
                              <p><span class="bold">例：</span></p>
                              <p><code class="codeph">TRACE_FILE_SERVER = svr_Connection1.trc</code> 
                              </p>
                              <div class="infoboxnote" id="GUID-FF07DC7F-7E32-43E6-BAFC-E96A09EB8F7E__GUID-695EAA99-E658-4337-B353-8209823E6F31">
                                 <p class="notep1">注意：</p>
                                 <p>确保为<code class="codeph">TRACE_FILE_SERVER</code>文件选择的名称与为<code class="codeph">TRACE_FILE_CLIENT</code>文件选择的名称不同。
                                 </p>
                              </div>
                           </div>
                           <!-- class="section" -->
                        </div>
                     </div>
                  </div>
               </div><a id="JJDBC28997"></a><div class="props_rev_3"><a id="GUID-0B05B4E3-F132-4725-A5AE-539BB402ABB8" name="GUID-0B05B4E3-F132-4725-A5AE-539BB402ABB8"></a><h4 id="JJDBC-GUID-0B05B4E3-F132-4725-A5AE-539BB402ABB8" class="sect4"><span class="enumeration_section">E.2.2</span>第三方调试工具</h4>
                  <div>
                     <div class="section">
                        <p>您可以使用诸如此类的工具<a id="d116827e1344" class="indexterm-anchor"></a> JDBCSpy和<a id="d116827e1347" class="indexterm-anchor"></a> Intersolv的JDBCTest在JDBC API级别进行故障排除。这些工具类似于<a id="d116827e1350" class="indexterm-anchor"></a> ODBC间谍和<a id="d116827e1353" class="indexterm-anchor"></a> ODBC测试工具。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>