<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>Security</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Database Development Guide">
      <meta property="og:description" content="">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Database Development Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="database-development-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-01-31T23:23:15-08:00">
      <meta name="dcterms.title" content="Database Development Guide">
      <meta name="dcterms.dateCopyrighted" content="1996, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96334-02">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="rwp.html" title="Previous" type="text/html">
      <link rel="next" href="high-availability.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="ADFNS">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="rwp.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="high-availability.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Database Development Guide</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="fundamentals.html" property="item" typeof="WebPage"><span property="name">Database Development Fundamentals</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Security</li>
            </ol>
            <a id="GUID-986CF5A7-506D-43F4-B6E2-F90654804417" name="GUID-986CF5A7-506D-43F4-B6E2-F90654804417"></a><a id="ADFNS518"></a><a id="ADFNS230"></a>
            
            <h2 id="ADFNS-GUID-986CF5A7-506D-43F4-B6E2-F90654804417" class="sect2"><span class="enumeration_chapter">5 </span>Security
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>This chapter explains some fundamentals of designing security into the database and database applications.</p>
               <div class="section">
                  <p class="subhead1" id="GUID-986CF5A7-506D-43F4-B6E2-F90654804417__GUID-C9E297F5-9813-4856-B1FC-D35A788E7956">Topics:</p>
               </div>
               <!-- class="section" -->
               <ul style="list-style-type: disc;">
                  <li>
                     <p><a href="security.html#GUID-4CE77161-E920-4B78-ADD5-364AFA8059A7">Enabling User Access with Grants_ Roles_ and Least Privilege</a></p>
                  </li>
                  <li>
                     <p><a href="security.html#GUID-B1B9B149-A7CC-412B-8410-A8A0DD74ADCE">Automating Database Logins</a></p>
                  </li>
                  <li>
                     <p><a href="security.html#GUID-1E187378-E87F-4B69-92E1-2EA67A67C808">Controlling User Access with Fine-Grained Access Control</a></p>
                  </li>
                  <li>
                     <p><a href="security.html#GUID-795BBFD7-FDE5-45A1-AD52-E1E9021318F7">Using Invoker's and Definer's Rights for Procedures and Functions</a></p>
                  </li>
                  <li>
                     <p><a href="security.html#GUID-E421C68E-05DD-4948-9774-95F0F080E3C8">Managing External Procedures for Your Applications</a></p>
                  </li>
                  <li>
                     <p><a href="security.html#GUID-6B88545A-3D20-48E2-9407-7B7C7D8EDA00">Auditing User Activity</a></p>
                  </li>
               </ul>
            </div><a id="ADFNS520"></a><a id="ADFNS519"></a><div class="props_rev_3"><a id="GUID-4CE77161-E920-4B78-ADD5-364AFA8059A7" name="GUID-4CE77161-E920-4B78-ADD5-364AFA8059A7"></a><h3 id="ADFNS-GUID-4CE77161-E920-4B78-ADD5-364AFA8059A7" class="sect3">Enabling User Access with Grants, Roles, and Least Privilege</h3>
               <div>
                  <div class="section">
                     <p>This topic explains how you can grant privileges and roles to users to restrict access to data. It also explains the importance of the concept of least privilege, introduces secure application roles as a way to automatically filter out users who attempt to log in to your applications. </p>
                     <p>A user <span class="bold">privilege</span> is the right to perform an action, such as updating or deleting data. You can grant users privileges to perform these actions. A <span class="bold">role</span> is named collection of privileges that are grouped together, usually to enable users to perform a set of tasks related to their jobs. For example, a role called <code class="codeph">clerk</code> can enable clerks to do things like create, update, and delete files. The <code class="codeph">clerk_mgr</code> role can include the <code class="codeph">clerk</code> role, plus some additional privileges such as approving the clerks' expense reports or managing their performance appraisals. 
                     </p>
                     <p>When you grant privileges to users, apply the principle of least privilege: <span class="italic">Grant users only the privileges that they need</span>. If possible, do not directly grant the user a privilege. Instead, create a role that defines the set of privileges the user needs and then grant the user this role. For example, grant user <code class="codeph">fred</code> the <code class="codeph">CREATE SESSION</code> privilege so that he can log in to a database session. But for the privileges that he needs for his job, such as the <code class="codeph">UPDATE TABLE</code> privilege, grant him a role that has those privileges.
                     </p>
                     <p>You can design your applications to automatically grant a role to the user who is trying to log in, provided the user meets criteria that you specify. To do so, you create a <span class="bold">secure application role</span>, which is a role that is associated with a PL/SQL procedure (or PL/SQL package that contains multiple procedures). The procedure validates the user: if the user fails the validation, then the user cannot log in. If the user passes the validation, then the procedure grants the user a role so that he or she can use the application. The user has this role only while he or she is logged in to the application. When the user logs out, the role is revoked. 
                     </p>
                     <div class="infoboxnotealso" id="GUID-4CE77161-E920-4B78-ADD5-364AFA8059A7__GUID-5520F9DC-96C0-4F17-80F2-F48BB93FF4DA">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="../dbseg/configuring-privilege-and-role-authorization.html#DBSEG004" target="_blank"><span class="italic">Oracle Database Security Guide</span></a> more information about privilege and role authorization
                              </p>
                           </li>
                           <li>
                              <p><a href="../dbseg/configuring-privilege-and-role-authorization.html#DBSEG524" target="_blank"><span class="italic">Oracle Database Security Guide</span></a> more information about secure application roles
                              </p>
                           </li>
                        </ul>
                     </div>
                     <p><a href="security.html#GUID-4CE77161-E920-4B78-ADD5-364AFA8059A7__BABCBGJE">Example 5-1</a> shows a secure application role procedure that allows the user to log in during business hours (8 a.m. to 5 p.m.) from a specific set of work stations. If the user passes these checks, then the user is granted the <code class="codeph">hr_admin</code> role and then is able to log in to the application. 
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-4CE77161-E920-4B78-ADD5-364AFA8059A7__BABCBGJE">
                     <p class="titleinexample">Example 5-1 Secure Application Role Procedure to Restrict Access to Business Hours</p><pre class="oac_no_warn" dir="ltr">CREATE OR REPLACE PROCEDURE hr_admin_role_check
 AUTHID CURRENT_USER 
 AS 
 BEGIN 
  IF (SYS_CONTEXT ('userenv','ip_address') 
    BETWEEN '192.0.2.10' and '192.0.2.20'
     AND
    TO_CHAR (SYSDATE, 'HH24') BETWEEN 8 AND 17)
  THEN
    EXECUTE IMMEDIATE 'SET ROLE hr_admin'; 
  END IF;
 END;
/</pre></div>
                  <!-- class="example" -->
               </div>
            </div><a id="ADFNS522"></a><a id="ADFNS521"></a><div class="props_rev_3"><a id="GUID-B1B9B149-A7CC-412B-8410-A8A0DD74ADCE" name="GUID-B1B9B149-A7CC-412B-8410-A8A0DD74ADCE"></a><h3 id="ADFNS-GUID-B1B9B149-A7CC-412B-8410-A8A0DD74ADCE" class="sect3">Automating Database Logins</h3>
               <div>
                  <div class="section">
                     <p>To automate database logins, you create a logon trigger to run a PL/SQL procedure that can validate a user who is attempting to log in to an application. When the user logs in, the trigger executes. Logon triggers can perform multiple actions, such as generating an alert if the user fails the validation, displaying error messages, and so on. </p>
                     <p><a href="security.html#GUID-B1B9B149-A7CC-412B-8410-A8A0DD74ADCE__BABHBFAG">Example 5-2</a> shows a simple logon trigger that executes a PL/SQL procedure.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-B1B9B149-A7CC-412B-8410-A8A0DD74ADCE__BABHBFAG">
                     <p class="titleinexample">Example 5-2 Creating a Logon Trigger </p><pre class="oac_no_warn" dir="ltr">CREATE OR REPLACE TRIGGER run_logon_trig AFTER LOGON ON DATABASE
 BEGIN
 &nbsp;sec_mgr.check_user_proc;
 END;</pre><div class="infoboxnotealso" id="GUID-B1B9B149-A7CC-412B-8410-A8A0DD74ADCE__GUID-3444C3E7-BC33-4B25-A3A3-6E807116BE13">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="../lnpls/CREATE-TRIGGER-statement.html#LNPLS01374" target="_blank"><span class="italic">Oracle Database PL/SQL Language Reference</span></a> for detailed information about the <code class="codeph">CREATE TRIGGER</code> statement
                              </p>
                           </li>
                           <li>
                              <p><a href="../dbseg/using-application-contexts-to-retrieve-user-information.html#DBSEG60634" target="_blank"><span class="italic">Oracle Database Security Guide</span></a> for information about how to create a logon trigger that runs a database session application context package
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="example" -->
               </div>
            </div><a id="ADFNS523"></a><div class="props_rev_3"><a id="GUID-1E187378-E87F-4B69-92E1-2EA67A67C808" name="GUID-1E187378-E87F-4B69-92E1-2EA67A67C808"></a><h3 id="ADFNS-GUID-1E187378-E87F-4B69-92E1-2EA67A67C808" class="sect3">Controlling User Access with Fine-Grained Access Control</h3>
               <div>
                  <div class="section">
                     <p>There are several ways that you can control the level of access users have to data from your applications. </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><span class="bold">Oracle Virtual Private Database (VPD):</span> VPD enables you to create policies that can restrict database access at the row and column level. Essentially, VPD adds a dynamic <code class="codeph">WHERE</code> clause to a SQL statement that is issued against the table, view, or synonym to which an VPD security policy was applied. 
                           </p>
                           <p>For example, suppose the user enters the <code class="codeph">SELECT * FROM OE.ORDERS</code> statement. A VPD policy can transform this statement to the following statement instead, so that only the sales representative who owns the order can view this data: 
                           </p><pre class="oac_no_warn" dir="ltr">SELECT * FROM OE.ORDERS 
 WHERE SALES_REP_ID = SYS_CONTEXT('USERENV','SESSION_USER'); 
</pre></li>
                        <li>
                           <p><span class="bold">Oracle Data Redaction:</span> Oracle Data Redaction masks data at run time, at the moment the user attempts to access the data (that is, at query-execution time). This solution works well in a dynamic production system in which data is constantly changing. During the time that the data is being redacted, all data processing is performed normally, and the back-end referential integrity constraints are preserved. You typically redact sensitive data, such as credit card or Social Security numbers.
                           </p>
                           <p>You can mask the data in the following ways: </p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><span class="bold">Full redaction, in which the entire data is masked.</span> For example, the number 37828224 can be displayed as a zero.
                                 </p>
                              </li>
                              <li>
                                 <p><span class="bold">Partial redaction, in which only a portion of the data is redacted.</span> With this type, the number 37828224 can be displayed as *****224. 
                                 </p>
                              </li>
                              <li>
                                 <p><span class="bold">Random redaction, in which the data is displayed as randomized data.</span> Here, the number 37828224 can appear as 93204857. 
                                 </p>
                              </li>
                              <li>
                                 <p><span class="bold">Regular expressions, in which you redact data based on a search pattern.</span> You can use regular expressions in both full and partial redaction. For example, you can redact the user name of email addresses, so that only the domain shows: <code class="codeph">jsmith</code> in the email address <code class="codeph">jsmith@example.com</code> can be replaced with <code class="codeph">[redacted]</code> so that the email address appears as <code class="codeph">[redacted]@example.com</code>.
                                 </p>
                              </li>
                              <li>
                                 <p><span class="bold">No redaction, which enables you to test the internal operation of your redaction policies, with no effect on the results of queries against tables with policies defined on them.</span> You can use this option to test the redaction policy definitions before applying them to a production environment.
                                 </p>
                              </li>
                           </ul>
                        </li>
                        <li>
                           <p><span class="bold">Oracle Label Security:</span> Oracle Label Security secures your database tables at the row level, and assigns these rows different levels of security based on the needs of your site. Rows that contain highly sensitive data can be assigned a label entitled <code class="codeph">HIGHLY SENSITIVE</code>; rows that are less sensitive can be labeled as <code class="codeph">SENSITIVE</code>, and so on. Rows that all users can have access to can be labeled <code class="codeph">PUBLIC</code>. You can create as many labels as you need, to fit your site's security requirements. 
                           </p>
                           <p>For example, when user <code class="codeph">fred</code>, who is a low-level employee, logs in, he would see only data that is available to all users, as defined by the <code class="codeph">PUBLIC</code> label. Yet when his director, <code class="codeph">hortensia</code>, logs in, she can see all the sensitive data that has been assigned the <code class="codeph">HIGHLY SENSITIVE</code> label. 
                           </p>
                        </li>
                        <li>
                           <p><span class="bold">Oracle Database Vault:</span> Oracle Database Vault enables you to restrict administrative access to your data. By default, administrators (such as user <code class="codeph">SYS</code> with the <code class="codeph">SYSDBA</code> privilege) have access to all data in the database. Administrators typically must perform tasks such performance tuning, backup and recovery, and so on. However, they do not need access to your salary records. Database Vault enables you to create policies that restrict the administrator's actions yet not prevent him or her from performing normal administrative activities.
                           </p>
                           <p>A typical Database Vault policy could, for example, prevent an administrator from accessing and modifying the <code class="codeph">HR.EMPLOYEES</code> table. You can create fine-tuned policies that impose restrictions such as limiting the hours the administrator can log in, which computers he can use, whether he can log in to the database using dynamic tools, and so on. Furthermore, you can create policies that generate alerts if the administrator tries to violate a policy. 
                           </p>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-1E187378-E87F-4B69-92E1-2EA67A67C808__GUID-68021F9F-4A7E-489D-83B7-1A2B8B246981">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="../dbseg/using-oracle-vpd-to-control-data-access.html#DBSEG007" target="_blank"><span class="italic">Oracle Database Security Guide</span></a> for more information about Oracle Virtual Private Database
                              </p>
                           </li>
                           <li>
                              <p><a href="../asoag/asopart2.html#ASOAG10135" target="_blank"><span class="italic">Oracle Database Advanced Security Guide</span></a> for more information about Oracle Data Redaction
                              </p>
                           </li>
                           <li>
                              <p><a href="../olsag/introduction-to-oracle-label-security.html#OLSAG-GUID-C20C62AE-2A30-45F9-AEEA-52A0D3286FBA" target="_blank"><span><cite>Oracle Label Security Administrator’s Guide</cite></span></a> for more information about Oracle Label Security
                              </p>
                           </li>
                           <li>
                              <p><a href="../dvadm/introduction-to-oracle-database-vault.html#DVADM-GUID-0C8AF1B2-6CE9-4408-BFB3-7B2C7F9E7284" target="_blank"><span><cite>Oracle Database Vault Administrator’s Guide</cite></span></a> for more information about Oracle Database Vault
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="ADFNS525"></a><a id="ADFNS524"></a><div class="props_rev_3"><a id="GUID-795BBFD7-FDE5-45A1-AD52-E1E9021318F7" name="GUID-795BBFD7-FDE5-45A1-AD52-E1E9021318F7"></a><h3 id="ADFNS-GUID-795BBFD7-FDE5-45A1-AD52-E1E9021318F7" class="sect3">Using Invoker's and Definer's Rights for Procedures and Functions</h3>
               <div>
                  <div class="section">
                     <p class="subhead2" id="GUID-795BBFD7-FDE5-45A1-AD52-E1E9021318F7__GUID-C7FCCB84-A5F9-4B61-9560-A628396480F7">Topics:</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="security.html#GUID-64A1D98A-F174-4868-B977-910486231D50">What Are Invoker's Rights and Definer's Rights?</a></p>
                        </li>
                        <li>
                           <p><a href="security.html#GUID-9B0AF06A-EBF8-411D-B656-88FE9B0CBC8C">Protecting Users Who Run Invoker's Rights Procedures and Functions</a></p>
                        </li>
                        <li>
                           <p><a href="security.html#GUID-5AD2F48C-6314-4287-9031-90D82DDC9100">How Default Rights Are Handled for Java Stored Procedures</a></p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div><a id="ADFNS527"></a><a id="ADFNS526"></a><div class="props_rev_3"><a id="GUID-64A1D98A-F174-4868-B977-910486231D50" name="GUID-64A1D98A-F174-4868-B977-910486231D50"></a><h4 id="ADFNS-GUID-64A1D98A-F174-4868-B977-910486231D50" class="sect4">What Are Invoker's Rights and Definer's Rights?</h4>
                  <div>
                     <p>When you create a procedure or function (that is, a program unit), you can design it so that it runs with either the privileges of the owner (you) or the privileges of the person who is invoking it. Definer's rights run the program unit using the owner's privileges and invoker's rights run the program unit using the privileges of the person who runs it. For example, suppose user <code class="codeph">harold</code> creates a procedure that updates the table <code class="codeph">orders</code>. User <code class="codeph">harold</code> then grants the <code class="codeph">EXECUTE</code> privilege on this procedure to user <code class="codeph">hazel</code>. If <code class="codeph">harold</code> had created the procedure with definer's rights, then the procedure would expect the <code class="codeph">orders</code> table to be in <code class="codeph">harold</code>'s schema. If he created it with invoker's rights, then the procedure would look for the orders table in <code class="codeph">hazel</code>'s schema. 
                     </p>
                     <p>To designate a program unit as definer's rights or invokers rights, use the <code class="codeph">AUTHID</code> clause in the creation statement. If you omit the <code class="codeph">AUTHID</code> clause, then the program unit is created with definer's rights.
                     </p>
                     <p><a href="security.html#GUID-64A1D98A-F174-4868-B977-910486231D50__BABDCIIF">Example 5-3</a> shows how to use the <code class="codeph">AUTHID</code> clause in a <code class="codeph">CREATE PROCEDURE</code> statement to specify definer's rights or invoker's rights.
                     </p>
                     <div class="example" id="GUID-64A1D98A-F174-4868-B977-910486231D50__BABDCIIF">
                        <p class="titleinexample">Example 5-3 Creating Program Units with Definer's Rights or Invoker's Rights</p><pre class="oac_no_warn" dir="ltr">CREATE PROCEDURE my_def_proc AUTHID DEFINER -- Definer's rights procedure
  AS ...

CREATE PROCEDURE my_inv_proc AUTHID CURRENT_USER -- Invoker's rights procedure
  AS ...</pre><div class="infoboxnotealso" id="GUID-64A1D98A-F174-4868-B977-910486231D50__GUID-E13302A8-9456-42F6-AC9B-89661F850EC6">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><a href="../lnpls/plsql-subprograms.html#LNPLS00809" target="_blank"><span class="italic">Oracle Database PL/SQL Language Reference</span></a> for details about definer's rights and invoker's rights procedures and functions
                                 </p>
                              </li>
                              <li>
                                 <p><a href="../lnpls/CREATE-PROCEDURE-statement.html#LNPLS01373" target="_blank"><span class="italic">Oracle Database PL/SQL Language Reference</span></a> for details about the <code class="codeph">CREATE PROCEDURE</code> statement
                                 </p>
                              </li>
                              <li>
                                 <p><a href="../lnpls/CREATE-FUNCTION-statement.html#LNPLS01370" target="_blank"><span class="italic">Oracle Database PL/SQL Language Reference</span></a> for details about the <code class="codeph">CREATE FUNCTION</code> statement
                                 </p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADFNS529"></a><a id="ADFNS528"></a><div class="props_rev_3"><a id="GUID-9B0AF06A-EBF8-411D-B656-88FE9B0CBC8C" name="GUID-9B0AF06A-EBF8-411D-B656-88FE9B0CBC8C"></a><h4 id="ADFNS-GUID-9B0AF06A-EBF8-411D-B656-88FE9B0CBC8C" class="sect4">Protecting Users Who Run Invoker's Rights Procedures and Functions</h4>
                  <div>
                     <div class="section">
                        <p>An important consideration when you create an invoker's rights program unit is the level of privilege that the invoking users have. Suppose user <code class="codeph">harold</code> is a low-ranking employee who has few privileges and <code class="codeph">hazel</code> is an executive with many privileges. When <code class="codeph">hazel</code> runs <code class="codeph">harold</code>'s invoker's rights procedure, the procedure temporarily inherits <code class="codeph">hazel</code>'s privileges (all of them). But because <code class="codeph">harold</code> owns this procedure, he can modify it without her knowing it to behave in ways that take advantage of <code class="codeph">hazel</code>'s privileges, such as giving <code class="codeph">harold</code> a raise. To help safeguard against this type of scenario, after she has ensured that <code class="codeph">harold</code> is trustworthy, user <code class="codeph">hazel</code> can grant <code class="codeph">harold</code> permission so that his invoker's rights procedures and functions have access to <code class="codeph">hazel</code>'s privileges when she runs them. To do so, she must grant him the <code class="codeph">INHERIT PRIVILEGES</code> privilege.
                        </p>
                        <p><a href="security.html#GUID-9B0AF06A-EBF8-411D-B656-88FE9B0CBC8C__BABHFFED">Example 5-4</a> shows how invoking user <code class="codeph">hazel</code> can grant user <code class="codeph">harold</code> the <code class="codeph">INHERIT PRIVILEGES</code> privilege.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-9B0AF06A-EBF8-411D-B656-88FE9B0CBC8C__BABHFFED">
                        <p class="titleinexample">Example 5-4 Granting a Program Unit Creating the INHERIT PRIVILEGES Privilege</p><pre class="oac_no_warn" dir="ltr">GRANT INHERIT PRIVILEGES ON hazel TO harold;
</pre><p>If <code class="codeph">harold</code> proves untrustworthy, <code class="codeph">hazel</code> can revoke the <code class="codeph">INHERIT PRIVILEGES</code> privilege from him. 
                        </p>
                        <p>Administrators such as user <code class="codeph">SYS</code> and <code class="codeph">SYSTEM</code> have the <code class="codeph">INHERIT ANY PRIVILEGES</code> privilege, which enable these users' invoker's rights procedures to have access to the privileges of any invoking users. As with all <code class="codeph">ANY</code> privileges, grant this privilege only to trusted users.
                        </p>
                        <div class="infoboxnotealso" id="GUID-9B0AF06A-EBF8-411D-B656-88FE9B0CBC8C__GUID-955A570A-D274-425B-A331-A80EFBCC6859">
                           <p class="notep1">See Also:</p>
                           <p><a href="../dbseg/managing-security-for-definers-rights-and-invokers-rights.html#DBSEG658" target="_blank"><span class="italic">Oracle Database Security Guide</span></a> for more information about managing security for definer's rights and invoker's rights procedures and functions
                           </p>
                        </div>
                     </div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADFNS531"></a><a id="ADFNS530"></a><div class="props_rev_3"><a id="GUID-5AD2F48C-6314-4287-9031-90D82DDC9100" name="GUID-5AD2F48C-6314-4287-9031-90D82DDC9100"></a><h4 id="ADFNS-GUID-5AD2F48C-6314-4287-9031-90D82DDC9100" class="sect4">How Default Rights Are Handled for Java Stored Procedures</h4>
                  <div>
                     <p>By default, Java class schema objects run with the privileges of their invoker, not with definer's rights. If you want your Java schema objects to run with definer's rights, then when you load them by using the <code class="codeph">loadjava</code> tool, specify the <code class="codeph">-definer</code> option.
                     </p>
                     <p><a href="security.html#GUID-5AD2F48C-6314-4287-9031-90D82DDC9100__BABJJHFC">Example 5-5</a> shows how to use the <code class="codeph">-definer</code> option in a <code class="codeph">loadjava</code> command.
                     </p>
                     <div class="example" id="GUID-5AD2F48C-6314-4287-9031-90D82DDC9100__BABJJHFC">
                        <p class="titleinexample">Example 5-5 Loading a Java Class with Definer's Rights</p><pre class="oac_no_warn" dir="ltr">loadjava -u joe -resolve -schema TEST -definer ServerObjects.jar
Password: <span class="italic">password</span>
</pre><p>You can use the <code class="codeph">-definer</code> option on individual classes. Be aware that different definers may have different privileges. Apply the <code class="codeph">-definer</code> option with care, so that you can achieve the desired results. Doing so helps to ensure that your classes run with no more than the privileges that they need. 
                        </p>
                        <div class="infoboxnotealso" id="GUID-5AD2F48C-6314-4287-9031-90D82DDC9100__GUID-C693CB87-7447-46C9-8837-4E9798021E7C">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><a href="../jjdev/loadjava-tool.html#JJDEV10060" target="_blank"><span class="italic">Oracle Database Java Developer's Guide</span></a> for detailed information about the <code class="codeph">loadjava</code> tool
                                 </p>
                              </li>
                              <li>
                                 <p><a href="../jjdev/preparing-Java-class-methods.html#JJDEV13085" target="_blank"><span class="italic">Oracle Database Java Developer's Guide</span></a> for more information about controlling the current user in Java applications
                                 </p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="example" -->
                  </div>
               </div>
            </div><a id="ADFNS1421"></a><div class="props_rev_3"><a id="GUID-E421C68E-05DD-4948-9774-95F0F080E3C8" name="GUID-E421C68E-05DD-4948-9774-95F0F080E3C8"></a><h3 id="ADFNS-GUID-E421C68E-05DD-4948-9774-95F0F080E3C8" class="sect3">Managing External Procedures for Your Applications</h3>
               <div>
                  <div class="section">
                     <p>For security reasons, Oracle external procedures run in a process that is physically separate from Oracle Database. When you invoke an external procedure, Oracle Database creates the <code class="codeph">extproc</code> operating system process (or agent), by using the operating system privileges of the user that started the listener for the database instance. 
                     </p>
                     <p>You can configure the <code class="codeph">extproc</code> agent to run as a designated operating system credential. To use this functionality, you define a credential to be associated with the <code class="codeph">extproc</code> process, which then can authenticate impersonate (that is, run on behalf of the supplied user credential) before loading a user-defined shared library and executing a function. To configure the <code class="codeph">extproc</code> user credential, you use the PL/SQL package <code class="codeph">DBMS_CREDENTIAL</code> and the PL/SQL statement <code class="codeph">CREATE LIBRARY</code>. 
                     </p>
                     <div class="infoboxnotealso" id="GUID-E421C68E-05DD-4948-9774-95F0F080E3C8__GUID-75059990-BBB3-4391-A7BE-2224761A6686">
                        <p class="notep1">See Also:</p>
                        <p><a href="../dbseg/managing-security-for-application-developers.html#DBSEG656" target="_blank"><span class="italic">Oracle Database Security Guide</span></a> for more information about securing external procedures
                        </p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="ADFNS532"></a><div class="props_rev_3"><a id="GUID-6B88545A-3D20-48E2-9407-7B7C7D8EDA00" name="GUID-6B88545A-3D20-48E2-9407-7B7C7D8EDA00"></a><h3 id="ADFNS-GUID-6B88545A-3D20-48E2-9407-7B7C7D8EDA00" class="sect3">Auditing User Activity</h3>
               <div>
                  <div class="section">
                     <p>You can create audit policies to audit specific actions in the database. Oracle Database then records these actions in an audit trail. The database mandatorily audits some actions and writes these to the audit trail as well. The audit policies that you create can be simple, such as auditing all actions by a specific user, or complex, such as testing for specific conditions and sending email alerts if these conditions are violated.</p>
                     <p>When you install an Oracle Database, you can choose how your database is audited.</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><span class="bold">Unified auditing:</span> In unified auditing, all audit trails are written to a single audit trail, viewable by the <code class="codeph">V$UNIFIED_AUDIT_TRAIL</code> and <code class="codeph">GV$UNIFIED_AUDIT_TRAIL</code> dynamic views. This audit trail encompasses not only Oracle Database-specific actions, but also actions performed in Oracle Real Application Security, Oracle Recovery Manager, Oracle Database Vault, and Oracle Label Security environments. The audit records from these sources are presented in a consistent, uniform format. You can create named audit policies and enable and disable them as necessary. If you want to use unified auditing, then you must migrate your databases to it. 
                           </p>
                        </li>
                        <li>
                           <p><span class="bold">Mixture of unified auditing and pre-Release 12</span><span class="italic"><span class="bold">c</span></span><span class="bold"> auditing: </span>For the most part, this option enables you to use the pre-Release 12<span class="italic">c</span> auditing, in which audit records are written to different locations using their own formats. However, Release 12<span class="italic">c</span> functionality, such as using auditing in a multitenant environment, is available. This type of auditing is the default for both new and upgraded databases.
                           </p>
                        </li>
                     </ul>
                     <p>In both cases, when you upgrade your databases to Oracle Database 12<span class="italic">c</span> Release 1 (12.1.0.1), the audit records from the previous release are preserved. If you decide to migrate to use unified auditing fully, you can archive these earlier records and then purge the audit trail. After you complete the migration, the new audit records are written to the unified audit trail.
                     </p>
                     <div class="infoboxnotealso" id="GUID-6B88545A-3D20-48E2-9407-7B7C7D8EDA00__GUID-DC6682B7-EA26-418F-8BD4-9AA821F2B6E2">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="../dbseg/part_6.html#DBSEG006" target="_blank"><span class="italic">Oracle Database Security Guide</span></a> for more information about creating and managing unified auditing policies
                              </p>
                           </li>
                           <li>
                              <p><a href="../dbseg/how-unified-auditing-migration-affects-individual-audit-features.html#DBSEG341" target="_blank"><span class="italic">Oracle Database Security Guide</span></a> to find a detailed comparison of unified auditing and pre-Release 12<span class="italic">c</span> auditing
                              </p>
                           </li>
                           <li>
                              <p><a href="../upgrd/recommended-and-best-practices-complete-upgrading-oracle-database.html#UPGRD52810" target="_blank"><span class="italic">Oracle Database Upgrade Guide</span></a> for information about migrating to unified auditing
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
         </div>
      </article>
   </body>
</html>