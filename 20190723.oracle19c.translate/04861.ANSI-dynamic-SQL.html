<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>ANSI动态SQL</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Programmer&#39;s Guide"></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Programmer&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="cobol-programmers-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-11T02:40:40-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96466-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="applications.html" title="Previous" type="text/html"></link>
      <link rel="next" href="Oracle-dynamic-SQL-method-4.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Pro*COBOL Programmer&#39;s Guide"></meta>
    <meta name="dcterms.isVersionOf" content="LNPCB"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="applications.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="Oracle-dynamic-SQL-method-4.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">程序员指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="applications.html" property="item" typeof="WebPage"><span property="name">应用</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">ANSI动态SQL</li>
            </ol>
            <a id="GUID-D6E9ACBE-EFF4-42F6-A855-B510004F4164" name="GUID-D6E9ACBE-EFF4-42F6-A855-B510004F4164"></a><a id="LNPCB010"></a>
            
            <h2 id="LNPCB-GUID-D6E9ACBE-EFF4-42F6-A855-B510004F4164" class="sect2"><span class="enumeration_chapter">10</span> ANSI动态SQL</h2>
         </header>
         <div class="ind">
            <div>
               <p><a id="d68132e21" class="indexterm-anchor"></a><a id="d68132e25" class="indexterm-anchor"></a><a id="d68132e29" class="indexterm-anchor"></a>本章介绍Oracle的实现<a id="d68132e34" class="indexterm-anchor"></a>应用于新方法4应用程序的ANSI动态SQL（即SQL标准指定的动态SQL）。它对旧的Oracle动态SQL方法4进行了增强，这在“Oracle动态SQL：方法4”中有所描述。ANSI方法4支持所有Oracle类型，而老的Oracle方法4 <span class="italic">不</span>支持游标变量，项目组的表，DML返回条款和LOB的。
               </p>
               <p>在ANSI动态SQL中，描述符由Oracle内部维护，而在较旧的Oracle动态SQL方法4中，描述符在用户的Pro * COBOL程序中定义。在这两种情况下，使用方法4，Pro * COBOL程序接受或构建包含不同数量的主机变量的SQL语句。</p>
               <p>本章的主要部分是：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="ANSI-dynamic-SQL.html#GUID-11CE39E7-DC23-4AF4-80DE-436DD93D713A">ANSI动态SQL的基础知识</a></p>
                  </li>
                  <li>
                     <p><a href="ANSI-dynamic-SQL.html#GUID-C6A4A78D-1914-44CB-B7FC-9A808917F681">ANSI SQL语句概述</a></p>
                  </li>
                  <li>
                     <p><a href="ANSI-dynamic-SQL.html#GUID-A68A8D42-8AB5-4EDF-B4FA-D57C95967D8E">Oracle Extensions</a></p>
                  </li>
                  <li>
                     <p><a href="ANSI-dynamic-SQL.html#GUID-696564A9-7206-4D4A-B78E-4A1375659239">ANSI动态SQL预编译器选项</a></p>
                  </li>
                  <li>
                     <p><a href="ANSI-dynamic-SQL.html#GUID-BF9199DA-04C3-48C1-B055-7682C13D2BE8">动态SQL语句的完整语法</a></p>
                  </li>
                  <li>
                     <p><a href="ANSI-dynamic-SQL.html#GUID-754BE05E-F9C4-406E-B77C-7E4BF7F67EDC">示例程序：SAMPLE12。PCO</a></p>
                  </li>
               </ul>
            </div>
            <div>
               <div class="relinfo">
                  <p><strong>相关话题</strong></p>
                  <ul>
                     <li><a href="Oracle-dynamic-SQL-method-4.html#GUID-C6256169-5928-466C-B7C7-960D20705EED">Oracle动态SQL：方法4</a></li>
                  </ul>
               </div>
            </div>
            <a id="LNPCB617"></a><div class="props_rev_3"><a id="GUID-11CE39E7-DC23-4AF4-80DE-436DD93D713A" name="GUID-11CE39E7-DC23-4AF4-80DE-436DD93D713A"></a><h3 id="LNPCB-GUID-11CE39E7-DC23-4AF4-80DE-436DD93D713A" class="sect3"><span class="enumeration_section">10.1</span> ANSI动态SQL的基础知识</h3>
               <div>
                  <p>考虑SQL语句：</p><pre class="oac_no_warn" dir="ltr">SELECT ename，empno FROM emp WHERE deptno =：deptno_data</pre><p>您使用ANSI动态SQL的步骤如下：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>声明变量，包括用于保存要执行的语句的字符串。</p>
                     </li>
                     <li>
                        <p>为输入和输出变量分配描述符。</p>
                     </li>
                     <li>
                        <p>准备声明。</p>
                     </li>
                     <li>
                        <p>描述输入描述符的输入。</p>
                     </li>
                     <li>
                        <p>设置输入描述符（在我们的示例中是一个输入主机绑定变量<code class="codeph">deptno_data)</code> 。
                        </p>
                     </li>
                     <li>
                        <p>声明并打开动态游标。</p>
                     </li>
                     <li>
                        <p>设置输出描述符（在我们的示例中，输出主机变量<code class="codeph">ename</code>和<code class="codeph">empno)</code> 。
                        </p>
                     </li>
                     <li>
                        <p>重复获取数据，使用GET DESCRIPTOR从每行检索<code class="codeph">ename</code>和<code class="codeph">empno</code>数据字段。
                        </p>
                     </li>
                     <li>
                        <p>对检索到的数据执行某些操作（例如，输出它）。</p>
                     </li>
                     <li>
                        <p>关闭动态游标并取消分配输入和输出描述符。</p>
                     </li>
                  </ul>
               </div><a id="LNPCB618"></a><div class="props_rev_3"><a id="GUID-E6165C6C-EA44-4388-B080-13BEC7938601" name="GUID-E6165C6C-EA44-4388-B080-13BEC7938601"></a><h4 id="LNPCB-GUID-E6165C6C-EA44-4388-B080-13BEC7938601" class="sect4"><span class="enumeration_section">10.1.1</span>预编译器选项</h4>
                  <div>
                     <p>通常，如果您使用的是ANSI动态SQL，那么您将编写预编译器的ANSI标准，因此将使用宏命令行选项<code class="codeph">MODE=ANSI</code> 。如果您希望使用此方法并且不希望使用MODE = ANSI，则该功能由微命令行选项控制： <code class="codeph">DYNAMIC=ANSI</code> 。</p>
                     <p>您可以将微预编译器选项DYNAMIC设置为ANSI，或将宏选项MODE设置为ANSI。这会导致DYNAMIC的默认值为ANSI。 DYNAMIC的另一个设置是<code class="codeph">ORACLE</code> 。有关微选项的更多信息，请参阅“宏和微选项”和“ <code class="codeph">DYNAMIC</code> ”。
                     </p>
                     <p>要使用ANSI类型代码，请将预编译器微选项<code class="codeph">TYPE_CODE</code>设置为ANSI，或将宏选项<code class="codeph">MODE</code>设置为<code class="codeph">ANSI</code> 。这会将<code class="codeph">TYPE_CODE</code>的默认设置<code class="codeph">TYPE_CODE</code>为ANSI。要将<code class="codeph">TYPE_CODE</code>设置为<code class="codeph">ANSI</code> ， <code class="codeph">DYNAMIC</code>也必须是<code class="codeph">ANSI</code> 。</p>
                     <p>有关<code class="codeph">ANSI SQL</code>类型的列表，请参阅“ANSI SQL数据类型”。如果希望应用程序可跨数据库平台移植并且尽可能符合<code class="codeph">ANSI</code> ，则将<code class="codeph">ANSI</code>类型与预编译器选项<code class="codeph">TYPE_CODE</code>设置为ANSI。
                     </p>
                     <p>有关更多详细信息，请参见“ <code class="codeph">MODE</code> ”和“ <code class="codeph">TYPE_CODE</code> ”。
                     </p>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="precompiler-options.html#GUID-B8F5D2F9-D077-4CC0-B8A5-0B4CB1D6425D">宏观和微观选择</a></li>
                           <li><a href="precompiler-options.html#GUID-2BD90C22-D39B-471D-BF6C-0CFD927BF8A5">动态</a></li>
                           <li><a href="precompiler-options.html#GUID-976DED3A-3840-48A5-B5A8-35FB91BF2A0D">模式</a></li>
                           <li><a href="precompiler-options.html#GUID-A2017FBB-772E-4272-A4F8-A40A5362C8CE">类型代码</a></li>
                        </ul>
                     </div>
                  </div>
                  
               </div>
            </div><a id="LNPCB620"></a><a id="LNPCB619"></a><div class="props_rev_3"><a id="GUID-C6A4A78D-1914-44CB-B7FC-9A808917F681" name="GUID-C6A4A78D-1914-44CB-B7FC-9A808917F681"></a><h3 id="LNPCB-GUID-C6A4A78D-1914-44CB-B7FC-9A808917F681" class="sect3"><span class="enumeration_section">10.2</span> ANSI SQL语句概述</h3>
               <div>
                  <div class="section">
                     <p>在动态SQL语句中使用描述符区域之前，请先对其进行分配。</p>
                     <p>ALLOCATE DESCRIPTOR语句语法为：</p><pre class="oac_no_warn" dir="ltr">EXEC SQL ALLOCATE DESCRIPTOR [GLOBAL | LOCAL] { <span class="italic">：desc_nam | string_literal</span> } [WITH MAX <span class="italic">{：occurrence</span> |] <span class="italic">numeric_literal}</span> ] END-EXEC。</pre><p>全局描述符可用于程序中的任何模块。只能在分配本地描述符的文件中访问本地描述符。本地是默认值。</p>
                     <p>描述符名称<code class="codeph">desc_nam</code>是主机变量。可以使用字符串文字。
                     </p>
                     <p><code class="codeph">occurrences</code>数是描述符可以容纳的最大绑定变量或列数，默认值为100。
                     </p>
                     <p>当不再需要描述符时，取消分配它以节省内存。</p>
                     <p>解除分配声明是：</p><pre class="oac_no_warn" dir="ltr">EXEC SQL DEALLOCATE DESCRIPTOR [GLOBAL | LOCAL] {： <span class="italic">desc_nam</span> | <span class="italic">string_literal</span> } <span class="italic">     </span> END-EXEC。</pre><p>使用DESCRIBE语句获取有关准备好的SQL语句的信息。DESCRIBE INPUT描述了已准备好的动态语句的绑定变量。DESCRIBE OUTPUT（默认值）可以给出输出列的数量，类型和长度。简化的语法是：</p><pre class="oac_no_warn" dir="ltr">EXEC SQL DESCRIBE [INPUT | OUTPUT] <span class="italic">sql_statement</span>使用[SQL] DESCRIPTOR [GLOBAL | LOCAL] {： <span class="italic">desc_nam</span> | <span class="italic">string_literal</span> } END-EXEC。</pre><p>如果您的SQL语句具有输入和输出值，则必须分配两个描述符：一个用于输入，一个用于输出值。如果没有输入值，例如：</p><pre class="oac_no_warn" dir="ltr">SELECT ename，empno FROM emp</pre><p>那么就不需要输入描述符。</p>
                     <p>使用SET DESCRIPTOR语句指定INSERTS，UPDATES，DELETES和SELECT语句的WHERE子句的输入值。如果尚未对输入描述符进行DESCRIBE，请使用SET DESCRIPTOR设置输入绑定变量的数量（存储在<span class="italic">COUNT中</span> ）：</p><pre class="oac_no_warn" dir="ltr">EXEC SQL SET DESCRIPTOR [GLOBAL | LOCAL] {： <span class="italic">desc_nam</span> | <span class="italic">string_literal</span> } <span class="italic"> </span> COUNT = {： <span class="italic">kount</span> | <span class="italic">numeric_literal</span> } END-EXEC。</pre><p><code class="codeph">kount</code>可以是主变量或数字文字，例如5。对每个主机变量使用SET DESCRIPTOR语句，至少给出变量的数据值：</p><pre class="oac_no_warn" dir="ltr">EXEC SQL SET DESCRIPTOR [GLOBAL | LOCAL] { <span class="italic">：desc_nam</span> | <span class="italic">string_literal</span> } VALUE <span class="italic">item_number</span> DATA =： <span class="italic">hv3</span> <span class="italic">     </span> END-EXEC。</pre><p>您还可以设置输入主机变量的类型和长度：</p>
                     <p><span class="bold">注意：</span>如果未通过SET DESCRIPTOR语句显式设置类型和长度，或者通过执行DESCRIBE OUTPUT隐式设置类型和长度，则在TYPE_CODE = ORACLE时，预编译器将使用从主机变量本身派生的值。当TYPE_CODE = ANSI时，必须使用表10-1中的值设置类型。您还应该设置长度，因为ANSI默认长度可能与主变量的长度不匹配。
                     </p><pre class="oac_no_warn" dir="ltr">EXEC SQL SET DESCRIPTOR [GLOBAL | LOCAL] { <span class="italic">：desc_nam</span> | <span class="italic">string_literal</span> } VALUE <span class="italic">item_number</span> TYPE =： <span class="italic">hv1</span> ，LENGTH =： <span class="italic">hv2</span> ，DATA =： <span class="italic">hv3</span> <span class="italic">     </span> END-EXEC。</pre><p>我们使用标识符<code class="codeph">hv1</code> ， <code class="codeph">hv2</code>和<code class="codeph">hv3</code>来提醒我们必须由主变量提供值。 <span class="italic">item_number</span>是SQL语句中输入变量的位置。它可以是主变量或整数。
                     </p>
                     <p>如果TYPE_CODE设置为ANSI，TYPE是从下表中选择的类型代码：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="tblformal" id="GUID-C6A4A78D-1914-44CB-B7FC-9A808917F681__CDDBDDFB">
                     <p class="titleintable">表10-1 ANSI SQL数据类型</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="ANSI SQL数据类型" width="100%" border="1" summary="q" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="31%" id="d68132e478">数据类型</th>
                              <th align="left" valign="bottom" width="69%" id="d68132e481">类型代码</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d68132e486" headers="d68132e478 ">
                                 <p>字符</p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d68132e486 d68132e481 ">
                                 <p>1</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d68132e493" headers="d68132e478 ">
                                 <p>字符变化</p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d68132e493 d68132e481 ">
                                 <p>12</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d68132e500" headers="d68132e478 ">
                                 <p>日期</p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d68132e500 d68132e481 ">
                                 <p>9</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d68132e507" headers="d68132e478 ">
                                 <p>DECIMAL</p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d68132e507 d68132e481 ">
                                 <p>3</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d68132e514" headers="d68132e478 ">
                                 <p>双精度</p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d68132e514 d68132e481 ">
                                 <p>8</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d68132e521" headers="d68132e478 ">
                                 <p>浮动</p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d68132e521 d68132e481 ">
                                 <p>6</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d68132e528" headers="d68132e478 ">
                                 <p>整数</p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d68132e528 d68132e481 ">
                                 <p>4</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d68132e535" headers="d68132e478 ">
                                 <p>数字</p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d68132e535 d68132e481 ">
                                 <p>2</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d68132e542" headers="d68132e478 ">
                                 <p>真实</p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d68132e542 d68132e481 ">
                                 <p>7</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d68132e549" headers="d68132e478 ">
                                 <p>SMALLINT</p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d68132e549 d68132e481 ">
                                 <p>五</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p>有关Oracle类型代码，请参阅表11-2。如果ANSI数据类型不在表中，则使用Oracle代码的负值，并且TYPE_CODE = ANSI。</p>
                     <p>DATA是输入的主变量值。</p>
                     <p>您还可以设置其他输入值，例如指标，精度和比例。有关所有可能的描述符项名称的列表，请参阅“SET_DESCRIPTOR”的更完整的讨论。</p>
                     <p>SET DESCRIPTOR语句中的数值必须声明为<code class="codeph">PIC S9(9) COMP</code>或<code class="codeph">PIC S9(4) COMP</code>但指示符和返回的长度值除外，您必须声明为<code class="codeph">PIC S9(4)COMP</code> 。</p>
                     <p>在以下示例中，当您要检索empno时，请设置以下值：VALUE = 2，因为<code class="codeph">empno</code>是动态SQL语句中的第二个输出主机变量。主机变量<code class="codeph">EMPNO-TYP</code>设置为3（Oracle类型为整数）。主机整数<code class="codeph">EMPNO-LEN</code>长度设置为4，即主机变量的大小。DATA等同于主机变量EMPNO-DATA，它将从数据库表中接收值。代码片段如下：</p><pre class="oac_no_warn" dir="ltr">...01 DYN-STATEMENT PIC X（58）VALUE“SELECT ename，empno FROM emp WHERE deptno =：deptno_number”。01 EMPNO-DATA PIC S9（9）COMP。 01 EMPNO-TYP PIC S9（9）COMP VALUE 3。01 EMPNO-LEN PIC S9（9）COMP VALUE 4。...EXEC SQL SET DESCRIPTOR'out'VALUE 2 TYPE =：EMPNO-TYP，LENGTH =：EMPNO-LEN，DATA =：EMPNO-DATA END-EXEC。</pre><p>设置输入值后，使用输入描述符执行或打开语句。如果语句中有输出值，请在执行FETCH之前设置它们。如果已完成DESCRIBE OUTPUT，则可能必须重置主机变量的实际类型和长度，因为DESCRIBE执行将生成内部类型和长度，这些类型和长度与主机变量外部类型和长度不同。</p>
                     <p>在输出描述符的FETCH之后，使用GET DESCRIPTOR访问返回的数据。我们再次在本章后面展示了一个简化的语法及详细信息：</p><pre class="oac_no_warn" dir="ltr">EXEC SQL GET DESCRIPTOR [GLOBAL | LOCAL] { <span class="italic">：desc_nam | string_literal</span> } VALUE <span class="italic">item_number</span> <span class="italic">        </span> ： <span class="italic">hv1</span> = DATA，： <span class="italic">hv2</span> = INDICATOR，： <span class="italic">hv3</span> = RETURNED_LENGTH END-EXEC。</pre><p><code class="codeph">desc_nam</code>和<code class="codeph">item_number</code>可以是文字或主变量。描述符名称可以是文字，例如“out”。项目编号可以是数字文字，例如2。
                     </p>
                     <p><code class="codeph">hv1, hv2, and hv3</code>是主变量。它们必须是主变量，而不是文字。示例中只显示了三个。有关可以获得的所有可能返回数据项的列表，请参阅表10-4。
                     </p>
                     <p>使用<code class="codeph">PIC S9(n) COMP</code> ，其中n是平台相关的上限， <code class="codeph">PIC S9(9)COMP</code>或<code class="codeph">PIC S9(4)COMP</code>用于所有数值，指示符和返回的长度变量除外，它们必须是<code class="codeph">PIC S9(4) COMP</code> 。</p>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="ANSI-dynamic-SQL.html#GUID-180E79CB-4D44-4A81-808A-7353715B176A">设置描述符</a></li>
                     </ul>
                  </div>
               </div>
               
            </div><a id="LNPCB621"></a><div class="props_rev_3"><a id="GUID-5AE6524C-F343-4ABD-A1C8-3452F2889000" name="GUID-5AE6524C-F343-4ABD-A1C8-3452F2889000"></a><h3 id="LNPCB-GUID-5AE6524C-F343-4ABD-A1C8-3452F2889000" class="sect3"><span class="enumeration_section">10.3</span>示例代码</h3>
               <div>
                  <p>以下示例演示了ANSI Dynamic SQL的用法。它分配一个输入描述符<code class="codeph">in</code>和输出描述<code class="codeph">out</code>执行SELECT语句。输入值通过SET DESCRIPTOR语句设置。将打开并获取游标，并通过GET DESCRIPTOR语句检索生成的输出值。
                  </p><pre class="oac_no_warn" dir="ltr">...01 DYN-STATEMENT PIC X（58）值“选择ENAME，EMPNO从EMP到DEPTNO =：DEPTNO-DAT”。01 EMPNO-DAT PIC S9（9）COMP。 01 EMPNO-TYP PIC S9（9）COMP VALUE 3。01 EMPNO-LEN PIC S9（9）COMP VALUE 4。01 DEPTNO-TYP PIC S9（9）COMP VALUE 3。01 DEPTNO-LEN PIC S9（9）COMP VALUE 4。01 DEPTNO-DAT PIC S9（9）COMP值10。01 ENAME-TYP PIC S9（9）COMP VALUE 3。01 ENAME-LEN PIC S9（9）COMP VALUE 30。01 ENAME-DAT PIC X（30）。01 SQLCODE PIC S9（9）COMP VALUE 0。...*在这里放置初步代码，包括连接...执行SQL ALLOCATE DESCRIPTOR'在'END-EXEC。 EXEC SQL ALLOCATE DESCRIPTOR'out'END-EXEC。 EXEC SQL PREPARE s FROM：DYN-STATEMENT END-EXEC。执行SQL描述输入在'END-EXEC中使用DESCRIPTOR'。 EXEC SQL SET DESCRIPTOR'在'VALUE 1 TYPE =：DEPTNO-TYP，LENGTH =：DEPTNO-LEN，DATA =：DEPTNO-DAT END-EXEC。 EXEC SQL DECLARE c CURSOR FOR END-EXEC。 EXEC SQL OPEN使用DESCRIPTOR'在'END-EXEC中。 EXEC SQL DESCRIBE OUTPUT使用DESCRIPTOR'out'END-EXEC。 EXEC SQL SET DESCRIPTOR'out'VALUE 1 TYPE =：ENAME-TYP，LENGTH =：ENAME-LEN，DATA =：ENAME-DAT END-EXEC。 EXEC SQL SET DESCRIPTOR'out'VALUE 2 TYPE =：EMPNO-TYP，LENGTH =：EMPNO-LEN，DATA =：EMPNO-DAT END-EXEC。 EXEC SQL WHENEVER未找到GOTO BREAK END-EXEC。环。如果SQLCODE NOT = 0 GOTO BREAK。 EXEC SQL FETCH c INTO DESCRIPTOR'out'END-EXEC。 EXEC SQL获取描述符'OUT'值1：ENAME-DAT = DATA END-EXEC。 EXEC SQL GET DESCRIPTOR'OUT'值2：EMPNO-DAT = DATA END-EXEC。显示“ENAME =”没有高级显示ENAME-DAT没有高级显示“EMPNO =”没有高级显示EMPNO-DAT。 GOTO LOOP。 BREAK：EXEC SQL CLOSE c END-EXEC。执行SQL DEALLOCATE DESCRIPTOR'在'END-EXEC中。 EXEC SQL DEALLOCATE DESCRIPTOR'out'END-EXEC。</pre></div>
            </div><a id="LNPCB622"></a><div class="props_rev_3"><a id="GUID-A68A8D42-8AB5-4EDF-B4FA-D57C95967D8E" name="GUID-A68A8D42-8AB5-4EDF-B4FA-D57C95967D8E"></a><h3 id="LNPCB-GUID-A68A8D42-8AB5-4EDF-B4FA-D57C95967D8E" class="sect3"><span class="enumeration_section">10.4</span> Oracle扩展</h3>
               <div>
                  <p>接下来将介绍这些扩展：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>SET语句中数据项的引用语义。</p>
                     </li>
                     <li>
                        <p>用于批量操作的数组。</p>
                     </li>
                     <li>
                        <p>支持对象类型，NCHAR列和LOB。</p>
                     </li>
                  </ul>
               </div><a id="LNPCB623"></a><div class="props_rev_3"><a id="GUID-2CF30CC9-3F6A-4A05-A9D3-2849FF35AEBF" name="GUID-2CF30CC9-3F6A-4A05-A9D3-2849FF35AEBF"></a><h4 id="LNPCB-GUID-2CF30CC9-3F6A-4A05-A9D3-2849FF35AEBF" class="sect4"><span class="enumeration_section">10.4.1</span>参考语义</h4>
                  <div>
                     <div class="section">
                        <p>ANSI标准指定了<span class="italic">值</span>语义。为了提高性能，Oracle已将此标准扩展为包含<span class="italic">引用</span>语义。
                        </p>
                        <p>值语义可以复制主变量数据。引用语义使用主机变量的地址，避免复制。因此，引用语义可以为大量数据提供性能改进。</p>
                        <p>要帮助加快提取速度，请在数据子句之前使用REF关键字：</p><pre class="oac_no_warn" dir="ltr">EXEC SQL SET DESCRIPTOR'out'VALUE 1 TYPE =：ENAME-TYP，LENGTH =：ENAME-LEN，REF DATA =：ENAME-DAT END-EXEC。 EXEC SQL DESCRIPTOR'out'VALUE 2 TYPE =：EMPNO-TYP，LENGTH =：EMPNO-LEN，REF DATA =：EMPNO-DAT END-EXEC。</pre><p>然后主机变量接收检索结果。不需要GET声明。在每个FETCH之后，检索到的数据直接写入<code class="codeph">ename_data</code>和<code class="codeph">empno_data</code> 。</p>
                        <p><span class="italic">仅</span>在DATA，INDICATOR和RETURNED_LENGTH项之前允许使用REF关键字（这可以随着每一行获取而变化），如此代码片段中所示：</p><pre class="oac_no_warn" dir="ltr">01 INDI PIC S9（4）COMP。 01 RETRN-LEN PIC S9（9）COMP。 ...EXEC SQL SET DESCRIPTOR'out'VALUE 1 TYPE =：ENAME-TYP，LENGTH =：ENAME-LEN，REF DATA =：ENAME-DAT，REF INDICATOR =：INDI，REF RETURNED_LENGTH =：RETRN-LEN END-EXEC。</pre><p>每次获取后， <code class="codeph">RETRN-LEN</code>保存实际检索到的<code class="codeph">ename</code>字段长度，这对<code class="codeph">CHAR</code>或<code class="codeph">VARCHAR2</code>数据很有用。
                        </p>
                        <p><code class="codeph">ENAME-LEN</code>将不会收到返回的长度。FETCH语句不会更改它。使用DESCRIBE语句，然后使用GET语句在获取数据行之前找出最大列宽。
                        </p>
                        <p>REF关键字也用于其他类型的SQL语句而不是SELECT，以加快它们的速度。请注意，使用引用语义时，将使用主机变量而不是复制到描述符区域中的值。使用执行SQL语句时的主变量数据，而不是SET时的数据。这是一个例子：</p><pre class="oac_no_warn" dir="ltr">...移动1到VAL。 ...EXEC SQL SET DESCRIPTOR'value'VALUE 1 DATA =：VAL END-EXEC。 EXEC SQL SET DESCRIPTOR'引用'VALUE 1 REF DATA =：VAL END-EXEC。移动2到VAL。 *将使用VAL = 1 EXEC SQL EXECUTE s使用DESCRIPTOR'值'END-EXEC。 *将使用VAL = 2 EXEC SQL EXECUTE s使用DESCRIPTOR'参考'END-EXEC。</pre><p>有关差异的更多详细信息，请参阅“SET_DESCRIPTOR”。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="ANSI-dynamic-SQL.html#GUID-180E79CB-4D44-4A81-808A-7353715B176A">设置描述符</a></li>
                        </ul>
                     </div>
                  </div>
                  
               </div><a id="LNPCB624"></a><div class="props_rev_3"><a id="GUID-88BE9B20-8BF1-42AA-84CA-9B46D6562B6F" name="GUID-88BE9B20-8BF1-42AA-84CA-9B46D6562B6F"></a><h4 id="LNPCB-GUID-88BE9B20-8BF1-42AA-84CA-9B46D6562B6F" class="sect4"><span class="enumeration_section">10.4.2</span>使用表进行批量操作</h4>
                  <div>
                     <div class="section">
                        <p>Oracle的ANSI动态SQL实现通过提供批量操作扩展了SQL标准的动态SQL。要使用批量操作，请使用带有数组大小的<code class="codeph">FOR</code>子句指定输入数据量或要处理的行数。
                        </p>
                        <p><code class="codeph">FOR</code>子句在ALLOCATE语句中用于提供最大数据量或行数。例如，要使用最大数组大小100：</p><pre class="oac_no_warn" dir="ltr">EXEC SQL FOR 100 ALLOCATE DESCRIPTOR'out'END-EXEC。</pre><p>要么：</p><pre class="oac_no_warn" dir="ltr">移动100到INT-ARR-SIZE。 EXEC SQL FOR：INT-ARR-SIZE ALLOCATE DESCRIPTOR'out'END-EXEC。</pre><p>然后在访问描述符的后续语句中使用<code class="codeph">FOR</code>子句。在输出描述符中，FETCH语句的数组大小必须等于或小于ALLOCATE语句中已使用的数组大小：</p><pre class="oac_no_warn" dir="ltr">EXEC SQL for 20 FETCH c1使用DESCRIPTOR'out'END-EXEC。</pre><p>获取DATA，INDICATOR或RETURNED_LENGTH值的同一描述符的后续GET语句必须使用与FETCH语句相同的数组大小。</p><pre class="oac_no_warn" dir="ltr">01 VAL-DATA发生20次PIC S9（9）COMP。 01 VAL-INDI发生20次PIC S9（4）COMP。 ...EXEC SQL for 20 GET DESCRIPTOR'out'VALUE 1：VAL-DATA = DATA，：VAL-INDI = INDICATOR END-EXEC。</pre><p>但是，引用其他不同行的项的GET语句（如LENGTH，TYPE和COUNT） <span class="italic">不得</span>使用<code class="codeph">FOR</code>子句：</p><pre class="oac_no_warn" dir="ltr">01 CNT PIC S9（9）COMP。 01 LEN PIC S9（9）COMP。 ...EXEC SQL GET DESCRIPTOR'out'：CNT = COUNT END-EXEC。 EXEC SQL GET DESCRIPTOR'out'VALUE 1：LEN = LENGTH END-EXEC。</pre><p>具有引用语义的SET语句也是如此。在FETCH之前并使用DATA，INDICATOR或RETURNED_LENGTH的引用语义的SET语句必须与FETCH具有相同的数组大小：</p><pre class="oac_no_warn" dir="ltr">...01 REF-DATA OCCURS 20次PIC S9（9）COMP。 01 REF-INDI发生20次PIC S9（4）COMP。 ...EXEC SQL FOR 20 SET DESCRIPTOR'out'VALUE 1 REF DATA =：REF-DATA，REF INDICATOR =：REF-INDI END-EXEC。</pre><p>同样，对于用于输入的描述符，例如，要插入一批行，EXECUTE或OPEN语句必须使用等于或小于ALLOCATE语句中使用的大小的数组大小。对于值和参考语义，访问DATA，INDICATOR或RETURNED_LENGTH的SET语句必须使用与EXECUTE语句中相同的数组大小。</p>
                        <p>FOR子句从不在DEALLOCATE或PREPARE语句中使用。</p>
                        <p>以下代码示例说明了没有输出描述符的批量操作（没有输出，只有要插入表<code class="codeph">emp</code>输入）。<code class="codeph">CNT</code>值为2（INSERT语句中有两个主变量， <code class="codeph">ENAME and EMPNO</code> ）。数据表<code class="codeph">ENAME-TABLE</code>按顺序包含三个字符串： <code class="codeph">Tom</code> ， <code class="codeph">Dick</code>和<code class="codeph">Harry</code> 。他们的员工编号在表<code class="codeph">EMPNO-TABLE</code> 。对于第二个元素，指标表<code class="codeph">ENAME-IND</code>的值为-1;因此将插入<code class="codeph">NULL</code>而不是<code class="codeph">Dick</code> 。
                        </p><pre class="oac_no_warn" dir="ltr">01 DYN-STATEMENT PIC X（240）值“INSERT INTO EMP（ENAME，EMPNO）VALUES（：ENAME，：EMPNO）”。01 ARRAY-SIZE PIC S9（9）COMP VALUE 3。01 ENAME-VALUES。 05 FILLER PIC X（6）价值“汤姆”。05 FILLER PIC X（6）价值“迪克”。05 FILLER PIC X（6）价值“哈利”。01 ENAME-TABLE重新定义了ENAME-VALUES。 05 ENAME PIC X（6）发生3次。 01 ENAME-IND PIC S9（4）COMPOCCURS 3次。 01 ENAME-LEN PIC S9（9）COMP VALUE 6。01 ENAME-TYP PIC S9（9）COMP值96。01 EMPNO-VALUES。 05 FILLER PIC S9（9）COMP VALUE 8001。05 FILLER PIC S9（9）COMP VALUE 8002。05 FILLER PIC S9（9）COMP VALUE 8003。01 EMPNO-TABLE重新定义了EMPNO-VALUES。 05 EMPNO PIC S9（9）显示标志领先3次。 01 EMPNO-LEN PIC S9（9）COMP VALUE 4。01 EMPNO-TYP PIC S9（9）COMP VALUE 3。01 CNT PIC S9（9）COMP VALUE 2。........EXEC SQL FOR：ARRAY-SIZE ALLOCATE DESCRIPTOR'在'END-EXEC中。EXEC SQL PREPARE S FROM：DYN-STATEMENT END-EXEC。移动0到ENAME-IND（1）。移动-1到ENAME-IND（2）。移动0到ENAME-IND（3）。EXEC SQL SET DESCRIPTOR'在'COUNT =：CNT END-EXEC。 EXEC SQL SET DESCRIPTOR'在'VALUE 1 TYPE =：ENAME-TYP，LENGTH =：ENAME-LEN END-EXEC。 EXEC SQL FOR：ARRAY-SIZE SET DESCRIPTOR'在'VALUE 1 DATA =：ENAME，INDICATOR =：ENAME-IND END-EXEC。 EXEC SQL SET DESCRIPTOR'在'VALUE 2 TYPE =：EMPNO-TYP，LENGTH =：EMPNO-LEN END-EXEC。 EXEC SQL FOR：ARRAY-SIZE SET DESCRIPTOR'in'VALUE 2 DATA =：EMPNO END-EXEC。 EXEC SQL FOR：ARRAY-SIZE EXECUTE S使用DESCRIPTOR'in'END-EXEC。 ...
</pre><p>上面的代码将这些值插入表中：</p><pre class="oac_no_warn" dir="ltr">EMPNO ENAME 8001 Tom 8002 8003 Harry</pre><p>有关限制和注意事项，请参阅“FOR FOR Clause”中的讨论。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="host-tables.html#GUID-81265F69-2532-4014-A048-BF0739CC8486">FOR条款</a></li>
                        </ul>
                     </div>
                  </div>
                  
               </div>
            </div><a id="LNPCB626"></a><a id="LNPCB627"></a><a id="LNPCB625"></a><div class="props_rev_3"><a id="GUID-696564A9-7206-4D4A-B78E-4A1375659239" name="GUID-696564A9-7206-4D4A-B78E-4A1375659239"></a><h3 id="LNPCB-GUID-696564A9-7206-4D4A-B78E-4A1375659239" class="sect3"><span class="enumeration_section">10.5</span> ANSI动态SQL预编译器选项</h3>
               <div>
                  <div class="section">
                     <p><a id="d68132e975" class="indexterm-anchor"></a>宏选项MODE（参见“MODE”）设置ANSI兼容性特性并控制许多功能。它可以具有值ANSI或ORACLE。对于单个功能，有微量选项可以覆盖MODE设置。
                     </p>
                     <p><a id="d68132e981" class="indexterm-anchor"></a><a id="d68132e985" class="indexterm-anchor"></a>预编译器微选项<span class="italic">DYNAMIC</span>指定动态SQL中的描述符行为。预编译器微选项<span class="italic">TYPE_CODE</span>指定是使用ANSI还是Oracle数据类型代码。
                     </p>
                     <p>当宏选项MODE设置为ANSI时，微选项DYNAMIC自动变为ANSI。当MODE设置为ORACLE时，DYNAMIC变为ORACLE。</p>
                     <p>DYNAMIC和TYPE_CODE不能内联使用。</p>
                     <p>下表描述了如何<a id="d68132e1002" class="indexterm-anchor"></a> DYNAMIC设置会影响各种功能：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="tblformal" id="GUID-696564A9-7206-4D4A-B78E-4A1375659239__GUID-71822BAF-1401-4568-8C9B-E9D152E2C927">
                     <p class="titleintable">表10-2 DYNAMIC选项设置</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="DYNAMIC选项设置" width="100%" border="1" summary="q" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="26%" id="d68132e1018">功能</th>
                              <th align="left" valign="bottom" width="31%" id="d68132e1021">DYNAMIC = ANSI</th>
                              <th align="left" valign="bottom" width="44%" id="d68132e1024">DYNAMIC = ORACLE</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="26%" id="d68132e1029" headers="d68132e1018 ">
                                 <p>描述符创建。</p>
                              </td>
                              <td align="left" valign="top" width="31%" headers="d68132e1029 d68132e1021 ">
                                 <p>必须使用ALLOCATE语句。</p>
                              </td>
                              <td align="left" valign="top" width="44%" headers="d68132e1029 d68132e1024 ">
                                 <p>必须使用Oracle格式描述符。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="26%" id="d68132e1039" headers="d68132e1018 ">
                                 <p>描述符破坏。</p>
                              </td>
                              <td align="left" valign="top" width="31%" headers="d68132e1039 d68132e1021 ">
                                 <p>可以使用DEALLOCATE语句。</p>
                              </td>
                              <td align="left" valign="top" width="44%" headers="d68132e1039 d68132e1024 ">
                                 <p>N / A</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="26%" id="d68132e1049" headers="d68132e1018 ">
                                 <p>检索数据。</p>
                              </td>
                              <td align="left" valign="top" width="31%" headers="d68132e1049 d68132e1021 ">
                                 <p>可以使用FETCH和GET语句。</p>
                              </td>
                              <td align="left" valign="top" width="44%" headers="d68132e1049 d68132e1024 ">
                                 <p>必须只使用FETCH语句。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="26%" id="d68132e1059" headers="d68132e1018 ">
                                 <p>设置输入数据。</p>
                              </td>
                              <td align="left" valign="top" width="31%" headers="d68132e1059 d68132e1021 ">
                                 <p>可以使用DESCRIBE INPUT语句。必须使用SET语句。</p>
                              </td>
                              <td align="left" valign="top" width="44%" headers="d68132e1059 d68132e1024 ">
                                 <p>必须在代码中设置描述符值。必须使用DESCRIBE BIND VARIABLES语句。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="26%" id="d68132e1069" headers="d68132e1018 ">
                                 <p>描述符表示。</p>
                              </td>
                              <td align="left" valign="top" width="31%" headers="d68132e1069 d68132e1021 ">
                                 <p>单引号文字或包含描述符名称的主机标识符。</p>
                              </td>
                              <td align="left" valign="top" width="44%" headers="d68132e1069 d68132e1024 ">
                                 <p>主机变量，指向SQLDA的指针。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="26%" id="d68132e1079" headers="d68132e1018 ">
                                 <p>可用的数据类型。</p>
                              </td>
                              <td align="left" valign="top" width="31%" headers="d68132e1079 d68132e1021 ">
                                 <p>除BIT和所有Oracle类型之外的所有ANSI类型。</p>
                              </td>
                              <td align="left" valign="top" width="44%" headers="d68132e1079 d68132e1024 ">
                                 <p>除了对象，LOB和游标变量之外的Oracle类型。</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p>微型选项TYPE_CODE由预编译器设置为与宏选项MODE相同的设置。如果DYNAMIC等于ANSI，TYPE_CODE只能等于ANSI。</p>
                     <p><a id="d68132e1092" class="indexterm-anchor"></a>下表显示了与TYPE_CODE设置对应的功能。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="tblformal" id="GUID-696564A9-7206-4D4A-B78E-4A1375659239__G1016234">
                     <p class="titleintable">表10-3 TYPE_CODE选项设置</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="TYPE_CODE选项设置" width="100%" border="1" summary="q" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="31%" id="d68132e1108">功能</th>
                              <th align="left" valign="bottom" width="34%" id="d68132e1111">类型代码= ANSI</th>
                              <th align="left" valign="bottom" width="35%" id="d68132e1114">类型代码= ORACLE</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d68132e1119" headers="d68132e1108 ">
                                 <p>在动态SQL中输入和返回的数据类型代码编号。</p>
                              </td>
                              <td align="left" valign="top" width="34%" headers="d68132e1119 d68132e1111 ">
                                 <p>当ANSI类型存在时，使用ANSI代码。否则，请使用Oracle代码编号的否定值。</p>
                                 <p>仅在DYNAMIC = ANSI时有效。</p>
                              </td>
                              <td align="left" valign="top" width="35%" headers="d68132e1119 d68132e1114 ">
                                 <p>使用Oracle代码。</p>
                                 <p>无论DYNAMIC的设置如何，都可以使用。</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="precompiler-options.html#GUID-976DED3A-3840-48A5-B5A8-35FB91BF2A0D">模式</a></li>
                     </ul>
                  </div>
               </div>
               
            </div><a id="LNPCB628"></a><div class="props_rev_3"><a id="GUID-BF9199DA-04C3-48C1-B055-7682C13D2BE8" name="GUID-BF9199DA-04C3-48C1-B055-7682C13D2BE8"></a><h3 id="LNPCB-GUID-BF9199DA-04C3-48C1-B055-7682C13D2BE8" class="sect3"><span class="enumeration_section">10.6</span>动态SQL语句的完整语法</h3>
               <div>
                  <div class="section">
                     <p>有关所有这些语句的更多详细信息，请参阅附录“嵌入式SQL语句和预编译器指令”中的字母顺序列表。</p>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="embedded-SQL-statements-and-precompiler-directives.html#GUID-F5251483-48EC-4B39-8E14-68F65480B16B">嵌入式SQL语句和预编译器指令</a></li>
                     </ul>
                  </div>
               </div>
               <a id="LNPCB630"></a><a id="LNPCB631"></a><a id="LNPCB629"></a><div class="props_rev_3"><a id="GUID-74B34D46-6D98-44AB-A2E8-3E7A31F07E8A" name="GUID-74B34D46-6D98-44AB-A2E8-3E7A31F07E8A"></a><h4 id="LNPCB-GUID-74B34D46-6D98-44AB-A2E8-3E7A31F07E8A" class="sect4"><span class="enumeration_section">10.6.1</span>分配描述符</h4>
                  <div>
                     <div class="section">
                        <p>此语句仅用于ANSI动态SQL。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-74B34D46-6D98-44AB-A2E8-3E7A31F07E8A__GUID-041A3C6D-8F2C-453E-AC44-EFE35C857849">目的</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>使用此语句分配SQL描述符区域。提供描述符，主机绑定项的最大出现次数以及数组大小。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-74B34D46-6D98-44AB-A2E8-3E7A31F07E8A__GUID-8B51CA05-1EB8-4348-8296-9F23FA4BA964">句法</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">EXEC SQL [FOR [：] array_size] ALLOCATE DESCRIPTOR [GLOBAL | LOCAL] {：desc_nam | string_literal} [WITH MAX occurrence] END-EXEC。</pre></div>
                     <!-- class="section" -->
                  </div><a id="LNPCB632"></a><div class="props_rev_3"><a id="GUID-64F0C92F-0F19-4554-AD64-C61DEF697DFF" name="GUID-64F0C92F-0F19-4554-AD64-C61DEF697DFF"></a><h5 id="LNPCB-GUID-64F0C92F-0F19-4554-AD64-C61DEF697DFF" class="sect5"><span class="enumeration_section">10.6.1.1</span>变量</h5>
                     <div>
                        <div class="section">
                           <p>许多变量可以与ALLOCATE描述符一起使用。这些包括：array_size，desc_nam和occurrence。</p>
                           <dl>
                              <dt class="dlterm"><a name="GUID-64F0C92F-0F19-4554-AD64-C61DEF697DFF__GUID-53249AC6-E895-426E-BA91-F074E67F0E0A"><!-- --></a> array_size</dt>
                              <dd>
                                 <p>可选的array_size子句（Oracle扩展）支持表处理。它告诉预编译器描述符可用于表处理。</p><pre class="oac_no_warn" dir="ltr">全球|本地</pre><p>如果未输入，则可选范围子句默认为LOCAL。只能在分配本地描述符的文件中访问本地描述符。全局描述符可以在编译单元的任何模块中使用。</p>
                              </dd>
                              <dt class="dlterm"><a name="GUID-64F0C92F-0F19-4554-AD64-C61DEF697DFF__GUID-25969DA4-4014-4370-A8E6-026E1C7F3FC8"><!-- --></a> desc_nam</dt>
                              <dd>
                                 <p>desc_nam变量定义了模块中必须唯一的本地描述符。如果先前已分配描述符但未解除分配，则会生成运行时错误。全局描述符对于应用程序或运行时错误结果必须是唯一的。</p>
                              </dd>
                              <dt class="dlterm"><a name="GUID-64F0C92F-0F19-4554-AD64-C61DEF697DFF__GUID-E5E67886-5E2A-4847-8E29-8494B5005073"><!-- --></a>次发生</dt>
                              <dd>
                                 <p>可选的occurrences子句是描述符中可能的最大主机变量数。occurrence变量必须是0到64K之间的整数常量，否则返回错误。默认值为100。如果预编译器不符合这些规则，则会导致错误。</p>
                              </dd>
                           </dl>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="LNPCB633"></a><div class="props_rev_3"><a id="GUID-F762CFB0-8B2B-4DE4-A87F-29153F3EF882" name="GUID-F762CFB0-8B2B-4DE4-A87F-29153F3EF882"></a><h5 id="LNPCB-GUID-F762CFB0-8B2B-4DE4-A87F-29153F3EF882" class="sect5"><span class="enumeration_section">10.6.1.2</span>例子</h5>
                     <div><pre class="oac_no_warn" dir="ltr">使用MAX 50 END-EXEC执行SQL ALLOCATE DESCRIPTOR'SELDES'。 EXEC SQL FOR：BATCH ALLOCATE DESCRIPTOR GLOBAL：BINDDES MAX 25 END-EXEC。</pre></div>
                  </div>
               </div><a id="LNPCB635"></a><a id="LNPCB636"></a><a id="LNPCB637"></a><a id="LNPCB638"></a><a id="LNPCB634"></a><div class="props_rev_3"><a id="GUID-606A2B8D-0E34-486A-8595-4556693EEFD5" name="GUID-606A2B8D-0E34-486A-8595-4556693EEFD5"></a><h4 id="LNPCB-GUID-606A2B8D-0E34-486A-8595-4556693EEFD5" class="sect4"><span class="enumeration_section">10.6.2</span> DEALLOCATE DESCRIPTOR</h4>
                  <div>
                     <div class="section">
                        <p class="subhead3" id="GUID-606A2B8D-0E34-486A-8595-4556693EEFD5__GUID-FB9F32B9-CD1C-41DF-B830-B1D1E81C2926">目的</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>要释放内存，请使用deallocate语句。此语句释放先前分配的SQL描述符区域。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-606A2B8D-0E34-486A-8595-4556693EEFD5__GUID-7FE48556-4A8B-4207-8E5C-49DF6D31A897">句法</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">EXEC SQL DEALLOCATE DESCRIPTOR [GLOBAL | LOCAL] { <span class="italic">：desc_nam</span> | <span class="italic">string_literal</span> } END-EXEC。</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-606A2B8D-0E34-486A-8595-4556693EEFD5__GUID-1C133685-3386-4C5D-B3B6-7A94B32BAA5E">变量</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <dl>
                           <dt class="dlterm"><a name="GUID-606A2B8D-0E34-486A-8595-4556693EEFD5__GUID-D5EF62E7-E530-410E-AB4C-55BD3A8E7C88"><!-- --></a> desc_nam</dt>
                           <dd>
                              <p>deallocate描述符唯一可用的变量是desc_nam（用于描述符名称。）如果尚未分配具有相同名称和范围的描述符，或者已分配和取消分配，则会产生运行时错误。</p>
                           </dd>
                        </dl>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-606A2B8D-0E34-486A-8595-4556693EEFD5__GUID-6FD4605F-FB3D-4F7F-8CFD-678B2C426D84">例子</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">EXEC SQL DEALLOCATE DESCRIPTOR GLOBAL'SELDES'END-EXEC。 EXEC SQL DEALLOCATE DESCRIPTOR：BINDDES END-EXEC。</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="LNPCB640"></a><a id="LNPCB641"></a><a id="LNPCB642"></a><a id="LNPCB643"></a><a id="LNPCB644"></a><a id="LNPCB645"></a><a id="LNPCB646"></a><a id="LNPCB647"></a><a id="LNPCB639"></a><div class="props_rev_3"><a id="GUID-5572BF6D-CC71-42BF-B4F9-77F29D99D3E8" name="GUID-5572BF6D-CC71-42BF-B4F9-77F29D99D3E8"></a><h4 id="LNPCB-GUID-5572BF6D-CC71-42BF-B4F9-77F29D99D3E8" class="sect4"><span class="enumeration_section">10.6.3</span>获取描述<span class="enumeration_section">符</span></h4>
                  <div>
                     <div class="section">
                        <p class="subhead3" id="GUID-5572BF6D-CC71-42BF-B4F9-77F29D99D3E8__GUID-93CE6528-7E78-45F9-BA7A-3DA1730CB66D">目的</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>用于从SQL描述符区域获取信息。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-5572BF6D-CC71-42BF-B4F9-77F29D99D3E8__GUID-FAE28D06-E5FD-4069-9B7B-5140DCEA4FC3">句法</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">EXEC SQL [FOR [：] <span class="italic">array_size</span> ]获取DESCRIPTOR [GLOBAL |本地] <span class="italic">   </span> { <span class="italic">：desc_nam</span> | <span class="italic">string_literal</span> } {： <span class="italic">hv0</span> = COUNT | VALUE <span class="italic">item_number</span> ： <span class="italic">hv1</span> = <span class="italic">item_name1</span> [{，： <span class="italic">hvN</span> = <span class="italic">item_nameN</span> }]} END-EXEC。</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-5572BF6D-CC71-42BF-B4F9-77F29D99D3E8__GUID-CA805249-06E1-4205-B84A-4403F48706D0">变量</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <dl>
                           <dt class="dlterm"><a name="GUID-5572BF6D-CC71-42BF-B4F9-77F29D99D3E8__GUID-E19C8BDA-D025-48EC-8044-A6DF8A5160F9"><!-- --></a> array_size</dt>
                           <dd>
                              <p><code class="codeph">FOR array_size</code>变量是可选的Oracle扩展。 <code class="codeph"> FOR array_size</code>必须等于FETCH语句中的<code class="codeph">array_size</code>字段。
                              </p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-5572BF6D-CC71-42BF-B4F9-77F29D99D3E8__GUID-290C9798-435A-4F72-8041-8100DFA846F3"><!-- --></a> desc_nam</dt>
                           <dd>
                              <p>描述符名称。</p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-5572BF6D-CC71-42BF-B4F9-77F29D99D3E8__GUID-1FFDF537-9791-4EFC-B32E-1CE5D1BD57AD"><!-- --></a> GLOBAL |本地</dt>
                           <dd>
                              <p>GLOBAL表示所有程序文件都知道描述符名称。LOCAL表示仅在分配它的文件中知道它。LOCAL是默认值。</p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-5572BF6D-CC71-42BF-B4F9-77F29D99D3E8__GUID-1563DE43-953A-4DF1-BDA4-A6F18351BB1D"><!-- --></a> COUNT</dt>
                           <dd>
                              <p>绑定变量的总数。</p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-5572BF6D-CC71-42BF-B4F9-77F29D99D3E8__GUID-5F5456DD-B702-4400-AB16-8DF92DEDB7E6"><!-- --></a> VALUE item_number</dt>
                           <dd>
                              <p>项目在SQL语句中的位置。 <code class="codeph">item_number</code>可以是变量或常量。如果<code class="codeph">item_number</code>大于<code class="codeph">COUNT</code> ，则返回“未找到数据”条件。 <code class="codeph">item_number</code>必须大于0。
                              </p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-5572BF6D-CC71-42BF-B4F9-77F29D99D3E8__GUID-05E4B948-8574-4370-9C75-3A324CDC3BA5"><!-- --></a> hv1 .. hvN</dt>
                           <dd>
                              <p>这些是传输值的主变量。</p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-5572BF6D-CC71-42BF-B4F9-77F29D99D3E8__GUID-0D3A963E-8D87-4748-A798-7E4CD97F0A90"><!-- --></a> item_name1 .. item_nameN</dt>
                           <dd>
                              <p>描述符项名称对应于主变量。可能的ANSI描述符项名称<code class="codeph"> </code>列于下表中。
                              </p>
                           </dd>
                        </dl>
                     </div>
                     <!-- class="section" -->
                     <div class="tblformal" id="GUID-5572BF6D-CC71-42BF-B4F9-77F29D99D3E8__G1028984">
                        <p class="titleintable">表10-4描述符项名称的定义</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="描述符项目名称的定义" width="100%" border="1" summary="q" frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="31%" id="d68132e1521">描述符项目名称</th>
                                 <th align="left" valign="bottom" width="69%" id="d68132e1525">含义</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d68132e1531" headers="d68132e1521 ">
                                    <p><code class="codeph">类型</code></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d68132e1531 d68132e1525 ">
                                    <p>有关ANSI类型代码，请参见表10-1。有关Oracle类型代码，请参阅表11-2。如果ANSI数据类型不在表中，则使用Oracle代码的负值，并且TYPE_CODE = ANSI。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d68132e1539" headers="d68132e1521 ">
                                    <p><code class="codeph">长度</code></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d68132e1539 d68132e1525 ">
                                    <p>列中的数据长度。在NCHAR的字符中，否则以字节为单位。由DESCRIBE OUTPUT设置。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d68132e1547" headers="d68132e1521 ">
                                    <p><code class="codeph">OCTET_LENGTH</code></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d68132e1547 d68132e1525 ">
                                    <p>以字节为单位的数据长度。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d68132e1555" headers="d68132e1521 ">
                                    <p><code class="codeph">RETURNED_LENGTH</code></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d68132e1555 d68132e1525 ">
                                    <p>FETCH后的实际数据长度。对于固定长度的字符类型，它是未定义的。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d68132e1563" headers="d68132e1521 ">
                                    <p><code class="codeph">RETURNED_OCTET_LENGTH</code></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d68132e1563 d68132e1525 ">
                                    <p>返回数据的长度，以字节为单位。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d68132e1571" headers="d68132e1521 ">
                                    <p><code class="codeph">精确</code></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d68132e1571 d68132e1525 ">
                                    <p>位数。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d68132e1579" headers="d68132e1521 ">
                                    <p><code class="codeph">规模</code></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d68132e1579 d68132e1525 ">
                                    <p>对于精确数字类型，小数点右侧的位数。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d68132e1587" headers="d68132e1521 ">
                                    <p><code class="codeph">NULLABLE</code></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d68132e1587 d68132e1525 ">
                                    <p>如果为1，则列可以具有NULL值。如果为0，则列不能具有NULL值。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d68132e1595" headers="d68132e1521 ">
                                    <p><code class="codeph">指示符</code></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d68132e1595 d68132e1525 ">
                                    <p>相关指标值。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d68132e1603" headers="d68132e1521 ">
                                    <p><code class="codeph">数据</code></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d68132e1603 d68132e1525 ">
                                    <p>数据值。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d68132e1611" headers="d68132e1521 ">
                                    <p><code class="codeph">名称</code></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d68132e1611 d68132e1525 ">
                                    <p>列名。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d68132e1620" headers="d68132e1521 ">
                                    <p><code class="codeph">CHARACTER_SET_NAME</code></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d68132e1620 d68132e1525 ">
                                    <p>列的字符集。</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <div class="section">
                        <p>下表列出了描述符项名称的Oracle扩展。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="tblformal" id="GUID-5572BF6D-CC71-42BF-B4F9-77F29D99D3E8__G1030681">
                        <p class="titleintable">表10-5描述符项名称定义的Oracle扩展</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="Oracle扩展描述符项目名称的定义" width="100%" border="1" summary="q" frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="31%" id="d68132e1640">描述符项目名称</th>
                                 <th align="left" valign="bottom" width="69%" id="d68132e1644">含义</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d68132e1650" headers="d68132e1640 ">
                                    <p><code class="codeph">NATIONAL_CHARACTER</code></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d68132e1650 d68132e1644 ">
                                    <p>如果是2，NCHAR或NVARCHAR2。如果是1，字符。如果为0，则为非字符。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d68132e1658" headers="d68132e1640 ">
                                    <p><code class="codeph">INTERNAL_LENGTH</code></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d68132e1658 d68132e1644 ">
                                    <p>内部长度，以字节为单位。</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-5572BF6D-CC71-42BF-B4F9-77F29D99D3E8__GUID-ECD3B728-ED6C-4675-B58B-FBE55000578B">使用说明</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>在GET DESCRIPTOR语句中使用FOR子句，该语句仅包含DATA，INDICATOR和RETURNED_LENGTH项。</p>
                        <p>内部类型由DESCRIBE OUTPUT语句提供。对于输入和输出，必须将类型设置为主变量的外部类型。TYPE是表10-1中的Oracle或ANSI代码。如果ANSI类型不在表中，您将收到Oracle类型代码的负值。</p>
                        <p>LENGTH包含具有固定宽度国家语言字符集的字段的列长度（以字符为单位）。其他字符列以字节为单位。它在DESCRIBE OUTPUT中设置。</p>
                        <p>RETURNED_LENGTH是FETCH语句设置的实际数据长度。它是以LENGTH描述的字节或字符。字段OCTET_LENGTH和RETURNED_OCTET_LENGTH是以字节为单位的长度。</p>
                        <p>NULLABLE = 1表示该列可以具有NULLS; NULLABLE = 0表示它不能。</p>
                        <p>CHARACTER_SET_NAME仅对字符列有意义。对于其他类型，它是未定义的。DESCRIBE OUTPUT语句获取该值。</p>
                        <p>DATA和INDICATOR是该列的数据值和指示器状态。如果data = NULL，但未请求指示符，则在运行时生成错误（“DATA EXCEPTION，NULL VALUE，NO INDICATOR PARAMETER”）。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-5572BF6D-CC71-42BF-B4F9-77F29D99D3E8__GUID-AC3EBDCA-2A07-4EB6-AAFA-89715EF8D973">特定于Oracle的描述符项名称</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>如果列是NCHAR或NVARCHAR2列，则NATIONAL_CHARACTER = 2。如果列是字符（但不是国家字符）列，则此项目设置为1。如果是非字符列，则在执行DESCRIBE OUTPUT后该项为0。</p>
                        <p>INTERNAL_LENGTH用于与Oracle动态方法4兼容。它与Oracle描述符区域的length成员具有相同的值。请参阅“Oracle Dynamic SQL：方法4”。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-5572BF6D-CC71-42BF-B4F9-77F29D99D3E8__GUID-0B41E461-80C6-4201-A126-A4EAF78362BD">例子</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">EXEC SQL GET DESCRIPTOR：BINDDES：COUNT = COUNT END-EXEC。 EXEC SQL获取描述符'SELDES'的值1：TYP = TYPE，：LEN = LENGTH END-EXEC。 EXEC SQL FOR：BATCH获取DESCRIPTOR本地'SELDES'值：SEL-ITEM-NO：IND = INDICATOR，：DAT = DATA END-EXEC。</pre></div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="Oracle-dynamic-SQL-method-4.html#GUID-C6256169-5928-466C-B7C7-960D20705EED">Oracle动态SQL：方法4</a></li>
                        </ul>
                     </div>
                  </div>
                  
               </div><a id="LNPCB649"></a><a id="LNPCB650"></a><a id="LNPCB651"></a><a id="LNPCB652"></a><a id="LNPCB653"></a><a id="LNPCB654"></a><a id="LNPCB648"></a><div class="props_rev_3"><a id="GUID-180E79CB-4D44-4A81-808A-7353715B176A" name="GUID-180E79CB-4D44-4A81-808A-7353715B176A"></a><h4 id="LNPCB-GUID-180E79CB-4D44-4A81-808A-7353715B176A" class="sect4"><span class="enumeration_section">10.6.4</span>设置描述<span class="enumeration_section">符</span></h4>
                  <div>
                     <div class="section">
                        <p class="subhead3" id="GUID-180E79CB-4D44-4A81-808A-7353715B176A__GUID-C87329C5-10A9-4C33-ACE7-AFE2A6707279">目的</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>使用此语句从主机变量设置描述符区域中的信息。SET DESCRIPTOR语句<span class="italic">仅</span>支持项名称的主机变量。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-180E79CB-4D44-4A81-808A-7353715B176A__GUID-7B294DEC-BA24-4BD8-B4D0-5A0D8CC84C6E">句法</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">EXEC SQL [FOR [：] <span class="italic">array_size</span> ] SET DESCRIPTOR [GLOBAL | LOCAL] { <span class="italic">：desc_nam | string_literal</span> } {COUNT =： <span class="italic">hv0</span> | VALUE <span class="italic">item_number</span> [REF] <span class="italic">item_name1</span> =： <span class="italic">hv1</span> [{，[REF] <span class="italic">item_nameN</span> =： <span class="italic">hvN</span> }]} END-EXEC。</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-180E79CB-4D44-4A81-808A-7353715B176A__GUID-E7522612-46F6-4B80-9288-1B17C782D931">变量</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <dl>
                           <dt class="dlterm"><a name="GUID-180E79CB-4D44-4A81-808A-7353715B176A__GUID-915F3F41-F6E6-4453-9F0D-B8243AE42F95"><!-- --></a> array_size</dt>
                           <dd>
                              <p>此可选Oracle子句允许在仅设置描述符项DATA，INDICATOR和RETURNED_LENGTH时使用数组。您不能在包含FOR子句的SET DESCRIPTOR中使用其他项。所有主机变量表大小必须匹配。对用于FETCH语句的SET语句使用相同的数组大小。</p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-180E79CB-4D44-4A81-808A-7353715B176A__GUID-4F14766C-99F7-4FEB-B08E-A45783A95EFA"><!-- --></a> desc_nam</dt>
                           <dd>
                              <p>描述符名称。它遵循ALLOCATE DESCRIPTOR中的规则。</p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-180E79CB-4D44-4A81-808A-7353715B176A__GUID-D70E9E17-20E5-4161-BD7D-BB9F636F715A"><!-- --></a> COUNT</dt>
                           <dd>
                              <p>绑定（输入）或定义（输出）变量的数量。</p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-180E79CB-4D44-4A81-808A-7353715B176A__GUID-633769CD-4164-4497-ABF5-E0D1732C4B12"><!-- --></a> VALUE item_number</dt>
                           <dd>
                              <p>位于主机变量的动态SQL语句中。</p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-180E79CB-4D44-4A81-808A-7353715B176A__GUID-9E59CD53-34B5-4776-A9D6-A278CDBFC439"><!-- --></a> hv1 .. hvN</dt>
                           <dd>
                              <p>您设置的主变量（不是常量）。</p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-180E79CB-4D44-4A81-808A-7353715B176A__GUID-7BA04E21-873C-4B81-ADAD-AD2B39A4F5D9"><!-- --></a> item_name1 .. item_nameN</dt>
                           <dd>
                              <p>与GET DESCRIPTOR语法类似（请参阅“GET DESCRIPTOR”）， <code class="codeph">item_name</code>可以采用以下值：</p>
                           </dd>
                        </dl>
                     </div>
                     <!-- class="section" -->
                     <div class="tblformal" id="GUID-180E79CB-4D44-4A81-808A-7353715B176A__G1029727">
                        <p class="titleintable">表10-6 SET DESCRIPTOR的描述符项名称</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="SET DESCRIPTOR的描述符项目名称" width="100%" border="1" summary="q" frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="31%" id="d68132e1836">描述符项目名称</th>
                                 <th align="left" valign="bottom" width="69%" id="d68132e1840">含义</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d68132e1846" headers="d68132e1836 ">
                                    <p>类型</p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d68132e1846 d68132e1840 ">
                                    <p>有关ANSI类型代码，请参见表10-1。有关Oracle类型代码，请参阅表11-2。如果Oracle类型不在表中，则使用Oracle类型代码的负值，并且TYPE_CODE = ANSI。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d68132e1853" headers="d68132e1836 ">
                                    <p>长度</p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d68132e1853 d68132e1840 ">
                                    <p>列中的最大数据长度。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d68132e1860" headers="d68132e1836 ">
                                    <p>精确</p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d68132e1860 d68132e1840 ">
                                    <p>位数。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d68132e1867" headers="d68132e1836 ">
                                    <p>规模</p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d68132e1867 d68132e1840 ">
                                    <p>对于精确数字类型，小数点右侧的字节数。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d68132e1874" headers="d68132e1836 ">
                                    <p>指示符</p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d68132e1874 d68132e1840 ">
                                    <p>相关指标值。设置参考语义。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d68132e1881" headers="d68132e1836 ">
                                    <p>数据</p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d68132e1881 d68132e1840 ">
                                    <p>要设置的数据的值。设置参考语义。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d68132e1888" headers="d68132e1836 ">
                                    <p>CHARACTER_SET_NAME</p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d68132e1888 d68132e1840 ">
                                    <p>列的字符集。</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <div class="section">
                        <p>下表列出了描述符项名称的Oracle扩展。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="tblformal" id="GUID-180E79CB-4D44-4A81-808A-7353715B176A__G1029923">
                        <p class="titleintable">表10-7 SET DESCRIPTOR的描述符项名称的扩展</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="SET DESCRIPTOR的描述符项名称的扩展" width="100%" border="1" summary="q" frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="32%" id="d68132e1907">描述符项目名称</th>
                                 <th align="left" valign="bottom" width="68%" id="d68132e1911">含义</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="32%" id="d68132e1917" headers="d68132e1907 ">
                                    <p>RETURNED_LENGTH</p>
                                 </td>
                                 <td align="left" valign="top" width="68%" headers="d68132e1917 d68132e1911 ">
                                    <p>FETCH后返回的长度。设置是否使用引用语义。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="32%" id="d68132e1924" headers="d68132e1907 ">
                                    <p>NATIONAL_CHARACTER</p>
                                 </td>
                                 <td align="left" valign="top" width="68%" headers="d68132e1924 d68132e1911 ">
                                    <p>当输入主机变量是NCHAR或NVARCHAR2类型时，设置为2。</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-180E79CB-4D44-4A81-808A-7353715B176A__GUID-EDD63A0C-A1D7-4A14-B3A6-2F814DBE4776">使用说明</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>引用语义是另一个可选的Oracle扩展，可以提高性能。在这些描述符项名称之前使用关键字REF：DATA，INDICATOR，RETURNED_LENGTH。使用REF关键字时，不需要使用GET语句。复杂数据类型和DML返回子句需要SET DESCRIPTOR的REF形式。请参阅“DML返回条款”。</p>
                        <p>当使用REF时，在SET中使用关联的主机变量本身。在这种情况下不需要GET。只能在使用REF语义而不是值语义时设置RETURNED_LENGTH。</p>
                        <p>对FETCH中使用的SET或GET语句使用相同的数组大小。</p>
                        <p>对于NCHAR主机输入值，将NATIONAL_CHAR字段设置为2。</p>
                        <p>设置对象类型的特征时，必须设置USER_DEFINED_TYPE_NAME和USER_DEFINED_TYPE_NAME_LENGTH。</p>
                        <p>如果省略，则USER_DEFINED_TYPE_SCHEMA和USER_DEFINED_TYPE_SCHEMA_LENGTH默认为当前连接。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="embedded-SQL.html#GUID-672BB15A-1E0C-4179-8F2B-16012A02B325">DML返还条款</a></li>
                           <li><a href="ANSI-dynamic-SQL.html#GUID-5572BF6D-CC71-42BF-B4F9-77F29D99D3E8">获取描述符</a></li>
                        </ul>
                     </div>
                  </div>
                  <a id="LNPCB655"></a><div class="props_rev_3"><a id="GUID-A3BB9D8F-CEA6-420B-8876-0FFCDE56E58A" name="GUID-A3BB9D8F-CEA6-420B-8876-0FFCDE56E58A"></a><h5 id="LNPCB-GUID-A3BB9D8F-CEA6-420B-8876-0FFCDE56E58A" class="sect5"><span class="enumeration_section">10.6.4.1</span>示例</h5>
                     <div>
                        <p>可以在<span class="q">“ <a href="ANSI-dynamic-SQL.html#GUID-88BE9B20-8BF1-42AA-84CA-9B46D6562B6F">使用批量操作表</a> ”</span>中找到批量表示例。
                        </p><pre class="oac_no_warn" dir="ltr">...O1 BINDNO PIC S9（9）COMP VALUE 2。01 INDI PIC S9（4）COMP VALUE -1。01 DATA PIC X（6）COMP VALUE“忽略”。01批量PIC S9（9）COMP值1。...EXEC SQL FOR：批处理ALLOCATE DESCRIPTOR：BINDDES END-EXEC。 EXEC SQL SET DESCRIPTOR GLOBAL：BINDDES COUNT = 3 END-EXEC。 EXEC SQL FOR：批处理SET DESCRIPTOR：BINDDES VALUE：BINDNO INDICATOR =：INDI，DATA =：DATA END-EXEC。 ...</pre></div>
                  </div>
               </div><a id="LNPCB657"></a><a id="LNPCB658"></a><a id="LNPCB659"></a><a id="LNPCB660"></a><a id="LNPCB656"></a><div class="props_rev_3"><a id="GUID-7B7FDA36-A72A-4167-A2C8-B9B0BB5EA7E2" name="GUID-7B7FDA36-A72A-4167-A2C8-B9B0BB5EA7E2"></a><h4 id="LNPCB-GUID-7B7FDA36-A72A-4167-A2C8-B9B0BB5EA7E2" class="sect4"><span class="enumeration_section">10.6.5</span>使用PREPARE</h4>
                  <div>
                     <div class="section">
                        <p class="subhead3" id="GUID-7B7FDA36-A72A-4167-A2C8-B9B0BB5EA7E2__GUID-96CB7F5B-2981-405F-90CA-A872281628C6">目的</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>此方法中使用的PREPARE语句与Oracle动态SQL方法中使用的PREPARE语句相同。Oracle扩展允许SQL语句的带引号的字符串以及变量。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-7B7FDA36-A72A-4167-A2C8-B9B0BB5EA7E2__GUID-17EBCBA6-3703-4D4A-82A9-51E7211F7D0B">句法</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">EXEC SQL PREPARE <span class="italic">statement_id</span> FROM： <span class="italic">sql_statement</span> END-EXEC。</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-7B7FDA36-A72A-4167-A2C8-B9B0BB5EA7E2__GUID-97D3A9E7-EE90-401E-B6E2-AE19A42771A7">变量</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <dl>
                           <dt class="dlterm"><a name="GUID-7B7FDA36-A72A-4167-A2C8-B9B0BB5EA7E2__GUID-54875C66-CE13-44A6-AC65-EF58B8FAEC75"><!-- --></a> statement_id</dt>
                           <dd>
                              <p>不得宣布这一点;它是与准备好的SQL语句关联的未声明的SQL标识符。</p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-7B7FDA36-A72A-4167-A2C8-B9B0BB5EA7E2__GUID-B7BEF3C3-A274-4BC1-9138-9310643D9DE4"><!-- --></a> sql_statement</dt>
                           <dd>
                              <p>保存嵌入式SQL语句的字符串（常量或变量）。</p>
                           </dd>
                        </dl>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-7B7FDA36-A72A-4167-A2C8-B9B0BB5EA7E2__GUID-ED242AE9-D00B-4FFB-AE79-07E39F725A7E">例子</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">...01语句PIC X（255）VALUE“选择ENAME FROM emp WHERE deptno =：d”。...EXEC SQL PREPARE S1 FROM：STATEMENT END-EXEC。</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="LNPCB662"></a><a id="LNPCB663"></a><a id="LNPCB664"></a><a id="LNPCB665"></a><a id="LNPCB661"></a><div class="props_rev_3"><a id="GUID-E3614D75-879B-47CB-8179-CE88A25F25FE" name="GUID-E3614D75-879B-47CB-8179-CE88A25F25FE"></a><h4 id="LNPCB-GUID-E3614D75-879B-47CB-8179-CE88A25F25FE" class="sect4"><span class="enumeration_section">10.6.6</span>描述输入</h4>
                  <div>
                     <div class="section">
                        <p class="subhead3" id="GUID-E3614D75-879B-47CB-8179-CE88A25F25FE__GUID-C060C02F-406D-4E2A-B078-E7A648CF4968">目的</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>此语句返回有关输入绑定变量的信息。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-E3614D75-879B-47CB-8179-CE88A25F25FE__GUID-923AF3B3-0A19-454C-A154-8FAD17493037">句法</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">EXEC SQL DESCRIBE INPUT <span class="italic">statement_id</span>使用[SQL] DESCRIPTOR [GLOBAL | LOCAL] { <span class="italic">：desc_nam</span> | <span class="italic">string_literal</span> } <span class="italic">     </span> END-EXEC。</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-E3614D75-879B-47CB-8179-CE88A25F25FE__GUID-69A4C3F6-ED74-4FE6-B4CA-B40D6D4D44B4">变量</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <dl>
                           <dt class="dlterm"><a name="GUID-E3614D75-879B-47CB-8179-CE88A25F25FE__GUID-C7C32013-434E-4A97-9E16-1D0E1B3B5BC6"><!-- --></a> statement_id</dt>
                           <dd>
                              <p>与PREPARE和DESCRIBE OUTPUT中使用的相同。不得宣布这一点;它是一个SQL标识符。</p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-E3614D75-879B-47CB-8179-CE88A25F25FE__GUID-C82918A2-2C96-4336-8CAD-A06099A264ED"><!-- --></a> GLOBAL |本地</dt>
                           <dd>
                              <p>GLOBAL表示所有程序文件都知道描述符名称。LOCAL表示仅在分配它的文件中知道它。LOCAL是默认值。</p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-E3614D75-879B-47CB-8179-CE88A25F25FE__GUID-9B346C9B-1BEF-49AA-B064-B0E959F7D5BF"><!-- --></a> desc_nam</dt>
                           <dd>
                              <p>描述符名称。</p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-E3614D75-879B-47CB-8179-CE88A25F25FE__GUID-A4B54850-E6A1-4124-9769-6867A576362C"><!-- --></a>使用说明</dt>
                           <dd>
                              <p>在此版本中，只为绑定变量实现了COUNT和NAME。</p>
                           </dd>
                        </dl>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-E3614D75-879B-47CB-8179-CE88A25F25FE__GUID-9C8EE567-9528-4029-9DC2-0DD418569E8E">例子</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">EXEC SQL DESCRIBE INPUT S1使用SQL DESCRIPTOR GLOBAL：BINDDES END-EXEC。执行SQL描述输入S2使用DESCRIPTOR'输入'END-EXEC。</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="LNPCB667"></a><a id="LNPCB668"></a><a id="LNPCB669"></a><a id="LNPCB670"></a><a id="LNPCB666"></a><div class="props_rev_3"><a id="GUID-F3087B1D-E4F0-46E6-893F-3034E37A3F9F" name="GUID-F3087B1D-E4F0-46E6-893F-3034E37A3F9F"></a><h4 id="LNPCB-GUID-F3087B1D-E4F0-46E6-893F-3034E37A3F9F" class="sect4"><span class="enumeration_section">10.6.7</span>描述输出</h4>
                  <div>
                     <div class="section">
                        <p class="subhead3" id="GUID-F3087B1D-E4F0-46E6-893F-3034E37A3F9F__GUID-968C8410-1538-46F4-9CF0-D8AF34B28CF1">目的</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>DESCRIBE INPUT语句用于获取有关PREPARE语句中的列的信息。ANSI语法与旧语法不同。存储在SQL描述符区域中的信息是返回的值的数量以及类型，长度和名称等相关信息。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-F3087B1D-E4F0-46E6-893F-3034E37A3F9F__GUID-59005712-6D5A-4C55-9478-AC902715672A">句法</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">EXEC SQL DESCRIBE [OUTPUT] <span class="italic">statement_id</span>使用[SQL] DESCRIPTOR [GLOBAL | LOCAL] { <span class="italic">：desc_nam</span> | <span class="italic">string_literal</span> } <span class="italic">     </span> END-EXEC。</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-F3087B1D-E4F0-46E6-893F-3034E37A3F9F__GUID-0B505C56-1E7D-40B4-BCFB-013AFD7382E7">变量</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <dl>
                           <dt class="dlterm"><a name="GUID-F3087B1D-E4F0-46E6-893F-3034E37A3F9F__GUID-F2AA99C4-1EDB-435E-ADCC-E1A8ACF0AF7C"><!-- --></a> statement_id</dt>
                           <dd>
                              <p>statement_id是一个SQL标识符。不得宣布。</p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-F3087B1D-E4F0-46E6-893F-3034E37A3F9F__GUID-528EE1EB-CD74-472B-B1B8-C909E9FE2373"><!-- --></a> GLOBAL |本地</dt>
                           <dd>
                              <p>GLOBAL表示所有程序文件都知道描述符名称。LOCAL表示仅在分配它的文件中知道它。LOCAL是默认值。</p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-F3087B1D-E4F0-46E6-893F-3034E37A3F9F__GUID-B4E596EE-1538-4EED-9922-C75CEF3839C8"><!-- --></a> desc_nam</dt>
                           <dd>
                              <p>描述符名称。主变量前面带有'：'或单引号字符串。OUTPUT是默认值，可以省略。</p>
                           </dd>
                        </dl>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-F3087B1D-E4F0-46E6-893F-3034E37A3F9F__GUID-BE040B0B-2097-491B-AA66-E9C901A0A340">例子</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">...01 DESNAME PIC X（10）值“SELDES”。...EXEC SQL DESCRIBE S1使用SQL DESCRIPTOR'SELDES'END-EXEC。 *或者：EXEC SQL DESCRIBE OUTPUT S1使用DESCRIPTOR：DESNAME END-EXEC。</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="LNPCB672"></a><a id="LNPCB673"></a><a id="LNPCB674"></a><a id="LNPCB675"></a><a id="LNPCB676"></a><a id="LNPCB671"></a><div class="props_rev_3"><a id="GUID-65D67227-F41A-4CF2-8D9D-87AD8B5A388D" name="GUID-65D67227-F41A-4CF2-8D9D-87AD8B5A388D"></a><h4 id="LNPCB-GUID-65D67227-F41A-4CF2-8D9D-87AD8B5A388D" class="sect4"><span class="enumeration_section">10.6.8</span>执行</h4>
                  <div>
                     <div class="section">
                        <p class="subhead3" id="GUID-65D67227-F41A-4CF2-8D9D-87AD8B5A388D__GUID-BF3EA97C-092F-43B3-9019-8F3C582E3DFE">目的</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>EXECUTE在准备好的SQL语句中匹配输入和输出变量，然后执行该语句。此ANSI版本的EXECUTE与旧的EXECUTE语句不同，它允许一个语句中的两个描述符支持DML RETURNING。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-65D67227-F41A-4CF2-8D9D-87AD8B5A388D__GUID-92FA8E9A-4935-40BA-8508-534E8554F9CB">句法</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">EXEC SQL [FOR [：] <span class="italic">array_size</span> ] EXECUTE <span class="italic">statement_id</span> [USING [SQL] DESCRIPTOR [GLOBAL | LOCAL] { <span class="italic">：desc_nam</span> | <span class="italic">string_literal</span> }] [INTO [SQL] DESCRIPTOR [GLOBAL | LOCAL] { <span class="italic">：desc_nam</span> | <span class="italic">string_literal</span> }] END-EXEC。</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-65D67227-F41A-4CF2-8D9D-87AD8B5A388D__GUID-5A4DD5FD-7969-44FD-9196-CDF627AC96A6">变量</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <dl>
                           <dt class="dlterm"><a name="GUID-65D67227-F41A-4CF2-8D9D-87AD8B5A388D__GUID-82BCB64A-AA93-4D74-A83C-99BCB8323EEB"><!-- --></a> array_size</dt>
                           <dd>
                              <p>语句将处理的行数。</p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-65D67227-F41A-4CF2-8D9D-87AD8B5A388D__GUID-5F950EC0-D7DF-4072-A5FC-24010BCB5F68"><!-- --></a> statement_id</dt>
                           <dd>
                              <p>与PREPARE中使用的相同。不得宣布这一点;它是一个SQL标识符。它可以是文字。</p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-65D67227-F41A-4CF2-8D9D-87AD8B5A388D__GUID-9F1BEDD7-4DB1-4A06-BE13-D4210869ED27"><!-- --></a> GLOBAL |本地</dt>
                           <dd>
                              <p>GLOBAL表示所有程序文件都知道描述符名称。LOCAL表示仅在分配它的文件中知道它。LOCAL是默认值。</p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-65D67227-F41A-4CF2-8D9D-87AD8B5A388D__GUID-E3A36DA3-EA33-48F8-8A25-10F4DEBE5F92"><!-- --></a> desc_nam</dt>
                           <dd>
                              <p>描述符名称。主变量前面带有'：'或单引号字符串。</p>
                           </dd>
                        </dl>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-65D67227-F41A-4CF2-8D9D-87AD8B5A388D__GUID-4F056CC1-742D-481A-9425-8EE71EFE6F6B">使用说明</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>INTO子句为INSERT，UPDATE和DELETE实现RETURNING子句（参见“插入行”和后续页面）。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-65D67227-F41A-4CF2-8D9D-87AD8B5A388D__GUID-D3BB9E76-2418-4348-A628-1DB879B0E8A9">例子</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">EXEC SQL EXECUTE S1使用SQL DESCRIPTOR GLOBAL：BINDDES END-EXEC。 EXEC SQL EXECUTE S2使用描述符：bv1进入描述符'SELDES'END-EXEC。</pre></div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="embedded-SQL.html#GUID-646DE444-E6B3-4213-B633-411C1CBDDC87">插入行</a></li>
                        </ul>
                     </div>
                  </div>
                  
               </div><a id="LNPCB678"></a><a id="LNPCB679"></a><a id="LNPCB680"></a><a id="LNPCB681"></a><a id="LNPCB677"></a><div class="props_rev_3"><a id="GUID-8FD6596A-31AB-4558-8A6E-D1F3B1426BB9" name="GUID-8FD6596A-31AB-4558-8A6E-D1F3B1426BB9"></a><h4 id="LNPCB-GUID-8FD6596A-31AB-4558-8A6E-D1F3B1426BB9" class="sect4"><span class="enumeration_section">10.6.9</span>使用EXECUTE IMMEDIATE</h4>
                  <div>
                     <div class="section">
                        <p class="subhead3" id="GUID-8FD6596A-31AB-4558-8A6E-D1F3B1426BB9__GUID-09273C88-BA97-4B4E-99F5-CC3009A7A7D7">目的</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>EXECUTE IMMEDIATE语句执行包含SQL语句的文字或主机变量字符串。此语句的ANSI SQL形式与旧动态SQL中的相同：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-8FD6596A-31AB-4558-8A6E-D1F3B1426BB9__GUID-7D679695-861C-4C0C-BE6B-54750C95DD9D">句法</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">EXEC SQL EXECUTE IMMEDIATE [：] <span class="italic">sql_statement END-EXEC。</span></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-8FD6596A-31AB-4558-8A6E-D1F3B1426BB9__GUID-58E47F4F-68AA-4C8A-A223-96FD22C600C8">变量</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>EXECUTE IMMEDIATE语句只有一个变量可用。</p>
                        <dl>
                           <dt class="dlterm"><a name="GUID-8FD6596A-31AB-4558-8A6E-D1F3B1426BB9__GUID-E70C7175-4B23-4945-8034-A456D4D552A9"><!-- --></a> sql_statement</dt>
                           <dd>
                              <p>sql_statement变量是字符串中的SQL语句或PL / SQL块。它可以是宿主变量或文字。</p>
                           </dd>
                        </dl>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-8FD6596A-31AB-4558-8A6E-D1F3B1426BB9__GUID-7B25521C-E35D-4860-9F11-B5C652280168">例子</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">EXEC SQL EXECUTE IMMEDIATE： <span class="italic">语句</span> END-EXEC。</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="LNPCB683"></a><a id="LNPCB684"></a><a id="LNPCB685"></a><a id="LNPCB686"></a><a id="LNPCB682"></a><div class="props_rev_3"><a id="GUID-F31468EA-D1A3-4C12-933C-4937F074E9CF" name="GUID-F31468EA-D1A3-4C12-933C-4937F074E9CF"></a><h4 id="LNPCB-GUID-F31468EA-D1A3-4C12-933C-4937F074E9CF" class="sect4"><span class="enumeration_section">10.6.10</span>使用DYNAMIC DECLARE CURSOR</h4>
                  <div>
                     <div class="section">
                        <p class="subhead3" id="GUID-F31468EA-D1A3-4C12-933C-4937F074E9CF__GUID-40CD4903-F765-4EA9-9C3D-664192B667D4">目的</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>DYNAMIC DECLARE CURSOR语句声明一个与作为查询的语句关联的游标。这是通用Declare Cursor语句的一种形式。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-F31468EA-D1A3-4C12-933C-4937F074E9CF__GUID-7AA7B7D7-BC15-4CD2-8013-6D28AC608A73">句法</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">EXEC SQL DECLARE <span class="italic">cursor_name</span> CURSOR FOR <span class="italic">statement_id END-EXEC。</span></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-F31468EA-D1A3-4C12-933C-4937F074E9CF__GUID-FF7B5F14-DDEB-413F-A3F7-70CFD5BB43B6">变量</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <dl>
                           <dt class="dlterm"><a name="GUID-F31468EA-D1A3-4C12-933C-4937F074E9CF__GUID-2BAC61E8-59FB-450A-A11A-09E315FBE006"><!-- --></a> cursor_name</dt>
                           <dd>
                              <p>游标变量（SQL标识符，而不是主变量）。</p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-F31468EA-D1A3-4C12-933C-4937F074E9CF__GUID-0E034250-8E66-48A3-9C18-6BBD5515F648"><!-- --></a> statement_id</dt>
                           <dd>
                              <p>未声明的SQL标识符（与PREPARE语句中使用的标识符相同）。</p>
                           </dd>
                        </dl>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-F31468EA-D1A3-4C12-933C-4937F074E9CF__GUID-F7447FA6-EF59-4A41-98B7-404F9A878C11">例子</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">用于S1 END-EXEC的EXEC SQL DECLARE C1游标。</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="LNPCB688"></a><a id="LNPCB689"></a><a id="LNPCB690"></a><a id="LNPCB691"></a><a id="LNPCB692"></a><a id="LNPCB687"></a><div class="props_rev_3"><a id="GUID-1377CFFE-523E-4C44-99B0-50FAC47A8AC6" name="GUID-1377CFFE-523E-4C44-99B0-50FAC47A8AC6"></a><h4 id="LNPCB-GUID-1377CFFE-523E-4C44-99B0-50FAC47A8AC6" class="sect4"><span class="enumeration_section">10.6.11</span> OPEN游标</h4>
                  <div>
                     <div class="section">
                        <p class="subhead3" id="GUID-1377CFFE-523E-4C44-99B0-50FAC47A8AC6__GUID-A5C5B169-3291-4D8D-9BED-E0880F8B5220">目的</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>OPEN语句将输入参数与游标关联，然后打开游标。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-1377CFFE-523E-4C44-99B0-50FAC47A8AC6__GUID-C024FC15-192B-486F-86EC-32F902D608A9">句法</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">EXEC SQL [FOR [：] <span class="italic">array_size</span> ] OPEN <span class="italic">dyn_cursor</span> [[USING [SQL] DESCRIPTOR [GLOBAL | LOCAL] <span class="italic">desc_nam1</span> ] [INTO [SQL] DESCRIPTOR [GLOBAL | LOCAL] <span class="italic">desc_nam2</span> ]] END-EXEC。</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-1377CFFE-523E-4C44-99B0-50FAC47A8AC6__GUID-B680E57B-D1AF-4CAD-96B6-E0F457CEE626">变量</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <dl>
                           <dt class="dlterm"><a name="GUID-1377CFFE-523E-4C44-99B0-50FAC47A8AC6__GUID-36433AD1-A54E-4C0D-B150-450D96C2D68D"><!-- --></a> array_size</dt>
                           <dd>
                              <p>此限制小于或等于分配描述符时指定的数字。</p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-1377CFFE-523E-4C44-99B0-50FAC47A8AC6__GUID-4230AE90-3AD1-466D-A742-5CD2BFB241D8"><!-- --></a> GLOBAL |本地</dt>
                           <dd>
                              <p>GLOBAL表示所有程序文件都知道描述符名称。LOCAL表示仅在分配它的文件中知道它。LOCAL是默认值。</p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-1377CFFE-523E-4C44-99B0-50FAC47A8AC6__GUID-D5B50CF3-6A49-440E-AE75-B9A0921FCCBB"><!-- --></a> dyn_cursor</dt>
                           <dd>
                              <p>游标变量。</p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-1377CFFE-523E-4C44-99B0-50FAC47A8AC6__GUID-F774FDA8-50A2-40DC-82B3-420F736DF725"><!-- --></a> desc_nam1，desc_nam2</dt>
                           <dd>
                              <p>可选的描述符名称。</p>
                           </dd>
                        </dl>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-1377CFFE-523E-4C44-99B0-50FAC47A8AC6__GUID-A536A0CB-70E9-446F-8107-761488EA0937">使用说明</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>如果与游标关联的预准备语句包含冒号或问号，则必须指定USING子句，否则在运行时会产生错误。INTO子句支持DML RETURNING（请参阅“插入行”和DELETE和UPDATE的后续部分）。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-1377CFFE-523E-4C44-99B0-50FAC47A8AC6__GUID-C8BDDE51-9257-455F-8622-0B5DBFB8D3E1">例子</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">EXEC SQL OPEN C1使用SQL DESCRIPTOR：BINDDES END-EXEC。 EXEC SQL FOR：LIMIT OPEN C2使用DESCRIPTOR：B1，：B2 INTO SQL DESCRIPTOR：SELDES END-EXEC。</pre></div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="embedded-SQL.html#GUID-646DE444-E6B3-4213-B633-411C1CBDDC87">插入行</a></li>
                        </ul>
                     </div>
                  </div>
                  
               </div><a id="LNPCB694"></a><a id="LNPCB695"></a><a id="LNPCB696"></a><a id="LNPCB697"></a><a id="LNPCB698"></a><a id="LNPCB693"></a><div class="props_rev_3"><a id="GUID-12FAAF57-D09A-4842-846B-1A21F0938629" name="GUID-12FAAF57-D09A-4842-846B-1A21F0938629"></a><h4 id="LNPCB-GUID-12FAAF57-D09A-4842-846B-1A21F0938629" class="sect4"><span class="enumeration_section">10.6.12</span> FETCH</h4>
                  <div>
                     <div class="section">
                        <p class="subhead3" id="GUID-12FAAF57-D09A-4842-846B-1A21F0938629__GUID-0D042BAA-B4AA-4FAD-9AD1-138B37E00BFE">目的</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>FETCH语句为使用动态DECLARE语句声明的游标提取行。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-12FAAF57-D09A-4842-846B-1A21F0938629__GUID-09837F1E-D122-4B53-A8D5-44C72E4A00F5">句法</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">EXEC SQL [FOR [：] <span class="italic">array_size</span> ] FETCH游标INTO [SQL] DESCRIPTOR [GLOBAL | LOCAL] { <span class="italic">：desc_nam</span> | <span class="italic">string_literal</span> } END-EXEC。</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-12FAAF57-D09A-4842-846B-1A21F0938629__GUID-ADF5DD0B-EABD-45D1-A1A4-881DFE43BA86">变量</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <dl>
                           <dt class="dlterm"><a name="GUID-12FAAF57-D09A-4842-846B-1A21F0938629__GUID-E132AE29-C134-4441-AEDE-3C4C2DC51BC4"><!-- --></a> array_size</dt>
                           <dd>
                              <p>语句将处理的行数。</p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-12FAAF57-D09A-4842-846B-1A21F0938629__GUID-F651BC37-8222-46DF-99E0-30F8686A00B0"><!-- --></a>游标</dt>
                           <dd>
                              <p>先前声明的动态游标。</p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-12FAAF57-D09A-4842-846B-1A21F0938629__GUID-2FEE9042-F0E2-4E26-9E58-0B9385F5155A"><!-- --></a> GLOBAL |本地</dt>
                           <dd>
                              <p>GLOBAL表示所有程序文件都知道描述符名称。LOCAL表示仅在分配它的文件中知道它。LOCAL是默认值。</p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-12FAAF57-D09A-4842-846B-1A21F0938629__GUID-8C24425C-442C-4E18-8DCD-C5980DC23F9D"><!-- --></a> desc_nam</dt>
                           <dd>
                              <p>描述符名称。</p>
                           </dd>
                        </dl>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-12FAAF57-D09A-4842-846B-1A21F0938629__GUID-03491603-71DE-42C5-B714-655F46F6F5F8">使用说明</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>FOR子句中的可选<code class="codeph">array_size</code>必须小于或等于ALLOCATE DESCRIPTOR语句中指定的数字。
                        </p>
                        <p>对于固定长度的字符类型，RETURNED_LENGTH未定义。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-12FAAF57-D09A-4842-846B-1A21F0938629__GUID-417E38E8-4D29-4EA0-B5BE-BB804CDA9791">例子</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">执行SQL FETCH从C1到DESCRIPTOR'SELDES'END-EXEC。执行SQL FOR：ARSZ FETCH C2到DESCRIPTOR：DESC END-EXEC。</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="LNPCB700"></a><a id="LNPCB701"></a><a id="LNPCB702"></a><a id="LNPCB703"></a><a id="LNPCB699"></a><div class="props_rev_3"><a id="GUID-3DF3693C-B448-4B7C-9F0A-FC2DA9F4156C" name="GUID-3DF3693C-B448-4B7C-9F0A-FC2DA9F4156C"></a><h4 id="LNPCB-GUID-3DF3693C-B448-4B7C-9F0A-FC2DA9F4156C" class="sect4"><span class="enumeration_section">10.6.13</span>关闭动态光标</h4>
                  <div>
                     <div class="section">
                        <p class="subhead3" id="GUID-3DF3693C-B448-4B7C-9F0A-FC2DA9F4156C__GUID-29C5C6F7-329D-4779-B64F-B6BF125940BF">目的</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>CLOSE语句关闭动态游标。其语法与Oracle Method 4相同。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-3DF3693C-B448-4B7C-9F0A-FC2DA9F4156C__GUID-81234B1E-A41B-4C32-877A-1B52D30C13A8">句法</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">EXEC SQL CLOSE <span class="italic">游标</span> END-EXEC。</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-3DF3693C-B448-4B7C-9F0A-FC2DA9F4156C__GUID-9AA022C9-EC33-4018-BF32-D7A13940AA26">变量</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>CLOSE语句只有一个变量可用。</p>
                        <dl>
                           <dt class="dlterm"><a name="GUID-3DF3693C-B448-4B7C-9F0A-FC2DA9F4156C__GUID-DE24023F-46BA-4F9F-8469-CF1167EDF2B9"><!-- --></a>游标</dt>
                           <dd>
                              <p>游标变量描述了先前声明的动态游标。</p>
                           </dd>
                        </dl>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-3DF3693C-B448-4B7C-9F0A-FC2DA9F4156C__GUID-99776063-E051-4D5B-9CC8-4AFD1F3211E4">例子</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">EXEC SQL CLOSE C1 END-EXEC。</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="LNPCB704"></a><div class="props_rev_3"><a id="GUID-5CAE1EED-2A42-4D21-94A8-89E1AC89323F" name="GUID-5CAE1EED-2A42-4D21-94A8-89E1AC89323F"></a><h4 id="LNPCB-GUID-5CAE1EED-2A42-4D21-94A8-89E1AC89323F" class="sect4"><span class="enumeration_section">10.6.14</span>与Oracle动态方法4的差异</h4>
                  <div>
                     <p>ANSI动态SQL接口支持Oracle动态方法4支持的所有功能，并添加了以下内容：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>ANSI动态SQL支持所有数据类型，包括游标变量和LOB类型。</p>
                        </li>
                        <li>
                           <p>ANSI模式使用内部<span class="italic">SQL描述符区域</span> ，该<span class="italic">区域</span>是Oracle旧动态方法4中使用的外部SQLDA的扩展，用于存储其输入和输出信息。
                           </p>
                        </li>
                        <li>
                           <p>引入了新的嵌入式SQL语句：ALLOCATE DESCRIPTOR，DEALLOCATE DESCRIPTOR，DESCRIBE，GET DESCRIPTOR和SET DESCRIPTOR。</p>
                        </li>
                        <li>
                           <p>DESCRIBE语句不返回ANSI动态SQL中的指示符变量的名称。</p>
                        </li>
                        <li>
                           <p>ANSI动态SQL不允许您指定返回的列名称或表达式的最大大小。默认大小设置为128。</p>
                        </li>
                        <li>
                           <p>描述符名称必须是单引号中的标识符或以冒号开头的主变量。</p>
                        </li>
                        <li>
                           <p>对于输出，DESCRIBE中的可选SELECT LIST FOR子句将替换为可选关键字OUTPUT。 INTO子句由USING DESCRIPTOR子句替换，该子句可以包含可选的关键字SQL。</p>
                        </li>
                        <li>
                           <p>对于输入，DESCRIBE的可选BIND VARIABLES FOR子句可以由关键字INPUT替换。 INTO子句由USING DESCRIPTOR子句替换，该子句可以包含可选的关键字SQL。</p>
                        </li>
                        <li>
                           <p>可选关键字SQL可以位于EXECUTE，FETCH和OPEN语句的USING子句中的关键字DESCRIPTOR之前。</p>
                        </li>
                     </ul>
                  </div>
               </div><a id="LNPCB705"></a><div class="props_rev_3"><a id="GUID-775B7328-E784-4AB1-BD40-0C0E619BA633" name="GUID-775B7328-E784-4AB1-BD40-0C0E619BA633"></a><h4 id="LNPCB-GUID-775B7328-E784-4AB1-BD40-0C0E619BA633" class="sect4"><span class="enumeration_section">10.6.15</span>限制</h4>
                  <div>
                     <div class="section">
                        <p>对ANSI动态SQL的限制是：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>您不能在同一模块中混合使用这两种动态方法。</p>
                           </li>
                           <li>
                              <p>预编译器选项DYNAMIC必须设置为ANSI。仅当DYNAMIC设置为ANSI时，预编译器选项TYPE_CODE才能设置为ANSI。</p>
                           </li>
                           <li>
                              <p>SET语句仅支持主变量作为项名称。</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="LNPCB706"></a><div class="props_rev_3"><a id="GUID-754BE05E-F9C4-406E-B77C-7E4BF7F67EDC" name="GUID-754BE05E-F9C4-406E-B77C-7E4BF7F67EDC"></a><h3 id="LNPCB-GUID-754BE05E-F9C4-406E-B77C-7E4BF7F67EDC" class="sect3"><span class="enumeration_section">10.7</span>示例程序：SAMPLE12。PCO</h3>
               <div>
                  <p>以下ANSI SQL动态方法4程序，SAMPLE12。PCO可以在demo目录中找到。SAMPLE12通过提示用户输入SQL语句来模仿SQL * Plus。有关程序流程的详细信息，请阅读开头的注释。</p><pre class="oac_no_warn" dir="ltr">************************************************** **************** *示例程序12：使用ANSI动态SQL的动态SQL方法4 * * * *此程序显示了使用动态* * SQL方法4和ANSI所需的基本步骤动态SQL。登录到* * ORACLE后，程序会提示用户输入SQL语句，* * PREPARE语句，DECLAREs游标，使用DESCRIBE INPUT检查任何* *绑定变量，打开游标，* * DESCRIBE任何选择 - 列表变量。如果输入SQL * *语句是查询，程序会对每行数据进行FETCH，* *然后关闭光标。* *在预编译此示例时使用选项dynamic = ansi。* ************************************************* *****************识别部门。 PROGRAM-ID。ANSIDYNSQL4。环境部门。数据部门。工作储存部分。 01 USERNAME PIC X（20）。01 PASSWD PIC X（20）。01 BDSC PIC X（6）值“BNDDSC”。01 SDSC PIC X（6）值“SELDSC”。01 BNDCNT PIC S9（9）COMP。 01 SELCNT PIC S9（9）COMP。 01 BNDNAME PIC X（80）。01 BNDVAL PIC X（80）。01 SELNAME PIC X（80）变化。 01 SELDATA PIC X（80）。01 SELTYP PIC S9（4）COMP。 01 SELPREC PIC S9（4）COMP。 01 SELLEN PIC S9（4）COMP。 01 SELIND PIC S9（4）COMP。 01 DYN-STATEMENT PIC X（80）。01 BND-INDEX PIC S9（9）COMP。 01 SEL-INDEX PIC S9（9）COMP。 01 VARCHAR2-TYP PIC S9（4）COMP VALUE 1。01 VAR-COUNT PIC 9（2）。01 ROW-COUNT PIC 9（4）。01 NO-MORE-DATA PIC X（1）值“N”。01 TMPLEN PIC S9（9）COMP。 01 MAX-LENGTH PIC S9（9）COMP值80。EXEC SQL包含SQLCA END-EXEC。程序部门。 START-MAIN。执行SQL WHENEVER SQLERROR GOTO SQL-ERROR END-EXEC。显示“USERNAME：”，没有任何进展。接受用户名。显示“密码：”没有进展。接受PASSWD。 EXEC SQL CONNECT：USERNAME IDENTIFIED BY：PASSWD END-EXEC。显示“与用户ORACLE连接：”，USERNAME。 *分配绑定和选择描述符。 EXEC SQL ALLOCATE DESCRIPTOR：BDSC，MAX 20 END-EXEC。 EXEC SQL ALLOCATE DESCRIPTOR：带有MAX 20 END-EXEC的SDSC。 *从操作员处获取SQL语句。显示“输入没有终结符的SQL语句：”。显示“&gt;”没有进展。接受DYN-STATEMENT。显示“”。*准备SQL语句并声明游标。 EXEC SQL PREPARE S1 FROM：DYN-STATEMENT END-EXEC。用于S1 END-EXEC的EXEC SQL DECLARE C1游标。 *描述各种变量。 EXEC SQL DESCRIBE INPUT S1使用DESCRIPTOR：BDSC END-EXEC。 EXEC SQL GET DESCRIPTOR：BDSC：BNDCNT = COUNT END-EXEC。如果BNDCNT &lt;0显示“太多的各种变量。”转到结束-SQL ELSE显示“绑定变量的数量：”没有进展的动态BNDCNT到VAR-COUNT DISPLAY VAR-COUNT * EXEC SQL SET DESCRIPTOR：BDSC COUNT =：BNDCNT END-EXEC END-IF。如果BNDCNT = 0转到描述项目。执行SET-BND-DSC从1比1改变BND指数BND-INDEX&gt; BNDCNT。 *打开游标并描述选择列表项目。 DESCRIBE项。 EXEC SQL OPEN C1使用描述符：BDSC END-EXEC。 EXEC SQL DESCRIBE输出S1使用描述符：SDSC END-EXEC。 EXEC SQL GET DESCRIPTOR：SDSC：SELCNT = COUNT END-EXEC。如果SELCNT &lt;0显示“太多选择列表项目。”转到结束-SQL ELSE显示“选择列表项目的数量：”没有进展的动态SELCNT到VAR-COUNT DISPLAY VAR-COUNT DISPLAY“”* EXEC SQL SET DESCRIPTOR：SDSC COUNT =：SELCNT END-EXEC END-IF。 *设置输入描述符如果SELCNT&gt; 0执行SET-SEL-DSC从1比1改变SEL-INDEX选择SELTIL-INDEX&gt; SELCNT显示“”。*每个行和每个选项列表值。如果SELCNT&gt; 0执行FETCH-ROWS直到NO-MORE-DATA =“Y”。显示“显示”处理的行数：“没有进展。将SQLERRD（3）移到ROW-COUNT。显示行数。 *清理和终止。 EXEC SQL CLOSE C1 END-EXEC。 EXEC SQL DEALLOCATE DESCRIPTOR：BDSC END-EXEC。 EXEC SQL DEALLOCATE DESCRIPTOR：SDSC END-EXEC。 EXEC SQL ROLLBACK工作发布END-EXEC。显示“”。显示“有一个好日子！”。显示“”。停止运行。 *显示ORACLE错误消息和代码。 SQL-ERROR。显示“”。显示SQLERRMC。 END-SQL。执行SQL WHENEVER SQLERROR CONTINUE END-EXEC。 EXEC SQL ROLLBACK工作发布END-EXEC。停止运行。 *在这里开始执行的子程序：*设置一个绑定列表元素的属性*让用户填写绑定变量并*将描述为* BIND DESCRIPTOR的数据字段的0S替换为1S以避免“无效数据”* ORACLE ERROR SET-BND-DSC。 EXEC SQL GET DESCRIPTOR：BDSC值：BND-INDEX：BNDNAME = NAME END-EXEC。显示“输入值”，BNDNAME。接受BNDVAL。 EXEC SQL SET DESCRIPTOR：BDSC值：BND-INDEX TYPE =：VARCHAR2-TYP，LENGTH =：MAX-LENGTH，DATA =：BNDVAL END-EXEC。 *设置选择列表元素的属性设置SEL-DSC。移动到SELNAME-ARR的空间。 EXEC SQL GET DESCRIPTOR：SDSC VALUE：SEL-INDEX：SELNAME = NAME，：SELTYP = TYPE，：SELPREC = PRECISION，：SELLEN = LENGTH END-EXEC。 *如果DATATYPE是日期，长度为9个字符。如果SELTYP = 12移动9卖。 *如果数字是数字，则设置精确度。移动0到TMPLEN。如果SELTYP = 2且SELPREC = 0则移动40到TMPLEN。如果SELTYP = 2且SELPREC&gt; 0则加2到SELPREC将SELPREC移位到TMPLEN。 IF SELTYP = 2如果TMPLEN&gt; MAX-LENGTH显示“数据缓冲区的列值过大”。转到结束 -  SQL ELSE移动TMPLEN卖。 * COCHCE DATATYPES到VARCHAR2。移动1到SELTYP。 *显示栏目标题。显示“”，SELNAME-ARR（1：SELLEN）没有任何进展。 EXEC SQL SET DESCRIPTOR：SDSC VALUE：SEL-INDEX TYPE =：SELTYP，LENGTH =：SELLEN END-EXEC。 * FETCH A ROW并打印选择列表值。获取 - 行。 EXEC SQL FETCH C1 INTO DESCRIPTOR：SDSC END-EXEC。如果SQLCODE NOT = 0，则将“Y”移动到NO-MORE-DATA。如果SQLCODE = 0执行打印列值，则从1比1改变SEL-INDEX的选择，直到选择索引&gt; SELCNT显示“”。*打印选择列表值。 PRINT列值。向SELDATA移动空间。 *返回的长度未设置为空白填充类型IF SELTYP EQUALS 1 EXEC SQL GET DESCRIPTOR：SDSC VALUE：SEL-INDEX：SELDATA = DATA，：SELIND = INDICATOR，：SELLEN = LENGTH END-EXEC ELSE EXEC SQL GET DESCRIPTOR：SDSC VALUE ：SEL-INDEX：SELDATA = DATA，：SELIND = INDICATOR，：SELLEN = RETURNED_LENGTH END-EXEC。 IF（SELIND = -1）将“NULL”移动到SELDATA。显示SELDATA（1：SELLEN），“”没有进展。</pre></div>
            </div>
         </div>
      </article>
   </body>
</html>