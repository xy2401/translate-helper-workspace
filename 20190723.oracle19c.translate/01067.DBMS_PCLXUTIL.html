<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="The DBMS_PCLXUTIL package provides intra-partition parallelism for creating partition-wise local indexes. DBMS_PCLXUTIL circumvents the limitation that, for local index creation, the degree of parallelism is restricted to the number of partitions as only one parallel execution server process for each partition is used."></meta>
      <meta name="description" content="The DBMS_PCLXUTIL package provides intra-partition parallelism for creating partition-wise local indexes. DBMS_PCLXUTIL circumvents the limitation that, for local index creation, the degree of parallelism is restricted to the number of partitions as only one parallel execution server process for each partition is used."></meta>
      <title>DBMS_PCLXUTIL</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="PL/SQL Packages and Types Reference"></meta>
      <meta property="og:description" content="The DBMS_PCLXUTIL package provides intra-partition parallelism for creating partition-wise local indexes. DBMS_PCLXUTIL circumvents the limitation that, for local index creation, the degree of parallelism is restricted to the number of partitions as only one parallel execution server process for each partition is used."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="PL/SQL Packages and Types Reference"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="database-pl-sql-packages-and-types-reference.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-03-25T11:24:34-07:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96430-03"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="DBMS_PART.html" title="Previous" type="text/html"></link>
      <link rel="next" href="DBMS_PDB.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database PL/SQL Packages and Types Reference"></meta>
    <meta name="dcterms.isVersionOf" content="ARPLS"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="DBMS_PART.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="DBMS_PDB.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">PL / SQL包和类型参考</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">DBMS_PCLXUTIL</li>
            </ol>
            <a id="GUID-C96F2118-91D9-4651-9F79-D8ABE6F2078F" name="GUID-C96F2118-91D9-4651-9F79-D8ABE6F2078F"></a><a id="ARPLS037"></a><a id="ARPLS037"></a>
            
            <h2 id="ARPLS-GUID-C96F2118-91D9-4651-9F79-D8ABE6F2078F" class="sect2"><span class="enumeration_chapter">117</span> DBMS_PCLXUTIL</h2>
         </header>
         <div class="ind">
            <div>
               <p><code class="codeph">DBMS_PCLXUTIL</code>包提供了分区内并行性，用于创建分区方式的本地索引。<code class="codeph">DBMS_PCLXUTIL</code>避免了这样的限制：对于本地索引创建，并行度受限于分区数，因为每个分区只使用一个并行执行服务器进程。
               </p>
               <div class="infoboxnotealso" id="GUID-C96F2118-91D9-4651-9F79-D8ABE6F2078F__GUID-04C77654-455C-4386-AE53-BFA19C5A6A45">
                  <p class="notep1">也可以看看：</p>
                  <p>有几个关于分区和索引的规则。有关更多信息，请参阅<a href="../cncpt/oracle-relational-structures.html#CNCPT-GUID-54C48ABE-E589-428A-849F-B8746C9D276A" target="_blank"><span><cite>Oracle数据库概念</cite></span></a>和<a href="../admin/basic-database-administration.html#ADMIN-GUID-1DF51F9B-86E9-4E40-A30E-00714E7C0003" target="_blank"><span><cite>Oracle数据库管理员指南</cite></span></a> 。
                  </p>
               </div>
               <p>本章包含以下主题：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="DBMS_PCLXUTIL.html#GUID-71784F64-AB6C-4CA7-B637-9A63179139FF" title="DBMS_PCLXUTIL使用DBMS_JOB包提供更大程度的并行性，以便为分区表创建本地索引。这是通过使用后台进程（使用DBMS_SCHEDULER）的异步分区间并行性以及使用并行执行服务器的分区内并行性来实现的。">概观</a></p>
                  </li>
                  <li>
                     <p><a href="DBMS_PCLXUTIL.html#GUID-77FE1D89-C445-4CED-9C45-E29B053993EE" title="此实用程序只能作为表所有者运行，而不能像任何其他用户一样运行。">安全模型</a></p>
                  </li>
                  <li>
                     <p><a href="DBMS_PCLXUTIL.html#GUID-DB46DFEB-BFF6-4869-8663-52A162FA79AF" title="DBMS_PCLXUTIL为每个分区提交作业。user / dba负责通过正确设置INIT.ORA参数JOB_QUEUE_PROCESSES来控制并发作业的数量。检查语法正确的错误最少。作业队列进程跟踪文件中报告任何错误。">操作说明</a></p>
                  </li>
                  <li>
                     <p><a href="DBMS_PCLXUTIL.html#GUID-CA91707F-915B-4AC5-B9F8-282F805AC65C" title="因为DBMS_PCLXUTIL使用DBMS_JOB包，所以您必须了解与DBMS_JOB相关的以下限制：">规则和限制</a></p>
                  </li>
                  <li>
                     <p><a href="DBMS_PCLXUTIL.html#GUID-B4C182A4-6163-48E9-8976-3CCB2353FB59" title="DBMS_PCLXUTIL包有一个子程序BUILD_PART_INDEX过程。">DBMS_PCLXUTIL子程序摘要</a></p>
                  </li>
               </ul>
            </div><a id="ARPLS73692"></a><a id="ARPLS73692"></a><div class="props_rev_3"><a id="GUID-71784F64-AB6C-4CA7-B637-9A63179139FF" name="GUID-71784F64-AB6C-4CA7-B637-9A63179139FF"></a><h3 id="ARPLS-GUID-71784F64-AB6C-4CA7-B637-9A63179139FF" class="sect3"><span class="enumeration_section">117.1</span> DBMS_PCLXUTIL概述</h3>
               <div>
                  <p><code class="codeph">DBMS_PCLXUTIL</code>使用<code class="codeph">DBMS_JOB</code>包提供更大程度的并行性，以便为分区表创建本地索引。这是通过使用后台进程（使用<code class="codeph">DBMS_SCHEDULER</code> ）的异步分区间并行性以及使用并行执行服务器的分区内并行性来实现的。
                  </p>
                  <div class="section">
                     <p><code class="codeph">DBMS_PCLXUTIL</code>适用于范围和范围哈希复合分区。
                     </p>
                     <p>可以在以下DBA任务期间使用<code class="codeph">DBMS_PCLXUTIL</code>包：</p>
                     <ol>
                        <li>
                           <p>本地索引创建</p>
                           <p>过程<code class="codeph">BUILD_PART_INDEX</code>假定本地索引的字典信息已存在。这可以通过使用<code class="codeph">UNUSABLE</code>选项发出create index SQL命令来完成。
                           </p><pre class="oac_no_warn" dir="ltr">&lt;tab_name&gt;上的CREATE INDEX &lt;idx_name&gt;（...）local（...）不可用;</pre><p>这导致创建字典条目而不“构建”索引本身，这是创建索引的耗时部分。现在，调用<code class="codeph">BUILD_PART_INDEX</code>过程会导致并发构建具有指定并行度的本地索引。
                           </p><pre class="oac_no_warn" dir="ltr">EXECUTE dbms_pclxutil.build_part_index（4,4，&lt;tab_name&gt;，&lt;idx_name&gt;，FALSE）;</pre><p>对于复合分区，该过程会自动为组合表的所有子分区构建本地索引。</p>
                        </li>
                        <li>
                           <p>本地索引维护</p>
                           <p>通过将所需分区标记为可用或不可用， <code class="codeph">BUILD_PART_INDEX</code>过程还可以选择性地重建本地索引。<code class="codeph">force_opt</code>参数提供了一种覆盖此方法并为所有分区构建本地索引的方法。
                           </p><pre class="oac_no_warn" dir="ltr">ALTER INDEX &lt;idx_name&gt; local（...）不可用;</pre><p>仅重建所需（子）分区（标记为不可用）：</p><pre class="oac_no_warn" dir="ltr">EXECUTE dbms_pclxutil.build_part_index（4,4，&lt;tab_name&gt;，&lt;idx_name&gt;，FALSE）;</pre><p>使用<code class="codeph">force_opt</code> = <code class="codeph">TRUE</code>重建所有（子）分区：</p><pre class="oac_no_warn" dir="ltr">EXECUTE dbms_pclxutil.build_part_index（4,4，&lt;tab_name&gt;，&lt;idx_name&gt;，TRUE）;</pre><p>生成进度报告，当程序结束时输出显示在屏幕上（因为<code class="codeph">DBMS_OUTPUT</code>包首先将消息写入缓冲区，并且仅在程序终止时将缓冲区刷新到屏幕）。
                           </p>
                        </li>
                     </ol>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="ARPLS67385"></a><a id="ARPLS67385"></a><div class="props_rev_3"><a id="GUID-77FE1D89-C445-4CED-9C45-E29B053993EE" name="GUID-77FE1D89-C445-4CED-9C45-E29B053993EE"></a><h3 id="ARPLS-GUID-77FE1D89-C445-4CED-9C45-E29B053993EE" class="sect3"><span class="enumeration_section">117.2</span> DBMS_PCLXUTIL安全模型</h3>
               <div>
                  <p>此实用程序只能作为表所有者运行，而不能像任何其他用户一样运行。</p>
               </div>
            </div><a id="ARPLS67386"></a><a id="ARPLS67386"></a><div class="props_rev_3"><a id="GUID-DB46DFEB-BFF6-4869-8663-52A162FA79AF" name="GUID-DB46DFEB-BFF6-4869-8663-52A162FA79AF"></a><h3 id="ARPLS-GUID-DB46DFEB-BFF6-4869-8663-52A162FA79AF" class="sect3"><span class="enumeration_section">117.3</span> DBMS_PCLXUTIL操作说明</h3>
               <div>
                  <p><code class="codeph">DBMS_PCLXUTIL</code>为每个分区提交作业。user / dba负责通过设置<code class="codeph">INIT</code>来控制并发作业的数量。 <code class="codeph">ORA</code>参数<code class="codeph">JOB_QUEUE_PROCESSES</code>正确。检查语法正确的错误最少。作业队列进程跟踪文件中报告任何错误。
                  </p>
               </div>
            </div><a id="ARPLS67387"></a><a id="ARPLS67387"></a><div class="props_rev_3"><a id="GUID-CA91707F-915B-4AC5-B9F8-282F805AC65C" name="GUID-CA91707F-915B-4AC5-B9F8-282F805AC65C"></a><h3 id="ARPLS-GUID-CA91707F-915B-4AC5-B9F8-282F805AC65C" class="sect3"><span class="enumeration_section">117.4</span> DBMS_PCLXUTIL规则和限制</h3>
               <div>
                  <p>因为<code class="codeph">DBMS_PCLXUTIL</code>使用<code class="codeph">DBMS_JOB</code>包，所以您必须了解与<code class="codeph">DBMS_JOB</code>相关的以下限制：</p>
                  <div class="section">
                     <ul style="list-style-type:disc">
                        <li>
                           <p>您必须为<code class="codeph">job_queue_processes</code>初始化参数确定适当的值。显然，如果在调用<code class="codeph">BUILD_PART_INDEX</code> （）之前未启动作业进程，则包将无法正常运行。后台进程由以下<code class="codeph">init</code>指定。 <code class="codeph">ora</code>参数：</p>
                        </li>
                     </ul><pre class="oac_no_warn" dir="ltr">job_queue_processes = n＃后台进程数= n</pre><ul style="list-style-type:disc">
                        <li>
                           <p>故障情况仅在跟踪文件中报告（ <code class="codeph">DBMS_JOB</code>限制），因此无法向用户提供交互式反馈。此包打印失败消息，从队列中删除未完成的作业，并请求用户查看<code class="codeph">j*.trc</code>跟踪文件。
                           </p>
                        </li>
                     </ul>
                     <div class="infoboxnote" id="GUID-CA91707F-915B-4AC5-B9F8-282F805AC65C__GUID-6D5368BE-C2F7-41E0-880C-F952D8CCD6F3">
                        <p class="notep1">注意：</p>
                        <p>对于范围分区，最小兼容模式为8.0;对于范围哈希复合分区，最小兼容模式为8 <span class="italic">i</span> 。
                        </p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="ARPLS67388"></a><a id="ARPLS67389"></a><a id="ARPLS67389"></a><a id="ARPLS67388"></a><div class="props_rev_3"><a id="GUID-B4C182A4-6163-48E9-8976-3CCB2353FB59" name="GUID-B4C182A4-6163-48E9-8976-3CCB2353FB59"></a><h3 id="ARPLS-GUID-B4C182A4-6163-48E9-8976-3CCB2353FB59" class="sect3"><span class="enumeration_section">117.5</span> DBMS_PCLXUTIL子程序摘要</h3>
               <div>
                  <p><code class="codeph">DBMS_PCLXUTIL</code>包有一个子程序<code class="codeph">BUILD_PART_INDEX</code>过程。
                  </p>
                  <div class="tblformal" id="GUID-B4C182A4-6163-48E9-8976-3CCB2353FB59__GUID-F5D016CA-4745-4C57-899F-EED37FD7E3CB">
                     <p class="titleintable">表117-1 DBMS_PCLXUTIL包子程序</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="DBMS_PCLXUTIL包子程序" width="100%" border="1" summary="This table lists the DBMS_PCLXUTIL subprogram and briefly describes it." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="37%" id="d655768e760">子程序</th>
                              <th align="left" valign="bottom" width="63%" id="d655768e763">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="37%" id="d655768e768" headers="d655768e760 ">
                                 <p><a href="DBMS_PCLXUTIL.html#GUID-104BD4F2-EA93-4585-A9D5-CA73BF4ACC49" title="此过程提供用于创建分区方式本地索引的分区内并行性。">BUILD_PART_INDEX过程</a></p>
                              </td>
                              <td align="left" valign="top" width="63%" headers="d655768e768 d655768e763 ">
                                 <p>提供分区内并行性以创建分区方式本地索引</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
               </div><a id="ARPLS67390"></a><a id="ARPLS67391"></a><a id="ARPLS67391"></a><a id="ARPLS67390"></a><div class="props_rev_3"><a id="GUID-104BD4F2-EA93-4585-A9D5-CA73BF4ACC49" name="GUID-104BD4F2-EA93-4585-A9D5-CA73BF4ACC49"></a><h4 id="ARPLS-GUID-104BD4F2-EA93-4585-A9D5-CA73BF4ACC49" class="sect4"><span class="enumeration_section">117.5.1</span> BUILD_PART_INDEX过程</h4>
                  <div>
                     <p>此过程提供用于创建分区方式本地索引的分区内并行性。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-104BD4F2-EA93-4585-A9D5-CA73BF4ACC49__GUID-74478E52-33F5-4783-B0D5-70DCAFD79B68">句法</p><pre class="oac_no_warn" dir="ltr">DBMS_PCLXUTIL.BUILD_PART_INDEX（jobs_per_batch IN NUMBER DEFAULT 1，procs_per_job IN NUMBER DEFAULT 1，tab_name IN VARCHAR2 DEFAULT NULL，idx_name IN VARCHAR2 DEFAULT NULL，force_opt IN BOOLEAN DEFAULT FALSE）;</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-104BD4F2-EA93-4585-A9D5-CA73BF4ACC49__GUID-54B57831-EAC9-4D67-A91B-47C2C5062D01">参数</p>
                        <div class="tblformal" id="GUID-104BD4F2-EA93-4585-A9D5-CA73BF4ACC49__GUID-4AF2D6FA-3138-4C11-AEA5-56C2D6C037FC">
                           <p class="titleintable">表117-2 BUILD_PART_INDEX过程参数</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="BUILD_PART_INDEX过程参数" width="100%" border="1" summary="This table describes Parameters used by the BUILD_PART_INDEX subprogram." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="31%" id="d655768e889">参数</th>
                                    <th align="left" valign="bottom" width="69%" id="d655768e892">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d655768e897" headers="d655768e889 ">
                                       <p><code class="codeph">jobs_per_batch</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d655768e897 d655768e892 ">
                                       <p>并发分区“本地索引构建”的数量。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d655768e905" headers="d655768e889 ">
                                       <p><code class="codeph">procs_per_job</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d655768e905 d655768e892 ">
                                       <p>每个本地索引构建使用的并行执行服务器的数量（1 &lt;= <code class="codeph">procs_per_job</code> &lt;= <code class="codeph">max_slaves</code> ）。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d655768e919" headers="d655768e889 ">
                                       <p><code class="codeph">TAB_NAME</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d655768e919 d655768e892 ">
                                       <p>分区表的名称（如果表不存在或未分区，则引发异常）。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d655768e927" headers="d655768e889 ">
                                       <p><code class="codeph">idx_name</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d655768e927 d655768e892 ">
                                       <p>为本地索引指定的名称（如果未在表<code class="codeph">tab_name</code>上创建本地索引，则会引发异常）。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d655768e938" headers="d655768e889 ">
                                       <p><code class="codeph">force_opt</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d655768e938 d655768e892 ">
                                       <p>如果为<code class="codeph">TRUE</code> ，则强制重建所有分区索引;否则，只重建标记为“ <code class="codeph">UNUSABLE</code> ”的分区。
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-104BD4F2-EA93-4585-A9D5-CA73BF4ACC49__GUID-2DD61B3B-66A7-4438-99BE-714E318EC0A4">使用说明</p>
                        <p>此实用程序只能作为表所有者运行，而不能像任何其他用户一样运行。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-104BD4F2-EA93-4585-A9D5-CA73BF4ACC49__GUID-A8F35F88-277A-443F-8659-C1904409EEBB">例子</p>
                        <p>假设创建了一个表<code class="codeph">PROJECT</code> ，其中包含两个分区<code class="codeph">PROJ001</code>和<code class="codeph">PROJ002</code> ，以及一个本地索引<code class="codeph">IDX</code> 。</p>
                        <p>对过程<code class="codeph">BUILD_PART_INDEX(2,4,'PROJECT','IDX',TRUE)</code>的调用产生以下输出：</p><pre class="oac_no_warn" dir="ltr">SQLPLUS&gt; EXECUTE dbms_pclxutil.build_part_index（2,4，'PROJECT'，'IDX'，TRUE）;声明已处理。信息：为具有4个从站的分区PROJ002创建作业＃21 INFO：为具有4个从站的分区PROJ001创建作业＃22</pre></div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>