<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="Isolated mode enables you to create a keystore for each pluggable database (PDB)."></meta>
      <meta name="description" content="Isolated mode enables you to create a keystore for each pluggable database (PDB)."></meta>
      <title>在隔离模式下管理密钥库和TDE主加密密钥</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Advanced Security Guide "></meta>
      <meta property="og:description" content="Isolated mode enables you to create a keystore for each pluggable database (PDB)."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Advanced Security Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="advanced-security-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-03-13T09:26:12-07:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96301-02"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="managing-keystores-encryption-keys-in-united-mode.html" title="Previous" type="text/html"></link>
      <link rel="next" href="general-considerations-of-using-transparent-data-encryption.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Advanced Security Guide"></meta>
    <meta name="dcterms.isVersionOf" content="ASOAG"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="managing-keystores-encryption-keys-in-united-mode.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="general-considerations-of-using-transparent-data-encryption.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">高级安全指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="asopart1.html" property="item" typeof="WebPage"><span property="name">使用透明数据加密</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">在隔离模式下管理密钥库和TDE主加密密钥</li>
            </ol>
            <a id="GUID-ED5C479F-435F-47A5-AD96-8D874BEDA0AA" name="GUID-ED5C479F-435F-47A5-AD96-8D874BEDA0AA"></a>
            
            <h2 id="ASOAG-GUID-ED5C479F-435F-47A5-AD96-8D874BEDA0AA" class="sect2"><span class="enumeration_chapter">6</span>在隔离模式下管理密钥库和TDE主加密密钥</h2>
         </header>
         <div class="ind">
            <div>
               <p>隔离模式使您可以为每个可插拔数据库（PDB）创建密钥库。</p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-07CFFDDA-A91A-4248-B6B8-DC0DCE4A6822">关于在隔离模式下管理密钥库和TDE主加密密钥</a><br>在隔离模式下，可插拔数据库（PDB）具有自己的密钥库，您只能从PDB管理密钥库及其TDE主加密密钥。
                  </li>
                  <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-A113A464-A60E-4CAE-B2FB-76F8DD103434">隔离模式下允许的操作</a><br>您可以在隔离模式下执行许多<code class="codeph">ADMINISTER KEY MANAGEMENT</code>操作。
                  </li>
                  <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-19DB3E40-3B80-4896-9A15-18B56477B38B">在隔离模式PDB中不允许的操作</a><br>有几种<code class="codeph">ADMINISTER KEY MANAGEMENT</code>操作无法在隔离模式PDB中执行。</li>
                  <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-B3A669F2-5A75-405C-B319-83F0C3C168C5">配置隔离模式的密钥库位置和类型</a><br>对于隔离模式，可以仅使用参数或参数组合以及<code class="codeph">ALTER SYSTEM</code>语句来配置密钥库位置和类型。
                  </li>
                  <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-436F9034-B6B2-4AC8-8BD1-478B995E9F08">在隔离模式下配置密钥库和TDE主加密密钥</a><br>在隔离模式下，软件密钥库与PDB相关联。</li>
                  <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-8A38CB3C-91C4-42DC-84A1-A71091EF50D9">在隔离模式下配置硬件密钥库</a><br>Oracle数据库支持两种不同类型的硬件密钥库：硬件安全模块（ <code class="codeph">HSM</code> ）或Oracle Key Vault（ <code class="codeph">OKV</code> ）密钥库。
                  </li>
                  <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-B6EBC385-D014-43AA-B9DE-DF08F2082712">在隔离模式下管理密钥库和TDE主加密密钥</a><br>在隔离模式下创建密钥库和TDE主加密密钥后，您可以执行管理任务，例如重新加密或标记加密密钥。
                  </li>
                  <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-5316DC4C-BAFF-4653-9884-34F121AD878C">在隔离模式下管理透明数据加密</a><br>您可以在隔离模式下使用透明数据加密执行许多常规管理任务。
                  </li>
               </ul>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>父主题：</strong> <a href="asopart1.html" title="第一部分介绍了如何使用透明数据加密。">使用透明数据加密</a></p>
                  </div>
               </div>
            </div>
            
            <div class="sect2"><a id="GUID-07CFFDDA-A91A-4248-B6B8-DC0DCE4A6822" name="GUID-07CFFDDA-A91A-4248-B6B8-DC0DCE4A6822"></a><h3 id="ASOAG-GUID-07CFFDDA-A91A-4248-B6B8-DC0DCE4A6822" class="sect3">关于在隔离模式下管理密钥库和TDE主加密密钥</h3>
               <div>
                  <p>在隔离模式下，可插拔数据库（PDB）具有自己的密钥库，您只能从PDB管理密钥库及其TDE主加密密钥。</p>
                  <p>与联合模式类似，必须首先通过设置<code class="codeph">WALLET_ROOT</code>和<code class="codeph">TDE_CONFIGURATION</code>参数将PDB配置为使用隔离模式。设置这些参数后，您可以从PDB创建和管理密钥库。通过这种方式，您可以拥有以下方案：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>CDB根目录中的联合模式设置将应用于所有没有隔离模式设置的PDB。例如，您在CDB根目录中创建的密钥库将由根的关联联合模式PDB使用。</p>
                     </li>
                     <li>
                        <p>允许以隔离模式配置的PDB独立创建和管理自己的密钥库。隔离模式PDB可以拥有自己的密钥库，独立于CDB根的密钥库。</p>
                     </li>
                  </ul>
                  <p>如果您有许多必须使用一种类型的密钥库的PDB，但是您有一些必须使用不同类型的PDB，则此方案很有用。通过不同类型的密钥库，这指的是TDE软件密钥库或Oracle支持的硬件密钥库之一（例如，Oracle Key Vault，Safenet或Cloud Key Management Service）。您不能在一个CDB环境中混合使用不同的硬件密钥库类型，因为Oracle服务器只能加载一个PKCS＃11供应商库。如有必要，可以在隔离模式下配置这些PDB，以便每个PDB可以使用自己的密钥库。</p>
                  <p>在隔离模式下配置PDB的一个优点是，与存在大量加密PDB的联合模式下的重定密钥性能相比，它提高了PDB中重定密钥操作的性能。</p>
                  <p>在CDB中，当加密的PDB数量很大时，在隔离模式下配置PDB允许该PDB中的重定密钥操作的性能保持与独立系统中的重定密钥操作的性能类似，并且保持不变为整个系统中加密的PDB增加。</p>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-ED5C479F-435F-47A5-AD96-8D874BEDA0AA" title="隔离模式使您可以为每个可插拔数据库（PDB）创建密钥库。">在隔离模式下管理密钥库和TDE主加密密钥</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-A113A464-A60E-4CAE-B2FB-76F8DD103434" name="GUID-A113A464-A60E-4CAE-B2FB-76F8DD103434"></a><h3 id="ASOAG-GUID-A113A464-A60E-4CAE-B2FB-76F8DD103434" class="sect3">隔离模式下允许的操作</h3>
               <div>
                  <p>您可以在隔离模式下执行许多<code class="codeph">ADMINISTER KEY MANAGEMENT</code>操作。
                  </p>
                  <div class="section">
                     <p>这些操作包括创建，备份，打开密钥库;更改密钥库密码，合并密钥库，关闭密钥库;创建，激活，标记，移动，导出，导入和迁移加密密钥;以及添加，更新和删除客户机密。</p>
                     <p><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-A113A464-A60E-4CAE-B2FB-76F8DD103434__ADMINISTERKEYMANAGEMENTISOLATIONMOD-04C52957" title="此表描述了隔离模式下允许的ADMINISTER KEY MANAGEMENT操作，以及每个操作使用的语法">表6-1</a>介绍了可以在隔离模式PDB中执行的<code class="codeph">ADMINISTER KEY MANAGEMENT</code>操作。</p>
                     <div class="tblformal" id="GUID-A113A464-A60E-4CAE-B2FB-76F8DD103434__ADMINISTERKEYMANAGEMENTISOLATIONMOD-04C52957">
                        <p class="titleintable">表6-1管理员密钥管理隔离模式操作</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="管理员密钥管理隔离模式操作" border="1" summary="This table describes the ADMINISTER KEY MANAGEMENT operations that are allowed in isolated mode, and the syntax used for each operations" frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="20%" id="d36049e342">手术</th>
                                 <th align="left" valign="bottom" width="20%" id="d36049e344">句法</th>
                                 <th align="left" valign="bottom" width="20%" id="d36049e346">隔离模式注释</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d36049e350" headers="d36049e342 ">
                                    <p>创建密钥库</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d36049e350 d36049e344 "><pre class="oac_no_warn" dir="ltr">ADMINISTER密钥管理CREATE KEYSTORE [' <span class="italic">keystore_location</span> '] IDENTIFIED BY <span class="italic">keystore_password</span> ;</pre></td>
                                 <td align="left" valign="top" width="20%" headers="d36049e350 d36049e346 ">
                                    <p>您可以在隔离模式PDB中创建受密码保护的本地自动登录和自动登录密钥库。</p>
                                    <p>只有在设置了<code class="codeph">WALLET_ROOT</code>参数后， <code class="codeph"><span class="codeinlineitalic">keystore_location</span></code>子句才是可选的。否则，它是强制性的。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d36049e375" headers="d36049e342 ">
                                    <p>创建自动登录密钥库</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d36049e375 d36049e344 "><pre class="oac_no_warn" dir="ltr">ADMINISTER密钥管理从KEYSTORE创建[LOCAL] AUTO_LOGIN KEYSTORE [' <span class="italic">keystore_location</span> '] IDENTIFIED BY <span class="italic">keystore_password</span> ;</pre></td>
                                 <td align="left" valign="top" width="20%" headers="d36049e375 d36049e346 ">
                                    <p>如果设置了<code class="codeph">WALLET_ROOT</code>参数，则<code class="codeph"><span class="codeinlineitalic">keystore_location</span></code>是可选的。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d36049e398" headers="d36049e342 ">
                                    <p>打开密钥库</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d36049e398 d36049e344 "><pre class="oac_no_warn" dir="ltr">管理员密钥管理设置KEYSTORE打开[FORCE KEYSTORE]由[EXTERNAL STORE | <span class="italic">keystore_password</span> ];</pre></td>
                                 <td align="left" valign="top" width="20%" headers="d36049e398 d36049e346 ">
                                    <p>在此操作中， <code class="codeph">EXTERNAL_STORE</code>子句使用钱包中的密码。在非多租户（独立）环境中，钱包配置在<code class="codeph">EXTERNAL_KEYSTORE_CREDENTIAL_LOCATION</code>初始化参数设置的位置。在多租户环境中，钱包在<code class="codeph">WALLET_ROOT</code>位置的<code class="codeph">tde_seps</code>目录中配置。此钱包包含密钥库的密码。
                                    </p>
                                    <p>对于处于隔离模式的PDB，必须在<code class="codeph"><span class="codeinlineitalic">WALLET_ROOT</span> / <span class="codeinlineitalic">PDB_GUID</span> /tde_seps</code>位置配置<code class="codeph">EXTERNAL_STORE</code>子句使用的钱包。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d36049e436" headers="d36049e342 ">
                                    <p>更改密钥库密码</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d36049e436 d36049e344 "><pre class="oac_no_warn" dir="ltr">管理员密钥管理ALTER KEYSTORE密码由<span class="italic">old_keystore_password</span>标识SET <span class="italic">new_keystore_password</span> WITH BACKUP [使用' <span class="italic">backup_identifier</span> '];</pre></td>
                                 <td align="left" valign="top" width="20%" headers="d36049e436 d36049e346 ">
                                    <p>-</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d36049e455" headers="d36049e342 ">
                                    <p>备份密钥库</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d36049e455 d36049e344 "><pre class="oac_no_warn" dir="ltr">管理员密钥管理备份KEYSTORE [使用' <span class="italic">backup_identifier</span> ']由[外部商店]识别<span class="italic">keystore_password</span> ] [ <span class="italic">TO'keystore_location</span> '];</pre></td>
                                 <td align="left" valign="top" width="20%" headers="d36049e455 d36049e346 ">
                                    <p>-</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d36049e474" headers="d36049e342 ">
                                    <p>将一个密钥库的内容合并到现有密钥库中</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d36049e474 d36049e344 "><pre class="oac_no_warn" dir="ltr">ADMINISTER密钥管理MERGE密钥库<span class="italic">'keystore_location1'[IDENTIFIED</span> BY <span class="italic">keystore1_password]</span> INTO IDENTIFIED通过用BACKUP <span class="italic">keystore2_password</span> EXISTING密钥库<span class="italic">'keystore_location</span> 2'[USING <span class="italic">'backup_identifier'];</span></pre></td>
                                 <td align="left" valign="top" width="20%" headers="d36049e474 d36049e346 ">
                                    <p>-</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d36049e499" headers="d36049e342 ">
                                    <p>合并两个密钥库的内容以创建第三个密钥库</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d36049e499 d36049e344 "><pre class="oac_no_warn" dir="ltr">ADMINISTER密钥管理MERGE密钥库<span class="italic">'keystore_location1'[IDENTIFIED</span> BY <span class="italic">keystore1_password]</span> AND密钥库<span class="italic">'keystore_location2'[IDENTIFIED</span> BY <span class="italic">keystore2_password]</span> INTO IDENTIFIED BY <span class="italic">keystore3_password</span>新的密钥库<span class="italic">'keystore_location3';</span></pre></td>
                                 <td align="left" valign="top" width="20%" headers="d36049e499 d36049e346 ">
                                    <p>-</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d36049e528" headers="d36049e342 ">
                                    <p>关闭密钥库</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d36049e528 d36049e344 "><pre class="oac_no_warn" dir="ltr">管理员密钥管理设置KEYSTORE关闭[由[外部商店|确定] <span class="italic">keystore_password</span> ]];</pre></td>
                                 <td align="left" valign="top" width="20%" headers="d36049e528 d36049e346 ">
                                    <p>-</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d36049e541" headers="d36049e342 ">
                                    <p>当处于隔离模式的PDB打开其密钥库时，关闭CDB根目录的密钥库</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d36049e541 d36049e344 "><pre class="oac_no_warn" dir="ltr">管理员密钥管理力量KEYSTORE关闭[由[外部商店|确定] <span class="italic">keystore_password</span> ]];</pre></td>
                                 <td align="left" valign="top" width="20%" headers="d36049e541 d36049e346 ">
                                    <p>即使处于隔离模式的PDB仍然打开其密钥库， <code class="codeph">FORCE</code>子句也允许在CDB根中关闭密钥库</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d36049e557" headers="d36049e342 ">
                                    <p>创建并激活新的TDE主加密密钥（重新加密）</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d36049e557 d36049e344 "><pre class="oac_no_warn" dir="ltr">管理员密钥管理集[加密]密钥[使用标记' <span class="italic">tag_name</span> '] [FORCE KEYSTORE]由[EXTERNAL STORE | <span class="italic">keystore_password</span> ] WITH BACKUP [使用' <span class="italic">backup_identifier</span> '];</pre></td>
                                 <td align="left" valign="top" width="20%" headers="d36049e557 d36049e346 ">
                                    <p>-</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d36049e576" headers="d36049e342 ">
                                    <p>为现在（ <code class="codeph">SET</code> ）或以后创建用户定义的TDE主加密密钥（ <code class="codeph">CREATE</code></p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d36049e576 d36049e344 "><pre class="oac_no_warn" dir="ltr">管理员密钥管理[SET |创建] [ENCRYPTION] <span class="italic">KEY'mkid</span> ： <span class="italic">mk</span> | <span class="italic">MK</span> '[使用算法<span class="italic">'算法']</span> [FORCE密钥库] [使用标记' <span class="italic">TAG_NAME“]</span> IDENTIFIED BY [外挂| <span class="italic">keystore_password</span> ] [WITH BACKUP [使用' <span class="italic">backup_identifier</span> ']] [CONTAINER = CURRENT];</pre></td>
                                 <td align="left" valign="top" width="20%" headers="d36049e576 d36049e346 ">
                                    <p>-</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d36049e614" headers="d36049e342 ">
                                    <p>激活现有TDE主加密密钥</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d36049e614 d36049e344 "><pre class="oac_no_warn" dir="ltr">管理员密钥管理使用[加密]密钥' <span class="italic">key_id</span> '[使用标签'标签']由[外部商店]识别<span class="italic">keystore_password</span> ] WITH BACKUP [使用' <span class="italic">backup_identifier</span> '];</pre></td>
                                 <td align="left" valign="top" width="20%" headers="d36049e614 d36049e346 ">
                                    <p>-</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d36049e633" headers="d36049e342 ">
                                    <p>标记TDE主加密密钥</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d36049e633 d36049e344 "><pre class="oac_no_warn" dir="ltr">管理员密钥管理设置标记'标记' <span class="italic">FOR'key_id</span> '由[外部商店|标识]识别<span class="italic">keystore_password</span> ] WITH BACKUP [使用' <span class="italic">backup_identifier</span> '];</pre></td>
                                 <td align="left" valign="top" width="20%" headers="d36049e633 d36049e346 ">
                                    <p>-</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d36049e652" headers="d36049e342 ">
                                    <p>导出TDE主加密密钥</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d36049e652 d36049e344 "><pre class="oac_no_warn" dir="ltr">管理员密钥管理导出[加密]具有秘密<span class="italic">秘密的</span> <span class="italic">密钥通过keystore_password</span> [WITH IDENTIFIER IN {' <span class="italic">key_id</span> '[，' <span class="italic">key_id</span> '] ...识别' <span class="italic">文件名</span> '...| （ <span class="italic">子查询</span> ）}];</pre></td>
                                 <td align="left" valign="top" width="20%" headers="d36049e652 d36049e346 ">
                                    <p>-</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d36049e681" headers="d36049e342 ">
                                    <p>导入TDE主加密密钥</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d36049e681 d36049e344 "><pre class="oac_no_warn" dir="ltr">管理员密钥管理导入[加密]密钥<span class="italic">秘密</span>来自' <span class="italic">filename</span> '由<span class="italic">keystore_password</span> [WITH BACKUP [ <span class="italic">USING'backup_identifier</span> ']]标识;</pre></td>
                                 <td align="left" valign="top" width="20%" headers="d36049e681 d36049e346 ">
                                    <p>-</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d36049e703" headers="d36049e342 ">
                                    <p>将TDE主加密密钥从软件密钥库迁移到HSM</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d36049e703 d36049e344 "><pre class="oac_no_warn" dir="ltr">管理员密钥管理集[ENCRYPTION]由<span class="italic">HSM_auth_string</span> [FORCE KEYSTORE]识别的密钥使用<span class="italic">software_keystore_password</span> WITH BACKUP [使用' <span class="italic">backup_identifier</span> ']进行迁移;</pre></td>
                                 <td align="left" valign="top" width="20%" headers="d36049e703 d36049e346 ">
                                    <p>-</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d36049e722" headers="d36049e342 ">
                                    <p>将TDE主加密密钥从HSM反向迁移到软件密钥库</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d36049e722 d36049e344 "><pre class="oac_no_warn" dir="ltr">管理员密钥管理集[ENCRYPTION]由<span class="italic">software_keystore_password</span>标识的密钥REVERSE MIGRATE使用<span class="italic">HSM_auth_string</span> ;</pre></td>
                                 <td align="left" valign="top" width="20%" headers="d36049e722 d36049e346 ">
                                    <p>-</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d36049e738" headers="d36049e342 ">
                                    <p>添加客户端密钥</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d36049e738 d36049e344 "><pre class="oac_no_warn" dir="ltr">管理员密钥管理添加秘密<span class="italic">'秘密'</span>为客户' <span class="italic">client_identifier</span> '[使用标签' <span class="italic">tag_name</span> ']由[外部商店]识别<span class="italic">keystore_password</span> ] WITH BACKUP [使用' <span class="italic">backup_identifier</span> '];</pre></td>
                                 <td align="left" valign="top" width="20%" headers="d36049e738 d36049e346 ">
                                    <p>-</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d36049e763" headers="d36049e342 ">
                                    <p>更新客户端密钥</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d36049e763 d36049e344 "><pre class="oac_no_warn" dir="ltr">管理员密钥管理更新秘密<span class="italic">'秘密'</span>为客户' <span class="italic">client_identifier</span> '[使用标签' <span class="italic">tag_name</span> ']由[外部商店]识别<span class="italic">keystore_password</span> ] WITH BACKUP [使用' <span class="italic">backup_identifier</span> '];</pre></td>
                                 <td align="left" valign="top" width="20%" headers="d36049e763 d36049e346 ">
                                    <p>-</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d36049e788" headers="d36049e342 ">
                                    <p>删除客户端密钥</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d36049e788 d36049e344 "><pre class="oac_no_warn" dir="ltr">管理员密钥管理删除客户' <span class="italic">client_identifier</span> '的秘密由[外部商店]识别<span class="italic">keystore_password</span> ] WITH BACKUP [使用' <span class="italic">backup_identifier</span> '];</pre></td>
                                 <td align="left" valign="top" width="20%" headers="d36049e788 d36049e346 ">
                                    <p>-</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d36049e807" headers="d36049e342 ">
                                    <p>隔离PDB</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d36049e807 d36049e344 "><pre class="oac_no_warn" dir="ltr">ADMINISTER IDENTIFIED BY <span class="italic">isolated_keystore_password</span>从发根密钥库[FORCE密钥库] IDENTIFIED BY [外挂密钥管理密钥库ISOLATE | <span class="italic">united_keystore_password</span> ] WITH BACKUP [使用<span class="italic">backup_id</span> ];</pre></td>
                                 <td align="left" valign="top" width="20%" headers="d36049e807 d36049e346 ">
                                    <p>此操作执行两个操作。首先，它更改PDB的<code class="codeph">TDE_CONFIGURATION</code> ，使其处于隔离模式。其次，它将TDE主加密密钥和所有先前活动的（历史）TDE主加密密钥从CDB根的密钥库移动到新创建的具有其自己密码的PDB的密钥库，其中PDB将能够管理其自己的钥匙。
                                    </p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-ED5C479F-435F-47A5-AD96-8D874BEDA0AA" title="隔离模式使您可以为每个可插拔数据库（PDB）创建密钥库。">在隔离模式下管理密钥库和TDE主加密密钥</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-19DB3E40-3B80-4896-9A15-18B56477B38B" name="GUID-19DB3E40-3B80-4896-9A15-18B56477B38B"></a><h3 id="ASOAG-GUID-19DB3E40-3B80-4896-9A15-18B56477B38B" class="sect3">在隔离模式PDB中不允许的操作</h3>
               <div>
                  <p>有几种<code class="codeph">ADMINISTER KEY MANAGEMENT</code>操作无法在隔离模式PDB中执行。</p>
                  <div class="section">
                     <p>这些操作包括以下内容：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>使用<code class="codeph">CONTAINER = ALL</code>子句创建新的TDE主加密密钥，以便以后在每个可插拔数据库（PDB）中使用</p>
                        </li>
                        <li>
                           <p>将加密密钥从CDB根的密钥库移动到以隔离模式配置的PDB的密钥库中</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-ED5C479F-435F-47A5-AD96-8D874BEDA0AA" title="隔离模式使您可以为每个可插拔数据库（PDB）创建密钥库。">在隔离模式下管理密钥库和TDE主加密密钥</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-B3A669F2-5A75-405C-B319-83F0C3C168C5" name="GUID-B3A669F2-5A75-405C-B319-83F0C3C168C5"></a><h3 id="ASOAG-GUID-B3A669F2-5A75-405C-B319-83F0C3C168C5" class="sect3">配置隔离模式的密钥库位置和类型</h3>
               <div>
                  <p>对于隔离模式，可以仅使用参数或参数组合以及<code class="codeph">ALTER SYSTEM</code>语句来配置密钥库位置和类型。
                  </p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-73718328-B39B-4F2F-B6A5-137AA92D0FF6">配置隔离模式</a><br>您可以通过设置配置隔离模式<code class="codeph">WALLET_ROOT</code>在CDB根和初始化参数文件<code class="codeph">TDE_CONFIGURATION</code>要隔离在PDB。
                     </li>
                     <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-0BCDB4FA-1E9B-49E0-A4C3-92123EC970C8">示例：恢复较旧版本的控制文件</a><br>如果您具有必须还原的旧版本控制文件且仅在隔离模式下配置了少量PDB，则可以设置<code class="codeph">TDE_CONFIGURATION</code> 。
                     </li>
                     <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-1637E45A-36BA-4BC8-B9E3-581515A9AA1C">示例：解决丢失控制文件的问题</a><br>您可以使用<code class="codeph">ALTER SYSTEM</code>语句解决丢失控制文件的问题。
                     </li>
                     <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-6A8B03C4-B92F-4FA3-824C-D39D10439C4A">示例：在Oracle Real Application Clusters环境中配置隔离模式</a><br>您可以使用<code class="codeph">ALTER SYSTEM</code>在Oracle Real Application Clusters（Oracle RAC）环境中配置隔离模式。
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-ED5C479F-435F-47A5-AD96-8D874BEDA0AA" title="隔离模式使您可以为每个可插拔数据库（PDB）创建密钥库。">在隔离模式下管理密钥库和TDE主加密密钥</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="sect3"><a id="GUID-73718328-B39B-4F2F-B6A5-137AA92D0FF6" name="GUID-73718328-B39B-4F2F-B6A5-137AA92D0FF6"></a><h4 id="ASOAG-GUID-73718328-B39B-4F2F-B6A5-137AA92D0FF6" class="sect4">配置隔离模式</h4>
                  <div>
                     <p>您可以通过设置配置隔离模式<code class="codeph">WALLET_ROOT</code>在CDB根和初始化参数文件<code class="codeph">TDE_CONFIGURATION</code>要隔离在PDB。
                     </p>
                     <div class="section">
                        <p>为CDB环境配置<code class="codeph">WALLET_ROOT</code>和<code class="codeph">TDE_CONFIGURATION</code>参数的过程与用于配置联合模式的过程类似，除了使用<code class="codeph">ALTER SYSTEM</code>语句的<code class="codeph">RESET</code>子句，您使用<code class="codeph">SET</code>子句。您可以通过将<code class="codeph">WALLET_ROOT</code>和<code class="codeph">TDE_CONFIGURATION</code>参数添加到初始化参数文件来执行配置。要在隔离模式下配置PDB，必须为PDB的<code class="codeph">TDE_CONFIGURATION</code>参数设置一个值，您可以使用<code class="codeph">ALTER SYSTEM</code>语句或发出<code class="codeph">ADMINISTER KEY MANAGEMENT ISOLATE KEYSTORE</code>语句来执行该<code class="codeph">ADMINISTER KEY MANAGEMENT ISOLATE KEYSTORE</code> 。本节重点介绍<code class="codeph">ALTER SYSTEM</code>语句的使用。
                        </p>
                        <p>根据您的系统是使用pfile还是spfile，在为PDB设置<code class="codeph">TDE_CONFIGURATION</code>参数的值时，必须在<code class="codeph">ALTER SYSTEM</code>语句中适当地设置<code class="codeph">SCOPE</code>子句。 <code class="codeph">TDE_CONFIGURATION</code>参数的值是属性 - 值对的列表，它是<code class="codeph">KEYSTORE_CONFIGURATION</code>属性的值，用于指定密钥库的类型，如下所示：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">FILE</code>指定软件密钥库</p>
                           </li>
                           <li>
                              <p><code class="codeph">OKV</code>指定Oracle Key Vault硬件密钥库）</p>
                           </li>
                           <li>
                              <p><code class="codeph">HSM</code>指定硬件安全模块密钥库</p>
                           </li>
                           <li>
                              <p><code class="codeph">FILE|OKV</code>指定从<code class="codeph">OKV</code>密钥库类型到<code class="codeph">FILE</code>密钥库类型的反向迁移</p>
                           </li>
                           <li>
                              <p><code class="codeph">FILE|HSM</code>指定从<code class="codeph">HSM</code>密钥库类型到<code class="codeph">FILE</code>密钥库类型的反向迁移</p>
                           </li>
                           <li>
                              <p><code class="codeph">OKV|FILE</code>指定从<code class="codeph">FILE</code>密钥库类型到<code class="codeph">OKV</code>密钥库类型的迁移</p>
                           </li>
                           <li>
                              <p><code class="codeph">HSM|FILE</code>指定从<code class="codeph">FILE</code>密钥库类型到<code class="codeph">HSM</code>密钥库类型的迁移</p>
                           </li>
                        </ul>
                        <p>使用<code class="codeph">ALTER SYSTEM</code>为所选PDB配置<code class="codeph">TDE_CONFIGURATION</code>值后，CDB环境中的PDB处于隔离模式。此过程中的步骤详细说明了如何使用自己的密钥库类型将单个PDB配置为处于隔离模式。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li><span>以已被授予<code class="codeph">ADMINISTER KEY MANAGEMENT</code>或<code class="codeph">SYSKM</code>权限的用户身份连接到PDB。</span></li>
                        <li><span>运行<code class="codeph">ALTER SYSTEM</code>语句以配置CDB环境的<code class="codeph">WALLET_ROOT</code>和<code class="codeph">TDE_CONFIGURATION</code>参数。</span><ul>
                              <li>如果CDB根和PDB是开放的，然后设置<code class="codeph">SCOPE</code>以<code class="codeph">both</code> ：<pre class="oac_no_warn" dir="ltr">ALTER SYSTEM SET TDE_CONFIGURATION =“KEYSTORE_CONFIGURATION = <span class="italic">keystore_type</span> ”SCOPE = both;</pre></li>
                              <li>如果CDB根目录已打开且PDB处于装入状态，则将<code class="codeph">scope</code>设置为<code class="codeph">spfile</code> ：<pre class="oac_no_warn" dir="ltr">ALTER SYSTEM SET TDE_CONFIGURATION =“KEYSTORE_CONFIGURATION = <span class="italic">keystore_type</span> ”SCOPE = spfile;</pre></li>
                           </ul>
                        </li>
                        <li><span>检查配置。</span><ul>
                              <li>要检查<code class="codeph">TDE_CONFIGURATION</code>参数设置：<pre class="oac_no_warn" dir="ltr">显示参数TDE_CONFIGURATION</pre><p>输出应反映您为当前PDB设置的密钥库配置。如果它显示不同的密钥库配置（例如，如果已将其设置为<code class="codeph">OKV</code> ，则为<code class="codeph">FILE</code> ），则该设置可能显示在联合模式下为CDB根设置的密钥库配置。
                                 </p>
                              </li>
                              <li>要检查密钥库模式：<pre class="oac_no_warn" dir="ltr">从V $ ENCRYPTION_WALLET中选择KEYSTORE_MODE;</pre><p>输出应该是<code class="codeph">ISOLATED</code> 。</p>
                              </li>
                           </ul>
                        </li>
                     </ol>
                     <div class="section">配置隔离模式后，PDB处于联合模式时可用的CDB根密钥库不再可用于此PDB。在此阶段，PDB配置为使用其自己的密钥库。如果<code class="codeph">KEYSTORE_CONFIGURATION</code>参数为<code class="codeph">FILE</code> （表示PDB配置为使用软件密钥库），则为PDB配置的密钥库位置为<code class="codeph"><span class="codeinlineitalic">WALLET_ROOT</span> /PDB-GUID/tde</code> 。如果密钥库存在于该位置并且包含TDE主加密密钥，则该密钥仅对此PDB可用，而不对任何其他PDB可用。如果该位置不存在密钥库，您现在可以继续创建软件密钥库并设置TDE主加密密钥。如果您以后决定再次要求隔离模式PDB成为联合模式PDB，则可以使用<code class="codeph">ADMINISTER KEY MANAGEMENT UNITE KEYSTORE</code>语句。当您运行<code class="codeph">ADMINISTER KEY MANAGEMENT UNITE KEYSTORE</code> ，它会将密钥从PDB的密钥库移动到CDB根目录的密钥库，但它会留下任何客户端机密。因此，如果首先没有客户机密，那么它将使PDB的密钥库基本上“空”。它现在可以备份和删除。在删除密钥库之前始终备份密钥库，甚至是空的密钥库。
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="managing-keystores-encryption-keys-in-united-mode.html#GUID-3C9F5F0E-C5E2-4B9B-8CE8-CDB8B6750271" title="您可以通过在初始化参数文件中设置WALLET_ROOT和TDE_CONFIGURATION参数来配置联合模式。">通过编辑初始化参数文件配置联合模式</a></li>
                           <li><a href="managing-keystores-encryption-keys-in-united-mode.html#GUID-CD6E4741-4916-4F24-9427-4DA25DF40587" title="如果您的环境依赖于服务器参数文件（spfile）或参数文件（pfile），则可以使用带有SCOPE的ALTER SYSTEM设置TDE_CONFIGURATION。">使用初始化参数文件和ALTER SYSTEM配置联合模式</a></li>
                           <li><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-91E39FB9-025C-4653-AE42-B68D1F22798F" title="联合PDB密钥库将TDE主加密密钥从PDB密钥库移动到CDB根的密钥库中。这使得CDB根的密钥库的管理员能够管理密钥。">联合可插拔数据库密钥库</a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-B3A669F2-5A75-405C-B319-83F0C3C168C5" title="对于隔离模式，可以仅使用参数或参数组合以及ALTER SYSTEM语句来配置密钥库位置和类型。">配置隔离模式的密钥库位置和类型</a></p>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-0BCDB4FA-1E9B-49E0-A4C3-92123EC970C8" name="GUID-0BCDB4FA-1E9B-49E0-A4C3-92123EC970C8"></a><h4 id="ASOAG-GUID-0BCDB4FA-1E9B-49E0-A4C3-92123EC970C8" class="sect4">示例：恢复较旧版本的控制文件</h4>
                  <div>
                     <p>如果您具有必须还原的旧版本控制文件且仅在隔离模式下配置了少量PDB，则可以设置<code class="codeph">TDE_CONFIGURATION</code> 。
                     </p>
                     <p>当CDB根目录和PDB都处于装载状态时，您只能从CDB根目录更改PDB的密钥库配置。</p>
                     <ol>
                        <li>
                           <p>以授予<code class="codeph">SYSDBA</code>管理权限的用户身份登录CDB根目录。
                           </p>
                        </li>
                        <li>
                           <p>对于要更改的每个PDB，请使用以下语法：</p><pre class="oac_no_warn" dir="ltr">ALTER SYSTEM SET TDE_CONFIGURATION =“CONTAINER = <span class="italic">pdb_name</span> ; KEYSTORE_CONFIGURATION = <span class="italic">keystore_type</span> ”SCOPE = memory;</pre><p>例如，对于使用<code class="codeph">FILE</code> （对于软件密钥库）的<code class="codeph">hrpdb</code>和<code class="codeph">salespdb</code> PDB作为密钥库类型：</p><pre class="oac_no_warn" dir="ltr">ALTER SYSTEM SET TDE_CONFIGURATION =“CONTAINER = hrpdb; KEYSTORE_CONFIGURATION = FILE”SCOPE = memory; ALTER SYSTEM SET TDE_CONFIGURATION =“CONTAINER = salespdb; KEYSTORE_CONFIGURATION = FILE”SCOPE = memory;</pre></li>
                        <li>
                           <p>为每个PDB设置<code class="codeph">TDE_CONFIGURATION</code>参数后，登录CDB根目录，然后为CDB根目录设置<code class="codeph">TDE_CONFIGURATION</code> 。
                           </p><pre class="oac_no_warn" dir="ltr">ALTER SYSTEM SET TDE_CONFIGURATION =“KEYSTORE_CONFIGURATION = FILE”;</pre><p>在此阶段，CDB root处于挂载状态。使用带有<code class="codeph">CONTAINER</code>属性的<code class="codeph">ALTER SYSTEM</code>设置的<code class="codeph">TDE_CONFIGURATION</code>参数的值<code class="codeph">TDE_CONFIGURATION</code>在于CDB根目录的内存中。要确保将配置正确应用于每个PDB，您必须关闭然后重新打开PDB。打开隔离模式PDB时，将从控制文件中读取CDB根中发出的<code class="codeph">ALTER SYSTEM</code>语句设置的配置，然后自动应用于PDB。</p>
                        </li>
                        <li>
                           <p>连接到每个PDB，然后关闭并重新打开PDB。</p><pre class="oac_no_warn" dir="ltr">ALTER PLUGGABLE DATABASE <span class="italic">pdb_name</span> CLOSE IMMEDIATE; ALTER PLUGGABLE DATABASE <span class="italic">pdb_name</span> OPEN;</pre></li>
                     </ol>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-B3A669F2-5A75-405C-B319-83F0C3C168C5" title="对于隔离模式，可以仅使用参数或参数组合以及ALTER SYSTEM语句来配置密钥库位置和类型。">配置隔离模式的密钥库位置和类型</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-1637E45A-36BA-4BC8-B9E3-581515A9AA1C" name="GUID-1637E45A-36BA-4BC8-B9E3-581515A9AA1C"></a><h4 id="ASOAG-GUID-1637E45A-36BA-4BC8-B9E3-581515A9AA1C" class="sect4">示例：解决丢失控制文件的问题</h4>
                  <div>
                     <p>您可以使用<code class="codeph">ALTER SYSTEM</code>语句解决丢失控制文件的问题。
                     </p>
                     <p>在<code class="codeph">SCOPE</code>设置为memory的情况下运行这些语句会将<code class="codeph">CONTAINER</code>值存储在内存中。打开隔离的PDB时，将自动为PDB更新此配置。</p>
                     <p>如果您使用的是Oracle Data Guard环境，那么要更正控制文件，请在主数据库和备用数据库上运行这些语句。</p>
                     <ol>
                        <li>
                           <p>以授予<code class="codeph">SYSDBA</code>管理权限的用户身份登录CDB根目录。
                           </p>
                        </li>
                        <li>
                           <p>如果您不确定系统的确切状态，那么您应该使用<code class="codeph">RESET</code>运行<code class="codeph">ALTER SYSTEM</code> 。</p>
                           <p>例如：</p><pre class="oac_no_warn" dir="ltr">ALTER SYSTEM RESET TDE_CONFIGURATION SCOPE = memory;</pre></li>
                        <li>
                           <p>对于要更改的每个PDB，请使用以下语法：</p><pre class="oac_no_warn" dir="ltr">ALTER SYSTEM SET TDE_CONFIGURATION =“CONTAINER = <span class="italic">pdb_name</span> ; KEYSTORE_CONFIGURATION = FILE”SCOPE = memory;</pre><p>例如，对于具有<code class="codeph">FILE</code> （用于软件密钥库）的<code class="codeph">hrpdb</code>和<code class="codeph">salespdb</code> PDB作为密钥库类型：</p><pre class="oac_no_warn" dir="ltr">ALTER SYSTEM SET TDE_CONFIGURATION =“CONTAINER = hrpdb; KEYSTORE_CONFIGURATION = FILE”SCOPE = memory; ALTER SYSTEM SET TDE_CONFIGURATION =“CONTAINER = salespdb; KEYSTORE_CONFIGURATION = FILE”SCOPE = memory;</pre></li>
                        <li>
                           <p>为每个PDB设置<code class="codeph">TDE_CONFIGURATION</code>参数后，登录CDB根目录，然后为CDB根目录设置<code class="codeph">TDE_CONFIGURATION</code> 。
                           </p><pre class="oac_no_warn" dir="ltr">ALTER SYSTEM SET TDE_CONFIGURATION =“KEYSTORE_CONFIGURATION = FILE”;</pre><p>在此阶段，CDB root处于挂载状态。使用带有<code class="codeph">CONTAINER</code>属性的<code class="codeph">ALTER SYSTEM</code>设置的<code class="codeph">TDE_CONFIGURATION</code>参数的值<code class="codeph">TDE_CONFIGURATION</code>在于CDB根目录的内存中。要确保将配置正确应用于每个PDB，您必须关闭然后重新打开PDB。打开隔离模式PDB时，将从控制文件中读取CDB根中发出的<code class="codeph">ALTER SYSTEM</code>语句设置的配置，然后自动应用于PDB。</p>
                        </li>
                        <li>
                           <p>连接到每个PDB，然后关闭并重新打开PDB。</p><pre class="oac_no_warn" dir="ltr">ALTER PLUGGABLE DATABASE <span class="italic">pdb_name</span> CLOSE IMMEDIATE; ALTER PLUGGABLE DATABASE <span class="italic">pdb_name</span> OPEN;</pre></li>
                     </ol>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-B3A669F2-5A75-405C-B319-83F0C3C168C5" title="对于隔离模式，可以仅使用参数或参数组合以及ALTER SYSTEM语句来配置密钥库位置和类型。">配置隔离模式的密钥库位置和类型</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-6A8B03C4-B92F-4FA3-824C-D39D10439C4A" name="GUID-6A8B03C4-B92F-4FA3-824C-D39D10439C4A"></a><h4 id="ASOAG-GUID-6A8B03C4-B92F-4FA3-824C-D39D10439C4A" class="sect4">示例：在Oracle Real Application Clusters环境中配置隔离模式</h4>
                  <div>
                     <p>您可以使用<code class="codeph">ALTER SYSTEM</code>在Oracle Real Application Clusters（Oracle RAC）环境中配置隔离模式。
                     </p>
                     <ol>
                        <li>
                           <p>为了确保的效果<code class="codeph">ALTER SYSTEM</code>语句每个Oracle RAC节点上施加，指定通配符（ <code class="codeph">*</code>中） <code class="codeph">SID</code>的条款<code class="codeph">ALTER SYSTEM</code>语句，如下所示。您可以从CDB根目录或PDB运行此语句。</p><pre class="oac_no_warn" dir="ltr">ALTER SYSTEM SET TDE_CONFIGURATION =“KEYSTORE_CONFIGURATION = <span class="italic">keystore_type</span> ”SID ='*';</pre></li>
                        <li>
                           <p>如果在CDB根目录中运行此语句，则重新启动数据库。如果您从PDB执行它，则关闭并打开PDB。</p>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-B3A669F2-5A75-405C-B319-83F0C3C168C5" title="对于隔离模式，可以仅使用参数或参数组合以及ALTER SYSTEM语句来配置密钥库位置和类型。">配置隔离模式的密钥库位置和类型</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
            <div class="sect2"><a id="GUID-436F9034-B6B2-4AC8-8BD1-478B995E9F08" name="GUID-436F9034-B6B2-4AC8-8BD1-478B995E9F08"></a><h3 id="ASOAG-GUID-436F9034-B6B2-4AC8-8BD1-478B995E9F08" class="sect3">在隔离模式下配置密钥库和TDE主加密密钥</h3>
               <div>
                  <p>在隔离模式下，软件密钥库与PDB相关联。</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-AAFE29E8-6F56-4E3A-BBFA-82C273866E5C">关于在隔离模式下配置软件密钥库</a><br>您可以在隔离模式下创建所有类型的软件密钥库：受密码保护，使用外部存储提供的凭据进行密码保护，自动登录，本地自动登录。
                     </li>
                     <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-676DFDCD-1DC5-4B3B-B3C4-445CD98CB4A9">步骤1：在隔离模式下配置的PDB中创建软件密钥库</a><br>受密码保护的软件密钥库需要密码来保护密钥库密钥和凭据。
                     </li>
                     <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-E97BBAFD-25DA-4D6E-B86C-8E567229DCA9">步骤2：在隔离模式PDB中打开软件密钥库</a><br>要以隔离模式打开软件密钥库，必须将<code class="codeph">ADMINISTER KEY MANAGEMENT</code>语句与<code class="codeph">SET KEYSTORE OPEN</code>子句一起使用。
                     </li>
                     <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-998AEEE6-354E-4064-A547-F093BB312553">步骤3：在隔离模式PDB的软件密钥库中设置TDE主加密密钥</a><br>要在隔离模式PDB中的软件密钥库中设置TDE主加密密钥，请使用<code class="codeph">ADMINISTER KEY MANAGEMENT</code>语句和<code class="codeph">SET KEY</code>子句。
                     </li>
                     <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-292F1850-A8B0-4DA0-B208-1D8FA0645E08">第4步：以隔离模式加密数据</a><br>现在您已完成密钥库配置并且PDB以隔离模式配置，您可以开始加密PDB中的数据。</li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-ED5C479F-435F-47A5-AD96-8D874BEDA0AA" title="隔离模式使您可以为每个可插拔数据库（PDB）创建密钥库。">在隔离模式下管理密钥库和TDE主加密密钥</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="sect3"><a id="GUID-AAFE29E8-6F56-4E3A-BBFA-82C273866E5C" name="GUID-AAFE29E8-6F56-4E3A-BBFA-82C273866E5C"></a><h4 id="ASOAG-GUID-AAFE29E8-6F56-4E3A-BBFA-82C273866E5C" class="sect4">关于在隔离模式下配置软件密钥库</h4>
                  <div>
                     <p>您可以在隔离模式下创建所有类型的软件密钥库：受密码保护，使用外部存储提供的凭据进行密码保护，自动登录，本地自动登录。</p>
                     <p>要在PDB中以<code class="codeph">KEYSTORE_CONFIGURATION</code>属性设置为<code class="codeph">FILE</code> （即使用软件密钥库）进行隔离模式配置后启用加密，必须创建软件密钥库，打开软件密钥库，然后设置TDE主加密密钥在软件密钥库中。之后，您可以开始加密可在PDB中访问的表和表空间的数据。</p>
                     <p>在多租户环境中，您可以创建安全的外部存储来保存软件密钥库的凭据。此功能使您可以隐藏密钥库密码：它无需将密钥库密码存储在任何访问数据库而无需用户干预的脚本或工具中，例如隔夜批处理脚本。指定<code class="codeph">WALLET_ROOT</code>参数时，CDB根目录的外部存储位置为<code class="codeph"><span class="codeinlineitalic">WALLET_ROOT</span> /tde_seps</code> ，PDB的位置为<code class="codeph"><span class="codeinlineitalic">WALLET_ROOT</span> /PDB-GUID/tde_seps</code> 。设置<code class="codeph">WALLET_ROOT</code>参数后，不再有单个中央外部存储，因此更新密钥库密码时，也必须更新相应的外部存储。如果未指定<code class="codeph">WALLET_ROOT</code>参数，则外部存储的位置对于CDB根和每个PDB都是相同的。然后必须通过<code class="codeph">EXTERNAL_KEYSTORE_CREDENTIAL_LOCATION</code>初始化参数设置外部存储位置。如果未指定<code class="codeph">WALLET_ROOT</code>参数，则只有一个中央外部存储，因此在更新密钥库密码时，只能更新<code class="codeph">EXTERNAL_KEYSTORE_CREDENTIAL_LOCATION</code>处的中央外部存储。
                     </p>
                     <p>在多租户环境中，当您使用<code class="codeph">IDENTIFIED BY EXTERNAL STORE</code>子句运行<code class="codeph">ADMINISTER KEY MANAGEMENT</code>语句时，不同的PDB可以访问此外部存储位置。这样，您可以集中找到密码，然后在外部存储中只更新一次。
                     </p>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="managing-keystore-and-tde-master-encryption-key.html#GUID-4F6206B6-A33F-4FB1-9223-DD61FFAD3F12" title="密钥库密码的外部存储将密钥库密码存储在集中访问和管理的位置。">为密钥库密码配置外部存储</a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-436F9034-B6B2-4AC8-8BD1-478B995E9F08" title="在隔离模式下，软件密钥库与PDB相关联。">在隔离模式下配置密钥库和TDE主加密密钥</a></p>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-676DFDCD-1DC5-4B3B-B3C4-445CD98CB4A9" name="GUID-676DFDCD-1DC5-4B3B-B3C4-445CD98CB4A9"></a><h4 id="ASOAG-GUID-676DFDCD-1DC5-4B3B-B3C4-445CD98CB4A9" class="sect4">步骤1：在隔离模式下配置的PDB中创建软件密钥库</h4>
                  <div>
                     <p>受密码保护的软件密钥库需要密码来保护密钥库密钥和凭据。</p>
                     <ol>
                        <li class="stepexpand"><span>以已被授予<code class="codeph">ADMINISTER KEY MANAGEMENT</code>或<code class="codeph">SYSKM</code>权限的用户身份登录到隔离模式PDB。</span><div>例如：<pre class="oac_no_warn" dir="ltr">sqlplus sec_admin @hrpdb as syskm输入密码： <span class="italic">password</span></pre><p>请联系您的<code class="codeph">SYSDBA</code>管理员以获取正确的PDB。要检查当前容器，请运行<code class="codeph">SHOW CON_NAME</code>命令。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>运行<code class="codeph">ADMINISTER KEY MANAGEMENT</code> SQL语句以使用以下语法创建密钥库：</span><div><pre class="oac_no_warn" dir="ltr">ADMINISTER密钥管理CREATE KEYSTORE [' <span class="italic">keystore_location</span> ']通过<span class="italic">software_keystore_password</span>标识;</pre><p>在本规范中：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><span class="italic"><code class="codeph">keystore_location</code></span>是受密码保护的密钥库的密钥库目录位置的路径。如果<code class="codeph">WALLET_ROOT</code>参数设置的路径是您要使用的路径，则可以省略<span class="italic"><code class="codeph">keystore_location</code></span>设置。
                                    </p>
                                    <p>如果指定<span class="italic"><code class="codeph">keystore_location</code></span> ，则将其用单引号（ <code class="codeph">' '</code> ）括起来。要查找此位置，可以查询<code class="codeph">V$ENCRYPTION_WALLET</code>视图的<code class="codeph">WRL_PARAMETER</code>列。（如果未在默认位置创建密钥库，则<code class="codeph">V$ENCRYPTION_WALLET</code>视图的<code class="codeph">STATUS</code> <code class="codeph">NOT_AVAILABLE</code> 。）
                                    </p>
                                 </li>
                                 <li>
                                    <p><span class="italic"><code class="codeph">software_keystore_password</code></span>是您（安全管理员）创建的密钥库的密码。
                                    </p>
                                 </li>
                              </ul>
                              <p>例如，要在默认位置创建密钥库（假设已设置<code class="codeph">WALLET_ROOT</code> ）：</p><pre class="oac_no_warn" dir="ltr">管理员密钥管理创建由<span class="italic">密码</span>识别的<span class="italic">密钥</span> ;密钥库已更改。
</pre></div>
                        </li>
                     </ol>
                     <div class="section">完成这些步骤后， <code class="codeph">ewallet.p12</code>文件（即密钥库）将显示在已配置的<code class="codeph">WALLET_ROOT</code>下的默认密钥库位置中。例如，如果您已将<code class="codeph">WALLET_ROOT</code>参数设置为<code class="codeph">$ORACLE_BASE/wallet</code>并将<code class="codeph">TDE_CONFIGURATION</code>参数设置为<code class="codeph">FILE</code> （表示为处于隔离模式的PDB配置了软件密钥库），则将创建PDB的密钥库。 <code class="codeph">$ORACLE_BASE/wallet/PDB-GUID/tde</code>目录。
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-436F9034-B6B2-4AC8-8BD1-478B995E9F08" title="在隔离模式下，软件密钥库与PDB相关联。">在隔离模式下配置密钥库和TDE主加密密钥</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-E97BBAFD-25DA-4D6E-B86C-8E567229DCA9" name="GUID-E97BBAFD-25DA-4D6E-B86C-8E567229DCA9"></a><h4 id="ASOAG-GUID-E97BBAFD-25DA-4D6E-B86C-8E567229DCA9" class="sect4">步骤2：在隔离模式PDB中打开软件密钥库</h4>
                  <div>
                     <p>要以隔离模式打开软件密钥库，必须将<code class="codeph">ADMINISTER KEY MANAGEMENT</code>语句与<code class="codeph">SET KEYSTORE OPEN</code>子句一起使用。
                     </p>
                     <ol>
                        <li class="stepexpand"><span>以已被授予<code class="codeph">ADMINISTER KEY MANAGEMENT</code>或<code class="codeph">SYSKM</code>权限的用户身份登录到隔离模式PDB。</span><div>
                              <p>请联系您的<code class="codeph">SYSDBA</code>管理员以获取正确的PDB。要检查当前容器，请运行<code class="codeph">SHOW CON_NAME</code>命令。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>运行<code class="codeph">ADMINISTER KEY MANAGEMENT</code>语句以打开密钥库。</span><div><pre class="oac_no_warn" dir="ltr">ADMINISTER KEY MANAGEMENT SET KEYSTORE OPEN由<span class="italic">密码</span>识别;密钥库已更改。</pre><p>要在配置自动登录密钥库并且当前处于打开状态时切换到打开受密码保护的软件密钥库，请按如下所示指定<code class="codeph">FORCE KEYSTORE</code>子句。
                              </p><pre class="oac_no_warn" dir="ltr">管理员密钥管理设置KEYSTORE OPEN FORCE KEYORE由外部商店识别;密钥库已更改。</pre><p>此处， <code class="codeph">IDENTIFIED BY EXTERNAL STORE</code>子句包含在语句中，因为密钥库凭据存在于外部存储中。这样可以打开受密码保护的密钥库，而无需在语句本身中指定密钥库密码。
                              </p>
                              <p>如果已设置<code class="codeph">WALLET_ROOT</code>参数，则Oracle数据库通过在此路径中搜索来查找外部存储： <code class="codeph"><span class="codeinlineitalic">WALLET_ROOT</span> / <span class="codeinlineitalic">PDB_GUID</span> /tde_seps</code> 。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>确认密钥库已打开。</span><div><pre class="oac_no_warn" dir="ltr">从V $ ENCRYPTION_WALLET中选择状态;</pre></div>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="configuring-transparent-data-encryption.html#GUID-F3652F6F-B1B8-485A-BCBE-32C0875E93E5" title="必须先打开受密码保护的软件密钥库，然后才能在密钥库中创建或访问任何TDE主加密密钥。">关于打开软件密钥库</a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-436F9034-B6B2-4AC8-8BD1-478B995E9F08" title="在隔离模式下，软件密钥库与PDB相关联。">在隔离模式下配置密钥库和TDE主加密密钥</a></p>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-998AEEE6-354E-4064-A547-F093BB312553" name="GUID-998AEEE6-354E-4064-A547-F093BB312553"></a><h4 id="ASOAG-GUID-998AEEE6-354E-4064-A547-F093BB312553" class="sect4">步骤3：在隔离模式PDB的软件密钥库中设置TDE主加密密钥</h4>
                  <div>
                     <p>要在隔离模式PDB中的软件密钥库中设置TDE主加密密钥，请使用<code class="codeph">ADMINISTER KEY MANAGEMENT</code>语句和<code class="codeph">SET KEY</code>子句。
                     </p>
                     <ol>
                        <li class="stepexpand"><span>以已被授予<code class="codeph">ADMINISTER KEY MANAGEMENT</code>或<code class="codeph">SYSKM</code>权限的用户身份登录到隔离模式PDB。</span></li>
                        <li class="stepexpand"><span>确保数据库在<code class="codeph">READ WRITE</code>模式下打开。</span><div>要查找状态，请运行<code class="codeph">show pdbs</code>命令。
                           </div>
                        </li>
                        <li class="stepexpand"><span>运行<code class="codeph">ADMINISTER KEY MANAGEMENT</code> SQL语句以在软件密钥库中设置密钥。</span><div>例如，如果PDB的密钥库受密码保护，则PDB处于打开状态，并且PDB的密钥库已打开：<pre class="oac_no_warn" dir="ltr">通过<span class="italic">keystore_password</span>使用'emp_key_backup'和BACKUP来识别的ADMINISTER密钥管理集<span class="italic">密钥</span> ;密钥库已更改。</pre><p>如果密钥库已关闭：</p><pre class="oac_no_warn" dir="ltr">ADMINISTER密钥管理设置密钥强制关键字由<span class="italic">keystore_password</span>标识，带有备份使用'emp_key_backup';密钥库已更改。</pre><p>在本规范中：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>如果密钥库已关闭，则应包括<code class="codeph">FORCE KEYSTORE</code> 。这会在设置TDE主加密密钥之前自动打开密钥库。当配置自动登录密钥库并且当前打开时， <code class="codeph">FORCE KEYSTORE</code>子句还会切换到打开受密码保护的软件密钥库。
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">IDENTIFIED BY</code>指定密钥库密码。或者，如果密钥库密码位于外部存储中，则可以使用<code class="codeph">IDENTIFIED BY EXTERNAL STORE</code>子句。
                                    </p>
                                 </li>
                              </ul>
                           </div>
                        </li>
                        <li class="stepexpand"><span>确认已设置TDE主加密密钥。</span><div><pre class="oac_no_warn" dir="ltr">从V $ DATABASE_KEY_INFO中选择MASTERKEY_ACTIVATED;</pre><p>输出应为<code class="codeph">YES</code> 。</p>
                           </div>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="configuring-transparent-data-encryption.html#GUID-C44968C5-9B77-4D19-82F4-5705268BF429" title="TDE主加密密钥存储在密钥库中。">关于设置软件密钥库TDE主加密密钥</a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-436F9034-B6B2-4AC8-8BD1-478B995E9F08" title="在隔离模式下，软件密钥库与PDB相关联。">在隔离模式下配置密钥库和TDE主加密密钥</a></p>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-292F1850-A8B0-4DA0-B208-1D8FA0645E08" name="GUID-292F1850-A8B0-4DA0-B208-1D8FA0645E08"></a><h4 id="ASOAG-GUID-292F1850-A8B0-4DA0-B208-1D8FA0645E08" class="sect4">第4步：以隔离模式加密数据</h4>
                  <div>
                     <p>现在您已完成密钥库配置并且PDB以隔离模式配置，您可以开始加密PDB中的数据。</p>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="configuring-transparent-data-encryption.html#GUID-A0E2C279-10F6-48D9-AB92-C547529C06EE" title="您可以使用透明数据加密来加密数据库表中的各个列。">加密表中的列</a></li>
                           <li><a href="configuring-transparent-data-encryption.html#GUID-1CA947A5-164A-4AA9-AD75-F7D9D4F6FFF8" title="您可以在脱机和联机表空间和数据库上执行加密操作。">表空间和数据库的加密转换</a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-436F9034-B6B2-4AC8-8BD1-478B995E9F08" title="在隔离模式下，软件密钥库与PDB相关联。">在隔离模式下配置密钥库和TDE主加密密钥</a></p>
                        </div>
                     </div>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-8A38CB3C-91C4-42DC-84A1-A71091EF50D9" name="GUID-8A38CB3C-91C4-42DC-84A1-A71091EF50D9"></a><h3 id="ASOAG-GUID-8A38CB3C-91C4-42DC-84A1-A71091EF50D9" class="sect3">在隔离模式下配置硬件密钥库</h3>
               <div>
                  <p>Oracle数据库支持两种不同类型的硬件密钥库：硬件安全模块（ <code class="codeph">HSM</code> ）或Oracle Key Vault（ <code class="codeph">OKV</code> ）密钥库。
                  </p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-B51D971C-5D89-41AD-9AB3-53F4D15F7328">关于在隔离模式下配置硬件密钥库</a><br>在隔离模式下配置PDB时，可以为PDB配置硬件密钥库。
                     </li>
                     <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-406B6D67-E7A8-42D9-AD94-00273A353366">步骤1：为隔离模式PDB配置硬件安全模块</a><br>要配置第三方硬件安全模块，必须将供应商的PKCS＃11库复制到正确的位置，并按照供应商的说明进行操作。
                     </li>
                     <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-ED77939C-EAE6-402F-903B-3B4B2E52B3B3">步骤2：在隔离模式PDB中打开硬件密钥库</a><br>要在隔离模式PDB中打开硬件密钥库，必须将<code class="codeph">ADMINISTER KEY MANAGEMENT</code>语句与<code class="codeph">SET KEYSTORE OPEN</code>子句一起使用。
                     </li>
                     <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-E94F2D64-A741-4D51-BBC0-632AFB39117D">步骤3：在隔离模式下，在PDB的硬件密钥库中设置TDE主加密密钥</a><br>在隔离模式PDB中打开硬件密钥库后，您就可以为PDB设置TDE主加密密钥了。</li>
                     <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#unique_1553525171">第4步：以隔离模式加密数据</a><br>现在您已完成密钥库配置并且PDB以隔离模式配置，您可以开始加密PDB中的数据。</li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-ED5C479F-435F-47A5-AD96-8D874BEDA0AA" title="隔离模式使您可以为每个可插拔数据库（PDB）创建密钥库。">在隔离模式下管理密钥库和TDE主加密密钥</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="sect3"><a id="GUID-B51D971C-5D89-41AD-9AB3-53F4D15F7328" name="GUID-B51D971C-5D89-41AD-9AB3-53F4D15F7328"></a><h4 id="ASOAG-GUID-B51D971C-5D89-41AD-9AB3-53F4D15F7328" class="sect4">关于在隔离模式下配置硬件密钥库</h4>
                  <div>
                     <p>在隔离模式下配置PDB时，可以为PDB配置硬件密钥库。</p>
                     <p>要在隔离模式下为PDB配置硬件密钥库，首先必须设置<code class="codeph">WALLET_ROOT</code>参数。这有两个原因：第一，支持将来迁移到软件密钥库，第二，因为Oracle Key Vault的配置文件是从<code class="codeph">WALLET_ROOT</code>下的位置检索的。然后，必须将<code class="codeph">TDE_CONFIGURATION</code>参数的<code class="codeph">KEYSTORE_CONFIGURATION</code>属性设置为<code class="codeph">HSM</code>或<code class="codeph">OKV</code> ，打开配置的硬件密钥库，然后为PDB设置TDE主加密密钥。完成这些任务后，您可以开始加密PDB中的数据。</p>
                     <p>运行<code class="codeph">ADMINISTER KEY MANAGEMENT</code>语句时如何指定<code class="codeph">IDENTIFIED BY</code>子句取决于硬件密钥库的类型。对于硬件安全模块（ <code class="codeph">HSM</code> ），使用以下语法：</p><pre class="oac_no_warn" dir="ltr">由“ <span class="italic">user_name</span> ： <span class="italic">password</span> ”标识</pre><p>对于Oracle Key Vault密钥库，您可以省略<code class="codeph"><span class="codeinlineitalic">user_name</span></code>和冒号，但必须将密码括在引号中：</p><pre class="oac_no_warn" dir="ltr">通过“ <span class="italic">密码</span> ”识别</pre></div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-8A38CB3C-91C4-42DC-84A1-A71091EF50D9" title="Oracle数据库支持两种不同类型的硬件密钥库：硬件安全模块（HSM）或Oracle Key Vault（OKV）密钥库。">在隔离模式下配置硬件密钥库</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-406B6D67-E7A8-42D9-AD94-00273A353366" name="GUID-406B6D67-E7A8-42D9-AD94-00273A353366"></a><h4 id="ASOAG-GUID-406B6D67-E7A8-42D9-AD94-00273A353366" class="sect4">步骤1：为隔离模式PDB配置硬件安全模块</h4>
                  <div>
                     <p>要配置第三方硬件安全模块，必须将供应商的PKCS＃11库复制到正确的位置，并按照供应商的说明进行操作。</p>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="configuring-transparent-data-encryption.html#GUID-7838C4B8-FF6A-4B81-86C1-8583D3555291" title="要配置第三方硬件安全模块，必须将PKCS＃11库复制到正确的位置，并按照供应商的说明进行操作。">步骤2：配置硬件安全模块</a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-8A38CB3C-91C4-42DC-84A1-A71091EF50D9" title="Oracle数据库支持两种不同类型的硬件密钥库：硬件安全模块（HSM）或Oracle Key Vault（OKV）密钥库。">在隔离模式下配置硬件密钥库</a></p>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-ED77939C-EAE6-402F-903B-3B4B2E52B3B3" name="GUID-ED77939C-EAE6-402F-903B-3B4B2E52B3B3"></a><h4 id="ASOAG-GUID-ED77939C-EAE6-402F-903B-3B4B2E52B3B3" class="sect4">步骤2：在隔离模式PDB中打开硬件密钥库</h4>
                  <div>
                     <p>要在隔离模式PDB中打开硬件密钥库，必须将<code class="codeph">ADMINISTER KEY MANAGEMENT</code>语句与<code class="codeph">SET KEYSTORE OPEN</code>子句一起使用。
                     </p>
                     <ol>
                        <li class="stepexpand"><span>以已被授予<code class="codeph">ADMINISTER KEY MANAGEMENT</code>或<code class="codeph">SYSKM</code>权限的用户身份登录到隔离模式PDB。</span><div>例如：<pre class="oac_no_warn" dir="ltr">sqlplus sec_admin @hrpdb as syskm输入密码： <span class="italic">password</span></pre><p>请联系您的<code class="codeph">SYSDBA</code>管理员以获取正确的PDB。要检查当前容器，请运行<code class="codeph">SHOW CON_NAME</code>命令。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>使用以下语法打开硬件密钥库：</span><div><pre class="oac_no_warn" dir="ltr">ADMINISTER KEY MANAGEMENT SET KEYSTORE OPEN由“ <span class="italic">hardware_keystore_credentials</span> ”识别;</pre><p>硬件密钥库的类型决定了如何指定硬件密钥库密码。对于硬件安全模块，必须使用<code class="codeph"><span class="codeinlineitalic">user_name</span> : <span class="codeinlineitalic">password</span></code>语法。例如：</p><pre class="oac_no_warn" dir="ltr">ADMINISTER KEY MANAGEMENT SET KEYSTORE OPEN由“psmith： <span class="italic">password</span> ”识别;密钥库已更改。</pre><p>对于Oracle Key Vault密钥库，您只能提供密码。<code class="codeph">IDENTIFIED BY</code>子句中不允许使用用户名。用双引号括起密码。
                              </p><pre class="oac_no_warn" dir="ltr">ADMINISTER KEY MANAGEMENT SET KEYSTORE OPEN由“ <span class="italic">password</span> ”识别;</pre></div>
                        </li>
                        <li class="stepexpand"><span>每次重新启动数据库实例时重复此过程。</span><div>您必须首先打开CDB根目录的密钥库。</div>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="configuring-transparent-data-encryption.html#GUID-CEDB143A-BC7E-43EF-AD41-59BD0ED36421" title="必须先打开硬件密钥库，以便数据库可以访问它，然后才能执行任何加密或解密。">关于打开硬件密钥库</a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-8A38CB3C-91C4-42DC-84A1-A71091EF50D9" title="Oracle数据库支持两种不同类型的硬件密钥库：硬件安全模块（HSM）或Oracle Key Vault（OKV）密钥库。">在隔离模式下配置硬件密钥库</a></p>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-E94F2D64-A741-4D51-BBC0-632AFB39117D" name="GUID-E94F2D64-A741-4D51-BBC0-632AFB39117D"></a><h4 id="ASOAG-GUID-E94F2D64-A741-4D51-BBC0-632AFB39117D" class="sect4">步骤3：在隔离模式下，在PDB的硬件密钥库中设置TDE主加密密钥</h4>
                  <div>
                     <p>在隔离模式PDB中打开硬件密钥库后，您就可以为PDB设置TDE主加密密钥了。</p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-749AECD4-9DBB-4D1E-A526-B3AC5659A653">在隔离模式下设置新的TDE主加密密钥</a><br>如果以前没有为透明数据加密配置硬件密钥库，则应完成此过程。
                        </li>
                        <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-3A03BE98-A3DC-40AA-8181-0DFF3A8B1FD9">在隔离模式下迁移先前配置的加密密钥</a><br>如果先前已配置软件密钥库，则必须迁移先前配置的主加密密钥。
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-8A38CB3C-91C4-42DC-84A1-A71091EF50D9" title="Oracle数据库支持两种不同类型的硬件密钥库：硬件安全模块（HSM）或Oracle Key Vault（OKV）密钥库。">在隔离模式下配置硬件密钥库</a></p>
                        </div>
                     </div>
                  </div>
                  
                  <div class="sect4"><a id="GUID-749AECD4-9DBB-4D1E-A526-B3AC5659A653" name="GUID-749AECD4-9DBB-4D1E-A526-B3AC5659A653"></a><h5 id="ASOAG-GUID-749AECD4-9DBB-4D1E-A526-B3AC5659A653" class="sect5">在隔离模式下设置新的TDE主加密密钥</h5>
                     <div>
                        <p>如果以前没有为透明数据加密配置硬件密钥库，则应完成此过程。</p>
                        <ol>
                           <li class="stepexpand"><span>以已被授予<code class="codeph">ADMINISTER KEY MANAGEMENT</code>或<code class="codeph">SYSKM</code>权限的用户身份登录到隔离模式PDB。</span><div>
                                 <p>请联系您的<code class="codeph">SYSDBA</code>管理员以获取正确的PDB。要检查当前容器，请运行<code class="codeph">SHOW CON_NAME</code>命令。
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>确保数据库在<code class="codeph">READ WRITE</code>模式下打开。</span><div>如果<code class="codeph">OPEN_MODE</code>设置为<code class="codeph">READ WRITE</code>则可以设置TDE主加密密钥。要查找状态，请运行<code class="codeph">show pdbs</code>命令。
                              </div>
                           </li>
                           <li class="stepexpand"><span>使用以下语法设置新的TDE主加密密钥：</span><div><pre class="oac_no_warn" dir="ltr">管理员密钥管理集密钥[使用标记' <span class="italic">标记</span> '] [FORCE KEYSTORE]由[EXTERNAL STORE | “ <span class="italic">hardware_keystore_credentials</span> ”];</pre><p>在本规范中：</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p>如果在配置了自动登录密钥库且当前处于打开状态时密钥库已关闭，或者如果配置了密码保护密钥库且当前已关闭，则<code class="codeph">FORCE KEYSTORE</code>暂时打开此操作的受密码保护的密钥库。
                                       </p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">IDENTIFIED BY</code>可以是以下设置之一：</p>
                                       <ul style="list-style-type:disc">
                                          <li>
                                             <p><code class="codeph">EXTERNAL STORE</code>使用存储在外部存储中的密钥库密码来执行密钥库操作。
                                             </p>
                                          </li>
                                          <li>
                                             <p><code class="codeph"><span class="codeinlineitalic">hardware_keystore_credentials</span></code>是指HSM或Oracle Key Vault硬件密钥库的凭据。对于HSM，请使用此格式指定凭据，用引号括起并用冒号分隔组件： <code class="codeph">“ <span class="codeinlineitalic">user_name</span> : <span class="codeinlineitalic">password</span> ”</code> ，其中<code class="codeph"><span class="codeinlineitalic">user_name</span></code>是创建HSM的用户，密码是此用户的密码。对于Oracle Key Vault，仅输入创建密钥库的用户的密码。用引号括起此密码。
                                             </p>
                                          </li>
                                       </ul>
                                    </li>
                                 </ul>
                                 <p>例如：</p><pre class="oac_no_warn" dir="ltr">管理员密钥管理设置密钥由“psmith： <span class="italic">password</span> ”标识;密钥库已更改。</pre></div>
                           </li>
                           <li class="stepexpand"><span>确认已设置TDE主加密密钥。</span><div><pre class="oac_no_warn" dir="ltr">从V $ DATABASE_KEY_INFO中选择MASTERKEY_ACTIVATED;</pre><p>输出应为<code class="codeph">YES</code> 。</p>
                              </div>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>相关话题</strong></p>
                           <ul>
                              <li><a href="configuring-transparent-data-encryption.html#GUID-E3DC7C57-A8F3-41D5-98FB-1DBE6EE10D1E" title="您必须创建存储在硬件密钥库中的TDE主加密密钥。">关于设置硬件密钥库TDE主加密密钥</a></li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-E94F2D64-A741-4D51-BBC0-632AFB39117D" title="在隔离模式PDB中打开硬件密钥库后，您就可以为PDB设置TDE主加密密钥了。">步骤3：在隔离模式下，在PDB的硬件密钥库中设置TDE主加密密钥</a></p>
                           </div>
                        </div>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-3A03BE98-A3DC-40AA-8181-0DFF3A8B1FD9" name="GUID-3A03BE98-A3DC-40AA-8181-0DFF3A8B1FD9"></a><h5 id="ASOAG-GUID-3A03BE98-A3DC-40AA-8181-0DFF3A8B1FD9" class="sect5">在隔离模式下迁移先前配置的加密密钥</h5>
                     <div>
                        <p>如果先前已配置软件密钥库，则必须迁移先前配置的主加密密钥。</p>
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>相关话题</strong></p>
                           <ul>
                              <li><a href="configuring-transparent-data-encryption.html#GUID-5CDB2D10-81DE-4C98-9F9C-155C45E31CDB" title="如果先前已配置软件密钥库，则必须迁移先前配置的TDE主加密密钥。">迁移先前配置的TDE主加密密钥</a></li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-E94F2D64-A741-4D51-BBC0-632AFB39117D" title="在隔离模式PDB中打开硬件密钥库后，您就可以为PDB设置TDE主加密密钥了。">步骤3：在隔离模式下，在PDB的硬件密钥库中设置TDE主加密密钥</a></p>
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="unique_1553525171" name="unique_1553525171"></a><h4 id="ASOAG-unique_1553525171" class="sect4">第4步：以隔离模式加密数据</h4>
                  <div>
                     <p>现在您已完成密钥库配置并且PDB以隔离模式配置，您可以开始加密PDB中的数据。</p>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="configuring-transparent-data-encryption.html#GUID-A0E2C279-10F6-48D9-AB92-C547529C06EE" title="您可以使用透明数据加密来加密数据库表中的各个列。">加密表中的列</a></li>
                           <li><a href="configuring-transparent-data-encryption.html#GUID-1CA947A5-164A-4AA9-AD75-F7D9D4F6FFF8" title="您可以在脱机和联机表空间和数据库上执行加密操作。">表空间和数据库的加密转换</a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-8A38CB3C-91C4-42DC-84A1-A71091EF50D9" title="Oracle数据库支持两种不同类型的硬件密钥库：硬件安全模块（HSM）或Oracle Key Vault（OKV）密钥库。">在隔离模式下配置硬件密钥库</a></p>
                        </div>
                     </div>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-B6EBC385-D014-43AA-B9DE-DF08F2082712" name="GUID-B6EBC385-D014-43AA-B9DE-DF08F2082712"></a><h3 id="ASOAG-GUID-B6EBC385-D014-43AA-B9DE-DF08F2082712" class="sect3">在隔离模式下管理密钥库和TDE主加密密钥</h3>
               <div>
                  <p>在隔离模式下创建密钥库和TDE主加密密钥后，您可以执行管理任务，例如重新加密或标记加密密钥。</p>
                  <p>要更改硬件密钥库的密码，必须使用硬件密钥库的管理界面。您无法使用<code class="codeph">ADMINISTER KEY MANAGEMENT</code>语句执行此操作。
                  </p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-B88A9733-EF15-4B8F-BD92-3947EA6D5CF6">在隔离模式下更改密钥库密码</a><br>当PDB处于隔离模式时，您可以更改软件密钥库的密码。
                     </li>
                     <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-4044CC16-806E-4681-ADB5-41BAD4CAA04B">在隔离模式下备份受密码保护的软件密钥库</a><br><code class="codeph">ADMINISTER KEY MANAGEMENT</code>语句的<code class="codeph">BACKUP KEYSTORE</code>子句备份受密码保护的软件密钥库。
                     </li>
                     <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-D2869448-212E-44CB-8BAA-2A337369DFCD">在隔离模式下合并软件密钥库</a><br>在隔离模式下，您可以合并软件密钥库。
                     </li>
                     <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-04650B68-D7CE-431A-9942-9F7496360FC0">以隔离模式关闭密钥库</a><br>除非系统表空间已加密，否则您可以在隔离模式下关闭软件和硬件密钥库。
                     </li>
                     <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-92CFFF56-C4C6-471B-9DFB-1CC9CB5FE3FD">在隔离模式下创建用户定义的TDE主加密密钥</a><br>要创建用户定义的TDE主加密密钥，请使用<code class="codeph">ADMINISTER KEY MANAGEMENT</code>语句和<code class="codeph">SET | CREATE [ENCRYPTION] KEY</code>子句。
                     </li>
                     <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-D5A0169C-CB0B-43CB-9721-3BAF1A851C55">创建TDE主加密密钥，以便以后在隔离模式下使用</a><br>必须先打开密钥库，然后才能创建TDE主加密密钥，以便以后在隔离模式下使用。
                     </li>
                     <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-A89BB885-B46C-4A86-B55E-29DB08A4FCB2">在隔离模式下激活TDE主加密密钥</a><br>要在隔离模式下激活TDE主加密密钥，必须打开密钥库并使用<code class="codeph">ADMINISTER KEY MANAGEMENT</code>和<code class="codeph">USE KEY</code>子句。
                     </li>
                     <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-1BC74A51-2930-4B07-880F-0EC761351A22">在隔离模式下更新TDE主加密密钥</a><br>您可以将<code class="codeph">ADMINISTER KEY MANAGEMENT</code>语句与<code class="codeph">SET KEY</code>子句一起使用，以重新生成TDE主加密密钥。
                     </li>
                     <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-5F84010F-F74C-41FC-900F-741185B29AA0">在隔离模式下将TDE主加密密钥移动到新密钥库中</a><br>在隔离模式下，您可以将现有TDE主加密密钥从现有软件密码密钥库移动到新密钥库中。
                     </li>
                     <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-3178B6A8-E950-479A-B5E1-500F8FF56C7A">在隔离模式下创建自定义属性标记</a><br>要在隔离模式下创建自定义属性标记，必须使用<code class="codeph">ADMINISTER KEY MANAGEMENT</code>语句的<code class="codeph">SET TAG</code>子句。
                     </li>
                     <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-D678DC98-E77C-4F5D-8E5C-45D5FED0A5AF">在隔离模式下导出和导入TDE主加密密钥</a><br>您可以在隔离模式下以不同方式导出和导入TDE主加密密钥。
                     </li>
                     <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-F7052961-ECD0-4AD5-BC14-5E0715C9DE33">以隔离模式存储Oracle数据库秘密</a><br>秘密是支持内部Oracle数据库功能的数据，这些功能将外部客户端（如Oracle GoldenGate）集成到数据库中。
                     </li>
                     <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-0E28EE78-196D-424C-B861-2CDC2181C40A">以隔离模式迁移密钥库</a><br>您可以在隔离模式下在软件密钥库和硬件密钥库之间执行迁移和反向迁移操作。
                     </li>
                     <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-717E6E9A-CC84-493F-B5C4-675729DC6ECE">在隔离模式下自动删除不活动的TDE主加密密钥</a><br>在隔离模式下， <code class="codeph">REMOVE_INACTIVE_STANDBY_TDE_MASTER_KEY</code>初始化参数可以配置自动删除非活动主加密密钥。
                     </li>
                     <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-91E39FB9-025C-4653-AE42-B68D1F22798F">联合可插拔数据库密钥库</a><br>联合PDB密钥库将TDE主加密密钥从PDB密钥库移动到CDB根的密钥库中。这使得CDB根的密钥库的管理员能够管理密钥。
                     </li>
                     <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-7B39A544-0B5D-4BE5-9D33-33F0D74D72DD">PDB关闭时创建密钥库</a><br>在已关闭的PDB中创建密钥库时，新密钥库为空，PDB将转换为隔离模式。
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-ED5C479F-435F-47A5-AD96-8D874BEDA0AA" title="隔离模式使您可以为每个可插拔数据库（PDB）创建密钥库。">在隔离模式下管理密钥库和TDE主加密密钥</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="sect3"><a id="GUID-B88A9733-EF15-4B8F-BD92-3947EA6D5CF6" name="GUID-B88A9733-EF15-4B8F-BD92-3947EA6D5CF6"></a><h4 id="ASOAG-GUID-B88A9733-EF15-4B8F-BD92-3947EA6D5CF6" class="sect4">在隔离模式下更改密钥库密码</h4>
                  <div>
                     <p>当PDB处于隔离模式时，您可以更改软件密钥库的密码。</p>
                     <p>要更改硬件密钥库的密码，必须使用硬件密钥库的管理界面。您无法使用<code class="codeph">ADMINISTER KEY MANAGEMENT</code>语句执行此操作。
                     </p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-57297DAE-186B-4B7E-89FF-9EEB9C433CE8">在隔离模式下更改受密码保护的软件密钥库密码</a><br>要在隔离模式下更改受密码保护的软件密钥库的密码，必须使用<code class="codeph">ADMINISTER KEY MANAGEMENT</code>语句。
                        </li>
                        <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-35D0BAD0-5302-46CB-8353-A7D5EEB76756">在隔离模式下更改硬件密钥库的密码</a><br>要更改硬件密钥库的密码，必须关闭硬件密钥库，然后从硬件密钥库的管理界面更改密码。
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-B6EBC385-D014-43AA-B9DE-DF08F2082712" title="在隔离模式下创建密钥库和TDE主加密密钥后，您可以执行管理任务，例如重新加密或标记加密密钥。">在隔离模式下管理密钥库和TDE主加密密钥</a></p>
                        </div>
                     </div>
                  </div>
                  
                  <div class="props_rev_3"><a id="GUID-57297DAE-186B-4B7E-89FF-9EEB9C433CE8" name="GUID-57297DAE-186B-4B7E-89FF-9EEB9C433CE8"></a><h5 id="ASOAG-GUID-57297DAE-186B-4B7E-89FF-9EEB9C433CE8" class="sect5">在隔离模式下更改受密码保护的软件密钥库密码</h5>
                     <div>
                        <p>要在隔离模式下更改受密码保护的软件密钥库的密码，必须使用<code class="codeph">ADMINISTER KEY MANAGEMENT</code>语句。
                        </p>
                        <div class="section">
                           <ol>
                              <li>
                                 <p>以已被授予<code class="codeph">ADMINISTER KEY MANAGEMENT</code>或<code class="codeph">SYSKM</code>权限的用户身份登录到隔离模式PDB。
                                 </p>
                              </li>
                              <li>
                                 <p>使用以下语法更改密钥库的密码：</p><pre class="oac_no_warn" dir="ltr">管理员密钥管理ALTER KEYSTORE PASSWORD [FORCE KEYSTORE]由<span class="italic">old_password</span>设置标识<span class="italic">new_password</span> [WITH BACKUP [ <span class="italic">USING'backup_identifier</span> ']];</pre><p>在本规范中：</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p>如果在配置了自动登录密钥库且当前处于打开状态时密钥库已关闭，或者如果配置了密码保护密钥库且当前已关闭，则<code class="codeph">FORCE KEYSTORE</code>暂时打开此操作的受密码保护的密钥库。
                                       </p>
                                    </li>
                                    <li>
                                       <p><span class="italic"><code class="codeph">old_password</code></span>是您要更改的当前密钥库密码。
                                       </p>
                                    </li>
                                    <li>
                                       <p><span class="italic"><code class="codeph">new_password</code></span>是您为密钥库设置的新密码。
                                       </p>
                                    </li>
                                 </ul>
                                 <p>以下示例创建密钥库的备份，然后更改密钥库密码：</p><pre class="oac_no_warn" dir="ltr">通过<span class="italic">old_password</span>标识的ADMINISTER密钥管理ALTER KEYSTORE PASSWORD使用'pwd_change'设置<span class="italic">new_password</span> WITH BACKUP密钥库已更改。</pre><p>此示例执行相同的操作，但在使用自动登录软件密钥库或关闭受密码保护的软件密钥库的情况下使用<code class="codeph">FORCE KEYSTORE</code>子句。
                                 </p><pre class="oac_no_warn" dir="ltr">管理员密钥管理ALTER KEYSTORE PASSWORD FORCE KEYSTORE由<span class="italic">old_password</span>识别SET <span class="italic">new_password</span> WITH BACKUP使用'pwd_change';密钥库已更改。</pre></li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>相关话题</strong></p>
                           <ul>
                              <li><a href="managing-keystore-and-tde-master-encryption-key.html#GUID-AB8F896D-A068-47AC-AA26-DDA52BFE5699" title="对于软件和硬件密钥库，许多ADMINISTER KEY MANAGEMENT操作都需要访问密钥库密码。">执行需要密钥库密码的操作</a></li>
                              <li><a href="managing-keystore-and-tde-master-encryption-key.html#GUID-56595198-9FD2-4857-9BB9-D908BA89904C" title="Oracle数据库使您可以轻松更改受密码保护的软件密钥库密码。">更改软件密钥库的密码</a></li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-B88A9733-EF15-4B8F-BD92-3947EA6D5CF6" title="当PDB处于隔离模式时，您可以更改软件密钥库的密码。">在隔离模式下更改密钥库密码</a></p>
                           </div>
                        </div>
                     </div>
                  </div>
                  <div class="props_rev_3"><a id="GUID-35D0BAD0-5302-46CB-8353-A7D5EEB76756" name="GUID-35D0BAD0-5302-46CB-8353-A7D5EEB76756"></a><h5 id="ASOAG-GUID-35D0BAD0-5302-46CB-8353-A7D5EEB76756" class="sect5">在隔离模式下更改硬件密钥库的密码</h5>
                     <div>
                        <p>要更改硬件密钥库的密码，必须关闭硬件密钥库，然后从硬件密钥库的管理界面更改密码。</p>
                        <div class="section">
                           <ol>
                              <li>
                                 <p>以已被授予<code class="codeph">ADMINISTER KEY MANAGEMENT</code>或<code class="codeph">SYSKM</code>权限的用户身份登录到隔离模式PDB。
                                 </p>
                                 <p>请联系您的<code class="codeph">SYSDBA</code>管理员以获取正确的PDB。要检查当前容器，请运行<code class="codeph">SHOW CON_NAME</code>命令。
                                 </p>
                              </li>
                              <li>
                                 <p>关闭硬件密钥库。</p>
                                 <p>例如，对于HSM：</p><pre class="oac_no_warn" dir="ltr">ADMINISTER KEY MANAGEMENT SET KEYSTORE CLOSE由“psmith： <span class="italic">password</span> ”标识;</pre><p>对于其密码存储在外部的硬件密钥库：</p><pre class="oac_no_warn" dir="ltr">管理员密钥管理设置由外部商店识别的KEYSTORE CLOSE;</pre></li>
                              <li>
                                 <p>从硬件安全模块管理界面，更改硬件安全模块密码。</p>
                              </li>
                              <li>
                                 <p>更新外部存储中HSM的凭据以使用“ <code class="codeph"><span class="codeinlineitalic">user_name</span> : <span class="codeinlineitalic">password</span> "</code> 。
                                 </p>
                                 <p>目前，外部存储包含旧的HSM凭据，这些凭据将不再有效。</p>
                                 <p>例如：</p><pre class="oac_no_warn" dir="ltr">ADMINISTER密钥管理更新秘密' <span class="italic">user_name</span> ： <span class="italic">密码</span> 'FOR CLIENT'TDE_WALLET'到LOCAL AUTO_LOGIN KEYSTORE'/ etc / ORACLE / WALLETS / orcl / external_store';</pre></li>
                              <li>
                                 <p>在SQL * Plus中，打开硬件密钥库。</p>
                                 <p>例如：</p><pre class="oac_no_warn" dir="ltr">ADMINISTER KEY MANAGEMENT SET KEYSTORE OPEN由“psmith： <span class="italic">new_password</span> ”识别;</pre><p>对于其密码存储在外部的硬件密钥库：</p><pre class="oac_no_warn" dir="ltr">管理员密钥管理设置KEYSTORE OPEN由外部商店识别;</pre></li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>相关话题</strong></p>
                           <ul>
                              <li><a href="managing-keystore-and-tde-master-encryption-key.html#GUID-AB8F896D-A068-47AC-AA26-DDA52BFE5699" title="对于软件和硬件密钥库，许多ADMINISTER KEY MANAGEMENT操作都需要访问密钥库密码。">执行需要密钥库密码的操作</a></li>
                              <li><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-F7052961-ECD0-4AD5-BC14-5E0715C9DE33" title="秘密是支持内部Oracle数据库功能的数据，这些功能将外部客户端（如Oracle GoldenGate）集成到数据库中。">以隔离模式存储Oracle数据库秘密</a></li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-B88A9733-EF15-4B8F-BD92-3947EA6D5CF6" title="当PDB处于隔离模式时，您可以更改软件密钥库的密码。">在隔离模式下更改密钥库密码</a></p>
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-4044CC16-806E-4681-ADB5-41BAD4CAA04B" name="GUID-4044CC16-806E-4681-ADB5-41BAD4CAA04B"></a><h4 id="ASOAG-GUID-4044CC16-806E-4681-ADB5-41BAD4CAA04B" class="sect4">在隔离模式下备份受密码保护的软件密钥库</h4>
                  <div>
                     <p><code class="codeph">ADMINISTER KEY MANAGEMENT</code>语句的<code class="codeph">BACKUP KEYSTORE</code>子句备份受密码保护的软件密钥库。
                     </p>
                     <div class="section">
                        <ol>
                           <li>
                              <p>以已被授予<code class="codeph">ADMINISTER KEY MANAGEMENT</code>或<code class="codeph">SYSKM</code>权限的用户身份登录到隔离模式PDB。
                              </p>
                              <p>例如：</p><pre class="oac_no_warn" dir="ltr">sqlplus sec_admin @hrpdb as syskm输入密码： <span class="italic">password</span>已连接。
</pre><p>请联系您的<code class="codeph">SYSDBA</code>管理员以获取正确的PDB。要检查当前容器，请运行<code class="codeph">SHOW CON_NAME</code>命令。
                              </p>
                           </li>
                           <li>
                              <p>使用以下语法备份密钥库：</p><pre class="oac_no_warn" dir="ltr">管理员密钥管理备份KEYSTORE [使用' <span class="italic">backup_identifier</span> '] [FORCE KEYSTORE]由[EXTERNAL STORE | <span class="italic">software_keystore_password</span> ] [ <span class="italic">TO'keystore_location</span> '];</pre><p>在本规范中：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><code class="codeph">USING</code> <span class="italic"><code class="codeph">backup_identifier</code></span>是一个可选字符串，您可以提供该字符串来标识备份。将此标识符括在单引号（ <code class="codeph">' '</code> ）中。此标识符附加到指定的密钥库文件（例如， <code class="codeph">ewallet_</code> <span class="italic"><code class="codeph">time-stamp</code></span> <code class="codeph">_emp_key_backup.p12</code> ）。
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">FORCE KEYSTORE</code>临时打开此操作的受密码保护的密钥库。您必须打开此操作的密钥库。
                                    </p>
                                 </li>
                                 <li>
                                    <p>对于受密码保护的密钥库， <code class="codeph">BACKUP KEYSTORE</code>操作需要<code class="codeph">IDENTIFIED BY</code>因为尽管备份只是现有密钥库的副本，但密码保护密钥库中TDE主加密密钥的状态必须设置为<code class="codeph">BACKED UP</code>和for这个更改密钥库密码是必需的。
                                    </p>
                                 </li>
                                 <li>
                                    <p><span class="italic"><code class="codeph">keystore_location</code></span>是备份密钥库的存储路径。当在PDB中阻止PDB锁定配置文件<code class="codeph">EXTERNAL_FILE_ACCESS</code>设置或在创建PDB时设置<code class="codeph">PATH_PREFIX</code>变量时，此设置仅限于PDB。如果未指定<span class="italic"><code class="codeph">keystore_location</code></span> ，则会在与原始密钥库相同的目录中创建备份。将此位置括在单引号（ <code class="codeph">' '</code> ）中。
                                    </p>
                                 </li>
                              </ul>
                              <p>以下示例在与源密钥库相同的位置备份软件密钥库。</p><pre class="oac_no_warn" dir="ltr">管理员密钥管理备份KEYSTORE使用'hr.emp_keystore'由' <span class="italic">software_keystore_password</span> '识别的FORCE KEYSTORE;密钥库已更改。
</pre><p>在以下版本中，密钥库的密码存储在外部，因此使用<code class="codeph">EXTERNAL STORE</code>子句。
                              </p><pre class="oac_no_warn" dir="ltr">管理员密钥管理备份KEYSTORE使用'hr.emp_keystore'FORCE KEYSTORE由外部商店识别;</pre><p>运行此语句后，密钥库备份位置<code class="codeph">_hr.emp_keystore.p12</code>显示<code class="codeph">ewallet_</code> <span class="italic"><code class="codeph">identifier</code></span> <code class="codeph">.p12</code>文件（例如， <code class="codeph">ewallet_</code> <span class="italic"><code class="codeph">time-stamp</code></span> <code class="codeph">_hr.emp_keystore.p12</code> ）。
                              </p>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="managing-keystore-and-tde-master-encryption-key.html#GUID-43BBC184-F801-45A9-B4D0-BB7E9767AED0" title="备份受密码保护的软件密钥库时，可以创建备份标识符字符串以描述备份类型。">备份受密码保护的软件密钥库</a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-B6EBC385-D014-43AA-B9DE-DF08F2082712" title="在隔离模式下创建密钥库和TDE主加密密钥后，您可以执行管理任务，例如重新加密或标记加密密钥。">在隔离模式下管理密钥库和TDE主加密密钥</a></p>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-D2869448-212E-44CB-8BAA-2A337369DFCD" name="GUID-D2869448-212E-44CB-8BAA-2A337369DFCD"></a><h4 id="ASOAG-GUID-D2869448-212E-44CB-8BAA-2A337369DFCD" class="sect4">在隔离模式下合并软件密钥库</h4>
                  <div>
                     <p>在隔离模式下，您可以合并软件密钥库。</p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-1A5DE98C-B676-40D2-A6C1-C4D08F25319F">在隔离模式下将一个软件密钥库合并到现有软件密钥库中</a><br>在隔离模式下，您可以使用<code class="codeph">ADMINISTER KEY MANAGEMENT</code>语句和<code class="codeph">MERGE KEYSTORE</code>子句将一个软件密钥库合并到另一个现有软件密钥库中。
                        </li>
                        <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-F1550EF0-DC2B-4247-9299-1B33E2392D79">在隔离模式下将两个软件密钥库合并到第三个新密钥库中</a><br>在隔离模式下，您可以将两个软件密钥库合并到第三个新密钥库中，以便不更改两个现有密钥库，并且新密钥库包含两个源密钥库的密钥。
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-B6EBC385-D014-43AA-B9DE-DF08F2082712" title="在隔离模式下创建密钥库和TDE主加密密钥后，您可以执行管理任务，例如重新加密或标记加密密钥。">在隔离模式下管理密钥库和TDE主加密密钥</a></p>
                        </div>
                     </div>
                  </div>
                  
                  <div class="props_rev_3"><a id="GUID-1A5DE98C-B676-40D2-A6C1-C4D08F25319F" name="GUID-1A5DE98C-B676-40D2-A6C1-C4D08F25319F"></a><h5 id="ASOAG-GUID-1A5DE98C-B676-40D2-A6C1-C4D08F25319F" class="sect5">在隔离模式下将一个软件密钥库合并到现有软件密钥库中</h5>
                     <div>
                        <p>在隔离模式下，您可以使用<code class="codeph">ADMINISTER KEY MANAGEMENT</code>语句和<code class="codeph">MERGE KEYSTORE</code>子句将一个软件密钥库合并到另一个现有软件密钥库中。
                        </p>
                        <div class="section">
                           <ol>
                              <li>
                                 <p>以已被授予<code class="codeph">ADMINISTER KEY MANAGEMENT</code>或<code class="codeph">SYSKM</code>权限的用户身份登录到隔离模式PDB。
                                 </p>
                                 <p>请联系您的<code class="codeph">SYSDBA</code>管理员以获取正确的PDB。要检查当前容器，请运行<code class="codeph">SHOW CON_NAME</code>命令。
                                 </p>
                              </li>
                              <li>
                                 <p>使用以下语法合并软件密钥库：</p><pre class="oac_no_warn" dir="ltr">ADMINISTER密钥管理MERGE密钥库<span class="italic">'keystore1_location'[IDENTIFIED</span> BY <span class="italic">software_keystore1_password]</span> INTO IDENTIFIED BY <span class="italic">software_keystore2_password</span>现有密钥库<span class="italic">'keystore2_location'[WITH</span> BACKUP <span class="italic">[USING'backup_identifier]];</span></pre><p>在本规范中：</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p><span class="italic"><code class="codeph">keystore1_location</code></span>是第一个密钥库的目录位置，在合并后将保持不变。将此路径括在单引号（ <code class="codeph">' '</code> ）中。
                                       </p>
                                    </li>
                                    <li>
                                       <p>如果第一个密钥库是受密码保护的密钥库，则<code class="codeph">IDENTIFIED BY</code>子句是必需的。 <span class="italic"><code class="codeph">software_keystore1_password</code></span>是第一个密钥库的密码。
                                       </p>
                                    </li>
                                    <li>
                                       <p><span class="italic"><code class="codeph">keystore2_location</code></span>是第一个密钥库要合并到的第二个密钥库的目录位置。将此路径括在单引号（ <code class="codeph">' '</code> ）中。
                                       </p>
                                    </li>
                                    <li>
                                       <p><span class="italic"><code class="codeph">software_keystore2_password</code></span>是第二个密钥库的密码。
                                       </p>
                                    </li>
                                 </ul>
                              </li>
                           </ol>
                           <p>在密钥库合并操作之后，目标密钥库（ <code class="codeph"><span class="codeinlineitalic">keystore2</span></code> ）仍然是受密码保护的密钥库。
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>相关话题</strong></p>
                           <ul>
                              <li><a href="managing-keystore-and-tde-master-encryption-key.html#GUID-0CF462D4-4920-480F-B967-4569F4459C86" title="您可以合并任何软件密钥库的组合，但合并的密钥库必须受密码保护。它可以具有与组成密钥库不同的密码。">关于合并软件密钥库</a></li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-D2869448-212E-44CB-8BAA-2A337369DFCD" title="在隔离模式下，您可以合并软件密钥库。">在隔离模式下合并软件密钥库</a></p>
                           </div>
                        </div>
                     </div>
                  </div>
                  <div class="props_rev_3"><a id="GUID-F1550EF0-DC2B-4247-9299-1B33E2392D79" name="GUID-F1550EF0-DC2B-4247-9299-1B33E2392D79"></a><h5 id="ASOAG-GUID-F1550EF0-DC2B-4247-9299-1B33E2392D79" class="sect5">在隔离模式下将两个软件密钥库合并到第三个新密钥库中</h5>
                     <div>
                        <p>在隔离模式下，您可以将两个软件密钥库合并到第三个新密钥库中，以便不更改两个现有密钥库，并且新密钥库包含两个源密钥库的密钥。</p>
                        <ol>
                           <li class="stepexpand"><span>以已被授予<code class="codeph">ADMINISTER KEY MANAGEMENT</code>或<code class="codeph">SYSKM</code>权限的用户身份登录到隔离模式PDB。</span><div>
                                 <p>请联系您的<code class="codeph">SYSDBA</code>管理员以获取正确的PDB。要检查当前容器，请运行<code class="codeph">SHOW CON_NAME</code>命令。
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>使用以下语法合并密钥库：</span><div><pre class="oac_no_warn" dir="ltr">ADMINISTER密钥管理MERGE密钥库<span class="italic">'keystore1_location'[IDENTIFIED</span> BY <span class="italic">software_keystore1_password]</span> AND密钥库<span class="italic">'keystore2_location'[IDENTIFIED</span> BY <span class="italic">software_keystore2_password]</span> INTO IDENTIFIED BY <span class="italic">software_keystore3_password</span>新的密钥库<span class="italic">'keystore3_location';</span></pre><p>在本规范中：</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p><span class="italic"><code class="codeph">keystore1_location</code></span>是第一个密钥库的目录位置，在合并后将保持不变。将此路径括在单引号（ <code class="codeph">' '</code> ）中。
                                       </p>
                                    </li>
                                    <li>
                                       <p>如果第一个密钥库是受密码保护的密钥库，则<code class="codeph">IDENTIFIED BY</code>子句是必需的。 <span class="italic"><code class="codeph">software_keystore1_password</code></span>是第一个密钥库的当前密码。
                                       </p>
                                    </li>
                                    <li>
                                       <p><span class="italic"><code class="codeph">keystore2_location</code></span>是第二个密钥库的目录位置。将此路径括在单引号（ <code class="codeph">' '</code> ）中。
                                       </p>
                                    </li>
                                    <li>
                                       <p>如果第二个密钥库是受密码保护的密钥库，则<code class="codeph">IDENTIFIED BY</code>子句是必需的。 <span class="italic"><code class="codeph">software_keystore2_password</code></span>是第二个密钥库的当前密码。
                                       </p>
                                    </li>
                                    <li>
                                       <p><span class="italic"><code class="codeph">keystore3_location</code></span>指定新合并密钥库的目录位置。将此路径括在单引号（ <code class="codeph">' '</code> ）中。如果此位置已存在现有密钥库，则该命令将退出并显示错误。
                                       </p>
                                    </li>
                                    <li>
                                       <p><span class="italic"><code class="codeph">software_keystore3_password</code></span>是合并密钥库的新密码。
                                       </p>
                                    </li>
                                 </ul>
                                 <p>以下示例将自动登录软件密钥库与受密码保护的密钥库合并，以在新位置创建合并的受密码保护的密钥库：</p><pre class="oac_no_warn" dir="ltr">ADMINISTER密钥管理MERGE KEYSTORE'/ etc / ORACLE / KEYSTORE / DB1'和KEYSTORE'/ etc / ORACLE / KEYSTORE / DB2'ENFENTIFIED BY <span class="italic">existing_password_for_keystore_2</span> INTO NEW KEYSTORE'/ etc / ORACLE / KEYSTORE / DB3'由<span class="italic">new_password_for_keystore_3</span>识别;密钥库已更改。</pre></div>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>相关话题</strong></p>
                           <ul>
                              <li><a href="managing-keystore-and-tde-master-encryption-key.html#GUID-0CF462D4-4920-480F-B967-4569F4459C86" title="您可以合并任何软件密钥库的组合，但合并的密钥库必须受密码保护。它可以具有与组成密钥库不同的密码。">关于合并软件密钥库</a></li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-D2869448-212E-44CB-8BAA-2A337369DFCD" title="在隔离模式下，您可以合并软件密钥库。">在隔离模式下合并软件密钥库</a></p>
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-04650B68-D7CE-431A-9942-9F7496360FC0" name="GUID-04650B68-D7CE-431A-9942-9F7496360FC0"></a><h4 id="ASOAG-GUID-04650B68-D7CE-431A-9942-9F7496360FC0" class="sect4">以隔离模式关闭密钥库</h4>
                  <div>
                     <p>除非系统表空间已加密，否则您可以在隔离模式下关闭软件和硬件密钥库。</p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-483CBCCB-8A55-4739-B0B8-F5633C374BE8">以隔离模式关闭软件密钥库</a><br>您可以在隔离模式下关闭受密码保护的密钥库，自动登录密钥库和本地自动登录软件密钥库。
                        </li>
                        <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-F71388AF-28E9-42BB-86CF-99C72B6D81C4">以隔离模式关闭硬件密钥库</a><br>要关闭硬件密钥库，必须将<code class="codeph">ADMINISTER KEY MANAGEMENT</code>语句与<code class="codeph">SET KEYSTORE CLOSE</code>子句一起使用。
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-B6EBC385-D014-43AA-B9DE-DF08F2082712" title="在隔离模式下创建密钥库和TDE主加密密钥后，您可以执行管理任务，例如重新加密或标记加密密钥。">在隔离模式下管理密钥库和TDE主加密密钥</a></p>
                        </div>
                     </div>
                  </div>
                  
                  <div class="sect4"><a id="GUID-483CBCCB-8A55-4739-B0B8-F5633C374BE8" name="GUID-483CBCCB-8A55-4739-B0B8-F5633C374BE8"></a><h5 id="ASOAG-GUID-483CBCCB-8A55-4739-B0B8-F5633C374BE8" class="sect5">以隔离模式关闭软件密钥库</h5>
                     <div>
                        <p>您可以在隔离模式下关闭受密码保护的密钥库，自动登录密钥库和本地自动登录软件密钥库。</p>
                        <div class="section">如果自动登录密钥库在访问时自动打开，则必须先将其移动到无法自动打开的新位置，然后必须手动将其关闭。如果要将配置从自动登录密钥库更改为受密码保护的密钥库，则必须执行此操作：将配置更改为停止使用自动登录密钥库（通过将自动登录密钥库移动到不能使用自动登录密钥库的另一个位置）自动打开），然后关闭自动登录密钥库。</div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>以已被授予<code class="codeph">ADMINISTER KEY MANAGEMENT</code>或<code class="codeph">SYSKM</code>权限的用户身份登录到隔离模式PDB。</span></li>
                           <li class="stepexpand"><span>使用以下语法关闭软件密钥库。</span><div>请注意，以下两个<code class="codeph">ADMINISTER KEY MANAGEMENT SET KEYSTORE CLOSE</code>语句之间的唯一区别是必须为受密码保护的密钥库提供密码。
                              </div>
                              <ul>
                                 <li>对于受密码保护的软件密钥库：<pre class="oac_no_warn" dir="ltr">管理员密钥管理设置关键字由[外部商店|]识别<span class="italic">software_keystore_password</span> ];</pre><p>关闭受密码保护的密钥库会禁用所有加密和解密操作。任何加密或解密数据或访问加密数据的尝试都会导致错误。</p>
                                 </li>
                                 <li>对于自动登录或本地自动登录软件密钥库：<pre class="oac_no_warn" dir="ltr">管理员密钥管理设置KEYSTORE CLOSE;</pre><p>此语句的结果不一定是密钥库状态将更改为<code class="codeph">CLOSED</code> ，因为除非您还将<code class="codeph">cwallet.sso</code>文件移动到Oracle数据库找不到的位置，否则后台作业或后台进程可能会自动重新打开自动登录密钥库。即使在<code class="codeph">ADMINISTER KEY MANAGEMENT SET KEYSTORE CLOSE</code>语句成功完成后，这也可能导致状态可能始终显示为<code class="codeph">OPEN</code> 。
                                    </p>
                                 </li>
                              </ul>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>相关话题</strong></p>
                           <ul>
                              <li><a href="managing-keystore-and-tde-master-encryption-key.html#GUID-9777F9A7-EDB8-40DB-B7D8-FAC2FDFFBEB4" title="打开密钥库后，它将保持打开状态，直到您关闭数据库实例。">关于关闭密钥库</a></li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-04650B68-D7CE-431A-9942-9F7496360FC0" title="除非系统表空间已加密，否则您可以在隔离模式下关闭软件和硬件密钥库。">在隔离模式下关闭密钥库</a></p>
                           </div>
                        </div>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-F71388AF-28E9-42BB-86CF-99C72B6D81C4" name="GUID-F71388AF-28E9-42BB-86CF-99C72B6D81C4"></a><h5 id="ASOAG-GUID-F71388AF-28E9-42BB-86CF-99C72B6D81C4" class="sect5">以隔离模式关闭硬件密钥库</h5>
                     <div>
                        <p>要关闭硬件密钥库，必须将<code class="codeph">ADMINISTER KEY MANAGEMENT</code>语句与<code class="codeph">SET KEYSTORE CLOSE</code>子句一起使用。
                        </p>
                        <div class="section">对于Oracle Key Vault密钥库，您只能提供密码。<code class="codeph">IDENTIFIED BY</code>子句中不允许使用用户名。用双引号括起密码。
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>以已被授予<code class="codeph">ADMINISTER KEY MANAGEMENT</code>或<code class="codeph">SYSKM</code>权限的用户身份登录到隔离模式PDB。</span><div>
                                 <p>请联系您的<code class="codeph">SYSDBA</code>管理员以获取正确的PDB。要检查当前容器，请运行<code class="codeph">SHOW CON_NAME</code>命令。
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>使用以下语法关闭硬件密钥库：</span><div><pre class="oac_no_warn" dir="ltr">管理员密钥管理设置关键字由[外部商店|]识别“ <span class="italic">hardware_keystore_credentials</span> ”];</pre><p>例如，对于HSM：</p><pre class="oac_no_warn" dir="ltr">ADMINISTER KEY MANAGEMENT SET KEYSTORE CLOSE由“psmith： <span class="italic">password</span> ”标识;</pre></div>
                           </li>
                        </ol>
                        <div class="section">关闭密钥库会禁用所有加密和解密操作。任何加密或解密数据或访问加密数据的尝试都会导致错误。</div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>相关话题</strong></p>
                           <ul>
                              <li><a href="managing-keystore-and-tde-master-encryption-key.html#GUID-9777F9A7-EDB8-40DB-B7D8-FAC2FDFFBEB4" title="打开密钥库后，它将保持打开状态，直到您关闭数据库实例。">关于关闭密钥库</a></li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-04650B68-D7CE-431A-9942-9F7496360FC0" title="除非系统表空间已加密，否则您可以在隔离模式下关闭软件和硬件密钥库。">在隔离模式下关闭密钥库</a></p>
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-92CFFF56-C4C6-471B-9DFB-1CC9CB5FE3FD" name="GUID-92CFFF56-C4C6-471B-9DFB-1CC9CB5FE3FD"></a><h4 id="ASOAG-GUID-92CFFF56-C4C6-471B-9DFB-1CC9CB5FE3FD" class="sect4">在隔离模式下创建用户定义的TDE主加密密钥</h4>
                  <div>
                     <p>要创建用户定义的TDE主加密密钥，请使用<code class="codeph">ADMINISTER KEY MANAGEMENT</code>语句和<code class="codeph">SET | CREATE [ENCRYPTION] KEY</code>子句。
                     </p>
                     <ol>
                        <li class="stepexpand"><span>以已被授予<code class="codeph">ADMINISTER KEY MANAGEMENT</code>或<code class="codeph">SYSKM</code>权限的用户身份登录到隔离模式PDB。</span></li>
                        <li class="stepexpand"><span>使用以下语法创建用户定义的TDE主加密密钥：</span><div><pre class="oac_no_warn" dir="ltr">管理员密钥管理集|创建[ENCRYPTION] <span class="italic">KEY'mkid</span> ： <span class="italic">mk</span> | <span class="italic">mk</span> '[使用算法' <span class="italic">算法</span> '] [FORCE KEYSTORE]由[EXTERNAL STORE]识别<span class="italic">keystore_password</span> ] [WITH BACKUP [使用' <span class="italic">backup_identifier</span> ']];</pre><p>在本规范中：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><code class="codeph">SET | CREATE</code> ：如果要立即创建主服务器并激活TDE主加密密钥，请输入<code class="codeph">SET</code>如果要创建密钥供以后使用，请输入<code class="codeph">CREATE</code> ，而不要激活它。
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph"><span class="codeinlineitalic">mkid</span></code>和<code class="codeph"><span class="codeinlineitalic">mk</span></code> ：</p>
                                    <ul style="list-style-type:disc">
                                       <li>
                                          <p><code class="codeph"><span class="codeinlineitalic">mkid</span></code>是TDE主加密密钥ID，是一个16字节的十六进制编码值，您可以指定或让Oracle数据库生成。
                                          </p>
                                       </li>
                                       <li>
                                          <p><code class="codeph"><span class="codeinlineitalic">mk</span></code>是TDE主加密密钥，是一个十六进制编码的值，您可以指定或让Oracle数据库生成，32字节（对于<code class="codeph">AES256</code> ， <code class="codeph">ARIA256</code>和<code class="codeph">GOST256</code>算法）或16字节（对于<code class="codeph">SEED128</code>算法）。
                                          </p>
                                       </li>
                                    </ul>
                                    <p>如果省略<code class="codeph"><span class="codeinlineitalic">mkid</span> : <span class="codeinlineitalic">mk</span> | <span class="codeinlineitalic">mkid</span></code>子句但包含<code class="codeph"><span class="codeinlineitalic">mk</span></code>值，然后Oracle数据库为<code class="codeph"><span class="codeinlineitalic">mk</span></code>生成<code class="codeph"><span class="codeinlineitalic">mkid</span></code> 。
                                    </p>
                                    <p>如果省略整个<code class="codeph"><span class="codeinlineitalic">mkid</span> : <span class="codeinlineitalic">mk</span> | <span class="codeinlineitalic">mkid</span></code>子句，然后Oracle数据库为您生成这些值。
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">USING ALGORITHM</code> ：指定以下支持的算法之一：</p>
                                    <ul style="list-style-type:disc">
                                       <li>
                                          <p><code class="codeph">AES256</code></p>
                                       </li>
                                       <li>
                                          <p><code class="codeph">ARIA256</code> 
                                          </p>
                                       </li>
                                       <li>
                                          <p><code class="codeph">SEED128</code></p>
                                       </li>
                                       <li>
                                          <p><code class="codeph">GOST256</code></p>
                                       </li>
                                    </ul>
                                    <p>如果省略算法，则使用默认值<code class="codeph">AES256</code> 。
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">FORCE KEYSTORE</code>临时打开此操作的受密码保护的密钥库。您必须打开此操作的密钥库。
                                    </p>
                                 </li>
                              </ul>
                              <p>以下示例包括用户创建的TDE主加密密钥，但没有TDE主加密密钥ID，因此生成TDE主加密密钥ID：</p><pre class="oac_no_warn" dir="ltr">管理员密钥管理集加密密钥'3D432109DF88967A541967062A6F4E460E892318E307F017BA048707B402493C'使用算法'GOST256'由<span class="italic">keystore_password</span>识别的FORCE KEYSTORE;</pre><p>下一个示例为主加密ID和TDE主加密密钥创建用户定义的密钥。它省略了算法规范，因此使用默认算法<code class="codeph">AES256</code> 。
                              </p><pre class="oac_no_warn" dir="ltr">管理员密钥管理创建加密密钥'10203040506070801112131415161718：3D432109DF88967A541967062A6F4E460E892318E307F017BA048707B402493C'由<span class="italic">keystore_password</span>识别;</pre></div>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="introduction-to-transparent-data-encryption.html#GUID-AAE3C965-C6A8-45D6-BA5D-F88B300A301A" title="默认情况下，透明数据加密（TDE）列加密使用高级加密标准（AES）。">支持的加密和完整性算法</a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-B6EBC385-D014-43AA-B9DE-DF08F2082712" title="在隔离模式下创建密钥库和TDE主加密密钥后，您可以执行管理任务，例如重新加密或标记加密密钥。">在隔离模式下管理密钥库和TDE主加密密钥</a></p>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-D5A0169C-CB0B-43CB-9721-3BAF1A851C55" name="GUID-D5A0169C-CB0B-43CB-9721-3BAF1A851C55"></a><h4 id="ASOAG-GUID-D5A0169C-CB0B-43CB-9721-3BAF1A851C55" class="sect4">创建TDE主加密密钥，以便以后在隔离模式下使用</h4>
                  <div>
                     <p>必须先打开密钥库，然后才能创建TDE主加密密钥，以便以后在隔离模式下使用。</p>
                     <ol>
                        <li class="stepexpand"><span>以已被授予<code class="codeph">ADMINISTER KEY MANAGEMENT</code>或<code class="codeph">SYSKM</code>权限的用户身份登录到隔离模式PDB。</span><div>
                              <p>请联系您的<code class="codeph">SYSDBA</code>管理员以获取正确的PDB。要检查当前容器，请运行<code class="codeph">SHOW CON_NAME</code>命令。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>使用以下语法创建TDE主加密密钥：</span><div><pre class="oac_no_warn" dir="ltr">管理员密钥管理创建密钥[使用标记' <span class="italic">标记</span> '] [FORCE KEYSTORE]由[EXTERNAL STORE | <span class="italic">keystore_password</span> ] [WITH BACKUP [使用' <span class="italic">backup_identifier</span> ']];</pre><p>在本规范中：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><code class="codeph">FORCE KEYSTORE</code>临时打开此操作的受密码保护的密钥库。您必须打开此操作的密钥库。
                                    </p>
                                 </li>
                                 <li>
                                    <p>对于受密码保护的密钥库， <code class="codeph">BACKUP KEYSTORE</code>操作需要<code class="codeph">IDENTIFIED BY</code>因为尽管备份只是现有密钥库的副本，但密码保护密钥库中TDE主加密密钥的状态必须设置为<code class="codeph">BACKED UP</code>和for这个更改密钥库密码是必需的。
                                    </p>
                                 </li>
                                 <li>
                                    <p><span class="italic"><code class="codeph">keystore_location</code></span>是备份密钥库的存储路径。当在PDB中阻止PDB锁定配置文件<code class="codeph">EXTERNAL_FILE_ACCESS</code>设置或在创建PDB时未设置<code class="codeph">PATH_PREFIX</code>变量时，此设置仅限于PDB。如果未指定<span class="italic"><code class="codeph">keystore_location</code></span> ，则会在与原始密钥库相同的目录中创建备份。将此位置括在单引号（ <code class="codeph">' '</code> ）中。
                                    </p>
                                 </li>
                              </ul>
                              <p>例如：</p><pre class="oac_no_warn" dir="ltr">ADMINISTER密钥管理CREATE KEY FORCE KEYENORE由<span class="italic">keystore_password</span> IDENTIFIED WITH BACKUP;</pre></div>
                        </li>
                        <li class="stepexpand"><span>如有必要，请激活TDE主加密密钥。</span><ol type="a">
                              <li class="substepexpand"><span>找到密钥ID。</span><div><pre class="oac_no_warn" dir="ltr">SELECT KEY_ID FROM V $ ENCRYPTION_KEYS; KEY_ID ------------------------------------------------- --- AWsHwVYC2U + Nv3RVphn / yAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</pre></div>
                              </li>
                              <li class="substepexpand"><span>使用此密钥ID激活密钥。</span><div><pre class="oac_no_warn" dir="ltr">管理员密钥管理使用密钥'AWsHwVYC2U + Nv3RVphn / yAIAAAAAAAAAAAAAAAAAAAAAAAAAAAA'使用标签'季度：秒;描述：激活备用密钥'IDENTIFIED BY <span class="italic">密码</span> WITH BACKUP;</pre></div>
                              </li>
                           </ol>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="managing-keystore-and-tde-master-encryption-key.html#GUID-EA686044-5B10-4F70-88F2-B45BF1DD1E55" title="您可以创建可在以后激活的TDE主加密密钥。">创建TDE主加密密钥以供以后使用</a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-B6EBC385-D014-43AA-B9DE-DF08F2082712" title="在隔离模式下创建密钥库和TDE主加密密钥后，您可以执行管理任务，例如重新加密或标记加密密钥。">在隔离模式下管理密钥库和TDE主加密密钥</a></p>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-A89BB885-B46C-4A86-B55E-29DB08A4FCB2" name="GUID-A89BB885-B46C-4A86-B55E-29DB08A4FCB2"></a><h4 id="ASOAG-GUID-A89BB885-B46C-4A86-B55E-29DB08A4FCB2" class="sect4">在隔离模式下激活TDE主加密密钥</h4>
                  <div>
                     <p>要在隔离模式下激活TDE主加密密钥，必须打开密钥库并使用<code class="codeph">ADMINISTER KEY MANAGEMENT</code>和<code class="codeph">USE KEY</code>子句。
                     </p>
                     <div class="section">
                        <ol>
                           <li>
                              <p>以已被授予<code class="codeph">ADMINISTER KEY MANAGEMENT</code>或<code class="codeph">SYSKM</code>权限的用户身份登录到隔离模式PDB。
                              </p>
                           </li>
                           <li>
                              <p>查询<code class="codeph">V$ENCRYPTION_KEYS</code>视图的<code class="codeph">KEY_ID</code>列以查找密钥标识符。
                              </p>
                              <p>例如：</p><pre class="oac_no_warn" dir="ltr">SELECT KEY_ID FROM V $ ENCRYPTION_KEYS; KEY_ID ------------------------------------------------- --- ARaHD762tUkkvyLgPzAi6hMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</pre></li>
                           <li>
                              <p>使用此密钥标识符可以使用以下语法激活TDE主加密密钥：</p><pre class="oac_no_warn" dir="ltr">ADMINISTER密钥管理使用密钥' <span class="italic">key_identifier_from_V $ ENCRYPTION_KEYS</span> '[使用标记' <span class="italic">标记</span> '] [FORCE KEYSTORE]由[EXTERNAL STORE | <span class="italic">keystore_password</span> ] [WITH BACKUP [使用' <span class="italic">backup_identifier</span> ']];</pre><p>在本规范中：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><code class="codeph">FORCE KEYSTORE</code>临时打开此操作的受密码保护的密钥库。您必须打开此操作的密钥库。
                                    </p>
                                 </li>
                              </ul>
                              <p>例如：</p><pre class="oac_no_warn" dir="ltr">管理员密钥管理使用密钥'ARaHD762tUkkvyLgPzAi6hMAAAAAAAAAAAAAAAAAAAAAAAAAAAA'由<span class="italic">keystore_password</span> WITH BACKUP识别的FORCE KEYSTORE;</pre></li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="managing-keystore-and-tde-master-encryption-key.html#GUID-0B645D42-A7FE-4199-9A88-AFD416F1ECF1" title="您可以使用ADMINSTER KEY MANAGEMENT的USE KEY子句激活以前创建或导入的TDE主加密密钥。">关于激活TDE主加密密钥</a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-B6EBC385-D014-43AA-B9DE-DF08F2082712" title="在隔离模式下创建密钥库和TDE主加密密钥后，您可以执行管理任务，例如重新加密或标记加密密钥。">在隔离模式下管理密钥库和TDE主加密密钥</a></p>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-1BC74A51-2930-4B07-880F-0EC761351A22" name="GUID-1BC74A51-2930-4B07-880F-0EC761351A22"></a><h4 id="ASOAG-GUID-1BC74A51-2930-4B07-880F-0EC761351A22" class="sect4">在隔离模式下更新TDE主加密密钥</h4>
                  <div>
                     <p>您可以将<code class="codeph">ADMINISTER KEY MANAGEMENT</code>语句与<code class="codeph">SET KEY</code>子句一起使用，以重新生成TDE主加密密钥。
                     </p>
                     <div class="section">
                        <ol>
                           <li>
                              <p>以已被授予<code class="codeph">ADMINISTER KEY MANAGEMENT</code>或<code class="codeph">SYSKM</code>权限的用户身份登录到隔离模式PDB。
                              </p>
                              <p>请联系您的<code class="codeph">SYSDBA</code>管理员以获取正确的PDB。要检查当前容器，请运行<code class="codeph">SHOW CON_NAME</code>命令。
                              </p>
                           </li>
                           <li>
                              <p>如果要为启用了自动登录的密钥库重新加密TDE主加密密钥，请确保存在由<code class="codeph">.sso</code>文件标识的自动登录密钥库和<code class="codeph">.p12</code>文件标识的加密密钥库。
                              </p>
                              <p>您可以通过查询<code class="codeph">V$ENCRYPTION_WALLET</code>视图的<code class="codeph">WRL_PARAMETER</code>列来查找这些文件的位置。要查找所有数据库实例的<code class="codeph">WRL_PARAMETER</code>值，请查询<code class="codeph">GV$ENCRYPTION_WALLET</code>视图。
                              </p>
                           </li>
                           <li>
                              <p>使用以下语法重新生成TDE主加密密钥：</p><pre class="oac_no_warn" dir="ltr">管理员密钥管理集[加密]密钥[FORCE KEYSTORE] [使用标记' <span class="italic">tag_name</span> ']由[EXTERNAL STORE | <span class="italic">keystore_password</span> ] [WITH BACKUP [使用' <span class="italic">backup_identifier</span> ']];</pre><p>在本规范中：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><span class="italic"><code class="codeph">tag</code></span>是您定义的关联属性和信息。将此设置括在单引号（ <code class="codeph">' '</code> ）中。
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">FORCE KEYSTORE</code>临时打开此操作的受密码保护的密钥库。您必须打开此操作的密钥库。
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">IDENTIFIED BY</code>可以是以下设置之一：</p>
                                    <ul style="list-style-type:disc">
                                       <li>
                                          <p><code class="codeph">EXTERNAL STORE</code>使用存储在外部存储中的密钥库密码来执行密钥库操作。
                                          </p>
                                       </li>
                                       <li>
                                          <p><span class="italic"><code class="codeph">keystore_password</code></span>是为此密钥库创建的密码。
                                          </p>
                                       </li>
                                    </ul>
                                 </li>
                              </ul>
                              <p>例如：</p><pre class="oac_no_warn" dir="ltr">ADMINISTER密钥管理设置密钥强制关键字由<span class="italic">keystore_password</span>标识，带有备份使用'emp_key_backup';密钥库已更改。
</pre></li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="managing-keystore-and-tde-master-encryption-key.html#GUID-B788CBF7-DB54-48D4-AB32-7AA06289153B" title="Oracle数据库使用统一的TDE主加密密钥进行TDE列加密和TDE表空间加密。">关于重新加密TDE主加密密钥</a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-B6EBC385-D014-43AA-B9DE-DF08F2082712" title="在隔离模式下创建密钥库和TDE主加密密钥后，您可以执行管理任务，例如重新加密或标记加密密钥。">在隔离模式下管理密钥库和TDE主加密密钥</a></p>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-5F84010F-F74C-41FC-900F-741185B29AA0" name="GUID-5F84010F-F74C-41FC-900F-741185B29AA0"></a><h4 id="ASOAG-GUID-5F84010F-F74C-41FC-900F-741185B29AA0" class="sect4">在隔离模式下将TDE主加密密钥移动到新密钥库中</h4>
                  <div>
                     <p>在隔离模式下，您可以将现有TDE主加密密钥从现有软件密码密钥库移动到新密钥库中。</p>
                     <div class="section">此功能使您可以将密钥库密钥的子集或全部移动到新的密钥库中。将密钥或密钥移动到新密钥库，然后备份旧密钥库后，可以选择删除此旧密钥库。</div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>以已被授予<code class="codeph">ADMINISTER KEY MANAGEMENT</code>或<code class="codeph">SYSKM</code>权限的用户身份登录到隔离模式PDB。</span></li>
                        <li class="stepexpand"><span>查询<code class="codeph">V$ENCRYPTION_KEYS</code>视图的<code class="codeph">CREATION_TIME</code>和<code class="codeph">KEY_ID</code>列，以查找要移动的键的键标识符。</span><div>例如：<pre class="oac_no_warn" dir="ltr">SELECT CREATION_TIME，KEY_ID from V $ ENCRYPTION_KEYS;创造时间------------------------------------------------ ---- 22-SEP-17 08.55.12.956170 PM +00：00 KEY_ID -------------------------------- -------------------- ARaHD762tUkkvyLgPzAi6hMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</pre></div>
                        </li>
                        <li class="stepexpand"><span>使用以下语法将密钥移动到新的密钥库中：</span><div><pre class="oac_no_warn" dir="ltr">管理员密钥管理移动[加密]密钥到新<span class="italic">密钥</span> ' <span class="italic">keystore_location1</span> '通过<span class="italic">keystore1_password</span>标识FROM [FORCE] KEYSTORE由<span class="italic">keystore_password</span>标识[WITH IDENTIFIER IN {' <span class="italic">key_identifier</span> '[，' <span class="italic">key_identifier</span> '] ... | （ <span class="italic">子查询</span> ）}] [WITH BACKUP [使用' <span class="italic">backup_identifier</span> ']];</pre><p>在本规范中：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><code class="codeph"><span class="codeinlineitalic">keystore_location1</span></code>是将存储新密钥库<code class="codeph">.p12</code>文件的<code class="codeph">wallet</code>目录的路径。默认情况下，此目录为<code class="codeph">$ORACLE_BASE/admin/ <span class="codeinlineitalic">db_unique_name</span> /wallet</code> 。
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">FORCE</code>临时打开此操作的密钥库。
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph"><span class="codeinlineitalic">keystore_password</span></code>是密钥从中移动的密钥<code class="codeph"><span class="codeinlineitalic">keystore_password</span></code>的密码。
                                    </p>
                                 </li>
                              </ul>
                              <p>例如：</p><pre class="oac_no_warn" dir="ltr">ADMINISTER密钥管理将密钥移动到新的KEYSTORE'$ ORACLE_BASE / admin / orcl / wallet'通过<span class="italic">keystore_password</span>标识来自FORCE KEYSTORE IDENTIFIED by <span class="italic">keystore_password</span> WITH IDENTIFIER IN（SELECT KEY_ID from V $ ENCRYPTION_KEYS WHERE ROWNUM &lt;2）WITH BACKUP;</pre></div>
                           <div>将密钥移动到新密钥库后，它们将不再存在于旧密钥库中。</div>
                        </li>
                        <li class="stepexpand"><span>要删除旧密钥库，请转到<code class="codeph">wallet</code>目录并执行以下操作：</span><ol type="a">
                              <li><span>备份包含要删除的密钥库的<code class="codeph">.p12</code>文件。</span></li>
                              <li><span>手动删除包含密钥库的<code class="codeph">.p12</code>文件。</span></li>
                           </ol>
                           <div>要查找密钥库的位置，请打开密钥库，然后查询<code class="codeph">V$ENCRYPTION_WALLET</code>视图的<code class="codeph">WRL_PARAMETER</code>列。
                           </div>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="managing-keystore-and-tde-master-encryption-key.html#GUID-5CC83A60-8EA4-4984-AD2C-42BC12E5A16F" title="Oracle强烈建议您在将密钥库加密密钥移动到新密钥库之前不要删除密钥库。">删除密钥库的危险</a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-B6EBC385-D014-43AA-B9DE-DF08F2082712" title="在隔离模式下创建密钥库和TDE主加密密钥后，您可以执行管理任务，例如重新加密或标记加密密钥。">在隔离模式下管理密钥库和TDE主加密密钥</a></p>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-3178B6A8-E950-479A-B5E1-500F8FF56C7A" name="GUID-3178B6A8-E950-479A-B5E1-500F8FF56C7A"></a><h4 id="ASOAG-GUID-3178B6A8-E950-479A-B5E1-500F8FF56C7A" class="sect4">在隔离模式下创建自定义属性标记</h4>
                  <div>
                     <p>要在隔离模式下创建自定义属性标记，必须使用<code class="codeph">ADMINISTER KEY MANAGEMENT</code>语句的<code class="codeph">SET TAG</code>子句。
                     </p>
                     <div class="section">
                        <ol>
                           <li>
                              <p>以已被授予<code class="codeph">ADMINISTER KEY MANAGEMENT</code>或<code class="codeph">SYSKM</code>权限的用户身份登录到隔离模式PDB。
                              </p>
                           </li>
                           <li>
                              <p>如有必要，请查询<code class="codeph">V$ENCRYPTION_KEY</code>动态视图的<code class="codeph">TAG</code>列，以查找TDE主加密密钥的现有标记列表。
                              </p>
                              <p>为TDE主加密密钥创建新标记时，它会覆盖该TDE主加密密钥的现有标记。</p>
                           </li>
                           <li>
                              <p>使用以下语法创建自定义属性标记：</p><pre class="oac_no_warn" dir="ltr">ADMINISTER密钥管理SET TAG '标签'已确定BY [外挂<span class="italic">'master_key_identifier'[FORCE</span>密钥库] | <span class="italic">keystore_password</span> ] [WITH BACKUP [使用' <span class="italic">backup_identifier</span> ']];</pre><p>在本规范中：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><span class="italic"><code class="codeph">tag</code></span>是您定义的关联属性或信息。将此信息用单引号（ <code class="codeph">' '</code> ）括起来。
                                    </p>
                                 </li>
                                 <li>
                                    <p><span class="italic"><code class="codeph">master_key_identifier</code></span>标识为其设置<span class="italic"><code class="codeph">tag</code></span>的TDE主加密密钥。要查找TDE主加密密钥标识符列表，请查询<code class="codeph">V$ENCRYPTION_KEYS</code>动态视图的<code class="codeph">KEY_ID</code>列。
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">FORCE KEYSTORE</code>临时打开此操作的受密码保护的密钥库。您必须打开此操作的密钥库。
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">IDENTIFIED BY</code>可以是以下设置之一：</p>
                                    <ul style="list-style-type:disc">
                                       <li>
                                          <p><code class="codeph">EXTERNAL STORE</code>使用存储在外部存储中的密钥库密码来执行密钥库操作。
                                          </p>
                                       </li>
                                       <li>
                                          <p><span class="italic"><code class="codeph">keystore_password</code></span>是为此密钥库创建的密码。
                                          </p>
                                       </li>
                                       <li>
                                          <p><span class="italic"><code class="codeph">backup_identifier</code></span>定义标记值。将此设置括在单引号（ <code class="codeph">' ')</code>并用冒号分隔每个值。
                                          </p>
                                       </li>
                                    </ul>
                                 </li>
                              </ul>
                              <p>例如，要创建使用两个值的标记，一个用于捕获特定的会话ID，另一个用于捕获特定的终端ID：</p><pre class="oac_no_warn" dir="ltr">ADMINISTER密钥管理集加密密钥使用标记'sessionid = 3205062574：terminal = xcvt'通过<span class="italic">keystore_password</span> IDENTIFIED WITH BACKUP;密钥库已更改。
</pre><p>会话ID（ <code class="codeph">3205062574</code> ）和终端ID（ <code class="codeph">xcvt</code> ）都可以通过使用带有<code class="codeph">USERENV</code>名称空间的<code class="codeph">SYS_CONTEXT</code>函数或使用<code class="codeph">USERENV</code>函数来派生它们的值。
                              </p>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="managing-keystore-and-tde-master-encryption-key.html#GUID-2934A241-AB48-4EEF-8A65-3638209931AB" title="使用属性标记可以监视用户执行的特定活动，例如访问特定的终端ID。">关于创建自定义属性标记</a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-B6EBC385-D014-43AA-B9DE-DF08F2082712" title="在隔离模式下创建密钥库和TDE主加密密钥后，您可以执行管理任务，例如重新加密或标记加密密钥。">在隔离模式下管理密钥库和TDE主加密密钥</a></p>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-D678DC98-E77C-4F5D-8E5C-45D5FED0A5AF" name="GUID-D678DC98-E77C-4F5D-8E5C-45D5FED0A5AF"></a><h4 id="ASOAG-GUID-D678DC98-E77C-4F5D-8E5C-45D5FED0A5AF" class="sect4">在隔离模式下导出和导入TDE主加密密钥</h4>
                  <div>
                     <p>您可以在隔离模式下以不同方式导出和导入TDE主加密密钥。</p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-D4384898-E376-43A4-9FC5-380E14AF3C13">在隔离模式下导出TDE主加密密钥</a><br>在隔离模式下，您可以使用<code class="codeph">ADMINISTER KEY MANAGEMENT</code>语句导出TDE主加密密钥。
                        </li>
                        <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-927A28A5-5F2A-439E-8769-09AD2AF46A2A">在隔离模式下导入TDE主加密密钥</a><br>具有<code class="codeph">IMPORT [ENCRYPTION] KEYS WITH SECRET</code>子句的<code class="codeph">ADMINISTER KEY MANAGEMENT</code>语句可以导入TDE主加密密钥。
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-B6EBC385-D014-43AA-B9DE-DF08F2082712" title="在隔离模式下创建密钥库和TDE主加密密钥后，您可以执行管理任务，例如重新加密或标记加密密钥。">在隔离模式下管理密钥库和TDE主加密密钥</a></p>
                        </div>
                     </div>
                  </div>
                  
                  <div class="props_rev_3"><a id="GUID-D4384898-E376-43A4-9FC5-380E14AF3C13" name="GUID-D4384898-E376-43A4-9FC5-380E14AF3C13"></a><h5 id="ASOAG-GUID-D4384898-E376-43A4-9FC5-380E14AF3C13" class="sect5">在隔离模式下导出TDE主加密密钥</h5>
                     <div>
                        <p>在隔离模式下，您可以使用<code class="codeph">ADMINISTER KEY MANAGEMENT</code>语句导出TDE主加密密钥。
                        </p>
                        <div class="section">
                           <ol>
                              <li>
                                 <p>以已被授予<code class="codeph">ADMINISTER KEY MANAGEMENT</code>或<code class="codeph">SYSKM</code>权限的用户身份登录到隔离模式PDB。
                                 </p>
                              </li>
                              <li>
                                 <p>使用以下语法导出TDE主加密密钥库：</p><pre class="oac_no_warn" dir="ltr">管理员密钥管理导出[加密]密钥与“外部商店”识别的“ <span class="italic">export_secret</span> ”到' <span class="italic">file_path</span> '[FORCE KEYSTORE] <span class="italic">keystore_password</span> ] [WITH IDENTIFIER <span class="italic">IN'key_id1</span> '，' <span class="italic">key_id2</span> '，' <span class="italic">key_idn</span> '| （ <span class="italic">SQL_query</span> ）];</pre><p>在本规范中：</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p><span class="italic"><code class="codeph">export_secret</code></span>是一个密码，您可以指定该密码来加密导出包含导出密钥的文件。用双引号（ <code class="codeph">" "</code> ）括起这个秘密，或者如果秘密没有空格，你可以省略引号。
                                       </p>
                                    </li>
                                    <li>
                                       <p><span class="italic"><code class="codeph">file_path</code></span>是必须将密钥导出到的文件的完整路径和名称。将此路径括在单引号（ <code class="codeph">' '</code> ）中。您只能导出到常规文件系统。
                                       </p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">FORCE KEYSTORE</code>临时打开此操作的受密码保护的密钥库。您必须打开此操作的密钥库。
                                       </p>
                                    </li>
                                    <li>
                                       <p><span class="italic"><code class="codeph">key_id1</code></span> ， <span class="italic"><code class="codeph">key_id2</code></span> ， <span class="italic"><code class="codeph">key_idn</code></span>是用于导出的TDE主加密密钥的一个或多个TDE主加密密钥标识符的字符串。用逗号分隔每个密钥标识符，并将每个密钥标识符用单引号（ <code class="codeph">' '</code> ）括起来。要查找TDE主加密密钥标识符，请查询<code class="codeph">V$ENCRYPTION_KEYS</code>动态视图的<code class="codeph">KEY_ID</code>列。
                                       </p>
                                    </li>
                                    <li>
                                       <p><span class="italic"><code class="codeph">SQL_query</code></span>是一个获取TDE主加密密钥标识符列表的查询。它应该只返回一个包含TDE主加密密钥标识符的列。使用当前用户权限执行此查询。
                                       </p>
                                    </li>
                                 </ul>
                              </li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>相关话题</strong></p>
                           <ul>
                              <li><a href="managing-keystore-and-tde-master-encryption-key.html#GUID-85A465EB-50E2-482C-8AC5-851436AB8F8F" title="您可以以不同方式导出和导入TDE主加密密钥。">导出和导入TDE主加密密钥</a></li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-D678DC98-E77C-4F5D-8E5C-45D5FED0A5AF" title="您可以在隔离模式下以不同方式导出和导入TDE主加密密钥。">在隔离模式下导出和导入TDE主加密密钥</a></p>
                           </div>
                        </div>
                     </div>
                  </div>
                  <div class="props_rev_3"><a id="GUID-927A28A5-5F2A-439E-8769-09AD2AF46A2A" name="GUID-927A28A5-5F2A-439E-8769-09AD2AF46A2A"></a><h5 id="ASOAG-GUID-927A28A5-5F2A-439E-8769-09AD2AF46A2A" class="sect5">在隔离模式下导入TDE主加密密钥</h5>
                     <div>
                        <p>具有<code class="codeph">IMPORT [ENCRYPTION] KEYS WITH SECRET</code>子句的<code class="codeph">ADMINISTER KEY MANAGEMENT</code>语句可以导入TDE主加密密钥。
                        </p>
                        <div class="section">
                           <ol>
                              <li>
                                 <p>以已被授予<code class="codeph">ADMINISTER KEY MANAGEMENT</code>或<code class="codeph">SYSKM</code>权限的用户身份登录到隔离模式PDB。
                                 </p>
                                 <p>请联系您的<code class="codeph">SYSDBA</code>管理员以获取正确的PDB。要检查当前容器，请运行<code class="codeph">SHOW CON_NAME</code>命令。
                                 </p>
                              </li>
                              <li>
                                 <p>运行以下SQL语句：</p><pre class="oac_no_warn" dir="ltr">管理员密钥管理导入[加密]密钥“ <span class="italic">admin_secret</span> ”FROM“ <span class="italic">file_name</span> ”[FORCE KEYSTORE]由[EXTERNAL STORE | <span class="italic">keystore_password</span> ] [WITH BACKUP [使用' <span class="italic">backup_identifier</span> ']];</pre><p>在本规范中：</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p><span class="italic"><code class="codeph">import_secret</code></span>与导出操作期间用于加密密钥的密码相同。用双引号（ <code class="codeph">" "</code> ）括起这个秘密，或者如果秘密没有空格，你可以省略引号。
                                       </p>
                                    </li>
                                    <li>
                                       <p><span class="italic"><code class="codeph">file_name</code></span>是需要从中导入密钥的文件的完整路径和名称。将此设置括在单引号（ <code class="codeph">' '</code> ）中。
                                       </p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">FORCE KEYSTORE</code>临时打开此操作的受密码保护的密钥库。您必须打开此操作的密钥库。
                                       </p>
                                    </li>
                                 </ul>
                              </li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>相关话题</strong></p>
                           <ul>
                              <li><a href="managing-keystore-and-tde-master-encryption-key.html#GUID-85A465EB-50E2-482C-8AC5-851436AB8F8F" title="您可以以不同方式导出和导入TDE主加密密钥。">导出和导入TDE主加密密钥</a></li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-D678DC98-E77C-4F5D-8E5C-45D5FED0A5AF" title="您可以在隔离模式下以不同方式导出和导入TDE主加密密钥。">在隔离模式下导出和导入TDE主加密密钥</a></p>
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-F7052961-ECD0-4AD5-BC14-5E0715C9DE33" name="GUID-F7052961-ECD0-4AD5-BC14-5E0715C9DE33"></a><h4 id="ASOAG-GUID-F7052961-ECD0-4AD5-BC14-5E0715C9DE33" class="sect4">以隔离模式存储Oracle数据库秘密</h4>
                  <div>
                     <p>秘密是支持内部Oracle数据库功能的数据，这些功能将外部客户端（如Oracle GoldenGate）集成到数据库中。</p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-DE1E8671-BC7F-4B1E-B4A8-35DF0CA37836">在隔离模式下将Oracle数据库秘密存储在软件密钥库中</a><br><code class="codeph">ADMINISTER KEY MANAGEMENT ADD SECRET|UPDATE SECRET|DELETE SECRET</code>语句可以在密钥库中添加秘密，更新机密和删除机密。
                        </li>
                        <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-C1899D3D-4EB4-4F6E-A08F-7F5736CE41A6">在隔离模式下将Oracle数据库秘密存储在硬件密钥库中</a><br><code class="codeph">ADMINISTER KEY MANAGEMENT ADD SECRET|UPDATE SECRET|DELETE SECRET</code>语句可以在密钥库中添加秘密，更新机密和删除机密。
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-B6EBC385-D014-43AA-B9DE-DF08F2082712" title="在隔离模式下创建密钥库和TDE主加密密钥后，您可以执行管理任务，例如重新加密或标记加密密钥。">在隔离模式下管理密钥库和TDE主加密密钥</a></p>
                        </div>
                     </div>
                  </div>
                  
                  <div class="sect4"><a id="GUID-DE1E8671-BC7F-4B1E-B4A8-35DF0CA37836" name="GUID-DE1E8671-BC7F-4B1E-B4A8-35DF0CA37836"></a><h5 id="ASOAG-GUID-DE1E8671-BC7F-4B1E-B4A8-35DF0CA37836" class="sect5">在隔离模式下将Oracle数据库秘密存储在软件密钥库中</h5>
                     <div>
                        <p><code class="codeph">ADMINISTER KEY MANAGEMENT ADD SECRET|UPDATE SECRET|DELETE SECRET</code>语句可以在密钥库中添加秘密，更新机密和删除机密。
                        </p>
                        <ol>
                           <li class="stepexpand"><span>以已被授予<code class="codeph">ADMINISTER KEY MANAGEMENT</code>或<code class="codeph">SYSKM</code>权限的用户身份登录到隔离模式PDB。</span></li>
                           <li class="stepexpand"><span>使用以下语法在软件密钥库中添加，更新或删除数据库密钥：</span><ul>
                                 <li>添加秘密：<pre class="oac_no_warn" dir="ltr">管理员密钥管理为客户' <span class="italic">client_identifier</span> '[使用标签' <span class="italic">标签</span> '] [TO [[LOCAL] AUTOLOGIN] KEYSTORE <span class="italic">keystore_location</span> [WITH BACKUP [USING <span class="italic">backup_id</span> ]] |添加秘密' <span class="italic">秘密</span> ' [FORCE KEYSTORE]由[EXTERNAL STORE |]识别<span class="italic">keystore_password</span> ] [WITH BACKUP [USING <span class="italic">backup_id</span> ]]];</pre></li>
                                 <li>更新秘密：<pre class="oac_no_warn" dir="ltr">管理员密钥管理更新秘密' <span class="italic">秘密</span> '为客户' <span class="italic">client_identifier</span> '[使用标签' <span class="italic">标签</span> '] [TO [[LOCAL] AUTOLOGIN] KEYSTORE <span class="italic">keystore_location</span> [WITH BACKUP [USING <span class="italic">backup_id</span> ]] | [FORCE KEYSTORE]由[EXTERNAL STORE |]识别<span class="italic">keystore_password</span> ] [WITH BACKUP [USING <span class="italic">backup_id</span> ]]];</pre></li>
                                 <li>删除秘密：<pre class="oac_no_warn" dir="ltr">ADMINISTER密钥管理删除客户端' <span class="italic">client_identifier</span> '的秘密[FROM [[LOCAL] AUTOLOGIN] KEYSTORE <span class="italic">keystore_location</span> [FORCE KEYSTORE]由[EXTERNAL STORE | <span class="italic">keystore_password</span> ] [WITH BACKUP [USING <span class="italic">backup_id</span> ]]];</pre></li>
                              </ul>
                              <div>
                                 <p>规范如下：</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p><code class="codeph"><span class="codeinlineitalic">secret</span></code>是要存储，更新或删除的客户端密钥。要查找有关现有机密及其客户机标识符的信息，请查询<code class="codeph">V$CLIENT_SECRETS</code>动态视图。
                                       </p>
                                    </li>
                                    <li>
                                       <p><code class="codeph"><span class="codeinlineitalic">client_identifier</span></code>是用于标识密钥的字母数字字符串。
                                       </p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">FORCE KEYSTORE</code>临时打开此操作的受密码保护的密钥库。您必须打开此操作的密钥库。
                                       </p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>相关话题</strong></p>
                           <ul>
                              <li><a href="managing-keystore-and-tde-master-encryption-key.html#GUID-FF270B27-A456-477A-81E0-50E74926A810" title="秘密是支持内部Oracle数据库功能的数据，这些功能将外部客户端（如Oracle GoldenGate）集成到数据库中。">存储Oracle数据库的秘密</a></li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-F7052961-ECD0-4AD5-BC14-5E0715C9DE33" title="秘密是支持内部Oracle数据库功能的数据，这些功能将外部客户端（如Oracle GoldenGate）集成到数据库中。">以隔离模式存储Oracle数据库秘密</a></p>
                           </div>
                        </div>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-C1899D3D-4EB4-4F6E-A08F-7F5736CE41A6" name="GUID-C1899D3D-4EB4-4F6E-A08F-7F5736CE41A6"></a><h5 id="ASOAG-GUID-C1899D3D-4EB4-4F6E-A08F-7F5736CE41A6" class="sect5">在隔离模式下将Oracle数据库秘密存储在硬件密钥库中</h5>
                     <div>
                        <p><code class="codeph">ADMINISTER KEY MANAGEMENT ADD SECRET|UPDATE SECRET|DELETE SECRET</code>语句可以在密钥库中添加秘密，更新机密和删除机密。
                        </p>
                        <ol>
                           <li class="stepexpand"><span>以已被授予<code class="codeph">ADMINISTER KEY MANAGEMENT</code>或<code class="codeph">SYSKM</code>权限的用户身份登录到隔离模式PDB。</span></li>
                           <li class="stepexpand"><span>使用以下语法在硬件密钥库中添加，更新或删除数据库密钥：</span><ul>
                                 <li>添加秘密：<pre class="oac_no_warn" dir="ltr">ADMINISTER密钥管理添加秘密' <span class="italic">秘密</span> '为客户' <span class="italic">client_identifier</span> '[使用标签' <span class="italic">标签</span> '] [TO [[LOCAL] AUTOLOGIN] KEYSTORE <span class="italic">keystore_location</span> [FORCE KEYSTORE] IDENTIFIED BY“ <span class="italic">hardware_keystore_credentials</span> ”] [WITH BACKUP [USING <span class="italic">backup_id</span> ]];</pre></li>
                                 <li>更新秘密：<pre class="oac_no_warn" dir="ltr">ADMINISTER密钥管理更新秘密' <span class="italic">秘密</span> '为客户' <span class="italic">client_identifier</span> '[使用标签' <span class="italic">标签</span> '] [TO [[LOCAL] AUTOLOGIN] KEYSTORE <span class="italic">keystore_location</span> [FORCE KEYSTORE]标识为“ <span class="italic">hardware_keystore_credentials</span> ”[WITH BACKUP [USING <span class="italic">backup_id</span> ]];</pre></li>
                                 <li>删除秘密：<pre class="oac_no_warn" dir="ltr">ADMINISTER密钥管理删除客户端' <span class="italic">client_identifier</span> '的秘密[FROM [[LOCAL] AUTOLOGIN] KEYSTORE <span class="italic">keystore_location</span> [FORCE KEYSTORE] IDENTIFIED BY“ <span class="italic">hardware_keystore_credentials</span> ”;</pre></li>
                              </ul>
                              <div>
                                 <p>规范如下：</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p><code class="codeph"><span class="codeinlineitalic">secret</span></code>是要存储，更新或删除的客户端密钥。要查找有关现有机密及其客户机标识符的信息，请查询<code class="codeph">V$CLIENT_SECRETS</code>动态视图。
                                       </p>
                                    </li>
                                    <li>
                                       <p><code class="codeph"><span class="codeinlineitalic">client_identifier</span></code>是用于标识密钥的字母数字字符串。
                                       </p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">FORCE KEYSTORE</code>临时打开此操作的受密码保护的密钥库。您必须打开此操作的密钥库。
                                       </p>
                                    </li>
                                    <li>
                                       <p><code class="codeph"><span class="codeinlineitalic">hardware_keystore_credentials</span></code>是指HSM或Oracle Key Vault硬件密钥库的凭据。对于HSM，请使用此格式指定凭据，用引号括起并用冒号分隔组件： <code class="codeph">“ <span class="codeinlineitalic">user_name</span> : <span class="codeinlineitalic">password</span> ”</code> ，其中<code class="codeph"><span class="codeinlineitalic">user_name</span></code>是创建HSM的用户，密码是此用户的密码。对于Oracle Key Vault，仅输入创建密钥库的用户的密码。用引号括起此密码。
                                       </p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>相关话题</strong></p>
                           <ul>
                              <li><a href="managing-keystore-and-tde-master-encryption-key.html#GUID-FF270B27-A456-477A-81E0-50E74926A810" title="秘密是支持内部Oracle数据库功能的数据，这些功能将外部客户端（如Oracle GoldenGate）集成到数据库中。">存储Oracle数据库的秘密</a></li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-F7052961-ECD0-4AD5-BC14-5E0715C9DE33" title="秘密是支持内部Oracle数据库功能的数据，这些功能将外部客户端（如Oracle GoldenGate）集成到数据库中。">以隔离模式存储Oracle数据库秘密</a></p>
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-0E28EE78-196D-424C-B861-2CDC2181C40A" name="GUID-0E28EE78-196D-424C-B861-2CDC2181C40A"></a><h4 id="ASOAG-GUID-0E28EE78-196D-424C-B861-2CDC2181C40A" class="sect4">以隔离模式迁移密钥库</h4>
                  <div>
                     <p>您可以在隔离模式下在软件密钥库和硬件密钥库之间执行迁移和反向迁移操作。</p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-1E3F03F8-A9C6-4D7D-9971-84A563551CC0">在隔离模式下从受密码保护的软件密钥库迁移到硬件密钥库</a><br>在隔离模式下，您可以从受密码保护的软件密钥库迁移到硬件密钥库。
                        </li>
                        <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-A1A95DE0-10E6-45C7-91F3-33D09F322FA4">在隔离模式下从硬件密钥库迁移到受密码保护的软件密钥库</a><br>在隔离模式下，您可以从硬件密钥库迁移到受密码保护的软件密钥库。
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-B6EBC385-D014-43AA-B9DE-DF08F2082712" title="在隔离模式下创建密钥库和TDE主加密密钥后，您可以执行管理任务，例如重新加密或标记加密密钥。">在隔离模式下管理密钥库和TDE主加密密钥</a></p>
                        </div>
                     </div>
                  </div>
                  
                  <div class="sect4"><a id="GUID-1E3F03F8-A9C6-4D7D-9971-84A563551CC0" name="GUID-1E3F03F8-A9C6-4D7D-9971-84A563551CC0"></a><h5 id="ASOAG-GUID-1E3F03F8-A9C6-4D7D-9971-84A563551CC0" class="sect5">在隔离模式下从受密码保护的软件密钥库迁移到硬件密钥库</h5>
                     <div>
                        <p>在隔离模式下，您可以从受密码保护的软件密钥库迁移到硬件密钥库。</p>
                        <ol>
                           <li class="stepexpand"><span>以已被授予<code class="codeph">ADMINISTER KEY MANAGEMENT</code>或<code class="codeph">SYSKM</code>权限的用户身份登录到隔离模式PDB。</span></li>
                           <li class="stepexpand"><span>将软件密钥库转换为使用硬件密钥库打开。</span><div>某些Oracle工具（如Oracle Data Pump和Oracle Recovery Manager）需要访问旧的软件密钥库才能加密或解密使用软件密钥库导出或备份的数据。</div>
                              <ul>
                                 <li>要将软件密钥库密码设置为硬件密钥库的密码，请使用以下语法：<pre class="oac_no_warn" dir="ltr">ADMINISTER密钥管理ALTER KEYSTORE PASSWORD [FORCE KEYSTORE]由<span class="italic">software_keystore_password</span>标识SET“ <span class="italic">harware_keystore_credentials</span> ”WITH BACKUP [使用' <span class="italic">backup_identifier</span> '];</pre><p>在本规范中：</p>
                                    <ul style="list-style-type:disc">
                                       <li>
                                          <p><code class="codeph"><span class="codeinlineitalic">software_keystore_password</span></code>是在创建密钥库时分配给该密钥库的密码。
                                          </p>
                                       </li>
                                       <li>
                                          <p><code class="codeph"><span class="codeinlineitalic">hardware_keystore_credentials</span></code>是指HSM或Oracle Key Vault硬件密钥库的凭据。对于HSM，请使用此格式指定凭据，用引号括起并用冒号分隔组件： <code class="codeph">“ <span class="codeinlineitalic">user_name</span> : <span class="codeinlineitalic">password</span> ”</code> ，其中<code class="codeph"><span class="codeinlineitalic">user_name</span></code>是创建HSM的用户，密码是此用户的密码。对于Oracle Key Vault，仅输入创建密钥库的用户的密码。用引号括起此密码。
                                          </p>
                                       </li>
                                    </ul>
                                 </li>
                                 <li>要为软件密钥库创建自动登录密钥库，请使用以下语法：<pre class="oac_no_warn" dir="ltr">ADMINISTER密钥管理CREATE [LOCAL] AUTO_LOGIN密钥库FROM IDENTIFIED BY <span class="italic">software_keystore_password</span>密钥库<span class="italic">'keystore_location';</span></pre></li>
                              </ul>
                           </li>
                           <li class="stepexpand"><span>编辑初始化参数文件中的<code class="codeph">WALLET_ROOT</code>参数，以便PDB指向密钥库的新位置。</span><div>要使用硬件密钥库打开软件密钥库，软件密钥库必须具有与硬件密钥库相同的密码，或者，您可以为软件密钥库创建自动登录密钥库。</div>
                           </li>
                           <li class="stepexpand"><span>使用以下语法迁移硬件密钥库：</span><div><pre class="oac_no_warn" dir="ltr">ADMINISTER密钥管理集由“ <span class="italic">hardware_keystore_credentials</span> ”[FORCE KEYSTORE]标识的加密密钥使用<span class="italic">software_keystore_password进行</span>迁移[WITH BACKUP [使用' <span class="italic">backup_identifier</span> ']];</pre></div>
                              <div>完成迁移后，您无需重新启动数据库，也无需手动重新打开硬件密钥库。迁移过程会自动在内存中重新加载密钥库密钥。</div>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>相关话题</strong></p>
                           <ul>
                              <li><a href="managing-keystore-and-tde-master-encryption-key.html#GUID-F87514AE-4D8B-475F-A5D9-85C4737C7D70" title="执行迁移后，密钥库的顺序可以是主存储或辅助存储。">迁移后的密钥库顺序</a></li>
                              <li><a href="managing-keystore-and-tde-master-encryption-key.html#GUID-83DE1475-04DD-4B85-9CFA-D00AB0013EC8" title="您可以使用Oracle Key Vault将软件和硬件密钥库迁移到Oracle Key Vault或从Oracle Key Vault迁移。">从Key Key Vault迁移密钥库</a></li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-0E28EE78-196D-424C-B861-2CDC2181C40A" title="您可以在隔离模式下在软件密钥库和硬件密钥库之间执行迁移和反向迁移操作。">以隔离模式迁移密钥库</a></p>
                           </div>
                        </div>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-A1A95DE0-10E6-45C7-91F3-33D09F322FA4" name="GUID-A1A95DE0-10E6-45C7-91F3-33D09F322FA4"></a><h5 id="ASOAG-GUID-A1A95DE0-10E6-45C7-91F3-33D09F322FA4" class="sect5">在隔离模式下从硬件密钥库迁移到受密码保护的软件密钥库</h5>
                     <div>
                        <p>在隔离模式下，您可以从硬件密钥库迁移到受密码保护的软件密钥库。</p>
                        <ol>
                           <li class="stepexpand"><span>以已被授予<code class="codeph">ADMINISTER KEY MANAGEMENT</code>或<code class="codeph">SYSKM</code>权限的用户身份登录到隔离模式PDB。</span></li>
                           <li class="stepexpand"><span>编辑<code class="codeph">init.ora</code>初始化文件中的<code class="codeph">WALLET_ROOT</code>参数，以便PDB指向密钥库的新位置。</span><div>要使用硬件密钥库打开软件密钥库，软件密钥库必须具有与硬件密钥库相同的密码，或者，您可以为软件密钥库创建自动登录密钥库。</div>
                           </li>
                           <li class="stepexpand"><span>使用以下语法为反向迁移配置密钥库：</span><div><pre class="oac_no_warn" dir="ltr">管理员密钥管理集由<span class="italic">software_keystore_password</span>标识的加密密钥使用“ <span class="italic">harware_keystore_credentials</span> ”反向迁移[WITH BACKUP [使用' <span class="italic">backup_identifier</span> ']];</pre></div>
                           </li>
                           <li class="stepexpand"><span>（可选）更改新迁移的软件密钥库的密码。</span><div>例如：<pre class="oac_no_warn" dir="ltr">通过<span class="italic">old_password</span>标识的ADMINISTER密钥管理ALTER KEYSTORE PASSWORD使用'pwd_change'设置<span class="italic">new_password</span> WITH BACKUP</pre></div>
                           </li>
                        </ol>
                        <div class="section">完成这些步骤后，迁移过程会自动在内存中重新加载密钥库密钥。您无需重新启动数据库，也无需手动重新打开软件密钥库。反向迁移后仍可能需要硬件密钥库，因为旧密钥可能已用于加密备份或Oracle Data Pump和Oracle Recovery Manager等工具。您应该将硬件密钥库凭据缓存在密钥库中，以便可以使用软件密钥库打开HSM。</div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>相关话题</strong></p>
                           <ul>
                              <li><a href="managing-keystore-and-tde-master-encryption-key.html#GUID-0C8C054A-0F63-4BD1-9B4C-C2581029B463" title="要从使用硬件密钥库解决方案切换到软件密钥库，您可以使用密钥库的反向迁移。">关于从硬件密钥库迁移</a></li>
                              <li><a href="managing-keystore-and-tde-master-encryption-key.html#GUID-F87514AE-4D8B-475F-A5D9-85C4737C7D70" title="执行迁移后，密钥库的顺序可以是主存储或辅助存储。">迁移后的密钥库顺序</a></li>
                              <li><a href="managing-keystore-and-tde-master-encryption-key.html#GUID-83DE1475-04DD-4B85-9CFA-D00AB0013EC8" title="您可以使用Oracle Key Vault将软件和硬件密钥库迁移到Oracle Key Vault或从Oracle Key Vault迁移。">从Key Key Vault迁移密钥库</a></li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-0E28EE78-196D-424C-B861-2CDC2181C40A" title="您可以在隔离模式下在软件密钥库和硬件密钥库之间执行迁移和反向迁移操作。">以隔离模式迁移密钥库</a></p>
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-717E6E9A-CC84-493F-B5C4-675729DC6ECE" name="GUID-717E6E9A-CC84-493F-B5C4-675729DC6ECE"></a><h4 id="ASOAG-GUID-717E6E9A-CC84-493F-B5C4-675729DC6ECE" class="sect4">在隔离模式下自动删除不活动的TDE主加密密钥</h4>
                  <div>
                     <p>在隔离模式下， <code class="codeph">REMOVE_INACTIVE_STANDBY_TDE_MASTER_KEY</code>初始化参数可以配置自动删除非活动主加密密钥。
                     </p>
                     <ol>
                        <li class="stepexpand"><span>登录隔离模式PDB备用数据库所在的服务器。</span></li>
                        <li class="stepexpand"><span>找到数据库的<code class="codeph">init.ora</code>文件。</span><div>默认情况下， <code class="codeph">init.ora</code>文件位于<code class="codeph">$ORACLE_HOME/dbs</code>目录中。
                           </div>
                        </li>
                        <li class="stepexpand"><span>编辑<code class="codeph">init.ora</code>文件以包含<code class="codeph">REMOVE_INACTIVE_STANDBY_TDE_MASTER_KEY</code>初始化参数。</span><div>例如：<pre class="oac_no_warn" dir="ltr">remove_inactive_standby_tde_master_key = true</pre><p>将此参数设置为<code class="codeph">TRUE</code>可以自动删除非活动主加密密钥;将其设置为<code class="codeph">FALSE</code>会禁用自动删除。
                              </p>
                           </div>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-B6EBC385-D014-43AA-B9DE-DF08F2082712" title="在隔离模式下创建密钥库和TDE主加密密钥后，您可以执行管理任务，例如重新加密或标记加密密钥。">在隔离模式下管理密钥库和TDE主加密密钥</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-91E39FB9-025C-4653-AE42-B68D1F22798F" name="GUID-91E39FB9-025C-4653-AE42-B68D1F22798F"></a><h4 id="ASOAG-GUID-91E39FB9-025C-4653-AE42-B68D1F22798F" class="sect4">联合可插拔数据库密钥库</h4>
                  <div>
                     <p>联合PDB密钥库将TDE主加密密钥从PDB密钥库移动到CDB根的密钥库中。这使得CDB根的密钥库的管理员能够管理密钥。</p>
                     <div class="section">客户机密不会被移动。相反，它们被留在PDB在隔离模式下配置时使用的密钥库中。Oracle建议您在联合PDB密钥库之前从该密钥库中删除客户端机密。类似地，当PDB变得孤立时，CDB根的密钥库中包含的客户机密钥不会被移动。</div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>以已被授予<code class="codeph">ADMINISTER KEY MANAGEMENT</code>或<code class="codeph">SYSKM</code>权限的用户身份登录到隔离模式PDB。</span></li>
                        <li class="stepexpand"><span>联合PDB密钥库，使用以下语法将TDE主加密密钥从PDB密钥库移动到CDB根的密钥库中：</span><div><pre class="oac_no_warn" dir="ltr">管理密钥管理密钥库UNITE IDENTIFIED BY <span class="italic">isolated_keystore_password</span>不同根密钥库[FORCE密钥库] IDENTIFIED BY [外挂| <span class="italic">keystore_password_of_cdb_root</span> ] [WITH BACKUP [USING backup_id]];</pre><p>在本规范中：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>如果自动登录密钥库已打开（并且正在使用中）或密钥库已关闭， <code class="codeph">FORCE KEYSTORE</code>暂时打开此操作的受密码保护的密钥库。
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph"><span class="codeinlineitalic">united_keystore_password</span></code> ：了解此密码不会使执行<code class="codeph">UNITE KEYSTORE</code>操作权限的用户在PDB上执行<code class="codeph">ADMINISTER KEY MANAGEMENT UNITE KEYSTORE</code>操作。</p>
                                 </li>
                              </ul><pre class="oac_no_warn" dir="ltr"></pre></div>
                           <div>当PDB的密钥库与CDB根中的密钥库合并时，与PDB相关联的所有先前活动（历史）TDE主加密密钥被移动到CDB根的密钥库。</div>
                        </li>
                        <li class="stepexpand"><span>确认隔离模式PDB现在是联合模式PDB。</span><div><pre class="oac_no_warn" dir="ltr">从V $ ENCRYPTION_WALLET中选择KEYSTORE_MODE;</pre><p>输出应该是<code class="codeph">UNITED</code> 。</p>
                           </div>
                        </li>
                     </ol>
                     <div class="section">密钥库不再存在，但其主加密密钥现在位于CDB根目录的密钥库中。如果您以后决定再次将联合模式PDB作为隔离模式PDB，则可以使用<code class="codeph">ADMINISTER KEY MANAGEMENT ISOLATE KEYSTORE</code>语句。
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="managing-keystores-encryption-keys-in-united-mode.html#GUID-732D3890-6A80-4541-8489-B26A08BCEC17" title="隔离PDB密钥库会将主加密密钥从CDB根密钥库移动到PDB中的隔离模式密钥库。">隔离可插拔数据库密钥库</a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-B6EBC385-D014-43AA-B9DE-DF08F2082712" title="在隔离模式下创建密钥库和TDE主加密密钥后，您可以执行管理任务，例如重新加密或标记加密密钥。">在隔离模式下管理密钥库和TDE主加密密钥</a></p>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-7B39A544-0B5D-4BE5-9D33-33F0D74D72DD" name="GUID-7B39A544-0B5D-4BE5-9D33-33F0D74D72DD"></a><h4 id="ASOAG-GUID-7B39A544-0B5D-4BE5-9D33-33F0D74D72DD" class="sect4">PDB关闭时创建密钥库</h4>
                  <div>
                     <p>在已关闭的PDB中创建密钥库时，新密钥库为空，PDB将转换为隔离模式。</p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-AF0A3934-3024-4257-994A-988BEAC6FB89">关于PDB关闭时创建密钥库</a><br>在已关闭的PDB中创建密钥库可能会无意中导致重定密钥操作出现问题，但可以还原密钥库创建。
                        </li>
                        <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-2E350675-9643-419F-856D-6F264AA15A73">PDB关闭时还原密钥库创建操作</a><br>如果您无意中在PDB中创建了密钥库（从而导致它在隔离模式下配置），那么您应该反转密钥库创建操作。
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-B6EBC385-D014-43AA-B9DE-DF08F2082712" title="在隔离模式下创建密钥库和TDE主加密密钥后，您可以执行管理任务，例如重新加密或标记加密密钥。">在隔离模式下管理密钥库和TDE主加密密钥</a></p>
                        </div>
                     </div>
                  </div>
                  
                  <div class="sect4"><a id="GUID-AF0A3934-3024-4257-994A-988BEAC6FB89" name="GUID-AF0A3934-3024-4257-994A-988BEAC6FB89"></a><h5 id="ASOAG-GUID-AF0A3934-3024-4257-994A-988BEAC6FB89" class="sect5">关于PDB关闭时创建密钥库</h5>
                     <div>
                        <p>在已关闭的PDB中创建密钥库可能会无意中导致重定密钥操作出现问题，但可以还原密钥库创建。</p>
                        <p>在以前的版本中，如果您尝试在已关闭的PDB中创建密钥库，则会阻止您，并且将出现<code class="codeph">ORA-65040: operation not allowed from within a pluggable database</code>错误中执行<code class="codeph">ORA-65040: operation not allowed from within a pluggable database</code> 。从Oracle数据库版本18c开始，为方便起见，当PDB的密钥库关闭且在PDB中运行<code class="codeph">ADMINISTER KEY MANAGEMENT CREATE KEYSTORE</code>语句时，Oracle数据库允许该操作。
                        </p>
                        <p>如果已关闭的PDB尚未配置为使用加密（即，它从未在其中执行<code class="codeph">ADMINISTER KEY MANAGEMENT SET KEY</code>语句），则在执行<code class="codeph">ADMINISTER KEY MANAGEMENT CREATE KEYSTORE</code> ，将导致空密钥库和配置PDB更改为隔离模式，然后您可以在此空密钥库中创建TDE主加密密钥。
                        </p>
                        <p>但是，如果PDB已配置为使用加密，则PDB可以配置为联合模式（因此其TDE主加密密钥在CDB根的密钥库中进行管理）。</p>
                        <p>错误地在这样一个关闭的PDB上运行<code class="codeph">ADMINISTER KEY MANAGEMENT CREATE KEYSTORE</code>语句将创建一个额外的密钥库（它将为空），然后将PDB配置为处于隔离模式。这有效地错误配置了PDB，因为PDB现在处于隔离模式（而它应该处于联合模式），但其TDE主加密密钥仍然在CDB根的密钥库中。如果您尝试使用<code class="codeph">ADMINISTER KEY MANAGEMENT SET ENCRYPTION KEY</code>语句重新生成TDE主加密密钥，则此错误配置可能会导致以后出现问题。将显示<code class="codeph">ORA-28362: master key not found</code>错误，因为当已启用加密并且已设置密钥时，Oracle数据库会将<code class="codeph">ADMINISTER KEY MANAGEMENT SET ENCRYPTION KEY</code>语句视为重定密钥操作。为了执行重定密钥操作，Oracle数据库必须找到PDB的当前活动TDE主加密密钥。但是在这个配置错误的PDB中，Oracle数据库无法找到TDE主加密密钥，因为PDB现在处于隔离模式，并且必需的密钥位于CDB根的密钥库中。因此，PDB不再配置为在PDB的密钥库中进行搜索，并且重定密钥操作失败。
                        </p>
                        <p>要纠正PDB的错误配置，必须将PDB重新配置为联合模式，并且必须删除空密钥库。（在删除任何密钥库之前始终进行备份。）当PDB配置回联合模式时，当前活动的TDE主加密密钥再次可用于重定密钥和其他TDE主加密密钥操作。</p>
                        <p>如果稍后要将PDB配置为处于隔离模式，则可以打开PDB并运行<code class="codeph">ADMINISTER KEY MANAGEMENT ISOLATE KEYSTORE</code>语句，该语句隔离PDB并移动其TDE主加密密钥和以前活动（历史）密钥从CDB根目录的密钥库到新创建的隔离PDB密钥库。
                        </p>
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>相关话题</strong></p>
                           <ul>
                              <li><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-2E350675-9643-419F-856D-6F264AA15A73" title="如果您无意中在PDB中创建了密钥库（从而导致它在隔离模式下配置），那么您应该反转密钥库创建操作。">PDB关闭时还原密钥库创建操作</a></li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-7B39A544-0B5D-4BE5-9D33-33F0D74D72DD" title="在已关闭的PDB中创建密钥库时，新密钥库为空，PDB将转换为隔离模式。">PDB关闭时创建密钥库</a></p>
                           </div>
                        </div>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-2E350675-9643-419F-856D-6F264AA15A73" name="GUID-2E350675-9643-419F-856D-6F264AA15A73"></a><h5 id="ASOAG-GUID-2E350675-9643-419F-856D-6F264AA15A73" class="sect5">PDB关闭时还原密钥库创建操作</h5>
                     <div>
                        <p>如果您无意中在PDB中创建了密钥库（从而导致它在隔离模式下配置），那么您应该反转密钥库创建操作。</p>
                        <div class="section">如果您在已启用加密的已关闭PDB中创建了密钥库（即，它已具有TDE主加密密钥），请使用此过程。</div>
                        <!-- class="section" -->
                        <ol>
                           <li><span>以已被授予<code class="codeph">ADMINISTER KEY MANAGEMENT</code>或<code class="codeph">SYSKM</code>权限的用户身份登录到隔离模式PDB。</span></li>
                           <li><span>通过查询<code class="codeph">V$ENCRYPTION_WALLET</code>动态视图的<code class="codeph">KEYSTORE_MODE</code>列来确认PDB的模式。</span></li>
                           <li><span>如果<code class="codeph">V$ENCRYPTION_WALLET</code>输出为<code class="codeph">ISOLATED</code> ，则执行<code class="codeph">ALTER SYSTEM</code>语句以将PDB重新配置为联合模式。</span><ul>
                                 <li>使用pfile时，请使用以下语句清除<code class="codeph">TDE_CONFIGURATION</code>参数：<pre class="oac_no_warn" dir="ltr">ALTER SYSTEM RESET TDE_CONFIGURATION SCOPE = MEMORY;</pre><p>在Oracle Real Application Clusters环境中，包含<code class="codeph">SID</code>参数：</p><pre class="oac_no_warn" dir="ltr">ALTER SYSTEM RESET TDE_CONFIGURATION SCOPE = MEMORY SID ='*';</pre></li>
                                 <li>使用spfile时，使用以下语句清除<code class="codeph">TDE_CONFIGURATION</code>参数：<pre class="oac_no_warn" dir="ltr">ALTER SYSTEM RESET TDE_CONFIGURATION SCOPE = BOTH;</pre><p>在Oracle Real Application Clusters环境中，包含<code class="codeph">SID</code>参数：</p><pre class="oac_no_warn" dir="ltr">ALTER SYSTEM RESET TDE_CONFIGURATION SCOPE = SID ='*';</pre></li>
                              </ul>
                           </li>
                           <li><span>在<code class="codeph"><span class="codeinlineitalic">WALLET_ROOT</span> / <span class="codeinlineitalic">PDB_GUID</span> /tde</code>目录中，查找并备份错误创建的<code class="codeph">ewallet.p12</code>密钥库文件。</span></li>
                           <li><span>删除错误创建的空密钥库文件。</span></li>
                        </ol>
                        <div class="section">在此阶段，PDB将处于联合模式，并且正确的密钥库和TDE主加密密钥将可用于任何将来的重新密钥操作。</div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-7B39A544-0B5D-4BE5-9D33-33F0D74D72DD" title="在已关闭的PDB中创建密钥库时，新密钥库为空，PDB将转换为隔离模式。">PDB关闭时创建密钥库</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-5316DC4C-BAFF-4653-9884-34F121AD878C" name="GUID-5316DC4C-BAFF-4653-9884-34F121AD878C"></a><h3 id="ASOAG-GUID-5316DC4C-BAFF-4653-9884-34F121AD878C" class="sect3">在隔离模式下管理透明数据加密</h3>
               <div>
                  <p>您可以在隔离模式下使用透明数据加密执行许多常规管理任务。</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-51BFBDC0-F56E-4D77-B85E-9696CCCE10BA">在隔离模式下将PDB从一个CDB移动到另一个CDB</a><br>在隔离模式下，您可以自动将PDB从一个CDB移动到另一个CDB（例如，用于负载平衡或添加新功能）。
                     </li>
                     <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-83D12D92-1BCD-4365-A801-279CEDEC51C3">在隔离模式下用CDB中的加密数据拔出和插入PDB</a><br>在隔离模式下，对于具有加密数据的PDB，您可以将其插入CDB。相反，您可以从CDB拔下此PDB。</li>
                     <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-75455949-623D-4001-ADDE-E3E6203397AB">在隔离模式下在CDB中使用加密数据克隆PDB</a><br>带有<code class="codeph">KEYSTORE IDENTIFIED BY</code>子句的<code class="codeph">CREATE PLUGGABLE DATABASE</code>语句可以克隆具有加密数据的PDB。
                     </li>
                     <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-B17D5C60-7403-4AB1-80A1-8AFDE4186697">在隔离模式下使用两个CDB之间的加密数据执行PDB的远程克隆</a><br>具有<code class="codeph">KEYSTORE IDENTIFIED BY</code>子句的<code class="codeph">CREATE PLUGGABLE DATABASE</code>语句可以远程克隆具有加密数据的PDB。
                     </li>
                     <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-B50982CD-9A6F-4D3D-8646-ABF2F2C746E8">在隔离模式下使用加密数据在CDB中重新定位克隆的PDB</a><br>带有<code class="codeph">KEYSTORE IDENTIFIED BY</code>子句的<code class="codeph">CREATE PLUGGABLE DATABASE</code>语句可以跨CDB重定位具有加密数据的克隆PDB。
                     </li>
                     <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-9F9A8D09-AE0C-4AF9-931D-B44B21E8B35B">密钥库打开和关闭操作如何在隔离模式下工作</a><br>您应该了解密钥库打开和关闭操作在隔离模式下的工作方式。
                     </li>
                     <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-3592D355-F190-4A6F-BF1D-00ABCC0E02BE">在隔离模式下导出和导入PDB的主加密密钥</a><br>在隔离模式下， <code class="codeph">ADMINISTER KEY MANAGEMENT EXPORT</code>的<code class="codeph">EXPORT</code>和<code class="codeph">IMPORT</code>子句可以导出或导入PDB的主加密密钥。</li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-ED5C479F-435F-47A5-AD96-8D874BEDA0AA" title="隔离模式使您可以为每个可插拔数据库（PDB）创建密钥库。">在隔离模式下管理密钥库和TDE主加密密钥</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="sect3"><a id="GUID-51BFBDC0-F56E-4D77-B85E-9696CCCE10BA" name="GUID-51BFBDC0-F56E-4D77-B85E-9696CCCE10BA"></a><h4 id="ASOAG-GUID-51BFBDC0-F56E-4D77-B85E-9696CCCE10BA" class="sect4">在隔离模式下将PDB从一个CDB移动到另一个CDB</h4>
                  <div>
                     <p>在隔离模式下，您可以自动将PDB从一个CDB移动到另一个CDB（例如，用于负载平衡或添加新功能）。</p>
                     <div class="section">如果PDB具有TDE加密的表或表空间，则可以将<code class="codeph">ONE_STEP_PLUGIN_FOR_PDB_WITH_TDE</code>动态系统参数设置为<code class="codeph">TRUE</code>以使PDB能够在PDB移动操作中包含TDE密钥。此参数避免了在将TDE密钥移动到另一个CDB后将TDE密钥导入PDB时必须手动提供密钥库密码。当<code class="codeph">ONE_STEP_PLUGIN_FOR_PDB_WITH_TDE</code>设置为<code class="codeph">TRUE</code> ，数据库将密钥库密码缓存在内存中，在系统级进行模糊处理，然后将其用于导入操作。<code class="codeph">ONE_STEP_PLUGIN_FOR_PDB_WITH_TDE</code>的默认值为<code class="codeph">FALSE</code> 。</div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>在开始PDB移动操作之前，以已被授予<code class="codeph">SYSDBA</code>管理权限的用户身份登录CDB根目录。</span><div>例如：<pre class="oac_no_warn" dir="ltr">sqlplus c ## sec_admin as sysdba输入密码： <span class="italic">password</span></pre></div>
                        </li>
                        <li class="stepexpand"><span>将<code class="codeph">ONE_STEP_PLUGIN_FOR_PDB_WITH_TDE</code>动态初始化参数设置为<code class="codeph">TRUE</code> 。</span><div>例如：<pre class="oac_no_warn" dir="ltr">ALTER SYSTEM SET ONE_STEP_PLUGIN_FOR_PDB_WITH_TDE = TRUE;</pre></div>
                        </li>
                        <li class="stepexpand"><span>移动（重新定位）PDB。</span></li>
                     </ol>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="../multi/introduction-to-the-multitenant-architecture.html#MULTI-GUID-D84C3A7F-A1B3-4651-B99B-9F76E7331F83" target="_blank"><span><cite>Oracle多租户管理员指南</cite></span></a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-5316DC4C-BAFF-4653-9884-34F121AD878C" title="您可以在隔离模式下使用透明数据加密执行许多常规管理任务。">在隔离模式下管理透明数据加密</a></p>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-83D12D92-1BCD-4365-A801-279CEDEC51C3" name="GUID-83D12D92-1BCD-4365-A801-279CEDEC51C3"></a><h4 id="ASOAG-GUID-83D12D92-1BCD-4365-A801-279CEDEC51C3" class="sect4">在隔离模式下用CDB中的加密数据拔出和插入PDB</h4>
                  <div>
                     <p>在隔离模式下，对于具有加密数据的PDB，您可以将其插入CDB。相反，您可以从CDB拔下此PDB。</p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-4B2EBA84-8D8B-4DB9-824A-382BF0588C73">拔出已在隔离模式下加密数据的PDB</a><br>您可以从一个CDB拔出PDB（具有加密数据），然后可选择将其插入另一个CDB。</li>
                        <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-B5097C6D-F5A3-43CB-9163-249B4DCD2912">在隔离模式下将已加密数据的PDB插入CDB</a><br>将具有加密数据的PDB插入CDB后，可以在PDB中设置加密密钥。</li>
                        <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-507B405D-6A95-46ED-A4CC-5AF4B1874EE5">在隔离模式下拔出具有存储在硬件密钥库中的主加密密钥的PDB</a><br>您可以从已配置了硬件密钥库的一个CDB上拔下PDB，然后将其插入另一个也配置了硬件密钥库的CDB。
                        </li>
                        <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-463E7580-7D47-4E8D-9F8C-C9D66433C1C1">在隔离模式下插入具有主密钥的PDB存储在HSM中</a><br><code class="codeph">ADMINISTER KEY MANAGEMENT</code>语句可以将硬件密钥库主加密密钥导入已移动到另一个CDB的PDB。</li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-5316DC4C-BAFF-4653-9884-34F121AD878C" title="您可以在隔离模式下使用透明数据加密执行许多常规管理任务。">在隔离模式下管理透明数据加密</a></p>
                        </div>
                     </div>
                  </div>
                  
                  <div class="props_rev_3"><a id="GUID-4B2EBA84-8D8B-4DB9-824A-382BF0588C73" name="GUID-4B2EBA84-8D8B-4DB9-824A-382BF0588C73"></a><h5 id="ASOAG-GUID-4B2EBA84-8D8B-4DB9-824A-382BF0588C73" class="sect5">拔出已在隔离模式下加密数据的PDB</h5>
                     <div>
                        <p>您可以从一个CDB拔出PDB（具有加密数据），然后可选择将其插入另一个CDB。</p>
                        <div class="section">与联合模式不同，您不需要在<code class="codeph">ALTER PLUGGABLE DATABASE</code>语句中指定<code class="codeph">ENCRYPT</code>子句。拔出的数据库包含数据文件和其他相关文件。由于每个PDB都可以拥有自己唯一的密钥库，因此您无需导出要拔出的PDB的TDE主加密密钥。您可以通过查询<code class="codeph">DBA_PDBS</code>数据字典视图的<code class="codeph">STATUS</code>列来检查PDB是否已被拔出。
                        </div>
                        <!-- class="section" -->
                        <ul>
                           <li class="stepexpand"><span>正常情况下拔掉PDB，拔下隔离模式PDB。</span><div>例如：<pre class="oac_no_warn" dir="ltr">ALTER PLUGGABLE DATABASE pdb1 UNPLUG INTO'/oracle/data/pdb1.xml';</pre></div>
                           </li>
                        </ul>
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>相关话题</strong></p>
                           <ul>
                              <li><a href="../multi/removing-a-pdb.html#MULTI-GUID-75C46F1B-00D8-4FB9-A8E7-6F7FE3DE4CA0" target="_blank"><span><cite>Oracle多租户管理员指南</cite></span></a></li>
                              <li><a href="../sqlrf/ALTER-PLUGGABLE-DATABASE.html#SQLRF-GUID-A29491AD-8F0F-4E52-9D94-57FC3FF8FBC7" target="_blank"><span><cite>Oracle数据库SQL语言参考</cite></span></a></li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-83D12D92-1BCD-4365-A801-279CEDEC51C3" title="在隔离模式下，对于具有加密数据的PDB，您可以将其插入CDB。相反，您可以从CDB拔下此PDB。">在隔离模式下在CDB中拔出和插入带有加密数据的PDB</a></p>
                           </div>
                        </div>
                     </div>
                  </div>
                  <div class="props_rev_3"><a id="GUID-B5097C6D-F5A3-43CB-9163-249B4DCD2912" name="GUID-B5097C6D-F5A3-43CB-9163-249B4DCD2912"></a><h5 id="ASOAG-GUID-B5097C6D-F5A3-43CB-9163-249B4DCD2912" class="sect5">在隔离模式下将已加密数据的PDB插入CDB</h5>
                     <div>
                        <p>将具有加密数据的PDB插入CDB后，可以在PDB中设置加密密钥。</p>
                        <div class="section">不同于美国模式，你不需要指定<code class="codeph">DECRYPT</code>在第<code class="codeph">CREATE PLUGGABLE DATABASE</code>语句。将未插入的PDB插入另一个CDB时，密钥版本设置为<code class="codeph">0</code>因为此操作会使先前密钥的历史记录无效。您可以通过查询<code class="codeph">V$ENCRYPTED_TABLESPACES</code>动态视图的<code class="codeph">KEY_VERSION</code>列来检查密钥版本。同样，如果控制文件丢失并重新创建，则密钥的先前历史记录将重置为<code class="codeph">0</code> 。您可以通过查询<code class="codeph">DBA_PDBS</code>数据字典视图的<code class="codeph">STATUS</code>列来检查是否已插入PDB。
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <ol>
                              <li>
                                 <p>通过将未插入的PDB插入CDB来创建PDB。</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p>例如，如果已将PDB数据导出到元数据XML文件中：</p><pre class="oac_no_warn" dir="ltr">CREATE PLUGGABLE DATABASE CDB1_PDB2使用'/tmp/cdb1_pdb2.xml'NOCOPY KEYSTORE IDENTIFIED BY <span class="italic">password</span> ;</pre></li>
                                    <li>
                                       <p>如果已将PDB导出到存档文件中：</p><pre class="oac_no_warn" dir="ltr">CREATE PLUGGABLE DATABASE CDB1_PDB2使用'/tmp/cdb1_pdb2.pdb';</pre></li>
                                 </ul>
                                 <p>在插件操作之后的PDB打开操作期间，Oracle数据库确定PDB是否具有加密数据。如果是这样，它将在<code class="codeph">RESTRICTED</code>模式下打开PDB。
                                 </p>
                                 <p>通过查询<code class="codeph">V$ENCRYPTION_KEYS</code>动态视图，可以查找源数据库是否在密钥库中设置了加密数据或TDE主加密密钥。
                                 </p>
                              </li>
                              <li>
                                 <p>打开PDB。</p>
                                 <p>例如：</p><pre class="oac_no_warn" dir="ltr">ALTER PLUGGABLE DATABASE CDB1_PDB2 OPEN;</pre></li>
                              <li>
                                 <p>打开CDB根目录中的密钥库。</p>
                                 <p>例如：</p><pre class="oac_no_warn" dir="ltr">ADMINISTER KEY MANAGEMENT SET KEYSTORE OPEN由<span class="italic">密码</span>识别;</pre><p>（可选）在PDB中打开密钥库。</p>
                              </li>
                              <li>
                                 <p>在PDB中，打开密钥库并为PDB设置TDE主加密密钥。</p>
                                 <p>例如：</p><pre class="oac_no_warn" dir="ltr">通过<span class="italic">keystore_password</span>使用'emp_key_backup'和BACKUP来识别的ADMINISTER密钥管理集<span class="italic">密钥</span> ;</pre></li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-83D12D92-1BCD-4365-A801-279CEDEC51C3" title="在隔离模式下，对于具有加密数据的PDB，您可以将其插入CDB。相反，您可以从CDB拔下此PDB。">在隔离模式下在CDB中拔出和插入带有加密数据的PDB</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
                  <div class="sect4"><a id="GUID-507B405D-6A95-46ED-A4CC-5AF4B1874EE5" name="GUID-507B405D-6A95-46ED-A4CC-5AF4B1874EE5"></a><h5 id="ASOAG-GUID-507B405D-6A95-46ED-A4CC-5AF4B1874EE5" class="sect5">在隔离模式下拔出具有存储在硬件密钥库中的主加密密钥的PDB</h5>
                     <div>
                        <p>您可以从已配置了硬件密钥库的一个CDB上拔下PDB，然后将其插入另一个也配置了硬件密钥库的CDB。</p>
                        <ol>
                           <li class="stepexpand"><span>拔掉PDB。</span><div>您可以通过查询<code class="codeph">DBA_PDBS</code>数据字典视图的<code class="codeph">STATUS</code>列来检查PDB是否已被拔出。
                              </div>
                           </li>
                           <li class="stepexpand"><span>将未插入的PDB的主加密密钥从源CDB上使用的硬件移动到目标CDB上使用的硬件。</span><div>
                                 <p>有关在硬件密钥库之间移动主密钥的信息，请参阅硬件密钥库的文档。</p>
                              </div>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>相关话题</strong></p>
                           <ul>
                              <li><a href="../multi/index.html" target="_blank"><span><cite>Oracle多租户管理员指南</cite></span></a></li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-83D12D92-1BCD-4365-A801-279CEDEC51C3" title="在隔离模式下，对于具有加密数据的PDB，您可以将其插入CDB。相反，您可以从CDB拔下此PDB。">在隔离模式下在CDB中拔出和插入带有加密数据的PDB</a></p>
                           </div>
                        </div>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-463E7580-7D47-4E8D-9F8C-C9D66433C1C1" name="GUID-463E7580-7D47-4E8D-9F8C-C9D66433C1C1"></a><h5 id="ASOAG-GUID-463E7580-7D47-4E8D-9F8C-C9D66433C1C1" class="sect5">在隔离模式下插入具有主密钥的PDB存储在HSM中</h5>
                     <div>
                        <p><code class="codeph">ADMINISTER KEY MANAGEMENT</code>语句可以将硬件密钥库主加密密钥导入已移动到另一个CDB的PDB。</p>
                        <ol>
                           <li class="stepexpand"><span>将未插入的隔离模式PDB插入已使用硬件密钥库配置的目标CDB。</span><div>您可以通过查询<code class="codeph">DBA_PDBS</code>数据字典视图的<code class="codeph">STATUS</code>列来检查是否已插入PDB。
                              </div>
                              <div>在插件操作之后，已插入的PDB将处于受限模式。</div>
                           </li>
                           <li class="stepexpand"><span>确保已使用源CDB配置的HSM中的主密钥在目标CDB的硬件密钥库中可用。</span></li>
                           <li class="stepexpand"><span>以授予<code class="codeph">ADMINISTER KEY MANAGEMENT</code>或<code class="codeph">SYSKM</code>权限的用户身份登录到插入的PDB。</span></li>
                           <li class="stepexpand"><span>打开插入的PDB的密钥库。</span><div>
                                 <p>例如，对于名为<code class="codeph">PDB1</code>的PDB：</p><pre class="oac_no_warn" dir="ltr">ALTER SESSION SET CONTAINER = PDB1; ADMINISTER KEY MANAGEMENT SET KEYSTORE OPEN由“ <span class="italic">harware_keystore_credentials</span> ”识别;</pre></div>
                           </li>
                           <li class="stepexpand"><span>将硬件密钥库主加密密钥导入PDB。</span><div><pre class="oac_no_warn" dir="ltr">ADMINISTER密钥管理使用SECRET“hardware_keystore”FROM“hardware_keystore”标识“ <span class="italic">hardware_keystore_credentials</span> ”标识的加密密钥;</pre></div>
                           </li>
                           <li class="stepexpand"><span>关闭并重新打开PDB。</span><div><pre class="oac_no_warn" dir="ltr">ALTER PLUGGABLE DATABASE PDB1 CLOSE; ALTER PLUGGABLE DATABASE PDB1 OPEN;</pre></div>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>相关话题</strong></p>
                           <ul>
                              <li><a href="../multi/plugging-in-a-pdb.html#MULTI-GUID-F23F5352-F456-48EE-AED7-71E3DEBAAED0" target="_blank"><span><cite>Oracle多租户管理员指南</cite></span></a></li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-83D12D92-1BCD-4365-A801-279CEDEC51C3" title="在隔离模式下，对于具有加密数据的PDB，您可以将其插入CDB。相反，您可以从CDB拔下此PDB。">在隔离模式下在CDB中拔出和插入带有加密数据的PDB</a></p>
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-75455949-623D-4001-ADDE-E3E6203397AB" name="GUID-75455949-623D-4001-ADDE-E3E6203397AB"></a><h4 id="ASOAG-GUID-75455949-623D-4001-ADDE-E3E6203397AB" class="sect4">在隔离模式下在CDB中使用加密数据克隆PDB</h4>
                  <div>
                     <p>带有<code class="codeph">KEYSTORE IDENTIFIED BY</code>子句的<code class="codeph">CREATE PLUGGABLE DATABASE</code>语句可以克隆具有加密数据的PDB。
                     </p>
                     <ol>
                        <li class="stepexpand"><span>以授予<code class="codeph">ADMINISTER KEY MANAGEMENT</code>或<code class="codeph">SYSKM</code>权限的用户身份登录到隔离模式PDB。</span></li>
                        <li class="stepexpand"><span>确保您计划克隆的PDB的软件密钥库已打开。</span><div>
                              <p>您可以查询<code class="codeph">V$ENCRYPTION_WALLET</code>视图的<code class="codeph">STATUS</code>列以查找软件密钥库是否已打开。
                              </p>
                              <p>例如：</p><pre class="oac_no_warn" dir="ltr">ADMINISTER IDENTIFIED BY <span class="italic">keystore_password</span>密钥管理密钥库SET OPEN FORCE密钥库;</pre></div>
                        </li>
                        <li class="stepexpand"><span>克隆PDB。</span><div>
                              <p>例如：</p><pre class="oac_no_warn" dir="ltr">CREATE PLUGGABLE DATABASE cdb1_pdb3 FROM cdb1_pdb1 FILE_NAME_CONVERT =（'cdb1_pdb1'，'pdb3 / cdb1_pdb3'）KEYSTORE IDENTIFIED BY <span class="italic">keystore_password</span> ;</pre></div>
                           <div>
                              <p>将<code class="codeph"><span class="codeinlineitalic">keystore_password</span></code>替换为创建<code class="codeph">cdb1_pdb3</code>克隆的CDB <code class="codeph"><span class="codeinlineitalic">keystore_password</span></code>的密码。
                              </p>
                           </div>
                           <div>创建克隆的PDB后，克隆仍然可以使用原始PDB的主加密密钥访问加密数据。克隆PDB后，加密表空间中可能存在用户数据。由于源PDB的主加密密钥被复制到目标PDB，因此仍可访问此加密数据。由于克隆是源PDB的副本，但最终会遵循自己的路线并拥有自己的数据和安全策略，因此应重新键入克隆PDB的主加密密钥。</div>
                        </li>
                        <li class="stepexpand"><span>重新键入克隆PDB的主加密密钥。</span><div>
                              <p>例如：</p><pre class="pre codeblock"><code>通过<span class="italic">keystore_password</span>使用'emp_key_backup'和BACKUP来识别的ADMINISTER密钥管理集<span class="italic">密钥</span> ;</code></pre></div>
                           <div>在重新键入克隆的PDB的主加密密钥之前，克隆仍然可以使用属于原始PDB的主加密密钥。但是，这些主加密密钥不会出现在克隆的PDB <code class="codeph">V$</code>动态视图中。重新加密主加密密钥可确保克隆的PDB使用其自己的唯一密钥，这些密钥可在<code class="codeph">V$</code>视图中查看。
                           </div>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="managing-keystores-encryption-keys-in-united-mode.html#GUID-3A60285F-5CF7-4FA0-9F6E-EF19A1481AA4" title="克隆PDB时，必须使源PDB的主加密密钥可用于克隆PDB。">关于管理以联合模式加密数据的克隆PDB</a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-5316DC4C-BAFF-4653-9884-34F121AD878C" title="您可以在隔离模式下使用透明数据加密执行许多常规管理任务。">在隔离模式下管理透明数据加密</a></p>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-B17D5C60-7403-4AB1-80A1-8AFDE4186697" name="GUID-B17D5C60-7403-4AB1-80A1-8AFDE4186697"></a><h4 id="ASOAG-GUID-B17D5C60-7403-4AB1-80A1-8AFDE4186697" class="sect4">在隔离模式下使用两个CDB之间的加密数据执行PDB的远程克隆</h4>
                  <div>
                     <p>具有<code class="codeph">KEYSTORE IDENTIFIED BY</code>子句的<code class="codeph">CREATE PLUGGABLE DATABASE</code>语句可以远程克隆具有加密数据的PDB。
                     </p>
                     <ol>
                        <li class="stepexpand"><span>以授予<code class="codeph">ADMINISTER KEY MANAGEMENT</code>或<code class="codeph">SYSKM</code>权限的用户身份登录到隔离模式PDB。</span></li>
                        <li class="stepexpand"><span>查询<code class="codeph">V$ENCRYPTION_WALLET</code>视图的<code class="codeph">STATUS</code>列以确保您计划克隆的PDB的软件密钥库已打开。</span></li>
                        <li class="stepexpand"><span>为要远程克隆的PDB创建数据库链接。</span><div>使用<code class="codeph">CREATE DATABASE LINK</code> SQL语句创建数据库链接。您必须按照克隆远程PDB或非CDB所需的数据库链接先决条件来创建数据库链接。</div>
                        </li>
                        <li class="stepexpand"><span>使用带有<code class="codeph">KEYSTORE IDENTIFIED BY</code>子句的<code class="codeph">CREATE PLUGGABLE DATABASE</code>语句来执行PDB的克隆。</span><div>
                              <p>例如：</p><pre class="oac_no_warn" dir="ltr">CREATE PLUGGABLE DATABASE cdb1_pdb3 FROM cdb1_pdb1 FILE_NAME_CONVERT =（'cdb1_pdb1'，'pdb3 / cdb1_pdb3'）KEYSTORE IDENTIFIED BY <span class="italic">keystore_password</span> ;</pre></div>
                           <div>
                              <p>将<code class="codeph"><span class="codeinlineitalic">keystore_password</span></code>替换为创建<code class="codeph">cdb1_pdb3</code>克隆的CDB <code class="codeph"><span class="codeinlineitalic">keystore_password</span></code>的密码。
                              </p>
                           </div>
                           <div>创建克隆的PDB后，克隆仍然可以使用原始PDB的主加密密钥访问加密数据。克隆PDB后，加密表空间中可能存在用户数据。由于源PDB的主加密密钥被复制到目标PDB，因此仍可访问此加密数据。由于克隆是源PDB的副本，但最终会遵循自己的路线并拥有自己的数据和安全策略，因此您应该重新键入克隆PDB的主加密密钥。</div>
                        </li>
                        <li class="stepexpand"><span>重新键入远程克隆的PDB的主加密密钥。</span><div>
                              <p>例如：</p><pre class="pre codeblock"><code>ADMINISTER密钥管理设置密钥强制关键字由<span class="italic">keystore_password</span>标识，带有备份使用'emp_key_backup';</code></pre><p>在此示例中，包含<code class="codeph">FORCE KEYSTORE</code> ，因为密钥库必须在重定密钥操作期间打开。
                              </p>
                           </div>
                           <div>在重新键入克隆的PDB的主加密密钥之前，克隆仍然可以使用属于原始PDB的主加密密钥。但是，这些主加密密钥不会出现在克隆的PDB <code class="codeph">V$</code>动态视图中。重新加密主加密密钥可确保克隆的PDB使用其自己的唯一密钥，这些密钥可在<code class="codeph">V$</code>视图中查看。
                           </div>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="managing-keystores-encryption-keys-in-united-mode.html#GUID-3A60285F-5CF7-4FA0-9F6E-EF19A1481AA4" title="克隆PDB时，必须使源PDB的主加密密钥可用于克隆PDB。">关于管理以联合模式加密数据的克隆PDB</a></li>
                           <li><a href="managing-keystores-encryption-keys-in-united-mode.html#GUID-765C103D-67A0-4DF1-930E-CFFFA89B2DC2" title="要以联合模式打开软件密钥库，必须将ADMINISTER KEY MANAGEMENT语句与SET KEYSTORE OPEN子句一起使用。">步骤2：在联合模式PDB中打开软件密钥库</a></li>
                           <li><a href="../multi/cloning-a-pdb.html#MULTI-GUID-D4900E43-DF38-4629-9A1F-D1C11EC8EC8F" target="_blank"><span><cite><span><cite>Oracle多租户管理员指南</cite></span></cite></span></a></li>
                           <li><a href="../multi/cloning-a-pdb.html#MULTI-GUID-B5F57568-0FF8-4F86-AC3C-0EE46EE3ED0B" target="_blank"><span><cite><span><cite>Oracle多租户管理员指南</cite></span></cite></span></a></li>
                           <li><a href="../sqlrf/CREATE-DATABASE-LINK.html#SQLRF-GUID-D966642A-B19E-449D-9968-1121AF06D793" target="_blank"><span><cite><span><cite>Oracle数据库SQL语言参考</cite></span></cite></span></a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-5316DC4C-BAFF-4653-9884-34F121AD878C" title="您可以在隔离模式下使用透明数据加密执行许多常规管理任务。">在隔离模式下管理透明数据加密</a></p>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-B50982CD-9A6F-4D3D-8646-ABF2F2C746E8" name="GUID-B50982CD-9A6F-4D3D-8646-ABF2F2C746E8"></a><h4 id="ASOAG-GUID-B50982CD-9A6F-4D3D-8646-ABF2F2C746E8" class="sect4">在隔离模式下使用加密数据在CDB中重新定位克隆的PDB</h4>
                  <div>
                     <p>带有<code class="codeph">KEYSTORE IDENTIFIED BY</code>子句的<code class="codeph">CREATE PLUGGABLE DATABASE</code>语句可以跨CDB重定位具有加密数据的克隆PDB。
                     </p>
                     <ol>
                        <li class="stepexpand"><span>以授予<code class="codeph">ADMINISTER KEY MANAGEMENT</code>或<code class="codeph">SYSKM</code>权限的用户身份登录到隔离模式PDB。</span></li>
                        <li class="stepexpand"><span>查询<code class="codeph">V$ENCRYPTION_WALLET</code>视图的<code class="codeph">STATUS</code>列以确保您计划克隆的PDB的软件密钥库已打开。</span></li>
                        <li class="stepexpand"><span>为要远程克隆的PDB创建数据库链接。</span><div>使用<code class="codeph">CREATE DATABASE LINK</code> SQL语句创建数据库链接。您必须按照克隆远程PDB或非CDB所需的数据库链接先决条件来创建数据库链接。</div>
                        </li>
                        <li class="stepexpand"><span>使用带有<code class="codeph">KEYSTORE IDENTIFIED BY</code>子句的<code class="codeph">CREATE PLUGGABLE DATABASE</code>语句克隆PDB。</span><div>
                              <p>例如：</p><pre class="oac_no_warn" dir="ltr">CREATE PLUGGABLE DATABASE cdb1_pdb3 FROM cdb1_pdb1 FILE_NAME_CONVERT =（'cdb1_pdb1'，'pdb3 / cdb1_pdb3'）KEYSTORE IDENTIFIED BY <span class="italic">keystore_password</span> ;</pre></div>
                           <div>
                              <p>将<code class="codeph"><span class="codeinlineitalic">keystore_password</span></code>替换为创建<code class="codeph">cdb1_pdb3</code>克隆的CDB <code class="codeph"><span class="codeinlineitalic">keystore_password</span></code>的密码。
                              </p>
                           </div>
                           <div>创建克隆的PDB后，克隆仍然可以使用原始PDB的主加密密钥访问加密数据。克隆PDB后，加密表空间中可能存在用户数据。由于源PDB的主加密密钥被复制到目标PDB，因此仍可访问此加密数据。由于克隆是源PDB的副本，但最终会遵循自己的路线并拥有自己的数据和安全策略，因此您应该重新键入克隆PDB的主加密密钥。</div>
                        </li>
                        <li class="stepexpand"><span>使用<code class="codeph">ALTER PLUGGABLE DATABASE</code>语句执行重定位操作。</span><div>例如：<pre class="oac_no_warn" dir="ltr">ALTER PLUGGABLE DATABASE cdb1_pdb3 OPEN RELOCATE TO'need instance name example';</pre></div>
                        </li>
                        <li class="stepexpand"><span>重新键入远程克隆的PDB的主加密密钥。</span><div>
                              <p>例如：</p><pre class="pre codeblock"><code>ADMINISTER密钥管理设置密钥强制关键字由<span class="italic">keystore_password</span>标识，带有备份使用'emp_key_backup';</code></pre><p>在此示例中，包含<code class="codeph">FORCE KEYSTORE</code> ，因为密钥库必须在重定密钥操作期间打开。
                              </p>
                           </div>
                           <div>在重新键入克隆的PDB的主加密密钥之前，克隆仍然可以使用属于原始PDB的主加密密钥。但是，这些主加密密钥不会出现在克隆的PDB <code class="codeph">V$</code>动态视图中。重新加密主加密密钥可确保克隆的PDB使用其自己的唯一密钥，这些密钥可在<code class="codeph">V$</code>视图中查看。
                           </div>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="managing-keystores-encryption-keys-in-united-mode.html#GUID-3A60285F-5CF7-4FA0-9F6E-EF19A1481AA4" title="克隆PDB时，必须使源PDB的主加密密钥可用于克隆PDB。">关于管理以联合模式加密数据的克隆PDB</a></li>
                           <li><a href="managing-keystores-encryption-keys-in-united-mode.html#GUID-765C103D-67A0-4DF1-930E-CFFFA89B2DC2" title="要以联合模式打开软件密钥库，必须将ADMINISTER KEY MANAGEMENT语句与SET KEYSTORE OPEN子句一起使用。">步骤2：在联合模式PDB中打开软件密钥库</a></li>
                           <li><a href="../multi/cloning-a-pdb.html#MULTI-GUID-D4900E43-DF38-4629-9A1F-D1C11EC8EC8F" target="_blank"><span><cite><span><cite>Oracle多租户管理员指南</cite></span></cite></span></a></li>
                           <li><a href="../multi/cloning-a-pdb.html#MULTI-GUID-B5F57568-0FF8-4F86-AC3C-0EE46EE3ED0B" target="_blank"><span><cite><span><cite>Oracle多租户管理员指南</cite></span></cite></span></a></li>
                           <li><a href="../sqlrf/CREATE-DATABASE-LINK.html#SQLRF-GUID-D966642A-B19E-449D-9968-1121AF06D793" target="_blank"><span><cite><span><cite>Oracle数据库SQL语言参考</cite></span></cite></span></a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-5316DC4C-BAFF-4653-9884-34F121AD878C" title="您可以在隔离模式下使用透明数据加密执行许多常规管理任务。">在隔离模式下管理透明数据加密</a></p>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-9F9A8D09-AE0C-4AF9-931D-B44B21E8B35B" name="GUID-9F9A8D09-AE0C-4AF9-931D-B44B21E8B35B"></a><h4 id="ASOAG-GUID-9F9A8D09-AE0C-4AF9-931D-B44B21E8B35B" class="sect4">密钥库打开和关闭操作如何在隔离模式下工作</h4>
                  <div>
                     <p>您应该了解密钥库打开和关闭操作在隔离模式下的工作方式。</p>
                     <p>对于隔离模式下的每个PDB，您必须在PDB中明确打开受密码保护的软件密钥库或硬件密钥库，以启用透明数据加密操作。（自动登录和本地自动登录软件密钥库自动打开。）关闭PDB上的密钥库将阻止该PDB上的所有透明数据加密操作。</p>
                     <p>PDB中的打开和关闭密钥库操作取决于PDB中密钥库的打开和关闭状态。</p>
                     <p>请注意以下事项：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>您可以为多租户环境中的每个PDB创建单独的密钥库密码。</p>
                        </li>
                        <li>
                           <p>在单个PDB中手动打开受密码保护的软件或硬件密钥库之前，必须在CDB根目录中打开密钥库。</p>
                        </li>
                        <li>
                           <p>如果正在使用自动登录密钥库，或者密钥库已关闭，则在打开或关闭密钥库时，请在<code class="codeph">ADMINISTER KEY MANAGEMENT</code>语句中包含<code class="codeph">FORCE KEYSTORE</code>子句。
                           </p>
                        </li>
                        <li>
                           <p>如果密钥库是使用外部存储区进行密码的受密码保护的软件密钥库，则将<code class="codeph">IDENTIFIED BY</code>子句设置为<code class="codeph">EXTERNAL STORE</code> 。</p>
                        </li>
                        <li>
                           <p>在单个PDB中设置TDE主加密密钥之前，必须在CDB根目录中设置密钥。</p>
                        </li>
                        <li>
                           <p>自动登录和本地自动登录软件密钥库自动打开。您无需先从根目录或从PDB手动打开它们。</p>
                        </li>
                        <li>
                           <p>如果在隔离模式下配置了任何已打开密钥库的PDB，则尝试关闭CDB根目录中的密钥库将失败，并且<code class="codeph">ORA-46692 cannot close wallet</code>错误。使用<code class="codeph">ADMINISTER KEY MANAGEMENT</code>语句中的<code class="codeph">FORCE CLOSE</code>子句覆盖此行为。
                           </p>
                        </li>
                        <li>
                           <p>如果在CDB根目录中执行<code class="codeph">ADMINISTER KEY MANAGEMENT SET KEYSTORE OPEN</code>语句并将<code class="codeph">CONTAINER</code>子句设置为<code class="codeph">ALL</code> ，则只能在以统一模式配置的每个PDB中打开密钥库，并且只能在配置为任何PDB的任何PDB的密钥库中打开密钥库。隔离模式未打开。
                           </p>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-5316DC4C-BAFF-4653-9884-34F121AD878C" title="您可以在隔离模式下使用透明数据加密执行许多常规管理任务。">在隔离模式下管理透明数据加密</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="ASOAG10438"></a><div class="props_rev_3"><a id="GUID-3592D355-F190-4A6F-BF1D-00ABCC0E02BE" name="GUID-3592D355-F190-4A6F-BF1D-00ABCC0E02BE"></a><h4 id="ASOAG-GUID-3592D355-F190-4A6F-BF1D-00ABCC0E02BE" class="sect4">在隔离模式下导出和导入PDB的主加密密钥</h4>
                  <div>
                     <p>在隔离模式下， <code class="codeph">ADMINISTER KEY MANAGEMENT EXPORT</code>的<code class="codeph">EXPORT</code>和<code class="codeph">IMPORT</code>子句可以导出或导入PDB的主加密密钥。</p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-61722774-8B1C-4B19-A102-FFD25ECDBA74">关于在隔离模式下导出和导入PDB的主加密密钥</a><br>在隔离模式下，您可以从CDB根目录导出和导入主加密密钥，方法与导出和导入非CDB数据库的此密钥的方式相同。
                        </li>
                        <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-FFAC9E80-A2D5-458F-B49B-68E05217B608">在隔离模式下导出或导入PDB的主加密密钥</a><br>在隔离模式下， <code class="codeph">ADMINISTER KEY MANAGEMENT</code>语句可以导出或导入PDB的主加密密钥。</li>
                        <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-516FAA4E-D448-4E42-A153-416096657129">示例：在隔离模式下从PDB导出主加密密钥</a><br><code class="codeph">ADMINISTER KEY MANAGEMENT EXPORT ENCRYPTION KEYS</code>语句可以导出PDB的主加密密钥。</li>
                        <li class="ulchildlink"><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-33C38B9D-C63F-4DE5-ACF1-7F9341AC5AF4">示例：在隔离模式下将主加密密钥导入PDB</a><br><code class="codeph">ADMINISTER KEY MANAGEMENT IMPORT ENCRYPTION KEYS</code>语句可以将主加密密钥导入PDB。</li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-5316DC4C-BAFF-4653-9884-34F121AD878C" title="您可以在隔离模式下使用透明数据加密执行许多常规管理任务。">在隔离模式下管理透明数据加密</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="ASOAG10532"></a><div class="props_rev_3"><a id="GUID-61722774-8B1C-4B19-A102-FFD25ECDBA74" name="GUID-61722774-8B1C-4B19-A102-FFD25ECDBA74"></a><h5 id="ASOAG-GUID-61722774-8B1C-4B19-A102-FFD25ECDBA74" class="sect5">关于在隔离模式下导出和导入PDB的主加密密钥</h5>
                     <div>
                        <p>在隔离模式下，您可以从CDB根目录导出和导入主加密密钥，方法与导出和导入非CDB数据库的此密钥的方式相同。</p>
                        <p>您可以通过从PDB中导出和导入主加密密钥来导出和导入属于PDB的所有主加密密钥。 PDB中主加密密钥的导出和导入操作支持PDB拔出和插入操作。在PDB拔出和插入操作期间，涉及属于PDB的所有主加密密钥以及元数据。因此，从PDB中导出密钥时，不允许使用<code class="codeph">ADMINISTER KEY MANAGEMENT EXPORT</code>语句的<code class="codeph">WITH IDENTIFIER</code>子句。 <code class="codeph">WITH IDENTIFIER</code>子句仅在CDB根目录中允许。
                        </p>
                        <p>如果CDB根目录具有自动登录密钥库或密钥库已关闭，则应包括<code class="codeph">FORCE KEYSTORE</code>子句。如果密钥库已配置为使用外部存储区作为密码，则使用<code class="codeph">IDENTIFIED BY EXTERNAL STORE</code>子句。例如，要为此方案执行导出操作：</p><pre class="oac_no_warn" dir="ltr">管理员密钥管理导出密钥与秘密“my_secret”TO'/etc/TDE/export.exp'由外部商店识别的FORCE KEYSTORE;</pre><p>此<code class="codeph">ADMINISTER KEY MANAGEMENT EXPORT</code>操作不仅<code class="codeph">ADMINISTER KEY MANAGEMENT EXPORT</code>密钥，还创建PDB环境（以及克隆操作）所必需的元数据。
                        </p>
                        <p>在PDB内部，主加密密钥的导出操作导出由PDB创建或激活的密钥，其具有与导出密钥的PDB相同的GUID。实质上，将导出属于正在执行导出的PDB的所有密钥。</p>
                        <p>仅当主加密密钥是从具有相同GUID的另一个PDB导出时，才会从PDB中的导出文件导入主加密密钥。要将PDB的插件支持到CDB，导入还将从导出文件导入主加密密钥，该导出文件包含在没有<code class="codeph">WITH IDENTIFIER</code>子句的情况下导出的非CDB的主加密密钥。由于PDB特定的详细信息（例如PDB名称和数据库ID）可以从一个CDB更改为下一个CDB，因此在导入期间会修改PDB特定信息以反映更新的PDB信息。
                        </p>
                        <div class="infoboxnote" id="GUID-61722774-8B1C-4B19-A102-FFD25ECDBA74__GUID-5F7509F5-A65D-4F38-BAB4-D379B6240214">
                           <p class="notep1">注意：</p>
                           <p>在PDB中，您只能导出PDB的密钥作为整体。基于查询或标识符选择性地导出它们的能力仅限于根。</p>
                        </div>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-3592D355-F190-4A6F-BF1D-00ABCC0E02BE" title="在隔离模式下，ADMINISTER KEY MANAGEMENT EXPORT的EXPORT和IMPORT子句可以导出或导入PDB的主加密密钥。">在隔离模式下导出和导入PDB的主加密密钥</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="ASOAG10533"></a><div class="props_rev_3"><a id="GUID-FFAC9E80-A2D5-458F-B49B-68E05217B608" name="GUID-FFAC9E80-A2D5-458F-B49B-68E05217B608"></a><h5 id="ASOAG-GUID-FFAC9E80-A2D5-458F-B49B-68E05217B608" class="sect5">在隔离模式下导出或导入PDB的主加密密钥</h5>
                     <div>
                        <p>在隔离模式下， <code class="codeph">ADMINISTER KEY MANAGEMENT</code>语句可以导出或导入PDB的主加密密钥。</p>
                        <div class="section">
                           <ol>
                              <li>
                                 <p>以授予<code class="codeph">ADMINISTER KEY MANAGEMENT</code>或<code class="codeph">SYSKM</code>权限的用户身份登录到隔离模式PDB。
                                 </p>
                              </li>
                              <li>
                                 <p>执行导出或导入操作。</p>
                                 <p>例如：</p><pre class="oac_no_warn" dir="ltr">管理员密钥管理导出加密密钥与秘密“hr_secret”TO'/ tmp / export.p12'FORCE KEYSTORE由<span class="italic">密码</span>识别;</pre><p>确保包含<code class="codeph">FORCE KEYSTORE</code>子句，因为必须为此操作打开密钥库。
                                 </p>
                              </li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>相关话题</strong></p>
                           <ul>
                              <li><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-516FAA4E-D448-4E42-A153-416096657129" title="ADMINISTER KEY MANAGEMENT EXPORT ENCRYPTION KEYS语句可以导出PDB的主加密密钥。">示例：在隔离模式下从PDB导出主加密密钥</a></li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-3592D355-F190-4A6F-BF1D-00ABCC0E02BE" title="在隔离模式下，ADMINISTER KEY MANAGEMENT EXPORT的EXPORT和IMPORT子句可以导出或导入PDB的主加密密钥。">在隔离模式下导出和导入PDB的主加密密钥</a></p>
                           </div>
                        </div>
                     </div>
                  </div><a id="ASOAG10439"></a><a id="ASOAG10534"></a><div class="props_rev_3"><a id="GUID-516FAA4E-D448-4E42-A153-416096657129" name="GUID-516FAA4E-D448-4E42-A153-416096657129"></a><h5 id="ASOAG-GUID-516FAA4E-D448-4E42-A153-416096657129" class="sect5">示例：在隔离模式下从PDB导出主加密密钥</h5>
                     <div>
                        <p><code class="codeph">ADMINISTER KEY MANAGEMENT EXPORT ENCRYPTION KEYS</code>语句可以导出PDB的主加密密钥。</p>
                        <p><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-516FAA4E-D448-4E42-A153-416096657129__CIHJEBJI">例6-1</a>显示了如何从PDB <code class="codeph">hrpdb</code>导出主加密密钥。在此示例中，如果正在使用自动登录密钥库，或者密钥库已关闭，则包括<code class="codeph">FORCE KEYSTORE</code>子句。
                        </p>
                        <div class="example" id="GUID-516FAA4E-D448-4E42-A153-416096657129__CIHJEBJI">
                           <p class="titleinexample">示例6-1从PDB导出主加密密钥</p><pre class="oac_no_warn" dir="ltr">管理员密钥管理导出加密密钥与秘密“my_secret”TO'/ tmp / export.p12'FORCE KEYSTORE IDENTIFIED BY <span class="italic">password</span> ;</pre></div>
                        <!-- class="example" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-3592D355-F190-4A6F-BF1D-00ABCC0E02BE" title="在隔离模式下，ADMINISTER KEY MANAGEMENT EXPORT的EXPORT和IMPORT子句可以导出或导入PDB的主加密密钥。">在隔离模式下导出和导入PDB的主加密密钥</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="ASOAG10440"></a><div class="sect4"><a id="GUID-33C38B9D-C63F-4DE5-ACF1-7F9341AC5AF4" name="GUID-33C38B9D-C63F-4DE5-ACF1-7F9341AC5AF4"></a><h5 id="ASOAG-GUID-33C38B9D-C63F-4DE5-ACF1-7F9341AC5AF4" class="sect5">示例：在隔离模式下将主加密密钥导入PDB</h5>
                     <div>
                        <p><code class="codeph">ADMINISTER KEY MANAGEMENT IMPORT ENCRYPTION KEYS</code>语句可以将主加密密钥导入PDB。</p>
                        <p><a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-33C38B9D-C63F-4DE5-ACF1-7F9341AC5AF4__CIHFDGII">例6-2</a>显示了如何将主加密密钥导入PDB <code class="codeph">hrpdb</code> 。
                        </p>
                        <div class="example" id="GUID-33C38B9D-C63F-4DE5-ACF1-7F9341AC5AF4__CIHFDGII">
                           <p class="titleinexample">示例6-2将主加密密钥导入PDB</p><pre class="oac_no_warn" dir="ltr">管理员密钥管理导入加密密钥与秘密“my_secret”FROM'/ tmp / export.p12'FORCE KEYSTORE由<span class="italic">密码</span> WITH BACKUP标识;</pre></div>
                        <!-- class="example" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="managing-keystores-encryption-keys-in-isolated-mode.html#GUID-3592D355-F190-4A6F-BF1D-00ABCC0E02BE" title="在隔离模式下，ADMINISTER KEY MANAGEMENT EXPORT的EXPORT和IMPORT子句可以导出或导入PDB的主加密密钥。">在隔离模式下导出和导入PDB的主加密密钥</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>