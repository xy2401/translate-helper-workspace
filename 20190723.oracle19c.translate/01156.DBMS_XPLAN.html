<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="The DBMS_XPLAN package provides an easy way to display the output of the EXPLAIN PLAN command in several, predefined formats."></meta>
      <meta name="description" content="The DBMS_XPLAN package provides an easy way to display the output of the EXPLAIN PLAN command in several, predefined formats."></meta>
      <title>DBMS_XPLAN</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="PL/SQL Packages and Types Reference"></meta>
      <meta property="og:description" content="The DBMS_XPLAN package provides an easy way to display the output of the EXPLAIN PLAN command in several, predefined formats."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="PL/SQL Packages and Types Reference"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="database-pl-sql-packages-and-types-reference.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-03-25T11:24:34-07:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96430-03"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="DBMS_XMLSTORE.html" title="Previous" type="text/html"></link>
      <link rel="next" href="DBMS_XSLPROCESSOR.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database PL/SQL Packages and Types Reference"></meta>
    <meta name="dcterms.isVersionOf" content="ARPLS"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="DBMS_XMLSTORE.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="DBMS_XSLPROCESSOR.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">PL / SQL包和类型参考</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">DBMS_XPLAN</li>
            </ol>
            <a id="GUID-BAD480AA-351A-48FE-A8E7-F0D8EF643EBF" name="GUID-BAD480AA-351A-48FE-A8E7-F0D8EF643EBF"></a><a id="ARPLS378"></a><a id="ARPLS378"></a>
            
            <h2 id="ARPLS-GUID-BAD480AA-351A-48FE-A8E7-F0D8EF643EBF" class="sect2"><span class="enumeration_chapter">206</span> DBMS_XPLAN</h2>
         </header>
         <div class="ind">
            <div>
               <p><code class="codeph">DBMS_XPLAN</code>包提供了一种以多种预定义格式显示<code class="codeph">EXPLAIN PLAN</code>命令输出的简便方法。
               </p>
               <p>您还可以使用<code class="codeph">DBMS_XPLAN</code>程序包显示存储在自动工作负载存储库（AWR）中或存储在SQL调优集中的语句的计划。它还提供了一种方法，可根据存储在<code class="codeph">V$SQL_PLAN</code>和<code class="codeph">V$SQL_PLAN_STATISTICS_ALL</code>固定视图中的信息显示缓存SQL游标的SQL执行计划和SQL执行运行时统计信息。最后，它显示SQL计划基准的计划。
               </p>
               <div class="infoboxnotealso" id="GUID-BAD480AA-351A-48FE-A8E7-F0D8EF643EBF__GUID-864DB335-A3B8-4A5B-8290-A2375B128D0F">
                  <p class="notep1">也可以看看：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>有关<code class="codeph">EXPLAIN</code> <code class="codeph">PLAN</code>命令，AWR和SQL调优集的更多信息，请参阅“ <a href="../tgsql/introduction-to-sql-tuning.html#TGSQL-GUID-B653E5F3-F078-4BBC-9516-B892960046A2" target="_blank"><span><cite>Oracle数据库SQL调优指南”</cite></span></a> 。
                        </p>
                     </li>
                     <li>
                        <p>有关<code class="codeph">V$SQL_PLAN</code>修复视图的更多信息，请参阅<a href="../refrn/V-SQL_PLAN.html#REFRN-GUID-87561B21-721C-42EB-8E3D-28251C9BC50C" target="_blank"><span><cite>Oracle数据库参考</cite></span></a></p>
                     </li>
                     <li>
                        <p>有关<code class="codeph">V$SQL_PLAN_STATISTICS</code>固定视图的更多信息，请参阅<a href="../refrn/V-SQL_PLAN_STATISTICS.html#REFRN-GUID-983DE0B1-1824-4A03-9C96-DCAFF5662B1A" target="_blank"><span><cite>Oracle数据库参考</cite></span></a></p>
                     </li>
                  </ul>
               </div>
               <p>本章包含以下主题：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="DBMS_XPLAN.html#GUID-1CDFFBEE-FD15-4245-B3A5-0D54F21CEB0C" title="DBMS_XPLAN包提供五个表函数。">概观</a></p>
                  </li>
                  <li>
                     <p><a href="DBMS_XPLAN.html#GUID-BEE6D488-0381-4864-9B19-6299DE2B6210" title="此程序包使用调用用户的权限运行，而不是程序包所有者（SYS）。表函数DISPLAY_CURSOR在以下固定视图上需要SELECT或READ权限：V $ SQL_PLAN，V $ SESSION和V $ SQL_PLAN_STATISTICS_ALL。">安全模型</a></p>
                  </li>
                  <li>
                     <p><a href="DBMS_XPLAN.html#GUID-492CB99B-62C3-4FC3-951C-4BE876670218" title="这些示例显示了DBMS_XPLAN的示例用法。">例子</a></p>
                  </li>
                  <li>
                     <p><a href="DBMS_XPLAN.html#GUID-3575E99C-6F87-4446-BF8F-E2153554D30F" title="该表列出了DBMS_XPLAN子程序并简要描述了它们。">DBMS_XPLAN子程序摘要</a></p>
                  </li>
               </ul>
            </div><a id="ARPLS70123"></a><a id="ARPLS70123"></a><div class="props_rev_3"><a id="GUID-1CDFFBEE-FD15-4245-B3A5-0D54F21CEB0C" name="GUID-1CDFFBEE-FD15-4245-B3A5-0D54F21CEB0C"></a><h3 id="ARPLS-GUID-1CDFFBEE-FD15-4245-B3A5-0D54F21CEB0C" class="sect3"><span class="enumeration_section">206.1</span> DBMS_XPLAN概述</h3>
               <div>
                  <p><code class="codeph">DBMS_XPLAN</code>包提供五个表函数。
                  </p>
                  <div class="section">
                     <p>这些功能如下：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">DISPLAY</code> - 格式化和显示计划表的内容。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">DISPLAY_AWR</code> - 格式化和显示AWR中存储的SQL语句的执行计划的内容。</p>
                        </li>
                        <li>
                           <p><code class="codeph">DISPLAY_CURSOR</code> - 格式化并显示任何加载的游标的执行计划的内容。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">DISPLAY_SQL_PLAN_BASELINE</code> - 显示SQL句柄标识的SQL语句的一个或多个执行计划</p>
                        </li>
                        <li>
                           <p><code class="codeph">DISPLAY_SQLSET</code> - 格式化和显示存储在SQL调优集中的语句的执行计划的内容。
                           </p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="ARPLS70124"></a><a id="ARPLS70124"></a><div class="props_rev_3"><a id="GUID-BEE6D488-0381-4864-9B19-6299DE2B6210" name="GUID-BEE6D488-0381-4864-9B19-6299DE2B6210"></a><h3 id="ARPLS-GUID-BEE6D488-0381-4864-9B19-6299DE2B6210" class="sect3"><span class="enumeration_section">206.2</span> DBMS_XPLAN安全模型</h3>
               <div>
                  <p>此程序包使用调用用户的权限运行，而不是程序包所有者（ <code class="codeph">SYS</code> ）。表函数<code class="codeph">DISPLAY_CURSOR</code>在以下固定视图上需要<code class="codeph">SELECT</code>或<code class="codeph">READ</code>权限： <code class="codeph">V$SQL_PLAN</code> ， <code class="codeph">V$SESSION</code>和<code class="codeph">V$SQL_PLAN_STATISTICS_ALL.</code> 
                  </p>
                  <div class="section">
                     <p>使用<a href="DBMS_XPLAN.html#GUID-E234ED21-21A9-4237-9DF3-8E420CDDBC70" title="该表函数显示存储在AWR中的执行计划的内容。">DISPLAY_AWR函数</a>要求用户对<code class="codeph">DBA_HIST_SQL_PLAN</code> ， <code class="codeph">DBA_HIST_SQLTEXT</code>和<code class="codeph">V$DATABASE</code>具有<code class="codeph">SELECT</code>或<code class="codeph">READ</code>权限。</p>
                     <p>使用<a href="DBMS_XPLAN.html#GUID-F935EACB-5FBB-4544-91DE-072C7CDA983C" title="此表函数显示存储在SQL调优集中的给定语句的执行计划。">DISPLAY_SQLSET函数</a>要求用户对<code class="codeph">ALL_SQLSET_STATEMENTS</code>和<code class="codeph">ALL_SQLSET_PLANS</code>具有<code class="codeph">SELECT</code>或<code class="codeph">READ</code>权限。</p>
                     <p>使用<a href="DBMS_XPLAN.html#GUID-98BB5243-873B-4C7F-B8EC-569C6248339D" title="此表函数显示SQL计划基准的指定SQL句柄的一个或多个执行计划。">DISPLAY_SQL_PLAN_BASELINE函数</a>要求用户对<code class="codeph">DBA_SQL_PLAN_BASELINES</code>具有<code class="codeph">SELECT</code>或<code class="codeph">READ</code>权限，以及执行用户尝试获取计划的SQL语句的权限。
                     </p>
                     <p>所有这些权限都将自动授予<code class="codeph">SELECT_CATALOG</code>角色的一部分。
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
            <div class="sect2"><a id="GUID-47984473-EE22-40AE-955C-79C804087DEE" name="GUID-47984473-EE22-40AE-955C-79C804087DEE"></a><h3 id="ARPLS-GUID-47984473-EE22-40AE-955C-79C804087DEE" class="sect3"><span class="enumeration_section">206.3</span> DBMS_XPLAN数据结构</h3>
               <div>
                  <p><code class="codeph">DBMS_XPLAN</code>包定义<code class="codeph">TABLE</code>类型。
                  </p>
                  <div class="section">
                     <p class="subhead2" id="GUID-47984473-EE22-40AE-955C-79C804087DEE__GUID-BD50B151-A222-4B5E-AD80-3E451B45DFA0">表类型</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="DBMS_XPLAN.html#GUID-ED750F75-CC30-4C4F-B5A5-94D7599AEB97" title="此类型允许将通用对象列表作为COMPARE_PLANS函数的输入。">DBMS_XPLAN PLAN_OBJECT_LIST表类型</a></p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div>
               <div class="sect3"><a id="GUID-ED750F75-CC30-4C4F-B5A5-94D7599AEB97" name="GUID-ED750F75-CC30-4C4F-B5A5-94D7599AEB97"></a><h4 id="ARPLS-GUID-ED750F75-CC30-4C4F-B5A5-94D7599AEB97" class="sect4"><span class="enumeration_section">206.3.1</span> DBMS_XPLAN PLAN_OBJECT_LIST表类型</h4>
                  <div>
                     <p>此类型允许将通用对象列表作为<code class="codeph">COMPARE_PLANS</code>函数的输入。
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-ED750F75-CC30-4C4F-B5A5-94D7599AEB97__GUID-FD70D77D-8C9A-4A99-8236-9C2378EB039E">句法</p><pre class="pre codeblock"><code>TYPE plan_object_list IS TABLE OF generic_plan_object;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>通用对象从所有计划源中抽象出计划的共同属性。每个计划源都是<code class="codeph">plan_object_list</code>超类的子类。下表总结了不同的计划来源。请注意，当可选参数为null时，它可以对应于多个对象。例如，如果没有为<code class="codeph">cursor_cache_object</code>指定子编号，则它将匹配具有指定SQL ID的所有游标缓存语句。</p>
                        <div class="tblformal" id="GUID-ED750F75-CC30-4C4F-B5A5-94D7599AEB97__GUID-DDFDDD63-3854-49FF-BCB7-82B41CC66B3E">
                           <p class="titleintable">表206-1 PLAN_OBJECT_LIST的计划来源</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="计划PLAN_OBJECT_LIST的来源" border="1" summary="This table describe the plan sources for the plan_object_list object." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="20%" id="d1282853e717">计划来源</th>
                                    <th align="left" valign="bottom" width="20%" id="d1282853e719">规格</th>
                                    <th align="left" valign="bottom" width="20%" id="d1282853e721">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d1282853e725" headers="d1282853e717 ">
                                       <p>计划表</p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d1282853e725 d1282853e719 "><pre class="pre codeblock"><code>plan_table_object（owner，plan_table_name，statement_id，plan_id）</code></pre></td>
                                    <td align="left" valign="top" width="20%" headers="d1282853e725 d1282853e721 ">
                                       <p>参数如下：</p>
                                       <ul style="list-style-type:disc">
                                          <li>
                                             <p><code class="codeph">owner</code> - 计划表的所有者</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">plan_table_name</code> - 计划表的名称</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">statement_id</code> - <code class="codeph">statement_id</code> ID（可选）</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">plan_id</code> - 计划的ID（可选）</p>
                                          </li>
                                       </ul>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d1282853e756" headers="d1282853e717 ">
                                       <p>游标缓存</p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d1282853e756 d1282853e719 "><pre class="pre codeblock"><code>cursor_cache_object（sql_id，child_number）</code></pre></td>
                                    <td align="left" valign="top" width="20%" headers="d1282853e756 d1282853e721 ">
                                       <p>参数如下：</p>
                                       <ul style="list-style-type:disc">
                                          <li>
                                             <p><code class="codeph">sql_id</code> - 计划的SQL ID</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">child_number</code> - 游标缓存中计划的子编号（可选）</p>
                                          </li>
                                       </ul>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d1282853e777" headers="d1282853e717 ">
                                       <p>AWR</p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d1282853e777 d1282853e719 "><pre class="pre codeblock"><code>awr_object（sql_id，dbid，con_dbid，plan_hash_value）</code></pre></td>
                                    <td align="left" valign="top" width="20%" headers="d1282853e777 d1282853e721 ">
                                       <p>参数如下：</p>
                                       <ul style="list-style-type:disc">
                                          <li>
                                             <p><code class="codeph">sql_id</code> - 计划的SQL ID</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">dbid</code> - 数据库ID（可选）</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">con_dbid</code> -  CDB ID（可选）</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">plan_hash_value</code> - 计划的哈希值（可选）</p>
                                          </li>
                                       </ul>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d1282853e808" headers="d1282853e717 ">
                                       <p>SQL调优集</p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d1282853e808 d1282853e719 "><pre class="pre codeblock"><code>sqlset_object（sqlset_owner，sqlset_name，sql_id，plan_hash_value）</code></pre></td>
                                    <td align="left" valign="top" width="20%" headers="d1282853e808 d1282853e721 ">
                                       <p>参数如下：</p>
                                       <ul style="list-style-type:disc">
                                          <li>
                                             <p><code class="codeph">sqlset_owner</code> -  SQL调优集的所有者</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">sqlset_name</code> -  SQL调优集的名称</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">sql_id</code> - 计划的SQL ID</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">plan_hash_value</code> - 计划的哈希值（可选）</p>
                                          </li>
                                       </ul>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d1282853e839" headers="d1282853e717 ">
                                       <p>SQL计划管理</p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d1282853e839 d1282853e719 "><pre class="pre codeblock"><code>spm_object（sql_handle，plan_name）</code></pre></td>
                                    <td align="left" valign="top" width="20%" headers="d1282853e839 d1282853e721 ">
                                       <p>参数如下：</p>
                                       <ul style="list-style-type:disc">
                                          <li>
                                             <p><code class="codeph">sql_handle</code> - 受SQL计划管理保护的计划的SQL句柄</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">plan_name</code> -  SQL计划基准的名称（可选）</p>
                                          </li>
                                       </ul>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d1282853e860" headers="d1282853e717 ">
                                       <p>SQL配置文件</p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d1282853e860 d1282853e719 "><pre class="pre codeblock"><code>sql_profile_object（profile_name）</code></pre></td>
                                    <td align="left" valign="top" width="20%" headers="d1282853e860 d1282853e721 ">
                                       <p><code class="codeph">profile_name</code>参数指定SQL配置文件的名称。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d1282853e873" headers="d1282853e717 ">
                                       <p>顾问</p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d1282853e873 d1282853e719 "><pre class="pre codeblock"><code>advisor_object（task_name，execution_name，sql_id，plan_id）</code></pre></td>
                                    <td align="left" valign="top" width="20%" headers="d1282853e873 d1282853e721 ">
                                       <p>参数如下：</p>
                                       <ul style="list-style-type:disc">
                                          <li>
                                             <p><code class="codeph">task_name</code> - 顾问程序任务的名称</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">execution_name</code> - 任务执行的名称</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">sql_id</code> - 计划的SQL ID</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">plan_id</code> - 顾问计划ID（可选）</p>
                                          </li>
                                       </ul>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="ARPLS70125"></a><a id="ARPLS70126"></a><a id="ARPLS70127"></a><a id="ARPLS70128"></a><a id="ARPLS70129"></a><a id="ARPLS70126"></a><a id="ARPLS70127"></a><a id="ARPLS70128"></a><a id="ARPLS70129"></a><a id="ARPLS70125"></a><div class="props_rev_3"><a id="GUID-492CB99B-62C3-4FC3-951C-4BE876670218" name="GUID-492CB99B-62C3-4FC3-951C-4BE876670218"></a><h3 id="ARPLS-GUID-492CB99B-62C3-4FC3-951C-4BE876670218" class="sect3"><span class="enumeration_section">206.4</span>例子</h3>
               <div>
                  <p>这些示例显示了DBMS_XPLAN的示例用法。</p>
                  <div class="section" id="GUID-492CB99B-62C3-4FC3-951C-4BE876670218__I999156">
                     <p class="subhead2" id="GUID-492CB99B-62C3-4FC3-951C-4BE876670218__GUID-CCD767B3-BD66-4069-B86D-096E7490EF52">使用DBMS_XPLAN.DISPLAY显示计划表</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>在<code class="codeph">SELECT</code>语句上执行explain plan命令：</p><pre class="oac_no_warn" dir="ltr">SELECT * FROM emp e，dept d WHERE e.deptno = d.deptno AND e.ename ='benoit';</pre><p>使用<code class="codeph">DBMS_XPLAN.DISPLAY</code>表函数显示计划</p><pre class="oac_no_warn" dir="ltr">SET LINESIZE 130 SET PAGESIZE 0 SELECT * FROM TABLE（DBMS_XPLAN.DISPLAY）;</pre><p>此查询生成以下输出：</p><pre class="oac_no_warn" dir="ltr">计划哈希值：3693697075 --------------------------------------------- ------------------------------ | Id |操作|名称|行|字节|成本（％CPU）|时间| -------------------------------------------------- ------------------------- | 0 |选择声明| | 1 | 57 | 6（34）| 00:00:01 | | * 1 | HASH JOIN | | 1 | 57 | 6（34）| 00:00:01 | | * 2 |表访问完全| EMP | 1 | 37 | 3（34）| 00:00:01 | | 3 |表访问完全| DEPT | 4 | 80 | 3（34）| 00:00:01 | -------------------------------------------------- -------------------------谓词信息（由操作ID标识）：---------------- ----------------------------------- 1  -  access（“E”。“DEPTNO”=“D” 。“DEPTNO”）2  - 过滤（“E”。“ENAME”='benoit'）选择15行。</pre></div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-492CB99B-62C3-4FC3-951C-4BE876670218__GUID-CB05A292-709F-442C-BBDE-1AA877A7B71E">使用DBMS_XPLAN.DISPLAY_CURSOR显示游标执行计划</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>默认情况下，表函数<code class="codeph">DISPLAY_CURSOR</code>格式化会话执行的最后一个SQL语句的执行计划。例如：</p><pre class="oac_no_warn" dir="ltr">SELECT ename FROM emp e，dept d WHERE e.deptno = d.deptno AND e.empno = 7369; ENAME ---------- SMITH</pre><p>要显示该会话的上次执行语句的执行计划：</p><pre class="oac_no_warn" dir="ltr">SET PAGESIZE 0 SELECT * FROM DBMS_XPLAN.DISPLAY_CURSOR（）;</pre><p>此查询生成以下输出：</p><pre class="oac_no_warn" dir="ltr">计划哈希值：3693697075，SQL哈希值：2096952573，子号：0 ---------------------------------- -------------------------------- SELECT ename FROM emp e，dept d WHERE e.deptno = d.deptno AND e .empno = 7369 ---------------------------------------------- ----------------------------- | Id |操作|名称|行|字节|成本（％CPU）|时间| -------------------------------------------------- ------------------------- | 0 |选择声明| | | | | | | * 1 | HASH JOIN | | 1 | 16 | 6（34）| 00:00:01 | | * 2 |表访问完全| EMP | 1 | 13 | 3（34）| 00:00:01 | | 3 |表访问完全| DEPT | 4 | 12 | 3（34）| 00:00:01 | -------------------------------------------------- -------------------------谓词信息（由操作ID标识）：---------------- ----------------------------------- 1  -  access（“E”。“DEPTNO”=“D” 。“DEPTNO”）2  - 过滤器（“E”。“EMPNO”= 7369）选择21行。
</pre><p>您还可以使用表函数<code class="codeph">DISPLAY_CURSOR</code>来显示存储在游标缓存中的任何已加载游标的执行计划。在这种情况下，您必须提供对子函数的引用。这包括语句的SQL ID和可选的子编号。
                     </p>
                     <p>运行带有独特评论的查询：</p><pre class="oac_no_warn" dir="ltr">SELECT / * TOTO * / ename，dname FROM dept d join emp e USING（deptno）;</pre><p>获取前面语句的<code class="codeph">sql_id</code>和<code class="codeph">child_number</code> ：</p><pre class="oac_no_warn" dir="ltr">SELECT sql_id，child_number FROM v $ sql WHERE sql_text LIKE'％TOTO％'; SQL_ID CHILD_NUMBER ---------- ----------------------------- gwp663cqh5qbf 0</pre><p>显示游标的执行计划：</p><pre class="oac_no_warn" dir="ltr">SELECT * FROM DBMS_XPLAN.DISPLAY_CURSOR（'gwp663cqh5qbf'，0）;计划哈希值：3693697075，SQL ID：gwp663cqh5qbf，子编号：0 ----------------------------------- --------------------- SELECT / * TOTO * / ename，dname FROM dept d JOIN emp e USING（deptno）; -------------------------------------------------- -------------------------- | Id |操作|名称|行|字节|成本（％CPU）|时间| -------------------------------------------------- -------------------------- | 0 |选择声明| | | | 7（100）| | | 1 | SORT GROUP BY | | 4 | 64 | 7（43）| 00:00:01 | | * 2 | HASH JOIN | | 14 | 224 | 6（34）| 00:00:01 | | 3 |表访问完全| DEPT | 4 | 44 | 3（34）| 00:00:01 | | 4 |表访问完全| EMP | 14 | 70 | 3（34）| 00:00:01 | -------------------------------------------------- --------------------------谓词信息（由操作ID标识）：--------------- ------------------------------------ 2  -  access（“E”。“DEPTNO”=“D ”。 “DEPTNO”）</pre><p>您可以将这些查询组合在一个查询中，而不是发出两个查询，一个用于获取sql_id和child_number对，另一个用于显示计划：</p>
                     <p>显示与字符串'TOTO'匹配的所有游标的执行计划：</p><pre class="oac_no_warn" dir="ltr">选择t。* FROM v $ sql s，DBMS_XPLAN.DISPLAY_CURSOR（s.sql_id，s.child_number）t WHERE sql_text LIKE'％TOTO％';</pre></div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-492CB99B-62C3-4FC3-951C-4BE876670218__GUID-CE2401E8-C60D-4747-9155-F0C0482D79BD">显示包含并行信息的计划表</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>默认情况下，display和<code class="codeph">display_cursor</code>表函数仅报告相关信息。在<a href="DBMS_XPLAN.html#GUID-492CB99B-62C3-4FC3-951C-4BE876670218__I999156">使用DBMS_XPLAN.DISPLAY显示计划表时</a> ，查询不会并行执行。因此，没有报告与计划并行化有关的信息。如以下示例所示，仅当查询并行执行时，才会报告并行信息。
                     </p><pre class="oac_no_warn" dir="ltr">ALTER TABLE emp PARALLEL; SELECT * FROM emp e，dept d WHERE e.deptno = d.deptno AND e.ename ='hermann'ORDER BY e.empno; EXPLAIN PLAN</pre><p>使用<code class="codeph">DBMS_XPLAN.DISPLAY</code>表函数显示计划</p><pre class="oac_no_warn" dir="ltr">SET LINESIZE 130 SET PAGESIZE 0 SELECT * FROM DBMS_XPLAN.DISPLAY（）;计划哈希值：3693697345</pre><pre class="oac_no_warn" dir="ltr">-------------------------------------------------- -------------------------------------------------- --------- | Id |操作|名称|行|字节|成本（％CPU）|时间| TQ | INOUT | PQ Distrib | -------------------------------------------------- -------------------------------------------------- --------- | 0 |选择声明| | 1 | 117 | 6（50）| 00:00:01 | | | | | 1 | PX COORDINATOR | | | | | | | | | | 2 | PX SEND QC（订单）|：TQ10003 | 1 | 117 | 6（50）| 00:00:01 | Q1,03 | P-&gt; S | QC（订单）| | 3 |排序顺序| | 1 | 117 | 6（50）| 00:00:01 | Q1,03 | PCWP | | | 4 | PX RECEIVE | | 1 | 117 | 5（40）| 00:00:01 | Q1,03 | PCWP | | | 5 | PX SEND RANGE |：TQ10002 | 1 | 117 | 5（40）| 00:00:01 | Q1,02 | P-&gt; P |范围| | * 6 | HASH JOIN | | 1 | 117 | 5（40）| 00:00:01 | Q1,02 | PCWP | | | 7 | PX RECEIVE | | 1 | 87 | 2（50）| 00:00:01 | Q1,02 | PCWP | | | 8 | PX SEND HASH |：TQ10001 | 1 | 87 | 2（50）| 00:00:01 | Q1,01 | P-&gt; P |哈希| | 9 | PX BLOCK ITERATOR | | 1 | 87 | 2（50）| 00:00:01 | Q1,01 | PCWC | | | * 10 |表访问完全| EMP | 1 | 87 | 2（50）| 00:00:01 | Q1,01 | PCWP | | | 11 | BUFFER SORT | | | | | | Q1,02 | PCWC | | | 12 | PX RECEIVE | | 4 | 120 | 3（34）| 00:00:01 | Q1,02 | PCWP | | | 13 | PX SEND HASH |：TQ10000 | 4 | 120 | 3（34）| 00:00:01 | | S-&gt; P |哈希| | 14 |表访问完全| DEPT | 4 | 120 | 3（34）| 00:00:01 | | | | -------------------------------------------------- -------------------------------------------------- ---------谓词信息（由操作ID标识）：-------------------------------- ------------------- 6  - 访问（“E”。“DEPTNO”=“D”。“DEPTNO”）10  - 过滤器（“E”。“ENAME” ='hermann'）--------------------------------------------- ------</pre><p>当查询并行时，报告与并行性相关的信息：表队列号（ <code class="codeph">TQ</code>列），表队列类型（ <code class="codeph">INOUT</code> ）和表队列分配方法（ <code class="codeph">PQ Distrib</code> ）。
                     </p>
                     <p>默认情况下，如果计划表中的多个计划与传递给显示表函数的<code class="codeph">statement_id</code>参数匹配（默认值为<code class="codeph">NULL</code> ），则仅显示与最后一个<code class="codeph">EXPLAIN</code> <code class="codeph">PLAN</code>命令对应的<code class="codeph">PLAN</code> 。因此，在每个<code class="codeph">EXPLAIN</code> <code class="codeph">PLAN</code>之后无需清除计划表。但是，应定期清除计划表以确保在执行<code class="codeph">DISPLAY</code>表函数时具有良好的性能。如果未创建计划表，Oracle将使用全局临时表来存储单个用户的任何计划信息，并在会话的整个生命周期内保留其内容。请注意，您不能截断全局临时表的内容。
                     </p>
                     <p>为了便于使用，您可以在显示表函数的顶部定义视图，然后使用该视图显示<code class="codeph">EXPLAIN</code> <code class="codeph">PLAN</code>命令的输出：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-492CB99B-62C3-4FC3-951C-4BE876670218__GUID-294C015C-31C3-46D8-B7A6-C6083EE5CB06">使用视图显示上一个解释计划</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section"><pre class="oac_no_warn" dir="ltr">#define plan view CREATE VIEW PLAN as SELECT * FROM TABLE（DBMS_XPLAN.DISPLAY）; ＃显示最后一个解释计划命令SELECT * FROM PLAN的输出;</pre></div>
                  <!-- class="section" -->
               </div>
            </div><a id="ARPLS70130"></a><a id="ARPLS70131"></a><a id="ARPLS70131"></a><a id="ARPLS70130"></a><div class="props_rev_3"><a id="GUID-3575E99C-6F87-4446-BF8F-E2153554D30F" name="GUID-3575E99C-6F87-4446-BF8F-E2153554D30F"></a><h3 id="ARPLS-GUID-3575E99C-6F87-4446-BF8F-E2153554D30F" class="sect3"><span class="enumeration_section">206.5</span> DBMS_XPLAN子程序摘要</h3>
               <div>
                  <p>该表列出了DBMS_XPLAN子程序并简要描述了它们。</p>
                  <div class="tblformal" id="GUID-3575E99C-6F87-4446-BF8F-E2153554D30F__GUID-6BAF1809-EF32-4C6D-AC19-7BE73E9F30CD">
                     <p class="titleintable">表206-2 <span class="italic"><span class="bold">DBMS_XPLAN包子程序</span></span></p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="DBMS_XPLAN包子程序" width="100%" border="1" summary="This table lists the DBMS_XPLAN subprograms in alphabetical order and  briefly describes them." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="31%" id="d1282853e1241">子程序</th>
                              <th align="left" valign="bottom" width="69%" id="d1282853e1244">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d1282853e1249" headers="d1282853e1241 ">
                                 <p><a href="DBMS_XPLAN.html#GUID-5A80E12C-F126-413D-8FF7-FC04B382FA92" title="此功能将列表中的每个计划与参考计划进行比较并返回报告。">COMPARE_PLANS功能</a></p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d1282853e1249 d1282853e1244 ">
                                 <p>将列表中的每个计划与参考计划进行比较并返回报告</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d1282853e1260" headers="d1282853e1241 ">
                                 <p><a href="DBMS_XPLAN.html#GUID-AC276D57-23A4-43EA-B32D-CA3552DFD318" title="此函数比较两个sql计划，参考计划和目标计划。此函数返回一个task_id，可用于检索结果报告。">DIFF_PLAN功能</a></p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d1282853e1260 d1282853e1244 ">
                                 <p>比较计划</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d1282853e1274" headers="d1282853e1241 ">
                                 <p><a href="DBMS_XPLAN.html#GUID-2E479BE4-FEEA-400E-A218-DC779A2181CF" title="此表函数显示计划表的内容。">显示功能</a></p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d1282853e1274 d1282853e1244 ">
                                 <p>显示计划表的内容</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d1282853e1286" headers="d1282853e1241 ">
                                 <p><a href="DBMS_XPLAN.html#GUID-E234ED21-21A9-4237-9DF3-8E420CDDBC70" title="该表函数显示存储在AWR中的执行计划的内容。">DISPLAY_AWR功能</a></p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d1282853e1286 d1282853e1244 ">
                                 <p>显示存储在AWR中的执行计划的内容</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d1282853e1298" headers="d1282853e1241 ">
                                 <p><a href="DBMS_XPLAN.html#GUID-0EE333AF-E9AC-40A4-87D5-F6CF59D6C47B" title="此表函数显示加载到游标缓存中的任何游标的说明计划。除了解释计划，各种计划统计（如。可以报告I / O，内存和计时（基于V $ SQL_PLAN_STATISTICS_ALL VIEWS）。">DISPLAY_CURSOR功能</a></p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d1282853e1298 d1282853e1244 ">
                                 <p>显示游标缓存中任何游标的执行计划</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d1282853e1313" headers="d1282853e1241 ">
                                 <p><a href="DBMS_XPLAN.html#GUID-FDE553FD-2099-47B6-A1F8-83BFFDCF5662" title="此表函数以CLOB输出类型以各种格式显示计划表的内容。">DISPLAY_PLAN函数</a></p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d1282853e1313 d1282853e1244 ">
                                 <p>以<code class="codeph">CLOB</code>输出类型以各种格式显示计划表的内容</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d1282853e1331" headers="d1282853e1241 ">
                                 <p><a href="DBMS_XPLAN.html#GUID-98BB5243-873B-4C7F-B8EC-569C6248339D" title="此表函数显示SQL计划基准的指定SQL句柄的一个或多个执行计划。">DISPLAY_SQL_PLAN_BASELINE函数</a></p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d1282853e1331 d1282853e1244 ">
                                 <p>显示SQL计划基准的指定SQL句柄的一个或多个执行计划</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d1282853e1343" headers="d1282853e1241 ">
                                 <p><a href="DBMS_XPLAN.html#GUID-F935EACB-5FBB-4544-91DE-072C7CDA983C" title="此表函数显示存储在SQL调优集中的给定语句的执行计划。">DISPLAY_SQLSET函数</a></p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d1282853e1343 d1282853e1244 ">
                                 <p>显示存储在SQL调优集中的给定语句的执行计划</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
               </div>
               <div class="sect3"><a id="GUID-5A80E12C-F126-413D-8FF7-FC04B382FA92" name="GUID-5A80E12C-F126-413D-8FF7-FC04B382FA92"></a><h4 id="ARPLS-GUID-5A80E12C-F126-413D-8FF7-FC04B382FA92" class="sect4"><span class="enumeration_section">206.5.1</span> COMPARE_PLANS函数</h4>
                  <div>
                     <p>此功能将列表中的每个计划与参考计划进行比较并返回报告。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-5A80E12C-F126-413D-8FF7-FC04B382FA92__GUID-9F9F0D79-7365-4856-9A1D-80766B7F59E8">句法</p><pre class="pre codeblock"><code>DBMS_XPLAN.COMPARE_PLANS（reference_plan IN generic_plan_object，compare_plan_list IN plan_object_list，type IN VARCHAR2：='TEXT'，level IN VARCHAR2：='TYPICAL'，section IN VARCHAR2：='ALL'）RETURN CLOB;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-5A80E12C-F126-413D-8FF7-FC04B382FA92__GUID-4CAF648C-D883-48B3-8400-1A84F58D760C">参数</p>
                        <div class="tblformal" id="GUID-5A80E12C-F126-413D-8FF7-FC04B382FA92__GUID-E3DCD8F1-519E-4C6C-A15E-476B20860AA7">
                           <p class="titleintable">表206-3 COMPARE_PLANS函数参数</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="COMPARE_PLANS函数参数" width="100%" border="1" summary="This table describes the parameters of DBMS_XPLAN.COMPARE_PLANS subprogram." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" id="d1282853e1460">参数</th>
                                    <th align="left" valign="bottom" id="d1282853e1463">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" id="d1282853e1468" headers="d1282853e1460 ">
                                       <p><code class="codeph">reference_plan</code></p>
                                    </td>
                                    <td align="left" valign="top" headers="d1282853e1468 d1282853e1463 ">
                                       <p>参考计划。该计划应始终评估为单一计划。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" id="d1282853e1476" headers="d1282853e1460 ">
                                       <p><code class="codeph">compare_plan_list</code></p>
                                    </td>
                                    <td align="left" valign="top" headers="d1282853e1476 d1282853e1463 ">
                                       <p>与参考计划进行比较的计划清单。<code class="codeph">compare_plan_list</code>是<code class="codeph">generic_object</code>的列表，每个<code class="codeph">generic_object</code>可以对应于一个或多个计划。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" id="d1282853e1493" headers="d1282853e1460 ">
                                       <p><code class="codeph">类型</code></p>
                                    </td>
                                    <td align="left" valign="top" headers="d1282853e1493 d1282853e1463 ">
                                       <p>报告的类型。可能的值是：</p>
                                       <div class="p">
                                          <ul style="list-style-type:disc">
                                             <li>
                                                <p>文本</p>
                                             </li>
                                             <li>
                                                <p>HTML</p>
                                             </li>
                                             <li>
                                                <p>XML</p>
                                             </li>
                                          </ul>
                                       </div>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" id="d1282853e1512" headers="d1282853e1460 ">
                                       <p><code class="codeph">水平</code></p>
                                    </td>
                                    <td align="left" valign="top" headers="d1282853e1512 d1282853e1463 ">
                                       <p>报告格式。可能的值是：</p>
                                       <div class="p">
                                          <ul style="list-style-type:disc">
                                             <li>
                                                <p>BASIC</p>
                                             </li>
                                             <li>
                                                <p>典型</p>
                                             </li>
                                             <li>
                                                <p>所有</p>
                                             </li>
                                          </ul>
                                       </div>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" id="d1282853e1531" headers="d1282853e1460 ">
                                       <p><code class="codeph">部分</code></p>
                                    </td>
                                    <td align="left" valign="top" headers="d1282853e1531 d1282853e1463 ">
                                       <p>报告中的特定部分。可能的值是：</p>
                                       <div class="p">
                                          <ul style="list-style-type:disc">
                                             <li>
                                                <p>摘要</p>
                                             </li>
                                             <li>
                                                <p>发现</p>
                                             </li>
                                             <li>
                                                <p>PLANS</p>
                                             </li>
                                             <li>
                                                <p>信息</p>
                                             </li>
                                             <li>
                                                <p>错误</p>
                                             </li>
                                          </ul>
                                       </div>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-5A80E12C-F126-413D-8FF7-FC04B382FA92__GUID-94D0856B-DA64-4CDF-9E5A-F40DCF60E8A8">
                        <p class="titleinexample">例206-1例子</p>
                        <p>以下示例说明了COMPARE_PLANS函数的用法。</p><pre class="oac_no_warn" dir="ltr">var report clob; exec：report：= dbms_xplan.compare_plans（cursor_cache_object（'8mkxm7ur07za0'，2）， -  plan_object_list（cursor_cache_object（'8mkxm7ur07za0'，4）））;打印报告</pre><p>上面的示例将SQL ID“8mkxm7ur07za0”的子游标号2的计划与相同SQL ID的子游标号4的计划进行比较。以文本格式返回报告（默认）。</p>
                     </div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-5A80E12C-F126-413D-8FF7-FC04B382FA92__GUID-6391A81B-A718-4171-9D02-F18873712A30"><pre class="oac_no_warn" dir="ltr">var report clob; exec：report：= dbms_xplan.compare_plans（cursor_cache_object（'8mkxm7ur07za0'，2），plan_object_list（spm_object（'SQL_024d0f7d21351f5d'，'SQL_PLAN_sdfjkd'）））;打印报告</pre><p>上面的示例将SQL ID为“8mkxm7ur07za0”的子游标号2的计划与SPM为SQL句柄为“SQL_024d0f7d21351f5d”并且计划名称为“SQL_PLAN_sdfjkd”的查询所捕获的计划基线的计划进行比较。以文本格式返回报告（默认）。</p><pre class="oac_no_warn" dir="ltr">var report clob; exec：report = dbms_xplan.compare_plans（cursor_cache_object（'8mkxm7ur07za0'，2），plan_object_list（cursor_cache_object（'8mkxm7ur07za0'），sqlset_object（'SH'，'SQLT_WORKLOAD'，'6vfqvav0rgyad'），awr_object（'6vfqvav0rgyad'，5）， spm_object（'SQL_024d0f7d21351f5d'，'SQL_PLAN_sdfjkd'），plan_table_object（'SH'，'plan_table'，NULL，38），sql_profile_object（'pe3r3ejsfd'），dvisor_object（'TASK_1228'，'EXEC_1928'，'8mkxm7ur07za0'）） ，type =&gt;'XML'，level =&gt;'ALL'，section =&gt;'SUMMARY'）;</pre><p>上面的示例将SQL ID“8mkxm7ur07za0”的子游标号2的计划与以下列表中的每个计划进行比较：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>cursor_cache_object（'8mkxm7ur07za0'）：为SQL ID'8mkxm7ur07za0'生成的游标缓存中的所有计划。</p>
                           </li>
                           <li>
                              <p>sqlset_object（'SH'，'SQLT_WORKLOAD'，'6vfqvav0rgyad'）：在SQL调优集SH中生成的所有计划。 SQL ID为“6vfqvav0rgyad”的SQLT_WORKLOAD。</p>
                           </li>
                           <li>
                              <p>awr_object（'6vfqvav0rgyad'，5）：AWR中为数据库ID 5和SQL ID“6vfqvav0rgyad”捕获的所有计划。</p>
                           </li>
                           <li>
                              <p>spm_object（'SQL_024d0f7d21351f5d，'SQL_PLAN_sdfjkd'）：具有SQL句柄“SQL_024d0f7d21351f5d”且名称为“SQL_PLAN_sdfjkd”的查询的计划基准。</p>
                           </li>
                           <li>
                              <p>plan_table_object（'SH'，'plan_table'，NULL，38）：存储在由plan_id = 38标识的SH.plan_table中的计划。</p>
                           </li>
                           <li>
                              <p>sql_profile_object（'pe3r3ejsfd'）：由SQL配置文件名称'pe3r3ejsfd'标识的计划。</p>
                           </li>
                           <li>
                              <p>advisor_object（'TASK_1228'，'EXEC_1928'，'8mkxm7ur07za0'））：存储在SQL顾问程序中的所有计划由任务名称'TASK_1228'，执行名称'EXEC_1928'和SQL ID'8mkxm7ur07za0'标识。</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ARPLS74741"></a><a id="ARPLS74742"></a><a id="ARPLS74742"></a><a id="ARPLS74741"></a><div class="props_rev_3"><a id="GUID-AC276D57-23A4-43EA-B32D-CA3552DFD318" name="GUID-AC276D57-23A4-43EA-B32D-CA3552DFD318"></a><h4 id="ARPLS-GUID-AC276D57-23A4-43EA-B32D-CA3552DFD318" class="sect4"><span class="enumeration_section">206.5.2</span> DIFF_PLAN函数</h4>
                  <div>
                     <p>此函数比较两个sql计划，参考计划和目标计划。此函数返回一个<code class="codeph">task_id</code> ，可用于检索结果报告。
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-AC276D57-23A4-43EA-B32D-CA3552DFD318__GUID-B68AAFFD-7316-437D-9263-6C9879B6E844">句法</p><pre class="oac_no_warn" dir="ltr">DBMS_XPLAN.DIFF_PLAN（sql_text IN CLOB，outline IN CLOB，user_name IN VARCHAR2：='NULL'）RETURN VARCHAR2;</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-AC276D57-23A4-43EA-B32D-CA3552DFD318__GUID-1C87F47B-6173-44DA-A5E8-3FCC611001EE">参数</p>
                        <div class="tblformal" id="GUID-AC276D57-23A4-43EA-B32D-CA3552DFD318__GUID-3B4410FD-1140-4B4B-B5B3-35A6D01C6A7D">
                           <p class="titleintable">表206-4 DIFF_PLAN函数参数</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="DIFF_PLAN函数参数" width="100%" border="1" summary="This table describes the Parameters of DBMS_XPLAN.DIFF_PLAN subprogram." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="31%" id="d1282853e1709">参数</th>
                                    <th align="left" valign="bottom" width="69%" id="d1282853e1712">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d1282853e1717" headers="d1282853e1709 ">
                                       <p><code class="codeph">SQL_TEXT</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d1282853e1717 d1282853e1712 ">
                                       <p>SQL语句的文本。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d1282853e1725" headers="d1282853e1709 ">
                                       <p><code class="codeph">大纲</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d1282853e1725 d1282853e1712 ">
                                       <p>用于生成目标计划。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d1282853e1733" headers="d1282853e1709 ">
                                       <p><code class="codeph">用户名</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d1282853e1733 d1282853e1712 ">
                                       <p>解析模式名称默认为当前用户。</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ARPLS70132"></a><a id="ARPLS70133"></a><a id="ARPLS70133"></a><a id="ARPLS70132"></a><div class="props_rev_3"><a id="GUID-2E479BE4-FEEA-400E-A218-DC779A2181CF" name="GUID-2E479BE4-FEEA-400E-A218-DC779A2181CF"></a><h4 id="ARPLS-GUID-2E479BE4-FEEA-400E-A218-DC779A2181CF" class="sect4"><span class="enumeration_section">206.5.3</span>显示功能</h4>
                  <div>
                     <p><span>此表函数显示计划表的内容。</span></p>
                     <div class="section">
                        <p>此外，只要此表的列的名称与计划表的列相同（或者如果包含统计信息， <code class="codeph">V$SQL_PLAN_STATISTICS_ALL</code> ），您可以使用此表函数显示存储在表中的任何计划（有或没有统计信息） ）。您可以在指定的表上应用谓词以选择要显示的计划的行。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-2E479BE4-FEEA-400E-A218-DC779A2181CF__GUID-DF1ECE08-8333-4D23-93C6-377BCAD98B40">句法</p><pre class="pre codeblock"><code>DBMS_XPLAN.DISPLAY（table_name IN VARCHAR2 DEFAULT'PEG_TABLE'，statement_id IN VARCHAR2 DEFAULT NULL，格式IN VARCHAR2 DEFAULT'TYPICAL'，filter_preds IN VARCHAR2 DEFAULT NULL）;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-2E479BE4-FEEA-400E-A218-DC779A2181CF__GUID-5F1DF522-D64A-49FA-BED2-E2CC2A4D5172">参数</p>
                        <div class="tblformal" id="GUID-2E479BE4-FEEA-400E-A218-DC779A2181CF__GUID-7F2EE618-DDD2-449F-A5FE-3373FD769AC0">
                           <p class="titleintable">表206-5 DISPLAY功能参数</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="显示功能参数" width="100%" border="1" summary="This table describes the Parameters of DBMS_XPLAN.DISPLAY subprogram." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="25%" id="d1282853e1857">参数</th>
                                    <th align="left" valign="bottom" width="75%" id="d1282853e1860">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="25%" id="d1282853e1865" headers="d1282853e1857 ">
                                       <p><code class="codeph">TABLE_NAME</code></p>
                                    </td>
                                    <td align="left" valign="top" width="75%" headers="d1282853e1865 d1282853e1860 ">
                                       <p>指定存储计划的表名。此参数默认为<code class="codeph">PLAN_TABLE,</code>它是<code class="codeph">EXPLAIN PLAN</code>命令的默认计划表。如果指定<code class="codeph">NULL</code>则它也默认为<code class="codeph">PLAN_TABLE</code> 。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="25%" id="d1282853e1885" headers="d1282853e1857 ">
                                       <p><code class="codeph">statement_id</code></p>
                                    </td>
                                    <td align="left" valign="top" width="75%" headers="d1282853e1885 d1282853e1860 ">
                                       <p>指定要显示的计划的<code class="codeph">statement_id</code> 。此参数默认为<code class="codeph">NULL,</code>这是在没有<code class="codeph">set statement_id</code>子句的情况下执行<code class="codeph">EXPLAIN PLAN</code>命令时的默认值。如果未指定<code class="codeph">statement_id</code> ，则该函数会显示最近解释的语句的计划。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="25%" id="d1282853e1908" headers="d1282853e1857 ">
                                       <p><code class="codeph">格式</code></p>
                                    </td>
                                    <td align="left" valign="top" width="75%" headers="d1282853e1908 d1282853e1860 ">
                                       <p>控制计划的详细程度。它接受以下值：</p>
                                       <ul style="list-style-type:disc">
                                          <li>
                                             <p><code class="codeph">BASIC</code> ：显示计划中的最小信息 - 操作ID，操作名称及其选项。
                                             </p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">TYPICAL</code> ：这是默认值。显示计划中最相关的信息（操作ID，名称和选项，＃rows，＃byte和优化程序成本）。仅在适用时显示修剪，并行和谓词信息。仅排除<code class="codeph">PROJECTION</code> ， <code class="codeph">ALIAS</code>和<code class="codeph">REMOTE SQL</code>信息（见下文）。
                                             </p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">SERIAL</code> ：与<code class="codeph">TYPICAL</code>类似，但不显示并行信息，即使计划并行执行也是如此。
                                             </p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">ALL</code> ：最高用户级别。包括显示<code class="codeph">TYPICAL</code>级别的信息以及附加信息（如果操作是分发的，则<code class="codeph">PROJECTION</code> ， <code class="codeph">ALIAS</code>和有关<code class="codeph">REMOTE SQL</code>信息）。
                                             </p>
                                          </li>
                                       </ul>
                                       <p>为了更好地控制显示输出，可以将以下关键字添加到上述三种标准格式选项中，以自定义其默认行为。每个关键字表示计划表列的逻辑组（例如<code class="codeph">PARTITION</code> ）或基本计划表输出的逻辑添加（例如<code class="codeph">PREDICATE</code> ）。格式关键字必须用逗号或空格分隔：</p>
                                       <ul style="list-style-type:disc">
                                          <li>
                                             <p><code class="codeph">ROWS</code> - 如果相关，则显示优化程序估计的行数</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">BYTES</code> - 如果相关，则显示优化程序估计的字节数</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">COST</code> - 如果相关，则显示优化程序成本信息</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">PARTITION</code> - 如果相关，则显示分区修剪信息</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">PARALLEL</code> - 如果相关，显示PX信息（分发方法和表队列信息）</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">PREDICATE</code> -如果相关，显示了谓语部分</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">PROJECTION</code> -如果相关，显示了突起部</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">ALIAS</code> - 如果相关，则显示“查询块名称/对象别名”部分</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">REMOTE</code> - 如果相关，显示分布式查询的信息（例如，远程串行分发和远程SQL）</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">NOTE</code> - 如果相关，则显示解释计划的注释部分</p>
                                          </li>
                                       </ul>
                                       <p>格式关键字可以使用符号“ <code class="codeph">-</code> ”作为前缀，以排除指定的信息。例如，' - <code class="codeph">-PROJECTION</code> '不包括投影信息。
                                       </p>
                                       <p>如果目标计划表（请参阅<code class="codeph">table_name</code>参数）还存储计划统计信息列（例如，它是用于捕获固定视图<code class="codeph">V$SQL_PLAN_STATISTICS_ALL</code>的内容的表），则可以使用其他格式关键字来指定要对哪个统计信息类别使用<a href="DBMS_XPLAN.html#GUID-2E479BE4-FEEA-400E-A218-DC779A2181CF" title="This table function displays the contents of the plan table.">DISPLAY功能</a>时<a href="DBMS_XPLAN.html#GUID-2E479BE4-FEEA-400E-A218-DC779A2181CF" title="此表函数显示计划表的内容。">显示</a> 。这些额外的格式关键字是<code class="codeph">IOSTATS</code> ， <code class="codeph">MEMSTATS</code> ， <code class="codeph">ALLSTATS</code>和<code class="codeph">LAST</code> （有关这四个关键字的完整说明，请参阅<a href="DBMS_XPLAN.html#GUID-0EE333AF-E9AC-40A4-87D5-F6CF59D6C47B" title="此表函数显示加载到游标缓存中的任何游标的说明计划。除了解释计划，各种计划统计（如。可以报告I / O，内存和计时（基于V $ SQL_PLAN_STATISTICS_ALL VIEWS）。">DISPLAY_CURSOR函数</a>或<a href="DBMS_XPLAN.html#GUID-F935EACB-5FBB-4544-91DE-072C7CDA983C" title="此表函数显示存储在SQL调优集中的给定语句的执行计划。">DISPLAY_SQLSET函数</a> ）。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="25%" id="d1282853e2073" headers="d1282853e1857 ">
                                       <p><code class="codeph">filter_preds</code></p>
                                    </td>
                                    <td align="left" valign="top" width="75%" headers="d1282853e2073 d1282853e1860 ">
                                       <p>SQL过滤器谓词，用于限制从存储计划的表中选择的行集。当值为<code class="codeph">NULL</code> （默认值）时，显示的计划对应于上次执行的解释计划。例如： <code class="codeph">filter_preds=&gt;'plan_id = 10'</code></p>
                                       <p>可以引用存储计划的表的任何列，并且可以包含任何SQL构造（例如，子查询，函数调用（请参阅使用说明下的<span class="bold"><code class="codeph">WARNING</code></span> ）</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-2E479BE4-FEEA-400E-A218-DC779A2181CF__GUID-DB73A5DC-2145-44E9-8A19-ED1F506E1228">使用说明</p>
                        <p>您可以通过以下方式使用<code class="codeph">format</code>参数的变体：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>使用' <code class="codeph">ALL -PROJECTION -NOTE</code> '显示除投影和注释部分以外的所有内容。
                              </p>
                           </li>
                           <li>
                              <p>使用“ <code class="codeph">TYPICAL PROJECTION</code> ”使用带有附加投影部分的典型格式进行显示（通常在典型格式下排除）。由于典型值是默认值，因此使用简单的“ <code class="codeph">PROJECTION</code> ”是等效的。
                              </p>
                           </li>
                           <li>
                              <p>使用' <code class="codeph">-BYTES -COST -PREDICATE</code> '以使用典型格式显示，但不包括优化程序成本和字节估计以及谓词部分。
                              </p>
                           </li>
                           <li>
                              <p>使用“ <code class="codeph">BASIC ROWS</code> ”显示基本信息，其中包含优化程序估计的额外行数。
                              </p>
                              <div class="infoboxnotewarn" id="GUID-2E479BE4-FEEA-400E-A218-DC779A2181CF__GUID-1D70F77B-4239-4E6E-9DF6-2593B8BD74EF">
                                 <p class="notep1">警告：</p>
                                 <p>应用程序开发人员只有在仔细考虑之后才应将<code class="codeph">filter_preds</code>参数公开给最终用户，因为这可能会将应用程序暴露给SQL注入。实际上， <code class="codeph">filter_preds</code>可以引用任何表或执行调用表函数的数据库用户具有特权的任何服务器函数。
                                 </p>
                              </div>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-2E479BE4-FEEA-400E-A218-DC779A2181CF__GUID-5966D998-62EC-42CD-A43A-40960BD8F8FD">例子</p>
                        <p>要显示存储在计划表中的最后一个<code class="codeph">EXPLAIN PLAN</code>命令的结果：</p><pre class="pre codeblock"><code>SELECT * FROM TABLE（DBMS_XPLAN.DISPLAY）;</code></pre><p>要从默认计划表以外的地方显示“ <code class="codeph">my_plan_table</code> ”：</p><pre class="pre codeblock"><code>SELECT * FROM table（DBMS_XPLAN.DISPLAY（'my_plan_table'））;</code></pre><p>要显示最低计划信息：</p><pre class="pre codeblock"><code>SELECT * FROM table（DBMS_XPLAN.DISPLAY（'plan_table'，null，'basic'））;</code></pre><p>显示由' <code class="codeph">foo</code> '标识的语句的计划，例如<code class="codeph">statement_id='sales_query'</code> ：</p><pre class="pre codeblock"><code>SELECT * FROM table（DBMS_XPLAN.DISPLAY（'plan_table'，'sales_query'））;</code></pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ARPLS70134"></a><a id="ARPLS70135"></a><a id="ARPLS70135"></a><a id="ARPLS70134"></a><div class="props_rev_3"><a id="GUID-E234ED21-21A9-4237-9DF3-8E420CDDBC70" name="GUID-E234ED21-21A9-4237-9DF3-8E420CDDBC70"></a><h4 id="ARPLS-GUID-E234ED21-21A9-4237-9DF3-8E420CDDBC70" class="sect4"><span class="enumeration_section">206.5.4</span> DISPLAY_AWR功能</h4>
                  <div>
                     <p><span>该表函数显示存储在AWR中的执行计划的内容。</span></p>
                     <div class="section">
                        <div class="infoboxnote" id="GUID-E234ED21-21A9-4237-9DF3-8E420CDDBC70__GUID-EA5DA8C9-EA3C-4593-94B4-8CBC00ADDCB2">
                           <p class="notep1">注意：</p>
                           <p>不推荐使用此功能。请改用<code class="codeph">DISPLAY_WORKLOAD_REPOSITORY</code> 。<code class="codeph">DISPLAY_AWR</code>仅适用于本地DBID的快照，而<code class="codeph">DISPLAY_WORKLOAD_REPOSITORY</code>支持AWR内的所有快照，包括远程和导入的快照。
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-E234ED21-21A9-4237-9DF3-8E420CDDBC70__GUID-3C7C552A-1783-4664-ADF8-A3F819A6E205">句法</p><pre class="pre codeblock"><code>DBMS_XPLAN.DISPLAY_AWR（sql_id IN VARCHAR2，plan_hash_value IN NUMBER DEFAULT NULL，db_id IN NUMBER DEFAULT NULL，格式IN VARCHAR2 DEFAULT TYPICAL）;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-E234ED21-21A9-4237-9DF3-8E420CDDBC70__GUID-7C03E4FD-BACC-4737-9B1E-BB9B3FC2ADD3">参数</p>
                        <div class="tblformal" id="GUID-E234ED21-21A9-4237-9DF3-8E420CDDBC70__GUID-B3D42125-7B2E-41CA-A3D4-A8104D3A6F4B">
                           <p class="titleintable">表206-6 DISPLAY_AWR表功能参数</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="DISPLAY_AWR表函数参数" width="100%" border="1" summary="This table describes the Parameters of DBMS_XPLAN.DISPLAY_AWR subprogram." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="25%" id="d1282853e2291">参数</th>
                                    <th align="left" valign="bottom" width="75%" id="d1282853e2294">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="25%" id="d1282853e2299" headers="d1282853e2291 ">
                                       <p><code class="codeph">SQL_ID</code></p>
                                    </td>
                                    <td align="left" valign="top" width="75%" headers="d1282853e2299 d1282853e2294 ">
                                       <p>指定SQL语句的<code class="codeph">SQL_ID</code> 。您可以通过查询<code class="codeph">DBA_HIST_SQLTEXT</code> <code class="codeph">SQL_ID</code>列来检索感兴趣的SQL语句的相应值。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="25%" id="d1282853e2316" headers="d1282853e2291 ">
                                       <p><code class="codeph">plan_hash_value</code></p>
                                    </td>
                                    <td align="left" valign="top" width="75%" headers="d1282853e2316 d1282853e2294 ">
                                       <p>指定SQL语句的<code class="codeph">PLAN_HASH_VALUE</code> 。此参数是可选的。如果省略，则表函数返回给定<code class="codeph">SQL_ID</code>所有存储执行计划。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="25%" id="d1282853e2330" headers="d1282853e2291 ">
                                       <p><code class="codeph">DB_ID</code></p>
                                    </td>
                                    <td align="left" valign="top" width="75%" headers="d1282853e2330 d1282853e2294 ">
                                       <p>指定<code class="codeph">database_id</code>为其SQL语句的计划，以确定<code class="codeph">SQL_ID</code>应显示。如果未提供，所述<code class="codeph">database_id</code>本地数据库的使用，如在<code class="codeph">V$DATABASE</code> 。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="25%" id="d1282853e2350" headers="d1282853e2291 ">
                                       <p><code class="codeph">格式</code></p>
                                    </td>
                                    <td align="left" valign="top" width="75%" headers="d1282853e2350 d1282853e2294 ">
                                       <p>控制计划的详细程度。它接受四个值：</p>
                                       <ul style="list-style-type:disc">
                                          <li>
                                             <p><code class="codeph">BASIC</code> ：显示计划中的最小信息 - 操作ID，操作名称及其选项。
                                             </p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">TYPICAL</code> ：这是默认值。显示计划中最相关的信息（操作ID，名称和选项，＃rows，＃byte和优化程序成本）。仅在适用时显示修剪，并行和谓词信息。仅排除<code class="codeph">PROJECTION</code> ， <code class="codeph">ALIAS</code>和<code class="codeph">REMOTE</code> <code class="codeph">SQL</code>信息（见下文）。
                                             </p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">SERIAL</code> ：与<code class="codeph">TYPICAL</code>类似，但不显示并行信息，即使计划并行执行也是如此。
                                             </p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">ALL</code> ：最高用户级别。包括显示<code class="codeph">TYPICAL</code>级别的信息以及附加信息（如果操作是分发的，则<code class="codeph">PROJECTION</code> ， <code class="codeph">ALIAS</code>和有关<code class="codeph">REMOTE</code> <code class="codeph">SQL</code>信息）。
                                             </p>
                                          </li>
                                       </ul>
                                       <p>为了更好地控制显示输出，可以将以下关键字添加到上述四种标准格式选项中，以自定义其默认行为。每个关键字表示计划表列的逻辑组（例如<code class="codeph">PARTITION</code> ）或基本计划表输出的逻辑添加（例如<code class="codeph">PREDICATE</code> ）。格式关键字必须用逗号或空格分隔：</p>
                                       <ul style="list-style-type:disc">
                                          <li>
                                             <p><code class="codeph">ROWS</code> - 如果相关，则显示优化程序估计的行数</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">BYTES</code> - 如果相关，则显示优化程序估计的字节数</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">COST</code> - 如果相关，则显示优化程序成本信息</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">PARTITION</code> - 如果相关，则显示分区修剪信息</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">PARALLEL</code> - 如果相关，显示PX信息（分发方法和表队列信息）</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">PREDICATE</code> -如果相关，显示了谓语部分</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">PROJECTION</code> -如果相关，显示了突起部</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">ALIAS</code> - 如果相关，则显示“查询块名称/对象别名”部分</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">REMOTE</code> - 如果相关，显示分布式查询的信息（例如，远程串行分发和远程SQL）</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">NOTE</code> - 如果相关，则显示解释计划的注释部分</p>
                                          </li>
                                       </ul>
                                       <p>格式关键字可以使用符号“ <code class="codeph">-</code> ”作为前缀，以排除指定的信息。例如，' - <code class="codeph">-PROJECTION</code> '不包括投影信息。
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-E234ED21-21A9-4237-9DF3-8E420CDDBC70__GUID-109F466C-BDCC-4451-8E1E-D80F8066E3C3">使用说明</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>要使用<code class="codeph">DISPLAY_AWR</code>功能，调用用户必须对<code class="codeph">DBA_HIST_SQL_PLAN</code> ， <code class="codeph">DBA_HIST_SQLTEXT</code>和<code class="codeph">V$DATABASE</code>具有<code class="codeph">SELECT</code>或<code class="codeph">READ</code>权限，否则它将显示相应的错误消息。
                              </p>
                           </li>
                           <li>
                              <p>以下示例显示了使用<code class="codeph">format</code>参数的不同方法：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>使用“ <code class="codeph">BASIC ROWS</code> ”显示基本信息，其中包含优化程序估计的额外行数。
                                    </p>
                                 </li>
                                 <li>
                                    <p>使用' <code class="codeph">ALL -PROJECTION -NOTE</code> '显示除投影和注释部分以外的所有内容。
                                    </p>
                                 </li>
                                 <li>
                                    <p>使用“ <code class="codeph">TYPICAL PROJECTION</code> ”使用带有附加投影部分的典型格式进行显示（通常在典型格式下排除）。由于典型值是默认值，因此使用简单的“ <code class="codeph">PROJECTION</code> ”是等效的。
                                    </p>
                                 </li>
                                 <li>
                                    <p>使用' <code class="codeph">-BYTES -COST -PREDICATE</code> '以使用典型格式显示，但不包括优化程序成本和字节估计以及谓词部分。
                                    </p>
                                 </li>
                              </ul>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-E234ED21-21A9-4237-9DF3-8E420CDDBC70__GUID-91466CB9-5E8F-40E0-84C7-502A31FEA119">例子</p>
                        <p>要显示与SQL ID“ <code class="codeph">atfwcg8anrykp</code> ”关联的不同执行计划：</p><pre class="pre codeblock"><code>SELECT * FROM table（DBMS_XPLAN.DISPLAY_AWR（'atfwcg8anrykp'））;</code></pre><p>要显示包含字符串' <code class="codeph">TOTO</code> '的所有存储SQL语句的所有执行计划：</p><pre class="pre codeblock"><code>选择tf。* FROM DBA_HIST_SQLTEXT ht，table（DBMS_XPLAN.DISPLAY_AWR（ht.sql_id，null，null，'ALL'））tf WHERE ht.sql_text like'％TOTO％';</code></pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ARPLS70136"></a><a id="ARPLS70137"></a><a id="ARPLS70137"></a><a id="ARPLS70136"></a><div class="props_rev_3"><a id="GUID-0EE333AF-E9AC-40A4-87D5-F6CF59D6C47B" name="GUID-0EE333AF-E9AC-40A4-87D5-F6CF59D6C47B"></a><h4 id="ARPLS-GUID-0EE333AF-E9AC-40A4-87D5-F6CF59D6C47B" class="sect4"><span class="enumeration_section">206.5.5</span> DISPLAY_CURSOR函数</h4>
                  <div>
                     <p><span>此表函数显示加载到游标缓存中的任何游标的说明计划。除了解释计划，各种计划统计（如。可以报告I / O，内存和计时（基于<code class="codeph">V$SQL_PLAN_STATISTICS_ALL VIEWS</code> ）。</span></p>
                     <div class="section">
                        <p class="subhead3" id="GUID-0EE333AF-E9AC-40A4-87D5-F6CF59D6C47B__GUID-E872DC34-877A-49C1-8880-6AB4EF97624C">句法</p><pre class="pre codeblock"><code>DBMS_XPLAN.DISPLAY_CURSOR（sql_id IN VARCHAR2 DEFAULT NULL，cursor_child_no IN NUMBER DEFAULT 0，format IN VARCHAR2 DEFAULT'TYPICAL'）;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-0EE333AF-E9AC-40A4-87D5-F6CF59D6C47B__GUID-F9D50F48-81FB-4787-85A0-5BA16033C520">参数</p>
                        <div class="tblformal" id="GUID-0EE333AF-E9AC-40A4-87D5-F6CF59D6C47B__GUID-14874480-6C7B-4531-AEFB-681B96622DA0">
                           <p class="titleintable">表206-7 DISPLAY_CURSOR函数参数</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="DISPLAY_CURSOR函数参数" width="100%" border="1" summary="This table describes the Parameters of DBMS_XPLAN.DISPLAYCURSOR subprogram." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="25%" id="d1282853e2667">参数</th>
                                    <th align="left" valign="bottom" width="75%" id="d1282853e2670">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="25%" id="d1282853e2675" headers="d1282853e2667 ">
                                       <p><code class="codeph">SQL_ID</code></p>
                                    </td>
                                    <td align="left" valign="top" width="75%" headers="d1282853e2675 d1282853e2670 ">
                                       <p>指定游标缓存中SQL语句的<code class="codeph">SQL_ID</code> 。您可以通过查询<code class="codeph">V$SQL</code>或<code class="codeph">V$SQLAREA</code> <code class="codeph">SQL_ID</code>列来检索适当的值。或者，您可以从<code class="codeph">V$SESSION</code>为特定会话选择列<code class="codeph">PREV_SQL_ID</code> 。此参数默认为<code class="codeph">NULL</code>在这种情况下，将显示会话执行的最后一个游标的计划。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="25%" id="d1282853e2705" headers="d1282853e2667 ">
                                       <p><code class="codeph">cursor_child_no</code></p>
                                    </td>
                                    <td align="left" valign="top" width="75%" headers="d1282853e2705 d1282853e2670 ">
                                       <p>要显示的光标的子编号。如果未提供，则显示与提供的<code class="codeph">sql_id</code>参数匹配的所有游标的执行计划。仅当指定了<code class="codeph">child_number</code>时，才能指定<code class="codeph">sql_id</code> 。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="25%" id="d1282853e2722" headers="d1282853e2667 ">
                                       <p><code class="codeph">格式</code></p>
                                    </td>
                                    <td align="left" valign="top" width="75%" headers="d1282853e2722 d1282853e2670 ">
                                       <p>控制计划的详细程度。它接受五个值：</p>
                                       <ul style="list-style-type:disc">
                                          <li>
                                             <p><code class="codeph">BASIC</code> ：显示计划中的最小信息 - 操作ID，操作名称及其选项。
                                             </p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">TYPICAL</code> ：这是默认值。显示计划中最相关的信息（操作ID，名称和选项，＃rows，＃byte和优化程序成本）。仅在适用时显示修剪，并行和谓词信息。仅排除<code class="codeph">PROJECTION</code> ， <code class="codeph">ALIAS</code>和<code class="codeph">REMOTE SQL</code>信息（见下文）。
                                             </p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">SERIAL</code> ：与<code class="codeph">TYPICAL</code>类似，但不显示并行信息，即使计划并行执行也是如此。
                                             </p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">ALL</code> ：最高用户级别。包括显示<code class="codeph">TYPICAL</code>级别的信息以及附加信息（如果操作是分发的，则<code class="codeph">PROJECTION</code> ， <code class="codeph">ALIAS</code>和有关<code class="codeph">REMOTE SQL</code>信息）。
                                             </p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">ADAPTIVE</code> ：</p>
                                             <ul style="list-style-type:disc">
                                                <li>
                                                   <p>如果执行尚未完成，则显示最终计划或当前计划。本节包含有关影响计划的运行时优化的注释，例如从嵌套循环连接切换到散列连接。</p>
                                                </li>
                                                <li>
                                                   <p>计划血统。此部分显示由于自动重新优化而先前运行的计划。如果计划因动态计划而更改，它还会显示默认计划。</p>
                                                </li>
                                                <li>
                                                   <p>推荐计划。在报告模式下，根据显示的执行统计信息选择计划。请注意，显示自动重新优化的建议计划需要使用子游标中收集的优化程序调整重新编译查询。显示动态计划的建议计划不需要这样做。</p>
                                                </li>
                                                <li>
                                                   <p>动态计划。这总结了计划中与优化程序选择的默认计划不同的部分。</p>
                                                </li>
                                             </ul>
                                          </li>
                                       </ul>
                                       <p>要更好地控制显示输出，可以将以下关键字添加到前面的格式选项中，以自定义其默认行为。每个关键字表示计划表列的逻辑组（例如<code class="codeph">PARTITION</code> ）或基本计划表输出的逻辑添加（例如<code class="codeph">PREDICATE</code> ）。
                                       </p>
                                       <p>格式关键字必须用逗号或空格分隔：</p>
                                       <ul style="list-style-type:disc">
                                          <li>
                                             <p><code class="codeph">ROWS</code> - 如果相关，则显示优化程序估计的行数</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">BYTES</code> - 如果相关，则显示优化程序估计的字节数</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">COST</code> - 如果相关，则显示优化程序成本信息</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">PARTITION</code> - 如果相关，则显示分区修剪信息</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">PARALLEL</code> - 如果相关，显示PX信息（分发方法和表队列信息）</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">PREDICATE</code> -如果相关，显示了谓语部分</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">PROJECTION</code> -如果相关，显示了突起部</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">ALIAS</code> - 如果相关，则显示“查询块名称/对象别名”部分</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">REMOTE</code> - 如果相关，显示分布式查询的信息（例如，远程串行分发和远程SQL）</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">NOTE</code> - 如果相关，则显示解释计划的注释部分</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">IOSTATS</code> - 假设在执行SQL语句时（通过使用<code class="codeph">gather_plan_statistics</code>提示或通过将参数statistics_level设置为ALL）收集基本计划统计信息，此格式显示<code class="codeph">ALL</code> IO统计信息（或仅用于<code class="codeph">LAST</code> ，如下所示）执行光标。
                                             </p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">MEMSTATS</code> - 假设启用了PGA内存管理（即<code class="codeph">pga_aggregate_target</code>参数设置为非0值），此格式允许显示内存管理统计信息（例如，运算符的执行模式，使用的内存量，数量字节溢出到磁盘，等等）。这些统计信息仅适用于内存密集型操作，如散列连接，排序或某些位图操作符。
                                             </p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">ALLSTATS</code> - <code class="codeph">'IOSTATS MEMSTATS'</code>捷径</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">LAST</code> - 默认情况下，会显示光标所有执行的计划统计信息。可以指定关键字<code class="codeph">LAST</code>以仅查看上次执行的统计信息。
                                             </p>
                                          </li>
                                       </ul>
                                       <p>不推荐使用以下格式，但支持向后兼容：</p>
                                       <ul style="list-style-type:disc">
                                          <li>
                                             <p><code class="codeph">RUNSTATS_TOT</code> - 与<code class="codeph">IOSTATS,</code>相同<code class="codeph">IOSTATS,</code>即显示指定游标的所有执行的IO统计信息。
                                             </p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">RUNSTATS_LAST</code> - 与<code class="codeph">IOSTATS</code> <code class="codeph">LAST</code>相同，即显示上次执行游标的运行时统计信息</p>
                                          </li>
                                       </ul>
                                       <p>您可以使用符号“ <code class="codeph">-</code> ”为格式关键字添加前缀，以排除指定的信息。例如，' - <code class="codeph">-PROJECTION</code> '不包括投影信息。
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-0EE333AF-E9AC-40A4-87D5-F6CF59D6C47B__GUID-F0489E10-CC9B-4B1B-8D08-4576BBA36E12">使用说明</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>要使用<code class="codeph">DISPLAY_CURSOR</code>功能，调用用户必须对固定视图<code class="codeph">V$SQL_PLAN_STATISTICS_ALL</code> ， <code class="codeph">V$SQL</code>和<code class="codeph">V$SQL_PLAN</code>具有<code class="codeph">SELECT</code>或<code class="codeph">READ</code>权限，否则它将显示相应的错误消息。
                              </p>
                           </li>
                           <li>
                              <p>您可以通过以下方式使用<code class="codeph">format</code>参数的变体：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>使用' <code class="codeph">ALL -PROJECTION -NOTE</code> '显示除投影和注释部分以外的所有内容。
                                    </p>
                                 </li>
                                 <li>
                                    <p>使用“ <code class="codeph">TYPICAL PROJECTION</code> ”使用带有附加投影部分的典型格式进行显示（通常在典型格式下排除）。由于典型值是默认值，因此使用简单的“ <code class="codeph">PROJECTION</code> ”是等效的。
                                    </p>
                                 </li>
                                 <li>
                                    <p>使用' <code class="codeph">-BYTES -COST -PREDICATE</code> '以使用典型格式显示，但不包括优化程序成本和字节估计以及谓词部分。
                                    </p>
                                 </li>
                                 <li>
                                    <p>使用“ <code class="codeph">BASIC ROWS</code> ”显示基本信息，其中包含优化程序估计的额外行数。
                                    </p>
                                 </li>
                              </ul>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-0EE333AF-E9AC-40A4-87D5-F6CF59D6C47B__GUID-114C3016-D09F-48B6-BD0C-AB716B9ED32D">例子</p>
                        <p>要显示当前会话执行的最后一条<code class="codeph">SQL</code>语句的执行计划：</p><pre class="pre codeblock"><code>SELECT * FROM table（DBMS_XPLAN.DISPLAY_CURSOR）;</code></pre><p>要显示与SQL ID“ <code class="codeph">atfwcg8anrykp</code> ”关联的所有子项的执行计划：</p><pre class="pre codeblock"><code>SELECT * FROM table（DBMS_XPLAN.DISPLAY_CURSOR（'atfwcg8anrykp'））;</code></pre><p>要显示前面语句中包含的游标的运行时统计信息：</p><pre class="pre codeblock"><code>SELECT * FROM table（DBMS_XPLAN.DISPLAY_CURSOR（'atfwcg8anrykp'，NULL，'ALLSTATS LAST'）;</code></pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ARPLS72977"></a><a id="ARPLS72978"></a><a id="ARPLS72978"></a><a id="ARPLS72977"></a><div class="props_rev_3"><a id="GUID-FDE553FD-2099-47B6-A1F8-83BFFDCF5662" name="GUID-FDE553FD-2099-47B6-A1F8-83BFFDCF5662"></a><h4 id="ARPLS-GUID-FDE553FD-2099-47B6-A1F8-83BFFDCF5662" class="sect4"><span class="enumeration_section">206.5.6</span> DISPLAY_PLAN函数</h4>
                  <div>
                     <p><span>此表函数以<code class="codeph">CLOB</code>输出类型以各种格式显示计划表的内容。</span></p>
                     <div class="section">
                        <p class="subhead3" id="GUID-FDE553FD-2099-47B6-A1F8-83BFFDCF5662__GUID-DBBC0F87-AF65-414C-AF6E-1BCAB966D30B">句法</p><pre class="pre codeblock"><code>DBMS_XPLAN.DISPLAY_PLAN（table_name IN VARCHAR2 DEFAULT'PEG_TABLE'，statement_id IN VARCHAR2 DEFAULT NULL，格式IN VARCHAR2 DEFAULT'TYPICAL'，filter_preds IN VARCHAR2 DEFAULT NULL，输入IN VARCHAR2 DEFAULT'TEXT'）RETURN CLOB;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-FDE553FD-2099-47B6-A1F8-83BFFDCF5662__GUID-DEEFF6F2-76F7-4B65-A366-94B81EEE7C10">参数</p>
                        <div class="tblformal" id="GUID-FDE553FD-2099-47B6-A1F8-83BFFDCF5662__GUID-D980F582-6DD0-4E03-B3BB-8A496B7217EF">
                           <p class="titleintable">表206-8 DISPLAY_PLAN函数参数</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="DISPLAY_PLAN函数参数" width="100%" border="1" summary="This table describes the Parameters of DBMS_XPLAN.DISPLAY_PLAN subprogram." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="25%" id="d1282853e3116">参数</th>
                                    <th align="left" valign="bottom" width="75%" id="d1282853e3119">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="25%" id="d1282853e3124" headers="d1282853e3116 ">
                                       <p><code class="codeph">TABLE_NAME</code></p>
                                    </td>
                                    <td align="left" valign="top" width="75%" headers="d1282853e3124 d1282853e3119 ">
                                       <p>指定存储计划的表名。此参数默认为<code class="codeph">PLAN_TABLE,</code>它是<code class="codeph">EXPLAIN</code> <code class="codeph">PLAN</code>命令的默认计划表。如果指定<code class="codeph">NULL</code>则它也默认为<code class="codeph">PLAN_TABLE</code> 。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="25%" id="d1282853e3147" headers="d1282853e3116 ">
                                       <p><code class="codeph">statement_id</code></p>
                                    </td>
                                    <td align="left" valign="top" width="75%" headers="d1282853e3147 d1282853e3119 ">
                                       <p>指定要显示的计划的<code class="codeph">statement_id</code> 。此参数默认为<code class="codeph">NULL,</code>这是在没有<code class="codeph">set</code> <code class="codeph">statement_id</code>子句的情况下执行<code class="codeph">EXPLAIN</code> <code class="codeph">PLAN</code>命令时的默认值。如果未指定<code class="codeph">statement_id</code> ，则该函数会显示最近解释的语句的计划。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="25%" id="d1282853e3177" headers="d1282853e3116 ">
                                       <p><code class="codeph">filter_preds</code></p>
                                    </td>
                                    <td align="left" valign="top" width="75%" headers="d1282853e3177 d1282853e3119 ">
                                       <p>SQL过滤器谓词，用于限制从存储计划的表中选择的行集。当值为<code class="codeph">NULL</code> （默认值）时，显示的计划对应于上次执行的解释计划。例如： <code class="codeph">filter_preds=&gt;'plan_id = 10'</code></p>
                                       <p>可以引用存储计划的表的任何列，并且可以包含任何SQL构造（例如，子查询，函数调用（请参阅使用说明下的<span class="bold"><code class="codeph">WARNING</code></span> ）</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="25%" id="d1282853e3196" headers="d1282853e3116 ">
                                       <p><code class="codeph">格式</code></p>
                                    </td>
                                    <td align="left" valign="top" width="75%" headers="d1282853e3196 d1282853e3119 ">
                                       <p>控制计划的详细程度。它接受五个值：</p>
                                       <ul style="list-style-type:disc">
                                          <li>
                                             <p><code class="codeph">BASIC</code> ：显示计划中的最小信息 - 操作ID，操作名称及其选项。
                                             </p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">TYPICAL</code> ：这是默认值。显示计划中最相关的信息（操作ID，名称和选项，＃rows，＃byte和优化程序成本）。仅在适用时显示修剪，并行和谓词信息。仅排除<code class="codeph">PROJECTION</code> ， <code class="codeph">ALIAS</code>和<code class="codeph">REMOTE</code> <code class="codeph">SQL</code>信息（见下文）。
                                             </p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">SERIAL</code> ：与<code class="codeph">TYPICAL</code>类似，但不显示并行信息，即使计划并行执行也是如此。
                                             </p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">ALL</code> ：最高用户级别。包括显示<code class="codeph">TYPICAL</code>级别的信息以及附加信息（如果操作是分发的，则<code class="codeph">PROJECTION</code> ， <code class="codeph">ALIAS</code>和有关<code class="codeph">REMOTE</code> <code class="codeph">SQL</code>信息）。
                                             </p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">ADAPTIVE</code> ：显示默认计划，并为每个动态子计划（如果规定）：</p>
                                             <p>- 原始行中可以替换的行源列表，以及要替换它们的行源</p>
                                             <p>- 如果在format参数中指定了轮廓显示，则会显示动态子计划中每个选项的提示</p>
                                          </li>
                                       </ul>
                                       <p>为了更好地控制显示输出，可以将以下关键字添加到上述三种标准格式选项中，以自定义其默认行为。每个关键字表示计划表列的逻辑组（例如<code class="codeph">PARTITION</code> ）或基本计划表输出的逻辑添加（例如<code class="codeph">PREDICATE</code> ）。格式关键字必须用逗号或空格分隔：</p>
                                       <ul style="list-style-type:disc">
                                          <li>
                                             <p><code class="codeph">ROWS</code> - 如果相关，则显示优化程序估计的行数</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">BYTES</code> - 如果相关，则显示优化程序估计的字节数</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">COST</code> - 如果相关，则显示优化程序成本信息</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">PARTITION</code> - 如果相关，则显示分区修剪信息</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">PARALLEL</code> - 如果相关，显示PX信息（分发方法和表队列信息）</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">PREDICATE</code> -如果相关，显示了谓语部分</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">PROJECTION</code> -如果相关，显示了突起部</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">ALIAS</code> - 如果相关，则显示“查询块名称/对象别名”部分</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">REMOTE</code> - 如果相关，显示分布式查询的信息（例如，远程串行分发和远程SQL）</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">NOTE</code> - 如果相关，则显示解释计划的注释部分</p>
                                          </li>
                                       </ul>
                                       <p>格式关键字可以使用符号“ <code class="codeph">-</code> ”作为前缀，以排除指定的信息。例如，' - <code class="codeph">-PROJECTION</code> '不包括投影信息。
                                       </p>
                                       <p>如果目标计划表（请参阅<code class="codeph">table_name</code>参数）还存储计划统计信息列（例如，它是用于捕获固定视图<code class="codeph">V$SQL_PLAN_STATISTICS_ALL</code>的内容的表），则可以使用其他格式关键字来指定要对哪个统计信息类别使用<a href="DBMS_XPLAN.html#GUID-2E479BE4-FEEA-400E-A218-DC779A2181CF" title="This table function displays the contents of the plan table.">DISPLAY功能</a>时<a href="DBMS_XPLAN.html#GUID-2E479BE4-FEEA-400E-A218-DC779A2181CF" title="此表函数显示计划表的内容。">显示</a> 。这些额外的格式关键字是<code class="codeph">IOSTATS</code> ， <code class="codeph">MEMSTATS</code> ， <code class="codeph">ALLSTATS</code>和<code class="codeph">LAST</code> （有关这四个关键字的完整说明，请参阅<a href="DBMS_XPLAN.html#GUID-0EE333AF-E9AC-40A4-87D5-F6CF59D6C47B" title="此表函数显示加载到游标缓存中的任何游标的说明计划。除了解释计划，各种计划统计（如。可以报告I / O，内存和计时（基于V $ SQL_PLAN_STATISTICS_ALL VIEWS）。">DISPLAY_CURSOR函数</a>或<a href="DBMS_XPLAN.html#GUID-F935EACB-5FBB-4544-91DE-072C7CDA983C" title="此表函数显示存储在SQL调优集中的给定语句的执行计划。">DISPLAY_SQLSET函数</a> ）。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="25%" id="d1282853e3379" headers="d1282853e3116 ">
                                       <p><code class="codeph">类型</code></p>
                                    </td>
                                    <td align="left" valign="top" width="75%" headers="d1282853e3379 d1282853e3119 ">
                                       <p>输出类型， <code class="codeph">'TEXT'</code> ， <code class="codeph">'ACTIVE'</code> ， <code class="codeph">'HTML'</code>或<code class="codeph">'XML'</code> （请参阅有关ACTIVE类型的使用说明）。“</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-FDE553FD-2099-47B6-A1F8-83BFFDCF5662__GUID-0C3A8EC9-7951-456C-BCB7-9ED415161C47">返回值</p>
                        <p>以<code class="codeph">CLOB</code>返回请求的报告</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-FDE553FD-2099-47B6-A1F8-83BFFDCF5662__GUID-6792F609-04F2-4C7C-8057-ADEF1CE3CD3B">使用说明</p>
                        <p>活动报告具有丰富的交互式用户界面，类似于企业管理器中的界面，而不需要任何EM安装。构建的报告文件是HTML格式，因此大多数现代浏览器都可以解释它。首次查看报告时，Web浏览器会透明地下载为活动报告供电的代码，因此查看它需要外部连接。</p>
                        <div class="infoboxnotewarn" id="GUID-FDE553FD-2099-47B6-A1F8-83BFFDCF5662__GUID-999A2182-AF78-4C4B-8199-1C2375CD47C9">
                           <p class="notep1">警告：</p>
                           <p>应用程序开发人员只有在仔细考虑之后才应将<code class="codeph">filter_preds</code>参数公开给最终用户，因为这可能会将应用程序暴露给SQL注入。实际上， <code class="codeph">filter_preds</code>可以引用任何表或执行调用表函数的数据库用户具有特权的任何服务器函数。
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ARPLS70138"></a><a id="ARPLS70139"></a><a id="ARPLS70140"></a><a id="ARPLS70141"></a><a id="ARPLS70139"></a><a id="ARPLS70140"></a><a id="ARPLS70141"></a><a id="ARPLS70138"></a><div class="props_rev_3"><a id="GUID-98BB5243-873B-4C7F-B8EC-569C6248339D" name="GUID-98BB5243-873B-4C7F-B8EC-569C6248339D"></a><h4 id="ARPLS-GUID-98BB5243-873B-4C7F-B8EC-569C6248339D" class="sect4"><span class="enumeration_section">206.5.7</span> DISPLAY_SQL_PLAN_BASELINE函数</h4>
                  <div>
                     <p><span>此表函数显示SQL计划基准的指定SQL句柄的一个或多个执行计划。</span></p>
                     <div class="section">
                        <p class="subhead3" id="GUID-98BB5243-873B-4C7F-B8EC-569C6248339D__GUID-AEB30669-EDBB-4ED9-960C-47D2D23D3436">句法</p><pre class="pre codeblock"><code>DBMS_XPLAN.DISPLAY_SQL_PLAN_BASELINE（sql_handle IN VARCHAR2：= NULL，plan_name IN VARCHAR2：= NULL，格式IN VARCHAR2：='TYPICAL'）RETURN dbms_xplan_type_table;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-98BB5243-873B-4C7F-B8EC-569C6248339D__GUID-A1CF0185-EF47-4E9D-84D0-2B791927E464">参数</p>
                        <div class="tblformal" id="GUID-98BB5243-873B-4C7F-B8EC-569C6248339D__GUID-C02A0756-076A-4523-B2CE-6AFFBF825574">
                           <p class="titleintable">表206-9 DISPLAY_SQL_PLAN_BASELINE函数参数</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="DISPLAY_SQL_PLAN_BASELINE函数参数" width="100%" border="1" summary="This table describes the Parameters of DBMS_XPLAN.DISPLAY_SQL_PLAN_BASELINE subprogram." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="25%" id="d1282853e3534">参数</th>
                                    <th align="left" valign="bottom" width="75%" id="d1282853e3537">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="25%" id="d1282853e3542" headers="d1282853e3534 ">
                                       <p><code class="codeph">的sql_handle</code></p>
                                    </td>
                                    <td align="left" valign="top" width="75%" headers="d1282853e3542 d1282853e3537 ">
                                       <p>SQL语句句柄。它标识要显示其计划的SQL语句。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="25%" id="d1282853e3550" headers="d1282853e3534 ">
                                       <p><code class="codeph">PLAN_NAME</code></p>
                                    </td>
                                    <td align="left" valign="top" width="75%" headers="d1282853e3550 d1282853e3537 ">
                                       <p>计划名称。它确定了一个具体的计划。默认值NULL表示解释并显示与标识的SQL语句关联的所有计划。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="25%" id="d1282853e3558" headers="d1282853e3534 ">
                                       <p><code class="codeph">格式</code></p>
                                    </td>
                                    <td align="left" valign="top" width="75%" headers="d1282853e3558 d1282853e3537 ">
                                       <p>格式字符串确定显示的计划中存储的信息。可以使用以下格式值，每个值代表一个常见用例： <code class="codeph">BASIC</code> ， <code class="codeph">TYPICAL</code>和<code class="codeph">ALL</code> 。</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-98BB5243-873B-4C7F-B8EC-569C6248339D__GUID-122E495C-1C3A-4B0D-90CA-C88E9504C8E3">返回值</p>
                        <p>PL / SQL类型表</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-98BB5243-873B-4C7F-B8EC-569C6248339D__GUID-5930B710-01AF-4066-ABBF-731B3F2A4560">使用说明</p>
                        <p>此功能使用存储在计划基准中的计划信息来解释和显示计划。所述<code class="codeph">plan_id</code>存储在SQL管理基础可能不匹配<code class="codeph">plan_id</code>生成的计划。存储的<code class="codeph">plan_id</code>与生成的<code class="codeph">plan_id</code>之间的不匹配意味着它是不可重现的计划。这样的计划被认为是无效的，并且在SQL编译期间被优化器绕过。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-98BB5243-873B-4C7F-B8EC-569C6248339D__GUID-2185AD8C-45B5-4C05-8004-BD75797323C1">例子</p>
                        <p>使用<code class="codeph">TYPICAL</code>格式显示由SQL句柄<code class="codeph">SYS_SQL_b1d49f6074ab95af</code>标识的SQL语句的所有计划</p><pre class="pre codeblock"><code>SET LINESIZE 150 SET PAGESIZE 2000 SELECT t。* FROM TABLE（DBMS_XPLAN.DISPLAY_SQL_PLAN_BASELINE（'SYS_SQL_b1d49f6074ab95af'））t;</code></pre><p>使用<code class="codeph">BASIC</code>格式显示包含字符串<code class="codeph">HR2</code>的一个或多个SQL语句的所有计划：</p><pre class="pre codeblock"><code>SET LINESIZE 150 SET PAGESIZE 2000 SELECT t。* FROM（SELECT DISTINCT sql_handle FROM dba_sql_plan_baselines WHERE sql_text LIKE'％HR2％'）pb，TABLE（DBMS_XPLAN.DISPLAY_SQL_PLAN_BASELINE（pb.sql_handle，NULL，'BASIC'））t;</code></pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ARPLS70142"></a><a id="ARPLS70143"></a><a id="ARPLS70143"></a><a id="ARPLS70142"></a><div class="props_rev_3"><a id="GUID-F935EACB-5FBB-4544-91DE-072C7CDA983C" name="GUID-F935EACB-5FBB-4544-91DE-072C7CDA983C"></a><h4 id="ARPLS-GUID-F935EACB-5FBB-4544-91DE-072C7CDA983C" class="sect4"><span class="enumeration_section">206.5.8</span> DISPLAY_SQLSET函数</h4>
                  <div>
                     <p><span>此表函数显示存储在SQL调优集中的给定语句的执行计划。</span></p>
                     <div class="section">
                        <p class="subhead3" id="GUID-F935EACB-5FBB-4544-91DE-072C7CDA983C__GUID-D56C10EC-BCDC-4563-8B81-23D857C16E33">句法</p><pre class="pre codeblock"><code>DBMS_XPLAN.DISPLAY_SQLSET（sqlset_name IN VARCHAR2，sql_id IN VARCHAR2，plan_hash_value IN NUMBER：= NULL，格式IN VARCHAR2：='TYPICAL'，sqlset_owner IN VARCHAR2：= NULL）RETURN DBMS_XPLAN_TYPE_TABLE PIPELINED;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-F935EACB-5FBB-4544-91DE-072C7CDA983C__GUID-33969DF3-C9ED-4F7F-ADD9-EB21E49A9A4B">参数</p>
                        <div class="tblformal" id="GUID-F935EACB-5FBB-4544-91DE-072C7CDA983C__GUID-3384EACA-57C2-422F-8571-DFE1A371932A">
                           <p class="titleintable">表206-10 DISPLAY_SQLSET函数参数</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="DISPLAY_SQLSET函数参数" width="100%" border="1" summary="This table describes the Parameters of DBMS_XPLAN.DISPLAY_SQLSET subprogram." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="25%" id="d1282853e3731">参数</th>
                                    <th align="left" valign="bottom" width="75%" id="d1282853e3734">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="25%" id="d1282853e3739" headers="d1282853e3731 ">
                                       <p><code class="codeph">sqlset_name</code></p>
                                    </td>
                                    <td align="left" valign="top" width="75%" headers="d1282853e3739 d1282853e3734 ">
                                       <p>SQL调优集的名称</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="25%" id="d1282853e3747" headers="d1282853e3731 ">
                                       <p><code class="codeph">SQL_ID</code></p>
                                    </td>
                                    <td align="left" valign="top" width="75%" headers="d1282853e3747 d1282853e3734 ">
                                       <p>指定其计划存储在SQL调优集中的SQL语句的sql_id值。您可以通过查询表函数<code class="codeph">DBMS_SQLTUNE.SELECT_SQLSET</code>来查找所有存储的SQL语句</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="25%" id="d1282853e3757" headers="d1282853e3731 ">
                                       <p><code class="codeph">plan_hash_value</code></p>
                                    </td>
                                    <td align="left" valign="top" width="75%" headers="d1282853e3757 d1282853e3734 ">
                                       <p>可选参数。标识SQL语句的特定存储执行计划。如果禁止，则显示所有存储的执行计划。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="25%" id="d1282853e3765" headers="d1282853e3731 ">
                                       <p><code class="codeph">格式</code></p>
                                    </td>
                                    <td align="left" valign="top" width="75%" headers="d1282853e3765 d1282853e3734 ">
                                       <p>控制计划的详细程度。它接受四个值：</p>
                                       <ul style="list-style-type:disc">
                                          <li>
                                             <p><code class="codeph">BASIC</code> ：显示计划中的最小信息 - 操作ID，操作名称及其选项。
                                             </p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">TYPICAL</code> ：这是默认值。显示计划中最相关的信息（操作ID，名称和选项，＃rows，＃byte和优化程序成本）。仅在适用时显示修剪，并行和谓词信息。仅排除<code class="codeph">PROJECTION</code> ， <code class="codeph">ALIAS</code>和<code class="codeph">REMOTE</code> <code class="codeph">SQL</code>信息（见下文）。
                                             </p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">SERIAL</code> ：与<code class="codeph">TYPICAL</code>类似，但不显示并行信息，即使计划并行执行也是如此。
                                             </p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">ALL</code> ：最高用户级别。包括显示<code class="codeph">TYPICAL</code>级别的信息以及附加信息（如果操作是分发的，则<code class="codeph">PROJECTION</code> ， <code class="codeph">ALIAS</code>和有关<code class="codeph">REMOTE</code> <code class="codeph">SQL</code>信息）。
                                             </p>
                                          </li>
                                       </ul>
                                       <p>为了更好地控制显示输出，可以将以下关键字添加到上述三种标准格式选项中，以自定义其默认行为。每个关键字表示计划表列的逻辑组（例如<code class="codeph">PARTITION</code> ）或基本计划表输出的逻辑添加（例如<code class="codeph">PREDICATE</code> ）。格式关键字必须用逗号或空格分隔：</p>
                                       <ul style="list-style-type:disc">
                                          <li>
                                             <p><code class="codeph">ROWS</code> - 如果相关，则显示优化程序估计的行数</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">BYTES</code> - 如果相关，则显示优化程序估计的字节数</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">COST</code> - 如果相关，则显示优化程序成本信息</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">PARTITION</code> - 如果相关，则显示分区修剪信息</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">PARALLEL</code> - 如果相关，显示PX信息（分发方法和表队列信息）</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">PREDICATE</code> -如果相关，显示了谓语部分</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">PROJECTION</code> -如果相关，显示了突起部</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">ALIAS</code> - 如果相关，则显示“查询块名称/对象别名”部分</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">REMOTE</code> - 如果相关，显示分布式查询的信息（例如，远程串行分发和远程SQL）</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">NOTE</code> - 如果相关，则显示解释计划的注释部分</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">IOSTATS</code> - 假设在执行SQL语句时（通过使用<code class="codeph">gather_plan_statistics</code>提示或通过将参数<code class="codeph">STATISTICS_LEVEL</code>设置为<code class="codeph">ALL</code> ）收集基本计划统计信息，此格式显示<code class="codeph">ALL</code> IO统计信息（或仅用于<code class="codeph">LAST</code> ，如下所示）执行光标。
                                             </p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">MEMSTATS</code> - 假设启用了PGA内存管理（即<code class="codeph">pga_aggregate_target</code>参数设置为非0值），此格式允许显示内存管理统计信息（例如，运算符的执行模式，使用的内存量，数量字节溢出到磁盘，等等）。这些统计信息仅适用于内存密集型操作，如散列连接，排序或某些位图操作符。
                                             </p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">ALLSTATS</code> - <code class="codeph">'IOSTATS MEMSTATS'</code>捷径</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">LAST</code> - 默认情况下，会显示光标所有执行的计划统计信息。可以指定关键字<code class="codeph">LAST</code>以仅查看上次执行的统计信息。
                                             </p>
                                          </li>
                                       </ul>
                                       <p>不推荐使用以下两种格式，但支持向后兼容：</p>
                                       <ul style="list-style-type:disc">
                                          <li>
                                             <p><code class="codeph">RUNSTATS_TOT</code> - 与<code class="codeph">IOSTATS,</code>相同<code class="codeph">IOSTATS,</code>即显示指定游标的所有执行的IO统计信息。
                                             </p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">RUNSTATS_LAST</code> - 与<code class="codeph">IOSTATS</code> <code class="codeph">LAST</code>相同，即显示上次执行游标的运行时统计信息</p>
                                          </li>
                                       </ul>
                                       <p>格式关键字可以使用符号“ <code class="codeph">-</code> ”作为前缀，以排除指定的信息。例如，' - <code class="codeph">-PROJECTION</code> '不包括投影信息。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="25%" id="d1282853e3957" headers="d1282853e3731 ">
                                       <p><code class="codeph">sqlset_owner</code></p>
                                    </td>
                                    <td align="left" valign="top" width="75%" headers="d1282853e3957 d1282853e3734 ">
                                       <p>SQL调优集的所有者。默认值是当前用户。</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-F935EACB-5FBB-4544-91DE-072C7CDA983C__GUID-4C93F93B-FF9E-485F-9D33-8F07EEF4097E">使用说明</p>
                        <p>您可以通过以下方式使用<code class="codeph">format</code>参数的变体：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>使用' <code class="codeph">ALL -PROJECTION -NOTE</code> '显示除投影和注释部分以外的所有内容。
                              </p>
                           </li>
                           <li>
                              <p>使用“ <code class="codeph">TYPICAL PROJECTION</code> ”使用带有附加投影部分的典型格式进行显示（通常在典型格式下排除）。由于典型值是默认值，因此使用简单的“ <code class="codeph">PROJECTION</code> ”是等效的。
                              </p>
                           </li>
                           <li>
                              <p>使用' <code class="codeph">-BYTES -COST -PREDICATE</code> '以使用典型格式显示，但不包括优化程序成本和字节估计以及谓词部分。
                              </p>
                           </li>
                           <li>
                              <p>使用“ <code class="codeph">BASIC ROWS</code> ”显示基本信息，其中包含优化程序估计的额外行数。
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-F935EACB-5FBB-4544-91DE-072C7CDA983C__GUID-03F0F497-E1B9-45FE-9552-8AE8938A3CD9">例子</p>
                        <p>要在SQL调整集中显示与SQL ID“ <code class="codeph">gwp663cqh5qbf</code> ”和<code class="codeph">PLAN</code> <code class="codeph">HASH</code> <code class="codeph">3693697075</code>关联的SQL语句的执行计划，名为“ <code class="codeph">OLTP_optimization_0405</code> ”：</p><pre class="pre codeblock"><code>SELECT * FROM table（DBMS_XPLAN.DISPLAY_SQLSET（'OLTP_optimization_0405'，'gwp663cqh5qbf'，3693697075））;</code></pre><p>要显示存储在SQL调优集中的SQL ID“ <code class="codeph">atfwcg8anrykp</code> ”的所有执行计划：</p><pre class="pre codeblock"><code>SELECT * FROM table（DBMS_XPLAN.DISPLAY_SQLSET（'OLTP_optimization_0405'，'gwp663cqh5qbf'））;</code></pre><p>要显示前面语句中包含的SQL语句的运行时统计信息：</p><pre class="pre codeblock"><code>SELECT * FROM table（DBMS_XPLAN.DISPLAY_SQLSET（'OLTP_optimization_0405'，'gwp663cqh5qbf'，NULL，'ALLSTATS LAST'）;</code></pre></div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-D416125C-FED5-4704-A371-B5EECFCE1429" name="GUID-D416125C-FED5-4704-A371-B5EECFCE1429"></a><h4 id="ARPLS-GUID-D416125C-FED5-4704-A371-B5EECFCE1429" class="sect4"><span class="enumeration_section">206.5.9</span> DISPLAY_WORKLOAD_REPOSITORY功能</h4>
                  <div>
                     <p><span>该表函数显示存储在AWR中的执行计划的内容。</span></p>
                     <div class="section">
                        <div class="infoboxnote" id="GUID-D416125C-FED5-4704-A371-B5EECFCE1429__GUID-8AACAC5D-5301-4B9C-B9B0-446489160EEB">
                           <p class="notep1">注意：</p>
                           <p>此函数替换了不推荐使用的<code class="codeph">DISPLAY_AWR</code> 。
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-D416125C-FED5-4704-A371-B5EECFCE1429__GUID-B48DC183-3CEF-45B6-90F9-C485E8B2FA70">句法</p><pre class="pre codeblock"><code>DBMS_XPLAN.DISPLAY_WORKLOAD_REPOSITORY（sql_id IN VARCHAR2，plan_hash_value IN NUMBER DEFAULT NULL，格式IN VARCHAR2 DEFAULT'TYPICAL'dbid IN NUMBER DEFAULT NULL，con_dbid IN NUMBER DEFAULT NULL，awr_location IN VARCHAR2 DEFAULT'AWR_ROOT'）;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-D416125C-FED5-4704-A371-B5EECFCE1429__GUID-BE706068-4ABC-4224-B9AD-336FF15EBEF5">参数</p>
                        <div class="tblformal" id="GUID-D416125C-FED5-4704-A371-B5EECFCE1429__DISPLAY_AWRTABLEFUNCTIONPARAMETERS-D975C393">
                           <p class="titleintable">表206-11 DISPLAY_WORKLOAD_REPOSITORY表函数参数</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="DISPLAY_WORKLOAD_REPOSITORY表函数参数" width="100%" border="1" summary="This table describes the Parameters of DBMS_XPLAN.DISPLAY_WORKLOAD_REPOSITORY subprogram." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="25%" id="d1282853e4145">参数</th>
                                    <th align="left" valign="bottom" width="75%" id="d1282853e4148">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="25%" id="d1282853e4153" headers="d1282853e4145 ">
                                       <p><code class="codeph">SQL_ID</code></p>
                                    </td>
                                    <td align="left" valign="top" width="75%" headers="d1282853e4153 d1282853e4148 ">
                                       <p>指定SQL语句的<code class="codeph">SQL_ID</code> 。
                                       </p>
                                       <p>您可以通过查询<code class="codeph">DBA_HIST_SQLTEXT</code> <code class="codeph">SQL_ID</code>列来检索感兴趣的SQL语句的相应值。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="25%" id="d1282853e4172" headers="d1282853e4145 ">
                                       <p><code class="codeph">plan_hash_value</code></p>
                                    </td>
                                    <td align="left" valign="top" width="75%" headers="d1282853e4172 d1282853e4148 ">
                                       <p>指定SQL语句的<code class="codeph">PLAN_HASH_VALUE</code> 。
                                       </p>
                                       <p>此参数是可选的。如果省略，则表函数返回给定<code class="codeph">SQL_ID</code>所有存储执行计划。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="25%" id="d1282853e4188" headers="d1282853e4145 ">
                                       <p><code class="codeph">格式</code></p>
                                    </td>
                                    <td align="left" valign="top" width="75%" headers="d1282853e4188 d1282853e4148 ">
                                       <p>控制计划的详细程度。它接受四个值：</p>
                                       <ul style="list-style-type:disc">
                                          <li>
                                             <p><code class="codeph">BASIC</code> ：显示计划中的最小信息 - 操作ID，操作名称及其选项。
                                             </p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">TYPICAL</code> ：这是默认值。显示计划中最相关的信息（操作ID，名称和选项，＃rows，＃byte和优化程序成本）。仅在适用时显示修剪，并行和谓词信息。仅排除<code class="codeph">PROJECTION</code> ， <code class="codeph">ALIAS</code>和<code class="codeph">REMOTE</code> <code class="codeph">SQL</code>信息（见下文）。
                                             </p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">SERIAL</code> ：与<code class="codeph">TYPICAL</code>类似，但不显示并行信息，即使计划并行执行也是如此。
                                             </p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">ALL</code> ：最高用户级别。包括显示<code class="codeph">TYPICAL</code>级别的信息以及附加信息（如果操作是分发的，则<code class="codeph">PROJECTION</code> ， <code class="codeph">ALIAS</code>和有关<code class="codeph">REMOTE</code> <code class="codeph">SQL</code>信息）。
                                             </p>
                                          </li>
                                       </ul>
                                       <p>为了更好地控制显示输出，可以将以下关键字添加到上述四种标准格式选项中，以自定义其默认行为。每个关键字表示计划表列的逻辑组（例如<code class="codeph">PARTITION</code> ）或基本计划表输出的逻辑添加（例如<code class="codeph">PREDICATE</code> ）。格式关键字必须用逗号或空格分隔：</p>
                                       <ul style="list-style-type:disc">
                                          <li>
                                             <p><code class="codeph">ROWS</code> - 如果相关，则显示优化程序估计的行数</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">BYTES</code> - 如果相关，则显示优化程序估计的字节数</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">COST</code> - 如果相关，则显示优化程序成本信息</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">PARTITION</code> - 如果相关，则显示分区修剪信息</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">PARALLEL</code> - 如果相关，显示PX信息（分发方法和表队列信息）</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">PREDICATE</code> -如果相关，显示了谓语部分</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">PROJECTION</code> -如果相关，显示了突起部</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">ALIAS</code> - 如果相关，则显示“查询块名称/对象别名”部分</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">REMOTE</code> - 如果相关，显示分布式查询的信息（例如，远程串行分发和远程SQL）</p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">NOTE</code> - 如果相关，则显示解释计划的注释部分</p>
                                          </li>
                                       </ul>
                                       <p>格式关键字可以使用符号“ <code class="codeph">-</code> ”作为前缀，以排除指定的信息。例如，' - <code class="codeph">-PROJECTION</code> '不包括投影信息。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="25%" id="d1282853e4314" headers="d1282853e4145 ">
                                       <p><code class="codeph">DBID</code></p>
                                    </td>
                                    <td align="left" valign="top" width="75%" headers="d1282853e4314 d1282853e4148 ">
                                       <p>标识特定数据库的计划。</p>
                                       <p>如果省略此参数，则该值默认为初始化参数<code class="codeph">AWR_LOCATION</code>指向的AWR存储库的DBID。在CDB中，如果<code class="codeph">AWR_LOCATION</code>设置为<code class="codeph">AWR_ROOT</code> ，则该值将设置为CDB根的DBID。如果将其设置为<code class="codeph">AWR_PDB</code> ，则将该值设置为容器的DBID。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="25%" id="d1282853e4336" headers="d1282853e4145 ">
                                       <p><code class="codeph">con_dbid</code></p>
                                    </td>
                                    <td align="left" valign="top" width="75%" headers="d1282853e4336 d1282853e4148 ">
                                       <p>标识特定容器的计划。</p>
                                       <p>如果省略此参数，则该值默认为<code class="codeph">SYS_CONTEXT('userenv', 'con_id')</code> 。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="25%" id="d1282853e4349" headers="d1282853e4145 ">
                                       <p><code class="codeph">awr_location</code></p>
                                    </td>
                                    <td align="left" valign="top" width="75%" headers="d1282853e4349 d1282853e4148 ">
                                       <p>指定AWR存储库的位置。支持的值是：</p>
                                       <ul style="list-style-type:disc">
                                          <li>
                                             <p>当要访问的AWR位于根容器中时<code class="codeph">AWR_ROOT</code> 。这是默认值。
                                             </p>
                                          </li>
                                          <li>
                                             <p>'AWR_PDB'，如果要访问的AWR在本地容器中。</p>
                                          </li>
                                       </ul>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-D416125C-FED5-4704-A371-B5EECFCE1429__GUID-C96F18D0-C20B-4884-8329-0CAC5187A4D6">
                        <p class="titleinexample">例206-2查询AWR计划</p>
                        <p>假设您以管理员身份登录并发出以下查询：</p><pre class="pre codeblock"><code>从sh.sAleS中选择count（*）</code></pre><p>您可以按如下方式创建AWR快照：</p><pre class="pre codeblock"><code>EXEC DBMS_WORKLOAD_REPOSITORY.CREATE_SNAPSHOT;</code></pre><p>您将<code class="codeph">DBA_HIST_SQLTEST</code>查询到函数输出，如下所示：</p><pre class="pre codeblock"><code>SET LINESIZE 150 SET PAGESIZE 5000 SELECT t。* FROM DBA_HIST_SQLTEXT ht，TABLE（DBMS_XPLAN.DISPLAY_WORKLOAD_REPOSITORY（ht.sql_id，null，' -  PREDICATE + ALIAS'，null，null，'AWR_ROOT'））t WHERE ht。SQL_TEXT LIKE'％sAleS％'; SQL_ID 2f4cx9qjnqd70 --------------------从sh.sAleS中选择count（*）计划哈希值：1123225294 -------------- -------------------------------------------------- ------------------------------------------ | Id |操作|名称|行|成本（％CPU）|时间| Pstart时| Pstop | -------------------------------------------------- -------------------------------------------------- ------ | 0 |选择声明| | | 27（100）| | | | | 1 | SORT AGGREGATE | | 1 | | | | | | 2 | PARTITION RANGE ALL | | 918K | 27（0）| 00:00:01 | 1 | 28 | | 3 | BITMAP CONVERSION COUNT | | 918K | 27（0）| 00:00:01 | | | | 4 | BITMAP INDEX FAST FULL SCAN | SALES_PROMO_BIX | | | | 1 | 28 | -------------------------------------------------- -------------------------------------------------- ------查询块名称/对象别名（由操作ID标识）：------------------------------- ------------------------------ 1  -  SEL $ 1 3  -  SEL $ 1 /“SALES”@“SEL $ 1”</code></pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>