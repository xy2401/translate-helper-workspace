<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>开发客户端应用程序（仅限TCP / IP）</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="User&#39;s Guide "></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="User&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="database-gateway-appc-users-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-04-16T18:35:49-07:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2002, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="F18239-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="pg4tcpmap-commands-tcpip.html" title="Previous" type="text/html"></link>
      <link rel="next" href="troubleshooting-oracle-database-gateway-appc.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database Gateway for APPC User&#39;s Guide"></meta>
    <meta name="dcterms.isVersionOf" content="APPUG"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="pg4tcpmap-commands-tcpip.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="troubleshooting-oracle-database-gateway-appc.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">用户指导</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">开发客户端应用程序（仅限TCP / IP）</li>
            </ol>
            <a id="GUID-705991C2-2CC2-4FAB-A04C-D63485B571FC" name="GUID-705991C2-2CC2-4FAB-A04C-D63485B571FC"></a><a id="APPUG700"></a>
            
            <h2 id="APPUG-GUID-705991C2-2CC2-4FAB-A04C-D63485B571FC" class="sect2"><span class="enumeration_chapter">7</span>开发客户端应用程序（仅限TCP / IP）</h2>
         </header>
         <div class="ind">
            <div>
               <p>该<a id="d24694e30" class="indexterm-anchor"></a><a id="d24694e34" class="indexterm-anchor"></a><a id="d24694e40" class="indexterm-anchor"></a>以下主题讨论如果您的网关使用TCP / IP支持IMS Connect，您将如何调用TIP并控制远程主机事务。它还为您提供了准备和执行网关事务的步骤。
               </p>
               <p>做出以下假设：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p>已经编写了远程主机事务（RHT）</p>
                  </li>
                  <li>
                     <p>已经使用<a href="creating-tip-oracle-database-gateway-appc.html#GUID-78D4439E-7DD6-45DF-842E-35007FCC572B">创建提示中</a>描述的步骤定义了与RHT对应<a href="creating-tip-oracle-database-gateway-appc.html#GUID-78D4439E-7DD6-45DF-842E-35007FCC572B">的提示</a> 。</p>
                  </li>
                  <li>
                     <p>该<a id="d24694e61" class="indexterm-anchor"></a> <code class="codeph">PGA_TCP_IMSC</code>映射表已经填充，使用了<a id="d24694e66" class="indexterm-anchor"></a> <code class="codeph">pg4tcpmap</code>工具，带有<code class="codeph">SIDE PROFILE</code>名称，TCP / IP主机名，端口号和其他IMS Connect参数。
                     </p>
                  </li>
               </ul>
               <p>话题：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="developing-appc-client-app-tcpip-only.html#GUID-C07370C7-9C1B-4003-B3DB-7F041654DCE2">客户端应用程序概述</a></p>
                  </li>
                  <li>
                     <p><a href="developing-appc-client-app-tcpip-only.html#GUID-B7E7C6BD-2087-4F6F-BD63-B172D8853746">准备客户端应用程序</a></p>
                  </li>
                  <li>
                     <p><a href="developing-appc-client-app-tcpip-only.html#GUID-07B57C7F-EB46-4D42-97BF-38F2A5A2EB19">确保TIP和远程交易程序通信</a></p>
                  </li>
                  <li>
                     <p><a href="developing-appc-client-app-tcpip-only.html#GUID-BCFCDB41-E65A-4333-AAAF-CB5FCEB4762A">从客户端应用程序调用TIP</a></p>
                  </li>
                  <li>
                     <p><a href="developing-appc-client-app-tcpip-only.html#GUID-F450316B-272E-4EC2-9574-7F39B34C3B04">交换数据</a></p>
                  </li>
                  <li>
                     <p><a href="developing-appc-client-app-tcpip-only.html#GUID-8EC590FC-73C4-4B31-8662-ED43392EF9CE">致电PG4TCPMAP</a></p>
                  </li>
                  <li>
                     <p><a href="developing-appc-client-app-tcpip-only.html#GUID-14AA4D11-BDB6-4934-BDE5-371D9B3D61E6">执行申请</a></p>
                  </li>
                  <li>
                     <p><a href="developing-appc-client-app-tcpip-only.html#GUID-FDB3D1E8-0510-49D3-AB83-2BD508801865">支持多字节字符集的应用程序开发</a></p>
                  </li>
                  <li>
                     <p><a href="developing-appc-client-app-tcpip-only.html#GUID-322345C3-6367-4ADD-A56A-B9B4A13C83FE">使用TIP所需的权限</a></p>
                  </li>
               </ul>
            </div><a id="APPUG1314"></a><a id="APPUG1025"></a><div class="props_rev_3"><a id="GUID-C07370C7-9C1B-4003-B3DB-7F041654DCE2" name="GUID-C07370C7-9C1B-4003-B3DB-7F041654DCE2"></a><h3 id="APPUG-GUID-C07370C7-9C1B-4003-B3DB-7F041654DCE2" class="sect3">客户端应用程序概述</h3>
               <div>
                  <p>程序网关管理实用程序（ <a id="d24694e171" class="indexterm-anchor"></a> PGAU）使用您提供的定义生成完整的TIP。然后，客户端应用程序可以调用TIP来访问远程主机事务。 <a href="pga-utility-oracle-database-gateway-appc.html#GUID-F73E20E7-D94C-468F-BA65-CC34F6373F19"> 程序网关管理实用程序</a> ，详细讨论了PGAU的使用。
                  </p>
                  <p>此概述说明了为调用TIP和控制远程主机事务必须执行的操作。</p>
                  <p>网关从接收PL / SQL调用<a id="d24694e184" class="indexterm-anchor"></a> Oracle数据库并发出TCP / IP调用以与远程事务程序通信。
                  </p>
                  <p>以下应用程序使这成为可能：</p>
                  <ol>
                     <li>
                        <p>我<a id="d24694e195" class="indexterm-anchor"></a> / O启用PCB的远程主机事务程序。
                        </p>
                     </li>
                     <li>
                        <p>该<a id="d24694e201" class="indexterm-anchor"></a>已使用pg4tcpmap工具填充的<code class="codeph">PGA_TCP_IMSC</code>映射表，其中包含<code class="codeph">SIDE PROFILE</code>名称以及TCP / IP主机名，端口号和其他IMS Connect参数。
                        </p>
                     </li>
                     <li>
                        <p>一个<a id="d24694e212" class="indexterm-anchor"></a>事务接口包（TIP）。TIP是一个P L / SQL包，用于处理客户端和网关之间的通信，并执行COBOL和PL / SQL之间的数据类型转换。</p>
                     </li>
                     <li>
                        <p>PGAU为您生成TIP规范。在发货的样本中，PGAU生成的包称为<code class="codeph">pgtflip.pkb</code> 。生成的TIP包括至少三个映射到远程事务程序的函数调用：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">pgtflip_init</code>初始化与远程事务程序的对话</p>
                           </li>
                           <li>
                              <p><code class="codeph">pgtflip_main</code>与远程事务程序交换应用程序数据</p>
                           </li>
                           <li>
                              <p><code class="codeph">pgtflip_term</code>终止与远程事务程序的对话</p>
                           </li>
                        </ul>
                        <p>如果您正在编写自己的TIP或调试，请参阅<a href="tip-internals-oracle-database-gateway-appc.html#GUID-9F4E3177-13B0-43CE-AD0A-5BCD66B3FD17">Tip Internals</a>以获取有关TIP的更多信息。
                        </p>
                     </li>
                     <li>
                        <p>调用TIP的客户端应用程序。</p>
                        <p>客户端应用程序使用输入和输出参数调用三个TIP函数。在该示例中，客户端应用程序传递输入和远程事务，远程事务将翻转的输入作为输出发回。</p>
                     </li>
                  </ol>
                  <p><a href="developing-appc-client-app-tcpip-only.html#GUID-C07370C7-9C1B-4003-B3DB-7F041654DCE2__G1012955" title="此3列表描述了使用示例IMS Connect-IMS事务演示PL / SQL驱动程序，TIP和网关之间的逻辑流程">表7-1</a>演示了使用示例IMS Connect-IMS事务的PL / SQL驱动程序，TIP和网关之间的逻辑流程。
                  </p>
                  <div class="tblformal" id="GUID-C07370C7-9C1B-4003-B3DB-7F041654DCE2__G1012955">
                     <p class="titleintable">表7-1 IMS Connect-IMS示例的逻辑流程</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="IMS Connect-IMS示例的逻辑流程" width="100%" border="1" summary="This 3 column table describes demonstrates the logic flow between the PL/SQL driver, the TIP, and the gateway using the example IMS Connect-IMS transaction" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="20%" id="d24694e270">客户申请</th>
                              <th align="left" valign="bottom" width="32%" id="d24694e273">Oracle提示</th>
                              <th align="left" valign="bottom" width="48%" id="d24694e276">在网关和远程事务之间建立的程序（大型机IMS）</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d24694e281" headers="d24694e270 ">
                                 <p>调用<code class="codeph">tip_init</code></p>
                              </td>
                              <td align="left" valign="top" width="32%" headers="d24694e281 d24694e273 ">
                                 <p>打电话<code class="codeph">PGAINIT</code></p>
                              </td>
                              <td align="left" valign="top" width="48%" headers="d24694e281 d24694e276 ">
                                 <p>网关发出TCP / IP套接字并连接以启动与IMS Connect的对话。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d24694e295" headers="d24694e270 ">
                                 <p>调用<code class="codeph">tip_main</code></p>
                              </td>
                              <td align="left" valign="top" width="32%" headers="d24694e295 d24694e273 ">
                                 <p>调用<code class="codeph">PGAXFER</code>发送输入并接收输出</p>
                              </td>
                              <td align="left" valign="top" width="48%" headers="d24694e295 d24694e276 ">
                                 <p>网关<code class="codeph">send()</code> TCP Connect发出TCP / IP <code class="codeph">send()</code> 。IMS Connect通过OTMA和XCF与IMS实例进行通信。IMS <code class="codeph">RECEIVE</code>完成。IMS执行应用程序逻辑并将<code class="codeph">SEND</code>回网关。网关发出TCP / IP <code class="codeph">receive()</code> ;收到完成。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d24694e322" headers="d24694e270 ">
                                 <p>调用<code class="codeph">tip_term</code></p>
                              </td>
                              <td align="left" valign="top" width="32%" headers="d24694e322 d24694e273 ">
                                 <p>打电话<code class="codeph">PGATERM</code></p>
                              </td>
                              <td align="left" valign="top" width="48%" headers="d24694e322 d24694e276 ">
                                 <p>网关发出TCP / IP <code class="codeph">close()</code> 。
                                 </p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <p>利用网关与远程主机事务交换数据的客户端应用程序为自己执行一些任务，并指示TIP代表它执行其他任务。因此，客户端应用程序设计者必须知道远程事务的行为以及TIP如何促进交换。</p>
                  <p>以下部分概述了远程主机事务行为，客户端应用程序如何控制此行为以及TIP函数调用和数据声明如何支持客户端应用程序控制远程主机事务。这些部分还提供了有关TIP为客户端应用程序执行的操作以及TIP调用如何与远程主机事务交换数据的背景信息。</p>
               </div>
            </div><a id="APPUG1026"></a><div class="props_rev_3"><a id="GUID-B7E7C6BD-2087-4F6F-BD63-B172D8853746" name="GUID-B7E7C6BD-2087-4F6F-BD63-B172D8853746"></a><h3 id="APPUG-GUID-B7E7C6BD-2087-4F6F-BD63-B172D8853746" class="sect3">准备客户端应用程序</h3>
               <div>
                  <div class="section">
                     <p>要准备客户端应用程序以执行，您必须了解远程主机事务要求，然后执行以下步骤：</p>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>确保已使用pg4tcpmap工具将PGAU实用程序的<code class="codeph">.ctl</code>文件中定义的<code class="codeph">SIDEPROFILE</code>名称映射到TCP / IP和IMS Connect属性。</span><div>
                           <p>有关映射参数的详细信息，请参阅本指南中的<a href="pg4tcpmap-commands-tcpip.html#GUID-CDAD0D0C-6070-4E0E-9B97-E4DCF919510F">PG4TCPMAP命令（仅限TCP / IP）</a> 。
                           </p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>确保已标识要调用的远程主机事务程序工具。</span></li>
                     <li class="stepexpand"><span>移动相关<a id="d24694e404" class="indexterm-anchor"></a> COBOL将布局（副本）记录到网关系统以输入到PGAU。</span></li>
                     <li class="stepexpand"><span>描述远程主机事务数据并调用<a id="d24694e410" class="indexterm-anchor"></a>带有<code class="codeph">DEFINE DATA</code> ， <code class="codeph">DEFINE CALL</code>和<code class="codeph">DEFINE TRANSACTION</code>语句的PG数据字典（PG DD）。</span></li>
                     <li class="stepexpand"><span>使用<code class="codeph">GENERATE</code>在Oracle数据库中生成TIP。</span></li>
                     <li class="stepexpand"><span>创建调用TIP公共函数的客户端应用程序。</span></li>
                     <li class="stepexpand"><span>授予新创建的包的权限。</span></li>
                  </ol>
               </div><a id="APPUG1027"></a><div class="props_rev_3"><a id="GUID-82CDAADD-FF8A-4C45-9B78-69E16820B630" name="GUID-82CDAADD-FF8A-4C45-9B78-69E16820B630"></a><h4 id="APPUG-GUID-82CDAADD-FF8A-4C45-9B78-69E16820B630" class="sect4">提示内容和目的</h4>
                  <div>
                     <p>PGAU生成的TIP的内容反映了远程主机事务可用的调用和已交换的数据。了解此内容有助于设计和调试调用TIP的客户端应用程序。</p>
                     <p>提示是一个<a id="d24694e480" class="indexterm-anchor"></a> PL / SQL包，并据此有<a id="d24694e485" class="indexterm-anchor"></a><a id="d24694e489" class="indexterm-anchor"></a>两节：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>包规范包含：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>公共函数原型和参数</p>
                              </li>
                           </ul>
                        </li>
                        <li>
                           <p>包体包含：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>私有函数和内部控制变量</p>
                              </li>
                              <li>
                                 <p>公共职能</p>
                              </li>
                              <li>
                                 <p>最后一个公共函数后的包初始化</p>
                              </li>
                           </ul>
                        </li>
                     </ul>
                     <p>TIP的目的是为每个允许的远程事务程序交互提供PL / SQL可调用公共函数。一个<a id="d24694e519" class="indexterm-anchor"></a>远程交易程序交互是通过一个或多个逻辑相关的数据交换组<a id="d24694e524" class="indexterm-anchor"></a><a id="d24694e526" class="indexterm-anchor"></a> <code class="codeph">PGAXFER</code> RPC调用。这在概念上类似于屏幕或菜单交互，其中填充了几个字段，按下了回车键，并且向用户返回了几个字段。进一步进行类比：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>用户可能被比作TIP或客户端应用程序</p>
                        </li>
                        <li>
                           <p>要填写的字段是TIP函数调用的<code class="codeph">IN</code>参数</p>
                        </li>
                        <li>
                           <p>返回的字段是TIP函数调用的<code class="codeph">OUT</code>参数</p>
                        </li>
                        <li>
                           <p>屏幕或菜单是<code class="codeph">IN</code>和<code class="codeph">OUT</code>参数组合在一起的</p>
                        </li>
                        <li>
                           <p>按下的回车键被比作<code class="codeph">PGAXFER</code>远程过程调用（RPC）</p>
                        </li>
                     </ul>
                     <p>构成交易调用的实际参数分组由用户定义。网关对远程事务程序如何对应于TIP函数调用的集合没有限制，每个调用具有许多<code class="codeph">IN</code>和<code class="codeph">OUT</code>参数。
                     </p>
                     <p>PGA用户通常每个远程交易程序有一个TIP。如何对TIP函数调用进行分组以及在每次调用时交换哪些数据参数取决于远程事务程序的大小，复杂性和行为。</p>
                     <p>有关PL / SQL包如何工作的讨论，请参阅Oracle的<a href="../lnpls/index.html" target="_blank"><span class="italic">Oracle数据库PL / SQL语言参考</span></a> 。以下讨论涵盖了必须在TIP中执行的逻辑。请参阅Microsoft Windows上<code class="codeph">%ORACLE_HOME%\dg4appc\demo\IMS</code>目录和基于UNIX的系统上的<code class="codeph">$ORACLE_HOME/dg4appc/demo/IMS</code>目录中提供的示例提示和驱动程序，文件<a id="d24694e587" class="indexterm-anchor"></a><a id="d24694e589" class="indexterm-anchor"></a> <code class="codeph">pgtflip.pkh</code> ， <a id="d24694e598" class="indexterm-anchor"></a><a id="d24694e600" class="indexterm-anchor"></a> <code class="codeph">pgtflip.pkb</code> ，和<a id="d24694e607" class="indexterm-anchor"></a> <code class="codeph">pgtflipd.sql</code> 。
                     </p>
                  </div>
               </div><a id="APPUG1028"></a><div class="props_rev_3"><a id="GUID-24D40BAB-F818-4B7E-AE7F-259D0EEC7F08" name="GUID-24D40BAB-F818-4B7E-AE7F-259D0EEC7F08"></a><h4 id="APPUG-GUID-24D40BAB-F818-4B7E-AE7F-259D0EEC7F08" class="sect4">远程主机事务类型</h4>
                  <div>
                     <p>从数据库网关应用程序的角度来看，有三种主要类型的远程主机事务：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>事务套接字</p>
                        </li>
                        <li>
                           <p>持久套接字</p>
                        </li>
                        <li>
                           <p>非持久性套接字</p>
                        </li>
                     </ul>
                     <p>您应该熟悉远程主机事务类型。有关这些事务类型的完整说明，请参阅“IBM <span class="italic">IMS Connect指南和参考</span> ”。
                     </p>
                  </div>
               </div>
            </div><a id="APPUG1029"></a><div class="props_rev_3"><a id="GUID-07B57C7F-EB46-4D42-97BF-38F2A5A2EB19" name="GUID-07B57C7F-EB46-4D42-97BF-38F2A5A2EB19"></a><h3 id="APPUG-GUID-07B57C7F-EB46-4D42-97BF-38F2A5A2EB19" class="sect3">确保TIP和远程交易程序通信</h3>
               <div>
                  <p>远程主机事务程序及其与客户端应用程序的相关TIP必须对应<a id="d24694e715" class="indexterm-anchor"></a>两个关键要求：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>参数数据类型转换，由定义事务DATA的方式产生。有关PGAU生成的TIP如何根据数据定义转换数据的讨论，请参阅<a href="data-type-conversion-oracle-database-gateway-appc.html#GUID-FEB0C201-9C07-4932-A328-B048B582B18A">数据类型转换</a> 。
                        </p>
                     </li>
                     <li>
                        <p>TCP / IP发送/接收同步，这是由定义事务<code class="codeph">CALL</code>的方式产生的。
                        </p>
                     </li>
                  </ul>
                  <p>然后，这些<code class="codeph">DATA</code>和<code class="codeph">CALL</code>定义通过引用包含在<code class="codeph">TRANSACTION</code>定义中。
                  </p>
                  <p>使用<code class="codeph">pg4tcpmap</code>工具确保已将<code class="codeph">SIDEPROFILE</code>名称映射到TCP / IP和IMS Connect属性。
                  </p>
               </div><a id="APPUG1030"></a><div class="props_rev_3"><a id="GUID-85BC1722-2A46-414C-AF4E-9DE99C955CF0" name="GUID-85BC1722-2A46-414C-AF4E-9DE99C955CF0"></a><h4 id="APPUG-GUID-85BC1722-2A46-414C-AF4E-9DE99C955CF0" class="sect4">数据通讯</h4>
                  <div>
                     <p>使用以远程主机事务语言编写的数据定义， <a id="d24694e801" class="indexterm-anchor"></a><a id="d24694e805" class="indexterm-anchor"></a> PGAU <code class="codeph">DEFINE DATA</code>命令存储在<a id="d24694e811" class="indexterm-anchor"></a> PG DD所需的信息<a id="d24694e816" class="indexterm-anchor"></a><a id="d24694e818" class="indexterm-anchor"></a> PGAU <code class="codeph">GENERATE</code>创建TIP函数逻辑来执行：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>从接收远程主机事务提供的PL / SQL <code class="codeph">IN</code>参数的所有数据转换</p>
                        </li>
                        <li>
                           <p>所有缓冲到接收远程主机事务所期望的格式</p>
                        </li>
                        <li>
                           <p>所有数据都不受发送远程主机事务提供的格式的影响</p>
                        </li>
                        <li>
                           <p>所有数据转换为发送远程主机事务提供的PL / SQL <code class="codeph">OUT</code>参数</p>
                        </li>
                     </ul>
                     <p>PGAU根据远程主机事务程序中包含的数据定义确定生成转换和缓冲逻辑所需的信息。PGAU <code class="codeph">DEFINE DATA</code>从文件中读取此信息，例如COBOL副本，或从脚本中插入，并将其保存在PG DD中以供重复使用。网关管理员需要将这些定义文件从远程主机传输到运行PGAU的Oracle主机。
                     </p>
                     <p>根据存储在PG DD中的数据定义，PGAU <code class="codeph">GENERATE</code>确定远程主机数据类型并将其与适当的PL / SQL数据类型相匹配。它还确定记录和缓冲区中的数据长度和偏移量，并在TIP中生成所需的PL / SQL逻辑。有关详细信息，请参阅<span class="q">“</span> <a href="pga-utility-oracle-database-gateway-appc.html#GUID-F73E20E7-D94C-468F-BA65-CC34F6373F19">过程网关管理实用程序</a> <span class="q">”中</span>的PGAU <span class="q">“ <a href="pga-utility-oracle-database-gateway-appc.html#GUID-A39AE344-8E2F-49EE-9791-6BAF4ECF4F6B">DEFINE DATA</a> ”</span>语句和<span class="q">“</span> <a href="admin-utility-samples-oracle-database-gateway-appc.html#GUID-AA9B8762-BDAF-4EED-A8B0-09F8A937F04E">管理实用程序示例</a> <span class="q">”</span>中的<span class="q">“ <a href="admin-utility-samples-oracle-database-gateway-appc.html#GUID-F0ACAA50-16F8-4C5C-83FE-C0D280981772">示例PGAU DEFINE DATA语句</a> ”</span> 。
                     </p>
                     <p>必须首先使用PGAU <code class="codeph">DEFINE DATA</code>定义后续调用作为参数引用的所有数据。可以定义简单数据项，例如单个数字或字符串，以及复杂的多字段数据聚合，例如记录或结构。PGAU自动生成等效的PL / SQL变量和字段或表的记录，供客户端应用程序在其对生成的TIP的调用中引用。</p>
                     <p>如上所述，参数可以是简单的数据项，例如员工编号，也可以是复杂的项目，例如员工记录。PGAU <code class="codeph">DEFINE DATA</code>自动从输入程序数据定义文件中提取所需的数据类型信息。
                     </p>
                     <p>在此示例中， <code class="codeph">FLIPIN</code>和<code class="codeph">FLIPOUT</code>是要交换的参数。
                     </p><pre class="oac_no_warn" dir="ltr">PGTFLIP_MAIN（trannum，FLIPIN，FLIPOUT）</pre><p>因此，必须为每个参数发出PGAU <code class="codeph">DEFINE DATA</code>语句：</p><pre class="oac_no_warn" dir="ltr">DEFINE DATA FLIPIN PLSDNAME（FLIPIN）使用（通过）语言（IBMVSCOBOLII）（01 MSGIN PIC X（20）。）; DEFINE DATA FLIPOUT PLSDNAME（翻转）使用（通过）语言（IBMVSCOBOLII）（01 MSGOUT PIC X（20）。）;</pre><p>请注意， <code class="codeph">trannum</code>参数不需要定义。这是APPC会话标识符，不需要PGAU中的定义。</p>
                  </div>
               </div><a id="APPUG1031"></a><div class="props_rev_3"><a id="GUID-83C35D5F-20A6-4E6D-B25A-ECEC1BFD4ECB" name="GUID-83C35D5F-20A6-4E6D-B25A-ECEC1BFD4ECB"></a><h4 id="APPUG-GUID-83C35D5F-20A6-4E6D-B25A-ECEC1BFD4ECB" class="sect4">CALL通讯</h4>
                  <div>
                     <p>要求同步<a id="d24694e956" class="indexterm-anchor"></a> TCP / IP send（）和receive（）表示当远程事务程序期望输入数据参数时，它会发出TCP / IP receive（）来读取数据参数。因此，TIP必须使网关发出TCP / IP send（）以将数据参数写入远程事务程序。当远程事务程序发出TCP / IP send（）时，TIP还必须使网关发出TCP / IP receive（）。
                     </p>
                     <p>PGAU <code class="codeph">DEFINE CALL</code>语句指定客户端应用程序如何<code class="codeph">DEFINE CALL</code>生成的TIP以及与该调用的远程主机事务交换哪些数据参数。每个PGAU <code class="codeph">DEFINE CALL</code>语句可以指定TIP函数的名称，一个或多个数据参数以及每个数据参数的<code class="codeph">IN/OUT</code>模式。必须先使用PGAU <code class="codeph">DEFINE DATA</code>语句<code class="codeph">DEFINE DATA</code> 。有关详细信息，请参阅<span class="q">“</span> <a href="pga-utility-oracle-database-gateway-appc.html#GUID-F73E20E7-D94C-468F-BA65-CC34F6373F19">过程网关管理实用程序</a> <span class="q">”</span>中的<span class="q">“ <a href="pga-utility-oracle-database-gateway-appc.html#GUID-01EEB1ED-7AB6-4BFA-AF6F-A9D36A44C0B1">DEFINE CALL</a> ”</span>和<span class="q">“</span> <a href="admin-utility-samples-oracle-database-gateway-appc.html#GUID-AA9B8762-BDAF-4EED-A8B0-09F8A937F04E">管理实用程序示例</a> <span class="q">”</span>中的<span class="q">“ <a href="admin-utility-samples-oracle-database-gateway-appc.html#GUID-336981E2-C7F9-47C1-8B18-330187556305">示例PGAU DEFINE CALL语句</a> ”</span> 。
                     </p>
                     <p>PGAU <code class="codeph">DEFINE CALL</code>处理将指定信息存储在PG DD中，供PGAU <code class="codeph">GENERATE</code>稍后使用。然后，PGAU <code class="codeph">GENERATE</code>在TIP包规范中创建以下内容：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>对于在<code class="codeph">CALL</code>指定的每个<code class="codeph">DATA</code>定义使用PL / SQL参数定义的每个<code class="codeph">CALL</code>的公共PL / SQL函数的声明</p>
                        </li>
                        <li>
                           <p>公共PL / SQL数据参数的声明</p>
                        </li>
                     </ul>
                     <p>客户端应用程序使用PGAU <code class="codeph">DEFINE CALL</code>语句中指定的函数名称和参数列表将TIP公共函数作为PL / SQL函数调用进行<code class="codeph">DEFINE CALL</code> 。客户端应用程序还可以通过引用声明与TIP公共数据参数具有相同数据类型的私有变量，以便于在客户端应用程序中传递和处理数据，从而共享由PGAU <code class="codeph">GENERATE</code>创建的声明。</p>
                     <p>在此示例中，必须发出以下PGAU <code class="codeph">DEFINE CALL</code>语句来定义TIP公共函数：</p><pre class="oac_no_warn" dir="ltr">DEFINE CALL FLIPMAIN PKGCALL（pgtflip_main）PARMS（（FLIPIN IN），（FLIPOUT OUT））;</pre></div><a id="APPUG1032"></a><div class="props_rev_3"><a id="GUID-864E03E4-0F1A-478B-A76D-3D9624312D67" name="GUID-864E03E4-0F1A-478B-A76D-3D9624312D67"></a><h5 id="APPUG-GUID-864E03E4-0F1A-478B-A76D-3D9624312D67" class="sect5">灵活的呼叫顺序</h5>
                     <div>
                        <p>只要远程事务程序的<code class="codeph">SEND/RECEIVE</code>请求得到满足，每次调用时在TIP和网关之间交换的数据参数的数量可以由用户自行决定。例如，远程事务程序数据交换序列可能是：</p><pre class="oac_no_warn" dir="ltr">TCP / IP SEND 5字段（field1-field5）TCP / IP RECEIVE 1字段（field6）TCP / IP SEND 1字段（field7）TCP / IP RECEIVE 3字段（field8-field10）</pre><p>生成的TIP /应用程序调用序列可以是：</p><pre class="oac_no_warn" dir="ltr">tip_call1（parm1 OUT，&lt; -  TCP / IP SEND field1来自远程TP parm2 OUT，&lt; -  TCP / IP SEND field2来自远程TP parm3 OUT）; &lt; - 来自远程TP tip_call2的TCP / IP SEND字段3（parm4 OUT，&lt; - 来自远程TP parm5 OUT的TCP / IP SEND字段4）; &lt; - 来自远程TP tip_call3的TCP / IP SEND字段5（parm6 IN OUT）; - &gt;远程TP &lt; -  TCP / IP SEND field7中的TCP / IP RECEIVE field6从远程TP tip_call4（parm8 IN， - &gt; TCP / IP RECEIVE field8到远程TP parm9 IN， - &gt; TCP / IP RECEIVE field9 into远程TP parm10 IN）; - &gt; TCP / IP RECEIVE field10到远程TP</pre><p>要将这四个公共函数定义到TIP，必须发出四个PGAU <code class="codeph">DEFINE CALL</code>语句，每个语句都指定其唯一的公共函数名称（ <code class="codeph">tip_callx</code> ）和要交换的数据参数列表。一旦使用<code class="codeph">DEFINE DATA</code>定义了数据项，就可以在任何模式（ <code class="codeph">IN</code> ， <code class="codeph">OUT</code>或<code class="codeph">IN OUT</code> ）中多次调用它。例如， <code class="codeph">parm5</code>可以使用的第二时间代替<code class="codeph">parm6</code>这意味着相同的数据被在这两种情况下进行交换，接收到的TIP和应用上<code class="codeph">tip_call2</code>并返回，可能被更新，以在远程主机<code class="codeph">tip_call4</code> 。
                        </p>
                        <p>另请注意，远程事务程序的前五个写入字段由两个单独的TIP函数调用<code class="codeph">tip_call1</code>和<code class="codeph">tip_call2</code> 。这也可以通过每个<code class="codeph">OUT</code>参数的五个TIP函数调用或具有五个<code class="codeph">OUT</code>参数的单个TIP函数调用等效地完成。然后远程交易程序的第一读字段（ <code class="codeph">field6</code> ）和随后的写入字段（ <code class="codeph">field7</code> ）对应于单个TIP函数调用（ <code class="codeph">tip_call3</code> ）与单个<code class="codeph">IN OUT</code>参数（ <code class="codeph">parm6</code> ）。
                        </p>
                        <p>这种使用单一的<code class="codeph">IN OUT</code>参数意味着远程交易程序的数据类型为<code class="codeph">field6</code>和<code class="codeph">field7</code>都是相同的，并且对应于用于的数据类型执行转换<code class="codeph">parm6</code> 。如果<code class="codeph">field6</code>和<code class="codeph">field7</code>的数据类型不同，那么它们必须对应于不同的PL / SQL参数（例如， <code class="codeph">parm6 IN</code>和<code class="codeph">parm7 OUT</code> ）。但是，它们仍然可以在单个TIP呼叫上交换为两个参数，或者在两个TIP呼叫中交换为一个参数。
                        </p>
                        <p>最后，远程事务程序的剩余三个<code class="codeph">RECEIVE</code>字段由<code class="codeph">tip_call4</code>参数8-10提供。它们也可以通过三个TIP调用完成，每个参数传递一个参数，或者两个TIP调用在一个调用中传递一个参数，在另一个调用中传递两个参数，以任一顺序。这种灵活性允许用户以最适合用户的任何方式定义远程交易程序的操作和TIP函数调用之间的对应关系。
                        </p>
                     </div>
                  </div><a id="APPUG1033"></a><div class="props_rev_3"><a id="GUID-5D540B94-7349-445D-BDBF-0934811FF4C4" name="GUID-5D540B94-7349-445D-BDBF-0934811FF4C4"></a><h5 id="APPUG-GUID-5D540B94-7349-445D-BDBF-0934811FF4C4" class="sect5">致电通信订单限制</h5>
                     <div>
                        <p>每个TIP公共函数在收到任何<code class="codeph">OUT</code>参数之前首先发送所有<code class="codeph">IN</code>参数。因此，期望发送一个字段然后接收一个字段的远程事务程序必须对应于单独的TIP调用。
                        </p>
                        <p>例如：</p><pre class="oac_no_warn" dir="ltr">tip_callO（parmO OUT）; &lt; - 来自远程TP的TCP / IP SEND外场</pre><p><code class="codeph">PGAXFER</code> RPC首先检查要发送的参数，但是找不到并继续接收参数：</p><pre class="oac_no_warn" dir="ltr">tip_callI（parmI IN）; - &gt; TCP / IP RECEIVE内场到远程TP</pre><p><a id="d24694e1236" class="indexterm-anchor"></a> <code class="codeph">PGAXFER</code> RPC处理要发送的参数，然后检查要接收的参数，但找不到并完成;因此，具有<code class="codeph">OUT</code>参数后跟<code class="codeph">IN</code>参数的单个TIP公共函数不起作用，因为首先处理<code class="codeph">IN</code>参数 - 无论其在参数列表中的位置如何。
                        </p>
                     </div>
                  </div>
               </div><a id="APPUG1034"></a><div class="props_rev_3"><a id="GUID-F4CF40A2-8795-43CF-AC3A-E1CF314EF356" name="GUID-F4CF40A2-8795-43CF-AC3A-E1CF314EF356"></a><h4 id="APPUG-GUID-F4CF40A2-8795-43CF-AC3A-E1CF314EF356" class="sect4">交易通信</h4>
                  <div>
                     <p>该<a id="d24694e1303" class="indexterm-anchor"></a>远程主机事务使用PGAU <code class="codeph">DEFINE TRANSACTION</code>语句定义，并附加对事务支持的<code class="codeph">CALL</code>的先前定义的引用。
                     </p>
                     <p>你指定了<a id="d24694e1316" class="indexterm-anchor"></a>远程主机事务属性，例如：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>交易ID或名称</p>
                        </li>
                        <li>
                           <p>网络地址或位置</p>
                        </li>
                        <li>
                           <p>系统类型（例如IBM370）</p>
                        </li>
                        <li>
                           <p>Oracle National语言的远程主机</p>
                           <div class="infoboxnote" id="GUID-F4CF40A2-8795-43CF-AC3A-E1CF314EF356__GUID-8DAFE55A-3E86-4947-BAFC-4F811E5AB37F">
                              <p class="notep1">注意：</p>
                              <p>该<a id="d24694e1337" class="indexterm-anchor"></a>定义事务时指定PL / SQL包名称;这是引用TIP的名称，以及公共函数调用的名称包含在TIP中。每个公共函数必须先前已使用PGAU <code class="codeph">DEFINE CALL</code>语句定义，该语句已存储在PG DD中。如果未在<code class="codeph">GENERATE</code>语句中指定包名称（TIP名称），则默认情况下，您指定的事务名称将成为包名称。在这种情况下，事务名称（ <span class="italic"><code class="codeph">tname)</code></span>必须是唯一的，并且必须在包含PL / SQL包的数据库中的有效PL / SQL语法中。
                              </p>
                              <p>欲了解更多信息，请参阅<span class="q">“ <a href="pga-utility-oracle-database-gateway-appc.html#GUID-EC8B6848-0566-45CD-BA08-78F15ED0EEB4">定义事务处理</a></span>中的<span class="q">”</span> <a href="pga-utility-oracle-database-gateway-appc.html#GUID-F73E20E7-D94C-468F-BA65-CC34F6373F19">程序网关管理实用程序</a>和<span class="q">“ <a href="admin-utility-samples-oracle-database-gateway-appc.html#GUID-C8F9DE40-9DE6-4F49-A765-BFFDEC3065F9">样品PGAU定义事务处理的声明</a> ”，</span>在<a href="admin-utility-samples-oracle-database-gateway-appc.html#GUID-AA9B8762-BDAF-4EED-A8B0-09F8A937F04E">管理实用程序样本</a> 。
                              </p>
                           </div>
                        </li>
                     </ul>
                     <p>在此示例中，以下<code class="codeph">DEFINE TRANSACTION</code>语句用于将此信息与中的插入行进行匹配<a id="d24694e1377" class="indexterm-anchor"></a> <code class="codeph">PGA_TCP_IMSC</code>表。
                     </p><pre class="oac_no_warn" dir="ltr">DEFINE TRANSACTION IMSFLIP CALL（FLIPMAIN）SIDEPROFILE（PGATCP）TPNAME（FLIP）NLS_LANGUAGE（“american_america.us7ascii”）;</pre></div>
               </div>
            </div><a id="APPUG1035"></a><div class="props_rev_3"><a id="GUID-BCFCDB41-E65A-4333-AAAF-CB5FCEB4762A" name="GUID-BCFCDB41-E65A-4333-AAAF-CB5FCEB4762A"></a><h3 id="APPUG-GUID-BCFCDB41-E65A-4333-AAAF-CB5FCEB4762A" class="sect3">从客户端应用程序调用TIP</h3>
               <div>
                  <p>创建TIP后，必须编写客户端应用程序以与TIP接口。调用TIP函数的客户端应用程序必须包含五个逻辑部分：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>声明TIP变量</p>
                     </li>
                     <li>
                        <p>初始化对话</p>
                     </li>
                     <li>
                        <p>交换数据</p>
                     </li>
                     <li>
                        <p>终止谈话</p>
                     </li>
                     <li>
                        <p>错误处理</p>
                     </li>
                  </ul>
               </div><a id="APPUG1315"></a><a id="APPUG1316"></a><a id="APPUG1036"></a><div class="props_rev_3"><a id="GUID-E7619AF6-1062-4B87-8E0F-4E8BF8F6DD0E" name="GUID-E7619AF6-1062-4B87-8E0F-4E8BF8F6DD0E"></a><h4 id="APPUG-GUID-E7619AF6-1062-4B87-8E0F-4E8BF8F6DD0E" class="sect4">声明TIP变量</h4>
                  <div>
                     <p>用户声明部分<a id="d24694e1491" class="indexterm-anchor"></a><a id="d24694e1493" class="indexterm-anchor"></a> <span class="italic"><code class="codeph">tipname</code></span> 。 <code class="codeph">doc</code>文件记录了所需的声明。
                     </p>
                     <p>路过时<a id="d24694e1506" class="indexterm-anchor"></a>调用TIP函数时的PL / SQL参数，客户端应用程序必须使用与TIP函数参数完全相同的PL / SQL数据类型，如其规范部分中的TIP所定义。例如，假设以下是TIP规范或<span class="italic"><code class="codeph">tipname</code></span> <code class="codeph">.doc</code> ：</p><pre class="oac_no_warn" dir="ltr">功能<span class="italic">tip_call1</span> <span class="italic">tranuse</span> ，IN BINARY_INTEGER， <span class="italic">tip_var1 io_mode pls_type1，</span> <span class="italic">tip_record io_mode tran_rectype）</span> RETURN INTEGER; TYPE <span class="italic">tran_rectype</span>是RECORD <span class="italic">（rec_field1 pls_type1</span> ，...
      <span class="italic">rec_fieldN pls_typeN）</span> ;</pre><p><a href="developing-appc-client-app-tcpip-only.html#GUID-E7619AF6-1062-4B87-8E0F-4E8BF8F6DD0E__CHDBDDDG" title="该2列表提供了每个参数的描述。">表7-2</a>提供了每个参数的说明：</p>
                     <div class="tblformal" id="GUID-E7619AF6-1062-4B87-8E0F-4E8BF8F6DD0E__CHDBDDDG">
                        <p class="titleintable">表7-2函数声明</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="功能声明" width="100%" border="1" summary="This 2 column table provides a description of each of the parameters." frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="31%" id="d24694e1558">参数</th>
                                 <th align="left" valign="bottom" width="69%" id="d24694e1561">描述</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d24694e1566" headers="d24694e1558 ">
                                    <p><span class="italic"><code class="codeph">tip_call1</code></span> 
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d24694e1566 d24694e1561 ">
                                    <p>TIP函数名称，在包规范中定义。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d24694e1576" headers="d24694e1558 ">
                                    <p><span class="italic"><code class="codeph">tranuse</code></span></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d24694e1576 d24694e1561 ">
                                    <p>从TIP初始化函数返回的远程事务实例参数，用于标识此TIP调用将在其上交换数据的对话。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d24694e1585" headers="d24694e1558 ">
                                    <p><span class="italic"><code class="codeph">tran_rectype</code></span> 
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d24694e1585 d24694e1561 ">
                                    <p>在<code class="codeph">tipname</code>声明的PL / SQL记录数据类型<span class="italic"> </span>提示规范。这与<code class="codeph">TYPE</code>值相同<span class="italic">                 </span> <span class="italic"><code class="codeph">tran_rectype</code></span> <code class="codeph">is RECORD</code>语句。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d24694e1610" headers="d24694e1558 ">
                                    <p><span class="italic"><code class="codeph">pls_typeN</code></span></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d24694e1610 d24694e1561 ">
                                    <p>是PL / SQL原子数据类型。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d24694e1619" headers="d24694e1558 ">
                                    <p><span class="italic"><code class="codeph">rec_fieldN</code></span></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d24694e1619 d24694e1561 ">
                                    <p>PL / SQL记录字段是否对应于远程事务程序记录字段。</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p>在客户端应用程序中，PL / SQL原子数据类型应定义为TIP函数定义中相应参数的完全相同的数据类型。应在<code class="codeph">BEGIN</code>命令之前在客户端应用程序中编码以下内容：</p><pre class="oac_no_warn" dir="ltr"><span class="italic">appl_var pls_type1</span> ; / *声明appl变量....* /</pre><p>您无需重新定义TIP数据类型。它们必须在客户端应用程序中本地声明，在<code class="codeph">BEGIN</code>之前出现在客户端应用程序中：</p><pre class="oac_no_warn" dir="ltr"><span class="italic">appl_record tipname.tran_rectype;</span> / *声明appl记录* /</pre><p><a href="developing-appc-client-app-tcpip-only.html#GUID-E7619AF6-1062-4B87-8E0F-4E8BF8F6DD0E__G1012979" title="这2列表描述了每个过程声明的含义。">表7-3</a>描述了每个过程声明的含义：</p>
                     <div class="tblformal" id="GUID-E7619AF6-1062-4B87-8E0F-4E8BF8F6DD0E__G1012979">
                        <p class="titleintable">表7-3过程声明</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="程序声明" width="100%" border="1" summary="This 2 column table describes the meaning of each procedure declaration." frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="31%" id="d24694e1661">项目</th>
                                 <th align="left" valign="bottom" width="69%" id="d24694e1664">描述</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d24694e1669" headers="d24694e1661 ">
                                    <p><span class="italic"><code class="codeph">appl_record</code></span></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d24694e1669 d24694e1664 ">
                                    <p>是否与TIP交换PL / SQL记录并在客户端应用程序中使用。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d24694e1678" headers="d24694e1661 ">
                                    <p><span class="italic"><code class="codeph">tipname</code></span></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d24694e1678 d24694e1664 ">
                                    <p>PL / SQL包（TIP）名称是否存储在Oracle数据库中。这与TIP规范中的语句<code class="codeph">CREATE</code>或<code class="codeph">REPLACE PACKAGE</code> <span class="italic"><code class="codeph">tipname</code></span>中的值相同。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d24694e1697" headers="d24694e1661 ">
                                    <p><span class="italic"><code class="codeph">tran_rectype</code></span> 
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d24694e1697 d24694e1664 ">
                                    <p>是否在<span class="italic"><code class="codeph">tipname</code></span> TIP规范中声明了PL / SQL记录数据类型。这与<code class="codeph">TYPE</code> <span class="italic"><code class="codeph">tran_rectype</code></span>是<code class="codeph">RECORD</code>语句中的值相同。
                                    </p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p>有关您可以引用的用户声明的完整说明，请参阅<span class="italic"><code class="codeph">tipname</code></span> <code class="codeph">.doc</code>内容文件。
                     </p>
                     <p>客户端应用程序调用TIP公共函数，就像它是任何本地PL / SQL函数一样：</p><pre class="oac_no_warn" dir="ltr">rc = tip_call1（tranuse，appl_var，appl_record）;</pre><p>在TCP / IP IMS Connect示例中，PL / SQL驱动程序<a id="d24694e1735" class="indexterm-anchor"></a> <code class="codeph">pgtflipd.sql</code> ，这是<span class="bold"> </span>位于Microsoft Windows上的<code class="codeph">%ORACLE_HOME%\dg4appc\demo\IMS</code>目录和基于UNIX的系统上的<code class="codeph">$ORACLE_HOME/dg4appc/demo/IMS</code>目录中，是客户端应用程序，包括以下声明：</p><pre class="oac_no_warn" dir="ltr">......CREATE或REPLACE PROCEDURE pgtflipd（mesgin IN CHAR）IS trannum INTEGER：= 0 / *交易使用数* / mesgout VARCHAR2（254）; / *输出参数* / rc INTEGER：= 0 / * PGA RPC返回码* / term INTEGER：= 0; / * 1如果pgtflip_term调用* / ......</pre></div>
               </div><a id="APPUG1037"></a><div class="props_rev_3"><a id="GUID-A00FA9EC-E261-4AC9-A136-756309229FDB" name="GUID-A00FA9EC-E261-4AC9-A136-756309229FDB"></a><h4 id="APPUG-GUID-A00FA9EC-E261-4AC9-A136-756309229FDB" class="sect4">初始化对话</h4>
                  <div>
                     <p>打电话给<a id="d24694e1783" class="indexterm-anchor"></a>初始化对话有以下几个目的：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>使PL / SQL包，TIP加载并执行TIP初始化部分中编程的初始化逻辑。</p>
                        </li>
                        <li>
                           <p>使TIP init函数调用<code class="codeph">PGAINIT</code>远程过程调用（RPC），后者又建立与远程事务程序（RTP）的通信，并将事务实例号返回给应用程序。
                           </p>
                        </li>
                     </ul>
                     <p>（可选）初始化对话的调用可用于：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>覆盖默认的RHT / OLTP标识，网络地址属性和对话安全用户标识和密码。</p>
                        </li>
                        <li>
                           <p>指定什么诊断<a id="d24694e1807" class="indexterm-anchor"></a>跟踪TIP是为了生产。有关诊断跟踪的详细信息，请参阅<a href="troubleshooting-oracle-database-gateway-appc.html#GUID-6A2105DD-D6F0-4368-BE63-F8A85D5C959F">故障排除</a> 。
                           </p>
                        </li>
                     </ul>
                     <p>PGAU生成的TIP提供四种不同的初始化函数，客户端应用程序可以调用它们。这些是重载函数，它们都具有相同的名称，但在传递的参数类型方面有所不同。</p>
                     <p>传递三个初始化参数：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>RHT套接字文件描述符的事务实例编号。所有TIP初始化都需要<code class="codeph">tranuse</code>参数。
                           </p>
                        </li>
                        <li>
                           <p>TIP运行时诊断控件的TIP诊断标志。<code class="codeph">tipdiag</code>参数是可选的。有关TIP诊断的讨论，请参阅<a href="troubleshooting-oracle-database-gateway-appc.html#GUID-6A2105DD-D6F0-4368-BE63-F8A85D5C959F">故障排除</a> 。
                           </p>
                        </li>
                        <li>
                           <p>覆盖OLTP和网络属性的提示默认覆盖。<code class="codeph">override</code>参数是可选的。
                           </p>
                        </li>
                     </ul>
                     <p>显示以下四个功能，因为它们可能出现在TIP内容文档文件中。稍后提供客户端应用程序使用的示例。</p><pre class="oac_no_warn" dir="ltr">TYPE override_Typ IS RECORD（tranname VARCHAR2（2000），/ * Transaction Program * / transync BINARY_INTEGER，/ * RESERVED * / trannls VARCHAR2（50），/ * RESERVED * / oltpname VARCHAR2（2000），/ * Logical Unit * / oltpmode VARCHAR2 （2000），/ * LOG模式输入* / netaddr VARCHAR2（2000），/ * Side Profile * / tracetag VARCHAR2（2000），/ * gateway trace idtag * / FUNCTION pgtflip_init（/ * init standard * / tranuse IN OUT BINARY_INTEGER） RETURN INTEGER; FUNCTION pgtflip_init（/ * init override * / tranuse IN OUT BINARY_INTEGER，override IN override_Typ）RETURN INTEGER; FUNCTION pgtflip_init（/ * init diagnostic * / tranuse IN OUT BNARY_INTEGER，tipdiag IN CHAR）RETURN INTEGER; FUNCTION pgtflip_init（/ * init over-diag * / tranuse IN OUT BINARY_INTEGER，覆盖IN override_Typ，tipdiag IN CHAR）RETURN INTEGER;</pre></div><a id="APPUG1038"></a><div class="props_rev_3"><a id="GUID-1118371F-B21C-433F-A0E6-D06737E60C95" name="GUID-1118371F-B21C-433F-A0E6-D06737E60C95"></a><h5 id="APPUG-GUID-1118371F-B21C-433F-A0E6-D06737E60C95" class="sect5">交易实例参数</h5>
                     <div>
                        <p>这个<a id="d24694e1879" class="indexterm-anchor"></a><a id="d24694e1883" class="indexterm-anchor"></a>事务实例编号（在示例中显示为<code class="codeph">tranuse</code> ）必须传递给后续的TIP交换和终止函数。它标识到哪个网关<a id="d24694e1893" class="indexterm-anchor"></a> TCP / IP对话 - 以及远程事务程序的哪个迭代 - 数据将被传输或通信终止。
                        </p>
                        <p>单个客户端应用程序可以同时控制同一远程事务程序或多个不同远程事务程序的多个实例。事务实例编号是TIP的机制，用于通过网关将客户端应用程序调用路由到预期的远程事务程序。</p>
                        <p>客户端应用程序负责保存每个活动事务的事务实例编号，并将正确的事务传递给为该事务调用的每个TIP函数。</p>
                        <p>客户端应用程序调用TIP初始化函数，就好像它是任何本地PL / SQL函数一样。例如：</p><pre class="oac_no_warn" dir="ltr">......trannum INTEGER：= 0; / *交易使用数量* / ......BEGIN rc：= pgtflip.pgtflip_init（trannum）; ......</pre></div>
                  </div><a id="APPUG1039"></a><div class="props_rev_3"><a id="GUID-88270E73-3234-4693-9F63-17F0458E1586" name="GUID-88270E73-3234-4693-9F63-17F0458E1586"></a><h5 id="APPUG-GUID-88270E73-3234-4693-9F63-17F0458E1586" class="sect5">覆盖TIP初始化</h5>
                     <div>
                        <p>请注意，在前面的示例中，客户端应用程序未指定任何远程事务程序名称，网络连接或安全信息。TIP将此类信息内部编码为默认值，客户端应用程序只是为所选的远程事务程序调用适当的TIP。但是，客户端应用程序可以选择覆盖某些TIP默认值并提供安全信息。</p>
                        <p>您无需更改任何不需要覆盖的客户端应用程序。</p>
                        <p>在PG DD中定义远程主机事务时， <code class="codeph">DEFINE TRANSACTION</code>语句指定了可以覆盖的某些默认OLTP和网络标识属性：<a id="d24694e1957" class="indexterm-anchor"></a><a id="d24694e1961" class="indexterm-anchor"></a><a id="d24694e1965" class="indexterm-anchor"></a><a id="d24694e1969" class="indexterm-anchor"></a></p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>TPNAME</p>
                           </li>
                           <li>
                              <p>侧面轮廓</p>
                           </li>
                        </ul>
                        <p>有关<code class="codeph">DEFINE TRANSACTION</code>语句的更多信息，请参阅<a href="pga-utility-oracle-database-gateway-appc.html#GUID-F73E20E7-D94C-468F-BA65-CC34F6373F19">Procedural Gateway Administration Utility中的</a> <span class="q">“ <a href="pga-utility-oracle-database-gateway-appc.html#GUID-EC8B6848-0566-45CD-BA08-78F15ED0EEB4">DEFINE TRANSACTION</a> ”</span> 。
                        </p>
                        <p>这些PG DD定义的事务属性作为默认值生成到TIP中，并且可以在其中被覆盖<a id="d24694e1996" class="indexterm-anchor"></a>提示初始化时间。这便于使用一个TIP，该TIP可以与测试事务或系统一起使用，并且稍后可以与生产事务或系统一起使用，而不必重新生成TIP。</p>
                        <p><code class="codeph">override_Typ</code>记录数据类型描述了客户端应用程序可以覆盖的各种事务属性。目前支持以下o verrides：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">tranname</code>可以设置为覆盖<code class="codeph">DEFINE TRANSACTION</code>语句的<code class="codeph">TPNAME</code>参数指定的值</p>
                           </li>
                           <li>
                              <p><code class="codeph">netaddr</code>可以设置为覆盖<code class="codeph">DEFINE TRANSACTION</code>语句的<code class="codeph">SIDEPROFILE</code>参数指定的值</p>
                           </li>
                        </ul>
                        <p>除了在中定义的事务属性<a id="d24694e2038" class="indexterm-anchor"></a> PG DD，有两个与安全相关的参数，会话安全用户ID和会话安全密码，可以在TIP初始化时覆盖。这些参数的值通常来自用于访问网关的数据库链接或Oracle数据库会话。有些情况下，Oracle数据库用户标识不足以访问OLTP系统。用户标识和密码重写提供了一种向OLTP系统指定这些参数的方法。
                        </p>
                        <p>目前支持以下覆盖：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">oltpuser</code>可以设置为覆盖用于初始化OLTP对话的用户ID</p>
                           </li>
                           <li>
                              <p><code class="codeph">oltppass</code>可以设置为覆盖用于初始化OLTP对话的密码</p>
                           </li>
                        </ul>
                        <p>仅当在网关初始化文件中指定了<code class="codeph">PGA_SECURITY_TYPE=PROGRAM</code>且OLTP系统配置为接收传入会话请求的用户ID和密码时，安全覆盖才会生效。
                        </p>
                        <p><code class="codeph">transync</code> （IMS Connect <code class="codeph">SYNCLEVEL</code> ）和<code class="codeph">trannls</code> （全球化支持字符集）在覆盖记录数据类型中定义，但保留供将来使用。无法覆盖RHT <code class="codeph">SYNCLEVEL</code>和全球化支持名称。
                        </p>
                        <p>客户端应用程序可能会在TIP初始化时覆盖默认属性，原因如下：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>启动不同版本的RHT（例如生产而不是测试）</p>
                           </li>
                           <li>
                              <p>更改包含RHT的OLTP的位置（如果由于迁移或切换到备份配置而移动了OLTP）</p>
                           </li>
                        </ul>
                        <p>需要覆盖的客户端应用程序可以使用覆盖和初始化参数的任意组合，并且可以随时更改组合，而无需重新生成TIP或影响不覆盖参数的应用程序。</p>
                        <p>要覆盖TIP默认值，必须将其他客户端应用程序记录变量声明为<code class="codeph">override_Typ</code>数据类型，必须将值分配给覆盖子字段，并且必须在客户端应用程序的TIP初始化调用上传递覆盖记录变量。例如：</p><pre class="oac_no_warn" dir="ltr">......my_overrides pgtflip.override_Typ; -  宣言 ......my_overrides.oltpname：='IVTNO'; - 交换到生产IMS my_overrides.tranname：='IVTNV'; - 新交易名称BEGIN rc：= pgtflip.pgtflip_init（trannum，my_overrides）; -  在里面 ......
</pre><p>在TIP中，检查覆盖属性的语法问题并将其传递给网关服务器。</p>
                     </div>
                  </div><a id="APPUG1040"></a><div class="props_rev_3"><a id="GUID-81DBF430-5E5B-42C4-9A27-CB4E2D8BB164" name="GUID-81DBF430-5E5B-42C4-9A27-CB4E2D8BB164"></a><h5 id="APPUG-GUID-81DBF430-5E5B-42C4-9A27-CB4E2D8BB164" class="sect5">安全考虑因素</h5>
                     <div>
                        <p>该<a id="d24694e2129" class="indexterm-anchor"></a><a id="d24694e2133" class="indexterm-anchor"></a>默认和重写的OLTP的安全要求必须相同，因为在任一对话中使用相同的网关服务器，如PGA RPC调用中的数据库链接名称所指示的那样。网关服务器启动安全模式在网关服务器初始化时设置，并在TIP或会话初始化时未更改地传递给OLTP。
                        </p>
                     </div>
                  </div>
               </div>
            </div><a id="APPUG1041"></a><div class="props_rev_3"><a id="GUID-F450316B-272E-4EC2-9574-7F39B34C3B04" name="GUID-F450316B-272E-4EC2-9574-7F39B34C3B04"></a><h3 id="APPUG-GUID-F450316B-272E-4EC2-9574-7F39B34C3B04" class="sect3">交换数据</h3>
               <div>
                  <div class="section">
                     <p>客户端应用程序应传递从先前的<code class="codeph">tip_init</code>调用返回的事务实例号，以识别受影响的远程事务程序，并识别要与远程事务程序交换的任何客户端应用程序数据参数。
                     </p>
                     <p>在此IMS Connect查询示例中，我们传递员工编号并接收员工记录：</p><pre class="oac_no_warn" dir="ltr">rc = pgtflip.pgtflip_main（trannum，/ *传输数据* / mesgin，/ *输入参数* / mesgout）; / *输出参数* /</pre></div>
                  <!-- class="section" -->
               </div><a id="APPUG1042"></a><div class="props_rev_3"><a id="GUID-D83C1EEC-D944-4643-AB86-C82AACB7923D" name="GUID-D83C1EEC-D944-4643-AB86-C82AACB7923D"></a><h4 id="APPUG-GUID-D83C1EEC-D944-4643-AB86-C82AACB7923D" class="sect4">终止对话</h4>
                  <div>
                     <p>客户端应用程序调用TIP终止函数，就好像它是任何本地PL / SQL函数一样。例如：</p><pre class="oac_no_warn" dir="ltr">......术语：= 1; / *表示名为* / rc：= pgtflip.pgtflip_term（trannum，0）的术语; / *正常终止* / ......</pre><p></p>
                     <p>在TIP终止调用上传递事务实例号以终止事务之后，或者在远程事务程序被终止之后，可能忘记该特定事务实例号。</p>
                  </div>
               </div><a id="APPUG1043"></a><div class="props_rev_3"><a id="GUID-D795B1E5-54EA-4974-9BC5-6A0028575F7B" name="GUID-D795B1E5-54EA-4974-9BC5-6A0028575F7B"></a><h4 id="APPUG-GUID-D795B1E5-54EA-4974-9BC5-6A0028575F7B" class="sect4">错误处理</h4>
                  <div>
                     <p>客户端应用程序应包含一个异常处理程序，可以在客户端应用程序终止之前清除任何活动的TCP / IP对话。<code class="codeph">pgtflipd.sql</code>中提供的示例客户端应用程序包含异常处理的示例。
                     </p>
                     <p>网关例外报告在<code class="codeph">PGA-20900</code>至<code class="codeph">PGA-20999</code>和<code class="codeph">PGA-22000</code>至<code class="codeph">PGA 22099</code> 。发生异常时，应为先前调用TIP初始化函数启动的任何活动对话调用TIP终止函数。
                     </p>
                     <p>例如：</p><pre class="oac_no_warn" dir="ltr">如果等于等于等于其他等等，那么等于/ *终止函数尚未被调用* / rc：= pgtflip.pgtflip_term（trannum，1）; / *异常终止* / END IF;提高;</pre><p>远程事务还应包括错误处理和调试的规定，例如将调试信息写入IMS临时存储队列区域。有关如何拦截和处理Oracle异常的讨论，请参阅<a href="../lnpls/plsql-error-handling.html#LNPLS00701" target="_blank"><span class="italic">Oracle数据库PL / SQL语言参考</span></a> 。
                     </p>
                  </div>
               </div><a id="APPUG1044"></a><div class="props_rev_3"><a id="GUID-F02CA799-41D0-4F0B-A19D-A55AF7118F6D" name="GUID-F02CA799-41D0-4F0B-A19D-A55AF7118F6D"></a><h4 id="APPUG-GUID-F02CA799-41D0-4F0B-A19D-A55AF7118F6D" class="sect4">授予执行权限</h4>
                  <div>
                     <div class="section">
                        <p>TIP是一个标准<a id="d24694e2347" class="indexterm-anchor"></a>必须向从客户端应用程序调用TIP的用户授予PL / SQL包和执行权限。在这个例子中，我们将<code class="codeph">pgtflip</code>包的执行权授予用户<code class="codeph">SCOTT</code> ：</p><pre class="oac_no_warn" dir="ltr">授予PGTFLIP到SCOTT的授权</pre><p>有关详细信息，请参阅“ <a href="../admin/getting-started-with-database-administration.html#ADMIN11062" target="_blank"><span class="italic">Oracle数据库管理员指南”</span></a> 。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="APPUG1045"></a><div class="props_rev_3"><a id="GUID-8EC590FC-73C4-4B31-8662-ED43392EF9CE" name="GUID-8EC590FC-73C4-4B31-8662-ED43392EF9CE"></a><h3 id="APPUG-GUID-8EC590FC-73C4-4B31-8662-ED43392EF9CE" class="sect3">致电PG4TCPMAP</h3>
               <div>
                  <p>不需要修改PGAU以便使用TCP / IP在网关上进行对话。您使用PGAU的APPC格式，但您将使用<code class="codeph">pg4tcpmap</code>工具将参数映射到TCP / IP。
                  </p>
                  <p>使用映射<code class="codeph">DEFINE TRANSACTION</code>参数<a id="d24694e2408" class="indexterm-anchor"></a><a id="d24694e2412" class="indexterm-anchor"></a> TCP / IP，在执行应用程序之前，您必须在<code class="codeph">PGA_TCP_IMSC</code>表中具有有效输入。有关设置和使用映射工具的信息，请参阅<a href="pg4tcpmap-commands-tcpip.html#GUID-CDAD0D0C-6070-4E0E-9B97-E4DCF919510F">PG4TCPMAP命令（仅限TCP / IP）</a> 。
                  </p>
               </div>
            </div><a id="APPUG1046"></a><div class="props_rev_3"><a id="GUID-14AA4D11-BDB6-4934-BDE5-371D9B3D61E6" name="GUID-14AA4D11-BDB6-4934-BDE5-371D9B3D61E6"></a><h3 id="APPUG-GUID-14AA4D11-BDB6-4934-BDE5-371D9B3D61E6" class="sect3">执行申请</h3>
               <div>
                  <div class="section">
                     <p>在执行客户端应用程序之前，请确保已建立与主机的连接并且接收伙伴可用。在此示例中，我们使用PL / SQL驱动程序<code class="codeph">PGTFLIPD</code>来执行IMS / IMS Connect查询。要执行此客户端应用程序，请从SQL * Plus输入：</p><pre class="oac_no_warn" dir="ltr">在执行pgtflipd（'hello'）上设置serveroutput;</pre></div>
                  <!-- class="section" -->
               </div>
            </div><a id="APPUG1047"></a><div class="props_rev_3"><a id="GUID-FDB3D1E8-0510-49D3-AB83-2BD508801865" name="GUID-FDB3D1E8-0510-49D3-AB83-2BD508801865"></a><h3 id="APPUG-GUID-FDB3D1E8-0510-49D3-AB83-2BD508801865" class="sect3">支持多字节字符集的应用程序开发</h3>
               <div>
                  <p><a id="d24694e2515" class="indexterm-anchor"></a> COBOL目前只支持<a id="d24694e2520" class="indexterm-anchor"></a>双字节字符集（ <a id="d24694e2525" class="indexterm-anchor"></a> DBCS）for <a id="d24694e2530" class="indexterm-anchor"></a> PIC G数据类型。
                  </p>
                  <p>PGAU将IBM VS COBOLII <code class="codeph">PIC G</code>数据类型处理为PL / SQL <code class="codeph">VARCHAR2</code>变量，并生成TIP，这些TIP根据为远程主机数据和本地Oracle数据指定的Oracle <code class="codeph">NLS_LANGUAGE</code>自动转换数据。
                  </p>
                  <p>可以将这些Oracle <code class="codeph">NLS_LANGUAGE</code>指定为TIP与远程事务交换的所有<code class="codeph">PIC G</code>数据的默认值（请参阅<code class="codeph">DEFINE TRANSACTION ...REMOTE_MBCS</code>或<code class="codeph">LOCAL_MBCS</code> ）。可以进一步覆盖任何单个<code class="codeph">PIC G</code>数据项的Oracle <code class="codeph">NLS_LANGUAGE</code> （请参阅<code class="codeph">REDEFINE DATA ...REMOTE</code>或<code class="codeph">LOCAL_LANGUAGE</code> ）。
                  </p>
                  <p>DBCS数据可以以受支持的DBCS字符集的任意组合进行编码。例如，Oracle数据库网关支持一个远程主机应用程序，该应用程序允许记录中每个数据字段使用不同的代码页<a id="d24694e2575" class="indexterm-anchor"></a> MBCS <a id="d24694e2578" class="indexterm-anchor"></a>支持。
                  </p>
                  <p>使用<code class="codeph">REDEFINE DATA ...还支持<code class="codeph">PIC X</code>项目上的REMOTE_LANGUAGE</code>或<code class="codeph">LOCAL_LANGUAGE</code> 。因此，除了剩余的<code class="codeph">PIC X</code>数据字段的默认SBCS转换之外，TIP还可以对指定的<code class="codeph">PIC X</code>数据字段执行DBCS或MBCS转换。默认SBCS转换是根据<code class="codeph">DEFINE TRANSACTION...NLS_LANGUAGE</code>和本地Oracle默认<code class="codeph">LANGUAGE</code>环境值。
                  </p>
                  <p>当PGAU生成TIP时， <code class="codeph">PIC G</code>数据类型将转换为PL / SQL <code class="codeph">VARCHAR2</code>数据类型。在通过TIP转换后，由于删除了移出和移入元字符，收到的<code class="codeph">'PIC G' VARCHAR2s</code>的长度可以小于最大值，并且发送的<code class="codeph">'PIC G'</code> G'RAW数据类型将具有移出和移位-in根据指定的远程主机字符集的要求插入字符。
                  </p>
                  <p>这与为<code class="codeph">PIC X</code>数据执行的转换不同，后者始终是已知的固定长度，因此<code class="codeph">CHAR</code>数据类型在TIP中用于<code class="codeph">PIC X</code>数据字段。但是，即使<code class="codeph">PIC X</code>字段包含DBCS或MBCS数据，仍然会使用<code class="codeph">CHAR</code>变量，并在需要时填充空白。
                  </p>
                  <p>某些远程主机应用程序将<code class="codeph">PIC G</code>字段与<code class="codeph">PIC X</code>字节组合在一起，用于移出，移入元字符插入。这样的COBOL定义可能如下所示：</p><pre class="oac_no_warn" dir="ltr">01 MY_RECORD。 05 SO PIC X. 05 MY_MBCS_DATA PIC G（50）。05 SI PIC X.</pre><p>PGAU无法正确处理这一点，因为在执行转换时，所有三个字段都被定义并因此被视为单独的数据项。</p>
                  <p>要正确处理，输入到PGAU的定义应为：</p><pre class="oac_no_warn" dir="ltr">01 MY_RECORD。 05 MY_MBCS_DATA PIC G（51）。
</pre><p>PGAU <code class="codeph">REDEFINE DATA</code>语句可以通过在字段<code class="codeph">SO</code>和<code class="codeph">SI</code>以及<code class="codeph">'05 MY_MBCS_DATA PIC G(51).'</code>上指定<code class="codeph">USAGE(SKIP)</code>来将3字段定义重新定义为1字段定义<code class="codeph">'05 MY_MBCS_DATA PIC G(51).'</code>重新定义<code class="codeph">MY_MBCS_DATA</code> 。三个<code class="codeph">REDEFINE</code>语句可以放在PGAU输入控制文件中，因此不需要更改远程主机定义。
                  </p>
               </div>
            </div><a id="APPUG1048"></a><div class="props_rev_3"><a id="GUID-322345C3-6367-4ADD-A56A-B9B4A13C83FE" name="GUID-322345C3-6367-4ADD-A56A-B9B4A13C83FE"></a><h3 id="APPUG-GUID-322345C3-6367-4ADD-A56A-B9B4A13C83FE" class="sect3">使用TIP所需的权限</h3>
               <div>
                  <p>必须向TIP或过程的调用者显式授予执行权限。无法通过角色授予此权限。</p>
                  <p>任何想要跟踪TIP的TIP用户都必须被授予对rtrace和ptrace过程的执行权限。有关详细信息，请参阅安装指南和<a href="../adfns/security.html#ADFNS230" target="_blank"><span class="italic">Oracle数据库开发指南中</span></a>适用于您的通信协议的“配置PGAU”部分。
                  </p>
                  <p>例如：</p>
                  <p>在Microsoft Windows上：</p><pre class="oac_no_warn" dir="ltr">C：\&gt; sqlplus pgaadmin \ <span class="italic">pw @ database_specification_string</span> SQL&gt;将<span class="italic">pgaadmin.purge_trace</span>上的执行权授予<span class="italic">tip_user_userid</span> ; SQL&gt;将<span class="italic">pgaadmin.read_trace</span>上的执行权限授予<span class="italic">tip_user_userid;</span> 
</pre><p>在基于UNIX的系统上：</p><pre class="oac_no_warn" dir="ltr">$ sqlplus pgaadmin / <span class="italic">pw @ database_specification_string</span> SQL&gt;将<span class="italic">pgaadmin.purge_trace</span>上的执行权授予<span class="italic">tip_user_userid</span> ; SQL&gt;将<span class="italic">pgaadmin.read_trace</span>上的执行权限授予<span class="italic">tip_user_userid;</span> 
</pre><p>在开发TIP之后，必须由TIP所有者授予TIP用户对TIP的执行权限。TIP所有者通常是<code class="codeph">PGAADMIN</code> ，但可以是另一个被授予<code class="codeph">PGDDDEF</code>或<code class="codeph">PGDDGEN</code>角色的用户。例如：</p>
                  <p>对于Microsoft Windows：</p><pre class="oac_no_warn" dir="ltr">C：\&gt; sqlplus tip_owner \ <span class="italic">pw @ database_specification_string</span> SQL&gt;在tipname <span class="italic">上将</span>执行权限授予<span class="italic">tip_user_userid</span> ;</pre><p>对于基于UNIX的系统：</p><pre class="oac_no_warn" dir="ltr">$ sqlplus tip_owner / <span class="italic">pw @ database_specification_string</span> SQL&gt;将<span class="italic">tip命令</span>执行到<span class="italic">tip_user_userid</span> ;</pre><p>哪里<code class="codeph"> </code> <span class="italic"><code class="codeph">database_specification_string</code></span>是<a id="d24694e2801" class="indexterm-anchor"></a>安装了网关<code class="codeph">UTL_RAW</code>和<code class="codeph">UTL_PG</code>组件的Oracle数据库的Oracle Net标识符。这与执行TIP的Oracle数据库相同，并且从TIP所有者用户ID执行TIP上的授权。</p>
                  <p>用于执行这些授权的SQL脚本在Microsoft Windows的<code class="codeph">%ORACLE_HOME%\dg4appc\admin</code>目录和基于UNIX的系统的目录中的<code class="codeph">$ORACLE_HOME/dg4appc/admin</code>中提供。该<a id="d24694e2818" class="indexterm-anchor"></a><a id="d24694e2820" class="indexterm-anchor"></a> <code class="codeph">pgddausr.sql</code>脚本执行授权，以便由单个TIP用户对包进行私有访问。如果要使用私有授权，则必须为每个TIP用户的用户ID运行一次<code class="codeph">pgddausr.sql</code>脚本。</p>
                  <p>要运行这些脚本，请使用SQL * Plus以<code class="codeph">PGAADMIN</code>用户<code class="codeph">PGAADMIN</code>连接到Oracle数据库。从SQL * Plus，在Microsoft Windows上的<code class="codeph">%ORACLE_HOME%\dg4appc\admin</code>目录或基于UNIX的系统上的<code class="codeph">$ORACLE_HOME/dg4appc/admin</code>目录中运行<code class="codeph">pgddausr.sql</code>脚本。该脚本执行必要的授权，如前所述。系统会提示您输入所需的用户标识，密码和数据库规范字符串。如果您使用的是私有授权，请对需要访问软件包的每个用户ID重复此步骤。
                  </p>
                  <p>没有提供脚本来执行公共拨款。为此，请发出以下命令：</p>
                  <p>对于Microsoft Windows：</p><pre class="oac_no_warn" dir="ltr">C：\&gt; sqlplus tip_owner \ <span class="italic">pw @ database_specification_string</span> SQL&gt;将tipname上的execute赋予PUBLIC;</pre><p>对于基于UNIX的系统：</p><pre class="oac_no_warn" dir="ltr">$ sqlplus tip_owner / <span class="italic">pw @ database_specification_string</span> SQL&gt;将tipname上的execute赋予PUBLIC;</pre><p></p>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>