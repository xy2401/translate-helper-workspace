<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="DBMS_HIERARCHY contains subprograms for validating the data in tables used by hierarchies and analytic views."></meta>
      <meta name="description" content="DBMS_HIERARCHY contains subprograms for validating the data in tables used by hierarchies and analytic views."></meta>
      <title>DBMS_HIERARCHY</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="PL/SQL Packages and Types Reference"></meta>
      <meta property="og:description" content="DBMS_HIERARCHY contains subprograms for validating the data in tables used by hierarchies and analytic views."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="PL/SQL Packages and Types Reference"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="database-pl-sql-packages-and-types-reference.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-03-25T11:24:34-07:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96430-03"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="DBMS_HEAT_MAP.html" title="Previous" type="text/html"></link>
      <link rel="next" href="DBMS_HM.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database PL/SQL Packages and Types Reference"></meta>
    <meta name="dcterms.isVersionOf" content="ARPLS"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="DBMS_HEAT_MAP.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="DBMS_HM.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">PL / SQL包和类型参考</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">DBMS_HIERARCHY</li>
            </ol>
            <a id="GUID-BA9CF136-9144-4880-BFF7-67B369E81D62" name="GUID-BA9CF136-9144-4880-BFF7-67B369E81D62"></a>
            
            <h2 id="ARPLS-GUID-BA9CF136-9144-4880-BFF7-67B369E81D62" class="sect2"><span class="enumeration_chapter">78</span> DBMS_HIERARCHY</h2>
         </header>
         <div class="ind">
            <div>
               <p><code class="codeph">DBMS_HIERARCHY</code>包含用于验证层次结构和分析视图使用的表中的数据的子程序。
               </p>
               <div class="section">
                  <p>本章包含以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="DBMS_HIERARCHY.html#GUID-2F0E6688-A9BD-492D-9529-062A178A7740" title="DBMS_HIERARCHY包中包含用于验证数据库表的内容是否适合分析视图或层次结构使用的函数，用于验证验证成功的函数，以及用于创建用于记录验证操作的表的过程。">DBMS_HIERARCHY概述</a></p>
                     </li>
                     <li>
                        <p><a href="DBMS_HIERARCHY.html#GUID-50B11E08-6302-4B48-AC48-C9A16B306A63" title="总结了分析视图和层次结构对象验证的安全注意事项。">DBMS_HIERARCHY安全模型</a></p>
                     </li>
                     <li>
                        <p><a href="DBMS_HIERARCHY.html#GUID-62616CF1-0FE9-43E6-B244-E68DF0AB6DCB" title="此表列出了DBMS_HIERARCHY子程序并简要描述了它们。">DBMS_HIERARCHY子程序摘要</a></p>
                     </li>
                  </ul>
               </div>
               <!-- class="section" -->
            </div>
            <div class="sect2"><a id="GUID-2F0E6688-A9BD-492D-9529-062A178A7740" name="GUID-2F0E6688-A9BD-492D-9529-062A178A7740"></a><h3 id="ARPLS-GUID-2F0E6688-A9BD-492D-9529-062A178A7740" class="sect3"><span class="enumeration_section">78.1</span> DBMS_HIERARCHY概述</h3>
               <div>
                  <p><code class="codeph">DBMS_HIERARCHY</code>包中包含用于验证数据库表的内容是否适合分析视图或层次结构使用的函数，用于验证验证成功的函数，以及用于创建用于记录验证操作的表的过程。
                  </p>
                  <div class="infoboxnote" id="GUID-2F0E6688-A9BD-492D-9529-062A178A7740__GUID-1D0E1D3F-E6FC-4514-BB0E-64412551737F">
                     <p class="notep1">注意：</p>
                     <p>由<code class="codeph">DBMS_HIERARCHY</code>子程序的参数指定的名称区分大小写。
                     </p>
                  </div>
                  <p>有关使用分析视图的信息，请参阅“ <cite><span><cite>Oracle数据库数据仓库指南”</cite></span></cite> 。
                  </p>
               </div>
            </div>
            <div class="sect2"><a id="GUID-50B11E08-6302-4B48-AC48-C9A16B306A63" name="GUID-50B11E08-6302-4B48-AC48-C9A16B306A63"></a><h3 id="ARPLS-GUID-50B11E08-6302-4B48-AC48-C9A16B306A63" class="sect3"><span class="enumeration_section">78.2</span> DBMS_HIERARCHY安全模型</h3>
               <div>
                  <p>总结了分析视图和层次结构对象验证的安全注意事项。</p>
                  <div class="p">此程序包中的所有过程都验证当前用户是否具有指定对象的必要权限，并在未找到这些权限时返回错误。
                     <div class="infoboxnote" id="GUID-50B11E08-6302-4B48-AC48-C9A16B306A63__GUID-59880AF0-FF50-412E-A2D5-00E818201D68">
                        <p class="notep1">注意：</p>要确保用户具有足够的表空间来记录验证操作，请执行以下操作之一：<ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">GRANT</code> <code class="codeph">UNLIMITED</code> <code class="codeph">TABLESPACE</code> <code class="codeph">TO</code> <span class="italic">用户名</span> <code class="codeph">;</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">ALTER</code> <code class="codeph">USERNAME</code> <span class="italic">用户名</span> <code class="codeph">QUOTA</code> <span class="italic">size</span> <code class="codeph">ON</code> <span class="italic">tablespace_name</span> <code class="codeph">;</code></p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <p>使用此程序包需要以下系统特权：</p>
                  <div class="section">
                     <p class="subhead2" id="GUID-50B11E08-6302-4B48-AC48-C9A16B306A63__GUID-011BB182-A29C-4DE3-9CD6-7F1CBBC5F367">要验证用户自己的架构中的对象：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">CREATE_VALIDATE_LOG_TABLE</code> <code class="codeph">CREATE TABLE</code>权限或让<code class="codeph">VALIDATE_ANALTYIC_VIEW</code>或<code class="codeph">VALIDATE_HIERARCHY</code>自动创建表</p>
                        </li>
                        <li>
                           <p>对分析视图或层次结构使用的表或视图的<code class="codeph">SELECT</code>权限</p>
                        </li>
                        <li>
                           <p>对层次结构的属性维度或分析视图使用的事实表使用的表具有<code class="codeph">INSERT</code>特权</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-50B11E08-6302-4B48-AC48-C9A16B306A63__GUID-D2AC7358-11F8-4455-9455-D287105202BB">要验证不同模式中的对象：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">CREATE_VALIDATE_LOG_TABLE</code> <code class="codeph">CREATE ANY TABLE</code>权限或让<code class="codeph">VALIDATE_ANALTYIC_VIEW</code>或<code class="codeph">VALIDATE_HIERARCHY</code>自动创建表</p>
                        </li>
                        <li>
                           <p>对层次结构的属性维度或分析视图使用的事实表使用的表<code class="codeph">INSERT ANY TABLE</code>特权</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
            <div class="sect2"><a id="GUID-62616CF1-0FE9-43E6-B244-E68DF0AB6DCB" name="GUID-62616CF1-0FE9-43E6-B244-E68DF0AB6DCB"></a><h3 id="ARPLS-GUID-62616CF1-0FE9-43E6-B244-E68DF0AB6DCB" class="sect3"><span class="enumeration_section">78.3</span> DBMS_HIERARCHY子程序摘要</h3>
               <div>
                  <p>此表列出了<code class="codeph">DBMS_HIERARCHY</code>子程序并简要描述了它们。
                  </p>
                  <div class="tblformal" id="GUID-62616CF1-0FE9-43E6-B244-E68DF0AB6DCB__GUID-C1C3720F-D6B0-4731-B82D-30518CCDE138">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" border="1" summary="This table lists the DBMS_HIERARCHY subprograms and briefly describes them." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" id="d456910e521">子程序</th>
                              <th align="left" valign="bottom" id="d456910e524">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" id="d456910e529" headers="d456910e521 ">
                                 <p><a href="DBMS_HIERARCHY.html#GUID-F389484F-4870-43E2-B52E-BA7DF9F01CB6" title="此过程创建一个表，您可以使用该表记录VALIDATE_ANALYTIC_VIEW或VALIDATE_HIERARCHY函数生成的消息，该消息验证分析视图或层次结构使用的数据。">CREATE_VALIDATE_LOG_TABLE过程</a></p>
                              </td>
                              <td align="left" valign="top" headers="d456910e529 d456910e524 ">
                                 <p>创建一个表，您可以使用该表记录<code class="codeph">VALIDATE_HIERARCHY</code>和<code class="codeph">VALIDATE_ANALYTIC_VIEW</code>函数生成的消息。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" id="d456910e552" headers="d456910e521 "><a href="DBMS_HIERARCHY.html#GUID-7BE9DCD3-2577-47BC-B8A3-710ECEB23D05" title="此函数验证表或视图中的数据是否符合分析视图定义中固有的逻辑约束。">VALIDATE_ANALYTIC_VIEW函数</a></td>
                              <td align="left" valign="top" headers="d456910e552 d456910e524 ">
                                 <p>验证表中的数据是否适合分析视图使用。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" id="d456910e562" headers="d456910e521 "><a href="DBMS_HIERARCHY.html#GUID-4A926EAC-6167-4C9E-8FD0-92C29A7A8507" title="此函数指示先前对VALIDATE_HIERARCHY或VALIDATE_ANALYTIC_VIEW的调用是成功还是产生验证错误。">VALIDATE_CHECK_SUCCESS函数</a></td>
                              <td align="left" valign="top" headers="d456910e562 d456910e524 ">
                                 <p>指示先前对<code class="codeph">VALIDATE_HIERARCHY</code>或<code class="codeph">VALIDATE_ANALYTIC_VIEW</code>调用是成功还是生成验证错误。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" id="d456910e584" headers="d456910e521 ">
                                 <p><a href="DBMS_HIERARCHY.html#GUID-5D37C07A-F108-4734-9811-A57C82329EDA" title="此函数验证表或视图中的数据是否符合使用表或视图的属性维的定义中固有的逻辑约束以及使用属性维的层次结构。">VALIDATE_HIERARCHY函数</a></p>
                              </td>
                              <td align="left" valign="top" headers="d456910e584 d456910e524 ">
                                 <p>验证表中的数据是否适合层次结构使用。</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
               </div>
               <div class="sect3"><a id="GUID-F389484F-4870-43E2-B52E-BA7DF9F01CB6" name="GUID-F389484F-4870-43E2-B52E-BA7DF9F01CB6"></a><h4 id="ARPLS-GUID-F389484F-4870-43E2-B52E-BA7DF9F01CB6" class="sect4"><span class="enumeration_section">78.3.1</span> CREATE_VALIDATE_LOG_TABLE过程</h4>
                  <div>
                     <p>此过程创建一个表，您可以使用该表记录<code class="codeph">VALIDATE_ANALYTIC_VIEW</code>或<code class="codeph">VALIDATE_HIERARCHY</code>函数生成的消息，该消息验证分析视图或层次结构使用的数据。
                     </p>
                     <div class="section">
                        <p>此过程创建的表具有以下结构。</p><pre class="pre codeblock"><code>NAME是吗？DATATYPE ------------------ -------- -------- LOG_NUMBER NOT NULL NUMBER ACTION_ORDER NOT NULL NUMBER OBJECT_OWNER NOT NULL VARCHAR2（128 BYTE ）OBJECT_NAME NOT NULL VARCHAR2（128 BYTE）ACTION NOT NULL VARCHAR2（10 BYTE）TIME NOT NULL TIMESTAMP（6）ERROR_NUMBER NUMBER ERROR_MESSAGE VARCHAR2（4000）</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-F389484F-4870-43E2-B52E-BA7DF9F01CB6__GUID-FD1C986C-DEFE-480B-A4B8-83EC67A6BF57">句法</p><pre class="pre codeblock"><code>DBMS_HIERARCHY.CREATE_VALIDATE_LOG_TABLE（table_name IN VARCHAR2，owner_name IN VARCHAR2 DEFAULT NULL IGNORE_IF_EXISTS IN PL / SQL BOOLEAN DEFAULT FALSE）;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-F389484F-4870-43E2-B52E-BA7DF9F01CB6__GUID-E302704B-FE94-4BFE-A463-9994F0B08772">参数</p>
                        <div class="tblformal" id="GUID-F389484F-4870-43E2-B52E-BA7DF9F01CB6__GUID-9FE8F368-2E0E-41C4-A00D-9BF0324230A1">
                           <table cellpadding="4" cellspacing="0" class="Formal" title="" border="1" summary="This table lists the parameters of the CREATE_VALIDATE_LOG_TABLE procedure and provides brief descriptions of them." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="20%" id="d456910e719">参数</th>
                                    <th align="left" valign="bottom" width="20%" id="d456910e721">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d456910e725" headers="d456910e719 "><code class="codeph">TABLE_NAME</code></td>
                                    <td align="left" valign="top" width="20%" headers="d456910e725 d456910e721 ">要创建的表的名称。</td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d456910e731" headers="d456910e719 "><code class="codeph">OWNER_NAME</code></td>
                                    <td align="left" valign="top" width="20%" headers="d456910e731 d456910e721 ">要在其中创建表的模式的名称。如果<code class="codeph">owner_name</code>为<code class="codeph">NULL</code> ，则表在当前用户的架构中创建。
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d456910e743" headers="d456910e719 "><code class="codeph">IGNORE_IF_EXISTS</code></td>
                                    <td align="left" valign="top" width="20%" headers="d456910e743 d456910e721 ">一个布尔值，指示是否存在具有相同名称的表时是否创建表。如果指定表，则它必须具有与此过程创建的表相同的结构。</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-F389484F-4870-43E2-B52E-BA7DF9F01CB6__GUID-87900571-2859-4CE5-93A9-DF38B9BF2696">例子</p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-F389484F-4870-43E2-B52E-BA7DF9F01CB6__GUID-55CD4CEE-6068-4F9B-BCEF-75C0264A0A61">
                        <p class="titleinexample">示例78-1创建验证日志表</p><pre class="pre codeblock"><code>BEGIN DBMS_HIERARCHY.CREATE_VALIDATE_LOG_TABLE（'VAL_AV_HIERARCHY_LOG'，'AV_USER'，FALSE）;结束; /</code></pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-7BE9DCD3-2577-47BC-B8A3-710ECEB23D05" name="GUID-7BE9DCD3-2577-47BC-B8A3-710ECEB23D05"></a><h4 id="ARPLS-GUID-7BE9DCD3-2577-47BC-B8A3-710ECEB23D05" class="sect4"><span class="enumeration_section">78.3.2</span> VALIDATE_ANALYTIC_VIEW函数</h4>
                  <div>
                     <p>此函数验证表或视图中的数据是否符合分析视图定义中固有的逻辑约束。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-7BE9DCD3-2577-47BC-B8A3-710ECEB23D05__GUID-5ABBC3B2-F3A1-4494-8324-74B70E867DC3">句法</p><pre class="pre codeblock"><code>DBMS_HIERARCHY.VALIDATE_ANALYTIC_VIEW（analytic_view_name IN VARCHAR2 DEFAULT NULL，analytic_view_owner_name IN VARCHAR2 DEFAULT NULL，log_table_name IN VARCHAR2 DEFAULT NULL，log_table_owner_name IN VARCHAR2 DEFAULT NULL）返回数字;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-7BE9DCD3-2577-47BC-B8A3-710ECEB23D05__GUID-C131D68A-2411-48FB-92C0-E5C60835970A">参数</p>
                        <div class="tblformal" id="GUID-7BE9DCD3-2577-47BC-B8A3-710ECEB23D05__GUID-C52E2F01-3036-4CDA-B509-2EE66B34BB13">
                           <table cellpadding="4" cellspacing="0" class="Formal" title="" border="1" summary="This table lists the parameters of the VALIDATE_ANALYTIC_VIEW function and provides brief descriptions of them." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" id="d456910e867">参数</th>
                                    <th align="left" valign="bottom" id="d456910e869">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" id="d456910e873" headers="d456910e867 "><code class="codeph">analytic_view_name</code></td>
                                    <td align="left" valign="top" headers="d456910e873 d456910e869 ">要验证的分析视图的名称。</td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" id="d456910e879" headers="d456910e867 "><code class="codeph">analytic_view_owner_name</code></td>
                                    <td align="left" valign="top" headers="d456910e879 d456910e869 ">包含分析视图的架构的所有者的名称。</td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" id="d456910e885" headers="d456910e867 "><code class="codeph">log_table_name</code></td>
                                    <td align="left" valign="top" headers="d456910e885 d456910e869 ">验证日志表的名称，用于放置验证操作的结果。</td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" id="d456910e891" headers="d456910e867 "><code class="codeph">log_table_owner_name</code></td>
                                    <td align="left" valign="top" headers="d456910e891 d456910e869 ">存在验证日志表或在其中创建表的模式的所有者的名称。</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-7BE9DCD3-2577-47BC-B8A3-710ECEB23D05__GUID-5D6D8A88-A140-4164-982D-8A6F033EB189">返回</p>
                        <p>验证日志表中验证结果的条目数。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-7BE9DCD3-2577-47BC-B8A3-710ECEB23D05__GUID-5A81C382-CD26-404B-941A-16949C02776A">使用说明</p>
                        <p>如果<code class="codeph">log_table_name</code>参数为<code class="codeph">NULL</code> ，则<code class="codeph">VALIDATE_ANALYTIC_VIEW</code>函数将创建验证日志表。它创建的表的名称是DBMS_HIERARCHY_LOG。</p>
                        <p>验证操作开始时，将使用<code class="codeph">START</code>的操作将一行插入到日志表中。操作完成后，将使用<code class="codeph">END</code>操作将一行插入到日志表中。检测到错误时，将使用<code class="codeph">ERROR</code>的操作将一行插入到日志表中，并填充关联的<code class="codeph">error_number</code>和<code class="codeph">error_message</code>列。插入验证日志表的所有行都包括日志编号和插入时间。
                        </p>
                        <p><code class="codeph">VALIDATE_ANALYTIC_VIEW</code>函数验证分析视图的每个属性维度的以下条件为真：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>在属性维的事实表中找到的键值必须存在于该属性维的星型模式维度表中。</p>
                           </li>
                           <li>
                              <p>对于该维度，属性维度的引用属性值必须在星型模式维度表的所有行中都是唯一的。</p>
                           </li>
                        </ul>
                        <p>此外，对于分析视图中的每个层次结构，该函数都会验证以下条件是否为真：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>级别的主键确定级别的每个属性的唯一值。</p>
                           </li>
                           <li>
                              <p>对于层次结构的属性维度使用的表或视图的每一行， <code class="codeph">NOT</code> <code class="codeph">NULL</code>级别的每个级别键列（包括备用键）的<code class="codeph">NULL</code>都是非<code class="codeph">NULL</code> 。</p>
                           </li>
                           <li>
                              <p>对于表或视图的每一行， <code class="codeph">SKIP</code> <code class="codeph">WHEN</code> <code class="codeph">NULL</code>级别的所有级别键列和备用键列必须为<code class="codeph">NULL</code>或者它们都必须为非<code class="codeph">NULL</code> 。这将验证备用级别键是否由级别键确定。
                              </p>
                           </li>
                           <li>
                              <p>对于具有相同级别的备用键列值的每组行，键列值必须具有相同的列值。这将验证级别密钥是由备用级别密钥确定的，备用级别密钥是备用密钥所必需的。</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-7BE9DCD3-2577-47BC-B8A3-710ECEB23D05__GUID-1DC15C59-72F7-48D3-9D21-33C429EC627C">例子</p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-7BE9DCD3-2577-47BC-B8A3-710ECEB23D05__GUID-92311EC3-595D-4A02-AF1E-B90951333577">
                        <p class="titleinexample">示例78-2验证分析视图</p><pre class="pre codeblock"><code>DECLARE log_num NUMBER; obj_name VARCHAR2（8）：='SALES_AV'; BEGIN log_num：= DBMS_HIERARCHY.VALIDATE_ANALYTIC_VIEW（obj_name）;结束; /</code></pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-4A926EAC-6167-4C9E-8FD0-92C29A7A8507" name="GUID-4A926EAC-6167-4C9E-8FD0-92C29A7A8507"></a><h4 id="ARPLS-GUID-4A926EAC-6167-4C9E-8FD0-92C29A7A8507" class="sect4"><span class="enumeration_section">78.3.3</span> VALIDATE_CHECK_SUCCESS函数</h4>
                  <div>
                     <p>此函数指示先前对<code class="codeph">VALIDATE_HIERARCHY</code>或<code class="codeph">VALIDATE_ANALYTIC_VIEW</code>调用是成功还是产生验证错误。
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-4A926EAC-6167-4C9E-8FD0-92C29A7A8507__GUID-3096336B-A404-445A-B0E0-EC731C35ABD5">句法</p><pre class="pre codeblock"><code>DBMS_HIERARCHY.VALIDATE_CHECK_SUCCESS（VARCHAR2中的TOPOBJ_NAME，VARCHAR2中的TOPOBJ_OWNER，VARCHAR2 LOG_TABLE_NAME中的LOG_NUMBER，VARCHAR2中的VARCHAR2 LOG_TABLE_OWNER_NAME）RETURN VARCHAR2;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-4A926EAC-6167-4C9E-8FD0-92C29A7A8507__GUID-31671532-EFF1-49AF-BE58-E8DAFECF6331">参数</p>
                        <div class="tblformal" id="GUID-4A926EAC-6167-4C9E-8FD0-92C29A7A8507__GUID-AA5D8056-C1E7-4DD6-84F1-755782D462A7">
                           <table cellpadding="4" cellspacing="0" class="Formal" title="" border="1" summary="This table describes the parameters of this function." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" id="d456910e1111">参数</th>
                                    <th align="left" valign="bottom" id="d456910e1113">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" id="d456910e1117" headers="d456910e1111 "><code class="codeph">TOPOBJ_NAME</code></td>
                                    <td align="left" valign="top" headers="d456910e1117 d456910e1113 ">层次结构或分析视图的名称。</td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" id="d456910e1123" headers="d456910e1111 "><code class="codeph">TOPOBJ_OWNDER</code></td>
                                    <td align="left" valign="top" headers="d456910e1123 d456910e1113 ">层次结构或分析视图的所有者。</td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" id="d456910e1129" headers="d456910e1111 "><code class="codeph">LOG_NUMBER</code></td>
                                    <td align="left" valign="top" headers="d456910e1129 d456910e1113 ">日志条目的编号。</td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" id="d456910e1135" headers="d456910e1111 "><code class="codeph">LOG_TABLE_NAME</code></td>
                                    <td align="left" valign="top" headers="d456910e1135 d456910e1113 ">日志表的名称。</td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" id="d456910e1141" headers="d456910e1111 "><code class="codeph">LOG_TABLE_OWNER_NAME</code></td>
                                    <td align="left" valign="top" headers="d456910e1141 d456910e1113 ">表退出的模式的名称。</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-4A926EAC-6167-4C9E-8FD0-92C29A7A8507__GUID-F94CB710-30C4-46A4-AA5F-9CC1AF761144">返回</p>
                        <p><code class="codeph">VARCHAR2</code> ，如果没有发生错误，则为SUCCESS;如果发生错误，则为ERROR。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-4A926EAC-6167-4C9E-8FD0-92C29A7A8507__GUID-83D5ACD6-F805-4442-B456-3213D907D917">例子</p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-4A926EAC-6167-4C9E-8FD0-92C29A7A8507__GUID-0ECBA806-07A2-4391-AC39-EB8A1922EEDB">
                        <p class="titleinexample">示例78-3使用VALIDATE_CHECK_SUCCESS</p>
                        <p>此示例确定先前对<code class="codeph">VALIDATE_ANALTYIC_VIEW</code>调用是否遇到错误。
                        </p><pre class="pre codeblock"><code>DECLARE log_num NUMBER; succ VARCHAR2（7）; obj_name VARCHAR2（8）：='SALES_AV'; BEGIN log_num：= dbms_hierarchy.validate_analytic_view（obj_name）; succ：= dbms_hierarchy.validate_check_success（topobj_name =&gt; obj_name，log_number =&gt; log_num）;如果（succ！='SUCCESS'）那么RAISE_APPLICATION_ERROR（num =&gt; -20000，msg =&gt;'验证失败！“）;万一;结束; /</code></pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-5D37C07A-F108-4734-9811-A57C82329EDA" name="GUID-5D37C07A-F108-4734-9811-A57C82329EDA"></a><h4 id="ARPLS-GUID-5D37C07A-F108-4734-9811-A57C82329EDA" class="sect4"><span class="enumeration_section">78.3.4</span> VALIDATE_HIERARCHY函数</h4>
                  <div>
                     <p>此函数验证表或视图中的数据是否符合使用表或视图的属性维的定义中固有的逻辑约束以及使用属性维的层次结构。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-5D37C07A-F108-4734-9811-A57C82329EDA__GUID-7AAB0A63-2BC0-4E81-A50D-D6108B1523ED">句法</p><pre class="pre codeblock"><code>DBMS_HIERARCHY.VALIDATE_HIERARCHY（hier_name IN VARCHAR2，hier_owner_name IN VARCHAR2 DEFAULT NULL，log_table_name IN VARCHAR2 DEFAULT NULL，log_table_owner_name IN VARCHAR2 DEFAULT NULL）返回数字;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-5D37C07A-F108-4734-9811-A57C82329EDA__GUID-0F4FC13D-6714-47A1-ACBF-F73DB1F59F0A">参数</p>
                        <div class="tblformal" id="GUID-5D37C07A-F108-4734-9811-A57C82329EDA__GUID-059A6A6F-AD86-4B91-BFC7-AA1EA7E31B0C">
                           <table cellpadding="4" cellspacing="0" class="Formal" title="" border="1" summary="This table lists the parameters of the VALIDATE_HIERARCHY function and provides brief descriptions of them." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="20%" id="d456910e1277">参数</th>
                                    <th align="left" valign="bottom" width="20%" id="d456910e1279">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d456910e1283" headers="d456910e1277 "><code class="codeph">hier_name</code></td>
                                    <td align="left" valign="top" width="20%" headers="d456910e1283 d456910e1279 ">要验证的层次结构的名称。</td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d456910e1289" headers="d456910e1277 "><code class="codeph">hier_owner_name</code></td>
                                    <td align="left" valign="top" width="20%" headers="d456910e1289 d456910e1279 ">包含层次结构的架构的所有者的名称。</td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d456910e1295" headers="d456910e1277 "><code class="codeph">log_table_name</code></td>
                                    <td align="left" valign="top" width="20%" headers="d456910e1295 d456910e1279 ">验证日志表的名称，用于放置验证操作的结果。</td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d456910e1301" headers="d456910e1277 "><code class="codeph">log_table_owner_name</code></td>
                                    <td align="left" valign="top" width="20%" headers="d456910e1301 d456910e1279 ">存在验证日志表或在其中创建表的模式的所有者的名称。</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-5D37C07A-F108-4734-9811-A57C82329EDA__GUID-8EFDF1F8-1E76-482A-BA64-95BA13C7E29C">返回</p>
                        <p>验证日志表中验证结果的条目数。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-5D37C07A-F108-4734-9811-A57C82329EDA__GUID-744A7245-424D-4299-ADC4-46213AD2E439">使用说明</p>
                        <p>如果<code class="codeph">log_table_name</code>参数为<code class="codeph">NULL</code> ，则<code class="codeph">VALIDATE_HIERARCHY</code>函数将创建验证日志表。它创建的表的名称是DBMS_HIERARCHY_LOG。</p>
                        <p>验证操作开始时，将使用<code class="codeph">START</code>的操作将一行插入到日志表中。操作完成后，将使用<code class="codeph">END</code>操作将一行插入到日志表中。检测到错误时，将使用<code class="codeph">ERROR</code>的操作将一行插入到日志表中，并填充关联的<code class="codeph">error_number</code>和<code class="codeph">error_message</code>列。插入验证日志表的所有行都包括日志编号和插入时间。
                        </p>
                        <p><code class="codeph">VALIDATE_HIERARCHY</code>函数验证层次结构的以下条件是否为真：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>级别的主键确定级别的每个属性的唯一值。</p>
                           </li>
                           <li>
                              <p>对于层次结构的属性维度使用的表或视图的每一行， <code class="codeph">NOT</code> <code class="codeph">NULL</code>级别的每个级别键列（包括备用键）的<code class="codeph">NULL</code>都是非<code class="codeph">NULL</code> 。</p>
                           </li>
                           <li>
                              <p>对于表或视图的每一行， <code class="codeph">SKIP</code> <code class="codeph">WHEN</code> <code class="codeph">NULL</code>级别的所有级别键列和备用键列必须为<code class="codeph">NULL</code>或者它们都必须为非<code class="codeph">NULL</code> 。这将验证备用级别键是否由级别键确定。
                              </p>
                           </li>
                           <li>
                              <p>对于具有相同级别的备用键列值的每组行，键列值必须具有相同的列值。这将验证级别密钥是由备用级别密钥确定的，备用级别密钥是备用密钥所必需的。</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-5D37C07A-F108-4734-9811-A57C82329EDA__GUID-11689279-F4C1-45AE-BC03-F7B68BB8F1C2">例子</p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-5D37C07A-F108-4734-9811-A57C82329EDA__GUID-F8DA18EE-6B2C-4387-B612-24AE05873FD1">
                        <p class="titleinexample">示例78-4验证层次结构并指定表名称</p>
                        <p>此示例验证<code class="codeph">PRODUCT_HIER</code>层次结构，并指定将结果插入名为<code class="codeph">VAL_AV_HIERARCHY_LOG</code>的表中。层次结构的所有者和包含该表的架构的所有者是AV_USER。</p><pre class="pre codeblock"><code>- 创建日志表。BEGIN DBMS_HIERARCHY.CREATE_VALIDATE_LOG_TABLE（'VAL_AV_HIERARCHY_LOG'，'AV_USER'，FALSE）;结束; /  - 验证层次结构。DECLARE log_num NUMBER; obj_name VARCHAR2（12）：='PRODUCT_HIER'; table_name VARCHAR2（28）：='VAL_AV_HIERARCHY_LOG'; BEGIN log_num：= DBMS_HIERARCHY.VALIDATE_HIERARCHY（obj_name，'AV_USER'，table_name）;结束; /</code></pre><p>查询日志表。</p><pre class="pre codeblock"><code>从AV_USER.VAL_AV_HIERARCHY_LOG中选择LOG_NUMBER，ACTION，OBJECT_NAME，ERROR_NUMBER，ERROR_MESSAGE; WHERE OBJECT_NAME ='PRODUCT_HIER'; LOG_NUMBER ACTION OBJECT_NAME ERROR_NUMBER ERROR_MESSAGE ---------- ---------- ------------------- ------ ------ ------------- 1 START PRODUCT_HIER 1 END PRODUCT_HIER</code></pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-5D37C07A-F108-4734-9811-A57C82329EDA__GUID-B8273684-51D1-4535-8308-7E61461580C9">
                        <p class="titleinexample">示例78-5在不指定表名的情况下验证层次结构</p>
                        <p>此示例显示如果未指定验证日志表，则<code class="codeph">VALIDATE_HIERARCHY</code>函数将创建一个名为DBMS_HIERARCHY_LOG的函数。</p><pre class="pre codeblock"><code>DECLARE log_num NUMBER; obj_name VARCHAR2（12）：='PRODUCT_HIER'; BEGIN log_num：= DBMS_HIERARCHY.VALIDATE_HIERARCHY（obj_name）;结束;</code></pre><p>查询日志表。</p><pre class="pre codeblock"><code>SELECT LOG_NUMBER，ACTION，OBJECT_NAME，ERROR_NUMBER，ERROR_MESSAGE来自DBMS_HIERARCHY_LOG WHERE OBJECT_NAME ='PRODUCT_HIER'; LOG_NUMBER ACTION OBJECT_NAME ERROR_NUMBER ERROR_MESSAGE ---------- ---------- ------------------- ------ ------ ------------- 1 START PRODUCT_HIER 1 END PRODUCT_HIER</code></pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>