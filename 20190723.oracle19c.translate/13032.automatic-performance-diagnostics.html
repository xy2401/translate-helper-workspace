<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>自动性能诊断</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Database Performance Tuning Guide"></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Database Performance Tuning Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="database-performance-tuning-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-03-12T22:26:14-07:00"></meta>
      <meta name="dcterms.title" content="Database Performance Tuning Guide"></meta>
      <meta name="dcterms.dateCopyrighted" content="2007, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96347-03"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="gathering-database-statistics.html" title="Previous" type="text/html"></link>
      <link rel="next" href="comparing-database-performance-over-time.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="TGDBA"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="gathering-database-statistics.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="comparing-database-performance-over-time.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">数据库性能调优指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="part-II-diagnosing-and-tuning-database-performance.html" property="item" typeof="WebPage"><span property="name">诊断和调整数据库性能</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">自动性能诊断</li>
            </ol>
            <a id="GUID-843A596D-2D8B-422D-9C8D-73C0EF52739D" name="GUID-843A596D-2D8B-422D-9C8D-73C0EF52739D"></a><a id="TGDBA026"></a>
            
            <h2 id="TGDBA-GUID-843A596D-2D8B-422D-9C8D-73C0EF52739D" class="sect2"><span class="enumeration_chapter">7</span>自动性能诊断</h2>
         </header>
         <div class="ind">
            <div>
               <p>本章介绍用于性能诊断和调优的Oracle数据库自动功能。</p>
               <p>本章包含以下主题：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="automatic-performance-diagnostics.html#GUID-F1FBA929-4FCF-4872-AEE6-2DF716B5BD43" title="从Oracle Database 12c开始，默认情况下在多租户容器数据库（CDB）的根容器中启用ADDM。从Oracle Database 19c开始，您还可以在可插拔数据库（PDB）中使用ADDM。默认情况下，ADDM在可插拔数据库（PDB）中不起作用，因为默认情况下在PDB中禁用自动AWR快照。要在PDB中使用ADDM，必须通过将AWR_PDB_AUTOFLUSH_ENABLED初始化参数设置为TRUE且AWR快照间隔大于0来在PDB中启用自动AWR快照。">自动数据库诊断监视器概述</a></p>
                  </li>
                  <li>
                     <p><a href="automatic-performance-diagnostics.html#GUID-19D504B9-B4E4-4FBF-B0D2-F758B467FEDD">设置ADDM</a></p>
                  </li>
                  <li>
                     <p><a href="automatic-performance-diagnostics.html#GUID-AEE549F3-DDF9-4977-8A0A-FE1E47C75679">使用ADDM诊断数据库性能问题</a></p>
                  </li>
                  <li>
                     <p><a href="automatic-performance-diagnostics.html#GUID-914A7E7C-FD5F-4F24-93AA-9E98578EB129">ADDM视图</a></p>
                  </li>
               </ul>
               <div class="infoboxnotealso" id="GUID-843A596D-2D8B-422D-9C8D-73C0EF52739D__GUID-7C5438DD-C87F-4C91-ADF3-99690F5980DF">
                  <p class="notep1">也可以看看：</p>
                  <p><a href="../tdppt/automatic-database-performance-monitoring.html#TDPPT020" target="_blank"><span class="italic">Oracle数据库2天+性能调整指南</span></a> ，了解有关使用Oracle Enterprise Manager云控制（云控制）使用自动数据库诊断监视器诊断和调整数据库的信息</p>
               </div>
            </div><a id="TGDBA02602"></a><div class="props_rev_3"><a id="GUID-F1FBA929-4FCF-4872-AEE6-2DF716B5BD43" name="GUID-F1FBA929-4FCF-4872-AEE6-2DF716B5BD43"></a><h3 id="TGDBA-GUID-F1FBA929-4FCF-4872-AEE6-2DF716B5BD43" class="sect3"><span class="enumeration_section">7.1</span>自动数据库诊断监视器概述</h3>
               <div>
                  <p>自动工作负载存储库（AWR）存储Oracle数据库的性能相关静态。自动数据库诊断监视器（ADDM）是一种诊断工具，可定期分析AWR数据，查找任何性能问题的根本原因，提供纠正问题的建议，并识别系统的非问题区域。由于AWR是历史性能数据的存储库，因此ADDM可以在事件发生后分析性能问题，通常可以节省时间和资源来重现问题。</p>
                  <p>在大多数情况下，ADDM输出应该是DBA在收到性能问题通知时的第一个位置。ADDM具有以下优点：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>默认情况下每小时自动执行一次性能诊断</p>
                     </li>
                     <li>
                        <p>基于数十年调整专业知识的问题诊断</p>
                     </li>
                     <li>
                        <p>基于时间的问题影响和推荐效益量化</p>
                     </li>
                     <li>
                        <p>鉴别根本原因，而不是症状</p>
                     </li>
                     <li>
                        <p>处理问题根源的建议</p>
                     </li>
                     <li>
                        <p>识别系统的非问题区域</p>
                     </li>
                     <li>
                        <p>诊断过程中系统的最小开销</p>
                     </li>
                  </ul>
                  <p>调整是一个迭代过程，修复一个问题可能会导致瓶颈转移到系统的另一部分。即使具有ADDM分析的优势，也可能需要多个调整周期才能达到可接受的系统性能。ADDM的优势适用于生产系统之外;在开发和测试系统上，ADDM可以提供性能问题的早期预警。</p>
                  <p>本节包含以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="automatic-performance-diagnostics.html#GUID-0C89C9A5-A9EE-4E65-95F8-208C9EA36743">ADDM分析</a></p>
                     </li>
                     <li>
                        <p><a href="automatic-performance-diagnostics.html#GUID-8ACD5F59-CFED-4F2A-8284-D969E9E22335">将ADDM与Oracle Real Application Clusters一起使用</a></p>
                     </li>
                     <li>
                        <p><a href="automatic-performance-diagnostics.html#GUID-B4B0899D-90A3-4E19-8654-1D5C34A48FD5" title="从Oracle Database 12c开始，默认情况下在多租户容器数据库（CDB）的根容器中启用ADDM。从Oracle Database 19c开始，您还可以在可插拔数据库（PDB）中使用ADDM。">在多租户环境中使用ADDM</a></p>
                     </li>
                     <li>
                        <p><a href="automatic-performance-diagnostics.html#GUID-9DD81F99-3B4D-4340-9F19-30E5B47DC41D">实时ADDM分析</a></p>
                     </li>
                     <li>
                        <p><a href="automatic-performance-diagnostics.html#GUID-824AA656-C199-437D-926B-A8F05590A65C">ADDM分析结果</a></p>
                     </li>
                     <li>
                        <p><a href="automatic-performance-diagnostics.html#GUID-DCD9B583-0059-492C-A801-0A551C9CE5F8">查看ADDM分析结果：示例</a></p>
                     </li>
                  </ul>
                  <div class="infoboxnote" id="GUID-F1FBA929-4FCF-4872-AEE6-2DF716B5BD43__GUID-C40BBFE1-3E0D-4ACD-8CDD-DA6EA621883C">
                     <p class="notep1">注意：</p>
                     <p>将ADDM功能与可插拔数据库（PDB）一起使用时，数据可见性和权限要求可能会有所不同。有关可管理性功能（包括ADDM功能）如何在多租户容器数据库（CDB）中工作的信息，请参阅<a href="../multi/administering-a-cdb-with-sql-plus.html#MULTI-GUID-DF42C0D3-8968-4810-9327-9D176337D356" target="_blank"><span class="italic">Oracle Multitenant管理员指南</span></a> 。
                     </p>
                  </div>
               </div><a id="TGDBA94240"></a><div class="props_rev_3"><a id="GUID-0C89C9A5-A9EE-4E65-95F8-208C9EA36743" name="GUID-0C89C9A5-A9EE-4E65-95F8-208C9EA36743"></a><h4 id="TGDBA-GUID-0C89C9A5-A9EE-4E65-95F8-208C9EA36743" class="sect4"><span class="enumeration_section">7.1.1</span> ADDM分析</h4>
                  <div>
                     <p>可以对一对AWR快照和来自同一数据库的一组实例执行ADDM分析。这对AWR快照定义分析的时间段，实例集定义分析目标。</p>
                     <p>如果您使用的是Oracle Real Application Clusters（Oracle RAC），那么ADDM有三种分析模式：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>数据库</p>
                           <p>在数据库模式下，ADDM会分析数据库的所有实例。</p>
                        </li>
                        <li>
                           <p>例</p>
                           <p>在实例模式下，ADDM分析数据库的特定实例。</p>
                        </li>
                        <li>
                           <p>局部</p>
                           <p>在“部分”模式下，ADDM分析所有数据库实例的子集。</p>
                        </li>
                     </ul>
                     <p>如果您不使用Oracle RAC，则ADDM只能在实例模式下运行，因为只存在一个数据库实例。</p>
                     <p>每次拍摄AWR快照并将结果保存在数据库中时，都会执行ADDM分析。ADDM分析的时间段由最后两个快照（默认为最后一个小时）定义。ADDM将始终在“实例”模式下分析指定的实例。对于非Oracle RAC或单实例环境，在实例模式下执行的分析与数据库范围的分析相同。如果您使用的是Oracle RAC，则ADDM还会在数据库模式下分析整个数据库，如<span class="q">“ <a href="automatic-performance-diagnostics.html#GUID-8ACD5F59-CFED-4F2A-8284-D969E9E22335">将ADDM与Oracle Real Application Clusters一起使用</a> ”中所述</span> 。
                     </p>
                     <p>ADDM完成分析后，您可以使用Cloud Control或<code class="codeph">DBMS_ADDM</code>程序<code class="codeph">DBMS_ADDM</code>程序或<code class="codeph">DBA_ADDM_*</code>和<code class="codeph">DBA_ADVISOR_*</code>视图查看ADDM结果。
                     </p>
                     <p>自顶向下进行ADDM分析，首先识别症状，然后对其进行细化以找出性能问题的根本原因。分析的目标是减少单个吞吐量<a id="d19268e302" class="indexterm-anchor"></a>度量称为<code class="codeph">DB</code> <code class="codeph">time</code> 。<code class="codeph">DB</code> <code class="codeph">time</code>是数据库性能的基本衡量指标，是数据库处理用户请求所花费的累积时间。它包括所有非空闲用户前台会话的等待时间和CPU时间。<code class="codeph">DB</code> <code class="codeph">time</code>显示在<code class="codeph">V$SESS_TIME_MODEL</code>和<code class="codeph">V$SYS_TIME_MODEL</code>视图中。
                     </p>
                     <p><a id="d19268e333" class="indexterm-anchor"></a>通过减少<code class="codeph">DB</code> <code class="codeph">time</code> ，数据库能够使用相同的资源支持更多用户请求，从而提高吞吐量。ADDM报告的问题按其负责的<code class="codeph">DB</code> <code class="codeph">time</code>量排序。不负责大部分<code class="codeph">DB</code> <code class="codeph">time</code>系统区域被报告为非问题区域。
                     </p>
                     <p><a id="d19268e358" class="indexterm-anchor"></a> ADDM考虑的问题类型包括：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>CPU瓶颈 - 系统CPU是否受Oracle数据库或其他应用程序的约束？</p>
                        </li>
                        <li>
                           <p>小型内存结构 -  Oracle数据库内存结构（例如SGA，PGA和缓冲区缓存）是否足够大？</p>
                        </li>
                        <li>
                           <p>I / O容量问题 -  I / O子系统是否按预期运行？</p>
                        </li>
                        <li>
                           <p>高负载SQL语句 - 是否存在消耗过多系统资源的SQL语句？</p>
                        </li>
                        <li>
                           <p>高负载PL / SQL执行和编译，以及高负载的Java使用</p>
                        </li>
                        <li>
                           <p>Oracle RAC特定问题 - 什么是全局缓存热块和对象;是否有任何互连延迟问题？</p>
                        </li>
                        <li>
                           <p>应用程序对Oracle数据库的次优使用 - 是否存在连接管理不良，解析过多或应用程序级锁争用问题？</p>
                        </li>
                        <li>
                           <p>数据库配置问题 - 是否存在日志文件大小调整，归档问题，过多检查点或次优参数设置的证据？</p>
                        </li>
                        <li>
                           <p>并发问题 - 是否存在缓冲区繁忙问题？</p>
                        </li>
                        <li>
                           <p>各种问题领域的热门对象和热门SQL</p>
                        </li>
                     </ul>
                     <div class="infoboxnote" id="GUID-0C89C9A5-A9EE-4E65-95F8-208C9EA36743__GUID-3542A93D-ECC0-4F4B-A19B-1224454CCFDE">
                        <p class="notep1">注意：</p>
                        <p>这不是ADDM在其分析中考虑的所有问题类型的完整列表。</p>
                     </div>
                     <p>ADDM还记录了系统的非问题区域。例如，在早期阶段识别并且从调整考虑中移除不会显着影响系统性能的等待事件类，从而节省将花费在不影响整体系统性能的项目上的时间和精力。</p>
                     <div class="infoboxnotealso" id="GUID-0C89C9A5-A9EE-4E65-95F8-208C9EA36743__GUID-1F6C4CE9-1BEF-487B-8DAA-5C08C7FB1342">
                        <p class="notep1">也可以看看：</p>
                        <ul id="GUID-0C89C9A5-A9EE-4E65-95F8-208C9EA36743__UL_UHM_G4R_3GB" style="list-style-type:disc">
                           <li>
                              <p>有关<code class="codeph">V$SESS_TIME_MODEL</code>和<code class="codeph">V$SYS_TIME_MODEL</code>视图的信息，请<a href="../refrn/V-SESS_TIME_MODEL.html#REFRN30340" target="_blank"><span class="italic">参见Oracle数据库参考</span></a></p>
                           </li>
                           <li>
                              <p><span class="q">“ <a href="measuring-database-performance.html#GUID-BC858042-CD71-4717-A614-C0B0A4FE6F2D">时间模型统计</a> ”</span>用于讨论时间模型统计和<code class="codeph">DB</code> <code class="codeph">time</code></p>
                           </li>
                           <li>
                              <p>有关服务器进程的信息，请参阅<a href="../cncpt/process-architecture.html#CNCPT008" target="_blank"><span class="italic">Oracle Database Concepts</span></a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="TGDBA94241"></a><div class="props_rev_3"><a id="GUID-8ACD5F59-CFED-4F2A-8284-D969E9E22335" name="GUID-8ACD5F59-CFED-4F2A-8284-D969E9E22335"></a><h4 id="TGDBA-GUID-8ACD5F59-CFED-4F2A-8284-D969E9E22335" class="sect4"><span class="enumeration_section">7.1.2</span>将ADDM与Oracle Real Application Clusters一起使用</h4>
                  <div>
                     <p>如果您使用的是Oracle RAC，请在数据库分析模式下运行ADDM以分析数据库的所有实例的吞吐量性能。在数据库模式下，ADDM将DB时间视为所有数据库实例的数据库时间总和。使用数据库分析模式，您可以在单个报告中查看对整个数据库有意义的所有发现，而不是为每个实例查看单独的报告。</p>
                     <p>数据库模式报告包括有关数据库资源（例如I / O和互连）的发现。如果报告对整个数据库具有重要意义，该报告还汇总了各种实例的结果。例如，如果单个实例上的CPU负载足够高以影响整个数据库，则查找将显示在数据库模式分析中，该分析指向负责该问题的特定实例。</p>
                     <div class="infoboxnotealso" id="GUID-8ACD5F59-CFED-4F2A-8284-D969E9E22335__GUID-9952D424-4565-41EE-9003-5063A7A607A1">
                        <p class="notep1">也可以看看：</p>
                        <p>有关将ADDM与Oracle RAC一起使用的信息，请参见<a href="../racad/monitoring-performance.html#RACAD-GUID-42E1B55A-4685-4CED-98CA-1BB576650D1A" target="_blank"><span class="italic">“Oracle Real Application Clusters管理和部署指南”</span></a></p>
                     </div>
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-B4B0899D-90A3-4E19-8654-1D5C34A48FD5" name="GUID-B4B0899D-90A3-4E19-8654-1D5C34A48FD5"></a><h4 id="TGDBA-GUID-B4B0899D-90A3-4E19-8654-1D5C34A48FD5" class="sect4"><span class="enumeration_section">7.1.3</span>在多租户环境中使用ADDM</h4>
                  <div>
                     <p>从Oracle Database 12c开始，默认情况下在多租户容器数据库（CDB）的根容器中启用ADDM。从Oracle Database 19c开始，您还可以在可插拔数据库（PDB）中使用ADDM。</p>
                     <div class="section">
                        <p>在CDB中，ADDM的工作方式与在非CDB中工作的方式相同，也就是说，每次在CDB根或PDB上执行AWR快照时都会执行ADDM分析，并且ADDM结果存储在CDB根或PDB上。拍摄快照的同一数据库系统。ADDM分析的时间段由最后两个快照（默认为最后一个小时）定义。</p>
                        <p>ADDM完成分析后，您可以使用以下任一方法查看ADDM结果：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>使用企业管理器云控制（云控制）</p>
                           </li>
                           <li>
                              <p>使用<code class="codeph">DBA_ADDM_*</code>和<code class="codeph">DBA_ADVISOR_*</code>视图</p>
                           </li>
                        </ul>
                        <div class="infoboxnote" id="GUID-B4B0899D-90A3-4E19-8654-1D5C34A48FD5__GUID-B6B811FC-9517-4045-BEAC-E44FC7B9B380">
                           <p class="notep1">注意：</p>
                           <ul id="GUID-B4B0899D-90A3-4E19-8654-1D5C34A48FD5__UL_KJX_XP4_JGB" style="list-style-type:disc">
                              <li>默认情况下，在CDB根目录中启用ADDM。</li>
                              <li>默认情况下，ADDM在PDB中不起作用，因为PDB中默认禁用自动AWR快照。要在PDB中使用ADDM，必须在PDB中启用自动AWR快照。</li>
                              <li>当前容器为CDB根的用户可以查看整个CDB的ADDM结果。 ADDM结果可包括有关多个PDB的信息。如果PDB未插入，则不包括与PDB相关的ADDM结果。当前容器是PDB时，无法查看存储在CDB根目录中的ADDM结果。</li>
                              <li>PDB上的ADDM结果仅提供PDB特定的发现和建议。当前容器是PDB的用户只能查看当前PDB的ADDM结果。ADDM结果排除了适用于CDB整体的发现，例如，与缓冲区高速缓存大小相关的I / O问题。</li>
                              <li>在PDB上启用AWR快照不会更改CDB根目录上的ADDM报告。</li>
                              <li>无法从CDB根访问PDB上的AWR数据。</li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-B4B0899D-90A3-4E19-8654-1D5C34A48FD5__GUID-188AF643-808E-4966-AB84-BA9EE1340262">PDB级ADDM限制</p>
                        <p>与非CDB不同，ADDM不会在PDB中报告以下问题，因为这些问题适用于CDB整体而不适用于单个PDB：</p>
                        <ul id="GUID-B4B0899D-90A3-4E19-8654-1D5C34A48FD5__UL_UM1_X24_JGB" style="list-style-type:disc">
                           <li>
                              <p>I / O问题归因于：</p>
                              <ul id="GUID-B4B0899D-90A3-4E19-8654-1D5C34A48FD5__UL_HRX_DM4_JGB" style="list-style-type:disc">
                                 <li>尺寸过小的缓冲区缓存</li>
                                 <li>矮小的溪流池</li>
                                 <li>过多的临时写入</li>
                                 <li>过多的检查点写道</li>
                                 <li>过度的撤销写入</li>
                                 <li>过多的PQ检查点写入</li>
                                 <li>过多的截断写入</li>
                                 <li>过多的表空间DDL检查点</li>
                                 <li>I / O容量限制</li>
                              </ul>
                           </li>
                           <li>
                              <p>由于以下原因导致的SQL难解析问题：</p>
                              <ul id="GUID-B4B0899D-90A3-4E19-8654-1D5C34A48FD5__UL_GQF_QM4_JGB" style="list-style-type:disc">
                                 <li>光标老化</li>
                                 <li>内存不足解析</li>
                              </ul>
                           </li>
                           <li>
                              <p>SGA规模问题</p>
                           </li>
                        </ul>
                        <p>ADDM也不会在PDB中报告以下问题，因为这些问题无法在PDB级别解决：</p>
                        <ul id="GUID-B4B0899D-90A3-4E19-8654-1D5C34A48FD5__UL_VM1_X24_JGB" style="list-style-type:disc">
                           <li>
                              <p>群集消息传递相关的问题，例如网络延迟，拥塞，争用和丢失的块</p>
                           </li>
                           <li>
                              <p>日志文件开关等待归档和检查点不完整</p>
                           </li>
                           <li>
                              <p>太多的空闲缓冲区等待</p>
                           </li>
                           <li>
                              <p>日志缓冲区上的争用等待</p>
                           </li>
                           <li>
                              <p>由于CPU瓶颈而等待</p>
                           </li>
                           <li>
                              <p>操作系统VM分页</p>
                           </li>
                           <li>
                              <p>会话槽等待事件</p>
                           </li>
                           <li>
                              <p>CPU量子等待事件</p>
                           </li>
                           <li>
                              <p>与RMAN相关的等待事件，例如PQ排队等待事件，PGA限制等待事件和I / O队列等待事件</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-B4B0899D-90A3-4E19-8654-1D5C34A48FD5__GUID-C9D0AA36-7691-4DE2-B757-FD842DBAF217">
                           <p class="notep1">也可以看看：</p>
                           <ul id="GUID-B4B0899D-90A3-4E19-8654-1D5C34A48FD5__UL_JDP_V24_JGB" style="list-style-type:disc">
                              <li>
                                 <p><span class="q">“ <a href="automatic-performance-diagnostics.html#GUID-5A4F4896-6F95-461F-84E3-8E40F6036752" title="默认情况下，ADDM在可插拔数据库（PDB）中不起作用，因为默认情况下在PDB中禁用自动AWR快照。要在PDB中使用ADDM，必须通过将AWR_PDB_AUTOFLUSH_ENABLED初始化参数设置为TRUE且AWR快照间隔大于0来在PDB中启用自动AWR快照。">在可插拔数据库中启用ADDM</a> ”，</span>以获取有关如何在PDB中启用ADDM的信息</p>
                              </li>
                              <li>
                                 <p>有关ADDM视图<code class="codeph">DBA_ADDM_*</code>和<code class="codeph">DBA_ADVISOR_*</code>详细信息，请参阅<span class="q">“ <a href="automatic-performance-diagnostics.html#GUID-914A7E7C-FD5F-4F24-93AA-9E98578EB129">ADDM视图</a> ”</span></p>
                              </li>
                              <li>
                                 <p><span class="q">“ <a href="automatic-performance-diagnostics.html#GUID-AEE549F3-DDF9-4977-8A0A-FE1E47C75679">使用ADDM诊断数据库性能问题</a> ”</span> ，了解有关如何使用<code class="codeph">DBMS_ADDM</code>程序<code class="codeph">DBMS_ADDM</code>程序在Oracle数据库中运行ADDM的信息</p>
                              </li>
                              <li>
                                 <p><a href="../tdppt/automatic-database-performance-monitoring.html#TDPPT020" target="_blank"><span class="italic">Oracle Database 2 Day +性能调整指南</span></a> ，了解有关如何使用Cloud Control在Oracle数据库中运行ADDM的信息</p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div class="props_rev_3"><a id="GUID-5A4F4896-6F95-461F-84E3-8E40F6036752" name="GUID-5A4F4896-6F95-461F-84E3-8E40F6036752"></a><h5 id="TGDBA-GUID-5A4F4896-6F95-461F-84E3-8E40F6036752" class="sect5"><span class="enumeration_section">7.1.3.1</span>在可插拔数据库中启用ADDM</h5>
                     <div>
                        <p>默认情况下，ADDM在可插拔数据库（PDB）中不起作用，因为默认情况下在PDB中禁用自动AWR快照。要在PDB中使用ADDM，必须通过将<code class="codeph">AWR_PDB_AUTOFLUSH_ENABLED</code>初始化参数设置为<code class="codeph">TRUE</code>且AWR快照间隔大于0来在PDB中启用自动AWR快照。
                        </p>
                        <div class="section">
                           <p class="subhead3" id="GUID-5A4F4896-6F95-461F-84E3-8E40F6036752__GUID-DD3E22CF-F0CF-4B77-91B8-E2D6FE1C97E2">要在PDB中启用ADDM：</p>
                           <ol>
                              <li>
                                 <p>使用以下命令在PDB中将<code class="codeph">AWR_PDB_AUTOFLUSH_ENABLED</code>初始化参数设置为<code class="codeph">TRUE</code> ：</p><pre class="pre codeblock"><code>SQL&gt; ALTER SYSTEM SET AWR_PDB_AUTOFLUSH_ENABLED = TRUE;</code></pre></li>
                              <li>
                                 <p>使用命令在PDB中将AWR快照间隔设置为大于0，如以下示例所示：</p><pre class="pre codeblock"><code>SQL&gt; EXEC dbms_workload_repository.modify_snapshot_settings（interval =&gt; 60）;</code></pre></li>
                           </ol>
                           <div class="infoboxnotealso" id="GUID-5A4F4896-6F95-461F-84E3-8E40F6036752__GUID-B599EB38-C7DD-454C-9703-43CB5036F49C">
                              <p class="notep1">也可以看看：</p>
                              <ul id="GUID-5A4F4896-6F95-461F-84E3-8E40F6036752__UL_WK1_XC4_JGB" style="list-style-type:disc">
                                 <li>
                                    <p>有关<code class="codeph">AWR_PDB_AUTOFLUSH_ENABLED</code>初始化参数的详细信息，请<code class="codeph">AWR_PDB_AUTOFLUSH_ENABLED</code> <a href="../refrn/AWR_PDB_AUTOFLUSH_ENABLED.html#REFRN-GUID-08FA21BC-8FB1-4C51-BEEA-139C734D17A7" target="_blank"><span class="italic">Oracle数据库参考</span></a></p>
                                 </li>
                                 <li>
                                    <p>有关<code class="codeph">DBMS_WORKLOAD_REPOSITORY.MODIFY_SNAPSHOT_SETTINGS</code>过程的详细信息，请<code class="codeph">DBMS_WORKLOAD_REPOSITORY.MODIFY_SNAPSHOT_SETTINGS</code> <a href="../arpls/DBMS_WORKLOAD_REPOSITORY.html#ARPLS-GUID-E2B46878-1BDB-4789-8A21-016A625530F1" target="_blank"><span class="italic">Oracle Database PL / SQL包和类型参考</span></a></p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div><a id="TGDBA95368"></a><div class="props_rev_3"><a id="GUID-9DD81F99-3B4D-4340-9F19-30E5B47DC41D" name="GUID-9DD81F99-3B4D-4340-9F19-30E5B47DC41D"></a><h4 id="TGDBA-GUID-9DD81F99-3B4D-4340-9F19-30E5B47DC41D" class="sect4"><span class="enumeration_section">7.1.4</span>实时ADDM分析</h4>
                  <div>
                     <p>介绍了Oracle企业管理器云控制（云控制<span class="italic">）12℃，</span>实时ADDM可以帮助你分析和解决传统上需要重新启动数据库反应迟钝或挂数据库的问题。实时ADDM运行一组预定义标准来分析数据库的当前性能。分析问题后，Real-Time ADDM可帮助您解决已发现的问题，例如死锁，挂起，共享池争用和其他异常情况，而无需重新启动数据库。
                     </p>
                     <p>本节介绍实时ADDM，包含以下主题：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="automatic-performance-diagnostics.html#GUID-C8ACD778-60CF-4E9E-A644-45533E93C34A">实时ADDM连接模式</a></p>
                        </li>
                        <li>
                           <p><a href="automatic-performance-diagnostics.html#GUID-5B6CB1B0-DF21-4FF4-921D-B3E9B39556D6">实时ADDM触发器</a></p>
                        </li>
                        <li>
                           <p><a href="automatic-performance-diagnostics.html#GUID-01DB980E-9607-41DD-8B20-834FE8D77BE8">实时ADDM触发控制</a></p>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-9DD81F99-3B4D-4340-9F19-30E5B47DC41D__GUID-DABECB6A-B020-4925-AA78-5604FDAE4D58">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="../tdppt/resolving-transient-performance-problems.html#TDPPT523" target="_blank"><span class="italic">“Oracle数据库2天+性能调整指南”</span></a> ，了解有关将实时ADDM与云控制配合使用的信息</p>
                     </div>
                  </div><a id="TGDBA95369"></a><div class="props_rev_3"><a id="GUID-C8ACD778-60CF-4E9E-A644-45533E93C34A" name="GUID-C8ACD778-60CF-4E9E-A644-45533E93C34A"></a><h5 id="TGDBA-GUID-C8ACD778-60CF-4E9E-A644-45533E93C34A" class="sect5"><span class="enumeration_section">7.1.4.1</span>实时ADDM连接模式</h5>
                     <div>
                        <p>根据数据库状态，使用Cloud Control连接到数据库时，Real-Time ADDM使用两种不同类型的连接模式：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>正常连接</p>
                              <p>在此模式下，Real-Time ADDM执行与数据库的常规JDBC连接。此模式旨在在某些连接可用时对数据库执行广泛的性能分析。</p>
                           </li>
                           <li>
                              <p>诊断连接</p>
                              <p>在此模式下，实时ADDM执行与数据库的无锁存连接。此模式适用于无法进行普通JDBC连接时的极端挂起情况。</p>
                           </li>
                        </ul>
                     </div>
                  </div><a id="TGDBA95371"></a><a id="TGDBA95370"></a><div class="props_rev_3"><a id="GUID-5B6CB1B0-DF21-4FF4-921D-B3E9B39556D6" name="GUID-5B6CB1B0-DF21-4FF4-921D-B3E9B39556D6"></a><h5 id="TGDBA-GUID-5B6CB1B0-DF21-4FF4-921D-B3E9B39556D6" class="sect5"><span class="enumeration_section">7.1.4.2</span>实时ADDM触发器</h5>
                     <div>
                        <p>从Oracle Database 12 <span class="italic">c开始</span> ，Real-Time ADDM主动检测瞬态数据库性能问题。为此，Real-Time ADDM每3秒自动运行一次，并使用内存中数据来诊断数据库中的任何性能峰值。
                        </p>
                        <p>检测到性能问题时，实时ADDM会自动触发分析，如以下步骤所述：</p>
                        <ol>
                           <li>
                              <p>可管理性监视器进程（MMON）每3秒执行一次操作，以获取没有锁定或锁存的性能统计信息。</p>
                           </li>
                           <li>
                              <p>如果检测到<a href="automatic-performance-diagnostics.html#GUID-5B6CB1B0-DF21-4FF4-921D-B3E9B39556D6__BABEDDIC" title="列出触发实时ADDM分析的问题和条件。">表7-1</a>中列出的任何问题，MMON进程将检查这些统计信息并触发实时ADDM分析。
                              </p>
                           </li>
                           <li>
                              <p>MMON从属进程创建报告并将其存储在AWR中。</p>
                              <p>要查看报告的元数据，请使用<code class="codeph">DBA_HIST_REPORTS</code>视图。
                              </p>
                           </li>
                        </ol>
                        <p><a href="automatic-performance-diagnostics.html#GUID-5B6CB1B0-DF21-4FF4-921D-B3E9B39556D6__BABEDDIC" title="列出触发实时ADDM分析的问题和条件。">表7-1</a>列出了触发实时ADDM分析的问题和条件。
                        </p>
                        <div class="tblformal" id="GUID-5B6CB1B0-DF21-4FF4-921D-B3E9B39556D6__BABEDDIC">
                           <p class="titleintable">表7-1实时ADDM的触发问题和条件</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="触发实时ADDM的问题和条件" width="100%" border="1" summary="Lists the issues and conditions that trigger an Real-Time ADDM analysis." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="31%" id="d19268e1029">问题</th>
                                    <th align="left" valign="bottom" width="69%" id="d19268e1032">条件</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d19268e1037" headers="d19268e1029 ">
                                       <p>高负荷</p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d19268e1037 d19268e1032 ">
                                       <p>平均活动会话数大于CPU核心数的3倍</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d19268e1044" headers="d19268e1029 ">
                                       <p>I / O绑定</p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d19268e1044 d19268e1032 ">
                                       <p>基于单块读取性能的I / O对活动会话的影响</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d19268e1051" headers="d19268e1029 ">
                                       <p>CPU绑定</p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d19268e1051 d19268e1032 ">
                                       <p>活动会话大于总负载的10％，CPU利用率大于50％</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d19268e1058" headers="d19268e1029 ">
                                       <p>过度分配的内存</p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d19268e1058 d19268e1032 ">
                                       <p>内存分配超过物理内存的95％</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d19268e1065" headers="d19268e1029 ">
                                       <p>互连绑定</p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d19268e1065 d19268e1032 ">
                                       <p>基于单块互连传输时间</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d19268e1072" headers="d19268e1029 ">
                                       <p>会话限制</p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d19268e1072 d19268e1032 ">
                                       <p>会话限制接近100％</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d19268e1079" headers="d19268e1029 ">
                                       <p>流程限制</p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d19268e1079 d19268e1032 ">
                                       <p>工艺限制接近100％</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d19268e1086" headers="d19268e1029 ">
                                       <p>洪会议</p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d19268e1086 d19268e1032 ">
                                       <p>Hung会话占总会话数的10％以上</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d19268e1093" headers="d19268e1029 ">
                                       <p>检测到死锁</p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d19268e1093 d19268e1032 ">
                                       <p>检测到任何死锁</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                        <div class="section">
                           <div class="infoboxnotealso" id="GUID-5B6CB1B0-DF21-4FF4-921D-B3E9B39556D6__GUID-EB6A5DA3-3D88-499E-BB01-9F50ED38F4EE">
                              <p class="notep1">也可以看看：</p>
                              <p>有关<code class="codeph">DBA_HIST_REPORTS</code>视图的信息，请<a href="../refrn/DBA_HIST_REPORTS.html#REFRN23881" target="_blank"><span class="italic">参见Oracle数据库参考</span></a></p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="TGDBA95372"></a><div class="props_rev_3"><a id="GUID-01DB980E-9607-41DD-8B20-834FE8D77BE8" name="GUID-01DB980E-9607-41DD-8B20-834FE8D77BE8"></a><h5 id="TGDBA-GUID-01DB980E-9607-41DD-8B20-834FE8D77BE8" class="sect5"><span class="enumeration_section">7.1.4.3</span>实时ADDM触发控制</h5>
                     <div>
                        <p>为确保自动触发器不会消耗太多系统资源并使系统不堪重负，Real-Time ADDM采用以下控件：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>报告间隔时间</p>
                              <p>如果通过自动触发器在过去5分钟内创建了实时ADDM报告，则不会生成新报告。</p>
                           </li>
                           <li>
                              <p>Oracle RAC控件</p>
                              <p>自动触发器是数据库实例的本地触发器。对于Oracle RAC，只有一个数据库实例可以在给定时间创建实时ADDM报告，因为在实际生成报告之前需要锁定并且MMON从属进程执行查询。</p>
                           </li>
                           <li>
                              <p>重复的触发器</p>
                              <p>对于任何问题的自动触发必须具有100％或更高的影响，并且在过去45分钟内具有相同的触发问题。例如，如果针对具有8个会话影响的活动会话触发报告，则为了在接下来的45分钟内触发另一个报告，必须至少有16个活动会话。在这种情况下，报告的数据库问题随着时间的推移变得越来越严重。另一方面，如果每45分钟生成一次相同的报告，则数据库会遇到持续存在的问题，并且会产生一致的影响。</p>
                           </li>
                           <li>
                              <p>新发现的问题</p>
                              <p>如果检测到新问题（之前未在过去45分钟内检测到），则会生成新报告。例如，如果为8个活动会话触发报告并且检测到新的死锁问题，则无论新的活动会话加载如何，都会生成新报告。</p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="TGDBA94242"></a><div class="props_rev_3"><a id="GUID-824AA656-C199-437D-926B-A8F05590A65C" name="GUID-824AA656-C199-437D-926B-A8F05590A65C"></a><h4 id="TGDBA-GUID-824AA656-C199-437D-926B-A8F05590A65C" class="sect4"><span class="enumeration_section">7.1.5</span> ADDM分析结果</h4>
                  <div>
                     <p>除了问题诊断之外，ADDM还建议了可能的解决方案。<a id="d19268e1234" class="indexterm-anchor"></a> ADDM分析结果表示为一组<a id="d19268e1239" class="indexterm-anchor"></a>发现。有关ADDM分析结果的示例，请参见<a href="automatic-performance-diagnostics.html#GUID-DCD9B583-0059-492C-A801-0A551C9CE5F8__i38382">示例7-1</a> 。每个ADDM发现都属于以下类型之一：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>问题发现描述了数据库性能问题的根本原因。</p>
                        </li>
                        <li>
                           <p>症状发现包含经常导致一个或多个问题发现的信息。</p>
                        </li>
                        <li>
                           <p>信息结果用于报告与理解数据库性能相关的信息，但不构成性能问题（例如数据库的非问题区域和自动数据库维护的活动）。</p>
                        </li>
                        <li>
                           <p>警告结果包含有关可能影响ADDM分析完整性或准确性的问题的信息（例如AWR中缺少数据）。</p>
                        </li>
                     </ul>
                     <p>每个问题发现都是通过影响来量化的，该影响是对发现性能问题引起的<code class="codeph">DB</code> <code class="codeph">time</code>部分的估计。问题发现可以与用于减少性能问题影响的建议列表相关联。建议的类型包括<a id="d19268e1267" class="indexterm-anchor"></a> ：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>硬件更改：添加CPU或更改I / O子系统配置</p>
                        </li>
                        <li>
                           <p>数据库配置：更改初始化参数设置</p>
                        </li>
                        <li>
                           <p>架构更改：对表或索引进行哈希分区，或使用自动段空间管理（ASSM）</p>
                        </li>
                        <li>
                           <p>应用程序更改：对序列使用缓存选项或使用绑定变量</p>
                        </li>
                        <li>
                           <p>使用其他顾问程序：在高负载SQL上运行SQL Tuning Advisor或在热对象上运行Segment Advisor</p>
                        </li>
                     </ul>
                     <p>建议清单可以包含解决同一问题的各种备选方案;您不必应用所有建议来解决特定问题。每个建议都有一个好处，即在实施建议<code class="codeph">time</code>可以节省的<code class="codeph">DB</code> <code class="codeph">time</code>部分的估计值。<a id="d19268e1296" class="indexterm-anchor"></a>建议由行动和理由组成。您必须应用建议的所有操作才能获得估计的收益。基本原理用于解释为什么建议采取一系列行动，并提供额外信息以实施建议的建议。
                     </p>
                  </div>
               </div><a id="TGDBA94244"></a><a id="TGDBA94243"></a><div class="props_rev_3"><a id="GUID-DCD9B583-0059-492C-A801-0A551C9CE5F8" name="GUID-DCD9B583-0059-492C-A801-0A551C9CE5F8"></a><h4 id="TGDBA-GUID-DCD9B583-0059-492C-A801-0A551C9CE5F8" class="sect4"><span class="enumeration_section">7.1.6</span>查看ADDM分析结果：示例</h4>
                  <div>
                     <p><a id="d19268e1353" class="indexterm-anchor"></a><a id="d19268e1357" class="indexterm-anchor"></a>请考虑<a href="automatic-performance-diagnostics.html#GUID-DCD9B583-0059-492C-A801-0A551C9CE5F8__i38382">示例7-1中</a> ADDM报告的以下部分。
                     </p>
                     <div class="example" id="GUID-DCD9B583-0059-492C-A801-0A551C9CE5F8__i38382">
                        <p class="titleinexample">例7-1 ADDM报告示例</p><pre class="oac_no_warn" dir="ltr">发现1：31％影响（7798秒）------------------------------------ SQL语句没有由于文字的使用而共享。这导致额外的硬解析，这耗费了大量的数据库时间。建议1：应用程序分析，31％的好处（7798秒）操作：调查应用程序逻辑，以便可能使用绑定变量而不是文字。或者，您可以将参数“cursor_sharing”设置为“force”。RATIONALE：发现使用PLAN_HASH_VALUE 3106087033的SQL语句使用文字。查看V $ SQL以获取此类SQL语句的示例。
</pre><p>在<a href="automatic-performance-diagnostics.html#GUID-DCD9B583-0059-492C-A801-0A551C9CE5F8__i38382">示例7-1中</a> ，发现指向特定的根本原因，即SQL语句中文字的使用，估计在分析期间对总<code class="codeph">DB</code> <code class="codeph">time</code>的影响约为31％。
                        </p>
                        <p>该发现有一个与之相关的建议，由一个动作和一个基本原理组成。该操作指定了所发现问题的解决方案，并且估计在分析期间最多可获得31％的<code class="codeph">DB</code> <code class="codeph">time</code> 。请注意，收益是作为总<code class="codeph">DB</code> <code class="codeph">time</code>的一部分给出的，而不是作为发现影响的一部分。该基本原理提供了有关跟踪使用文字并导致此性能问题的潜在SQL语句的其他信息。使用可能存在问题的SQL语句的指定计划哈希值，DBA可以快速检查一些示例语句。
                        </p>
                        <p>当特定问题有多种原因时，ADDM可能会报告多个问题和症状结果。在这种情况下，这些多个发现的影响可能包含相同的<code class="codeph">DB</code> <code class="codeph">time</code>部分。由于研究结果的性能问题可能会重叠，因此研究结果的影响总和可能会超过<code class="codeph">DB</code> <code class="codeph">time</code> 100％。例如，如果系统执行多次读取，则ADDM可能会报告由于I / O活动作为一个发现而导致负责50％ <code class="codeph">DB</code> <code class="codeph">time</code>的SQL语句，以及作为另一个发现负责75％ <code class="codeph">DB</code> <code class="codeph">time</code>的小型缓冲区高速缓存。
                        </p>
                        <p>当多个建议与问题发现相关联时，建议可能包含解决问题的替代方案。在这种情况下，建议的好处总和可能高于发现的影响。</p>
                        <p>适当时，ADDM操作可能有多种解决方案供您选择。在该示例中，最有效的解决方案是使用绑定变量。但是，通常很难修改应用程序。更改<code class="codeph">CURSOR_SHARING</code>初始化参数的值更容易实现，并且可以提供显着的改进。
                        </p>
                     </div>
                     <!-- class="example" -->
                  </div>
               </div>
            </div><a id="TGDBA94245"></a><div class="props_rev_3"><a id="GUID-19D504B9-B4E4-4FBF-B0D2-F758B467FEDD" name="GUID-19D504B9-B4E4-4FBF-B0D2-F758B467FEDD"></a><h3 id="TGDBA-GUID-19D504B9-B4E4-4FBF-B0D2-F758B467FEDD" class="sect3"><span class="enumeration_section">7.2</span>设置ADDM</h3>
               <div>
                  <div class="section">
                     <p><a id="d19268e1478" class="indexterm-anchor"></a><a id="d19268e1482" class="indexterm-anchor"></a>默认情况下启用自动数据库诊断监视，并由<code class="codeph">CONTROL_MANAGEMENT_PACK_ACCESS</code>和<code class="codeph">STATISTICS_LEVEL</code>初始化参数控制。
                     </p>
                     <p><code class="codeph">CONTROL_MANAGEMENT_PACK_ACCESS</code>参数应设置为<code class="codeph">DIAGNOSTIC</code>或<code class="codeph">DIAGNOSTIC+TUNING</code>以启用自动数据库诊断监控。默认设置为<code class="codeph">DIAGNOSTIC+TUNING</code> 。将<code class="codeph">CONTROL_MANAGEMENT_PACK_ACCESS</code>设置为<code class="codeph">NONE</code>将禁用ADDM。</p>
                     <p>应将<code class="codeph">STATISTICS_LEVEL</code>参数设置为<code class="codeph">TYPICAL</code>或<code class="codeph">ALL</code>以启用自动数据库诊断监视。默认设置为<code class="codeph">TYPICAL</code> 。将<code class="codeph">STATISTICS_LEVEL</code>设置为<code class="codeph">BASIC</code>会禁用许多Oracle数据库功能，包括ADDM，因此强烈建议不要这样做。
                     </p>
                     <div class="infoboxnotealso" id="GUID-19D504B9-B4E4-4FBF-B0D2-F758B467FEDD__GUID-2E1A5D98-918C-4051-B784-B060C1F9C4B4">
                        <p class="notep1">也可以看看：</p>
                        <p>有关<a href="../refrn/CONTROL_MANAGEMENT_PACK_ACCESS.html#REFRN-GUID-A5CA11BA-AE1F-4A2E-9C59-A98BA1F4E5C2" target="_blank"><code class="codeph">CONTROL_MANAGEMENT_PACK_ACCESS</code></a>和<a href="../refrn/STATISTICS_LEVEL.html#REFRN-GUID-16B23F95-8644-407A-A6C8-E85CADFA61FF" target="_blank"><code class="codeph">STATISTICS_LEVEL</code></a>初始化参数的信息，请<span class="italic">参见Oracle数据库参考</span></p>
                     </div>
                     <p>I / O性能的ADDM分析部分取决于单个参数<code class="codeph">DBIO_EXPECTED</code> ，它描述了I / O子系统的预期性能。<code class="codeph">DBIO_EXPECTED</code>的值是以微秒为单位读取单个数据库块所需的平均时间。Oracle数据库使用默认值10毫秒，这是大多数现代硬盘驱动器的适当值。如果您的硬件明显不同 - 例如非常旧的硬件或非常快的RAM磁盘 - 那么请考虑使用不同的值。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-19D504B9-B4E4-4FBF-B0D2-F758B467FEDD__GUID-83877CCB-3119-4D64-932C-C2CDEEEC3217">要确定DBIO_EXPECTED参数的正确设置：</p>
                     <ol>
                        <li>
                           <p>测量为您的硬件读取的单个数据库块的平均读取时间。</p>
                           <p>请注意，此测量适用于随机I / O，包括使用标准硬盘驱动器时的搜索时间。硬盘驱动器的典型值介于5000和20000微秒之间。</p>
                        </li>
                        <li>
                           <p><a id="d19268e1569" class="indexterm-anchor"></a><a id="d19268e1573" class="indexterm-anchor"></a>为所有后续ADDM执行设置一次值。
                           </p>
                           <p>例如，如果测量值为8000微秒，则应以SYS用户身份执行以下命令：</p><pre class="oac_no_warn" dir="ltr">EXECUTE DBMS_ADVISOR.SET_DEFAULT_TASK_PARAMETER（'ADDM'，'DBIO_EXPECTED'，8000）;</pre></li>
                     </ol>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="TGDBA94246"></a><div class="props_rev_3"><a id="GUID-AEE549F3-DDF9-4977-8A0A-FE1E47C75679" name="GUID-AEE549F3-DDF9-4977-8A0A-FE1E47C75679"></a><h3 id="TGDBA-GUID-AEE549F3-DDF9-4977-8A0A-FE1E47C75679" class="sect3"><span class="enumeration_section">7.3</span>使用ADDM诊断数据库性能问题</h3>
               <div>
                  <p>要诊断数据库性能问题，请首先查看每次执行AWR快照时自动创建的ADDM分析结果。如果需要进行不同的分析（例如更长的分析周期，使用不同的<code class="codeph">DBIO_EXPECTED</code>设置或更改分析模式），则可以按照本节中的说明手动运行ADDM。
                  </p>
                  <p>ADDM可以分析任何两个AWR快照（在同一个数据库上），只要两个快照仍然存储在AWR中（尚未清除）。ADDM只能分析在开始快照之前启动的实例，并保持运行直到结束快照。此外，ADDM不会分析在生成AWR快照时遇到重大错误的实例。在这种情况下，ADDM将分析未遇到这些问题的最大实例子集。</p>
                  <p>诊断监控的主要界面是云控制。尽可能使用Cloud Control运行ADDM，如<a href="../tdppt/automatic-database-performance-monitoring.html#TDPPT020" target="_blank"><span class="italic">Oracle Database 2 Day + Performance Tuning Guide中所述</span></a> 。如果Cloud Control不可用，则使用<code class="codeph">DBMS_ADDM</code>程序包运行ADDM。要运行<code class="codeph">DBMS_ADDM</code> API，必须为用户授予<code class="codeph">ADVISOR</code>权限。
                  </p>
                  <p>本节包含以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="automatic-performance-diagnostics.html#GUID-844F5FA1-4CD7-42B9-A750-199ECFD3F3E1">在数据库模式下运行ADDM</a></p>
                     </li>
                     <li>
                        <p><a href="automatic-performance-diagnostics.html#GUID-EA83D5B3-F4F0-4B4A-9597-19BBA22E55B9">在实例模式下运行ADDM</a></p>
                     </li>
                     <li>
                        <p><a href="automatic-performance-diagnostics.html#GUID-848B8796-EDDC-4700-BCB9-261C9D21D853">在部分模式下运行ADDM</a></p>
                     </li>
                     <li>
                        <p><a href="automatic-performance-diagnostics.html#GUID-0A1DA0E7-098C-40CC-9975-B9BF4F29C942">显示ADDM报告</a></p>
                     </li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-AEE549F3-DDF9-4977-8A0A-FE1E47C75679__GUID-87349219-CB01-45B5-BB94-8BCA9CDD1824">
                     <p class="notep1">也可以看看：</p>
                     <p>有关<code class="codeph">DBMS_ADDM</code>程序包的信息，请<code class="codeph">DBMS_ADDM</code> <a href="../arpls/DBMS_ADDM.html#ARPLS232" target="_blank"><span class="italic">Oracle Database PL / SQL程序包和类型参考</span></a></p>
                  </div>
               </div><a id="TGDBA94247"></a><div class="props_rev_3"><a id="GUID-844F5FA1-4CD7-42B9-A750-199ECFD3F3E1" name="GUID-844F5FA1-4CD7-42B9-A750-199ECFD3F3E1"></a><h4 id="TGDBA-GUID-844F5FA1-4CD7-42B9-A750-199ECFD3F3E1" class="sect4"><span class="enumeration_section">7.3.1</span>在数据库模式下运行ADDM</h4>
                  <div>
                     <div class="section">
                        <p>对于Oracle RAC配置，您可以在数据库模式下运行ADDM以分析数据库的所有实例。对于单实例配置，您仍可以在数据库模式下运行ADDM; ADDM的行为就像在实例模式下运行一样。</p>
                        <p>要在数据库模式下运行ADDM，请使用<code class="codeph">DBMS_ADDM</code> 。 <code class="codeph">ANALYZE_DB</code>程序：</p><pre class="oac_no_warn" dir="ltr">BEGIN DBMS_ADDM.ANALYZE_DB（task_name IN OUT VARCHAR2，begin_snapshot IN NUMBER，end_snapshot IN NUMBER，db_id IN NUMBER：= NULL）;结束; /</pre><p><code class="codeph">task_name</code>参数指定将创建的分析任务的名称。<code class="codeph">begin_snapshot</code>参数指定分析期间中开始快照的快照编号。<code class="codeph">end_snapshot</code>参数指定分析周期中结束快照的快照编号。<code class="codeph">db_id</code>参数指定要分析的数据库的数据库标识符。如果未指定，则此参数默认为您当前连接的数据库的数据库标识符。
                        </p>
                        <p>以下示例在数据库分析模式下创建ADDM任务，并执行该任务以在快照137和145定义的时间段内诊断整个数据库的性能：</p><pre class="oac_no_warn" dir="ltr">VAR tname VARCHAR2（30）;开始：tname：='ADDM为晚上7点到晚上9点'; DBMS_ADDM.ANALYZE_DB（：tname，137,145）;结束; /</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="TGDBA94248"></a><div class="props_rev_3"><a id="GUID-EA83D5B3-F4F0-4B4A-9597-19BBA22E55B9" name="GUID-EA83D5B3-F4F0-4B4A-9597-19BBA22E55B9"></a><h4 id="TGDBA-GUID-EA83D5B3-F4F0-4B4A-9597-19BBA22E55B9" class="sect4"><span class="enumeration_section">7.3.2</span>在实例模式下运行ADDM</h4>
                  <div>
                     <div class="section">
                        <p>要分析数据库的特定实例，可以在实例模式下运行ADDM。要在实例模式下运行ADDM，请使用<code class="codeph">DBMS_ADDM</code> 。 <code class="codeph">ANALYZE_INST</code>程序：</p><pre class="oac_no_warn" dir="ltr">BEGIN DBMS_ADDM.ANALYZE_INST（task_name IN OUT VARCHAR2，begin_snapshot IN NUMBER，end_snapshot IN NUMBER，instance_number IN NUMBER：= NULL，db_id IN NUMBER：= NULL）;结束; /</pre><p><code class="codeph">task_name</code>参数指定将创建的分析任务的名称。<code class="codeph">begin_snapshot</code>参数指定分析期间中开始快照的快照编号。<code class="codeph">end_snapshot</code>参数指定分析周期中结束快照的快照编号。<code class="codeph">instance_number</code>参数指定将要分析的实例的实例编号。如果未指定，则此参数默认为您当前连接的实例的实例编号。<code class="codeph">db_id</code>参数指定要分析的数据库的数据库标识符。如果未指定，则此参数默认为您当前连接的数据库的数据库标识符。
                        </p>
                        <p>以下示例在实例分析模式下创建ADDM任务，并执行该任务以在快照137和145定义的时间段内诊断实例编号1的性能：</p><pre class="oac_no_warn" dir="ltr">VAR tname VARCHAR2（30）;开始：tname：='我的ADDM为晚上7点到晚上9点'; DBMS_ADDM.ANALYZE_INST（：tname，137,145,1）;结束; /</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="TGDBA94249"></a><div class="props_rev_3"><a id="GUID-848B8796-EDDC-4700-BCB9-261C9D21D853" name="GUID-848B8796-EDDC-4700-BCB9-261C9D21D853"></a><h4 id="TGDBA-GUID-848B8796-EDDC-4700-BCB9-261C9D21D853" class="sect4"><span class="enumeration_section">7.3.3</span>在部分模式下运行ADDM</h4>
                  <div>
                     <div class="section">
                        <p>要分析所有数据库实例的子集，可以在“部分”模式下运行ADDM。要在部分模式下运行ADDM，请使用<code class="codeph">DBMS_ADDM</code> 。 <code class="codeph">ANALYZE_PARTIAL</code>程序：</p><pre class="oac_no_warn" dir="ltr">BEGIN DBMS_ADDM.ANALYZE_PARTIAL（task_name IN OUT VARCHAR2，instance_numbers IN VARCHAR2，begin_snapshot IN NUMBER，end_snapshot IN NUMBER，db_id IN NUMBER：= NULL）;结束; /</pre><p><code class="codeph">task_name</code>参数指定将创建的分析任务的名称。<code class="codeph">instance_numbers</code>参数指定将要分析的实例的实例数的逗号分隔列表。<code class="codeph">begin_snapshot</code>参数指定分析期间中开始快照的快照编号。<code class="codeph">end_snapshot</code>参数指定分析周期中结束快照的快照编号。<code class="codeph">db_id</code>参数指定要分析的数据库的数据库标识符。如果未指定，则此参数默认为您当前连接的数据库的数据库标识符。
                        </p>
                        <p>以下示例在部分分析模式下创建ADDM任务，并在快照137和145定义的时间段内执行该任务以诊断实例编号1,2和4的性能：</p><pre class="oac_no_warn" dir="ltr">VAR tname VARCHAR2（30）;开始：tname：='我的ADDM为晚上7点到晚上9点'; DBMS_ADDM.ANALYZE_PARTIAL（：tname，'1,2,4'，137,145）;结束; /</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="TGDBA94250"></a><div class="props_rev_3"><a id="GUID-0A1DA0E7-098C-40CC-9975-B9BF4F29C942" name="GUID-0A1DA0E7-098C-40CC-9975-B9BF4F29C942"></a><h4 id="TGDBA-GUID-0A1DA0E7-098C-40CC-9975-B9BF4F29C942" class="sect4"><span class="enumeration_section">7.3.4</span>显示ADDM报告</h4>
                  <div>
                     <div class="section">
                        <p>要显示已执行ADDM任务的文本报告，请使用<code class="codeph">DBMS_ADDM</code> 。 <code class="codeph">GET_REPORT</code>功能：</p><pre class="oac_no_warn" dir="ltr">DBMS_ADDM.GET_REPORT（task_name IN VARCHAR2 RETURN CLOB）;</pre><p>以下示例使用<code class="codeph">tname</code>变量显示由其任务名称指定的ADDM任务的文本报告：</p><pre class="oac_no_warn" dir="ltr">SET LONG 1000000 PAGESIZE 0; SELECT DBMS_ADDM.GET_REPORT（：tname）FROM DUAL;</pre><p>请注意，报表的返回类型是<code class="codeph">CLOB</code> ，格式设置为适合80行的大小。有关在ADDM报告中查看<span class="q"><a href="automatic-performance-diagnostics.html#GUID-824AA656-C199-437D-926B-A8F05590A65C">ADDM分析结果的信息</a></span> ，请参阅<span class="q">“ <a href="automatic-performance-diagnostics.html#GUID-824AA656-C199-437D-926B-A8F05590A65C">ADDM分析结果</a> ”</span> 。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="TGDBA94251"></a><div class="props_rev_3"><a id="GUID-914A7E7C-FD5F-4F24-93AA-9E98578EB129" name="GUID-914A7E7C-FD5F-4F24-93AA-9E98578EB129"></a><h3 id="TGDBA-GUID-914A7E7C-FD5F-4F24-93AA-9E98578EB129" class="sect3"><span class="enumeration_section">7.4</span> ADDM视图</h3>
               <div>
                  <div class="section">
                     <p>通常，您应该使用Cloud Control或<code class="codeph">DBMS_ADDM</code>程序<code class="codeph">DBMS_ADDM</code>程序查看ADDM分析。
                     </p>
                     <p>但是，您也可以使用<code class="codeph">DBA_ADDM_*</code>和<code class="codeph">DBA_ADVISOR_*</code>视图获取ADDM信息。这组意见包括：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">DBA_ADVISOR_FINDINGS</code> 
                           </p>
                           <p>此视图显示所有顾问发现的所有结果。显示每个发现以及相关的查找ID，名称和类型。对于具有多个执行的任务，还会列出与每个查找关联的每个任务执行的名称。</p>
                        </li>
                        <li>
                           <p><code class="codeph">DBA_ADDM_FINDINGS</code></p>
                           <p>此视图包含相关<code class="codeph">DBA_ADVISOR_FINDINGS</code>视图中显示的结果的子集。此视图仅显示所有顾问发现的ADDM结果。将显示每个ADDM查找结果，其中包含相关的查找ID，名称和类型。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">DBA_ADVISOR_FINDING_NAMES</code></p>
                           <p>此视图列出了使用顾问程序框架注册的所有查找名称。</p>
                        </li>
                        <li>
                           <p><code class="codeph">DBA_ADVISOR_RECOMMENDATIONS</code> 
                           </p>
                           <p>此视图显示已完成诊断任务的结果，并提供每次执行中发现的问题的建议。建议应按<code class="codeph">RANK</code>专栏的顺序进行审查，因为这会传达建议问题的严重程度。<code class="codeph">BENEFIT</code>列显示执行推荐后您可以预期的系统优势。对于具有多个执行的任务，还会列出与每个顾问程序任务关联的每个任务执行的名称。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">DBA_ADVISOR_TASKS</code> 
                           </p>
                           <p>此视图提供有关现有任务的基本信息，例如任务ID，任务名称以及创建任务的时间。对于具有多个执行的任务，还会列出与每个顾问程序任务关联的最后一个或当前执行的名称和类型。</p>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-914A7E7C-FD5F-4F24-93AA-9E98578EB129__GUID-6D554325-E510-4612-9093-2DC4F5A7951C">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>有关<code class="codeph">DBA_ADDM_*</code>和<code class="codeph">DBA_ADVISOR_*</code>视图的更多信息，请<code class="codeph">DBA_ADDM_*</code> <a href="../refrn/about-static-data-dictionary-views.html#REFRN002" target="_blank"><span class="italic">Oracle数据库参考</span></a></p>
                           </li>
                           <li>
                              <p><span class="q">“ <a href="automatic-performance-diagnostics.html#GUID-0A1DA0E7-098C-40CC-9975-B9BF4F29C942">显示ADDM报告</a> ”</span></p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
         </div>
      </article>
   </body>
</html>