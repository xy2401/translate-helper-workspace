<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>使用非结构化数据类型</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Data Cartridge Developer&#39;s Guide"></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Data Cartridge Developer&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="data-cartridge-developers-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-10T07:34:53-08:00"></meta>
      <meta name="dcterms.title" content="Data Cartridge Developer&#39;s Guide"></meta>
      <meta name="dcterms.dateCopyrighted" content="1996, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96431-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="implementing-data-cartridges-in-C-CPP-and-java.html" title="Previous" type="text/html"></link>
      <link rel="next" href="using-extensible-indexing.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="ADDCI"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="implementing-data-cartridges-in-C-CPP-and-java.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="using-extensible-indexing.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">数据盒式开发人员指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="building-data-cartridges.html" property="item" typeof="WebPage"><span property="name">构建数据磁带</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">使用非结构化数据类型</li>
            </ol>
            <a id="GUID-5469F1F7-BD5B-4FB4-8F13-AE4CA0915F6D" name="GUID-5469F1F7-BD5B-4FB4-8F13-AE4CA0915F6D"></a><a id="ADDCI260"></a>
            
            <h2 id="ADDCI-GUID-5469F1F7-BD5B-4FB4-8F13-AE4CA0915F6D" class="sect2"><span class="enumeration_chapter">6</span>使用非结构化数据类型</h2>
         </header>
         <div class="ind">
            <div>
               <p>某些非Oracle数据库本机的数据类型可以在Oracle数据库中表示为大对象（LOB）。您可以在PL / SQL和OCI for Data Cartridges中实现它们。</p>
            </div><a id="ADDCI4362"></a><div class="props_rev_3"><a id="GUID-D6949474-AD4D-41A3-8AF3-2C9A0B9291F5" name="GUID-D6949474-AD4D-41A3-8AF3-2C9A0B9291F5"></a><h3 id="ADDCI-GUID-D6949474-AD4D-41A3-8AF3-2C9A0B9291F5" class="sect3"><span class="enumeration_section">6.1</span>磁带盒和非结构化数据类型概述</h3>
               <div>
                  <p>某些数据磁带必须处理大量oMultif原始二进制数据（如图形图像或声音波形）或字符数据（如文本或数字流）。Oracle支持大对象<code class="codeph">LOB</code>来处理这些类型的数据。
                  </p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><span class="bold">内部LOB</span> <a id="d13586e125" class="indexterm-anchor"></a><a id="d13586e127" class="indexterm-anchor"></a><a id="d13586e129" class="indexterm-anchor"></a>以优化空间和提供高效访问的方式存储在数据库表空间中。内部<code class="codeph">LOB</code>参与服务器的事务模型。
                        </p>
                        <p><a id="d13586e136" class="indexterm-anchor"></a><a id="d13586e138" class="indexterm-anchor"></a><a id="d13586e140" class="indexterm-anchor"></a>内部<code class="codeph">LOBs</code>可以存储二进制数据（ <code class="codeph">BLOB</code> ），单字节字符数据（ <code class="codeph">CLOB</code> ）或固定宽度单字节或多字节字符数据（ <code class="codeph">NCLOB</code> ）。<code class="codeph">NCLOB</code>由对应于为Oracle数据库定义的国家字符集的字符数据组成。Oracle不支持变化的宽度字符数据。
                        </p>
                     </li>
                     <li>
                        <p><a id="d13586e161" class="indexterm-anchor"></a><a id="d13586e165" class="indexterm-anchor"></a> <span class="bold">外部</span> <code class="codeph">LOBs</code>作为<code class="codeph">BFILE</code>的二进制数据存储在数据库表空间外的操作系统文件中。他们不能参与交易。
                        </p>
                     </li>
                  </ul>
                  <p>内部<code class="codeph">LOB</code>和<code class="codeph">BFILE</code>在处理大量数据方面提供了相当大的灵活性。
                  </p>
                  <p><a id="d13586e184" class="indexterm-anchor"></a><a id="d13586e188" class="indexterm-anchor"></a><a id="d13586e192" class="indexterm-anchor"></a>存储在<code class="codeph">LOB</code>数据称为<code class="codeph">LOB</code>的<span class="bold">值</span> 。对于Oracle服务器， <code class="codeph">LOB</code>的值是非结构化的，无法查询。您必须以墨盒特定的方式解压缩和解释<code class="codeph">LOB</code>的值。
                  </p>
                  <p>可以使用Oracle调用接口，OCI或PL / SQL <code class="codeph">DBMS_LOB</code>包来操作<code class="codeph">LOB</code> 。您可以编写函数，包括可以包含<code class="codeph">LOB</code>的对象类型的方法，来操作<code class="codeph">LOB</code>的部分。
                  </p>
                  <div class="infoboxnotealso" id="GUID-D6949474-AD4D-41A3-8AF3-2C9A0B9291F5__GUID-6DB47E1E-DFF6-42E0-B1A7-F36A64BC4CF6">
                     <p class="notep1">也可以看看：</p>
                     <p>有关<code class="codeph">LOBs</code>详细信息，请参见<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/addci&amp;id=ADLOB-GUID-1A2B0023-9EE8-48AF-AA76-171D1FC5C241" target="_blank"><span class="variable" translate="no">Oracle Database SecureFiles and Large Objects Developer's Guide</span></a></p>
                  </div>
               </div>
            </div><a id="ADDCI4363"></a><div class="props_rev_3"><a id="GUID-93F55770-0EB5-4F90-B086-EE1D8146B774" name="GUID-93F55770-0EB5-4F90-B086-EE1D8146B774"></a><h3 id="ADDCI-GUID-93F55770-0EB5-4F90-B086-EE1D8146B774" class="sect3"><span class="enumeration_section">6.2</span>对LOB使用DDL</h3>
               <div>
                  <p><a id="d13586e289" class="indexterm-anchor"></a><a id="d13586e293" class="indexterm-anchor"></a> LOB定义可能涉及<code class="codeph">CREATE</code> <code class="codeph">TYPE</code>和<code class="codeph">CREATE</code> <code class="codeph">TABLE</code>语句。<a href="working-with-multimedia-data-types.html#GUID-61143C61-B438-437F-99D1-EFC792B54D0E__BABBJIJJ">例6-1</a>指定名为<code class="codeph">lob_type</code>的数据类型中的<code class="codeph">CLOB</code> 。
                  </p>
                  <p><a href="working-with-multimedia-data-types.html#GUID-87822A0C-02FF-4E86-BA84-1817A40A13B8__BABGJJFH">例6-2</a>创建了一个对象表<code class="codeph">lob_table</code> ，其中每一行都是<code class="codeph">lob_type</code>数据的一个实例：</p>
                  <p><a href="working-with-multimedia-data-types.html#GUID-1AB23E62-1CF2-4AC3-94FB-DDEE5E350E06__BABHBICA">例6-3</a>显示了如何在常规表中存储<code class="codeph">LOBs</code> ，而不是如<a href="working-with-multimedia-data-types.html#GUID-87822A0C-02FF-4E86-BA84-1817A40A13B8__BABGJJFH">例6-2中</a>的对象表。
                  </p>
                  <p>在表中创建LOB时，可以设置LOB存储，缓冲和缓存属性。</p>
                  <div class="infoboxnotealso" id="GUID-93F55770-0EB5-4F90-B086-EE1D8146B774__GUID-5AADFE6D-A97C-49E2-A63C-21D1ABF69E59">
                     <p class="notep1">也可以看看：</p>
                     <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/addci&amp;id=SQLRF-GUID-049B7AE8-11E1-4110-B3E4-D117907D77AC" target="_blank"><span class="variable" translate="no">Oracle Database SQL Language Reference</span></a>手册”和“ <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/addci&amp;id=ADLOB-GUID-1A2B0023-9EE8-48AF-AA76-171D1FC5C241" target="_blank"><span class="variable" translate="no">Oracle Database SecureFiles and Large Objects Developer's Guide</span></a> ，了解有关在<code class="codeph">CREATE TABLE</code> ， <code class="codeph">ALTER TABLE</code> ， <code class="codeph">CREATE TYPE</code>和<code class="codeph">ALTER TYPE</code>语句中使用LOB的信息</p>
                  </div>
               </div><a id="ADDCI4364"></a><div class="props_rev_3"><a id="GUID-61143C61-B438-437F-99D1-EFC792B54D0E" name="GUID-61143C61-B438-437F-99D1-EFC792B54D0E"></a><h4 id="ADDCI-GUID-61143C61-B438-437F-99D1-EFC792B54D0E" class="sect4"><span class="enumeration_section">6.2.1</span>创建类型的LOB属性</h4>
                  <div>
                     <div class="example" id="GUID-61143C61-B438-437F-99D1-EFC792B54D0E__BABBJIJJ">
                        <p class="titleinexample">示例6-1创建类型的CLOB属性</p><pre class="oac_no_warn" dir="ltr">CREATE OR REPLACE TYPE lob_type AS OBJECT（id INTEGER，data CLOB）;</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADDCI4365"></a><div class="props_rev_3"><a id="GUID-87822A0C-02FF-4E86-BA84-1817A40A13B8" name="GUID-87822A0C-02FF-4E86-BA84-1817A40A13B8"></a><h4 id="ADDCI-GUID-87822A0C-02FF-4E86-BA84-1817A40A13B8" class="sect4"><span class="enumeration_section">6.2.2</span>创建LOB对象表</h4>
                  <div>
                     <div class="example" id="GUID-87822A0C-02FF-4E86-BA84-1817A40A13B8__BABGJJFH">
                        <p class="titleinexample">示例6-2创建LOB对象表</p><pre class="oac_no_warn" dir="ltr">CREATE TABLE lob_table OF lob_type;</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADDCI4366"></a><div class="props_rev_3"><a id="GUID-1AB23E62-1CF2-4AC3-94FB-DDEE5E350E06" name="GUID-1AB23E62-1CF2-4AC3-94FB-DDEE5E350E06"></a><h4 id="ADDCI-GUID-1AB23E62-1CF2-4AC3-94FB-DDEE5E350E06" class="sect4"><span class="enumeration_section">6.2.3</span>创建LOB列</h4>
                  <div>
                     <div class="example" id="GUID-1AB23E62-1CF2-4AC3-94FB-DDEE5E350E06__BABHBICA">
                        <p class="titleinexample">示例6-3在表中创建LOB列</p><pre class="oac_no_warn" dir="ltr">CREATE TABLE lob_table1（id INTEGER，b_lob BLOB，c_lob CLOB，nc_lob NCLOB，b_file BFILE）;</pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
            </div><a id="ADDCI4367"></a><div class="props_rev_3"><a id="GUID-F4531245-D6C3-4CCA-9A20-2DA6D2A26C23" name="GUID-F4531245-D6C3-4CCA-9A20-2DA6D2A26C23"></a><h3 id="ADDCI-GUID-F4531245-D6C3-4CCA-9A20-2DA6D2A26C23" class="sect3"><span class="enumeration_section">6.3</span> LOB定位器</h3>
               <div>
                  <p><code class="codeph">LOBs</code>可以与其他行数据一起存储，也可以与行数据分开存储。无论存储位置如何，每个<code class="codeph">LOB</code>都有一个<span class="bold">定位器</span> ，可以将其视为指向实际位置的句柄或指针。选择<code class="codeph">LOB</code>将返回<code class="codeph">LOB</code>定位符而不是<code class="codeph">LOB</code>值。<a href="working-with-multimedia-data-types.html#GUID-0C7A5625-64C9-4136-B178-A23B59D3BB09__BABJHDFE">例6-4</a>为<code class="codeph">b_lob</code>选择<code class="codeph">LOB</code>定位器，并将其放置一个名为<code class="codeph">image1</code>的PL / SQL局部变量。
                  </p>
                  <p>当您使用API函数来操作<code class="codeph">LOB</code>值时，您可以使用定位器来引用<code class="codeph">LOB</code> 。PL / SQL <code class="codeph">DBMS_LOB</code>包中包含操作<code class="codeph">LOBs</code>有用例程，例如<code class="codeph">PUT_LINE()</code>和<code class="codeph">GETLENGTH()</code> ，如<a href="working-with-multimedia-data-types.html#GUID-D9C704E8-38DB-47FA-8FD2-782462C0A3C9__BABHDCHH">例6-5所示</a> 。
                  </p>
                  <p>在OCI中， <code class="codeph">LOB</code>定位符映射到<code class="codeph">LOBLocatorPointers</code> ，例如<code class="codeph">OCILobLocator *</code> 。
                  </p>
                  <p>对于<code class="codeph">BFILE</code> ， <code class="codeph">LOB</code>列具有其自己的不同定位符，该定位符指<code class="codeph">LOB's</code>是存储在服务器文件系统中的外部文件中的<code class="codeph">LOB's</code>值。这意味着具有<code class="codeph">BFILE</code>列的表中的两行可以引用相同的文件或两个不同的文件。PL / SQL或OCI程序中的<code class="codeph">BFILE</code>定位器变量的行为与任何其他自动变量相同。关于文件操作，它的行为类似于可用作大多数传统编程语言的标准I / O库的一部分的文件描述符。
                  </p>
                  <div class="infoboxnotealso" id="GUID-F4531245-D6C3-4CCA-9A20-2DA6D2A26C23__GUID-BD5B2FB8-DCE8-42DB-940D-826D73FC77C7">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/addci&amp;id=ADLOB-GUID-1A2B0023-9EE8-48AF-AA76-171D1FC5C241" target="_blank"><span><cite>Oracle Database SecureFiles和大对象开发人员指南</cite></span></a></p>
                        </li>
                        <li>
                           <p>适用于<code class="codeph">DBMS_LOB</code> API的<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/addci&amp;id=ADLOB-GUID-EC76077B-3EE9-491E-AC6D-171DA919B84C" target="_blank"><span><cite>Oracle Database SecureFiles和Large Objects Developer's Guide</cite></span></a></p>
                        </li>
                     </ul>
                  </div>
               </div><a id="ADDCI4368"></a><div class="props_rev_3"><a id="GUID-0C7A5625-64C9-4136-B178-A23B59D3BB09" name="GUID-0C7A5625-64C9-4136-B178-A23B59D3BB09"></a><h4 id="ADDCI-GUID-0C7A5625-64C9-4136-B178-A23B59D3BB09" class="sect4"><span class="enumeration_section">6.3.1</span>选择LOB并将其分配给局部变量</h4>
                  <div>
                     <div class="example" id="GUID-0C7A5625-64C9-4136-B178-A23B59D3BB09__BABJHDFE">
                        <p class="titleinexample">示例6-4选择LOB定位器并将其分配给局部变量</p><pre class="oac_no_warn" dir="ltr">DECLARE image1 BLOB; image_no INTEGER：= 101; BEGIN SELECT b_lob INTO image1 FROM lob_table WHERE key_value = image_no; ...结束;</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADDCI4369"></a><div class="props_rev_3"><a id="GUID-D9C704E8-38DB-47FA-8FD2-782462C0A3C9" name="GUID-D9C704E8-38DB-47FA-8FD2-782462C0A3C9"></a><h4 id="ADDCI-GUID-D9C704E8-38DB-47FA-8FD2-782462C0A3C9" class="sect4"><span class="enumeration_section">6.3.2</span>操作LOB</h4>
                  <div>
                     <div class="example" id="GUID-D9C704E8-38DB-47FA-8FD2-782462C0A3C9__BABHDCHH">
                        <p class="titleinexample">例6-5使用PUT_LINE（）和GETLENGTH（）操作LOB</p><pre class="oac_no_warn" dir="ltr">BEGIN DBMS_OUTPUT.PUT_LINE（'图像大小为：'，DBMS_LOB.GETLENGTH（image1））;结束;</pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
            </div><a id="ADDCI4370"></a><div class="props_rev_3"><a id="GUID-FD83F576-F342-4097-AF0C-DE653EC52703" name="GUID-FD83F576-F342-4097-AF0C-DE653EC52703"></a><h3 id="ADDCI-GUID-FD83F576-F342-4097-AF0C-DE653EC52703" class="sect3"><span class="enumeration_section">6.4</span>清空LOB</h3>
               <div>
                  <p><a id="d13586e863" class="indexterm-anchor"></a><a id="d13586e865" class="indexterm-anchor"></a><a id="d13586e867" class="indexterm-anchor"></a><a id="d13586e871" class="indexterm-anchor"></a>在SQL DML的<code class="codeph">INSERT</code>或<code class="codeph">UPDATE</code>语句中使用特殊函数<code class="codeph">EMPTY_BLOB</code>和<code class="codeph">EMPTY_CLOB</code>将<code class="codeph">NULL</code>或非<code class="codeph">NULL</code>内部<code class="codeph">LOB</code>初始化为空。它们在Oracle SQL DML中作为特殊函数提供，不属于<code class="codeph">DBMS_LOB</code>包。
                  </p>
                  <p>在使用OCI或<code class="codeph">DBMS_LOB</code>包将数据写入内部<code class="codeph">LOB</code>之前，必须使<code class="codeph">LOB</code> <code class="codeph">DBMS_LOB</code>非空;它必须包含一个指向空的或填充的<code class="codeph">LOB</code>值的定位器。您可以使用<code class="codeph">INSERT</code>语句的<code class="codeph">VALUES</code>子句中的函数<code class="codeph">EMPTY_BLOB</code>将<code class="codeph">BLOB</code>列的值初始化为空。类似地，可以使用函数<code class="codeph">EMPTY_CLOB</code>初始化<code class="codeph">CLOB</code>或<code class="codeph">NCLOB</code>列的值。以下是这些函数的语法：</p><pre class="oac_no_warn" dir="ltr">功能EMPTY_BLOB（）返回BLOB;功能EMPTY_CLOB（）返回CLOB;</pre><p><code class="codeph">EMPTY_BLOB</code>返回<code class="codeph">BLOB</code>类型的空定位符， <code class="codeph">EMPTY_CLOB</code>返回<code class="codeph">CLOB</code>类型的空定位符，也可用于<code class="codeph">NCLOBs</code> 。这些函数没有关联的编译指示。
                  </p>
                  <p>如果在SQL <code class="codeph">INSERT</code>语句的<code class="codeph">VALUES</code>子句中使用这些函数，或者在SQL <code class="codeph">UPDATE</code>语句中使用<code class="codeph">SET</code>子句的源，则会引发异常。
                  </p>
                  <p><a href="working-with-multimedia-data-types.html#GUID-14969C25-1BDD-4949-89FB-04F6C35931E4__BABHDFFG">例6-6</a>显示了与SQL DML一起使用的<code class="codeph">EMPTY_BLOB()</code> 。</p>
                  <p><a href="working-with-multimedia-data-types.html#GUID-76A690D6-FA22-4A4E-BF52-2E82FB2A7678__BABICAAD">例6-7</a>显示了如何在PL / SQL程序中使用<code class="codeph">EMPTY_CLOB()</code> 。
                  </p>
               </div><a id="ADDCI4372"></a><div class="props_rev_3"><a id="GUID-14969C25-1BDD-4949-89FB-04F6C35931E4" name="GUID-14969C25-1BDD-4949-89FB-04F6C35931E4"></a><h4 id="ADDCI-GUID-14969C25-1BDD-4949-89FB-04F6C35931E4" class="sect4"><span class="enumeration_section">6.4.1</span>在SQL中使用EMPTY_BLOB（）</h4>
                  <div>
                     <div class="example" id="GUID-14969C25-1BDD-4949-89FB-04F6C35931E4__BABHDFFG">
                        <p class="titleinexample">示例6-6将EMPTY_BLOB（）与SQL DML一起使用</p><pre class="oac_no_warn" dir="ltr">INSERT INTO lob_table VALUES（1001，EMPTY_BLOB（），'abcde'，NULL）; UPDATE lob_table SET c_lob = EMPTY_CLOB（）WHERE key_value = 1001; INSERT INTO lob_table VALUES（1002，NULL，NULL，NULL）;</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADDCI4373"></a><div class="props_rev_3"><a id="GUID-76A690D6-FA22-4A4E-BF52-2E82FB2A7678" name="GUID-76A690D6-FA22-4A4E-BF52-2E82FB2A7678"></a><h4 id="ADDCI-GUID-76A690D6-FA22-4A4E-BF52-2E82FB2A7678" class="sect4"><span class="enumeration_section">6.4.2</span>在PL / SQL中使用EMPTY_CLOB（）</h4>
                  <div>
                     <div class="example" id="GUID-76A690D6-FA22-4A4E-BF52-2E82FB2A7678__BABICAAD">
                        <p class="titleinexample">示例6-7在PL / SQL程序中使用EMPTY_CLOB（）</p><pre class="oac_no_warn" dir="ltr">DECLARE lobb CLOB; read_offset INTEGER; read_amount INTEGER; rawbuf RAW（20）; charbuf VARCHAR2（20）; BEGIN read_amount：= 10; read_offset：= 1; UPDATE lob_table SET c_lob = EMPTY_CLOB（）WHERE key_value = 1002 RETURNING c_lob INTO lobb; dbms_lob.read（lobb，read_amount，read_offset，charbuf）; dbms_output.put_line（'lobb value：'|| charbuf）;结束</pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
            </div><a id="ADDCI4374"></a><div class="props_rev_3"><a id="GUID-2D71AE31-E5DA-4B81-80ED-A4F92ABCB922" name="GUID-2D71AE31-E5DA-4B81-80ED-A4F92ABCB922"></a><h3 id="ADDCI-GUID-2D71AE31-E5DA-4B81-80ED-A4F92ABCB922" class="sect3"><span class="enumeration_section">6.5</span>使用OCI操纵LOB</h3>
               <div>
                  <p><a id="d13586e1151" class="indexterm-anchor"></a><a id="d13586e1155" class="indexterm-anchor"></a><a id="d13586e1159" class="indexterm-anchor"></a> OCI包括允许访问存储在<code class="codeph">BLOB</code> ， <code class="codeph">CLOB</code> ， <code class="codeph">NCLOB</code>和<code class="codeph">BFILE</code>的数据的函数。<a href="working-with-multimedia-data-types.html#GUID-042E45FA-42D0-4F3C-B5A5-1009DD053913__BABGGIFB" title="列出用于操作LOB的OCI函数，并描述每个函数的功能">表6-1</a>介绍了这些功能。
                  </p>
                  <p><a id="d13586e1181" class="indexterm-anchor"></a><a id="d13586e1185" class="indexterm-anchor"></a> <a href="working-with-multimedia-data-types.html#GUID-58B9AA75-7B63-4103-9996-DE3AEA436BB7__BABEEBBC" title="可比较的OC和PL / SQL（DBMS_LOB）接口的并排列表">表6-2</a>根据<code class="codeph">LOB</code>访问比较了OCI和PL / SQL（ <code class="codeph">DBMS_LOB</code>包）接口。
                  </p>
                  <p><a href="working-with-multimedia-data-types.html#GUID-8CDF3D3F-59A0-4B92-9B43-E802E15374A9__BABEAIFE">例6-8</a>显示了如何从数据库中选择<code class="codeph">LOB</code>到定位器。它假定类型<code class="codeph">lob_type</code>有两个属性，类型为<code class="codeph">INTEGER</code> <code class="codeph">id</code>和类型为<code class="codeph">CLOB</code> <code class="codeph">data</code> ，并且存在类型为<code class="codeph">lob_type</code>的表<code class="codeph">lob_table</code> 。
                  </p>
                  <p>示例程序<code class="codeph">populate.c</code>使用OCI用文件内容填充<code class="codeph">CLOB</code> 。
                  </p>
                  <div class="infoboxnotealso" id="GUID-2D71AE31-E5DA-4B81-80ED-A4F92ABCB922__GUID-066E33B4-2ABA-4DBE-8AB0-11646E9D8FB8">
                     <p class="notep1">也可以看看：</p>
                     <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/addci&amp;id=LNOCI-GUID-699FFE4B-07C8-4904-959F-3686E73B8188" target="_blank"><span class="variable" translate="no">Oracle Call Interface Programmer's Guide</span></a>用于详细文档，包括参数，参数类型，返回值和示例代码。
                     </p>
                  </div>
               </div><a id="ADDCI4375"></a><div class="props_rev_3"><a id="GUID-042E45FA-42D0-4F3C-B5A5-1009DD053913" name="GUID-042E45FA-42D0-4F3C-B5A5-1009DD053913"></a><h4 id="ADDCI-GUID-042E45FA-42D0-4F3C-B5A5-1009DD053913" class="sect4"><span class="enumeration_section">6.5.1</span>操作LOB的OCI函数</h4>
                  <div>
                     <div class="tblformal" id="GUID-042E45FA-42D0-4F3C-B5A5-1009DD053913__BABGGIFB">
                        <p class="titleintable">表6-1操作LOB的OCI功能汇总</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="操作LOB的OCI功能总结" width="100%" border="1" summary="Lists the OCI functions used to manipulate LOBs and describes the function of each" frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="41%" id="d13586e1306">功能</th>
                                 <th align="left" valign="bottom" width="59%" id="d13586e1309">描述</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d13586e1314" headers="d13586e1306 "><code class="codeph">OCILobAppend（）</code></td>
                                 <td align="left" valign="top" width="59%" headers="d13586e1314 d13586e1309 ">
                                    <p>将LOB值附加到另一个<code class="codeph">LOB</code> 。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d13586e1324" headers="d13586e1306 "><code class="codeph">OCILobArrayRead（）</code></td>
                                 <td align="left" valign="top" width="59%" headers="d13586e1324 d13586e1309 ">
                                    <p>在一次往返中读取多个定位器的LOB数据。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d13586e1331" headers="d13586e1306 "><code class="codeph">OCILobArrayWrite（）</code></td>
                                 <td align="left" valign="top" width="59%" headers="d13586e1331 d13586e1309 ">
                                    <p>在一次往返中为多个定位器写入LOB数据。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d13586e1338" headers="d13586e1306 "><code class="codeph">OCILobAssign（）</code></td>
                                 <td align="left" valign="top" width="59%" headers="d13586e1338 d13586e1309 ">
                                    <p>将一个LOB定位器分配给另一个。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d13586e1345" headers="d13586e1306 "><code class="codeph">OCILobCharSetForm（）</code></td>
                                 <td align="left" valign="top" width="59%" headers="d13586e1345 d13586e1309 ">
                                    <p>返回<code class="codeph">LOB</code>的字符集形式。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d13586e1355" headers="d13586e1306 "><code class="codeph">OCILobCharSetId（）</code></td>
                                 <td align="left" valign="top" width="59%" headers="d13586e1355 d13586e1309 ">
                                    <p>返回<code class="codeph">LOB</code>的字符集ID。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d13586e1365" headers="d13586e1306 "><code class="codeph">OCILobClose（）</code></td>
                                 <td align="left" valign="top" width="59%" headers="d13586e1365 d13586e1309 ">
                                    <p>关闭先前打开的LOB或<code class="codeph">BFILE</code> 。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d13586e1375" headers="d13586e1306 "><code class="codeph">OCILobCopy2（）</code></td>
                                 <td align="left" valign="top" width="59%" headers="d13586e1375 d13586e1309 ">
                                    <p>将全部或部分LOB复制到另一个LOB中;替换已弃用的方法<code class="codeph">OCILobCopy()</code> 。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d13586e1385" headers="d13586e1306 "><code class="codeph">OCILobCreateTemporary（）</code></td>
                                 <td align="left" valign="top" width="59%" headers="d13586e1385 d13586e1309 ">
                                    <p>创建一个临时LOB。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d13586e1392" headers="d13586e1306 "><code class="codeph">OCILobDisableBuffering（）</code></td>
                                 <td align="left" valign="top" width="59%" headers="d13586e1392 d13586e1309 ">
                                    <p>禁用缓冲子系统使用。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d13586e1399" headers="d13586e1306 "><code class="codeph">OCILobEnableBuffering（）</code></td>
                                 <td align="left" valign="top" width="59%" headers="d13586e1399 d13586e1309 ">
                                    <p>使用LOB缓冲子系统进行<code class="codeph">LOB</code>数据的后续读写操作。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d13586e1410" headers="d13586e1306 "><code class="codeph">OCILobErase2（）</code></td>
                                 <td align="left" valign="top" width="59%" headers="d13586e1410 d13586e1309 ">
                                    <p>从指定的偏移开始擦除全部或部分aLOB;替换已弃用的方法<code class="codeph">OCILobErase()</code> 。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d13586e1420" headers="d13586e1306 "><code class="codeph">OCILobFileClose（）</code></td>
                                 <td align="left" valign="top" width="59%" headers="d13586e1420 d13586e1309 ">
                                    <p>关闭一个打开的<code class="codeph">BFILE</code> 。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d13586e1430" headers="d13586e1306 "><code class="codeph">OCILobFileCloseAll（）</code></td>
                                 <td align="left" valign="top" width="59%" headers="d13586e1430 d13586e1309 ">
                                    <p>关闭所有打开的<code class="codeph">BFILEs</code> 。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d13586e1440" headers="d13586e1306 "><code class="codeph">OCILobFileExists（）</code></td>
                                 <td align="left" valign="top" width="59%" headers="d13586e1440 d13586e1309 ">
                                    <p>确定是否存在<code class="codeph">BFILE</code> 。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d13586e1450" headers="d13586e1306 "><code class="codeph">OCILobFileGetName（）</code></td>
                                 <td align="left" valign="top" width="59%" headers="d13586e1450 d13586e1309 ">
                                    <p>返回<code class="codeph">BFILE</code>的名称。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d13586e1460" headers="d13586e1306 "><code class="codeph">OCILobFileIsOpen（）</code></td>
                                 <td align="left" valign="top" width="59%" headers="d13586e1460 d13586e1309 ">
                                    <p>确定<code class="codeph">BFILE</code>是否已打开。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d13586e1470" headers="d13586e1306 "><code class="codeph">OCILobFileOpen（）</code></td>
                                 <td align="left" valign="top" width="59%" headers="d13586e1470 d13586e1309 ">
                                    <p>打开<code class="codeph">BFILE</code> 。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d13586e1480" headers="d13586e1306 "><code class="codeph">OCILobFileSetName（）</code></td>
                                 <td align="left" valign="top" width="59%" headers="d13586e1480 d13586e1309 ">
                                    <p>设置定位器中<code class="codeph">BFILE</code>的名称。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d13586e1490" headers="d13586e1306 "><code class="codeph">OCILobFlushBuffer（）</code></td>
                                 <td align="left" valign="top" width="59%" headers="d13586e1490 d13586e1309 ">
                                    <p>将对LOB缓冲子系统所做的更改刷新到数据库（服务器）</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d13586e1497" headers="d13586e1306 "><code class="codeph">OCILobFreeTemporary（）</code></td>
                                 <td align="left" valign="top" width="59%" headers="d13586e1497 d13586e1309 ">
                                    <p>释放临时LOB。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d13586e1504" headers="d13586e1306 "><code class="codeph">OCILobGetChunkSize（）</code></td>
                                 <td align="left" valign="top" width="59%" headers="d13586e1504 d13586e1309 ">
                                    <p>获取LOB的块大小。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d13586e1512" headers="d13586e1306 "><code class="codeph">OCILobGetContentType（）</code></td>
                                 <td align="left" valign="top" width="59%" headers="d13586e1512 d13586e1309 ">
                                    <p>获取SecureFile中数据的用户指定的内容类型字符串（如果已设置）。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d13586e1519" headers="d13586e1306 "><code class="codeph">OCILobGetLength2（）</code></td>
                                 <td align="left" valign="top" width="59%" headers="d13586e1519 d13586e1309 ">
                                    <p>获取LOB的长度;替换了已弃用的方法<code class="codeph">OCILobGetLength()</code> 。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d13586e1529" headers="d13586e1306 "><code class="codeph">OCILobGetOptions（）</code></td>
                                 <td align="left" valign="top" width="59%" headers="d13586e1529 d13586e1309 ">
                                    <p>获取与指定的<span>SecureFile</span> LOB的指定输入选项类型对应的已启用设置。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d13586e1539" headers="d13586e1306 "><code class="codeph">OCILobGetStorageLimit（）</code></td>
                                 <td align="left" valign="top" width="59%" headers="d13586e1539 d13586e1309 ">
                                    <p>获取LOB（ <code class="codeph">BLOB</code> ， <code class="codeph">CLOB</code>或<code class="codeph">NCLOB</code> ）的最大长度（以字节为单位）。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d13586e1555" headers="d13586e1306 "><code class="codeph">OCILobIsEqual（）</code></td>
                                 <td align="left" valign="top" width="59%" headers="d13586e1555 d13586e1309 ">
                                    <p>确定两个LOB定位符是否引用相同的<code class="codeph">LOB</code> 。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d13586e1565" headers="d13586e1306 "><code class="codeph">OCILobIsOpen（）</code></td>
                                 <td align="left" valign="top" width="59%" headers="d13586e1565 d13586e1309 ">
                                    <p>确定LOB或<code class="codeph">BFILE</code>是否已打开。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d13586e1575" headers="d13586e1306 "><code class="codeph">OCILobIsTemporary（）</code></td>
                                 <td align="left" valign="top" width="59%" headers="d13586e1575 d13586e1309 ">
                                    <p>确定定位器是否指向临时LOB。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d13586e1582" headers="d13586e1306 "><code class="codeph">OCILobLoadFromFile2（）</code></td>
                                 <td align="left" valign="top" width="59%" headers="d13586e1582 d13586e1309 ">
                                    <p>将<code class="codeph">BFILE</code>数据加载到内部LOB中;替换了已弃用的方法<code class="codeph">OCILobLoadFromFile()</code> 。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d13586e1595" headers="d13586e1306 "><code class="codeph">OCILobLocatorAssign（）</code></td>
                                 <td align="left" valign="top" width="59%" headers="d13586e1595 d13586e1309 ">
                                    <p>将一个LOB或<code class="codeph">BFILE</code>定位器分配给另一个。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d13586e1605" headers="d13586e1306 "><code class="codeph">OCILobLocatorIsInit（）</code></td>
                                 <td align="left" valign="top" width="59%" headers="d13586e1605 d13586e1309 ">
                                    <p>测试是否初始化LOB定位器。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d13586e1612" headers="d13586e1306 "><code class="codeph">OCILobOpen（）</code></td>
                                 <td align="left" valign="top" width="59%" headers="d13586e1612 d13586e1309 ">
                                    <p>以指定模式打开LOB。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d13586e1620" headers="d13586e1306 "><code class="codeph">OCILobRead2（）</code></td>
                                 <td align="left" valign="top" width="59%" headers="d13586e1620 d13586e1309 ">
                                    <p>将非空LOB或<code class="codeph">BFILE</code>的指定部分读入缓冲区;替换已弃用的方法<code class="codeph">OCILobRead()</code> 。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d13586e1633" headers="d13586e1306 "><code class="codeph">OCILobSetContentType（）</code></td>
                                 <td align="left" valign="top" width="59%" headers="d13586e1633 d13586e1309 ">
                                    <p>为<code class="codeph">SecureFile</code> LOB中的数据设置内容类型字符串。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d13586e1643" headers="d13586e1306 "><code class="codeph">OCILobSetOptions（）</code></td>
                                 <td align="left" valign="top" width="59%" headers="d13586e1643 d13586e1309 ">
                                    <p>启用<code class="codeph">SecureFile</code> LOB的选项设置。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d13586e1653" headers="d13586e1306 "><code class="codeph">OCILobTrim2（）</code></td>
                                 <td align="left" valign="top" width="59%" headers="d13586e1653 d13586e1309 ">
                                    <p>截断LOB;替换已弃用的方法<code class="codeph">OCILobTrim()</code> 。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d13586e1663" headers="d13586e1306 "><code class="codeph">OCILobWrite2（）</code></td>
                                 <td align="left" valign="top" width="59%" headers="d13586e1663 d13586e1309 ">
                                    <p>将数据从缓冲区写入LOB，写入现有数据;替换已弃用的方法<code class="codeph">OCILobWrite()</code> 。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d13586e1673" headers="d13586e1306 "><code class="codeph">OCILobWriteAppend2（）</code></td>
                                 <td align="left" valign="top" width="59%" headers="d13586e1673 d13586e1309 ">
                                    <p>从LOB的当前末尾开始写入数据;替换已弃用的方法<code class="codeph">OCILobWriteAppend()</code> 。
                                    </p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div>
               </div><a id="ADDCI4376"></a><div class="props_rev_3"><a id="GUID-58B9AA75-7B63-4103-9996-DE3AEA436BB7" name="GUID-58B9AA75-7B63-4103-9996-DE3AEA436BB7"></a><h4 id="ADDCI-GUID-58B9AA75-7B63-4103-9996-DE3AEA436BB7" class="sect4"><span class="enumeration_section">6.5.2</span>比较OCI和PL / SQL接口</h4>
                  <div>
                     <div class="tblformal" id="GUID-58B9AA75-7B63-4103-9996-DE3AEA436BB7__BABEEBBC">
                        <p class="titleintable">表6-2 OCI和PL / SQL（DBMS_LOB）接口比较</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="OCI和PL / SQL（DBMS_LOB）接口比较" width="100%" border="1" summary="Side-by-side list of comparable OC and PL/SQL (DBMS_LOB) interfaces" frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="38%" id="d13586e1745">OCI（ociap.h）</th>
                                 <th align="left" valign="bottom" width="62%" id="d13586e1748">PL / SQL DBMS_LOB（dbmslob.sql）</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d13586e1753" headers="d13586e1745 ">
                                    <p>N / A</p>
                                 </td>
                                 <td align="left" valign="top" width="62%" headers="d13586e1753 d13586e1748 "><pre class="oac_no_warn" dir="ltr">DBMS_LOB.COMPARE（）</pre></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d13586e1760" headers="d13586e1745 ">
                                    <p>N / A</p>
                                 </td>
                                 <td align="left" valign="top" width="62%" headers="d13586e1760 d13586e1748 "><pre class="oac_no_warn" dir="ltr">DBMS_LOB.INSTR（）</pre></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d13586e1767" headers="d13586e1745 ">
                                    <p>N / A</p>
                                 </td>
                                 <td align="left" valign="top" width="62%" headers="d13586e1767 d13586e1748 "><pre class="oac_no_warn" dir="ltr">DBMS_LOB.SUBSTR（）</pre></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d13586e1774" headers="d13586e1745 "><pre class="oac_no_warn" dir="ltr">OCILobAppend（）</pre></td>
                                 <td align="left" valign="top" width="62%" headers="d13586e1774 d13586e1748 "><pre class="oac_no_warn" dir="ltr">DBMS_LOB.APPEND（）</pre></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d13586e1781" headers="d13586e1745 "><pre class="oac_no_warn" dir="ltr">OCILobAssign（）</pre></td>
                                 <td align="left" valign="top" width="62%" headers="d13586e1781 d13586e1748 ">
                                    <p>N / A [使用PL / SQL分配运算符]</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d13586e1788" headers="d13586e1745 "><pre class="oac_no_warn" dir="ltr">OCILobCharSetForm（）</pre></td>
                                 <td align="left" valign="top" width="62%" headers="d13586e1788 d13586e1748 ">
                                    <p>N / A</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d13586e1795" headers="d13586e1745 "><pre class="oac_no_warn" dir="ltr">OCILobCharSetId（）</pre></td>
                                 <td align="left" valign="top" width="62%" headers="d13586e1795 d13586e1748 ">
                                    <p>N / A</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d13586e1802" headers="d13586e1745 "><pre class="oac_no_warn" dir="ltr">OCILobCopy（）</pre></td>
                                 <td align="left" valign="top" width="62%" headers="d13586e1802 d13586e1748 "><pre class="oac_no_warn" dir="ltr">DBMS_LOB.COPY（）</pre></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d13586e1809" headers="d13586e1745 "><pre class="oac_no_warn" dir="ltr">OCILobDisableBuffering（）</pre></td>
                                 <td align="left" valign="top" width="62%" headers="d13586e1809 d13586e1748 ">
                                    <p>N / A</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d13586e1816" headers="d13586e1745 "><pre class="oac_no_warn" dir="ltr">OCILobEnableBuffering（）</pre></td>
                                 <td align="left" valign="top" width="62%" headers="d13586e1816 d13586e1748 ">
                                    <p>N / A</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d13586e1823" headers="d13586e1745 "><pre class="oac_no_warn" dir="ltr">OCILobErase（）</pre></td>
                                 <td align="left" valign="top" width="62%" headers="d13586e1823 d13586e1748 "><pre class="oac_no_warn" dir="ltr">DBMS_LOB.ERASE（）</pre></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d13586e1831" headers="d13586e1745 "><pre class="oac_no_warn" dir="ltr">OCILobFileClose（）</pre></td>
                                 <td align="left" valign="top" width="62%" headers="d13586e1831 d13586e1748 "><pre class="oac_no_warn" dir="ltr">DBMS_LOB.FILECLOSE（）</pre></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d13586e1838" headers="d13586e1745 "><pre class="oac_no_warn" dir="ltr">OCILobFileCloseAll（）</pre></td>
                                 <td align="left" valign="top" width="62%" headers="d13586e1838 d13586e1748 "><pre class="oac_no_warn" dir="ltr">DBMS_LOB.FILECLOSEALL（）</pre></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d13586e1845" headers="d13586e1745 "><pre class="oac_no_warn" dir="ltr">OCILobFileExists（）</pre></td>
                                 <td align="left" valign="top" width="62%" headers="d13586e1845 d13586e1748 "><pre class="oac_no_warn" dir="ltr">DBMS_LOB.FILEEXISTS（）</pre></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d13586e1852" headers="d13586e1745 "><pre class="oac_no_warn" dir="ltr">OCILobFileGetName（）</pre></td>
                                 <td align="left" valign="top" width="62%" headers="d13586e1852 d13586e1748 "><pre class="oac_no_warn" dir="ltr">DBMS_LOB.FILEGETNAME（）</pre></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d13586e1859" headers="d13586e1745 "><pre class="oac_no_warn" dir="ltr">OCILobFileIsOpen（）</pre></td>
                                 <td align="left" valign="top" width="62%" headers="d13586e1859 d13586e1748 "><pre class="oac_no_warn" dir="ltr">DBMS_LOB.FILEISOPEN（）</pre></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d13586e1866" headers="d13586e1745 "><pre class="oac_no_warn" dir="ltr">OCILobFileOpen（）</pre></td>
                                 <td align="left" valign="top" width="62%" headers="d13586e1866 d13586e1748 "><pre class="oac_no_warn" dir="ltr">DBMS_LOB.FILEOPEN（）</pre></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d13586e1873" headers="d13586e1745 "><pre class="oac_no_warn" dir="ltr">OCILobFileSetName（）</pre></td>
                                 <td align="left" valign="top" width="62%" headers="d13586e1873 d13586e1748 ">
                                    <p>N / A（使用<code class="codeph">BFILENAME</code>运算符）</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d13586e1883" headers="d13586e1745 "><pre class="oac_no_warn" dir="ltr">OCILobFlushBuffer（）</pre></td>
                                 <td align="left" valign="top" width="62%" headers="d13586e1883 d13586e1748 ">
                                    <p>N / A</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d13586e1890" headers="d13586e1745 "><pre class="oac_no_warn" dir="ltr">OCILobGetLength（）</pre></td>
                                 <td align="left" valign="top" width="62%" headers="d13586e1890 d13586e1748 "><pre class="oac_no_warn" dir="ltr">DBMS_LOB.GETLENGTH（）</pre></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d13586e1897" headers="d13586e1745 "><pre class="oac_no_warn" dir="ltr">OCILobIsEqual（）</pre></td>
                                 <td align="left" valign="top" width="62%" headers="d13586e1897 d13586e1748 ">
                                    <p>N / A</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d13586e1904" headers="d13586e1745 "><pre class="oac_no_warn" dir="ltr">OCILobLocatorIsInit（）</pre></td>
                                 <td align="left" valign="top" width="62%" headers="d13586e1904 d13586e1748 ">
                                    <p>N / A [始终初始化]</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d13586e1912" headers="d13586e1745 "><pre class="oac_no_warn" dir="ltr">OCILobRead（）</pre></td>
                                 <td align="left" valign="top" width="62%" headers="d13586e1912 d13586e1748 "><pre class="oac_no_warn" dir="ltr">DBMS_LOB.READ（）</pre></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d13586e1919" headers="d13586e1745 "><pre class="oac_no_warn" dir="ltr">OCILobTrim（）</pre></td>
                                 <td align="left" valign="top" width="62%" headers="d13586e1919 d13586e1748 "><pre class="oac_no_warn" dir="ltr">DBMS_LOB.TRIM（）</pre></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="38%" id="d13586e1926" headers="d13586e1745 "><pre class="oac_no_warn" dir="ltr">OCILobWrite（）</pre></td>
                                 <td align="left" valign="top" width="62%" headers="d13586e1926 d13586e1748 "><pre class="oac_no_warn" dir="ltr">DBMS_LOB.WRITE（）</pre></td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div>
               </div><a id="ADDCI4377"></a><div class="props_rev_3"><a id="GUID-8CDF3D3F-59A0-4B92-9B43-E802E15374A9" name="GUID-8CDF3D3F-59A0-4B92-9B43-E802E15374A9"></a><h4 id="ADDCI-GUID-8CDF3D3F-59A0-4B92-9B43-E802E15374A9" class="sect4"><span class="enumeration_section">6.5.3</span>选择存储的LOB到定位器</h4>
                  <div>
                     <div class="example" id="GUID-8CDF3D3F-59A0-4B92-9B43-E802E15374A9__BABEAIFE">
                        <p class="titleinexample">示例6-8从数据库中选择LOB到定位器</p><pre class="oac_no_warn" dir="ltr">/ * ------------------------------------------------ ----------------------- * / / *从CLOB列中选择lob定位器* / / *使用'FOR UPDATE'子句写入LOB 。* / / * ---------------------------------------------- ------------------------- * / static OCIEnv * envhp; static OCIServer * srvhp; static OCISvcCtx * svchp; static OCIError * errhp; static OCISession * authp; static OCIStmt * stmthp; static OCIDefine * defnp1; static OCIBind * bndhp; sb4 select_locator（int rowind）{sword retval;布尔标志; int colc = rowind; OCILobLocator * clob; text * sqlstmt =（text *）“从LOB_TABLE中选择数据，其中ID =：1 FOR FORDDATE”; if（OCIStmtPrepare（stmthp，errhp，sqlstmt，（ub4）strlen（（char *）sqlstmt），（ub4）OCI_NTV_SYNTAX，（ub4）OCI_DEFAULT））{（void）printf（“FAILED：OCIStmtPrepare（）sqlstmt \ n”） ;返回OCI_ERROR; } if（OCIStmtBindByPos（stmthp，bndhp，errhp，（ub4）1，（dvoid *）＆colc，（sb4）sizeof（colc），SQLT_INT，（dvoid *）0，（ub2 *）0，（ub2 *）0， （ub4）0，（ub4 *）0，（ub4）OCI_DEFAULT））{（void）printf（“FAILED：OCIStmtBindByPos（）\ n”）;返回OCI_ERROR; } if（OCIDefineByPos（stmthp，＆defnp1，errhp，（ub4）1，（dvoid *）＆clob，（sb4）-1，（ub2）SQLT_CLOB，（dvoid *）0，（ub2 *）0，（ub2 *）0 ，（ub4）OCI_DEFAULT））{（void）printf（“FAILED：OCIDefineByPos（）\ n”）;返回OCI_ERROR; } / *执行select和fetch one row * / if（OCIStmtExecute（svchp，stmthp，errhp，（ub4）1，（ub4）0，（CONST OCISnapshot *）0，（OCISnapshot *）0，（ub4）OCI_DEFAULT） ）{（void）printf（“FAILED：OCIStmtExecute（）sqlstmt \ n”）;的Report_Error（）;返回OCI_ERROR; / *现在测试是否初始化LOB定位器* / retval = OCILobLocatorIsInit（envhp，errhp，clob，＆flag）;如果（（retval！= OCI_SUCCESS）&amp;&amp;（retval！= OCI_SUCCESS_WITH_INFO））{（void）printf（“Select_Locator --ERROR：OCILobLocatorIsInit（），retval =％d \ n”，retval）;的Report_Error（）; checkerr（errhp，retval）;返回OCI_ERROR;如果（！flag）{（void）printf（“Select_Locator --ERROR：LOB Locator未初始化。\ n”）;返回OCI_ERROR; } return OCI_SUCCESS; }</pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
            </div><a id="ADDCI4378"></a><div class="props_rev_3"><a id="GUID-9F67DBF8-F49A-4346-B2B2-B7369A849C31" name="GUID-9F67DBF8-F49A-4346-B2B2-B7369A849C31"></a><h3 id="ADDCI-GUID-9F67DBF8-F49A-4346-B2B2-B7369A849C31" class="sect3"><span class="enumeration_section">6.6</span>使用DBMS_LOB包来操作LOB</h3>
               <div>
                  <div class="section">
                     <p><a id="d13586e2047" class="indexterm-anchor"></a> <code class="codeph">DBMS_LOB</code>包可用于操作PL / SQL中的<code class="codeph">LOBs</code> 。 <a href="working-with-multimedia-data-types.html#GUID-F299D3AA-27F1-44A6-B118-FC453C57A0B6__BABHCJHA" title="第1列命名例程，第2列提供其描述">表6-3</a>介绍了其例程。
                     </p>
                     <p><a href="working-with-multimedia-data-types.html#GUID-E7AE8D33-8513-489D-AB73-640D5B4E659C__BABDDJGI">例6-9</a>调用<code class="codeph">TRIM</code>过程将<code class="codeph">CLOB</code>值修剪为较小的长度。它假定类型<code class="codeph">lob_type</code>有两个属性，类型为<code class="codeph">INTEGER</code> <code class="codeph">id</code>和类型为<code class="codeph">CLOB</code> <code class="codeph">data</code> ，并且存在类型为<code class="codeph">lob_type</code>的表<code class="codeph">lob_table</code> 。因为此示例处理<code class="codeph">CLOB</code>数据，所以<code class="codeph">DBMS_LOB</code>的第二个参数。 <code class="codeph">TRIM</code> ，即文字<code class="codeph">834004</code> ，指定字符数。如果该示例处理<code class="codeph">BLOB</code>数据，则该参数将被解释为多个字节。
                     </p>
                     <div class="infoboxnotealso" id="GUID-9F67DBF8-F49A-4346-B2B2-B7369A849C31__GUID-916DC57A-E5AE-4F2B-A936-0C43973E8A9C">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/addci&amp;id=ARPLS600" target="_blank"><span class="italic">Oracle Database PL / SQL包和类型参考</span></a>提供了有关使用<code class="codeph">DBMS_LOB</code>包的例程的完整详细信息。
                        </p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div><a id="ADDCI4379"></a><div class="props_rev_3"><a id="GUID-F299D3AA-27F1-44A6-B118-FC453C57A0B6" name="GUID-F299D3AA-27F1-44A6-B118-FC453C57A0B6"></a><h4 id="ADDCI-GUID-F299D3AA-27F1-44A6-B118-FC453C57A0B6" class="sect4"><span class="enumeration_section">6.6.1</span> DBMS_LOB包例程</h4>
                  <div>
                     <div class="tblformal" id="GUID-F299D3AA-27F1-44A6-B118-FC453C57A0B6__BABHCJHA">
                        <p class="titleintable">表6-3 DBMS_LOB程序包例程摘要</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="DBMS_LOB包例程摘要" width="100%" border="1" summary="Column 1 names the routine, and column 2 provides its description" frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="31%" id="d13586e2181">常规</th>
                                 <th align="left" valign="bottom" width="69%" id="d13586e2184">描述</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d13586e2189" headers="d13586e2181 "><pre class="oac_no_warn" dir="ltr">附加（）</pre></td>
                                 <td align="left" valign="top" width="69%" headers="d13586e2189 d13586e2184 ">
                                    <p>将源<code class="codeph">LOB</code>的内容追加到目标<code class="codeph">LOB</code> 。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d13586e2202" headers="d13586e2181 "><pre class="oac_no_warn" dir="ltr">复制（）</pre></td>
                                 <td align="left" valign="top" width="69%" headers="d13586e2202 d13586e2184 ">
                                    <p>将全部或部分源<code class="codeph">LOB</code>复制到目标<code class="codeph">LOB</code> 。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d13586e2215" headers="d13586e2181 "><pre class="oac_no_warn" dir="ltr">ERASE（）</pre></td>
                                 <td align="left" valign="top" width="69%" headers="d13586e2215 d13586e2184 ">
                                    <p>删除全部或部分<code class="codeph">LOB</code> 。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d13586e2225" headers="d13586e2181 "><pre class="oac_no_warn" dir="ltr">LOADBLOBFROMFILE（）</pre></td>
                                 <td align="left" valign="top" width="69%" headers="d13586e2225 d13586e2184 ">
                                    <p>将<code class="codeph">BFILE</code>数据加载到内部<code class="codeph">BLOB</code> 。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d13586e2238" headers="d13586e2181 "><pre class="oac_no_warn" dir="ltr">LOADCLOBFROMFILE（）</pre></td>
                                 <td align="left" valign="top" width="69%" headers="d13586e2238 d13586e2184 ">
                                    <p>将<code class="codeph">BFILE</code>数据加载到内部<code class="codeph">CLOB</code> 。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d13586e2251" headers="d13586e2181 "><pre class="oac_no_warn" dir="ltr">修剪（）</pre></td>
                                 <td align="left" valign="top" width="69%" headers="d13586e2251 d13586e2184 ">
                                    <p>将<code class="codeph">LOB</code>值修剪为指定的较短长度。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d13586e2261" headers="d13586e2181 "><pre class="oac_no_warn" dir="ltr">写（）</pre></td>
                                 <td align="left" valign="top" width="69%" headers="d13586e2261 d13586e2184 ">
                                    <p>从指定的偏移量向<code class="codeph">LOB</code>写入数据</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d13586e2271" headers="d13586e2181 "><pre class="oac_no_warn" dir="ltr">GETLENGTH</pre></td>
                                 <td align="left" valign="top" width="69%" headers="d13586e2271 d13586e2184 ">
                                    <p>获取<code class="codeph">LOB</code>值的长度。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d13586e2281" headers="d13586e2181 "><pre class="oac_no_warn" dir="ltr">INSTR（）</pre></td>
                                 <td align="left" valign="top" width="69%" headers="d13586e2281 d13586e2184 ">
                                    <p>返回<code class="codeph">LOB</code>中第<span class="italic">n</span> <sup>次</sup>出现的模式的匹配位置。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d13586e2296" headers="d13586e2181 "><pre class="oac_no_warn" dir="ltr">读（）</pre></td>
                                 <td align="left" valign="top" width="69%" headers="d13586e2296 d13586e2184 ">
                                    <p>从指定偏移量开始读取<code class="codeph">LOB</code>中的数据</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d13586e2306" headers="d13586e2181 "><pre class="oac_no_warn" dir="ltr">SUBSTR（）</pre></td>
                                 <td align="left" valign="top" width="69%" headers="d13586e2306 d13586e2184 ">
                                    <p>返回从指定偏移量开始的<code class="codeph">LOB</code>值的一部分。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d13586e2317" headers="d13586e2181 "><pre class="oac_no_warn" dir="ltr">FILECLOSE（）</pre></td>
                                 <td align="left" valign="top" width="69%" headers="d13586e2317 d13586e2184 ">
                                    <p>关闭文件。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d13586e2324" headers="d13586e2181 "><pre class="oac_no_warn" dir="ltr">FILECLOSEALL（）</pre></td>
                                 <td align="left" valign="top" width="69%" headers="d13586e2324 d13586e2184 ">
                                    <p>关闭所有以前打开的文件。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d13586e2331" headers="d13586e2181 "><pre class="oac_no_warn" dir="ltr">文件已存在（）</pre></td>
                                 <td align="left" valign="top" width="69%" headers="d13586e2331 d13586e2184 ">
                                    <p>测试服务器上是否存在该文件。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d13586e2338" headers="d13586e2181 "><pre class="oac_no_warn" dir="ltr">FILEGETNAME（）</pre></td>
                                 <td align="left" valign="top" width="69%" headers="d13586e2338 d13586e2184 ">
                                    <p>获取目录别名和文件名。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d13586e2345" headers="d13586e2181 "><pre class="oac_no_warn" dir="ltr">FILEISOPEN（）</pre></td>
                                 <td align="left" valign="top" width="69%" headers="d13586e2345 d13586e2184 ">
                                    <p>使用输入<code class="codeph">BFILE</code>定位器测试文件是否已打开。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d13586e2355" headers="d13586e2181 "><pre class="oac_no_warn" dir="ltr">FILEOPEN（）</pre></td>
                                 <td align="left" valign="top" width="69%" headers="d13586e2355 d13586e2184 ">
                                    <p>打开一个文件。</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div>
               </div><a id="ADDCI4380"></a><div class="props_rev_3"><a id="GUID-E7AE8D33-8513-489D-AB73-640D5B4E659C" name="GUID-E7AE8D33-8513-489D-AB73-640D5B4E659C"></a><h4 id="ADDCI-GUID-E7AE8D33-8513-489D-AB73-640D5B4E659C" class="sect4"><span class="enumeration_section">6.6.2</span>修剪CLOB</h4>
                  <div>
                     <div class="example" id="GUID-E7AE8D33-8513-489D-AB73-640D5B4E659C__BABDDJGI">
                        <p class="titleinexample">例6-9修剪CLOB</p><pre class="oac_no_warn" dir="ltr">程序Trim_Clob是clob_loc CLOB; BEGIN  - 将LOB定位器SELECT数据导入clob_loc FROM lob_table WHERE id = 179 FOR UPDATE; - 调用TRIM Routine DBMS_LOB.TRIM（clob_loc，834004）;承诺;结束;</pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
            </div><a id="ADDCI4381"></a><div class="props_rev_3"><a id="GUID-51396AA7-B3E9-4F4C-B88D-EC5741C8F2FC" name="GUID-51396AA7-B3E9-4F4C-B88D-EC5741C8F2FC"></a><h3 id="ADDCI-GUID-51396AA7-B3E9-4F4C-B88D-EC5741C8F2FC" class="sect3"><span class="enumeration_section">6.7</span>外部程序中的LOB</h3>
               <div>
                  <p><a id="d13586e2473" class="indexterm-anchor"></a><a id="d13586e2477" class="indexterm-anchor"></a> LOB定位器可以作为参数传递给外部过程，如<a href="working-with-multimedia-data-types.html#GUID-61143C61-B438-437F-99D1-EFC792B54D0E__BABBJIJJ">例6-1中</a>所定义。
                  </p>
                  <p>相应的C函数获取类型为<code class="codeph">OCILobLocator</code> *的参数。当调用<a href="working-with-multimedia-data-types.html#GUID-8F349729-FF06-4ACD-A92D-CCB1449D6E7D__BABHEHIC">例6-10中</a>定义的函数时，它将使用签名<code class="codeph">int c_findmin(OCILobLocator*)</code>调用ac例程<code class="codeph">c_findmin()</code> <code class="codeph">int c_findmin(OCILobLocator*)</code> 。
                  </p>
                  <p>例程<code class="codeph">c_findmin</code>位于与<code class="codeph">DS_Lib</code>关联的共享库中。要使用指针<code class="codeph">OCILobLocator*</code>从<code class="codeph">LOB</code>获取数据，必须通过回调重新连接到数据库。
                  </p>
               </div><a id="ADDCI4382"></a><div class="props_rev_3"><a id="GUID-8F349729-FF06-4ACD-A92D-CCB1449D6E7D" name="GUID-8F349729-FF06-4ACD-A92D-CCB1449D6E7D"></a><h4 id="ADDCI-GUID-8F349729-FF06-4ACD-A92D-CCB1449D6E7D" class="sect4"><span class="enumeration_section">6.7.1</span>定义外部过程（PL / SQL）</h4>
                  <div>
                     <div class="example" id="GUID-8F349729-FF06-4ACD-A92D-CCB1449D6E7D__BABHEHIC">
                        <p class="titleinexample">示例6-10定义PL / SQL外部过程</p><pre class="oac_no_warn" dir="ltr">功能DS_Findmin（数据CLOB）RETURN PLS_INTEGER是外部名称“c_findmin”LIBRARY DS_Lib LANGUAGE C;</pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
            </div><a id="ADDCI4383"></a><div class="props_rev_3"><a id="GUID-EC06BBB2-B824-46AE-B9B5-E4A668D4CFBB" name="GUID-EC06BBB2-B824-46AE-B9B5-E4A668D4CFBB"></a><h3 id="ADDCI-GUID-EC06BBB2-B824-46AE-B9B5-E4A668D4CFBB" class="sect3"><span class="enumeration_section">6.8</span> LOB和触发器</h3>
               <div>
                  <p><a id="d13586e2623" class="indexterm-anchor"></a><a id="d13586e2627" class="indexterm-anchor"></a>您无法在任何类型的触发器中写入<code class="codeph">LOB</code> （ <code class="codeph">:old</code>或<code class="codeph">:new</code>值）。
                  </p>
                  <p>在常规触发器中，您可以读取<code class="codeph">:old</code>值，但无法读取<code class="codeph">:new</code>值。在<code class="codeph">INSTEAD</code> <code class="codeph">OF</code>触发器中，您可以读取<code class="codeph">:old</code>和<code class="codeph">:new</code>值。
                  </p>
                  <p>您不能在<code class="codeph">OF</code>子句中指定<code class="codeph">LOB</code>类型列，因为可以更新<code class="codeph">BFILE</code>类型而无需更新定义触发器的基础表。
                  </p>
                  <p>使用OCI函数或<code class="codeph">DBMS_LOB</code>包更新对象列的<code class="codeph">LOB</code>值或<code class="codeph">LOB</code>属性不会触发在包含列或属性的表上定义的触发器。
                  </p>
               </div>
            </div><a id="ADDCI4384"></a><div class="props_rev_3"><a id="GUID-6CB4DCD4-D752-4AD9-8F4F-D59C847C2775" name="GUID-6CB4DCD4-D752-4AD9-8F4F-D59C847C2775"></a><h3 id="ADDCI-GUID-6CB4DCD4-D752-4AD9-8F4F-D59C847C2775" class="sect3"><span class="enumeration_section">6.9</span>使用打开/关闭作为包围操作以获得高效性能</h3>
               <div>
                  <p>使用“ <code class="codeph">Open/Close</code>功能可以指示一系列LOB操作的开始和结束，以便在调用“ <code class="codeph">Close</code>功能时可以执行大规模操作，例如更新索引。这意味着当进行<code class="codeph">Open</code>调用时，每次修改LOB时都不会更新索引，并且直到<code class="codeph">Close</code>调用才会恢复此类更新。
                  </p>
                  <p>您不必在<code class="codeph">Open/Close</code>操作中包装所有<code class="codeph">LOB</code>操作，但由于以下原因，代码块可能非常有价值：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>如果未将<code class="codeph">LOB</code>操作包装在<code class="codeph">Open/Close</code>调用中，则对<code class="codeph">LOB</code>每次修改都会隐式打开和关闭<code class="codeph">LOB,</code>从而触发所有触发器。如果你确实将<code class="codeph">LOB</code>操作包装在一对<code class="codeph">Open...Close</code>操作，然后不会为每个<code class="codeph">LOB</code>修改触发触发器。而是在进行<code class="codeph">Close</code>调用时触发一个触发器。同样，在<code class="codeph">Close</code>调用之前，不会更新可扩展索引。这意味着<code class="codeph">LOB</code>上的任何可扩展索引在<code class="codeph">Open...之间无效<code class="codeph">Open...Close</code>电话。
                        </p>
                     </li>
                     <li>
                        <p>您必须仔细应用此技术，因为反映<code class="codeph">LOB</code>更改的状态不会保存在“ <code class="codeph">Open</code>和“ <code class="codeph">Close</code>操作之间。当您调用<code class="codeph">Open</code> ，Oracle不再跟踪<code class="codeph">LOB</code>值的哪些部分被修改，也不再跟踪任何修改产生的<code class="codeph">LOB</code>的旧值和新值。对于每个<code class="codeph">OCILob*</code>或<code class="codeph">DBMS_LOB</code>操作， <code class="codeph">LOB</code>值仍然直接更新，并且通常的读取一致性机制仍然存在。您可能还希望更新<code class="codeph">LOB</code>上的可扩展索引，因为<code class="codeph">LOB</code>修改是因为可扩展<code class="codeph">LOB</code>索引始终有效并且可以随时使用。
                        </p>
                     </li>
                     <li>
                        <p>API使您可以确定<code class="codeph">LOB</code>是否已打开。在所有情况下，开放性与<code class="codeph">LOB</code>相关联，而不是定位器。定位器不保存任何状态信息。
                        </p>
                     </li>
                  </ul>
               </div><a id="ADDCI4385"></a><div class="props_rev_3"><a id="GUID-57359987-41A2-4450-B685-33AA1AB8E5BC" name="GUID-57359987-41A2-4450-B685-33AA1AB8E5BC"></a><h4 id="ADDCI-GUID-57359987-41A2-4450-B685-33AA1AB8E5BC" class="sect4"><span class="enumeration_section">6.9.1</span>关于开/关操作的错误和限制</h4>
                  <div>
                     <p>在关闭所有先前打开的<code class="codeph">LOB</code>之前提交事务是错误的。在事务回滚时，所有仍处于打开状态的<code class="codeph">LOB</code>都将被丢弃，这意味着它们不会被关闭，从而触发触发器。
                     </p>
                     <p><code class="codeph">Open/Close</code>相同的<code class="codeph">LOB</code>两次，使用不同的定位器或使用相同的定位器是错误的。关闭尚未打开的<code class="codeph">LOB</code>是错误的。
                     </p>
                     <p><a href="working-with-multimedia-data-types.html#GUID-47D73CF4-8AC8-4A86-98CC-D81396E63E1E__BABGDIAJ">例6-11</a>假定<code class="codeph">loc1</code>引用了一个打开的<code class="codeph">LOB</code> ，并被赋值给<code class="codeph">loc2</code> 。如果随后使用<code class="codeph">loc2</code>修改<code class="codeph">LOB</code>值，则修改将与<code class="codeph">loc1</code>的修改分组。这意味着<code class="codeph">LOB</code>管理器的状态中只有一个条目，而不是每个定位器的一个条目。当<code class="codeph">LOB</code>关闭时，无论是通过<code class="codeph">loc1</code>还是<code class="codeph">loc2</code> ，都会触发触发器，因此通过任一定位器对<code class="codeph">LOB</code>进行的所有更新都将被提交。在<code class="codeph">LOB</code>关闭后，如果用户尝试使用任一定位器修改<code class="codeph">LOB</code> ，则操作执行隐式<code class="codeph">Open()</code>和<code class="codeph">Close()</code> ，作为<code class="codeph">Open() ...</code> <span class="italic"><code class="codeph">operation</code></span> <code class="codeph">...Close()</code> 。请注意，仍然为每个定位器保持一致的读取。请记住，打开和关闭的是<code class="codeph">LOB</code> ，而不是定位器。无论定位器的副本数量是多少， <code class="codeph">LOB</code>的触发器在第一次<code class="codeph">Close()</code>调用时只触发一次。
                     </p>
                  </div><a id="ADDCI4386"></a><div class="props_rev_3"><a id="GUID-47D73CF4-8AC8-4A86-98CC-D81396E63E1E" name="GUID-47D73CF4-8AC8-4A86-98CC-D81396E63E1E"></a><h5 id="ADDCI-GUID-47D73CF4-8AC8-4A86-98CC-D81396E63E1E" class="sect5"><span class="enumeration_section">6.9.1.1</span>使用Open（）和Close（）代码块</h5>
                     <div>
                        <div class="example" id="GUID-47D73CF4-8AC8-4A86-98CC-D81396E63E1E__BABGDIAJ">
                           <p class="titleinexample">例6-11使用Open（）和Close（）代码块</p><pre class="oac_no_warn" dir="ltr">打开（loc1）; loc2：= loc1;写（loc1）;写（loc2）;打开（loc2）; / *错误，因为LOB是打开的* / close（loc1）;触发/ *触发器，任何定位器在此语句之前进行的所有LOB更新都包含在可扩展索引* / write（loc2）中; / *隐式打开，写入，隐式关闭* /</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>