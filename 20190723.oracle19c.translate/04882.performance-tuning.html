<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>性能调优</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Programmer&#39;s Guide"></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Programmer&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="cobol-programmers-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-11T02:40:40-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96466-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="reserved-words-keywords-and-namespaces.html" title="Previous" type="text/html"></link>
      <link rel="next" href="syntactic-and-semantic-checking.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Pro*COBOL Programmer&#39;s Guide"></meta>
    <meta name="dcterms.isVersionOf" content="LNPCB"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="reserved-words-keywords-and-namespaces.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="syntactic-and-semantic-checking.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">程序员指南</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">性能调优</li>
            </ol>
            <a id="GUID-D9700BF7-EE70-4807-A9E0-DAAB72099E5C" name="GUID-D9700BF7-EE70-4807-A9E0-DAAB72099E5C"></a><a id="LNPCB018"></a>
            
            <h2 id="LNPCB-GUID-D9700BF7-EE70-4807-A9E0-DAAB72099E5C" class="sect2"><span class="enumeration_chapter">C</span>性能调优</h2>
         </header>
         <div class="ind">
            <div>
               <p>本附录向您展示了一些简单易用的方法，可以提高应用程序的性能。使用这些方法，您通常可以将处理时间缩短25％或更多。主题是：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="performance-tuning.html#GUID-79F9FCF1-EE89-49D5-A362-077ABC003E4A">表现不佳的原因</a></p>
                  </li>
                  <li>
                     <p><a href="performance-tuning.html#GUID-4EFA93E1-E692-483D-BB97-484B4D15C528">提高绩效</a></p>
                  </li>
                  <li>
                     <p><a href="performance-tuning.html#GUID-E8E89EDE-974E-488B-BA12-CAE501AF0924">使用主机表</a></p>
                  </li>
                  <li>
                     <p><a href="performance-tuning.html#GUID-4399828B-91E3-469C-8EBB-99619A1B961A">使用PL / SQL和Java</a></p>
                  </li>
                  <li>
                     <p><a href="performance-tuning.html#GUID-DFD3F197-64B8-4CB9-BB1A-B8670BDF7A1E">优化SQL语句</a></p>
                  </li>
                  <li>
                     <p><a href="performance-tuning.html#GUID-BC06A47E-994F-4B09-9437-5EA733E9F532">使用索引</a></p>
                  </li>
                  <li>
                     <p><a href="performance-tuning.html#GUID-D4111055-0CC9-4B61-B106-6474641CFCBD">利用行级锁定</a></p>
                  </li>
                  <li>
                     <p><a href="performance-tuning.html#GUID-E569398C-E455-47C6-8CCA-D3C0458A6518">消除不必要的解析</a></p>
                  </li>
                  <li>
                     <p><a href="performance-tuning.html#GUID-BF9AFFD6-537A-4252-BBFB-3A60EEAC3E61" title="Traffic Director Mode中的Oracle Connection Manager是一个放置在支持的数据库客户端和数据库实例之间的代理。">关于在Traffic Director模式下使用Oracle Connection Manager</a></p>
                  </li>
               </ul>
            </div><a id="LNPCB1310"></a><div class="props_rev_3"><a id="GUID-79F9FCF1-EE89-49D5-A362-077ABC003E4A" name="GUID-79F9FCF1-EE89-49D5-A362-077ABC003E4A"></a><h3 id="LNPCB-GUID-79F9FCF1-EE89-49D5-A362-077ABC003E4A" class="sect3"><span class="enumeration_section">C.1</span>性能不佳的原因</h3>
               <div>
                  <p>性能不佳的一个原因是Oracle通信开销很高。Oracle必须一次处理一个SQL语句。因此，每个语句都会导致对Oracle的另一次调用以及更高的开销。在网络环境中，必须通过网络发送SQL语句，从而增加网络流量。繁重的网络流量会显着降低您的应用程序速度<a id="d99810e94" class="indexterm-anchor"></a><a id="d99810e98" class="indexterm-anchor"></a></p>
                  <p>性能不佳的另一个原因是效率低下的SQL语句。由于SQL非常灵活，因此可以使用两个不同的语句获得相同的结果。使用一个语句可能效率较低。例如，以下两个SELECT语句返回相同的行（每个部门的名称和编号至少有一名员工）：</p><pre class="oac_no_warn" dir="ltr">EXEC SQL SELECT DNAME，DEPTNO FROM DEPT DEPERENO IN（从EMP中选择DEPTNO）END-EXEC。</pre><p>与：</p><pre class="oac_no_warn" dir="ltr">EXEC SQL SELECT DNAME，DEPTNO FROM DEPT EXERE EXTS（从DEPE.DEPTNO = EMP.DEPTNO的EMP中选择DEPTNO）END-EXEC。</pre><p>第一个语句较慢，因为它为DEPT表中的每个部门号执行耗时的EMP表全扫描。即使EMP中的DEPTNO列已编制索引，也不会使用索引，因为子查询缺少一个命名DEPTNO的WHERE子句。</p>
                  <p>性能不佳的另一个原因是不必要的解析和绑定。回想一下，在执行SQL语句之前，Oracle必须解析并绑定它。解析意味着检查SQL语句以确保它遵循语法规则并引用有效的数据库对象。绑定意味着将SQL语句中的主机变量与其地址相关联，以便Oracle可以读取或写入其值。</p>
                  <p>许多应用程序管理游标很差。这导致不必要的解析和绑定，这显着增加了处理开销。</p>
               </div>
            </div><a id="LNPCB1311"></a><div class="props_rev_3"><a id="GUID-4EFA93E1-E692-483D-BB97-484B4D15C528" name="GUID-4EFA93E1-E692-483D-BB97-484B4D15C528"></a><h3 id="LNPCB-GUID-4EFA93E1-E692-483D-BB97-484B4D15C528" class="sect3"><span class="enumeration_section">C.2</span>提高绩效</h3>
               <div>
                  <p>如果您对预编译程序的性能不满意，可以通过多种方法减少开销。</p>
                  <p>您可以大大减少Oracle通信开销，尤其是在网络环境中<a id="d99810e140" class="indexterm-anchor"></a></p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>使用主机表</p>
                     </li>
                     <li>
                        <p>使用嵌入式PL / SQL</p>
                     </li>
                  </ul>
                  <p>您可以减少处理开销 - 有时可以显着降低</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>优化SQL语句</p>
                     </li>
                     <li>
                        <p>SQL语句缓存</p>
                     </li>
                     <li>
                        <p>使用索引</p>
                     </li>
                     <li>
                        <p>利用行级锁定</p>
                     </li>
                     <li>
                        <p>消除不必要的解析</p>
                     </li>
                     <li>
                        <p>避免不必要的重新分析</p>
                     </li>
                  </ul>
                  <p>以下部分将介绍减少开销的每种方法。</p>
               </div>
            </div><a id="LNPCB1312"></a><div class="props_rev_3"><a id="GUID-E8E89EDE-974E-488B-BA12-CAE501AF0924" name="GUID-E8E89EDE-974E-488B-BA12-CAE501AF0924"></a><h3 id="LNPCB-GUID-E8E89EDE-974E-488B-BA12-CAE501AF0924" class="sect3"><span class="enumeration_section">C.3</span>使用主机表</h3>
               <div>
                  <p>主机表可以提高性能，因为它们允许您使用单个SQL语句操作整个数据集合。例如，假设您要将300名员工的工资插入EMP表。如果没有表格，您的程序必须执行300次单独插入 - 每位员工一次。对于数组，只需要一个INSERT。请考虑以下声明：<a id="d99810e199" class="indexterm-anchor"></a></p><pre class="oac_no_warn" dir="ltr">EXEC SQL INSERT INTO EMP（SAL）VALUES（：SALARY）END-EXEC。</pre><p>如果<span class="italic">SALARY</span>是一个简单的主机变量，Oracle会执行一次INSERT语句，将一行插入EMP表。在该行中，SAL列的值为<span class="italic">SALARY</span> 。要以这种方式插入300行，必须执行300次INSERT语句。
                  </p>
                  <p>但是，如果<span class="italic">SALARY</span>是大小为300的主机表，则Oracle会立即将所有300行插入到EMP表中。在每一行中，SAL列都具有<span class="italic">SALARY</span>表中元素的值。
                  </p>
                  <p>有关更多信息，请参阅<a href="host-tables.html#GUID-B4A3765E-BBA7-4D71-860D-1058CD2D23C6">主机表</a></p>
               </div>
            </div><a id="LNPCB1314"></a><a id="LNPCB1313"></a><div class="props_rev_3"><a id="GUID-4399828B-91E3-469C-8EBB-99619A1B961A" name="GUID-4399828B-91E3-469C-8EBB-99619A1B961A"></a><h3 id="LNPCB-GUID-4399828B-91E3-469C-8EBB-99619A1B961A" class="sect3"><span class="enumeration_section">C.4</span>使用PL / SQL和Java</h3>
               <div>
                  <p><a href="performance-tuning.html#GUID-4399828B-91E3-469C-8EBB-99619A1B961A__CHEIIGJI">如图C-1</a>所示，如果您的应用程序是数据库密集型的，您可以使用控制结构在PL / SQL块中对SQL语句进行分组，然后将整个块发送到Oracle。这可以大大减少应用程序和数据库之间的通信。 <a id="d99810e253" class="indexterm-anchor"></a> 
                  </p>
                  <p>此外，您可以使用PL / SQL和Java子程序来减少从应用程序到数据库的调用。例如，要执行十个单独的SQL语句，需要进行十次调用，但要执行包含十个SQL语句的子程序，只需要一次调用。<a id="d99810e260" class="indexterm-anchor"></a></p>
                  <p>与匿名块不同，PL / SQL和Java子程序可以单独编译并存储在数据库中。调用时，它们会立即传递给PL / SQL引擎。此外，只需要将子程序的一个副本加载到存储器中以供多个用户执行。 <a id="d99810e266" class="indexterm-anchor"></a> 
                  </p>
                  <div class="figure" id="GUID-4399828B-91E3-469C-8EBB-99619A1B961A__CHEIIGJI">
                     <p class="titleinfigure">图C-1 PL / SQL提升性能</p><img src="img/pco81060.gif" alt="下面是图C-1的描述" title="下面是图C-1的描述" longdesc="img_text/pco81060.html"><br><a href="img_text/pco81060.html">“图C-1 PL / SQL提升性能”的描述</a></div>
                  <!-- class="figure" -->
               </div>
            </div><a id="LNPCB1315"></a><div class="props_rev_3"><a id="GUID-DFD3F197-64B8-4CB9-BB1A-B8670BDF7A1E" name="GUID-DFD3F197-64B8-4CB9-BB1A-B8670BDF7A1E"></a><h3 id="LNPCB-GUID-DFD3F197-64B8-4CB9-BB1A-B8670BDF7A1E" class="sect3"><span class="enumeration_section">C.5</span>优化SQL语句</h3>
               <div>
                  <p>对于每个SQL语句，优化器都会生成一个<span class="italic">执行计划</span> ，这是Oracle执行该语句所采取的一系列步骤。这些步骤由<a href="../adfns/index.html" target="_blank"><span class="italic">Oracle数据库高级应用程序开发人员指南</span></a>中的规则确定。遵循这些规则将帮助您编写最佳SQL语句。<a id="d99810e308" class="indexterm-anchor"></a><a id="d99810e312" class="indexterm-anchor"></a><a id="d99810e314" class="indexterm-anchor"></a></p>
               </div><a id="LNPCB1316"></a><div class="props_rev_3"><a id="GUID-6722D75E-6DC3-40EB-AEBB-C9ACFD30CEEE" name="GUID-6722D75E-6DC3-40EB-AEBB-C9ACFD30CEEE"></a><h4 id="LNPCB-GUID-6722D75E-6DC3-40EB-AEBB-C9ACFD30CEEE" class="sect4"><span class="enumeration_section">C.5.1</span>优化器提示</h4>
                  <div>
                     <p>对于每个SQL语句，优化器都会生成一个<span class="italic">执行计划</span> ，这是Oracle执行该语句所采取的一系列步骤。在某些情况下，您可以建议优化SQL语句的方法。这些建议称为<span class="italic">提示</span> ，可以影响优化程序的决策。<a id="d99810e346" class="indexterm-anchor"></a><a id="d99810e348" class="indexterm-anchor"></a></p>
                     <p>提示不是指令;他们只是帮助优化者完成它的工作。一些提示限制了用于优化SQL语句的信息范围，而其他提示则提出了整体策略。您可以使用提示指定：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>SQL语句的优化方法</p>
                        </li>
                        <li>
                           <p>每个引用表的访问路径</p>
                        </li>
                        <li>
                           <p>加入加入订单</p>
                        </li>
                        <li>
                           <p>用于连接表的方法</p>
                        </li>
                     </ul>
                  </div><a id="LNPCB1317"></a><div class="props_rev_3"><a id="GUID-4F17C941-C793-4D11-A92F-34E99E584A98" name="GUID-4F17C941-C793-4D11-A92F-34E99E584A98"></a><h5 id="LNPCB-GUID-4F17C941-C793-4D11-A92F-34E99E584A98" class="sect5"><span class="enumeration_section">C.5.1.1</span>给出提示</h5>
                     <div>
                        <p>您可以通过在SELECT，UPDATE或DELETE语句中的动词后立即将它们放在C样式的注释中来为优化器提供提示。您可以选择基于规则或基于成本的优化。通过基于成本的优化，提示有助于最大化吞吐量或响应时间。在以下示例中，ALL_ROWS提示有助于最大化查询吞吐量：</p><pre class="oac_no_warn" dir="ltr">EXEC SQL SELECT / * + ALL_ROWS（基于成本）* / EMPNO，ENAME，SAL INTO：EMP-NUMBER，：EMP-NAME，：来自EMP的SALARY DEPTNO =：DEPT-NUMBER END-EXEC。</pre><p>加号（+）必须紧跟在注释开头之后，表示注释包含一个或多个提示。请注意，Comment可以包含备注和提示。</p>
                        <p>有关优化程序提示的更多信息，请参阅<a href="../adfns/performance-and-scalability.html#ADFNS-GUID-826DD1D3-C722-4915-8790-E870D6B5123A" target="_blank">性能和可伸缩性</a> 。
                        </p>
                        <p>跟踪设施</p>
                        <p>您可以使用SQL跟踪工具和EXPLAIN PLAN语句来标识可能会降低应用程序速度的SQL语句。跟踪工具为Oracle执行的每个SQL语句生成统计信息。从这些统计信息中，您可以确定哪些语句需要花费最多的时间来处理。然后，您可以将调整工作集中在这些语句上。<a id="d99810e403" class="indexterm-anchor"></a><a id="d99810e407" class="indexterm-anchor"></a></p>
                        <p>EXPLAIN PLAN语句显示应用程序中每个SQL语句的执行计划。您可以使用执行计划来识别低效的SQL语句。</p>
                        <p>另请参阅： <a href="../adfns/performance-and-scalability.html#ADFNS-GUID-3BC2DA6F-0836-42EF-8155-C6FA27893360" target="_blank">性能工具，</a>了解有关使用跟踪工具和分析其输出的说明。
                        </p>
                     </div>
                  </div>
               </div>
            </div><a id="LNPCB1318"></a><div class="props_rev_3"><a id="GUID-ED51FFB2-8B07-4F86-BCC2-B0FC21403B5B" name="GUID-ED51FFB2-8B07-4F86-BCC2-B0FC21403B5B"></a><h3 id="LNPCB-GUID-ED51FFB2-8B07-4F86-BCC2-B0FC21403B5B" class="sect3"><span class="enumeration_section">C.6</span> SQL语句缓存</h3>
               <div>
                  <p>使用语句缓存在预编译器应用程序中实现了性能改进。任何使用动态SQL语句的程序（其中游标必须与语句的重新分析一起使用）将通过语句缓存获得性能提升。使用此新功能，总体执行时间将减少。</p>
                  <p>可以将stmt_cache选项设置为保存应用程序中预期的不同动态SQL语句数。客户可以使用新的预编译器命令行选项设置stmt_cache大小。无法设置stmt_cache的最佳值，因为它取决于输入程序行为。</p>
                  <p>可以使用执行时间的更改来测量性能（使用和不使用语句缓存）。</p>
               </div>
            </div><a id="LNPCB1319"></a><div class="props_rev_3"><a id="GUID-BC06A47E-994F-4B09-9437-5EA733E9F532" name="GUID-BC06A47E-994F-4B09-9437-5EA733E9F532"></a><h3 id="LNPCB-GUID-BC06A47E-994F-4B09-9437-5EA733E9F532" class="sect3"><span class="enumeration_section">C.7</span>使用索引</h3>
               <div>
                  <p>使用rowid， <span class="italic">索引</span>将表列中的每个不同值与包含该值的行相关联。使用CREATE INDEX语句创建索引。有关详细信息，请参见<a href="../sqlrf/CREATE-INDEX.html#SQLRF-GUID-1F89BBC0-825F-4215-AF71-7588E31D8BFE" target="_blank">CREATE INDEX</a> 。<a id="d99810e479" class="indexterm-anchor"></a></p>
                  <p>您可以使用索引来提高返回少于表中行的15％的查询的性能。通过<span class="italic">完全扫描</span> ，即通过顺序读取所有行，可以更快地执行返回表中15％或更多行的查询。在WHERE子句中命名索引列的任何查询都可以使用索引。有关帮助您选择要编制索引的列的准则，请参阅<a href="../adfns/indexes.html#ADFNS-GUID-5C53546D-8C54-4F38-B472-835F94030016" target="_blank">在数据库应用程序中使用索引</a> 。<a id="d99810e492" class="indexterm-anchor"></a></p>
               </div>
            </div><a id="LNPCB1320"></a><div class="props_rev_3"><a id="GUID-D4111055-0CC9-4B61-B106-6474641CFCBD" name="GUID-D4111055-0CC9-4B61-B106-6474641CFCBD"></a><h3 id="LNPCB-GUID-D4111055-0CC9-4B61-B106-6474641CFCBD" class="sect3"><span class="enumeration_section">C.8</span>利用行级锁定</h3>
               <div>
                  <p>默认情况下，Oracle会在行级而不是表级别锁定数据。行级锁定允许多个用户同时访问同一表中的不同行。由此带来的性能提升非常显着。</p>
                  <p>您可以指定表级锁定，但会降低事务处理选项的有效性。有关表锁定的更多信息，请参阅“使用LOCK TABLE语句”中的<span class="q">“ <a href="database-concepts.html#GUID-D7F99FE8-D739-4E12-B17C-A7A7F21032F0">使用LOCK TABLE语句</a> ”</span> 。<a id="d99810e525" class="indexterm-anchor"></a></p>
                  <p>进行在线事务处理的应用程序从行级锁定中获益最多。如果您的应用程序依赖于表级锁定，请对其进行修改以利用行级锁定。通常，避免显式表级锁定。</p>
               </div>
            </div><a id="LNPCB1321"></a><div class="props_rev_3"><a id="GUID-E569398C-E455-47C6-8CCA-D3C0458A6518" name="GUID-E569398C-E455-47C6-8CCA-D3C0458A6518"></a><h3 id="LNPCB-GUID-E569398C-E455-47C6-8CCA-D3C0458A6518" class="sect3"><span class="enumeration_section">C.9</span>消除不必要的解析</h3>
               <div>
                  <p>消除不必要的解析需要正确处理游标并选择性地使用以下游标管理选项：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>MAXOPENCURSORS</p>
                     </li>
                     <li>
                        <p>HOLD_CURSOR</p>
                     </li>
                     <li>
                        <p>RELEASE_CURSOR</p>
                     </li>
                  </ul>
                  <p>这些选项会影响隐式和显式游标，游标缓存和私有SQL区域。 <a id="d99810e568" class="indexterm-anchor"></a><a id="d99810e570" class="indexterm-anchor"></a><a id="d99810e574" class="indexterm-anchor"></a><a id="d99810e578" class="indexterm-anchor"></a><a id="d99810e582" class="indexterm-anchor"></a><a id="d99810e584" class="indexterm-anchor"></a> 
                  </p>
                  <p><span class="bold">注意：</span>您可以使用ORACA获取游标缓存统计信息。请参阅<span class="q">“ <a href="error-handling-and-diagnostics.html#GUID-709278BE-8149-4F60-BB83-CABC59E67F89">使用Oracle通信区域</a> ”</span> 。
                  </p>
               </div><a id="LNPCB1322"></a><div class="props_rev_3"><a id="GUID-972C3CA9-009A-4288-8138-B186B7F7C31A" name="GUID-972C3CA9-009A-4288-8138-B186B7F7C31A"></a><h4 id="LNPCB-GUID-972C3CA9-009A-4288-8138-B186B7F7C31A" class="sect4"><span class="enumeration_section">C.9.1</span>处理显式游标</h4>
                  <div>
                     <p>回想一下，有两种类型的游标：隐式和显式（参见<span class="q">“ <a href="precompiler-concepts.html#GUID-767065E6-7AD4-45F5-AE4C-7D5E50564303">错误和警告</a> ”</span> ）。Oracle隐式声明了所有数据定义和数据操作语句的游标。但是，对于返回多行的查询，您应该显式声明游标并批量获取而不是选择进入主机表。您使用DECLARE CURSOR语句来声明显式游标。如何处理显式游标的打开和关闭会影响性能。<a id="d99810e627" class="indexterm-anchor"></a></p>
                     <p>如果需要重新评估活动集，只需重新打开游标即可。OPEN语句将使用任何新的主机变量值。如果不先关闭光标，可以节省处理时间。</p>
                     <p>只有在想要释放通过打开光标获取的资源（内存和锁）时才关闭光标。例如，您的程序应该在退出之前关闭所有游标。</p>
                     <p><span class="bold">注意：</span>为了简化性能调优，预编译器允许您重新打开已打开的游标。但是，这是ANSI / ISO嵌入式SQL标准的Oracle扩展。因此，当MODE = ANSI时，必须在重新打开之前关闭游标。
                     </p>
                  </div><a id="LNPCB1323"></a><div class="props_rev_3"><a id="GUID-0CD475B4-C816-457B-954E-7D8EEFFD08C5" name="GUID-0CD475B4-C816-457B-954E-7D8EEFFD08C5"></a><h5 id="LNPCB-GUID-0CD475B4-C816-457B-954E-7D8EEFFD08C5" class="sect5"><span class="enumeration_section">C.9.1.1</span>光标控制</h5>
                     <div>
                        <p>通常，有三个因素会影响对显式声明的游标的控制：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>使用DECLARE，OPEN，FETCH和CLOSE语句。</p>
                           </li>
                           <li>
                              <p>使用PREPARE，DECLARE，OPEN，FETCH和CLOSE语句</p>
                           </li>
                           <li>
                              <p>当MODE = ANSI时，COMMIT关闭光标</p>
                           </li>
                        </ul>
                        <p>用第一种方法，注意不必要的解析。OPEN语句执行解析，但前提是解析后的语句不可用，因为游标已关闭或从未打开过。您的程序应该声明游标，每次主机变量的值发生更改时重新打开它，并且只有在不再需要SQL语句时才关闭它。</p>
                        <p>使用第二种方法（在动态SQL方法3和4中使用），PREPARE语句执行解析，并且解析的语句可用，直到执行CLOSE语句。您的程序应准备SQL语句并声明游标，每次主机变量的值更改时重新打开游标，重新准备SQL语句并在SQL语句更改时重新打开游标，并仅关闭游标何时不再需要SQL语句。</p>
                        <p>如果可能，避免将OPEN和CLOSE语句放在循环中;这是不必要的重新解析SQL语句的潜在原因。在下一个示例中，OPEN和CLOSE语句都在外部循环内。当MODE = ANSI时，CLOSE语句必须如图所示定位，因为ANSI要求在重新打开之前关闭游标。</p><pre class="oac_no_warn" dir="ltr">EXEC SQL DECLARE emp_cursor CURSOR FOR SELECT ENAME，SAL FROM EMP WHERE SAL&gt;：SALARY AND SAL &lt;=：SALARY + 1000 END-EXEC。移动0到SALARY。最佳。 EXEC SQL OPEN emp_cursor END-EXEC。环。 EXEC SQL FETCH emp_cursor INTO .......如果SQLCODE = 0，则转到LOOP ELSE将1000添加到SALARY END-IF。 EXEC SQL CLOSE emp_cursor END-EXEC。如果SALARY &lt;5000转到顶部。</pre><p>但是，使用MODE = ORACLE，通过将CLOSE语句放在外部循环之外，可以避免在OPEN语句的每次迭代时重新解析。</p><pre class="oac_no_warn" dir="ltr">最佳。 EXEC SQL OPEN emp_cursor END-EXEC。环。 EXEC SQL FETCH emp_cursor INTO .......如果SQLCODE = 0，则转到LOOP ELSE将1000添加到SALARY END-IF。如果SALARY &lt;5000转到顶部。 EXEC SQL CLOSE emp_cursor END-EXEC。</pre></div>
                  </div>
               </div><a id="LNPCB1324"></a><div class="props_rev_3"><a id="GUID-76CAF5EE-6765-46AA-8760-A5A25776424B" name="GUID-76CAF5EE-6765-46AA-8760-A5A25776424B"></a><h4 id="LNPCB-GUID-76CAF5EE-6765-46AA-8760-A5A25776424B" class="sect4"><span class="enumeration_section">C.9.2</span>使用光标管理选项</h4>
                  <div>
                     <p>除非您更改其构成，否则只需解析一次SQL语句。例如，通过向其选择列表或WHERE子句添加列来更改查询的组成。HOLD_CURSOR，RELEASE_CURSOR和MAXOPENCURSORS选项使您可以控制Oracle如何管理SQL语句的解析和重新解析。声明显式游标可以最大程度地控制解析。</p>
                  </div><a id="LNPCB1326"></a><a id="LNPCB1325"></a><div class="props_rev_3"><a id="GUID-476778F5-F63D-4270-9F7B-DF03C0A5A2F8" name="GUID-476778F5-F63D-4270-9F7B-DF03C0A5A2F8"></a><h5 id="LNPCB-GUID-476778F5-F63D-4270-9F7B-DF03C0A5A2F8" class="sect5"><span class="enumeration_section">C.9.2.1</span>私有SQL区域和游标缓存</h5>
                     <div>
                        <p>执行任何语句时，其关联的游标将链接到游标缓存中的条目。游标缓存是用于游标管理的不断更新的内存区域。游标缓存条目又链接到私有SQL区域。<a id="d99810e734" class="indexterm-anchor"></a></p>
                        <p>私有SQL区域是Oracle在运行时动态创建的工作区，包含已解析的SQL语句，主机变量的地址以及处理该语句所需的其他信息。动态方法3允许您命名SQL语句，访问其私有SQL区域中的信息，并在某种程度上控制其处理。<a id="d99810e740" class="indexterm-anchor"></a></p>
                        <p><a href="performance-tuning.html#GUID-476778F5-F63D-4270-9F7B-DF03C0A5A2F8__I24609">图C-2</a>表示程序完成插入和删除后的游标缓存。
                        </p>
                        <div class="figure" id="GUID-476778F5-F63D-4270-9F7B-DF03C0A5A2F8__I24609">
                           <p class="titleinfigure">图C-2通过游标缓存链接的游标</p><img src="img/pco81062.gif" width="461" alt="下面是图C-2的描述" title="下面是图C-2的描述" longdesc="img_text/pco81062.html"><br><a href="img_text/pco81062.html">“通过游标缓存链接的图C-2游标”的描述</a></div>
                        <!-- class="figure" -->
                     </div>
                  </div><a id="LNPCB1327"></a><div class="props_rev_3"><a id="GUID-D3445B31-46EA-4D01-8B46-30A71B110010" name="GUID-D3445B31-46EA-4D01-8B46-30A71B110010"></a><h5 id="LNPCB-GUID-D3445B31-46EA-4D01-8B46-30A71B110010" class="sect5"><span class="enumeration_section">C.9.2.2</span>资源使用</h5>
                     <div>
                        <p>每个用户会话的最大打开游标数由初始化参数OPEN_CURSORS设置。</p>
                        <p>MAXOPENCURSORS指定游标缓存的<span class="italic">初始</span>大小。如果需要新的游标且没有可用的缓存条目，Oracle会尝试重用一个条目。它的成功取决于HOLD_CURSOR和RELEASE_CURSOR的值，对于显式游标，它取决于游标本身的状态。
                        </p>
                        <p>如果MAXOPENCURSORS的值小于在执行程序期间需要缓存的语句数，则Oracle将在MAXOPENCURSORS缓存条目用尽后搜索游标缓存条目以重用。例如，假设INSERT语句的高速缓存条目<span class="italic">E</span> （1）被标记为可重用，并且高速缓存条目的数量已经等于MAXOPENCURSORS。如果程序执行新语句，则可以将高速缓存条目<span class="italic">E</span> （1）及其私有SQL区域重新分配给新语句。要重新执行INSERT语句，Oracle必须重新解析它并重新分配另一个缓存条目。
                        </p>
                        <p>如果找不到要重用的缓存条目，Oracle会分配一个额外的缓存条目。例如，如果MAXOPENCURSORS = 8并且所有八个条目都处于活动状态，则会创建第九个条目。如有必要，Oracle会继续分配其他缓存条目，直到内存不足或达到OPEN_CURSORS设置的限制为止。这种动态分配增加了处理开销。</p>
                        <p>因此，使用HOLD_CURSOR = NO（默认值）为MAXOPENCURSORS指定低值会节省内存，但会导致可能代价高昂的动态分配和新缓存条目的取消分配。为MAXOPENCURSORS指定一个高值可确保快速执行但使用更多内存。</p>
                     </div>
                  </div><a id="LNPCB1328"></a><div class="props_rev_3"><a id="GUID-707BA635-83F3-466F-B0D0-8361C1FF3B41" name="GUID-707BA635-83F3-466F-B0D0-8361C1FF3B41"></a><h5 id="LNPCB-GUID-707BA635-83F3-466F-B0D0-8361C1FF3B41" class="sect5"><span class="enumeration_section">C.9.2.3</span>不经常执行</h5>
                     <div>
                        <p>有时， <span class="italic">不经常</span>执行的SQL语句与其私有SQL区域之间的链接应该是临时的。
                        </p>
                        <p>当HOLD_CURSOR = NO（默认值）时，在Oracle执行SQL语句并关闭游标后，预编译器会将游标和游标缓存之间的链接标记为可重用。只要另一个SQL语句需要它指向的游标缓存条目，就会重用该链接。这将释放分配给私有SQL区域的内存并释放解析锁。但是，由于准备好的游标必须保持活动状态，因此即使HOLD_CURSOR = NO，也会保持其链接。</p>
                        <p>当RELEASE_CURSOR = YES时，在Oracle执行SQL语句并且游标关闭后，将自动释放私有SQL区域并丢失解析的语句。例如，如果您希望节省内存，则可能需要这样做。</p>
                        <p>当RELEASE_CURSOR = YES时，将立即删除私有SQL区域和高速缓存条目之间的链接，并释放私有SQL区域。即使您尝试指定HOLD_CURSOR = YES，Oracle仍必须为私有SQL区域重新分配内存，并在执行之前重新解析SQL语句。因此，指定RELEASE_CURSOR = YES会覆盖HOLD_CURSOR = YES。</p>
                     </div>
                  </div><a id="LNPCB1329"></a><div class="props_rev_3"><a id="GUID-11BEC4D0-37FA-483A-8374-140D96E0B00B" name="GUID-11BEC4D0-37FA-483A-8374-140D96E0B00B"></a><h5 id="LNPCB-GUID-11BEC4D0-37FA-483A-8374-140D96E0B00B" class="sect5"><span class="enumeration_section">C.9.2.4</span>频繁执行</h5>
                     <div>
                        <p>应保持<span class="italic">频繁</span>执行的SQL语句与其私有SQL区域之间的链接，因为私有SQL区域包含执行该语句所需的所有信息。维护对此信息的访问使得后续执行语句的速度更快。
                        </p>
                        <p>当HOLD_CURSOR = YES时，Oracle执行SQL语句后，将保持游标和游标缓存之间的链接。因此，解析的语句和分配的内存仍然可用。这对于您希望保持活动状态的SQL语句非常有用，因为它可以避免不必要的重新解析。<a id="d99810e856" class="indexterm-anchor"></a></p>
                     </div>
                  </div><a id="LNPCB1330"></a><div class="props_rev_3"><a id="GUID-DA4CB847-9FD9-4EDD-A0D7-8E3634AA0E47" name="GUID-DA4CB847-9FD9-4EDD-A0D7-8E3634AA0E47"></a><h5 id="LNPCB-GUID-DA4CB847-9FD9-4EDD-A0D7-8E3634AA0E47" class="sect5"><span class="enumeration_section">C.9.2.5</span>对共享SQL区域的影响</h5>
                     <div>
                        <p>Oracle在其共享SQL缓存中缓存SQL语句和PL / SQL的已解析表示。由于需要将空间用于其他陈述，这些陈述一直保持到老化状态。有关更多信息，请参阅<a href="../cncpt/memory-architecture.html#CNCPT1228" target="_blank"><span class="italic">Oracle数据库概念</span></a>手册。在这方面，Oracle服务器的行为不受预编译器的游标管理设置的影响，因此可以产生以下影响：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>当RELEASE_CURSOR = YES并且重新执行语句时，将向服务器发送请求以解析语句，但可能不需要完整解析，因为语句可能仍然被高速缓存。</p>
                           </li>
                           <li>
                              <p>使用HOLD_CURSOR = YES时，不会对语句中引用的任何对象保持锁定，因此重新定义语句中的一个对象将强制缓存的语句变为无效，并且服务器将自动重新分析语句。这可能会导致意外结果。</p>
                           </li>
                           <li>
                              <p>尽管如此，当RELEASE_CURSOR = YES时，重新解析可能不需要额外的处理，因为Oracle在其<span class="italic">共享SQL缓存中缓存</span>了SQL语句和PL / SQL块的解析表示。即使其光标关闭，解析后的表示仍然可用，直到它从缓存中老化。
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div><a id="LNPCB1331"></a><div class="props_rev_3"><a id="GUID-96CB266B-EDFD-458B-B43F-B278D6BCE866" name="GUID-96CB266B-EDFD-458B-B43F-B278D6BCE866"></a><h5 id="LNPCB-GUID-96CB266B-EDFD-458B-B43F-B278D6BCE866" class="sect5"><span class="enumeration_section">C.9.2.6</span>嵌入式PL / SQL注意事项</h5>
                     <div>
                        <p>出于游标管理的目的，嵌入式PL / SQL块被视为SQL语句。当执行嵌入式PL / SQL块时，父光标与整个块相关联，并且在嵌入式PL / SQL块的PGA中的高速缓存条目和私有SQL区域之间创建链接。请注意，嵌入块内的每个SQL语句也需要PGA中的私有SQL区域。这些SQL语句使用PL / SQL自行管理的子游标。子游标的处置是通过其关联的父游标确定的。也就是说，子游标使用的私有SQL区域在释放其父游标的私有SQL区域后被释放。</p>
                        <p>注意：</p>
                        <p>使用默认值HOLD_CURSOR = YES和RELEASE_CURSOR = NO，在执行具有早期Oracle版本的SQL语句之后，其解析的表示仍然可用。对于Oracle，在类似条件下，解析后的表示只有在老化出共享SQL缓存之后才可用。通常，这不是问题，但如果在重新解析SQL语句之前引用对象的定义发生更改，则可能会出现意外结果。</p>
                     </div>
                  </div><a id="LNPCB1333"></a><a id="LNPCB1332"></a><div class="props_rev_3"><a id="GUID-2D27C84E-31CC-4EFC-904B-8FF6AE3F13A8" name="GUID-2D27C84E-31CC-4EFC-904B-8FF6AE3F13A8"></a><h5 id="LNPCB-GUID-2D27C84E-31CC-4EFC-904B-8FF6AE3F13A8" class="sect5"><span class="enumeration_section">C.9.2.7</span>参数交互</h5>
                     <div>
                        <p><a href="performance-tuning.html#GUID-2D27C84E-31CC-4EFC-904B-8FF6AE3F13A8__i24652">HOLD_CURSOR和RELEASE _CURSOR交互</a>显示HOLD_CURSOR和RELEASE_CURSOR如何交互。请注意，HOLD_CURSOR = NO会覆盖RELEASE_CURSOR = NO，而RELEASE_CURSOR = YES会覆盖HOLD_CURSOR = YES。</p>
                        <div class="tblformal" id="GUID-2D27C84E-31CC-4EFC-904B-8FF6AE3F13A8__CHEHJFCA">
                           <p class="titleintable">表C-1 <span class="italic" id="GUID-2D27C84E-31CC-4EFC-904B-8FF6AE3F13A8__i24652"><span class="bold">HOLD_CURSOR和RELEASE _CURSOR交互</span></span></p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="HOLD_CURSOR和RELEASE _CURSOR交互" width="100%" border="1" summary="q" frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="39%" id="d99810e971">HOLD_CURSOR</th>
                                    <th align="left" valign="bottom" width="31%" id="d99810e974">RELEASE_CURSOR</th>
                                    <th align="left" valign="bottom" width="31%" id="d99810e977">链接是......</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="39%" id="d99810e982" headers="d99810e971 ">
                                       <p>没有</p>
                                    </td>
                                    <td align="left" valign="top" width="31%" headers="d99810e982 d99810e974 ">
                                       <p>没有</p>
                                    </td>
                                    <td align="left" valign="top" width="31%" headers="d99810e982 d99810e977 ">
                                       <p>标记为可重复使用</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="39%" id="d99810e992" headers="d99810e971 ">
                                       <p>是</p>
                                    </td>
                                    <td align="left" valign="top" width="31%" headers="d99810e992 d99810e974 ">
                                       <p>没有</p>
                                    </td>
                                    <td align="left" valign="top" width="31%" headers="d99810e992 d99810e977 ">
                                       <p>保持</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="39%" id="d99810e1002" headers="d99810e971 ">
                                       <p>没有</p>
                                    </td>
                                    <td align="left" valign="top" width="31%" headers="d99810e1002 d99810e974 ">
                                       <p>是</p>
                                    </td>
                                    <td align="left" valign="top" width="31%" headers="d99810e1002 d99810e977 ">
                                       <p>立即删除</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="39%" id="d99810e1012" headers="d99810e971 ">
                                       <p>是</p>
                                    </td>
                                    <td align="left" valign="top" width="31%" headers="d99810e1012 d99810e974 ">
                                       <p>是</p>
                                    </td>
                                    <td align="left" valign="top" width="31%" headers="d99810e1012 d99810e977 ">
                                       <p>立即删除</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                  </div>
               </div>
            </div><a id="LNPCB1334"></a><div class="props_rev_3"><a id="GUID-3883BE9D-97E3-4170-B2AF-0E3B44094E00" name="GUID-3883BE9D-97E3-4170-B2AF-0E3B44094E00"></a><h3 id="LNPCB-GUID-3883BE9D-97E3-4170-B2AF-0E3B44094E00" class="sect3"><span class="enumeration_section">C.10</span>避免不必要的重新分析</h3>
               <div>
                  <p>当嵌入式SQL语句在循环中执行时，它只被解析一次。但是，SQL语句的执行阶段可能会导致错误，并且会重新声明语句，但以下情况除外：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>ORA-1403（未找到）</p>
                     </li>
                     <li>
                        <p>ORA-1405（截断）</p>
                     </li>
                     <li>
                        <p>ORA-1406（空值）</p>
                     </li>
                  </ul>
                  <p>通过纠正错误，您可以消除这种不必要的重新分析。</p>
                  <p></p>
               </div>
            </div>
            <div class="sect2"><a id="GUID-BF9AFFD6-537A-4252-BBFB-3A60EEAC3E61" name="GUID-BF9AFFD6-537A-4252-BBFB-3A60EEAC3E61"></a><h3 id="LNPCB-GUID-BF9AFFD6-537A-4252-BBFB-3A60EEAC3E61" class="sect3"><span class="enumeration_section">C.11</span>关于在Traffic Director模式下使用Oracle Connection Manager</h3>
               <div>
                  <p>Traffic Director Mode中的Oracle Connection Manager是一个放置在支持的数据库客户端和数据库实例之间的代理。</p>
                  <div class="p">Oracle Database <span class="italic">11g</span>第2版（11.2）及更高版本中支持的客户端可以在Traffic Director模式下连接到Oracle Connection Manager。流量控制器模式中的Oracle连接管理器为计划内和计划外数据库服务器中断，连接多路复用支持和负载平衡提供了改进的高可用性（HA）。以下各节将更详细地介绍对Traffic Director模式中的Oracle Connection Manager的支持<ul style="list-style-type:disc">
                        <li>
                           <p><a href="performance-tuning.html#GUID-BF9AFFD6-537A-4252-BBFB-3A60EEAC3E61__MODESOFOPERATION-4FD4C8FE">运作模式</a></p>
                        </li>
                        <li>
                           <p><a href="performance-tuning.html#GUID-BF9AFFD6-537A-4252-BBFB-3A60EEAC3E61__KEYFEATURES-4FD4D08F">主要特点</a></p>
                        </li>
                     </ul>
                  </div>
                  <div class="section" id="GUID-BF9AFFD6-537A-4252-BBFB-3A60EEAC3E61__MODESOFOPERATION-4FD4C8FE">
                     <p class="subhead2" id="GUID-BF9AFFD6-537A-4252-BBFB-3A60EEAC3E61__GUID-749BC524-93BC-42F1-B765-970605875B7F">运作模式</p>
                     <p>流量控制器模式中的Oracle连接管理器支持以下操作模式：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <div class="p">在池连接模式下，流量控制器模式中的Oracle连接管理器支持使用以下数据库客户端版本的任何应用程序：<ul style="list-style-type:disc">
                                 <li>
                                    <p>OCI，OCCI和开源驱动程序（Oracle Database <span class="italic">11g第</span> 2版（11.2.0.4）及更高版本））</p>
                                 </li>
                                 <li>
                                    <p>JDBC（Oracle Database 12c <span class="italic">第</span> 1版（12.1）及更高版本）</p>
                                 </li>
                                 <li>
                                    <p>ODP.NET（Oracle Database 12 <span class="italic">c第</span> 2版（12.2）及更高版本）</p>
                                 </li>
                              </ul>
                           </div>
                           <p>此外，应用程序必须使用DRCP。也就是说，应用程序必须在连接字符串（或<code class="codeph">tnsnames.ora</code>别名）中启用DRCP。
                           </p>
                        </li>
                        <li>
                           <p>在非池化连接（或专用）模式下，流量控制器模式中的Oracle连接管理器支持使用数据库客户机版本Oracle Database <span class="italic">11g第</span> 2版（11.2.0.4）及更高版本的任何应用程序。在此模式下，某些功能（如连接多路复用）不可用。
                           </p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-BF9AFFD6-537A-4252-BBFB-3A60EEAC3E61__KEYFEATURES-4FD4D08F">
                     <p class="subhead2" id="GUID-BF9AFFD6-537A-4252-BBFB-3A60EEAC3E61__GUID-3A52B2C3-D63C-4ACB-8FED-1BAFC3801338">主要特点</p>
                     <div class="p">Traffic Director Mode中的Oracle Connection Manager提供以下支持：<ul style="list-style-type:disc">
                           <li>
                              <div class="p">透明的性能增强和连接多路复用，包括：<ul style="list-style-type:disc">
                                    <li>
                                       <p>对所有操作模式自动启用语句高速缓存，行预取和结果集高速缓存。</p>
                                    </li>
                                    <li>
                                       <p>使用代理驻留连接池（PRCP）的数据库会话多路复用（仅池化模式），其中PRCP是数据库驻留连接池（DRCP）的代理模式。应用程序在Traffic Director模式下的Oracle Connection Manager与数据库之间获得透明的连接时负载平衡和运行时负载平衡。</p>
                                    </li>
                                    <li>
                                       <p>对于Traffic Director模式实例中的多个Oracle Connection Manager，应用程序通过客户端连接时间负载平衡或负载均衡器（BIG-IP，NGINX等）获得更高的可扩展性</p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li>
                              <div class="p">零应用程序停机时间<ul style="list-style-type:disc">
                                    <li>
                                       <div class="p">计划数据库维护或可插拔数据库（PDB）重定位<ul style="list-style-type:disc">
                                             <li>
                                                <p>合并模式</p>
                                                <p>流量控制器模式中的Oracle Connection Manager响应Oracle Notification Service（ONS）事件以计划中断和重定向工作。请求完成后，在流量控制器模式下，Oracle Connection Manager上的池中的连接将耗尽。Oracle Database <span class="italic">11g第</span> 2版（11.2.0.4）及更高版本支持服务重定位。
                                                </p>
                                                <p>对于PDB重定位，当PDB重新定位时，流量控制器模式中的Oracle连接管理器会响应带内通知，即使未配置ONS时也是如此（对于Oracle数据库版本18c，仅限版本18.1及更高版本的服务器）</p>
                                             </li>
                                             <li>
                                                <p>非汇集或专用模式</p>
                                                <div class="p">当客户端没有请求边界信息时，流量控制器模式中的Oracle连接管理器支持许多应用程序的计划中断（只要在请求/事务边界上只需要保留简单的会话状态和游标状态）。这种支持包括：<ul style="list-style-type:disc">
                                                      <li>
                                                         <p>在事务边界处停止服务/ PDB，或者利用Oracle数据库版本18c连续应用程序可用性来停止请求边界处的服务</p>
                                                      </li>
                                                      <li>
                                                         <p>流量控制器模式中的Oracle连接管理器利用透明应用程序故障转移（TAF）故障转移还原来重新连接和还原简单状态。</p>
                                                      </li>
                                                   </ul>
                                                </div>
                                             </li>
                                          </ul>
                                       </div>
                                    </li>
                                    <li>
                                       <p>针对大多数读取工作负载的计划外数据库中断</p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li>
                              <div class="p">流量控制器模式中Oracle Connection Manager的高可用性，以避免单点故障。这得到以下支持：<ul style="list-style-type:disc">
                                    <li>
                                       <p>流量控制器模式中的多个Oracle连接管理器实例，使用连接字符串中的负载平衡器或客户端负载平衡/故障转移</p>
                                    </li>
                                    <li>
                                       <p>在Traffic Director模式实例中滚动升级Oracle Connection Manager</p>
                                    </li>
                                    <li>
                                       <p>针对计划中断，在流量控制器模式下从客户端到Oracle Connection Manager的现有连接的正常关闭</p>
                                    </li>
                                    <li>
                                       <p>带有Oracle数据库版本18c及更高版本客户端的带内通知</p>
                                    </li>
                                    <li>
                                       <p>对于较旧的客户端，通知将与当前请求的响应一起发送</p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li>
                              <div class="p">为了安全性和隔离性，Traffic Director Mode中的Oracle Connection Manager提供：<ul style="list-style-type:disc">
                                    <li>
                                       <p>数据库代理支持传输控制协议/传输控制协议安全（TCP / TCPS）和协议转换</p>
                                    </li>
                                    <li>
                                       <p>防火墙基于IP地址，服务名称和安全套接字层/传输层安全性（SSL / TLS）钱包</p>
                                    </li>
                                    <li>
                                       <p>多租户环境中的租户隔离</p>
                                    </li>
                                    <li>
                                       <p>防止拒绝服务和模糊测试攻击</p>
                                    </li>
                                    <li>
                                       <p>跨Oracle数据库本地和Oracle Cloud安全地隧道传输数据库流量</p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <div class="infoboxnotealso" id="GUID-BF9AFFD6-537A-4252-BBFB-3A60EEAC3E61__GUID-A2DD3A99-8792-4704-A482-B66B30AD1B85">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>有关配置<code class="codeph">cman.ora</code>配置文件以在Traffic Director模式下设置Oracle Connection Manager的信息，请<code class="codeph">cman.ora</code> <a href="../netag/configuring-oracle-connection-manager.html#NETAG-GUID-3917FC5D-4B23-4752-85BA-39A88C4D13F8" target="_blank"><span><cite>“Oracle数据库网络服务管理员指南”</cite></span></a></p>
                           </li>
                           <li>
                              <p><a href="../netag/configuring-oracle-connection-manager.html#NETAG-GUID-58847B76-3836-41DB-9EB6-A81D5C397024" target="_blank"><span><cite>“Oracle数据库网络服务管理员指南”</cite></span></a> ，了解有关在Traffic Director模式代理身份验证中为Oracle Connection Manager配置数据库的信息</p>
                           </li>
                           <li>
                              <p><a href="../netag/configuring-oracle-connection-manager.html#NETAG-GUID-96FA23BA-F32B-4D47-9CBB-69D27E8D94F6" target="_blank"><span><cite>“Oracle数据库网络服务管理员指南”</cite></span></a> ，了解有关在流量控制器模式下为计划外停机事件配置Oracle Connection Manager的信息</p>
                           </li>
                           <li>
                              <p><a href="../netag/configuring-oracle-connection-manager.html#NETAG-GUID-E73658E7-BBF7-4C13-AAD5-70D32062AD8D" target="_blank"><span><cite>“Oracle数据库网络服务管理员指南”</cite></span></a> ，了解有关在Traffic Director模式下为计划的关闭事件配置Oracle Connection Manager的信息</p>
                           </li>
                           <li>
                              <p><a href="../netag/configuring-oracle-connection-manager.html#NETAG-GUID-15756B12-5ED5-4EDE-9D4B-6B890D5BE9AF" target="_blank"><span><cite>“Oracle数据库网络服务管理员指南”，</cite></span></a>以获取有关在流量控制器模式下配置Oracle Connection Manager使用的代理驻留连接池的信息</p>
                           </li>
                           <li>
                              <p><a href="../netag/configuring-oracle-connection-manager.html#NETAG-GUID-FC833F8F-CE5A-4C02-A962-244954158853" target="_blank"><span><cite>“Oracle数据库网络服务管理员指南”</cite></span></a> ，了解有关在流量控制器模式下使用Oracle Connection Manager的所有驱动程序不支持的功能的信息</p>
                           </li>
                           <li>
                              <p><a href="../netrf/index.html" target="_blank"><span><cite>Oracle Database Net Services参考</cite></span></a> ，以获取Oracle CMAN配置文件的概述</p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
         </div>
      </article>
   </body>
</html>