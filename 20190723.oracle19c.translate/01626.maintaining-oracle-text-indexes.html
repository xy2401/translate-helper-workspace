<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="You can maintain your index for an error or indexing failure."></meta>
      <meta name="description" content="You can maintain your index for an error or indexing failure."></meta>
      <title>维护Oracle文本索引</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Application Developer&#39;s Guide "></meta>
      <meta property="og:description" content="You can maintain your index for an error or indexing failure."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Application Developer&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="text-application-developers-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-07T01:45:16-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2001, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96275-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="creating-oracle-text-indexes.html" title="Previous" type="text/html"></link>
      <link rel="next" href="querying-with-oracle-text.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Text Application Developer&#39;s Guide"></meta>
    <meta name="dcterms.isVersionOf" content="CCAPP"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="creating-oracle-text-indexes.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="querying-with-oracle-text.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">应用程序开发人员指南</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">维护Oracle文本索引</li>
            </ol>
            <a id="GUID-B230E266-1065-40F1-84BA-ADEE715EE2C6" name="GUID-B230E266-1065-40F1-84BA-ADEE715EE2C6"></a>
            
            <h2 id="CCAPP-GUID-B230E266-1065-40F1-84BA-ADEE715EE2C6" class="sect2"><span class="enumeration_chapter">5</span>维护Oracle文本索引</h2>
         </header>
         <div class="ind">
            <div>
               <p>您可以维护索引以查找错误或索引失败。</p>
               <p>本章包含以下主题：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="maintaining-oracle-text-indexes.html#GUID-9C9B8E82-EF57-452F-B8FF-3BF728B56DEF">查看索引错误</a></p>
                  </li>
                  <li>
                     <p><a href="maintaining-oracle-text-indexes.html#GUID-6C7E2AC5-6933-4C89-A63C-19D45D63BB46">删除索引</a></p>
                  </li>
                  <li>
                     <p><a href="maintaining-oracle-text-indexes.html#GUID-8BC1BF13-762C-4A03-8BB9-F3198909EFF0">恢复失败的索引</a></p>
                  </li>
                  <li>
                     <p><a href="maintaining-oracle-text-indexes.html#GUID-BA511205-6725-4DE1-A990-EE936ABF7A22">重新创建索引</a></p>
                  </li>
                  <li>
                     <p><a href="maintaining-oracle-text-indexes.html#GUID-10365262-8B48-40AA-B1F3-DE3268EA9B39">重建指数</a></p>
                  </li>
                  <li>
                     <p><a href="maintaining-oracle-text-indexes.html#GUID-2F50B8D4-106C-4BC7-BBAE-CC4E9B890B62">放弃偏好</a></p>
                  </li>
                  <li>
                     <p><a href="maintaining-oracle-text-indexes.html#GUID-4313B6A6-510F-41E8-9B5C-3559F42742D4">管理CONTEXT索引的DML操作</a></p>
                  </li>
               </ul>
            </div><a id="CCAPP9117"></a><div class="props_rev_3"><a id="GUID-9C9B8E82-EF57-452F-B8FF-3BF728B56DEF" name="GUID-9C9B8E82-EF57-452F-B8FF-3BF728B56DEF"></a><h3 id="CCAPP-GUID-9C9B8E82-EF57-452F-B8FF-3BF728B56DEF" class="sect3"><span class="enumeration_section">5.1</span>查看索引错误</h3>
               <div>
                  <p>有时索引操作可能会失败，或者可能无法成功完成。当系统在行索引期间遇到错误时，它会在Oracle Text视图中记录错误。</p>
                  <p>您可以使用查看索引上的错误<a id="d14631e182" class="indexterm-anchor"></a> <code class="codeph">CTX_USER_INDEX_ERRORS.</code>在<code class="codeph">CTXSYS</code>上查看所有索引上的错误<a id="d14631e190" class="indexterm-anchor"></a> <code class="codeph">CTX_INDEX_ERRORS.</code></p>
                  <p>例如，要查看索引上的最新错误，请输入以下语句：</p><pre class="oac_no_warn" dir="ltr">SELECT err_timestamp，err_text FROM ctx_user_index_errors ORDER BY err_timestamp DESC;</pre><p>要清除错误视图，请输入：</p><pre class="oac_no_warn" dir="ltr">DELETE FROM ctx_user_index_errors;</pre><p>创建新索引时会自动清除此视图。</p>
                  <div class="infoboxnotealso" id="GUID-9C9B8E82-EF57-452F-B8FF-3BF728B56DEF__GUID-8BC3304A-73CF-4AC1-BD54-4DBC48192EF3">
                     <p class="notep1">也可以看看：</p>
                     <p><a href="../ccref/oracle-text-views.html#CCREF1800" target="_blank"><span class="italic">Oracle Text Reference</span></a>了解有关索引错误视图的更多信息</p>
                  </div>
               </div>
            </div><a id="CCAPP9118"></a><div class="props_rev_3"><a id="GUID-6C7E2AC5-6933-4C89-A63C-19D45D63BB46" name="GUID-6C7E2AC5-6933-4C89-A63C-19D45D63BB46"></a><h3 id="CCAPP-GUID-6C7E2AC5-6933-4C89-A63C-19D45D63BB46" class="sect3"><span class="enumeration_section">5.2</span>删除索引</h3>
               <div>
                  <p>必须先删除现有索引，然后才能使用<code class="codeph">CREATE</code> <code class="codeph">INDEX</code>语句重新创建它。
                  </p>
                  <p>使用SQL中的<code class="codeph">DROP</code> <code class="codeph">INDEX</code>语句<code class="codeph">DROP</code> <code class="codeph">INDEX</code> 。</p>
                  <p>如果您尝试使用无效的<code class="codeph">PARAMETERS</code>字符串创建索引，则在重新创建它之前仍需要删除它。
                  </p>
                  <p>例如，到<a id="d14631e305" class="indexterm-anchor"></a>删除一个名为<code class="codeph">newsindex,</code>的索引<code class="codeph">newsindex,</code>输入以下SQL语句：</p><pre class="oac_no_warn" dir="ltr">DROP INDEX newsindex;</pre><p>如果Oracle Text无法确定索引的状态（例如，由于索引错误），则无法删除索引。而是使用：</p><pre class="oac_no_warn" dir="ltr">DROP INDEX newsindex FORCE;</pre><div class="infoboxnotealso" id="GUID-6C7E2AC5-6933-4C89-A63C-19D45D63BB46__GUID-3E0225BA-8315-4E6A-8D70-F1541E89470B">
                     <p class="notep1">也可以看看：</p>
                     <p><a href="../ccref/oracle-text-SQL-statements-and-operators.html#CCREF0109" target="_blank"><span class="italic">Oracle Text Reference</span></a>了解有关<code class="codeph">DROP</code> <code class="codeph">INDEX</code>语句的更多信息</p>
                  </div>
               </div>
            </div><a id="CCAPP9119"></a><div class="props_rev_3"><a id="GUID-8BC1BF13-762C-4A03-8BB9-F3198909EFF0" name="GUID-8BC1BF13-762C-4A03-8BB9-F3198909EFF0"></a><h3 id="CCAPP-GUID-8BC1BF13-762C-4A03-8BB9-F3198909EFF0" class="sect3"><span class="enumeration_section">5.3</span>恢复失败的索引</h3>
               <div>
                  <p>您有时可以使用<code class="codeph">ALTER</code> <code class="codeph">INDEX</code>语句恢复失败的索引。在调查并更正索引失败后，通常会恢复失败的索引。您无法恢复所有索引失败。
                  </p>
                  <p>索引优化定期提交。因此，如果优化操作失败，则已保存到提交点的所有优化工作。</p>
                  <div class="infoboxnotealso" id="GUID-8BC1BF13-762C-4A03-8BB9-F3198909EFF0__GUID-69447AA6-198A-4930-8B9A-61BA4581C8B7">
                     <p class="notep1">也可以看看：</p>
                     <p><a href="../ccref/oracle-text-SQL-statements-and-operators.html#CCREF0101" target="_blank"><span class="italic">Oracle Text Reference</span></a>了解有关<code class="codeph">ALTER</code> <code class="codeph">INDEX</code>语句语法的更多信息</p>
                  </div>
                  <p>以下语句恢复对具有10兆字节内存的<code class="codeph">newsindex</code>的索引操作：</p><pre class="oac_no_warn" dir="ltr">ALTER INDEX newsindex REBUILD PARAMETERS（'恢复记忆10M'）;</pre></div>
            </div><a id="CCAPP9460"></a><div class="props_rev_3"><a id="GUID-BA511205-6725-4DE1-A990-EE936ABF7A22" name="GUID-BA511205-6725-4DE1-A990-EE936ABF7A22"></a><h3 id="CCAPP-GUID-BA511205-6725-4DE1-A990-EE936ABF7A22" class="sect3"><span class="enumeration_section">5.4</span>重新创建索引</h3>
               <div>
                  <p>本节介绍了该过程<a id="d14631e498" class="indexterm-anchor"></a>重新创建索引。在重新创建过程中，您可以正常查询索引。
                  </p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="maintaining-oracle-text-indexes.html#GUID-03DAC3D9-55FB-41CC-96FC-C477D7747976">重新创建全球指数</a></p>
                     </li>
                     <li>
                        <p><a href="maintaining-oracle-text-indexes.html#GUID-63760C07-72B7-4BD9-B203-0C8019F505D5">重新创建本地分区索引</a></p>
                     </li>
                  </ul>
               </div><a id="CCAPP9461"></a><div class="props_rev_3"><a id="GUID-03DAC3D9-55FB-41CC-96FC-C477D7747976" name="GUID-03DAC3D9-55FB-41CC-96FC-C477D7747976"></a><h4 id="CCAPP-GUID-03DAC3D9-55FB-41CC-96FC-C477D7747976" class="sect4"><span class="enumeration_section">5.4.1</span>重新创建全球指数</h4>
                  <div>
                     <p> <a id="d14631e584" class="indexterm-anchor"></a> Oracle Text提供<a id="d14631e587" class="indexterm-anchor"></a> <code class="codeph">RECREATE_INDEX_ONLINE</code>到<a id="d14631e592" class="indexterm-anchor"></a>使用新首选项重新创建<code class="codeph">CONTEXT</code>索引，同时保留基表上的插入，更新和删除。您可以使用<a id="d14631e600" class="indexterm-anchor"></a> <code class="codeph">RECREATE_INDEX_ONLINE</code>在一步过程中为全局索引在线重新创建<code class="codeph">CONTEXT</code>索引。由于新索引是与现有索引一起创建的，因此此操作需要的存储大致等于现有索引的大小。此外，由于<code class="codeph">RECREATE_INDEX_ONLINE</code>操作是在线执行的，因此您可以在操作期间对基表执行插入，更新和删除操作。重新创建过程中发生的所有插入，更新和删除操作都将记录到联机挂起队列中。
                     </p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>重新创建操作完成后，可能不会立即反映新信息。与在线创建索引一样，您应该在重新创建操作完成后同步索引，以使其完全保持最新状态。</p>
                        </li>
                        <li>
                           <p><a id="d14631e620" class="indexterm-anchor"></a>在重新创建操作期间针对索引发出的同步将针对现有数据进行处理。查询返回错误时会阻止同步。
                           </p>
                        </li>
                        <li>
                           <p>在重新创建操作期间针对索引发出的优化命令立即返回，没有错误且没有处理。</p>
                        </li>
                        <li>
                           <p>在<code class="codeph">RECREATE_INDEX_ONLINE,</code>期间<code class="codeph">RECREATE_INDEX_ONLINE,</code>您可以在大多数情况下正常查询索引。查询根据现有索引和策略返回结果，直到最终交换之后。此外，如果您发出插入，更新和删除操作并同步它们，那么在查询现有索引时，您将能够看到新行。
                           </p>
                        </li>
                     </ul>
                     <div class="infoboxnote" id="GUID-03DAC3D9-55FB-41CC-96FC-C477D7747976__GUID-AB2A54AF-B5A9-41B7-BA14-C75838DC754C">
                        <p class="notep1">注意：</p>
                        <p><code class="codeph">RECREATE_INDEX_ONLINE.</code>不支持事务性查询<code class="codeph">RECREATE_INDEX_ONLINE.</code></p>
                     </div>
                     <div class="section">
                        <p class="subhead3" id="GUID-03DAC3D9-55FB-41CC-96FC-C477D7747976__GUID-D0E22C87-11B1-441F-B342-BC8959AF5B93">为Synch重新创建具有时间限制的全局索引</p>
                        <p>您可以控制索引重新创建以设置a <a id="d14631e642" class="indexterm-anchor"></a>非工作时间内<code class="codeph">SYNC_INDEX</code>时间限制，并逐步重新创建索引。将<a href="../ccref/CTX_DDL-package.html#CCREF2106" target="_blank"><code class="codeph">CREATE_SHADOW_INDEX</code></a>过程与<code class="codeph">POPULATE_PENDING</code>和maxtime一起使用。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-03DAC3D9-55FB-41CC-96FC-C477D7747976__GUID-EDFA232A-1809-4F26-80F5-8C12C7F0AA3D">使用预定交换重新创建全局索引</p>
                        <p>同<a id="d14631e663" class="indexterm-anchor"></a> <code class="codeph">CTX_DDL.EXCHANGE_SHADOW_INDEX,</code>您可以在非工作时间执行索引重新创建，此时可以容忍查询失败和DML阻止。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-03DAC3D9-55FB-41CC-96FC-C477D7747976__GUID-8499D1D9-1E0E-4CD8-85FB-AD41B96922D6">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><a href="../ccref/CTX_DDL-package.html#CCREF2111" target="_blank"><span class="italic">Oracle Text Reference</span></a>了解有关<code class="codeph">RECREATE_INDEX_ONLINE</code>过程的更多信息</p>
                              </li>
                              <li>
                                 <p>有关<code class="codeph">CREATE_SHADOW_INDEX</code>信息和示例的<a href="../ccref/CTX_DDL-package.html#CCREF2106" target="_blank"><span class="italic">Oracle Text Reference</span></a></p>
                              </li>
                              <li>
                                 <p>有关<code class="codeph">CTX_DDL.EXCHANGE_SHADOW_INDEX</code>信息和示例的<a href="../ccref/CTX_DDL-package.html#CCREF2109" target="_blank"><span class="italic">Oracle Text Reference</span></a></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="CCAPP9681"></a><div class="props_rev_3"><a id="GUID-63760C07-72B7-4BD9-B203-0C8019F505D5" name="GUID-63760C07-72B7-4BD9-B203-0C8019F505D5"></a><h4 id="CCAPP-GUID-63760C07-72B7-4BD9-B203-0C8019F505D5" class="sect4"><span class="enumeration_section">5.4.2</span>重新创建本地分区索引</h4>
                  <div>
                     <p>如果索引是本地分区的，则无法一步重新创建索引。您必须首先创建一个影子策略，然后运行<a id="d14631e773" class="indexterm-anchor"></a><a id="d14631e775" class="indexterm-anchor"></a>每个分区的<code class="codeph">RECREATE_INDEX_ONLINE</code>过程。您可以指定<code class="codeph">SWAP</code>或<code class="codeph">NOSWAP,</code>它指示重新创建分区的索引是否交换索引分区数据和索引分区元数据。
                     </p>
                     <p>您还可以使用此过程在指定时更新每个分区的元数据（例如，存储首选项） <a id="d14631e790" class="indexterm-anchor"></a><a id="d14631e792" class="indexterm-anchor"></a>参数字符串中的<code class="codeph">NOPOPULATE</code> 。此关键字对于通过时间限制同步增量构建影子索引非常有用。如果指定<code class="codeph">NOPOPULATE,</code> <code class="codeph">NOSWAP</code>以静默方式强制执行<code class="codeph">NOSWAP</code> 。
                     </p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>当所有分区都使用<code class="codeph">NOSWAP,</code>存储要求大约等于现有索引的大小。在重新创建索引分区期间，由于不执行交换，因此会正常处理对分区的查询。跨越多个分区的查询在分区之间返回一致的结果，直到达到交换阶段。
                           </p>
                        </li>
                        <li>
                           <p>使用<code class="codeph">SWAP,</code>重建分区时<code class="codeph">SWAP,</code>的存储要求等于现有索引分区的大小。由于索引分区数据和元数据在重新创建后交换，因此跨越多个分区的查询不会从分区返回一致的结果，但对于每个索引分区，它们始终是正确的。
                           </p>
                        </li>
                        <li>
                           <p>如果指定<code class="codeph">SWAP,</code>则在交换过程中会阻止插入，更新和删除操作以及分区上的同步。
                           </p>
                        </li>
                     </ul>
                     <div class="section">
                        <p class="subhead3" id="GUID-63760C07-72B7-4BD9-B203-0C8019F505D5__GUID-81C68E74-2712-48CB-B4DC-9FA244E1DFFA">使用All-a-once Swap重新创建本地索引</p>
                        <p>您可以在线重新创建本地分区索引以创建或更改首选项。索引和分区元数据的交换发生在流程结束时。跨越多个分区的查询在重新创建过程中会在分区之间返回一致的结果，除非在结束时<a id="d14631e829" class="indexterm-anchor"></a> <a href="../ccref/CTX_DDL-package.html#CCREF2109" target="_blank"><code class="codeph">EXCHANGE_SHADOW_INDEX</code></a>正在运行。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-63760C07-72B7-4BD9-B203-0C8019F505D5__GUID-B2C0264B-03BA-4637-A9D0-93D6FE5CCEDA">使用All-a-once Swap调度本地索引重新创建</p>
                        <p>使用<code class="codeph">RECREATE_INDEX_ONLINE</code>包的<code class="codeph">CTX.DDL</code> ，您可以逐步重新创建本地分区索引，其中分区在末尾都被交换。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-63760C07-72B7-4BD9-B203-0C8019F505D5__GUID-1EA87299-08E3-48F2-BCE8-84A33DE2CB6B">使用按分区交换重新创建本地索引</p>
                        <p>您可以使用新的首选项在线重新创建索引，而不是一次交换所有分区，并在完成时交换每个分区。在此过程中，跨所有分区的查询可能会返回不一致的结果。此过程将<code class="codeph">CREATE_SHADOW_INDEX</code>与<code class="codeph">RECREATE_INDEX_ONLINE.</code> <code class="codeph">CREATE_SHADOW_INDEX</code>使用<code class="codeph">RECREATE_INDEX_ONLINE.</code></p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-63760C07-72B7-4BD9-B203-0C8019F505D5__GUID-C184AC61-531A-4131-BD61-946328FB54E2">
                           <p class="notep1">也可以看看：</p>
                           <p>有关<code class="codeph">RECREATE_INDEX_ONLINE</code>完整信息，请<code class="codeph">RECREATE_INDEX_ONLINE</code> <a href="../ccref/oracle-text-SQL-statements-and-operators.html#CCREF0101" target="_blank"><span class="italic">Oracle Text Reference</span></a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="CCAPP9122"></a><a id="CCAPP9121"></a><div class="props_rev_3"><a id="GUID-10365262-8B48-40AA-B1F3-DE3268EA9B39" name="GUID-10365262-8B48-40AA-B1F3-DE3268EA9B39"></a><h3 id="CCAPP-GUID-10365262-8B48-40AA-B1F3-DE3268EA9B39" class="sect3"><span class="enumeration_section">5.5</span>重建指数</h3>
               <div>
                  <p><a id="d14631e944" class="indexterm-anchor"></a>您可以使用<code class="codeph">ALTER</code> <code class="codeph">INDEX.</code>重建有效索引<code class="codeph">INDEX.</code>重建索引不允许更改大多数索引设置。如果要使用新首选项进行索引，可以重建索引。通常，重建索引而不是删除索引并使用<code class="codeph">CREATE</code> <code class="codeph">INDEX</code>语句重新创建索引没有任何优势。
                  </p>
                  <div class="infoboxnotealso" id="GUID-10365262-8B48-40AA-B1F3-DE3268EA9B39__GUID-D4CB7773-D233-43A9-8BA1-0BCFA7C5A77A">
                     <p class="notep1">也可以看看：</p>
                     <p>有关更改索引设置的信息，请<span class="q">“ <a href="maintaining-oracle-text-indexes.html#GUID-BA511205-6725-4DE1-A990-EE936ABF7A22">重新创建索引</a> ”</span></p>
                  </div>
                  <div class="section">
                     <p>以下语句重建索引并使用<code class="codeph">my_lexer:</code>替换词法分析器首选项<code class="codeph">my_lexer:</code></p><pre class="oac_no_warn" dir="ltr">ALTER INDEX newsindex REBUILD PARAMETERS（'replace lexer my_lexer'）;</pre></div>
                  <!-- class="section" -->
               </div>
            </div><a id="CCAPP9124"></a><a id="CCAPP9123"></a><div class="props_rev_3"><a id="GUID-2F50B8D4-106C-4BC7-BBAE-CC4E9B890B62" name="GUID-2F50B8D4-106C-4BC7-BBAE-CC4E9B890B62"></a><h3 id="CCAPP-GUID-2F50B8D4-106C-4BC7-BBAE-CC4E9B890B62" class="sect3"><span class="enumeration_section">5.6</span>删除偏好</h3>
               <div>
                  <p>当您不再需要索引时，可以删除自定义索引首选项。</p>
                  <p>使用<code class="codeph">CTX_DDL.DROP_PREFERENCE</code>过程删除索引首选项。
                  </p>
                  <p>删除首选项不会影响从首选项创建的索引。</p>
                  <div class="infoboxnotealso" id="GUID-2F50B8D4-106C-4BC7-BBAE-CC4E9B890B62__GUID-0950BC2A-4C5F-4EFC-AF85-14E2A7E0F152">
                     <p class="notep1">也可以看看：</p>
                     <p><a href="../ccref/CTX_DDL-package.html#CCREF0632" target="_blank"><span class="italic">Oracle Text Reference</span></a>了解有关<code class="codeph">CTX_DDL.DROP_PREFERENCE</code>过程语法的更多信息</p>
                  </div>
                  <div class="section">
                     <p>以下代码删除了<code class="codeph">my_lexer</code>首选项：</p><pre class="oac_no_warn" dir="ltr">开始ctx_ddl.drop_preference（'my_lexer'）;结束;</pre></div>
                  <!-- class="section" -->
               </div>
            </div><a id="CCAPP9125"></a><div class="props_rev_3"><a id="GUID-4313B6A6-510F-41E8-9B5C-3559F42742D4" name="GUID-4313B6A6-510F-41E8-9B5C-3559F42742D4"></a><h3 id="CCAPP-GUID-4313B6A6-510F-41E8-9B5C-3559F42742D4" class="sect3"><span class="enumeration_section">5.7</span>管理CONTEXT索引的DML操作</h3>
               <div>
                  <p>DML操作指的是从基表插入，更新或删除文档的时间。本节介绍如何查看，同步和优化DML操作的Oracle Text <code class="codeph">CONTEXT</code>索引。本节包含以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="maintaining-oracle-text-indexes.html#GUID-A1C5E924-C0C2-4D86-B794-B0B6E7C6C8D2">查看待定DML</a></p>
                     </li>
                     <li>
                        <p><a href="maintaining-oracle-text-indexes.html#GUID-99981916-B970-4AF0-AB50-0CFE78067F7E">同步索引</a></p>
                     </li>
                     <li>
                        <p><a href="maintaining-oracle-text-indexes.html#GUID-9960D8E4-0AE8-48B0-82D5-B203695463DE">优化指数</a></p>
                     </li>
                  </ul>
                  <div class="infoboxnote" id="GUID-4313B6A6-510F-41E8-9B5C-3559F42742D4__GUID-B7FD574E-3670-4F4F-B345-87FE06B5FB30">
                     <p class="notep1">注意：</p>
                     <p><code class="codeph">CTXCAT</code>索引是<a id="d14631e1157" class="indexterm-anchor"></a>事务性的，并在基表更改时立即更新。<code class="codeph">CTXCAT</code>索引不需要本节中描述的手动同步。
                     </p>
                  </div>
               </div><a id="CCAPP9126"></a><div class="props_rev_3"><a id="GUID-A1C5E924-C0C2-4D86-B794-B0B6E7C6C8D2" name="GUID-A1C5E924-C0C2-4D86-B794-B0B6E7C6C8D2"></a><h4 id="CCAPP-GUID-A1C5E924-C0C2-4D86-B794-B0B6E7C6C8D2" class="sect4"><span class="enumeration_section">5.7.1</span>查看待处理的DML操作</h4>
                  <div>
                     <p>当您在基表中插入或更新文档时，它们的<a id="d14631e1237" class="indexterm-anchor"></a> rowid保存在DML队列中，直到您同步索引。您可以在<code class="codeph">CTX_USER_PENDING</code>视图中查看此队列。
                     </p>
                     <p>例如，要查看索引上的挂起DML操作，请输入以下语句：</p><pre class="oac_no_warn" dir="ltr">SELECT pnd_index_name，pnd_rowid，to_char（pnd_timestamp，'dd-mon-yyyy hh24：mi：ss'）timestamp FROM ctx_user_pending;</pre><p>此语句以下列形式提供输出：</p><pre class="oac_no_warn" dir="ltr">PND_INDEX_NAME PND_ROWID TIMESTAMP ------------------------------ ----------------- -  -------------------- MYINDEX AAADXnAABAAAS3SAAC 06-oct-1999 15:56:50</pre><div class="infoboxnotealso" id="GUID-A1C5E924-C0C2-4D86-B794-B0B6E7C6C8D2__GUID-DF4C9116-9C6E-4E97-9444-897249093276">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="../ccref/oracle-text-views.html#CCREF1800" target="_blank"><span class="italic">Oracle Text Reference</span></a>了解有关<code class="codeph">CTX_USER_PENDING</code>视图的更多信息</p>
                     </div>
                  </div>
               </div><a id="CCAPP9127"></a><div class="props_rev_3"><a id="GUID-99981916-B970-4AF0-AB50-0CFE78067F7E" name="GUID-99981916-B970-4AF0-AB50-0CFE78067F7E"></a><h4 id="CCAPP-GUID-99981916-B970-4AF0-AB50-0CFE78067F7E" class="sect4"><span class="enumeration_section">5.7.2</span>同步索引</h4>
                  <div>
                     <p>同步索引时，将处理所有挂起的更新并插入基表。您可以在PL / SQL中使用<a id="d14631e1337" class="indexterm-anchor"></a> <code class="codeph">CTX_DDL.SYNC_INDEX</code>程序。您还可以使用<code class="codeph">CTX_DDL.SYNC_INDEX</code>过程控制索引同步的持续时间和锁定行为。
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-99981916-B970-4AF0-AB50-0CFE78067F7E__GUID-553902D4-11DA-441B-8D98-FCC81CC1C6AB">使用SYNC_INDEX同步索引</p>
                        <p>以下示例将索引与2兆字节的内存同步：</p><pre class="oac_no_warn" dir="ltr">开始</pre><pre class="oac_no_warn" dir="ltr">ctx_ddl.sync_index（'myindex'，'2M'）;</pre><pre class="oac_no_warn" dir="ltr">结束;</pre><p>从Oracle Database 12 <span class="italic">c</span>第2版（12.2.0.1）开始，您可以使用<code class="codeph">SYNC_INDEX.</code>自动将<code class="codeph">STAGE_ITAB</code>行合并回<code class="codeph">$I</code>表<code class="codeph">SYNC_INDEX.</code>当<code class="codeph">STAGE_ITAB ($G)</code>的行数超过<code class="codeph">STAGE_ITAB_MAX_ROWS</code>参数（默认为100万<code class="codeph">STAGE_ITAB ($G)</code>时，会发生这种行合并。因此，您不必显式运行合并优化或计划自动优化作业。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-99981916-B970-4AF0-AB50-0CFE78067F7E__GUID-0A3D5140-DC75-4326-A9ED-4EA807ECE55D">SYNC_INDEX的Maxtime参数</p>
                        <p><a id="d14631e1381" class="indexterm-anchor"></a> <code class="codeph">SYNC_INDEX</code>过程包括一个<code class="codeph">maxtime</code>参数，与<code class="codeph">OPTIMIZE_INDEX,</code>一样<code class="codeph">OPTIMIZE_INDEX,</code>表示操作的建议时间限制（以分钟为单位）。<code class="codeph">SYNC_INDEX</code>过程在给定的时间限制内处理队列中尽可能多的文档。
                        </p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a id="d14631e1399" class="indexterm-anchor"></a> <code class="codeph">NULL maxtime</code>相当于<a id="d14631e1404" class="indexterm-anchor"></a> <code class="codeph">CTX_DDL.MAXTIME_UNLIMITED.</code></p>
                           </li>
                           <li>
                              <p>时间限制是近似值。实际时间可能小于或大于您指定的时间。</p>
                           </li>
                           <li>
                              <p><code class="codeph">ALTER</code> <code class="codeph">INDEX</code> ... <code class="codeph">sync</code>命令没有更改，因为它已被弃用。
                              </p>
                           </li>
                           <li>
                              <p>在没有索引名称的情况下调用<code class="codeph">SYNC_INDEX</code>时，将忽略<code class="codeph">maxtime</code>参数。
                              </p>
                           </li>
                           <li>
                              <p>所述<code class="codeph">maxtime</code>参数不能被传达为自动同步（例如， <code class="codeph">sync</code> <code class="codeph">on</code> <code class="codeph">commit</code>或<code class="codeph">sync</code> <code class="codeph">every</code> ）。
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-99981916-B970-4AF0-AB50-0CFE78067F7E__GUID-F9B50CBB-4891-42D0-9E49-38CC96CEAAF9">锁定SYNC_INDEX的参数</p>
                        <p><a id="d14631e1458" class="indexterm-anchor"></a> <code class="codeph">SYNC_INDEX</code>的锁定参数使您可以配置在索引上已运行另一个同步时同步的工作方式。
                        </p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>在没有索引名称的情况下调用<code class="codeph">SYNC_INDEX</code>时，将忽略锁定参数。
                              </p>
                           </li>
                           <li>
                              <p>锁定参数不能被传达为自动同步（即， <code class="codeph">sync</code> <code class="codeph">on</code> <code class="codeph">commit</code>或<code class="codeph">sync</code> <code class="codeph">every</code> ）。
                              </p>
                           </li>
                           <li>
                              <p>当锁定模式为<code class="codeph">LOCK_WAIT,</code>模式将永远等待，如果无法获得锁定，则忽略maxtime设置。
                              </p>
                           </li>
                        </ul>
                        <p>选项如下：</p>
                        <div class="tblformal" id="GUID-99981916-B970-4AF0-AB50-0CFE78067F7E__THISTABLEDESCRIBESLOCKINGBEHAVIORFO-3F3BCF70">
                           <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="This table describes locking behavior for SYNC_INDEX." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="48%" id="d14631e1505">选项</th>
                                    <th align="left" valign="bottom" width="52%" id="d14631e1508">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="48%" id="d14631e1513" headers="d14631e1505 ">
                                       <p><code class="codeph">CTX_DDL.LOCK_WAIT</code></p>
                                    </td>
                                    <td align="left" valign="top" width="52%" headers="d14631e1513 d14631e1508 ">
                                       <p>如果另一个<code class="codeph">SYNC_INDEX</code>正在运行，请等待正在运行的同步完成，然后开始新的同步。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="48%" id="d14631e1524" headers="d14631e1505 ">
                                       <p><code class="codeph">CTX_DDL.LOCK_NOWAIT</code></p>
                                    </td>
                                    <td align="left" valign="top" width="52%" headers="d14631e1524 d14631e1508 ">
                                       <p>如果另一个<code class="codeph">SYNC_INDEX</code>正在运行，则立即返回而不会出现错误。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="48%" id="d14631e1535" headers="d14631e1505 ">
                                       <p><code class="codeph">CTX_DDL.LOCK_NOWAIT_ERROR</code></p>
                                    </td>
                                    <td align="left" valign="top" width="52%" headers="d14631e1535 d14631e1508 ">
                                       <p>如果另一个<code class="codeph">SYNC_INDEX</code>正在运行，则立即生成错误（DRG-51313：等待插入，更新或删除或优化锁定时超时）。
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-99981916-B970-4AF0-AB50-0CFE78067F7E__GUID-998843A8-BA9F-4785-A765-5BE47244812F">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="../ccref/CTX_DDL-package.html#CCREF0652" target="_blank"><span class="italic">Oracle Text Reference</span></a>了解有关<code class="codeph">CTX_DDL.SYNC_INDEX</code>语句语法的更多信息</p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="CCAPP9128"></a><div class="props_rev_3"><a id="GUID-9960D8E4-0AE8-48B0-82D5-B203695463DE" name="GUID-9960D8E4-0AE8-48B0-82D5-B203695463DE"></a><h4 id="CCAPP-GUID-9960D8E4-0AE8-48B0-82D5-B203695463DE" class="sect4"><span class="enumeration_section">5.7.3</span>优化指数</h4>
                  <div>
                     <p><code class="codeph">CONTEXT</code>索引是反向索引，其中每个单词都包含包含该单词的文档列表。例如，在单个初始索引操作之后，单词DOG可能具有以下条目：</p><pre class="oac_no_warn" dir="ltr">DOG DOC1 DOC3 DOC5</pre><p>频繁的索引同步最终会导致您的<code class="codeph">CONTEXT</code>索引碎片化。索引碎片会对查询响应时间产生负面影响。因此，要减少碎片和索引大小并确保最佳查询性能，请<code class="codeph">CONTEXT</code>时间来优化您的<code class="codeph">CONTEXT</code>索引。
                     </p>
                     <p>要计划自动优化作业，必须将<code class="codeph">STAGE_ITAB_MAX_ROWS</code>显式设置为<code class="codeph">0</code>以禁用<code class="codeph">SYNC_INDEX.</code>现在发生的自动合并<code class="codeph">SYNC_INDEX.</code></p>
                     <p>要优化索引，Oracle建议您使用<code class="codeph">CTX_DDL.OPTIMIZE_INDEX.</code>要了解索引优化，您必须了解索引的结构以及在同步时会发生什么。本节包含以下主题：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="maintaining-oracle-text-indexes.html#GUID-10809D0D-D0F4-42E4-9876-FD1C25C9994B">索引碎片</a></p>
                        </li>
                        <li>
                           <p><a href="maintaining-oracle-text-indexes.html#GUID-30862B68-353D-4F6F-81D2-CFBC182DAF56">文档失效和垃圾收集</a></p>
                        </li>
                        <li>
                           <p><a href="maintaining-oracle-text-indexes.html#GUID-8EB38F1A-E696-462D-8CBC-7A2B1BA031E7">单令牌优化</a></p>
                        </li>
                        <li>
                           <p><a href="maintaining-oracle-text-indexes.html#GUID-61C45205-0D97-47BB-9128-0AA2CECCE56A">查看索引碎片和垃圾数据</a></p>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-9960D8E4-0AE8-48B0-82D5-B203695463DE__GUID-0C604983-5C48-40C9-9522-0C92DD8B7144">
                        <p class="notep1">也可以看看：</p>
                        <p>用于<code class="codeph">CTX_DDL.OPTIMIZE_INDEX</code>语句的<a href="../ccref/CTX_DDL-package.html#CCREF0638" target="_blank"><span class="italic">Oracle Text Reference</span></a>语法和示例</p>
                     </div>
                  </div><a id="CCAPP9130"></a><div class="props_rev_3"><a id="GUID-10809D0D-D0F4-42E4-9876-FD1C25C9994B" name="GUID-10809D0D-D0F4-42E4-9876-FD1C25C9994B"></a><h5 id="CCAPP-GUID-10809D0D-D0F4-42E4-9876-FD1C25C9994B" class="sect5"><span class="enumeration_section">5.7.3.1</span>索引碎片</h5>
                     <div>
                        <p>将新文档添加到基表时，通过添加新行来同步索引。例如，如果您添加带有单词<span class="italic">dog</span>的DOC 7文档并同步索引，您现在可以：</p><pre class="oac_no_warn" dir="ltr">DOG DOC1 DOC3 DOC5 DOG DOC7</pre><p>后续插入，更新或删除也会创建新行，如下所示：</p><pre class="oac_no_warn" dir="ltr">狗DOC1 DOC3 DOC5狗DOC7狗DOC9狗DOC11</pre><p>添加新文档并同步索引时会发生索引碎片。特别是，频繁同步索引的后台插入，更新或删除通常会产生比批处理模式同步更多的碎片。</p>
                        <p>当您不太频繁地执行批处理时，可以减少碎片，因为您生成的索引中行数较少的文档列表较长。</p>
                        <p>你可以减少<a id="d14631e1789" class="indexterm-anchor"></a>通过优化索引中的索引碎片<a id="d14631e1794" class="indexterm-anchor"></a> <code class="codeph">FULL</code>或<a id="d14631e1799" class="indexterm-anchor"></a>使用<code class="codeph">CTX_DDL.OPTIMIZE_INDEX.</code> <code class="codeph">FAST</code>模式<code class="codeph">CTX_DDL.OPTIMIZE_INDEX.</code></p>
                     </div>
                  </div><a id="CCAPP9131"></a><div class="props_rev_3"><a id="GUID-30862B68-353D-4F6F-81D2-CFBC182DAF56" name="GUID-30862B68-353D-4F6F-81D2-CFBC182DAF56"></a><h5 id="CCAPP-GUID-30862B68-353D-4F6F-81D2-CFBC182DAF56" class="sect5"><span class="enumeration_section">5.7.3.2</span>文档失效和垃圾收集</h5>
                     <div>
                        <p>从基表中删除文档时，Oracle Text会将文档标记为已删除，但不会立即更改索引。</p>
                        <p>由于旧信息占用空间并且可能在查询时导致额外开销，因此必须通过在<code class="codeph">FULL</code>模式下对其进行优化来从索引中删除旧信息。此过程称为<span class="bold">垃圾回收。</span> 当您对基表执行频繁更新或删除时，必须在<code class="codeph">FULL</code>模式下进行垃圾收集优化。
                        </p>
                     </div>
                  </div><a id="CCAPP9132"></a><div class="props_rev_3"><a id="GUID-8EB38F1A-E696-462D-8CBC-7A2B1BA031E7" name="GUID-8EB38F1A-E696-462D-8CBC-7A2B1BA031E7"></a><h5 id="CCAPP-GUID-8EB38F1A-E696-462D-8CBC-7A2B1BA031E7" class="sect5"><span class="enumeration_section">5.7.3.3</span>单令牌优化</h5>
                     <div>
                        <p>除了优化整个索引外，您还可以优化单个令牌。您可以使用令牌模式来优化经常搜索的索引令牌，而无需花时间优化很少引用的令牌。</p>
                        <p>例如，如果您知道此令牌经常更新和查询，则可以指定仅在索引中优化令牌<span class="italic">DOG</span> 。
                        </p>
                        <p>优化的令牌可以改善令牌的查询响应时间。</p>
                        <p>要在令牌模式下优化索引，请使用<code class="codeph">CTX_DDL.OPTIMIZE_INDEX.</code></p>
                     </div>
                  </div><a id="CCAPP9133"></a><div class="props_rev_3"><a id="GUID-61C45205-0D97-47BB-9128-0AA2CECCE56A" name="GUID-61C45205-0D97-47BB-9128-0AA2CECCE56A"></a><h5 id="CCAPP-GUID-61C45205-0D97-47BB-9128-0AA2CECCE56A" class="sect5"><span class="enumeration_section">5.7.3.4</span>查看索引碎片和垃圾数据</h5>
                     <div>
                        <p>使用<code class="codeph">CTX_REPORT.INDEX_STATS</code>过程，您可以创建索引的统计报告。该报告包含有关最佳行碎片的信息，大多数碎片标记的列表以及索引中的垃圾数据量。虽然此报告可能需要很长时间才能运行大型索引，但它可以帮助您决定是否优化索引。
                        </p>
                        <div class="infoboxnotealso" id="GUID-61C45205-0D97-47BB-9128-0AA2CECCE56A__GUID-5ABC20F0-ED7D-4E91-8496-D3237B271DB3">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="../ccref/CTX_REPORT-package.html#CCREF1100" target="_blank"><span class="italic">Oracle Text Reference</span></a>了解有关使用<code class="codeph">CTX_REPORT.INDEX_STATS</code>过程的更多信息</p>
                        </div>
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>