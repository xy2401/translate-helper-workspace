<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="After computing the pre-change SQL performance data, you can perform the system change on the test system."></meta>
      <meta name="description" content="After computing the pre-change SQL performance data, you can perform the system change on the test system."></meta>
      <title>创建更改后的SQL试用版</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Testing Guide "></meta>
      <meta property="og:description" content="After computing the pre-change SQL performance data, you can perform the system change on the test system."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Testing Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="testing-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-07T01:43:11-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2008, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96279-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="creating-a-pre-change-sql-trial.html" title="Previous" type="text/html"></link>
      <link rel="next" href="comparing-sql-trials.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Testing Guide"></meta>
    <meta name="dcterms.isVersionOf" content="RATUG"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="creating-a-pre-change-sql-trial.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="comparing-sql-trials.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">测试指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="sql-performance-analyzer.html" property="item" typeof="WebPage"><span property="name">SQL性能分析器</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">创建更改后的SQL试用版</li>
            </ol>
            <a id="GUID-CE3A1060-2BD8-4EA9-81F8-E101CD9AD9D5" name="GUID-CE3A1060-2BD8-4EA9-81F8-E101CD9AD9D5"></a><a id="RATUG183"></a>
            
            <h2 id="RATUG-GUID-CE3A1060-2BD8-4EA9-81F8-E101CD9AD9D5" class="sect2"><span class="enumeration_chapter">5</span>创建更改后的SQL试用版</h2>
         </header>
         <div class="ind">
            <div>
               <div><span>计算更改前的SQL性能数据后，可以在测试系统上执行系统更改。</span> 在进行系统更改之前，请确保已在初始环境中执行SQL工作负载以生成更改前的性能数据。例如，如果要测试更改数据库初始化参数将如何影响SQL性能，请在将数据库初始化参数更改为新值之前执行一次SQL工作负载。根据您所做的更改类型，可能需要在测试系统上重新配置环境，以匹配您要执行SQL性能分析的新环境。
               </div>
               <div class="infoboxnote" id="GUID-CE3A1060-2BD8-4EA9-81F8-E101CD9AD9D5__GUID-39ED45E9-09F8-4008-B24E-6FB132D71C99">
                  <p class="notep1">注意：</p>
                  <p>您可以选择通过提供对公共数据库链接的访问来在远程系统上运行SQL试验。执行远程SQL试验时，执行SQL语句的远程数据库的数据库版本必须小于或等于其连接的数据库的数据库版本。从Oracle Database 11.2.0.2开始，远程数据库可以是只读数据库，例如Oracle Active Data Guard实例。</p>
               </div>
               <p><a id="d8956e90" class="indexterm-anchor"></a> <span class="q">“ <a href="introduction-to-oracle-database-testing.html#GUID-F2920E05-3680-4699-B074-92DBEF682B70" title="系统更改（例如升级数据库或添加索引）可能会导致更改SQL语句的执行计划，从而对SQL性能产生重大影响。">SQL性能分析器</a> ”</span>列出了可以使用SQL Performance Analyzer分析的可能系统更改的示例。例如，您可能希望确定数据库初始化参数更改或数据库升级将如何影响SQL性能。您还可以根据顾问程序（如自动数据库诊断监视器（ADDM），SQL调优顾问程序或SQL Access Advisor）的建议更改系统。
               </p>
               <p>完成系统更改后，可以构建<a id="d8956e103" class="indexterm-anchor"></a>通过再次执行SQL工作负载来更改性能数据的版本。SQL Performance Analyzer将存储在更改后的SQL试验中执行SQL语句的结果。
               </p>
               <p>本节介绍如何创建更改后的SQL试用版，并包含以下主题：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="creating-a-post-change-sql-trial.html#GUID-8848FA22-FDEB-4509-B92C-0251125741D2" title="本节介绍如何使用Oracle Enterprise Manager收集更改后的SQL性能数据。">使用Oracle Enterprise Manager创建更改后的SQL试用版</a></p>
                  </li>
                  <li>
                     <p><a href="creating-a-post-change-sql-trial.html#GUID-0C96536D-8129-4794-8527-1AA9FD240E2C" title="本节介绍如何使用DBMS_SQLPA包收集更改后的SQL性能数据。">使用API创建更改后的SQL试用版</a></p>
                  </li>
               </ul>
               <div class="infoboxnote" id="GUID-CE3A1060-2BD8-4EA9-81F8-E101CD9AD9D5__GUID-9B3E2CBA-CECC-4448-8104-E376A17887AC">
                  <p class="notep1">注意：</p>
                  <p>用于创建更改后SQL测试的主要界面是Oracle Enterprise Manager。如果由于某种原因Oracle Enterprise Manager不可用，您可以使用<code class="codeph">DBMS_SQLPA</code> PL / SQL包创建更改后的SQL试用版。
                  </p>
               </div>
               <div class="infoboxnotealso" id="GUID-CE3A1060-2BD8-4EA9-81F8-E101CD9AD9D5__GUID-7A02086F-56D3-4CA2-8DD9-8CA4EEE11B62">
                  <p class="notep1">也可以看看：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><span class="q">“ <a href="introduction-to-sql-performance-analyzer.html#GUID-176E2C1A-5A09-4CDC-9974-1B47129DA08E" title="进行对您要测量的SQL性能影响的更改。SQL Performance Analyzer可以分析许多类型的系统更改的影响。">改变制度</a> ”</span></p>
                     </li>
                     <li>
                        <p><span class="q">“ <a href="introduction-to-sql-performance-analyzer.html#GUID-7BE65E91-0C7B-4740-8114-4DAC76CDDB28" title="执行系统更改后，创建一个更改后的SQL试用版。">衡量更改后的SQL性能</a> ”</span></p>
                     </li>
                  </ul>
               </div>
            </div><a id="RATUG277"></a><a id="RATUG184"></a><div class="props_rev_3"><a id="GUID-8848FA22-FDEB-4509-B92C-0251125741D2" name="GUID-8848FA22-FDEB-4509-B92C-0251125741D2"></a><h3 id="RATUG-GUID-8848FA22-FDEB-4509-B92C-0251125741D2" class="sect3"><span class="enumeration_section">5.1</span>使用Oracle Enterprise Manager创建更改后的SQL试用版</h3>
               <div>
                  <p>本节介绍如何使用Oracle Enterprise Manager收集更改后的SQL性能数据。</p>
                  <div class="p">在进行系统更改以创建更改后的SQL试验之前，您需要创建一个更改前的SQL试用版，如<a href="creating-a-pre-change-sql-trial.html#GUID-34F13B73-7FFA-4E5E-862E-2D38128ED582" title="在创建SQL Performance Analyzer任务并选择SQL调优集作为输入源之后，您需要在测试系统上建立初始环境。">创建更改前的SQL试用版中所述</a> 。
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-8848FA22-FDEB-4509-B92C-0251125741D2__GUID-BB63C60B-E4F7-4850-98FE-480C57758099">要使用Enterprise Manager创建更改后的SQL试用版，请执行以下操作：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ol>
                        <li>
                           <p>在“引导式工作流”页面上，单击“更改环境中的创建SQL试验”步骤的“ <span class="bold">执行”</span>图标。
                           </p>
                           <p>将出现“创建SQL试用版”页面。</p>
                        </li>
                        <li>
                           <p>在“SQL试验名称”字段中，输入SQL试用版的名称。</p>
                        </li>
                        <li>
                           <p>在“SQL试用说明”字段中，输入SQL试用版的说明。</p>
                        </li>
                        <li>
                           <p>在“创建方法”列表中，通过执行以下操作之一来确定如何创建SQL试用版以及生成哪些内容：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>选择“ <span class="bold">本地执行SQL”</span> 。
                                 </p>
                                 <p>SQL试验通过在测试系统上本地运行SQL语句，为SQL调优集中的每个SQL语句生成执行计划和统计信息。</p>
                              </li>
                              <li>
                                 <p>选择<span class="bold">远程执行SQL</span> 。
                                 </p>
                                 <p>SQL试验通过在公共数据库链接上通过另一个测试系统远程实际运行SQL语句，为SQL调优集中的每个SQL语句生成执行计划和统计信息。</p>
                              </li>
                              <li>
                                 <p>选择<span class="bold">本地生成计划</span> 。
                                 </p>
                                 <p>SQL试用版调用优化器在测试系统上本地创建执行计划，而不实际运行SQL语句。</p>
                              </li>
                              <li>
                                 <p>选择<span class="bold">远程生成计划</span> 。
                                 </p>
                                 <p>SQL试验调用优化器通过公共数据库链接在另一个测试系统上远程创建执行计划，而不实际运行SQL语句。</p>
                              </li>
                           </ul>
                           <p>对于每种创建方法，应用程序模式和数据应该已存在于本地或远程测试系统上。</p>
                        </li>
                        <li>
                           <p>在“每SQL时间限制”列表中，通过执行以下操作之一来确定试用期间SQL执行的时间限制：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>选择<span class="bold">5分钟</span> 。
                                 </p>
                                 <p>执行将在SQL调优设置中运行每个SQL语句最多5分钟并收集性能数据。</p>
                              </li>
                              <li>
                                 <p>选择<span class="bold">无限制</span> 。
                                 </p>
                                 <p>执行将运行SQL调优集中的每个SQL语句以完成并收集性能数据。收集执行统计信息可以提高性能分析的准确性，但需要更长的时间。建议不要使用此设置，因为任务可能会被一个SQL语句在较长时间内停止。</p>
                              </li>
                              <li>
                                 <p>选择“ <span class="bold">自定义”</span>并输入指定的秒数，分钟数或小时数。
                                 </p>
                              </li>
                           </ul>
                        </li>
                        <li>
                           <p>确保已在测试系统上执行了您正在测试的系统更改，并选择已<span class="bold">建立的试用环境</span> 。
                           </p>
                        </li>
                        <li>
                           <p>在Schedule部分中：</p>
                           <ol type="a">
                              <li>
                                 <p>在时区列表中，选择您的时区代码。</p>
                              </li>
                              <li>
                                 <p>选择<span class="bold">立即立即</span>启动任务，或<span class="bold">稍后</span>选择安排任务在使用日期和时间字段指定的时间启动。
                                 </p>
                              </li>
                           </ol>
                        </li>
                        <li>
                           <p>单击“ <span class="bold">提交”</span>
                           </p>
                           <p>执行开始时将显示Guided Workflow页面。</p>
                           <p>执行过程中，此步骤的状态图标将变为时钟。要刷新状态图标，请单击“ <span class="bold">刷新”</span> 。根据所选的选项和SQL工作负载的大小，执行可能需要很长时间才能完成。执行完成后，“状态”图标将变为复选标记，并启用下一步的“执行”图标。
                           </p>
                        </li>
                        <li>
                           <p>构建更改后的性能数据后，您可以通过运行比较分析将更改前的SQL试验与更改后的SQL试验进行比较，如<a href="comparing-sql-trials.html#GUID-848B84A7-CB08-4728-9E3A-CBDD70E89E63" title="在构建更改后的SQL性能数据之后，您可以通过使用SQL Performance Analyzer运行比较分析，将在更改前的SQL试验中收集的性能数据与更改后的SQL试验进行比较。">比较SQL试验中所述</a> 。
                           </p>
                        </li>
                     </ol>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="RATUG278"></a><div class="props_rev_3"><a id="GUID-0C96536D-8129-4794-8527-1AA9FD240E2C" name="GUID-0C96536D-8129-4794-8527-1AA9FD240E2C"></a><h3 id="RATUG-GUID-0C96536D-8129-4794-8527-1AA9FD240E2C" class="sect3"><span class="enumeration_section">5.2</span>使用API创建更改后的SQL试用版</h3>
               <div>
                  <p>本节介绍如何使用<code class="codeph">DBMS_SQLPA</code>包收集更改后的SQL性能数据。
                  </p>
                  <div class="p">在进行系统更改以创建更改后的SQL试验之前，您需要创建一个更改前的SQL试用版，如<a href="creating-a-pre-change-sql-trial.html#GUID-34F13B73-7FFA-4E5E-862E-2D38128ED582" title="在创建SQL Performance Analyzer任务并选择SQL调优集作为输入源之后，您需要在测试系统上建立初始环境。">创建更改前的SQL试用版中所述</a> 。
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <div class="infoboxnote" id="GUID-0C96536D-8129-4794-8527-1AA9FD240E2C__GUID-9DCB39E7-F347-43BA-9147-E892C62AB0DB">
                        <p class="notep1">注意：</p>
                        <p>如果通过数据库链接在另一个测试系统上远程运行SQL语句，则调用此过程的远程用户需要具有<code class="codeph">DBMS_SQLPA</code>程序包的<code class="codeph">EXECUTE</code>特权。
                        </p>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-0C96536D-8129-4794-8527-1AA9FD240E2C__GUID-6F941F08-92C9-47C8-A588-E2AF59AB2AEC">要创建更改后的SQL试用版：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>打电话给<a id="d8956e487" class="indexterm-anchor"></a>使用<span class="q">“ <a href="creating-a-pre-change-sql-trial.html#GUID-93D5C8A9-7E85-4467-B3E4-323B1732BA5D" title="本节介绍如何使用DBMS_SQLPA包构建更改前的性能数据。">使用API创建预更改SQL试验</a> ”中</span>描述的参数执行<code class="codeph">EXECUTE_ANALYSIS_TASK</code>过程。
                           </p>
                           <p>请确保为<code class="codeph">execution_name</code>参数指定其他值。强烈建议您使用与更改前SQL SQL试用相同的方法，通过对<code class="codeph">execution_type</code>参数使用相同的值来创建更改后的SQL试用版。
                           </p>
                           <div class="infoboxnote" id="GUID-0C96536D-8129-4794-8527-1AA9FD240E2C__GUID-466A9985-F605-43D4-9621-523A03E2B84E">
                              <p class="notep1">注意：</p>
                              <p>如果要运行Oracle Exadata模拟，应首先将<code class="codeph">CELL_SIMULATION_ENABLED</code>任务参数设置为<code class="codeph">TRUE</code> 。</p>
                           </div>
                           <p>以下示例说明了系统更改后进行的函数调用：</p><pre class="oac_no_warn" dir="ltr">EXEC DBMS_SQLPA.EXECUTE_ANALYSIS_TASK（task_name =&gt;'my_spa_task'， -  execution_type =&gt;'TEST EXECUTE'， -  execution_name =&gt;'my_exec_AFTER_change'）;</pre></li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>构建更改后的性能数据后，您可以通过运行比较分析将更改前的SQL试验与更改后的SQL试验进行比较，如<a href="comparing-sql-trials.html#GUID-848B84A7-CB08-4728-9E3A-CBDD70E89E63" title="在构建更改后的SQL性能数据之后，您可以通过使用SQL Performance Analyzer运行比较分析，将在更改前的SQL试验中收集的性能数据与更改后的SQL试验进行比较。">比较SQL试验中所述</a> 。
                     </p>
                     <div class="infoboxnotealso" id="GUID-0C96536D-8129-4794-8527-1AA9FD240E2C__GUID-F96AE7F8-E99C-4668-A6B7-62DD6CC2BCEE">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="q">“ <a href="creating-an-analysis-task.html#GUID-F4FD92EB-480C-4FE1-BF15-69EE593D9E1C" title="您可以配置SQL Performance Analyzer以运行Oracle Exadata模拟。">使用API为Exadata模拟配置分析任务</a> ”</span></p>
                           </li>
                           <li>
                              <p><a href="../arpls/DBMS_SQLPA.html#ARPLS229" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a> ，了解<code class="codeph">DBMS_SQLPA.EXECUTE_ANALYSIS_TASK</code>函数</p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
         </div>
      </article>
   </body>
</html>