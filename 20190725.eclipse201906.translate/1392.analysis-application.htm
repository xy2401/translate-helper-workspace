<html lang="zh-Hans" dir="ltr" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta name="copyright" content="Copyright (c) Red Hat Inc. and others 2019. This page is made available under license. For full details see the LEGAL in the documentation book that contains this page."></meta>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"></meta>
<meta http-equiv="Content-Style-Type" content="text/css"></meta>
<link rel="stylesheet" href="../../../apache_style.css" type="text/css"></link>
<title>API工具分析应用程序</title>
<script src="PLUGINS_ROOT/org.eclipse.help/livehelp.js" type="text/javascript" language="JavaScript"> </script>
</head>
<body dir="ltr">
<h1>API分析命令行应用程序</h1>
<h2>目的</h2>
<p>此应用程序运行相对于基线的插件项目的完整API分析 - 包括API使用，二进制兼容性和包版本号验证。将配置文件与API基准进行比较以获得二进制兼容性（通常是产品的先前版本）。</p>

<h2>用法</h2>
<h3>描述</h3>
<p>应用程序任务的名称是： <code>org.eclipse.pde.api.tools.apiAnalyzer</code> 。要使用，必须在Eclipse Platform实例中安装版本高级或等于<code>1.1.800</code>的捆绑文件<code>org.eclipse.pde.api.tools</code> 。正确配置平台后，可以使用以下命令启动应用程序：</p>
<p><code>eclipse -application org.eclipse.pde.api.tools -project / path / to / project -depednencies /path/to/list/of/dependencies.txt -baseline default -failOnError</code></p>
<h3>应用程序参数</h3>
<table border="1" cellpadding="2" cellspacing="0">
  <tr>
    <td valign="top"><b>属性</b></td>
    <td valign="top"><b>描述</b></td>
    <td align="center" valign="top"><b>需要</b></td>
  </tr>
<tr>
<td valign="top">项目</td>
<td valign="top">此属性指定要分析的项目的位置。该项目必须是一个有效的Eclipse插件项目，这是一个具有典型<code>.project</code> ， <code>MANIFEST.MF</code> ...文件的项目。
</td>
<td align="center" valign="top">是</td>
</tr>
<tr>
<td valign="top">dependencyList</td>
<td valign="top">此属性指定文件的路径，该文件包含将用作默认目标平台的附加项列表。
<br><br>该文件必须列出依赖项的绝对路径（作为jar文件），用新行或冒号（:)分隔。不是jar文件绝对路径的标记将被忽略。
</td>
<td align="center" valign="top">是</td>
</tr>
<tr>
<td valign="top">底线</td>
<td valign="top">此属性指定参考基线的位置。
<br><br>它可以是目录或<code>.target</code>文件的绝对路径，也可以是<code>default</code>路径。如果是<code>default</code> ，则运行API Tools的当前平台将用作基线。
</td>
<td align="center" valign="top">否。如果省略，则类似于<code>default</code></td>
</tr>
<tr>
<td valign="top">failOnError</td>
<td valign="top">将API合规性错误报告为失败（非<code>0</code>退出代码）</td>
<td align="center" valign="top">没有</td>
</tr>
</table>

<h3>例子</h3>在启用Tycho的<code>pom.xml</code>文件中：<pre>&lt;project&gt; [...]&lt;build&gt; [...]&lt;plugins&gt; [...]&lt;plugin&gt; &lt;artifactId&gt; maven-dependency-plugin &lt;/ artifactId&gt; &lt;executions&gt; &lt;execution&gt; &lt;id&gt; list-dependencies &lt;/ id&gt; &lt;goals&gt; &lt;goal&gt; list &lt;/ goal&gt; &lt;/ goals&gt; &lt;phase&gt; verify &lt;/ phase&gt; &lt;configuration&gt; &lt;outputAbsoluteArtifactFilename&gt; true &lt;/ outputAbsoluteArtifactFilename&gt; &lt;outputScope&gt; false &lt;/ outputScope&gt; &lt;outputFile&gt; $ {project.build.directory} /dependencies.txt &lt;/ outputFile&gt; &lt;/ configuration&gt; &lt;/ execution&gt; &lt;/ executions&gt; &lt;/ plugin&gt; &lt;plugin&gt; &lt;groupId&gt; org.eclipse.tycho.extras &lt;/ groupId&gt; &lt;artifactId&gt; tycho-eclipserun-plugin &lt;/ artifactId&gt; &lt;version&gt; 1.4.0 &lt;/ version&gt; &lt;executions&gt; &lt;execution&gt; &lt;id&gt; api-analysis &lt;/ id&gt; &lt;goals&gt; &lt;goal&gt; eclipse-run &lt;/ goal&gt; &lt;/ goals&gt; &lt;phase&gt; verify &lt;/ phase&gt; &lt;configuration&gt; &lt;applicationsArgs&gt; &lt;！ - 需要将工作空间设置为不是项目子项的目录 - &gt; &lt;arg&gt; -data &lt;/ arg&gt; &lt;args&gt; $ {project.basedir} /../ target / $ {project.artifactId} -apiAnalyzer-workspace &lt; / args&gt; &lt;args&gt; -application &lt;/ args&gt; &lt;args&gt; org.eclipse.pde.api.tools.apiAnalysis &lt;/ args&gt; &lt;args&gt; -project &lt;/ args&gt; &lt;args&gt; $ {project.basedir} &lt;/ args&gt; &lt;args&gt; -bas eline &lt;/ args&gt; &lt;args&gt; default &lt;/ args&gt; &lt;args&gt; -dependencyList &lt;/ args&gt; &lt;args&gt; $ {project.build.directory} /dependencies.txt &lt;/ args&gt; &lt;args&gt; -failOnError &lt;/ args&gt; &lt;/ applicationsArgs&gt; &lt;repositories&gt; &lt;repository&gt; &lt;id&gt; eclipse-4.12 &lt;/ id&gt; &lt;layout&gt; p2 &lt;/ layout&gt; &lt;url&gt; https://download.eclipse.org/eclipse/updates/4.12-I-builds / &lt;/ url&gt; &lt;/ repository&gt; &lt;/ repositories&gt; &lt;dependencies&gt; &lt;！ - 这将构成默认基线 - &gt; &lt;dependency&gt; &lt;artifactId&gt; org.eclipse.sdk.ide &lt;/ artifactId&gt; &lt;type&gt; p2 -installable-unit &lt;/ type&gt; &lt;/ dependency&gt; &lt;/ dependencies&gt; &lt;/ configuration&gt; &lt;/ execution&gt; &lt;/ executions&gt; &lt;/ plugin&gt; &lt;/ plugins&gt; &lt;/ build&gt; &lt;/ project&gt;</pre>
<p>这将运行API分析并在发现错误的情况下使构建失败。</p> 

<h3 class="related">相关参考</h3>
<a href="../ant-tasks/analysis-ant-task.htm">API分析Ant任务</a>
</body>
</html>