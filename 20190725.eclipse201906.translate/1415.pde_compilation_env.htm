<html lang="zh-Hans" dir="ltr">
<head>
  <meta name="copyright" content="Copyright (c) IBM Corporation and others 2006, 2011. This page is made available under license. For full details see the LEGAL in the documentation book that contains this page."></meta>
  <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"></meta>
  <meta http-equiv="Content-Style-Type" content="text/css"></meta>
  <link rel="STYLESHEET" href="../guide/book.css" type="text/css"></link>
  <title>设置编译环境</title>
</head>
<body dir="ltr">
<h1>设置编译环境</h1>
<p>默认情况下，将使用用于运行构建的任何JRE以及源和目标级别设置为1.3和1.2来编译捆绑包。<br>
</p>
<p>PDE构建能够在每个包的基础上配置编译期间使用的JRE。要利用这一点，首先要做的是告诉PDE构建哪些JRE可用。在构建配置build.properties文件中，将属性设置为指向每个已安装的JRE。org.eclipse.pde.build/templates/headless-build中提供的模板build.properties具有已注释掉的环境列表。只需取消注释具有JRE的属性，并将该值设置为属于引导类路径的jar集。例如，设置属性：<br>
</p>
<div style="text-align:center"><tt>J2SE-1.5 = C：/Java/1.5/jre/lib/rt.jar; C：/Java/1.5/jre/lib/jsse.jar</tt><br>
</div>
<p style="text-align:left">将针对rt.jar和jsse.jar编译需要java 1.5的bundle。属性的名称应与PDE Build知道的环境的名称相匹配。PDE Build将自动为每个环境设置源和目标级别。PDE构建的环境及其关联的源/目标级别如下：<br>
</p>
<table border="1" cellpadding="1" cellspacing="1" style="width:60%;height:54px;text-align:left;margin-left:auto;margin-right:auto">
  <tbody>
    <tr>
      <td style="vertical-align:top;text-align:center">环境<br>
      </td>
      <td style="vertical-align:top">资源<br>
      </td>
      <td style="vertical-align:top">目标<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align:top">CDC-1.0 /基金会1.0<br>
      </td>
      <td style="vertical-align:top">1.3<br>
      </td>
      <td style="vertical-align:top">1.1<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align:top">CDC-1.1 /基金会1.1<br>
      </td>
      <td style="vertical-align:top">1.3<br>
      </td>
      <td style="vertical-align:top">1.2<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align:top">的OSGi /最小-1.0<br>
      </td>
      <td style="vertical-align:top">1.3<br>
      </td>
      <td style="vertical-align:top">1.1<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align:top">的OSGi /最小-1.1<br>
      </td>
      <td style="vertical-align:top">1.3<br>
      </td>
      <td style="vertical-align:top">1.2<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align:top">JRE-1.1<br>
      </td>
      <td style="vertical-align:top">1.1<br>
      </td>
      <td style="vertical-align:top">1.1<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align:top">J2SE-1.2<br>
      </td>
      <td style="vertical-align:top">1.2<br>
      </td>
      <td style="vertical-align:top">1.1<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align:top">J2SE-1.3<br>
      </td>
      <td style="vertical-align:top">1.3<br>
      </td>
      <td style="vertical-align:top">1.1<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align:top">J2SE-1.4<br>
      </td>
      <td style="vertical-align:top">1.3<br>
      </td>
      <td style="vertical-align:top">1.2<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align:top">J2SE-1.5<br>
      </td>
      <td style="vertical-align:top">1.5<br>
      </td>
      <td style="vertical-align:top">1.5<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align:top">JavaSE的-1.6<br>
      </td>
      <td style="vertical-align:top">1.6<br>
      </td>
      <td style="vertical-align:top">1.6<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align:top">的PersonalJava-1.1<br>
      </td>
      <td style="vertical-align:top">1.1<br>
      </td>
      <td style="vertical-align:top">1.1<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align:top">的PersonalJava-1.2<br>
      </td>
      <td style="vertical-align:top">1.1<br>
      </td>
      <td style="vertical-align:top">1.1<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align:top">CDC-1.0 / PersonalBasis-1.0<br>
      </td>
      <td style="vertical-align:top">1.3<br>
      </td>
      <td style="vertical-align:top">1.1<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align:top">CDC-1.0 /的PersonalJava-1.0<br>
      </td>
      <td style="vertical-align:top">1.3<br>
      </td>
      <td style="vertical-align:top">1.1<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align:top">CDC-1.1 / PersonalBasis-1.1<br>
      </td>
      <td style="vertical-align:top">1.3<br>
      </td>
      <td style="vertical-align:top">1.2<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align:top">CDC-1.1 /的PersonalJava-1.1<br>
      </td>
      <td style="vertical-align:top">1.3<br>
      </td>
      <td style="vertical-align:top">1.2<br>
      </td>
    </tr>
  </tbody>
</table>
<h2>为您的Bundle选择环境</h2>有两个设置会影响用于编译捆绑包的环境。一个是清单头<span style="font-weight:bold">Bundle-RequiredExecutionEnvironment</span> 。此标头是您的捆绑包可以运行的环境列表。您的捆绑包应该只使用列出的所有环境的适当子集中的方法。希望您的编译环境尽可能地与您的运行时环境相匹配。<br>
<br>第二个设置是bundle的build.properties文件中的属性<span style="font-weight:bold">jre.compilation.profile</span> 。如果Bundle-RequiredExecutionEnvironment列表不足，则此属性的值应该是编译此捆绑包的首选环境。<br>
<br>这两个设置一起形成环境列表，首先是jre.compilation.profile，然后是Bundle-RequiredExecutionEnvironment中的环境。此列表中可用于构建配置的第一个环境（请参阅上一节）将用于编译捆绑包。<br>
<br>例：<br>
<pre style="margin-left:40px">&lt;buildDirectory&gt; /插件/ bundleA /<br>META-INF / manifest.mf：Bundle-RequiredExecutionEnvironment：CDC-1.0 / Foundation-1.0，J2SE-1.3<br>build.properties：jre.compilation.profile = J2SE-1.4<br><br>&lt;buildConfiguration&gt; /<br>build.properties：J2SE-1.3 = C：/Java1.3/jre/lib/rt.jar; C：/Java1.3/jre/lib/i18n.jar<br>J2SE-1.4 = C：/Java1.4/jre/lib/rt.jar; C：/Java1.4/jre/lib/jsse.jar<br></pre>
<p style="margin-left:40px">在上面的设置中，（按顺序）考虑的环境列表是：J2SE-1.4，CDC-1.0 / Foundation-1.0，J2SE-1.3。该bundle可以在CDC / Foundation和J2SE-1.3上运行，但由于某种原因，它应该用J2SE-1.4编译。在这种情况下，J2SE-1.4在构建配置中设置，并且首先出现在环境列表中，因此它用于编译bundle。在这种情况下使用的源和目标级别是1.3和1.2。相反，如果构建配置仅定义了J2SE-1.3而不是J2SE-1.4，则J2SE-1.3将是列表中唯一可用于JRE的环境，因此它将用于编译捆绑包。在这种情况下，源和目标水平将是1.3和1.1。<br>
</p>
<h2>显式设置编译值</h2>如果出于某种原因，使用上述环境不会产生所需的设置，则捆绑包可以明确列出所需的设置。例如，如果您的捆绑包使用带有断言的J2SE-1.4，则源和目标级别需要为1.4，而不是默认的1.3和1.2。<br>
<br>要显式设置java源和目标级别，bundle应在其build.properties文件中设置属性<tt style="font-weight:bold">javacSource</tt>和<tt style="font-weight:bold">javacTarget</tt> 。这些属性将覆盖从环境设置派生的值。<br>
<br>同样，在bundle的build.properties文件中设置属性<tt>bootClasspath</tt>将覆盖编译bundle的jar集。<br>
<br>
</body>
</html>