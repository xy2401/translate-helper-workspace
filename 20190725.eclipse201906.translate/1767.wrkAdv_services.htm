<html lang="zh-Hans" >
<head>

<meta name="copyright" content="Copyright (c) IBM Corporation and others 2008. This page is made available under license. For full details see the LEGAL in the documentation book that contains this page.">

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">

<link rel="STYLESHEET" href="../book.css" type="text/css" charset="ISO-8859-1">
<title>服务</title>

<link rel="stylesheet" type="text/css" href="../book.css">
</head>
<body bgcolor="#ffffff" >
<h2>服务</h2>
<p>工作台定义了许多可以从<a href="../reference/api/org/eclipse/ui/services/IServiceLocator.html">org.eclipse.ui.services中检索的服务<a href="../reference/api/org/eclipse/ui/services/IServiceLocator.html">。IServiceLocator</a> 。服务为组件提供了一种检索有关工作台信息的方法，而无需始终转到全局单例： <code>PlatformUI.getWorkbench()</code> 。例如：</p>
<pre>
		IHandlerService handlerService = (IHandlerService) getSite()
				.getService(IHandlerService.class);
</pre>
<p>有些服务提供2种可选功能，通常在服务接口javadoc中指定：</p>
<ul>
<li>支持侦听器的服务可以在组件的<a href="../reference/api/org/eclipse/ui/services/IServiceLocator.html">org.eclipse.ui.services时自动清理侦听器<a href="../reference/api/org/eclipse/ui/services/IServiceLocator.html">。IServiceLocator</a> （用于获取服务）被处置掉。</li>
<li>服务可以根据请求的组件提供更多本地化服务。</li>
</ul>
<p>请参阅<a href="workbench_cmd_handlers.htm" class="XRef">使用命令将处理程序与命令相关联...</a>有关<a href="../reference/api/org/eclipse/ui/handlers/IHandlerService.html">org.eclipse.ui.handlers提供的激活本地化示例<a href="../reference/api/org/eclipse/ui/handlers/IHandlerService.html">。IHandlerService</a> 。
</p>
<h3>Workbench提供的服务</h3>
<p>工作台提供的服务现在包括一些<a href="../reference/api/org/eclipse/ui/IWorkbenchPart.html">org.eclipse.ui最常见的服务<a href="../reference/api/org/eclipse/ui/IWorkbenchPart.html">。IWorkbenchPart</a>需要。服务javadoc中指定了对服务相关的可选功能的支持。服务的可用性等于或低于指定的级别。</p>
<table border="1">
<tr>
<th>服务</th>
<th>描述</th>
<th>可用性</th>
</tr>

<tr>
<td><a href="../reference/api/org/eclipse/ui/keys/IBindingService.html">IBindingService</a>
</td>
<td>提供与工作台内的绑定体系结构（例如，键盘快捷方式）相关的服务。</td>
<td>在全球范围内</td>
</tr>

<tr>
<td><a href="../reference/api/org/eclipse/ui/commands/ICommandService.html">ICommandService</a>
</td>
<td>提供与工作台中的命令体系结构相关的服务。</td>
<td>在全球范围内</td>
</tr>

<tr>
<td><a href="../reference/api/org/eclipse/ui/commands/ICommandImageService.html">ICommandImageService</a>
</td>
<td>为与命令关联的图像提供查找工具。</td>
<td>在全球范围内</td>
</tr>

<tr>
<td><a href="../reference/api/org/eclipse/ui/contexts/IContextService.html">IContextService</a>
</td>
<td>提供与Eclipse工作台中的上下文相关的服务，如上下文激活和定义。</td>
<td>在全球范围内</td>
</tr>

<tr>
<td><a href="../reference/api/org/eclipse/ui/model/IContributionService.html">IContributionService</a>
</td>
<td>IContributionService是在工作台级别提供的服务，它提供客户端可用于处理用户界面贡献的机制。目前，这仅限于为特定贡献类型提供分拣机，但这可能在将来扩展。在服务台的整个生命周期中都存在此服务的实例。</td>
<td>在全球范围内</td>
</tr>

<tr>
<td><a href="../reference/api/org/eclipse/ui/services/IEvaluationService.html">IEvaluationService</a>
</td>
<td>根据工作台应用程序上下文评估核心表达式，并使用Boolean属性报告更新。还提供了工作台应用程序上下文的主要来源。</td>
<td>在全球范围内</td>
</tr>

<tr>
<td><a href="../reference/api/org/eclipse/ui/swt/IFocusService.html">IFocusService</a>
</td>
<td>跟踪使用此服务注册的Control的focusGained和focusLost事件，并将控件及其注册的ID作为变量提供给应用程序评估上下文，以供各种服务进行评估。</td>
<td>在全球范围内</td>
</tr>

<tr>
<td><a href="../reference/api/org/eclipse/ui/handlers/IHandlerService.html">IHandlerService</a>
</td>
<td>提供与在工作台中激活和停用处理程序相关的服务。</td>
<td>在全球范围内</td>
</tr>

<tr>
<td><a href="../reference/api/org/eclipse/ui/menus/IMenuService.html">IMenuService</a>
</td>
<td>提供与工作台中的菜单架构相关的服务。它可用于按组件填充MenuManagers和ToolBarManagers。</td>
<td>在全球范围内</td>
</tr>

<tr>
<td><a href="../reference/api/org/eclipse/ui/IPageService.html">IPageService</a>
</td>
<td>页面服务跟踪工作台窗口中的页面和透视生命周期事件。</td>
<td>工作台窗口</td>
</tr>

<tr>
<td><a href="../reference/api/org/eclipse/ui/IPartService.html">IPartService</a>
</td>
<td>零件服务跟踪工作台窗口中零件的创建和激活。</td>
<td>工作台窗口</td>
</tr>

<tr>
<td><a href="../reference/api/org/eclipse/ui/progress/IProgressService.html">IProgressService</a>
</td>
<td>进度服务是工作台进度支持的主要界面。</td>
<td>在全球范围内</td>
</tr>

<tr>
<td><a href="../reference/api/org/eclipse/ui/progress/IWorkbenchSiteProgressService.html">IWorkbenchSiteProgressService</a>
</td>
<td>部件进度服务是一个IProgressService，它为在IWorkbenchPartSite运行时更改状态的作业添加API。</td>
<td>零件网站</td>
</tr>

<tr>
<td><a href="../reference/api/org/eclipse/ui/ISaveablesLifecycleListener.html">ISaveablesLifecycleListener</a>
</td>
<td>实现<a href="../reference/api/org/eclipse/ui/ISaveablesSource.html">org.eclipse.ui的部件<a href="../reference/api/org/eclipse/ui/ISaveablesSource.html">。ISaveablesSource</a>应该通知他们的<code>ISaveablesLifecycleListener</code> ，它可以从他们的站点获得有关<a href="../reference/api/org/eclipse/ui/Saveable.html">org.eclipse.ui的服务。已添加到零件或从零件中移除的可保存</a>对象。不是部分的<code>ISaveablesSource</code>实现应该从<a href="../reference/api/org/eclipse/ui/IWorkbench.html">org.eclipse.ui中检索此服务<a href="../reference/api/org/eclipse/ui/IWorkbench.html">。IWorkbench</a>对象。</td>
<td>在全球范围内</td>
</tr>

<tr>
<td><a href="../reference/api/org/eclipse/ui/ISelectionService.html">ISelectionService</a>
</td>
<td>选择服务在工作台窗口中跟踪选择。</td>
<td>工作台窗口</td>
</tr>

</table>

<h3>贡献服务</h3>
<p>在eclipse中提供框架的插件开发人员也可能想要提供服务。这可以使用<a href="../reference/extension-points/org_eclipse_ui_services.html">org.eclipse.ui.services</a>扩展点来完成。基于<a href="../reference/api/org/eclipse/ui/services/AbstractServiceFactory.html">org.eclipse.ui.services定义服务工厂<a href="../reference/api/org/eclipse/ui/services/AbstractServiceFactory.html">。AbstractServiceFactory</a>然后指定工厂可以返回的服务。工厂可以创建多种类型的服务，但是多个工厂无法为相同的服务类型做出贡献。
</p>
<pre>
      &lt;serviceFactory
            factoryClass="org.eclipse.ui.examples.contributions.model.PersonServiceFactory"&gt;
         &lt;service
               serviceClass="org.eclipse.ui.examples.contributions.model.IPersonService"/&gt;
      &lt;/serviceFactory&gt;
</pre>
<p><a href="../reference/api/org/eclipse/ui/services/AbstractServiceFactory.html">org.eclipse.ui.services的create方法<a href="../reference/api/org/eclipse/ui/services/AbstractServiceFactory.html">。AbstractServiceFactory</a>传入3个参数：</p>
<ul>
<li><code>serviceInterface</code> - 需要创建的接口类</li>
<li><code>parentLocator</code> - 一个<a href="../reference/api/org/eclipse/ui/services/IServiceLocator.html">org.eclipse.ui.services。IServiceLocator</a> ，可用于获取<code>serviceInterface</code>的父服务</li>
<li><code>locator</code> - <a href="../reference/api/org/eclipse/ui/services/IServiceLocator.html">org.eclipse.ui.services。请求创建请求此服务的IServiceLocator</a> 。它可用于检索依赖服务。</li>
</ul>
<p>工作台服务是有组织的，因此有一个提供所需功能的全球服务，以及一系列儿童服务。子服务提供监听器清理以及本地化服务请求所需的任何数据。</p>
<p>当<code>parentLocator</code>在请求<code>serviceInterface</code>时返回<code>null</code>时，服务工厂应该返回全局服务。全局服务可以是实现，也可以是插件提供的管理器或OSGi服务的代理。
</p>
<pre>
		Object parentService = parentLocator.getService(IPersonService.class);
		if (parentService == null) {
			return new PersonService(locator);
		}
		return new PersonServiceSlave(locator, (IPersonService) parentService);
		
		// or ...
		Object parentService = parentLocator.getService(IPersonService.class);
		if (parentService == null) {
			return Activator.getDefault().getPersonManager();
		}
		return new PersonServiceSlave(locator, (IPersonService) parentService);
		
		//
		// or as a front to an OSGi service.
		Object parentService = parentLocator.getService(IPersonService.class);
		if (parentService == null) {
			PersonServiceProxy proxy = new PersonServiceProxy(locator,
			        Activator.getDefault().getBundle().getBundleContext(),
			        0);
			proxy.findService();
			return proxy;
		}
		PersonServiceProxy proxy = new PersonServiceProxy(locator,
		     Activator.getDefault().getBundle().getBundleContext(),
		     ((PersonServiceProxy)parentService).getLevel()+1);
		proxy.findService();
		return proxy;
</pre>
<p>在上面的OSGi服务片段中，不是让每个子<code>IPersonService</code>知道它的父级， <code>IPersonService</code>每个<code>IPersonService</code>直接与OSGi服务对话并使用父级来计算其“级别”，这允许它本地化它提供的任何功能。
</p>

</body>
</html>