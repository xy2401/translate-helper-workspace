<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>Operations Specific to Persistent and Temporary LOBs</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Database SecureFiles and Large Objects Developer's Guide">
      <meta property="og:description" content="">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Database SecureFiles and Large Objects Developer's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="securefiles-and-large-objects-developers-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-02-12T02:58:18-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96333-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="using-oracle-LOBs-storage.html" title="Previous" type="text/html">
      <link rel="next" href="distributed-LOBs.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="SecureFiles and Large Objects Developer's Guide">
    <meta name="dcterms.isVersionOf" content="ADLOB">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="using-oracle-LOBs-storage.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="distributed-LOBs.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Database SecureFiles and Large Objects Developer's Guide</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="getting-started.html" property="item" typeof="WebPage"><span property="name">    Getting Started</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem"> Operations Specific to Persistent and Temporary LOBs</li>
            </ol>
            <a id="GUID-7B3D15D3-A182-4ED1-A265-8EE15E793C46" name="GUID-7B3D15D3-A182-4ED1-A265-8EE15E793C46"></a><a id="ADLOB45635"></a>
            
            <h2 id="ADLOB-GUID-7B3D15D3-A182-4ED1-A265-8EE15E793C46" class="sect2"><span class="enumeration_chapter">4 </span> Operations Specific to Persistent and Temporary LOBs
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>LOB operations between persistent and temporary LOB instances can differ. </p>
               <p>Topics: </p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p><a href="operations-specific-to-persistent-and-temporary-LOBs.html#GUID-45C84AD5-42D3-45BD-A04C-FCA37D0BFE6E">Persistent LOB Operations</a></p>
                  </li>
                  <li>
                     <p><a href="operations-specific-to-persistent-and-temporary-LOBs.html#GUID-DE7A5AA6-6A30-4F5D-A1E7-37E71584A31E">Temporary LOB Operations</a></p>
                  </li>
                  <li>
                     <p><a href="operations-specific-to-persistent-and-temporary-LOBs.html#GUID-18AE018F-3943-418D-B2C5-2555A19112E0">Creating Persistent and Temporary LOBs in PL/SQL</a></p>
                  </li>
                  <li>
                     <p><a href="operations-specific-to-persistent-and-temporary-LOBs.html#GUID-20481180-4E23-4693-B1CD-32C2E77EBFBA">Freeing Temporary LOBs in OCI</a></p>
                  </li>
               </ul>
               <div class="infoboxnotealso" id="GUID-7B3D15D3-A182-4ED1-A265-8EE15E793C46__GUID-6765CD7C-52BB-46FC-8C2B-6E12053135E0">
                  <p class="notep1">See Also:</p>
                  <p></p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="using-LOB-APIs.html#GUID-5BEE64AC-5528-45DC-AB57-A8EDE8E4DE65" title="You can convert a BLOB instance to a CLOB using the PL/SQL procedure DBMS_LOB.CONVERTTOCLOB."> Using LOB APIs </a> gives details and examples of API usage for LOB APIs that can be used with either temporary or persistent LOBs. 
                        </p>
                     </li>
                     <li>
                        <p><a href="LOB-APIs-for-BFILE-operations.html#GUID-043A9B91-69C8-44D4-A38A-E872B0A2B9A9" title="You can determine whether a pattern exists in a BFILE using the INSTRoperation."> LOB APIs for BFILE Operations</a> gives details and examples for usage of LOB APIs that operate on BFILEs.
                        </p>
                     </li>
                  </ul>
               </div>
            </div><a id="ADLOB45636"></a><div class="props_rev_3"><a id="GUID-45C84AD5-42D3-45BD-A04C-FCA37D0BFE6E" name="GUID-45C84AD5-42D3-45BD-A04C-FCA37D0BFE6E"></a><h3 id="ADLOB-GUID-45C84AD5-42D3-45BD-A04C-FCA37D0BFE6E" class="sect3">Persistent LOB Operations</h3>
               <div>
                  <p>This section describes operations that apply only to persistent LOBs. </p>
               </div><a id="ADLOB45637"></a><div class="props_rev_3"><a id="GUID-92061E43-8CB8-4A82-9FDE-F3F42ABD551E" name="GUID-92061E43-8CB8-4A82-9FDE-F3F42ABD551E"></a><h4 id="ADLOB-GUID-92061E43-8CB8-4A82-9FDE-F3F42ABD551E" class="sect4">Inserting a LOB into a Table </h4>
                  <div>
                     <div class="section">
                        <p>You can insert LOB instances into persistent LOB columns using by multiple methods. </p>
                        <div class="infoboxnotealso" id="GUID-92061E43-8CB8-4A82-9FDE-F3F42ABD551E__DDLANDDMLSTATEMENTSWITHLOBS-DD47C174">
                           <p class="notep1">See Also:</p>
                           <p><a href="DDL-DML-statements-with-LOBs.html#GUID-17F0F935-FD78-4F41-B6DF-86409522D667" title="You can insert a row by initializing a LOB locator bind variable.">DDL and DML Statements with LOBs</a> for more information about the different methods available to insert LOB instances into persistent LOB columns
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADLOB45638"></a><div class="props_rev_3"><a id="GUID-1247D9C9-AB93-4635-A878-24D6AD928E5D" name="GUID-1247D9C9-AB93-4635-A878-24D6AD928E5D"></a><h4 id="ADLOB-GUID-1247D9C9-AB93-4635-A878-24D6AD928E5D" class="sect4">Selecting a LOB from a Table</h4>
                  <div>
                     <div class="section">
                        <p>You can select a persistent LOB from a table just as you would any other data type. In the following example, persistent LOB instances of different types are selected into PL/SQL variables. </p><pre class="oac_no_warn" dir="ltr">
declare
  blob1 BLOB;
  blob2 BLOB;
  clob1 CLOB;
  nclob1 NCLOB;
BEGIN
  SELECT ad_photo INTO blob1 FROM print_media WHERE Product_id = 2268 
        FOR UPDATE;
  SELECT ad_photo INTO blob2 FROM print_media WHERE Product_id = 3106;

  SELECT ad_sourcetext INTO clob1 FROM Print_media
      WHERE product_id=3106 and ad_id=13001 FOR UPDATE;

  SELECT ad_fltextn INTO nclob1 FROM Print_media
      WHERE product_id=3060 and ad_id=11001 FOR UPDATE;

END;
/
show errors;</pre></div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="ADLOB45639"></a><div class="props_rev_3"><a id="GUID-DE7A5AA6-6A30-4F5D-A1E7-37E71584A31E" name="GUID-DE7A5AA6-6A30-4F5D-A1E7-37E71584A31E"></a><h3 id="ADLOB-GUID-DE7A5AA6-6A30-4F5D-A1E7-37E71584A31E" class="sect3">Temporary LOB Operations</h3>
               <div>
                  <p>This section describes operations that apply only to temporary LOB instances. </p>
               </div><a id="ADLOB1005"></a><div class="props_rev_3"><a id="GUID-1216E5A8-792D-46CE-B68E-4CAFB70E5CC4" name="GUID-1216E5A8-792D-46CE-B68E-4CAFB70E5CC4"></a><h4 id="ADLOB-GUID-1216E5A8-792D-46CE-B68E-4CAFB70E5CC4" class="sect4">Creating and Freeing a Temporary LOB</h4>
                  <div>
                     <div class="section">
                        <p>To create a temporary LOB instance, you must declare a variable of the given LOB data type and pass the variable to the <code class="codeph">CREATETEMPORARY</code> API. 
                        </p>
                        <p>The temporary LOB instance exists in your application until it goes out of scope, your session terminates, or you explicitly free the instance. Freeing a temporary LOB instance is recommended to free system resources. </p>
                        <p>The following example demonstrates how to create and free a temporary LOB in the PL/SQL environment using the DBMS_LOB package. </p><pre class="oac_no_warn" dir="ltr">declare
  blob1 BLOB;
  blob2 BLOB;
  clob1 CLOB;
  nclob1 NCLOB;
BEGIN
  -- create temp LOBs
  DBMS_LOB.CREATETEMPORARY(blob1,TRUE, DBMS_LOB.SESSION);
  DBMS_LOB.CREATETEMPORARY(blob2,TRUE, DBMS_LOB.SESSION);
  DBMS_LOB.CREATETEMPORARY(clob1,TRUE, DBMS_LOB.SESSION);
  DBMS_LOB.CREATETEMPORARY(nclob1,TRUE, DBMS_LOB.SESSION);

  -- fill with data
  writeDataToLOB_proc(blob1);
  writeDataToLOB_proc(blob2);

  -- CHAR-&gt;LOB conversion
  clob1 := 'abcde';
  nclob1 := TO_NCLOB(clob1);

  -- Other APIs
  call_lob_apis(blob1, blob2, clob1, nclob1);

  -- free temp LOBs
  DBMS_LOB.FREETEMPORARY(blob1);
  DBMS_LOB.FREETEMPORARY(blob2);
  DBMS_LOB.FREETEMPORARY(clob1);
  DBMS_LOB.FREETEMPORARY(nclob1);

END;
/
show errors;
</pre></div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="ADLOB45640"></a><div class="props_rev_3"><a id="GUID-18AE018F-3943-418D-B2C5-2555A19112E0" name="GUID-18AE018F-3943-418D-B2C5-2555A19112E0"></a><h3 id="ADLOB-GUID-18AE018F-3943-418D-B2C5-2555A19112E0" class="sect3">Creating Persistent and Temporary LOBs in PL/SQL</h3>
               <div>
                  <div class="section">
                     <p>The code example that follows illustrates how to create persistent and temporary LOBs in PL/SQL. This code is in the demonstration file: </p><pre class="oac_no_warn" dir="ltr"><span>$ORACLE_HOME/rdbms/demo/lobs/plsql/lobdemo.sql</span>
</pre><p>This demonstration file also calls procedures in separate PL/SQL files that illustrate usage of other LOB APIs. </p>
                     <div class="infoboxnotealso" id="GUID-18AE018F-3943-418D-B2C5-2555A19112E0__PLSQLLOBDEMONSTRATIONFILESFORALISTO-DD485C65">
                        <p class="notep1">See Also:</p>
                        <p><a href="LOB-demonstration-files.html#GUID-6F195C50-2EC1-4F24-8DF4-F1EC25D0C7F2">PL/SQL LOB Demonstration Files</a> for a list of demonstration files and links for more information about related LOB APIs
                        </p>
                     </div><pre class="oac_no_warn" dir="ltr">-----------------------------------------------------------------------------
-------------------------  Persistent LOB operations ------------------------
-----------------------------------------------------------------------------

declare
  blob1 BLOB;
  blob2 BLOB;
  clob1 CLOB;
  nclob1 NCLOB;
BEGIN
  SELECT ad_photo INTO blob1 FROM print_media WHERE Product_id = 2268 
        FOR UPDATE;
  SELECT ad_photo INTO blob2 FROM print_media WHERE Product_id = 3106;

  SELECT ad_sourcetext INTO clob1 FROM Print_media
      WHERE product_id=3106 and ad_id=13001 FOR UPDATE;

  SELECT ad_fltextn INTO nclob1 FROM Print_media
      WHERE product_id=3060 and ad_id=11001 FOR UPDATE;

  call_lob_apis(blob1, blob2, clob1, nclob1);
  rollback;
END;
/
show errors;

-----------------------------------------------------------------------------
-------------------------  Temporary LOB operations ------------------------
-----------------------------------------------------------------------------

declare
  blob1 BLOB;
  blob2 BLOB;
  clob1 CLOB;
  nclob1 NCLOB;
BEGIN
  -- create temp LOBs
  DBMS_LOB.CREATETEMPORARY(blob1,TRUE, DBMS_LOB.SESSION);
  DBMS_LOB.CREATETEMPORARY(blob2,TRUE, DBMS_LOB.SESSION);
  DBMS_LOB.CREATETEMPORARY(clob1,TRUE, DBMS_LOB.SESSION);
  DBMS_LOB.CREATETEMPORARY(nclob1,TRUE, DBMS_LOB.SESSION);

  -- fill with data
  writeDataToLOB_proc(blob1);
  writeDataToLOB_proc(blob2);

  -- CHAR-&gt;LOB conversion
  clob1 := 'abcde';
  nclob1 := TO_NCLOB(clob1);

  -- Other APIs
  call_lob_apis(blob1, blob2, clob1, nclob1);

  -- free temp LOBs
  DBMS_LOB.FREETEMPORARY(blob1);
  DBMS_LOB.FREETEMPORARY(blob2);
  DBMS_LOB.FREETEMPORARY(clob1);
  DBMS_LOB.FREETEMPORARY(nclob1);

END;
/
show errors;</pre></div>
                  <!-- class="section" -->
               </div>
            </div><a id="ADLOB45641"></a><div class="props_rev_3"><a id="GUID-20481180-4E23-4693-B1CD-32C2E77EBFBA" name="GUID-20481180-4E23-4693-B1CD-32C2E77EBFBA"></a><h3 id="ADLOB-GUID-20481180-4E23-4693-B1CD-32C2E77EBFBA" class="sect3">Freeing Temporary LOBs in OCI</h3>
               <div>
                  <div class="section">
                     <p>Any time that your OCI program obtains a LOB locator from SQL or PL/SQL, check that the locator is temporary. If it is, free the locator when your application is finished with it. The locator can be from a define during a select or an out bind. A temporary LOB duration is always upgraded to session when it is shipped to the client side. The application must do the following before the locator is overwritten by the locator of the next row:</p><pre class="oac_no_warn" dir="ltr">OCILobIsTemporary(env, err, locator, is_temporary);
if(is_temporary)
    OCILobFreeTemporary(svc, err, locator);
</pre><div class="infoboxnotealso" id="GUID-20481180-4E23-4693-B1CD-32C2E77EBFBA__GUID-203832B6-0E04-4230-9AD0-43A75F46321C">
                        <p class="notep1">See Also:</p>
                        <p><a href="../lnoci/lob-functions.html#LNOCI162" target="_blank"><span class="italic">Oracle Call Interface Programmer's Guide</span></a> chapter 16, section "LOB Functions."
                        </p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
         </div>
      </article>
   </body>
</html>