<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="This chapter describes continuous query notification, publish-subscribe notification, and Database advanced queuing features.">
      <meta name="description" content="This chapter describes continuous query notification, publish-subscribe notification, and Database advanced queuing features.">
      <title>Notification Methods and Database Advanced Queuing</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Programmer's Guide">
      <meta property="og:description" content="This chapter describes continuous query notification, publish-subscribe notification, and Database advanced queuing features.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Programmer's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="oracle-call-interface-programmers-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-01-14T08:46:00-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96204-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="high-availability-in-oci.html" title="Previous" type="text/html">
      <link rel="next" href="user-defined-callback-functions.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Oracle Call Interface Programmer's Guide">
    <meta name="dcterms.isVersionOf" content="LNOCI">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="high-availability-in-oci.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="user-defined-callback-functions.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Programmer's Guide</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Notification Methods and Database Advanced
        Queuing</li>
            </ol>
            <a id="GUID-CB527931-3630-4F31-99ED-1D53C3F7FD90" name="GUID-CB527931-3630-4F31-99ED-1D53C3F7FD90"></a>
            
            <h2 id="LNOCI-GUID-CB527931-3630-4F31-99ED-1D53C3F7FD90" class="sect2"><span class="enumeration_chapter">13 </span>Notification Methods and Database Advanced
        Queuing
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>This chapter describes continuous query notification, publish-subscribe
        notification, and Database advanced queuing features.</p>
               <div class="p">This chapter includes the following topics:
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="notification-streams-advanced-queuing.html#GUID-0D3F60BF-942A-4F50-BD58-7F719BE10529" title="Continuous Query Notification (CQN) enables client applications to register queries with the database and receive notifications in response to DML or DDL changes on the objects or in response to result set changes associated with the queries.">About Continuous Query Notification</a></p>
                     </li>
                     <li>
                        <p><a href="notification-streams-advanced-queuing.html#GUID-9CE58707-FC18-492E-8AA9-5314041BCEE4" title="The publish-subscribe notification feature allows an OCI application to receive client notifications directly, register an email address to which notifications can be sent, register an HTTP URL to which notifications can be posted, or register a PL/SQL procedure to be invoked on a notification.">Publish-Subscribe Notification in OCI</a></p>
                     </li>
                     <li>
                        <p><a href="notification-streams-advanced-queuing.html#GUID-FF4165B2-A44C-4F76-AC26-DA860F340CA8" title="OCI provides an interface to the Database Advanced Queuing (Database AQ) feature. Database Advanced Queuing provides message queuing as an integrated part of Oracle Database.">OCI and Database Advanced Queuing</a></p>
                     </li>
                  </ul>
               </div>
            </div>
            <div class="sect2"><a id="GUID-0D3F60BF-942A-4F50-BD58-7F719BE10529" name="GUID-0D3F60BF-942A-4F50-BD58-7F719BE10529"></a><h3 id="LNOCI-GUID-0D3F60BF-942A-4F50-BD58-7F719BE10529" class="sect3"><span class="enumeration_section">13.1 </span>About Continuous Query Notification
               </h3>
               <div>
                  <p>Continuous Query Notification (CQN) enables client applications to register queries with the database and receive notifications in response to DML or DDL changes on the objects or in response to result set changes associated with the queries.</p>
                  <p>The notifications are published by the database when the DML or DDL transaction commits.</p>
                  <p>During registration, the application specifies a notification handler and associates a set of interesting queries with the notification handler. A notification handler can be either a server-side PL/SQL procedure or a client-side C callback. Registrations are created at either the object level or the query level. If registration is at the object level, then whenever a transaction changes any of the registered objects and commits, the notification handler is invoked. If registration is at the query level, then whenever a transaction commits changes such that the result set of the query is modified, the notification handler is invoked, but if the changes do not affect the result set of the query, the notification handler is not invoked.</p>
                  <p>Query change notification can be registered for the following types of statements: <code class="codeph">OCI_STMT_SELECT</code>, <code class="codeph">OCI_STMT_BEGIN</code>, <code class="codeph">OCI_STMT_DECLARE</code>, and <code class="codeph">OCI_STMT_CALL</code>.
                  </p>
                  <p>Query change notification assumes that the PLSQL code performs only <code class="codeph">SELECT</code> statements and registers for every <code class="codeph">SELECT</code> statement. Otherwise, it raises an error if there are any non SELECT statements in the PLSQL code.
                  </p>
                  <p>One use of continuous query notification is in middle-tier applications that must have cached data and keep the cache as recent as possible for the back-end database.</p>
                  <p>The notification includes the following information:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Query IDs of queries whose result sets have changed. This is if the registration was at query granularity.</p>
                     </li>
                     <li>
                        <p>Names of the modified objects or changed rows.</p>
                     </li>
                     <li>
                        <p>Operation type (<code class="codeph">INSERT</code>, <code class="codeph">UPDATE</code>, <code class="codeph">DELETE</code>, <code class="codeph">ALTER</code> <code class="codeph">TABLE</code>, <code class="codeph">DROP</code> <code class="codeph">TABLE</code>).
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">ROWID</code>s of the changed rows and the associated DML operation (<code class="codeph">INSERT</code>, <code class="codeph">UPDATE</code>, <code class="codeph">DELETE</code>).
                        </p>
                     </li>
                     <li>
                        <p>Global database events (<code class="codeph">STARTUP</code>, <code class="codeph">SHUTDOWN</code>). In Oracle Real Application Cluster (Oracle RAC) the database delivers a notification when the first instance starts or the last instance shuts down.
                        </p>
                     </li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-0D3F60BF-942A-4F50-BD58-7F719BE10529__GUID-D148FB06-37BA-4030-86FA-F7D719B3AC7F">
                     <p class="notep1">See Also:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="../adfns/cqn.html#ADFNS018" target="_blank"><span><cite>Oracle Database Development Guide</cite></span></a>, the section about using continuous query notification for a complete discussion of the concepts of this feature and using OCI and PL/SQL interfaces to create CQN registrations
                           </p>
                        </li>
                        <li>
                           <p><a href="notification-streams-advanced-queuing.html#GUID-9CE58707-FC18-492E-8AA9-5314041BCEE4" title="The publish-subscribe notification feature allows an OCI application to receive client notifications directly, register an email address to which notifications can be sent, register an HTTP URL to which notifications can be posted, or register a PL/SQL procedure to be invoked on a notification.">Publish-Subscribe Notification in OCI</a></p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div>
            <div class="props_rev_3"><a id="GUID-9CE58707-FC18-492E-8AA9-5314041BCEE4" name="GUID-9CE58707-FC18-492E-8AA9-5314041BCEE4"></a><h3 id="LNOCI-GUID-9CE58707-FC18-492E-8AA9-5314041BCEE4" class="sect3"><span class="enumeration_section">13.2 </span>Publish-Subscribe Notification in OCI
               </h3>
               <div>
                  <p>The publish-subscribe notification feature allows an OCI application to receive client notifications directly, register an email address to which notifications can be sent, register an HTTP URL to which notifications can be posted, or register a PL/SQL procedure to be invoked on a notification. </p>
                  <p><a href="notification-streams-advanced-queuing.html#GUID-9CE58707-FC18-492E-8AA9-5314041BCEE4__I457371">Figure 13-1</a> illustrates the process. 
                  </p>
                  <div class="figure" id="GUID-9CE58707-FC18-492E-8AA9-5314041BCEE4__I457371">
                     <p class="titleinfigure">Figure 13-1 Publish-Subscribe Model</p><img src="img/lnoci039.gif" alt="Description of Figure 13-1 follows" title="Description of Figure 13-1 follows" longdesc="img_text/lnoci039.html"><br><a href="img_text/lnoci039.html">Description of "Figure 13-1 Publish-Subscribe Model"</a></div>
                  <!-- class="figure" -->
                  <p>An OCI application can:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Register interest in notifications in the AQ namespace and be notified when an enqueue occurs</p>
                     </li>
                     <li>
                        <p>Register interest in subscriptions to database events and receive notifications when the events are triggered </p>
                     </li>
                     <li>
                        <p>Manage registrations, such as disabling registrations temporarily or dropping the registrations entirely</p>
                     </li>
                     <li>
                        <p>Post or send notifications to registered clients</p>
                     </li>
                  </ul>
                  <p>In all the preceding scenarios the notification can be received directly by the OCI application, or the notification can be sent to a prespecified email address, or it can be sent to a predefined HTTP URL, or a prespecified database PL/SQL procedure can be invoked because of a notification.</p>
                  <p>Registered clients are notified asynchronously when events are triggered or on an explicit AQ enqueue. Clients do not need to be connected to a database.</p>
                  <div class="p">This section includes the following topics:
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="notification-streams-advanced-queuing.html#GUID-1E9445D7-DFD9-4230-BFFD-EF3630691ECE" title="You can register directly to the database or register using Lightweight Directory Access Protocol (LDAP).">Publish-Subscribe Registration Functions in OCI</a></p>
                        </li>
                        <li>
                           <p><a href="notification-streams-advanced-queuing.html#GUID-6A21E98D-4921-4087-A79A-7B7C8C22ABD5" title="The client must register a notification callback that gets invoked when there is some activity on the subscription for which interest has been registered.">Notification Callback in OCI</a></p>
                        </li>
                        <li>
                           <p><a href="notification-streams-advanced-queuing.html#GUID-078F3FD1-7CAA-45FC-A93F-1CE942D27CA0" title="The PL/SQL notification procedure that is invoked when there is some activity on the subscription for which interest has been registered, must be created in the database.">Notification Procedure</a></p>
                        </li>
                        <li>
                           <p><a href="notification-streams-advanced-queuing.html#GUID-909E21A8-A247-4E54-9069-79B3EF219D2F" title="Shows examples implementing publish subscription notification using direct registration.">Publish-Subscribe Direct Registration Example</a></p>
                        </li>
                        <li>
                           <p><a href="notification-streams-advanced-queuing.html#GUID-9F4EEC78-5CAC-4E86-9F82-1FF9586289CF" title="Shows an example that illustrates how to do LDAP registration.">Publish-Subscribe LDAP Registration Example</a></p>
                        </li>
                     </ul>
                  </div>
                  <div class="infoboxnotealso" id="GUID-9CE58707-FC18-492E-8AA9-5314041BCEE4__GUID-642616AE-C0DB-4BAE-B1C3-C044AC88CDDA">
                     <p class="notep1">See Also:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="notification-streams-advanced-queuing.html#GUID-FF4165B2-A44C-4F76-AC26-DA860F340CA8" title="OCI provides an interface to the Database Advanced Queuing (Database AQ) feature. Database Advanced Queuing provides message queuing as an integrated part of Oracle Database.">OCI and Database Advanced Queuing</a> for information about Database Advanced
                        Queuing
                           </p>
                        </li>
                        <li>
                           <p><a href="../adque/aq-introduction.html#ADQUE0100" target="_blank"><span><cite>Oracle Database Advanced Queuing User's Guide</cite></span></a> for information about creating
                        queues and about Database AQ, including concepts, features, and examples
                           </p>
                        </li>
                        <li>
                           <p>The chapter about <code class="codeph">CREATE</code> <code class="codeph">TRIGGER</code> in the <a href="../sqlrf/CREATE-TRIGGER.html#SQLRF01405" target="_blank"><span><cite>Oracle Database SQL Language Reference</cite></span></a> for information about creating triggers
                           </p>
                        </li>
                     </ul>
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-1E9445D7-DFD9-4230-BFFD-EF3630691ECE" name="GUID-1E9445D7-DFD9-4230-BFFD-EF3630691ECE"></a><h4 id="LNOCI-GUID-1E9445D7-DFD9-4230-BFFD-EF3630691ECE" class="sect4"><span class="enumeration_section">13.2.1 </span>Publish-Subscribe Registration Functions in OCI
                  </h4>
                  <div>
                     <p>You can register directly to the database or register using Lightweight Directory Access Protocol (LDAP).</p>
                     <p>Registration can be done in two ways:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Direct registration. You register directly to the database. This way is simple and the registration takes effect immediately.</p>
                        </li>
                        <li>
                           <p>Open registration. You register using Lightweight Directory Access Protocol (LDAP), from which the database receives the registration request. This is useful when the client cannot have a database connection (the client wants to register for a database open event while the database is down), or if the client wants to register for the same event or events in multiple databases simultaneously. </p>
                        </li>
                     </ul>
                     <div class="p">This section includes the following topics:
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="notification-streams-advanced-queuing.html#GUID-4D013BA8-B824-45FB-A54A-21FF42B256F4" title="The following steps are required in an OCI application to register directly and receive notifications for events.">Publish-Subscribe Register Directly to the Database</a></p>
                           </li>
                           <li>
                              <p><a href="notification-streams-advanced-queuing.html#GUID-5C733061-A0B7-4852-B0B6-A013CB0D7739" title="Lists the prerequisites for the open registration for publish-subscribe.">Open Registration for Publish-Subscribe</a></p>
                           </li>
                           <li>
                              <p><a href="notification-streams-advanced-queuing.html#GUID-C7ED46E0-43C2-41A3-B89E-8F05DF0C4CC8" title="Shows how to open register using LDAP registration.">Using OCI to Open Register with LDAP</a></p>
                           </li>
                           <li>
                              <p><a href="notification-streams-advanced-queuing.html#GUID-00B6E34B-201C-4C6E-B188-238FE58836D8" title="Shows how to set QOSFLAGS to QOS levels using OCIAttrSet().">Setting QOS, Timeout Interval, Namespace, Client Address, and Port Number</a></p>
                           </li>
                           <li>
                              <p><a href="notification-streams-advanced-queuing.html#GUID-362BE190-510B-4187-A93E-C4538E2C8A24" title="Lists and describes the functions used to manage publish-subscribe notification.">OCI Functions Used to Manage Publish-Subscribe Notification</a></p>
                           </li>
                        </ul>
                     </div>
                     <div class="infoboxnotealso" id="GUID-1E9445D7-DFD9-4230-BFFD-EF3630691ECE__GUID-812E3D19-0E2E-4109-B196-4E99F51B045C">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="notification-streams-advanced-queuing.html#GUID-4D013BA8-B824-45FB-A54A-21FF42B256F4" title="The following steps are required in an OCI application to register directly and receive notifications for events.">Publish-Subscribe Register Directly to the Database</a></p>
                           </li>
                           <li>
                              <p><a href="notification-streams-advanced-queuing.html#GUID-5C733061-A0B7-4852-B0B6-A013CB0D7739" title="Lists the prerequisites for the open registration for publish-subscribe.">Open Registration for Publish-Subscribe</a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <div class="props_rev_3"><a id="GUID-4D013BA8-B824-45FB-A54A-21FF42B256F4" name="GUID-4D013BA8-B824-45FB-A54A-21FF42B256F4"></a><h5 id="LNOCI-GUID-4D013BA8-B824-45FB-A54A-21FF42B256F4" class="sect5"><span class="enumeration_section">13.2.1.1 </span>Publish-Subscribe Register Directly to the Database
                     </h5>
                     <div>
                        <p>The following steps are required in an OCI application to register directly and receive notifications for events.</p>
                        <p>It is assumed that the appropriate event trigger or AQ queue has been set up. The initialization parameter <code class="codeph">COMPATIBLE</code> must be set to 8.1 or later.<span class="bold"></span> 
                        </p>
                        <div class="infoboxnotealso" id="GUID-4D013BA8-B824-45FB-A54A-21FF42B256F4__GUID-E124B95D-80B5-4B3D-A8DF-F1FCD904ADBA">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><a href="streams-advanced-queueing-and-publish-subscribe-functions.html#GUID-4D7FFF56-38DE-4DBF-80E8-48BF19C2B2D3" title="Lists and describes the Database Advanced Queuing and publish-subscribe functions.">Database Advanced Queuing and Publish-Subscribe Functions</a></p>
                              </li>
                              <li>
                                 <p><a href="notification-streams-advanced-queuing.html#GUID-909E21A8-A247-4E54-9069-79B3EF219D2F" title="Shows examples implementing publish subscription notification using direct registration.">Publish-Subscribe Direct Registration Example</a> for examples of the use of these functions in an application 
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <div class="infoboxnote" id="GUID-4D013BA8-B824-45FB-A54A-21FF42B256F4__GUID-45D4D6C0-A953-4C66-8CA5-EA237EB1A50B">
                           <p class="notep1">Note:</p>
                           <p>The publish-subscribe feature is only available on multithreaded operating systems.</p>
                        </div>
                        <ol>
                           <li>
                              <p>Call <code class="codeph">OCIEnvCreate()</code> or <code class="codeph">OCIEnvNlsCreate()</code> with <code class="codeph">OCI_EVENTS</code> mode to specify that the application is interested in registering for and receiving notifications. This starts a dedicated listening thread for notifications on the client.
                              </p>
                           </li>
                           <li>
                              <p>Call <code class="codeph">OCIHandleAlloc()</code> with handle type <code class="codeph">OCI_HTYPE_SUBSCRIPTION</code> to allocate a subscription handle.
                              </p>
                           </li>
                           <li>
                              <p>Call <code class="codeph">OCIAttrSet()</code> to set the subscription handle attributes for:
                              </p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p><code class="codeph">OCI_ATTR_SUBSCR_NAME</code> - Subscription name
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">OCI_ATTR_SUBSCR_NAMESPACE</code> - Subscription namespace
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">OCI_ATTR_SUBSCR_HOSTADDR</code> - Environment handle attribute that sets the client IP (in either IPv4 or IPv6 format) to which notification is sent
                                    </p>
                                    <p>Oracle Database components and utilities support Internet Protocol version 6 (IPv6) addresses.</p>
                                    <div class="infoboxnotealso" id="GUID-4D013BA8-B824-45FB-A54A-21FF42B256F4__GUID-BC89470B-7AD1-4462-8D55-38CD92C761E4">
                                       <p class="notep1">See Also:</p>
                                       <p><a href="handle-and-descriptor-attributes.html#GUID-A76BBB38-8F77-40B8-B5A6-1F9C9166C71C__BAJDBBIC">OCI_ATTR_SUBSCR_HOSTADDR</a>, <a href="handle-and-descriptor-attributes.html#GUID-A76BBB38-8F77-40B8-B5A6-1F9C9166C71C__BAJHEBIA">OCI_ATTR_SUBSCR_IPADDR</a>, and <a href="../netag/understanding-communication-layers.html#NETAG1453" target="_blank"><span><cite>Oracle Database Net Services Administrator's Guide</cite></span></a> for more information about the IPv6 format for IP addresses
                                       </p>
                                    </div>
                                 </li>
                                 <li>
                                    <p><code class="codeph">OCI_ATTR_SUBSCR_CALLBACK</code> - Notification callback
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">OCI_ATTR_SUBSCR_CTX</code> - Callback context
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">OCI_ATTR_SUBSCR_PAYLOAD</code> - Payload buffer for posting
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">OCI_ATTR_SUBSCR_RECPT</code> - Recipient name
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">OCI_ATTR_SUBSCR_RECPTPROTO</code> - Protocol to receive notification with
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">OCI_ATTR_SUBSCR_RECPTPRES</code> - Presentation to receive notification with
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">OCI_ATTR_SUBSCR_QOSFLAGS</code> - QOS (quality of service) levels with the following values:
                                    </p>
                                    <ul style="list-style-type: disc;">
                                       <li>
                                          <p>If <code class="codeph">OCI_SUBSCR_QOS_PURGE_ON_NTFN</code> is set, the registration is purged on the first notification.
                                          </p>
                                       </li>
                                       <li>
                                          <p>If <code class="codeph">OCI_SUBSCR_QOS_RELIABLE</code> is set, notifications are persistent. You can use surviving instances of an Oracle RAC database to send and retrieve change notification messages even after a node failure, because invalidations associated with this registration are queued persistently into the database. If <code class="codeph">FALSE</code>, then invalidations are enqueued into a fast in-memory queue. Note that this option describes the persistence of notifications and not the persistence of registrations. Registrations are automatically persistent by default.
                                          </p>
                                       </li>
                                    </ul>
                                 </li>
                                 <li>
                                    <p><code class="codeph">OCI_ATTR_SUBSCR_TIMEOUT</code> - Registration timeout interval in seconds. The default is 0 if a timeout is not set.
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">OCI_ATTR_SUBSCR_NTFN_GROUPING_CLASS</code> - notification grouping class
                                    </p>
                                    <p>Notifications can be spaced out by using the grouping NTFN option with the following constants. A value supported for notification grouping class is:</p><pre class="oac_no_warn" dir="ltr">#define OCI_SUBSCR_NTFN_GROUPING_CLASS_TIME   1 /* time  */
</pre></li>
                                 <li>
                                    <p><code class="codeph">OCI_ATTR_SUBSCR_NTFN_GROUPING_VALUE</code> - notification grouping value in seconds
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">OCI_ATTR_SUBSCR_NTFN_GROUPING_TYPE</code> - notification grouping type
                                    </p>
                                    <p>Supported values for notification grouping type:</p><pre class="oac_no_warn" dir="ltr">#define OCI_SUBSCR_NTFN_GROUPING_TYPE_SUMMARY 1  /* summary */
#define OCI_SUBSCR_NTFN_GROUPING_TYPE_LAST    2  /* last */ 
</pre></li>
                                 <li>
                                    <p><code class="codeph">OCI_ATTR_SUBSCR_NTFN_GROUPING_START_TIME</code> - notification grouping start time
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">OCI_ATTR_SUBSCR_NTFN_GROUPING_REPEAT_COUNT</code> - notification grouping repeat count
                                    </p>
                                 </li>
                              </ul>
                              <p><code class="codeph">OCI_ATTR_SUBSCR_NAME</code>, <code class="codeph">OCI_ATTR_SUBSCR_NAMESPACE</code>, and <code class="codeph">OCI_ATTR_SUBSCR_RECPTPROTO</code> must be set before you register a subscription.
                              </p>
                              <p>If <code class="codeph">OCI_ATTR_SUBSCR_RECPTPROTO</code> is set to <code class="codeph">OCI_SUBSCR_PROTO_OCI</code>, then <code class="codeph">OCI_ATTR_SUBSCR_CALLBACK</code> and <code class="codeph">OCI_ATTR_SUBSCR_CTX</code> also must be set.
                              </p>
                              <p>If <code class="codeph">OCI_ATTR_SUBSCR_RECPTPROTO</code> is set to <code class="codeph">OCI_SUBSCR_PROTO_MAIL</code>, <code class="codeph">OCI_SUBSCR_PROTO_SERVER</code>, or <code class="codeph">OCI_SUBSCR_PROTO_HTTP</code>, then <code class="codeph">OCI_ATTR_SUBSCR_RECPT</code> also must be set.
                              </p>
                              <p>Setting <code class="codeph">OCI_ATTR_SUBSCR_CALLBACK</code> and <code class="codeph">OCI_ATTR_SUBSCR_RECPT</code> at the same time causes an application error.
                              </p>
                              <p><code class="codeph">OCI_ATTR_SUBSCR_PAYLOAD</code> is required before the application can perform a post to a subscription. 
                              </p>
                              <div class="infoboxnotealso" id="GUID-4D013BA8-B824-45FB-A54A-21FF42B256F4__GUID-5A5F0DBF-D62E-4D29-A8DB-93647C6DAD07">
                                 <p class="notep1">See Also:</p>
                                 <p><a href="handle-and-descriptor-attributes.html#GUID-A76BBB38-8F77-40B8-B5A6-1F9C9166C71C" title="Lists and describes subscription handle attributes.">Subscription Handle Attributes</a> and <a href="oci-programming-basics.html#GUID-083E4689-0B45-4120-9FBD-3E5FE6BB1589" title="Each OCI function call is executed in the context of an environment that is created with the OCIEnvCreate() call.">About Creating the OCI Environment</a> for setting up the environment with <code class="codeph">mode = OCI_EVENTS | OCI_OBJECT</code>. <code class="codeph">OCI_OBJECT</code> is required for grouping notifications.
                                 </p>
                              </div>
                           </li>
                           <li>
                              <p>Set he values of QOS, timeout interval, namespace, and port (see Example&nbsp;9&#x2013;15).</p>
                              <div class="infoboxnotealso" id="GUID-4D013BA8-B824-45FB-A54A-21FF42B256F4__GUID-F192A4D3-36E4-4D17-8FCD-64649859E6C5">
                                 <p class="notep1">See Also:</p>
                                 <p><a href="notification-streams-advanced-queuing.html#GUID-00B6E34B-201C-4C6E-B188-238FE58836D8" title="Shows how to set QOSFLAGS to QOS levels using OCIAttrSet().">Setting QOS, Timeout Interval, Namespace, Client Address, and Port Number</a></p>
                              </div>
                           </li>
                           <li>
                              <p>Set <code class="codeph">OCI_ATTR_SUBSCR_RECPTPROTO</code> to <code class="codeph">OCI_SUBSCR_PROTO_OCI</code>, then define the callback routine to be used with the subscription handle. 
                              </p>
                              <div class="infoboxnotealso" id="GUID-4D013BA8-B824-45FB-A54A-21FF42B256F4__GUID-F81E772A-37B5-4E60-A900-824F5D590A14">
                                 <p class="notep1">See Also:</p>
                                 <p><a href="notification-streams-advanced-queuing.html#GUID-6A21E98D-4921-4087-A79A-7B7C8C22ABD5" title="The client must register a notification callback that gets invoked when there is some activity on the subscription for which interest has been registered.">Notification Callback in OCI</a></p>
                              </div>
                           </li>
                           <li>
                              <p>Set <code class="codeph">OCI_ATTR_SUBSCR_RECPTPROTO</code> to <code class="codeph">OCI_SUBSCR_PROTO_SERVER</code>, then define the PL/SQL procedure, to be invoked on notification, in the database.
                              </p>
                              <div class="infoboxnotealso" id="GUID-4D013BA8-B824-45FB-A54A-21FF42B256F4__GUID-FEE7B581-AEAF-4671-A201-67C6ABC65D93">
                                 <p class="notep1">See Also:</p>
                                 <p><a href="notification-streams-advanced-queuing.html#GUID-078F3FD1-7CAA-45FC-A93F-1CE942D27CA0" title="The PL/SQL notification procedure that is invoked when there is some activity on the subscription for which interest has been registered, must be created in the database.">Notification Procedure</a></p>
                              </div>
                           </li>
                           <li>
                              <p>Call <code class="codeph">OCISubscriptionRegister()</code> to register with the subscriptions. This call can register interest in several subscriptions at the same time.
                              </p>
                           </li>
                        </ol>
                        <p><a href="notification-streams-advanced-queuing.html#GUID-4D013BA8-B824-45FB-A54A-21FF42B256F4__CACFFAEH">Example 13-1</a> shows an example of setting QOS levels.
                        </p>
                        <div class="example" id="GUID-4D013BA8-B824-45FB-A54A-21FF42B256F4__CACFFAEH">
                           <p class="titleinexample">Example 13-1 Setting QOS Levels, the Notification Grouping Class, Value, and Type, and the Namespace Specific Context</p><pre class="oac_no_warn" dir="ltr">/* Set QOS levels */
ub4 qosflags = OCI_SUBSCR_QOS_PAYLOAD;
 
/* Set QOS flags in subscription handle */
(void) OCIAttrSet((dvoid *) subscrhp, (ub4) OCI_HTYPE_SUBSCRIPTION,
                 (dvoid *) &amp;qosflags, (ub4) 0,
                 (ub4) OCI_ATTR_SUBSCR_QOSFLAGS, errhp);
 
/* Set notification grouping class */
ub4 ntfn_grouping_class = OCI_SUBSCR_NTFN_GROUPING_CLASS_TIME;
(void) OCIAttrSet((dvoid *) subscrhp, (ub4) OCI_HTYPE_SUBSCRIPTION,
                 (dvoid *) &amp;ntfn_grouping_class, (ub4) 0,
                 (ub4) OCI_ATTR_SUBSCR_NTFN_GROUPING_CLASS, errhp);
 
/* Set notification grouping value of 10 minutes */
ub4 ntfn_grouping_value = 600;
(void) OCIAttrSet((dvoid *) subscrhp, (ub4) OCI_HTYPE_SUBSCRIPTION,
                 (dvoid *) &amp;ntfn_grouping_value, (ub4) 0,
                 (ub4) OCI_ATTR_SUBSCR_NTFN_GROUPING_VALUE, errhp);
 
/* Set notification grouping type */
ub4 ntfn_grouping_type = OCI_SUBSCR_NTFN_GROUPING_TYPE_SUMMARY;
 
/* Set notification grouping type in subscription handle */
(void) OCIAttrSet((dvoid *) subscrhp, (ub4) OCI_HTYPE_SUBSCRIPTION,
                 (dvoid *) &amp;ntfn_grouping_type, (ub4) 0,
                 (ub4) OCI_ATTR_SUBSCR_NTFN_GROUPING_TYPE, errhp);
 
/* Set namespace specific context */
(void) OCIAttrSet((dvoid *) subscrhp, (ub4) OCI_HTYPE_SUBSCRIPTION,
                 (dvoid *) NULL, (ub4) 0,
                 (ub4) OCI_ATTR_SUBSCR_NAMESPACE_CTX, errhp);
</pre></div>
                        <!-- class="example" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-4D013BA8-B824-45FB-A54A-21FF42B256F4__GUID-670B69C2-F7D9-4347-9D6E-A532A2292BE7"></p>
                           <div class="infoboxnotealso" id="GUID-4D013BA8-B824-45FB-A54A-21FF42B256F4__GUID-837FCDA2-710B-4A69-8107-A7968A674D14">
                              <p class="notep1">See Also:</p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p><a href="connect-authorize-and-initialize-functions.html#GUID-16BDA1F1-7DAF-41CA-9EE1-C9A4CB467244" title="Creates and initializes an environment handle for OCI functions to work under.">OCIEnvCreate()</a></p>
                                 </li>
                                 <li>
                                    <p><a href="connect-authorize-and-initialize-functions.html#GUID-0B6911A9-4B46-476C-BC5E-B87581666CD9" title="Creates and initializes an environment handle for OCI functions to work under.">OCIEnvNlsCreate()</a></p>
                                 </li>
                                 <li>
                                    <p><a href="handle-and-descriptor-functions.html#GUID-C5BF55F7-A110-4CB5-9663-5056590F12B5" title="Returns a pointer to an allocated and initialized handle.">OCIHandleAlloc()</a></p>
                                 </li>
                                 <li>
                                    <p><a href="handle-and-descriptor-functions.html#GUID-3741D7BD-7652-4D7A-8813-AC2AEA8D3B03" title="Sets the value of an attribute of a handle or a descriptor.">OCIAttrSet()</a></p>
                                 </li>
                                 <li>
                                    <p><a href="streams-advanced-queueing-and-publish-subscribe-functions.html#GUID-36729D3E-E920-4FAA-8EAA-6E033F6D8930" title="Registers a callback for message notification.">OCISubscriptionRegister()</a></p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
                  <div class="props_rev_3"><a id="GUID-5C733061-A0B7-4852-B0B6-A013CB0D7739" name="GUID-5C733061-A0B7-4852-B0B6-A013CB0D7739"></a><h5 id="LNOCI-GUID-5C733061-A0B7-4852-B0B6-A013CB0D7739" class="sect5"><span class="enumeration_section">13.2.1.2 </span>Open Registration for Publish-Subscribe
                     </h5>
                     <div>
                        <p>Lists the prerequisites for the open registration for publish-subscribe.</p>
                        <div class="section">
                           <p>Prerequisites for the open registration for publish-subscribe are as follows:</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>Registering using LDAP (open registration) requires the client to be an enterprise user.</p>
                                 <div class="infoboxnotealso" id="GUID-5C733061-A0B7-4852-B0B6-A013CB0D7739__GUID-03CE6BDB-B81B-4DA1-ADE4-24A63D764BF0">
                                    <p class="notep1">See Also:</p>
                                    <p> <a href="../dbimi/introducing-enterprise-user-security.html#DBIMI152" target="_blank"><span><cite>Oracle Database Enterprise User Security Administrator's Guide</cite></span></a>, sections about managing enterprise user security 
                                    </p>
                                 </div>
                              </li>
                           </ul>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p> The compatibility of the database must be 9.0 or later. </p>
                              </li>
                              <li>
                                 <p><code class="codeph">LDAP_REGISTRATION_ENABLED</code> must be set to <code class="codeph">TRUE</code>. This can be done this way:
                                 </p><pre class="oac_no_warn" dir="ltr"> ALTER SYSTEM SET LDAP_REGISTRATION_ENABLED=TRUE
</pre><p>The default is <code class="codeph">FALSE</code>.
                                 </p>
                              </li>
                              <li>
                                 <p> <code class="codeph">LDAP_REG_SYNC_INTERVAL</code> must be set to the time interval (in seconds) to refresh registrations from LDAP:
                                 </p><pre class="oac_no_warn" dir="ltr"> ALTER SYSTEM SET LDAP_REG_SYNC_INTERVAL =  time_interval
</pre><p> The default is 0, which means do not refresh.</p>
                              </li>
                              <li>
                                 <p>To force a database refresh of LDAP registration information immediately:</p><pre class="oac_no_warn" dir="ltr">ALTER SYSTEM REFRESH LDAP_REGISTRATION
</pre></li>
                           </ul>
                           <p>The steps for open registration using Oracle Enterprise Security Manager (OESM) are:</p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li><span>In each enterprise domain, create the enterprise role, <code class="codeph">ENTERPRISE_AQ_USER_ROLE</code>.</span></li>
                           <li><span>For each database in the enterprise domain, add the global role       <code class="codeph">GLOBAL_AQ_USER_ROLE</code> to the enterprise role <code class="codeph">ENTERPRISE_AQ_USER_ROLE</code>.</span></li>
                           <li><span>For each enterprise domain, add the enterprise role <code class="codeph">ENTERPRISE_AQ_USER_ROLE</code> to the privilege group <code class="codeph">cn=OracleDBAQUsers</code>, under <code class="codeph">cn=oraclecontext</code>, under the administrative context.</span></li>
                           <li><span>For each enterprise user that is authorized to register for events in the database, grant the enterprise role <code class="codeph">ENTERPRISE_AQ_USER_ROLE</code>.</span></li>
                        </ol>
                     </div>
                  </div>
                  <div class="props_rev_3"><a id="GUID-C7ED46E0-43C2-41A3-B89E-8F05DF0C4CC8" name="GUID-C7ED46E0-43C2-41A3-B89E-8F05DF0C4CC8"></a><h5 id="LNOCI-GUID-C7ED46E0-43C2-41A3-B89E-8F05DF0C4CC8" class="sect5"><span class="enumeration_section">13.2.1.3 </span>Using OCI to Open Register with LDAP
                     </h5>
                     <div>
                        <p>Shows how to open register using LDAP registration.</p>
                        <ol>
                           <li class="stepexpand"><span>Call <code class="codeph">OCIEnvCreate()</code> or <code class="codeph">OCIEnvNlsCreate()</code> with <code class="codeph">mode</code> set to <code class="codeph">OCI_EVENTS</code> | <code class="codeph">OCI_USE_LDAP</code>.</span></li>
                           <li class="stepexpand"><span>Call <code class="codeph">OCIAttrSet()</code> to set the following environment handle attributes for accessing LDAP:</span><div>
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p><code class="codeph">OCI_ATTR_LDAP_HOST</code>: the host name on which the LDAP server resides
                                       </p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">OCI_ATTR_LDAP_PORT</code>: the port on which the LDAP server is listening
                                       </p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">OCI_ATTR_BIND_DN</code>: the distinguished name to log in to the LDAP server,        usually the DN of the enterprise user
                                       </p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">OCI_ATTR_LDAP_CRED</code>: the credential used to authenticate the client, for example, the password for simple authentication (user name and password)
                                       </p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">OCI_ATTR_WALL_LOC</code>: for SSL authentication, the location of the client wallet
                                       </p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">OCI_ATTR_LDAP_AUTH</code>: the authentication method code
                                       </p>
                                       <div class="infoboxnotealso" id="GUID-C7ED46E0-43C2-41A3-B89E-8F05DF0C4CC8__GUID-8CC7F3BA-DA0A-46D7-AECD-3BF1ABCD839B">
                                          <p class="notep1">See Also:</p>
                                          <p><a href="handle-and-descriptor-attributes.html#GUID-9CA5026C-B6A0-4233-8B22-F1DD94ACE9F8" title="Lists and describes environment handle attributes.">Environment Handle Attributes</a> for a complete list of authentication modes
                                          </p>
                                       </div>
                                    </li>
                                    <li>
                                       <p><code class="codeph">OCI_ATTR_LDAP_CTX</code>: the administrative context for Oracle Database in the LDAP server
                                       </p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li class="stepexpand"><span>Call <code class="codeph">OCIHandleAlloc()</code> with handle type <code class="codeph">OCI_HTYPE_SUBSCRIPTION</code>, to allocate a subscription handle.</span></li>
                           <li class="stepexpand"><span>Call <code class="codeph">OCIArrayDescriptorAlloc()</code> with descriptor type <code class="codeph">OCI_DTYPE_SRVDN</code>, to allocate a server DN descriptor.</span></li>
                           <li class="stepexpand"><span>Call <code class="codeph">OCIAttrSet()</code>to set the server DN descriptor attributes for <code class="codeph">OCI_ATTR_SERVER_DN</code>, the distinguished name of the database in which the       client wants to receive notifications. <code class="codeph">OCIAttrSet()</code> can be called multiple       times for this attribute so that more than one database server is included in the registration.</span></li>
                           <li class="stepexpand"><span>Call <code class="codeph">OCIAttrSet()</code> to set the subscription handle attributes for:</span><div>
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p><code class="codeph">OCI_ATTR_SUBSCR_NAME</code> - Subscription name
                                       </p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">OCI_ATTR_SUBSCR_NAMESPACE</code> - Subscription namespace
                                       </p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">OCI_ATTR_SUBSCR_CALLBACK</code>- Notification callback
                                       </p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">OCI_ATTR_SUBSCR_CTX</code> - Callback context
                                       </p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">OCI_ATTR_SUBSCR_PAYLOAD</code> - Payload buffer for posting
                                       </p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">OCI_ATTR_SUBSCR_RECPT</code> - Recipient name
                                       </p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">OCI_ATTR_SUBSCR_RECPTPROTO</code> - Protocol to receive notification with
                                       </p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">OCI_ATTR_SUBSCR_RECPTRES</code> - Presentation to receive notification with
                                       </p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">OCI_ATTR_SUBSCR_QOSFLAGS</code> - QOS (quality of service) levels
                                       </p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">OCI_ATTR_SUBSCR_TIMEOUT</code> - Registration timeout interval in seconds. The default is 0 if a timeout is not set.
                                       </p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">OCI_ATTR_SUBSCR_SERVER_DN</code> - The descriptor handles you populated in Step 5
                                       </p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li class="stepexpand"><span>The values of QOS, timeout interval, namespace, and port are set. See <a href="notification-streams-advanced-queuing.html#GUID-00B6E34B-201C-4C6E-B188-238FE58836D8" title="Shows how to set QOSFLAGS to QOS levels using OCIAttrSet().">Setting QOS, Timeout Interval, Namespace, Client Address, and Port Number</a>.</span></li>
                           <li class="stepexpand"><span>Call <code class="codeph">OCISubscriptionRegister()</code> to register the subscriptions. The registration takes effect when the database accesses LDAP to pick up new registrations. The frequency of pickups is determined by the value of <code class="codeph">LDAP_REG_SYNC_INTERVAL</code>.</span></li>
                        </ol>
                        <div class="section">
                           <div class="infoboxnotealso" id="GUID-C7ED46E0-43C2-41A3-B89E-8F05DF0C4CC8__GUID-8B491AC7-B5A8-4E63-B8C7-FFAAF266A59C">
                              <p class="notep1">See Also:</p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p><a href="connect-authorize-and-initialize-functions.html#GUID-16BDA1F1-7DAF-41CA-9EE1-C9A4CB467244" title="Creates and initializes an environment handle for OCI functions to work under.">OCIEnvCreate()</a></p>
                                 </li>
                                 <li>
                                    <p><a href="connect-authorize-and-initialize-functions.html#GUID-0B6911A9-4B46-476C-BC5E-B87581666CD9" title="Creates and initializes an environment handle for OCI functions to work under.">OCIEnvNlsCreate()</a></p>
                                 </li>
                                 <li>
                                    <p><a href="handle-and-descriptor-functions.html#GUID-3741D7BD-7652-4D7A-8813-AC2AEA8D3B03" title="Sets the value of an attribute of a handle or a descriptor.">OCIAttrSet()</a></p>
                                 </li>
                                 <li>
                                    <p><a href="handle-and-descriptor-functions.html#GUID-C5BF55F7-A110-4CB5-9663-5056590F12B5" title="Returns a pointer to an allocated and initialized handle.">OCIHandleAlloc()</a></p>
                                 </li>
                                 <li>
                                    <p><a href="handle-and-descriptor-functions.html#GUID-8218D5F2-139B-4FA9-BA4A-ED0126687C0F" title="Allocates an array of descriptors.">OCIArrayDescriptorAlloc()</a></p>
                                 </li>
                                 <li>
                                    <p><a href="streams-advanced-queueing-and-publish-subscribe-functions.html#GUID-36729D3E-E920-4FAA-8EAA-6E033F6D8930" title="Registers a callback for message notification.">OCISubscriptionRegister()</a></p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
                  <div class="props_rev_3"><a id="GUID-00B6E34B-201C-4C6E-B188-238FE58836D8" name="GUID-00B6E34B-201C-4C6E-B188-238FE58836D8"></a><h5 id="LNOCI-GUID-00B6E34B-201C-4C6E-B188-238FE58836D8" class="sect5"><span class="enumeration_section">13.2.1.4 </span>Setting QOS, Timeout Interval, Namespace, Client Address, and Port Number
                     </h5>
                     <div>
                        <p>Shows how to set QOSFLAGS to QOS levels using <code class="codeph">OCIAttrSet()</code>.
                        </p>
                        <div class="section">
                           <p>You can set QOSFLAGS to the following QOS levels using <code class="codeph">OCIAttrSet()</code>:
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><code class="codeph">OCI_SUBSCR_QOS_RELIABLE</code> - Reliable notification persists across instance and database restarts. Reliability is of the server only and is only for persistent queues or buffered messages. This option describes the persistence of the notifications. Registrations are persistent by default.
                                 </p>
                              </li>
                              <li>
                                 <p><code class="codeph">OCI_SUBSCR_QOS_PURGE_ON_NTFN</code> - Once notification is received, purge registration on first notification. (Subscription is unregistered.)
                                 </p>
                              </li>
                           </ul><pre class="oac_no_warn" dir="ltr">/* Set QOS levels */
ub4 qosflags = OCI_SUBSCR_QOS_RELIABLE | OCI_SUBSCR_QOS_PURGE_ON_NTFN;

/* Set flags in subscription handle */
(void)OCIAttrSet((void *)subscrhp, (ub4)OCI_HTYPE_SUBSCRIPTION,
               (void *)&amp;qosflags, (ub4)0, (ub4)OCI_ATTR_SUBSCR_QOSFLAGS, errhp);

/* Set auto-expiration after 30 seconds */
ub4 timeout = 30;
(void)OCIAttrSet((void *)subscrhp, (ub4)OCI_HTYPE_SUBSCRIPTION,
                 (void *)&amp;timeout, (ub4)0, (ub4)OCI_ATTR_SUBSCR_TIMEOUT, errhp);
</pre><p>The registration is purged when the timeout is exceeded, and a notification is sent to the client, so that the client can invoke its callback and take any necessary action. For client failure before the timeout, the registration is purged.</p>
                           <p>You can set the port number on the environment handle, which is important if the client is on a system behind a firewall that can receive notifications only on certain ports. Clients can specify the port for the listener thread before the first registration, using an attribute in the environment handle. The thread is started the first time OCISubscriptionRegister() is called. If available, this specified port number is used. An error is returned if the client tries to start another thread on a different port using a different environment handle.</p><pre class="oac_no_warn" dir="ltr">ub4 port = 1581;
(void)OCIAttrSet((void *)envhp, (ub4)OCI_HTYPE_ENV, (void *)&amp;port, (ub4)0,
                 (ub4)OCI_ATTR_SUBSCR_PORTNO, errhp);
</pre><p>If instead, the port is determined automatically, you can get the port number at which the client thread is listening for notification by obtaining the attribute from the environment handle.</p><pre class="oac_no_warn" dir="ltr">(void)OCIAttrGet((void *)subhp, (ub4)OCI_HTYPE_ENV, (void *)&amp;port, (ub4)0, 
                 (ub4)OCI_ATTR_SUBSCR_PORTNO, errhp);
</pre><p>Example to set client address: </p><pre class="oac_no_warn" dir="ltr">text ipaddr[16] = "10.177.246.40";
(void)(OCIAttrSet((dvoid *) envhp, (ub4) OCI_HTYPE_ENV,
       (dvoid *) ipaddr, (ub4) strlen((const char *)ipaddr),
       (ub4) OCI_ATTR_SUBSCR_IPADDR, errhp));</pre><div class="infoboxnotealso" id="GUID-00B6E34B-201C-4C6E-B188-238FE58836D8__GUID-7E360654-C212-4562-8C40-B35C38BF3EF3">
                              <p class="notep1">See Also:</p>
                              <p><a href="handle-and-descriptor-attributes.html#GUID-A76BBB38-8F77-40B8-B5A6-1F9C9166C71C__BAJHEBIA">OCI_ATTR_SUBSCR_IPADDR</a></p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
                  <div class="props_rev_3"><a id="GUID-362BE190-510B-4187-A93E-C4538E2C8A24" name="GUID-362BE190-510B-4187-A93E-C4538E2C8A24"></a><h5 id="LNOCI-GUID-362BE190-510B-4187-A93E-C4538E2C8A24" class="sect5"><span class="enumeration_section">13.2.1.5 </span>OCI Functions Used to Manage Publish-Subscribe Notification
                     </h5>
                     <div>
                        <p>Lists and describes the functions used to manage publish-subscribe notification.</p>
                        <div class="section">
                           <p><a href="notification-streams-advanced-queuing.html#GUID-362BE190-510B-4187-A93E-C4538E2C8A24__CACBABFH" title="This table is described by two columns. Column 1 is Function and column 2 is Purpose. It lists about five functions and describes the purpose of each one.">Table 13-1</a> lists the functions that are used to manage publish-subscribe notification. 
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="tblformal" id="GUID-362BE190-510B-4187-A93E-C4538E2C8A24__CACBABFH">
                           <p class="titleintable">Table 13-1 Publish-Subscribe Functions </p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="Publish-Subscribe Functions " summary="This table is described by two columns. Column 1 is Function and column 2 is Purpose. It lists about five functions and describes the purpose of each one." width="100%" frame="hsides" border="1" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="42%" id="d123500e2738">Function</th>
                                    <th align="left" valign="bottom" width="58%" id="d123500e2741">Purpose</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="42%" id="d123500e2746" headers="d123500e2738 ">
                                       <p><a href="streams-advanced-queueing-and-publish-subscribe-functions.html#GUID-72C51789-C48C-4F36-800B-EECC1AD98E00" title="Disables a subscription registration that turns off all notifications.">OCISubscriptionDisable()</a></p>
                                    </td>
                                    <td align="left" valign="top" width="58%" headers="d123500e2746 d123500e2741 ">
                                       <p>Disables a subscription</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="42%" id="d123500e2758" headers="d123500e2738 ">
                                       <p><a href="streams-advanced-queueing-and-publish-subscribe-functions.html#GUID-5C04A301-8564-46AF-A758-9DE7246F0F53" title="Enables a subscription registration that has been disabled.">OCISubscriptionEnable()</a></p>
                                    </td>
                                    <td align="left" valign="top" width="58%" headers="d123500e2758 d123500e2741 ">
                                       <p>Enables a subscription</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="42%" id="d123500e2770" headers="d123500e2738 ">
                                       <p><a href="streams-advanced-queueing-and-publish-subscribe-functions.html#GUID-EFD815F0-D669-4E01-AA54-E1499E302430" title="Posts to a subscription that allows all clients who are registered for the subscription to get notifications.">OCISubscriptionPost()</a></p>
                                    </td>
                                    <td align="left" valign="top" width="58%" headers="d123500e2770 d123500e2741 ">
                                       <p>Posts a subscription</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="42%" id="d123500e2782" headers="d123500e2738 ">
                                       <p><a href="streams-advanced-queueing-and-publish-subscribe-functions.html#GUID-36729D3E-E920-4FAA-8EAA-6E033F6D8930" title="Registers a callback for message notification.">OCISubscriptionRegister()</a></p>
                                    </td>
                                    <td align="left" valign="top" width="58%" headers="d123500e2782 d123500e2741 ">
                                       <p>Registers a subscription</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="42%" id="d123500e2794" headers="d123500e2738 ">
                                       <p><a href="streams-advanced-queueing-and-publish-subscribe-functions.html#GUID-C55B6743-4BB4-4E18-931C-5FBED94592D0" title="Unregisters a subscription that turns off notifications.">OCISubscriptionUnRegister()</a></p>
                                    </td>
                                    <td align="left" valign="top" width="58%" headers="d123500e2794 d123500e2741 ">
                                       <p>Unregisters a subscription</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-6A21E98D-4921-4087-A79A-7B7C8C22ABD5" name="GUID-6A21E98D-4921-4087-A79A-7B7C8C22ABD5"></a><h4 id="LNOCI-GUID-6A21E98D-4921-4087-A79A-7B7C8C22ABD5" class="sect4"><span class="enumeration_section">13.2.2 </span>Notification Callback in OCI
                  </h4>
                  <div>
                     <p>The client must register a notification callback that gets invoked when there is some activity on the subscription for which interest has been registered.</p>
                     <p>In the AQ namespace, for instance, this occurs when a message of interest is enqueued. </p>
                     <p>This callback is typically set through the <code class="codeph">OCI_ATTR_SUBSCR_CALLBACK</code> attribute of the subscription handle. 
                     </p>
                     <div class="infoboxnotealso" id="GUID-6A21E98D-4921-4087-A79A-7B7C8C22ABD5__GUID-5BCA9BCF-64F0-4AE6-8EBF-3D3DA42B857C">
                        <p class="notep1">See Also:</p>
                        <p><a href="handle-and-descriptor-attributes.html#GUID-A76BBB38-8F77-40B8-B5A6-1F9C9166C71C" title="Lists and describes subscription handle attributes.">Subscription Handle Attributes</a> 
                        </p>
                     </div>
                     <p>The callback must return a value of <code class="codeph">OCI_CONTINUE</code> and adhere to the following specification:
                     </p><pre class="oac_no_warn" dir="ltr">typedef ub4 (*OCISubscriptionNotify) ( void            *pCtx,
                                       OCISubscription *pSubscrHp,
                                       void            *pPayload,
                                       ub4             iPayloadLen,
                                       void            *pDescriptor,
                                       ub4             iMode);
</pre><p>The parameters are described as follows:</p>
                     <dl>
                        <dt class="dlterm"><a name="GUID-6A21E98D-4921-4087-A79A-7B7C8C22ABD5__GUID-4B25411D-CB92-483B-A091-CF00C4128419">
                              <!-- --></a>pCtx (IN)
                        </dt>
                        <dd>
                           <p>A user-defined context specified when the callback was registered.</p>
                        </dd>
                        <dt class="dlterm"><a name="GUID-6A21E98D-4921-4087-A79A-7B7C8C22ABD5__GUID-D16EC5EB-632F-4B6C-A416-F100727DB181">
                              <!-- --></a>pSubscrHp (IN)
                        </dt>
                        <dd>
                           <p>The subscription handle specified when the callback was registered.</p>
                        </dd>
                        <dt class="dlterm"><a name="GUID-6A21E98D-4921-4087-A79A-7B7C8C22ABD5__GUID-D831F250-90FD-4E1B-ADF3-230BEBB29329">
                              <!-- --></a>pPayload (IN)
                        </dt>
                        <dd>
                           <p>The payload for this notification. Currently, only ub1 * (a sequence of bytes) for the payload is supported.</p>
                        </dd>
                        <dt class="dlterm"><a name="GUID-6A21E98D-4921-4087-A79A-7B7C8C22ABD5__GUID-29FAE291-172D-4417-88BE-AAD36DAECC1E">
                              <!-- --></a>iPayloadLen (IN)
                        </dt>
                        <dd>
                           <p>The length of the payload for this notification.</p>
                        </dd>
                        <dt class="dlterm"><a name="GUID-6A21E98D-4921-4087-A79A-7B7C8C22ABD5__GUID-37DE5942-26F6-4F15-B388-6EA8DB87907E">
                              <!-- --></a>pDescriptor (IN)
                        </dt>
                        <dd>
                           <p>The namespace-specific descriptor. Namespace-specific parameters can be extracted from this descriptor. The structure of this descriptor is opaque to the user and its type is dependent on the namespace. </p>
                           <p>The attributes of the descriptor are namespace-specific. For Advanced Queuing (AQ), the descriptor is <code class="codeph">OCI_DTYPE_AQNFY</code>. For the AQ namespace, the count of notifications received in the group is provided in the notification descriptor. The attributes of <code class="codeph">pDescriptor</code> are: 
                           </p>
                        </dd>
                     </dl>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Notification flag (regular = 0, timeout = 1, or grouping notification = 2) - <code class="codeph">OCI_ATTR_NFY_FLAGS</code></p>
                        </li>
                        <li>
                           <p>Queue name - <code class="codeph">OCI_ATTR_QUEUE_NAME</code></p>
                        </li>
                        <li>
                           <p>Consumer name - <code class="codeph">OCI_ATTR_CONSUMER_NAME</code></p>
                        </li>
                        <li>
                           <p>Message ID - <code class="codeph">OCI_ATTR_NFY_MSGID</code></p>
                        </li>
                        <li>
                           <p>Message properties - <code class="codeph">OCI_ATTR_MSG_PROP</code></p>
                        </li>
                        <li>
                           <p>Count of notifications received in the group - <code class="codeph">OCI_ATTR_AQ_NTFN_GROUPING_COUNT</code></p>
                        </li>
                        <li>
                           <p>The group, an OCI collection - <code class="codeph">OCI_ATTR_AQ_NTFN_GROUPING_MSGID_ARRAY</code></p>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-6A21E98D-4921-4087-A79A-7B7C8C22ABD5__GUID-436A02DC-59DE-4E18-8CA6-C12718417184">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="notification-streams-advanced-queuing.html#GUID-FF4165B2-A44C-4F76-AC26-DA860F340CA8" title="OCI provides an interface to the Database Advanced Queuing (Database AQ) feature. Database Advanced Queuing provides message queuing as an integrated part of Oracle Database.">OCI and Database Advanced Queuing</a> 
                              </p>
                           </li>
                           <li>
                              <p><a href="handle-and-descriptor-attributes.html#GUID-8C3206B2-1774-4847-B71F-C48869E0BE86" title="Lists and describes notification descriptor attributes.">Notification Descriptor Attributes</a></p>
                           </li>
                        </ul>
                     </div>
                     <dl>
                        <dt class="dlterm"><a name="GUID-6A21E98D-4921-4087-A79A-7B7C8C22ABD5__GUID-139550CE-01B1-48C1-939E-6C65BEBE03BF">
                              <!-- --></a>iMode (IN)
                        </dt>
                        <dd>
                           <p>Call-specific mode. The only valid value is <code class="codeph">OCI_DEFAULT</code>. This value executes the default call.
                           </p>
                        </dd>
                     </dl>
                     <p><a href="notification-streams-advanced-queuing.html#GUID-6A21E98D-4921-4087-A79A-7B7C8C22ABD5__CACGEABA">Example 13-2</a> shows how to use AQ grouping notification attributes in a notification callback.
                     </p>
                     <div class="example" id="GUID-6A21E98D-4921-4087-A79A-7B7C8C22ABD5__CACGEABA">
                        <p class="titleinexample">Example 13-2 Using AQ Grouping Notification Attributes in an OCI Notification Callback</p><pre class="oac_no_warn" dir="ltr">ub4 notifyCB1(void *ctx, OCISubscription *subscrhp, void *pay, ub4 payl,
              void *desc, ub4 mode)
{
 oratext            *subname;
 ub4                 size;
 OCIColl            *msgid_array = (OCIColl *)0;
 ub4                 msgid_cnt = 0;
 OCIRaw             *msgid;
 void              **msgid_ptr;
 sb4                 num_msgid = 0;
 void               *elemind = (void *)0;
 boolean             exist;
 ub2                 flags;
 oratext            *hexit = (oratext *)"0123456789ABCDEF";
 ub4                 i, j;
 
 /* get subscription name */
 OCIAttrGet(subscrhp, OCI_HTYPE_SUBSCRIPTION, (void *)&amp;subname, &amp;size,
            OCI_ATTR_SUBSCR_NAME,ctxptr-&gt;errhp);
 
 /* print subscripton name */
 printf("Got notification for %.*s\n", size, subname);
 fflush((FILE *)stdout);
 
 /* get the #ntfns received in this group */
 OCIAttrGet(desc, OCI_DTYPE_AQNFY, (void *)&amp;msgid_cnt, &amp;size,
            OCI_ATTR_AQ_NTFN_GROUPING_COUNT, ctxptr-&gt;errhp);
 
 /* get the group - collection of msgids */
 OCIAttrGet(desc, OCI_DTYPE_AQNFY, (void *)&amp;msgid_array, &amp;size,
            OCI_ATTR_AQ_NTFN_GROUPING_MSGID_ARRAY, ctxptr-&gt;errhp);
 
 /* get notification flag - regular, timeout, or grouping notification? */
 OCIAttrGet(desc, OCI_DTYPE_AQNFY, (void *)&amp;flags, &amp;size,
            OCI_ATTR_NFY_FLAGS, ctxptr-&gt;errhp);
 
 /* print notification flag */
 printf("Flag: %d\n", (int)flags);
 
 /* get group (collection) size */
 if (msgid_array)
   checkerr(ctxptr-&gt;errhp,
        OCICollSize(ctxptr-&gt;envhp, ctxptr-&gt;errhp,
        CONST OCIColl *) msgid_array, &amp;num_msgid),
        "Inside notifyCB1-OCICollSize");
 else
   num_msgid =0;
 
 /* print group size */
 printf("Collection size: %d\n", num_msgid);
 
 /* print all msgids in the group */
 for(i = 0; i &lt; num_msgid; i++)
 {
   ub4  rawSize;                                             /* raw size    */
   ub1 *rawPtr;                                              /* raw pointer */
     /* get msgid from group */
   checkerr(ctxptr-&gt;errhp,
        OCICollGetElem(ctxptr-&gt;envhp, ctxptr-&gt;errhp,
               (OCIColl *) msgid_array, i, &amp;exist,
               (void **)(&amp;msgid_ptr), &amp;elemind),
        "Inside notifyCB1-OCICollGetElem");
   msgid = *msgid_ptr;
   rawSize = OCIRawSize(ctxptr-&gt;envhp, msgid);
   rawPtr = OCIRawPtr(ctxptr-&gt;envhp, msgid);
 
   /* print msgid size */
   printf("Msgid size: %d\n", rawSize);
 
   /* print msgid in hexadecimal format */
   for (j = 0; j &lt; rawSize; j++)
   {                                           /* for each byte in the raw */
     printf("%c", hexit[(rawPtr[j] &amp; 0xf0) &gt;&gt; 4]);
     printf("%c", hexit[(rawPtr[j] &amp; 0x0f)]);
   }
   printf("\n");
 }
 
 /* print #ntfns received in group */
 printf("Notification Count: %d\n", msgid_cnt);
 printf("\n");
 printf("***********************************************************\n");
 fflush((FILE *)stdout);
 return 1;
}
</pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-078F3FD1-7CAA-45FC-A93F-1CE942D27CA0" name="GUID-078F3FD1-7CAA-45FC-A93F-1CE942D27CA0"></a><h4 id="LNOCI-GUID-078F3FD1-7CAA-45FC-A93F-1CE942D27CA0" class="sect4"><span class="enumeration_section">13.2.3 </span>Notification Procedure
                  </h4>
                  <div>
                     <p>The PL/SQL notification procedure that is invoked when there is some activity on the subscription for which interest has been registered, must be created in the database.</p>
                     <p>This procedure is typically set through the <code class="codeph">OCI_ATTR_SUBSCR_RECPT</code> attribute of the subscription handle.
                     </p>
                     <div class="infoboxnotealso" id="GUID-078F3FD1-7CAA-45FC-A93F-1CE942D27CA0__GUID-C77CDBAB-58A4-45B3-9737-9890BD2222D8">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="handle-and-descriptor-attributes.html#GUID-A76BBB38-8F77-40B8-B5A6-1F9C9166C71C" title="Lists and describes subscription handle attributes.">Subscription Handle Attributes</a> 
                              </p>
                           </li>
                           <li>
                              <p>"Oracle Database AQ PL/SQL Callback" in <a href="../arpls/index.html" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> for the PL/SQL procedure
                        specification
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-909E21A8-A247-4E54-9069-79B3EF219D2F" name="GUID-909E21A8-A247-4E54-9069-79B3EF219D2F"></a><h4 id="LNOCI-GUID-909E21A8-A247-4E54-9069-79B3EF219D2F" class="sect4"><span class="enumeration_section">13.2.4 </span>Publish-Subscribe Direct Registration Example
                  </h4>
                  <div>
                     <p>Shows examples implementing publish subscription notification using direct registration.</p>
                     <div class="section">
                        <p><a href="notification-streams-advanced-queuing.html#GUID-909E21A8-A247-4E54-9069-79B3EF219D2F__CACHDEAE">Example 13-3</a> shows how system events, client notification, and Advanced Queuing work together to implement publish subscription notification.
                        </p>
                        <p>The PL/SQL code in <a href="notification-streams-advanced-queuing.html#GUID-909E21A8-A247-4E54-9069-79B3EF219D2F__CACHDEAE">Example 13-3</a> creates all objects necessary to support a publish-subscribe mechanism under the user schema <code class="codeph">pubsub</code>. In this code, the Agent <code class="codeph">snoop</code> subscribes to messages that are published at logon events. Note that the user <code class="codeph">pubsub</code> needs <code class="codeph">AQ_ADMINISTRATOR_ROLE</code> and <code class="codeph">AQ_USER_ROLE</code> privileges to use Advance Queuing functionality. The initialization parameter <code class="codeph">_SYSTEM_TRIG_ENABLED</code> must be set to <code class="codeph">TRUE</code> (the default) to enable triggers for system events.<span class="bold"></span> Connect as <code class="codeph">pubsub</code> before running <a href="notification-streams-advanced-queuing.html#GUID-909E21A8-A247-4E54-9069-79B3EF219D2F__CACHDEAE">Example 13-3</a>.
                        </p>
                        <p>After the subscriptions are created, the client must register for notification using callback functions. <a href="notification-streams-advanced-queuing.html#GUID-909E21A8-A247-4E54-9069-79B3EF219D2F__CACBBGGJ">Example 13-4</a> shows sample code that performs the necessary steps for registration. The initial steps of allocating and initializing session handles are omitted here for clarity.
                        </p>
                        <p>If user <code class="codeph">IX</code> logs on to the database, the client is notified by email, and the callback function <code class="codeph">notifySnoop</code> is called. An email notification is sent to the address xyz@company.com and the PL/SQL procedure <code class="codeph">plsqlnotifySnoop</code> is also called in the database.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-909E21A8-A247-4E54-9069-79B3EF219D2F__CACHDEAE">
                        <p class="titleinexample">Example 13-3 Implementing a Publish Subscription Notification</p><pre class="oac_no_warn" dir="ltr">----------------------------------------------------------
----create queue table for persistent multiple consumers
----------------------------------------------------------
---- Create or replace a queue table
begin
  DBMS_AQADM.CREATE_QUEUE_TABLE(
  QUEUE_TABLE=&gt;'pubsub.raw_msg_table', 
  MULTIPLE_CONSUMERS =&gt; TRUE,
  QUEUE_PAYLOAD_TYPE =&gt;'RAW',
  COMPATIBLE =&gt; '8.1.5');
end;
/
----------------------------------------------------------
---- Create a persistent queue for publishing messages
----------------------------------------------------------
---- Create a queue for logon events
begin
  DBMS_AQADM.CREATE_QUEUE(QUEUE_NAME=&gt;'pubsub.logon',
  QUEUE_TABLE=&gt;'pubsub.raw_msg_table',
  COMMENT=&gt;'Q for error triggers');
end;
/
----------------------------------------------------------
---- Start the queue
----------------------------------------------------------
begin
  DBMS_AQADM.START_QUEUE('pubsub.logon');
end;
/
----------------------------------------------------------
---- define new_enqueue for convenience
----------------------------------------------------------
create or replace procedure new_enqueue(queue_name  in varchar2,
                                        payload  in raw ,
correlation in varchar2 := NULL,
exception_queue in varchar2 := NULL)
as
  enq_ct     dbms_aq.enqueue_options_t;
  msg_prop   dbms_aq.message_properties_t;
  enq_msgid  raw(16);
  userdata   raw(1000);
begin
  msg_prop.exception_queue := exception_queue;
  msg_prop.correlation := correlation;
  userdata := payload;
  DBMS_AQ.ENQUEUE(queue_name,enq_ct, msg_prop,userdata,enq_msgid);
end;
/
----------------------------------------------------------
---- add subscriber with rule based on current user name, 
---- using correlation_id
----------------------------------------------------------
declare
subscriber sys.aq$_agent;
begin
  subscriber := sys.aq$_agent('SNOOP', null, null);
  dbms_aqadm.add_subscriber(queue_name =&gt; 'pubsub.logon',
                            subscriber =&gt; subscriber,
                            rule =&gt; 'CORRID = ''ix'' ');
end;
/
----------------------------------------------------------
---- create a trigger on logon on database
----------------------------------------------------------
---- create trigger on after logon
create or replace trigger systrig2
   AFTER LOGON
   ON DATABASE
   begin
     new_enqueue('pubsub.logon', hextoraw('9999'), dbms_standard.login_user);
   end;
/

----------------------------------------------------------
---- create a PL/SQL callback for notification of logon 
---- of user 'ix' on database
----------------------------------------------------------
---- 
create or replace procedure plsqlnotifySnoop(
  context raw, reginfo sys.aq$_reg_info, descr sys.aq$_descriptor,
  payload raw, payloadl number)
as
begin
 dbms_output.put_line('Notification : User ix Logged on\n');
end;
/
</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-909E21A8-A247-4E54-9069-79B3EF219D2F__CACBBGGJ">
                        <p class="titleinexample">Example 13-4 Registering for Notification Using Callback Functions</p><pre class="oac_no_warn" dir="ltr">...
static ub4 namespace = OCI_SUBSCR_NAMESPACE_AQ;

static OCISubscription *subscrhpSnoop = (OCISubscription *)0;
static OCISubscription *subscrhpSnoopMail = (OCISubscription *)0;
static OCISubscription *subscrhpSnoopServer = (OCISubscription *)0;

/* callback function for notification of logon of user 'ix' on database */

static ub4 notifySnoop(ctx, subscrhp, pay, payl, desc, mode)
    void *ctx;
    OCISubscription *subscrhp;
    void *pay;
    ub4 payl;
    void *desc;
    ub4 mode;
{
    printf("Notification : User ix Logged on\n");
  (void)OCIHandleFree((void *)subscrhpSnoop,
            (ub4) OCI_HTYPE_SUBSCRIPTION);
    return 1;
}

static void checkerr(errhp, status)
OCIError *errhp;
sword status;
{
  text errbuf[512];
  ub4 buflen;
  sb4 errcode;

  if (status == OCI_SUCCESS) return;

  switch (status)
  {
  case OCI_SUCCESS_WITH_INFO:
    printf("Error - OCI_SUCCESS_WITH_INFO\n");
    break;
  case OCI_NEED_DATA:
    printf("Error - OCI_NEED_DATA\n");
    break;
  case OCI_NO_DATA:
    printf("Error - OCI_NO_DATA\n");
    break;
  case OCI_ERROR:
    OCIErrorGet ((void *) errhp, (ub4) 1, (text *) NULL, &amp;errcode,
            errbuf, (ub4) sizeof(errbuf), (ub4) OCI_HTYPE_ERROR);
    printf("Error - %s\n", errbuf);
    break;
  case OCI_INVALID_HANDLE:
    printf("Error - OCI_INVALID_HANDLE\n");
    break;
  case OCI_STILL_EXECUTING:
    printf("Error - OCI_STILL_EXECUTING\n");
    break;
  case OCI_CONTINUE:
    printf("Error - OCI_CONTINUE\n");
    break;
  default:
    printf("Error - %d\n", status);
    break;
  }
}

static void initSubscriptionHn (subscrhp,
                         subscriptionName,
                         func,
                         recpproto,
                         recpaddr,
                         recppres)
OCISubscription **subscrhp;
  char * subscriptionName;
  void * func;
  ub4 recpproto;
  char * recpaddr;
  ub4 recppres;
{
    /* allocate subscription handle */
    (void) OCIHandleAlloc((void *) envhp, (void **)subscrhp,
        (ub4) OCI_HTYPE_SUBSCRIPTION,
        (size_t) 0, (void **) 0);

    /* set subscription name in handle */
    (void) OCIAttrSet((void *) *subscrhp, (ub4) OCI_HTYPE_SUBSCRIPTION,
        (void *) subscriptionName,
        (ub4) strlen((char *)subscriptionName),
        (ub4) OCI_ATTR_SUBSCR_NAME, errhp);

    /* set callback function in handle */
    if (func)
      (void) OCIAttrSet((void *) *subscrhp, (ub4) OCI_HTYPE_SUBSCRIPTION,
          (void *) func, (ub4) 0,
          (ub4) OCI_ATTR_SUBSCR_CALLBACK, errhp);

    /* set context in handle */
    (void) OCIAttrSet((void *) *subscrhp, (ub4) OCI_HTYPE_SUBSCRIPTION,
        (void *) 0, (ub4) 0,
       (ub4) OCI_ATTR_SUBSCR_CTX, errhp);

    /* set namespace in handle */
    (void) OCIAttrSet((void *) *subscrhp, (ub4) OCI_HTYPE_SUBSCRIPTION,
        (void *) &amp;namespace, (ub4) 0,
        (ub4) OCI_ATTR_SUBSCR_NAMESPACE, errhp);

    /* set receive with protocol in handle */
    (void) OCIAttrSet((void *) *subscrhp, (ub4) OCI_HTYPE_SUBSCRIPTION,
        (void *) &amp;recpproto, (ub4) 0,
        (ub4) OCI_ATTR_SUBSCR_RECPTPROTO, errhp);

    /* set recipient address in handle */
    if (recpaddr)
      (void) OCIAttrSet((void *) *subscrhp, (ub4) OCI_HTYPE_SUBSCRIPTION,
          (void *) recpaddr, (ub4) strlen(recpaddr),
          (ub4) OCI_ATTR_SUBSCR_RECPT, errhp);

    /* set receive with presentation in handle */
    (void) OCIAttrSet((void *) *subscrhp, (ub4) OCI_HTYPE_SUBSCRIPTION,
        (void *) &amp;recppres, (ub4) 0,
        (ub4) OCI_ATTR_SUBSCR_RECPTPRES, errhp);

    printf("Begining Registration for subscription %s\n", subscriptionName);
    checkerr(errhp, OCISubscriptionRegister(svchp, subscrhp, 1, errhp,
        OCI_DEFAULT));
   printf("done\n");

}


int main( argc, argv)
int    argc;
char * argv[];
{
    OCISession *authp = (OCISession *) 0;

/*****************************************************
Initialize OCI Process/Environment
Initialize Server Contexts
Connect to Server
Set Service Context
******************************************************/

/* Registration Code Begins */
/* Each call to initSubscriptionHn allocates
   and initializes a Registration Handle */

/* Register for OCI notification */
    initSubscriptionHn(    &amp;subscrhpSnoop,    /* subscription handle*/
    (char*) "PUBSUB.LOGON:SNOOP", /* subscription name */
                                  /*&lt;queue_name&gt;:&lt;agent_name&gt; */
        (void*)notifySnoop,  /* callback function */
        OCI_SUBSCR_PROTO_OCI, /* receive with protocol */
        (char *)0, /* recipient address */
        OCI_SUBSCR_PRES_DEFAULT); /* receive with presentation */

/* Register for email notification */
    initSubscriptionHn(    &amp;subscrhpSnoopMail,  /* subscription handle */
     (char*) "PUBSUB.LOGON:SNOOP",              /* subscription name */ 
                                                /* &lt;queue_name&gt;:&lt;agent_name&gt; */
        (void*)0, /* callback function */
        OCI_SUBSCR_PROTO_MAIL, /* receive with protocol */
        (char*)  "xyz@company.com", /* recipient address */
        OCI_SUBSCR_PRES_DEFAULT); /* receive with presentation */

/* Register for server to server notification */
    initSubscriptionHn(    &amp;subscrhpSnoopServer, /* subscription handle */
       (char*)  "PUBSUB.LOGON:SNOOP",            /* subscription name */
                                                 /* &lt;queue_name&gt;:&lt;agent_name&gt; */
        (void*)0, /* callback function */
        OCI_SUBSCR_PROTO_SERVER, /* receive with protocol */
         (char*) "pubsub.plsqlnotifySnoop", /* recipient address */
        OCI_SUBSCR_PRES_DEFAULT); /* receive with presentation */

    checkerr(errhp, OCITransCommit(svchp, errhp, (ub4) OCI_DEFAULT));

/*****************************************************
The Client Process does not need a live Session for Callbacks.
End Session and Detach from Server.
******************************************************/

    OCISessionEnd ( svchp,  errhp, authp, (ub4) OCI_DEFAULT);

    /* detach from server */
    OCIServerDetach( srvhp, errhp, OCI_DEFAULT);

   while (1)    /* wait for callback */
    sleep(1);
}
</pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-9F4EEC78-5CAC-4E86-9F82-1FF9586289CF" name="GUID-9F4EEC78-5CAC-4E86-9F82-1FF9586289CF"></a><h4 id="LNOCI-GUID-9F4EEC78-5CAC-4E86-9F82-1FF9586289CF" class="sect4"><span class="enumeration_section">13.2.5 </span>Publish-Subscribe LDAP Registration Example
                  </h4>
                  <div>
                     <p>Shows an example that illustrates how to do LDAP registration.</p>
                     <div class="section">
                        <p><a href="notification-streams-advanced-queuing.html#GUID-9F4EEC78-5CAC-4E86-9F82-1FF9586289CF__CACBFFEB">Example 13-5</a> shows a code fragment that illustrates how to do LDAP registration. Please read all the program comments.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-9F4EEC78-5CAC-4E86-9F82-1FF9586289CF__CACBFFEB">
                        <p class="titleinexample">Example 13-5 LDAP Registration</p><pre class="oac_no_warn" dir="ltr">...

  /* To use the LDAP registration feature, OCI_EVENTS | OCI_EVENTS |OCI_USE_LDAP*/
  /*   must be set in OCIEnvCreate or OCIEnvNlsCreate */
  /*     (Note: OCIInitialize is deprecated): */
  (void) OCIInitialize((ub4) OCI_EVENTS|OCI_OBJECT|OCI_USE_LDAP, (void *)0,
                       (void * (*)(void *, size_t)) 0,
                       (void * (*)(void *, void *, size_t))0,
                       (void (*)(void *, void *)) 0 );

...

  /* set LDAP attributes in the environment handle */

  /* LDAP host name */
  (void) OCIAttrSet((void *)envhp, OCI_HTYPE_ENV, (void *)"yow", 3,
                    OCI_ATTR_LDAP_HOST, (OCIError *)errhp);

  /* LDAP server port */ 
  ldap_port = 389;
  (void) OCIAttrSet((void *)envhp, OCI_HTYPE_ENV, (void *)&amp;ldap_port,
                    (ub4)0, OCI_ATTR_LDAP_PORT, (OCIError *)errhp);

  /* bind DN of the client, normally the enterprise user name */
  (void) OCIAttrSet((void *)envhp, OCI_HTYPE_ENV, (void *)"cn=orcladmin",
                    12, OCI_ATTR_BIND_DN, (OCIError *)errhp);

  /* password of the client */
  (void) OCIAttrSet((void *)envhp, OCI_HTYPE_ENV, (void *)"welcome",
                    7, OCI_ATTR_LDAP_CRED, (OCIError *)errhp);

  /* authentication method is "simple", username/password authentication */
  ldap_auth = 0x01;
  (void) OCIAttrSet((void *)envhp, OCI_HTYPE_ENV, (void *)&amp;ldap_auth,
                    (ub4)0, OCI_ATTR_LDAP_AUTH, (OCIError *)errhp);

  /* administrative context: this is the DN above cn=oraclecontext */
  (void) OCIAttrSet((void *)envhp, OCI_HTYPE_ENV, (void *)"cn=acme,cn=com",
                    14, OCI_ATTR_LDAP_CTX, (OCIError *)errhp);

...

  /* retrieve the LDAP attributes from the environment handle */

  /* LDAP host */
  (void) OCIAttrGet((void *)envhp, OCI_HTYPE_ENV, (void *)&amp;buf, 
                    &amp;szp,  OCI_ATTR_LDAP_HOST,  (OCIError *)errhp);

  /* LDAP server port */
  (void) OCIAttrGet((void *)envhp, OCI_HTYPE_ENV, (void *)&amp;intval, 
                    0,  OCI_ATTR_LDAP_PORT,  (OCIError *)errhp);

  /* client binding DN */
  (void) OCIAttrGet((void *)envhp, OCI_HTYPE_ENV, (void *)&amp;buf, 
                    &amp;szp,  OCI_ATTR_BIND_DN,  (OCIError *)errhp);

  /* client password */
  (void) OCIAttrGet((void *)envhp, OCI_HTYPE_ENV, (void *)&amp;buf, 
                    &amp;szp,  OCI_ATTR_LDAP_CRED,  (OCIError *)errhp);

  /* administrative context */
  (void) OCIAttrGet((void *)envhp, OCI_HTYPE_ENV, (void *)&amp;buf, 
                    &amp;szp,  OCI_ATTR_LDAP_CTX,  (OCIError *)errhp);

  /* client authentication method */
  (void) OCIAttrGet((void *)envhp, OCI_HTYPE_ENV, (void *)&amp;intval, 
                    0,  OCI_ATTR_LDAP_AUTH,  (OCIError *)errhp);
  
  ...

  /* to set up the server DN descriptor in the subscription handle */

  /* allocate a server DN descriptor, dn is of type "OCIServerDNs **", 
     subhp is of type "OCISubscription **" */
  (void) OCIDescriptorAlloc((void *)envhp, (void **)dn, 
                         (ub4) OCI_DTYPE_SRVDN, (size_t)0, (void **)0);

  /* now *dn is the server DN descriptor, add the DN of the first database 
     that you want to register */
  (void) OCIAttrSet((void *)*dn, (ub4) OCI_DTYPE_SRVDN, 
                    (void *)"cn=server1,cn=oraclecontext,cn=acme,cn=com",
                    42, (ub4)OCI_ATTR_SERVER_DN, errhp);
  /* add the DN of another database in the descriptor */
  (void) OCIAttrSet((void *)*dn, (ub4) OCI_DTYPE_SRVDN, 
                    (void *)"cn=server2,cn=oraclecontext,cn=acme,cn=com",
                    42, (ub4)OCI_ATTR_SERVER_DN, errhp);

  /* set the server DN descriptor into the subscription handle */
  (void) OCIAttrSet((void *) *subhp, (ub4) OCI_HTYPE_SUBSCRIPTION,
                 (void *) *dn, (ub4)0, (ub4) OCI_ATTR_SERVER_DNS, errhp);

  ...

  /* now you will try to get the server DN information from the subscription
     handle */
 
  /* first, get the server DN descriptor out */
  (void) OCIAttrGet((void *) *subhp, (ub4) OCI_HTYPE_SUBSCRIPTION, 
                    (void *)dn, &amp;szp, OCI_ATTR_SERVER_DNS, errhp);

  /* then, get the number of server DNs in the descriptor */
  (void) OCIAttrGet((void *) *dn, (ub4)OCI_DTYPE_SRVDN, (void *)&amp;intval,
                    &amp;szp, (ub4)OCI_ATTR_DN_COUNT, errhp);

  /* allocate an array of char * to hold server DN pointers returned by
     an Oracle database*/
    if (intval)
    {
      arr = (char **)malloc(intval*sizeof(char *));
      (void) OCIAttrGet((void *)*dn, (ub4)OCI_DTYPE_SRVDN, (void *)arr,
                        &amp;intval, (ub4)OCI_ATTR_SERVER_DN, errhp);
    }

  /* OCISubscriptionRegister() calls have two modes: OCI_DEFAULT and 
     OCI_REG_LDAPONLY. If OCI_DEFAULT is used, there should be only one
     server DN in the server DN descriptor. The registration request will
     be sent to the database. If a database connection is not available,
     the registration request will be detoured to the LDAP server. However,
     if mode OCI_REG_LDAPONLY is used, the registration request
     will be directly sent to LDAP. This mode should be used when there is 
     more than one server DN in the server DN descriptor or you are sure
     that a database connection is not available.

     In this example, two DNs are entered, so you should use mode 
     OCI_REG_LDAPONLY in LDAP registration. */
  OCISubscriptionRegister(svchp, subhp, 1, errhp, OCI_REG_LDAPONLY);

  ...

  /* as OCISubscriptionRegister(), OCISubscriptionUnregister() also has
     mode OCI_DEFAULT and OCI_REG_LDAPONLY. The usage is the same. */

  OCISubscriptionUnRegister(svchp, *subhp, errhp, OCI_REG_LDAPONLY);
}
...
</pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
            </div>
            <div class="props_rev_3"><a id="GUID-FF4165B2-A44C-4F76-AC26-DA860F340CA8" name="GUID-FF4165B2-A44C-4F76-AC26-DA860F340CA8"></a><h3 id="LNOCI-GUID-FF4165B2-A44C-4F76-AC26-DA860F340CA8" class="sect3"><span class="enumeration_section">13.3 </span>OCI and Database Advanced Queuing
               </h3>
               <div>
                  <p>OCI provides an interface to the Database Advanced Queuing (Database AQ)
        feature. Database Advanced Queuing provides message queuing as an integrated part of Oracle
        Database.</p>
                  <p>Database AQ provides this functionality by integrating the queuing system with the
            database, thereby creating a <span class="italic">message-enabled database.</span> By providing an integrated
            solution, Database AQ frees application developers to devote their efforts to their
            specific business logic rather than having to construct a messaging infrastructure. 
                  </p>
                  <div class="infoboxnote" id="GUID-FF4165B2-A44C-4F76-AC26-DA860F340CA8__GUID-338E254E-D679-4142-B350-4D50B42971DF">
                     <p class="notep1">Note:</p>
                     <p>To use Database Advanced Queuing, you must be using the Enterprise Edition of Oracle
                Database.</p>
                  </div>
                  <div class="p">This section includes the following topics:
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="notification-streams-advanced-queuing.html#GUID-C7DB04D8-81D1-4253-851E-1C7C389CD7F4" title="Lists the OCI Database Advanced Queuing functions.">OCI Database Advanced Queuing Functions</a></p>
                        </li>
                        <li>
                           <p><a href="notification-streams-advanced-queuing.html#GUID-D4ED0510-8B6F-40F3-A142-F1DD89C49F02" title="Lists the OCI Database Advanced Queuing descriptors and shows their usage.">OCI Database Advanced Queuing Descriptors</a></p>
                        </li>
                        <li>
                           <p><a href="notification-streams-advanced-queuing.html#GUID-BB00AF24-95F4-4BE5-A4BE-DA9C6004F1A3" title="Shows a comparison between functions, parameters, and options for OCI Database Advanced Queuing functions and descriptors, and PL/SQL AQ functions in the DBMS_AQ package.">Database Advanced Queuing in OCI Versus PL/SQL</a></p>
                        </li>
                        <li>
                           <p><a href="notification-streams-advanced-queuing.html#GUID-145D489F-52D8-4D41-8319-EF1ACA19B7AD" title="Buffered messaging is a nonpersistent messaging capability within Database AQ that was first available in Oracle Database 10g Release 2.">Using Buffered Messaging</a></p>
                        </li>
                     </ul>
                  </div>
                  <div class="infoboxnotealso" id="GUID-FF4165B2-A44C-4F76-AC26-DA860F340CA8__GUID-21E3AAFE-0383-4731-9008-76A115228B7F">
                     <p class="notep1">See Also:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="../adque/aq-introduction.html#ADQUE0100" target="_blank"><span><cite>Oracle Database Advanced Queuing User's Guide</cite></span></a></p>
                        </li>
                        <li>
                           <p><a href="../adxdk/getting-started-with-XDK-for-C.html#ADXDK1300" target="_blank"><span><cite>Oracle XML Developer's Kit Programmer's Guide</cite></span></a></p>
                        </li>
                        <li>
                           <p>The description of <a href="streams-advanced-queueing-and-publish-subscribe-functions.html#GUID-AE3DB345-0A77-4922-ABBD-FBBFB6E1A9B4" title="Performs an enqueue operation using Database Advanced Queuing.">OCIAQEnq()</a> for example code demonstrating the use of OCI with AQ 
                           </p>
                        </li>
                     </ul>
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-C7DB04D8-81D1-4253-851E-1C7C389CD7F4" name="GUID-C7DB04D8-81D1-4253-851E-1C7C389CD7F4"></a><h4 id="LNOCI-GUID-C7DB04D8-81D1-4253-851E-1C7C389CD7F4" class="sect4"><span class="enumeration_section">13.3.1 </span>OCI Database Advanced Queuing
        Functions
                  </h4>
                  <div>
                     <p>Lists the OCI Database Advanced Queuing functions.</p>
                     <p>The OCI library includes several functions related to Database Advanced Queuing:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><code class="codeph">OCIAQEnq()</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">OCIAQDeq()</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">OCIAQListen()</code> (Deprecated)
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">OCIAQListen2()</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">OCIAQEnqArray()</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">OCIAQDeqArray()</code></p>
                        </li>
                     </ul>
                     <p>You can enqueue an array of messages to a single queue. The messages all share the same enqueue options, but each message in the array can have different message properties. You can also dequeue an array of messages from a single queue. For transaction group queues, you can dequeue all messages for a single transaction group using one call.</p>
                     <div class="infoboxnotealso" id="GUID-C7DB04D8-81D1-4253-851E-1C7C389CD7F4__GUID-322AC3F2-FDB3-44D6-943B-8B8EA241FCBE">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="streams-advanced-queueing-and-publish-subscribe-functions.html#GUID-4D7FFF56-38DE-4DBF-80E8-48BF19C2B2D3" title="Lists and describes the Database Advanced Queuing and publish-subscribe functions.">Database Advanced Queuing and Publish-Subscribe Functions</a></p>
                           </li>
                           <li>
                              <p><a href="streams-advanced-queueing-and-publish-subscribe-functions.html#GUID-AE3DB345-0A77-4922-ABBD-FBBFB6E1A9B4" title="Performs an enqueue operation using Database Advanced Queuing.">OCIAQEnq()</a></p>
                           </li>
                           <li>
                              <p><a href="streams-advanced-queueing-and-publish-subscribe-functions.html#GUID-982A4127-C23A-43E6-94CE-D3F76EC4553C">OCIAQDeq()</a></p>
                           </li>
                           <li>
                              <p><a href="deprecated-oci-functions.html#GUID-D8F0FF2D-F9D7-470A-BD5A-54E88C971777" title="This function was deprecated in a release previous to Oracle Database 11g Release 2 (11.2).">OCIAQListen()</a></p>
                           </li>
                           <li>
                              <p><a href="streams-advanced-queueing-and-publish-subscribe-functions.html#GUID-499ECEF6-F447-46C5-8F3F-48DE66839BD1" title="Listens on one or more queues on behalf of a list of agents.">OCIAQListen2()</a></p>
                           </li>
                           <li>
                              <p><a href="streams-advanced-queueing-and-publish-subscribe-functions.html#GUID-632ED6BA-017A-40C9-BC51-C9A547B7567C" title="Enqueues an array of messages to a queue.">OCIAQEnqArray()</a></p>
                           </li>
                           <li>
                              <p><a href="streams-advanced-queueing-and-publish-subscribe-functions.html#GUID-F0E6A45A-AFAD-4B8F-994B-D5625D1F435A" title="Dequeues an array of messages from a queue.">OCIAQDeqArray()</a></p>
                           </li>
                        </ul>
                        <p></p>
                     </div>
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-D4ED0510-8B6F-40F3-A142-F1DD89C49F02" name="GUID-D4ED0510-8B6F-40F3-A142-F1DD89C49F02"></a><h4 id="LNOCI-GUID-D4ED0510-8B6F-40F3-A142-F1DD89C49F02" class="sect4"><span class="enumeration_section">13.3.2 </span>OCI Database Advanced Queuing
        Descriptors
                  </h4>
                  <div>
                     <p>Lists the OCI Database Advanced Queuing descriptors and shows their
        usage.</p>
                     <p>The following descriptors are used by OCI Database Advanced Queuing operations:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><code class="codeph">OCIAQEnqOptions</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">OCIAQDeqOptions</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">OCIAQMsgProperties</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">OCIAQAgent</code></p>
                        </li>
                     </ul>
                     <p>You can allocate these descriptors with the service handle using the standard <code class="codeph">OCIDescriptorAlloc()</code> call. The following code shows examples of this:
                     </p><pre class="oac_no_warn" dir="ltr">OCIDescriptorAlloc(svch, &amp;enqueue_options, OCI_DTYPE_AQENQ_OPTIONS, 0, 0 ); 
OCIDescriptorAlloc(svch, &amp;dequeue_options, OCI_DTYPE_AQDEQ_OPTIONS, 0, 0 ); 
OCIDescriptorAlloc(svch, &amp;message_properties, OCI_DTYPE_AQMSG_PROPERTIES, 0, 0);
OCIDescriptorAlloc(svch, &amp;agent, OCI_DTYPE_AQAGENT, 0, 0 ); 
</pre><p>Each descriptor has a variety of attributes that can be set or read. </p>
                     <div class="infoboxnotealso" id="GUID-D4ED0510-8B6F-40F3-A142-F1DD89C49F02__GUID-EA903651-B715-40A1-829D-FE2FCC0A3A77">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="handle-and-descriptor-attributes.html#GUID-011A5B7A-7F24-469A-841A-2FCAF48444CB" title="Lists and describes Database Advanced Queuing descriptor attributes">Database Advanced Queuing Descriptor Attributes</a></p>
                           </li>
                           <li>
                              <p><a href="handle-and-descriptor-functions.html#GUID-E9EF2766-E078-49A7-B1D1-738E4BA4814F" title="Allocates storage to hold descriptors or LOB locators.">OCIDescriptorAlloc()</a></p>
                           </li>
                        </ul>
                        <p></p>
                     </div>
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-BB00AF24-95F4-4BE5-A4BE-DA9C6004F1A3" name="GUID-BB00AF24-95F4-4BE5-A4BE-DA9C6004F1A3"></a><h4 id="LNOCI-GUID-BB00AF24-95F4-4BE5-A4BE-DA9C6004F1A3" class="sect4"><span class="enumeration_section">13.3.3 </span>Database Advanced Queuing in OCI Versus
        PL/SQL
                  </h4>
                  <div>
                     <p>Shows a comparison between functions, parameters, and options for OCI
        Database Advanced Queuing functions and descriptors, and PL/SQL AQ functions in the DBMS_AQ
        package.</p>
                     <div class="section">
                        <p>The following tables compare functions, parameters, and options for OCI Database
                Advanced Queuing functions and descriptors, and PL/SQL AQ functions in the DBMS_AQ
                package. <a href="notification-streams-advanced-queuing.html#GUID-BB00AF24-95F4-4BE5-A4BE-DA9C6004F1A3__CACIAFCB" title="This table is described by 2 columns. Column 1 is the PL/SQL function and column 2 is its equivalent OCI function.">Table 13-2</a> compares AQ functions.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="tblformal" id="GUID-BB00AF24-95F4-4BE5-A4BE-DA9C6004F1A3__CACIAFCB">
                        <p class="titleintable">Table 13-2 AQ Functions </p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="AQ Functions " summary="This table is described by 2 columns. Column 1 is the PL/SQL function and column 2 is its equivalent OCI function. " width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="45%" id="d123500e4782">PL/SQL Function</th>
                                 <th align="left" valign="bottom" width="55%" id="d123500e4785">OCI Function</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="45%" id="d123500e4790" headers="d123500e4782 ">
                                    <p>DBMS_AQ.ENQUEUE</p>
                                 </td>
                                 <td align="left" valign="top" width="55%" headers="d123500e4790 d123500e4785 ">
                                    <p><code class="codeph">OCIAQEnq()</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="45%" id="d123500e4798" headers="d123500e4782 ">
                                    <p>DBMS_AQ.DEQUEUE</p>
                                 </td>
                                 <td align="left" valign="top" width="55%" headers="d123500e4798 d123500e4785 ">
                                    <p><code class="codeph">OCIAQDeq()</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="45%" id="d123500e4806" headers="d123500e4782 ">
                                    <p>DBMS_AQ.LISTEN</p>
                                 </td>
                                 <td align="left" valign="top" width="55%" headers="d123500e4806 d123500e4785 ">
                                    <p><code class="codeph">OCIAQListen(), OCIAQListen2()</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="45%" id="d123500e4814" headers="d123500e4782 ">
                                    <p>DBMS_AQ.ENQUEUE_ARRAY</p>
                                 </td>
                                 <td align="left" valign="top" width="55%" headers="d123500e4814 d123500e4785 ">
                                    <p><code class="codeph">OCIAQEnqArray()</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="45%" id="d123500e4822" headers="d123500e4782 ">
                                    <p>DBMS_AQ.DEQUEUE_ARRAY</p>
                                 </td>
                                 <td align="left" valign="top" width="55%" headers="d123500e4822 d123500e4785 ">
                                    <p><code class="codeph">OCIAQDeqArray()</code></p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <div class="section">
                        <p><a href="notification-streams-advanced-queuing.html#GUID-BB00AF24-95F4-4BE5-A4BE-DA9C6004F1A3__CACBJFAJ" title="This table is described by 2 columns. Column 1 is the DBMS_AQ.ENQUEUE parameter and column 2 is its equivalent OCIAQEnq() parameter.">Table 13-3</a> compares the parameters for the enqueue functions.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="tblformal" id="GUID-BB00AF24-95F4-4BE5-A4BE-DA9C6004F1A3__CACBJFAJ">
                        <p class="titleintable">Table 13-3 Enqueue Parameters </p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="Enqueue Parameters " summary="This table is described by 2 columns. Column 1 is the DBMS_AQ.ENQUEUE parameter and column 2 is its equivalent OCIAQEnq() parameter. " width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="39%" id="d123500e4846">DBMS_AQ.ENQUEUE Parameter</th>
                                 <th align="left" valign="bottom" width="61%" id="d123500e4849">OCIAQEnq() Parameter</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="39%" id="d123500e4854" headers="d123500e4846 "><pre class="oac_no_warn" dir="ltr">queue_name</pre></td>
                                 <td align="left" valign="top" width="61%" headers="d123500e4854 d123500e4849 "><pre class="oac_no_warn" dir="ltr">queue_name</pre></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="39%" id="d123500e4861" headers="d123500e4846 "><pre class="oac_no_warn" dir="ltr">enqueue_options</pre></td>
                                 <td align="left" valign="top" width="61%" headers="d123500e4861 d123500e4849 "><pre class="oac_no_warn" dir="ltr">enqueue_options</pre></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="39%" id="d123500e4868" headers="d123500e4846 "><pre class="oac_no_warn" dir="ltr">message_properties</pre></td>
                                 <td align="left" valign="top" width="61%" headers="d123500e4868 d123500e4849 "><pre class="oac_no_warn" dir="ltr">message_properties</pre></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="39%" id="d123500e4875" headers="d123500e4846 "><pre class="oac_no_warn" dir="ltr">payload</pre></td>
                                 <td align="left" valign="top" width="61%" headers="d123500e4875 d123500e4849 "><pre class="oac_no_warn" dir="ltr">payload</pre></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="39%" id="d123500e4882" headers="d123500e4846 "><pre class="oac_no_warn" dir="ltr">msgid</pre></td>
                                 <td align="left" valign="top" width="61%" headers="d123500e4882 d123500e4849 "><pre class="oac_no_warn" dir="ltr">msgid</pre></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="39%" id="d123500e4889" headers="d123500e4846 ">
                                    <p>-</p>
                                 </td>
                                 <td align="left" valign="top" width="61%" headers="d123500e4889 d123500e4849 ">
                                    <p>Note: <code class="codeph">OCIAQEnq()</code> requires the following additional parameters: <code class="codeph">svch</code><code class="codeph">, </code><code class="codeph">errh, payload_tdo, payload_ind</code><code class="codeph">, and </code><code class="codeph">flags</code>.
                                    </p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <div class="section">
                        <p><a href="notification-streams-advanced-queuing.html#GUID-BB00AF24-95F4-4BE5-A4BE-DA9C6004F1A3__CACIEGEG" title="This table is described by 2 columns. Column 1 is the DBMS_AQ.DEQUEUE parameter and column 2 is its equivalent OCIAQDeq() parameter.">Table 13-4</a> compares the parameters for the dequeue functions.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="tblformal" id="GUID-BB00AF24-95F4-4BE5-A4BE-DA9C6004F1A3__CACIEGEG">
                        <p class="titleintable">Table 13-4 Dequeue Parameters </p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="Dequeue Parameters " summary="This table is described by 2 columns. Column 1 is the DBMS_AQ.DEQUEUE parameter and column 2 is its equivalent OCIAQDeq() parameter. " width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="39%" id="d123500e4926">DBMS_AQ.DEQUEUE Parameter</th>
                                 <th align="left" valign="bottom" width="61%" id="d123500e4929">OCIAQDeq() Parameter</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="39%" id="d123500e4934" headers="d123500e4926 "><pre class="oac_no_warn" dir="ltr">queue_name</pre></td>
                                 <td align="left" valign="top" width="61%" headers="d123500e4934 d123500e4929 "><pre class="oac_no_warn" dir="ltr">queue_name</pre></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="39%" id="d123500e4941" headers="d123500e4926 "><pre class="oac_no_warn" dir="ltr">dequeue_options</pre></td>
                                 <td align="left" valign="top" width="61%" headers="d123500e4941 d123500e4929 "><pre class="oac_no_warn" dir="ltr">dequeue_options</pre></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="39%" id="d123500e4948" headers="d123500e4926 "><pre class="oac_no_warn" dir="ltr">message_properties</pre></td>
                                 <td align="left" valign="top" width="61%" headers="d123500e4948 d123500e4929 "><pre class="oac_no_warn" dir="ltr">message_properties</pre></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="39%" id="d123500e4955" headers="d123500e4926 "><pre class="oac_no_warn" dir="ltr">payload</pre></td>
                                 <td align="left" valign="top" width="61%" headers="d123500e4955 d123500e4929 "><pre class="oac_no_warn" dir="ltr">payload</pre></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="39%" id="d123500e4962" headers="d123500e4926 "><pre class="oac_no_warn" dir="ltr">msgid</pre></td>
                                 <td align="left" valign="top" width="61%" headers="d123500e4962 d123500e4929 "><pre class="oac_no_warn" dir="ltr">msgid</pre></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="39%" id="d123500e4969" headers="d123500e4926 ">
                                    <p>-</p>
                                 </td>
                                 <td align="left" valign="top" width="61%" headers="d123500e4969 d123500e4929 ">
                                    <p>Note: <code class="codeph">OCIAQDeq()</code> requires the following additional parameters: <code class="codeph">svch</code><code class="codeph">, </code><code class="codeph">errh, dequeue_options, message_properties, payload_tdo, payload, payload_ind</code><code class="codeph">, and </code><code class="codeph">flags</code>.
                                    </p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <div class="section">
                        <p><a href="notification-streams-advanced-queuing.html#GUID-BB00AF24-95F4-4BE5-A4BE-DA9C6004F1A3__CACCCDID" title="This table is described by 2 columns. Column 1 is the DBMS_AQ.LISTEN parameter and column 2 is its equivalent OCIAQListen2() parameter.">Table 13-5</a> compares parameters for the listen functions.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="tblformal" id="GUID-BB00AF24-95F4-4BE5-A4BE-DA9C6004F1A3__CACCCDID">
                        <p class="titleintable">Table 13-5 Listen Parameters </p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="Listen Parameters " summary="This table is described by 2 columns. Column 1 is the DBMS_AQ.LISTEN parameter and column 2 is its equivalent OCIAQListen2() parameter. " width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="39%" id="d123500e5006">DBMS_AQ.LISTEN Parameter</th>
                                 <th align="left" valign="bottom" width="61%" id="d123500e5009">OCIAQListen2() Parameter</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="39%" id="d123500e5014" headers="d123500e5006 "><pre class="oac_no_warn" dir="ltr">agent_list</pre></td>
                                 <td align="left" valign="top" width="61%" headers="d123500e5014 d123500e5009 "><pre class="oac_no_warn" dir="ltr">agent_list</pre></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="39%" id="d123500e5021" headers="d123500e5006 "><pre class="oac_no_warn" dir="ltr">wait</pre></td>
                                 <td align="left" valign="top" width="61%" headers="d123500e5021 d123500e5009 "><pre class="oac_no_warn" dir="ltr">wait</pre></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="39%" id="d123500e5028" headers="d123500e5006 "><pre class="oac_no_warn" dir="ltr">agent</pre></td>
                                 <td align="left" valign="top" width="61%" headers="d123500e5028 d123500e5009 "><pre class="oac_no_warn" dir="ltr">agent</pre></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="39%" id="d123500e5035" headers="d123500e5006 "><pre class="oac_no_warn" dir="ltr">listen_delivery_mode</pre></td>
                                 <td align="left" valign="top" width="61%" headers="d123500e5035 d123500e5009 ">
                                    <p><code class="codeph">lopts</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="39%" id="d123500e5043" headers="d123500e5006 ">
                                    <p>-</p>
                                 </td>
                                 <td align="left" valign="top" width="61%" headers="d123500e5043 d123500e5009 ">
                                    <p>Note: <code class="codeph">OCIAQListen2()</code> requires the following additional parameters: <code class="codeph">svchp, errhp, agent_list, num_agents, agent</code><code class="codeph">, lmops, and </code><code class="codeph">flags</code>.
                                    </p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <div class="section">
                        <p><a href="notification-streams-advanced-queuing.html#GUID-BB00AF24-95F4-4BE5-A4BE-DA9C6004F1A3__CACGGDAF" title="This table is described by 2 columns. Column 1 is the DBMS_AQ.ENQUEUE_ARRAY parameter and column 2 is its equivalent OCIAQEnqArray() parameter.">Table 13-6</a> compares parameters for the array enqueue functions.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="tblformal" id="GUID-BB00AF24-95F4-4BE5-A4BE-DA9C6004F1A3__CACGGDAF">
                        <p class="titleintable">Table 13-6 Array Enqueue Parameters </p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="Array Enqueue Parameters " summary="This table is described by 2 columns. Column 1 is the DBMS_AQ.ENQUEUE_ARRAY parameter and column 2 is its equivalent OCIAQEnqArray() parameter. " width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="47%" id="d123500e5076">DBMS_AQ.ENQUEUE_ARRAY Parameter</th>
                                 <th align="left" valign="bottom" width="53%" id="d123500e5079">OCIAQEnqArray() Parameter</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="47%" id="d123500e5084" headers="d123500e5076 "><pre class="oac_no_warn" dir="ltr">queue_name</pre></td>
                                 <td align="left" valign="top" width="53%" headers="d123500e5084 d123500e5079 "><pre class="oac_no_warn" dir="ltr">queue_name</pre></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="47%" id="d123500e5091" headers="d123500e5076 "><pre class="oac_no_warn" dir="ltr">enqueue_options</pre></td>
                                 <td align="left" valign="top" width="53%" headers="d123500e5091 d123500e5079 "><pre class="oac_no_warn" dir="ltr">enqopt</pre></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="47%" id="d123500e5098" headers="d123500e5076 "><pre class="oac_no_warn" dir="ltr">array_size</pre></td>
                                 <td align="left" valign="top" width="53%" headers="d123500e5098 d123500e5079 "><pre class="oac_no_warn" dir="ltr">iters</pre></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="47%" id="d123500e5105" headers="d123500e5076 "><pre class="oac_no_warn" dir="ltr">message_properties_array</pre></td>
                                 <td align="left" valign="top" width="53%" headers="d123500e5105 d123500e5079 "><pre class="oac_no_warn" dir="ltr">msgprop</pre></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="47%" id="d123500e5112" headers="d123500e5076 "><pre class="oac_no_warn" dir="ltr">payload_array</pre></td>
                                 <td align="left" valign="top" width="53%" headers="d123500e5112 d123500e5079 "><pre class="oac_no_warn" dir="ltr">payload</pre></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="47%" id="d123500e5119" headers="d123500e5076 "><pre class="oac_no_warn" dir="ltr">msgid_array</pre></td>
                                 <td align="left" valign="top" width="53%" headers="d123500e5119 d123500e5079 "><pre class="oac_no_warn" dir="ltr">msgid</pre></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="47%" id="d123500e5126" headers="d123500e5076 ">
                                    <p>-</p>
                                 </td>
                                 <td align="left" valign="top" width="53%" headers="d123500e5126 d123500e5079 ">
                                    <p>Note: <code class="codeph">OCIAQEnqArray()</code> requires the following additional parameters: <code class="codeph">svch</code><code class="codeph">, </code><code class="codeph">errh, payload_tdo, payload_ind, ctxp, enqcbfp,</code> <code class="codeph">and </code><code class="codeph">flags</code>.
                                    </p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <div class="section">
                        <p><a href="notification-streams-advanced-queuing.html#GUID-BB00AF24-95F4-4BE5-A4BE-DA9C6004F1A3__CACFHBEI" title="This table is described by 2 columns. Column 1 is the DBMS_AQ.DEQUEUE_ARRAY parameter and column 2 is its equivalent OCIAQDeqArray() parameter.">Table 13-7</a> compares parameters for the array dequeue functions.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="tblformal" id="GUID-BB00AF24-95F4-4BE5-A4BE-DA9C6004F1A3__CACFHBEI">
                        <p class="titleintable">Table 13-7 Array Dequeue Parameters </p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="Array Dequeue Parameters " summary="This table is described by 2 columns. Column 1 is the DBMS_AQ.DEQUEUE_ARRAY parameter and column 2 is its equivalent OCIAQDeqArray() parameter. " width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="47%" id="d123500e5165">DBMS_AQ.DEQUEUE_ARRAY Parameter</th>
                                 <th align="left" valign="bottom" width="53%" id="d123500e5168">OCIAQDeqArray() Parameter</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="47%" id="d123500e5173" headers="d123500e5165 "><pre class="oac_no_warn" dir="ltr">queue_name</pre></td>
                                 <td align="left" valign="top" width="53%" headers="d123500e5173 d123500e5168 "><pre class="oac_no_warn" dir="ltr">queue_name</pre></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="47%" id="d123500e5180" headers="d123500e5165 "><pre class="oac_no_warn" dir="ltr">dequeue_options</pre></td>
                                 <td align="left" valign="top" width="53%" headers="d123500e5180 d123500e5168 "><pre class="oac_no_warn" dir="ltr">deqopt</pre></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="47%" id="d123500e5187" headers="d123500e5165 "><pre class="oac_no_warn" dir="ltr">array_size</pre></td>
                                 <td align="left" valign="top" width="53%" headers="d123500e5187 d123500e5168 "><pre class="oac_no_warn" dir="ltr">iters</pre></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="47%" id="d123500e5194" headers="d123500e5165 "><pre class="oac_no_warn" dir="ltr">message_properties_array</pre></td>
                                 <td align="left" valign="top" width="53%" headers="d123500e5194 d123500e5168 "><pre class="oac_no_warn" dir="ltr">msgprop</pre></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="47%" id="d123500e5201" headers="d123500e5165 "><pre class="oac_no_warn" dir="ltr">payload_array</pre></td>
                                 <td align="left" valign="top" width="53%" headers="d123500e5201 d123500e5168 "><pre class="oac_no_warn" dir="ltr">payload</pre></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="47%" id="d123500e5208" headers="d123500e5165 "><pre class="oac_no_warn" dir="ltr">msgid_array</pre></td>
                                 <td align="left" valign="top" width="53%" headers="d123500e5208 d123500e5168 "><pre class="oac_no_warn" dir="ltr">msgid</pre></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="47%" id="d123500e5215" headers="d123500e5165 ">
                                    <p>-</p>
                                 </td>
                                 <td align="left" valign="top" width="53%" headers="d123500e5215 d123500e5168 ">
                                    <p>Note: <code class="codeph">OCIAQDeqArray()</code> requires the following additional parameters: <code class="codeph">svch</code><code class="codeph">, </code><code class="codeph">errh,</code><code class="codeph"> </code><code class="codeph">msgprop, payload_tdo, payload_ind, ctxp, deqcbfp,</code><code class="codeph"> and </code><code class="codeph">flags</code>.
                                    </p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <div class="section">
                        <p><a href="notification-streams-advanced-queuing.html#GUID-BB00AF24-95F4-4BE5-A4BE-DA9C6004F1A3__CACJHHDB" title="This table is described by 2 columns. Column 1 is the PL/SQL Agent property and column 2 is its equivalent OCIAQAgent attribute.">Table 13-8</a> compares parameters for the agent attributes.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="tblformal" id="GUID-BB00AF24-95F4-4BE5-A4BE-DA9C6004F1A3__CACJHHDB">
                        <p class="titleintable">Table 13-8 Agent Parameters </p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="Agent Parameters " summary="This table is described by 2 columns. Column 1 is the PL/SQL Agent property and column 2 is its equivalent OCIAQAgent attribute." width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="48%" id="d123500e5256">PL/SQL Agent Parameter</th>
                                 <th align="left" valign="bottom" width="52%" id="d123500e5259">OCIAQAgent Attribute</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="48%" id="d123500e5264" headers="d123500e5256 "><pre class="oac_no_warn" dir="ltr">name</pre></td>
                                 <td align="left" valign="top" width="52%" headers="d123500e5264 d123500e5259 ">
                                    <p><code class="codeph">OCI_ATTR_AGENT_NAME</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="48%" id="d123500e5272" headers="d123500e5256 "><pre class="oac_no_warn" dir="ltr">address</pre></td>
                                 <td align="left" valign="top" width="52%" headers="d123500e5272 d123500e5259 ">
                                    <p><code class="codeph">OCI_ATTR_AGENT_ADDRESS</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="48%" id="d123500e5280" headers="d123500e5256 "><pre class="oac_no_warn" dir="ltr">protocol</pre></td>
                                 <td align="left" valign="top" width="52%" headers="d123500e5280 d123500e5259 ">
                                    <p><code class="codeph">OCI_ATTR_AGENT_PROTOCOL</code></p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <div class="section">
                        <p><a href="notification-streams-advanced-queuing.html#GUID-BB00AF24-95F4-4BE5-A4BE-DA9C6004F1A3__CACJGGBC" title="This table is described by 2 columns. Column 1 is the PL/SQL Message property and column 2 is its equivalent OCIAQMsgProperties attribute.">Table 13-9</a> compares parameters for the message properties.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="tblformal" id="GUID-BB00AF24-95F4-4BE5-A4BE-DA9C6004F1A3__CACJGGBC">
                        <p class="titleintable">Table 13-9 Message Properties </p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="Message Properties " summary="This table is described by 2 columns. Column 1 is the PL/SQL Message property and column 2 is its equivalent OCIAQMsgProperties attribute." width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="47%" id="d123500e5304">PL/SQL Message Property</th>
                                 <th align="left" valign="bottom" width="53%" id="d123500e5307">OCIAQMsgProperties Attribute</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="47%" id="d123500e5312" headers="d123500e5304 "><pre class="oac_no_warn" dir="ltr">priority</pre></td>
                                 <td align="left" valign="top" width="53%" headers="d123500e5312 d123500e5307 ">
                                    <p><code class="codeph">OCI_ATTR_PRIORITY</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="47%" id="d123500e5320" headers="d123500e5304 "><pre class="oac_no_warn" dir="ltr">delay</pre></td>
                                 <td align="left" valign="top" width="53%" headers="d123500e5320 d123500e5307 ">
                                    <p><code class="codeph">OCI_ATTR_DELAY</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="47%" id="d123500e5328" headers="d123500e5304 "><pre class="oac_no_warn" dir="ltr">expiration</pre></td>
                                 <td align="left" valign="top" width="53%" headers="d123500e5328 d123500e5307 ">
                                    <p><code class="codeph">OCI_ATTR_EXPIRATION</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="47%" id="d123500e5336" headers="d123500e5304 "><pre class="oac_no_warn" dir="ltr">correlation</pre></td>
                                 <td align="left" valign="top" width="53%" headers="d123500e5336 d123500e5307 ">
                                    <p><code class="codeph">OCI_ATTR_CORRELATION</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="47%" id="d123500e5344" headers="d123500e5304 "><pre class="oac_no_warn" dir="ltr">attempts</pre></td>
                                 <td align="left" valign="top" width="53%" headers="d123500e5344 d123500e5307 ">
                                    <p><code class="codeph">OCI_ATTR_ATTEMPTS</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="47%" id="d123500e5352" headers="d123500e5304 "><pre class="oac_no_warn" dir="ltr">recipient_list</pre></td>
                                 <td align="left" valign="top" width="53%" headers="d123500e5352 d123500e5307 ">
                                    <p><code class="codeph">OCI_ATTR_RECIPIENT_LIST</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="47%" id="d123500e5360" headers="d123500e5304 "><pre class="oac_no_warn" dir="ltr">exception_queue</pre></td>
                                 <td align="left" valign="top" width="53%" headers="d123500e5360 d123500e5307 ">
                                    <p><code class="codeph">OCI_ATTR_EXCEPTION_QUEUE</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="47%" id="d123500e5368" headers="d123500e5304 "><pre class="oac_no_warn" dir="ltr">enqueue_time</pre></td>
                                 <td align="left" valign="top" width="53%" headers="d123500e5368 d123500e5307 ">
                                    <p><code class="codeph">OCI_ATTR_ENQ_TIME</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="47%" id="d123500e5376" headers="d123500e5304 "><pre class="oac_no_warn" dir="ltr">state</pre></td>
                                 <td align="left" valign="top" width="53%" headers="d123500e5376 d123500e5307 ">
                                    <p><code class="codeph">OCI_ATTR_MSG_STATE</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="47%" id="d123500e5384" headers="d123500e5304 "><pre class="oac_no_warn" dir="ltr">sender_id</pre></td>
                                 <td align="left" valign="top" width="53%" headers="d123500e5384 d123500e5307 ">
                                    <p><code class="codeph">OCI_ATTR_SENDER_ID</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="47%" id="d123500e5392" headers="d123500e5304 "><pre class="oac_no_warn" dir="ltr">transaction_group</pre></td>
                                 <td align="left" valign="top" width="53%" headers="d123500e5392 d123500e5307 ">
                                    <p><code class="codeph">OCI_ATTR_TRANSACTION_NO</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="47%" id="d123500e5401" headers="d123500e5304 "><pre class="oac_no_warn" dir="ltr">original_msgid</pre></td>
                                 <td align="left" valign="top" width="53%" headers="d123500e5401 d123500e5307 ">
                                    <p><code class="codeph">OCI_ATTR_ORIGINAL_MSGID</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="47%" id="d123500e5409" headers="d123500e5304 "><pre class="oac_no_warn" dir="ltr">delivery_mode</pre></td>
                                 <td align="left" valign="top" width="53%" headers="d123500e5409 d123500e5307 ">
                                    <p><code class="codeph">OCI_ATTR_MSG_DELIVERY_MODE</code></p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <div class="section">
                        <p><a href="notification-streams-advanced-queuing.html#GUID-BB00AF24-95F4-4BE5-A4BE-DA9C6004F1A3__CACFFHAH" title="This table is described by 2 columns. Column 1 is the PL/SQL Enqueue option and column 2 is its equivalent OCIAQEnqOptions attribute.">Table 13-10</a> compares enqueue option attributes.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="tblformal" id="GUID-BB00AF24-95F4-4BE5-A4BE-DA9C6004F1A3__CACFFHAH">
                        <p class="titleintable">Table 13-10 Enqueue Option Attributes </p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="Enqueue Option Attributes " summary="This table is described by 2 columns. Column 1 is the PL/SQL Enqueue option and column 2 is its equivalent OCIAQEnqOptions attribute." width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="46%" id="d123500e5433">PL/SQL Enqueue Option</th>
                                 <th align="left" valign="bottom" width="54%" id="d123500e5436">OCIAQEnqOptions Attribute</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="46%" id="d123500e5441" headers="d123500e5433 "><pre class="oac_no_warn" dir="ltr">visibility</pre></td>
                                 <td align="left" valign="top" width="54%" headers="d123500e5441 d123500e5436 ">
                                    <p><code class="codeph">OCI_ATTR_VISIBILITY</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="46%" id="d123500e5449" headers="d123500e5433 "><pre class="oac_no_warn" dir="ltr">relative_msgid</pre></td>
                                 <td align="left" valign="top" width="54%" headers="d123500e5449 d123500e5436 ">
                                    <p><code class="codeph">OCI_ATTR_RELATIVE_MSGID</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="46%" id="d123500e5457" headers="d123500e5433 "><pre class="oac_no_warn" dir="ltr">sequence_deviation</pre></td>
                                 <td align="left" valign="top" width="54%" headers="d123500e5457 d123500e5436 ">
                                    <p><code class="codeph">OCI_ATTR_SEQUENCE_DEVIATION</code></p>
                                    <p>(deprecated)</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="46%" id="d123500e5467" headers="d123500e5433 ">
                                    <p><code class="codeph">transformation</code></p>
                                 </td>
                                 <td align="left" valign="top" width="54%" headers="d123500e5467 d123500e5436 ">
                                    <p><code class="codeph">OCI_ATTR_TRANSFORMATION</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="46%" id="d123500e5476" headers="d123500e5433 "><pre class="oac_no_warn" dir="ltr">delivery_mode</pre></td>
                                 <td align="left" valign="top" width="54%" headers="d123500e5476 d123500e5436 ">
                                    <p><code class="codeph">OCI_ATTR_MSG_DELIVERY_MODE</code></p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <div class="section">
                        <p><a href="notification-streams-advanced-queuing.html#GUID-BB00AF24-95F4-4BE5-A4BE-DA9C6004F1A3__CACEAIFB" title="This table is described by 2 columns. Column 1 is the PL/SQL Dequeue option and column 2 is its equivalent OCIAQDeqOptions attribute.">Table 13-11</a> compares dequeue option attributes.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="tblformal" id="GUID-BB00AF24-95F4-4BE5-A4BE-DA9C6004F1A3__CACEAIFB">
                        <p class="titleintable">Table 13-11 Dequeue Option Attributes </p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="Dequeue Option Attributes " summary="This table is described by 2 columns. Column 1 is the PL/SQL Dequeue option and column 2 is its equivalent OCIAQDeqOptions attribute." width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="47%" id="d123500e5500">PL/SQL Dequeue Option</th>
                                 <th align="left" valign="bottom" width="53%" id="d123500e5503">OCIAQDeqOptions Attribute</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="47%" id="d123500e5508" headers="d123500e5500 "><pre class="oac_no_warn" dir="ltr">consumer_name</pre></td>
                                 <td align="left" valign="top" width="53%" headers="d123500e5508 d123500e5503 ">
                                    <p><code class="codeph">OCI_ATTR_CONSUMER_NAME</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="47%" id="d123500e5516" headers="d123500e5500 "><pre class="oac_no_warn" dir="ltr">dequeue_mode</pre></td>
                                 <td align="left" valign="top" width="53%" headers="d123500e5516 d123500e5503 ">
                                    <p><code class="codeph">OCI_ATTR_DEQ_MODE</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="47%" id="d123500e5524" headers="d123500e5500 "><pre class="oac_no_warn" dir="ltr">navigation</pre></td>
                                 <td align="left" valign="top" width="53%" headers="d123500e5524 d123500e5503 ">
                                    <p><code class="codeph">OCI_ATTR_NAVIGATION</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="47%" id="d123500e5532" headers="d123500e5500 "><pre class="oac_no_warn" dir="ltr">visibility</pre></td>
                                 <td align="left" valign="top" width="53%" headers="d123500e5532 d123500e5503 ">
                                    <p><code class="codeph">OCI_ATTR_VISIBILITY</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="47%" id="d123500e5540" headers="d123500e5500 "><pre class="oac_no_warn" dir="ltr">wait</pre></td>
                                 <td align="left" valign="top" width="53%" headers="d123500e5540 d123500e5503 ">
                                    <p><code class="codeph">OCI_ATTR_WAIT</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="47%" id="d123500e5548" headers="d123500e5500 "><pre class="oac_no_warn" dir="ltr">msgid</pre></td>
                                 <td align="left" valign="top" width="53%" headers="d123500e5548 d123500e5503 ">
                                    <p><code class="codeph">OCI_ATTR_DEQ_MSGID</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="47%" id="d123500e5556" headers="d123500e5500 "><pre class="oac_no_warn" dir="ltr">correlation</pre></td>
                                 <td align="left" valign="top" width="53%" headers="d123500e5556 d123500e5503 ">
                                    <p><code class="codeph">OCI_ATTR_CORRELATION</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="47%" id="d123500e5564" headers="d123500e5500 ">
                                    <p><code class="codeph">deq_condition</code></p>
                                 </td>
                                 <td align="left" valign="top" width="53%" headers="d123500e5564 d123500e5503 ">
                                    <p><code class="codeph">OCI_ATTR_DEQCOND</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="47%" id="d123500e5573" headers="d123500e5500 ">
                                    <p><code class="codeph">transformation</code></p>
                                 </td>
                                 <td align="left" valign="top" width="53%" headers="d123500e5573 d123500e5503 ">
                                    <p><code class="codeph">OCI_ATTR_TRANSFORMATION</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="47%" id="d123500e5582" headers="d123500e5500 "><pre class="oac_no_warn" dir="ltr">delivery_mode</pre></td>
                                 <td align="left" valign="top" width="53%" headers="d123500e5582 d123500e5503 ">
                                    <p><code class="codeph">OCI_ATTR_MSG_DELIVERY_MODE</code></p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <div class="section">
                        <div class="infoboxnote" id="GUID-BB00AF24-95F4-4BE5-A4BE-DA9C6004F1A3__GUID-B3E7CE42-2DE9-4687-B921-2A9C8A18F6B8">
                           <p class="notep1">Note:</p>
                           <p><code class="codeph">OCIAQEnq()</code> returns the error <code class="codeph">ORA-25219</code> while specifying the enqueue option <code class="codeph">OCI_ATTR_SEQUENCE</code> along with <code class="codeph">OCI_ATTR_RELATIVE_MSGID.</code> This happens when enqueuing two messages. For the second message, enqueue options <code class="codeph">OCI_ATTR_SEQUENCE</code> and <code class="codeph">OCI_ATTR_RELATIVE_MSGID</code> are set to dequeue this message before the first one. An error is not returned if you do not specify the sequence but, of course, the message is not dequeued before the relative message.
                           </p>
                           <p><code class="codeph">OCIAQEnq()</code> does not return an error if the <code class="codeph">OCI_ATTR_SEQUENCE</code> attribute is not set, but the message is not dequeued before the message with relative message ID.
                           </p>
                        </div>
                        <div class="infoboxnotealso" id="GUID-BB00AF24-95F4-4BE5-A4BE-DA9C6004F1A3__GUID-A127E45B-016A-47D0-A48C-9F580595B45F">
                           <p class="notep1">See Also:</p>
                           <p><a href="streams-advanced-queueing-and-publish-subscribe-functions.html#GUID-AE3DB345-0A77-4922-ABBD-FBBFB6E1A9B4" title="Performs an enqueue operation using Database Advanced Queuing.">OCIAQEnq()</a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="props_rev_2"><a id="GUID-145D489F-52D8-4D41-8319-EF1ACA19B7AD" name="GUID-145D489F-52D8-4D41-8319-EF1ACA19B7AD"></a><h4 id="LNOCI-GUID-145D489F-52D8-4D41-8319-EF1ACA19B7AD" class="sect4"><span class="enumeration_section">13.3.4 </span>Using Buffered Messaging
                  </h4>
                  <div>
                     <p>Buffered messaging is a nonpersistent messaging capability within Database
      AQ that was first available in Oracle Database 10<span class="italic">g</span> Release 2.
                     </p>
                     <div class="section">
                        <p> Buffered messages reside in shared memory and can be lost if there is an instance failure. Unlike persistent messages, redo does not get written to disk. Buffered message enqueue and dequeue is much faster than persistent message operations. Because shared memory is limited, buffered messages may have to be spilled to disk. Flow control can be enabled to prevent applications from flooding the shared memory when the message consumers are slow or have stopped for some reason. The following functions are used for buffered messaging:</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><code class="codeph">OCIAQEnq()</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">OCIAQDeq()</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">OCIAQListen2()</code></p>
                           </li>
                        </ul>
                        <p><a href="notification-streams-advanced-queuing.html#GUID-145D489F-52D8-4D41-8319-EF1ACA19B7AD__CACBCHCE">Example 13-6</a> shows an example of enqueue buffered messaging. 
                        </p>
                        <p><a href="notification-streams-advanced-queuing.html#GUID-145D489F-52D8-4D41-8319-EF1ACA19B7AD__CACJHBEE">Example 13-7</a> shows an example of dequeue buffered messaging.
                        </p>
                        <div class="infoboxnote" id="GUID-145D489F-52D8-4D41-8319-EF1ACA19B7AD__GUID-104265C9-6D47-46B1-BE21-F757E931B5B3">
                           <p class="notep1">Note:</p>
                           <p>Array operations are not supported for buffered messaging. Applications can use the <code class="codeph">OCIAQEnqArray()</code> and <code class="codeph">OCIAQDeqArray()</code> functions with the array size set to 1.
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-145D489F-52D8-4D41-8319-EF1ACA19B7AD__CACBCHCE">
                        <p class="titleinexample">Example 13-6 Enqueue Buffered Messaging</p><pre class="oac_no_warn" dir="ltr">...
OCIAQMsgProperties  *msgprop;
OCIAQEnqueueOptions *enqopt;
message              msg;    /* message is an object type */
null_message         nmsg;   /* message indicator */
...
/* Allocate descriptors */
  OCIDescriptorAlloc(envhp, (void **)&amp;enqopt, OCI_DTYPE_AQENQ_OPTIONS, 0,
                     (void **)0));
 
 OCIDescriptorAlloc(envhp, (void **)&amp;msgprop,OCI_DTYPE_AQMSG_PROPERTIES, 0,
                    (void **)0));
 
/* Set delivery mode to buffered */
 dlvm = OCI_MSG_BUFFERED;
 OCIAttrSet(enqopt,  OCI_DTYPE_AQENQ_OPTIONS, (void *)&amp;dlvm, sizeof(ub2),
            OCI_ATTR_MSG_DELIVERY_MODE, errhp);
/* Set visibility to Immediate (visibility must always be immediate for buffered
   messages) */
vis = OCI_ENQ_ON_COMMIT;
 
OCIAttrSet(enqopt, OCI_DTYPE_AQENQ_OPTIONS,(void *)&amp;vis, sizeof(ub4),
           OCI_ATTR_VISIBILITY, errhp)
 
/* Message was an object type created earlier, msg_tdo is its type
   descriptor object */
OCIAQEnq(svchp, errhp, "Test_Queue", enqopt, msgprop, msg_tdo, (void **)&amp;mesg,
         (void **)&amp;nmesg, (OCIRaw **)0, 0));
...
</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-145D489F-52D8-4D41-8319-EF1ACA19B7AD__CACJHBEE">
                        <p class="titleinexample">Example 13-7 Dequeue Buffered Messaging</p><pre class="oac_no_warn" dir="ltr">...
OCIAQMsgProperties  *msgprop;
OCIAQDequeueOptions *deqopt;
...
OCIDescriptorAlloc(envhp, (void **)&amp;mprop, OCI_DTYPE_AQMSG_PROPERTIES, 0,
                   (void **)0));
OCIDescriptorAlloc(envhp, (void **)&amp;deqopt, OCI_DTYPE_AQDEQ_OPTIONS, 0,
                   (void **)0);

/* Set visibility to Immediate (visibility must always be immediate for buffered
   message operations) */
vis = OCI_ENQ_ON_COMMIT;
OCIAttrSet(deqopt, OCI_DTYPE_AQDEQ_OPTIONS,(void *)&amp;vis, sizeof(ub4),
           OCI_ATTR_VISIBILITY, errhp)
/* delivery mode is buffered */
dlvm  = OCI_MSG_BUFFERED;
OCIAttrSet(deqopt, OCI_DTYPE_AQDEQ_OPTIONS, (void *)&amp;dlvm,  sizeof(ub2),
           OCI_ATTR_MSG_DELIVERY_MODE, errhp);
/* Set the consumer for which to dequeue the message (this must be specified
   regardless of the type of message being dequeued).
*/
consumer = "FIRST_SUBSCRIBER";
OCIAttrSet(deqopt, OCI_DTYPE_AQDEQ_OPTIONS, (void *)consumer,
           (ub4)strlen((char*)consumer), OCI_ATTR_CONSUMER_NAME, errhp);
/* Dequeue the message but do not return the payload (to simplify the code
   fragment)
*/
OCIAQDeq(svchp, errhp,  "test_queue", deqopt, msgprop, msg_tdo, (void **)0,
         (void **)0, (OCIRaw**)0, 0);
...</pre></div>
                     <!-- class="example" -->
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-145D489F-52D8-4D41-8319-EF1ACA19B7AD__GUID-E5BA0F0C-AD8B-486E-8A15-EABEACB71509">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><a href="streams-advanced-queueing-and-publish-subscribe-functions.html#GUID-AE3DB345-0A77-4922-ABBD-FBBFB6E1A9B4" title="Performs an enqueue operation using Database Advanced Queuing.">OCIAQEnq()</a></p>
                              </li>
                              <li>
                                 <p><a href="streams-advanced-queueing-and-publish-subscribe-functions.html#GUID-982A4127-C23A-43E6-94CE-D3F76EC4553C">OCIAQDeq()</a></p>
                              </li>
                              <li>
                                 <p><a href="streams-advanced-queueing-and-publish-subscribe-functions.html#GUID-499ECEF6-F447-46C5-8F3F-48DE66839BD1" title="Listens on one or more queues on behalf of a list of agents.">OCIAQListen2()</a></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>