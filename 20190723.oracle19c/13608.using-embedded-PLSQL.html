<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>Using Embedded PL/SQL</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Programmer's Guide to the Oracle Precompilers">
      <meta property="og:description" content="">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Programmer's Guide to the Oracle Precompilers">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="programmers-guide-oracle-precompilers.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-01-11T01:36:30-08:00">
      <meta name="dcterms.title" content="Programmer's Guide to the Oracle Precompilers">
      <meta name="dcterms.dateCopyrighted" content="2008, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96474-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="using-embedded-SQL.html" title="Previous" type="text/html">
      <link rel="next" href="running-Oracle-precompilers.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="ZZPRE">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="using-embedded-SQL.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="running-Oracle-precompilers.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Programmer's Guide to the Oracle Precompilers</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem"> Using Embedded PL/SQL</li>
            </ol>
            <a id="GUID-F6E58CB5-C25B-47EE-B349-314F28961A56" name="GUID-F6E58CB5-C25B-47EE-B349-314F28961A56"></a><a id="ZZPRE294"></a>
            
            <h2 id="ZZPRE-GUID-F6E58CB5-C25B-47EE-B349-314F28961A56" class="sect2"><span class="enumeration_chapter">5 </span> Using Embedded PL/SQL
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>This chapter contains the following sections:</p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p><a href="using-embedded-PLSQL.html#GUID-16CF8764-4464-488F-9DE0-4FB350C0178B">Advantages of PL/SQL</a></p>
                  </li>
                  <li>
                     <p><a href="using-embedded-PLSQL.html#GUID-EBCAF03F-C7FF-46AC-A944-2C63B3806BE0">About Embedding PL/SQL Blocks</a></p>
                  </li>
                  <li>
                     <p><a href="using-embedded-PLSQL.html#GUID-250ED489-7062-4A68-B664-BB7B0998FA91">About Using Host Variables</a></p>
                  </li>
                  <li>
                     <p><a href="using-embedded-PLSQL.html#GUID-863B7A7D-D21D-45CA-BF20-5796A1AF1CA4">About Using Indicator Variables</a></p>
                  </li>
                  <li>
                     <p><a href="using-embedded-PLSQL.html#GUID-78FCA10C-976A-47A5-A15C-20D9F0F3C368">About Using Host Arrays</a></p>
                  </li>
                  <li>
                     <p><a href="using-embedded-PLSQL.html#GUID-91D74CE0-84E8-4A9C-BF6F-7F3F01B14573">About Using Cursors</a></p>
                  </li>
                  <li>
                     <p><a href="using-embedded-PLSQL.html#GUID-5840297F-2757-465C-8B1D-8C6DFFBBFA20">Stored Subprograms</a></p>
                  </li>
                  <li>
                     <p><a href="using-embedded-PLSQL.html#GUID-0DBFAB55-C488-4C26-AEB3-422132DBB805">About Using Dynamic PL/SQL</a></p>
                  </li>
               </ul>
               <p>This chapter shows you how to improve performance by embedding PL/SQL transaction processing blocks in your program.</p>
            </div><a id="ZZPRE295"></a><div class="props_rev_3"><a id="GUID-16CF8764-4464-488F-9DE0-4FB350C0178B" name="GUID-16CF8764-4464-488F-9DE0-4FB350C0178B"></a><h3 id="ZZPRE-GUID-16CF8764-4464-488F-9DE0-4FB350C0178B" class="sect3"><span class="enumeration_section">5.1 </span>Advantages of PL/SQL
               </h3>
               <div>
                  <p>This section looks at some of the features and benefits offered by PL/SQL, such as</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="using-embedded-PLSQL.html#GUID-6A84B9B2-7C62-403B-B861-3BFD013DC8B4">Better Performance</a></p>
                     </li>
                     <li>
                        <p><a href="using-embedded-PLSQL.html#GUID-58EC6D72-D4E5-4FA9-800B-D2E24996354B">Integration with Oracle</a></p>
                     </li>
                     <li>
                        <p><a href="using-embedded-PLSQL.html#GUID-DA8EE693-725D-465B-AE86-B0BAD366CB53">Cursor FOR Loops</a></p>
                     </li>
                     <li>
                        <p><a href="using-embedded-PLSQL.html#GUID-F00509BC-FD3A-4909-BBE4-767347B95A72">Subprograms</a></p>
                     </li>
                     <li>
                        <p><a href="using-embedded-PLSQL.html#GUID-C7C8C7A0-60FE-4225-9859-088FB87CAEA4">Parameter Modes</a></p>
                     </li>
                     <li>
                        <p><a href="using-embedded-PLSQL.html#GUID-2DCFE2E1-BAE5-4785-B9D2-DBB49FFFAE2F">Packages</a></p>
                     </li>
                     <li>
                        <p><a href="using-embedded-PLSQL.html#GUID-56342726-094C-4997-B03C-BDBA340E3353">PL/SQL Tables</a></p>
                     </li>
                     <li>
                        <p><a href="using-embedded-PLSQL.html#GUID-969ACBD3-10F3-46EC-BEC4-52CFEAF7D22D">User-defined Records</a></p>
                     </li>
                  </ul>
               </div><a id="ZZPRE296"></a><div class="props_rev_3"><a id="GUID-6A84B9B2-7C62-403B-B861-3BFD013DC8B4" name="GUID-6A84B9B2-7C62-403B-B861-3BFD013DC8B4"></a><h4 id="ZZPRE-GUID-6A84B9B2-7C62-403B-B861-3BFD013DC8B4" class="sect4"><span class="enumeration_section">5.1.1 </span>Better Performance
                  </h4>
                  <div>
                     <p>PL/SQL can help you reduce overhead, improve performance, and increase productivity. For example, without PL/SQL, Oracle must process SQL statements one at a time. Each SQL statement results in another call to the Server and consequently, a higher overhead. However, with PL/SQL, you can send an entire block of SQL statements to the Server. This minimizes communication between your application and Oracle.</p>
                  </div>
               </div><a id="ZZPRE297"></a><div class="props_rev_3"><a id="GUID-58EC6D72-D4E5-4FA9-800B-D2E24996354B" name="GUID-58EC6D72-D4E5-4FA9-800B-D2E24996354B"></a><h4 id="ZZPRE-GUID-58EC6D72-D4E5-4FA9-800B-D2E24996354B" class="sect4"><span class="enumeration_section">5.1.2 </span>Integration with Oracle
                  </h4>
                  <div>
                     <p>PL/SQL is tightly integrated with the Oracle Server. For example, most PL/SQL datatypes are native to the Oracle data dictionary. Furthermore, you can use the <a id="d28933e182" class="indexterm-anchor"></a><code class="codeph">%TYPE</code> attribute to base variable declarations on column definitions stored in the data dictionary, as the following example shows: 
                     </p><pre class="oac_no_warn" dir="ltr">job_title emp.job%TYPE;
</pre><p>That way, you need not know the exact datatype of the column. Furthermore, if a column definition changes, the variable declaration changes accordingly and automatically. This provides data independence, reduces maintenance costs, and allows programs to adapt as the database changes.</p>
                  </div>
               </div><a id="ZZPRE298"></a><div class="props_rev_3"><a id="GUID-DA8EE693-725D-465B-AE86-B0BAD366CB53" name="GUID-DA8EE693-725D-465B-AE86-B0BAD366CB53"></a><h4 id="ZZPRE-GUID-DA8EE693-725D-465B-AE86-B0BAD366CB53" class="sect4"><span class="enumeration_section">5.1.3 </span>Cursor FOR Loops
                  </h4>
                  <div>
                     <p>With PL/SQL, you need not use the <code class="codeph">DECLARE</code>, <code class="codeph">OPEN</code>, <code class="codeph">FETCH</code>, and <code class="codeph">CLOSE</code> statements to define and manipulate a cursor. Instead, you can use a cursor <code class="codeph">FOR</code> loop, which implicitly declares its loop index as a record, opens the cursor associated with a given query, repeatedly fetches data from the cursor into the record, then closes the cursor. An example follows: 
                     </p><pre class="oac_no_warn" dir="ltr">DECLARE
 ...
BEGIN
 FOR emprec IN (SELECT empno, sal, comm FROM emp) LOOP
 IF emprec.comm / emprec.sal &gt; 0.25 THEN ...
 ...
 END LOOP;
END;
</pre><p>Notice that you use dot notation to reference fields in the record.</p>
                  </div>
               </div><a id="ZZPRE299"></a><div class="props_rev_3"><a id="GUID-F00509BC-FD3A-4909-BBE4-767347B95A72" name="GUID-F00509BC-FD3A-4909-BBE4-767347B95A72"></a><h4 id="ZZPRE-GUID-F00509BC-FD3A-4909-BBE4-767347B95A72" class="sect4"><span class="enumeration_section">5.1.4 </span>Subprograms
                  </h4>
                  <div>
                     <p>PL/SQL has two types of subprograms called <span class="italic">procedures</span> and <span class="italic">functions</span>, which aid application development by letting you isolate operations. Generally, you use a procedure to perform an action and a function to compute a value. 
                     </p>
                     <p>Procedures and functions provide <span class="italic">extensibility</span>. That is, they let you tailor the PL/SQL language to suit your needs. For example, if you need a procedure that creates a new department, just write your own as follows:
                     </p><pre class="oac_no_warn" dir="ltr">PROCEDURE create_dept
 (new_dname IN CHAR(14),
 new_loc IN CHAR(13),
 new_deptno OUT NUMBER(2)) IS
BEGIN
 SELECT deptno_seq.NEXTVAL INTO new_deptno FROM dual;
 INSERT INTO dept VALUES (new_deptno, new_dname, new_loc);
END create_dept;
</pre><p>When called, this procedure accepts a new department name and location, selects the next value in a department-number database sequence, inserts the new number, name, and location into the <span class="italic">dept</span> table, then returns the new number to the caller.
                     </p>
                     <p>You can store subprograms in the database (using <code class="codeph">CREATE</code> <code class="codeph">FUNCTION</code> and <code class="codeph">CREATE</code> <code class="codeph">PROCEDURE</code>) that can be called from multiple applications without needing to be recompiled each time.
                     </p>
                  </div>
               </div><a id="ZZPRE300"></a><div class="props_rev_3"><a id="GUID-C7C8C7A0-60FE-4225-9859-088FB87CAEA4" name="GUID-C7C8C7A0-60FE-4225-9859-088FB87CAEA4"></a><h4 id="ZZPRE-GUID-C7C8C7A0-60FE-4225-9859-088FB87CAEA4" class="sect4"><span class="enumeration_section">5.1.5 </span>Parameter Modes
                  </h4>
                  <div>
                     <p><a id="d28933e338" class="indexterm-anchor"></a>You use <span class="italic">parameter modes</span> to define the behavior of formal parameters. There are three parameter modes: <code class="codeph">IN</code> (the default), <code class="codeph">OUT</code>, and <code class="codeph">IN OUT</code>. An <code class="codeph">7IN</code> parameter lets you pass values to the subprogram being called. An <code class="codeph">OUT</code> parameter lets you return values to the caller of a subprogram. An <code class="codeph">IN OUT</code> parameter lets you pass initial values to the subprogram being called and return updated values to the caller. 
                     </p>
                     <p>The datatype of each actual parameter must be convertible to the datatype of its corresponding formal parameter. <a href="meeting-program-requirements.html#GUID-A5477BD8-CCB9-4938-BB6D-0259B7E3F22F__BABDHHCD" title="table">Table 3-6</a> shows the legal conversions between datatypes.
                     </p>
                  </div>
               </div><a id="ZZPRE301"></a><div class="props_rev_3"><a id="GUID-2DCFE2E1-BAE5-4785-B9D2-DBB49FFFAE2F" name="GUID-2DCFE2E1-BAE5-4785-B9D2-DBB49FFFAE2F"></a><h4 id="ZZPRE-GUID-2DCFE2E1-BAE5-4785-B9D2-DBB49FFFAE2F" class="sect4"><span class="enumeration_section">5.1.6 </span>Packages
                  </h4>
                  <div>
                     <p><a id="d28933e398" class="indexterm-anchor"></a>PL/SQL lets you bundle logically related types, program objects, and subprograms into a <span class="italic">package</span>. Packages can be compiled and stored in an Oracle database, where their contents can be shared by multiple applications.
                     </p>
                     <p>Packages usually have two parts: a specification and a body. The <span class="italic">specification</span> is the interface to your applications; it declares the types, constants, variables, exceptions, cursors, and subprograms available for use. The <span class="italic">body</span> defines cursors and subprograms and so implements the specification. In the following example, you "package" two employment procedures:
                     </p><pre class="oac_no_warn" dir="ltr">PACKAGE emp_actions IS -- package specification
 PROCEDURE hire_employee (empno NUMBER, ename CHAR, ...);
 PROCEDURE fire_employee (emp_id NUMBER);
END emp_actions;
PACKAGE BODY emp_actions IS -- package body
 PROCEDURE hire_employee (empno NUMBER, ename CHAR, ...) IS
 BEGIN
 INSERT INTO emp VALUES (empno, ename, ...);
 END hire_employee;
 PROCEDURE fire_employee (emp_id NUMBER) IS
 BEGIN
 DELETE FROM emp WHERE empno = emp_id;
 END fire_employee;
END emp_actions;
</pre><p>Only the declarations in the package specification are visible and accessible to applications. Implementation details in the package body are hidden and inaccessible.</p>
                  </div>
               </div><a id="ZZPRE302"></a><div class="props_rev_3"><a id="GUID-56342726-094C-4997-B03C-BDBA340E3353" name="GUID-56342726-094C-4997-B03C-BDBA340E3353"></a><h4 id="ZZPRE-GUID-56342726-094C-4997-B03C-BDBA340E3353" class="sect4"><span class="enumeration_section">5.1.7 </span>PL/SQL Tables
                  </h4>
                  <div>
                     <p>PL/SQL provides a composite datatype named <code class="codeph">TABLE</code>. Objects of type <code class="codeph">TABLE</code> are called <span class="italic">PL/SQL tables</span>, which are modelled as (but not the same as) database tables. PL/SQL tables have only one column and use a primary key to give you array-like access to rows. The column can belong to any scalar type (such as <code class="codeph">CHAR</code>, <code class="codeph">DATE</code>, or <code class="codeph">NUMBER</code>), but the primary key must belong to type <code class="codeph">BINARY_INTEGER</code>. 
                     </p>
                     <p>You can declare PL/SQL table types in the declarative part of any block, procedure, function, or package. In the following example, you declare a <code class="codeph">TABLE</code> type called <span class="italic">NumTabTyp</span>:
                     </p><pre class="oac_no_warn" dir="ltr">DECLARE
 TYPE NumTabTyp IS TABLE OF NUMBER
 INDEX BY BINARY_INTEGER;
 ...
BEGIN
 ...
END;
</pre><p>After you define type <span class="italic">NumTabTyp</span>, you can declare PL/SQL tables of that type, as the next example shows:
                     </p><pre class="oac_no_warn" dir="ltr">num_tab NumTabTyp;
</pre><p>The identifier <span class="italic">num_tab</span> represents an entire PL/SQL table.
                     </p>
                     <p>You reference rows in a PL/SQL table using array-like syntax to specify the primary key value. For example, you reference the ninth row in the PL/SQL table named <span class="italic">num_tab</span> as follows:
                     </p><pre class="oac_no_warn" dir="ltr">num_tab(9) ...
</pre></div>
               </div><a id="ZZPRE303"></a><div class="props_rev_3"><a id="GUID-969ACBD3-10F3-46EC-BEC4-52CFEAF7D22D" name="GUID-969ACBD3-10F3-46EC-BEC4-52CFEAF7D22D"></a><h4 id="ZZPRE-GUID-969ACBD3-10F3-46EC-BEC4-52CFEAF7D22D" class="sect4"><span class="enumeration_section">5.1.8 </span>User-defined Records
                  </h4>
                  <div>
                     <p><a id="d28933e530" class="indexterm-anchor"></a>You can use the <code class="codeph">%ROWTYPE</code> attribute to declare a record that represents a row in a database table or a row fetched by a cursor. However, you cannot specify the datatypes of fields in the record or define fields of your own. The composite datatype <code class="codeph">RECORD</code> lifts those restrictions. 
                     </p>
                     <p>Objects of type <code class="codeph">RECORD</code> are called <span class="italic">records</span>. Unlike PL/SQL tables, records have uniquely named fields, which can belong to different datatypes. For example, suppose you have different kinds of data about an employee such as name, salary, hire date, and so on. This data is dissimilar in type but logically related. A record that contains such fields as the name, salary, and hire date of an employee would let you treat the data as a logical unit.
                     </p>
                     <p>You can declare record types and objects in the declarative part of any block, procedure, function, or package. In the following example, you declare a <code class="codeph">RECORD</code> type called <span class="italic">DeptRecTyp</span>:
                     </p><pre class="oac_no_warn" dir="ltr">DECLARE
 TYPE DeptRecTyp IS RECORD
 (deptno NUMBER(4) NOT NULL := 10, -- must initialize
 dname CHAR(9),
 loc CHAR(14));
</pre><p>Notice that the field declarations are like variable declarations. Each field has a unique <a id="d28933e561" class="indexterm-anchor"></a>name and specific datatype. You can add the <code class="codeph">NOT</code> <code class="codeph">NULL</code> option to any field declaration and so prevent the assigning of nulls to that field. However, you must initialize <code class="codeph">NOT</code> <code class="codeph">NULL</code> fields.
                     </p>
                     <p>After you define type <span class="italic">DeptRecTyp</span>, you can declare records of that type, as the next example shows:
                     </p><pre class="oac_no_warn" dir="ltr">dept_rec DeptRecTyp;
</pre><p>The identifier <span class="italic">dept_rec</span> represents an entire record.
                     </p>
                     <p>You use dot notation to reference individual fields in a record. For example, you reference the <span class="italic">dname</span> field in the <span class="italic">dept_rec</span> record as follows:
                     </p><pre class="oac_no_warn" dir="ltr">dept_rec.dname ...
</pre><p></p>
                  </div>
               </div>
            </div><a id="ZZPRE304"></a><div class="props_rev_3"><a id="GUID-EBCAF03F-C7FF-46AC-A944-2C63B3806BE0" name="GUID-EBCAF03F-C7FF-46AC-A944-2C63B3806BE0"></a><h3 id="ZZPRE-GUID-EBCAF03F-C7FF-46AC-A944-2C63B3806BE0" class="sect3"><span class="enumeration_section">5.2 </span>About Embedding PL/SQL Blocks
               </h3>
               <div>
                  <div class="section">
                     <p>The <a id="d28933e624" class="indexterm-anchor"></a>Oracle Precompilers treat a PL/SQL block like a single embedded SQL statement. So, you can place a PL/SQL block anywhere in a host program that you can place a SQL statement. 
                     </p>
                     <p><a id="d28933e630" class="indexterm-anchor"></a>To embed a PL/SQL block in your host program, simply bracket the PL/SQL block with the keywords <code class="codeph">EXEC</code> <code class="codeph">SQL</code> <code class="codeph">EXECUTE</code> and <code class="codeph">END-EXEC</code> as follows:
                     </p><pre class="oac_no_warn" dir="ltr">EXEC SQL EXECUTE
 DECLARE
 ...
 BEGIN
 ...
 END;
END-EXEC;
</pre><p>The keyword <code class="codeph">END-EXEC</code> must be followed by the statement terminator for your host language. 
                     </p>
                     <p>When your program embeds PL/SQL blocks, you must specify the precompiler option <code class="codeph">SQLCHECK=SEMANTICS</code> because PL/SQL must be parsed by Oracle. To connect to <a id="d28933e659" class="indexterm-anchor"></a>Oracle, you must also specify the option <code class="codeph">USERID</code>. For more information, see <span class="q">"<a href="running-Oracle-precompilers.html#GUID-3B46BD40-209C-4426-B8C3-4ABF97C44507">About Using the Precompiler Options</a>"</span>.
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="ZZPRE305"></a><div class="props_rev_3"><a id="GUID-250ED489-7062-4A68-B664-BB7B0998FA91" name="GUID-250ED489-7062-4A68-B664-BB7B0998FA91"></a><h3 id="ZZPRE-GUID-250ED489-7062-4A68-B664-BB7B0998FA91" class="sect3"><span class="enumeration_section">5.3 </span>About Using Host Variables
               </h3>
               <div>
                  <p>Host variables are the key to communication between a host language and a PL/SQL block. Host variables can be shared with PL/SQL, meaning that PL/SQL can set and reference host variables.</p>
                  <p>For example, you can prompt a user for information and use host variables to pass that information to a PL/SQL block. Then, PL/SQL can access the database and use host variables to pass the results back to your host program. </p>
                  <p><a id="d28933e698" class="indexterm-anchor"></a>Inside a PL/SQL block, host variables are treated as global to the entire block and can be used anywhere within the block wherever a PL/SQL variable is allowed. However, character host variables cannot exceed 255 characters in length. Like host variables in a SQL statement, host variables in a PL/SQL block must be prefixed with a colon. The colon sets host variables apart from PL/SQL variables and database objects.
                  </p>
               </div><a id="ZZPRE306"></a><div class="props_rev_3"><a id="GUID-258C8FBE-C977-4E9E-92AB-6CC46AD2C087" name="GUID-258C8FBE-C977-4E9E-92AB-6CC46AD2C087"></a><h4 id="ZZPRE-GUID-258C8FBE-C977-4E9E-92AB-6CC46AD2C087" class="sect4"><span class="enumeration_section">5.3.1 </span>An Example
                  </h4>
                  <div>
                     <p>The following example illustrates the use of host variables with PL/SQL. The program prompts the user for an employee number, then displays the job title, hire date, and salary of that employee. </p><pre class="oac_no_warn" dir="ltr">EXEC SQL BEGIN DECLARE SECTION;
 username CHARACTER(20);
 password CHARACTER(20);
 emp_number INTEGER;
 job_title CHARACTER(20);
 hire_date CHARACTER(9);
 salary REAL;
EXEC SQL END DECLARE SECTION;
EXEC SQL INCLUDE SQLCA;
display 'Username? ';
read username;
display 'Password? ';
read password;
EXEC SQL WHENEVER SQLERROR DO sql_error;
EXEC SQL CONNECT :username IDENTIFIED BY :password;
display 'Connected to Oracle';
LOOP
 display 'Employee Number (0 to end)? ';
 read emp_number;
 IF emp_number = 0 THEN
 EXEC SQL COMMIT WORK RELEASE;
 display 'Exiting program';
 exit program;
 ENDIF;
 ---------------- begin PL/SQL block -----------------
 EXEC SQL EXECUTE
 BEGIN
 SELECT job, hiredate, sal
 INTO :job_title, :hire_date, :salary
 FROM emp
 WHERE empno = :emp_number;
 END;
 END-EXEC;
 ---------------- end PL/SQL block -----------------
 display 'Number Job Title Hire Date Salary';
 display '------------------------------------';
 display emp_number, job_title, hire_date, salary;
ENDLOOP;
...
ROUTINE sql_error
BEGIN
 EXEC SQL WHENEVER SQLERROR CONTINUE;
 EXEC SQL ROLLBACK WORK RELEASE;
 display 'Processing error';
 exit program with an error;
END sql_error;
</pre><p>Notice that the host variable <span class="italic">emp_number</span> is set before the PL/SQL block is entered, and the host variables <span class="italic">job_title</span>, <span class="italic">hire_date</span>, and <span class="italic">salary</span> are set inside the block.
                     </p>
                  </div>
               </div><a id="ZZPRE307"></a><div class="props_rev_3"><a id="GUID-A731DD33-06D1-4CF0-BD28-8A24D8E10DF8" name="GUID-A731DD33-06D1-4CF0-BD28-8A24D8E10DF8"></a><h4 id="ZZPRE-GUID-A731DD33-06D1-4CF0-BD28-8A24D8E10DF8" class="sect4"><span class="enumeration_section">5.3.2 </span>A More Complex Example
                  </h4>
                  <div>
                     <p>In the example, you prompt the user for a bank account number, transaction type, and transaction amount, then debit or credit the account. If the account does not exist, you raise an exception. When the transaction is complete, you display its status. </p><pre class="oac_no_warn" dir="ltr">EXEC SQL BEGIN DECLARE SECTION;
 username CHARACTER(20);
 password CHARACTER(20);
 acct_num INTEGER;
 trans_type CHARACTER(1);
 trans_amt REAL;
 status CHARACTER(80);
EXEC SQL END DECLARE SECTION;
EXEC SQL INCLUDE SQLCA;
display 'Username? ';
read username;
display 'Password? ';
read password;
EXEC SQL WHENEVER SQLERROR DO sql_error;
EXEC SQL CONNECT :username IDENTIFIED BY :password;
display 'Connected to Oracle';
LOOP
 display 'Account Number (0 to end)? ';
 read acct_num;
 IF acct_num = 0 THEN
 EXEC SQL COMMIT WORK RELEASE;
 display 'Exiting program';
 exit program;
 ENDIF;
 display 'Transaction Type - D)ebit or C)redit? '
 read trans_type;
 display 'Transaction Amount? '
 read trans_amt;
 --------------------- begin PL/SQL block -------------------
 EXEC SQL EXECUTE
 DECLARE
 old_bal NUMBER(9,2);
 err_msg CHAR(70);
 nonexistent EXCEPTION;
 BEGIN
 :trans_type := UPPER(:trans_type);
 IF :trans_type = 'C' THEN -- credit the account
 UPDATE accts SET bal = bal + :trans_amt
 WHERE acctid = :acct_num;
 IF SQL%ROWCOUNT = 0 THEN -- no rows affected
 RAISE nonexistent;
 ELSE
 :status := 'Credit applied';
 END IF;
 ELSIF :trans_type = 'D' THEN -- debit the account
 SELECT bal INTO old_bal FROM accts
 WHERE acctid = :acct_num;
 IF old_bal &gt;= :trans_amt THEN -- enough funds
 UPDATE accts SET bal = bal - :trans_amt
 WHERE acctid = :acct_num;
 :status := 'Debit applied';
 ELSE
 :status := 'Insufficient funds';
 END IF;
 ELSE
 :status := 'Invalid type: ' || :trans_type;
 END IF;
 COMMIT;
 EXCEPTION
 WHEN NO_DATA_FOUND OR nonexistent THEN
 :status := 'Nonexistent account';
 WHEN OTHERS THEN
 err_msg := SUBSTR(SQLERRM, 1, 70);
 :status := 'Error: ' || err_msg;
 END;
 END-EXEC;
 ------------------- end PL/SQL block -----------------------
 display 'Status: ', status;
ENDLOOP;
ROUTINE sql_error
BEGIN
 EXEC SQL WHENEVER SQLERROR CONTINUE;
 EXEC SQL ROLLBACK WORK RELEASE; 
 display 'Processing error';
 exit program with an error;
END sql_error;
</pre></div>
               </div><a id="ZZPRE308"></a><div class="props_rev_3"><a id="GUID-3CE9DBA9-F29F-41F9-AAAD-31A4029F79A0" name="GUID-3CE9DBA9-F29F-41F9-AAAD-31A4029F79A0"></a><h4 id="ZZPRE-GUID-3CE9DBA9-F29F-41F9-AAAD-31A4029F79A0" class="sect4"><span class="enumeration_section">5.3.3 </span>VARCHAR Pseudotype
                  </h4>
                  <div>
                     <p>Recall from <a href="meeting-program-requirements.html#GUID-ED71BADE-AF94-4074-B4B1-140E03903E88"> Meeting Program Requirements</a> that you can use the <code class="codeph">VARCHAR</code> pseudotype to declare variable-length character strings. If the <code class="codeph">VARCHAR</code> is an input host variable, you must tell Oracle what length to expect. So, set the length field to the actual length of the value stored in the string field.
                     </p>
                     <p>If the <code class="codeph">VARCHAR</code> is an output host variable, Oracle automatically sets the length field. However, to use a <code class="codeph">VARCHAR</code> output host variable in your PL/SQL block, you must initialize the length field <span class="italic">before</span> entering the block. So, set the length field to the declared (maximum) length of the <code class="codeph">VARCHAR</code>, as shown in the following example: 
                     </p><pre class="oac_no_warn" dir="ltr">EXEC SQL BEGIN DECLARE SECTION;
 emp_number INTEGER;
 emp_name VARCHAR(10);
 salary REAL;
 ...
EXEC SQL END DECLARE SECTION;
...
set emp_name.len = 10; -- initialize length field
EXEC SQL EXECUTE
 BEGIN
 SELECT ename, sal INTO :emp_name, :salary
 FROM emp
 WHERE empno = :emp_number;
 ...
 END;
END-EXEC;
</pre></div>
               </div>
            </div><a id="ZZPRE309"></a><div class="props_rev_3"><a id="GUID-863B7A7D-D21D-45CA-BF20-5796A1AF1CA4" name="GUID-863B7A7D-D21D-45CA-BF20-5796A1AF1CA4"></a><h3 id="ZZPRE-GUID-863B7A7D-D21D-45CA-BF20-5796A1AF1CA4" class="sect3"><span class="enumeration_section">5.4 </span>About Using Indicator Variables
               </h3>
               <div>
                  <p><a id="d28933e855" class="indexterm-anchor"></a>PL/SQL does not need indicator variables because it can manipulate nulls. For example, within PL/SQL, you can use the <code class="codeph">IS NULL</code> operator to test for nulls, as follows:
                  </p><pre class="oac_no_warn" dir="ltr">IF variable IS NULL THEN ...
</pre><p>You can use the assignment operator (<code class="codeph">:=</code>) to assign nulls, as follows:
                  </p><pre class="oac_no_warn" dir="ltr">variable := NULL;
</pre><p>However, host languages need indicator variables because they cannot manipulate nulls. Embedded PL/SQL meets this need by letting you use indicator variables to</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>accept nulls input from a host program</p>
                     </li>
                     <li>
                        <p>output nulls or truncated values to a host program</p>
                     </li>
                  </ul>
                  <p>When used in a PL/SQL block, indicator variables are subject to the following rules:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>You cannot refer to an indicator variable by itself; it must be appended to its associated host variable.</p>
                     </li>
                     <li>
                        <p>If you refer to a host variable with its indicator variable, you must always refer to it that way in the same block.</p>
                     </li>
                  </ul>
                  <p>In the following example, the indicator variable <span class="italic">ind_comm</span> appears with its host variable <span class="italic">commission</span> in the <code class="codeph">SELECT</code> statement, so it must appear that way in the <code class="codeph">IF</code> statement:
                  </p><pre class="oac_no_warn" dir="ltr">EXEC SQL EXECUTE
 BEGIN
 SELECT ename, comm
 INTO :emp_name, :commission:ind_comm FROM emp
 WHERE empno = :emp_number;
 IF :commission:ind_comm IS NULL THEN ...
 ...
 END;
END-EXEC;
</pre><p>Notice that PL/SQL treats <span class="italic">:commission:ind_comm</span> like any other simple variable. Though you cannot refer directly to an indicator variable inside a PL/SQL block, PL/SQL checks the value of the indicator variable when entering the block and sets the value correctly when exiting the block.
                  </p>
               </div><a id="ZZPRE310"></a><div class="props_rev_3"><a id="GUID-251E3C21-67E6-4C1E-B5A8-ECA342DAA3DF" name="GUID-251E3C21-67E6-4C1E-B5A8-ECA342DAA3DF"></a><h4 id="ZZPRE-GUID-251E3C21-67E6-4C1E-B5A8-ECA342DAA3DF" class="sect4"><span class="enumeration_section">5.4.1 </span>Handling Nulls
                  </h4>
                  <div>
                     <p>When entering a block, if an indicator variable has a value of <code class="codeph">-1</code>, PL/SQL automatically assigns a null to the host variable. When exiting the block, if a host variable is null, PL/SQL automatically assigns a value of -1 to the indicator variable. In the next example, if <span class="italic">handsel</span> had a value of -1 before the PL/SQL block was entered, the <span class="italic">salary_missing</span> exception is raised. An <a id="d28933e948" class="indexterm-anchor"></a><span class="italic">exception</span> is a named error condition. 
                     </p><pre class="oac_no_warn" dir="ltr">EXEC SQL EXECUTE
 BEGIN
 IF :salary:ind_sal IS NULL THEN
 RAISE salary_missing;
 END IF;
 ...
 END;
END-EXEC;
</pre></div>
               </div><a id="ZZPRE311"></a><div class="props_rev_3"><a id="GUID-71C9A8D3-873B-43F3-9C54-06A72BF7D2B9" name="GUID-71C9A8D3-873B-43F3-9C54-06A72BF7D2B9"></a><h4 id="ZZPRE-GUID-71C9A8D3-873B-43F3-9C54-06A72BF7D2B9" class="sect4"><span class="enumeration_section">5.4.2 </span>Handling Truncated Values
                  </h4>
                  <div>
                     <p>PL/SQL does not raise an exception when a truncated string value is assigned to a host variable. However, if you use an indicator variable, PL/SQL sets it to the original length of the string. In the following example, the host program will be able to tell, by checking the value of <span class="italic">ind_name</span>, if a truncated value was assigned to <span class="italic">emp_name</span>: 
                     </p><pre class="oac_no_warn" dir="ltr">EXEC SQL EXECUTE
 DECLARE
 ...
 new_name CHAR(10);
 BEGIN
 ...
 :emp_name:ind_name := new_name;
 ...
 END;
END-EXEC;
</pre></div>
               </div>
            </div><a id="ZZPRE313"></a><a id="ZZPRE841"></a><a id="ZZPRE312"></a><div class="props_rev_3"><a id="GUID-78FCA10C-976A-47A5-A15C-20D9F0F3C368" name="GUID-78FCA10C-976A-47A5-A15C-20D9F0F3C368"></a><h3 id="ZZPRE-GUID-78FCA10C-976A-47A5-A15C-20D9F0F3C368" class="sect3"><span class="enumeration_section">5.5 </span>About Using Host Arrays
               </h3>
               <div>
                  <p>You can pass input host arrays and indicator arrays to a PL/SQL block. They can be indexed by a PL/SQL variable of type <code class="codeph">BINARY_INTEGER</code> or by a host variable compatible with that type. Normally, the entire host array is passed to PL/SQL, but you can use the <code class="codeph">ARRAYLEN</code> statement (discussed later) to specify a smaller array dimension.
                  </p>
                  <p>Furthermore, you can use a subprogram call to assign all the values in a host array to rows in a PL/SQL table. Given that the array subscript range is <span class="italic">m</span> .. <span class="italic">n</span>, the corresponding PL/SQL table index range is always 1 .. <span class="italic">(n</span> - <span class="italic">m</span> + 1). For example, if the array subscript range is 5 .. 10, the corresponding PL/SQL table index range is 1 .. (10 - 5 + 1) or 1 .. 6.
                  </p>
                  <div class="infoboxnote" id="GUID-78FCA10C-976A-47A5-A15C-20D9F0F3C368__GUID-34023F3E-257C-44D2-8E30-8D2DDBF17432">
                     <p class="notep1">Note:</p>
                     <p>The Oracle Precompilers do not check your usage of host arrays. For instance, no index range checking is done.</p>
                  </div>
                  <p>In the example , you pass a host array named <span class="italic">salary</span> to a PL/SQL block, which uses the host array in a function call. The function is named <span class="italic">median</span> because it finds the middle value in a series of numbers. Its formal parameters include a PL/SQL table named <span class="italic">num_tab</span>. The function call assigns all the values in the actual parameter <span class="italic">salary</span> to rows in the formal parameter <span class="italic">num_tab</span>.
                  </p><pre class="oac_no_warn" dir="ltr">EXEC SQL BEGIN DECLARE SECTION;
 ...
 salary (100) REAL;
 median_salary REAL;
EXEC SQL END DECLARE SECTION;
-- populate the host array
EXEC SQL EXECUTE
 DECLARE
 TYPE NumTabTyp IS TABLE OF REAL
 INDEX BY BINARY_INTEGER;
 n BINARY_INTEGER;
 ...
 FUNCTION median (num_tab NumTabTyp, n INTEGER)
 RETURN REAL IS
 BEGIN
 -- compute median
 END;
 BEGIN
 n := 100;
 :median_salary := median(:salary, n);
 ...
 END;
END-EXEC;
</pre><p>You can also use a subprogram call to assign all row values in a PL/SQL table to corresponding elements in a host array.</p>
                  <p><a href="using-embedded-PLSQL.html#GUID-78FCA10C-976A-47A5-A15C-20D9F0F3C368__BABEGBGG" title="pl sql">Table 5-1</a> shows the legal conversions between row values in a PL/SQL table and elements in a host array. For example, a host array of type <code class="codeph">LONG</code> is compatible with a PL/SQL table of type <code class="codeph">VARCHAR2</code>, <code class="codeph">LONG</code>, <code class="codeph">RAW</code>, or <code class="codeph">LONG RAW</code>. Notably, it is not compatible with a PL/SQL table of type <code class="codeph">CHAR</code>.
                  </p>
                  <div class="tblformal" id="GUID-78FCA10C-976A-47A5-A15C-20D9F0F3C368__BABEGBGG">
                     <p class="titleintable">Table 5-1 Legal Conversions: PL/SQL Table Row and Host Array Elements</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="Legal Conversions: PL/SQL Table Row and Host Array Elements" summary="pl sql" width="100%" frame="hsides" border="1" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="16%" id="d28933e1103">PL/SQL Table</th>
                              <th align="left" valign="bottom" width="9%" id="d28933e1106">CHAR</th>
                              <th align="left" valign="bottom" width="9%" id="d28933e1110">DATE</th>
                              <th align="left" valign="bottom" width="9%" id="d28933e1114">LONG</th>
                              <th align="left" valign="bottom" width="12%" id="d28933e1118">LONG RAW</th>
                              <th align="left" valign="bottom" width="12%" id="d28933e1125">NUMBER</th>
                              <th align="left" valign="bottom" width="10%" id="d28933e1129">RAW</th>
                              <th align="left" valign="bottom" width="11%" id="d28933e1133">ROWID</th>
                              <th align="left" valign="bottom" width="12%" id="d28933e1137">VARCHAR2</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="16%" id="d28933e1143" headers="d28933e1103 ">
                                 <p><code class="codeph">CHARF</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1143 d28933e1106 ">
                                 <p>_/</p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1143 d28933e1110 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1143 d28933e1114 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1143 d28933e1118 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1143 d28933e1125 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="10%" headers="d28933e1143 d28933e1129 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d28933e1143 d28933e1133 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1143 d28933e1137 ">
                                 <p></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="16%" id="d28933e1165" headers="d28933e1103 ">
                                 <p><code class="codeph">CHARZ</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1165 d28933e1106 ">
                                 <p>_/</p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1165 d28933e1110 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1165 d28933e1114 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1165 d28933e1118 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1165 d28933e1125 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="10%" headers="d28933e1165 d28933e1129 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d28933e1165 d28933e1133 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1165 d28933e1137 ">
                                 <p></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="16%" id="d28933e1187" headers="d28933e1103 ">
                                 <p><code class="codeph">DATE</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1187 d28933e1106 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1187 d28933e1110 ">
                                 <p>_/</p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1187 d28933e1114 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1187 d28933e1118 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1187 d28933e1125 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="10%" headers="d28933e1187 d28933e1129 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d28933e1187 d28933e1133 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1187 d28933e1137 ">
                                 <p></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="16%" id="d28933e1209" headers="d28933e1103 ">
                                 <p><code class="codeph">DECIMAL</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1209 d28933e1106 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1209 d28933e1110 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1209 d28933e1114 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1209 d28933e1118 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1209 d28933e1125 ">
                                 <p>_/</p>
                              </td>
                              <td align="left" valign="top" width="10%" headers="d28933e1209 d28933e1129 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d28933e1209 d28933e1133 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1209 d28933e1137 ">
                                 <p></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="16%" id="d28933e1231" headers="d28933e1103 ">
                                 <p><code class="codeph">DISPLAY</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1231 d28933e1106 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1231 d28933e1110 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1231 d28933e1114 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1231 d28933e1118 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1231 d28933e1125 ">
                                 <p>_/</p>
                              </td>
                              <td align="left" valign="top" width="10%" headers="d28933e1231 d28933e1129 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d28933e1231 d28933e1133 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1231 d28933e1137 ">
                                 <p></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="16%" id="d28933e1253" headers="d28933e1103 ">
                                 <p><code class="codeph">FLOAT</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1253 d28933e1106 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1253 d28933e1110 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1253 d28933e1114 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1253 d28933e1118 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1253 d28933e1125 ">
                                 <p>_/</p>
                              </td>
                              <td align="left" valign="top" width="10%" headers="d28933e1253 d28933e1129 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d28933e1253 d28933e1133 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1253 d28933e1137 ">
                                 <p></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="16%" id="d28933e1275" headers="d28933e1103 ">
                                 <p><code class="codeph">INTEGER</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1275 d28933e1106 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1275 d28933e1110 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1275 d28933e1114 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1275 d28933e1118 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1275 d28933e1125 ">
                                 <p>_/</p>
                              </td>
                              <td align="left" valign="top" width="10%" headers="d28933e1275 d28933e1129 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d28933e1275 d28933e1133 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1275 d28933e1137 ">
                                 <p></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="16%" id="d28933e1297" headers="d28933e1103 ">
                                 <p><code class="codeph">LONG</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1297 d28933e1106 ">
                                 <p>_/</p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1297 d28933e1110 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1297 d28933e1114 ">
                                 <p>_/</p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1297 d28933e1118 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1297 d28933e1125 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="10%" headers="d28933e1297 d28933e1129 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d28933e1297 d28933e1133 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1297 d28933e1137 ">
                                 <p></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="16%" id="d28933e1320" headers="d28933e1103 ">
                                 <p><code class="codeph">LONG</code> <code class="codeph">VARCHAR</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1320 d28933e1106 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1320 d28933e1110 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1320 d28933e1114 ">
                                 <p>_/</p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1320 d28933e1118 ">
                                 <p>_/</p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1320 d28933e1125 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="10%" headers="d28933e1320 d28933e1129 ">
                                 <p>_/</p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d28933e1320 d28933e1133 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1320 d28933e1137 ">
                                 <p>_/</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="16%" id="d28933e1348" headers="d28933e1103 ">
                                 <p><code class="codeph">LONG</code> <code class="codeph">VARRAW</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1348 d28933e1106 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1348 d28933e1110 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1348 d28933e1114 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1348 d28933e1118 ">
                                 <p>_/</p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1348 d28933e1125 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="10%" headers="d28933e1348 d28933e1129 ">
                                 <p>_/</p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d28933e1348 d28933e1133 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1348 d28933e1137 ">
                                 <p></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="16%" id="d28933e1374" headers="d28933e1103 ">
                                 <p><code class="codeph">NUMBER</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1374 d28933e1106 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1374 d28933e1110 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1374 d28933e1114 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1374 d28933e1118 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1374 d28933e1125 ">
                                 <p>_/</p>
                              </td>
                              <td align="left" valign="top" width="10%" headers="d28933e1374 d28933e1129 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d28933e1374 d28933e1133 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1374 d28933e1137 ">
                                 <p></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="16%" id="d28933e1397" headers="d28933e1103 ">
                                 <p><code class="codeph">RAW</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1397 d28933e1106 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1397 d28933e1110 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1397 d28933e1114 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1397 d28933e1118 ">
                                 <p>_/</p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1397 d28933e1125 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="10%" headers="d28933e1397 d28933e1129 ">
                                 <p>_/</p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d28933e1397 d28933e1133 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1397 d28933e1137 ">
                                 <p></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="16%" id="d28933e1420" headers="d28933e1103 ">
                                 <p><code class="codeph">ROWID</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1420 d28933e1106 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1420 d28933e1110 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1420 d28933e1114 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1420 d28933e1118 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1420 d28933e1125 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="10%" headers="d28933e1420 d28933e1129 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d28933e1420 d28933e1133 ">
                                 <p>_/</p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1420 d28933e1137 ">
                                 <p></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="16%" id="d28933e1442" headers="d28933e1103 ">
                                 <p><code class="codeph">STRING</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1442 d28933e1106 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1442 d28933e1110 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1442 d28933e1114 ">
                                 <p>_/</p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1442 d28933e1118 ">
                                 <p>_/</p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1442 d28933e1125 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="10%" headers="d28933e1442 d28933e1129 ">
                                 <p>_/</p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d28933e1442 d28933e1133 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1442 d28933e1137 ">
                                 <p>_/</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="16%" id="d28933e1467" headers="d28933e1103 ">
                                 <p><code class="codeph">UNSIGNED</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1467 d28933e1106 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1467 d28933e1110 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1467 d28933e1114 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1467 d28933e1118 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1467 d28933e1125 ">
                                 <p>_/</p>
                              </td>
                              <td align="left" valign="top" width="10%" headers="d28933e1467 d28933e1129 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d28933e1467 d28933e1133 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1467 d28933e1137 ">
                                 <p></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="16%" id="d28933e1489" headers="d28933e1103 ">
                                 <p><code class="codeph">VARCHAR</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1489 d28933e1106 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1489 d28933e1110 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1489 d28933e1114 ">
                                 <p>_/</p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1489 d28933e1118 ">
                                 <p>_/</p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1489 d28933e1125 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="10%" headers="d28933e1489 d28933e1129 ">
                                 <p>_/</p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d28933e1489 d28933e1133 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1489 d28933e1137 ">
                                 <p>_/</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="16%" id="d28933e1514" headers="d28933e1103 ">
                                 <p><code class="codeph">VARCHAR2</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1514 d28933e1106 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1514 d28933e1110 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1514 d28933e1114 ">
                                 <p>_/</p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1514 d28933e1118 ">
                                 <p>_/</p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1514 d28933e1125 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="10%" headers="d28933e1514 d28933e1129 ">
                                 <p>_/</p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d28933e1514 d28933e1133 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1514 d28933e1137 ">
                                 <p>_/</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="16%" id="d28933e1539" headers="d28933e1103 ">
                                 <p><code class="codeph">VARNUM</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1539 d28933e1106 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1539 d28933e1110 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1539 d28933e1114 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1539 d28933e1118 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1539 d28933e1125 ">
                                 <p>_/</p>
                              </td>
                              <td align="left" valign="top" width="10%" headers="d28933e1539 d28933e1129 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d28933e1539 d28933e1133 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1539 d28933e1137 ">
                                 <p></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="16%" id="d28933e1561" headers="d28933e1103 ">
                                 <p><code class="codeph">VARRAW</code></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1561 d28933e1106 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1561 d28933e1110 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="9%" headers="d28933e1561 d28933e1114 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1561 d28933e1118 ">
                                 <p>_/</p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1561 d28933e1125 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="10%" headers="d28933e1561 d28933e1129 ">
                                 <p>_/</p>
                              </td>
                              <td align="left" valign="top" width="11%" headers="d28933e1561 d28933e1133 ">
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d28933e1561 d28933e1137 ">
                                 <p></p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
               </div><a id="ZZPRE314"></a><div class="props_rev_3"><a id="GUID-8538DF7D-89BB-41BA-89AD-984BB5196891" name="GUID-8538DF7D-89BB-41BA-89AD-984BB5196891"></a><h4 id="ZZPRE-GUID-8538DF7D-89BB-41BA-89AD-984BB5196891" class="sect4"><span class="enumeration_section">5.5.1 </span>ARRAYLEN Statement
                  </h4>
                  <div>
                     <div class="section">
                        <p><a id="d28933e1605" class="indexterm-anchor"></a>Suppose you must pass an input host array to a PL/SQL block for processing. By default, when binding such a host array, the Oracle Precompilers use its declared dimension. However, you might not want to process the entire array. In that case, you can use the <code class="codeph">ARRAYLEN</code> statement to specify a smaller array dimension. <code class="codeph">ARRAYLEN</code> associates the host array with a host variable, which stores the smaller dimension. The statement syntax is 
                        </p><pre class="oac_no_warn" dir="ltr">EXEC SQL ARRAYLEN host_array (dimension);
</pre><p>where <span class="italic">dimension</span> is a 4-byte, integer host variable, <span class="italic">not</span> a literal or an expression.
                        </p>
                        <p>The <code class="codeph">ARRAYLEN</code> statement must appear in the Declare Section along with, but somewhere after, the declarations of <span class="italic">host_array</span> and <span class="italic">dimension</span>. You cannot specify an offset into the host array. However, you might be able to use host-language features for that purpose.
                        </p>
                        <p>In the following example, you use <code class="codeph">ARRAYLEN</code> to override the default dimension of a host array named <span class="italic">bonus</span>:
                        </p><pre class="oac_no_warn" dir="ltr">EXEC SQL BEGIN DECLARE SECTION;
 bonus (100) REAL;
 my_dim INTEGER;
 EXEC SQL ARRAYLEN bonus (my_dim);
EXEC SQL END DECLARE SECTION; 
-- populate the host array
...
set my_dim = 25; -- set smaller array dimension
EXEC SQL EXECUTE
 DECLARE
 TYPE NumTabTyp IS TABLE OF REAL
 INDEX BY BINARY_INTEGER;
 median_bonus REAL;
 FUNCTION median (num_tab NumTabTyp, n INTEGER)
 RETURN REAL IS
 BEGIN
 -- compute median
 END;
 BEGIN
 median_bonus := median(:bonus, :my_dim);
 ...
 END;
END-EXEC;
</pre><p>Only 25 array elements are passed to the PL/SQL block because <code class="codeph">ARRAYLEN</code> downsizes the host array from 100 to 25 elements. As a result, when the PL/SQL block is sent to Oracle for execution, a much smaller host array is sent along. This saves time and, in a networked environment, reduces network traffic.
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="ZZPRE316"></a><a id="ZZPRE315"></a><div class="props_rev_3"><a id="GUID-91D74CE0-84E8-4A9C-BF6F-7F3F01B14573" name="GUID-91D74CE0-84E8-4A9C-BF6F-7F3F01B14573"></a><h3 id="ZZPRE-GUID-91D74CE0-84E8-4A9C-BF6F-7F3F01B14573" class="sect3"><span class="enumeration_section">5.6 </span>About Using Cursors
               </h3>
               <div>
                  <p>Every embedded SQL statement is assigned a cursor, either explicitly by you in a <code class="codeph">DECLARE</code> <code class="codeph">CURSOR</code> statement or implicitly by the precompiler. Internally, the Oracle Precompilers maintain a cache, called the <span class="italic">cursor cache</span>, to control the execution of embedded SQL statements. When executed, every SQL statement is assigned an entry in the cursor cache. This entry is linked to a private SQL area in your <a id="d28933e1697" class="indexterm-anchor"></a>Program Global Area (PGA) within Oracle. 
                  </p>
                  <p>Various precompiler options, including <code class="codeph">MAXOPENCURSORS</code>, <code class="codeph">HOLD_CURSOR</code>, and <code class="codeph">RELEASE_CURSOR</code>, let you manage the cursor cache to improve performance. For example, <code class="codeph">RELEASE_CURSOR</code> controls what happens to the link between the cursor cache and private SQL area. If you specify <code class="codeph">RELEASE_CURSOR</code><code class="codeph">=YES</code>, the link is removed after Oracle executes the SQL statement. This frees memory allocated to the private SQL area and releases parse locks.
                  </p>
                  <p><a id="d28933e1720" class="indexterm-anchor"></a>For purposes of cursor cache management, an embedded PL/SQL block is treated just like a SQL statement. At run time, a cursor, called a <span class="italic">parent cursor</span>, is associated with the entire PL/SQL block. A corresponding entry is made to the cursor cache, and this entry is linked to a private SQL area in the PGA.
                  </p>
                  <p><a id="d28933e1727" class="indexterm-anchor"></a>Each SQL statement inside the PL/SQL block also requires a private SQL area in the PGA. So, PL/SQL manages a separate cache, called the <span class="italic">child cursor cache</span>, for these SQL statements. Their cursors are called <span class="italic">child cursors</span>. Because PL/SQL manages the child cursor cache, you do not have direct control over child cursors. 
                  </p>
                  <p>The maximum number of cursors your program can use simultaneously is set by the Oracle initialization parameter <code class="codeph">OPEN_CURSORS</code>.<a href="using-embedded-PLSQL.html#GUID-91D74CE0-84E8-4A9C-BF6F-7F3F01B14573__BIHJFJEI">Figure 5-1</a> shows you how to calculate the maximum number of cursors in use.
                  </p>
                  <div class="figure" id="GUID-91D74CE0-84E8-4A9C-BF6F-7F3F01B14573__BIHJFJEI">
                     <p class="titleinfigure">Figure 5-1 Maximum Cursors in Use</p><img src="img/image009.gif" alt="Description of Figure 5-1 follows" title="Description of Figure 5-1 follows" longdesc="img_text/image009.html"><br><a href="img_text/image009.html">Description of "Figure 5-1 Maximum Cursors in Use"</a></div>
                  <!-- class="figure" -->
                  <p>If your program exceeds the limit imposed by <code class="codeph">OPEN_CURSORS</code>, you get the following Oracle error:
                  </p><pre class="oac_no_warn" dir="ltr">ORA-01000: maximum open cursors exceeded
</pre><p>You can avoid this error by specifying the <code class="codeph">RELEASE_CURSOR</code><code class="codeph">=YES</code> and <code class="codeph">HOLD_CURSOR</code><code class="codeph">=NO</code> options. If you do not want to precompile the entire program with <code class="codeph">RELEASE_CURSOR</code> set to <code class="codeph">YES</code>, simply reset it to <code class="codeph">NO</code> after each PL/SQL block, as follows:
                  </p><pre class="oac_no_warn" dir="ltr">EXEC ORACLE OPTION (RELEASE_CURSOR=YES);
-- first embedded PL/SQL block
 EXEC ORACLE OPTION (RELEASE_CURSOR=NO);
-- embedded SQL statements
 EXEC ORACLE OPTION (RELEASE_CURSOR=YES);
-- second embedded PL/SQL block
 EXEC ORACLE OPTION (RELEASE_CURSOR=NO);
-- embedded SQL statements
</pre></div><a id="ZZPRE317"></a><div class="props_rev_3"><a id="GUID-EC8DDC67-03A6-4C7B-93B7-5FAE7B66648A" name="GUID-EC8DDC67-03A6-4C7B-93B7-5FAE7B66648A"></a><h4 id="ZZPRE-GUID-EC8DDC67-03A6-4C7B-93B7-5FAE7B66648A" class="sect4"><span class="enumeration_section">5.6.1 </span>An Alternative
                  </h4>
                  <div>
                     <div class="section">
                        <p>The <code class="codeph">MAXOPENCURSORS</code> option specifies the initial size of the cursor cache. For example, when <code class="codeph">MAXOPENCURSORS=1</code>0, the cursor cache can hold up to 10 entries. If a new cursor is needed, there are no free cache entries, and <code class="codeph">HOLD_CURSOR=NO</code>, the precompiler tries to reuse an entry. If you specify a very low value for <code class="codeph">MAXOPENCURSORS</code>, the precompiler is forced to reuse the parent cursor more often. All the child cursors are released as soon as the parent cursor is reused.
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="ZZPRE318"></a><div class="props_rev_3"><a id="GUID-5840297F-2757-465C-8B1D-8C6DFFBBFA20" name="GUID-5840297F-2757-465C-8B1D-8C6DFFBBFA20"></a><h3 id="ZZPRE-GUID-5840297F-2757-465C-8B1D-8C6DFFBBFA20" class="sect3"><span class="enumeration_section">5.7 </span>Stored Subprograms
               </h3>
               <div>
                  <p><a id="d28933e1839" class="indexterm-anchor"></a>Unlike anonymous blocks, PL/SQL subprograms (procedures and functions) can be compiled separately, stored in an Oracle database, and invoked. A subprogram explicitly created using an Oracle tool such as SQL*Plus is called a <span class="italic">stored</span> subprogram. Once compiled and stored in the data dictionary, it is a database object, which can be reexecuted without being recompiled. 
                  </p>
                  <p>When a subprogram within a PL/SQL block or stored subprogram is sent to Oracle by your application, it is called an <span class="italic">inline</span> subprogram. Oracle compiles the inline subprogram and caches it in the <a id="d28933e1850" class="indexterm-anchor"></a>System Global Area (SGA), but does not store the source or object code in the data dictionary. 
                  </p>
                  <p><a id="d28933e1854" class="indexterm-anchor"></a>Subprograms defined within a package are considered part of the package, and so are called <span class="italic">packaged</span> subprograms. Stored subprograms not defined within a package are called <span class="italic">standalone</span> subprograms. 
                  </p>
               </div><a id="ZZPRE319"></a><div class="props_rev_3"><a id="GUID-E017A1D5-DC68-4B18-90D2-62741D825376" name="GUID-E017A1D5-DC68-4B18-90D2-62741D825376"></a><h4 id="ZZPRE-GUID-E017A1D5-DC68-4B18-90D2-62741D825376" class="sect4"><span class="enumeration_section">5.7.1 </span>Creating Stored Subprograms
                  </h4>
                  <div>
                     <div class="section">
                        <p><a id="d28933e1893" class="indexterm-anchor"></a>You can embed the SQL statements <code class="codeph">CREATE</code> <code class="codeph">FUNCTION</code>, <code class="codeph">CREATE</code> <code class="codeph">PROCEDURE</code>, and <code class="codeph">CREATE</code> <code class="codeph">PACKAGE</code> in a host program, as the following example shows: 
                        </p><pre class="oac_no_warn" dir="ltr">EXEC SQL CREATE
 FUNCTION sal_ok (salary REAL, title CHAR)
 RETURN BOOLEAN AS
 min_sal REAL;
 max_sal REAL;
 BEGIN
 SELECT losal, hisal INTO min_sal, max_sal
 FROM sals
 WHERE job = title;
 RETURN (salary &gt;= min_sal) AND
 (salary &lt;= max_sal);
 END sal_ok;
END-EXEC;
</pre><p>Notice that the embedded <code class="codeph">CREATE</code><code class="codeph"> {FUNCTION | PROCEDURE | PACKAGE}</code> statement is a hybrid. Like all other embedded <code class="codeph">CREATE</code> statements, it begins with the keywords <code class="codeph">EXEC SQL</code> (not <code class="codeph">EXEC SQL EXECUTE</code>). But, unlike other embedded <code class="codeph">CREATE</code> statements, it ends with the PL/SQL terminator <code class="codeph">END-EXEC</code>.
                        </p>
                        <p>In the example, you create a package that contains a procedure named <span class="italic">get_employees</span>, which fetches a batch of rows from the <span class="italic">emp</span> table. The batch size is determined by the caller of the procedure, which might be another stored subprogram or a client application program.
                        </p>
                        <p>The procedure declares three PL/SQL tables as <code class="codeph">OUT</code> formal parameters, then fetches a batch of employee data into the PL/SQL tables. The matching actual parameters are host arrays. When the procedure finishes, it automatically assigns all row values in the PL/SQL tables to corresponding elements in the host arrays.
                        </p><pre class="oac_no_warn" dir="ltr">EXEC SQL CREATE OR REPLACE PACKAGE emp_actions AS
 TYPE CharArrayTyp IS TABLE OF VARCHAR2(10)
 INDEX BY BINARY_INTEGER;
 TYPE NumArrayTyp IS TABLE OF FLOAT
 INDEX BY BINARY_INTEGER;
 PROCEDURE get_employees(
 dept_number IN INTEGER,
 batch_size IN INTEGER,
 found IN OUT INTEGER,
 done_fetch OUT INTEGER,
 emp_name OUT CharArrayTyp,
 job-title OUT CharArrayTyp,
 salary OUT NumArrayTyp);
 END emp_actions;
END-EXEC;
EXEC SQL CREATE OR REPLACE PACKAGE BODY emp_actions AS
 CURSOR get_emp (dept_number IN INTEGER) IS
 SELECT ename, job, sal FROM emp
 WHERE deptno = dept_number;
 PROCEDURE get_employees(
 dept_number IN INTEGER,
 batch_size IN INTEGER,
 found IN OUT INTEGER,
 done_fetch OUT INTEGER,
 emp_name OUT CharArrayTyp,
 job_title OUT CharArrayTyp,
 salary OUT NumArrayTyp) IS
 BEGIN
 IF NOT get_emp%ISOPEN THEN
 OPEN get_emp(dept_number);
 END IF;
 done_fetch := 0;
 found := 0;
 FOR i IN 1..batch_size LOOP
 FETCH get_emp INTO emp_name(i),
 job_title(i), salary(i);
 IF get_emp%NOTFOUND THEN
 CLOSE get_emp;
 done_fetch := 1;
 EXIT;
 ELSE
 found := found + 1;
 END IF;
 END LOOP;
 END get_employees;
 END emp_actions;
END-EXEC;
</pre><p>You specify the <code class="codeph">REPLACE</code> clause in the <code class="codeph">CREATE</code> statement to redefine an existing package without having to drop the package, re-create it, and regrant privileges on it. For the full syntax of the <code class="codeph">CREATE</code> statement see the <a href="../sqlrf/Introduction-to-Oracle-SQL.html#SQLRF-GUID-049B7AE8-11E1-4110-B3E4-D117907D77AC" target="_blank"><span class="italic">Oracle Database SQL Language Reference</span></a>.
                        </p>
                        <p>If an embedded <code class="codeph">CREATE {FUNCTION|PROCEDURE|PACKAGE}</code> statement fails, Oracle generates a warning, not an error.
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ZZPRE320"></a><div class="props_rev_3"><a id="GUID-513BABF4-4FD7-4DCD-823A-A4D06945D22C" name="GUID-513BABF4-4FD7-4DCD-823A-A4D06945D22C"></a><h4 id="ZZPRE-GUID-513BABF4-4FD7-4DCD-823A-A4D06945D22C" class="sect4"><span class="enumeration_section">5.7.2 </span>Calling a Stored Subprogram
                  </h4>
                  <div>
                     <div class="section">
                        <p>To invoke (call) a stored subprogram from your host program, you must use an anonymous PL/SQL block. In the following example, you call a standalone procedure named <span class="italic">raise_salary</span>: 
                        </p><pre class="oac_no_warn" dir="ltr">EXEC SQL EXECUTE
 BEGIN
 raise_salary(:emp_id, :increase);
 END;
END-EXEC;
</pre><p>Notice that stored subprograms can take parameters. In this example, the actual parameters <span class="italic">emp_id</span> and <span class="italic">increase</span> are host variables.
                        </p>
                        <p>In the next example, the procedure <span class="italic">raise_salary</span> is stored in a package named <span class="italic">emp_actions</span>, so you must use dot notation to fully qualify the procedure call:
                        </p><pre class="oac_no_warn" dir="ltr">EXEC SQL EXECUTE
 BEGIN
 emp_actions.raise_salary(:emp_id, :increase);
 END;
END-EXEC;
</pre><p>An actual IN parameter can be a literal, host variable, host array, PL/SQL constant or variable, PL/SQL table, PL/SQL user-defined record, subprogram call, or expression. However, an actual OUT parameter cannot be a literal, subprogram call, or expression.</p>
                        <p>In the Pro*C example, three of the formal parameters are PL/SQL tables, and the corresponding actual parameters are host arrays. The program calls the stored procedure <span class="italic">get_employees</span> repeatedly, displaying each batch of employee data, until no more data is found.
                        </p><pre class="oac_no_warn" dir="ltr">#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
typedef char asciz;
EXEC SQL BEGIN DECLARE SECTION;
 /* Define type for null-terminated strings */
 EXEC SQL TYPE asciz IS STRING(20);
 asciz username[20];
 asciz password[20];
 int dept_no; /* which department to query */
 char emp_name[10][21];
 char job[10][21];
 float salary[10];
 int done_flag;
 int array_size;
 int num_ret; /* number of rows returned */
 int SQLCODE;
EXEC SQL END DECLARE SECTION;
EXEC SQL INCLUDE sqlca;
int print_rows(); /* produces program output */
int sql_error(); /* handles NOLOGGING errors */
main()
{
 int i;
 /* Connect to Oracle. */
 strcpy(username, "SCOTT");
 strcpy(password, "TIGER");
 EXEC SQL WHENEVER SQLERROR DO sql_error();
 EXEC SQL CONNECT :username IDENTIFIED BY :password;
 printf("\nConnected to Oracle as user: %s\n", username);
 printf("enter department number: ");
 scanf("%d", &amp;dept_no);
 fflush(stdin);
 /* Set the array size. */
 array_size = 10;
 done_flag = 0;
 num_ret = 0;
 /* Array fetch loop - ends when done_flag is true. */
 for (;;)
 {
 EXEC SQL EXECUTE
 BEGIN emp_actions.get_employees
 (:dept_no, :array_size, :num_ret,
 :done_flag, :emp_name, :job, :salary);
 END;
 END-EXEC;
 print_rows(num_ret);
 if (done_flag)
 break;
 }
 /* Disconnect from the database. */
 EXEC SQL COMMIT WORK RELEASE;
 exit(0);
}
print_rows(n)
int n;
{
 int i;
 if (n == 0)
 {
 printf("No rows retrieved.\n");
 return;
 }
 printf("\n\nGot %d row%c\n", n, n == 1 ? '\0' : 's');
 printf("%-20.20s%-20.20s%s\n", "Ename", "Job", "Salary");
 for (i = 0; i &lt; n; i++)
 printf("%20.20s%20.20s%6.2f\n",
 emp_name[i], job[i], salary[i]);
}
sql_error()
{
 EXEC SQL WHENEVER SQLERROR CONTINUE;
 printf("\nOracle error detected:");
 printf("\n% .70s \n", sqlca.sqlerrm.sqlerrmc);
 EXEC SQL ROLLBACK WORK RELEASE;
 exit(1);
}
</pre><p>Remember, the datatype of each actual parameter must be convertible to the datatype of its corresponding formal parameter. Also, before a stored subprogram exits, all OUT formal parameters must be assigned values. Otherwise, the values of corresponding actual parameters are indeterminate.</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ZZPRE321"></a><div class="props_rev_3"><a id="GUID-AD4526ED-8DAA-4336-B671-5B89C9A13405" name="GUID-AD4526ED-8DAA-4336-B671-5B89C9A13405"></a><h4 id="ZZPRE-GUID-AD4526ED-8DAA-4336-B671-5B89C9A13405" class="sect4"><span class="enumeration_section">5.7.3 </span>Remote Access
                  </h4>
                  <div>
                     <p>PL/SQL lets you access remote databases through <span class="italic">database links</span>. Typically, database links are established by your DBA and stored in the Oracle data dictionary. A database link tells Oracle where the remote database is located, the path to it, and what Oracle username and password to use. In the following example, you use the database link <span class="italic">dallas</span> to call the <span class="italic">raise_salary</span> procedure:
                     </p><pre class="oac_no_warn" dir="ltr">EXEC SQL EXECUTE
 BEGIN
 raise_salary@dallas(:emp_id, :increase);
 END;
END-EXEC;
</pre><p>You can create synonyms to provide location transparency for remote subprograms, as the following example shows:</p><pre class="oac_no_warn" dir="ltr">CREATE PUBLIC SYNONYM raise_salary FOR raise_salary@dallas;
</pre></div>
               </div><a id="ZZPRE322"></a><div class="props_rev_3"><a id="GUID-EA5AC63F-B2CA-4F4C-B6BB-703C834298A5" name="GUID-EA5AC63F-B2CA-4F4C-B6BB-703C834298A5"></a><h4 id="ZZPRE-GUID-EA5AC63F-B2CA-4F4C-B6BB-703C834298A5" class="sect4"><span class="enumeration_section">5.7.4 </span>Getting Information about Stored Subprograms
                  </h4>
                  <div>
                     <p>In <a href="meeting-program-requirements.html#GUID-ED71BADE-AF94-4074-B4B1-140E03903E88"> Meeting Program Requirements</a>, you learned how to embed OCI calls in your host program. After calling the library routine <code class="codeph">SQLLDA</code> to set up the LDA, you can use the OCI call <code class="codeph">ODESSP</code> to get useful information about a stored subprogram. When you call <code class="codeph">ODESSP</code>, you must pass it a valid LDA and the name of the subprogram. For packaged subprograms, you must also pass the name of the package. <code class="codeph">ODESSP</code> returns information about each subprogram parameter such as its datatype, size, position, and so on.
                     </p>
                     <p>You can also use the procedure <span class="italic">describe_procedure</span> in package DBMS_DESCRIBE, which is supplied with Oracle.
                     </p>
                  </div>
               </div>
            </div><a id="ZZPRE323"></a><div class="props_rev_3"><a id="GUID-0DBFAB55-C488-4C26-AEB3-422132DBB805" name="GUID-0DBFAB55-C488-4C26-AEB3-422132DBB805"></a><h3 id="ZZPRE-GUID-0DBFAB55-C488-4C26-AEB3-422132DBB805" class="sect3"><span class="enumeration_section">5.8 </span>About Using Dynamic PL/SQL
               </h3>
               <div>
                  <p>Recall that the Oracle Precompilers treat an entire PL/SQL block like a single SQL statement. Therefore, you can store a PL/SQL block in a string host variable. Then, if the block contains no host variables, you can use dynamic SQL Method 1 to execute the PL/SQL string. Or, if the block contains a known number of host variables, you can use dynamic SQL Method 2 to prepare and execute the PL/SQL string. If the block contains an unknown number of host variables, you must use dynamic SQL Method 4. For more information, refer to <a href="using-dynamic-SQL.html#GUID-5C0F172A-6D8C-45FC-8F23-B544995108FE"> Using Dynamic SQL</a>.
                  </p>
               </div><a id="ZZPRE324"></a><div class="props_rev_3"><a id="GUID-FF33A61C-305D-44FD-92F4-5548AEE8FEDE" name="GUID-FF33A61C-305D-44FD-92F4-5548AEE8FEDE"></a><h4 id="ZZPRE-GUID-FF33A61C-305D-44FD-92F4-5548AEE8FEDE" class="sect4"><span class="enumeration_section">5.8.1 </span>Restriction
                  </h4>
                  <div>
                     <p>In dynamic SQL Method 4, a host array cannot be bound to a PL/SQL procedure with a parameter of type <code class="codeph">TABLE</code>.
                     </p>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>