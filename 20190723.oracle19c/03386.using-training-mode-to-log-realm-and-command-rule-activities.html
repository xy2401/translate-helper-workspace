<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="Simulation mode writes violations to the simulation log instead of preventing SQL execution to quickly test new and modified Oracle Database Vault controls.">
      <meta name="description" content="Simulation mode writes violations to the simulation log instead of preventing SQL execution to quickly test new and modified Oracle Database Vault controls.">
      <title>Using Simulation Mode for Logging Realm and Command Rule Activities</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Administrator's Guide ">
      <meta property="og:description" content="Simulation mode writes violations to the simulation log instead of preventing SQL execution to quickly test new and modified Oracle Database Vault controls.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Administrator's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="database-vault-administrators-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-01-28T15:24:22-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96302-02">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="configuring-oracle-database-vault-policies.html" title="Previous" type="text/html">
      <link rel="next" href="integrating-database-vault-with-other-oracle-products.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database Vault Administrator's Guide">
    <meta name="dcterms.isVersionOf" content="DVADM">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="configuring-oracle-database-vault-policies.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="integrating-database-vault-with-other-oracle-products.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Administrator's Guide </span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Using Simulation Mode for Logging Realm and Command Rule Activities</li>
            </ol>
            <a id="GUID-23CA88C2-C52C-4676-8564-2395898BECE7" name="GUID-23CA88C2-C52C-4676-8564-2395898BECE7"></a>
            
            <h2 id="DVADM-GUID-23CA88C2-C52C-4676-8564-2395898BECE7" class="sect2"><span class="enumeration_chapter">10 </span>Using Simulation Mode for Logging Realm and Command Rule Activities
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>Simulation mode writes violations to the simulation log instead of preventing SQL execution to quickly test new and modified Oracle Database Vault controls.</p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-FE4E06E7-42E3-4743-8750-83D9B5ED0723">About Simulation Mode</a><br>Simulation mode enables you to capture violations in a simulation log instead of blocking SQL execution by Oracle Database Vault realms and command rules.
                  </li>
                  <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-8E572333-F101-4BCE-A89C-AFE1A83728C2">Simulation Mode Use Cases</a><br>Simulation mode is useful for testing a development configuration of new realms and command rules. 
                  </li>
                  <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-5487F685-D481-49E6-B990-20CC319219C0">Logging Realms in Simulation Mode</a><br>You can set both regular and mandatory realms in simulation mode. 
                  </li>
                  <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-8BB95940-7D8D-4AEB-9A53-246BA2AEED4C">Tutorial: Tracking Violations to a Realm Using Simulation Mode</a><br>This tutorial shows how to create a realm that uses simulation mode and then test violations to the realm. 
                  </li>
                  <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-D60381F6-9D4F-40FC-A409-FB144FE490C6">Use Cases and Guidelines for Logging Realms in Simulation Mode</a><br>Oracle provides a set of use cases and guidelines for logging realms in simulation mode.
                  </li>
               </ul>
            </div>
            
            <div class="sect2"><a id="GUID-FE4E06E7-42E3-4743-8750-83D9B5ED0723" name="GUID-FE4E06E7-42E3-4743-8750-83D9B5ED0723"></a><h3 id="DVADM-GUID-FE4E06E7-42E3-4743-8750-83D9B5ED0723" class="sect3">About Simulation Mode</h3>
               <div>
                  <p>Simulation mode enables you to capture violations in a simulation log instead of blocking SQL execution by Oracle Database Vault realms and command rules.</p>
                  <p>Simulation mode stores the errors that are captured in one location for easy analysis. To use simulation mode, when you create or update a realm or command rule, instead of enabling or disabling the realm or command rule, you can set it to simulation mode. The realm or command rule is still enabled, but because violations are not blocked and are instead recorded to the simulation log file, you can test it for any potential errors before you enable it for a production environment. When simulation mode is enabled, the report may include violations for multiple realms or command rules. For more detailed reports that can help you better identify the source of user SQL statements, you can configure simulation mode to include the PL/SQL call stack. The call stack captures the calling procedures and functions recursively to better troubleshoot the Database Vault audit records. Call stack information is stored in the <code class="codeph">PL_SQL_STACK</code> column in the <code class="codeph">DVSYS.DBA_DV_SIMULATION_LOG</code> data dictionary view.
                  </p>
                  <p>For example, the following creation statement for a realm enables simulation mode and generates the PL/SQL call stack:</p><pre class="oac_no_warn" dir="ltr">BEGIN
 DBMS_MACADM.CREATE_REALM(
 realm_name    =&gt; 'HR Apps',
 description   =&gt; 'Realm to protect the HR realm', 
 enabled       =&gt; DBMS_MACUTL.G_SIMULATION,
 audit_options =&gt; DBMS_MACUTL.G_REALM_AUDIT_FAIL,
 realm_type    =&gt; 1,
 realm_scope   =&gt; DBMS_MACUTL.G_SCOPE_LOCAL,
 pl_sql_stack  =&gt; TRUE);
END; 
/</pre><p>At this stage, SQL statements that violate realms or command rules are still able to execute, but these activities are recorded to the <code class="codeph">DBA_DV_SIMULATION_LOG</code> data dictionary view. For example, the following query finds violations against the HR Apps realm and any other realms or command rules that have been configured for simulation mode:
                  </p><pre class="oac_no_warn" dir="ltr">SELECT USERNAME, COMMAND, SQLTEXT, VIOLATION_TYPE FROM DBA_DV_SIMULATION_LOG WHERE REALM_NAME = "HR APPS";

USERNAME  COMMAND    SQLTEXT                          VIOLATION_TYPE            
    
--------  ---------- -------------------------------  --------------
DGRANT    SELECT     SELECT SALARY FROM HR.EMPLOYEES; Realm Violation</pre><p>After you have completed testing the realm or command rule, a user who has been granted the <code class="codeph">DV_ADMIN</code> or <code class="codeph">DV_OWNER</code> role can clear the <code class="codeph">DBA_DV_SIMULATION_LOG</code> data dictionary view by deleting the contents of the underlying table of this view, <code class="codeph">DVSYS.SIMULATION_LOG$</code>. 
                  </p>
                  <p>For example: </p><pre class="oac_no_warn" dir="ltr">DELETE FROM DVSYS.SIMULATION_LOG$;</pre><p>Or:</p><pre class="oac_no_warn" dir="ltr">DELETE FROM DVSYS.SIMULATION_LOG$ WHERE COMMAND = 'SELECT';</pre></div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-23CA88C2-C52C-4676-8564-2395898BECE7" title="Simulation mode writes violations to the simulation log instead of preventing SQL execution to quickly test new and modified Oracle Database Vault controls.">Using Simulation Mode for Logging Realm and Command Rule Activities</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-8E572333-F101-4BCE-A89C-AFE1A83728C2" name="GUID-8E572333-F101-4BCE-A89C-AFE1A83728C2"></a><h3 id="DVADM-GUID-8E572333-F101-4BCE-A89C-AFE1A83728C2" class="sect3">Simulation Mode Use Cases</h3>
               <div>
                  <p>Simulation mode is useful for testing a development configuration of new realms and command rules. </p>
                  <p>Use cases are as follows:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Application certification</p>
                        <p>When you are certifying applications, you can use simulation mode as follows in an application test environment:</p>
                        <ol>
                           <li>
                              <p>Put all schemas for the application into mandatory realms with simulation mode enabled. </p>
                           </li>
                           <li>
                              <p>Run a full regression test.</p>
                           </li>
                           <li>
                              <p>Analyze the simulation mode log by querying the <code class="codeph">DBA_DV_SIMULATION_LOG</code> data dictionary view to find who can access these schemas. 
                              </p>
                           </li>
                           <li>
                              <p>Update the realms with new authorizations, and the enable the realms (that is, not using simulation mode).</p>
                           </li>
                           <li>
                              <p>Re-run the regression test. </p>
                           </li>
                        </ol>
                     </li>
                     <li>
                        <p>Introduction of a new command rule</p>
                        <p>You can use simulation mode on a production database that has Oracle Database Vault enabled. </p>
                        <ol>
                           <li>
                              <p>Put the new command rule into production in simulation mode for however many weeks that are necessary. </p>
                           </li>
                           <li>
                              <p>Analyze the simulation mode log by querying <code class="codeph">DBA_DV_SIMULATION_LOG</code> to determine if the command rule is working correctly. 
                              </p>
                           </li>
                           <li>
                              <p>Make changes to the command rule as necessary.</p>
                           </li>
                           <li>
                              <p>Enable the command rule.</p>
                           </li>
                        </ol>
                     </li>
                     <li>
                        <p>Putting a new realm into a production database in simulation mode. </p>
                        <p>This method can help to find the system context information needed to set the trusted path rules in rule sets and find authorized users for realms. </p>
                        <ol>
                           <li>
                              <p>Create the new realm in mandatory mode and add the protected objects</p>
                           </li>
                           <li>
                              <p>Do not add any authorized users.</p>
                           </li>
                           <li>
                              <p>Run applications and development operations from the normal IP addresses that will be used.</p>
                           </li>
                           <li>
                              <p>Check the simulation log file for both authorized users and system context information that you can use to create trusted paths.</p>
                           </li>
                           <li>
                              <p>Create the trusted paths, and then add the authorized users.</p>
                           </li>
                           <li>
                              <p>Clear the simulation log and run the application and development operation tasks again.</p>
                           </li>
                           <li>
                              <p>After a period of time, review the simulation log. If all the controls were updated correctly, then the simulation log is empty. Log entries in the simulation mode indicate additional changes that you need to make to the realm and rule sets or the log entries may indicate a malicious use.</p>
                           </li>
                        </ol>
                     </li>
                  </ul>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-23CA88C2-C52C-4676-8564-2395898BECE7" title="Simulation mode writes violations to the simulation log instead of preventing SQL execution to quickly test new and modified Oracle Database Vault controls.">Using Simulation Mode for Logging Realm and Command Rule Activities</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-5487F685-D481-49E6-B990-20CC319219C0" name="GUID-5487F685-D481-49E6-B990-20CC319219C0"></a><h3 id="DVADM-GUID-5487F685-D481-49E6-B990-20CC319219C0" class="sect3">Logging Realms in Simulation Mode</h3>
               <div>
                  <p>You can set both regular and mandatory realms in simulation mode. </p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-2AAA8F0B-1BAF-4447-B9E4-61FCA8B80775">Considerations When Logging Realms in Simulation Mode</a><br>There are several use cases to consider if you want to use realms in simulation mode.
                     </li>
                     <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-EBBAB054-8139-4E2B-876C-C06FA5F8DD4D">Use Case: All New Realms in Simulation Mode</a><br>In this use case, all realms are either mandatory or regular and all user-created realms are in simulation mode. 
                     </li>
                     <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-06AF9BEA-4FCF-4FC4-9099-66C426B39048">Use Case: New Realms Introduced to Existing Realms</a><br>In this use case, you add a set of new realms to a database that has an existing set of realms. 
                     </li>
                     <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-DCFE00C3-7A46-404F-969D-C7BB019219FD">Use Case: Testing the Addition of New Objects in a Realm</a><br>In this use case, you add new objects to an existing realm and then test it using simulation mode without removing the current realm protections. 
                     </li>
                     <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-0963EA64-53C8-4E9E-8B06-E1280D406E71">Use Case: Testing the Removal of Objects from a Realm</a><br>In this use case, you test the removal of objects to an existing realm. 
                     </li>
                     <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-39B63BF4-4A03-45B4-A0C8-4C7821E0C370">Use Case: Testing the Addition of an Authorized User to a Realm</a><br>In this use case, you loosen security controls by adding more users. You do not need to simulate anything if you are simply adding more authorized users.
                     </li>
                     <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-B677F532-E093-4B29-928A-9344F3FA28A9">Use Case: Testing the Removal of an Authorized User from a Realm</a><br>In this use case, you want to drop an authorized user and use simulation mode to check if the user still needs to access the realm.
                     </li>
                     <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-01ED0923-611C-440D-BAF0-1A88034AFF0A">Use Case: Testing New Factors with Realms</a><br>In this use case, you want to test changes to factors.
                     </li>
                     <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-FDD5237B-5A2E-406D-A031-9ECF849949CF">Use Case: Testing Changes to an Existing Command Rule</a><br>In this use case, you test changes to an existing command rule while keeping the original command rule enabled. 
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-23CA88C2-C52C-4676-8564-2395898BECE7" title="Simulation mode writes violations to the simulation log instead of preventing SQL execution to quickly test new and modified Oracle Database Vault controls.">Using Simulation Mode for Logging Realm and Command Rule Activities</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="sect3"><a id="GUID-2AAA8F0B-1BAF-4447-B9E4-61FCA8B80775" name="GUID-2AAA8F0B-1BAF-4447-B9E4-61FCA8B80775"></a><h4 id="DVADM-GUID-2AAA8F0B-1BAF-4447-B9E4-61FCA8B80775" class="sect4">Considerations When Logging Realms in Simulation Mode</h4>
                  <div>
                     <p>There are several use cases to consider if you want to use realms in simulation mode.</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Testing an application with all new Database Vault controls: all realms are in simulation mode</p>
                        </li>
                        <li>
                           <p>Adding a realm to existing working Database Vault controls: only a subset of realms are in simulation mode</p>
                        </li>
                        <li>
                           <p>Adding new objects to an existing enabled realm and then testing the difference with simulation mode and not disabling existing controls</p>
                        </li>
                        <li>
                           <p>Dropping one or more existing objects from an existing enabled realm and then testing the difference with simulation mode and not disabling existing controls</p>
                        </li>
                        <li>
                           <p>Adding new authorized users to an existing enabled realm and then testing the difference with simulation mode and not disabling existing controls</p>
                        </li>
                        <li>
                           <p>Dropping one or more existing authorized users from an existing enabled realm and then testing the difference with simulation mode and not disabling existing controls</p>
                        </li>
                        <li>
                           <p>Adding or changing factors in an existing enabled realm and then testing the difference with simulation mode and not disabling existing controls</p>
                        </li>
                        <li>
                           <p>Testing changes to a command rule in production while keeping the original command rule enabled</p>
                        </li>
                     </ul>
                     <p>When a user executes a SQL statement and it fails, it may fail for realms that are enabled, fail for realms that are simulated, or it could fail for both of these reasons. There could be mandatory realms, regular realms, or both. These conditions determine the data that is captured in the simulation log.</p>
                     <p>After you create the use cases that are described in the next sections, regular realms are completely overpowered by mandatory realms when an object has both types of realms protecting it. In all cases where mandatory and regular realms protect the same object, regular realms can be ignored with regard to simulation logs. Only mandatory realm failures are captured in the simulation logs. The only time regular realm failures are entered into the simulation log is when all realms for an object are regular realms. And then, the following must happen for regular realms to be written to the simulation log:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>All regular realms in simulation mode fails and</p>
                        </li>
                        <li>
                           <p>All regular realms that are enabled also fail</p>
                        </li>
                     </ul>
                     <p>If at least one enabled or simulation regular realm succeeds, then no simulation regular realms are logged.</p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-5487F685-D481-49E6-B990-20CC319219C0" title="You can set both regular and mandatory realms in simulation mode.">Logging Realms in Simulation Mode</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-EBBAB054-8139-4E2B-876C-C06FA5F8DD4D" name="GUID-EBBAB054-8139-4E2B-876C-C06FA5F8DD4D"></a><h4 id="DVADM-GUID-EBBAB054-8139-4E2B-876C-C06FA5F8DD4D" class="sect4">Use Case: All New Realms in Simulation Mode</h4>
                  <div>
                     <p>In this use case, all realms are either mandatory or regular and all user-created realms are in simulation mode. </p>
                     <p>Examples are as follows:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Mandatory realms only, which are all in simulation mode</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>The user is authorized to execute the SQL statement in all mandatory realms. Nothing is captured in the simulation log table.</p>
                              </li>
                              <li>
                                 <p>The user fails one or more mandatory realm checks. All realm check failures are logged to the simulation log. Mandatory realm checks where the user’s SQL statement succeeded is not logged.</p>
                                 <p>In this example, there are three mandatory realms. The user SQL statement succeeds with one realm and fails with the other two. Only the two failed realm checks are recorded in the simulation log.</p>
                              </li>
                           </ul>
                        </li>
                        <li>
                           <p>Regular realms only, which are all in simulation mode</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>The user is authorized to execute the SQL statement in at least one regular realm. The user should have access to the data so nothing is logged to the simulation log.</p>
                              </li>
                              <li>
                                 <p>The user is not authorized to execute the SQL statement in all regular realms. The simulation log captures all the failed realm authorization failures. This enables the user to select which realm to which the user should be authorized. The SQL only needs to be authorized in one regular realm to work and not all regular realms need to be updated to authorize the SQL.</p>
                              </li>
                           </ul>
                        </li>
                        <li>
                           <p>Mix of mandatory and regular realms, which are all in simulation mode</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>In this case, you capture the key realms when a user is rejected. In the case with mandatory and regular realms, the mandatory realms are the key realms. All mandatory realms must pass the authorization check for the user to gain access. In fact, regular realms could be considered superfluous when mandatory realms are protecting an object. So in cases where there are both mandatory and regular realms protecting the same object, it is only the mandatory realms that control if the SQL statement is blocked or allowed to execute. It does not matter whether the user was authorized to the regular realm or not. This example follows the rules for the first scenario, for mandatory realms in simulation mode. </p>
                              </li>
                              <li>
                                 <p>The user is authorized to execute the SQL statement in all mandatory realms. Nothing is captured in the simulation log table. Even though the user may succeed or fail in one or more regular realms, nothing about regular realm failure is captured.</p>
                              </li>
                              <li>
                                 <p>The user fails one or more mandatory realm checks. All realm check failures are logged to the simulation log. Mandatory realm checks where the user SQL statement succeeded are not be logged.</p>
                                 <p>For example, there are three mandatory realms. The user SQL statement succeeds with one realm and fails with the other two. Only the two failed realm checks are recorded in the simulation log.</p>
                                 <p>No regular realms need to be captured, because only the mandatory realms need to be captured in the simulation log.</p>
                              </li>
                           </ul>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-5487F685-D481-49E6-B990-20CC319219C0" title="You can set both regular and mandatory realms in simulation mode.">Logging Realms in Simulation Mode</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-06AF9BEA-4FCF-4FC4-9099-66C426B39048" name="GUID-06AF9BEA-4FCF-4FC4-9099-66C426B39048"></a><h4 id="DVADM-GUID-06AF9BEA-4FCF-4FC4-9099-66C426B39048" class="sect4">Use Case: New Realms Introduced to Existing Realms</h4>
                  <div>
                     <p>In this use case, you add a set of new realms to a database that has an existing set of realms. </p>
                     <p>The existing realms are enabled and working. The new realms are in simulation mode. This use case applies only if both simulation and enabled realms are protecting the same object. </p>
                     <p>Examples: </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>New mandatory realms in simulation mode with existing enabled mandatory realms. This use case shows some additional mandatory realms for an object: adding more security to an existing object.</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>Enabled mandatory realms and mandatory realms in simulation mode all successful with user SQL statement: in this case, the SQL executes normally and nothing is captured</p>
                              </li>
                              <li>
                                 <p>Enabled mandatory realms (at least one) fails and mandatory realms in simulation mode all successful: SQL is blocked and nothing is written to the simulation log</p>
                              </li>
                              <li>
                                 <p>Enabled mandatory realms (at least one) fails and mandatory realms in simulation mode has one or more failures: SQL is blocked and all failing mandatory realms in simulation mode are entered into simulation log</p>
                              </li>
                              <li>
                                 <p>Enabled mandatory realms all successful and mandatory realms in simulation mode have at least one failure: SQL is not blocked, all failed mandatory realms in simulation mode entered into simulation log</p>
                              </li>
                           </ul>
                        </li>
                        <li>
                           <p>New regular realms in simulation mode with existing enabled regular realms: More regular realms are added to a security object, providing new ways for users to access sensitive data</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>Enabled regular realms (at least one) and regular realms in simulation mode (at least one) successful: the user SQL executes normally with nothing written to simulation log</p>
                              </li>
                              <li>
                                 <p>Enabled regular realms (at least one) is successful, and regular realms in simulation mode all fail: user SQL executes normally, nothing is entered into the simulation log</p>
                              </li>
                              <li>
                                 <p>Enabled regular realms all fail and regular realms in simulation mode all fail: the user SQL is blocked and all regular realms in simulation mode are entered into simulation log. The user must evaluate which regular realm to authorize to if needed. The current implementation blocks the SQL and does not add the regular realms in simulation mode into the simulation log because the enabled regular realm would have blocked it anyway. This must change because the user may have added a new realm to authorize the SQL in this use case. There is no way to tell what happened if the new SQL should have worked, but is blocked by all regular realms in simulation mode as well (when one of the regular realms in simulation mode was designed to allow it to work). This would simulate an entry into the audit log for this situation.</p>
                              </li>
                              <li>
                                 <p>Enabled regular realms all fail and regular realms in simulation mode (at least one) successful: the user SQL is blocked and nothing is written to the simulation log.</p>
                              </li>
                           </ul>
                        </li>
                        <li>
                           <p>New regular realms with existing enabled mandatory realms: You do not need to do anything in this situation. The enabled mandatory realms will continue to control the objects and the new regular realms in simulation mode will have no impact if they are enabled or not. No simulation logs should be generated in this case.</p>
                        </li>
                        <li>
                           <p>New mandatory realms in simulation mode with existing enabled regular realm: While the enabled regular realm controls the objects for now, when the new mandatory realms in simulation mode are enabled, then they will have full control over the objects with no control by the older enabled regular realms. So, simulation logs will be created for all mandatory realms. This is the same as the scenario for new mandatory realms with existing enabled mandatory realms. </p>
                        </li>
                        <li>
                           <p>New regular realms in simulation mode with existing enabled mandatory and regular realms: The enabled mandatory realms will be the deciding realms whether the new regular realms in simulation mode are added to the existing enabled regular realms in the system. This is the same as the scenario as a mix of mandatory and regular realms, all in simulation mode. Nothing is written to the simulation logs.</p>
                        </li>
                        <li>
                           <p>New mandatory realms in simulation mode with enabled mandatory and regular realms: The enabled regular realms can be ignored. This is the same as the scenario for new mandatory realms with existing enabled mandatory realms. </p>
                        </li>
                        <li>
                           <p>Mix of new mandatory and regular realms in simulation mode with existing enabled mandatory and regular realms: Ignore all enabled and mandatory regular realms. This is simply adding more mandatory realms to an existing object. This is the same scenario as new mandatory realms with existing enabled mandatory realms. </p>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-5487F685-D481-49E6-B990-20CC319219C0" title="You can set both regular and mandatory realms in simulation mode.">Logging Realms in Simulation Mode</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-DCFE00C3-7A46-404F-969D-C7BB019219FD" name="GUID-DCFE00C3-7A46-404F-969D-C7BB019219FD"></a><h4 id="DVADM-GUID-DCFE00C3-7A46-404F-969D-C7BB019219FD" class="sect4">Use Case: Testing the Addition of New Objects in a Realm</h4>
                  <div>
                     <p>In this use case, you add new objects to an existing realm and then test it using simulation mode without removing the current realm protections. </p>
                     <p>Oracle recommends that you create a duplicate realm in simulation mode for the new objects with the same authorized users and rule sets. This way, the existing realm can continue to provide protection to the existing objects while testing the new object.</p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-5487F685-D481-49E6-B990-20CC319219C0" title="You can set both regular and mandatory realms in simulation mode.">Logging Realms in Simulation Mode</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-0963EA64-53C8-4E9E-8B06-E1280D406E71" name="GUID-0963EA64-53C8-4E9E-8B06-E1280D406E71"></a><h4 id="DVADM-GUID-0963EA64-53C8-4E9E-8B06-E1280D406E71" class="sect4">Use Case: Testing the Removal of Objects from a Realm</h4>
                  <div>
                     <p>In this use case, you test the removal of objects to an existing realm. </p>
                     <p>Because you are removing security controls for an existing object, there is no need to use simulation mode. Simply remove the object from the realm.</p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-5487F685-D481-49E6-B990-20CC319219C0" title="You can set both regular and mandatory realms in simulation mode.">Logging Realms in Simulation Mode</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-39B63BF4-4A03-45B4-A0C8-4C7821E0C370" name="GUID-39B63BF4-4A03-45B4-A0C8-4C7821E0C370"></a><h4 id="DVADM-GUID-39B63BF4-4A03-45B4-A0C8-4C7821E0C370" class="sect4">Use Case: Testing the Addition of an Authorized User to a Realm</h4>
                  <div>
                     <p>In this use case, you loosen security controls by adding more users. You do not need to simulate anything if you are simply adding more authorized users.</p>
                     <p>If you are adding new functionality that is accessing data in a realm, but are not sure which new database users to authorize to the realm, then simply run the new functionality as a test (which will be blocked if not already authorized). Review the Database Vault audit logs to see the user name that attempted to access the realm data and add any new database users that are now authorized.</p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-5487F685-D481-49E6-B990-20CC319219C0" title="You can set both regular and mandatory realms in simulation mode.">Logging Realms in Simulation Mode</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-B677F532-E093-4B29-928A-9344F3FA28A9" name="GUID-B677F532-E093-4B29-928A-9344F3FA28A9"></a><h4 id="DVADM-GUID-B677F532-E093-4B29-928A-9344F3FA28A9" class="sect4">Use Case: Testing the Removal of an Authorized User from a Realm</h4>
                  <div>
                     <p>In this use case, you want to drop an authorized user and use simulation mode to check if the user still needs to access the realm.</p>
                     <p>You may not be sure about dropping this user because you must check if the authorized user is accessing the realm for authorized activities. </p>
                     <p>If the data is only protected by a regular realm, then you can clone the realm with authorized users as the only difference. Remove the user to be dropped from the original realm and then add this user to the cloned realm. Then the cloned realm’s audit setting is changed to capture <code class="codeph">audit on success</code>.  This enables the dropped user to be visible in the audit records if they accessed the realm over a period of time. Audit policies can also be used in this case. For data that is protected by a mandatory realm, the best solution is to create an audit policy.
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-5487F685-D481-49E6-B990-20CC319219C0" title="You can set both regular and mandatory realms in simulation mode.">Logging Realms in Simulation Mode</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-01ED0923-611C-440D-BAF0-1A88034AFF0A" name="GUID-01ED0923-611C-440D-BAF0-1A88034AFF0A"></a><h4 id="DVADM-GUID-01ED0923-611C-440D-BAF0-1A88034AFF0A" class="sect4">Use Case: Testing New Factors with Realms</h4>
                  <div>
                     <p>In this use case, you want to test changes to factors.</p>
                     <p>There are two scenarios where the factors can change: </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Changes to an application or the infrastructure that force a change to the factors</p>
                           <p>In this case, you do not need to keep the original factors in place. However, objects and authorized users should be able to remain enabled during the testing of the new factors. With an enabled realm, you can remove the factors from the authorized users. At the same time, create a mandatory realm for the same protected objects in simulation mode with no authorized users. The regular realm will protect the objects from unauthorized users while the simulation realm will capture all access along with the factor information. The simulation log can then be mined for each user to come up with the new factors which can then be added to the mandatory realm in simulation mode to make sure it’s clean before being migrated to the original regular realm.</p>
                        </li>
                        <li>
                           <p>No changes to the application or the infrastructure but changes such as new factors being added or factors being removed take place</p>
                           <p>When factors are being added, you must clone a second simulation realm from the original, but with the new factors added in. If the simulation logs shows that the usage is clean, then you can safely introduce the new factors into the original realm.</p>
                           <p>Dropping factors lowers the security profile, so you can simply drop the factor from the rule set.  No testing needs to be done.</p>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-5487F685-D481-49E6-B990-20CC319219C0" title="You can set both regular and mandatory realms in simulation mode.">Logging Realms in Simulation Mode</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-FDD5237B-5A2E-406D-A031-9ECF849949CF" name="GUID-FDD5237B-5A2E-406D-A031-9ECF849949CF"></a><h4 id="DVADM-GUID-FDD5237B-5A2E-406D-A031-9ECF849949CF" class="sect4">Use Case: Testing Changes to an Existing Command Rule</h4>
                  <div>
                     <p>In this use case, you test changes to an existing command rule while keeping the original command rule enabled. </p>
                     <p>Command rules may need to be updated and ideally tested before the changes are enabled in production. For a new command rule that will be added to a set of already existing command rules, put the new command rule into simulation mode when you create it. The other pre-existing command rules are already enabled and offer protection.</p>
                     <p>If you want to modify an existing command rule, there is no way to maintain the existing protection and test the new modification. Oracle recommends that you create an audit policy to capture what the original command rule was doing and then set an alert for it. The audit will not prevent the SQL as a command rule would do, but at least you can be alerted about the action. Then you can put the new updated command rule into simulation mode and test it.</p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-5487F685-D481-49E6-B990-20CC319219C0" title="You can set both regular and mandatory realms in simulation mode.">Logging Realms in Simulation Mode</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
            <div class="sect2"><a id="GUID-8BB95940-7D8D-4AEB-9A53-246BA2AEED4C" name="GUID-8BB95940-7D8D-4AEB-9A53-246BA2AEED4C"></a><h3 id="DVADM-GUID-8BB95940-7D8D-4AEB-9A53-246BA2AEED4C" class="sect3">Tutorial: Tracking Violations to a Realm Using Simulation Mode</h3>
               <div>
                  <p>This tutorial shows how to create a realm that uses simulation mode and then test violations to the realm. </p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-A7AE4EB7-B00A-42E1-BCFD-D914BD36F8A3">About This Tutorial</a><br>In this tutorial, you will create a realm around the <code class="codeph">HR.EMPLOYEES</code> table and test violations against it.
                     </li>
                     <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-A33AA63A-9DC2-4482-92E8-714823CC965F">Step 1: Create Users for This Tutorial</a><br>You must create three users for this tutorial. 
                     </li>
                     <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-6AE7A50C-6498-4D86-8EC4-537E30920482">Step 2: Create a Realm and an Oracle Database Vault Policy</a><br>Next, you create a realm around the <code class="codeph">HR.EMPLOYEES</code> table, and then add this realm to an Oracle Database Vault policy.
                     </li>
                     <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-650EA278-861B-4F50-BAAF-1323621E491B">Step 3: Test the Realm and Policy</a><br>User <code class="codeph">tjones_dba</code> will commit a violation on the realm to test the realm and policy. 
                     </li>
                     <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-79944EF8-A802-4D5B-AC3F-302F926D9A35">Step 4: Query the DBA_DV_SIMULATION_LOG View for Violations</a><br>Now you can check the simulation mode log the violations that user <code class="codeph">tjones_dba</code> committed.
                     </li>
                     <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-1D92ACE9-1FB6-404F-A026-AB62AA50353A">Step 5: Enable and Re-test the Realm</a><br>Now that you have captured the violations, user <code class="codeph">psmith</code> can update the <code class="codeph">HR.EMPLOYEES_pol</code> policy.
                     </li>
                     <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-6D55E925-85AF-491A-9184-7E4D8636FC47">Step 6: Remove the Components for This Tutorial</a><br>You can remove the components that you created for this tutorial if you no longer need them. 
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-23CA88C2-C52C-4676-8564-2395898BECE7" title="Simulation mode writes violations to the simulation log instead of preventing SQL execution to quickly test new and modified Oracle Database Vault controls.">Using Simulation Mode for Logging Realm and Command Rule Activities</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="sect3"><a id="GUID-A7AE4EB7-B00A-42E1-BCFD-D914BD36F8A3" name="GUID-A7AE4EB7-B00A-42E1-BCFD-D914BD36F8A3"></a><h4 id="DVADM-GUID-A7AE4EB7-B00A-42E1-BCFD-D914BD36F8A3" class="sect4">About This Tutorial</h4>
                  <div>
                     <p>In this tutorial, you will create a realm around the <code class="codeph">HR.EMPLOYEES</code> table and test violations against it.
                     </p>
                     <p>The <code class="codeph">HR.EMPLOYEES</code> table contains confidential data such employee salaries. To test the realm, an administrator, <code class="codeph">tjones_dba</code>, will look up and modify the salary of another employee, <code class="codeph">smavris</code>. The Database Vault administrator, <code class="codeph">leo_dvowner</code>, will use simulation mode to track the violations to the <code class="codeph">HR.EMPLOYEES</code> table. To accomplish this, user <code class="codeph">leo_dvowner</code> will create a Database Vault policy, which a delegated administrator, user <code class="codeph">psmith</code>, will own. User <code class="codeph">psmith</code> will then be able to make limited changes to the policy without needing the <code class="codeph">DV_OWNER</code> or <code class="codeph">DV_ADMIN</code> role.
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-8BB95940-7D8D-4AEB-9A53-246BA2AEED4C" title="This tutorial shows how to create a realm that uses simulation mode and then test violations to the realm.">Tutorial: Tracking Violations to a Realm Using Simulation Mode</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-A33AA63A-9DC2-4482-92E8-714823CC965F" name="GUID-A33AA63A-9DC2-4482-92E8-714823CC965F"></a><h4 id="DVADM-GUID-A33AA63A-9DC2-4482-92E8-714823CC965F" class="sect4">Step 1: Create Users for This Tutorial</h4>
                  <div>
                     <p>You must create three users for this tutorial. </p>
                     <div class="section">The users are: <code class="codeph">psmith</code>, who is the Database Vault policy owner; <code class="codeph">tjones_dba</code>, who commits violations on the <code class="codeph">HR.EMPLOYEES</code> table; and <code class="codeph">smavris</code>, whose salary is the recipient of <code class="codeph">tjones_dba</code>’s violations. 
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Log into the database instance as a user who has been granted the <code class="codeph">DV_ACCTMGR</code> role.</span><div>
                              <p>For example: </p><pre class="oac_no_warn" dir="ltr">sqlplus bea_dvacctmgr
Enter password: <span class="italic">password</span>
</pre><p>In a multitenant environment, you must log in to the appropriate pluggable database (PDB). For example:</p><pre class="oac_no_warn" dir="ltr">CONNECT bea_dvacctmgr@hrpdb
Enter password: <span class="italic">password</span>
</pre><p>To find the available PDBs, run the <code class="codeph">show pdbs</code> command. To check the current PDB, run the <code class="codeph">show con_name</code> command. 
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Create the following users and grant them the <code class="codeph">CREATE SESSION</code> privilege. </span><div><pre class="oac_no_warn" dir="ltr">GRANT CREATE SESSION TO psmith IDENTIFIED BY <span class="italic">password</span>;
GRANT CREATE SESSION TO tjones_dba IDENTIFIED BY <span class="italic">password</span>;
GRANT CREATE SESSION TO smavris IDENTIFIED BY <span class="italic">password</span>;</pre><p>Follow the guidelines in <a href="../dbseg/configuring-authentication.html#DBSEG33223" target="_blank"><span><cite>Oracle Database Security Guide</cite></span></a> to replace <span class="italic"><code class="codeph">password</code></span> with a password that is secure. 
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Connect as a user who has been granted the <code class="codeph">DV_OWNER</code> role. </span><div>For example:<pre class="oac_no_warn" dir="ltr">CONNECT leo_dvowner -- <span class="italic">Or, leo_dvowner@hrpdb
</span>Enter password: <span class="italic">password</span></pre></div>
                        </li>
                        <li class="stepexpand"><span>Grant user <code class="codeph">psmith</code> the <code class="codeph">DV_POLICY_OWNER</code> role, which enables <code class="codeph">psmith</code> to manage Database Vault policies.</span><div><pre class="oac_no_warn" dir="ltr">GRANT DV_POLICY_OWNER TO psmith;</pre></div>
                        </li>
                        <li class="stepexpand"><span>Connect as user <code class="codeph">SYS</code> with the <code class="codeph">SYSDBA</code> administrative privilege. </span><div><pre class="oac_no_warn" dir="ltr">CONNECT SYS AS SYSDBA <span class="italic">-- Or, CONNECT SYS@hrpdb</span> AS SYSDBA
Enter password: <span class="italic">password</span>
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Grant the <code class="codeph">DBA</code> role to user <code class="codeph">tjones_dba</code> </span><div><pre class="oac_no_warn" dir="ltr">GRANT DBA TO tjones_dba;
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Connect as the <code class="codeph">HR</code> schema owner. </span><div><pre class="oac_no_warn" dir="ltr">CONNECT HR <span class="italic">-- Or, HR@hrpdb</span>
Enter password: <span class="italic">password</span></pre></div>
                        </li>
                        <li class="stepexpand"><span>Grant the <code class="codeph">SELECT</code> privilege on the <code class="codeph">HR.EMPLOYEES</code> table to user <code class="codeph">smavris</code> </span><div><pre class="oac_no_warn" dir="ltr">GRANT SELECT ON HR.EMPLOYEES TO smavris;
</pre></div>
                        </li>
                     </ol>
                     <div class="section">At this stage, the users have all been created and granted the appropriate privileges.</div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-8BB95940-7D8D-4AEB-9A53-246BA2AEED4C" title="This tutorial shows how to create a realm that uses simulation mode and then test violations to the realm.">Tutorial: Tracking Violations to a Realm Using Simulation Mode</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-6AE7A50C-6498-4D86-8EC4-537E30920482" name="GUID-6AE7A50C-6498-4D86-8EC4-537E30920482"></a><h4 id="DVADM-GUID-6AE7A50C-6498-4D86-8EC4-537E30920482" class="sect4">Step 2: Create a Realm and an Oracle Database Vault Policy</h4>
                  <div>
                     <p>Next, you create a realm around the <code class="codeph">HR.EMPLOYEES</code> table, and then add this realm to an Oracle Database Vault policy.
                     </p>
                     <ol>
                        <li class="stepexpand"><span>Connect as a user who has been granted the <code class="codeph">DV_OWNER</code> role. </span><div>
                              <p>For example:</p><pre class="oac_no_warn" dir="ltr">CONNECT leo_dvowner -- <span class="italic">Or, leo_dvowner@hrpdb
</span>Enter password: <span class="italic">password</span></pre></div>
                        </li>
                        <li class="stepexpand"><span>Create the realm around <code class="codeph">HR.EMPLOYEES</code> table as follows.</span><div>
                              <p>These procedures create the <code class="codeph">HR.EMPLOYEES_realm</code> realm, add the <code class="codeph">HR.EMPLOYEES</code> table to this realm, authenticate <code class="codeph">HR</code> as an owner, authenticate user <code class="codeph">psmith</code> as an participant, and set the realm in simulation mode.
                              </p><pre class="oac_no_warn" dir="ltr">BEGIN
 DBMS_MACADM.CREATE_REALM(
  realm_name    =&gt; 'HR.EMPLOYEES_realm', 
  description   =&gt; 'Realm to protect HR.EMPLOYEES', 
  enabled       =&gt; DBMS_MACUTL.G_SIMULATION, 
  audit_options =&gt; DBMS_MACUTL.G_REALM_AUDIT_FAIL,
  realm_type    =&gt; 0);
END; 
/

BEGIN
 DBMS_MACADM.ADD_OBJECT_TO_REALM(
  realm_name   =&gt; 'HR.EMPLOYEES_realm', 
  object_owner =&gt; 'HR', 
  object_name  =&gt; 'EMPLOYEES', 
  object_type  =&gt; 'TABLE'); 
END;
/

</pre></div>
                        </li>
                        <li class="stepexpand"><span>Create the <code class="codeph">HR.EMPLOYEES_pol</code> Database Vault policy and set it to be in simulation mode. </span><div>
                              <p>These procedures create the <code class="codeph">HR.EMPLOYEES_pol</code> policy, add the realm that was just created to the policy, and then add user <code class="codeph">psmith</code> as the owner of the policy.
                              </p><pre class="oac_no_warn" dir="ltr">BEGIN
 DBMS_MACADM.CREATE_POLICY(
  policy_name  =&gt; 'HR.EMPLOYEES_pol',
  description  =&gt; 'Policy to protect HR.EMPLOYEES',
  policy_state =&gt; DBMS_MACADM.G_SIMULATION);
END;
/

BEGIN
 DBMS_MACADM.ADD_REALM_TO_POLICY(
  policy_name  =&gt; 'HR.EMPLOYEES_pol',
  realm_name   =&gt; 'HR.EMPLOYEES_realm');
END;
/

BEGIN
 DBMS_MACADM.ADD_OWNER_TO_POLICY(
  policy_name  =&gt; 'HR.EMPLOYEES_pol',
  owner_name   =&gt; 'PSMITH');
END;
/
</pre></div>
                        </li>
                     </ol>
                     <div class="section">At this point, the realm and policy are ready to be tested. </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-8BB95940-7D8D-4AEB-9A53-246BA2AEED4C" title="This tutorial shows how to create a realm that uses simulation mode and then test violations to the realm.">Tutorial: Tracking Violations to a Realm Using Simulation Mode</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-650EA278-861B-4F50-BAAF-1323621E491B" name="GUID-650EA278-861B-4F50-BAAF-1323621E491B"></a><h4 id="DVADM-GUID-650EA278-861B-4F50-BAAF-1323621E491B" class="sect4">Step 3: Test the Realm and Policy</h4>
                  <div>
                     <p>User <code class="codeph">tjones_dba</code> will commit a violation on the realm to test the realm and policy. 
                     </p>
                     <ol>
                        <li class="stepexpand"><span>Connect as user <code class="codeph">tjones_dba</code>. </span><div><pre class="oac_no_warn" dir="ltr">CONNECT tjones_dba -- <span class="italic">Or, tjones_dba@hrpdb
</span>Enter password: <span class="italic">password</span></pre></div>
                        </li>
                        <li class="stepexpand"><span>Query the <code class="codeph">HR.EMPLOYEES</code> table for the salary of <code class="codeph">smavris</code>.</span><div><pre class="oac_no_warn" dir="ltr">SELECT SALARY FROM HR.EMPLOYEES WHERE EMAIL = 'SMAVRIS';</pre><p>Output similar to the following should appear:</p><pre class="oac_no_warn" dir="ltr">    SALARY
----------
      6500

</pre></div>
                        </li>
                        <li class="stepexpand"><span>Cut <code class="codeph">smavris</code>’s salary in half.</span><div><pre class="oac_no_warn" dir="ltr">UPDATE HR.EMPLOYEES
SET SALARY = SALARY / 2
WHERE EMAIL = 'SMAVRIS';

1 row updated.</pre></div>
                        </li>
                        <li class="stepexpand"><span>Connect as user <code class="codeph">smavris</code>.</span><div><pre class="oac_no_warn" dir="ltr">CONNECT smavris <span class="italic">-- Or, smavris@hrpdb</span></pre></div>
                        </li>
                        <li class="stepexpand"><span>Query the salary of <code class="codeph">smavris</code>.</span><div><pre class="oac_no_warn" dir="ltr">SELECT SALARY FROM HR.EMPLOYEES WHERE EMAIL = 'SMAVRIS';</pre><p>Output similar to the following should appear:</p><pre class="oac_no_warn" dir="ltr">    SALARY
----------
      3250
</pre></div>
                        </li>
                     </ol>
                     <div class="section">At this point, <code class="codeph">tjones_dba</code>’s violations have been recorded in the <code class="codeph">DBA_DV_SIMULATION_LOG</code> data dictionary view.
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-8BB95940-7D8D-4AEB-9A53-246BA2AEED4C" title="This tutorial shows how to create a realm that uses simulation mode and then test violations to the realm.">Tutorial: Tracking Violations to a Realm Using Simulation Mode</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-79944EF8-A802-4D5B-AC3F-302F926D9A35" name="GUID-79944EF8-A802-4D5B-AC3F-302F926D9A35"></a><h4 id="DVADM-GUID-79944EF8-A802-4D5B-AC3F-302F926D9A35" class="sect4">Step 4: Query the DBA_DV_SIMULATION_LOG View for Violations</h4>
                  <div>
                     <p>Now you can check the simulation mode log the violations that user <code class="codeph">tjones_dba</code> committed.
                     </p>
                     <ol>
                        <li class="stepexpand"><span>Connect as a user who has been granted the <code class="codeph">DV_OWNER</code> role. </span><div>For example:<pre class="oac_no_warn" dir="ltr">CONNECT leo_dvowner -- <span class="italic">Or, leo_dvowner@hrpdb
</span>Enter password: <span class="italic">password</span></pre></div>
                        </li>
                        <li class="stepexpand"><span>Query the <code class="codeph">DBA_DV_SIMULATION_LOG</code> data dictionary view.</span><div><pre class="oac_no_warn" dir="ltr">SELECT USERNAME, SQLTEXT, VIOLATION_TYPE FROM (
SELECT T1.*, T2.COLUMN_VALUE AS REALM
FROM DVSYS.DBA_DV_SIMULATION_LOG T1, TABLE(T1.REALM_NAME) T2
) WHERE REALM = 'HR.EMPLOYEES_realm';
</pre><p>Output similar to the following should appear:</p><pre class="oac_no_warn" dir="ltr">USERNAME
--------------------------------------------------------------------------------
SQLTEXT
--------------------------------------------------------------------------------
VIOLATION_TYPE
--------------------------------------------------------------------------------
TJONES_DBA
SELECT SALARY FROM HR.EMPLOYEES WHERE EMAIL = 'SMAVRIS'
Realm Violation

TJONES_DBA
UPDATE HR.EMPLOYEES SET SALARY = SALARY / 2 WHERE EMAIL = 'SMAVRIS'
Realm Violation
</pre></div>
                        </li>
                     </ol>
                     <div class="section">The output indicates that user <code class="codeph">tjones_dba</code> has committed two offences: first, he looked at another employee’s salary, and not only that, he cut it in half. The violation type is a realm violation. The query by <code class="codeph">smavris</code> was not captured because she legitimately can look at her salary. 
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-8BB95940-7D8D-4AEB-9A53-246BA2AEED4C" title="This tutorial shows how to create a realm that uses simulation mode and then test violations to the realm.">Tutorial: Tracking Violations to a Realm Using Simulation Mode</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-1D92ACE9-1FB6-404F-A026-AB62AA50353A" name="GUID-1D92ACE9-1FB6-404F-A026-AB62AA50353A"></a><h4 id="DVADM-GUID-1D92ACE9-1FB6-404F-A026-AB62AA50353A" class="sect4">Step 5: Enable and Re-test the Realm</h4>
                  <div>
                     <p>Now that you have captured the violations, user <code class="codeph">psmith</code> can update the <code class="codeph">HR.EMPLOYEES_pol</code> policy.
                     </p>
                     <div class="section">This is  so that the <code class="codeph">HR.EMPLOYEES_realm</code> realm can be enabled. Then you can test the violations again.
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Connect as user <code class="codeph">psmith</code>. </span><div><pre class="oac_no_warn" dir="ltr">CONNECT psmith -- <span class="italic">Or, psmith@hrpdb
</span>Enter password: <span class="italic">password</span></pre></div>
                        </li>
                        <li class="stepexpand"><span>Update the policy so that it is enabled.</span><div><pre class="oac_no_warn" dir="ltr">BEGIN
 DBMS_MACADM.UPDATE_POLICY_STATE(
  policy_name   =&gt; 'HR.EMPLOYEES_pol',
  policy_state  =&gt; 1);
END;
/</pre></div>
                        </li>
                        <li class="stepexpand"><span>Connect as user <code class="codeph">tjones_dba</code>.</span><div><pre class="oac_no_warn" dir="ltr">CONNECT tjones_dba <span class="italic">--Or, tjones_dba@hrpdb</span></pre></div>
                        </li>
                        <li class="stepexpand"><span>Try lowering <code class="codeph">smavris</code>’s salary to new depths.</span><div><pre class="oac_no_warn" dir="ltr">UPDATE HR.EMPLOYEES
SET SALARY = SALARY / 2
WHERE EMAIL = 'SMAVRIS';</pre><p>Output similar to the following should appear:</p><pre class="oac_no_warn" dir="ltr">ERROR at line 1:
ORA-01031: insufficient privileges

</pre></div>
                           <div>The policy, now enabled, enables the realm to protect the <code class="codeph">HR.EMPLOYEES</code> table. <code class="codeph">smavris</code>’s salary can shrink no more.
                           </div>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-8BB95940-7D8D-4AEB-9A53-246BA2AEED4C" title="This tutorial shows how to create a realm that uses simulation mode and then test violations to the realm.">Tutorial: Tracking Violations to a Realm Using Simulation Mode</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-6D55E925-85AF-491A-9184-7E4D8636FC47" name="GUID-6D55E925-85AF-491A-9184-7E4D8636FC47"></a><h4 id="DVADM-GUID-6D55E925-85AF-491A-9184-7E4D8636FC47" class="sect4">Step 6: Remove the Components for This Tutorial</h4>
                  <div>
                     <p>You can remove the components that you created for this tutorial if you no longer need them. </p>
                     <ol>
                        <li class="stepexpand"><span>Connect as a user who has been granted the <code class="codeph">DV_OWNER</code> role.</span><div>For example:<pre class="oac_no_warn" dir="ltr">CONNECT leo_dvowner -- <span class="italic">Or, leo_dvowner@hrpdb
</span>Enter password: <span class="italic">password</span></pre></div>
                        </li>
                        <li class="stepexpand"><span>Remove the <code class="codeph">HR.EMPLOYEES_pol</code> Database Vault policy. </span><div><pre class="oac_no_warn" dir="ltr">EXEC DBMS_MACADM.DROP_POLICY('HR.EMPLOYEES_pol');</pre></div>
                           <div>You first must remove the policy before you can drop its contents.</div>
                        </li>
                        <li class="stepexpand"><span>Remove the <code class="codeph">HR.EMPLOYEES_realm</code> realm.</span><div><pre class="oac_no_warn" dir="ltr">EXEC DBMS_MACADM.DELETE_REALM('HR.EMPLOYEES_realm');</pre></div>
                        </li>
                        <li class="stepexpand"><span>Remove the simulation mode log data that was accumulated.</span><div>
                              <p>Because the simulation mode log only captured information about user <code class="codeph">tjones_dba</code>, you can remove only the rows that relate to this user.
                              </p><pre class="oac_no_warn" dir="ltr">DELETE FROM DVSYS.SIMULATION_LOG$ WHERE USERNAME = 'TJONES_DBA';</pre></div>
                        </li>
                        <li class="stepexpand"><span>Connect as user <code class="codeph">HR</code>.</span><div><pre class="oac_no_warn" dir="ltr">CONNECT HR <span class="italic">-- Or, CONNECT HR@hrpdb</span>
Enter password: <span class="italic">password</span></pre></div>
                        </li>
                        <li class="stepexpand"><span>Revert <code class="codeph">smavris</code>’s salary back to its pre-violated state.</span><div><pre class="oac_no_warn" dir="ltr">UPDATE HR.EMPLOYEES
SET SALARY = 6500
WHERE EMAIL = 'SMAVRIS';</pre></div>
                        </li>
                        <li class="stepexpand"><span>Connect as a user who has been granted the <code class="codeph">DV_ACCTMGR</code> role.</span><div>
                              <p>For example:</p><pre class="oac_no_warn" dir="ltr">CONNECT bea_dvacctmgr <span class="italic">-- Or, bea_dvacctmgr@hrpdb</span>
Enter password: <span class="italic">password</span>
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Remove the users <code class="codeph">psmith</code>, <code class="codeph">smavris</code>, and <code class="codeph">tjones_dba</code>. </span><div><pre class="oac_no_warn" dir="ltr">DROP USER psmith;
DROP USER smavris;
DROP USER tjones_dba;</pre></div>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-8BB95940-7D8D-4AEB-9A53-246BA2AEED4C" title="This tutorial shows how to create a realm that uses simulation mode and then test violations to the realm.">Tutorial: Tracking Violations to a Realm Using Simulation Mode</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
            <div class="sect2"><a id="GUID-D60381F6-9D4F-40FC-A409-FB144FE490C6" name="GUID-D60381F6-9D4F-40FC-A409-FB144FE490C6"></a><h3 id="DVADM-GUID-D60381F6-9D4F-40FC-A409-FB144FE490C6" class="sect3">Use Cases and Guidelines for Logging Realms in Simulation Mode</h3>
               <div>
                  <p>Oracle provides a set of use cases and guidelines for logging realms in simulation mode.</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-A0E0CF4F-6F62-47A9-9188-8476A58E8C21">About Logging Realms in Simulation Mode</a><br>The type of realm used can affect the data that is written to the simulation log.
                     </li>
                     <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-17165018-8ED0-48F2-A1E7-768FB746D5A1">Use Case: New Realms All in Simulation Mode</a><br>In this use case, all realms are either mandatory or regular, and all user-created realms are in simulation mode.
                     </li>
                     <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-F083B2C0-6FCF-46FD-B00B-6447B9A54568">Use Case: New Realms Introduced to Existing Realms</a><br>The new realms are in simulation mode and the existing realms are enabled and working. 
                     </li>
                     <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-E6F9354E-443E-4735-86E4-4EF6E9D96230">Use Case: New Objects Added to a Realm</a><br>You can add new objects to an existing realm and then test it by using simulation mode, without removing the current realm protections.
                     </li>
                     <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-11157AE0-2A52-4BC5-ACD1-42D049907534">Use Case: Removing Objects from a Realm</a><br>You can remove objects from a realm by using the <code class="codeph">DBMS_MACADM.DELETE_OBJECT_FROM_REALM</code> procedure. 
                     </li>
                     <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-01CECD47-345B-40DA-BBD1-FD04E85D1C9A">Use Case: Adding an Authorized User to a Realm</a><br>You can add authorized users to a realm by using the <code class="codeph">DBMS_MACADM.ADD_AUTH_TO_REALM</code> procedure.
                     </li>
                     <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-152BA89E-73F2-4406-8C31-A1643EB5A652">Use Case: Removing an Authorized User from a Realm</a><br>You can remove an authorized user from a realm by using the <code class="codeph">DBMS_MACADM.DELETE_AUTH_FROM_REALM</code> procedure. 
                     </li>
                     <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-42CF4507-F6F0-439B-81D7-5BEEE395B116">Use Case: Testing New Factors in a Realm</a><br>If a realm has new factors, you can use simulation mode to test if there have been changes to the factors. 
                     </li>
                     <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-924D0FAD-920E-4EF3-8618-5124DB9B1E79">Use Case: Testing Changes to an Existing Command Rule While Keeping the Original Command Control Enabled</a><br>You can test changes to an existing command rule while keeping the original command control enabled. 
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-23CA88C2-C52C-4676-8564-2395898BECE7" title="Simulation mode writes violations to the simulation log instead of preventing SQL execution to quickly test new and modified Oracle Database Vault controls.">Using Simulation Mode for Logging Realm and Command Rule Activities</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="sect3"><a id="GUID-A0E0CF4F-6F62-47A9-9188-8476A58E8C21" name="GUID-A0E0CF4F-6F62-47A9-9188-8476A58E8C21"></a><h4 id="DVADM-GUID-A0E0CF4F-6F62-47A9-9188-8476A58E8C21" class="sect4">About Logging Realms in Simulation Mode</h4>
                  <div>
                     <p>The type of realm used can affect the data that is written to the simulation log.</p>
                     <p>When a user executes a SQL statement and it fails, it may fail for realms that are enabled or fail for realms that are simulated (or both). These could be mandatory realms, regular realms, or both. These conditions determine what is captured in the simulation log.</p>
                     <p>When an object has both regular realms and mandatory realms protecting it, the mandatory realm protection takes precedence. When both regular and mandatory realms protect an object, the simulation log captures only the activity from the mandatory realm. The simulation log will capture only mandatory realm failures. The only time that the simulation log will capture a regular realm failure is when all realms for the object are regular realms, and if the regular realms have the following behavior:</p>
                     <ul style="list-style-type: disc;" id="GUID-A0E0CF4F-6F62-47A9-9188-8476A58E8C21__UL_ARG_1DQ_SFB">
                        <li>All regular realms in simulation mode fail, and </li>
                        <li>All regular realms that are enabled also fail</li>
                     </ul>
                     <p>If at least one enabled or simulation regular realm succeeds, then no simulation regular realms are logged in the simulation log.</p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-D60381F6-9D4F-40FC-A409-FB144FE490C6" title="Oracle provides a set of use cases and guidelines for logging realms in simulation mode.">Use Cases and Guidelines for Logging Realms in Simulation Mode</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-17165018-8ED0-48F2-A1E7-768FB746D5A1" name="GUID-17165018-8ED0-48F2-A1E7-768FB746D5A1"></a><h4 id="DVADM-GUID-17165018-8ED0-48F2-A1E7-768FB746D5A1" class="sect4">Use Case: New Realms All in Simulation Mode</h4>
                  <div>
                     <p>In this use case, all realms are either mandatory or regular, and all user-created realms are in simulation mode.</p>
                     <ul style="list-style-type: disc;" id="GUID-17165018-8ED0-48F2-A1E7-768FB746D5A1__UL_P3M_QHV_SFB">
                        <li><span class="bold">Mandatory realms only: all are in simulation mode</span><p>The user is authorized to execute the SQL statement in all mandatory realms. Nothing is captured in the simulation log table. </p>
                           <p>If the user fails one or more mandatory realm checks, then all realm check failures are written to the simulation log. Mandatory realm checks where the user SQL statement succeeded are not written to the simulation log. Suppose there are three mandatory realms, and a user SQL statement succeeds with one realm and fails with the other two. Only the two failed realm checks are written to the simulation log.</p>
                        </li>
                        <li><span class="bold">Regular realms only: all are in simulation mode</span><p>Suppose the user is authorized to execute the SQL statement in at least one regular realm. This user should have access to the data, so nothing is written the simulation log.</p>
                           <p>Alternatively, suppose the user is not authorized to execute the SQL statement of any of the regular realms. The simulation log will capture the failed realm authorization failures. Because the failures are recorded, an administrator can then select which realms to which the user should be authorized. The SQL only needs to be authorized in one regular realm to work. Not all regular realms need to be updated to authorize the SQL.</p>
                        </li>
                        <li><span class="bold">Mix of mandatory and regular realms: all are in simulation mode</span><p>In this scenario, you capture the gating realms when a user is rejected. With mandatory and regular realms, the mandatory realms are the gating realms. All mandatory realms must pass the authorization check for the user to gain access. In fact, regular realms could be considered superfluous when mandatory realms protect an object. Therefore, in cases where there are mandatory and regular realms, only mandatory realms should be logged into the simulation log . It does not matter whether the user was authorized to the regular realm or not. In this case, only mandatory realms are used and they are all in simulation mode. </p>
                           <p>Suppose the user is authorized to execute a SQL statement in all mandatory realms. In this case, nothing is captured in the simulation log table. Even though the user may succeed or fail in one or more regular realms, nothing about regular realm failure is captured.</p>
                           <p>If the user fails one or more mandatory realm checks, then all realm check failures are logged to the simulation log. Mandatory realm checks where the user SQL statement succeeded are not logged. For example, suppose there are three mandatory realms. If the user's SQL statement succeeds with one realm and fails with the other two, then only the two failed realm checks are recorded in the simulation log. No regular realms need to be captured, because for this scenario, it does not matter.</p>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-D60381F6-9D4F-40FC-A409-FB144FE490C6" title="Oracle provides a set of use cases and guidelines for logging realms in simulation mode.">Use Cases and Guidelines for Logging Realms in Simulation Mode</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-F083B2C0-6FCF-46FD-B00B-6447B9A54568" name="GUID-F083B2C0-6FCF-46FD-B00B-6447B9A54568"></a><h4 id="DVADM-GUID-F083B2C0-6FCF-46FD-B00B-6447B9A54568" class="sect4">Use Case: New Realms Introduced to Existing Realms</h4>
                  <div>
                     <p>The new realms are in simulation mode and the existing realms are enabled and working. </p>
                     <p>This use case applies only if both simulation mode and enabled realms protect the same object. </p>
                     <ul style="list-style-type: disc;" id="GUID-F083B2C0-6FCF-46FD-B00B-6447B9A54568__UL_MHG_5MW_SFB">
                        <li><span class="bold">New enabled mandatory realms with existing enabled mandatory realms</span><p>This scenario shows some additional mandatory realms for an existing object, which is designed to add more security to the object.</p>
                           <ul style="list-style-type: disc;" id="GUID-F083B2C0-6FCF-46FD-B00B-6447B9A54568__UL_OHC_2PW_SFB">
                              <li>Enabled mandatory realms and mandatory realms in simulation mode are all successful with user's SQL: the SQL executes normally and nothing is written to the simulation log.</li>
                              <li>At least one enabled mandatory realm fails and mandatory realms in simulation mode are successful: the SQL is blocked and nothing is written to the simulation mode log.</li>
                              <li>At least one enabled mandatory realm fails and mandatory realms in simulation mode have one or more failures: the SQL is blocked and all failing mandatory realms in simulation mode are written to the simulation mode log.</li>
                              <li>Enabled mandatory realms are all successful and mandatory realms in simulation mode have at least one failure: the SQL is not blocked, and all failed mandatory realms in simulation mode are written to the simulation log.</li>
                           </ul>
                        </li>
                        <li>New regular realms in simulation mode with existing enabled regular realms: More regular realms are added to a security object to provide new ways for users to access sensitive data. 
                           <ul style="list-style-type: disc;" id="GUID-F083B2C0-6FCF-46FD-B00B-6447B9A54568__UL_IFF_TYW_SFB">
                              <li>At least one enabled regular realm and at least one regular realm in simulation mode are successful: the SQL executes normally with nothing is written to the simulation log.</li>
                              <li>At least one enabled regular realm and all regular realms in simulation mode fail: The SQL statement executes normally, so nothing is written to the simulation log.</li>
                              <li>All enabled regular realms and regular realms in simulation mode all fail: the SQL statement is blocked and all regular realms in simulation mode are written to the simulation log. You must evaluate which regular realms to authorize to if necessary. Oracle Database Vault will block the SQL and not record the regular realms in simulation mode in the simulation log because the enabled regular realms would have blocked it anyway. This must change because a user may have added a new realm to authorize the SQL in this use case. There is no way to tell what happened if the new SQL should have worked, but is blocked by all regular realms in simulation mode as well (when one of the regular realms in simulation mode was designed to allow it to work). This would simulate an entry into the audit log for this situation.</li>
                              <li>Enabled regular realms all fail and at least one regular realm in simulation mode successful: the SQL is blocked and nothing is written to the simulation log.</li>
                           </ul>
                        </li>
                        <li>New regular realm in simulation mode with existing enabled regular realm: This is a do-nothing situation. The enabled regular realm will continue to control the objects and the new regular realm in simulated mode will have no impact if they are enabled or not. Because there is no impact, no simulation logs are generetaed. </li>
                        <li>New mandatory realm in simulated mode with an existing enabled regular realm: While the enabled regular realm will control the objects for now, when the new mandatory realm in simulated mode is enabled, then they  will have full control over the objects with no control by the older enabled regular realm. So, simulation logs will be generated for all mandatory realms in simulated mode that fail the authorization checks. This is the same as the use case as with when mandatory realms are all in simulated mode.</li>
                        <li>New regular realms in simulated mode with existing enabled mandatory realms in simulated mode and an enabled regular realm: the enabled mandatory realms will be the deciding realms for whether the new simulated mode regular realms are added to the existing enabled regular realms in the system. This is the same as the use case with a new regular realm in simulation mode with existing enabled regular realm. Nothing will be written to the simulation log.</li>
                        <li>New mandatory realms in simulated mode with existing enabled mandatory and regular realms: the enabled regular realms can be ignored. This use case is the same as the use case with new simulated mode mandatory realms with existing enabled mandatory realms.</li>
                        <li>Mix of new simulated mode mandatory and regular realms with existing enabled mandatory and regular realms: ignore all enabled and simulated mode regular realms. This is simply adding more mandatory realms to an existing object. This use case is the same as the use case with new simulated mandatory realms and enabled mandatory realms. </li>
                     </ul>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-D60381F6-9D4F-40FC-A409-FB144FE490C6" title="Oracle provides a set of use cases and guidelines for logging realms in simulation mode.">Use Cases and Guidelines for Logging Realms in Simulation Mode</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-E6F9354E-443E-4735-86E4-4EF6E9D96230" name="GUID-E6F9354E-443E-4735-86E4-4EF6E9D96230"></a><h4 id="DVADM-GUID-E6F9354E-443E-4735-86E4-4EF6E9D96230" class="sect4">Use Case: New Objects Added to a Realm</h4>
                  <div>
                     <p>You can add new objects to an existing realm and then test it by using simulation mode, without removing the current realm protections.</p>
                     <p>Oracle recommends that you create a duplicate realm in simulation mode for the new objects with the same authorized users and rule sets. </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-D60381F6-9D4F-40FC-A409-FB144FE490C6" title="Oracle provides a set of use cases and guidelines for logging realms in simulation mode.">Use Cases and Guidelines for Logging Realms in Simulation Mode</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-11157AE0-2A52-4BC5-ACD1-42D049907534" name="GUID-11157AE0-2A52-4BC5-ACD1-42D049907534"></a><h4 id="DVADM-GUID-11157AE0-2A52-4BC5-ACD1-42D049907534" class="sect4">Use Case: Removing Objects from a Realm</h4>
                  <div>
                     <p>You can remove objects from a realm by using the <code class="codeph">DBMS_MACADM.DELETE_OBJECT_FROM_REALM</code> procedure. 
                     </p>
                     <p>However, because you are removing security controls for an existing object, there is no need to use simulation mode. All you need to do is remove the object from the realm. </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-D60381F6-9D4F-40FC-A409-FB144FE490C6" title="Oracle provides a set of use cases and guidelines for logging realms in simulation mode.">Use Cases and Guidelines for Logging Realms in Simulation Mode</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-01CECD47-345B-40DA-BBD1-FD04E85D1C9A" name="GUID-01CECD47-345B-40DA-BBD1-FD04E85D1C9A"></a><h4 id="DVADM-GUID-01CECD47-345B-40DA-BBD1-FD04E85D1C9A" class="sect4">Use Case: Adding an Authorized User to a Realm</h4>
                  <div>
                     <p>You can add authorized users to a realm by using the <code class="codeph">DBMS_MACADM.ADD_AUTH_TO_REALM</code> procedure.
                     </p>
                     <p>In this scenario, you are loosening security controls by adding more users. You do not need to set simulation mode; just add the users. If you do not know which authorized users to add and want to use simulation mode to find out, then Oracle Database Vault enables all users to access the objects. In this case, you must put the original realm in simulation mode. </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-D60381F6-9D4F-40FC-A409-FB144FE490C6" title="Oracle provides a set of use cases and guidelines for logging realms in simulation mode.">Use Cases and Guidelines for Logging Realms in Simulation Mode</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-152BA89E-73F2-4406-8C31-A1643EB5A652" name="GUID-152BA89E-73F2-4406-8C31-A1643EB5A652"></a><h4 id="DVADM-GUID-152BA89E-73F2-4406-8C31-A1643EB5A652" class="sect4">Use Case: Removing an Authorized User from a Realm</h4>
                  <div>
                     <p>You can remove an authorized user from a realm by using the <code class="codeph">DBMS_MACADM.DELETE_AUTH_FROM_REALM</code> procedure. 
                     </p>
                     <p>In this scenario, you may or may not have dropped a user from a realm authorization list. However, you want to see if the dropped user can still access the realm for authorized activities, as follows: </p>
                     <ol id="GUID-152BA89E-73F2-4406-8C31-A1643EB5A652__OL_Y45_LMG_5FB">
                        <li>Clone the realm.</li>
                        <li>In the original realm, remove the user that you want to drop and then add this user to the cloned realm. </li>
                        <li>Configure auditing on the cloned realm so that the user that you want to drop is visible in the audit records. 
                           <ul style="list-style-type: disc;" id="GUID-152BA89E-73F2-4406-8C31-A1643EB5A652__UL_PG2_WNG_5FB">
                              <li>If the cloned realm is a regular realm, then use the <code class="codeph">DBMS_MACADM.UPDATE_REALM</code> procedure to set the <code class="codeph">audit_options</code> parameter to <code class="codeph">DBMS_MACUTL.G_REALM_AUDIT_SUCCESS</code>. Alternatively, create a unified audit policy to capture the user's successful activity.
                              </li>
                              <li>If the cloned realm is a mandatory realm, then create a unified audit policy to capture the user's successful activity.</li>
                           </ul>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-D60381F6-9D4F-40FC-A409-FB144FE490C6" title="Oracle provides a set of use cases and guidelines for logging realms in simulation mode.">Use Cases and Guidelines for Logging Realms in Simulation Mode</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-42CF4507-F6F0-439B-81D7-5BEEE395B116" name="GUID-42CF4507-F6F0-439B-81D7-5BEEE395B116"></a><h4 id="DVADM-GUID-42CF4507-F6F0-439B-81D7-5BEEE395B116" class="sect4">Use Case: Testing New Factors in a Realm</h4>
                  <div>
                     <p>If a realm has new factors, you can use simulation mode to test if there have been changes to the factors. </p>
                     <p>In this scenario, there are two use cases: </p>
                     <ul style="list-style-type: disc;" id="GUID-42CF4507-F6F0-439B-81D7-5BEEE395B116__UL_KBK_YPG_5FB">
                        <li><span class="bold">There have been changes to the application or infrastructure that will force a change to the factors.</span> 
                           <p>In this scenario, enable the (regular) realm and then remove the factors from the authorized users. Then create a mandatory realm for the same protected objects in simulation mode with no authorized users. The regular realm will protect the objects from unauthorized users while the mandatory realm in simulation mode will capture all access, along with any information about the factors. You can check  the simulation log for each user to come up with new factors which then can be added to the mandatory realm in simulation mode. This will ensure that the mandatory realm is clean before you migrate it to the original regular realm.  </p>
                        </li>
                        <li><span class="bold">There have been no changes to the application or infrastructure, but changes are being made to the factors, such as new factors added or existing factors removed. </span><p>In this scenario, the concern is about how to configure the addition of new factors. Dropping factors lowers the security profile, so all you need to do is to drop the factors from the rule set. When you add a factor, you must clone a realm from the original and then configure it to be in simulation mode. Add the new factors to this cloned realm. If the simulation log records are clean for this cloned realm, then you can safely add factors to the original realm. </p>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-D60381F6-9D4F-40FC-A409-FB144FE490C6" title="Oracle provides a set of use cases and guidelines for logging realms in simulation mode.">Use Cases and Guidelines for Logging Realms in Simulation Mode</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-924D0FAD-920E-4EF3-8618-5124DB9B1E79" name="GUID-924D0FAD-920E-4EF3-8618-5124DB9B1E79"></a><h4 id="DVADM-GUID-924D0FAD-920E-4EF3-8618-5124DB9B1E79" class="sect4">Use Case: Testing Changes to an Existing Command Rule While Keeping the Original Command Control Enabled</h4>
                  <div>
                     <p>You can test changes to an existing command rule while keeping the original command control enabled. </p>
                     <p>When you update a command rule, ideally you should test it before the changes are enabled and in production. For a new command rule, you only need to put it in simulation mode. However, an existing command rule is already enabled and offering protection. In this case, Oracle recommends that you create an audit policy to capture what the original command rule was doing and set an alert for it. The audit policy will not prevent the SQL from taking place, but at least you will have an alert for it. After you are satisfied that the original command rule works correctly, you can put the updated command rule into simulation mode and then test it. </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-D60381F6-9D4F-40FC-A409-FB144FE490C6" title="Oracle provides a set of use cases and guidelines for logging realms in simulation mode.">Use Cases and Guidelines for Logging Realms in Simulation Mode</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
         </div>
      </article>
   </body>
</html>