<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>Troubleshooting RMAN Operations</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Backup and Recovery User's Guide">
      <meta property="og:description" content="">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Backup and Recovery User's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="database-backup-and-recovery-users-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-01-09T05:20:45-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="2003, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96241-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="tuning-rman-performance.html" title="Previous" type="text/html">
      <link rel="next" href="part-transfering-data-rman.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database Backup and Recovery User's Guide">
    <meta name="dcterms.isVersionOf" content="BRADV">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="tuning-rman-performance.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="part-transfering-data-rman.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Backup and Recovery User's Guide</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="part-rman-tuning-troubleshooting.html" property="item" typeof="WebPage"><span property="name"> Tuning and Troubleshooting </span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Troubleshooting RMAN Operations</li>
            </ol>
            <a id="GUID-ABFD58BD-5D3B-4A6C-AA46-E085AE234D73" name="GUID-ABFD58BD-5D3B-4A6C-AA46-E085AE234D73"></a><a id="BRADV012"></a>
            
            <h2 id="BRADV-GUID-ABFD58BD-5D3B-4A6C-AA46-E085AE234D73" class="sect2"><span class="enumeration_chapter">24 </span>Troubleshooting RMAN Operations
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>This chapter describes how to troubleshoot Recovery Manager. This chapter contains the following topics:</p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p><a href="troubleshooting-rman-operations.html#GUID-FC95B894-86E6-414C-A0A7-69D9768CDDFC" title="Recovery Manager provides detailed error messages that can aid in troubleshooting problems.">Interpreting RMAN Message Output</a></p>
                  </li>
                  <li>
                     <p><a href="troubleshooting-rman-operations.html#GUID-AD353573-E722-4D76-9361-9C0CA4C29FEB" title="When LIST, REPORT, and SHOW do not provide all the information that you need for RMAN operations, some V$ views can provide useful details.">Using V$ Views for RMAN Troubleshooting</a></p>
                  </li>
                  <li>
                     <p><a href="troubleshooting-rman-operations.html#GUID-B1E9715D-BD07-4B80-8158-33981138E679" title="On some platforms, Oracle provides a diagnostic tool called sbttest. This utility performs a simple test of the media management software by acting as the Oracle database server and attempting to communicate with the media manager.">Testing the Media Management API</a></p>
                  </li>
                  <li>
                     <p><a href="troubleshooting-rman-operations.html#GUID-772C8583-7763-48AB-B404-747188EC718A" title="There are several ways to terminate an RMAN command in the middle of execution.">Terminating an RMAN Command</a></p>
                  </li>
               </ul>
            </div><a id="BRADV174"></a><div class="props_rev_3"><a id="GUID-FC95B894-86E6-414C-A0A7-69D9768CDDFC" name="GUID-FC95B894-86E6-414C-A0A7-69D9768CDDFC"></a><h3 id="BRADV-GUID-FC95B894-86E6-414C-A0A7-69D9768CDDFC" class="sect3"><span class="enumeration_section">24.1 </span>Interpreting RMAN Message Output
               </h3>
               <div>
                  <p>Recovery Manager provides detailed error messages that can aid in troubleshooting problems. </p>
                  <p>Also, Oracle Database and the third-party media vendors generate useful debugging output of their own. The following discussion explains how to identify and interpret the different errors that you may encounter.</p>
               </div><a id="BRADV411"></a><a id="BRADV89865"></a><div class="props_rev_3"><a id="GUID-19A3AA88-4778-4127-A10E-1BD9F2F5D9F8" name="GUID-19A3AA88-4778-4127-A10E-1BD9F2F5D9F8"></a><h4 id="BRADV-GUID-19A3AA88-4778-4127-A10E-1BD9F2F5D9F8" class="sect4"><span class="enumeration_section">24.1.1 </span>Identifying Types of RMAN Message Output
                  </h4>
                  <div>
                     <p>Output that is useful for troubleshooting failed or unresponsive RMAN jobs is located in several different places.</p>
                     <p>The following table provides an overview of where to locate message output that can be used to troubleshoot RMAN backup problems.</p>
                     <div class="tblformalwide" id="GUID-19A3AA88-4778-4127-A10E-1BD9F2F5D9F8__BGBBABDH">
                        <p class="titleintable">Table 24-1 Types of Message Output</p>
                        <table cellpadding="4" cellspacing="0" class="FormalWide" title="Types of Message Output" summary="This table lists places to look for different message output useful in troubleshooting RMAN backup problems." width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="12%" id="d105110e294">Type of Output	</th>
                                 <th align="left" valign="bottom" width="12%" id="d105110e298">Produced By</th>
                                 <th align="left" valign="bottom" width="38%" id="d105110e301">Location</th>
                                 <th align="left" valign="bottom" width="38%" id="d105110e304">Description</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="12%" id="d105110e309" headers="d105110e294 ">
                                    <p>RMAN messages</p>
                                 </td>
                                 <td align="left" valign="top" width="12%" headers="d105110e309 d105110e298 ">
                                    <p>RMAN</p>
                                 </td>
                                 <td align="left" valign="top" width="38%" headers="d105110e309 d105110e301 ">
                                    <p>Completed job information is in <code class="codeph">V$RMAN_STATUS</code> and <code class="codeph">RC_RMAN_STATUS</code>. Current job information is in <code class="codeph">V$RMAN_OUTPUT</code>.
                                    </p>
                                    <p>When running RMAN from the command line, you can direct output to the following places:</p>
                                    <ul style="list-style-type: disc;">
                                       <li>
                                          <p>Standard output</p>
                                       </li>
                                       <li>
                                          <p>A log file specified by <code class="codeph">LOG</code> on the command line or the <code class="codeph">SPOOL</code> <code class="codeph">LOG</code> command
                                          </p>
                                       </li>
                                       <li>
                                          <p>A file created by redirecting RMAN output (for example, in UNIX, using the'<code class="codeph">&gt;</code>' operator)
                                          </p>
                                       </li>
                                    </ul>
                                 </td>
                                 <td align="left" valign="top" width="38%" headers="d105110e309 d105110e304 ">
                                    <p>Contains actions relevant to the RMAN job and error messages generated by RMAN, the database server, and the media vendor. RMAN error messages have an <code class="codeph">RMAN-</code> prefix. Normal action descriptions do not have a prefix.
                                    </p>
                                    <p>You can execute the following PL/SQL to remove all entries from <code class="codeph">V$RMAN_STATUS</code>:
                                    </p><pre class="oac_no_warn" dir="ltr">update node set high_rsr_recid=0
where db_key = <span class="italic">our_target_database_db_ke</span>y ;</pre><p>The preceding function removes all job-related entries. No rows are visible until new backup jobs are shown in <code class="codeph">V$RMAN_BACKUP_JOB_DETAILS</code>.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="12%" id="d105110e373" headers="d105110e294 ">
                                    <p><code class="codeph">alert_</code><span class="italic">SID</span><code class="codeph">.log</code></p>
                                 </td>
                                 <td align="left" valign="top" width="12%" headers="d105110e373 d105110e298 ">
                                    <p>Oracle Database</p>
                                 </td>
                                 <td align="left" valign="top" width="38%" headers="d105110e373 d105110e301 ">
                                    <p>The <code class="codeph">alert</code> subdirectory of the <a href="glossary.html#GUID-BDCE90D1-13B7-4D2C-A761-1583A238A247"><span class="xrefglossterm">Automatic Diagnostic Repository (ADR)</span></a> home
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="38%" headers="d105110e373 d105110e304 ">
                                    <p>Contains a chronological log of errors, initialization parameter settings, and administration operations. Records values for overwritten control file records.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="12%" id="d105110e397" headers="d105110e294 ">
                                    <p>Oracle trace file</p>
                                 </td>
                                 <td align="left" valign="top" width="12%" headers="d105110e397 d105110e298 ">
                                    <p>Oracle Database</p>
                                 </td>
                                 <td align="left" valign="top" width="38%" headers="d105110e397 d105110e301 ">
                                    <p>The <code class="codeph">trace</code> subdirectory of the ADR home
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="38%" headers="d105110e397 d105110e304 ">
                                    <p>Contains detailed output generated by Oracle Database processes. This file is created when an <code class="codeph">ORA-600</code> or <code class="codeph">ORA-3113</code> error message occurs, whenever RMAN cannot allocate a channel, and when the database fails to load the media management library.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="12%" id="d105110e419" headers="d105110e294 ">
                                    <p><code class="codeph">sbtio.log</code></p>
                                 </td>
                                 <td align="left" valign="top" width="12%" headers="d105110e419 d105110e298 ">
                                    <p>Third-party media management software</p>
                                 </td>
                                 <td align="left" valign="top" width="38%" headers="d105110e419 d105110e301 ">
                                    <p>The <code class="codeph">trace</code> subdirectory of the ADR home
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="38%" headers="d105110e419 d105110e304 ">
                                    <p>Contains vendor-specific information written by the media management software. This log does not contain Oracle Database or RMAN errors.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="12%" id="d105110e436" headers="d105110e294 ">
                                    <p>Media manager log file</p>
                                 </td>
                                 <td align="left" valign="top" width="12%" headers="d105110e436 d105110e298 ">
                                    <p>Third-party media management software</p>
                                 </td>
                                 <td align="left" valign="top" width="38%" headers="d105110e436 d105110e301 ">
                                    <p>The file names for any media manager logs other than <code class="codeph">sbtio.log</code> are determined by the media management software.
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="38%" headers="d105110e436 d105110e304 ">
                                    <p>Contains information about the functioning of the media management device</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-908BC873-9AC8-402B-9B13-4ECBD1A50F80" name="GUID-908BC873-9AC8-402B-9B13-4ECBD1A50F80"></a><h4 id="BRADV-GUID-908BC873-9AC8-402B-9B13-4ECBD1A50F80" class="sect4"><span class="enumeration_section">24.1.2 </span>Troubleshooting Long-Running RMAN Operations
                  </h4>
                  <div>
                     <p>RMAN message output provides information about the progress of backup and recovery operations. Use this information to take any required actions to troubleshoot operations that are stuck or awaiting resources.</p>
                     <p>Certain operations such as backup, restore, recovery, and duplication for large databases typically take a long time to complete. However, it is not always clear if the operation is progressing or waiting on some resources. Starting with Oracle Database Release 18c, RMAN message output contains additional logging information that indicates if a job is waiting on resources. Every 10 minutes, RMAN checks if there is a change in the number of blocks processed. If there no change in the blocks processed, then RMAN displays a message with the associated wait event.</p>
                     <p>The following is an example of the RMAN output for a <code class="codeph">RESTORE</code> operation:
                     </p><pre class="pre codeblock"><code>allocated channel: c1
channel c1: SID=123 device type=SBT_TAPE
channel c1: WARNING: Oracle Test Disk API

Starting restore at 18-JAN-18

channel c1: starting datafile backup set restore
channel c1: specifying datafile(s) to restore from backup set
channel c1: restoring datafile 00002 to /ade/b/2776899351/oracle/dbs/tbs_ax1.f
channel c1: reading from backup piece 01sov1t4_1_1

***** Hang Detected ***** at 2018-01-18 04:11:23 for channel c1, INSTID: 1, SID: 123, serial: 35831
No change in read blocks, thus showing wait event[Total blocks = 192000, Blocks read/recovered = 41530]
Seq_No   Event                            Waiting Time(mirco secs)
602      Backup: MML read backup piece    38094371

***** Hang Detected ***** at 2018-01-18 04:11:33 for channel c1, INSTID: 1, SID: 123, serial: 35831
No change in read blocks, thus showing wait event[Total blocks = 192000, Blocks read/recovered = 41530]
Seq_No   Event                            Waiting Time(mirco secs)
602      Backup: MML read backup piece    48106104

channel c1: piece handle=01sov1t4_1_1 tag=TAG20180118T040804
channel c1: restored backup piece 1
channel c1: restore complete, elapsed time: 00:02:35
Finished restore at 18-JAN-18
released channel: c1</code></pre><p>The output indicates that the restore was stuck because of a problem with a media manager read operation. After the read operation completed, the RMAN restore was successful.</p>
                  </div>
               </div><a id="BRADV412"></a><a id="BRADV89866"></a><div class="props_rev_3"><a id="GUID-A2497F34-9030-4A43-AE3A-248B514D7FAA" name="GUID-A2497F34-9030-4A43-AE3A-248B514D7FAA"></a><h4 id="BRADV-GUID-A2497F34-9030-4A43-AE3A-248B514D7FAA" class="sect4"><span class="enumeration_section">24.1.3 </span>Recognizing RMAN Error Message Stacks
                  </h4>
                  <div>
                     <p>RMAN reports errors as they occur. If an error is not retrievable, that is, if RMAN cannot perform failover to another channel to complete a particular job step, then RMAN also reports a summary of the errors after all job sets complete. This feature is known as deferred error reporting.</p>
                     <div class="section">
                        <p>One way to determine whether RMAN encountered an error is to examine its return code. A second way is to search the RMAN output for the string <code class="codeph">RMAN-00569</code>, which is the message number for the error stack banner. All RMAN errors are preceded by this error message. If you do not see an <code class="codeph">RMAN-00569</code> message in the output, then there are no errors.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-A2497F34-9030-4A43-AE3A-248B514D7FAA__BGBIHGBB">
                        <p class="titleinexample">Example 24-1 RMAN Syntax Error</p>
                        <p>This example shows an RMAN syntax error. The <code class="codeph">RMAN-00569</code> message is followed by other error messages that indicate the reason for the error.
                        </p><pre class="oac_no_warn" dir="ltr">RMAN-00571: ===========================================================
RMAN-00569: =============== ERROR MESSAGE STACK FOLLOWS ===============
RMAN-00571: ===========================================================
RMAN-00558: error encountered while parsing input commands
RMAN-01005: syntax error: found ")": expecting one of: "archivelog, backup,
 backupset, controlfilecopy, current, database, datafile, datafilecopy, (, plus, ;, tablespace"
RMAN-01007: at line 1 column 18 file: standard input</pre></div>
                     <!-- class="example" -->
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-A2497F34-9030-4A43-AE3A-248B514D7FAA__GUID-F16E72D2-3B86-46AE-97BF-92D10B0099B5">
                           <p class="notep1">See Also:</p>
                           <p><a href="troubleshooting-rman-operations.html#GUID-52F92FE9-4C46-4380-97CB-454E5C784E01" title="One way to determine whether RMAN encountered an error is to examine its return code or exit status. The RMAN client returns 0 to the shell from which it was invoked if no errors occurred, and a nonzero error value otherwise.">Identifying RMAN Return Codes</a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="BRADV89867"></a><div class="props_rev_3"><a id="GUID-86207589-FA0F-4F24-BEEE-A212E0059C7F" name="GUID-86207589-FA0F-4F24-BEEE-A212E0059C7F"></a><h4 id="BRADV-GUID-86207589-FA0F-4F24-BEEE-A212E0059C7F" class="sect4"><span class="enumeration_section">24.1.4 </span>Identifying RMAN Error Codes
                  </h4>
                  <div>
                     <p>You can use the error codes in RMAN message stacks to troubleshoot problems with RMAN commands.</p>
                     <p>Typically, you find the following types of error codes in RMAN message stacks:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Errors prefixed with <code class="codeph">RMAN-</code></p>
                           <p>These are RMAN errors.</p>
                        </li>
                        <li>
                           <p>Errors prefixed with <code class="codeph">ORA-</code></p>
                           <p>Media manager errors use the <code class="codeph">ORA-</code> prefix.
                           </p>
                        </li>
                        <li>
                           <p>Errors preceded by the line <code class="codeph">Additional information:</code></p>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-86207589-FA0F-4F24-BEEE-A212E0059C7F__GUID-2F0273F7-25AC-4D6D-AFCE-A5BD4117B9C0">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="troubleshooting-rman-operations.html#GUID-122ADB82-E15B-4104-B7C6-DE1752D8466E" title="RMAN error messages are prefixed with RMAN-.">RMAN Error Message Numbers</a> for the error ranges of RMAN errors
                              </p>
                           </li>
                           <li>
                              <p><a href="troubleshooting-rman-operations.html#GUID-B23435DA-149D-4BFF-BF03-0FA4B68D5020" title="If a media manager error occurs, ORA-19511 is signaled, and the media manager is expected to provide RMAN a descriptive error. RMAN displays the error passed back to it by the media manager.">ORA-19511: Media Manager Errors</a> for the error ranges of media manager errors
                              </p>
                           </li>
                           <li>
                              <p><a href="../errmg/index.html" target="_blank"><span><cite>Oracle Database Error Messages Reference</cite></span></a>for explanations of <code class="codeph">RMAN</code> and <code class="codeph">ORA</code> error codes
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div><a id="BRADV413"></a><a id="BRADV89868"></a><div class="props_rev_3"><a id="GUID-122ADB82-E15B-4104-B7C6-DE1752D8466E" name="GUID-122ADB82-E15B-4104-B7C6-DE1752D8466E"></a><h5 id="BRADV-GUID-122ADB82-E15B-4104-B7C6-DE1752D8466E" class="sect5"><span class="enumeration_section">24.1.4.1 </span>RMAN Error Message Numbers 
                     </h5>
                     <div>
                        <p>RMAN error messages are prefixed with RMAN-.</p>
                        <p>The following table indicates the error ranges for common RMAN error messages, all of which are described in <a href="../errmg/RMAN-00201.html#ERRMG-GUID-8CF36220-DF1E-4BC7-A0B7-A95824301C2A" target="_blank"><span><cite>Oracle Database Error Messages Reference</cite></span></a>.
                        </p>
                        <div class="tblformal" id="GUID-122ADB82-E15B-4104-B7C6-DE1752D8466E__G1014492">
                           <p class="titleintable">Table 24-2 RMAN Error Message Ranges</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="RMAN Error Message Ranges" summary="This table lists error number ranges associated with RMAN error messages and their likely causes." width="100%" frame="hsides" border="1" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="20%" id="d105110e879">Error Range</th>
                                    <th align="left" valign="bottom" width="80%" id="d105110e882">Cause</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d105110e887" headers="d105110e879 ">
                                       <p>0550-0999</p>
                                    </td>
                                    <td align="left" valign="top" width="80%" headers="d105110e887 d105110e882 ">
                                       <p>Command-line interpreter</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d105110e894" headers="d105110e879 ">
                                       <p>1000-1999</p>
                                    </td>
                                    <td align="left" valign="top" width="80%" headers="d105110e894 d105110e882 ">
                                       <p>Keyword analyzer</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d105110e901" headers="d105110e879 ">
                                       <p>2000-2999</p>
                                    </td>
                                    <td align="left" valign="top" width="80%" headers="d105110e901 d105110e882 ">
                                       <p>Syntax analyzer</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d105110e908" headers="d105110e879 ">
                                       <p>3000-3999</p>
                                    </td>
                                    <td align="left" valign="top" width="80%" headers="d105110e908 d105110e882 ">
                                       <p>Main layer</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d105110e915" headers="d105110e879 ">
                                       <p>4000-4999</p>
                                    </td>
                                    <td align="left" valign="top" width="80%" headers="d105110e915 d105110e882 ">
                                       <p>Services layer</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d105110e922" headers="d105110e879 ">
                                       <p>5000-5499</p>
                                    </td>
                                    <td align="left" valign="top" width="80%" headers="d105110e922 d105110e882 ">
                                       <p>Compilation of <code class="codeph">RESTORE</code> or <code class="codeph">RECOVER</code> command
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d105110e935" headers="d105110e879 ">
                                       <p>5500-5999</p>
                                    </td>
                                    <td align="left" valign="top" width="80%" headers="d105110e935 d105110e882 ">
                                       <p>Compilation of <code class="codeph">DUPLICATE</code> command
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d105110e945" headers="d105110e879 ">
                                       <p>6000-6999</p>
                                    </td>
                                    <td align="left" valign="top" width="80%" headers="d105110e945 d105110e882 ">
                                       <p>General compilation</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d105110e952" headers="d105110e879 ">
                                       <p>7000-7999</p>
                                    </td>
                                    <td align="left" valign="top" width="80%" headers="d105110e952 d105110e882 ">
                                       <p>General execution</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d105110e959" headers="d105110e879 ">
                                       <p>8000-8999</p>
                                    </td>
                                    <td align="left" valign="top" width="80%" headers="d105110e959 d105110e882 ">
                                       <p>PL/SQL programs</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d105110e966" headers="d105110e879 ">
                                       <p>9000-9999</p>
                                    </td>
                                    <td align="left" valign="top" width="80%" headers="d105110e966 d105110e882 ">
                                       <p>Low-level keyword analyzer</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d105110e974" headers="d105110e879 ">
                                       <p>10000-10999</p>
                                    </td>
                                    <td align="left" valign="top" width="80%" headers="d105110e974 d105110e882 ">
                                       <p>Server-side execution</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d105110e981" headers="d105110e879 ">
                                       <p>11000-11999</p>
                                    </td>
                                    <td align="left" valign="top" width="80%" headers="d105110e981 d105110e882 ">
                                       <p>Interphase errors between PL/SQL and RMAN</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d105110e988" headers="d105110e879 ">
                                       <p>12000-12999</p>
                                    </td>
                                    <td align="left" valign="top" width="80%" headers="d105110e988 d105110e882 ">
                                       <p>Recovery catalog packages</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                  </div><a id="BRADV414"></a><a id="BRADV89869"></a><div class="props_rev_3"><a id="GUID-B23435DA-149D-4BFF-BF03-0FA4B68D5020" name="GUID-B23435DA-149D-4BFF-BF03-0FA4B68D5020"></a><h5 id="BRADV-GUID-B23435DA-149D-4BFF-BF03-0FA4B68D5020" class="sect5"><span class="enumeration_section">24.1.4.2 </span>ORA-19511: Media Manager Errors 
                     </h5>
                     <div>
                        <p>If a media manager error occurs, <code class="codeph">ORA-19511</code> is signaled, and the media manager is expected to provide RMAN a descriptive error. RMAN displays the error passed back to it by the media manager. 
                        </p>
                        <p>For example, you might see this:</p><pre class="oac_no_warn" dir="ltr">ORA-19511: Error received from media manager layer, error text:
   sbtpvt_open_input: file .* does not exist or cannot be accessed, errno = 2
</pre><p>The message from the media manager should provide you with enough information to let you fix the root problem. If it does not, then refer to the documentation for your media manager or contact your media management vendor support representative for further information. <code class="codeph">ORA-19511</code> errors originate with the media manager, not with Oracle Database. The database just passes on the message from the media manager. The cause can be addressed only by the media management vendor.
                        </p>
                        <p>If you are still using an SBT 1.1-compliant media management layer, you may see some additional error message text. Output from an SBT 1.1-compliant media management layer is similar to the following:</p><pre class="oac_no_warn" dir="ltr">ORA-19507: failed to retrieve sequential file, handle="c-140148591-20031014-06", parms=""
ORA-27007: failed to open file
Additional information: 7000
Additional information: 2
ORA-19511: Error received from media manager layer, error text:
   SBT error = 7000, errno = 0, sbtopen: backup file not found
</pre><p>The "Additional information" provided uses error codes specific to SBT 1.1. The values displayed correspond to the media manager message numbers and error text listed in <a href="troubleshooting-rman-operations.html#GUID-B23435DA-149D-4BFF-BF03-0FA4B68D5020__G1014541" title="This table lists SBT 1.1 error message numbers and corresponding error text..">Table 24-3</a>. RMAN again signals the error, as an ORA-19511 <code class="codeph">Error received from media manager layer</code> error, and a general error message related to the error code returned from the media manager and including the SBT 1.1 error number is then displayed.
                        </p>
                        <p>The SBT 1.1 error messages are listed here for your reference. <a href="troubleshooting-rman-operations.html#GUID-B23435DA-149D-4BFF-BF03-0FA4B68D5020__G1014541" title="This table lists SBT 1.1 error message numbers and corresponding error text..">Table 24-3</a> lists media manager message numbers and their corresponding error text. In the error codes, <span class="italic"><code class="codeph">O/S</code></span> stands for <span class="italic">operating system</span>. The errors marked with an asterisk (*) are internal and are not typically seen during normal operation.
                        </p>
                        <div class="tblformal" id="GUID-B23435DA-149D-4BFF-BF03-0FA4B68D5020__G1014541">
                           <p class="titleintable">Table 24-3 Media Manager Error Message Ranges</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="Media Manager Error Message Ranges" summary="This table lists SBT 1.1 error message numbers and corresponding error text.." width="100%" frame="hsides" border="1" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="20%" id="d105110e1129">Cause</th>
                                    <th align="left" valign="bottom" width="20%" id="d105110e1132">No.</th>
                                    <th align="left" valign="bottom" width="60%" id="d105110e1135">Message</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d105110e1140" headers="d105110e1129 ">
                                       <p>sbtopen</p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d105110e1140 d105110e1132 ">
                                       <p>7000 </p>
                                       <p>7001</p>
                                       <p>7002*</p>
                                       <p>7003</p>
                                       <p>7004</p>
                                       <p>7005</p>
                                       <p>7006</p>
                                       <p>7007</p>
                                       <p>7008</p>
                                       <p>7009</p>
                                       <p>7010</p>
                                       <p>7011</p>
                                       <p>7012*</p>
                                    </td>
                                    <td align="left" valign="top" width="60%" headers="d105110e1140 d105110e1135 ">
                                       <p>Backup file not found (only returned for read)</p>
                                       <p>File exists (only returned for write)</p>
                                       <p>Bad mode specified</p>
                                       <p>Invalid block size specified</p>
                                       <p>No tape device found</p>
                                       <p>Device found, but busy; try again later</p>
                                       <p>Tape volume not found</p>
                                       <p>Tape volume is in-use</p>
                                       <p>I/O Error</p>
                                       <p>Can't connect with Media Manager</p>
                                       <p>Permission denied</p>
                                       <p>O/S error for example malloc, fork error</p>
                                       <p>Invalid argument(s) to sbtopen</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d105110e1200" headers="d105110e1129 ">
                                       <p>sbtclose</p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d105110e1200 d105110e1132 ">
                                       <p>7020*</p>
                                       <p>7021*</p>
                                       <p>7022</p>
                                       <p>7023</p>
                                       <p>7024*</p>
                                       <p>7025</p>
                                    </td>
                                    <td align="left" valign="top" width="60%" headers="d105110e1200 d105110e1135 ">
                                       <p>Invalid file handle or file not open</p>
                                       <p>Invalid flags to sbtclose</p>
                                       <p>I/O error</p>
                                       <p>O/S error</p>
                                       <p>Invalid argument(s) to sbtclose</p>
                                       <p>Can't connect with Media Manager</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d105110e1230" headers="d105110e1129 ">
                                       <p>sbtwrite</p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d105110e1230 d105110e1132 ">
                                       <p>7040*</p>
                                       <p>7041</p>
                                       <p>7042</p>
                                       <p>7043</p>
                                       <p>7044*</p>
                                    </td>
                                    <td align="left" valign="top" width="60%" headers="d105110e1230 d105110e1135 ">
                                       <p>Invalid file handle or file not open</p>
                                       <p>End of volume reached</p>
                                       <p>I/O error</p>
                                       <p>O/S error</p>
                                       <p>Invalid argument(s) to sbtwrite</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d105110e1256" headers="d105110e1129 ">
                                       <p>sbtread</p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d105110e1256 d105110e1132 ">
                                       <p>7060*</p>
                                       <p>7061</p>
                                       <p>7062</p>
                                       <p>7063</p>
                                       <p>7064</p>
                                       <p>7065*</p>
                                    </td>
                                    <td align="left" valign="top" width="60%" headers="d105110e1256 d105110e1135 ">
                                       <p>Invalid file handle or file not open</p>
                                       <p>EOF encountered</p>
                                       <p>End of volume reached</p>
                                       <p> I/O error</p>
                                       <p>O/S error</p>
                                       <p>Invalid argument(s) to sbtread</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d105110e1286" headers="d105110e1129 ">
                                       <p>sbtremove</p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d105110e1286 d105110e1132 ">
                                       <p>7080</p>
                                       <p>7081</p>
                                       <p>7082</p>
                                       <p>7083</p>
                                       <p>7084</p>
                                       <p>7085</p>
                                       <p>7086*</p>
                                    </td>
                                    <td align="left" valign="top" width="60%" headers="d105110e1286 d105110e1135 ">
                                       <p>Backup file not found</p>
                                       <p>Backup file in use</p>
                                       <p>I/O Error</p>
                                       <p>Can't connect with Media Manager</p>
                                       <p>Permission denied</p>
                                       <p>O/S error</p>
                                       <p>Invalid argument(s) to sbtremove</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d105110e1320" headers="d105110e1129 ">
                                       <p>sbtinfo</p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d105110e1320 d105110e1132 ">
                                       <p>7090</p>
                                       <p>7091</p>
                                       <p>7092</p>
                                       <p>7093</p>
                                       <p>7094</p>
                                       <p>7095* </p>
                                    </td>
                                    <td align="left" valign="top" width="60%" headers="d105110e1320 d105110e1135 ">
                                       <p>Backup file not found</p>
                                       <p>I/O Error</p>
                                       <p>Can't connect with Media Manager</p>
                                       <p>Permission denied</p>
                                       <p>O/S error</p>
                                       <p>Invalid argument(s) to sbtinfo</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d105110e1350" headers="d105110e1129 ">
                                       <p>sbtinit</p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d105110e1350 d105110e1132 ">
                                       <p>7110* </p>
                                       <p>7111</p>
                                    </td>
                                    <td align="left" valign="top" width="60%" headers="d105110e1350 d105110e1135 ">
                                       <p>Invalid argument(s) to sbtinit</p>
                                       <p>O/S error</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                  </div>
               </div><a id="BRADV89870"></a><div class="props_rev_3"><a id="GUID-018EEA85-F7B0-48EC-A688-FDF6B537CE3E" name="GUID-018EEA85-F7B0-48EC-A688-FDF6B537CE3E"></a><h4 id="BRADV-GUID-018EEA85-F7B0-48EC-A688-FDF6B537CE3E" class="sect4"><span class="enumeration_section">24.1.5 </span>Interpreting RMAN Error Stacks
                  </h4>
                  <div>
                     <p>It is important to identify the relevant messages in the RMAN error stack.</p>
                     <div class="section">
                        <p>Note the following tips and suggestions while interpreting RMAN messages:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Read the messages from the bottom up, because this is the order in which RMAN issues the messages. The last one or two errors displayed in the stack are often the most informative.</p>
                           </li>
                           <li>
                              <p>When you are using an SBT 1.1 media management layer and you are presented with SBT 1.1 style error messages containing the "<code class="codeph">Additional information:</code>" numeric error codes, look for the <code class="codeph">ORA-19511 </code>message that follows for the text of error messages passed back to RMAN by the media manager. These messages identify the real failure in the media management layer.
                              </p>
                           </li>
                           <li>
                              <p>Look for the <code class="codeph">RMAN-03002</code> or <code class="codeph">RMAN-03009</code> message (<code class="codeph">RMAN-03009</code> equals <code class="codeph">RMAN-03002</code> but includes the channel ID), immediately following the error banner. These messages indicate which command failed. Syntax errors generate <code class="codeph">RMAN-00558</code>.
                              </p>
                           </li>
                           <li>
                              <p>Identify the basic type of error according to the error range chart in <a href="troubleshooting-rman-operations.html#GUID-122ADB82-E15B-4104-B7C6-DE1752D8466E__G1014492" title="This table lists error number ranges associated with RMAN error messages and their likely causes.">Table 24-2</a> and then refer to the error messages for information about the most important messages.
                              </p>
                           </li>
                        </ul>
                        <div class="infoboxnotealso" id="GUID-018EEA85-F7B0-48EC-A688-FDF6B537CE3E__GUID-3D2CB4D8-1920-451F-A936-A447C8E4D11B">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><a href="troubleshooting-rman-operations.html#GUID-3F0A6F9D-1FD0-4507-8E2B-B1A205690BCC" title="Errors prefixed by RMAN- indicate errors caused by RMAN commands.">Interpreting RMAN Errors: Example</a> and <a href="troubleshooting-rman-operations.html#GUID-1143EB66-0ACB-4E32-9AC4-66031A889095" title="Errors from the server are prefixed with ORA-.">Interpreting Server Errors: Example</a> for examples of RMAN error messages
                                 </p>
                              </li>
                              <li>
                                 <p><a href="troubleshooting-rman-operations.html#GUID-EB1FDC10-6B32-41DC-A1F5-B4EC149B2337" title="This example shows how to interpret errors caused at the media manager level.">Interpreting SBT 2.0 Media Management Errors: Example</a> and <a href="troubleshooting-rman-operations.html#GUID-37D6BF25-3EEF-473A-A500-D13F0FD9FC87" title="This example shows the output of a backup job that has errors media management errors.">Interpreting SBT 1.1 Media Management Errors: Example</a> for examples of interpreting media management errors
                                 </p>
                              </li>
                              <li>
                                 <p><a href="../errmg/index.html" target="_blank"><span class="italic">Oracle Database Error Messages </span></a> for information about the error messages
                                 </p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div><a id="BRADV89871"></a><div class="props_rev_3"><a id="GUID-3F0A6F9D-1FD0-4507-8E2B-B1A205690BCC" name="GUID-3F0A6F9D-1FD0-4507-8E2B-B1A205690BCC"></a><h5 id="BRADV-GUID-3F0A6F9D-1FD0-4507-8E2B-B1A205690BCC" class="sect5"><span class="enumeration_section">24.1.5.1 </span>Interpreting RMAN Errors: Example
                     </h5>
                     <div>
                        <p>Errors prefixed by RMAN- indicate errors caused by RMAN commands.</p>
                        <p>You attempt a backup of tablespace <code class="codeph">users</code> and receive the following message:
                        </p><pre class="oac_no_warn" dir="ltr">Starting backup at 29-AUG-13
using channel ORA_DISK_1
RMAN-00571: ===========================================================
RMAN-00569: =============== ERROR MESSAGE STACK FOLLOWS ===============
RMAN-00571: ===========================================================
RMAN-03002: failure of backup command at 08/29/2013 15:14:03
RMAN-20202: tablespace not found in the recovery catalog
RMAN-06019: could not translate tablespace name "USESR"
</pre><p>The <code class="codeph">RMAN-03002</code> error indicates that the <code class="codeph">BACKUP</code> command failed. You read the last two messages in the stack first and immediately see the problem: no tablespace <code class="codeph">users</code> appears in the recovery catalog because you mistyped the name as <code class="codeph">usesr</code>.
                        </p>
                     </div>
                  </div><a id="BRADV89872"></a><div class="props_rev_3"><a id="GUID-1143EB66-0ACB-4E32-9AC4-66031A889095" name="GUID-1143EB66-0ACB-4E32-9AC4-66031A889095"></a><h5 id="BRADV-GUID-1143EB66-0ACB-4E32-9AC4-66031A889095" class="sect5"><span class="enumeration_section">24.1.5.2 </span>Interpreting Server Errors: Example
                     </h5>
                     <div>
                        <p>Errors from the server are prefixed with ORA-.</p>
                        <p>Assume that you attempt to recover a tablespace and receive the following errors:</p><pre class="oac_no_warn" dir="ltr">RMAN&gt; RECOVER TABLESPACE users;

Starting recover at 29-AUG-13
using channel ORA_DISK_1

starting media recovery
media recovery failed
RMAN-00571: ===========================================================
RMAN-00569: =============== ERROR MESSAGE STACK FOLLOWS ===============
RMAN-00571: ===========================================================
RMAN-03002: failure of recover command at 08/29/2013 15:18:43
RMAN-11003: failure during parse/execution of SQL statement: alter database recover if needed tablespace USERS
ORA-00283: recovery session canceled due to errors
ORA-01124: cannot recover data file 8 - file is in use or recovery
ORA-01110: data file 8: '/oracle/oradata/trgt/users01.dbf'
</pre><p>As suggested, you start reading from the bottom up. The <code class="codeph">ORA-01110</code> message explains there was a problem with the recovery of data file <code class="codeph">users01.dbf</code>. The second error indicates that the database cannot recover the data file because it is in use or being recovered. The remaining RMAN errors indicate that the recovery session was canceled due to the server errors. Hence, you conclude that because you were not recovering this data file, the problem must be that the data file is online and you must take it offline and restore a backup.
                        </p>
                     </div>
                  </div><a id="BRADV89873"></a><div class="props_rev_3"><a id="GUID-EB1FDC10-6B32-41DC-A1F5-B4EC149B2337" name="GUID-EB1FDC10-6B32-41DC-A1F5-B4EC149B2337"></a><h5 id="BRADV-GUID-EB1FDC10-6B32-41DC-A1F5-B4EC149B2337" class="sect5"><span class="enumeration_section">24.1.5.3 </span>Interpreting SBT 2.0 Media Management Errors: Example
                     </h5>
                     <div>
                        <p>This example shows how to interpret errors caused at the media manager level.</p>
                        <p>Assume that you use a tape drive and see the following output during a backup job:</p><pre class="oac_no_warn" dir="ltr">RMAN-00571: ===========================================================
RMAN-00569: =============== ERROR MESSAGE STACK FOLLOWS ===============
RMAN-00571: ===========================================================
ORA-19624: operation failed, retry possible
ORA-19507: failed to retrieve sequential file, handle="/tmp/mydir", parms=""
ORA-27029: skgfrtrv: sbtrestore returned error
ORA-19511: Error received from media manager layer, error text:
  sbtpvt_open_input:file /tmp/mydir does not exist or cannot be accessed, errno=2
</pre><p>The error text displayed following the <code class="codeph">ORA-19511</code> error is generated by the media manager and describes the real source of the failure. See the media manager documentation to interpret this error.
                        </p>
                     </div>
                  </div><a id="BRADV89874"></a><div class="props_rev_3"><a id="GUID-37D6BF25-3EEF-473A-A500-D13F0FD9FC87" name="GUID-37D6BF25-3EEF-473A-A500-D13F0FD9FC87"></a><h5 id="BRADV-GUID-37D6BF25-3EEF-473A-A500-D13F0FD9FC87" class="sect5"><span class="enumeration_section">24.1.5.4 </span>Interpreting SBT 1.1 Media Management Errors: Example
                     </h5>
                     <div>
                        <p>This example shows the output of a backup job that has errors media management errors.</p>
                        <p>Assume that you use a tape drive and see the following output during a backup job:</p><pre class="oac_no_warn" dir="ltr">RMAN-00571: ===========================================================
RMAN-00569: =============== ERROR MESSAGE STACK FOLLOWS ===============
RMAN-00571: ===========================================================
RMAN-03009: failure of backup command on c1 channel at 09/04/2013 13:18:19
ORA-19506: failed to create sequential file, name="07d36ecp_1_1", parms=""
ORA-27007: failed to open file
SVR4 Error: 2: No such file or directory
Additional information: 7005
Additional information: 1
ORA-19511: Error received from media manager layer, error text:
   SBT error = 7005, errno = 2, sbtopen: system error
</pre><p>The main information of interest returned by SBT 1.1 media managers is the error code in the "Additional information" line:</p><pre class="oac_no_warn" dir="ltr">Additional information: 7005
</pre><p>Referring to <a href="troubleshooting-rman-operations.html#GUID-B23435DA-149D-4BFF-BF03-0FA4B68D5020__G1014541" title="This table lists SBT 1.1 error message numbers and corresponding error text..">Table 24-3</a>, you discover that error <code class="codeph">7005</code> means that the media management device is busy. So, the media management software is not able to write to the device because it is in use or there is a problem with it.
                        </p>
                        <div class="infoboxnote" id="GUID-37D6BF25-3EEF-473A-A500-D13F0FD9FC87__GUID-1818CCDC-CEC3-48D7-9538-864C5A0B3FDA">
                           <p class="notep1">Note:</p>
                           <p>The <code class="codeph">sbtio.log</code> contains information written by the media management software, <span class="italic">not</span> Oracle Database. Thus, you must consult your media vendor documentation to interpret the error codes and messages. If no information is written to the <code class="codeph">sbtio.log</code>, then contact your media manager support to ask whether they are writing error messages in some other location, or whether there are steps you must take to have the media manager errors appear in <code class="codeph">sbtio.log</code>.
                           </p>
                        </div>
                     </div>
                  </div>
               </div><a id="BRADV89875"></a><div class="props_rev_3"><a id="GUID-52F92FE9-4C46-4380-97CB-454E5C784E01" name="GUID-52F92FE9-4C46-4380-97CB-454E5C784E01"></a><h4 id="BRADV-GUID-52F92FE9-4C46-4380-97CB-454E5C784E01" class="sect4"><span class="enumeration_section">24.1.6 </span>Identifying RMAN Return Codes
                  </h4>
                  <div>
                     <p>One way to determine whether RMAN encountered an error is to examine its return code or exit status. The RMAN client returns 0 to the shell from which it was invoked if no errors occurred, and a nonzero error value otherwise. </p>
                     <div class="section">
                        <p>How you access this return code depends upon the environment from which you invoked the RMAN client. For example, if you run UNIX with the C shell, then, when RMAN completes, the return code is placed in a shell variable called <code class="codeph">$status</code>. The method of returning exit status is a detail specific to the host operating system rather than the RMAN client.
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="BRADV415"></a><a id="BRADV177"></a><div class="props_rev_3"><a id="GUID-AD353573-E722-4D76-9361-9C0CA4C29FEB" name="GUID-AD353573-E722-4D76-9361-9C0CA4C29FEB"></a><h3 id="BRADV-GUID-AD353573-E722-4D76-9361-9C0CA4C29FEB" class="sect3"><span class="enumeration_section">24.2 </span>Using V$ Views for RMAN Troubleshooting
               </h3>
               <div>
                  <p>When <code class="codeph">LIST</code>, <code class="codeph">REPORT</code>, and <code class="codeph">SHOW</code> do not provide all the information that you need for RMAN operations, some V$ views can provide useful details.
                  </p>
                  <p>Sometimes it is useful to identify exactly what a server session performing a backup and recovery job is doing. The views described in the following table are useful for obtaining information about RMAN jobs.</p>
                  <div class="tblformal" id="GUID-AD353573-E722-4D76-9361-9C0CA4C29FEB__CHDCJGIE">
                     <p class="titleintable">Table 24-4 Useful V$ Views for Troubleshooting</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="Useful V$ Views for Troubleshooting" summary="This table describes views that can assist in monitoring or obtaining information about RMAN jobs." width="100%" frame="hsides" border="1" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="26%" id="d105110e2097">View</th>
                              <th align="left" valign="bottom" width="74%" id="d105110e2100">Description</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="26%" id="d105110e2105" headers="d105110e2097 ">
                                 <p><code class="codeph">V$PROCESS</code></p>
                              </td>
                              <td align="left" valign="top" width="74%" headers="d105110e2105 d105110e2100 ">
                                 <p>Identifies currently active processes</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="26%" id="d105110e2113" headers="d105110e2097 ">
                                 <p><code class="codeph">V$SESSION</code></p>
                              </td>
                              <td align="left" valign="top" width="74%" headers="d105110e2113 d105110e2100 ">
                                 <p>Identifies currently active sessions. Use this view to determine which database server sessions correspond to which RMAN allocated channels.</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="26%" id="d105110e2121" headers="d105110e2097 ">
                                 <p><code class="codeph">V$SESSION_WAIT</code></p>
                              </td>
                              <td align="left" valign="top" width="74%" headers="d105110e2121 d105110e2100 ">
                                 <p>Lists the events or resources for which sessions are waiting</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <p>You can use the preceding views to perform the following tasks:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="troubleshooting-rman-operations.html#GUID-6B323AE8-1E76-45E6-8434-3DCC5CE2E873" title="You can use the event names in the dynamic performance event views to monitor RMAN calls to the media management API. The event names have one-to-one correspondence with SBT functions.">Monitoring RMAN Interaction with the Media Manager</a></p>
                     </li>
                     <li>
                        <p><a href="troubleshooting-rman-operations.html#GUID-A73F567C-1F2D-403B-BED9-90B78B4CA7CD" title="To identify which server sessions correspond to which RMAN channels, you can query V$SESSION and V$PROCESS.">Correlating Server Sessions with RMAN Channels</a></p>
                     </li>
                  </ul>
               </div><a id="BRADV89876"></a><div class="props_rev_3"><a id="GUID-6B323AE8-1E76-45E6-8434-3DCC5CE2E873" name="GUID-6B323AE8-1E76-45E6-8434-3DCC5CE2E873"></a><h4 id="BRADV-GUID-6B323AE8-1E76-45E6-8434-3DCC5CE2E873" class="sect4"><span class="enumeration_section">24.2.1 </span>Monitoring RMAN Interaction with the Media Manager
                  </h4>
                  <div>
                     <p>You can use the event names in the dynamic performance event views to monitor RMAN calls to the media management API. The event names have one-to-one correspondence with SBT functions.</p>
                     <div class="section">
                        <p>See the following example:</p><pre class="oac_no_warn" dir="ltr">Backup: MML v1 open backup piece
Backup: MML v1 read backup piece
Backup: MML v1 write backup piece
Backup: MML v1 query backup piece
Backup: MML v1 delete backup piece
Backup: MML v1 close backup piece
.
.
.</pre><p>To obtain the complete list of SBT events, you can use the following query:</p><pre class="oac_no_warn" dir="ltr">SELECT NAME 
FROM   V$EVENT_NAME 
WHERE  NAME LIKE '%MML%';
</pre><p>Before making a call to any of functions in the media management API, the server adds a row in <code class="codeph">V$SESSION_WAIT</code>, with the <code class="codeph">STATE</code> column including the string <code class="codeph">WAITING</code>. The <code class="codeph">V$SESSION_WAIT.SECONDS_IN_WAIT</code> column shows the number of seconds that the server has been waiting for this call to return. After an SBT function is returned from the media manager, this row disappears.
                        </p>
                        <p>A row in <code class="codeph">V$SESSION_WAIT</code> corresponding to an SBT event name does not indicate a problem, because the server updates these rows at run time. The rows appear and disappear as calls are made and returned. However, if the <code class="codeph">SECONDS_IN_WAIT</code> column is high, then the media manager may be suspended.
                        </p>
                        <p>To monitor the SBT events, you can run the following SQL query:</p><pre class="oac_no_warn" dir="ltr">COLUMN EVENT FORMAT a17
COLUMN SECONDS_IN_WAIT FORMAT 999
COLUMN STATE FORMAT a15
COLUMN CLIENT_INFO FORMAT a30

SELECT p.SPID, s.EVENT, s.SECONDS_IN_WAIT AS SEC_WAIT, 
       sw.STATE, s.CLIENT_INFO
FROM   V$SESSION_WAIT sw, V$SESSION s, V$PROCESS p
WHERE  sw.EVENT LIKE '%MML%'
AND    s.SID=sw.SID
AND    s.PADDR=p.ADDR;
</pre><p>Examine the SQL output to determine which SBT functions are waiting. For example, the following output indicates that RMAN has been waiting for the <code class="codeph">sbtbackup</code> function to return for 10 minutes:
                        </p><pre class="oac_no_warn" dir="ltr">SPID EVENT             SEC_WAIT   STATE           CLIENT_INFO
---- ----------------- ---------- --------------- ------------------------------
8642 Backup: MML creat 600        WAITING         rman channel=ORA_SBT_TAPE_1</pre><div class="infoboxnote" id="GUID-6B323AE8-1E76-45E6-8434-3DCC5CE2E873__GUID-163B8CB1-180E-484A-BE88-B3421F31A3E7">
                           <p class="notep1">Note:</p>
                           <p>The <code class="codeph">V$SESSION_WAIT</code> view shows only database events, not media manager events.
                           </p>
                        </div>
                        <div class="infoboxnotealso" id="GUID-6B323AE8-1E76-45E6-8434-3DCC5CE2E873__GUID-9D1639EC-F414-4E6E-8842-7D9C93C288B2">
                           <p class="notep1">See Also:</p>
                           <p><a href="../refrn/V-SESSION_WAIT.html#REFRN30229" target="_blank"><span><cite>Oracle Database Reference</cite></span></a> for descriptions of the <code class="codeph">V$SESSION_WAIT</code> view.
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="BRADV89877"></a><div class="props_rev_3"><a id="GUID-A73F567C-1F2D-403B-BED9-90B78B4CA7CD" name="GUID-A73F567C-1F2D-403B-BED9-90B78B4CA7CD"></a><h4 id="BRADV-GUID-A73F567C-1F2D-403B-BED9-90B78B4CA7CD" class="sect4"><span class="enumeration_section">24.2.2 </span>Correlating Server Sessions with RMAN Channels
                  </h4>
                  <div>
                     <p>To identify which server sessions correspond to which RMAN channels, you can query <code class="codeph">V$SESSION</code> and <code class="codeph">V$PROCESS</code>. 
                     </p>
                     <p>The <code class="codeph">SPID</code> column of <code class="codeph">V$PROCESS</code> identifies the operating system ID number for the process or thread. For example, on UNIX the <code class="codeph">SPID</code> column shows the process ID, whereas on Windows the <code class="codeph">SPID</code> column shows the thread ID. You have two basic methods for obtaining this information, depending on whether you have multiple RMAN sessions active concurrently.
                     </p>
                     <p>This section contains the following topics:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="troubleshooting-rman-operations.html#GUID-3324872D-0863-42B1-89A0-A576CDC8C3CA" title="When only one RMAN session is active, the easiest method for determining the server session ID for an RMAN channel is to query the target database.">Matching Server Sessions with Channels When One RMAN Session Is Active</a></p>
                        </li>
                        <li>
                           <p><a href="troubleshooting-rman-operations.html#GUID-CD0BD414-F561-4518-A2B3-4CCD36B7EBB1" title="If multiple RMAN sessions are active, then the V$SESSION.CLIENT_INFO column can yield the same information for a channel in each session.">Matching Server Sessions with Channels in Multiple RMAN Sessions</a></p>
                        </li>
                     </ul>
                  </div><a id="BRADV89878"></a><div class="props_rev_3"><a id="GUID-3324872D-0863-42B1-89A0-A576CDC8C3CA" name="GUID-3324872D-0863-42B1-89A0-A576CDC8C3CA"></a><h5 id="BRADV-GUID-3324872D-0863-42B1-89A0-A576CDC8C3CA" class="sect5"><span class="enumeration_section">24.2.2.1 </span>Matching Server Sessions with Channels When One RMAN Session Is Active
                     </h5>
                     <div>
                        <p>When only one RMAN session is active, the easiest method for determining the server session ID for an RMAN channel is to query the target database.</p>
                        <div class="section">
                           <p>Run the following query on the target database while the RMAN job is executing:</p><pre class="oac_no_warn" dir="ltr">COLUMN CLIENT_INFO FORMAT a30
COLUMN SID FORMAT 999
COLUMN SPID FORMAT 9999

SELECT s.SID, p.SPID, s.CLIENT_INFO
FROM   V$PROCESS p, V$SESSION s
WHERE  p.ADDR = s.PADDR
AND    CLIENT_INFO LIKE 'rman%';
</pre><p>The following shows sample output:</p><pre class="oac_no_warn" dir="ltr"> SID SPID         CLIENT_INFO
---- ------------ ------------------------------
  14 8374         rman channel=ORA_SBT_TAPE_1
</pre><p>If you set an ID using the RMAN <code class="codeph">SET COMMAND ID</code> command instead of using the system-generated default ID, then search for that value in the <code class="codeph">CLIENT_INFO</code> column instead of <code class="codeph">'rman%'</code>.
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="BRADV89879"></a><div class="props_rev_3"><a id="GUID-CD0BD414-F561-4518-A2B3-4CCD36B7EBB1" name="GUID-CD0BD414-F561-4518-A2B3-4CCD36B7EBB1"></a><h5 id="BRADV-GUID-CD0BD414-F561-4518-A2B3-4CCD36B7EBB1" class="sect5"><span class="enumeration_section">24.2.2.2 </span>Matching Server Sessions with Channels in Multiple RMAN Sessions
                     </h5>
                     <div>
                        <p>If multiple RMAN sessions are active, then the <code class="codeph">V$SESSION.CLIENT_INFO</code> column can yield the same information for a channel in each session. 
                        </p>
                        <div class="section">
                           <p>For example:</p><pre class="oac_no_warn" dir="ltr"> SID SPID         CLIENT_INFO
---- ------------ ------------------------------
  14 8374         rman channel=ORA_SBT_TAPE_1
   9 8642         rman channel=ORA_SBT_TAPE_1
</pre><p>In this case, you have the following methods for determining which channel corresponds to which <code class="codeph">SID</code> value.
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div><a id="BRADV89880"></a><div class="props_rev_3"><a id="GUID-B4AD9177-6648-426C-9978-26BEAD00FBB6" name="GUID-B4AD9177-6648-426C-9978-26BEAD00FBB6"></a><h6 id="BRADV-GUID-B4AD9177-6648-426C-9978-26BEAD00FBB6" class="sect6"><span class="enumeration_section">24.2.2.2.1 </span>Obtaining the Channel ID from the RMAN Output
                        </h6>
                        <div>
                           <p>You must first obtain the <code class="codeph">sid</code> values from the RMAN output and then use these values in your SQL query.
                           </p>
                           <div class="section">
                              <p><span class="bold">To correlate a process with a channel during a backup:</span></p>
                           </div>
                           <!-- class="section" -->
                           <ol>
                              <li class="stepexpand"><span>In an active session, run the RMAN job as usual and examine the output to get the SID for the channel. For example, the output may show:</span><div><pre class="oac_no_warn" dir="ltr"><code class="codeph">Starting backup at 21-AUG-13</code>
<code class="codeph">allocated channel: ORA_SBT_TAPE_1</code>
<code class="codeph">channel ORA_SBT_TAPE_1: sid=14 devtype=SBT_TAPE</code>
</pre></div>
                              </li>
                              <li class="stepexpand"><span>Start a SQL*Plus session and then query the joined <code class="codeph">V$SESSION</code> and <code class="codeph">V$PROCESS</code> views <span class="italic">while the RMAN job is executing</span>. For example, enter:</span><div><pre class="oac_no_warn" dir="ltr">COLUMN CLIENT_INFO FORMAT a30
COLUMN SID FORMAT 999
COLUMN SPID FORMAT 9999

SELECT s.SID, p.SPID, s.CLIENT_INFO
FROM   V$PROCESS p, V$SESSION s
WHERE  p.ADDR = s.PADDR
AND    CLIENT_INFO LIKE 'rman%'
/
</pre><p>Use the <code class="codeph">sid</code> value obtained from the first step to determine which channel corresponds to which server session:
                                    </p><pre class="oac_no_warn" dir="ltr">       SID SPID         CLIENT_INFO
---------- ------------ ------------------------------
        14 2036         rman channel=ORA_SBT_TAPE_1
        12 2066         rman channel=ORA_SBT_TAPE_1</pre></div>
                              </li>
                           </ol>
                        </div>
                     </div><a id="BRADV89881"></a><div class="props_rev_3"><a id="GUID-21C49BC3-2505-481F-83B9-5474948614DF" name="GUID-21C49BC3-2505-481F-83B9-5474948614DF"></a><h6 id="BRADV-GUID-21C49BC3-2505-481F-83B9-5474948614DF" class="sect6"><span class="enumeration_section">24.2.2.2.2 </span>Correlating Server Sessions with Channels by Using SET COMMAND ID
                        </h6>
                        <div>
                           <p>You specify a command ID string in the RMAN backup script. You can then query <code class="codeph">V$SESSION.CLIENT_INFO</code> for this string.
                           </p>
                           <div class="section">
                              <p><span class="bold">To correlate a process with a channel during a backup:</span></p>
                           </div>
                           <!-- class="section" -->
                           <ol>
                              <li class="stepexpand"><span>In each session, set the <code class="codeph">COMMAND</code> <code class="codeph">ID</code> to a different value <span class="italic">after</span> allocating the channels and then back up the desired object. For example, enter the following in session 1:</span><div><pre class="oac_no_warn" dir="ltr">RUN 
{
  ALLOCATE CHANNEL c1 TYPE disk;
  SET COMMAND ID TO 'sess1';
  BACKUP DATABASE<code class="codeph">;</code>
<code class="codeph">}</code>
</pre><p>Set the command ID to a string such as <code class="codeph">sess2</code> in the job running in session 2:
                                    </p><pre class="oac_no_warn" dir="ltr">RUN 
{
  ALLOCATE CHANNEL c1 TYPE sbt;
  SET COMMAND ID TO 'sess2';
  BACKUP DATABASE<code class="codeph">;</code>
<code class="codeph">}</code>
</pre></div>
                              </li>
                              <li class="stepexpand"><span>Start a SQL*Plus session and then query the joined <code class="codeph">V$SESSION</code> and <code class="codeph">V$PROCESS</code> views <span class="italic">while the RMAN job is executing</span>. For example, enter:</span><div><pre class="oac_no_warn" dir="ltr">SELECT SID, SPID, CLIENT_INFO 
FROM   V$PROCESS p, V$SESSION s 
WHERE  p.ADDR = s.PADDR 
AND    CLIENT_INFO LIKE '%id=sess%';
</pre><p>If you run the <code class="codeph">SET</code> <code class="codeph">COMMAND</code> <code class="codeph">ID</code> command in the RMAN job, then the <code class="codeph">CLIENT_INFO</code> column displays in the following format:
                                    </p><pre class="oac_no_warn" dir="ltr">id=<span class="italic">command_id</span>,rman channel=<span class="italic">channel_id</span>
</pre><p>For example, the following shows sample output:</p><pre class="oac_no_warn" dir="ltr"> SID SPID         CLIENT_INFO
---- ------------ ------------------------------
  11 8358         id=sess1
  15 8638         id=sess2
  14 8374         id=sess1,rman channel=c1
   9 8642         id=sess2,rman channel=c1
</pre><p>The rows that contain the string <code class="codeph">rman channel</code> show the channel performing the backup. The remaining rows are for the connections to the target database.
                                    </p>
                                 </div>
                              </li>
                           </ol>
                           <div class="section">
                              <div class="infoboxnotealso" id="GUID-21C49BC3-2505-481F-83B9-5474948614DF__GUID-80936436-48E3-41A5-AF39-C16A09EDC7BE">
                                 <p class="notep1">See Also:</p>
                                 <p><a href="../rcmrf/SET.html#RCMRF153" target="_blank"><span><cite>Oracle Database Backup and Recovery Reference</cite></span></a> for <code class="codeph">SET COMMAND ID</code> syntax, and <a href="../refrn/V-SESSION.html#REFRN-GUID-28E2DC75-E157-4C0A-94AB-117C205789B9" target="_blank"><span><cite>Oracle Database Reference</cite></span></a> for more information about <code class="codeph">V$SESSION</code> and <code class="codeph">V$PROCESS</code></p>
                              </div>
                           </div>
                           <!-- class="section" -->
                        </div>
                     </div>
                  </div>
               </div>
            </div><a id="BRADV175"></a><div class="props_rev_3"><a id="GUID-B1E9715D-BD07-4B80-8158-33981138E679" name="GUID-B1E9715D-BD07-4B80-8158-33981138E679"></a><h3 id="BRADV-GUID-B1E9715D-BD07-4B80-8158-33981138E679" class="sect3"><span class="enumeration_section">24.3 </span>Testing the Media Management API
               </h3>
               <div>
                  <p>On some platforms, Oracle provides a diagnostic tool called <code class="codeph">sbttest</code>. This utility performs a simple test of the media management software by acting as the Oracle database server and attempting to communicate with the media manager.
                  </p>
                  <p>This section contains the following topics:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="troubleshooting-rman-operations.html#GUID-0780A6E4-4E5A-44CE-B083-F952597E72A7" title="The default location of the sbttest utility depends on the platform.">Obtaining the sbttest Utility</a></p>
                     </li>
                     <li>
                        <p><a href="troubleshooting-rman-operations.html#GUID-E29B9686-2435-47D1-8619-5DA3B6232376" title="Use the sbttest command, without arguments, to list the various arguments for this program.">Obtaining Online Documentation for the sbttest Utility</a></p>
                     </li>
                     <li>
                        <p><a href="troubleshooting-rman-operations.html#GUID-9396687F-2BE5-4998-9DB1-BC5F8AB50ECC" title="Use sbttest to perform a quick test of the media manager.">Using the sbttest Utility</a></p>
                     </li>
                  </ul>
               </div><a id="BRADV89882"></a><div class="props_rev_3"><a id="GUID-0780A6E4-4E5A-44CE-B083-F952597E72A7" name="GUID-0780A6E4-4E5A-44CE-B083-F952597E72A7"></a><h4 id="BRADV-GUID-0780A6E4-4E5A-44CE-B083-F952597E72A7" class="sect4"><span class="enumeration_section">24.3.1 </span>Obtaining the sbttest Utility
                  </h4>
                  <div>
                     <p>The default location of the <code class="codeph">sbttest</code> utility depends on the platform.
                     </p>
                     <div class="section">
                        <p>On UNIX, the <code class="codeph">sbttest</code> utility is typically located in <code class="codeph">$ORACLE_HOME/bin</code>. If for some reason the utility is not included with your platform, then contact Oracle Support Services to obtain the C version of the program. You can compile this version of the program on all UNIX platforms.
                        </p>
                        <p>On platforms such as Solaris, you do not have to relink when using <code class="codeph">sbttest</code>. On other platforms, relinking may be necessary.
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="BRADV89883"></a><div class="props_rev_3"><a id="GUID-E29B9686-2435-47D1-8619-5DA3B6232376" name="GUID-E29B9686-2435-47D1-8619-5DA3B6232376"></a><h4 id="BRADV-GUID-E29B9686-2435-47D1-8619-5DA3B6232376" class="sect4"><span class="enumeration_section">24.3.2 </span>Obtaining Online Documentation for the sbttest Utility
                  </h4>
                  <div>
                     <p>Use the <code class="codeph">sbttest</code> command, without arguments, to list the various arguments for this program.
                     </p>
                     <div class="section">
                        <p>For online documentation of <code class="codeph">sbttest</code>, issue the following on the command line:
                        </p><pre class="oac_no_warn" dir="ltr">% sbttest
</pre><p>The program displays the list of possible arguments for the program:</p><pre class="oac_no_warn" dir="ltr">Error: backup file name must be specified
Usage: sbttest backup_file_name # this is the only required parameter
               &lt;-dbname database_name&gt;
               &lt;-trace trace_file_name&gt;
               &lt;-remove_before&gt;
               &lt;-no_remove_after&gt; 
               &lt;-read_only&gt;
               &lt;-no_regular_backup_restore&gt;
               &lt;-no_proxy_backup&gt;
               &lt;-no_proxy_restore&gt;
               &lt;-file_type n&gt;
               &lt;-copy_number n&gt;
               &lt;-media_pool n&gt;
               &lt;-os_res_size n&gt;
               &lt;-pl_res_size n&gt;
               &lt;-block_size block_size&gt; 
               &lt;-block_count block_count&gt;
               &lt;-proxy_file os_file_name bk_file_name 
                           [os_res_size pl_res_size block_size block_count]&gt;
               &lt;-libname sbt_library_name&gt;
</pre><p>The display also indicates the meaning of each argument. For example, following is the description for two optional parameters:</p><pre class="oac_no_warn" dir="ltr">Optional parameters:
  -dbname  specifies the database name which will be used by SBT
           to identify the backup file. The default is "sbtdb"
  -trace   specifies the name of a file where the Media Management 
           software will write diagnostic messages.</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="BRADV89884"></a><div class="props_rev_3"><a id="GUID-9396687F-2BE5-4998-9DB1-BC5F8AB50ECC" name="GUID-9396687F-2BE5-4998-9DB1-BC5F8AB50ECC"></a><h4 id="BRADV-GUID-9396687F-2BE5-4998-9DB1-BC5F8AB50ECC" class="sect4"><span class="enumeration_section">24.3.3 </span>Using the sbttest Utility
                  </h4>
                  <div>
                     <p>Use <code class="codeph">sbttest</code> to perform a quick test of the media manager.
                     </p>
                     <div class="section">
                        <p>If <code class="codeph">sbttest</code> returns 0, then the test ran without error, which means that the media manager is correctly installed and can accept a data stream and return the same data when requested. If <code class="codeph">sbttest</code> returns a nonzero value, then either the media manager is not installed or it is not configured correctly.
                        </p>
                        <p><span class="bold">To use sbttest:</span></p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Confirm that the program is installed and included in the system path by typing <code class="codeph">sbttest</code> at the command line:</span><div><pre class="oac_no_warn" dir="ltr">% sbttest
</pre><p>If the program is operational, then you see a display of the online documentation.</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Execute the program, specifying any of the arguments described in the online documentation. For example, enter the following to create test file <code class="codeph">some_file.f</code> and write the output to <code class="codeph">sbtio.log</code>:</span><div><pre class="oac_no_warn" dir="ltr">% sbttest some_file.f -trace sbtio.log
</pre><p>You can also test a backup of an existing data file. For example, this command tests data file <code class="codeph">tbs_33.f</code> of database <code class="codeph">prod</code>:
                              </p><pre class="oac_no_warn" dir="ltr">% sbttest tbs_33.f -dbname prod
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Examine the output. If the program encounters an error, then it provides messages describing the failure. For example, if the database cannot find the library, you see:</span><div><pre class="oac_no_warn" dir="ltr">libobk.so could not be loaded. Check that it is installed properly, and that
 LD_LIBRARY_PATH environment variable (or its equivalent on your platform)
 includes the directory where this file can be found. Here is some additional
 information on the cause of this error:
ld.so.1: sbttest: fatal: libobk.so: open failed: No such file or directory
</pre></div>
                        </li>
                     </ol>
                     <div class="section">
                        <p>In some cases, <code class="codeph">sbttest</code> can work but an RMAN backup does not. The reasons can be the following:
                        </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>The user who starts <code class="codeph">sbttest</code> is not the owner of the Oracle Database processes.
                              </p>
                           </li>
                           <li>
                              <p>If the database server is not linked with the media management library or cannot load it dynamically when needed, then RMAN backups to the media manager fail, but <code class="codeph">sbttest</code> may still work.
                              </p>
                           </li>
                           <li>
                              <p>The <code class="codeph">sbttest</code> program passes all environment parameters from the shell but RMAN does not.
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="BRADV176"></a><div class="props_rev_3"><a id="GUID-772C8583-7763-48AB-B404-747188EC718A" name="GUID-772C8583-7763-48AB-B404-747188EC718A"></a><h3 id="BRADV-GUID-772C8583-7763-48AB-B404-747188EC718A" class="sect3"><span class="enumeration_section">24.4 </span>Terminating an RMAN Command
               </h3>
               <div>
                  <p>There are several ways to terminate an RMAN command in the middle of execution.</p>
                  <div class="section">
                     <p>They include the following:</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>The preferred method is to press Ctrl+C (or the equivalent "attention" key combination for your system) in the RMAN interface. This also terminates allocated channels, unless they are suspended in the media management code, as happens when, for example, they are waiting for a tape to be mounted.</p>
                        </li>
                        <li>
                           <p>You can end the server session corresponding to the RMAN channel by running the SQL <code class="codeph">ALTER SYSTEM KILL SESSION</code> statement as described in <a href="troubleshooting-rman-operations.html#GUID-73F87310-9DDF-4775-9049-658E0A06BADC" title="To terminate an RMAN session by using the ALTER SYSTEM statement, you need the Oracle session ID for the RMAN channel and the serial number. This information is contained in the RMAN log for messages.">Terminating the Session with ALTER SYSTEM KILL SESSION</a>.
                           </p>
                        </li>
                        <li>
                           <p>You can terminate the server session corresponding to the RMAN channel on the operating system as described in <a href="troubleshooting-rman-operations.html#GUID-4C499544-02C9-40AA-94DC-03261D7F2B3E" title="Finding and terminating the processes that are associated with the server sessions is operating system-specific. On some platforms, the server sessions are not associated with any processes at all. See your operating system-specific documentation for more information.">Terminating the Session at the Operating System Level</a>.
                           </p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div><a id="BRADV89885"></a><div class="props_rev_3"><a id="GUID-73F87310-9DDF-4775-9049-658E0A06BADC" name="GUID-73F87310-9DDF-4775-9049-658E0A06BADC"></a><h4 id="BRADV-GUID-73F87310-9DDF-4775-9049-658E0A06BADC" class="sect4"><span class="enumeration_section">24.4.1 </span>Terminating the Session with ALTER SYSTEM KILL SESSION
                  </h4>
                  <div>
                     <p>To terminate an RMAN session by using the ALTER SYSTEM statement, you need the Oracle session ID for the RMAN channel and the serial number. This information is contained in the RMAN log for messages.</p>
                     <div class="section">
                        <p>Search for messages with the format shown in the following example:</p><pre class="oac_no_warn" dir="ltr">channel ch1: sid=15 devtype=SBT_TAPE
</pre><p>The <code class="codeph">sid</code> and <code class="codeph">devtype</code> are displayed for each allocated channel. The Oracle Database <code class="codeph">sid</code> is different from the operating system process ID. You can end the session using a SQL <code class="codeph">ALTER</code> <code class="codeph">SYSTEM</code> <code class="codeph">KILL</code> <code class="codeph">SESSION</code> statement.
                        </p>
                        <p><code class="codeph">ALTER SYSTEM KILL SESSION</code> takes two arguments, the <code class="codeph">sid</code> printed in the RMAN message and a serial number, both of which can be obtained by querying <code class="codeph">V$SESSION</code>.
                        </p>
                        <p>For example, run the following statement, where <span class="italic"><code class="codeph">sid_in_rman_output</code></span> is the number from the RMAN message: 
                        </p><pre class="oac_no_warn" dir="ltr">SELECT SERIAL# 
FROM   V$SESSION 
WHERE  SID=<span class="italic"><code class="codeph">sid_in_rman_output</code></span>;
</pre><p>Then, run the following statement, substituting the <span class="italic"><code class="codeph">sid_in_rman_output</code></span> and serial number obtained from the query: 
                        </p><pre class="oac_no_warn" dir="ltr">ALTER SYSTEM KILL SESSION '<span class="italic"><code class="codeph">sid_in_rman_output</code></span><span class="italic">,</span><span class="italic"><code class="codeph">serial#</code></span>';
</pre><p>This statement has no effect on the session if the session stopped in media manager code.</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="BRADV89886"></a><div class="props_rev_3"><a id="GUID-4C499544-02C9-40AA-94DC-03261D7F2B3E" name="GUID-4C499544-02C9-40AA-94DC-03261D7F2B3E"></a><h4 id="BRADV-GUID-4C499544-02C9-40AA-94DC-03261D7F2B3E" class="sect4"><span class="enumeration_section">24.4.2 </span>Terminating the Session at the Operating System Level
                  </h4>
                  <div>
                     <p>Finding and terminating the processes that are associated with the server sessions is operating system-specific. On some platforms, the server sessions are not associated with any processes at all. See your operating system-specific documentation for more information.</p>
                  </div>
               </div><a id="BRADV89887"></a><div class="props_rev_3"><a id="GUID-60B8AE45-4484-4926-811F-BBCA23CB19D2" name="GUID-60B8AE45-4484-4926-811F-BBCA23CB19D2"></a><h4 id="BRADV-GUID-60B8AE45-4484-4926-811F-BBCA23CB19D2" class="sect4"><span class="enumeration_section">24.4.3 </span>Terminating an RMAN Session That Is Not Responding in the Media Manager
                  </h4>
                  <div>
                     <p>You may sometimes need to terminate an RMAN job that is not responding in the media manager. The best way to terminate RMAN when the channel connections are not responding in the media manager is to terminate the session in the media manager. </p>
                     <p>If this action does not solve the problem, then on some platforms, such as Linux, you may be able to terminate the Oracle Database processes of the connections. (Terminating the Oracle processes may cause problems with the media manager. See your media manager documentation for details.)</p>
                     <div class="p">This section contains the following topics:
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="troubleshooting-rman-operations.html#GUID-56D3592A-B975-4DAE-A02C-6E6693C3D471" title="The nature of an RMAN session depends on the operating system.">Components of an RMAN Session</a></p>
                           </li>
                           <li>
                              <p><a href="troubleshooting-rman-operations.html#GUID-4C2B84BF-D7FA-4137-B31C-8D02E5100405" title="RMAN usually stops responding because a channel connection is waiting in the media manager code for a tape resource. The catalog connection and the default channel appear to suspend, because they are waiting for RMAN to tell them what to do. Polling connections seem to be in an infinite loop while polling the RPC under the control of the RMAN process.">Process Behavior During a Suspended Job</a></p>
                           </li>
                           <li><a href="troubleshooting-rman-operations.html#GUID-8DE355DD-8001-482D-8453-AEF64BA72F3B" title="After the unresponsive channels in the media manager code are terminated, the RMAN process detects this termination and exits, removing all connections except target connections that are still operative in the media management layer.">Terminating an RMAN Session: Basic Steps</a></li>
                        </ul>
                     </div>
                  </div><a id="BRADV89888"></a><div class="props_rev_3"><a id="GUID-56D3592A-B975-4DAE-A02C-6E6693C3D471" name="GUID-56D3592A-B975-4DAE-A02C-6E6693C3D471"></a><h5 id="BRADV-GUID-56D3592A-B975-4DAE-A02C-6E6693C3D471" class="sect5"><span class="enumeration_section">24.4.3.1 </span>Components of an RMAN Session
                     </h5>
                     <div>
                        <p>The nature of an RMAN session depends on the operating system.</p>
                        <p>In UNIX, an RMAN session has the following processes associated with it:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>The <span class="italic">RMAN client process</span> itself
                              </p>
                           </li>
                           <li>
                              <p>The <span class="italic">default channel</span>, the initial connection to the target database
                              </p>
                           </li>
                           <li>
                              <p>One <span class="italic">target connection</span> to the target database corresponding to each allocated channel
                              </p>
                           </li>
                           <li>
                              <p>The <span class="italic">catalog connection </span>to the recovery catalog database, if you use a recovery catalog
                              </p>
                           </li>
                           <li>
                              <p>An <span class="italic">auxiliary connection</span> to an auxiliary instance, during <code class="codeph">DUPLICATE</code> or TSPITR operations
                              </p>
                           </li>
                           <li>
                              <p>A <span class="italic">polling connection</span> to the target database, used for monitoring RMAN command execution on the various allocated channels. By default, RMAN makes one polling connection. RMAN makes additional polling connections if you use different connect strings in the <code class="codeph">ALLOCATE CHANNEL</code> or <code class="codeph">CONFIGURE CHANNEL</code> commands. One polling connection exists for each distinct connect string used in the <code class="codeph">ALLOCATE CHANNEL</code> or <code class="codeph">CONFIGURE CHANNEL</code> command.
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div><a id="BRADV89889"></a><div class="props_rev_3"><a id="GUID-4C2B84BF-D7FA-4137-B31C-8D02E5100405" name="GUID-4C2B84BF-D7FA-4137-B31C-8D02E5100405"></a><h5 id="BRADV-GUID-4C2B84BF-D7FA-4137-B31C-8D02E5100405" class="sect5"><span class="enumeration_section">24.4.3.2 </span>Process Behavior During a Suspended Job
                     </h5>
                     <div>
                        <p>RMAN usually stops responding because a channel connection is waiting in the media manager code for a tape resource. The catalog connection and the default channel appear to suspend, because they are waiting for RMAN to tell them what to do. Polling connections seem to be in an infinite loop while polling the RPC under the control of the RMAN process.</p>
                        <p>If you terminate the RMAN process itself, then you also terminate the catalog connection, the auxiliary connection, the default channel, and the polling connections. If target and auxiliary connections are suspended but not while executing media manager code, they also terminate. If either the target connection or any of the auxiliary connections are executing in the media management layer, then they do not terminate until the processes are manually terminated at the operating system level.</p>
                        <p>Not all media managers can detect the termination of the Oracle Database process. Those which cannot may keep resources busy or continue processing. Consult your media manager documentation for details.</p>
                        <p>Terminating the catalog connection does not cause the RMAN process to terminate because RMAN is not performing catalog operations while the backup or restore is in progress. Removing default channel and polling connections causes the RMAN process to detect that a channel is no longer present and then to exit. In this case, the connections to the unresponsive channels remain active as described previously.</p>
                     </div>
                  </div><a id="BRADV89890"></a><div class="props_rev_3"><a id="GUID-8DE355DD-8001-482D-8453-AEF64BA72F3B" name="GUID-8DE355DD-8001-482D-8453-AEF64BA72F3B"></a><h5 id="BRADV-GUID-8DE355DD-8001-482D-8453-AEF64BA72F3B" class="sect5"><span class="enumeration_section">24.4.3.3 </span>Terminating an RMAN Session: Basic Steps
                     </h5>
                     <div>
                        <p>After the unresponsive channels in the media manager code are terminated, the RMAN process detects this termination and exits, removing all connections except target connections that are still operative in the media management layer.</p>
                        <div class="section">
                           <p>The warning about the media manager resources still applies in this case.</p>
                           <p><span class="bold">To terminate an Oracle Database process that is not responding in the media manager:</span></p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>Query <code class="codeph">V$SESSION</code> and <code class="codeph">V$SESSION_WAIT</code>, as described in <span class="q">"<a href="troubleshooting-rman-operations.html#GUID-AD353573-E722-4D76-9361-9C0CA4C29FEB" title="When LIST, REPORT, and SHOW do not provide all the information that you need for RMAN operations, some V$ views can provide useful details.">Using V$ Views for RMAN Troubleshooting</a>"</span>. For example, execute the following query:</span><div><pre class="oac_no_warn" dir="ltr">COLUMN EVENT FORMAT a17
COLUMN SECONDS_IN_WAIT FORMAT 999
COLUMN STATE FORMAT a10
COLUMN CLIENT_INFO FORMAT a30

SELECT p.SPID, s.EVENT, s.SECONDS_IN_WAIT AS SEC_WAIT, 
       sw.STATE, s.CLIENT_INFO
FROM   V$SESSION_WAIT sw, V$SESSION s, V$PROCESS p
WHERE  sw.EVENT LIKE '%MML%'
AND    s.SID=sw.SID
AND    s.PADDR=p.ADDR;
</pre><p>Examine the SQL output to determine which SBT functions are waiting. For example, the output may be as follows:</p><pre class="oac_no_warn" dir="ltr">SPID EVENT             SEC_WAIT   STATE      CLIENT_INFO
---- -----------------  ---------- ---------- -----------------------------
8642 Backup:MML write   600        WAITING    rman channel=ORA_SBT_TAPE_1
8374 Backup:MML write   600        WAITING    rman channel=ORA_SBT_TAPE_2
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Using operating system-level tools appropriate to your platform, end the unresponsive sessions. For example, on Linux execute a <code class="codeph">kill</code> <code class="codeph">-9</code> command:</span><div><pre class="oac_no_warn" dir="ltr">% kill -9 8642 8374
</pre><p>Some platforms include a command-line utility called <code class="codeph">orakill</code> that enables you to terminate a specific thread. From a command prompt, run the following command, where <span class="italic"><code class="codeph">sid</code></span> identifies the database instance to target, and the <span class="italic"><code class="codeph">thread_id</code></span> is the <code class="codeph">SPID</code> value from the query in Step 1:
                                 </p><pre class="oac_no_warn" dir="ltr">orakill <span class="italic">sid</span> <span class="italic">thread_id</span>
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Check that the media manager also clears its processes. If any remain, the next backup or restore operation may freeze again, due to the previous problems in the backup or restore operation. In some media managers, the only solution is to shut down and restart the media manager. If the documentation from the media manager does not provide the needed information, contact technical support for the media manager.</span><div>
                                 <div class="infoboxnotealso" id="GUID-8DE355DD-8001-482D-8453-AEF64BA72F3B__GUID-779D91FE-19C1-4007-9A50-04351F833C75">
                                    <p class="notep1">See Also:</p>
                                    <p>Your operating system-specific documentation for the relevant commands</p>
                                 </div>
                              </div>
                           </li>
                        </ol>
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>